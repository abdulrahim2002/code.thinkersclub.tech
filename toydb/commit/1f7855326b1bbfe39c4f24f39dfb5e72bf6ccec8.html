<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: more execution cleanups - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/1f7855326b1bbfe39c4f24f39dfb5e72bf6ccec8.html">1f7855326b1bbfe39c4f24f39dfb5e72bf6ccec8</a>
<b>parent</b> <a href="../commit/dc10f61a57cab5e55c1846555d4df601aeea5725.html">dc10f61a57cab5e55c1846555d4df601aeea5725</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Thu, 20 Jun 2024 18:48:04 +0200

sql: more execution cleanups

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/execution/aggregate.rs</a></td><td> | </td><td class="num">283</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/execution/execute.rs</a></td><td> | </td><td class="num">23</td><td><span class="i">++++++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/execution/join.rs</a></td><td> | </td><td class="num">217</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/execution/mod.rs</a></td><td> | </td><td class="num">1</td><td><span class="i"></span><span class="d">-</span></td></tr>
<tr><td class="D">D</td><td><a href="#h4">src/sql/execution/schema.rs</a></td><td> | </td><td class="num">13</td><td><span class="i"></span><span class="d">-------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/execution/source.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/execution/transform.rs</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/execution/write.rs</a></td><td> | </td><td class="num">108</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/planner/plan.rs</a></td><td> | </td><td class="num">34</td><td><span class="i">++++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/planner/planner.rs</a></td><td> | </td><td class="num">81</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/types/expression.rs</a></td><td> | </td><td class="num">15</td><td><span class="i">+++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/types/value.rs</a></td><td> | </td><td class="num">35</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/mutation/insert_extra</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/mutation/insert_missing_column</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/agg_boolean</a></td><td> | </td><td class="num">251</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/agg_boolean_null</a></td><td> | </td><td class="num">251</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/agg_const</a></td><td> | </td><td class="num">188</td><td><span class="i">+++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/agg_const_from</a></td><td> | </td><td class="num">188</td><td><span class="i">+++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/agg_count_star</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++++++++</span><span class="d">----------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/agg_expr</a></td><td> | </td><td class="num">120</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/agg_float</a></td><td> | </td><td class="num">248</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/agg_float_null</a></td><td> | </td><td class="num">248</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/agg_integer</a></td><td> | </td><td class="num">248</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/agg_integer_null</a></td><td> | </td><td class="num">248</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">248</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">280</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/agg_string</a></td><td> | </td><td class="num">251</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/agg_string_null</a></td><td> | </td><td class="num">251</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/as_</a></td><td> | </td><td class="num">160</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/as_duplicate</a></td><td> | </td><td class="num">64</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/expr_mixed</a></td><td> | </td><td class="num">104</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/expr_static</a></td><td> | </td><td class="num">84</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/field_aliased</a></td><td> | </td><td class="num">76</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/query/field_multi</a></td><td> | </td><td class="num">68</td><td><span class="i">++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/query/field_qualified</a></td><td> | </td><td class="num">40</td><td><span class="i">++++++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/query/field_qualified_multi</a></td><td> | </td><td class="num">76</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/query/field_single</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/query/group_expr</a></td><td> | </td><td class="num">106</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/query/group_expr_aggr</a></td><td> | </td><td class="num">188</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/query/group_expr_aggr_selfref</a></td><td> | </td><td class="num">216</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">tests/sql/query/group_expr_aliased</a></td><td> | </td><td class="num">156</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">tests/sql/query/group_expr_both</a></td><td> | </td><td class="num">126</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">tests/sql/query/group_expr_multigroup</a></td><td> | </td><td class="num">204</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">tests/sql/query/group_expr_select</a></td><td> | </td><td class="num">158</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">tests/sql/query/group_join</a></td><td> | </td><td class="num">116</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">tests/sql/query/group_noaggregate</a></td><td> | </td><td class="num">76</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">tests/sql/query/group_noselect</a></td><td> | </td><td class="num">98</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">tests/sql/query/group_simple</a></td><td> | </td><td class="num">124</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">tests/sql/query/having</a></td><td> | </td><td class="num">142</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">208</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">256</td><td><span class="i">+++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">206</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">tests/sql/query/having_nogroup</a></td><td> | </td><td class="num">136</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">144</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">220</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">tests/sql/query/join_inner_multi</a></td><td> | </td><td class="num">140</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">140</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">tests/sql/query/join_inner_multi_same</a></td><td> | </td><td class="num">339</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">tests/sql/query/join_left</a></td><td> | </td><td class="num">104</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">tests/sql/query/join_left_outer</a></td><td> | </td><td class="num">104</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">tests/sql/query/join_left_truncate</a></td><td> | </td><td class="num">104</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">tests/sql/query/join_right</a></td><td> | </td><td class="num">424</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">tests/sql/query/join_right_all</a></td><td> | </td><td class="num">328</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">tests/sql/query/join_right_outer</a></td><td> | </td><td class="num">424</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">tests/sql/query/join_right_truncate</a></td><td> | </td><td class="num">420</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">tests/sql/query/lowercase</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">tests/sql/query/order_aggregate</a></td><td> | </td><td class="num">124</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">tests/sql/query/order_aggregate_noselect</a></td><td> | </td><td class="num">208</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">tests/sql/query/order_expr</a></td><td> | </td><td class="num">146</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">122</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">228</td><td><span class="i">+++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">tests/sql/query/order_group_by_noselect</a></td><td> | </td><td class="num">144</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">tests/sql/query/order_noselect</a></td><td> | </td><td class="num">136</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">76</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">76</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">tests/sql/schema/insert_default_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
</table></pre><pre>77 files changed, 5294 insertions(+), 6002 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/execution/aggregate.rs.html">src/sql/execution/aggregate.rs</a> b/<a href="../file/src/sql/execution/aggregate.rs.html">src/sql/execution/aggregate.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1,220 +1,135 @@
</a> use super::QueryIterator;
 use crate::error::Result;
 use crate::sql::planner::Aggregate;
<a href="#h0-0-3" id="h0-0-3" class="d">-use crate::sql::types::Value;
</a><a href="#h0-0-4" id="h0-0-4" class="i">+use crate::sql::types::{Row, Value};
</a> 
<a href="#h0-0-6" id="h0-0-6" class="d">-use std::cmp::Ordering;
</a> use std::collections::HashMap;
 
 /// Aggregates rows (i.e. GROUP BY).
<a href="#h0-0-10" id="h0-0-10" class="d">-///
</a><a href="#h0-0-11" id="h0-0-11" class="d">-/// TODO: revisit this and clean it up.
</a> pub(super) fn aggregate(
     mut source: QueryIterator,
     aggregates: Vec&lt;Aggregate&gt;,
 ) -&gt; Result&lt;QueryIterator&gt; {
<a href="#h0-0-16" id="h0-0-16" class="d">-    let mut accumulators: HashMap&lt;Vec&lt;Value&gt;, Vec&lt;Box&lt;dyn Accumulator&gt;&gt;&gt; = HashMap::new();
</a><a href="#h0-0-17" id="h0-0-17" class="d">-    let agg_count = aggregates.len();
</a><a href="#h0-0-18" id="h0-0-18" class="i">+    // Aggregate rows from source, grouped by non-aggregation columns. For
</a><a href="#h0-0-19" id="h0-0-19" class="i">+    // example, SELECT a, b, SUM(c), MAX(d) ... uses a,b as grouping buckets and
</a><a href="#h0-0-20" id="h0-0-20" class="i">+    // SUM(c),MAX(d) as accumulators for each a,b bucket.
</a><a href="#h0-0-21" id="h0-0-21" class="i">+    let mut accumulators: HashMap&lt;Row, Vec&lt;Accumulator&gt;&gt; = HashMap::new();
</a>     while let Some(mut row) = source.next().transpose()? {
         accumulators
             .entry(row.split_off(aggregates.len()))
<a href="#h0-0-25" id="h0-0-25" class="d">-            .or_insert(aggregates.iter().map(&lt;dyn Accumulator&gt;::from).collect())
</a><a href="#h0-0-26" id="h0-0-26" class="i">+            .or_insert(aggregates.iter().map(Accumulator::new).collect())
</a>             .iter_mut()
             .zip(row)
<a href="#h0-0-29" id="h0-0-29" class="d">-            .try_for_each(|(acc, value)| acc.accumulate(&amp;value))?
</a><a href="#h0-0-30" id="h0-0-30" class="i">+            .try_for_each(|(acc, value)| acc.add(value))?
</a>     }
<a href="#h0-0-32" id="h0-0-32" class="d">-    // If there were no rows and no group-by columns, return a row of empty accumulators:
</a><a href="#h0-0-33" id="h0-0-33" class="d">-    // SELECT COUNT(*) FROM t WHERE FALSE
</a><a href="#h0-0-34" id="h0-0-34" class="i">+
</a><a href="#h0-0-35" id="h0-0-35" class="i">+    // If there were no rows and no group-by columns, return a row of empty
</a><a href="#h0-0-36" id="h0-0-36" class="i">+    // accumulators, e.g.: SELECT COUNT(*) FROM t WHERE FALSE
</a>     if accumulators.is_empty() &amp;&amp; aggregates.len() == source.columns.len() {
<a href="#h0-0-38" id="h0-0-38" class="d">-        accumulators.insert(Vec::new(), aggregates.iter().map(&lt;dyn Accumulator&gt;::from).collect());
</a><a href="#h0-0-39" id="h0-0-39" class="i">+        accumulators.insert(Vec::new(), aggregates.iter().map(Accumulator::new).collect());
</a>     }
<a href="#h0-0-41" id="h0-0-41" class="i">+
</a><a href="#h0-0-42" id="h0-0-42" class="i">+    // Pass through non-aggregation column labels from the source.
</a><a href="#h0-0-43" id="h0-0-43" class="i">+    let columns = source
</a><a href="#h0-0-44" id="h0-0-44" class="i">+        .columns
</a><a href="#h0-0-45" id="h0-0-45" class="i">+        .into_iter()
</a><a href="#h0-0-46" id="h0-0-46" class="i">+        .enumerate()
</a><a href="#h0-0-47" id="h0-0-47" class="i">+        .map(|(i, label)| if i &lt; aggregates.len() { None } else { label })
</a><a href="#h0-0-48" id="h0-0-48" class="i">+        .collect();
</a><a href="#h0-0-49" id="h0-0-49" class="i">+
</a><a href="#h0-0-50" id="h0-0-50" class="i">+    // Emit the aggregate and row values for each row bucket.
</a>     Ok(QueryIterator {
<a href="#h0-0-52" id="h0-0-52" class="d">-        columns: source
</a><a href="#h0-0-53" id="h0-0-53" class="d">-            .columns
</a><a href="#h0-0-54" id="h0-0-54" class="d">-            .into_iter()
</a><a href="#h0-0-55" id="h0-0-55" class="d">-            .enumerate()
</a><a href="#h0-0-56" id="h0-0-56" class="d">-            .map(|(i, label)| if i &lt; agg_count { None } else { label })
</a><a href="#h0-0-57" id="h0-0-57" class="d">-            .collect(),
</a><a href="#h0-0-58" id="h0-0-58" class="d">-        rows: Box::new(accumulators.into_iter().map(|(bucket, accs)| {
</a><a href="#h0-0-59" id="h0-0-59" class="d">-            Ok(accs.into_iter().map(|acc| acc.aggregate()).chain(bucket).collect())
</a><a href="#h0-0-60" id="h0-0-60" class="i">+        columns,
</a><a href="#h0-0-61" id="h0-0-61" class="i">+        rows: Box::new(accumulators.into_iter().map(|(row, accs)| {
</a><a href="#h0-0-62" id="h0-0-62" class="i">+            accs.into_iter()
</a><a href="#h0-0-63" id="h0-0-63" class="i">+                .map(|acc| acc.value())
</a><a href="#h0-0-64" id="h0-0-64" class="i">+                .chain(row.into_iter().map(Ok))
</a><a href="#h0-0-65" id="h0-0-65" class="i">+                .collect::&lt;Result&lt;_&gt;&gt;()
</a>         })),
     })
 }
 
<a href="#h0-0-70" id="h0-0-70" class="d">-// An accumulator
</a><a href="#h0-0-71" id="h0-0-71" class="d">-pub trait Accumulator: std::fmt::Debug + Send {
</a><a href="#h0-0-72" id="h0-0-72" class="d">-    // Accumulates a value
</a><a href="#h0-0-73" id="h0-0-73" class="d">-    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;()&gt;;
</a><a href="#h0-0-74" id="h0-0-74" class="d">-
</a><a href="#h0-0-75" id="h0-0-75" class="d">-    // Calculates a final aggregate
</a><a href="#h0-0-76" id="h0-0-76" class="d">-    fn aggregate(&amp;self) -&gt; Value;
</a><a href="#h0-0-77" id="h0-0-77" class="d">-}
</a><a href="#h0-0-78" id="h0-0-78" class="d">-
</a><a href="#h0-0-79" id="h0-0-79" class="d">-impl dyn Accumulator {
</a><a href="#h0-0-80" id="h0-0-80" class="d">-    fn from(aggregate: &amp;Aggregate) -&gt; Box&lt;dyn Accumulator&gt; {
</a><a href="#h0-0-81" id="h0-0-81" class="d">-        match aggregate {
</a><a href="#h0-0-82" id="h0-0-82" class="d">-            Aggregate::Average =&gt; Box::new(Average::new()),
</a><a href="#h0-0-83" id="h0-0-83" class="d">-            Aggregate::Count =&gt; Box::new(Count::new()),
</a><a href="#h0-0-84" id="h0-0-84" class="d">-            Aggregate::Max =&gt; Box::new(Max::new()),
</a><a href="#h0-0-85" id="h0-0-85" class="d">-            Aggregate::Min =&gt; Box::new(Min::new()),
</a><a href="#h0-0-86" id="h0-0-86" class="d">-            Aggregate::Sum =&gt; Box::new(Sum::new()),
</a><a href="#h0-0-87" id="h0-0-87" class="d">-        }
</a><a href="#h0-0-88" id="h0-0-88" class="d">-    }
</a><a href="#h0-0-89" id="h0-0-89" class="d">-}
</a><a href="#h0-0-90" id="h0-0-90" class="d">-
</a><a href="#h0-0-91" id="h0-0-91" class="d">-// Count non-null values
</a><a href="#h0-0-92" id="h0-0-92" class="d">-#[derive(Debug)]
</a><a href="#h0-0-93" id="h0-0-93" class="d">-pub struct Count {
</a><a href="#h0-0-94" id="h0-0-94" class="d">-    count: u64,
</a><a href="#h0-0-95" id="h0-0-95" class="d">-}
</a><a href="#h0-0-96" id="h0-0-96" class="d">-
</a><a href="#h0-0-97" id="h0-0-97" class="d">-impl Count {
</a><a href="#h0-0-98" id="h0-0-98" class="d">-    pub fn new() -&gt; Self {
</a><a href="#h0-0-99" id="h0-0-99" class="d">-        Self { count: 0 }
</a><a href="#h0-0-100" id="h0-0-100" class="d">-    }
</a><a href="#h0-0-101" id="h0-0-101" class="d">-}
</a><a href="#h0-0-102" id="h0-0-102" class="d">-
</a><a href="#h0-0-103" id="h0-0-103" class="d">-impl Accumulator for Count {
</a><a href="#h0-0-104" id="h0-0-104" class="d">-    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;()&gt; {
</a><a href="#h0-0-105" id="h0-0-105" class="d">-        match value {
</a><a href="#h0-0-106" id="h0-0-106" class="d">-            Value::Null =&gt; {}
</a><a href="#h0-0-107" id="h0-0-107" class="d">-            _ =&gt; self.count += 1,
</a><a href="#h0-0-108" id="h0-0-108" class="d">-        }
</a><a href="#h0-0-109" id="h0-0-109" class="d">-        Ok(())
</a><a href="#h0-0-110" id="h0-0-110" class="d">-    }
</a><a href="#h0-0-111" id="h0-0-111" class="d">-
</a><a href="#h0-0-112" id="h0-0-112" class="d">-    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h0-0-113" id="h0-0-113" class="d">-        Value::Integer(self.count as i64)
</a><a href="#h0-0-114" id="h0-0-114" class="d">-    }
</a><a href="#h0-0-115" id="h0-0-115" class="d">-}
</a><a href="#h0-0-116" id="h0-0-116" class="d">-
</a><a href="#h0-0-117" id="h0-0-117" class="d">-// Average value
</a><a href="#h0-0-118" id="h0-0-118" class="d">-#[derive(Debug)]
</a><a href="#h0-0-119" id="h0-0-119" class="d">-pub struct Average {
</a><a href="#h0-0-120" id="h0-0-120" class="d">-    count: Count,
</a><a href="#h0-0-121" id="h0-0-121" class="d">-    sum: Sum,
</a><a href="#h0-0-122" id="h0-0-122" class="d">-}
</a><a href="#h0-0-123" id="h0-0-123" class="d">-
</a><a href="#h0-0-124" id="h0-0-124" class="d">-impl Average {
</a><a href="#h0-0-125" id="h0-0-125" class="d">-    pub fn new() -&gt; Self {
</a><a href="#h0-0-126" id="h0-0-126" class="d">-        Self { count: Count::new(), sum: Sum::new() }
</a><a href="#h0-0-127" id="h0-0-127" class="d">-    }
</a><a href="#h0-0-128" id="h0-0-128" class="d">-}
</a><a href="#h0-0-129" id="h0-0-129" class="d">-
</a><a href="#h0-0-130" id="h0-0-130" class="d">-impl Accumulator for Average {
</a><a href="#h0-0-131" id="h0-0-131" class="d">-    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;()&gt; {
</a><a href="#h0-0-132" id="h0-0-132" class="d">-        self.count.accumulate(value)?;
</a><a href="#h0-0-133" id="h0-0-133" class="d">-        self.sum.accumulate(value)?;
</a><a href="#h0-0-134" id="h0-0-134" class="d">-        Ok(())
</a><a href="#h0-0-135" id="h0-0-135" class="d">-    }
</a><a href="#h0-0-136" id="h0-0-136" class="d">-
</a><a href="#h0-0-137" id="h0-0-137" class="d">-    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h0-0-138" id="h0-0-138" class="d">-        match (self.sum.aggregate(), self.count.aggregate()) {
</a><a href="#h0-0-139" id="h0-0-139" class="d">-            (Value::Integer(s), Value::Integer(c)) =&gt; Value::Integer(s / c),
</a><a href="#h0-0-140" id="h0-0-140" class="d">-            (Value::Float(s), Value::Integer(c)) =&gt; Value::Float(s / c as f64),
</a><a href="#h0-0-141" id="h0-0-141" class="d">-            _ =&gt; Value::Null,
</a><a href="#h0-0-142" id="h0-0-142" class="d">-        }
</a><a href="#h0-0-143" id="h0-0-143" class="d">-    }
</a><a href="#h0-0-144" id="h0-0-144" class="d">-}
</a><a href="#h0-0-145" id="h0-0-145" class="d">-
</a><a href="#h0-0-146" id="h0-0-146" class="d">-// Maximum value
</a><a href="#h0-0-147" id="h0-0-147" class="d">-#[derive(Debug)]
</a><a href="#h0-0-148" id="h0-0-148" class="d">-pub struct Max {
</a><a href="#h0-0-149" id="h0-0-149" class="d">-    max: Option&lt;Value&gt;,
</a><a href="#h0-0-150" id="h0-0-150" class="d">-}
</a><a href="#h0-0-151" id="h0-0-151" class="d">-
</a><a href="#h0-0-152" id="h0-0-152" class="d">-impl Max {
</a><a href="#h0-0-153" id="h0-0-153" class="d">-    pub fn new() -&gt; Self {
</a><a href="#h0-0-154" id="h0-0-154" class="d">-        Self { max: None }
</a><a href="#h0-0-155" id="h0-0-155" class="d">-    }
</a><a href="#h0-0-156" id="h0-0-156" class="d">-}
</a><a href="#h0-0-157" id="h0-0-157" class="d">-
</a><a href="#h0-0-158" id="h0-0-158" class="d">-impl Accumulator for Max {
</a><a href="#h0-0-159" id="h0-0-159" class="d">-    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;()&gt; {
</a><a href="#h0-0-160" id="h0-0-160" class="d">-        if let Some(max) = &amp;mut self.max {
</a><a href="#h0-0-161" id="h0-0-161" class="d">-            match value.partial_cmp(max) {
</a><a href="#h0-0-162" id="h0-0-162" class="d">-                _ if max.datatype() != value.datatype() =&gt; *max = Value::Null,
</a><a href="#h0-0-163" id="h0-0-163" class="d">-                None =&gt; *max = Value::Null,
</a><a href="#h0-0-164" id="h0-0-164" class="d">-                Some(Ordering::Greater) =&gt; *max = value.clone(),
</a><a href="#h0-0-165" id="h0-0-165" class="d">-                Some(Ordering::Equal) | Some(Ordering::Less) =&gt; {}
</a><a href="#h0-0-166" id="h0-0-166" class="d">-            };
</a><a href="#h0-0-167" id="h0-0-167" class="d">-        } else {
</a><a href="#h0-0-168" id="h0-0-168" class="d">-            self.max = Some(value.clone())
</a><a href="#h0-0-169" id="h0-0-169" class="d">-        }
</a><a href="#h0-0-170" id="h0-0-170" class="d">-        Ok(())
</a><a href="#h0-0-171" id="h0-0-171" class="d">-    }
</a><a href="#h0-0-172" id="h0-0-172" class="d">-
</a><a href="#h0-0-173" id="h0-0-173" class="d">-    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h0-0-174" id="h0-0-174" class="d">-        match &amp;self.max {
</a><a href="#h0-0-175" id="h0-0-175" class="d">-            Some(value) =&gt; value.clone(),
</a><a href="#h0-0-176" id="h0-0-176" class="d">-            None =&gt; Value::Null,
</a><a href="#h0-0-177" id="h0-0-177" class="d">-        }
</a><a href="#h0-0-178" id="h0-0-178" class="d">-    }
</a><a href="#h0-0-179" id="h0-0-179" class="d">-}
</a><a href="#h0-0-180" id="h0-0-180" class="d">-
</a><a href="#h0-0-181" id="h0-0-181" class="d">-// Minimum value
</a><a href="#h0-0-182" id="h0-0-182" class="d">-#[derive(Debug)]
</a><a href="#h0-0-183" id="h0-0-183" class="d">-pub struct Min {
</a><a href="#h0-0-184" id="h0-0-184" class="d">-    min: Option&lt;Value&gt;,
</a><a href="#h0-0-185" id="h0-0-185" class="d">-}
</a><a href="#h0-0-186" id="h0-0-186" class="d">-
</a><a href="#h0-0-187" id="h0-0-187" class="d">-impl Min {
</a><a href="#h0-0-188" id="h0-0-188" class="d">-    pub fn new() -&gt; Self {
</a><a href="#h0-0-189" id="h0-0-189" class="d">-        Self { min: None }
</a><a href="#h0-0-190" id="h0-0-190" class="i">+/// Accumulates aggregate values. Uses an enum rather than a trait since we need
</a><a href="#h0-0-191" id="h0-0-191" class="i">+/// to keep these in a vector (could use boxed trait objects too).
</a><a href="#h0-0-192" id="h0-0-192" class="i">+pub enum Accumulator {
</a><a href="#h0-0-193" id="h0-0-193" class="i">+    Average { count: i64, sum: Value },
</a><a href="#h0-0-194" id="h0-0-194" class="i">+    Count(i64),
</a><a href="#h0-0-195" id="h0-0-195" class="i">+    Max(Option&lt;Value&gt;),
</a><a href="#h0-0-196" id="h0-0-196" class="i">+    Min(Option&lt;Value&gt;),
</a><a href="#h0-0-197" id="h0-0-197" class="i">+    Sum(Option&lt;Value&gt;),
</a><a href="#h0-0-198" id="h0-0-198" class="i">+}
</a><a href="#h0-0-199" id="h0-0-199" class="i">+
</a><a href="#h0-0-200" id="h0-0-200" class="i">+impl std::fmt::Display for Accumulator {
</a><a href="#h0-0-201" id="h0-0-201" class="i">+    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {
</a><a href="#h0-0-202" id="h0-0-202" class="i">+        let aggregate = match self {
</a><a href="#h0-0-203" id="h0-0-203" class="i">+            Self::Average { .. } =&gt; Aggregate::Average,
</a><a href="#h0-0-204" id="h0-0-204" class="i">+            Self::Count(_) =&gt; Aggregate::Count,
</a><a href="#h0-0-205" id="h0-0-205" class="i">+            Self::Max(_) =&gt; Aggregate::Max,
</a><a href="#h0-0-206" id="h0-0-206" class="i">+            Self::Min(_) =&gt; Aggregate::Min,
</a><a href="#h0-0-207" id="h0-0-207" class="i">+            Self::Sum(_) =&gt; Aggregate::Sum,
</a><a href="#h0-0-208" id="h0-0-208" class="i">+        };
</a><a href="#h0-0-209" id="h0-0-209" class="i">+        write!(f, &quot;{aggregate}&quot;)
</a>     }
 }
 
<a href="#h0-0-213" id="h0-0-213" class="d">-impl Accumulator for Min {
</a><a href="#h0-0-214" id="h0-0-214" class="d">-    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;()&gt; {
</a><a href="#h0-0-215" id="h0-0-215" class="d">-        if let Some(min) = &amp;mut self.min {
</a><a href="#h0-0-216" id="h0-0-216" class="d">-            match value.partial_cmp(min) {
</a><a href="#h0-0-217" id="h0-0-217" class="d">-                _ if min.datatype() != value.datatype() =&gt; *min = Value::Null,
</a><a href="#h0-0-218" id="h0-0-218" class="d">-                None =&gt; *min = Value::Null,
</a><a href="#h0-0-219" id="h0-0-219" class="d">-                Some(Ordering::Less) =&gt; *min = value.clone(),
</a><a href="#h0-0-220" id="h0-0-220" class="d">-                Some(Ordering::Equal) | Some(Ordering::Greater) =&gt; {}
</a><a href="#h0-0-221" id="h0-0-221" class="d">-            };
</a><a href="#h0-0-222" id="h0-0-222" class="d">-        } else {
</a><a href="#h0-0-223" id="h0-0-223" class="d">-            self.min = Some(value.clone())
</a><a href="#h0-0-224" id="h0-0-224" class="i">+impl Accumulator {
</a><a href="#h0-0-225" id="h0-0-225" class="i">+    /// Creates a new accumulator from an aggregate kind.
</a><a href="#h0-0-226" id="h0-0-226" class="i">+    fn new(aggregate: &amp;Aggregate) -&gt; Self {
</a><a href="#h0-0-227" id="h0-0-227" class="i">+        match aggregate {
</a><a href="#h0-0-228" id="h0-0-228" class="i">+            Aggregate::Average =&gt; Self::Average { count: 0, sum: Value::Integer(0) },
</a><a href="#h0-0-229" id="h0-0-229" class="i">+            Aggregate::Count =&gt; Self::Count(0),
</a><a href="#h0-0-230" id="h0-0-230" class="i">+            Aggregate::Max =&gt; Self::Max(None),
</a><a href="#h0-0-231" id="h0-0-231" class="i">+            Aggregate::Min =&gt; Self::Min(None),
</a><a href="#h0-0-232" id="h0-0-232" class="i">+            Aggregate::Sum =&gt; Self::Sum(None),
</a>         }
<a href="#h0-0-234" id="h0-0-234" class="d">-        Ok(())
</a>     }
 
<a href="#h0-0-237" id="h0-0-237" class="d">-    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h0-0-238" id="h0-0-238" class="d">-        match &amp;self.min {
</a><a href="#h0-0-239" id="h0-0-239" class="d">-            Some(value) =&gt; value.clone(),
</a><a href="#h0-0-240" id="h0-0-240" class="d">-            None =&gt; Value::Null,
</a><a href="#h0-0-241" id="h0-0-241" class="i">+    /// Adds a value to the accumulator.
</a><a href="#h0-0-242" id="h0-0-242" class="i">+    fn add(&amp;mut self, value: Value) -&gt; Result&lt;()&gt; {
</a><a href="#h0-0-243" id="h0-0-243" class="i">+        use std::cmp::Ordering;
</a><a href="#h0-0-244" id="h0-0-244" class="i">+        match (self, value) {
</a><a href="#h0-0-245" id="h0-0-245" class="i">+            (Self::Average { sum: Value::Null, count: _ }, _) =&gt; {}
</a><a href="#h0-0-246" id="h0-0-246" class="i">+            (Self::Average { sum, count: _ }, Value::Null) =&gt; *sum = Value::Null,
</a><a href="#h0-0-247" id="h0-0-247" class="i">+            (Self::Average { sum, count }, value) =&gt; {
</a><a href="#h0-0-248" id="h0-0-248" class="i">+                *sum = sum.checked_add(&amp;value)?;
</a><a href="#h0-0-249" id="h0-0-249" class="i">+                *count += 1;
</a><a href="#h0-0-250" id="h0-0-250" class="i">+            }
</a><a href="#h0-0-251" id="h0-0-251" class="i">+
</a><a href="#h0-0-252" id="h0-0-252" class="i">+            (Self::Count(_), Value::Null) =&gt; {}
</a><a href="#h0-0-253" id="h0-0-253" class="i">+            (Self::Count(c), _) =&gt; *c += 1,
</a><a href="#h0-0-254" id="h0-0-254" class="i">+
</a><a href="#h0-0-255" id="h0-0-255" class="i">+            (Self::Max(Some(Value::Null)), _) =&gt; {}
</a><a href="#h0-0-256" id="h0-0-256" class="i">+            (Self::Max(max), Value::Null) =&gt; *max = Some(Value::Null),
</a><a href="#h0-0-257" id="h0-0-257" class="i">+            (Self::Max(max @ None), value) =&gt; *max = Some(value),
</a><a href="#h0-0-258" id="h0-0-258" class="i">+            (Self::Max(Some(max)), value) =&gt; {
</a><a href="#h0-0-259" id="h0-0-259" class="i">+                if value.cmp(max) == Ordering::Greater {
</a><a href="#h0-0-260" id="h0-0-260" class="i">+                    *max = value
</a><a href="#h0-0-261" id="h0-0-261" class="i">+                }
</a><a href="#h0-0-262" id="h0-0-262" class="i">+            }
</a><a href="#h0-0-263" id="h0-0-263" class="i">+
</a><a href="#h0-0-264" id="h0-0-264" class="i">+            (Self::Min(Some(Value::Null)), _) =&gt; {}
</a><a href="#h0-0-265" id="h0-0-265" class="i">+            (Self::Min(min), Value::Null) =&gt; *min = Some(Value::Null),
</a><a href="#h0-0-266" id="h0-0-266" class="i">+            (Self::Min(min @ None), value) =&gt; *min = Some(value),
</a><a href="#h0-0-267" id="h0-0-267" class="i">+            (Self::Min(Some(min)), value) =&gt; {
</a><a href="#h0-0-268" id="h0-0-268" class="i">+                if value.cmp(min) == Ordering::Less {
</a><a href="#h0-0-269" id="h0-0-269" class="i">+                    *min = value
</a><a href="#h0-0-270" id="h0-0-270" class="i">+                }
</a><a href="#h0-0-271" id="h0-0-271" class="i">+            }
</a><a href="#h0-0-272" id="h0-0-272" class="i">+
</a><a href="#h0-0-273" id="h0-0-273" class="i">+            (Self::Sum(sum @ None), value) =&gt; *sum = Some(Value::Integer(0).checked_add(&amp;value)?),
</a><a href="#h0-0-274" id="h0-0-274" class="i">+            (Self::Sum(Some(sum)), value) =&gt; *sum = sum.checked_add(&amp;value)?,
</a>         }
<a href="#h0-0-276" id="h0-0-276" class="d">-    }
</a><a href="#h0-0-277" id="h0-0-277" class="d">-}
</a><a href="#h0-0-278" id="h0-0-278" class="d">-
</a><a href="#h0-0-279" id="h0-0-279" class="d">-// Sum of values
</a><a href="#h0-0-280" id="h0-0-280" class="d">-#[derive(Debug)]
</a><a href="#h0-0-281" id="h0-0-281" class="d">-pub struct Sum {
</a><a href="#h0-0-282" id="h0-0-282" class="d">-    sum: Option&lt;Value&gt;,
</a><a href="#h0-0-283" id="h0-0-283" class="d">-}
</a><a href="#h0-0-284" id="h0-0-284" class="d">-
</a><a href="#h0-0-285" id="h0-0-285" class="d">-impl Sum {
</a><a href="#h0-0-286" id="h0-0-286" class="d">-    pub fn new() -&gt; Self {
</a><a href="#h0-0-287" id="h0-0-287" class="d">-        Self { sum: None }
</a><a href="#h0-0-288" id="h0-0-288" class="d">-    }
</a><a href="#h0-0-289" id="h0-0-289" class="d">-}
</a><a href="#h0-0-290" id="h0-0-290" class="d">-
</a><a href="#h0-0-291" id="h0-0-291" class="d">-impl Accumulator for Sum {
</a><a href="#h0-0-292" id="h0-0-292" class="d">-    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;()&gt; {
</a><a href="#h0-0-293" id="h0-0-293" class="d">-        self.sum = match (&amp;self.sum, value) {
</a><a href="#h0-0-294" id="h0-0-294" class="d">-            (Some(Value::Integer(s)), Value::Integer(i)) =&gt; Some(Value::Integer(s + i)),
</a><a href="#h0-0-295" id="h0-0-295" class="d">-            (Some(Value::Float(s)), Value::Float(f)) =&gt; Some(Value::Float(s + f)),
</a><a href="#h0-0-296" id="h0-0-296" class="d">-            (None, Value::Integer(i)) =&gt; Some(Value::Integer(*i)),
</a><a href="#h0-0-297" id="h0-0-297" class="d">-            (None, Value::Float(f)) =&gt; Some(Value::Float(*f)),
</a><a href="#h0-0-298" id="h0-0-298" class="d">-            _ =&gt; Some(Value::Null),
</a><a href="#h0-0-299" id="h0-0-299" class="d">-        };
</a>         Ok(())
     }
 
<a href="#h0-0-303" id="h0-0-303" class="d">-    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h0-0-304" id="h0-0-304" class="d">-        match &amp;self.sum {
</a><a href="#h0-0-305" id="h0-0-305" class="d">-            Some(value) =&gt; value.clone(),
</a><a href="#h0-0-306" id="h0-0-306" class="d">-            None =&gt; Value::Null,
</a><a href="#h0-0-307" id="h0-0-307" class="d">-        }
</a><a href="#h0-0-308" id="h0-0-308" class="i">+    /// Returns the aggregate value.
</a><a href="#h0-0-309" id="h0-0-309" class="i">+    fn value(self) -&gt; Result&lt;Value&gt; {
</a><a href="#h0-0-310" id="h0-0-310" class="i">+        Ok(match self {
</a><a href="#h0-0-311" id="h0-0-311" class="i">+            Self::Average { count: 0, sum: _ } =&gt; Value::Null,
</a><a href="#h0-0-312" id="h0-0-312" class="i">+            Self::Average { count, sum } =&gt; sum.checked_div(&amp;Value::Integer(count))?,
</a><a href="#h0-0-313" id="h0-0-313" class="i">+            Self::Count(c) =&gt; c.into(),
</a><a href="#h0-0-314" id="h0-0-314" class="i">+            Self::Max(None) | Self::Min(None) | Self::Sum(None) =&gt; Value::Null,
</a><a href="#h0-0-315" id="h0-0-315" class="i">+            Self::Max(Some(v)) | Self::Min(Some(v)) | Self::Sum(Some(v)) =&gt; v,
</a><a href="#h0-0-316" id="h0-0-316" class="i">+        })
</a>     }
 }
<b>diff --git a/<a id="h1" href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a> b/<a href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -1,16 +1,17 @@
</a> use super::aggregate;
 use super::join;
<a href="#h1-0-2" id="h1-0-2" class="d">-use super::schema;
</a> use super::source;
 use super::transform;
 use super::write;
 use crate::error::Result;
 use crate::sql::engine::{Catalog, Transaction};
 use crate::sql::planner::{Node, Plan};
<a href="#h1-0-9" id="h1-0-9" class="d">-use crate::sql::types::Label;
</a><a href="#h1-0-10" id="h1-0-10" class="d">-use crate::sql::types::{Row, Rows};
</a><a href="#h1-0-11" id="h1-0-11" class="i">+use crate::sql::types::{Label, Row, Rows};
</a> 
 /// Executes a plan, returning an execution result.
<a href="#h1-0-14" id="h1-0-14" class="i">+///
</a><a href="#h1-0-15" id="h1-0-15" class="i">+/// Takes the transaction and catalog separately, even though Transaction must
</a><a href="#h1-0-16" id="h1-0-16" class="i">+/// implement Catalog, to ensure the catalog is primarily used during planning.
</a> pub fn execute_plan(
     plan: Plan,
     txn: &amp;impl Transaction,
<a href="#h1-1" id="h1-1" class="h">@@ -19,12 +20,12 @@ pub fn execute_plan(
</a>     Ok(match plan {
         Plan::CreateTable { schema } =&gt; {
             let name = schema.name.clone();
<a href="#h1-1-3" id="h1-1-3" class="d">-            schema::create_table(catalog, schema)?;
</a><a href="#h1-1-4" id="h1-1-4" class="i">+            catalog.create_table(schema)?;
</a>             ExecutionResult::CreateTable { name }
         }
 
         Plan::DropTable { table, if_exists } =&gt; {
<a href="#h1-1-9" id="h1-1-9" class="d">-            let existed = schema::drop_table(catalog, &amp;table, if_exists)?;
</a><a href="#h1-1-10" id="h1-1-10" class="i">+            let existed = catalog.drop_table(&amp;table, if_exists)?;
</a>             ExecutionResult::DropTable { name: table, existed }
         }
 
<a href="#h1-2" id="h1-2" class="h">@@ -34,9 +35,9 @@ pub fn execute_plan(
</a>             ExecutionResult::Delete { count }
         }
 
<a href="#h1-2-3" id="h1-2-3" class="d">-        Plan::Insert { table, columns, source } =&gt; {
</a><a href="#h1-2-4" id="h1-2-4" class="i">+        Plan::Insert { table, column_map, source } =&gt; {
</a>             let source = execute(source, txn)?;
<a href="#h1-2-6" id="h1-2-6" class="d">-            let count = write::insert(txn, table, columns, source)?;
</a><a href="#h1-2-7" id="h1-2-7" class="i">+            let count = write::insert(txn, table, column_map, source)?;
</a>             ExecutionResult::Insert { count }
         }
 
<a href="#h1-3" id="h1-3" class="h">@@ -101,9 +102,9 @@ pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;QueryIterator&gt; {
</a>             Ok(transform::order(source, orders))
         }
 
<a href="#h1-3-3" id="h1-3-3" class="d">-        Node::Projection { source, expressions } =&gt; {
</a><a href="#h1-3-4" id="h1-3-4" class="i">+        Node::Projection { source, labels, expressions } =&gt; {
</a>             let source = execute(*source, txn)?;
<a href="#h1-3-6" id="h1-3-6" class="d">-            Ok(transform::project(source, expressions))
</a><a href="#h1-3-7" id="h1-3-7" class="i">+            Ok(transform::project(source, labels, expressions))
</a>         }
 
         Node::Scan { table, alias: _, filter } =&gt; source::scan(txn, table, filter),
<a href="#h1-4" id="h1-4" class="h">@@ -123,6 +124,10 @@ pub enum ExecutionResult {
</a> }
 
 /// A query result iterator, containing the columns and row iterator.
<a href="#h1-4-3" id="h1-4-3" class="i">+///
</a><a href="#h1-4-4" id="h1-4-4" class="i">+/// TODO: if we resolve labels during planning, we can replace this with a
</a><a href="#h1-4-5" id="h1-4-5" class="i">+/// simple Rows iterator. We can probably also make that generic instead of a
</a><a href="#h1-4-6" id="h1-4-6" class="i">+/// trait object, since we know the type when calling each executor.
</a> pub struct QueryIterator {
     /// Column names.
     pub columns: Vec&lt;Option&lt;Label&gt;&gt;,
<b>diff --git a/<a id="h2" href="../file/src/sql/execution/join.rs.html">src/sql/execution/join.rs</a> b/<a href="../file/src/sql/execution/join.rs.html">src/sql/execution/join.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -3,111 +3,119 @@ use crate::errdata;
</a> use crate::error::Result;
 use crate::sql::types::{Expression, Row, Rows, Value};
 
<a href="#h2-0-3" id="h2-0-3" class="i">+use itertools::Itertools as _;
</a> use std::collections::HashMap;
<a href="#h2-0-5" id="h2-0-5" class="i">+use std::iter::Peekable;
</a> 
<a href="#h2-0-7" id="h2-0-7" class="d">-/// A nested loop join. Iterates over the right result for every row in the left
</a><a href="#h2-0-8" id="h2-0-8" class="d">-/// result, optionally filtering on the join predicate.
</a><a href="#h2-0-9" id="h2-0-9" class="d">-///
</a><a href="#h2-0-10" id="h2-0-10" class="d">-/// TODO: revisit this and clean it up.
</a><a href="#h2-0-11" id="h2-0-11" class="i">+/// A nested loop join. Iterates over the right source for every row in the left
</a><a href="#h2-0-12" id="h2-0-12" class="i">+/// source, optionally filtering on the join predicate. If outer is true, and
</a><a href="#h2-0-13" id="h2-0-13" class="i">+/// there are no matches in the right source for a row in the left source, a
</a><a href="#h2-0-14" id="h2-0-14" class="i">+/// joined row with NULL values for the right source is returned (typically used
</a><a href="#h2-0-15" id="h2-0-15" class="i">+/// for a LEFT JOIN).
</a> pub(super) fn nested_loop(
     left: QueryIterator,
     right: QueryIterator,
     predicate: Option&lt;Expression&gt;,
     outer: bool,
 ) -&gt; Result&lt;QueryIterator&gt; {
<a href="#h2-0-22" id="h2-0-22" class="d">-    // TODO Since making the iterators or sources clonable is non-trivial (requiring
</a><a href="#h2-0-23" id="h2-0-23" class="d">-    // either avoiding Rust standard iterators or making sources generic), we simply
</a><a href="#h2-0-24" id="h2-0-24" class="d">-    // fetch the entire right result as a vector.
</a><a href="#h2-0-25" id="h2-0-25" class="d">-    let rows = Box::new(NestedLoopRows::new(
</a><a href="#h2-0-26" id="h2-0-26" class="d">-        left.rows,
</a><a href="#h2-0-27" id="h2-0-27" class="d">-        right.rows.collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?,
</a><a href="#h2-0-28" id="h2-0-28" class="d">-        right.columns.len(),
</a><a href="#h2-0-29" id="h2-0-29" class="d">-        predicate,
</a><a href="#h2-0-30" id="h2-0-30" class="d">-        outer,
</a><a href="#h2-0-31" id="h2-0-31" class="d">-    ));
</a><a href="#h2-0-32" id="h2-0-32" class="d">-    let mut columns = left.columns;
</a><a href="#h2-0-33" id="h2-0-33" class="d">-    columns.extend(right.columns);
</a><a href="#h2-0-34" id="h2-0-34" class="i">+    let right_size = right.columns.len();
</a><a href="#h2-0-35" id="h2-0-35" class="i">+    let columns = left.columns.into_iter().chain(right.columns).collect();
</a><a href="#h2-0-36" id="h2-0-36" class="i">+    let rows =
</a><a href="#h2-0-37" id="h2-0-37" class="i">+        Box::new(NestedLoopIterator::new(left.rows, right.rows, right_size, predicate, outer)?);
</a>     Ok(QueryIterator { rows, columns })
 }
 
<a href="#h2-0-41" id="h2-0-41" class="d">-struct NestedLoopRows {
</a><a href="#h2-0-42" id="h2-0-42" class="d">-    left: Rows,
</a><a href="#h2-0-43" id="h2-0-43" class="d">-    left_row: Option&lt;Result&lt;Row&gt;&gt;,
</a><a href="#h2-0-44" id="h2-0-44" class="d">-    right: Box&lt;dyn Iterator&lt;Item = Row&gt; + Send&gt;,
</a><a href="#h2-0-45" id="h2-0-45" class="i">+/// NestedLoopIterator implements nested loop joins.
</a><a href="#h2-0-46" id="h2-0-46" class="i">+///
</a><a href="#h2-0-47" id="h2-0-47" class="i">+/// This could be trivially implemented with carthesian_product(), but we need
</a><a href="#h2-0-48" id="h2-0-48" class="i">+/// to handle the left outer join case where there is no match in the right
</a><a href="#h2-0-49" id="h2-0-49" class="i">+/// source.
</a><a href="#h2-0-50" id="h2-0-50" class="i">+struct NestedLoopIterator {
</a><a href="#h2-0-51" id="h2-0-51" class="i">+    /// The left source.
</a><a href="#h2-0-52" id="h2-0-52" class="i">+    left: Peekable&lt;Rows&gt;,
</a><a href="#h2-0-53" id="h2-0-53" class="i">+    /// The right source.
</a><a href="#h2-0-54" id="h2-0-54" class="i">+    right: std::vec::IntoIter&lt;Row&gt;,
</a><a href="#h2-0-55" id="h2-0-55" class="i">+    /// The buffered right result.
</a>     right_vec: Vec&lt;Row&gt;,
<a href="#h2-0-57" id="h2-0-57" class="d">-    right_empty: Vec&lt;Value&gt;,
</a><a href="#h2-0-58" id="h2-0-58" class="d">-    right_hit: bool,
</a><a href="#h2-0-59" id="h2-0-59" class="i">+    /// The column width of the right source.
</a><a href="#h2-0-60" id="h2-0-60" class="i">+    right_size: usize,
</a><a href="#h2-0-61" id="h2-0-61" class="i">+    /// True if a right match has been seen for the current left row.
</a><a href="#h2-0-62" id="h2-0-62" class="i">+    right_match: bool,
</a><a href="#h2-0-63" id="h2-0-63" class="i">+    /// The join predicate.
</a>     predicate: Option&lt;Expression&gt;,
<a href="#h2-0-65" id="h2-0-65" class="i">+    /// If true, emit a row when there is no match in the right source.
</a>     outer: bool,
 }
 
<a href="#h2-0-69" id="h2-0-69" class="d">-impl NestedLoopRows {
</a><a href="#h2-0-70" id="h2-0-70" class="i">+impl NestedLoopIterator {
</a>     fn new(
<a href="#h2-0-72" id="h2-0-72" class="d">-        mut left: Rows,
</a><a href="#h2-0-73" id="h2-0-73" class="d">-        right: Vec&lt;Row&gt;,
</a><a href="#h2-0-74" id="h2-0-74" class="d">-        right_width: usize,
</a><a href="#h2-0-75" id="h2-0-75" class="i">+        left: Rows,
</a><a href="#h2-0-76" id="h2-0-76" class="i">+        right: Rows,
</a><a href="#h2-0-77" id="h2-0-77" class="i">+        right_size: usize,
</a>         predicate: Option&lt;Expression&gt;,
         outer: bool,
<a href="#h2-0-80" id="h2-0-80" class="d">-    ) -&gt; Self {
</a><a href="#h2-0-81" id="h2-0-81" class="d">-        Self {
</a><a href="#h2-0-82" id="h2-0-82" class="d">-            left_row: left.next(),
</a><a href="#h2-0-83" id="h2-0-83" class="d">-            left,
</a><a href="#h2-0-84" id="h2-0-84" class="d">-            right: Box::new(right.clone().into_iter()),
</a><a href="#h2-0-85" id="h2-0-85" class="d">-            right_vec: right,
</a><a href="#h2-0-86" id="h2-0-86" class="d">-            right_empty: std::iter::repeat(Value::Null).take(right_width).collect(),
</a><a href="#h2-0-87" id="h2-0-87" class="d">-            right_hit: false,
</a><a href="#h2-0-88" id="h2-0-88" class="d">-            predicate,
</a><a href="#h2-0-89" id="h2-0-89" class="d">-            outer,
</a><a href="#h2-0-90" id="h2-0-90" class="d">-        }
</a><a href="#h2-0-91" id="h2-0-91" class="i">+    ) -&gt; Result&lt;Self&gt; {
</a><a href="#h2-0-92" id="h2-0-92" class="i">+        // Collect the right source into a vector. We could use a borrowing
</a><a href="#h2-0-93" id="h2-0-93" class="i">+        // iterator into the vec instead of cloning an owned iterator, but it
</a><a href="#h2-0-94" id="h2-0-94" class="i">+        // comes with lifetime hassles and we end up cloning each row when
</a><a href="#h2-0-95" id="h2-0-95" class="i">+        // iterating anyway.
</a><a href="#h2-0-96" id="h2-0-96" class="i">+        //
</a><a href="#h2-0-97" id="h2-0-97" class="i">+        // TODO: consider making the iterators clonable.
</a><a href="#h2-0-98" id="h2-0-98" class="i">+        let right_vec = right.collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?;
</a><a href="#h2-0-99" id="h2-0-99" class="i">+        let right = right_vec.clone().into_iter();
</a><a href="#h2-0-100" id="h2-0-100" class="i">+        let left = left.peekable();
</a><a href="#h2-0-101" id="h2-0-101" class="i">+        Ok(Self { left, right, right_vec, right_size, right_match: false, predicate, outer })
</a>     }
 
<a href="#h2-0-104" id="h2-0-104" class="d">-    // Tries to get the next joined row, with error handling.
</a><a href="#h2-0-105" id="h2-0-105" class="i">+    // Returns the next joined row, if any, with error handling.
</a>     fn try_next(&amp;mut self) -&gt; Result&lt;Option&lt;Row&gt;&gt; {
         // While there is a valid left row, look for a right-hand match to return.
<a href="#h2-0-108" id="h2-0-108" class="d">-        while let Some(Ok(left_row)) = self.left_row.clone() {
</a><a href="#h2-0-109" id="h2-0-109" class="d">-            // If there is a hit in the remaining right rows, return it.
</a><a href="#h2-0-110" id="h2-0-110" class="d">-            if let Some(row) = self.try_next_hit(&amp;left_row)? {
</a><a href="#h2-0-111" id="h2-0-111" class="d">-                self.right_hit = true;
</a><a href="#h2-0-112" id="h2-0-112" class="d">-                return Ok(Some(row));
</a><a href="#h2-0-113" id="h2-0-113" class="i">+        while let Some(Ok(left_row)) = self.left.peek() {
</a><a href="#h2-0-114" id="h2-0-114" class="i">+            // If there is a match in the remaining right rows, return it.
</a><a href="#h2-0-115" id="h2-0-115" class="i">+            for right_row in &amp;mut self.right {
</a><a href="#h2-0-116" id="h2-0-116" class="i">+                // We could avoid cloning here unless we&#39;re actually emitting
</a><a href="#h2-0-117" id="h2-0-117" class="i">+                // the row, but we keep it simple.
</a><a href="#h2-0-118" id="h2-0-118" class="i">+                let row = left_row.iter().cloned().chain(right_row).collect();
</a><a href="#h2-0-119" id="h2-0-119" class="i">+                let is_match = match &amp;self.predicate {
</a><a href="#h2-0-120" id="h2-0-120" class="i">+                    Some(predicate) =&gt; match predicate.evaluate(Some(&amp;row))? {
</a><a href="#h2-0-121" id="h2-0-121" class="i">+                        Value::Boolean(true) =&gt; true,
</a><a href="#h2-0-122" id="h2-0-122" class="i">+                        Value::Boolean(false) | Value::Null =&gt; false,
</a><a href="#h2-0-123" id="h2-0-123" class="i">+                        v =&gt; return errdata!(&quot;join predicate returned {v}, expected boolean&quot;),
</a><a href="#h2-0-124" id="h2-0-124" class="i">+                    },
</a><a href="#h2-0-125" id="h2-0-125" class="i">+                    None =&gt; true,
</a><a href="#h2-0-126" id="h2-0-126" class="i">+                };
</a><a href="#h2-0-127" id="h2-0-127" class="i">+                if is_match {
</a><a href="#h2-0-128" id="h2-0-128" class="i">+                    self.right_match = true;
</a><a href="#h2-0-129" id="h2-0-129" class="i">+                    return Ok(Some(row));
</a><a href="#h2-0-130" id="h2-0-130" class="i">+                }
</a>             }
 
<a href="#h2-0-133" id="h2-0-133" class="d">-            // Otherwise, continue with the next left row and reset the right source.
</a><a href="#h2-0-134" id="h2-0-134" class="d">-            self.left_row = self.left.next();
</a><a href="#h2-0-135" id="h2-0-135" class="d">-            self.right = Box::new(self.right_vec.clone().into_iter());
</a><a href="#h2-0-136" id="h2-0-136" class="i">+            // We reached the end of the right source, reset it.
</a><a href="#h2-0-137" id="h2-0-137" class="i">+            self.right = self.right_vec.clone().into_iter();
</a> 
<a href="#h2-0-139" id="h2-0-139" class="d">-            // If this is an outer join, when we reach the end of the right items without a hit,
</a><a href="#h2-0-140" id="h2-0-140" class="d">-            // we should return a row with nulls for the right fields.
</a><a href="#h2-0-141" id="h2-0-141" class="d">-            if self.outer &amp;&amp; !self.right_hit {
</a><a href="#h2-0-142" id="h2-0-142" class="d">-                let mut row = left_row;
</a><a href="#h2-0-143" id="h2-0-143" class="d">-                row.extend(self.right_empty.clone());
</a><a href="#h2-0-144" id="h2-0-144" class="i">+            // If there was no match for this row, and this is an outer join,
</a><a href="#h2-0-145" id="h2-0-145" class="i">+            // emit a row with right NULLs.
</a><a href="#h2-0-146" id="h2-0-146" class="i">+            if !self.right_match &amp;&amp; self.outer {
</a><a href="#h2-0-147" id="h2-0-147" class="i">+                let row = left_row
</a><a href="#h2-0-148" id="h2-0-148" class="i">+                    .iter()
</a><a href="#h2-0-149" id="h2-0-149" class="i">+                    .cloned()
</a><a href="#h2-0-150" id="h2-0-150" class="i">+                    .chain(std::iter::repeat(Value::Null).take(self.right_size))
</a><a href="#h2-0-151" id="h2-0-151" class="i">+                    .collect();
</a><a href="#h2-0-152" id="h2-0-152" class="i">+                self.left.next();
</a>                 return Ok(Some(row));
             }
<a href="#h2-0-155" id="h2-0-155" class="d">-            self.right_hit = false;
</a><a href="#h2-0-156" id="h2-0-156" class="d">-        }
</a><a href="#h2-0-157" id="h2-0-157" class="d">-        self.left_row.clone().transpose()
</a><a href="#h2-0-158" id="h2-0-158" class="d">-    }
</a> 
<a href="#h2-0-160" id="h2-0-160" class="d">-    /// Tries to find the next combined row that matches the predicate in the remaining right rows.
</a><a href="#h2-0-161" id="h2-0-161" class="d">-    fn try_next_hit(&amp;mut self, left_row: &amp;[Value]) -&gt; Result&lt;Option&lt;Row&gt;&gt; {
</a><a href="#h2-0-162" id="h2-0-162" class="d">-        for right_row in &amp;mut self.right {
</a><a href="#h2-0-163" id="h2-0-163" class="d">-            let mut row = left_row.to_vec();
</a><a href="#h2-0-164" id="h2-0-164" class="d">-            row.extend(right_row);
</a><a href="#h2-0-165" id="h2-0-165" class="d">-            if let Some(predicate) = &amp;self.predicate {
</a><a href="#h2-0-166" id="h2-0-166" class="d">-                match predicate.evaluate(Some(&amp;row))? {
</a><a href="#h2-0-167" id="h2-0-167" class="d">-                    Value::Boolean(true) =&gt; return Ok(Some(row)),
</a><a href="#h2-0-168" id="h2-0-168" class="d">-                    Value::Boolean(false) =&gt; {}
</a><a href="#h2-0-169" id="h2-0-169" class="d">-                    Value::Null =&gt; {}
</a><a href="#h2-0-170" id="h2-0-170" class="d">-                    value =&gt; return errdata!(&quot;join predicate returned {value}, expected boolean&quot;),
</a><a href="#h2-0-171" id="h2-0-171" class="d">-                }
</a><a href="#h2-0-172" id="h2-0-172" class="d">-            } else {
</a><a href="#h2-0-173" id="h2-0-173" class="d">-                return Ok(Some(row));
</a><a href="#h2-0-174" id="h2-0-174" class="d">-            }
</a><a href="#h2-0-175" id="h2-0-175" class="i">+            // Move onto the next left row.
</a><a href="#h2-0-176" id="h2-0-176" class="i">+            self.left.next();
</a><a href="#h2-0-177" id="h2-0-177" class="i">+            self.right_match = false;
</a>         }
<a href="#h2-0-179" id="h2-0-179" class="d">-        Ok(None)
</a><a href="#h2-0-180" id="h2-0-180" class="i">+
</a><a href="#h2-0-181" id="h2-0-181" class="i">+        // Otherwise, there&#39;s either a None or Err in left. Return it.
</a><a href="#h2-0-182" id="h2-0-182" class="i">+        self.left.next().transpose()
</a>     }
 }
 
<a href="#h2-0-186" id="h2-0-186" class="d">-impl Iterator for NestedLoopRows {
</a><a href="#h2-0-187" id="h2-0-187" class="i">+impl Iterator for NestedLoopIterator {
</a>     type Item = Result&lt;Row&gt;;
 
     fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
<a href="#h2-1" id="h2-1" class="h">@@ -115,9 +123,13 @@ impl Iterator for NestedLoopRows {
</a>     }
 }
 
<a href="#h2-1-3" id="h2-1-3" class="d">-/// Executes a hash join.
</a><a href="#h2-1-4" id="h2-1-4" class="i">+/// Executes a hash join. This builds a hash table of rows from the right source
</a><a href="#h2-1-5" id="h2-1-5" class="i">+/// keyed on the join value, then iterates over the left source and looks up
</a><a href="#h2-1-6" id="h2-1-6" class="i">+/// matching rows in the hash table. If outer is true, and there is no match
</a><a href="#h2-1-7" id="h2-1-7" class="i">+/// in the right source for a row in the left source, a row with NULL values
</a><a href="#h2-1-8" id="h2-1-8" class="i">+/// for the right source is emitted instead.
</a> ///
<a href="#h2-1-10" id="h2-1-10" class="d">-/// TODO: clean this up.
</a><a href="#h2-1-11" id="h2-1-11" class="i">+/// TODO: add more tests for the multiple match case.
</a> pub(super) fn hash(
     left: QueryIterator,
     left_field: usize,
<a href="#h2-2" id="h2-2" class="h">@@ -125,32 +137,41 @@ pub(super) fn hash(
</a>     right_field: usize,
     outer: bool,
 ) -&gt; Result&lt;QueryIterator&gt; {
<a href="#h2-2-3" id="h2-2-3" class="d">-    let QueryIterator { mut columns, rows } = left;
</a><a href="#h2-2-4" id="h2-2-4" class="d">-    let QueryIterator { columns: rcolumns, rows: rrows } = right;
</a><a href="#h2-2-5" id="h2-2-5" class="d">-    let (l, r, outer) = (left_field, right_field, outer);
</a><a href="#h2-2-6" id="h2-2-6" class="d">-    let right: HashMap&lt;Value, Row&gt; = rrows
</a><a href="#h2-2-7" id="h2-2-7" class="d">-        .map(|res| match res {
</a><a href="#h2-2-8" id="h2-2-8" class="d">-            Ok(row) if row.len() &lt;= r =&gt; errdata!(&quot;right index {r} out of bounds&quot;),
</a><a href="#h2-2-9" id="h2-2-9" class="d">-            Ok(row) =&gt; Ok((row[r].clone(), row)),
</a><a href="#h2-2-10" id="h2-2-10" class="d">-            Err(err) =&gt; Err(err),
</a><a href="#h2-2-11" id="h2-2-11" class="d">-        })
</a><a href="#h2-2-12" id="h2-2-12" class="d">-        .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h2-2-13" id="h2-2-13" class="d">-    let empty = std::iter::repeat(Value::Null).take(rcolumns.len());
</a><a href="#h2-2-14" id="h2-2-14" class="d">-    columns.extend(rcolumns);
</a><a href="#h2-2-15" id="h2-2-15" class="d">-    let rows = Box::new(rows.filter_map(move |res| match res {
</a><a href="#h2-2-16" id="h2-2-16" class="d">-        Ok(row) if row.len() &lt;= l =&gt; Some(errdata!(&quot;left index {l} out of bounds&quot;)),
</a><a href="#h2-2-17" id="h2-2-17" class="d">-        Ok(mut row) =&gt; match right.get(&amp;row[l]) {
</a><a href="#h2-2-18" id="h2-2-18" class="d">-            Some(hit) =&gt; {
</a><a href="#h2-2-19" id="h2-2-19" class="d">-                row.extend(hit.clone());
</a><a href="#h2-2-20" id="h2-2-20" class="d">-                Some(Ok(row))
</a><a href="#h2-2-21" id="h2-2-21" class="d">-            }
</a><a href="#h2-2-22" id="h2-2-22" class="i">+    // Build the combined columns.
</a><a href="#h2-2-23" id="h2-2-23" class="i">+    let right_size = right.columns.len();
</a><a href="#h2-2-24" id="h2-2-24" class="i">+    let columns = left.columns.into_iter().chain(right.columns).collect();
</a><a href="#h2-2-25" id="h2-2-25" class="i">+
</a><a href="#h2-2-26" id="h2-2-26" class="i">+    // Build the hash table from the right source.
</a><a href="#h2-2-27" id="h2-2-27" class="i">+    let mut rows = right.rows;
</a><a href="#h2-2-28" id="h2-2-28" class="i">+    let mut right: HashMap&lt;Value, Vec&lt;Row&gt;&gt; = HashMap::new();
</a><a href="#h2-2-29" id="h2-2-29" class="i">+    while let Some(row) = rows.next().transpose()? {
</a><a href="#h2-2-30" id="h2-2-30" class="i">+        let id = row[right_field].clone();
</a><a href="#h2-2-31" id="h2-2-31" class="i">+        right.entry(id).or_default().push(row);
</a><a href="#h2-2-32" id="h2-2-32" class="i">+    }
</a><a href="#h2-2-33" id="h2-2-33" class="i">+
</a><a href="#h2-2-34" id="h2-2-34" class="i">+    // Set up an iterator for an empty right row in the outer case.
</a><a href="#h2-2-35" id="h2-2-35" class="i">+    let empty = std::iter::repeat(Value::Null).take(right_size);
</a><a href="#h2-2-36" id="h2-2-36" class="i">+
</a><a href="#h2-2-37" id="h2-2-37" class="i">+    // Set up the join iterator.
</a><a href="#h2-2-38" id="h2-2-38" class="i">+    let rows = Box::new(left.rows.flat_map(move |result| -&gt; Rows {
</a><a href="#h2-2-39" id="h2-2-39" class="i">+        // Pass through errors.
</a><a href="#h2-2-40" id="h2-2-40" class="i">+        let Ok(row) = result else {
</a><a href="#h2-2-41" id="h2-2-41" class="i">+            return Box::new(std::iter::once(result));
</a><a href="#h2-2-42" id="h2-2-42" class="i">+        };
</a><a href="#h2-2-43" id="h2-2-43" class="i">+        // Join the left row with any matching right rows.
</a><a href="#h2-2-44" id="h2-2-44" class="i">+        match right.get(&amp;row[left_field]) {
</a><a href="#h2-2-45" id="h2-2-45" class="i">+            Some(matches) =&gt; Box::new(
</a><a href="#h2-2-46" id="h2-2-46" class="i">+                std::iter::once(row)
</a><a href="#h2-2-47" id="h2-2-47" class="i">+                    .cartesian_product(matches.clone())
</a><a href="#h2-2-48" id="h2-2-48" class="i">+                    .map(|(l, r)| l.into_iter().chain(r).collect())
</a><a href="#h2-2-49" id="h2-2-49" class="i">+                    .map(Ok),
</a><a href="#h2-2-50" id="h2-2-50" class="i">+            ),
</a>             None if outer =&gt; {
<a href="#h2-2-52" id="h2-2-52" class="d">-                row.extend(empty.clone());
</a><a href="#h2-2-53" id="h2-2-53" class="d">-                Some(Ok(row))
</a><a href="#h2-2-54" id="h2-2-54" class="i">+                Box::new(std::iter::once(Ok(row.into_iter().chain(empty.clone()).collect())))
</a>             }
<a href="#h2-2-56" id="h2-2-56" class="d">-            None =&gt; None,
</a><a href="#h2-2-57" id="h2-2-57" class="d">-        },
</a><a href="#h2-2-58" id="h2-2-58" class="d">-        Err(err) =&gt; Some(Err(err)),
</a><a href="#h2-2-59" id="h2-2-59" class="i">+            None =&gt; Box::new(std::iter::empty()),
</a><a href="#h2-2-60" id="h2-2-60" class="i">+        }
</a>     }));
<a href="#h2-2-62" id="h2-2-62" class="i">+
</a>     Ok(QueryIterator { columns, rows })
 }
<b>diff --git a/<a id="h3" href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a> b/<a href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -1,7 +1,6 @@
</a> mod aggregate;
 mod execute;
 mod join;
<a href="#h3-0-3" id="h3-0-3" class="d">-mod schema;
</a> mod source;
 mod transform;
 mod write;
<b>diff --git a/<a id="h4" href="../file/src/sql/execution/schema.rs.html">src/sql/execution/schema.rs</a> b/<a href="../file/src/sql/execution/schema.rs.html">src/sql/execution/schema.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -1,13 +0,0 @@
</a><a href="#h4-0-0" id="h4-0-0" class="d">-use crate::error::Result;
</a><a href="#h4-0-1" id="h4-0-1" class="d">-use crate::sql::engine::Catalog;
</a><a href="#h4-0-2" id="h4-0-2" class="d">-use crate::sql::types::Table;
</a><a href="#h4-0-3" id="h4-0-3" class="d">-
</a><a href="#h4-0-4" id="h4-0-4" class="d">-// Creates a table (i.e. CREATE TABLE).
</a><a href="#h4-0-5" id="h4-0-5" class="d">-pub(super) fn create_table(catalog: &amp;impl Catalog, schema: Table) -&gt; Result&lt;()&gt; {
</a><a href="#h4-0-6" id="h4-0-6" class="d">-    catalog.create_table(schema)
</a><a href="#h4-0-7" id="h4-0-7" class="d">-}
</a><a href="#h4-0-8" id="h4-0-8" class="d">-
</a><a href="#h4-0-9" id="h4-0-9" class="d">-/// Deletes a table (i.e. DROP TABLE). Returns true if the table existed.
</a><a href="#h4-0-10" id="h4-0-10" class="d">-pub(super) fn drop_table(catalog: &amp;impl Catalog, table: &amp;str, if_exists: bool) -&gt; Result&lt;bool&gt; {
</a><a href="#h4-0-11" id="h4-0-11" class="d">-    catalog.drop_table(table, if_exists)
</a><a href="#h4-0-12" id="h4-0-12" class="d">-}
</a><b>diff --git a/<a id="h5" href="../file/src/sql/execution/source.rs.html">src/sql/execution/source.rs</a> b/<a href="../file/src/sql/execution/source.rs.html">src/sql/execution/source.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -45,6 +45,8 @@ pub(super) fn lookup_index(
</a> 
 /// Produces a single empty row. Used for queries without a FROM clause, e.g.
 /// SELECT 1+1, in order to have something to project against.
<a href="#h5-0-3" id="h5-0-3" class="i">+///
</a><a href="#h5-0-4" id="h5-0-4" class="i">+/// TODO: replace with values.
</a> pub(super) fn nothing() -&gt; QueryIterator {
     QueryIterator { columns: Vec::new(), rows: Box::new(std::iter::once(Ok(Row::new()))) }
 }
<b>diff --git a/<a id="h6" href="../file/src/sql/execution/transform.rs.html">src/sql/execution/transform.rs</a> b/<a href="../file/src/sql/execution/transform.rs.html">src/sql/execution/transform.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -4,7 +4,7 @@ use super::QueryIterator;
</a> use crate::errinput;
 use crate::error::Result;
 use crate::sql::planner::Direction;
<a href="#h6-0-3" id="h6-0-3" class="d">-use crate::sql::types::{Expression, Value};
</a><a href="#h6-0-4" id="h6-0-4" class="i">+use crate::sql::types::{Expression, Label, Value};
</a> 
 /// Filters the input rows (i.e. WHERE).
 pub(super) fn filter(source: QueryIterator, predicate: Expression) -&gt; QueryIterator {
<a href="#h6-1" id="h6-1" class="h">@@ -67,14 +67,14 @@ pub(super) fn order(source: QueryIterator, order: Vec&lt;(Expression, Direction)&gt;) 
</a> /// Projects the rows using the given expressions and labels (i.e. SELECT).
 pub(super) fn project(
     source: QueryIterator,
<a href="#h6-1-3" id="h6-1-3" class="d">-    expressions: Vec&lt;(Expression, Option&lt;String&gt;)&gt;,
</a><a href="#h6-1-4" id="h6-1-4" class="i">+    labels: Vec&lt;Option&lt;Label&gt;&gt;,
</a><a href="#h6-1-5" id="h6-1-5" class="i">+    expressions: Vec&lt;Expression&gt;,
</a> ) -&gt; QueryIterator {
<a href="#h6-1-7" id="h6-1-7" class="d">-    // TODO: pass expressions and labels separately.
</a><a href="#h6-1-8" id="h6-1-8" class="d">-    // TODO: these should be actual labels.
</a><a href="#h6-1-9" id="h6-1-9" class="d">-    let (expressions, labels): (Vec&lt;_&gt;, Vec&lt;_&gt;) = expressions.into_iter().unzip();
</a><a href="#h6-1-10" id="h6-1-10" class="d">-
</a>     // Use explicit column label if given, or pass through the source column
     // label if referenced (e.g. SELECT a, b, a FROM table).
<a href="#h6-1-13" id="h6-1-13" class="i">+    //
</a><a href="#h6-1-14" id="h6-1-14" class="i">+    // TODO: the labels can probably be resolved entirely during planning,
</a><a href="#h6-1-15" id="h6-1-15" class="i">+    // without having to plumb them through execution.
</a>     source
         .map_columns(|columns| {
             labels
<a href="#h6-2" id="h6-2" class="h">@@ -82,7 +82,7 @@ pub(super) fn project(
</a>                 .enumerate()
                 .map(|(i, label)| {
                     if let Some(label) = label {
<a href="#h6-2-3" id="h6-2-3" class="d">-                        Some((None, label))
</a><a href="#h6-2-4" id="h6-2-4" class="i">+                        Some(label)
</a>                     } else if let Expression::Field(f, _) = &amp;expressions[i] {
                         columns.get(*f).cloned().expect(&quot;invalid field reference&quot;)
                     } else {
<b>diff --git a/<a id="h7" href="../file/src/sql/execution/write.rs.html">src/sql/execution/write.rs</a> b/<a href="../file/src/sql/execution/write.rs.html">src/sql/execution/write.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,8 +1,10 @@
</a> use super::QueryIterator;
<a href="#h7-0-1" id="h7-0-1" class="d">-use crate::errinput;
</a><a href="#h7-0-2" id="h7-0-2" class="d">-use crate::error::Result;
</a><a href="#h7-0-3" id="h7-0-3" class="i">+use crate::error::{Error, Result};
</a> use crate::sql::engine::Transaction;
<a href="#h7-0-5" id="h7-0-5" class="d">-use crate::sql::types::{Expression, Row, Table, Value};
</a><a href="#h7-0-6" id="h7-0-6" class="i">+use crate::sql::types::{Expression, Table};
</a><a href="#h7-0-7" id="h7-0-7" class="i">+use crate::{errdata, errinput};
</a><a href="#h7-0-8" id="h7-0-8" class="i">+
</a><a href="#h7-0-9" id="h7-0-9" class="i">+use std::collections::HashMap;
</a> 
 /// Deletes rows, taking primary keys from the source (i.e. DELETE).
 /// Returns the number of rows deleted.
<a href="#h7-1" id="h7-1" class="h">@@ -12,27 +14,60 @@ pub(super) fn delete(
</a>     key_index: usize,
     source: QueryIterator,
 ) -&gt; Result&lt;u64&gt; {
<a href="#h7-1-3" id="h7-1-3" class="d">-    let ids: Vec&lt;_&gt; = source.map(|r| r.map(|row| row[key_index].clone())).collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h7-1-4" id="h7-1-4" class="i">+    let ids = source
</a><a href="#h7-1-5" id="h7-1-5" class="i">+        // TODO: consider moving this out to a QueryIterator helper.
</a><a href="#h7-1-6" id="h7-1-6" class="i">+        .map(|r| r.and_then(|row| row.into_iter().nth(key_index).ok_or(errdata!(&quot;short row&quot;))))
</a><a href="#h7-1-7" id="h7-1-7" class="i">+        .collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?;
</a>     let count = ids.len() as u64;
     txn.delete(&amp;table, &amp;ids)?;
     Ok(count)
 }
 
<a href="#h7-1-13" id="h7-1-13" class="d">-/// Inserts rows into a table (i.e. INSERT).
</a><a href="#h7-1-14" id="h7-1-14" class="i">+/// Inserts rows into a table (i.e. INSERT) from the given source.
</a><a href="#h7-1-15" id="h7-1-15" class="i">+///
</a><a href="#h7-1-16" id="h7-1-16" class="i">+/// If given, column_map contains the mapping of table -&gt; source columns for all
</a><a href="#h7-1-17" id="h7-1-17" class="i">+/// columns in source. Otherwise, every column in source is the corresponding
</a><a href="#h7-1-18" id="h7-1-18" class="i">+/// column in table, but the source may not have all columns in table (there may
</a><a href="#h7-1-19" id="h7-1-19" class="i">+/// be a missing tail).
</a> pub(super) fn insert(
     txn: &amp;impl Transaction,
     table: Table,
<a href="#h7-1-23" id="h7-1-23" class="d">-    columns: Vec&lt;String&gt;,
</a><a href="#h7-1-24" id="h7-1-24" class="i">+    column_map: Option&lt;HashMap&lt;usize, usize&gt;&gt;,
</a>     mut source: QueryIterator,
 ) -&gt; Result&lt;u64&gt; {
     let mut rows = Vec::new();
<a href="#h7-1-28" id="h7-1-28" class="d">-    while let Some(mut row) = source.next().transpose()? {
</a><a href="#h7-1-29" id="h7-1-29" class="d">-        // TODO: the pad/make row logic should probably be moved to the Values
</a><a href="#h7-1-30" id="h7-1-30" class="d">-        // source, or otherwise have a better mapping from the source.
</a><a href="#h7-1-31" id="h7-1-31" class="d">-        if columns.is_empty() {
</a><a href="#h7-1-32" id="h7-1-32" class="d">-            row = pad_row(&amp;table, row)?;
</a><a href="#h7-1-33" id="h7-1-33" class="d">-        } else {
</a><a href="#h7-1-34" id="h7-1-34" class="d">-            row = make_row(&amp;table, &amp;columns, row)?;
</a><a href="#h7-1-35" id="h7-1-35" class="i">+    while let Some(values) = source.next().transpose()? {
</a><a href="#h7-1-36" id="h7-1-36" class="i">+        // Fast path: the row is already complete, with no column mapping.
</a><a href="#h7-1-37" id="h7-1-37" class="i">+        if values.len() == table.columns.len() &amp;&amp; column_map.is_none() {
</a><a href="#h7-1-38" id="h7-1-38" class="i">+            rows.push(values);
</a><a href="#h7-1-39" id="h7-1-39" class="i">+            continue;
</a><a href="#h7-1-40" id="h7-1-40" class="i">+        }
</a><a href="#h7-1-41" id="h7-1-41" class="i">+
</a><a href="#h7-1-42" id="h7-1-42" class="i">+        if values.len() &gt; table.columns.len() {
</a><a href="#h7-1-43" id="h7-1-43" class="i">+            return errinput!(&quot;too many values for table {}&quot;, table.name);
</a><a href="#h7-1-44" id="h7-1-44" class="i">+        }
</a><a href="#h7-1-45" id="h7-1-45" class="i">+        if let Some(column_map) = &amp;column_map {
</a><a href="#h7-1-46" id="h7-1-46" class="i">+            if column_map.len() != values.len() {
</a><a href="#h7-1-47" id="h7-1-47" class="i">+                return errinput!(&quot;column and value counts do not match&quot;);
</a><a href="#h7-1-48" id="h7-1-48" class="i">+            }
</a><a href="#h7-1-49" id="h7-1-49" class="i">+        }
</a><a href="#h7-1-50" id="h7-1-50" class="i">+
</a><a href="#h7-1-51" id="h7-1-51" class="i">+        // Fill in the row with default values for missing fields, and map
</a><a href="#h7-1-52" id="h7-1-52" class="i">+        // source fields to table fields.
</a><a href="#h7-1-53" id="h7-1-53" class="i">+        let mut row = Vec::with_capacity(table.columns.len());
</a><a href="#h7-1-54" id="h7-1-54" class="i">+        for (cidx, column) in table.columns.iter().enumerate() {
</a><a href="#h7-1-55" id="h7-1-55" class="i">+            if column_map.is_none() &amp;&amp; cidx &lt; values.len() {
</a><a href="#h7-1-56" id="h7-1-56" class="i">+                // Pass through the source column to the table column.
</a><a href="#h7-1-57" id="h7-1-57" class="i">+                row.push(values[cidx].clone())
</a><a href="#h7-1-58" id="h7-1-58" class="i">+            } else if let Some(vidx) = column_map.as_ref().and_then(|c| c.get(&amp;cidx)).copied() {
</a><a href="#h7-1-59" id="h7-1-59" class="i">+                // Map the source column to the table column.
</a><a href="#h7-1-60" id="h7-1-60" class="i">+                row.push(values[vidx].clone())
</a><a href="#h7-1-61" id="h7-1-61" class="i">+            } else if let Some(default) = &amp;column.default {
</a><a href="#h7-1-62" id="h7-1-62" class="i">+                // Column not given in source, use the default.
</a><a href="#h7-1-63" id="h7-1-63" class="i">+                row.push(default.clone())
</a><a href="#h7-1-64" id="h7-1-64" class="i">+            } else {
</a><a href="#h7-1-65" id="h7-1-65" class="i">+                return errinput!(&quot;no value given for column {} with no default&quot;, column.name);
</a><a href="#h7-1-66" id="h7-1-66" class="i">+            }
</a>         }
         rows.push(row);
     }
<a href="#h7-2" id="h7-2" class="h">@@ -50,53 +85,16 @@ pub(super) fn update(
</a>     mut source: QueryIterator,
     expressions: Vec&lt;(usize, Expression)&gt;,
 ) -&gt; Result&lt;u64&gt; {
<a href="#h7-2-3" id="h7-2-3" class="d">-    let mut update = std::collections::HashMap::new();
</a><a href="#h7-2-4" id="h7-2-4" class="i">+    let mut updates = HashMap::new();
</a>     while let Some(row) = source.next().transpose()? {
<a href="#h7-2-6" id="h7-2-6" class="d">-        let id = row[key_index].clone();
</a>         let mut new = row.clone();
         for (field, expr) in &amp;expressions {
             new[*field] = expr.evaluate(Some(&amp;row))?;
         }
<a href="#h7-2-11" id="h7-2-11" class="d">-        update.insert(id, new);
</a><a href="#h7-2-12" id="h7-2-12" class="i">+        let id = row.into_iter().nth(key_index).ok_or::&lt;Error&gt;(errdata!(&quot;short row&quot;))?;
</a><a href="#h7-2-13" id="h7-2-13" class="i">+        updates.insert(id, new);
</a>     }
<a href="#h7-2-15" id="h7-2-15" class="d">-    let count = update.len() as u64;
</a><a href="#h7-2-16" id="h7-2-16" class="d">-    txn.update(&amp;table, update)?;
</a><a href="#h7-2-17" id="h7-2-17" class="i">+    let count = updates.len() as u64;
</a><a href="#h7-2-18" id="h7-2-18" class="i">+    txn.update(&amp;table, updates)?;
</a>     Ok(count)
 }
<a href="#h7-2-21" id="h7-2-21" class="d">-
</a><a href="#h7-2-22" id="h7-2-22" class="d">-// Builds a row from a set of column names and values, padding it with default values.
</a><a href="#h7-2-23" id="h7-2-23" class="d">-pub fn make_row(table: &amp;Table, columns: &amp;[String], values: Vec&lt;Value&gt;) -&gt; Result&lt;Row&gt; {
</a><a href="#h7-2-24" id="h7-2-24" class="d">-    if columns.len() != values.len() {
</a><a href="#h7-2-25" id="h7-2-25" class="d">-        return errinput!(&quot;column and value counts do not match&quot;);
</a><a href="#h7-2-26" id="h7-2-26" class="d">-    }
</a><a href="#h7-2-27" id="h7-2-27" class="d">-    let mut inputs = std::collections::HashMap::new();
</a><a href="#h7-2-28" id="h7-2-28" class="d">-    for (c, v) in columns.iter().zip(values.into_iter()) {
</a><a href="#h7-2-29" id="h7-2-29" class="d">-        table.get_column(c)?;
</a><a href="#h7-2-30" id="h7-2-30" class="d">-        if inputs.insert(c.clone(), v).is_some() {
</a><a href="#h7-2-31" id="h7-2-31" class="d">-            return errinput!(&quot;column {c} given multiple times&quot;);
</a><a href="#h7-2-32" id="h7-2-32" class="d">-        }
</a><a href="#h7-2-33" id="h7-2-33" class="d">-    }
</a><a href="#h7-2-34" id="h7-2-34" class="d">-    let mut row = Row::new();
</a><a href="#h7-2-35" id="h7-2-35" class="d">-    for column in table.columns.iter() {
</a><a href="#h7-2-36" id="h7-2-36" class="d">-        if let Some(value) = inputs.get(&amp;column.name) {
</a><a href="#h7-2-37" id="h7-2-37" class="d">-            row.push(value.clone())
</a><a href="#h7-2-38" id="h7-2-38" class="d">-        } else if let Some(value) = &amp;column.default {
</a><a href="#h7-2-39" id="h7-2-39" class="d">-            row.push(value.clone())
</a><a href="#h7-2-40" id="h7-2-40" class="d">-        } else {
</a><a href="#h7-2-41" id="h7-2-41" class="d">-            return errinput!(&quot;no value given for column {}&quot;, column.name);
</a><a href="#h7-2-42" id="h7-2-42" class="d">-        }
</a><a href="#h7-2-43" id="h7-2-43" class="d">-    }
</a><a href="#h7-2-44" id="h7-2-44" class="d">-    Ok(row)
</a><a href="#h7-2-45" id="h7-2-45" class="d">-}
</a><a href="#h7-2-46" id="h7-2-46" class="d">-
</a><a href="#h7-2-47" id="h7-2-47" class="d">-/// Pads a row with default values where possible.
</a><a href="#h7-2-48" id="h7-2-48" class="d">-fn pad_row(table: &amp;Table, mut row: Row) -&gt; Result&lt;Row&gt; {
</a><a href="#h7-2-49" id="h7-2-49" class="d">-    for column in table.columns.iter().skip(row.len()) {
</a><a href="#h7-2-50" id="h7-2-50" class="d">-        if let Some(default) = &amp;column.default {
</a><a href="#h7-2-51" id="h7-2-51" class="d">-            row.push(default.clone())
</a><a href="#h7-2-52" id="h7-2-52" class="d">-        } else {
</a><a href="#h7-2-53" id="h7-2-53" class="d">-            return errinput!(&quot;no default value for column {}&quot;, column.name);
</a><a href="#h7-2-54" id="h7-2-54" class="d">-        }
</a><a href="#h7-2-55" id="h7-2-55" class="d">-    }
</a><a href="#h7-2-56" id="h7-2-56" class="d">-    Ok(row)
</a><a href="#h7-2-57" id="h7-2-57" class="d">-}
</a><b>diff --git a/<a id="h8" href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a> b/<a href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -6,11 +6,13 @@ use crate::sql::execution::{self, ExecutionResult};
</a> use crate::sql::parser::ast;
 use crate::sql::types::{Expression, Label, Table, Value};
 
<a href="#h8-0-3" id="h8-0-3" class="i">+use itertools::Itertools as _;
</a> use serde::{Deserialize, Serialize};
<a href="#h8-0-5" id="h8-0-5" class="i">+use std::collections::HashMap;
</a> 
 /// A statement execution plan. These are mostly made up of nested query plan
<a href="#h8-0-8" id="h8-0-8" class="d">-/// Nodes, which stream rows, but the root nodes can also perform data
</a><a href="#h8-0-9" id="h8-0-9" class="d">-/// modifications or schema changes.
</a><a href="#h8-0-10" id="h8-0-10" class="i">+/// Nodes, which process and stream rows, but the root nodes can also perform
</a><a href="#h8-0-11" id="h8-0-11" class="i">+/// data modifications or schema changes.
</a> #[derive(Debug, PartialEq, Serialize, Deserialize)]
 pub enum Plan {
     /// A CREATE TABLE plan.
<a href="#h8-1" id="h8-1" class="h">@@ -20,7 +22,7 @@ pub enum Plan {
</a>     /// A DELETE plan.
     Delete { table: String, key_index: usize, source: Node },
     /// An INSERT plan.
<a href="#h8-1-3" id="h8-1-3" class="d">-    Insert { table: Table, columns: Vec&lt;String&gt;, source: Node },
</a><a href="#h8-1-4" id="h8-1-4" class="i">+    Insert { table: Table, column_map: Option&lt;HashMap&lt;usize, usize&gt;&gt;, source: Node },
</a>     /// An UPDATE plan.
     Update {
         table: String,
<a href="#h8-2" id="h8-2" class="h">@@ -79,7 +81,7 @@ impl std::fmt::Display for Plan {
</a>                     source.format(String::new(), false, true).trim_end()
                 )
             }
<a href="#h8-2-3" id="h8-2-3" class="d">-            Self::Insert { table, columns: _, source: _ } =&gt; {
</a><a href="#h8-2-4" id="h8-2-4" class="i">+            Self::Insert { table, column_map: _, source: _ } =&gt; {
</a>                 write!(f, &quot;Insert: {}&quot;, table.name)
             }
             Self::Select(root) =&gt; root.fmt(f),
<a href="#h8-3" id="h8-3" class="h">@@ -155,7 +157,8 @@ pub enum Node {
</a>     },
     Projection {
         source: Box&lt;Node&gt;,
<a href="#h8-3-3" id="h8-3-3" class="d">-        expressions: Vec&lt;(Expression, Option&lt;String&gt;)&gt;,
</a><a href="#h8-3-4" id="h8-3-4" class="i">+        labels: Vec&lt;Option&lt;Label&gt;&gt;,
</a><a href="#h8-3-5" id="h8-3-5" class="i">+        expressions: Vec&lt;Expression&gt;,
</a>     },
     Scan {
         table: Table,
<a href="#h8-4" id="h8-4" class="h">@@ -215,9 +218,11 @@ impl Node {
</a>             Self::Order { source, orders } =&gt; {
                 Self::Order { source: source.transform(before, after)?.into(), orders }
             }
<a href="#h8-4-3" id="h8-4-3" class="d">-            Self::Projection { source, expressions } =&gt; {
</a><a href="#h8-4-4" id="h8-4-4" class="d">-                Self::Projection { source: source.transform(before, after)?.into(), expressions }
</a><a href="#h8-4-5" id="h8-4-5" class="d">-            }
</a><a href="#h8-4-6" id="h8-4-6" class="i">+            Self::Projection { source, labels, expressions } =&gt; Self::Projection {
</a><a href="#h8-4-7" id="h8-4-7" class="i">+                source: source.transform(before, after)?.into(),
</a><a href="#h8-4-8" id="h8-4-8" class="i">+                labels,
</a><a href="#h8-4-9" id="h8-4-9" class="i">+                expressions,
</a><a href="#h8-4-10" id="h8-4-10" class="i">+            },
</a>         };
         after(self)
     }
<a href="#h8-5" id="h8-5" class="h">@@ -259,11 +264,12 @@ impl Node {
</a>                     outer,
                 }
             }
<a href="#h8-5-3" id="h8-5-3" class="d">-            Self::Projection { source, expressions } =&gt; Self::Projection {
</a><a href="#h8-5-4" id="h8-5-4" class="i">+            Self::Projection { source, labels, expressions } =&gt; Self::Projection {
</a>                 source,
<a href="#h8-5-6" id="h8-5-6" class="i">+                labels,
</a>                 expressions: expressions
                     .into_iter()
<a href="#h8-5-9" id="h8-5-9" class="d">-                    .map(|(e, l)| Ok((e.transform(before, after)?, l)))
</a><a href="#h8-5-10" id="h8-5-10" class="i">+                    .map(|e| e.transform(before, after))
</a>                     .collect::&lt;Result&lt;_&gt;&gt;()?,
             },
             Self::Scan { table, alias, filter: Some(filter) } =&gt; {
<a href="#h8-6" id="h8-6" class="h">@@ -382,14 +388,10 @@ impl Node {
</a>                 );
                 s += &amp;source.format(indent, false, true);
             }
<a href="#h8-6-3" id="h8-6-3" class="d">-            Self::Projection { source, expressions } =&gt; {
</a><a href="#h8-6-4" id="h8-6-4" class="i">+            Self::Projection { source, labels: _, expressions } =&gt; {
</a>                 s += &amp;format!(
                     &quot;Projection: {}\n&quot;,
<a href="#h8-6-7" id="h8-6-7" class="d">-                    expressions
</a><a href="#h8-6-8" id="h8-6-8" class="d">-                        .iter()
</a><a href="#h8-6-9" id="h8-6-9" class="d">-                        .map(|(expr, _)| expr.to_string())
</a><a href="#h8-6-10" id="h8-6-10" class="d">-                        .collect::&lt;Vec&lt;_&gt;&gt;()
</a><a href="#h8-6-11" id="h8-6-11" class="d">-                        .join(&quot;, &quot;)
</a><a href="#h8-6-12" id="h8-6-12" class="i">+                    expressions.iter().map(|expr| expr.to_string()).join(&quot;, &quot;)
</a>                 );
                 s += &amp;source.format(indent, false, true);
             }
<b>diff --git a/<a id="h9" href="../file/src/sql/planner/planner.rs.html">src/sql/planner/planner.rs</a> b/<a href="../file/src/sql/planner/planner.rs.html">src/sql/planner/planner.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -5,7 +5,7 @@ use super::{plan::Node, plan::Plan, Aggregate, Direction};
</a> use crate::errinput;
 use crate::error::Result;
 use crate::sql::engine::Catalog;
<a href="#h9-0-3" id="h9-0-3" class="d">-use crate::sql::types::{Column, Expression, Table, Value};
</a><a href="#h9-0-4" id="h9-0-4" class="i">+use crate::sql::types::{Column, Expression, Label, Table, Value};
</a> 
 use std::collections::{HashMap, HashSet};
 use std::mem::replace;
<a href="#h9-1" id="h9-1" class="h">@@ -88,22 +88,29 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a> 
             ast::Statement::Insert { table, columns, values } =&gt; {
                 let table = self.catalog.must_get_table(&amp;table)?;
<a href="#h9-1-3" id="h9-1-3" class="d">-                Plan::Insert {
</a><a href="#h9-1-4" id="h9-1-4" class="d">-                    table,
</a><a href="#h9-1-5" id="h9-1-5" class="d">-                    columns: columns.unwrap_or_default(),
</a><a href="#h9-1-6" id="h9-1-6" class="d">-                    source: Node::Values {
</a><a href="#h9-1-7" id="h9-1-7" class="d">-                        labels: vec![None; values.len()],
</a><a href="#h9-1-8" id="h9-1-8" class="d">-                        rows: values
</a><a href="#h9-1-9" id="h9-1-9" class="d">-                            .into_iter()
</a><a href="#h9-1-10" id="h9-1-10" class="d">-                            .map(|exprs| {
</a><a href="#h9-1-11" id="h9-1-11" class="d">-                                exprs
</a><a href="#h9-1-12" id="h9-1-12" class="d">-                                    .into_iter()
</a><a href="#h9-1-13" id="h9-1-13" class="d">-                                    .map(|expr| self.build_expression(&amp;mut Scope::constant(), expr))
</a><a href="#h9-1-14" id="h9-1-14" class="d">-                                    .collect::&lt;Result&lt;_&gt;&gt;()
</a><a href="#h9-1-15" id="h9-1-15" class="d">-                            })
</a><a href="#h9-1-16" id="h9-1-16" class="d">-                            .collect::&lt;Result&lt;_&gt;&gt;()?,
</a><a href="#h9-1-17" id="h9-1-17" class="d">-                    },
</a><a href="#h9-1-18" id="h9-1-18" class="i">+                let mut column_map = None;
</a><a href="#h9-1-19" id="h9-1-19" class="i">+                if let Some(columns) = columns {
</a><a href="#h9-1-20" id="h9-1-20" class="i">+                    let column_map = column_map.insert(HashMap::new());
</a><a href="#h9-1-21" id="h9-1-21" class="i">+                    for (vidx, name) in columns.into_iter().enumerate() {
</a><a href="#h9-1-22" id="h9-1-22" class="i">+                        let Some(cidx) = table.columns.iter().position(|c| c.name == name) else {
</a><a href="#h9-1-23" id="h9-1-23" class="i">+                            return errinput!(&quot;unknown column {name} in table {}&quot;, table.name);
</a><a href="#h9-1-24" id="h9-1-24" class="i">+                        };
</a><a href="#h9-1-25" id="h9-1-25" class="i">+                        if column_map.insert(cidx, vidx).is_some() {
</a><a href="#h9-1-26" id="h9-1-26" class="i">+                            return errinput!(&quot;column {name} given multiple times&quot;);
</a><a href="#h9-1-27" id="h9-1-27" class="i">+                        }
</a><a href="#h9-1-28" id="h9-1-28" class="i">+                    }
</a>                 }
<a href="#h9-1-30" id="h9-1-30" class="i">+                let labels = vec![None; values.len()];
</a><a href="#h9-1-31" id="h9-1-31" class="i">+                let rows = values
</a><a href="#h9-1-32" id="h9-1-32" class="i">+                    .into_iter()
</a><a href="#h9-1-33" id="h9-1-33" class="i">+                    .map(|exprs| {
</a><a href="#h9-1-34" id="h9-1-34" class="i">+                        exprs
</a><a href="#h9-1-35" id="h9-1-35" class="i">+                            .into_iter()
</a><a href="#h9-1-36" id="h9-1-36" class="i">+                            .map(|expr| self.build_expression(&amp;mut Scope::constant(), expr))
</a><a href="#h9-1-37" id="h9-1-37" class="i">+                            .collect::&lt;Result&lt;_&gt;&gt;()
</a><a href="#h9-1-38" id="h9-1-38" class="i">+                    })
</a><a href="#h9-1-39" id="h9-1-39" class="i">+                    .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h9-1-40" id="h9-1-40" class="i">+                Plan::Insert { table, column_map, source: Node::Values { labels, rows } }
</a>             }
 
             ast::Statement::Update { table, set, r#where } =&gt; {
<a href="#h9-2" id="h9-2" class="h">@@ -195,12 +202,14 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                     }
 
                     // Build the remaining non-aggregate projection.
<a href="#h9-2-3" id="h9-2-3" class="d">-                    let expressions: Vec&lt;(Expression, Option&lt;String&gt;)&gt; = select
</a><a href="#h9-2-4" id="h9-2-4" class="i">+                    let labels: Vec&lt;_&gt; =
</a><a href="#h9-2-5" id="h9-2-5" class="i">+                        select.iter().map(|(_, l)| l.clone().map(|l| (None, l))).collect();
</a><a href="#h9-2-6" id="h9-2-6" class="i">+                    let expressions: Vec&lt;_&gt; = select
</a>                         .into_iter()
<a href="#h9-2-8" id="h9-2-8" class="d">-                        .map(|(e, l)| Ok((self.build_expression(scope, e)?, l)))
</a><a href="#h9-2-9" id="h9-2-9" class="i">+                        .map(|(e, _)| self.build_expression(scope, e))
</a>                         .collect::&lt;Result&lt;_&gt;&gt;()?;
<a href="#h9-2-11" id="h9-2-11" class="d">-                    scope.project(&amp;expressions)?;
</a><a href="#h9-2-12" id="h9-2-12" class="d">-                    node = Node::Projection { source: Box::new(node), expressions };
</a><a href="#h9-2-13" id="h9-2-13" class="i">+                    scope.project(&amp;expressions, &amp;labels)?;
</a><a href="#h9-2-14" id="h9-2-14" class="i">+                    node = Node::Projection { source: Box::new(node), labels, expressions };
</a>                 };
 
                 // Build HAVING clause.
<a href="#h9-3" id="h9-3" class="h">@@ -256,8 +265,9 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 if hidden &gt; 0 {
                     node = Node::Projection {
                         source: Box::new(node),
<a href="#h9-3-3" id="h9-3-3" class="i">+                        labels: vec![None; scope.len() - hidden],
</a>                         expressions: (0..(scope.len() - hidden))
<a href="#h9-3-5" id="h9-3-5" class="d">-                            .map(|i| (Expression::Field(i, None), None))
</a><a href="#h9-3-6" id="h9-3-6" class="i">+                            .map(|i| Expression::Field(i, None))
</a>                             .collect(),
                     }
                 }
<a href="#h9-4" id="h9-4" class="h">@@ -321,12 +331,13 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 };
                 let mut node = Node::NestedLoopJoin { left, left_size, right, predicate, outer };
                 if matches!(r#type, ast::JoinType::Right) {
<a href="#h9-4-3" id="h9-4-3" class="i">+                    let labels = vec![None; scope.len()];
</a>                     let expressions = (left_size..scope.len())
                         .chain(0..left_size)
<a href="#h9-4-6" id="h9-4-6" class="d">-                        .map(|i| Ok((Expression::Field(i, scope.get_label(i)?), None)))
</a><a href="#h9-4-7" id="h9-4-7" class="i">+                        .map(|i| Ok(Expression::Field(i, scope.get_label(i)?)))
</a>                         .collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?;
<a href="#h9-4-9" id="h9-4-9" class="d">-                    scope.project(&amp;expressions)?;
</a><a href="#h9-4-10" id="h9-4-10" class="d">-                    node = Node::Projection { source: Box::new(node), expressions }
</a><a href="#h9-4-11" id="h9-4-11" class="i">+                    scope.project(&amp;expressions, &amp;labels)?;
</a><a href="#h9-4-12" id="h9-4-12" class="i">+                    node = Node::Projection { source: Box::new(node), labels, expressions }
</a>                 }
                 node
             }
<a href="#h9-5" id="h9-5" class="h">@@ -345,31 +356,35 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>     ) -&gt; Result&lt;Node&gt; {
         let mut aggregates = Vec::new();
         let mut expressions = Vec::new();
<a href="#h9-5-3" id="h9-5-3" class="i">+        let mut labels = Vec::new();
</a>         for (aggregate, expr) in aggregations {
             aggregates.push(aggregate);
<a href="#h9-5-6" id="h9-5-6" class="d">-            expressions.push((self.build_expression(scope, expr)?, None));
</a><a href="#h9-5-7" id="h9-5-7" class="i">+            expressions.push(self.build_expression(scope, expr)?);
</a><a href="#h9-5-8" id="h9-5-8" class="i">+            labels.push(None);
</a>         }
         for (expr, label) in groups {
<a href="#h9-5-11" id="h9-5-11" class="d">-            expressions.push((self.build_expression(scope, expr)?, label));
</a><a href="#h9-5-12" id="h9-5-12" class="i">+            expressions.push(self.build_expression(scope, expr)?);
</a><a href="#h9-5-13" id="h9-5-13" class="i">+            labels.push(label.map(|l| (None, l)));
</a>         }
         scope.project(
             &amp;expressions
                 .iter()
                 .cloned()
                 .enumerate()
<a href="#h9-5-20" id="h9-5-20" class="d">-                .map(|(i, (e, l))| {
</a><a href="#h9-5-21" id="h9-5-21" class="i">+                .map(|(i, e)| {
</a>                     if i &lt; aggregates.len() {
                         // We pass null values here since we don&#39;t want field references to hit
                         // the fields in scope before the aggregation.
<a href="#h9-5-25" id="h9-5-25" class="d">-                        (Expression::Constant(Value::Null), None)
</a><a href="#h9-5-26" id="h9-5-26" class="i">+                        Expression::Constant(Value::Null)
</a>                     } else {
<a href="#h9-5-28" id="h9-5-28" class="d">-                        (e, l)
</a><a href="#h9-5-29" id="h9-5-29" class="i">+                        e
</a>                     }
                 })
                 .collect::&lt;Vec&lt;_&gt;&gt;(),
<a href="#h9-5-33" id="h9-5-33" class="i">+            &amp;labels,
</a>         )?;
         let node = Node::Aggregation {
<a href="#h9-5-36" id="h9-5-36" class="d">-            source: Box::new(Node::Projection { source: Box::new(source), expressions }),
</a><a href="#h9-5-37" id="h9-5-37" class="i">+            source: Box::new(Node::Projection { source: Box::new(source), labels, expressions }),
</a>             aggregates,
         };
         Ok(node)
<a href="#h9-6" id="h9-6" class="h">@@ -788,15 +803,15 @@ impl Scope {
</a> 
     /// Projects the scope. This takes a set of expressions and labels in the current scope,
     /// and returns a new scope for the projection.
<a href="#h9-6-3" id="h9-6-3" class="d">-    fn project(&amp;mut self, projection: &amp;[(Expression, Option&lt;String&gt;)]) -&gt; Result&lt;()&gt; {
</a><a href="#h9-6-4" id="h9-6-4" class="i">+    fn project(&amp;mut self, expressions: &amp;[Expression], labels: &amp;[Option&lt;Label&gt;]) -&gt; Result&lt;()&gt; {
</a>         if self.constant {
             panic!(&quot;can&#39;t modify constant scope&quot;);
         }
         let mut new = Self::new();
         new.tables = self.tables.clone();
<a href="#h9-6-10" id="h9-6-10" class="d">-        for (expr, label) in projection {
</a><a href="#h9-6-11" id="h9-6-11" class="i">+        for (expr, label) in expressions.iter().zip(labels) {
</a>             match (expr, label) {
<a href="#h9-6-13" id="h9-6-13" class="d">-                (_, Some(label)) =&gt; new.add_column(None, Some(label.clone())),
</a><a href="#h9-6-14" id="h9-6-14" class="i">+                (_, Some((None, label))) =&gt; new.add_column(None, Some(label.clone())),
</a>                 (Expression::Field(_, Some((Some(table), name))), _) =&gt; {
                     new.add_column(Some(table.clone()), Some(name.clone()))
                 }
<b>diff --git a/<a id="h10" href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a> b/<a href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -132,6 +132,7 @@ impl Expression {
</a>             // which are interchangeable. NULLs yield NULL.
             //
             // TODO: handle the f64 NaN case.
<a href="#h10-0-3" id="h10-0-3" class="i">+            // TODO: shouldn&#39;t this dispatch to Value.cmp()?
</a>             #[allow(clippy::float_cmp)]
             Self::Equal(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
                 (Boolean(lhs), Boolean(rhs)) =&gt; Boolean(lhs == rhs),
<a href="#h10-1" id="h10-1" class="h">@@ -169,6 +170,8 @@ impl Expression {
</a> 
             // Mathematical operations. Inputs must be numbers, but integers and
             // floats are interchangeable (float when mixed). NULLs yield NULL.
<a href="#h10-1-3" id="h10-1-3" class="i">+            //
</a><a href="#h10-1-4" id="h10-1-4" class="i">+            // TODO: implement Add, CheckedAdd, etc. instead for Value.
</a>             Self::Add(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
                 (Integer(lhs), Integer(rhs)) =&gt; {
                     Integer(lhs.checked_add(rhs).ok_or::&lt;Error&gt;(errinput!(&quot;integer overflow&quot;))?)
<a href="#h10-2" id="h10-2" class="h">@@ -527,3 +530,15 @@ impl Expression {
</a>         .unwrap()
     }
 }
<a href="#h10-2-3" id="h10-2-3" class="i">+
</a><a href="#h10-2-4" id="h10-2-4" class="i">+impl From&lt;Value&gt; for Expression {
</a><a href="#h10-2-5" id="h10-2-5" class="i">+    fn from(value: Value) -&gt; Self {
</a><a href="#h10-2-6" id="h10-2-6" class="i">+        Expression::Constant(value)
</a><a href="#h10-2-7" id="h10-2-7" class="i">+    }
</a><a href="#h10-2-8" id="h10-2-8" class="i">+}
</a><a href="#h10-2-9" id="h10-2-9" class="i">+
</a><a href="#h10-2-10" id="h10-2-10" class="i">+impl From&lt;Value&gt; for Box&lt;Expression&gt; {
</a><a href="#h10-2-11" id="h10-2-11" class="i">+    fn from(value: Value) -&gt; Self {
</a><a href="#h10-2-12" id="h10-2-12" class="i">+        Box::new(value.into())
</a><a href="#h10-2-13" id="h10-2-13" class="i">+    }
</a><a href="#h10-2-14" id="h10-2-14" class="i">+}
</a><b>diff --git a/<a id="h11" href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a> b/<a href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -1,5 +1,6 @@
</a> use crate::encoding;
 use crate::errdata;
<a href="#h11-0-2" id="h11-0-2" class="i">+use crate::errinput;
</a> use crate::error::{Error, Result};
 
 use serde::{Deserialize, Serialize};
<a href="#h11-1" id="h11-1" class="h">@@ -45,7 +46,8 @@ pub enum Value {
</a> 
 impl encoding::Value for Value {}
 
<a href="#h11-1-3" id="h11-1-3" class="d">-// TODO: revisit and document the f64 handling here.
</a><a href="#h11-1-4" id="h11-1-4" class="i">+// TODO: revisit and document the f64 handling here. FWIW, PostgreSQL considers
</a><a href="#h11-1-5" id="h11-1-5" class="i">+// NaN = NaN, maybe we should too.
</a> impl std::cmp::Eq for Value {}
 
 impl std::hash::Hash for Value {
<a href="#h11-2" id="h11-2" class="h">@@ -101,6 +103,37 @@ impl PartialOrd for Value {
</a> }
 
 impl Value {
<a href="#h11-2-3" id="h11-2-3" class="i">+    /// Adds two values, returning a new value. Errors when invalid.
</a><a href="#h11-2-4" id="h11-2-4" class="i">+    pub fn checked_add(&amp;self, other: &amp;Self) -&gt; Result&lt;Self&gt; {
</a><a href="#h11-2-5" id="h11-2-5" class="i">+        use Value::*;
</a><a href="#h11-2-6" id="h11-2-6" class="i">+        Ok(match (self, other) {
</a><a href="#h11-2-7" id="h11-2-7" class="i">+            (Integer(lhs), Integer(rhs)) =&gt; {
</a><a href="#h11-2-8" id="h11-2-8" class="i">+                Integer(lhs.checked_add(*rhs).ok_or::&lt;Error&gt;(errinput!(&quot;integer overflow&quot;))?)
</a><a href="#h11-2-9" id="h11-2-9" class="i">+            }
</a><a href="#h11-2-10" id="h11-2-10" class="i">+            (Integer(lhs), Float(rhs)) =&gt; Float(*lhs as f64 + rhs),
</a><a href="#h11-2-11" id="h11-2-11" class="i">+            (Float(lhs), Integer(rhs)) =&gt; Float(lhs + *rhs as f64),
</a><a href="#h11-2-12" id="h11-2-12" class="i">+            (Float(lhs), Float(rhs)) =&gt; Float(lhs + rhs),
</a><a href="#h11-2-13" id="h11-2-13" class="i">+            (Null, Integer(_) | Float(_) | Null) =&gt; Null,
</a><a href="#h11-2-14" id="h11-2-14" class="i">+            (Integer(_) | Float(_), Null) =&gt; Null,
</a><a href="#h11-2-15" id="h11-2-15" class="i">+            (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t add {lhs} and {rhs}&quot;),
</a><a href="#h11-2-16" id="h11-2-16" class="i">+        })
</a><a href="#h11-2-17" id="h11-2-17" class="i">+    }
</a><a href="#h11-2-18" id="h11-2-18" class="i">+
</a><a href="#h11-2-19" id="h11-2-19" class="i">+    /// Divides two values, returning a new value. Errors when invalid.
</a><a href="#h11-2-20" id="h11-2-20" class="i">+    pub fn checked_div(&amp;self, other: &amp;Self) -&gt; Result&lt;Self&gt; {
</a><a href="#h11-2-21" id="h11-2-21" class="i">+        use Value::*;
</a><a href="#h11-2-22" id="h11-2-22" class="i">+        Ok(match (self, other) {
</a><a href="#h11-2-23" id="h11-2-23" class="i">+            (Integer(_), Integer(0)) =&gt; return errinput!(&quot;can&#39;t divide by zero&quot;),
</a><a href="#h11-2-24" id="h11-2-24" class="i">+            (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs / rhs),
</a><a href="#h11-2-25" id="h11-2-25" class="i">+            (Integer(lhs), Float(rhs)) =&gt; Float(*lhs as f64 / rhs),
</a><a href="#h11-2-26" id="h11-2-26" class="i">+            (Float(lhs), Integer(rhs)) =&gt; Float(lhs / *rhs as f64),
</a><a href="#h11-2-27" id="h11-2-27" class="i">+            (Float(lhs), Float(rhs)) =&gt; Float(lhs / rhs),
</a><a href="#h11-2-28" id="h11-2-28" class="i">+            (Null, Integer(_) | Float(_) | Null) =&gt; Null,
</a><a href="#h11-2-29" id="h11-2-29" class="i">+            (Integer(_) | Float(_), Null) =&gt; Null,
</a><a href="#h11-2-30" id="h11-2-30" class="i">+            (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t divide {lhs} and {rhs}&quot;),
</a><a href="#h11-2-31" id="h11-2-31" class="i">+        })
</a><a href="#h11-2-32" id="h11-2-32" class="i">+    }
</a><a href="#h11-2-33" id="h11-2-33" class="i">+
</a>     /// Returns the value&#39;s datatype, or None for null values.
     pub fn datatype(&amp;self) -&gt; Option&lt;DataType&gt; {
         match self {
<b>diff --git a/<a id="h12" href="../file/tests/sql/mutation/insert_extra.html">tests/sql/mutation/insert_extra</a> b/<a href="../file/tests/sql/mutation/insert_extra.html">tests/sql/mutation/insert_extra</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test VALUES (1, &#39;a&#39;, 100, NULL)
<a href="#h12-0-1" id="h12-0-1" class="d">-Error: InvalidInput(&quot;invalid row size for table test&quot;)
</a><a href="#h12-0-2" id="h12-0-2" class="i">+Error: InvalidInput(&quot;too many values for table test&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h13" href="../file/tests/sql/mutation/insert_missing_column.html">tests/sql/mutation/insert_missing_column</a> b/<a href="../file/tests/sql/mutation/insert_missing_column.html">tests/sql/mutation/insert_missing_column</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test (id, missing) VALUES (0, &#39;x&#39;)
<a href="#h13-0-1" id="h13-0-1" class="d">-Error: InvalidInput(&quot;column missing not found in table test&quot;)
</a><a href="#h13-0-2" id="h13-0-2" class="i">+Error: InvalidInput(&quot;unknown column missing in table test&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h14" href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a> b/<a href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -312,6 +312,7 @@ test_query! {
</a>             INNER JOIN genres g ON m.genre_id = g.id AND g.id = 1
             INNER JOIN studios s ON m.studio_id = s.id AND s.id = 4
         ORDER BY m.title&quot;#,
<a href="#h14-0-3" id="h14-0-3" class="i">+    // TODO: deal with the duplicates here.
</a>     join_inner_multi_same: r#&quot;
         SELECT m.id, m.title, g.name AS genre, s.name AS studio, m.rating
         FROM movies m JOIN genres g ON m.genre_id = g.id,
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a> b/<a href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -6,8 +6,7 @@ Projection: #0, #1, #2, #3, #4
</a>     Projection: b, b, b, b, b
        Scan: booleans (NOT b IS NULL)
 
<a href="#h15-0-3" id="h15-0-3" class="d">-Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h15-0-4" id="h15-0-4" class="d">-[Boolean(false), Boolean(true), Null, Integer(2), Null]
</a><a href="#h15-0-5" id="h15-0-5" class="i">+Error: invalid input: can&#39;t add 0 and TRUE
</a> 
 AST: Select {
     select: [
<a href="#h15-1" id="h15-1" class="h">@@ -148,66 +147,58 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h15-1-3" id="h15-1-3" class="i">+                labels: [
</a><a href="#h15-1-4" id="h15-1-4" class="i">+                    None,
</a><a href="#h15-1-5" id="h15-1-5" class="i">+                    None,
</a><a href="#h15-1-6" id="h15-1-6" class="i">+                    None,
</a><a href="#h15-1-7" id="h15-1-7" class="i">+                    None,
</a><a href="#h15-1-8" id="h15-1-8" class="i">+                    None,
</a><a href="#h15-1-9" id="h15-1-9" class="i">+                ],
</a>                 expressions: [
<a href="#h15-1-11" id="h15-1-11" class="d">-                    (
</a><a href="#h15-1-12" id="h15-1-12" class="d">-                        Field(
</a><a href="#h15-1-13" id="h15-1-13" class="d">-                            1,
</a><a href="#h15-1-14" id="h15-1-14" class="d">-                            Some(
</a><a href="#h15-1-15" id="h15-1-15" class="d">-                                (
</a><a href="#h15-1-16" id="h15-1-16" class="d">-                                    None,
</a><a href="#h15-1-17" id="h15-1-17" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-1-18" id="h15-1-18" class="d">-                                ),
</a><a href="#h15-1-19" id="h15-1-19" class="i">+                    Field(
</a><a href="#h15-1-20" id="h15-1-20" class="i">+                        1,
</a><a href="#h15-1-21" id="h15-1-21" class="i">+                        Some(
</a><a href="#h15-1-22" id="h15-1-22" class="i">+                            (
</a><a href="#h15-1-23" id="h15-1-23" class="i">+                                None,
</a><a href="#h15-1-24" id="h15-1-24" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-1-27" id="h15-1-27" class="d">-                        None,
</a>                     ),
<a href="#h15-1-29" id="h15-1-29" class="d">-                    (
</a><a href="#h15-1-30" id="h15-1-30" class="d">-                        Field(
</a><a href="#h15-1-31" id="h15-1-31" class="d">-                            1,
</a><a href="#h15-1-32" id="h15-1-32" class="d">-                            Some(
</a><a href="#h15-1-33" id="h15-1-33" class="d">-                                (
</a><a href="#h15-1-34" id="h15-1-34" class="d">-                                    None,
</a><a href="#h15-1-35" id="h15-1-35" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-1-36" id="h15-1-36" class="d">-                                ),
</a><a href="#h15-1-37" id="h15-1-37" class="i">+                    Field(
</a><a href="#h15-1-38" id="h15-1-38" class="i">+                        1,
</a><a href="#h15-1-39" id="h15-1-39" class="i">+                        Some(
</a><a href="#h15-1-40" id="h15-1-40" class="i">+                            (
</a><a href="#h15-1-41" id="h15-1-41" class="i">+                                None,
</a><a href="#h15-1-42" id="h15-1-42" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-1-45" id="h15-1-45" class="d">-                        None,
</a>                     ),
<a href="#h15-1-47" id="h15-1-47" class="d">-                    (
</a><a href="#h15-1-48" id="h15-1-48" class="d">-                        Field(
</a><a href="#h15-1-49" id="h15-1-49" class="d">-                            1,
</a><a href="#h15-1-50" id="h15-1-50" class="d">-                            Some(
</a><a href="#h15-1-51" id="h15-1-51" class="d">-                                (
</a><a href="#h15-1-52" id="h15-1-52" class="d">-                                    None,
</a><a href="#h15-1-53" id="h15-1-53" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-1-54" id="h15-1-54" class="d">-                                ),
</a><a href="#h15-1-55" id="h15-1-55" class="i">+                    Field(
</a><a href="#h15-1-56" id="h15-1-56" class="i">+                        1,
</a><a href="#h15-1-57" id="h15-1-57" class="i">+                        Some(
</a><a href="#h15-1-58" id="h15-1-58" class="i">+                            (
</a><a href="#h15-1-59" id="h15-1-59" class="i">+                                None,
</a><a href="#h15-1-60" id="h15-1-60" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-1-63" id="h15-1-63" class="d">-                        None,
</a>                     ),
<a href="#h15-1-65" id="h15-1-65" class="d">-                    (
</a><a href="#h15-1-66" id="h15-1-66" class="d">-                        Field(
</a><a href="#h15-1-67" id="h15-1-67" class="d">-                            1,
</a><a href="#h15-1-68" id="h15-1-68" class="d">-                            Some(
</a><a href="#h15-1-69" id="h15-1-69" class="d">-                                (
</a><a href="#h15-1-70" id="h15-1-70" class="d">-                                    None,
</a><a href="#h15-1-71" id="h15-1-71" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-1-72" id="h15-1-72" class="d">-                                ),
</a><a href="#h15-1-73" id="h15-1-73" class="i">+                    Field(
</a><a href="#h15-1-74" id="h15-1-74" class="i">+                        1,
</a><a href="#h15-1-75" id="h15-1-75" class="i">+                        Some(
</a><a href="#h15-1-76" id="h15-1-76" class="i">+                            (
</a><a href="#h15-1-77" id="h15-1-77" class="i">+                                None,
</a><a href="#h15-1-78" id="h15-1-78" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-1-81" id="h15-1-81" class="d">-                        None,
</a>                     ),
<a href="#h15-1-83" id="h15-1-83" class="d">-                    (
</a><a href="#h15-1-84" id="h15-1-84" class="d">-                        Field(
</a><a href="#h15-1-85" id="h15-1-85" class="d">-                            1,
</a><a href="#h15-1-86" id="h15-1-86" class="d">-                            Some(
</a><a href="#h15-1-87" id="h15-1-87" class="d">-                                (
</a><a href="#h15-1-88" id="h15-1-88" class="d">-                                    None,
</a><a href="#h15-1-89" id="h15-1-89" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-1-90" id="h15-1-90" class="d">-                                ),
</a><a href="#h15-1-91" id="h15-1-91" class="i">+                    Field(
</a><a href="#h15-1-92" id="h15-1-92" class="i">+                        1,
</a><a href="#h15-1-93" id="h15-1-93" class="i">+                        Some(
</a><a href="#h15-1-94" id="h15-1-94" class="i">+                            (
</a><a href="#h15-1-95" id="h15-1-95" class="i">+                                None,
</a><a href="#h15-1-96" id="h15-1-96" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-1-99" id="h15-1-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h15-2" id="h15-2" class="h">@@ -219,40 +210,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h15-2-3" id="h15-2-3" class="i">+        labels: [
</a><a href="#h15-2-4" id="h15-2-4" class="i">+            None,
</a><a href="#h15-2-5" id="h15-2-5" class="i">+            None,
</a><a href="#h15-2-6" id="h15-2-6" class="i">+            None,
</a><a href="#h15-2-7" id="h15-2-7" class="i">+            None,
</a><a href="#h15-2-8" id="h15-2-8" class="i">+            None,
</a><a href="#h15-2-9" id="h15-2-9" class="i">+        ],
</a>         expressions: [
<a href="#h15-2-11" id="h15-2-11" class="d">-            (
</a><a href="#h15-2-12" id="h15-2-12" class="d">-                Field(
</a><a href="#h15-2-13" id="h15-2-13" class="d">-                    0,
</a><a href="#h15-2-14" id="h15-2-14" class="d">-                    None,
</a><a href="#h15-2-15" id="h15-2-15" class="d">-                ),
</a><a href="#h15-2-16" id="h15-2-16" class="i">+            Field(
</a><a href="#h15-2-17" id="h15-2-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h15-2-20" id="h15-2-20" class="d">-            (
</a><a href="#h15-2-21" id="h15-2-21" class="d">-                Field(
</a><a href="#h15-2-22" id="h15-2-22" class="d">-                    1,
</a><a href="#h15-2-23" id="h15-2-23" class="d">-                    None,
</a><a href="#h15-2-24" id="h15-2-24" class="d">-                ),
</a><a href="#h15-2-25" id="h15-2-25" class="i">+            Field(
</a><a href="#h15-2-26" id="h15-2-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h15-2-29" id="h15-2-29" class="d">-            (
</a><a href="#h15-2-30" id="h15-2-30" class="d">-                Field(
</a><a href="#h15-2-31" id="h15-2-31" class="d">-                    2,
</a><a href="#h15-2-32" id="h15-2-32" class="d">-                    None,
</a><a href="#h15-2-33" id="h15-2-33" class="d">-                ),
</a><a href="#h15-2-34" id="h15-2-34" class="i">+            Field(
</a><a href="#h15-2-35" id="h15-2-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h15-2-38" id="h15-2-38" class="d">-            (
</a><a href="#h15-2-39" id="h15-2-39" class="d">-                Field(
</a><a href="#h15-2-40" id="h15-2-40" class="d">-                    3,
</a><a href="#h15-2-41" id="h15-2-41" class="d">-                    None,
</a><a href="#h15-2-42" id="h15-2-42" class="d">-                ),
</a><a href="#h15-2-43" id="h15-2-43" class="i">+            Field(
</a><a href="#h15-2-44" id="h15-2-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h15-2-47" id="h15-2-47" class="d">-            (
</a><a href="#h15-2-48" id="h15-2-48" class="d">-                Field(
</a><a href="#h15-2-49" id="h15-2-49" class="d">-                    4,
</a><a href="#h15-2-50" id="h15-2-50" class="d">-                    None,
</a><a href="#h15-2-51" id="h15-2-51" class="d">-                ),
</a><a href="#h15-2-52" id="h15-2-52" class="i">+            Field(
</a><a href="#h15-2-53" id="h15-2-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h15-3" id="h15-3" class="h">@@ -307,66 +290,58 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h15-3-3" id="h15-3-3" class="i">+                labels: [
</a><a href="#h15-3-4" id="h15-3-4" class="i">+                    None,
</a><a href="#h15-3-5" id="h15-3-5" class="i">+                    None,
</a><a href="#h15-3-6" id="h15-3-6" class="i">+                    None,
</a><a href="#h15-3-7" id="h15-3-7" class="i">+                    None,
</a><a href="#h15-3-8" id="h15-3-8" class="i">+                    None,
</a><a href="#h15-3-9" id="h15-3-9" class="i">+                ],
</a>                 expressions: [
<a href="#h15-3-11" id="h15-3-11" class="d">-                    (
</a><a href="#h15-3-12" id="h15-3-12" class="d">-                        Field(
</a><a href="#h15-3-13" id="h15-3-13" class="d">-                            1,
</a><a href="#h15-3-14" id="h15-3-14" class="d">-                            Some(
</a><a href="#h15-3-15" id="h15-3-15" class="d">-                                (
</a><a href="#h15-3-16" id="h15-3-16" class="d">-                                    None,
</a><a href="#h15-3-17" id="h15-3-17" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-3-18" id="h15-3-18" class="d">-                                ),
</a><a href="#h15-3-19" id="h15-3-19" class="i">+                    Field(
</a><a href="#h15-3-20" id="h15-3-20" class="i">+                        1,
</a><a href="#h15-3-21" id="h15-3-21" class="i">+                        Some(
</a><a href="#h15-3-22" id="h15-3-22" class="i">+                            (
</a><a href="#h15-3-23" id="h15-3-23" class="i">+                                None,
</a><a href="#h15-3-24" id="h15-3-24" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-3-27" id="h15-3-27" class="d">-                        None,
</a>                     ),
<a href="#h15-3-29" id="h15-3-29" class="d">-                    (
</a><a href="#h15-3-30" id="h15-3-30" class="d">-                        Field(
</a><a href="#h15-3-31" id="h15-3-31" class="d">-                            1,
</a><a href="#h15-3-32" id="h15-3-32" class="d">-                            Some(
</a><a href="#h15-3-33" id="h15-3-33" class="d">-                                (
</a><a href="#h15-3-34" id="h15-3-34" class="d">-                                    None,
</a><a href="#h15-3-35" id="h15-3-35" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-3-36" id="h15-3-36" class="d">-                                ),
</a><a href="#h15-3-37" id="h15-3-37" class="i">+                    Field(
</a><a href="#h15-3-38" id="h15-3-38" class="i">+                        1,
</a><a href="#h15-3-39" id="h15-3-39" class="i">+                        Some(
</a><a href="#h15-3-40" id="h15-3-40" class="i">+                            (
</a><a href="#h15-3-41" id="h15-3-41" class="i">+                                None,
</a><a href="#h15-3-42" id="h15-3-42" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-3-45" id="h15-3-45" class="d">-                        None,
</a>                     ),
<a href="#h15-3-47" id="h15-3-47" class="d">-                    (
</a><a href="#h15-3-48" id="h15-3-48" class="d">-                        Field(
</a><a href="#h15-3-49" id="h15-3-49" class="d">-                            1,
</a><a href="#h15-3-50" id="h15-3-50" class="d">-                            Some(
</a><a href="#h15-3-51" id="h15-3-51" class="d">-                                (
</a><a href="#h15-3-52" id="h15-3-52" class="d">-                                    None,
</a><a href="#h15-3-53" id="h15-3-53" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-3-54" id="h15-3-54" class="d">-                                ),
</a><a href="#h15-3-55" id="h15-3-55" class="i">+                    Field(
</a><a href="#h15-3-56" id="h15-3-56" class="i">+                        1,
</a><a href="#h15-3-57" id="h15-3-57" class="i">+                        Some(
</a><a href="#h15-3-58" id="h15-3-58" class="i">+                            (
</a><a href="#h15-3-59" id="h15-3-59" class="i">+                                None,
</a><a href="#h15-3-60" id="h15-3-60" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-3-63" id="h15-3-63" class="d">-                        None,
</a>                     ),
<a href="#h15-3-65" id="h15-3-65" class="d">-                    (
</a><a href="#h15-3-66" id="h15-3-66" class="d">-                        Field(
</a><a href="#h15-3-67" id="h15-3-67" class="d">-                            1,
</a><a href="#h15-3-68" id="h15-3-68" class="d">-                            Some(
</a><a href="#h15-3-69" id="h15-3-69" class="d">-                                (
</a><a href="#h15-3-70" id="h15-3-70" class="d">-                                    None,
</a><a href="#h15-3-71" id="h15-3-71" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-3-72" id="h15-3-72" class="d">-                                ),
</a><a href="#h15-3-73" id="h15-3-73" class="i">+                    Field(
</a><a href="#h15-3-74" id="h15-3-74" class="i">+                        1,
</a><a href="#h15-3-75" id="h15-3-75" class="i">+                        Some(
</a><a href="#h15-3-76" id="h15-3-76" class="i">+                            (
</a><a href="#h15-3-77" id="h15-3-77" class="i">+                                None,
</a><a href="#h15-3-78" id="h15-3-78" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-3-81" id="h15-3-81" class="d">-                        None,
</a>                     ),
<a href="#h15-3-83" id="h15-3-83" class="d">-                    (
</a><a href="#h15-3-84" id="h15-3-84" class="d">-                        Field(
</a><a href="#h15-3-85" id="h15-3-85" class="d">-                            1,
</a><a href="#h15-3-86" id="h15-3-86" class="d">-                            Some(
</a><a href="#h15-3-87" id="h15-3-87" class="d">-                                (
</a><a href="#h15-3-88" id="h15-3-88" class="d">-                                    None,
</a><a href="#h15-3-89" id="h15-3-89" class="d">-                                    &quot;b&quot;,
</a><a href="#h15-3-90" id="h15-3-90" class="d">-                                ),
</a><a href="#h15-3-91" id="h15-3-91" class="i">+                    Field(
</a><a href="#h15-3-92" id="h15-3-92" class="i">+                        1,
</a><a href="#h15-3-93" id="h15-3-93" class="i">+                        Some(
</a><a href="#h15-3-94" id="h15-3-94" class="i">+                            (
</a><a href="#h15-3-95" id="h15-3-95" class="i">+                                None,
</a><a href="#h15-3-96" id="h15-3-96" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h15-3-99" id="h15-3-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h15-4" id="h15-4" class="h">@@ -378,40 +353,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h15-4-3" id="h15-4-3" class="i">+        labels: [
</a><a href="#h15-4-4" id="h15-4-4" class="i">+            None,
</a><a href="#h15-4-5" id="h15-4-5" class="i">+            None,
</a><a href="#h15-4-6" id="h15-4-6" class="i">+            None,
</a><a href="#h15-4-7" id="h15-4-7" class="i">+            None,
</a><a href="#h15-4-8" id="h15-4-8" class="i">+            None,
</a><a href="#h15-4-9" id="h15-4-9" class="i">+        ],
</a>         expressions: [
<a href="#h15-4-11" id="h15-4-11" class="d">-            (
</a><a href="#h15-4-12" id="h15-4-12" class="d">-                Field(
</a><a href="#h15-4-13" id="h15-4-13" class="d">-                    0,
</a><a href="#h15-4-14" id="h15-4-14" class="d">-                    None,
</a><a href="#h15-4-15" id="h15-4-15" class="d">-                ),
</a><a href="#h15-4-16" id="h15-4-16" class="i">+            Field(
</a><a href="#h15-4-17" id="h15-4-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h15-4-20" id="h15-4-20" class="d">-            (
</a><a href="#h15-4-21" id="h15-4-21" class="d">-                Field(
</a><a href="#h15-4-22" id="h15-4-22" class="d">-                    1,
</a><a href="#h15-4-23" id="h15-4-23" class="d">-                    None,
</a><a href="#h15-4-24" id="h15-4-24" class="d">-                ),
</a><a href="#h15-4-25" id="h15-4-25" class="i">+            Field(
</a><a href="#h15-4-26" id="h15-4-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h15-4-29" id="h15-4-29" class="d">-            (
</a><a href="#h15-4-30" id="h15-4-30" class="d">-                Field(
</a><a href="#h15-4-31" id="h15-4-31" class="d">-                    2,
</a><a href="#h15-4-32" id="h15-4-32" class="d">-                    None,
</a><a href="#h15-4-33" id="h15-4-33" class="d">-                ),
</a><a href="#h15-4-34" id="h15-4-34" class="i">+            Field(
</a><a href="#h15-4-35" id="h15-4-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h15-4-38" id="h15-4-38" class="d">-            (
</a><a href="#h15-4-39" id="h15-4-39" class="d">-                Field(
</a><a href="#h15-4-40" id="h15-4-40" class="d">-                    3,
</a><a href="#h15-4-41" id="h15-4-41" class="d">-                    None,
</a><a href="#h15-4-42" id="h15-4-42" class="d">-                ),
</a><a href="#h15-4-43" id="h15-4-43" class="i">+            Field(
</a><a href="#h15-4-44" id="h15-4-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h15-4-47" id="h15-4-47" class="d">-            (
</a><a href="#h15-4-48" id="h15-4-48" class="d">-                Field(
</a><a href="#h15-4-49" id="h15-4-49" class="d">-                    4,
</a><a href="#h15-4-50" id="h15-4-50" class="d">-                    None,
</a><a href="#h15-4-51" id="h15-4-51" class="d">-                ),
</a><a href="#h15-4-52" id="h15-4-52" class="i">+            Field(
</a><a href="#h15-4-53" id="h15-4-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a> b/<a href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -6,8 +6,7 @@ Projection: #0, #1, #2, #3, #4
</a>     Projection: b, b, b, b, b
        Scan: booleans
 
<a href="#h16-0-3" id="h16-0-3" class="d">-Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h16-0-4" id="h16-0-4" class="d">-[Null, Null, Null, Integer(2), Null]
</a><a href="#h16-0-5" id="h16-0-5" class="i">+Error: invalid input: can&#39;t add 0 and TRUE
</a> 
 AST: Select {
     select: [
<a href="#h16-1" id="h16-1" class="h">@@ -120,66 +119,58 @@ Plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h16-1-3" id="h16-1-3" class="i">+                labels: [
</a><a href="#h16-1-4" id="h16-1-4" class="i">+                    None,
</a><a href="#h16-1-5" id="h16-1-5" class="i">+                    None,
</a><a href="#h16-1-6" id="h16-1-6" class="i">+                    None,
</a><a href="#h16-1-7" id="h16-1-7" class="i">+                    None,
</a><a href="#h16-1-8" id="h16-1-8" class="i">+                    None,
</a><a href="#h16-1-9" id="h16-1-9" class="i">+                ],
</a>                 expressions: [
<a href="#h16-1-11" id="h16-1-11" class="d">-                    (
</a><a href="#h16-1-12" id="h16-1-12" class="d">-                        Field(
</a><a href="#h16-1-13" id="h16-1-13" class="d">-                            1,
</a><a href="#h16-1-14" id="h16-1-14" class="d">-                            Some(
</a><a href="#h16-1-15" id="h16-1-15" class="d">-                                (
</a><a href="#h16-1-16" id="h16-1-16" class="d">-                                    None,
</a><a href="#h16-1-17" id="h16-1-17" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-1-18" id="h16-1-18" class="d">-                                ),
</a><a href="#h16-1-19" id="h16-1-19" class="i">+                    Field(
</a><a href="#h16-1-20" id="h16-1-20" class="i">+                        1,
</a><a href="#h16-1-21" id="h16-1-21" class="i">+                        Some(
</a><a href="#h16-1-22" id="h16-1-22" class="i">+                            (
</a><a href="#h16-1-23" id="h16-1-23" class="i">+                                None,
</a><a href="#h16-1-24" id="h16-1-24" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-1-27" id="h16-1-27" class="d">-                        None,
</a>                     ),
<a href="#h16-1-29" id="h16-1-29" class="d">-                    (
</a><a href="#h16-1-30" id="h16-1-30" class="d">-                        Field(
</a><a href="#h16-1-31" id="h16-1-31" class="d">-                            1,
</a><a href="#h16-1-32" id="h16-1-32" class="d">-                            Some(
</a><a href="#h16-1-33" id="h16-1-33" class="d">-                                (
</a><a href="#h16-1-34" id="h16-1-34" class="d">-                                    None,
</a><a href="#h16-1-35" id="h16-1-35" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-1-36" id="h16-1-36" class="d">-                                ),
</a><a href="#h16-1-37" id="h16-1-37" class="i">+                    Field(
</a><a href="#h16-1-38" id="h16-1-38" class="i">+                        1,
</a><a href="#h16-1-39" id="h16-1-39" class="i">+                        Some(
</a><a href="#h16-1-40" id="h16-1-40" class="i">+                            (
</a><a href="#h16-1-41" id="h16-1-41" class="i">+                                None,
</a><a href="#h16-1-42" id="h16-1-42" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-1-45" id="h16-1-45" class="d">-                        None,
</a>                     ),
<a href="#h16-1-47" id="h16-1-47" class="d">-                    (
</a><a href="#h16-1-48" id="h16-1-48" class="d">-                        Field(
</a><a href="#h16-1-49" id="h16-1-49" class="d">-                            1,
</a><a href="#h16-1-50" id="h16-1-50" class="d">-                            Some(
</a><a href="#h16-1-51" id="h16-1-51" class="d">-                                (
</a><a href="#h16-1-52" id="h16-1-52" class="d">-                                    None,
</a><a href="#h16-1-53" id="h16-1-53" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-1-54" id="h16-1-54" class="d">-                                ),
</a><a href="#h16-1-55" id="h16-1-55" class="i">+                    Field(
</a><a href="#h16-1-56" id="h16-1-56" class="i">+                        1,
</a><a href="#h16-1-57" id="h16-1-57" class="i">+                        Some(
</a><a href="#h16-1-58" id="h16-1-58" class="i">+                            (
</a><a href="#h16-1-59" id="h16-1-59" class="i">+                                None,
</a><a href="#h16-1-60" id="h16-1-60" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-1-63" id="h16-1-63" class="d">-                        None,
</a>                     ),
<a href="#h16-1-65" id="h16-1-65" class="d">-                    (
</a><a href="#h16-1-66" id="h16-1-66" class="d">-                        Field(
</a><a href="#h16-1-67" id="h16-1-67" class="d">-                            1,
</a><a href="#h16-1-68" id="h16-1-68" class="d">-                            Some(
</a><a href="#h16-1-69" id="h16-1-69" class="d">-                                (
</a><a href="#h16-1-70" id="h16-1-70" class="d">-                                    None,
</a><a href="#h16-1-71" id="h16-1-71" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-1-72" id="h16-1-72" class="d">-                                ),
</a><a href="#h16-1-73" id="h16-1-73" class="i">+                    Field(
</a><a href="#h16-1-74" id="h16-1-74" class="i">+                        1,
</a><a href="#h16-1-75" id="h16-1-75" class="i">+                        Some(
</a><a href="#h16-1-76" id="h16-1-76" class="i">+                            (
</a><a href="#h16-1-77" id="h16-1-77" class="i">+                                None,
</a><a href="#h16-1-78" id="h16-1-78" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-1-81" id="h16-1-81" class="d">-                        None,
</a>                     ),
<a href="#h16-1-83" id="h16-1-83" class="d">-                    (
</a><a href="#h16-1-84" id="h16-1-84" class="d">-                        Field(
</a><a href="#h16-1-85" id="h16-1-85" class="d">-                            1,
</a><a href="#h16-1-86" id="h16-1-86" class="d">-                            Some(
</a><a href="#h16-1-87" id="h16-1-87" class="d">-                                (
</a><a href="#h16-1-88" id="h16-1-88" class="d">-                                    None,
</a><a href="#h16-1-89" id="h16-1-89" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-1-90" id="h16-1-90" class="d">-                                ),
</a><a href="#h16-1-91" id="h16-1-91" class="i">+                    Field(
</a><a href="#h16-1-92" id="h16-1-92" class="i">+                        1,
</a><a href="#h16-1-93" id="h16-1-93" class="i">+                        Some(
</a><a href="#h16-1-94" id="h16-1-94" class="i">+                            (
</a><a href="#h16-1-95" id="h16-1-95" class="i">+                                None,
</a><a href="#h16-1-96" id="h16-1-96" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-1-99" id="h16-1-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h16-2" id="h16-2" class="h">@@ -191,40 +182,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h16-2-3" id="h16-2-3" class="i">+        labels: [
</a><a href="#h16-2-4" id="h16-2-4" class="i">+            None,
</a><a href="#h16-2-5" id="h16-2-5" class="i">+            None,
</a><a href="#h16-2-6" id="h16-2-6" class="i">+            None,
</a><a href="#h16-2-7" id="h16-2-7" class="i">+            None,
</a><a href="#h16-2-8" id="h16-2-8" class="i">+            None,
</a><a href="#h16-2-9" id="h16-2-9" class="i">+        ],
</a>         expressions: [
<a href="#h16-2-11" id="h16-2-11" class="d">-            (
</a><a href="#h16-2-12" id="h16-2-12" class="d">-                Field(
</a><a href="#h16-2-13" id="h16-2-13" class="d">-                    0,
</a><a href="#h16-2-14" id="h16-2-14" class="d">-                    None,
</a><a href="#h16-2-15" id="h16-2-15" class="d">-                ),
</a><a href="#h16-2-16" id="h16-2-16" class="i">+            Field(
</a><a href="#h16-2-17" id="h16-2-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h16-2-20" id="h16-2-20" class="d">-            (
</a><a href="#h16-2-21" id="h16-2-21" class="d">-                Field(
</a><a href="#h16-2-22" id="h16-2-22" class="d">-                    1,
</a><a href="#h16-2-23" id="h16-2-23" class="d">-                    None,
</a><a href="#h16-2-24" id="h16-2-24" class="d">-                ),
</a><a href="#h16-2-25" id="h16-2-25" class="i">+            Field(
</a><a href="#h16-2-26" id="h16-2-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h16-2-29" id="h16-2-29" class="d">-            (
</a><a href="#h16-2-30" id="h16-2-30" class="d">-                Field(
</a><a href="#h16-2-31" id="h16-2-31" class="d">-                    2,
</a><a href="#h16-2-32" id="h16-2-32" class="d">-                    None,
</a><a href="#h16-2-33" id="h16-2-33" class="d">-                ),
</a><a href="#h16-2-34" id="h16-2-34" class="i">+            Field(
</a><a href="#h16-2-35" id="h16-2-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h16-2-38" id="h16-2-38" class="d">-            (
</a><a href="#h16-2-39" id="h16-2-39" class="d">-                Field(
</a><a href="#h16-2-40" id="h16-2-40" class="d">-                    3,
</a><a href="#h16-2-41" id="h16-2-41" class="d">-                    None,
</a><a href="#h16-2-42" id="h16-2-42" class="d">-                ),
</a><a href="#h16-2-43" id="h16-2-43" class="i">+            Field(
</a><a href="#h16-2-44" id="h16-2-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h16-2-47" id="h16-2-47" class="d">-            (
</a><a href="#h16-2-48" id="h16-2-48" class="d">-                Field(
</a><a href="#h16-2-49" id="h16-2-49" class="d">-                    4,
</a><a href="#h16-2-50" id="h16-2-50" class="d">-                    None,
</a><a href="#h16-2-51" id="h16-2-51" class="d">-                ),
</a><a href="#h16-2-52" id="h16-2-52" class="i">+            Field(
</a><a href="#h16-2-53" id="h16-2-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h16-3" id="h16-3" class="h">@@ -265,66 +248,58 @@ Optimized plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h16-3-3" id="h16-3-3" class="i">+                labels: [
</a><a href="#h16-3-4" id="h16-3-4" class="i">+                    None,
</a><a href="#h16-3-5" id="h16-3-5" class="i">+                    None,
</a><a href="#h16-3-6" id="h16-3-6" class="i">+                    None,
</a><a href="#h16-3-7" id="h16-3-7" class="i">+                    None,
</a><a href="#h16-3-8" id="h16-3-8" class="i">+                    None,
</a><a href="#h16-3-9" id="h16-3-9" class="i">+                ],
</a>                 expressions: [
<a href="#h16-3-11" id="h16-3-11" class="d">-                    (
</a><a href="#h16-3-12" id="h16-3-12" class="d">-                        Field(
</a><a href="#h16-3-13" id="h16-3-13" class="d">-                            1,
</a><a href="#h16-3-14" id="h16-3-14" class="d">-                            Some(
</a><a href="#h16-3-15" id="h16-3-15" class="d">-                                (
</a><a href="#h16-3-16" id="h16-3-16" class="d">-                                    None,
</a><a href="#h16-3-17" id="h16-3-17" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-3-18" id="h16-3-18" class="d">-                                ),
</a><a href="#h16-3-19" id="h16-3-19" class="i">+                    Field(
</a><a href="#h16-3-20" id="h16-3-20" class="i">+                        1,
</a><a href="#h16-3-21" id="h16-3-21" class="i">+                        Some(
</a><a href="#h16-3-22" id="h16-3-22" class="i">+                            (
</a><a href="#h16-3-23" id="h16-3-23" class="i">+                                None,
</a><a href="#h16-3-24" id="h16-3-24" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-3-27" id="h16-3-27" class="d">-                        None,
</a>                     ),
<a href="#h16-3-29" id="h16-3-29" class="d">-                    (
</a><a href="#h16-3-30" id="h16-3-30" class="d">-                        Field(
</a><a href="#h16-3-31" id="h16-3-31" class="d">-                            1,
</a><a href="#h16-3-32" id="h16-3-32" class="d">-                            Some(
</a><a href="#h16-3-33" id="h16-3-33" class="d">-                                (
</a><a href="#h16-3-34" id="h16-3-34" class="d">-                                    None,
</a><a href="#h16-3-35" id="h16-3-35" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-3-36" id="h16-3-36" class="d">-                                ),
</a><a href="#h16-3-37" id="h16-3-37" class="i">+                    Field(
</a><a href="#h16-3-38" id="h16-3-38" class="i">+                        1,
</a><a href="#h16-3-39" id="h16-3-39" class="i">+                        Some(
</a><a href="#h16-3-40" id="h16-3-40" class="i">+                            (
</a><a href="#h16-3-41" id="h16-3-41" class="i">+                                None,
</a><a href="#h16-3-42" id="h16-3-42" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-3-45" id="h16-3-45" class="d">-                        None,
</a>                     ),
<a href="#h16-3-47" id="h16-3-47" class="d">-                    (
</a><a href="#h16-3-48" id="h16-3-48" class="d">-                        Field(
</a><a href="#h16-3-49" id="h16-3-49" class="d">-                            1,
</a><a href="#h16-3-50" id="h16-3-50" class="d">-                            Some(
</a><a href="#h16-3-51" id="h16-3-51" class="d">-                                (
</a><a href="#h16-3-52" id="h16-3-52" class="d">-                                    None,
</a><a href="#h16-3-53" id="h16-3-53" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-3-54" id="h16-3-54" class="d">-                                ),
</a><a href="#h16-3-55" id="h16-3-55" class="i">+                    Field(
</a><a href="#h16-3-56" id="h16-3-56" class="i">+                        1,
</a><a href="#h16-3-57" id="h16-3-57" class="i">+                        Some(
</a><a href="#h16-3-58" id="h16-3-58" class="i">+                            (
</a><a href="#h16-3-59" id="h16-3-59" class="i">+                                None,
</a><a href="#h16-3-60" id="h16-3-60" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-3-63" id="h16-3-63" class="d">-                        None,
</a>                     ),
<a href="#h16-3-65" id="h16-3-65" class="d">-                    (
</a><a href="#h16-3-66" id="h16-3-66" class="d">-                        Field(
</a><a href="#h16-3-67" id="h16-3-67" class="d">-                            1,
</a><a href="#h16-3-68" id="h16-3-68" class="d">-                            Some(
</a><a href="#h16-3-69" id="h16-3-69" class="d">-                                (
</a><a href="#h16-3-70" id="h16-3-70" class="d">-                                    None,
</a><a href="#h16-3-71" id="h16-3-71" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-3-72" id="h16-3-72" class="d">-                                ),
</a><a href="#h16-3-73" id="h16-3-73" class="i">+                    Field(
</a><a href="#h16-3-74" id="h16-3-74" class="i">+                        1,
</a><a href="#h16-3-75" id="h16-3-75" class="i">+                        Some(
</a><a href="#h16-3-76" id="h16-3-76" class="i">+                            (
</a><a href="#h16-3-77" id="h16-3-77" class="i">+                                None,
</a><a href="#h16-3-78" id="h16-3-78" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-3-81" id="h16-3-81" class="d">-                        None,
</a>                     ),
<a href="#h16-3-83" id="h16-3-83" class="d">-                    (
</a><a href="#h16-3-84" id="h16-3-84" class="d">-                        Field(
</a><a href="#h16-3-85" id="h16-3-85" class="d">-                            1,
</a><a href="#h16-3-86" id="h16-3-86" class="d">-                            Some(
</a><a href="#h16-3-87" id="h16-3-87" class="d">-                                (
</a><a href="#h16-3-88" id="h16-3-88" class="d">-                                    None,
</a><a href="#h16-3-89" id="h16-3-89" class="d">-                                    &quot;b&quot;,
</a><a href="#h16-3-90" id="h16-3-90" class="d">-                                ),
</a><a href="#h16-3-91" id="h16-3-91" class="i">+                    Field(
</a><a href="#h16-3-92" id="h16-3-92" class="i">+                        1,
</a><a href="#h16-3-93" id="h16-3-93" class="i">+                        Some(
</a><a href="#h16-3-94" id="h16-3-94" class="i">+                            (
</a><a href="#h16-3-95" id="h16-3-95" class="i">+                                None,
</a><a href="#h16-3-96" id="h16-3-96" class="i">+                                &quot;b&quot;,
</a>                             ),
                         ),
<a href="#h16-3-99" id="h16-3-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h16-4" id="h16-4" class="h">@@ -336,40 +311,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h16-4-3" id="h16-4-3" class="i">+        labels: [
</a><a href="#h16-4-4" id="h16-4-4" class="i">+            None,
</a><a href="#h16-4-5" id="h16-4-5" class="i">+            None,
</a><a href="#h16-4-6" id="h16-4-6" class="i">+            None,
</a><a href="#h16-4-7" id="h16-4-7" class="i">+            None,
</a><a href="#h16-4-8" id="h16-4-8" class="i">+            None,
</a><a href="#h16-4-9" id="h16-4-9" class="i">+        ],
</a>         expressions: [
<a href="#h16-4-11" id="h16-4-11" class="d">-            (
</a><a href="#h16-4-12" id="h16-4-12" class="d">-                Field(
</a><a href="#h16-4-13" id="h16-4-13" class="d">-                    0,
</a><a href="#h16-4-14" id="h16-4-14" class="d">-                    None,
</a><a href="#h16-4-15" id="h16-4-15" class="d">-                ),
</a><a href="#h16-4-16" id="h16-4-16" class="i">+            Field(
</a><a href="#h16-4-17" id="h16-4-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h16-4-20" id="h16-4-20" class="d">-            (
</a><a href="#h16-4-21" id="h16-4-21" class="d">-                Field(
</a><a href="#h16-4-22" id="h16-4-22" class="d">-                    1,
</a><a href="#h16-4-23" id="h16-4-23" class="d">-                    None,
</a><a href="#h16-4-24" id="h16-4-24" class="d">-                ),
</a><a href="#h16-4-25" id="h16-4-25" class="i">+            Field(
</a><a href="#h16-4-26" id="h16-4-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h16-4-29" id="h16-4-29" class="d">-            (
</a><a href="#h16-4-30" id="h16-4-30" class="d">-                Field(
</a><a href="#h16-4-31" id="h16-4-31" class="d">-                    2,
</a><a href="#h16-4-32" id="h16-4-32" class="d">-                    None,
</a><a href="#h16-4-33" id="h16-4-33" class="d">-                ),
</a><a href="#h16-4-34" id="h16-4-34" class="i">+            Field(
</a><a href="#h16-4-35" id="h16-4-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h16-4-38" id="h16-4-38" class="d">-            (
</a><a href="#h16-4-39" id="h16-4-39" class="d">-                Field(
</a><a href="#h16-4-40" id="h16-4-40" class="d">-                    3,
</a><a href="#h16-4-41" id="h16-4-41" class="d">-                    None,
</a><a href="#h16-4-42" id="h16-4-42" class="d">-                ),
</a><a href="#h16-4-43" id="h16-4-43" class="i">+            Field(
</a><a href="#h16-4-44" id="h16-4-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h16-4-47" id="h16-4-47" class="d">-            (
</a><a href="#h16-4-48" id="h16-4-48" class="d">-                Field(
</a><a href="#h16-4-49" id="h16-4-49" class="d">-                    4,
</a><a href="#h16-4-50" id="h16-4-50" class="d">-                    None,
</a><a href="#h16-4-51" id="h16-4-51" class="d">-                ),
</a><a href="#h16-4-52" id="h16-4-52" class="i">+            Field(
</a><a href="#h16-4-53" id="h16-4-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/agg_const.html">tests/sql/query/agg_const</a> b/<a href="../file/tests/sql/query/agg_const.html">tests/sql/query/agg_const</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -91,46 +91,38 @@ Plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Nothing,
<a href="#h17-0-3" id="h17-0-3" class="i">+                labels: [
</a><a href="#h17-0-4" id="h17-0-4" class="i">+                    None,
</a><a href="#h17-0-5" id="h17-0-5" class="i">+                    None,
</a><a href="#h17-0-6" id="h17-0-6" class="i">+                    None,
</a><a href="#h17-0-7" id="h17-0-7" class="i">+                    None,
</a><a href="#h17-0-8" id="h17-0-8" class="i">+                    None,
</a><a href="#h17-0-9" id="h17-0-9" class="i">+                ],
</a>                 expressions: [
<a href="#h17-0-11" id="h17-0-11" class="d">-                    (
</a><a href="#h17-0-12" id="h17-0-12" class="d">-                        Constant(
</a><a href="#h17-0-13" id="h17-0-13" class="d">-                            Integer(
</a><a href="#h17-0-14" id="h17-0-14" class="d">-                                3,
</a><a href="#h17-0-15" id="h17-0-15" class="d">-                            ),
</a><a href="#h17-0-16" id="h17-0-16" class="i">+                    Constant(
</a><a href="#h17-0-17" id="h17-0-17" class="i">+                        Integer(
</a><a href="#h17-0-18" id="h17-0-18" class="i">+                            3,
</a>                         ),
<a href="#h17-0-20" id="h17-0-20" class="d">-                        None,
</a>                     ),
<a href="#h17-0-22" id="h17-0-22" class="d">-                    (
</a><a href="#h17-0-23" id="h17-0-23" class="d">-                        Constant(
</a><a href="#h17-0-24" id="h17-0-24" class="d">-                            Integer(
</a><a href="#h17-0-25" id="h17-0-25" class="d">-                                3,
</a><a href="#h17-0-26" id="h17-0-26" class="d">-                            ),
</a><a href="#h17-0-27" id="h17-0-27" class="i">+                    Constant(
</a><a href="#h17-0-28" id="h17-0-28" class="i">+                        Integer(
</a><a href="#h17-0-29" id="h17-0-29" class="i">+                            3,
</a>                         ),
<a href="#h17-0-31" id="h17-0-31" class="d">-                        None,
</a>                     ),
<a href="#h17-0-33" id="h17-0-33" class="d">-                    (
</a><a href="#h17-0-34" id="h17-0-34" class="d">-                        Constant(
</a><a href="#h17-0-35" id="h17-0-35" class="d">-                            Integer(
</a><a href="#h17-0-36" id="h17-0-36" class="d">-                                3,
</a><a href="#h17-0-37" id="h17-0-37" class="d">-                            ),
</a><a href="#h17-0-38" id="h17-0-38" class="i">+                    Constant(
</a><a href="#h17-0-39" id="h17-0-39" class="i">+                        Integer(
</a><a href="#h17-0-40" id="h17-0-40" class="i">+                            3,
</a>                         ),
<a href="#h17-0-42" id="h17-0-42" class="d">-                        None,
</a>                     ),
<a href="#h17-0-44" id="h17-0-44" class="d">-                    (
</a><a href="#h17-0-45" id="h17-0-45" class="d">-                        Constant(
</a><a href="#h17-0-46" id="h17-0-46" class="d">-                            Integer(
</a><a href="#h17-0-47" id="h17-0-47" class="d">-                                3,
</a><a href="#h17-0-48" id="h17-0-48" class="d">-                            ),
</a><a href="#h17-0-49" id="h17-0-49" class="i">+                    Constant(
</a><a href="#h17-0-50" id="h17-0-50" class="i">+                        Integer(
</a><a href="#h17-0-51" id="h17-0-51" class="i">+                            3,
</a>                         ),
<a href="#h17-0-53" id="h17-0-53" class="d">-                        None,
</a>                     ),
<a href="#h17-0-55" id="h17-0-55" class="d">-                    (
</a><a href="#h17-0-56" id="h17-0-56" class="d">-                        Constant(
</a><a href="#h17-0-57" id="h17-0-57" class="d">-                            Integer(
</a><a href="#h17-0-58" id="h17-0-58" class="d">-                                3,
</a><a href="#h17-0-59" id="h17-0-59" class="d">-                            ),
</a><a href="#h17-0-60" id="h17-0-60" class="i">+                    Constant(
</a><a href="#h17-0-61" id="h17-0-61" class="i">+                        Integer(
</a><a href="#h17-0-62" id="h17-0-62" class="i">+                            3,
</a>                         ),
<a href="#h17-0-64" id="h17-0-64" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h17-1" id="h17-1" class="h">@@ -142,40 +134,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h17-1-3" id="h17-1-3" class="i">+        labels: [
</a><a href="#h17-1-4" id="h17-1-4" class="i">+            None,
</a><a href="#h17-1-5" id="h17-1-5" class="i">+            None,
</a><a href="#h17-1-6" id="h17-1-6" class="i">+            None,
</a><a href="#h17-1-7" id="h17-1-7" class="i">+            None,
</a><a href="#h17-1-8" id="h17-1-8" class="i">+            None,
</a><a href="#h17-1-9" id="h17-1-9" class="i">+        ],
</a>         expressions: [
<a href="#h17-1-11" id="h17-1-11" class="d">-            (
</a><a href="#h17-1-12" id="h17-1-12" class="d">-                Field(
</a><a href="#h17-1-13" id="h17-1-13" class="d">-                    0,
</a><a href="#h17-1-14" id="h17-1-14" class="d">-                    None,
</a><a href="#h17-1-15" id="h17-1-15" class="d">-                ),
</a><a href="#h17-1-16" id="h17-1-16" class="i">+            Field(
</a><a href="#h17-1-17" id="h17-1-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h17-1-20" id="h17-1-20" class="d">-            (
</a><a href="#h17-1-21" id="h17-1-21" class="d">-                Field(
</a><a href="#h17-1-22" id="h17-1-22" class="d">-                    1,
</a><a href="#h17-1-23" id="h17-1-23" class="d">-                    None,
</a><a href="#h17-1-24" id="h17-1-24" class="d">-                ),
</a><a href="#h17-1-25" id="h17-1-25" class="i">+            Field(
</a><a href="#h17-1-26" id="h17-1-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h17-1-29" id="h17-1-29" class="d">-            (
</a><a href="#h17-1-30" id="h17-1-30" class="d">-                Field(
</a><a href="#h17-1-31" id="h17-1-31" class="d">-                    2,
</a><a href="#h17-1-32" id="h17-1-32" class="d">-                    None,
</a><a href="#h17-1-33" id="h17-1-33" class="d">-                ),
</a><a href="#h17-1-34" id="h17-1-34" class="i">+            Field(
</a><a href="#h17-1-35" id="h17-1-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h17-1-38" id="h17-1-38" class="d">-            (
</a><a href="#h17-1-39" id="h17-1-39" class="d">-                Field(
</a><a href="#h17-1-40" id="h17-1-40" class="d">-                    3,
</a><a href="#h17-1-41" id="h17-1-41" class="d">-                    None,
</a><a href="#h17-1-42" id="h17-1-42" class="d">-                ),
</a><a href="#h17-1-43" id="h17-1-43" class="i">+            Field(
</a><a href="#h17-1-44" id="h17-1-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h17-1-47" id="h17-1-47" class="d">-            (
</a><a href="#h17-1-48" id="h17-1-48" class="d">-                Field(
</a><a href="#h17-1-49" id="h17-1-49" class="d">-                    4,
</a><a href="#h17-1-50" id="h17-1-50" class="d">-                    None,
</a><a href="#h17-1-51" id="h17-1-51" class="d">-                ),
</a><a href="#h17-1-52" id="h17-1-52" class="i">+            Field(
</a><a href="#h17-1-53" id="h17-1-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h17-2" id="h17-2" class="h">@@ -187,46 +171,38 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Nothing,
<a href="#h17-2-3" id="h17-2-3" class="i">+                labels: [
</a><a href="#h17-2-4" id="h17-2-4" class="i">+                    None,
</a><a href="#h17-2-5" id="h17-2-5" class="i">+                    None,
</a><a href="#h17-2-6" id="h17-2-6" class="i">+                    None,
</a><a href="#h17-2-7" id="h17-2-7" class="i">+                    None,
</a><a href="#h17-2-8" id="h17-2-8" class="i">+                    None,
</a><a href="#h17-2-9" id="h17-2-9" class="i">+                ],
</a>                 expressions: [
<a href="#h17-2-11" id="h17-2-11" class="d">-                    (
</a><a href="#h17-2-12" id="h17-2-12" class="d">-                        Constant(
</a><a href="#h17-2-13" id="h17-2-13" class="d">-                            Integer(
</a><a href="#h17-2-14" id="h17-2-14" class="d">-                                3,
</a><a href="#h17-2-15" id="h17-2-15" class="d">-                            ),
</a><a href="#h17-2-16" id="h17-2-16" class="i">+                    Constant(
</a><a href="#h17-2-17" id="h17-2-17" class="i">+                        Integer(
</a><a href="#h17-2-18" id="h17-2-18" class="i">+                            3,
</a>                         ),
<a href="#h17-2-20" id="h17-2-20" class="d">-                        None,
</a>                     ),
<a href="#h17-2-22" id="h17-2-22" class="d">-                    (
</a><a href="#h17-2-23" id="h17-2-23" class="d">-                        Constant(
</a><a href="#h17-2-24" id="h17-2-24" class="d">-                            Integer(
</a><a href="#h17-2-25" id="h17-2-25" class="d">-                                3,
</a><a href="#h17-2-26" id="h17-2-26" class="d">-                            ),
</a><a href="#h17-2-27" id="h17-2-27" class="i">+                    Constant(
</a><a href="#h17-2-28" id="h17-2-28" class="i">+                        Integer(
</a><a href="#h17-2-29" id="h17-2-29" class="i">+                            3,
</a>                         ),
<a href="#h17-2-31" id="h17-2-31" class="d">-                        None,
</a>                     ),
<a href="#h17-2-33" id="h17-2-33" class="d">-                    (
</a><a href="#h17-2-34" id="h17-2-34" class="d">-                        Constant(
</a><a href="#h17-2-35" id="h17-2-35" class="d">-                            Integer(
</a><a href="#h17-2-36" id="h17-2-36" class="d">-                                3,
</a><a href="#h17-2-37" id="h17-2-37" class="d">-                            ),
</a><a href="#h17-2-38" id="h17-2-38" class="i">+                    Constant(
</a><a href="#h17-2-39" id="h17-2-39" class="i">+                        Integer(
</a><a href="#h17-2-40" id="h17-2-40" class="i">+                            3,
</a>                         ),
<a href="#h17-2-42" id="h17-2-42" class="d">-                        None,
</a>                     ),
<a href="#h17-2-44" id="h17-2-44" class="d">-                    (
</a><a href="#h17-2-45" id="h17-2-45" class="d">-                        Constant(
</a><a href="#h17-2-46" id="h17-2-46" class="d">-                            Integer(
</a><a href="#h17-2-47" id="h17-2-47" class="d">-                                3,
</a><a href="#h17-2-48" id="h17-2-48" class="d">-                            ),
</a><a href="#h17-2-49" id="h17-2-49" class="i">+                    Constant(
</a><a href="#h17-2-50" id="h17-2-50" class="i">+                        Integer(
</a><a href="#h17-2-51" id="h17-2-51" class="i">+                            3,
</a>                         ),
<a href="#h17-2-53" id="h17-2-53" class="d">-                        None,
</a>                     ),
<a href="#h17-2-55" id="h17-2-55" class="d">-                    (
</a><a href="#h17-2-56" id="h17-2-56" class="d">-                        Constant(
</a><a href="#h17-2-57" id="h17-2-57" class="d">-                            Integer(
</a><a href="#h17-2-58" id="h17-2-58" class="d">-                                3,
</a><a href="#h17-2-59" id="h17-2-59" class="d">-                            ),
</a><a href="#h17-2-60" id="h17-2-60" class="i">+                    Constant(
</a><a href="#h17-2-61" id="h17-2-61" class="i">+                        Integer(
</a><a href="#h17-2-62" id="h17-2-62" class="i">+                            3,
</a>                         ),
<a href="#h17-2-64" id="h17-2-64" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h17-3" id="h17-3" class="h">@@ -238,40 +214,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h17-3-3" id="h17-3-3" class="i">+        labels: [
</a><a href="#h17-3-4" id="h17-3-4" class="i">+            None,
</a><a href="#h17-3-5" id="h17-3-5" class="i">+            None,
</a><a href="#h17-3-6" id="h17-3-6" class="i">+            None,
</a><a href="#h17-3-7" id="h17-3-7" class="i">+            None,
</a><a href="#h17-3-8" id="h17-3-8" class="i">+            None,
</a><a href="#h17-3-9" id="h17-3-9" class="i">+        ],
</a>         expressions: [
<a href="#h17-3-11" id="h17-3-11" class="d">-            (
</a><a href="#h17-3-12" id="h17-3-12" class="d">-                Field(
</a><a href="#h17-3-13" id="h17-3-13" class="d">-                    0,
</a><a href="#h17-3-14" id="h17-3-14" class="d">-                    None,
</a><a href="#h17-3-15" id="h17-3-15" class="d">-                ),
</a><a href="#h17-3-16" id="h17-3-16" class="i">+            Field(
</a><a href="#h17-3-17" id="h17-3-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h17-3-20" id="h17-3-20" class="d">-            (
</a><a href="#h17-3-21" id="h17-3-21" class="d">-                Field(
</a><a href="#h17-3-22" id="h17-3-22" class="d">-                    1,
</a><a href="#h17-3-23" id="h17-3-23" class="d">-                    None,
</a><a href="#h17-3-24" id="h17-3-24" class="d">-                ),
</a><a href="#h17-3-25" id="h17-3-25" class="i">+            Field(
</a><a href="#h17-3-26" id="h17-3-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h17-3-29" id="h17-3-29" class="d">-            (
</a><a href="#h17-3-30" id="h17-3-30" class="d">-                Field(
</a><a href="#h17-3-31" id="h17-3-31" class="d">-                    2,
</a><a href="#h17-3-32" id="h17-3-32" class="d">-                    None,
</a><a href="#h17-3-33" id="h17-3-33" class="d">-                ),
</a><a href="#h17-3-34" id="h17-3-34" class="i">+            Field(
</a><a href="#h17-3-35" id="h17-3-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h17-3-38" id="h17-3-38" class="d">-            (
</a><a href="#h17-3-39" id="h17-3-39" class="d">-                Field(
</a><a href="#h17-3-40" id="h17-3-40" class="d">-                    3,
</a><a href="#h17-3-41" id="h17-3-41" class="d">-                    None,
</a><a href="#h17-3-42" id="h17-3-42" class="d">-                ),
</a><a href="#h17-3-43" id="h17-3-43" class="i">+            Field(
</a><a href="#h17-3-44" id="h17-3-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h17-3-47" id="h17-3-47" class="d">-            (
</a><a href="#h17-3-48" id="h17-3-48" class="d">-                Field(
</a><a href="#h17-3-49" id="h17-3-49" class="d">-                    4,
</a><a href="#h17-3-50" id="h17-3-50" class="d">-                    None,
</a><a href="#h17-3-51" id="h17-3-51" class="d">-                ),
</a><a href="#h17-3-52" id="h17-3-52" class="i">+            Field(
</a><a href="#h17-3-53" id="h17-3-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a> b/<a href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -123,46 +123,38 @@ Plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h18-0-3" id="h18-0-3" class="i">+                labels: [
</a><a href="#h18-0-4" id="h18-0-4" class="i">+                    None,
</a><a href="#h18-0-5" id="h18-0-5" class="i">+                    None,
</a><a href="#h18-0-6" id="h18-0-6" class="i">+                    None,
</a><a href="#h18-0-7" id="h18-0-7" class="i">+                    None,
</a><a href="#h18-0-8" id="h18-0-8" class="i">+                    None,
</a><a href="#h18-0-9" id="h18-0-9" class="i">+                ],
</a>                 expressions: [
<a href="#h18-0-11" id="h18-0-11" class="d">-                    (
</a><a href="#h18-0-12" id="h18-0-12" class="d">-                        Constant(
</a><a href="#h18-0-13" id="h18-0-13" class="d">-                            Integer(
</a><a href="#h18-0-14" id="h18-0-14" class="d">-                                3,
</a><a href="#h18-0-15" id="h18-0-15" class="d">-                            ),
</a><a href="#h18-0-16" id="h18-0-16" class="i">+                    Constant(
</a><a href="#h18-0-17" id="h18-0-17" class="i">+                        Integer(
</a><a href="#h18-0-18" id="h18-0-18" class="i">+                            3,
</a>                         ),
<a href="#h18-0-20" id="h18-0-20" class="d">-                        None,
</a>                     ),
<a href="#h18-0-22" id="h18-0-22" class="d">-                    (
</a><a href="#h18-0-23" id="h18-0-23" class="d">-                        Constant(
</a><a href="#h18-0-24" id="h18-0-24" class="d">-                            Integer(
</a><a href="#h18-0-25" id="h18-0-25" class="d">-                                3,
</a><a href="#h18-0-26" id="h18-0-26" class="d">-                            ),
</a><a href="#h18-0-27" id="h18-0-27" class="i">+                    Constant(
</a><a href="#h18-0-28" id="h18-0-28" class="i">+                        Integer(
</a><a href="#h18-0-29" id="h18-0-29" class="i">+                            3,
</a>                         ),
<a href="#h18-0-31" id="h18-0-31" class="d">-                        None,
</a>                     ),
<a href="#h18-0-33" id="h18-0-33" class="d">-                    (
</a><a href="#h18-0-34" id="h18-0-34" class="d">-                        Constant(
</a><a href="#h18-0-35" id="h18-0-35" class="d">-                            Integer(
</a><a href="#h18-0-36" id="h18-0-36" class="d">-                                3,
</a><a href="#h18-0-37" id="h18-0-37" class="d">-                            ),
</a><a href="#h18-0-38" id="h18-0-38" class="i">+                    Constant(
</a><a href="#h18-0-39" id="h18-0-39" class="i">+                        Integer(
</a><a href="#h18-0-40" id="h18-0-40" class="i">+                            3,
</a>                         ),
<a href="#h18-0-42" id="h18-0-42" class="d">-                        None,
</a>                     ),
<a href="#h18-0-44" id="h18-0-44" class="d">-                    (
</a><a href="#h18-0-45" id="h18-0-45" class="d">-                        Constant(
</a><a href="#h18-0-46" id="h18-0-46" class="d">-                            Integer(
</a><a href="#h18-0-47" id="h18-0-47" class="d">-                                3,
</a><a href="#h18-0-48" id="h18-0-48" class="d">-                            ),
</a><a href="#h18-0-49" id="h18-0-49" class="i">+                    Constant(
</a><a href="#h18-0-50" id="h18-0-50" class="i">+                        Integer(
</a><a href="#h18-0-51" id="h18-0-51" class="i">+                            3,
</a>                         ),
<a href="#h18-0-53" id="h18-0-53" class="d">-                        None,
</a>                     ),
<a href="#h18-0-55" id="h18-0-55" class="d">-                    (
</a><a href="#h18-0-56" id="h18-0-56" class="d">-                        Constant(
</a><a href="#h18-0-57" id="h18-0-57" class="d">-                            Integer(
</a><a href="#h18-0-58" id="h18-0-58" class="d">-                                3,
</a><a href="#h18-0-59" id="h18-0-59" class="d">-                            ),
</a><a href="#h18-0-60" id="h18-0-60" class="i">+                    Constant(
</a><a href="#h18-0-61" id="h18-0-61" class="i">+                        Integer(
</a><a href="#h18-0-62" id="h18-0-62" class="i">+                            3,
</a>                         ),
<a href="#h18-0-64" id="h18-0-64" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h18-1" id="h18-1" class="h">@@ -174,40 +166,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h18-1-3" id="h18-1-3" class="i">+        labels: [
</a><a href="#h18-1-4" id="h18-1-4" class="i">+            None,
</a><a href="#h18-1-5" id="h18-1-5" class="i">+            None,
</a><a href="#h18-1-6" id="h18-1-6" class="i">+            None,
</a><a href="#h18-1-7" id="h18-1-7" class="i">+            None,
</a><a href="#h18-1-8" id="h18-1-8" class="i">+            None,
</a><a href="#h18-1-9" id="h18-1-9" class="i">+        ],
</a>         expressions: [
<a href="#h18-1-11" id="h18-1-11" class="d">-            (
</a><a href="#h18-1-12" id="h18-1-12" class="d">-                Field(
</a><a href="#h18-1-13" id="h18-1-13" class="d">-                    0,
</a><a href="#h18-1-14" id="h18-1-14" class="d">-                    None,
</a><a href="#h18-1-15" id="h18-1-15" class="d">-                ),
</a><a href="#h18-1-16" id="h18-1-16" class="i">+            Field(
</a><a href="#h18-1-17" id="h18-1-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h18-1-20" id="h18-1-20" class="d">-            (
</a><a href="#h18-1-21" id="h18-1-21" class="d">-                Field(
</a><a href="#h18-1-22" id="h18-1-22" class="d">-                    1,
</a><a href="#h18-1-23" id="h18-1-23" class="d">-                    None,
</a><a href="#h18-1-24" id="h18-1-24" class="d">-                ),
</a><a href="#h18-1-25" id="h18-1-25" class="i">+            Field(
</a><a href="#h18-1-26" id="h18-1-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h18-1-29" id="h18-1-29" class="d">-            (
</a><a href="#h18-1-30" id="h18-1-30" class="d">-                Field(
</a><a href="#h18-1-31" id="h18-1-31" class="d">-                    2,
</a><a href="#h18-1-32" id="h18-1-32" class="d">-                    None,
</a><a href="#h18-1-33" id="h18-1-33" class="d">-                ),
</a><a href="#h18-1-34" id="h18-1-34" class="i">+            Field(
</a><a href="#h18-1-35" id="h18-1-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h18-1-38" id="h18-1-38" class="d">-            (
</a><a href="#h18-1-39" id="h18-1-39" class="d">-                Field(
</a><a href="#h18-1-40" id="h18-1-40" class="d">-                    3,
</a><a href="#h18-1-41" id="h18-1-41" class="d">-                    None,
</a><a href="#h18-1-42" id="h18-1-42" class="d">-                ),
</a><a href="#h18-1-43" id="h18-1-43" class="i">+            Field(
</a><a href="#h18-1-44" id="h18-1-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h18-1-47" id="h18-1-47" class="d">-            (
</a><a href="#h18-1-48" id="h18-1-48" class="d">-                Field(
</a><a href="#h18-1-49" id="h18-1-49" class="d">-                    4,
</a><a href="#h18-1-50" id="h18-1-50" class="d">-                    None,
</a><a href="#h18-1-51" id="h18-1-51" class="d">-                ),
</a><a href="#h18-1-52" id="h18-1-52" class="i">+            Field(
</a><a href="#h18-1-53" id="h18-1-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h18-2" id="h18-2" class="h">@@ -246,46 +230,38 @@ Optimized plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h18-2-3" id="h18-2-3" class="i">+                labels: [
</a><a href="#h18-2-4" id="h18-2-4" class="i">+                    None,
</a><a href="#h18-2-5" id="h18-2-5" class="i">+                    None,
</a><a href="#h18-2-6" id="h18-2-6" class="i">+                    None,
</a><a href="#h18-2-7" id="h18-2-7" class="i">+                    None,
</a><a href="#h18-2-8" id="h18-2-8" class="i">+                    None,
</a><a href="#h18-2-9" id="h18-2-9" class="i">+                ],
</a>                 expressions: [
<a href="#h18-2-11" id="h18-2-11" class="d">-                    (
</a><a href="#h18-2-12" id="h18-2-12" class="d">-                        Constant(
</a><a href="#h18-2-13" id="h18-2-13" class="d">-                            Integer(
</a><a href="#h18-2-14" id="h18-2-14" class="d">-                                3,
</a><a href="#h18-2-15" id="h18-2-15" class="d">-                            ),
</a><a href="#h18-2-16" id="h18-2-16" class="i">+                    Constant(
</a><a href="#h18-2-17" id="h18-2-17" class="i">+                        Integer(
</a><a href="#h18-2-18" id="h18-2-18" class="i">+                            3,
</a>                         ),
<a href="#h18-2-20" id="h18-2-20" class="d">-                        None,
</a>                     ),
<a href="#h18-2-22" id="h18-2-22" class="d">-                    (
</a><a href="#h18-2-23" id="h18-2-23" class="d">-                        Constant(
</a><a href="#h18-2-24" id="h18-2-24" class="d">-                            Integer(
</a><a href="#h18-2-25" id="h18-2-25" class="d">-                                3,
</a><a href="#h18-2-26" id="h18-2-26" class="d">-                            ),
</a><a href="#h18-2-27" id="h18-2-27" class="i">+                    Constant(
</a><a href="#h18-2-28" id="h18-2-28" class="i">+                        Integer(
</a><a href="#h18-2-29" id="h18-2-29" class="i">+                            3,
</a>                         ),
<a href="#h18-2-31" id="h18-2-31" class="d">-                        None,
</a>                     ),
<a href="#h18-2-33" id="h18-2-33" class="d">-                    (
</a><a href="#h18-2-34" id="h18-2-34" class="d">-                        Constant(
</a><a href="#h18-2-35" id="h18-2-35" class="d">-                            Integer(
</a><a href="#h18-2-36" id="h18-2-36" class="d">-                                3,
</a><a href="#h18-2-37" id="h18-2-37" class="d">-                            ),
</a><a href="#h18-2-38" id="h18-2-38" class="i">+                    Constant(
</a><a href="#h18-2-39" id="h18-2-39" class="i">+                        Integer(
</a><a href="#h18-2-40" id="h18-2-40" class="i">+                            3,
</a>                         ),
<a href="#h18-2-42" id="h18-2-42" class="d">-                        None,
</a>                     ),
<a href="#h18-2-44" id="h18-2-44" class="d">-                    (
</a><a href="#h18-2-45" id="h18-2-45" class="d">-                        Constant(
</a><a href="#h18-2-46" id="h18-2-46" class="d">-                            Integer(
</a><a href="#h18-2-47" id="h18-2-47" class="d">-                                3,
</a><a href="#h18-2-48" id="h18-2-48" class="d">-                            ),
</a><a href="#h18-2-49" id="h18-2-49" class="i">+                    Constant(
</a><a href="#h18-2-50" id="h18-2-50" class="i">+                        Integer(
</a><a href="#h18-2-51" id="h18-2-51" class="i">+                            3,
</a>                         ),
<a href="#h18-2-53" id="h18-2-53" class="d">-                        None,
</a>                     ),
<a href="#h18-2-55" id="h18-2-55" class="d">-                    (
</a><a href="#h18-2-56" id="h18-2-56" class="d">-                        Constant(
</a><a href="#h18-2-57" id="h18-2-57" class="d">-                            Integer(
</a><a href="#h18-2-58" id="h18-2-58" class="d">-                                3,
</a><a href="#h18-2-59" id="h18-2-59" class="d">-                            ),
</a><a href="#h18-2-60" id="h18-2-60" class="i">+                    Constant(
</a><a href="#h18-2-61" id="h18-2-61" class="i">+                        Integer(
</a><a href="#h18-2-62" id="h18-2-62" class="i">+                            3,
</a>                         ),
<a href="#h18-2-64" id="h18-2-64" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h18-3" id="h18-3" class="h">@@ -297,40 +273,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h18-3-3" id="h18-3-3" class="i">+        labels: [
</a><a href="#h18-3-4" id="h18-3-4" class="i">+            None,
</a><a href="#h18-3-5" id="h18-3-5" class="i">+            None,
</a><a href="#h18-3-6" id="h18-3-6" class="i">+            None,
</a><a href="#h18-3-7" id="h18-3-7" class="i">+            None,
</a><a href="#h18-3-8" id="h18-3-8" class="i">+            None,
</a><a href="#h18-3-9" id="h18-3-9" class="i">+        ],
</a>         expressions: [
<a href="#h18-3-11" id="h18-3-11" class="d">-            (
</a><a href="#h18-3-12" id="h18-3-12" class="d">-                Field(
</a><a href="#h18-3-13" id="h18-3-13" class="d">-                    0,
</a><a href="#h18-3-14" id="h18-3-14" class="d">-                    None,
</a><a href="#h18-3-15" id="h18-3-15" class="d">-                ),
</a><a href="#h18-3-16" id="h18-3-16" class="i">+            Field(
</a><a href="#h18-3-17" id="h18-3-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h18-3-20" id="h18-3-20" class="d">-            (
</a><a href="#h18-3-21" id="h18-3-21" class="d">-                Field(
</a><a href="#h18-3-22" id="h18-3-22" class="d">-                    1,
</a><a href="#h18-3-23" id="h18-3-23" class="d">-                    None,
</a><a href="#h18-3-24" id="h18-3-24" class="d">-                ),
</a><a href="#h18-3-25" id="h18-3-25" class="i">+            Field(
</a><a href="#h18-3-26" id="h18-3-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h18-3-29" id="h18-3-29" class="d">-            (
</a><a href="#h18-3-30" id="h18-3-30" class="d">-                Field(
</a><a href="#h18-3-31" id="h18-3-31" class="d">-                    2,
</a><a href="#h18-3-32" id="h18-3-32" class="d">-                    None,
</a><a href="#h18-3-33" id="h18-3-33" class="d">-                ),
</a><a href="#h18-3-34" id="h18-3-34" class="i">+            Field(
</a><a href="#h18-3-35" id="h18-3-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h18-3-38" id="h18-3-38" class="d">-            (
</a><a href="#h18-3-39" id="h18-3-39" class="d">-                Field(
</a><a href="#h18-3-40" id="h18-3-40" class="d">-                    3,
</a><a href="#h18-3-41" id="h18-3-41" class="d">-                    None,
</a><a href="#h18-3-42" id="h18-3-42" class="d">-                ),
</a><a href="#h18-3-43" id="h18-3-43" class="i">+            Field(
</a><a href="#h18-3-44" id="h18-3-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h18-3-47" id="h18-3-47" class="d">-            (
</a><a href="#h18-3-48" id="h18-3-48" class="d">-                Field(
</a><a href="#h18-3-49" id="h18-3-49" class="d">-                    4,
</a><a href="#h18-3-50" id="h18-3-50" class="d">-                    None,
</a><a href="#h18-3-51" id="h18-3-51" class="d">-                ),
</a><a href="#h18-3-52" id="h18-3-52" class="i">+            Field(
</a><a href="#h18-3-53" id="h18-3-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a> b/<a href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -124,14 +124,14 @@ Plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h19-0-3" id="h19-0-3" class="i">+                labels: [
</a><a href="#h19-0-4" id="h19-0-4" class="i">+                    None,
</a><a href="#h19-0-5" id="h19-0-5" class="i">+                ],
</a>                 expressions: [
<a href="#h19-0-7" id="h19-0-7" class="d">-                    (
</a><a href="#h19-0-8" id="h19-0-8" class="d">-                        Constant(
</a><a href="#h19-0-9" id="h19-0-9" class="d">-                            Boolean(
</a><a href="#h19-0-10" id="h19-0-10" class="d">-                                true,
</a><a href="#h19-0-11" id="h19-0-11" class="d">-                            ),
</a><a href="#h19-0-12" id="h19-0-12" class="i">+                    Constant(
</a><a href="#h19-0-13" id="h19-0-13" class="i">+                        Boolean(
</a><a href="#h19-0-14" id="h19-0-14" class="i">+                            true,
</a>                         ),
<a href="#h19-0-16" id="h19-0-16" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h19-1" id="h19-1" class="h">@@ -139,12 +139,12 @@ Plan: Select(
</a>                 Count,
             ],
         },
<a href="#h19-1-3" id="h19-1-3" class="i">+        labels: [
</a><a href="#h19-1-4" id="h19-1-4" class="i">+            None,
</a><a href="#h19-1-5" id="h19-1-5" class="i">+        ],
</a>         expressions: [
<a href="#h19-1-7" id="h19-1-7" class="d">-            (
</a><a href="#h19-1-8" id="h19-1-8" class="d">-                Field(
</a><a href="#h19-1-9" id="h19-1-9" class="d">-                    0,
</a><a href="#h19-1-10" id="h19-1-10" class="d">-                    None,
</a><a href="#h19-1-11" id="h19-1-11" class="d">-                ),
</a><a href="#h19-1-12" id="h19-1-12" class="i">+            Field(
</a><a href="#h19-1-13" id="h19-1-13" class="i">+                0,
</a>                 None,
             ),
         ],
<a href="#h19-2" id="h19-2" class="h">@@ -236,14 +236,14 @@ Optimized plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h19-2-3" id="h19-2-3" class="i">+                labels: [
</a><a href="#h19-2-4" id="h19-2-4" class="i">+                    None,
</a><a href="#h19-2-5" id="h19-2-5" class="i">+                ],
</a>                 expressions: [
<a href="#h19-2-7" id="h19-2-7" class="d">-                    (
</a><a href="#h19-2-8" id="h19-2-8" class="d">-                        Constant(
</a><a href="#h19-2-9" id="h19-2-9" class="d">-                            Boolean(
</a><a href="#h19-2-10" id="h19-2-10" class="d">-                                true,
</a><a href="#h19-2-11" id="h19-2-11" class="d">-                            ),
</a><a href="#h19-2-12" id="h19-2-12" class="i">+                    Constant(
</a><a href="#h19-2-13" id="h19-2-13" class="i">+                        Boolean(
</a><a href="#h19-2-14" id="h19-2-14" class="i">+                            true,
</a>                         ),
<a href="#h19-2-16" id="h19-2-16" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h19-3" id="h19-3" class="h">@@ -251,12 +251,12 @@ Optimized plan: Select(
</a>                 Count,
             ],
         },
<a href="#h19-3-3" id="h19-3-3" class="i">+        labels: [
</a><a href="#h19-3-4" id="h19-3-4" class="i">+            None,
</a><a href="#h19-3-5" id="h19-3-5" class="i">+        ],
</a>         expressions: [
<a href="#h19-3-7" id="h19-3-7" class="d">-            (
</a><a href="#h19-3-8" id="h19-3-8" class="d">-                Field(
</a><a href="#h19-3-9" id="h19-3-9" class="d">-                    0,
</a><a href="#h19-3-10" id="h19-3-10" class="d">-                    None,
</a><a href="#h19-3-11" id="h19-3-11" class="d">-                ),
</a><a href="#h19-3-12" id="h19-3-12" class="i">+            Field(
</a><a href="#h19-3-13" id="h19-3-13" class="i">+                0,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a> b/<a href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -146,33 +146,31 @@ Plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h20-0-3" id="h20-0-3" class="i">+                labels: [
</a><a href="#h20-0-4" id="h20-0-4" class="i">+                    None,
</a><a href="#h20-0-5" id="h20-0-5" class="i">+                    None,
</a><a href="#h20-0-6" id="h20-0-6" class="i">+                ],
</a>                 expressions: [
<a href="#h20-0-8" id="h20-0-8" class="d">-                    (
</a><a href="#h20-0-9" id="h20-0-9" class="d">-                        Multiply(
</a><a href="#h20-0-10" id="h20-0-10" class="d">-                            Field(
</a><a href="#h20-0-11" id="h20-0-11" class="d">-                                5,
</a><a href="#h20-0-12" id="h20-0-12" class="d">-                                Some(
</a><a href="#h20-0-13" id="h20-0-13" class="d">-                                    (
</a><a href="#h20-0-14" id="h20-0-14" class="d">-                                        None,
</a><a href="#h20-0-15" id="h20-0-15" class="d">-                                        &quot;rating&quot;,
</a><a href="#h20-0-16" id="h20-0-16" class="d">-                                    ),
</a><a href="#h20-0-17" id="h20-0-17" class="d">-                                ),
</a><a href="#h20-0-18" id="h20-0-18" class="d">-                            ),
</a><a href="#h20-0-19" id="h20-0-19" class="d">-                            Constant(
</a><a href="#h20-0-20" id="h20-0-20" class="d">-                                Integer(
</a><a href="#h20-0-21" id="h20-0-21" class="d">-                                    10,
</a><a href="#h20-0-22" id="h20-0-22" class="i">+                    Multiply(
</a><a href="#h20-0-23" id="h20-0-23" class="i">+                        Field(
</a><a href="#h20-0-24" id="h20-0-24" class="i">+                            5,
</a><a href="#h20-0-25" id="h20-0-25" class="i">+                            Some(
</a><a href="#h20-0-26" id="h20-0-26" class="i">+                                (
</a><a href="#h20-0-27" id="h20-0-27" class="i">+                                    None,
</a><a href="#h20-0-28" id="h20-0-28" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h20-0-32" id="h20-0-32" class="d">-                        None,
</a><a href="#h20-0-33" id="h20-0-33" class="d">-                    ),
</a><a href="#h20-0-34" id="h20-0-34" class="d">-                    (
</a>                         Constant(
<a href="#h20-0-36" id="h20-0-36" class="d">-                            Boolean(
</a><a href="#h20-0-37" id="h20-0-37" class="d">-                                true,
</a><a href="#h20-0-38" id="h20-0-38" class="i">+                            Integer(
</a><a href="#h20-0-39" id="h20-0-39" class="i">+                                10,
</a>                             ),
                         ),
<a href="#h20-0-42" id="h20-0-42" class="d">-                        None,
</a><a href="#h20-0-43" id="h20-0-43" class="i">+                    ),
</a><a href="#h20-0-44" id="h20-0-44" class="i">+                    Constant(
</a><a href="#h20-0-45" id="h20-0-45" class="i">+                        Boolean(
</a><a href="#h20-0-46" id="h20-0-46" class="i">+                            true,
</a><a href="#h20-0-47" id="h20-0-47" class="i">+                        ),
</a>                     ),
                 ],
             },
<a href="#h20-1" id="h20-1" class="h">@@ -181,19 +179,19 @@ Plan: Select(
</a>                 Count,
             ],
         },
<a href="#h20-1-3" id="h20-1-3" class="i">+        labels: [
</a><a href="#h20-1-4" id="h20-1-4" class="i">+            None,
</a><a href="#h20-1-5" id="h20-1-5" class="i">+        ],
</a>         expressions: [
<a href="#h20-1-7" id="h20-1-7" class="d">-            (
</a><a href="#h20-1-8" id="h20-1-8" class="d">-                Divide(
</a><a href="#h20-1-9" id="h20-1-9" class="d">-                    Field(
</a><a href="#h20-1-10" id="h20-1-10" class="d">-                        0,
</a><a href="#h20-1-11" id="h20-1-11" class="d">-                        None,
</a><a href="#h20-1-12" id="h20-1-12" class="d">-                    ),
</a><a href="#h20-1-13" id="h20-1-13" class="d">-                    Field(
</a><a href="#h20-1-14" id="h20-1-14" class="d">-                        1,
</a><a href="#h20-1-15" id="h20-1-15" class="d">-                        None,
</a><a href="#h20-1-16" id="h20-1-16" class="d">-                    ),
</a><a href="#h20-1-17" id="h20-1-17" class="i">+            Divide(
</a><a href="#h20-1-18" id="h20-1-18" class="i">+                Field(
</a><a href="#h20-1-19" id="h20-1-19" class="i">+                    0,
</a><a href="#h20-1-20" id="h20-1-20" class="i">+                    None,
</a><a href="#h20-1-21" id="h20-1-21" class="i">+                ),
</a><a href="#h20-1-22" id="h20-1-22" class="i">+                Field(
</a><a href="#h20-1-23" id="h20-1-23" class="i">+                    1,
</a><a href="#h20-1-24" id="h20-1-24" class="i">+                    None,
</a>                 ),
<a href="#h20-1-26" id="h20-1-26" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h20-2" id="h20-2" class="h">@@ -284,33 +282,31 @@ Optimized plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h20-2-3" id="h20-2-3" class="i">+                labels: [
</a><a href="#h20-2-4" id="h20-2-4" class="i">+                    None,
</a><a href="#h20-2-5" id="h20-2-5" class="i">+                    None,
</a><a href="#h20-2-6" id="h20-2-6" class="i">+                ],
</a>                 expressions: [
<a href="#h20-2-8" id="h20-2-8" class="d">-                    (
</a><a href="#h20-2-9" id="h20-2-9" class="d">-                        Multiply(
</a><a href="#h20-2-10" id="h20-2-10" class="d">-                            Field(
</a><a href="#h20-2-11" id="h20-2-11" class="d">-                                5,
</a><a href="#h20-2-12" id="h20-2-12" class="d">-                                Some(
</a><a href="#h20-2-13" id="h20-2-13" class="d">-                                    (
</a><a href="#h20-2-14" id="h20-2-14" class="d">-                                        None,
</a><a href="#h20-2-15" id="h20-2-15" class="d">-                                        &quot;rating&quot;,
</a><a href="#h20-2-16" id="h20-2-16" class="d">-                                    ),
</a><a href="#h20-2-17" id="h20-2-17" class="d">-                                ),
</a><a href="#h20-2-18" id="h20-2-18" class="d">-                            ),
</a><a href="#h20-2-19" id="h20-2-19" class="d">-                            Constant(
</a><a href="#h20-2-20" id="h20-2-20" class="d">-                                Integer(
</a><a href="#h20-2-21" id="h20-2-21" class="d">-                                    10,
</a><a href="#h20-2-22" id="h20-2-22" class="i">+                    Multiply(
</a><a href="#h20-2-23" id="h20-2-23" class="i">+                        Field(
</a><a href="#h20-2-24" id="h20-2-24" class="i">+                            5,
</a><a href="#h20-2-25" id="h20-2-25" class="i">+                            Some(
</a><a href="#h20-2-26" id="h20-2-26" class="i">+                                (
</a><a href="#h20-2-27" id="h20-2-27" class="i">+                                    None,
</a><a href="#h20-2-28" id="h20-2-28" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h20-2-32" id="h20-2-32" class="d">-                        None,
</a><a href="#h20-2-33" id="h20-2-33" class="d">-                    ),
</a><a href="#h20-2-34" id="h20-2-34" class="d">-                    (
</a>                         Constant(
<a href="#h20-2-36" id="h20-2-36" class="d">-                            Boolean(
</a><a href="#h20-2-37" id="h20-2-37" class="d">-                                true,
</a><a href="#h20-2-38" id="h20-2-38" class="i">+                            Integer(
</a><a href="#h20-2-39" id="h20-2-39" class="i">+                                10,
</a>                             ),
                         ),
<a href="#h20-2-42" id="h20-2-42" class="d">-                        None,
</a><a href="#h20-2-43" id="h20-2-43" class="i">+                    ),
</a><a href="#h20-2-44" id="h20-2-44" class="i">+                    Constant(
</a><a href="#h20-2-45" id="h20-2-45" class="i">+                        Boolean(
</a><a href="#h20-2-46" id="h20-2-46" class="i">+                            true,
</a><a href="#h20-2-47" id="h20-2-47" class="i">+                        ),
</a>                     ),
                 ],
             },
<a href="#h20-3" id="h20-3" class="h">@@ -319,19 +315,19 @@ Optimized plan: Select(
</a>                 Count,
             ],
         },
<a href="#h20-3-3" id="h20-3-3" class="i">+        labels: [
</a><a href="#h20-3-4" id="h20-3-4" class="i">+            None,
</a><a href="#h20-3-5" id="h20-3-5" class="i">+        ],
</a>         expressions: [
<a href="#h20-3-7" id="h20-3-7" class="d">-            (
</a><a href="#h20-3-8" id="h20-3-8" class="d">-                Divide(
</a><a href="#h20-3-9" id="h20-3-9" class="d">-                    Field(
</a><a href="#h20-3-10" id="h20-3-10" class="d">-                        0,
</a><a href="#h20-3-11" id="h20-3-11" class="d">-                        None,
</a><a href="#h20-3-12" id="h20-3-12" class="d">-                    ),
</a><a href="#h20-3-13" id="h20-3-13" class="d">-                    Field(
</a><a href="#h20-3-14" id="h20-3-14" class="d">-                        1,
</a><a href="#h20-3-15" id="h20-3-15" class="d">-                        None,
</a><a href="#h20-3-16" id="h20-3-16" class="d">-                    ),
</a><a href="#h20-3-17" id="h20-3-17" class="i">+            Divide(
</a><a href="#h20-3-18" id="h20-3-18" class="i">+                Field(
</a><a href="#h20-3-19" id="h20-3-19" class="i">+                    0,
</a><a href="#h20-3-20" id="h20-3-20" class="i">+                    None,
</a><a href="#h20-3-21" id="h20-3-21" class="i">+                ),
</a><a href="#h20-3-22" id="h20-3-22" class="i">+                Field(
</a><a href="#h20-3-23" id="h20-3-23" class="i">+                    1,
</a><a href="#h20-3-24" id="h20-3-24" class="i">+                    None,
</a>                 ),
<a href="#h20-3-26" id="h20-3-26" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a> b/<a href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -148,66 +148,58 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h21-0-3" id="h21-0-3" class="i">+                labels: [
</a><a href="#h21-0-4" id="h21-0-4" class="i">+                    None,
</a><a href="#h21-0-5" id="h21-0-5" class="i">+                    None,
</a><a href="#h21-0-6" id="h21-0-6" class="i">+                    None,
</a><a href="#h21-0-7" id="h21-0-7" class="i">+                    None,
</a><a href="#h21-0-8" id="h21-0-8" class="i">+                    None,
</a><a href="#h21-0-9" id="h21-0-9" class="i">+                ],
</a>                 expressions: [
<a href="#h21-0-11" id="h21-0-11" class="d">-                    (
</a><a href="#h21-0-12" id="h21-0-12" class="d">-                        Field(
</a><a href="#h21-0-13" id="h21-0-13" class="d">-                            1,
</a><a href="#h21-0-14" id="h21-0-14" class="d">-                            Some(
</a><a href="#h21-0-15" id="h21-0-15" class="d">-                                (
</a><a href="#h21-0-16" id="h21-0-16" class="d">-                                    None,
</a><a href="#h21-0-17" id="h21-0-17" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-0-18" id="h21-0-18" class="d">-                                ),
</a><a href="#h21-0-19" id="h21-0-19" class="i">+                    Field(
</a><a href="#h21-0-20" id="h21-0-20" class="i">+                        1,
</a><a href="#h21-0-21" id="h21-0-21" class="i">+                        Some(
</a><a href="#h21-0-22" id="h21-0-22" class="i">+                            (
</a><a href="#h21-0-23" id="h21-0-23" class="i">+                                None,
</a><a href="#h21-0-24" id="h21-0-24" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-0-27" id="h21-0-27" class="d">-                        None,
</a>                     ),
<a href="#h21-0-29" id="h21-0-29" class="d">-                    (
</a><a href="#h21-0-30" id="h21-0-30" class="d">-                        Field(
</a><a href="#h21-0-31" id="h21-0-31" class="d">-                            1,
</a><a href="#h21-0-32" id="h21-0-32" class="d">-                            Some(
</a><a href="#h21-0-33" id="h21-0-33" class="d">-                                (
</a><a href="#h21-0-34" id="h21-0-34" class="d">-                                    None,
</a><a href="#h21-0-35" id="h21-0-35" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-0-36" id="h21-0-36" class="d">-                                ),
</a><a href="#h21-0-37" id="h21-0-37" class="i">+                    Field(
</a><a href="#h21-0-38" id="h21-0-38" class="i">+                        1,
</a><a href="#h21-0-39" id="h21-0-39" class="i">+                        Some(
</a><a href="#h21-0-40" id="h21-0-40" class="i">+                            (
</a><a href="#h21-0-41" id="h21-0-41" class="i">+                                None,
</a><a href="#h21-0-42" id="h21-0-42" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-0-45" id="h21-0-45" class="d">-                        None,
</a>                     ),
<a href="#h21-0-47" id="h21-0-47" class="d">-                    (
</a><a href="#h21-0-48" id="h21-0-48" class="d">-                        Field(
</a><a href="#h21-0-49" id="h21-0-49" class="d">-                            1,
</a><a href="#h21-0-50" id="h21-0-50" class="d">-                            Some(
</a><a href="#h21-0-51" id="h21-0-51" class="d">-                                (
</a><a href="#h21-0-52" id="h21-0-52" class="d">-                                    None,
</a><a href="#h21-0-53" id="h21-0-53" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-0-54" id="h21-0-54" class="d">-                                ),
</a><a href="#h21-0-55" id="h21-0-55" class="i">+                    Field(
</a><a href="#h21-0-56" id="h21-0-56" class="i">+                        1,
</a><a href="#h21-0-57" id="h21-0-57" class="i">+                        Some(
</a><a href="#h21-0-58" id="h21-0-58" class="i">+                            (
</a><a href="#h21-0-59" id="h21-0-59" class="i">+                                None,
</a><a href="#h21-0-60" id="h21-0-60" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-0-63" id="h21-0-63" class="d">-                        None,
</a>                     ),
<a href="#h21-0-65" id="h21-0-65" class="d">-                    (
</a><a href="#h21-0-66" id="h21-0-66" class="d">-                        Field(
</a><a href="#h21-0-67" id="h21-0-67" class="d">-                            1,
</a><a href="#h21-0-68" id="h21-0-68" class="d">-                            Some(
</a><a href="#h21-0-69" id="h21-0-69" class="d">-                                (
</a><a href="#h21-0-70" id="h21-0-70" class="d">-                                    None,
</a><a href="#h21-0-71" id="h21-0-71" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-0-72" id="h21-0-72" class="d">-                                ),
</a><a href="#h21-0-73" id="h21-0-73" class="i">+                    Field(
</a><a href="#h21-0-74" id="h21-0-74" class="i">+                        1,
</a><a href="#h21-0-75" id="h21-0-75" class="i">+                        Some(
</a><a href="#h21-0-76" id="h21-0-76" class="i">+                            (
</a><a href="#h21-0-77" id="h21-0-77" class="i">+                                None,
</a><a href="#h21-0-78" id="h21-0-78" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-0-81" id="h21-0-81" class="d">-                        None,
</a>                     ),
<a href="#h21-0-83" id="h21-0-83" class="d">-                    (
</a><a href="#h21-0-84" id="h21-0-84" class="d">-                        Field(
</a><a href="#h21-0-85" id="h21-0-85" class="d">-                            1,
</a><a href="#h21-0-86" id="h21-0-86" class="d">-                            Some(
</a><a href="#h21-0-87" id="h21-0-87" class="d">-                                (
</a><a href="#h21-0-88" id="h21-0-88" class="d">-                                    None,
</a><a href="#h21-0-89" id="h21-0-89" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-0-90" id="h21-0-90" class="d">-                                ),
</a><a href="#h21-0-91" id="h21-0-91" class="i">+                    Field(
</a><a href="#h21-0-92" id="h21-0-92" class="i">+                        1,
</a><a href="#h21-0-93" id="h21-0-93" class="i">+                        Some(
</a><a href="#h21-0-94" id="h21-0-94" class="i">+                            (
</a><a href="#h21-0-95" id="h21-0-95" class="i">+                                None,
</a><a href="#h21-0-96" id="h21-0-96" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-0-99" id="h21-0-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h21-1" id="h21-1" class="h">@@ -219,40 +211,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h21-1-3" id="h21-1-3" class="i">+        labels: [
</a><a href="#h21-1-4" id="h21-1-4" class="i">+            None,
</a><a href="#h21-1-5" id="h21-1-5" class="i">+            None,
</a><a href="#h21-1-6" id="h21-1-6" class="i">+            None,
</a><a href="#h21-1-7" id="h21-1-7" class="i">+            None,
</a><a href="#h21-1-8" id="h21-1-8" class="i">+            None,
</a><a href="#h21-1-9" id="h21-1-9" class="i">+        ],
</a>         expressions: [
<a href="#h21-1-11" id="h21-1-11" class="d">-            (
</a><a href="#h21-1-12" id="h21-1-12" class="d">-                Field(
</a><a href="#h21-1-13" id="h21-1-13" class="d">-                    0,
</a><a href="#h21-1-14" id="h21-1-14" class="d">-                    None,
</a><a href="#h21-1-15" id="h21-1-15" class="d">-                ),
</a><a href="#h21-1-16" id="h21-1-16" class="i">+            Field(
</a><a href="#h21-1-17" id="h21-1-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h21-1-20" id="h21-1-20" class="d">-            (
</a><a href="#h21-1-21" id="h21-1-21" class="d">-                Field(
</a><a href="#h21-1-22" id="h21-1-22" class="d">-                    1,
</a><a href="#h21-1-23" id="h21-1-23" class="d">-                    None,
</a><a href="#h21-1-24" id="h21-1-24" class="d">-                ),
</a><a href="#h21-1-25" id="h21-1-25" class="i">+            Field(
</a><a href="#h21-1-26" id="h21-1-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h21-1-29" id="h21-1-29" class="d">-            (
</a><a href="#h21-1-30" id="h21-1-30" class="d">-                Field(
</a><a href="#h21-1-31" id="h21-1-31" class="d">-                    2,
</a><a href="#h21-1-32" id="h21-1-32" class="d">-                    None,
</a><a href="#h21-1-33" id="h21-1-33" class="d">-                ),
</a><a href="#h21-1-34" id="h21-1-34" class="i">+            Field(
</a><a href="#h21-1-35" id="h21-1-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h21-1-38" id="h21-1-38" class="d">-            (
</a><a href="#h21-1-39" id="h21-1-39" class="d">-                Field(
</a><a href="#h21-1-40" id="h21-1-40" class="d">-                    3,
</a><a href="#h21-1-41" id="h21-1-41" class="d">-                    None,
</a><a href="#h21-1-42" id="h21-1-42" class="d">-                ),
</a><a href="#h21-1-43" id="h21-1-43" class="i">+            Field(
</a><a href="#h21-1-44" id="h21-1-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h21-1-47" id="h21-1-47" class="d">-            (
</a><a href="#h21-1-48" id="h21-1-48" class="d">-                Field(
</a><a href="#h21-1-49" id="h21-1-49" class="d">-                    4,
</a><a href="#h21-1-50" id="h21-1-50" class="d">-                    None,
</a><a href="#h21-1-51" id="h21-1-51" class="d">-                ),
</a><a href="#h21-1-52" id="h21-1-52" class="i">+            Field(
</a><a href="#h21-1-53" id="h21-1-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h21-2" id="h21-2" class="h">@@ -307,66 +291,58 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h21-2-3" id="h21-2-3" class="i">+                labels: [
</a><a href="#h21-2-4" id="h21-2-4" class="i">+                    None,
</a><a href="#h21-2-5" id="h21-2-5" class="i">+                    None,
</a><a href="#h21-2-6" id="h21-2-6" class="i">+                    None,
</a><a href="#h21-2-7" id="h21-2-7" class="i">+                    None,
</a><a href="#h21-2-8" id="h21-2-8" class="i">+                    None,
</a><a href="#h21-2-9" id="h21-2-9" class="i">+                ],
</a>                 expressions: [
<a href="#h21-2-11" id="h21-2-11" class="d">-                    (
</a><a href="#h21-2-12" id="h21-2-12" class="d">-                        Field(
</a><a href="#h21-2-13" id="h21-2-13" class="d">-                            1,
</a><a href="#h21-2-14" id="h21-2-14" class="d">-                            Some(
</a><a href="#h21-2-15" id="h21-2-15" class="d">-                                (
</a><a href="#h21-2-16" id="h21-2-16" class="d">-                                    None,
</a><a href="#h21-2-17" id="h21-2-17" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-2-18" id="h21-2-18" class="d">-                                ),
</a><a href="#h21-2-19" id="h21-2-19" class="i">+                    Field(
</a><a href="#h21-2-20" id="h21-2-20" class="i">+                        1,
</a><a href="#h21-2-21" id="h21-2-21" class="i">+                        Some(
</a><a href="#h21-2-22" id="h21-2-22" class="i">+                            (
</a><a href="#h21-2-23" id="h21-2-23" class="i">+                                None,
</a><a href="#h21-2-24" id="h21-2-24" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-2-27" id="h21-2-27" class="d">-                        None,
</a>                     ),
<a href="#h21-2-29" id="h21-2-29" class="d">-                    (
</a><a href="#h21-2-30" id="h21-2-30" class="d">-                        Field(
</a><a href="#h21-2-31" id="h21-2-31" class="d">-                            1,
</a><a href="#h21-2-32" id="h21-2-32" class="d">-                            Some(
</a><a href="#h21-2-33" id="h21-2-33" class="d">-                                (
</a><a href="#h21-2-34" id="h21-2-34" class="d">-                                    None,
</a><a href="#h21-2-35" id="h21-2-35" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-2-36" id="h21-2-36" class="d">-                                ),
</a><a href="#h21-2-37" id="h21-2-37" class="i">+                    Field(
</a><a href="#h21-2-38" id="h21-2-38" class="i">+                        1,
</a><a href="#h21-2-39" id="h21-2-39" class="i">+                        Some(
</a><a href="#h21-2-40" id="h21-2-40" class="i">+                            (
</a><a href="#h21-2-41" id="h21-2-41" class="i">+                                None,
</a><a href="#h21-2-42" id="h21-2-42" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-2-45" id="h21-2-45" class="d">-                        None,
</a>                     ),
<a href="#h21-2-47" id="h21-2-47" class="d">-                    (
</a><a href="#h21-2-48" id="h21-2-48" class="d">-                        Field(
</a><a href="#h21-2-49" id="h21-2-49" class="d">-                            1,
</a><a href="#h21-2-50" id="h21-2-50" class="d">-                            Some(
</a><a href="#h21-2-51" id="h21-2-51" class="d">-                                (
</a><a href="#h21-2-52" id="h21-2-52" class="d">-                                    None,
</a><a href="#h21-2-53" id="h21-2-53" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-2-54" id="h21-2-54" class="d">-                                ),
</a><a href="#h21-2-55" id="h21-2-55" class="i">+                    Field(
</a><a href="#h21-2-56" id="h21-2-56" class="i">+                        1,
</a><a href="#h21-2-57" id="h21-2-57" class="i">+                        Some(
</a><a href="#h21-2-58" id="h21-2-58" class="i">+                            (
</a><a href="#h21-2-59" id="h21-2-59" class="i">+                                None,
</a><a href="#h21-2-60" id="h21-2-60" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-2-63" id="h21-2-63" class="d">-                        None,
</a>                     ),
<a href="#h21-2-65" id="h21-2-65" class="d">-                    (
</a><a href="#h21-2-66" id="h21-2-66" class="d">-                        Field(
</a><a href="#h21-2-67" id="h21-2-67" class="d">-                            1,
</a><a href="#h21-2-68" id="h21-2-68" class="d">-                            Some(
</a><a href="#h21-2-69" id="h21-2-69" class="d">-                                (
</a><a href="#h21-2-70" id="h21-2-70" class="d">-                                    None,
</a><a href="#h21-2-71" id="h21-2-71" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-2-72" id="h21-2-72" class="d">-                                ),
</a><a href="#h21-2-73" id="h21-2-73" class="i">+                    Field(
</a><a href="#h21-2-74" id="h21-2-74" class="i">+                        1,
</a><a href="#h21-2-75" id="h21-2-75" class="i">+                        Some(
</a><a href="#h21-2-76" id="h21-2-76" class="i">+                            (
</a><a href="#h21-2-77" id="h21-2-77" class="i">+                                None,
</a><a href="#h21-2-78" id="h21-2-78" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-2-81" id="h21-2-81" class="d">-                        None,
</a>                     ),
<a href="#h21-2-83" id="h21-2-83" class="d">-                    (
</a><a href="#h21-2-84" id="h21-2-84" class="d">-                        Field(
</a><a href="#h21-2-85" id="h21-2-85" class="d">-                            1,
</a><a href="#h21-2-86" id="h21-2-86" class="d">-                            Some(
</a><a href="#h21-2-87" id="h21-2-87" class="d">-                                (
</a><a href="#h21-2-88" id="h21-2-88" class="d">-                                    None,
</a><a href="#h21-2-89" id="h21-2-89" class="d">-                                    &quot;f&quot;,
</a><a href="#h21-2-90" id="h21-2-90" class="d">-                                ),
</a><a href="#h21-2-91" id="h21-2-91" class="i">+                    Field(
</a><a href="#h21-2-92" id="h21-2-92" class="i">+                        1,
</a><a href="#h21-2-93" id="h21-2-93" class="i">+                        Some(
</a><a href="#h21-2-94" id="h21-2-94" class="i">+                            (
</a><a href="#h21-2-95" id="h21-2-95" class="i">+                                None,
</a><a href="#h21-2-96" id="h21-2-96" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h21-2-99" id="h21-2-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h21-3" id="h21-3" class="h">@@ -378,40 +354,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h21-3-3" id="h21-3-3" class="i">+        labels: [
</a><a href="#h21-3-4" id="h21-3-4" class="i">+            None,
</a><a href="#h21-3-5" id="h21-3-5" class="i">+            None,
</a><a href="#h21-3-6" id="h21-3-6" class="i">+            None,
</a><a href="#h21-3-7" id="h21-3-7" class="i">+            None,
</a><a href="#h21-3-8" id="h21-3-8" class="i">+            None,
</a><a href="#h21-3-9" id="h21-3-9" class="i">+        ],
</a>         expressions: [
<a href="#h21-3-11" id="h21-3-11" class="d">-            (
</a><a href="#h21-3-12" id="h21-3-12" class="d">-                Field(
</a><a href="#h21-3-13" id="h21-3-13" class="d">-                    0,
</a><a href="#h21-3-14" id="h21-3-14" class="d">-                    None,
</a><a href="#h21-3-15" id="h21-3-15" class="d">-                ),
</a><a href="#h21-3-16" id="h21-3-16" class="i">+            Field(
</a><a href="#h21-3-17" id="h21-3-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h21-3-20" id="h21-3-20" class="d">-            (
</a><a href="#h21-3-21" id="h21-3-21" class="d">-                Field(
</a><a href="#h21-3-22" id="h21-3-22" class="d">-                    1,
</a><a href="#h21-3-23" id="h21-3-23" class="d">-                    None,
</a><a href="#h21-3-24" id="h21-3-24" class="d">-                ),
</a><a href="#h21-3-25" id="h21-3-25" class="i">+            Field(
</a><a href="#h21-3-26" id="h21-3-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h21-3-29" id="h21-3-29" class="d">-            (
</a><a href="#h21-3-30" id="h21-3-30" class="d">-                Field(
</a><a href="#h21-3-31" id="h21-3-31" class="d">-                    2,
</a><a href="#h21-3-32" id="h21-3-32" class="d">-                    None,
</a><a href="#h21-3-33" id="h21-3-33" class="d">-                ),
</a><a href="#h21-3-34" id="h21-3-34" class="i">+            Field(
</a><a href="#h21-3-35" id="h21-3-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h21-3-38" id="h21-3-38" class="d">-            (
</a><a href="#h21-3-39" id="h21-3-39" class="d">-                Field(
</a><a href="#h21-3-40" id="h21-3-40" class="d">-                    3,
</a><a href="#h21-3-41" id="h21-3-41" class="d">-                    None,
</a><a href="#h21-3-42" id="h21-3-42" class="d">-                ),
</a><a href="#h21-3-43" id="h21-3-43" class="i">+            Field(
</a><a href="#h21-3-44" id="h21-3-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h21-3-47" id="h21-3-47" class="d">-            (
</a><a href="#h21-3-48" id="h21-3-48" class="d">-                Field(
</a><a href="#h21-3-49" id="h21-3-49" class="d">-                    4,
</a><a href="#h21-3-50" id="h21-3-50" class="d">-                    None,
</a><a href="#h21-3-51" id="h21-3-51" class="d">-                ),
</a><a href="#h21-3-52" id="h21-3-52" class="i">+            Field(
</a><a href="#h21-3-53" id="h21-3-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h22" href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a> b/<a href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -120,66 +120,58 @@ Plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h22-0-3" id="h22-0-3" class="i">+                labels: [
</a><a href="#h22-0-4" id="h22-0-4" class="i">+                    None,
</a><a href="#h22-0-5" id="h22-0-5" class="i">+                    None,
</a><a href="#h22-0-6" id="h22-0-6" class="i">+                    None,
</a><a href="#h22-0-7" id="h22-0-7" class="i">+                    None,
</a><a href="#h22-0-8" id="h22-0-8" class="i">+                    None,
</a><a href="#h22-0-9" id="h22-0-9" class="i">+                ],
</a>                 expressions: [
<a href="#h22-0-11" id="h22-0-11" class="d">-                    (
</a><a href="#h22-0-12" id="h22-0-12" class="d">-                        Field(
</a><a href="#h22-0-13" id="h22-0-13" class="d">-                            1,
</a><a href="#h22-0-14" id="h22-0-14" class="d">-                            Some(
</a><a href="#h22-0-15" id="h22-0-15" class="d">-                                (
</a><a href="#h22-0-16" id="h22-0-16" class="d">-                                    None,
</a><a href="#h22-0-17" id="h22-0-17" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-0-18" id="h22-0-18" class="d">-                                ),
</a><a href="#h22-0-19" id="h22-0-19" class="i">+                    Field(
</a><a href="#h22-0-20" id="h22-0-20" class="i">+                        1,
</a><a href="#h22-0-21" id="h22-0-21" class="i">+                        Some(
</a><a href="#h22-0-22" id="h22-0-22" class="i">+                            (
</a><a href="#h22-0-23" id="h22-0-23" class="i">+                                None,
</a><a href="#h22-0-24" id="h22-0-24" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-0-27" id="h22-0-27" class="d">-                        None,
</a>                     ),
<a href="#h22-0-29" id="h22-0-29" class="d">-                    (
</a><a href="#h22-0-30" id="h22-0-30" class="d">-                        Field(
</a><a href="#h22-0-31" id="h22-0-31" class="d">-                            1,
</a><a href="#h22-0-32" id="h22-0-32" class="d">-                            Some(
</a><a href="#h22-0-33" id="h22-0-33" class="d">-                                (
</a><a href="#h22-0-34" id="h22-0-34" class="d">-                                    None,
</a><a href="#h22-0-35" id="h22-0-35" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-0-36" id="h22-0-36" class="d">-                                ),
</a><a href="#h22-0-37" id="h22-0-37" class="i">+                    Field(
</a><a href="#h22-0-38" id="h22-0-38" class="i">+                        1,
</a><a href="#h22-0-39" id="h22-0-39" class="i">+                        Some(
</a><a href="#h22-0-40" id="h22-0-40" class="i">+                            (
</a><a href="#h22-0-41" id="h22-0-41" class="i">+                                None,
</a><a href="#h22-0-42" id="h22-0-42" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-0-45" id="h22-0-45" class="d">-                        None,
</a>                     ),
<a href="#h22-0-47" id="h22-0-47" class="d">-                    (
</a><a href="#h22-0-48" id="h22-0-48" class="d">-                        Field(
</a><a href="#h22-0-49" id="h22-0-49" class="d">-                            1,
</a><a href="#h22-0-50" id="h22-0-50" class="d">-                            Some(
</a><a href="#h22-0-51" id="h22-0-51" class="d">-                                (
</a><a href="#h22-0-52" id="h22-0-52" class="d">-                                    None,
</a><a href="#h22-0-53" id="h22-0-53" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-0-54" id="h22-0-54" class="d">-                                ),
</a><a href="#h22-0-55" id="h22-0-55" class="i">+                    Field(
</a><a href="#h22-0-56" id="h22-0-56" class="i">+                        1,
</a><a href="#h22-0-57" id="h22-0-57" class="i">+                        Some(
</a><a href="#h22-0-58" id="h22-0-58" class="i">+                            (
</a><a href="#h22-0-59" id="h22-0-59" class="i">+                                None,
</a><a href="#h22-0-60" id="h22-0-60" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-0-63" id="h22-0-63" class="d">-                        None,
</a>                     ),
<a href="#h22-0-65" id="h22-0-65" class="d">-                    (
</a><a href="#h22-0-66" id="h22-0-66" class="d">-                        Field(
</a><a href="#h22-0-67" id="h22-0-67" class="d">-                            1,
</a><a href="#h22-0-68" id="h22-0-68" class="d">-                            Some(
</a><a href="#h22-0-69" id="h22-0-69" class="d">-                                (
</a><a href="#h22-0-70" id="h22-0-70" class="d">-                                    None,
</a><a href="#h22-0-71" id="h22-0-71" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-0-72" id="h22-0-72" class="d">-                                ),
</a><a href="#h22-0-73" id="h22-0-73" class="i">+                    Field(
</a><a href="#h22-0-74" id="h22-0-74" class="i">+                        1,
</a><a href="#h22-0-75" id="h22-0-75" class="i">+                        Some(
</a><a href="#h22-0-76" id="h22-0-76" class="i">+                            (
</a><a href="#h22-0-77" id="h22-0-77" class="i">+                                None,
</a><a href="#h22-0-78" id="h22-0-78" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-0-81" id="h22-0-81" class="d">-                        None,
</a>                     ),
<a href="#h22-0-83" id="h22-0-83" class="d">-                    (
</a><a href="#h22-0-84" id="h22-0-84" class="d">-                        Field(
</a><a href="#h22-0-85" id="h22-0-85" class="d">-                            1,
</a><a href="#h22-0-86" id="h22-0-86" class="d">-                            Some(
</a><a href="#h22-0-87" id="h22-0-87" class="d">-                                (
</a><a href="#h22-0-88" id="h22-0-88" class="d">-                                    None,
</a><a href="#h22-0-89" id="h22-0-89" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-0-90" id="h22-0-90" class="d">-                                ),
</a><a href="#h22-0-91" id="h22-0-91" class="i">+                    Field(
</a><a href="#h22-0-92" id="h22-0-92" class="i">+                        1,
</a><a href="#h22-0-93" id="h22-0-93" class="i">+                        Some(
</a><a href="#h22-0-94" id="h22-0-94" class="i">+                            (
</a><a href="#h22-0-95" id="h22-0-95" class="i">+                                None,
</a><a href="#h22-0-96" id="h22-0-96" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-0-99" id="h22-0-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h22-1" id="h22-1" class="h">@@ -191,40 +183,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h22-1-3" id="h22-1-3" class="i">+        labels: [
</a><a href="#h22-1-4" id="h22-1-4" class="i">+            None,
</a><a href="#h22-1-5" id="h22-1-5" class="i">+            None,
</a><a href="#h22-1-6" id="h22-1-6" class="i">+            None,
</a><a href="#h22-1-7" id="h22-1-7" class="i">+            None,
</a><a href="#h22-1-8" id="h22-1-8" class="i">+            None,
</a><a href="#h22-1-9" id="h22-1-9" class="i">+        ],
</a>         expressions: [
<a href="#h22-1-11" id="h22-1-11" class="d">-            (
</a><a href="#h22-1-12" id="h22-1-12" class="d">-                Field(
</a><a href="#h22-1-13" id="h22-1-13" class="d">-                    0,
</a><a href="#h22-1-14" id="h22-1-14" class="d">-                    None,
</a><a href="#h22-1-15" id="h22-1-15" class="d">-                ),
</a><a href="#h22-1-16" id="h22-1-16" class="i">+            Field(
</a><a href="#h22-1-17" id="h22-1-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h22-1-20" id="h22-1-20" class="d">-            (
</a><a href="#h22-1-21" id="h22-1-21" class="d">-                Field(
</a><a href="#h22-1-22" id="h22-1-22" class="d">-                    1,
</a><a href="#h22-1-23" id="h22-1-23" class="d">-                    None,
</a><a href="#h22-1-24" id="h22-1-24" class="d">-                ),
</a><a href="#h22-1-25" id="h22-1-25" class="i">+            Field(
</a><a href="#h22-1-26" id="h22-1-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h22-1-29" id="h22-1-29" class="d">-            (
</a><a href="#h22-1-30" id="h22-1-30" class="d">-                Field(
</a><a href="#h22-1-31" id="h22-1-31" class="d">-                    2,
</a><a href="#h22-1-32" id="h22-1-32" class="d">-                    None,
</a><a href="#h22-1-33" id="h22-1-33" class="d">-                ),
</a><a href="#h22-1-34" id="h22-1-34" class="i">+            Field(
</a><a href="#h22-1-35" id="h22-1-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h22-1-38" id="h22-1-38" class="d">-            (
</a><a href="#h22-1-39" id="h22-1-39" class="d">-                Field(
</a><a href="#h22-1-40" id="h22-1-40" class="d">-                    3,
</a><a href="#h22-1-41" id="h22-1-41" class="d">-                    None,
</a><a href="#h22-1-42" id="h22-1-42" class="d">-                ),
</a><a href="#h22-1-43" id="h22-1-43" class="i">+            Field(
</a><a href="#h22-1-44" id="h22-1-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h22-1-47" id="h22-1-47" class="d">-            (
</a><a href="#h22-1-48" id="h22-1-48" class="d">-                Field(
</a><a href="#h22-1-49" id="h22-1-49" class="d">-                    4,
</a><a href="#h22-1-50" id="h22-1-50" class="d">-                    None,
</a><a href="#h22-1-51" id="h22-1-51" class="d">-                ),
</a><a href="#h22-1-52" id="h22-1-52" class="i">+            Field(
</a><a href="#h22-1-53" id="h22-1-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h22-2" id="h22-2" class="h">@@ -265,66 +249,58 @@ Optimized plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h22-2-3" id="h22-2-3" class="i">+                labels: [
</a><a href="#h22-2-4" id="h22-2-4" class="i">+                    None,
</a><a href="#h22-2-5" id="h22-2-5" class="i">+                    None,
</a><a href="#h22-2-6" id="h22-2-6" class="i">+                    None,
</a><a href="#h22-2-7" id="h22-2-7" class="i">+                    None,
</a><a href="#h22-2-8" id="h22-2-8" class="i">+                    None,
</a><a href="#h22-2-9" id="h22-2-9" class="i">+                ],
</a>                 expressions: [
<a href="#h22-2-11" id="h22-2-11" class="d">-                    (
</a><a href="#h22-2-12" id="h22-2-12" class="d">-                        Field(
</a><a href="#h22-2-13" id="h22-2-13" class="d">-                            1,
</a><a href="#h22-2-14" id="h22-2-14" class="d">-                            Some(
</a><a href="#h22-2-15" id="h22-2-15" class="d">-                                (
</a><a href="#h22-2-16" id="h22-2-16" class="d">-                                    None,
</a><a href="#h22-2-17" id="h22-2-17" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-2-18" id="h22-2-18" class="d">-                                ),
</a><a href="#h22-2-19" id="h22-2-19" class="i">+                    Field(
</a><a href="#h22-2-20" id="h22-2-20" class="i">+                        1,
</a><a href="#h22-2-21" id="h22-2-21" class="i">+                        Some(
</a><a href="#h22-2-22" id="h22-2-22" class="i">+                            (
</a><a href="#h22-2-23" id="h22-2-23" class="i">+                                None,
</a><a href="#h22-2-24" id="h22-2-24" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-2-27" id="h22-2-27" class="d">-                        None,
</a>                     ),
<a href="#h22-2-29" id="h22-2-29" class="d">-                    (
</a><a href="#h22-2-30" id="h22-2-30" class="d">-                        Field(
</a><a href="#h22-2-31" id="h22-2-31" class="d">-                            1,
</a><a href="#h22-2-32" id="h22-2-32" class="d">-                            Some(
</a><a href="#h22-2-33" id="h22-2-33" class="d">-                                (
</a><a href="#h22-2-34" id="h22-2-34" class="d">-                                    None,
</a><a href="#h22-2-35" id="h22-2-35" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-2-36" id="h22-2-36" class="d">-                                ),
</a><a href="#h22-2-37" id="h22-2-37" class="i">+                    Field(
</a><a href="#h22-2-38" id="h22-2-38" class="i">+                        1,
</a><a href="#h22-2-39" id="h22-2-39" class="i">+                        Some(
</a><a href="#h22-2-40" id="h22-2-40" class="i">+                            (
</a><a href="#h22-2-41" id="h22-2-41" class="i">+                                None,
</a><a href="#h22-2-42" id="h22-2-42" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-2-45" id="h22-2-45" class="d">-                        None,
</a>                     ),
<a href="#h22-2-47" id="h22-2-47" class="d">-                    (
</a><a href="#h22-2-48" id="h22-2-48" class="d">-                        Field(
</a><a href="#h22-2-49" id="h22-2-49" class="d">-                            1,
</a><a href="#h22-2-50" id="h22-2-50" class="d">-                            Some(
</a><a href="#h22-2-51" id="h22-2-51" class="d">-                                (
</a><a href="#h22-2-52" id="h22-2-52" class="d">-                                    None,
</a><a href="#h22-2-53" id="h22-2-53" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-2-54" id="h22-2-54" class="d">-                                ),
</a><a href="#h22-2-55" id="h22-2-55" class="i">+                    Field(
</a><a href="#h22-2-56" id="h22-2-56" class="i">+                        1,
</a><a href="#h22-2-57" id="h22-2-57" class="i">+                        Some(
</a><a href="#h22-2-58" id="h22-2-58" class="i">+                            (
</a><a href="#h22-2-59" id="h22-2-59" class="i">+                                None,
</a><a href="#h22-2-60" id="h22-2-60" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-2-63" id="h22-2-63" class="d">-                        None,
</a>                     ),
<a href="#h22-2-65" id="h22-2-65" class="d">-                    (
</a><a href="#h22-2-66" id="h22-2-66" class="d">-                        Field(
</a><a href="#h22-2-67" id="h22-2-67" class="d">-                            1,
</a><a href="#h22-2-68" id="h22-2-68" class="d">-                            Some(
</a><a href="#h22-2-69" id="h22-2-69" class="d">-                                (
</a><a href="#h22-2-70" id="h22-2-70" class="d">-                                    None,
</a><a href="#h22-2-71" id="h22-2-71" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-2-72" id="h22-2-72" class="d">-                                ),
</a><a href="#h22-2-73" id="h22-2-73" class="i">+                    Field(
</a><a href="#h22-2-74" id="h22-2-74" class="i">+                        1,
</a><a href="#h22-2-75" id="h22-2-75" class="i">+                        Some(
</a><a href="#h22-2-76" id="h22-2-76" class="i">+                            (
</a><a href="#h22-2-77" id="h22-2-77" class="i">+                                None,
</a><a href="#h22-2-78" id="h22-2-78" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-2-81" id="h22-2-81" class="d">-                        None,
</a>                     ),
<a href="#h22-2-83" id="h22-2-83" class="d">-                    (
</a><a href="#h22-2-84" id="h22-2-84" class="d">-                        Field(
</a><a href="#h22-2-85" id="h22-2-85" class="d">-                            1,
</a><a href="#h22-2-86" id="h22-2-86" class="d">-                            Some(
</a><a href="#h22-2-87" id="h22-2-87" class="d">-                                (
</a><a href="#h22-2-88" id="h22-2-88" class="d">-                                    None,
</a><a href="#h22-2-89" id="h22-2-89" class="d">-                                    &quot;f&quot;,
</a><a href="#h22-2-90" id="h22-2-90" class="d">-                                ),
</a><a href="#h22-2-91" id="h22-2-91" class="i">+                    Field(
</a><a href="#h22-2-92" id="h22-2-92" class="i">+                        1,
</a><a href="#h22-2-93" id="h22-2-93" class="i">+                        Some(
</a><a href="#h22-2-94" id="h22-2-94" class="i">+                            (
</a><a href="#h22-2-95" id="h22-2-95" class="i">+                                None,
</a><a href="#h22-2-96" id="h22-2-96" class="i">+                                &quot;f&quot;,
</a>                             ),
                         ),
<a href="#h22-2-99" id="h22-2-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h22-3" id="h22-3" class="h">@@ -336,40 +312,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h22-3-3" id="h22-3-3" class="i">+        labels: [
</a><a href="#h22-3-4" id="h22-3-4" class="i">+            None,
</a><a href="#h22-3-5" id="h22-3-5" class="i">+            None,
</a><a href="#h22-3-6" id="h22-3-6" class="i">+            None,
</a><a href="#h22-3-7" id="h22-3-7" class="i">+            None,
</a><a href="#h22-3-8" id="h22-3-8" class="i">+            None,
</a><a href="#h22-3-9" id="h22-3-9" class="i">+        ],
</a>         expressions: [
<a href="#h22-3-11" id="h22-3-11" class="d">-            (
</a><a href="#h22-3-12" id="h22-3-12" class="d">-                Field(
</a><a href="#h22-3-13" id="h22-3-13" class="d">-                    0,
</a><a href="#h22-3-14" id="h22-3-14" class="d">-                    None,
</a><a href="#h22-3-15" id="h22-3-15" class="d">-                ),
</a><a href="#h22-3-16" id="h22-3-16" class="i">+            Field(
</a><a href="#h22-3-17" id="h22-3-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h22-3-20" id="h22-3-20" class="d">-            (
</a><a href="#h22-3-21" id="h22-3-21" class="d">-                Field(
</a><a href="#h22-3-22" id="h22-3-22" class="d">-                    1,
</a><a href="#h22-3-23" id="h22-3-23" class="d">-                    None,
</a><a href="#h22-3-24" id="h22-3-24" class="d">-                ),
</a><a href="#h22-3-25" id="h22-3-25" class="i">+            Field(
</a><a href="#h22-3-26" id="h22-3-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h22-3-29" id="h22-3-29" class="d">-            (
</a><a href="#h22-3-30" id="h22-3-30" class="d">-                Field(
</a><a href="#h22-3-31" id="h22-3-31" class="d">-                    2,
</a><a href="#h22-3-32" id="h22-3-32" class="d">-                    None,
</a><a href="#h22-3-33" id="h22-3-33" class="d">-                ),
</a><a href="#h22-3-34" id="h22-3-34" class="i">+            Field(
</a><a href="#h22-3-35" id="h22-3-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h22-3-38" id="h22-3-38" class="d">-            (
</a><a href="#h22-3-39" id="h22-3-39" class="d">-                Field(
</a><a href="#h22-3-40" id="h22-3-40" class="d">-                    3,
</a><a href="#h22-3-41" id="h22-3-41" class="d">-                    None,
</a><a href="#h22-3-42" id="h22-3-42" class="d">-                ),
</a><a href="#h22-3-43" id="h22-3-43" class="i">+            Field(
</a><a href="#h22-3-44" id="h22-3-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h22-3-47" id="h22-3-47" class="d">-            (
</a><a href="#h22-3-48" id="h22-3-48" class="d">-                Field(
</a><a href="#h22-3-49" id="h22-3-49" class="d">-                    4,
</a><a href="#h22-3-50" id="h22-3-50" class="d">-                    None,
</a><a href="#h22-3-51" id="h22-3-51" class="d">-                ),
</a><a href="#h22-3-52" id="h22-3-52" class="i">+            Field(
</a><a href="#h22-3-53" id="h22-3-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a> b/<a href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -148,66 +148,58 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h23-0-3" id="h23-0-3" class="i">+                labels: [
</a><a href="#h23-0-4" id="h23-0-4" class="i">+                    None,
</a><a href="#h23-0-5" id="h23-0-5" class="i">+                    None,
</a><a href="#h23-0-6" id="h23-0-6" class="i">+                    None,
</a><a href="#h23-0-7" id="h23-0-7" class="i">+                    None,
</a><a href="#h23-0-8" id="h23-0-8" class="i">+                    None,
</a><a href="#h23-0-9" id="h23-0-9" class="i">+                ],
</a>                 expressions: [
<a href="#h23-0-11" id="h23-0-11" class="d">-                    (
</a><a href="#h23-0-12" id="h23-0-12" class="d">-                        Field(
</a><a href="#h23-0-13" id="h23-0-13" class="d">-                            1,
</a><a href="#h23-0-14" id="h23-0-14" class="d">-                            Some(
</a><a href="#h23-0-15" id="h23-0-15" class="d">-                                (
</a><a href="#h23-0-16" id="h23-0-16" class="d">-                                    None,
</a><a href="#h23-0-17" id="h23-0-17" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-0-18" id="h23-0-18" class="d">-                                ),
</a><a href="#h23-0-19" id="h23-0-19" class="i">+                    Field(
</a><a href="#h23-0-20" id="h23-0-20" class="i">+                        1,
</a><a href="#h23-0-21" id="h23-0-21" class="i">+                        Some(
</a><a href="#h23-0-22" id="h23-0-22" class="i">+                            (
</a><a href="#h23-0-23" id="h23-0-23" class="i">+                                None,
</a><a href="#h23-0-24" id="h23-0-24" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-0-27" id="h23-0-27" class="d">-                        None,
</a>                     ),
<a href="#h23-0-29" id="h23-0-29" class="d">-                    (
</a><a href="#h23-0-30" id="h23-0-30" class="d">-                        Field(
</a><a href="#h23-0-31" id="h23-0-31" class="d">-                            1,
</a><a href="#h23-0-32" id="h23-0-32" class="d">-                            Some(
</a><a href="#h23-0-33" id="h23-0-33" class="d">-                                (
</a><a href="#h23-0-34" id="h23-0-34" class="d">-                                    None,
</a><a href="#h23-0-35" id="h23-0-35" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-0-36" id="h23-0-36" class="d">-                                ),
</a><a href="#h23-0-37" id="h23-0-37" class="i">+                    Field(
</a><a href="#h23-0-38" id="h23-0-38" class="i">+                        1,
</a><a href="#h23-0-39" id="h23-0-39" class="i">+                        Some(
</a><a href="#h23-0-40" id="h23-0-40" class="i">+                            (
</a><a href="#h23-0-41" id="h23-0-41" class="i">+                                None,
</a><a href="#h23-0-42" id="h23-0-42" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-0-45" id="h23-0-45" class="d">-                        None,
</a>                     ),
<a href="#h23-0-47" id="h23-0-47" class="d">-                    (
</a><a href="#h23-0-48" id="h23-0-48" class="d">-                        Field(
</a><a href="#h23-0-49" id="h23-0-49" class="d">-                            1,
</a><a href="#h23-0-50" id="h23-0-50" class="d">-                            Some(
</a><a href="#h23-0-51" id="h23-0-51" class="d">-                                (
</a><a href="#h23-0-52" id="h23-0-52" class="d">-                                    None,
</a><a href="#h23-0-53" id="h23-0-53" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-0-54" id="h23-0-54" class="d">-                                ),
</a><a href="#h23-0-55" id="h23-0-55" class="i">+                    Field(
</a><a href="#h23-0-56" id="h23-0-56" class="i">+                        1,
</a><a href="#h23-0-57" id="h23-0-57" class="i">+                        Some(
</a><a href="#h23-0-58" id="h23-0-58" class="i">+                            (
</a><a href="#h23-0-59" id="h23-0-59" class="i">+                                None,
</a><a href="#h23-0-60" id="h23-0-60" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-0-63" id="h23-0-63" class="d">-                        None,
</a>                     ),
<a href="#h23-0-65" id="h23-0-65" class="d">-                    (
</a><a href="#h23-0-66" id="h23-0-66" class="d">-                        Field(
</a><a href="#h23-0-67" id="h23-0-67" class="d">-                            1,
</a><a href="#h23-0-68" id="h23-0-68" class="d">-                            Some(
</a><a href="#h23-0-69" id="h23-0-69" class="d">-                                (
</a><a href="#h23-0-70" id="h23-0-70" class="d">-                                    None,
</a><a href="#h23-0-71" id="h23-0-71" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-0-72" id="h23-0-72" class="d">-                                ),
</a><a href="#h23-0-73" id="h23-0-73" class="i">+                    Field(
</a><a href="#h23-0-74" id="h23-0-74" class="i">+                        1,
</a><a href="#h23-0-75" id="h23-0-75" class="i">+                        Some(
</a><a href="#h23-0-76" id="h23-0-76" class="i">+                            (
</a><a href="#h23-0-77" id="h23-0-77" class="i">+                                None,
</a><a href="#h23-0-78" id="h23-0-78" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-0-81" id="h23-0-81" class="d">-                        None,
</a>                     ),
<a href="#h23-0-83" id="h23-0-83" class="d">-                    (
</a><a href="#h23-0-84" id="h23-0-84" class="d">-                        Field(
</a><a href="#h23-0-85" id="h23-0-85" class="d">-                            1,
</a><a href="#h23-0-86" id="h23-0-86" class="d">-                            Some(
</a><a href="#h23-0-87" id="h23-0-87" class="d">-                                (
</a><a href="#h23-0-88" id="h23-0-88" class="d">-                                    None,
</a><a href="#h23-0-89" id="h23-0-89" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-0-90" id="h23-0-90" class="d">-                                ),
</a><a href="#h23-0-91" id="h23-0-91" class="i">+                    Field(
</a><a href="#h23-0-92" id="h23-0-92" class="i">+                        1,
</a><a href="#h23-0-93" id="h23-0-93" class="i">+                        Some(
</a><a href="#h23-0-94" id="h23-0-94" class="i">+                            (
</a><a href="#h23-0-95" id="h23-0-95" class="i">+                                None,
</a><a href="#h23-0-96" id="h23-0-96" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-0-99" id="h23-0-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h23-1" id="h23-1" class="h">@@ -219,40 +211,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h23-1-3" id="h23-1-3" class="i">+        labels: [
</a><a href="#h23-1-4" id="h23-1-4" class="i">+            None,
</a><a href="#h23-1-5" id="h23-1-5" class="i">+            None,
</a><a href="#h23-1-6" id="h23-1-6" class="i">+            None,
</a><a href="#h23-1-7" id="h23-1-7" class="i">+            None,
</a><a href="#h23-1-8" id="h23-1-8" class="i">+            None,
</a><a href="#h23-1-9" id="h23-1-9" class="i">+        ],
</a>         expressions: [
<a href="#h23-1-11" id="h23-1-11" class="d">-            (
</a><a href="#h23-1-12" id="h23-1-12" class="d">-                Field(
</a><a href="#h23-1-13" id="h23-1-13" class="d">-                    0,
</a><a href="#h23-1-14" id="h23-1-14" class="d">-                    None,
</a><a href="#h23-1-15" id="h23-1-15" class="d">-                ),
</a><a href="#h23-1-16" id="h23-1-16" class="i">+            Field(
</a><a href="#h23-1-17" id="h23-1-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h23-1-20" id="h23-1-20" class="d">-            (
</a><a href="#h23-1-21" id="h23-1-21" class="d">-                Field(
</a><a href="#h23-1-22" id="h23-1-22" class="d">-                    1,
</a><a href="#h23-1-23" id="h23-1-23" class="d">-                    None,
</a><a href="#h23-1-24" id="h23-1-24" class="d">-                ),
</a><a href="#h23-1-25" id="h23-1-25" class="i">+            Field(
</a><a href="#h23-1-26" id="h23-1-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h23-1-29" id="h23-1-29" class="d">-            (
</a><a href="#h23-1-30" id="h23-1-30" class="d">-                Field(
</a><a href="#h23-1-31" id="h23-1-31" class="d">-                    2,
</a><a href="#h23-1-32" id="h23-1-32" class="d">-                    None,
</a><a href="#h23-1-33" id="h23-1-33" class="d">-                ),
</a><a href="#h23-1-34" id="h23-1-34" class="i">+            Field(
</a><a href="#h23-1-35" id="h23-1-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h23-1-38" id="h23-1-38" class="d">-            (
</a><a href="#h23-1-39" id="h23-1-39" class="d">-                Field(
</a><a href="#h23-1-40" id="h23-1-40" class="d">-                    3,
</a><a href="#h23-1-41" id="h23-1-41" class="d">-                    None,
</a><a href="#h23-1-42" id="h23-1-42" class="d">-                ),
</a><a href="#h23-1-43" id="h23-1-43" class="i">+            Field(
</a><a href="#h23-1-44" id="h23-1-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h23-1-47" id="h23-1-47" class="d">-            (
</a><a href="#h23-1-48" id="h23-1-48" class="d">-                Field(
</a><a href="#h23-1-49" id="h23-1-49" class="d">-                    4,
</a><a href="#h23-1-50" id="h23-1-50" class="d">-                    None,
</a><a href="#h23-1-51" id="h23-1-51" class="d">-                ),
</a><a href="#h23-1-52" id="h23-1-52" class="i">+            Field(
</a><a href="#h23-1-53" id="h23-1-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h23-2" id="h23-2" class="h">@@ -307,66 +291,58 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h23-2-3" id="h23-2-3" class="i">+                labels: [
</a><a href="#h23-2-4" id="h23-2-4" class="i">+                    None,
</a><a href="#h23-2-5" id="h23-2-5" class="i">+                    None,
</a><a href="#h23-2-6" id="h23-2-6" class="i">+                    None,
</a><a href="#h23-2-7" id="h23-2-7" class="i">+                    None,
</a><a href="#h23-2-8" id="h23-2-8" class="i">+                    None,
</a><a href="#h23-2-9" id="h23-2-9" class="i">+                ],
</a>                 expressions: [
<a href="#h23-2-11" id="h23-2-11" class="d">-                    (
</a><a href="#h23-2-12" id="h23-2-12" class="d">-                        Field(
</a><a href="#h23-2-13" id="h23-2-13" class="d">-                            1,
</a><a href="#h23-2-14" id="h23-2-14" class="d">-                            Some(
</a><a href="#h23-2-15" id="h23-2-15" class="d">-                                (
</a><a href="#h23-2-16" id="h23-2-16" class="d">-                                    None,
</a><a href="#h23-2-17" id="h23-2-17" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-2-18" id="h23-2-18" class="d">-                                ),
</a><a href="#h23-2-19" id="h23-2-19" class="i">+                    Field(
</a><a href="#h23-2-20" id="h23-2-20" class="i">+                        1,
</a><a href="#h23-2-21" id="h23-2-21" class="i">+                        Some(
</a><a href="#h23-2-22" id="h23-2-22" class="i">+                            (
</a><a href="#h23-2-23" id="h23-2-23" class="i">+                                None,
</a><a href="#h23-2-24" id="h23-2-24" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-2-27" id="h23-2-27" class="d">-                        None,
</a>                     ),
<a href="#h23-2-29" id="h23-2-29" class="d">-                    (
</a><a href="#h23-2-30" id="h23-2-30" class="d">-                        Field(
</a><a href="#h23-2-31" id="h23-2-31" class="d">-                            1,
</a><a href="#h23-2-32" id="h23-2-32" class="d">-                            Some(
</a><a href="#h23-2-33" id="h23-2-33" class="d">-                                (
</a><a href="#h23-2-34" id="h23-2-34" class="d">-                                    None,
</a><a href="#h23-2-35" id="h23-2-35" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-2-36" id="h23-2-36" class="d">-                                ),
</a><a href="#h23-2-37" id="h23-2-37" class="i">+                    Field(
</a><a href="#h23-2-38" id="h23-2-38" class="i">+                        1,
</a><a href="#h23-2-39" id="h23-2-39" class="i">+                        Some(
</a><a href="#h23-2-40" id="h23-2-40" class="i">+                            (
</a><a href="#h23-2-41" id="h23-2-41" class="i">+                                None,
</a><a href="#h23-2-42" id="h23-2-42" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-2-45" id="h23-2-45" class="d">-                        None,
</a>                     ),
<a href="#h23-2-47" id="h23-2-47" class="d">-                    (
</a><a href="#h23-2-48" id="h23-2-48" class="d">-                        Field(
</a><a href="#h23-2-49" id="h23-2-49" class="d">-                            1,
</a><a href="#h23-2-50" id="h23-2-50" class="d">-                            Some(
</a><a href="#h23-2-51" id="h23-2-51" class="d">-                                (
</a><a href="#h23-2-52" id="h23-2-52" class="d">-                                    None,
</a><a href="#h23-2-53" id="h23-2-53" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-2-54" id="h23-2-54" class="d">-                                ),
</a><a href="#h23-2-55" id="h23-2-55" class="i">+                    Field(
</a><a href="#h23-2-56" id="h23-2-56" class="i">+                        1,
</a><a href="#h23-2-57" id="h23-2-57" class="i">+                        Some(
</a><a href="#h23-2-58" id="h23-2-58" class="i">+                            (
</a><a href="#h23-2-59" id="h23-2-59" class="i">+                                None,
</a><a href="#h23-2-60" id="h23-2-60" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-2-63" id="h23-2-63" class="d">-                        None,
</a>                     ),
<a href="#h23-2-65" id="h23-2-65" class="d">-                    (
</a><a href="#h23-2-66" id="h23-2-66" class="d">-                        Field(
</a><a href="#h23-2-67" id="h23-2-67" class="d">-                            1,
</a><a href="#h23-2-68" id="h23-2-68" class="d">-                            Some(
</a><a href="#h23-2-69" id="h23-2-69" class="d">-                                (
</a><a href="#h23-2-70" id="h23-2-70" class="d">-                                    None,
</a><a href="#h23-2-71" id="h23-2-71" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-2-72" id="h23-2-72" class="d">-                                ),
</a><a href="#h23-2-73" id="h23-2-73" class="i">+                    Field(
</a><a href="#h23-2-74" id="h23-2-74" class="i">+                        1,
</a><a href="#h23-2-75" id="h23-2-75" class="i">+                        Some(
</a><a href="#h23-2-76" id="h23-2-76" class="i">+                            (
</a><a href="#h23-2-77" id="h23-2-77" class="i">+                                None,
</a><a href="#h23-2-78" id="h23-2-78" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-2-81" id="h23-2-81" class="d">-                        None,
</a>                     ),
<a href="#h23-2-83" id="h23-2-83" class="d">-                    (
</a><a href="#h23-2-84" id="h23-2-84" class="d">-                        Field(
</a><a href="#h23-2-85" id="h23-2-85" class="d">-                            1,
</a><a href="#h23-2-86" id="h23-2-86" class="d">-                            Some(
</a><a href="#h23-2-87" id="h23-2-87" class="d">-                                (
</a><a href="#h23-2-88" id="h23-2-88" class="d">-                                    None,
</a><a href="#h23-2-89" id="h23-2-89" class="d">-                                    &quot;i&quot;,
</a><a href="#h23-2-90" id="h23-2-90" class="d">-                                ),
</a><a href="#h23-2-91" id="h23-2-91" class="i">+                    Field(
</a><a href="#h23-2-92" id="h23-2-92" class="i">+                        1,
</a><a href="#h23-2-93" id="h23-2-93" class="i">+                        Some(
</a><a href="#h23-2-94" id="h23-2-94" class="i">+                            (
</a><a href="#h23-2-95" id="h23-2-95" class="i">+                                None,
</a><a href="#h23-2-96" id="h23-2-96" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h23-2-99" id="h23-2-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h23-3" id="h23-3" class="h">@@ -378,40 +354,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h23-3-3" id="h23-3-3" class="i">+        labels: [
</a><a href="#h23-3-4" id="h23-3-4" class="i">+            None,
</a><a href="#h23-3-5" id="h23-3-5" class="i">+            None,
</a><a href="#h23-3-6" id="h23-3-6" class="i">+            None,
</a><a href="#h23-3-7" id="h23-3-7" class="i">+            None,
</a><a href="#h23-3-8" id="h23-3-8" class="i">+            None,
</a><a href="#h23-3-9" id="h23-3-9" class="i">+        ],
</a>         expressions: [
<a href="#h23-3-11" id="h23-3-11" class="d">-            (
</a><a href="#h23-3-12" id="h23-3-12" class="d">-                Field(
</a><a href="#h23-3-13" id="h23-3-13" class="d">-                    0,
</a><a href="#h23-3-14" id="h23-3-14" class="d">-                    None,
</a><a href="#h23-3-15" id="h23-3-15" class="d">-                ),
</a><a href="#h23-3-16" id="h23-3-16" class="i">+            Field(
</a><a href="#h23-3-17" id="h23-3-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h23-3-20" id="h23-3-20" class="d">-            (
</a><a href="#h23-3-21" id="h23-3-21" class="d">-                Field(
</a><a href="#h23-3-22" id="h23-3-22" class="d">-                    1,
</a><a href="#h23-3-23" id="h23-3-23" class="d">-                    None,
</a><a href="#h23-3-24" id="h23-3-24" class="d">-                ),
</a><a href="#h23-3-25" id="h23-3-25" class="i">+            Field(
</a><a href="#h23-3-26" id="h23-3-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h23-3-29" id="h23-3-29" class="d">-            (
</a><a href="#h23-3-30" id="h23-3-30" class="d">-                Field(
</a><a href="#h23-3-31" id="h23-3-31" class="d">-                    2,
</a><a href="#h23-3-32" id="h23-3-32" class="d">-                    None,
</a><a href="#h23-3-33" id="h23-3-33" class="d">-                ),
</a><a href="#h23-3-34" id="h23-3-34" class="i">+            Field(
</a><a href="#h23-3-35" id="h23-3-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h23-3-38" id="h23-3-38" class="d">-            (
</a><a href="#h23-3-39" id="h23-3-39" class="d">-                Field(
</a><a href="#h23-3-40" id="h23-3-40" class="d">-                    3,
</a><a href="#h23-3-41" id="h23-3-41" class="d">-                    None,
</a><a href="#h23-3-42" id="h23-3-42" class="d">-                ),
</a><a href="#h23-3-43" id="h23-3-43" class="i">+            Field(
</a><a href="#h23-3-44" id="h23-3-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h23-3-47" id="h23-3-47" class="d">-            (
</a><a href="#h23-3-48" id="h23-3-48" class="d">-                Field(
</a><a href="#h23-3-49" id="h23-3-49" class="d">-                    4,
</a><a href="#h23-3-50" id="h23-3-50" class="d">-                    None,
</a><a href="#h23-3-51" id="h23-3-51" class="d">-                ),
</a><a href="#h23-3-52" id="h23-3-52" class="i">+            Field(
</a><a href="#h23-3-53" id="h23-3-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a> b/<a href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -120,66 +120,58 @@ Plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h24-0-3" id="h24-0-3" class="i">+                labels: [
</a><a href="#h24-0-4" id="h24-0-4" class="i">+                    None,
</a><a href="#h24-0-5" id="h24-0-5" class="i">+                    None,
</a><a href="#h24-0-6" id="h24-0-6" class="i">+                    None,
</a><a href="#h24-0-7" id="h24-0-7" class="i">+                    None,
</a><a href="#h24-0-8" id="h24-0-8" class="i">+                    None,
</a><a href="#h24-0-9" id="h24-0-9" class="i">+                ],
</a>                 expressions: [
<a href="#h24-0-11" id="h24-0-11" class="d">-                    (
</a><a href="#h24-0-12" id="h24-0-12" class="d">-                        Field(
</a><a href="#h24-0-13" id="h24-0-13" class="d">-                            1,
</a><a href="#h24-0-14" id="h24-0-14" class="d">-                            Some(
</a><a href="#h24-0-15" id="h24-0-15" class="d">-                                (
</a><a href="#h24-0-16" id="h24-0-16" class="d">-                                    None,
</a><a href="#h24-0-17" id="h24-0-17" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-0-18" id="h24-0-18" class="d">-                                ),
</a><a href="#h24-0-19" id="h24-0-19" class="i">+                    Field(
</a><a href="#h24-0-20" id="h24-0-20" class="i">+                        1,
</a><a href="#h24-0-21" id="h24-0-21" class="i">+                        Some(
</a><a href="#h24-0-22" id="h24-0-22" class="i">+                            (
</a><a href="#h24-0-23" id="h24-0-23" class="i">+                                None,
</a><a href="#h24-0-24" id="h24-0-24" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-0-27" id="h24-0-27" class="d">-                        None,
</a>                     ),
<a href="#h24-0-29" id="h24-0-29" class="d">-                    (
</a><a href="#h24-0-30" id="h24-0-30" class="d">-                        Field(
</a><a href="#h24-0-31" id="h24-0-31" class="d">-                            1,
</a><a href="#h24-0-32" id="h24-0-32" class="d">-                            Some(
</a><a href="#h24-0-33" id="h24-0-33" class="d">-                                (
</a><a href="#h24-0-34" id="h24-0-34" class="d">-                                    None,
</a><a href="#h24-0-35" id="h24-0-35" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-0-36" id="h24-0-36" class="d">-                                ),
</a><a href="#h24-0-37" id="h24-0-37" class="i">+                    Field(
</a><a href="#h24-0-38" id="h24-0-38" class="i">+                        1,
</a><a href="#h24-0-39" id="h24-0-39" class="i">+                        Some(
</a><a href="#h24-0-40" id="h24-0-40" class="i">+                            (
</a><a href="#h24-0-41" id="h24-0-41" class="i">+                                None,
</a><a href="#h24-0-42" id="h24-0-42" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-0-45" id="h24-0-45" class="d">-                        None,
</a>                     ),
<a href="#h24-0-47" id="h24-0-47" class="d">-                    (
</a><a href="#h24-0-48" id="h24-0-48" class="d">-                        Field(
</a><a href="#h24-0-49" id="h24-0-49" class="d">-                            1,
</a><a href="#h24-0-50" id="h24-0-50" class="d">-                            Some(
</a><a href="#h24-0-51" id="h24-0-51" class="d">-                                (
</a><a href="#h24-0-52" id="h24-0-52" class="d">-                                    None,
</a><a href="#h24-0-53" id="h24-0-53" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-0-54" id="h24-0-54" class="d">-                                ),
</a><a href="#h24-0-55" id="h24-0-55" class="i">+                    Field(
</a><a href="#h24-0-56" id="h24-0-56" class="i">+                        1,
</a><a href="#h24-0-57" id="h24-0-57" class="i">+                        Some(
</a><a href="#h24-0-58" id="h24-0-58" class="i">+                            (
</a><a href="#h24-0-59" id="h24-0-59" class="i">+                                None,
</a><a href="#h24-0-60" id="h24-0-60" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-0-63" id="h24-0-63" class="d">-                        None,
</a>                     ),
<a href="#h24-0-65" id="h24-0-65" class="d">-                    (
</a><a href="#h24-0-66" id="h24-0-66" class="d">-                        Field(
</a><a href="#h24-0-67" id="h24-0-67" class="d">-                            1,
</a><a href="#h24-0-68" id="h24-0-68" class="d">-                            Some(
</a><a href="#h24-0-69" id="h24-0-69" class="d">-                                (
</a><a href="#h24-0-70" id="h24-0-70" class="d">-                                    None,
</a><a href="#h24-0-71" id="h24-0-71" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-0-72" id="h24-0-72" class="d">-                                ),
</a><a href="#h24-0-73" id="h24-0-73" class="i">+                    Field(
</a><a href="#h24-0-74" id="h24-0-74" class="i">+                        1,
</a><a href="#h24-0-75" id="h24-0-75" class="i">+                        Some(
</a><a href="#h24-0-76" id="h24-0-76" class="i">+                            (
</a><a href="#h24-0-77" id="h24-0-77" class="i">+                                None,
</a><a href="#h24-0-78" id="h24-0-78" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-0-81" id="h24-0-81" class="d">-                        None,
</a>                     ),
<a href="#h24-0-83" id="h24-0-83" class="d">-                    (
</a><a href="#h24-0-84" id="h24-0-84" class="d">-                        Field(
</a><a href="#h24-0-85" id="h24-0-85" class="d">-                            1,
</a><a href="#h24-0-86" id="h24-0-86" class="d">-                            Some(
</a><a href="#h24-0-87" id="h24-0-87" class="d">-                                (
</a><a href="#h24-0-88" id="h24-0-88" class="d">-                                    None,
</a><a href="#h24-0-89" id="h24-0-89" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-0-90" id="h24-0-90" class="d">-                                ),
</a><a href="#h24-0-91" id="h24-0-91" class="i">+                    Field(
</a><a href="#h24-0-92" id="h24-0-92" class="i">+                        1,
</a><a href="#h24-0-93" id="h24-0-93" class="i">+                        Some(
</a><a href="#h24-0-94" id="h24-0-94" class="i">+                            (
</a><a href="#h24-0-95" id="h24-0-95" class="i">+                                None,
</a><a href="#h24-0-96" id="h24-0-96" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-0-99" id="h24-0-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h24-1" id="h24-1" class="h">@@ -191,40 +183,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h24-1-3" id="h24-1-3" class="i">+        labels: [
</a><a href="#h24-1-4" id="h24-1-4" class="i">+            None,
</a><a href="#h24-1-5" id="h24-1-5" class="i">+            None,
</a><a href="#h24-1-6" id="h24-1-6" class="i">+            None,
</a><a href="#h24-1-7" id="h24-1-7" class="i">+            None,
</a><a href="#h24-1-8" id="h24-1-8" class="i">+            None,
</a><a href="#h24-1-9" id="h24-1-9" class="i">+        ],
</a>         expressions: [
<a href="#h24-1-11" id="h24-1-11" class="d">-            (
</a><a href="#h24-1-12" id="h24-1-12" class="d">-                Field(
</a><a href="#h24-1-13" id="h24-1-13" class="d">-                    0,
</a><a href="#h24-1-14" id="h24-1-14" class="d">-                    None,
</a><a href="#h24-1-15" id="h24-1-15" class="d">-                ),
</a><a href="#h24-1-16" id="h24-1-16" class="i">+            Field(
</a><a href="#h24-1-17" id="h24-1-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h24-1-20" id="h24-1-20" class="d">-            (
</a><a href="#h24-1-21" id="h24-1-21" class="d">-                Field(
</a><a href="#h24-1-22" id="h24-1-22" class="d">-                    1,
</a><a href="#h24-1-23" id="h24-1-23" class="d">-                    None,
</a><a href="#h24-1-24" id="h24-1-24" class="d">-                ),
</a><a href="#h24-1-25" id="h24-1-25" class="i">+            Field(
</a><a href="#h24-1-26" id="h24-1-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h24-1-29" id="h24-1-29" class="d">-            (
</a><a href="#h24-1-30" id="h24-1-30" class="d">-                Field(
</a><a href="#h24-1-31" id="h24-1-31" class="d">-                    2,
</a><a href="#h24-1-32" id="h24-1-32" class="d">-                    None,
</a><a href="#h24-1-33" id="h24-1-33" class="d">-                ),
</a><a href="#h24-1-34" id="h24-1-34" class="i">+            Field(
</a><a href="#h24-1-35" id="h24-1-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h24-1-38" id="h24-1-38" class="d">-            (
</a><a href="#h24-1-39" id="h24-1-39" class="d">-                Field(
</a><a href="#h24-1-40" id="h24-1-40" class="d">-                    3,
</a><a href="#h24-1-41" id="h24-1-41" class="d">-                    None,
</a><a href="#h24-1-42" id="h24-1-42" class="d">-                ),
</a><a href="#h24-1-43" id="h24-1-43" class="i">+            Field(
</a><a href="#h24-1-44" id="h24-1-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h24-1-47" id="h24-1-47" class="d">-            (
</a><a href="#h24-1-48" id="h24-1-48" class="d">-                Field(
</a><a href="#h24-1-49" id="h24-1-49" class="d">-                    4,
</a><a href="#h24-1-50" id="h24-1-50" class="d">-                    None,
</a><a href="#h24-1-51" id="h24-1-51" class="d">-                ),
</a><a href="#h24-1-52" id="h24-1-52" class="i">+            Field(
</a><a href="#h24-1-53" id="h24-1-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h24-2" id="h24-2" class="h">@@ -265,66 +249,58 @@ Optimized plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h24-2-3" id="h24-2-3" class="i">+                labels: [
</a><a href="#h24-2-4" id="h24-2-4" class="i">+                    None,
</a><a href="#h24-2-5" id="h24-2-5" class="i">+                    None,
</a><a href="#h24-2-6" id="h24-2-6" class="i">+                    None,
</a><a href="#h24-2-7" id="h24-2-7" class="i">+                    None,
</a><a href="#h24-2-8" id="h24-2-8" class="i">+                    None,
</a><a href="#h24-2-9" id="h24-2-9" class="i">+                ],
</a>                 expressions: [
<a href="#h24-2-11" id="h24-2-11" class="d">-                    (
</a><a href="#h24-2-12" id="h24-2-12" class="d">-                        Field(
</a><a href="#h24-2-13" id="h24-2-13" class="d">-                            1,
</a><a href="#h24-2-14" id="h24-2-14" class="d">-                            Some(
</a><a href="#h24-2-15" id="h24-2-15" class="d">-                                (
</a><a href="#h24-2-16" id="h24-2-16" class="d">-                                    None,
</a><a href="#h24-2-17" id="h24-2-17" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-2-18" id="h24-2-18" class="d">-                                ),
</a><a href="#h24-2-19" id="h24-2-19" class="i">+                    Field(
</a><a href="#h24-2-20" id="h24-2-20" class="i">+                        1,
</a><a href="#h24-2-21" id="h24-2-21" class="i">+                        Some(
</a><a href="#h24-2-22" id="h24-2-22" class="i">+                            (
</a><a href="#h24-2-23" id="h24-2-23" class="i">+                                None,
</a><a href="#h24-2-24" id="h24-2-24" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-2-27" id="h24-2-27" class="d">-                        None,
</a>                     ),
<a href="#h24-2-29" id="h24-2-29" class="d">-                    (
</a><a href="#h24-2-30" id="h24-2-30" class="d">-                        Field(
</a><a href="#h24-2-31" id="h24-2-31" class="d">-                            1,
</a><a href="#h24-2-32" id="h24-2-32" class="d">-                            Some(
</a><a href="#h24-2-33" id="h24-2-33" class="d">-                                (
</a><a href="#h24-2-34" id="h24-2-34" class="d">-                                    None,
</a><a href="#h24-2-35" id="h24-2-35" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-2-36" id="h24-2-36" class="d">-                                ),
</a><a href="#h24-2-37" id="h24-2-37" class="i">+                    Field(
</a><a href="#h24-2-38" id="h24-2-38" class="i">+                        1,
</a><a href="#h24-2-39" id="h24-2-39" class="i">+                        Some(
</a><a href="#h24-2-40" id="h24-2-40" class="i">+                            (
</a><a href="#h24-2-41" id="h24-2-41" class="i">+                                None,
</a><a href="#h24-2-42" id="h24-2-42" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-2-45" id="h24-2-45" class="d">-                        None,
</a>                     ),
<a href="#h24-2-47" id="h24-2-47" class="d">-                    (
</a><a href="#h24-2-48" id="h24-2-48" class="d">-                        Field(
</a><a href="#h24-2-49" id="h24-2-49" class="d">-                            1,
</a><a href="#h24-2-50" id="h24-2-50" class="d">-                            Some(
</a><a href="#h24-2-51" id="h24-2-51" class="d">-                                (
</a><a href="#h24-2-52" id="h24-2-52" class="d">-                                    None,
</a><a href="#h24-2-53" id="h24-2-53" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-2-54" id="h24-2-54" class="d">-                                ),
</a><a href="#h24-2-55" id="h24-2-55" class="i">+                    Field(
</a><a href="#h24-2-56" id="h24-2-56" class="i">+                        1,
</a><a href="#h24-2-57" id="h24-2-57" class="i">+                        Some(
</a><a href="#h24-2-58" id="h24-2-58" class="i">+                            (
</a><a href="#h24-2-59" id="h24-2-59" class="i">+                                None,
</a><a href="#h24-2-60" id="h24-2-60" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-2-63" id="h24-2-63" class="d">-                        None,
</a>                     ),
<a href="#h24-2-65" id="h24-2-65" class="d">-                    (
</a><a href="#h24-2-66" id="h24-2-66" class="d">-                        Field(
</a><a href="#h24-2-67" id="h24-2-67" class="d">-                            1,
</a><a href="#h24-2-68" id="h24-2-68" class="d">-                            Some(
</a><a href="#h24-2-69" id="h24-2-69" class="d">-                                (
</a><a href="#h24-2-70" id="h24-2-70" class="d">-                                    None,
</a><a href="#h24-2-71" id="h24-2-71" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-2-72" id="h24-2-72" class="d">-                                ),
</a><a href="#h24-2-73" id="h24-2-73" class="i">+                    Field(
</a><a href="#h24-2-74" id="h24-2-74" class="i">+                        1,
</a><a href="#h24-2-75" id="h24-2-75" class="i">+                        Some(
</a><a href="#h24-2-76" id="h24-2-76" class="i">+                            (
</a><a href="#h24-2-77" id="h24-2-77" class="i">+                                None,
</a><a href="#h24-2-78" id="h24-2-78" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-2-81" id="h24-2-81" class="d">-                        None,
</a>                     ),
<a href="#h24-2-83" id="h24-2-83" class="d">-                    (
</a><a href="#h24-2-84" id="h24-2-84" class="d">-                        Field(
</a><a href="#h24-2-85" id="h24-2-85" class="d">-                            1,
</a><a href="#h24-2-86" id="h24-2-86" class="d">-                            Some(
</a><a href="#h24-2-87" id="h24-2-87" class="d">-                                (
</a><a href="#h24-2-88" id="h24-2-88" class="d">-                                    None,
</a><a href="#h24-2-89" id="h24-2-89" class="d">-                                    &quot;i&quot;,
</a><a href="#h24-2-90" id="h24-2-90" class="d">-                                ),
</a><a href="#h24-2-91" id="h24-2-91" class="i">+                    Field(
</a><a href="#h24-2-92" id="h24-2-92" class="i">+                        1,
</a><a href="#h24-2-93" id="h24-2-93" class="i">+                        Some(
</a><a href="#h24-2-94" id="h24-2-94" class="i">+                            (
</a><a href="#h24-2-95" id="h24-2-95" class="i">+                                None,
</a><a href="#h24-2-96" id="h24-2-96" class="i">+                                &quot;i&quot;,
</a>                             ),
                         ),
<a href="#h24-2-99" id="h24-2-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h24-3" id="h24-3" class="h">@@ -336,40 +312,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h24-3-3" id="h24-3-3" class="i">+        labels: [
</a><a href="#h24-3-4" id="h24-3-4" class="i">+            None,
</a><a href="#h24-3-5" id="h24-3-5" class="i">+            None,
</a><a href="#h24-3-6" id="h24-3-6" class="i">+            None,
</a><a href="#h24-3-7" id="h24-3-7" class="i">+            None,
</a><a href="#h24-3-8" id="h24-3-8" class="i">+            None,
</a><a href="#h24-3-9" id="h24-3-9" class="i">+        ],
</a>         expressions: [
<a href="#h24-3-11" id="h24-3-11" class="d">-            (
</a><a href="#h24-3-12" id="h24-3-12" class="d">-                Field(
</a><a href="#h24-3-13" id="h24-3-13" class="d">-                    0,
</a><a href="#h24-3-14" id="h24-3-14" class="d">-                    None,
</a><a href="#h24-3-15" id="h24-3-15" class="d">-                ),
</a><a href="#h24-3-16" id="h24-3-16" class="i">+            Field(
</a><a href="#h24-3-17" id="h24-3-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h24-3-20" id="h24-3-20" class="d">-            (
</a><a href="#h24-3-21" id="h24-3-21" class="d">-                Field(
</a><a href="#h24-3-22" id="h24-3-22" class="d">-                    1,
</a><a href="#h24-3-23" id="h24-3-23" class="d">-                    None,
</a><a href="#h24-3-24" id="h24-3-24" class="d">-                ),
</a><a href="#h24-3-25" id="h24-3-25" class="i">+            Field(
</a><a href="#h24-3-26" id="h24-3-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h24-3-29" id="h24-3-29" class="d">-            (
</a><a href="#h24-3-30" id="h24-3-30" class="d">-                Field(
</a><a href="#h24-3-31" id="h24-3-31" class="d">-                    2,
</a><a href="#h24-3-32" id="h24-3-32" class="d">-                    None,
</a><a href="#h24-3-33" id="h24-3-33" class="d">-                ),
</a><a href="#h24-3-34" id="h24-3-34" class="i">+            Field(
</a><a href="#h24-3-35" id="h24-3-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h24-3-38" id="h24-3-38" class="d">-            (
</a><a href="#h24-3-39" id="h24-3-39" class="d">-                Field(
</a><a href="#h24-3-40" id="h24-3-40" class="d">-                    3,
</a><a href="#h24-3-41" id="h24-3-41" class="d">-                    None,
</a><a href="#h24-3-42" id="h24-3-42" class="d">-                ),
</a><a href="#h24-3-43" id="h24-3-43" class="i">+            Field(
</a><a href="#h24-3-44" id="h24-3-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h24-3-47" id="h24-3-47" class="d">-            (
</a><a href="#h24-3-48" id="h24-3-48" class="d">-                Field(
</a><a href="#h24-3-49" id="h24-3-49" class="d">-                    4,
</a><a href="#h24-3-50" id="h24-3-50" class="d">-                    None,
</a><a href="#h24-3-51" id="h24-3-51" class="d">-                ),
</a><a href="#h24-3-52" id="h24-3-52" class="i">+            Field(
</a><a href="#h24-3-53" id="h24-3-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -184,66 +184,58 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h25-0-3" id="h25-0-3" class="i">+                labels: [
</a><a href="#h25-0-4" id="h25-0-4" class="i">+                    None,
</a><a href="#h25-0-5" id="h25-0-5" class="i">+                    None,
</a><a href="#h25-0-6" id="h25-0-6" class="i">+                    None,
</a><a href="#h25-0-7" id="h25-0-7" class="i">+                    None,
</a><a href="#h25-0-8" id="h25-0-8" class="i">+                    None,
</a><a href="#h25-0-9" id="h25-0-9" class="i">+                ],
</a>                 expressions: [
<a href="#h25-0-11" id="h25-0-11" class="d">-                    (
</a><a href="#h25-0-12" id="h25-0-12" class="d">-                        Field(
</a><a href="#h25-0-13" id="h25-0-13" class="d">-                            0,
</a><a href="#h25-0-14" id="h25-0-14" class="d">-                            Some(
</a><a href="#h25-0-15" id="h25-0-15" class="d">-                                (
</a><a href="#h25-0-16" id="h25-0-16" class="d">-                                    None,
</a><a href="#h25-0-17" id="h25-0-17" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-0-18" id="h25-0-18" class="d">-                                ),
</a><a href="#h25-0-19" id="h25-0-19" class="i">+                    Field(
</a><a href="#h25-0-20" id="h25-0-20" class="i">+                        0,
</a><a href="#h25-0-21" id="h25-0-21" class="i">+                        Some(
</a><a href="#h25-0-22" id="h25-0-22" class="i">+                            (
</a><a href="#h25-0-23" id="h25-0-23" class="i">+                                None,
</a><a href="#h25-0-24" id="h25-0-24" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-0-27" id="h25-0-27" class="d">-                        None,
</a>                     ),
<a href="#h25-0-29" id="h25-0-29" class="d">-                    (
</a><a href="#h25-0-30" id="h25-0-30" class="d">-                        Field(
</a><a href="#h25-0-31" id="h25-0-31" class="d">-                            0,
</a><a href="#h25-0-32" id="h25-0-32" class="d">-                            Some(
</a><a href="#h25-0-33" id="h25-0-33" class="d">-                                (
</a><a href="#h25-0-34" id="h25-0-34" class="d">-                                    None,
</a><a href="#h25-0-35" id="h25-0-35" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-0-36" id="h25-0-36" class="d">-                                ),
</a><a href="#h25-0-37" id="h25-0-37" class="i">+                    Field(
</a><a href="#h25-0-38" id="h25-0-38" class="i">+                        0,
</a><a href="#h25-0-39" id="h25-0-39" class="i">+                        Some(
</a><a href="#h25-0-40" id="h25-0-40" class="i">+                            (
</a><a href="#h25-0-41" id="h25-0-41" class="i">+                                None,
</a><a href="#h25-0-42" id="h25-0-42" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-0-45" id="h25-0-45" class="d">-                        None,
</a>                     ),
<a href="#h25-0-47" id="h25-0-47" class="d">-                    (
</a><a href="#h25-0-48" id="h25-0-48" class="d">-                        Field(
</a><a href="#h25-0-49" id="h25-0-49" class="d">-                            0,
</a><a href="#h25-0-50" id="h25-0-50" class="d">-                            Some(
</a><a href="#h25-0-51" id="h25-0-51" class="d">-                                (
</a><a href="#h25-0-52" id="h25-0-52" class="d">-                                    None,
</a><a href="#h25-0-53" id="h25-0-53" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-0-54" id="h25-0-54" class="d">-                                ),
</a><a href="#h25-0-55" id="h25-0-55" class="i">+                    Field(
</a><a href="#h25-0-56" id="h25-0-56" class="i">+                        0,
</a><a href="#h25-0-57" id="h25-0-57" class="i">+                        Some(
</a><a href="#h25-0-58" id="h25-0-58" class="i">+                            (
</a><a href="#h25-0-59" id="h25-0-59" class="i">+                                None,
</a><a href="#h25-0-60" id="h25-0-60" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-0-63" id="h25-0-63" class="d">-                        None,
</a>                     ),
<a href="#h25-0-65" id="h25-0-65" class="d">-                    (
</a><a href="#h25-0-66" id="h25-0-66" class="d">-                        Field(
</a><a href="#h25-0-67" id="h25-0-67" class="d">-                            0,
</a><a href="#h25-0-68" id="h25-0-68" class="d">-                            Some(
</a><a href="#h25-0-69" id="h25-0-69" class="d">-                                (
</a><a href="#h25-0-70" id="h25-0-70" class="d">-                                    None,
</a><a href="#h25-0-71" id="h25-0-71" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-0-72" id="h25-0-72" class="d">-                                ),
</a><a href="#h25-0-73" id="h25-0-73" class="i">+                    Field(
</a><a href="#h25-0-74" id="h25-0-74" class="i">+                        0,
</a><a href="#h25-0-75" id="h25-0-75" class="i">+                        Some(
</a><a href="#h25-0-76" id="h25-0-76" class="i">+                            (
</a><a href="#h25-0-77" id="h25-0-77" class="i">+                                None,
</a><a href="#h25-0-78" id="h25-0-78" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-0-81" id="h25-0-81" class="d">-                        None,
</a>                     ),
<a href="#h25-0-83" id="h25-0-83" class="d">-                    (
</a><a href="#h25-0-84" id="h25-0-84" class="d">-                        Field(
</a><a href="#h25-0-85" id="h25-0-85" class="d">-                            0,
</a><a href="#h25-0-86" id="h25-0-86" class="d">-                            Some(
</a><a href="#h25-0-87" id="h25-0-87" class="d">-                                (
</a><a href="#h25-0-88" id="h25-0-88" class="d">-                                    None,
</a><a href="#h25-0-89" id="h25-0-89" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-0-90" id="h25-0-90" class="d">-                                ),
</a><a href="#h25-0-91" id="h25-0-91" class="i">+                    Field(
</a><a href="#h25-0-92" id="h25-0-92" class="i">+                        0,
</a><a href="#h25-0-93" id="h25-0-93" class="i">+                        Some(
</a><a href="#h25-0-94" id="h25-0-94" class="i">+                            (
</a><a href="#h25-0-95" id="h25-0-95" class="i">+                                None,
</a><a href="#h25-0-96" id="h25-0-96" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-0-99" id="h25-0-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h25-1" id="h25-1" class="h">@@ -255,40 +247,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h25-1-3" id="h25-1-3" class="i">+        labels: [
</a><a href="#h25-1-4" id="h25-1-4" class="i">+            None,
</a><a href="#h25-1-5" id="h25-1-5" class="i">+            None,
</a><a href="#h25-1-6" id="h25-1-6" class="i">+            None,
</a><a href="#h25-1-7" id="h25-1-7" class="i">+            None,
</a><a href="#h25-1-8" id="h25-1-8" class="i">+            None,
</a><a href="#h25-1-9" id="h25-1-9" class="i">+        ],
</a>         expressions: [
<a href="#h25-1-11" id="h25-1-11" class="d">-            (
</a><a href="#h25-1-12" id="h25-1-12" class="d">-                Field(
</a><a href="#h25-1-13" id="h25-1-13" class="d">-                    0,
</a><a href="#h25-1-14" id="h25-1-14" class="d">-                    None,
</a><a href="#h25-1-15" id="h25-1-15" class="d">-                ),
</a><a href="#h25-1-16" id="h25-1-16" class="i">+            Field(
</a><a href="#h25-1-17" id="h25-1-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h25-1-20" id="h25-1-20" class="d">-            (
</a><a href="#h25-1-21" id="h25-1-21" class="d">-                Field(
</a><a href="#h25-1-22" id="h25-1-22" class="d">-                    1,
</a><a href="#h25-1-23" id="h25-1-23" class="d">-                    None,
</a><a href="#h25-1-24" id="h25-1-24" class="d">-                ),
</a><a href="#h25-1-25" id="h25-1-25" class="i">+            Field(
</a><a href="#h25-1-26" id="h25-1-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h25-1-29" id="h25-1-29" class="d">-            (
</a><a href="#h25-1-30" id="h25-1-30" class="d">-                Field(
</a><a href="#h25-1-31" id="h25-1-31" class="d">-                    2,
</a><a href="#h25-1-32" id="h25-1-32" class="d">-                    None,
</a><a href="#h25-1-33" id="h25-1-33" class="d">-                ),
</a><a href="#h25-1-34" id="h25-1-34" class="i">+            Field(
</a><a href="#h25-1-35" id="h25-1-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h25-1-38" id="h25-1-38" class="d">-            (
</a><a href="#h25-1-39" id="h25-1-39" class="d">-                Field(
</a><a href="#h25-1-40" id="h25-1-40" class="d">-                    3,
</a><a href="#h25-1-41" id="h25-1-41" class="d">-                    None,
</a><a href="#h25-1-42" id="h25-1-42" class="d">-                ),
</a><a href="#h25-1-43" id="h25-1-43" class="i">+            Field(
</a><a href="#h25-1-44" id="h25-1-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h25-1-47" id="h25-1-47" class="d">-            (
</a><a href="#h25-1-48" id="h25-1-48" class="d">-                Field(
</a><a href="#h25-1-49" id="h25-1-49" class="d">-                    4,
</a><a href="#h25-1-50" id="h25-1-50" class="d">-                    None,
</a><a href="#h25-1-51" id="h25-1-51" class="d">-                ),
</a><a href="#h25-1-52" id="h25-1-52" class="i">+            Field(
</a><a href="#h25-1-53" id="h25-1-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h25-2" id="h25-2" class="h">@@ -386,66 +370,58 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h25-2-3" id="h25-2-3" class="i">+                labels: [
</a><a href="#h25-2-4" id="h25-2-4" class="i">+                    None,
</a><a href="#h25-2-5" id="h25-2-5" class="i">+                    None,
</a><a href="#h25-2-6" id="h25-2-6" class="i">+                    None,
</a><a href="#h25-2-7" id="h25-2-7" class="i">+                    None,
</a><a href="#h25-2-8" id="h25-2-8" class="i">+                    None,
</a><a href="#h25-2-9" id="h25-2-9" class="i">+                ],
</a>                 expressions: [
<a href="#h25-2-11" id="h25-2-11" class="d">-                    (
</a><a href="#h25-2-12" id="h25-2-12" class="d">-                        Field(
</a><a href="#h25-2-13" id="h25-2-13" class="d">-                            0,
</a><a href="#h25-2-14" id="h25-2-14" class="d">-                            Some(
</a><a href="#h25-2-15" id="h25-2-15" class="d">-                                (
</a><a href="#h25-2-16" id="h25-2-16" class="d">-                                    None,
</a><a href="#h25-2-17" id="h25-2-17" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-2-18" id="h25-2-18" class="d">-                                ),
</a><a href="#h25-2-19" id="h25-2-19" class="i">+                    Field(
</a><a href="#h25-2-20" id="h25-2-20" class="i">+                        0,
</a><a href="#h25-2-21" id="h25-2-21" class="i">+                        Some(
</a><a href="#h25-2-22" id="h25-2-22" class="i">+                            (
</a><a href="#h25-2-23" id="h25-2-23" class="i">+                                None,
</a><a href="#h25-2-24" id="h25-2-24" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-2-27" id="h25-2-27" class="d">-                        None,
</a>                     ),
<a href="#h25-2-29" id="h25-2-29" class="d">-                    (
</a><a href="#h25-2-30" id="h25-2-30" class="d">-                        Field(
</a><a href="#h25-2-31" id="h25-2-31" class="d">-                            0,
</a><a href="#h25-2-32" id="h25-2-32" class="d">-                            Some(
</a><a href="#h25-2-33" id="h25-2-33" class="d">-                                (
</a><a href="#h25-2-34" id="h25-2-34" class="d">-                                    None,
</a><a href="#h25-2-35" id="h25-2-35" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-2-36" id="h25-2-36" class="d">-                                ),
</a><a href="#h25-2-37" id="h25-2-37" class="i">+                    Field(
</a><a href="#h25-2-38" id="h25-2-38" class="i">+                        0,
</a><a href="#h25-2-39" id="h25-2-39" class="i">+                        Some(
</a><a href="#h25-2-40" id="h25-2-40" class="i">+                            (
</a><a href="#h25-2-41" id="h25-2-41" class="i">+                                None,
</a><a href="#h25-2-42" id="h25-2-42" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-2-45" id="h25-2-45" class="d">-                        None,
</a>                     ),
<a href="#h25-2-47" id="h25-2-47" class="d">-                    (
</a><a href="#h25-2-48" id="h25-2-48" class="d">-                        Field(
</a><a href="#h25-2-49" id="h25-2-49" class="d">-                            0,
</a><a href="#h25-2-50" id="h25-2-50" class="d">-                            Some(
</a><a href="#h25-2-51" id="h25-2-51" class="d">-                                (
</a><a href="#h25-2-52" id="h25-2-52" class="d">-                                    None,
</a><a href="#h25-2-53" id="h25-2-53" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-2-54" id="h25-2-54" class="d">-                                ),
</a><a href="#h25-2-55" id="h25-2-55" class="i">+                    Field(
</a><a href="#h25-2-56" id="h25-2-56" class="i">+                        0,
</a><a href="#h25-2-57" id="h25-2-57" class="i">+                        Some(
</a><a href="#h25-2-58" id="h25-2-58" class="i">+                            (
</a><a href="#h25-2-59" id="h25-2-59" class="i">+                                None,
</a><a href="#h25-2-60" id="h25-2-60" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-2-63" id="h25-2-63" class="d">-                        None,
</a>                     ),
<a href="#h25-2-65" id="h25-2-65" class="d">-                    (
</a><a href="#h25-2-66" id="h25-2-66" class="d">-                        Field(
</a><a href="#h25-2-67" id="h25-2-67" class="d">-                            0,
</a><a href="#h25-2-68" id="h25-2-68" class="d">-                            Some(
</a><a href="#h25-2-69" id="h25-2-69" class="d">-                                (
</a><a href="#h25-2-70" id="h25-2-70" class="d">-                                    None,
</a><a href="#h25-2-71" id="h25-2-71" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-2-72" id="h25-2-72" class="d">-                                ),
</a><a href="#h25-2-73" id="h25-2-73" class="i">+                    Field(
</a><a href="#h25-2-74" id="h25-2-74" class="i">+                        0,
</a><a href="#h25-2-75" id="h25-2-75" class="i">+                        Some(
</a><a href="#h25-2-76" id="h25-2-76" class="i">+                            (
</a><a href="#h25-2-77" id="h25-2-77" class="i">+                                None,
</a><a href="#h25-2-78" id="h25-2-78" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-2-81" id="h25-2-81" class="d">-                        None,
</a>                     ),
<a href="#h25-2-83" id="h25-2-83" class="d">-                    (
</a><a href="#h25-2-84" id="h25-2-84" class="d">-                        Field(
</a><a href="#h25-2-85" id="h25-2-85" class="d">-                            0,
</a><a href="#h25-2-86" id="h25-2-86" class="d">-                            Some(
</a><a href="#h25-2-87" id="h25-2-87" class="d">-                                (
</a><a href="#h25-2-88" id="h25-2-88" class="d">-                                    None,
</a><a href="#h25-2-89" id="h25-2-89" class="d">-                                    &quot;id&quot;,
</a><a href="#h25-2-90" id="h25-2-90" class="d">-                                ),
</a><a href="#h25-2-91" id="h25-2-91" class="i">+                    Field(
</a><a href="#h25-2-92" id="h25-2-92" class="i">+                        0,
</a><a href="#h25-2-93" id="h25-2-93" class="i">+                        Some(
</a><a href="#h25-2-94" id="h25-2-94" class="i">+                            (
</a><a href="#h25-2-95" id="h25-2-95" class="i">+                                None,
</a><a href="#h25-2-96" id="h25-2-96" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h25-2-99" id="h25-2-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h25-3" id="h25-3" class="h">@@ -457,40 +433,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h25-3-3" id="h25-3-3" class="i">+        labels: [
</a><a href="#h25-3-4" id="h25-3-4" class="i">+            None,
</a><a href="#h25-3-5" id="h25-3-5" class="i">+            None,
</a><a href="#h25-3-6" id="h25-3-6" class="i">+            None,
</a><a href="#h25-3-7" id="h25-3-7" class="i">+            None,
</a><a href="#h25-3-8" id="h25-3-8" class="i">+            None,
</a><a href="#h25-3-9" id="h25-3-9" class="i">+        ],
</a>         expressions: [
<a href="#h25-3-11" id="h25-3-11" class="d">-            (
</a><a href="#h25-3-12" id="h25-3-12" class="d">-                Field(
</a><a href="#h25-3-13" id="h25-3-13" class="d">-                    0,
</a><a href="#h25-3-14" id="h25-3-14" class="d">-                    None,
</a><a href="#h25-3-15" id="h25-3-15" class="d">-                ),
</a><a href="#h25-3-16" id="h25-3-16" class="i">+            Field(
</a><a href="#h25-3-17" id="h25-3-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h25-3-20" id="h25-3-20" class="d">-            (
</a><a href="#h25-3-21" id="h25-3-21" class="d">-                Field(
</a><a href="#h25-3-22" id="h25-3-22" class="d">-                    1,
</a><a href="#h25-3-23" id="h25-3-23" class="d">-                    None,
</a><a href="#h25-3-24" id="h25-3-24" class="d">-                ),
</a><a href="#h25-3-25" id="h25-3-25" class="i">+            Field(
</a><a href="#h25-3-26" id="h25-3-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h25-3-29" id="h25-3-29" class="d">-            (
</a><a href="#h25-3-30" id="h25-3-30" class="d">-                Field(
</a><a href="#h25-3-31" id="h25-3-31" class="d">-                    2,
</a><a href="#h25-3-32" id="h25-3-32" class="d">-                    None,
</a><a href="#h25-3-33" id="h25-3-33" class="d">-                ),
</a><a href="#h25-3-34" id="h25-3-34" class="i">+            Field(
</a><a href="#h25-3-35" id="h25-3-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h25-3-38" id="h25-3-38" class="d">-            (
</a><a href="#h25-3-39" id="h25-3-39" class="d">-                Field(
</a><a href="#h25-3-40" id="h25-3-40" class="d">-                    3,
</a><a href="#h25-3-41" id="h25-3-41" class="d">-                    None,
</a><a href="#h25-3-42" id="h25-3-42" class="d">-                ),
</a><a href="#h25-3-43" id="h25-3-43" class="i">+            Field(
</a><a href="#h25-3-44" id="h25-3-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h25-3-47" id="h25-3-47" class="d">-            (
</a><a href="#h25-3-48" id="h25-3-48" class="d">-                Field(
</a><a href="#h25-3-49" id="h25-3-49" class="d">-                    4,
</a><a href="#h25-3-50" id="h25-3-50" class="d">-                    None,
</a><a href="#h25-3-51" id="h25-3-51" class="d">-                ),
</a><a href="#h25-3-52" id="h25-3-52" class="i">+            Field(
</a><a href="#h25-3-53" id="h25-3-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -188,78 +188,68 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h26-0-3" id="h26-0-3" class="i">+                labels: [
</a><a href="#h26-0-4" id="h26-0-4" class="i">+                    None,
</a><a href="#h26-0-5" id="h26-0-5" class="i">+                    None,
</a><a href="#h26-0-6" id="h26-0-6" class="i">+                    None,
</a><a href="#h26-0-7" id="h26-0-7" class="i">+                    None,
</a><a href="#h26-0-8" id="h26-0-8" class="i">+                    None,
</a><a href="#h26-0-9" id="h26-0-9" class="i">+                    None,
</a><a href="#h26-0-10" id="h26-0-10" class="i">+                ],
</a>                 expressions: [
<a href="#h26-0-12" id="h26-0-12" class="d">-                    (
</a><a href="#h26-0-13" id="h26-0-13" class="d">-                        Field(
</a><a href="#h26-0-14" id="h26-0-14" class="d">-                            0,
</a><a href="#h26-0-15" id="h26-0-15" class="d">-                            Some(
</a><a href="#h26-0-16" id="h26-0-16" class="d">-                                (
</a><a href="#h26-0-17" id="h26-0-17" class="d">-                                    None,
</a><a href="#h26-0-18" id="h26-0-18" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-0-19" id="h26-0-19" class="d">-                                ),
</a><a href="#h26-0-20" id="h26-0-20" class="i">+                    Field(
</a><a href="#h26-0-21" id="h26-0-21" class="i">+                        0,
</a><a href="#h26-0-22" id="h26-0-22" class="i">+                        Some(
</a><a href="#h26-0-23" id="h26-0-23" class="i">+                            (
</a><a href="#h26-0-24" id="h26-0-24" class="i">+                                None,
</a><a href="#h26-0-25" id="h26-0-25" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-28" id="h26-0-28" class="d">-                        None,
</a>                     ),
<a href="#h26-0-30" id="h26-0-30" class="d">-                    (
</a><a href="#h26-0-31" id="h26-0-31" class="d">-                        Field(
</a><a href="#h26-0-32" id="h26-0-32" class="d">-                            0,
</a><a href="#h26-0-33" id="h26-0-33" class="d">-                            Some(
</a><a href="#h26-0-34" id="h26-0-34" class="d">-                                (
</a><a href="#h26-0-35" id="h26-0-35" class="d">-                                    None,
</a><a href="#h26-0-36" id="h26-0-36" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-0-37" id="h26-0-37" class="d">-                                ),
</a><a href="#h26-0-38" id="h26-0-38" class="i">+                    Field(
</a><a href="#h26-0-39" id="h26-0-39" class="i">+                        0,
</a><a href="#h26-0-40" id="h26-0-40" class="i">+                        Some(
</a><a href="#h26-0-41" id="h26-0-41" class="i">+                            (
</a><a href="#h26-0-42" id="h26-0-42" class="i">+                                None,
</a><a href="#h26-0-43" id="h26-0-43" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-46" id="h26-0-46" class="d">-                        None,
</a>                     ),
<a href="#h26-0-48" id="h26-0-48" class="d">-                    (
</a><a href="#h26-0-49" id="h26-0-49" class="d">-                        Field(
</a><a href="#h26-0-50" id="h26-0-50" class="d">-                            0,
</a><a href="#h26-0-51" id="h26-0-51" class="d">-                            Some(
</a><a href="#h26-0-52" id="h26-0-52" class="d">-                                (
</a><a href="#h26-0-53" id="h26-0-53" class="d">-                                    None,
</a><a href="#h26-0-54" id="h26-0-54" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-0-55" id="h26-0-55" class="d">-                                ),
</a><a href="#h26-0-56" id="h26-0-56" class="i">+                    Field(
</a><a href="#h26-0-57" id="h26-0-57" class="i">+                        0,
</a><a href="#h26-0-58" id="h26-0-58" class="i">+                        Some(
</a><a href="#h26-0-59" id="h26-0-59" class="i">+                            (
</a><a href="#h26-0-60" id="h26-0-60" class="i">+                                None,
</a><a href="#h26-0-61" id="h26-0-61" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-64" id="h26-0-64" class="d">-                        None,
</a>                     ),
<a href="#h26-0-66" id="h26-0-66" class="d">-                    (
</a><a href="#h26-0-67" id="h26-0-67" class="d">-                        Field(
</a><a href="#h26-0-68" id="h26-0-68" class="d">-                            0,
</a><a href="#h26-0-69" id="h26-0-69" class="d">-                            Some(
</a><a href="#h26-0-70" id="h26-0-70" class="d">-                                (
</a><a href="#h26-0-71" id="h26-0-71" class="d">-                                    None,
</a><a href="#h26-0-72" id="h26-0-72" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-0-73" id="h26-0-73" class="d">-                                ),
</a><a href="#h26-0-74" id="h26-0-74" class="i">+                    Field(
</a><a href="#h26-0-75" id="h26-0-75" class="i">+                        0,
</a><a href="#h26-0-76" id="h26-0-76" class="i">+                        Some(
</a><a href="#h26-0-77" id="h26-0-77" class="i">+                            (
</a><a href="#h26-0-78" id="h26-0-78" class="i">+                                None,
</a><a href="#h26-0-79" id="h26-0-79" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-82" id="h26-0-82" class="d">-                        None,
</a>                     ),
<a href="#h26-0-84" id="h26-0-84" class="d">-                    (
</a><a href="#h26-0-85" id="h26-0-85" class="d">-                        Field(
</a><a href="#h26-0-86" id="h26-0-86" class="d">-                            0,
</a><a href="#h26-0-87" id="h26-0-87" class="d">-                            Some(
</a><a href="#h26-0-88" id="h26-0-88" class="d">-                                (
</a><a href="#h26-0-89" id="h26-0-89" class="d">-                                    None,
</a><a href="#h26-0-90" id="h26-0-90" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-0-91" id="h26-0-91" class="d">-                                ),
</a><a href="#h26-0-92" id="h26-0-92" class="i">+                    Field(
</a><a href="#h26-0-93" id="h26-0-93" class="i">+                        0,
</a><a href="#h26-0-94" id="h26-0-94" class="i">+                        Some(
</a><a href="#h26-0-95" id="h26-0-95" class="i">+                            (
</a><a href="#h26-0-96" id="h26-0-96" class="i">+                                None,
</a><a href="#h26-0-97" id="h26-0-97" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-100" id="h26-0-100" class="d">-                        None,
</a>                     ),
<a href="#h26-0-102" id="h26-0-102" class="d">-                    (
</a><a href="#h26-0-103" id="h26-0-103" class="d">-                        Field(
</a><a href="#h26-0-104" id="h26-0-104" class="d">-                            0,
</a><a href="#h26-0-105" id="h26-0-105" class="d">-                            Some(
</a><a href="#h26-0-106" id="h26-0-106" class="d">-                                (
</a><a href="#h26-0-107" id="h26-0-107" class="d">-                                    None,
</a><a href="#h26-0-108" id="h26-0-108" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-0-109" id="h26-0-109" class="d">-                                ),
</a><a href="#h26-0-110" id="h26-0-110" class="i">+                    Field(
</a><a href="#h26-0-111" id="h26-0-111" class="i">+                        0,
</a><a href="#h26-0-112" id="h26-0-112" class="i">+                        Some(
</a><a href="#h26-0-113" id="h26-0-113" class="i">+                            (
</a><a href="#h26-0-114" id="h26-0-114" class="i">+                                None,
</a><a href="#h26-0-115" id="h26-0-115" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-118" id="h26-0-118" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h26-1" id="h26-1" class="h">@@ -271,40 +261,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h26-1-3" id="h26-1-3" class="i">+        labels: [
</a><a href="#h26-1-4" id="h26-1-4" class="i">+            None,
</a><a href="#h26-1-5" id="h26-1-5" class="i">+            None,
</a><a href="#h26-1-6" id="h26-1-6" class="i">+            None,
</a><a href="#h26-1-7" id="h26-1-7" class="i">+            None,
</a><a href="#h26-1-8" id="h26-1-8" class="i">+            None,
</a><a href="#h26-1-9" id="h26-1-9" class="i">+        ],
</a>         expressions: [
<a href="#h26-1-11" id="h26-1-11" class="d">-            (
</a><a href="#h26-1-12" id="h26-1-12" class="d">-                Field(
</a><a href="#h26-1-13" id="h26-1-13" class="d">-                    0,
</a><a href="#h26-1-14" id="h26-1-14" class="d">-                    None,
</a><a href="#h26-1-15" id="h26-1-15" class="d">-                ),
</a><a href="#h26-1-16" id="h26-1-16" class="i">+            Field(
</a><a href="#h26-1-17" id="h26-1-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h26-1-20" id="h26-1-20" class="d">-            (
</a><a href="#h26-1-21" id="h26-1-21" class="d">-                Field(
</a><a href="#h26-1-22" id="h26-1-22" class="d">-                    1,
</a><a href="#h26-1-23" id="h26-1-23" class="d">-                    None,
</a><a href="#h26-1-24" id="h26-1-24" class="d">-                ),
</a><a href="#h26-1-25" id="h26-1-25" class="i">+            Field(
</a><a href="#h26-1-26" id="h26-1-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h26-1-29" id="h26-1-29" class="d">-            (
</a><a href="#h26-1-30" id="h26-1-30" class="d">-                Field(
</a><a href="#h26-1-31" id="h26-1-31" class="d">-                    2,
</a><a href="#h26-1-32" id="h26-1-32" class="d">-                    None,
</a><a href="#h26-1-33" id="h26-1-33" class="d">-                ),
</a><a href="#h26-1-34" id="h26-1-34" class="i">+            Field(
</a><a href="#h26-1-35" id="h26-1-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h26-1-38" id="h26-1-38" class="d">-            (
</a><a href="#h26-1-39" id="h26-1-39" class="d">-                Field(
</a><a href="#h26-1-40" id="h26-1-40" class="d">-                    3,
</a><a href="#h26-1-41" id="h26-1-41" class="d">-                    None,
</a><a href="#h26-1-42" id="h26-1-42" class="d">-                ),
</a><a href="#h26-1-43" id="h26-1-43" class="i">+            Field(
</a><a href="#h26-1-44" id="h26-1-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h26-1-47" id="h26-1-47" class="d">-            (
</a><a href="#h26-1-48" id="h26-1-48" class="d">-                Field(
</a><a href="#h26-1-49" id="h26-1-49" class="d">-                    4,
</a><a href="#h26-1-50" id="h26-1-50" class="d">-                    None,
</a><a href="#h26-1-51" id="h26-1-51" class="d">-                ),
</a><a href="#h26-1-52" id="h26-1-52" class="i">+            Field(
</a><a href="#h26-1-53" id="h26-1-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h26-2" id="h26-2" class="h">@@ -402,78 +384,68 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h26-2-3" id="h26-2-3" class="i">+                labels: [
</a><a href="#h26-2-4" id="h26-2-4" class="i">+                    None,
</a><a href="#h26-2-5" id="h26-2-5" class="i">+                    None,
</a><a href="#h26-2-6" id="h26-2-6" class="i">+                    None,
</a><a href="#h26-2-7" id="h26-2-7" class="i">+                    None,
</a><a href="#h26-2-8" id="h26-2-8" class="i">+                    None,
</a><a href="#h26-2-9" id="h26-2-9" class="i">+                    None,
</a><a href="#h26-2-10" id="h26-2-10" class="i">+                ],
</a>                 expressions: [
<a href="#h26-2-12" id="h26-2-12" class="d">-                    (
</a><a href="#h26-2-13" id="h26-2-13" class="d">-                        Field(
</a><a href="#h26-2-14" id="h26-2-14" class="d">-                            0,
</a><a href="#h26-2-15" id="h26-2-15" class="d">-                            Some(
</a><a href="#h26-2-16" id="h26-2-16" class="d">-                                (
</a><a href="#h26-2-17" id="h26-2-17" class="d">-                                    None,
</a><a href="#h26-2-18" id="h26-2-18" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-2-19" id="h26-2-19" class="d">-                                ),
</a><a href="#h26-2-20" id="h26-2-20" class="i">+                    Field(
</a><a href="#h26-2-21" id="h26-2-21" class="i">+                        0,
</a><a href="#h26-2-22" id="h26-2-22" class="i">+                        Some(
</a><a href="#h26-2-23" id="h26-2-23" class="i">+                            (
</a><a href="#h26-2-24" id="h26-2-24" class="i">+                                None,
</a><a href="#h26-2-25" id="h26-2-25" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-2-28" id="h26-2-28" class="d">-                        None,
</a>                     ),
<a href="#h26-2-30" id="h26-2-30" class="d">-                    (
</a><a href="#h26-2-31" id="h26-2-31" class="d">-                        Field(
</a><a href="#h26-2-32" id="h26-2-32" class="d">-                            0,
</a><a href="#h26-2-33" id="h26-2-33" class="d">-                            Some(
</a><a href="#h26-2-34" id="h26-2-34" class="d">-                                (
</a><a href="#h26-2-35" id="h26-2-35" class="d">-                                    None,
</a><a href="#h26-2-36" id="h26-2-36" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-2-37" id="h26-2-37" class="d">-                                ),
</a><a href="#h26-2-38" id="h26-2-38" class="i">+                    Field(
</a><a href="#h26-2-39" id="h26-2-39" class="i">+                        0,
</a><a href="#h26-2-40" id="h26-2-40" class="i">+                        Some(
</a><a href="#h26-2-41" id="h26-2-41" class="i">+                            (
</a><a href="#h26-2-42" id="h26-2-42" class="i">+                                None,
</a><a href="#h26-2-43" id="h26-2-43" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-2-46" id="h26-2-46" class="d">-                        None,
</a>                     ),
<a href="#h26-2-48" id="h26-2-48" class="d">-                    (
</a><a href="#h26-2-49" id="h26-2-49" class="d">-                        Field(
</a><a href="#h26-2-50" id="h26-2-50" class="d">-                            0,
</a><a href="#h26-2-51" id="h26-2-51" class="d">-                            Some(
</a><a href="#h26-2-52" id="h26-2-52" class="d">-                                (
</a><a href="#h26-2-53" id="h26-2-53" class="d">-                                    None,
</a><a href="#h26-2-54" id="h26-2-54" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-2-55" id="h26-2-55" class="d">-                                ),
</a><a href="#h26-2-56" id="h26-2-56" class="i">+                    Field(
</a><a href="#h26-2-57" id="h26-2-57" class="i">+                        0,
</a><a href="#h26-2-58" id="h26-2-58" class="i">+                        Some(
</a><a href="#h26-2-59" id="h26-2-59" class="i">+                            (
</a><a href="#h26-2-60" id="h26-2-60" class="i">+                                None,
</a><a href="#h26-2-61" id="h26-2-61" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-2-64" id="h26-2-64" class="d">-                        None,
</a>                     ),
<a href="#h26-2-66" id="h26-2-66" class="d">-                    (
</a><a href="#h26-2-67" id="h26-2-67" class="d">-                        Field(
</a><a href="#h26-2-68" id="h26-2-68" class="d">-                            0,
</a><a href="#h26-2-69" id="h26-2-69" class="d">-                            Some(
</a><a href="#h26-2-70" id="h26-2-70" class="d">-                                (
</a><a href="#h26-2-71" id="h26-2-71" class="d">-                                    None,
</a><a href="#h26-2-72" id="h26-2-72" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-2-73" id="h26-2-73" class="d">-                                ),
</a><a href="#h26-2-74" id="h26-2-74" class="i">+                    Field(
</a><a href="#h26-2-75" id="h26-2-75" class="i">+                        0,
</a><a href="#h26-2-76" id="h26-2-76" class="i">+                        Some(
</a><a href="#h26-2-77" id="h26-2-77" class="i">+                            (
</a><a href="#h26-2-78" id="h26-2-78" class="i">+                                None,
</a><a href="#h26-2-79" id="h26-2-79" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-2-82" id="h26-2-82" class="d">-                        None,
</a>                     ),
<a href="#h26-2-84" id="h26-2-84" class="d">-                    (
</a><a href="#h26-2-85" id="h26-2-85" class="d">-                        Field(
</a><a href="#h26-2-86" id="h26-2-86" class="d">-                            0,
</a><a href="#h26-2-87" id="h26-2-87" class="d">-                            Some(
</a><a href="#h26-2-88" id="h26-2-88" class="d">-                                (
</a><a href="#h26-2-89" id="h26-2-89" class="d">-                                    None,
</a><a href="#h26-2-90" id="h26-2-90" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-2-91" id="h26-2-91" class="d">-                                ),
</a><a href="#h26-2-92" id="h26-2-92" class="i">+                    Field(
</a><a href="#h26-2-93" id="h26-2-93" class="i">+                        0,
</a><a href="#h26-2-94" id="h26-2-94" class="i">+                        Some(
</a><a href="#h26-2-95" id="h26-2-95" class="i">+                            (
</a><a href="#h26-2-96" id="h26-2-96" class="i">+                                None,
</a><a href="#h26-2-97" id="h26-2-97" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-2-100" id="h26-2-100" class="d">-                        None,
</a>                     ),
<a href="#h26-2-102" id="h26-2-102" class="d">-                    (
</a><a href="#h26-2-103" id="h26-2-103" class="d">-                        Field(
</a><a href="#h26-2-104" id="h26-2-104" class="d">-                            0,
</a><a href="#h26-2-105" id="h26-2-105" class="d">-                            Some(
</a><a href="#h26-2-106" id="h26-2-106" class="d">-                                (
</a><a href="#h26-2-107" id="h26-2-107" class="d">-                                    None,
</a><a href="#h26-2-108" id="h26-2-108" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-2-109" id="h26-2-109" class="d">-                                ),
</a><a href="#h26-2-110" id="h26-2-110" class="i">+                    Field(
</a><a href="#h26-2-111" id="h26-2-111" class="i">+                        0,
</a><a href="#h26-2-112" id="h26-2-112" class="i">+                        Some(
</a><a href="#h26-2-113" id="h26-2-113" class="i">+                            (
</a><a href="#h26-2-114" id="h26-2-114" class="i">+                                None,
</a><a href="#h26-2-115" id="h26-2-115" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-2-118" id="h26-2-118" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h26-3" id="h26-3" class="h">@@ -485,40 +457,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h26-3-3" id="h26-3-3" class="i">+        labels: [
</a><a href="#h26-3-4" id="h26-3-4" class="i">+            None,
</a><a href="#h26-3-5" id="h26-3-5" class="i">+            None,
</a><a href="#h26-3-6" id="h26-3-6" class="i">+            None,
</a><a href="#h26-3-7" id="h26-3-7" class="i">+            None,
</a><a href="#h26-3-8" id="h26-3-8" class="i">+            None,
</a><a href="#h26-3-9" id="h26-3-9" class="i">+        ],
</a>         expressions: [
<a href="#h26-3-11" id="h26-3-11" class="d">-            (
</a><a href="#h26-3-12" id="h26-3-12" class="d">-                Field(
</a><a href="#h26-3-13" id="h26-3-13" class="d">-                    0,
</a><a href="#h26-3-14" id="h26-3-14" class="d">-                    None,
</a><a href="#h26-3-15" id="h26-3-15" class="d">-                ),
</a><a href="#h26-3-16" id="h26-3-16" class="i">+            Field(
</a><a href="#h26-3-17" id="h26-3-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h26-3-20" id="h26-3-20" class="d">-            (
</a><a href="#h26-3-21" id="h26-3-21" class="d">-                Field(
</a><a href="#h26-3-22" id="h26-3-22" class="d">-                    1,
</a><a href="#h26-3-23" id="h26-3-23" class="d">-                    None,
</a><a href="#h26-3-24" id="h26-3-24" class="d">-                ),
</a><a href="#h26-3-25" id="h26-3-25" class="i">+            Field(
</a><a href="#h26-3-26" id="h26-3-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h26-3-29" id="h26-3-29" class="d">-            (
</a><a href="#h26-3-30" id="h26-3-30" class="d">-                Field(
</a><a href="#h26-3-31" id="h26-3-31" class="d">-                    2,
</a><a href="#h26-3-32" id="h26-3-32" class="d">-                    None,
</a><a href="#h26-3-33" id="h26-3-33" class="d">-                ),
</a><a href="#h26-3-34" id="h26-3-34" class="i">+            Field(
</a><a href="#h26-3-35" id="h26-3-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h26-3-38" id="h26-3-38" class="d">-            (
</a><a href="#h26-3-39" id="h26-3-39" class="d">-                Field(
</a><a href="#h26-3-40" id="h26-3-40" class="d">-                    3,
</a><a href="#h26-3-41" id="h26-3-41" class="d">-                    None,
</a><a href="#h26-3-42" id="h26-3-42" class="d">-                ),
</a><a href="#h26-3-43" id="h26-3-43" class="i">+            Field(
</a><a href="#h26-3-44" id="h26-3-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h26-3-47" id="h26-3-47" class="d">-            (
</a><a href="#h26-3-48" id="h26-3-48" class="d">-                Field(
</a><a href="#h26-3-49" id="h26-3-49" class="d">-                    4,
</a><a href="#h26-3-50" id="h26-3-50" class="d">-                    None,
</a><a href="#h26-3-51" id="h26-3-51" class="d">-                ),
</a><a href="#h26-3-52" id="h26-3-52" class="i">+            Field(
</a><a href="#h26-3-53" id="h26-3-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a> b/<a href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -6,8 +6,7 @@ Projection: #0, #1, #2, #3, #4
</a>     Projection: s, s, s, s, s
        Scan: strings (NOT s IS NULL)
 
<a href="#h27-0-3" id="h27-0-3" class="d">-Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h27-0-4" id="h27-0-4" class="d">-[String(&quot;A&quot;), String(&quot;a&quot;), Null, Integer(7), Null]
</a><a href="#h27-0-5" id="h27-0-5" class="i">+Error: invalid input: can&#39;t add 0 and a
</a> 
 AST: Select {
     select: [
<a href="#h27-1" id="h27-1" class="h">@@ -148,66 +147,58 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h27-1-3" id="h27-1-3" class="i">+                labels: [
</a><a href="#h27-1-4" id="h27-1-4" class="i">+                    None,
</a><a href="#h27-1-5" id="h27-1-5" class="i">+                    None,
</a><a href="#h27-1-6" id="h27-1-6" class="i">+                    None,
</a><a href="#h27-1-7" id="h27-1-7" class="i">+                    None,
</a><a href="#h27-1-8" id="h27-1-8" class="i">+                    None,
</a><a href="#h27-1-9" id="h27-1-9" class="i">+                ],
</a>                 expressions: [
<a href="#h27-1-11" id="h27-1-11" class="d">-                    (
</a><a href="#h27-1-12" id="h27-1-12" class="d">-                        Field(
</a><a href="#h27-1-13" id="h27-1-13" class="d">-                            1,
</a><a href="#h27-1-14" id="h27-1-14" class="d">-                            Some(
</a><a href="#h27-1-15" id="h27-1-15" class="d">-                                (
</a><a href="#h27-1-16" id="h27-1-16" class="d">-                                    None,
</a><a href="#h27-1-17" id="h27-1-17" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-1-18" id="h27-1-18" class="d">-                                ),
</a><a href="#h27-1-19" id="h27-1-19" class="i">+                    Field(
</a><a href="#h27-1-20" id="h27-1-20" class="i">+                        1,
</a><a href="#h27-1-21" id="h27-1-21" class="i">+                        Some(
</a><a href="#h27-1-22" id="h27-1-22" class="i">+                            (
</a><a href="#h27-1-23" id="h27-1-23" class="i">+                                None,
</a><a href="#h27-1-24" id="h27-1-24" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-1-27" id="h27-1-27" class="d">-                        None,
</a>                     ),
<a href="#h27-1-29" id="h27-1-29" class="d">-                    (
</a><a href="#h27-1-30" id="h27-1-30" class="d">-                        Field(
</a><a href="#h27-1-31" id="h27-1-31" class="d">-                            1,
</a><a href="#h27-1-32" id="h27-1-32" class="d">-                            Some(
</a><a href="#h27-1-33" id="h27-1-33" class="d">-                                (
</a><a href="#h27-1-34" id="h27-1-34" class="d">-                                    None,
</a><a href="#h27-1-35" id="h27-1-35" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-1-36" id="h27-1-36" class="d">-                                ),
</a><a href="#h27-1-37" id="h27-1-37" class="i">+                    Field(
</a><a href="#h27-1-38" id="h27-1-38" class="i">+                        1,
</a><a href="#h27-1-39" id="h27-1-39" class="i">+                        Some(
</a><a href="#h27-1-40" id="h27-1-40" class="i">+                            (
</a><a href="#h27-1-41" id="h27-1-41" class="i">+                                None,
</a><a href="#h27-1-42" id="h27-1-42" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-1-45" id="h27-1-45" class="d">-                        None,
</a>                     ),
<a href="#h27-1-47" id="h27-1-47" class="d">-                    (
</a><a href="#h27-1-48" id="h27-1-48" class="d">-                        Field(
</a><a href="#h27-1-49" id="h27-1-49" class="d">-                            1,
</a><a href="#h27-1-50" id="h27-1-50" class="d">-                            Some(
</a><a href="#h27-1-51" id="h27-1-51" class="d">-                                (
</a><a href="#h27-1-52" id="h27-1-52" class="d">-                                    None,
</a><a href="#h27-1-53" id="h27-1-53" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-1-54" id="h27-1-54" class="d">-                                ),
</a><a href="#h27-1-55" id="h27-1-55" class="i">+                    Field(
</a><a href="#h27-1-56" id="h27-1-56" class="i">+                        1,
</a><a href="#h27-1-57" id="h27-1-57" class="i">+                        Some(
</a><a href="#h27-1-58" id="h27-1-58" class="i">+                            (
</a><a href="#h27-1-59" id="h27-1-59" class="i">+                                None,
</a><a href="#h27-1-60" id="h27-1-60" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-1-63" id="h27-1-63" class="d">-                        None,
</a>                     ),
<a href="#h27-1-65" id="h27-1-65" class="d">-                    (
</a><a href="#h27-1-66" id="h27-1-66" class="d">-                        Field(
</a><a href="#h27-1-67" id="h27-1-67" class="d">-                            1,
</a><a href="#h27-1-68" id="h27-1-68" class="d">-                            Some(
</a><a href="#h27-1-69" id="h27-1-69" class="d">-                                (
</a><a href="#h27-1-70" id="h27-1-70" class="d">-                                    None,
</a><a href="#h27-1-71" id="h27-1-71" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-1-72" id="h27-1-72" class="d">-                                ),
</a><a href="#h27-1-73" id="h27-1-73" class="i">+                    Field(
</a><a href="#h27-1-74" id="h27-1-74" class="i">+                        1,
</a><a href="#h27-1-75" id="h27-1-75" class="i">+                        Some(
</a><a href="#h27-1-76" id="h27-1-76" class="i">+                            (
</a><a href="#h27-1-77" id="h27-1-77" class="i">+                                None,
</a><a href="#h27-1-78" id="h27-1-78" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-1-81" id="h27-1-81" class="d">-                        None,
</a>                     ),
<a href="#h27-1-83" id="h27-1-83" class="d">-                    (
</a><a href="#h27-1-84" id="h27-1-84" class="d">-                        Field(
</a><a href="#h27-1-85" id="h27-1-85" class="d">-                            1,
</a><a href="#h27-1-86" id="h27-1-86" class="d">-                            Some(
</a><a href="#h27-1-87" id="h27-1-87" class="d">-                                (
</a><a href="#h27-1-88" id="h27-1-88" class="d">-                                    None,
</a><a href="#h27-1-89" id="h27-1-89" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-1-90" id="h27-1-90" class="d">-                                ),
</a><a href="#h27-1-91" id="h27-1-91" class="i">+                    Field(
</a><a href="#h27-1-92" id="h27-1-92" class="i">+                        1,
</a><a href="#h27-1-93" id="h27-1-93" class="i">+                        Some(
</a><a href="#h27-1-94" id="h27-1-94" class="i">+                            (
</a><a href="#h27-1-95" id="h27-1-95" class="i">+                                None,
</a><a href="#h27-1-96" id="h27-1-96" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-1-99" id="h27-1-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h27-2" id="h27-2" class="h">@@ -219,40 +210,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h27-2-3" id="h27-2-3" class="i">+        labels: [
</a><a href="#h27-2-4" id="h27-2-4" class="i">+            None,
</a><a href="#h27-2-5" id="h27-2-5" class="i">+            None,
</a><a href="#h27-2-6" id="h27-2-6" class="i">+            None,
</a><a href="#h27-2-7" id="h27-2-7" class="i">+            None,
</a><a href="#h27-2-8" id="h27-2-8" class="i">+            None,
</a><a href="#h27-2-9" id="h27-2-9" class="i">+        ],
</a>         expressions: [
<a href="#h27-2-11" id="h27-2-11" class="d">-            (
</a><a href="#h27-2-12" id="h27-2-12" class="d">-                Field(
</a><a href="#h27-2-13" id="h27-2-13" class="d">-                    0,
</a><a href="#h27-2-14" id="h27-2-14" class="d">-                    None,
</a><a href="#h27-2-15" id="h27-2-15" class="d">-                ),
</a><a href="#h27-2-16" id="h27-2-16" class="i">+            Field(
</a><a href="#h27-2-17" id="h27-2-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h27-2-20" id="h27-2-20" class="d">-            (
</a><a href="#h27-2-21" id="h27-2-21" class="d">-                Field(
</a><a href="#h27-2-22" id="h27-2-22" class="d">-                    1,
</a><a href="#h27-2-23" id="h27-2-23" class="d">-                    None,
</a><a href="#h27-2-24" id="h27-2-24" class="d">-                ),
</a><a href="#h27-2-25" id="h27-2-25" class="i">+            Field(
</a><a href="#h27-2-26" id="h27-2-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h27-2-29" id="h27-2-29" class="d">-            (
</a><a href="#h27-2-30" id="h27-2-30" class="d">-                Field(
</a><a href="#h27-2-31" id="h27-2-31" class="d">-                    2,
</a><a href="#h27-2-32" id="h27-2-32" class="d">-                    None,
</a><a href="#h27-2-33" id="h27-2-33" class="d">-                ),
</a><a href="#h27-2-34" id="h27-2-34" class="i">+            Field(
</a><a href="#h27-2-35" id="h27-2-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h27-2-38" id="h27-2-38" class="d">-            (
</a><a href="#h27-2-39" id="h27-2-39" class="d">-                Field(
</a><a href="#h27-2-40" id="h27-2-40" class="d">-                    3,
</a><a href="#h27-2-41" id="h27-2-41" class="d">-                    None,
</a><a href="#h27-2-42" id="h27-2-42" class="d">-                ),
</a><a href="#h27-2-43" id="h27-2-43" class="i">+            Field(
</a><a href="#h27-2-44" id="h27-2-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h27-2-47" id="h27-2-47" class="d">-            (
</a><a href="#h27-2-48" id="h27-2-48" class="d">-                Field(
</a><a href="#h27-2-49" id="h27-2-49" class="d">-                    4,
</a><a href="#h27-2-50" id="h27-2-50" class="d">-                    None,
</a><a href="#h27-2-51" id="h27-2-51" class="d">-                ),
</a><a href="#h27-2-52" id="h27-2-52" class="i">+            Field(
</a><a href="#h27-2-53" id="h27-2-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h27-3" id="h27-3" class="h">@@ -307,66 +290,58 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h27-3-3" id="h27-3-3" class="i">+                labels: [
</a><a href="#h27-3-4" id="h27-3-4" class="i">+                    None,
</a><a href="#h27-3-5" id="h27-3-5" class="i">+                    None,
</a><a href="#h27-3-6" id="h27-3-6" class="i">+                    None,
</a><a href="#h27-3-7" id="h27-3-7" class="i">+                    None,
</a><a href="#h27-3-8" id="h27-3-8" class="i">+                    None,
</a><a href="#h27-3-9" id="h27-3-9" class="i">+                ],
</a>                 expressions: [
<a href="#h27-3-11" id="h27-3-11" class="d">-                    (
</a><a href="#h27-3-12" id="h27-3-12" class="d">-                        Field(
</a><a href="#h27-3-13" id="h27-3-13" class="d">-                            1,
</a><a href="#h27-3-14" id="h27-3-14" class="d">-                            Some(
</a><a href="#h27-3-15" id="h27-3-15" class="d">-                                (
</a><a href="#h27-3-16" id="h27-3-16" class="d">-                                    None,
</a><a href="#h27-3-17" id="h27-3-17" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-3-18" id="h27-3-18" class="d">-                                ),
</a><a href="#h27-3-19" id="h27-3-19" class="i">+                    Field(
</a><a href="#h27-3-20" id="h27-3-20" class="i">+                        1,
</a><a href="#h27-3-21" id="h27-3-21" class="i">+                        Some(
</a><a href="#h27-3-22" id="h27-3-22" class="i">+                            (
</a><a href="#h27-3-23" id="h27-3-23" class="i">+                                None,
</a><a href="#h27-3-24" id="h27-3-24" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-3-27" id="h27-3-27" class="d">-                        None,
</a>                     ),
<a href="#h27-3-29" id="h27-3-29" class="d">-                    (
</a><a href="#h27-3-30" id="h27-3-30" class="d">-                        Field(
</a><a href="#h27-3-31" id="h27-3-31" class="d">-                            1,
</a><a href="#h27-3-32" id="h27-3-32" class="d">-                            Some(
</a><a href="#h27-3-33" id="h27-3-33" class="d">-                                (
</a><a href="#h27-3-34" id="h27-3-34" class="d">-                                    None,
</a><a href="#h27-3-35" id="h27-3-35" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-3-36" id="h27-3-36" class="d">-                                ),
</a><a href="#h27-3-37" id="h27-3-37" class="i">+                    Field(
</a><a href="#h27-3-38" id="h27-3-38" class="i">+                        1,
</a><a href="#h27-3-39" id="h27-3-39" class="i">+                        Some(
</a><a href="#h27-3-40" id="h27-3-40" class="i">+                            (
</a><a href="#h27-3-41" id="h27-3-41" class="i">+                                None,
</a><a href="#h27-3-42" id="h27-3-42" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-3-45" id="h27-3-45" class="d">-                        None,
</a>                     ),
<a href="#h27-3-47" id="h27-3-47" class="d">-                    (
</a><a href="#h27-3-48" id="h27-3-48" class="d">-                        Field(
</a><a href="#h27-3-49" id="h27-3-49" class="d">-                            1,
</a><a href="#h27-3-50" id="h27-3-50" class="d">-                            Some(
</a><a href="#h27-3-51" id="h27-3-51" class="d">-                                (
</a><a href="#h27-3-52" id="h27-3-52" class="d">-                                    None,
</a><a href="#h27-3-53" id="h27-3-53" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-3-54" id="h27-3-54" class="d">-                                ),
</a><a href="#h27-3-55" id="h27-3-55" class="i">+                    Field(
</a><a href="#h27-3-56" id="h27-3-56" class="i">+                        1,
</a><a href="#h27-3-57" id="h27-3-57" class="i">+                        Some(
</a><a href="#h27-3-58" id="h27-3-58" class="i">+                            (
</a><a href="#h27-3-59" id="h27-3-59" class="i">+                                None,
</a><a href="#h27-3-60" id="h27-3-60" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-3-63" id="h27-3-63" class="d">-                        None,
</a>                     ),
<a href="#h27-3-65" id="h27-3-65" class="d">-                    (
</a><a href="#h27-3-66" id="h27-3-66" class="d">-                        Field(
</a><a href="#h27-3-67" id="h27-3-67" class="d">-                            1,
</a><a href="#h27-3-68" id="h27-3-68" class="d">-                            Some(
</a><a href="#h27-3-69" id="h27-3-69" class="d">-                                (
</a><a href="#h27-3-70" id="h27-3-70" class="d">-                                    None,
</a><a href="#h27-3-71" id="h27-3-71" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-3-72" id="h27-3-72" class="d">-                                ),
</a><a href="#h27-3-73" id="h27-3-73" class="i">+                    Field(
</a><a href="#h27-3-74" id="h27-3-74" class="i">+                        1,
</a><a href="#h27-3-75" id="h27-3-75" class="i">+                        Some(
</a><a href="#h27-3-76" id="h27-3-76" class="i">+                            (
</a><a href="#h27-3-77" id="h27-3-77" class="i">+                                None,
</a><a href="#h27-3-78" id="h27-3-78" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-3-81" id="h27-3-81" class="d">-                        None,
</a>                     ),
<a href="#h27-3-83" id="h27-3-83" class="d">-                    (
</a><a href="#h27-3-84" id="h27-3-84" class="d">-                        Field(
</a><a href="#h27-3-85" id="h27-3-85" class="d">-                            1,
</a><a href="#h27-3-86" id="h27-3-86" class="d">-                            Some(
</a><a href="#h27-3-87" id="h27-3-87" class="d">-                                (
</a><a href="#h27-3-88" id="h27-3-88" class="d">-                                    None,
</a><a href="#h27-3-89" id="h27-3-89" class="d">-                                    &quot;s&quot;,
</a><a href="#h27-3-90" id="h27-3-90" class="d">-                                ),
</a><a href="#h27-3-91" id="h27-3-91" class="i">+                    Field(
</a><a href="#h27-3-92" id="h27-3-92" class="i">+                        1,
</a><a href="#h27-3-93" id="h27-3-93" class="i">+                        Some(
</a><a href="#h27-3-94" id="h27-3-94" class="i">+                            (
</a><a href="#h27-3-95" id="h27-3-95" class="i">+                                None,
</a><a href="#h27-3-96" id="h27-3-96" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h27-3-99" id="h27-3-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h27-4" id="h27-4" class="h">@@ -378,40 +353,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h27-4-3" id="h27-4-3" class="i">+        labels: [
</a><a href="#h27-4-4" id="h27-4-4" class="i">+            None,
</a><a href="#h27-4-5" id="h27-4-5" class="i">+            None,
</a><a href="#h27-4-6" id="h27-4-6" class="i">+            None,
</a><a href="#h27-4-7" id="h27-4-7" class="i">+            None,
</a><a href="#h27-4-8" id="h27-4-8" class="i">+            None,
</a><a href="#h27-4-9" id="h27-4-9" class="i">+        ],
</a>         expressions: [
<a href="#h27-4-11" id="h27-4-11" class="d">-            (
</a><a href="#h27-4-12" id="h27-4-12" class="d">-                Field(
</a><a href="#h27-4-13" id="h27-4-13" class="d">-                    0,
</a><a href="#h27-4-14" id="h27-4-14" class="d">-                    None,
</a><a href="#h27-4-15" id="h27-4-15" class="d">-                ),
</a><a href="#h27-4-16" id="h27-4-16" class="i">+            Field(
</a><a href="#h27-4-17" id="h27-4-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h27-4-20" id="h27-4-20" class="d">-            (
</a><a href="#h27-4-21" id="h27-4-21" class="d">-                Field(
</a><a href="#h27-4-22" id="h27-4-22" class="d">-                    1,
</a><a href="#h27-4-23" id="h27-4-23" class="d">-                    None,
</a><a href="#h27-4-24" id="h27-4-24" class="d">-                ),
</a><a href="#h27-4-25" id="h27-4-25" class="i">+            Field(
</a><a href="#h27-4-26" id="h27-4-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h27-4-29" id="h27-4-29" class="d">-            (
</a><a href="#h27-4-30" id="h27-4-30" class="d">-                Field(
</a><a href="#h27-4-31" id="h27-4-31" class="d">-                    2,
</a><a href="#h27-4-32" id="h27-4-32" class="d">-                    None,
</a><a href="#h27-4-33" id="h27-4-33" class="d">-                ),
</a><a href="#h27-4-34" id="h27-4-34" class="i">+            Field(
</a><a href="#h27-4-35" id="h27-4-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h27-4-38" id="h27-4-38" class="d">-            (
</a><a href="#h27-4-39" id="h27-4-39" class="d">-                Field(
</a><a href="#h27-4-40" id="h27-4-40" class="d">-                    3,
</a><a href="#h27-4-41" id="h27-4-41" class="d">-                    None,
</a><a href="#h27-4-42" id="h27-4-42" class="d">-                ),
</a><a href="#h27-4-43" id="h27-4-43" class="i">+            Field(
</a><a href="#h27-4-44" id="h27-4-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h27-4-47" id="h27-4-47" class="d">-            (
</a><a href="#h27-4-48" id="h27-4-48" class="d">-                Field(
</a><a href="#h27-4-49" id="h27-4-49" class="d">-                    4,
</a><a href="#h27-4-50" id="h27-4-50" class="d">-                    None,
</a><a href="#h27-4-51" id="h27-4-51" class="d">-                ),
</a><a href="#h27-4-52" id="h27-4-52" class="i">+            Field(
</a><a href="#h27-4-53" id="h27-4-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a> b/<a href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -6,8 +6,7 @@ Projection: #0, #1, #2, #3, #4
</a>     Projection: s, s, s, s, s
        Scan: strings
 
<a href="#h28-0-3" id="h28-0-3" class="d">-Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h28-0-4" id="h28-0-4" class="d">-[Null, Null, Null, Integer(7), Null]
</a><a href="#h28-0-5" id="h28-0-5" class="i">+Error: invalid input: can&#39;t add 0 and a
</a> 
 AST: Select {
     select: [
<a href="#h28-1" id="h28-1" class="h">@@ -120,66 +119,58 @@ Plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h28-1-3" id="h28-1-3" class="i">+                labels: [
</a><a href="#h28-1-4" id="h28-1-4" class="i">+                    None,
</a><a href="#h28-1-5" id="h28-1-5" class="i">+                    None,
</a><a href="#h28-1-6" id="h28-1-6" class="i">+                    None,
</a><a href="#h28-1-7" id="h28-1-7" class="i">+                    None,
</a><a href="#h28-1-8" id="h28-1-8" class="i">+                    None,
</a><a href="#h28-1-9" id="h28-1-9" class="i">+                ],
</a>                 expressions: [
<a href="#h28-1-11" id="h28-1-11" class="d">-                    (
</a><a href="#h28-1-12" id="h28-1-12" class="d">-                        Field(
</a><a href="#h28-1-13" id="h28-1-13" class="d">-                            1,
</a><a href="#h28-1-14" id="h28-1-14" class="d">-                            Some(
</a><a href="#h28-1-15" id="h28-1-15" class="d">-                                (
</a><a href="#h28-1-16" id="h28-1-16" class="d">-                                    None,
</a><a href="#h28-1-17" id="h28-1-17" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-1-18" id="h28-1-18" class="d">-                                ),
</a><a href="#h28-1-19" id="h28-1-19" class="i">+                    Field(
</a><a href="#h28-1-20" id="h28-1-20" class="i">+                        1,
</a><a href="#h28-1-21" id="h28-1-21" class="i">+                        Some(
</a><a href="#h28-1-22" id="h28-1-22" class="i">+                            (
</a><a href="#h28-1-23" id="h28-1-23" class="i">+                                None,
</a><a href="#h28-1-24" id="h28-1-24" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-1-27" id="h28-1-27" class="d">-                        None,
</a>                     ),
<a href="#h28-1-29" id="h28-1-29" class="d">-                    (
</a><a href="#h28-1-30" id="h28-1-30" class="d">-                        Field(
</a><a href="#h28-1-31" id="h28-1-31" class="d">-                            1,
</a><a href="#h28-1-32" id="h28-1-32" class="d">-                            Some(
</a><a href="#h28-1-33" id="h28-1-33" class="d">-                                (
</a><a href="#h28-1-34" id="h28-1-34" class="d">-                                    None,
</a><a href="#h28-1-35" id="h28-1-35" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-1-36" id="h28-1-36" class="d">-                                ),
</a><a href="#h28-1-37" id="h28-1-37" class="i">+                    Field(
</a><a href="#h28-1-38" id="h28-1-38" class="i">+                        1,
</a><a href="#h28-1-39" id="h28-1-39" class="i">+                        Some(
</a><a href="#h28-1-40" id="h28-1-40" class="i">+                            (
</a><a href="#h28-1-41" id="h28-1-41" class="i">+                                None,
</a><a href="#h28-1-42" id="h28-1-42" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-1-45" id="h28-1-45" class="d">-                        None,
</a>                     ),
<a href="#h28-1-47" id="h28-1-47" class="d">-                    (
</a><a href="#h28-1-48" id="h28-1-48" class="d">-                        Field(
</a><a href="#h28-1-49" id="h28-1-49" class="d">-                            1,
</a><a href="#h28-1-50" id="h28-1-50" class="d">-                            Some(
</a><a href="#h28-1-51" id="h28-1-51" class="d">-                                (
</a><a href="#h28-1-52" id="h28-1-52" class="d">-                                    None,
</a><a href="#h28-1-53" id="h28-1-53" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-1-54" id="h28-1-54" class="d">-                                ),
</a><a href="#h28-1-55" id="h28-1-55" class="i">+                    Field(
</a><a href="#h28-1-56" id="h28-1-56" class="i">+                        1,
</a><a href="#h28-1-57" id="h28-1-57" class="i">+                        Some(
</a><a href="#h28-1-58" id="h28-1-58" class="i">+                            (
</a><a href="#h28-1-59" id="h28-1-59" class="i">+                                None,
</a><a href="#h28-1-60" id="h28-1-60" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-1-63" id="h28-1-63" class="d">-                        None,
</a>                     ),
<a href="#h28-1-65" id="h28-1-65" class="d">-                    (
</a><a href="#h28-1-66" id="h28-1-66" class="d">-                        Field(
</a><a href="#h28-1-67" id="h28-1-67" class="d">-                            1,
</a><a href="#h28-1-68" id="h28-1-68" class="d">-                            Some(
</a><a href="#h28-1-69" id="h28-1-69" class="d">-                                (
</a><a href="#h28-1-70" id="h28-1-70" class="d">-                                    None,
</a><a href="#h28-1-71" id="h28-1-71" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-1-72" id="h28-1-72" class="d">-                                ),
</a><a href="#h28-1-73" id="h28-1-73" class="i">+                    Field(
</a><a href="#h28-1-74" id="h28-1-74" class="i">+                        1,
</a><a href="#h28-1-75" id="h28-1-75" class="i">+                        Some(
</a><a href="#h28-1-76" id="h28-1-76" class="i">+                            (
</a><a href="#h28-1-77" id="h28-1-77" class="i">+                                None,
</a><a href="#h28-1-78" id="h28-1-78" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-1-81" id="h28-1-81" class="d">-                        None,
</a>                     ),
<a href="#h28-1-83" id="h28-1-83" class="d">-                    (
</a><a href="#h28-1-84" id="h28-1-84" class="d">-                        Field(
</a><a href="#h28-1-85" id="h28-1-85" class="d">-                            1,
</a><a href="#h28-1-86" id="h28-1-86" class="d">-                            Some(
</a><a href="#h28-1-87" id="h28-1-87" class="d">-                                (
</a><a href="#h28-1-88" id="h28-1-88" class="d">-                                    None,
</a><a href="#h28-1-89" id="h28-1-89" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-1-90" id="h28-1-90" class="d">-                                ),
</a><a href="#h28-1-91" id="h28-1-91" class="i">+                    Field(
</a><a href="#h28-1-92" id="h28-1-92" class="i">+                        1,
</a><a href="#h28-1-93" id="h28-1-93" class="i">+                        Some(
</a><a href="#h28-1-94" id="h28-1-94" class="i">+                            (
</a><a href="#h28-1-95" id="h28-1-95" class="i">+                                None,
</a><a href="#h28-1-96" id="h28-1-96" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-1-99" id="h28-1-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h28-2" id="h28-2" class="h">@@ -191,40 +182,32 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h28-2-3" id="h28-2-3" class="i">+        labels: [
</a><a href="#h28-2-4" id="h28-2-4" class="i">+            None,
</a><a href="#h28-2-5" id="h28-2-5" class="i">+            None,
</a><a href="#h28-2-6" id="h28-2-6" class="i">+            None,
</a><a href="#h28-2-7" id="h28-2-7" class="i">+            None,
</a><a href="#h28-2-8" id="h28-2-8" class="i">+            None,
</a><a href="#h28-2-9" id="h28-2-9" class="i">+        ],
</a>         expressions: [
<a href="#h28-2-11" id="h28-2-11" class="d">-            (
</a><a href="#h28-2-12" id="h28-2-12" class="d">-                Field(
</a><a href="#h28-2-13" id="h28-2-13" class="d">-                    0,
</a><a href="#h28-2-14" id="h28-2-14" class="d">-                    None,
</a><a href="#h28-2-15" id="h28-2-15" class="d">-                ),
</a><a href="#h28-2-16" id="h28-2-16" class="i">+            Field(
</a><a href="#h28-2-17" id="h28-2-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h28-2-20" id="h28-2-20" class="d">-            (
</a><a href="#h28-2-21" id="h28-2-21" class="d">-                Field(
</a><a href="#h28-2-22" id="h28-2-22" class="d">-                    1,
</a><a href="#h28-2-23" id="h28-2-23" class="d">-                    None,
</a><a href="#h28-2-24" id="h28-2-24" class="d">-                ),
</a><a href="#h28-2-25" id="h28-2-25" class="i">+            Field(
</a><a href="#h28-2-26" id="h28-2-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h28-2-29" id="h28-2-29" class="d">-            (
</a><a href="#h28-2-30" id="h28-2-30" class="d">-                Field(
</a><a href="#h28-2-31" id="h28-2-31" class="d">-                    2,
</a><a href="#h28-2-32" id="h28-2-32" class="d">-                    None,
</a><a href="#h28-2-33" id="h28-2-33" class="d">-                ),
</a><a href="#h28-2-34" id="h28-2-34" class="i">+            Field(
</a><a href="#h28-2-35" id="h28-2-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h28-2-38" id="h28-2-38" class="d">-            (
</a><a href="#h28-2-39" id="h28-2-39" class="d">-                Field(
</a><a href="#h28-2-40" id="h28-2-40" class="d">-                    3,
</a><a href="#h28-2-41" id="h28-2-41" class="d">-                    None,
</a><a href="#h28-2-42" id="h28-2-42" class="d">-                ),
</a><a href="#h28-2-43" id="h28-2-43" class="i">+            Field(
</a><a href="#h28-2-44" id="h28-2-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h28-2-47" id="h28-2-47" class="d">-            (
</a><a href="#h28-2-48" id="h28-2-48" class="d">-                Field(
</a><a href="#h28-2-49" id="h28-2-49" class="d">-                    4,
</a><a href="#h28-2-50" id="h28-2-50" class="d">-                    None,
</a><a href="#h28-2-51" id="h28-2-51" class="d">-                ),
</a><a href="#h28-2-52" id="h28-2-52" class="i">+            Field(
</a><a href="#h28-2-53" id="h28-2-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h28-3" id="h28-3" class="h">@@ -265,66 +248,58 @@ Optimized plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h28-3-3" id="h28-3-3" class="i">+                labels: [
</a><a href="#h28-3-4" id="h28-3-4" class="i">+                    None,
</a><a href="#h28-3-5" id="h28-3-5" class="i">+                    None,
</a><a href="#h28-3-6" id="h28-3-6" class="i">+                    None,
</a><a href="#h28-3-7" id="h28-3-7" class="i">+                    None,
</a><a href="#h28-3-8" id="h28-3-8" class="i">+                    None,
</a><a href="#h28-3-9" id="h28-3-9" class="i">+                ],
</a>                 expressions: [
<a href="#h28-3-11" id="h28-3-11" class="d">-                    (
</a><a href="#h28-3-12" id="h28-3-12" class="d">-                        Field(
</a><a href="#h28-3-13" id="h28-3-13" class="d">-                            1,
</a><a href="#h28-3-14" id="h28-3-14" class="d">-                            Some(
</a><a href="#h28-3-15" id="h28-3-15" class="d">-                                (
</a><a href="#h28-3-16" id="h28-3-16" class="d">-                                    None,
</a><a href="#h28-3-17" id="h28-3-17" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-3-18" id="h28-3-18" class="d">-                                ),
</a><a href="#h28-3-19" id="h28-3-19" class="i">+                    Field(
</a><a href="#h28-3-20" id="h28-3-20" class="i">+                        1,
</a><a href="#h28-3-21" id="h28-3-21" class="i">+                        Some(
</a><a href="#h28-3-22" id="h28-3-22" class="i">+                            (
</a><a href="#h28-3-23" id="h28-3-23" class="i">+                                None,
</a><a href="#h28-3-24" id="h28-3-24" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-3-27" id="h28-3-27" class="d">-                        None,
</a>                     ),
<a href="#h28-3-29" id="h28-3-29" class="d">-                    (
</a><a href="#h28-3-30" id="h28-3-30" class="d">-                        Field(
</a><a href="#h28-3-31" id="h28-3-31" class="d">-                            1,
</a><a href="#h28-3-32" id="h28-3-32" class="d">-                            Some(
</a><a href="#h28-3-33" id="h28-3-33" class="d">-                                (
</a><a href="#h28-3-34" id="h28-3-34" class="d">-                                    None,
</a><a href="#h28-3-35" id="h28-3-35" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-3-36" id="h28-3-36" class="d">-                                ),
</a><a href="#h28-3-37" id="h28-3-37" class="i">+                    Field(
</a><a href="#h28-3-38" id="h28-3-38" class="i">+                        1,
</a><a href="#h28-3-39" id="h28-3-39" class="i">+                        Some(
</a><a href="#h28-3-40" id="h28-3-40" class="i">+                            (
</a><a href="#h28-3-41" id="h28-3-41" class="i">+                                None,
</a><a href="#h28-3-42" id="h28-3-42" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-3-45" id="h28-3-45" class="d">-                        None,
</a>                     ),
<a href="#h28-3-47" id="h28-3-47" class="d">-                    (
</a><a href="#h28-3-48" id="h28-3-48" class="d">-                        Field(
</a><a href="#h28-3-49" id="h28-3-49" class="d">-                            1,
</a><a href="#h28-3-50" id="h28-3-50" class="d">-                            Some(
</a><a href="#h28-3-51" id="h28-3-51" class="d">-                                (
</a><a href="#h28-3-52" id="h28-3-52" class="d">-                                    None,
</a><a href="#h28-3-53" id="h28-3-53" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-3-54" id="h28-3-54" class="d">-                                ),
</a><a href="#h28-3-55" id="h28-3-55" class="i">+                    Field(
</a><a href="#h28-3-56" id="h28-3-56" class="i">+                        1,
</a><a href="#h28-3-57" id="h28-3-57" class="i">+                        Some(
</a><a href="#h28-3-58" id="h28-3-58" class="i">+                            (
</a><a href="#h28-3-59" id="h28-3-59" class="i">+                                None,
</a><a href="#h28-3-60" id="h28-3-60" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-3-63" id="h28-3-63" class="d">-                        None,
</a>                     ),
<a href="#h28-3-65" id="h28-3-65" class="d">-                    (
</a><a href="#h28-3-66" id="h28-3-66" class="d">-                        Field(
</a><a href="#h28-3-67" id="h28-3-67" class="d">-                            1,
</a><a href="#h28-3-68" id="h28-3-68" class="d">-                            Some(
</a><a href="#h28-3-69" id="h28-3-69" class="d">-                                (
</a><a href="#h28-3-70" id="h28-3-70" class="d">-                                    None,
</a><a href="#h28-3-71" id="h28-3-71" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-3-72" id="h28-3-72" class="d">-                                ),
</a><a href="#h28-3-73" id="h28-3-73" class="i">+                    Field(
</a><a href="#h28-3-74" id="h28-3-74" class="i">+                        1,
</a><a href="#h28-3-75" id="h28-3-75" class="i">+                        Some(
</a><a href="#h28-3-76" id="h28-3-76" class="i">+                            (
</a><a href="#h28-3-77" id="h28-3-77" class="i">+                                None,
</a><a href="#h28-3-78" id="h28-3-78" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-3-81" id="h28-3-81" class="d">-                        None,
</a>                     ),
<a href="#h28-3-83" id="h28-3-83" class="d">-                    (
</a><a href="#h28-3-84" id="h28-3-84" class="d">-                        Field(
</a><a href="#h28-3-85" id="h28-3-85" class="d">-                            1,
</a><a href="#h28-3-86" id="h28-3-86" class="d">-                            Some(
</a><a href="#h28-3-87" id="h28-3-87" class="d">-                                (
</a><a href="#h28-3-88" id="h28-3-88" class="d">-                                    None,
</a><a href="#h28-3-89" id="h28-3-89" class="d">-                                    &quot;s&quot;,
</a><a href="#h28-3-90" id="h28-3-90" class="d">-                                ),
</a><a href="#h28-3-91" id="h28-3-91" class="i">+                    Field(
</a><a href="#h28-3-92" id="h28-3-92" class="i">+                        1,
</a><a href="#h28-3-93" id="h28-3-93" class="i">+                        Some(
</a><a href="#h28-3-94" id="h28-3-94" class="i">+                            (
</a><a href="#h28-3-95" id="h28-3-95" class="i">+                                None,
</a><a href="#h28-3-96" id="h28-3-96" class="i">+                                &quot;s&quot;,
</a>                             ),
                         ),
<a href="#h28-3-99" id="h28-3-99" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h28-4" id="h28-4" class="h">@@ -336,40 +311,32 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h28-4-3" id="h28-4-3" class="i">+        labels: [
</a><a href="#h28-4-4" id="h28-4-4" class="i">+            None,
</a><a href="#h28-4-5" id="h28-4-5" class="i">+            None,
</a><a href="#h28-4-6" id="h28-4-6" class="i">+            None,
</a><a href="#h28-4-7" id="h28-4-7" class="i">+            None,
</a><a href="#h28-4-8" id="h28-4-8" class="i">+            None,
</a><a href="#h28-4-9" id="h28-4-9" class="i">+        ],
</a>         expressions: [
<a href="#h28-4-11" id="h28-4-11" class="d">-            (
</a><a href="#h28-4-12" id="h28-4-12" class="d">-                Field(
</a><a href="#h28-4-13" id="h28-4-13" class="d">-                    0,
</a><a href="#h28-4-14" id="h28-4-14" class="d">-                    None,
</a><a href="#h28-4-15" id="h28-4-15" class="d">-                ),
</a><a href="#h28-4-16" id="h28-4-16" class="i">+            Field(
</a><a href="#h28-4-17" id="h28-4-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h28-4-20" id="h28-4-20" class="d">-            (
</a><a href="#h28-4-21" id="h28-4-21" class="d">-                Field(
</a><a href="#h28-4-22" id="h28-4-22" class="d">-                    1,
</a><a href="#h28-4-23" id="h28-4-23" class="d">-                    None,
</a><a href="#h28-4-24" id="h28-4-24" class="d">-                ),
</a><a href="#h28-4-25" id="h28-4-25" class="i">+            Field(
</a><a href="#h28-4-26" id="h28-4-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h28-4-29" id="h28-4-29" class="d">-            (
</a><a href="#h28-4-30" id="h28-4-30" class="d">-                Field(
</a><a href="#h28-4-31" id="h28-4-31" class="d">-                    2,
</a><a href="#h28-4-32" id="h28-4-32" class="d">-                    None,
</a><a href="#h28-4-33" id="h28-4-33" class="d">-                ),
</a><a href="#h28-4-34" id="h28-4-34" class="i">+            Field(
</a><a href="#h28-4-35" id="h28-4-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h28-4-38" id="h28-4-38" class="d">-            (
</a><a href="#h28-4-39" id="h28-4-39" class="d">-                Field(
</a><a href="#h28-4-40" id="h28-4-40" class="d">-                    3,
</a><a href="#h28-4-41" id="h28-4-41" class="d">-                    None,
</a><a href="#h28-4-42" id="h28-4-42" class="d">-                ),
</a><a href="#h28-4-43" id="h28-4-43" class="i">+            Field(
</a><a href="#h28-4-44" id="h28-4-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h28-4-47" id="h28-4-47" class="d">-            (
</a><a href="#h28-4-48" id="h28-4-48" class="d">-                Field(
</a><a href="#h28-4-49" id="h28-4-49" class="d">-                    4,
</a><a href="#h28-4-50" id="h28-4-50" class="d">-                    None,
</a><a href="#h28-4-51" id="h28-4-51" class="d">-                ),
</a><a href="#h28-4-52" id="h28-4-52" class="i">+            Field(
</a><a href="#h28-4-53" id="h28-4-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a> b/<a href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -163,57 +163,61 @@ Plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h29-0-3" id="h29-0-3" class="d">-        expressions: [
</a><a href="#h29-0-4" id="h29-0-4" class="d">-            (
</a><a href="#h29-0-5" id="h29-0-5" class="d">-                Constant(
</a><a href="#h29-0-6" id="h29-0-6" class="d">-                    Integer(
</a><a href="#h29-0-7" id="h29-0-7" class="d">-                        1,
</a><a href="#h29-0-8" id="h29-0-8" class="d">-                    ),
</a><a href="#h29-0-9" id="h29-0-9" class="i">+        labels: [
</a><a href="#h29-0-10" id="h29-0-10" class="i">+            None,
</a><a href="#h29-0-11" id="h29-0-11" class="i">+            Some(
</a><a href="#h29-0-12" id="h29-0-12" class="i">+                (
</a><a href="#h29-0-13" id="h29-0-13" class="i">+                    None,
</a><a href="#h29-0-14" id="h29-0-14" class="i">+                    &quot;b&quot;,
</a>                 ),
<a href="#h29-0-16" id="h29-0-16" class="d">-                None,
</a>             ),
<a href="#h29-0-18" id="h29-0-18" class="d">-            (
</a><a href="#h29-0-19" id="h29-0-19" class="d">-                Constant(
</a><a href="#h29-0-20" id="h29-0-20" class="d">-                    Integer(
</a><a href="#h29-0-21" id="h29-0-21" class="d">-                        2,
</a><a href="#h29-0-22" id="h29-0-22" class="d">-                    ),
</a><a href="#h29-0-23" id="h29-0-23" class="i">+            Some(
</a><a href="#h29-0-24" id="h29-0-24" class="i">+                (
</a><a href="#h29-0-25" id="h29-0-25" class="i">+                    None,
</a><a href="#h29-0-26" id="h29-0-26" class="i">+                    &quot;c&quot;,
</a>                 ),
<a href="#h29-0-28" id="h29-0-28" class="d">-                Some(
</a><a href="#h29-0-29" id="h29-0-29" class="d">-                    &quot;b&quot;,
</a><a href="#h29-0-30" id="h29-0-30" class="i">+            ),
</a><a href="#h29-0-31" id="h29-0-31" class="i">+            Some(
</a><a href="#h29-0-32" id="h29-0-32" class="i">+                (
</a><a href="#h29-0-33" id="h29-0-33" class="i">+                    None,
</a><a href="#h29-0-34" id="h29-0-34" class="i">+                    &quot;&quot;,
</a>                 ),
             ),
<a href="#h29-0-37" id="h29-0-37" class="d">-            (
</a><a href="#h29-0-38" id="h29-0-38" class="d">-                Constant(
</a><a href="#h29-0-39" id="h29-0-39" class="d">-                    Integer(
</a><a href="#h29-0-40" id="h29-0-40" class="d">-                        3,
</a><a href="#h29-0-41" id="h29-0-41" class="d">-                    ),
</a><a href="#h29-0-42" id="h29-0-42" class="i">+            Some(
</a><a href="#h29-0-43" id="h29-0-43" class="i">+                (
</a><a href="#h29-0-44" id="h29-0-44" class="i">+                    None,
</a><a href="#h29-0-45" id="h29-0-45" class="i">+                    &quot;some id&quot;,
</a>                 ),
<a href="#h29-0-47" id="h29-0-47" class="d">-                Some(
</a><a href="#h29-0-48" id="h29-0-48" class="d">-                    &quot;c&quot;,
</a><a href="#h29-0-49" id="h29-0-49" class="i">+            ),
</a><a href="#h29-0-50" id="h29-0-50" class="i">+        ],
</a><a href="#h29-0-51" id="h29-0-51" class="i">+        expressions: [
</a><a href="#h29-0-52" id="h29-0-52" class="i">+            Constant(
</a><a href="#h29-0-53" id="h29-0-53" class="i">+                Integer(
</a><a href="#h29-0-54" id="h29-0-54" class="i">+                    1,
</a>                 ),
             ),
<a href="#h29-0-57" id="h29-0-57" class="d">-            (
</a><a href="#h29-0-58" id="h29-0-58" class="d">-                Constant(
</a><a href="#h29-0-59" id="h29-0-59" class="d">-                    Integer(
</a><a href="#h29-0-60" id="h29-0-60" class="d">-                        4,
</a><a href="#h29-0-61" id="h29-0-61" class="d">-                    ),
</a><a href="#h29-0-62" id="h29-0-62" class="i">+            Constant(
</a><a href="#h29-0-63" id="h29-0-63" class="i">+                Integer(
</a><a href="#h29-0-64" id="h29-0-64" class="i">+                    2,
</a>                 ),
<a href="#h29-0-66" id="h29-0-66" class="d">-                Some(
</a><a href="#h29-0-67" id="h29-0-67" class="d">-                    &quot;&quot;,
</a><a href="#h29-0-68" id="h29-0-68" class="i">+            ),
</a><a href="#h29-0-69" id="h29-0-69" class="i">+            Constant(
</a><a href="#h29-0-70" id="h29-0-70" class="i">+                Integer(
</a><a href="#h29-0-71" id="h29-0-71" class="i">+                    3,
</a>                 ),
             ),
<a href="#h29-0-74" id="h29-0-74" class="d">-            (
</a><a href="#h29-0-75" id="h29-0-75" class="d">-                Field(
</a><a href="#h29-0-76" id="h29-0-76" class="d">-                    0,
</a><a href="#h29-0-77" id="h29-0-77" class="d">-                    Some(
</a><a href="#h29-0-78" id="h29-0-78" class="d">-                        (
</a><a href="#h29-0-79" id="h29-0-79" class="d">-                            None,
</a><a href="#h29-0-80" id="h29-0-80" class="d">-                            &quot;id&quot;,
</a><a href="#h29-0-81" id="h29-0-81" class="d">-                        ),
</a><a href="#h29-0-82" id="h29-0-82" class="d">-                    ),
</a><a href="#h29-0-83" id="h29-0-83" class="i">+            Constant(
</a><a href="#h29-0-84" id="h29-0-84" class="i">+                Integer(
</a><a href="#h29-0-85" id="h29-0-85" class="i">+                    4,
</a>                 ),
<a href="#h29-0-87" id="h29-0-87" class="i">+            ),
</a><a href="#h29-0-88" id="h29-0-88" class="i">+            Field(
</a><a href="#h29-0-89" id="h29-0-89" class="i">+                0,
</a>                 Some(
<a href="#h29-0-91" id="h29-0-91" class="d">-                    &quot;some id&quot;,
</a><a href="#h29-0-92" id="h29-0-92" class="i">+                    (
</a><a href="#h29-0-93" id="h29-0-93" class="i">+                        None,
</a><a href="#h29-0-94" id="h29-0-94" class="i">+                        &quot;id&quot;,
</a><a href="#h29-0-95" id="h29-0-95" class="i">+                    ),
</a>                 ),
             ),
         ],
<a href="#h29-1" id="h29-1" class="h">@@ -303,57 +307,61 @@ Optimized plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h29-1-3" id="h29-1-3" class="d">-        expressions: [
</a><a href="#h29-1-4" id="h29-1-4" class="d">-            (
</a><a href="#h29-1-5" id="h29-1-5" class="d">-                Constant(
</a><a href="#h29-1-6" id="h29-1-6" class="d">-                    Integer(
</a><a href="#h29-1-7" id="h29-1-7" class="d">-                        1,
</a><a href="#h29-1-8" id="h29-1-8" class="d">-                    ),
</a><a href="#h29-1-9" id="h29-1-9" class="i">+        labels: [
</a><a href="#h29-1-10" id="h29-1-10" class="i">+            None,
</a><a href="#h29-1-11" id="h29-1-11" class="i">+            Some(
</a><a href="#h29-1-12" id="h29-1-12" class="i">+                (
</a><a href="#h29-1-13" id="h29-1-13" class="i">+                    None,
</a><a href="#h29-1-14" id="h29-1-14" class="i">+                    &quot;b&quot;,
</a>                 ),
<a href="#h29-1-16" id="h29-1-16" class="d">-                None,
</a>             ),
<a href="#h29-1-18" id="h29-1-18" class="d">-            (
</a><a href="#h29-1-19" id="h29-1-19" class="d">-                Constant(
</a><a href="#h29-1-20" id="h29-1-20" class="d">-                    Integer(
</a><a href="#h29-1-21" id="h29-1-21" class="d">-                        2,
</a><a href="#h29-1-22" id="h29-1-22" class="d">-                    ),
</a><a href="#h29-1-23" id="h29-1-23" class="i">+            Some(
</a><a href="#h29-1-24" id="h29-1-24" class="i">+                (
</a><a href="#h29-1-25" id="h29-1-25" class="i">+                    None,
</a><a href="#h29-1-26" id="h29-1-26" class="i">+                    &quot;c&quot;,
</a>                 ),
<a href="#h29-1-28" id="h29-1-28" class="d">-                Some(
</a><a href="#h29-1-29" id="h29-1-29" class="d">-                    &quot;b&quot;,
</a><a href="#h29-1-30" id="h29-1-30" class="i">+            ),
</a><a href="#h29-1-31" id="h29-1-31" class="i">+            Some(
</a><a href="#h29-1-32" id="h29-1-32" class="i">+                (
</a><a href="#h29-1-33" id="h29-1-33" class="i">+                    None,
</a><a href="#h29-1-34" id="h29-1-34" class="i">+                    &quot;&quot;,
</a>                 ),
             ),
<a href="#h29-1-37" id="h29-1-37" class="d">-            (
</a><a href="#h29-1-38" id="h29-1-38" class="d">-                Constant(
</a><a href="#h29-1-39" id="h29-1-39" class="d">-                    Integer(
</a><a href="#h29-1-40" id="h29-1-40" class="d">-                        3,
</a><a href="#h29-1-41" id="h29-1-41" class="d">-                    ),
</a><a href="#h29-1-42" id="h29-1-42" class="i">+            Some(
</a><a href="#h29-1-43" id="h29-1-43" class="i">+                (
</a><a href="#h29-1-44" id="h29-1-44" class="i">+                    None,
</a><a href="#h29-1-45" id="h29-1-45" class="i">+                    &quot;some id&quot;,
</a>                 ),
<a href="#h29-1-47" id="h29-1-47" class="d">-                Some(
</a><a href="#h29-1-48" id="h29-1-48" class="d">-                    &quot;c&quot;,
</a><a href="#h29-1-49" id="h29-1-49" class="i">+            ),
</a><a href="#h29-1-50" id="h29-1-50" class="i">+        ],
</a><a href="#h29-1-51" id="h29-1-51" class="i">+        expressions: [
</a><a href="#h29-1-52" id="h29-1-52" class="i">+            Constant(
</a><a href="#h29-1-53" id="h29-1-53" class="i">+                Integer(
</a><a href="#h29-1-54" id="h29-1-54" class="i">+                    1,
</a>                 ),
             ),
<a href="#h29-1-57" id="h29-1-57" class="d">-            (
</a><a href="#h29-1-58" id="h29-1-58" class="d">-                Constant(
</a><a href="#h29-1-59" id="h29-1-59" class="d">-                    Integer(
</a><a href="#h29-1-60" id="h29-1-60" class="d">-                        4,
</a><a href="#h29-1-61" id="h29-1-61" class="d">-                    ),
</a><a href="#h29-1-62" id="h29-1-62" class="i">+            Constant(
</a><a href="#h29-1-63" id="h29-1-63" class="i">+                Integer(
</a><a href="#h29-1-64" id="h29-1-64" class="i">+                    2,
</a>                 ),
<a href="#h29-1-66" id="h29-1-66" class="d">-                Some(
</a><a href="#h29-1-67" id="h29-1-67" class="d">-                    &quot;&quot;,
</a><a href="#h29-1-68" id="h29-1-68" class="i">+            ),
</a><a href="#h29-1-69" id="h29-1-69" class="i">+            Constant(
</a><a href="#h29-1-70" id="h29-1-70" class="i">+                Integer(
</a><a href="#h29-1-71" id="h29-1-71" class="i">+                    3,
</a>                 ),
             ),
<a href="#h29-1-74" id="h29-1-74" class="d">-            (
</a><a href="#h29-1-75" id="h29-1-75" class="d">-                Field(
</a><a href="#h29-1-76" id="h29-1-76" class="d">-                    0,
</a><a href="#h29-1-77" id="h29-1-77" class="d">-                    Some(
</a><a href="#h29-1-78" id="h29-1-78" class="d">-                        (
</a><a href="#h29-1-79" id="h29-1-79" class="d">-                            None,
</a><a href="#h29-1-80" id="h29-1-80" class="d">-                            &quot;id&quot;,
</a><a href="#h29-1-81" id="h29-1-81" class="d">-                        ),
</a><a href="#h29-1-82" id="h29-1-82" class="d">-                    ),
</a><a href="#h29-1-83" id="h29-1-83" class="i">+            Constant(
</a><a href="#h29-1-84" id="h29-1-84" class="i">+                Integer(
</a><a href="#h29-1-85" id="h29-1-85" class="i">+                    4,
</a>                 ),
<a href="#h29-1-87" id="h29-1-87" class="i">+            ),
</a><a href="#h29-1-88" id="h29-1-88" class="i">+            Field(
</a><a href="#h29-1-89" id="h29-1-89" class="i">+                0,
</a>                 Some(
<a href="#h29-1-91" id="h29-1-91" class="d">-                    &quot;some id&quot;,
</a><a href="#h29-1-92" id="h29-1-92" class="i">+                    (
</a><a href="#h29-1-93" id="h29-1-93" class="i">+                        None,
</a><a href="#h29-1-94" id="h29-1-94" class="i">+                        &quot;id&quot;,
</a><a href="#h29-1-95" id="h29-1-95" class="i">+                    ),
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/as_duplicate.html">tests/sql/query/as_duplicate</a> b/<a href="../file/tests/sql/query/as_duplicate.html">tests/sql/query/as_duplicate</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -42,25 +42,29 @@ AST: Select {
</a> Plan: Select(
     Projection {
         source: Nothing,
<a href="#h30-0-3" id="h30-0-3" class="d">-        expressions: [
</a><a href="#h30-0-4" id="h30-0-4" class="d">-            (
</a><a href="#h30-0-5" id="h30-0-5" class="d">-                Constant(
</a><a href="#h30-0-6" id="h30-0-6" class="d">-                    Integer(
</a><a href="#h30-0-7" id="h30-0-7" class="d">-                        1,
</a><a href="#h30-0-8" id="h30-0-8" class="d">-                    ),
</a><a href="#h30-0-9" id="h30-0-9" class="i">+        labels: [
</a><a href="#h30-0-10" id="h30-0-10" class="i">+            Some(
</a><a href="#h30-0-11" id="h30-0-11" class="i">+                (
</a><a href="#h30-0-12" id="h30-0-12" class="i">+                    None,
</a><a href="#h30-0-13" id="h30-0-13" class="i">+                    &quot;a&quot;,
</a>                 ),
<a href="#h30-0-15" id="h30-0-15" class="d">-                Some(
</a><a href="#h30-0-16" id="h30-0-16" class="i">+            ),
</a><a href="#h30-0-17" id="h30-0-17" class="i">+            Some(
</a><a href="#h30-0-18" id="h30-0-18" class="i">+                (
</a><a href="#h30-0-19" id="h30-0-19" class="i">+                    None,
</a>                     &quot;a&quot;,
                 ),
             ),
<a href="#h30-0-23" id="h30-0-23" class="d">-            (
</a><a href="#h30-0-24" id="h30-0-24" class="d">-                Constant(
</a><a href="#h30-0-25" id="h30-0-25" class="d">-                    Integer(
</a><a href="#h30-0-26" id="h30-0-26" class="d">-                        2,
</a><a href="#h30-0-27" id="h30-0-27" class="d">-                    ),
</a><a href="#h30-0-28" id="h30-0-28" class="i">+        ],
</a><a href="#h30-0-29" id="h30-0-29" class="i">+        expressions: [
</a><a href="#h30-0-30" id="h30-0-30" class="i">+            Constant(
</a><a href="#h30-0-31" id="h30-0-31" class="i">+                Integer(
</a><a href="#h30-0-32" id="h30-0-32" class="i">+                    1,
</a>                 ),
<a href="#h30-0-34" id="h30-0-34" class="d">-                Some(
</a><a href="#h30-0-35" id="h30-0-35" class="d">-                    &quot;a&quot;,
</a><a href="#h30-0-36" id="h30-0-36" class="i">+            ),
</a><a href="#h30-0-37" id="h30-0-37" class="i">+            Constant(
</a><a href="#h30-0-38" id="h30-0-38" class="i">+                Integer(
</a><a href="#h30-0-39" id="h30-0-39" class="i">+                    2,
</a>                 ),
             ),
         ],
<a href="#h30-1" id="h30-1" class="h">@@ -70,25 +74,29 @@ Plan: Select(
</a> Optimized plan: Select(
     Projection {
         source: Nothing,
<a href="#h30-1-3" id="h30-1-3" class="d">-        expressions: [
</a><a href="#h30-1-4" id="h30-1-4" class="d">-            (
</a><a href="#h30-1-5" id="h30-1-5" class="d">-                Constant(
</a><a href="#h30-1-6" id="h30-1-6" class="d">-                    Integer(
</a><a href="#h30-1-7" id="h30-1-7" class="d">-                        1,
</a><a href="#h30-1-8" id="h30-1-8" class="d">-                    ),
</a><a href="#h30-1-9" id="h30-1-9" class="i">+        labels: [
</a><a href="#h30-1-10" id="h30-1-10" class="i">+            Some(
</a><a href="#h30-1-11" id="h30-1-11" class="i">+                (
</a><a href="#h30-1-12" id="h30-1-12" class="i">+                    None,
</a><a href="#h30-1-13" id="h30-1-13" class="i">+                    &quot;a&quot;,
</a>                 ),
<a href="#h30-1-15" id="h30-1-15" class="d">-                Some(
</a><a href="#h30-1-16" id="h30-1-16" class="i">+            ),
</a><a href="#h30-1-17" id="h30-1-17" class="i">+            Some(
</a><a href="#h30-1-18" id="h30-1-18" class="i">+                (
</a><a href="#h30-1-19" id="h30-1-19" class="i">+                    None,
</a>                     &quot;a&quot;,
                 ),
             ),
<a href="#h30-1-23" id="h30-1-23" class="d">-            (
</a><a href="#h30-1-24" id="h30-1-24" class="d">-                Constant(
</a><a href="#h30-1-25" id="h30-1-25" class="d">-                    Integer(
</a><a href="#h30-1-26" id="h30-1-26" class="d">-                        2,
</a><a href="#h30-1-27" id="h30-1-27" class="d">-                    ),
</a><a href="#h30-1-28" id="h30-1-28" class="i">+        ],
</a><a href="#h30-1-29" id="h30-1-29" class="i">+        expressions: [
</a><a href="#h30-1-30" id="h30-1-30" class="i">+            Constant(
</a><a href="#h30-1-31" id="h30-1-31" class="i">+                Integer(
</a><a href="#h30-1-32" id="h30-1-32" class="i">+                    1,
</a>                 ),
<a href="#h30-1-34" id="h30-1-34" class="d">-                Some(
</a><a href="#h30-1-35" id="h30-1-35" class="d">-                    &quot;a&quot;,
</a><a href="#h30-1-36" id="h30-1-36" class="i">+            ),
</a><a href="#h30-1-37" id="h30-1-37" class="i">+            Constant(
</a><a href="#h30-1-38" id="h30-1-38" class="i">+                Integer(
</a><a href="#h30-1-39" id="h30-1-39" class="i">+                    2,
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h31" href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a> b/<a href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -160,49 +160,50 @@ Plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h31-0-3" id="h31-0-3" class="i">+        labels: [
</a><a href="#h31-0-4" id="h31-0-4" class="i">+            None,
</a><a href="#h31-0-5" id="h31-0-5" class="i">+            Some(
</a><a href="#h31-0-6" id="h31-0-6" class="i">+                (
</a><a href="#h31-0-7" id="h31-0-7" class="i">+                    None,
</a><a href="#h31-0-8" id="h31-0-8" class="i">+                    &quot;age&quot;,
</a><a href="#h31-0-9" id="h31-0-9" class="i">+                ),
</a><a href="#h31-0-10" id="h31-0-10" class="i">+            ),
</a><a href="#h31-0-11" id="h31-0-11" class="i">+        ],
</a>         expressions: [
<a href="#h31-0-13" id="h31-0-13" class="d">-            (
</a><a href="#h31-0-14" id="h31-0-14" class="d">-                Add(
</a><a href="#h31-0-15" id="h31-0-15" class="i">+            Add(
</a><a href="#h31-0-16" id="h31-0-16" class="i">+                Constant(
</a><a href="#h31-0-17" id="h31-0-17" class="i">+                    Integer(
</a><a href="#h31-0-18" id="h31-0-18" class="i">+                        1,
</a><a href="#h31-0-19" id="h31-0-19" class="i">+                    ),
</a><a href="#h31-0-20" id="h31-0-20" class="i">+                ),
</a><a href="#h31-0-21" id="h31-0-21" class="i">+                Multiply(
</a>                     Constant(
                         Integer(
<a href="#h31-0-24" id="h31-0-24" class="d">-                            1,
</a><a href="#h31-0-25" id="h31-0-25" class="i">+                            2,
</a>                         ),
                     ),
<a href="#h31-0-28" id="h31-0-28" class="d">-                    Multiply(
</a><a href="#h31-0-29" id="h31-0-29" class="d">-                        Constant(
</a><a href="#h31-0-30" id="h31-0-30" class="d">-                            Integer(
</a><a href="#h31-0-31" id="h31-0-31" class="d">-                                2,
</a><a href="#h31-0-32" id="h31-0-32" class="d">-                            ),
</a><a href="#h31-0-33" id="h31-0-33" class="d">-                        ),
</a><a href="#h31-0-34" id="h31-0-34" class="d">-                        Constant(
</a><a href="#h31-0-35" id="h31-0-35" class="d">-                            Integer(
</a><a href="#h31-0-36" id="h31-0-36" class="d">-                                3,
</a><a href="#h31-0-37" id="h31-0-37" class="d">-                            ),
</a><a href="#h31-0-38" id="h31-0-38" class="i">+                    Constant(
</a><a href="#h31-0-39" id="h31-0-39" class="i">+                        Integer(
</a><a href="#h31-0-40" id="h31-0-40" class="i">+                            3,
</a>                         ),
                     ),
                 ),
<a href="#h31-0-44" id="h31-0-44" class="d">-                None,
</a>             ),
<a href="#h31-0-46" id="h31-0-46" class="d">-            (
</a><a href="#h31-0-47" id="h31-0-47" class="d">-                Subtract(
</a><a href="#h31-0-48" id="h31-0-48" class="d">-                    Constant(
</a><a href="#h31-0-49" id="h31-0-49" class="d">-                        Integer(
</a><a href="#h31-0-50" id="h31-0-50" class="d">-                            2020,
</a><a href="#h31-0-51" id="h31-0-51" class="d">-                        ),
</a><a href="#h31-0-52" id="h31-0-52" class="i">+            Subtract(
</a><a href="#h31-0-53" id="h31-0-53" class="i">+                Constant(
</a><a href="#h31-0-54" id="h31-0-54" class="i">+                    Integer(
</a><a href="#h31-0-55" id="h31-0-55" class="i">+                        2020,
</a>                     ),
<a href="#h31-0-57" id="h31-0-57" class="d">-                    Field(
</a><a href="#h31-0-58" id="h31-0-58" class="d">-                        4,
</a><a href="#h31-0-59" id="h31-0-59" class="d">-                        Some(
</a><a href="#h31-0-60" id="h31-0-60" class="d">-                            (
</a><a href="#h31-0-61" id="h31-0-61" class="d">-                                None,
</a><a href="#h31-0-62" id="h31-0-62" class="d">-                                &quot;released&quot;,
</a><a href="#h31-0-63" id="h31-0-63" class="d">-                            ),
</a><a href="#h31-0-64" id="h31-0-64" class="i">+                ),
</a><a href="#h31-0-65" id="h31-0-65" class="i">+                Field(
</a><a href="#h31-0-66" id="h31-0-66" class="i">+                    4,
</a><a href="#h31-0-67" id="h31-0-67" class="i">+                    Some(
</a><a href="#h31-0-68" id="h31-0-68" class="i">+                        (
</a><a href="#h31-0-69" id="h31-0-69" class="i">+                            None,
</a><a href="#h31-0-70" id="h31-0-70" class="i">+                            &quot;released&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h31-0-74" id="h31-0-74" class="d">-                Some(
</a><a href="#h31-0-75" id="h31-0-75" class="d">-                    &quot;age&quot;,
</a><a href="#h31-0-76" id="h31-0-76" class="d">-                ),
</a>             ),
         ],
     },
<a href="#h31-1" id="h31-1" class="h">@@ -291,34 +292,35 @@ Optimized plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h31-1-3" id="h31-1-3" class="i">+        labels: [
</a><a href="#h31-1-4" id="h31-1-4" class="i">+            None,
</a><a href="#h31-1-5" id="h31-1-5" class="i">+            Some(
</a><a href="#h31-1-6" id="h31-1-6" class="i">+                (
</a><a href="#h31-1-7" id="h31-1-7" class="i">+                    None,
</a><a href="#h31-1-8" id="h31-1-8" class="i">+                    &quot;age&quot;,
</a><a href="#h31-1-9" id="h31-1-9" class="i">+                ),
</a><a href="#h31-1-10" id="h31-1-10" class="i">+            ),
</a><a href="#h31-1-11" id="h31-1-11" class="i">+        ],
</a>         expressions: [
<a href="#h31-1-13" id="h31-1-13" class="d">-            (
</a><a href="#h31-1-14" id="h31-1-14" class="i">+            Constant(
</a><a href="#h31-1-15" id="h31-1-15" class="i">+                Integer(
</a><a href="#h31-1-16" id="h31-1-16" class="i">+                    7,
</a><a href="#h31-1-17" id="h31-1-17" class="i">+                ),
</a><a href="#h31-1-18" id="h31-1-18" class="i">+            ),
</a><a href="#h31-1-19" id="h31-1-19" class="i">+            Subtract(
</a>                 Constant(
                     Integer(
<a href="#h31-1-22" id="h31-1-22" class="d">-                        7,
</a><a href="#h31-1-23" id="h31-1-23" class="i">+                        2020,
</a>                     ),
                 ),
<a href="#h31-1-26" id="h31-1-26" class="d">-                None,
</a><a href="#h31-1-27" id="h31-1-27" class="d">-            ),
</a><a href="#h31-1-28" id="h31-1-28" class="d">-            (
</a><a href="#h31-1-29" id="h31-1-29" class="d">-                Subtract(
</a><a href="#h31-1-30" id="h31-1-30" class="d">-                    Constant(
</a><a href="#h31-1-31" id="h31-1-31" class="d">-                        Integer(
</a><a href="#h31-1-32" id="h31-1-32" class="d">-                            2020,
</a><a href="#h31-1-33" id="h31-1-33" class="i">+                Field(
</a><a href="#h31-1-34" id="h31-1-34" class="i">+                    4,
</a><a href="#h31-1-35" id="h31-1-35" class="i">+                    Some(
</a><a href="#h31-1-36" id="h31-1-36" class="i">+                        (
</a><a href="#h31-1-37" id="h31-1-37" class="i">+                            None,
</a><a href="#h31-1-38" id="h31-1-38" class="i">+                            &quot;released&quot;,
</a>                         ),
                     ),
<a href="#h31-1-41" id="h31-1-41" class="d">-                    Field(
</a><a href="#h31-1-42" id="h31-1-42" class="d">-                        4,
</a><a href="#h31-1-43" id="h31-1-43" class="d">-                        Some(
</a><a href="#h31-1-44" id="h31-1-44" class="d">-                            (
</a><a href="#h31-1-45" id="h31-1-45" class="d">-                                None,
</a><a href="#h31-1-46" id="h31-1-46" class="d">-                                &quot;released&quot;,
</a><a href="#h31-1-47" id="h31-1-47" class="d">-                            ),
</a><a href="#h31-1-48" id="h31-1-48" class="d">-                        ),
</a><a href="#h31-1-49" id="h31-1-49" class="d">-                    ),
</a><a href="#h31-1-50" id="h31-1-50" class="d">-                ),
</a><a href="#h31-1-51" id="h31-1-51" class="d">-                Some(
</a><a href="#h31-1-52" id="h31-1-52" class="d">-                    &quot;age&quot;,
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/expr_static.html">tests/sql/query/expr_static</a> b/<a href="../file/tests/sql/query/expr_static.html">tests/sql/query/expr_static</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -67,44 +67,45 @@ AST: Select {
</a> Plan: Select(
     Projection {
         source: Nothing,
<a href="#h32-0-3" id="h32-0-3" class="i">+        labels: [
</a><a href="#h32-0-4" id="h32-0-4" class="i">+            None,
</a><a href="#h32-0-5" id="h32-0-5" class="i">+            Some(
</a><a href="#h32-0-6" id="h32-0-6" class="i">+                (
</a><a href="#h32-0-7" id="h32-0-7" class="i">+                    None,
</a><a href="#h32-0-8" id="h32-0-8" class="i">+                    &quot;nope&quot;,
</a><a href="#h32-0-9" id="h32-0-9" class="i">+                ),
</a><a href="#h32-0-10" id="h32-0-10" class="i">+            ),
</a><a href="#h32-0-11" id="h32-0-11" class="i">+        ],
</a>         expressions: [
<a href="#h32-0-13" id="h32-0-13" class="d">-            (
</a><a href="#h32-0-14" id="h32-0-14" class="d">-                Add(
</a><a href="#h32-0-15" id="h32-0-15" class="i">+            Add(
</a><a href="#h32-0-16" id="h32-0-16" class="i">+                Constant(
</a><a href="#h32-0-17" id="h32-0-17" class="i">+                    Integer(
</a><a href="#h32-0-18" id="h32-0-18" class="i">+                        1,
</a><a href="#h32-0-19" id="h32-0-19" class="i">+                    ),
</a><a href="#h32-0-20" id="h32-0-20" class="i">+                ),
</a><a href="#h32-0-21" id="h32-0-21" class="i">+                Multiply(
</a>                     Constant(
                         Integer(
<a href="#h32-0-24" id="h32-0-24" class="d">-                            1,
</a><a href="#h32-0-25" id="h32-0-25" class="i">+                            2,
</a>                         ),
                     ),
<a href="#h32-0-28" id="h32-0-28" class="d">-                    Multiply(
</a><a href="#h32-0-29" id="h32-0-29" class="d">-                        Constant(
</a><a href="#h32-0-30" id="h32-0-30" class="d">-                            Integer(
</a><a href="#h32-0-31" id="h32-0-31" class="d">-                                2,
</a><a href="#h32-0-32" id="h32-0-32" class="d">-                            ),
</a><a href="#h32-0-33" id="h32-0-33" class="d">-                        ),
</a><a href="#h32-0-34" id="h32-0-34" class="d">-                        Constant(
</a><a href="#h32-0-35" id="h32-0-35" class="d">-                            Integer(
</a><a href="#h32-0-36" id="h32-0-36" class="d">-                                3,
</a><a href="#h32-0-37" id="h32-0-37" class="d">-                            ),
</a><a href="#h32-0-38" id="h32-0-38" class="i">+                    Constant(
</a><a href="#h32-0-39" id="h32-0-39" class="i">+                        Integer(
</a><a href="#h32-0-40" id="h32-0-40" class="i">+                            3,
</a>                         ),
                     ),
                 ),
<a href="#h32-0-44" id="h32-0-44" class="d">-                None,
</a>             ),
<a href="#h32-0-46" id="h32-0-46" class="d">-            (
</a><a href="#h32-0-47" id="h32-0-47" class="d">-                Like(
</a><a href="#h32-0-48" id="h32-0-48" class="d">-                    Constant(
</a><a href="#h32-0-49" id="h32-0-49" class="d">-                        String(
</a><a href="#h32-0-50" id="h32-0-50" class="d">-                            &quot;abc&quot;,
</a><a href="#h32-0-51" id="h32-0-51" class="d">-                        ),
</a><a href="#h32-0-52" id="h32-0-52" class="d">-                    ),
</a><a href="#h32-0-53" id="h32-0-53" class="d">-                    Constant(
</a><a href="#h32-0-54" id="h32-0-54" class="d">-                        String(
</a><a href="#h32-0-55" id="h32-0-55" class="d">-                            &quot;x%&quot;,
</a><a href="#h32-0-56" id="h32-0-56" class="d">-                        ),
</a><a href="#h32-0-57" id="h32-0-57" class="i">+            Like(
</a><a href="#h32-0-58" id="h32-0-58" class="i">+                Constant(
</a><a href="#h32-0-59" id="h32-0-59" class="i">+                    String(
</a><a href="#h32-0-60" id="h32-0-60" class="i">+                        &quot;abc&quot;,
</a>                     ),
                 ),
<a href="#h32-0-63" id="h32-0-63" class="d">-                Some(
</a><a href="#h32-0-64" id="h32-0-64" class="d">-                    &quot;nope&quot;,
</a><a href="#h32-0-65" id="h32-0-65" class="i">+                Constant(
</a><a href="#h32-0-66" id="h32-0-66" class="i">+                    String(
</a><a href="#h32-0-67" id="h32-0-67" class="i">+                        &quot;x%&quot;,
</a><a href="#h32-0-68" id="h32-0-68" class="i">+                    ),
</a>                 ),
             ),
         ],
<a href="#h32-1" id="h32-1" class="h">@@ -114,23 +115,24 @@ Plan: Select(
</a> Optimized plan: Select(
     Projection {
         source: Nothing,
<a href="#h32-1-3" id="h32-1-3" class="d">-        expressions: [
</a><a href="#h32-1-4" id="h32-1-4" class="d">-            (
</a><a href="#h32-1-5" id="h32-1-5" class="d">-                Constant(
</a><a href="#h32-1-6" id="h32-1-6" class="d">-                    Integer(
</a><a href="#h32-1-7" id="h32-1-7" class="d">-                        7,
</a><a href="#h32-1-8" id="h32-1-8" class="d">-                    ),
</a><a href="#h32-1-9" id="h32-1-9" class="i">+        labels: [
</a><a href="#h32-1-10" id="h32-1-10" class="i">+            None,
</a><a href="#h32-1-11" id="h32-1-11" class="i">+            Some(
</a><a href="#h32-1-12" id="h32-1-12" class="i">+                (
</a><a href="#h32-1-13" id="h32-1-13" class="i">+                    None,
</a><a href="#h32-1-14" id="h32-1-14" class="i">+                    &quot;nope&quot;,
</a>                 ),
<a href="#h32-1-16" id="h32-1-16" class="d">-                None,
</a>             ),
<a href="#h32-1-18" id="h32-1-18" class="d">-            (
</a><a href="#h32-1-19" id="h32-1-19" class="d">-                Constant(
</a><a href="#h32-1-20" id="h32-1-20" class="d">-                    Boolean(
</a><a href="#h32-1-21" id="h32-1-21" class="d">-                        false,
</a><a href="#h32-1-22" id="h32-1-22" class="d">-                    ),
</a><a href="#h32-1-23" id="h32-1-23" class="i">+        ],
</a><a href="#h32-1-24" id="h32-1-24" class="i">+        expressions: [
</a><a href="#h32-1-25" id="h32-1-25" class="i">+            Constant(
</a><a href="#h32-1-26" id="h32-1-26" class="i">+                Integer(
</a><a href="#h32-1-27" id="h32-1-27" class="i">+                    7,
</a>                 ),
<a href="#h32-1-29" id="h32-1-29" class="d">-                Some(
</a><a href="#h32-1-30" id="h32-1-30" class="d">-                    &quot;nope&quot;,
</a><a href="#h32-1-31" id="h32-1-31" class="i">+            ),
</a><a href="#h32-1-32" id="h32-1-32" class="i">+            Constant(
</a><a href="#h32-1-33" id="h32-1-33" class="i">+                Boolean(
</a><a href="#h32-1-34" id="h32-1-34" class="i">+                    false,
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a> b/<a href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -201,34 +201,32 @@ Plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h33-0-3" id="h33-0-3" class="i">+        labels: [
</a><a href="#h33-0-4" id="h33-0-4" class="i">+            None,
</a><a href="#h33-0-5" id="h33-0-5" class="i">+            None,
</a><a href="#h33-0-6" id="h33-0-6" class="i">+        ],
</a>         expressions: [
<a href="#h33-0-8" id="h33-0-8" class="d">-            (
</a><a href="#h33-0-9" id="h33-0-9" class="d">-                Field(
</a><a href="#h33-0-10" id="h33-0-10" class="d">-                    0,
</a><a href="#h33-0-11" id="h33-0-11" class="d">-                    Some(
</a><a href="#h33-0-12" id="h33-0-12" class="d">-                        (
</a><a href="#h33-0-13" id="h33-0-13" class="d">-                            Some(
</a><a href="#h33-0-14" id="h33-0-14" class="d">-                                &quot;m&quot;,
</a><a href="#h33-0-15" id="h33-0-15" class="d">-                            ),
</a><a href="#h33-0-16" id="h33-0-16" class="d">-                            &quot;id&quot;,
</a><a href="#h33-0-17" id="h33-0-17" class="i">+            Field(
</a><a href="#h33-0-18" id="h33-0-18" class="i">+                0,
</a><a href="#h33-0-19" id="h33-0-19" class="i">+                Some(
</a><a href="#h33-0-20" id="h33-0-20" class="i">+                    (
</a><a href="#h33-0-21" id="h33-0-21" class="i">+                        Some(
</a><a href="#h33-0-22" id="h33-0-22" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h33-0-24" id="h33-0-24" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h33-0-27" id="h33-0-27" class="d">-                None,
</a>             ),
<a href="#h33-0-29" id="h33-0-29" class="d">-            (
</a><a href="#h33-0-30" id="h33-0-30" class="d">-                Field(
</a><a href="#h33-0-31" id="h33-0-31" class="d">-                    7,
</a><a href="#h33-0-32" id="h33-0-32" class="d">-                    Some(
</a><a href="#h33-0-33" id="h33-0-33" class="d">-                        (
</a><a href="#h33-0-34" id="h33-0-34" class="d">-                            Some(
</a><a href="#h33-0-35" id="h33-0-35" class="d">-                                &quot;g&quot;,
</a><a href="#h33-0-36" id="h33-0-36" class="d">-                            ),
</a><a href="#h33-0-37" id="h33-0-37" class="d">-                            &quot;id&quot;,
</a><a href="#h33-0-38" id="h33-0-38" class="i">+            Field(
</a><a href="#h33-0-39" id="h33-0-39" class="i">+                7,
</a><a href="#h33-0-40" id="h33-0-40" class="i">+                Some(
</a><a href="#h33-0-41" id="h33-0-41" class="i">+                    (
</a><a href="#h33-0-42" id="h33-0-42" class="i">+                        Some(
</a><a href="#h33-0-43" id="h33-0-43" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h33-0-45" id="h33-0-45" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h33-0-48" id="h33-0-48" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h33-1" id="h33-1" class="h">@@ -354,34 +352,32 @@ Optimized plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h33-1-3" id="h33-1-3" class="i">+        labels: [
</a><a href="#h33-1-4" id="h33-1-4" class="i">+            None,
</a><a href="#h33-1-5" id="h33-1-5" class="i">+            None,
</a><a href="#h33-1-6" id="h33-1-6" class="i">+        ],
</a>         expressions: [
<a href="#h33-1-8" id="h33-1-8" class="d">-            (
</a><a href="#h33-1-9" id="h33-1-9" class="d">-                Field(
</a><a href="#h33-1-10" id="h33-1-10" class="d">-                    0,
</a><a href="#h33-1-11" id="h33-1-11" class="d">-                    Some(
</a><a href="#h33-1-12" id="h33-1-12" class="d">-                        (
</a><a href="#h33-1-13" id="h33-1-13" class="d">-                            Some(
</a><a href="#h33-1-14" id="h33-1-14" class="d">-                                &quot;m&quot;,
</a><a href="#h33-1-15" id="h33-1-15" class="d">-                            ),
</a><a href="#h33-1-16" id="h33-1-16" class="d">-                            &quot;id&quot;,
</a><a href="#h33-1-17" id="h33-1-17" class="i">+            Field(
</a><a href="#h33-1-18" id="h33-1-18" class="i">+                0,
</a><a href="#h33-1-19" id="h33-1-19" class="i">+                Some(
</a><a href="#h33-1-20" id="h33-1-20" class="i">+                    (
</a><a href="#h33-1-21" id="h33-1-21" class="i">+                        Some(
</a><a href="#h33-1-22" id="h33-1-22" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h33-1-24" id="h33-1-24" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h33-1-27" id="h33-1-27" class="d">-                None,
</a>             ),
<a href="#h33-1-29" id="h33-1-29" class="d">-            (
</a><a href="#h33-1-30" id="h33-1-30" class="d">-                Field(
</a><a href="#h33-1-31" id="h33-1-31" class="d">-                    7,
</a><a href="#h33-1-32" id="h33-1-32" class="d">-                    Some(
</a><a href="#h33-1-33" id="h33-1-33" class="d">-                        (
</a><a href="#h33-1-34" id="h33-1-34" class="d">-                            Some(
</a><a href="#h33-1-35" id="h33-1-35" class="d">-                                &quot;g&quot;,
</a><a href="#h33-1-36" id="h33-1-36" class="d">-                            ),
</a><a href="#h33-1-37" id="h33-1-37" class="d">-                            &quot;id&quot;,
</a><a href="#h33-1-38" id="h33-1-38" class="i">+            Field(
</a><a href="#h33-1-39" id="h33-1-39" class="i">+                7,
</a><a href="#h33-1-40" id="h33-1-40" class="i">+                Some(
</a><a href="#h33-1-41" id="h33-1-41" class="i">+                    (
</a><a href="#h33-1-42" id="h33-1-42" class="i">+                        Some(
</a><a href="#h33-1-43" id="h33-1-43" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h33-1-45" id="h33-1-45" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h33-1-48" id="h33-1-48" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h34" href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a> b/<a href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -130,30 +130,28 @@ Plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h34-0-3" id="h34-0-3" class="i">+        labels: [
</a><a href="#h34-0-4" id="h34-0-4" class="i">+            None,
</a><a href="#h34-0-5" id="h34-0-5" class="i">+            None,
</a><a href="#h34-0-6" id="h34-0-6" class="i">+        ],
</a>         expressions: [
<a href="#h34-0-8" id="h34-0-8" class="d">-            (
</a><a href="#h34-0-9" id="h34-0-9" class="d">-                Field(
</a><a href="#h34-0-10" id="h34-0-10" class="d">-                    0,
</a><a href="#h34-0-11" id="h34-0-11" class="d">-                    Some(
</a><a href="#h34-0-12" id="h34-0-12" class="d">-                        (
</a><a href="#h34-0-13" id="h34-0-13" class="d">-                            None,
</a><a href="#h34-0-14" id="h34-0-14" class="d">-                            &quot;id&quot;,
</a><a href="#h34-0-15" id="h34-0-15" class="d">-                        ),
</a><a href="#h34-0-16" id="h34-0-16" class="i">+            Field(
</a><a href="#h34-0-17" id="h34-0-17" class="i">+                0,
</a><a href="#h34-0-18" id="h34-0-18" class="i">+                Some(
</a><a href="#h34-0-19" id="h34-0-19" class="i">+                    (
</a><a href="#h34-0-20" id="h34-0-20" class="i">+                        None,
</a><a href="#h34-0-21" id="h34-0-21" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h34-0-24" id="h34-0-24" class="d">-                None,
</a>             ),
<a href="#h34-0-26" id="h34-0-26" class="d">-            (
</a><a href="#h34-0-27" id="h34-0-27" class="d">-                Field(
</a><a href="#h34-0-28" id="h34-0-28" class="d">-                    1,
</a><a href="#h34-0-29" id="h34-0-29" class="d">-                    Some(
</a><a href="#h34-0-30" id="h34-0-30" class="d">-                        (
</a><a href="#h34-0-31" id="h34-0-31" class="d">-                            None,
</a><a href="#h34-0-32" id="h34-0-32" class="d">-                            &quot;title&quot;,
</a><a href="#h34-0-33" id="h34-0-33" class="d">-                        ),
</a><a href="#h34-0-34" id="h34-0-34" class="i">+            Field(
</a><a href="#h34-0-35" id="h34-0-35" class="i">+                1,
</a><a href="#h34-0-36" id="h34-0-36" class="i">+                Some(
</a><a href="#h34-0-37" id="h34-0-37" class="i">+                    (
</a><a href="#h34-0-38" id="h34-0-38" class="i">+                        None,
</a><a href="#h34-0-39" id="h34-0-39" class="i">+                        &quot;title&quot;,
</a>                     ),
                 ),
<a href="#h34-0-42" id="h34-0-42" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h34-1" id="h34-1" class="h">@@ -242,30 +240,28 @@ Optimized plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h34-1-3" id="h34-1-3" class="i">+        labels: [
</a><a href="#h34-1-4" id="h34-1-4" class="i">+            None,
</a><a href="#h34-1-5" id="h34-1-5" class="i">+            None,
</a><a href="#h34-1-6" id="h34-1-6" class="i">+        ],
</a>         expressions: [
<a href="#h34-1-8" id="h34-1-8" class="d">-            (
</a><a href="#h34-1-9" id="h34-1-9" class="d">-                Field(
</a><a href="#h34-1-10" id="h34-1-10" class="d">-                    0,
</a><a href="#h34-1-11" id="h34-1-11" class="d">-                    Some(
</a><a href="#h34-1-12" id="h34-1-12" class="d">-                        (
</a><a href="#h34-1-13" id="h34-1-13" class="d">-                            None,
</a><a href="#h34-1-14" id="h34-1-14" class="d">-                            &quot;id&quot;,
</a><a href="#h34-1-15" id="h34-1-15" class="d">-                        ),
</a><a href="#h34-1-16" id="h34-1-16" class="i">+            Field(
</a><a href="#h34-1-17" id="h34-1-17" class="i">+                0,
</a><a href="#h34-1-18" id="h34-1-18" class="i">+                Some(
</a><a href="#h34-1-19" id="h34-1-19" class="i">+                    (
</a><a href="#h34-1-20" id="h34-1-20" class="i">+                        None,
</a><a href="#h34-1-21" id="h34-1-21" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h34-1-24" id="h34-1-24" class="d">-                None,
</a>             ),
<a href="#h34-1-26" id="h34-1-26" class="d">-            (
</a><a href="#h34-1-27" id="h34-1-27" class="d">-                Field(
</a><a href="#h34-1-28" id="h34-1-28" class="d">-                    1,
</a><a href="#h34-1-29" id="h34-1-29" class="d">-                    Some(
</a><a href="#h34-1-30" id="h34-1-30" class="d">-                        (
</a><a href="#h34-1-31" id="h34-1-31" class="d">-                            None,
</a><a href="#h34-1-32" id="h34-1-32" class="d">-                            &quot;title&quot;,
</a><a href="#h34-1-33" id="h34-1-33" class="d">-                        ),
</a><a href="#h34-1-34" id="h34-1-34" class="i">+            Field(
</a><a href="#h34-1-35" id="h34-1-35" class="i">+                1,
</a><a href="#h34-1-36" id="h34-1-36" class="i">+                Some(
</a><a href="#h34-1-37" id="h34-1-37" class="i">+                    (
</a><a href="#h34-1-38" id="h34-1-38" class="i">+                        None,
</a><a href="#h34-1-39" id="h34-1-39" class="i">+                        &quot;title&quot;,
</a>                     ),
                 ),
<a href="#h34-1-42" id="h34-1-42" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h35" href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a> b/<a href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -125,20 +125,20 @@ Plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h35-0-3" id="h35-0-3" class="i">+        labels: [
</a><a href="#h35-0-4" id="h35-0-4" class="i">+            None,
</a><a href="#h35-0-5" id="h35-0-5" class="i">+        ],
</a>         expressions: [
<a href="#h35-0-7" id="h35-0-7" class="d">-            (
</a><a href="#h35-0-8" id="h35-0-8" class="d">-                Field(
</a><a href="#h35-0-9" id="h35-0-9" class="d">-                    0,
</a><a href="#h35-0-10" id="h35-0-10" class="d">-                    Some(
</a><a href="#h35-0-11" id="h35-0-11" class="d">-                        (
</a><a href="#h35-0-12" id="h35-0-12" class="d">-                            Some(
</a><a href="#h35-0-13" id="h35-0-13" class="d">-                                &quot;movies&quot;,
</a><a href="#h35-0-14" id="h35-0-14" class="d">-                            ),
</a><a href="#h35-0-15" id="h35-0-15" class="d">-                            &quot;id&quot;,
</a><a href="#h35-0-16" id="h35-0-16" class="i">+            Field(
</a><a href="#h35-0-17" id="h35-0-17" class="i">+                0,
</a><a href="#h35-0-18" id="h35-0-18" class="i">+                Some(
</a><a href="#h35-0-19" id="h35-0-19" class="i">+                    (
</a><a href="#h35-0-20" id="h35-0-20" class="i">+                        Some(
</a><a href="#h35-0-21" id="h35-0-21" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h35-0-23" id="h35-0-23" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h35-0-26" id="h35-0-26" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h35-1" id="h35-1" class="h">@@ -227,20 +227,20 @@ Optimized plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h35-1-3" id="h35-1-3" class="i">+        labels: [
</a><a href="#h35-1-4" id="h35-1-4" class="i">+            None,
</a><a href="#h35-1-5" id="h35-1-5" class="i">+        ],
</a>         expressions: [
<a href="#h35-1-7" id="h35-1-7" class="d">-            (
</a><a href="#h35-1-8" id="h35-1-8" class="d">-                Field(
</a><a href="#h35-1-9" id="h35-1-9" class="d">-                    0,
</a><a href="#h35-1-10" id="h35-1-10" class="d">-                    Some(
</a><a href="#h35-1-11" id="h35-1-11" class="d">-                        (
</a><a href="#h35-1-12" id="h35-1-12" class="d">-                            Some(
</a><a href="#h35-1-13" id="h35-1-13" class="d">-                                &quot;movies&quot;,
</a><a href="#h35-1-14" id="h35-1-14" class="d">-                            ),
</a><a href="#h35-1-15" id="h35-1-15" class="d">-                            &quot;id&quot;,
</a><a href="#h35-1-16" id="h35-1-16" class="i">+            Field(
</a><a href="#h35-1-17" id="h35-1-17" class="i">+                0,
</a><a href="#h35-1-18" id="h35-1-18" class="i">+                Some(
</a><a href="#h35-1-19" id="h35-1-19" class="i">+                    (
</a><a href="#h35-1-20" id="h35-1-20" class="i">+                        Some(
</a><a href="#h35-1-21" id="h35-1-21" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h35-1-23" id="h35-1-23" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h35-1-26" id="h35-1-26" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h36" href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a> b/<a href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -193,34 +193,32 @@ Plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h36-0-3" id="h36-0-3" class="i">+        labels: [
</a><a href="#h36-0-4" id="h36-0-4" class="i">+            None,
</a><a href="#h36-0-5" id="h36-0-5" class="i">+            None,
</a><a href="#h36-0-6" id="h36-0-6" class="i">+        ],
</a>         expressions: [
<a href="#h36-0-8" id="h36-0-8" class="d">-            (
</a><a href="#h36-0-9" id="h36-0-9" class="d">-                Field(
</a><a href="#h36-0-10" id="h36-0-10" class="d">-                    0,
</a><a href="#h36-0-11" id="h36-0-11" class="d">-                    Some(
</a><a href="#h36-0-12" id="h36-0-12" class="d">-                        (
</a><a href="#h36-0-13" id="h36-0-13" class="d">-                            Some(
</a><a href="#h36-0-14" id="h36-0-14" class="d">-                                &quot;movies&quot;,
</a><a href="#h36-0-15" id="h36-0-15" class="d">-                            ),
</a><a href="#h36-0-16" id="h36-0-16" class="d">-                            &quot;id&quot;,
</a><a href="#h36-0-17" id="h36-0-17" class="i">+            Field(
</a><a href="#h36-0-18" id="h36-0-18" class="i">+                0,
</a><a href="#h36-0-19" id="h36-0-19" class="i">+                Some(
</a><a href="#h36-0-20" id="h36-0-20" class="i">+                    (
</a><a href="#h36-0-21" id="h36-0-21" class="i">+                        Some(
</a><a href="#h36-0-22" id="h36-0-22" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h36-0-24" id="h36-0-24" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h36-0-27" id="h36-0-27" class="d">-                None,
</a>             ),
<a href="#h36-0-29" id="h36-0-29" class="d">-            (
</a><a href="#h36-0-30" id="h36-0-30" class="d">-                Field(
</a><a href="#h36-0-31" id="h36-0-31" class="d">-                    7,
</a><a href="#h36-0-32" id="h36-0-32" class="d">-                    Some(
</a><a href="#h36-0-33" id="h36-0-33" class="d">-                        (
</a><a href="#h36-0-34" id="h36-0-34" class="d">-                            Some(
</a><a href="#h36-0-35" id="h36-0-35" class="d">-                                &quot;genres&quot;,
</a><a href="#h36-0-36" id="h36-0-36" class="d">-                            ),
</a><a href="#h36-0-37" id="h36-0-37" class="d">-                            &quot;id&quot;,
</a><a href="#h36-0-38" id="h36-0-38" class="i">+            Field(
</a><a href="#h36-0-39" id="h36-0-39" class="i">+                7,
</a><a href="#h36-0-40" id="h36-0-40" class="i">+                Some(
</a><a href="#h36-0-41" id="h36-0-41" class="i">+                    (
</a><a href="#h36-0-42" id="h36-0-42" class="i">+                        Some(
</a><a href="#h36-0-43" id="h36-0-43" class="i">+                            &quot;genres&quot;,
</a>                         ),
<a href="#h36-0-45" id="h36-0-45" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h36-0-48" id="h36-0-48" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h36-1" id="h36-1" class="h">@@ -342,34 +340,32 @@ Optimized plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h36-1-3" id="h36-1-3" class="i">+        labels: [
</a><a href="#h36-1-4" id="h36-1-4" class="i">+            None,
</a><a href="#h36-1-5" id="h36-1-5" class="i">+            None,
</a><a href="#h36-1-6" id="h36-1-6" class="i">+        ],
</a>         expressions: [
<a href="#h36-1-8" id="h36-1-8" class="d">-            (
</a><a href="#h36-1-9" id="h36-1-9" class="d">-                Field(
</a><a href="#h36-1-10" id="h36-1-10" class="d">-                    0,
</a><a href="#h36-1-11" id="h36-1-11" class="d">-                    Some(
</a><a href="#h36-1-12" id="h36-1-12" class="d">-                        (
</a><a href="#h36-1-13" id="h36-1-13" class="d">-                            Some(
</a><a href="#h36-1-14" id="h36-1-14" class="d">-                                &quot;movies&quot;,
</a><a href="#h36-1-15" id="h36-1-15" class="d">-                            ),
</a><a href="#h36-1-16" id="h36-1-16" class="d">-                            &quot;id&quot;,
</a><a href="#h36-1-17" id="h36-1-17" class="i">+            Field(
</a><a href="#h36-1-18" id="h36-1-18" class="i">+                0,
</a><a href="#h36-1-19" id="h36-1-19" class="i">+                Some(
</a><a href="#h36-1-20" id="h36-1-20" class="i">+                    (
</a><a href="#h36-1-21" id="h36-1-21" class="i">+                        Some(
</a><a href="#h36-1-22" id="h36-1-22" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h36-1-24" id="h36-1-24" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h36-1-27" id="h36-1-27" class="d">-                None,
</a>             ),
<a href="#h36-1-29" id="h36-1-29" class="d">-            (
</a><a href="#h36-1-30" id="h36-1-30" class="d">-                Field(
</a><a href="#h36-1-31" id="h36-1-31" class="d">-                    7,
</a><a href="#h36-1-32" id="h36-1-32" class="d">-                    Some(
</a><a href="#h36-1-33" id="h36-1-33" class="d">-                        (
</a><a href="#h36-1-34" id="h36-1-34" class="d">-                            Some(
</a><a href="#h36-1-35" id="h36-1-35" class="d">-                                &quot;genres&quot;,
</a><a href="#h36-1-36" id="h36-1-36" class="d">-                            ),
</a><a href="#h36-1-37" id="h36-1-37" class="d">-                            &quot;id&quot;,
</a><a href="#h36-1-38" id="h36-1-38" class="i">+            Field(
</a><a href="#h36-1-39" id="h36-1-39" class="i">+                7,
</a><a href="#h36-1-40" id="h36-1-40" class="i">+                Some(
</a><a href="#h36-1-41" id="h36-1-41" class="i">+                    (
</a><a href="#h36-1-42" id="h36-1-42" class="i">+                        Some(
</a><a href="#h36-1-43" id="h36-1-43" class="i">+                            &quot;genres&quot;,
</a>                         ),
<a href="#h36-1-45" id="h36-1-45" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h36-1-48" id="h36-1-48" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h37" href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a> b/<a href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -123,18 +123,18 @@ Plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h37-0-3" id="h37-0-3" class="i">+        labels: [
</a><a href="#h37-0-4" id="h37-0-4" class="i">+            None,
</a><a href="#h37-0-5" id="h37-0-5" class="i">+        ],
</a>         expressions: [
<a href="#h37-0-7" id="h37-0-7" class="d">-            (
</a><a href="#h37-0-8" id="h37-0-8" class="d">-                Field(
</a><a href="#h37-0-9" id="h37-0-9" class="d">-                    0,
</a><a href="#h37-0-10" id="h37-0-10" class="d">-                    Some(
</a><a href="#h37-0-11" id="h37-0-11" class="d">-                        (
</a><a href="#h37-0-12" id="h37-0-12" class="d">-                            None,
</a><a href="#h37-0-13" id="h37-0-13" class="d">-                            &quot;id&quot;,
</a><a href="#h37-0-14" id="h37-0-14" class="d">-                        ),
</a><a href="#h37-0-15" id="h37-0-15" class="i">+            Field(
</a><a href="#h37-0-16" id="h37-0-16" class="i">+                0,
</a><a href="#h37-0-17" id="h37-0-17" class="i">+                Some(
</a><a href="#h37-0-18" id="h37-0-18" class="i">+                    (
</a><a href="#h37-0-19" id="h37-0-19" class="i">+                        None,
</a><a href="#h37-0-20" id="h37-0-20" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h37-0-23" id="h37-0-23" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h37-1" id="h37-1" class="h">@@ -223,18 +223,18 @@ Optimized plan: Select(
</a>             alias: None,
             filter: None,
         },
<a href="#h37-1-3" id="h37-1-3" class="i">+        labels: [
</a><a href="#h37-1-4" id="h37-1-4" class="i">+            None,
</a><a href="#h37-1-5" id="h37-1-5" class="i">+        ],
</a>         expressions: [
<a href="#h37-1-7" id="h37-1-7" class="d">-            (
</a><a href="#h37-1-8" id="h37-1-8" class="d">-                Field(
</a><a href="#h37-1-9" id="h37-1-9" class="d">-                    0,
</a><a href="#h37-1-10" id="h37-1-10" class="d">-                    Some(
</a><a href="#h37-1-11" id="h37-1-11" class="d">-                        (
</a><a href="#h37-1-12" id="h37-1-12" class="d">-                            None,
</a><a href="#h37-1-13" id="h37-1-13" class="d">-                            &quot;id&quot;,
</a><a href="#h37-1-14" id="h37-1-14" class="d">-                        ),
</a><a href="#h37-1-15" id="h37-1-15" class="i">+            Field(
</a><a href="#h37-1-16" id="h37-1-16" class="i">+                0,
</a><a href="#h37-1-17" id="h37-1-17" class="i">+                Some(
</a><a href="#h37-1-18" id="h37-1-18" class="i">+                    (
</a><a href="#h37-1-19" id="h37-1-19" class="i">+                        None,
</a><a href="#h37-1-20" id="h37-1-20" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h37-1-23" id="h37-1-23" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h38" href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a> b/<a href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -152,37 +152,35 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h38-0-3" id="h38-0-3" class="i">+                    labels: [
</a><a href="#h38-0-4" id="h38-0-4" class="i">+                        None,
</a><a href="#h38-0-5" id="h38-0-5" class="i">+                        None,
</a><a href="#h38-0-6" id="h38-0-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h38-0-8" id="h38-0-8" class="d">-                        (
</a><a href="#h38-0-9" id="h38-0-9" class="i">+                        Field(
</a><a href="#h38-0-10" id="h38-0-10" class="i">+                            5,
</a><a href="#h38-0-11" id="h38-0-11" class="i">+                            Some(
</a><a href="#h38-0-12" id="h38-0-12" class="i">+                                (
</a><a href="#h38-0-13" id="h38-0-13" class="i">+                                    None,
</a><a href="#h38-0-14" id="h38-0-14" class="i">+                                    &quot;rating&quot;,
</a><a href="#h38-0-15" id="h38-0-15" class="i">+                                ),
</a><a href="#h38-0-16" id="h38-0-16" class="i">+                            ),
</a><a href="#h38-0-17" id="h38-0-17" class="i">+                        ),
</a><a href="#h38-0-18" id="h38-0-18" class="i">+                        Multiply(
</a>                             Field(
<a href="#h38-0-20" id="h38-0-20" class="d">-                                5,
</a><a href="#h38-0-21" id="h38-0-21" class="i">+                                2,
</a>                                 Some(
                                     (
                                         None,
<a href="#h38-0-25" id="h38-0-25" class="d">-                                        &quot;rating&quot;,
</a><a href="#h38-0-26" id="h38-0-26" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h38-0-30" id="h38-0-30" class="d">-                            None,
</a><a href="#h38-0-31" id="h38-0-31" class="d">-                        ),
</a><a href="#h38-0-32" id="h38-0-32" class="d">-                        (
</a><a href="#h38-0-33" id="h38-0-33" class="d">-                            Multiply(
</a><a href="#h38-0-34" id="h38-0-34" class="d">-                                Field(
</a><a href="#h38-0-35" id="h38-0-35" class="i">+                            Constant(
</a><a href="#h38-0-36" id="h38-0-36" class="i">+                                Integer(
</a>                                     2,
<a href="#h38-0-38" id="h38-0-38" class="d">-                                    Some(
</a><a href="#h38-0-39" id="h38-0-39" class="d">-                                        (
</a><a href="#h38-0-40" id="h38-0-40" class="d">-                                            None,
</a><a href="#h38-0-41" id="h38-0-41" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h38-0-42" id="h38-0-42" class="d">-                                        ),
</a><a href="#h38-0-43" id="h38-0-43" class="d">-                                    ),
</a><a href="#h38-0-44" id="h38-0-44" class="d">-                                ),
</a><a href="#h38-0-45" id="h38-0-45" class="d">-                                Constant(
</a><a href="#h38-0-46" id="h38-0-46" class="d">-                                    Integer(
</a><a href="#h38-0-47" id="h38-0-47" class="d">-                                        2,
</a><a href="#h38-0-48" id="h38-0-48" class="d">-                                    ),
</a>                                 ),
                             ),
<a href="#h38-0-51" id="h38-0-51" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h38-1" id="h38-1" class="h">@@ -190,17 +188,20 @@ Plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h38-1-3" id="h38-1-3" class="d">-            expressions: [
</a><a href="#h38-1-4" id="h38-1-4" class="d">-                (
</a><a href="#h38-1-5" id="h38-1-5" class="d">-                    Field(
</a><a href="#h38-1-6" id="h38-1-6" class="d">-                        0,
</a><a href="#h38-1-7" id="h38-1-7" class="i">+            labels: [
</a><a href="#h38-1-8" id="h38-1-8" class="i">+                Some(
</a><a href="#h38-1-9" id="h38-1-9" class="i">+                    (
</a>                         None,
<a href="#h38-1-11" id="h38-1-11" class="d">-                    ),
</a><a href="#h38-1-12" id="h38-1-12" class="d">-                    Some(
</a>                         &quot;rating&quot;,
                     ),
                 ),
             ],
<a href="#h38-1-17" id="h38-1-17" class="i">+            expressions: [
</a><a href="#h38-1-18" id="h38-1-18" class="i">+                Field(
</a><a href="#h38-1-19" id="h38-1-19" class="i">+                    0,
</a><a href="#h38-1-20" id="h38-1-20" class="i">+                    None,
</a><a href="#h38-1-21" id="h38-1-21" class="i">+                ),
</a><a href="#h38-1-22" id="h38-1-22" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h38-2" id="h38-2" class="h">@@ -305,37 +306,35 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h38-2-3" id="h38-2-3" class="i">+                    labels: [
</a><a href="#h38-2-4" id="h38-2-4" class="i">+                        None,
</a><a href="#h38-2-5" id="h38-2-5" class="i">+                        None,
</a><a href="#h38-2-6" id="h38-2-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h38-2-8" id="h38-2-8" class="d">-                        (
</a><a href="#h38-2-9" id="h38-2-9" class="i">+                        Field(
</a><a href="#h38-2-10" id="h38-2-10" class="i">+                            5,
</a><a href="#h38-2-11" id="h38-2-11" class="i">+                            Some(
</a><a href="#h38-2-12" id="h38-2-12" class="i">+                                (
</a><a href="#h38-2-13" id="h38-2-13" class="i">+                                    None,
</a><a href="#h38-2-14" id="h38-2-14" class="i">+                                    &quot;rating&quot;,
</a><a href="#h38-2-15" id="h38-2-15" class="i">+                                ),
</a><a href="#h38-2-16" id="h38-2-16" class="i">+                            ),
</a><a href="#h38-2-17" id="h38-2-17" class="i">+                        ),
</a><a href="#h38-2-18" id="h38-2-18" class="i">+                        Multiply(
</a>                             Field(
<a href="#h38-2-20" id="h38-2-20" class="d">-                                5,
</a><a href="#h38-2-21" id="h38-2-21" class="i">+                                2,
</a>                                 Some(
                                     (
                                         None,
<a href="#h38-2-25" id="h38-2-25" class="d">-                                        &quot;rating&quot;,
</a><a href="#h38-2-26" id="h38-2-26" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h38-2-30" id="h38-2-30" class="d">-                            None,
</a><a href="#h38-2-31" id="h38-2-31" class="d">-                        ),
</a><a href="#h38-2-32" id="h38-2-32" class="d">-                        (
</a><a href="#h38-2-33" id="h38-2-33" class="d">-                            Multiply(
</a><a href="#h38-2-34" id="h38-2-34" class="d">-                                Field(
</a><a href="#h38-2-35" id="h38-2-35" class="i">+                            Constant(
</a><a href="#h38-2-36" id="h38-2-36" class="i">+                                Integer(
</a>                                     2,
<a href="#h38-2-38" id="h38-2-38" class="d">-                                    Some(
</a><a href="#h38-2-39" id="h38-2-39" class="d">-                                        (
</a><a href="#h38-2-40" id="h38-2-40" class="d">-                                            None,
</a><a href="#h38-2-41" id="h38-2-41" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h38-2-42" id="h38-2-42" class="d">-                                        ),
</a><a href="#h38-2-43" id="h38-2-43" class="d">-                                    ),
</a><a href="#h38-2-44" id="h38-2-44" class="d">-                                ),
</a><a href="#h38-2-45" id="h38-2-45" class="d">-                                Constant(
</a><a href="#h38-2-46" id="h38-2-46" class="d">-                                    Integer(
</a><a href="#h38-2-47" id="h38-2-47" class="d">-                                        2,
</a><a href="#h38-2-48" id="h38-2-48" class="d">-                                    ),
</a>                                 ),
                             ),
<a href="#h38-2-51" id="h38-2-51" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h38-3" id="h38-3" class="h">@@ -343,17 +342,20 @@ Optimized plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h38-3-3" id="h38-3-3" class="d">-            expressions: [
</a><a href="#h38-3-4" id="h38-3-4" class="d">-                (
</a><a href="#h38-3-5" id="h38-3-5" class="d">-                    Field(
</a><a href="#h38-3-6" id="h38-3-6" class="d">-                        0,
</a><a href="#h38-3-7" id="h38-3-7" class="i">+            labels: [
</a><a href="#h38-3-8" id="h38-3-8" class="i">+                Some(
</a><a href="#h38-3-9" id="h38-3-9" class="i">+                    (
</a>                         None,
<a href="#h38-3-11" id="h38-3-11" class="d">-                    ),
</a><a href="#h38-3-12" id="h38-3-12" class="d">-                    Some(
</a>                         &quot;rating&quot;,
                     ),
                 ),
             ],
<a href="#h38-3-17" id="h38-3-17" class="i">+            expressions: [
</a><a href="#h38-3-18" id="h38-3-18" class="i">+                Field(
</a><a href="#h38-3-19" id="h38-3-19" class="i">+                    0,
</a><a href="#h38-3-20" id="h38-3-20" class="i">+                    None,
</a><a href="#h38-3-21" id="h38-3-21" class="i">+                ),
</a><a href="#h38-3-22" id="h38-3-22" class="i">+            ],
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h39" href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a> b/<a href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -171,45 +171,41 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h39-0-3" id="h39-0-3" class="i">+                    labels: [
</a><a href="#h39-0-4" id="h39-0-4" class="i">+                        None,
</a><a href="#h39-0-5" id="h39-0-5" class="i">+                        None,
</a><a href="#h39-0-6" id="h39-0-6" class="i">+                        None,
</a><a href="#h39-0-7" id="h39-0-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h39-0-9" id="h39-0-9" class="d">-                        (
</a><a href="#h39-0-10" id="h39-0-10" class="d">-                            Multiply(
</a><a href="#h39-0-11" id="h39-0-11" class="d">-                                Field(
</a><a href="#h39-0-12" id="h39-0-12" class="d">-                                    5,
</a><a href="#h39-0-13" id="h39-0-13" class="d">-                                    Some(
</a><a href="#h39-0-14" id="h39-0-14" class="d">-                                        (
</a><a href="#h39-0-15" id="h39-0-15" class="d">-                                            None,
</a><a href="#h39-0-16" id="h39-0-16" class="d">-                                            &quot;rating&quot;,
</a><a href="#h39-0-17" id="h39-0-17" class="d">-                                        ),
</a><a href="#h39-0-18" id="h39-0-18" class="d">-                                    ),
</a><a href="#h39-0-19" id="h39-0-19" class="d">-                                ),
</a><a href="#h39-0-20" id="h39-0-20" class="d">-                                Constant(
</a><a href="#h39-0-21" id="h39-0-21" class="d">-                                    Integer(
</a><a href="#h39-0-22" id="h39-0-22" class="d">-                                        10,
</a><a href="#h39-0-23" id="h39-0-23" class="i">+                        Multiply(
</a><a href="#h39-0-24" id="h39-0-24" class="i">+                            Field(
</a><a href="#h39-0-25" id="h39-0-25" class="i">+                                5,
</a><a href="#h39-0-26" id="h39-0-26" class="i">+                                Some(
</a><a href="#h39-0-27" id="h39-0-27" class="i">+                                    (
</a><a href="#h39-0-28" id="h39-0-28" class="i">+                                        None,
</a><a href="#h39-0-29" id="h39-0-29" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h39-0-33" id="h39-0-33" class="d">-                            None,
</a><a href="#h39-0-34" id="h39-0-34" class="d">-                        ),
</a><a href="#h39-0-35" id="h39-0-35" class="d">-                        (
</a>                             Constant(
<a href="#h39-0-37" id="h39-0-37" class="d">-                                Boolean(
</a><a href="#h39-0-38" id="h39-0-38" class="d">-                                    true,
</a><a href="#h39-0-39" id="h39-0-39" class="i">+                                Integer(
</a><a href="#h39-0-40" id="h39-0-40" class="i">+                                    10,
</a>                                 ),
                             ),
<a href="#h39-0-43" id="h39-0-43" class="d">-                            None,
</a>                         ),
<a href="#h39-0-45" id="h39-0-45" class="d">-                        (
</a><a href="#h39-0-46" id="h39-0-46" class="d">-                            Field(
</a><a href="#h39-0-47" id="h39-0-47" class="d">-                                2,
</a><a href="#h39-0-48" id="h39-0-48" class="d">-                                Some(
</a><a href="#h39-0-49" id="h39-0-49" class="d">-                                    (
</a><a href="#h39-0-50" id="h39-0-50" class="d">-                                        None,
</a><a href="#h39-0-51" id="h39-0-51" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h39-0-52" id="h39-0-52" class="d">-                                    ),
</a><a href="#h39-0-53" id="h39-0-53" class="i">+                        Constant(
</a><a href="#h39-0-54" id="h39-0-54" class="i">+                            Boolean(
</a><a href="#h39-0-55" id="h39-0-55" class="i">+                                true,
</a><a href="#h39-0-56" id="h39-0-56" class="i">+                            ),
</a><a href="#h39-0-57" id="h39-0-57" class="i">+                        ),
</a><a href="#h39-0-58" id="h39-0-58" class="i">+                        Field(
</a><a href="#h39-0-59" id="h39-0-59" class="i">+                            2,
</a><a href="#h39-0-60" id="h39-0-60" class="i">+                            Some(
</a><a href="#h39-0-61" id="h39-0-61" class="i">+                                (
</a><a href="#h39-0-62" id="h39-0-62" class="i">+                                    None,
</a><a href="#h39-0-63" id="h39-0-63" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h39-0-66" id="h39-0-66" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h39-1" id="h39-1" class="h">@@ -218,33 +214,31 @@ Plan: Select(
</a>                     Count,
                 ],
             },
<a href="#h39-1-3" id="h39-1-3" class="i">+            labels: [
</a><a href="#h39-1-4" id="h39-1-4" class="i">+                None,
</a><a href="#h39-1-5" id="h39-1-5" class="i">+                None,
</a><a href="#h39-1-6" id="h39-1-6" class="i">+            ],
</a>             expressions: [
<a href="#h39-1-8" id="h39-1-8" class="d">-                (
</a><a href="#h39-1-9" id="h39-1-9" class="d">-                    Field(
</a><a href="#h39-1-10" id="h39-1-10" class="d">-                        2,
</a><a href="#h39-1-11" id="h39-1-11" class="d">-                        Some(
</a><a href="#h39-1-12" id="h39-1-12" class="d">-                            (
</a><a href="#h39-1-13" id="h39-1-13" class="d">-                                Some(
</a><a href="#h39-1-14" id="h39-1-14" class="d">-                                    &quot;movies&quot;,
</a><a href="#h39-1-15" id="h39-1-15" class="d">-                                ),
</a><a href="#h39-1-16" id="h39-1-16" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h39-1-17" id="h39-1-17" class="i">+                Field(
</a><a href="#h39-1-18" id="h39-1-18" class="i">+                    2,
</a><a href="#h39-1-19" id="h39-1-19" class="i">+                    Some(
</a><a href="#h39-1-20" id="h39-1-20" class="i">+                        (
</a><a href="#h39-1-21" id="h39-1-21" class="i">+                            Some(
</a><a href="#h39-1-22" id="h39-1-22" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h39-1-24" id="h39-1-24" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h39-1-27" id="h39-1-27" class="d">-                    None,
</a>                 ),
<a href="#h39-1-29" id="h39-1-29" class="d">-                (
</a><a href="#h39-1-30" id="h39-1-30" class="d">-                    Divide(
</a><a href="#h39-1-31" id="h39-1-31" class="d">-                        Field(
</a><a href="#h39-1-32" id="h39-1-32" class="d">-                            0,
</a><a href="#h39-1-33" id="h39-1-33" class="d">-                            None,
</a><a href="#h39-1-34" id="h39-1-34" class="d">-                        ),
</a><a href="#h39-1-35" id="h39-1-35" class="d">-                        Field(
</a><a href="#h39-1-36" id="h39-1-36" class="d">-                            1,
</a><a href="#h39-1-37" id="h39-1-37" class="d">-                            None,
</a><a href="#h39-1-38" id="h39-1-38" class="d">-                        ),
</a><a href="#h39-1-39" id="h39-1-39" class="i">+                Divide(
</a><a href="#h39-1-40" id="h39-1-40" class="i">+                    Field(
</a><a href="#h39-1-41" id="h39-1-41" class="i">+                        0,
</a><a href="#h39-1-42" id="h39-1-42" class="i">+                        None,
</a><a href="#h39-1-43" id="h39-1-43" class="i">+                    ),
</a><a href="#h39-1-44" id="h39-1-44" class="i">+                    Field(
</a><a href="#h39-1-45" id="h39-1-45" class="i">+                        1,
</a><a href="#h39-1-46" id="h39-1-46" class="i">+                        None,
</a>                     ),
<a href="#h39-1-48" id="h39-1-48" class="d">-                    None,
</a>                 ),
             ],
         },
<a href="#h39-2" id="h39-2" class="h">@@ -353,45 +347,41 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h39-2-3" id="h39-2-3" class="i">+                    labels: [
</a><a href="#h39-2-4" id="h39-2-4" class="i">+                        None,
</a><a href="#h39-2-5" id="h39-2-5" class="i">+                        None,
</a><a href="#h39-2-6" id="h39-2-6" class="i">+                        None,
</a><a href="#h39-2-7" id="h39-2-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h39-2-9" id="h39-2-9" class="d">-                        (
</a><a href="#h39-2-10" id="h39-2-10" class="d">-                            Multiply(
</a><a href="#h39-2-11" id="h39-2-11" class="d">-                                Field(
</a><a href="#h39-2-12" id="h39-2-12" class="d">-                                    5,
</a><a href="#h39-2-13" id="h39-2-13" class="d">-                                    Some(
</a><a href="#h39-2-14" id="h39-2-14" class="d">-                                        (
</a><a href="#h39-2-15" id="h39-2-15" class="d">-                                            None,
</a><a href="#h39-2-16" id="h39-2-16" class="d">-                                            &quot;rating&quot;,
</a><a href="#h39-2-17" id="h39-2-17" class="d">-                                        ),
</a><a href="#h39-2-18" id="h39-2-18" class="d">-                                    ),
</a><a href="#h39-2-19" id="h39-2-19" class="d">-                                ),
</a><a href="#h39-2-20" id="h39-2-20" class="d">-                                Constant(
</a><a href="#h39-2-21" id="h39-2-21" class="d">-                                    Integer(
</a><a href="#h39-2-22" id="h39-2-22" class="d">-                                        10,
</a><a href="#h39-2-23" id="h39-2-23" class="i">+                        Multiply(
</a><a href="#h39-2-24" id="h39-2-24" class="i">+                            Field(
</a><a href="#h39-2-25" id="h39-2-25" class="i">+                                5,
</a><a href="#h39-2-26" id="h39-2-26" class="i">+                                Some(
</a><a href="#h39-2-27" id="h39-2-27" class="i">+                                    (
</a><a href="#h39-2-28" id="h39-2-28" class="i">+                                        None,
</a><a href="#h39-2-29" id="h39-2-29" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h39-2-33" id="h39-2-33" class="d">-                            None,
</a><a href="#h39-2-34" id="h39-2-34" class="d">-                        ),
</a><a href="#h39-2-35" id="h39-2-35" class="d">-                        (
</a>                             Constant(
<a href="#h39-2-37" id="h39-2-37" class="d">-                                Boolean(
</a><a href="#h39-2-38" id="h39-2-38" class="d">-                                    true,
</a><a href="#h39-2-39" id="h39-2-39" class="i">+                                Integer(
</a><a href="#h39-2-40" id="h39-2-40" class="i">+                                    10,
</a>                                 ),
                             ),
<a href="#h39-2-43" id="h39-2-43" class="d">-                            None,
</a>                         ),
<a href="#h39-2-45" id="h39-2-45" class="d">-                        (
</a><a href="#h39-2-46" id="h39-2-46" class="d">-                            Field(
</a><a href="#h39-2-47" id="h39-2-47" class="d">-                                2,
</a><a href="#h39-2-48" id="h39-2-48" class="d">-                                Some(
</a><a href="#h39-2-49" id="h39-2-49" class="d">-                                    (
</a><a href="#h39-2-50" id="h39-2-50" class="d">-                                        None,
</a><a href="#h39-2-51" id="h39-2-51" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h39-2-52" id="h39-2-52" class="d">-                                    ),
</a><a href="#h39-2-53" id="h39-2-53" class="i">+                        Constant(
</a><a href="#h39-2-54" id="h39-2-54" class="i">+                            Boolean(
</a><a href="#h39-2-55" id="h39-2-55" class="i">+                                true,
</a><a href="#h39-2-56" id="h39-2-56" class="i">+                            ),
</a><a href="#h39-2-57" id="h39-2-57" class="i">+                        ),
</a><a href="#h39-2-58" id="h39-2-58" class="i">+                        Field(
</a><a href="#h39-2-59" id="h39-2-59" class="i">+                            2,
</a><a href="#h39-2-60" id="h39-2-60" class="i">+                            Some(
</a><a href="#h39-2-61" id="h39-2-61" class="i">+                                (
</a><a href="#h39-2-62" id="h39-2-62" class="i">+                                    None,
</a><a href="#h39-2-63" id="h39-2-63" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h39-2-66" id="h39-2-66" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h39-3" id="h39-3" class="h">@@ -400,33 +390,31 @@ Optimized plan: Select(
</a>                     Count,
                 ],
             },
<a href="#h39-3-3" id="h39-3-3" class="i">+            labels: [
</a><a href="#h39-3-4" id="h39-3-4" class="i">+                None,
</a><a href="#h39-3-5" id="h39-3-5" class="i">+                None,
</a><a href="#h39-3-6" id="h39-3-6" class="i">+            ],
</a>             expressions: [
<a href="#h39-3-8" id="h39-3-8" class="d">-                (
</a><a href="#h39-3-9" id="h39-3-9" class="d">-                    Field(
</a><a href="#h39-3-10" id="h39-3-10" class="d">-                        2,
</a><a href="#h39-3-11" id="h39-3-11" class="d">-                        Some(
</a><a href="#h39-3-12" id="h39-3-12" class="d">-                            (
</a><a href="#h39-3-13" id="h39-3-13" class="d">-                                Some(
</a><a href="#h39-3-14" id="h39-3-14" class="d">-                                    &quot;movies&quot;,
</a><a href="#h39-3-15" id="h39-3-15" class="d">-                                ),
</a><a href="#h39-3-16" id="h39-3-16" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h39-3-17" id="h39-3-17" class="i">+                Field(
</a><a href="#h39-3-18" id="h39-3-18" class="i">+                    2,
</a><a href="#h39-3-19" id="h39-3-19" class="i">+                    Some(
</a><a href="#h39-3-20" id="h39-3-20" class="i">+                        (
</a><a href="#h39-3-21" id="h39-3-21" class="i">+                            Some(
</a><a href="#h39-3-22" id="h39-3-22" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h39-3-24" id="h39-3-24" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h39-3-27" id="h39-3-27" class="d">-                    None,
</a>                 ),
<a href="#h39-3-29" id="h39-3-29" class="d">-                (
</a><a href="#h39-3-30" id="h39-3-30" class="d">-                    Divide(
</a><a href="#h39-3-31" id="h39-3-31" class="d">-                        Field(
</a><a href="#h39-3-32" id="h39-3-32" class="d">-                            0,
</a><a href="#h39-3-33" id="h39-3-33" class="d">-                            None,
</a><a href="#h39-3-34" id="h39-3-34" class="d">-                        ),
</a><a href="#h39-3-35" id="h39-3-35" class="d">-                        Field(
</a><a href="#h39-3-36" id="h39-3-36" class="d">-                            1,
</a><a href="#h39-3-37" id="h39-3-37" class="d">-                            None,
</a><a href="#h39-3-38" id="h39-3-38" class="d">-                        ),
</a><a href="#h39-3-39" id="h39-3-39" class="i">+                Divide(
</a><a href="#h39-3-40" id="h39-3-40" class="i">+                    Field(
</a><a href="#h39-3-41" id="h39-3-41" class="i">+                        0,
</a><a href="#h39-3-42" id="h39-3-42" class="i">+                        None,
</a><a href="#h39-3-43" id="h39-3-43" class="i">+                    ),
</a><a href="#h39-3-44" id="h39-3-44" class="i">+                    Field(
</a><a href="#h39-3-45" id="h39-3-45" class="i">+                        1,
</a><a href="#h39-3-46" id="h39-3-46" class="i">+                        None,
</a>                     ),
<a href="#h39-3-48" id="h39-3-48" class="d">-                    None,
</a>                 ),
             ],
         },
<b>diff --git a/<a id="h40" href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a> b/<a href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -179,45 +179,41 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h40-0-3" id="h40-0-3" class="i">+                    labels: [
</a><a href="#h40-0-4" id="h40-0-4" class="i">+                        None,
</a><a href="#h40-0-5" id="h40-0-5" class="i">+                        None,
</a><a href="#h40-0-6" id="h40-0-6" class="i">+                        None,
</a><a href="#h40-0-7" id="h40-0-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h40-0-9" id="h40-0-9" class="d">-                        (
</a><a href="#h40-0-10" id="h40-0-10" class="d">-                            Multiply(
</a><a href="#h40-0-11" id="h40-0-11" class="d">-                                Field(
</a><a href="#h40-0-12" id="h40-0-12" class="d">-                                    5,
</a><a href="#h40-0-13" id="h40-0-13" class="d">-                                    Some(
</a><a href="#h40-0-14" id="h40-0-14" class="d">-                                        (
</a><a href="#h40-0-15" id="h40-0-15" class="d">-                                            None,
</a><a href="#h40-0-16" id="h40-0-16" class="d">-                                            &quot;rating&quot;,
</a><a href="#h40-0-17" id="h40-0-17" class="d">-                                        ),
</a><a href="#h40-0-18" id="h40-0-18" class="d">-                                    ),
</a><a href="#h40-0-19" id="h40-0-19" class="d">-                                ),
</a><a href="#h40-0-20" id="h40-0-20" class="d">-                                Constant(
</a><a href="#h40-0-21" id="h40-0-21" class="d">-                                    Integer(
</a><a href="#h40-0-22" id="h40-0-22" class="d">-                                        10,
</a><a href="#h40-0-23" id="h40-0-23" class="i">+                        Multiply(
</a><a href="#h40-0-24" id="h40-0-24" class="i">+                            Field(
</a><a href="#h40-0-25" id="h40-0-25" class="i">+                                5,
</a><a href="#h40-0-26" id="h40-0-26" class="i">+                                Some(
</a><a href="#h40-0-27" id="h40-0-27" class="i">+                                    (
</a><a href="#h40-0-28" id="h40-0-28" class="i">+                                        None,
</a><a href="#h40-0-29" id="h40-0-29" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h40-0-33" id="h40-0-33" class="d">-                            None,
</a><a href="#h40-0-34" id="h40-0-34" class="d">-                        ),
</a><a href="#h40-0-35" id="h40-0-35" class="d">-                        (
</a>                             Constant(
<a href="#h40-0-37" id="h40-0-37" class="d">-                                Boolean(
</a><a href="#h40-0-38" id="h40-0-38" class="d">-                                    true,
</a><a href="#h40-0-39" id="h40-0-39" class="i">+                                Integer(
</a><a href="#h40-0-40" id="h40-0-40" class="i">+                                    10,
</a>                                 ),
                             ),
<a href="#h40-0-43" id="h40-0-43" class="d">-                            None,
</a>                         ),
<a href="#h40-0-45" id="h40-0-45" class="d">-                        (
</a><a href="#h40-0-46" id="h40-0-46" class="d">-                            Field(
</a><a href="#h40-0-47" id="h40-0-47" class="d">-                                2,
</a><a href="#h40-0-48" id="h40-0-48" class="d">-                                Some(
</a><a href="#h40-0-49" id="h40-0-49" class="d">-                                    (
</a><a href="#h40-0-50" id="h40-0-50" class="d">-                                        None,
</a><a href="#h40-0-51" id="h40-0-51" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h40-0-52" id="h40-0-52" class="d">-                                    ),
</a><a href="#h40-0-53" id="h40-0-53" class="i">+                        Constant(
</a><a href="#h40-0-54" id="h40-0-54" class="i">+                            Boolean(
</a><a href="#h40-0-55" id="h40-0-55" class="i">+                                true,
</a><a href="#h40-0-56" id="h40-0-56" class="i">+                            ),
</a><a href="#h40-0-57" id="h40-0-57" class="i">+                        ),
</a><a href="#h40-0-58" id="h40-0-58" class="i">+                        Field(
</a><a href="#h40-0-59" id="h40-0-59" class="i">+                            2,
</a><a href="#h40-0-60" id="h40-0-60" class="i">+                            Some(
</a><a href="#h40-0-61" id="h40-0-61" class="i">+                                (
</a><a href="#h40-0-62" id="h40-0-62" class="i">+                                    None,
</a><a href="#h40-0-63" id="h40-0-63" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h40-0-66" id="h40-0-66" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h40-1" id="h40-1" class="h">@@ -226,44 +222,42 @@ Plan: Select(
</a>                     Count,
                 ],
             },
<a href="#h40-1-3" id="h40-1-3" class="i">+            labels: [
</a><a href="#h40-1-4" id="h40-1-4" class="i">+                None,
</a><a href="#h40-1-5" id="h40-1-5" class="i">+                None,
</a><a href="#h40-1-6" id="h40-1-6" class="i">+            ],
</a>             expressions: [
<a href="#h40-1-8" id="h40-1-8" class="d">-                (
</a><a href="#h40-1-9" id="h40-1-9" class="d">-                    Field(
</a><a href="#h40-1-10" id="h40-1-10" class="d">-                        2,
</a><a href="#h40-1-11" id="h40-1-11" class="d">-                        Some(
</a><a href="#h40-1-12" id="h40-1-12" class="d">-                            (
</a><a href="#h40-1-13" id="h40-1-13" class="d">-                                Some(
</a><a href="#h40-1-14" id="h40-1-14" class="d">-                                    &quot;movies&quot;,
</a><a href="#h40-1-15" id="h40-1-15" class="d">-                                ),
</a><a href="#h40-1-16" id="h40-1-16" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h40-1-17" id="h40-1-17" class="i">+                Field(
</a><a href="#h40-1-18" id="h40-1-18" class="i">+                    2,
</a><a href="#h40-1-19" id="h40-1-19" class="i">+                    Some(
</a><a href="#h40-1-20" id="h40-1-20" class="i">+                        (
</a><a href="#h40-1-21" id="h40-1-21" class="i">+                            Some(
</a><a href="#h40-1-22" id="h40-1-22" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h40-1-24" id="h40-1-24" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h40-1-27" id="h40-1-27" class="d">-                    None,
</a>                 ),
<a href="#h40-1-29" id="h40-1-29" class="d">-                (
</a><a href="#h40-1-30" id="h40-1-30" class="d">-                    Add(
</a><a href="#h40-1-31" id="h40-1-31" class="d">-                        Divide(
</a><a href="#h40-1-32" id="h40-1-32" class="d">-                            Field(
</a><a href="#h40-1-33" id="h40-1-33" class="d">-                                0,
</a><a href="#h40-1-34" id="h40-1-34" class="d">-                                None,
</a><a href="#h40-1-35" id="h40-1-35" class="d">-                            ),
</a><a href="#h40-1-36" id="h40-1-36" class="d">-                            Field(
</a><a href="#h40-1-37" id="h40-1-37" class="d">-                                1,
</a><a href="#h40-1-38" id="h40-1-38" class="d">-                                None,
</a><a href="#h40-1-39" id="h40-1-39" class="d">-                            ),
</a><a href="#h40-1-40" id="h40-1-40" class="i">+                Add(
</a><a href="#h40-1-41" id="h40-1-41" class="i">+                    Divide(
</a><a href="#h40-1-42" id="h40-1-42" class="i">+                        Field(
</a><a href="#h40-1-43" id="h40-1-43" class="i">+                            0,
</a><a href="#h40-1-44" id="h40-1-44" class="i">+                            None,
</a>                         ),
                         Field(
<a href="#h40-1-47" id="h40-1-47" class="d">-                            2,
</a><a href="#h40-1-48" id="h40-1-48" class="d">-                            Some(
</a><a href="#h40-1-49" id="h40-1-49" class="d">-                                (
</a><a href="#h40-1-50" id="h40-1-50" class="d">-                                    None,
</a><a href="#h40-1-51" id="h40-1-51" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h40-1-52" id="h40-1-52" class="d">-                                ),
</a><a href="#h40-1-53" id="h40-1-53" class="i">+                            1,
</a><a href="#h40-1-54" id="h40-1-54" class="i">+                            None,
</a><a href="#h40-1-55" id="h40-1-55" class="i">+                        ),
</a><a href="#h40-1-56" id="h40-1-56" class="i">+                    ),
</a><a href="#h40-1-57" id="h40-1-57" class="i">+                    Field(
</a><a href="#h40-1-58" id="h40-1-58" class="i">+                        2,
</a><a href="#h40-1-59" id="h40-1-59" class="i">+                        Some(
</a><a href="#h40-1-60" id="h40-1-60" class="i">+                            (
</a><a href="#h40-1-61" id="h40-1-61" class="i">+                                None,
</a><a href="#h40-1-62" id="h40-1-62" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
                     ),
<a href="#h40-1-66" id="h40-1-66" class="d">-                    None,
</a>                 ),
             ],
         },
<a href="#h40-2" id="h40-2" class="h">@@ -372,45 +366,41 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h40-2-3" id="h40-2-3" class="i">+                    labels: [
</a><a href="#h40-2-4" id="h40-2-4" class="i">+                        None,
</a><a href="#h40-2-5" id="h40-2-5" class="i">+                        None,
</a><a href="#h40-2-6" id="h40-2-6" class="i">+                        None,
</a><a href="#h40-2-7" id="h40-2-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h40-2-9" id="h40-2-9" class="d">-                        (
</a><a href="#h40-2-10" id="h40-2-10" class="d">-                            Multiply(
</a><a href="#h40-2-11" id="h40-2-11" class="d">-                                Field(
</a><a href="#h40-2-12" id="h40-2-12" class="d">-                                    5,
</a><a href="#h40-2-13" id="h40-2-13" class="d">-                                    Some(
</a><a href="#h40-2-14" id="h40-2-14" class="d">-                                        (
</a><a href="#h40-2-15" id="h40-2-15" class="d">-                                            None,
</a><a href="#h40-2-16" id="h40-2-16" class="d">-                                            &quot;rating&quot;,
</a><a href="#h40-2-17" id="h40-2-17" class="d">-                                        ),
</a><a href="#h40-2-18" id="h40-2-18" class="d">-                                    ),
</a><a href="#h40-2-19" id="h40-2-19" class="d">-                                ),
</a><a href="#h40-2-20" id="h40-2-20" class="d">-                                Constant(
</a><a href="#h40-2-21" id="h40-2-21" class="d">-                                    Integer(
</a><a href="#h40-2-22" id="h40-2-22" class="d">-                                        10,
</a><a href="#h40-2-23" id="h40-2-23" class="i">+                        Multiply(
</a><a href="#h40-2-24" id="h40-2-24" class="i">+                            Field(
</a><a href="#h40-2-25" id="h40-2-25" class="i">+                                5,
</a><a href="#h40-2-26" id="h40-2-26" class="i">+                                Some(
</a><a href="#h40-2-27" id="h40-2-27" class="i">+                                    (
</a><a href="#h40-2-28" id="h40-2-28" class="i">+                                        None,
</a><a href="#h40-2-29" id="h40-2-29" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h40-2-33" id="h40-2-33" class="d">-                            None,
</a><a href="#h40-2-34" id="h40-2-34" class="d">-                        ),
</a><a href="#h40-2-35" id="h40-2-35" class="d">-                        (
</a>                             Constant(
<a href="#h40-2-37" id="h40-2-37" class="d">-                                Boolean(
</a><a href="#h40-2-38" id="h40-2-38" class="d">-                                    true,
</a><a href="#h40-2-39" id="h40-2-39" class="i">+                                Integer(
</a><a href="#h40-2-40" id="h40-2-40" class="i">+                                    10,
</a>                                 ),
                             ),
<a href="#h40-2-43" id="h40-2-43" class="d">-                            None,
</a>                         ),
<a href="#h40-2-45" id="h40-2-45" class="d">-                        (
</a><a href="#h40-2-46" id="h40-2-46" class="d">-                            Field(
</a><a href="#h40-2-47" id="h40-2-47" class="d">-                                2,
</a><a href="#h40-2-48" id="h40-2-48" class="d">-                                Some(
</a><a href="#h40-2-49" id="h40-2-49" class="d">-                                    (
</a><a href="#h40-2-50" id="h40-2-50" class="d">-                                        None,
</a><a href="#h40-2-51" id="h40-2-51" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h40-2-52" id="h40-2-52" class="d">-                                    ),
</a><a href="#h40-2-53" id="h40-2-53" class="i">+                        Constant(
</a><a href="#h40-2-54" id="h40-2-54" class="i">+                            Boolean(
</a><a href="#h40-2-55" id="h40-2-55" class="i">+                                true,
</a><a href="#h40-2-56" id="h40-2-56" class="i">+                            ),
</a><a href="#h40-2-57" id="h40-2-57" class="i">+                        ),
</a><a href="#h40-2-58" id="h40-2-58" class="i">+                        Field(
</a><a href="#h40-2-59" id="h40-2-59" class="i">+                            2,
</a><a href="#h40-2-60" id="h40-2-60" class="i">+                            Some(
</a><a href="#h40-2-61" id="h40-2-61" class="i">+                                (
</a><a href="#h40-2-62" id="h40-2-62" class="i">+                                    None,
</a><a href="#h40-2-63" id="h40-2-63" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h40-2-66" id="h40-2-66" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h40-3" id="h40-3" class="h">@@ -419,44 +409,42 @@ Optimized plan: Select(
</a>                     Count,
                 ],
             },
<a href="#h40-3-3" id="h40-3-3" class="i">+            labels: [
</a><a href="#h40-3-4" id="h40-3-4" class="i">+                None,
</a><a href="#h40-3-5" id="h40-3-5" class="i">+                None,
</a><a href="#h40-3-6" id="h40-3-6" class="i">+            ],
</a>             expressions: [
<a href="#h40-3-8" id="h40-3-8" class="d">-                (
</a><a href="#h40-3-9" id="h40-3-9" class="d">-                    Field(
</a><a href="#h40-3-10" id="h40-3-10" class="d">-                        2,
</a><a href="#h40-3-11" id="h40-3-11" class="d">-                        Some(
</a><a href="#h40-3-12" id="h40-3-12" class="d">-                            (
</a><a href="#h40-3-13" id="h40-3-13" class="d">-                                Some(
</a><a href="#h40-3-14" id="h40-3-14" class="d">-                                    &quot;movies&quot;,
</a><a href="#h40-3-15" id="h40-3-15" class="d">-                                ),
</a><a href="#h40-3-16" id="h40-3-16" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h40-3-17" id="h40-3-17" class="i">+                Field(
</a><a href="#h40-3-18" id="h40-3-18" class="i">+                    2,
</a><a href="#h40-3-19" id="h40-3-19" class="i">+                    Some(
</a><a href="#h40-3-20" id="h40-3-20" class="i">+                        (
</a><a href="#h40-3-21" id="h40-3-21" class="i">+                            Some(
</a><a href="#h40-3-22" id="h40-3-22" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h40-3-24" id="h40-3-24" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h40-3-27" id="h40-3-27" class="d">-                    None,
</a>                 ),
<a href="#h40-3-29" id="h40-3-29" class="d">-                (
</a><a href="#h40-3-30" id="h40-3-30" class="d">-                    Add(
</a><a href="#h40-3-31" id="h40-3-31" class="d">-                        Divide(
</a><a href="#h40-3-32" id="h40-3-32" class="d">-                            Field(
</a><a href="#h40-3-33" id="h40-3-33" class="d">-                                0,
</a><a href="#h40-3-34" id="h40-3-34" class="d">-                                None,
</a><a href="#h40-3-35" id="h40-3-35" class="d">-                            ),
</a><a href="#h40-3-36" id="h40-3-36" class="d">-                            Field(
</a><a href="#h40-3-37" id="h40-3-37" class="d">-                                1,
</a><a href="#h40-3-38" id="h40-3-38" class="d">-                                None,
</a><a href="#h40-3-39" id="h40-3-39" class="d">-                            ),
</a><a href="#h40-3-40" id="h40-3-40" class="i">+                Add(
</a><a href="#h40-3-41" id="h40-3-41" class="i">+                    Divide(
</a><a href="#h40-3-42" id="h40-3-42" class="i">+                        Field(
</a><a href="#h40-3-43" id="h40-3-43" class="i">+                            0,
</a><a href="#h40-3-44" id="h40-3-44" class="i">+                            None,
</a>                         ),
                         Field(
<a href="#h40-3-47" id="h40-3-47" class="d">-                            2,
</a><a href="#h40-3-48" id="h40-3-48" class="d">-                            Some(
</a><a href="#h40-3-49" id="h40-3-49" class="d">-                                (
</a><a href="#h40-3-50" id="h40-3-50" class="d">-                                    None,
</a><a href="#h40-3-51" id="h40-3-51" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h40-3-52" id="h40-3-52" class="d">-                                ),
</a><a href="#h40-3-53" id="h40-3-53" class="i">+                            1,
</a><a href="#h40-3-54" id="h40-3-54" class="i">+                            None,
</a><a href="#h40-3-55" id="h40-3-55" class="i">+                        ),
</a><a href="#h40-3-56" id="h40-3-56" class="i">+                    ),
</a><a href="#h40-3-57" id="h40-3-57" class="i">+                    Field(
</a><a href="#h40-3-58" id="h40-3-58" class="i">+                        2,
</a><a href="#h40-3-59" id="h40-3-59" class="i">+                        Some(
</a><a href="#h40-3-60" id="h40-3-60" class="i">+                            (
</a><a href="#h40-3-61" id="h40-3-61" class="i">+                                None,
</a><a href="#h40-3-62" id="h40-3-62" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
                     ),
<a href="#h40-3-66" id="h40-3-66" class="d">-                    None,
</a>                 ),
             ],
         },
<b>diff --git a/<a id="h41" href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a> b/<a href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -159,39 +159,40 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h41-0-3" id="h41-0-3" class="i">+                    labels: [
</a><a href="#h41-0-4" id="h41-0-4" class="i">+                        None,
</a><a href="#h41-0-5" id="h41-0-5" class="i">+                        Some(
</a><a href="#h41-0-6" id="h41-0-6" class="i">+                            (
</a><a href="#h41-0-7" id="h41-0-7" class="i">+                                None,
</a><a href="#h41-0-8" id="h41-0-8" class="i">+                                &quot;twice&quot;,
</a><a href="#h41-0-9" id="h41-0-9" class="i">+                            ),
</a><a href="#h41-0-10" id="h41-0-10" class="i">+                        ),
</a><a href="#h41-0-11" id="h41-0-11" class="i">+                    ],
</a>                     expressions: [
<a href="#h41-0-13" id="h41-0-13" class="d">-                        (
</a><a href="#h41-0-14" id="h41-0-14" class="i">+                        Field(
</a><a href="#h41-0-15" id="h41-0-15" class="i">+                            5,
</a><a href="#h41-0-16" id="h41-0-16" class="i">+                            Some(
</a><a href="#h41-0-17" id="h41-0-17" class="i">+                                (
</a><a href="#h41-0-18" id="h41-0-18" class="i">+                                    None,
</a><a href="#h41-0-19" id="h41-0-19" class="i">+                                    &quot;rating&quot;,
</a><a href="#h41-0-20" id="h41-0-20" class="i">+                                ),
</a><a href="#h41-0-21" id="h41-0-21" class="i">+                            ),
</a><a href="#h41-0-22" id="h41-0-22" class="i">+                        ),
</a><a href="#h41-0-23" id="h41-0-23" class="i">+                        Multiply(
</a>                             Field(
<a href="#h41-0-25" id="h41-0-25" class="d">-                                5,
</a><a href="#h41-0-26" id="h41-0-26" class="i">+                                2,
</a>                                 Some(
                                     (
                                         None,
<a href="#h41-0-30" id="h41-0-30" class="d">-                                        &quot;rating&quot;,
</a><a href="#h41-0-31" id="h41-0-31" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h41-0-35" id="h41-0-35" class="d">-                            None,
</a><a href="#h41-0-36" id="h41-0-36" class="d">-                        ),
</a><a href="#h41-0-37" id="h41-0-37" class="d">-                        (
</a><a href="#h41-0-38" id="h41-0-38" class="d">-                            Multiply(
</a><a href="#h41-0-39" id="h41-0-39" class="d">-                                Field(
</a><a href="#h41-0-40" id="h41-0-40" class="i">+                            Constant(
</a><a href="#h41-0-41" id="h41-0-41" class="i">+                                Integer(
</a>                                     2,
<a href="#h41-0-43" id="h41-0-43" class="d">-                                    Some(
</a><a href="#h41-0-44" id="h41-0-44" class="d">-                                        (
</a><a href="#h41-0-45" id="h41-0-45" class="d">-                                            None,
</a><a href="#h41-0-46" id="h41-0-46" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h41-0-47" id="h41-0-47" class="d">-                                        ),
</a><a href="#h41-0-48" id="h41-0-48" class="d">-                                    ),
</a><a href="#h41-0-49" id="h41-0-49" class="d">-                                ),
</a><a href="#h41-0-50" id="h41-0-50" class="d">-                                Constant(
</a><a href="#h41-0-51" id="h41-0-51" class="d">-                                    Integer(
</a><a href="#h41-0-52" id="h41-0-52" class="d">-                                        2,
</a><a href="#h41-0-53" id="h41-0-53" class="d">-                                    ),
</a>                                 ),
                             ),
<a href="#h41-0-56" id="h41-0-56" class="d">-                            Some(
</a><a href="#h41-0-57" id="h41-0-57" class="d">-                                &quot;twice&quot;,
</a><a href="#h41-0-58" id="h41-0-58" class="d">-                            ),
</a>                         ),
                     ],
                 },
<a href="#h41-1" id="h41-1" class="h">@@ -199,26 +200,27 @@ Plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h41-1-3" id="h41-1-3" class="d">-            expressions: [
</a><a href="#h41-1-4" id="h41-1-4" class="d">-                (
</a><a href="#h41-1-5" id="h41-1-5" class="d">-                    Field(
</a><a href="#h41-1-6" id="h41-1-6" class="d">-                        1,
</a><a href="#h41-1-7" id="h41-1-7" class="d">-                        Some(
</a><a href="#h41-1-8" id="h41-1-8" class="d">-                            (
</a><a href="#h41-1-9" id="h41-1-9" class="d">-                                None,
</a><a href="#h41-1-10" id="h41-1-10" class="d">-                                &quot;twice&quot;,
</a><a href="#h41-1-11" id="h41-1-11" class="d">-                            ),
</a><a href="#h41-1-12" id="h41-1-12" class="d">-                        ),
</a><a href="#h41-1-13" id="h41-1-13" class="d">-                    ),
</a><a href="#h41-1-14" id="h41-1-14" class="d">-                    Some(
</a><a href="#h41-1-15" id="h41-1-15" class="i">+            labels: [
</a><a href="#h41-1-16" id="h41-1-16" class="i">+                Some(
</a><a href="#h41-1-17" id="h41-1-17" class="i">+                    (
</a><a href="#h41-1-18" id="h41-1-18" class="i">+                        None,
</a>                         &quot;twice&quot;,
                     ),
                 ),
<a href="#h41-1-22" id="h41-1-22" class="d">-                (
</a><a href="#h41-1-23" id="h41-1-23" class="d">-                    Field(
</a><a href="#h41-1-24" id="h41-1-24" class="d">-                        0,
</a><a href="#h41-1-25" id="h41-1-25" class="d">-                        None,
</a><a href="#h41-1-26" id="h41-1-26" class="i">+                None,
</a><a href="#h41-1-27" id="h41-1-27" class="i">+            ],
</a><a href="#h41-1-28" id="h41-1-28" class="i">+            expressions: [
</a><a href="#h41-1-29" id="h41-1-29" class="i">+                Field(
</a><a href="#h41-1-30" id="h41-1-30" class="i">+                    1,
</a><a href="#h41-1-31" id="h41-1-31" class="i">+                    Some(
</a><a href="#h41-1-32" id="h41-1-32" class="i">+                        (
</a><a href="#h41-1-33" id="h41-1-33" class="i">+                            None,
</a><a href="#h41-1-34" id="h41-1-34" class="i">+                            &quot;twice&quot;,
</a><a href="#h41-1-35" id="h41-1-35" class="i">+                        ),
</a>                     ),
<a href="#h41-1-37" id="h41-1-37" class="i">+                ),
</a><a href="#h41-1-38" id="h41-1-38" class="i">+                Field(
</a><a href="#h41-1-39" id="h41-1-39" class="i">+                    0,
</a>                     None,
                 ),
             ],
<a href="#h41-2" id="h41-2" class="h">@@ -326,39 +328,40 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h41-2-3" id="h41-2-3" class="i">+                    labels: [
</a><a href="#h41-2-4" id="h41-2-4" class="i">+                        None,
</a><a href="#h41-2-5" id="h41-2-5" class="i">+                        Some(
</a><a href="#h41-2-6" id="h41-2-6" class="i">+                            (
</a><a href="#h41-2-7" id="h41-2-7" class="i">+                                None,
</a><a href="#h41-2-8" id="h41-2-8" class="i">+                                &quot;twice&quot;,
</a><a href="#h41-2-9" id="h41-2-9" class="i">+                            ),
</a><a href="#h41-2-10" id="h41-2-10" class="i">+                        ),
</a><a href="#h41-2-11" id="h41-2-11" class="i">+                    ],
</a>                     expressions: [
<a href="#h41-2-13" id="h41-2-13" class="d">-                        (
</a><a href="#h41-2-14" id="h41-2-14" class="i">+                        Field(
</a><a href="#h41-2-15" id="h41-2-15" class="i">+                            5,
</a><a href="#h41-2-16" id="h41-2-16" class="i">+                            Some(
</a><a href="#h41-2-17" id="h41-2-17" class="i">+                                (
</a><a href="#h41-2-18" id="h41-2-18" class="i">+                                    None,
</a><a href="#h41-2-19" id="h41-2-19" class="i">+                                    &quot;rating&quot;,
</a><a href="#h41-2-20" id="h41-2-20" class="i">+                                ),
</a><a href="#h41-2-21" id="h41-2-21" class="i">+                            ),
</a><a href="#h41-2-22" id="h41-2-22" class="i">+                        ),
</a><a href="#h41-2-23" id="h41-2-23" class="i">+                        Multiply(
</a>                             Field(
<a href="#h41-2-25" id="h41-2-25" class="d">-                                5,
</a><a href="#h41-2-26" id="h41-2-26" class="i">+                                2,
</a>                                 Some(
                                     (
                                         None,
<a href="#h41-2-30" id="h41-2-30" class="d">-                                        &quot;rating&quot;,
</a><a href="#h41-2-31" id="h41-2-31" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h41-2-35" id="h41-2-35" class="d">-                            None,
</a><a href="#h41-2-36" id="h41-2-36" class="d">-                        ),
</a><a href="#h41-2-37" id="h41-2-37" class="d">-                        (
</a><a href="#h41-2-38" id="h41-2-38" class="d">-                            Multiply(
</a><a href="#h41-2-39" id="h41-2-39" class="d">-                                Field(
</a><a href="#h41-2-40" id="h41-2-40" class="i">+                            Constant(
</a><a href="#h41-2-41" id="h41-2-41" class="i">+                                Integer(
</a>                                     2,
<a href="#h41-2-43" id="h41-2-43" class="d">-                                    Some(
</a><a href="#h41-2-44" id="h41-2-44" class="d">-                                        (
</a><a href="#h41-2-45" id="h41-2-45" class="d">-                                            None,
</a><a href="#h41-2-46" id="h41-2-46" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h41-2-47" id="h41-2-47" class="d">-                                        ),
</a><a href="#h41-2-48" id="h41-2-48" class="d">-                                    ),
</a><a href="#h41-2-49" id="h41-2-49" class="d">-                                ),
</a><a href="#h41-2-50" id="h41-2-50" class="d">-                                Constant(
</a><a href="#h41-2-51" id="h41-2-51" class="d">-                                    Integer(
</a><a href="#h41-2-52" id="h41-2-52" class="d">-                                        2,
</a><a href="#h41-2-53" id="h41-2-53" class="d">-                                    ),
</a>                                 ),
                             ),
<a href="#h41-2-56" id="h41-2-56" class="d">-                            Some(
</a><a href="#h41-2-57" id="h41-2-57" class="d">-                                &quot;twice&quot;,
</a><a href="#h41-2-58" id="h41-2-58" class="d">-                            ),
</a>                         ),
                     ],
                 },
<a href="#h41-3" id="h41-3" class="h">@@ -366,26 +369,27 @@ Optimized plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h41-3-3" id="h41-3-3" class="d">-            expressions: [
</a><a href="#h41-3-4" id="h41-3-4" class="d">-                (
</a><a href="#h41-3-5" id="h41-3-5" class="d">-                    Field(
</a><a href="#h41-3-6" id="h41-3-6" class="d">-                        1,
</a><a href="#h41-3-7" id="h41-3-7" class="d">-                        Some(
</a><a href="#h41-3-8" id="h41-3-8" class="d">-                            (
</a><a href="#h41-3-9" id="h41-3-9" class="d">-                                None,
</a><a href="#h41-3-10" id="h41-3-10" class="d">-                                &quot;twice&quot;,
</a><a href="#h41-3-11" id="h41-3-11" class="d">-                            ),
</a><a href="#h41-3-12" id="h41-3-12" class="d">-                        ),
</a><a href="#h41-3-13" id="h41-3-13" class="d">-                    ),
</a><a href="#h41-3-14" id="h41-3-14" class="d">-                    Some(
</a><a href="#h41-3-15" id="h41-3-15" class="i">+            labels: [
</a><a href="#h41-3-16" id="h41-3-16" class="i">+                Some(
</a><a href="#h41-3-17" id="h41-3-17" class="i">+                    (
</a><a href="#h41-3-18" id="h41-3-18" class="i">+                        None,
</a>                         &quot;twice&quot;,
                     ),
                 ),
<a href="#h41-3-22" id="h41-3-22" class="d">-                (
</a><a href="#h41-3-23" id="h41-3-23" class="d">-                    Field(
</a><a href="#h41-3-24" id="h41-3-24" class="d">-                        0,
</a><a href="#h41-3-25" id="h41-3-25" class="d">-                        None,
</a><a href="#h41-3-26" id="h41-3-26" class="i">+                None,
</a><a href="#h41-3-27" id="h41-3-27" class="i">+            ],
</a><a href="#h41-3-28" id="h41-3-28" class="i">+            expressions: [
</a><a href="#h41-3-29" id="h41-3-29" class="i">+                Field(
</a><a href="#h41-3-30" id="h41-3-30" class="i">+                    1,
</a><a href="#h41-3-31" id="h41-3-31" class="i">+                    Some(
</a><a href="#h41-3-32" id="h41-3-32" class="i">+                        (
</a><a href="#h41-3-33" id="h41-3-33" class="i">+                            None,
</a><a href="#h41-3-34" id="h41-3-34" class="i">+                            &quot;twice&quot;,
</a><a href="#h41-3-35" id="h41-3-35" class="i">+                        ),
</a>                     ),
<a href="#h41-3-37" id="h41-3-37" class="i">+                ),
</a><a href="#h41-3-38" id="h41-3-38" class="i">+                Field(
</a><a href="#h41-3-39" id="h41-3-39" class="i">+                    0,
</a>                     None,
                 ),
             ],
<b>diff --git a/<a id="h42" href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a> b/<a href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -168,37 +168,35 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h42-0-3" id="h42-0-3" class="i">+                    labels: [
</a><a href="#h42-0-4" id="h42-0-4" class="i">+                        None,
</a><a href="#h42-0-5" id="h42-0-5" class="i">+                        None,
</a><a href="#h42-0-6" id="h42-0-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h42-0-8" id="h42-0-8" class="d">-                        (
</a><a href="#h42-0-9" id="h42-0-9" class="i">+                        Field(
</a><a href="#h42-0-10" id="h42-0-10" class="i">+                            5,
</a><a href="#h42-0-11" id="h42-0-11" class="i">+                            Some(
</a><a href="#h42-0-12" id="h42-0-12" class="i">+                                (
</a><a href="#h42-0-13" id="h42-0-13" class="i">+                                    None,
</a><a href="#h42-0-14" id="h42-0-14" class="i">+                                    &quot;rating&quot;,
</a><a href="#h42-0-15" id="h42-0-15" class="i">+                                ),
</a><a href="#h42-0-16" id="h42-0-16" class="i">+                            ),
</a><a href="#h42-0-17" id="h42-0-17" class="i">+                        ),
</a><a href="#h42-0-18" id="h42-0-18" class="i">+                        Multiply(
</a>                             Field(
<a href="#h42-0-20" id="h42-0-20" class="d">-                                5,
</a><a href="#h42-0-21" id="h42-0-21" class="i">+                                2,
</a>                                 Some(
                                     (
                                         None,
<a href="#h42-0-25" id="h42-0-25" class="d">-                                        &quot;rating&quot;,
</a><a href="#h42-0-26" id="h42-0-26" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h42-0-30" id="h42-0-30" class="d">-                            None,
</a><a href="#h42-0-31" id="h42-0-31" class="d">-                        ),
</a><a href="#h42-0-32" id="h42-0-32" class="d">-                        (
</a><a href="#h42-0-33" id="h42-0-33" class="d">-                            Multiply(
</a><a href="#h42-0-34" id="h42-0-34" class="d">-                                Field(
</a><a href="#h42-0-35" id="h42-0-35" class="i">+                            Constant(
</a><a href="#h42-0-36" id="h42-0-36" class="i">+                                Integer(
</a>                                     2,
<a href="#h42-0-38" id="h42-0-38" class="d">-                                    Some(
</a><a href="#h42-0-39" id="h42-0-39" class="d">-                                        (
</a><a href="#h42-0-40" id="h42-0-40" class="d">-                                            None,
</a><a href="#h42-0-41" id="h42-0-41" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h42-0-42" id="h42-0-42" class="d">-                                        ),
</a><a href="#h42-0-43" id="h42-0-43" class="d">-                                    ),
</a><a href="#h42-0-44" id="h42-0-44" class="d">-                                ),
</a><a href="#h42-0-45" id="h42-0-45" class="d">-                                Constant(
</a><a href="#h42-0-46" id="h42-0-46" class="d">-                                    Integer(
</a><a href="#h42-0-47" id="h42-0-47" class="d">-                                        2,
</a><a href="#h42-0-48" id="h42-0-48" class="d">-                                    ),
</a>                                 ),
                             ),
<a href="#h42-0-51" id="h42-0-51" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h42-1" id="h42-1" class="h">@@ -206,22 +204,23 @@ Plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h42-1-3" id="h42-1-3" class="d">-            expressions: [
</a><a href="#h42-1-4" id="h42-1-4" class="d">-                (
</a><a href="#h42-1-5" id="h42-1-5" class="d">-                    Field(
</a><a href="#h42-1-6" id="h42-1-6" class="d">-                        1,
</a><a href="#h42-1-7" id="h42-1-7" class="i">+            labels: [
</a><a href="#h42-1-8" id="h42-1-8" class="i">+                None,
</a><a href="#h42-1-9" id="h42-1-9" class="i">+                Some(
</a><a href="#h42-1-10" id="h42-1-10" class="i">+                    (
</a>                         None,
<a href="#h42-1-12" id="h42-1-12" class="i">+                        &quot;rating&quot;,
</a>                     ),
<a href="#h42-1-14" id="h42-1-14" class="i">+                ),
</a><a href="#h42-1-15" id="h42-1-15" class="i">+            ],
</a><a href="#h42-1-16" id="h42-1-16" class="i">+            expressions: [
</a><a href="#h42-1-17" id="h42-1-17" class="i">+                Field(
</a><a href="#h42-1-18" id="h42-1-18" class="i">+                    1,
</a>                     None,
                 ),
<a href="#h42-1-21" id="h42-1-21" class="d">-                (
</a><a href="#h42-1-22" id="h42-1-22" class="d">-                    Field(
</a><a href="#h42-1-23" id="h42-1-23" class="d">-                        0,
</a><a href="#h42-1-24" id="h42-1-24" class="d">-                        None,
</a><a href="#h42-1-25" id="h42-1-25" class="d">-                    ),
</a><a href="#h42-1-26" id="h42-1-26" class="d">-                    Some(
</a><a href="#h42-1-27" id="h42-1-27" class="d">-                        &quot;rating&quot;,
</a><a href="#h42-1-28" id="h42-1-28" class="d">-                    ),
</a><a href="#h42-1-29" id="h42-1-29" class="i">+                Field(
</a><a href="#h42-1-30" id="h42-1-30" class="i">+                    0,
</a><a href="#h42-1-31" id="h42-1-31" class="i">+                    None,
</a>                 ),
             ],
         },
<a href="#h42-2" id="h42-2" class="h">@@ -328,37 +327,35 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h42-2-3" id="h42-2-3" class="i">+                    labels: [
</a><a href="#h42-2-4" id="h42-2-4" class="i">+                        None,
</a><a href="#h42-2-5" id="h42-2-5" class="i">+                        None,
</a><a href="#h42-2-6" id="h42-2-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h42-2-8" id="h42-2-8" class="d">-                        (
</a><a href="#h42-2-9" id="h42-2-9" class="i">+                        Field(
</a><a href="#h42-2-10" id="h42-2-10" class="i">+                            5,
</a><a href="#h42-2-11" id="h42-2-11" class="i">+                            Some(
</a><a href="#h42-2-12" id="h42-2-12" class="i">+                                (
</a><a href="#h42-2-13" id="h42-2-13" class="i">+                                    None,
</a><a href="#h42-2-14" id="h42-2-14" class="i">+                                    &quot;rating&quot;,
</a><a href="#h42-2-15" id="h42-2-15" class="i">+                                ),
</a><a href="#h42-2-16" id="h42-2-16" class="i">+                            ),
</a><a href="#h42-2-17" id="h42-2-17" class="i">+                        ),
</a><a href="#h42-2-18" id="h42-2-18" class="i">+                        Multiply(
</a>                             Field(
<a href="#h42-2-20" id="h42-2-20" class="d">-                                5,
</a><a href="#h42-2-21" id="h42-2-21" class="i">+                                2,
</a>                                 Some(
                                     (
                                         None,
<a href="#h42-2-25" id="h42-2-25" class="d">-                                        &quot;rating&quot;,
</a><a href="#h42-2-26" id="h42-2-26" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h42-2-30" id="h42-2-30" class="d">-                            None,
</a><a href="#h42-2-31" id="h42-2-31" class="d">-                        ),
</a><a href="#h42-2-32" id="h42-2-32" class="d">-                        (
</a><a href="#h42-2-33" id="h42-2-33" class="d">-                            Multiply(
</a><a href="#h42-2-34" id="h42-2-34" class="d">-                                Field(
</a><a href="#h42-2-35" id="h42-2-35" class="i">+                            Constant(
</a><a href="#h42-2-36" id="h42-2-36" class="i">+                                Integer(
</a>                                     2,
<a href="#h42-2-38" id="h42-2-38" class="d">-                                    Some(
</a><a href="#h42-2-39" id="h42-2-39" class="d">-                                        (
</a><a href="#h42-2-40" id="h42-2-40" class="d">-                                            None,
</a><a href="#h42-2-41" id="h42-2-41" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h42-2-42" id="h42-2-42" class="d">-                                        ),
</a><a href="#h42-2-43" id="h42-2-43" class="d">-                                    ),
</a><a href="#h42-2-44" id="h42-2-44" class="d">-                                ),
</a><a href="#h42-2-45" id="h42-2-45" class="d">-                                Constant(
</a><a href="#h42-2-46" id="h42-2-46" class="d">-                                    Integer(
</a><a href="#h42-2-47" id="h42-2-47" class="d">-                                        2,
</a><a href="#h42-2-48" id="h42-2-48" class="d">-                                    ),
</a>                                 ),
                             ),
<a href="#h42-2-51" id="h42-2-51" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h42-3" id="h42-3" class="h">@@ -366,22 +363,23 @@ Optimized plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h42-3-3" id="h42-3-3" class="d">-            expressions: [
</a><a href="#h42-3-4" id="h42-3-4" class="d">-                (
</a><a href="#h42-3-5" id="h42-3-5" class="d">-                    Field(
</a><a href="#h42-3-6" id="h42-3-6" class="d">-                        1,
</a><a href="#h42-3-7" id="h42-3-7" class="i">+            labels: [
</a><a href="#h42-3-8" id="h42-3-8" class="i">+                None,
</a><a href="#h42-3-9" id="h42-3-9" class="i">+                Some(
</a><a href="#h42-3-10" id="h42-3-10" class="i">+                    (
</a>                         None,
<a href="#h42-3-12" id="h42-3-12" class="i">+                        &quot;rating&quot;,
</a>                     ),
<a href="#h42-3-14" id="h42-3-14" class="i">+                ),
</a><a href="#h42-3-15" id="h42-3-15" class="i">+            ],
</a><a href="#h42-3-16" id="h42-3-16" class="i">+            expressions: [
</a><a href="#h42-3-17" id="h42-3-17" class="i">+                Field(
</a><a href="#h42-3-18" id="h42-3-18" class="i">+                    1,
</a>                     None,
                 ),
<a href="#h42-3-21" id="h42-3-21" class="d">-                (
</a><a href="#h42-3-22" id="h42-3-22" class="d">-                    Field(
</a><a href="#h42-3-23" id="h42-3-23" class="d">-                        0,
</a><a href="#h42-3-24" id="h42-3-24" class="d">-                        None,
</a><a href="#h42-3-25" id="h42-3-25" class="d">-                    ),
</a><a href="#h42-3-26" id="h42-3-26" class="d">-                    Some(
</a><a href="#h42-3-27" id="h42-3-27" class="d">-                        &quot;rating&quot;,
</a><a href="#h42-3-28" id="h42-3-28" class="d">-                    ),
</a><a href="#h42-3-29" id="h42-3-29" class="i">+                Field(
</a><a href="#h42-3-30" id="h42-3-30" class="i">+                    0,
</a><a href="#h42-3-31" id="h42-3-31" class="i">+                    None,
</a>                 ),
             ],
         },
<b>diff --git a/<a id="h43" href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a> b/<a href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -174,54 +174,23 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h43-0-3" id="h43-0-3" class="i">+                    labels: [
</a><a href="#h43-0-4" id="h43-0-4" class="i">+                        None,
</a><a href="#h43-0-5" id="h43-0-5" class="i">+                        None,
</a><a href="#h43-0-6" id="h43-0-6" class="i">+                        None,
</a><a href="#h43-0-7" id="h43-0-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h43-0-9" id="h43-0-9" class="d">-                        (
</a><a href="#h43-0-10" id="h43-0-10" class="d">-                            Field(
</a><a href="#h43-0-11" id="h43-0-11" class="d">-                                5,
</a><a href="#h43-0-12" id="h43-0-12" class="d">-                                Some(
</a><a href="#h43-0-13" id="h43-0-13" class="d">-                                    (
</a><a href="#h43-0-14" id="h43-0-14" class="d">-                                        None,
</a><a href="#h43-0-15" id="h43-0-15" class="d">-                                        &quot;rating&quot;,
</a><a href="#h43-0-16" id="h43-0-16" class="d">-                                    ),
</a><a href="#h43-0-17" id="h43-0-17" class="d">-                                ),
</a><a href="#h43-0-18" id="h43-0-18" class="d">-                            ),
</a><a href="#h43-0-19" id="h43-0-19" class="d">-                            None,
</a><a href="#h43-0-20" id="h43-0-20" class="d">-                        ),
</a><a href="#h43-0-21" id="h43-0-21" class="d">-                        (
</a><a href="#h43-0-22" id="h43-0-22" class="d">-                            Field(
</a><a href="#h43-0-23" id="h43-0-23" class="d">-                                2,
</a><a href="#h43-0-24" id="h43-0-24" class="d">-                                Some(
</a><a href="#h43-0-25" id="h43-0-25" class="d">-                                    (
</a><a href="#h43-0-26" id="h43-0-26" class="d">-                                        None,
</a><a href="#h43-0-27" id="h43-0-27" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h43-0-28" id="h43-0-28" class="d">-                                    ),
</a><a href="#h43-0-29" id="h43-0-29" class="d">-                                ),
</a><a href="#h43-0-30" id="h43-0-30" class="d">-                            ),
</a><a href="#h43-0-31" id="h43-0-31" class="d">-                            None,
</a><a href="#h43-0-32" id="h43-0-32" class="d">-                        ),
</a><a href="#h43-0-33" id="h43-0-33" class="d">-                        (
</a><a href="#h43-0-34" id="h43-0-34" class="d">-                            Field(
</a><a href="#h43-0-35" id="h43-0-35" class="d">-                                3,
</a><a href="#h43-0-36" id="h43-0-36" class="d">-                                Some(
</a><a href="#h43-0-37" id="h43-0-37" class="d">-                                    (
</a><a href="#h43-0-38" id="h43-0-38" class="d">-                                        None,
</a><a href="#h43-0-39" id="h43-0-39" class="d">-                                        &quot;genre_id&quot;,
</a><a href="#h43-0-40" id="h43-0-40" class="d">-                                    ),
</a><a href="#h43-0-41" id="h43-0-41" class="i">+                        Field(
</a><a href="#h43-0-42" id="h43-0-42" class="i">+                            5,
</a><a href="#h43-0-43" id="h43-0-43" class="i">+                            Some(
</a><a href="#h43-0-44" id="h43-0-44" class="i">+                                (
</a><a href="#h43-0-45" id="h43-0-45" class="i">+                                    None,
</a><a href="#h43-0-46" id="h43-0-46" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h43-0-49" id="h43-0-49" class="d">-                            None,
</a>                         ),
<a href="#h43-0-51" id="h43-0-51" class="d">-                    ],
</a><a href="#h43-0-52" id="h43-0-52" class="d">-                },
</a><a href="#h43-0-53" id="h43-0-53" class="d">-                aggregates: [
</a><a href="#h43-0-54" id="h43-0-54" class="d">-                    Max,
</a><a href="#h43-0-55" id="h43-0-55" class="d">-                ],
</a><a href="#h43-0-56" id="h43-0-56" class="d">-            },
</a><a href="#h43-0-57" id="h43-0-57" class="d">-            expressions: [
</a><a href="#h43-0-58" id="h43-0-58" class="d">-                (
</a><a href="#h43-0-59" id="h43-0-59" class="d">-                    Add(
</a>                         Field(
<a href="#h43-0-61" id="h43-0-61" class="d">-                            1,
</a><a href="#h43-0-62" id="h43-0-62" class="i">+                            2,
</a>                             Some(
                                 (
                                     None,
<a href="#h43-1" id="h43-1" class="h">@@ -230,7 +199,7 @@ Plan: Select(
</a>                             ),
                         ),
                         Field(
<a href="#h43-1-3" id="h43-1-3" class="d">-                            2,
</a><a href="#h43-1-4" id="h43-1-4" class="i">+                            3,
</a>                             Some(
                                 (
                                     None,
<a href="#h43-2" id="h43-2" class="h">@@ -238,21 +207,52 @@ Plan: Select(
</a>                                 ),
                             ),
                         ),
<a href="#h43-2-3" id="h43-2-3" class="d">-                    ),
</a><a href="#h43-2-4" id="h43-2-4" class="d">-                    Some(
</a><a href="#h43-2-5" id="h43-2-5" class="i">+                    ],
</a><a href="#h43-2-6" id="h43-2-6" class="i">+                },
</a><a href="#h43-2-7" id="h43-2-7" class="i">+                aggregates: [
</a><a href="#h43-2-8" id="h43-2-8" class="i">+                    Max,
</a><a href="#h43-2-9" id="h43-2-9" class="i">+                ],
</a><a href="#h43-2-10" id="h43-2-10" class="i">+            },
</a><a href="#h43-2-11" id="h43-2-11" class="i">+            labels: [
</a><a href="#h43-2-12" id="h43-2-12" class="i">+                Some(
</a><a href="#h43-2-13" id="h43-2-13" class="i">+                    (
</a><a href="#h43-2-14" id="h43-2-14" class="i">+                        None,
</a>                         &quot;multi&quot;,
                     ),
                 ),
<a href="#h43-2-18" id="h43-2-18" class="d">-                (
</a><a href="#h43-2-19" id="h43-2-19" class="d">-                    Field(
</a><a href="#h43-2-20" id="h43-2-20" class="d">-                        0,
</a><a href="#h43-2-21" id="h43-2-21" class="i">+                Some(
</a><a href="#h43-2-22" id="h43-2-22" class="i">+                    (
</a>                         None,
<a href="#h43-2-24" id="h43-2-24" class="d">-                    ),
</a><a href="#h43-2-25" id="h43-2-25" class="d">-                    Some(
</a>                         &quot;rating&quot;,
                     ),
                 ),
             ],
<a href="#h43-2-30" id="h43-2-30" class="i">+            expressions: [
</a><a href="#h43-2-31" id="h43-2-31" class="i">+                Add(
</a><a href="#h43-2-32" id="h43-2-32" class="i">+                    Field(
</a><a href="#h43-2-33" id="h43-2-33" class="i">+                        1,
</a><a href="#h43-2-34" id="h43-2-34" class="i">+                        Some(
</a><a href="#h43-2-35" id="h43-2-35" class="i">+                            (
</a><a href="#h43-2-36" id="h43-2-36" class="i">+                                None,
</a><a href="#h43-2-37" id="h43-2-37" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h43-2-38" id="h43-2-38" class="i">+                            ),
</a><a href="#h43-2-39" id="h43-2-39" class="i">+                        ),
</a><a href="#h43-2-40" id="h43-2-40" class="i">+                    ),
</a><a href="#h43-2-41" id="h43-2-41" class="i">+                    Field(
</a><a href="#h43-2-42" id="h43-2-42" class="i">+                        2,
</a><a href="#h43-2-43" id="h43-2-43" class="i">+                        Some(
</a><a href="#h43-2-44" id="h43-2-44" class="i">+                            (
</a><a href="#h43-2-45" id="h43-2-45" class="i">+                                None,
</a><a href="#h43-2-46" id="h43-2-46" class="i">+                                &quot;genre_id&quot;,
</a><a href="#h43-2-47" id="h43-2-47" class="i">+                            ),
</a><a href="#h43-2-48" id="h43-2-48" class="i">+                        ),
</a><a href="#h43-2-49" id="h43-2-49" class="i">+                    ),
</a><a href="#h43-2-50" id="h43-2-50" class="i">+                ),
</a><a href="#h43-2-51" id="h43-2-51" class="i">+                Field(
</a><a href="#h43-2-52" id="h43-2-52" class="i">+                    0,
</a><a href="#h43-2-53" id="h43-2-53" class="i">+                    None,
</a><a href="#h43-2-54" id="h43-2-54" class="i">+                ),
</a><a href="#h43-2-55" id="h43-2-55" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h43-3" id="h43-3" class="h">@@ -369,54 +369,23 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h43-3-3" id="h43-3-3" class="i">+                    labels: [
</a><a href="#h43-3-4" id="h43-3-4" class="i">+                        None,
</a><a href="#h43-3-5" id="h43-3-5" class="i">+                        None,
</a><a href="#h43-3-6" id="h43-3-6" class="i">+                        None,
</a><a href="#h43-3-7" id="h43-3-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h43-3-9" id="h43-3-9" class="d">-                        (
</a><a href="#h43-3-10" id="h43-3-10" class="d">-                            Field(
</a><a href="#h43-3-11" id="h43-3-11" class="d">-                                5,
</a><a href="#h43-3-12" id="h43-3-12" class="d">-                                Some(
</a><a href="#h43-3-13" id="h43-3-13" class="d">-                                    (
</a><a href="#h43-3-14" id="h43-3-14" class="d">-                                        None,
</a><a href="#h43-3-15" id="h43-3-15" class="d">-                                        &quot;rating&quot;,
</a><a href="#h43-3-16" id="h43-3-16" class="d">-                                    ),
</a><a href="#h43-3-17" id="h43-3-17" class="d">-                                ),
</a><a href="#h43-3-18" id="h43-3-18" class="d">-                            ),
</a><a href="#h43-3-19" id="h43-3-19" class="d">-                            None,
</a><a href="#h43-3-20" id="h43-3-20" class="d">-                        ),
</a><a href="#h43-3-21" id="h43-3-21" class="d">-                        (
</a><a href="#h43-3-22" id="h43-3-22" class="d">-                            Field(
</a><a href="#h43-3-23" id="h43-3-23" class="d">-                                2,
</a><a href="#h43-3-24" id="h43-3-24" class="d">-                                Some(
</a><a href="#h43-3-25" id="h43-3-25" class="d">-                                    (
</a><a href="#h43-3-26" id="h43-3-26" class="d">-                                        None,
</a><a href="#h43-3-27" id="h43-3-27" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h43-3-28" id="h43-3-28" class="d">-                                    ),
</a><a href="#h43-3-29" id="h43-3-29" class="d">-                                ),
</a><a href="#h43-3-30" id="h43-3-30" class="d">-                            ),
</a><a href="#h43-3-31" id="h43-3-31" class="d">-                            None,
</a><a href="#h43-3-32" id="h43-3-32" class="d">-                        ),
</a><a href="#h43-3-33" id="h43-3-33" class="d">-                        (
</a><a href="#h43-3-34" id="h43-3-34" class="d">-                            Field(
</a><a href="#h43-3-35" id="h43-3-35" class="d">-                                3,
</a><a href="#h43-3-36" id="h43-3-36" class="d">-                                Some(
</a><a href="#h43-3-37" id="h43-3-37" class="d">-                                    (
</a><a href="#h43-3-38" id="h43-3-38" class="d">-                                        None,
</a><a href="#h43-3-39" id="h43-3-39" class="d">-                                        &quot;genre_id&quot;,
</a><a href="#h43-3-40" id="h43-3-40" class="d">-                                    ),
</a><a href="#h43-3-41" id="h43-3-41" class="i">+                        Field(
</a><a href="#h43-3-42" id="h43-3-42" class="i">+                            5,
</a><a href="#h43-3-43" id="h43-3-43" class="i">+                            Some(
</a><a href="#h43-3-44" id="h43-3-44" class="i">+                                (
</a><a href="#h43-3-45" id="h43-3-45" class="i">+                                    None,
</a><a href="#h43-3-46" id="h43-3-46" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h43-3-49" id="h43-3-49" class="d">-                            None,
</a>                         ),
<a href="#h43-3-51" id="h43-3-51" class="d">-                    ],
</a><a href="#h43-3-52" id="h43-3-52" class="d">-                },
</a><a href="#h43-3-53" id="h43-3-53" class="d">-                aggregates: [
</a><a href="#h43-3-54" id="h43-3-54" class="d">-                    Max,
</a><a href="#h43-3-55" id="h43-3-55" class="d">-                ],
</a><a href="#h43-3-56" id="h43-3-56" class="d">-            },
</a><a href="#h43-3-57" id="h43-3-57" class="d">-            expressions: [
</a><a href="#h43-3-58" id="h43-3-58" class="d">-                (
</a><a href="#h43-3-59" id="h43-3-59" class="d">-                    Add(
</a>                         Field(
<a href="#h43-3-61" id="h43-3-61" class="d">-                            1,
</a><a href="#h43-3-62" id="h43-3-62" class="i">+                            2,
</a>                             Some(
                                 (
                                     None,
<a href="#h43-4" id="h43-4" class="h">@@ -425,7 +394,7 @@ Optimized plan: Select(
</a>                             ),
                         ),
                         Field(
<a href="#h43-4-3" id="h43-4-3" class="d">-                            2,
</a><a href="#h43-4-4" id="h43-4-4" class="i">+                            3,
</a>                             Some(
                                 (
                                     None,
<a href="#h43-5" id="h43-5" class="h">@@ -433,21 +402,52 @@ Optimized plan: Select(
</a>                                 ),
                             ),
                         ),
<a href="#h43-5-3" id="h43-5-3" class="d">-                    ),
</a><a href="#h43-5-4" id="h43-5-4" class="d">-                    Some(
</a><a href="#h43-5-5" id="h43-5-5" class="i">+                    ],
</a><a href="#h43-5-6" id="h43-5-6" class="i">+                },
</a><a href="#h43-5-7" id="h43-5-7" class="i">+                aggregates: [
</a><a href="#h43-5-8" id="h43-5-8" class="i">+                    Max,
</a><a href="#h43-5-9" id="h43-5-9" class="i">+                ],
</a><a href="#h43-5-10" id="h43-5-10" class="i">+            },
</a><a href="#h43-5-11" id="h43-5-11" class="i">+            labels: [
</a><a href="#h43-5-12" id="h43-5-12" class="i">+                Some(
</a><a href="#h43-5-13" id="h43-5-13" class="i">+                    (
</a><a href="#h43-5-14" id="h43-5-14" class="i">+                        None,
</a>                         &quot;multi&quot;,
                     ),
                 ),
<a href="#h43-5-18" id="h43-5-18" class="d">-                (
</a><a href="#h43-5-19" id="h43-5-19" class="d">-                    Field(
</a><a href="#h43-5-20" id="h43-5-20" class="d">-                        0,
</a><a href="#h43-5-21" id="h43-5-21" class="i">+                Some(
</a><a href="#h43-5-22" id="h43-5-22" class="i">+                    (
</a>                         None,
<a href="#h43-5-24" id="h43-5-24" class="d">-                    ),
</a><a href="#h43-5-25" id="h43-5-25" class="d">-                    Some(
</a>                         &quot;rating&quot;,
                     ),
                 ),
             ],
<a href="#h43-5-30" id="h43-5-30" class="i">+            expressions: [
</a><a href="#h43-5-31" id="h43-5-31" class="i">+                Add(
</a><a href="#h43-5-32" id="h43-5-32" class="i">+                    Field(
</a><a href="#h43-5-33" id="h43-5-33" class="i">+                        1,
</a><a href="#h43-5-34" id="h43-5-34" class="i">+                        Some(
</a><a href="#h43-5-35" id="h43-5-35" class="i">+                            (
</a><a href="#h43-5-36" id="h43-5-36" class="i">+                                None,
</a><a href="#h43-5-37" id="h43-5-37" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h43-5-38" id="h43-5-38" class="i">+                            ),
</a><a href="#h43-5-39" id="h43-5-39" class="i">+                        ),
</a><a href="#h43-5-40" id="h43-5-40" class="i">+                    ),
</a><a href="#h43-5-41" id="h43-5-41" class="i">+                    Field(
</a><a href="#h43-5-42" id="h43-5-42" class="i">+                        2,
</a><a href="#h43-5-43" id="h43-5-43" class="i">+                        Some(
</a><a href="#h43-5-44" id="h43-5-44" class="i">+                            (
</a><a href="#h43-5-45" id="h43-5-45" class="i">+                                None,
</a><a href="#h43-5-46" id="h43-5-46" class="i">+                                &quot;genre_id&quot;,
</a><a href="#h43-5-47" id="h43-5-47" class="i">+                            ),
</a><a href="#h43-5-48" id="h43-5-48" class="i">+                        ),
</a><a href="#h43-5-49" id="h43-5-49" class="i">+                    ),
</a><a href="#h43-5-50" id="h43-5-50" class="i">+                ),
</a><a href="#h43-5-51" id="h43-5-51" class="i">+                Field(
</a><a href="#h43-5-52" id="h43-5-52" class="i">+                    0,
</a><a href="#h43-5-53" id="h43-5-53" class="i">+                    None,
</a><a href="#h43-5-54" id="h43-5-54" class="i">+                ),
</a><a href="#h43-5-55" id="h43-5-55" class="i">+            ],
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h44" href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a> b/<a href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -159,30 +159,28 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h44-0-3" id="h44-0-3" class="i">+                    labels: [
</a><a href="#h44-0-4" id="h44-0-4" class="i">+                        None,
</a><a href="#h44-0-5" id="h44-0-5" class="i">+                        None,
</a><a href="#h44-0-6" id="h44-0-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h44-0-8" id="h44-0-8" class="d">-                        (
</a><a href="#h44-0-9" id="h44-0-9" class="d">-                            Field(
</a><a href="#h44-0-10" id="h44-0-10" class="d">-                                5,
</a><a href="#h44-0-11" id="h44-0-11" class="d">-                                Some(
</a><a href="#h44-0-12" id="h44-0-12" class="d">-                                    (
</a><a href="#h44-0-13" id="h44-0-13" class="d">-                                        None,
</a><a href="#h44-0-14" id="h44-0-14" class="d">-                                        &quot;rating&quot;,
</a><a href="#h44-0-15" id="h44-0-15" class="d">-                                    ),
</a><a href="#h44-0-16" id="h44-0-16" class="i">+                        Field(
</a><a href="#h44-0-17" id="h44-0-17" class="i">+                            5,
</a><a href="#h44-0-18" id="h44-0-18" class="i">+                            Some(
</a><a href="#h44-0-19" id="h44-0-19" class="i">+                                (
</a><a href="#h44-0-20" id="h44-0-20" class="i">+                                    None,
</a><a href="#h44-0-21" id="h44-0-21" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h44-0-24" id="h44-0-24" class="d">-                            None,
</a>                         ),
<a href="#h44-0-26" id="h44-0-26" class="d">-                        (
</a><a href="#h44-0-27" id="h44-0-27" class="d">-                            Field(
</a><a href="#h44-0-28" id="h44-0-28" class="d">-                                2,
</a><a href="#h44-0-29" id="h44-0-29" class="d">-                                Some(
</a><a href="#h44-0-30" id="h44-0-30" class="d">-                                    (
</a><a href="#h44-0-31" id="h44-0-31" class="d">-                                        None,
</a><a href="#h44-0-32" id="h44-0-32" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h44-0-33" id="h44-0-33" class="d">-                                    ),
</a><a href="#h44-0-34" id="h44-0-34" class="i">+                        Field(
</a><a href="#h44-0-35" id="h44-0-35" class="i">+                            2,
</a><a href="#h44-0-36" id="h44-0-36" class="i">+                            Some(
</a><a href="#h44-0-37" id="h44-0-37" class="i">+                                (
</a><a href="#h44-0-38" id="h44-0-38" class="i">+                                    None,
</a><a href="#h44-0-39" id="h44-0-39" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h44-0-42" id="h44-0-42" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h44-1" id="h44-1" class="h">@@ -190,34 +188,35 @@ Plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h44-1-3" id="h44-1-3" class="i">+            labels: [
</a><a href="#h44-1-4" id="h44-1-4" class="i">+                None,
</a><a href="#h44-1-5" id="h44-1-5" class="i">+                Some(
</a><a href="#h44-1-6" id="h44-1-6" class="i">+                    (
</a><a href="#h44-1-7" id="h44-1-7" class="i">+                        None,
</a><a href="#h44-1-8" id="h44-1-8" class="i">+                        &quot;rating&quot;,
</a><a href="#h44-1-9" id="h44-1-9" class="i">+                    ),
</a><a href="#h44-1-10" id="h44-1-10" class="i">+                ),
</a><a href="#h44-1-11" id="h44-1-11" class="i">+            ],
</a>             expressions: [
<a href="#h44-1-13" id="h44-1-13" class="d">-                (
</a><a href="#h44-1-14" id="h44-1-14" class="d">-                    Multiply(
</a><a href="#h44-1-15" id="h44-1-15" class="d">-                        Field(
</a><a href="#h44-1-16" id="h44-1-16" class="d">-                            1,
</a><a href="#h44-1-17" id="h44-1-17" class="d">-                            Some(
</a><a href="#h44-1-18" id="h44-1-18" class="d">-                                (
</a><a href="#h44-1-19" id="h44-1-19" class="d">-                                    None,
</a><a href="#h44-1-20" id="h44-1-20" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h44-1-21" id="h44-1-21" class="d">-                                ),
</a><a href="#h44-1-22" id="h44-1-22" class="i">+                Multiply(
</a><a href="#h44-1-23" id="h44-1-23" class="i">+                    Field(
</a><a href="#h44-1-24" id="h44-1-24" class="i">+                        1,
</a><a href="#h44-1-25" id="h44-1-25" class="i">+                        Some(
</a><a href="#h44-1-26" id="h44-1-26" class="i">+                            (
</a><a href="#h44-1-27" id="h44-1-27" class="i">+                                None,
</a><a href="#h44-1-28" id="h44-1-28" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h44-1-31" id="h44-1-31" class="d">-                        Constant(
</a><a href="#h44-1-32" id="h44-1-32" class="d">-                            Integer(
</a><a href="#h44-1-33" id="h44-1-33" class="d">-                                2,
</a><a href="#h44-1-34" id="h44-1-34" class="d">-                            ),
</a><a href="#h44-1-35" id="h44-1-35" class="i">+                    ),
</a><a href="#h44-1-36" id="h44-1-36" class="i">+                    Constant(
</a><a href="#h44-1-37" id="h44-1-37" class="i">+                        Integer(
</a><a href="#h44-1-38" id="h44-1-38" class="i">+                            2,
</a>                         ),
                     ),
<a href="#h44-1-41" id="h44-1-41" class="d">-                    None,
</a>                 ),
<a href="#h44-1-43" id="h44-1-43" class="d">-                (
</a><a href="#h44-1-44" id="h44-1-44" class="d">-                    Field(
</a><a href="#h44-1-45" id="h44-1-45" class="d">-                        0,
</a><a href="#h44-1-46" id="h44-1-46" class="d">-                        None,
</a><a href="#h44-1-47" id="h44-1-47" class="d">-                    ),
</a><a href="#h44-1-48" id="h44-1-48" class="d">-                    Some(
</a><a href="#h44-1-49" id="h44-1-49" class="d">-                        &quot;rating&quot;,
</a><a href="#h44-1-50" id="h44-1-50" class="d">-                    ),
</a><a href="#h44-1-51" id="h44-1-51" class="i">+                Field(
</a><a href="#h44-1-52" id="h44-1-52" class="i">+                    0,
</a><a href="#h44-1-53" id="h44-1-53" class="i">+                    None,
</a>                 ),
             ],
         },
<a href="#h44-2" id="h44-2" class="h">@@ -324,30 +323,28 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h44-2-3" id="h44-2-3" class="i">+                    labels: [
</a><a href="#h44-2-4" id="h44-2-4" class="i">+                        None,
</a><a href="#h44-2-5" id="h44-2-5" class="i">+                        None,
</a><a href="#h44-2-6" id="h44-2-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h44-2-8" id="h44-2-8" class="d">-                        (
</a><a href="#h44-2-9" id="h44-2-9" class="d">-                            Field(
</a><a href="#h44-2-10" id="h44-2-10" class="d">-                                5,
</a><a href="#h44-2-11" id="h44-2-11" class="d">-                                Some(
</a><a href="#h44-2-12" id="h44-2-12" class="d">-                                    (
</a><a href="#h44-2-13" id="h44-2-13" class="d">-                                        None,
</a><a href="#h44-2-14" id="h44-2-14" class="d">-                                        &quot;rating&quot;,
</a><a href="#h44-2-15" id="h44-2-15" class="d">-                                    ),
</a><a href="#h44-2-16" id="h44-2-16" class="i">+                        Field(
</a><a href="#h44-2-17" id="h44-2-17" class="i">+                            5,
</a><a href="#h44-2-18" id="h44-2-18" class="i">+                            Some(
</a><a href="#h44-2-19" id="h44-2-19" class="i">+                                (
</a><a href="#h44-2-20" id="h44-2-20" class="i">+                                    None,
</a><a href="#h44-2-21" id="h44-2-21" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h44-2-24" id="h44-2-24" class="d">-                            None,
</a>                         ),
<a href="#h44-2-26" id="h44-2-26" class="d">-                        (
</a><a href="#h44-2-27" id="h44-2-27" class="d">-                            Field(
</a><a href="#h44-2-28" id="h44-2-28" class="d">-                                2,
</a><a href="#h44-2-29" id="h44-2-29" class="d">-                                Some(
</a><a href="#h44-2-30" id="h44-2-30" class="d">-                                    (
</a><a href="#h44-2-31" id="h44-2-31" class="d">-                                        None,
</a><a href="#h44-2-32" id="h44-2-32" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h44-2-33" id="h44-2-33" class="d">-                                    ),
</a><a href="#h44-2-34" id="h44-2-34" class="i">+                        Field(
</a><a href="#h44-2-35" id="h44-2-35" class="i">+                            2,
</a><a href="#h44-2-36" id="h44-2-36" class="i">+                            Some(
</a><a href="#h44-2-37" id="h44-2-37" class="i">+                                (
</a><a href="#h44-2-38" id="h44-2-38" class="i">+                                    None,
</a><a href="#h44-2-39" id="h44-2-39" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h44-2-42" id="h44-2-42" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h44-3" id="h44-3" class="h">@@ -355,34 +352,35 @@ Optimized plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h44-3-3" id="h44-3-3" class="i">+            labels: [
</a><a href="#h44-3-4" id="h44-3-4" class="i">+                None,
</a><a href="#h44-3-5" id="h44-3-5" class="i">+                Some(
</a><a href="#h44-3-6" id="h44-3-6" class="i">+                    (
</a><a href="#h44-3-7" id="h44-3-7" class="i">+                        None,
</a><a href="#h44-3-8" id="h44-3-8" class="i">+                        &quot;rating&quot;,
</a><a href="#h44-3-9" id="h44-3-9" class="i">+                    ),
</a><a href="#h44-3-10" id="h44-3-10" class="i">+                ),
</a><a href="#h44-3-11" id="h44-3-11" class="i">+            ],
</a>             expressions: [
<a href="#h44-3-13" id="h44-3-13" class="d">-                (
</a><a href="#h44-3-14" id="h44-3-14" class="d">-                    Multiply(
</a><a href="#h44-3-15" id="h44-3-15" class="d">-                        Field(
</a><a href="#h44-3-16" id="h44-3-16" class="d">-                            1,
</a><a href="#h44-3-17" id="h44-3-17" class="d">-                            Some(
</a><a href="#h44-3-18" id="h44-3-18" class="d">-                                (
</a><a href="#h44-3-19" id="h44-3-19" class="d">-                                    None,
</a><a href="#h44-3-20" id="h44-3-20" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h44-3-21" id="h44-3-21" class="d">-                                ),
</a><a href="#h44-3-22" id="h44-3-22" class="i">+                Multiply(
</a><a href="#h44-3-23" id="h44-3-23" class="i">+                    Field(
</a><a href="#h44-3-24" id="h44-3-24" class="i">+                        1,
</a><a href="#h44-3-25" id="h44-3-25" class="i">+                        Some(
</a><a href="#h44-3-26" id="h44-3-26" class="i">+                            (
</a><a href="#h44-3-27" id="h44-3-27" class="i">+                                None,
</a><a href="#h44-3-28" id="h44-3-28" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h44-3-31" id="h44-3-31" class="d">-                        Constant(
</a><a href="#h44-3-32" id="h44-3-32" class="d">-                            Integer(
</a><a href="#h44-3-33" id="h44-3-33" class="d">-                                2,
</a><a href="#h44-3-34" id="h44-3-34" class="d">-                            ),
</a><a href="#h44-3-35" id="h44-3-35" class="i">+                    ),
</a><a href="#h44-3-36" id="h44-3-36" class="i">+                    Constant(
</a><a href="#h44-3-37" id="h44-3-37" class="i">+                        Integer(
</a><a href="#h44-3-38" id="h44-3-38" class="i">+                            2,
</a>                         ),
                     ),
<a href="#h44-3-41" id="h44-3-41" class="d">-                    None,
</a>                 ),
<a href="#h44-3-43" id="h44-3-43" class="d">-                (
</a><a href="#h44-3-44" id="h44-3-44" class="d">-                    Field(
</a><a href="#h44-3-45" id="h44-3-45" class="d">-                        0,
</a><a href="#h44-3-46" id="h44-3-46" class="d">-                        None,
</a><a href="#h44-3-47" id="h44-3-47" class="d">-                    ),
</a><a href="#h44-3-48" id="h44-3-48" class="d">-                    Some(
</a><a href="#h44-3-49" id="h44-3-49" class="d">-                        &quot;rating&quot;,
</a><a href="#h44-3-50" id="h44-3-50" class="d">-                    ),
</a><a href="#h44-3-51" id="h44-3-51" class="i">+                Field(
</a><a href="#h44-3-52" id="h44-3-52" class="i">+                    0,
</a><a href="#h44-3-53" id="h44-3-53" class="i">+                    None,
</a>                 ),
             ],
         },
<b>diff --git a/<a id="h45" href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a> b/<a href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -261,28 +261,26 @@ Plan: Select(
</a>                         ),
                         outer: false,
                     },
<a href="#h45-0-3" id="h45-0-3" class="i">+                    labels: [
</a><a href="#h45-0-4" id="h45-0-4" class="i">+                        None,
</a><a href="#h45-0-5" id="h45-0-5" class="i">+                        None,
</a><a href="#h45-0-6" id="h45-0-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h45-0-8" id="h45-0-8" class="d">-                        (
</a><a href="#h45-0-9" id="h45-0-9" class="d">-                            Constant(
</a><a href="#h45-0-10" id="h45-0-10" class="d">-                                Boolean(
</a><a href="#h45-0-11" id="h45-0-11" class="d">-                                    true,
</a><a href="#h45-0-12" id="h45-0-12" class="d">-                                ),
</a><a href="#h45-0-13" id="h45-0-13" class="i">+                        Constant(
</a><a href="#h45-0-14" id="h45-0-14" class="i">+                            Boolean(
</a><a href="#h45-0-15" id="h45-0-15" class="i">+                                true,
</a>                             ),
<a href="#h45-0-17" id="h45-0-17" class="d">-                            None,
</a>                         ),
<a href="#h45-0-19" id="h45-0-19" class="d">-                        (
</a><a href="#h45-0-20" id="h45-0-20" class="d">-                            Field(
</a><a href="#h45-0-21" id="h45-0-21" class="d">-                                8,
</a><a href="#h45-0-22" id="h45-0-22" class="d">-                                Some(
</a><a href="#h45-0-23" id="h45-0-23" class="d">-                                    (
</a><a href="#h45-0-24" id="h45-0-24" class="d">-                                        Some(
</a><a href="#h45-0-25" id="h45-0-25" class="d">-                                            &quot;s&quot;,
</a><a href="#h45-0-26" id="h45-0-26" class="d">-                                        ),
</a><a href="#h45-0-27" id="h45-0-27" class="d">-                                        &quot;name&quot;,
</a><a href="#h45-0-28" id="h45-0-28" class="i">+                        Field(
</a><a href="#h45-0-29" id="h45-0-29" class="i">+                            8,
</a><a href="#h45-0-30" id="h45-0-30" class="i">+                            Some(
</a><a href="#h45-0-31" id="h45-0-31" class="i">+                                (
</a><a href="#h45-0-32" id="h45-0-32" class="i">+                                    Some(
</a><a href="#h45-0-33" id="h45-0-33" class="i">+                                        &quot;s&quot;,
</a>                                     ),
<a href="#h45-0-35" id="h45-0-35" class="i">+                                    &quot;name&quot;,
</a>                                 ),
                             ),
<a href="#h45-0-38" id="h45-0-38" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h45-1" id="h45-1" class="h">@@ -290,26 +288,24 @@ Plan: Select(
</a>                     Count,
                 ],
             },
<a href="#h45-1-3" id="h45-1-3" class="i">+            labels: [
</a><a href="#h45-1-4" id="h45-1-4" class="i">+                None,
</a><a href="#h45-1-5" id="h45-1-5" class="i">+                None,
</a><a href="#h45-1-6" id="h45-1-6" class="i">+            ],
</a>             expressions: [
<a href="#h45-1-8" id="h45-1-8" class="d">-                (
</a><a href="#h45-1-9" id="h45-1-9" class="d">-                    Field(
</a><a href="#h45-1-10" id="h45-1-10" class="d">-                        1,
</a><a href="#h45-1-11" id="h45-1-11" class="d">-                        Some(
</a><a href="#h45-1-12" id="h45-1-12" class="d">-                            (
</a><a href="#h45-1-13" id="h45-1-13" class="d">-                                Some(
</a><a href="#h45-1-14" id="h45-1-14" class="d">-                                    &quot;s&quot;,
</a><a href="#h45-1-15" id="h45-1-15" class="d">-                                ),
</a><a href="#h45-1-16" id="h45-1-16" class="d">-                                &quot;name&quot;,
</a><a href="#h45-1-17" id="h45-1-17" class="i">+                Field(
</a><a href="#h45-1-18" id="h45-1-18" class="i">+                    1,
</a><a href="#h45-1-19" id="h45-1-19" class="i">+                    Some(
</a><a href="#h45-1-20" id="h45-1-20" class="i">+                        (
</a><a href="#h45-1-21" id="h45-1-21" class="i">+                            Some(
</a><a href="#h45-1-22" id="h45-1-22" class="i">+                                &quot;s&quot;,
</a>                             ),
<a href="#h45-1-24" id="h45-1-24" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h45-1-27" id="h45-1-27" class="d">-                    None,
</a>                 ),
<a href="#h45-1-29" id="h45-1-29" class="d">-                (
</a><a href="#h45-1-30" id="h45-1-30" class="d">-                    Field(
</a><a href="#h45-1-31" id="h45-1-31" class="d">-                        0,
</a><a href="#h45-1-32" id="h45-1-32" class="d">-                        None,
</a><a href="#h45-1-33" id="h45-1-33" class="d">-                    ),
</a><a href="#h45-1-34" id="h45-1-34" class="i">+                Field(
</a><a href="#h45-1-35" id="h45-1-35" class="i">+                    0,
</a>                     None,
                 ),
             ],
<a href="#h45-2" id="h45-2" class="h">@@ -489,28 +485,26 @@ Optimized plan: Select(
</a>                         ),
                         outer: false,
                     },
<a href="#h45-2-3" id="h45-2-3" class="i">+                    labels: [
</a><a href="#h45-2-4" id="h45-2-4" class="i">+                        None,
</a><a href="#h45-2-5" id="h45-2-5" class="i">+                        None,
</a><a href="#h45-2-6" id="h45-2-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h45-2-8" id="h45-2-8" class="d">-                        (
</a><a href="#h45-2-9" id="h45-2-9" class="d">-                            Constant(
</a><a href="#h45-2-10" id="h45-2-10" class="d">-                                Boolean(
</a><a href="#h45-2-11" id="h45-2-11" class="d">-                                    true,
</a><a href="#h45-2-12" id="h45-2-12" class="d">-                                ),
</a><a href="#h45-2-13" id="h45-2-13" class="i">+                        Constant(
</a><a href="#h45-2-14" id="h45-2-14" class="i">+                            Boolean(
</a><a href="#h45-2-15" id="h45-2-15" class="i">+                                true,
</a>                             ),
<a href="#h45-2-17" id="h45-2-17" class="d">-                            None,
</a>                         ),
<a href="#h45-2-19" id="h45-2-19" class="d">-                        (
</a><a href="#h45-2-20" id="h45-2-20" class="d">-                            Field(
</a><a href="#h45-2-21" id="h45-2-21" class="d">-                                8,
</a><a href="#h45-2-22" id="h45-2-22" class="d">-                                Some(
</a><a href="#h45-2-23" id="h45-2-23" class="d">-                                    (
</a><a href="#h45-2-24" id="h45-2-24" class="d">-                                        Some(
</a><a href="#h45-2-25" id="h45-2-25" class="d">-                                            &quot;s&quot;,
</a><a href="#h45-2-26" id="h45-2-26" class="d">-                                        ),
</a><a href="#h45-2-27" id="h45-2-27" class="d">-                                        &quot;name&quot;,
</a><a href="#h45-2-28" id="h45-2-28" class="i">+                        Field(
</a><a href="#h45-2-29" id="h45-2-29" class="i">+                            8,
</a><a href="#h45-2-30" id="h45-2-30" class="i">+                            Some(
</a><a href="#h45-2-31" id="h45-2-31" class="i">+                                (
</a><a href="#h45-2-32" id="h45-2-32" class="i">+                                    Some(
</a><a href="#h45-2-33" id="h45-2-33" class="i">+                                        &quot;s&quot;,
</a>                                     ),
<a href="#h45-2-35" id="h45-2-35" class="i">+                                    &quot;name&quot;,
</a>                                 ),
                             ),
<a href="#h45-2-38" id="h45-2-38" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h45-3" id="h45-3" class="h">@@ -518,26 +512,24 @@ Optimized plan: Select(
</a>                     Count,
                 ],
             },
<a href="#h45-3-3" id="h45-3-3" class="i">+            labels: [
</a><a href="#h45-3-4" id="h45-3-4" class="i">+                None,
</a><a href="#h45-3-5" id="h45-3-5" class="i">+                None,
</a><a href="#h45-3-6" id="h45-3-6" class="i">+            ],
</a>             expressions: [
<a href="#h45-3-8" id="h45-3-8" class="d">-                (
</a><a href="#h45-3-9" id="h45-3-9" class="d">-                    Field(
</a><a href="#h45-3-10" id="h45-3-10" class="d">-                        1,
</a><a href="#h45-3-11" id="h45-3-11" class="d">-                        Some(
</a><a href="#h45-3-12" id="h45-3-12" class="d">-                            (
</a><a href="#h45-3-13" id="h45-3-13" class="d">-                                Some(
</a><a href="#h45-3-14" id="h45-3-14" class="d">-                                    &quot;s&quot;,
</a><a href="#h45-3-15" id="h45-3-15" class="d">-                                ),
</a><a href="#h45-3-16" id="h45-3-16" class="d">-                                &quot;name&quot;,
</a><a href="#h45-3-17" id="h45-3-17" class="i">+                Field(
</a><a href="#h45-3-18" id="h45-3-18" class="i">+                    1,
</a><a href="#h45-3-19" id="h45-3-19" class="i">+                    Some(
</a><a href="#h45-3-20" id="h45-3-20" class="i">+                        (
</a><a href="#h45-3-21" id="h45-3-21" class="i">+                            Some(
</a><a href="#h45-3-22" id="h45-3-22" class="i">+                                &quot;s&quot;,
</a>                             ),
<a href="#h45-3-24" id="h45-3-24" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h45-3-27" id="h45-3-27" class="d">-                    None,
</a>                 ),
<a href="#h45-3-29" id="h45-3-29" class="d">-                (
</a><a href="#h45-3-30" id="h45-3-30" class="d">-                    Field(
</a><a href="#h45-3-31" id="h45-3-31" class="d">-                        0,
</a><a href="#h45-3-32" id="h45-3-32" class="d">-                        None,
</a><a href="#h45-3-33" id="h45-3-33" class="d">-                    ),
</a><a href="#h45-3-34" id="h45-3-34" class="i">+                Field(
</a><a href="#h45-3-35" id="h45-3-35" class="i">+                    0,
</a>                     None,
                 ),
             ],
<b>diff --git a/<a id="h46" href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a> b/<a href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -142,37 +142,37 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h46-0-3" id="h46-0-3" class="i">+                    labels: [
</a><a href="#h46-0-4" id="h46-0-4" class="i">+                        None,
</a><a href="#h46-0-5" id="h46-0-5" class="i">+                    ],
</a>                     expressions: [
<a href="#h46-0-7" id="h46-0-7" class="d">-                        (
</a><a href="#h46-0-8" id="h46-0-8" class="d">-                            Field(
</a><a href="#h46-0-9" id="h46-0-9" class="d">-                                1,
</a><a href="#h46-0-10" id="h46-0-10" class="d">-                                Some(
</a><a href="#h46-0-11" id="h46-0-11" class="d">-                                    (
</a><a href="#h46-0-12" id="h46-0-12" class="d">-                                        None,
</a><a href="#h46-0-13" id="h46-0-13" class="d">-                                        &quot;title&quot;,
</a><a href="#h46-0-14" id="h46-0-14" class="d">-                                    ),
</a><a href="#h46-0-15" id="h46-0-15" class="i">+                        Field(
</a><a href="#h46-0-16" id="h46-0-16" class="i">+                            1,
</a><a href="#h46-0-17" id="h46-0-17" class="i">+                            Some(
</a><a href="#h46-0-18" id="h46-0-18" class="i">+                                (
</a><a href="#h46-0-19" id="h46-0-19" class="i">+                                    None,
</a><a href="#h46-0-20" id="h46-0-20" class="i">+                                    &quot;title&quot;,
</a>                                 ),
                             ),
<a href="#h46-0-23" id="h46-0-23" class="d">-                            None,
</a>                         ),
                     ],
                 },
                 aggregates: [],
             },
<a href="#h46-0-29" id="h46-0-29" class="i">+            labels: [
</a><a href="#h46-0-30" id="h46-0-30" class="i">+                None,
</a><a href="#h46-0-31" id="h46-0-31" class="i">+            ],
</a>             expressions: [
<a href="#h46-0-33" id="h46-0-33" class="d">-                (
</a><a href="#h46-0-34" id="h46-0-34" class="d">-                    Field(
</a><a href="#h46-0-35" id="h46-0-35" class="d">-                        0,
</a><a href="#h46-0-36" id="h46-0-36" class="d">-                        Some(
</a><a href="#h46-0-37" id="h46-0-37" class="d">-                            (
</a><a href="#h46-0-38" id="h46-0-38" class="d">-                                Some(
</a><a href="#h46-0-39" id="h46-0-39" class="d">-                                    &quot;movies&quot;,
</a><a href="#h46-0-40" id="h46-0-40" class="d">-                                ),
</a><a href="#h46-0-41" id="h46-0-41" class="d">-                                &quot;title&quot;,
</a><a href="#h46-0-42" id="h46-0-42" class="i">+                Field(
</a><a href="#h46-0-43" id="h46-0-43" class="i">+                    0,
</a><a href="#h46-0-44" id="h46-0-44" class="i">+                    Some(
</a><a href="#h46-0-45" id="h46-0-45" class="i">+                        (
</a><a href="#h46-0-46" id="h46-0-46" class="i">+                            Some(
</a><a href="#h46-0-47" id="h46-0-47" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h46-0-49" id="h46-0-49" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h46-0-52" id="h46-0-52" class="d">-                    None,
</a>                 ),
             ],
         },
<a href="#h46-1" id="h46-1" class="h">@@ -281,37 +281,37 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h46-1-3" id="h46-1-3" class="i">+                    labels: [
</a><a href="#h46-1-4" id="h46-1-4" class="i">+                        None,
</a><a href="#h46-1-5" id="h46-1-5" class="i">+                    ],
</a>                     expressions: [
<a href="#h46-1-7" id="h46-1-7" class="d">-                        (
</a><a href="#h46-1-8" id="h46-1-8" class="d">-                            Field(
</a><a href="#h46-1-9" id="h46-1-9" class="d">-                                1,
</a><a href="#h46-1-10" id="h46-1-10" class="d">-                                Some(
</a><a href="#h46-1-11" id="h46-1-11" class="d">-                                    (
</a><a href="#h46-1-12" id="h46-1-12" class="d">-                                        None,
</a><a href="#h46-1-13" id="h46-1-13" class="d">-                                        &quot;title&quot;,
</a><a href="#h46-1-14" id="h46-1-14" class="d">-                                    ),
</a><a href="#h46-1-15" id="h46-1-15" class="i">+                        Field(
</a><a href="#h46-1-16" id="h46-1-16" class="i">+                            1,
</a><a href="#h46-1-17" id="h46-1-17" class="i">+                            Some(
</a><a href="#h46-1-18" id="h46-1-18" class="i">+                                (
</a><a href="#h46-1-19" id="h46-1-19" class="i">+                                    None,
</a><a href="#h46-1-20" id="h46-1-20" class="i">+                                    &quot;title&quot;,
</a>                                 ),
                             ),
<a href="#h46-1-23" id="h46-1-23" class="d">-                            None,
</a>                         ),
                     ],
                 },
                 aggregates: [],
             },
<a href="#h46-1-29" id="h46-1-29" class="i">+            labels: [
</a><a href="#h46-1-30" id="h46-1-30" class="i">+                None,
</a><a href="#h46-1-31" id="h46-1-31" class="i">+            ],
</a>             expressions: [
<a href="#h46-1-33" id="h46-1-33" class="d">-                (
</a><a href="#h46-1-34" id="h46-1-34" class="d">-                    Field(
</a><a href="#h46-1-35" id="h46-1-35" class="d">-                        0,
</a><a href="#h46-1-36" id="h46-1-36" class="d">-                        Some(
</a><a href="#h46-1-37" id="h46-1-37" class="d">-                            (
</a><a href="#h46-1-38" id="h46-1-38" class="d">-                                Some(
</a><a href="#h46-1-39" id="h46-1-39" class="d">-                                    &quot;movies&quot;,
</a><a href="#h46-1-40" id="h46-1-40" class="d">-                                ),
</a><a href="#h46-1-41" id="h46-1-41" class="d">-                                &quot;title&quot;,
</a><a href="#h46-1-42" id="h46-1-42" class="i">+                Field(
</a><a href="#h46-1-43" id="h46-1-43" class="i">+                    0,
</a><a href="#h46-1-44" id="h46-1-44" class="i">+                    Some(
</a><a href="#h46-1-45" id="h46-1-45" class="i">+                        (
</a><a href="#h46-1-46" id="h46-1-46" class="i">+                            Some(
</a><a href="#h46-1-47" id="h46-1-47" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h46-1-49" id="h46-1-49" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h46-1-52" id="h46-1-52" class="d">-                    None,
</a>                 ),
             ],
         },
<b>diff --git a/<a id="h47" href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a> b/<a href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -143,30 +143,28 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h47-0-3" id="h47-0-3" class="i">+                    labels: [
</a><a href="#h47-0-4" id="h47-0-4" class="i">+                        None,
</a><a href="#h47-0-5" id="h47-0-5" class="i">+                        None,
</a><a href="#h47-0-6" id="h47-0-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h47-0-8" id="h47-0-8" class="d">-                        (
</a><a href="#h47-0-9" id="h47-0-9" class="d">-                            Field(
</a><a href="#h47-0-10" id="h47-0-10" class="d">-                                5,
</a><a href="#h47-0-11" id="h47-0-11" class="d">-                                Some(
</a><a href="#h47-0-12" id="h47-0-12" class="d">-                                    (
</a><a href="#h47-0-13" id="h47-0-13" class="d">-                                        None,
</a><a href="#h47-0-14" id="h47-0-14" class="d">-                                        &quot;rating&quot;,
</a><a href="#h47-0-15" id="h47-0-15" class="d">-                                    ),
</a><a href="#h47-0-16" id="h47-0-16" class="i">+                        Field(
</a><a href="#h47-0-17" id="h47-0-17" class="i">+                            5,
</a><a href="#h47-0-18" id="h47-0-18" class="i">+                            Some(
</a><a href="#h47-0-19" id="h47-0-19" class="i">+                                (
</a><a href="#h47-0-20" id="h47-0-20" class="i">+                                    None,
</a><a href="#h47-0-21" id="h47-0-21" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h47-0-24" id="h47-0-24" class="d">-                            None,
</a>                         ),
<a href="#h47-0-26" id="h47-0-26" class="d">-                        (
</a><a href="#h47-0-27" id="h47-0-27" class="d">-                            Field(
</a><a href="#h47-0-28" id="h47-0-28" class="d">-                                2,
</a><a href="#h47-0-29" id="h47-0-29" class="d">-                                Some(
</a><a href="#h47-0-30" id="h47-0-30" class="d">-                                    (
</a><a href="#h47-0-31" id="h47-0-31" class="d">-                                        None,
</a><a href="#h47-0-32" id="h47-0-32" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h47-0-33" id="h47-0-33" class="d">-                                    ),
</a><a href="#h47-0-34" id="h47-0-34" class="i">+                        Field(
</a><a href="#h47-0-35" id="h47-0-35" class="i">+                            2,
</a><a href="#h47-0-36" id="h47-0-36" class="i">+                            Some(
</a><a href="#h47-0-37" id="h47-0-37" class="i">+                                (
</a><a href="#h47-0-38" id="h47-0-38" class="i">+                                    None,
</a><a href="#h47-0-39" id="h47-0-39" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h47-0-42" id="h47-0-42" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h47-1" id="h47-1" class="h">@@ -174,17 +172,20 @@ Plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h47-1-3" id="h47-1-3" class="d">-            expressions: [
</a><a href="#h47-1-4" id="h47-1-4" class="d">-                (
</a><a href="#h47-1-5" id="h47-1-5" class="d">-                    Field(
</a><a href="#h47-1-6" id="h47-1-6" class="d">-                        0,
</a><a href="#h47-1-7" id="h47-1-7" class="i">+            labels: [
</a><a href="#h47-1-8" id="h47-1-8" class="i">+                Some(
</a><a href="#h47-1-9" id="h47-1-9" class="i">+                    (
</a>                         None,
<a href="#h47-1-11" id="h47-1-11" class="d">-                    ),
</a><a href="#h47-1-12" id="h47-1-12" class="d">-                    Some(
</a>                         &quot;best&quot;,
                     ),
                 ),
             ],
<a href="#h47-1-17" id="h47-1-17" class="i">+            expressions: [
</a><a href="#h47-1-18" id="h47-1-18" class="i">+                Field(
</a><a href="#h47-1-19" id="h47-1-19" class="i">+                    0,
</a><a href="#h47-1-20" id="h47-1-20" class="i">+                    None,
</a><a href="#h47-1-21" id="h47-1-21" class="i">+                ),
</a><a href="#h47-1-22" id="h47-1-22" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h47-2" id="h47-2" class="h">@@ -289,30 +290,28 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h47-2-3" id="h47-2-3" class="i">+                    labels: [
</a><a href="#h47-2-4" id="h47-2-4" class="i">+                        None,
</a><a href="#h47-2-5" id="h47-2-5" class="i">+                        None,
</a><a href="#h47-2-6" id="h47-2-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h47-2-8" id="h47-2-8" class="d">-                        (
</a><a href="#h47-2-9" id="h47-2-9" class="d">-                            Field(
</a><a href="#h47-2-10" id="h47-2-10" class="d">-                                5,
</a><a href="#h47-2-11" id="h47-2-11" class="d">-                                Some(
</a><a href="#h47-2-12" id="h47-2-12" class="d">-                                    (
</a><a href="#h47-2-13" id="h47-2-13" class="d">-                                        None,
</a><a href="#h47-2-14" id="h47-2-14" class="d">-                                        &quot;rating&quot;,
</a><a href="#h47-2-15" id="h47-2-15" class="d">-                                    ),
</a><a href="#h47-2-16" id="h47-2-16" class="i">+                        Field(
</a><a href="#h47-2-17" id="h47-2-17" class="i">+                            5,
</a><a href="#h47-2-18" id="h47-2-18" class="i">+                            Some(
</a><a href="#h47-2-19" id="h47-2-19" class="i">+                                (
</a><a href="#h47-2-20" id="h47-2-20" class="i">+                                    None,
</a><a href="#h47-2-21" id="h47-2-21" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h47-2-24" id="h47-2-24" class="d">-                            None,
</a>                         ),
<a href="#h47-2-26" id="h47-2-26" class="d">-                        (
</a><a href="#h47-2-27" id="h47-2-27" class="d">-                            Field(
</a><a href="#h47-2-28" id="h47-2-28" class="d">-                                2,
</a><a href="#h47-2-29" id="h47-2-29" class="d">-                                Some(
</a><a href="#h47-2-30" id="h47-2-30" class="d">-                                    (
</a><a href="#h47-2-31" id="h47-2-31" class="d">-                                        None,
</a><a href="#h47-2-32" id="h47-2-32" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h47-2-33" id="h47-2-33" class="d">-                                    ),
</a><a href="#h47-2-34" id="h47-2-34" class="i">+                        Field(
</a><a href="#h47-2-35" id="h47-2-35" class="i">+                            2,
</a><a href="#h47-2-36" id="h47-2-36" class="i">+                            Some(
</a><a href="#h47-2-37" id="h47-2-37" class="i">+                                (
</a><a href="#h47-2-38" id="h47-2-38" class="i">+                                    None,
</a><a href="#h47-2-39" id="h47-2-39" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h47-2-42" id="h47-2-42" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h47-3" id="h47-3" class="h">@@ -320,17 +319,20 @@ Optimized plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h47-3-3" id="h47-3-3" class="d">-            expressions: [
</a><a href="#h47-3-4" id="h47-3-4" class="d">-                (
</a><a href="#h47-3-5" id="h47-3-5" class="d">-                    Field(
</a><a href="#h47-3-6" id="h47-3-6" class="d">-                        0,
</a><a href="#h47-3-7" id="h47-3-7" class="i">+            labels: [
</a><a href="#h47-3-8" id="h47-3-8" class="i">+                Some(
</a><a href="#h47-3-9" id="h47-3-9" class="i">+                    (
</a>                         None,
<a href="#h47-3-11" id="h47-3-11" class="d">-                    ),
</a><a href="#h47-3-12" id="h47-3-12" class="d">-                    Some(
</a>                         &quot;best&quot;,
                     ),
                 ),
             ],
<a href="#h47-3-17" id="h47-3-17" class="i">+            expressions: [
</a><a href="#h47-3-18" id="h47-3-18" class="i">+                Field(
</a><a href="#h47-3-19" id="h47-3-19" class="i">+                    0,
</a><a href="#h47-3-20" id="h47-3-20" class="i">+                    None,
</a><a href="#h47-3-21" id="h47-3-21" class="i">+                ),
</a><a href="#h47-3-22" id="h47-3-22" class="i">+            ],
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h48" href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a> b/<a href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -148,30 +148,28 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h48-0-3" id="h48-0-3" class="i">+                    labels: [
</a><a href="#h48-0-4" id="h48-0-4" class="i">+                        None,
</a><a href="#h48-0-5" id="h48-0-5" class="i">+                        None,
</a><a href="#h48-0-6" id="h48-0-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h48-0-8" id="h48-0-8" class="d">-                        (
</a><a href="#h48-0-9" id="h48-0-9" class="d">-                            Field(
</a><a href="#h48-0-10" id="h48-0-10" class="d">-                                5,
</a><a href="#h48-0-11" id="h48-0-11" class="d">-                                Some(
</a><a href="#h48-0-12" id="h48-0-12" class="d">-                                    (
</a><a href="#h48-0-13" id="h48-0-13" class="d">-                                        None,
</a><a href="#h48-0-14" id="h48-0-14" class="d">-                                        &quot;rating&quot;,
</a><a href="#h48-0-15" id="h48-0-15" class="d">-                                    ),
</a><a href="#h48-0-16" id="h48-0-16" class="i">+                        Field(
</a><a href="#h48-0-17" id="h48-0-17" class="i">+                            5,
</a><a href="#h48-0-18" id="h48-0-18" class="i">+                            Some(
</a><a href="#h48-0-19" id="h48-0-19" class="i">+                                (
</a><a href="#h48-0-20" id="h48-0-20" class="i">+                                    None,
</a><a href="#h48-0-21" id="h48-0-21" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h48-0-24" id="h48-0-24" class="d">-                            None,
</a>                         ),
<a href="#h48-0-26" id="h48-0-26" class="d">-                        (
</a><a href="#h48-0-27" id="h48-0-27" class="d">-                            Field(
</a><a href="#h48-0-28" id="h48-0-28" class="d">-                                2,
</a><a href="#h48-0-29" id="h48-0-29" class="d">-                                Some(
</a><a href="#h48-0-30" id="h48-0-30" class="d">-                                    (
</a><a href="#h48-0-31" id="h48-0-31" class="d">-                                        None,
</a><a href="#h48-0-32" id="h48-0-32" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h48-0-33" id="h48-0-33" class="d">-                                    ),
</a><a href="#h48-0-34" id="h48-0-34" class="i">+                        Field(
</a><a href="#h48-0-35" id="h48-0-35" class="i">+                            2,
</a><a href="#h48-0-36" id="h48-0-36" class="i">+                            Some(
</a><a href="#h48-0-37" id="h48-0-37" class="i">+                                (
</a><a href="#h48-0-38" id="h48-0-38" class="i">+                                    None,
</a><a href="#h48-0-39" id="h48-0-39" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h48-0-42" id="h48-0-42" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h48-1" id="h48-1" class="h">@@ -179,26 +177,24 @@ Plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h48-1-3" id="h48-1-3" class="i">+            labels: [
</a><a href="#h48-1-4" id="h48-1-4" class="i">+                None,
</a><a href="#h48-1-5" id="h48-1-5" class="i">+                None,
</a><a href="#h48-1-6" id="h48-1-6" class="i">+            ],
</a>             expressions: [
<a href="#h48-1-8" id="h48-1-8" class="d">-                (
</a><a href="#h48-1-9" id="h48-1-9" class="d">-                    Field(
</a><a href="#h48-1-10" id="h48-1-10" class="d">-                        1,
</a><a href="#h48-1-11" id="h48-1-11" class="d">-                        Some(
</a><a href="#h48-1-12" id="h48-1-12" class="d">-                            (
</a><a href="#h48-1-13" id="h48-1-13" class="d">-                                Some(
</a><a href="#h48-1-14" id="h48-1-14" class="d">-                                    &quot;movies&quot;,
</a><a href="#h48-1-15" id="h48-1-15" class="d">-                                ),
</a><a href="#h48-1-16" id="h48-1-16" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h48-1-17" id="h48-1-17" class="i">+                Field(
</a><a href="#h48-1-18" id="h48-1-18" class="i">+                    1,
</a><a href="#h48-1-19" id="h48-1-19" class="i">+                    Some(
</a><a href="#h48-1-20" id="h48-1-20" class="i">+                        (
</a><a href="#h48-1-21" id="h48-1-21" class="i">+                            Some(
</a><a href="#h48-1-22" id="h48-1-22" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h48-1-24" id="h48-1-24" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h48-1-27" id="h48-1-27" class="d">-                    None,
</a>                 ),
<a href="#h48-1-29" id="h48-1-29" class="d">-                (
</a><a href="#h48-1-30" id="h48-1-30" class="d">-                    Field(
</a><a href="#h48-1-31" id="h48-1-31" class="d">-                        0,
</a><a href="#h48-1-32" id="h48-1-32" class="d">-                        None,
</a><a href="#h48-1-33" id="h48-1-33" class="d">-                    ),
</a><a href="#h48-1-34" id="h48-1-34" class="i">+                Field(
</a><a href="#h48-1-35" id="h48-1-35" class="i">+                    0,
</a>                     None,
                 ),
             ],
<a href="#h48-2" id="h48-2" class="h">@@ -308,30 +304,28 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h48-2-3" id="h48-2-3" class="i">+                    labels: [
</a><a href="#h48-2-4" id="h48-2-4" class="i">+                        None,
</a><a href="#h48-2-5" id="h48-2-5" class="i">+                        None,
</a><a href="#h48-2-6" id="h48-2-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h48-2-8" id="h48-2-8" class="d">-                        (
</a><a href="#h48-2-9" id="h48-2-9" class="d">-                            Field(
</a><a href="#h48-2-10" id="h48-2-10" class="d">-                                5,
</a><a href="#h48-2-11" id="h48-2-11" class="d">-                                Some(
</a><a href="#h48-2-12" id="h48-2-12" class="d">-                                    (
</a><a href="#h48-2-13" id="h48-2-13" class="d">-                                        None,
</a><a href="#h48-2-14" id="h48-2-14" class="d">-                                        &quot;rating&quot;,
</a><a href="#h48-2-15" id="h48-2-15" class="d">-                                    ),
</a><a href="#h48-2-16" id="h48-2-16" class="i">+                        Field(
</a><a href="#h48-2-17" id="h48-2-17" class="i">+                            5,
</a><a href="#h48-2-18" id="h48-2-18" class="i">+                            Some(
</a><a href="#h48-2-19" id="h48-2-19" class="i">+                                (
</a><a href="#h48-2-20" id="h48-2-20" class="i">+                                    None,
</a><a href="#h48-2-21" id="h48-2-21" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h48-2-24" id="h48-2-24" class="d">-                            None,
</a>                         ),
<a href="#h48-2-26" id="h48-2-26" class="d">-                        (
</a><a href="#h48-2-27" id="h48-2-27" class="d">-                            Field(
</a><a href="#h48-2-28" id="h48-2-28" class="d">-                                2,
</a><a href="#h48-2-29" id="h48-2-29" class="d">-                                Some(
</a><a href="#h48-2-30" id="h48-2-30" class="d">-                                    (
</a><a href="#h48-2-31" id="h48-2-31" class="d">-                                        None,
</a><a href="#h48-2-32" id="h48-2-32" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h48-2-33" id="h48-2-33" class="d">-                                    ),
</a><a href="#h48-2-34" id="h48-2-34" class="i">+                        Field(
</a><a href="#h48-2-35" id="h48-2-35" class="i">+                            2,
</a><a href="#h48-2-36" id="h48-2-36" class="i">+                            Some(
</a><a href="#h48-2-37" id="h48-2-37" class="i">+                                (
</a><a href="#h48-2-38" id="h48-2-38" class="i">+                                    None,
</a><a href="#h48-2-39" id="h48-2-39" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h48-2-42" id="h48-2-42" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h48-3" id="h48-3" class="h">@@ -339,26 +333,24 @@ Optimized plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h48-3-3" id="h48-3-3" class="i">+            labels: [
</a><a href="#h48-3-4" id="h48-3-4" class="i">+                None,
</a><a href="#h48-3-5" id="h48-3-5" class="i">+                None,
</a><a href="#h48-3-6" id="h48-3-6" class="i">+            ],
</a>             expressions: [
<a href="#h48-3-8" id="h48-3-8" class="d">-                (
</a><a href="#h48-3-9" id="h48-3-9" class="d">-                    Field(
</a><a href="#h48-3-10" id="h48-3-10" class="d">-                        1,
</a><a href="#h48-3-11" id="h48-3-11" class="d">-                        Some(
</a><a href="#h48-3-12" id="h48-3-12" class="d">-                            (
</a><a href="#h48-3-13" id="h48-3-13" class="d">-                                Some(
</a><a href="#h48-3-14" id="h48-3-14" class="d">-                                    &quot;movies&quot;,
</a><a href="#h48-3-15" id="h48-3-15" class="d">-                                ),
</a><a href="#h48-3-16" id="h48-3-16" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h48-3-17" id="h48-3-17" class="i">+                Field(
</a><a href="#h48-3-18" id="h48-3-18" class="i">+                    1,
</a><a href="#h48-3-19" id="h48-3-19" class="i">+                    Some(
</a><a href="#h48-3-20" id="h48-3-20" class="i">+                        (
</a><a href="#h48-3-21" id="h48-3-21" class="i">+                            Some(
</a><a href="#h48-3-22" id="h48-3-22" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h48-3-24" id="h48-3-24" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h48-3-27" id="h48-3-27" class="d">-                    None,
</a>                 ),
<a href="#h48-3-29" id="h48-3-29" class="d">-                (
</a><a href="#h48-3-30" id="h48-3-30" class="d">-                    Field(
</a><a href="#h48-3-31" id="h48-3-31" class="d">-                        0,
</a><a href="#h48-3-32" id="h48-3-32" class="d">-                        None,
</a><a href="#h48-3-33" id="h48-3-33" class="d">-                    ),
</a><a href="#h48-3-34" id="h48-3-34" class="i">+                Field(
</a><a href="#h48-3-35" id="h48-3-35" class="i">+                    0,
</a>                     None,
                 ),
             ],
<b>diff --git a/<a id="h49" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -164,30 +164,28 @@ Plan: Select(
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h49-0-3" id="h49-0-3" class="i">+                        labels: [
</a><a href="#h49-0-4" id="h49-0-4" class="i">+                            None,
</a><a href="#h49-0-5" id="h49-0-5" class="i">+                            None,
</a><a href="#h49-0-6" id="h49-0-6" class="i">+                        ],
</a>                         expressions: [
<a href="#h49-0-8" id="h49-0-8" class="d">-                            (
</a><a href="#h49-0-9" id="h49-0-9" class="d">-                                Field(
</a><a href="#h49-0-10" id="h49-0-10" class="d">-                                    5,
</a><a href="#h49-0-11" id="h49-0-11" class="d">-                                    Some(
</a><a href="#h49-0-12" id="h49-0-12" class="d">-                                        (
</a><a href="#h49-0-13" id="h49-0-13" class="d">-                                            None,
</a><a href="#h49-0-14" id="h49-0-14" class="d">-                                            &quot;rating&quot;,
</a><a href="#h49-0-15" id="h49-0-15" class="d">-                                        ),
</a><a href="#h49-0-16" id="h49-0-16" class="i">+                            Field(
</a><a href="#h49-0-17" id="h49-0-17" class="i">+                                5,
</a><a href="#h49-0-18" id="h49-0-18" class="i">+                                Some(
</a><a href="#h49-0-19" id="h49-0-19" class="i">+                                    (
</a><a href="#h49-0-20" id="h49-0-20" class="i">+                                        None,
</a><a href="#h49-0-21" id="h49-0-21" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
<a href="#h49-0-24" id="h49-0-24" class="d">-                                None,
</a>                             ),
<a href="#h49-0-26" id="h49-0-26" class="d">-                            (
</a><a href="#h49-0-27" id="h49-0-27" class="d">-                                Field(
</a><a href="#h49-0-28" id="h49-0-28" class="d">-                                    2,
</a><a href="#h49-0-29" id="h49-0-29" class="d">-                                    Some(
</a><a href="#h49-0-30" id="h49-0-30" class="d">-                                        (
</a><a href="#h49-0-31" id="h49-0-31" class="d">-                                            None,
</a><a href="#h49-0-32" id="h49-0-32" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h49-0-33" id="h49-0-33" class="d">-                                        ),
</a><a href="#h49-0-34" id="h49-0-34" class="i">+                            Field(
</a><a href="#h49-0-35" id="h49-0-35" class="i">+                                2,
</a><a href="#h49-0-36" id="h49-0-36" class="i">+                                Some(
</a><a href="#h49-0-37" id="h49-0-37" class="i">+                                    (
</a><a href="#h49-0-38" id="h49-0-38" class="i">+                                        None,
</a><a href="#h49-0-39" id="h49-0-39" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
<a href="#h49-0-42" id="h49-0-42" class="d">-                                None,
</a>                             ),
                         ],
                     },
<a href="#h49-1" id="h49-1" class="h">@@ -195,29 +193,30 @@ Plan: Select(
</a>                         Max,
                     ],
                 },
<a href="#h49-1-3" id="h49-1-3" class="i">+                labels: [
</a><a href="#h49-1-4" id="h49-1-4" class="i">+                    None,
</a><a href="#h49-1-5" id="h49-1-5" class="i">+                    Some(
</a><a href="#h49-1-6" id="h49-1-6" class="i">+                        (
</a><a href="#h49-1-7" id="h49-1-7" class="i">+                            None,
</a><a href="#h49-1-8" id="h49-1-8" class="i">+                            &quot;rating&quot;,
</a><a href="#h49-1-9" id="h49-1-9" class="i">+                        ),
</a><a href="#h49-1-10" id="h49-1-10" class="i">+                    ),
</a><a href="#h49-1-11" id="h49-1-11" class="i">+                ],
</a>                 expressions: [
<a href="#h49-1-13" id="h49-1-13" class="d">-                    (
</a><a href="#h49-1-14" id="h49-1-14" class="d">-                        Field(
</a><a href="#h49-1-15" id="h49-1-15" class="d">-                            1,
</a><a href="#h49-1-16" id="h49-1-16" class="d">-                            Some(
</a><a href="#h49-1-17" id="h49-1-17" class="d">-                                (
</a><a href="#h49-1-18" id="h49-1-18" class="d">-                                    Some(
</a><a href="#h49-1-19" id="h49-1-19" class="d">-                                        &quot;movies&quot;,
</a><a href="#h49-1-20" id="h49-1-20" class="d">-                                    ),
</a><a href="#h49-1-21" id="h49-1-21" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h49-1-22" id="h49-1-22" class="i">+                    Field(
</a><a href="#h49-1-23" id="h49-1-23" class="i">+                        1,
</a><a href="#h49-1-24" id="h49-1-24" class="i">+                        Some(
</a><a href="#h49-1-25" id="h49-1-25" class="i">+                            (
</a><a href="#h49-1-26" id="h49-1-26" class="i">+                                Some(
</a><a href="#h49-1-27" id="h49-1-27" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h49-1-29" id="h49-1-29" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h49-1-32" id="h49-1-32" class="d">-                        None,
</a>                     ),
<a href="#h49-1-34" id="h49-1-34" class="d">-                    (
</a><a href="#h49-1-35" id="h49-1-35" class="d">-                        Field(
</a><a href="#h49-1-36" id="h49-1-36" class="d">-                            0,
</a><a href="#h49-1-37" id="h49-1-37" class="d">-                            None,
</a><a href="#h49-1-38" id="h49-1-38" class="d">-                        ),
</a><a href="#h49-1-39" id="h49-1-39" class="d">-                        Some(
</a><a href="#h49-1-40" id="h49-1-40" class="d">-                            &quot;rating&quot;,
</a><a href="#h49-1-41" id="h49-1-41" class="d">-                        ),
</a><a href="#h49-1-42" id="h49-1-42" class="i">+                    Field(
</a><a href="#h49-1-43" id="h49-1-43" class="i">+                        0,
</a><a href="#h49-1-44" id="h49-1-44" class="i">+                        None,
</a>                     ),
                 ],
             },
<a href="#h49-2" id="h49-2" class="h">@@ -344,30 +343,28 @@ Optimized plan: Select(
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h49-2-3" id="h49-2-3" class="i">+                        labels: [
</a><a href="#h49-2-4" id="h49-2-4" class="i">+                            None,
</a><a href="#h49-2-5" id="h49-2-5" class="i">+                            None,
</a><a href="#h49-2-6" id="h49-2-6" class="i">+                        ],
</a>                         expressions: [
<a href="#h49-2-8" id="h49-2-8" class="d">-                            (
</a><a href="#h49-2-9" id="h49-2-9" class="d">-                                Field(
</a><a href="#h49-2-10" id="h49-2-10" class="d">-                                    5,
</a><a href="#h49-2-11" id="h49-2-11" class="d">-                                    Some(
</a><a href="#h49-2-12" id="h49-2-12" class="d">-                                        (
</a><a href="#h49-2-13" id="h49-2-13" class="d">-                                            None,
</a><a href="#h49-2-14" id="h49-2-14" class="d">-                                            &quot;rating&quot;,
</a><a href="#h49-2-15" id="h49-2-15" class="d">-                                        ),
</a><a href="#h49-2-16" id="h49-2-16" class="i">+                            Field(
</a><a href="#h49-2-17" id="h49-2-17" class="i">+                                5,
</a><a href="#h49-2-18" id="h49-2-18" class="i">+                                Some(
</a><a href="#h49-2-19" id="h49-2-19" class="i">+                                    (
</a><a href="#h49-2-20" id="h49-2-20" class="i">+                                        None,
</a><a href="#h49-2-21" id="h49-2-21" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
<a href="#h49-2-24" id="h49-2-24" class="d">-                                None,
</a>                             ),
<a href="#h49-2-26" id="h49-2-26" class="d">-                            (
</a><a href="#h49-2-27" id="h49-2-27" class="d">-                                Field(
</a><a href="#h49-2-28" id="h49-2-28" class="d">-                                    2,
</a><a href="#h49-2-29" id="h49-2-29" class="d">-                                    Some(
</a><a href="#h49-2-30" id="h49-2-30" class="d">-                                        (
</a><a href="#h49-2-31" id="h49-2-31" class="d">-                                            None,
</a><a href="#h49-2-32" id="h49-2-32" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h49-2-33" id="h49-2-33" class="d">-                                        ),
</a><a href="#h49-2-34" id="h49-2-34" class="i">+                            Field(
</a><a href="#h49-2-35" id="h49-2-35" class="i">+                                2,
</a><a href="#h49-2-36" id="h49-2-36" class="i">+                                Some(
</a><a href="#h49-2-37" id="h49-2-37" class="i">+                                    (
</a><a href="#h49-2-38" id="h49-2-38" class="i">+                                        None,
</a><a href="#h49-2-39" id="h49-2-39" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
<a href="#h49-2-42" id="h49-2-42" class="d">-                                None,
</a>                             ),
                         ],
                     },
<a href="#h49-3" id="h49-3" class="h">@@ -375,29 +372,30 @@ Optimized plan: Select(
</a>                         Max,
                     ],
                 },
<a href="#h49-3-3" id="h49-3-3" class="i">+                labels: [
</a><a href="#h49-3-4" id="h49-3-4" class="i">+                    None,
</a><a href="#h49-3-5" id="h49-3-5" class="i">+                    Some(
</a><a href="#h49-3-6" id="h49-3-6" class="i">+                        (
</a><a href="#h49-3-7" id="h49-3-7" class="i">+                            None,
</a><a href="#h49-3-8" id="h49-3-8" class="i">+                            &quot;rating&quot;,
</a><a href="#h49-3-9" id="h49-3-9" class="i">+                        ),
</a><a href="#h49-3-10" id="h49-3-10" class="i">+                    ),
</a><a href="#h49-3-11" id="h49-3-11" class="i">+                ],
</a>                 expressions: [
<a href="#h49-3-13" id="h49-3-13" class="d">-                    (
</a><a href="#h49-3-14" id="h49-3-14" class="d">-                        Field(
</a><a href="#h49-3-15" id="h49-3-15" class="d">-                            1,
</a><a href="#h49-3-16" id="h49-3-16" class="d">-                            Some(
</a><a href="#h49-3-17" id="h49-3-17" class="d">-                                (
</a><a href="#h49-3-18" id="h49-3-18" class="d">-                                    Some(
</a><a href="#h49-3-19" id="h49-3-19" class="d">-                                        &quot;movies&quot;,
</a><a href="#h49-3-20" id="h49-3-20" class="d">-                                    ),
</a><a href="#h49-3-21" id="h49-3-21" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h49-3-22" id="h49-3-22" class="i">+                    Field(
</a><a href="#h49-3-23" id="h49-3-23" class="i">+                        1,
</a><a href="#h49-3-24" id="h49-3-24" class="i">+                        Some(
</a><a href="#h49-3-25" id="h49-3-25" class="i">+                            (
</a><a href="#h49-3-26" id="h49-3-26" class="i">+                                Some(
</a><a href="#h49-3-27" id="h49-3-27" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h49-3-29" id="h49-3-29" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h49-3-32" id="h49-3-32" class="d">-                        None,
</a>                     ),
<a href="#h49-3-34" id="h49-3-34" class="d">-                    (
</a><a href="#h49-3-35" id="h49-3-35" class="d">-                        Field(
</a><a href="#h49-3-36" id="h49-3-36" class="d">-                            0,
</a><a href="#h49-3-37" id="h49-3-37" class="d">-                            None,
</a><a href="#h49-3-38" id="h49-3-38" class="d">-                        ),
</a><a href="#h49-3-39" id="h49-3-39" class="d">-                        Some(
</a><a href="#h49-3-40" id="h49-3-40" class="d">-                            &quot;rating&quot;,
</a><a href="#h49-3-41" id="h49-3-41" class="d">-                        ),
</a><a href="#h49-3-42" id="h49-3-42" class="i">+                    Field(
</a><a href="#h49-3-43" id="h49-3-43" class="i">+                        0,
</a><a href="#h49-3-44" id="h49-3-44" class="i">+                        None,
</a>                     ),
                 ],
             },
<b>diff --git a/<a id="h50" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -170,42 +170,38 @@ Plan: Select(
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h50-0-3" id="h50-0-3" class="i">+                            labels: [
</a><a href="#h50-0-4" id="h50-0-4" class="i">+                                None,
</a><a href="#h50-0-5" id="h50-0-5" class="i">+                                None,
</a><a href="#h50-0-6" id="h50-0-6" class="i">+                                None,
</a><a href="#h50-0-7" id="h50-0-7" class="i">+                            ],
</a>                             expressions: [
<a href="#h50-0-9" id="h50-0-9" class="d">-                                (
</a><a href="#h50-0-10" id="h50-0-10" class="d">-                                    Field(
</a><a href="#h50-0-11" id="h50-0-11" class="d">-                                        5,
</a><a href="#h50-0-12" id="h50-0-12" class="d">-                                        Some(
</a><a href="#h50-0-13" id="h50-0-13" class="d">-                                            (
</a><a href="#h50-0-14" id="h50-0-14" class="d">-                                                None,
</a><a href="#h50-0-15" id="h50-0-15" class="d">-                                                &quot;rating&quot;,
</a><a href="#h50-0-16" id="h50-0-16" class="d">-                                            ),
</a><a href="#h50-0-17" id="h50-0-17" class="i">+                                Field(
</a><a href="#h50-0-18" id="h50-0-18" class="i">+                                    5,
</a><a href="#h50-0-19" id="h50-0-19" class="i">+                                    Some(
</a><a href="#h50-0-20" id="h50-0-20" class="i">+                                        (
</a><a href="#h50-0-21" id="h50-0-21" class="i">+                                            None,
</a><a href="#h50-0-22" id="h50-0-22" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h50-0-25" id="h50-0-25" class="d">-                                    None,
</a>                                 ),
<a href="#h50-0-27" id="h50-0-27" class="d">-                                (
</a><a href="#h50-0-28" id="h50-0-28" class="d">-                                    Field(
</a><a href="#h50-0-29" id="h50-0-29" class="d">-                                        5,
</a><a href="#h50-0-30" id="h50-0-30" class="d">-                                        Some(
</a><a href="#h50-0-31" id="h50-0-31" class="d">-                                            (
</a><a href="#h50-0-32" id="h50-0-32" class="d">-                                                None,
</a><a href="#h50-0-33" id="h50-0-33" class="d">-                                                &quot;rating&quot;,
</a><a href="#h50-0-34" id="h50-0-34" class="d">-                                            ),
</a><a href="#h50-0-35" id="h50-0-35" class="i">+                                Field(
</a><a href="#h50-0-36" id="h50-0-36" class="i">+                                    5,
</a><a href="#h50-0-37" id="h50-0-37" class="i">+                                    Some(
</a><a href="#h50-0-38" id="h50-0-38" class="i">+                                        (
</a><a href="#h50-0-39" id="h50-0-39" class="i">+                                            None,
</a><a href="#h50-0-40" id="h50-0-40" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h50-0-43" id="h50-0-43" class="d">-                                    None,
</a>                                 ),
<a href="#h50-0-45" id="h50-0-45" class="d">-                                (
</a><a href="#h50-0-46" id="h50-0-46" class="d">-                                    Field(
</a><a href="#h50-0-47" id="h50-0-47" class="d">-                                        2,
</a><a href="#h50-0-48" id="h50-0-48" class="d">-                                        Some(
</a><a href="#h50-0-49" id="h50-0-49" class="d">-                                            (
</a><a href="#h50-0-50" id="h50-0-50" class="d">-                                                None,
</a><a href="#h50-0-51" id="h50-0-51" class="d">-                                                &quot;studio_id&quot;,
</a><a href="#h50-0-52" id="h50-0-52" class="d">-                                            ),
</a><a href="#h50-0-53" id="h50-0-53" class="i">+                                Field(
</a><a href="#h50-0-54" id="h50-0-54" class="i">+                                    2,
</a><a href="#h50-0-55" id="h50-0-55" class="i">+                                    Some(
</a><a href="#h50-0-56" id="h50-0-56" class="i">+                                        (
</a><a href="#h50-0-57" id="h50-0-57" class="i">+                                            None,
</a><a href="#h50-0-58" id="h50-0-58" class="i">+                                            &quot;studio_id&quot;,
</a>                                         ),
                                     ),
<a href="#h50-0-61" id="h50-0-61" class="d">-                                    None,
</a>                                 ),
                             ],
                         },
<a href="#h50-1" id="h50-1" class="h">@@ -214,33 +210,29 @@ Plan: Select(
</a>                             Min,
                         ],
                     },
<a href="#h50-1-3" id="h50-1-3" class="i">+                    labels: [
</a><a href="#h50-1-4" id="h50-1-4" class="i">+                        None,
</a><a href="#h50-1-5" id="h50-1-5" class="i">+                        None,
</a><a href="#h50-1-6" id="h50-1-6" class="i">+                        None,
</a><a href="#h50-1-7" id="h50-1-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h50-1-9" id="h50-1-9" class="d">-                        (
</a><a href="#h50-1-10" id="h50-1-10" class="d">-                            Field(
</a><a href="#h50-1-11" id="h50-1-11" class="d">-                                2,
</a><a href="#h50-1-12" id="h50-1-12" class="d">-                                Some(
</a><a href="#h50-1-13" id="h50-1-13" class="d">-                                    (
</a><a href="#h50-1-14" id="h50-1-14" class="d">-                                        Some(
</a><a href="#h50-1-15" id="h50-1-15" class="d">-                                            &quot;movies&quot;,
</a><a href="#h50-1-16" id="h50-1-16" class="d">-                                        ),
</a><a href="#h50-1-17" id="h50-1-17" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h50-1-18" id="h50-1-18" class="i">+                        Field(
</a><a href="#h50-1-19" id="h50-1-19" class="i">+                            2,
</a><a href="#h50-1-20" id="h50-1-20" class="i">+                            Some(
</a><a href="#h50-1-21" id="h50-1-21" class="i">+                                (
</a><a href="#h50-1-22" id="h50-1-22" class="i">+                                    Some(
</a><a href="#h50-1-23" id="h50-1-23" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h50-1-25" id="h50-1-25" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h50-1-28" id="h50-1-28" class="d">-                            None,
</a>                         ),
<a href="#h50-1-30" id="h50-1-30" class="d">-                        (
</a><a href="#h50-1-31" id="h50-1-31" class="d">-                            Field(
</a><a href="#h50-1-32" id="h50-1-32" class="d">-                                0,
</a><a href="#h50-1-33" id="h50-1-33" class="d">-                                None,
</a><a href="#h50-1-34" id="h50-1-34" class="d">-                            ),
</a><a href="#h50-1-35" id="h50-1-35" class="i">+                        Field(
</a><a href="#h50-1-36" id="h50-1-36" class="i">+                            0,
</a>                             None,
                         ),
<a href="#h50-1-39" id="h50-1-39" class="d">-                        (
</a><a href="#h50-1-40" id="h50-1-40" class="d">-                            Field(
</a><a href="#h50-1-41" id="h50-1-41" class="d">-                                1,
</a><a href="#h50-1-42" id="h50-1-42" class="d">-                                None,
</a><a href="#h50-1-43" id="h50-1-43" class="d">-                            ),
</a><a href="#h50-1-44" id="h50-1-44" class="i">+                        Field(
</a><a href="#h50-1-45" id="h50-1-45" class="i">+                            1,
</a>                             None,
                         ),
                     ],
<a href="#h50-2" id="h50-2" class="h">@@ -274,19 +266,17 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h50-2-3" id="h50-2-3" class="i">+        labels: [
</a><a href="#h50-2-4" id="h50-2-4" class="i">+            None,
</a><a href="#h50-2-5" id="h50-2-5" class="i">+            None,
</a><a href="#h50-2-6" id="h50-2-6" class="i">+        ],
</a>         expressions: [
<a href="#h50-2-8" id="h50-2-8" class="d">-            (
</a><a href="#h50-2-9" id="h50-2-9" class="d">-                Field(
</a><a href="#h50-2-10" id="h50-2-10" class="d">-                    0,
</a><a href="#h50-2-11" id="h50-2-11" class="d">-                    None,
</a><a href="#h50-2-12" id="h50-2-12" class="d">-                ),
</a><a href="#h50-2-13" id="h50-2-13" class="i">+            Field(
</a><a href="#h50-2-14" id="h50-2-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h50-2-17" id="h50-2-17" class="d">-            (
</a><a href="#h50-2-18" id="h50-2-18" class="d">-                Field(
</a><a href="#h50-2-19" id="h50-2-19" class="d">-                    1,
</a><a href="#h50-2-20" id="h50-2-20" class="d">-                    None,
</a><a href="#h50-2-21" id="h50-2-21" class="d">-                ),
</a><a href="#h50-2-22" id="h50-2-22" class="i">+            Field(
</a><a href="#h50-2-23" id="h50-2-23" class="i">+                1,
</a>                 None,
             ),
         ],
<a href="#h50-3" id="h50-3" class="h">@@ -381,42 +371,38 @@ Optimized plan: Select(
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h50-3-3" id="h50-3-3" class="i">+                            labels: [
</a><a href="#h50-3-4" id="h50-3-4" class="i">+                                None,
</a><a href="#h50-3-5" id="h50-3-5" class="i">+                                None,
</a><a href="#h50-3-6" id="h50-3-6" class="i">+                                None,
</a><a href="#h50-3-7" id="h50-3-7" class="i">+                            ],
</a>                             expressions: [
<a href="#h50-3-9" id="h50-3-9" class="d">-                                (
</a><a href="#h50-3-10" id="h50-3-10" class="d">-                                    Field(
</a><a href="#h50-3-11" id="h50-3-11" class="d">-                                        5,
</a><a href="#h50-3-12" id="h50-3-12" class="d">-                                        Some(
</a><a href="#h50-3-13" id="h50-3-13" class="d">-                                            (
</a><a href="#h50-3-14" id="h50-3-14" class="d">-                                                None,
</a><a href="#h50-3-15" id="h50-3-15" class="d">-                                                &quot;rating&quot;,
</a><a href="#h50-3-16" id="h50-3-16" class="d">-                                            ),
</a><a href="#h50-3-17" id="h50-3-17" class="i">+                                Field(
</a><a href="#h50-3-18" id="h50-3-18" class="i">+                                    5,
</a><a href="#h50-3-19" id="h50-3-19" class="i">+                                    Some(
</a><a href="#h50-3-20" id="h50-3-20" class="i">+                                        (
</a><a href="#h50-3-21" id="h50-3-21" class="i">+                                            None,
</a><a href="#h50-3-22" id="h50-3-22" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h50-3-25" id="h50-3-25" class="d">-                                    None,
</a>                                 ),
<a href="#h50-3-27" id="h50-3-27" class="d">-                                (
</a><a href="#h50-3-28" id="h50-3-28" class="d">-                                    Field(
</a><a href="#h50-3-29" id="h50-3-29" class="d">-                                        5,
</a><a href="#h50-3-30" id="h50-3-30" class="d">-                                        Some(
</a><a href="#h50-3-31" id="h50-3-31" class="d">-                                            (
</a><a href="#h50-3-32" id="h50-3-32" class="d">-                                                None,
</a><a href="#h50-3-33" id="h50-3-33" class="d">-                                                &quot;rating&quot;,
</a><a href="#h50-3-34" id="h50-3-34" class="d">-                                            ),
</a><a href="#h50-3-35" id="h50-3-35" class="i">+                                Field(
</a><a href="#h50-3-36" id="h50-3-36" class="i">+                                    5,
</a><a href="#h50-3-37" id="h50-3-37" class="i">+                                    Some(
</a><a href="#h50-3-38" id="h50-3-38" class="i">+                                        (
</a><a href="#h50-3-39" id="h50-3-39" class="i">+                                            None,
</a><a href="#h50-3-40" id="h50-3-40" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h50-3-43" id="h50-3-43" class="d">-                                    None,
</a>                                 ),
<a href="#h50-3-45" id="h50-3-45" class="d">-                                (
</a><a href="#h50-3-46" id="h50-3-46" class="d">-                                    Field(
</a><a href="#h50-3-47" id="h50-3-47" class="d">-                                        2,
</a><a href="#h50-3-48" id="h50-3-48" class="d">-                                        Some(
</a><a href="#h50-3-49" id="h50-3-49" class="d">-                                            (
</a><a href="#h50-3-50" id="h50-3-50" class="d">-                                                None,
</a><a href="#h50-3-51" id="h50-3-51" class="d">-                                                &quot;studio_id&quot;,
</a><a href="#h50-3-52" id="h50-3-52" class="d">-                                            ),
</a><a href="#h50-3-53" id="h50-3-53" class="i">+                                Field(
</a><a href="#h50-3-54" id="h50-3-54" class="i">+                                    2,
</a><a href="#h50-3-55" id="h50-3-55" class="i">+                                    Some(
</a><a href="#h50-3-56" id="h50-3-56" class="i">+                                        (
</a><a href="#h50-3-57" id="h50-3-57" class="i">+                                            None,
</a><a href="#h50-3-58" id="h50-3-58" class="i">+                                            &quot;studio_id&quot;,
</a>                                         ),
                                     ),
<a href="#h50-3-61" id="h50-3-61" class="d">-                                    None,
</a>                                 ),
                             ],
                         },
<a href="#h50-4" id="h50-4" class="h">@@ -425,33 +411,29 @@ Optimized plan: Select(
</a>                             Min,
                         ],
                     },
<a href="#h50-4-3" id="h50-4-3" class="i">+                    labels: [
</a><a href="#h50-4-4" id="h50-4-4" class="i">+                        None,
</a><a href="#h50-4-5" id="h50-4-5" class="i">+                        None,
</a><a href="#h50-4-6" id="h50-4-6" class="i">+                        None,
</a><a href="#h50-4-7" id="h50-4-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h50-4-9" id="h50-4-9" class="d">-                        (
</a><a href="#h50-4-10" id="h50-4-10" class="d">-                            Field(
</a><a href="#h50-4-11" id="h50-4-11" class="d">-                                2,
</a><a href="#h50-4-12" id="h50-4-12" class="d">-                                Some(
</a><a href="#h50-4-13" id="h50-4-13" class="d">-                                    (
</a><a href="#h50-4-14" id="h50-4-14" class="d">-                                        Some(
</a><a href="#h50-4-15" id="h50-4-15" class="d">-                                            &quot;movies&quot;,
</a><a href="#h50-4-16" id="h50-4-16" class="d">-                                        ),
</a><a href="#h50-4-17" id="h50-4-17" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h50-4-18" id="h50-4-18" class="i">+                        Field(
</a><a href="#h50-4-19" id="h50-4-19" class="i">+                            2,
</a><a href="#h50-4-20" id="h50-4-20" class="i">+                            Some(
</a><a href="#h50-4-21" id="h50-4-21" class="i">+                                (
</a><a href="#h50-4-22" id="h50-4-22" class="i">+                                    Some(
</a><a href="#h50-4-23" id="h50-4-23" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h50-4-25" id="h50-4-25" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h50-4-28" id="h50-4-28" class="d">-                            None,
</a>                         ),
<a href="#h50-4-30" id="h50-4-30" class="d">-                        (
</a><a href="#h50-4-31" id="h50-4-31" class="d">-                            Field(
</a><a href="#h50-4-32" id="h50-4-32" class="d">-                                0,
</a><a href="#h50-4-33" id="h50-4-33" class="d">-                                None,
</a><a href="#h50-4-34" id="h50-4-34" class="d">-                            ),
</a><a href="#h50-4-35" id="h50-4-35" class="i">+                        Field(
</a><a href="#h50-4-36" id="h50-4-36" class="i">+                            0,
</a>                             None,
                         ),
<a href="#h50-4-39" id="h50-4-39" class="d">-                        (
</a><a href="#h50-4-40" id="h50-4-40" class="d">-                            Field(
</a><a href="#h50-4-41" id="h50-4-41" class="d">-                                1,
</a><a href="#h50-4-42" id="h50-4-42" class="d">-                                None,
</a><a href="#h50-4-43" id="h50-4-43" class="d">-                            ),
</a><a href="#h50-4-44" id="h50-4-44" class="i">+                        Field(
</a><a href="#h50-4-45" id="h50-4-45" class="i">+                            1,
</a>                             None,
                         ),
                     ],
<a href="#h50-5" id="h50-5" class="h">@@ -485,19 +467,17 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h50-5-3" id="h50-5-3" class="i">+        labels: [
</a><a href="#h50-5-4" id="h50-5-4" class="i">+            None,
</a><a href="#h50-5-5" id="h50-5-5" class="i">+            None,
</a><a href="#h50-5-6" id="h50-5-6" class="i">+        ],
</a>         expressions: [
<a href="#h50-5-8" id="h50-5-8" class="d">-            (
</a><a href="#h50-5-9" id="h50-5-9" class="d">-                Field(
</a><a href="#h50-5-10" id="h50-5-10" class="d">-                    0,
</a><a href="#h50-5-11" id="h50-5-11" class="d">-                    None,
</a><a href="#h50-5-12" id="h50-5-12" class="d">-                ),
</a><a href="#h50-5-13" id="h50-5-13" class="i">+            Field(
</a><a href="#h50-5-14" id="h50-5-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h50-5-17" id="h50-5-17" class="d">-            (
</a><a href="#h50-5-18" id="h50-5-18" class="d">-                Field(
</a><a href="#h50-5-19" id="h50-5-19" class="d">-                    1,
</a><a href="#h50-5-20" id="h50-5-20" class="d">-                    None,
</a><a href="#h50-5-21" id="h50-5-21" class="d">-                ),
</a><a href="#h50-5-22" id="h50-5-22" class="i">+            Field(
</a><a href="#h50-5-23" id="h50-5-23" class="i">+                1,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h51" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -183,54 +183,48 @@ Plan: Select(
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h51-0-3" id="h51-0-3" class="i">+                            labels: [
</a><a href="#h51-0-4" id="h51-0-4" class="i">+                                None,
</a><a href="#h51-0-5" id="h51-0-5" class="i">+                                None,
</a><a href="#h51-0-6" id="h51-0-6" class="i">+                                None,
</a><a href="#h51-0-7" id="h51-0-7" class="i">+                                None,
</a><a href="#h51-0-8" id="h51-0-8" class="i">+                            ],
</a>                             expressions: [
<a href="#h51-0-10" id="h51-0-10" class="d">-                                (
</a><a href="#h51-0-11" id="h51-0-11" class="d">-                                    Field(
</a><a href="#h51-0-12" id="h51-0-12" class="d">-                                        5,
</a><a href="#h51-0-13" id="h51-0-13" class="d">-                                        Some(
</a><a href="#h51-0-14" id="h51-0-14" class="d">-                                            (
</a><a href="#h51-0-15" id="h51-0-15" class="d">-                                                None,
</a><a href="#h51-0-16" id="h51-0-16" class="d">-                                                &quot;rating&quot;,
</a><a href="#h51-0-17" id="h51-0-17" class="d">-                                            ),
</a><a href="#h51-0-18" id="h51-0-18" class="i">+                                Field(
</a><a href="#h51-0-19" id="h51-0-19" class="i">+                                    5,
</a><a href="#h51-0-20" id="h51-0-20" class="i">+                                    Some(
</a><a href="#h51-0-21" id="h51-0-21" class="i">+                                        (
</a><a href="#h51-0-22" id="h51-0-22" class="i">+                                            None,
</a><a href="#h51-0-23" id="h51-0-23" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h51-0-26" id="h51-0-26" class="d">-                                    None,
</a>                                 ),
<a href="#h51-0-28" id="h51-0-28" class="d">-                                (
</a><a href="#h51-0-29" id="h51-0-29" class="d">-                                    Field(
</a><a href="#h51-0-30" id="h51-0-30" class="d">-                                        5,
</a><a href="#h51-0-31" id="h51-0-31" class="d">-                                        Some(
</a><a href="#h51-0-32" id="h51-0-32" class="d">-                                            (
</a><a href="#h51-0-33" id="h51-0-33" class="d">-                                                None,
</a><a href="#h51-0-34" id="h51-0-34" class="d">-                                                &quot;rating&quot;,
</a><a href="#h51-0-35" id="h51-0-35" class="d">-                                            ),
</a><a href="#h51-0-36" id="h51-0-36" class="i">+                                Field(
</a><a href="#h51-0-37" id="h51-0-37" class="i">+                                    5,
</a><a href="#h51-0-38" id="h51-0-38" class="i">+                                    Some(
</a><a href="#h51-0-39" id="h51-0-39" class="i">+                                        (
</a><a href="#h51-0-40" id="h51-0-40" class="i">+                                            None,
</a><a href="#h51-0-41" id="h51-0-41" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h51-0-44" id="h51-0-44" class="d">-                                    None,
</a>                                 ),
<a href="#h51-0-46" id="h51-0-46" class="d">-                                (
</a><a href="#h51-0-47" id="h51-0-47" class="d">-                                    Field(
</a><a href="#h51-0-48" id="h51-0-48" class="d">-                                        5,
</a><a href="#h51-0-49" id="h51-0-49" class="d">-                                        Some(
</a><a href="#h51-0-50" id="h51-0-50" class="d">-                                            (
</a><a href="#h51-0-51" id="h51-0-51" class="d">-                                                None,
</a><a href="#h51-0-52" id="h51-0-52" class="d">-                                                &quot;rating&quot;,
</a><a href="#h51-0-53" id="h51-0-53" class="d">-                                            ),
</a><a href="#h51-0-54" id="h51-0-54" class="i">+                                Field(
</a><a href="#h51-0-55" id="h51-0-55" class="i">+                                    5,
</a><a href="#h51-0-56" id="h51-0-56" class="i">+                                    Some(
</a><a href="#h51-0-57" id="h51-0-57" class="i">+                                        (
</a><a href="#h51-0-58" id="h51-0-58" class="i">+                                            None,
</a><a href="#h51-0-59" id="h51-0-59" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h51-0-62" id="h51-0-62" class="d">-                                    None,
</a>                                 ),
<a href="#h51-0-64" id="h51-0-64" class="d">-                                (
</a><a href="#h51-0-65" id="h51-0-65" class="d">-                                    Field(
</a><a href="#h51-0-66" id="h51-0-66" class="d">-                                        2,
</a><a href="#h51-0-67" id="h51-0-67" class="d">-                                        Some(
</a><a href="#h51-0-68" id="h51-0-68" class="d">-                                            (
</a><a href="#h51-0-69" id="h51-0-69" class="d">-                                                None,
</a><a href="#h51-0-70" id="h51-0-70" class="d">-                                                &quot;studio_id&quot;,
</a><a href="#h51-0-71" id="h51-0-71" class="d">-                                            ),
</a><a href="#h51-0-72" id="h51-0-72" class="i">+                                Field(
</a><a href="#h51-0-73" id="h51-0-73" class="i">+                                    2,
</a><a href="#h51-0-74" id="h51-0-74" class="i">+                                    Some(
</a><a href="#h51-0-75" id="h51-0-75" class="i">+                                        (
</a><a href="#h51-0-76" id="h51-0-76" class="i">+                                            None,
</a><a href="#h51-0-77" id="h51-0-77" class="i">+                                            &quot;studio_id&quot;,
</a>                                         ),
                                     ),
<a href="#h51-0-80" id="h51-0-80" class="d">-                                    None,
</a>                                 ),
                             ],
                         },
<a href="#h51-1" id="h51-1" class="h">@@ -240,40 +234,34 @@ Plan: Select(
</a>                             Min,
                         ],
                     },
<a href="#h51-1-3" id="h51-1-3" class="i">+                    labels: [
</a><a href="#h51-1-4" id="h51-1-4" class="i">+                        None,
</a><a href="#h51-1-5" id="h51-1-5" class="i">+                        None,
</a><a href="#h51-1-6" id="h51-1-6" class="i">+                        None,
</a><a href="#h51-1-7" id="h51-1-7" class="i">+                        None,
</a><a href="#h51-1-8" id="h51-1-8" class="i">+                    ],
</a>                     expressions: [
<a href="#h51-1-10" id="h51-1-10" class="d">-                        (
</a><a href="#h51-1-11" id="h51-1-11" class="d">-                            Field(
</a><a href="#h51-1-12" id="h51-1-12" class="d">-                                3,
</a><a href="#h51-1-13" id="h51-1-13" class="d">-                                Some(
</a><a href="#h51-1-14" id="h51-1-14" class="d">-                                    (
</a><a href="#h51-1-15" id="h51-1-15" class="d">-                                        Some(
</a><a href="#h51-1-16" id="h51-1-16" class="d">-                                            &quot;movies&quot;,
</a><a href="#h51-1-17" id="h51-1-17" class="d">-                                        ),
</a><a href="#h51-1-18" id="h51-1-18" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h51-1-19" id="h51-1-19" class="i">+                        Field(
</a><a href="#h51-1-20" id="h51-1-20" class="i">+                            3,
</a><a href="#h51-1-21" id="h51-1-21" class="i">+                            Some(
</a><a href="#h51-1-22" id="h51-1-22" class="i">+                                (
</a><a href="#h51-1-23" id="h51-1-23" class="i">+                                    Some(
</a><a href="#h51-1-24" id="h51-1-24" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h51-1-26" id="h51-1-26" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h51-1-29" id="h51-1-29" class="d">-                            None,
</a>                         ),
<a href="#h51-1-31" id="h51-1-31" class="d">-                        (
</a><a href="#h51-1-32" id="h51-1-32" class="d">-                            Field(
</a><a href="#h51-1-33" id="h51-1-33" class="d">-                                0,
</a><a href="#h51-1-34" id="h51-1-34" class="d">-                                None,
</a><a href="#h51-1-35" id="h51-1-35" class="d">-                            ),
</a><a href="#h51-1-36" id="h51-1-36" class="i">+                        Field(
</a><a href="#h51-1-37" id="h51-1-37" class="i">+                            0,
</a>                             None,
                         ),
<a href="#h51-1-40" id="h51-1-40" class="d">-                        (
</a><a href="#h51-1-41" id="h51-1-41" class="d">-                            Field(
</a><a href="#h51-1-42" id="h51-1-42" class="d">-                                1,
</a><a href="#h51-1-43" id="h51-1-43" class="d">-                                None,
</a><a href="#h51-1-44" id="h51-1-44" class="d">-                            ),
</a><a href="#h51-1-45" id="h51-1-45" class="i">+                        Field(
</a><a href="#h51-1-46" id="h51-1-46" class="i">+                            1,
</a>                             None,
                         ),
<a href="#h51-1-49" id="h51-1-49" class="d">-                        (
</a><a href="#h51-1-50" id="h51-1-50" class="d">-                            Field(
</a><a href="#h51-1-51" id="h51-1-51" class="d">-                                2,
</a><a href="#h51-1-52" id="h51-1-52" class="d">-                                None,
</a><a href="#h51-1-53" id="h51-1-53" class="d">-                            ),
</a><a href="#h51-1-54" id="h51-1-54" class="i">+                        Field(
</a><a href="#h51-1-55" id="h51-1-55" class="i">+                            2,
</a>                             None,
                         ),
                     ],
<a href="#h51-2" id="h51-2" class="h">@@ -313,19 +301,17 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h51-2-3" id="h51-2-3" class="i">+        labels: [
</a><a href="#h51-2-4" id="h51-2-4" class="i">+            None,
</a><a href="#h51-2-5" id="h51-2-5" class="i">+            None,
</a><a href="#h51-2-6" id="h51-2-6" class="i">+        ],
</a>         expressions: [
<a href="#h51-2-8" id="h51-2-8" class="d">-            (
</a><a href="#h51-2-9" id="h51-2-9" class="d">-                Field(
</a><a href="#h51-2-10" id="h51-2-10" class="d">-                    0,
</a><a href="#h51-2-11" id="h51-2-11" class="d">-                    None,
</a><a href="#h51-2-12" id="h51-2-12" class="d">-                ),
</a><a href="#h51-2-13" id="h51-2-13" class="i">+            Field(
</a><a href="#h51-2-14" id="h51-2-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h51-2-17" id="h51-2-17" class="d">-            (
</a><a href="#h51-2-18" id="h51-2-18" class="d">-                Field(
</a><a href="#h51-2-19" id="h51-2-19" class="d">-                    1,
</a><a href="#h51-2-20" id="h51-2-20" class="d">-                    None,
</a><a href="#h51-2-21" id="h51-2-21" class="d">-                ),
</a><a href="#h51-2-22" id="h51-2-22" class="i">+            Field(
</a><a href="#h51-2-23" id="h51-2-23" class="i">+                1,
</a>                 None,
             ),
         ],
<a href="#h51-3" id="h51-3" class="h">@@ -420,54 +406,48 @@ Optimized plan: Select(
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h51-3-3" id="h51-3-3" class="i">+                            labels: [
</a><a href="#h51-3-4" id="h51-3-4" class="i">+                                None,
</a><a href="#h51-3-5" id="h51-3-5" class="i">+                                None,
</a><a href="#h51-3-6" id="h51-3-6" class="i">+                                None,
</a><a href="#h51-3-7" id="h51-3-7" class="i">+                                None,
</a><a href="#h51-3-8" id="h51-3-8" class="i">+                            ],
</a>                             expressions: [
<a href="#h51-3-10" id="h51-3-10" class="d">-                                (
</a><a href="#h51-3-11" id="h51-3-11" class="d">-                                    Field(
</a><a href="#h51-3-12" id="h51-3-12" class="d">-                                        5,
</a><a href="#h51-3-13" id="h51-3-13" class="d">-                                        Some(
</a><a href="#h51-3-14" id="h51-3-14" class="d">-                                            (
</a><a href="#h51-3-15" id="h51-3-15" class="d">-                                                None,
</a><a href="#h51-3-16" id="h51-3-16" class="d">-                                                &quot;rating&quot;,
</a><a href="#h51-3-17" id="h51-3-17" class="d">-                                            ),
</a><a href="#h51-3-18" id="h51-3-18" class="i">+                                Field(
</a><a href="#h51-3-19" id="h51-3-19" class="i">+                                    5,
</a><a href="#h51-3-20" id="h51-3-20" class="i">+                                    Some(
</a><a href="#h51-3-21" id="h51-3-21" class="i">+                                        (
</a><a href="#h51-3-22" id="h51-3-22" class="i">+                                            None,
</a><a href="#h51-3-23" id="h51-3-23" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h51-3-26" id="h51-3-26" class="d">-                                    None,
</a>                                 ),
<a href="#h51-3-28" id="h51-3-28" class="d">-                                (
</a><a href="#h51-3-29" id="h51-3-29" class="d">-                                    Field(
</a><a href="#h51-3-30" id="h51-3-30" class="d">-                                        5,
</a><a href="#h51-3-31" id="h51-3-31" class="d">-                                        Some(
</a><a href="#h51-3-32" id="h51-3-32" class="d">-                                            (
</a><a href="#h51-3-33" id="h51-3-33" class="d">-                                                None,
</a><a href="#h51-3-34" id="h51-3-34" class="d">-                                                &quot;rating&quot;,
</a><a href="#h51-3-35" id="h51-3-35" class="d">-                                            ),
</a><a href="#h51-3-36" id="h51-3-36" class="i">+                                Field(
</a><a href="#h51-3-37" id="h51-3-37" class="i">+                                    5,
</a><a href="#h51-3-38" id="h51-3-38" class="i">+                                    Some(
</a><a href="#h51-3-39" id="h51-3-39" class="i">+                                        (
</a><a href="#h51-3-40" id="h51-3-40" class="i">+                                            None,
</a><a href="#h51-3-41" id="h51-3-41" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h51-3-44" id="h51-3-44" class="d">-                                    None,
</a>                                 ),
<a href="#h51-3-46" id="h51-3-46" class="d">-                                (
</a><a href="#h51-3-47" id="h51-3-47" class="d">-                                    Field(
</a><a href="#h51-3-48" id="h51-3-48" class="d">-                                        5,
</a><a href="#h51-3-49" id="h51-3-49" class="d">-                                        Some(
</a><a href="#h51-3-50" id="h51-3-50" class="d">-                                            (
</a><a href="#h51-3-51" id="h51-3-51" class="d">-                                                None,
</a><a href="#h51-3-52" id="h51-3-52" class="d">-                                                &quot;rating&quot;,
</a><a href="#h51-3-53" id="h51-3-53" class="d">-                                            ),
</a><a href="#h51-3-54" id="h51-3-54" class="i">+                                Field(
</a><a href="#h51-3-55" id="h51-3-55" class="i">+                                    5,
</a><a href="#h51-3-56" id="h51-3-56" class="i">+                                    Some(
</a><a href="#h51-3-57" id="h51-3-57" class="i">+                                        (
</a><a href="#h51-3-58" id="h51-3-58" class="i">+                                            None,
</a><a href="#h51-3-59" id="h51-3-59" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h51-3-62" id="h51-3-62" class="d">-                                    None,
</a>                                 ),
<a href="#h51-3-64" id="h51-3-64" class="d">-                                (
</a><a href="#h51-3-65" id="h51-3-65" class="d">-                                    Field(
</a><a href="#h51-3-66" id="h51-3-66" class="d">-                                        2,
</a><a href="#h51-3-67" id="h51-3-67" class="d">-                                        Some(
</a><a href="#h51-3-68" id="h51-3-68" class="d">-                                            (
</a><a href="#h51-3-69" id="h51-3-69" class="d">-                                                None,
</a><a href="#h51-3-70" id="h51-3-70" class="d">-                                                &quot;studio_id&quot;,
</a><a href="#h51-3-71" id="h51-3-71" class="d">-                                            ),
</a><a href="#h51-3-72" id="h51-3-72" class="i">+                                Field(
</a><a href="#h51-3-73" id="h51-3-73" class="i">+                                    2,
</a><a href="#h51-3-74" id="h51-3-74" class="i">+                                    Some(
</a><a href="#h51-3-75" id="h51-3-75" class="i">+                                        (
</a><a href="#h51-3-76" id="h51-3-76" class="i">+                                            None,
</a><a href="#h51-3-77" id="h51-3-77" class="i">+                                            &quot;studio_id&quot;,
</a>                                         ),
                                     ),
<a href="#h51-3-80" id="h51-3-80" class="d">-                                    None,
</a>                                 ),
                             ],
                         },
<a href="#h51-4" id="h51-4" class="h">@@ -477,40 +457,34 @@ Optimized plan: Select(
</a>                             Min,
                         ],
                     },
<a href="#h51-4-3" id="h51-4-3" class="i">+                    labels: [
</a><a href="#h51-4-4" id="h51-4-4" class="i">+                        None,
</a><a href="#h51-4-5" id="h51-4-5" class="i">+                        None,
</a><a href="#h51-4-6" id="h51-4-6" class="i">+                        None,
</a><a href="#h51-4-7" id="h51-4-7" class="i">+                        None,
</a><a href="#h51-4-8" id="h51-4-8" class="i">+                    ],
</a>                     expressions: [
<a href="#h51-4-10" id="h51-4-10" class="d">-                        (
</a><a href="#h51-4-11" id="h51-4-11" class="d">-                            Field(
</a><a href="#h51-4-12" id="h51-4-12" class="d">-                                3,
</a><a href="#h51-4-13" id="h51-4-13" class="d">-                                Some(
</a><a href="#h51-4-14" id="h51-4-14" class="d">-                                    (
</a><a href="#h51-4-15" id="h51-4-15" class="d">-                                        Some(
</a><a href="#h51-4-16" id="h51-4-16" class="d">-                                            &quot;movies&quot;,
</a><a href="#h51-4-17" id="h51-4-17" class="d">-                                        ),
</a><a href="#h51-4-18" id="h51-4-18" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h51-4-19" id="h51-4-19" class="i">+                        Field(
</a><a href="#h51-4-20" id="h51-4-20" class="i">+                            3,
</a><a href="#h51-4-21" id="h51-4-21" class="i">+                            Some(
</a><a href="#h51-4-22" id="h51-4-22" class="i">+                                (
</a><a href="#h51-4-23" id="h51-4-23" class="i">+                                    Some(
</a><a href="#h51-4-24" id="h51-4-24" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h51-4-26" id="h51-4-26" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h51-4-29" id="h51-4-29" class="d">-                            None,
</a>                         ),
<a href="#h51-4-31" id="h51-4-31" class="d">-                        (
</a><a href="#h51-4-32" id="h51-4-32" class="d">-                            Field(
</a><a href="#h51-4-33" id="h51-4-33" class="d">-                                0,
</a><a href="#h51-4-34" id="h51-4-34" class="d">-                                None,
</a><a href="#h51-4-35" id="h51-4-35" class="d">-                            ),
</a><a href="#h51-4-36" id="h51-4-36" class="i">+                        Field(
</a><a href="#h51-4-37" id="h51-4-37" class="i">+                            0,
</a>                             None,
                         ),
<a href="#h51-4-40" id="h51-4-40" class="d">-                        (
</a><a href="#h51-4-41" id="h51-4-41" class="d">-                            Field(
</a><a href="#h51-4-42" id="h51-4-42" class="d">-                                1,
</a><a href="#h51-4-43" id="h51-4-43" class="d">-                                None,
</a><a href="#h51-4-44" id="h51-4-44" class="d">-                            ),
</a><a href="#h51-4-45" id="h51-4-45" class="i">+                        Field(
</a><a href="#h51-4-46" id="h51-4-46" class="i">+                            1,
</a>                             None,
                         ),
<a href="#h51-4-49" id="h51-4-49" class="d">-                        (
</a><a href="#h51-4-50" id="h51-4-50" class="d">-                            Field(
</a><a href="#h51-4-51" id="h51-4-51" class="d">-                                2,
</a><a href="#h51-4-52" id="h51-4-52" class="d">-                                None,
</a><a href="#h51-4-53" id="h51-4-53" class="d">-                            ),
</a><a href="#h51-4-54" id="h51-4-54" class="i">+                        Field(
</a><a href="#h51-4-55" id="h51-4-55" class="i">+                            2,
</a>                             None,
                         ),
                     ],
<a href="#h51-5" id="h51-5" class="h">@@ -550,19 +524,17 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h51-5-3" id="h51-5-3" class="i">+        labels: [
</a><a href="#h51-5-4" id="h51-5-4" class="i">+            None,
</a><a href="#h51-5-5" id="h51-5-5" class="i">+            None,
</a><a href="#h51-5-6" id="h51-5-6" class="i">+        ],
</a>         expressions: [
<a href="#h51-5-8" id="h51-5-8" class="d">-            (
</a><a href="#h51-5-9" id="h51-5-9" class="d">-                Field(
</a><a href="#h51-5-10" id="h51-5-10" class="d">-                    0,
</a><a href="#h51-5-11" id="h51-5-11" class="d">-                    None,
</a><a href="#h51-5-12" id="h51-5-12" class="d">-                ),
</a><a href="#h51-5-13" id="h51-5-13" class="i">+            Field(
</a><a href="#h51-5-14" id="h51-5-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h51-5-17" id="h51-5-17" class="d">-            (
</a><a href="#h51-5-18" id="h51-5-18" class="d">-                Field(
</a><a href="#h51-5-19" id="h51-5-19" class="d">-                    1,
</a><a href="#h51-5-20" id="h51-5-20" class="d">-                    None,
</a><a href="#h51-5-21" id="h51-5-21" class="d">-                ),
</a><a href="#h51-5-22" id="h51-5-22" class="i">+            Field(
</a><a href="#h51-5-23" id="h51-5-23" class="i">+                1,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h52" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -166,30 +166,28 @@ Plan: Select(
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h52-0-3" id="h52-0-3" class="i">+                            labels: [
</a><a href="#h52-0-4" id="h52-0-4" class="i">+                                None,
</a><a href="#h52-0-5" id="h52-0-5" class="i">+                                None,
</a><a href="#h52-0-6" id="h52-0-6" class="i">+                            ],
</a>                             expressions: [
<a href="#h52-0-8" id="h52-0-8" class="d">-                                (
</a><a href="#h52-0-9" id="h52-0-9" class="d">-                                    Field(
</a><a href="#h52-0-10" id="h52-0-10" class="d">-                                        5,
</a><a href="#h52-0-11" id="h52-0-11" class="d">-                                        Some(
</a><a href="#h52-0-12" id="h52-0-12" class="d">-                                            (
</a><a href="#h52-0-13" id="h52-0-13" class="d">-                                                None,
</a><a href="#h52-0-14" id="h52-0-14" class="d">-                                                &quot;rating&quot;,
</a><a href="#h52-0-15" id="h52-0-15" class="d">-                                            ),
</a><a href="#h52-0-16" id="h52-0-16" class="i">+                                Field(
</a><a href="#h52-0-17" id="h52-0-17" class="i">+                                    5,
</a><a href="#h52-0-18" id="h52-0-18" class="i">+                                    Some(
</a><a href="#h52-0-19" id="h52-0-19" class="i">+                                        (
</a><a href="#h52-0-20" id="h52-0-20" class="i">+                                            None,
</a><a href="#h52-0-21" id="h52-0-21" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h52-0-24" id="h52-0-24" class="d">-                                    None,
</a>                                 ),
<a href="#h52-0-26" id="h52-0-26" class="d">-                                (
</a><a href="#h52-0-27" id="h52-0-27" class="d">-                                    Field(
</a><a href="#h52-0-28" id="h52-0-28" class="d">-                                        2,
</a><a href="#h52-0-29" id="h52-0-29" class="d">-                                        Some(
</a><a href="#h52-0-30" id="h52-0-30" class="d">-                                            (
</a><a href="#h52-0-31" id="h52-0-31" class="d">-                                                None,
</a><a href="#h52-0-32" id="h52-0-32" class="d">-                                                &quot;studio_id&quot;,
</a><a href="#h52-0-33" id="h52-0-33" class="d">-                                            ),
</a><a href="#h52-0-34" id="h52-0-34" class="i">+                                Field(
</a><a href="#h52-0-35" id="h52-0-35" class="i">+                                    2,
</a><a href="#h52-0-36" id="h52-0-36" class="i">+                                    Some(
</a><a href="#h52-0-37" id="h52-0-37" class="i">+                                        (
</a><a href="#h52-0-38" id="h52-0-38" class="i">+                                            None,
</a><a href="#h52-0-39" id="h52-0-39" class="i">+                                            &quot;studio_id&quot;,
</a>                                         ),
                                     ),
<a href="#h52-0-42" id="h52-0-42" class="d">-                                    None,
</a>                                 ),
                             ],
                         },
<a href="#h52-1" id="h52-1" class="h">@@ -197,41 +195,40 @@ Plan: Select(
</a>                             Max,
                         ],
                     },
<a href="#h52-1-3" id="h52-1-3" class="i">+                    labels: [
</a><a href="#h52-1-4" id="h52-1-4" class="i">+                        None,
</a><a href="#h52-1-5" id="h52-1-5" class="i">+                        Some(
</a><a href="#h52-1-6" id="h52-1-6" class="i">+                            (
</a><a href="#h52-1-7" id="h52-1-7" class="i">+                                None,
</a><a href="#h52-1-8" id="h52-1-8" class="i">+                                &quot;rating&quot;,
</a><a href="#h52-1-9" id="h52-1-9" class="i">+                            ),
</a><a href="#h52-1-10" id="h52-1-10" class="i">+                        ),
</a><a href="#h52-1-11" id="h52-1-11" class="i">+                        None,
</a><a href="#h52-1-12" id="h52-1-12" class="i">+                    ],
</a>                     expressions: [
<a href="#h52-1-14" id="h52-1-14" class="d">-                        (
</a><a href="#h52-1-15" id="h52-1-15" class="d">-                            Field(
</a><a href="#h52-1-16" id="h52-1-16" class="d">-                                1,
</a><a href="#h52-1-17" id="h52-1-17" class="d">-                                Some(
</a><a href="#h52-1-18" id="h52-1-18" class="d">-                                    (
</a><a href="#h52-1-19" id="h52-1-19" class="d">-                                        Some(
</a><a href="#h52-1-20" id="h52-1-20" class="d">-                                            &quot;movies&quot;,
</a><a href="#h52-1-21" id="h52-1-21" class="d">-                                        ),
</a><a href="#h52-1-22" id="h52-1-22" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h52-1-23" id="h52-1-23" class="i">+                        Field(
</a><a href="#h52-1-24" id="h52-1-24" class="i">+                            1,
</a><a href="#h52-1-25" id="h52-1-25" class="i">+                            Some(
</a><a href="#h52-1-26" id="h52-1-26" class="i">+                                (
</a><a href="#h52-1-27" id="h52-1-27" class="i">+                                    Some(
</a><a href="#h52-1-28" id="h52-1-28" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h52-1-30" id="h52-1-30" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h52-1-33" id="h52-1-33" class="i">+                        ),
</a><a href="#h52-1-34" id="h52-1-34" class="i">+                        Field(
</a><a href="#h52-1-35" id="h52-1-35" class="i">+                            0,
</a>                             None,
                         ),
<a href="#h52-1-38" id="h52-1-38" class="d">-                        (
</a><a href="#h52-1-39" id="h52-1-39" class="d">-                            Field(
</a><a href="#h52-1-40" id="h52-1-40" class="d">-                                0,
</a><a href="#h52-1-41" id="h52-1-41" class="d">-                                None,
</a><a href="#h52-1-42" id="h52-1-42" class="d">-                            ),
</a><a href="#h52-1-43" id="h52-1-43" class="i">+                        Field(
</a><a href="#h52-1-44" id="h52-1-44" class="i">+                            1,
</a>                             Some(
<a href="#h52-1-46" id="h52-1-46" class="d">-                                &quot;rating&quot;,
</a><a href="#h52-1-47" id="h52-1-47" class="d">-                            ),
</a><a href="#h52-1-48" id="h52-1-48" class="d">-                        ),
</a><a href="#h52-1-49" id="h52-1-49" class="d">-                        (
</a><a href="#h52-1-50" id="h52-1-50" class="d">-                            Field(
</a><a href="#h52-1-51" id="h52-1-51" class="d">-                                1,
</a><a href="#h52-1-52" id="h52-1-52" class="d">-                                Some(
</a><a href="#h52-1-53" id="h52-1-53" class="d">-                                    (
</a><a href="#h52-1-54" id="h52-1-54" class="d">-                                        None,
</a><a href="#h52-1-55" id="h52-1-55" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h52-1-56" id="h52-1-56" class="d">-                                    ),
</a><a href="#h52-1-57" id="h52-1-57" class="i">+                                (
</a><a href="#h52-1-58" id="h52-1-58" class="i">+                                    None,
</a><a href="#h52-1-59" id="h52-1-59" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h52-1-62" id="h52-1-62" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h52-2" id="h52-2" class="h">@@ -291,19 +288,17 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h52-2-3" id="h52-2-3" class="i">+        labels: [
</a><a href="#h52-2-4" id="h52-2-4" class="i">+            None,
</a><a href="#h52-2-5" id="h52-2-5" class="i">+            None,
</a><a href="#h52-2-6" id="h52-2-6" class="i">+        ],
</a>         expressions: [
<a href="#h52-2-8" id="h52-2-8" class="d">-            (
</a><a href="#h52-2-9" id="h52-2-9" class="d">-                Field(
</a><a href="#h52-2-10" id="h52-2-10" class="d">-                    0,
</a><a href="#h52-2-11" id="h52-2-11" class="d">-                    None,
</a><a href="#h52-2-12" id="h52-2-12" class="d">-                ),
</a><a href="#h52-2-13" id="h52-2-13" class="i">+            Field(
</a><a href="#h52-2-14" id="h52-2-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h52-2-17" id="h52-2-17" class="d">-            (
</a><a href="#h52-2-18" id="h52-2-18" class="d">-                Field(
</a><a href="#h52-2-19" id="h52-2-19" class="d">-                    1,
</a><a href="#h52-2-20" id="h52-2-20" class="d">-                    None,
</a><a href="#h52-2-21" id="h52-2-21" class="d">-                ),
</a><a href="#h52-2-22" id="h52-2-22" class="i">+            Field(
</a><a href="#h52-2-23" id="h52-2-23" class="i">+                1,
</a>                 None,
             ),
         ],
<a href="#h52-3" id="h52-3" class="h">@@ -398,30 +393,28 @@ Optimized plan: Select(
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h52-3-3" id="h52-3-3" class="i">+                            labels: [
</a><a href="#h52-3-4" id="h52-3-4" class="i">+                                None,
</a><a href="#h52-3-5" id="h52-3-5" class="i">+                                None,
</a><a href="#h52-3-6" id="h52-3-6" class="i">+                            ],
</a>                             expressions: [
<a href="#h52-3-8" id="h52-3-8" class="d">-                                (
</a><a href="#h52-3-9" id="h52-3-9" class="d">-                                    Field(
</a><a href="#h52-3-10" id="h52-3-10" class="d">-                                        5,
</a><a href="#h52-3-11" id="h52-3-11" class="d">-                                        Some(
</a><a href="#h52-3-12" id="h52-3-12" class="d">-                                            (
</a><a href="#h52-3-13" id="h52-3-13" class="d">-                                                None,
</a><a href="#h52-3-14" id="h52-3-14" class="d">-                                                &quot;rating&quot;,
</a><a href="#h52-3-15" id="h52-3-15" class="d">-                                            ),
</a><a href="#h52-3-16" id="h52-3-16" class="i">+                                Field(
</a><a href="#h52-3-17" id="h52-3-17" class="i">+                                    5,
</a><a href="#h52-3-18" id="h52-3-18" class="i">+                                    Some(
</a><a href="#h52-3-19" id="h52-3-19" class="i">+                                        (
</a><a href="#h52-3-20" id="h52-3-20" class="i">+                                            None,
</a><a href="#h52-3-21" id="h52-3-21" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h52-3-24" id="h52-3-24" class="d">-                                    None,
</a>                                 ),
<a href="#h52-3-26" id="h52-3-26" class="d">-                                (
</a><a href="#h52-3-27" id="h52-3-27" class="d">-                                    Field(
</a><a href="#h52-3-28" id="h52-3-28" class="d">-                                        2,
</a><a href="#h52-3-29" id="h52-3-29" class="d">-                                        Some(
</a><a href="#h52-3-30" id="h52-3-30" class="d">-                                            (
</a><a href="#h52-3-31" id="h52-3-31" class="d">-                                                None,
</a><a href="#h52-3-32" id="h52-3-32" class="d">-                                                &quot;studio_id&quot;,
</a><a href="#h52-3-33" id="h52-3-33" class="d">-                                            ),
</a><a href="#h52-3-34" id="h52-3-34" class="i">+                                Field(
</a><a href="#h52-3-35" id="h52-3-35" class="i">+                                    2,
</a><a href="#h52-3-36" id="h52-3-36" class="i">+                                    Some(
</a><a href="#h52-3-37" id="h52-3-37" class="i">+                                        (
</a><a href="#h52-3-38" id="h52-3-38" class="i">+                                            None,
</a><a href="#h52-3-39" id="h52-3-39" class="i">+                                            &quot;studio_id&quot;,
</a>                                         ),
                                     ),
<a href="#h52-3-42" id="h52-3-42" class="d">-                                    None,
</a>                                 ),
                             ],
                         },
<a href="#h52-4" id="h52-4" class="h">@@ -429,41 +422,40 @@ Optimized plan: Select(
</a>                             Max,
                         ],
                     },
<a href="#h52-4-3" id="h52-4-3" class="i">+                    labels: [
</a><a href="#h52-4-4" id="h52-4-4" class="i">+                        None,
</a><a href="#h52-4-5" id="h52-4-5" class="i">+                        Some(
</a><a href="#h52-4-6" id="h52-4-6" class="i">+                            (
</a><a href="#h52-4-7" id="h52-4-7" class="i">+                                None,
</a><a href="#h52-4-8" id="h52-4-8" class="i">+                                &quot;rating&quot;,
</a><a href="#h52-4-9" id="h52-4-9" class="i">+                            ),
</a><a href="#h52-4-10" id="h52-4-10" class="i">+                        ),
</a><a href="#h52-4-11" id="h52-4-11" class="i">+                        None,
</a><a href="#h52-4-12" id="h52-4-12" class="i">+                    ],
</a>                     expressions: [
<a href="#h52-4-14" id="h52-4-14" class="d">-                        (
</a><a href="#h52-4-15" id="h52-4-15" class="d">-                            Field(
</a><a href="#h52-4-16" id="h52-4-16" class="d">-                                1,
</a><a href="#h52-4-17" id="h52-4-17" class="d">-                                Some(
</a><a href="#h52-4-18" id="h52-4-18" class="d">-                                    (
</a><a href="#h52-4-19" id="h52-4-19" class="d">-                                        Some(
</a><a href="#h52-4-20" id="h52-4-20" class="d">-                                            &quot;movies&quot;,
</a><a href="#h52-4-21" id="h52-4-21" class="d">-                                        ),
</a><a href="#h52-4-22" id="h52-4-22" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h52-4-23" id="h52-4-23" class="i">+                        Field(
</a><a href="#h52-4-24" id="h52-4-24" class="i">+                            1,
</a><a href="#h52-4-25" id="h52-4-25" class="i">+                            Some(
</a><a href="#h52-4-26" id="h52-4-26" class="i">+                                (
</a><a href="#h52-4-27" id="h52-4-27" class="i">+                                    Some(
</a><a href="#h52-4-28" id="h52-4-28" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h52-4-30" id="h52-4-30" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h52-4-33" id="h52-4-33" class="i">+                        ),
</a><a href="#h52-4-34" id="h52-4-34" class="i">+                        Field(
</a><a href="#h52-4-35" id="h52-4-35" class="i">+                            0,
</a>                             None,
                         ),
<a href="#h52-4-38" id="h52-4-38" class="d">-                        (
</a><a href="#h52-4-39" id="h52-4-39" class="d">-                            Field(
</a><a href="#h52-4-40" id="h52-4-40" class="d">-                                0,
</a><a href="#h52-4-41" id="h52-4-41" class="d">-                                None,
</a><a href="#h52-4-42" id="h52-4-42" class="d">-                            ),
</a><a href="#h52-4-43" id="h52-4-43" class="i">+                        Field(
</a><a href="#h52-4-44" id="h52-4-44" class="i">+                            1,
</a>                             Some(
<a href="#h52-4-46" id="h52-4-46" class="d">-                                &quot;rating&quot;,
</a><a href="#h52-4-47" id="h52-4-47" class="d">-                            ),
</a><a href="#h52-4-48" id="h52-4-48" class="d">-                        ),
</a><a href="#h52-4-49" id="h52-4-49" class="d">-                        (
</a><a href="#h52-4-50" id="h52-4-50" class="d">-                            Field(
</a><a href="#h52-4-51" id="h52-4-51" class="d">-                                1,
</a><a href="#h52-4-52" id="h52-4-52" class="d">-                                Some(
</a><a href="#h52-4-53" id="h52-4-53" class="d">-                                    (
</a><a href="#h52-4-54" id="h52-4-54" class="d">-                                        None,
</a><a href="#h52-4-55" id="h52-4-55" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h52-4-56" id="h52-4-56" class="d">-                                    ),
</a><a href="#h52-4-57" id="h52-4-57" class="i">+                                (
</a><a href="#h52-4-58" id="h52-4-58" class="i">+                                    None,
</a><a href="#h52-4-59" id="h52-4-59" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h52-4-62" id="h52-4-62" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h52-5" id="h52-5" class="h">@@ -523,19 +515,17 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h52-5-3" id="h52-5-3" class="i">+        labels: [
</a><a href="#h52-5-4" id="h52-5-4" class="i">+            None,
</a><a href="#h52-5-5" id="h52-5-5" class="i">+            None,
</a><a href="#h52-5-6" id="h52-5-6" class="i">+        ],
</a>         expressions: [
<a href="#h52-5-8" id="h52-5-8" class="d">-            (
</a><a href="#h52-5-9" id="h52-5-9" class="d">-                Field(
</a><a href="#h52-5-10" id="h52-5-10" class="d">-                    0,
</a><a href="#h52-5-11" id="h52-5-11" class="d">-                    None,
</a><a href="#h52-5-12" id="h52-5-12" class="d">-                ),
</a><a href="#h52-5-13" id="h52-5-13" class="i">+            Field(
</a><a href="#h52-5-14" id="h52-5-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h52-5-17" id="h52-5-17" class="d">-            (
</a><a href="#h52-5-18" id="h52-5-18" class="d">-                Field(
</a><a href="#h52-5-19" id="h52-5-19" class="d">-                    1,
</a><a href="#h52-5-20" id="h52-5-20" class="d">-                    None,
</a><a href="#h52-5-21" id="h52-5-21" class="d">-                ),
</a><a href="#h52-5-22" id="h52-5-22" class="i">+            Field(
</a><a href="#h52-5-23" id="h52-5-23" class="i">+                1,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h53" href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a> b/<a href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -152,42 +152,38 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h53-0-3" id="h53-0-3" class="i">+                    labels: [
</a><a href="#h53-0-4" id="h53-0-4" class="i">+                        None,
</a><a href="#h53-0-5" id="h53-0-5" class="i">+                        None,
</a><a href="#h53-0-6" id="h53-0-6" class="i">+                        None,
</a><a href="#h53-0-7" id="h53-0-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h53-0-9" id="h53-0-9" class="d">-                        (
</a><a href="#h53-0-10" id="h53-0-10" class="d">-                            Field(
</a><a href="#h53-0-11" id="h53-0-11" class="d">-                                0,
</a><a href="#h53-0-12" id="h53-0-12" class="d">-                                Some(
</a><a href="#h53-0-13" id="h53-0-13" class="d">-                                    (
</a><a href="#h53-0-14" id="h53-0-14" class="d">-                                        None,
</a><a href="#h53-0-15" id="h53-0-15" class="d">-                                        &quot;id&quot;,
</a><a href="#h53-0-16" id="h53-0-16" class="d">-                                    ),
</a><a href="#h53-0-17" id="h53-0-17" class="i">+                        Field(
</a><a href="#h53-0-18" id="h53-0-18" class="i">+                            0,
</a><a href="#h53-0-19" id="h53-0-19" class="i">+                            Some(
</a><a href="#h53-0-20" id="h53-0-20" class="i">+                                (
</a><a href="#h53-0-21" id="h53-0-21" class="i">+                                    None,
</a><a href="#h53-0-22" id="h53-0-22" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
<a href="#h53-0-25" id="h53-0-25" class="d">-                            None,
</a>                         ),
<a href="#h53-0-27" id="h53-0-27" class="d">-                        (
</a><a href="#h53-0-28" id="h53-0-28" class="d">-                            Field(
</a><a href="#h53-0-29" id="h53-0-29" class="d">-                                5,
</a><a href="#h53-0-30" id="h53-0-30" class="d">-                                Some(
</a><a href="#h53-0-31" id="h53-0-31" class="d">-                                    (
</a><a href="#h53-0-32" id="h53-0-32" class="d">-                                        None,
</a><a href="#h53-0-33" id="h53-0-33" class="d">-                                        &quot;rating&quot;,
</a><a href="#h53-0-34" id="h53-0-34" class="d">-                                    ),
</a><a href="#h53-0-35" id="h53-0-35" class="i">+                        Field(
</a><a href="#h53-0-36" id="h53-0-36" class="i">+                            5,
</a><a href="#h53-0-37" id="h53-0-37" class="i">+                            Some(
</a><a href="#h53-0-38" id="h53-0-38" class="i">+                                (
</a><a href="#h53-0-39" id="h53-0-39" class="i">+                                    None,
</a><a href="#h53-0-40" id="h53-0-40" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h53-0-43" id="h53-0-43" class="d">-                            None,
</a>                         ),
<a href="#h53-0-45" id="h53-0-45" class="d">-                        (
</a><a href="#h53-0-46" id="h53-0-46" class="d">-                            Field(
</a><a href="#h53-0-47" id="h53-0-47" class="d">-                                5,
</a><a href="#h53-0-48" id="h53-0-48" class="d">-                                Some(
</a><a href="#h53-0-49" id="h53-0-49" class="d">-                                    (
</a><a href="#h53-0-50" id="h53-0-50" class="d">-                                        None,
</a><a href="#h53-0-51" id="h53-0-51" class="d">-                                        &quot;rating&quot;,
</a><a href="#h53-0-52" id="h53-0-52" class="d">-                                    ),
</a><a href="#h53-0-53" id="h53-0-53" class="i">+                        Field(
</a><a href="#h53-0-54" id="h53-0-54" class="i">+                            5,
</a><a href="#h53-0-55" id="h53-0-55" class="i">+                            Some(
</a><a href="#h53-0-56" id="h53-0-56" class="i">+                                (
</a><a href="#h53-0-57" id="h53-0-57" class="i">+                                    None,
</a><a href="#h53-0-58" id="h53-0-58" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h53-0-61" id="h53-0-61" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h53-1" id="h53-1" class="h">@@ -227,19 +223,17 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h53-1-3" id="h53-1-3" class="i">+        labels: [
</a><a href="#h53-1-4" id="h53-1-4" class="i">+            None,
</a><a href="#h53-1-5" id="h53-1-5" class="i">+            None,
</a><a href="#h53-1-6" id="h53-1-6" class="i">+        ],
</a>         expressions: [
<a href="#h53-1-8" id="h53-1-8" class="d">-            (
</a><a href="#h53-1-9" id="h53-1-9" class="d">-                Field(
</a><a href="#h53-1-10" id="h53-1-10" class="d">-                    0,
</a><a href="#h53-1-11" id="h53-1-11" class="d">-                    None,
</a><a href="#h53-1-12" id="h53-1-12" class="d">-                ),
</a><a href="#h53-1-13" id="h53-1-13" class="i">+            Field(
</a><a href="#h53-1-14" id="h53-1-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h53-1-17" id="h53-1-17" class="d">-            (
</a><a href="#h53-1-18" id="h53-1-18" class="d">-                Field(
</a><a href="#h53-1-19" id="h53-1-19" class="d">-                    1,
</a><a href="#h53-1-20" id="h53-1-20" class="d">-                    None,
</a><a href="#h53-1-21" id="h53-1-21" class="d">-                ),
</a><a href="#h53-1-22" id="h53-1-22" class="i">+            Field(
</a><a href="#h53-1-23" id="h53-1-23" class="i">+                1,
</a>                 None,
             ),
         ],
<a href="#h53-2" id="h53-2" class="h">@@ -332,42 +326,38 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h53-2-3" id="h53-2-3" class="i">+                    labels: [
</a><a href="#h53-2-4" id="h53-2-4" class="i">+                        None,
</a><a href="#h53-2-5" id="h53-2-5" class="i">+                        None,
</a><a href="#h53-2-6" id="h53-2-6" class="i">+                        None,
</a><a href="#h53-2-7" id="h53-2-7" class="i">+                    ],
</a>                     expressions: [
<a href="#h53-2-9" id="h53-2-9" class="d">-                        (
</a><a href="#h53-2-10" id="h53-2-10" class="d">-                            Field(
</a><a href="#h53-2-11" id="h53-2-11" class="d">-                                0,
</a><a href="#h53-2-12" id="h53-2-12" class="d">-                                Some(
</a><a href="#h53-2-13" id="h53-2-13" class="d">-                                    (
</a><a href="#h53-2-14" id="h53-2-14" class="d">-                                        None,
</a><a href="#h53-2-15" id="h53-2-15" class="d">-                                        &quot;id&quot;,
</a><a href="#h53-2-16" id="h53-2-16" class="d">-                                    ),
</a><a href="#h53-2-17" id="h53-2-17" class="i">+                        Field(
</a><a href="#h53-2-18" id="h53-2-18" class="i">+                            0,
</a><a href="#h53-2-19" id="h53-2-19" class="i">+                            Some(
</a><a href="#h53-2-20" id="h53-2-20" class="i">+                                (
</a><a href="#h53-2-21" id="h53-2-21" class="i">+                                    None,
</a><a href="#h53-2-22" id="h53-2-22" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
<a href="#h53-2-25" id="h53-2-25" class="d">-                            None,
</a>                         ),
<a href="#h53-2-27" id="h53-2-27" class="d">-                        (
</a><a href="#h53-2-28" id="h53-2-28" class="d">-                            Field(
</a><a href="#h53-2-29" id="h53-2-29" class="d">-                                5,
</a><a href="#h53-2-30" id="h53-2-30" class="d">-                                Some(
</a><a href="#h53-2-31" id="h53-2-31" class="d">-                                    (
</a><a href="#h53-2-32" id="h53-2-32" class="d">-                                        None,
</a><a href="#h53-2-33" id="h53-2-33" class="d">-                                        &quot;rating&quot;,
</a><a href="#h53-2-34" id="h53-2-34" class="d">-                                    ),
</a><a href="#h53-2-35" id="h53-2-35" class="i">+                        Field(
</a><a href="#h53-2-36" id="h53-2-36" class="i">+                            5,
</a><a href="#h53-2-37" id="h53-2-37" class="i">+                            Some(
</a><a href="#h53-2-38" id="h53-2-38" class="i">+                                (
</a><a href="#h53-2-39" id="h53-2-39" class="i">+                                    None,
</a><a href="#h53-2-40" id="h53-2-40" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h53-2-43" id="h53-2-43" class="d">-                            None,
</a>                         ),
<a href="#h53-2-45" id="h53-2-45" class="d">-                        (
</a><a href="#h53-2-46" id="h53-2-46" class="d">-                            Field(
</a><a href="#h53-2-47" id="h53-2-47" class="d">-                                5,
</a><a href="#h53-2-48" id="h53-2-48" class="d">-                                Some(
</a><a href="#h53-2-49" id="h53-2-49" class="d">-                                    (
</a><a href="#h53-2-50" id="h53-2-50" class="d">-                                        None,
</a><a href="#h53-2-51" id="h53-2-51" class="d">-                                        &quot;rating&quot;,
</a><a href="#h53-2-52" id="h53-2-52" class="d">-                                    ),
</a><a href="#h53-2-53" id="h53-2-53" class="i">+                        Field(
</a><a href="#h53-2-54" id="h53-2-54" class="i">+                            5,
</a><a href="#h53-2-55" id="h53-2-55" class="i">+                            Some(
</a><a href="#h53-2-56" id="h53-2-56" class="i">+                                (
</a><a href="#h53-2-57" id="h53-2-57" class="i">+                                    None,
</a><a href="#h53-2-58" id="h53-2-58" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h53-2-61" id="h53-2-61" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h53-3" id="h53-3" class="h">@@ -407,19 +397,17 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h53-3-3" id="h53-3-3" class="i">+        labels: [
</a><a href="#h53-3-4" id="h53-3-4" class="i">+            None,
</a><a href="#h53-3-5" id="h53-3-5" class="i">+            None,
</a><a href="#h53-3-6" id="h53-3-6" class="i">+        ],
</a>         expressions: [
<a href="#h53-3-8" id="h53-3-8" class="d">-            (
</a><a href="#h53-3-9" id="h53-3-9" class="d">-                Field(
</a><a href="#h53-3-10" id="h53-3-10" class="d">-                    0,
</a><a href="#h53-3-11" id="h53-3-11" class="d">-                    None,
</a><a href="#h53-3-12" id="h53-3-12" class="d">-                ),
</a><a href="#h53-3-13" id="h53-3-13" class="i">+            Field(
</a><a href="#h53-3-14" id="h53-3-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h53-3-17" id="h53-3-17" class="d">-            (
</a><a href="#h53-3-18" id="h53-3-18" class="d">-                Field(
</a><a href="#h53-3-19" id="h53-3-19" class="d">-                    1,
</a><a href="#h53-3-20" id="h53-3-20" class="d">-                    None,
</a><a href="#h53-3-21" id="h53-3-21" class="d">-                ),
</a><a href="#h53-3-22" id="h53-3-22" class="i">+            Field(
</a><a href="#h53-3-23" id="h53-3-23" class="i">+                1,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h54" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -157,30 +157,28 @@ Plan: Select(
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h54-0-3" id="h54-0-3" class="i">+                            labels: [
</a><a href="#h54-0-4" id="h54-0-4" class="i">+                                None,
</a><a href="#h54-0-5" id="h54-0-5" class="i">+                                None,
</a><a href="#h54-0-6" id="h54-0-6" class="i">+                            ],
</a>                             expressions: [
<a href="#h54-0-8" id="h54-0-8" class="d">-                                (
</a><a href="#h54-0-9" id="h54-0-9" class="d">-                                    Field(
</a><a href="#h54-0-10" id="h54-0-10" class="d">-                                        5,
</a><a href="#h54-0-11" id="h54-0-11" class="d">-                                        Some(
</a><a href="#h54-0-12" id="h54-0-12" class="d">-                                            (
</a><a href="#h54-0-13" id="h54-0-13" class="d">-                                                None,
</a><a href="#h54-0-14" id="h54-0-14" class="d">-                                                &quot;rating&quot;,
</a><a href="#h54-0-15" id="h54-0-15" class="d">-                                            ),
</a><a href="#h54-0-16" id="h54-0-16" class="i">+                                Field(
</a><a href="#h54-0-17" id="h54-0-17" class="i">+                                    5,
</a><a href="#h54-0-18" id="h54-0-18" class="i">+                                    Some(
</a><a href="#h54-0-19" id="h54-0-19" class="i">+                                        (
</a><a href="#h54-0-20" id="h54-0-20" class="i">+                                            None,
</a><a href="#h54-0-21" id="h54-0-21" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h54-0-24" id="h54-0-24" class="d">-                                    None,
</a>                                 ),
<a href="#h54-0-26" id="h54-0-26" class="d">-                                (
</a><a href="#h54-0-27" id="h54-0-27" class="d">-                                    Field(
</a><a href="#h54-0-28" id="h54-0-28" class="d">-                                        2,
</a><a href="#h54-0-29" id="h54-0-29" class="d">-                                        Some(
</a><a href="#h54-0-30" id="h54-0-30" class="d">-                                            (
</a><a href="#h54-0-31" id="h54-0-31" class="d">-                                                None,
</a><a href="#h54-0-32" id="h54-0-32" class="d">-                                                &quot;studio_id&quot;,
</a><a href="#h54-0-33" id="h54-0-33" class="d">-                                            ),
</a><a href="#h54-0-34" id="h54-0-34" class="i">+                                Field(
</a><a href="#h54-0-35" id="h54-0-35" class="i">+                                    2,
</a><a href="#h54-0-36" id="h54-0-36" class="i">+                                    Some(
</a><a href="#h54-0-37" id="h54-0-37" class="i">+                                        (
</a><a href="#h54-0-38" id="h54-0-38" class="i">+                                            None,
</a><a href="#h54-0-39" id="h54-0-39" class="i">+                                            &quot;studio_id&quot;,
</a>                                         ),
                                     ),
<a href="#h54-0-42" id="h54-0-42" class="d">-                                    None,
</a>                                 ),
                             ],
                         },
<a href="#h54-1" id="h54-1" class="h">@@ -188,26 +186,24 @@ Plan: Select(
</a>                             Max,
                         ],
                     },
<a href="#h54-1-3" id="h54-1-3" class="i">+                    labels: [
</a><a href="#h54-1-4" id="h54-1-4" class="i">+                        None,
</a><a href="#h54-1-5" id="h54-1-5" class="i">+                        None,
</a><a href="#h54-1-6" id="h54-1-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h54-1-8" id="h54-1-8" class="d">-                        (
</a><a href="#h54-1-9" id="h54-1-9" class="d">-                            Field(
</a><a href="#h54-1-10" id="h54-1-10" class="d">-                                1,
</a><a href="#h54-1-11" id="h54-1-11" class="d">-                                Some(
</a><a href="#h54-1-12" id="h54-1-12" class="d">-                                    (
</a><a href="#h54-1-13" id="h54-1-13" class="d">-                                        Some(
</a><a href="#h54-1-14" id="h54-1-14" class="d">-                                            &quot;movies&quot;,
</a><a href="#h54-1-15" id="h54-1-15" class="d">-                                        ),
</a><a href="#h54-1-16" id="h54-1-16" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h54-1-17" id="h54-1-17" class="i">+                        Field(
</a><a href="#h54-1-18" id="h54-1-18" class="i">+                            1,
</a><a href="#h54-1-19" id="h54-1-19" class="i">+                            Some(
</a><a href="#h54-1-20" id="h54-1-20" class="i">+                                (
</a><a href="#h54-1-21" id="h54-1-21" class="i">+                                    Some(
</a><a href="#h54-1-22" id="h54-1-22" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h54-1-24" id="h54-1-24" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h54-1-27" id="h54-1-27" class="d">-                            None,
</a>                         ),
<a href="#h54-1-29" id="h54-1-29" class="d">-                        (
</a><a href="#h54-1-30" id="h54-1-30" class="d">-                            Field(
</a><a href="#h54-1-31" id="h54-1-31" class="d">-                                0,
</a><a href="#h54-1-32" id="h54-1-32" class="d">-                                None,
</a><a href="#h54-1-33" id="h54-1-33" class="d">-                            ),
</a><a href="#h54-1-34" id="h54-1-34" class="i">+                        Field(
</a><a href="#h54-1-35" id="h54-1-35" class="i">+                            0,
</a>                             None,
                         ),
                     ],
<a href="#h54-2" id="h54-2" class="h">@@ -241,12 +237,12 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h54-2-3" id="h54-2-3" class="i">+        labels: [
</a><a href="#h54-2-4" id="h54-2-4" class="i">+            None,
</a><a href="#h54-2-5" id="h54-2-5" class="i">+        ],
</a>         expressions: [
<a href="#h54-2-7" id="h54-2-7" class="d">-            (
</a><a href="#h54-2-8" id="h54-2-8" class="d">-                Field(
</a><a href="#h54-2-9" id="h54-2-9" class="d">-                    0,
</a><a href="#h54-2-10" id="h54-2-10" class="d">-                    None,
</a><a href="#h54-2-11" id="h54-2-11" class="d">-                ),
</a><a href="#h54-2-12" id="h54-2-12" class="i">+            Field(
</a><a href="#h54-2-13" id="h54-2-13" class="i">+                0,
</a>                 None,
             ),
         ],
<a href="#h54-3" id="h54-3" class="h">@@ -341,30 +337,28 @@ Optimized plan: Select(
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h54-3-3" id="h54-3-3" class="i">+                            labels: [
</a><a href="#h54-3-4" id="h54-3-4" class="i">+                                None,
</a><a href="#h54-3-5" id="h54-3-5" class="i">+                                None,
</a><a href="#h54-3-6" id="h54-3-6" class="i">+                            ],
</a>                             expressions: [
<a href="#h54-3-8" id="h54-3-8" class="d">-                                (
</a><a href="#h54-3-9" id="h54-3-9" class="d">-                                    Field(
</a><a href="#h54-3-10" id="h54-3-10" class="d">-                                        5,
</a><a href="#h54-3-11" id="h54-3-11" class="d">-                                        Some(
</a><a href="#h54-3-12" id="h54-3-12" class="d">-                                            (
</a><a href="#h54-3-13" id="h54-3-13" class="d">-                                                None,
</a><a href="#h54-3-14" id="h54-3-14" class="d">-                                                &quot;rating&quot;,
</a><a href="#h54-3-15" id="h54-3-15" class="d">-                                            ),
</a><a href="#h54-3-16" id="h54-3-16" class="i">+                                Field(
</a><a href="#h54-3-17" id="h54-3-17" class="i">+                                    5,
</a><a href="#h54-3-18" id="h54-3-18" class="i">+                                    Some(
</a><a href="#h54-3-19" id="h54-3-19" class="i">+                                        (
</a><a href="#h54-3-20" id="h54-3-20" class="i">+                                            None,
</a><a href="#h54-3-21" id="h54-3-21" class="i">+                                            &quot;rating&quot;,
</a>                                         ),
                                     ),
<a href="#h54-3-24" id="h54-3-24" class="d">-                                    None,
</a>                                 ),
<a href="#h54-3-26" id="h54-3-26" class="d">-                                (
</a><a href="#h54-3-27" id="h54-3-27" class="d">-                                    Field(
</a><a href="#h54-3-28" id="h54-3-28" class="d">-                                        2,
</a><a href="#h54-3-29" id="h54-3-29" class="d">-                                        Some(
</a><a href="#h54-3-30" id="h54-3-30" class="d">-                                            (
</a><a href="#h54-3-31" id="h54-3-31" class="d">-                                                None,
</a><a href="#h54-3-32" id="h54-3-32" class="d">-                                                &quot;studio_id&quot;,
</a><a href="#h54-3-33" id="h54-3-33" class="d">-                                            ),
</a><a href="#h54-3-34" id="h54-3-34" class="i">+                                Field(
</a><a href="#h54-3-35" id="h54-3-35" class="i">+                                    2,
</a><a href="#h54-3-36" id="h54-3-36" class="i">+                                    Some(
</a><a href="#h54-3-37" id="h54-3-37" class="i">+                                        (
</a><a href="#h54-3-38" id="h54-3-38" class="i">+                                            None,
</a><a href="#h54-3-39" id="h54-3-39" class="i">+                                            &quot;studio_id&quot;,
</a>                                         ),
                                     ),
<a href="#h54-3-42" id="h54-3-42" class="d">-                                    None,
</a>                                 ),
                             ],
                         },
<a href="#h54-4" id="h54-4" class="h">@@ -372,26 +366,24 @@ Optimized plan: Select(
</a>                             Max,
                         ],
                     },
<a href="#h54-4-3" id="h54-4-3" class="i">+                    labels: [
</a><a href="#h54-4-4" id="h54-4-4" class="i">+                        None,
</a><a href="#h54-4-5" id="h54-4-5" class="i">+                        None,
</a><a href="#h54-4-6" id="h54-4-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h54-4-8" id="h54-4-8" class="d">-                        (
</a><a href="#h54-4-9" id="h54-4-9" class="d">-                            Field(
</a><a href="#h54-4-10" id="h54-4-10" class="d">-                                1,
</a><a href="#h54-4-11" id="h54-4-11" class="d">-                                Some(
</a><a href="#h54-4-12" id="h54-4-12" class="d">-                                    (
</a><a href="#h54-4-13" id="h54-4-13" class="d">-                                        Some(
</a><a href="#h54-4-14" id="h54-4-14" class="d">-                                            &quot;movies&quot;,
</a><a href="#h54-4-15" id="h54-4-15" class="d">-                                        ),
</a><a href="#h54-4-16" id="h54-4-16" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h54-4-17" id="h54-4-17" class="i">+                        Field(
</a><a href="#h54-4-18" id="h54-4-18" class="i">+                            1,
</a><a href="#h54-4-19" id="h54-4-19" class="i">+                            Some(
</a><a href="#h54-4-20" id="h54-4-20" class="i">+                                (
</a><a href="#h54-4-21" id="h54-4-21" class="i">+                                    Some(
</a><a href="#h54-4-22" id="h54-4-22" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h54-4-24" id="h54-4-24" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h54-4-27" id="h54-4-27" class="d">-                            None,
</a>                         ),
<a href="#h54-4-29" id="h54-4-29" class="d">-                        (
</a><a href="#h54-4-30" id="h54-4-30" class="d">-                            Field(
</a><a href="#h54-4-31" id="h54-4-31" class="d">-                                0,
</a><a href="#h54-4-32" id="h54-4-32" class="d">-                                None,
</a><a href="#h54-4-33" id="h54-4-33" class="d">-                            ),
</a><a href="#h54-4-34" id="h54-4-34" class="i">+                        Field(
</a><a href="#h54-4-35" id="h54-4-35" class="i">+                            0,
</a>                             None,
                         ),
                     ],
<a href="#h54-5" id="h54-5" class="h">@@ -425,12 +417,12 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h54-5-3" id="h54-5-3" class="i">+        labels: [
</a><a href="#h54-5-4" id="h54-5-4" class="i">+            None,
</a><a href="#h54-5-5" id="h54-5-5" class="i">+        ],
</a>         expressions: [
<a href="#h54-5-7" id="h54-5-7" class="d">-            (
</a><a href="#h54-5-8" id="h54-5-8" class="d">-                Field(
</a><a href="#h54-5-9" id="h54-5-9" class="d">-                    0,
</a><a href="#h54-5-10" id="h54-5-10" class="d">-                    None,
</a><a href="#h54-5-11" id="h54-5-11" class="d">-                ),
</a><a href="#h54-5-12" id="h54-5-12" class="i">+            Field(
</a><a href="#h54-5-13" id="h54-5-13" class="i">+                0,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h55" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -414,90 +414,80 @@ Plan: Select(
</a>                 ),
             ),
         },
<a href="#h55-0-3" id="h55-0-3" class="i">+        labels: [
</a><a href="#h55-0-4" id="h55-0-4" class="i">+            None,
</a><a href="#h55-0-5" id="h55-0-5" class="i">+            None,
</a><a href="#h55-0-6" id="h55-0-6" class="i">+            None,
</a><a href="#h55-0-7" id="h55-0-7" class="i">+            None,
</a><a href="#h55-0-8" id="h55-0-8" class="i">+            None,
</a><a href="#h55-0-9" id="h55-0-9" class="i">+            None,
</a><a href="#h55-0-10" id="h55-0-10" class="i">+        ],
</a>         expressions: [
<a href="#h55-0-12" id="h55-0-12" class="d">-            (
</a><a href="#h55-0-13" id="h55-0-13" class="d">-                Field(
</a><a href="#h55-0-14" id="h55-0-14" class="d">-                    0,
</a><a href="#h55-0-15" id="h55-0-15" class="d">-                    Some(
</a><a href="#h55-0-16" id="h55-0-16" class="d">-                        (
</a><a href="#h55-0-17" id="h55-0-17" class="d">-                            Some(
</a><a href="#h55-0-18" id="h55-0-18" class="d">-                                &quot;m&quot;,
</a><a href="#h55-0-19" id="h55-0-19" class="d">-                            ),
</a><a href="#h55-0-20" id="h55-0-20" class="d">-                            &quot;id&quot;,
</a><a href="#h55-0-21" id="h55-0-21" class="i">+            Field(
</a><a href="#h55-0-22" id="h55-0-22" class="i">+                0,
</a><a href="#h55-0-23" id="h55-0-23" class="i">+                Some(
</a><a href="#h55-0-24" id="h55-0-24" class="i">+                    (
</a><a href="#h55-0-25" id="h55-0-25" class="i">+                        Some(
</a><a href="#h55-0-26" id="h55-0-26" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h55-0-28" id="h55-0-28" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h55-0-31" id="h55-0-31" class="d">-                None,
</a>             ),
<a href="#h55-0-33" id="h55-0-33" class="d">-            (
</a><a href="#h55-0-34" id="h55-0-34" class="d">-                Field(
</a><a href="#h55-0-35" id="h55-0-35" class="d">-                    1,
</a><a href="#h55-0-36" id="h55-0-36" class="d">-                    Some(
</a><a href="#h55-0-37" id="h55-0-37" class="d">-                        (
</a><a href="#h55-0-38" id="h55-0-38" class="d">-                            Some(
</a><a href="#h55-0-39" id="h55-0-39" class="d">-                                &quot;m&quot;,
</a><a href="#h55-0-40" id="h55-0-40" class="d">-                            ),
</a><a href="#h55-0-41" id="h55-0-41" class="d">-                            &quot;title&quot;,
</a><a href="#h55-0-42" id="h55-0-42" class="i">+            Field(
</a><a href="#h55-0-43" id="h55-0-43" class="i">+                1,
</a><a href="#h55-0-44" id="h55-0-44" class="i">+                Some(
</a><a href="#h55-0-45" id="h55-0-45" class="i">+                    (
</a><a href="#h55-0-46" id="h55-0-46" class="i">+                        Some(
</a><a href="#h55-0-47" id="h55-0-47" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h55-0-49" id="h55-0-49" class="i">+                        &quot;title&quot;,
</a>                     ),
                 ),
<a href="#h55-0-52" id="h55-0-52" class="d">-                None,
</a>             ),
<a href="#h55-0-54" id="h55-0-54" class="d">-            (
</a><a href="#h55-0-55" id="h55-0-55" class="d">-                Field(
</a><a href="#h55-0-56" id="h55-0-56" class="d">-                    7,
</a><a href="#h55-0-57" id="h55-0-57" class="d">-                    Some(
</a><a href="#h55-0-58" id="h55-0-58" class="d">-                        (
</a><a href="#h55-0-59" id="h55-0-59" class="d">-                            Some(
</a><a href="#h55-0-60" id="h55-0-60" class="d">-                                &quot;g&quot;,
</a><a href="#h55-0-61" id="h55-0-61" class="d">-                            ),
</a><a href="#h55-0-62" id="h55-0-62" class="d">-                            &quot;id&quot;,
</a><a href="#h55-0-63" id="h55-0-63" class="i">+            Field(
</a><a href="#h55-0-64" id="h55-0-64" class="i">+                7,
</a><a href="#h55-0-65" id="h55-0-65" class="i">+                Some(
</a><a href="#h55-0-66" id="h55-0-66" class="i">+                    (
</a><a href="#h55-0-67" id="h55-0-67" class="i">+                        Some(
</a><a href="#h55-0-68" id="h55-0-68" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h55-0-70" id="h55-0-70" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h55-0-73" id="h55-0-73" class="d">-                None,
</a>             ),
<a href="#h55-0-75" id="h55-0-75" class="d">-            (
</a><a href="#h55-0-76" id="h55-0-76" class="d">-                Field(
</a><a href="#h55-0-77" id="h55-0-77" class="d">-                    8,
</a><a href="#h55-0-78" id="h55-0-78" class="d">-                    Some(
</a><a href="#h55-0-79" id="h55-0-79" class="d">-                        (
</a><a href="#h55-0-80" id="h55-0-80" class="d">-                            Some(
</a><a href="#h55-0-81" id="h55-0-81" class="d">-                                &quot;g&quot;,
</a><a href="#h55-0-82" id="h55-0-82" class="d">-                            ),
</a><a href="#h55-0-83" id="h55-0-83" class="d">-                            &quot;name&quot;,
</a><a href="#h55-0-84" id="h55-0-84" class="i">+            Field(
</a><a href="#h55-0-85" id="h55-0-85" class="i">+                8,
</a><a href="#h55-0-86" id="h55-0-86" class="i">+                Some(
</a><a href="#h55-0-87" id="h55-0-87" class="i">+                    (
</a><a href="#h55-0-88" id="h55-0-88" class="i">+                        Some(
</a><a href="#h55-0-89" id="h55-0-89" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h55-0-91" id="h55-0-91" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h55-0-94" id="h55-0-94" class="d">-                None,
</a>             ),
<a href="#h55-0-96" id="h55-0-96" class="d">-            (
</a><a href="#h55-0-97" id="h55-0-97" class="d">-                Field(
</a><a href="#h55-0-98" id="h55-0-98" class="d">-                    9,
</a><a href="#h55-0-99" id="h55-0-99" class="d">-                    Some(
</a><a href="#h55-0-100" id="h55-0-100" class="d">-                        (
</a><a href="#h55-0-101" id="h55-0-101" class="d">-                            Some(
</a><a href="#h55-0-102" id="h55-0-102" class="d">-                                &quot;c&quot;,
</a><a href="#h55-0-103" id="h55-0-103" class="d">-                            ),
</a><a href="#h55-0-104" id="h55-0-104" class="d">-                            &quot;id&quot;,
</a><a href="#h55-0-105" id="h55-0-105" class="i">+            Field(
</a><a href="#h55-0-106" id="h55-0-106" class="i">+                9,
</a><a href="#h55-0-107" id="h55-0-107" class="i">+                Some(
</a><a href="#h55-0-108" id="h55-0-108" class="i">+                    (
</a><a href="#h55-0-109" id="h55-0-109" class="i">+                        Some(
</a><a href="#h55-0-110" id="h55-0-110" class="i">+                            &quot;c&quot;,
</a>                         ),
<a href="#h55-0-112" id="h55-0-112" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h55-0-115" id="h55-0-115" class="d">-                None,
</a>             ),
<a href="#h55-0-117" id="h55-0-117" class="d">-            (
</a><a href="#h55-0-118" id="h55-0-118" class="d">-                Field(
</a><a href="#h55-0-119" id="h55-0-119" class="d">-                    10,
</a><a href="#h55-0-120" id="h55-0-120" class="d">-                    Some(
</a><a href="#h55-0-121" id="h55-0-121" class="d">-                        (
</a><a href="#h55-0-122" id="h55-0-122" class="d">-                            Some(
</a><a href="#h55-0-123" id="h55-0-123" class="d">-                                &quot;c&quot;,
</a><a href="#h55-0-124" id="h55-0-124" class="d">-                            ),
</a><a href="#h55-0-125" id="h55-0-125" class="d">-                            &quot;name&quot;,
</a><a href="#h55-0-126" id="h55-0-126" class="i">+            Field(
</a><a href="#h55-0-127" id="h55-0-127" class="i">+                10,
</a><a href="#h55-0-128" id="h55-0-128" class="i">+                Some(
</a><a href="#h55-0-129" id="h55-0-129" class="i">+                    (
</a><a href="#h55-0-130" id="h55-0-130" class="i">+                        Some(
</a><a href="#h55-0-131" id="h55-0-131" class="i">+                            &quot;c&quot;,
</a>                         ),
<a href="#h55-0-133" id="h55-0-133" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h55-0-136" id="h55-0-136" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h55-1" id="h55-1" class="h">@@ -722,90 +712,80 @@ Optimized plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h55-1-3" id="h55-1-3" class="i">+        labels: [
</a><a href="#h55-1-4" id="h55-1-4" class="i">+            None,
</a><a href="#h55-1-5" id="h55-1-5" class="i">+            None,
</a><a href="#h55-1-6" id="h55-1-6" class="i">+            None,
</a><a href="#h55-1-7" id="h55-1-7" class="i">+            None,
</a><a href="#h55-1-8" id="h55-1-8" class="i">+            None,
</a><a href="#h55-1-9" id="h55-1-9" class="i">+            None,
</a><a href="#h55-1-10" id="h55-1-10" class="i">+        ],
</a>         expressions: [
<a href="#h55-1-12" id="h55-1-12" class="d">-            (
</a><a href="#h55-1-13" id="h55-1-13" class="d">-                Field(
</a><a href="#h55-1-14" id="h55-1-14" class="d">-                    0,
</a><a href="#h55-1-15" id="h55-1-15" class="d">-                    Some(
</a><a href="#h55-1-16" id="h55-1-16" class="d">-                        (
</a><a href="#h55-1-17" id="h55-1-17" class="d">-                            Some(
</a><a href="#h55-1-18" id="h55-1-18" class="d">-                                &quot;m&quot;,
</a><a href="#h55-1-19" id="h55-1-19" class="d">-                            ),
</a><a href="#h55-1-20" id="h55-1-20" class="d">-                            &quot;id&quot;,
</a><a href="#h55-1-21" id="h55-1-21" class="i">+            Field(
</a><a href="#h55-1-22" id="h55-1-22" class="i">+                0,
</a><a href="#h55-1-23" id="h55-1-23" class="i">+                Some(
</a><a href="#h55-1-24" id="h55-1-24" class="i">+                    (
</a><a href="#h55-1-25" id="h55-1-25" class="i">+                        Some(
</a><a href="#h55-1-26" id="h55-1-26" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h55-1-28" id="h55-1-28" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h55-1-31" id="h55-1-31" class="d">-                None,
</a>             ),
<a href="#h55-1-33" id="h55-1-33" class="d">-            (
</a><a href="#h55-1-34" id="h55-1-34" class="d">-                Field(
</a><a href="#h55-1-35" id="h55-1-35" class="d">-                    1,
</a><a href="#h55-1-36" id="h55-1-36" class="d">-                    Some(
</a><a href="#h55-1-37" id="h55-1-37" class="d">-                        (
</a><a href="#h55-1-38" id="h55-1-38" class="d">-                            Some(
</a><a href="#h55-1-39" id="h55-1-39" class="d">-                                &quot;m&quot;,
</a><a href="#h55-1-40" id="h55-1-40" class="d">-                            ),
</a><a href="#h55-1-41" id="h55-1-41" class="d">-                            &quot;title&quot;,
</a><a href="#h55-1-42" id="h55-1-42" class="i">+            Field(
</a><a href="#h55-1-43" id="h55-1-43" class="i">+                1,
</a><a href="#h55-1-44" id="h55-1-44" class="i">+                Some(
</a><a href="#h55-1-45" id="h55-1-45" class="i">+                    (
</a><a href="#h55-1-46" id="h55-1-46" class="i">+                        Some(
</a><a href="#h55-1-47" id="h55-1-47" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h55-1-49" id="h55-1-49" class="i">+                        &quot;title&quot;,
</a>                     ),
                 ),
<a href="#h55-1-52" id="h55-1-52" class="d">-                None,
</a>             ),
<a href="#h55-1-54" id="h55-1-54" class="d">-            (
</a><a href="#h55-1-55" id="h55-1-55" class="d">-                Field(
</a><a href="#h55-1-56" id="h55-1-56" class="d">-                    7,
</a><a href="#h55-1-57" id="h55-1-57" class="d">-                    Some(
</a><a href="#h55-1-58" id="h55-1-58" class="d">-                        (
</a><a href="#h55-1-59" id="h55-1-59" class="d">-                            Some(
</a><a href="#h55-1-60" id="h55-1-60" class="d">-                                &quot;g&quot;,
</a><a href="#h55-1-61" id="h55-1-61" class="d">-                            ),
</a><a href="#h55-1-62" id="h55-1-62" class="d">-                            &quot;id&quot;,
</a><a href="#h55-1-63" id="h55-1-63" class="i">+            Field(
</a><a href="#h55-1-64" id="h55-1-64" class="i">+                7,
</a><a href="#h55-1-65" id="h55-1-65" class="i">+                Some(
</a><a href="#h55-1-66" id="h55-1-66" class="i">+                    (
</a><a href="#h55-1-67" id="h55-1-67" class="i">+                        Some(
</a><a href="#h55-1-68" id="h55-1-68" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h55-1-70" id="h55-1-70" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h55-1-73" id="h55-1-73" class="d">-                None,
</a>             ),
<a href="#h55-1-75" id="h55-1-75" class="d">-            (
</a><a href="#h55-1-76" id="h55-1-76" class="d">-                Field(
</a><a href="#h55-1-77" id="h55-1-77" class="d">-                    8,
</a><a href="#h55-1-78" id="h55-1-78" class="d">-                    Some(
</a><a href="#h55-1-79" id="h55-1-79" class="d">-                        (
</a><a href="#h55-1-80" id="h55-1-80" class="d">-                            Some(
</a><a href="#h55-1-81" id="h55-1-81" class="d">-                                &quot;g&quot;,
</a><a href="#h55-1-82" id="h55-1-82" class="d">-                            ),
</a><a href="#h55-1-83" id="h55-1-83" class="d">-                            &quot;name&quot;,
</a><a href="#h55-1-84" id="h55-1-84" class="i">+            Field(
</a><a href="#h55-1-85" id="h55-1-85" class="i">+                8,
</a><a href="#h55-1-86" id="h55-1-86" class="i">+                Some(
</a><a href="#h55-1-87" id="h55-1-87" class="i">+                    (
</a><a href="#h55-1-88" id="h55-1-88" class="i">+                        Some(
</a><a href="#h55-1-89" id="h55-1-89" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h55-1-91" id="h55-1-91" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h55-1-94" id="h55-1-94" class="d">-                None,
</a>             ),
<a href="#h55-1-96" id="h55-1-96" class="d">-            (
</a><a href="#h55-1-97" id="h55-1-97" class="d">-                Field(
</a><a href="#h55-1-98" id="h55-1-98" class="d">-                    9,
</a><a href="#h55-1-99" id="h55-1-99" class="d">-                    Some(
</a><a href="#h55-1-100" id="h55-1-100" class="d">-                        (
</a><a href="#h55-1-101" id="h55-1-101" class="d">-                            Some(
</a><a href="#h55-1-102" id="h55-1-102" class="d">-                                &quot;c&quot;,
</a><a href="#h55-1-103" id="h55-1-103" class="d">-                            ),
</a><a href="#h55-1-104" id="h55-1-104" class="d">-                            &quot;id&quot;,
</a><a href="#h55-1-105" id="h55-1-105" class="i">+            Field(
</a><a href="#h55-1-106" id="h55-1-106" class="i">+                9,
</a><a href="#h55-1-107" id="h55-1-107" class="i">+                Some(
</a><a href="#h55-1-108" id="h55-1-108" class="i">+                    (
</a><a href="#h55-1-109" id="h55-1-109" class="i">+                        Some(
</a><a href="#h55-1-110" id="h55-1-110" class="i">+                            &quot;c&quot;,
</a>                         ),
<a href="#h55-1-112" id="h55-1-112" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h55-1-115" id="h55-1-115" class="d">-                None,
</a>             ),
<a href="#h55-1-117" id="h55-1-117" class="d">-            (
</a><a href="#h55-1-118" id="h55-1-118" class="d">-                Field(
</a><a href="#h55-1-119" id="h55-1-119" class="d">-                    10,
</a><a href="#h55-1-120" id="h55-1-120" class="d">-                    Some(
</a><a href="#h55-1-121" id="h55-1-121" class="d">-                        (
</a><a href="#h55-1-122" id="h55-1-122" class="d">-                            Some(
</a><a href="#h55-1-123" id="h55-1-123" class="d">-                                &quot;c&quot;,
</a><a href="#h55-1-124" id="h55-1-124" class="d">-                            ),
</a><a href="#h55-1-125" id="h55-1-125" class="d">-                            &quot;name&quot;,
</a><a href="#h55-1-126" id="h55-1-126" class="i">+            Field(
</a><a href="#h55-1-127" id="h55-1-127" class="i">+                10,
</a><a href="#h55-1-128" id="h55-1-128" class="i">+                Some(
</a><a href="#h55-1-129" id="h55-1-129" class="i">+                    (
</a><a href="#h55-1-130" id="h55-1-130" class="i">+                        Some(
</a><a href="#h55-1-131" id="h55-1-131" class="i">+                            &quot;c&quot;,
</a>                         ),
<a href="#h55-1-133" id="h55-1-133" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h55-1-136" id="h55-1-136" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h56" href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a> b/<a href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -334,52 +334,54 @@ Plan: Select(
</a>             ),
             outer: false,
         },
<a href="#h56-0-3" id="h56-0-3" class="i">+        labels: [
</a><a href="#h56-0-4" id="h56-0-4" class="i">+            None,
</a><a href="#h56-0-5" id="h56-0-5" class="i">+            Some(
</a><a href="#h56-0-6" id="h56-0-6" class="i">+                (
</a><a href="#h56-0-7" id="h56-0-7" class="i">+                    None,
</a><a href="#h56-0-8" id="h56-0-8" class="i">+                    &quot;genre&quot;,
</a><a href="#h56-0-9" id="h56-0-9" class="i">+                ),
</a><a href="#h56-0-10" id="h56-0-10" class="i">+            ),
</a><a href="#h56-0-11" id="h56-0-11" class="i">+            Some(
</a><a href="#h56-0-12" id="h56-0-12" class="i">+                (
</a><a href="#h56-0-13" id="h56-0-13" class="i">+                    None,
</a><a href="#h56-0-14" id="h56-0-14" class="i">+                    &quot;studio&quot;,
</a><a href="#h56-0-15" id="h56-0-15" class="i">+                ),
</a><a href="#h56-0-16" id="h56-0-16" class="i">+            ),
</a><a href="#h56-0-17" id="h56-0-17" class="i">+        ],
</a>         expressions: [
<a href="#h56-0-19" id="h56-0-19" class="d">-            (
</a><a href="#h56-0-20" id="h56-0-20" class="d">-                Field(
</a><a href="#h56-0-21" id="h56-0-21" class="d">-                    1,
</a><a href="#h56-0-22" id="h56-0-22" class="d">-                    Some(
</a><a href="#h56-0-23" id="h56-0-23" class="d">-                        (
</a><a href="#h56-0-24" id="h56-0-24" class="d">-                            Some(
</a><a href="#h56-0-25" id="h56-0-25" class="d">-                                &quot;movies&quot;,
</a><a href="#h56-0-26" id="h56-0-26" class="d">-                            ),
</a><a href="#h56-0-27" id="h56-0-27" class="d">-                            &quot;title&quot;,
</a><a href="#h56-0-28" id="h56-0-28" class="i">+            Field(
</a><a href="#h56-0-29" id="h56-0-29" class="i">+                1,
</a><a href="#h56-0-30" id="h56-0-30" class="i">+                Some(
</a><a href="#h56-0-31" id="h56-0-31" class="i">+                    (
</a><a href="#h56-0-32" id="h56-0-32" class="i">+                        Some(
</a><a href="#h56-0-33" id="h56-0-33" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h56-0-35" id="h56-0-35" class="i">+                        &quot;title&quot;,
</a>                     ),
                 ),
<a href="#h56-0-38" id="h56-0-38" class="d">-                None,
</a>             ),
<a href="#h56-0-40" id="h56-0-40" class="d">-            (
</a><a href="#h56-0-41" id="h56-0-41" class="d">-                Field(
</a><a href="#h56-0-42" id="h56-0-42" class="d">-                    8,
</a><a href="#h56-0-43" id="h56-0-43" class="d">-                    Some(
</a><a href="#h56-0-44" id="h56-0-44" class="d">-                        (
</a><a href="#h56-0-45" id="h56-0-45" class="d">-                            Some(
</a><a href="#h56-0-46" id="h56-0-46" class="d">-                                &quot;genres&quot;,
</a><a href="#h56-0-47" id="h56-0-47" class="d">-                            ),
</a><a href="#h56-0-48" id="h56-0-48" class="d">-                            &quot;name&quot;,
</a><a href="#h56-0-49" id="h56-0-49" class="i">+            Field(
</a><a href="#h56-0-50" id="h56-0-50" class="i">+                8,
</a><a href="#h56-0-51" id="h56-0-51" class="i">+                Some(
</a><a href="#h56-0-52" id="h56-0-52" class="i">+                    (
</a><a href="#h56-0-53" id="h56-0-53" class="i">+                        Some(
</a><a href="#h56-0-54" id="h56-0-54" class="i">+                            &quot;genres&quot;,
</a>                         ),
<a href="#h56-0-56" id="h56-0-56" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h56-0-59" id="h56-0-59" class="d">-                Some(
</a><a href="#h56-0-60" id="h56-0-60" class="d">-                    &quot;genre&quot;,
</a><a href="#h56-0-61" id="h56-0-61" class="d">-                ),
</a>             ),
<a href="#h56-0-63" id="h56-0-63" class="d">-            (
</a><a href="#h56-0-64" id="h56-0-64" class="d">-                Field(
</a><a href="#h56-0-65" id="h56-0-65" class="d">-                    10,
</a><a href="#h56-0-66" id="h56-0-66" class="d">-                    Some(
</a><a href="#h56-0-67" id="h56-0-67" class="d">-                        (
</a><a href="#h56-0-68" id="h56-0-68" class="d">-                            Some(
</a><a href="#h56-0-69" id="h56-0-69" class="d">-                                &quot;studios&quot;,
</a><a href="#h56-0-70" id="h56-0-70" class="d">-                            ),
</a><a href="#h56-0-71" id="h56-0-71" class="d">-                            &quot;name&quot;,
</a><a href="#h56-0-72" id="h56-0-72" class="i">+            Field(
</a><a href="#h56-0-73" id="h56-0-73" class="i">+                10,
</a><a href="#h56-0-74" id="h56-0-74" class="i">+                Some(
</a><a href="#h56-0-75" id="h56-0-75" class="i">+                    (
</a><a href="#h56-0-76" id="h56-0-76" class="i">+                        Some(
</a><a href="#h56-0-77" id="h56-0-77" class="i">+                            &quot;studios&quot;,
</a>                         ),
<a href="#h56-0-79" id="h56-0-79" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h56-0-82" id="h56-0-82" class="d">-                Some(
</a><a href="#h56-0-83" id="h56-0-83" class="d">-                    &quot;studio&quot;,
</a><a href="#h56-0-84" id="h56-0-84" class="d">-                ),
</a>             ),
         ],
     },
<a href="#h56-1" id="h56-1" class="h">@@ -587,52 +589,54 @@ Optimized plan: Select(
</a>             ),
             outer: false,
         },
<a href="#h56-1-3" id="h56-1-3" class="i">+        labels: [
</a><a href="#h56-1-4" id="h56-1-4" class="i">+            None,
</a><a href="#h56-1-5" id="h56-1-5" class="i">+            Some(
</a><a href="#h56-1-6" id="h56-1-6" class="i">+                (
</a><a href="#h56-1-7" id="h56-1-7" class="i">+                    None,
</a><a href="#h56-1-8" id="h56-1-8" class="i">+                    &quot;genre&quot;,
</a><a href="#h56-1-9" id="h56-1-9" class="i">+                ),
</a><a href="#h56-1-10" id="h56-1-10" class="i">+            ),
</a><a href="#h56-1-11" id="h56-1-11" class="i">+            Some(
</a><a href="#h56-1-12" id="h56-1-12" class="i">+                (
</a><a href="#h56-1-13" id="h56-1-13" class="i">+                    None,
</a><a href="#h56-1-14" id="h56-1-14" class="i">+                    &quot;studio&quot;,
</a><a href="#h56-1-15" id="h56-1-15" class="i">+                ),
</a><a href="#h56-1-16" id="h56-1-16" class="i">+            ),
</a><a href="#h56-1-17" id="h56-1-17" class="i">+        ],
</a>         expressions: [
<a href="#h56-1-19" id="h56-1-19" class="d">-            (
</a><a href="#h56-1-20" id="h56-1-20" class="d">-                Field(
</a><a href="#h56-1-21" id="h56-1-21" class="d">-                    1,
</a><a href="#h56-1-22" id="h56-1-22" class="d">-                    Some(
</a><a href="#h56-1-23" id="h56-1-23" class="d">-                        (
</a><a href="#h56-1-24" id="h56-1-24" class="d">-                            Some(
</a><a href="#h56-1-25" id="h56-1-25" class="d">-                                &quot;movies&quot;,
</a><a href="#h56-1-26" id="h56-1-26" class="d">-                            ),
</a><a href="#h56-1-27" id="h56-1-27" class="d">-                            &quot;title&quot;,
</a><a href="#h56-1-28" id="h56-1-28" class="i">+            Field(
</a><a href="#h56-1-29" id="h56-1-29" class="i">+                1,
</a><a href="#h56-1-30" id="h56-1-30" class="i">+                Some(
</a><a href="#h56-1-31" id="h56-1-31" class="i">+                    (
</a><a href="#h56-1-32" id="h56-1-32" class="i">+                        Some(
</a><a href="#h56-1-33" id="h56-1-33" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h56-1-35" id="h56-1-35" class="i">+                        &quot;title&quot;,
</a>                     ),
                 ),
<a href="#h56-1-38" id="h56-1-38" class="d">-                None,
</a>             ),
<a href="#h56-1-40" id="h56-1-40" class="d">-            (
</a><a href="#h56-1-41" id="h56-1-41" class="d">-                Field(
</a><a href="#h56-1-42" id="h56-1-42" class="d">-                    8,
</a><a href="#h56-1-43" id="h56-1-43" class="d">-                    Some(
</a><a href="#h56-1-44" id="h56-1-44" class="d">-                        (
</a><a href="#h56-1-45" id="h56-1-45" class="d">-                            Some(
</a><a href="#h56-1-46" id="h56-1-46" class="d">-                                &quot;genres&quot;,
</a><a href="#h56-1-47" id="h56-1-47" class="d">-                            ),
</a><a href="#h56-1-48" id="h56-1-48" class="d">-                            &quot;name&quot;,
</a><a href="#h56-1-49" id="h56-1-49" class="i">+            Field(
</a><a href="#h56-1-50" id="h56-1-50" class="i">+                8,
</a><a href="#h56-1-51" id="h56-1-51" class="i">+                Some(
</a><a href="#h56-1-52" id="h56-1-52" class="i">+                    (
</a><a href="#h56-1-53" id="h56-1-53" class="i">+                        Some(
</a><a href="#h56-1-54" id="h56-1-54" class="i">+                            &quot;genres&quot;,
</a>                         ),
<a href="#h56-1-56" id="h56-1-56" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h56-1-59" id="h56-1-59" class="d">-                Some(
</a><a href="#h56-1-60" id="h56-1-60" class="d">-                    &quot;genre&quot;,
</a><a href="#h56-1-61" id="h56-1-61" class="d">-                ),
</a>             ),
<a href="#h56-1-63" id="h56-1-63" class="d">-            (
</a><a href="#h56-1-64" id="h56-1-64" class="d">-                Field(
</a><a href="#h56-1-65" id="h56-1-65" class="d">-                    10,
</a><a href="#h56-1-66" id="h56-1-66" class="d">-                    Some(
</a><a href="#h56-1-67" id="h56-1-67" class="d">-                        (
</a><a href="#h56-1-68" id="h56-1-68" class="d">-                            Some(
</a><a href="#h56-1-69" id="h56-1-69" class="d">-                                &quot;studios&quot;,
</a><a href="#h56-1-70" id="h56-1-70" class="d">-                            ),
</a><a href="#h56-1-71" id="h56-1-71" class="d">-                            &quot;name&quot;,
</a><a href="#h56-1-72" id="h56-1-72" class="i">+            Field(
</a><a href="#h56-1-73" id="h56-1-73" class="i">+                10,
</a><a href="#h56-1-74" id="h56-1-74" class="i">+                Some(
</a><a href="#h56-1-75" id="h56-1-75" class="i">+                    (
</a><a href="#h56-1-76" id="h56-1-76" class="i">+                        Some(
</a><a href="#h56-1-77" id="h56-1-77" class="i">+                            &quot;studios&quot;,
</a>                         ),
<a href="#h56-1-79" id="h56-1-79" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h56-1-82" id="h56-1-82" class="d">-                Some(
</a><a href="#h56-1-83" id="h56-1-83" class="d">-                    &quot;studio&quot;,
</a><a href="#h56-1-84" id="h56-1-84" class="d">-                ),
</a>             ),
         ],
     },
<b>diff --git a/<a id="h57" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -431,52 +431,54 @@ Plan: Select(
</a>                 ),
                 outer: false,
             },
<a href="#h57-0-3" id="h57-0-3" class="i">+            labels: [
</a><a href="#h57-0-4" id="h57-0-4" class="i">+                None,
</a><a href="#h57-0-5" id="h57-0-5" class="i">+                Some(
</a><a href="#h57-0-6" id="h57-0-6" class="i">+                    (
</a><a href="#h57-0-7" id="h57-0-7" class="i">+                        None,
</a><a href="#h57-0-8" id="h57-0-8" class="i">+                        &quot;genre&quot;,
</a><a href="#h57-0-9" id="h57-0-9" class="i">+                    ),
</a><a href="#h57-0-10" id="h57-0-10" class="i">+                ),
</a><a href="#h57-0-11" id="h57-0-11" class="i">+                Some(
</a><a href="#h57-0-12" id="h57-0-12" class="i">+                    (
</a><a href="#h57-0-13" id="h57-0-13" class="i">+                        None,
</a><a href="#h57-0-14" id="h57-0-14" class="i">+                        &quot;studio&quot;,
</a><a href="#h57-0-15" id="h57-0-15" class="i">+                    ),
</a><a href="#h57-0-16" id="h57-0-16" class="i">+                ),
</a><a href="#h57-0-17" id="h57-0-17" class="i">+            ],
</a>             expressions: [
<a href="#h57-0-19" id="h57-0-19" class="d">-                (
</a><a href="#h57-0-20" id="h57-0-20" class="d">-                    Field(
</a><a href="#h57-0-21" id="h57-0-21" class="d">-                        1,
</a><a href="#h57-0-22" id="h57-0-22" class="d">-                        Some(
</a><a href="#h57-0-23" id="h57-0-23" class="d">-                            (
</a><a href="#h57-0-24" id="h57-0-24" class="d">-                                Some(
</a><a href="#h57-0-25" id="h57-0-25" class="d">-                                    &quot;m&quot;,
</a><a href="#h57-0-26" id="h57-0-26" class="d">-                                ),
</a><a href="#h57-0-27" id="h57-0-27" class="d">-                                &quot;title&quot;,
</a><a href="#h57-0-28" id="h57-0-28" class="i">+                Field(
</a><a href="#h57-0-29" id="h57-0-29" class="i">+                    1,
</a><a href="#h57-0-30" id="h57-0-30" class="i">+                    Some(
</a><a href="#h57-0-31" id="h57-0-31" class="i">+                        (
</a><a href="#h57-0-32" id="h57-0-32" class="i">+                            Some(
</a><a href="#h57-0-33" id="h57-0-33" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h57-0-35" id="h57-0-35" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h57-0-38" id="h57-0-38" class="d">-                    None,
</a>                 ),
<a href="#h57-0-40" id="h57-0-40" class="d">-                (
</a><a href="#h57-0-41" id="h57-0-41" class="d">-                    Field(
</a><a href="#h57-0-42" id="h57-0-42" class="d">-                        8,
</a><a href="#h57-0-43" id="h57-0-43" class="d">-                        Some(
</a><a href="#h57-0-44" id="h57-0-44" class="d">-                            (
</a><a href="#h57-0-45" id="h57-0-45" class="d">-                                Some(
</a><a href="#h57-0-46" id="h57-0-46" class="d">-                                    &quot;g&quot;,
</a><a href="#h57-0-47" id="h57-0-47" class="d">-                                ),
</a><a href="#h57-0-48" id="h57-0-48" class="d">-                                &quot;name&quot;,
</a><a href="#h57-0-49" id="h57-0-49" class="i">+                Field(
</a><a href="#h57-0-50" id="h57-0-50" class="i">+                    8,
</a><a href="#h57-0-51" id="h57-0-51" class="i">+                    Some(
</a><a href="#h57-0-52" id="h57-0-52" class="i">+                        (
</a><a href="#h57-0-53" id="h57-0-53" class="i">+                            Some(
</a><a href="#h57-0-54" id="h57-0-54" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h57-0-56" id="h57-0-56" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h57-0-59" id="h57-0-59" class="d">-                    Some(
</a><a href="#h57-0-60" id="h57-0-60" class="d">-                        &quot;genre&quot;,
</a><a href="#h57-0-61" id="h57-0-61" class="d">-                    ),
</a>                 ),
<a href="#h57-0-63" id="h57-0-63" class="d">-                (
</a><a href="#h57-0-64" id="h57-0-64" class="d">-                    Field(
</a><a href="#h57-0-65" id="h57-0-65" class="d">-                        10,
</a><a href="#h57-0-66" id="h57-0-66" class="d">-                        Some(
</a><a href="#h57-0-67" id="h57-0-67" class="d">-                            (
</a><a href="#h57-0-68" id="h57-0-68" class="d">-                                Some(
</a><a href="#h57-0-69" id="h57-0-69" class="d">-                                    &quot;s&quot;,
</a><a href="#h57-0-70" id="h57-0-70" class="d">-                                ),
</a><a href="#h57-0-71" id="h57-0-71" class="d">-                                &quot;name&quot;,
</a><a href="#h57-0-72" id="h57-0-72" class="i">+                Field(
</a><a href="#h57-0-73" id="h57-0-73" class="i">+                    10,
</a><a href="#h57-0-74" id="h57-0-74" class="i">+                    Some(
</a><a href="#h57-0-75" id="h57-0-75" class="i">+                        (
</a><a href="#h57-0-76" id="h57-0-76" class="i">+                            Some(
</a><a href="#h57-0-77" id="h57-0-77" class="i">+                                &quot;s&quot;,
</a>                             ),
<a href="#h57-0-79" id="h57-0-79" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h57-0-82" id="h57-0-82" class="d">-                    Some(
</a><a href="#h57-0-83" id="h57-0-83" class="d">-                        &quot;studio&quot;,
</a><a href="#h57-0-84" id="h57-0-84" class="d">-                    ),
</a>                 ),
             ],
         },
<a href="#h57-1" id="h57-1" class="h">@@ -741,52 +743,54 @@ Optimized plan: Select(
</a>                 ),
                 outer: false,
             },
<a href="#h57-1-3" id="h57-1-3" class="i">+            labels: [
</a><a href="#h57-1-4" id="h57-1-4" class="i">+                None,
</a><a href="#h57-1-5" id="h57-1-5" class="i">+                Some(
</a><a href="#h57-1-6" id="h57-1-6" class="i">+                    (
</a><a href="#h57-1-7" id="h57-1-7" class="i">+                        None,
</a><a href="#h57-1-8" id="h57-1-8" class="i">+                        &quot;genre&quot;,
</a><a href="#h57-1-9" id="h57-1-9" class="i">+                    ),
</a><a href="#h57-1-10" id="h57-1-10" class="i">+                ),
</a><a href="#h57-1-11" id="h57-1-11" class="i">+                Some(
</a><a href="#h57-1-12" id="h57-1-12" class="i">+                    (
</a><a href="#h57-1-13" id="h57-1-13" class="i">+                        None,
</a><a href="#h57-1-14" id="h57-1-14" class="i">+                        &quot;studio&quot;,
</a><a href="#h57-1-15" id="h57-1-15" class="i">+                    ),
</a><a href="#h57-1-16" id="h57-1-16" class="i">+                ),
</a><a href="#h57-1-17" id="h57-1-17" class="i">+            ],
</a>             expressions: [
<a href="#h57-1-19" id="h57-1-19" class="d">-                (
</a><a href="#h57-1-20" id="h57-1-20" class="d">-                    Field(
</a><a href="#h57-1-21" id="h57-1-21" class="d">-                        1,
</a><a href="#h57-1-22" id="h57-1-22" class="d">-                        Some(
</a><a href="#h57-1-23" id="h57-1-23" class="d">-                            (
</a><a href="#h57-1-24" id="h57-1-24" class="d">-                                Some(
</a><a href="#h57-1-25" id="h57-1-25" class="d">-                                    &quot;m&quot;,
</a><a href="#h57-1-26" id="h57-1-26" class="d">-                                ),
</a><a href="#h57-1-27" id="h57-1-27" class="d">-                                &quot;title&quot;,
</a><a href="#h57-1-28" id="h57-1-28" class="i">+                Field(
</a><a href="#h57-1-29" id="h57-1-29" class="i">+                    1,
</a><a href="#h57-1-30" id="h57-1-30" class="i">+                    Some(
</a><a href="#h57-1-31" id="h57-1-31" class="i">+                        (
</a><a href="#h57-1-32" id="h57-1-32" class="i">+                            Some(
</a><a href="#h57-1-33" id="h57-1-33" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h57-1-35" id="h57-1-35" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h57-1-38" id="h57-1-38" class="d">-                    None,
</a>                 ),
<a href="#h57-1-40" id="h57-1-40" class="d">-                (
</a><a href="#h57-1-41" id="h57-1-41" class="d">-                    Field(
</a><a href="#h57-1-42" id="h57-1-42" class="d">-                        8,
</a><a href="#h57-1-43" id="h57-1-43" class="d">-                        Some(
</a><a href="#h57-1-44" id="h57-1-44" class="d">-                            (
</a><a href="#h57-1-45" id="h57-1-45" class="d">-                                Some(
</a><a href="#h57-1-46" id="h57-1-46" class="d">-                                    &quot;g&quot;,
</a><a href="#h57-1-47" id="h57-1-47" class="d">-                                ),
</a><a href="#h57-1-48" id="h57-1-48" class="d">-                                &quot;name&quot;,
</a><a href="#h57-1-49" id="h57-1-49" class="i">+                Field(
</a><a href="#h57-1-50" id="h57-1-50" class="i">+                    8,
</a><a href="#h57-1-51" id="h57-1-51" class="i">+                    Some(
</a><a href="#h57-1-52" id="h57-1-52" class="i">+                        (
</a><a href="#h57-1-53" id="h57-1-53" class="i">+                            Some(
</a><a href="#h57-1-54" id="h57-1-54" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h57-1-56" id="h57-1-56" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h57-1-59" id="h57-1-59" class="d">-                    Some(
</a><a href="#h57-1-60" id="h57-1-60" class="d">-                        &quot;genre&quot;,
</a><a href="#h57-1-61" id="h57-1-61" class="d">-                    ),
</a>                 ),
<a href="#h57-1-63" id="h57-1-63" class="d">-                (
</a><a href="#h57-1-64" id="h57-1-64" class="d">-                    Field(
</a><a href="#h57-1-65" id="h57-1-65" class="d">-                        10,
</a><a href="#h57-1-66" id="h57-1-66" class="d">-                        Some(
</a><a href="#h57-1-67" id="h57-1-67" class="d">-                            (
</a><a href="#h57-1-68" id="h57-1-68" class="d">-                                Some(
</a><a href="#h57-1-69" id="h57-1-69" class="d">-                                    &quot;s&quot;,
</a><a href="#h57-1-70" id="h57-1-70" class="d">-                                ),
</a><a href="#h57-1-71" id="h57-1-71" class="d">-                                &quot;name&quot;,
</a><a href="#h57-1-72" id="h57-1-72" class="i">+                Field(
</a><a href="#h57-1-73" id="h57-1-73" class="i">+                    10,
</a><a href="#h57-1-74" id="h57-1-74" class="i">+                    Some(
</a><a href="#h57-1-75" id="h57-1-75" class="i">+                        (
</a><a href="#h57-1-76" id="h57-1-76" class="i">+                            Some(
</a><a href="#h57-1-77" id="h57-1-77" class="i">+                                &quot;s&quot;,
</a>                             ),
<a href="#h57-1-79" id="h57-1-79" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h57-1-82" id="h57-1-82" class="d">-                    Some(
</a><a href="#h57-1-83" id="h57-1-83" class="d">-                        &quot;studio&quot;,
</a><a href="#h57-1-84" id="h57-1-84" class="d">-                    ),
</a>                 ),
             ],
         },
<b>diff --git a/<a id="h58" href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a> b/<a href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -20,12 +20,19 @@ Projection: #0, #1, #2, #3, #4
</a> 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;genre&quot;, &quot;studio&quot;, &quot;rating&quot;]
 [Integer(10), String(&quot;Inception&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;), Float(8.8)]
<a href="#h58-0-3" id="h58-0-3" class="i">+[Integer(10), String(&quot;Inception&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;), Float(8.8)]
</a><a href="#h58-0-4" id="h58-0-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), String(&quot;Science Fiction&quot;), String(&quot;Mosfilm&quot;), Float(8.2)]
</a> [Integer(1), String(&quot;Stalker&quot;), String(&quot;Science Fiction&quot;), String(&quot;Mosfilm&quot;), Float(8.2)]
 [Integer(4), String(&quot;Heat&quot;), String(&quot;Action&quot;), String(&quot;Warner Bros&quot;), Float(8.2)]
<a href="#h58-0-7" id="h58-0-7" class="i">+[Integer(4), String(&quot;Heat&quot;), String(&quot;Action&quot;), String(&quot;Warner Bros&quot;), Float(8.2)]
</a><a href="#h58-0-8" id="h58-0-8" class="i">+[Integer(6), String(&quot;Solaris&quot;), String(&quot;Science Fiction&quot;), String(&quot;Mosfilm&quot;), Float(8.1)]
</a> [Integer(6), String(&quot;Solaris&quot;), String(&quot;Science Fiction&quot;), String(&quot;Mosfilm&quot;), Float(8.1)]
 [Integer(7), String(&quot;Gravity&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;), Float(7.7)]
<a href="#h58-0-11" id="h58-0-11" class="i">+[Integer(7), String(&quot;Gravity&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;), Float(7.7)]
</a><a href="#h58-0-12" id="h58-0-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), String(&quot;Comedy&quot;), String(&quot;Warner Bros&quot;), Float(7.7)]
</a> [Integer(9), String(&quot;Birdman&quot;), String(&quot;Comedy&quot;), String(&quot;Warner Bros&quot;), Float(7.7)]
 [Integer(5), String(&quot;The Fountain&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;), Float(7.2)]
<a href="#h58-0-15" id="h58-0-15" class="i">+[Integer(5), String(&quot;The Fountain&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;), Float(7.2)]
</a> 
 AST: Select {
     select: [
<a href="#h58-1" id="h58-1" class="h">@@ -593,94 +600,90 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h58-1-3" id="h58-1-3" class="i">+                labels: [
</a><a href="#h58-1-4" id="h58-1-4" class="i">+                    None,
</a><a href="#h58-1-5" id="h58-1-5" class="i">+                    None,
</a><a href="#h58-1-6" id="h58-1-6" class="i">+                    Some(
</a><a href="#h58-1-7" id="h58-1-7" class="i">+                        (
</a><a href="#h58-1-8" id="h58-1-8" class="i">+                            None,
</a><a href="#h58-1-9" id="h58-1-9" class="i">+                            &quot;genre&quot;,
</a><a href="#h58-1-10" id="h58-1-10" class="i">+                        ),
</a><a href="#h58-1-11" id="h58-1-11" class="i">+                    ),
</a><a href="#h58-1-12" id="h58-1-12" class="i">+                    Some(
</a><a href="#h58-1-13" id="h58-1-13" class="i">+                        (
</a><a href="#h58-1-14" id="h58-1-14" class="i">+                            None,
</a><a href="#h58-1-15" id="h58-1-15" class="i">+                            &quot;studio&quot;,
</a><a href="#h58-1-16" id="h58-1-16" class="i">+                        ),
</a><a href="#h58-1-17" id="h58-1-17" class="i">+                    ),
</a><a href="#h58-1-18" id="h58-1-18" class="i">+                    None,
</a><a href="#h58-1-19" id="h58-1-19" class="i">+                    None,
</a><a href="#h58-1-20" id="h58-1-20" class="i">+                ],
</a>                 expressions: [
<a href="#h58-1-22" id="h58-1-22" class="d">-                    (
</a><a href="#h58-1-23" id="h58-1-23" class="d">-                        Field(
</a><a href="#h58-1-24" id="h58-1-24" class="d">-                            0,
</a><a href="#h58-1-25" id="h58-1-25" class="d">-                            Some(
</a><a href="#h58-1-26" id="h58-1-26" class="d">-                                (
</a><a href="#h58-1-27" id="h58-1-27" class="d">-                                    Some(
</a><a href="#h58-1-28" id="h58-1-28" class="d">-                                        &quot;m&quot;,
</a><a href="#h58-1-29" id="h58-1-29" class="d">-                                    ),
</a><a href="#h58-1-30" id="h58-1-30" class="d">-                                    &quot;id&quot;,
</a><a href="#h58-1-31" id="h58-1-31" class="i">+                    Field(
</a><a href="#h58-1-32" id="h58-1-32" class="i">+                        0,
</a><a href="#h58-1-33" id="h58-1-33" class="i">+                        Some(
</a><a href="#h58-1-34" id="h58-1-34" class="i">+                            (
</a><a href="#h58-1-35" id="h58-1-35" class="i">+                                Some(
</a><a href="#h58-1-36" id="h58-1-36" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h58-1-38" id="h58-1-38" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h58-1-41" id="h58-1-41" class="d">-                        None,
</a>                     ),
<a href="#h58-1-43" id="h58-1-43" class="d">-                    (
</a><a href="#h58-1-44" id="h58-1-44" class="d">-                        Field(
</a><a href="#h58-1-45" id="h58-1-45" class="d">-                            1,
</a><a href="#h58-1-46" id="h58-1-46" class="d">-                            Some(
</a><a href="#h58-1-47" id="h58-1-47" class="d">-                                (
</a><a href="#h58-1-48" id="h58-1-48" class="d">-                                    Some(
</a><a href="#h58-1-49" id="h58-1-49" class="d">-                                        &quot;m&quot;,
</a><a href="#h58-1-50" id="h58-1-50" class="d">-                                    ),
</a><a href="#h58-1-51" id="h58-1-51" class="d">-                                    &quot;title&quot;,
</a><a href="#h58-1-52" id="h58-1-52" class="i">+                    Field(
</a><a href="#h58-1-53" id="h58-1-53" class="i">+                        1,
</a><a href="#h58-1-54" id="h58-1-54" class="i">+                        Some(
</a><a href="#h58-1-55" id="h58-1-55" class="i">+                            (
</a><a href="#h58-1-56" id="h58-1-56" class="i">+                                Some(
</a><a href="#h58-1-57" id="h58-1-57" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h58-1-59" id="h58-1-59" class="i">+                                &quot;title&quot;,
</a>                             ),
                         ),
<a href="#h58-1-62" id="h58-1-62" class="d">-                        None,
</a>                     ),
<a href="#h58-1-64" id="h58-1-64" class="d">-                    (
</a><a href="#h58-1-65" id="h58-1-65" class="d">-                        Field(
</a><a href="#h58-1-66" id="h58-1-66" class="d">-                            8,
</a><a href="#h58-1-67" id="h58-1-67" class="d">-                            Some(
</a><a href="#h58-1-68" id="h58-1-68" class="d">-                                (
</a><a href="#h58-1-69" id="h58-1-69" class="d">-                                    Some(
</a><a href="#h58-1-70" id="h58-1-70" class="d">-                                        &quot;g&quot;,
</a><a href="#h58-1-71" id="h58-1-71" class="d">-                                    ),
</a><a href="#h58-1-72" id="h58-1-72" class="d">-                                    &quot;name&quot;,
</a><a href="#h58-1-73" id="h58-1-73" class="i">+                    Field(
</a><a href="#h58-1-74" id="h58-1-74" class="i">+                        8,
</a><a href="#h58-1-75" id="h58-1-75" class="i">+                        Some(
</a><a href="#h58-1-76" id="h58-1-76" class="i">+                            (
</a><a href="#h58-1-77" id="h58-1-77" class="i">+                                Some(
</a><a href="#h58-1-78" id="h58-1-78" class="i">+                                    &quot;g&quot;,
</a>                                 ),
<a href="#h58-1-80" id="h58-1-80" class="i">+                                &quot;name&quot;,
</a>                             ),
                         ),
<a href="#h58-1-83" id="h58-1-83" class="d">-                        Some(
</a><a href="#h58-1-84" id="h58-1-84" class="d">-                            &quot;genre&quot;,
</a><a href="#h58-1-85" id="h58-1-85" class="d">-                        ),
</a>                     ),
<a href="#h58-1-87" id="h58-1-87" class="d">-                    (
</a><a href="#h58-1-88" id="h58-1-88" class="d">-                        Field(
</a><a href="#h58-1-89" id="h58-1-89" class="d">-                            10,
</a><a href="#h58-1-90" id="h58-1-90" class="d">-                            Some(
</a><a href="#h58-1-91" id="h58-1-91" class="d">-                                (
</a><a href="#h58-1-92" id="h58-1-92" class="d">-                                    Some(
</a><a href="#h58-1-93" id="h58-1-93" class="d">-                                        &quot;s&quot;,
</a><a href="#h58-1-94" id="h58-1-94" class="d">-                                    ),
</a><a href="#h58-1-95" id="h58-1-95" class="d">-                                    &quot;name&quot;,
</a><a href="#h58-1-96" id="h58-1-96" class="i">+                    Field(
</a><a href="#h58-1-97" id="h58-1-97" class="i">+                        10,
</a><a href="#h58-1-98" id="h58-1-98" class="i">+                        Some(
</a><a href="#h58-1-99" id="h58-1-99" class="i">+                            (
</a><a href="#h58-1-100" id="h58-1-100" class="i">+                                Some(
</a><a href="#h58-1-101" id="h58-1-101" class="i">+                                    &quot;s&quot;,
</a>                                 ),
<a href="#h58-1-103" id="h58-1-103" class="i">+                                &quot;name&quot;,
</a>                             ),
                         ),
<a href="#h58-1-106" id="h58-1-106" class="d">-                        Some(
</a><a href="#h58-1-107" id="h58-1-107" class="d">-                            &quot;studio&quot;,
</a><a href="#h58-1-108" id="h58-1-108" class="d">-                        ),
</a>                     ),
<a href="#h58-1-110" id="h58-1-110" class="d">-                    (
</a><a href="#h58-1-111" id="h58-1-111" class="d">-                        Field(
</a><a href="#h58-1-112" id="h58-1-112" class="d">-                            5,
</a><a href="#h58-1-113" id="h58-1-113" class="d">-                            Some(
</a><a href="#h58-1-114" id="h58-1-114" class="d">-                                (
</a><a href="#h58-1-115" id="h58-1-115" class="d">-                                    Some(
</a><a href="#h58-1-116" id="h58-1-116" class="d">-                                        &quot;m&quot;,
</a><a href="#h58-1-117" id="h58-1-117" class="d">-                                    ),
</a><a href="#h58-1-118" id="h58-1-118" class="d">-                                    &quot;rating&quot;,
</a><a href="#h58-1-119" id="h58-1-119" class="i">+                    Field(
</a><a href="#h58-1-120" id="h58-1-120" class="i">+                        5,
</a><a href="#h58-1-121" id="h58-1-121" class="i">+                        Some(
</a><a href="#h58-1-122" id="h58-1-122" class="i">+                            (
</a><a href="#h58-1-123" id="h58-1-123" class="i">+                                Some(
</a><a href="#h58-1-124" id="h58-1-124" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h58-1-126" id="h58-1-126" class="i">+                                &quot;rating&quot;,
</a>                             ),
                         ),
<a href="#h58-1-129" id="h58-1-129" class="d">-                        None,
</a>                     ),
<a href="#h58-1-131" id="h58-1-131" class="d">-                    (
</a><a href="#h58-1-132" id="h58-1-132" class="d">-                        Field(
</a><a href="#h58-1-133" id="h58-1-133" class="d">-                            4,
</a><a href="#h58-1-134" id="h58-1-134" class="d">-                            Some(
</a><a href="#h58-1-135" id="h58-1-135" class="d">-                                (
</a><a href="#h58-1-136" id="h58-1-136" class="d">-                                    Some(
</a><a href="#h58-1-137" id="h58-1-137" class="d">-                                        &quot;m&quot;,
</a><a href="#h58-1-138" id="h58-1-138" class="d">-                                    ),
</a><a href="#h58-1-139" id="h58-1-139" class="d">-                                    &quot;released&quot;,
</a><a href="#h58-1-140" id="h58-1-140" class="i">+                    Field(
</a><a href="#h58-1-141" id="h58-1-141" class="i">+                        4,
</a><a href="#h58-1-142" id="h58-1-142" class="i">+                        Some(
</a><a href="#h58-1-143" id="h58-1-143" class="i">+                            (
</a><a href="#h58-1-144" id="h58-1-144" class="i">+                                Some(
</a><a href="#h58-1-145" id="h58-1-145" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h58-1-147" id="h58-1-147" class="i">+                                &quot;released&quot;,
</a>                             ),
                         ),
<a href="#h58-1-150" id="h58-1-150" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h58-2" id="h58-2" class="h">@@ -729,40 +732,32 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h58-2-3" id="h58-2-3" class="i">+        labels: [
</a><a href="#h58-2-4" id="h58-2-4" class="i">+            None,
</a><a href="#h58-2-5" id="h58-2-5" class="i">+            None,
</a><a href="#h58-2-6" id="h58-2-6" class="i">+            None,
</a><a href="#h58-2-7" id="h58-2-7" class="i">+            None,
</a><a href="#h58-2-8" id="h58-2-8" class="i">+            None,
</a><a href="#h58-2-9" id="h58-2-9" class="i">+        ],
</a>         expressions: [
<a href="#h58-2-11" id="h58-2-11" class="d">-            (
</a><a href="#h58-2-12" id="h58-2-12" class="d">-                Field(
</a><a href="#h58-2-13" id="h58-2-13" class="d">-                    0,
</a><a href="#h58-2-14" id="h58-2-14" class="d">-                    None,
</a><a href="#h58-2-15" id="h58-2-15" class="d">-                ),
</a><a href="#h58-2-16" id="h58-2-16" class="i">+            Field(
</a><a href="#h58-2-17" id="h58-2-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h58-2-20" id="h58-2-20" class="d">-            (
</a><a href="#h58-2-21" id="h58-2-21" class="d">-                Field(
</a><a href="#h58-2-22" id="h58-2-22" class="d">-                    1,
</a><a href="#h58-2-23" id="h58-2-23" class="d">-                    None,
</a><a href="#h58-2-24" id="h58-2-24" class="d">-                ),
</a><a href="#h58-2-25" id="h58-2-25" class="i">+            Field(
</a><a href="#h58-2-26" id="h58-2-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h58-2-29" id="h58-2-29" class="d">-            (
</a><a href="#h58-2-30" id="h58-2-30" class="d">-                Field(
</a><a href="#h58-2-31" id="h58-2-31" class="d">-                    2,
</a><a href="#h58-2-32" id="h58-2-32" class="d">-                    None,
</a><a href="#h58-2-33" id="h58-2-33" class="d">-                ),
</a><a href="#h58-2-34" id="h58-2-34" class="i">+            Field(
</a><a href="#h58-2-35" id="h58-2-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h58-2-38" id="h58-2-38" class="d">-            (
</a><a href="#h58-2-39" id="h58-2-39" class="d">-                Field(
</a><a href="#h58-2-40" id="h58-2-40" class="d">-                    3,
</a><a href="#h58-2-41" id="h58-2-41" class="d">-                    None,
</a><a href="#h58-2-42" id="h58-2-42" class="d">-                ),
</a><a href="#h58-2-43" id="h58-2-43" class="i">+            Field(
</a><a href="#h58-2-44" id="h58-2-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h58-2-47" id="h58-2-47" class="d">-            (
</a><a href="#h58-2-48" id="h58-2-48" class="d">-                Field(
</a><a href="#h58-2-49" id="h58-2-49" class="d">-                    4,
</a><a href="#h58-2-50" id="h58-2-50" class="d">-                    None,
</a><a href="#h58-2-51" id="h58-2-51" class="d">-                ),
</a><a href="#h58-2-52" id="h58-2-52" class="i">+            Field(
</a><a href="#h58-2-53" id="h58-2-53" class="i">+                4,
</a>                 None,
             ),
         ],
<a href="#h58-3" id="h58-3" class="h">@@ -1126,94 +1121,90 @@ Optimized plan: Select(
</a>                     ),
                     outer: false,
                 },
<a href="#h58-3-3" id="h58-3-3" class="i">+                labels: [
</a><a href="#h58-3-4" id="h58-3-4" class="i">+                    None,
</a><a href="#h58-3-5" id="h58-3-5" class="i">+                    None,
</a><a href="#h58-3-6" id="h58-3-6" class="i">+                    Some(
</a><a href="#h58-3-7" id="h58-3-7" class="i">+                        (
</a><a href="#h58-3-8" id="h58-3-8" class="i">+                            None,
</a><a href="#h58-3-9" id="h58-3-9" class="i">+                            &quot;genre&quot;,
</a><a href="#h58-3-10" id="h58-3-10" class="i">+                        ),
</a><a href="#h58-3-11" id="h58-3-11" class="i">+                    ),
</a><a href="#h58-3-12" id="h58-3-12" class="i">+                    Some(
</a><a href="#h58-3-13" id="h58-3-13" class="i">+                        (
</a><a href="#h58-3-14" id="h58-3-14" class="i">+                            None,
</a><a href="#h58-3-15" id="h58-3-15" class="i">+                            &quot;studio&quot;,
</a><a href="#h58-3-16" id="h58-3-16" class="i">+                        ),
</a><a href="#h58-3-17" id="h58-3-17" class="i">+                    ),
</a><a href="#h58-3-18" id="h58-3-18" class="i">+                    None,
</a><a href="#h58-3-19" id="h58-3-19" class="i">+                    None,
</a><a href="#h58-3-20" id="h58-3-20" class="i">+                ],
</a>                 expressions: [
<a href="#h58-3-22" id="h58-3-22" class="d">-                    (
</a><a href="#h58-3-23" id="h58-3-23" class="d">-                        Field(
</a><a href="#h58-3-24" id="h58-3-24" class="d">-                            0,
</a><a href="#h58-3-25" id="h58-3-25" class="d">-                            Some(
</a><a href="#h58-3-26" id="h58-3-26" class="d">-                                (
</a><a href="#h58-3-27" id="h58-3-27" class="d">-                                    Some(
</a><a href="#h58-3-28" id="h58-3-28" class="d">-                                        &quot;m&quot;,
</a><a href="#h58-3-29" id="h58-3-29" class="d">-                                    ),
</a><a href="#h58-3-30" id="h58-3-30" class="d">-                                    &quot;id&quot;,
</a><a href="#h58-3-31" id="h58-3-31" class="i">+                    Field(
</a><a href="#h58-3-32" id="h58-3-32" class="i">+                        0,
</a><a href="#h58-3-33" id="h58-3-33" class="i">+                        Some(
</a><a href="#h58-3-34" id="h58-3-34" class="i">+                            (
</a><a href="#h58-3-35" id="h58-3-35" class="i">+                                Some(
</a><a href="#h58-3-36" id="h58-3-36" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h58-3-38" id="h58-3-38" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h58-3-41" id="h58-3-41" class="d">-                        None,
</a>                     ),
<a href="#h58-3-43" id="h58-3-43" class="d">-                    (
</a><a href="#h58-3-44" id="h58-3-44" class="d">-                        Field(
</a><a href="#h58-3-45" id="h58-3-45" class="d">-                            1,
</a><a href="#h58-3-46" id="h58-3-46" class="d">-                            Some(
</a><a href="#h58-3-47" id="h58-3-47" class="d">-                                (
</a><a href="#h58-3-48" id="h58-3-48" class="d">-                                    Some(
</a><a href="#h58-3-49" id="h58-3-49" class="d">-                                        &quot;m&quot;,
</a><a href="#h58-3-50" id="h58-3-50" class="d">-                                    ),
</a><a href="#h58-3-51" id="h58-3-51" class="d">-                                    &quot;title&quot;,
</a><a href="#h58-3-52" id="h58-3-52" class="i">+                    Field(
</a><a href="#h58-3-53" id="h58-3-53" class="i">+                        1,
</a><a href="#h58-3-54" id="h58-3-54" class="i">+                        Some(
</a><a href="#h58-3-55" id="h58-3-55" class="i">+                            (
</a><a href="#h58-3-56" id="h58-3-56" class="i">+                                Some(
</a><a href="#h58-3-57" id="h58-3-57" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h58-3-59" id="h58-3-59" class="i">+                                &quot;title&quot;,
</a>                             ),
                         ),
<a href="#h58-3-62" id="h58-3-62" class="d">-                        None,
</a>                     ),
<a href="#h58-3-64" id="h58-3-64" class="d">-                    (
</a><a href="#h58-3-65" id="h58-3-65" class="d">-                        Field(
</a><a href="#h58-3-66" id="h58-3-66" class="d">-                            8,
</a><a href="#h58-3-67" id="h58-3-67" class="d">-                            Some(
</a><a href="#h58-3-68" id="h58-3-68" class="d">-                                (
</a><a href="#h58-3-69" id="h58-3-69" class="d">-                                    Some(
</a><a href="#h58-3-70" id="h58-3-70" class="d">-                                        &quot;g&quot;,
</a><a href="#h58-3-71" id="h58-3-71" class="d">-                                    ),
</a><a href="#h58-3-72" id="h58-3-72" class="d">-                                    &quot;name&quot;,
</a><a href="#h58-3-73" id="h58-3-73" class="i">+                    Field(
</a><a href="#h58-3-74" id="h58-3-74" class="i">+                        8,
</a><a href="#h58-3-75" id="h58-3-75" class="i">+                        Some(
</a><a href="#h58-3-76" id="h58-3-76" class="i">+                            (
</a><a href="#h58-3-77" id="h58-3-77" class="i">+                                Some(
</a><a href="#h58-3-78" id="h58-3-78" class="i">+                                    &quot;g&quot;,
</a>                                 ),
<a href="#h58-3-80" id="h58-3-80" class="i">+                                &quot;name&quot;,
</a>                             ),
                         ),
<a href="#h58-3-83" id="h58-3-83" class="d">-                        Some(
</a><a href="#h58-3-84" id="h58-3-84" class="d">-                            &quot;genre&quot;,
</a><a href="#h58-3-85" id="h58-3-85" class="d">-                        ),
</a>                     ),
<a href="#h58-3-87" id="h58-3-87" class="d">-                    (
</a><a href="#h58-3-88" id="h58-3-88" class="d">-                        Field(
</a><a href="#h58-3-89" id="h58-3-89" class="d">-                            10,
</a><a href="#h58-3-90" id="h58-3-90" class="d">-                            Some(
</a><a href="#h58-3-91" id="h58-3-91" class="d">-                                (
</a><a href="#h58-3-92" id="h58-3-92" class="d">-                                    Some(
</a><a href="#h58-3-93" id="h58-3-93" class="d">-                                        &quot;s&quot;,
</a><a href="#h58-3-94" id="h58-3-94" class="d">-                                    ),
</a><a href="#h58-3-95" id="h58-3-95" class="d">-                                    &quot;name&quot;,
</a><a href="#h58-3-96" id="h58-3-96" class="i">+                    Field(
</a><a href="#h58-3-97" id="h58-3-97" class="i">+                        10,
</a><a href="#h58-3-98" id="h58-3-98" class="i">+                        Some(
</a><a href="#h58-3-99" id="h58-3-99" class="i">+                            (
</a><a href="#h58-3-100" id="h58-3-100" class="i">+                                Some(
</a><a href="#h58-3-101" id="h58-3-101" class="i">+                                    &quot;s&quot;,
</a>                                 ),
<a href="#h58-3-103" id="h58-3-103" class="i">+                                &quot;name&quot;,
</a>                             ),
                         ),
<a href="#h58-3-106" id="h58-3-106" class="d">-                        Some(
</a><a href="#h58-3-107" id="h58-3-107" class="d">-                            &quot;studio&quot;,
</a><a href="#h58-3-108" id="h58-3-108" class="d">-                        ),
</a>                     ),
<a href="#h58-3-110" id="h58-3-110" class="d">-                    (
</a><a href="#h58-3-111" id="h58-3-111" class="d">-                        Field(
</a><a href="#h58-3-112" id="h58-3-112" class="d">-                            5,
</a><a href="#h58-3-113" id="h58-3-113" class="d">-                            Some(
</a><a href="#h58-3-114" id="h58-3-114" class="d">-                                (
</a><a href="#h58-3-115" id="h58-3-115" class="d">-                                    Some(
</a><a href="#h58-3-116" id="h58-3-116" class="d">-                                        &quot;m&quot;,
</a><a href="#h58-3-117" id="h58-3-117" class="d">-                                    ),
</a><a href="#h58-3-118" id="h58-3-118" class="d">-                                    &quot;rating&quot;,
</a><a href="#h58-3-119" id="h58-3-119" class="i">+                    Field(
</a><a href="#h58-3-120" id="h58-3-120" class="i">+                        5,
</a><a href="#h58-3-121" id="h58-3-121" class="i">+                        Some(
</a><a href="#h58-3-122" id="h58-3-122" class="i">+                            (
</a><a href="#h58-3-123" id="h58-3-123" class="i">+                                Some(
</a><a href="#h58-3-124" id="h58-3-124" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h58-3-126" id="h58-3-126" class="i">+                                &quot;rating&quot;,
</a>                             ),
                         ),
<a href="#h58-3-129" id="h58-3-129" class="d">-                        None,
</a>                     ),
<a href="#h58-3-131" id="h58-3-131" class="d">-                    (
</a><a href="#h58-3-132" id="h58-3-132" class="d">-                        Field(
</a><a href="#h58-3-133" id="h58-3-133" class="d">-                            4,
</a><a href="#h58-3-134" id="h58-3-134" class="d">-                            Some(
</a><a href="#h58-3-135" id="h58-3-135" class="d">-                                (
</a><a href="#h58-3-136" id="h58-3-136" class="d">-                                    Some(
</a><a href="#h58-3-137" id="h58-3-137" class="d">-                                        &quot;m&quot;,
</a><a href="#h58-3-138" id="h58-3-138" class="d">-                                    ),
</a><a href="#h58-3-139" id="h58-3-139" class="d">-                                    &quot;released&quot;,
</a><a href="#h58-3-140" id="h58-3-140" class="i">+                    Field(
</a><a href="#h58-3-141" id="h58-3-141" class="i">+                        4,
</a><a href="#h58-3-142" id="h58-3-142" class="i">+                        Some(
</a><a href="#h58-3-143" id="h58-3-143" class="i">+                            (
</a><a href="#h58-3-144" id="h58-3-144" class="i">+                                Some(
</a><a href="#h58-3-145" id="h58-3-145" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h58-3-147" id="h58-3-147" class="i">+                                &quot;released&quot;,
</a>                             ),
                         ),
<a href="#h58-3-150" id="h58-3-150" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h58-4" id="h58-4" class="h">@@ -1262,40 +1253,32 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h58-4-3" id="h58-4-3" class="i">+        labels: [
</a><a href="#h58-4-4" id="h58-4-4" class="i">+            None,
</a><a href="#h58-4-5" id="h58-4-5" class="i">+            None,
</a><a href="#h58-4-6" id="h58-4-6" class="i">+            None,
</a><a href="#h58-4-7" id="h58-4-7" class="i">+            None,
</a><a href="#h58-4-8" id="h58-4-8" class="i">+            None,
</a><a href="#h58-4-9" id="h58-4-9" class="i">+        ],
</a>         expressions: [
<a href="#h58-4-11" id="h58-4-11" class="d">-            (
</a><a href="#h58-4-12" id="h58-4-12" class="d">-                Field(
</a><a href="#h58-4-13" id="h58-4-13" class="d">-                    0,
</a><a href="#h58-4-14" id="h58-4-14" class="d">-                    None,
</a><a href="#h58-4-15" id="h58-4-15" class="d">-                ),
</a><a href="#h58-4-16" id="h58-4-16" class="i">+            Field(
</a><a href="#h58-4-17" id="h58-4-17" class="i">+                0,
</a>                 None,
             ),
<a href="#h58-4-20" id="h58-4-20" class="d">-            (
</a><a href="#h58-4-21" id="h58-4-21" class="d">-                Field(
</a><a href="#h58-4-22" id="h58-4-22" class="d">-                    1,
</a><a href="#h58-4-23" id="h58-4-23" class="d">-                    None,
</a><a href="#h58-4-24" id="h58-4-24" class="d">-                ),
</a><a href="#h58-4-25" id="h58-4-25" class="i">+            Field(
</a><a href="#h58-4-26" id="h58-4-26" class="i">+                1,
</a>                 None,
             ),
<a href="#h58-4-29" id="h58-4-29" class="d">-            (
</a><a href="#h58-4-30" id="h58-4-30" class="d">-                Field(
</a><a href="#h58-4-31" id="h58-4-31" class="d">-                    2,
</a><a href="#h58-4-32" id="h58-4-32" class="d">-                    None,
</a><a href="#h58-4-33" id="h58-4-33" class="d">-                ),
</a><a href="#h58-4-34" id="h58-4-34" class="i">+            Field(
</a><a href="#h58-4-35" id="h58-4-35" class="i">+                2,
</a>                 None,
             ),
<a href="#h58-4-38" id="h58-4-38" class="d">-            (
</a><a href="#h58-4-39" id="h58-4-39" class="d">-                Field(
</a><a href="#h58-4-40" id="h58-4-40" class="d">-                    3,
</a><a href="#h58-4-41" id="h58-4-41" class="d">-                    None,
</a><a href="#h58-4-42" id="h58-4-42" class="d">-                ),
</a><a href="#h58-4-43" id="h58-4-43" class="i">+            Field(
</a><a href="#h58-4-44" id="h58-4-44" class="i">+                3,
</a>                 None,
             ),
<a href="#h58-4-47" id="h58-4-47" class="d">-            (
</a><a href="#h58-4-48" id="h58-4-48" class="d">-                Field(
</a><a href="#h58-4-49" id="h58-4-49" class="d">-                    4,
</a><a href="#h58-4-50" id="h58-4-50" class="d">-                    None,
</a><a href="#h58-4-51" id="h58-4-51" class="d">-                ),
</a><a href="#h58-4-52" id="h58-4-52" class="i">+            Field(
</a><a href="#h58-4-53" id="h58-4-53" class="i">+                4,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h59" href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a> b/<a href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -231,37 +231,41 @@ Plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h59-0-3" id="h59-0-3" class="d">-        expressions: [
</a><a href="#h59-0-4" id="h59-0-4" class="d">-            (
</a><a href="#h59-0-5" id="h59-0-5" class="d">-                Field(
</a><a href="#h59-0-6" id="h59-0-6" class="d">-                    0,
</a><a href="#h59-0-7" id="h59-0-7" class="d">-                    Some(
</a><a href="#h59-0-8" id="h59-0-8" class="d">-                        (
</a><a href="#h59-0-9" id="h59-0-9" class="d">-                            Some(
</a><a href="#h59-0-10" id="h59-0-10" class="d">-                                &quot;m&quot;,
</a><a href="#h59-0-11" id="h59-0-11" class="d">-                            ),
</a><a href="#h59-0-12" id="h59-0-12" class="d">-                            &quot;id&quot;,
</a><a href="#h59-0-13" id="h59-0-13" class="d">-                        ),
</a><a href="#h59-0-14" id="h59-0-14" class="d">-                    ),
</a><a href="#h59-0-15" id="h59-0-15" class="d">-                ),
</a><a href="#h59-0-16" id="h59-0-16" class="d">-                Some(
</a><a href="#h59-0-17" id="h59-0-17" class="i">+        labels: [
</a><a href="#h59-0-18" id="h59-0-18" class="i">+            Some(
</a><a href="#h59-0-19" id="h59-0-19" class="i">+                (
</a><a href="#h59-0-20" id="h59-0-20" class="i">+                    None,
</a>                     &quot;movie_id&quot;,
                 ),
             ),
<a href="#h59-0-24" id="h59-0-24" class="d">-            (
</a><a href="#h59-0-25" id="h59-0-25" class="d">-                Field(
</a><a href="#h59-0-26" id="h59-0-26" class="d">-                    7,
</a><a href="#h59-0-27" id="h59-0-27" class="d">-                    Some(
</a><a href="#h59-0-28" id="h59-0-28" class="d">-                        (
</a><a href="#h59-0-29" id="h59-0-29" class="d">-                            Some(
</a><a href="#h59-0-30" id="h59-0-30" class="d">-                                &quot;g&quot;,
</a><a href="#h59-0-31" id="h59-0-31" class="d">-                            ),
</a><a href="#h59-0-32" id="h59-0-32" class="d">-                            &quot;id&quot;,
</a><a href="#h59-0-33" id="h59-0-33" class="i">+            Some(
</a><a href="#h59-0-34" id="h59-0-34" class="i">+                (
</a><a href="#h59-0-35" id="h59-0-35" class="i">+                    None,
</a><a href="#h59-0-36" id="h59-0-36" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h59-0-37" id="h59-0-37" class="i">+                ),
</a><a href="#h59-0-38" id="h59-0-38" class="i">+            ),
</a><a href="#h59-0-39" id="h59-0-39" class="i">+        ],
</a><a href="#h59-0-40" id="h59-0-40" class="i">+        expressions: [
</a><a href="#h59-0-41" id="h59-0-41" class="i">+            Field(
</a><a href="#h59-0-42" id="h59-0-42" class="i">+                0,
</a><a href="#h59-0-43" id="h59-0-43" class="i">+                Some(
</a><a href="#h59-0-44" id="h59-0-44" class="i">+                    (
</a><a href="#h59-0-45" id="h59-0-45" class="i">+                        Some(
</a><a href="#h59-0-46" id="h59-0-46" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h59-0-48" id="h59-0-48" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h59-0-51" id="h59-0-51" class="i">+            ),
</a><a href="#h59-0-52" id="h59-0-52" class="i">+            Field(
</a><a href="#h59-0-53" id="h59-0-53" class="i">+                7,
</a>                 Some(
<a href="#h59-0-55" id="h59-0-55" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h59-0-56" id="h59-0-56" class="i">+                    (
</a><a href="#h59-0-57" id="h59-0-57" class="i">+                        Some(
</a><a href="#h59-0-58" id="h59-0-58" class="i">+                            &quot;g&quot;,
</a><a href="#h59-0-59" id="h59-0-59" class="i">+                        ),
</a><a href="#h59-0-60" id="h59-0-60" class="i">+                        &quot;id&quot;,
</a><a href="#h59-0-61" id="h59-0-61" class="i">+                    ),
</a>                 ),
             ),
         ],
<a href="#h59-1" id="h59-1" class="h">@@ -408,37 +412,41 @@ Optimized plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h59-1-3" id="h59-1-3" class="d">-        expressions: [
</a><a href="#h59-1-4" id="h59-1-4" class="d">-            (
</a><a href="#h59-1-5" id="h59-1-5" class="d">-                Field(
</a><a href="#h59-1-6" id="h59-1-6" class="d">-                    0,
</a><a href="#h59-1-7" id="h59-1-7" class="d">-                    Some(
</a><a href="#h59-1-8" id="h59-1-8" class="d">-                        (
</a><a href="#h59-1-9" id="h59-1-9" class="d">-                            Some(
</a><a href="#h59-1-10" id="h59-1-10" class="d">-                                &quot;m&quot;,
</a><a href="#h59-1-11" id="h59-1-11" class="d">-                            ),
</a><a href="#h59-1-12" id="h59-1-12" class="d">-                            &quot;id&quot;,
</a><a href="#h59-1-13" id="h59-1-13" class="d">-                        ),
</a><a href="#h59-1-14" id="h59-1-14" class="d">-                    ),
</a><a href="#h59-1-15" id="h59-1-15" class="d">-                ),
</a><a href="#h59-1-16" id="h59-1-16" class="d">-                Some(
</a><a href="#h59-1-17" id="h59-1-17" class="i">+        labels: [
</a><a href="#h59-1-18" id="h59-1-18" class="i">+            Some(
</a><a href="#h59-1-19" id="h59-1-19" class="i">+                (
</a><a href="#h59-1-20" id="h59-1-20" class="i">+                    None,
</a>                     &quot;movie_id&quot;,
                 ),
             ),
<a href="#h59-1-24" id="h59-1-24" class="d">-            (
</a><a href="#h59-1-25" id="h59-1-25" class="d">-                Field(
</a><a href="#h59-1-26" id="h59-1-26" class="d">-                    7,
</a><a href="#h59-1-27" id="h59-1-27" class="d">-                    Some(
</a><a href="#h59-1-28" id="h59-1-28" class="d">-                        (
</a><a href="#h59-1-29" id="h59-1-29" class="d">-                            Some(
</a><a href="#h59-1-30" id="h59-1-30" class="d">-                                &quot;g&quot;,
</a><a href="#h59-1-31" id="h59-1-31" class="d">-                            ),
</a><a href="#h59-1-32" id="h59-1-32" class="d">-                            &quot;id&quot;,
</a><a href="#h59-1-33" id="h59-1-33" class="i">+            Some(
</a><a href="#h59-1-34" id="h59-1-34" class="i">+                (
</a><a href="#h59-1-35" id="h59-1-35" class="i">+                    None,
</a><a href="#h59-1-36" id="h59-1-36" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h59-1-37" id="h59-1-37" class="i">+                ),
</a><a href="#h59-1-38" id="h59-1-38" class="i">+            ),
</a><a href="#h59-1-39" id="h59-1-39" class="i">+        ],
</a><a href="#h59-1-40" id="h59-1-40" class="i">+        expressions: [
</a><a href="#h59-1-41" id="h59-1-41" class="i">+            Field(
</a><a href="#h59-1-42" id="h59-1-42" class="i">+                0,
</a><a href="#h59-1-43" id="h59-1-43" class="i">+                Some(
</a><a href="#h59-1-44" id="h59-1-44" class="i">+                    (
</a><a href="#h59-1-45" id="h59-1-45" class="i">+                        Some(
</a><a href="#h59-1-46" id="h59-1-46" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h59-1-48" id="h59-1-48" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h59-1-51" id="h59-1-51" class="i">+            ),
</a><a href="#h59-1-52" id="h59-1-52" class="i">+            Field(
</a><a href="#h59-1-53" id="h59-1-53" class="i">+                7,
</a>                 Some(
<a href="#h59-1-55" id="h59-1-55" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h59-1-56" id="h59-1-56" class="i">+                    (
</a><a href="#h59-1-57" id="h59-1-57" class="i">+                        Some(
</a><a href="#h59-1-58" id="h59-1-58" class="i">+                            &quot;g&quot;,
</a><a href="#h59-1-59" id="h59-1-59" class="i">+                        ),
</a><a href="#h59-1-60" id="h59-1-60" class="i">+                        &quot;id&quot;,
</a><a href="#h59-1-61" id="h59-1-61" class="i">+                    ),
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h60" href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a> b/<a href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -231,37 +231,41 @@ Plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h60-0-3" id="h60-0-3" class="d">-        expressions: [
</a><a href="#h60-0-4" id="h60-0-4" class="d">-            (
</a><a href="#h60-0-5" id="h60-0-5" class="d">-                Field(
</a><a href="#h60-0-6" id="h60-0-6" class="d">-                    0,
</a><a href="#h60-0-7" id="h60-0-7" class="d">-                    Some(
</a><a href="#h60-0-8" id="h60-0-8" class="d">-                        (
</a><a href="#h60-0-9" id="h60-0-9" class="d">-                            Some(
</a><a href="#h60-0-10" id="h60-0-10" class="d">-                                &quot;m&quot;,
</a><a href="#h60-0-11" id="h60-0-11" class="d">-                            ),
</a><a href="#h60-0-12" id="h60-0-12" class="d">-                            &quot;id&quot;,
</a><a href="#h60-0-13" id="h60-0-13" class="d">-                        ),
</a><a href="#h60-0-14" id="h60-0-14" class="d">-                    ),
</a><a href="#h60-0-15" id="h60-0-15" class="d">-                ),
</a><a href="#h60-0-16" id="h60-0-16" class="d">-                Some(
</a><a href="#h60-0-17" id="h60-0-17" class="i">+        labels: [
</a><a href="#h60-0-18" id="h60-0-18" class="i">+            Some(
</a><a href="#h60-0-19" id="h60-0-19" class="i">+                (
</a><a href="#h60-0-20" id="h60-0-20" class="i">+                    None,
</a>                     &quot;movie_id&quot;,
                 ),
             ),
<a href="#h60-0-24" id="h60-0-24" class="d">-            (
</a><a href="#h60-0-25" id="h60-0-25" class="d">-                Field(
</a><a href="#h60-0-26" id="h60-0-26" class="d">-                    7,
</a><a href="#h60-0-27" id="h60-0-27" class="d">-                    Some(
</a><a href="#h60-0-28" id="h60-0-28" class="d">-                        (
</a><a href="#h60-0-29" id="h60-0-29" class="d">-                            Some(
</a><a href="#h60-0-30" id="h60-0-30" class="d">-                                &quot;g&quot;,
</a><a href="#h60-0-31" id="h60-0-31" class="d">-                            ),
</a><a href="#h60-0-32" id="h60-0-32" class="d">-                            &quot;id&quot;,
</a><a href="#h60-0-33" id="h60-0-33" class="i">+            Some(
</a><a href="#h60-0-34" id="h60-0-34" class="i">+                (
</a><a href="#h60-0-35" id="h60-0-35" class="i">+                    None,
</a><a href="#h60-0-36" id="h60-0-36" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h60-0-37" id="h60-0-37" class="i">+                ),
</a><a href="#h60-0-38" id="h60-0-38" class="i">+            ),
</a><a href="#h60-0-39" id="h60-0-39" class="i">+        ],
</a><a href="#h60-0-40" id="h60-0-40" class="i">+        expressions: [
</a><a href="#h60-0-41" id="h60-0-41" class="i">+            Field(
</a><a href="#h60-0-42" id="h60-0-42" class="i">+                0,
</a><a href="#h60-0-43" id="h60-0-43" class="i">+                Some(
</a><a href="#h60-0-44" id="h60-0-44" class="i">+                    (
</a><a href="#h60-0-45" id="h60-0-45" class="i">+                        Some(
</a><a href="#h60-0-46" id="h60-0-46" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h60-0-48" id="h60-0-48" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h60-0-51" id="h60-0-51" class="i">+            ),
</a><a href="#h60-0-52" id="h60-0-52" class="i">+            Field(
</a><a href="#h60-0-53" id="h60-0-53" class="i">+                7,
</a>                 Some(
<a href="#h60-0-55" id="h60-0-55" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h60-0-56" id="h60-0-56" class="i">+                    (
</a><a href="#h60-0-57" id="h60-0-57" class="i">+                        Some(
</a><a href="#h60-0-58" id="h60-0-58" class="i">+                            &quot;g&quot;,
</a><a href="#h60-0-59" id="h60-0-59" class="i">+                        ),
</a><a href="#h60-0-60" id="h60-0-60" class="i">+                        &quot;id&quot;,
</a><a href="#h60-0-61" id="h60-0-61" class="i">+                    ),
</a>                 ),
             ),
         ],
<a href="#h60-1" id="h60-1" class="h">@@ -408,37 +412,41 @@ Optimized plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h60-1-3" id="h60-1-3" class="d">-        expressions: [
</a><a href="#h60-1-4" id="h60-1-4" class="d">-            (
</a><a href="#h60-1-5" id="h60-1-5" class="d">-                Field(
</a><a href="#h60-1-6" id="h60-1-6" class="d">-                    0,
</a><a href="#h60-1-7" id="h60-1-7" class="d">-                    Some(
</a><a href="#h60-1-8" id="h60-1-8" class="d">-                        (
</a><a href="#h60-1-9" id="h60-1-9" class="d">-                            Some(
</a><a href="#h60-1-10" id="h60-1-10" class="d">-                                &quot;m&quot;,
</a><a href="#h60-1-11" id="h60-1-11" class="d">-                            ),
</a><a href="#h60-1-12" id="h60-1-12" class="d">-                            &quot;id&quot;,
</a><a href="#h60-1-13" id="h60-1-13" class="d">-                        ),
</a><a href="#h60-1-14" id="h60-1-14" class="d">-                    ),
</a><a href="#h60-1-15" id="h60-1-15" class="d">-                ),
</a><a href="#h60-1-16" id="h60-1-16" class="d">-                Some(
</a><a href="#h60-1-17" id="h60-1-17" class="i">+        labels: [
</a><a href="#h60-1-18" id="h60-1-18" class="i">+            Some(
</a><a href="#h60-1-19" id="h60-1-19" class="i">+                (
</a><a href="#h60-1-20" id="h60-1-20" class="i">+                    None,
</a>                     &quot;movie_id&quot;,
                 ),
             ),
<a href="#h60-1-24" id="h60-1-24" class="d">-            (
</a><a href="#h60-1-25" id="h60-1-25" class="d">-                Field(
</a><a href="#h60-1-26" id="h60-1-26" class="d">-                    7,
</a><a href="#h60-1-27" id="h60-1-27" class="d">-                    Some(
</a><a href="#h60-1-28" id="h60-1-28" class="d">-                        (
</a><a href="#h60-1-29" id="h60-1-29" class="d">-                            Some(
</a><a href="#h60-1-30" id="h60-1-30" class="d">-                                &quot;g&quot;,
</a><a href="#h60-1-31" id="h60-1-31" class="d">-                            ),
</a><a href="#h60-1-32" id="h60-1-32" class="d">-                            &quot;id&quot;,
</a><a href="#h60-1-33" id="h60-1-33" class="i">+            Some(
</a><a href="#h60-1-34" id="h60-1-34" class="i">+                (
</a><a href="#h60-1-35" id="h60-1-35" class="i">+                    None,
</a><a href="#h60-1-36" id="h60-1-36" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h60-1-37" id="h60-1-37" class="i">+                ),
</a><a href="#h60-1-38" id="h60-1-38" class="i">+            ),
</a><a href="#h60-1-39" id="h60-1-39" class="i">+        ],
</a><a href="#h60-1-40" id="h60-1-40" class="i">+        expressions: [
</a><a href="#h60-1-41" id="h60-1-41" class="i">+            Field(
</a><a href="#h60-1-42" id="h60-1-42" class="i">+                0,
</a><a href="#h60-1-43" id="h60-1-43" class="i">+                Some(
</a><a href="#h60-1-44" id="h60-1-44" class="i">+                    (
</a><a href="#h60-1-45" id="h60-1-45" class="i">+                        Some(
</a><a href="#h60-1-46" id="h60-1-46" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h60-1-48" id="h60-1-48" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h60-1-51" id="h60-1-51" class="i">+            ),
</a><a href="#h60-1-52" id="h60-1-52" class="i">+            Field(
</a><a href="#h60-1-53" id="h60-1-53" class="i">+                7,
</a>                 Some(
<a href="#h60-1-55" id="h60-1-55" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h60-1-56" id="h60-1-56" class="i">+                    (
</a><a href="#h60-1-57" id="h60-1-57" class="i">+                        Some(
</a><a href="#h60-1-58" id="h60-1-58" class="i">+                            &quot;g&quot;,
</a><a href="#h60-1-59" id="h60-1-59" class="i">+                        ),
</a><a href="#h60-1-60" id="h60-1-60" class="i">+                        &quot;id&quot;,
</a><a href="#h60-1-61" id="h60-1-61" class="i">+                    ),
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h61" href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a> b/<a href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -224,37 +224,41 @@ Plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h61-0-3" id="h61-0-3" class="d">-        expressions: [
</a><a href="#h61-0-4" id="h61-0-4" class="d">-            (
</a><a href="#h61-0-5" id="h61-0-5" class="d">-                Field(
</a><a href="#h61-0-6" id="h61-0-6" class="d">-                    0,
</a><a href="#h61-0-7" id="h61-0-7" class="d">-                    Some(
</a><a href="#h61-0-8" id="h61-0-8" class="d">-                        (
</a><a href="#h61-0-9" id="h61-0-9" class="d">-                            Some(
</a><a href="#h61-0-10" id="h61-0-10" class="d">-                                &quot;g&quot;,
</a><a href="#h61-0-11" id="h61-0-11" class="d">-                            ),
</a><a href="#h61-0-12" id="h61-0-12" class="d">-                            &quot;id&quot;,
</a><a href="#h61-0-13" id="h61-0-13" class="d">-                        ),
</a><a href="#h61-0-14" id="h61-0-14" class="d">-                    ),
</a><a href="#h61-0-15" id="h61-0-15" class="d">-                ),
</a><a href="#h61-0-16" id="h61-0-16" class="d">-                Some(
</a><a href="#h61-0-17" id="h61-0-17" class="i">+        labels: [
</a><a href="#h61-0-18" id="h61-0-18" class="i">+            Some(
</a><a href="#h61-0-19" id="h61-0-19" class="i">+                (
</a><a href="#h61-0-20" id="h61-0-20" class="i">+                    None,
</a>                     &quot;genre_id&quot;,
                 ),
             ),
<a href="#h61-0-24" id="h61-0-24" class="d">-            (
</a><a href="#h61-0-25" id="h61-0-25" class="d">-                Field(
</a><a href="#h61-0-26" id="h61-0-26" class="d">-                    2,
</a><a href="#h61-0-27" id="h61-0-27" class="d">-                    Some(
</a><a href="#h61-0-28" id="h61-0-28" class="d">-                        (
</a><a href="#h61-0-29" id="h61-0-29" class="d">-                            Some(
</a><a href="#h61-0-30" id="h61-0-30" class="d">-                                &quot;m&quot;,
</a><a href="#h61-0-31" id="h61-0-31" class="d">-                            ),
</a><a href="#h61-0-32" id="h61-0-32" class="d">-                            &quot;id&quot;,
</a><a href="#h61-0-33" id="h61-0-33" class="i">+            Some(
</a><a href="#h61-0-34" id="h61-0-34" class="i">+                (
</a><a href="#h61-0-35" id="h61-0-35" class="i">+                    None,
</a><a href="#h61-0-36" id="h61-0-36" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h61-0-37" id="h61-0-37" class="i">+                ),
</a><a href="#h61-0-38" id="h61-0-38" class="i">+            ),
</a><a href="#h61-0-39" id="h61-0-39" class="i">+        ],
</a><a href="#h61-0-40" id="h61-0-40" class="i">+        expressions: [
</a><a href="#h61-0-41" id="h61-0-41" class="i">+            Field(
</a><a href="#h61-0-42" id="h61-0-42" class="i">+                0,
</a><a href="#h61-0-43" id="h61-0-43" class="i">+                Some(
</a><a href="#h61-0-44" id="h61-0-44" class="i">+                    (
</a><a href="#h61-0-45" id="h61-0-45" class="i">+                        Some(
</a><a href="#h61-0-46" id="h61-0-46" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h61-0-48" id="h61-0-48" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h61-0-51" id="h61-0-51" class="i">+            ),
</a><a href="#h61-0-52" id="h61-0-52" class="i">+            Field(
</a><a href="#h61-0-53" id="h61-0-53" class="i">+                2,
</a>                 Some(
<a href="#h61-0-55" id="h61-0-55" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h61-0-56" id="h61-0-56" class="i">+                    (
</a><a href="#h61-0-57" id="h61-0-57" class="i">+                        Some(
</a><a href="#h61-0-58" id="h61-0-58" class="i">+                            &quot;m&quot;,
</a><a href="#h61-0-59" id="h61-0-59" class="i">+                        ),
</a><a href="#h61-0-60" id="h61-0-60" class="i">+                        &quot;id&quot;,
</a><a href="#h61-0-61" id="h61-0-61" class="i">+                    ),
</a>                 ),
             ),
         ],
<a href="#h61-1" id="h61-1" class="h">@@ -401,37 +405,41 @@ Optimized plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h61-1-3" id="h61-1-3" class="d">-        expressions: [
</a><a href="#h61-1-4" id="h61-1-4" class="d">-            (
</a><a href="#h61-1-5" id="h61-1-5" class="d">-                Field(
</a><a href="#h61-1-6" id="h61-1-6" class="d">-                    0,
</a><a href="#h61-1-7" id="h61-1-7" class="d">-                    Some(
</a><a href="#h61-1-8" id="h61-1-8" class="d">-                        (
</a><a href="#h61-1-9" id="h61-1-9" class="d">-                            Some(
</a><a href="#h61-1-10" id="h61-1-10" class="d">-                                &quot;g&quot;,
</a><a href="#h61-1-11" id="h61-1-11" class="d">-                            ),
</a><a href="#h61-1-12" id="h61-1-12" class="d">-                            &quot;id&quot;,
</a><a href="#h61-1-13" id="h61-1-13" class="d">-                        ),
</a><a href="#h61-1-14" id="h61-1-14" class="d">-                    ),
</a><a href="#h61-1-15" id="h61-1-15" class="d">-                ),
</a><a href="#h61-1-16" id="h61-1-16" class="d">-                Some(
</a><a href="#h61-1-17" id="h61-1-17" class="i">+        labels: [
</a><a href="#h61-1-18" id="h61-1-18" class="i">+            Some(
</a><a href="#h61-1-19" id="h61-1-19" class="i">+                (
</a><a href="#h61-1-20" id="h61-1-20" class="i">+                    None,
</a>                     &quot;genre_id&quot;,
                 ),
             ),
<a href="#h61-1-24" id="h61-1-24" class="d">-            (
</a><a href="#h61-1-25" id="h61-1-25" class="d">-                Field(
</a><a href="#h61-1-26" id="h61-1-26" class="d">-                    2,
</a><a href="#h61-1-27" id="h61-1-27" class="d">-                    Some(
</a><a href="#h61-1-28" id="h61-1-28" class="d">-                        (
</a><a href="#h61-1-29" id="h61-1-29" class="d">-                            Some(
</a><a href="#h61-1-30" id="h61-1-30" class="d">-                                &quot;m&quot;,
</a><a href="#h61-1-31" id="h61-1-31" class="d">-                            ),
</a><a href="#h61-1-32" id="h61-1-32" class="d">-                            &quot;id&quot;,
</a><a href="#h61-1-33" id="h61-1-33" class="i">+            Some(
</a><a href="#h61-1-34" id="h61-1-34" class="i">+                (
</a><a href="#h61-1-35" id="h61-1-35" class="i">+                    None,
</a><a href="#h61-1-36" id="h61-1-36" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h61-1-37" id="h61-1-37" class="i">+                ),
</a><a href="#h61-1-38" id="h61-1-38" class="i">+            ),
</a><a href="#h61-1-39" id="h61-1-39" class="i">+        ],
</a><a href="#h61-1-40" id="h61-1-40" class="i">+        expressions: [
</a><a href="#h61-1-41" id="h61-1-41" class="i">+            Field(
</a><a href="#h61-1-42" id="h61-1-42" class="i">+                0,
</a><a href="#h61-1-43" id="h61-1-43" class="i">+                Some(
</a><a href="#h61-1-44" id="h61-1-44" class="i">+                    (
</a><a href="#h61-1-45" id="h61-1-45" class="i">+                        Some(
</a><a href="#h61-1-46" id="h61-1-46" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h61-1-48" id="h61-1-48" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h61-1-51" id="h61-1-51" class="i">+            ),
</a><a href="#h61-1-52" id="h61-1-52" class="i">+            Field(
</a><a href="#h61-1-53" id="h61-1-53" class="i">+                2,
</a>                 Some(
<a href="#h61-1-55" id="h61-1-55" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h61-1-56" id="h61-1-56" class="i">+                    (
</a><a href="#h61-1-57" id="h61-1-57" class="i">+                        Some(
</a><a href="#h61-1-58" id="h61-1-58" class="i">+                            &quot;m&quot;,
</a><a href="#h61-1-59" id="h61-1-59" class="i">+                        ),
</a><a href="#h61-1-60" id="h61-1-60" class="i">+                        &quot;id&quot;,
</a><a href="#h61-1-61" id="h61-1-61" class="i">+                    ),
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h62" href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a> b/<a href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -233,166 +233,154 @@ Plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h62-0-3" id="h62-0-3" class="i">+            labels: [
</a><a href="#h62-0-4" id="h62-0-4" class="i">+                None,
</a><a href="#h62-0-5" id="h62-0-5" class="i">+                None,
</a><a href="#h62-0-6" id="h62-0-6" class="i">+                None,
</a><a href="#h62-0-7" id="h62-0-7" class="i">+                None,
</a><a href="#h62-0-8" id="h62-0-8" class="i">+                None,
</a><a href="#h62-0-9" id="h62-0-9" class="i">+                None,
</a><a href="#h62-0-10" id="h62-0-10" class="i">+                None,
</a><a href="#h62-0-11" id="h62-0-11" class="i">+                None,
</a><a href="#h62-0-12" id="h62-0-12" class="i">+                None,
</a><a href="#h62-0-13" id="h62-0-13" class="i">+            ],
</a>             expressions: [
<a href="#h62-0-15" id="h62-0-15" class="d">-                (
</a><a href="#h62-0-16" id="h62-0-16" class="d">-                    Field(
</a><a href="#h62-0-17" id="h62-0-17" class="d">-                        7,
</a><a href="#h62-0-18" id="h62-0-18" class="d">-                        Some(
</a><a href="#h62-0-19" id="h62-0-19" class="d">-                            (
</a><a href="#h62-0-20" id="h62-0-20" class="d">-                                Some(
</a><a href="#h62-0-21" id="h62-0-21" class="d">-                                    &quot;g&quot;,
</a><a href="#h62-0-22" id="h62-0-22" class="d">-                                ),
</a><a href="#h62-0-23" id="h62-0-23" class="d">-                                &quot;id&quot;,
</a><a href="#h62-0-24" id="h62-0-24" class="d">-                            ),
</a><a href="#h62-0-25" id="h62-0-25" class="d">-                        ),
</a><a href="#h62-0-26" id="h62-0-26" class="d">-                    ),
</a><a href="#h62-0-27" id="h62-0-27" class="d">-                    None,
</a><a href="#h62-0-28" id="h62-0-28" class="d">-                ),
</a><a href="#h62-0-29" id="h62-0-29" class="d">-                (
</a><a href="#h62-0-30" id="h62-0-30" class="d">-                    Field(
</a><a href="#h62-0-31" id="h62-0-31" class="d">-                        8,
</a><a href="#h62-0-32" id="h62-0-32" class="d">-                        Some(
</a><a href="#h62-0-33" id="h62-0-33" class="d">-                            (
</a><a href="#h62-0-34" id="h62-0-34" class="d">-                                Some(
</a><a href="#h62-0-35" id="h62-0-35" class="d">-                                    &quot;g&quot;,
</a><a href="#h62-0-36" id="h62-0-36" class="d">-                                ),
</a><a href="#h62-0-37" id="h62-0-37" class="d">-                                &quot;name&quot;,
</a><a href="#h62-0-38" id="h62-0-38" class="i">+                Field(
</a><a href="#h62-0-39" id="h62-0-39" class="i">+                    7,
</a><a href="#h62-0-40" id="h62-0-40" class="i">+                    Some(
</a><a href="#h62-0-41" id="h62-0-41" class="i">+                        (
</a><a href="#h62-0-42" id="h62-0-42" class="i">+                            Some(
</a><a href="#h62-0-43" id="h62-0-43" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h62-0-45" id="h62-0-45" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h62-0-48" id="h62-0-48" class="d">-                    None,
</a>                 ),
<a href="#h62-0-50" id="h62-0-50" class="d">-                (
</a><a href="#h62-0-51" id="h62-0-51" class="d">-                    Field(
</a><a href="#h62-0-52" id="h62-0-52" class="d">-                        0,
</a><a href="#h62-0-53" id="h62-0-53" class="d">-                        Some(
</a><a href="#h62-0-54" id="h62-0-54" class="d">-                            (
</a><a href="#h62-0-55" id="h62-0-55" class="d">-                                Some(
</a><a href="#h62-0-56" id="h62-0-56" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-0-57" id="h62-0-57" class="d">-                                ),
</a><a href="#h62-0-58" id="h62-0-58" class="d">-                                &quot;id&quot;,
</a><a href="#h62-0-59" id="h62-0-59" class="i">+                Field(
</a><a href="#h62-0-60" id="h62-0-60" class="i">+                    8,
</a><a href="#h62-0-61" id="h62-0-61" class="i">+                    Some(
</a><a href="#h62-0-62" id="h62-0-62" class="i">+                        (
</a><a href="#h62-0-63" id="h62-0-63" class="i">+                            Some(
</a><a href="#h62-0-64" id="h62-0-64" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h62-0-66" id="h62-0-66" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h62-0-69" id="h62-0-69" class="d">-                    None,
</a>                 ),
<a href="#h62-0-71" id="h62-0-71" class="d">-                (
</a><a href="#h62-0-72" id="h62-0-72" class="d">-                    Field(
</a><a href="#h62-0-73" id="h62-0-73" class="d">-                        1,
</a><a href="#h62-0-74" id="h62-0-74" class="d">-                        Some(
</a><a href="#h62-0-75" id="h62-0-75" class="d">-                            (
</a><a href="#h62-0-76" id="h62-0-76" class="d">-                                Some(
</a><a href="#h62-0-77" id="h62-0-77" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-0-78" id="h62-0-78" class="d">-                                ),
</a><a href="#h62-0-79" id="h62-0-79" class="d">-                                &quot;title&quot;,
</a><a href="#h62-0-80" id="h62-0-80" class="i">+                Field(
</a><a href="#h62-0-81" id="h62-0-81" class="i">+                    0,
</a><a href="#h62-0-82" id="h62-0-82" class="i">+                    Some(
</a><a href="#h62-0-83" id="h62-0-83" class="i">+                        (
</a><a href="#h62-0-84" id="h62-0-84" class="i">+                            Some(
</a><a href="#h62-0-85" id="h62-0-85" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-0-87" id="h62-0-87" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h62-0-90" id="h62-0-90" class="d">-                    None,
</a>                 ),
<a href="#h62-0-92" id="h62-0-92" class="d">-                (
</a><a href="#h62-0-93" id="h62-0-93" class="d">-                    Field(
</a><a href="#h62-0-94" id="h62-0-94" class="d">-                        2,
</a><a href="#h62-0-95" id="h62-0-95" class="d">-                        Some(
</a><a href="#h62-0-96" id="h62-0-96" class="d">-                            (
</a><a href="#h62-0-97" id="h62-0-97" class="d">-                                Some(
</a><a href="#h62-0-98" id="h62-0-98" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-0-99" id="h62-0-99" class="d">-                                ),
</a><a href="#h62-0-100" id="h62-0-100" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h62-0-101" id="h62-0-101" class="i">+                Field(
</a><a href="#h62-0-102" id="h62-0-102" class="i">+                    1,
</a><a href="#h62-0-103" id="h62-0-103" class="i">+                    Some(
</a><a href="#h62-0-104" id="h62-0-104" class="i">+                        (
</a><a href="#h62-0-105" id="h62-0-105" class="i">+                            Some(
</a><a href="#h62-0-106" id="h62-0-106" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-0-108" id="h62-0-108" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h62-0-111" id="h62-0-111" class="d">-                    None,
</a>                 ),
<a href="#h62-0-113" id="h62-0-113" class="d">-                (
</a><a href="#h62-0-114" id="h62-0-114" class="d">-                    Field(
</a><a href="#h62-0-115" id="h62-0-115" class="d">-                        3,
</a><a href="#h62-0-116" id="h62-0-116" class="d">-                        Some(
</a><a href="#h62-0-117" id="h62-0-117" class="d">-                            (
</a><a href="#h62-0-118" id="h62-0-118" class="d">-                                Some(
</a><a href="#h62-0-119" id="h62-0-119" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-0-120" id="h62-0-120" class="d">-                                ),
</a><a href="#h62-0-121" id="h62-0-121" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h62-0-122" id="h62-0-122" class="i">+                Field(
</a><a href="#h62-0-123" id="h62-0-123" class="i">+                    2,
</a><a href="#h62-0-124" id="h62-0-124" class="i">+                    Some(
</a><a href="#h62-0-125" id="h62-0-125" class="i">+                        (
</a><a href="#h62-0-126" id="h62-0-126" class="i">+                            Some(
</a><a href="#h62-0-127" id="h62-0-127" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-0-129" id="h62-0-129" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h62-0-132" id="h62-0-132" class="d">-                    None,
</a>                 ),
<a href="#h62-0-134" id="h62-0-134" class="d">-                (
</a><a href="#h62-0-135" id="h62-0-135" class="d">-                    Field(
</a><a href="#h62-0-136" id="h62-0-136" class="d">-                        4,
</a><a href="#h62-0-137" id="h62-0-137" class="d">-                        Some(
</a><a href="#h62-0-138" id="h62-0-138" class="d">-                            (
</a><a href="#h62-0-139" id="h62-0-139" class="d">-                                Some(
</a><a href="#h62-0-140" id="h62-0-140" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-0-141" id="h62-0-141" class="d">-                                ),
</a><a href="#h62-0-142" id="h62-0-142" class="d">-                                &quot;released&quot;,
</a><a href="#h62-0-143" id="h62-0-143" class="i">+                Field(
</a><a href="#h62-0-144" id="h62-0-144" class="i">+                    3,
</a><a href="#h62-0-145" id="h62-0-145" class="i">+                    Some(
</a><a href="#h62-0-146" id="h62-0-146" class="i">+                        (
</a><a href="#h62-0-147" id="h62-0-147" class="i">+                            Some(
</a><a href="#h62-0-148" id="h62-0-148" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-0-150" id="h62-0-150" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h62-0-153" id="h62-0-153" class="d">-                    None,
</a>                 ),
<a href="#h62-0-155" id="h62-0-155" class="d">-                (
</a><a href="#h62-0-156" id="h62-0-156" class="d">-                    Field(
</a><a href="#h62-0-157" id="h62-0-157" class="d">-                        5,
</a><a href="#h62-0-158" id="h62-0-158" class="d">-                        Some(
</a><a href="#h62-0-159" id="h62-0-159" class="d">-                            (
</a><a href="#h62-0-160" id="h62-0-160" class="d">-                                Some(
</a><a href="#h62-0-161" id="h62-0-161" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-0-162" id="h62-0-162" class="d">-                                ),
</a><a href="#h62-0-163" id="h62-0-163" class="d">-                                &quot;rating&quot;,
</a><a href="#h62-0-164" id="h62-0-164" class="i">+                Field(
</a><a href="#h62-0-165" id="h62-0-165" class="i">+                    4,
</a><a href="#h62-0-166" id="h62-0-166" class="i">+                    Some(
</a><a href="#h62-0-167" id="h62-0-167" class="i">+                        (
</a><a href="#h62-0-168" id="h62-0-168" class="i">+                            Some(
</a><a href="#h62-0-169" id="h62-0-169" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-0-171" id="h62-0-171" class="i">+                            &quot;released&quot;,
</a>                         ),
                     ),
<a href="#h62-0-174" id="h62-0-174" class="d">-                    None,
</a>                 ),
<a href="#h62-0-176" id="h62-0-176" class="d">-                (
</a><a href="#h62-0-177" id="h62-0-177" class="d">-                    Field(
</a><a href="#h62-0-178" id="h62-0-178" class="d">-                        6,
</a><a href="#h62-0-179" id="h62-0-179" class="d">-                        Some(
</a><a href="#h62-0-180" id="h62-0-180" class="d">-                            (
</a><a href="#h62-0-181" id="h62-0-181" class="d">-                                Some(
</a><a href="#h62-0-182" id="h62-0-182" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-0-183" id="h62-0-183" class="d">-                                ),
</a><a href="#h62-0-184" id="h62-0-184" class="d">-                                &quot;ultrahd&quot;,
</a><a href="#h62-0-185" id="h62-0-185" class="i">+                Field(
</a><a href="#h62-0-186" id="h62-0-186" class="i">+                    5,
</a><a href="#h62-0-187" id="h62-0-187" class="i">+                    Some(
</a><a href="#h62-0-188" id="h62-0-188" class="i">+                        (
</a><a href="#h62-0-189" id="h62-0-189" class="i">+                            Some(
</a><a href="#h62-0-190" id="h62-0-190" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-0-192" id="h62-0-192" class="i">+                            &quot;rating&quot;,
</a>                         ),
                     ),
<a href="#h62-0-195" id="h62-0-195" class="d">-                    None,
</a>                 ),
<a href="#h62-0-197" id="h62-0-197" class="d">-            ],
</a><a href="#h62-0-198" id="h62-0-198" class="d">-        },
</a><a href="#h62-0-199" id="h62-0-199" class="d">-        expressions: [
</a><a href="#h62-0-200" id="h62-0-200" class="d">-            (
</a>                 Field(
<a href="#h62-0-202" id="h62-0-202" class="d">-                    0,
</a><a href="#h62-0-203" id="h62-0-203" class="i">+                    6,
</a>                     Some(
                         (
                             Some(
<a href="#h62-0-207" id="h62-0-207" class="d">-                                &quot;g&quot;,
</a><a href="#h62-0-208" id="h62-0-208" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-0-210" id="h62-0-210" class="d">-                            &quot;id&quot;,
</a><a href="#h62-0-211" id="h62-0-211" class="i">+                            &quot;ultrahd&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h62-0-215" id="h62-0-215" class="d">-                Some(
</a><a href="#h62-0-216" id="h62-0-216" class="i">+            ],
</a><a href="#h62-0-217" id="h62-0-217" class="i">+        },
</a><a href="#h62-0-218" id="h62-0-218" class="i">+        labels: [
</a><a href="#h62-0-219" id="h62-0-219" class="i">+            Some(
</a><a href="#h62-0-220" id="h62-0-220" class="i">+                (
</a><a href="#h62-0-221" id="h62-0-221" class="i">+                    None,
</a>                     &quot;genre_id&quot;,
                 ),
             ),
<a href="#h62-0-225" id="h62-0-225" class="d">-            (
</a><a href="#h62-0-226" id="h62-0-226" class="d">-                Field(
</a><a href="#h62-0-227" id="h62-0-227" class="d">-                    2,
</a><a href="#h62-0-228" id="h62-0-228" class="d">-                    Some(
</a><a href="#h62-0-229" id="h62-0-229" class="d">-                        (
</a><a href="#h62-0-230" id="h62-0-230" class="d">-                            Some(
</a><a href="#h62-0-231" id="h62-0-231" class="d">-                                &quot;m&quot;,
</a><a href="#h62-0-232" id="h62-0-232" class="d">-                            ),
</a><a href="#h62-0-233" id="h62-0-233" class="d">-                            &quot;id&quot;,
</a><a href="#h62-0-234" id="h62-0-234" class="i">+            Some(
</a><a href="#h62-0-235" id="h62-0-235" class="i">+                (
</a><a href="#h62-0-236" id="h62-0-236" class="i">+                    None,
</a><a href="#h62-0-237" id="h62-0-237" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h62-0-238" id="h62-0-238" class="i">+                ),
</a><a href="#h62-0-239" id="h62-0-239" class="i">+            ),
</a><a href="#h62-0-240" id="h62-0-240" class="i">+        ],
</a><a href="#h62-0-241" id="h62-0-241" class="i">+        expressions: [
</a><a href="#h62-0-242" id="h62-0-242" class="i">+            Field(
</a><a href="#h62-0-243" id="h62-0-243" class="i">+                0,
</a><a href="#h62-0-244" id="h62-0-244" class="i">+                Some(
</a><a href="#h62-0-245" id="h62-0-245" class="i">+                    (
</a><a href="#h62-0-246" id="h62-0-246" class="i">+                        Some(
</a><a href="#h62-0-247" id="h62-0-247" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h62-0-249" id="h62-0-249" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h62-0-252" id="h62-0-252" class="i">+            ),
</a><a href="#h62-0-253" id="h62-0-253" class="i">+            Field(
</a><a href="#h62-0-254" id="h62-0-254" class="i">+                2,
</a>                 Some(
<a href="#h62-0-256" id="h62-0-256" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h62-0-257" id="h62-0-257" class="i">+                    (
</a><a href="#h62-0-258" id="h62-0-258" class="i">+                        Some(
</a><a href="#h62-0-259" id="h62-0-259" class="i">+                            &quot;m&quot;,
</a><a href="#h62-0-260" id="h62-0-260" class="i">+                        ),
</a><a href="#h62-0-261" id="h62-0-261" class="i">+                        &quot;id&quot;,
</a><a href="#h62-0-262" id="h62-0-262" class="i">+                    ),
</a>                 ),
             ),
         ],
<a href="#h62-1" id="h62-1" class="h">@@ -540,166 +528,154 @@ Optimized plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h62-1-3" id="h62-1-3" class="i">+            labels: [
</a><a href="#h62-1-4" id="h62-1-4" class="i">+                None,
</a><a href="#h62-1-5" id="h62-1-5" class="i">+                None,
</a><a href="#h62-1-6" id="h62-1-6" class="i">+                None,
</a><a href="#h62-1-7" id="h62-1-7" class="i">+                None,
</a><a href="#h62-1-8" id="h62-1-8" class="i">+                None,
</a><a href="#h62-1-9" id="h62-1-9" class="i">+                None,
</a><a href="#h62-1-10" id="h62-1-10" class="i">+                None,
</a><a href="#h62-1-11" id="h62-1-11" class="i">+                None,
</a><a href="#h62-1-12" id="h62-1-12" class="i">+                None,
</a><a href="#h62-1-13" id="h62-1-13" class="i">+            ],
</a>             expressions: [
<a href="#h62-1-15" id="h62-1-15" class="d">-                (
</a><a href="#h62-1-16" id="h62-1-16" class="d">-                    Field(
</a><a href="#h62-1-17" id="h62-1-17" class="d">-                        7,
</a><a href="#h62-1-18" id="h62-1-18" class="d">-                        Some(
</a><a href="#h62-1-19" id="h62-1-19" class="d">-                            (
</a><a href="#h62-1-20" id="h62-1-20" class="d">-                                Some(
</a><a href="#h62-1-21" id="h62-1-21" class="d">-                                    &quot;g&quot;,
</a><a href="#h62-1-22" id="h62-1-22" class="d">-                                ),
</a><a href="#h62-1-23" id="h62-1-23" class="d">-                                &quot;id&quot;,
</a><a href="#h62-1-24" id="h62-1-24" class="d">-                            ),
</a><a href="#h62-1-25" id="h62-1-25" class="d">-                        ),
</a><a href="#h62-1-26" id="h62-1-26" class="d">-                    ),
</a><a href="#h62-1-27" id="h62-1-27" class="d">-                    None,
</a><a href="#h62-1-28" id="h62-1-28" class="d">-                ),
</a><a href="#h62-1-29" id="h62-1-29" class="d">-                (
</a><a href="#h62-1-30" id="h62-1-30" class="d">-                    Field(
</a><a href="#h62-1-31" id="h62-1-31" class="d">-                        8,
</a><a href="#h62-1-32" id="h62-1-32" class="d">-                        Some(
</a><a href="#h62-1-33" id="h62-1-33" class="d">-                            (
</a><a href="#h62-1-34" id="h62-1-34" class="d">-                                Some(
</a><a href="#h62-1-35" id="h62-1-35" class="d">-                                    &quot;g&quot;,
</a><a href="#h62-1-36" id="h62-1-36" class="d">-                                ),
</a><a href="#h62-1-37" id="h62-1-37" class="d">-                                &quot;name&quot;,
</a><a href="#h62-1-38" id="h62-1-38" class="i">+                Field(
</a><a href="#h62-1-39" id="h62-1-39" class="i">+                    7,
</a><a href="#h62-1-40" id="h62-1-40" class="i">+                    Some(
</a><a href="#h62-1-41" id="h62-1-41" class="i">+                        (
</a><a href="#h62-1-42" id="h62-1-42" class="i">+                            Some(
</a><a href="#h62-1-43" id="h62-1-43" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h62-1-45" id="h62-1-45" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h62-1-48" id="h62-1-48" class="d">-                    None,
</a>                 ),
<a href="#h62-1-50" id="h62-1-50" class="d">-                (
</a><a href="#h62-1-51" id="h62-1-51" class="d">-                    Field(
</a><a href="#h62-1-52" id="h62-1-52" class="d">-                        0,
</a><a href="#h62-1-53" id="h62-1-53" class="d">-                        Some(
</a><a href="#h62-1-54" id="h62-1-54" class="d">-                            (
</a><a href="#h62-1-55" id="h62-1-55" class="d">-                                Some(
</a><a href="#h62-1-56" id="h62-1-56" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-1-57" id="h62-1-57" class="d">-                                ),
</a><a href="#h62-1-58" id="h62-1-58" class="d">-                                &quot;id&quot;,
</a><a href="#h62-1-59" id="h62-1-59" class="i">+                Field(
</a><a href="#h62-1-60" id="h62-1-60" class="i">+                    8,
</a><a href="#h62-1-61" id="h62-1-61" class="i">+                    Some(
</a><a href="#h62-1-62" id="h62-1-62" class="i">+                        (
</a><a href="#h62-1-63" id="h62-1-63" class="i">+                            Some(
</a><a href="#h62-1-64" id="h62-1-64" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h62-1-66" id="h62-1-66" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h62-1-69" id="h62-1-69" class="d">-                    None,
</a>                 ),
<a href="#h62-1-71" id="h62-1-71" class="d">-                (
</a><a href="#h62-1-72" id="h62-1-72" class="d">-                    Field(
</a><a href="#h62-1-73" id="h62-1-73" class="d">-                        1,
</a><a href="#h62-1-74" id="h62-1-74" class="d">-                        Some(
</a><a href="#h62-1-75" id="h62-1-75" class="d">-                            (
</a><a href="#h62-1-76" id="h62-1-76" class="d">-                                Some(
</a><a href="#h62-1-77" id="h62-1-77" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-1-78" id="h62-1-78" class="d">-                                ),
</a><a href="#h62-1-79" id="h62-1-79" class="d">-                                &quot;title&quot;,
</a><a href="#h62-1-80" id="h62-1-80" class="i">+                Field(
</a><a href="#h62-1-81" id="h62-1-81" class="i">+                    0,
</a><a href="#h62-1-82" id="h62-1-82" class="i">+                    Some(
</a><a href="#h62-1-83" id="h62-1-83" class="i">+                        (
</a><a href="#h62-1-84" id="h62-1-84" class="i">+                            Some(
</a><a href="#h62-1-85" id="h62-1-85" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-1-87" id="h62-1-87" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h62-1-90" id="h62-1-90" class="d">-                    None,
</a>                 ),
<a href="#h62-1-92" id="h62-1-92" class="d">-                (
</a><a href="#h62-1-93" id="h62-1-93" class="d">-                    Field(
</a><a href="#h62-1-94" id="h62-1-94" class="d">-                        2,
</a><a href="#h62-1-95" id="h62-1-95" class="d">-                        Some(
</a><a href="#h62-1-96" id="h62-1-96" class="d">-                            (
</a><a href="#h62-1-97" id="h62-1-97" class="d">-                                Some(
</a><a href="#h62-1-98" id="h62-1-98" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-1-99" id="h62-1-99" class="d">-                                ),
</a><a href="#h62-1-100" id="h62-1-100" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h62-1-101" id="h62-1-101" class="i">+                Field(
</a><a href="#h62-1-102" id="h62-1-102" class="i">+                    1,
</a><a href="#h62-1-103" id="h62-1-103" class="i">+                    Some(
</a><a href="#h62-1-104" id="h62-1-104" class="i">+                        (
</a><a href="#h62-1-105" id="h62-1-105" class="i">+                            Some(
</a><a href="#h62-1-106" id="h62-1-106" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-1-108" id="h62-1-108" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h62-1-111" id="h62-1-111" class="d">-                    None,
</a>                 ),
<a href="#h62-1-113" id="h62-1-113" class="d">-                (
</a><a href="#h62-1-114" id="h62-1-114" class="d">-                    Field(
</a><a href="#h62-1-115" id="h62-1-115" class="d">-                        3,
</a><a href="#h62-1-116" id="h62-1-116" class="d">-                        Some(
</a><a href="#h62-1-117" id="h62-1-117" class="d">-                            (
</a><a href="#h62-1-118" id="h62-1-118" class="d">-                                Some(
</a><a href="#h62-1-119" id="h62-1-119" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-1-120" id="h62-1-120" class="d">-                                ),
</a><a href="#h62-1-121" id="h62-1-121" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h62-1-122" id="h62-1-122" class="i">+                Field(
</a><a href="#h62-1-123" id="h62-1-123" class="i">+                    2,
</a><a href="#h62-1-124" id="h62-1-124" class="i">+                    Some(
</a><a href="#h62-1-125" id="h62-1-125" class="i">+                        (
</a><a href="#h62-1-126" id="h62-1-126" class="i">+                            Some(
</a><a href="#h62-1-127" id="h62-1-127" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-1-129" id="h62-1-129" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h62-1-132" id="h62-1-132" class="d">-                    None,
</a>                 ),
<a href="#h62-1-134" id="h62-1-134" class="d">-                (
</a><a href="#h62-1-135" id="h62-1-135" class="d">-                    Field(
</a><a href="#h62-1-136" id="h62-1-136" class="d">-                        4,
</a><a href="#h62-1-137" id="h62-1-137" class="d">-                        Some(
</a><a href="#h62-1-138" id="h62-1-138" class="d">-                            (
</a><a href="#h62-1-139" id="h62-1-139" class="d">-                                Some(
</a><a href="#h62-1-140" id="h62-1-140" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-1-141" id="h62-1-141" class="d">-                                ),
</a><a href="#h62-1-142" id="h62-1-142" class="d">-                                &quot;released&quot;,
</a><a href="#h62-1-143" id="h62-1-143" class="i">+                Field(
</a><a href="#h62-1-144" id="h62-1-144" class="i">+                    3,
</a><a href="#h62-1-145" id="h62-1-145" class="i">+                    Some(
</a><a href="#h62-1-146" id="h62-1-146" class="i">+                        (
</a><a href="#h62-1-147" id="h62-1-147" class="i">+                            Some(
</a><a href="#h62-1-148" id="h62-1-148" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-1-150" id="h62-1-150" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h62-1-153" id="h62-1-153" class="d">-                    None,
</a>                 ),
<a href="#h62-1-155" id="h62-1-155" class="d">-                (
</a><a href="#h62-1-156" id="h62-1-156" class="d">-                    Field(
</a><a href="#h62-1-157" id="h62-1-157" class="d">-                        5,
</a><a href="#h62-1-158" id="h62-1-158" class="d">-                        Some(
</a><a href="#h62-1-159" id="h62-1-159" class="d">-                            (
</a><a href="#h62-1-160" id="h62-1-160" class="d">-                                Some(
</a><a href="#h62-1-161" id="h62-1-161" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-1-162" id="h62-1-162" class="d">-                                ),
</a><a href="#h62-1-163" id="h62-1-163" class="d">-                                &quot;rating&quot;,
</a><a href="#h62-1-164" id="h62-1-164" class="i">+                Field(
</a><a href="#h62-1-165" id="h62-1-165" class="i">+                    4,
</a><a href="#h62-1-166" id="h62-1-166" class="i">+                    Some(
</a><a href="#h62-1-167" id="h62-1-167" class="i">+                        (
</a><a href="#h62-1-168" id="h62-1-168" class="i">+                            Some(
</a><a href="#h62-1-169" id="h62-1-169" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-1-171" id="h62-1-171" class="i">+                            &quot;released&quot;,
</a>                         ),
                     ),
<a href="#h62-1-174" id="h62-1-174" class="d">-                    None,
</a>                 ),
<a href="#h62-1-176" id="h62-1-176" class="d">-                (
</a><a href="#h62-1-177" id="h62-1-177" class="d">-                    Field(
</a><a href="#h62-1-178" id="h62-1-178" class="d">-                        6,
</a><a href="#h62-1-179" id="h62-1-179" class="d">-                        Some(
</a><a href="#h62-1-180" id="h62-1-180" class="d">-                            (
</a><a href="#h62-1-181" id="h62-1-181" class="d">-                                Some(
</a><a href="#h62-1-182" id="h62-1-182" class="d">-                                    &quot;m&quot;,
</a><a href="#h62-1-183" id="h62-1-183" class="d">-                                ),
</a><a href="#h62-1-184" id="h62-1-184" class="d">-                                &quot;ultrahd&quot;,
</a><a href="#h62-1-185" id="h62-1-185" class="i">+                Field(
</a><a href="#h62-1-186" id="h62-1-186" class="i">+                    5,
</a><a href="#h62-1-187" id="h62-1-187" class="i">+                    Some(
</a><a href="#h62-1-188" id="h62-1-188" class="i">+                        (
</a><a href="#h62-1-189" id="h62-1-189" class="i">+                            Some(
</a><a href="#h62-1-190" id="h62-1-190" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-1-192" id="h62-1-192" class="i">+                            &quot;rating&quot;,
</a>                         ),
                     ),
<a href="#h62-1-195" id="h62-1-195" class="d">-                    None,
</a>                 ),
<a href="#h62-1-197" id="h62-1-197" class="d">-            ],
</a><a href="#h62-1-198" id="h62-1-198" class="d">-        },
</a><a href="#h62-1-199" id="h62-1-199" class="d">-        expressions: [
</a><a href="#h62-1-200" id="h62-1-200" class="d">-            (
</a>                 Field(
<a href="#h62-1-202" id="h62-1-202" class="d">-                    0,
</a><a href="#h62-1-203" id="h62-1-203" class="i">+                    6,
</a>                     Some(
                         (
                             Some(
<a href="#h62-1-207" id="h62-1-207" class="d">-                                &quot;g&quot;,
</a><a href="#h62-1-208" id="h62-1-208" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h62-1-210" id="h62-1-210" class="d">-                            &quot;id&quot;,
</a><a href="#h62-1-211" id="h62-1-211" class="i">+                            &quot;ultrahd&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h62-1-215" id="h62-1-215" class="d">-                Some(
</a><a href="#h62-1-216" id="h62-1-216" class="i">+            ],
</a><a href="#h62-1-217" id="h62-1-217" class="i">+        },
</a><a href="#h62-1-218" id="h62-1-218" class="i">+        labels: [
</a><a href="#h62-1-219" id="h62-1-219" class="i">+            Some(
</a><a href="#h62-1-220" id="h62-1-220" class="i">+                (
</a><a href="#h62-1-221" id="h62-1-221" class="i">+                    None,
</a>                     &quot;genre_id&quot;,
                 ),
             ),
<a href="#h62-1-225" id="h62-1-225" class="d">-            (
</a><a href="#h62-1-226" id="h62-1-226" class="d">-                Field(
</a><a href="#h62-1-227" id="h62-1-227" class="d">-                    2,
</a><a href="#h62-1-228" id="h62-1-228" class="d">-                    Some(
</a><a href="#h62-1-229" id="h62-1-229" class="d">-                        (
</a><a href="#h62-1-230" id="h62-1-230" class="d">-                            Some(
</a><a href="#h62-1-231" id="h62-1-231" class="d">-                                &quot;m&quot;,
</a><a href="#h62-1-232" id="h62-1-232" class="d">-                            ),
</a><a href="#h62-1-233" id="h62-1-233" class="d">-                            &quot;id&quot;,
</a><a href="#h62-1-234" id="h62-1-234" class="i">+            Some(
</a><a href="#h62-1-235" id="h62-1-235" class="i">+                (
</a><a href="#h62-1-236" id="h62-1-236" class="i">+                    None,
</a><a href="#h62-1-237" id="h62-1-237" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h62-1-238" id="h62-1-238" class="i">+                ),
</a><a href="#h62-1-239" id="h62-1-239" class="i">+            ),
</a><a href="#h62-1-240" id="h62-1-240" class="i">+        ],
</a><a href="#h62-1-241" id="h62-1-241" class="i">+        expressions: [
</a><a href="#h62-1-242" id="h62-1-242" class="i">+            Field(
</a><a href="#h62-1-243" id="h62-1-243" class="i">+                0,
</a><a href="#h62-1-244" id="h62-1-244" class="i">+                Some(
</a><a href="#h62-1-245" id="h62-1-245" class="i">+                    (
</a><a href="#h62-1-246" id="h62-1-246" class="i">+                        Some(
</a><a href="#h62-1-247" id="h62-1-247" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h62-1-249" id="h62-1-249" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h62-1-252" id="h62-1-252" class="i">+            ),
</a><a href="#h62-1-253" id="h62-1-253" class="i">+            Field(
</a><a href="#h62-1-254" id="h62-1-254" class="i">+                2,
</a>                 Some(
<a href="#h62-1-256" id="h62-1-256" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h62-1-257" id="h62-1-257" class="i">+                    (
</a><a href="#h62-1-258" id="h62-1-258" class="i">+                        Some(
</a><a href="#h62-1-259" id="h62-1-259" class="i">+                            &quot;m&quot;,
</a><a href="#h62-1-260" id="h62-1-260" class="i">+                        ),
</a><a href="#h62-1-261" id="h62-1-261" class="i">+                        &quot;id&quot;,
</a><a href="#h62-1-262" id="h62-1-262" class="i">+                    ),
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h63" href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a> b/<a href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -208,132 +208,116 @@ Plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h63-0-3" id="h63-0-3" class="i">+        labels: [
</a><a href="#h63-0-4" id="h63-0-4" class="i">+            None,
</a><a href="#h63-0-5" id="h63-0-5" class="i">+            None,
</a><a href="#h63-0-6" id="h63-0-6" class="i">+            None,
</a><a href="#h63-0-7" id="h63-0-7" class="i">+            None,
</a><a href="#h63-0-8" id="h63-0-8" class="i">+            None,
</a><a href="#h63-0-9" id="h63-0-9" class="i">+            None,
</a><a href="#h63-0-10" id="h63-0-10" class="i">+            None,
</a><a href="#h63-0-11" id="h63-0-11" class="i">+            None,
</a><a href="#h63-0-12" id="h63-0-12" class="i">+            None,
</a><a href="#h63-0-13" id="h63-0-13" class="i">+        ],
</a>         expressions: [
<a href="#h63-0-15" id="h63-0-15" class="d">-            (
</a><a href="#h63-0-16" id="h63-0-16" class="d">-                Field(
</a><a href="#h63-0-17" id="h63-0-17" class="d">-                    7,
</a><a href="#h63-0-18" id="h63-0-18" class="d">-                    Some(
</a><a href="#h63-0-19" id="h63-0-19" class="d">-                        (
</a><a href="#h63-0-20" id="h63-0-20" class="d">-                            Some(
</a><a href="#h63-0-21" id="h63-0-21" class="d">-                                &quot;g&quot;,
</a><a href="#h63-0-22" id="h63-0-22" class="d">-                            ),
</a><a href="#h63-0-23" id="h63-0-23" class="d">-                            &quot;id&quot;,
</a><a href="#h63-0-24" id="h63-0-24" class="i">+            Field(
</a><a href="#h63-0-25" id="h63-0-25" class="i">+                7,
</a><a href="#h63-0-26" id="h63-0-26" class="i">+                Some(
</a><a href="#h63-0-27" id="h63-0-27" class="i">+                    (
</a><a href="#h63-0-28" id="h63-0-28" class="i">+                        Some(
</a><a href="#h63-0-29" id="h63-0-29" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h63-0-31" id="h63-0-31" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h63-0-34" id="h63-0-34" class="d">-                None,
</a>             ),
<a href="#h63-0-36" id="h63-0-36" class="d">-            (
</a><a href="#h63-0-37" id="h63-0-37" class="d">-                Field(
</a><a href="#h63-0-38" id="h63-0-38" class="d">-                    8,
</a><a href="#h63-0-39" id="h63-0-39" class="d">-                    Some(
</a><a href="#h63-0-40" id="h63-0-40" class="d">-                        (
</a><a href="#h63-0-41" id="h63-0-41" class="d">-                            Some(
</a><a href="#h63-0-42" id="h63-0-42" class="d">-                                &quot;g&quot;,
</a><a href="#h63-0-43" id="h63-0-43" class="d">-                            ),
</a><a href="#h63-0-44" id="h63-0-44" class="d">-                            &quot;name&quot;,
</a><a href="#h63-0-45" id="h63-0-45" class="i">+            Field(
</a><a href="#h63-0-46" id="h63-0-46" class="i">+                8,
</a><a href="#h63-0-47" id="h63-0-47" class="i">+                Some(
</a><a href="#h63-0-48" id="h63-0-48" class="i">+                    (
</a><a href="#h63-0-49" id="h63-0-49" class="i">+                        Some(
</a><a href="#h63-0-50" id="h63-0-50" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h63-0-52" id="h63-0-52" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h63-0-55" id="h63-0-55" class="d">-                None,
</a>             ),
<a href="#h63-0-57" id="h63-0-57" class="d">-            (
</a><a href="#h63-0-58" id="h63-0-58" class="d">-                Field(
</a><a href="#h63-0-59" id="h63-0-59" class="d">-                    0,
</a><a href="#h63-0-60" id="h63-0-60" class="d">-                    Some(
</a><a href="#h63-0-61" id="h63-0-61" class="d">-                        (
</a><a href="#h63-0-62" id="h63-0-62" class="d">-                            Some(
</a><a href="#h63-0-63" id="h63-0-63" class="d">-                                &quot;m&quot;,
</a><a href="#h63-0-64" id="h63-0-64" class="d">-                            ),
</a><a href="#h63-0-65" id="h63-0-65" class="d">-                            &quot;id&quot;,
</a><a href="#h63-0-66" id="h63-0-66" class="i">+            Field(
</a><a href="#h63-0-67" id="h63-0-67" class="i">+                0,
</a><a href="#h63-0-68" id="h63-0-68" class="i">+                Some(
</a><a href="#h63-0-69" id="h63-0-69" class="i">+                    (
</a><a href="#h63-0-70" id="h63-0-70" class="i">+                        Some(
</a><a href="#h63-0-71" id="h63-0-71" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-0-73" id="h63-0-73" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h63-0-76" id="h63-0-76" class="d">-                None,
</a>             ),
<a href="#h63-0-78" id="h63-0-78" class="d">-            (
</a><a href="#h63-0-79" id="h63-0-79" class="d">-                Field(
</a><a href="#h63-0-80" id="h63-0-80" class="d">-                    1,
</a><a href="#h63-0-81" id="h63-0-81" class="d">-                    Some(
</a><a href="#h63-0-82" id="h63-0-82" class="d">-                        (
</a><a href="#h63-0-83" id="h63-0-83" class="d">-                            Some(
</a><a href="#h63-0-84" id="h63-0-84" class="d">-                                &quot;m&quot;,
</a><a href="#h63-0-85" id="h63-0-85" class="d">-                            ),
</a><a href="#h63-0-86" id="h63-0-86" class="d">-                            &quot;title&quot;,
</a><a href="#h63-0-87" id="h63-0-87" class="i">+            Field(
</a><a href="#h63-0-88" id="h63-0-88" class="i">+                1,
</a><a href="#h63-0-89" id="h63-0-89" class="i">+                Some(
</a><a href="#h63-0-90" id="h63-0-90" class="i">+                    (
</a><a href="#h63-0-91" id="h63-0-91" class="i">+                        Some(
</a><a href="#h63-0-92" id="h63-0-92" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-0-94" id="h63-0-94" class="i">+                        &quot;title&quot;,
</a>                     ),
                 ),
<a href="#h63-0-97" id="h63-0-97" class="d">-                None,
</a>             ),
<a href="#h63-0-99" id="h63-0-99" class="d">-            (
</a><a href="#h63-0-100" id="h63-0-100" class="d">-                Field(
</a><a href="#h63-0-101" id="h63-0-101" class="d">-                    2,
</a><a href="#h63-0-102" id="h63-0-102" class="d">-                    Some(
</a><a href="#h63-0-103" id="h63-0-103" class="d">-                        (
</a><a href="#h63-0-104" id="h63-0-104" class="d">-                            Some(
</a><a href="#h63-0-105" id="h63-0-105" class="d">-                                &quot;m&quot;,
</a><a href="#h63-0-106" id="h63-0-106" class="d">-                            ),
</a><a href="#h63-0-107" id="h63-0-107" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h63-0-108" id="h63-0-108" class="i">+            Field(
</a><a href="#h63-0-109" id="h63-0-109" class="i">+                2,
</a><a href="#h63-0-110" id="h63-0-110" class="i">+                Some(
</a><a href="#h63-0-111" id="h63-0-111" class="i">+                    (
</a><a href="#h63-0-112" id="h63-0-112" class="i">+                        Some(
</a><a href="#h63-0-113" id="h63-0-113" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-0-115" id="h63-0-115" class="i">+                        &quot;studio_id&quot;,
</a>                     ),
                 ),
<a href="#h63-0-118" id="h63-0-118" class="d">-                None,
</a>             ),
<a href="#h63-0-120" id="h63-0-120" class="d">-            (
</a><a href="#h63-0-121" id="h63-0-121" class="d">-                Field(
</a><a href="#h63-0-122" id="h63-0-122" class="d">-                    3,
</a><a href="#h63-0-123" id="h63-0-123" class="d">-                    Some(
</a><a href="#h63-0-124" id="h63-0-124" class="d">-                        (
</a><a href="#h63-0-125" id="h63-0-125" class="d">-                            Some(
</a><a href="#h63-0-126" id="h63-0-126" class="d">-                                &quot;m&quot;,
</a><a href="#h63-0-127" id="h63-0-127" class="d">-                            ),
</a><a href="#h63-0-128" id="h63-0-128" class="d">-                            &quot;genre_id&quot;,
</a><a href="#h63-0-129" id="h63-0-129" class="i">+            Field(
</a><a href="#h63-0-130" id="h63-0-130" class="i">+                3,
</a><a href="#h63-0-131" id="h63-0-131" class="i">+                Some(
</a><a href="#h63-0-132" id="h63-0-132" class="i">+                    (
</a><a href="#h63-0-133" id="h63-0-133" class="i">+                        Some(
</a><a href="#h63-0-134" id="h63-0-134" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-0-136" id="h63-0-136" class="i">+                        &quot;genre_id&quot;,
</a>                     ),
                 ),
<a href="#h63-0-139" id="h63-0-139" class="d">-                None,
</a>             ),
<a href="#h63-0-141" id="h63-0-141" class="d">-            (
</a><a href="#h63-0-142" id="h63-0-142" class="d">-                Field(
</a><a href="#h63-0-143" id="h63-0-143" class="d">-                    4,
</a><a href="#h63-0-144" id="h63-0-144" class="d">-                    Some(
</a><a href="#h63-0-145" id="h63-0-145" class="d">-                        (
</a><a href="#h63-0-146" id="h63-0-146" class="d">-                            Some(
</a><a href="#h63-0-147" id="h63-0-147" class="d">-                                &quot;m&quot;,
</a><a href="#h63-0-148" id="h63-0-148" class="d">-                            ),
</a><a href="#h63-0-149" id="h63-0-149" class="d">-                            &quot;released&quot;,
</a><a href="#h63-0-150" id="h63-0-150" class="i">+            Field(
</a><a href="#h63-0-151" id="h63-0-151" class="i">+                4,
</a><a href="#h63-0-152" id="h63-0-152" class="i">+                Some(
</a><a href="#h63-0-153" id="h63-0-153" class="i">+                    (
</a><a href="#h63-0-154" id="h63-0-154" class="i">+                        Some(
</a><a href="#h63-0-155" id="h63-0-155" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-0-157" id="h63-0-157" class="i">+                        &quot;released&quot;,
</a>                     ),
                 ),
<a href="#h63-0-160" id="h63-0-160" class="d">-                None,
</a>             ),
<a href="#h63-0-162" id="h63-0-162" class="d">-            (
</a><a href="#h63-0-163" id="h63-0-163" class="d">-                Field(
</a><a href="#h63-0-164" id="h63-0-164" class="d">-                    5,
</a><a href="#h63-0-165" id="h63-0-165" class="d">-                    Some(
</a><a href="#h63-0-166" id="h63-0-166" class="d">-                        (
</a><a href="#h63-0-167" id="h63-0-167" class="d">-                            Some(
</a><a href="#h63-0-168" id="h63-0-168" class="d">-                                &quot;m&quot;,
</a><a href="#h63-0-169" id="h63-0-169" class="d">-                            ),
</a><a href="#h63-0-170" id="h63-0-170" class="d">-                            &quot;rating&quot;,
</a><a href="#h63-0-171" id="h63-0-171" class="i">+            Field(
</a><a href="#h63-0-172" id="h63-0-172" class="i">+                5,
</a><a href="#h63-0-173" id="h63-0-173" class="i">+                Some(
</a><a href="#h63-0-174" id="h63-0-174" class="i">+                    (
</a><a href="#h63-0-175" id="h63-0-175" class="i">+                        Some(
</a><a href="#h63-0-176" id="h63-0-176" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-0-178" id="h63-0-178" class="i">+                        &quot;rating&quot;,
</a>                     ),
                 ),
<a href="#h63-0-181" id="h63-0-181" class="d">-                None,
</a>             ),
<a href="#h63-0-183" id="h63-0-183" class="d">-            (
</a><a href="#h63-0-184" id="h63-0-184" class="d">-                Field(
</a><a href="#h63-0-185" id="h63-0-185" class="d">-                    6,
</a><a href="#h63-0-186" id="h63-0-186" class="d">-                    Some(
</a><a href="#h63-0-187" id="h63-0-187" class="d">-                        (
</a><a href="#h63-0-188" id="h63-0-188" class="d">-                            Some(
</a><a href="#h63-0-189" id="h63-0-189" class="d">-                                &quot;m&quot;,
</a><a href="#h63-0-190" id="h63-0-190" class="d">-                            ),
</a><a href="#h63-0-191" id="h63-0-191" class="d">-                            &quot;ultrahd&quot;,
</a><a href="#h63-0-192" id="h63-0-192" class="i">+            Field(
</a><a href="#h63-0-193" id="h63-0-193" class="i">+                6,
</a><a href="#h63-0-194" id="h63-0-194" class="i">+                Some(
</a><a href="#h63-0-195" id="h63-0-195" class="i">+                    (
</a><a href="#h63-0-196" id="h63-0-196" class="i">+                        Some(
</a><a href="#h63-0-197" id="h63-0-197" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-0-199" id="h63-0-199" class="i">+                        &quot;ultrahd&quot;,
</a>                     ),
                 ),
<a href="#h63-0-202" id="h63-0-202" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h63-1" id="h63-1" class="h">@@ -479,132 +463,116 @@ Optimized plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h63-1-3" id="h63-1-3" class="i">+        labels: [
</a><a href="#h63-1-4" id="h63-1-4" class="i">+            None,
</a><a href="#h63-1-5" id="h63-1-5" class="i">+            None,
</a><a href="#h63-1-6" id="h63-1-6" class="i">+            None,
</a><a href="#h63-1-7" id="h63-1-7" class="i">+            None,
</a><a href="#h63-1-8" id="h63-1-8" class="i">+            None,
</a><a href="#h63-1-9" id="h63-1-9" class="i">+            None,
</a><a href="#h63-1-10" id="h63-1-10" class="i">+            None,
</a><a href="#h63-1-11" id="h63-1-11" class="i">+            None,
</a><a href="#h63-1-12" id="h63-1-12" class="i">+            None,
</a><a href="#h63-1-13" id="h63-1-13" class="i">+        ],
</a>         expressions: [
<a href="#h63-1-15" id="h63-1-15" class="d">-            (
</a><a href="#h63-1-16" id="h63-1-16" class="d">-                Field(
</a><a href="#h63-1-17" id="h63-1-17" class="d">-                    7,
</a><a href="#h63-1-18" id="h63-1-18" class="d">-                    Some(
</a><a href="#h63-1-19" id="h63-1-19" class="d">-                        (
</a><a href="#h63-1-20" id="h63-1-20" class="d">-                            Some(
</a><a href="#h63-1-21" id="h63-1-21" class="d">-                                &quot;g&quot;,
</a><a href="#h63-1-22" id="h63-1-22" class="d">-                            ),
</a><a href="#h63-1-23" id="h63-1-23" class="d">-                            &quot;id&quot;,
</a><a href="#h63-1-24" id="h63-1-24" class="i">+            Field(
</a><a href="#h63-1-25" id="h63-1-25" class="i">+                7,
</a><a href="#h63-1-26" id="h63-1-26" class="i">+                Some(
</a><a href="#h63-1-27" id="h63-1-27" class="i">+                    (
</a><a href="#h63-1-28" id="h63-1-28" class="i">+                        Some(
</a><a href="#h63-1-29" id="h63-1-29" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h63-1-31" id="h63-1-31" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h63-1-34" id="h63-1-34" class="d">-                None,
</a>             ),
<a href="#h63-1-36" id="h63-1-36" class="d">-            (
</a><a href="#h63-1-37" id="h63-1-37" class="d">-                Field(
</a><a href="#h63-1-38" id="h63-1-38" class="d">-                    8,
</a><a href="#h63-1-39" id="h63-1-39" class="d">-                    Some(
</a><a href="#h63-1-40" id="h63-1-40" class="d">-                        (
</a><a href="#h63-1-41" id="h63-1-41" class="d">-                            Some(
</a><a href="#h63-1-42" id="h63-1-42" class="d">-                                &quot;g&quot;,
</a><a href="#h63-1-43" id="h63-1-43" class="d">-                            ),
</a><a href="#h63-1-44" id="h63-1-44" class="d">-                            &quot;name&quot;,
</a><a href="#h63-1-45" id="h63-1-45" class="i">+            Field(
</a><a href="#h63-1-46" id="h63-1-46" class="i">+                8,
</a><a href="#h63-1-47" id="h63-1-47" class="i">+                Some(
</a><a href="#h63-1-48" id="h63-1-48" class="i">+                    (
</a><a href="#h63-1-49" id="h63-1-49" class="i">+                        Some(
</a><a href="#h63-1-50" id="h63-1-50" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h63-1-52" id="h63-1-52" class="i">+                        &quot;name&quot;,
</a>                     ),
                 ),
<a href="#h63-1-55" id="h63-1-55" class="d">-                None,
</a>             ),
<a href="#h63-1-57" id="h63-1-57" class="d">-            (
</a><a href="#h63-1-58" id="h63-1-58" class="d">-                Field(
</a><a href="#h63-1-59" id="h63-1-59" class="d">-                    0,
</a><a href="#h63-1-60" id="h63-1-60" class="d">-                    Some(
</a><a href="#h63-1-61" id="h63-1-61" class="d">-                        (
</a><a href="#h63-1-62" id="h63-1-62" class="d">-                            Some(
</a><a href="#h63-1-63" id="h63-1-63" class="d">-                                &quot;m&quot;,
</a><a href="#h63-1-64" id="h63-1-64" class="d">-                            ),
</a><a href="#h63-1-65" id="h63-1-65" class="d">-                            &quot;id&quot;,
</a><a href="#h63-1-66" id="h63-1-66" class="i">+            Field(
</a><a href="#h63-1-67" id="h63-1-67" class="i">+                0,
</a><a href="#h63-1-68" id="h63-1-68" class="i">+                Some(
</a><a href="#h63-1-69" id="h63-1-69" class="i">+                    (
</a><a href="#h63-1-70" id="h63-1-70" class="i">+                        Some(
</a><a href="#h63-1-71" id="h63-1-71" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-1-73" id="h63-1-73" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h63-1-76" id="h63-1-76" class="d">-                None,
</a>             ),
<a href="#h63-1-78" id="h63-1-78" class="d">-            (
</a><a href="#h63-1-79" id="h63-1-79" class="d">-                Field(
</a><a href="#h63-1-80" id="h63-1-80" class="d">-                    1,
</a><a href="#h63-1-81" id="h63-1-81" class="d">-                    Some(
</a><a href="#h63-1-82" id="h63-1-82" class="d">-                        (
</a><a href="#h63-1-83" id="h63-1-83" class="d">-                            Some(
</a><a href="#h63-1-84" id="h63-1-84" class="d">-                                &quot;m&quot;,
</a><a href="#h63-1-85" id="h63-1-85" class="d">-                            ),
</a><a href="#h63-1-86" id="h63-1-86" class="d">-                            &quot;title&quot;,
</a><a href="#h63-1-87" id="h63-1-87" class="i">+            Field(
</a><a href="#h63-1-88" id="h63-1-88" class="i">+                1,
</a><a href="#h63-1-89" id="h63-1-89" class="i">+                Some(
</a><a href="#h63-1-90" id="h63-1-90" class="i">+                    (
</a><a href="#h63-1-91" id="h63-1-91" class="i">+                        Some(
</a><a href="#h63-1-92" id="h63-1-92" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-1-94" id="h63-1-94" class="i">+                        &quot;title&quot;,
</a>                     ),
                 ),
<a href="#h63-1-97" id="h63-1-97" class="d">-                None,
</a>             ),
<a href="#h63-1-99" id="h63-1-99" class="d">-            (
</a><a href="#h63-1-100" id="h63-1-100" class="d">-                Field(
</a><a href="#h63-1-101" id="h63-1-101" class="d">-                    2,
</a><a href="#h63-1-102" id="h63-1-102" class="d">-                    Some(
</a><a href="#h63-1-103" id="h63-1-103" class="d">-                        (
</a><a href="#h63-1-104" id="h63-1-104" class="d">-                            Some(
</a><a href="#h63-1-105" id="h63-1-105" class="d">-                                &quot;m&quot;,
</a><a href="#h63-1-106" id="h63-1-106" class="d">-                            ),
</a><a href="#h63-1-107" id="h63-1-107" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h63-1-108" id="h63-1-108" class="i">+            Field(
</a><a href="#h63-1-109" id="h63-1-109" class="i">+                2,
</a><a href="#h63-1-110" id="h63-1-110" class="i">+                Some(
</a><a href="#h63-1-111" id="h63-1-111" class="i">+                    (
</a><a href="#h63-1-112" id="h63-1-112" class="i">+                        Some(
</a><a href="#h63-1-113" id="h63-1-113" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-1-115" id="h63-1-115" class="i">+                        &quot;studio_id&quot;,
</a>                     ),
                 ),
<a href="#h63-1-118" id="h63-1-118" class="d">-                None,
</a>             ),
<a href="#h63-1-120" id="h63-1-120" class="d">-            (
</a><a href="#h63-1-121" id="h63-1-121" class="d">-                Field(
</a><a href="#h63-1-122" id="h63-1-122" class="d">-                    3,
</a><a href="#h63-1-123" id="h63-1-123" class="d">-                    Some(
</a><a href="#h63-1-124" id="h63-1-124" class="d">-                        (
</a><a href="#h63-1-125" id="h63-1-125" class="d">-                            Some(
</a><a href="#h63-1-126" id="h63-1-126" class="d">-                                &quot;m&quot;,
</a><a href="#h63-1-127" id="h63-1-127" class="d">-                            ),
</a><a href="#h63-1-128" id="h63-1-128" class="d">-                            &quot;genre_id&quot;,
</a><a href="#h63-1-129" id="h63-1-129" class="i">+            Field(
</a><a href="#h63-1-130" id="h63-1-130" class="i">+                3,
</a><a href="#h63-1-131" id="h63-1-131" class="i">+                Some(
</a><a href="#h63-1-132" id="h63-1-132" class="i">+                    (
</a><a href="#h63-1-133" id="h63-1-133" class="i">+                        Some(
</a><a href="#h63-1-134" id="h63-1-134" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-1-136" id="h63-1-136" class="i">+                        &quot;genre_id&quot;,
</a>                     ),
                 ),
<a href="#h63-1-139" id="h63-1-139" class="d">-                None,
</a>             ),
<a href="#h63-1-141" id="h63-1-141" class="d">-            (
</a><a href="#h63-1-142" id="h63-1-142" class="d">-                Field(
</a><a href="#h63-1-143" id="h63-1-143" class="d">-                    4,
</a><a href="#h63-1-144" id="h63-1-144" class="d">-                    Some(
</a><a href="#h63-1-145" id="h63-1-145" class="d">-                        (
</a><a href="#h63-1-146" id="h63-1-146" class="d">-                            Some(
</a><a href="#h63-1-147" id="h63-1-147" class="d">-                                &quot;m&quot;,
</a><a href="#h63-1-148" id="h63-1-148" class="d">-                            ),
</a><a href="#h63-1-149" id="h63-1-149" class="d">-                            &quot;released&quot;,
</a><a href="#h63-1-150" id="h63-1-150" class="i">+            Field(
</a><a href="#h63-1-151" id="h63-1-151" class="i">+                4,
</a><a href="#h63-1-152" id="h63-1-152" class="i">+                Some(
</a><a href="#h63-1-153" id="h63-1-153" class="i">+                    (
</a><a href="#h63-1-154" id="h63-1-154" class="i">+                        Some(
</a><a href="#h63-1-155" id="h63-1-155" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-1-157" id="h63-1-157" class="i">+                        &quot;released&quot;,
</a>                     ),
                 ),
<a href="#h63-1-160" id="h63-1-160" class="d">-                None,
</a>             ),
<a href="#h63-1-162" id="h63-1-162" class="d">-            (
</a><a href="#h63-1-163" id="h63-1-163" class="d">-                Field(
</a><a href="#h63-1-164" id="h63-1-164" class="d">-                    5,
</a><a href="#h63-1-165" id="h63-1-165" class="d">-                    Some(
</a><a href="#h63-1-166" id="h63-1-166" class="d">-                        (
</a><a href="#h63-1-167" id="h63-1-167" class="d">-                            Some(
</a><a href="#h63-1-168" id="h63-1-168" class="d">-                                &quot;m&quot;,
</a><a href="#h63-1-169" id="h63-1-169" class="d">-                            ),
</a><a href="#h63-1-170" id="h63-1-170" class="d">-                            &quot;rating&quot;,
</a><a href="#h63-1-171" id="h63-1-171" class="i">+            Field(
</a><a href="#h63-1-172" id="h63-1-172" class="i">+                5,
</a><a href="#h63-1-173" id="h63-1-173" class="i">+                Some(
</a><a href="#h63-1-174" id="h63-1-174" class="i">+                    (
</a><a href="#h63-1-175" id="h63-1-175" class="i">+                        Some(
</a><a href="#h63-1-176" id="h63-1-176" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-1-178" id="h63-1-178" class="i">+                        &quot;rating&quot;,
</a>                     ),
                 ),
<a href="#h63-1-181" id="h63-1-181" class="d">-                None,
</a>             ),
<a href="#h63-1-183" id="h63-1-183" class="d">-            (
</a><a href="#h63-1-184" id="h63-1-184" class="d">-                Field(
</a><a href="#h63-1-185" id="h63-1-185" class="d">-                    6,
</a><a href="#h63-1-186" id="h63-1-186" class="d">-                    Some(
</a><a href="#h63-1-187" id="h63-1-187" class="d">-                        (
</a><a href="#h63-1-188" id="h63-1-188" class="d">-                            Some(
</a><a href="#h63-1-189" id="h63-1-189" class="d">-                                &quot;m&quot;,
</a><a href="#h63-1-190" id="h63-1-190" class="d">-                            ),
</a><a href="#h63-1-191" id="h63-1-191" class="d">-                            &quot;ultrahd&quot;,
</a><a href="#h63-1-192" id="h63-1-192" class="i">+            Field(
</a><a href="#h63-1-193" id="h63-1-193" class="i">+                6,
</a><a href="#h63-1-194" id="h63-1-194" class="i">+                Some(
</a><a href="#h63-1-195" id="h63-1-195" class="i">+                    (
</a><a href="#h63-1-196" id="h63-1-196" class="i">+                        Some(
</a><a href="#h63-1-197" id="h63-1-197" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h63-1-199" id="h63-1-199" class="i">+                        &quot;ultrahd&quot;,
</a>                     ),
                 ),
<a href="#h63-1-202" id="h63-1-202" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h64" href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a> b/<a href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -233,166 +233,154 @@ Plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h64-0-3" id="h64-0-3" class="i">+            labels: [
</a><a href="#h64-0-4" id="h64-0-4" class="i">+                None,
</a><a href="#h64-0-5" id="h64-0-5" class="i">+                None,
</a><a href="#h64-0-6" id="h64-0-6" class="i">+                None,
</a><a href="#h64-0-7" id="h64-0-7" class="i">+                None,
</a><a href="#h64-0-8" id="h64-0-8" class="i">+                None,
</a><a href="#h64-0-9" id="h64-0-9" class="i">+                None,
</a><a href="#h64-0-10" id="h64-0-10" class="i">+                None,
</a><a href="#h64-0-11" id="h64-0-11" class="i">+                None,
</a><a href="#h64-0-12" id="h64-0-12" class="i">+                None,
</a><a href="#h64-0-13" id="h64-0-13" class="i">+            ],
</a>             expressions: [
<a href="#h64-0-15" id="h64-0-15" class="d">-                (
</a><a href="#h64-0-16" id="h64-0-16" class="d">-                    Field(
</a><a href="#h64-0-17" id="h64-0-17" class="d">-                        7,
</a><a href="#h64-0-18" id="h64-0-18" class="d">-                        Some(
</a><a href="#h64-0-19" id="h64-0-19" class="d">-                            (
</a><a href="#h64-0-20" id="h64-0-20" class="d">-                                Some(
</a><a href="#h64-0-21" id="h64-0-21" class="d">-                                    &quot;g&quot;,
</a><a href="#h64-0-22" id="h64-0-22" class="d">-                                ),
</a><a href="#h64-0-23" id="h64-0-23" class="d">-                                &quot;id&quot;,
</a><a href="#h64-0-24" id="h64-0-24" class="d">-                            ),
</a><a href="#h64-0-25" id="h64-0-25" class="d">-                        ),
</a><a href="#h64-0-26" id="h64-0-26" class="d">-                    ),
</a><a href="#h64-0-27" id="h64-0-27" class="d">-                    None,
</a><a href="#h64-0-28" id="h64-0-28" class="d">-                ),
</a><a href="#h64-0-29" id="h64-0-29" class="d">-                (
</a><a href="#h64-0-30" id="h64-0-30" class="d">-                    Field(
</a><a href="#h64-0-31" id="h64-0-31" class="d">-                        8,
</a><a href="#h64-0-32" id="h64-0-32" class="d">-                        Some(
</a><a href="#h64-0-33" id="h64-0-33" class="d">-                            (
</a><a href="#h64-0-34" id="h64-0-34" class="d">-                                Some(
</a><a href="#h64-0-35" id="h64-0-35" class="d">-                                    &quot;g&quot;,
</a><a href="#h64-0-36" id="h64-0-36" class="d">-                                ),
</a><a href="#h64-0-37" id="h64-0-37" class="d">-                                &quot;name&quot;,
</a><a href="#h64-0-38" id="h64-0-38" class="i">+                Field(
</a><a href="#h64-0-39" id="h64-0-39" class="i">+                    7,
</a><a href="#h64-0-40" id="h64-0-40" class="i">+                    Some(
</a><a href="#h64-0-41" id="h64-0-41" class="i">+                        (
</a><a href="#h64-0-42" id="h64-0-42" class="i">+                            Some(
</a><a href="#h64-0-43" id="h64-0-43" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h64-0-45" id="h64-0-45" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h64-0-48" id="h64-0-48" class="d">-                    None,
</a>                 ),
<a href="#h64-0-50" id="h64-0-50" class="d">-                (
</a><a href="#h64-0-51" id="h64-0-51" class="d">-                    Field(
</a><a href="#h64-0-52" id="h64-0-52" class="d">-                        0,
</a><a href="#h64-0-53" id="h64-0-53" class="d">-                        Some(
</a><a href="#h64-0-54" id="h64-0-54" class="d">-                            (
</a><a href="#h64-0-55" id="h64-0-55" class="d">-                                Some(
</a><a href="#h64-0-56" id="h64-0-56" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-0-57" id="h64-0-57" class="d">-                                ),
</a><a href="#h64-0-58" id="h64-0-58" class="d">-                                &quot;id&quot;,
</a><a href="#h64-0-59" id="h64-0-59" class="i">+                Field(
</a><a href="#h64-0-60" id="h64-0-60" class="i">+                    8,
</a><a href="#h64-0-61" id="h64-0-61" class="i">+                    Some(
</a><a href="#h64-0-62" id="h64-0-62" class="i">+                        (
</a><a href="#h64-0-63" id="h64-0-63" class="i">+                            Some(
</a><a href="#h64-0-64" id="h64-0-64" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h64-0-66" id="h64-0-66" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h64-0-69" id="h64-0-69" class="d">-                    None,
</a>                 ),
<a href="#h64-0-71" id="h64-0-71" class="d">-                (
</a><a href="#h64-0-72" id="h64-0-72" class="d">-                    Field(
</a><a href="#h64-0-73" id="h64-0-73" class="d">-                        1,
</a><a href="#h64-0-74" id="h64-0-74" class="d">-                        Some(
</a><a href="#h64-0-75" id="h64-0-75" class="d">-                            (
</a><a href="#h64-0-76" id="h64-0-76" class="d">-                                Some(
</a><a href="#h64-0-77" id="h64-0-77" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-0-78" id="h64-0-78" class="d">-                                ),
</a><a href="#h64-0-79" id="h64-0-79" class="d">-                                &quot;title&quot;,
</a><a href="#h64-0-80" id="h64-0-80" class="i">+                Field(
</a><a href="#h64-0-81" id="h64-0-81" class="i">+                    0,
</a><a href="#h64-0-82" id="h64-0-82" class="i">+                    Some(
</a><a href="#h64-0-83" id="h64-0-83" class="i">+                        (
</a><a href="#h64-0-84" id="h64-0-84" class="i">+                            Some(
</a><a href="#h64-0-85" id="h64-0-85" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-0-87" id="h64-0-87" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h64-0-90" id="h64-0-90" class="d">-                    None,
</a>                 ),
<a href="#h64-0-92" id="h64-0-92" class="d">-                (
</a><a href="#h64-0-93" id="h64-0-93" class="d">-                    Field(
</a><a href="#h64-0-94" id="h64-0-94" class="d">-                        2,
</a><a href="#h64-0-95" id="h64-0-95" class="d">-                        Some(
</a><a href="#h64-0-96" id="h64-0-96" class="d">-                            (
</a><a href="#h64-0-97" id="h64-0-97" class="d">-                                Some(
</a><a href="#h64-0-98" id="h64-0-98" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-0-99" id="h64-0-99" class="d">-                                ),
</a><a href="#h64-0-100" id="h64-0-100" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h64-0-101" id="h64-0-101" class="i">+                Field(
</a><a href="#h64-0-102" id="h64-0-102" class="i">+                    1,
</a><a href="#h64-0-103" id="h64-0-103" class="i">+                    Some(
</a><a href="#h64-0-104" id="h64-0-104" class="i">+                        (
</a><a href="#h64-0-105" id="h64-0-105" class="i">+                            Some(
</a><a href="#h64-0-106" id="h64-0-106" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-0-108" id="h64-0-108" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h64-0-111" id="h64-0-111" class="d">-                    None,
</a>                 ),
<a href="#h64-0-113" id="h64-0-113" class="d">-                (
</a><a href="#h64-0-114" id="h64-0-114" class="d">-                    Field(
</a><a href="#h64-0-115" id="h64-0-115" class="d">-                        3,
</a><a href="#h64-0-116" id="h64-0-116" class="d">-                        Some(
</a><a href="#h64-0-117" id="h64-0-117" class="d">-                            (
</a><a href="#h64-0-118" id="h64-0-118" class="d">-                                Some(
</a><a href="#h64-0-119" id="h64-0-119" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-0-120" id="h64-0-120" class="d">-                                ),
</a><a href="#h64-0-121" id="h64-0-121" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h64-0-122" id="h64-0-122" class="i">+                Field(
</a><a href="#h64-0-123" id="h64-0-123" class="i">+                    2,
</a><a href="#h64-0-124" id="h64-0-124" class="i">+                    Some(
</a><a href="#h64-0-125" id="h64-0-125" class="i">+                        (
</a><a href="#h64-0-126" id="h64-0-126" class="i">+                            Some(
</a><a href="#h64-0-127" id="h64-0-127" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-0-129" id="h64-0-129" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h64-0-132" id="h64-0-132" class="d">-                    None,
</a>                 ),
<a href="#h64-0-134" id="h64-0-134" class="d">-                (
</a><a href="#h64-0-135" id="h64-0-135" class="d">-                    Field(
</a><a href="#h64-0-136" id="h64-0-136" class="d">-                        4,
</a><a href="#h64-0-137" id="h64-0-137" class="d">-                        Some(
</a><a href="#h64-0-138" id="h64-0-138" class="d">-                            (
</a><a href="#h64-0-139" id="h64-0-139" class="d">-                                Some(
</a><a href="#h64-0-140" id="h64-0-140" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-0-141" id="h64-0-141" class="d">-                                ),
</a><a href="#h64-0-142" id="h64-0-142" class="d">-                                &quot;released&quot;,
</a><a href="#h64-0-143" id="h64-0-143" class="i">+                Field(
</a><a href="#h64-0-144" id="h64-0-144" class="i">+                    3,
</a><a href="#h64-0-145" id="h64-0-145" class="i">+                    Some(
</a><a href="#h64-0-146" id="h64-0-146" class="i">+                        (
</a><a href="#h64-0-147" id="h64-0-147" class="i">+                            Some(
</a><a href="#h64-0-148" id="h64-0-148" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-0-150" id="h64-0-150" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h64-0-153" id="h64-0-153" class="d">-                    None,
</a>                 ),
<a href="#h64-0-155" id="h64-0-155" class="d">-                (
</a><a href="#h64-0-156" id="h64-0-156" class="d">-                    Field(
</a><a href="#h64-0-157" id="h64-0-157" class="d">-                        5,
</a><a href="#h64-0-158" id="h64-0-158" class="d">-                        Some(
</a><a href="#h64-0-159" id="h64-0-159" class="d">-                            (
</a><a href="#h64-0-160" id="h64-0-160" class="d">-                                Some(
</a><a href="#h64-0-161" id="h64-0-161" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-0-162" id="h64-0-162" class="d">-                                ),
</a><a href="#h64-0-163" id="h64-0-163" class="d">-                                &quot;rating&quot;,
</a><a href="#h64-0-164" id="h64-0-164" class="i">+                Field(
</a><a href="#h64-0-165" id="h64-0-165" class="i">+                    4,
</a><a href="#h64-0-166" id="h64-0-166" class="i">+                    Some(
</a><a href="#h64-0-167" id="h64-0-167" class="i">+                        (
</a><a href="#h64-0-168" id="h64-0-168" class="i">+                            Some(
</a><a href="#h64-0-169" id="h64-0-169" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-0-171" id="h64-0-171" class="i">+                            &quot;released&quot;,
</a>                         ),
                     ),
<a href="#h64-0-174" id="h64-0-174" class="d">-                    None,
</a>                 ),
<a href="#h64-0-176" id="h64-0-176" class="d">-                (
</a><a href="#h64-0-177" id="h64-0-177" class="d">-                    Field(
</a><a href="#h64-0-178" id="h64-0-178" class="d">-                        6,
</a><a href="#h64-0-179" id="h64-0-179" class="d">-                        Some(
</a><a href="#h64-0-180" id="h64-0-180" class="d">-                            (
</a><a href="#h64-0-181" id="h64-0-181" class="d">-                                Some(
</a><a href="#h64-0-182" id="h64-0-182" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-0-183" id="h64-0-183" class="d">-                                ),
</a><a href="#h64-0-184" id="h64-0-184" class="d">-                                &quot;ultrahd&quot;,
</a><a href="#h64-0-185" id="h64-0-185" class="i">+                Field(
</a><a href="#h64-0-186" id="h64-0-186" class="i">+                    5,
</a><a href="#h64-0-187" id="h64-0-187" class="i">+                    Some(
</a><a href="#h64-0-188" id="h64-0-188" class="i">+                        (
</a><a href="#h64-0-189" id="h64-0-189" class="i">+                            Some(
</a><a href="#h64-0-190" id="h64-0-190" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-0-192" id="h64-0-192" class="i">+                            &quot;rating&quot;,
</a>                         ),
                     ),
<a href="#h64-0-195" id="h64-0-195" class="d">-                    None,
</a>                 ),
<a href="#h64-0-197" id="h64-0-197" class="d">-            ],
</a><a href="#h64-0-198" id="h64-0-198" class="d">-        },
</a><a href="#h64-0-199" id="h64-0-199" class="d">-        expressions: [
</a><a href="#h64-0-200" id="h64-0-200" class="d">-            (
</a>                 Field(
<a href="#h64-0-202" id="h64-0-202" class="d">-                    0,
</a><a href="#h64-0-203" id="h64-0-203" class="i">+                    6,
</a>                     Some(
                         (
                             Some(
<a href="#h64-0-207" id="h64-0-207" class="d">-                                &quot;g&quot;,
</a><a href="#h64-0-208" id="h64-0-208" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-0-210" id="h64-0-210" class="d">-                            &quot;id&quot;,
</a><a href="#h64-0-211" id="h64-0-211" class="i">+                            &quot;ultrahd&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h64-0-215" id="h64-0-215" class="d">-                Some(
</a><a href="#h64-0-216" id="h64-0-216" class="i">+            ],
</a><a href="#h64-0-217" id="h64-0-217" class="i">+        },
</a><a href="#h64-0-218" id="h64-0-218" class="i">+        labels: [
</a><a href="#h64-0-219" id="h64-0-219" class="i">+            Some(
</a><a href="#h64-0-220" id="h64-0-220" class="i">+                (
</a><a href="#h64-0-221" id="h64-0-221" class="i">+                    None,
</a>                     &quot;genre_id&quot;,
                 ),
             ),
<a href="#h64-0-225" id="h64-0-225" class="d">-            (
</a><a href="#h64-0-226" id="h64-0-226" class="d">-                Field(
</a><a href="#h64-0-227" id="h64-0-227" class="d">-                    2,
</a><a href="#h64-0-228" id="h64-0-228" class="d">-                    Some(
</a><a href="#h64-0-229" id="h64-0-229" class="d">-                        (
</a><a href="#h64-0-230" id="h64-0-230" class="d">-                            Some(
</a><a href="#h64-0-231" id="h64-0-231" class="d">-                                &quot;m&quot;,
</a><a href="#h64-0-232" id="h64-0-232" class="d">-                            ),
</a><a href="#h64-0-233" id="h64-0-233" class="d">-                            &quot;id&quot;,
</a><a href="#h64-0-234" id="h64-0-234" class="i">+            Some(
</a><a href="#h64-0-235" id="h64-0-235" class="i">+                (
</a><a href="#h64-0-236" id="h64-0-236" class="i">+                    None,
</a><a href="#h64-0-237" id="h64-0-237" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h64-0-238" id="h64-0-238" class="i">+                ),
</a><a href="#h64-0-239" id="h64-0-239" class="i">+            ),
</a><a href="#h64-0-240" id="h64-0-240" class="i">+        ],
</a><a href="#h64-0-241" id="h64-0-241" class="i">+        expressions: [
</a><a href="#h64-0-242" id="h64-0-242" class="i">+            Field(
</a><a href="#h64-0-243" id="h64-0-243" class="i">+                0,
</a><a href="#h64-0-244" id="h64-0-244" class="i">+                Some(
</a><a href="#h64-0-245" id="h64-0-245" class="i">+                    (
</a><a href="#h64-0-246" id="h64-0-246" class="i">+                        Some(
</a><a href="#h64-0-247" id="h64-0-247" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h64-0-249" id="h64-0-249" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h64-0-252" id="h64-0-252" class="i">+            ),
</a><a href="#h64-0-253" id="h64-0-253" class="i">+            Field(
</a><a href="#h64-0-254" id="h64-0-254" class="i">+                2,
</a>                 Some(
<a href="#h64-0-256" id="h64-0-256" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h64-0-257" id="h64-0-257" class="i">+                    (
</a><a href="#h64-0-258" id="h64-0-258" class="i">+                        Some(
</a><a href="#h64-0-259" id="h64-0-259" class="i">+                            &quot;m&quot;,
</a><a href="#h64-0-260" id="h64-0-260" class="i">+                        ),
</a><a href="#h64-0-261" id="h64-0-261" class="i">+                        &quot;id&quot;,
</a><a href="#h64-0-262" id="h64-0-262" class="i">+                    ),
</a>                 ),
             ),
         ],
<a href="#h64-1" id="h64-1" class="h">@@ -540,166 +528,154 @@ Optimized plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h64-1-3" id="h64-1-3" class="i">+            labels: [
</a><a href="#h64-1-4" id="h64-1-4" class="i">+                None,
</a><a href="#h64-1-5" id="h64-1-5" class="i">+                None,
</a><a href="#h64-1-6" id="h64-1-6" class="i">+                None,
</a><a href="#h64-1-7" id="h64-1-7" class="i">+                None,
</a><a href="#h64-1-8" id="h64-1-8" class="i">+                None,
</a><a href="#h64-1-9" id="h64-1-9" class="i">+                None,
</a><a href="#h64-1-10" id="h64-1-10" class="i">+                None,
</a><a href="#h64-1-11" id="h64-1-11" class="i">+                None,
</a><a href="#h64-1-12" id="h64-1-12" class="i">+                None,
</a><a href="#h64-1-13" id="h64-1-13" class="i">+            ],
</a>             expressions: [
<a href="#h64-1-15" id="h64-1-15" class="d">-                (
</a><a href="#h64-1-16" id="h64-1-16" class="d">-                    Field(
</a><a href="#h64-1-17" id="h64-1-17" class="d">-                        7,
</a><a href="#h64-1-18" id="h64-1-18" class="d">-                        Some(
</a><a href="#h64-1-19" id="h64-1-19" class="d">-                            (
</a><a href="#h64-1-20" id="h64-1-20" class="d">-                                Some(
</a><a href="#h64-1-21" id="h64-1-21" class="d">-                                    &quot;g&quot;,
</a><a href="#h64-1-22" id="h64-1-22" class="d">-                                ),
</a><a href="#h64-1-23" id="h64-1-23" class="d">-                                &quot;id&quot;,
</a><a href="#h64-1-24" id="h64-1-24" class="d">-                            ),
</a><a href="#h64-1-25" id="h64-1-25" class="d">-                        ),
</a><a href="#h64-1-26" id="h64-1-26" class="d">-                    ),
</a><a href="#h64-1-27" id="h64-1-27" class="d">-                    None,
</a><a href="#h64-1-28" id="h64-1-28" class="d">-                ),
</a><a href="#h64-1-29" id="h64-1-29" class="d">-                (
</a><a href="#h64-1-30" id="h64-1-30" class="d">-                    Field(
</a><a href="#h64-1-31" id="h64-1-31" class="d">-                        8,
</a><a href="#h64-1-32" id="h64-1-32" class="d">-                        Some(
</a><a href="#h64-1-33" id="h64-1-33" class="d">-                            (
</a><a href="#h64-1-34" id="h64-1-34" class="d">-                                Some(
</a><a href="#h64-1-35" id="h64-1-35" class="d">-                                    &quot;g&quot;,
</a><a href="#h64-1-36" id="h64-1-36" class="d">-                                ),
</a><a href="#h64-1-37" id="h64-1-37" class="d">-                                &quot;name&quot;,
</a><a href="#h64-1-38" id="h64-1-38" class="i">+                Field(
</a><a href="#h64-1-39" id="h64-1-39" class="i">+                    7,
</a><a href="#h64-1-40" id="h64-1-40" class="i">+                    Some(
</a><a href="#h64-1-41" id="h64-1-41" class="i">+                        (
</a><a href="#h64-1-42" id="h64-1-42" class="i">+                            Some(
</a><a href="#h64-1-43" id="h64-1-43" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h64-1-45" id="h64-1-45" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h64-1-48" id="h64-1-48" class="d">-                    None,
</a>                 ),
<a href="#h64-1-50" id="h64-1-50" class="d">-                (
</a><a href="#h64-1-51" id="h64-1-51" class="d">-                    Field(
</a><a href="#h64-1-52" id="h64-1-52" class="d">-                        0,
</a><a href="#h64-1-53" id="h64-1-53" class="d">-                        Some(
</a><a href="#h64-1-54" id="h64-1-54" class="d">-                            (
</a><a href="#h64-1-55" id="h64-1-55" class="d">-                                Some(
</a><a href="#h64-1-56" id="h64-1-56" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-1-57" id="h64-1-57" class="d">-                                ),
</a><a href="#h64-1-58" id="h64-1-58" class="d">-                                &quot;id&quot;,
</a><a href="#h64-1-59" id="h64-1-59" class="i">+                Field(
</a><a href="#h64-1-60" id="h64-1-60" class="i">+                    8,
</a><a href="#h64-1-61" id="h64-1-61" class="i">+                    Some(
</a><a href="#h64-1-62" id="h64-1-62" class="i">+                        (
</a><a href="#h64-1-63" id="h64-1-63" class="i">+                            Some(
</a><a href="#h64-1-64" id="h64-1-64" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h64-1-66" id="h64-1-66" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h64-1-69" id="h64-1-69" class="d">-                    None,
</a>                 ),
<a href="#h64-1-71" id="h64-1-71" class="d">-                (
</a><a href="#h64-1-72" id="h64-1-72" class="d">-                    Field(
</a><a href="#h64-1-73" id="h64-1-73" class="d">-                        1,
</a><a href="#h64-1-74" id="h64-1-74" class="d">-                        Some(
</a><a href="#h64-1-75" id="h64-1-75" class="d">-                            (
</a><a href="#h64-1-76" id="h64-1-76" class="d">-                                Some(
</a><a href="#h64-1-77" id="h64-1-77" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-1-78" id="h64-1-78" class="d">-                                ),
</a><a href="#h64-1-79" id="h64-1-79" class="d">-                                &quot;title&quot;,
</a><a href="#h64-1-80" id="h64-1-80" class="i">+                Field(
</a><a href="#h64-1-81" id="h64-1-81" class="i">+                    0,
</a><a href="#h64-1-82" id="h64-1-82" class="i">+                    Some(
</a><a href="#h64-1-83" id="h64-1-83" class="i">+                        (
</a><a href="#h64-1-84" id="h64-1-84" class="i">+                            Some(
</a><a href="#h64-1-85" id="h64-1-85" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-1-87" id="h64-1-87" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h64-1-90" id="h64-1-90" class="d">-                    None,
</a>                 ),
<a href="#h64-1-92" id="h64-1-92" class="d">-                (
</a><a href="#h64-1-93" id="h64-1-93" class="d">-                    Field(
</a><a href="#h64-1-94" id="h64-1-94" class="d">-                        2,
</a><a href="#h64-1-95" id="h64-1-95" class="d">-                        Some(
</a><a href="#h64-1-96" id="h64-1-96" class="d">-                            (
</a><a href="#h64-1-97" id="h64-1-97" class="d">-                                Some(
</a><a href="#h64-1-98" id="h64-1-98" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-1-99" id="h64-1-99" class="d">-                                ),
</a><a href="#h64-1-100" id="h64-1-100" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h64-1-101" id="h64-1-101" class="i">+                Field(
</a><a href="#h64-1-102" id="h64-1-102" class="i">+                    1,
</a><a href="#h64-1-103" id="h64-1-103" class="i">+                    Some(
</a><a href="#h64-1-104" id="h64-1-104" class="i">+                        (
</a><a href="#h64-1-105" id="h64-1-105" class="i">+                            Some(
</a><a href="#h64-1-106" id="h64-1-106" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-1-108" id="h64-1-108" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h64-1-111" id="h64-1-111" class="d">-                    None,
</a>                 ),
<a href="#h64-1-113" id="h64-1-113" class="d">-                (
</a><a href="#h64-1-114" id="h64-1-114" class="d">-                    Field(
</a><a href="#h64-1-115" id="h64-1-115" class="d">-                        3,
</a><a href="#h64-1-116" id="h64-1-116" class="d">-                        Some(
</a><a href="#h64-1-117" id="h64-1-117" class="d">-                            (
</a><a href="#h64-1-118" id="h64-1-118" class="d">-                                Some(
</a><a href="#h64-1-119" id="h64-1-119" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-1-120" id="h64-1-120" class="d">-                                ),
</a><a href="#h64-1-121" id="h64-1-121" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h64-1-122" id="h64-1-122" class="i">+                Field(
</a><a href="#h64-1-123" id="h64-1-123" class="i">+                    2,
</a><a href="#h64-1-124" id="h64-1-124" class="i">+                    Some(
</a><a href="#h64-1-125" id="h64-1-125" class="i">+                        (
</a><a href="#h64-1-126" id="h64-1-126" class="i">+                            Some(
</a><a href="#h64-1-127" id="h64-1-127" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-1-129" id="h64-1-129" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h64-1-132" id="h64-1-132" class="d">-                    None,
</a>                 ),
<a href="#h64-1-134" id="h64-1-134" class="d">-                (
</a><a href="#h64-1-135" id="h64-1-135" class="d">-                    Field(
</a><a href="#h64-1-136" id="h64-1-136" class="d">-                        4,
</a><a href="#h64-1-137" id="h64-1-137" class="d">-                        Some(
</a><a href="#h64-1-138" id="h64-1-138" class="d">-                            (
</a><a href="#h64-1-139" id="h64-1-139" class="d">-                                Some(
</a><a href="#h64-1-140" id="h64-1-140" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-1-141" id="h64-1-141" class="d">-                                ),
</a><a href="#h64-1-142" id="h64-1-142" class="d">-                                &quot;released&quot;,
</a><a href="#h64-1-143" id="h64-1-143" class="i">+                Field(
</a><a href="#h64-1-144" id="h64-1-144" class="i">+                    3,
</a><a href="#h64-1-145" id="h64-1-145" class="i">+                    Some(
</a><a href="#h64-1-146" id="h64-1-146" class="i">+                        (
</a><a href="#h64-1-147" id="h64-1-147" class="i">+                            Some(
</a><a href="#h64-1-148" id="h64-1-148" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-1-150" id="h64-1-150" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h64-1-153" id="h64-1-153" class="d">-                    None,
</a>                 ),
<a href="#h64-1-155" id="h64-1-155" class="d">-                (
</a><a href="#h64-1-156" id="h64-1-156" class="d">-                    Field(
</a><a href="#h64-1-157" id="h64-1-157" class="d">-                        5,
</a><a href="#h64-1-158" id="h64-1-158" class="d">-                        Some(
</a><a href="#h64-1-159" id="h64-1-159" class="d">-                            (
</a><a href="#h64-1-160" id="h64-1-160" class="d">-                                Some(
</a><a href="#h64-1-161" id="h64-1-161" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-1-162" id="h64-1-162" class="d">-                                ),
</a><a href="#h64-1-163" id="h64-1-163" class="d">-                                &quot;rating&quot;,
</a><a href="#h64-1-164" id="h64-1-164" class="i">+                Field(
</a><a href="#h64-1-165" id="h64-1-165" class="i">+                    4,
</a><a href="#h64-1-166" id="h64-1-166" class="i">+                    Some(
</a><a href="#h64-1-167" id="h64-1-167" class="i">+                        (
</a><a href="#h64-1-168" id="h64-1-168" class="i">+                            Some(
</a><a href="#h64-1-169" id="h64-1-169" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-1-171" id="h64-1-171" class="i">+                            &quot;released&quot;,
</a>                         ),
                     ),
<a href="#h64-1-174" id="h64-1-174" class="d">-                    None,
</a>                 ),
<a href="#h64-1-176" id="h64-1-176" class="d">-                (
</a><a href="#h64-1-177" id="h64-1-177" class="d">-                    Field(
</a><a href="#h64-1-178" id="h64-1-178" class="d">-                        6,
</a><a href="#h64-1-179" id="h64-1-179" class="d">-                        Some(
</a><a href="#h64-1-180" id="h64-1-180" class="d">-                            (
</a><a href="#h64-1-181" id="h64-1-181" class="d">-                                Some(
</a><a href="#h64-1-182" id="h64-1-182" class="d">-                                    &quot;m&quot;,
</a><a href="#h64-1-183" id="h64-1-183" class="d">-                                ),
</a><a href="#h64-1-184" id="h64-1-184" class="d">-                                &quot;ultrahd&quot;,
</a><a href="#h64-1-185" id="h64-1-185" class="i">+                Field(
</a><a href="#h64-1-186" id="h64-1-186" class="i">+                    5,
</a><a href="#h64-1-187" id="h64-1-187" class="i">+                    Some(
</a><a href="#h64-1-188" id="h64-1-188" class="i">+                        (
</a><a href="#h64-1-189" id="h64-1-189" class="i">+                            Some(
</a><a href="#h64-1-190" id="h64-1-190" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-1-192" id="h64-1-192" class="i">+                            &quot;rating&quot;,
</a>                         ),
                     ),
<a href="#h64-1-195" id="h64-1-195" class="d">-                    None,
</a>                 ),
<a href="#h64-1-197" id="h64-1-197" class="d">-            ],
</a><a href="#h64-1-198" id="h64-1-198" class="d">-        },
</a><a href="#h64-1-199" id="h64-1-199" class="d">-        expressions: [
</a><a href="#h64-1-200" id="h64-1-200" class="d">-            (
</a>                 Field(
<a href="#h64-1-202" id="h64-1-202" class="d">-                    0,
</a><a href="#h64-1-203" id="h64-1-203" class="i">+                    6,
</a>                     Some(
                         (
                             Some(
<a href="#h64-1-207" id="h64-1-207" class="d">-                                &quot;g&quot;,
</a><a href="#h64-1-208" id="h64-1-208" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h64-1-210" id="h64-1-210" class="d">-                            &quot;id&quot;,
</a><a href="#h64-1-211" id="h64-1-211" class="i">+                            &quot;ultrahd&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h64-1-215" id="h64-1-215" class="d">-                Some(
</a><a href="#h64-1-216" id="h64-1-216" class="i">+            ],
</a><a href="#h64-1-217" id="h64-1-217" class="i">+        },
</a><a href="#h64-1-218" id="h64-1-218" class="i">+        labels: [
</a><a href="#h64-1-219" id="h64-1-219" class="i">+            Some(
</a><a href="#h64-1-220" id="h64-1-220" class="i">+                (
</a><a href="#h64-1-221" id="h64-1-221" class="i">+                    None,
</a>                     &quot;genre_id&quot;,
                 ),
             ),
<a href="#h64-1-225" id="h64-1-225" class="d">-            (
</a><a href="#h64-1-226" id="h64-1-226" class="d">-                Field(
</a><a href="#h64-1-227" id="h64-1-227" class="d">-                    2,
</a><a href="#h64-1-228" id="h64-1-228" class="d">-                    Some(
</a><a href="#h64-1-229" id="h64-1-229" class="d">-                        (
</a><a href="#h64-1-230" id="h64-1-230" class="d">-                            Some(
</a><a href="#h64-1-231" id="h64-1-231" class="d">-                                &quot;m&quot;,
</a><a href="#h64-1-232" id="h64-1-232" class="d">-                            ),
</a><a href="#h64-1-233" id="h64-1-233" class="d">-                            &quot;id&quot;,
</a><a href="#h64-1-234" id="h64-1-234" class="i">+            Some(
</a><a href="#h64-1-235" id="h64-1-235" class="i">+                (
</a><a href="#h64-1-236" id="h64-1-236" class="i">+                    None,
</a><a href="#h64-1-237" id="h64-1-237" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h64-1-238" id="h64-1-238" class="i">+                ),
</a><a href="#h64-1-239" id="h64-1-239" class="i">+            ),
</a><a href="#h64-1-240" id="h64-1-240" class="i">+        ],
</a><a href="#h64-1-241" id="h64-1-241" class="i">+        expressions: [
</a><a href="#h64-1-242" id="h64-1-242" class="i">+            Field(
</a><a href="#h64-1-243" id="h64-1-243" class="i">+                0,
</a><a href="#h64-1-244" id="h64-1-244" class="i">+                Some(
</a><a href="#h64-1-245" id="h64-1-245" class="i">+                    (
</a><a href="#h64-1-246" id="h64-1-246" class="i">+                        Some(
</a><a href="#h64-1-247" id="h64-1-247" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h64-1-249" id="h64-1-249" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h64-1-252" id="h64-1-252" class="i">+            ),
</a><a href="#h64-1-253" id="h64-1-253" class="i">+            Field(
</a><a href="#h64-1-254" id="h64-1-254" class="i">+                2,
</a>                 Some(
<a href="#h64-1-256" id="h64-1-256" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h64-1-257" id="h64-1-257" class="i">+                    (
</a><a href="#h64-1-258" id="h64-1-258" class="i">+                        Some(
</a><a href="#h64-1-259" id="h64-1-259" class="i">+                            &quot;m&quot;,
</a><a href="#h64-1-260" id="h64-1-260" class="i">+                        ),
</a><a href="#h64-1-261" id="h64-1-261" class="i">+                        &quot;id&quot;,
</a><a href="#h64-1-262" id="h64-1-262" class="i">+                    ),
</a>                 ),
             ),
         ],
<b>diff --git a/<a id="h65" href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a> b/<a href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -226,169 +226,157 @@ Plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h65-0-3" id="h65-0-3" class="i">+            labels: [
</a><a href="#h65-0-4" id="h65-0-4" class="i">+                None,
</a><a href="#h65-0-5" id="h65-0-5" class="i">+                None,
</a><a href="#h65-0-6" id="h65-0-6" class="i">+                None,
</a><a href="#h65-0-7" id="h65-0-7" class="i">+                None,
</a><a href="#h65-0-8" id="h65-0-8" class="i">+                None,
</a><a href="#h65-0-9" id="h65-0-9" class="i">+                None,
</a><a href="#h65-0-10" id="h65-0-10" class="i">+                None,
</a><a href="#h65-0-11" id="h65-0-11" class="i">+                None,
</a><a href="#h65-0-12" id="h65-0-12" class="i">+                None,
</a><a href="#h65-0-13" id="h65-0-13" class="i">+            ],
</a>             expressions: [
<a href="#h65-0-15" id="h65-0-15" class="d">-                (
</a><a href="#h65-0-16" id="h65-0-16" class="d">-                    Field(
</a><a href="#h65-0-17" id="h65-0-17" class="d">-                        2,
</a><a href="#h65-0-18" id="h65-0-18" class="d">-                        Some(
</a><a href="#h65-0-19" id="h65-0-19" class="d">-                            (
</a><a href="#h65-0-20" id="h65-0-20" class="d">-                                Some(
</a><a href="#h65-0-21" id="h65-0-21" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-0-22" id="h65-0-22" class="d">-                                ),
</a><a href="#h65-0-23" id="h65-0-23" class="d">-                                &quot;id&quot;,
</a><a href="#h65-0-24" id="h65-0-24" class="d">-                            ),
</a><a href="#h65-0-25" id="h65-0-25" class="d">-                        ),
</a><a href="#h65-0-26" id="h65-0-26" class="d">-                    ),
</a><a href="#h65-0-27" id="h65-0-27" class="d">-                    None,
</a><a href="#h65-0-28" id="h65-0-28" class="d">-                ),
</a><a href="#h65-0-29" id="h65-0-29" class="d">-                (
</a><a href="#h65-0-30" id="h65-0-30" class="d">-                    Field(
</a><a href="#h65-0-31" id="h65-0-31" class="d">-                        3,
</a><a href="#h65-0-32" id="h65-0-32" class="d">-                        Some(
</a><a href="#h65-0-33" id="h65-0-33" class="d">-                            (
</a><a href="#h65-0-34" id="h65-0-34" class="d">-                                Some(
</a><a href="#h65-0-35" id="h65-0-35" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-0-36" id="h65-0-36" class="d">-                                ),
</a><a href="#h65-0-37" id="h65-0-37" class="d">-                                &quot;title&quot;,
</a><a href="#h65-0-38" id="h65-0-38" class="d">-                            ),
</a><a href="#h65-0-39" id="h65-0-39" class="d">-                        ),
</a><a href="#h65-0-40" id="h65-0-40" class="d">-                    ),
</a><a href="#h65-0-41" id="h65-0-41" class="d">-                    None,
</a><a href="#h65-0-42" id="h65-0-42" class="d">-                ),
</a><a href="#h65-0-43" id="h65-0-43" class="d">-                (
</a><a href="#h65-0-44" id="h65-0-44" class="d">-                    Field(
</a><a href="#h65-0-45" id="h65-0-45" class="d">-                        4,
</a><a href="#h65-0-46" id="h65-0-46" class="d">-                        Some(
</a><a href="#h65-0-47" id="h65-0-47" class="d">-                            (
</a><a href="#h65-0-48" id="h65-0-48" class="d">-                                Some(
</a><a href="#h65-0-49" id="h65-0-49" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-0-50" id="h65-0-50" class="d">-                                ),
</a><a href="#h65-0-51" id="h65-0-51" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h65-0-52" id="h65-0-52" class="i">+                Field(
</a><a href="#h65-0-53" id="h65-0-53" class="i">+                    2,
</a><a href="#h65-0-54" id="h65-0-54" class="i">+                    Some(
</a><a href="#h65-0-55" id="h65-0-55" class="i">+                        (
</a><a href="#h65-0-56" id="h65-0-56" class="i">+                            Some(
</a><a href="#h65-0-57" id="h65-0-57" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-0-59" id="h65-0-59" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h65-0-62" id="h65-0-62" class="d">-                    None,
</a>                 ),
<a href="#h65-0-64" id="h65-0-64" class="d">-                (
</a><a href="#h65-0-65" id="h65-0-65" class="d">-                    Field(
</a><a href="#h65-0-66" id="h65-0-66" class="d">-                        5,
</a><a href="#h65-0-67" id="h65-0-67" class="d">-                        Some(
</a><a href="#h65-0-68" id="h65-0-68" class="d">-                            (
</a><a href="#h65-0-69" id="h65-0-69" class="d">-                                Some(
</a><a href="#h65-0-70" id="h65-0-70" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-0-71" id="h65-0-71" class="d">-                                ),
</a><a href="#h65-0-72" id="h65-0-72" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h65-0-73" id="h65-0-73" class="i">+                Field(
</a><a href="#h65-0-74" id="h65-0-74" class="i">+                    3,
</a><a href="#h65-0-75" id="h65-0-75" class="i">+                    Some(
</a><a href="#h65-0-76" id="h65-0-76" class="i">+                        (
</a><a href="#h65-0-77" id="h65-0-77" class="i">+                            Some(
</a><a href="#h65-0-78" id="h65-0-78" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-0-80" id="h65-0-80" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h65-0-83" id="h65-0-83" class="d">-                    None,
</a>                 ),
<a href="#h65-0-85" id="h65-0-85" class="d">-                (
</a><a href="#h65-0-86" id="h65-0-86" class="d">-                    Field(
</a><a href="#h65-0-87" id="h65-0-87" class="d">-                        6,
</a><a href="#h65-0-88" id="h65-0-88" class="d">-                        Some(
</a><a href="#h65-0-89" id="h65-0-89" class="d">-                            (
</a><a href="#h65-0-90" id="h65-0-90" class="d">-                                Some(
</a><a href="#h65-0-91" id="h65-0-91" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-0-92" id="h65-0-92" class="d">-                                ),
</a><a href="#h65-0-93" id="h65-0-93" class="d">-                                &quot;released&quot;,
</a><a href="#h65-0-94" id="h65-0-94" class="i">+                Field(
</a><a href="#h65-0-95" id="h65-0-95" class="i">+                    4,
</a><a href="#h65-0-96" id="h65-0-96" class="i">+                    Some(
</a><a href="#h65-0-97" id="h65-0-97" class="i">+                        (
</a><a href="#h65-0-98" id="h65-0-98" class="i">+                            Some(
</a><a href="#h65-0-99" id="h65-0-99" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-0-101" id="h65-0-101" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h65-0-104" id="h65-0-104" class="d">-                    None,
</a>                 ),
<a href="#h65-0-106" id="h65-0-106" class="d">-                (
</a><a href="#h65-0-107" id="h65-0-107" class="d">-                    Field(
</a><a href="#h65-0-108" id="h65-0-108" class="d">-                        7,
</a><a href="#h65-0-109" id="h65-0-109" class="d">-                        Some(
</a><a href="#h65-0-110" id="h65-0-110" class="d">-                            (
</a><a href="#h65-0-111" id="h65-0-111" class="d">-                                Some(
</a><a href="#h65-0-112" id="h65-0-112" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-0-113" id="h65-0-113" class="d">-                                ),
</a><a href="#h65-0-114" id="h65-0-114" class="d">-                                &quot;rating&quot;,
</a><a href="#h65-0-115" id="h65-0-115" class="i">+                Field(
</a><a href="#h65-0-116" id="h65-0-116" class="i">+                    5,
</a><a href="#h65-0-117" id="h65-0-117" class="i">+                    Some(
</a><a href="#h65-0-118" id="h65-0-118" class="i">+                        (
</a><a href="#h65-0-119" id="h65-0-119" class="i">+                            Some(
</a><a href="#h65-0-120" id="h65-0-120" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-0-122" id="h65-0-122" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h65-0-125" id="h65-0-125" class="d">-                    None,
</a>                 ),
<a href="#h65-0-127" id="h65-0-127" class="d">-                (
</a><a href="#h65-0-128" id="h65-0-128" class="d">-                    Field(
</a><a href="#h65-0-129" id="h65-0-129" class="d">-                        8,
</a><a href="#h65-0-130" id="h65-0-130" class="d">-                        Some(
</a><a href="#h65-0-131" id="h65-0-131" class="d">-                            (
</a><a href="#h65-0-132" id="h65-0-132" class="d">-                                Some(
</a><a href="#h65-0-133" id="h65-0-133" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-0-134" id="h65-0-134" class="d">-                                ),
</a><a href="#h65-0-135" id="h65-0-135" class="d">-                                &quot;ultrahd&quot;,
</a><a href="#h65-0-136" id="h65-0-136" class="i">+                Field(
</a><a href="#h65-0-137" id="h65-0-137" class="i">+                    6,
</a><a href="#h65-0-138" id="h65-0-138" class="i">+                    Some(
</a><a href="#h65-0-139" id="h65-0-139" class="i">+                        (
</a><a href="#h65-0-140" id="h65-0-140" class="i">+                            Some(
</a><a href="#h65-0-141" id="h65-0-141" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-0-143" id="h65-0-143" class="i">+                            &quot;released&quot;,
</a>                         ),
                     ),
<a href="#h65-0-146" id="h65-0-146" class="d">-                    None,
</a>                 ),
<a href="#h65-0-148" id="h65-0-148" class="d">-                (
</a><a href="#h65-0-149" id="h65-0-149" class="d">-                    Field(
</a><a href="#h65-0-150" id="h65-0-150" class="d">-                        0,
</a><a href="#h65-0-151" id="h65-0-151" class="d">-                        Some(
</a><a href="#h65-0-152" id="h65-0-152" class="d">-                            (
</a><a href="#h65-0-153" id="h65-0-153" class="d">-                                Some(
</a><a href="#h65-0-154" id="h65-0-154" class="d">-                                    &quot;g&quot;,
</a><a href="#h65-0-155" id="h65-0-155" class="d">-                                ),
</a><a href="#h65-0-156" id="h65-0-156" class="d">-                                &quot;id&quot;,
</a><a href="#h65-0-157" id="h65-0-157" class="i">+                Field(
</a><a href="#h65-0-158" id="h65-0-158" class="i">+                    7,
</a><a href="#h65-0-159" id="h65-0-159" class="i">+                    Some(
</a><a href="#h65-0-160" id="h65-0-160" class="i">+                        (
</a><a href="#h65-0-161" id="h65-0-161" class="i">+                            Some(
</a><a href="#h65-0-162" id="h65-0-162" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-0-164" id="h65-0-164" class="i">+                            &quot;rating&quot;,
</a>                         ),
                     ),
<a href="#h65-0-167" id="h65-0-167" class="d">-                    None,
</a>                 ),
<a href="#h65-0-169" id="h65-0-169" class="d">-                (
</a><a href="#h65-0-170" id="h65-0-170" class="d">-                    Field(
</a><a href="#h65-0-171" id="h65-0-171" class="d">-                        1,
</a><a href="#h65-0-172" id="h65-0-172" class="d">-                        Some(
</a><a href="#h65-0-173" id="h65-0-173" class="d">-                            (
</a><a href="#h65-0-174" id="h65-0-174" class="d">-                                Some(
</a><a href="#h65-0-175" id="h65-0-175" class="d">-                                    &quot;g&quot;,
</a><a href="#h65-0-176" id="h65-0-176" class="d">-                                ),
</a><a href="#h65-0-177" id="h65-0-177" class="d">-                                &quot;name&quot;,
</a><a href="#h65-0-178" id="h65-0-178" class="i">+                Field(
</a><a href="#h65-0-179" id="h65-0-179" class="i">+                    8,
</a><a href="#h65-0-180" id="h65-0-180" class="i">+                    Some(
</a><a href="#h65-0-181" id="h65-0-181" class="i">+                        (
</a><a href="#h65-0-182" id="h65-0-182" class="i">+                            Some(
</a><a href="#h65-0-183" id="h65-0-183" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-0-185" id="h65-0-185" class="i">+                            &quot;ultrahd&quot;,
</a>                         ),
                     ),
<a href="#h65-0-188" id="h65-0-188" class="d">-                    None,
</a>                 ),
<a href="#h65-0-190" id="h65-0-190" class="d">-            ],
</a><a href="#h65-0-191" id="h65-0-191" class="d">-        },
</a><a href="#h65-0-192" id="h65-0-192" class="d">-        expressions: [
</a><a href="#h65-0-193" id="h65-0-193" class="d">-            (
</a>                 Field(
                     0,
                     Some(
                         (
                             Some(
<a href="#h65-0-199" id="h65-0-199" class="d">-                                &quot;m&quot;,
</a><a href="#h65-0-200" id="h65-0-200" class="i">+                                &quot;g&quot;,
</a>                             ),
                             &quot;id&quot;,
                         ),
                     ),
                 ),
<a href="#h65-0-206" id="h65-0-206" class="d">-                Some(
</a><a href="#h65-0-207" id="h65-0-207" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h65-0-208" id="h65-0-208" class="d">-                ),
</a><a href="#h65-0-209" id="h65-0-209" class="d">-            ),
</a><a href="#h65-0-210" id="h65-0-210" class="d">-            (
</a>                 Field(
<a href="#h65-0-212" id="h65-0-212" class="d">-                    7,
</a><a href="#h65-0-213" id="h65-0-213" class="i">+                    1,
</a>                     Some(
                         (
                             Some(
                                 &quot;g&quot;,
                             ),
<a href="#h65-0-219" id="h65-0-219" class="d">-                            &quot;id&quot;,
</a><a href="#h65-0-220" id="h65-0-220" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h65-0-224" id="h65-0-224" class="d">-                Some(
</a><a href="#h65-0-225" id="h65-0-225" class="i">+            ],
</a><a href="#h65-0-226" id="h65-0-226" class="i">+        },
</a><a href="#h65-0-227" id="h65-0-227" class="i">+        labels: [
</a><a href="#h65-0-228" id="h65-0-228" class="i">+            Some(
</a><a href="#h65-0-229" id="h65-0-229" class="i">+                (
</a><a href="#h65-0-230" id="h65-0-230" class="i">+                    None,
</a><a href="#h65-0-231" id="h65-0-231" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h65-0-232" id="h65-0-232" class="i">+                ),
</a><a href="#h65-0-233" id="h65-0-233" class="i">+            ),
</a><a href="#h65-0-234" id="h65-0-234" class="i">+            Some(
</a><a href="#h65-0-235" id="h65-0-235" class="i">+                (
</a><a href="#h65-0-236" id="h65-0-236" class="i">+                    None,
</a>                     &quot;genre_id&quot;,
                 ),
             ),
         ],
<a href="#h65-0-241" id="h65-0-241" class="i">+        expressions: [
</a><a href="#h65-0-242" id="h65-0-242" class="i">+            Field(
</a><a href="#h65-0-243" id="h65-0-243" class="i">+                0,
</a><a href="#h65-0-244" id="h65-0-244" class="i">+                Some(
</a><a href="#h65-0-245" id="h65-0-245" class="i">+                    (
</a><a href="#h65-0-246" id="h65-0-246" class="i">+                        Some(
</a><a href="#h65-0-247" id="h65-0-247" class="i">+                            &quot;m&quot;,
</a><a href="#h65-0-248" id="h65-0-248" class="i">+                        ),
</a><a href="#h65-0-249" id="h65-0-249" class="i">+                        &quot;id&quot;,
</a><a href="#h65-0-250" id="h65-0-250" class="i">+                    ),
</a><a href="#h65-0-251" id="h65-0-251" class="i">+                ),
</a><a href="#h65-0-252" id="h65-0-252" class="i">+            ),
</a><a href="#h65-0-253" id="h65-0-253" class="i">+            Field(
</a><a href="#h65-0-254" id="h65-0-254" class="i">+                7,
</a><a href="#h65-0-255" id="h65-0-255" class="i">+                Some(
</a><a href="#h65-0-256" id="h65-0-256" class="i">+                    (
</a><a href="#h65-0-257" id="h65-0-257" class="i">+                        Some(
</a><a href="#h65-0-258" id="h65-0-258" class="i">+                            &quot;g&quot;,
</a><a href="#h65-0-259" id="h65-0-259" class="i">+                        ),
</a><a href="#h65-0-260" id="h65-0-260" class="i">+                        &quot;id&quot;,
</a><a href="#h65-0-261" id="h65-0-261" class="i">+                    ),
</a><a href="#h65-0-262" id="h65-0-262" class="i">+                ),
</a><a href="#h65-0-263" id="h65-0-263" class="i">+            ),
</a><a href="#h65-0-264" id="h65-0-264" class="i">+        ],
</a>     },
 )
 
<a href="#h65-1" id="h65-1" class="h">@@ -533,169 +521,157 @@ Optimized plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h65-1-3" id="h65-1-3" class="i">+            labels: [
</a><a href="#h65-1-4" id="h65-1-4" class="i">+                None,
</a><a href="#h65-1-5" id="h65-1-5" class="i">+                None,
</a><a href="#h65-1-6" id="h65-1-6" class="i">+                None,
</a><a href="#h65-1-7" id="h65-1-7" class="i">+                None,
</a><a href="#h65-1-8" id="h65-1-8" class="i">+                None,
</a><a href="#h65-1-9" id="h65-1-9" class="i">+                None,
</a><a href="#h65-1-10" id="h65-1-10" class="i">+                None,
</a><a href="#h65-1-11" id="h65-1-11" class="i">+                None,
</a><a href="#h65-1-12" id="h65-1-12" class="i">+                None,
</a><a href="#h65-1-13" id="h65-1-13" class="i">+            ],
</a>             expressions: [
<a href="#h65-1-15" id="h65-1-15" class="d">-                (
</a><a href="#h65-1-16" id="h65-1-16" class="d">-                    Field(
</a><a href="#h65-1-17" id="h65-1-17" class="d">-                        2,
</a><a href="#h65-1-18" id="h65-1-18" class="d">-                        Some(
</a><a href="#h65-1-19" id="h65-1-19" class="d">-                            (
</a><a href="#h65-1-20" id="h65-1-20" class="d">-                                Some(
</a><a href="#h65-1-21" id="h65-1-21" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-1-22" id="h65-1-22" class="d">-                                ),
</a><a href="#h65-1-23" id="h65-1-23" class="d">-                                &quot;id&quot;,
</a><a href="#h65-1-24" id="h65-1-24" class="d">-                            ),
</a><a href="#h65-1-25" id="h65-1-25" class="d">-                        ),
</a><a href="#h65-1-26" id="h65-1-26" class="d">-                    ),
</a><a href="#h65-1-27" id="h65-1-27" class="d">-                    None,
</a><a href="#h65-1-28" id="h65-1-28" class="d">-                ),
</a><a href="#h65-1-29" id="h65-1-29" class="d">-                (
</a><a href="#h65-1-30" id="h65-1-30" class="d">-                    Field(
</a><a href="#h65-1-31" id="h65-1-31" class="d">-                        3,
</a><a href="#h65-1-32" id="h65-1-32" class="d">-                        Some(
</a><a href="#h65-1-33" id="h65-1-33" class="d">-                            (
</a><a href="#h65-1-34" id="h65-1-34" class="d">-                                Some(
</a><a href="#h65-1-35" id="h65-1-35" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-1-36" id="h65-1-36" class="d">-                                ),
</a><a href="#h65-1-37" id="h65-1-37" class="d">-                                &quot;title&quot;,
</a><a href="#h65-1-38" id="h65-1-38" class="d">-                            ),
</a><a href="#h65-1-39" id="h65-1-39" class="d">-                        ),
</a><a href="#h65-1-40" id="h65-1-40" class="d">-                    ),
</a><a href="#h65-1-41" id="h65-1-41" class="d">-                    None,
</a><a href="#h65-1-42" id="h65-1-42" class="d">-                ),
</a><a href="#h65-1-43" id="h65-1-43" class="d">-                (
</a><a href="#h65-1-44" id="h65-1-44" class="d">-                    Field(
</a><a href="#h65-1-45" id="h65-1-45" class="d">-                        4,
</a><a href="#h65-1-46" id="h65-1-46" class="d">-                        Some(
</a><a href="#h65-1-47" id="h65-1-47" class="d">-                            (
</a><a href="#h65-1-48" id="h65-1-48" class="d">-                                Some(
</a><a href="#h65-1-49" id="h65-1-49" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-1-50" id="h65-1-50" class="d">-                                ),
</a><a href="#h65-1-51" id="h65-1-51" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h65-1-52" id="h65-1-52" class="i">+                Field(
</a><a href="#h65-1-53" id="h65-1-53" class="i">+                    2,
</a><a href="#h65-1-54" id="h65-1-54" class="i">+                    Some(
</a><a href="#h65-1-55" id="h65-1-55" class="i">+                        (
</a><a href="#h65-1-56" id="h65-1-56" class="i">+                            Some(
</a><a href="#h65-1-57" id="h65-1-57" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-1-59" id="h65-1-59" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h65-1-62" id="h65-1-62" class="d">-                    None,
</a>                 ),
<a href="#h65-1-64" id="h65-1-64" class="d">-                (
</a><a href="#h65-1-65" id="h65-1-65" class="d">-                    Field(
</a><a href="#h65-1-66" id="h65-1-66" class="d">-                        5,
</a><a href="#h65-1-67" id="h65-1-67" class="d">-                        Some(
</a><a href="#h65-1-68" id="h65-1-68" class="d">-                            (
</a><a href="#h65-1-69" id="h65-1-69" class="d">-                                Some(
</a><a href="#h65-1-70" id="h65-1-70" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-1-71" id="h65-1-71" class="d">-                                ),
</a><a href="#h65-1-72" id="h65-1-72" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h65-1-73" id="h65-1-73" class="i">+                Field(
</a><a href="#h65-1-74" id="h65-1-74" class="i">+                    3,
</a><a href="#h65-1-75" id="h65-1-75" class="i">+                    Some(
</a><a href="#h65-1-76" id="h65-1-76" class="i">+                        (
</a><a href="#h65-1-77" id="h65-1-77" class="i">+                            Some(
</a><a href="#h65-1-78" id="h65-1-78" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-1-80" id="h65-1-80" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h65-1-83" id="h65-1-83" class="d">-                    None,
</a>                 ),
<a href="#h65-1-85" id="h65-1-85" class="d">-                (
</a><a href="#h65-1-86" id="h65-1-86" class="d">-                    Field(
</a><a href="#h65-1-87" id="h65-1-87" class="d">-                        6,
</a><a href="#h65-1-88" id="h65-1-88" class="d">-                        Some(
</a><a href="#h65-1-89" id="h65-1-89" class="d">-                            (
</a><a href="#h65-1-90" id="h65-1-90" class="d">-                                Some(
</a><a href="#h65-1-91" id="h65-1-91" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-1-92" id="h65-1-92" class="d">-                                ),
</a><a href="#h65-1-93" id="h65-1-93" class="d">-                                &quot;released&quot;,
</a><a href="#h65-1-94" id="h65-1-94" class="i">+                Field(
</a><a href="#h65-1-95" id="h65-1-95" class="i">+                    4,
</a><a href="#h65-1-96" id="h65-1-96" class="i">+                    Some(
</a><a href="#h65-1-97" id="h65-1-97" class="i">+                        (
</a><a href="#h65-1-98" id="h65-1-98" class="i">+                            Some(
</a><a href="#h65-1-99" id="h65-1-99" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-1-101" id="h65-1-101" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h65-1-104" id="h65-1-104" class="d">-                    None,
</a>                 ),
<a href="#h65-1-106" id="h65-1-106" class="d">-                (
</a><a href="#h65-1-107" id="h65-1-107" class="d">-                    Field(
</a><a href="#h65-1-108" id="h65-1-108" class="d">-                        7,
</a><a href="#h65-1-109" id="h65-1-109" class="d">-                        Some(
</a><a href="#h65-1-110" id="h65-1-110" class="d">-                            (
</a><a href="#h65-1-111" id="h65-1-111" class="d">-                                Some(
</a><a href="#h65-1-112" id="h65-1-112" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-1-113" id="h65-1-113" class="d">-                                ),
</a><a href="#h65-1-114" id="h65-1-114" class="d">-                                &quot;rating&quot;,
</a><a href="#h65-1-115" id="h65-1-115" class="i">+                Field(
</a><a href="#h65-1-116" id="h65-1-116" class="i">+                    5,
</a><a href="#h65-1-117" id="h65-1-117" class="i">+                    Some(
</a><a href="#h65-1-118" id="h65-1-118" class="i">+                        (
</a><a href="#h65-1-119" id="h65-1-119" class="i">+                            Some(
</a><a href="#h65-1-120" id="h65-1-120" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-1-122" id="h65-1-122" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h65-1-125" id="h65-1-125" class="d">-                    None,
</a>                 ),
<a href="#h65-1-127" id="h65-1-127" class="d">-                (
</a><a href="#h65-1-128" id="h65-1-128" class="d">-                    Field(
</a><a href="#h65-1-129" id="h65-1-129" class="d">-                        8,
</a><a href="#h65-1-130" id="h65-1-130" class="d">-                        Some(
</a><a href="#h65-1-131" id="h65-1-131" class="d">-                            (
</a><a href="#h65-1-132" id="h65-1-132" class="d">-                                Some(
</a><a href="#h65-1-133" id="h65-1-133" class="d">-                                    &quot;m&quot;,
</a><a href="#h65-1-134" id="h65-1-134" class="d">-                                ),
</a><a href="#h65-1-135" id="h65-1-135" class="d">-                                &quot;ultrahd&quot;,
</a><a href="#h65-1-136" id="h65-1-136" class="i">+                Field(
</a><a href="#h65-1-137" id="h65-1-137" class="i">+                    6,
</a><a href="#h65-1-138" id="h65-1-138" class="i">+                    Some(
</a><a href="#h65-1-139" id="h65-1-139" class="i">+                        (
</a><a href="#h65-1-140" id="h65-1-140" class="i">+                            Some(
</a><a href="#h65-1-141" id="h65-1-141" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-1-143" id="h65-1-143" class="i">+                            &quot;released&quot;,
</a>                         ),
                     ),
<a href="#h65-1-146" id="h65-1-146" class="d">-                    None,
</a>                 ),
<a href="#h65-1-148" id="h65-1-148" class="d">-                (
</a><a href="#h65-1-149" id="h65-1-149" class="d">-                    Field(
</a><a href="#h65-1-150" id="h65-1-150" class="d">-                        0,
</a><a href="#h65-1-151" id="h65-1-151" class="d">-                        Some(
</a><a href="#h65-1-152" id="h65-1-152" class="d">-                            (
</a><a href="#h65-1-153" id="h65-1-153" class="d">-                                Some(
</a><a href="#h65-1-154" id="h65-1-154" class="d">-                                    &quot;g&quot;,
</a><a href="#h65-1-155" id="h65-1-155" class="d">-                                ),
</a><a href="#h65-1-156" id="h65-1-156" class="d">-                                &quot;id&quot;,
</a><a href="#h65-1-157" id="h65-1-157" class="i">+                Field(
</a><a href="#h65-1-158" id="h65-1-158" class="i">+                    7,
</a><a href="#h65-1-159" id="h65-1-159" class="i">+                    Some(
</a><a href="#h65-1-160" id="h65-1-160" class="i">+                        (
</a><a href="#h65-1-161" id="h65-1-161" class="i">+                            Some(
</a><a href="#h65-1-162" id="h65-1-162" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-1-164" id="h65-1-164" class="i">+                            &quot;rating&quot;,
</a>                         ),
                     ),
<a href="#h65-1-167" id="h65-1-167" class="d">-                    None,
</a>                 ),
<a href="#h65-1-169" id="h65-1-169" class="d">-                (
</a><a href="#h65-1-170" id="h65-1-170" class="d">-                    Field(
</a><a href="#h65-1-171" id="h65-1-171" class="d">-                        1,
</a><a href="#h65-1-172" id="h65-1-172" class="d">-                        Some(
</a><a href="#h65-1-173" id="h65-1-173" class="d">-                            (
</a><a href="#h65-1-174" id="h65-1-174" class="d">-                                Some(
</a><a href="#h65-1-175" id="h65-1-175" class="d">-                                    &quot;g&quot;,
</a><a href="#h65-1-176" id="h65-1-176" class="d">-                                ),
</a><a href="#h65-1-177" id="h65-1-177" class="d">-                                &quot;name&quot;,
</a><a href="#h65-1-178" id="h65-1-178" class="i">+                Field(
</a><a href="#h65-1-179" id="h65-1-179" class="i">+                    8,
</a><a href="#h65-1-180" id="h65-1-180" class="i">+                    Some(
</a><a href="#h65-1-181" id="h65-1-181" class="i">+                        (
</a><a href="#h65-1-182" id="h65-1-182" class="i">+                            Some(
</a><a href="#h65-1-183" id="h65-1-183" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h65-1-185" id="h65-1-185" class="i">+                            &quot;ultrahd&quot;,
</a>                         ),
                     ),
<a href="#h65-1-188" id="h65-1-188" class="d">-                    None,
</a>                 ),
<a href="#h65-1-190" id="h65-1-190" class="d">-            ],
</a><a href="#h65-1-191" id="h65-1-191" class="d">-        },
</a><a href="#h65-1-192" id="h65-1-192" class="d">-        expressions: [
</a><a href="#h65-1-193" id="h65-1-193" class="d">-            (
</a>                 Field(
                     0,
                     Some(
                         (
                             Some(
<a href="#h65-1-199" id="h65-1-199" class="d">-                                &quot;m&quot;,
</a><a href="#h65-1-200" id="h65-1-200" class="i">+                                &quot;g&quot;,
</a>                             ),
                             &quot;id&quot;,
                         ),
                     ),
                 ),
<a href="#h65-1-206" id="h65-1-206" class="d">-                Some(
</a><a href="#h65-1-207" id="h65-1-207" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h65-1-208" id="h65-1-208" class="d">-                ),
</a><a href="#h65-1-209" id="h65-1-209" class="d">-            ),
</a><a href="#h65-1-210" id="h65-1-210" class="d">-            (
</a>                 Field(
<a href="#h65-1-212" id="h65-1-212" class="d">-                    7,
</a><a href="#h65-1-213" id="h65-1-213" class="i">+                    1,
</a>                     Some(
                         (
                             Some(
                                 &quot;g&quot;,
                             ),
<a href="#h65-1-219" id="h65-1-219" class="d">-                            &quot;id&quot;,
</a><a href="#h65-1-220" id="h65-1-220" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h65-1-224" id="h65-1-224" class="d">-                Some(
</a><a href="#h65-1-225" id="h65-1-225" class="i">+            ],
</a><a href="#h65-1-226" id="h65-1-226" class="i">+        },
</a><a href="#h65-1-227" id="h65-1-227" class="i">+        labels: [
</a><a href="#h65-1-228" id="h65-1-228" class="i">+            Some(
</a><a href="#h65-1-229" id="h65-1-229" class="i">+                (
</a><a href="#h65-1-230" id="h65-1-230" class="i">+                    None,
</a><a href="#h65-1-231" id="h65-1-231" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h65-1-232" id="h65-1-232" class="i">+                ),
</a><a href="#h65-1-233" id="h65-1-233" class="i">+            ),
</a><a href="#h65-1-234" id="h65-1-234" class="i">+            Some(
</a><a href="#h65-1-235" id="h65-1-235" class="i">+                (
</a><a href="#h65-1-236" id="h65-1-236" class="i">+                    None,
</a>                     &quot;genre_id&quot;,
                 ),
             ),
         ],
<a href="#h65-1-241" id="h65-1-241" class="i">+        expressions: [
</a><a href="#h65-1-242" id="h65-1-242" class="i">+            Field(
</a><a href="#h65-1-243" id="h65-1-243" class="i">+                0,
</a><a href="#h65-1-244" id="h65-1-244" class="i">+                Some(
</a><a href="#h65-1-245" id="h65-1-245" class="i">+                    (
</a><a href="#h65-1-246" id="h65-1-246" class="i">+                        Some(
</a><a href="#h65-1-247" id="h65-1-247" class="i">+                            &quot;m&quot;,
</a><a href="#h65-1-248" id="h65-1-248" class="i">+                        ),
</a><a href="#h65-1-249" id="h65-1-249" class="i">+                        &quot;id&quot;,
</a><a href="#h65-1-250" id="h65-1-250" class="i">+                    ),
</a><a href="#h65-1-251" id="h65-1-251" class="i">+                ),
</a><a href="#h65-1-252" id="h65-1-252" class="i">+            ),
</a><a href="#h65-1-253" id="h65-1-253" class="i">+            Field(
</a><a href="#h65-1-254" id="h65-1-254" class="i">+                7,
</a><a href="#h65-1-255" id="h65-1-255" class="i">+                Some(
</a><a href="#h65-1-256" id="h65-1-256" class="i">+                    (
</a><a href="#h65-1-257" id="h65-1-257" class="i">+                        Some(
</a><a href="#h65-1-258" id="h65-1-258" class="i">+                            &quot;g&quot;,
</a><a href="#h65-1-259" id="h65-1-259" class="i">+                        ),
</a><a href="#h65-1-260" id="h65-1-260" class="i">+                        &quot;id&quot;,
</a><a href="#h65-1-261" id="h65-1-261" class="i">+                    ),
</a><a href="#h65-1-262" id="h65-1-262" class="i">+                ),
</a><a href="#h65-1-263" id="h65-1-263" class="i">+            ),
</a><a href="#h65-1-264" id="h65-1-264" class="i">+        ],
</a>     },
 )
 
<b>diff --git a/<a id="h66" href="../file/tests/sql/query/lowercase.html">tests/sql/query/lowercase</a> b/<a href="../file/tests/sql/query/lowercase.html">tests/sql/query/lowercase</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -30,14 +30,14 @@ AST: Select {
</a> Plan: Select(
     Projection {
         source: Nothing,
<a href="#h66-0-3" id="h66-0-3" class="i">+        labels: [
</a><a href="#h66-0-4" id="h66-0-4" class="i">+            None,
</a><a href="#h66-0-5" id="h66-0-5" class="i">+        ],
</a>         expressions: [
<a href="#h66-0-7" id="h66-0-7" class="d">-            (
</a><a href="#h66-0-8" id="h66-0-8" class="d">-                Constant(
</a><a href="#h66-0-9" id="h66-0-9" class="d">-                    Integer(
</a><a href="#h66-0-10" id="h66-0-10" class="d">-                        1,
</a><a href="#h66-0-11" id="h66-0-11" class="d">-                    ),
</a><a href="#h66-0-12" id="h66-0-12" class="i">+            Constant(
</a><a href="#h66-0-13" id="h66-0-13" class="i">+                Integer(
</a><a href="#h66-0-14" id="h66-0-14" class="i">+                    1,
</a>                 ),
<a href="#h66-0-16" id="h66-0-16" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h66-1" id="h66-1" class="h">@@ -46,14 +46,14 @@ Plan: Select(
</a> Optimized plan: Select(
     Projection {
         source: Nothing,
<a href="#h66-1-3" id="h66-1-3" class="i">+        labels: [
</a><a href="#h66-1-4" id="h66-1-4" class="i">+            None,
</a><a href="#h66-1-5" id="h66-1-5" class="i">+        ],
</a>         expressions: [
<a href="#h66-1-7" id="h66-1-7" class="d">-            (
</a><a href="#h66-1-8" id="h66-1-8" class="d">-                Constant(
</a><a href="#h66-1-9" id="h66-1-9" class="d">-                    Integer(
</a><a href="#h66-1-10" id="h66-1-10" class="d">-                        1,
</a><a href="#h66-1-11" id="h66-1-11" class="d">-                    ),
</a><a href="#h66-1-12" id="h66-1-12" class="i">+            Constant(
</a><a href="#h66-1-13" id="h66-1-13" class="i">+                Integer(
</a><a href="#h66-1-14" id="h66-1-14" class="i">+                    1,
</a>                 ),
<a href="#h66-1-16" id="h66-1-16" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h67" href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a> b/<a href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -153,30 +153,28 @@ Plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h67-0-3" id="h67-0-3" class="i">+                    labels: [
</a><a href="#h67-0-4" id="h67-0-4" class="i">+                        None,
</a><a href="#h67-0-5" id="h67-0-5" class="i">+                        None,
</a><a href="#h67-0-6" id="h67-0-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h67-0-8" id="h67-0-8" class="d">-                        (
</a><a href="#h67-0-9" id="h67-0-9" class="d">-                            Field(
</a><a href="#h67-0-10" id="h67-0-10" class="d">-                                5,
</a><a href="#h67-0-11" id="h67-0-11" class="d">-                                Some(
</a><a href="#h67-0-12" id="h67-0-12" class="d">-                                    (
</a><a href="#h67-0-13" id="h67-0-13" class="d">-                                        None,
</a><a href="#h67-0-14" id="h67-0-14" class="d">-                                        &quot;rating&quot;,
</a><a href="#h67-0-15" id="h67-0-15" class="d">-                                    ),
</a><a href="#h67-0-16" id="h67-0-16" class="i">+                        Field(
</a><a href="#h67-0-17" id="h67-0-17" class="i">+                            5,
</a><a href="#h67-0-18" id="h67-0-18" class="i">+                            Some(
</a><a href="#h67-0-19" id="h67-0-19" class="i">+                                (
</a><a href="#h67-0-20" id="h67-0-20" class="i">+                                    None,
</a><a href="#h67-0-21" id="h67-0-21" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h67-0-24" id="h67-0-24" class="d">-                            None,
</a>                         ),
<a href="#h67-0-26" id="h67-0-26" class="d">-                        (
</a><a href="#h67-0-27" id="h67-0-27" class="d">-                            Field(
</a><a href="#h67-0-28" id="h67-0-28" class="d">-                                2,
</a><a href="#h67-0-29" id="h67-0-29" class="d">-                                Some(
</a><a href="#h67-0-30" id="h67-0-30" class="d">-                                    (
</a><a href="#h67-0-31" id="h67-0-31" class="d">-                                        None,
</a><a href="#h67-0-32" id="h67-0-32" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h67-0-33" id="h67-0-33" class="d">-                                    ),
</a><a href="#h67-0-34" id="h67-0-34" class="i">+                        Field(
</a><a href="#h67-0-35" id="h67-0-35" class="i">+                            2,
</a><a href="#h67-0-36" id="h67-0-36" class="i">+                            Some(
</a><a href="#h67-0-37" id="h67-0-37" class="i">+                                (
</a><a href="#h67-0-38" id="h67-0-38" class="i">+                                    None,
</a><a href="#h67-0-39" id="h67-0-39" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h67-0-42" id="h67-0-42" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h67-1" id="h67-1" class="h">@@ -184,26 +182,24 @@ Plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h67-1-3" id="h67-1-3" class="i">+            labels: [
</a><a href="#h67-1-4" id="h67-1-4" class="i">+                None,
</a><a href="#h67-1-5" id="h67-1-5" class="i">+                None,
</a><a href="#h67-1-6" id="h67-1-6" class="i">+            ],
</a>             expressions: [
<a href="#h67-1-8" id="h67-1-8" class="d">-                (
</a><a href="#h67-1-9" id="h67-1-9" class="d">-                    Field(
</a><a href="#h67-1-10" id="h67-1-10" class="d">-                        1,
</a><a href="#h67-1-11" id="h67-1-11" class="d">-                        Some(
</a><a href="#h67-1-12" id="h67-1-12" class="d">-                            (
</a><a href="#h67-1-13" id="h67-1-13" class="d">-                                Some(
</a><a href="#h67-1-14" id="h67-1-14" class="d">-                                    &quot;movies&quot;,
</a><a href="#h67-1-15" id="h67-1-15" class="d">-                                ),
</a><a href="#h67-1-16" id="h67-1-16" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h67-1-17" id="h67-1-17" class="i">+                Field(
</a><a href="#h67-1-18" id="h67-1-18" class="i">+                    1,
</a><a href="#h67-1-19" id="h67-1-19" class="i">+                    Some(
</a><a href="#h67-1-20" id="h67-1-20" class="i">+                        (
</a><a href="#h67-1-21" id="h67-1-21" class="i">+                            Some(
</a><a href="#h67-1-22" id="h67-1-22" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h67-1-24" id="h67-1-24" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h67-1-27" id="h67-1-27" class="d">-                    None,
</a>                 ),
<a href="#h67-1-29" id="h67-1-29" class="d">-                (
</a><a href="#h67-1-30" id="h67-1-30" class="d">-                    Field(
</a><a href="#h67-1-31" id="h67-1-31" class="d">-                        0,
</a><a href="#h67-1-32" id="h67-1-32" class="d">-                        None,
</a><a href="#h67-1-33" id="h67-1-33" class="d">-                    ),
</a><a href="#h67-1-34" id="h67-1-34" class="i">+                Field(
</a><a href="#h67-1-35" id="h67-1-35" class="i">+                    0,
</a>                     None,
                 ),
             ],
<a href="#h67-2" id="h67-2" class="h">@@ -306,30 +302,28 @@ Optimized plan: Select(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h67-2-3" id="h67-2-3" class="i">+                    labels: [
</a><a href="#h67-2-4" id="h67-2-4" class="i">+                        None,
</a><a href="#h67-2-5" id="h67-2-5" class="i">+                        None,
</a><a href="#h67-2-6" id="h67-2-6" class="i">+                    ],
</a>                     expressions: [
<a href="#h67-2-8" id="h67-2-8" class="d">-                        (
</a><a href="#h67-2-9" id="h67-2-9" class="d">-                            Field(
</a><a href="#h67-2-10" id="h67-2-10" class="d">-                                5,
</a><a href="#h67-2-11" id="h67-2-11" class="d">-                                Some(
</a><a href="#h67-2-12" id="h67-2-12" class="d">-                                    (
</a><a href="#h67-2-13" id="h67-2-13" class="d">-                                        None,
</a><a href="#h67-2-14" id="h67-2-14" class="d">-                                        &quot;rating&quot;,
</a><a href="#h67-2-15" id="h67-2-15" class="d">-                                    ),
</a><a href="#h67-2-16" id="h67-2-16" class="i">+                        Field(
</a><a href="#h67-2-17" id="h67-2-17" class="i">+                            5,
</a><a href="#h67-2-18" id="h67-2-18" class="i">+                            Some(
</a><a href="#h67-2-19" id="h67-2-19" class="i">+                                (
</a><a href="#h67-2-20" id="h67-2-20" class="i">+                                    None,
</a><a href="#h67-2-21" id="h67-2-21" class="i">+                                    &quot;rating&quot;,
</a>                                 ),
                             ),
<a href="#h67-2-24" id="h67-2-24" class="d">-                            None,
</a>                         ),
<a href="#h67-2-26" id="h67-2-26" class="d">-                        (
</a><a href="#h67-2-27" id="h67-2-27" class="d">-                            Field(
</a><a href="#h67-2-28" id="h67-2-28" class="d">-                                2,
</a><a href="#h67-2-29" id="h67-2-29" class="d">-                                Some(
</a><a href="#h67-2-30" id="h67-2-30" class="d">-                                    (
</a><a href="#h67-2-31" id="h67-2-31" class="d">-                                        None,
</a><a href="#h67-2-32" id="h67-2-32" class="d">-                                        &quot;studio_id&quot;,
</a><a href="#h67-2-33" id="h67-2-33" class="d">-                                    ),
</a><a href="#h67-2-34" id="h67-2-34" class="i">+                        Field(
</a><a href="#h67-2-35" id="h67-2-35" class="i">+                            2,
</a><a href="#h67-2-36" id="h67-2-36" class="i">+                            Some(
</a><a href="#h67-2-37" id="h67-2-37" class="i">+                                (
</a><a href="#h67-2-38" id="h67-2-38" class="i">+                                    None,
</a><a href="#h67-2-39" id="h67-2-39" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
<a href="#h67-2-42" id="h67-2-42" class="d">-                            None,
</a>                         ),
                     ],
                 },
<a href="#h67-3" id="h67-3" class="h">@@ -337,26 +331,24 @@ Optimized plan: Select(
</a>                     Max,
                 ],
             },
<a href="#h67-3-3" id="h67-3-3" class="i">+            labels: [
</a><a href="#h67-3-4" id="h67-3-4" class="i">+                None,
</a><a href="#h67-3-5" id="h67-3-5" class="i">+                None,
</a><a href="#h67-3-6" id="h67-3-6" class="i">+            ],
</a>             expressions: [
<a href="#h67-3-8" id="h67-3-8" class="d">-                (
</a><a href="#h67-3-9" id="h67-3-9" class="d">-                    Field(
</a><a href="#h67-3-10" id="h67-3-10" class="d">-                        1,
</a><a href="#h67-3-11" id="h67-3-11" class="d">-                        Some(
</a><a href="#h67-3-12" id="h67-3-12" class="d">-                            (
</a><a href="#h67-3-13" id="h67-3-13" class="d">-                                Some(
</a><a href="#h67-3-14" id="h67-3-14" class="d">-                                    &quot;movies&quot;,
</a><a href="#h67-3-15" id="h67-3-15" class="d">-                                ),
</a><a href="#h67-3-16" id="h67-3-16" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h67-3-17" id="h67-3-17" class="i">+                Field(
</a><a href="#h67-3-18" id="h67-3-18" class="i">+                    1,
</a><a href="#h67-3-19" id="h67-3-19" class="i">+                    Some(
</a><a href="#h67-3-20" id="h67-3-20" class="i">+                        (
</a><a href="#h67-3-21" id="h67-3-21" class="i">+                            Some(
</a><a href="#h67-3-22" id="h67-3-22" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h67-3-24" id="h67-3-24" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
<a href="#h67-3-27" id="h67-3-27" class="d">-                    None,
</a>                 ),
<a href="#h67-3-29" id="h67-3-29" class="d">-                (
</a><a href="#h67-3-30" id="h67-3-30" class="d">-                    Field(
</a><a href="#h67-3-31" id="h67-3-31" class="d">-                        0,
</a><a href="#h67-3-32" id="h67-3-32" class="d">-                        None,
</a><a href="#h67-3-33" id="h67-3-33" class="d">-                    ),
</a><a href="#h67-3-34" id="h67-3-34" class="i">+                Field(
</a><a href="#h67-3-35" id="h67-3-35" class="i">+                    0,
</a>                     None,
                 ),
             ],
<b>diff --git a/<a id="h68" href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a> b/<a href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -155,42 +155,38 @@ Plan: Select(
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h68-0-3" id="h68-0-3" class="i">+                        labels: [
</a><a href="#h68-0-4" id="h68-0-4" class="i">+                            None,
</a><a href="#h68-0-5" id="h68-0-5" class="i">+                            None,
</a><a href="#h68-0-6" id="h68-0-6" class="i">+                            None,
</a><a href="#h68-0-7" id="h68-0-7" class="i">+                        ],
</a>                         expressions: [
<a href="#h68-0-9" id="h68-0-9" class="d">-                            (
</a><a href="#h68-0-10" id="h68-0-10" class="d">-                                Field(
</a><a href="#h68-0-11" id="h68-0-11" class="d">-                                    5,
</a><a href="#h68-0-12" id="h68-0-12" class="d">-                                    Some(
</a><a href="#h68-0-13" id="h68-0-13" class="d">-                                        (
</a><a href="#h68-0-14" id="h68-0-14" class="d">-                                            None,
</a><a href="#h68-0-15" id="h68-0-15" class="d">-                                            &quot;rating&quot;,
</a><a href="#h68-0-16" id="h68-0-16" class="d">-                                        ),
</a><a href="#h68-0-17" id="h68-0-17" class="i">+                            Field(
</a><a href="#h68-0-18" id="h68-0-18" class="i">+                                5,
</a><a href="#h68-0-19" id="h68-0-19" class="i">+                                Some(
</a><a href="#h68-0-20" id="h68-0-20" class="i">+                                    (
</a><a href="#h68-0-21" id="h68-0-21" class="i">+                                        None,
</a><a href="#h68-0-22" id="h68-0-22" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
<a href="#h68-0-25" id="h68-0-25" class="d">-                                None,
</a>                             ),
<a href="#h68-0-27" id="h68-0-27" class="d">-                            (
</a><a href="#h68-0-28" id="h68-0-28" class="d">-                                Field(
</a><a href="#h68-0-29" id="h68-0-29" class="d">-                                    5,
</a><a href="#h68-0-30" id="h68-0-30" class="d">-                                    Some(
</a><a href="#h68-0-31" id="h68-0-31" class="d">-                                        (
</a><a href="#h68-0-32" id="h68-0-32" class="d">-                                            None,
</a><a href="#h68-0-33" id="h68-0-33" class="d">-                                            &quot;rating&quot;,
</a><a href="#h68-0-34" id="h68-0-34" class="d">-                                        ),
</a><a href="#h68-0-35" id="h68-0-35" class="i">+                            Field(
</a><a href="#h68-0-36" id="h68-0-36" class="i">+                                5,
</a><a href="#h68-0-37" id="h68-0-37" class="i">+                                Some(
</a><a href="#h68-0-38" id="h68-0-38" class="i">+                                    (
</a><a href="#h68-0-39" id="h68-0-39" class="i">+                                        None,
</a><a href="#h68-0-40" id="h68-0-40" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
<a href="#h68-0-43" id="h68-0-43" class="d">-                                None,
</a>                             ),
<a href="#h68-0-45" id="h68-0-45" class="d">-                            (
</a><a href="#h68-0-46" id="h68-0-46" class="d">-                                Field(
</a><a href="#h68-0-47" id="h68-0-47" class="d">-                                    2,
</a><a href="#h68-0-48" id="h68-0-48" class="d">-                                    Some(
</a><a href="#h68-0-49" id="h68-0-49" class="d">-                                        (
</a><a href="#h68-0-50" id="h68-0-50" class="d">-                                            None,
</a><a href="#h68-0-51" id="h68-0-51" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h68-0-52" id="h68-0-52" class="d">-                                        ),
</a><a href="#h68-0-53" id="h68-0-53" class="i">+                            Field(
</a><a href="#h68-0-54" id="h68-0-54" class="i">+                                2,
</a><a href="#h68-0-55" id="h68-0-55" class="i">+                                Some(
</a><a href="#h68-0-56" id="h68-0-56" class="i">+                                    (
</a><a href="#h68-0-57" id="h68-0-57" class="i">+                                        None,
</a><a href="#h68-0-58" id="h68-0-58" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
<a href="#h68-0-61" id="h68-0-61" class="d">-                                None,
</a>                             ),
                         ],
                     },
<a href="#h68-1" id="h68-1" class="h">@@ -199,33 +195,29 @@ Plan: Select(
</a>                         Min,
                     ],
                 },
<a href="#h68-1-3" id="h68-1-3" class="i">+                labels: [
</a><a href="#h68-1-4" id="h68-1-4" class="i">+                    None,
</a><a href="#h68-1-5" id="h68-1-5" class="i">+                    None,
</a><a href="#h68-1-6" id="h68-1-6" class="i">+                    None,
</a><a href="#h68-1-7" id="h68-1-7" class="i">+                ],
</a>                 expressions: [
<a href="#h68-1-9" id="h68-1-9" class="d">-                    (
</a><a href="#h68-1-10" id="h68-1-10" class="d">-                        Field(
</a><a href="#h68-1-11" id="h68-1-11" class="d">-                            2,
</a><a href="#h68-1-12" id="h68-1-12" class="d">-                            Some(
</a><a href="#h68-1-13" id="h68-1-13" class="d">-                                (
</a><a href="#h68-1-14" id="h68-1-14" class="d">-                                    Some(
</a><a href="#h68-1-15" id="h68-1-15" class="d">-                                        &quot;movies&quot;,
</a><a href="#h68-1-16" id="h68-1-16" class="d">-                                    ),
</a><a href="#h68-1-17" id="h68-1-17" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h68-1-18" id="h68-1-18" class="i">+                    Field(
</a><a href="#h68-1-19" id="h68-1-19" class="i">+                        2,
</a><a href="#h68-1-20" id="h68-1-20" class="i">+                        Some(
</a><a href="#h68-1-21" id="h68-1-21" class="i">+                            (
</a><a href="#h68-1-22" id="h68-1-22" class="i">+                                Some(
</a><a href="#h68-1-23" id="h68-1-23" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h68-1-25" id="h68-1-25" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h68-1-28" id="h68-1-28" class="d">-                        None,
</a>                     ),
<a href="#h68-1-30" id="h68-1-30" class="d">-                    (
</a><a href="#h68-1-31" id="h68-1-31" class="d">-                        Field(
</a><a href="#h68-1-32" id="h68-1-32" class="d">-                            0,
</a><a href="#h68-1-33" id="h68-1-33" class="d">-                            None,
</a><a href="#h68-1-34" id="h68-1-34" class="d">-                        ),
</a><a href="#h68-1-35" id="h68-1-35" class="i">+                    Field(
</a><a href="#h68-1-36" id="h68-1-36" class="i">+                        0,
</a>                         None,
                     ),
<a href="#h68-1-39" id="h68-1-39" class="d">-                    (
</a><a href="#h68-1-40" id="h68-1-40" class="d">-                        Field(
</a><a href="#h68-1-41" id="h68-1-41" class="d">-                            1,
</a><a href="#h68-1-42" id="h68-1-42" class="d">-                            None,
</a><a href="#h68-1-43" id="h68-1-43" class="d">-                        ),
</a><a href="#h68-1-44" id="h68-1-44" class="i">+                    Field(
</a><a href="#h68-1-45" id="h68-1-45" class="i">+                        1,
</a>                         None,
                     ),
                 ],
<a href="#h68-2" id="h68-2" class="h">@@ -240,19 +232,17 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h68-2-3" id="h68-2-3" class="i">+        labels: [
</a><a href="#h68-2-4" id="h68-2-4" class="i">+            None,
</a><a href="#h68-2-5" id="h68-2-5" class="i">+            None,
</a><a href="#h68-2-6" id="h68-2-6" class="i">+        ],
</a>         expressions: [
<a href="#h68-2-8" id="h68-2-8" class="d">-            (
</a><a href="#h68-2-9" id="h68-2-9" class="d">-                Field(
</a><a href="#h68-2-10" id="h68-2-10" class="d">-                    0,
</a><a href="#h68-2-11" id="h68-2-11" class="d">-                    None,
</a><a href="#h68-2-12" id="h68-2-12" class="d">-                ),
</a><a href="#h68-2-13" id="h68-2-13" class="i">+            Field(
</a><a href="#h68-2-14" id="h68-2-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h68-2-17" id="h68-2-17" class="d">-            (
</a><a href="#h68-2-18" id="h68-2-18" class="d">-                Field(
</a><a href="#h68-2-19" id="h68-2-19" class="d">-                    1,
</a><a href="#h68-2-20" id="h68-2-20" class="d">-                    None,
</a><a href="#h68-2-21" id="h68-2-21" class="d">-                ),
</a><a href="#h68-2-22" id="h68-2-22" class="i">+            Field(
</a><a href="#h68-2-23" id="h68-2-23" class="i">+                1,
</a>                 None,
             ),
         ],
<a href="#h68-3" id="h68-3" class="h">@@ -346,42 +336,38 @@ Optimized plan: Select(
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h68-3-3" id="h68-3-3" class="i">+                        labels: [
</a><a href="#h68-3-4" id="h68-3-4" class="i">+                            None,
</a><a href="#h68-3-5" id="h68-3-5" class="i">+                            None,
</a><a href="#h68-3-6" id="h68-3-6" class="i">+                            None,
</a><a href="#h68-3-7" id="h68-3-7" class="i">+                        ],
</a>                         expressions: [
<a href="#h68-3-9" id="h68-3-9" class="d">-                            (
</a><a href="#h68-3-10" id="h68-3-10" class="d">-                                Field(
</a><a href="#h68-3-11" id="h68-3-11" class="d">-                                    5,
</a><a href="#h68-3-12" id="h68-3-12" class="d">-                                    Some(
</a><a href="#h68-3-13" id="h68-3-13" class="d">-                                        (
</a><a href="#h68-3-14" id="h68-3-14" class="d">-                                            None,
</a><a href="#h68-3-15" id="h68-3-15" class="d">-                                            &quot;rating&quot;,
</a><a href="#h68-3-16" id="h68-3-16" class="d">-                                        ),
</a><a href="#h68-3-17" id="h68-3-17" class="i">+                            Field(
</a><a href="#h68-3-18" id="h68-3-18" class="i">+                                5,
</a><a href="#h68-3-19" id="h68-3-19" class="i">+                                Some(
</a><a href="#h68-3-20" id="h68-3-20" class="i">+                                    (
</a><a href="#h68-3-21" id="h68-3-21" class="i">+                                        None,
</a><a href="#h68-3-22" id="h68-3-22" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
<a href="#h68-3-25" id="h68-3-25" class="d">-                                None,
</a>                             ),
<a href="#h68-3-27" id="h68-3-27" class="d">-                            (
</a><a href="#h68-3-28" id="h68-3-28" class="d">-                                Field(
</a><a href="#h68-3-29" id="h68-3-29" class="d">-                                    5,
</a><a href="#h68-3-30" id="h68-3-30" class="d">-                                    Some(
</a><a href="#h68-3-31" id="h68-3-31" class="d">-                                        (
</a><a href="#h68-3-32" id="h68-3-32" class="d">-                                            None,
</a><a href="#h68-3-33" id="h68-3-33" class="d">-                                            &quot;rating&quot;,
</a><a href="#h68-3-34" id="h68-3-34" class="d">-                                        ),
</a><a href="#h68-3-35" id="h68-3-35" class="i">+                            Field(
</a><a href="#h68-3-36" id="h68-3-36" class="i">+                                5,
</a><a href="#h68-3-37" id="h68-3-37" class="i">+                                Some(
</a><a href="#h68-3-38" id="h68-3-38" class="i">+                                    (
</a><a href="#h68-3-39" id="h68-3-39" class="i">+                                        None,
</a><a href="#h68-3-40" id="h68-3-40" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
<a href="#h68-3-43" id="h68-3-43" class="d">-                                None,
</a>                             ),
<a href="#h68-3-45" id="h68-3-45" class="d">-                            (
</a><a href="#h68-3-46" id="h68-3-46" class="d">-                                Field(
</a><a href="#h68-3-47" id="h68-3-47" class="d">-                                    2,
</a><a href="#h68-3-48" id="h68-3-48" class="d">-                                    Some(
</a><a href="#h68-3-49" id="h68-3-49" class="d">-                                        (
</a><a href="#h68-3-50" id="h68-3-50" class="d">-                                            None,
</a><a href="#h68-3-51" id="h68-3-51" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h68-3-52" id="h68-3-52" class="d">-                                        ),
</a><a href="#h68-3-53" id="h68-3-53" class="i">+                            Field(
</a><a href="#h68-3-54" id="h68-3-54" class="i">+                                2,
</a><a href="#h68-3-55" id="h68-3-55" class="i">+                                Some(
</a><a href="#h68-3-56" id="h68-3-56" class="i">+                                    (
</a><a href="#h68-3-57" id="h68-3-57" class="i">+                                        None,
</a><a href="#h68-3-58" id="h68-3-58" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
<a href="#h68-3-61" id="h68-3-61" class="d">-                                None,
</a>                             ),
                         ],
                     },
<a href="#h68-4" id="h68-4" class="h">@@ -390,33 +376,29 @@ Optimized plan: Select(
</a>                         Min,
                     ],
                 },
<a href="#h68-4-3" id="h68-4-3" class="i">+                labels: [
</a><a href="#h68-4-4" id="h68-4-4" class="i">+                    None,
</a><a href="#h68-4-5" id="h68-4-5" class="i">+                    None,
</a><a href="#h68-4-6" id="h68-4-6" class="i">+                    None,
</a><a href="#h68-4-7" id="h68-4-7" class="i">+                ],
</a>                 expressions: [
<a href="#h68-4-9" id="h68-4-9" class="d">-                    (
</a><a href="#h68-4-10" id="h68-4-10" class="d">-                        Field(
</a><a href="#h68-4-11" id="h68-4-11" class="d">-                            2,
</a><a href="#h68-4-12" id="h68-4-12" class="d">-                            Some(
</a><a href="#h68-4-13" id="h68-4-13" class="d">-                                (
</a><a href="#h68-4-14" id="h68-4-14" class="d">-                                    Some(
</a><a href="#h68-4-15" id="h68-4-15" class="d">-                                        &quot;movies&quot;,
</a><a href="#h68-4-16" id="h68-4-16" class="d">-                                    ),
</a><a href="#h68-4-17" id="h68-4-17" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h68-4-18" id="h68-4-18" class="i">+                    Field(
</a><a href="#h68-4-19" id="h68-4-19" class="i">+                        2,
</a><a href="#h68-4-20" id="h68-4-20" class="i">+                        Some(
</a><a href="#h68-4-21" id="h68-4-21" class="i">+                            (
</a><a href="#h68-4-22" id="h68-4-22" class="i">+                                Some(
</a><a href="#h68-4-23" id="h68-4-23" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h68-4-25" id="h68-4-25" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h68-4-28" id="h68-4-28" class="d">-                        None,
</a>                     ),
<a href="#h68-4-30" id="h68-4-30" class="d">-                    (
</a><a href="#h68-4-31" id="h68-4-31" class="d">-                        Field(
</a><a href="#h68-4-32" id="h68-4-32" class="d">-                            0,
</a><a href="#h68-4-33" id="h68-4-33" class="d">-                            None,
</a><a href="#h68-4-34" id="h68-4-34" class="d">-                        ),
</a><a href="#h68-4-35" id="h68-4-35" class="i">+                    Field(
</a><a href="#h68-4-36" id="h68-4-36" class="i">+                        0,
</a>                         None,
                     ),
<a href="#h68-4-39" id="h68-4-39" class="d">-                    (
</a><a href="#h68-4-40" id="h68-4-40" class="d">-                        Field(
</a><a href="#h68-4-41" id="h68-4-41" class="d">-                            1,
</a><a href="#h68-4-42" id="h68-4-42" class="d">-                            None,
</a><a href="#h68-4-43" id="h68-4-43" class="d">-                        ),
</a><a href="#h68-4-44" id="h68-4-44" class="i">+                    Field(
</a><a href="#h68-4-45" id="h68-4-45" class="i">+                        1,
</a>                         None,
                     ),
                 ],
<a href="#h68-5" id="h68-5" class="h">@@ -431,19 +413,17 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h68-5-3" id="h68-5-3" class="i">+        labels: [
</a><a href="#h68-5-4" id="h68-5-4" class="i">+            None,
</a><a href="#h68-5-5" id="h68-5-5" class="i">+            None,
</a><a href="#h68-5-6" id="h68-5-6" class="i">+        ],
</a>         expressions: [
<a href="#h68-5-8" id="h68-5-8" class="d">-            (
</a><a href="#h68-5-9" id="h68-5-9" class="d">-                Field(
</a><a href="#h68-5-10" id="h68-5-10" class="d">-                    0,
</a><a href="#h68-5-11" id="h68-5-11" class="d">-                    None,
</a><a href="#h68-5-12" id="h68-5-12" class="d">-                ),
</a><a href="#h68-5-13" id="h68-5-13" class="i">+            Field(
</a><a href="#h68-5-14" id="h68-5-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h68-5-17" id="h68-5-17" class="d">-            (
</a><a href="#h68-5-18" id="h68-5-18" class="d">-                Field(
</a><a href="#h68-5-19" id="h68-5-19" class="d">-                    1,
</a><a href="#h68-5-20" id="h68-5-20" class="d">-                    None,
</a><a href="#h68-5-21" id="h68-5-21" class="d">-                ),
</a><a href="#h68-5-22" id="h68-5-22" class="i">+            Field(
</a><a href="#h68-5-23" id="h68-5-23" class="i">+                1,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h69" href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a> b/<a href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -174,32 +174,46 @@ Plan: Select(
</a>                 alias: None,
                 filter: None,
             },
<a href="#h69-0-3" id="h69-0-3" class="i">+            labels: [
</a><a href="#h69-0-4" id="h69-0-4" class="i">+                None,
</a><a href="#h69-0-5" id="h69-0-5" class="i">+                None,
</a><a href="#h69-0-6" id="h69-0-6" class="i">+                None,
</a><a href="#h69-0-7" id="h69-0-7" class="i">+                Some(
</a><a href="#h69-0-8" id="h69-0-8" class="i">+                    (
</a><a href="#h69-0-9" id="h69-0-9" class="i">+                        None,
</a><a href="#h69-0-10" id="h69-0-10" class="i">+                        &quot;ord&quot;,
</a><a href="#h69-0-11" id="h69-0-11" class="i">+                    ),
</a><a href="#h69-0-12" id="h69-0-12" class="i">+                ),
</a><a href="#h69-0-13" id="h69-0-13" class="i">+            ],
</a>             expressions: [
<a href="#h69-0-15" id="h69-0-15" class="d">-                (
</a><a href="#h69-0-16" id="h69-0-16" class="d">-                    Field(
</a><a href="#h69-0-17" id="h69-0-17" class="d">-                        0,
</a><a href="#h69-0-18" id="h69-0-18" class="d">-                        Some(
</a><a href="#h69-0-19" id="h69-0-19" class="d">-                            (
</a><a href="#h69-0-20" id="h69-0-20" class="d">-                                None,
</a><a href="#h69-0-21" id="h69-0-21" class="d">-                                &quot;id&quot;,
</a><a href="#h69-0-22" id="h69-0-22" class="d">-                            ),
</a><a href="#h69-0-23" id="h69-0-23" class="i">+                Field(
</a><a href="#h69-0-24" id="h69-0-24" class="i">+                    0,
</a><a href="#h69-0-25" id="h69-0-25" class="i">+                    Some(
</a><a href="#h69-0-26" id="h69-0-26" class="i">+                        (
</a><a href="#h69-0-27" id="h69-0-27" class="i">+                            None,
</a><a href="#h69-0-28" id="h69-0-28" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h69-0-31" id="h69-0-31" class="d">-                    None,
</a>                 ),
<a href="#h69-0-33" id="h69-0-33" class="d">-                (
</a><a href="#h69-0-34" id="h69-0-34" class="d">-                    Field(
</a><a href="#h69-0-35" id="h69-0-35" class="d">-                        1,
</a><a href="#h69-0-36" id="h69-0-36" class="d">-                        Some(
</a><a href="#h69-0-37" id="h69-0-37" class="d">-                            (
</a><a href="#h69-0-38" id="h69-0-38" class="d">-                                None,
</a><a href="#h69-0-39" id="h69-0-39" class="d">-                                &quot;title&quot;,
</a><a href="#h69-0-40" id="h69-0-40" class="d">-                            ),
</a><a href="#h69-0-41" id="h69-0-41" class="i">+                Field(
</a><a href="#h69-0-42" id="h69-0-42" class="i">+                    1,
</a><a href="#h69-0-43" id="h69-0-43" class="i">+                    Some(
</a><a href="#h69-0-44" id="h69-0-44" class="i">+                        (
</a><a href="#h69-0-45" id="h69-0-45" class="i">+                            None,
</a><a href="#h69-0-46" id="h69-0-46" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h69-0-49" id="h69-0-49" class="d">-                    None,
</a>                 ),
<a href="#h69-0-51" id="h69-0-51" class="d">-                (
</a><a href="#h69-0-52" id="h69-0-52" class="i">+                Field(
</a><a href="#h69-0-53" id="h69-0-53" class="i">+                    4,
</a><a href="#h69-0-54" id="h69-0-54" class="i">+                    Some(
</a><a href="#h69-0-55" id="h69-0-55" class="i">+                        (
</a><a href="#h69-0-56" id="h69-0-56" class="i">+                            None,
</a><a href="#h69-0-57" id="h69-0-57" class="i">+                            &quot;released&quot;,
</a><a href="#h69-0-58" id="h69-0-58" class="i">+                        ),
</a><a href="#h69-0-59" id="h69-0-59" class="i">+                    ),
</a><a href="#h69-0-60" id="h69-0-60" class="i">+                ),
</a><a href="#h69-0-61" id="h69-0-61" class="i">+                Modulo(
</a>                     Field(
                         4,
                         Some(
<a href="#h69-1" id="h69-1" class="h">@@ -209,27 +223,10 @@ Plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h69-1-3" id="h69-1-3" class="d">-                    None,
</a><a href="#h69-1-4" id="h69-1-4" class="d">-                ),
</a><a href="#h69-1-5" id="h69-1-5" class="d">-                (
</a><a href="#h69-1-6" id="h69-1-6" class="d">-                    Modulo(
</a><a href="#h69-1-7" id="h69-1-7" class="d">-                        Field(
</a><a href="#h69-1-8" id="h69-1-8" class="i">+                    Constant(
</a><a href="#h69-1-9" id="h69-1-9" class="i">+                        Integer(
</a>                             4,
<a href="#h69-1-11" id="h69-1-11" class="d">-                            Some(
</a><a href="#h69-1-12" id="h69-1-12" class="d">-                                (
</a><a href="#h69-1-13" id="h69-1-13" class="d">-                                    None,
</a><a href="#h69-1-14" id="h69-1-14" class="d">-                                    &quot;released&quot;,
</a><a href="#h69-1-15" id="h69-1-15" class="d">-                                ),
</a><a href="#h69-1-16" id="h69-1-16" class="d">-                            ),
</a>                         ),
<a href="#h69-1-18" id="h69-1-18" class="d">-                        Constant(
</a><a href="#h69-1-19" id="h69-1-19" class="d">-                            Integer(
</a><a href="#h69-1-20" id="h69-1-20" class="d">-                                4,
</a><a href="#h69-1-21" id="h69-1-21" class="d">-                            ),
</a><a href="#h69-1-22" id="h69-1-22" class="d">-                        ),
</a><a href="#h69-1-23" id="h69-1-23" class="d">-                    ),
</a><a href="#h69-1-24" id="h69-1-24" class="d">-                    Some(
</a><a href="#h69-1-25" id="h69-1-25" class="d">-                        &quot;ord&quot;,
</a>                     ),
                 ),
             ],
<a href="#h69-2" id="h69-2" class="h">@@ -335,32 +332,46 @@ Optimized plan: Select(
</a>                 alias: None,
                 filter: None,
             },
<a href="#h69-2-3" id="h69-2-3" class="i">+            labels: [
</a><a href="#h69-2-4" id="h69-2-4" class="i">+                None,
</a><a href="#h69-2-5" id="h69-2-5" class="i">+                None,
</a><a href="#h69-2-6" id="h69-2-6" class="i">+                None,
</a><a href="#h69-2-7" id="h69-2-7" class="i">+                Some(
</a><a href="#h69-2-8" id="h69-2-8" class="i">+                    (
</a><a href="#h69-2-9" id="h69-2-9" class="i">+                        None,
</a><a href="#h69-2-10" id="h69-2-10" class="i">+                        &quot;ord&quot;,
</a><a href="#h69-2-11" id="h69-2-11" class="i">+                    ),
</a><a href="#h69-2-12" id="h69-2-12" class="i">+                ),
</a><a href="#h69-2-13" id="h69-2-13" class="i">+            ],
</a>             expressions: [
<a href="#h69-2-15" id="h69-2-15" class="d">-                (
</a><a href="#h69-2-16" id="h69-2-16" class="d">-                    Field(
</a><a href="#h69-2-17" id="h69-2-17" class="d">-                        0,
</a><a href="#h69-2-18" id="h69-2-18" class="d">-                        Some(
</a><a href="#h69-2-19" id="h69-2-19" class="d">-                            (
</a><a href="#h69-2-20" id="h69-2-20" class="d">-                                None,
</a><a href="#h69-2-21" id="h69-2-21" class="d">-                                &quot;id&quot;,
</a><a href="#h69-2-22" id="h69-2-22" class="d">-                            ),
</a><a href="#h69-2-23" id="h69-2-23" class="i">+                Field(
</a><a href="#h69-2-24" id="h69-2-24" class="i">+                    0,
</a><a href="#h69-2-25" id="h69-2-25" class="i">+                    Some(
</a><a href="#h69-2-26" id="h69-2-26" class="i">+                        (
</a><a href="#h69-2-27" id="h69-2-27" class="i">+                            None,
</a><a href="#h69-2-28" id="h69-2-28" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h69-2-31" id="h69-2-31" class="d">-                    None,
</a>                 ),
<a href="#h69-2-33" id="h69-2-33" class="d">-                (
</a><a href="#h69-2-34" id="h69-2-34" class="d">-                    Field(
</a><a href="#h69-2-35" id="h69-2-35" class="d">-                        1,
</a><a href="#h69-2-36" id="h69-2-36" class="d">-                        Some(
</a><a href="#h69-2-37" id="h69-2-37" class="d">-                            (
</a><a href="#h69-2-38" id="h69-2-38" class="d">-                                None,
</a><a href="#h69-2-39" id="h69-2-39" class="d">-                                &quot;title&quot;,
</a><a href="#h69-2-40" id="h69-2-40" class="d">-                            ),
</a><a href="#h69-2-41" id="h69-2-41" class="i">+                Field(
</a><a href="#h69-2-42" id="h69-2-42" class="i">+                    1,
</a><a href="#h69-2-43" id="h69-2-43" class="i">+                    Some(
</a><a href="#h69-2-44" id="h69-2-44" class="i">+                        (
</a><a href="#h69-2-45" id="h69-2-45" class="i">+                            None,
</a><a href="#h69-2-46" id="h69-2-46" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h69-2-49" id="h69-2-49" class="d">-                    None,
</a>                 ),
<a href="#h69-2-51" id="h69-2-51" class="d">-                (
</a><a href="#h69-2-52" id="h69-2-52" class="i">+                Field(
</a><a href="#h69-2-53" id="h69-2-53" class="i">+                    4,
</a><a href="#h69-2-54" id="h69-2-54" class="i">+                    Some(
</a><a href="#h69-2-55" id="h69-2-55" class="i">+                        (
</a><a href="#h69-2-56" id="h69-2-56" class="i">+                            None,
</a><a href="#h69-2-57" id="h69-2-57" class="i">+                            &quot;released&quot;,
</a><a href="#h69-2-58" id="h69-2-58" class="i">+                        ),
</a><a href="#h69-2-59" id="h69-2-59" class="i">+                    ),
</a><a href="#h69-2-60" id="h69-2-60" class="i">+                ),
</a><a href="#h69-2-61" id="h69-2-61" class="i">+                Modulo(
</a>                     Field(
                         4,
                         Some(
<a href="#h69-3" id="h69-3" class="h">@@ -370,27 +381,10 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h69-3-3" id="h69-3-3" class="d">-                    None,
</a><a href="#h69-3-4" id="h69-3-4" class="d">-                ),
</a><a href="#h69-3-5" id="h69-3-5" class="d">-                (
</a><a href="#h69-3-6" id="h69-3-6" class="d">-                    Modulo(
</a><a href="#h69-3-7" id="h69-3-7" class="d">-                        Field(
</a><a href="#h69-3-8" id="h69-3-8" class="i">+                    Constant(
</a><a href="#h69-3-9" id="h69-3-9" class="i">+                        Integer(
</a>                             4,
<a href="#h69-3-11" id="h69-3-11" class="d">-                            Some(
</a><a href="#h69-3-12" id="h69-3-12" class="d">-                                (
</a><a href="#h69-3-13" id="h69-3-13" class="d">-                                    None,
</a><a href="#h69-3-14" id="h69-3-14" class="d">-                                    &quot;released&quot;,
</a><a href="#h69-3-15" id="h69-3-15" class="d">-                                ),
</a><a href="#h69-3-16" id="h69-3-16" class="d">-                            ),
</a>                         ),
<a href="#h69-3-18" id="h69-3-18" class="d">-                        Constant(
</a><a href="#h69-3-19" id="h69-3-19" class="d">-                            Integer(
</a><a href="#h69-3-20" id="h69-3-20" class="d">-                                4,
</a><a href="#h69-3-21" id="h69-3-21" class="d">-                            ),
</a><a href="#h69-3-22" id="h69-3-22" class="d">-                        ),
</a><a href="#h69-3-23" id="h69-3-23" class="d">-                    ),
</a><a href="#h69-3-24" id="h69-3-24" class="d">-                    Some(
</a><a href="#h69-3-25" id="h69-3-25" class="d">-                        &quot;ord&quot;,
</a>                     ),
                 ),
             ],
<b>diff --git a/<a id="h70" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -242,48 +242,47 @@ Plan: Select(
</a>                     ),
                 ),
             },
<a href="#h70-0-3" id="h70-0-3" class="i">+            labels: [
</a><a href="#h70-0-4" id="h70-0-4" class="i">+                None,
</a><a href="#h70-0-5" id="h70-0-5" class="i">+                None,
</a><a href="#h70-0-6" id="h70-0-6" class="i">+                Some(
</a><a href="#h70-0-7" id="h70-0-7" class="i">+                    (
</a><a href="#h70-0-8" id="h70-0-8" class="i">+                        None,
</a><a href="#h70-0-9" id="h70-0-9" class="i">+                        &quot;genre&quot;,
</a><a href="#h70-0-10" id="h70-0-10" class="i">+                    ),
</a><a href="#h70-0-11" id="h70-0-11" class="i">+                ),
</a><a href="#h70-0-12" id="h70-0-12" class="i">+            ],
</a>             expressions: [
<a href="#h70-0-14" id="h70-0-14" class="d">-                (
</a><a href="#h70-0-15" id="h70-0-15" class="d">-                    Field(
</a><a href="#h70-0-16" id="h70-0-16" class="d">-                        0,
</a><a href="#h70-0-17" id="h70-0-17" class="d">-                        Some(
</a><a href="#h70-0-18" id="h70-0-18" class="d">-                            (
</a><a href="#h70-0-19" id="h70-0-19" class="d">-                                Some(
</a><a href="#h70-0-20" id="h70-0-20" class="d">-                                    &quot;movies&quot;,
</a><a href="#h70-0-21" id="h70-0-21" class="d">-                                ),
</a><a href="#h70-0-22" id="h70-0-22" class="d">-                                &quot;id&quot;,
</a><a href="#h70-0-23" id="h70-0-23" class="i">+                Field(
</a><a href="#h70-0-24" id="h70-0-24" class="i">+                    0,
</a><a href="#h70-0-25" id="h70-0-25" class="i">+                    Some(
</a><a href="#h70-0-26" id="h70-0-26" class="i">+                        (
</a><a href="#h70-0-27" id="h70-0-27" class="i">+                            Some(
</a><a href="#h70-0-28" id="h70-0-28" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h70-0-30" id="h70-0-30" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h70-0-33" id="h70-0-33" class="d">-                    None,
</a>                 ),
<a href="#h70-0-35" id="h70-0-35" class="d">-                (
</a><a href="#h70-0-36" id="h70-0-36" class="d">-                    Field(
</a><a href="#h70-0-37" id="h70-0-37" class="d">-                        1,
</a><a href="#h70-0-38" id="h70-0-38" class="d">-                        Some(
</a><a href="#h70-0-39" id="h70-0-39" class="d">-                            (
</a><a href="#h70-0-40" id="h70-0-40" class="d">-                                None,
</a><a href="#h70-0-41" id="h70-0-41" class="d">-                                &quot;title&quot;,
</a><a href="#h70-0-42" id="h70-0-42" class="d">-                            ),
</a><a href="#h70-0-43" id="h70-0-43" class="i">+                Field(
</a><a href="#h70-0-44" id="h70-0-44" class="i">+                    1,
</a><a href="#h70-0-45" id="h70-0-45" class="i">+                    Some(
</a><a href="#h70-0-46" id="h70-0-46" class="i">+                        (
</a><a href="#h70-0-47" id="h70-0-47" class="i">+                            None,
</a><a href="#h70-0-48" id="h70-0-48" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h70-0-51" id="h70-0-51" class="d">-                    None,
</a>                 ),
<a href="#h70-0-53" id="h70-0-53" class="d">-                (
</a><a href="#h70-0-54" id="h70-0-54" class="d">-                    Field(
</a><a href="#h70-0-55" id="h70-0-55" class="d">-                        8,
</a><a href="#h70-0-56" id="h70-0-56" class="d">-                        Some(
</a><a href="#h70-0-57" id="h70-0-57" class="d">-                            (
</a><a href="#h70-0-58" id="h70-0-58" class="d">-                                Some(
</a><a href="#h70-0-59" id="h70-0-59" class="d">-                                    &quot;genres&quot;,
</a><a href="#h70-0-60" id="h70-0-60" class="d">-                                ),
</a><a href="#h70-0-61" id="h70-0-61" class="d">-                                &quot;name&quot;,
</a><a href="#h70-0-62" id="h70-0-62" class="i">+                Field(
</a><a href="#h70-0-63" id="h70-0-63" class="i">+                    8,
</a><a href="#h70-0-64" id="h70-0-64" class="i">+                    Some(
</a><a href="#h70-0-65" id="h70-0-65" class="i">+                        (
</a><a href="#h70-0-66" id="h70-0-66" class="i">+                            Some(
</a><a href="#h70-0-67" id="h70-0-67" class="i">+                                &quot;genres&quot;,
</a>                             ),
<a href="#h70-0-69" id="h70-0-69" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h70-0-72" id="h70-0-72" class="d">-                    Some(
</a><a href="#h70-0-73" id="h70-0-73" class="d">-                        &quot;genre&quot;,
</a><a href="#h70-0-74" id="h70-0-74" class="d">-                    ),
</a>                 ),
             ],
         },
<a href="#h70-1" id="h70-1" class="h">@@ -455,48 +454,47 @@ Optimized plan: Select(
</a>                 ),
                 outer: false,
             },
<a href="#h70-1-3" id="h70-1-3" class="i">+            labels: [
</a><a href="#h70-1-4" id="h70-1-4" class="i">+                None,
</a><a href="#h70-1-5" id="h70-1-5" class="i">+                None,
</a><a href="#h70-1-6" id="h70-1-6" class="i">+                Some(
</a><a href="#h70-1-7" id="h70-1-7" class="i">+                    (
</a><a href="#h70-1-8" id="h70-1-8" class="i">+                        None,
</a><a href="#h70-1-9" id="h70-1-9" class="i">+                        &quot;genre&quot;,
</a><a href="#h70-1-10" id="h70-1-10" class="i">+                    ),
</a><a href="#h70-1-11" id="h70-1-11" class="i">+                ),
</a><a href="#h70-1-12" id="h70-1-12" class="i">+            ],
</a>             expressions: [
<a href="#h70-1-14" id="h70-1-14" class="d">-                (
</a><a href="#h70-1-15" id="h70-1-15" class="d">-                    Field(
</a><a href="#h70-1-16" id="h70-1-16" class="d">-                        0,
</a><a href="#h70-1-17" id="h70-1-17" class="d">-                        Some(
</a><a href="#h70-1-18" id="h70-1-18" class="d">-                            (
</a><a href="#h70-1-19" id="h70-1-19" class="d">-                                Some(
</a><a href="#h70-1-20" id="h70-1-20" class="d">-                                    &quot;movies&quot;,
</a><a href="#h70-1-21" id="h70-1-21" class="d">-                                ),
</a><a href="#h70-1-22" id="h70-1-22" class="d">-                                &quot;id&quot;,
</a><a href="#h70-1-23" id="h70-1-23" class="i">+                Field(
</a><a href="#h70-1-24" id="h70-1-24" class="i">+                    0,
</a><a href="#h70-1-25" id="h70-1-25" class="i">+                    Some(
</a><a href="#h70-1-26" id="h70-1-26" class="i">+                        (
</a><a href="#h70-1-27" id="h70-1-27" class="i">+                            Some(
</a><a href="#h70-1-28" id="h70-1-28" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h70-1-30" id="h70-1-30" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h70-1-33" id="h70-1-33" class="d">-                    None,
</a>                 ),
<a href="#h70-1-35" id="h70-1-35" class="d">-                (
</a><a href="#h70-1-36" id="h70-1-36" class="d">-                    Field(
</a><a href="#h70-1-37" id="h70-1-37" class="d">-                        1,
</a><a href="#h70-1-38" id="h70-1-38" class="d">-                        Some(
</a><a href="#h70-1-39" id="h70-1-39" class="d">-                            (
</a><a href="#h70-1-40" id="h70-1-40" class="d">-                                None,
</a><a href="#h70-1-41" id="h70-1-41" class="d">-                                &quot;title&quot;,
</a><a href="#h70-1-42" id="h70-1-42" class="d">-                            ),
</a><a href="#h70-1-43" id="h70-1-43" class="i">+                Field(
</a><a href="#h70-1-44" id="h70-1-44" class="i">+                    1,
</a><a href="#h70-1-45" id="h70-1-45" class="i">+                    Some(
</a><a href="#h70-1-46" id="h70-1-46" class="i">+                        (
</a><a href="#h70-1-47" id="h70-1-47" class="i">+                            None,
</a><a href="#h70-1-48" id="h70-1-48" class="i">+                            &quot;title&quot;,
</a>                         ),
                     ),
<a href="#h70-1-51" id="h70-1-51" class="d">-                    None,
</a>                 ),
<a href="#h70-1-53" id="h70-1-53" class="d">-                (
</a><a href="#h70-1-54" id="h70-1-54" class="d">-                    Field(
</a><a href="#h70-1-55" id="h70-1-55" class="d">-                        8,
</a><a href="#h70-1-56" id="h70-1-56" class="d">-                        Some(
</a><a href="#h70-1-57" id="h70-1-57" class="d">-                            (
</a><a href="#h70-1-58" id="h70-1-58" class="d">-                                Some(
</a><a href="#h70-1-59" id="h70-1-59" class="d">-                                    &quot;genres&quot;,
</a><a href="#h70-1-60" id="h70-1-60" class="d">-                                ),
</a><a href="#h70-1-61" id="h70-1-61" class="d">-                                &quot;name&quot;,
</a><a href="#h70-1-62" id="h70-1-62" class="i">+                Field(
</a><a href="#h70-1-63" id="h70-1-63" class="i">+                    8,
</a><a href="#h70-1-64" id="h70-1-64" class="i">+                    Some(
</a><a href="#h70-1-65" id="h70-1-65" class="i">+                        (
</a><a href="#h70-1-66" id="h70-1-66" class="i">+                            Some(
</a><a href="#h70-1-67" id="h70-1-67" class="i">+                                &quot;genres&quot;,
</a>                             ),
<a href="#h70-1-69" id="h70-1-69" class="i">+                            &quot;name&quot;,
</a>                         ),
                     ),
<a href="#h70-1-72" id="h70-1-72" class="d">-                    Some(
</a><a href="#h70-1-73" id="h70-1-73" class="d">-                        &quot;genre&quot;,
</a><a href="#h70-1-74" id="h70-1-74" class="d">-                    ),
</a>                 ),
             ],
         },
<b>diff --git a/<a id="h71" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -244,72 +244,64 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h71-0-3" id="h71-0-3" class="i">+                labels: [
</a><a href="#h71-0-4" id="h71-0-4" class="i">+                    None,
</a><a href="#h71-0-5" id="h71-0-5" class="i">+                    None,
</a><a href="#h71-0-6" id="h71-0-6" class="i">+                    None,
</a><a href="#h71-0-7" id="h71-0-7" class="i">+                    None,
</a><a href="#h71-0-8" id="h71-0-8" class="i">+                    None,
</a><a href="#h71-0-9" id="h71-0-9" class="i">+                ],
</a>                 expressions: [
<a href="#h71-0-11" id="h71-0-11" class="d">-                    (
</a><a href="#h71-0-12" id="h71-0-12" class="d">-                        Field(
</a><a href="#h71-0-13" id="h71-0-13" class="d">-                            0,
</a><a href="#h71-0-14" id="h71-0-14" class="d">-                            Some(
</a><a href="#h71-0-15" id="h71-0-15" class="d">-                                (
</a><a href="#h71-0-16" id="h71-0-16" class="d">-                                    Some(
</a><a href="#h71-0-17" id="h71-0-17" class="d">-                                        &quot;movies&quot;,
</a><a href="#h71-0-18" id="h71-0-18" class="d">-                                    ),
</a><a href="#h71-0-19" id="h71-0-19" class="d">-                                    &quot;id&quot;,
</a><a href="#h71-0-20" id="h71-0-20" class="i">+                    Field(
</a><a href="#h71-0-21" id="h71-0-21" class="i">+                        0,
</a><a href="#h71-0-22" id="h71-0-22" class="i">+                        Some(
</a><a href="#h71-0-23" id="h71-0-23" class="i">+                            (
</a><a href="#h71-0-24" id="h71-0-24" class="i">+                                Some(
</a><a href="#h71-0-25" id="h71-0-25" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h71-0-27" id="h71-0-27" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h71-0-30" id="h71-0-30" class="d">-                        None,
</a>                     ),
<a href="#h71-0-32" id="h71-0-32" class="d">-                    (
</a><a href="#h71-0-33" id="h71-0-33" class="d">-                        Field(
</a><a href="#h71-0-34" id="h71-0-34" class="d">-                            1,
</a><a href="#h71-0-35" id="h71-0-35" class="d">-                            Some(
</a><a href="#h71-0-36" id="h71-0-36" class="d">-                                (
</a><a href="#h71-0-37" id="h71-0-37" class="d">-                                    None,
</a><a href="#h71-0-38" id="h71-0-38" class="d">-                                    &quot;title&quot;,
</a><a href="#h71-0-39" id="h71-0-39" class="d">-                                ),
</a><a href="#h71-0-40" id="h71-0-40" class="i">+                    Field(
</a><a href="#h71-0-41" id="h71-0-41" class="i">+                        1,
</a><a href="#h71-0-42" id="h71-0-42" class="i">+                        Some(
</a><a href="#h71-0-43" id="h71-0-43" class="i">+                            (
</a><a href="#h71-0-44" id="h71-0-44" class="i">+                                None,
</a><a href="#h71-0-45" id="h71-0-45" class="i">+                                &quot;title&quot;,
</a>                             ),
                         ),
<a href="#h71-0-48" id="h71-0-48" class="d">-                        None,
</a>                     ),
<a href="#h71-0-50" id="h71-0-50" class="d">-                    (
</a><a href="#h71-0-51" id="h71-0-51" class="d">-                        Field(
</a><a href="#h71-0-52" id="h71-0-52" class="d">-                            8,
</a><a href="#h71-0-53" id="h71-0-53" class="d">-                            Some(
</a><a href="#h71-0-54" id="h71-0-54" class="d">-                                (
</a><a href="#h71-0-55" id="h71-0-55" class="d">-                                    None,
</a><a href="#h71-0-56" id="h71-0-56" class="d">-                                    &quot;name&quot;,
</a><a href="#h71-0-57" id="h71-0-57" class="d">-                                ),
</a><a href="#h71-0-58" id="h71-0-58" class="i">+                    Field(
</a><a href="#h71-0-59" id="h71-0-59" class="i">+                        8,
</a><a href="#h71-0-60" id="h71-0-60" class="i">+                        Some(
</a><a href="#h71-0-61" id="h71-0-61" class="i">+                            (
</a><a href="#h71-0-62" id="h71-0-62" class="i">+                                None,
</a><a href="#h71-0-63" id="h71-0-63" class="i">+                                &quot;name&quot;,
</a>                             ),
                         ),
<a href="#h71-0-66" id="h71-0-66" class="d">-                        None,
</a>                     ),
<a href="#h71-0-68" id="h71-0-68" class="d">-                    (
</a><a href="#h71-0-69" id="h71-0-69" class="d">-                        Field(
</a><a href="#h71-0-70" id="h71-0-70" class="d">-                            8,
</a><a href="#h71-0-71" id="h71-0-71" class="d">-                            Some(
</a><a href="#h71-0-72" id="h71-0-72" class="d">-                                (
</a><a href="#h71-0-73" id="h71-0-73" class="d">-                                    Some(
</a><a href="#h71-0-74" id="h71-0-74" class="d">-                                        &quot;genres&quot;,
</a><a href="#h71-0-75" id="h71-0-75" class="d">-                                    ),
</a><a href="#h71-0-76" id="h71-0-76" class="d">-                                    &quot;name&quot;,
</a><a href="#h71-0-77" id="h71-0-77" class="i">+                    Field(
</a><a href="#h71-0-78" id="h71-0-78" class="i">+                        8,
</a><a href="#h71-0-79" id="h71-0-79" class="i">+                        Some(
</a><a href="#h71-0-80" id="h71-0-80" class="i">+                            (
</a><a href="#h71-0-81" id="h71-0-81" class="i">+                                Some(
</a><a href="#h71-0-82" id="h71-0-82" class="i">+                                    &quot;genres&quot;,
</a>                                 ),
<a href="#h71-0-84" id="h71-0-84" class="i">+                                &quot;name&quot;,
</a>                             ),
                         ),
<a href="#h71-0-87" id="h71-0-87" class="d">-                        None,
</a>                     ),
<a href="#h71-0-89" id="h71-0-89" class="d">-                    (
</a><a href="#h71-0-90" id="h71-0-90" class="d">-                        Field(
</a><a href="#h71-0-91" id="h71-0-91" class="d">-                            1,
</a><a href="#h71-0-92" id="h71-0-92" class="d">-                            Some(
</a><a href="#h71-0-93" id="h71-0-93" class="d">-                                (
</a><a href="#h71-0-94" id="h71-0-94" class="d">-                                    Some(
</a><a href="#h71-0-95" id="h71-0-95" class="d">-                                        &quot;movies&quot;,
</a><a href="#h71-0-96" id="h71-0-96" class="d">-                                    ),
</a><a href="#h71-0-97" id="h71-0-97" class="d">-                                    &quot;title&quot;,
</a><a href="#h71-0-98" id="h71-0-98" class="i">+                    Field(
</a><a href="#h71-0-99" id="h71-0-99" class="i">+                        1,
</a><a href="#h71-0-100" id="h71-0-100" class="i">+                        Some(
</a><a href="#h71-0-101" id="h71-0-101" class="i">+                            (
</a><a href="#h71-0-102" id="h71-0-102" class="i">+                                Some(
</a><a href="#h71-0-103" id="h71-0-103" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h71-0-105" id="h71-0-105" class="i">+                                &quot;title&quot;,
</a>                             ),
                         ),
<a href="#h71-0-108" id="h71-0-108" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h71-1" id="h71-1" class="h">@@ -344,26 +336,22 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h71-1-3" id="h71-1-3" class="i">+        labels: [
</a><a href="#h71-1-4" id="h71-1-4" class="i">+            None,
</a><a href="#h71-1-5" id="h71-1-5" class="i">+            None,
</a><a href="#h71-1-6" id="h71-1-6" class="i">+            None,
</a><a href="#h71-1-7" id="h71-1-7" class="i">+        ],
</a>         expressions: [
<a href="#h71-1-9" id="h71-1-9" class="d">-            (
</a><a href="#h71-1-10" id="h71-1-10" class="d">-                Field(
</a><a href="#h71-1-11" id="h71-1-11" class="d">-                    0,
</a><a href="#h71-1-12" id="h71-1-12" class="d">-                    None,
</a><a href="#h71-1-13" id="h71-1-13" class="d">-                ),
</a><a href="#h71-1-14" id="h71-1-14" class="i">+            Field(
</a><a href="#h71-1-15" id="h71-1-15" class="i">+                0,
</a>                 None,
             ),
<a href="#h71-1-18" id="h71-1-18" class="d">-            (
</a><a href="#h71-1-19" id="h71-1-19" class="d">-                Field(
</a><a href="#h71-1-20" id="h71-1-20" class="d">-                    1,
</a><a href="#h71-1-21" id="h71-1-21" class="d">-                    None,
</a><a href="#h71-1-22" id="h71-1-22" class="d">-                ),
</a><a href="#h71-1-23" id="h71-1-23" class="i">+            Field(
</a><a href="#h71-1-24" id="h71-1-24" class="i">+                1,
</a>                 None,
             ),
<a href="#h71-1-27" id="h71-1-27" class="d">-            (
</a><a href="#h71-1-28" id="h71-1-28" class="d">-                Field(
</a><a href="#h71-1-29" id="h71-1-29" class="d">-                    2,
</a><a href="#h71-1-30" id="h71-1-30" class="d">-                    None,
</a><a href="#h71-1-31" id="h71-1-31" class="d">-                ),
</a><a href="#h71-1-32" id="h71-1-32" class="i">+            Field(
</a><a href="#h71-1-33" id="h71-1-33" class="i">+                2,
</a>                 None,
             ),
         ],
<a href="#h71-2" id="h71-2" class="h">@@ -508,72 +496,64 @@ Optimized plan: Select(
</a>                     ),
                     outer: false,
                 },
<a href="#h71-2-3" id="h71-2-3" class="i">+                labels: [
</a><a href="#h71-2-4" id="h71-2-4" class="i">+                    None,
</a><a href="#h71-2-5" id="h71-2-5" class="i">+                    None,
</a><a href="#h71-2-6" id="h71-2-6" class="i">+                    None,
</a><a href="#h71-2-7" id="h71-2-7" class="i">+                    None,
</a><a href="#h71-2-8" id="h71-2-8" class="i">+                    None,
</a><a href="#h71-2-9" id="h71-2-9" class="i">+                ],
</a>                 expressions: [
<a href="#h71-2-11" id="h71-2-11" class="d">-                    (
</a><a href="#h71-2-12" id="h71-2-12" class="d">-                        Field(
</a><a href="#h71-2-13" id="h71-2-13" class="d">-                            0,
</a><a href="#h71-2-14" id="h71-2-14" class="d">-                            Some(
</a><a href="#h71-2-15" id="h71-2-15" class="d">-                                (
</a><a href="#h71-2-16" id="h71-2-16" class="d">-                                    Some(
</a><a href="#h71-2-17" id="h71-2-17" class="d">-                                        &quot;movies&quot;,
</a><a href="#h71-2-18" id="h71-2-18" class="d">-                                    ),
</a><a href="#h71-2-19" id="h71-2-19" class="d">-                                    &quot;id&quot;,
</a><a href="#h71-2-20" id="h71-2-20" class="i">+                    Field(
</a><a href="#h71-2-21" id="h71-2-21" class="i">+                        0,
</a><a href="#h71-2-22" id="h71-2-22" class="i">+                        Some(
</a><a href="#h71-2-23" id="h71-2-23" class="i">+                            (
</a><a href="#h71-2-24" id="h71-2-24" class="i">+                                Some(
</a><a href="#h71-2-25" id="h71-2-25" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h71-2-27" id="h71-2-27" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h71-2-30" id="h71-2-30" class="d">-                        None,
</a>                     ),
<a href="#h71-2-32" id="h71-2-32" class="d">-                    (
</a><a href="#h71-2-33" id="h71-2-33" class="d">-                        Field(
</a><a href="#h71-2-34" id="h71-2-34" class="d">-                            1,
</a><a href="#h71-2-35" id="h71-2-35" class="d">-                            Some(
</a><a href="#h71-2-36" id="h71-2-36" class="d">-                                (
</a><a href="#h71-2-37" id="h71-2-37" class="d">-                                    None,
</a><a href="#h71-2-38" id="h71-2-38" class="d">-                                    &quot;title&quot;,
</a><a href="#h71-2-39" id="h71-2-39" class="d">-                                ),
</a><a href="#h71-2-40" id="h71-2-40" class="i">+                    Field(
</a><a href="#h71-2-41" id="h71-2-41" class="i">+                        1,
</a><a href="#h71-2-42" id="h71-2-42" class="i">+                        Some(
</a><a href="#h71-2-43" id="h71-2-43" class="i">+                            (
</a><a href="#h71-2-44" id="h71-2-44" class="i">+                                None,
</a><a href="#h71-2-45" id="h71-2-45" class="i">+                                &quot;title&quot;,
</a>                             ),
                         ),
<a href="#h71-2-48" id="h71-2-48" class="d">-                        None,
</a>                     ),
<a href="#h71-2-50" id="h71-2-50" class="d">-                    (
</a><a href="#h71-2-51" id="h71-2-51" class="d">-                        Field(
</a><a href="#h71-2-52" id="h71-2-52" class="d">-                            8,
</a><a href="#h71-2-53" id="h71-2-53" class="d">-                            Some(
</a><a href="#h71-2-54" id="h71-2-54" class="d">-                                (
</a><a href="#h71-2-55" id="h71-2-55" class="d">-                                    None,
</a><a href="#h71-2-56" id="h71-2-56" class="d">-                                    &quot;name&quot;,
</a><a href="#h71-2-57" id="h71-2-57" class="d">-                                ),
</a><a href="#h71-2-58" id="h71-2-58" class="i">+                    Field(
</a><a href="#h71-2-59" id="h71-2-59" class="i">+                        8,
</a><a href="#h71-2-60" id="h71-2-60" class="i">+                        Some(
</a><a href="#h71-2-61" id="h71-2-61" class="i">+                            (
</a><a href="#h71-2-62" id="h71-2-62" class="i">+                                None,
</a><a href="#h71-2-63" id="h71-2-63" class="i">+                                &quot;name&quot;,
</a>                             ),
                         ),
<a href="#h71-2-66" id="h71-2-66" class="d">-                        None,
</a>                     ),
<a href="#h71-2-68" id="h71-2-68" class="d">-                    (
</a><a href="#h71-2-69" id="h71-2-69" class="d">-                        Field(
</a><a href="#h71-2-70" id="h71-2-70" class="d">-                            8,
</a><a href="#h71-2-71" id="h71-2-71" class="d">-                            Some(
</a><a href="#h71-2-72" id="h71-2-72" class="d">-                                (
</a><a href="#h71-2-73" id="h71-2-73" class="d">-                                    Some(
</a><a href="#h71-2-74" id="h71-2-74" class="d">-                                        &quot;genres&quot;,
</a><a href="#h71-2-75" id="h71-2-75" class="d">-                                    ),
</a><a href="#h71-2-76" id="h71-2-76" class="d">-                                    &quot;name&quot;,
</a><a href="#h71-2-77" id="h71-2-77" class="i">+                    Field(
</a><a href="#h71-2-78" id="h71-2-78" class="i">+                        8,
</a><a href="#h71-2-79" id="h71-2-79" class="i">+                        Some(
</a><a href="#h71-2-80" id="h71-2-80" class="i">+                            (
</a><a href="#h71-2-81" id="h71-2-81" class="i">+                                Some(
</a><a href="#h71-2-82" id="h71-2-82" class="i">+                                    &quot;genres&quot;,
</a>                                 ),
<a href="#h71-2-84" id="h71-2-84" class="i">+                                &quot;name&quot;,
</a>                             ),
                         ),
<a href="#h71-2-87" id="h71-2-87" class="d">-                        None,
</a>                     ),
<a href="#h71-2-89" id="h71-2-89" class="d">-                    (
</a><a href="#h71-2-90" id="h71-2-90" class="d">-                        Field(
</a><a href="#h71-2-91" id="h71-2-91" class="d">-                            1,
</a><a href="#h71-2-92" id="h71-2-92" class="d">-                            Some(
</a><a href="#h71-2-93" id="h71-2-93" class="d">-                                (
</a><a href="#h71-2-94" id="h71-2-94" class="d">-                                    Some(
</a><a href="#h71-2-95" id="h71-2-95" class="d">-                                        &quot;movies&quot;,
</a><a href="#h71-2-96" id="h71-2-96" class="d">-                                    ),
</a><a href="#h71-2-97" id="h71-2-97" class="d">-                                    &quot;title&quot;,
</a><a href="#h71-2-98" id="h71-2-98" class="i">+                    Field(
</a><a href="#h71-2-99" id="h71-2-99" class="i">+                        1,
</a><a href="#h71-2-100" id="h71-2-100" class="i">+                        Some(
</a><a href="#h71-2-101" id="h71-2-101" class="i">+                            (
</a><a href="#h71-2-102" id="h71-2-102" class="i">+                                Some(
</a><a href="#h71-2-103" id="h71-2-103" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h71-2-105" id="h71-2-105" class="i">+                                &quot;title&quot;,
</a>                             ),
                         ),
<a href="#h71-2-108" id="h71-2-108" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h71-3" id="h71-3" class="h">@@ -608,26 +588,22 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h71-3-3" id="h71-3-3" class="i">+        labels: [
</a><a href="#h71-3-4" id="h71-3-4" class="i">+            None,
</a><a href="#h71-3-5" id="h71-3-5" class="i">+            None,
</a><a href="#h71-3-6" id="h71-3-6" class="i">+            None,
</a><a href="#h71-3-7" id="h71-3-7" class="i">+        ],
</a>         expressions: [
<a href="#h71-3-9" id="h71-3-9" class="d">-            (
</a><a href="#h71-3-10" id="h71-3-10" class="d">-                Field(
</a><a href="#h71-3-11" id="h71-3-11" class="d">-                    0,
</a><a href="#h71-3-12" id="h71-3-12" class="d">-                    None,
</a><a href="#h71-3-13" id="h71-3-13" class="d">-                ),
</a><a href="#h71-3-14" id="h71-3-14" class="i">+            Field(
</a><a href="#h71-3-15" id="h71-3-15" class="i">+                0,
</a>                 None,
             ),
<a href="#h71-3-18" id="h71-3-18" class="d">-            (
</a><a href="#h71-3-19" id="h71-3-19" class="d">-                Field(
</a><a href="#h71-3-20" id="h71-3-20" class="d">-                    1,
</a><a href="#h71-3-21" id="h71-3-21" class="d">-                    None,
</a><a href="#h71-3-22" id="h71-3-22" class="d">-                ),
</a><a href="#h71-3-23" id="h71-3-23" class="i">+            Field(
</a><a href="#h71-3-24" id="h71-3-24" class="i">+                1,
</a>                 None,
             ),
<a href="#h71-3-27" id="h71-3-27" class="d">-            (
</a><a href="#h71-3-28" id="h71-3-28" class="d">-                Field(
</a><a href="#h71-3-29" id="h71-3-29" class="d">-                    2,
</a><a href="#h71-3-30" id="h71-3-30" class="d">-                    None,
</a><a href="#h71-3-31" id="h71-3-31" class="d">-                ),
</a><a href="#h71-3-32" id="h71-3-32" class="i">+            Field(
</a><a href="#h71-3-33" id="h71-3-33" class="i">+                2,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h72" href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a> b/<a href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -143,30 +143,28 @@ Plan: Select(
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h72-0-3" id="h72-0-3" class="i">+                        labels: [
</a><a href="#h72-0-4" id="h72-0-4" class="i">+                            None,
</a><a href="#h72-0-5" id="h72-0-5" class="i">+                            None,
</a><a href="#h72-0-6" id="h72-0-6" class="i">+                        ],
</a>                         expressions: [
<a href="#h72-0-8" id="h72-0-8" class="d">-                            (
</a><a href="#h72-0-9" id="h72-0-9" class="d">-                                Field(
</a><a href="#h72-0-10" id="h72-0-10" class="d">-                                    5,
</a><a href="#h72-0-11" id="h72-0-11" class="d">-                                    Some(
</a><a href="#h72-0-12" id="h72-0-12" class="d">-                                        (
</a><a href="#h72-0-13" id="h72-0-13" class="d">-                                            None,
</a><a href="#h72-0-14" id="h72-0-14" class="d">-                                            &quot;rating&quot;,
</a><a href="#h72-0-15" id="h72-0-15" class="d">-                                        ),
</a><a href="#h72-0-16" id="h72-0-16" class="i">+                            Field(
</a><a href="#h72-0-17" id="h72-0-17" class="i">+                                5,
</a><a href="#h72-0-18" id="h72-0-18" class="i">+                                Some(
</a><a href="#h72-0-19" id="h72-0-19" class="i">+                                    (
</a><a href="#h72-0-20" id="h72-0-20" class="i">+                                        None,
</a><a href="#h72-0-21" id="h72-0-21" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
<a href="#h72-0-24" id="h72-0-24" class="d">-                                None,
</a>                             ),
<a href="#h72-0-26" id="h72-0-26" class="d">-                            (
</a><a href="#h72-0-27" id="h72-0-27" class="d">-                                Field(
</a><a href="#h72-0-28" id="h72-0-28" class="d">-                                    2,
</a><a href="#h72-0-29" id="h72-0-29" class="d">-                                    Some(
</a><a href="#h72-0-30" id="h72-0-30" class="d">-                                        (
</a><a href="#h72-0-31" id="h72-0-31" class="d">-                                            None,
</a><a href="#h72-0-32" id="h72-0-32" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h72-0-33" id="h72-0-33" class="d">-                                        ),
</a><a href="#h72-0-34" id="h72-0-34" class="i">+                            Field(
</a><a href="#h72-0-35" id="h72-0-35" class="i">+                                2,
</a><a href="#h72-0-36" id="h72-0-36" class="i">+                                Some(
</a><a href="#h72-0-37" id="h72-0-37" class="i">+                                    (
</a><a href="#h72-0-38" id="h72-0-38" class="i">+                                        None,
</a><a href="#h72-0-39" id="h72-0-39" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
<a href="#h72-0-42" id="h72-0-42" class="d">-                                None,
</a>                             ),
                         ],
                     },
<a href="#h72-1" id="h72-1" class="h">@@ -174,27 +172,25 @@ Plan: Select(
</a>                         Max,
                     ],
                 },
<a href="#h72-1-3" id="h72-1-3" class="i">+                labels: [
</a><a href="#h72-1-4" id="h72-1-4" class="i">+                    None,
</a><a href="#h72-1-5" id="h72-1-5" class="i">+                    None,
</a><a href="#h72-1-6" id="h72-1-6" class="i">+                ],
</a>                 expressions: [
<a href="#h72-1-8" id="h72-1-8" class="d">-                    (
</a><a href="#h72-1-9" id="h72-1-9" class="d">-                        Field(
</a><a href="#h72-1-10" id="h72-1-10" class="d">-                            0,
</a><a href="#h72-1-11" id="h72-1-11" class="d">-                            None,
</a><a href="#h72-1-12" id="h72-1-12" class="d">-                        ),
</a><a href="#h72-1-13" id="h72-1-13" class="i">+                    Field(
</a><a href="#h72-1-14" id="h72-1-14" class="i">+                        0,
</a>                         None,
                     ),
<a href="#h72-1-17" id="h72-1-17" class="d">-                    (
</a><a href="#h72-1-18" id="h72-1-18" class="d">-                        Field(
</a><a href="#h72-1-19" id="h72-1-19" class="d">-                            1,
</a><a href="#h72-1-20" id="h72-1-20" class="d">-                            Some(
</a><a href="#h72-1-21" id="h72-1-21" class="d">-                                (
</a><a href="#h72-1-22" id="h72-1-22" class="d">-                                    Some(
</a><a href="#h72-1-23" id="h72-1-23" class="d">-                                        &quot;movies&quot;,
</a><a href="#h72-1-24" id="h72-1-24" class="d">-                                    ),
</a><a href="#h72-1-25" id="h72-1-25" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h72-1-26" id="h72-1-26" class="i">+                    Field(
</a><a href="#h72-1-27" id="h72-1-27" class="i">+                        1,
</a><a href="#h72-1-28" id="h72-1-28" class="i">+                        Some(
</a><a href="#h72-1-29" id="h72-1-29" class="i">+                            (
</a><a href="#h72-1-30" id="h72-1-30" class="i">+                                Some(
</a><a href="#h72-1-31" id="h72-1-31" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h72-1-33" id="h72-1-33" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h72-1-36" id="h72-1-36" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h72-2" id="h72-2" class="h">@@ -215,12 +211,12 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h72-2-3" id="h72-2-3" class="i">+        labels: [
</a><a href="#h72-2-4" id="h72-2-4" class="i">+            None,
</a><a href="#h72-2-5" id="h72-2-5" class="i">+        ],
</a>         expressions: [
<a href="#h72-2-7" id="h72-2-7" class="d">-            (
</a><a href="#h72-2-8" id="h72-2-8" class="d">-                Field(
</a><a href="#h72-2-9" id="h72-2-9" class="d">-                    0,
</a><a href="#h72-2-10" id="h72-2-10" class="d">-                    None,
</a><a href="#h72-2-11" id="h72-2-11" class="d">-                ),
</a><a href="#h72-2-12" id="h72-2-12" class="i">+            Field(
</a><a href="#h72-2-13" id="h72-2-13" class="i">+                0,
</a>                 None,
             ),
         ],
<a href="#h72-3" id="h72-3" class="h">@@ -314,30 +310,28 @@ Optimized plan: Select(
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h72-3-3" id="h72-3-3" class="i">+                        labels: [
</a><a href="#h72-3-4" id="h72-3-4" class="i">+                            None,
</a><a href="#h72-3-5" id="h72-3-5" class="i">+                            None,
</a><a href="#h72-3-6" id="h72-3-6" class="i">+                        ],
</a>                         expressions: [
<a href="#h72-3-8" id="h72-3-8" class="d">-                            (
</a><a href="#h72-3-9" id="h72-3-9" class="d">-                                Field(
</a><a href="#h72-3-10" id="h72-3-10" class="d">-                                    5,
</a><a href="#h72-3-11" id="h72-3-11" class="d">-                                    Some(
</a><a href="#h72-3-12" id="h72-3-12" class="d">-                                        (
</a><a href="#h72-3-13" id="h72-3-13" class="d">-                                            None,
</a><a href="#h72-3-14" id="h72-3-14" class="d">-                                            &quot;rating&quot;,
</a><a href="#h72-3-15" id="h72-3-15" class="d">-                                        ),
</a><a href="#h72-3-16" id="h72-3-16" class="i">+                            Field(
</a><a href="#h72-3-17" id="h72-3-17" class="i">+                                5,
</a><a href="#h72-3-18" id="h72-3-18" class="i">+                                Some(
</a><a href="#h72-3-19" id="h72-3-19" class="i">+                                    (
</a><a href="#h72-3-20" id="h72-3-20" class="i">+                                        None,
</a><a href="#h72-3-21" id="h72-3-21" class="i">+                                        &quot;rating&quot;,
</a>                                     ),
                                 ),
<a href="#h72-3-24" id="h72-3-24" class="d">-                                None,
</a>                             ),
<a href="#h72-3-26" id="h72-3-26" class="d">-                            (
</a><a href="#h72-3-27" id="h72-3-27" class="d">-                                Field(
</a><a href="#h72-3-28" id="h72-3-28" class="d">-                                    2,
</a><a href="#h72-3-29" id="h72-3-29" class="d">-                                    Some(
</a><a href="#h72-3-30" id="h72-3-30" class="d">-                                        (
</a><a href="#h72-3-31" id="h72-3-31" class="d">-                                            None,
</a><a href="#h72-3-32" id="h72-3-32" class="d">-                                            &quot;studio_id&quot;,
</a><a href="#h72-3-33" id="h72-3-33" class="d">-                                        ),
</a><a href="#h72-3-34" id="h72-3-34" class="i">+                            Field(
</a><a href="#h72-3-35" id="h72-3-35" class="i">+                                2,
</a><a href="#h72-3-36" id="h72-3-36" class="i">+                                Some(
</a><a href="#h72-3-37" id="h72-3-37" class="i">+                                    (
</a><a href="#h72-3-38" id="h72-3-38" class="i">+                                        None,
</a><a href="#h72-3-39" id="h72-3-39" class="i">+                                        &quot;studio_id&quot;,
</a>                                     ),
                                 ),
<a href="#h72-3-42" id="h72-3-42" class="d">-                                None,
</a>                             ),
                         ],
                     },
<a href="#h72-4" id="h72-4" class="h">@@ -345,27 +339,25 @@ Optimized plan: Select(
</a>                         Max,
                     ],
                 },
<a href="#h72-4-3" id="h72-4-3" class="i">+                labels: [
</a><a href="#h72-4-4" id="h72-4-4" class="i">+                    None,
</a><a href="#h72-4-5" id="h72-4-5" class="i">+                    None,
</a><a href="#h72-4-6" id="h72-4-6" class="i">+                ],
</a>                 expressions: [
<a href="#h72-4-8" id="h72-4-8" class="d">-                    (
</a><a href="#h72-4-9" id="h72-4-9" class="d">-                        Field(
</a><a href="#h72-4-10" id="h72-4-10" class="d">-                            0,
</a><a href="#h72-4-11" id="h72-4-11" class="d">-                            None,
</a><a href="#h72-4-12" id="h72-4-12" class="d">-                        ),
</a><a href="#h72-4-13" id="h72-4-13" class="i">+                    Field(
</a><a href="#h72-4-14" id="h72-4-14" class="i">+                        0,
</a>                         None,
                     ),
<a href="#h72-4-17" id="h72-4-17" class="d">-                    (
</a><a href="#h72-4-18" id="h72-4-18" class="d">-                        Field(
</a><a href="#h72-4-19" id="h72-4-19" class="d">-                            1,
</a><a href="#h72-4-20" id="h72-4-20" class="d">-                            Some(
</a><a href="#h72-4-21" id="h72-4-21" class="d">-                                (
</a><a href="#h72-4-22" id="h72-4-22" class="d">-                                    Some(
</a><a href="#h72-4-23" id="h72-4-23" class="d">-                                        &quot;movies&quot;,
</a><a href="#h72-4-24" id="h72-4-24" class="d">-                                    ),
</a><a href="#h72-4-25" id="h72-4-25" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h72-4-26" id="h72-4-26" class="i">+                    Field(
</a><a href="#h72-4-27" id="h72-4-27" class="i">+                        1,
</a><a href="#h72-4-28" id="h72-4-28" class="i">+                        Some(
</a><a href="#h72-4-29" id="h72-4-29" class="i">+                            (
</a><a href="#h72-4-30" id="h72-4-30" class="i">+                                Some(
</a><a href="#h72-4-31" id="h72-4-31" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h72-4-33" id="h72-4-33" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h72-4-36" id="h72-4-36" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h72-5" id="h72-5" class="h">@@ -386,12 +378,12 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h72-5-3" id="h72-5-3" class="i">+        labels: [
</a><a href="#h72-5-4" id="h72-5-4" class="i">+            None,
</a><a href="#h72-5-5" id="h72-5-5" class="i">+        ],
</a>         expressions: [
<a href="#h72-5-7" id="h72-5-7" class="d">-            (
</a><a href="#h72-5-8" id="h72-5-8" class="d">-                Field(
</a><a href="#h72-5-9" id="h72-5-9" class="d">-                    0,
</a><a href="#h72-5-10" id="h72-5-10" class="d">-                    None,
</a><a href="#h72-5-11" id="h72-5-11" class="d">-                ),
</a><a href="#h72-5-12" id="h72-5-12" class="i">+            Field(
</a><a href="#h72-5-13" id="h72-5-13" class="i">+                0,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h73" href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a> b/<a href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -142,42 +142,38 @@ Plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h73-0-3" id="h73-0-3" class="i">+                labels: [
</a><a href="#h73-0-4" id="h73-0-4" class="i">+                    None,
</a><a href="#h73-0-5" id="h73-0-5" class="i">+                    None,
</a><a href="#h73-0-6" id="h73-0-6" class="i">+                    None,
</a><a href="#h73-0-7" id="h73-0-7" class="i">+                ],
</a>                 expressions: [
<a href="#h73-0-9" id="h73-0-9" class="d">-                    (
</a><a href="#h73-0-10" id="h73-0-10" class="d">-                        Field(
</a><a href="#h73-0-11" id="h73-0-11" class="d">-                            0,
</a><a href="#h73-0-12" id="h73-0-12" class="d">-                            Some(
</a><a href="#h73-0-13" id="h73-0-13" class="d">-                                (
</a><a href="#h73-0-14" id="h73-0-14" class="d">-                                    None,
</a><a href="#h73-0-15" id="h73-0-15" class="d">-                                    &quot;id&quot;,
</a><a href="#h73-0-16" id="h73-0-16" class="d">-                                ),
</a><a href="#h73-0-17" id="h73-0-17" class="i">+                    Field(
</a><a href="#h73-0-18" id="h73-0-18" class="i">+                        0,
</a><a href="#h73-0-19" id="h73-0-19" class="i">+                        Some(
</a><a href="#h73-0-20" id="h73-0-20" class="i">+                            (
</a><a href="#h73-0-21" id="h73-0-21" class="i">+                                None,
</a><a href="#h73-0-22" id="h73-0-22" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h73-0-25" id="h73-0-25" class="d">-                        None,
</a>                     ),
<a href="#h73-0-27" id="h73-0-27" class="d">-                    (
</a><a href="#h73-0-28" id="h73-0-28" class="d">-                        Field(
</a><a href="#h73-0-29" id="h73-0-29" class="d">-                            1,
</a><a href="#h73-0-30" id="h73-0-30" class="d">-                            Some(
</a><a href="#h73-0-31" id="h73-0-31" class="d">-                                (
</a><a href="#h73-0-32" id="h73-0-32" class="d">-                                    None,
</a><a href="#h73-0-33" id="h73-0-33" class="d">-                                    &quot;title&quot;,
</a><a href="#h73-0-34" id="h73-0-34" class="d">-                                ),
</a><a href="#h73-0-35" id="h73-0-35" class="i">+                    Field(
</a><a href="#h73-0-36" id="h73-0-36" class="i">+                        1,
</a><a href="#h73-0-37" id="h73-0-37" class="i">+                        Some(
</a><a href="#h73-0-38" id="h73-0-38" class="i">+                            (
</a><a href="#h73-0-39" id="h73-0-39" class="i">+                                None,
</a><a href="#h73-0-40" id="h73-0-40" class="i">+                                &quot;title&quot;,
</a>                             ),
                         ),
<a href="#h73-0-43" id="h73-0-43" class="d">-                        None,
</a>                     ),
<a href="#h73-0-45" id="h73-0-45" class="d">-                    (
</a><a href="#h73-0-46" id="h73-0-46" class="d">-                        Field(
</a><a href="#h73-0-47" id="h73-0-47" class="d">-                            4,
</a><a href="#h73-0-48" id="h73-0-48" class="d">-                            Some(
</a><a href="#h73-0-49" id="h73-0-49" class="d">-                                (
</a><a href="#h73-0-50" id="h73-0-50" class="d">-                                    None,
</a><a href="#h73-0-51" id="h73-0-51" class="d">-                                    &quot;released&quot;,
</a><a href="#h73-0-52" id="h73-0-52" class="d">-                                ),
</a><a href="#h73-0-53" id="h73-0-53" class="i">+                    Field(
</a><a href="#h73-0-54" id="h73-0-54" class="i">+                        4,
</a><a href="#h73-0-55" id="h73-0-55" class="i">+                        Some(
</a><a href="#h73-0-56" id="h73-0-56" class="i">+                            (
</a><a href="#h73-0-57" id="h73-0-57" class="i">+                                None,
</a><a href="#h73-0-58" id="h73-0-58" class="i">+                                &quot;released&quot;,
</a>                             ),
                         ),
<a href="#h73-0-61" id="h73-0-61" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h73-1" id="h73-1" class="h">@@ -198,19 +194,17 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h73-1-3" id="h73-1-3" class="i">+        labels: [
</a><a href="#h73-1-4" id="h73-1-4" class="i">+            None,
</a><a href="#h73-1-5" id="h73-1-5" class="i">+            None,
</a><a href="#h73-1-6" id="h73-1-6" class="i">+        ],
</a>         expressions: [
<a href="#h73-1-8" id="h73-1-8" class="d">-            (
</a><a href="#h73-1-9" id="h73-1-9" class="d">-                Field(
</a><a href="#h73-1-10" id="h73-1-10" class="d">-                    0,
</a><a href="#h73-1-11" id="h73-1-11" class="d">-                    None,
</a><a href="#h73-1-12" id="h73-1-12" class="d">-                ),
</a><a href="#h73-1-13" id="h73-1-13" class="i">+            Field(
</a><a href="#h73-1-14" id="h73-1-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h73-1-17" id="h73-1-17" class="d">-            (
</a><a href="#h73-1-18" id="h73-1-18" class="d">-                Field(
</a><a href="#h73-1-19" id="h73-1-19" class="d">-                    1,
</a><a href="#h73-1-20" id="h73-1-20" class="d">-                    None,
</a><a href="#h73-1-21" id="h73-1-21" class="d">-                ),
</a><a href="#h73-1-22" id="h73-1-22" class="i">+            Field(
</a><a href="#h73-1-23" id="h73-1-23" class="i">+                1,
</a>                 None,
             ),
         ],
<a href="#h73-2" id="h73-2" class="h">@@ -302,42 +296,38 @@ Optimized plan: Select(
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h73-2-3" id="h73-2-3" class="i">+                labels: [
</a><a href="#h73-2-4" id="h73-2-4" class="i">+                    None,
</a><a href="#h73-2-5" id="h73-2-5" class="i">+                    None,
</a><a href="#h73-2-6" id="h73-2-6" class="i">+                    None,
</a><a href="#h73-2-7" id="h73-2-7" class="i">+                ],
</a>                 expressions: [
<a href="#h73-2-9" id="h73-2-9" class="d">-                    (
</a><a href="#h73-2-10" id="h73-2-10" class="d">-                        Field(
</a><a href="#h73-2-11" id="h73-2-11" class="d">-                            0,
</a><a href="#h73-2-12" id="h73-2-12" class="d">-                            Some(
</a><a href="#h73-2-13" id="h73-2-13" class="d">-                                (
</a><a href="#h73-2-14" id="h73-2-14" class="d">-                                    None,
</a><a href="#h73-2-15" id="h73-2-15" class="d">-                                    &quot;id&quot;,
</a><a href="#h73-2-16" id="h73-2-16" class="d">-                                ),
</a><a href="#h73-2-17" id="h73-2-17" class="i">+                    Field(
</a><a href="#h73-2-18" id="h73-2-18" class="i">+                        0,
</a><a href="#h73-2-19" id="h73-2-19" class="i">+                        Some(
</a><a href="#h73-2-20" id="h73-2-20" class="i">+                            (
</a><a href="#h73-2-21" id="h73-2-21" class="i">+                                None,
</a><a href="#h73-2-22" id="h73-2-22" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h73-2-25" id="h73-2-25" class="d">-                        None,
</a>                     ),
<a href="#h73-2-27" id="h73-2-27" class="d">-                    (
</a><a href="#h73-2-28" id="h73-2-28" class="d">-                        Field(
</a><a href="#h73-2-29" id="h73-2-29" class="d">-                            1,
</a><a href="#h73-2-30" id="h73-2-30" class="d">-                            Some(
</a><a href="#h73-2-31" id="h73-2-31" class="d">-                                (
</a><a href="#h73-2-32" id="h73-2-32" class="d">-                                    None,
</a><a href="#h73-2-33" id="h73-2-33" class="d">-                                    &quot;title&quot;,
</a><a href="#h73-2-34" id="h73-2-34" class="d">-                                ),
</a><a href="#h73-2-35" id="h73-2-35" class="i">+                    Field(
</a><a href="#h73-2-36" id="h73-2-36" class="i">+                        1,
</a><a href="#h73-2-37" id="h73-2-37" class="i">+                        Some(
</a><a href="#h73-2-38" id="h73-2-38" class="i">+                            (
</a><a href="#h73-2-39" id="h73-2-39" class="i">+                                None,
</a><a href="#h73-2-40" id="h73-2-40" class="i">+                                &quot;title&quot;,
</a>                             ),
                         ),
<a href="#h73-2-43" id="h73-2-43" class="d">-                        None,
</a>                     ),
<a href="#h73-2-45" id="h73-2-45" class="d">-                    (
</a><a href="#h73-2-46" id="h73-2-46" class="d">-                        Field(
</a><a href="#h73-2-47" id="h73-2-47" class="d">-                            4,
</a><a href="#h73-2-48" id="h73-2-48" class="d">-                            Some(
</a><a href="#h73-2-49" id="h73-2-49" class="d">-                                (
</a><a href="#h73-2-50" id="h73-2-50" class="d">-                                    None,
</a><a href="#h73-2-51" id="h73-2-51" class="d">-                                    &quot;released&quot;,
</a><a href="#h73-2-52" id="h73-2-52" class="d">-                                ),
</a><a href="#h73-2-53" id="h73-2-53" class="i">+                    Field(
</a><a href="#h73-2-54" id="h73-2-54" class="i">+                        4,
</a><a href="#h73-2-55" id="h73-2-55" class="i">+                        Some(
</a><a href="#h73-2-56" id="h73-2-56" class="i">+                            (
</a><a href="#h73-2-57" id="h73-2-57" class="i">+                                None,
</a><a href="#h73-2-58" id="h73-2-58" class="i">+                                &quot;released&quot;,
</a>                             ),
                         ),
<a href="#h73-2-61" id="h73-2-61" class="d">-                        None,
</a>                     ),
                 ],
             },
<a href="#h73-3" id="h73-3" class="h">@@ -358,19 +348,17 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h73-3-3" id="h73-3-3" class="i">+        labels: [
</a><a href="#h73-3-4" id="h73-3-4" class="i">+            None,
</a><a href="#h73-3-5" id="h73-3-5" class="i">+            None,
</a><a href="#h73-3-6" id="h73-3-6" class="i">+        ],
</a>         expressions: [
<a href="#h73-3-8" id="h73-3-8" class="d">-            (
</a><a href="#h73-3-9" id="h73-3-9" class="d">-                Field(
</a><a href="#h73-3-10" id="h73-3-10" class="d">-                    0,
</a><a href="#h73-3-11" id="h73-3-11" class="d">-                    None,
</a><a href="#h73-3-12" id="h73-3-12" class="d">-                ),
</a><a href="#h73-3-13" id="h73-3-13" class="i">+            Field(
</a><a href="#h73-3-14" id="h73-3-14" class="i">+                0,
</a>                 None,
             ),
<a href="#h73-3-17" id="h73-3-17" class="d">-            (
</a><a href="#h73-3-18" id="h73-3-18" class="d">-                Field(
</a><a href="#h73-3-19" id="h73-3-19" class="d">-                    1,
</a><a href="#h73-3-20" id="h73-3-20" class="d">-                    None,
</a><a href="#h73-3-21" id="h73-3-21" class="d">-                ),
</a><a href="#h73-3-22" id="h73-3-22" class="i">+            Field(
</a><a href="#h73-3-23" id="h73-3-23" class="i">+                1,
</a>                 None,
             ),
         ],
<b>diff --git a/<a id="h74" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -274,34 +274,32 @@ Plan: Select(
</a>                 ),
             ),
         },
<a href="#h74-0-3" id="h74-0-3" class="i">+        labels: [
</a><a href="#h74-0-4" id="h74-0-4" class="i">+            None,
</a><a href="#h74-0-5" id="h74-0-5" class="i">+            None,
</a><a href="#h74-0-6" id="h74-0-6" class="i">+        ],
</a>         expressions: [
<a href="#h74-0-8" id="h74-0-8" class="d">-            (
</a><a href="#h74-0-9" id="h74-0-9" class="d">-                Field(
</a><a href="#h74-0-10" id="h74-0-10" class="d">-                    0,
</a><a href="#h74-0-11" id="h74-0-11" class="d">-                    Some(
</a><a href="#h74-0-12" id="h74-0-12" class="d">-                        (
</a><a href="#h74-0-13" id="h74-0-13" class="d">-                            Some(
</a><a href="#h74-0-14" id="h74-0-14" class="d">-                                &quot;m&quot;,
</a><a href="#h74-0-15" id="h74-0-15" class="d">-                            ),
</a><a href="#h74-0-16" id="h74-0-16" class="d">-                            &quot;id&quot;,
</a><a href="#h74-0-17" id="h74-0-17" class="i">+            Field(
</a><a href="#h74-0-18" id="h74-0-18" class="i">+                0,
</a><a href="#h74-0-19" id="h74-0-19" class="i">+                Some(
</a><a href="#h74-0-20" id="h74-0-20" class="i">+                    (
</a><a href="#h74-0-21" id="h74-0-21" class="i">+                        Some(
</a><a href="#h74-0-22" id="h74-0-22" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h74-0-24" id="h74-0-24" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h74-0-27" id="h74-0-27" class="d">-                None,
</a>             ),
<a href="#h74-0-29" id="h74-0-29" class="d">-            (
</a><a href="#h74-0-30" id="h74-0-30" class="d">-                Field(
</a><a href="#h74-0-31" id="h74-0-31" class="d">-                    7,
</a><a href="#h74-0-32" id="h74-0-32" class="d">-                    Some(
</a><a href="#h74-0-33" id="h74-0-33" class="d">-                        (
</a><a href="#h74-0-34" id="h74-0-34" class="d">-                            Some(
</a><a href="#h74-0-35" id="h74-0-35" class="d">-                                &quot;g&quot;,
</a><a href="#h74-0-36" id="h74-0-36" class="d">-                            ),
</a><a href="#h74-0-37" id="h74-0-37" class="d">-                            &quot;id&quot;,
</a><a href="#h74-0-38" id="h74-0-38" class="i">+            Field(
</a><a href="#h74-0-39" id="h74-0-39" class="i">+                7,
</a><a href="#h74-0-40" id="h74-0-40" class="i">+                Some(
</a><a href="#h74-0-41" id="h74-0-41" class="i">+                    (
</a><a href="#h74-0-42" id="h74-0-42" class="i">+                        Some(
</a><a href="#h74-0-43" id="h74-0-43" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h74-0-45" id="h74-0-45" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h74-0-48" id="h74-0-48" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h74-1" id="h74-1" class="h">@@ -470,34 +468,32 @@ Optimized plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h74-1-3" id="h74-1-3" class="i">+        labels: [
</a><a href="#h74-1-4" id="h74-1-4" class="i">+            None,
</a><a href="#h74-1-5" id="h74-1-5" class="i">+            None,
</a><a href="#h74-1-6" id="h74-1-6" class="i">+        ],
</a>         expressions: [
<a href="#h74-1-8" id="h74-1-8" class="d">-            (
</a><a href="#h74-1-9" id="h74-1-9" class="d">-                Field(
</a><a href="#h74-1-10" id="h74-1-10" class="d">-                    0,
</a><a href="#h74-1-11" id="h74-1-11" class="d">-                    Some(
</a><a href="#h74-1-12" id="h74-1-12" class="d">-                        (
</a><a href="#h74-1-13" id="h74-1-13" class="d">-                            Some(
</a><a href="#h74-1-14" id="h74-1-14" class="d">-                                &quot;m&quot;,
</a><a href="#h74-1-15" id="h74-1-15" class="d">-                            ),
</a><a href="#h74-1-16" id="h74-1-16" class="d">-                            &quot;id&quot;,
</a><a href="#h74-1-17" id="h74-1-17" class="i">+            Field(
</a><a href="#h74-1-18" id="h74-1-18" class="i">+                0,
</a><a href="#h74-1-19" id="h74-1-19" class="i">+                Some(
</a><a href="#h74-1-20" id="h74-1-20" class="i">+                    (
</a><a href="#h74-1-21" id="h74-1-21" class="i">+                        Some(
</a><a href="#h74-1-22" id="h74-1-22" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h74-1-24" id="h74-1-24" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h74-1-27" id="h74-1-27" class="d">-                None,
</a>             ),
<a href="#h74-1-29" id="h74-1-29" class="d">-            (
</a><a href="#h74-1-30" id="h74-1-30" class="d">-                Field(
</a><a href="#h74-1-31" id="h74-1-31" class="d">-                    7,
</a><a href="#h74-1-32" id="h74-1-32" class="d">-                    Some(
</a><a href="#h74-1-33" id="h74-1-33" class="d">-                        (
</a><a href="#h74-1-34" id="h74-1-34" class="d">-                            Some(
</a><a href="#h74-1-35" id="h74-1-35" class="d">-                                &quot;g&quot;,
</a><a href="#h74-1-36" id="h74-1-36" class="d">-                            ),
</a><a href="#h74-1-37" id="h74-1-37" class="d">-                            &quot;id&quot;,
</a><a href="#h74-1-38" id="h74-1-38" class="i">+            Field(
</a><a href="#h74-1-39" id="h74-1-39" class="i">+                7,
</a><a href="#h74-1-40" id="h74-1-40" class="i">+                Some(
</a><a href="#h74-1-41" id="h74-1-41" class="i">+                    (
</a><a href="#h74-1-42" id="h74-1-42" class="i">+                        Some(
</a><a href="#h74-1-43" id="h74-1-43" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h74-1-45" id="h74-1-45" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h74-1-48" id="h74-1-48" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h75" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -266,34 +266,32 @@ Plan: Select(
</a>                 ),
             ),
         },
<a href="#h75-0-3" id="h75-0-3" class="i">+        labels: [
</a><a href="#h75-0-4" id="h75-0-4" class="i">+            None,
</a><a href="#h75-0-5" id="h75-0-5" class="i">+            None,
</a><a href="#h75-0-6" id="h75-0-6" class="i">+        ],
</a>         expressions: [
<a href="#h75-0-8" id="h75-0-8" class="d">-            (
</a><a href="#h75-0-9" id="h75-0-9" class="d">-                Field(
</a><a href="#h75-0-10" id="h75-0-10" class="d">-                    0,
</a><a href="#h75-0-11" id="h75-0-11" class="d">-                    Some(
</a><a href="#h75-0-12" id="h75-0-12" class="d">-                        (
</a><a href="#h75-0-13" id="h75-0-13" class="d">-                            Some(
</a><a href="#h75-0-14" id="h75-0-14" class="d">-                                &quot;movies&quot;,
</a><a href="#h75-0-15" id="h75-0-15" class="d">-                            ),
</a><a href="#h75-0-16" id="h75-0-16" class="d">-                            &quot;id&quot;,
</a><a href="#h75-0-17" id="h75-0-17" class="i">+            Field(
</a><a href="#h75-0-18" id="h75-0-18" class="i">+                0,
</a><a href="#h75-0-19" id="h75-0-19" class="i">+                Some(
</a><a href="#h75-0-20" id="h75-0-20" class="i">+                    (
</a><a href="#h75-0-21" id="h75-0-21" class="i">+                        Some(
</a><a href="#h75-0-22" id="h75-0-22" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h75-0-24" id="h75-0-24" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h75-0-27" id="h75-0-27" class="d">-                None,
</a>             ),
<a href="#h75-0-29" id="h75-0-29" class="d">-            (
</a><a href="#h75-0-30" id="h75-0-30" class="d">-                Field(
</a><a href="#h75-0-31" id="h75-0-31" class="d">-                    7,
</a><a href="#h75-0-32" id="h75-0-32" class="d">-                    Some(
</a><a href="#h75-0-33" id="h75-0-33" class="d">-                        (
</a><a href="#h75-0-34" id="h75-0-34" class="d">-                            Some(
</a><a href="#h75-0-35" id="h75-0-35" class="d">-                                &quot;genres&quot;,
</a><a href="#h75-0-36" id="h75-0-36" class="d">-                            ),
</a><a href="#h75-0-37" id="h75-0-37" class="d">-                            &quot;id&quot;,
</a><a href="#h75-0-38" id="h75-0-38" class="i">+            Field(
</a><a href="#h75-0-39" id="h75-0-39" class="i">+                7,
</a><a href="#h75-0-40" id="h75-0-40" class="i">+                Some(
</a><a href="#h75-0-41" id="h75-0-41" class="i">+                    (
</a><a href="#h75-0-42" id="h75-0-42" class="i">+                        Some(
</a><a href="#h75-0-43" id="h75-0-43" class="i">+                            &quot;genres&quot;,
</a>                         ),
<a href="#h75-0-45" id="h75-0-45" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h75-0-48" id="h75-0-48" class="d">-                None,
</a>             ),
         ],
     },
<a href="#h75-1" id="h75-1" class="h">@@ -458,34 +456,32 @@ Optimized plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h75-1-3" id="h75-1-3" class="i">+        labels: [
</a><a href="#h75-1-4" id="h75-1-4" class="i">+            None,
</a><a href="#h75-1-5" id="h75-1-5" class="i">+            None,
</a><a href="#h75-1-6" id="h75-1-6" class="i">+        ],
</a>         expressions: [
<a href="#h75-1-8" id="h75-1-8" class="d">-            (
</a><a href="#h75-1-9" id="h75-1-9" class="d">-                Field(
</a><a href="#h75-1-10" id="h75-1-10" class="d">-                    0,
</a><a href="#h75-1-11" id="h75-1-11" class="d">-                    Some(
</a><a href="#h75-1-12" id="h75-1-12" class="d">-                        (
</a><a href="#h75-1-13" id="h75-1-13" class="d">-                            Some(
</a><a href="#h75-1-14" id="h75-1-14" class="d">-                                &quot;movies&quot;,
</a><a href="#h75-1-15" id="h75-1-15" class="d">-                            ),
</a><a href="#h75-1-16" id="h75-1-16" class="d">-                            &quot;id&quot;,
</a><a href="#h75-1-17" id="h75-1-17" class="i">+            Field(
</a><a href="#h75-1-18" id="h75-1-18" class="i">+                0,
</a><a href="#h75-1-19" id="h75-1-19" class="i">+                Some(
</a><a href="#h75-1-20" id="h75-1-20" class="i">+                    (
</a><a href="#h75-1-21" id="h75-1-21" class="i">+                        Some(
</a><a href="#h75-1-22" id="h75-1-22" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h75-1-24" id="h75-1-24" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h75-1-27" id="h75-1-27" class="d">-                None,
</a>             ),
<a href="#h75-1-29" id="h75-1-29" class="d">-            (
</a><a href="#h75-1-30" id="h75-1-30" class="d">-                Field(
</a><a href="#h75-1-31" id="h75-1-31" class="d">-                    7,
</a><a href="#h75-1-32" id="h75-1-32" class="d">-                    Some(
</a><a href="#h75-1-33" id="h75-1-33" class="d">-                        (
</a><a href="#h75-1-34" id="h75-1-34" class="d">-                            Some(
</a><a href="#h75-1-35" id="h75-1-35" class="d">-                                &quot;genres&quot;,
</a><a href="#h75-1-36" id="h75-1-36" class="d">-                            ),
</a><a href="#h75-1-37" id="h75-1-37" class="d">-                            &quot;id&quot;,
</a><a href="#h75-1-38" id="h75-1-38" class="i">+            Field(
</a><a href="#h75-1-39" id="h75-1-39" class="i">+                7,
</a><a href="#h75-1-40" id="h75-1-40" class="i">+                Some(
</a><a href="#h75-1-41" id="h75-1-41" class="i">+                    (
</a><a href="#h75-1-42" id="h75-1-42" class="i">+                        Some(
</a><a href="#h75-1-43" id="h75-1-43" class="i">+                            &quot;genres&quot;,
</a>                         ),
<a href="#h75-1-45" id="h75-1-45" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h75-1-48" id="h75-1-48" class="d">-                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h76" href="../file/tests/sql/schema/insert_default_missing.html">tests/sql/schema/insert_default_missing</a> b/<a href="../file/tests/sql/schema/insert_default_missing.html">tests/sql/schema/insert_default_missing</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO defaults (id) VALUES (1)
<a href="#h76-0-1" id="h76-0-1" class="d">-Error: InvalidInput(&quot;no value given for column required&quot;)
</a><a href="#h76-0-2" id="h76-0-2" class="i">+Error: InvalidInput(&quot;no value given for column required with no default&quot;)
</a> 
 Storage:
 CREATE TABLE defaults (
</pre>
</div>
</body>
</html>
