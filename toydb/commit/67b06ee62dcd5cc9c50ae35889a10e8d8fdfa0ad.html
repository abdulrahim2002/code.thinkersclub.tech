<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: clean up schema module - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/67b06ee62dcd5cc9c50ae35889a10e8d8fdfa0ad.html">67b06ee62dcd5cc9c50ae35889a10e8d8fdfa0ad</a>
<b>parent</b> <a href="../commit/faa50aa0359ab06f6b2a52a0893d90fb5b12514d.html">faa50aa0359ab06f6b2a52a0893d90fb5b12514d</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Tue, 18 Jun 2024 22:33:36 +0200

sql: clean up schema module

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/engine/local.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/engine/raft.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/parser/lexer.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">17</td><td><span class="i">+</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/plan/optimizer.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">+</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">52</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d">-------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/types/schema.rs</a></td><td> | </td><td class="num">403</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/types/value.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">tests/e2e/client.rs</a></td><td> | </td><td class="num">28</td><td><span class="i">+++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">tests/sql/query/agg_boolean</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">tests/sql/query/agg_boolean_null</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">tests/sql/query/agg_const_from</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query/agg_count_star</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/query/agg_expr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/agg_float</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/agg_float_null</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/agg_integer</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/agg_integer_null</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/agg_string</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/agg_string_null</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/all</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/as_</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/expr_mixed</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/field_aliased</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/field_multi</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/field_qualified</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/field_qualified_multi</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/field_single</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/from_multiple</a></td><td> | </td><td class="num">72</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">--------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/group_expr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/group_expr_aggr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/group_expr_aggr_selfref</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/query/group_expr_aliased</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/query/group_expr_both</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/query/group_expr_multigroup</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/query/group_expr_select</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/query/group_join</a></td><td> | </td><td class="num">64</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/query/group_noaggregate</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/query/group_noselect</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">tests/sql/query/group_simple</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">tests/sql/query/having</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">tests/sql/query/having_nogroup</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">tests/sql/query/join_cross</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">72</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">--------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">tests/sql/query/join_cross_multi</a></td><td> | </td><td class="num">92</td><td><span class="i">+++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">tests/sql/query/join_inner</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">tests/sql/query/join_inner_implicit</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">tests/sql/query/join_inner_index_transverse</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">tests/sql/query/join_inner_index_transverse_where</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">tests/sql/query/join_inner_multi</a></td><td> | </td><td class="num">78</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">78</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">tests/sql/query/join_inner_multi_same</a></td><td> | </td><td class="num">122</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">tests/sql/query/join_inner_on_aliased</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">tests/sql/query/join_inner_on_false</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">tests/sql/query/join_inner_on_multi</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">tests/sql/query/join_inner_on_true</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">tests/sql/query/join_inner_on_where</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">tests/sql/query/join_left</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">tests/sql/query/join_left_all</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">tests/sql/query/join_left_outer</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">tests/sql/query/join_left_truncate</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">tests/sql/query/join_right</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">tests/sql/query/join_right_all</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">tests/sql/query/join_right_outer</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">tests/sql/query/join_right_truncate</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">tests/sql/query/limit</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">tests/sql/query/limit_expr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">tests/sql/query/limit_large</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">tests/sql/query/limit_offset</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">tests/sql/query/limit_zero</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">tests/sql/query/offset</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h77">tests/sql/query/offset_expr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h78">tests/sql/query/offset_large</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h79">tests/sql/query/offset_zero</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h80">tests/sql/query/order</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h81">tests/sql/query/order_aggregate</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h82">tests/sql/query/order_aggregate_noselect</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h83">tests/sql/query/order_asc</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h84">tests/sql/query/order_asc_lowercase</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h85">tests/sql/query/order_boolean_asc</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h86">tests/sql/query/order_boolean_desc</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h87">tests/sql/query/order_desc</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h88">tests/sql/query/order_desc_lowercase</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h89">tests/sql/query/order_expr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h90">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h91">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h92">tests/sql/query/order_float_asc</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h93">tests/sql/query/order_float_desc</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h94">tests/sql/query/order_group_by_noselect</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h95">tests/sql/query/order_integer_asc</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h96">tests/sql/query/order_integer_desc</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h97">tests/sql/query/order_multi</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h98">tests/sql/query/order_noselect</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h99">tests/sql/query/order_string_asc</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h100">tests/sql/query/order_string_desc</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h101">tests/sql/query/where_expr</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h102">tests/sql/query/where_false</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h103">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h104">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h105">tests/sql/query/where_float</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h106">tests/sql/query/where_index</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h107">tests/sql/query/where_index_or</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h108">tests/sql/query/where_index_or_partial</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h109">tests/sql/query/where_integer</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h110">tests/sql/query/where_join_inner</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h111">tests/sql/query/where_null</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h112">tests/sql/query/where_pk</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h113">tests/sql/query/where_pk_or</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h114">tests/sql/query/where_pk_or_partial</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h115">tests/sql/query/where_string</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h116">tests/sql/query/where_true</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h117">tests/sql/schema/create_table_default_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h118">tests/sql/schema/create_table_default_conflict_float_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h119">tests/sql/schema/create_table_default_conflict_integer_float</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h120">tests/sql/schema/create_table_default_null_not</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h121">tests/sql/schema/create_table_pk_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h122">tests/sql/schema/create_table_pk_multiple</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h123">tests/sql/schema/create_table_ref</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h124">tests/sql/schema/create_table_ref_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h125">tests/sql/schema/create_table_ref_multiple</a></td><td> | </td><td class="num">12</td><td><span class="i">+++++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h126">tests/sql/schema/create_table_ref_self</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h127">tests/sql/schema/create_table_ref_self_type</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h128">tests/sql/schema/create_table_ref_type</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h129">tests/sql/schema/create_table_unique</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h130">tests/sql/schema/create_table_unique_default</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h131">tests/sql/schema/create_table_unique_not_null</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h132">tests/sql/schema/create_table_unique_null</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h133">tests/sql/schema/delete_ref_conflict</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h134">tests/sql/schema/delete_ref_noref</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h135">tests/sql/schema/delete_ref_self</a></td><td> | </td><td class="num">6</td><td><span class="i">+++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h136">tests/sql/schema/delete_ref_self_all</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h137">tests/sql/schema/delete_ref_self_conflict</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h138">tests/sql/schema/delete_ref_source</a></td><td> | </td><td class="num">6</td><td><span class="i">+++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h139">tests/sql/schema/drop_table_ref_self</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h140">tests/sql/schema/drop_table_ref_source</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h141">tests/sql/schema/drop_table_ref_target</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h142">tests/sql/schema/insert_ref_boolean</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h143">tests/sql/schema/insert_ref_boolean_missing</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h144">tests/sql/schema/insert_ref_boolean_null</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h145">tests/sql/schema/insert_ref_float</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h146">tests/sql/schema/insert_ref_float_missing</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h147">tests/sql/schema/insert_ref_float_null</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h148">tests/sql/schema/insert_ref_integer</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h149">tests/sql/schema/insert_ref_integer_missing</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h150">tests/sql/schema/insert_ref_integer_null</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h151">tests/sql/schema/insert_ref_self</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h152">tests/sql/schema/insert_ref_self_missing</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h153">tests/sql/schema/insert_ref_self_null</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h154">tests/sql/schema/insert_ref_self_self</a></td><td> | </td><td class="num">8</td><td><span class="i">+++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h155">tests/sql/schema/insert_ref_string</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h156">tests/sql/schema/insert_ref_string_case</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h157">tests/sql/schema/insert_ref_string_missing</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h158">tests/sql/schema/insert_ref_string_null</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h159">tests/sql/schema/insert_unique_boolean</a></td><td> | </td><td class="num">25</td><td><span class="i">+++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h160">tests/sql/schema/insert_unique_boolean_duplicate</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h161">tests/sql/schema/insert_unique_float</a></td><td> | </td><td class="num">25</td><td><span class="i">+++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h162">tests/sql/schema/insert_unique_float_duplicate</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h163">tests/sql/schema/insert_unique_integer</a></td><td> | </td><td class="num">25</td><td><span class="i">+++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h164">tests/sql/schema/insert_unique_integer_duplicate</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h165">tests/sql/schema/insert_unique_nulls</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h166">tests/sql/schema/insert_unique_string</a></td><td> | </td><td class="num">25</td><td><span class="i">+++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h167">tests/sql/schema/insert_unique_string_case</a></td><td> | </td><td class="num">25</td><td><span class="i">+++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h168">tests/sql/schema/insert_unique_string_duplicate</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h169">tests/sql/schema/update_ref_pk</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h170">tests/sql/schema/update_ref_pk_noref</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h171">tests/sql/schema/update_ref_self_pk</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h172">tests/sql/schema/update_ref_self_pk_noref</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h173">tests/sql/schema/update_ref_self_self</a></td><td> | </td><td class="num">8</td><td><span class="i">+++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h174">tests/sql/schema/update_ref_self_value</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h175">tests/sql/schema/update_ref_source</a></td><td> | </td><td class="num">6</td><td><span class="i">+++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h176">tests/sql/schema/update_ref_source_missing</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h177">tests/sql/schema/update_ref_source_null</a></td><td> | </td><td class="num">6</td><td><span class="i">+++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h178">tests/sql/schema/update_ref_value</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h179">tests/sql/schema/update_unique_boolean</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h180">tests/sql/schema/update_unique_boolean_duplicate</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h181">tests/sql/schema/update_unique_boolean_same</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h182">tests/sql/schema/update_unique_nulls</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++++++++</span><span class="d">----</span></td></tr>
</table></pre><pre>183 files changed, 2566 insertions(+), 3429 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/engine/local.rs.html">src/sql/engine/local.rs</a> b/<a href="../file/src/sql/engine/local.rs.html">src/sql/engine/local.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -146,7 +146,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>             if !self.get(&amp;table.name, &amp;[id.clone()])?.is_empty() {
                 return errinput!(&quot;primary key {id} already exists for table {}&quot;, table.name);
             }
<a href="#h0-0-3" id="h0-0-3" class="d">-            self.txn.set(&amp;Key::Row((&amp;table.name).into(), (&amp;id).into()).encode(), row.encode())?;
</a><a href="#h0-0-4" id="h0-0-4" class="i">+            self.txn.set(&amp;Key::Row((&amp;table.name).into(), id.into()).encode(), row.encode())?;
</a> 
             // Update indexes
             for (i, column) in table.columns.iter().enumerate().filter(|(_, c)| c.index) {
<a href="#h0-1" id="h0-1" class="h">@@ -159,6 +159,8 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>     }
 
     fn delete(&amp;self, table: &amp;str, ids: &amp;[Value]) -&gt; Result&lt;()&gt; {
<a href="#h0-1-3" id="h0-1-3" class="i">+        // Check for foreign key referenes.
</a><a href="#h0-1-4" id="h0-1-4" class="i">+
</a>         // TODO: try to be more clever than simply iterating over each ID.
         for id in ids {
             let table = self.must_get_table(table)?;
<a href="#h0-2" id="h0-2" class="h">@@ -172,7 +174,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>                 while let Some(row) = scan.next().transpose()? {
                     for (i, c) in &amp;cs {
                         if &amp;row[*i] == id
<a href="#h0-2-3" id="h0-2-3" class="d">-                            &amp;&amp; (table.name != t.name || id != &amp;table.get_row_key(&amp;row)?)
</a><a href="#h0-2-4" id="h0-2-4" class="i">+                            &amp;&amp; (table.name != t.name || id != table.get_row_key(&amp;row)?)
</a>                         {
                             return errinput!(
                                 &quot;primary key {id} referenced by table {} column {c}&quot;,
<a href="#h0-3" id="h0-3" class="h">@@ -275,7 +277,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>         // TODO: be more clever than just iterating here.
         for (id, row) in rows {
             // If the primary key changes we do a delete and create, otherwise we replace the row
<a href="#h0-3-3" id="h0-3-3" class="d">-            if id != table.get_row_key(&amp;row)? {
</a><a href="#h0-3-4" id="h0-3-4" class="i">+            if id != *table.get_row_key(&amp;row)? {
</a>                 self.delete(&amp;table.name, &amp;[id.clone()])?;
                 self.insert(&amp;table.name, vec![row])?;
                 return Ok(());
<a href="#h0-4" id="h0-4" class="h">@@ -330,7 +332,7 @@ impl&lt;E: storage::Engine&gt; Catalog for Transaction&lt;E&gt; {
</a>         }
         let mut scan = self.scan(&amp;table.name, None)?;
         while let Some(row) = scan.next().transpose()? {
<a href="#h0-4-3" id="h0-4-3" class="d">-            self.delete(&amp;table.name, &amp;[table.get_row_key(&amp;row)?])?
</a><a href="#h0-4-4" id="h0-4-4" class="i">+            self.delete(&amp;table.name, &amp;[table.get_row_key(&amp;row)?.clone()])?
</a>         }
         self.txn.delete(&amp;Key::Table(table.name.into()).encode())?;
         Ok(true)
<b>diff --git a/<a id="h1" href="../file/src/sql/engine/raft.rs.html">src/sql/engine/raft.rs</a> b/<a href="../file/src/sql/engine/raft.rs.html">src/sql/engine/raft.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -316,7 +316,7 @@ impl&lt;E: storage::Engine&gt; raft::State for State&lt;E&gt; {
</a>                 };
                 txn.state().encode()
             }
<a href="#h1-0-3" id="h1-0-3" class="d">-            Read::Status =&gt; self.local.mvcc.status()?.encode(),
</a><a href="#h1-0-4" id="h1-0-4" class="i">+            Read::Status =&gt; self.local.kv.status()?.encode(),
</a> 
             Read::Get { txn, table, ids } =&gt; self.local.resume(txn)?.get(&amp;table, &amp;ids)?.encode(),
             Read::LookupIndex { txn, table, column, values } =&gt; {
<b>diff --git a/<a id="h2" href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a> b/<a href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -484,3 +484,13 @@ impl&lt;&#39;a&gt; Lexer&lt;&#39;a&gt; {
</a>         while self.next_if(|c| c.is_whitespace()).is_some() {}
     }
 }
<a href="#h2-0-3" id="h2-0-3" class="i">+
</a><a href="#h2-0-4" id="h2-0-4" class="i">+/// Returns true if the entire given string is a single valid identifier.
</a><a href="#h2-0-5" id="h2-0-5" class="i">+pub fn is_ident(ident: &amp;str) -&gt; bool {
</a><a href="#h2-0-6" id="h2-0-6" class="i">+    let mut lexer = Lexer::new(ident);
</a><a href="#h2-0-7" id="h2-0-7" class="i">+    let token = lexer.next();
</a><a href="#h2-0-8" id="h2-0-8" class="i">+    if lexer.next().is_some() {
</a><a href="#h2-0-9" id="h2-0-9" class="i">+        return false; // multiple tokens, so not an identifier
</a><a href="#h2-0-10" id="h2-0-10" class="i">+    }
</a><a href="#h2-0-11" id="h2-0-11" class="i">+    matches!(token, Some(Ok(Token::Ident(_))))
</a><a href="#h2-0-12" id="h2-0-12" class="i">+}
</a><b>diff --git a/<a id="h3" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -2,20 +2,5 @@ pub mod ast;
</a> mod lexer;
 mod parser;
 
<a href="#h3-0-3" id="h3-0-3" class="d">-pub use lexer::{Keyword, Lexer, Token};
</a><a href="#h3-0-4" id="h3-0-4" class="i">+pub use lexer::{is_ident, Keyword, Lexer, Token};
</a> pub use parser::Parser;
<a href="#h3-0-6" id="h3-0-6" class="d">-
</a><a href="#h3-0-7" id="h3-0-7" class="d">-use regex::Regex;
</a><a href="#h3-0-8" id="h3-0-8" class="d">-
</a><a href="#h3-0-9" id="h3-0-9" class="d">-// Formats an identifier by quoting it as appropriate.
</a><a href="#h3-0-10" id="h3-0-10" class="d">-// TODO: move this elsewhere.
</a><a href="#h3-0-11" id="h3-0-11" class="d">-pub(super) fn format_ident(ident: &amp;str) -&gt; String {
</a><a href="#h3-0-12" id="h3-0-12" class="d">-    static RE_IDENT: std::sync::OnceLock&lt;Regex&gt; = std::sync::OnceLock::new();
</a><a href="#h3-0-13" id="h3-0-13" class="d">-    let re_ident = RE_IDENT.get_or_init(|| Regex::new(r#&quot;^\w[\w_]*$&quot;#).unwrap());
</a><a href="#h3-0-14" id="h3-0-14" class="d">-
</a><a href="#h3-0-15" id="h3-0-15" class="d">-    if re_ident.is_match(ident) &amp;&amp; Keyword::try_from(ident.to_lowercase().as_str()).is_err() {
</a><a href="#h3-0-16" id="h3-0-16" class="d">-        ident.to_string()
</a><a href="#h3-0-17" id="h3-0-17" class="d">-    } else {
</a><a href="#h3-0-18" id="h3-0-18" class="d">-        format!(&quot;\&quot;{}\&quot;&quot;, ident.replace(&#39;\&quot;&#39;, &quot;\&quot;\&quot;&quot;))
</a><a href="#h3-0-19" id="h3-0-19" class="d">-    }
</a><a href="#h3-0-20" id="h3-0-20" class="d">-}
</a><b>diff --git a/<a id="h4" href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a> b/<a href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -174,14 +174,12 @@ impl Optimizer for IndexLookup {
</a>     fn optimize(&amp;self, node: Node) -&gt; Result&lt;Node&gt; {
         node.transform(&amp;Ok, &amp;|n| match n {
             Node::Scan { table, alias, filter: Some(filter) } =&gt; {
<a href="#h4-0-3" id="h4-0-3" class="d">-                let pk = table.columns.iter().position(|c| c.primary_key).unwrap();
</a><a href="#h4-0-4" id="h4-0-4" class="d">-
</a>                 // Convert the filter into conjunctive normal form, and try to convert each
                 // sub-expression into a lookup. If a lookup is found, return a lookup node and then
                 // apply the remaining conjunctions as a filter node, if any.
                 let mut cnf = filter.clone().into_cnf_vec();
                 for i in 0..cnf.len() {
<a href="#h4-0-10" id="h4-0-10" class="d">-                    if let Some(keys) = cnf[i].as_lookup(pk) {
</a><a href="#h4-0-11" id="h4-0-11" class="i">+                    if let Some(keys) = cnf[i].as_lookup(table.primary_key) {
</a>                         cnf.remove(i);
                         return Ok(self.wrap_cnf(Node::KeyLookup { table, alias, keys }, cnf));
                     }
<b>diff --git a/<a id="h5" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -36,32 +36,35 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>             ast::Statement::Explain(_) =&gt; panic!(&quot;unexpected explain statement&quot;),
 
             // DDL statements (schema changes).
<a href="#h5-0-3" id="h5-0-3" class="d">-            ast::Statement::CreateTable { name, columns } =&gt; Plan::CreateTable {
</a><a href="#h5-0-4" id="h5-0-4" class="d">-                schema: Table::new(
</a><a href="#h5-0-5" id="h5-0-5" class="d">-                    name,
</a><a href="#h5-0-6" id="h5-0-6" class="d">-                    columns
</a><a href="#h5-0-7" id="h5-0-7" class="d">-                        .into_iter()
</a><a href="#h5-0-8" id="h5-0-8" class="d">-                        .map(|c| {
</a><a href="#h5-0-9" id="h5-0-9" class="d">-                            let nullable = c.nullable.unwrap_or(!c.primary_key);
</a><a href="#h5-0-10" id="h5-0-10" class="d">-                            let default = match c.default {
</a><a href="#h5-0-11" id="h5-0-11" class="i">+            ast::Statement::CreateTable { name, columns } =&gt; {
</a><a href="#h5-0-12" id="h5-0-12" class="i">+                let Some(primary_key) = columns.iter().position(|c| c.primary_key) else {
</a><a href="#h5-0-13" id="h5-0-13" class="i">+                    return errinput!(&quot;no primary key for table {name}&quot;);
</a><a href="#h5-0-14" id="h5-0-14" class="i">+                };
</a><a href="#h5-0-15" id="h5-0-15" class="i">+                if columns.iter().filter(|c| c.primary_key).count() &gt; 1 {
</a><a href="#h5-0-16" id="h5-0-16" class="i">+                    return errinput!(&quot;multiple primary keys for table {name}&quot;);
</a><a href="#h5-0-17" id="h5-0-17" class="i">+                }
</a><a href="#h5-0-18" id="h5-0-18" class="i">+                let columns = columns
</a><a href="#h5-0-19" id="h5-0-19" class="i">+                    .into_iter()
</a><a href="#h5-0-20" id="h5-0-20" class="i">+                    .map(|c| {
</a><a href="#h5-0-21" id="h5-0-21" class="i">+                        let nullable = c.nullable.unwrap_or(!c.primary_key);
</a><a href="#h5-0-22" id="h5-0-22" class="i">+                        Ok(Column {
</a><a href="#h5-0-23" id="h5-0-23" class="i">+                            name: c.name,
</a><a href="#h5-0-24" id="h5-0-24" class="i">+                            datatype: c.datatype,
</a><a href="#h5-0-25" id="h5-0-25" class="i">+                            nullable,
</a><a href="#h5-0-26" id="h5-0-26" class="i">+                            default: match c.default {
</a>                                 Some(expr) =&gt; Some(self.evaluate_constant(expr)?),
                                 None if nullable =&gt; Some(Value::Null),
                                 None =&gt; None,
<a href="#h5-0-30" id="h5-0-30" class="d">-                            };
</a><a href="#h5-0-31" id="h5-0-31" class="d">-                            Ok(Column {
</a><a href="#h5-0-32" id="h5-0-32" class="d">-                                name: c.name,
</a><a href="#h5-0-33" id="h5-0-33" class="d">-                                datatype: c.datatype,
</a><a href="#h5-0-34" id="h5-0-34" class="d">-                                primary_key: c.primary_key,
</a><a href="#h5-0-35" id="h5-0-35" class="d">-                                nullable,
</a><a href="#h5-0-36" id="h5-0-36" class="d">-                                default,
</a><a href="#h5-0-37" id="h5-0-37" class="d">-                                index: c.index &amp;&amp; !c.primary_key,
</a><a href="#h5-0-38" id="h5-0-38" class="d">-                                unique: c.unique || c.primary_key,
</a><a href="#h5-0-39" id="h5-0-39" class="d">-                                references: c.references,
</a><a href="#h5-0-40" id="h5-0-40" class="d">-                            })
</a><a href="#h5-0-41" id="h5-0-41" class="i">+                            },
</a><a href="#h5-0-42" id="h5-0-42" class="i">+                            unique: c.unique || c.primary_key,
</a><a href="#h5-0-43" id="h5-0-43" class="i">+                            index: (c.index || c.unique || c.references.is_some())
</a><a href="#h5-0-44" id="h5-0-44" class="i">+                                &amp;&amp; !c.primary_key,
</a><a href="#h5-0-45" id="h5-0-45" class="i">+                            references: c.references,
</a>                         })
<a href="#h5-0-47" id="h5-0-47" class="d">-                        .collect::&lt;Result&lt;_&gt;&gt;()?,
</a><a href="#h5-0-48" id="h5-0-48" class="d">-                )?,
</a><a href="#h5-0-49" id="h5-0-49" class="d">-            },
</a><a href="#h5-0-50" id="h5-0-50" class="i">+                    })
</a><a href="#h5-0-51" id="h5-0-51" class="i">+                    .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h5-0-52" id="h5-0-52" class="i">+                Plan::CreateTable { schema: Table { name, primary_key, columns } }
</a><a href="#h5-0-53" id="h5-0-53" class="i">+            }
</a> 
             ast::Statement::DropTable { name, if_exists } =&gt; {
                 Plan::DropTable { table: name, if_exists }
<a href="#h5-1" id="h5-1" class="h">@@ -73,7 +76,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 let scope = &amp;mut Scope::from_table(table.clone())?;
                 Plan::Delete {
                     table: table.name.clone(),
<a href="#h5-1-3" id="h5-1-3" class="d">-                    key_index: table.get_row_key_index()?,
</a><a href="#h5-1-4" id="h5-1-4" class="i">+                    key_index: table.primary_key,
</a>                     source: Node::Scan {
                         table,
                         alias: None,
<a href="#h5-2" id="h5-2" class="h">@@ -101,11 +104,10 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a> 
             ast::Statement::Update { table, set, r#where } =&gt; {
                 let table = self.catalog.must_get_table(&amp;table)?;
<a href="#h5-2-3" id="h5-2-3" class="d">-                let key_index = table.get_row_key_index()?;
</a>                 let scope = &amp;mut Scope::from_table(table.clone())?;
                 Plan::Update {
                     table: table.name.clone(),
<a href="#h5-2-7" id="h5-2-7" class="d">-                    key_index,
</a><a href="#h5-2-8" id="h5-2-8" class="i">+                    key_index: table.primary_key,
</a>                     source: Node::Scan {
                         table,
                         alias: None,
<b>diff --git a/<a id="h6" href="../file/src/sql/types/schema.rs.html">src/sql/types/schema.rs</a> b/<a href="../file/src/sql/types/schema.rs.html">src/sql/types/schema.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,31 +1,91 @@
</a><a href="#h6-0-0" id="h6-0-0" class="d">-use super::{DataType, Value};
</a><a href="#h6-0-1" id="h6-0-1" class="i">+use super::value::{DataType, Value};
</a> use crate::encoding;
<a href="#h6-0-3" id="h6-0-3" class="d">-use crate::errinput;
</a> use crate::error::Result;
<a href="#h6-0-5" id="h6-0-5" class="d">-use crate::sql::engine::Catalog;
</a><a href="#h6-0-6" id="h6-0-6" class="d">-use crate::sql::engine::Transaction;
</a><a href="#h6-0-7" id="h6-0-7" class="d">-use crate::sql::parser::format_ident;
</a><a href="#h6-0-8" id="h6-0-8" class="i">+use crate::sql::engine::{Catalog, Transaction};
</a><a href="#h6-0-9" id="h6-0-9" class="i">+use crate::{errdata, errinput};
</a> 
 use serde::{Deserialize, Serialize};
<a href="#h6-0-12" id="h6-0-12" class="d">-use std::fmt::{self, Display};
</a><a href="#h6-0-13" id="h6-0-13" class="i">+use std::borrow::Cow;
</a> 
<a href="#h6-0-15" id="h6-0-15" class="d">-/// A table schema
</a><a href="#h6-0-16" id="h6-0-16" class="i">+/// A table schema, which specifies the structure and constraints of its data.
</a><a href="#h6-0-17" id="h6-0-17" class="i">+///
</a><a href="#h6-0-18" id="h6-0-18" class="i">+/// Tables can&#39;t change after they are created. There is no ALTER TABLE nor
</a><a href="#h6-0-19" id="h6-0-19" class="i">+/// CREATE/DROP INDEX -- only CREATE TABLE and DROP TABLE.
</a> #[derive(Clone, Debug, PartialEq, Deserialize, Serialize)]
 pub struct Table {
<a href="#h6-0-22" id="h6-0-22" class="i">+    /// The table name. Can&#39;t be empty.
</a>     pub name: String,
<a href="#h6-0-24" id="h6-0-24" class="i">+    /// The primary key column index. A table must have a primary key, and it
</a><a href="#h6-0-25" id="h6-0-25" class="i">+    /// can only be a single column.
</a><a href="#h6-0-26" id="h6-0-26" class="i">+    pub primary_key: usize,
</a><a href="#h6-0-27" id="h6-0-27" class="i">+    /// The table&#39;s columns. Must have at least one.
</a>     pub columns: Vec&lt;Column&gt;,
 }
 
 impl encoding::Value for Table {}
 
<a href="#h6-0-33" id="h6-0-33" class="d">-impl Table {
</a><a href="#h6-0-34" id="h6-0-34" class="d">-    /// Creates a new table schema
</a><a href="#h6-0-35" id="h6-0-35" class="d">-    pub fn new(name: String, columns: Vec&lt;Column&gt;) -&gt; Result&lt;Self&gt; {
</a><a href="#h6-0-36" id="h6-0-36" class="d">-        let table = Self { name, columns };
</a><a href="#h6-0-37" id="h6-0-37" class="d">-        Ok(table)
</a><a href="#h6-0-38" id="h6-0-38" class="i">+/// A table column.
</a><a href="#h6-0-39" id="h6-0-39" class="i">+#[derive(Clone, Debug, PartialEq, Deserialize, Serialize)]
</a><a href="#h6-0-40" id="h6-0-40" class="i">+pub struct Column {
</a><a href="#h6-0-41" id="h6-0-41" class="i">+    /// Column name. Can&#39;t be empty.
</a><a href="#h6-0-42" id="h6-0-42" class="i">+    pub name: String,
</a><a href="#h6-0-43" id="h6-0-43" class="i">+    /// Column datatype.
</a><a href="#h6-0-44" id="h6-0-44" class="i">+    pub datatype: DataType,
</a><a href="#h6-0-45" id="h6-0-45" class="i">+    /// Whether the column allows null values. Not legal for primary keys.
</a><a href="#h6-0-46" id="h6-0-46" class="i">+    pub nullable: bool,
</a><a href="#h6-0-47" id="h6-0-47" class="i">+    /// The column&#39;s default value. If None, the user must specify an explicit
</a><a href="#h6-0-48" id="h6-0-48" class="i">+    /// value. Must match the column datatype. Nullable columns require a
</a><a href="#h6-0-49" id="h6-0-49" class="i">+    /// default (often Null), and Null is only a valid default when nullable.
</a><a href="#h6-0-50" id="h6-0-50" class="i">+    pub default: Option&lt;Value&gt;,
</a><a href="#h6-0-51" id="h6-0-51" class="i">+    /// Whether the column should only allow unique values. Must be true for a
</a><a href="#h6-0-52" id="h6-0-52" class="i">+    /// primary key column.
</a><a href="#h6-0-53" id="h6-0-53" class="i">+    pub unique: bool,
</a><a href="#h6-0-54" id="h6-0-54" class="i">+    /// Whether the column should have a secondary index. Never set for primary
</a><a href="#h6-0-55" id="h6-0-55" class="i">+    /// keys, which have an implicit primary index.
</a><a href="#h6-0-56" id="h6-0-56" class="i">+    pub index: bool,
</a><a href="#h6-0-57" id="h6-0-57" class="i">+    /// If set, this column is a foreign key reference to the given table&#39;s
</a><a href="#h6-0-58" id="h6-0-58" class="i">+    /// primary key. Must be of the same type as the target primary key.
</a><a href="#h6-0-59" id="h6-0-59" class="i">+    /// TODO: enforce an index for foreign keys.
</a><a href="#h6-0-60" id="h6-0-60" class="i">+    pub references: Option&lt;String&gt;,
</a><a href="#h6-0-61" id="h6-0-61" class="i">+}
</a><a href="#h6-0-62" id="h6-0-62" class="i">+
</a><a href="#h6-0-63" id="h6-0-63" class="i">+impl std::fmt::Display for Table {
</a><a href="#h6-0-64" id="h6-0-64" class="i">+    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {
</a><a href="#h6-0-65" id="h6-0-65" class="i">+        writeln!(f, &quot;CREATE TABLE {} (&quot;, format_ident(&amp;self.name))?;
</a><a href="#h6-0-66" id="h6-0-66" class="i">+        for (i, column) in self.columns.iter().enumerate() {
</a><a href="#h6-0-67" id="h6-0-67" class="i">+            write!(f, &quot;  {} {}&quot;, format_ident(&amp;column.name), column.datatype)?;
</a><a href="#h6-0-68" id="h6-0-68" class="i">+            if i == self.primary_key {
</a><a href="#h6-0-69" id="h6-0-69" class="i">+                write!(f, &quot; PRIMARY KEY&quot;)?;
</a><a href="#h6-0-70" id="h6-0-70" class="i">+            } else if !column.nullable {
</a><a href="#h6-0-71" id="h6-0-71" class="i">+                write!(f, &quot; NOT NULL&quot;)?;
</a><a href="#h6-0-72" id="h6-0-72" class="i">+            }
</a><a href="#h6-0-73" id="h6-0-73" class="i">+            if let Some(default) = &amp;column.default {
</a><a href="#h6-0-74" id="h6-0-74" class="i">+                write!(f, &quot; DEFAULT {default}&quot;)?;
</a><a href="#h6-0-75" id="h6-0-75" class="i">+            }
</a><a href="#h6-0-76" id="h6-0-76" class="i">+            if i != self.primary_key {
</a><a href="#h6-0-77" id="h6-0-77" class="i">+                if column.unique {
</a><a href="#h6-0-78" id="h6-0-78" class="i">+                    write!(f, &quot; UNIQUE&quot;)?;
</a><a href="#h6-0-79" id="h6-0-79" class="i">+                }
</a><a href="#h6-0-80" id="h6-0-80" class="i">+                if column.index {
</a><a href="#h6-0-81" id="h6-0-81" class="i">+                    write!(f, &quot; INDEX&quot;)?;
</a><a href="#h6-0-82" id="h6-0-82" class="i">+                }
</a><a href="#h6-0-83" id="h6-0-83" class="i">+            }
</a><a href="#h6-0-84" id="h6-0-84" class="i">+            if let Some(reference) = &amp;column.references {
</a><a href="#h6-0-85" id="h6-0-85" class="i">+                write!(f, &quot; REFERENCES {reference}&quot;)?;
</a><a href="#h6-0-86" id="h6-0-86" class="i">+            }
</a><a href="#h6-0-87" id="h6-0-87" class="i">+            if i &lt; self.columns.len() - 1 {
</a><a href="#h6-0-88" id="h6-0-88" class="i">+                write!(f, &quot;,&quot;)?;
</a><a href="#h6-0-89" id="h6-0-89" class="i">+            }
</a><a href="#h6-0-90" id="h6-0-90" class="i">+            writeln!(f)?;
</a><a href="#h6-0-91" id="h6-0-91" class="i">+        }
</a><a href="#h6-0-92" id="h6-0-92" class="i">+        write!(f, &quot;)&quot;)
</a>     }
<a href="#h6-0-94" id="h6-0-94" class="i">+}
</a> 
<a href="#h6-0-96" id="h6-0-96" class="d">-    /// Fetches a column by name
</a><a href="#h6-0-97" id="h6-0-97" class="i">+impl Table {
</a><a href="#h6-0-98" id="h6-0-98" class="i">+    /// Fetches a column by name.
</a><a href="#h6-0-99" id="h6-0-99" class="i">+    ///
</a><a href="#h6-0-100" id="h6-0-100" class="i">+    /// TODO: consider getting rid of all these helpers.
</a>     pub fn get_column(&amp;self, name: &amp;str) -&gt; Result&lt;&amp;Column&gt; {
         self.columns
             .iter()
<a href="#h6-1" id="h6-1" class="h">@@ -41,231 +101,160 @@ impl Table {
</a>             .ok_or(errinput!(&quot;column {name} not found in table {}&quot;, self.name))
     }
 
<a href="#h6-1-3" id="h6-1-3" class="d">-    /// Returns the primary key column of the table
</a><a href="#h6-1-4" id="h6-1-4" class="d">-    pub fn get_primary_key(&amp;self) -&gt; Result&lt;&amp;Column&gt; {
</a><a href="#h6-1-5" id="h6-1-5" class="d">-        self.columns
</a><a href="#h6-1-6" id="h6-1-6" class="d">-            .iter()
</a><a href="#h6-1-7" id="h6-1-7" class="d">-            .find(|c| c.primary_key)
</a><a href="#h6-1-8" id="h6-1-8" class="d">-            .ok_or(errinput!(&quot;primary key not found in table {}&quot;, self.name))
</a><a href="#h6-1-9" id="h6-1-9" class="d">-    }
</a><a href="#h6-1-10" id="h6-1-10" class="d">-
</a><a href="#h6-1-11" id="h6-1-11" class="d">-    /// Returns the primary key value of a row
</a><a href="#h6-1-12" id="h6-1-12" class="d">-    pub fn get_row_key(&amp;self, row: &amp;[Value]) -&gt; Result&lt;Value&gt; {
</a><a href="#h6-1-13" id="h6-1-13" class="d">-        self.get_row_key_at(row, self.get_row_key_index()?)
</a><a href="#h6-1-14" id="h6-1-14" class="i">+    /// Returns the primary key value of a row.
</a><a href="#h6-1-15" id="h6-1-15" class="i">+    pub fn get_row_key&lt;&#39;a&gt;(&amp;self, row: &amp;&#39;a [Value]) -&gt; Result&lt;&amp;&#39;a Value&gt; {
</a><a href="#h6-1-16" id="h6-1-16" class="i">+        row.get(self.primary_key).ok_or(errdata!(&quot;no primary key in row {row:?}&quot;))
</a>     }
 
<a href="#h6-1-19" id="h6-1-19" class="d">-    /// Returns the primary key value at the given index.
</a><a href="#h6-1-20" id="h6-1-20" class="d">-    pub fn get_row_key_at(&amp;self, row: &amp;[Value], index: usize) -&gt; Result&lt;Value&gt; {
</a><a href="#h6-1-21" id="h6-1-21" class="d">-        row.get(index).cloned().ok_or(errinput!(&quot;primary key value not found for row&quot;))
</a><a href="#h6-1-22" id="h6-1-22" class="d">-    }
</a><a href="#h6-1-23" id="h6-1-23" class="d">-
</a><a href="#h6-1-24" id="h6-1-24" class="d">-    /// Returns the index of the primary key field.
</a><a href="#h6-1-25" id="h6-1-25" class="d">-    pub fn get_row_key_index(&amp;self) -&gt; Result&lt;usize&gt; {
</a><a href="#h6-1-26" id="h6-1-26" class="d">-        self.columns.iter().position(|c| c.primary_key).ok_or(errinput!(&quot;primary key not found&quot;))
</a><a href="#h6-1-27" id="h6-1-27" class="d">-    }
</a><a href="#h6-1-28" id="h6-1-28" class="d">-
</a><a href="#h6-1-29" id="h6-1-29" class="d">-    /// Validates the table schema
</a><a href="#h6-1-30" id="h6-1-30" class="d">-    pub fn validate(&amp;self, catalog: &amp;dyn Catalog) -&gt; Result&lt;()&gt; {
</a><a href="#h6-1-31" id="h6-1-31" class="i">+    /// Validates the table schema.
</a><a href="#h6-1-32" id="h6-1-32" class="i">+    pub fn validate(&amp;self, catalog: &amp;impl Catalog) -&gt; Result&lt;()&gt; {
</a><a href="#h6-1-33" id="h6-1-33" class="i">+        if self.name.is_empty() {
</a><a href="#h6-1-34" id="h6-1-34" class="i">+            return errinput!(&quot;table name can&#39;t be empty&quot;);
</a><a href="#h6-1-35" id="h6-1-35" class="i">+        }
</a>         if self.columns.is_empty() {
<a href="#h6-1-37" id="h6-1-37" class="d">-            return errinput!(&quot;table {} has no columns&quot;, self.name);
</a><a href="#h6-1-38" id="h6-1-38" class="i">+            return errinput!(&quot;table has no columns&quot;);
</a>         }
<a href="#h6-1-40" id="h6-1-40" class="d">-        match self.columns.iter().filter(|c| c.primary_key).count() {
</a><a href="#h6-1-41" id="h6-1-41" class="d">-            1 =&gt; {}
</a><a href="#h6-1-42" id="h6-1-42" class="d">-            0 =&gt; return errinput!(&quot;no primary key in table {}&quot;, self.name),
</a><a href="#h6-1-43" id="h6-1-43" class="d">-            _ =&gt; return errinput!(&quot;multiple primary keys in table {}&quot;, self.name),
</a><a href="#h6-1-44" id="h6-1-44" class="d">-        };
</a><a href="#h6-1-45" id="h6-1-45" class="d">-        for column in &amp;self.columns {
</a><a href="#h6-1-46" id="h6-1-46" class="d">-            column.validate(self, catalog)?;
</a><a href="#h6-1-47" id="h6-1-47" class="i">+        if self.columns.get(self.primary_key).is_none() {
</a><a href="#h6-1-48" id="h6-1-48" class="i">+            return errinput!(&quot;invalid primary key index&quot;);
</a>         }
<a href="#h6-1-50" id="h6-1-50" class="d">-        Ok(())
</a><a href="#h6-1-51" id="h6-1-51" class="d">-    }
</a> 
<a href="#h6-1-53" id="h6-1-53" class="d">-    /// Validates a row
</a><a href="#h6-1-54" id="h6-1-54" class="d">-    pub fn validate_row(&amp;self, row: &amp;[Value], txn: &amp;dyn Transaction) -&gt; Result&lt;()&gt; {
</a><a href="#h6-1-55" id="h6-1-55" class="d">-        if row.len() != self.columns.len() {
</a><a href="#h6-1-56" id="h6-1-56" class="d">-            return errinput!(&quot;invalid row size for table {}&quot;, self.name);
</a><a href="#h6-1-57" id="h6-1-57" class="d">-        }
</a><a href="#h6-1-58" id="h6-1-58" class="d">-        let pk = self.get_row_key(row)?;
</a><a href="#h6-1-59" id="h6-1-59" class="d">-        for (column, value) in self.columns.iter().zip(row.iter()) {
</a><a href="#h6-1-60" id="h6-1-60" class="d">-            column.validate_value(self, &amp;pk, value, txn)?;
</a><a href="#h6-1-61" id="h6-1-61" class="d">-        }
</a><a href="#h6-1-62" id="h6-1-62" class="d">-        Ok(())
</a><a href="#h6-1-63" id="h6-1-63" class="d">-    }
</a><a href="#h6-1-64" id="h6-1-64" class="d">-}
</a><a href="#h6-1-65" id="h6-1-65" class="i">+        for (i, column) in self.columns.iter().enumerate() {
</a><a href="#h6-1-66" id="h6-1-66" class="i">+            if column.name.is_empty() {
</a><a href="#h6-1-67" id="h6-1-67" class="i">+                return errinput!(&quot;column name can&#39;t be empty&quot;);
</a><a href="#h6-1-68" id="h6-1-68" class="i">+            }
</a><a href="#h6-1-69" id="h6-1-69" class="i">+            let cname = &amp;column.name; // for formatting convenience
</a> 
<a href="#h6-1-71" id="h6-1-71" class="d">-impl Display for Table {
</a><a href="#h6-1-72" id="h6-1-72" class="d">-    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;&#39;_&gt;) -&gt; fmt::Result {
</a><a href="#h6-1-73" id="h6-1-73" class="d">-        write!(
</a><a href="#h6-1-74" id="h6-1-74" class="d">-            f,
</a><a href="#h6-1-75" id="h6-1-75" class="d">-            &quot;CREATE TABLE {} (\n{}\n)&quot;,
</a><a href="#h6-1-76" id="h6-1-76" class="d">-            format_ident(&amp;self.name),
</a><a href="#h6-1-77" id="h6-1-77" class="d">-            self.columns.iter().map(|c| format!(&quot;  {}&quot;, c)).collect::&lt;Vec&lt;String&gt;&gt;().join(&quot;,\n&quot;)
</a><a href="#h6-1-78" id="h6-1-78" class="d">-        )
</a><a href="#h6-1-79" id="h6-1-79" class="d">-    }
</a><a href="#h6-1-80" id="h6-1-80" class="d">-}
</a><a href="#h6-1-81" id="h6-1-81" class="i">+            // Validate primary key.
</a><a href="#h6-1-82" id="h6-1-82" class="i">+            let is_primary_key = i == self.primary_key;
</a><a href="#h6-1-83" id="h6-1-83" class="i">+            if is_primary_key {
</a><a href="#h6-1-84" id="h6-1-84" class="i">+                if column.nullable {
</a><a href="#h6-1-85" id="h6-1-85" class="i">+                    return errinput!(&quot;primary key {cname} cannot be nullable&quot;);
</a><a href="#h6-1-86" id="h6-1-86" class="i">+                }
</a><a href="#h6-1-87" id="h6-1-87" class="i">+                if !column.unique {
</a><a href="#h6-1-88" id="h6-1-88" class="i">+                    return errinput!(&quot;primary key {cname} must be unique&quot;);
</a><a href="#h6-1-89" id="h6-1-89" class="i">+                }
</a><a href="#h6-1-90" id="h6-1-90" class="i">+                if column.index {
</a><a href="#h6-1-91" id="h6-1-91" class="i">+                    return errinput!(&quot;primary key {cname} can&#39;t have an index&quot;);
</a><a href="#h6-1-92" id="h6-1-92" class="i">+                }
</a><a href="#h6-1-93" id="h6-1-93" class="i">+            }
</a> 
<a href="#h6-1-95" id="h6-1-95" class="d">-/// A table column schema
</a><a href="#h6-1-96" id="h6-1-96" class="d">-#[derive(Clone, Debug, PartialEq, Deserialize, Serialize)]
</a><a href="#h6-1-97" id="h6-1-97" class="d">-pub struct Column {
</a><a href="#h6-1-98" id="h6-1-98" class="d">-    /// Column name
</a><a href="#h6-1-99" id="h6-1-99" class="d">-    pub name: String,
</a><a href="#h6-1-100" id="h6-1-100" class="d">-    /// Column datatype
</a><a href="#h6-1-101" id="h6-1-101" class="d">-    pub datatype: DataType,
</a><a href="#h6-1-102" id="h6-1-102" class="d">-    /// Whether the column is a primary key
</a><a href="#h6-1-103" id="h6-1-103" class="d">-    pub primary_key: bool,
</a><a href="#h6-1-104" id="h6-1-104" class="d">-    /// Whether the column allows null values
</a><a href="#h6-1-105" id="h6-1-105" class="d">-    pub nullable: bool,
</a><a href="#h6-1-106" id="h6-1-106" class="d">-    /// The default value of the column
</a><a href="#h6-1-107" id="h6-1-107" class="d">-    pub default: Option&lt;Value&gt;,
</a><a href="#h6-1-108" id="h6-1-108" class="d">-    /// Whether the column should only take unique values
</a><a href="#h6-1-109" id="h6-1-109" class="d">-    pub unique: bool,
</a><a href="#h6-1-110" id="h6-1-110" class="d">-    /// The table which is referenced by this foreign key
</a><a href="#h6-1-111" id="h6-1-111" class="d">-    pub references: Option&lt;String&gt;,
</a><a href="#h6-1-112" id="h6-1-112" class="d">-    /// Whether the column should be indexed
</a><a href="#h6-1-113" id="h6-1-113" class="d">-    pub index: bool,
</a><a href="#h6-1-114" id="h6-1-114" class="d">-}
</a><a href="#h6-1-115" id="h6-1-115" class="i">+            // Validate default value.
</a><a href="#h6-1-116" id="h6-1-116" class="i">+            match &amp;column.default {
</a><a href="#h6-1-117" id="h6-1-117" class="i">+                Some(Value::Null) if !column.nullable =&gt; {
</a><a href="#h6-1-118" id="h6-1-118" class="i">+                    return errinput!(&quot;invalid NULL default for non-nullable column {cname}&quot;)
</a><a href="#h6-1-119" id="h6-1-119" class="i">+                }
</a><a href="#h6-1-120" id="h6-1-120" class="i">+                Some(Value::Null) =&gt; {}
</a><a href="#h6-1-121" id="h6-1-121" class="i">+                Some(value) if value.datatype().as_ref() != Some(&amp;column.datatype) =&gt; {
</a><a href="#h6-1-122" id="h6-1-122" class="i">+                    let (ctype, vtype) = (&amp;column.datatype, value.datatype().unwrap());
</a><a href="#h6-1-123" id="h6-1-123" class="i">+                    return errinput!(&quot;invalid datatype {vtype} for {ctype} column {cname}&quot;,);
</a><a href="#h6-1-124" id="h6-1-124" class="i">+                }
</a><a href="#h6-1-125" id="h6-1-125" class="i">+                Some(_) =&gt; {}
</a><a href="#h6-1-126" id="h6-1-126" class="i">+                None if column.nullable =&gt; {
</a><a href="#h6-1-127" id="h6-1-127" class="i">+                    return errinput!(&quot;nullable column {cname} must have a default value&quot;)
</a><a href="#h6-1-128" id="h6-1-128" class="i">+                }
</a><a href="#h6-1-129" id="h6-1-129" class="i">+                None =&gt; {}
</a><a href="#h6-1-130" id="h6-1-130" class="i">+            }
</a> 
<a href="#h6-1-132" id="h6-1-132" class="d">-impl Column {
</a><a href="#h6-1-133" id="h6-1-133" class="d">-    /// Validates the column schema
</a><a href="#h6-1-134" id="h6-1-134" class="d">-    pub fn validate(&amp;self, table: &amp;Table, catalog: &amp;dyn Catalog) -&gt; Result&lt;()&gt; {
</a><a href="#h6-1-135" id="h6-1-135" class="d">-        // Validate primary key
</a><a href="#h6-1-136" id="h6-1-136" class="d">-        if self.primary_key &amp;&amp; self.nullable {
</a><a href="#h6-1-137" id="h6-1-137" class="d">-            return errinput!(&quot;primary key {} cannot be nullable&quot;, self.name);
</a><a href="#h6-1-138" id="h6-1-138" class="d">-        }
</a><a href="#h6-1-139" id="h6-1-139" class="d">-        if self.primary_key &amp;&amp; !self.unique {
</a><a href="#h6-1-140" id="h6-1-140" class="d">-            return errinput!(&quot;primary key {} must be unique&quot;, self.name);
</a><a href="#h6-1-141" id="h6-1-141" class="d">-        }
</a><a href="#h6-1-142" id="h6-1-142" class="i">+            // Validate unique index.
</a><a href="#h6-1-143" id="h6-1-143" class="i">+            if column.unique &amp;&amp; !column.index &amp;&amp; !is_primary_key {
</a><a href="#h6-1-144" id="h6-1-144" class="i">+                return errinput!(&quot;unique column {cname} must have a secondary index&quot;);
</a><a href="#h6-1-145" id="h6-1-145" class="i">+            }
</a> 
<a href="#h6-1-147" id="h6-1-147" class="d">-        // Validate default value
</a><a href="#h6-1-148" id="h6-1-148" class="d">-        if let Some(default) = &amp;self.default {
</a><a href="#h6-1-149" id="h6-1-149" class="d">-            if let Some(datatype) = default.datatype() {
</a><a href="#h6-1-150" id="h6-1-150" class="d">-                if datatype != self.datatype {
</a><a href="#h6-1-151" id="h6-1-151" class="i">+            // Validate references.
</a><a href="#h6-1-152" id="h6-1-152" class="i">+            if let Some(reference) = &amp;column.references {
</a><a href="#h6-1-153" id="h6-1-153" class="i">+                if !column.index &amp;&amp; !is_primary_key {
</a><a href="#h6-1-154" id="h6-1-154" class="i">+                    return errinput!(&quot;reference column {cname} must have a secondary index&quot;);
</a><a href="#h6-1-155" id="h6-1-155" class="i">+                }
</a><a href="#h6-1-156" id="h6-1-156" class="i">+                let target_type = if reference == &amp;self.name {
</a><a href="#h6-1-157" id="h6-1-157" class="i">+                    self.columns[self.primary_key].datatype
</a><a href="#h6-1-158" id="h6-1-158" class="i">+                } else if let Some(target) = catalog.get_table(reference)? {
</a><a href="#h6-1-159" id="h6-1-159" class="i">+                    target.columns[target.primary_key].datatype
</a><a href="#h6-1-160" id="h6-1-160" class="i">+                } else {
</a><a href="#h6-1-161" id="h6-1-161" class="i">+                    return errinput!(&quot;unknown table {reference} referenced by column {cname}&quot;);
</a><a href="#h6-1-162" id="h6-1-162" class="i">+                };
</a><a href="#h6-1-163" id="h6-1-163" class="i">+                if column.datatype != target_type {
</a>                     return errinput!(
<a href="#h6-1-165" id="h6-1-165" class="d">-                        &quot;default value for column {} has datatype {datatype}, must be {}&quot;,
</a><a href="#h6-1-166" id="h6-1-166" class="d">-                        self.name,
</a><a href="#h6-1-167" id="h6-1-167" class="d">-                        self.datatype
</a><a href="#h6-1-168" id="h6-1-168" class="i">+                        &quot;can&#39;t reference {target_type} primary key of {reference} from {} column {cname}&quot;,
</a><a href="#h6-1-169" id="h6-1-169" class="i">+                        column.datatype,
</a>                     );
                 }
<a href="#h6-1-172" id="h6-1-172" class="d">-            } else if !self.nullable {
</a><a href="#h6-1-173" id="h6-1-173" class="d">-                return errinput!(
</a><a href="#h6-1-174" id="h6-1-174" class="d">-                    &quot;can&#39;t use NULL as default value for non-nullable column {}&quot;,
</a><a href="#h6-1-175" id="h6-1-175" class="d">-                    self.name
</a><a href="#h6-1-176" id="h6-1-176" class="d">-                );
</a><a href="#h6-1-177" id="h6-1-177" class="d">-            }
</a><a href="#h6-1-178" id="h6-1-178" class="d">-        } else if self.nullable {
</a><a href="#h6-1-179" id="h6-1-179" class="d">-            return errinput!(&quot;nullable column {} must have a default value&quot;, self.name);
</a><a href="#h6-1-180" id="h6-1-180" class="d">-        }
</a><a href="#h6-1-181" id="h6-1-181" class="d">-
</a><a href="#h6-1-182" id="h6-1-182" class="d">-        // Validate references
</a><a href="#h6-1-183" id="h6-1-183" class="d">-        if let Some(reference) = &amp;self.references {
</a><a href="#h6-1-184" id="h6-1-184" class="d">-            let target = if reference == &amp;table.name {
</a><a href="#h6-1-185" id="h6-1-185" class="d">-                table.clone()
</a><a href="#h6-1-186" id="h6-1-186" class="d">-            } else if let Some(table) = catalog.get_table(reference)? {
</a><a href="#h6-1-187" id="h6-1-187" class="d">-                table
</a><a href="#h6-1-188" id="h6-1-188" class="d">-            } else {
</a><a href="#h6-1-189" id="h6-1-189" class="d">-                return errinput!(
</a><a href="#h6-1-190" id="h6-1-190" class="d">-                    &quot;table {reference} referenced by column {} does not exist&quot;,
</a><a href="#h6-1-191" id="h6-1-191" class="d">-                    self.name
</a><a href="#h6-1-192" id="h6-1-192" class="d">-                );
</a><a href="#h6-1-193" id="h6-1-193" class="d">-            };
</a><a href="#h6-1-194" id="h6-1-194" class="d">-            if self.datatype != target.get_primary_key()?.datatype {
</a><a href="#h6-1-195" id="h6-1-195" class="d">-                return errinput!(
</a><a href="#h6-1-196" id="h6-1-196" class="d">-                    &quot;can&#39;t reference {} primary key of table {} from {} column {}&quot;,
</a><a href="#h6-1-197" id="h6-1-197" class="d">-                    target.get_primary_key()?.datatype,
</a><a href="#h6-1-198" id="h6-1-198" class="d">-                    target.name,
</a><a href="#h6-1-199" id="h6-1-199" class="d">-                    self.datatype,
</a><a href="#h6-1-200" id="h6-1-200" class="d">-                    self.name
</a><a href="#h6-1-201" id="h6-1-201" class="d">-                );
</a>             }
         }
<a href="#h6-1-204" id="h6-1-204" class="d">-
</a>         Ok(())
     }
 
<a href="#h6-1-208" id="h6-1-208" class="d">-    /// Validates a column value
</a><a href="#h6-1-209" id="h6-1-209" class="d">-    pub fn validate_value(
</a><a href="#h6-1-210" id="h6-1-210" class="d">-        &amp;self,
</a><a href="#h6-1-211" id="h6-1-211" class="d">-        table: &amp;Table,
</a><a href="#h6-1-212" id="h6-1-212" class="d">-        pk: &amp;Value,
</a><a href="#h6-1-213" id="h6-1-213" class="d">-        value: &amp;Value,
</a><a href="#h6-1-214" id="h6-1-214" class="d">-        txn: &amp;dyn Transaction,
</a><a href="#h6-1-215" id="h6-1-215" class="d">-    ) -&gt; Result&lt;()&gt; {
</a><a href="#h6-1-216" id="h6-1-216" class="d">-        // Validate datatype
</a><a href="#h6-1-217" id="h6-1-217" class="d">-        match value.datatype() {
</a><a href="#h6-1-218" id="h6-1-218" class="d">-            None if self.nullable =&gt; Ok(()),
</a><a href="#h6-1-219" id="h6-1-219" class="d">-            None =&gt; errinput!(&quot;NULL value not allowed for column {}&quot;, self.name),
</a><a href="#h6-1-220" id="h6-1-220" class="d">-            Some(ref datatype) if datatype != &amp;self.datatype =&gt; errinput!(
</a><a href="#h6-1-221" id="h6-1-221" class="d">-                &quot;invalid datatype {} for {} column {}&quot;,
</a><a href="#h6-1-222" id="h6-1-222" class="d">-                datatype,
</a><a href="#h6-1-223" id="h6-1-223" class="d">-                self.datatype,
</a><a href="#h6-1-224" id="h6-1-224" class="d">-                self.name
</a><a href="#h6-1-225" id="h6-1-225" class="d">-            ),
</a><a href="#h6-1-226" id="h6-1-226" class="d">-            _ =&gt; Ok(()),
</a><a href="#h6-1-227" id="h6-1-227" class="d">-        }?;
</a><a href="#h6-1-228" id="h6-1-228" class="d">-
</a><a href="#h6-1-229" id="h6-1-229" class="d">-        // Validate value
</a><a href="#h6-1-230" id="h6-1-230" class="d">-        match value {
</a><a href="#h6-1-231" id="h6-1-231" class="d">-            Value::String(s) if s.len() &gt; 1024 =&gt; {
</a><a href="#h6-1-232" id="h6-1-232" class="d">-                errinput!(&quot;strings cannot be more than 1024 bytes&quot;)
</a><a href="#h6-1-233" id="h6-1-233" class="i">+    /// Validates a row.
</a><a href="#h6-1-234" id="h6-1-234" class="i">+    ///
</a><a href="#h6-1-235" id="h6-1-235" class="i">+    /// TODO: clean this up together with the Local engine. Who should be
</a><a href="#h6-1-236" id="h6-1-236" class="i">+    /// responsible for non-local validation (i.e. primary/unique conflicts and
</a><a href="#h6-1-237" id="h6-1-237" class="i">+    /// reference integrity)?
</a><a href="#h6-1-238" id="h6-1-238" class="i">+    pub fn validate_row(&amp;self, row: &amp;[Value], txn: &amp;impl Transaction) -&gt; Result&lt;()&gt; {
</a><a href="#h6-1-239" id="h6-1-239" class="i">+        if row.len() != self.columns.len() {
</a><a href="#h6-1-240" id="h6-1-240" class="i">+            return errinput!(&quot;invalid row size for table {}&quot;, self.name);
</a><a href="#h6-1-241" id="h6-1-241" class="i">+        }
</a><a href="#h6-1-242" id="h6-1-242" class="i">+        let pk = self.get_row_key(row)?;
</a><a href="#h6-1-243" id="h6-1-243" class="i">+        for (i, (column, value)) in self.columns.iter().zip(row.iter()).enumerate() {
</a><a href="#h6-1-244" id="h6-1-244" class="i">+            // Validate datatype.
</a><a href="#h6-1-245" id="h6-1-245" class="i">+            match value.datatype() {
</a><a href="#h6-1-246" id="h6-1-246" class="i">+                None if column.nullable =&gt; {}
</a><a href="#h6-1-247" id="h6-1-247" class="i">+                None =&gt; return errinput!(&quot;NULL value not allowed for column {}&quot;, column.name),
</a><a href="#h6-1-248" id="h6-1-248" class="i">+                Some(ref datatype) if datatype != &amp;column.datatype =&gt; {
</a><a href="#h6-1-249" id="h6-1-249" class="i">+                    return errinput!(
</a><a href="#h6-1-250" id="h6-1-250" class="i">+                        &quot;invalid datatype {} for {} column {}&quot;,
</a><a href="#h6-1-251" id="h6-1-251" class="i">+                        datatype,
</a><a href="#h6-1-252" id="h6-1-252" class="i">+                        column.datatype,
</a><a href="#h6-1-253" id="h6-1-253" class="i">+                        column.name
</a><a href="#h6-1-254" id="h6-1-254" class="i">+                    )
</a><a href="#h6-1-255" id="h6-1-255" class="i">+                }
</a><a href="#h6-1-256" id="h6-1-256" class="i">+                _ =&gt; {}
</a>             }
<a href="#h6-1-258" id="h6-1-258" class="d">-            _ =&gt; Ok(()),
</a><a href="#h6-1-259" id="h6-1-259" class="d">-        }?;
</a> 
<a href="#h6-1-261" id="h6-1-261" class="d">-        // Validate outgoing references
</a><a href="#h6-1-262" id="h6-1-262" class="d">-        if let Some(target) = &amp;self.references {
</a><a href="#h6-1-263" id="h6-1-263" class="i">+            // Validate value
</a>             match value {
<a href="#h6-1-265" id="h6-1-265" class="d">-                Value::Null =&gt; Ok(()),
</a><a href="#h6-1-266" id="h6-1-266" class="d">-                Value::Float(f) if f.is_nan() =&gt; Ok(()),
</a><a href="#h6-1-267" id="h6-1-267" class="d">-                v if target == &amp;table.name &amp;&amp; v == pk =&gt; Ok(()),
</a><a href="#h6-1-268" id="h6-1-268" class="d">-                v if txn.get(target, &amp;[v.clone()])?.is_empty() =&gt; {
</a><a href="#h6-1-269" id="h6-1-269" class="d">-                    errinput!(&quot;referenced primary key {v} in table {target} does not exist&quot;,)
</a><a href="#h6-1-270" id="h6-1-270" class="i">+                Value::String(s) if s.len() &gt; 1024 =&gt; {
</a><a href="#h6-1-271" id="h6-1-271" class="i">+                    errinput!(&quot;strings cannot be more than 1024 bytes&quot;)
</a>                 }
                 _ =&gt; Ok(()),
             }?;
<a href="#h6-1-275" id="h6-1-275" class="d">-        }
</a> 
<a href="#h6-1-277" id="h6-1-277" class="d">-        // Validate uniqueness constraints
</a><a href="#h6-1-278" id="h6-1-278" class="d">-        if self.unique &amp;&amp; !self.primary_key &amp;&amp; value != &amp;Value::Null {
</a><a href="#h6-1-279" id="h6-1-279" class="d">-            let index = table.get_column_index(&amp;self.name)?;
</a><a href="#h6-1-280" id="h6-1-280" class="d">-            let mut scan = txn.scan(&amp;table.name, None)?;
</a><a href="#h6-1-281" id="h6-1-281" class="d">-            while let Some(row) = scan.next().transpose()? {
</a><a href="#h6-1-282" id="h6-1-282" class="d">-                if row.get(index).unwrap_or(&amp;Value::Null) == value
</a><a href="#h6-1-283" id="h6-1-283" class="d">-                    &amp;&amp; &amp;table.get_row_key(&amp;row)? != pk
</a><a href="#h6-1-284" id="h6-1-284" class="d">-                {
</a><a href="#h6-1-285" id="h6-1-285" class="d">-                    return errinput!(
</a><a href="#h6-1-286" id="h6-1-286" class="d">-                        &quot;unique value {value} already exists for column {}&quot;,
</a><a href="#h6-1-287" id="h6-1-287" class="d">-                        self.name
</a><a href="#h6-1-288" id="h6-1-288" class="d">-                    );
</a><a href="#h6-1-289" id="h6-1-289" class="i">+            // Validate outgoing references
</a><a href="#h6-1-290" id="h6-1-290" class="i">+            if let Some(target) = &amp;column.references {
</a><a href="#h6-1-291" id="h6-1-291" class="i">+                match value {
</a><a href="#h6-1-292" id="h6-1-292" class="i">+                    Value::Null =&gt; Ok(()),
</a><a href="#h6-1-293" id="h6-1-293" class="i">+                    Value::Float(f) if f.is_nan() =&gt; Ok(()),
</a><a href="#h6-1-294" id="h6-1-294" class="i">+                    v if target == &amp;self.name &amp;&amp; v == pk =&gt; Ok(()),
</a><a href="#h6-1-295" id="h6-1-295" class="i">+                    v if txn.get(target, &amp;[v.clone()])?.is_empty() =&gt; {
</a><a href="#h6-1-296" id="h6-1-296" class="i">+                        errinput!(&quot;referenced primary key {v} in table {target} does not exist&quot;,)
</a><a href="#h6-1-297" id="h6-1-297" class="i">+                    }
</a><a href="#h6-1-298" id="h6-1-298" class="i">+                    _ =&gt; Ok(()),
</a><a href="#h6-1-299" id="h6-1-299" class="i">+                }?;
</a><a href="#h6-1-300" id="h6-1-300" class="i">+            }
</a><a href="#h6-1-301" id="h6-1-301" class="i">+
</a><a href="#h6-1-302" id="h6-1-302" class="i">+            // Validate uniqueness constraints.
</a><a href="#h6-1-303" id="h6-1-303" class="i">+            // TODO: this needs an index lookup.
</a><a href="#h6-1-304" id="h6-1-304" class="i">+            if column.unique &amp;&amp; i != self.primary_key &amp;&amp; value != &amp;Value::Null {
</a><a href="#h6-1-305" id="h6-1-305" class="i">+                let index = self.get_column_index(&amp;column.name)?;
</a><a href="#h6-1-306" id="h6-1-306" class="i">+                let mut scan = txn.scan(&amp;self.name, None)?;
</a><a href="#h6-1-307" id="h6-1-307" class="i">+                while let Some(row) = scan.next().transpose()? {
</a><a href="#h6-1-308" id="h6-1-308" class="i">+                    if row.get(index).unwrap_or(&amp;Value::Null) == value
</a><a href="#h6-1-309" id="h6-1-309" class="i">+                        &amp;&amp; self.get_row_key(&amp;row)? != pk
</a><a href="#h6-1-310" id="h6-1-310" class="i">+                    {
</a><a href="#h6-1-311" id="h6-1-311" class="i">+                        return errinput!(
</a><a href="#h6-1-312" id="h6-1-312" class="i">+                            &quot;unique value {value} already exists for column {}&quot;,
</a><a href="#h6-1-313" id="h6-1-313" class="i">+                            column.name
</a><a href="#h6-1-314" id="h6-1-314" class="i">+                        );
</a><a href="#h6-1-315" id="h6-1-315" class="i">+                    }
</a>                 }
             }
         }
<a href="#h6-1-319" id="h6-1-319" class="d">-
</a>         Ok(())
     }
 }
 
<a href="#h6-1-324" id="h6-1-324" class="d">-impl Display for Column {
</a><a href="#h6-1-325" id="h6-1-325" class="d">-    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;&#39;_&gt;) -&gt; fmt::Result {
</a><a href="#h6-1-326" id="h6-1-326" class="d">-        let mut sql = format_ident(&amp;self.name);
</a><a href="#h6-1-327" id="h6-1-327" class="d">-        sql += &amp;format!(&quot; {}&quot;, self.datatype);
</a><a href="#h6-1-328" id="h6-1-328" class="d">-        if self.primary_key {
</a><a href="#h6-1-329" id="h6-1-329" class="d">-            sql += &quot; PRIMARY KEY&quot;;
</a><a href="#h6-1-330" id="h6-1-330" class="d">-        }
</a><a href="#h6-1-331" id="h6-1-331" class="d">-        if !self.nullable &amp;&amp; !self.primary_key {
</a><a href="#h6-1-332" id="h6-1-332" class="d">-            sql += &quot; NOT NULL&quot;;
</a><a href="#h6-1-333" id="h6-1-333" class="d">-        }
</a><a href="#h6-1-334" id="h6-1-334" class="d">-        if let Some(default) = &amp;self.default {
</a><a href="#h6-1-335" id="h6-1-335" class="d">-            sql += &amp;format!(&quot; DEFAULT {}&quot;, default);
</a><a href="#h6-1-336" id="h6-1-336" class="d">-        }
</a><a href="#h6-1-337" id="h6-1-337" class="d">-        if self.unique &amp;&amp; !self.primary_key {
</a><a href="#h6-1-338" id="h6-1-338" class="d">-            sql += &quot; UNIQUE&quot;;
</a><a href="#h6-1-339" id="h6-1-339" class="d">-        }
</a><a href="#h6-1-340" id="h6-1-340" class="d">-        if let Some(reference) = &amp;self.references {
</a><a href="#h6-1-341" id="h6-1-341" class="d">-            sql += &amp;format!(&quot; REFERENCES {}&quot;, reference);
</a><a href="#h6-1-342" id="h6-1-342" class="d">-        }
</a><a href="#h6-1-343" id="h6-1-343" class="d">-        if self.index {
</a><a href="#h6-1-344" id="h6-1-344" class="d">-            sql += &quot; INDEX&quot;;
</a><a href="#h6-1-345" id="h6-1-345" class="d">-        }
</a><a href="#h6-1-346" id="h6-1-346" class="d">-        write!(f, &quot;{}&quot;, sql)
</a><a href="#h6-1-347" id="h6-1-347" class="i">+/// Formats an identifier as valid SQL, quoting it if necessary.
</a><a href="#h6-1-348" id="h6-1-348" class="i">+fn format_ident(ident: &amp;str) -&gt; Cow&lt;str&gt; {
</a><a href="#h6-1-349" id="h6-1-349" class="i">+    if crate::sql::parser::is_ident(ident) {
</a><a href="#h6-1-350" id="h6-1-350" class="i">+        return ident.into();
</a>     }
<a href="#h6-1-352" id="h6-1-352" class="i">+    format!(&quot;\&quot;{}\&quot;&quot;, ident.replace(&#39;\&quot;&#39;, &quot;\&quot;\&quot;&quot;)).into()
</a> }
<b>diff --git a/<a id="h7" href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a> b/<a href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -5,7 +5,7 @@ use crate::error::{Error, Result};
</a> use serde::{Deserialize, Serialize};
 
 /// A primitive data type.
<a href="#h7-0-3" id="h7-0-3" class="d">-#[derive(Clone, Debug, Hash, PartialEq, Serialize, Deserialize)]
</a><a href="#h7-0-4" id="h7-0-4" class="i">+#[derive(Clone, Copy, Debug, Hash, PartialEq, Serialize, Deserialize)]
</a> pub enum DataType {
     /// A boolean: true or false.
     Boolean,
<b>diff --git a/<a id="h8" href="../file/tests/e2e/client.rs.html">tests/e2e/client.rs</a> b/<a href="../file/tests/e2e/client.rs.html">tests/e2e/client.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -26,11 +26,11 @@ fn get_table() -&gt; Result&lt;()&gt; {
</a>         c.get_table(&quot;movies&quot;)?,
         schema::Table {
             name: &quot;movies&quot;.into(),
<a href="#h8-0-3" id="h8-0-3" class="i">+            primary_key: 0,
</a>             columns: vec![
                 schema::Column {
                     name: &quot;id&quot;.into(),
                     datatype: DataType::Integer,
<a href="#h8-0-8" id="h8-0-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h8-1" id="h8-1" class="h">@@ -40,7 +40,6 @@ fn get_table() -&gt; Result&lt;()&gt; {
</a>                 schema::Column {
                     name: &quot;title&quot;.into(),
                     datatype: DataType::String,
<a href="#h8-1-3" id="h8-1-3" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h8-2" id="h8-2" class="h">@@ -50,27 +49,24 @@ fn get_table() -&gt; Result&lt;()&gt; {
</a>                 schema::Column {
                     name: &quot;studio_id&quot;.into(),
                     datatype: DataType::Integer,
<a href="#h8-2-3" id="h8-2-3" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h8-2-7" id="h8-2-7" class="d">-                    index: false,
</a><a href="#h8-2-8" id="h8-2-8" class="i">+                    index: true,
</a>                     references: Some(&quot;studios&quot;.into()),
                 },
                 schema::Column {
                     name: &quot;genre_id&quot;.into(),
                     datatype: DataType::Integer,
<a href="#h8-2-14" id="h8-2-14" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h8-2-18" id="h8-2-18" class="d">-                    index: false,
</a><a href="#h8-2-19" id="h8-2-19" class="i">+                    index: true,
</a>                     references: Some(&quot;genres&quot;.into()),
                 },
                 schema::Column {
                     name: &quot;released&quot;.into(),
                     datatype: DataType::Integer,
<a href="#h8-2-25" id="h8-2-25" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h8-3" id="h8-3" class="h">@@ -80,7 +76,6 @@ fn get_table() -&gt; Result&lt;()&gt; {
</a>                 schema::Column {
                     name: &quot;rating&quot;.into(),
                     datatype: DataType::Float,
<a href="#h8-3-3" id="h8-3-3" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(Value::Null),
                     unique: false,
<a href="#h8-4" id="h8-4" class="h">@@ -90,7 +85,6 @@ fn get_table() -&gt; Result&lt;()&gt; {
</a>                 schema::Column {
                     name: &quot;ultrahd&quot;.into(),
                     datatype: DataType::Boolean,
<a href="#h8-4-3" id="h8-4-3" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(Value::Null),
                     unique: false,
<a href="#h8-5" id="h8-5" class="h">@@ -132,9 +126,9 @@ fn status() -&gt; Result&lt;()&gt; {
</a>                 storage: storage::engine::Status {
                     name: &quot;bitcask&quot;.to_string(),
                     keys: 13,
<a href="#h8-5-3" id="h8-5-3" class="d">-                    size: 962,
</a><a href="#h8-5-4" id="h8-5-4" class="d">-                    total_disk_size: 1176,
</a><a href="#h8-5-5" id="h8-5-5" class="d">-                    live_disk_size: 1066,
</a><a href="#h8-5-6" id="h8-5-6" class="i">+                    size: 952,
</a><a href="#h8-5-7" id="h8-5-7" class="i">+                    total_disk_size: 1166,
</a><a href="#h8-5-8" id="h8-5-8" class="i">+                    live_disk_size: 1056,
</a>                     garbage_disk_size: 110,
                 },
             },
<a href="#h8-6" id="h8-6" class="h">@@ -143,11 +137,11 @@ fn status() -&gt; Result&lt;()&gt; {
</a>                 active_txns: 0,
                 storage: engine::Status {
                     name: &quot;bitcask&quot;.to_string(),
<a href="#h8-6-3" id="h8-6-3" class="d">-                    keys: 26,
</a><a href="#h8-6-4" id="h8-6-4" class="d">-                    size: 1630,
</a><a href="#h8-6-5" id="h8-6-5" class="d">-                    total_disk_size: 4156,
</a><a href="#h8-6-6" id="h8-6-6" class="d">-                    live_disk_size: 1838,
</a><a href="#h8-6-7" id="h8-6-7" class="d">-                    garbage_disk_size: 2318
</a><a href="#h8-6-8" id="h8-6-8" class="i">+                    keys: 36,
</a><a href="#h8-6-9" id="h8-6-9" class="i">+                    size: 2177,
</a><a href="#h8-6-10" id="h8-6-10" class="i">+                    total_disk_size: 7601,
</a><a href="#h8-6-11" id="h8-6-11" class="i">+                    live_disk_size: 2465,
</a><a href="#h8-6-12" id="h8-6-12" class="i">+                    garbage_disk_size: 5136,
</a>                 },
             }
         },
<b>diff --git a/<a id="h9" href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a> b/<a href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -107,28 +107,27 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;booleans&quot;,
<a href="#h9-0-3" id="h9-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h9-0-8" id="h9-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h9-0-12" id="h9-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h9-0-14" id="h9-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;b&quot;,
                                     datatype: Boolean,
<a href="#h9-0-19" id="h9-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h9-0-25" id="h9-0-25" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h9-0-27" id="h9-0-27" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h9-1" id="h9-1" class="h">@@ -267,28 +266,27 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;booleans&quot;,
<a href="#h9-1-3" id="h9-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h9-1-8" id="h9-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h9-1-12" id="h9-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h9-1-14" id="h9-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;b&quot;,
                                 datatype: Boolean,
<a href="#h9-1-19" id="h9-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h9-1-25" id="h9-1-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h9-1-27" id="h9-1-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h10" href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a> b/<a href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -93,28 +93,27 @@ Plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;booleans&quot;,
<a href="#h10-0-3" id="h10-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h10-0-8" id="h10-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h10-0-12" id="h10-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h10-0-14" id="h10-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;b&quot;,
                                 datatype: Boolean,
<a href="#h10-0-19" id="h10-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h10-0-25" id="h10-0-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h10-0-27" id="h10-0-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h10-1" id="h10-1" class="h">@@ -239,28 +238,27 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;booleans&quot;,
<a href="#h10-1-3" id="h10-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h10-1-8" id="h10-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h10-1-12" id="h10-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h10-1-14" id="h10-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;b&quot;,
                                 datatype: Boolean,
<a href="#h10-1-19" id="h10-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h10-1-25" id="h10-1-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h10-1-27" id="h10-1-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h11" href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a> b/<a href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -98,26 +98,25 @@ Plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h11-0-3" id="h11-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h11-0-8" id="h11-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h11-0-12" id="h11-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h11-0-14" id="h11-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h11-0-19" id="h11-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h11-0-23" id="h11-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h11-0-25" id="h11-0-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h11-1" id="h11-1" class="h">@@ -222,26 +221,25 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h11-1-3" id="h11-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h11-1-8" id="h11-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h11-1-12" id="h11-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h11-1-14" id="h11-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h11-1-19" id="h11-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h11-1-23" id="h11-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h11-1-25" id="h11-1-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h12" href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a> b/<a href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -46,84 +46,78 @@ Plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h12-0-3" id="h12-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h12-0-8" id="h12-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h12-0-12" id="h12-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-0-14" id="h12-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h12-0-19" id="h12-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h12-0-23" id="h12-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-0-25" id="h12-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h12-0-30" id="h12-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h12-0-34" id="h12-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h12-0-38" id="h12-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h12-0-43" id="h12-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h12-0-47" id="h12-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h12-0-51" id="h12-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h12-0-56" id="h12-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h12-0-60" id="h12-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-0-62" id="h12-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h12-0-67" id="h12-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h12-0-73" id="h12-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-0-75" id="h12-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h12-0-80" id="h12-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h12-0-86" id="h12-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-0-88" id="h12-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h12-1" id="h12-1" class="h">@@ -164,84 +158,78 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h12-1-3" id="h12-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h12-1-8" id="h12-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h12-1-12" id="h12-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-1-14" id="h12-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h12-1-19" id="h12-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h12-1-23" id="h12-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-1-25" id="h12-1-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h12-1-30" id="h12-1-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h12-1-34" id="h12-1-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h12-1-38" id="h12-1-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h12-1-43" id="h12-1-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h12-1-47" id="h12-1-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h12-1-51" id="h12-1-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h12-1-56" id="h12-1-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h12-1-60" id="h12-1-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-1-62" id="h12-1-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h12-1-67" id="h12-1-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h12-1-73" id="h12-1-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-1-75" id="h12-1-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h12-1-80" id="h12-1-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h12-1-86" id="h12-1-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h12-1-88" id="h12-1-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a> b/<a href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -68,84 +68,78 @@ Plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h13-0-3" id="h13-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h13-0-8" id="h13-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h13-0-12" id="h13-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-0-14" id="h13-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h13-0-19" id="h13-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h13-0-23" id="h13-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-0-25" id="h13-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h13-0-30" id="h13-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h13-0-34" id="h13-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h13-0-38" id="h13-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h13-0-43" id="h13-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h13-0-47" id="h13-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h13-0-51" id="h13-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h13-0-56" id="h13-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h13-0-60" id="h13-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-0-62" id="h13-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h13-0-67" id="h13-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h13-0-73" id="h13-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-0-75" id="h13-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h13-0-80" id="h13-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h13-0-86" id="h13-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-0-88" id="h13-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h13-1" id="h13-1" class="h">@@ -212,84 +206,78 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h13-1-3" id="h13-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h13-1-8" id="h13-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h13-1-12" id="h13-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-1-14" id="h13-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h13-1-19" id="h13-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h13-1-23" id="h13-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-1-25" id="h13-1-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h13-1-30" id="h13-1-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h13-1-34" id="h13-1-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h13-1-38" id="h13-1-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h13-1-43" id="h13-1-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h13-1-47" id="h13-1-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h13-1-51" id="h13-1-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h13-1-56" id="h13-1-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h13-1-60" id="h13-1-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-1-62" id="h13-1-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h13-1-67" id="h13-1-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h13-1-73" id="h13-1-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-1-75" id="h13-1-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h13-1-80" id="h13-1-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h13-1-86" id="h13-1-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h13-1-88" id="h13-1-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h14" href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a> b/<a href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -107,28 +107,27 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;floats&quot;,
<a href="#h14-0-3" id="h14-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h14-0-8" id="h14-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h14-0-12" id="h14-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h14-0-14" id="h14-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;f&quot;,
                                     datatype: Float,
<a href="#h14-0-19" id="h14-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h14-0-25" id="h14-0-25" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h14-0-27" id="h14-0-27" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h14-1" id="h14-1" class="h">@@ -267,28 +266,27 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;floats&quot;,
<a href="#h14-1-3" id="h14-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h14-1-8" id="h14-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h14-1-12" id="h14-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h14-1-14" id="h14-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;f&quot;,
                                 datatype: Float,
<a href="#h14-1-19" id="h14-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h14-1-25" id="h14-1-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h14-1-27" id="h14-1-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a> b/<a href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -93,28 +93,27 @@ Plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;floats&quot;,
<a href="#h15-0-3" id="h15-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h15-0-8" id="h15-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h15-0-12" id="h15-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h15-0-14" id="h15-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;f&quot;,
                                 datatype: Float,
<a href="#h15-0-19" id="h15-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h15-0-25" id="h15-0-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h15-0-27" id="h15-0-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h15-1" id="h15-1" class="h">@@ -239,28 +238,27 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;floats&quot;,
<a href="#h15-1-3" id="h15-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h15-1-8" id="h15-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h15-1-12" id="h15-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h15-1-14" id="h15-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;f&quot;,
                                 datatype: Float,
<a href="#h15-1-19" id="h15-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h15-1-25" id="h15-1-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h15-1-27" id="h15-1-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a> b/<a href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -107,28 +107,27 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;integers&quot;,
<a href="#h16-0-3" id="h16-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h16-0-8" id="h16-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h16-0-12" id="h16-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h16-0-14" id="h16-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;i&quot;,
                                     datatype: Integer,
<a href="#h16-0-19" id="h16-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h16-0-25" id="h16-0-25" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h16-0-27" id="h16-0-27" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h16-1" id="h16-1" class="h">@@ -267,28 +266,27 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;integers&quot;,
<a href="#h16-1-3" id="h16-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h16-1-8" id="h16-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h16-1-12" id="h16-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h16-1-14" id="h16-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;i&quot;,
                                 datatype: Integer,
<a href="#h16-1-19" id="h16-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h16-1-25" id="h16-1-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h16-1-27" id="h16-1-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a> b/<a href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -93,28 +93,27 @@ Plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;integers&quot;,
<a href="#h17-0-3" id="h17-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h17-0-8" id="h17-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h17-0-12" id="h17-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h17-0-14" id="h17-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;i&quot;,
                                 datatype: Integer,
<a href="#h17-0-19" id="h17-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h17-0-25" id="h17-0-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h17-0-27" id="h17-0-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h17-1" id="h17-1" class="h">@@ -239,28 +238,27 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;integers&quot;,
<a href="#h17-1-3" id="h17-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h17-1-8" id="h17-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h17-1-12" id="h17-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h17-1-14" id="h17-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;i&quot;,
                                 datatype: Integer,
<a href="#h17-1-19" id="h17-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h17-1-25" id="h17-1-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h17-1-27" id="h17-1-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -100,84 +100,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h18-0-3" id="h18-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h18-0-8" id="h18-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h18-0-12" id="h18-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h18-0-14" id="h18-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h18-0-19" id="h18-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h18-0-23" id="h18-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h18-0-25" id="h18-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h18-0-30" id="h18-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h18-0-34" id="h18-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h18-0-38" id="h18-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h18-0-43" id="h18-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h18-0-47" id="h18-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h18-0-51" id="h18-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h18-0-56" id="h18-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h18-0-60" id="h18-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h18-0-62" id="h18-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h18-0-67" id="h18-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h18-0-73" id="h18-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h18-0-75" id="h18-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h18-0-80" id="h18-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h18-0-86" id="h18-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h18-0-88" id="h18-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h18-1" id="h18-1" class="h">@@ -308,84 +302,78 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h18-1-3" id="h18-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h18-1-8" id="h18-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h18-1-12" id="h18-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h18-1-14" id="h18-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h18-1-19" id="h18-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h18-1-23" id="h18-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h18-1-25" id="h18-1-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h18-1-30" id="h18-1-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h18-1-34" id="h18-1-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h18-1-38" id="h18-1-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h18-1-43" id="h18-1-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h18-1-47" id="h18-1-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h18-1-51" id="h18-1-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h18-1-56" id="h18-1-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h18-1-60" id="h18-1-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h18-1-62" id="h18-1-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h18-1-67" id="h18-1-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h18-1-73" id="h18-1-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h18-1-75" id="h18-1-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h18-1-80" id="h18-1-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h18-1-86" id="h18-1-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h18-1-88" id="h18-1-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -104,84 +104,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h19-0-3" id="h19-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h19-0-8" id="h19-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h19-0-12" id="h19-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h19-0-14" id="h19-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h19-0-19" id="h19-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h19-0-23" id="h19-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h19-0-25" id="h19-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h19-0-30" id="h19-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h19-0-34" id="h19-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h19-0-38" id="h19-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h19-0-43" id="h19-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h19-0-47" id="h19-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h19-0-51" id="h19-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h19-0-56" id="h19-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h19-0-60" id="h19-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h19-0-62" id="h19-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h19-0-67" id="h19-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h19-0-73" id="h19-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h19-0-75" id="h19-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h19-0-80" id="h19-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h19-0-86" id="h19-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h19-0-88" id="h19-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h19-1" id="h19-1" class="h">@@ -324,84 +318,78 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h19-1-3" id="h19-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h19-1-8" id="h19-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h19-1-12" id="h19-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h19-1-14" id="h19-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h19-1-19" id="h19-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h19-1-23" id="h19-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h19-1-25" id="h19-1-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h19-1-30" id="h19-1-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h19-1-34" id="h19-1-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h19-1-38" id="h19-1-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h19-1-43" id="h19-1-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h19-1-47" id="h19-1-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h19-1-51" id="h19-1-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h19-1-56" id="h19-1-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h19-1-60" id="h19-1-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h19-1-62" id="h19-1-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h19-1-67" id="h19-1-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h19-1-73" id="h19-1-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h19-1-75" id="h19-1-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h19-1-80" id="h19-1-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h19-1-86" id="h19-1-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h19-1-88" id="h19-1-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a> b/<a href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -107,28 +107,27 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;strings&quot;,
<a href="#h20-0-3" id="h20-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h20-0-8" id="h20-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h20-0-12" id="h20-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h20-0-14" id="h20-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;s&quot;,
                                     datatype: String,
<a href="#h20-0-19" id="h20-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h20-0-25" id="h20-0-25" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h20-0-27" id="h20-0-27" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h20-1" id="h20-1" class="h">@@ -267,28 +266,27 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;strings&quot;,
<a href="#h20-1-3" id="h20-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h20-1-8" id="h20-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h20-1-12" id="h20-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h20-1-14" id="h20-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;s&quot;,
                                 datatype: String,
<a href="#h20-1-19" id="h20-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h20-1-25" id="h20-1-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h20-1-27" id="h20-1-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a> b/<a href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -93,28 +93,27 @@ Plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;strings&quot;,
<a href="#h21-0-3" id="h21-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h21-0-8" id="h21-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h21-0-12" id="h21-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h21-0-14" id="h21-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;s&quot;,
                                 datatype: String,
<a href="#h21-0-19" id="h21-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h21-0-25" id="h21-0-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h21-0-27" id="h21-0-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h21-1" id="h21-1" class="h">@@ -239,28 +238,27 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;strings&quot;,
<a href="#h21-1-3" id="h21-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h21-1-8" id="h21-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h21-1-12" id="h21-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h21-1-14" id="h21-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;s&quot;,
                                 datatype: String,
<a href="#h21-1-19" id="h21-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h21-1-25" id="h21-1-25" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h21-1-27" id="h21-1-27" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h22" href="../file/tests/sql/query/all.html">tests/sql/query/all</a> b/<a href="../file/tests/sql/query/all.html">tests/sql/query/all</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -35,84 +35,78 @@ Plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h22-0-3" id="h22-0-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h22-0-8" id="h22-0-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h22-0-12" id="h22-0-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-0-14" id="h22-0-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h22-0-19" id="h22-0-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h22-0-23" id="h22-0-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-0-25" id="h22-0-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h22-0-30" id="h22-0-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h22-0-34" id="h22-0-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h22-0-38" id="h22-0-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h22-0-43" id="h22-0-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h22-0-47" id="h22-0-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h22-0-51" id="h22-0-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h22-0-56" id="h22-0-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h22-0-60" id="h22-0-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-0-62" id="h22-0-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h22-0-67" id="h22-0-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h22-0-73" id="h22-0-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-0-75" id="h22-0-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h22-0-80" id="h22-0-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h22-0-86" id="h22-0-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-0-88" id="h22-0-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<a href="#h22-1" id="h22-1" class="h">@@ -125,84 +119,78 @@ Optimized plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h22-1-3" id="h22-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h22-1-8" id="h22-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h22-1-12" id="h22-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-1-14" id="h22-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h22-1-19" id="h22-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h22-1-23" id="h22-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-1-25" id="h22-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h22-1-30" id="h22-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h22-1-34" id="h22-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h22-1-38" id="h22-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h22-1-43" id="h22-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h22-1-47" id="h22-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h22-1-51" id="h22-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h22-1-56" id="h22-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h22-1-60" id="h22-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-1-62" id="h22-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h22-1-67" id="h22-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h22-1-73" id="h22-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-1-75" id="h22-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h22-1-80" id="h22-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h22-1-86" id="h22-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h22-1-88" id="h22-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a> b/<a href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -85,84 +85,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h23-0-3" id="h23-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h23-0-8" id="h23-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h23-0-12" id="h23-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-0-14" id="h23-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h23-0-19" id="h23-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h23-0-23" id="h23-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-0-25" id="h23-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h23-0-30" id="h23-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h23-0-34" id="h23-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h23-0-38" id="h23-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h23-0-43" id="h23-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h23-0-47" id="h23-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h23-0-51" id="h23-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h23-0-56" id="h23-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h23-0-60" id="h23-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-0-62" id="h23-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h23-0-67" id="h23-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h23-0-73" id="h23-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-0-75" id="h23-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h23-0-80" id="h23-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h23-0-86" id="h23-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-0-88" id="h23-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h23-1" id="h23-1" class="h">@@ -231,84 +225,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h23-1-3" id="h23-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h23-1-8" id="h23-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h23-1-12" id="h23-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-1-14" id="h23-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h23-1-19" id="h23-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h23-1-23" id="h23-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-1-25" id="h23-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h23-1-30" id="h23-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h23-1-34" id="h23-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h23-1-38" id="h23-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h23-1-43" id="h23-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h23-1-47" id="h23-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h23-1-51" id="h23-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h23-1-56" id="h23-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h23-1-60" id="h23-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-1-62" id="h23-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h23-1-67" id="h23-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h23-1-73" id="h23-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-1-75" id="h23-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h23-1-80" id="h23-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h23-1-86" id="h23-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h23-1-88" id="h23-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a> b/<a href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -82,84 +82,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h24-0-3" id="h24-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h24-0-8" id="h24-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h24-0-12" id="h24-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-0-14" id="h24-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h24-0-19" id="h24-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h24-0-23" id="h24-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-0-25" id="h24-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h24-0-30" id="h24-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h24-0-34" id="h24-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h24-0-38" id="h24-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h24-0-43" id="h24-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h24-0-47" id="h24-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h24-0-51" id="h24-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h24-0-56" id="h24-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h24-0-60" id="h24-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-0-62" id="h24-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h24-0-67" id="h24-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h24-0-73" id="h24-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-0-75" id="h24-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h24-0-80" id="h24-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h24-0-86" id="h24-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-0-88" id="h24-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h24-1" id="h24-1" class="h">@@ -219,84 +213,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h24-1-3" id="h24-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h24-1-8" id="h24-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h24-1-12" id="h24-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-1-14" id="h24-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h24-1-19" id="h24-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h24-1-23" id="h24-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-1-25" id="h24-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h24-1-30" id="h24-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h24-1-34" id="h24-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h24-1-38" id="h24-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h24-1-43" id="h24-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h24-1-47" id="h24-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h24-1-51" id="h24-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h24-1-56" id="h24-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h24-1-60" id="h24-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-1-62" id="h24-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h24-1-67" id="h24-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h24-1-73" id="h24-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-1-75" id="h24-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h24-1-80" id="h24-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h24-1-86" id="h24-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h24-1-88" id="h24-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a> b/<a href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -87,84 +87,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h25-0-3" id="h25-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h25-0-8" id="h25-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h25-0-12" id="h25-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-0-14" id="h25-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h25-0-19" id="h25-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-0-23" id="h25-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-0-25" id="h25-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h25-0-30" id="h25-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-0-34" id="h25-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h25-0-38" id="h25-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h25-0-43" id="h25-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-0-47" id="h25-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h25-0-51" id="h25-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h25-0-56" id="h25-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-0-60" id="h25-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-0-62" id="h25-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h25-0-67" id="h25-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h25-0-73" id="h25-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-0-75" id="h25-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h25-0-80" id="h25-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h25-0-86" id="h25-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-0-88" id="h25-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h25-1" id="h25-1" class="h">@@ -177,26 +171,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h25-1-3" id="h25-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h25-1-8" id="h25-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h25-1-12" id="h25-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-1-14" id="h25-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h25-1-19" id="h25-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-1-23" id="h25-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-1-25" id="h25-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h25-2" id="h25-2" class="h">@@ -247,84 +240,78 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h25-2-3" id="h25-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h25-2-8" id="h25-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h25-2-12" id="h25-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-2-14" id="h25-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h25-2-19" id="h25-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-2-23" id="h25-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-2-25" id="h25-2-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h25-2-30" id="h25-2-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-2-34" id="h25-2-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h25-2-38" id="h25-2-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h25-2-43" id="h25-2-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-2-47" id="h25-2-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h25-2-51" id="h25-2-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h25-2-56" id="h25-2-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-2-60" id="h25-2-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-2-62" id="h25-2-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h25-2-67" id="h25-2-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h25-2-73" id="h25-2-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-2-75" id="h25-2-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h25-2-80" id="h25-2-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h25-2-86" id="h25-2-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-2-88" id="h25-2-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h25-3" id="h25-3" class="h">@@ -337,26 +324,25 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h25-3-3" id="h25-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h25-3-8" id="h25-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h25-3-12" id="h25-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-3-14" id="h25-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h25-3-19" id="h25-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h25-3-23" id="h25-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h25-3-25" id="h25-3-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a> b/<a href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -52,84 +52,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h26-0-3" id="h26-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h26-0-8" id="h26-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h26-0-12" id="h26-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-0-14" id="h26-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h26-0-19" id="h26-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h26-0-23" id="h26-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-0-25" id="h26-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h26-0-30" id="h26-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h26-0-34" id="h26-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h26-0-38" id="h26-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h26-0-43" id="h26-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h26-0-47" id="h26-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h26-0-51" id="h26-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h26-0-56" id="h26-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h26-0-60" id="h26-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-0-62" id="h26-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h26-0-67" id="h26-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h26-0-73" id="h26-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-0-75" id="h26-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h26-0-80" id="h26-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h26-0-86" id="h26-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-0-88" id="h26-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h26-1" id="h26-1" class="h">@@ -170,84 +164,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h26-1-3" id="h26-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h26-1-8" id="h26-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h26-1-12" id="h26-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-1-14" id="h26-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h26-1-19" id="h26-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h26-1-23" id="h26-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-1-25" id="h26-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h26-1-30" id="h26-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h26-1-34" id="h26-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h26-1-38" id="h26-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h26-1-43" id="h26-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h26-1-47" id="h26-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h26-1-51" id="h26-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h26-1-56" id="h26-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h26-1-60" id="h26-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-1-62" id="h26-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h26-1-67" id="h26-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h26-1-73" id="h26-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-1-75" id="h26-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h26-1-80" id="h26-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h26-1-86" id="h26-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h26-1-88" id="h26-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a> b/<a href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -47,84 +47,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h27-0-3" id="h27-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h27-0-8" id="h27-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h27-0-12" id="h27-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-0-14" id="h27-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h27-0-19" id="h27-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h27-0-23" id="h27-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-0-25" id="h27-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h27-0-30" id="h27-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h27-0-34" id="h27-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h27-0-38" id="h27-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h27-0-43" id="h27-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h27-0-47" id="h27-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h27-0-51" id="h27-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h27-0-56" id="h27-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h27-0-60" id="h27-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-0-62" id="h27-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h27-0-67" id="h27-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h27-0-73" id="h27-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-0-75" id="h27-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h27-0-80" id="h27-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h27-0-86" id="h27-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-0-88" id="h27-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h27-1" id="h27-1" class="h">@@ -155,84 +149,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h27-1-3" id="h27-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h27-1-8" id="h27-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h27-1-12" id="h27-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-1-14" id="h27-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h27-1-19" id="h27-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h27-1-23" id="h27-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-1-25" id="h27-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h27-1-30" id="h27-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h27-1-34" id="h27-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h27-1-38" id="h27-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h27-1-43" id="h27-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h27-1-47" id="h27-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h27-1-51" id="h27-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h27-1-56" id="h27-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h27-1-60" id="h27-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-1-62" id="h27-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h27-1-67" id="h27-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h27-1-73" id="h27-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-1-75" id="h27-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h27-1-80" id="h27-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h27-1-86" id="h27-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h27-1-88" id="h27-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a> b/<a href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -83,84 +83,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h28-0-3" id="h28-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h28-0-8" id="h28-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h28-0-12" id="h28-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-0-14" id="h28-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h28-0-19" id="h28-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-0-23" id="h28-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-0-25" id="h28-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h28-0-30" id="h28-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-0-34" id="h28-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h28-0-38" id="h28-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h28-0-43" id="h28-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-0-47" id="h28-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h28-0-51" id="h28-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h28-0-56" id="h28-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-0-60" id="h28-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-0-62" id="h28-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h28-0-67" id="h28-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h28-0-73" id="h28-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-0-75" id="h28-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h28-0-80" id="h28-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h28-0-86" id="h28-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-0-88" id="h28-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h28-1" id="h28-1" class="h">@@ -171,26 +165,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h28-1-3" id="h28-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h28-1-8" id="h28-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h28-1-12" id="h28-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-1-14" id="h28-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h28-1-19" id="h28-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-1-23" id="h28-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-1-25" id="h28-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h28-2" id="h28-2" class="h">@@ -239,84 +232,78 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h28-2-3" id="h28-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h28-2-8" id="h28-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h28-2-12" id="h28-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-2-14" id="h28-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h28-2-19" id="h28-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-2-23" id="h28-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-2-25" id="h28-2-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h28-2-30" id="h28-2-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-2-34" id="h28-2-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h28-2-38" id="h28-2-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h28-2-43" id="h28-2-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-2-47" id="h28-2-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h28-2-51" id="h28-2-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h28-2-56" id="h28-2-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-2-60" id="h28-2-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-2-62" id="h28-2-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h28-2-67" id="h28-2-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h28-2-73" id="h28-2-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-2-75" id="h28-2-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h28-2-80" id="h28-2-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h28-2-86" id="h28-2-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-2-88" id="h28-2-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h28-3" id="h28-3" class="h">@@ -327,26 +314,25 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h28-3-3" id="h28-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h28-3-8" id="h28-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h28-3-12" id="h28-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-3-14" id="h28-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h28-3-19" id="h28-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h28-3-23" id="h28-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h28-3-25" id="h28-3-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a> b/<a href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -45,84 +45,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h29-0-3" id="h29-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h29-0-8" id="h29-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h29-0-12" id="h29-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-0-14" id="h29-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h29-0-19" id="h29-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h29-0-23" id="h29-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-0-25" id="h29-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h29-0-30" id="h29-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h29-0-34" id="h29-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h29-0-38" id="h29-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h29-0-43" id="h29-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h29-0-47" id="h29-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h29-0-51" id="h29-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h29-0-56" id="h29-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h29-0-60" id="h29-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-0-62" id="h29-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h29-0-67" id="h29-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h29-0-73" id="h29-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-0-75" id="h29-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h29-0-80" id="h29-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h29-0-86" id="h29-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-0-88" id="h29-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h29-1" id="h29-1" class="h">@@ -151,84 +145,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h29-1-3" id="h29-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h29-1-8" id="h29-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h29-1-12" id="h29-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-1-14" id="h29-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h29-1-19" id="h29-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h29-1-23" id="h29-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-1-25" id="h29-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h29-1-30" id="h29-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h29-1-34" id="h29-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h29-1-38" id="h29-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h29-1-43" id="h29-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h29-1-47" id="h29-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h29-1-51" id="h29-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h29-1-56" id="h29-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h29-1-60" id="h29-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-1-62" id="h29-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h29-1-67" id="h29-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h29-1-73" id="h29-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-1-75" id="h29-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h29-1-80" id="h29-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h29-1-86" id="h29-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h29-1-88" id="h29-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a> b/<a href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -129,84 +129,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h30-0-3" id="h30-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h30-0-8" id="h30-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h30-0-12" id="h30-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-0-14" id="h30-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h30-0-19" id="h30-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-0-23" id="h30-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-0-25" id="h30-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h30-0-30" id="h30-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-0-34" id="h30-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h30-0-38" id="h30-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h30-0-43" id="h30-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-0-47" id="h30-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h30-0-51" id="h30-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h30-0-56" id="h30-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-0-60" id="h30-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-0-62" id="h30-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h30-0-67" id="h30-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h30-0-73" id="h30-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-0-75" id="h30-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h30-0-80" id="h30-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h30-0-86" id="h30-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-0-88" id="h30-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h30-1" id="h30-1" class="h">@@ -217,26 +211,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h30-1-3" id="h30-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h30-1-8" id="h30-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h30-1-12" id="h30-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-1-14" id="h30-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h30-1-19" id="h30-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-1-23" id="h30-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-1-25" id="h30-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h30-2" id="h30-2" class="h">@@ -250,26 +243,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;countries&quot;,
<a href="#h30-2-3" id="h30-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: String,
<a href="#h30-2-8" id="h30-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h30-2-12" id="h30-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h30-2-14" id="h30-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h30-2-19" id="h30-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h30-2-23" id="h30-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h30-2-25" id="h30-2-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h30-3" id="h30-3" class="h">@@ -287,84 +279,78 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h30-3-3" id="h30-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h30-3-8" id="h30-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h30-3-12" id="h30-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-3-14" id="h30-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h30-3-19" id="h30-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-3-23" id="h30-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-3-25" id="h30-3-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h30-3-30" id="h30-3-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-3-34" id="h30-3-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h30-3-38" id="h30-3-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h30-3-43" id="h30-3-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-3-47" id="h30-3-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h30-3-51" id="h30-3-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h30-3-56" id="h30-3-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-3-60" id="h30-3-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-3-62" id="h30-3-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h30-3-67" id="h30-3-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h30-3-73" id="h30-3-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-3-75" id="h30-3-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h30-3-80" id="h30-3-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h30-3-86" id="h30-3-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-3-88" id="h30-3-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h30-4" id="h30-4" class="h">@@ -375,26 +361,25 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h30-4-3" id="h30-4-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h30-4-8" id="h30-4-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h30-4-12" id="h30-4-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-4-14" id="h30-4-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h30-4-19" id="h30-4-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h30-4-23" id="h30-4-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h30-4-25" id="h30-4-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h30-5" id="h30-5" class="h">@@ -408,26 +393,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;countries&quot;,
<a href="#h30-5-3" id="h30-5-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: String,
<a href="#h30-5-8" id="h30-5-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h30-5-12" id="h30-5-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h30-5-14" id="h30-5-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h30-5-19" id="h30-5-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h30-5-23" id="h30-5-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h30-5-25" id="h30-5-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h31" href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a> b/<a href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -74,84 +74,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h31-0-3" id="h31-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h31-0-8" id="h31-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h31-0-12" id="h31-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-0-14" id="h31-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h31-0-19" id="h31-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h31-0-23" id="h31-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-0-25" id="h31-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h31-0-30" id="h31-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h31-0-34" id="h31-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h31-0-38" id="h31-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h31-0-43" id="h31-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h31-0-47" id="h31-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h31-0-51" id="h31-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h31-0-56" id="h31-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h31-0-60" id="h31-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-0-62" id="h31-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h31-0-67" id="h31-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h31-0-73" id="h31-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-0-75" id="h31-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h31-0-80" id="h31-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h31-0-86" id="h31-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-0-88" id="h31-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h31-1" id="h31-1" class="h">@@ -233,84 +227,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h31-1-3" id="h31-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h31-1-8" id="h31-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h31-1-12" id="h31-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-1-14" id="h31-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h31-1-19" id="h31-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h31-1-23" id="h31-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-1-25" id="h31-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h31-1-30" id="h31-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h31-1-34" id="h31-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h31-1-38" id="h31-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h31-1-43" id="h31-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h31-1-47" id="h31-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h31-1-51" id="h31-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h31-1-56" id="h31-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h31-1-60" id="h31-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-1-62" id="h31-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h31-1-67" id="h31-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h31-1-73" id="h31-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-1-75" id="h31-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h31-1-80" id="h31-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h31-1-86" id="h31-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h31-1-88" id="h31-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a> b/<a href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -93,84 +93,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h32-0-3" id="h32-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h32-0-8" id="h32-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h32-0-12" id="h32-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-0-14" id="h32-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h32-0-19" id="h32-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h32-0-23" id="h32-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-0-25" id="h32-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h32-0-30" id="h32-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h32-0-34" id="h32-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h32-0-38" id="h32-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h32-0-43" id="h32-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h32-0-47" id="h32-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h32-0-51" id="h32-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h32-0-56" id="h32-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h32-0-60" id="h32-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-0-62" id="h32-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h32-0-67" id="h32-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h32-0-73" id="h32-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-0-75" id="h32-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h32-0-80" id="h32-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h32-0-86" id="h32-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-0-88" id="h32-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h32-1" id="h32-1" class="h">@@ -281,84 +275,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h32-1-3" id="h32-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h32-1-8" id="h32-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h32-1-12" id="h32-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-1-14" id="h32-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h32-1-19" id="h32-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h32-1-23" id="h32-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-1-25" id="h32-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h32-1-30" id="h32-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h32-1-34" id="h32-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h32-1-38" id="h32-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h32-1-43" id="h32-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h32-1-47" id="h32-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h32-1-51" id="h32-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h32-1-56" id="h32-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h32-1-60" id="h32-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-1-62" id="h32-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h32-1-67" id="h32-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h32-1-73" id="h32-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-1-75" id="h32-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h32-1-80" id="h32-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h32-1-86" id="h32-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h32-1-88" id="h32-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a> b/<a href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -101,84 +101,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h33-0-3" id="h33-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h33-0-8" id="h33-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h33-0-12" id="h33-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-0-14" id="h33-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h33-0-19" id="h33-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h33-0-23" id="h33-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-0-25" id="h33-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h33-0-30" id="h33-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h33-0-34" id="h33-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h33-0-38" id="h33-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h33-0-43" id="h33-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h33-0-47" id="h33-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h33-0-51" id="h33-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h33-0-56" id="h33-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h33-0-60" id="h33-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-0-62" id="h33-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h33-0-67" id="h33-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h33-0-73" id="h33-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-0-75" id="h33-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h33-0-80" id="h33-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h33-0-86" id="h33-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-0-88" id="h33-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h33-1" id="h33-1" class="h">@@ -300,84 +294,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h33-1-3" id="h33-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h33-1-8" id="h33-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h33-1-12" id="h33-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-1-14" id="h33-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h33-1-19" id="h33-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h33-1-23" id="h33-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-1-25" id="h33-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h33-1-30" id="h33-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h33-1-34" id="h33-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h33-1-38" id="h33-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h33-1-43" id="h33-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h33-1-47" id="h33-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h33-1-51" id="h33-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h33-1-56" id="h33-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h33-1-60" id="h33-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-1-62" id="h33-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h33-1-67" id="h33-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h33-1-73" id="h33-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-1-75" id="h33-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h33-1-80" id="h33-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h33-1-86" id="h33-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h33-1-88" id="h33-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h34" href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a> b/<a href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -81,84 +81,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h34-0-3" id="h34-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h34-0-8" id="h34-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h34-0-12" id="h34-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-0-14" id="h34-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h34-0-19" id="h34-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h34-0-23" id="h34-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-0-25" id="h34-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h34-0-30" id="h34-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h34-0-34" id="h34-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h34-0-38" id="h34-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h34-0-43" id="h34-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h34-0-47" id="h34-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h34-0-51" id="h34-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h34-0-56" id="h34-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h34-0-60" id="h34-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-0-62" id="h34-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h34-0-67" id="h34-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h34-0-73" id="h34-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-0-75" id="h34-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h34-0-80" id="h34-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h34-0-86" id="h34-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-0-88" id="h34-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h34-1" id="h34-1" class="h">@@ -254,84 +248,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h34-1-3" id="h34-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h34-1-8" id="h34-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h34-1-12" id="h34-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-1-14" id="h34-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h34-1-19" id="h34-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h34-1-23" id="h34-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-1-25" id="h34-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h34-1-30" id="h34-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h34-1-34" id="h34-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h34-1-38" id="h34-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h34-1-43" id="h34-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h34-1-47" id="h34-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h34-1-51" id="h34-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h34-1-56" id="h34-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h34-1-60" id="h34-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-1-62" id="h34-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h34-1-67" id="h34-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h34-1-73" id="h34-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-1-75" id="h34-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h34-1-80" id="h34-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h34-1-86" id="h34-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h34-1-88" id="h34-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h35" href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a> b/<a href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -90,84 +90,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h35-0-3" id="h35-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h35-0-8" id="h35-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h35-0-12" id="h35-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-0-14" id="h35-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h35-0-19" id="h35-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h35-0-23" id="h35-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-0-25" id="h35-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h35-0-30" id="h35-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h35-0-34" id="h35-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h35-0-38" id="h35-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h35-0-43" id="h35-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h35-0-47" id="h35-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h35-0-51" id="h35-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h35-0-56" id="h35-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h35-0-60" id="h35-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-0-62" id="h35-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h35-0-67" id="h35-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h35-0-73" id="h35-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-0-75" id="h35-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h35-0-80" id="h35-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h35-0-86" id="h35-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-0-88" id="h35-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h35-1" id="h35-1" class="h">@@ -256,84 +250,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h35-1-3" id="h35-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h35-1-8" id="h35-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h35-1-12" id="h35-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-1-14" id="h35-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h35-1-19" id="h35-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h35-1-23" id="h35-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-1-25" id="h35-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h35-1-30" id="h35-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h35-1-34" id="h35-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h35-1-38" id="h35-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h35-1-43" id="h35-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h35-1-47" id="h35-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h35-1-51" id="h35-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h35-1-56" id="h35-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h35-1-60" id="h35-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-1-62" id="h35-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h35-1-67" id="h35-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h35-1-73" id="h35-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-1-75" id="h35-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h35-1-80" id="h35-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h35-1-86" id="h35-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h35-1-88" id="h35-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h36" href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a> b/<a href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -96,84 +96,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h36-0-3" id="h36-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h36-0-8" id="h36-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h36-0-12" id="h36-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-0-14" id="h36-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h36-0-19" id="h36-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h36-0-23" id="h36-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-0-25" id="h36-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h36-0-30" id="h36-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h36-0-34" id="h36-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h36-0-38" id="h36-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h36-0-43" id="h36-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h36-0-47" id="h36-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h36-0-51" id="h36-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h36-0-56" id="h36-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h36-0-60" id="h36-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-0-62" id="h36-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h36-0-67" id="h36-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h36-0-73" id="h36-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-0-75" id="h36-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h36-0-80" id="h36-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h36-0-86" id="h36-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-0-88" id="h36-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h36-1" id="h36-1" class="h">@@ -297,84 +291,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h36-1-3" id="h36-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h36-1-8" id="h36-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h36-1-12" id="h36-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-1-14" id="h36-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h36-1-19" id="h36-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h36-1-23" id="h36-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-1-25" id="h36-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h36-1-30" id="h36-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h36-1-34" id="h36-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h36-1-38" id="h36-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h36-1-43" id="h36-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h36-1-47" id="h36-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h36-1-51" id="h36-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h36-1-56" id="h36-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h36-1-60" id="h36-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-1-62" id="h36-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h36-1-67" id="h36-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h36-1-73" id="h36-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-1-75" id="h36-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h36-1-80" id="h36-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h36-1-86" id="h36-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h36-1-88" id="h36-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h37" href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a> b/<a href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -81,84 +81,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h37-0-3" id="h37-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h37-0-8" id="h37-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h37-0-12" id="h37-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-0-14" id="h37-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h37-0-19" id="h37-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h37-0-23" id="h37-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-0-25" id="h37-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h37-0-30" id="h37-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h37-0-34" id="h37-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h37-0-38" id="h37-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h37-0-43" id="h37-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h37-0-47" id="h37-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h37-0-51" id="h37-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h37-0-56" id="h37-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h37-0-60" id="h37-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-0-62" id="h37-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h37-0-67" id="h37-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h37-0-73" id="h37-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-0-75" id="h37-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h37-0-80" id="h37-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h37-0-86" id="h37-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-0-88" id="h37-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h37-1" id="h37-1" class="h">@@ -252,84 +246,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h37-1-3" id="h37-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h37-1-8" id="h37-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h37-1-12" id="h37-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-1-14" id="h37-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h37-1-19" id="h37-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h37-1-23" id="h37-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-1-25" id="h37-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h37-1-30" id="h37-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h37-1-34" id="h37-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h37-1-38" id="h37-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h37-1-43" id="h37-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h37-1-47" id="h37-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h37-1-51" id="h37-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h37-1-56" id="h37-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h37-1-60" id="h37-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-1-62" id="h37-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h37-1-67" id="h37-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h37-1-73" id="h37-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-1-75" id="h37-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h37-1-80" id="h37-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h37-1-86" id="h37-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h37-1-88" id="h37-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h38" href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a> b/<a href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -109,84 +109,78 @@ Plan: Select(
</a>                         left: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h38-0-3" id="h38-0-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h38-0-8" id="h38-0-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h38-0-12" id="h38-0-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-0-14" id="h38-0-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h38-0-19" id="h38-0-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-0-23" id="h38-0-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-0-25" id="h38-0-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h38-0-30" id="h38-0-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-0-34" id="h38-0-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h38-0-38" id="h38-0-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h38-0-43" id="h38-0-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-0-47" id="h38-0-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h38-0-51" id="h38-0-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h38-0-56" id="h38-0-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-0-60" id="h38-0-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-0-62" id="h38-0-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h38-0-67" id="h38-0-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h38-0-73" id="h38-0-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-0-75" id="h38-0-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h38-0-80" id="h38-0-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h38-0-86" id="h38-0-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-0-88" id="h38-0-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h38-1" id="h38-1" class="h">@@ -199,40 +193,38 @@ Plan: Select(
</a>                         right: Scan {
                             table: Table {
                                 name: &quot;studios&quot;,
<a href="#h38-1-3" id="h38-1-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h38-1-8" id="h38-1-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h38-1-12" id="h38-1-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-1-14" id="h38-1-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;name&quot;,
                                         datatype: String,
<a href="#h38-1-19" id="h38-1-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-1-23" id="h38-1-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-1-25" id="h38-1-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;country_id&quot;,
                                         datatype: String,
<a href="#h38-1-30" id="h38-1-30" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h38-1-36" id="h38-1-36" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;countries&quot;,
                                         ),
<a href="#h38-1-40" id="h38-1-40" class="d">-                                        index: true,
</a>                                     },
                                 ],
                             },
<a href="#h38-2" id="h38-2" class="h">@@ -350,84 +342,78 @@ Optimized plan: Select(
</a>                         left: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h38-2-3" id="h38-2-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h38-2-8" id="h38-2-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h38-2-12" id="h38-2-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-2-14" id="h38-2-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h38-2-19" id="h38-2-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-2-23" id="h38-2-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-2-25" id="h38-2-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h38-2-30" id="h38-2-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-2-34" id="h38-2-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h38-2-38" id="h38-2-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h38-2-43" id="h38-2-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-2-47" id="h38-2-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h38-2-51" id="h38-2-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h38-2-56" id="h38-2-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-2-60" id="h38-2-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-2-62" id="h38-2-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h38-2-67" id="h38-2-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h38-2-73" id="h38-2-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-2-75" id="h38-2-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h38-2-80" id="h38-2-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h38-2-86" id="h38-2-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-2-88" id="h38-2-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h38-3" id="h38-3" class="h">@@ -450,40 +436,38 @@ Optimized plan: Select(
</a>                         right: Scan {
                             table: Table {
                                 name: &quot;studios&quot;,
<a href="#h38-3-3" id="h38-3-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h38-3-8" id="h38-3-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h38-3-12" id="h38-3-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-3-14" id="h38-3-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;name&quot;,
                                         datatype: String,
<a href="#h38-3-19" id="h38-3-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h38-3-23" id="h38-3-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h38-3-25" id="h38-3-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;country_id&quot;,
                                         datatype: String,
<a href="#h38-3-30" id="h38-3-30" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h38-3-36" id="h38-3-36" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;countries&quot;,
                                         ),
<a href="#h38-3-40" id="h38-3-40" class="d">-                                        index: true,
</a>                                     },
                                 ],
                             },
<b>diff --git a/<a id="h39" href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a> b/<a href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -64,84 +64,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h39-0-3" id="h39-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h39-0-8" id="h39-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h39-0-12" id="h39-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-0-14" id="h39-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h39-0-19" id="h39-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h39-0-23" id="h39-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-0-25" id="h39-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h39-0-30" id="h39-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h39-0-34" id="h39-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h39-0-38" id="h39-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h39-0-43" id="h39-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h39-0-47" id="h39-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h39-0-51" id="h39-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h39-0-56" id="h39-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h39-0-60" id="h39-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-0-62" id="h39-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h39-0-67" id="h39-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h39-0-73" id="h39-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-0-75" id="h39-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h39-0-80" id="h39-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h39-0-86" id="h39-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-0-88" id="h39-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h39-1" id="h39-1" class="h">@@ -209,84 +203,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h39-1-3" id="h39-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h39-1-8" id="h39-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h39-1-12" id="h39-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-1-14" id="h39-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h39-1-19" id="h39-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h39-1-23" id="h39-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-1-25" id="h39-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h39-1-30" id="h39-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h39-1-34" id="h39-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h39-1-38" id="h39-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h39-1-43" id="h39-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h39-1-47" id="h39-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h39-1-51" id="h39-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h39-1-56" id="h39-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h39-1-60" id="h39-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-1-62" id="h39-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h39-1-67" id="h39-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h39-1-73" id="h39-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-1-75" id="h39-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h39-1-80" id="h39-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h39-1-86" id="h39-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h39-1-88" id="h39-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h40" href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a> b/<a href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -65,84 +65,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h40-0-3" id="h40-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h40-0-8" id="h40-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h40-0-12" id="h40-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-0-14" id="h40-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h40-0-19" id="h40-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h40-0-23" id="h40-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-0-25" id="h40-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h40-0-30" id="h40-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h40-0-34" id="h40-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h40-0-38" id="h40-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h40-0-43" id="h40-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h40-0-47" id="h40-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h40-0-51" id="h40-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h40-0-56" id="h40-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h40-0-60" id="h40-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-0-62" id="h40-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h40-0-67" id="h40-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h40-0-73" id="h40-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-0-75" id="h40-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h40-0-80" id="h40-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h40-0-86" id="h40-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-0-88" id="h40-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h40-1" id="h40-1" class="h">@@ -217,84 +211,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h40-1-3" id="h40-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h40-1-8" id="h40-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h40-1-12" id="h40-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-1-14" id="h40-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h40-1-19" id="h40-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h40-1-23" id="h40-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-1-25" id="h40-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h40-1-30" id="h40-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h40-1-34" id="h40-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h40-1-38" id="h40-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h40-1-43" id="h40-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h40-1-47" id="h40-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h40-1-51" id="h40-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h40-1-56" id="h40-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h40-1-60" id="h40-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-1-62" id="h40-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h40-1-67" id="h40-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h40-1-73" id="h40-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-1-75" id="h40-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h40-1-80" id="h40-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h40-1-86" id="h40-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h40-1-88" id="h40-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h41" href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a> b/<a href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -70,84 +70,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h41-0-3" id="h41-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h41-0-8" id="h41-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h41-0-12" id="h41-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-0-14" id="h41-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h41-0-19" id="h41-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h41-0-23" id="h41-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-0-25" id="h41-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h41-0-30" id="h41-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h41-0-34" id="h41-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h41-0-38" id="h41-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h41-0-43" id="h41-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h41-0-47" id="h41-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h41-0-51" id="h41-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h41-0-56" id="h41-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h41-0-60" id="h41-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-0-62" id="h41-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h41-0-67" id="h41-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h41-0-73" id="h41-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-0-75" id="h41-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h41-0-80" id="h41-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h41-0-86" id="h41-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-0-88" id="h41-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h41-1" id="h41-1" class="h">@@ -236,84 +230,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h41-1-3" id="h41-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h41-1-8" id="h41-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h41-1-12" id="h41-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-1-14" id="h41-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h41-1-19" id="h41-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h41-1-23" id="h41-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-1-25" id="h41-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h41-1-30" id="h41-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h41-1-34" id="h41-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h41-1-38" id="h41-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h41-1-43" id="h41-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h41-1-47" id="h41-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h41-1-51" id="h41-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h41-1-56" id="h41-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h41-1-60" id="h41-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-1-62" id="h41-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h41-1-67" id="h41-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h41-1-73" id="h41-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-1-75" id="h41-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h41-1-80" id="h41-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h41-1-86" id="h41-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h41-1-88" id="h41-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h42" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -86,84 +86,78 @@ Plan: Select(
</a>                         source: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h42-0-3" id="h42-0-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h42-0-8" id="h42-0-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h42-0-12" id="h42-0-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-0-14" id="h42-0-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h42-0-19" id="h42-0-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h42-0-23" id="h42-0-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-0-25" id="h42-0-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h42-0-30" id="h42-0-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h42-0-34" id="h42-0-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h42-0-38" id="h42-0-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h42-0-43" id="h42-0-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h42-0-47" id="h42-0-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h42-0-51" id="h42-0-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h42-0-56" id="h42-0-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h42-0-60" id="h42-0-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-0-62" id="h42-0-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h42-0-67" id="h42-0-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h42-0-73" id="h42-0-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-0-75" id="h42-0-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h42-0-80" id="h42-0-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h42-0-86" id="h42-0-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-0-88" id="h42-0-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h42-1" id="h42-1" class="h">@@ -272,84 +266,78 @@ Optimized plan: Select(
</a>                         source: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h42-1-3" id="h42-1-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h42-1-8" id="h42-1-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h42-1-12" id="h42-1-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-1-14" id="h42-1-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h42-1-19" id="h42-1-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h42-1-23" id="h42-1-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-1-25" id="h42-1-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h42-1-30" id="h42-1-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h42-1-34" id="h42-1-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h42-1-38" id="h42-1-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h42-1-43" id="h42-1-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h42-1-47" id="h42-1-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h42-1-51" id="h42-1-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h42-1-56" id="h42-1-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h42-1-60" id="h42-1-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-1-62" id="h42-1-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h42-1-67" id="h42-1-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h42-1-73" id="h42-1-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-1-75" id="h42-1-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h42-1-80" id="h42-1-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h42-1-86" id="h42-1-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h42-1-88" id="h42-1-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<b>diff --git a/<a id="h43" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -92,84 +92,78 @@ Plan: Select(
</a>                             source: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h43-0-3" id="h43-0-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h43-0-8" id="h43-0-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h43-0-12" id="h43-0-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-0-14" id="h43-0-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h43-0-19" id="h43-0-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h43-0-23" id="h43-0-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-0-25" id="h43-0-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h43-0-30" id="h43-0-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h43-0-34" id="h43-0-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h43-0-38" id="h43-0-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h43-0-43" id="h43-0-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h43-0-47" id="h43-0-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h43-0-51" id="h43-0-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h43-0-56" id="h43-0-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h43-0-60" id="h43-0-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-0-62" id="h43-0-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h43-0-67" id="h43-0-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h43-0-73" id="h43-0-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-0-75" id="h43-0-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h43-0-80" id="h43-0-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h43-0-86" id="h43-0-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-0-88" id="h43-0-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<a href="#h43-1" id="h43-1" class="h">@@ -309,84 +303,78 @@ Optimized plan: Select(
</a>                             source: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h43-1-3" id="h43-1-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h43-1-8" id="h43-1-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h43-1-12" id="h43-1-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-1-14" id="h43-1-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h43-1-19" id="h43-1-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h43-1-23" id="h43-1-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-1-25" id="h43-1-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h43-1-30" id="h43-1-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h43-1-34" id="h43-1-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h43-1-38" id="h43-1-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h43-1-43" id="h43-1-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h43-1-47" id="h43-1-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h43-1-51" id="h43-1-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h43-1-56" id="h43-1-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h43-1-60" id="h43-1-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-1-62" id="h43-1-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h43-1-67" id="h43-1-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h43-1-73" id="h43-1-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-1-75" id="h43-1-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h43-1-80" id="h43-1-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h43-1-86" id="h43-1-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h43-1-88" id="h43-1-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<b>diff --git a/<a id="h44" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -105,84 +105,78 @@ Plan: Select(
</a>                             source: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h44-0-3" id="h44-0-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h44-0-8" id="h44-0-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h44-0-12" id="h44-0-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-0-14" id="h44-0-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h44-0-19" id="h44-0-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h44-0-23" id="h44-0-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-0-25" id="h44-0-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h44-0-30" id="h44-0-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h44-0-34" id="h44-0-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h44-0-38" id="h44-0-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h44-0-43" id="h44-0-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h44-0-47" id="h44-0-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h44-0-51" id="h44-0-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h44-0-56" id="h44-0-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h44-0-60" id="h44-0-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-0-62" id="h44-0-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h44-0-67" id="h44-0-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h44-0-73" id="h44-0-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-0-75" id="h44-0-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h44-0-80" id="h44-0-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h44-0-86" id="h44-0-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-0-88" id="h44-0-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<a href="#h44-1" id="h44-1" class="h">@@ -348,84 +342,78 @@ Optimized plan: Select(
</a>                             source: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h44-1-3" id="h44-1-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h44-1-8" id="h44-1-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h44-1-12" id="h44-1-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-1-14" id="h44-1-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h44-1-19" id="h44-1-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h44-1-23" id="h44-1-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-1-25" id="h44-1-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h44-1-30" id="h44-1-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h44-1-34" id="h44-1-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h44-1-38" id="h44-1-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h44-1-43" id="h44-1-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h44-1-47" id="h44-1-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h44-1-51" id="h44-1-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h44-1-56" id="h44-1-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h44-1-60" id="h44-1-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-1-62" id="h44-1-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h44-1-67" id="h44-1-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h44-1-73" id="h44-1-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-1-75" id="h44-1-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h44-1-80" id="h44-1-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h44-1-86" id="h44-1-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h44-1-88" id="h44-1-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<b>diff --git a/<a id="h45" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -88,84 +88,78 @@ Plan: Select(
</a>                             source: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h45-0-3" id="h45-0-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h45-0-8" id="h45-0-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h45-0-12" id="h45-0-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-0-14" id="h45-0-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h45-0-19" id="h45-0-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h45-0-23" id="h45-0-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-0-25" id="h45-0-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h45-0-30" id="h45-0-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h45-0-34" id="h45-0-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h45-0-38" id="h45-0-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h45-0-43" id="h45-0-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h45-0-47" id="h45-0-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h45-0-51" id="h45-0-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h45-0-56" id="h45-0-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h45-0-60" id="h45-0-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-0-62" id="h45-0-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h45-0-67" id="h45-0-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h45-0-73" id="h45-0-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-0-75" id="h45-0-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h45-0-80" id="h45-0-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h45-0-86" id="h45-0-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-0-88" id="h45-0-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<a href="#h45-1" id="h45-1" class="h">@@ -326,84 +320,78 @@ Optimized plan: Select(
</a>                             source: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h45-1-3" id="h45-1-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h45-1-8" id="h45-1-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h45-1-12" id="h45-1-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-1-14" id="h45-1-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h45-1-19" id="h45-1-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h45-1-23" id="h45-1-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-1-25" id="h45-1-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h45-1-30" id="h45-1-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h45-1-34" id="h45-1-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h45-1-38" id="h45-1-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h45-1-43" id="h45-1-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h45-1-47" id="h45-1-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h45-1-51" id="h45-1-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h45-1-56" id="h45-1-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h45-1-60" id="h45-1-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-1-62" id="h45-1-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h45-1-67" id="h45-1-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h45-1-73" id="h45-1-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-1-75" id="h45-1-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h45-1-80" id="h45-1-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h45-1-86" id="h45-1-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h45-1-88" id="h45-1-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<b>diff --git a/<a id="h46" href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a> b/<a href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -74,84 +74,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h46-0-3" id="h46-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h46-0-8" id="h46-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h46-0-12" id="h46-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-0-14" id="h46-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h46-0-19" id="h46-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h46-0-23" id="h46-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-0-25" id="h46-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h46-0-30" id="h46-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h46-0-34" id="h46-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h46-0-38" id="h46-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h46-0-43" id="h46-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h46-0-47" id="h46-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h46-0-51" id="h46-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h46-0-56" id="h46-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h46-0-60" id="h46-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-0-62" id="h46-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h46-0-67" id="h46-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h46-0-73" id="h46-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-0-75" id="h46-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h46-0-80" id="h46-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h46-0-86" id="h46-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-0-88" id="h46-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h46-1" id="h46-1" class="h">@@ -260,84 +254,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h46-1-3" id="h46-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h46-1-8" id="h46-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h46-1-12" id="h46-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-1-14" id="h46-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h46-1-19" id="h46-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h46-1-23" id="h46-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-1-25" id="h46-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h46-1-30" id="h46-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h46-1-34" id="h46-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h46-1-38" id="h46-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h46-1-43" id="h46-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h46-1-47" id="h46-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h46-1-51" id="h46-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h46-1-56" id="h46-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h46-1-60" id="h46-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-1-62" id="h46-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h46-1-67" id="h46-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h46-1-73" id="h46-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-1-75" id="h46-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h46-1-80" id="h46-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h46-1-86" id="h46-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h46-1-88" id="h46-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h47" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -79,84 +79,78 @@ Plan: Select(
</a>                             source: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h47-0-3" id="h47-0-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h47-0-8" id="h47-0-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h47-0-12" id="h47-0-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-0-14" id="h47-0-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h47-0-19" id="h47-0-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h47-0-23" id="h47-0-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-0-25" id="h47-0-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h47-0-30" id="h47-0-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h47-0-34" id="h47-0-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h47-0-38" id="h47-0-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h47-0-43" id="h47-0-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h47-0-47" id="h47-0-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h47-0-51" id="h47-0-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h47-0-56" id="h47-0-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h47-0-60" id="h47-0-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-0-62" id="h47-0-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h47-0-67" id="h47-0-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h47-0-73" id="h47-0-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-0-75" id="h47-0-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h47-0-80" id="h47-0-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h47-0-86" id="h47-0-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-0-88" id="h47-0-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<a href="#h47-1" id="h47-1" class="h">@@ -269,84 +263,78 @@ Optimized plan: Select(
</a>                             source: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h47-1-3" id="h47-1-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h47-1-8" id="h47-1-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h47-1-12" id="h47-1-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-1-14" id="h47-1-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h47-1-19" id="h47-1-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h47-1-23" id="h47-1-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-1-25" id="h47-1-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h47-1-30" id="h47-1-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h47-1-34" id="h47-1-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h47-1-38" id="h47-1-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h47-1-43" id="h47-1-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h47-1-47" id="h47-1-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h47-1-51" id="h47-1-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h47-1-56" id="h47-1-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h47-1-60" id="h47-1-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-1-62" id="h47-1-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h47-1-67" id="h47-1-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h47-1-73" id="h47-1-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-1-75" id="h47-1-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h47-1-80" id="h47-1-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h47-1-86" id="h47-1-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h47-1-88" id="h47-1-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<b>diff --git a/<a id="h48" href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a> b/<a href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -66,84 +66,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h48-0-3" id="h48-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h48-0-8" id="h48-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h48-0-12" id="h48-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-0-14" id="h48-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h48-0-19" id="h48-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-0-23" id="h48-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-0-25" id="h48-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h48-0-30" id="h48-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-0-34" id="h48-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h48-0-38" id="h48-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h48-0-43" id="h48-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-0-47" id="h48-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h48-0-51" id="h48-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h48-0-56" id="h48-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-0-60" id="h48-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-0-62" id="h48-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h48-0-67" id="h48-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h48-0-73" id="h48-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-0-75" id="h48-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h48-0-80" id="h48-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h48-0-86" id="h48-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-0-88" id="h48-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h48-1" id="h48-1" class="h">@@ -154,26 +148,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h48-1-3" id="h48-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h48-1-8" id="h48-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h48-1-12" id="h48-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-1-14" id="h48-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h48-1-19" id="h48-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-1-23" id="h48-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-1-25" id="h48-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h48-2" id="h48-2" class="h">@@ -190,84 +183,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h48-2-3" id="h48-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h48-2-8" id="h48-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h48-2-12" id="h48-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-2-14" id="h48-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h48-2-19" id="h48-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-2-23" id="h48-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-2-25" id="h48-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h48-2-30" id="h48-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-2-34" id="h48-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h48-2-38" id="h48-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h48-2-43" id="h48-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-2-47" id="h48-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h48-2-51" id="h48-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h48-2-56" id="h48-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-2-60" id="h48-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-2-62" id="h48-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h48-2-67" id="h48-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h48-2-73" id="h48-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-2-75" id="h48-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h48-2-80" id="h48-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h48-2-86" id="h48-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-2-88" id="h48-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h48-3" id="h48-3" class="h">@@ -278,26 +265,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h48-3-3" id="h48-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h48-3-8" id="h48-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h48-3-12" id="h48-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-3-14" id="h48-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h48-3-19" id="h48-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h48-3-23" id="h48-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h48-3-25" id="h48-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h49" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -185,84 +185,78 @@ Plan: Select(
</a>                     left: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h49-0-3" id="h49-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h49-0-8" id="h49-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h49-0-12" id="h49-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h49-0-14" id="h49-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h49-0-19" id="h49-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h49-0-23" id="h49-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h49-0-25" id="h49-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h49-0-30" id="h49-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h49-0-34" id="h49-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h49-0-38" id="h49-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h49-0-43" id="h49-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h49-0-47" id="h49-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h49-0-51" id="h49-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h49-0-56" id="h49-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h49-0-60" id="h49-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h49-0-62" id="h49-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h49-0-67" id="h49-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h49-0-73" id="h49-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h49-0-75" id="h49-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h49-0-80" id="h49-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h49-0-86" id="h49-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h49-0-88" id="h49-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h49-1" id="h49-1" class="h">@@ -275,26 +269,25 @@ Plan: Select(
</a>                     right: Scan {
                         table: Table {
                             name: &quot;genres&quot;,
<a href="#h49-1-3" id="h49-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h49-1-8" id="h49-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h49-1-12" id="h49-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h49-1-14" id="h49-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;name&quot;,
                                     datatype: String,
<a href="#h49-1-19" id="h49-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h49-1-23" id="h49-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h49-1-25" id="h49-1-25" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h49-2" id="h49-2" class="h">@@ -310,26 +303,25 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;countries&quot;,
<a href="#h49-2-3" id="h49-2-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: String,
<a href="#h49-2-8" id="h49-2-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h49-2-12" id="h49-2-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-2-14" id="h49-2-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h49-2-19" id="h49-2-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h49-2-23" id="h49-2-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-2-25" id="h49-2-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h49-3" id="h49-3" class="h">@@ -518,84 +510,78 @@ Optimized plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h49-3-3" id="h49-3-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h49-3-8" id="h49-3-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h49-3-12" id="h49-3-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-3-14" id="h49-3-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h49-3-19" id="h49-3-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h49-3-23" id="h49-3-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-3-25" id="h49-3-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h49-3-30" id="h49-3-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h49-3-34" id="h49-3-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h49-3-38" id="h49-3-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h49-3-43" id="h49-3-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h49-3-47" id="h49-3-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h49-3-51" id="h49-3-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h49-3-56" id="h49-3-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h49-3-60" id="h49-3-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-3-62" id="h49-3-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h49-3-67" id="h49-3-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h49-3-73" id="h49-3-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-3-75" id="h49-3-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h49-3-80" id="h49-3-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h49-3-86" id="h49-3-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-3-88" id="h49-3-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h49-4" id="h49-4" class="h">@@ -647,26 +633,25 @@ Optimized plan: Select(
</a>                 right: KeyLookup {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h49-4-3" id="h49-4-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h49-4-8" id="h49-4-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h49-4-12" id="h49-4-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-4-14" id="h49-4-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h49-4-19" id="h49-4-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h49-4-23" id="h49-4-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h49-4-25" id="h49-4-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h49-5" id="h49-5" class="h">@@ -686,26 +671,25 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;countries&quot;,
<a href="#h49-5-3" id="h49-5-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: String,
<a href="#h49-5-8" id="h49-5-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h49-5-12" id="h49-5-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h49-5-14" id="h49-5-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h49-5-19" id="h49-5-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h49-5-23" id="h49-5-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h49-5-25" id="h49-5-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h50" href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a> b/<a href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -418,84 +418,78 @@ Plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h50-0-3" id="h50-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h50-0-8" id="h50-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h50-0-12" id="h50-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-0-14" id="h50-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h50-0-19" id="h50-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-0-23" id="h50-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-0-25" id="h50-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h50-0-30" id="h50-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-0-34" id="h50-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h50-0-38" id="h50-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h50-0-43" id="h50-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-0-47" id="h50-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h50-0-51" id="h50-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h50-0-56" id="h50-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-0-60" id="h50-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-0-62" id="h50-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h50-0-67" id="h50-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h50-0-73" id="h50-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-0-75" id="h50-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h50-0-80" id="h50-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h50-0-86" id="h50-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-0-88" id="h50-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h50-1" id="h50-1" class="h">@@ -506,26 +500,25 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h50-1-3" id="h50-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h50-1-8" id="h50-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h50-1-12" id="h50-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-1-14" id="h50-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h50-1-19" id="h50-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-1-23" id="h50-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-1-25" id="h50-1-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h50-2" id="h50-2" class="h">@@ -539,26 +532,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;countries&quot;,
<a href="#h50-2-3" id="h50-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: String,
<a href="#h50-2-8" id="h50-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h50-2-12" id="h50-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h50-2-14" id="h50-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h50-2-19" id="h50-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h50-2-23" id="h50-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h50-2-25" id="h50-2-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h50-3" id="h50-3" class="h">@@ -572,40 +564,38 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;studios&quot;,
<a href="#h50-3-3" id="h50-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h50-3-8" id="h50-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h50-3-12" id="h50-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h50-3-14" id="h50-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h50-3-19" id="h50-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h50-3-23" id="h50-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h50-3-25" id="h50-3-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;country_id&quot;,
                         datatype: String,
<a href="#h50-3-30" id="h50-3-30" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h50-3-36" id="h50-3-36" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;countries&quot;,
                         ),
<a href="#h50-3-40" id="h50-3-40" class="d">-                        index: true,
</a>                     },
                 ],
             },
<a href="#h50-4" id="h50-4" class="h">@@ -624,84 +614,78 @@ Optimized plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h50-4-3" id="h50-4-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h50-4-8" id="h50-4-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h50-4-12" id="h50-4-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-4-14" id="h50-4-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h50-4-19" id="h50-4-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-4-23" id="h50-4-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-4-25" id="h50-4-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h50-4-30" id="h50-4-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-4-34" id="h50-4-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h50-4-38" id="h50-4-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h50-4-43" id="h50-4-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-4-47" id="h50-4-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h50-4-51" id="h50-4-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h50-4-56" id="h50-4-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-4-60" id="h50-4-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-4-62" id="h50-4-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h50-4-67" id="h50-4-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h50-4-73" id="h50-4-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-4-75" id="h50-4-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h50-4-80" id="h50-4-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h50-4-86" id="h50-4-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-4-88" id="h50-4-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h50-5" id="h50-5" class="h">@@ -712,26 +696,25 @@ Optimized plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h50-5-3" id="h50-5-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h50-5-8" id="h50-5-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h50-5-12" id="h50-5-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-5-14" id="h50-5-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h50-5-19" id="h50-5-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h50-5-23" id="h50-5-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h50-5-25" id="h50-5-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h50-6" id="h50-6" class="h">@@ -745,26 +728,25 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;countries&quot;,
<a href="#h50-6-3" id="h50-6-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: String,
<a href="#h50-6-8" id="h50-6-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h50-6-12" id="h50-6-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h50-6-14" id="h50-6-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h50-6-19" id="h50-6-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h50-6-23" id="h50-6-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h50-6-25" id="h50-6-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h50-7" id="h50-7" class="h">@@ -778,40 +760,38 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;studios&quot;,
<a href="#h50-7-3" id="h50-7-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h50-7-8" id="h50-7-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h50-7-12" id="h50-7-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h50-7-14" id="h50-7-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h50-7-19" id="h50-7-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h50-7-23" id="h50-7-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h50-7-25" id="h50-7-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;country_id&quot;,
                         datatype: String,
<a href="#h50-7-30" id="h50-7-30" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h50-7-36" id="h50-7-36" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;countries&quot;,
                         ),
<a href="#h50-7-40" id="h50-7-40" class="d">-                        index: true,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h51" href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a> b/<a href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -63,84 +63,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h51-0-3" id="h51-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h51-0-8" id="h51-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h51-0-12" id="h51-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-0-14" id="h51-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h51-0-19" id="h51-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-0-23" id="h51-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-0-25" id="h51-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h51-0-30" id="h51-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-0-34" id="h51-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h51-0-38" id="h51-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h51-0-43" id="h51-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-0-47" id="h51-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h51-0-51" id="h51-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h51-0-56" id="h51-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-0-60" id="h51-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-0-62" id="h51-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h51-0-67" id="h51-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h51-0-73" id="h51-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-0-75" id="h51-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h51-0-80" id="h51-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h51-0-86" id="h51-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-0-88" id="h51-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h51-1" id="h51-1" class="h">@@ -151,26 +145,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h51-1-3" id="h51-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h51-1-8" id="h51-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h51-1-12" id="h51-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-1-14" id="h51-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h51-1-19" id="h51-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-1-23" id="h51-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-1-25" id="h51-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h51-2" id="h51-2" class="h">@@ -212,84 +205,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h51-2-3" id="h51-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h51-2-8" id="h51-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h51-2-12" id="h51-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-2-14" id="h51-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h51-2-19" id="h51-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-2-23" id="h51-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-2-25" id="h51-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h51-2-30" id="h51-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-2-34" id="h51-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h51-2-38" id="h51-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h51-2-43" id="h51-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-2-47" id="h51-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h51-2-51" id="h51-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h51-2-56" id="h51-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-2-60" id="h51-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-2-62" id="h51-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h51-2-67" id="h51-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h51-2-73" id="h51-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-2-75" id="h51-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h51-2-80" id="h51-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h51-2-86" id="h51-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-2-88" id="h51-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h51-3" id="h51-3" class="h">@@ -310,26 +297,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h51-3-3" id="h51-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h51-3-8" id="h51-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h51-3-12" id="h51-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-3-14" id="h51-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h51-3-19" id="h51-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h51-3-23" id="h51-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h51-3-25" id="h51-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h52" href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a> b/<a href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -63,84 +63,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h52-0-3" id="h52-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h52-0-8" id="h52-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h52-0-12" id="h52-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-0-14" id="h52-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h52-0-19" id="h52-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-0-23" id="h52-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-0-25" id="h52-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h52-0-30" id="h52-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-0-34" id="h52-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h52-0-38" id="h52-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h52-0-43" id="h52-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-0-47" id="h52-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h52-0-51" id="h52-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h52-0-56" id="h52-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-0-60" id="h52-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-0-62" id="h52-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h52-0-67" id="h52-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h52-0-73" id="h52-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-0-75" id="h52-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h52-0-80" id="h52-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h52-0-86" id="h52-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-0-88" id="h52-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h52-1" id="h52-1" class="h">@@ -151,26 +145,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h52-1-3" id="h52-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h52-1-8" id="h52-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h52-1-12" id="h52-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-1-14" id="h52-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h52-1-19" id="h52-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-1-23" id="h52-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-1-25" id="h52-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h52-2" id="h52-2" class="h">@@ -212,84 +205,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h52-2-3" id="h52-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h52-2-8" id="h52-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h52-2-12" id="h52-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-2-14" id="h52-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h52-2-19" id="h52-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-2-23" id="h52-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-2-25" id="h52-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h52-2-30" id="h52-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-2-34" id="h52-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h52-2-38" id="h52-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h52-2-43" id="h52-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-2-47" id="h52-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h52-2-51" id="h52-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h52-2-56" id="h52-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-2-60" id="h52-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-2-62" id="h52-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h52-2-67" id="h52-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h52-2-73" id="h52-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-2-75" id="h52-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h52-2-80" id="h52-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h52-2-86" id="h52-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-2-88" id="h52-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h52-3" id="h52-3" class="h">@@ -310,26 +297,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h52-3-3" id="h52-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h52-3-8" id="h52-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h52-3-12" id="h52-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-3-14" id="h52-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h52-3-19" id="h52-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h52-3-23" id="h52-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h52-3-25" id="h52-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h53" href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -76,84 +76,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h53-0-3" id="h53-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h53-0-8" id="h53-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h53-0-12" id="h53-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-0-14" id="h53-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h53-0-19" id="h53-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-0-23" id="h53-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-0-25" id="h53-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h53-0-30" id="h53-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-0-34" id="h53-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h53-0-38" id="h53-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h53-0-43" id="h53-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-0-47" id="h53-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h53-0-51" id="h53-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h53-0-56" id="h53-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-0-60" id="h53-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-0-62" id="h53-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h53-0-67" id="h53-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h53-0-73" id="h53-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-0-75" id="h53-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h53-0-80" id="h53-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h53-0-86" id="h53-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-0-88" id="h53-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h53-1" id="h53-1" class="h">@@ -166,26 +160,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h53-1-3" id="h53-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h53-1-8" id="h53-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h53-1-12" id="h53-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-1-14" id="h53-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h53-1-19" id="h53-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-1-23" id="h53-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-1-25" id="h53-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h53-2" id="h53-2" class="h">@@ -249,84 +242,78 @@ Optimized plan: Select(
</a>         left: IndexLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h53-2-3" id="h53-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h53-2-8" id="h53-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h53-2-12" id="h53-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-2-14" id="h53-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h53-2-19" id="h53-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-2-23" id="h53-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-2-25" id="h53-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h53-2-30" id="h53-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-2-34" id="h53-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h53-2-38" id="h53-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h53-2-43" id="h53-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-2-47" id="h53-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h53-2-51" id="h53-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h53-2-56" id="h53-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-2-60" id="h53-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-2-62" id="h53-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h53-2-67" id="h53-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h53-2-73" id="h53-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-2-75" id="h53-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h53-2-80" id="h53-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h53-2-86" id="h53-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-2-88" id="h53-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h53-3" id="h53-3" class="h">@@ -354,26 +341,25 @@ Optimized plan: Select(
</a>         right: KeyLookup {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h53-3-3" id="h53-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h53-3-8" id="h53-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h53-3-12" id="h53-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-3-14" id="h53-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h53-3-19" id="h53-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h53-3-23" id="h53-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h53-3-25" id="h53-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h54" href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -74,84 +74,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h54-0-3" id="h54-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h54-0-8" id="h54-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h54-0-12" id="h54-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h54-0-14" id="h54-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h54-0-19" id="h54-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h54-0-23" id="h54-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h54-0-25" id="h54-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h54-0-30" id="h54-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h54-0-34" id="h54-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h54-0-38" id="h54-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h54-0-43" id="h54-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h54-0-47" id="h54-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h54-0-51" id="h54-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h54-0-56" id="h54-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h54-0-60" id="h54-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h54-0-62" id="h54-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h54-0-67" id="h54-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h54-0-73" id="h54-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h54-0-75" id="h54-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h54-0-80" id="h54-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h54-0-86" id="h54-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h54-0-88" id="h54-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h54-1" id="h54-1" class="h">@@ -164,26 +158,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h54-1-3" id="h54-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h54-1-8" id="h54-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h54-1-12" id="h54-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h54-1-14" id="h54-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h54-1-19" id="h54-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h54-1-23" id="h54-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h54-1-25" id="h54-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h54-2" id="h54-2" class="h">@@ -246,84 +239,78 @@ Optimized plan: Select(
</a>         left: IndexLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h54-2-3" id="h54-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h54-2-8" id="h54-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h54-2-12" id="h54-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h54-2-14" id="h54-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h54-2-19" id="h54-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h54-2-23" id="h54-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h54-2-25" id="h54-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h54-2-30" id="h54-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h54-2-34" id="h54-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h54-2-38" id="h54-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h54-2-43" id="h54-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h54-2-47" id="h54-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h54-2-51" id="h54-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h54-2-56" id="h54-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h54-2-60" id="h54-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h54-2-62" id="h54-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h54-2-67" id="h54-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h54-2-73" id="h54-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h54-2-75" id="h54-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h54-2-80" id="h54-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h54-2-86" id="h54-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h54-2-88" id="h54-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h54-3" id="h54-3" class="h">@@ -351,26 +338,25 @@ Optimized plan: Select(
</a>         right: KeyLookup {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h54-3-3" id="h54-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h54-3-8" id="h54-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h54-3-12" id="h54-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h54-3-14" id="h54-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h54-3-19" id="h54-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h54-3-23" id="h54-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h54-3-25" id="h54-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h55" href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a> b/<a href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -129,84 +129,78 @@ Plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h55-0-3" id="h55-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h55-0-8" id="h55-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h55-0-12" id="h55-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-0-14" id="h55-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h55-0-19" id="h55-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-0-23" id="h55-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-0-25" id="h55-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h55-0-30" id="h55-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-0-34" id="h55-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h55-0-38" id="h55-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h55-0-43" id="h55-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-0-47" id="h55-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h55-0-51" id="h55-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h55-0-56" id="h55-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-0-60" id="h55-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-0-62" id="h55-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h55-0-67" id="h55-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h55-0-73" id="h55-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-0-75" id="h55-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h55-0-80" id="h55-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h55-0-86" id="h55-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-0-88" id="h55-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h55-1" id="h55-1" class="h">@@ -217,26 +211,25 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h55-1-3" id="h55-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h55-1-8" id="h55-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h55-1-12" id="h55-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-1-14" id="h55-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h55-1-19" id="h55-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-1-23" id="h55-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-1-25" id="h55-1-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h55-2" id="h55-2" class="h">@@ -275,40 +268,38 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;studios&quot;,
<a href="#h55-2-3" id="h55-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h55-2-8" id="h55-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h55-2-12" id="h55-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h55-2-14" id="h55-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h55-2-19" id="h55-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h55-2-23" id="h55-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h55-2-25" id="h55-2-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;country_id&quot;,
                             datatype: String,
<a href="#h55-2-30" id="h55-2-30" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h55-2-36" id="h55-2-36" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;countries&quot;,
                             ),
<a href="#h55-2-40" id="h55-2-40" class="d">-                            index: true,
</a>                         },
                     ],
                 },
<a href="#h55-3" id="h55-3" class="h">@@ -401,84 +392,78 @@ Optimized plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h55-3-3" id="h55-3-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h55-3-8" id="h55-3-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h55-3-12" id="h55-3-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-3-14" id="h55-3-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h55-3-19" id="h55-3-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-3-23" id="h55-3-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-3-25" id="h55-3-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h55-3-30" id="h55-3-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-3-34" id="h55-3-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h55-3-38" id="h55-3-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h55-3-43" id="h55-3-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-3-47" id="h55-3-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h55-3-51" id="h55-3-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h55-3-56" id="h55-3-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-3-60" id="h55-3-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-3-62" id="h55-3-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h55-3-67" id="h55-3-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h55-3-73" id="h55-3-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-3-75" id="h55-3-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h55-3-80" id="h55-3-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h55-3-86" id="h55-3-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-3-88" id="h55-3-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h55-4" id="h55-4" class="h">@@ -499,26 +484,25 @@ Optimized plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h55-4-3" id="h55-4-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h55-4-8" id="h55-4-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h55-4-12" id="h55-4-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-4-14" id="h55-4-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h55-4-19" id="h55-4-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h55-4-23" id="h55-4-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h55-4-25" id="h55-4-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h55-5" id="h55-5" class="h">@@ -552,40 +536,38 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;studios&quot;,
<a href="#h55-5-3" id="h55-5-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h55-5-8" id="h55-5-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h55-5-12" id="h55-5-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h55-5-14" id="h55-5-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h55-5-19" id="h55-5-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h55-5-23" id="h55-5-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h55-5-25" id="h55-5-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;country_id&quot;,
                             datatype: String,
<a href="#h55-5-30" id="h55-5-30" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h55-5-36" id="h55-5-36" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;countries&quot;,
                             ),
<a href="#h55-5-40" id="h55-5-40" class="d">-                            index: true,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h56" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -180,84 +180,78 @@ Plan: Select(
</a>                     left: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h56-0-3" id="h56-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h56-0-8" id="h56-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h56-0-12" id="h56-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-0-14" id="h56-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h56-0-19" id="h56-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h56-0-23" id="h56-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-0-25" id="h56-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h56-0-30" id="h56-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h56-0-34" id="h56-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h56-0-38" id="h56-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h56-0-43" id="h56-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h56-0-47" id="h56-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h56-0-51" id="h56-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h56-0-56" id="h56-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h56-0-60" id="h56-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-0-62" id="h56-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h56-0-67" id="h56-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h56-0-73" id="h56-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-0-75" id="h56-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h56-0-80" id="h56-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h56-0-86" id="h56-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-0-88" id="h56-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h56-1" id="h56-1" class="h">@@ -270,26 +264,25 @@ Plan: Select(
</a>                     right: Scan {
                         table: Table {
                             name: &quot;genres&quot;,
<a href="#h56-1-3" id="h56-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h56-1-8" id="h56-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h56-1-12" id="h56-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-1-14" id="h56-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;name&quot;,
                                     datatype: String,
<a href="#h56-1-19" id="h56-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h56-1-23" id="h56-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-1-25" id="h56-1-25" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h56-2" id="h56-2" class="h">@@ -350,40 +343,38 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;studios&quot;,
<a href="#h56-2-3" id="h56-2-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h56-2-8" id="h56-2-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h56-2-12" id="h56-2-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h56-2-14" id="h56-2-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h56-2-19" id="h56-2-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h56-2-23" id="h56-2-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h56-2-25" id="h56-2-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;country_id&quot;,
                                 datatype: String,
<a href="#h56-2-30" id="h56-2-30" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h56-2-36" id="h56-2-36" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;countries&quot;,
                                 ),
<a href="#h56-2-40" id="h56-2-40" class="d">-                                index: true,
</a>                             },
                         ],
                     },
<a href="#h56-3" id="h56-3" class="h">@@ -517,84 +508,78 @@ Optimized plan: Select(
</a>                         source: IndexLookup {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h56-3-3" id="h56-3-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h56-3-8" id="h56-3-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h56-3-12" id="h56-3-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h56-3-14" id="h56-3-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h56-3-19" id="h56-3-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h56-3-23" id="h56-3-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h56-3-25" id="h56-3-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h56-3-30" id="h56-3-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h56-3-34" id="h56-3-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h56-3-38" id="h56-3-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h56-3-43" id="h56-3-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h56-3-47" id="h56-3-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h56-3-51" id="h56-3-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h56-3-56" id="h56-3-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h56-3-60" id="h56-3-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h56-3-62" id="h56-3-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h56-3-67" id="h56-3-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h56-3-73" id="h56-3-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h56-3-75" id="h56-3-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h56-3-80" id="h56-3-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h56-3-86" id="h56-3-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h56-3-88" id="h56-3-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h56-4" id="h56-4" class="h">@@ -641,26 +626,25 @@ Optimized plan: Select(
</a>                     right: KeyLookup {
                         table: Table {
                             name: &quot;genres&quot;,
<a href="#h56-4-3" id="h56-4-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h56-4-8" id="h56-4-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h56-4-12" id="h56-4-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-4-14" id="h56-4-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;name&quot;,
                                     datatype: String,
<a href="#h56-4-19" id="h56-4-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h56-4-23" id="h56-4-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h56-4-25" id="h56-4-25" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h56-5" id="h56-5" class="h">@@ -700,40 +684,38 @@ Optimized plan: Select(
</a>                 right: KeyLookup {
                     table: Table {
                         name: &quot;studios&quot;,
<a href="#h56-5-3" id="h56-5-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h56-5-8" id="h56-5-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h56-5-12" id="h56-5-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h56-5-14" id="h56-5-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h56-5-19" id="h56-5-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h56-5-23" id="h56-5-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h56-5-25" id="h56-5-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;country_id&quot;,
                                 datatype: String,
<a href="#h56-5-30" id="h56-5-30" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h56-5-36" id="h56-5-36" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;countries&quot;,
                                 ),
<a href="#h56-5-40" id="h56-5-40" class="d">-                                index: true,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h57" href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a> b/<a href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -229,84 +229,78 @@ Plan: Select(
</a>                             left: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h57-0-3" id="h57-0-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h57-0-8" id="h57-0-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h57-0-12" id="h57-0-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-0-14" id="h57-0-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h57-0-19" id="h57-0-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-0-23" id="h57-0-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-0-25" id="h57-0-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h57-0-30" id="h57-0-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-0-34" id="h57-0-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h57-0-38" id="h57-0-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h57-0-43" id="h57-0-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-0-47" id="h57-0-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h57-0-51" id="h57-0-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h57-0-56" id="h57-0-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-0-60" id="h57-0-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-0-62" id="h57-0-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h57-0-67" id="h57-0-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h57-0-73" id="h57-0-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-0-75" id="h57-0-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h57-0-80" id="h57-0-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h57-0-86" id="h57-0-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-0-88" id="h57-0-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<a href="#h57-1" id="h57-1" class="h">@@ -319,26 +313,25 @@ Plan: Select(
</a>                             right: Scan {
                                 table: Table {
                                     name: &quot;genres&quot;,
<a href="#h57-1-3" id="h57-1-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h57-1-8" id="h57-1-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h57-1-12" id="h57-1-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-1-14" id="h57-1-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;name&quot;,
                                             datatype: String,
<a href="#h57-1-19" id="h57-1-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-1-23" id="h57-1-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-1-25" id="h57-1-25" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<a href="#h57-2" id="h57-2" class="h">@@ -380,40 +373,38 @@ Plan: Select(
</a>                             left: Scan {
                                 table: Table {
                                     name: &quot;studios&quot;,
<a href="#h57-2-3" id="h57-2-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h57-2-8" id="h57-2-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h57-2-12" id="h57-2-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-2-14" id="h57-2-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;name&quot;,
                                             datatype: String,
<a href="#h57-2-19" id="h57-2-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-2-23" id="h57-2-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-2-25" id="h57-2-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;country_id&quot;,
                                             datatype: String,
<a href="#h57-2-30" id="h57-2-30" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h57-2-36" id="h57-2-36" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;countries&quot;,
                                             ),
<a href="#h57-2-40" id="h57-2-40" class="d">-                                            index: true,
</a>                                         },
                                     ],
                                 },
<a href="#h57-3" id="h57-3" class="h">@@ -426,84 +417,78 @@ Plan: Select(
</a>                             right: Scan {
                                 table: Table {
                                     name: &quot;movies&quot;,
<a href="#h57-3-3" id="h57-3-3" class="i">+                                    primary_key: 0,
</a>                                     columns: [
                                         Column {
                                             name: &quot;id&quot;,
                                             datatype: Integer,
<a href="#h57-3-8" id="h57-3-8" class="d">-                                            primary_key: true,
</a>                                             nullable: false,
                                             default: None,
                                             unique: true,
<a href="#h57-3-12" id="h57-3-12" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-3-14" id="h57-3-14" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;title&quot;,
                                             datatype: String,
<a href="#h57-3-19" id="h57-3-19" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-3-23" id="h57-3-23" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-3-25" id="h57-3-25" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;studio_id&quot;,
                                             datatype: Integer,
<a href="#h57-3-30" id="h57-3-30" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-3-34" id="h57-3-34" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;studios&quot;,
                                             ),
<a href="#h57-3-38" id="h57-3-38" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;genre_id&quot;,
                                             datatype: Integer,
<a href="#h57-3-43" id="h57-3-43" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-3-47" id="h57-3-47" class="i">+                                            index: true,
</a>                                             references: Some(
                                                 &quot;genres&quot;,
                                             ),
<a href="#h57-3-51" id="h57-3-51" class="d">-                                            index: true,
</a>                                         },
                                         Column {
                                             name: &quot;released&quot;,
                                             datatype: Integer,
<a href="#h57-3-56" id="h57-3-56" class="d">-                                            primary_key: false,
</a>                                             nullable: false,
                                             default: None,
                                             unique: false,
<a href="#h57-3-60" id="h57-3-60" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-3-62" id="h57-3-62" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;rating&quot;,
                                             datatype: Float,
<a href="#h57-3-67" id="h57-3-67" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h57-3-73" id="h57-3-73" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-3-75" id="h57-3-75" class="i">+                                            references: None,
</a>                                         },
                                         Column {
                                             name: &quot;ultrahd&quot;,
                                             datatype: Boolean,
<a href="#h57-3-80" id="h57-3-80" class="d">-                                            primary_key: false,
</a>                                             nullable: true,
                                             default: Some(
                                                 Null,
                                             ),
                                             unique: false,
<a href="#h57-3-86" id="h57-3-86" class="d">-                                            references: None,
</a>                                             index: false,
<a href="#h57-3-88" id="h57-3-88" class="i">+                                            references: None,
</a>                                         },
                                     ],
                                 },
<a href="#h57-4" id="h57-4" class="h">@@ -793,84 +778,78 @@ Optimized plan: Select(
</a>                         left: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h57-4-3" id="h57-4-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h57-4-8" id="h57-4-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h57-4-12" id="h57-4-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-4-14" id="h57-4-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h57-4-19" id="h57-4-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-4-23" id="h57-4-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-4-25" id="h57-4-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h57-4-30" id="h57-4-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-4-34" id="h57-4-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h57-4-38" id="h57-4-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h57-4-43" id="h57-4-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-4-47" id="h57-4-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h57-4-51" id="h57-4-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h57-4-56" id="h57-4-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-4-60" id="h57-4-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-4-62" id="h57-4-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h57-4-67" id="h57-4-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h57-4-73" id="h57-4-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-4-75" id="h57-4-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h57-4-80" id="h57-4-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h57-4-86" id="h57-4-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-4-88" id="h57-4-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h57-5" id="h57-5" class="h">@@ -893,26 +872,25 @@ Optimized plan: Select(
</a>                         right: Scan {
                             table: Table {
                                 name: &quot;genres&quot;,
<a href="#h57-5-3" id="h57-5-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h57-5-8" id="h57-5-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h57-5-12" id="h57-5-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-5-14" id="h57-5-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;name&quot;,
                                         datatype: String,
<a href="#h57-5-19" id="h57-5-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-5-23" id="h57-5-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-5-25" id="h57-5-25" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h57-6" id="h57-6" class="h">@@ -949,40 +927,38 @@ Optimized plan: Select(
</a>                         left: Scan {
                             table: Table {
                                 name: &quot;studios&quot;,
<a href="#h57-6-3" id="h57-6-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h57-6-8" id="h57-6-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h57-6-12" id="h57-6-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-6-14" id="h57-6-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;name&quot;,
                                         datatype: String,
<a href="#h57-6-19" id="h57-6-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-6-23" id="h57-6-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-6-25" id="h57-6-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;country_id&quot;,
                                         datatype: String,
<a href="#h57-6-30" id="h57-6-30" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h57-6-36" id="h57-6-36" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;countries&quot;,
                                         ),
<a href="#h57-6-40" id="h57-6-40" class="d">-                                        index: true,
</a>                                     },
                                 ],
                             },
<a href="#h57-7" id="h57-7" class="h">@@ -1005,84 +981,78 @@ Optimized plan: Select(
</a>                         right: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h57-7-3" id="h57-7-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h57-7-8" id="h57-7-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h57-7-12" id="h57-7-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-7-14" id="h57-7-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h57-7-19" id="h57-7-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-7-23" id="h57-7-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-7-25" id="h57-7-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h57-7-30" id="h57-7-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-7-34" id="h57-7-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h57-7-38" id="h57-7-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h57-7-43" id="h57-7-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-7-47" id="h57-7-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h57-7-51" id="h57-7-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h57-7-56" id="h57-7-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h57-7-60" id="h57-7-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-7-62" id="h57-7-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h57-7-67" id="h57-7-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h57-7-73" id="h57-7-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-7-75" id="h57-7-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h57-7-80" id="h57-7-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h57-7-86" id="h57-7-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h57-7-88" id="h57-7-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<b>diff --git a/<a id="h58" href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a> b/<a href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -67,84 +67,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h58-0-3" id="h58-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h58-0-8" id="h58-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h58-0-12" id="h58-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-0-14" id="h58-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h58-0-19" id="h58-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-0-23" id="h58-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-0-25" id="h58-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h58-0-30" id="h58-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-0-34" id="h58-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h58-0-38" id="h58-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h58-0-43" id="h58-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-0-47" id="h58-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h58-0-51" id="h58-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h58-0-56" id="h58-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-0-60" id="h58-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-0-62" id="h58-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h58-0-67" id="h58-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h58-0-73" id="h58-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-0-75" id="h58-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h58-0-80" id="h58-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h58-0-86" id="h58-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-0-88" id="h58-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h58-1" id="h58-1" class="h">@@ -157,26 +151,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h58-1-3" id="h58-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h58-1-8" id="h58-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h58-1-12" id="h58-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-1-14" id="h58-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h58-1-19" id="h58-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-1-23" id="h58-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-1-25" id="h58-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h58-2" id="h58-2" class="h">@@ -220,84 +213,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h58-2-3" id="h58-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h58-2-8" id="h58-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h58-2-12" id="h58-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-2-14" id="h58-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h58-2-19" id="h58-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-2-23" id="h58-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-2-25" id="h58-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h58-2-30" id="h58-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-2-34" id="h58-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h58-2-38" id="h58-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h58-2-43" id="h58-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-2-47" id="h58-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h58-2-51" id="h58-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h58-2-56" id="h58-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-2-60" id="h58-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-2-62" id="h58-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h58-2-67" id="h58-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h58-2-73" id="h58-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-2-75" id="h58-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h58-2-80" id="h58-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h58-2-86" id="h58-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-2-88" id="h58-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h58-3" id="h58-3" class="h">@@ -320,26 +307,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h58-3-3" id="h58-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h58-3-8" id="h58-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h58-3-12" id="h58-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-3-14" id="h58-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h58-3-19" id="h58-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h58-3-23" id="h58-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h58-3-25" id="h58-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h59" href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a> b/<a href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -42,84 +42,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h59-0-3" id="h59-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h59-0-8" id="h59-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h59-0-12" id="h59-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-0-14" id="h59-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h59-0-19" id="h59-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-0-23" id="h59-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-0-25" id="h59-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h59-0-30" id="h59-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-0-34" id="h59-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h59-0-38" id="h59-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h59-0-43" id="h59-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-0-47" id="h59-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h59-0-51" id="h59-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h59-0-56" id="h59-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-0-60" id="h59-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-0-62" id="h59-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h59-0-67" id="h59-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h59-0-73" id="h59-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-0-75" id="h59-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h59-0-80" id="h59-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h59-0-86" id="h59-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-0-88" id="h59-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h59-1" id="h59-1" class="h">@@ -130,26 +124,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h59-1-3" id="h59-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h59-1-8" id="h59-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h59-1-12" id="h59-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-1-14" id="h59-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h59-1-19" id="h59-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-1-23" id="h59-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-1-25" id="h59-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h59-2" id="h59-2" class="h">@@ -172,84 +165,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h59-2-3" id="h59-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h59-2-8" id="h59-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h59-2-12" id="h59-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-2-14" id="h59-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h59-2-19" id="h59-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-2-23" id="h59-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-2-25" id="h59-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h59-2-30" id="h59-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-2-34" id="h59-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h59-2-38" id="h59-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h59-2-43" id="h59-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-2-47" id="h59-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h59-2-51" id="h59-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h59-2-56" id="h59-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-2-60" id="h59-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-2-62" id="h59-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h59-2-67" id="h59-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h59-2-73" id="h59-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-2-75" id="h59-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h59-2-80" id="h59-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h59-2-86" id="h59-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-2-88" id="h59-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h59-3" id="h59-3" class="h">@@ -266,26 +253,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h59-3-3" id="h59-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h59-3-8" id="h59-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h59-3-12" id="h59-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-3-14" id="h59-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h59-3-19" id="h59-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h59-3-23" id="h59-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h59-3-25" id="h59-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h60" href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a> b/<a href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -75,84 +75,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h60-0-3" id="h60-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h60-0-8" id="h60-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h60-0-12" id="h60-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-0-14" id="h60-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h60-0-19" id="h60-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-0-23" id="h60-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-0-25" id="h60-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h60-0-30" id="h60-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-0-34" id="h60-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h60-0-38" id="h60-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h60-0-43" id="h60-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-0-47" id="h60-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h60-0-51" id="h60-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h60-0-56" id="h60-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-0-60" id="h60-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-0-62" id="h60-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h60-0-67" id="h60-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h60-0-73" id="h60-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-0-75" id="h60-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h60-0-80" id="h60-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h60-0-86" id="h60-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-0-88" id="h60-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h60-1" id="h60-1" class="h">@@ -163,26 +157,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h60-1-3" id="h60-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h60-1-8" id="h60-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h60-1-12" id="h60-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-1-14" id="h60-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h60-1-19" id="h60-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-1-23" id="h60-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-1-25" id="h60-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h60-2" id="h60-2" class="h">@@ -250,84 +243,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h60-2-3" id="h60-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h60-2-8" id="h60-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h60-2-12" id="h60-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-2-14" id="h60-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h60-2-19" id="h60-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-2-23" id="h60-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-2-25" id="h60-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h60-2-30" id="h60-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-2-34" id="h60-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h60-2-38" id="h60-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h60-2-43" id="h60-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-2-47" id="h60-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h60-2-51" id="h60-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h60-2-56" id="h60-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-2-60" id="h60-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-2-62" id="h60-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h60-2-67" id="h60-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h60-2-73" id="h60-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-2-75" id="h60-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h60-2-80" id="h60-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h60-2-86" id="h60-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-2-88" id="h60-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h60-3" id="h60-3" class="h">@@ -338,26 +325,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h60-3-3" id="h60-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h60-3-8" id="h60-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h60-3-12" id="h60-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-3-14" id="h60-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h60-3-19" id="h60-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h60-3-23" id="h60-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h60-3-25" id="h60-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h61" href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a> b/<a href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -72,84 +72,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h61-0-3" id="h61-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h61-0-8" id="h61-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h61-0-12" id="h61-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-0-14" id="h61-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h61-0-19" id="h61-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-0-23" id="h61-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-0-25" id="h61-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h61-0-30" id="h61-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-0-34" id="h61-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h61-0-38" id="h61-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h61-0-43" id="h61-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-0-47" id="h61-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h61-0-51" id="h61-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h61-0-56" id="h61-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-0-60" id="h61-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-0-62" id="h61-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h61-0-67" id="h61-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h61-0-73" id="h61-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-0-75" id="h61-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h61-0-80" id="h61-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h61-0-86" id="h61-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-0-88" id="h61-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h61-1" id="h61-1" class="h">@@ -160,26 +154,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h61-1-3" id="h61-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h61-1-8" id="h61-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h61-1-12" id="h61-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-1-14" id="h61-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h61-1-19" id="h61-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-1-23" id="h61-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-1-25" id="h61-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h61-2" id="h61-2" class="h">@@ -202,84 +195,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h61-2-3" id="h61-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h61-2-8" id="h61-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h61-2-12" id="h61-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-2-14" id="h61-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h61-2-19" id="h61-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-2-23" id="h61-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-2-25" id="h61-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h61-2-30" id="h61-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-2-34" id="h61-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h61-2-38" id="h61-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h61-2-43" id="h61-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-2-47" id="h61-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h61-2-51" id="h61-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h61-2-56" id="h61-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-2-60" id="h61-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-2-62" id="h61-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h61-2-67" id="h61-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h61-2-73" id="h61-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-2-75" id="h61-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h61-2-80" id="h61-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h61-2-86" id="h61-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-2-88" id="h61-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h61-3" id="h61-3" class="h">@@ -296,26 +283,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h61-3-3" id="h61-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h61-3-8" id="h61-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h61-3-12" id="h61-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-3-14" id="h61-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h61-3-19" id="h61-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h61-3-23" id="h61-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h61-3-25" id="h61-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h62" href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a> b/<a href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -78,84 +78,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h62-0-3" id="h62-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h62-0-8" id="h62-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h62-0-12" id="h62-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h62-0-14" id="h62-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h62-0-19" id="h62-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h62-0-23" id="h62-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h62-0-25" id="h62-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h62-0-30" id="h62-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h62-0-34" id="h62-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h62-0-38" id="h62-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h62-0-43" id="h62-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h62-0-47" id="h62-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h62-0-51" id="h62-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h62-0-56" id="h62-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h62-0-60" id="h62-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h62-0-62" id="h62-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h62-0-67" id="h62-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h62-0-73" id="h62-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h62-0-75" id="h62-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h62-0-80" id="h62-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h62-0-86" id="h62-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h62-0-88" id="h62-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h62-1" id="h62-1" class="h">@@ -166,26 +160,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h62-1-3" id="h62-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h62-1-8" id="h62-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h62-1-12" id="h62-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h62-1-14" id="h62-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h62-1-19" id="h62-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h62-1-23" id="h62-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h62-1-25" id="h62-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h62-2" id="h62-2" class="h">@@ -266,84 +259,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h62-2-3" id="h62-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h62-2-8" id="h62-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h62-2-12" id="h62-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h62-2-14" id="h62-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h62-2-19" id="h62-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h62-2-23" id="h62-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h62-2-25" id="h62-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h62-2-30" id="h62-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h62-2-34" id="h62-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h62-2-38" id="h62-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h62-2-43" id="h62-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h62-2-47" id="h62-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h62-2-51" id="h62-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h62-2-56" id="h62-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h62-2-60" id="h62-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h62-2-62" id="h62-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h62-2-67" id="h62-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h62-2-73" id="h62-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h62-2-75" id="h62-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h62-2-80" id="h62-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h62-2-86" id="h62-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h62-2-88" id="h62-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h62-3" id="h62-3" class="h">@@ -403,26 +390,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h62-3-3" id="h62-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h62-3-8" id="h62-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h62-3-12" id="h62-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h62-3-14" id="h62-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h62-3-19" id="h62-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h62-3-23" id="h62-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h62-3-25" id="h62-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h63" href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a> b/<a href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -92,84 +92,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h63-0-3" id="h63-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h63-0-8" id="h63-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h63-0-12" id="h63-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-0-14" id="h63-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h63-0-19" id="h63-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-0-23" id="h63-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-0-25" id="h63-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h63-0-30" id="h63-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-0-34" id="h63-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h63-0-38" id="h63-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h63-0-43" id="h63-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-0-47" id="h63-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h63-0-51" id="h63-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h63-0-56" id="h63-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-0-60" id="h63-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-0-62" id="h63-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h63-0-67" id="h63-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h63-0-73" id="h63-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-0-75" id="h63-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h63-0-80" id="h63-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h63-0-86" id="h63-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-0-88" id="h63-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h63-1" id="h63-1" class="h">@@ -182,26 +176,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h63-1-3" id="h63-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h63-1-8" id="h63-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h63-1-12" id="h63-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-1-14" id="h63-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h63-1-19" id="h63-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-1-23" id="h63-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-1-25" id="h63-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h63-2" id="h63-2" class="h">@@ -281,84 +274,78 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h63-2-3" id="h63-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h63-2-8" id="h63-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h63-2-12" id="h63-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-2-14" id="h63-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h63-2-19" id="h63-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-2-23" id="h63-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-2-25" id="h63-2-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h63-2-30" id="h63-2-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-2-34" id="h63-2-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h63-2-38" id="h63-2-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h63-2-43" id="h63-2-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-2-47" id="h63-2-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h63-2-51" id="h63-2-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h63-2-56" id="h63-2-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-2-60" id="h63-2-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-2-62" id="h63-2-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h63-2-67" id="h63-2-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h63-2-73" id="h63-2-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-2-75" id="h63-2-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h63-2-80" id="h63-2-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h63-2-86" id="h63-2-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-2-88" id="h63-2-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h63-3" id="h63-3" class="h">@@ -381,26 +368,25 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h63-3-3" id="h63-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h63-3-8" id="h63-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h63-3-12" id="h63-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-3-14" id="h63-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h63-3-19" id="h63-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h63-3-23" id="h63-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h63-3-25" id="h63-3-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h64" href="../file/tests/sql/query/join_left_all.html">tests/sql/query/join_left_all</a> b/<a href="../file/tests/sql/query/join_left_all.html">tests/sql/query/join_left_all</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -67,84 +67,78 @@ Plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h64-0-3" id="h64-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h64-0-8" id="h64-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h64-0-12" id="h64-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-0-14" id="h64-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h64-0-19" id="h64-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-0-23" id="h64-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-0-25" id="h64-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h64-0-30" id="h64-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-0-34" id="h64-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h64-0-38" id="h64-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h64-0-43" id="h64-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-0-47" id="h64-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h64-0-51" id="h64-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h64-0-56" id="h64-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-0-60" id="h64-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-0-62" id="h64-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h64-0-67" id="h64-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h64-0-73" id="h64-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-0-75" id="h64-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h64-0-80" id="h64-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h64-0-86" id="h64-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-0-88" id="h64-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h64-1" id="h64-1" class="h">@@ -157,26 +151,25 @@ Plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h64-1-3" id="h64-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h64-1-8" id="h64-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h64-1-12" id="h64-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-1-14" id="h64-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h64-1-19" id="h64-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-1-23" id="h64-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-1-25" id="h64-1-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h64-2" id="h64-2" class="h">@@ -220,84 +213,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h64-2-3" id="h64-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h64-2-8" id="h64-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h64-2-12" id="h64-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-2-14" id="h64-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h64-2-19" id="h64-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-2-23" id="h64-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-2-25" id="h64-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h64-2-30" id="h64-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-2-34" id="h64-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h64-2-38" id="h64-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h64-2-43" id="h64-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-2-47" id="h64-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h64-2-51" id="h64-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h64-2-56" id="h64-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-2-60" id="h64-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-2-62" id="h64-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h64-2-67" id="h64-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h64-2-73" id="h64-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-2-75" id="h64-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h64-2-80" id="h64-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h64-2-86" id="h64-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-2-88" id="h64-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h64-3" id="h64-3" class="h">@@ -320,26 +307,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h64-3-3" id="h64-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h64-3-8" id="h64-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h64-3-12" id="h64-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-3-14" id="h64-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h64-3-19" id="h64-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h64-3-23" id="h64-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h64-3-25" id="h64-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h65" href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a> b/<a href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -92,84 +92,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h65-0-3" id="h65-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h65-0-8" id="h65-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h65-0-12" id="h65-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-0-14" id="h65-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h65-0-19" id="h65-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-0-23" id="h65-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-0-25" id="h65-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h65-0-30" id="h65-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-0-34" id="h65-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h65-0-38" id="h65-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h65-0-43" id="h65-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-0-47" id="h65-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h65-0-51" id="h65-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h65-0-56" id="h65-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-0-60" id="h65-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-0-62" id="h65-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h65-0-67" id="h65-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h65-0-73" id="h65-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-0-75" id="h65-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h65-0-80" id="h65-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h65-0-86" id="h65-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-0-88" id="h65-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h65-1" id="h65-1" class="h">@@ -182,26 +176,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h65-1-3" id="h65-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h65-1-8" id="h65-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h65-1-12" id="h65-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-1-14" id="h65-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h65-1-19" id="h65-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-1-23" id="h65-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-1-25" id="h65-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h65-2" id="h65-2" class="h">@@ -281,84 +274,78 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h65-2-3" id="h65-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h65-2-8" id="h65-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h65-2-12" id="h65-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-2-14" id="h65-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h65-2-19" id="h65-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-2-23" id="h65-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-2-25" id="h65-2-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h65-2-30" id="h65-2-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-2-34" id="h65-2-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h65-2-38" id="h65-2-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h65-2-43" id="h65-2-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-2-47" id="h65-2-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h65-2-51" id="h65-2-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h65-2-56" id="h65-2-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-2-60" id="h65-2-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-2-62" id="h65-2-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h65-2-67" id="h65-2-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h65-2-73" id="h65-2-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-2-75" id="h65-2-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h65-2-80" id="h65-2-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h65-2-86" id="h65-2-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-2-88" id="h65-2-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h65-3" id="h65-3" class="h">@@ -381,26 +368,25 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h65-3-3" id="h65-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h65-3-8" id="h65-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h65-3-12" id="h65-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-3-14" id="h65-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h65-3-19" id="h65-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h65-3-23" id="h65-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h65-3-25" id="h65-3-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h66" href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a> b/<a href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -85,26 +85,25 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h66-0-3" id="h66-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h66-0-8" id="h66-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h66-0-12" id="h66-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-0-14" id="h66-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h66-0-19" id="h66-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-0-23" id="h66-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-0-25" id="h66-0-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h66-1" id="h66-1" class="h">@@ -117,84 +116,78 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h66-1-3" id="h66-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h66-1-8" id="h66-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h66-1-12" id="h66-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-1-14" id="h66-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h66-1-19" id="h66-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-1-23" id="h66-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-1-25" id="h66-1-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h66-1-30" id="h66-1-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-1-34" id="h66-1-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h66-1-38" id="h66-1-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h66-1-43" id="h66-1-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-1-47" id="h66-1-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h66-1-51" id="h66-1-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h66-1-56" id="h66-1-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-1-60" id="h66-1-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-1-62" id="h66-1-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h66-1-67" id="h66-1-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h66-1-73" id="h66-1-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-1-75" id="h66-1-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h66-1-80" id="h66-1-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h66-1-86" id="h66-1-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-1-88" id="h66-1-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h66-2" id="h66-2" class="h">@@ -274,26 +267,25 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h66-2-3" id="h66-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h66-2-8" id="h66-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h66-2-12" id="h66-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-2-14" id="h66-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h66-2-19" id="h66-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-2-23" id="h66-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-2-25" id="h66-2-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h66-3" id="h66-3" class="h">@@ -316,84 +308,78 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h66-3-3" id="h66-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h66-3-8" id="h66-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h66-3-12" id="h66-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-3-14" id="h66-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h66-3-19" id="h66-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-3-23" id="h66-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-3-25" id="h66-3-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h66-3-30" id="h66-3-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-3-34" id="h66-3-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h66-3-38" id="h66-3-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h66-3-43" id="h66-3-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-3-47" id="h66-3-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h66-3-51" id="h66-3-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h66-3-56" id="h66-3-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h66-3-60" id="h66-3-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-3-62" id="h66-3-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h66-3-67" id="h66-3-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h66-3-73" id="h66-3-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-3-75" id="h66-3-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h66-3-80" id="h66-3-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h66-3-86" id="h66-3-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h66-3-88" id="h66-3-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h67" href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a> b/<a href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -94,84 +94,78 @@ Plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h67-0-3" id="h67-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h67-0-8" id="h67-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h67-0-12" id="h67-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-0-14" id="h67-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h67-0-19" id="h67-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-0-23" id="h67-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-0-25" id="h67-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h67-0-30" id="h67-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-0-34" id="h67-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h67-0-38" id="h67-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h67-0-43" id="h67-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-0-47" id="h67-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h67-0-51" id="h67-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h67-0-56" id="h67-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-0-60" id="h67-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-0-62" id="h67-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h67-0-67" id="h67-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h67-0-73" id="h67-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-0-75" id="h67-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h67-0-80" id="h67-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h67-0-86" id="h67-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-0-88" id="h67-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h67-1" id="h67-1" class="h">@@ -184,26 +178,25 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h67-1-3" id="h67-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h67-1-8" id="h67-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h67-1-12" id="h67-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-1-14" id="h67-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h67-1-19" id="h67-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-1-23" id="h67-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-1-25" id="h67-1-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h67-2" id="h67-2" class="h">@@ -413,84 +406,78 @@ Optimized plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h67-2-3" id="h67-2-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h67-2-8" id="h67-2-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h67-2-12" id="h67-2-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-2-14" id="h67-2-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h67-2-19" id="h67-2-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-2-23" id="h67-2-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-2-25" id="h67-2-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h67-2-30" id="h67-2-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-2-34" id="h67-2-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h67-2-38" id="h67-2-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h67-2-43" id="h67-2-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-2-47" id="h67-2-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h67-2-51" id="h67-2-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h67-2-56" id="h67-2-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-2-60" id="h67-2-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-2-62" id="h67-2-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h67-2-67" id="h67-2-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h67-2-73" id="h67-2-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-2-75" id="h67-2-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h67-2-80" id="h67-2-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h67-2-86" id="h67-2-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-2-88" id="h67-2-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h67-3" id="h67-3" class="h">@@ -513,26 +500,25 @@ Optimized plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h67-3-3" id="h67-3-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h67-3-8" id="h67-3-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h67-3-12" id="h67-3-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-3-14" id="h67-3-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h67-3-19" id="h67-3-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h67-3-23" id="h67-3-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h67-3-25" id="h67-3-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h68" href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a> b/<a href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -69,84 +69,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h68-0-3" id="h68-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h68-0-8" id="h68-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h68-0-12" id="h68-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-0-14" id="h68-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h68-0-19" id="h68-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-0-23" id="h68-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-0-25" id="h68-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h68-0-30" id="h68-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-0-34" id="h68-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h68-0-38" id="h68-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h68-0-43" id="h68-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-0-47" id="h68-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h68-0-51" id="h68-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h68-0-56" id="h68-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-0-60" id="h68-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-0-62" id="h68-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h68-0-67" id="h68-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h68-0-73" id="h68-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-0-75" id="h68-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h68-0-80" id="h68-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h68-0-86" id="h68-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-0-88" id="h68-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h68-1" id="h68-1" class="h">@@ -159,26 +153,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h68-1-3" id="h68-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h68-1-8" id="h68-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h68-1-12" id="h68-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-1-14" id="h68-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h68-1-19" id="h68-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-1-23" id="h68-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-1-25" id="h68-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h68-2" id="h68-2" class="h">@@ -352,84 +345,78 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h68-2-3" id="h68-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h68-2-8" id="h68-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h68-2-12" id="h68-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-2-14" id="h68-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h68-2-19" id="h68-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-2-23" id="h68-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-2-25" id="h68-2-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h68-2-30" id="h68-2-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-2-34" id="h68-2-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h68-2-38" id="h68-2-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h68-2-43" id="h68-2-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-2-47" id="h68-2-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h68-2-51" id="h68-2-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h68-2-56" id="h68-2-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-2-60" id="h68-2-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-2-62" id="h68-2-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h68-2-67" id="h68-2-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h68-2-73" id="h68-2-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-2-75" id="h68-2-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h68-2-80" id="h68-2-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h68-2-86" id="h68-2-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-2-88" id="h68-2-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h68-3" id="h68-3" class="h">@@ -452,26 +439,25 @@ Optimized plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h68-3-3" id="h68-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h68-3-8" id="h68-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h68-3-12" id="h68-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-3-14" id="h68-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h68-3-19" id="h68-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h68-3-23" id="h68-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h68-3-25" id="h68-3-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h69" href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a> b/<a href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -94,84 +94,78 @@ Plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h69-0-3" id="h69-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h69-0-8" id="h69-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h69-0-12" id="h69-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-0-14" id="h69-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h69-0-19" id="h69-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-0-23" id="h69-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-0-25" id="h69-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h69-0-30" id="h69-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-0-34" id="h69-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h69-0-38" id="h69-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h69-0-43" id="h69-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-0-47" id="h69-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h69-0-51" id="h69-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h69-0-56" id="h69-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-0-60" id="h69-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-0-62" id="h69-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h69-0-67" id="h69-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h69-0-73" id="h69-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-0-75" id="h69-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h69-0-80" id="h69-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h69-0-86" id="h69-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-0-88" id="h69-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h69-1" id="h69-1" class="h">@@ -184,26 +178,25 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h69-1-3" id="h69-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h69-1-8" id="h69-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h69-1-12" id="h69-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-1-14" id="h69-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h69-1-19" id="h69-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-1-23" id="h69-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-1-25" id="h69-1-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h69-2" id="h69-2" class="h">@@ -413,84 +406,78 @@ Optimized plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h69-2-3" id="h69-2-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h69-2-8" id="h69-2-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h69-2-12" id="h69-2-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-2-14" id="h69-2-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h69-2-19" id="h69-2-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-2-23" id="h69-2-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-2-25" id="h69-2-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h69-2-30" id="h69-2-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-2-34" id="h69-2-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h69-2-38" id="h69-2-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h69-2-43" id="h69-2-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-2-47" id="h69-2-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h69-2-51" id="h69-2-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h69-2-56" id="h69-2-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-2-60" id="h69-2-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-2-62" id="h69-2-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h69-2-67" id="h69-2-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h69-2-73" id="h69-2-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-2-75" id="h69-2-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h69-2-80" id="h69-2-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h69-2-86" id="h69-2-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-2-88" id="h69-2-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h69-3" id="h69-3" class="h">@@ -513,26 +500,25 @@ Optimized plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h69-3-3" id="h69-3-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h69-3-8" id="h69-3-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h69-3-12" id="h69-3-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-3-14" id="h69-3-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h69-3-19" id="h69-3-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h69-3-23" id="h69-3-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h69-3-25" id="h69-3-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h70" href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a> b/<a href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -87,26 +87,25 @@ Plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h70-0-3" id="h70-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h70-0-8" id="h70-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h70-0-12" id="h70-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-0-14" id="h70-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h70-0-19" id="h70-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-0-23" id="h70-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-0-25" id="h70-0-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h70-1" id="h70-1" class="h">@@ -119,84 +118,78 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h70-1-3" id="h70-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h70-1-8" id="h70-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h70-1-12" id="h70-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-1-14" id="h70-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h70-1-19" id="h70-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-1-23" id="h70-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-1-25" id="h70-1-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h70-1-30" id="h70-1-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-1-34" id="h70-1-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h70-1-38" id="h70-1-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h70-1-43" id="h70-1-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-1-47" id="h70-1-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h70-1-51" id="h70-1-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h70-1-56" id="h70-1-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-1-60" id="h70-1-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-1-62" id="h70-1-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h70-1-67" id="h70-1-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h70-1-73" id="h70-1-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-1-75" id="h70-1-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h70-1-80" id="h70-1-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h70-1-86" id="h70-1-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-1-88" id="h70-1-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h70-2" id="h70-2" class="h">@@ -406,26 +399,25 @@ Optimized plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h70-2-3" id="h70-2-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h70-2-8" id="h70-2-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h70-2-12" id="h70-2-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-2-14" id="h70-2-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h70-2-19" id="h70-2-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-2-23" id="h70-2-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-2-25" id="h70-2-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h70-3" id="h70-3" class="h">@@ -448,84 +440,78 @@ Optimized plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h70-3-3" id="h70-3-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h70-3-8" id="h70-3-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h70-3-12" id="h70-3-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-3-14" id="h70-3-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h70-3-19" id="h70-3-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-3-23" id="h70-3-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-3-25" id="h70-3-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h70-3-30" id="h70-3-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-3-34" id="h70-3-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h70-3-38" id="h70-3-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h70-3-43" id="h70-3-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-3-47" id="h70-3-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h70-3-51" id="h70-3-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h70-3-56" id="h70-3-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h70-3-60" id="h70-3-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-3-62" id="h70-3-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h70-3-67" id="h70-3-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h70-3-73" id="h70-3-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-3-75" id="h70-3-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h70-3-80" id="h70-3-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h70-3-86" id="h70-3-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h70-3-88" id="h70-3-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h71" href="../file/tests/sql/query/limit.html">tests/sql/query/limit</a> b/<a href="../file/tests/sql/query/limit.html">tests/sql/query/limit</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -36,84 +36,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h71-0-3" id="h71-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h71-0-8" id="h71-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h71-0-12" id="h71-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-0-14" id="h71-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h71-0-19" id="h71-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h71-0-23" id="h71-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-0-25" id="h71-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h71-0-30" id="h71-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h71-0-34" id="h71-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h71-0-38" id="h71-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h71-0-43" id="h71-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h71-0-47" id="h71-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h71-0-51" id="h71-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h71-0-56" id="h71-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h71-0-60" id="h71-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-0-62" id="h71-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h71-0-67" id="h71-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h71-0-73" id="h71-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-0-75" id="h71-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h71-0-80" id="h71-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h71-0-86" id="h71-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-0-88" id="h71-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h71-1" id="h71-1" class="h">@@ -129,84 +123,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h71-1-3" id="h71-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h71-1-8" id="h71-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h71-1-12" id="h71-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-1-14" id="h71-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h71-1-19" id="h71-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h71-1-23" id="h71-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-1-25" id="h71-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h71-1-30" id="h71-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h71-1-34" id="h71-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h71-1-38" id="h71-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h71-1-43" id="h71-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h71-1-47" id="h71-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h71-1-51" id="h71-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h71-1-56" id="h71-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h71-1-60" id="h71-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-1-62" id="h71-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h71-1-67" id="h71-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h71-1-73" id="h71-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-1-75" id="h71-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h71-1-80" id="h71-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h71-1-86" id="h71-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h71-1-88" id="h71-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h72" href="../file/tests/sql/query/limit_expr.html">tests/sql/query/limit_expr</a> b/<a href="../file/tests/sql/query/limit_expr.html">tests/sql/query/limit_expr</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -45,84 +45,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h72-0-3" id="h72-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h72-0-8" id="h72-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h72-0-12" id="h72-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-0-14" id="h72-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h72-0-19" id="h72-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h72-0-23" id="h72-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-0-25" id="h72-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h72-0-30" id="h72-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h72-0-34" id="h72-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h72-0-38" id="h72-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h72-0-43" id="h72-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h72-0-47" id="h72-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h72-0-51" id="h72-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h72-0-56" id="h72-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h72-0-60" id="h72-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-0-62" id="h72-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h72-0-67" id="h72-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h72-0-73" id="h72-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-0-75" id="h72-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h72-0-80" id="h72-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h72-0-86" id="h72-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-0-88" id="h72-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h72-1" id="h72-1" class="h">@@ -138,84 +132,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h72-1-3" id="h72-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h72-1-8" id="h72-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h72-1-12" id="h72-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-1-14" id="h72-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h72-1-19" id="h72-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h72-1-23" id="h72-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-1-25" id="h72-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h72-1-30" id="h72-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h72-1-34" id="h72-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h72-1-38" id="h72-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h72-1-43" id="h72-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h72-1-47" id="h72-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h72-1-51" id="h72-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h72-1-56" id="h72-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h72-1-60" id="h72-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-1-62" id="h72-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h72-1-67" id="h72-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h72-1-73" id="h72-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-1-75" id="h72-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h72-1-80" id="h72-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h72-1-86" id="h72-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h72-1-88" id="h72-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h73" href="../file/tests/sql/query/limit_large.html">tests/sql/query/limit_large</a> b/<a href="../file/tests/sql/query/limit_large.html">tests/sql/query/limit_large</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -43,84 +43,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h73-0-3" id="h73-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h73-0-8" id="h73-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h73-0-12" id="h73-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-0-14" id="h73-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h73-0-19" id="h73-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h73-0-23" id="h73-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-0-25" id="h73-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h73-0-30" id="h73-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h73-0-34" id="h73-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h73-0-38" id="h73-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h73-0-43" id="h73-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h73-0-47" id="h73-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h73-0-51" id="h73-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h73-0-56" id="h73-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h73-0-60" id="h73-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-0-62" id="h73-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h73-0-67" id="h73-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h73-0-73" id="h73-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-0-75" id="h73-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h73-0-80" id="h73-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h73-0-86" id="h73-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-0-88" id="h73-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h73-1" id="h73-1" class="h">@@ -136,84 +130,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h73-1-3" id="h73-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h73-1-8" id="h73-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h73-1-12" id="h73-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-1-14" id="h73-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h73-1-19" id="h73-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h73-1-23" id="h73-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-1-25" id="h73-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h73-1-30" id="h73-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h73-1-34" id="h73-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h73-1-38" id="h73-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h73-1-43" id="h73-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h73-1-47" id="h73-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h73-1-51" id="h73-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h73-1-56" id="h73-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h73-1-60" id="h73-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-1-62" id="h73-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h73-1-67" id="h73-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h73-1-73" id="h73-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-1-75" id="h73-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h73-1-80" id="h73-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h73-1-86" id="h73-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h73-1-88" id="h73-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h74" href="../file/tests/sql/query/limit_offset.html">tests/sql/query/limit_offset</a> b/<a href="../file/tests/sql/query/limit_offset.html">tests/sql/query/limit_offset</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -43,84 +43,78 @@ Plan: Select(
</a>             source: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h74-0-3" id="h74-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h74-0-8" id="h74-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h74-0-12" id="h74-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-0-14" id="h74-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h74-0-19" id="h74-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h74-0-23" id="h74-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-0-25" id="h74-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h74-0-30" id="h74-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h74-0-34" id="h74-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h74-0-38" id="h74-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h74-0-43" id="h74-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h74-0-47" id="h74-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h74-0-51" id="h74-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h74-0-56" id="h74-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h74-0-60" id="h74-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-0-62" id="h74-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h74-0-67" id="h74-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h74-0-73" id="h74-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-0-75" id="h74-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h74-0-80" id="h74-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h74-0-86" id="h74-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-0-88" id="h74-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h74-1" id="h74-1" class="h">@@ -139,84 +133,78 @@ Optimized plan: Select(
</a>             source: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h74-1-3" id="h74-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h74-1-8" id="h74-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h74-1-12" id="h74-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-1-14" id="h74-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h74-1-19" id="h74-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h74-1-23" id="h74-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-1-25" id="h74-1-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h74-1-30" id="h74-1-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h74-1-34" id="h74-1-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h74-1-38" id="h74-1-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h74-1-43" id="h74-1-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h74-1-47" id="h74-1-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h74-1-51" id="h74-1-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h74-1-56" id="h74-1-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h74-1-60" id="h74-1-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-1-62" id="h74-1-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h74-1-67" id="h74-1-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h74-1-73" id="h74-1-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-1-75" id="h74-1-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h74-1-80" id="h74-1-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h74-1-86" id="h74-1-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h74-1-88" id="h74-1-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h75" href="../file/tests/sql/query/limit_zero.html">tests/sql/query/limit_zero</a> b/<a href="../file/tests/sql/query/limit_zero.html">tests/sql/query/limit_zero</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -33,84 +33,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h75-0-3" id="h75-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h75-0-8" id="h75-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h75-0-12" id="h75-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-0-14" id="h75-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h75-0-19" id="h75-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h75-0-23" id="h75-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-0-25" id="h75-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h75-0-30" id="h75-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h75-0-34" id="h75-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h75-0-38" id="h75-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h75-0-43" id="h75-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h75-0-47" id="h75-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h75-0-51" id="h75-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h75-0-56" id="h75-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h75-0-60" id="h75-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-0-62" id="h75-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h75-0-67" id="h75-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h75-0-73" id="h75-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-0-75" id="h75-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h75-0-80" id="h75-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h75-0-86" id="h75-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-0-88" id="h75-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h75-1" id="h75-1" class="h">@@ -126,84 +120,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h75-1-3" id="h75-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h75-1-8" id="h75-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h75-1-12" id="h75-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-1-14" id="h75-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h75-1-19" id="h75-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h75-1-23" id="h75-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-1-25" id="h75-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h75-1-30" id="h75-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h75-1-34" id="h75-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h75-1-38" id="h75-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h75-1-43" id="h75-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h75-1-47" id="h75-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h75-1-51" id="h75-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h75-1-56" id="h75-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h75-1-60" id="h75-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-1-62" id="h75-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h75-1-67" id="h75-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h75-1-73" id="h75-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-1-75" id="h75-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h75-1-80" id="h75-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h75-1-86" id="h75-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h75-1-88" id="h75-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h76" href="../file/tests/sql/query/offset.html">tests/sql/query/offset</a> b/<a href="../file/tests/sql/query/offset.html">tests/sql/query/offset</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -40,84 +40,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h76-0-3" id="h76-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h76-0-8" id="h76-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h76-0-12" id="h76-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-0-14" id="h76-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h76-0-19" id="h76-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h76-0-23" id="h76-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-0-25" id="h76-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h76-0-30" id="h76-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h76-0-34" id="h76-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h76-0-38" id="h76-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h76-0-43" id="h76-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h76-0-47" id="h76-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h76-0-51" id="h76-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h76-0-56" id="h76-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h76-0-60" id="h76-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-0-62" id="h76-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h76-0-67" id="h76-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h76-0-73" id="h76-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-0-75" id="h76-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h76-0-80" id="h76-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h76-0-86" id="h76-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-0-88" id="h76-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h76-1" id="h76-1" class="h">@@ -133,84 +127,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h76-1-3" id="h76-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h76-1-8" id="h76-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h76-1-12" id="h76-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-1-14" id="h76-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h76-1-19" id="h76-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h76-1-23" id="h76-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-1-25" id="h76-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h76-1-30" id="h76-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h76-1-34" id="h76-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h76-1-38" id="h76-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h76-1-43" id="h76-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h76-1-47" id="h76-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h76-1-51" id="h76-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h76-1-56" id="h76-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h76-1-60" id="h76-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-1-62" id="h76-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h76-1-67" id="h76-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h76-1-73" id="h76-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-1-75" id="h76-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h76-1-80" id="h76-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h76-1-86" id="h76-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h76-1-88" id="h76-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h77" href="../file/tests/sql/query/offset_expr.html">tests/sql/query/offset_expr</a> b/<a href="../file/tests/sql/query/offset_expr.html">tests/sql/query/offset_expr</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -49,84 +49,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h77-0-3" id="h77-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h77-0-8" id="h77-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h77-0-12" id="h77-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-0-14" id="h77-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h77-0-19" id="h77-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h77-0-23" id="h77-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-0-25" id="h77-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h77-0-30" id="h77-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h77-0-34" id="h77-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h77-0-38" id="h77-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h77-0-43" id="h77-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h77-0-47" id="h77-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h77-0-51" id="h77-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h77-0-56" id="h77-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h77-0-60" id="h77-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-0-62" id="h77-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h77-0-67" id="h77-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h77-0-73" id="h77-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-0-75" id="h77-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h77-0-80" id="h77-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h77-0-86" id="h77-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-0-88" id="h77-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h77-1" id="h77-1" class="h">@@ -142,84 +136,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h77-1-3" id="h77-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h77-1-8" id="h77-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h77-1-12" id="h77-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-1-14" id="h77-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h77-1-19" id="h77-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h77-1-23" id="h77-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-1-25" id="h77-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h77-1-30" id="h77-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h77-1-34" id="h77-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h77-1-38" id="h77-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h77-1-43" id="h77-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h77-1-47" id="h77-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h77-1-51" id="h77-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h77-1-56" id="h77-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h77-1-60" id="h77-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-1-62" id="h77-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h77-1-67" id="h77-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h77-1-73" id="h77-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-1-75" id="h77-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h77-1-80" id="h77-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h77-1-86" id="h77-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h77-1-88" id="h77-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h78" href="../file/tests/sql/query/offset_large.html">tests/sql/query/offset_large</a> b/<a href="../file/tests/sql/query/offset_large.html">tests/sql/query/offset_large</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -33,84 +33,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h78-0-3" id="h78-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h78-0-8" id="h78-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h78-0-12" id="h78-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-0-14" id="h78-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h78-0-19" id="h78-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h78-0-23" id="h78-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-0-25" id="h78-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h78-0-30" id="h78-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h78-0-34" id="h78-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h78-0-38" id="h78-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h78-0-43" id="h78-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h78-0-47" id="h78-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h78-0-51" id="h78-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h78-0-56" id="h78-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h78-0-60" id="h78-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-0-62" id="h78-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h78-0-67" id="h78-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h78-0-73" id="h78-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-0-75" id="h78-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h78-0-80" id="h78-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h78-0-86" id="h78-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-0-88" id="h78-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h78-1" id="h78-1" class="h">@@ -126,84 +120,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h78-1-3" id="h78-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h78-1-8" id="h78-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h78-1-12" id="h78-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-1-14" id="h78-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h78-1-19" id="h78-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h78-1-23" id="h78-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-1-25" id="h78-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h78-1-30" id="h78-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h78-1-34" id="h78-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h78-1-38" id="h78-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h78-1-43" id="h78-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h78-1-47" id="h78-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h78-1-51" id="h78-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h78-1-56" id="h78-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h78-1-60" id="h78-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-1-62" id="h78-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h78-1-67" id="h78-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h78-1-73" id="h78-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-1-75" id="h78-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h78-1-80" id="h78-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h78-1-86" id="h78-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h78-1-88" id="h78-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h79" href="../file/tests/sql/query/offset_zero.html">tests/sql/query/offset_zero</a> b/<a href="../file/tests/sql/query/offset_zero.html">tests/sql/query/offset_zero</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -43,84 +43,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h79-0-3" id="h79-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h79-0-8" id="h79-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h79-0-12" id="h79-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-0-14" id="h79-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h79-0-19" id="h79-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h79-0-23" id="h79-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-0-25" id="h79-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h79-0-30" id="h79-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h79-0-34" id="h79-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h79-0-38" id="h79-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h79-0-43" id="h79-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h79-0-47" id="h79-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h79-0-51" id="h79-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h79-0-56" id="h79-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h79-0-60" id="h79-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-0-62" id="h79-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h79-0-67" id="h79-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h79-0-73" id="h79-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-0-75" id="h79-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h79-0-80" id="h79-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h79-0-86" id="h79-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-0-88" id="h79-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h79-1" id="h79-1" class="h">@@ -136,84 +130,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h79-1-3" id="h79-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h79-1-8" id="h79-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h79-1-12" id="h79-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-1-14" id="h79-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h79-1-19" id="h79-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h79-1-23" id="h79-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-1-25" id="h79-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h79-1-30" id="h79-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h79-1-34" id="h79-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h79-1-38" id="h79-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h79-1-43" id="h79-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h79-1-47" id="h79-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h79-1-51" id="h79-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h79-1-56" id="h79-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h79-1-60" id="h79-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-1-62" id="h79-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h79-1-67" id="h79-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h79-1-73" id="h79-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-1-75" id="h79-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h79-1-80" id="h79-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h79-1-86" id="h79-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h79-1-88" id="h79-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h80" href="../file/tests/sql/query/order.html">tests/sql/query/order</a> b/<a href="../file/tests/sql/query/order.html">tests/sql/query/order</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -45,84 +45,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h80-0-3" id="h80-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h80-0-8" id="h80-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h80-0-12" id="h80-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-0-14" id="h80-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h80-0-19" id="h80-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h80-0-23" id="h80-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-0-25" id="h80-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h80-0-30" id="h80-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h80-0-34" id="h80-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h80-0-38" id="h80-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h80-0-43" id="h80-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h80-0-47" id="h80-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h80-0-51" id="h80-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h80-0-56" id="h80-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h80-0-60" id="h80-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-0-62" id="h80-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h80-0-67" id="h80-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h80-0-73" id="h80-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-0-75" id="h80-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h80-0-80" id="h80-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h80-0-86" id="h80-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-0-88" id="h80-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h80-1" id="h80-1" class="h">@@ -151,84 +145,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h80-1-3" id="h80-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h80-1-8" id="h80-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h80-1-12" id="h80-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-1-14" id="h80-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h80-1-19" id="h80-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h80-1-23" id="h80-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-1-25" id="h80-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h80-1-30" id="h80-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h80-1-34" id="h80-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h80-1-38" id="h80-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h80-1-43" id="h80-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h80-1-47" id="h80-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h80-1-51" id="h80-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h80-1-56" id="h80-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h80-1-60" id="h80-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-1-62" id="h80-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h80-1-67" id="h80-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h80-1-73" id="h80-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-1-75" id="h80-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h80-1-80" id="h80-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h80-1-86" id="h80-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h80-1-88" id="h80-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h81" href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a> b/<a href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -75,84 +75,78 @@ Plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h81-0-3" id="h81-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h81-0-8" id="h81-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h81-0-12" id="h81-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-0-14" id="h81-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h81-0-19" id="h81-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h81-0-23" id="h81-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-0-25" id="h81-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h81-0-30" id="h81-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h81-0-34" id="h81-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h81-0-38" id="h81-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h81-0-43" id="h81-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h81-0-47" id="h81-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h81-0-51" id="h81-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h81-0-56" id="h81-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h81-0-60" id="h81-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-0-62" id="h81-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h81-0-67" id="h81-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h81-0-73" id="h81-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-0-75" id="h81-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h81-0-80" id="h81-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h81-0-86" id="h81-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-0-88" id="h81-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h81-1" id="h81-1" class="h">@@ -234,84 +228,78 @@ Optimized plan: Select(
</a>                     source: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h81-1-3" id="h81-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h81-1-8" id="h81-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h81-1-12" id="h81-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-1-14" id="h81-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h81-1-19" id="h81-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h81-1-23" id="h81-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-1-25" id="h81-1-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h81-1-30" id="h81-1-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h81-1-34" id="h81-1-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h81-1-38" id="h81-1-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h81-1-43" id="h81-1-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h81-1-47" id="h81-1-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h81-1-51" id="h81-1-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h81-1-56" id="h81-1-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h81-1-60" id="h81-1-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-1-62" id="h81-1-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h81-1-67" id="h81-1-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h81-1-73" id="h81-1-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-1-75" id="h81-1-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h81-1-80" id="h81-1-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h81-1-86" id="h81-1-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h81-1-88" id="h81-1-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h82" href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a> b/<a href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a></b>
<a href="#h82-0" id="h82-0" class="h">@@ -77,84 +77,78 @@ Plan: Select(
</a>                         source: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h82-0-3" id="h82-0-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h82-0-8" id="h82-0-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h82-0-12" id="h82-0-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-0-14" id="h82-0-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h82-0-19" id="h82-0-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h82-0-23" id="h82-0-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-0-25" id="h82-0-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h82-0-30" id="h82-0-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h82-0-34" id="h82-0-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h82-0-38" id="h82-0-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h82-0-43" id="h82-0-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h82-0-47" id="h82-0-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h82-0-51" id="h82-0-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h82-0-56" id="h82-0-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h82-0-60" id="h82-0-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-0-62" id="h82-0-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h82-0-67" id="h82-0-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h82-0-73" id="h82-0-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-0-75" id="h82-0-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h82-0-80" id="h82-0-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h82-0-86" id="h82-0-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-0-88" id="h82-0-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h82-1" id="h82-1" class="h">@@ -274,84 +268,78 @@ Optimized plan: Select(
</a>                         source: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h82-1-3" id="h82-1-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h82-1-8" id="h82-1-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h82-1-12" id="h82-1-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-1-14" id="h82-1-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h82-1-19" id="h82-1-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h82-1-23" id="h82-1-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-1-25" id="h82-1-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h82-1-30" id="h82-1-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h82-1-34" id="h82-1-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h82-1-38" id="h82-1-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h82-1-43" id="h82-1-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h82-1-47" id="h82-1-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h82-1-51" id="h82-1-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h82-1-56" id="h82-1-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h82-1-60" id="h82-1-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-1-62" id="h82-1-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h82-1-67" id="h82-1-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h82-1-73" id="h82-1-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-1-75" id="h82-1-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h82-1-80" id="h82-1-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h82-1-86" id="h82-1-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h82-1-88" id="h82-1-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<b>diff --git a/<a id="h83" href="../file/tests/sql/query/order_asc.html">tests/sql/query/order_asc</a> b/<a href="../file/tests/sql/query/order_asc.html">tests/sql/query/order_asc</a></b>
<a href="#h83-0" id="h83-0" class="h">@@ -45,84 +45,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h83-0-3" id="h83-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h83-0-8" id="h83-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h83-0-12" id="h83-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-0-14" id="h83-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h83-0-19" id="h83-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h83-0-23" id="h83-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-0-25" id="h83-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h83-0-30" id="h83-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h83-0-34" id="h83-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h83-0-38" id="h83-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h83-0-43" id="h83-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h83-0-47" id="h83-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h83-0-51" id="h83-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h83-0-56" id="h83-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h83-0-60" id="h83-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-0-62" id="h83-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h83-0-67" id="h83-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h83-0-73" id="h83-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-0-75" id="h83-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h83-0-80" id="h83-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h83-0-86" id="h83-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-0-88" id="h83-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h83-1" id="h83-1" class="h">@@ -151,84 +145,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h83-1-3" id="h83-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h83-1-8" id="h83-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h83-1-12" id="h83-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-1-14" id="h83-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h83-1-19" id="h83-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h83-1-23" id="h83-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-1-25" id="h83-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h83-1-30" id="h83-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h83-1-34" id="h83-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h83-1-38" id="h83-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h83-1-43" id="h83-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h83-1-47" id="h83-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h83-1-51" id="h83-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h83-1-56" id="h83-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h83-1-60" id="h83-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-1-62" id="h83-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h83-1-67" id="h83-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h83-1-73" id="h83-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-1-75" id="h83-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h83-1-80" id="h83-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h83-1-86" id="h83-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h83-1-88" id="h83-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h84" href="../file/tests/sql/query/order_asc_lowercase.html">tests/sql/query/order_asc_lowercase</a> b/<a href="../file/tests/sql/query/order_asc_lowercase.html">tests/sql/query/order_asc_lowercase</a></b>
<a href="#h84-0" id="h84-0" class="h">@@ -45,84 +45,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h84-0-3" id="h84-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h84-0-8" id="h84-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h84-0-12" id="h84-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-0-14" id="h84-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h84-0-19" id="h84-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h84-0-23" id="h84-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-0-25" id="h84-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h84-0-30" id="h84-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h84-0-34" id="h84-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h84-0-38" id="h84-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h84-0-43" id="h84-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h84-0-47" id="h84-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h84-0-51" id="h84-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h84-0-56" id="h84-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h84-0-60" id="h84-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-0-62" id="h84-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h84-0-67" id="h84-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h84-0-73" id="h84-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-0-75" id="h84-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h84-0-80" id="h84-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h84-0-86" id="h84-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-0-88" id="h84-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h84-1" id="h84-1" class="h">@@ -151,84 +145,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h84-1-3" id="h84-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h84-1-8" id="h84-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h84-1-12" id="h84-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-1-14" id="h84-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h84-1-19" id="h84-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h84-1-23" id="h84-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-1-25" id="h84-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h84-1-30" id="h84-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h84-1-34" id="h84-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h84-1-38" id="h84-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h84-1-43" id="h84-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h84-1-47" id="h84-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h84-1-51" id="h84-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h84-1-56" id="h84-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h84-1-60" id="h84-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-1-62" id="h84-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h84-1-67" id="h84-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h84-1-73" id="h84-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-1-75" id="h84-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h84-1-80" id="h84-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h84-1-86" id="h84-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h84-1-88" id="h84-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h85" href="../file/tests/sql/query/order_boolean_asc.html">tests/sql/query/order_boolean_asc</a> b/<a href="../file/tests/sql/query/order_boolean_asc.html">tests/sql/query/order_boolean_asc</a></b>
<a href="#h85-0" id="h85-0" class="h">@@ -38,28 +38,27 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;booleans&quot;,
<a href="#h85-0-3" id="h85-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h85-0-8" id="h85-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h85-0-12" id="h85-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h85-0-14" id="h85-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Boolean,
<a href="#h85-0-19" id="h85-0-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h85-0-25" id="h85-0-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h85-0-27" id="h85-0-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h85-1" id="h85-1" class="h">@@ -88,28 +87,27 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;booleans&quot;,
<a href="#h85-1-3" id="h85-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h85-1-8" id="h85-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h85-1-12" id="h85-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h85-1-14" id="h85-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Boolean,
<a href="#h85-1-19" id="h85-1-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h85-1-25" id="h85-1-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h85-1-27" id="h85-1-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h86" href="../file/tests/sql/query/order_boolean_desc.html">tests/sql/query/order_boolean_desc</a> b/<a href="../file/tests/sql/query/order_boolean_desc.html">tests/sql/query/order_boolean_desc</a></b>
<a href="#h86-0" id="h86-0" class="h">@@ -38,28 +38,27 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;booleans&quot;,
<a href="#h86-0-3" id="h86-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h86-0-8" id="h86-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h86-0-12" id="h86-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h86-0-14" id="h86-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Boolean,
<a href="#h86-0-19" id="h86-0-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h86-0-25" id="h86-0-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h86-0-27" id="h86-0-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h86-1" id="h86-1" class="h">@@ -88,28 +87,27 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;booleans&quot;,
<a href="#h86-1-3" id="h86-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h86-1-8" id="h86-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h86-1-12" id="h86-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h86-1-14" id="h86-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Boolean,
<a href="#h86-1-19" id="h86-1-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h86-1-25" id="h86-1-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h86-1-27" id="h86-1-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h87" href="../file/tests/sql/query/order_desc.html">tests/sql/query/order_desc</a> b/<a href="../file/tests/sql/query/order_desc.html">tests/sql/query/order_desc</a></b>
<a href="#h87-0" id="h87-0" class="h">@@ -45,84 +45,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h87-0-3" id="h87-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h87-0-8" id="h87-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h87-0-12" id="h87-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-0-14" id="h87-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h87-0-19" id="h87-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h87-0-23" id="h87-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-0-25" id="h87-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h87-0-30" id="h87-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h87-0-34" id="h87-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h87-0-38" id="h87-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h87-0-43" id="h87-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h87-0-47" id="h87-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h87-0-51" id="h87-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h87-0-56" id="h87-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h87-0-60" id="h87-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-0-62" id="h87-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h87-0-67" id="h87-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h87-0-73" id="h87-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-0-75" id="h87-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h87-0-80" id="h87-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h87-0-86" id="h87-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-0-88" id="h87-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h87-1" id="h87-1" class="h">@@ -151,84 +145,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h87-1-3" id="h87-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h87-1-8" id="h87-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h87-1-12" id="h87-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-1-14" id="h87-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h87-1-19" id="h87-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h87-1-23" id="h87-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-1-25" id="h87-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h87-1-30" id="h87-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h87-1-34" id="h87-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h87-1-38" id="h87-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h87-1-43" id="h87-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h87-1-47" id="h87-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h87-1-51" id="h87-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h87-1-56" id="h87-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h87-1-60" id="h87-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-1-62" id="h87-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h87-1-67" id="h87-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h87-1-73" id="h87-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-1-75" id="h87-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h87-1-80" id="h87-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h87-1-86" id="h87-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h87-1-88" id="h87-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h88" href="../file/tests/sql/query/order_desc_lowercase.html">tests/sql/query/order_desc_lowercase</a> b/<a href="../file/tests/sql/query/order_desc_lowercase.html">tests/sql/query/order_desc_lowercase</a></b>
<a href="#h88-0" id="h88-0" class="h">@@ -45,84 +45,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h88-0-3" id="h88-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h88-0-8" id="h88-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h88-0-12" id="h88-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-0-14" id="h88-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h88-0-19" id="h88-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h88-0-23" id="h88-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-0-25" id="h88-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h88-0-30" id="h88-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h88-0-34" id="h88-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h88-0-38" id="h88-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h88-0-43" id="h88-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h88-0-47" id="h88-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h88-0-51" id="h88-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h88-0-56" id="h88-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h88-0-60" id="h88-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-0-62" id="h88-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h88-0-67" id="h88-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h88-0-73" id="h88-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-0-75" id="h88-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h88-0-80" id="h88-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h88-0-86" id="h88-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-0-88" id="h88-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h88-1" id="h88-1" class="h">@@ -151,84 +145,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h88-1-3" id="h88-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h88-1-8" id="h88-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h88-1-12" id="h88-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-1-14" id="h88-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h88-1-19" id="h88-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h88-1-23" id="h88-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-1-25" id="h88-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h88-1-30" id="h88-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h88-1-34" id="h88-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h88-1-38" id="h88-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h88-1-43" id="h88-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h88-1-47" id="h88-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h88-1-51" id="h88-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h88-1-56" id="h88-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h88-1-60" id="h88-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-1-62" id="h88-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h88-1-67" id="h88-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h88-1-73" id="h88-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-1-75" id="h88-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h88-1-80" id="h88-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h88-1-86" id="h88-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h88-1-88" id="h88-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h89" href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a> b/<a href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a></b>
<a href="#h89-0" id="h89-0" class="h">@@ -96,84 +96,78 @@ Plan: Select(
</a>             source: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h89-0-3" id="h89-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h89-0-8" id="h89-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h89-0-12" id="h89-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-0-14" id="h89-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h89-0-19" id="h89-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h89-0-23" id="h89-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-0-25" id="h89-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h89-0-30" id="h89-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h89-0-34" id="h89-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h89-0-38" id="h89-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h89-0-43" id="h89-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h89-0-47" id="h89-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h89-0-51" id="h89-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h89-0-56" id="h89-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h89-0-60" id="h89-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-0-62" id="h89-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h89-0-67" id="h89-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h89-0-73" id="h89-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-0-75" id="h89-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h89-0-80" id="h89-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h89-0-86" id="h89-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-0-88" id="h89-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h89-1" id="h89-1" class="h">@@ -263,84 +257,78 @@ Optimized plan: Select(
</a>             source: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h89-1-3" id="h89-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h89-1-8" id="h89-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h89-1-12" id="h89-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-1-14" id="h89-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h89-1-19" id="h89-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h89-1-23" id="h89-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-1-25" id="h89-1-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h89-1-30" id="h89-1-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h89-1-34" id="h89-1-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h89-1-38" id="h89-1-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h89-1-43" id="h89-1-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h89-1-47" id="h89-1-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h89-1-51" id="h89-1-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h89-1-56" id="h89-1-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h89-1-60" id="h89-1-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-1-62" id="h89-1-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h89-1-67" id="h89-1-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h89-1-73" id="h89-1-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-1-75" id="h89-1-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h89-1-80" id="h89-1-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h89-1-86" id="h89-1-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h89-1-88" id="h89-1-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h90" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h90-0" id="h90-0" class="h">@@ -107,84 +107,78 @@ Plan: Select(
</a>                     left: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h90-0-3" id="h90-0-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h90-0-8" id="h90-0-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h90-0-12" id="h90-0-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h90-0-14" id="h90-0-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h90-0-19" id="h90-0-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h90-0-23" id="h90-0-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h90-0-25" id="h90-0-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h90-0-30" id="h90-0-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h90-0-34" id="h90-0-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h90-0-38" id="h90-0-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h90-0-43" id="h90-0-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h90-0-47" id="h90-0-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h90-0-51" id="h90-0-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h90-0-56" id="h90-0-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h90-0-60" id="h90-0-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h90-0-62" id="h90-0-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h90-0-67" id="h90-0-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h90-0-73" id="h90-0-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h90-0-75" id="h90-0-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h90-0-80" id="h90-0-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h90-0-86" id="h90-0-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h90-0-88" id="h90-0-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h90-1" id="h90-1" class="h">@@ -195,26 +189,25 @@ Plan: Select(
</a>                     right: Scan {
                         table: Table {
                             name: &quot;genres&quot;,
<a href="#h90-1-3" id="h90-1-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h90-1-8" id="h90-1-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h90-1-12" id="h90-1-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h90-1-14" id="h90-1-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;name&quot;,
                                     datatype: String,
<a href="#h90-1-19" id="h90-1-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h90-1-23" id="h90-1-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h90-1-25" id="h90-1-25" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h90-2" id="h90-2" class="h">@@ -332,84 +325,78 @@ Optimized plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h90-2-3" id="h90-2-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h90-2-8" id="h90-2-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h90-2-12" id="h90-2-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h90-2-14" id="h90-2-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h90-2-19" id="h90-2-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h90-2-23" id="h90-2-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h90-2-25" id="h90-2-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h90-2-30" id="h90-2-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h90-2-34" id="h90-2-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h90-2-38" id="h90-2-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h90-2-43" id="h90-2-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h90-2-47" id="h90-2-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h90-2-51" id="h90-2-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h90-2-56" id="h90-2-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h90-2-60" id="h90-2-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h90-2-62" id="h90-2-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h90-2-67" id="h90-2-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h90-2-73" id="h90-2-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h90-2-75" id="h90-2-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h90-2-80" id="h90-2-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h90-2-86" id="h90-2-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h90-2-88" id="h90-2-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h90-3" id="h90-3" class="h">@@ -430,26 +417,25 @@ Optimized plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h90-3-3" id="h90-3-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h90-3-8" id="h90-3-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h90-3-12" id="h90-3-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h90-3-14" id="h90-3-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h90-3-19" id="h90-3-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h90-3-23" id="h90-3-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h90-3-25" id="h90-3-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h91" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h91-0" id="h91-0" class="h">@@ -109,84 +109,78 @@ Plan: Select(
</a>                         left: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h91-0-3" id="h91-0-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h91-0-8" id="h91-0-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h91-0-12" id="h91-0-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h91-0-14" id="h91-0-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h91-0-19" id="h91-0-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h91-0-23" id="h91-0-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h91-0-25" id="h91-0-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h91-0-30" id="h91-0-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h91-0-34" id="h91-0-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h91-0-38" id="h91-0-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h91-0-43" id="h91-0-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h91-0-47" id="h91-0-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h91-0-51" id="h91-0-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h91-0-56" id="h91-0-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h91-0-60" id="h91-0-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h91-0-62" id="h91-0-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h91-0-67" id="h91-0-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h91-0-73" id="h91-0-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h91-0-75" id="h91-0-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h91-0-80" id="h91-0-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h91-0-86" id="h91-0-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h91-0-88" id="h91-0-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h91-1" id="h91-1" class="h">@@ -197,26 +191,25 @@ Plan: Select(
</a>                         right: Scan {
                             table: Table {
                                 name: &quot;genres&quot;,
<a href="#h91-1-3" id="h91-1-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h91-1-8" id="h91-1-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h91-1-12" id="h91-1-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h91-1-14" id="h91-1-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;name&quot;,
                                         datatype: String,
<a href="#h91-1-19" id="h91-1-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h91-1-23" id="h91-1-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h91-1-25" id="h91-1-25" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h91-2" id="h91-2" class="h">@@ -385,84 +378,78 @@ Optimized plan: Select(
</a>                     left: Scan {
                         table: Table {
                             name: &quot;movies&quot;,
<a href="#h91-2-3" id="h91-2-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h91-2-8" id="h91-2-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h91-2-12" id="h91-2-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h91-2-14" id="h91-2-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;title&quot;,
                                     datatype: String,
<a href="#h91-2-19" id="h91-2-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h91-2-23" id="h91-2-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h91-2-25" id="h91-2-25" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;studio_id&quot;,
                                     datatype: Integer,
<a href="#h91-2-30" id="h91-2-30" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h91-2-34" id="h91-2-34" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;studios&quot;,
                                     ),
<a href="#h91-2-38" id="h91-2-38" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;genre_id&quot;,
                                     datatype: Integer,
<a href="#h91-2-43" id="h91-2-43" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h91-2-47" id="h91-2-47" class="i">+                                    index: true,
</a>                                     references: Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h91-2-51" id="h91-2-51" class="d">-                                    index: true,
</a>                                 },
                                 Column {
                                     name: &quot;released&quot;,
                                     datatype: Integer,
<a href="#h91-2-56" id="h91-2-56" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h91-2-60" id="h91-2-60" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h91-2-62" id="h91-2-62" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;rating&quot;,
                                     datatype: Float,
<a href="#h91-2-67" id="h91-2-67" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h91-2-73" id="h91-2-73" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h91-2-75" id="h91-2-75" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;ultrahd&quot;,
                                     datatype: Boolean,
<a href="#h91-2-80" id="h91-2-80" class="d">-                                    primary_key: false,
</a>                                     nullable: true,
                                     default: Some(
                                         Null,
                                     ),
                                     unique: false,
<a href="#h91-2-86" id="h91-2-86" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h91-2-88" id="h91-2-88" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<a href="#h91-3" id="h91-3" class="h">@@ -483,26 +470,25 @@ Optimized plan: Select(
</a>                     right: Scan {
                         table: Table {
                             name: &quot;genres&quot;,
<a href="#h91-3-3" id="h91-3-3" class="i">+                            primary_key: 0,
</a>                             columns: [
                                 Column {
                                     name: &quot;id&quot;,
                                     datatype: Integer,
<a href="#h91-3-8" id="h91-3-8" class="d">-                                    primary_key: true,
</a>                                     nullable: false,
                                     default: None,
                                     unique: true,
<a href="#h91-3-12" id="h91-3-12" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h91-3-14" id="h91-3-14" class="i">+                                    references: None,
</a>                                 },
                                 Column {
                                     name: &quot;name&quot;,
                                     datatype: String,
<a href="#h91-3-19" id="h91-3-19" class="d">-                                    primary_key: false,
</a>                                     nullable: false,
                                     default: None,
                                     unique: false,
<a href="#h91-3-23" id="h91-3-23" class="d">-                                    references: None,
</a>                                     index: false,
<a href="#h91-3-25" id="h91-3-25" class="i">+                                    references: None,
</a>                                 },
                             ],
                         },
<b>diff --git a/<a id="h92" href="../file/tests/sql/query/order_float_asc.html">tests/sql/query/order_float_asc</a> b/<a href="../file/tests/sql/query/order_float_asc.html">tests/sql/query/order_float_asc</a></b>
<a href="#h92-0" id="h92-0" class="h">@@ -40,28 +40,27 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;floats&quot;,
<a href="#h92-0-3" id="h92-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h92-0-8" id="h92-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h92-0-12" id="h92-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h92-0-14" id="h92-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Float,
<a href="#h92-0-19" id="h92-0-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h92-0-25" id="h92-0-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h92-0-27" id="h92-0-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h92-1" id="h92-1" class="h">@@ -90,28 +89,27 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;floats&quot;,
<a href="#h92-1-3" id="h92-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h92-1-8" id="h92-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h92-1-12" id="h92-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h92-1-14" id="h92-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Float,
<a href="#h92-1-19" id="h92-1-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h92-1-25" id="h92-1-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h92-1-27" id="h92-1-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h93" href="../file/tests/sql/query/order_float_desc.html">tests/sql/query/order_float_desc</a> b/<a href="../file/tests/sql/query/order_float_desc.html">tests/sql/query/order_float_desc</a></b>
<a href="#h93-0" id="h93-0" class="h">@@ -40,28 +40,27 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;floats&quot;,
<a href="#h93-0-3" id="h93-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h93-0-8" id="h93-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h93-0-12" id="h93-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h93-0-14" id="h93-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Float,
<a href="#h93-0-19" id="h93-0-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h93-0-25" id="h93-0-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h93-0-27" id="h93-0-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h93-1" id="h93-1" class="h">@@ -90,28 +89,27 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;floats&quot;,
<a href="#h93-1-3" id="h93-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h93-1-8" id="h93-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h93-1-12" id="h93-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h93-1-14" id="h93-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Float,
<a href="#h93-1-19" id="h93-1-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h93-1-25" id="h93-1-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h93-1-27" id="h93-1-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h94" href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a> b/<a href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a></b>
<a href="#h94-0" id="h94-0" class="h">@@ -65,84 +65,78 @@ Plan: Select(
</a>                         source: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h94-0-3" id="h94-0-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h94-0-8" id="h94-0-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h94-0-12" id="h94-0-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-0-14" id="h94-0-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h94-0-19" id="h94-0-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h94-0-23" id="h94-0-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-0-25" id="h94-0-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h94-0-30" id="h94-0-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h94-0-34" id="h94-0-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h94-0-38" id="h94-0-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h94-0-43" id="h94-0-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h94-0-47" id="h94-0-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h94-0-51" id="h94-0-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h94-0-56" id="h94-0-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h94-0-60" id="h94-0-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-0-62" id="h94-0-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h94-0-67" id="h94-0-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h94-0-73" id="h94-0-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-0-75" id="h94-0-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h94-0-80" id="h94-0-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h94-0-86" id="h94-0-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-0-88" id="h94-0-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<a href="#h94-1" id="h94-1" class="h">@@ -242,84 +236,78 @@ Optimized plan: Select(
</a>                         source: Scan {
                             table: Table {
                                 name: &quot;movies&quot;,
<a href="#h94-1-3" id="h94-1-3" class="i">+                                primary_key: 0,
</a>                                 columns: [
                                     Column {
                                         name: &quot;id&quot;,
                                         datatype: Integer,
<a href="#h94-1-8" id="h94-1-8" class="d">-                                        primary_key: true,
</a>                                         nullable: false,
                                         default: None,
                                         unique: true,
<a href="#h94-1-12" id="h94-1-12" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-1-14" id="h94-1-14" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;title&quot;,
                                         datatype: String,
<a href="#h94-1-19" id="h94-1-19" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h94-1-23" id="h94-1-23" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-1-25" id="h94-1-25" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;studio_id&quot;,
                                         datatype: Integer,
<a href="#h94-1-30" id="h94-1-30" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h94-1-34" id="h94-1-34" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;studios&quot;,
                                         ),
<a href="#h94-1-38" id="h94-1-38" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;genre_id&quot;,
                                         datatype: Integer,
<a href="#h94-1-43" id="h94-1-43" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h94-1-47" id="h94-1-47" class="i">+                                        index: true,
</a>                                         references: Some(
                                             &quot;genres&quot;,
                                         ),
<a href="#h94-1-51" id="h94-1-51" class="d">-                                        index: true,
</a>                                     },
                                     Column {
                                         name: &quot;released&quot;,
                                         datatype: Integer,
<a href="#h94-1-56" id="h94-1-56" class="d">-                                        primary_key: false,
</a>                                         nullable: false,
                                         default: None,
                                         unique: false,
<a href="#h94-1-60" id="h94-1-60" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-1-62" id="h94-1-62" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;rating&quot;,
                                         datatype: Float,
<a href="#h94-1-67" id="h94-1-67" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h94-1-73" id="h94-1-73" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-1-75" id="h94-1-75" class="i">+                                        references: None,
</a>                                     },
                                     Column {
                                         name: &quot;ultrahd&quot;,
                                         datatype: Boolean,
<a href="#h94-1-80" id="h94-1-80" class="d">-                                        primary_key: false,
</a>                                         nullable: true,
                                         default: Some(
                                             Null,
                                         ),
                                         unique: false,
<a href="#h94-1-86" id="h94-1-86" class="d">-                                        references: None,
</a>                                         index: false,
<a href="#h94-1-88" id="h94-1-88" class="i">+                                        references: None,
</a>                                     },
                                 ],
                             },
<b>diff --git a/<a id="h95" href="../file/tests/sql/query/order_integer_asc.html">tests/sql/query/order_integer_asc</a> b/<a href="../file/tests/sql/query/order_integer_asc.html">tests/sql/query/order_integer_asc</a></b>
<a href="#h95-0" id="h95-0" class="h">@@ -40,28 +40,27 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;integers&quot;,
<a href="#h95-0-3" id="h95-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h95-0-8" id="h95-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h95-0-12" id="h95-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h95-0-14" id="h95-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Integer,
<a href="#h95-0-19" id="h95-0-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h95-0-25" id="h95-0-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h95-0-27" id="h95-0-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h95-1" id="h95-1" class="h">@@ -90,28 +89,27 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;integers&quot;,
<a href="#h95-1-3" id="h95-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h95-1-8" id="h95-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h95-1-12" id="h95-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h95-1-14" id="h95-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Integer,
<a href="#h95-1-19" id="h95-1-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h95-1-25" id="h95-1-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h95-1-27" id="h95-1-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h96" href="../file/tests/sql/query/order_integer_desc.html">tests/sql/query/order_integer_desc</a> b/<a href="../file/tests/sql/query/order_integer_desc.html">tests/sql/query/order_integer_desc</a></b>
<a href="#h96-0" id="h96-0" class="h">@@ -40,28 +40,27 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;integers&quot;,
<a href="#h96-0-3" id="h96-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h96-0-8" id="h96-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h96-0-12" id="h96-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h96-0-14" id="h96-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Integer,
<a href="#h96-0-19" id="h96-0-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h96-0-25" id="h96-0-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h96-0-27" id="h96-0-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h96-1" id="h96-1" class="h">@@ -90,28 +89,27 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;integers&quot;,
<a href="#h96-1-3" id="h96-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h96-1-8" id="h96-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h96-1-12" id="h96-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h96-1-14" id="h96-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: Integer,
<a href="#h96-1-19" id="h96-1-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h96-1-25" id="h96-1-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h96-1-27" id="h96-1-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h97" href="../file/tests/sql/query/order_multi.html">tests/sql/query/order_multi</a> b/<a href="../file/tests/sql/query/order_multi.html">tests/sql/query/order_multi</a></b>
<a href="#h97-0" id="h97-0" class="h">@@ -52,84 +52,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h97-0-3" id="h97-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h97-0-8" id="h97-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h97-0-12" id="h97-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-0-14" id="h97-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h97-0-19" id="h97-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h97-0-23" id="h97-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-0-25" id="h97-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h97-0-30" id="h97-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h97-0-34" id="h97-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h97-0-38" id="h97-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h97-0-43" id="h97-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h97-0-47" id="h97-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h97-0-51" id="h97-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h97-0-56" id="h97-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h97-0-60" id="h97-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-0-62" id="h97-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h97-0-67" id="h97-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h97-0-73" id="h97-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-0-75" id="h97-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h97-0-80" id="h97-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h97-0-86" id="h97-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-0-88" id="h97-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h97-1" id="h97-1" class="h">@@ -170,84 +164,78 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h97-1-3" id="h97-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h97-1-8" id="h97-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h97-1-12" id="h97-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-1-14" id="h97-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h97-1-19" id="h97-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h97-1-23" id="h97-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-1-25" id="h97-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h97-1-30" id="h97-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h97-1-34" id="h97-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h97-1-38" id="h97-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h97-1-43" id="h97-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h97-1-47" id="h97-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h97-1-51" id="h97-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h97-1-56" id="h97-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h97-1-60" id="h97-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-1-62" id="h97-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h97-1-67" id="h97-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h97-1-73" id="h97-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-1-75" id="h97-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h97-1-80" id="h97-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h97-1-86" id="h97-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h97-1-88" id="h97-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h98" href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a> b/<a href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a></b>
<a href="#h98-0" id="h98-0" class="h">@@ -64,84 +64,78 @@ Plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h98-0-3" id="h98-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h98-0-8" id="h98-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h98-0-12" id="h98-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-0-14" id="h98-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h98-0-19" id="h98-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h98-0-23" id="h98-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-0-25" id="h98-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h98-0-30" id="h98-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h98-0-34" id="h98-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h98-0-38" id="h98-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h98-0-43" id="h98-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h98-0-47" id="h98-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h98-0-51" id="h98-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h98-0-56" id="h98-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h98-0-60" id="h98-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-0-62" id="h98-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h98-0-67" id="h98-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h98-0-73" id="h98-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-0-75" id="h98-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h98-0-80" id="h98-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h98-0-86" id="h98-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-0-88" id="h98-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h98-1" id="h98-1" class="h">@@ -230,84 +224,78 @@ Optimized plan: Select(
</a>                 source: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h98-1-3" id="h98-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h98-1-8" id="h98-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h98-1-12" id="h98-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-1-14" id="h98-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h98-1-19" id="h98-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h98-1-23" id="h98-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-1-25" id="h98-1-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h98-1-30" id="h98-1-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h98-1-34" id="h98-1-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h98-1-38" id="h98-1-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h98-1-43" id="h98-1-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h98-1-47" id="h98-1-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h98-1-51" id="h98-1-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h98-1-56" id="h98-1-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h98-1-60" id="h98-1-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-1-62" id="h98-1-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h98-1-67" id="h98-1-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h98-1-73" id="h98-1-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-1-75" id="h98-1-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h98-1-80" id="h98-1-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h98-1-86" id="h98-1-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h98-1-88" id="h98-1-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<b>diff --git a/<a id="h99" href="../file/tests/sql/query/order_string_asc.html">tests/sql/query/order_string_asc</a> b/<a href="../file/tests/sql/query/order_string_asc.html">tests/sql/query/order_string_asc</a></b>
<a href="#h99-0" id="h99-0" class="h">@@ -43,28 +43,27 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;strings&quot;,
<a href="#h99-0-3" id="h99-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h99-0-8" id="h99-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h99-0-12" id="h99-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h99-0-14" id="h99-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: String,
<a href="#h99-0-19" id="h99-0-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h99-0-25" id="h99-0-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h99-0-27" id="h99-0-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h99-1" id="h99-1" class="h">@@ -93,28 +92,27 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;strings&quot;,
<a href="#h99-1-3" id="h99-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h99-1-8" id="h99-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h99-1-12" id="h99-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h99-1-14" id="h99-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: String,
<a href="#h99-1-19" id="h99-1-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h99-1-25" id="h99-1-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h99-1-27" id="h99-1-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h100" href="../file/tests/sql/query/order_string_desc.html">tests/sql/query/order_string_desc</a> b/<a href="../file/tests/sql/query/order_string_desc.html">tests/sql/query/order_string_desc</a></b>
<a href="#h100-0" id="h100-0" class="h">@@ -43,28 +43,27 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;strings&quot;,
<a href="#h100-0-3" id="h100-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h100-0-8" id="h100-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h100-0-12" id="h100-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h100-0-14" id="h100-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: String,
<a href="#h100-0-19" id="h100-0-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h100-0-25" id="h100-0-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h100-0-27" id="h100-0-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h100-1" id="h100-1" class="h">@@ -93,28 +92,27 @@ Optimized plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;strings&quot;,
<a href="#h100-1-3" id="h100-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h100-1-8" id="h100-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h100-1-12" id="h100-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h100-1-14" id="h100-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;value&quot;,
                         datatype: String,
<a href="#h100-1-19" id="h100-1-19" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h100-1-25" id="h100-1-25" class="d">-                        references: None,
</a>                         index: false,
<a href="#h100-1-27" id="h100-1-27" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h101" href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a> b/<a href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a></b>
<a href="#h101-0" id="h101-0" class="h">@@ -53,84 +53,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h101-0-3" id="h101-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h101-0-8" id="h101-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h101-0-12" id="h101-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h101-0-14" id="h101-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h101-0-19" id="h101-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h101-0-23" id="h101-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h101-0-25" id="h101-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h101-0-30" id="h101-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h101-0-34" id="h101-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h101-0-38" id="h101-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h101-0-43" id="h101-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h101-0-47" id="h101-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h101-0-51" id="h101-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h101-0-56" id="h101-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h101-0-60" id="h101-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h101-0-62" id="h101-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h101-0-67" id="h101-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h101-0-73" id="h101-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h101-0-75" id="h101-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h101-0-80" id="h101-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h101-0-86" id="h101-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h101-0-88" id="h101-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h101-1" id="h101-1" class="h">@@ -189,84 +183,78 @@ Optimized plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h101-1-3" id="h101-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h101-1-8" id="h101-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h101-1-12" id="h101-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h101-1-14" id="h101-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h101-1-19" id="h101-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h101-1-23" id="h101-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h101-1-25" id="h101-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h101-1-30" id="h101-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h101-1-34" id="h101-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h101-1-38" id="h101-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h101-1-43" id="h101-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h101-1-47" id="h101-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h101-1-51" id="h101-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h101-1-56" id="h101-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h101-1-60" id="h101-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h101-1-62" id="h101-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h101-1-67" id="h101-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h101-1-73" id="h101-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h101-1-75" id="h101-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h101-1-80" id="h101-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h101-1-86" id="h101-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h101-1-88" id="h101-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h102" href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a> b/<a href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a></b>
<a href="#h102-0" id="h102-0" class="h">@@ -32,84 +32,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h102-0-3" id="h102-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h102-0-8" id="h102-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h102-0-12" id="h102-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h102-0-14" id="h102-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h102-0-19" id="h102-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h102-0-23" id="h102-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h102-0-25" id="h102-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h102-0-30" id="h102-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h102-0-34" id="h102-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h102-0-38" id="h102-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h102-0-43" id="h102-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h102-0-47" id="h102-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h102-0-51" id="h102-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h102-0-56" id="h102-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h102-0-60" id="h102-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h102-0-62" id="h102-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h102-0-67" id="h102-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h102-0-73" id="h102-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h102-0-75" id="h102-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h102-0-80" id="h102-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h102-0-86" id="h102-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h102-0-88" id="h102-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h102-1" id="h102-1" class="h">@@ -128,84 +122,78 @@ Optimized plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h102-1-3" id="h102-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h102-1-8" id="h102-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h102-1-12" id="h102-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h102-1-14" id="h102-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h102-1-19" id="h102-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h102-1-23" id="h102-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h102-1-25" id="h102-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h102-1-30" id="h102-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h102-1-34" id="h102-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h102-1-38" id="h102-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h102-1-43" id="h102-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h102-1-47" id="h102-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h102-1-51" id="h102-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h102-1-56" id="h102-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h102-1-60" id="h102-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h102-1-62" id="h102-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h102-1-67" id="h102-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h102-1-73" id="h102-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h102-1-75" id="h102-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h102-1-80" id="h102-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h102-1-86" id="h102-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h102-1-88" id="h102-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h103" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h103-0" id="h103-0" class="h">@@ -101,84 +101,78 @@ Plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h103-0-3" id="h103-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h103-0-8" id="h103-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h103-0-12" id="h103-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h103-0-14" id="h103-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h103-0-19" id="h103-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h103-0-23" id="h103-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h103-0-25" id="h103-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h103-0-30" id="h103-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h103-0-34" id="h103-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h103-0-38" id="h103-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h103-0-43" id="h103-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h103-0-47" id="h103-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h103-0-51" id="h103-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h103-0-56" id="h103-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h103-0-60" id="h103-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h103-0-62" id="h103-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h103-0-67" id="h103-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h103-0-73" id="h103-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h103-0-75" id="h103-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h103-0-80" id="h103-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h103-0-86" id="h103-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h103-0-88" id="h103-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h103-1" id="h103-1" class="h">@@ -191,26 +185,25 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h103-1-3" id="h103-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h103-1-8" id="h103-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h103-1-12" id="h103-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h103-1-14" id="h103-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h103-1-19" id="h103-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h103-1-23" id="h103-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h103-1-25" id="h103-1-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h103-2" id="h103-2" class="h">@@ -320,84 +313,78 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h103-2-3" id="h103-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h103-2-8" id="h103-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h103-2-12" id="h103-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h103-2-14" id="h103-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h103-2-19" id="h103-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h103-2-23" id="h103-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h103-2-25" id="h103-2-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h103-2-30" id="h103-2-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h103-2-34" id="h103-2-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h103-2-38" id="h103-2-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h103-2-43" id="h103-2-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h103-2-47" id="h103-2-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h103-2-51" id="h103-2-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h103-2-56" id="h103-2-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h103-2-60" id="h103-2-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h103-2-62" id="h103-2-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h103-2-67" id="h103-2-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h103-2-73" id="h103-2-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h103-2-75" id="h103-2-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h103-2-80" id="h103-2-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h103-2-86" id="h103-2-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h103-2-88" id="h103-2-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h103-3" id="h103-3" class="h">@@ -449,26 +436,25 @@ Optimized plan: Select(
</a>             right: KeyLookup {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h103-3-3" id="h103-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h103-3-8" id="h103-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h103-3-12" id="h103-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h103-3-14" id="h103-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h103-3-19" id="h103-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h103-3-23" id="h103-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h103-3-25" id="h103-3-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h104" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h104-0" id="h104-0" class="h">@@ -97,84 +97,78 @@ Plan: Select(
</a>                 left: Scan {
                     table: Table {
                         name: &quot;movies&quot;,
<a href="#h104-0-3" id="h104-0-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h104-0-8" id="h104-0-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h104-0-12" id="h104-0-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h104-0-14" id="h104-0-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;title&quot;,
                                 datatype: String,
<a href="#h104-0-19" id="h104-0-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h104-0-23" id="h104-0-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h104-0-25" id="h104-0-25" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;studio_id&quot;,
                                 datatype: Integer,
<a href="#h104-0-30" id="h104-0-30" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h104-0-34" id="h104-0-34" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;studios&quot;,
                                 ),
<a href="#h104-0-38" id="h104-0-38" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;genre_id&quot;,
                                 datatype: Integer,
<a href="#h104-0-43" id="h104-0-43" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h104-0-47" id="h104-0-47" class="i">+                                index: true,
</a>                                 references: Some(
                                     &quot;genres&quot;,
                                 ),
<a href="#h104-0-51" id="h104-0-51" class="d">-                                index: true,
</a>                             },
                             Column {
                                 name: &quot;released&quot;,
                                 datatype: Integer,
<a href="#h104-0-56" id="h104-0-56" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h104-0-60" id="h104-0-60" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h104-0-62" id="h104-0-62" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;rating&quot;,
                                 datatype: Float,
<a href="#h104-0-67" id="h104-0-67" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h104-0-73" id="h104-0-73" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h104-0-75" id="h104-0-75" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;ultrahd&quot;,
                                 datatype: Boolean,
<a href="#h104-0-80" id="h104-0-80" class="d">-                                primary_key: false,
</a>                                 nullable: true,
                                 default: Some(
                                     Null,
                                 ),
                                 unique: false,
<a href="#h104-0-86" id="h104-0-86" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h104-0-88" id="h104-0-88" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h104-1" id="h104-1" class="h">@@ -185,26 +179,25 @@ Plan: Select(
</a>                 right: Scan {
                     table: Table {
                         name: &quot;genres&quot;,
<a href="#h104-1-3" id="h104-1-3" class="i">+                        primary_key: 0,
</a>                         columns: [
                             Column {
                                 name: &quot;id&quot;,
                                 datatype: Integer,
<a href="#h104-1-8" id="h104-1-8" class="d">-                                primary_key: true,
</a>                                 nullable: false,
                                 default: None,
                                 unique: true,
<a href="#h104-1-12" id="h104-1-12" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h104-1-14" id="h104-1-14" class="i">+                                references: None,
</a>                             },
                             Column {
                                 name: &quot;name&quot;,
                                 datatype: String,
<a href="#h104-1-19" id="h104-1-19" class="d">-                                primary_key: false,
</a>                                 nullable: false,
                                 default: None,
                                 unique: false,
<a href="#h104-1-23" id="h104-1-23" class="d">-                                references: None,
</a>                                 index: false,
<a href="#h104-1-25" id="h104-1-25" class="i">+                                references: None,
</a>                             },
                         ],
                     },
<a href="#h104-2" id="h104-2" class="h">@@ -312,84 +305,78 @@ Optimized plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h104-2-3" id="h104-2-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h104-2-8" id="h104-2-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h104-2-12" id="h104-2-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h104-2-14" id="h104-2-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h104-2-19" id="h104-2-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h104-2-23" id="h104-2-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h104-2-25" id="h104-2-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h104-2-30" id="h104-2-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h104-2-34" id="h104-2-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h104-2-38" id="h104-2-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h104-2-43" id="h104-2-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h104-2-47" id="h104-2-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h104-2-51" id="h104-2-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h104-2-56" id="h104-2-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h104-2-60" id="h104-2-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h104-2-62" id="h104-2-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h104-2-67" id="h104-2-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h104-2-73" id="h104-2-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h104-2-75" id="h104-2-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h104-2-80" id="h104-2-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h104-2-86" id="h104-2-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h104-2-88" id="h104-2-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h104-3" id="h104-3" class="h">@@ -439,26 +426,25 @@ Optimized plan: Select(
</a>             right: KeyLookup {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h104-3-3" id="h104-3-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h104-3-8" id="h104-3-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h104-3-12" id="h104-3-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h104-3-14" id="h104-3-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h104-3-19" id="h104-3-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h104-3-23" id="h104-3-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h104-3-25" id="h104-3-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h105" href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a> b/<a href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a></b>
<a href="#h105-0" id="h105-0" class="h">@@ -32,84 +32,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h105-0-3" id="h105-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h105-0-8" id="h105-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h105-0-12" id="h105-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h105-0-14" id="h105-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h105-0-19" id="h105-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h105-0-23" id="h105-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h105-0-25" id="h105-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h105-0-30" id="h105-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h105-0-34" id="h105-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h105-0-38" id="h105-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h105-0-43" id="h105-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h105-0-47" id="h105-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h105-0-51" id="h105-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h105-0-56" id="h105-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h105-0-60" id="h105-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h105-0-62" id="h105-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h105-0-67" id="h105-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h105-0-73" id="h105-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h105-0-75" id="h105-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h105-0-80" id="h105-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h105-0-86" id="h105-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h105-0-88" id="h105-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h105-1" id="h105-1" class="h">@@ -128,84 +122,78 @@ Optimized plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h105-1-3" id="h105-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h105-1-8" id="h105-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h105-1-12" id="h105-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h105-1-14" id="h105-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h105-1-19" id="h105-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h105-1-23" id="h105-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h105-1-25" id="h105-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h105-1-30" id="h105-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h105-1-34" id="h105-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h105-1-38" id="h105-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h105-1-43" id="h105-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h105-1-47" id="h105-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h105-1-51" id="h105-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h105-1-56" id="h105-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h105-1-60" id="h105-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h105-1-62" id="h105-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h105-1-67" id="h105-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h105-1-73" id="h105-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h105-1-75" id="h105-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h105-1-80" id="h105-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h105-1-86" id="h105-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h105-1-88" id="h105-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h106" href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a> b/<a href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a></b>
<a href="#h106-0" id="h106-0" class="h">@@ -52,84 +52,78 @@ Plan: Select(
</a>             source: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h106-0-3" id="h106-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h106-0-8" id="h106-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h106-0-12" id="h106-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h106-0-14" id="h106-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h106-0-19" id="h106-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h106-0-23" id="h106-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h106-0-25" id="h106-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h106-0-30" id="h106-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h106-0-34" id="h106-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h106-0-38" id="h106-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h106-0-43" id="h106-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h106-0-47" id="h106-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h106-0-51" id="h106-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h106-0-56" id="h106-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h106-0-60" id="h106-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h106-0-62" id="h106-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h106-0-67" id="h106-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h106-0-73" id="h106-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h106-0-75" id="h106-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h106-0-80" id="h106-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h106-0-86" id="h106-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h106-0-88" id="h106-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h106-1" id="h106-1" class="h">@@ -175,84 +169,78 @@ Optimized plan: Select(
</a>         source: IndexLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h106-1-3" id="h106-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h106-1-8" id="h106-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h106-1-12" id="h106-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h106-1-14" id="h106-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h106-1-19" id="h106-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h106-1-23" id="h106-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h106-1-25" id="h106-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h106-1-30" id="h106-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h106-1-34" id="h106-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h106-1-38" id="h106-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h106-1-43" id="h106-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h106-1-47" id="h106-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h106-1-51" id="h106-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h106-1-56" id="h106-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h106-1-60" id="h106-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h106-1-62" id="h106-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h106-1-67" id="h106-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h106-1-73" id="h106-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h106-1-75" id="h106-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h106-1-80" id="h106-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h106-1-86" id="h106-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h106-1-88" id="h106-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h107" href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a> b/<a href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a></b>
<a href="#h107-0" id="h107-0" class="h">@@ -105,84 +105,78 @@ Plan: Select(
</a>             source: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h107-0-3" id="h107-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h107-0-8" id="h107-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h107-0-12" id="h107-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h107-0-14" id="h107-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h107-0-19" id="h107-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h107-0-23" id="h107-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h107-0-25" id="h107-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h107-0-30" id="h107-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h107-0-34" id="h107-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h107-0-38" id="h107-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h107-0-43" id="h107-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h107-0-47" id="h107-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h107-0-51" id="h107-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h107-0-56" id="h107-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h107-0-60" id="h107-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h107-0-62" id="h107-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h107-0-67" id="h107-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h107-0-73" id="h107-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h107-0-75" id="h107-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h107-0-80" id="h107-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h107-0-86" id="h107-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h107-0-88" id="h107-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h107-1" id="h107-1" class="h">@@ -282,84 +276,78 @@ Optimized plan: Select(
</a>         source: IndexLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h107-1-3" id="h107-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h107-1-8" id="h107-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h107-1-12" id="h107-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h107-1-14" id="h107-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h107-1-19" id="h107-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h107-1-23" id="h107-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h107-1-25" id="h107-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h107-1-30" id="h107-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h107-1-34" id="h107-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h107-1-38" id="h107-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h107-1-43" id="h107-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h107-1-47" id="h107-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h107-1-51" id="h107-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h107-1-56" id="h107-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h107-1-60" id="h107-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h107-1-62" id="h107-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h107-1-67" id="h107-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h107-1-73" id="h107-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h107-1-75" id="h107-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h107-1-80" id="h107-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h107-1-86" id="h107-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h107-1-88" id="h107-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h108" href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a> b/<a href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a></b>
<a href="#h108-0" id="h108-0" class="h">@@ -87,84 +87,78 @@ Plan: Select(
</a>             source: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h108-0-3" id="h108-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h108-0-8" id="h108-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h108-0-12" id="h108-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-0-14" id="h108-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h108-0-19" id="h108-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h108-0-23" id="h108-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-0-25" id="h108-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h108-0-30" id="h108-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h108-0-34" id="h108-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h108-0-38" id="h108-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h108-0-43" id="h108-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h108-0-47" id="h108-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h108-0-51" id="h108-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h108-0-56" id="h108-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h108-0-60" id="h108-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-0-62" id="h108-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h108-0-67" id="h108-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h108-0-73" id="h108-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-0-75" id="h108-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h108-0-80" id="h108-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h108-0-86" id="h108-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-0-88" id="h108-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h108-1" id="h108-1" class="h">@@ -247,84 +241,78 @@ Optimized plan: Select(
</a>             source: IndexLookup {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h108-1-3" id="h108-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h108-1-8" id="h108-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h108-1-12" id="h108-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-1-14" id="h108-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h108-1-19" id="h108-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h108-1-23" id="h108-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-1-25" id="h108-1-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h108-1-30" id="h108-1-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h108-1-34" id="h108-1-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h108-1-38" id="h108-1-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h108-1-43" id="h108-1-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h108-1-47" id="h108-1-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h108-1-51" id="h108-1-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h108-1-56" id="h108-1-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h108-1-60" id="h108-1-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-1-62" id="h108-1-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h108-1-67" id="h108-1-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h108-1-73" id="h108-1-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-1-75" id="h108-1-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h108-1-80" id="h108-1-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h108-1-86" id="h108-1-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h108-1-88" id="h108-1-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<b>diff --git a/<a id="h109" href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a> b/<a href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a></b>
<a href="#h109-0" id="h109-0" class="h">@@ -32,84 +32,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h109-0-3" id="h109-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h109-0-8" id="h109-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h109-0-12" id="h109-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h109-0-14" id="h109-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h109-0-19" id="h109-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h109-0-23" id="h109-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h109-0-25" id="h109-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h109-0-30" id="h109-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h109-0-34" id="h109-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h109-0-38" id="h109-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h109-0-43" id="h109-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h109-0-47" id="h109-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h109-0-51" id="h109-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h109-0-56" id="h109-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h109-0-60" id="h109-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h109-0-62" id="h109-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h109-0-67" id="h109-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h109-0-73" id="h109-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h109-0-75" id="h109-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h109-0-80" id="h109-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h109-0-86" id="h109-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h109-0-88" id="h109-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h109-1" id="h109-1" class="h">@@ -128,84 +122,78 @@ Optimized plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h109-1-3" id="h109-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h109-1-8" id="h109-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h109-1-12" id="h109-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h109-1-14" id="h109-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h109-1-19" id="h109-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h109-1-23" id="h109-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h109-1-25" id="h109-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h109-1-30" id="h109-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h109-1-34" id="h109-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h109-1-38" id="h109-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h109-1-43" id="h109-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h109-1-47" id="h109-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h109-1-51" id="h109-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h109-1-56" id="h109-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h109-1-60" id="h109-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h109-1-62" id="h109-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h109-1-67" id="h109-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h109-1-73" id="h109-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h109-1-75" id="h109-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h109-1-80" id="h109-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h109-1-86" id="h109-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h109-1-88" id="h109-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h110" href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a> b/<a href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a></b>
<a href="#h110-0" id="h110-0" class="h">@@ -60,84 +60,78 @@ Plan: Select(
</a>             left: Scan {
                 table: Table {
                     name: &quot;movies&quot;,
<a href="#h110-0-3" id="h110-0-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h110-0-8" id="h110-0-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h110-0-12" id="h110-0-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h110-0-14" id="h110-0-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;title&quot;,
                             datatype: String,
<a href="#h110-0-19" id="h110-0-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h110-0-23" id="h110-0-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h110-0-25" id="h110-0-25" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;studio_id&quot;,
                             datatype: Integer,
<a href="#h110-0-30" id="h110-0-30" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h110-0-34" id="h110-0-34" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;studios&quot;,
                             ),
<a href="#h110-0-38" id="h110-0-38" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;genre_id&quot;,
                             datatype: Integer,
<a href="#h110-0-43" id="h110-0-43" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h110-0-47" id="h110-0-47" class="i">+                            index: true,
</a>                             references: Some(
                                 &quot;genres&quot;,
                             ),
<a href="#h110-0-51" id="h110-0-51" class="d">-                            index: true,
</a>                         },
                         Column {
                             name: &quot;released&quot;,
                             datatype: Integer,
<a href="#h110-0-56" id="h110-0-56" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h110-0-60" id="h110-0-60" class="d">-                            references: None,
</a>                             index: false,
<a href="#h110-0-62" id="h110-0-62" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;rating&quot;,
                             datatype: Float,
<a href="#h110-0-67" id="h110-0-67" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h110-0-73" id="h110-0-73" class="d">-                            references: None,
</a>                             index: false,
<a href="#h110-0-75" id="h110-0-75" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;ultrahd&quot;,
                             datatype: Boolean,
<a href="#h110-0-80" id="h110-0-80" class="d">-                            primary_key: false,
</a>                             nullable: true,
                             default: Some(
                                 Null,
                             ),
                             unique: false,
<a href="#h110-0-86" id="h110-0-86" class="d">-                            references: None,
</a>                             index: false,
<a href="#h110-0-88" id="h110-0-88" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h110-1" id="h110-1" class="h">@@ -148,26 +142,25 @@ Plan: Select(
</a>             right: Scan {
                 table: Table {
                     name: &quot;genres&quot;,
<a href="#h110-1-3" id="h110-1-3" class="i">+                    primary_key: 0,
</a>                     columns: [
                         Column {
                             name: &quot;id&quot;,
                             datatype: Integer,
<a href="#h110-1-8" id="h110-1-8" class="d">-                            primary_key: true,
</a>                             nullable: false,
                             default: None,
                             unique: true,
<a href="#h110-1-12" id="h110-1-12" class="d">-                            references: None,
</a>                             index: false,
<a href="#h110-1-14" id="h110-1-14" class="i">+                            references: None,
</a>                         },
                         Column {
                             name: &quot;name&quot;,
                             datatype: String,
<a href="#h110-1-19" id="h110-1-19" class="d">-                            primary_key: false,
</a>                             nullable: false,
                             default: None,
                             unique: false,
<a href="#h110-1-23" id="h110-1-23" class="d">-                            references: None,
</a>                             index: false,
<a href="#h110-1-25" id="h110-1-25" class="i">+                            references: None,
</a>                         },
                     ],
                 },
<a href="#h110-2" id="h110-2" class="h">@@ -209,84 +202,78 @@ Optimized plan: Select(
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h110-2-3" id="h110-2-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h110-2-8" id="h110-2-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h110-2-12" id="h110-2-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h110-2-14" id="h110-2-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h110-2-19" id="h110-2-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h110-2-23" id="h110-2-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h110-2-25" id="h110-2-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h110-2-30" id="h110-2-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h110-2-34" id="h110-2-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h110-2-38" id="h110-2-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h110-2-43" id="h110-2-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h110-2-47" id="h110-2-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h110-2-51" id="h110-2-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h110-2-56" id="h110-2-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h110-2-60" id="h110-2-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h110-2-62" id="h110-2-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h110-2-67" id="h110-2-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h110-2-73" id="h110-2-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h110-2-75" id="h110-2-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h110-2-80" id="h110-2-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h110-2-86" id="h110-2-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h110-2-88" id="h110-2-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h110-3" id="h110-3" class="h">@@ -307,26 +294,25 @@ Optimized plan: Select(
</a>         right: Scan {
             table: Table {
                 name: &quot;genres&quot;,
<a href="#h110-3-3" id="h110-3-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h110-3-8" id="h110-3-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h110-3-12" id="h110-3-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h110-3-14" id="h110-3-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;name&quot;,
                         datatype: String,
<a href="#h110-3-19" id="h110-3-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h110-3-23" id="h110-3-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h110-3-25" id="h110-3-25" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h111" href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a> b/<a href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a></b>
<a href="#h111-0" id="h111-0" class="h">@@ -30,84 +30,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h111-0-3" id="h111-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h111-0-8" id="h111-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h111-0-12" id="h111-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h111-0-14" id="h111-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h111-0-19" id="h111-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h111-0-23" id="h111-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h111-0-25" id="h111-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h111-0-30" id="h111-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h111-0-34" id="h111-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h111-0-38" id="h111-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h111-0-43" id="h111-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h111-0-47" id="h111-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h111-0-51" id="h111-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h111-0-56" id="h111-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h111-0-60" id="h111-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h111-0-62" id="h111-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h111-0-67" id="h111-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h111-0-73" id="h111-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h111-0-75" id="h111-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h111-0-80" id="h111-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h111-0-86" id="h111-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h111-0-88" id="h111-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h111-1" id="h111-1" class="h">@@ -124,84 +118,78 @@ Optimized plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h111-1-3" id="h111-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h111-1-8" id="h111-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h111-1-12" id="h111-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h111-1-14" id="h111-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h111-1-19" id="h111-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h111-1-23" id="h111-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h111-1-25" id="h111-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h111-1-30" id="h111-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h111-1-34" id="h111-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h111-1-38" id="h111-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h111-1-43" id="h111-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h111-1-47" id="h111-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h111-1-51" id="h111-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h111-1-56" id="h111-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h111-1-60" id="h111-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h111-1-62" id="h111-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h111-1-67" id="h111-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h111-1-73" id="h111-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h111-1-75" id="h111-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h111-1-80" id="h111-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h111-1-86" id="h111-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h111-1-88" id="h111-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h112" href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a> b/<a href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a></b>
<a href="#h112-0" id="h112-0" class="h">@@ -41,84 +41,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h112-0-3" id="h112-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h112-0-8" id="h112-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h112-0-12" id="h112-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h112-0-14" id="h112-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h112-0-19" id="h112-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h112-0-23" id="h112-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h112-0-25" id="h112-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h112-0-30" id="h112-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h112-0-34" id="h112-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h112-0-38" id="h112-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h112-0-43" id="h112-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h112-0-47" id="h112-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h112-0-51" id="h112-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h112-0-56" id="h112-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h112-0-60" id="h112-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h112-0-62" id="h112-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h112-0-67" id="h112-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h112-0-73" id="h112-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h112-0-75" id="h112-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h112-0-80" id="h112-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h112-0-86" id="h112-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h112-0-88" id="h112-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h112-1" id="h112-1" class="h">@@ -148,84 +142,78 @@ Optimized plan: Select(
</a>     KeyLookup {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h112-1-3" id="h112-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h112-1-8" id="h112-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h112-1-12" id="h112-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h112-1-14" id="h112-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h112-1-19" id="h112-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h112-1-23" id="h112-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h112-1-25" id="h112-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h112-1-30" id="h112-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h112-1-34" id="h112-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h112-1-38" id="h112-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h112-1-43" id="h112-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h112-1-47" id="h112-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h112-1-51" id="h112-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h112-1-56" id="h112-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h112-1-60" id="h112-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h112-1-62" id="h112-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h112-1-67" id="h112-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h112-1-73" id="h112-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h112-1-75" id="h112-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h112-1-80" id="h112-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h112-1-86" id="h112-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h112-1-88" id="h112-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h113" href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a> b/<a href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a></b>
<a href="#h113-0" id="h113-0" class="h">@@ -77,84 +77,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h113-0-3" id="h113-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h113-0-8" id="h113-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h113-0-12" id="h113-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h113-0-14" id="h113-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h113-0-19" id="h113-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h113-0-23" id="h113-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h113-0-25" id="h113-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h113-0-30" id="h113-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h113-0-34" id="h113-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h113-0-38" id="h113-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h113-0-43" id="h113-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h113-0-47" id="h113-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h113-0-51" id="h113-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h113-0-56" id="h113-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h113-0-60" id="h113-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h113-0-62" id="h113-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h113-0-67" id="h113-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h113-0-73" id="h113-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h113-0-75" id="h113-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h113-0-80" id="h113-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h113-0-86" id="h113-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h113-0-88" id="h113-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h113-1" id="h113-1" class="h">@@ -220,84 +214,78 @@ Optimized plan: Select(
</a>     KeyLookup {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h113-1-3" id="h113-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h113-1-8" id="h113-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h113-1-12" id="h113-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h113-1-14" id="h113-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h113-1-19" id="h113-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h113-1-23" id="h113-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h113-1-25" id="h113-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h113-1-30" id="h113-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h113-1-34" id="h113-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h113-1-38" id="h113-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h113-1-43" id="h113-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h113-1-47" id="h113-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h113-1-51" id="h113-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h113-1-56" id="h113-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h113-1-60" id="h113-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h113-1-62" id="h113-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h113-1-67" id="h113-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h113-1-73" id="h113-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h113-1-75" id="h113-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h113-1-80" id="h113-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h113-1-86" id="h113-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h113-1-88" id="h113-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h114" href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a> b/<a href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a></b>
<a href="#h114-0" id="h114-0" class="h">@@ -111,84 +111,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h114-0-3" id="h114-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h114-0-8" id="h114-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h114-0-12" id="h114-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-0-14" id="h114-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h114-0-19" id="h114-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h114-0-23" id="h114-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-0-25" id="h114-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h114-0-30" id="h114-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h114-0-34" id="h114-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h114-0-38" id="h114-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h114-0-43" id="h114-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h114-0-47" id="h114-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h114-0-51" id="h114-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h114-0-56" id="h114-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h114-0-60" id="h114-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-0-62" id="h114-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h114-0-67" id="h114-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h114-0-73" id="h114-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-0-75" id="h114-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h114-0-80" id="h114-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h114-0-86" id="h114-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-0-88" id="h114-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h114-1" id="h114-1" class="h">@@ -291,84 +285,78 @@ Optimized plan: Select(
</a>         source: KeyLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h114-1-3" id="h114-1-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h114-1-8" id="h114-1-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h114-1-12" id="h114-1-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-1-14" id="h114-1-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h114-1-19" id="h114-1-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h114-1-23" id="h114-1-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-1-25" id="h114-1-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h114-1-30" id="h114-1-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h114-1-34" id="h114-1-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h114-1-38" id="h114-1-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h114-1-43" id="h114-1-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h114-1-47" id="h114-1-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h114-1-51" id="h114-1-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h114-1-56" id="h114-1-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h114-1-60" id="h114-1-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-1-62" id="h114-1-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h114-1-67" id="h114-1-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h114-1-73" id="h114-1-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-1-75" id="h114-1-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h114-1-80" id="h114-1-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h114-1-86" id="h114-1-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h114-1-88" id="h114-1-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<b>diff --git a/<a id="h115" href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a> b/<a href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a></b>
<a href="#h115-0" id="h115-0" class="h">@@ -32,84 +32,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h115-0-3" id="h115-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h115-0-8" id="h115-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h115-0-12" id="h115-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h115-0-14" id="h115-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h115-0-19" id="h115-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h115-0-23" id="h115-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h115-0-25" id="h115-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h115-0-30" id="h115-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h115-0-34" id="h115-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h115-0-38" id="h115-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h115-0-43" id="h115-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h115-0-47" id="h115-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h115-0-51" id="h115-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h115-0-56" id="h115-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h115-0-60" id="h115-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h115-0-62" id="h115-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h115-0-67" id="h115-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h115-0-73" id="h115-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h115-0-75" id="h115-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h115-0-80" id="h115-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h115-0-86" id="h115-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h115-0-88" id="h115-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h115-1" id="h115-1" class="h">@@ -128,84 +122,78 @@ Optimized plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h115-1-3" id="h115-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h115-1-8" id="h115-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h115-1-12" id="h115-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h115-1-14" id="h115-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h115-1-19" id="h115-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h115-1-23" id="h115-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h115-1-25" id="h115-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h115-1-30" id="h115-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h115-1-34" id="h115-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h115-1-38" id="h115-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h115-1-43" id="h115-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h115-1-47" id="h115-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h115-1-51" id="h115-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h115-1-56" id="h115-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h115-1-60" id="h115-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h115-1-62" id="h115-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h115-1-67" id="h115-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h115-1-73" id="h115-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h115-1-75" id="h115-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h115-1-80" id="h115-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h115-1-86" id="h115-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h115-1-88" id="h115-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h116" href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a> b/<a href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a></b>
<a href="#h116-0" id="h116-0" class="h">@@ -42,84 +42,78 @@ Plan: Select(
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h116-0-3" id="h116-0-3" class="i">+                primary_key: 0,
</a>                 columns: [
                     Column {
                         name: &quot;id&quot;,
                         datatype: Integer,
<a href="#h116-0-8" id="h116-0-8" class="d">-                        primary_key: true,
</a>                         nullable: false,
                         default: None,
                         unique: true,
<a href="#h116-0-12" id="h116-0-12" class="d">-                        references: None,
</a>                         index: false,
<a href="#h116-0-14" id="h116-0-14" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;title&quot;,
                         datatype: String,
<a href="#h116-0-19" id="h116-0-19" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h116-0-23" id="h116-0-23" class="d">-                        references: None,
</a>                         index: false,
<a href="#h116-0-25" id="h116-0-25" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;studio_id&quot;,
                         datatype: Integer,
<a href="#h116-0-30" id="h116-0-30" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h116-0-34" id="h116-0-34" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;studios&quot;,
                         ),
<a href="#h116-0-38" id="h116-0-38" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;genre_id&quot;,
                         datatype: Integer,
<a href="#h116-0-43" id="h116-0-43" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h116-0-47" id="h116-0-47" class="i">+                        index: true,
</a>                         references: Some(
                             &quot;genres&quot;,
                         ),
<a href="#h116-0-51" id="h116-0-51" class="d">-                        index: true,
</a>                     },
                     Column {
                         name: &quot;released&quot;,
                         datatype: Integer,
<a href="#h116-0-56" id="h116-0-56" class="d">-                        primary_key: false,
</a>                         nullable: false,
                         default: None,
                         unique: false,
<a href="#h116-0-60" id="h116-0-60" class="d">-                        references: None,
</a>                         index: false,
<a href="#h116-0-62" id="h116-0-62" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;rating&quot;,
                         datatype: Float,
<a href="#h116-0-67" id="h116-0-67" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h116-0-73" id="h116-0-73" class="d">-                        references: None,
</a>                         index: false,
<a href="#h116-0-75" id="h116-0-75" class="i">+                        references: None,
</a>                     },
                     Column {
                         name: &quot;ultrahd&quot;,
                         datatype: Boolean,
<a href="#h116-0-80" id="h116-0-80" class="d">-                        primary_key: false,
</a>                         nullable: true,
                         default: Some(
                             Null,
                         ),
                         unique: false,
<a href="#h116-0-86" id="h116-0-86" class="d">-                        references: None,
</a>                         index: false,
<a href="#h116-0-88" id="h116-0-88" class="i">+                        references: None,
</a>                     },
                 ],
             },
<a href="#h116-1" id="h116-1" class="h">@@ -138,84 +132,78 @@ Optimized plan: Select(
</a>     Scan {
         table: Table {
             name: &quot;movies&quot;,
<a href="#h116-1-3" id="h116-1-3" class="i">+            primary_key: 0,
</a>             columns: [
                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h116-1-8" id="h116-1-8" class="d">-                    primary_key: true,
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h116-1-12" id="h116-1-12" class="d">-                    references: None,
</a>                     index: false,
<a href="#h116-1-14" id="h116-1-14" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;title&quot;,
                     datatype: String,
<a href="#h116-1-19" id="h116-1-19" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h116-1-23" id="h116-1-23" class="d">-                    references: None,
</a>                     index: false,
<a href="#h116-1-25" id="h116-1-25" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;studio_id&quot;,
                     datatype: Integer,
<a href="#h116-1-30" id="h116-1-30" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h116-1-34" id="h116-1-34" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;studios&quot;,
                     ),
<a href="#h116-1-38" id="h116-1-38" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;genre_id&quot;,
                     datatype: Integer,
<a href="#h116-1-43" id="h116-1-43" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h116-1-47" id="h116-1-47" class="i">+                    index: true,
</a>                     references: Some(
                         &quot;genres&quot;,
                     ),
<a href="#h116-1-51" id="h116-1-51" class="d">-                    index: true,
</a>                 },
                 Column {
                     name: &quot;released&quot;,
                     datatype: Integer,
<a href="#h116-1-56" id="h116-1-56" class="d">-                    primary_key: false,
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h116-1-60" id="h116-1-60" class="d">-                    references: None,
</a>                     index: false,
<a href="#h116-1-62" id="h116-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;rating&quot;,
                     datatype: Float,
<a href="#h116-1-67" id="h116-1-67" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h116-1-73" id="h116-1-73" class="d">-                    references: None,
</a>                     index: false,
<a href="#h116-1-75" id="h116-1-75" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;ultrahd&quot;,
                     datatype: Boolean,
<a href="#h116-1-80" id="h116-1-80" class="d">-                    primary_key: false,
</a>                     nullable: true,
                     default: Some(
                         Null,
                     ),
                     unique: false,
<a href="#h116-1-86" id="h116-1-86" class="d">-                    references: None,
</a>                     index: false,
<a href="#h116-1-88" id="h116-1-88" class="i">+                    references: None,
</a>                 },
             ],
         },
<b>diff --git a/<a id="h117" href="../file/tests/sql/schema/create_table_default_conflict.html">tests/sql/schema/create_table_default_conflict</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict.html">tests/sql/schema/create_table_default_conflict</a></b>
<a href="#h117-0" id="h117-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT 7)
<a href="#h117-0-1" id="h117-0-1" class="d">-Error: InvalidInput(&quot;default value for column value has datatype INTEGER, must be STRING&quot;)
</a><a href="#h117-0-2" id="h117-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype INTEGER for STRING column value&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h118" href="../file/tests/sql/schema/create_table_default_conflict_float_integer.html">tests/sql/schema/create_table_default_conflict_float_integer</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict_float_integer.html">tests/sql/schema/create_table_default_conflict_float_integer</a></b>
<a href="#h118-0" id="h118-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value FLOAT DEFAULT 7)
<a href="#h118-0-1" id="h118-0-1" class="d">-Error: InvalidInput(&quot;default value for column value has datatype INTEGER, must be FLOAT&quot;)
</a><a href="#h118-0-2" id="h118-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype INTEGER for FLOAT column value&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h119" href="../file/tests/sql/schema/create_table_default_conflict_integer_float.html">tests/sql/schema/create_table_default_conflict_integer_float</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict_integer_float.html">tests/sql/schema/create_table_default_conflict_integer_float</a></b>
<a href="#h119-0" id="h119-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 3.14)
<a href="#h119-0-1" id="h119-0-1" class="d">-Error: InvalidInput(&quot;default value for column value has datatype FLOAT, must be INTEGER&quot;)
</a><a href="#h119-0-2" id="h119-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype FLOAT for INTEGER column value&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h120" href="../file/tests/sql/schema/create_table_default_null_not.html">tests/sql/schema/create_table_default_null_not</a> b/<a href="../file/tests/sql/schema/create_table_default_null_not.html">tests/sql/schema/create_table_default_null_not</a></b>
<a href="#h120-0" id="h120-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL DEFAULT NULL)
<a href="#h120-0-1" id="h120-0-1" class="d">-Error: InvalidInput(&quot;can&#39;t use NULL as default value for non-nullable column value&quot;)
</a><a href="#h120-0-2" id="h120-0-2" class="i">+Error: InvalidInput(&quot;invalid NULL default for non-nullable column value&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h121" href="../file/tests/sql/schema/create_table_pk_missing.html">tests/sql/schema/create_table_pk_missing</a> b/<a href="../file/tests/sql/schema/create_table_pk_missing.html">tests/sql/schema/create_table_pk_missing</a></b>
<a href="#h121-0" id="h121-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER)
<a href="#h121-0-1" id="h121-0-1" class="d">-Error: InvalidInput(&quot;no primary key in table name&quot;)
</a><a href="#h121-0-2" id="h121-0-2" class="i">+Error: InvalidInput(&quot;no primary key for table name&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h122" href="../file/tests/sql/schema/create_table_pk_multiple.html">tests/sql/schema/create_table_pk_multiple</a> b/<a href="../file/tests/sql/schema/create_table_pk_multiple.html">tests/sql/schema/create_table_pk_multiple</a></b>
<a href="#h122-0" id="h122-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, name STRING PRIMARY KEY)
<a href="#h122-0-1" id="h122-0-1" class="d">-Error: InvalidInput(&quot;multiple primary keys in table name&quot;)
</a><a href="#h122-0-2" id="h122-0-2" class="i">+Error: InvalidInput(&quot;multiple primary keys for table name&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h123" href="../file/tests/sql/schema/create_table_ref.html">tests/sql/schema/create_table_ref</a> b/<a href="../file/tests/sql/schema/create_table_ref.html">tests/sql/schema/create_table_ref</a></b>
<a href="#h123-0" id="h123-0" class="h">@@ -4,9 +4,11 @@ Result: CreateTable { name: &quot;other&quot; }
</a> Storage:
 CREATE TABLE other (
   id INTEGER PRIMARY KEY,
<a href="#h123-0-3" id="h123-0-3" class="d">-  test_id INTEGER DEFAULT NULL REFERENCES test
</a><a href="#h123-0-4" id="h123-0-4" class="i">+  test_id INTEGER DEFAULT NULL INDEX REFERENCES test
</a> )
 
<a href="#h123-0-7" id="h123-0-7" class="i">+Index other.test_id
</a><a href="#h123-0-8" id="h123-0-8" class="i">+
</a> CREATE TABLE test (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h124" href="../file/tests/sql/schema/create_table_ref_missing.html">tests/sql/schema/create_table_ref_missing</a> b/<a href="../file/tests/sql/schema/create_table_ref_missing.html">tests/sql/schema/create_table_ref_missing</a></b>
<a href="#h124-0" id="h124-0" class="h">@@ -1,5 +1,5 @@
</a> Query: CREATE TABLE other (id INTEGER PRIMARY KEY, missing_id INTEGER REFERENCES missing)
<a href="#h124-0-1" id="h124-0-1" class="d">-Error: InvalidInput(&quot;table missing referenced by column missing_id does not exist&quot;)
</a><a href="#h124-0-2" id="h124-0-2" class="i">+Error: InvalidInput(&quot;unknown table missing referenced by column missing_id&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h125" href="../file/tests/sql/schema/create_table_ref_multiple.html">tests/sql/schema/create_table_ref_multiple</a> b/<a href="../file/tests/sql/schema/create_table_ref_multiple.html">tests/sql/schema/create_table_ref_multiple</a></b>
<a href="#h125-0" id="h125-0" class="h">@@ -9,11 +9,17 @@ Result: CreateTable { name: &quot;other&quot; }
</a> Storage:
 CREATE TABLE other (
   id INTEGER PRIMARY KEY,
<a href="#h125-0-3" id="h125-0-3" class="d">-  test_id_a INTEGER DEFAULT NULL REFERENCES test,
</a><a href="#h125-0-4" id="h125-0-4" class="d">-  test_id_b INTEGER DEFAULT NULL REFERENCES test,
</a><a href="#h125-0-5" id="h125-0-5" class="d">-  test_id_c INTEGER DEFAULT NULL REFERENCES test
</a><a href="#h125-0-6" id="h125-0-6" class="i">+  test_id_a INTEGER DEFAULT NULL INDEX REFERENCES test,
</a><a href="#h125-0-7" id="h125-0-7" class="i">+  test_id_b INTEGER DEFAULT NULL INDEX REFERENCES test,
</a><a href="#h125-0-8" id="h125-0-8" class="i">+  test_id_c INTEGER DEFAULT NULL INDEX REFERENCES test
</a> )
 
<a href="#h125-0-11" id="h125-0-11" class="i">+Index other.test_id_a
</a><a href="#h125-0-12" id="h125-0-12" class="i">+
</a><a href="#h125-0-13" id="h125-0-13" class="i">+Index other.test_id_b
</a><a href="#h125-0-14" id="h125-0-14" class="i">+
</a><a href="#h125-0-15" id="h125-0-15" class="i">+Index other.test_id_c
</a><a href="#h125-0-16" id="h125-0-16" class="i">+
</a> CREATE TABLE test (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h126" href="../file/tests/sql/schema/create_table_ref_self.html">tests/sql/schema/create_table_ref_self</a> b/<a href="../file/tests/sql/schema/create_table_ref_self.html">tests/sql/schema/create_table_ref_self</a></b>
<a href="#h126-0" id="h126-0" class="h">@@ -4,9 +4,11 @@ Result: CreateTable { name: &quot;other&quot; }
</a> Storage:
 CREATE TABLE other (
   id INTEGER PRIMARY KEY,
<a href="#h126-0-3" id="h126-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES other
</a><a href="#h126-0-4" id="h126-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES other
</a> )
 
<a href="#h126-0-7" id="h126-0-7" class="i">+Index other.self_id
</a><a href="#h126-0-8" id="h126-0-8" class="i">+
</a> CREATE TABLE test (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h127" href="../file/tests/sql/schema/create_table_ref_self_type.html">tests/sql/schema/create_table_ref_self_type</a> b/<a href="../file/tests/sql/schema/create_table_ref_self_type.html">tests/sql/schema/create_table_ref_self_type</a></b>
<a href="#h127-0" id="h127-0" class="h">@@ -1,5 +1,5 @@
</a> Query: CREATE TABLE other (id INTEGER PRIMARY KEY, self_id STRING REFERENCES other)
<a href="#h127-0-1" id="h127-0-1" class="d">-Error: InvalidInput(&quot;can&#39;t reference INTEGER primary key of table other from STRING column self_id&quot;)
</a><a href="#h127-0-2" id="h127-0-2" class="i">+Error: InvalidInput(&quot;can&#39;t reference INTEGER primary key of other from STRING column self_id&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h128" href="../file/tests/sql/schema/create_table_ref_type.html">tests/sql/schema/create_table_ref_type</a> b/<a href="../file/tests/sql/schema/create_table_ref_type.html">tests/sql/schema/create_table_ref_type</a></b>
<a href="#h128-0" id="h128-0" class="h">@@ -1,5 +1,5 @@
</a> Query: CREATE TABLE other (id INTEGER PRIMARY KEY, test_id STRING REFERENCES test)
<a href="#h128-0-1" id="h128-0-1" class="d">-Error: InvalidInput(&quot;can&#39;t reference INTEGER primary key of table test from STRING column test_id&quot;)
</a><a href="#h128-0-2" id="h128-0-2" class="i">+Error: InvalidInput(&quot;can&#39;t reference INTEGER primary key of test from STRING column test_id&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h129" href="../file/tests/sql/schema/create_table_unique.html">tests/sql/schema/create_table_unique</a> b/<a href="../file/tests/sql/schema/create_table_unique.html">tests/sql/schema/create_table_unique</a></b>
<a href="#h129-0" id="h129-0" class="h">@@ -4,5 +4,7 @@ Result: CreateTable { name: &quot;name&quot; }
</a> Storage:
 CREATE TABLE name (
   id INTEGER PRIMARY KEY,
<a href="#h129-0-3" id="h129-0-3" class="d">-  value STRING DEFAULT NULL UNIQUE
</a><a href="#h129-0-4" id="h129-0-4" class="i">+  value STRING DEFAULT NULL UNIQUE INDEX
</a> )
<a href="#h129-0-6" id="h129-0-6" class="i">+
</a><a href="#h129-0-7" id="h129-0-7" class="i">+Index name.value
</a><b>diff --git a/<a id="h130" href="../file/tests/sql/schema/create_table_unique_default.html">tests/sql/schema/create_table_unique_default</a> b/<a href="../file/tests/sql/schema/create_table_unique_default.html">tests/sql/schema/create_table_unique_default</a></b>
<a href="#h130-0" id="h130-0" class="h">@@ -4,5 +4,7 @@ Result: CreateTable { name: &quot;name&quot; }
</a> Storage:
 CREATE TABLE name (
   id INTEGER PRIMARY KEY,
<a href="#h130-0-3" id="h130-0-3" class="d">-  value STRING DEFAULT foo UNIQUE
</a><a href="#h130-0-4" id="h130-0-4" class="i">+  value STRING DEFAULT foo UNIQUE INDEX
</a> )
<a href="#h130-0-6" id="h130-0-6" class="i">+
</a><a href="#h130-0-7" id="h130-0-7" class="i">+Index name.value
</a><b>diff --git a/<a id="h131" href="../file/tests/sql/schema/create_table_unique_not_null.html">tests/sql/schema/create_table_unique_not_null</a> b/<a href="../file/tests/sql/schema/create_table_unique_not_null.html">tests/sql/schema/create_table_unique_not_null</a></b>
<a href="#h131-0" id="h131-0" class="h">@@ -4,5 +4,7 @@ Result: CreateTable { name: &quot;name&quot; }
</a> Storage:
 CREATE TABLE name (
   id INTEGER PRIMARY KEY,
<a href="#h131-0-3" id="h131-0-3" class="d">-  value STRING NOT NULL UNIQUE
</a><a href="#h131-0-4" id="h131-0-4" class="i">+  value STRING NOT NULL UNIQUE INDEX
</a> )
<a href="#h131-0-6" id="h131-0-6" class="i">+
</a><a href="#h131-0-7" id="h131-0-7" class="i">+Index name.value
</a><b>diff --git a/<a id="h132" href="../file/tests/sql/schema/create_table_unique_null.html">tests/sql/schema/create_table_unique_null</a> b/<a href="../file/tests/sql/schema/create_table_unique_null.html">tests/sql/schema/create_table_unique_null</a></b>
<a href="#h132-0" id="h132-0" class="h">@@ -4,5 +4,7 @@ Result: CreateTable { name: &quot;name&quot; }
</a> Storage:
 CREATE TABLE name (
   id INTEGER PRIMARY KEY,
<a href="#h132-0-3" id="h132-0-3" class="d">-  value STRING DEFAULT NULL UNIQUE
</a><a href="#h132-0-4" id="h132-0-4" class="i">+  value STRING DEFAULT NULL UNIQUE INDEX
</a> )
<a href="#h132-0-6" id="h132-0-6" class="i">+
</a><a href="#h132-0-7" id="h132-0-7" class="i">+Index name.value
</a><b>diff --git a/<a id="h133" href="../file/tests/sql/schema/delete_ref_conflict.html">tests/sql/schema/delete_ref_conflict</a> b/<a href="../file/tests/sql/schema/delete_ref_conflict.html">tests/sql/schema/delete_ref_conflict</a></b>
<a href="#h133-0" id="h133-0" class="h">@@ -4,12 +4,17 @@ Error: InvalidInput(&quot;primary key 1 referenced by table source column target_id&quot;)
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h133-0-3" id="h133-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h133-0-4" id="h133-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
 [Integer(4), Null]
 
<a href="#h133-0-10" id="h133-0-10" class="i">+Index source.target_id
</a><a href="#h133-0-11" id="h133-0-11" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h133-0-12" id="h133-0-12" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h133-0-13" id="h133-0-13" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h133-0-14" id="h133-0-14" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h134" href="../file/tests/sql/schema/delete_ref_noref.html">tests/sql/schema/delete_ref_noref</a> b/<a href="../file/tests/sql/schema/delete_ref_noref.html">tests/sql/schema/delete_ref_noref</a></b>
<a href="#h134-0" id="h134-0" class="h">@@ -4,12 +4,17 @@ Result: Delete { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h134-0-3" id="h134-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h134-0-4" id="h134-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
 [Integer(4), Null]
 
<a href="#h134-0-10" id="h134-0-10" class="i">+Index source.target_id
</a><a href="#h134-0-11" id="h134-0-11" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h134-0-12" id="h134-0-12" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h134-0-13" id="h134-0-13" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h134-0-14" id="h134-0-14" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h135" href="../file/tests/sql/schema/delete_ref_self.html">tests/sql/schema/delete_ref_self</a> b/<a href="../file/tests/sql/schema/delete_ref_self.html">tests/sql/schema/delete_ref_self</a></b>
<a href="#h135-0" id="h135-0" class="h">@@ -4,9 +4,13 @@ Result: Delete { count: 1 }
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h135-0-3" id="h135-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h135-0-4" id="h135-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
 [Integer(2), Integer(1), String(&quot;b&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
<a href="#h135-0-10" id="h135-0-10" class="i">+
</a><a href="#h135-0-11" id="h135-0-11" class="i">+Index self.self_id
</a><a href="#h135-0-12" id="h135-0-12" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h135-0-13" id="h135-0-13" class="i">+Integer(1) =&gt; [Integer(1), Integer(2)]
</a><b>diff --git a/<a id="h136" href="../file/tests/sql/schema/delete_ref_self_all.html">tests/sql/schema/delete_ref_self_all</a> b/<a href="../file/tests/sql/schema/delete_ref_self_all.html">tests/sql/schema/delete_ref_self_all</a></b>
<a href="#h136-0" id="h136-0" class="h">@@ -4,10 +4,15 @@ Error: InvalidInput(&quot;primary key 1 referenced by table self column self_id&quot;)
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h136-0-3" id="h136-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h136-0-4" id="h136-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
 [Integer(2), Integer(1), String(&quot;b&quot;)]
 [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
<a href="#h136-0-11" id="h136-0-11" class="i">+
</a><a href="#h136-0-12" id="h136-0-12" class="i">+Index self.self_id
</a><a href="#h136-0-13" id="h136-0-13" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h136-0-14" id="h136-0-14" class="i">+Integer(1) =&gt; [Integer(1), Integer(2)]
</a><a href="#h136-0-15" id="h136-0-15" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h137" href="../file/tests/sql/schema/delete_ref_self_conflict.html">tests/sql/schema/delete_ref_self_conflict</a> b/<a href="../file/tests/sql/schema/delete_ref_self_conflict.html">tests/sql/schema/delete_ref_self_conflict</a></b>
<a href="#h137-0" id="h137-0" class="h">@@ -4,10 +4,15 @@ Error: InvalidInput(&quot;primary key 1 referenced by table self column self_id&quot;)
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h137-0-3" id="h137-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h137-0-4" id="h137-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
 [Integer(2), Integer(1), String(&quot;b&quot;)]
 [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
<a href="#h137-0-11" id="h137-0-11" class="i">+
</a><a href="#h137-0-12" id="h137-0-12" class="i">+Index self.self_id
</a><a href="#h137-0-13" id="h137-0-13" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h137-0-14" id="h137-0-14" class="i">+Integer(1) =&gt; [Integer(1), Integer(2)]
</a><a href="#h137-0-15" id="h137-0-15" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h138" href="../file/tests/sql/schema/delete_ref_source.html">tests/sql/schema/delete_ref_source</a> b/<a href="../file/tests/sql/schema/delete_ref_source.html">tests/sql/schema/delete_ref_source</a></b>
<a href="#h138-0" id="h138-0" class="h">@@ -4,11 +4,15 @@ Result: Delete { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h138-0-3" id="h138-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h138-0-4" id="h138-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(2), Integer(2)]
 [Integer(4), Null]
 
<a href="#h138-0-9" id="h138-0-9" class="i">+Index source.target_id
</a><a href="#h138-0-10" id="h138-0-10" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h138-0-11" id="h138-0-11" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h138-0-12" id="h138-0-12" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h139" href="../file/tests/sql/schema/drop_table_ref_self.html">tests/sql/schema/drop_table_ref_self</a> b/<a href="../file/tests/sql/schema/drop_table_ref_self.html">tests/sql/schema/drop_table_ref_self</a></b>
<a href="#h139-0" id="h139-0" class="h">@@ -4,9 +4,11 @@ Result: DropTable { name: &quot;self&quot;, existed: true }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h139-0-3" id="h139-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h139-0-4" id="h139-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 
<a href="#h139-0-7" id="h139-0-7" class="i">+Index source.target_id
</a><a href="#h139-0-8" id="h139-0-8" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h140" href="../file/tests/sql/schema/drop_table_ref_source.html">tests/sql/schema/drop_table_ref_source</a> b/<a href="../file/tests/sql/schema/drop_table_ref_source.html">tests/sql/schema/drop_table_ref_source</a></b>
<a href="#h140-0" id="h140-0" class="h">@@ -4,9 +4,11 @@ Result: DropTable { name: &quot;source&quot;, existed: true }
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h140-0-3" id="h140-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self
</a><a href="#h140-0-4" id="h140-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self
</a> )
 
<a href="#h140-0-7" id="h140-0-7" class="i">+Index self.self_id
</a><a href="#h140-0-8" id="h140-0-8" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h141" href="../file/tests/sql/schema/drop_table_ref_target.html">tests/sql/schema/drop_table_ref_target</a> b/<a href="../file/tests/sql/schema/drop_table_ref_target.html">tests/sql/schema/drop_table_ref_target</a></b>
<a href="#h141-0" id="h141-0" class="h">@@ -4,14 +4,18 @@ Error: InvalidInput(&quot;table target is referenced by table source column target_id
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h141-0-3" id="h141-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self
</a><a href="#h141-0-4" id="h141-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self
</a> )
 
<a href="#h141-0-7" id="h141-0-7" class="i">+Index self.self_id
</a><a href="#h141-0-8" id="h141-0-8" class="i">+
</a> CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h141-0-11" id="h141-0-11" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h141-0-12" id="h141-0-12" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 
<a href="#h141-0-15" id="h141-0-15" class="i">+Index source.target_id
</a><a href="#h141-0-16" id="h141-0-16" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h142" href="../file/tests/sql/schema/insert_ref_boolean.html">tests/sql/schema/insert_ref_boolean</a> b/<a href="../file/tests/sql/schema/insert_ref_boolean.html">tests/sql/schema/insert_ref_boolean</a></b>
<a href="#h142-0" id="h142-0" class="h">@@ -4,10 +4,13 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h142-0-3" id="h142-0-3" class="d">-  target_id BOOLEAN DEFAULT NULL REFERENCES target
</a><a href="#h142-0-4" id="h142-0-4" class="i">+  target_id BOOLEAN DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Boolean(true)]
 
<a href="#h142-0-8" id="h142-0-8" class="i">+Index source.target_id
</a><a href="#h142-0-9" id="h142-0-9" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h142-0-10" id="h142-0-10" class="i">+
</a> CREATE TABLE target (
   id BOOLEAN PRIMARY KEY
 )
<b>diff --git a/<a id="h143" href="../file/tests/sql/schema/insert_ref_boolean_missing.html">tests/sql/schema/insert_ref_boolean_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_boolean_missing.html">tests/sql/schema/insert_ref_boolean_missing</a></b>
<a href="#h143-0" id="h143-0" class="h">@@ -4,9 +4,11 @@ Error: InvalidInput(&quot;referenced primary key FALSE in table target does not exist
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h143-0-3" id="h143-0-3" class="d">-  target_id BOOLEAN DEFAULT NULL REFERENCES target
</a><a href="#h143-0-4" id="h143-0-4" class="i">+  target_id BOOLEAN DEFAULT NULL INDEX REFERENCES target
</a> )
 
<a href="#h143-0-7" id="h143-0-7" class="i">+Index source.target_id
</a><a href="#h143-0-8" id="h143-0-8" class="i">+
</a> CREATE TABLE target (
   id BOOLEAN PRIMARY KEY
 )
<b>diff --git a/<a id="h144" href="../file/tests/sql/schema/insert_ref_boolean_null.html">tests/sql/schema/insert_ref_boolean_null</a> b/<a href="../file/tests/sql/schema/insert_ref_boolean_null.html">tests/sql/schema/insert_ref_boolean_null</a></b>
<a href="#h144-0" id="h144-0" class="h">@@ -4,10 +4,13 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h144-0-3" id="h144-0-3" class="d">-  target_id BOOLEAN DEFAULT NULL REFERENCES target
</a><a href="#h144-0-4" id="h144-0-4" class="i">+  target_id BOOLEAN DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Null]
 
<a href="#h144-0-8" id="h144-0-8" class="i">+Index source.target_id
</a><a href="#h144-0-9" id="h144-0-9" class="i">+Null =&gt; [Integer(1)]
</a><a href="#h144-0-10" id="h144-0-10" class="i">+
</a> CREATE TABLE target (
   id BOOLEAN PRIMARY KEY
 )
<b>diff --git a/<a id="h145" href="../file/tests/sql/schema/insert_ref_float.html">tests/sql/schema/insert_ref_float</a> b/<a href="../file/tests/sql/schema/insert_ref_float.html">tests/sql/schema/insert_ref_float</a></b>
<a href="#h145-0" id="h145-0" class="h">@@ -4,10 +4,13 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h145-0-3" id="h145-0-3" class="d">-  target_id FLOAT DEFAULT NULL REFERENCES target
</a><a href="#h145-0-4" id="h145-0-4" class="i">+  target_id FLOAT DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Float(3.14)]
 
<a href="#h145-0-8" id="h145-0-8" class="i">+Index source.target_id
</a><a href="#h145-0-9" id="h145-0-9" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h145-0-10" id="h145-0-10" class="i">+
</a> CREATE TABLE target (
   id FLOAT PRIMARY KEY
 )
<b>diff --git a/<a id="h146" href="../file/tests/sql/schema/insert_ref_float_missing.html">tests/sql/schema/insert_ref_float_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_float_missing.html">tests/sql/schema/insert_ref_float_missing</a></b>
<a href="#h146-0" id="h146-0" class="h">@@ -4,9 +4,11 @@ Error: InvalidInput(&quot;referenced primary key 1.618 in table target does not exist
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h146-0-3" id="h146-0-3" class="d">-  target_id FLOAT DEFAULT NULL REFERENCES target
</a><a href="#h146-0-4" id="h146-0-4" class="i">+  target_id FLOAT DEFAULT NULL INDEX REFERENCES target
</a> )
 
<a href="#h146-0-7" id="h146-0-7" class="i">+Index source.target_id
</a><a href="#h146-0-8" id="h146-0-8" class="i">+
</a> CREATE TABLE target (
   id FLOAT PRIMARY KEY
 )
<b>diff --git a/<a id="h147" href="../file/tests/sql/schema/insert_ref_float_null.html">tests/sql/schema/insert_ref_float_null</a> b/<a href="../file/tests/sql/schema/insert_ref_float_null.html">tests/sql/schema/insert_ref_float_null</a></b>
<a href="#h147-0" id="h147-0" class="h">@@ -4,10 +4,13 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h147-0-3" id="h147-0-3" class="d">-  target_id FLOAT DEFAULT NULL REFERENCES target
</a><a href="#h147-0-4" id="h147-0-4" class="i">+  target_id FLOAT DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Null]
 
<a href="#h147-0-8" id="h147-0-8" class="i">+Index source.target_id
</a><a href="#h147-0-9" id="h147-0-9" class="i">+Null =&gt; [Integer(1)]
</a><a href="#h147-0-10" id="h147-0-10" class="i">+
</a> CREATE TABLE target (
   id FLOAT PRIMARY KEY
 )
<b>diff --git a/<a id="h148" href="../file/tests/sql/schema/insert_ref_integer.html">tests/sql/schema/insert_ref_integer</a> b/<a href="../file/tests/sql/schema/insert_ref_integer.html">tests/sql/schema/insert_ref_integer</a></b>
<a href="#h148-0" id="h148-0" class="h">@@ -4,10 +4,13 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h148-0-3" id="h148-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h148-0-4" id="h148-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 
<a href="#h148-0-8" id="h148-0-8" class="i">+Index source.target_id
</a><a href="#h148-0-9" id="h148-0-9" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h148-0-10" id="h148-0-10" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h149" href="../file/tests/sql/schema/insert_ref_integer_missing.html">tests/sql/schema/insert_ref_integer_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_integer_missing.html">tests/sql/schema/insert_ref_integer_missing</a></b>
<a href="#h149-0" id="h149-0" class="h">@@ -4,9 +4,11 @@ Error: InvalidInput(&quot;referenced primary key 7 in table target does not exist&quot;)
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h149-0-3" id="h149-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h149-0-4" id="h149-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 
<a href="#h149-0-7" id="h149-0-7" class="i">+Index source.target_id
</a><a href="#h149-0-8" id="h149-0-8" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h150" href="../file/tests/sql/schema/insert_ref_integer_null.html">tests/sql/schema/insert_ref_integer_null</a> b/<a href="../file/tests/sql/schema/insert_ref_integer_null.html">tests/sql/schema/insert_ref_integer_null</a></b>
<a href="#h150-0" id="h150-0" class="h">@@ -4,10 +4,13 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h150-0-3" id="h150-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h150-0-4" id="h150-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Null]
 
<a href="#h150-0-8" id="h150-0-8" class="i">+Index source.target_id
</a><a href="#h150-0-9" id="h150-0-9" class="i">+Null =&gt; [Integer(1)]
</a><a href="#h150-0-10" id="h150-0-10" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY
 )
<b>diff --git a/<a id="h151" href="../file/tests/sql/schema/insert_ref_self.html">tests/sql/schema/insert_ref_self</a> b/<a href="../file/tests/sql/schema/insert_ref_self.html">tests/sql/schema/insert_ref_self</a></b>
<a href="#h151-0" id="h151-0" class="h">@@ -4,7 +4,7 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h151-0-3" id="h151-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h151-0-4" id="h151-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
<a href="#h151-1" id="h151-1" class="h">@@ -12,3 +12,8 @@ CREATE TABLE self (
</a> [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
 [Integer(5), Integer(1), String(&quot;e&quot;)]
<a href="#h151-1-3" id="h151-1-3" class="i">+
</a><a href="#h151-1-4" id="h151-1-4" class="i">+Index self.self_id
</a><a href="#h151-1-5" id="h151-1-5" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h151-1-6" id="h151-1-6" class="i">+Integer(1) =&gt; [Integer(1), Integer(2), Integer(5)]
</a><a href="#h151-1-7" id="h151-1-7" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h152" href="../file/tests/sql/schema/insert_ref_self_missing.html">tests/sql/schema/insert_ref_self_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_self_missing.html">tests/sql/schema/insert_ref_self_missing</a></b>
<a href="#h152-0" id="h152-0" class="h">@@ -4,10 +4,15 @@ Error: InvalidInput(&quot;referenced primary key 9 in table self does not exist&quot;)
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h152-0-3" id="h152-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h152-0-4" id="h152-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
 [Integer(2), Integer(1), String(&quot;b&quot;)]
 [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
<a href="#h152-0-11" id="h152-0-11" class="i">+
</a><a href="#h152-0-12" id="h152-0-12" class="i">+Index self.self_id
</a><a href="#h152-0-13" id="h152-0-13" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h152-0-14" id="h152-0-14" class="i">+Integer(1) =&gt; [Integer(1), Integer(2)]
</a><a href="#h152-0-15" id="h152-0-15" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h153" href="../file/tests/sql/schema/insert_ref_self_null.html">tests/sql/schema/insert_ref_self_null</a> b/<a href="../file/tests/sql/schema/insert_ref_self_null.html">tests/sql/schema/insert_ref_self_null</a></b>
<a href="#h153-0" id="h153-0" class="h">@@ -4,7 +4,7 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h153-0-3" id="h153-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h153-0-4" id="h153-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
<a href="#h153-1" id="h153-1" class="h">@@ -12,3 +12,8 @@ CREATE TABLE self (
</a> [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
 [Integer(5), Null, String(&quot;e&quot;)]
<a href="#h153-1-3" id="h153-1-3" class="i">+
</a><a href="#h153-1-4" id="h153-1-4" class="i">+Index self.self_id
</a><a href="#h153-1-5" id="h153-1-5" class="i">+Null =&gt; [Integer(4), Integer(5)]
</a><a href="#h153-1-6" id="h153-1-6" class="i">+Integer(1) =&gt; [Integer(1), Integer(2)]
</a><a href="#h153-1-7" id="h153-1-7" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h154" href="../file/tests/sql/schema/insert_ref_self_self.html">tests/sql/schema/insert_ref_self_self</a> b/<a href="../file/tests/sql/schema/insert_ref_self_self.html">tests/sql/schema/insert_ref_self_self</a></b>
<a href="#h154-0" id="h154-0" class="h">@@ -4,7 +4,7 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h154-0-3" id="h154-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h154-0-4" id="h154-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
<a href="#h154-1" id="h154-1" class="h">@@ -12,3 +12,9 @@ CREATE TABLE self (
</a> [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
 [Integer(5), Integer(5), String(&quot;e&quot;)]
<a href="#h154-1-3" id="h154-1-3" class="i">+
</a><a href="#h154-1-4" id="h154-1-4" class="i">+Index self.self_id
</a><a href="#h154-1-5" id="h154-1-5" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h154-1-6" id="h154-1-6" class="i">+Integer(1) =&gt; [Integer(1), Integer(2)]
</a><a href="#h154-1-7" id="h154-1-7" class="i">+Integer(3) =&gt; [Integer(3)]
</a><a href="#h154-1-8" id="h154-1-8" class="i">+Integer(5) =&gt; [Integer(5)]
</a><b>diff --git a/<a id="h155" href="../file/tests/sql/schema/insert_ref_string.html">tests/sql/schema/insert_ref_string</a> b/<a href="../file/tests/sql/schema/insert_ref_string.html">tests/sql/schema/insert_ref_string</a></b>
<a href="#h155-0" id="h155-0" class="h">@@ -4,10 +4,13 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h155-0-3" id="h155-0-3" class="d">-  target_id STRING DEFAULT NULL REFERENCES target
</a><a href="#h155-0-4" id="h155-0-4" class="i">+  target_id STRING DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), String(&quot;foo&quot;)]
 
<a href="#h155-0-8" id="h155-0-8" class="i">+Index source.target_id
</a><a href="#h155-0-9" id="h155-0-9" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><a href="#h155-0-10" id="h155-0-10" class="i">+
</a> CREATE TABLE target (
   id STRING PRIMARY KEY
 )
<b>diff --git a/<a id="h156" href="../file/tests/sql/schema/insert_ref_string_case.html">tests/sql/schema/insert_ref_string_case</a> b/<a href="../file/tests/sql/schema/insert_ref_string_case.html">tests/sql/schema/insert_ref_string_case</a></b>
<a href="#h156-0" id="h156-0" class="h">@@ -4,9 +4,11 @@ Error: InvalidInput(&quot;referenced primary key Foo in table target does not exist&quot;)
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h156-0-3" id="h156-0-3" class="d">-  target_id STRING DEFAULT NULL REFERENCES target
</a><a href="#h156-0-4" id="h156-0-4" class="i">+  target_id STRING DEFAULT NULL INDEX REFERENCES target
</a> )
 
<a href="#h156-0-7" id="h156-0-7" class="i">+Index source.target_id
</a><a href="#h156-0-8" id="h156-0-8" class="i">+
</a> CREATE TABLE target (
   id STRING PRIMARY KEY
 )
<b>diff --git a/<a id="h157" href="../file/tests/sql/schema/insert_ref_string_missing.html">tests/sql/schema/insert_ref_string_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_string_missing.html">tests/sql/schema/insert_ref_string_missing</a></b>
<a href="#h157-0" id="h157-0" class="h">@@ -4,9 +4,11 @@ Error: InvalidInput(&quot;referenced primary key baz in table target does not exist&quot;)
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h157-0-3" id="h157-0-3" class="d">-  target_id STRING DEFAULT NULL REFERENCES target
</a><a href="#h157-0-4" id="h157-0-4" class="i">+  target_id STRING DEFAULT NULL INDEX REFERENCES target
</a> )
 
<a href="#h157-0-7" id="h157-0-7" class="i">+Index source.target_id
</a><a href="#h157-0-8" id="h157-0-8" class="i">+
</a> CREATE TABLE target (
   id STRING PRIMARY KEY
 )
<b>diff --git a/<a id="h158" href="../file/tests/sql/schema/insert_ref_string_null.html">tests/sql/schema/insert_ref_string_null</a> b/<a href="../file/tests/sql/schema/insert_ref_string_null.html">tests/sql/schema/insert_ref_string_null</a></b>
<a href="#h158-0" id="h158-0" class="h">@@ -4,10 +4,13 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h158-0-3" id="h158-0-3" class="d">-  target_id STRING DEFAULT NULL REFERENCES target
</a><a href="#h158-0-4" id="h158-0-4" class="i">+  target_id STRING DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Null]
 
<a href="#h158-0-8" id="h158-0-8" class="i">+Index source.target_id
</a><a href="#h158-0-9" id="h158-0-9" class="i">+Null =&gt; [Integer(1)]
</a><a href="#h158-0-10" id="h158-0-10" class="i">+
</a> CREATE TABLE target (
   id STRING PRIMARY KEY
 )
<b>diff --git a/<a id="h159" href="../file/tests/sql/schema/insert_unique_boolean.html">tests/sql/schema/insert_unique_boolean</a> b/<a href="../file/tests/sql/schema/insert_unique_boolean.html">tests/sql/schema/insert_unique_boolean</a></b>
<a href="#h159-0" id="h159-0" class="h">@@ -4,11 +4,28 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h159-0-3" id="h159-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h159-0-4" id="h159-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h159-0-5" id="h159-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h159-0-6" id="h159-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h159-0-7" id="h159-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h159-0-8" id="h159-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h159-0-9" id="h159-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h159-0-10" id="h159-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
 [Integer(2), Boolean(false), Null, Null, Null]
<a href="#h159-0-15" id="h159-0-15" class="i">+
</a><a href="#h159-0-16" id="h159-0-16" class="i">+Index unique.boolean
</a><a href="#h159-0-17" id="h159-0-17" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h159-0-18" id="h159-0-18" class="i">+Boolean(false) =&gt; [Integer(2)]
</a><a href="#h159-0-19" id="h159-0-19" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h159-0-20" id="h159-0-20" class="i">+
</a><a href="#h159-0-21" id="h159-0-21" class="i">+Index unique.float
</a><a href="#h159-0-22" id="h159-0-22" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h159-0-23" id="h159-0-23" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h159-0-24" id="h159-0-24" class="i">+
</a><a href="#h159-0-25" id="h159-0-25" class="i">+Index unique.integer
</a><a href="#h159-0-26" id="h159-0-26" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h159-0-27" id="h159-0-27" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h159-0-28" id="h159-0-28" class="i">+
</a><a href="#h159-0-29" id="h159-0-29" class="i">+Index unique.string
</a><a href="#h159-0-30" id="h159-0-30" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h159-0-31" id="h159-0-31" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h160" href="../file/tests/sql/schema/insert_unique_boolean_duplicate.html">tests/sql/schema/insert_unique_boolean_duplicate</a> b/<a href="../file/tests/sql/schema/insert_unique_boolean_duplicate.html">tests/sql/schema/insert_unique_boolean_duplicate</a></b>
<a href="#h160-0" id="h160-0" class="h">@@ -4,10 +4,26 @@ Error: InvalidInput(&quot;unique value TRUE already exists for column boolean&quot;)
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h160-0-3" id="h160-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h160-0-4" id="h160-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h160-0-5" id="h160-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h160-0-6" id="h160-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h160-0-7" id="h160-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h160-0-8" id="h160-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h160-0-9" id="h160-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h160-0-10" id="h160-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
<a href="#h160-0-14" id="h160-0-14" class="i">+
</a><a href="#h160-0-15" id="h160-0-15" class="i">+Index unique.boolean
</a><a href="#h160-0-16" id="h160-0-16" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h160-0-17" id="h160-0-17" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h160-0-18" id="h160-0-18" class="i">+
</a><a href="#h160-0-19" id="h160-0-19" class="i">+Index unique.float
</a><a href="#h160-0-20" id="h160-0-20" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h160-0-21" id="h160-0-21" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h160-0-22" id="h160-0-22" class="i">+
</a><a href="#h160-0-23" id="h160-0-23" class="i">+Index unique.integer
</a><a href="#h160-0-24" id="h160-0-24" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h160-0-25" id="h160-0-25" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h160-0-26" id="h160-0-26" class="i">+
</a><a href="#h160-0-27" id="h160-0-27" class="i">+Index unique.string
</a><a href="#h160-0-28" id="h160-0-28" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h160-0-29" id="h160-0-29" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h161" href="../file/tests/sql/schema/insert_unique_float.html">tests/sql/schema/insert_unique_float</a> b/<a href="../file/tests/sql/schema/insert_unique_float.html">tests/sql/schema/insert_unique_float</a></b>
<a href="#h161-0" id="h161-0" class="h">@@ -4,11 +4,28 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h161-0-3" id="h161-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h161-0-4" id="h161-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h161-0-5" id="h161-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h161-0-6" id="h161-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h161-0-7" id="h161-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h161-0-8" id="h161-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h161-0-9" id="h161-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h161-0-10" id="h161-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
 [Integer(2), Null, Float(2.718), Null, Null]
<a href="#h161-0-15" id="h161-0-15" class="i">+
</a><a href="#h161-0-16" id="h161-0-16" class="i">+Index unique.boolean
</a><a href="#h161-0-17" id="h161-0-17" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h161-0-18" id="h161-0-18" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h161-0-19" id="h161-0-19" class="i">+
</a><a href="#h161-0-20" id="h161-0-20" class="i">+Index unique.float
</a><a href="#h161-0-21" id="h161-0-21" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h161-0-22" id="h161-0-22" class="i">+Float(2.718) =&gt; [Integer(2)]
</a><a href="#h161-0-23" id="h161-0-23" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h161-0-24" id="h161-0-24" class="i">+
</a><a href="#h161-0-25" id="h161-0-25" class="i">+Index unique.integer
</a><a href="#h161-0-26" id="h161-0-26" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h161-0-27" id="h161-0-27" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h161-0-28" id="h161-0-28" class="i">+
</a><a href="#h161-0-29" id="h161-0-29" class="i">+Index unique.string
</a><a href="#h161-0-30" id="h161-0-30" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h161-0-31" id="h161-0-31" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h162" href="../file/tests/sql/schema/insert_unique_float_duplicate.html">tests/sql/schema/insert_unique_float_duplicate</a> b/<a href="../file/tests/sql/schema/insert_unique_float_duplicate.html">tests/sql/schema/insert_unique_float_duplicate</a></b>
<a href="#h162-0" id="h162-0" class="h">@@ -4,10 +4,26 @@ Error: InvalidInput(&quot;unique value 3.14 already exists for column float&quot;)
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h162-0-3" id="h162-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h162-0-4" id="h162-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h162-0-5" id="h162-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h162-0-6" id="h162-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h162-0-7" id="h162-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h162-0-8" id="h162-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h162-0-9" id="h162-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h162-0-10" id="h162-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
<a href="#h162-0-14" id="h162-0-14" class="i">+
</a><a href="#h162-0-15" id="h162-0-15" class="i">+Index unique.boolean
</a><a href="#h162-0-16" id="h162-0-16" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h162-0-17" id="h162-0-17" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h162-0-18" id="h162-0-18" class="i">+
</a><a href="#h162-0-19" id="h162-0-19" class="i">+Index unique.float
</a><a href="#h162-0-20" id="h162-0-20" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h162-0-21" id="h162-0-21" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h162-0-22" id="h162-0-22" class="i">+
</a><a href="#h162-0-23" id="h162-0-23" class="i">+Index unique.integer
</a><a href="#h162-0-24" id="h162-0-24" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h162-0-25" id="h162-0-25" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h162-0-26" id="h162-0-26" class="i">+
</a><a href="#h162-0-27" id="h162-0-27" class="i">+Index unique.string
</a><a href="#h162-0-28" id="h162-0-28" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h162-0-29" id="h162-0-29" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h163" href="../file/tests/sql/schema/insert_unique_integer.html">tests/sql/schema/insert_unique_integer</a> b/<a href="../file/tests/sql/schema/insert_unique_integer.html">tests/sql/schema/insert_unique_integer</a></b>
<a href="#h163-0" id="h163-0" class="h">@@ -4,11 +4,28 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h163-0-3" id="h163-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h163-0-4" id="h163-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h163-0-5" id="h163-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h163-0-6" id="h163-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h163-0-7" id="h163-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h163-0-8" id="h163-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h163-0-9" id="h163-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h163-0-10" id="h163-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
 [Integer(2), Null, Null, Integer(3), Null]
<a href="#h163-0-15" id="h163-0-15" class="i">+
</a><a href="#h163-0-16" id="h163-0-16" class="i">+Index unique.boolean
</a><a href="#h163-0-17" id="h163-0-17" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h163-0-18" id="h163-0-18" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h163-0-19" id="h163-0-19" class="i">+
</a><a href="#h163-0-20" id="h163-0-20" class="i">+Index unique.float
</a><a href="#h163-0-21" id="h163-0-21" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h163-0-22" id="h163-0-22" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h163-0-23" id="h163-0-23" class="i">+
</a><a href="#h163-0-24" id="h163-0-24" class="i">+Index unique.integer
</a><a href="#h163-0-25" id="h163-0-25" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h163-0-26" id="h163-0-26" class="i">+Integer(3) =&gt; [Integer(2)]
</a><a href="#h163-0-27" id="h163-0-27" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h163-0-28" id="h163-0-28" class="i">+
</a><a href="#h163-0-29" id="h163-0-29" class="i">+Index unique.string
</a><a href="#h163-0-30" id="h163-0-30" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h163-0-31" id="h163-0-31" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h164" href="../file/tests/sql/schema/insert_unique_integer_duplicate.html">tests/sql/schema/insert_unique_integer_duplicate</a> b/<a href="../file/tests/sql/schema/insert_unique_integer_duplicate.html">tests/sql/schema/insert_unique_integer_duplicate</a></b>
<a href="#h164-0" id="h164-0" class="h">@@ -4,10 +4,26 @@ Error: InvalidInput(&quot;unique value 7 already exists for column integer&quot;)
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h164-0-3" id="h164-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h164-0-4" id="h164-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h164-0-5" id="h164-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h164-0-6" id="h164-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h164-0-7" id="h164-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h164-0-8" id="h164-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h164-0-9" id="h164-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h164-0-10" id="h164-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
<a href="#h164-0-14" id="h164-0-14" class="i">+
</a><a href="#h164-0-15" id="h164-0-15" class="i">+Index unique.boolean
</a><a href="#h164-0-16" id="h164-0-16" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h164-0-17" id="h164-0-17" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h164-0-18" id="h164-0-18" class="i">+
</a><a href="#h164-0-19" id="h164-0-19" class="i">+Index unique.float
</a><a href="#h164-0-20" id="h164-0-20" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h164-0-21" id="h164-0-21" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h164-0-22" id="h164-0-22" class="i">+
</a><a href="#h164-0-23" id="h164-0-23" class="i">+Index unique.integer
</a><a href="#h164-0-24" id="h164-0-24" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h164-0-25" id="h164-0-25" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h164-0-26" id="h164-0-26" class="i">+
</a><a href="#h164-0-27" id="h164-0-27" class="i">+Index unique.string
</a><a href="#h164-0-28" id="h164-0-28" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h164-0-29" id="h164-0-29" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h165" href="../file/tests/sql/schema/insert_unique_nulls.html">tests/sql/schema/insert_unique_nulls</a> b/<a href="../file/tests/sql/schema/insert_unique_nulls.html">tests/sql/schema/insert_unique_nulls</a></b>
<a href="#h165-0" id="h165-0" class="h">@@ -4,11 +4,27 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h165-0-3" id="h165-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h165-0-4" id="h165-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h165-0-5" id="h165-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h165-0-6" id="h165-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h165-0-7" id="h165-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h165-0-8" id="h165-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h165-0-9" id="h165-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h165-0-10" id="h165-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
 [Integer(2), Null, Null, Null, Null]
<a href="#h165-0-15" id="h165-0-15" class="i">+
</a><a href="#h165-0-16" id="h165-0-16" class="i">+Index unique.boolean
</a><a href="#h165-0-17" id="h165-0-17" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h165-0-18" id="h165-0-18" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h165-0-19" id="h165-0-19" class="i">+
</a><a href="#h165-0-20" id="h165-0-20" class="i">+Index unique.float
</a><a href="#h165-0-21" id="h165-0-21" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h165-0-22" id="h165-0-22" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h165-0-23" id="h165-0-23" class="i">+
</a><a href="#h165-0-24" id="h165-0-24" class="i">+Index unique.integer
</a><a href="#h165-0-25" id="h165-0-25" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h165-0-26" id="h165-0-26" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h165-0-27" id="h165-0-27" class="i">+
</a><a href="#h165-0-28" id="h165-0-28" class="i">+Index unique.string
</a><a href="#h165-0-29" id="h165-0-29" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h165-0-30" id="h165-0-30" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h166" href="../file/tests/sql/schema/insert_unique_string.html">tests/sql/schema/insert_unique_string</a> b/<a href="../file/tests/sql/schema/insert_unique_string.html">tests/sql/schema/insert_unique_string</a></b>
<a href="#h166-0" id="h166-0" class="h">@@ -4,11 +4,28 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h166-0-3" id="h166-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h166-0-4" id="h166-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h166-0-5" id="h166-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h166-0-6" id="h166-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h166-0-7" id="h166-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h166-0-8" id="h166-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h166-0-9" id="h166-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h166-0-10" id="h166-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
 [Integer(2), Null, Null, Null, String(&quot;bar&quot;)]
<a href="#h166-0-15" id="h166-0-15" class="i">+
</a><a href="#h166-0-16" id="h166-0-16" class="i">+Index unique.boolean
</a><a href="#h166-0-17" id="h166-0-17" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h166-0-18" id="h166-0-18" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h166-0-19" id="h166-0-19" class="i">+
</a><a href="#h166-0-20" id="h166-0-20" class="i">+Index unique.float
</a><a href="#h166-0-21" id="h166-0-21" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h166-0-22" id="h166-0-22" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h166-0-23" id="h166-0-23" class="i">+
</a><a href="#h166-0-24" id="h166-0-24" class="i">+Index unique.integer
</a><a href="#h166-0-25" id="h166-0-25" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h166-0-26" id="h166-0-26" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h166-0-27" id="h166-0-27" class="i">+
</a><a href="#h166-0-28" id="h166-0-28" class="i">+Index unique.string
</a><a href="#h166-0-29" id="h166-0-29" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h166-0-30" id="h166-0-30" class="i">+String(&quot;bar&quot;) =&gt; [Integer(2)]
</a><a href="#h166-0-31" id="h166-0-31" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h167" href="../file/tests/sql/schema/insert_unique_string_case.html">tests/sql/schema/insert_unique_string_case</a> b/<a href="../file/tests/sql/schema/insert_unique_string_case.html">tests/sql/schema/insert_unique_string_case</a></b>
<a href="#h167-0" id="h167-0" class="h">@@ -4,11 +4,28 @@ Result: Create { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h167-0-3" id="h167-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h167-0-4" id="h167-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h167-0-5" id="h167-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h167-0-6" id="h167-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h167-0-7" id="h167-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h167-0-8" id="h167-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h167-0-9" id="h167-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h167-0-10" id="h167-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
 [Integer(2), Null, Null, Null, String(&quot;Foo&quot;)]
<a href="#h167-0-15" id="h167-0-15" class="i">+
</a><a href="#h167-0-16" id="h167-0-16" class="i">+Index unique.boolean
</a><a href="#h167-0-17" id="h167-0-17" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h167-0-18" id="h167-0-18" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h167-0-19" id="h167-0-19" class="i">+
</a><a href="#h167-0-20" id="h167-0-20" class="i">+Index unique.float
</a><a href="#h167-0-21" id="h167-0-21" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h167-0-22" id="h167-0-22" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h167-0-23" id="h167-0-23" class="i">+
</a><a href="#h167-0-24" id="h167-0-24" class="i">+Index unique.integer
</a><a href="#h167-0-25" id="h167-0-25" class="i">+Null =&gt; [Integer(0), Integer(2)]
</a><a href="#h167-0-26" id="h167-0-26" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h167-0-27" id="h167-0-27" class="i">+
</a><a href="#h167-0-28" id="h167-0-28" class="i">+Index unique.string
</a><a href="#h167-0-29" id="h167-0-29" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h167-0-30" id="h167-0-30" class="i">+String(&quot;Foo&quot;) =&gt; [Integer(2)]
</a><a href="#h167-0-31" id="h167-0-31" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h168" href="../file/tests/sql/schema/insert_unique_string_duplicate.html">tests/sql/schema/insert_unique_string_duplicate</a> b/<a href="../file/tests/sql/schema/insert_unique_string_duplicate.html">tests/sql/schema/insert_unique_string_duplicate</a></b>
<a href="#h168-0" id="h168-0" class="h">@@ -4,10 +4,26 @@ Error: InvalidInput(&quot;unique value foo already exists for column string&quot;)
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h168-0-3" id="h168-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h168-0-4" id="h168-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h168-0-5" id="h168-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h168-0-6" id="h168-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h168-0-7" id="h168-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h168-0-8" id="h168-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h168-0-9" id="h168-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h168-0-10" id="h168-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
<a href="#h168-0-14" id="h168-0-14" class="i">+
</a><a href="#h168-0-15" id="h168-0-15" class="i">+Index unique.boolean
</a><a href="#h168-0-16" id="h168-0-16" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h168-0-17" id="h168-0-17" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h168-0-18" id="h168-0-18" class="i">+
</a><a href="#h168-0-19" id="h168-0-19" class="i">+Index unique.float
</a><a href="#h168-0-20" id="h168-0-20" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h168-0-21" id="h168-0-21" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h168-0-22" id="h168-0-22" class="i">+
</a><a href="#h168-0-23" id="h168-0-23" class="i">+Index unique.integer
</a><a href="#h168-0-24" id="h168-0-24" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h168-0-25" id="h168-0-25" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h168-0-26" id="h168-0-26" class="i">+
</a><a href="#h168-0-27" id="h168-0-27" class="i">+Index unique.string
</a><a href="#h168-0-28" id="h168-0-28" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h168-0-29" id="h168-0-29" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h169" href="../file/tests/sql/schema/update_ref_pk.html">tests/sql/schema/update_ref_pk</a> b/<a href="../file/tests/sql/schema/update_ref_pk.html">tests/sql/schema/update_ref_pk</a></b>
<a href="#h169-0" id="h169-0" class="h">@@ -4,12 +4,17 @@ Error: InvalidInput(&quot;primary key 1 referenced by table source column target_id&quot;)
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h169-0-3" id="h169-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h169-0-4" id="h169-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
 [Integer(4), Null]
 
<a href="#h169-0-10" id="h169-0-10" class="i">+Index source.target_id
</a><a href="#h169-0-11" id="h169-0-11" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h169-0-12" id="h169-0-12" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h169-0-13" id="h169-0-13" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h169-0-14" id="h169-0-14" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h170" href="../file/tests/sql/schema/update_ref_pk_noref.html">tests/sql/schema/update_ref_pk_noref</a> b/<a href="../file/tests/sql/schema/update_ref_pk_noref.html">tests/sql/schema/update_ref_pk_noref</a></b>
<a href="#h170-0" id="h170-0" class="h">@@ -4,12 +4,17 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h170-0-3" id="h170-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h170-0-4" id="h170-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
 [Integer(4), Null]
 
<a href="#h170-0-10" id="h170-0-10" class="i">+Index source.target_id
</a><a href="#h170-0-11" id="h170-0-11" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h170-0-12" id="h170-0-12" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h170-0-13" id="h170-0-13" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h170-0-14" id="h170-0-14" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h171" href="../file/tests/sql/schema/update_ref_self_pk.html">tests/sql/schema/update_ref_self_pk</a> b/<a href="../file/tests/sql/schema/update_ref_self_pk.html">tests/sql/schema/update_ref_self_pk</a></b>
<a href="#h171-0" id="h171-0" class="h">@@ -4,10 +4,15 @@ Error: InvalidInput(&quot;primary key 1 referenced by table self column self_id&quot;)
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h171-0-3" id="h171-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h171-0-4" id="h171-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
 [Integer(2), Integer(1), String(&quot;b&quot;)]
 [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
<a href="#h171-0-11" id="h171-0-11" class="i">+
</a><a href="#h171-0-12" id="h171-0-12" class="i">+Index self.self_id
</a><a href="#h171-0-13" id="h171-0-13" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h171-0-14" id="h171-0-14" class="i">+Integer(1) =&gt; [Integer(1), Integer(2)]
</a><a href="#h171-0-15" id="h171-0-15" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h172" href="../file/tests/sql/schema/update_ref_self_pk_noref.html">tests/sql/schema/update_ref_self_pk_noref</a> b/<a href="../file/tests/sql/schema/update_ref_self_pk_noref.html">tests/sql/schema/update_ref_self_pk_noref</a></b>
<a href="#h172-0" id="h172-0" class="h">@@ -4,10 +4,15 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h172-0-3" id="h172-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h172-0-4" id="h172-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
 [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
 [Integer(9), Integer(1), String(&quot;b&quot;)]
<a href="#h172-0-11" id="h172-0-11" class="i">+
</a><a href="#h172-0-12" id="h172-0-12" class="i">+Index self.self_id
</a><a href="#h172-0-13" id="h172-0-13" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h172-0-14" id="h172-0-14" class="i">+Integer(1) =&gt; [Integer(1), Integer(9)]
</a><a href="#h172-0-15" id="h172-0-15" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h173" href="../file/tests/sql/schema/update_ref_self_self.html">tests/sql/schema/update_ref_self_self</a> b/<a href="../file/tests/sql/schema/update_ref_self_self.html">tests/sql/schema/update_ref_self_self</a></b>
<a href="#h173-0" id="h173-0" class="h">@@ -4,10 +4,16 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h173-0-3" id="h173-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h173-0-4" id="h173-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;a&quot;)]
 [Integer(2), Integer(2), String(&quot;b&quot;)]
 [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
<a href="#h173-0-11" id="h173-0-11" class="i">+
</a><a href="#h173-0-12" id="h173-0-12" class="i">+Index self.self_id
</a><a href="#h173-0-13" id="h173-0-13" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h173-0-14" id="h173-0-14" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h173-0-15" id="h173-0-15" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h173-0-16" id="h173-0-16" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h174" href="../file/tests/sql/schema/update_ref_self_value.html">tests/sql/schema/update_ref_self_value</a> b/<a href="../file/tests/sql/schema/update_ref_self_value.html">tests/sql/schema/update_ref_self_value</a></b>
<a href="#h174-0" id="h174-0" class="h">@@ -4,10 +4,15 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE self (
   id INTEGER PRIMARY KEY,
<a href="#h174-0-3" id="h174-0-3" class="d">-  self_id INTEGER DEFAULT NULL REFERENCES self,
</a><a href="#h174-0-4" id="h174-0-4" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self,
</a>   value STRING DEFAULT NULL
 )
 [Integer(1), Integer(1), String(&quot;x&quot;)]
 [Integer(2), Integer(1), String(&quot;b&quot;)]
 [Integer(3), Integer(3), String(&quot;c&quot;)]
 [Integer(4), Null, String(&quot;d&quot;)]
<a href="#h174-0-11" id="h174-0-11" class="i">+
</a><a href="#h174-0-12" id="h174-0-12" class="i">+Index self.self_id
</a><a href="#h174-0-13" id="h174-0-13" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h174-0-14" id="h174-0-14" class="i">+Integer(1) =&gt; [Integer(1), Integer(2)]
</a><a href="#h174-0-15" id="h174-0-15" class="i">+Integer(3) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h175" href="../file/tests/sql/schema/update_ref_source.html">tests/sql/schema/update_ref_source</a> b/<a href="../file/tests/sql/schema/update_ref_source.html">tests/sql/schema/update_ref_source</a></b>
<a href="#h175-0" id="h175-0" class="h">@@ -4,12 +4,16 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h175-0-3" id="h175-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h175-0-4" id="h175-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
 [Integer(4), Integer(1)]
 
<a href="#h175-0-10" id="h175-0-10" class="i">+Index source.target_id
</a><a href="#h175-0-11" id="h175-0-11" class="i">+Integer(1) =&gt; [Integer(1), Integer(4)]
</a><a href="#h175-0-12" id="h175-0-12" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h175-0-13" id="h175-0-13" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h176" href="../file/tests/sql/schema/update_ref_source_missing.html">tests/sql/schema/update_ref_source_missing</a> b/<a href="../file/tests/sql/schema/update_ref_source_missing.html">tests/sql/schema/update_ref_source_missing</a></b>
<a href="#h176-0" id="h176-0" class="h">@@ -4,12 +4,17 @@ Error: InvalidInput(&quot;referenced primary key 9 in table target does not exist&quot;)
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h176-0-3" id="h176-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h176-0-4" id="h176-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
 [Integer(4), Null]
 
<a href="#h176-0-10" id="h176-0-10" class="i">+Index source.target_id
</a><a href="#h176-0-11" id="h176-0-11" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h176-0-12" id="h176-0-12" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h176-0-13" id="h176-0-13" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h176-0-14" id="h176-0-14" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h177" href="../file/tests/sql/schema/update_ref_source_null.html">tests/sql/schema/update_ref_source_null</a> b/<a href="../file/tests/sql/schema/update_ref_source_null.html">tests/sql/schema/update_ref_source_null</a></b>
<a href="#h177-0" id="h177-0" class="h">@@ -4,12 +4,16 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h177-0-3" id="h177-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h177-0-4" id="h177-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 [Integer(2), Null]
 [Integer(4), Null]
 
<a href="#h177-0-10" id="h177-0-10" class="i">+Index source.target_id
</a><a href="#h177-0-11" id="h177-0-11" class="i">+Null =&gt; [Integer(2), Integer(4)]
</a><a href="#h177-0-12" id="h177-0-12" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h177-0-13" id="h177-0-13" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h178" href="../file/tests/sql/schema/update_ref_value.html">tests/sql/schema/update_ref_value</a> b/<a href="../file/tests/sql/schema/update_ref_value.html">tests/sql/schema/update_ref_value</a></b>
<a href="#h178-0" id="h178-0" class="h">@@ -4,12 +4,17 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE source (
   id INTEGER PRIMARY KEY,
<a href="#h178-0-3" id="h178-0-3" class="d">-  target_id INTEGER DEFAULT NULL REFERENCES target
</a><a href="#h178-0-4" id="h178-0-4" class="i">+  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a> )
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
 [Integer(4), Null]
 
<a href="#h178-0-10" id="h178-0-10" class="i">+Index source.target_id
</a><a href="#h178-0-11" id="h178-0-11" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h178-0-12" id="h178-0-12" class="i">+Integer(1) =&gt; [Integer(1)]
</a><a href="#h178-0-13" id="h178-0-13" class="i">+Integer(2) =&gt; [Integer(2)]
</a><a href="#h178-0-14" id="h178-0-14" class="i">+
</a> CREATE TABLE target (
   id INTEGER PRIMARY KEY,
   value STRING DEFAULT NULL
<b>diff --git a/<a id="h179" href="../file/tests/sql/schema/update_unique_boolean.html">tests/sql/schema/update_unique_boolean</a> b/<a href="../file/tests/sql/schema/update_unique_boolean.html">tests/sql/schema/update_unique_boolean</a></b>
<a href="#h179-0" id="h179-0" class="h">@@ -4,10 +4,26 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h179-0-3" id="h179-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h179-0-4" id="h179-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h179-0-5" id="h179-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h179-0-6" id="h179-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h179-0-7" id="h179-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h179-0-8" id="h179-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h179-0-9" id="h179-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h179-0-10" id="h179-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Boolean(false), Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
<a href="#h179-0-14" id="h179-0-14" class="i">+
</a><a href="#h179-0-15" id="h179-0-15" class="i">+Index unique.boolean
</a><a href="#h179-0-16" id="h179-0-16" class="i">+Boolean(false) =&gt; [Integer(0)]
</a><a href="#h179-0-17" id="h179-0-17" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h179-0-18" id="h179-0-18" class="i">+
</a><a href="#h179-0-19" id="h179-0-19" class="i">+Index unique.float
</a><a href="#h179-0-20" id="h179-0-20" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h179-0-21" id="h179-0-21" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h179-0-22" id="h179-0-22" class="i">+
</a><a href="#h179-0-23" id="h179-0-23" class="i">+Index unique.integer
</a><a href="#h179-0-24" id="h179-0-24" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h179-0-25" id="h179-0-25" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h179-0-26" id="h179-0-26" class="i">+
</a><a href="#h179-0-27" id="h179-0-27" class="i">+Index unique.string
</a><a href="#h179-0-28" id="h179-0-28" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h179-0-29" id="h179-0-29" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h180" href="../file/tests/sql/schema/update_unique_boolean_duplicate.html">tests/sql/schema/update_unique_boolean_duplicate</a> b/<a href="../file/tests/sql/schema/update_unique_boolean_duplicate.html">tests/sql/schema/update_unique_boolean_duplicate</a></b>
<a href="#h180-0" id="h180-0" class="h">@@ -4,10 +4,26 @@ Error: InvalidInput(&quot;unique value TRUE already exists for column boolean&quot;)
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h180-0-3" id="h180-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h180-0-4" id="h180-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h180-0-5" id="h180-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h180-0-6" id="h180-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h180-0-7" id="h180-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h180-0-8" id="h180-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h180-0-9" id="h180-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h180-0-10" id="h180-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
<a href="#h180-0-14" id="h180-0-14" class="i">+
</a><a href="#h180-0-15" id="h180-0-15" class="i">+Index unique.boolean
</a><a href="#h180-0-16" id="h180-0-16" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h180-0-17" id="h180-0-17" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h180-0-18" id="h180-0-18" class="i">+
</a><a href="#h180-0-19" id="h180-0-19" class="i">+Index unique.float
</a><a href="#h180-0-20" id="h180-0-20" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h180-0-21" id="h180-0-21" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h180-0-22" id="h180-0-22" class="i">+
</a><a href="#h180-0-23" id="h180-0-23" class="i">+Index unique.integer
</a><a href="#h180-0-24" id="h180-0-24" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h180-0-25" id="h180-0-25" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h180-0-26" id="h180-0-26" class="i">+
</a><a href="#h180-0-27" id="h180-0-27" class="i">+Index unique.string
</a><a href="#h180-0-28" id="h180-0-28" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h180-0-29" id="h180-0-29" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h181" href="../file/tests/sql/schema/update_unique_boolean_same.html">tests/sql/schema/update_unique_boolean_same</a> b/<a href="../file/tests/sql/schema/update_unique_boolean_same.html">tests/sql/schema/update_unique_boolean_same</a></b>
<a href="#h181-0" id="h181-0" class="h">@@ -4,10 +4,26 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h181-0-3" id="h181-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h181-0-4" id="h181-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h181-0-5" id="h181-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h181-0-6" id="h181-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h181-0-7" id="h181-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h181-0-8" id="h181-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h181-0-9" id="h181-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h181-0-10" id="h181-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Boolean(true), Float(3.14), Integer(7), String(&quot;foo&quot;)]
<a href="#h181-0-14" id="h181-0-14" class="i">+
</a><a href="#h181-0-15" id="h181-0-15" class="i">+Index unique.boolean
</a><a href="#h181-0-16" id="h181-0-16" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h181-0-17" id="h181-0-17" class="i">+Boolean(true) =&gt; [Integer(1)]
</a><a href="#h181-0-18" id="h181-0-18" class="i">+
</a><a href="#h181-0-19" id="h181-0-19" class="i">+Index unique.float
</a><a href="#h181-0-20" id="h181-0-20" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h181-0-21" id="h181-0-21" class="i">+Float(3.14) =&gt; [Integer(1)]
</a><a href="#h181-0-22" id="h181-0-22" class="i">+
</a><a href="#h181-0-23" id="h181-0-23" class="i">+Index unique.integer
</a><a href="#h181-0-24" id="h181-0-24" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h181-0-25" id="h181-0-25" class="i">+Integer(7) =&gt; [Integer(1)]
</a><a href="#h181-0-26" id="h181-0-26" class="i">+
</a><a href="#h181-0-27" id="h181-0-27" class="i">+Index unique.string
</a><a href="#h181-0-28" id="h181-0-28" class="i">+Null =&gt; [Integer(0)]
</a><a href="#h181-0-29" id="h181-0-29" class="i">+String(&quot;foo&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h182" href="../file/tests/sql/schema/update_unique_nulls.html">tests/sql/schema/update_unique_nulls</a> b/<a href="../file/tests/sql/schema/update_unique_nulls.html">tests/sql/schema/update_unique_nulls</a></b>
<a href="#h182-0" id="h182-0" class="h">@@ -4,10 +4,22 @@ Result: Update { count: 1 }
</a> Storage:
 CREATE TABLE &quot;unique&quot; (
   id INTEGER PRIMARY KEY,
<a href="#h182-0-3" id="h182-0-3" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE,
</a><a href="#h182-0-4" id="h182-0-4" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE,
</a><a href="#h182-0-5" id="h182-0-5" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE,
</a><a href="#h182-0-6" id="h182-0-6" class="d">-  &quot;string&quot; STRING DEFAULT NULL UNIQUE
</a><a href="#h182-0-7" id="h182-0-7" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL UNIQUE INDEX,
</a><a href="#h182-0-8" id="h182-0-8" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL UNIQUE INDEX,
</a><a href="#h182-0-9" id="h182-0-9" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h182-0-10" id="h182-0-10" class="i">+  &quot;string&quot; STRING DEFAULT NULL UNIQUE INDEX
</a> )
 [Integer(0), Null, Null, Null, Null]
 [Integer(1), Null, Null, Null, Null]
<a href="#h182-0-14" id="h182-0-14" class="i">+
</a><a href="#h182-0-15" id="h182-0-15" class="i">+Index unique.boolean
</a><a href="#h182-0-16" id="h182-0-16" class="i">+Null =&gt; [Integer(0), Integer(1)]
</a><a href="#h182-0-17" id="h182-0-17" class="i">+
</a><a href="#h182-0-18" id="h182-0-18" class="i">+Index unique.float
</a><a href="#h182-0-19" id="h182-0-19" class="i">+Null =&gt; [Integer(0), Integer(1)]
</a><a href="#h182-0-20" id="h182-0-20" class="i">+
</a><a href="#h182-0-21" id="h182-0-21" class="i">+Index unique.integer
</a><a href="#h182-0-22" id="h182-0-22" class="i">+Null =&gt; [Integer(0), Integer(1)]
</a><a href="#h182-0-23" id="h182-0-23" class="i">+
</a><a href="#h182-0-24" id="h182-0-24" class="i">+Index unique.string
</a><a href="#h182-0-25" id="h182-0-25" class="i">+Null =&gt; [Integer(0), Integer(1)]
</a></pre>
</div>
</body>
</html>
