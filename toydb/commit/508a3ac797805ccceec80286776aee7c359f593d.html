<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: add index support (fixes #4) - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/508a3ac797805ccceec80286776aee7c359f593d.html">508a3ac797805ccceec80286776aee7c359f593d</a>
<b>parent</b> <a href="../commit/2576756db7f8b3ff501c9761ad928d96dc22bfc5.html">2576756db7f8b3ff501c9761ad928d96dc22bfc5</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Mon, 13 Apr 2020 19:21:15 +0200

sql: add index support (fixes #4)

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">README.md</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">REFERENCE.md</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/bin/bank.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/engine/kv.rs</a></td><td> | </td><td class="num">169</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/engine/mod.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/engine/raft.rs</a></td><td> | </td><td class="num">44</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="A">A</td><td><a href="#h6">src/sql/execution/index_lookup.rs</a></td><td> | </td><td class="num">59</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/execution/mod.rs</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/parser/ast.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/parser/lexer.rs</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/plan/mod.rs</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/sql/plan/optimizer.rs</a></td><td> | </td><td class="num">45</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">src/sql/schema.rs</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/client/mod.rs</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/dml.rs</a></td><td> | </td><td class="num">16</td><td><span class="i">+++++++++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/dml/delete_all</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/dml/delete_bare</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/dml/delete_bare_from</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/dml/delete_bare_where</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/dml/delete_case</a></td><td> | </td><td class="num">6</td><td><span class="i">+++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/dml/delete_missing_column_where</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/dml/delete_missing_table</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/dml/delete_multiple_tables</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/dml/delete_where</a></td><td> | </td><td class="num">6</td><td><span class="i">+++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/dml/delete_where_and</a></td><td> | </td><td class="num">6</td><td><span class="i">+++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/dml/delete_where_expr</a></td><td> | </td><td class="num">6</td><td><span class="i">+++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/dml/delete_where_false</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/dml/delete_where_float</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/dml/delete_where_integer</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/dml/delete_where_null</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/dml/delete_where_string</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/dml/delete_where_true</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/dml/insert_bare</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/dml/insert_bare_no_table</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/dml/insert_bare_values</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/dml/insert_case</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/dml/insert_empty_both</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/dml/insert_empty_columns</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/dml/insert_empty_values</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">tests/sql/dml/insert_expression</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">tests/sql/dml/insert_extra</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">tests/sql/dml/insert_extra_columns</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">tests/sql/dml/insert_full</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">tests/sql/dml/insert_full_multiple</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">tests/sql/dml/insert_full_order</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">tests/sql/dml/insert_full_trailing_comma</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">tests/sql/dml/insert_missing_column</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">tests/sql/dml/insert_missing_table</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">tests/sql/dml/insert_multiple_tables</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">tests/sql/dml/insert_no_columns</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">tests/sql/dml/insert_no_columns_multiple</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">tests/sql/dml/insert_partial</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">tests/sql/dml/insert_partial_columns</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">tests/sql/dml/insert_partial_vary</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">tests/sql/dml/update_all</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">tests/sql/dml/update_bare</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">tests/sql/dml/update_bare_no_table</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">tests/sql/dml/update_bare_set</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">tests/sql/dml/update_bare_where</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">tests/sql/dml/update_case</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">tests/sql/dml/update_missing_column_set</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">tests/sql/dml/update_missing_column_where</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">tests/sql/dml/update_missing_table</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">tests/sql/dml/update_multiple_tables</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">tests/sql/dml/update_where</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">tests/sql/dml/update_where_and</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">tests/sql/dml/update_where_expr</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">tests/sql/dml/update_where_false</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">tests/sql/dml/update_where_float</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">tests/sql/dml/update_where_full</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">tests/sql/dml/update_where_integer</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">tests/sql/dml/update_where_null</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">tests/sql/dml/update_where_string</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">tests/sql/dml/update_where_true</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">tests/sql/query.rs</a></td><td> | </td><td class="num">7</td><td><span class="i">++++</span><span class="d">---</span></td></tr>
<tr><td class="A">A</td><td><a href="#h77">tests/sql/query/where_index_lookup</a></td><td> | </td><td class="num">80</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h78">tests/sql/schema.rs</a></td><td> | </td><td class="num">35</td><td><span class="i">+++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h79">tests/sql/schema/create_table_index</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h80">tests/sql/schema/create_table_index_pk</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h81">tests/sql/schema/delete_index_all</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h82">tests/sql/schema/delete_index_only</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h83">tests/sql/schema/delete_index_single</a></td><td> | </td><td class="num">15</td><td><span class="i">+++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h84">tests/sql/schema/insert_index_exists</a></td><td> | </td><td class="num">17</td><td><span class="i">+++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h85">tests/sql/schema/insert_index_new</a></td><td> | </td><td class="num">18</td><td><span class="i">++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h86">tests/sql/schema/insert_index_null</a></td><td> | </td><td class="num">18</td><td><span class="i">++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h87">tests/sql/schema/update_index_existing</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h88">tests/sql/schema/update_index_last</a></td><td> | </td><td class="num">15</td><td><span class="i">+++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h89">tests/sql/schema/update_index_new</a></td><td> | </td><td class="num">17</td><td><span class="i">+++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h90">tests/sql/schema/update_index_null</a></td><td> | </td><td class="num">17</td><td><span class="i">+++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h91">tests/sql/schema/update_index_pk</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h92">tests/sql/schema/update_index_same</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h93">tests/sql/schema/update_index_swap</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
</table></pre><pre>94 files changed, 985 insertions(+), 99 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/README.md.html">README.md</a> b/<a href="../file/README.md.html">README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -8,7 +8,7 @@ Distributed SQL database in Rust, written as a learning project. Most components
</a> 
 * ACID-compliant transaction engine with MVCC-based snapshot isolation.
 
<a href="#h0-0-3" id="h0-0-3" class="d">-* Iterator-based query engine with heuristic optimization and time-travel support.
</a><a href="#h0-0-4" id="h0-0-4" class="i">+* Iterator-based query engine with heuristic optimization, secondary indexes, and time-travel support.
</a> 
 * SQL interface including projections, filters, joins, and aggregates.
 
<b>diff --git a/<a id="h1" href="../file/REFERENCE.md.html">REFERENCE.md</a> b/<a href="../file/REFERENCE.md.html">REFERENCE.md</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -19,7 +19,7 @@ Numeric types are not interchangable; a float value (even without a fractional p
</a> 
 Keywords are reserved words with special meaning in SQL statements. They are case-insensitive, and must be quoted with `&quot;` to be used as identifiers. The complete list is:
 
<a href="#h1-0-3" id="h1-0-3" class="d">-`AS`, `ASC`, `AND`, `BEGIN`, `BOOL`, `BOOLEAN`, `BY`, `CHAR`, `COMMIT`, `CREATE`, `CROSS`, `DEFAULT`,`DELETE`, `DESC`, `DOUBLE`, `DROP`, `EXPLAIN`, `FALSE`, `FLOAT`, `FROM`, `GROUP`, `HAVING`, `INFINITY`, `INNER`, `INSERT`, `INT`, `INTEGER`, `INTO`, `IS`, `JOIN`, `KEY`, `LEFT`, `LIKE`, `LIMIT`, `NAN`, `NOT`, `NULL`, `OF`, `OFFSET`, `ON`, `ONLY`, `OR`, `ORDER`, `OUTER`, `PRIMARY`, `READ`, `REFERENCES`, `RIGHT`, `ROLLBACK`, `SELECT`, `SET`, `STRING`, `SYSTEM`, `TABLE`, `TEXT`, `TIME`, `TRANSACTION`, `TRUE`, `UNIQUE`, `UPDATE`, `VALUES`, `VARCHAR`, `WHERE`, `WRITE`
</a><a href="#h1-0-4" id="h1-0-4" class="i">+`AS`, `ASC`, `AND`, `BEGIN`, `BOOL`, `BOOLEAN`, `BY`, `CHAR`, `COMMIT`, `CREATE`, `CROSS`, `DEFAULT`,`DELETE`, `DESC`, `DOUBLE`, `DROP`, `EXPLAIN`, `FALSE`, `FLOAT`, `FROM`, `GROUP`, `HAVING`, `INDEX`, `INFINITY`, `INNER`, `INSERT`, `INT`, `INTEGER`, `INTO`, `IS`, `JOIN`, `KEY`, `LEFT`, `LIKE`, `LIMIT`, `NAN`, `NOT`, `NULL`, `OF`, `OFFSET`, `ON`, `ONLY`, `OR`, `ORDER`, `OUTER`, `PRIMARY`, `READ`, `REFERENCES`, `RIGHT`, `ROLLBACK`, `SELECT`, `SET`, `STRING`, `SYSTEM`, `TABLE`, `TEXT`, `TIME`, `TRANSACTION`, `TRUE`, `UNIQUE`, `UPDATE`, `VALUES`, `VARCHAR`, `WHERE`, `WRITE`
</a> 
 ### Identifiers
 
<a href="#h1-1" id="h1-1" class="h">@@ -190,7 +190,7 @@ Creates a new table.
</a> 
 &lt;pre&gt;
 CREATE TABLE &lt;b&gt;&lt;i&gt;table_name&lt;/i&gt;&lt;/b&gt; (
<a href="#h1-1-3" id="h1-1-3" class="d">-    [ &lt;b&gt;&lt;i&gt;column_name&lt;/i&gt;&lt;/b&gt; &lt;b&gt;&lt;i&gt;data_type&lt;/i&gt;&lt;/b&gt; [ &lt;b&gt;&lt;i&gt;column_constraint&lt;/i&gt;&lt;/b&gt; [ ... ] ] [, ... ] ]
</a><a href="#h1-1-4" id="h1-1-4" class="i">+    [ &lt;b&gt;&lt;i&gt;column_name&lt;/i&gt;&lt;/b&gt; &lt;b&gt;&lt;i&gt;data_type&lt;/i&gt;&lt;/b&gt; [ &lt;b&gt;&lt;i&gt;column_constraint&lt;/i&gt;&lt;/b&gt; [ ... ] ]  [ INDEX ] [, ... ] ]
</a> )
 
 where &lt;b&gt;&lt;i&gt;column_constraint&lt;/i&gt;&lt;/b&gt; is:
<a href="#h1-2" id="h1-2" class="h">@@ -216,14 +216,16 @@ where &lt;b&gt;&lt;i&gt;column_constraint&lt;/i&gt;&lt;/b&gt; is:
</a> 
 * `UNIQUE`: The column may only contain unique (distinct) values. `NULL` values are not considered equal, thus a `UNIQUE` column which allows `NULL` may contain multiple `NULL` values. `PRIMARY KEY` columns are implicitly `UNIQUE`.
 
<a href="#h1-2-3" id="h1-2-3" class="i">+* `INDEX`: Create an index for the column.
</a><a href="#h1-2-4" id="h1-2-4" class="i">+
</a> #### Example
 
 ```sql
 CREATE TABLE movie (
     id INTEGER PRIMARY KEY,
     title STRING NOT NULL,
<a href="#h1-2-11" id="h1-2-11" class="d">-    release_year INTEGER,
</a><a href="#h1-2-12" id="h1-2-12" class="d">-    imdb_id STRING UNIQUE,
</a><a href="#h1-2-13" id="h1-2-13" class="i">+    release_year INTEGER INDEX,
</a><a href="#h1-2-14" id="h1-2-14" class="i">+    imdb_id STRING INDEX UNIQUE,
</a>     bluray BOOLEAN NOT NULL DEFAULT TRUE
 )
 ```
<b>diff --git a/<a id="h2" href="../file/src/bin/bank.rs.html">src/bin/bank.rs</a> b/<a href="../file/src/bin/bank.rs.html">src/bin/bank.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -252,7 +252,7 @@ impl Bank {
</a>         client.query(
             &quot;CREATE TABLE account (
                 id INTEGER PRIMARY KEY,
<a href="#h2-0-3" id="h2-0-3" class="d">-                customer_id INTEGER NOT NULL REFERENCES customer,
</a><a href="#h2-0-4" id="h2-0-4" class="i">+                customer_id INTEGER NOT NULL INDEX REFERENCES customer,
</a>                 balance INTEGER NOT NULL
            )&quot;,
         )?;
<b>diff --git a/<a id="h3" href="../file/src/sql/engine/kv.rs.html">src/sql/engine/kv.rs</a> b/<a href="../file/src/sql/engine/kv.rs.html">src/sql/engine/kv.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -5,6 +5,8 @@ use crate::kv;
</a> use crate::utility::{deserialize, serialize};
 use crate::Error;
 
<a href="#h3-0-3" id="h3-0-3" class="i">+use std::collections::HashSet;
</a><a href="#h3-0-4" id="h3-0-4" class="i">+
</a> /// A SQL engine based on an underlying MVCC key/value store
 pub struct KV&lt;S: kv::storage::Storage&gt; {
     /// The underlying key/value store
<a href="#h3-1" id="h3-1" class="h">@@ -47,6 +49,40 @@ impl&lt;S: kv::storage::Storage&gt; Transaction&lt;S&gt; {
</a>     fn new(txn: kv::Transaction&lt;S&gt;) -&gt; Self {
         Self { txn }
     }
<a href="#h3-1-3" id="h3-1-3" class="i">+
</a><a href="#h3-1-4" id="h3-1-4" class="i">+    /// Loads an index entry
</a><a href="#h3-1-5" id="h3-1-5" class="i">+    fn index_load(
</a><a href="#h3-1-6" id="h3-1-6" class="i">+        &amp;self,
</a><a href="#h3-1-7" id="h3-1-7" class="i">+        table: &amp;str,
</a><a href="#h3-1-8" id="h3-1-8" class="i">+        column: &amp;str,
</a><a href="#h3-1-9" id="h3-1-9" class="i">+        value: &amp;Value,
</a><a href="#h3-1-10" id="h3-1-10" class="i">+    ) -&gt; Result&lt;HashSet&lt;Value&gt;, Error&gt; {
</a><a href="#h3-1-11" id="h3-1-11" class="i">+        let key = Key::Index(table, column, value).encode();
</a><a href="#h3-1-12" id="h3-1-12" class="i">+        if let Some(value) = self.txn.get(&amp;key)? {
</a><a href="#h3-1-13" id="h3-1-13" class="i">+            let item: (Value, HashSet&lt;Value&gt;) = deserialize(&amp;value)?;
</a><a href="#h3-1-14" id="h3-1-14" class="i">+            Ok(item.1)
</a><a href="#h3-1-15" id="h3-1-15" class="i">+        } else {
</a><a href="#h3-1-16" id="h3-1-16" class="i">+            Ok(HashSet::new())
</a><a href="#h3-1-17" id="h3-1-17" class="i">+        }
</a><a href="#h3-1-18" id="h3-1-18" class="i">+    }
</a><a href="#h3-1-19" id="h3-1-19" class="i">+
</a><a href="#h3-1-20" id="h3-1-20" class="i">+    /// Saves an index entry.
</a><a href="#h3-1-21" id="h3-1-21" class="i">+    /// FIXME We save the index key as part of the value, to avoid having to implement key decoders
</a><a href="#h3-1-22" id="h3-1-22" class="i">+    /// right now.
</a><a href="#h3-1-23" id="h3-1-23" class="i">+    fn index_save(
</a><a href="#h3-1-24" id="h3-1-24" class="i">+        &amp;mut self,
</a><a href="#h3-1-25" id="h3-1-25" class="i">+        table: &amp;str,
</a><a href="#h3-1-26" id="h3-1-26" class="i">+        column: &amp;str,
</a><a href="#h3-1-27" id="h3-1-27" class="i">+        value: &amp;Value,
</a><a href="#h3-1-28" id="h3-1-28" class="i">+        index: HashSet&lt;Value&gt;,
</a><a href="#h3-1-29" id="h3-1-29" class="i">+    ) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h3-1-30" id="h3-1-30" class="i">+        let key = Key::Index(table, column, value).encode();
</a><a href="#h3-1-31" id="h3-1-31" class="i">+        if index.is_empty() {
</a><a href="#h3-1-32" id="h3-1-32" class="i">+            self.txn.delete(&amp;key)
</a><a href="#h3-1-33" id="h3-1-33" class="i">+        } else {
</a><a href="#h3-1-34" id="h3-1-34" class="i">+            self.txn.set(&amp;key, serialize(&amp;(value, index))?)
</a><a href="#h3-1-35" id="h3-1-35" class="i">+        }
</a><a href="#h3-1-36" id="h3-1-36" class="i">+    }
</a> }
 
 impl&lt;S: kv::storage::Storage&gt; super::Transaction for Transaction&lt;S&gt; {
<a href="#h3-2" id="h3-2" class="h">@@ -76,12 +112,31 @@ impl&lt;S: kv::storage::Storage&gt; super::Transaction for Transaction&lt;S&gt; {
</a>                 id, table.name
             )));
         }
<a href="#h3-2-3" id="h3-2-3" class="d">-        self.txn.set(&amp;Key::Row(&amp;table.name, &amp;id).encode(), serialize(&amp;row)?)
</a><a href="#h3-2-4" id="h3-2-4" class="i">+        self.txn.set(&amp;Key::Row(&amp;table.name, &amp;id).encode(), serialize(&amp;row)?)?;
</a><a href="#h3-2-5" id="h3-2-5" class="i">+
</a><a href="#h3-2-6" id="h3-2-6" class="i">+        // Update indexes
</a><a href="#h3-2-7" id="h3-2-7" class="i">+        for (i, column) in table.columns.iter().enumerate().filter(|(_, c)| c.index) {
</a><a href="#h3-2-8" id="h3-2-8" class="i">+            let mut index = self.index_load(&amp;table.name, &amp;column.name, &amp;row[i])?;
</a><a href="#h3-2-9" id="h3-2-9" class="i">+            index.insert(id.clone());
</a><a href="#h3-2-10" id="h3-2-10" class="i">+            self.index_save(&amp;table.name, &amp;column.name, &amp;row[i], index)?;
</a><a href="#h3-2-11" id="h3-2-11" class="i">+        }
</a><a href="#h3-2-12" id="h3-2-12" class="i">+        Ok(())
</a>     }
 
     fn delete(&amp;mut self, table: &amp;str, id: &amp;Value) -&gt; Result&lt;(), Error&gt; {
         let table = self.must_read_table(&amp;table)?;
         table.assert_unreferenced_key(id, self)?;
<a href="#h3-2-18" id="h3-2-18" class="i">+
</a><a href="#h3-2-19" id="h3-2-19" class="i">+        let indexes: Vec&lt;_&gt; = table.columns.iter().enumerate().filter(|(_, c)| c.index).collect();
</a><a href="#h3-2-20" id="h3-2-20" class="i">+        if !indexes.is_empty() {
</a><a href="#h3-2-21" id="h3-2-21" class="i">+            if let Some(row) = self.read(&amp;table.name, id)? {
</a><a href="#h3-2-22" id="h3-2-22" class="i">+                for (i, column) in indexes {
</a><a href="#h3-2-23" id="h3-2-23" class="i">+                    let mut index = self.index_load(&amp;table.name, &amp;column.name, &amp;row[i])?;
</a><a href="#h3-2-24" id="h3-2-24" class="i">+                    index.remove(id);
</a><a href="#h3-2-25" id="h3-2-25" class="i">+                    self.index_save(&amp;table.name, &amp;column.name, &amp;row[i], index)?;
</a><a href="#h3-2-26" id="h3-2-26" class="i">+                }
</a><a href="#h3-2-27" id="h3-2-27" class="i">+            }
</a><a href="#h3-2-28" id="h3-2-28" class="i">+        }
</a>         self.txn.delete(&amp;Key::Row(&amp;table.name, id).encode())
     }
 
<a href="#h3-3" id="h3-3" class="h">@@ -89,6 +144,18 @@ impl&lt;S: kv::storage::Storage&gt; super::Transaction for Transaction&lt;S&gt; {
</a>         self.txn.get(&amp;Key::Row(table, id).encode())?.map(|v| deserialize(&amp;v)).transpose()
     }
 
<a href="#h3-3-3" id="h3-3-3" class="i">+    fn read_index(
</a><a href="#h3-3-4" id="h3-3-4" class="i">+        &amp;self,
</a><a href="#h3-3-5" id="h3-3-5" class="i">+        table: &amp;str,
</a><a href="#h3-3-6" id="h3-3-6" class="i">+        column: &amp;str,
</a><a href="#h3-3-7" id="h3-3-7" class="i">+        value: &amp;Value,
</a><a href="#h3-3-8" id="h3-3-8" class="i">+    ) -&gt; Result&lt;HashSet&lt;Value&gt;, Error&gt; {
</a><a href="#h3-3-9" id="h3-3-9" class="i">+        if !self.must_read_table(table)?.get_column(column)?.index {
</a><a href="#h3-3-10" id="h3-3-10" class="i">+            return Err(Error::Value(format!(&quot;No index on {}.{}&quot;, table, column)));
</a><a href="#h3-3-11" id="h3-3-11" class="i">+        }
</a><a href="#h3-3-12" id="h3-3-12" class="i">+        self.index_load(table, column, value)
</a><a href="#h3-3-13" id="h3-3-13" class="i">+    }
</a><a href="#h3-3-14" id="h3-3-14" class="i">+
</a>     fn scan(&amp;self, table: &amp;str, filter: Option&lt;Expression&gt;) -&gt; Result&lt;super::Scan, Error&gt; {
         let table = self.must_read_table(&amp;table)?;
         let scan = self
<a href="#h3-4" id="h3-4" class="h">@@ -115,16 +182,54 @@ impl&lt;S: kv::storage::Storage&gt; super::Transaction for Transaction&lt;S&gt; {
</a>         Ok(Box::new(scan.collect::&lt;Vec&lt;Result&lt;Row, Error&gt;&gt;&gt;().into_iter()))
     }
 
<a href="#h3-4-3" id="h3-4-3" class="i">+    fn scan_index(&amp;self, table: &amp;str, column: &amp;str) -&gt; Result&lt;super::IndexScan, Error&gt; {
</a><a href="#h3-4-4" id="h3-4-4" class="i">+        let table = self.must_read_table(&amp;table)?;
</a><a href="#h3-4-5" id="h3-4-5" class="i">+        let column = table.get_column(column)?;
</a><a href="#h3-4-6" id="h3-4-6" class="i">+        if !column.index {
</a><a href="#h3-4-7" id="h3-4-7" class="i">+            return Err(Error::Value(format!(&quot;No index for {}.{}&quot;, table.name, column.name)));
</a><a href="#h3-4-8" id="h3-4-8" class="i">+        }
</a><a href="#h3-4-9" id="h3-4-9" class="i">+
</a><a href="#h3-4-10" id="h3-4-10" class="i">+        let scan = self
</a><a href="#h3-4-11" id="h3-4-11" class="i">+            .txn
</a><a href="#h3-4-12" id="h3-4-12" class="i">+            .scan(
</a><a href="#h3-4-13" id="h3-4-13" class="i">+                &amp;Key::IndexStart(&amp;table.name, &amp;column.name).encode()
</a><a href="#h3-4-14" id="h3-4-14" class="i">+                    ..&amp;Key::IndexEnd(&amp;table.name, &amp;column.name).encode(),
</a><a href="#h3-4-15" id="h3-4-15" class="i">+            )?
</a><a href="#h3-4-16" id="h3-4-16" class="i">+            .map(|r| r.and_then(|(_, v)| deserialize(&amp;v)));
</a><a href="#h3-4-17" id="h3-4-17" class="i">+
</a><a href="#h3-4-18" id="h3-4-18" class="i">+        // FIXME We buffer results here, to avoid dealing with trait lifetimes right now
</a><a href="#h3-4-19" id="h3-4-19" class="i">+        Ok(Box::new(scan.collect::&lt;Vec&lt;Result&lt;(Value, HashSet&lt;Value&gt;), Error&gt;&gt;&gt;().into_iter()))
</a><a href="#h3-4-20" id="h3-4-20" class="i">+    }
</a><a href="#h3-4-21" id="h3-4-21" class="i">+
</a>     fn update(&amp;mut self, table: &amp;str, id: &amp;Value, row: Row) -&gt; Result&lt;(), Error&gt; {
         let table = self.must_read_table(&amp;table)?;
         // If the primary key changes we do a delete and create, otherwise we replace the row
         if id != &amp;table.get_row_key(&amp;row)? {
             self.delete(&amp;table.name, id)?;
<a href="#h3-4-27" id="h3-4-27" class="d">-            self.create(&amp;table.name, row)
</a><a href="#h3-4-28" id="h3-4-28" class="d">-        } else {
</a><a href="#h3-4-29" id="h3-4-29" class="d">-            table.validate_row(&amp;row, self)?;
</a><a href="#h3-4-30" id="h3-4-30" class="d">-            self.txn.set(&amp;Key::Row(&amp;table.name, &amp;id).encode(), serialize(&amp;row)?)
</a><a href="#h3-4-31" id="h3-4-31" class="i">+            self.create(&amp;table.name, row)?;
</a><a href="#h3-4-32" id="h3-4-32" class="i">+            return Ok(());
</a><a href="#h3-4-33" id="h3-4-33" class="i">+        }
</a><a href="#h3-4-34" id="h3-4-34" class="i">+
</a><a href="#h3-4-35" id="h3-4-35" class="i">+        // Update indexes, knowing that the primary key has not changed
</a><a href="#h3-4-36" id="h3-4-36" class="i">+        let indexes: Vec&lt;_&gt; = table.columns.iter().enumerate().filter(|(_, c)| c.index).collect();
</a><a href="#h3-4-37" id="h3-4-37" class="i">+        if !indexes.is_empty() {
</a><a href="#h3-4-38" id="h3-4-38" class="i">+            let old = self.read(&amp;table.name, id)?.unwrap();
</a><a href="#h3-4-39" id="h3-4-39" class="i">+            for (i, column) in indexes {
</a><a href="#h3-4-40" id="h3-4-40" class="i">+                if old[i] == row[i] {
</a><a href="#h3-4-41" id="h3-4-41" class="i">+                    continue;
</a><a href="#h3-4-42" id="h3-4-42" class="i">+                }
</a><a href="#h3-4-43" id="h3-4-43" class="i">+                let mut index = self.index_load(&amp;table.name, &amp;column.name, &amp;old[i])?;
</a><a href="#h3-4-44" id="h3-4-44" class="i">+                index.remove(id);
</a><a href="#h3-4-45" id="h3-4-45" class="i">+                self.index_save(&amp;table.name, &amp;column.name, &amp;old[i], index)?;
</a><a href="#h3-4-46" id="h3-4-46" class="i">+
</a><a href="#h3-4-47" id="h3-4-47" class="i">+                let mut index = self.index_load(&amp;table.name, &amp;column.name, &amp;row[i])?;
</a><a href="#h3-4-48" id="h3-4-48" class="i">+                index.insert(id.clone());
</a><a href="#h3-4-49" id="h3-4-49" class="i">+                self.index_save(&amp;table.name, &amp;column.name, &amp;row[i], index)?;
</a><a href="#h3-4-50" id="h3-4-50" class="i">+            }
</a>         }
<a href="#h3-4-52" id="h3-4-52" class="i">+
</a><a href="#h3-4-53" id="h3-4-53" class="i">+        table.validate_row(&amp;row, self)?;
</a><a href="#h3-4-54" id="h3-4-54" class="i">+        self.txn.set(&amp;Key::Row(&amp;table.name, &amp;id).encode(), serialize(&amp;row)?)
</a>     }
 }
 
<a href="#h3-5" id="h3-5" class="h">@@ -170,6 +275,12 @@ enum Key&lt;&#39;a&gt; {
</a>     Table(&amp;&#39;a str),
     /// The end of the table schema keyspace
     TableEnd,
<a href="#h3-5-3" id="h3-5-3" class="i">+    /// The start of the index keyspace for a table and column
</a><a href="#h3-5-4" id="h3-5-4" class="i">+    IndexStart(&amp;&#39;a str, &amp;&#39;a str),
</a><a href="#h3-5-5" id="h3-5-5" class="i">+    /// A key for an index entry
</a><a href="#h3-5-6" id="h3-5-6" class="i">+    Index(&amp;&#39;a str, &amp;&#39;a str, &amp;&#39;a Value),
</a><a href="#h3-5-7" id="h3-5-7" class="i">+    /// The end of the index keyspace for a table and column
</a><a href="#h3-5-8" id="h3-5-8" class="i">+    IndexEnd(&amp;&#39;a str, &amp;&#39;a str),
</a>     /// The start of the row keyspace of the given table name
     RowStart(&amp;&#39;a str),
     /// A key for a row identified by table name and row primary key
<a href="#h3-6" id="h3-6" class="h">@@ -185,22 +296,48 @@ impl&lt;&#39;a&gt; Key&lt;&#39;a&gt; {
</a>             Self::TableStart =&gt; vec![0x01],
             Self::Table(name) =&gt; [vec![0x01], name.as_bytes().to_vec()].concat(),
             Self::TableEnd =&gt; vec![0x02],
<a href="#h3-6-3" id="h3-6-3" class="d">-            Self::RowStart(table) =&gt; [vec![0x03], table.as_bytes().to_vec(), vec![0x00]].concat(),
</a><a href="#h3-6-4" id="h3-6-4" class="d">-            Self::Row(table, pk) =&gt; [
</a><a href="#h3-6-5" id="h3-6-5" class="i">+            Self::IndexStart(table, column) =&gt; [
</a>                 vec![0x03],
                 table.as_bytes().to_vec(),
                 vec![0x00],
<a href="#h3-6-9" id="h3-6-9" class="d">-                match pk {
</a><a href="#h3-6-10" id="h3-6-10" class="d">-                    Value::Boolean(b) if *b =&gt; vec![0x01],
</a><a href="#h3-6-11" id="h3-6-11" class="d">-                    Value::Boolean(_) =&gt; vec![0x00],
</a><a href="#h3-6-12" id="h3-6-12" class="d">-                    Value::Float(f) =&gt; f.to_be_bytes().to_vec(),
</a><a href="#h3-6-13" id="h3-6-13" class="d">-                    Value::Integer(i) =&gt; i.to_be_bytes().to_vec(),
</a><a href="#h3-6-14" id="h3-6-14" class="d">-                    Value::String(s) =&gt; s.as_bytes().to_vec(),
</a><a href="#h3-6-15" id="h3-6-15" class="d">-                    Value::Null =&gt; panic!(&quot;Received NULL primary key&quot;),
</a><a href="#h3-6-16" id="h3-6-16" class="d">-                },
</a><a href="#h3-6-17" id="h3-6-17" class="i">+                column.as_bytes().to_vec(),
</a><a href="#h3-6-18" id="h3-6-18" class="i">+                vec![0x00],
</a><a href="#h3-6-19" id="h3-6-19" class="i">+            ]
</a><a href="#h3-6-20" id="h3-6-20" class="i">+            .concat(),
</a><a href="#h3-6-21" id="h3-6-21" class="i">+            Self::Index(table, column, value) =&gt; [
</a><a href="#h3-6-22" id="h3-6-22" class="i">+                vec![0x03],
</a><a href="#h3-6-23" id="h3-6-23" class="i">+                table.as_bytes().to_vec(),
</a><a href="#h3-6-24" id="h3-6-24" class="i">+                vec![0x00],
</a><a href="#h3-6-25" id="h3-6-25" class="i">+                column.as_bytes().to_vec(),
</a><a href="#h3-6-26" id="h3-6-26" class="i">+                vec![0x00],
</a><a href="#h3-6-27" id="h3-6-27" class="i">+                Self::encode_value(value),
</a><a href="#h3-6-28" id="h3-6-28" class="i">+            ]
</a><a href="#h3-6-29" id="h3-6-29" class="i">+            .concat(),
</a><a href="#h3-6-30" id="h3-6-30" class="i">+            Self::IndexEnd(table, column) =&gt; [
</a><a href="#h3-6-31" id="h3-6-31" class="i">+                vec![0x03],
</a><a href="#h3-6-32" id="h3-6-32" class="i">+                table.as_bytes().to_vec(),
</a><a href="#h3-6-33" id="h3-6-33" class="i">+                vec![0x00],
</a><a href="#h3-6-34" id="h3-6-34" class="i">+                column.as_bytes().to_vec(),
</a><a href="#h3-6-35" id="h3-6-35" class="i">+                vec![0xff],
</a>             ]
             .concat(),
<a href="#h3-6-38" id="h3-6-38" class="d">-            Self::RowEnd(table) =&gt; [vec![0x03], table.as_bytes().to_vec(), vec![0xff]].concat(),
</a><a href="#h3-6-39" id="h3-6-39" class="i">+            Self::RowStart(table) =&gt; [vec![0x05], table.as_bytes().to_vec(), vec![0x00]].concat(),
</a><a href="#h3-6-40" id="h3-6-40" class="i">+            Self::Row(table, pk) =&gt; {
</a><a href="#h3-6-41" id="h3-6-41" class="i">+                [vec![0x05], table.as_bytes().to_vec(), vec![0x00], Self::encode_value(pk)].concat()
</a><a href="#h3-6-42" id="h3-6-42" class="i">+            }
</a><a href="#h3-6-43" id="h3-6-43" class="i">+            Self::RowEnd(table) =&gt; [vec![0x05], table.as_bytes().to_vec(), vec![0xff]].concat(),
</a><a href="#h3-6-44" id="h3-6-44" class="i">+        }
</a><a href="#h3-6-45" id="h3-6-45" class="i">+    }
</a><a href="#h3-6-46" id="h3-6-46" class="i">+
</a><a href="#h3-6-47" id="h3-6-47" class="i">+    /// Encodes a value as a byte vector
</a><a href="#h3-6-48" id="h3-6-48" class="i">+    fn encode_value(value: &amp;Value) -&gt; Vec&lt;u8&gt; {
</a><a href="#h3-6-49" id="h3-6-49" class="i">+        match value {
</a><a href="#h3-6-50" id="h3-6-50" class="i">+            Value::Boolean(b) if *b =&gt; vec![0x01],
</a><a href="#h3-6-51" id="h3-6-51" class="i">+            Value::Boolean(_) =&gt; vec![0x00],
</a><a href="#h3-6-52" id="h3-6-52" class="i">+            Value::Float(f) =&gt; f.to_be_bytes().to_vec(),
</a><a href="#h3-6-53" id="h3-6-53" class="i">+            Value::Integer(i) =&gt; i.to_be_bytes().to_vec(),
</a><a href="#h3-6-54" id="h3-6-54" class="i">+            Value::String(s) =&gt; s.as_bytes().to_vec(),
</a><a href="#h3-6-55" id="h3-6-55" class="i">+            Value::Null =&gt; vec![],
</a>         }
     }
 }
<b>diff --git a/<a id="h4" href="../file/src/sql/engine/mod.rs.html">src/sql/engine/mod.rs</a> b/<a href="../file/src/sql/engine/mod.rs.html">src/sql/engine/mod.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -11,6 +11,8 @@ use super::schema::Catalog;
</a> use super::types::{Expression, Row, Value};
 use crate::Error;
 
<a href="#h4-0-3" id="h4-0-3" class="i">+use std::collections::HashSet;
</a><a href="#h4-0-4" id="h4-0-4" class="i">+
</a> /// The SQL engine interface
 pub trait Engine: Clone {
     /// The transaction type
<a href="#h4-1" id="h4-1" class="h">@@ -62,8 +64,13 @@ pub trait Transaction: Catalog {
</a>     fn delete(&amp;mut self, table: &amp;str, id: &amp;Value) -&gt; Result&lt;(), Error&gt;;
     /// Reads a table row, if it exists
     fn read(&amp;self, table: &amp;str, id: &amp;Value) -&gt; Result&lt;Option&lt;Row&gt;, Error&gt;;
<a href="#h4-1-3" id="h4-1-3" class="i">+    /// Reads an index entry, if it exists
</a><a href="#h4-1-4" id="h4-1-4" class="i">+    fn read_index(&amp;self, table: &amp;str, column: &amp;str, value: &amp;Value)
</a><a href="#h4-1-5" id="h4-1-5" class="i">+        -&gt; Result&lt;HashSet&lt;Value&gt;, Error&gt;;
</a>     /// Scans a table&#39;s rows
     fn scan(&amp;self, table: &amp;str, filter: Option&lt;Expression&gt;) -&gt; Result&lt;Scan, Error&gt;;
<a href="#h4-1-8" id="h4-1-8" class="i">+    /// Scans a column&#39;s index entries
</a><a href="#h4-1-9" id="h4-1-9" class="i">+    fn scan_index(&amp;self, table: &amp;str, column: &amp;str) -&gt; Result&lt;IndexScan, Error&gt;;
</a>     /// Updates a table row
     fn update(&amp;mut self, table: &amp;str, id: &amp;Value, row: Row) -&gt; Result&lt;(), Error&gt;;
 }
<a href="#h4-2" id="h4-2" class="h">@@ -155,3 +162,7 @@ pub type Mode = crate::kv::Mode;
</a> 
 /// A row scan iterator
 pub type Scan = Box&lt;dyn DoubleEndedIterator&lt;Item = Result&lt;Row, Error&gt;&gt; + Send&gt;;
<a href="#h4-2-3" id="h4-2-3" class="i">+
</a><a href="#h4-2-4" id="h4-2-4" class="i">+/// An index scan iterator
</a><a href="#h4-2-5" id="h4-2-5" class="i">+pub type IndexScan =
</a><a href="#h4-2-6" id="h4-2-6" class="i">+    Box&lt;dyn DoubleEndedIterator&lt;Item = Result&lt;(Value, HashSet&lt;Value&gt;), Error&gt;&gt; + Send&gt;;
</a><b>diff --git a/<a id="h5" href="../file/src/sql/engine/raft.rs.html">src/sql/engine/raft.rs</a> b/<a href="../file/src/sql/engine/raft.rs.html">src/sql/engine/raft.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -6,6 +6,8 @@ use crate::raft;
</a> use crate::utility::{deserialize, serialize};
 use crate::Error;
 
<a href="#h5-0-3" id="h5-0-3" class="i">+use std::collections::HashSet;
</a><a href="#h5-0-4" id="h5-0-4" class="i">+
</a> /// A Raft state machine mutation
 #[derive(Clone, Serialize, Deserialize)]
 enum Mutation {
<a href="#h5-1" id="h5-1" class="h">@@ -37,8 +39,12 @@ enum Query {
</a> 
     /// Reads a row
     Read { txn_id: u64, table: String, id: Value },
<a href="#h5-1-3" id="h5-1-3" class="i">+    /// Reads an index entry
</a><a href="#h5-1-4" id="h5-1-4" class="i">+    ReadIndex { txn_id: u64, table: String, column: String, value: Value },
</a>     /// Scans a table&#39;s rows
     Scan { txn_id: u64, table: String, filter: Option&lt;Expression&gt; },
<a href="#h5-1-7" id="h5-1-7" class="i">+    /// Scans an index
</a><a href="#h5-1-8" id="h5-1-8" class="i">+    ScanIndex { txn_id: u64, table: String, column: String },
</a> 
     /// Scans the tables
     ScanTables { txn_id: u64 },
<a href="#h5-2" id="h5-2" class="h">@@ -143,6 +149,20 @@ impl super::Transaction for Transaction {
</a>         })?)?)
     }
 
<a href="#h5-2-3" id="h5-2-3" class="i">+    fn read_index(
</a><a href="#h5-2-4" id="h5-2-4" class="i">+        &amp;self,
</a><a href="#h5-2-5" id="h5-2-5" class="i">+        table: &amp;str,
</a><a href="#h5-2-6" id="h5-2-6" class="i">+        column: &amp;str,
</a><a href="#h5-2-7" id="h5-2-7" class="i">+        value: &amp;Value,
</a><a href="#h5-2-8" id="h5-2-8" class="i">+    ) -&gt; Result&lt;HashSet&lt;Value&gt;, Error&gt; {
</a><a href="#h5-2-9" id="h5-2-9" class="i">+        deserialize(&amp;self.raft.query(serialize(&amp;Query::ReadIndex {
</a><a href="#h5-2-10" id="h5-2-10" class="i">+            txn_id: self.id,
</a><a href="#h5-2-11" id="h5-2-11" class="i">+            table: table.to_string(),
</a><a href="#h5-2-12" id="h5-2-12" class="i">+            column: column.to_string(),
</a><a href="#h5-2-13" id="h5-2-13" class="i">+            value: value.clone(),
</a><a href="#h5-2-14" id="h5-2-14" class="i">+        })?)?)
</a><a href="#h5-2-15" id="h5-2-15" class="i">+    }
</a><a href="#h5-2-16" id="h5-2-16" class="i">+
</a>     fn scan(&amp;self, table: &amp;str, filter: Option&lt;Expression&gt;) -&gt; Result&lt;super::Scan, Error&gt; {
         Ok(Box::new(
             deserialize::&lt;Vec&lt;_&gt;&gt;(&amp;self.raft.query(serialize(&amp;Query::Scan {
<a href="#h5-3" id="h5-3" class="h">@@ -155,6 +175,18 @@ impl super::Transaction for Transaction {
</a>         ))
     }
 
<a href="#h5-3-3" id="h5-3-3" class="i">+    fn scan_index(&amp;self, table: &amp;str, column: &amp;str) -&gt; Result&lt;super::IndexScan, Error&gt; {
</a><a href="#h5-3-4" id="h5-3-4" class="i">+        Ok(Box::new(
</a><a href="#h5-3-5" id="h5-3-5" class="i">+            deserialize::&lt;Vec&lt;_&gt;&gt;(&amp;self.raft.query(serialize(&amp;Query::ScanIndex {
</a><a href="#h5-3-6" id="h5-3-6" class="i">+                txn_id: self.id,
</a><a href="#h5-3-7" id="h5-3-7" class="i">+                table: table.to_string(),
</a><a href="#h5-3-8" id="h5-3-8" class="i">+                column: column.to_string(),
</a><a href="#h5-3-9" id="h5-3-9" class="i">+            })?)?)?
</a><a href="#h5-3-10" id="h5-3-10" class="i">+            .into_iter()
</a><a href="#h5-3-11" id="h5-3-11" class="i">+            .map(Ok),
</a><a href="#h5-3-12" id="h5-3-12" class="i">+        ))
</a><a href="#h5-3-13" id="h5-3-13" class="i">+    }
</a><a href="#h5-3-14" id="h5-3-14" class="i">+
</a>     fn update(&amp;mut self, table: &amp;str, id: &amp;Value, row: Row) -&gt; Result&lt;(), Error&gt; {
         deserialize(&amp;self.raft.mutate(serialize(&amp;Mutation::Update {
             txn_id: self.id,
<a href="#h5-4" id="h5-4" class="h">@@ -248,7 +280,10 @@ impl&lt;S: kv::storage::Storage&gt; raft::State for State&lt;S&gt; {
</a>             Query::Read { txn_id, table, id } =&gt; {
                 serialize(&amp;self.engine.resume(txn_id)?.read(&amp;table, &amp;id)?)
             }
<a href="#h5-4-3" id="h5-4-3" class="d">-            // FIXME This needs to stream rows somehow
</a><a href="#h5-4-4" id="h5-4-4" class="i">+            Query::ReadIndex { txn_id, table, column, value } =&gt; {
</a><a href="#h5-4-5" id="h5-4-5" class="i">+                serialize(&amp;self.engine.resume(txn_id)?.read_index(&amp;table, &amp;column, &amp;value)?)
</a><a href="#h5-4-6" id="h5-4-6" class="i">+            }
</a><a href="#h5-4-7" id="h5-4-7" class="i">+            // FIXME These need to stream rows somehow
</a>             Query::Scan { txn_id, table, filter } =&gt; serialize(
                 &amp;self
                     .engine
<a href="#h5-5" id="h5-5" class="h">@@ -256,6 +291,13 @@ impl&lt;S: kv::storage::Storage&gt; raft::State for State&lt;S&gt; {
</a>                     .scan(&amp;table, filter)?
                     .collect::&lt;Result&lt;Vec&lt;_&gt;, Error&gt;&gt;()?,
             ),
<a href="#h5-5-3" id="h5-5-3" class="i">+            Query::ScanIndex { txn_id, table, column } =&gt; serialize(
</a><a href="#h5-5-4" id="h5-5-4" class="i">+                &amp;self
</a><a href="#h5-5-5" id="h5-5-5" class="i">+                    .engine
</a><a href="#h5-5-6" id="h5-5-6" class="i">+                    .resume(txn_id)?
</a><a href="#h5-5-7" id="h5-5-7" class="i">+                    .scan_index(&amp;table, &amp;column)?
</a><a href="#h5-5-8" id="h5-5-8" class="i">+                    .collect::&lt;Result&lt;Vec&lt;_&gt;, Error&gt;&gt;()?,
</a><a href="#h5-5-9" id="h5-5-9" class="i">+            ),
</a> 
             Query::ReadTable { txn_id, table } =&gt; {
                 serialize(&amp;self.engine.resume(txn_id)?.read_table(&amp;table)?)
<b>diff --git a/<a id="h6" href="../file/src/sql/execution/index_lookup.rs.html">src/sql/execution/index_lookup.rs</a> b/<a href="../file/src/sql/execution/index_lookup.rs.html">src/sql/execution/index_lookup.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -0,0 +1,59 @@
</a><a href="#h6-0-0" id="h6-0-0" class="i">+use super::super::engine::Transaction;
</a><a href="#h6-0-1" id="h6-0-1" class="i">+use super::super::types::{Column, Relation, Row, Value};
</a><a href="#h6-0-2" id="h6-0-2" class="i">+use super::{Context, Executor, ResultSet};
</a><a href="#h6-0-3" id="h6-0-3" class="i">+use crate::Error;
</a><a href="#h6-0-4" id="h6-0-4" class="i">+
</a><a href="#h6-0-5" id="h6-0-5" class="i">+use std::collections::HashSet;
</a><a href="#h6-0-6" id="h6-0-6" class="i">+
</a><a href="#h6-0-7" id="h6-0-7" class="i">+/// A primary key lookup executor
</a><a href="#h6-0-8" id="h6-0-8" class="i">+pub struct IndexLookup {
</a><a href="#h6-0-9" id="h6-0-9" class="i">+    /// The table to look up
</a><a href="#h6-0-10" id="h6-0-10" class="i">+    table: String,
</a><a href="#h6-0-11" id="h6-0-11" class="i">+    /// The table alias to use
</a><a href="#h6-0-12" id="h6-0-12" class="i">+    /// FIXME Shouldn&#39;t be here, see: https://github.com/erikgrinaker/toydb/issues/21
</a><a href="#h6-0-13" id="h6-0-13" class="i">+    alias: Option&lt;String&gt;,
</a><a href="#h6-0-14" id="h6-0-14" class="i">+    /// The column index to use
</a><a href="#h6-0-15" id="h6-0-15" class="i">+    column: String,
</a><a href="#h6-0-16" id="h6-0-16" class="i">+    /// The index values to look up
</a><a href="#h6-0-17" id="h6-0-17" class="i">+    keys: Vec&lt;Value&gt;,
</a><a href="#h6-0-18" id="h6-0-18" class="i">+}
</a><a href="#h6-0-19" id="h6-0-19" class="i">+
</a><a href="#h6-0-20" id="h6-0-20" class="i">+impl IndexLookup {
</a><a href="#h6-0-21" id="h6-0-21" class="i">+    pub fn new(
</a><a href="#h6-0-22" id="h6-0-22" class="i">+        table: String,
</a><a href="#h6-0-23" id="h6-0-23" class="i">+        alias: Option&lt;String&gt;,
</a><a href="#h6-0-24" id="h6-0-24" class="i">+        column: String,
</a><a href="#h6-0-25" id="h6-0-25" class="i">+        keys: Vec&lt;Value&gt;,
</a><a href="#h6-0-26" id="h6-0-26" class="i">+    ) -&gt; Box&lt;Self&gt; {
</a><a href="#h6-0-27" id="h6-0-27" class="i">+        Box::new(Self { table, alias, column, keys })
</a><a href="#h6-0-28" id="h6-0-28" class="i">+    }
</a><a href="#h6-0-29" id="h6-0-29" class="i">+}
</a><a href="#h6-0-30" id="h6-0-30" class="i">+
</a><a href="#h6-0-31" id="h6-0-31" class="i">+impl&lt;T: Transaction&gt; Executor&lt;T&gt; for IndexLookup {
</a><a href="#h6-0-32" id="h6-0-32" class="i">+    fn execute(self: Box&lt;Self&gt;, ctx: &amp;mut Context&lt;T&gt;) -&gt; Result&lt;ResultSet, Error&gt; {
</a><a href="#h6-0-33" id="h6-0-33" class="i">+        let table = ctx.txn.must_read_table(&amp;self.table)?;
</a><a href="#h6-0-34" id="h6-0-34" class="i">+        let name = if let Some(alias) = &amp;self.alias { alias } else { &amp;table.name };
</a><a href="#h6-0-35" id="h6-0-35" class="i">+
</a><a href="#h6-0-36" id="h6-0-36" class="i">+        let mut pks: HashSet&lt;Value&gt; = HashSet::new();
</a><a href="#h6-0-37" id="h6-0-37" class="i">+        for key in self.keys {
</a><a href="#h6-0-38" id="h6-0-38" class="i">+            pks.extend(ctx.txn.read_index(&amp;self.table, &amp;self.column, &amp;key)?);
</a><a href="#h6-0-39" id="h6-0-39" class="i">+        }
</a><a href="#h6-0-40" id="h6-0-40" class="i">+
</a><a href="#h6-0-41" id="h6-0-41" class="i">+        // FIXME Is there a way to pass the txn into an iterator closure instead?
</a><a href="#h6-0-42" id="h6-0-42" class="i">+        let rows = pks
</a><a href="#h6-0-43" id="h6-0-43" class="i">+            .into_iter()
</a><a href="#h6-0-44" id="h6-0-44" class="i">+            .filter_map(|pk| ctx.txn.read(&amp;table.name, &amp;pk).transpose())
</a><a href="#h6-0-45" id="h6-0-45" class="i">+            .collect::&lt;Result&lt;Vec&lt;Row&gt;, Error&gt;&gt;()?;
</a><a href="#h6-0-46" id="h6-0-46" class="i">+
</a><a href="#h6-0-47" id="h6-0-47" class="i">+        Ok(ResultSet::Query {
</a><a href="#h6-0-48" id="h6-0-48" class="i">+            relation: Relation {
</a><a href="#h6-0-49" id="h6-0-49" class="i">+                columns: table
</a><a href="#h6-0-50" id="h6-0-50" class="i">+                    .columns
</a><a href="#h6-0-51" id="h6-0-51" class="i">+                    .iter()
</a><a href="#h6-0-52" id="h6-0-52" class="i">+                    .map(|c| Column { relation: Some(name.clone()), name: Some(c.name.clone()) })
</a><a href="#h6-0-53" id="h6-0-53" class="i">+                    .collect(),
</a><a href="#h6-0-54" id="h6-0-54" class="i">+                rows: Some(Box::new(rows.into_iter().map(Ok))),
</a><a href="#h6-0-55" id="h6-0-55" class="i">+            },
</a><a href="#h6-0-56" id="h6-0-56" class="i">+        })
</a><a href="#h6-0-57" id="h6-0-57" class="i">+    }
</a><a href="#h6-0-58" id="h6-0-58" class="i">+}
</a><b>diff --git a/<a id="h7" href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a> b/<a href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -4,6 +4,7 @@ mod delete;
</a> mod drop_table;
 mod explain;
 mod filter;
<a href="#h7-0-3" id="h7-0-3" class="i">+mod index_lookup;
</a> mod insert;
 mod key_lookup;
 mod limit;
<a href="#h7-1" id="h7-1" class="h">@@ -21,6 +22,7 @@ use delete::Delete;
</a> use drop_table::DropTable;
 use explain::Explain;
 use filter::Filter;
<a href="#h7-1-3" id="h7-1-3" class="i">+use index_lookup::IndexLookup;
</a> use insert::Insert;
 use key_lookup::KeyLookup;
 use limit::Limit;
<a href="#h7-2" id="h7-2" class="h">@@ -56,6 +58,9 @@ impl&lt;T: Transaction + &#39;static&gt; dyn Executor&lt;T&gt; {
</a>             Node::DropTable { name } =&gt; DropTable::new(name),
             Node::Explain(plan) =&gt; Explain::new(*plan),
             Node::Filter { source, predicate } =&gt; Filter::new(Self::build(*source), predicate),
<a href="#h7-2-3" id="h7-2-3" class="i">+            Node::IndexLookup { table, alias, column, keys } =&gt; {
</a><a href="#h7-2-4" id="h7-2-4" class="i">+                IndexLookup::new(table, alias, column, keys)
</a><a href="#h7-2-5" id="h7-2-5" class="i">+            }
</a>             Node::Insert { table, columns, expressions } =&gt; {
                 Insert::new(table, columns, expressions)
             }
<b>diff --git a/<a id="h8" href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a> b/<a href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -49,6 +49,7 @@ pub struct ColumnSpec {
</a>     pub nullable: Option&lt;bool&gt;,
     pub default: Option&lt;Expression&gt;,
     pub unique: bool,
<a href="#h8-0-3" id="h8-0-3" class="i">+    pub index: bool,
</a>     pub references: Option&lt;String&gt;,
 }
 
<b>diff --git a/<a id="h9" href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a> b/<a href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -92,6 +92,7 @@ pub enum Keyword {
</a>     From,
     Group,
     Having,
<a href="#h9-0-3" id="h9-0-3" class="i">+    Index,
</a>     Infinity,
     Inner,
     Insert,
<a href="#h9-1" id="h9-1" class="h">@@ -162,6 +163,7 @@ impl Keyword {
</a>             &quot;FROM&quot; =&gt; Self::From,
             &quot;GROUP&quot; =&gt; Self::Group,
             &quot;HAVING&quot; =&gt; Self::Having,
<a href="#h9-1-3" id="h9-1-3" class="i">+            &quot;INDEX&quot; =&gt; Self::Index,
</a>             &quot;INFINITY&quot; =&gt; Self::Infinity,
             &quot;INNER&quot; =&gt; Self::Inner,
             &quot;INSERT&quot; =&gt; Self::Insert,
<a href="#h9-2" id="h9-2" class="h">@@ -232,6 +234,7 @@ impl Keyword {
</a>             Self::From =&gt; &quot;FROM&quot;,
             Self::Group =&gt; &quot;GROUP&quot;,
             Self::Having =&gt; &quot;HAVING&quot;,
<a href="#h9-2-3" id="h9-2-3" class="i">+            Self::Index =&gt; &quot;INDEX&quot;,
</a>             Self::Infinity =&gt; &quot;INFINITY&quot;,
             Self::Inner =&gt; &quot;INNER&quot;,
             Self::Insert =&gt; &quot;INSERT&quot;,
<b>diff --git a/<a id="h10" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -178,6 +178,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>             nullable: None,
             default: None,
             unique: false,
<a href="#h10-0-3" id="h10-0-3" class="i">+            index: false,
</a>             references: None,
         };
         while let Some(Token::Keyword(keyword)) = self.next_if_keyword() {
<a href="#h10-1" id="h10-1" class="h">@@ -207,6 +208,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                 }
                 Keyword::Default =&gt; column.default = Some(self.parse_expression(0)?),
                 Keyword::Unique =&gt; column.unique = true,
<a href="#h10-1-3" id="h10-1-3" class="i">+                Keyword::Index =&gt; column.index = true,
</a>                 Keyword::References =&gt; column.references = Some(self.next_ident()?),
                 keyword =&gt; return Err(Error::Parse(format!(&quot;Unexpected keyword {}&quot;, keyword))),
             }
<b>diff --git a/<a id="h11" href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a> b/<a href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -62,6 +62,12 @@ pub enum Node {
</a>         source: Box&lt;Node&gt;,
         predicate: Expression,
     },
<a href="#h11-0-3" id="h11-0-3" class="i">+    IndexLookup {
</a><a href="#h11-0-4" id="h11-0-4" class="i">+        table: String,
</a><a href="#h11-0-5" id="h11-0-5" class="i">+        alias: Option&lt;String&gt;,
</a><a href="#h11-0-6" id="h11-0-6" class="i">+        column: String,
</a><a href="#h11-0-7" id="h11-0-7" class="i">+        keys: Vec&lt;Value&gt;,
</a><a href="#h11-0-8" id="h11-0-8" class="i">+    },
</a>     Insert {
         table: String,
         columns: Vec&lt;String&gt;,
<a href="#h11-1" id="h11-1" class="h">@@ -121,6 +127,7 @@ impl Node {
</a>         self = match self {
             n @ Self::CreateTable { .. } =&gt; n,
             n @ Self::DropTable { .. } =&gt; n,
<a href="#h11-1-3" id="h11-1-3" class="i">+            n @ Self::IndexLookup { .. } =&gt; n,
</a>             n @ Self::Insert { .. } =&gt; n,
             n @ Self::KeyLookup { .. } =&gt; n,
             n @ Self::Nothing =&gt; n,
<a href="#h11-2" id="h11-2" class="h">@@ -176,6 +183,7 @@ impl Node {
</a>             n @ Self::Delete { .. } =&gt; n,
             n @ Self::DropTable { .. } =&gt; n,
             n @ Self::Explain { .. } =&gt; n,
<a href="#h11-2-3" id="h11-2-3" class="i">+            n @ Self::IndexLookup { .. } =&gt; n,
</a>             n @ Self::KeyLookup { .. } =&gt; n,
             n @ Self::Limit { .. } =&gt; n,
             n @ Self::NestedLoopJoin { .. } =&gt; n,
<b>diff --git a/<a id="h12" href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a> b/<a href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -1,5 +1,5 @@
</a> use super::super::schema::Catalog;
<a href="#h12-0-1" id="h12-0-1" class="d">-use super::super::types::{Environment, Expression};
</a><a href="#h12-0-2" id="h12-0-2" class="i">+use super::super::types::{Environment, Expression, Value};
</a> use super::Node;
 use crate::Error;
 
<a href="#h12-1" id="h12-1" class="h">@@ -96,6 +96,25 @@ impl&lt;&#39;a, C: Catalog&gt; IndexLookup&lt;&#39;a, C&gt; {
</a>     pub fn new(catalog: &amp;&#39;a mut C) -&gt; Self {
         Self { catalog }
     }
<a href="#h12-1-3" id="h12-1-3" class="i">+
</a><a href="#h12-1-4" id="h12-1-4" class="i">+    pub fn is_lookup(column: &amp;str, expr: &amp;Expression) -&gt; Option&lt;Value&gt; {
</a><a href="#h12-1-5" id="h12-1-5" class="i">+        if let Expression::Equal(lhs, rhs) = expr {
</a><a href="#h12-1-6" id="h12-1-6" class="i">+            match (*lhs.clone(), *rhs.clone()) {
</a><a href="#h12-1-7" id="h12-1-7" class="i">+                (Expression::Field(None, name), Expression::Constant(v))
</a><a href="#h12-1-8" id="h12-1-8" class="i">+                | (Expression::Constant(v), Expression::Field(None, name))
</a><a href="#h12-1-9" id="h12-1-9" class="i">+                    if name == column =&gt;
</a><a href="#h12-1-10" id="h12-1-10" class="i">+                {
</a><a href="#h12-1-11" id="h12-1-11" class="i">+                    // FIXME Handle IS NULL instead
</a><a href="#h12-1-12" id="h12-1-12" class="i">+                    return match v {
</a><a href="#h12-1-13" id="h12-1-13" class="i">+                        Value::Null =&gt; None,
</a><a href="#h12-1-14" id="h12-1-14" class="i">+                        v =&gt; Some(v),
</a><a href="#h12-1-15" id="h12-1-15" class="i">+                    };
</a><a href="#h12-1-16" id="h12-1-16" class="i">+                }
</a><a href="#h12-1-17" id="h12-1-17" class="i">+                _ =&gt; {}
</a><a href="#h12-1-18" id="h12-1-18" class="i">+            }
</a><a href="#h12-1-19" id="h12-1-19" class="i">+        }
</a><a href="#h12-1-20" id="h12-1-20" class="i">+        None
</a><a href="#h12-1-21" id="h12-1-21" class="i">+    }
</a> }
 
 impl&lt;&#39;a, C: Catalog&gt; Optimizer for IndexLookup&lt;&#39;a, C&gt; {
<a href="#h12-2" id="h12-2" class="h">@@ -103,24 +122,28 @@ impl&lt;&#39;a, C: Catalog&gt; Optimizer for IndexLookup&lt;&#39;a, C&gt; {
</a>         node.transform(
             &amp;|n| match n {
                 // FIXME This needs to be smarter - at least handle ORs. Could be prettier too.
<a href="#h12-2-3" id="h12-2-3" class="d">-                Node::Scan { table, alias, filter: Some(Expression::Equal(lhs, rhs)) } =&gt; {
</a><a href="#h12-2-4" id="h12-2-4" class="i">+                Node::Scan { table, alias, filter: Some(expr @ Expression::Equal(_, _)) } =&gt; {
</a>                     if let Some(table) = self.catalog.read_table(&amp;table)? {
                         let pk = table.get_primary_key()?.name.clone();
<a href="#h12-2-7" id="h12-2-7" class="d">-                        match (*lhs.clone(), *rhs.clone()) {
</a><a href="#h12-2-8" id="h12-2-8" class="d">-                            (Expression::Field(None, name), Expression::Constant(v))
</a><a href="#h12-2-9" id="h12-2-9" class="d">-                            | (Expression::Constant(v), Expression::Field(None, name))
</a><a href="#h12-2-10" id="h12-2-10" class="d">-                                if name == pk =&gt;
</a><a href="#h12-2-11" id="h12-2-11" class="d">-                            {
</a><a href="#h12-2-12" id="h12-2-12" class="d">-                                return Ok(Node::KeyLookup {
</a><a href="#h12-2-13" id="h12-2-13" class="i">+                        if let Some(value) = Self::is_lookup(&amp;pk, &amp;expr) {
</a><a href="#h12-2-14" id="h12-2-14" class="i">+                            return Ok(Node::KeyLookup {
</a><a href="#h12-2-15" id="h12-2-15" class="i">+                                table: table.name,
</a><a href="#h12-2-16" id="h12-2-16" class="i">+                                alias,
</a><a href="#h12-2-17" id="h12-2-17" class="i">+                                keys: vec![value],
</a><a href="#h12-2-18" id="h12-2-18" class="i">+                            });
</a><a href="#h12-2-19" id="h12-2-19" class="i">+                        }
</a><a href="#h12-2-20" id="h12-2-20" class="i">+                        for column in table.columns.into_iter().filter(|c| c.index) {
</a><a href="#h12-2-21" id="h12-2-21" class="i">+                            if let Some(value) = Self::is_lookup(&amp;column.name, &amp;expr) {
</a><a href="#h12-2-22" id="h12-2-22" class="i">+                                return Ok(Node::IndexLookup {
</a>                                     table: table.name,
                                     alias,
<a href="#h12-2-25" id="h12-2-25" class="d">-                                    keys: vec![v],
</a><a href="#h12-2-26" id="h12-2-26" class="i">+                                    column: column.name,
</a><a href="#h12-2-27" id="h12-2-27" class="i">+                                    keys: vec![value],
</a>                                 });
                             }
<a href="#h12-2-30" id="h12-2-30" class="d">-                            _ =&gt; {}
</a>                         }
                     }
<a href="#h12-2-33" id="h12-2-33" class="d">-                    Ok(Node::Scan { table, alias, filter: Some(Expression::Equal(lhs, rhs)) })
</a><a href="#h12-2-34" id="h12-2-34" class="i">+                    Ok(Node::Scan { table, alias, filter: Some(expr) })
</a>                 }
                 n =&gt; Ok(n),
             },
<b>diff --git a/<a id="h13" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -307,6 +307,7 @@ impl Planner {
</a>                         primary_key: c.primary_key,
                         nullable,
                         default,
<a href="#h13-0-3" id="h13-0-3" class="i">+                        index: c.index &amp;&amp; !c.primary_key,
</a>                         unique: c.unique || c.primary_key,
                         references: c.references,
                     })
<b>diff --git a/<a id="h14" href="../file/src/sql/schema.rs.html">src/sql/schema.rs</a> b/<a href="../file/src/sql/schema.rs.html">src/sql/schema.rs</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -238,6 +238,8 @@ pub struct Column {
</a>     pub unique: bool,
     /// The table which is referenced by this foreign key
     pub references: Option&lt;String&gt;,
<a href="#h14-0-3" id="h14-0-3" class="i">+    /// Whether the column should be indexed
</a><a href="#h14-0-4" id="h14-0-4" class="i">+    pub index: bool,
</a> }
 
 impl Column {
<a href="#h14-1" id="h14-1" class="h">@@ -260,6 +262,9 @@ impl Column {
</a>         if let Some(reference) = &amp;self.references {
             sql += &amp;format!(&quot; REFERENCES {}&quot;, reference);
         }
<a href="#h14-1-3" id="h14-1-3" class="i">+        if self.index {
</a><a href="#h14-1-4" id="h14-1-4" class="i">+            sql += &quot; INDEX&quot;;
</a><a href="#h14-1-5" id="h14-1-5" class="i">+        }
</a>         sql
     }
 
<b>diff --git a/<a id="h15" href="../file/tests/client/mod.rs.html">tests/client/mod.rs</a> b/<a href="../file/tests/client/mod.rs.html">tests/client/mod.rs</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -105,6 +105,7 @@ fn get_table() -&gt; Result&lt;(), Error&gt; {
</a>                     nullable: false,
                     default: None,
                     unique: true,
<a href="#h15-0-3" id="h15-0-3" class="i">+                    index: false,
</a>                     references: None,
                 },
                 schema::Column {
<a href="#h15-1" id="h15-1" class="h">@@ -114,6 +115,7 @@ fn get_table() -&gt; Result&lt;(), Error&gt; {
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h15-1-3" id="h15-1-3" class="i">+                    index: false,
</a>                     references: None,
                 },
                 schema::Column {
<a href="#h15-2" id="h15-2" class="h">@@ -123,6 +125,7 @@ fn get_table() -&gt; Result&lt;(), Error&gt; {
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h15-2-3" id="h15-2-3" class="i">+                    index: false,
</a>                     references: Some(&quot;studios&quot;.into()),
                 },
                 schema::Column {
<a href="#h15-3" id="h15-3" class="h">@@ -132,6 +135,7 @@ fn get_table() -&gt; Result&lt;(), Error&gt; {
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h15-3-3" id="h15-3-3" class="i">+                    index: false,
</a>                     references: Some(&quot;genres&quot;.into()),
                 },
                 schema::Column {
<a href="#h15-4" id="h15-4" class="h">@@ -141,6 +145,7 @@ fn get_table() -&gt; Result&lt;(), Error&gt; {
</a>                     nullable: false,
                     default: None,
                     unique: false,
<a href="#h15-4-3" id="h15-4-3" class="i">+                    index: false,
</a>                     references: None,
                 },
                 schema::Column {
<a href="#h15-5" id="h15-5" class="h">@@ -150,6 +155,7 @@ fn get_table() -&gt; Result&lt;(), Error&gt; {
</a>                     nullable: true,
                     default: Some(Value::Null),
                     unique: false,
<a href="#h15-5-3" id="h15-5-3" class="i">+                    index: false,
</a>                     references: None,
                 },
                 schema::Column {
<a href="#h15-6" id="h15-6" class="h">@@ -159,6 +165,7 @@ fn get_table() -&gt; Result&lt;(), Error&gt; {
</a>                     nullable: true,
                     default: Some(Value::Null),
                     unique: false,
<a href="#h15-6-3" id="h15-6-3" class="i">+                    index: false,
</a>                     references: None,
                 },
             ]
<b>diff --git a/<a id="h16" href="../file/tests/sql/dml.rs.html">tests/sql/dml.rs</a> b/<a href="../file/tests/sql/dml.rs.html">tests/sql/dml.rs</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -37,6 +37,16 @@ macro_rules! test_dml {
</a>                     for row in txn.scan(&amp;table.name, None)? {
                         write!(f, &quot;{:?}\n&quot;, row?)?;
                     }
<a href="#h16-0-3" id="h16-0-3" class="i">+
</a><a href="#h16-0-4" id="h16-0-4" class="i">+                    for column in table.columns.iter().filter(|c| c.index) {
</a><a href="#h16-0-5" id="h16-0-5" class="i">+                        write!(f, &quot;\nIndex {}.{}\n&quot;, table.name, column.name)?;
</a><a href="#h16-0-6" id="h16-0-6" class="i">+                        let mut scan = txn.scan_index(&amp;table.name, &amp;column.name)?;
</a><a href="#h16-0-7" id="h16-0-7" class="i">+                        while let Some((value, pks)) = scan.next().transpose()? {
</a><a href="#h16-0-8" id="h16-0-8" class="i">+                            let mut pks = pks.into_iter().collect::&lt;Vec&lt;_&gt;&gt;();
</a><a href="#h16-0-9" id="h16-0-9" class="i">+                            pks.sort_by(|a, b| a.partial_cmp(b).unwrap_or(std::cmp::Ordering::Equal));
</a><a href="#h16-0-10" id="h16-0-10" class="i">+                            write!(f, &quot;{:?} =&gt; {:?}\n&quot;, value, pks)?;
</a><a href="#h16-0-11" id="h16-0-11" class="i">+                        }
</a><a href="#h16-0-12" id="h16-0-12" class="i">+                    }
</a>                 }
                 txn.rollback()?;
 
<a href="#h16-1" id="h16-1" class="h">@@ -49,7 +59,7 @@ macro_rules! test_dml {
</a> test_dml! { with [
         &quot;CREATE TABLE test (
             id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h16-1-3" id="h16-1-3" class="d">-            name STRING,
</a><a href="#h16-1-4" id="h16-1-4" class="i">+            name STRING INDEX,
</a>             value INTEGER
         )&quot;,
         &quot;INSERT INTO test VALUES (1, &#39;a&#39;, 101), (2, &#39;b&#39;, 102), (3, &#39;c&#39;, 103)&quot;,
<a href="#h16-2" id="h16-2" class="h">@@ -79,7 +89,7 @@ test_dml! { with [
</a> test_dml! { with [
         &quot;CREATE TABLE test (
             id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h16-2-3" id="h16-2-3" class="d">-            name STRING,
</a><a href="#h16-2-4" id="h16-2-4" class="i">+            name STRING INDEX,
</a>             value INTEGER
         )&quot;,
         &quot;CREATE TABLE other (id INTEGER PRIMARY KEY)&quot;
<a href="#h16-3" id="h16-3" class="h">@@ -112,7 +122,7 @@ test_dml! { with [
</a> test_dml! { with [
         &quot;CREATE TABLE test (
             id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h16-3-3" id="h16-3-3" class="d">-            name STRING,
</a><a href="#h16-3-4" id="h16-3-4" class="i">+            name STRING INDEX,
</a>             value INTEGER
         )&quot;,
         &quot;INSERT INTO test VALUES (1, &#39;a&#39;, 100), (2, &#39;b&#39;, 102), (3, &#39;c&#39;, 103)&quot;,
<b>diff --git a/<a id="h17" href="../file/tests/sql/dml/delete_all.html">tests/sql/dml/delete_all</a> b/<a href="../file/tests/sql/dml/delete_all.html">tests/sql/dml/delete_all</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -11,6 +11,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h17-0-3" id="h17-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h17-0-4" id="h17-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h17-0-7" id="h17-0-7" class="i">+
</a><a href="#h17-0-8" id="h17-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h18" href="../file/tests/sql/dml/delete_bare.html">tests/sql/dml/delete_bare</a> b/<a href="../file/tests/sql/dml/delete_bare.html">tests/sql/dml/delete_bare</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h18-0-3" id="h18-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h18-0-4" id="h18-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h18-0-10" id="h18-0-10" class="i">+
</a><a href="#h18-0-11" id="h18-0-11" class="i">+Index test.name
</a><a href="#h18-0-12" id="h18-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h18-0-13" id="h18-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h18-0-14" id="h18-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h19" href="../file/tests/sql/dml/delete_bare_from.html">tests/sql/dml/delete_bare_from</a> b/<a href="../file/tests/sql/dml/delete_bare_from.html">tests/sql/dml/delete_bare_from</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h19-0-3" id="h19-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h19-0-4" id="h19-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h19-0-10" id="h19-0-10" class="i">+
</a><a href="#h19-0-11" id="h19-0-11" class="i">+Index test.name
</a><a href="#h19-0-12" id="h19-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h19-0-13" id="h19-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h19-0-14" id="h19-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h20" href="../file/tests/sql/dml/delete_bare_where.html">tests/sql/dml/delete_bare_where</a> b/<a href="../file/tests/sql/dml/delete_bare_where.html">tests/sql/dml/delete_bare_where</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h20-0-3" id="h20-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h20-0-4" id="h20-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h20-0-10" id="h20-0-10" class="i">+
</a><a href="#h20-0-11" id="h20-0-11" class="i">+Index test.name
</a><a href="#h20-0-12" id="h20-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h20-0-13" id="h20-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h20-0-14" id="h20-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h21" href="../file/tests/sql/dml/delete_case.html">tests/sql/dml/delete_case</a> b/<a href="../file/tests/sql/dml/delete_case.html">tests/sql/dml/delete_case</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -11,8 +11,12 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h21-0-3" id="h21-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h21-0-4" id="h21-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h21-0-9" id="h21-0-9" class="i">+
</a><a href="#h21-0-10" id="h21-0-10" class="i">+Index test.name
</a><a href="#h21-0-11" id="h21-0-11" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h21-0-12" id="h21-0-12" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h22" href="../file/tests/sql/dml/delete_missing_column_where.html">tests/sql/dml/delete_missing_column_where</a> b/<a href="../file/tests/sql/dml/delete_missing_column_where.html">tests/sql/dml/delete_missing_column_where</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h22-0-3" id="h22-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h22-0-4" id="h22-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h22-0-10" id="h22-0-10" class="i">+
</a><a href="#h22-0-11" id="h22-0-11" class="i">+Index test.name
</a><a href="#h22-0-12" id="h22-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h22-0-13" id="h22-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h22-0-14" id="h22-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h23" href="../file/tests/sql/dml/delete_missing_table.html">tests/sql/dml/delete_missing_table</a> b/<a href="../file/tests/sql/dml/delete_missing_table.html">tests/sql/dml/delete_missing_table</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h23-0-3" id="h23-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h23-0-4" id="h23-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h23-0-10" id="h23-0-10" class="i">+
</a><a href="#h23-0-11" id="h23-0-11" class="i">+Index test.name
</a><a href="#h23-0-12" id="h23-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h23-0-13" id="h23-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h23-0-14" id="h23-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h24" href="../file/tests/sql/dml/delete_multiple_tables.html">tests/sql/dml/delete_multiple_tables</a> b/<a href="../file/tests/sql/dml/delete_multiple_tables.html">tests/sql/dml/delete_multiple_tables</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h24-0-3" id="h24-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h24-0-4" id="h24-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h24-0-10" id="h24-0-10" class="i">+
</a><a href="#h24-0-11" id="h24-0-11" class="i">+Index test.name
</a><a href="#h24-0-12" id="h24-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h24-0-13" id="h24-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h24-0-14" id="h24-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h25" href="../file/tests/sql/dml/delete_where.html">tests/sql/dml/delete_where</a> b/<a href="../file/tests/sql/dml/delete_where.html">tests/sql/dml/delete_where</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -11,8 +11,12 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h25-0-3" id="h25-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h25-0-4" id="h25-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h25-0-9" id="h25-0-9" class="i">+
</a><a href="#h25-0-10" id="h25-0-10" class="i">+Index test.name
</a><a href="#h25-0-11" id="h25-0-11" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h25-0-12" id="h25-0-12" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h26" href="../file/tests/sql/dml/delete_where_and.html">tests/sql/dml/delete_where_and</a> b/<a href="../file/tests/sql/dml/delete_where_and.html">tests/sql/dml/delete_where_and</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -11,8 +11,12 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h26-0-3" id="h26-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h26-0-4" id="h26-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h26-0-9" id="h26-0-9" class="i">+
</a><a href="#h26-0-10" id="h26-0-10" class="i">+Index test.name
</a><a href="#h26-0-11" id="h26-0-11" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h26-0-12" id="h26-0-12" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h27" href="../file/tests/sql/dml/delete_where_expr.html">tests/sql/dml/delete_where_expr</a> b/<a href="../file/tests/sql/dml/delete_where_expr.html">tests/sql/dml/delete_where_expr</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -11,8 +11,12 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h27-0-3" id="h27-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h27-0-4" id="h27-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h27-0-9" id="h27-0-9" class="i">+
</a><a href="#h27-0-10" id="h27-0-10" class="i">+Index test.name
</a><a href="#h27-0-11" id="h27-0-11" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h27-0-12" id="h27-0-12" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h28" href="../file/tests/sql/dml/delete_where_false.html">tests/sql/dml/delete_where_false</a> b/<a href="../file/tests/sql/dml/delete_where_false.html">tests/sql/dml/delete_where_false</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h28-0-3" id="h28-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h28-0-4" id="h28-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h28-0-10" id="h28-0-10" class="i">+
</a><a href="#h28-0-11" id="h28-0-11" class="i">+Index test.name
</a><a href="#h28-0-12" id="h28-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h28-0-13" id="h28-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h28-0-14" id="h28-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h29" href="../file/tests/sql/dml/delete_where_float.html">tests/sql/dml/delete_where_float</a> b/<a href="../file/tests/sql/dml/delete_where_float.html">tests/sql/dml/delete_where_float</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h29-0-3" id="h29-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h29-0-4" id="h29-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h29-0-10" id="h29-0-10" class="i">+
</a><a href="#h29-0-11" id="h29-0-11" class="i">+Index test.name
</a><a href="#h29-0-12" id="h29-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h29-0-13" id="h29-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h29-0-14" id="h29-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h30" href="../file/tests/sql/dml/delete_where_integer.html">tests/sql/dml/delete_where_integer</a> b/<a href="../file/tests/sql/dml/delete_where_integer.html">tests/sql/dml/delete_where_integer</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h30-0-3" id="h30-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h30-0-4" id="h30-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h30-0-10" id="h30-0-10" class="i">+
</a><a href="#h30-0-11" id="h30-0-11" class="i">+Index test.name
</a><a href="#h30-0-12" id="h30-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h30-0-13" id="h30-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h30-0-14" id="h30-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h31" href="../file/tests/sql/dml/delete_where_null.html">tests/sql/dml/delete_where_null</a> b/<a href="../file/tests/sql/dml/delete_where_null.html">tests/sql/dml/delete_where_null</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h31-0-3" id="h31-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h31-0-4" id="h31-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h31-0-10" id="h31-0-10" class="i">+
</a><a href="#h31-0-11" id="h31-0-11" class="i">+Index test.name
</a><a href="#h31-0-12" id="h31-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h31-0-13" id="h31-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h31-0-14" id="h31-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h32" href="../file/tests/sql/dml/delete_where_string.html">tests/sql/dml/delete_where_string</a> b/<a href="../file/tests/sql/dml/delete_where_string.html">tests/sql/dml/delete_where_string</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h32-0-3" id="h32-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h32-0-4" id="h32-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h32-0-10" id="h32-0-10" class="i">+
</a><a href="#h32-0-11" id="h32-0-11" class="i">+Index test.name
</a><a href="#h32-0-12" id="h32-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h32-0-13" id="h32-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h32-0-14" id="h32-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h33" href="../file/tests/sql/dml/delete_where_true.html">tests/sql/dml/delete_where_true</a> b/<a href="../file/tests/sql/dml/delete_where_true.html">tests/sql/dml/delete_where_true</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -11,6 +11,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h33-0-3" id="h33-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h33-0-4" id="h33-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h33-0-7" id="h33-0-7" class="i">+
</a><a href="#h33-0-8" id="h33-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h34" href="../file/tests/sql/dml/insert_bare.html">tests/sql/dml/insert_bare</a> b/<a href="../file/tests/sql/dml/insert_bare.html">tests/sql/dml/insert_bare</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h34-0-3" id="h34-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h34-0-4" id="h34-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h34-0-7" id="h34-0-7" class="i">+
</a><a href="#h34-0-8" id="h34-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h35" href="../file/tests/sql/dml/insert_bare_no_table.html">tests/sql/dml/insert_bare_no_table</a> b/<a href="../file/tests/sql/dml/insert_bare_no_table.html">tests/sql/dml/insert_bare_no_table</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h35-0-3" id="h35-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h35-0-4" id="h35-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h35-0-7" id="h35-0-7" class="i">+
</a><a href="#h35-0-8" id="h35-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h36" href="../file/tests/sql/dml/insert_bare_values.html">tests/sql/dml/insert_bare_values</a> b/<a href="../file/tests/sql/dml/insert_bare_values.html">tests/sql/dml/insert_bare_values</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h36-0-3" id="h36-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h36-0-4" id="h36-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h36-0-7" id="h36-0-7" class="i">+
</a><a href="#h36-0-8" id="h36-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h37" href="../file/tests/sql/dml/insert_case.html">tests/sql/dml/insert_case</a> b/<a href="../file/tests/sql/dml/insert_case.html">tests/sql/dml/insert_case</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -8,7 +8,10 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h37-0-3" id="h37-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h37-0-4" id="h37-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Null]
<a href="#h37-0-8" id="h37-0-8" class="i">+
</a><a href="#h37-0-9" id="h37-0-9" class="i">+Index test.name
</a><a href="#h37-0-10" id="h37-0-10" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h38" href="../file/tests/sql/dml/insert_empty_both.html">tests/sql/dml/insert_empty_both</a> b/<a href="../file/tests/sql/dml/insert_empty_both.html">tests/sql/dml/insert_empty_both</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h38-0-3" id="h38-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h38-0-4" id="h38-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h38-0-7" id="h38-0-7" class="i">+
</a><a href="#h38-0-8" id="h38-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h39" href="../file/tests/sql/dml/insert_empty_columns.html">tests/sql/dml/insert_empty_columns</a> b/<a href="../file/tests/sql/dml/insert_empty_columns.html">tests/sql/dml/insert_empty_columns</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h39-0-3" id="h39-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h39-0-4" id="h39-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h39-0-7" id="h39-0-7" class="i">+
</a><a href="#h39-0-8" id="h39-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h40" href="../file/tests/sql/dml/insert_empty_values.html">tests/sql/dml/insert_empty_values</a> b/<a href="../file/tests/sql/dml/insert_empty_values.html">tests/sql/dml/insert_empty_values</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h40-0-3" id="h40-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h40-0-4" id="h40-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h40-0-7" id="h40-0-7" class="i">+
</a><a href="#h40-0-8" id="h40-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h41" href="../file/tests/sql/dml/insert_expression.html">tests/sql/dml/insert_expression</a> b/<a href="../file/tests/sql/dml/insert_expression.html">tests/sql/dml/insert_expression</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -8,7 +8,10 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h41-0-3" id="h41-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h41-0-4" id="h41-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(7)]
<a href="#h41-0-8" id="h41-0-8" class="i">+
</a><a href="#h41-0-9" id="h41-0-9" class="i">+Index test.name
</a><a href="#h41-0-10" id="h41-0-10" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h42" href="../file/tests/sql/dml/insert_extra.html">tests/sql/dml/insert_extra</a> b/<a href="../file/tests/sql/dml/insert_extra.html">tests/sql/dml/insert_extra</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h42-0-3" id="h42-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h42-0-4" id="h42-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h42-0-7" id="h42-0-7" class="i">+
</a><a href="#h42-0-8" id="h42-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h43" href="../file/tests/sql/dml/insert_extra_columns.html">tests/sql/dml/insert_extra_columns</a> b/<a href="../file/tests/sql/dml/insert_extra_columns.html">tests/sql/dml/insert_extra_columns</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h43-0-3" id="h43-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h43-0-4" id="h43-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h43-0-7" id="h43-0-7" class="i">+
</a><a href="#h43-0-8" id="h43-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h44" href="../file/tests/sql/dml/insert_full.html">tests/sql/dml/insert_full</a> b/<a href="../file/tests/sql/dml/insert_full.html">tests/sql/dml/insert_full</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -8,7 +8,10 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h44-0-3" id="h44-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h44-0-4" id="h44-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
<a href="#h44-0-8" id="h44-0-8" class="i">+
</a><a href="#h44-0-9" id="h44-0-9" class="i">+Index test.name
</a><a href="#h44-0-10" id="h44-0-10" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h45" href="../file/tests/sql/dml/insert_full_multiple.html">tests/sql/dml/insert_full_multiple</a> b/<a href="../file/tests/sql/dml/insert_full_multiple.html">tests/sql/dml/insert_full_multiple</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -8,9 +8,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h45-0-3" id="h45-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h45-0-4" id="h45-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h45-0-10" id="h45-0-10" class="i">+
</a><a href="#h45-0-11" id="h45-0-11" class="i">+Index test.name
</a><a href="#h45-0-12" id="h45-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h45-0-13" id="h45-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h45-0-14" id="h45-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h46" href="../file/tests/sql/dml/insert_full_order.html">tests/sql/dml/insert_full_order</a> b/<a href="../file/tests/sql/dml/insert_full_order.html">tests/sql/dml/insert_full_order</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -8,7 +8,10 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h46-0-3" id="h46-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h46-0-4" id="h46-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
<a href="#h46-0-8" id="h46-0-8" class="i">+
</a><a href="#h46-0-9" id="h46-0-9" class="i">+Index test.name
</a><a href="#h46-0-10" id="h46-0-10" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h47" href="../file/tests/sql/dml/insert_full_trailing_comma.html">tests/sql/dml/insert_full_trailing_comma</a> b/<a href="../file/tests/sql/dml/insert_full_trailing_comma.html">tests/sql/dml/insert_full_trailing_comma</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h47-0-3" id="h47-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h47-0-4" id="h47-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h47-0-7" id="h47-0-7" class="i">+
</a><a href="#h47-0-8" id="h47-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h48" href="../file/tests/sql/dml/insert_missing_column.html">tests/sql/dml/insert_missing_column</a> b/<a href="../file/tests/sql/dml/insert_missing_column.html">tests/sql/dml/insert_missing_column</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h48-0-3" id="h48-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h48-0-4" id="h48-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h48-0-7" id="h48-0-7" class="i">+
</a><a href="#h48-0-8" id="h48-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h49" href="../file/tests/sql/dml/insert_missing_table.html">tests/sql/dml/insert_missing_table</a> b/<a href="../file/tests/sql/dml/insert_missing_table.html">tests/sql/dml/insert_missing_table</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h49-0-3" id="h49-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h49-0-4" id="h49-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h49-0-7" id="h49-0-7" class="i">+
</a><a href="#h49-0-8" id="h49-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h50" href="../file/tests/sql/dml/insert_multiple_tables.html">tests/sql/dml/insert_multiple_tables</a> b/<a href="../file/tests/sql/dml/insert_multiple_tables.html">tests/sql/dml/insert_multiple_tables</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h50-0-3" id="h50-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h50-0-4" id="h50-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h50-0-7" id="h50-0-7" class="i">+
</a><a href="#h50-0-8" id="h50-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h51" href="../file/tests/sql/dml/insert_no_columns.html">tests/sql/dml/insert_no_columns</a> b/<a href="../file/tests/sql/dml/insert_no_columns.html">tests/sql/dml/insert_no_columns</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -8,7 +8,10 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h51-0-3" id="h51-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h51-0-4" id="h51-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
<a href="#h51-0-8" id="h51-0-8" class="i">+
</a><a href="#h51-0-9" id="h51-0-9" class="i">+Index test.name
</a><a href="#h51-0-10" id="h51-0-10" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h52" href="../file/tests/sql/dml/insert_no_columns_multiple.html">tests/sql/dml/insert_no_columns_multiple</a> b/<a href="../file/tests/sql/dml/insert_no_columns_multiple.html">tests/sql/dml/insert_no_columns_multiple</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -8,9 +8,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h52-0-3" id="h52-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h52-0-4" id="h52-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(101)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h52-0-10" id="h52-0-10" class="i">+
</a><a href="#h52-0-11" id="h52-0-11" class="i">+Index test.name
</a><a href="#h52-0-12" id="h52-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h52-0-13" id="h52-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h52-0-14" id="h52-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h53" href="../file/tests/sql/dml/insert_partial.html">tests/sql/dml/insert_partial</a> b/<a href="../file/tests/sql/dml/insert_partial.html">tests/sql/dml/insert_partial</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -8,7 +8,10 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h53-0-3" id="h53-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h53-0-4" id="h53-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Null]
<a href="#h53-0-8" id="h53-0-8" class="i">+
</a><a href="#h53-0-9" id="h53-0-9" class="i">+Index test.name
</a><a href="#h53-0-10" id="h53-0-10" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h54" href="../file/tests/sql/dml/insert_partial_columns.html">tests/sql/dml/insert_partial_columns</a> b/<a href="../file/tests/sql/dml/insert_partial_columns.html">tests/sql/dml/insert_partial_columns</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -8,6 +8,8 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h54-0-3" id="h54-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h54-0-4" id="h54-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
<a href="#h54-0-7" id="h54-0-7" class="i">+
</a><a href="#h54-0-8" id="h54-0-8" class="i">+Index test.name
</a><b>diff --git a/<a id="h55" href="../file/tests/sql/dml/insert_partial_vary.html">tests/sql/dml/insert_partial_vary</a> b/<a href="../file/tests/sql/dml/insert_partial_vary.html">tests/sql/dml/insert_partial_vary</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -8,9 +8,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h55-0-3" id="h55-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h55-0-4" id="h55-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Null]
 [Integer(3), Null, Null]
<a href="#h55-0-10" id="h55-0-10" class="i">+
</a><a href="#h55-0-11" id="h55-0-11" class="i">+Index test.name
</a><a href="#h55-0-12" id="h55-0-12" class="i">+Null =&gt; [Integer(3)]
</a><a href="#h55-0-13" id="h55-0-13" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h55-0-14" id="h55-0-14" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><b>diff --git a/<a id="h56" href="../file/tests/sql/dml/update_all.html">tests/sql/dml/update_all</a> b/<a href="../file/tests/sql/dml/update_all.html">tests/sql/dml/update_all</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -11,9 +11,12 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h56-0-3" id="h56-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h56-0-4" id="h56-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;x&quot;), Integer(999)]
 [Integer(2), String(&quot;x&quot;), Integer(999)]
 [Integer(3), String(&quot;x&quot;), Integer(999)]
<a href="#h56-0-10" id="h56-0-10" class="i">+
</a><a href="#h56-0-11" id="h56-0-11" class="i">+Index test.name
</a><a href="#h56-0-12" id="h56-0-12" class="i">+String(&quot;x&quot;) =&gt; [Integer(1), Integer(2), Integer(3)]
</a><b>diff --git a/<a id="h57" href="../file/tests/sql/dml/update_bare.html">tests/sql/dml/update_bare</a> b/<a href="../file/tests/sql/dml/update_bare.html">tests/sql/dml/update_bare</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h57-0-3" id="h57-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h57-0-4" id="h57-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h57-0-10" id="h57-0-10" class="i">+
</a><a href="#h57-0-11" id="h57-0-11" class="i">+Index test.name
</a><a href="#h57-0-12" id="h57-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h57-0-13" id="h57-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h57-0-14" id="h57-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h58" href="../file/tests/sql/dml/update_bare_no_table.html">tests/sql/dml/update_bare_no_table</a> b/<a href="../file/tests/sql/dml/update_bare_no_table.html">tests/sql/dml/update_bare_no_table</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h58-0-3" id="h58-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h58-0-4" id="h58-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h58-0-10" id="h58-0-10" class="i">+
</a><a href="#h58-0-11" id="h58-0-11" class="i">+Index test.name
</a><a href="#h58-0-12" id="h58-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h58-0-13" id="h58-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h58-0-14" id="h58-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h59" href="../file/tests/sql/dml/update_bare_set.html">tests/sql/dml/update_bare_set</a> b/<a href="../file/tests/sql/dml/update_bare_set.html">tests/sql/dml/update_bare_set</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h59-0-3" id="h59-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h59-0-4" id="h59-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h59-0-10" id="h59-0-10" class="i">+
</a><a href="#h59-0-11" id="h59-0-11" class="i">+Index test.name
</a><a href="#h59-0-12" id="h59-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h59-0-13" id="h59-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h59-0-14" id="h59-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h60" href="../file/tests/sql/dml/update_bare_where.html">tests/sql/dml/update_bare_where</a> b/<a href="../file/tests/sql/dml/update_bare_where.html">tests/sql/dml/update_bare_where</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h60-0-3" id="h60-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h60-0-4" id="h60-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h60-0-10" id="h60-0-10" class="i">+
</a><a href="#h60-0-11" id="h60-0-11" class="i">+Index test.name
</a><a href="#h60-0-12" id="h60-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h60-0-13" id="h60-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h60-0-14" id="h60-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h61" href="../file/tests/sql/dml/update_case.html">tests/sql/dml/update_case</a> b/<a href="../file/tests/sql/dml/update_case.html">tests/sql/dml/update_case</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h61-0-3" id="h61-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h61-0-4" id="h61-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;x&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h61-0-10" id="h61-0-10" class="i">+
</a><a href="#h61-0-11" id="h61-0-11" class="i">+Index test.name
</a><a href="#h61-0-12" id="h61-0-12" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h61-0-13" id="h61-0-13" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><a href="#h61-0-14" id="h61-0-14" class="i">+String(&quot;x&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h62" href="../file/tests/sql/dml/update_missing_column_set.html">tests/sql/dml/update_missing_column_set</a> b/<a href="../file/tests/sql/dml/update_missing_column_set.html">tests/sql/dml/update_missing_column_set</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h62-0-3" id="h62-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h62-0-4" id="h62-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h62-0-10" id="h62-0-10" class="i">+
</a><a href="#h62-0-11" id="h62-0-11" class="i">+Index test.name
</a><a href="#h62-0-12" id="h62-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h62-0-13" id="h62-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h62-0-14" id="h62-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h63" href="../file/tests/sql/dml/update_missing_column_where.html">tests/sql/dml/update_missing_column_where</a> b/<a href="../file/tests/sql/dml/update_missing_column_where.html">tests/sql/dml/update_missing_column_where</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h63-0-3" id="h63-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h63-0-4" id="h63-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h63-0-10" id="h63-0-10" class="i">+
</a><a href="#h63-0-11" id="h63-0-11" class="i">+Index test.name
</a><a href="#h63-0-12" id="h63-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h63-0-13" id="h63-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h63-0-14" id="h63-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h64" href="../file/tests/sql/dml/update_missing_table.html">tests/sql/dml/update_missing_table</a> b/<a href="../file/tests/sql/dml/update_missing_table.html">tests/sql/dml/update_missing_table</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h64-0-3" id="h64-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h64-0-4" id="h64-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h64-0-10" id="h64-0-10" class="i">+
</a><a href="#h64-0-11" id="h64-0-11" class="i">+Index test.name
</a><a href="#h64-0-12" id="h64-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h64-0-13" id="h64-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h64-0-14" id="h64-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h65" href="../file/tests/sql/dml/update_multiple_tables.html">tests/sql/dml/update_multiple_tables</a> b/<a href="../file/tests/sql/dml/update_multiple_tables.html">tests/sql/dml/update_multiple_tables</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h65-0-3" id="h65-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h65-0-4" id="h65-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h65-0-10" id="h65-0-10" class="i">+
</a><a href="#h65-0-11" id="h65-0-11" class="i">+Index test.name
</a><a href="#h65-0-12" id="h65-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h65-0-13" id="h65-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h65-0-14" id="h65-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h66" href="../file/tests/sql/dml/update_where.html">tests/sql/dml/update_where</a> b/<a href="../file/tests/sql/dml/update_where.html">tests/sql/dml/update_where</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h66-0-3" id="h66-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h66-0-4" id="h66-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;x&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h66-0-10" id="h66-0-10" class="i">+
</a><a href="#h66-0-11" id="h66-0-11" class="i">+Index test.name
</a><a href="#h66-0-12" id="h66-0-12" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h66-0-13" id="h66-0-13" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><a href="#h66-0-14" id="h66-0-14" class="i">+String(&quot;x&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h67" href="../file/tests/sql/dml/update_where_and.html">tests/sql/dml/update_where_and</a> b/<a href="../file/tests/sql/dml/update_where_and.html">tests/sql/dml/update_where_and</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h67-0-3" id="h67-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h67-0-4" id="h67-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;x&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h67-0-10" id="h67-0-10" class="i">+
</a><a href="#h67-0-11" id="h67-0-11" class="i">+Index test.name
</a><a href="#h67-0-12" id="h67-0-12" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h67-0-13" id="h67-0-13" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><a href="#h67-0-14" id="h67-0-14" class="i">+String(&quot;x&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h68" href="../file/tests/sql/dml/update_where_expr.html">tests/sql/dml/update_where_expr</a> b/<a href="../file/tests/sql/dml/update_where_expr.html">tests/sql/dml/update_where_expr</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h68-0-3" id="h68-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h68-0-4" id="h68-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;x&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h68-0-10" id="h68-0-10" class="i">+
</a><a href="#h68-0-11" id="h68-0-11" class="i">+Index test.name
</a><a href="#h68-0-12" id="h68-0-12" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h68-0-13" id="h68-0-13" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><a href="#h68-0-14" id="h68-0-14" class="i">+String(&quot;x&quot;) =&gt; [Integer(1)]
</a><b>diff --git a/<a id="h69" href="../file/tests/sql/dml/update_where_false.html">tests/sql/dml/update_where_false</a> b/<a href="../file/tests/sql/dml/update_where_false.html">tests/sql/dml/update_where_false</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h69-0-3" id="h69-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h69-0-4" id="h69-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h69-0-10" id="h69-0-10" class="i">+
</a><a href="#h69-0-11" id="h69-0-11" class="i">+Index test.name
</a><a href="#h69-0-12" id="h69-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h69-0-13" id="h69-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h69-0-14" id="h69-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h70" href="../file/tests/sql/dml/update_where_float.html">tests/sql/dml/update_where_float</a> b/<a href="../file/tests/sql/dml/update_where_float.html">tests/sql/dml/update_where_float</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h70-0-3" id="h70-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h70-0-4" id="h70-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h70-0-10" id="h70-0-10" class="i">+
</a><a href="#h70-0-11" id="h70-0-11" class="i">+Index test.name
</a><a href="#h70-0-12" id="h70-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h70-0-13" id="h70-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h70-0-14" id="h70-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h71" href="../file/tests/sql/dml/update_where_full.html">tests/sql/dml/update_where_full</a> b/<a href="../file/tests/sql/dml/update_where_full.html">tests/sql/dml/update_where_full</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h71-0-3" id="h71-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h71-0-4" id="h71-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
 [Integer(9), String(&quot;x&quot;), Integer(999)]
<a href="#h71-0-10" id="h71-0-10" class="i">+
</a><a href="#h71-0-11" id="h71-0-11" class="i">+Index test.name
</a><a href="#h71-0-12" id="h71-0-12" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h71-0-13" id="h71-0-13" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><a href="#h71-0-14" id="h71-0-14" class="i">+String(&quot;x&quot;) =&gt; [Integer(9)]
</a><b>diff --git a/<a id="h72" href="../file/tests/sql/dml/update_where_integer.html">tests/sql/dml/update_where_integer</a> b/<a href="../file/tests/sql/dml/update_where_integer.html">tests/sql/dml/update_where_integer</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h72-0-3" id="h72-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h72-0-4" id="h72-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h72-0-10" id="h72-0-10" class="i">+
</a><a href="#h72-0-11" id="h72-0-11" class="i">+Index test.name
</a><a href="#h72-0-12" id="h72-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h72-0-13" id="h72-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h72-0-14" id="h72-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h73" href="../file/tests/sql/dml/update_where_null.html">tests/sql/dml/update_where_null</a> b/<a href="../file/tests/sql/dml/update_where_null.html">tests/sql/dml/update_where_null</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h73-0-3" id="h73-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h73-0-4" id="h73-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h73-0-10" id="h73-0-10" class="i">+
</a><a href="#h73-0-11" id="h73-0-11" class="i">+Index test.name
</a><a href="#h73-0-12" id="h73-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h73-0-13" id="h73-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h73-0-14" id="h73-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h74" href="../file/tests/sql/dml/update_where_string.html">tests/sql/dml/update_where_string</a> b/<a href="../file/tests/sql/dml/update_where_string.html">tests/sql/dml/update_where_string</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -11,9 +11,14 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h74-0-3" id="h74-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h74-0-4" id="h74-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;a&quot;), Integer(100)]
 [Integer(2), String(&quot;b&quot;), Integer(102)]
 [Integer(3), String(&quot;c&quot;), Integer(103)]
<a href="#h74-0-10" id="h74-0-10" class="i">+
</a><a href="#h74-0-11" id="h74-0-11" class="i">+Index test.name
</a><a href="#h74-0-12" id="h74-0-12" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h74-0-13" id="h74-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h74-0-14" id="h74-0-14" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h75" href="../file/tests/sql/dml/update_where_true.html">tests/sql/dml/update_where_true</a> b/<a href="../file/tests/sql/dml/update_where_true.html">tests/sql/dml/update_where_true</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -11,9 +11,12 @@ CREATE TABLE other (
</a> 
 CREATE TABLE test (
   id INTEGER PRIMARY KEY DEFAULT 0,
<a href="#h75-0-3" id="h75-0-3" class="d">-  name STRING DEFAULT NULL,
</a><a href="#h75-0-4" id="h75-0-4" class="i">+  name STRING DEFAULT NULL INDEX,
</a>   value INTEGER DEFAULT NULL
 )
 [Integer(1), String(&quot;x&quot;), Integer(100)]
 [Integer(2), String(&quot;x&quot;), Integer(102)]
 [Integer(3), String(&quot;x&quot;), Integer(103)]
<a href="#h75-0-10" id="h75-0-10" class="i">+
</a><a href="#h75-0-11" id="h75-0-11" class="i">+Index test.name
</a><a href="#h75-0-12" id="h75-0-12" class="i">+String(&quot;x&quot;) =&gt; [Integer(1), Integer(2), Integer(3)]
</a><b>diff --git a/<a id="h76" href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a> b/<a href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -41,7 +41,7 @@ macro_rules! test_query {
</a>                 &quot;CREATE TABLE studios (
                     id INTEGER PRIMARY KEY,
                     name STRING NOT NULL,
<a href="#h76-0-3" id="h76-0-3" class="d">-                    country_id STRING REFERENCES countries
</a><a href="#h76-0-4" id="h76-0-4" class="i">+                    country_id STRING INDEX REFERENCES countries
</a>                 )&quot;,
                 &quot;INSERT INTO studios VALUES
                     (1, &#39;Mosfilm&#39;, &#39;ru&#39;),
<a href="#h76-1" id="h76-1" class="h">@@ -51,8 +51,8 @@ macro_rules! test_query {
</a>                 &quot;CREATE TABLE movies (
                     id INTEGER PRIMARY KEY,
                     title STRING NOT NULL,
<a href="#h76-1-3" id="h76-1-3" class="d">-                    studio_id INTEGER NOT NULL REFERENCES studios,
</a><a href="#h76-1-4" id="h76-1-4" class="d">-                    genre_id INTEGER NOT NULL REFERENCES genres,
</a><a href="#h76-1-5" id="h76-1-5" class="i">+                    studio_id INTEGER NOT NULL INDEX REFERENCES studios,
</a><a href="#h76-1-6" id="h76-1-6" class="i">+                    genre_id INTEGER NOT NULL INDEX REFERENCES genres,
</a>                     released INTEGER NOT NULL,
                     rating FLOAT,
                     ultrahd BOOLEAN
<a href="#h76-2" id="h76-2" class="h">@@ -195,6 +195,7 @@ test_query! {
</a>     where_string: &quot;SELECT * FROM movies WHERE &#39;abc&#39;&quot;,
     where_multi: &quot;SELECT * FROM movies WHERE TRUE, TRUE&quot;,
     where_primary_key: &quot;SELECT * FROM movies WHERE id = 3&quot;,
<a href="#h76-2-3" id="h76-2-3" class="i">+    where_index_lookup: &quot;SELECT * FROM movies WHERE genre_id = 2&quot;,
</a>     where_field_unknown: &quot;SELECT * FROM movies WHERE unknown&quot;,
     where_field_qualified: &quot;SELECT movies.id, genres.id FROM movies, genres WHERE movies.id &gt;= 3 AND genres.id = 1&quot;,
     where_field_ambiguous: &quot;SELECT movies.id, genres.id FROM movies, genres WHERE id &gt;= 3&quot;,
<b>diff --git a/<a id="h77" href="../file/tests/sql/query/where_index_lookup.html">tests/sql/query/where_index_lookup</a> b/<a href="../file/tests/sql/query/where_index_lookup.html">tests/sql/query/where_index_lookup</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -0,0 +1,80 @@
</a><a href="#h77-0-0" id="h77-0-0" class="i">+Query: SELECT * FROM movies WHERE genre_id = 2
</a><a href="#h77-0-1" id="h77-0-1" class="i">+
</a><a href="#h77-0-2" id="h77-0-2" class="i">+AST: Select {
</a><a href="#h77-0-3" id="h77-0-3" class="i">+    select: SelectClause {
</a><a href="#h77-0-4" id="h77-0-4" class="i">+        expressions: [],
</a><a href="#h77-0-5" id="h77-0-5" class="i">+        labels: [],
</a><a href="#h77-0-6" id="h77-0-6" class="i">+    },
</a><a href="#h77-0-7" id="h77-0-7" class="i">+    from: Some(
</a><a href="#h77-0-8" id="h77-0-8" class="i">+        FromClause {
</a><a href="#h77-0-9" id="h77-0-9" class="i">+            items: [
</a><a href="#h77-0-10" id="h77-0-10" class="i">+                Table {
</a><a href="#h77-0-11" id="h77-0-11" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h77-0-12" id="h77-0-12" class="i">+                    alias: None,
</a><a href="#h77-0-13" id="h77-0-13" class="i">+                },
</a><a href="#h77-0-14" id="h77-0-14" class="i">+            ],
</a><a href="#h77-0-15" id="h77-0-15" class="i">+        },
</a><a href="#h77-0-16" id="h77-0-16" class="i">+    ),
</a><a href="#h77-0-17" id="h77-0-17" class="i">+    where: Some(
</a><a href="#h77-0-18" id="h77-0-18" class="i">+        WhereClause(
</a><a href="#h77-0-19" id="h77-0-19" class="i">+            Operation(
</a><a href="#h77-0-20" id="h77-0-20" class="i">+                Equal(
</a><a href="#h77-0-21" id="h77-0-21" class="i">+                    Field(
</a><a href="#h77-0-22" id="h77-0-22" class="i">+                        None,
</a><a href="#h77-0-23" id="h77-0-23" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h77-0-24" id="h77-0-24" class="i">+                    ),
</a><a href="#h77-0-25" id="h77-0-25" class="i">+                    Literal(
</a><a href="#h77-0-26" id="h77-0-26" class="i">+                        Integer(
</a><a href="#h77-0-27" id="h77-0-27" class="i">+                            2,
</a><a href="#h77-0-28" id="h77-0-28" class="i">+                        ),
</a><a href="#h77-0-29" id="h77-0-29" class="i">+                    ),
</a><a href="#h77-0-30" id="h77-0-30" class="i">+                ),
</a><a href="#h77-0-31" id="h77-0-31" class="i">+            ),
</a><a href="#h77-0-32" id="h77-0-32" class="i">+        ),
</a><a href="#h77-0-33" id="h77-0-33" class="i">+    ),
</a><a href="#h77-0-34" id="h77-0-34" class="i">+    group_by: None,
</a><a href="#h77-0-35" id="h77-0-35" class="i">+    having: None,
</a><a href="#h77-0-36" id="h77-0-36" class="i">+    order: [],
</a><a href="#h77-0-37" id="h77-0-37" class="i">+    limit: None,
</a><a href="#h77-0-38" id="h77-0-38" class="i">+    offset: None,
</a><a href="#h77-0-39" id="h77-0-39" class="i">+}
</a><a href="#h77-0-40" id="h77-0-40" class="i">+
</a><a href="#h77-0-41" id="h77-0-41" class="i">+Plan: Plan(
</a><a href="#h77-0-42" id="h77-0-42" class="i">+    Filter {
</a><a href="#h77-0-43" id="h77-0-43" class="i">+        source: Scan {
</a><a href="#h77-0-44" id="h77-0-44" class="i">+            table: &quot;movies&quot;,
</a><a href="#h77-0-45" id="h77-0-45" class="i">+            alias: None,
</a><a href="#h77-0-46" id="h77-0-46" class="i">+            filter: None,
</a><a href="#h77-0-47" id="h77-0-47" class="i">+        },
</a><a href="#h77-0-48" id="h77-0-48" class="i">+        predicate: Equal(
</a><a href="#h77-0-49" id="h77-0-49" class="i">+            Field(
</a><a href="#h77-0-50" id="h77-0-50" class="i">+                None,
</a><a href="#h77-0-51" id="h77-0-51" class="i">+                &quot;genre_id&quot;,
</a><a href="#h77-0-52" id="h77-0-52" class="i">+            ),
</a><a href="#h77-0-53" id="h77-0-53" class="i">+            Constant(
</a><a href="#h77-0-54" id="h77-0-54" class="i">+                Integer(
</a><a href="#h77-0-55" id="h77-0-55" class="i">+                    2,
</a><a href="#h77-0-56" id="h77-0-56" class="i">+                ),
</a><a href="#h77-0-57" id="h77-0-57" class="i">+            ),
</a><a href="#h77-0-58" id="h77-0-58" class="i">+        ),
</a><a href="#h77-0-59" id="h77-0-59" class="i">+    },
</a><a href="#h77-0-60" id="h77-0-60" class="i">+)
</a><a href="#h77-0-61" id="h77-0-61" class="i">+
</a><a href="#h77-0-62" id="h77-0-62" class="i">+Optimized plan: Plan(
</a><a href="#h77-0-63" id="h77-0-63" class="i">+    IndexLookup {
</a><a href="#h77-0-64" id="h77-0-64" class="i">+        table: &quot;movies&quot;,
</a><a href="#h77-0-65" id="h77-0-65" class="i">+        alias: None,
</a><a href="#h77-0-66" id="h77-0-66" class="i">+        column: &quot;genre_id&quot;,
</a><a href="#h77-0-67" id="h77-0-67" class="i">+        keys: [
</a><a href="#h77-0-68" id="h77-0-68" class="i">+            Integer(
</a><a href="#h77-0-69" id="h77-0-69" class="i">+                2,
</a><a href="#h77-0-70" id="h77-0-70" class="i">+            ),
</a><a href="#h77-0-71" id="h77-0-71" class="i">+        ],
</a><a href="#h77-0-72" id="h77-0-72" class="i">+    },
</a><a href="#h77-0-73" id="h77-0-73" class="i">+)
</a><a href="#h77-0-74" id="h77-0-74" class="i">+
</a><a href="#h77-0-75" id="h77-0-75" class="i">+Query: SELECT * FROM movies WHERE genre_id = 2
</a><a href="#h77-0-76" id="h77-0-76" class="i">+
</a><a href="#h77-0-77" id="h77-0-77" class="i">+Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
</a><a href="#h77-0-78" id="h77-0-78" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
</a><a href="#h77-0-79" id="h77-0-79" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><b>diff --git a/<a id="h78" href="../file/tests/sql/schema.rs.html">tests/sql/schema.rs</a> b/<a href="../file/tests/sql/schema.rs.html">tests/sql/schema.rs</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -34,6 +34,16 @@ macro_rules! test_schema {
</a>                     for row in txn.scan(&amp;table.name, None)? {
                         write!(f, &quot;{:?}\n&quot;, row?)?;
                     }
<a href="#h78-0-3" id="h78-0-3" class="i">+
</a><a href="#h78-0-4" id="h78-0-4" class="i">+                    for column in table.columns.iter().filter(|c| c.index) {
</a><a href="#h78-0-5" id="h78-0-5" class="i">+                        write!(f, &quot;\nIndex {}.{}\n&quot;, table.name, column.name)?;
</a><a href="#h78-0-6" id="h78-0-6" class="i">+                        let mut scan = txn.scan_index(&amp;table.name, &amp;column.name)?;
</a><a href="#h78-0-7" id="h78-0-7" class="i">+                        while let Some((value, pks)) = scan.next().transpose()? {
</a><a href="#h78-0-8" id="h78-0-8" class="i">+                            let mut pks = pks.into_iter().collect::&lt;Vec&lt;_&gt;&gt;();
</a><a href="#h78-0-9" id="h78-0-9" class="i">+                            pks.sort_by(|a, b| a.partial_cmp(b).unwrap_or(std::cmp::Ordering::Equal));
</a><a href="#h78-0-10" id="h78-0-10" class="i">+                            write!(f, &quot;{:?} =&gt; {:?}\n&quot;, value, pks)?;
</a><a href="#h78-0-11" id="h78-0-11" class="i">+                        }
</a><a href="#h78-0-12" id="h78-0-12" class="i">+                    }
</a>                 }
                 txn.rollback()?;
 
<a href="#h78-1" id="h78-1" class="h">@@ -103,6 +113,9 @@ test_schema! {
</a>     create_table_default_conflict_float_integer: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value FLOAT DEFAULT 7)&quot;,
     create_table_default_conflict_integer_float: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 3.14)&quot;,
 
<a href="#h78-1-3" id="h78-1-3" class="i">+    create_table_index: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING INDEX)&quot;,
</a><a href="#h78-1-4" id="h78-1-4" class="i">+    create_table_index_pk: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY INDEX, value STRING)&quot;,
</a><a href="#h78-1-5" id="h78-1-5" class="i">+
</a>     create_table_unique: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING UNIQUE)&quot;,
     create_table_unique_null: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NULL UNIQUE)&quot;,
     create_table_unique_not_null: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL UNIQUE)&quot;,
<a href="#h78-2" id="h78-2" class="h">@@ -409,3 +422,25 @@ test_schema! { with [
</a>     update_ref_self_pk_noref: &quot;UPDATE self SET id = 9 WHERE id = 2&quot;,
     update_ref_self_self: &quot;UPDATE self SET self_id = 2 WHERE id = 2&quot;,
 }
<a href="#h78-2-3" id="h78-2-3" class="i">+
</a><a href="#h78-2-4" id="h78-2-4" class="i">+test_schema! { with [
</a><a href="#h78-2-5" id="h78-2-5" class="i">+        &quot;CREATE TABLE test (id INTEGER PRIMARY KEY, name STRING INDEX, value INTEGER)&quot;,
</a><a href="#h78-2-6" id="h78-2-6" class="i">+        &quot;INSERT INTO test VALUES (1, &#39;a&#39;, 101), (2, &#39;b&#39;, 102), (3, &#39;b&#39;, 103)&quot;,
</a><a href="#h78-2-7" id="h78-2-7" class="i">+    ];
</a><a href="#h78-2-8" id="h78-2-8" class="i">+
</a><a href="#h78-2-9" id="h78-2-9" class="i">+    delete_index_only: &quot;DELETE FROM test WHERE id = 1&quot;,
</a><a href="#h78-2-10" id="h78-2-10" class="i">+    delete_index_single: &quot;DELETE FROM test WHERE id = 2&quot;,
</a><a href="#h78-2-11" id="h78-2-11" class="i">+    delete_index_all: &quot;DELETE FROM test&quot;,
</a><a href="#h78-2-12" id="h78-2-12" class="i">+
</a><a href="#h78-2-13" id="h78-2-13" class="i">+    insert_index_exists: &quot;INSERT INTO test VALUES (4, &#39;b&#39;, 104)&quot;,
</a><a href="#h78-2-14" id="h78-2-14" class="i">+    insert_index_new: &quot;INSERT INTO test VALUES (4, &#39;c&#39;, 104)&quot;,
</a><a href="#h78-2-15" id="h78-2-15" class="i">+    insert_index_null: &quot;INSERT INTO test VALUES (4, NULL, 104)&quot;,
</a><a href="#h78-2-16" id="h78-2-16" class="i">+
</a><a href="#h78-2-17" id="h78-2-17" class="i">+    update_index_same: &quot;UPDATE test SET value = 102 WHERE id = 3&quot;,
</a><a href="#h78-2-18" id="h78-2-18" class="i">+    update_index_new: &quot;UPDATE test SET name = &#39;c&#39; WHERE id = 3&quot;,
</a><a href="#h78-2-19" id="h78-2-19" class="i">+    update_index_existing: &quot;UPDATE test SET name = &#39;a&#39; WHERE id = 2&quot;,
</a><a href="#h78-2-20" id="h78-2-20" class="i">+    update_index_last: &quot;UPDATE test SET name = &#39;b&#39; WHERE id = 1&quot;,
</a><a href="#h78-2-21" id="h78-2-21" class="i">+    update_index_swap: &quot;UPDATE test SET name = &#39;c&#39; WHERE id = 1&quot;,
</a><a href="#h78-2-22" id="h78-2-22" class="i">+    update_index_pk: &quot;UPDATE test SET id = 4 WHERE id = 1&quot;,
</a><a href="#h78-2-23" id="h78-2-23" class="i">+    update_index_null: &quot;UPDATE test SET name = NULL WHERE id = 3&quot;,
</a><a href="#h78-2-24" id="h78-2-24" class="i">+}
</a><b>diff --git a/<a id="h79" href="../file/tests/sql/schema/create_table_index.html">tests/sql/schema/create_table_index</a> b/<a href="../file/tests/sql/schema/create_table_index.html">tests/sql/schema/create_table_index</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -0,0 +1,10 @@
</a><a href="#h79-0-0" id="h79-0-0" class="i">+Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING INDEX)
</a><a href="#h79-0-1" id="h79-0-1" class="i">+Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h79-0-2" id="h79-0-2" class="i">+
</a><a href="#h79-0-3" id="h79-0-3" class="i">+Storage:
</a><a href="#h79-0-4" id="h79-0-4" class="i">+CREATE TABLE name (
</a><a href="#h79-0-5" id="h79-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h79-0-6" id="h79-0-6" class="i">+  value STRING DEFAULT NULL INDEX
</a><a href="#h79-0-7" id="h79-0-7" class="i">+)
</a><a href="#h79-0-8" id="h79-0-8" class="i">+
</a><a href="#h79-0-9" id="h79-0-9" class="i">+Index name.value
</a><b>diff --git a/<a id="h80" href="../file/tests/sql/schema/create_table_index_pk.html">tests/sql/schema/create_table_index_pk</a> b/<a href="../file/tests/sql/schema/create_table_index_pk.html">tests/sql/schema/create_table_index_pk</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -0,0 +1,8 @@
</a><a href="#h80-0-0" id="h80-0-0" class="i">+Query: CREATE TABLE name (id INTEGER PRIMARY KEY INDEX, value STRING)
</a><a href="#h80-0-1" id="h80-0-1" class="i">+Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h80-0-2" id="h80-0-2" class="i">+
</a><a href="#h80-0-3" id="h80-0-3" class="i">+Storage:
</a><a href="#h80-0-4" id="h80-0-4" class="i">+CREATE TABLE name (
</a><a href="#h80-0-5" id="h80-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h80-0-6" id="h80-0-6" class="i">+  value STRING DEFAULT NULL
</a><a href="#h80-0-7" id="h80-0-7" class="i">+)
</a><b>diff --git a/<a id="h81" href="../file/tests/sql/schema/delete_index_all.html">tests/sql/schema/delete_index_all</a> b/<a href="../file/tests/sql/schema/delete_index_all.html">tests/sql/schema/delete_index_all</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h81-0-0" id="h81-0-0" class="i">+Query: DELETE FROM test
</a><a href="#h81-0-1" id="h81-0-1" class="i">+Result: Delete { count: 3 }
</a><a href="#h81-0-2" id="h81-0-2" class="i">+
</a><a href="#h81-0-3" id="h81-0-3" class="i">+Storage:
</a><a href="#h81-0-4" id="h81-0-4" class="i">+CREATE TABLE test (
</a><a href="#h81-0-5" id="h81-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h81-0-6" id="h81-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h81-0-7" id="h81-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h81-0-8" id="h81-0-8" class="i">+)
</a><a href="#h81-0-9" id="h81-0-9" class="i">+
</a><a href="#h81-0-10" id="h81-0-10" class="i">+Index test.name
</a><b>diff --git a/<a id="h82" href="../file/tests/sql/schema/delete_index_only.html">tests/sql/schema/delete_index_only</a> b/<a href="../file/tests/sql/schema/delete_index_only.html">tests/sql/schema/delete_index_only</a></b>
<a href="#h82-0" id="h82-0" class="h">@@ -0,0 +1,14 @@
</a><a href="#h82-0-0" id="h82-0-0" class="i">+Query: DELETE FROM test WHERE id = 1
</a><a href="#h82-0-1" id="h82-0-1" class="i">+Result: Delete { count: 1 }
</a><a href="#h82-0-2" id="h82-0-2" class="i">+
</a><a href="#h82-0-3" id="h82-0-3" class="i">+Storage:
</a><a href="#h82-0-4" id="h82-0-4" class="i">+CREATE TABLE test (
</a><a href="#h82-0-5" id="h82-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h82-0-6" id="h82-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h82-0-7" id="h82-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h82-0-8" id="h82-0-8" class="i">+)
</a><a href="#h82-0-9" id="h82-0-9" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h82-0-10" id="h82-0-10" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h82-0-11" id="h82-0-11" class="i">+
</a><a href="#h82-0-12" id="h82-0-12" class="i">+Index test.name
</a><a href="#h82-0-13" id="h82-0-13" class="i">+String(&quot;b&quot;) =&gt; [Integer(2), Integer(3)]
</a><b>diff --git a/<a id="h83" href="../file/tests/sql/schema/delete_index_single.html">tests/sql/schema/delete_index_single</a> b/<a href="../file/tests/sql/schema/delete_index_single.html">tests/sql/schema/delete_index_single</a></b>
<a href="#h83-0" id="h83-0" class="h">@@ -0,0 +1,15 @@
</a><a href="#h83-0-0" id="h83-0-0" class="i">+Query: DELETE FROM test WHERE id = 2
</a><a href="#h83-0-1" id="h83-0-1" class="i">+Result: Delete { count: 1 }
</a><a href="#h83-0-2" id="h83-0-2" class="i">+
</a><a href="#h83-0-3" id="h83-0-3" class="i">+Storage:
</a><a href="#h83-0-4" id="h83-0-4" class="i">+CREATE TABLE test (
</a><a href="#h83-0-5" id="h83-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h83-0-6" id="h83-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h83-0-7" id="h83-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h83-0-8" id="h83-0-8" class="i">+)
</a><a href="#h83-0-9" id="h83-0-9" class="i">+[Integer(1), String(&quot;a&quot;), Integer(101)]
</a><a href="#h83-0-10" id="h83-0-10" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h83-0-11" id="h83-0-11" class="i">+
</a><a href="#h83-0-12" id="h83-0-12" class="i">+Index test.name
</a><a href="#h83-0-13" id="h83-0-13" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h83-0-14" id="h83-0-14" class="i">+String(&quot;b&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h84" href="../file/tests/sql/schema/insert_index_exists.html">tests/sql/schema/insert_index_exists</a> b/<a href="../file/tests/sql/schema/insert_index_exists.html">tests/sql/schema/insert_index_exists</a></b>
<a href="#h84-0" id="h84-0" class="h">@@ -0,0 +1,17 @@
</a><a href="#h84-0-0" id="h84-0-0" class="i">+Query: INSERT INTO test VALUES (4, &#39;b&#39;, 104)
</a><a href="#h84-0-1" id="h84-0-1" class="i">+Result: Create { count: 1 }
</a><a href="#h84-0-2" id="h84-0-2" class="i">+
</a><a href="#h84-0-3" id="h84-0-3" class="i">+Storage:
</a><a href="#h84-0-4" id="h84-0-4" class="i">+CREATE TABLE test (
</a><a href="#h84-0-5" id="h84-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h84-0-6" id="h84-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h84-0-7" id="h84-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h84-0-8" id="h84-0-8" class="i">+)
</a><a href="#h84-0-9" id="h84-0-9" class="i">+[Integer(1), String(&quot;a&quot;), Integer(101)]
</a><a href="#h84-0-10" id="h84-0-10" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h84-0-11" id="h84-0-11" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h84-0-12" id="h84-0-12" class="i">+[Integer(4), String(&quot;b&quot;), Integer(104)]
</a><a href="#h84-0-13" id="h84-0-13" class="i">+
</a><a href="#h84-0-14" id="h84-0-14" class="i">+Index test.name
</a><a href="#h84-0-15" id="h84-0-15" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h84-0-16" id="h84-0-16" class="i">+String(&quot;b&quot;) =&gt; [Integer(2), Integer(3), Integer(4)]
</a><b>diff --git a/<a id="h85" href="../file/tests/sql/schema/insert_index_new.html">tests/sql/schema/insert_index_new</a> b/<a href="../file/tests/sql/schema/insert_index_new.html">tests/sql/schema/insert_index_new</a></b>
<a href="#h85-0" id="h85-0" class="h">@@ -0,0 +1,18 @@
</a><a href="#h85-0-0" id="h85-0-0" class="i">+Query: INSERT INTO test VALUES (4, &#39;c&#39;, 104)
</a><a href="#h85-0-1" id="h85-0-1" class="i">+Result: Create { count: 1 }
</a><a href="#h85-0-2" id="h85-0-2" class="i">+
</a><a href="#h85-0-3" id="h85-0-3" class="i">+Storage:
</a><a href="#h85-0-4" id="h85-0-4" class="i">+CREATE TABLE test (
</a><a href="#h85-0-5" id="h85-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h85-0-6" id="h85-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h85-0-7" id="h85-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h85-0-8" id="h85-0-8" class="i">+)
</a><a href="#h85-0-9" id="h85-0-9" class="i">+[Integer(1), String(&quot;a&quot;), Integer(101)]
</a><a href="#h85-0-10" id="h85-0-10" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h85-0-11" id="h85-0-11" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h85-0-12" id="h85-0-12" class="i">+[Integer(4), String(&quot;c&quot;), Integer(104)]
</a><a href="#h85-0-13" id="h85-0-13" class="i">+
</a><a href="#h85-0-14" id="h85-0-14" class="i">+Index test.name
</a><a href="#h85-0-15" id="h85-0-15" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h85-0-16" id="h85-0-16" class="i">+String(&quot;b&quot;) =&gt; [Integer(2), Integer(3)]
</a><a href="#h85-0-17" id="h85-0-17" class="i">+String(&quot;c&quot;) =&gt; [Integer(4)]
</a><b>diff --git a/<a id="h86" href="../file/tests/sql/schema/insert_index_null.html">tests/sql/schema/insert_index_null</a> b/<a href="../file/tests/sql/schema/insert_index_null.html">tests/sql/schema/insert_index_null</a></b>
<a href="#h86-0" id="h86-0" class="h">@@ -0,0 +1,18 @@
</a><a href="#h86-0-0" id="h86-0-0" class="i">+Query: INSERT INTO test VALUES (4, NULL, 104)
</a><a href="#h86-0-1" id="h86-0-1" class="i">+Result: Create { count: 1 }
</a><a href="#h86-0-2" id="h86-0-2" class="i">+
</a><a href="#h86-0-3" id="h86-0-3" class="i">+Storage:
</a><a href="#h86-0-4" id="h86-0-4" class="i">+CREATE TABLE test (
</a><a href="#h86-0-5" id="h86-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h86-0-6" id="h86-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h86-0-7" id="h86-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h86-0-8" id="h86-0-8" class="i">+)
</a><a href="#h86-0-9" id="h86-0-9" class="i">+[Integer(1), String(&quot;a&quot;), Integer(101)]
</a><a href="#h86-0-10" id="h86-0-10" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h86-0-11" id="h86-0-11" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h86-0-12" id="h86-0-12" class="i">+[Integer(4), Null, Integer(104)]
</a><a href="#h86-0-13" id="h86-0-13" class="i">+
</a><a href="#h86-0-14" id="h86-0-14" class="i">+Index test.name
</a><a href="#h86-0-15" id="h86-0-15" class="i">+Null =&gt; [Integer(4)]
</a><a href="#h86-0-16" id="h86-0-16" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h86-0-17" id="h86-0-17" class="i">+String(&quot;b&quot;) =&gt; [Integer(2), Integer(3)]
</a><b>diff --git a/<a id="h87" href="../file/tests/sql/schema/update_index_existing.html">tests/sql/schema/update_index_existing</a> b/<a href="../file/tests/sql/schema/update_index_existing.html">tests/sql/schema/update_index_existing</a></b>
<a href="#h87-0" id="h87-0" class="h">@@ -0,0 +1,16 @@
</a><a href="#h87-0-0" id="h87-0-0" class="i">+Query: UPDATE test SET name = &#39;a&#39; WHERE id = 2
</a><a href="#h87-0-1" id="h87-0-1" class="i">+Result: Update { count: 1 }
</a><a href="#h87-0-2" id="h87-0-2" class="i">+
</a><a href="#h87-0-3" id="h87-0-3" class="i">+Storage:
</a><a href="#h87-0-4" id="h87-0-4" class="i">+CREATE TABLE test (
</a><a href="#h87-0-5" id="h87-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h87-0-6" id="h87-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h87-0-7" id="h87-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h87-0-8" id="h87-0-8" class="i">+)
</a><a href="#h87-0-9" id="h87-0-9" class="i">+[Integer(1), String(&quot;a&quot;), Integer(101)]
</a><a href="#h87-0-10" id="h87-0-10" class="i">+[Integer(2), String(&quot;a&quot;), Integer(102)]
</a><a href="#h87-0-11" id="h87-0-11" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h87-0-12" id="h87-0-12" class="i">+
</a><a href="#h87-0-13" id="h87-0-13" class="i">+Index test.name
</a><a href="#h87-0-14" id="h87-0-14" class="i">+String(&quot;a&quot;) =&gt; [Integer(1), Integer(2)]
</a><a href="#h87-0-15" id="h87-0-15" class="i">+String(&quot;b&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h88" href="../file/tests/sql/schema/update_index_last.html">tests/sql/schema/update_index_last</a> b/<a href="../file/tests/sql/schema/update_index_last.html">tests/sql/schema/update_index_last</a></b>
<a href="#h88-0" id="h88-0" class="h">@@ -0,0 +1,15 @@
</a><a href="#h88-0-0" id="h88-0-0" class="i">+Query: UPDATE test SET name = &#39;b&#39; WHERE id = 1
</a><a href="#h88-0-1" id="h88-0-1" class="i">+Result: Update { count: 1 }
</a><a href="#h88-0-2" id="h88-0-2" class="i">+
</a><a href="#h88-0-3" id="h88-0-3" class="i">+Storage:
</a><a href="#h88-0-4" id="h88-0-4" class="i">+CREATE TABLE test (
</a><a href="#h88-0-5" id="h88-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h88-0-6" id="h88-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h88-0-7" id="h88-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h88-0-8" id="h88-0-8" class="i">+)
</a><a href="#h88-0-9" id="h88-0-9" class="i">+[Integer(1), String(&quot;b&quot;), Integer(101)]
</a><a href="#h88-0-10" id="h88-0-10" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h88-0-11" id="h88-0-11" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h88-0-12" id="h88-0-12" class="i">+
</a><a href="#h88-0-13" id="h88-0-13" class="i">+Index test.name
</a><a href="#h88-0-14" id="h88-0-14" class="i">+String(&quot;b&quot;) =&gt; [Integer(1), Integer(2), Integer(3)]
</a><b>diff --git a/<a id="h89" href="../file/tests/sql/schema/update_index_new.html">tests/sql/schema/update_index_new</a> b/<a href="../file/tests/sql/schema/update_index_new.html">tests/sql/schema/update_index_new</a></b>
<a href="#h89-0" id="h89-0" class="h">@@ -0,0 +1,17 @@
</a><a href="#h89-0-0" id="h89-0-0" class="i">+Query: UPDATE test SET name = &#39;c&#39; WHERE id = 3
</a><a href="#h89-0-1" id="h89-0-1" class="i">+Result: Update { count: 1 }
</a><a href="#h89-0-2" id="h89-0-2" class="i">+
</a><a href="#h89-0-3" id="h89-0-3" class="i">+Storage:
</a><a href="#h89-0-4" id="h89-0-4" class="i">+CREATE TABLE test (
</a><a href="#h89-0-5" id="h89-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h89-0-6" id="h89-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h89-0-7" id="h89-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h89-0-8" id="h89-0-8" class="i">+)
</a><a href="#h89-0-9" id="h89-0-9" class="i">+[Integer(1), String(&quot;a&quot;), Integer(101)]
</a><a href="#h89-0-10" id="h89-0-10" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h89-0-11" id="h89-0-11" class="i">+[Integer(3), String(&quot;c&quot;), Integer(103)]
</a><a href="#h89-0-12" id="h89-0-12" class="i">+
</a><a href="#h89-0-13" id="h89-0-13" class="i">+Index test.name
</a><a href="#h89-0-14" id="h89-0-14" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h89-0-15" id="h89-0-15" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><a href="#h89-0-16" id="h89-0-16" class="i">+String(&quot;c&quot;) =&gt; [Integer(3)]
</a><b>diff --git a/<a id="h90" href="../file/tests/sql/schema/update_index_null.html">tests/sql/schema/update_index_null</a> b/<a href="../file/tests/sql/schema/update_index_null.html">tests/sql/schema/update_index_null</a></b>
<a href="#h90-0" id="h90-0" class="h">@@ -0,0 +1,17 @@
</a><a href="#h90-0-0" id="h90-0-0" class="i">+Query: UPDATE test SET name = NULL WHERE id = 3
</a><a href="#h90-0-1" id="h90-0-1" class="i">+Result: Update { count: 1 }
</a><a href="#h90-0-2" id="h90-0-2" class="i">+
</a><a href="#h90-0-3" id="h90-0-3" class="i">+Storage:
</a><a href="#h90-0-4" id="h90-0-4" class="i">+CREATE TABLE test (
</a><a href="#h90-0-5" id="h90-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h90-0-6" id="h90-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h90-0-7" id="h90-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h90-0-8" id="h90-0-8" class="i">+)
</a><a href="#h90-0-9" id="h90-0-9" class="i">+[Integer(1), String(&quot;a&quot;), Integer(101)]
</a><a href="#h90-0-10" id="h90-0-10" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h90-0-11" id="h90-0-11" class="i">+[Integer(3), Null, Integer(103)]
</a><a href="#h90-0-12" id="h90-0-12" class="i">+
</a><a href="#h90-0-13" id="h90-0-13" class="i">+Index test.name
</a><a href="#h90-0-14" id="h90-0-14" class="i">+Null =&gt; [Integer(3)]
</a><a href="#h90-0-15" id="h90-0-15" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h90-0-16" id="h90-0-16" class="i">+String(&quot;b&quot;) =&gt; [Integer(2)]
</a><b>diff --git a/<a id="h91" href="../file/tests/sql/schema/update_index_pk.html">tests/sql/schema/update_index_pk</a> b/<a href="../file/tests/sql/schema/update_index_pk.html">tests/sql/schema/update_index_pk</a></b>
<a href="#h91-0" id="h91-0" class="h">@@ -0,0 +1,16 @@
</a><a href="#h91-0-0" id="h91-0-0" class="i">+Query: UPDATE test SET id = 4 WHERE id = 1
</a><a href="#h91-0-1" id="h91-0-1" class="i">+Result: Update { count: 1 }
</a><a href="#h91-0-2" id="h91-0-2" class="i">+
</a><a href="#h91-0-3" id="h91-0-3" class="i">+Storage:
</a><a href="#h91-0-4" id="h91-0-4" class="i">+CREATE TABLE test (
</a><a href="#h91-0-5" id="h91-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h91-0-6" id="h91-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h91-0-7" id="h91-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h91-0-8" id="h91-0-8" class="i">+)
</a><a href="#h91-0-9" id="h91-0-9" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h91-0-10" id="h91-0-10" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h91-0-11" id="h91-0-11" class="i">+[Integer(4), String(&quot;a&quot;), Integer(101)]
</a><a href="#h91-0-12" id="h91-0-12" class="i">+
</a><a href="#h91-0-13" id="h91-0-13" class="i">+Index test.name
</a><a href="#h91-0-14" id="h91-0-14" class="i">+String(&quot;a&quot;) =&gt; [Integer(4)]
</a><a href="#h91-0-15" id="h91-0-15" class="i">+String(&quot;b&quot;) =&gt; [Integer(2), Integer(3)]
</a><b>diff --git a/<a id="h92" href="../file/tests/sql/schema/update_index_same.html">tests/sql/schema/update_index_same</a> b/<a href="../file/tests/sql/schema/update_index_same.html">tests/sql/schema/update_index_same</a></b>
<a href="#h92-0" id="h92-0" class="h">@@ -0,0 +1,16 @@
</a><a href="#h92-0-0" id="h92-0-0" class="i">+Query: UPDATE test SET value = 102 WHERE id = 3
</a><a href="#h92-0-1" id="h92-0-1" class="i">+Result: Update { count: 1 }
</a><a href="#h92-0-2" id="h92-0-2" class="i">+
</a><a href="#h92-0-3" id="h92-0-3" class="i">+Storage:
</a><a href="#h92-0-4" id="h92-0-4" class="i">+CREATE TABLE test (
</a><a href="#h92-0-5" id="h92-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h92-0-6" id="h92-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h92-0-7" id="h92-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h92-0-8" id="h92-0-8" class="i">+)
</a><a href="#h92-0-9" id="h92-0-9" class="i">+[Integer(1), String(&quot;a&quot;), Integer(101)]
</a><a href="#h92-0-10" id="h92-0-10" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h92-0-11" id="h92-0-11" class="i">+[Integer(3), String(&quot;b&quot;), Integer(102)]
</a><a href="#h92-0-12" id="h92-0-12" class="i">+
</a><a href="#h92-0-13" id="h92-0-13" class="i">+Index test.name
</a><a href="#h92-0-14" id="h92-0-14" class="i">+String(&quot;a&quot;) =&gt; [Integer(1)]
</a><a href="#h92-0-15" id="h92-0-15" class="i">+String(&quot;b&quot;) =&gt; [Integer(2), Integer(3)]
</a><b>diff --git a/<a id="h93" href="../file/tests/sql/schema/update_index_swap.html">tests/sql/schema/update_index_swap</a> b/<a href="../file/tests/sql/schema/update_index_swap.html">tests/sql/schema/update_index_swap</a></b>
<a href="#h93-0" id="h93-0" class="h">@@ -0,0 +1,16 @@
</a><a href="#h93-0-0" id="h93-0-0" class="i">+Query: UPDATE test SET name = &#39;c&#39; WHERE id = 1
</a><a href="#h93-0-1" id="h93-0-1" class="i">+Result: Update { count: 1 }
</a><a href="#h93-0-2" id="h93-0-2" class="i">+
</a><a href="#h93-0-3" id="h93-0-3" class="i">+Storage:
</a><a href="#h93-0-4" id="h93-0-4" class="i">+CREATE TABLE test (
</a><a href="#h93-0-5" id="h93-0-5" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h93-0-6" id="h93-0-6" class="i">+  name STRING DEFAULT NULL INDEX,
</a><a href="#h93-0-7" id="h93-0-7" class="i">+  value INTEGER DEFAULT NULL
</a><a href="#h93-0-8" id="h93-0-8" class="i">+)
</a><a href="#h93-0-9" id="h93-0-9" class="i">+[Integer(1), String(&quot;c&quot;), Integer(101)]
</a><a href="#h93-0-10" id="h93-0-10" class="i">+[Integer(2), String(&quot;b&quot;), Integer(102)]
</a><a href="#h93-0-11" id="h93-0-11" class="i">+[Integer(3), String(&quot;b&quot;), Integer(103)]
</a><a href="#h93-0-12" id="h93-0-12" class="i">+
</a><a href="#h93-0-13" id="h93-0-13" class="i">+Index test.name
</a><a href="#h93-0-14" id="h93-0-14" class="i">+String(&quot;b&quot;) =&gt; [Integer(2), Integer(3)]
</a><a href="#h93-0-15" id="h93-0-15" class="i">+String(&quot;c&quot;) =&gt; [Integer(1)]
</a></pre>
</div>
</body>
</html>
