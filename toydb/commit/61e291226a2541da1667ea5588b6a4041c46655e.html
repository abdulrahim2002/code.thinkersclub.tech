<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: add schema goldentests - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/61e291226a2541da1667ea5588b6a4041c46655e.html">61e291226a2541da1667ea5588b6a4041c46655e</a>
<b>parent</b> <a href="../commit/485747721694fa8619a2df5ee1c360b52f9e0e11.html">485747721694fa8619a2df5ee1c360b52f9e0e11</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sat, 29 Jun 2024 12:57:27 +0200

sql: add schema goldentests

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/encoding/format.rs</a></td><td> | </td><td class="num">38</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/engine/local.rs</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/engine/mod.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/mod.rs</a></td><td> | </td><td class="num">149</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="A">A</td><td><a href="#h4">src/sql/testscripts/schema/create_table</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h5">src/sql/testscripts/schema/create_table_datatypes</a></td><td> | </td><td class="num">38</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h6">src/sql/testscripts/schema/create_table_default</a></td><td> | </td><td class="num">54</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h7">src/sql/testscripts/schema/create_table_index</a></td><td> | </td><td class="num">32</td><td><span class="i">++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h8">src/sql/testscripts/schema/create_table_names</a></td><td> | </td><td class="num">72</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h9">src/sql/testscripts/schema/create_table_null</a></td><td> | </td><td class="num">33</td><td><span class="i">+++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h10">src/sql/testscripts/schema/create_table_primary_key</a></td><td> | </td><td class="num">39</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h11">src/sql/testscripts/schema/create_table_reference</a></td><td> | </td><td class="num">63</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h12">src/sql/testscripts/schema/create_table_transaction</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h13">src/sql/testscripts/schema/create_table_unique</a></td><td> | </td><td class="num">37</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h14">src/sql/testscripts/schema/drop_table</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h15">src/sql/testscripts/schema/drop_table_index</a></td><td> | </td><td class="num">118</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h16">src/sql/testscripts/schema/drop_table_ref</a></td><td> | </td><td class="num">31</td><td><span class="i">+++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h17">src/sql/testscripts/schema/drop_table_transaction</a></td><td> | </td><td class="num">80</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">src/storage/mvcc.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/schema.rs</a></td><td> | </td><td class="num">108</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h20">tests/sql/schema/create_table_alphanumeric</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h21">tests/sql/schema/create_table_bare</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h22">tests/sql/schema/create_table_columns_empty</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h23">tests/sql/schema/create_table_columns_missing</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h24">tests/sql/schema/create_table_datatype</a></td><td> | </td><td class="num">27</td><td><span class="i"></span><span class="d">---------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h25">tests/sql/schema/create_table_datatype_missing</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h26">tests/sql/schema/create_table_datatype_null</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h27">tests/sql/schema/create_table_default_boolean</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h28">tests/sql/schema/create_table_default_conflict</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h29">tests/sql/schema/create_table_default_conflict_float_integer</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h30">tests/sql/schema/create_table_default_conflict_integer_float</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h31">tests/sql/schema/create_table_default_expr</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h32">tests/sql/schema/create_table_default_float</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h33">tests/sql/schema/create_table_default_integer</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h34">tests/sql/schema/create_table_default_null</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h35">tests/sql/schema/create_table_default_null_not</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h36">tests/sql/schema/create_table_default_string</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h37">tests/sql/schema/create_table_exists</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h38">tests/sql/schema/create_table_index</a></td><td> | </td><td class="num">10</td><td><span class="i"></span><span class="d">----------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h39">tests/sql/schema/create_table_index_pk</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h40">tests/sql/schema/create_table_name_alphanumeric</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h41">tests/sql/schema/create_table_name_case</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h42">tests/sql/schema/create_table_name_emoji</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h43">tests/sql/schema/create_table_name_emoji_quoted</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h44">tests/sql/schema/create_table_name_japanese</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h45">tests/sql/schema/create_table_name_keyword</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h46">tests/sql/schema/create_table_name_keyword_quoted</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h47">tests/sql/schema/create_table_name_missing</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h48">tests/sql/schema/create_table_name_quote_double</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h49">tests/sql/schema/create_table_name_quote_double_escaped</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h50">tests/sql/schema/create_table_name_quote_double_single</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h51">tests/sql/schema/create_table_name_quote_double_unterminated</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h52">tests/sql/schema/create_table_name_quote_single</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h53">tests/sql/schema/create_table_name_underscore_prefix</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h54">tests/sql/schema/create_table_null</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h55">tests/sql/schema/create_table_null_default</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h56">tests/sql/schema/create_table_null_not</a></td><td> | </td><td class="num">8</td><td><span class="i"></span><span class="d">--------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h57">tests/sql/schema/create_table_null_not_null</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h58">tests/sql/schema/create_table_pk_default</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h59">tests/sql/schema/create_table_pk_missing</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h60">tests/sql/schema/create_table_pk_multiple</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h61">tests/sql/schema/create_table_pk_nullable</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h62">tests/sql/schema/create_table_pk_unique</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h63">tests/sql/schema/create_table_ref</a></td><td> | </td><td class="num">14</td><td><span class="i"></span><span class="d">--------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h64">tests/sql/schema/create_table_ref_missing</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h65">tests/sql/schema/create_table_ref_multiple</a></td><td> | </td><td class="num">25</td><td><span class="i"></span><span class="d">-------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h66">tests/sql/schema/create_table_ref_self</a></td><td> | </td><td class="num">14</td><td><span class="i"></span><span class="d">--------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h67">tests/sql/schema/create_table_ref_self_type</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h68">tests/sql/schema/create_table_ref_type</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h69">tests/sql/schema/create_table_unique</a></td><td> | </td><td class="num">10</td><td><span class="i"></span><span class="d">----------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h70">tests/sql/schema/create_table_unique_default</a></td><td> | </td><td class="num">10</td><td><span class="i"></span><span class="d">----------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h71">tests/sql/schema/create_table_unique_not_null</a></td><td> | </td><td class="num">10</td><td><span class="i"></span><span class="d">----------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h72">tests/sql/schema/create_table_unique_null</a></td><td> | </td><td class="num">10</td><td><span class="i"></span><span class="d">----------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h73">tests/sql/schema/drop_table</a></td><td> | </td><td class="num">17</td><td><span class="i"></span><span class="d">-----------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h74">tests/sql/schema/drop_table_bare</a></td><td> | </td><td class="num">24</td><td><span class="i"></span><span class="d">------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h75">tests/sql/schema/drop_table_if_exists</a></td><td> | </td><td class="num">17</td><td><span class="i"></span><span class="d">-----------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h76">tests/sql/schema/drop_table_if_exists_missing</a></td><td> | </td><td class="num">24</td><td><span class="i"></span><span class="d">------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h77">tests/sql/schema/drop_table_missing</a></td><td> | </td><td class="num">24</td><td><span class="i"></span><span class="d">------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h78">tests/sql/schema/drop_table_multiple</a></td><td> | </td><td class="num">24</td><td><span class="i"></span><span class="d">------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h79">tests/sql/schema/drop_table_ref_self</a></td><td> | </td><td class="num">14</td><td><span class="i"></span><span class="d">--------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h80">tests/sql/schema/drop_table_ref_source</a></td><td> | </td><td class="num">14</td><td><span class="i"></span><span class="d">--------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h81">tests/sql/schema/drop_table_ref_target</a></td><td> | </td><td class="num">21</td><td><span class="i"></span><span class="d">---------------------</span></td></tr>
</table></pre><pre>82 files changed, 934 insertions(+), 706 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/encoding/format.rs.html">src/encoding/format.rs</a> b/<a href="../file/src/encoding/format.rs.html">src/encoding/format.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -3,6 +3,7 @@
</a> 
 use super::{bincode, Key as _};
 use crate::raft;
<a href="#h0-0-3" id="h0-0-3" class="i">+use crate::sql;
</a> use crate::storage::mvcc;
 
 use itertools::Itertools as _;
<a href="#h0-1" id="h0-1" class="h">@@ -149,3 +150,40 @@ impl&lt;I: Formatter&gt; Formatter for MVCC&lt;I&gt; {
</a>         }
     }
 }
<a href="#h0-1-3" id="h0-1-3" class="i">+
</a><a href="#h0-1-4" id="h0-1-4" class="i">+/// Formats SQL keys/values.
</a><a href="#h0-1-5" id="h0-1-5" class="i">+/// TODO: consider more terse formatting, e.g. dropping the value type names and
</a><a href="#h0-1-6" id="h0-1-6" class="i">+/// instead relying on unambiguous string formatting.
</a><a href="#h0-1-7" id="h0-1-7" class="i">+pub struct SQL;
</a><a href="#h0-1-8" id="h0-1-8" class="i">+
</a><a href="#h0-1-9" id="h0-1-9" class="i">+impl Formatter for SQL {
</a><a href="#h0-1-10" id="h0-1-10" class="i">+    fn key(key: &amp;[u8]) -&gt; String {
</a><a href="#h0-1-11" id="h0-1-11" class="i">+        let Ok(key) = sql::engine::Key::decode(key) else { return Raw::key(key) };
</a><a href="#h0-1-12" id="h0-1-12" class="i">+        format!(&quot;sql:{key:?}&quot;)
</a><a href="#h0-1-13" id="h0-1-13" class="i">+    }
</a><a href="#h0-1-14" id="h0-1-14" class="i">+
</a><a href="#h0-1-15" id="h0-1-15" class="i">+    fn value(key: &amp;[u8], value: &amp;[u8]) -&gt; String {
</a><a href="#h0-1-16" id="h0-1-16" class="i">+        let Ok(key) = sql::engine::Key::decode(key) else { return Raw::key(value) };
</a><a href="#h0-1-17" id="h0-1-17" class="i">+        match key {
</a><a href="#h0-1-18" id="h0-1-18" class="i">+            sql::engine::Key::Table(_) =&gt; {
</a><a href="#h0-1-19" id="h0-1-19" class="i">+                let Ok(table) = bincode::deserialize::&lt;sql::types::Table&gt;(value) else {
</a><a href="#h0-1-20" id="h0-1-20" class="i">+                    return Raw::bytes(value);
</a><a href="#h0-1-21" id="h0-1-21" class="i">+                };
</a><a href="#h0-1-22" id="h0-1-22" class="i">+                let re = regex::Regex::new(r#&quot;\n\s*&quot;#).expect(&quot;regex failed&quot;);
</a><a href="#h0-1-23" id="h0-1-23" class="i">+                re.replace_all(&amp;format!(&quot;{table}&quot;), &quot; &quot;).into_owned()
</a><a href="#h0-1-24" id="h0-1-24" class="i">+            }
</a><a href="#h0-1-25" id="h0-1-25" class="i">+            sql::engine::Key::Row(_, _) =&gt; {
</a><a href="#h0-1-26" id="h0-1-26" class="i">+                let Ok(row) = bincode::deserialize::&lt;sql::types::Row&gt;(value) else {
</a><a href="#h0-1-27" id="h0-1-27" class="i">+                    return Raw::bytes(value);
</a><a href="#h0-1-28" id="h0-1-28" class="i">+                };
</a><a href="#h0-1-29" id="h0-1-29" class="i">+                row.into_iter().map(|v| format!(&quot;{v:?}&quot;)).join(&quot;,&quot;)
</a><a href="#h0-1-30" id="h0-1-30" class="i">+            }
</a><a href="#h0-1-31" id="h0-1-31" class="i">+            sql::engine::Key::Index(_, _, _) =&gt; {
</a><a href="#h0-1-32" id="h0-1-32" class="i">+                let Ok(index) = bincode::deserialize::&lt;BTreeSet&lt;sql::types::Value&gt;&gt;(value) else {
</a><a href="#h0-1-33" id="h0-1-33" class="i">+                    return Raw::bytes(value);
</a><a href="#h0-1-34" id="h0-1-34" class="i">+                };
</a><a href="#h0-1-35" id="h0-1-35" class="i">+                index.into_iter().map(|v| format!(&quot;{v:?}&quot;)).join(&quot;,&quot;)
</a><a href="#h0-1-36" id="h0-1-36" class="i">+            }
</a><a href="#h0-1-37" id="h0-1-37" class="i">+        }
</a><a href="#h0-1-38" id="h0-1-38" class="i">+    }
</a><a href="#h0-1-39" id="h0-1-39" class="i">+}
</a><b>diff --git a/<a id="h1" href="../file/src/sql/engine/local.rs.html">src/sql/engine/local.rs</a> b/<a href="../file/src/sql/engine/local.rs.html">src/sql/engine/local.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -14,7 +14,7 @@ use std::collections::{BTreeMap, BTreeSet};
</a> /// node-local SQL storage.
 pub struct Local&lt;E: storage::Engine + &#39;static&gt; {
     /// The local MVCC storage engine.
<a href="#h1-0-3" id="h1-0-3" class="d">-    pub(super) mvcc: mvcc::MVCC&lt;E&gt;,
</a><a href="#h1-0-4" id="h1-0-4" class="i">+    pub(crate) mvcc: mvcc::MVCC&lt;E&gt;,
</a> }
 
 impl&lt;E: storage::Engine&gt; Local&lt;E&gt; {
<a href="#h1-1" id="h1-1" class="h">@@ -410,8 +410,8 @@ impl&lt;E: storage::Engine&gt; Catalog for Transaction&lt;E&gt; {
</a> /// table/column names, so this is fine.
 ///
 /// Uses Cow to allow encoding borrowed values but decoding owned values.
<a href="#h1-1-3" id="h1-1-3" class="d">-#[derive(Deserialize, Serialize)]
</a><a href="#h1-1-4" id="h1-1-4" class="d">-enum Key&lt;&#39;a&gt; {
</a><a href="#h1-1-5" id="h1-1-5" class="i">+#[derive(Debug, Deserialize, Serialize)]
</a><a href="#h1-1-6" id="h1-1-6" class="i">+pub enum Key&lt;&#39;a&gt; {
</a>     /// A table schema by table name.
     Table(Cow&lt;&#39;a, str&gt;),
     /// An index entry, by table name, index name, and index value.
<b>diff --git a/<a id="h2" href="../file/src/sql/engine/mod.rs.html">src/sql/engine/mod.rs</a> b/<a href="../file/src/sql/engine/mod.rs.html">src/sql/engine/mod.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -4,6 +4,6 @@ mod raft;
</a> mod session;
 
 pub use engine::{Catalog, Engine, IndexScan, Transaction};
<a href="#h2-0-3" id="h2-0-3" class="d">-pub use local::Local;
</a><a href="#h2-0-4" id="h2-0-4" class="i">+pub use local::{Key, Local};
</a> pub use raft::{Raft, Status};
 pub use session::{Session, StatementResult};
<b>diff --git a/<a id="h3" href="../file/src/sql/mod.rs.html">src/sql/mod.rs</a> b/<a href="../file/src/sql/mod.rs.html">src/sql/mod.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -6,24 +6,167 @@ pub mod types;
</a> 
 #[cfg(test)]
 mod tests {
<a href="#h3-0-3" id="h3-0-3" class="d">-    use crate::sql::engine::{Engine, Local};
</a><a href="#h3-0-4" id="h3-0-4" class="i">+    use crate::encoding::format::{self, Formatter as _};
</a><a href="#h3-0-5" id="h3-0-5" class="i">+    use crate::sql::engine::{Engine, Local, StatementResult};
</a>     use crate::sql::planner::{Planner, Scope};
     use crate::sql::types::Value;
<a href="#h3-0-8" id="h3-0-8" class="d">-    use crate::storage;
</a><a href="#h3-0-9" id="h3-0-9" class="i">+    use crate::storage::engine::test::{Emit, Mirror, Operation};
</a><a href="#h3-0-10" id="h3-0-10" class="i">+    use crate::storage::{self, Engine as _};
</a><a href="#h3-0-11" id="h3-0-11" class="i">+    use crossbeam::channel::Receiver;
</a><a href="#h3-0-12" id="h3-0-12" class="i">+    use itertools::Itertools as _;
</a>     use std::error::Error;
     use std::fmt::Write as _;
     use std::result::Result;
     use test_each_file::test_each_path;
 
<a href="#h3-0-18" id="h3-0-18" class="i">+    use super::engine::{Catalog as _, Session};
</a>     use super::parser::Parser;
 
     // Run goldenscript tests in src/sql/testscripts.
<a href="#h3-0-22" id="h3-0-22" class="d">-    test_each_path! { in &quot;src/sql/testscripts/expressions&quot; as expressions =&gt; test_goldenscript }
</a><a href="#h3-0-23" id="h3-0-23" class="i">+    test_each_path! { in &quot;src/sql/testscripts/schema&quot; as schema =&gt; test_goldenscript }
</a><a href="#h3-0-24" id="h3-0-24" class="i">+    test_each_path! { in &quot;src/sql/testscripts/expressions&quot; as expressions =&gt; test_goldenscript_expr }
</a> 
     fn test_goldenscript(path: &amp;std::path::Path) {
<a href="#h3-0-27" id="h3-0-27" class="i">+        // Since the runner&#39;s Session can&#39;t reference an Engine stored in the
</a><a href="#h3-0-28" id="h3-0-28" class="i">+        // same struct, we borrow the engine. Use both a BitCask and a Memory
</a><a href="#h3-0-29" id="h3-0-29" class="i">+        // engine, and mirror operations across them. Emit engine operations to
</a><a href="#h3-0-30" id="h3-0-30" class="i">+        // op_rx.
</a><a href="#h3-0-31" id="h3-0-31" class="i">+        let (op_tx, op_rx) = crossbeam::channel::unbounded();
</a><a href="#h3-0-32" id="h3-0-32" class="i">+        let tempdir = tempfile::TempDir::with_prefix(&quot;toydb&quot;).expect(&quot;tempdir failed&quot;);
</a><a href="#h3-0-33" id="h3-0-33" class="i">+        let bitcask =
</a><a href="#h3-0-34" id="h3-0-34" class="i">+            storage::BitCask::new(tempdir.path().join(&quot;bitcask&quot;)).expect(&quot;bitcask failed&quot;);
</a><a href="#h3-0-35" id="h3-0-35" class="i">+        let memory = storage::Memory::new();
</a><a href="#h3-0-36" id="h3-0-36" class="i">+        let engine = Local::new(Emit::new(Mirror::new(bitcask, memory), op_tx));
</a><a href="#h3-0-37" id="h3-0-37" class="i">+        let mut runner = SQLRunner::new(&amp;engine, op_rx);
</a><a href="#h3-0-38" id="h3-0-38" class="i">+
</a><a href="#h3-0-39" id="h3-0-39" class="i">+        goldenscript::run(&amp;mut runner, path).expect(&quot;goldenscript failed&quot;)
</a><a href="#h3-0-40" id="h3-0-40" class="i">+    }
</a><a href="#h3-0-41" id="h3-0-41" class="i">+
</a><a href="#h3-0-42" id="h3-0-42" class="i">+    fn test_goldenscript_expr(path: &amp;std::path::Path) {
</a>         goldenscript::run(&amp;mut ExpressionRunner::new(), path).expect(&quot;goldenscript failed&quot;)
     }
 
<a href="#h3-0-46" id="h3-0-46" class="i">+    /// A SQL test runner.
</a><a href="#h3-0-47" id="h3-0-47" class="i">+    struct SQLRunner&lt;&#39;a&gt; {
</a><a href="#h3-0-48" id="h3-0-48" class="i">+        engine: &amp;&#39;a TestEngine,
</a><a href="#h3-0-49" id="h3-0-49" class="i">+        session: Session&lt;&#39;a, TestEngine&gt;,
</a><a href="#h3-0-50" id="h3-0-50" class="i">+        op_rx: Receiver&lt;Operation&gt;,
</a><a href="#h3-0-51" id="h3-0-51" class="i">+    }
</a><a href="#h3-0-52" id="h3-0-52" class="i">+
</a><a href="#h3-0-53" id="h3-0-53" class="i">+    type TestEngine = Local&lt;Emit&lt;Mirror&lt;storage::BitCask, storage::Memory&gt;&gt;&gt;;
</a><a href="#h3-0-54" id="h3-0-54" class="i">+
</a><a href="#h3-0-55" id="h3-0-55" class="i">+    impl&lt;&#39;a&gt; SQLRunner&lt;&#39;a&gt; {
</a><a href="#h3-0-56" id="h3-0-56" class="i">+        fn new(engine: &amp;&#39;a TestEngine, op_rx: Receiver&lt;Operation&gt;) -&gt; Self {
</a><a href="#h3-0-57" id="h3-0-57" class="i">+            let session = engine.session();
</a><a href="#h3-0-58" id="h3-0-58" class="i">+            Self { engine, session, op_rx }
</a><a href="#h3-0-59" id="h3-0-59" class="i">+        }
</a><a href="#h3-0-60" id="h3-0-60" class="i">+    }
</a><a href="#h3-0-61" id="h3-0-61" class="i">+
</a><a href="#h3-0-62" id="h3-0-62" class="i">+    impl&lt;&#39;a&gt; goldenscript::Runner for SQLRunner&lt;&#39;a&gt; {
</a><a href="#h3-0-63" id="h3-0-63" class="i">+        fn run(&amp;mut self, command: &amp;goldenscript::Command) -&gt; Result&lt;String, Box&lt;dyn Error&gt;&gt; {
</a><a href="#h3-0-64" id="h3-0-64" class="i">+            let mut output = String::new();
</a><a href="#h3-0-65" id="h3-0-65" class="i">+
</a><a href="#h3-0-66" id="h3-0-66" class="i">+            // Handle runner commands.
</a><a href="#h3-0-67" id="h3-0-67" class="i">+            match command.name.as_str() {
</a><a href="#h3-0-68" id="h3-0-68" class="i">+                // dump
</a><a href="#h3-0-69" id="h3-0-69" class="i">+                &quot;dump&quot; =&gt; {
</a><a href="#h3-0-70" id="h3-0-70" class="i">+                    command.consume_args().reject_rest()?;
</a><a href="#h3-0-71" id="h3-0-71" class="i">+                    let mut engine = self.engine.mvcc.engine.lock().expect(&quot;mutex failed&quot;);
</a><a href="#h3-0-72" id="h3-0-72" class="i">+                    let mut iter = engine.scan(..);
</a><a href="#h3-0-73" id="h3-0-73" class="i">+                    while let Some((key, value)) = iter.next().transpose()? {
</a><a href="#h3-0-74" id="h3-0-74" class="i">+                        writeln!(
</a><a href="#h3-0-75" id="h3-0-75" class="i">+                            output,
</a><a href="#h3-0-76" id="h3-0-76" class="i">+                            &quot;{} [{}]&quot;,
</a><a href="#h3-0-77" id="h3-0-77" class="i">+                            format::MVCC::&lt;format::SQL&gt;::key_value(&amp;key, &amp;value),
</a><a href="#h3-0-78" id="h3-0-78" class="i">+                            format::Raw::key_value(&amp;key, &amp;value)
</a><a href="#h3-0-79" id="h3-0-79" class="i">+                        )?;
</a><a href="#h3-0-80" id="h3-0-80" class="i">+                    }
</a><a href="#h3-0-81" id="h3-0-81" class="i">+                    return Ok(output);
</a><a href="#h3-0-82" id="h3-0-82" class="i">+                }
</a><a href="#h3-0-83" id="h3-0-83" class="i">+
</a><a href="#h3-0-84" id="h3-0-84" class="i">+                // schema [TABLE...]
</a><a href="#h3-0-85" id="h3-0-85" class="i">+                &quot;schema&quot; =&gt; {
</a><a href="#h3-0-86" id="h3-0-86" class="i">+                    let mut args = command.consume_args();
</a><a href="#h3-0-87" id="h3-0-87" class="i">+                    let tables = args.rest_pos().iter().map(|arg| arg.value.clone()).collect_vec();
</a><a href="#h3-0-88" id="h3-0-88" class="i">+                    args.reject_rest()?;
</a><a href="#h3-0-89" id="h3-0-89" class="i">+
</a><a href="#h3-0-90" id="h3-0-90" class="i">+                    let schemas = if tables.is_empty() {
</a><a href="#h3-0-91" id="h3-0-91" class="i">+                        self.session.with_txn(true, |txn| txn.list_tables())?
</a><a href="#h3-0-92" id="h3-0-92" class="i">+                    } else {
</a><a href="#h3-0-93" id="h3-0-93" class="i">+                        tables
</a><a href="#h3-0-94" id="h3-0-94" class="i">+                            .into_iter()
</a><a href="#h3-0-95" id="h3-0-95" class="i">+                            .map(|t| self.session.with_txn(true, |txn| txn.must_get_table(&amp;t)))
</a><a href="#h3-0-96" id="h3-0-96" class="i">+                            .collect::&lt;Result&lt;_, _&gt;&gt;()?
</a><a href="#h3-0-97" id="h3-0-97" class="i">+                    };
</a><a href="#h3-0-98" id="h3-0-98" class="i">+                    return Ok(schemas.into_iter().map(|s| s.to_string()).join(&quot;\n&quot;));
</a><a href="#h3-0-99" id="h3-0-99" class="i">+                }
</a><a href="#h3-0-100" id="h3-0-100" class="i">+
</a><a href="#h3-0-101" id="h3-0-101" class="i">+                // Otherwise, fall through to SQL execution.
</a><a href="#h3-0-102" id="h3-0-102" class="i">+                _ =&gt; {}
</a><a href="#h3-0-103" id="h3-0-103" class="i">+            }
</a><a href="#h3-0-104" id="h3-0-104" class="i">+
</a><a href="#h3-0-105" id="h3-0-105" class="i">+            // The entire command is the statement to execute. There are no args.
</a><a href="#h3-0-106" id="h3-0-106" class="i">+            if !command.args.is_empty() {
</a><a href="#h3-0-107" id="h3-0-107" class="i">+                return Err(&quot;expressions should be given as a command with no args&quot;.into());
</a><a href="#h3-0-108" id="h3-0-108" class="i">+            }
</a><a href="#h3-0-109" id="h3-0-109" class="i">+            let input = &amp;command.name;
</a><a href="#h3-0-110" id="h3-0-110" class="i">+            let mut tags = command.tags.clone();
</a><a href="#h3-0-111" id="h3-0-111" class="i">+
</a><a href="#h3-0-112" id="h3-0-112" class="i">+            // Execute the statement.
</a><a href="#h3-0-113" id="h3-0-113" class="i">+            let result = self.session.execute(input)?;
</a><a href="#h3-0-114" id="h3-0-114" class="i">+
</a><a href="#h3-0-115" id="h3-0-115" class="i">+            // Output the plan if requested.
</a><a href="#h3-0-116" id="h3-0-116" class="i">+            if tags.remove(&quot;plan&quot;) {
</a><a href="#h3-0-117" id="h3-0-117" class="i">+                let query = format!(&quot;EXPLAIN {input}&quot;);
</a><a href="#h3-0-118" id="h3-0-118" class="i">+                let StatementResult::Explain(plan) = self.session.execute(&amp;query)? else {
</a><a href="#h3-0-119" id="h3-0-119" class="i">+                    return Err(&quot;unexpected explain response&quot;.into());
</a><a href="#h3-0-120" id="h3-0-120" class="i">+                };
</a><a href="#h3-0-121" id="h3-0-121" class="i">+                writeln!(output, &quot;{plan}&quot;)?;
</a><a href="#h3-0-122" id="h3-0-122" class="i">+            }
</a><a href="#h3-0-123" id="h3-0-123" class="i">+
</a><a href="#h3-0-124" id="h3-0-124" class="i">+            // Output the result if requested.
</a><a href="#h3-0-125" id="h3-0-125" class="i">+            if tags.remove(&quot;result&quot;) {
</a><a href="#h3-0-126" id="h3-0-126" class="i">+                writeln!(output, &quot;{result:?}&quot;)?;
</a><a href="#h3-0-127" id="h3-0-127" class="i">+            }
</a><a href="#h3-0-128" id="h3-0-128" class="i">+
</a><a href="#h3-0-129" id="h3-0-129" class="i">+            // Output engine ops if requested.
</a><a href="#h3-0-130" id="h3-0-130" class="i">+            if tags.remove(&quot;ops&quot;) {
</a><a href="#h3-0-131" id="h3-0-131" class="i">+                while let Ok(op) = self.op_rx.try_recv() {
</a><a href="#h3-0-132" id="h3-0-132" class="i">+                    match op {
</a><a href="#h3-0-133" id="h3-0-133" class="i">+                        Operation::Delete { key } =&gt; writeln!(
</a><a href="#h3-0-134" id="h3-0-134" class="i">+                            output,
</a><a href="#h3-0-135" id="h3-0-135" class="i">+                            &quot;storage delete {} [{}]&quot;,
</a><a href="#h3-0-136" id="h3-0-136" class="i">+                            format::MVCC::&lt;format::SQL&gt;::key(&amp;key),
</a><a href="#h3-0-137" id="h3-0-137" class="i">+                            format::Raw::key(&amp;key),
</a><a href="#h3-0-138" id="h3-0-138" class="i">+                        )?,
</a><a href="#h3-0-139" id="h3-0-139" class="i">+                        Operation::Flush =&gt; writeln!(output, &quot;storage flush&quot;)?,
</a><a href="#h3-0-140" id="h3-0-140" class="i">+                        Operation::Set { key, value } =&gt; writeln!(
</a><a href="#h3-0-141" id="h3-0-141" class="i">+                            output,
</a><a href="#h3-0-142" id="h3-0-142" class="i">+                            &quot;storage set {} [{}]&quot;,
</a><a href="#h3-0-143" id="h3-0-143" class="i">+                            format::MVCC::&lt;format::SQL&gt;::key_value(&amp;key, &amp;value),
</a><a href="#h3-0-144" id="h3-0-144" class="i">+                            format::Raw::key_value(&amp;key, &amp;value),
</a><a href="#h3-0-145" id="h3-0-145" class="i">+                        )?,
</a><a href="#h3-0-146" id="h3-0-146" class="i">+                    }
</a><a href="#h3-0-147" id="h3-0-147" class="i">+                }
</a><a href="#h3-0-148" id="h3-0-148" class="i">+            }
</a><a href="#h3-0-149" id="h3-0-149" class="i">+
</a><a href="#h3-0-150" id="h3-0-150" class="i">+            // Reject unknown tags.
</a><a href="#h3-0-151" id="h3-0-151" class="i">+            if let Some(tag) = tags.iter().next() {
</a><a href="#h3-0-152" id="h3-0-152" class="i">+                return Err(format!(&quot;unknown tag {tag}&quot;).into());
</a><a href="#h3-0-153" id="h3-0-153" class="i">+            }
</a><a href="#h3-0-154" id="h3-0-154" class="i">+
</a><a href="#h3-0-155" id="h3-0-155" class="i">+            Ok(output)
</a><a href="#h3-0-156" id="h3-0-156" class="i">+        }
</a><a href="#h3-0-157" id="h3-0-157" class="i">+
</a><a href="#h3-0-158" id="h3-0-158" class="i">+        /// Drain unprocessed operations after each command.
</a><a href="#h3-0-159" id="h3-0-159" class="i">+        fn end_command(&amp;mut self, _: &amp;goldenscript::Command) -&gt; Result&lt;String, Box&lt;dyn Error&gt;&gt; {
</a><a href="#h3-0-160" id="h3-0-160" class="i">+            while self.op_rx.try_recv().is_ok() {}
</a><a href="#h3-0-161" id="h3-0-161" class="i">+            Ok(String::new())
</a><a href="#h3-0-162" id="h3-0-162" class="i">+        }
</a><a href="#h3-0-163" id="h3-0-163" class="i">+    }
</a><a href="#h3-0-164" id="h3-0-164" class="i">+
</a><a href="#h3-0-165" id="h3-0-165" class="i">+    /// A test runner for expressions specifically. Evaluates expressions to
</a><a href="#h3-0-166" id="h3-0-166" class="i">+    /// values, and can optionally emit the expression tree.
</a>     struct ExpressionRunner {
         engine: Local&lt;storage::Memory&gt;,
     }
<b>diff --git a/<a id="h4" href="../file/src/sql/testscripts/schema/create_table.html">src/sql/testscripts/schema/create_table</a> b/<a href="../file/src/sql/testscripts/schema/create_table.html">src/sql/testscripts/schema/create_table</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -0,0 +1,45 @@
</a><a href="#h4-0-0" id="h4-0-0" class="i">+# Tests basic CREATE TABLE functionality.
</a><a href="#h4-0-1" id="h4-0-1" class="i">+
</a><a href="#h4-0-2" id="h4-0-2" class="i">+# The result contains the table name. The table is written to storage. Also
</a><a href="#h4-0-3" id="h4-0-3" class="i">+# output the plan, which is trivial.
</a><a href="#h4-0-4" id="h4-0-4" class="i">+[plan,result,ops]&gt; CREATE TABLE test (id INTEGER PRIMARY KEY)
</a><a href="#h4-0-5" id="h4-0-5" class="i">+---
</a><a href="#h4-0-6" id="h4-0-6" class="i">+CreateTable: test
</a><a href="#h4-0-7" id="h4-0-7" class="i">+CreateTable { name: &quot;test&quot; }
</a><a href="#h4-0-8" id="h4-0-8" class="i">+storage set mvcc:NextVersion → 2 [&quot;\x00&quot; → &quot;\x02&quot;]
</a><a href="#h4-0-9" id="h4-0-9" class="i">+storage set mvcc:TxnActive(1) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;&quot;]
</a><a href="#h4-0-10" id="h4-0-10" class="i">+storage set mvcc:TxnWrite(1, sql:Table(&quot;test&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xfftest\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h4-0-11" id="h4-0-11" class="i">+storage set mvcc:Version(sql:Table(&quot;test&quot;), 1) → CREATE TABLE test ( id INTEGER PRIMARY KEY ) [&quot;\x04\x00\xfftest\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x10\x04test\x00\x01\x02id\x01\x00\x00\x01\x00\x00&quot;]
</a><a href="#h4-0-12" id="h4-0-12" class="i">+storage delete mvcc:TxnWrite(1, sql:Table(&quot;test&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xfftest\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h4-0-13" id="h4-0-13" class="i">+storage delete mvcc:TxnActive(1) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x01&quot;]
</a><a href="#h4-0-14" id="h4-0-14" class="i">+
</a><a href="#h4-0-15" id="h4-0-15" class="i">+dump
</a><a href="#h4-0-16" id="h4-0-16" class="i">+---
</a><a href="#h4-0-17" id="h4-0-17" class="i">+mvcc:NextVersion → 2 [&quot;\x00&quot; → &quot;\x02&quot;]
</a><a href="#h4-0-18" id="h4-0-18" class="i">+mvcc:Version(sql:Table(&quot;test&quot;), 1) → CREATE TABLE test ( id INTEGER PRIMARY KEY ) [&quot;\x04\x00\xfftest\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x10\x04test\x00\x01\x02id\x01\x00\x00\x01\x00\x00&quot;]
</a><a href="#h4-0-19" id="h4-0-19" class="i">+
</a><a href="#h4-0-20" id="h4-0-20" class="i">+# Errors if table already exists.
</a><a href="#h4-0-21" id="h4-0-21" class="i">+!&gt; CREATE TABLE test (id INTEGER PRIMARY KEY)
</a><a href="#h4-0-22" id="h4-0-22" class="i">+---
</a><a href="#h4-0-23" id="h4-0-23" class="i">+Error: invalid input: table test already exists
</a><a href="#h4-0-24" id="h4-0-24" class="i">+
</a><a href="#h4-0-25" id="h4-0-25" class="i">+# No table name or columns errors.
</a><a href="#h4-0-26" id="h4-0-26" class="i">+!&gt; CREATE TABLE
</a><a href="#h4-0-27" id="h4-0-27" class="i">+!&gt; CREATE TABLE name
</a><a href="#h4-0-28" id="h4-0-28" class="i">+!&gt; CREATE TABLE name ()
</a><a href="#h4-0-29" id="h4-0-29" class="i">+---
</a><a href="#h4-0-30" id="h4-0-30" class="i">+Error: invalid input: unexpected end of input
</a><a href="#h4-0-31" id="h4-0-31" class="i">+Error: invalid input: unexpected end of input
</a><a href="#h4-0-32" id="h4-0-32" class="i">+Error: invalid input: expected identifier, got )
</a><a href="#h4-0-33" id="h4-0-33" class="i">+
</a><a href="#h4-0-34" id="h4-0-34" class="i">+# Missing table or column names error.
</a><a href="#h4-0-35" id="h4-0-35" class="i">+!&gt; CREATE TABLE (id INTEGER PRIMARY KEY)
</a><a href="#h4-0-36" id="h4-0-36" class="i">+!&gt; CREATE TABLE name (INTEGER PRIMARY KEY)
</a><a href="#h4-0-37" id="h4-0-37" class="i">+---
</a><a href="#h4-0-38" id="h4-0-38" class="i">+Error: invalid input: expected identifier, got (
</a><a href="#h4-0-39" id="h4-0-39" class="i">+Error: invalid input: expected identifier, got INTEGER
</a><a href="#h4-0-40" id="h4-0-40" class="i">+
</a><a href="#h4-0-41" id="h4-0-41" class="i">+# Unterminated identifier errors.
</a><a href="#h4-0-42" id="h4-0-42" class="i">+!&gt; CREATE TABLE &quot;name (id INTEGER PRIMARY KEY)
</a><a href="#h4-0-43" id="h4-0-43" class="i">+---
</a><a href="#h4-0-44" id="h4-0-44" class="i">+Error: invalid input: unexpected end of quoted identifier
</a><b>diff --git a/<a id="h5" href="../file/src/sql/testscripts/schema/create_table_datatypes.html">src/sql/testscripts/schema/create_table_datatypes</a> b/<a href="../file/src/sql/testscripts/schema/create_table_datatypes.html">src/sql/testscripts/schema/create_table_datatypes</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -0,0 +1,38 @@
</a><a href="#h5-0-0" id="h5-0-0" class="i">+# Tests CREATE TABLE datatypes.
</a><a href="#h5-0-1" id="h5-0-1" class="i">+
</a><a href="#h5-0-2" id="h5-0-2" class="i">+# Create columns with all datatypes.
</a><a href="#h5-0-3" id="h5-0-3" class="i">+&gt; CREATE TABLE datatypes ( \
</a><a href="#h5-0-4" id="h5-0-4" class="i">+    id INTEGER PRIMARY KEY, \
</a><a href="#h5-0-5" id="h5-0-5" class="i">+    &quot;bool&quot; BOOL, \
</a><a href="#h5-0-6" id="h5-0-6" class="i">+    &quot;boolean&quot; BOOLEAN, \
</a><a href="#h5-0-7" id="h5-0-7" class="i">+    &quot;double&quot; DOUBLE, \
</a><a href="#h5-0-8" id="h5-0-8" class="i">+    &quot;float&quot; FLOAT, \
</a><a href="#h5-0-9" id="h5-0-9" class="i">+    &quot;int&quot; INT, \
</a><a href="#h5-0-10" id="h5-0-10" class="i">+    &quot;integer&quot; INTEGER, \
</a><a href="#h5-0-11" id="h5-0-11" class="i">+    &quot;string&quot; STRING, \
</a><a href="#h5-0-12" id="h5-0-12" class="i">+    &quot;text&quot; TEXT, \
</a><a href="#h5-0-13" id="h5-0-13" class="i">+    &quot;varchar&quot; VARCHAR \
</a><a href="#h5-0-14" id="h5-0-14" class="i">+)
</a><a href="#h5-0-15" id="h5-0-15" class="i">+schema
</a><a href="#h5-0-16" id="h5-0-16" class="i">+---
</a><a href="#h5-0-17" id="h5-0-17" class="i">+CREATE TABLE datatypes (
</a><a href="#h5-0-18" id="h5-0-18" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h5-0-19" id="h5-0-19" class="i">+  &quot;bool&quot; BOOLEAN DEFAULT NULL,
</a><a href="#h5-0-20" id="h5-0-20" class="i">+  &quot;boolean&quot; BOOLEAN DEFAULT NULL,
</a><a href="#h5-0-21" id="h5-0-21" class="i">+  &quot;double&quot; FLOAT DEFAULT NULL,
</a><a href="#h5-0-22" id="h5-0-22" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL,
</a><a href="#h5-0-23" id="h5-0-23" class="i">+  &quot;int&quot; INTEGER DEFAULT NULL,
</a><a href="#h5-0-24" id="h5-0-24" class="i">+  &quot;integer&quot; INTEGER DEFAULT NULL,
</a><a href="#h5-0-25" id="h5-0-25" class="i">+  &quot;string&quot; STRING DEFAULT NULL,
</a><a href="#h5-0-26" id="h5-0-26" class="i">+  &quot;text&quot; STRING DEFAULT NULL,
</a><a href="#h5-0-27" id="h5-0-27" class="i">+  &quot;varchar&quot; STRING DEFAULT NULL
</a><a href="#h5-0-28" id="h5-0-28" class="i">+)
</a><a href="#h5-0-29" id="h5-0-29" class="i">+
</a><a href="#h5-0-30" id="h5-0-30" class="i">+# Missing or unknown datatype errors.
</a><a href="#h5-0-31" id="h5-0-31" class="i">+!&gt; CREATE TABLE test (id INTEGER PRIMARY KEY, value)
</a><a href="#h5-0-32" id="h5-0-32" class="i">+!&gt; CREATE TABLE test (id INTEGER PRIMARY KEY, value FOO)
</a><a href="#h5-0-33" id="h5-0-33" class="i">+!&gt; CREATE TABLE test (id INTEGER PRIMARY KEY, value INDEX)
</a><a href="#h5-0-34" id="h5-0-34" class="i">+---
</a><a href="#h5-0-35" id="h5-0-35" class="i">+Error: invalid input: unexpected token )
</a><a href="#h5-0-36" id="h5-0-36" class="i">+Error: invalid input: unexpected token foo
</a><a href="#h5-0-37" id="h5-0-37" class="i">+Error: invalid input: unexpected token INDEX
</a><b>diff --git a/<a id="h6" href="../file/src/sql/testscripts/schema/create_table_default.html">src/sql/testscripts/schema/create_table_default</a> b/<a href="../file/src/sql/testscripts/schema/create_table_default.html">src/sql/testscripts/schema/create_table_default</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -0,0 +1,54 @@
</a><a href="#h6-0-0" id="h6-0-0" class="i">+# Tests column defaults.
</a><a href="#h6-0-1" id="h6-0-1" class="i">+
</a><a href="#h6-0-2" id="h6-0-2" class="i">+# All datatypes.
</a><a href="#h6-0-3" id="h6-0-3" class="i">+&gt; CREATE TABLE datatypes ( \
</a><a href="#h6-0-4" id="h6-0-4" class="i">+    id INT PRIMARY KEY, \
</a><a href="#h6-0-5" id="h6-0-5" class="i">+    &quot;bool&quot; BOOLEAN DEFAULT true, \
</a><a href="#h6-0-6" id="h6-0-6" class="i">+    &quot;float&quot; FLOAT DEFAULT 3.14, \
</a><a href="#h6-0-7" id="h6-0-7" class="i">+    &quot;int&quot; INTEGER DEFAULT 7, \
</a><a href="#h6-0-8" id="h6-0-8" class="i">+    &quot;string&quot; STRING DEFAULT &#39;foo&#39; \
</a><a href="#h6-0-9" id="h6-0-9" class="i">+)
</a><a href="#h6-0-10" id="h6-0-10" class="i">+schema datatypes
</a><a href="#h6-0-11" id="h6-0-11" class="i">+---
</a><a href="#h6-0-12" id="h6-0-12" class="i">+CREATE TABLE datatypes (
</a><a href="#h6-0-13" id="h6-0-13" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h6-0-14" id="h6-0-14" class="i">+  &quot;bool&quot; BOOLEAN DEFAULT TRUE,
</a><a href="#h6-0-15" id="h6-0-15" class="i">+  &quot;float&quot; FLOAT DEFAULT 3.14,
</a><a href="#h6-0-16" id="h6-0-16" class="i">+  &quot;int&quot; INTEGER DEFAULT 7,
</a><a href="#h6-0-17" id="h6-0-17" class="i">+  &quot;string&quot; STRING DEFAULT foo
</a><a href="#h6-0-18" id="h6-0-18" class="i">+)
</a><a href="#h6-0-19" id="h6-0-19" class="i">+
</a><a href="#h6-0-20" id="h6-0-20" class="i">+# Default datatypes must match column. This includes float/integer types.
</a><a href="#h6-0-21" id="h6-0-21" class="i">+!&gt; CREATE TABLE name (id INT PRIMARY KEY, value STRING DEFAULT 7)
</a><a href="#h6-0-22" id="h6-0-22" class="i">+!&gt; CREATE TABLE name (id INT PRIMARY KEY, value INTEGER DEFAULT 3.14)
</a><a href="#h6-0-23" id="h6-0-23" class="i">+!&gt; CREATE TABLE name (id INT PRIMARY KEY, value FLOAT DEFAULT 7)
</a><a href="#h6-0-24" id="h6-0-24" class="i">+---
</a><a href="#h6-0-25" id="h6-0-25" class="i">+Error: invalid input: invalid datatype INTEGER for STRING column value
</a><a href="#h6-0-26" id="h6-0-26" class="i">+Error: invalid input: invalid datatype FLOAT for INTEGER column value
</a><a href="#h6-0-27" id="h6-0-27" class="i">+Error: invalid input: invalid datatype INTEGER for FLOAT column value
</a><a href="#h6-0-28" id="h6-0-28" class="i">+
</a><a href="#h6-0-29" id="h6-0-29" class="i">+# Default values can be expressions.
</a><a href="#h6-0-30" id="h6-0-30" class="i">+&gt; CREATE TABLE expr (id INT PRIMARY KEY, value INT DEFAULT 7 + 3 * 2)
</a><a href="#h6-0-31" id="h6-0-31" class="i">+schema expr
</a><a href="#h6-0-32" id="h6-0-32" class="i">+---
</a><a href="#h6-0-33" id="h6-0-33" class="i">+CREATE TABLE expr (
</a><a href="#h6-0-34" id="h6-0-34" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h6-0-35" id="h6-0-35" class="i">+  value INTEGER DEFAULT 13
</a><a href="#h6-0-36" id="h6-0-36" class="i">+)
</a><a href="#h6-0-37" id="h6-0-37" class="i">+
</a><a href="#h6-0-38" id="h6-0-38" class="i">+# NULL is a value default for a nullable column (and is the implicit default).
</a><a href="#h6-0-39" id="h6-0-39" class="i">+&gt; CREATE TABLE &quot;nullable&quot; (id INT PRIMARY KEY, value STRING DEFAULT NULL, implicit STRING)
</a><a href="#h6-0-40" id="h6-0-40" class="i">+schema nullable
</a><a href="#h6-0-41" id="h6-0-41" class="i">+---
</a><a href="#h6-0-42" id="h6-0-42" class="i">+CREATE TABLE nullable (
</a><a href="#h6-0-43" id="h6-0-43" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h6-0-44" id="h6-0-44" class="i">+  value STRING DEFAULT NULL,
</a><a href="#h6-0-45" id="h6-0-45" class="i">+  implicit STRING DEFAULT NULL
</a><a href="#h6-0-46" id="h6-0-46" class="i">+)
</a><a href="#h6-0-47" id="h6-0-47" class="i">+
</a><a href="#h6-0-48" id="h6-0-48" class="i">+# A NULL default errors for a non-nullable column, including primary keys.
</a><a href="#h6-0-49" id="h6-0-49" class="i">+!&gt; CREATE TABLE name (id INT PRIMARY KEY DEFAULT NULL)
</a><a href="#h6-0-50" id="h6-0-50" class="i">+!&gt; CREATE TABLE name (id INT PRIMARY KEY, value STRING NOT NULL DEFAULT NULL)
</a><a href="#h6-0-51" id="h6-0-51" class="i">+---
</a><a href="#h6-0-52" id="h6-0-52" class="i">+Error: invalid input: invalid NULL default for non-nullable column id
</a><a href="#h6-0-53" id="h6-0-53" class="i">+Error: invalid input: invalid NULL default for non-nullable column value
</a><b>diff --git a/<a id="h7" href="../file/src/sql/testscripts/schema/create_table_index.html">src/sql/testscripts/schema/create_table_index</a> b/<a href="../file/src/sql/testscripts/schema/create_table_index.html">src/sql/testscripts/schema/create_table_index</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -0,0 +1,32 @@
</a><a href="#h7-0-0" id="h7-0-0" class="i">+# Creating a table with an index only results in a single schema entry (no
</a><a href="#h7-0-1" id="h7-0-1" class="i">+# separate index).
</a><a href="#h7-0-2" id="h7-0-2" class="i">+[ops]&gt; CREATE TABLE indexed (id INTEGER PRIMARY KEY, &quot;index&quot; INTEGER INDEX)
</a><a href="#h7-0-3" id="h7-0-3" class="i">+---
</a><a href="#h7-0-4" id="h7-0-4" class="i">+storage set mvcc:NextVersion → 2 [&quot;\x00&quot; → &quot;\x02&quot;]
</a><a href="#h7-0-5" id="h7-0-5" class="i">+storage set mvcc:TxnActive(1) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;&quot;]
</a><a href="#h7-0-6" id="h7-0-6" class="i">+storage set mvcc:TxnWrite(1, sql:Table(&quot;indexed&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xffindexed\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h7-0-7" id="h7-0-7" class="i">+storage set mvcc:Version(sql:Table(&quot;indexed&quot;), 1) → CREATE TABLE indexed ( id INTEGER PRIMARY KEY, &quot;index&quot; INTEGER DEFAULT NULL INDEX ) [&quot;\x04\x00\xffindexed\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01 \x07indexed\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05index\x01\x01\x01\x00\x00\x01\x00&quot;]
</a><a href="#h7-0-8" id="h7-0-8" class="i">+storage delete mvcc:TxnWrite(1, sql:Table(&quot;indexed&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xffindexed\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h7-0-9" id="h7-0-9" class="i">+storage delete mvcc:TxnActive(1) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x01&quot;]
</a><a href="#h7-0-10" id="h7-0-10" class="i">+
</a><a href="#h7-0-11" id="h7-0-11" class="i">+schema
</a><a href="#h7-0-12" id="h7-0-12" class="i">+---
</a><a href="#h7-0-13" id="h7-0-13" class="i">+CREATE TABLE indexed (
</a><a href="#h7-0-14" id="h7-0-14" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h7-0-15" id="h7-0-15" class="i">+  &quot;index&quot; INTEGER DEFAULT NULL INDEX
</a><a href="#h7-0-16" id="h7-0-16" class="i">+)
</a><a href="#h7-0-17" id="h7-0-17" class="i">+
</a><a href="#h7-0-18" id="h7-0-18" class="i">+# Explicit indexes can be given for primary keys, foreign keys,
</a><a href="#h7-0-19" id="h7-0-19" class="i">+# and unique columns.
</a><a href="#h7-0-20" id="h7-0-20" class="i">+&gt; CREATE TABLE explicit ( \
</a><a href="#h7-0-21" id="h7-0-21" class="i">+    id INTEGER PRIMARY KEY INDEX, \
</a><a href="#h7-0-22" id="h7-0-22" class="i">+    &quot;unique&quot; INTEGER UNIQUE INDEX, \
</a><a href="#h7-0-23" id="h7-0-23" class="i">+    &quot;reference&quot; INTEGER REFERENCES indexed INDEX \
</a><a href="#h7-0-24" id="h7-0-24" class="i">+)
</a><a href="#h7-0-25" id="h7-0-25" class="i">+schema explicit
</a><a href="#h7-0-26" id="h7-0-26" class="i">+---
</a><a href="#h7-0-27" id="h7-0-27" class="i">+CREATE TABLE explicit (
</a><a href="#h7-0-28" id="h7-0-28" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h7-0-29" id="h7-0-29" class="i">+  &quot;unique&quot; INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h7-0-30" id="h7-0-30" class="i">+  reference INTEGER DEFAULT NULL INDEX REFERENCES indexed
</a><a href="#h7-0-31" id="h7-0-31" class="i">+)
</a><b>diff --git a/<a id="h8" href="../file/src/sql/testscripts/schema/create_table_names.html">src/sql/testscripts/schema/create_table_names</a> b/<a href="../file/src/sql/testscripts/schema/create_table_names.html">src/sql/testscripts/schema/create_table_names</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -0,0 +1,72 @@
</a><a href="#h8-0-0" id="h8-0-0" class="i">+# Tests CREATE TABLE table and column name validation.
</a><a href="#h8-0-1" id="h8-0-1" class="i">+
</a><a href="#h8-0-2" id="h8-0-2" class="i">+# A couple of valid names.
</a><a href="#h8-0-3" id="h8-0-3" class="i">+&gt; CREATE TABLE a_123 (a_123 INTEGER PRIMARY KEY)
</a><a href="#h8-0-4" id="h8-0-4" class="i">+&gt; CREATE TABLE 表 (身元 INTEGER PRIMARY KEY, 名前 STRING)
</a><a href="#h8-0-5" id="h8-0-5" class="i">+schema
</a><a href="#h8-0-6" id="h8-0-6" class="i">+---
</a><a href="#h8-0-7" id="h8-0-7" class="i">+CREATE TABLE a_123 (
</a><a href="#h8-0-8" id="h8-0-8" class="i">+  a_123 INTEGER PRIMARY KEY
</a><a href="#h8-0-9" id="h8-0-9" class="i">+)
</a><a href="#h8-0-10" id="h8-0-10" class="i">+CREATE TABLE 表 (
</a><a href="#h8-0-11" id="h8-0-11" class="i">+  身元 INTEGER PRIMARY KEY,
</a><a href="#h8-0-12" id="h8-0-12" class="i">+  名前 STRING DEFAULT NULL
</a><a href="#h8-0-13" id="h8-0-13" class="i">+)
</a><a href="#h8-0-14" id="h8-0-14" class="i">+
</a><a href="#h8-0-15" id="h8-0-15" class="i">+# Mixed case is valid, but interpreted as lower case. Quoted identifiers retain
</a><a href="#h8-0-16" id="h8-0-16" class="i">+# their case.
</a><a href="#h8-0-17" id="h8-0-17" class="i">+&gt; CREATE TABLE mIxEd_cAsE (ÄÅÆ STRING PRIMARY KEY)
</a><a href="#h8-0-18" id="h8-0-18" class="i">+&gt; CREATE TABLE &quot;mIxEd_cAsE&quot; (&quot;ÄÅÆ&quot; STRING PRIMARY KEY)
</a><a href="#h8-0-19" id="h8-0-19" class="i">+schema mixed_case
</a><a href="#h8-0-20" id="h8-0-20" class="i">+schema mIxEd_cAsE
</a><a href="#h8-0-21" id="h8-0-21" class="i">+---
</a><a href="#h8-0-22" id="h8-0-22" class="i">+CREATE TABLE mixed_case (
</a><a href="#h8-0-23" id="h8-0-23" class="i">+  äåæ STRING PRIMARY KEY
</a><a href="#h8-0-24" id="h8-0-24" class="i">+)
</a><a href="#h8-0-25" id="h8-0-25" class="i">+CREATE TABLE mIxEd_cAsE (
</a><a href="#h8-0-26" id="h8-0-26" class="i">+  ÄÅÆ STRING PRIMARY KEY
</a><a href="#h8-0-27" id="h8-0-27" class="i">+)
</a><a href="#h8-0-28" id="h8-0-28" class="i">+
</a><a href="#h8-0-29" id="h8-0-29" class="i">+# Unquoted _, number, keyword, and emoji errors.
</a><a href="#h8-0-30" id="h8-0-30" class="i">+!&gt; CREATE TABLE _name (id INTEGER PRIMARY KEY)
</a><a href="#h8-0-31" id="h8-0-31" class="i">+!&gt; CREATE TABLE 123 (1 INTEGER PRIMARY KEY)
</a><a href="#h8-0-32" id="h8-0-32" class="i">+!&gt; CREATE TABLE table (primary INTEGER PRIMARY KEY)
</a><a href="#h8-0-33" id="h8-0-33" class="i">+!&gt; CREATE TABLE 👋 (🆔 INTEGER PRIMARY KEY)
</a><a href="#h8-0-34" id="h8-0-34" class="i">+---
</a><a href="#h8-0-35" id="h8-0-35" class="i">+Error: invalid input: unexpected character _
</a><a href="#h8-0-36" id="h8-0-36" class="i">+Error: invalid input: expected identifier, got 123
</a><a href="#h8-0-37" id="h8-0-37" class="i">+Error: invalid input: expected identifier, got TABLE
</a><a href="#h8-0-38" id="h8-0-38" class="i">+Error: invalid input: unexpected character 👋
</a><a href="#h8-0-39" id="h8-0-39" class="i">+
</a><a href="#h8-0-40" id="h8-0-40" class="i">+# Double quotes allow them.
</a><a href="#h8-0-41" id="h8-0-41" class="i">+&gt; CREATE TABLE &quot;_name&quot; (id INTEGER PRIMARY KEY)
</a><a href="#h8-0-42" id="h8-0-42" class="i">+&gt; CREATE TABLE &quot;123&quot; (&quot;1&quot; INTEGER PRIMARY KEY)
</a><a href="#h8-0-43" id="h8-0-43" class="i">+&gt; CREATE TABLE &quot;table&quot; (&quot;primary&quot; INTEGER PRIMARY KEY)
</a><a href="#h8-0-44" id="h8-0-44" class="i">+&gt; CREATE TABLE &quot;👋&quot; (&quot;🆔&quot; INTEGER PRIMARY KEY)
</a><a href="#h8-0-45" id="h8-0-45" class="i">+schema _name 123 table &quot;👋&quot;
</a><a href="#h8-0-46" id="h8-0-46" class="i">+---
</a><a href="#h8-0-47" id="h8-0-47" class="i">+CREATE TABLE &quot;_name&quot; (
</a><a href="#h8-0-48" id="h8-0-48" class="i">+  id INTEGER PRIMARY KEY
</a><a href="#h8-0-49" id="h8-0-49" class="i">+)
</a><a href="#h8-0-50" id="h8-0-50" class="i">+CREATE TABLE &quot;123&quot; (
</a><a href="#h8-0-51" id="h8-0-51" class="i">+  &quot;1&quot; INTEGER PRIMARY KEY
</a><a href="#h8-0-52" id="h8-0-52" class="i">+)
</a><a href="#h8-0-53" id="h8-0-53" class="i">+CREATE TABLE &quot;table&quot; (
</a><a href="#h8-0-54" id="h8-0-54" class="i">+  &quot;primary&quot; INTEGER PRIMARY KEY
</a><a href="#h8-0-55" id="h8-0-55" class="i">+)
</a><a href="#h8-0-56" id="h8-0-56" class="i">+CREATE TABLE &quot;👋&quot; (
</a><a href="#h8-0-57" id="h8-0-57" class="i">+  &quot;🆔&quot; INTEGER PRIMARY KEY
</a><a href="#h8-0-58" id="h8-0-58" class="i">+)
</a><a href="#h8-0-59" id="h8-0-59" class="i">+
</a><a href="#h8-0-60" id="h8-0-60" class="i">+# &quot;&quot; escapes &quot; in identifiers.
</a><a href="#h8-0-61" id="h8-0-61" class="i">+&gt; CREATE TABLE &quot;name with &quot;&quot;quotes&quot;&quot;&quot; (id INTEGER PRIMARY KEY);
</a><a href="#h8-0-62" id="h8-0-62" class="i">+schema &#39;name with &quot;quotes&quot;&#39;
</a><a href="#h8-0-63" id="h8-0-63" class="i">+---
</a><a href="#h8-0-64" id="h8-0-64" class="i">+CREATE TABLE &quot;name with &quot;&quot;quotes&quot;&quot;&quot; (
</a><a href="#h8-0-65" id="h8-0-65" class="i">+  id INTEGER PRIMARY KEY
</a><a href="#h8-0-66" id="h8-0-66" class="i">+)
</a><a href="#h8-0-67" id="h8-0-67" class="i">+
</a><a href="#h8-0-68" id="h8-0-68" class="i">+# &#39; are for string literals, not identifiers.
</a><a href="#h8-0-69" id="h8-0-69" class="i">+!&gt; CREATE TABLE &#39;name&#39; (id INTEGER PRIMARY KEY)
</a><a href="#h8-0-70" id="h8-0-70" class="i">+---
</a><a href="#h8-0-71" id="h8-0-71" class="i">+Error: invalid input: expected identifier, got name
</a><b>diff --git a/<a id="h9" href="../file/src/sql/testscripts/schema/create_table_null.html">src/sql/testscripts/schema/create_table_null</a> b/<a href="../file/src/sql/testscripts/schema/create_table_null.html">src/sql/testscripts/schema/create_table_null</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -0,0 +1,33 @@
</a><a href="#h9-0-0" id="h9-0-0" class="i">+# Tests column nullability.
</a><a href="#h9-0-1" id="h9-0-1" class="i">+
</a><a href="#h9-0-2" id="h9-0-2" class="i">+# All datatypes can be nullable. Their default value is NULL.
</a><a href="#h9-0-3" id="h9-0-3" class="i">+&gt; CREATE TABLE datatypes ( \
</a><a href="#h9-0-4" id="h9-0-4" class="i">+    id INTEGER PRIMARY KEY, \
</a><a href="#h9-0-5" id="h9-0-5" class="i">+    &quot;bool&quot; BOOLEAN NULL, \
</a><a href="#h9-0-6" id="h9-0-6" class="i">+    &quot;float&quot; FLOAT NULL, \
</a><a href="#h9-0-7" id="h9-0-7" class="i">+    &quot;int&quot; INTEGER NULL, \
</a><a href="#h9-0-8" id="h9-0-8" class="i">+    &quot;string&quot; STRING NULL \
</a><a href="#h9-0-9" id="h9-0-9" class="i">+)
</a><a href="#h9-0-10" id="h9-0-10" class="i">+schema datatypes
</a><a href="#h9-0-11" id="h9-0-11" class="i">+---
</a><a href="#h9-0-12" id="h9-0-12" class="i">+CREATE TABLE datatypes (
</a><a href="#h9-0-13" id="h9-0-13" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h9-0-14" id="h9-0-14" class="i">+  &quot;bool&quot; BOOLEAN DEFAULT NULL,
</a><a href="#h9-0-15" id="h9-0-15" class="i">+  &quot;float&quot; FLOAT DEFAULT NULL,
</a><a href="#h9-0-16" id="h9-0-16" class="i">+  &quot;int&quot; INTEGER DEFAULT NULL,
</a><a href="#h9-0-17" id="h9-0-17" class="i">+  &quot;string&quot; STRING DEFAULT NULL
</a><a href="#h9-0-18" id="h9-0-18" class="i">+)
</a><a href="#h9-0-19" id="h9-0-19" class="i">+
</a><a href="#h9-0-20" id="h9-0-20" class="i">+# Column can be made explicitly non-nullable.
</a><a href="#h9-0-21" id="h9-0-21" class="i">+&gt; CREATE TABLE non_null (id INTEGER PRIMARY KEY, value STRING NOT NULL)
</a><a href="#h9-0-22" id="h9-0-22" class="i">+schema non_null
</a><a href="#h9-0-23" id="h9-0-23" class="i">+---
</a><a href="#h9-0-24" id="h9-0-24" class="i">+CREATE TABLE non_null (
</a><a href="#h9-0-25" id="h9-0-25" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h9-0-26" id="h9-0-26" class="i">+  value STRING NOT NULL
</a><a href="#h9-0-27" id="h9-0-27" class="i">+)
</a><a href="#h9-0-28" id="h9-0-28" class="i">+
</a><a href="#h9-0-29" id="h9-0-29" class="i">+# Column can&#39;t be both nullable and non-nullable.
</a><a href="#h9-0-30" id="h9-0-30" class="i">+!&gt; CREATE TABLE test (id INTEGER PRIMARY KEY, value STRING NULL NOT NULL)
</a><a href="#h9-0-31" id="h9-0-31" class="i">+---
</a><a href="#h9-0-32" id="h9-0-32" class="i">+Error: invalid input: nullability already set for column value
</a><b>diff --git a/<a id="h10" href="../file/src/sql/testscripts/schema/create_table_primary_key.html">src/sql/testscripts/schema/create_table_primary_key</a> b/<a href="../file/src/sql/testscripts/schema/create_table_primary_key.html">src/sql/testscripts/schema/create_table_primary_key</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -0,0 +1,39 @@
</a><a href="#h10-0-0" id="h10-0-0" class="i">+# Tests primary keys.
</a><a href="#h10-0-1" id="h10-0-1" class="i">+
</a><a href="#h10-0-2" id="h10-0-2" class="i">+# There must be exactly one primary key.
</a><a href="#h10-0-3" id="h10-0-3" class="i">+!&gt; CREATE TABLE &quot;primary&quot; (id INTEGER)
</a><a href="#h10-0-4" id="h10-0-4" class="i">+!&gt; CREATE TABLE &quot;primary&quot; (id INTEGER PRIMARY KEY, name STRING PRIMARY KEY)
</a><a href="#h10-0-5" id="h10-0-5" class="i">+&gt; CREATE TABLE &quot;primary&quot; (id INTEGER PRIMARY KEY)
</a><a href="#h10-0-6" id="h10-0-6" class="i">+schema primary
</a><a href="#h10-0-7" id="h10-0-7" class="i">+---
</a><a href="#h10-0-8" id="h10-0-8" class="i">+Error: invalid input: no primary key for table primary
</a><a href="#h10-0-9" id="h10-0-9" class="i">+Error: invalid input: multiple primary keys for table primary
</a><a href="#h10-0-10" id="h10-0-10" class="i">+CREATE TABLE &quot;primary&quot; (
</a><a href="#h10-0-11" id="h10-0-11" class="i">+  id INTEGER PRIMARY KEY
</a><a href="#h10-0-12" id="h10-0-12" class="i">+)
</a><a href="#h10-0-13" id="h10-0-13" class="i">+
</a><a href="#h10-0-14" id="h10-0-14" class="i">+# The primary key can&#39;t be nullable.
</a><a href="#h10-0-15" id="h10-0-15" class="i">+!&gt; CREATE TABLE &quot;null&quot; (id INTEGER PRIMARY KEY NULL)
</a><a href="#h10-0-16" id="h10-0-16" class="i">+---
</a><a href="#h10-0-17" id="h10-0-17" class="i">+Error: invalid input: primary key id cannot be nullable
</a><a href="#h10-0-18" id="h10-0-18" class="i">+
</a><a href="#h10-0-19" id="h10-0-19" class="i">+# It can have a default value though.
</a><a href="#h10-0-20" id="h10-0-20" class="i">+&gt; CREATE TABLE &quot;default&quot; (id INTEGER PRIMARY KEY DEFAULT 1)
</a><a href="#h10-0-21" id="h10-0-21" class="i">+---
</a><a href="#h10-0-22" id="h10-0-22" class="i">+ok
</a><a href="#h10-0-23" id="h10-0-23" class="i">+
</a><a href="#h10-0-24" id="h10-0-24" class="i">+# Primary keys can also take all datatypes.
</a><a href="#h10-0-25" id="h10-0-25" class="i">+&gt; CREATE TABLE &quot;bool&quot; (id BOOL PRIMARY KEY)
</a><a href="#h10-0-26" id="h10-0-26" class="i">+&gt; CREATE TABLE &quot;float&quot; (id FLOAT PRIMARY KEY)
</a><a href="#h10-0-27" id="h10-0-27" class="i">+&gt; CREATE TABLE &quot;string&quot; (id STRING PRIMARY KEY)
</a><a href="#h10-0-28" id="h10-0-28" class="i">+schema bool float string
</a><a href="#h10-0-29" id="h10-0-29" class="i">+---
</a><a href="#h10-0-30" id="h10-0-30" class="i">+CREATE TABLE &quot;bool&quot; (
</a><a href="#h10-0-31" id="h10-0-31" class="i">+  id BOOLEAN PRIMARY KEY
</a><a href="#h10-0-32" id="h10-0-32" class="i">+)
</a><a href="#h10-0-33" id="h10-0-33" class="i">+CREATE TABLE &quot;float&quot; (
</a><a href="#h10-0-34" id="h10-0-34" class="i">+  id FLOAT PRIMARY KEY
</a><a href="#h10-0-35" id="h10-0-35" class="i">+)
</a><a href="#h10-0-36" id="h10-0-36" class="i">+CREATE TABLE &quot;string&quot; (
</a><a href="#h10-0-37" id="h10-0-37" class="i">+  id STRING PRIMARY KEY
</a><a href="#h10-0-38" id="h10-0-38" class="i">+)
</a><b>diff --git a/<a id="h11" href="../file/src/sql/testscripts/schema/create_table_reference.html">src/sql/testscripts/schema/create_table_reference</a> b/<a href="../file/src/sql/testscripts/schema/create_table_reference.html">src/sql/testscripts/schema/create_table_reference</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -0,0 +1,63 @@
</a><a href="#h11-0-0" id="h11-0-0" class="i">+# Tests foreign key references during CREATE TABLE.
</a><a href="#h11-0-1" id="h11-0-1" class="i">+
</a><a href="#h11-0-2" id="h11-0-2" class="i">+# Create two reference tables, with int/string primary keys.
</a><a href="#h11-0-3" id="h11-0-3" class="i">+&gt; CREATE TABLE &quot;ref&quot; (id INT PRIMARY KEY, value STRING NOT NULL)
</a><a href="#h11-0-4" id="h11-0-4" class="i">+&gt; INSERT INTO &quot;ref&quot; VALUES (1, &#39;a&#39;), (2, &#39;b&#39;)
</a><a href="#h11-0-5" id="h11-0-5" class="i">+---
</a><a href="#h11-0-6" id="h11-0-6" class="i">+ok
</a><a href="#h11-0-7" id="h11-0-7" class="i">+
</a><a href="#h11-0-8" id="h11-0-8" class="i">+&gt; CREATE TABLE sref (id STRING PRIMARY KEY, value INTEGER NOT NULL)
</a><a href="#h11-0-9" id="h11-0-9" class="i">+&gt; INSERT INTO sref VALUES (&#39;a&#39;, 1), (&#39;b&#39;, 2)
</a><a href="#h11-0-10" id="h11-0-10" class="i">+---
</a><a href="#h11-0-11" id="h11-0-11" class="i">+ok
</a><a href="#h11-0-12" id="h11-0-12" class="i">+
</a><a href="#h11-0-13" id="h11-0-13" class="i">+# Creating a table with references works. The reference columns get implicit
</a><a href="#h11-0-14" id="h11-0-14" class="i">+# indexes, but only a single schema entity.
</a><a href="#h11-0-15" id="h11-0-15" class="i">+[ops]&gt; CREATE TABLE name (id INT PRIMARY KEY, ref_id INT REFERENCES &quot;ref&quot;, sref_id STRING REFERENCES sref)
</a><a href="#h11-0-16" id="h11-0-16" class="i">+---
</a><a href="#h11-0-17" id="h11-0-17" class="i">+storage set mvcc:NextVersion → 6 [&quot;\x00&quot; → &quot;\x06&quot;]
</a><a href="#h11-0-18" id="h11-0-18" class="i">+storage set mvcc:TxnActive(5) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;&quot;]
</a><a href="#h11-0-19" id="h11-0-19" class="i">+storage set mvcc:TxnWrite(5, sql:Table(&quot;name&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x05\x00\xffname\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h11-0-20" id="h11-0-20" class="i">+storage set mvcc:Version(sql:Table(&quot;name&quot;), 5) → CREATE TABLE name ( id INTEGER PRIMARY KEY, ref_id INTEGER DEFAULT NULL INDEX REFERENCES ref, sref_id STRING DEFAULT NULL INDEX REFERENCES sref ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x016\x04name\x00\x03\x02id\x01\x00\x00\x01\x00\x00\x06ref_id\x01\x01\x01\x00\x00\x01\x01\x03ref\x07sref_id\x03\x01\x01\x00\x00\x01\x01\x04sref&quot;]
</a><a href="#h11-0-21" id="h11-0-21" class="i">+storage delete mvcc:TxnWrite(5, sql:Table(&quot;name&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x05\x00\xffname\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h11-0-22" id="h11-0-22" class="i">+storage delete mvcc:TxnActive(5) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x05&quot;]
</a><a href="#h11-0-23" id="h11-0-23" class="i">+
</a><a href="#h11-0-24" id="h11-0-24" class="i">+schema name
</a><a href="#h11-0-25" id="h11-0-25" class="i">+---
</a><a href="#h11-0-26" id="h11-0-26" class="i">+CREATE TABLE name (
</a><a href="#h11-0-27" id="h11-0-27" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h11-0-28" id="h11-0-28" class="i">+  ref_id INTEGER DEFAULT NULL INDEX REFERENCES ref,
</a><a href="#h11-0-29" id="h11-0-29" class="i">+  sref_id STRING DEFAULT NULL INDEX REFERENCES sref
</a><a href="#h11-0-30" id="h11-0-30" class="i">+)
</a><a href="#h11-0-31" id="h11-0-31" class="i">+
</a><a href="#h11-0-32" id="h11-0-32" class="i">+dump
</a><a href="#h11-0-33" id="h11-0-33" class="i">+---
</a><a href="#h11-0-34" id="h11-0-34" class="i">+mvcc:NextVersion → 6 [&quot;\x00&quot; → &quot;\x06&quot;]
</a><a href="#h11-0-35" id="h11-0-35" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 5) → CREATE TABLE name ( id INTEGER PRIMARY KEY, ref_id INTEGER DEFAULT NULL INDEX REFERENCES ref, sref_id STRING DEFAULT NULL INDEX REFERENCES sref ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x016\x04name\x00\x03\x02id\x01\x00\x00\x01\x00\x00\x06ref_id\x01\x01\x01\x00\x00\x01\x01\x03ref\x07sref_id\x03\x01\x01\x00\x00\x01\x01\x04sref&quot;]
</a><a href="#h11-0-36" id="h11-0-36" class="i">+mvcc:Version(sql:Table(&quot;ref&quot;), 1) → CREATE TABLE ref ( id INTEGER PRIMARY KEY, value STRING NOT NULL ) [&quot;\x04\x00\xffref\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1b\x03ref\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x00\x00\x00\x00\x00&quot;]
</a><a href="#h11-0-37" id="h11-0-37" class="i">+mvcc:Version(sql:Table(&quot;sref&quot;), 3) → CREATE TABLE sref ( id STRING PRIMARY KEY, value INTEGER NOT NULL ) [&quot;\x04\x00\xffsref\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x1c\x04sref\x00\x02\x02id\x03\x00\x00\x01\x00\x00\x05value\x01\x00\x00\x00\x00\x00&quot;]
</a><a href="#h11-0-38" id="h11-0-38" class="i">+mvcc:Version(sql:Row(&quot;ref&quot;, Integer(1)), 2) → Integer(1),String(&quot;a&quot;) [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h11-0-39" id="h11-0-39" class="i">+mvcc:Version(sql:Row(&quot;ref&quot;, Integer(2)), 2) → Integer(2),String(&quot;b&quot;) [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h11-0-40" id="h11-0-40" class="i">+mvcc:Version(sql:Row(&quot;sref&quot;, String(&quot;a&quot;)), 4) → String(&quot;a&quot;),Integer(1) [&quot;\x04\x02sref\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x06\x02\x04\x01a\x02\x02&quot;]
</a><a href="#h11-0-41" id="h11-0-41" class="i">+mvcc:Version(sql:Row(&quot;sref&quot;, String(&quot;b&quot;)), 4) → String(&quot;b&quot;),Integer(2) [&quot;\x04\x02sref\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x06\x02\x04\x01b\x02\x04&quot;]
</a><a href="#h11-0-42" id="h11-0-42" class="i">+
</a><a href="#h11-0-43" id="h11-0-43" class="i">+# Missing reference table errors.
</a><a href="#h11-0-44" id="h11-0-44" class="i">+!&gt; CREATE TABLE test (id INT PRIMARY KEY, &quot;ref&quot; INT REFERENCES missing)
</a><a href="#h11-0-45" id="h11-0-45" class="i">+---
</a><a href="#h11-0-46" id="h11-0-46" class="i">+Error: invalid input: unknown table missing referenced by column ref
</a><a href="#h11-0-47" id="h11-0-47" class="i">+
</a><a href="#h11-0-48" id="h11-0-48" class="i">+# Reference type conflicts errors.
</a><a href="#h11-0-49" id="h11-0-49" class="i">+!&gt; CREATE TABLE test (id INT PRIMARY KEY, ref_id FLOAT REFERENCES &quot;ref&quot;)
</a><a href="#h11-0-50" id="h11-0-50" class="i">+!&gt; CREATE TABLE test (id INT PRIMARY KEY, sref_id INT REFERENCES sref)
</a><a href="#h11-0-51" id="h11-0-51" class="i">+---
</a><a href="#h11-0-52" id="h11-0-52" class="i">+Error: invalid input: can&#39;t reference INTEGER primary key of ref from FLOAT column ref_id
</a><a href="#h11-0-53" id="h11-0-53" class="i">+Error: invalid input: can&#39;t reference STRING primary key of sref from INTEGER column sref_id
</a><a href="#h11-0-54" id="h11-0-54" class="i">+
</a><a href="#h11-0-55" id="h11-0-55" class="i">+# Self-references work.
</a><a href="#h11-0-56" id="h11-0-56" class="i">+&gt; CREATE TABLE self (id INT PRIMARY KEY, self_id INT REFERENCES self)
</a><a href="#h11-0-57" id="h11-0-57" class="i">+schema self
</a><a href="#h11-0-58" id="h11-0-58" class="i">+---
</a><a href="#h11-0-59" id="h11-0-59" class="i">+CREATE TABLE self (
</a><a href="#h11-0-60" id="h11-0-60" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h11-0-61" id="h11-0-61" class="i">+  self_id INTEGER DEFAULT NULL INDEX REFERENCES self
</a><a href="#h11-0-62" id="h11-0-62" class="i">+)
</a><b>diff --git a/<a id="h12" href="../file/src/sql/testscripts/schema/create_table_transaction.html">src/sql/testscripts/schema/create_table_transaction</a> b/<a href="../file/src/sql/testscripts/schema/create_table_transaction.html">src/sql/testscripts/schema/create_table_transaction</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -0,0 +1,45 @@
</a><a href="#h12-0-0" id="h12-0-0" class="i">+# Tests that CREATE TABLE is transactional.
</a><a href="#h12-0-1" id="h12-0-1" class="i">+
</a><a href="#h12-0-2" id="h12-0-2" class="i">+&gt; BEGIN
</a><a href="#h12-0-3" id="h12-0-3" class="i">+[ops]&gt; CREATE TABLE name (id INT PRIMARY KEY, value STRING)
</a><a href="#h12-0-4" id="h12-0-4" class="i">+---
</a><a href="#h12-0-5" id="h12-0-5" class="i">+storage set mvcc:TxnWrite(1, sql:Table(&quot;name&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xffname\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h12-0-6" id="h12-0-6" class="i">+storage set mvcc:Version(sql:Table(&quot;name&quot;), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
</a><a href="#h12-0-7" id="h12-0-7" class="i">+
</a><a href="#h12-0-8" id="h12-0-8" class="i">+schema name
</a><a href="#h12-0-9" id="h12-0-9" class="i">+---
</a><a href="#h12-0-10" id="h12-0-10" class="i">+CREATE TABLE name (
</a><a href="#h12-0-11" id="h12-0-11" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h12-0-12" id="h12-0-12" class="i">+  value STRING DEFAULT NULL
</a><a href="#h12-0-13" id="h12-0-13" class="i">+)
</a><a href="#h12-0-14" id="h12-0-14" class="i">+
</a><a href="#h12-0-15" id="h12-0-15" class="i">+dump
</a><a href="#h12-0-16" id="h12-0-16" class="i">+---
</a><a href="#h12-0-17" id="h12-0-17" class="i">+mvcc:NextVersion → 2 [&quot;\x00&quot; → &quot;\x02&quot;]
</a><a href="#h12-0-18" id="h12-0-18" class="i">+mvcc:TxnActive(1) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;&quot;]
</a><a href="#h12-0-19" id="h12-0-19" class="i">+mvcc:TxnWrite(1, sql:Table(&quot;name&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xffname\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h12-0-20" id="h12-0-20" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
</a><a href="#h12-0-21" id="h12-0-21" class="i">+
</a><a href="#h12-0-22" id="h12-0-22" class="i">+# Rolling it back undoes it.
</a><a href="#h12-0-23" id="h12-0-23" class="i">+[ops]&gt; ROLLBACK
</a><a href="#h12-0-24" id="h12-0-24" class="i">+---
</a><a href="#h12-0-25" id="h12-0-25" class="i">+storage delete mvcc:Version(sql:Table(&quot;name&quot;), 1) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot;]
</a><a href="#h12-0-26" id="h12-0-26" class="i">+storage delete mvcc:TxnWrite(1, sql:Table(&quot;name&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xffname\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h12-0-27" id="h12-0-27" class="i">+storage delete mvcc:TxnActive(1) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x01&quot;]
</a><a href="#h12-0-28" id="h12-0-28" class="i">+
</a><a href="#h12-0-29" id="h12-0-29" class="i">+dump
</a><a href="#h12-0-30" id="h12-0-30" class="i">+---
</a><a href="#h12-0-31" id="h12-0-31" class="i">+mvcc:NextVersion → 2 [&quot;\x00&quot; → &quot;\x02&quot;]
</a><a href="#h12-0-32" id="h12-0-32" class="i">+
</a><a href="#h12-0-33" id="h12-0-33" class="i">+# Committing a table also works.
</a><a href="#h12-0-34" id="h12-0-34" class="i">+&gt; BEGIN
</a><a href="#h12-0-35" id="h12-0-35" class="i">+&gt; CREATE TABLE name (id INT PRIMARY KEY, value STRING)
</a><a href="#h12-0-36" id="h12-0-36" class="i">+[ops]&gt; COMMIT
</a><a href="#h12-0-37" id="h12-0-37" class="i">+---
</a><a href="#h12-0-38" id="h12-0-38" class="i">+storage delete mvcc:TxnWrite(2, sql:Table(&quot;name&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x00\xffname\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h12-0-39" id="h12-0-39" class="i">+storage delete mvcc:TxnActive(2) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot;]
</a><a href="#h12-0-40" id="h12-0-40" class="i">+
</a><a href="#h12-0-41" id="h12-0-41" class="i">+dump
</a><a href="#h12-0-42" id="h12-0-42" class="i">+---
</a><a href="#h12-0-43" id="h12-0-43" class="i">+mvcc:NextVersion → 3 [&quot;\x00&quot; → &quot;\x03&quot;]
</a><a href="#h12-0-44" id="h12-0-44" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 2) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
</a><b>diff --git a/<a id="h13" href="../file/src/sql/testscripts/schema/create_table_unique.html">src/sql/testscripts/schema/create_table_unique</a> b/<a href="../file/src/sql/testscripts/schema/create_table_unique.html">src/sql/testscripts/schema/create_table_unique</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -0,0 +1,37 @@
</a><a href="#h13-0-0" id="h13-0-0" class="i">+# Creating a table with a unique index only results in a single schema entry (no
</a><a href="#h13-0-1" id="h13-0-1" class="i">+# separate index).
</a><a href="#h13-0-2" id="h13-0-2" class="i">+[ops]&gt; CREATE TABLE indexed (id INTEGER PRIMARY KEY, &quot;index&quot; INTEGER UNIQUE)
</a><a href="#h13-0-3" id="h13-0-3" class="i">+---
</a><a href="#h13-0-4" id="h13-0-4" class="i">+storage set mvcc:NextVersion → 2 [&quot;\x00&quot; → &quot;\x02&quot;]
</a><a href="#h13-0-5" id="h13-0-5" class="i">+storage set mvcc:TxnActive(1) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;&quot;]
</a><a href="#h13-0-6" id="h13-0-6" class="i">+storage set mvcc:TxnWrite(1, sql:Table(&quot;indexed&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xffindexed\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h13-0-7" id="h13-0-7" class="i">+storage set mvcc:Version(sql:Table(&quot;indexed&quot;), 1) → CREATE TABLE indexed ( id INTEGER PRIMARY KEY, &quot;index&quot; INTEGER DEFAULT NULL UNIQUE INDEX ) [&quot;\x04\x00\xffindexed\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01 \x07indexed\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05index\x01\x01\x01\x00\x01\x01\x00&quot;]
</a><a href="#h13-0-8" id="h13-0-8" class="i">+storage delete mvcc:TxnWrite(1, sql:Table(&quot;indexed&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\xffindexed\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h13-0-9" id="h13-0-9" class="i">+storage delete mvcc:TxnActive(1) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x01&quot;]
</a><a href="#h13-0-10" id="h13-0-10" class="i">+
</a><a href="#h13-0-11" id="h13-0-11" class="i">+# The column gets an implicit secondary index marker.
</a><a href="#h13-0-12" id="h13-0-12" class="i">+schema
</a><a href="#h13-0-13" id="h13-0-13" class="i">+---
</a><a href="#h13-0-14" id="h13-0-14" class="i">+CREATE TABLE indexed (
</a><a href="#h13-0-15" id="h13-0-15" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h13-0-16" id="h13-0-16" class="i">+  &quot;index&quot; INTEGER DEFAULT NULL UNIQUE INDEX
</a><a href="#h13-0-17" id="h13-0-17" class="i">+)
</a><a href="#h13-0-18" id="h13-0-18" class="i">+
</a><a href="#h13-0-19" id="h13-0-19" class="i">+# Unique indexes work for primary key, foreign key, nullable, non-nullable, and
</a><a href="#h13-0-20" id="h13-0-20" class="i">+# default columns.
</a><a href="#h13-0-21" id="h13-0-21" class="i">+&gt; CREATE TABLE &quot;unique&quot; ( \
</a><a href="#h13-0-22" id="h13-0-22" class="i">+  id INTEGER PRIMARY KEY UNIQUE, \
</a><a href="#h13-0-23" id="h13-0-23" class="i">+  ref INTEGER REFERENCES indexed UNIQUE, \
</a><a href="#h13-0-24" id="h13-0-24" class="i">+  nullable INTEGER NULL UNIQUE, \
</a><a href="#h13-0-25" id="h13-0-25" class="i">+  non_nullable INTEGER NOT NULL UNIQUE, \
</a><a href="#h13-0-26" id="h13-0-26" class="i">+  &quot;default&quot; INTEGER DEFAULT 7 UNIQUE \
</a><a href="#h13-0-27" id="h13-0-27" class="i">+)
</a><a href="#h13-0-28" id="h13-0-28" class="i">+schema unique
</a><a href="#h13-0-29" id="h13-0-29" class="i">+---
</a><a href="#h13-0-30" id="h13-0-30" class="i">+CREATE TABLE &quot;unique&quot; (
</a><a href="#h13-0-31" id="h13-0-31" class="i">+  id INTEGER PRIMARY KEY,
</a><a href="#h13-0-32" id="h13-0-32" class="i">+  ref INTEGER DEFAULT NULL UNIQUE INDEX REFERENCES indexed,
</a><a href="#h13-0-33" id="h13-0-33" class="i">+  nullable INTEGER DEFAULT NULL UNIQUE INDEX,
</a><a href="#h13-0-34" id="h13-0-34" class="i">+  non_nullable INTEGER NOT NULL UNIQUE INDEX,
</a><a href="#h13-0-35" id="h13-0-35" class="i">+  &quot;default&quot; INTEGER DEFAULT 7 UNIQUE INDEX
</a><a href="#h13-0-36" id="h13-0-36" class="i">+)
</a><b>diff --git a/<a id="h14" href="../file/src/sql/testscripts/schema/drop_table.html">src/sql/testscripts/schema/drop_table</a> b/<a href="../file/src/sql/testscripts/schema/drop_table.html">src/sql/testscripts/schema/drop_table</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -0,0 +1,58 @@
</a><a href="#h14-0-0" id="h14-0-0" class="i">+# Basic DROP TABLE tests.
</a><a href="#h14-0-1" id="h14-0-1" class="i">+
</a><a href="#h14-0-2" id="h14-0-2" class="i">+&gt; CREATE TABLE name (id INT PRIMARY KEY, value STRING NOT NULL)
</a><a href="#h14-0-3" id="h14-0-3" class="i">+&gt; INSERT INTO name VALUES (1, &#39;a&#39;), (2, &#39;b&#39;)
</a><a href="#h14-0-4" id="h14-0-4" class="i">+---
</a><a href="#h14-0-5" id="h14-0-5" class="i">+ok
</a><a href="#h14-0-6" id="h14-0-6" class="i">+
</a><a href="#h14-0-7" id="h14-0-7" class="i">+# Dropping a simple table works, and removes the schema entry and rows.
</a><a href="#h14-0-8" id="h14-0-8" class="i">+# Also output the trivial plan and statement result.
</a><a href="#h14-0-9" id="h14-0-9" class="i">+[plan,result,ops]&gt; DROP TABLE name
</a><a href="#h14-0-10" id="h14-0-10" class="i">+---
</a><a href="#h14-0-11" id="h14-0-11" class="i">+DropTable: name
</a><a href="#h14-0-12" id="h14-0-12" class="i">+DropTable { name: &quot;name&quot;, existed: true }
</a><a href="#h14-0-13" id="h14-0-13" class="i">+storage set mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
</a><a href="#h14-0-14" id="h14-0-14" class="i">+storage set mvcc:TxnActive(3) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;&quot;]
</a><a href="#h14-0-15" id="h14-0-15" class="i">+storage set mvcc:TxnWrite(3, sql:Table(&quot;name&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x00\xffname\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h14-0-16" id="h14-0-16" class="i">+storage set mvcc:Version(sql:Table(&quot;name&quot;), 3) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h14-0-17" id="h14-0-17" class="i">+storage set mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(1))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
</a><a href="#h14-0-18" id="h14-0-18" class="i">+storage set mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h14-0-19" id="h14-0-19" class="i">+storage set mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(2))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
</a><a href="#h14-0-20" id="h14-0-20" class="i">+storage set mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h14-0-21" id="h14-0-21" class="i">+storage delete mvcc:TxnWrite(3, sql:Table(&quot;name&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x00\xffname\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h14-0-22" id="h14-0-22" class="i">+storage delete mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(1))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
</a><a href="#h14-0-23" id="h14-0-23" class="i">+storage delete mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(2))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
</a><a href="#h14-0-24" id="h14-0-24" class="i">+storage delete mvcc:TxnActive(3) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
</a><a href="#h14-0-25" id="h14-0-25" class="i">+
</a><a href="#h14-0-26" id="h14-0-26" class="i">+schema
</a><a href="#h14-0-27" id="h14-0-27" class="i">+---
</a><a href="#h14-0-28" id="h14-0-28" class="i">+ok
</a><a href="#h14-0-29" id="h14-0-29" class="i">+
</a><a href="#h14-0-30" id="h14-0-30" class="i">+dump
</a><a href="#h14-0-31" id="h14-0-31" class="i">+---
</a><a href="#h14-0-32" id="h14-0-32" class="i">+mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
</a><a href="#h14-0-33" id="h14-0-33" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING NOT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1c\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x00\x00\x00\x00\x00&quot;]
</a><a href="#h14-0-34" id="h14-0-34" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 3) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h14-0-35" id="h14-0-35" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 2) → Integer(1),String(&quot;a&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h14-0-36" id="h14-0-36" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h14-0-37" id="h14-0-37" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 2) → Integer(2),String(&quot;b&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h14-0-38" id="h14-0-38" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h14-0-39" id="h14-0-39" class="i">+
</a><a href="#h14-0-40" id="h14-0-40" class="i">+# Dropping a missing table errors, but not if IF EXISTS is given.
</a><a href="#h14-0-41" id="h14-0-41" class="i">+!&gt; DROP TABLE name
</a><a href="#h14-0-42" id="h14-0-42" class="i">+---
</a><a href="#h14-0-43" id="h14-0-43" class="i">+Error: invalid input: table name does not exist
</a><a href="#h14-0-44" id="h14-0-44" class="i">+
</a><a href="#h14-0-45" id="h14-0-45" class="i">+[result,ops]&gt; DROP TABLE IF EXISTS name
</a><a href="#h14-0-46" id="h14-0-46" class="i">+---
</a><a href="#h14-0-47" id="h14-0-47" class="i">+DropTable { name: &quot;name&quot;, existed: false }
</a><a href="#h14-0-48" id="h14-0-48" class="i">+storage set mvcc:NextVersion → 6 [&quot;\x00&quot; → &quot;\x06&quot;]
</a><a href="#h14-0-49" id="h14-0-49" class="i">+storage set mvcc:TxnActive(5) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;&quot;]
</a><a href="#h14-0-50" id="h14-0-50" class="i">+storage delete mvcc:TxnActive(5) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x05&quot;]
</a><a href="#h14-0-51" id="h14-0-51" class="i">+
</a><a href="#h14-0-52" id="h14-0-52" class="i">+# No table or multiple tables errors.
</a><a href="#h14-0-53" id="h14-0-53" class="i">+!&gt; DROP TABLE
</a><a href="#h14-0-54" id="h14-0-54" class="i">+!&gt; DROP TABLE a, b, c
</a><a href="#h14-0-55" id="h14-0-55" class="i">+---
</a><a href="#h14-0-56" id="h14-0-56" class="i">+Error: invalid input: unexpected end of input
</a><a href="#h14-0-57" id="h14-0-57" class="i">+Error: invalid input: unexpected token ,
</a><b>diff --git a/<a id="h15" href="../file/src/sql/testscripts/schema/drop_table_index.html">src/sql/testscripts/schema/drop_table_index</a> b/<a href="../file/src/sql/testscripts/schema/drop_table_index.html">src/sql/testscripts/schema/drop_table_index</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -0,0 +1,118 @@
</a><a href="#h15-0-0" id="h15-0-0" class="i">+# Tests that DROP TABLE cleans up secondary indexes of all kinds.
</a><a href="#h15-0-1" id="h15-0-1" class="i">+
</a><a href="#h15-0-2" id="h15-0-2" class="i">+&gt; CREATE TABLE &quot;ref&quot; (id INT PRIMARY KEY, value STRING NOT NULL)
</a><a href="#h15-0-3" id="h15-0-3" class="i">+&gt; INSERT INTO &quot;ref&quot; VALUES (1, &#39;a&#39;), (2, &#39;b&#39;)
</a><a href="#h15-0-4" id="h15-0-4" class="i">+---
</a><a href="#h15-0-5" id="h15-0-5" class="i">+ok
</a><a href="#h15-0-6" id="h15-0-6" class="i">+
</a><a href="#h15-0-7" id="h15-0-7" class="i">+&gt; CREATE TABLE name ( \
</a><a href="#h15-0-8" id="h15-0-8" class="i">+  id INT PRIMARY KEY, \
</a><a href="#h15-0-9" id="h15-0-9" class="i">+  &quot;index&quot; STRING, \
</a><a href="#h15-0-10" id="h15-0-10" class="i">+  &quot;unique&quot; INT UNIQUE NOT NULL, \
</a><a href="#h15-0-11" id="h15-0-11" class="i">+  ref_id INT REFERENCES &quot;ref&quot; \
</a><a href="#h15-0-12" id="h15-0-12" class="i">+)
</a><a href="#h15-0-13" id="h15-0-13" class="i">+&gt; INSERT INTO name VALUES (1, &#39;foo&#39;, 1, 1)
</a><a href="#h15-0-14" id="h15-0-14" class="i">+&gt; INSERT INTO name VALUES (2, &#39;bar&#39;, 2, 2)
</a><a href="#h15-0-15" id="h15-0-15" class="i">+&gt; INSERT INTO name VALUES (3, &#39;foo&#39;, 3, NULL)
</a><a href="#h15-0-16" id="h15-0-16" class="i">+&gt; INSERT INTO name VALUES (4, NULL, 4, 2)
</a><a href="#h15-0-17" id="h15-0-17" class="i">+---
</a><a href="#h15-0-18" id="h15-0-18" class="i">+ok
</a><a href="#h15-0-19" id="h15-0-19" class="i">+
</a><a href="#h15-0-20" id="h15-0-20" class="i">+dump
</a><a href="#h15-0-21" id="h15-0-21" class="i">+---
</a><a href="#h15-0-22" id="h15-0-22" class="i">+mvcc:NextVersion → 8 [&quot;\x00&quot; → &quot;\x08&quot;]
</a><a href="#h15-0-23" id="h15-0-23" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 3) → CREATE TABLE name ( id INTEGER PRIMARY KEY, &quot;index&quot; STRING DEFAULT NULL, &quot;unique&quot; INTEGER NOT NULL UNIQUE INDEX, ref_id INTEGER DEFAULT NULL INDEX REFERENCES ref ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01&lt;\x04name\x00\x04\x02id\x01\x00\x00\x01\x00\x00\x05index\x03\x01\x01\x00\x00\x00\x00\x06unique\x01\x00\x00\x01\x01\x00\x06ref_id\x01\x01\x01\x00\x00\x01\x01\x03ref&quot;]
</a><a href="#h15-0-24" id="h15-0-24" class="i">+mvcc:Version(sql:Table(&quot;ref&quot;), 1) → CREATE TABLE ref ( id INTEGER PRIMARY KEY, value STRING NOT NULL ) [&quot;\x04\x00\xffref\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1b\x03ref\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x00\x00\x00\x00\x00&quot;]
</a><a href="#h15-0-25" id="h15-0-25" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Null), 6) → Integer(3) [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a><a href="#h15-0-26" id="h15-0-26" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(1)), 4) → Integer(1) [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h15-0-27" id="h15-0-27" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(2)), 5) → Integer(2) [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h15-0-28" id="h15-0-28" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(2)), 7) → Integer(2),Integer(4) [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x05\x02\x02\x04\x02\x08&quot;]
</a><a href="#h15-0-29" id="h15-0-29" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(1)), 4) → Integer(1) [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h15-0-30" id="h15-0-30" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(2)), 5) → Integer(2) [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h15-0-31" id="h15-0-31" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(3)), 6) → Integer(3) [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a><a href="#h15-0-32" id="h15-0-32" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(4)), 7) → Integer(4) [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x08&quot;]
</a><a href="#h15-0-33" id="h15-0-33" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 4) → Integer(1),String(&quot;foo&quot;),Integer(1),Integer(1) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x0c\x04\x02\x02\x04\x03foo\x02\x02\x02\x02&quot;]
</a><a href="#h15-0-34" id="h15-0-34" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 5) → Integer(2),String(&quot;bar&quot;),Integer(2),Integer(2) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x0c\x04\x02\x04\x04\x03bar\x02\x04\x02\x04&quot;]
</a><a href="#h15-0-35" id="h15-0-35" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(3)), 6) → Integer(3),String(&quot;foo&quot;),Integer(3),Null [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x0b\x04\x02\x06\x04\x03foo\x02\x06\x00&quot;]
</a><a href="#h15-0-36" id="h15-0-36" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(4)), 7) → Integer(4),Null,Integer(4),Integer(2) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x08\x04\x02\x08\x00\x02\x08\x02\x04&quot;]
</a><a href="#h15-0-37" id="h15-0-37" class="i">+mvcc:Version(sql:Row(&quot;ref&quot;, Integer(1)), 2) → Integer(1),String(&quot;a&quot;) [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h15-0-38" id="h15-0-38" class="i">+mvcc:Version(sql:Row(&quot;ref&quot;, Integer(2)), 2) → Integer(2),String(&quot;b&quot;) [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h15-0-39" id="h15-0-39" class="i">+
</a><a href="#h15-0-40" id="h15-0-40" class="i">+# Dropping the table deletes all index entries.
</a><a href="#h15-0-41" id="h15-0-41" class="i">+[ops]&gt; DROP TABLE name
</a><a href="#h15-0-42" id="h15-0-42" class="i">+&gt; DROP TABLE ref
</a><a href="#h15-0-43" id="h15-0-43" class="i">+---
</a><a href="#h15-0-44" id="h15-0-44" class="i">+storage set mvcc:NextVersion → 9 [&quot;\x00&quot; → &quot;\t&quot;]
</a><a href="#h15-0-45" id="h15-0-45" class="i">+storage set mvcc:TxnActive(8) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;&quot;]
</a><a href="#h15-0-46" id="h15-0-46" class="i">+storage set mvcc:TxnWrite(8, sql:Table(&quot;name&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x00\xffname\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-47" id="h15-0-47" class="i">+storage set mvcc:Version(sql:Table(&quot;name&quot;), 8) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-48" id="h15-0-48" class="i">+storage set mvcc:TxnWrite(8, sql:Row(&quot;name&quot;, Integer(1))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-49" id="h15-0-49" class="i">+storage set mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-50" id="h15-0-50" class="i">+storage set mvcc:TxnWrite(8, sql:Row(&quot;name&quot;, Integer(2))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-51" id="h15-0-51" class="i">+storage set mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-52" id="h15-0-52" class="i">+storage set mvcc:TxnWrite(8, sql:Row(&quot;name&quot;, Integer(3))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-53" id="h15-0-53" class="i">+storage set mvcc:Version(sql:Row(&quot;name&quot;, Integer(3)), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-54" id="h15-0-54" class="i">+storage set mvcc:TxnWrite(8, sql:Row(&quot;name&quot;, Integer(4))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-55" id="h15-0-55" class="i">+storage set mvcc:Version(sql:Row(&quot;name&quot;, Integer(4)), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-56" id="h15-0-56" class="i">+storage set mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(1))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-57" id="h15-0-57" class="i">+storage set mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(1)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-58" id="h15-0-58" class="i">+storage set mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(2))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-59" id="h15-0-59" class="i">+storage set mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(2)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-60" id="h15-0-60" class="i">+storage set mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(3))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-61" id="h15-0-61" class="i">+storage set mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(3)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-62" id="h15-0-62" class="i">+storage set mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(4))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-63" id="h15-0-63" class="i">+storage set mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(4)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-64" id="h15-0-64" class="i">+storage set mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Null)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-65" id="h15-0-65" class="i">+storage set mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Null), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-66" id="h15-0-66" class="i">+storage set mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(1))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-67" id="h15-0-67" class="i">+storage set mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(1)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-68" id="h15-0-68" class="i">+storage set mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(2))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
</a><a href="#h15-0-69" id="h15-0-69" class="i">+storage set mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(2)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-70" id="h15-0-70" class="i">+storage delete mvcc:TxnWrite(8, sql:Table(&quot;name&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x00\xffname\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h15-0-71" id="h15-0-71" class="i">+storage delete mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Null)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h15-0-72" id="h15-0-72" class="i">+storage delete mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(1))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
</a><a href="#h15-0-73" id="h15-0-73" class="i">+storage delete mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(2))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
</a><a href="#h15-0-74" id="h15-0-74" class="i">+storage delete mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(1))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
</a><a href="#h15-0-75" id="h15-0-75" class="i">+storage delete mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(2))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
</a><a href="#h15-0-76" id="h15-0-76" class="i">+storage delete mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(3))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot;]
</a><a href="#h15-0-77" id="h15-0-77" class="i">+storage delete mvcc:TxnWrite(8, sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(4))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00&quot;]
</a><a href="#h15-0-78" id="h15-0-78" class="i">+storage delete mvcc:TxnWrite(8, sql:Row(&quot;name&quot;, Integer(1))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
</a><a href="#h15-0-79" id="h15-0-79" class="i">+storage delete mvcc:TxnWrite(8, sql:Row(&quot;name&quot;, Integer(2))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
</a><a href="#h15-0-80" id="h15-0-80" class="i">+storage delete mvcc:TxnWrite(8, sql:Row(&quot;name&quot;, Integer(3))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot;]
</a><a href="#h15-0-81" id="h15-0-81" class="i">+storage delete mvcc:TxnWrite(8, sql:Row(&quot;name&quot;, Integer(4))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00&quot;]
</a><a href="#h15-0-82" id="h15-0-82" class="i">+storage delete mvcc:TxnActive(8) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x08&quot;]
</a><a href="#h15-0-83" id="h15-0-83" class="i">+
</a><a href="#h15-0-84" id="h15-0-84" class="i">+dump
</a><a href="#h15-0-85" id="h15-0-85" class="i">+---
</a><a href="#h15-0-86" id="h15-0-86" class="i">+mvcc:NextVersion → 10 [&quot;\x00&quot; → &quot;\n&quot;]
</a><a href="#h15-0-87" id="h15-0-87" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 3) → CREATE TABLE name ( id INTEGER PRIMARY KEY, &quot;index&quot; STRING DEFAULT NULL, &quot;unique&quot; INTEGER NOT NULL UNIQUE INDEX, ref_id INTEGER DEFAULT NULL INDEX REFERENCES ref ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01&lt;\x04name\x00\x04\x02id\x01\x00\x00\x01\x00\x00\x05index\x03\x01\x01\x00\x00\x00\x00\x06unique\x01\x00\x00\x01\x01\x00\x06ref_id\x01\x01\x01\x00\x00\x01\x01\x03ref&quot;]
</a><a href="#h15-0-88" id="h15-0-88" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 8) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-89" id="h15-0-89" class="i">+mvcc:Version(sql:Table(&quot;ref&quot;), 1) → CREATE TABLE ref ( id INTEGER PRIMARY KEY, value STRING NOT NULL ) [&quot;\x04\x00\xffref\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1b\x03ref\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x00\x00\x00\x00\x00&quot;]
</a><a href="#h15-0-90" id="h15-0-90" class="i">+mvcc:Version(sql:Table(&quot;ref&quot;), 9) → None [&quot;\x04\x00\xffref\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-91" id="h15-0-91" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Null), 6) → Integer(3) [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a><a href="#h15-0-92" id="h15-0-92" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Null), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-93" id="h15-0-93" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(1)), 4) → Integer(1) [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h15-0-94" id="h15-0-94" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(1)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-95" id="h15-0-95" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(2)), 5) → Integer(2) [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h15-0-96" id="h15-0-96" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(2)), 7) → Integer(2),Integer(4) [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x05\x02\x02\x04\x02\x08&quot;]
</a><a href="#h15-0-97" id="h15-0-97" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;ref_id&quot;, Integer(2)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-98" id="h15-0-98" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(1)), 4) → Integer(1) [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h15-0-99" id="h15-0-99" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(1)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-100" id="h15-0-100" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(2)), 5) → Integer(2) [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h15-0-101" id="h15-0-101" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(2)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-102" id="h15-0-102" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(3)), 6) → Integer(3) [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a><a href="#h15-0-103" id="h15-0-103" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(3)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-104" id="h15-0-104" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(4)), 7) → Integer(4) [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x08&quot;]
</a><a href="#h15-0-105" id="h15-0-105" class="i">+mvcc:Version(sql:Index(&quot;name&quot;, &quot;unique&quot;, Integer(4)), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-106" id="h15-0-106" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 4) → Integer(1),String(&quot;foo&quot;),Integer(1),Integer(1) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x0c\x04\x02\x02\x04\x03foo\x02\x02\x02\x02&quot;]
</a><a href="#h15-0-107" id="h15-0-107" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-108" id="h15-0-108" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 5) → Integer(2),String(&quot;bar&quot;),Integer(2),Integer(2) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x0c\x04\x02\x04\x04\x03bar\x02\x04\x02\x04&quot;]
</a><a href="#h15-0-109" id="h15-0-109" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-110" id="h15-0-110" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(3)), 6) → Integer(3),String(&quot;foo&quot;),Integer(3),Null [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x0b\x04\x02\x06\x04\x03foo\x02\x06\x00&quot;]
</a><a href="#h15-0-111" id="h15-0-111" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(3)), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-112" id="h15-0-112" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(4)), 7) → Integer(4),Null,Integer(4),Integer(2) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x08\x04\x02\x08\x00\x02\x08\x02\x04&quot;]
</a><a href="#h15-0-113" id="h15-0-113" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(4)), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-114" id="h15-0-114" class="i">+mvcc:Version(sql:Row(&quot;ref&quot;, Integer(1)), 2) → Integer(1),String(&quot;a&quot;) [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h15-0-115" id="h15-0-115" class="i">+mvcc:Version(sql:Row(&quot;ref&quot;, Integer(1)), 9) → None [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
</a><a href="#h15-0-116" id="h15-0-116" class="i">+mvcc:Version(sql:Row(&quot;ref&quot;, Integer(2)), 2) → Integer(2),String(&quot;b&quot;) [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h15-0-117" id="h15-0-117" class="i">+mvcc:Version(sql:Row(&quot;ref&quot;, Integer(2)), 9) → None [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
</a><b>diff --git a/<a id="h16" href="../file/src/sql/testscripts/schema/drop_table_ref.html">src/sql/testscripts/schema/drop_table_ref</a> b/<a href="../file/src/sql/testscripts/schema/drop_table_ref.html">src/sql/testscripts/schema/drop_table_ref</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -0,0 +1,31 @@
</a><a href="#h16-0-0" id="h16-0-0" class="i">+# Tests DROP TABLE with references.
</a><a href="#h16-0-1" id="h16-0-1" class="i">+
</a><a href="#h16-0-2" id="h16-0-2" class="i">+# Create a reference table and foreign key table.
</a><a href="#h16-0-3" id="h16-0-3" class="i">+&gt; CREATE TABLE &quot;ref&quot; (id INT PRIMARY KEY)
</a><a href="#h16-0-4" id="h16-0-4" class="i">+&gt; CREATE TABLE name (id INT PRIMARY KEY, ref_if INT REFERENCES &quot;ref&quot;)
</a><a href="#h16-0-5" id="h16-0-5" class="i">+---
</a><a href="#h16-0-6" id="h16-0-6" class="i">+ok
</a><a href="#h16-0-7" id="h16-0-7" class="i">+
</a><a href="#h16-0-8" id="h16-0-8" class="i">+# Dropping a table with a foreign key reference to it errors.
</a><a href="#h16-0-9" id="h16-0-9" class="i">+!&gt; DROP TABLE &quot;ref&quot;
</a><a href="#h16-0-10" id="h16-0-10" class="i">+---
</a><a href="#h16-0-11" id="h16-0-11" class="i">+Error: invalid input: table ref is referenced from name.ref_if
</a><a href="#h16-0-12" id="h16-0-12" class="i">+
</a><a href="#h16-0-13" id="h16-0-13" class="i">+# But it works if the source table is dropped first.
</a><a href="#h16-0-14" id="h16-0-14" class="i">+&gt; DROP TABLE name
</a><a href="#h16-0-15" id="h16-0-15" class="i">+&gt; DROP TABLE &quot;ref&quot;
</a><a href="#h16-0-16" id="h16-0-16" class="i">+---
</a><a href="#h16-0-17" id="h16-0-17" class="i">+ok
</a><a href="#h16-0-18" id="h16-0-18" class="i">+
</a><a href="#h16-0-19" id="h16-0-19" class="i">+# Dropping a table with a self reference also works.
</a><a href="#h16-0-20" id="h16-0-20" class="i">+&gt; CREATE TABLE self (id INT PRIMARY KEY, self_id INT REFERENCES self)
</a><a href="#h16-0-21" id="h16-0-21" class="i">+---
</a><a href="#h16-0-22" id="h16-0-22" class="i">+ok
</a><a href="#h16-0-23" id="h16-0-23" class="i">+
</a><a href="#h16-0-24" id="h16-0-24" class="i">+&gt; DROP TABLE self
</a><a href="#h16-0-25" id="h16-0-25" class="i">+---
</a><a href="#h16-0-26" id="h16-0-26" class="i">+ok
</a><a href="#h16-0-27" id="h16-0-27" class="i">+
</a><a href="#h16-0-28" id="h16-0-28" class="i">+schema
</a><a href="#h16-0-29" id="h16-0-29" class="i">+---
</a><a href="#h16-0-30" id="h16-0-30" class="i">+ok
</a><b>diff --git a/<a id="h17" href="../file/src/sql/testscripts/schema/drop_table_transaction.html">src/sql/testscripts/schema/drop_table_transaction</a> b/<a href="../file/src/sql/testscripts/schema/drop_table_transaction.html">src/sql/testscripts/schema/drop_table_transaction</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -0,0 +1,80 @@
</a><a href="#h17-0-0" id="h17-0-0" class="i">+# Tests that DROP TABLE is transactional.
</a><a href="#h17-0-1" id="h17-0-1" class="i">+
</a><a href="#h17-0-2" id="h17-0-2" class="i">+&gt; CREATE TABLE name (id INT PRIMARY KEY, value STRING)
</a><a href="#h17-0-3" id="h17-0-3" class="i">+&gt; INSERT INTO name VALUES (1, &#39;a&#39;), (2, &#39;b&#39;)
</a><a href="#h17-0-4" id="h17-0-4" class="i">+---
</a><a href="#h17-0-5" id="h17-0-5" class="i">+ok
</a><a href="#h17-0-6" id="h17-0-6" class="i">+
</a><a href="#h17-0-7" id="h17-0-7" class="i">+dump
</a><a href="#h17-0-8" id="h17-0-8" class="i">+---
</a><a href="#h17-0-9" id="h17-0-9" class="i">+mvcc:NextVersion → 3 [&quot;\x00&quot; → &quot;\x03&quot;]
</a><a href="#h17-0-10" id="h17-0-10" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
</a><a href="#h17-0-11" id="h17-0-11" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 2) → Integer(1),String(&quot;a&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h17-0-12" id="h17-0-12" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 2) → Integer(2),String(&quot;b&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h17-0-13" id="h17-0-13" class="i">+
</a><a href="#h17-0-14" id="h17-0-14" class="i">+# Drop the table in a transaction.
</a><a href="#h17-0-15" id="h17-0-15" class="i">+&gt; BEGIN
</a><a href="#h17-0-16" id="h17-0-16" class="i">+[ops]&gt; DROP TABLE name
</a><a href="#h17-0-17" id="h17-0-17" class="i">+---
</a><a href="#h17-0-18" id="h17-0-18" class="i">+storage set mvcc:TxnWrite(3, sql:Table(&quot;name&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x00\xffname\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h17-0-19" id="h17-0-19" class="i">+storage set mvcc:Version(sql:Table(&quot;name&quot;), 3) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h17-0-20" id="h17-0-20" class="i">+storage set mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(1))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
</a><a href="#h17-0-21" id="h17-0-21" class="i">+storage set mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h17-0-22" id="h17-0-22" class="i">+storage set mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(2))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
</a><a href="#h17-0-23" id="h17-0-23" class="i">+storage set mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h17-0-24" id="h17-0-24" class="i">+
</a><a href="#h17-0-25" id="h17-0-25" class="i">+schema
</a><a href="#h17-0-26" id="h17-0-26" class="i">+---
</a><a href="#h17-0-27" id="h17-0-27" class="i">+ok
</a><a href="#h17-0-28" id="h17-0-28" class="i">+
</a><a href="#h17-0-29" id="h17-0-29" class="i">+dump
</a><a href="#h17-0-30" id="h17-0-30" class="i">+---
</a><a href="#h17-0-31" id="h17-0-31" class="i">+mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
</a><a href="#h17-0-32" id="h17-0-32" class="i">+mvcc:TxnActive(3) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;&quot;]
</a><a href="#h17-0-33" id="h17-0-33" class="i">+mvcc:TxnWrite(3, sql:Table(&quot;name&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x00\xffname\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h17-0-34" id="h17-0-34" class="i">+mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(1))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
</a><a href="#h17-0-35" id="h17-0-35" class="i">+mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(2))) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
</a><a href="#h17-0-36" id="h17-0-36" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
</a><a href="#h17-0-37" id="h17-0-37" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 3) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h17-0-38" id="h17-0-38" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 2) → Integer(1),String(&quot;a&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h17-0-39" id="h17-0-39" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h17-0-40" id="h17-0-40" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 2) → Integer(2),String(&quot;b&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h17-0-41" id="h17-0-41" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h17-0-42" id="h17-0-42" class="i">+
</a><a href="#h17-0-43" id="h17-0-43" class="i">+# Rolling it back undoes it.
</a><a href="#h17-0-44" id="h17-0-44" class="i">+[ops]&gt; ROLLBACK
</a><a href="#h17-0-45" id="h17-0-45" class="i">+---
</a><a href="#h17-0-46" id="h17-0-46" class="i">+storage delete mvcc:Version(sql:Table(&quot;name&quot;), 3) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
</a><a href="#h17-0-47" id="h17-0-47" class="i">+storage delete mvcc:TxnWrite(3, sql:Table(&quot;name&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x00\xffname\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h17-0-48" id="h17-0-48" class="i">+storage delete mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 3) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
</a><a href="#h17-0-49" id="h17-0-49" class="i">+storage delete mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(1))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
</a><a href="#h17-0-50" id="h17-0-50" class="i">+storage delete mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 3) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
</a><a href="#h17-0-51" id="h17-0-51" class="i">+storage delete mvcc:TxnWrite(3, sql:Row(&quot;name&quot;, Integer(2))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
</a><a href="#h17-0-52" id="h17-0-52" class="i">+storage delete mvcc:TxnActive(3) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
</a><a href="#h17-0-53" id="h17-0-53" class="i">+
</a><a href="#h17-0-54" id="h17-0-54" class="i">+dump
</a><a href="#h17-0-55" id="h17-0-55" class="i">+---
</a><a href="#h17-0-56" id="h17-0-56" class="i">+mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
</a><a href="#h17-0-57" id="h17-0-57" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
</a><a href="#h17-0-58" id="h17-0-58" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 2) → Integer(1),String(&quot;a&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h17-0-59" id="h17-0-59" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 2) → Integer(2),String(&quot;b&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h17-0-60" id="h17-0-60" class="i">+
</a><a href="#h17-0-61" id="h17-0-61" class="i">+# Committing the drop also works.
</a><a href="#h17-0-62" id="h17-0-62" class="i">+&gt; BEGIN
</a><a href="#h17-0-63" id="h17-0-63" class="i">+&gt; DROP TABLE name
</a><a href="#h17-0-64" id="h17-0-64" class="i">+[ops]&gt; COMMIT
</a><a href="#h17-0-65" id="h17-0-65" class="i">+---
</a><a href="#h17-0-66" id="h17-0-66" class="i">+storage delete mvcc:TxnWrite(4, sql:Table(&quot;name&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x00\xffname\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h17-0-67" id="h17-0-67" class="i">+storage delete mvcc:TxnWrite(4, sql:Row(&quot;name&quot;, Integer(1))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
</a><a href="#h17-0-68" id="h17-0-68" class="i">+storage delete mvcc:TxnWrite(4, sql:Row(&quot;name&quot;, Integer(2))) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
</a><a href="#h17-0-69" id="h17-0-69" class="i">+storage delete mvcc:TxnActive(4) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x04&quot;]
</a><a href="#h17-0-70" id="h17-0-70" class="i">+
</a><a href="#h17-0-71" id="h17-0-71" class="i">+dump
</a><a href="#h17-0-72" id="h17-0-72" class="i">+---
</a><a href="#h17-0-73" id="h17-0-73" class="i">+mvcc:NextVersion → 5 [&quot;\x00&quot; → &quot;\x05&quot;]
</a><a href="#h17-0-74" id="h17-0-74" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
</a><a href="#h17-0-75" id="h17-0-75" class="i">+mvcc:Version(sql:Table(&quot;name&quot;), 4) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x00&quot;]
</a><a href="#h17-0-76" id="h17-0-76" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 2) → Integer(1),String(&quot;a&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h17-0-77" id="h17-0-77" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(1)), 4) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x00&quot;]
</a><a href="#h17-0-78" id="h17-0-78" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 2) → Integer(2),String(&quot;b&quot;) [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h17-0-79" id="h17-0-79" class="i">+mvcc:Version(sql:Row(&quot;name&quot;, Integer(2)), 4) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x00&quot;]
</a><b>diff --git a/<a id="h18" href="../file/src/storage/mvcc.rs.html">src/storage/mvcc.rs</a> b/<a href="../file/src/storage/mvcc.rs.html">src/storage/mvcc.rs</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -224,7 +224,7 @@ impl&lt;&#39;a&gt; encoding::Key&lt;&#39;a&gt; for KeyPrefix&lt;&#39;a&gt; {}
</a> /// MVCC engine applies commands one at a time from the Raft log, which will
 /// serialize them anyway.
 pub struct MVCC&lt;E: Engine&gt; {
<a href="#h18-0-3" id="h18-0-3" class="d">-    engine: Arc&lt;Mutex&lt;E&gt;&gt;,
</a><a href="#h18-0-4" id="h18-0-4" class="i">+    pub(crate) engine: Arc&lt;Mutex&lt;E&gt;&gt;,
</a> }
 
 impl&lt;E: Engine&gt; MVCC&lt;E&gt; {
<b>diff --git a/<a id="h19" href="../file/tests/sql/schema.rs.html">tests/sql/schema.rs</a> b/<a href="../file/tests/sql/schema.rs.html">tests/sql/schema.rs</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -52,114 +52,6 @@ macro_rules! test_schema {
</a>     }
 }
 
<a href="#h19-0-3" id="h19-0-3" class="d">-test_schema! {
</a><a href="#h19-0-4" id="h19-0-4" class="d">-    create_table_bare: &quot;CREATE TABLE&quot;,
</a><a href="#h19-0-5" id="h19-0-5" class="d">-    create_table_datatype: r#&quot;
</a><a href="#h19-0-6" id="h19-0-6" class="d">-        CREATE TABLE name (
</a><a href="#h19-0-7" id="h19-0-7" class="d">-            id INTEGER PRIMARY KEY,
</a><a href="#h19-0-8" id="h19-0-8" class="d">-            &quot;bool&quot; BOOL,
</a><a href="#h19-0-9" id="h19-0-9" class="d">-            &quot;boolean&quot; BOOLEAN,
</a><a href="#h19-0-10" id="h19-0-10" class="d">-            &quot;double&quot; DOUBLE,
</a><a href="#h19-0-11" id="h19-0-11" class="d">-            &quot;float&quot; FLOAT,
</a><a href="#h19-0-12" id="h19-0-12" class="d">-            &quot;int&quot; INT,
</a><a href="#h19-0-13" id="h19-0-13" class="d">-            &quot;integer&quot; INTEGER,
</a><a href="#h19-0-14" id="h19-0-14" class="d">-            &quot;string&quot; STRING,
</a><a href="#h19-0-15" id="h19-0-15" class="d">-            &quot;text&quot; TEXT,
</a><a href="#h19-0-16" id="h19-0-16" class="d">-            &quot;varchar&quot; VARCHAR
</a><a href="#h19-0-17" id="h19-0-17" class="d">-        )
</a><a href="#h19-0-18" id="h19-0-18" class="d">-    &quot;#,
</a><a href="#h19-0-19" id="h19-0-19" class="d">-    create_table_datatype_missing: &quot;CREATE TABLE name (id)&quot;,
</a><a href="#h19-0-20" id="h19-0-20" class="d">-    create_table_datatype_null: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value NULL)&quot;,
</a><a href="#h19-0-21" id="h19-0-21" class="d">-
</a><a href="#h19-0-22" id="h19-0-22" class="d">-    create_table_name_alphanumeric: &quot;CREATE TABLE a_123 (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-23" id="h19-0-23" class="d">-    create_table_name_case: &quot;CREATE TABLE mIxEd_cAsE (ÄÅÆ STRING PRIMARY KEY)&quot;,
</a><a href="#h19-0-24" id="h19-0-24" class="d">-    create_table_name_emoji: &quot;CREATE TABLE 👋 (🆔 INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-25" id="h19-0-25" class="d">-    create_table_name_emoji_quoted: r#&quot;CREATE TABLE &quot;👋&quot; (&quot;🆔&quot; INTEGER PRIMARY KEY)&quot;#,
</a><a href="#h19-0-26" id="h19-0-26" class="d">-    create_table_name_japanese: &quot;CREATE TABLE 表 (身元 INTEGER PRIMARY KEY, 名前 STRING)&quot;,
</a><a href="#h19-0-27" id="h19-0-27" class="d">-    create_table_name_keyword: &quot;CREATE TABLE table (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-28" id="h19-0-28" class="d">-    create_table_name_keyword_quoted: r#&quot;CREATE TABLE &quot;table&quot; (id INTEGER PRIMARY KEY)&quot;#,
</a><a href="#h19-0-29" id="h19-0-29" class="d">-    create_table_name_missing: &quot;CREATE TABLE (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-30" id="h19-0-30" class="d">-    create_table_name_quote_single: r#&quot;CREATE TABLE &#39;name&#39; (id INTEGER PRIMARY KEY)&quot;#,
</a><a href="#h19-0-31" id="h19-0-31" class="d">-    create_table_name_quote_double: r#&quot;CREATE TABLE &quot;name&quot; (id INTEGER PRIMARY KEY)&quot;#,
</a><a href="#h19-0-32" id="h19-0-32" class="d">-    create_table_name_quote_double_unterminated: r#&quot;CREATE TABLE &quot;name (id INTEGER PRIMARY KEY)&quot;#,
</a><a href="#h19-0-33" id="h19-0-33" class="d">-    create_table_name_quote_double_escaped: r#&quot;CREATE TABLE &quot;name with &quot;&quot; quote&quot; (id INTEGER PRIMARY KEY)&quot;#,
</a><a href="#h19-0-34" id="h19-0-34" class="d">-    create_table_name_quote_double_single: r#&quot;CREATE TABLE &quot;name with &#39; quote&quot; (id INTEGER PRIMARY KEY)&quot;#,
</a><a href="#h19-0-35" id="h19-0-35" class="d">-    create_table_name_underscore_prefix: &quot;CREATE TABLE _name (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-36" id="h19-0-36" class="d">-
</a><a href="#h19-0-37" id="h19-0-37" class="d">-    create_table_columns_empty: &quot;CREATE TABLE name ()&quot;,
</a><a href="#h19-0-38" id="h19-0-38" class="d">-    create_table_columns_missing: &quot;CREATE TABLE name&quot;,
</a><a href="#h19-0-39" id="h19-0-39" class="d">-
</a><a href="#h19-0-40" id="h19-0-40" class="d">-    create_table_pk_missing: &quot;CREATE TABLE name (id INTEGER)&quot;,
</a><a href="#h19-0-41" id="h19-0-41" class="d">-    create_table_pk_multiple: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, name STRING PRIMARY KEY)&quot;,
</a><a href="#h19-0-42" id="h19-0-42" class="d">-    create_table_pk_nullable: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY NULL)&quot;,
</a><a href="#h19-0-43" id="h19-0-43" class="d">-    create_table_pk_default: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY DEFAULT 1)&quot;,
</a><a href="#h19-0-44" id="h19-0-44" class="d">-    create_table_pk_unique: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY UNIQUE)&quot;,
</a><a href="#h19-0-45" id="h19-0-45" class="d">-
</a><a href="#h19-0-46" id="h19-0-46" class="d">-    create_table_null: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NULL)&quot;,
</a><a href="#h19-0-47" id="h19-0-47" class="d">-    create_table_null_not: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL)&quot;,
</a><a href="#h19-0-48" id="h19-0-48" class="d">-    create_table_null_not_null: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NULL NOT NULL)&quot;,
</a><a href="#h19-0-49" id="h19-0-49" class="d">-    create_table_null_default: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING)&quot;,
</a><a href="#h19-0-50" id="h19-0-50" class="d">-
</a><a href="#h19-0-51" id="h19-0-51" class="d">-    create_table_default_boolean: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value BOOLEAN DEFAULT TRUE)&quot;,
</a><a href="#h19-0-52" id="h19-0-52" class="d">-    create_table_default_float: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value FLOAT DEFAULT 3.14)&quot;,
</a><a href="#h19-0-53" id="h19-0-53" class="d">-    create_table_default_integer: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 7)&quot;,
</a><a href="#h19-0-54" id="h19-0-54" class="d">-    create_table_default_string: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT &#39;foo&#39;)&quot;,
</a><a href="#h19-0-55" id="h19-0-55" class="d">-    create_table_default_null: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT NULL)&quot;,
</a><a href="#h19-0-56" id="h19-0-56" class="d">-    create_table_default_null_not: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL DEFAULT NULL)&quot;,
</a><a href="#h19-0-57" id="h19-0-57" class="d">-    create_table_default_expr: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 1 + 2 * 3)&quot;,
</a><a href="#h19-0-58" id="h19-0-58" class="d">-    create_table_default_conflict: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT 7)&quot;,
</a><a href="#h19-0-59" id="h19-0-59" class="d">-    create_table_default_conflict_float_integer: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value FLOAT DEFAULT 7)&quot;,
</a><a href="#h19-0-60" id="h19-0-60" class="d">-    create_table_default_conflict_integer_float: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 3.14)&quot;,
</a><a href="#h19-0-61" id="h19-0-61" class="d">-
</a><a href="#h19-0-62" id="h19-0-62" class="d">-    create_table_index: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING INDEX)&quot;,
</a><a href="#h19-0-63" id="h19-0-63" class="d">-    create_table_index_pk: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY INDEX, value STRING)&quot;,
</a><a href="#h19-0-64" id="h19-0-64" class="d">-
</a><a href="#h19-0-65" id="h19-0-65" class="d">-    create_table_unique: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING UNIQUE)&quot;,
</a><a href="#h19-0-66" id="h19-0-66" class="d">-    create_table_unique_null: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NULL UNIQUE)&quot;,
</a><a href="#h19-0-67" id="h19-0-67" class="d">-    create_table_unique_not_null: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL UNIQUE)&quot;,
</a><a href="#h19-0-68" id="h19-0-68" class="d">-    create_table_unique_default: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT &#39;foo&#39; UNIQUE)&quot;,
</a><a href="#h19-0-69" id="h19-0-69" class="d">-}
</a><a href="#h19-0-70" id="h19-0-70" class="d">-test_schema! { with [&quot;CREATE TABLE test (id INTEGER PRIMARY KEY)&quot;];
</a><a href="#h19-0-71" id="h19-0-71" class="d">-    create_table_exists: &quot;CREATE TABLE test (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-72" id="h19-0-72" class="d">-
</a><a href="#h19-0-73" id="h19-0-73" class="d">-    create_table_ref: &quot;CREATE TABLE other (id INTEGER PRIMARY KEY, test_id INTEGER REFERENCES test)&quot;,
</a><a href="#h19-0-74" id="h19-0-74" class="d">-    create_table_ref_multiple: &quot;CREATE TABLE other (
</a><a href="#h19-0-75" id="h19-0-75" class="d">-        id INTEGER PRIMARY KEY,
</a><a href="#h19-0-76" id="h19-0-76" class="d">-        test_id_a INTEGER REFERENCES test,
</a><a href="#h19-0-77" id="h19-0-77" class="d">-        test_id_b INTEGER REFERENCES test,
</a><a href="#h19-0-78" id="h19-0-78" class="d">-        test_id_c INTEGER REFERENCES test
</a><a href="#h19-0-79" id="h19-0-79" class="d">-    )&quot;,
</a><a href="#h19-0-80" id="h19-0-80" class="d">-    create_table_ref_missing: &quot;CREATE TABLE other (id INTEGER PRIMARY KEY, missing_id INTEGER REFERENCES missing)&quot;,
</a><a href="#h19-0-81" id="h19-0-81" class="d">-    create_table_ref_type: &quot;CREATE TABLE other (id INTEGER PRIMARY KEY, test_id STRING REFERENCES test)&quot;,
</a><a href="#h19-0-82" id="h19-0-82" class="d">-    create_table_ref_self: &quot;CREATE TABLE other (id INTEGER PRIMARY KEY, self_id INTEGER REFERENCES other)&quot;,
</a><a href="#h19-0-83" id="h19-0-83" class="d">-    create_table_ref_self_type: &quot;CREATE TABLE other (id INTEGER PRIMARY KEY, self_id STRING REFERENCES other)&quot;,
</a><a href="#h19-0-84" id="h19-0-84" class="d">-}
</a><a href="#h19-0-85" id="h19-0-85" class="d">-
</a><a href="#h19-0-86" id="h19-0-86" class="d">-test_schema! { with [
</a><a href="#h19-0-87" id="h19-0-87" class="d">-        &quot;CREATE TABLE a (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-88" id="h19-0-88" class="d">-        &quot;INSERT INTO a VALUES (11), (12), (13)&quot;,
</a><a href="#h19-0-89" id="h19-0-89" class="d">-        &quot;CREATE TABLE b (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-90" id="h19-0-90" class="d">-        &quot;INSERT INTO b VALUES (21), (22), (23)&quot;,
</a><a href="#h19-0-91" id="h19-0-91" class="d">-        &quot;CREATE TABLE c (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-92" id="h19-0-92" class="d">-        &quot;INSERT INTO c VALUES (31), (32), (33)&quot;,
</a><a href="#h19-0-93" id="h19-0-93" class="d">-    ];
</a><a href="#h19-0-94" id="h19-0-94" class="d">-    drop_table: &quot;DROP TABLE a&quot;,
</a><a href="#h19-0-95" id="h19-0-95" class="d">-    drop_table_bare: &quot;DROP TABLE&quot;,
</a><a href="#h19-0-96" id="h19-0-96" class="d">-    drop_table_missing: &quot;DROP TABLE name&quot;,
</a><a href="#h19-0-97" id="h19-0-97" class="d">-    drop_table_multiple: &quot;DROP TABLE a, c&quot;,
</a><a href="#h19-0-98" id="h19-0-98" class="d">-    drop_table_if_exists: &quot;DROP TABLE IF EXISTS a&quot;,
</a><a href="#h19-0-99" id="h19-0-99" class="d">-    drop_table_if_exists_missing: &quot;DROP TABLE IF EXISTS name&quot;,
</a><a href="#h19-0-100" id="h19-0-100" class="d">-}
</a><a href="#h19-0-101" id="h19-0-101" class="d">-test_schema! { with [
</a><a href="#h19-0-102" id="h19-0-102" class="d">-        &quot;CREATE TABLE target (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h19-0-103" id="h19-0-103" class="d">-        &quot;CREATE TABLE source (id INTEGER PRIMARY KEY, target_id INTEGER REFERENCES target)&quot;,
</a><a href="#h19-0-104" id="h19-0-104" class="d">-        &quot;CREATE TABLE self (id INTEGER PRIMARY KEY, self_id INTEGER REFERENCES self)&quot;,
</a><a href="#h19-0-105" id="h19-0-105" class="d">-    ];
</a><a href="#h19-0-106" id="h19-0-106" class="d">-    drop_table_ref_source: &quot;DROP TABLE source&quot;,
</a><a href="#h19-0-107" id="h19-0-107" class="d">-    drop_table_ref_target: &quot;DROP TABLE target&quot;,
</a><a href="#h19-0-108" id="h19-0-108" class="d">-    drop_table_ref_self: &quot;DROP TABLE self&quot;,
</a><a href="#h19-0-109" id="h19-0-109" class="d">-}
</a><a href="#h19-0-110" id="h19-0-110" class="d">-
</a> test_schema! { with [
         r#&quot;CREATE TABLE types (
             id INTEGER PRIMARY KEY,
<b>diff --git a/<a id="h20" href="../file/tests/sql/schema/create_table_alphanumeric.html">tests/sql/schema/create_table_alphanumeric</a> b/<a href="../file/tests/sql/schema/create_table_alphanumeric.html">tests/sql/schema/create_table_alphanumeric</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h20-0-0" id="h20-0-0" class="d">-Query: CREATE TABLE a_123 (id INTEGER PRIMARY KEY)
</a><a href="#h20-0-1" id="h20-0-1" class="d">-Result: ok
</a><a href="#h20-0-2" id="h20-0-2" class="d">-
</a><a href="#h20-0-3" id="h20-0-3" class="d">-Storage:
</a><a href="#h20-0-4" id="h20-0-4" class="d">-CREATE TABLE a_123 (
</a><a href="#h20-0-5" id="h20-0-5" class="d">-  id INTEGER PRIMARY KEY NOT NULL
</a><a href="#h20-0-6" id="h20-0-6" class="d">-)
</a><b>diff --git a/<a id="h21" href="../file/tests/sql/schema/create_table_bare.html">tests/sql/schema/create_table_bare</a> b/<a href="../file/tests/sql/schema/create_table_bare.html">tests/sql/schema/create_table_bare</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h21-0-0" id="h21-0-0" class="d">-Query: CREATE TABLE
</a><a href="#h21-0-1" id="h21-0-1" class="d">-Error: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h21-0-2" id="h21-0-2" class="d">-
</a><a href="#h21-0-3" id="h21-0-3" class="d">-Storage:
</a><a href="#h21-0-4" id="h21-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h22" href="../file/tests/sql/schema/create_table_columns_empty.html">tests/sql/schema/create_table_columns_empty</a> b/<a href="../file/tests/sql/schema/create_table_columns_empty.html">tests/sql/schema/create_table_columns_empty</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h22-0-0" id="h22-0-0" class="d">-Query: CREATE TABLE name ()
</a><a href="#h22-0-1" id="h22-0-1" class="d">-Error: InvalidInput(&quot;expected identifier, got )&quot;)
</a><a href="#h22-0-2" id="h22-0-2" class="d">-
</a><a href="#h22-0-3" id="h22-0-3" class="d">-Storage:
</a><a href="#h22-0-4" id="h22-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h23" href="../file/tests/sql/schema/create_table_columns_missing.html">tests/sql/schema/create_table_columns_missing</a> b/<a href="../file/tests/sql/schema/create_table_columns_missing.html">tests/sql/schema/create_table_columns_missing</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h23-0-0" id="h23-0-0" class="d">-Query: CREATE TABLE name
</a><a href="#h23-0-1" id="h23-0-1" class="d">-Error: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h23-0-2" id="h23-0-2" class="d">-
</a><a href="#h23-0-3" id="h23-0-3" class="d">-Storage:
</a><a href="#h23-0-4" id="h23-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h24" href="../file/tests/sql/schema/create_table_datatype.html">tests/sql/schema/create_table_datatype</a> b/<a href="../file/tests/sql/schema/create_table_datatype.html">tests/sql/schema/create_table_datatype</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -1,27 +0,0 @@
</a><a href="#h24-0-0" id="h24-0-0" class="d">-Query: CREATE TABLE name (
</a><a href="#h24-0-1" id="h24-0-1" class="d">-            id INTEGER PRIMARY KEY,
</a><a href="#h24-0-2" id="h24-0-2" class="d">-            &quot;bool&quot; BOOL,
</a><a href="#h24-0-3" id="h24-0-3" class="d">-            &quot;boolean&quot; BOOLEAN,
</a><a href="#h24-0-4" id="h24-0-4" class="d">-            &quot;double&quot; DOUBLE,
</a><a href="#h24-0-5" id="h24-0-5" class="d">-            &quot;float&quot; FLOAT,
</a><a href="#h24-0-6" id="h24-0-6" class="d">-            &quot;int&quot; INT,
</a><a href="#h24-0-7" id="h24-0-7" class="d">-            &quot;integer&quot; INTEGER,
</a><a href="#h24-0-8" id="h24-0-8" class="d">-            &quot;string&quot; STRING,
</a><a href="#h24-0-9" id="h24-0-9" class="d">-            &quot;text&quot; TEXT,
</a><a href="#h24-0-10" id="h24-0-10" class="d">-            &quot;varchar&quot; VARCHAR
</a><a href="#h24-0-11" id="h24-0-11" class="d">-        )
</a><a href="#h24-0-12" id="h24-0-12" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h24-0-13" id="h24-0-13" class="d">-
</a><a href="#h24-0-14" id="h24-0-14" class="d">-Storage:
</a><a href="#h24-0-15" id="h24-0-15" class="d">-CREATE TABLE name (
</a><a href="#h24-0-16" id="h24-0-16" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h24-0-17" id="h24-0-17" class="d">-  &quot;bool&quot; BOOLEAN DEFAULT NULL,
</a><a href="#h24-0-18" id="h24-0-18" class="d">-  &quot;boolean&quot; BOOLEAN DEFAULT NULL,
</a><a href="#h24-0-19" id="h24-0-19" class="d">-  &quot;double&quot; FLOAT DEFAULT NULL,
</a><a href="#h24-0-20" id="h24-0-20" class="d">-  &quot;float&quot; FLOAT DEFAULT NULL,
</a><a href="#h24-0-21" id="h24-0-21" class="d">-  &quot;int&quot; INTEGER DEFAULT NULL,
</a><a href="#h24-0-22" id="h24-0-22" class="d">-  &quot;integer&quot; INTEGER DEFAULT NULL,
</a><a href="#h24-0-23" id="h24-0-23" class="d">-  &quot;string&quot; STRING DEFAULT NULL,
</a><a href="#h24-0-24" id="h24-0-24" class="d">-  &quot;text&quot; STRING DEFAULT NULL,
</a><a href="#h24-0-25" id="h24-0-25" class="d">-  &quot;varchar&quot; STRING DEFAULT NULL
</a><a href="#h24-0-26" id="h24-0-26" class="d">-)
</a><b>diff --git a/<a id="h25" href="../file/tests/sql/schema/create_table_datatype_missing.html">tests/sql/schema/create_table_datatype_missing</a> b/<a href="../file/tests/sql/schema/create_table_datatype_missing.html">tests/sql/schema/create_table_datatype_missing</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h25-0-0" id="h25-0-0" class="d">-Query: CREATE TABLE name (id)
</a><a href="#h25-0-1" id="h25-0-1" class="d">-Error: InvalidInput(&quot;unexpected token )&quot;)
</a><a href="#h25-0-2" id="h25-0-2" class="d">-
</a><a href="#h25-0-3" id="h25-0-3" class="d">-Storage:
</a><a href="#h25-0-4" id="h25-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h26" href="../file/tests/sql/schema/create_table_datatype_null.html">tests/sql/schema/create_table_datatype_null</a> b/<a href="../file/tests/sql/schema/create_table_datatype_null.html">tests/sql/schema/create_table_datatype_null</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h26-0-0" id="h26-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value NULL)
</a><a href="#h26-0-1" id="h26-0-1" class="d">-Error: InvalidInput(&quot;unexpected token NULL&quot;)
</a><a href="#h26-0-2" id="h26-0-2" class="d">-
</a><a href="#h26-0-3" id="h26-0-3" class="d">-Storage:
</a><a href="#h26-0-4" id="h26-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h27" href="../file/tests/sql/schema/create_table_default_boolean.html">tests/sql/schema/create_table_default_boolean</a> b/<a href="../file/tests/sql/schema/create_table_default_boolean.html">tests/sql/schema/create_table_default_boolean</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h27-0-0" id="h27-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value BOOLEAN DEFAULT TRUE)
</a><a href="#h27-0-1" id="h27-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h27-0-2" id="h27-0-2" class="d">-
</a><a href="#h27-0-3" id="h27-0-3" class="d">-Storage:
</a><a href="#h27-0-4" id="h27-0-4" class="d">-CREATE TABLE name (
</a><a href="#h27-0-5" id="h27-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h27-0-6" id="h27-0-6" class="d">-  value BOOLEAN DEFAULT TRUE
</a><a href="#h27-0-7" id="h27-0-7" class="d">-)
</a><b>diff --git a/<a id="h28" href="../file/tests/sql/schema/create_table_default_conflict.html">tests/sql/schema/create_table_default_conflict</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict.html">tests/sql/schema/create_table_default_conflict</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h28-0-0" id="h28-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT 7)
</a><a href="#h28-0-1" id="h28-0-1" class="d">-Error: InvalidInput(&quot;invalid datatype INTEGER for STRING column value&quot;)
</a><a href="#h28-0-2" id="h28-0-2" class="d">-
</a><a href="#h28-0-3" id="h28-0-3" class="d">-Storage:
</a><a href="#h28-0-4" id="h28-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h29" href="../file/tests/sql/schema/create_table_default_conflict_float_integer.html">tests/sql/schema/create_table_default_conflict_float_integer</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict_float_integer.html">tests/sql/schema/create_table_default_conflict_float_integer</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h29-0-0" id="h29-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value FLOAT DEFAULT 7)
</a><a href="#h29-0-1" id="h29-0-1" class="d">-Error: InvalidInput(&quot;invalid datatype INTEGER for FLOAT column value&quot;)
</a><a href="#h29-0-2" id="h29-0-2" class="d">-
</a><a href="#h29-0-3" id="h29-0-3" class="d">-Storage:
</a><a href="#h29-0-4" id="h29-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h30" href="../file/tests/sql/schema/create_table_default_conflict_integer_float.html">tests/sql/schema/create_table_default_conflict_integer_float</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict_integer_float.html">tests/sql/schema/create_table_default_conflict_integer_float</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h30-0-0" id="h30-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 3.14)
</a><a href="#h30-0-1" id="h30-0-1" class="d">-Error: InvalidInput(&quot;invalid datatype FLOAT for INTEGER column value&quot;)
</a><a href="#h30-0-2" id="h30-0-2" class="d">-
</a><a href="#h30-0-3" id="h30-0-3" class="d">-Storage:
</a><a href="#h30-0-4" id="h30-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h31" href="../file/tests/sql/schema/create_table_default_expr.html">tests/sql/schema/create_table_default_expr</a> b/<a href="../file/tests/sql/schema/create_table_default_expr.html">tests/sql/schema/create_table_default_expr</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h31-0-0" id="h31-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 1 + 2 * 3)
</a><a href="#h31-0-1" id="h31-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h31-0-2" id="h31-0-2" class="d">-
</a><a href="#h31-0-3" id="h31-0-3" class="d">-Storage:
</a><a href="#h31-0-4" id="h31-0-4" class="d">-CREATE TABLE name (
</a><a href="#h31-0-5" id="h31-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h31-0-6" id="h31-0-6" class="d">-  value INTEGER DEFAULT 7
</a><a href="#h31-0-7" id="h31-0-7" class="d">-)
</a><b>diff --git a/<a id="h32" href="../file/tests/sql/schema/create_table_default_float.html">tests/sql/schema/create_table_default_float</a> b/<a href="../file/tests/sql/schema/create_table_default_float.html">tests/sql/schema/create_table_default_float</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h32-0-0" id="h32-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value FLOAT DEFAULT 3.14)
</a><a href="#h32-0-1" id="h32-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h32-0-2" id="h32-0-2" class="d">-
</a><a href="#h32-0-3" id="h32-0-3" class="d">-Storage:
</a><a href="#h32-0-4" id="h32-0-4" class="d">-CREATE TABLE name (
</a><a href="#h32-0-5" id="h32-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h32-0-6" id="h32-0-6" class="d">-  value FLOAT DEFAULT 3.14
</a><a href="#h32-0-7" id="h32-0-7" class="d">-)
</a><b>diff --git a/<a id="h33" href="../file/tests/sql/schema/create_table_default_integer.html">tests/sql/schema/create_table_default_integer</a> b/<a href="../file/tests/sql/schema/create_table_default_integer.html">tests/sql/schema/create_table_default_integer</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h33-0-0" id="h33-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 7)
</a><a href="#h33-0-1" id="h33-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h33-0-2" id="h33-0-2" class="d">-
</a><a href="#h33-0-3" id="h33-0-3" class="d">-Storage:
</a><a href="#h33-0-4" id="h33-0-4" class="d">-CREATE TABLE name (
</a><a href="#h33-0-5" id="h33-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h33-0-6" id="h33-0-6" class="d">-  value INTEGER DEFAULT 7
</a><a href="#h33-0-7" id="h33-0-7" class="d">-)
</a><b>diff --git a/<a id="h34" href="../file/tests/sql/schema/create_table_default_null.html">tests/sql/schema/create_table_default_null</a> b/<a href="../file/tests/sql/schema/create_table_default_null.html">tests/sql/schema/create_table_default_null</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h34-0-0" id="h34-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT NULL)
</a><a href="#h34-0-1" id="h34-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h34-0-2" id="h34-0-2" class="d">-
</a><a href="#h34-0-3" id="h34-0-3" class="d">-Storage:
</a><a href="#h34-0-4" id="h34-0-4" class="d">-CREATE TABLE name (
</a><a href="#h34-0-5" id="h34-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h34-0-6" id="h34-0-6" class="d">-  value STRING DEFAULT NULL
</a><a href="#h34-0-7" id="h34-0-7" class="d">-)
</a><b>diff --git a/<a id="h35" href="../file/tests/sql/schema/create_table_default_null_not.html">tests/sql/schema/create_table_default_null_not</a> b/<a href="../file/tests/sql/schema/create_table_default_null_not.html">tests/sql/schema/create_table_default_null_not</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h35-0-0" id="h35-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL DEFAULT NULL)
</a><a href="#h35-0-1" id="h35-0-1" class="d">-Error: InvalidInput(&quot;invalid NULL default for non-nullable column value&quot;)
</a><a href="#h35-0-2" id="h35-0-2" class="d">-
</a><a href="#h35-0-3" id="h35-0-3" class="d">-Storage:
</a><a href="#h35-0-4" id="h35-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h36" href="../file/tests/sql/schema/create_table_default_string.html">tests/sql/schema/create_table_default_string</a> b/<a href="../file/tests/sql/schema/create_table_default_string.html">tests/sql/schema/create_table_default_string</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h36-0-0" id="h36-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT &#39;foo&#39;)
</a><a href="#h36-0-1" id="h36-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h36-0-2" id="h36-0-2" class="d">-
</a><a href="#h36-0-3" id="h36-0-3" class="d">-Storage:
</a><a href="#h36-0-4" id="h36-0-4" class="d">-CREATE TABLE name (
</a><a href="#h36-0-5" id="h36-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h36-0-6" id="h36-0-6" class="d">-  value STRING DEFAULT foo
</a><a href="#h36-0-7" id="h36-0-7" class="d">-)
</a><b>diff --git a/<a id="h37" href="../file/tests/sql/schema/create_table_exists.html">tests/sql/schema/create_table_exists</a> b/<a href="../file/tests/sql/schema/create_table_exists.html">tests/sql/schema/create_table_exists</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h37-0-0" id="h37-0-0" class="d">-Query: CREATE TABLE test (id INTEGER PRIMARY KEY)
</a><a href="#h37-0-1" id="h37-0-1" class="d">-Error: InvalidInput(&quot;table test already exists&quot;)
</a><a href="#h37-0-2" id="h37-0-2" class="d">-
</a><a href="#h37-0-3" id="h37-0-3" class="d">-Storage:
</a><a href="#h37-0-4" id="h37-0-4" class="d">-CREATE TABLE test (
</a><a href="#h37-0-5" id="h37-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h37-0-6" id="h37-0-6" class="d">-)
</a><b>diff --git a/<a id="h38" href="../file/tests/sql/schema/create_table_index.html">tests/sql/schema/create_table_index</a> b/<a href="../file/tests/sql/schema/create_table_index.html">tests/sql/schema/create_table_index</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -1,10 +0,0 @@
</a><a href="#h38-0-0" id="h38-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING INDEX)
</a><a href="#h38-0-1" id="h38-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h38-0-2" id="h38-0-2" class="d">-
</a><a href="#h38-0-3" id="h38-0-3" class="d">-Storage:
</a><a href="#h38-0-4" id="h38-0-4" class="d">-CREATE TABLE name (
</a><a href="#h38-0-5" id="h38-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h38-0-6" id="h38-0-6" class="d">-  value STRING DEFAULT NULL INDEX
</a><a href="#h38-0-7" id="h38-0-7" class="d">-)
</a><a href="#h38-0-8" id="h38-0-8" class="d">-
</a><a href="#h38-0-9" id="h38-0-9" class="d">-Index name.value
</a><b>diff --git a/<a id="h39" href="../file/tests/sql/schema/create_table_index_pk.html">tests/sql/schema/create_table_index_pk</a> b/<a href="../file/tests/sql/schema/create_table_index_pk.html">tests/sql/schema/create_table_index_pk</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h39-0-0" id="h39-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY INDEX, value STRING)
</a><a href="#h39-0-1" id="h39-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h39-0-2" id="h39-0-2" class="d">-
</a><a href="#h39-0-3" id="h39-0-3" class="d">-Storage:
</a><a href="#h39-0-4" id="h39-0-4" class="d">-CREATE TABLE name (
</a><a href="#h39-0-5" id="h39-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h39-0-6" id="h39-0-6" class="d">-  value STRING DEFAULT NULL
</a><a href="#h39-0-7" id="h39-0-7" class="d">-)
</a><b>diff --git a/<a id="h40" href="../file/tests/sql/schema/create_table_name_alphanumeric.html">tests/sql/schema/create_table_name_alphanumeric</a> b/<a href="../file/tests/sql/schema/create_table_name_alphanumeric.html">tests/sql/schema/create_table_name_alphanumeric</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h40-0-0" id="h40-0-0" class="d">-Query: CREATE TABLE a_123 (id INTEGER PRIMARY KEY)
</a><a href="#h40-0-1" id="h40-0-1" class="d">-Result: CreateTable { name: &quot;a_123&quot; }
</a><a href="#h40-0-2" id="h40-0-2" class="d">-
</a><a href="#h40-0-3" id="h40-0-3" class="d">-Storage:
</a><a href="#h40-0-4" id="h40-0-4" class="d">-CREATE TABLE a_123 (
</a><a href="#h40-0-5" id="h40-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h40-0-6" id="h40-0-6" class="d">-)
</a><b>diff --git a/<a id="h41" href="../file/tests/sql/schema/create_table_name_case.html">tests/sql/schema/create_table_name_case</a> b/<a href="../file/tests/sql/schema/create_table_name_case.html">tests/sql/schema/create_table_name_case</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h41-0-0" id="h41-0-0" class="d">-Query: CREATE TABLE mIxEd_cAsE (ÄÅÆ STRING PRIMARY KEY)
</a><a href="#h41-0-1" id="h41-0-1" class="d">-Result: CreateTable { name: &quot;mixed_case&quot; }
</a><a href="#h41-0-2" id="h41-0-2" class="d">-
</a><a href="#h41-0-3" id="h41-0-3" class="d">-Storage:
</a><a href="#h41-0-4" id="h41-0-4" class="d">-CREATE TABLE mixed_case (
</a><a href="#h41-0-5" id="h41-0-5" class="d">-  äåæ STRING PRIMARY KEY
</a><a href="#h41-0-6" id="h41-0-6" class="d">-)
</a><b>diff --git a/<a id="h42" href="../file/tests/sql/schema/create_table_name_emoji.html">tests/sql/schema/create_table_name_emoji</a> b/<a href="../file/tests/sql/schema/create_table_name_emoji.html">tests/sql/schema/create_table_name_emoji</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h42-0-0" id="h42-0-0" class="d">-Query: CREATE TABLE 👋 (🆔 INTEGER PRIMARY KEY)
</a><a href="#h42-0-1" id="h42-0-1" class="d">-Error: InvalidInput(&quot;unexpected character 👋&quot;)
</a><a href="#h42-0-2" id="h42-0-2" class="d">-
</a><a href="#h42-0-3" id="h42-0-3" class="d">-Storage:
</a><a href="#h42-0-4" id="h42-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h43" href="../file/tests/sql/schema/create_table_name_emoji_quoted.html">tests/sql/schema/create_table_name_emoji_quoted</a> b/<a href="../file/tests/sql/schema/create_table_name_emoji_quoted.html">tests/sql/schema/create_table_name_emoji_quoted</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h43-0-0" id="h43-0-0" class="d">-Query: CREATE TABLE &quot;👋&quot; (&quot;🆔&quot; INTEGER PRIMARY KEY)
</a><a href="#h43-0-1" id="h43-0-1" class="d">-Result: CreateTable { name: &quot;👋&quot; }
</a><a href="#h43-0-2" id="h43-0-2" class="d">-
</a><a href="#h43-0-3" id="h43-0-3" class="d">-Storage:
</a><a href="#h43-0-4" id="h43-0-4" class="d">-CREATE TABLE &quot;👋&quot; (
</a><a href="#h43-0-5" id="h43-0-5" class="d">-  &quot;🆔&quot; INTEGER PRIMARY KEY
</a><a href="#h43-0-6" id="h43-0-6" class="d">-)
</a><b>diff --git a/<a id="h44" href="../file/tests/sql/schema/create_table_name_japanese.html">tests/sql/schema/create_table_name_japanese</a> b/<a href="../file/tests/sql/schema/create_table_name_japanese.html">tests/sql/schema/create_table_name_japanese</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h44-0-0" id="h44-0-0" class="d">-Query: CREATE TABLE 表 (身元 INTEGER PRIMARY KEY, 名前 STRING)
</a><a href="#h44-0-1" id="h44-0-1" class="d">-Result: CreateTable { name: &quot;表&quot; }
</a><a href="#h44-0-2" id="h44-0-2" class="d">-
</a><a href="#h44-0-3" id="h44-0-3" class="d">-Storage:
</a><a href="#h44-0-4" id="h44-0-4" class="d">-CREATE TABLE 表 (
</a><a href="#h44-0-5" id="h44-0-5" class="d">-  身元 INTEGER PRIMARY KEY,
</a><a href="#h44-0-6" id="h44-0-6" class="d">-  名前 STRING DEFAULT NULL
</a><a href="#h44-0-7" id="h44-0-7" class="d">-)
</a><b>diff --git a/<a id="h45" href="../file/tests/sql/schema/create_table_name_keyword.html">tests/sql/schema/create_table_name_keyword</a> b/<a href="../file/tests/sql/schema/create_table_name_keyword.html">tests/sql/schema/create_table_name_keyword</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h45-0-0" id="h45-0-0" class="d">-Query: CREATE TABLE table (id INTEGER PRIMARY KEY)
</a><a href="#h45-0-1" id="h45-0-1" class="d">-Error: InvalidInput(&quot;expected identifier, got TABLE&quot;)
</a><a href="#h45-0-2" id="h45-0-2" class="d">-
</a><a href="#h45-0-3" id="h45-0-3" class="d">-Storage:
</a><a href="#h45-0-4" id="h45-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h46" href="../file/tests/sql/schema/create_table_name_keyword_quoted.html">tests/sql/schema/create_table_name_keyword_quoted</a> b/<a href="../file/tests/sql/schema/create_table_name_keyword_quoted.html">tests/sql/schema/create_table_name_keyword_quoted</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h46-0-0" id="h46-0-0" class="d">-Query: CREATE TABLE &quot;table&quot; (id INTEGER PRIMARY KEY)
</a><a href="#h46-0-1" id="h46-0-1" class="d">-Result: CreateTable { name: &quot;table&quot; }
</a><a href="#h46-0-2" id="h46-0-2" class="d">-
</a><a href="#h46-0-3" id="h46-0-3" class="d">-Storage:
</a><a href="#h46-0-4" id="h46-0-4" class="d">-CREATE TABLE &quot;table&quot; (
</a><a href="#h46-0-5" id="h46-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h46-0-6" id="h46-0-6" class="d">-)
</a><b>diff --git a/<a id="h47" href="../file/tests/sql/schema/create_table_name_missing.html">tests/sql/schema/create_table_name_missing</a> b/<a href="../file/tests/sql/schema/create_table_name_missing.html">tests/sql/schema/create_table_name_missing</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h47-0-0" id="h47-0-0" class="d">-Query: CREATE TABLE (id INTEGER PRIMARY KEY)
</a><a href="#h47-0-1" id="h47-0-1" class="d">-Error: InvalidInput(&quot;expected identifier, got (&quot;)
</a><a href="#h47-0-2" id="h47-0-2" class="d">-
</a><a href="#h47-0-3" id="h47-0-3" class="d">-Storage:
</a><a href="#h47-0-4" id="h47-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h48" href="../file/tests/sql/schema/create_table_name_quote_double.html">tests/sql/schema/create_table_name_quote_double</a> b/<a href="../file/tests/sql/schema/create_table_name_quote_double.html">tests/sql/schema/create_table_name_quote_double</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h48-0-0" id="h48-0-0" class="d">-Query: CREATE TABLE &quot;name&quot; (id INTEGER PRIMARY KEY)
</a><a href="#h48-0-1" id="h48-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h48-0-2" id="h48-0-2" class="d">-
</a><a href="#h48-0-3" id="h48-0-3" class="d">-Storage:
</a><a href="#h48-0-4" id="h48-0-4" class="d">-CREATE TABLE name (
</a><a href="#h48-0-5" id="h48-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h48-0-6" id="h48-0-6" class="d">-)
</a><b>diff --git a/<a id="h49" href="../file/tests/sql/schema/create_table_name_quote_double_escaped.html">tests/sql/schema/create_table_name_quote_double_escaped</a> b/<a href="../file/tests/sql/schema/create_table_name_quote_double_escaped.html">tests/sql/schema/create_table_name_quote_double_escaped</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h49-0-0" id="h49-0-0" class="d">-Query: CREATE TABLE &quot;name with &quot;&quot; quote&quot; (id INTEGER PRIMARY KEY)
</a><a href="#h49-0-1" id="h49-0-1" class="d">-Result: CreateTable { name: &quot;name with \&quot; quote&quot; }
</a><a href="#h49-0-2" id="h49-0-2" class="d">-
</a><a href="#h49-0-3" id="h49-0-3" class="d">-Storage:
</a><a href="#h49-0-4" id="h49-0-4" class="d">-CREATE TABLE &quot;name with &quot;&quot; quote&quot; (
</a><a href="#h49-0-5" id="h49-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h49-0-6" id="h49-0-6" class="d">-)
</a><b>diff --git a/<a id="h50" href="../file/tests/sql/schema/create_table_name_quote_double_single.html">tests/sql/schema/create_table_name_quote_double_single</a> b/<a href="../file/tests/sql/schema/create_table_name_quote_double_single.html">tests/sql/schema/create_table_name_quote_double_single</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h50-0-0" id="h50-0-0" class="d">-Query: CREATE TABLE &quot;name with &#39; quote&quot; (id INTEGER PRIMARY KEY)
</a><a href="#h50-0-1" id="h50-0-1" class="d">-Result: CreateTable { name: &quot;name with &#39; quote&quot; }
</a><a href="#h50-0-2" id="h50-0-2" class="d">-
</a><a href="#h50-0-3" id="h50-0-3" class="d">-Storage:
</a><a href="#h50-0-4" id="h50-0-4" class="d">-CREATE TABLE &quot;name with &#39; quote&quot; (
</a><a href="#h50-0-5" id="h50-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h50-0-6" id="h50-0-6" class="d">-)
</a><b>diff --git a/<a id="h51" href="../file/tests/sql/schema/create_table_name_quote_double_unterminated.html">tests/sql/schema/create_table_name_quote_double_unterminated</a> b/<a href="../file/tests/sql/schema/create_table_name_quote_double_unterminated.html">tests/sql/schema/create_table_name_quote_double_unterminated</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h51-0-0" id="h51-0-0" class="d">-Query: CREATE TABLE &quot;name (id INTEGER PRIMARY KEY)
</a><a href="#h51-0-1" id="h51-0-1" class="d">-Error: InvalidInput(&quot;unexpected end of quoted identifier&quot;)
</a><a href="#h51-0-2" id="h51-0-2" class="d">-
</a><a href="#h51-0-3" id="h51-0-3" class="d">-Storage:
</a><a href="#h51-0-4" id="h51-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h52" href="../file/tests/sql/schema/create_table_name_quote_single.html">tests/sql/schema/create_table_name_quote_single</a> b/<a href="../file/tests/sql/schema/create_table_name_quote_single.html">tests/sql/schema/create_table_name_quote_single</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h52-0-0" id="h52-0-0" class="d">-Query: CREATE TABLE &#39;name&#39; (id INTEGER PRIMARY KEY)
</a><a href="#h52-0-1" id="h52-0-1" class="d">-Error: InvalidInput(&quot;expected identifier, got name&quot;)
</a><a href="#h52-0-2" id="h52-0-2" class="d">-
</a><a href="#h52-0-3" id="h52-0-3" class="d">-Storage:
</a><a href="#h52-0-4" id="h52-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h53" href="../file/tests/sql/schema/create_table_name_underscore_prefix.html">tests/sql/schema/create_table_name_underscore_prefix</a> b/<a href="../file/tests/sql/schema/create_table_name_underscore_prefix.html">tests/sql/schema/create_table_name_underscore_prefix</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h53-0-0" id="h53-0-0" class="d">-Query: CREATE TABLE _name (id INTEGER PRIMARY KEY)
</a><a href="#h53-0-1" id="h53-0-1" class="d">-Error: InvalidInput(&quot;unexpected character _&quot;)
</a><a href="#h53-0-2" id="h53-0-2" class="d">-
</a><a href="#h53-0-3" id="h53-0-3" class="d">-Storage:
</a><a href="#h53-0-4" id="h53-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h54" href="../file/tests/sql/schema/create_table_null.html">tests/sql/schema/create_table_null</a> b/<a href="../file/tests/sql/schema/create_table_null.html">tests/sql/schema/create_table_null</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h54-0-0" id="h54-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NULL)
</a><a href="#h54-0-1" id="h54-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h54-0-2" id="h54-0-2" class="d">-
</a><a href="#h54-0-3" id="h54-0-3" class="d">-Storage:
</a><a href="#h54-0-4" id="h54-0-4" class="d">-CREATE TABLE name (
</a><a href="#h54-0-5" id="h54-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h54-0-6" id="h54-0-6" class="d">-  value STRING DEFAULT NULL
</a><a href="#h54-0-7" id="h54-0-7" class="d">-)
</a><b>diff --git a/<a id="h55" href="../file/tests/sql/schema/create_table_null_default.html">tests/sql/schema/create_table_null_default</a> b/<a href="../file/tests/sql/schema/create_table_null_default.html">tests/sql/schema/create_table_null_default</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h55-0-0" id="h55-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING)
</a><a href="#h55-0-1" id="h55-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h55-0-2" id="h55-0-2" class="d">-
</a><a href="#h55-0-3" id="h55-0-3" class="d">-Storage:
</a><a href="#h55-0-4" id="h55-0-4" class="d">-CREATE TABLE name (
</a><a href="#h55-0-5" id="h55-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h55-0-6" id="h55-0-6" class="d">-  value STRING DEFAULT NULL
</a><a href="#h55-0-7" id="h55-0-7" class="d">-)
</a><b>diff --git a/<a id="h56" href="../file/tests/sql/schema/create_table_null_not.html">tests/sql/schema/create_table_null_not</a> b/<a href="../file/tests/sql/schema/create_table_null_not.html">tests/sql/schema/create_table_null_not</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h56-0-0" id="h56-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL)
</a><a href="#h56-0-1" id="h56-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h56-0-2" id="h56-0-2" class="d">-
</a><a href="#h56-0-3" id="h56-0-3" class="d">-Storage:
</a><a href="#h56-0-4" id="h56-0-4" class="d">-CREATE TABLE name (
</a><a href="#h56-0-5" id="h56-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h56-0-6" id="h56-0-6" class="d">-  value STRING NOT NULL
</a><a href="#h56-0-7" id="h56-0-7" class="d">-)
</a><b>diff --git a/<a id="h57" href="../file/tests/sql/schema/create_table_null_not_null.html">tests/sql/schema/create_table_null_not_null</a> b/<a href="../file/tests/sql/schema/create_table_null_not_null.html">tests/sql/schema/create_table_null_not_null</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h57-0-0" id="h57-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NULL NOT NULL)
</a><a href="#h57-0-1" id="h57-0-1" class="d">-Error: InvalidInput(&quot;nullability already set for column value&quot;)
</a><a href="#h57-0-2" id="h57-0-2" class="d">-
</a><a href="#h57-0-3" id="h57-0-3" class="d">-Storage:
</a><a href="#h57-0-4" id="h57-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h58" href="../file/tests/sql/schema/create_table_pk_default.html">tests/sql/schema/create_table_pk_default</a> b/<a href="../file/tests/sql/schema/create_table_pk_default.html">tests/sql/schema/create_table_pk_default</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h58-0-0" id="h58-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY DEFAULT 1)
</a><a href="#h58-0-1" id="h58-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h58-0-2" id="h58-0-2" class="d">-
</a><a href="#h58-0-3" id="h58-0-3" class="d">-Storage:
</a><a href="#h58-0-4" id="h58-0-4" class="d">-CREATE TABLE name (
</a><a href="#h58-0-5" id="h58-0-5" class="d">-  id INTEGER PRIMARY KEY DEFAULT 1
</a><a href="#h58-0-6" id="h58-0-6" class="d">-)
</a><b>diff --git a/<a id="h59" href="../file/tests/sql/schema/create_table_pk_missing.html">tests/sql/schema/create_table_pk_missing</a> b/<a href="../file/tests/sql/schema/create_table_pk_missing.html">tests/sql/schema/create_table_pk_missing</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h59-0-0" id="h59-0-0" class="d">-Query: CREATE TABLE name (id INTEGER)
</a><a href="#h59-0-1" id="h59-0-1" class="d">-Error: InvalidInput(&quot;no primary key for table name&quot;)
</a><a href="#h59-0-2" id="h59-0-2" class="d">-
</a><a href="#h59-0-3" id="h59-0-3" class="d">-Storage:
</a><a href="#h59-0-4" id="h59-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h60" href="../file/tests/sql/schema/create_table_pk_multiple.html">tests/sql/schema/create_table_pk_multiple</a> b/<a href="../file/tests/sql/schema/create_table_pk_multiple.html">tests/sql/schema/create_table_pk_multiple</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h60-0-0" id="h60-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, name STRING PRIMARY KEY)
</a><a href="#h60-0-1" id="h60-0-1" class="d">-Error: InvalidInput(&quot;multiple primary keys for table name&quot;)
</a><a href="#h60-0-2" id="h60-0-2" class="d">-
</a><a href="#h60-0-3" id="h60-0-3" class="d">-Storage:
</a><a href="#h60-0-4" id="h60-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h61" href="../file/tests/sql/schema/create_table_pk_nullable.html">tests/sql/schema/create_table_pk_nullable</a> b/<a href="../file/tests/sql/schema/create_table_pk_nullable.html">tests/sql/schema/create_table_pk_nullable</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -1,4 +0,0 @@
</a><a href="#h61-0-0" id="h61-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY NULL)
</a><a href="#h61-0-1" id="h61-0-1" class="d">-Error: InvalidInput(&quot;primary key id cannot be nullable&quot;)
</a><a href="#h61-0-2" id="h61-0-2" class="d">-
</a><a href="#h61-0-3" id="h61-0-3" class="d">-Storage:
</a><a href="#h61-0-4" id="h61-0-4" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h62" href="../file/tests/sql/schema/create_table_pk_unique.html">tests/sql/schema/create_table_pk_unique</a> b/<a href="../file/tests/sql/schema/create_table_pk_unique.html">tests/sql/schema/create_table_pk_unique</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h62-0-0" id="h62-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY UNIQUE)
</a><a href="#h62-0-1" id="h62-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h62-0-2" id="h62-0-2" class="d">-
</a><a href="#h62-0-3" id="h62-0-3" class="d">-Storage:
</a><a href="#h62-0-4" id="h62-0-4" class="d">-CREATE TABLE name (
</a><a href="#h62-0-5" id="h62-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h62-0-6" id="h62-0-6" class="d">-)
</a><b>diff --git a/<a id="h63" href="../file/tests/sql/schema/create_table_ref.html">tests/sql/schema/create_table_ref</a> b/<a href="../file/tests/sql/schema/create_table_ref.html">tests/sql/schema/create_table_ref</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -1,14 +0,0 @@
</a><a href="#h63-0-0" id="h63-0-0" class="d">-Query: CREATE TABLE other (id INTEGER PRIMARY KEY, test_id INTEGER REFERENCES test)
</a><a href="#h63-0-1" id="h63-0-1" class="d">-Result: CreateTable { name: &quot;other&quot; }
</a><a href="#h63-0-2" id="h63-0-2" class="d">-
</a><a href="#h63-0-3" id="h63-0-3" class="d">-Storage:
</a><a href="#h63-0-4" id="h63-0-4" class="d">-CREATE TABLE other (
</a><a href="#h63-0-5" id="h63-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h63-0-6" id="h63-0-6" class="d">-  test_id INTEGER DEFAULT NULL INDEX REFERENCES test
</a><a href="#h63-0-7" id="h63-0-7" class="d">-)
</a><a href="#h63-0-8" id="h63-0-8" class="d">-
</a><a href="#h63-0-9" id="h63-0-9" class="d">-Index other.test_id
</a><a href="#h63-0-10" id="h63-0-10" class="d">-
</a><a href="#h63-0-11" id="h63-0-11" class="d">-CREATE TABLE test (
</a><a href="#h63-0-12" id="h63-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h63-0-13" id="h63-0-13" class="d">-)
</a><b>diff --git a/<a id="h64" href="../file/tests/sql/schema/create_table_ref_missing.html">tests/sql/schema/create_table_ref_missing</a> b/<a href="../file/tests/sql/schema/create_table_ref_missing.html">tests/sql/schema/create_table_ref_missing</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h64-0-0" id="h64-0-0" class="d">-Query: CREATE TABLE other (id INTEGER PRIMARY KEY, missing_id INTEGER REFERENCES missing)
</a><a href="#h64-0-1" id="h64-0-1" class="d">-Error: InvalidInput(&quot;unknown table missing referenced by column missing_id&quot;)
</a><a href="#h64-0-2" id="h64-0-2" class="d">-
</a><a href="#h64-0-3" id="h64-0-3" class="d">-Storage:
</a><a href="#h64-0-4" id="h64-0-4" class="d">-CREATE TABLE test (
</a><a href="#h64-0-5" id="h64-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h64-0-6" id="h64-0-6" class="d">-)
</a><b>diff --git a/<a id="h65" href="../file/tests/sql/schema/create_table_ref_multiple.html">tests/sql/schema/create_table_ref_multiple</a> b/<a href="../file/tests/sql/schema/create_table_ref_multiple.html">tests/sql/schema/create_table_ref_multiple</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -1,25 +0,0 @@
</a><a href="#h65-0-0" id="h65-0-0" class="d">-Query: CREATE TABLE other (
</a><a href="#h65-0-1" id="h65-0-1" class="d">-        id INTEGER PRIMARY KEY,
</a><a href="#h65-0-2" id="h65-0-2" class="d">-        test_id_a INTEGER REFERENCES test,
</a><a href="#h65-0-3" id="h65-0-3" class="d">-        test_id_b INTEGER REFERENCES test,
</a><a href="#h65-0-4" id="h65-0-4" class="d">-        test_id_c INTEGER REFERENCES test
</a><a href="#h65-0-5" id="h65-0-5" class="d">-    )
</a><a href="#h65-0-6" id="h65-0-6" class="d">-Result: CreateTable { name: &quot;other&quot; }
</a><a href="#h65-0-7" id="h65-0-7" class="d">-
</a><a href="#h65-0-8" id="h65-0-8" class="d">-Storage:
</a><a href="#h65-0-9" id="h65-0-9" class="d">-CREATE TABLE other (
</a><a href="#h65-0-10" id="h65-0-10" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h65-0-11" id="h65-0-11" class="d">-  test_id_a INTEGER DEFAULT NULL INDEX REFERENCES test,
</a><a href="#h65-0-12" id="h65-0-12" class="d">-  test_id_b INTEGER DEFAULT NULL INDEX REFERENCES test,
</a><a href="#h65-0-13" id="h65-0-13" class="d">-  test_id_c INTEGER DEFAULT NULL INDEX REFERENCES test
</a><a href="#h65-0-14" id="h65-0-14" class="d">-)
</a><a href="#h65-0-15" id="h65-0-15" class="d">-
</a><a href="#h65-0-16" id="h65-0-16" class="d">-Index other.test_id_a
</a><a href="#h65-0-17" id="h65-0-17" class="d">-
</a><a href="#h65-0-18" id="h65-0-18" class="d">-Index other.test_id_b
</a><a href="#h65-0-19" id="h65-0-19" class="d">-
</a><a href="#h65-0-20" id="h65-0-20" class="d">-Index other.test_id_c
</a><a href="#h65-0-21" id="h65-0-21" class="d">-
</a><a href="#h65-0-22" id="h65-0-22" class="d">-CREATE TABLE test (
</a><a href="#h65-0-23" id="h65-0-23" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h65-0-24" id="h65-0-24" class="d">-)
</a><b>diff --git a/<a id="h66" href="../file/tests/sql/schema/create_table_ref_self.html">tests/sql/schema/create_table_ref_self</a> b/<a href="../file/tests/sql/schema/create_table_ref_self.html">tests/sql/schema/create_table_ref_self</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -1,14 +0,0 @@
</a><a href="#h66-0-0" id="h66-0-0" class="d">-Query: CREATE TABLE other (id INTEGER PRIMARY KEY, self_id INTEGER REFERENCES other)
</a><a href="#h66-0-1" id="h66-0-1" class="d">-Result: CreateTable { name: &quot;other&quot; }
</a><a href="#h66-0-2" id="h66-0-2" class="d">-
</a><a href="#h66-0-3" id="h66-0-3" class="d">-Storage:
</a><a href="#h66-0-4" id="h66-0-4" class="d">-CREATE TABLE other (
</a><a href="#h66-0-5" id="h66-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h66-0-6" id="h66-0-6" class="d">-  self_id INTEGER DEFAULT NULL INDEX REFERENCES other
</a><a href="#h66-0-7" id="h66-0-7" class="d">-)
</a><a href="#h66-0-8" id="h66-0-8" class="d">-
</a><a href="#h66-0-9" id="h66-0-9" class="d">-Index other.self_id
</a><a href="#h66-0-10" id="h66-0-10" class="d">-
</a><a href="#h66-0-11" id="h66-0-11" class="d">-CREATE TABLE test (
</a><a href="#h66-0-12" id="h66-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h66-0-13" id="h66-0-13" class="d">-)
</a><b>diff --git a/<a id="h67" href="../file/tests/sql/schema/create_table_ref_self_type.html">tests/sql/schema/create_table_ref_self_type</a> b/<a href="../file/tests/sql/schema/create_table_ref_self_type.html">tests/sql/schema/create_table_ref_self_type</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h67-0-0" id="h67-0-0" class="d">-Query: CREATE TABLE other (id INTEGER PRIMARY KEY, self_id STRING REFERENCES other)
</a><a href="#h67-0-1" id="h67-0-1" class="d">-Error: InvalidInput(&quot;can&#39;t reference INTEGER primary key of other from STRING column self_id&quot;)
</a><a href="#h67-0-2" id="h67-0-2" class="d">-
</a><a href="#h67-0-3" id="h67-0-3" class="d">-Storage:
</a><a href="#h67-0-4" id="h67-0-4" class="d">-CREATE TABLE test (
</a><a href="#h67-0-5" id="h67-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h67-0-6" id="h67-0-6" class="d">-)
</a><b>diff --git a/<a id="h68" href="../file/tests/sql/schema/create_table_ref_type.html">tests/sql/schema/create_table_ref_type</a> b/<a href="../file/tests/sql/schema/create_table_ref_type.html">tests/sql/schema/create_table_ref_type</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h68-0-0" id="h68-0-0" class="d">-Query: CREATE TABLE other (id INTEGER PRIMARY KEY, test_id STRING REFERENCES test)
</a><a href="#h68-0-1" id="h68-0-1" class="d">-Error: InvalidInput(&quot;can&#39;t reference INTEGER primary key of test from STRING column test_id&quot;)
</a><a href="#h68-0-2" id="h68-0-2" class="d">-
</a><a href="#h68-0-3" id="h68-0-3" class="d">-Storage:
</a><a href="#h68-0-4" id="h68-0-4" class="d">-CREATE TABLE test (
</a><a href="#h68-0-5" id="h68-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h68-0-6" id="h68-0-6" class="d">-)
</a><b>diff --git a/<a id="h69" href="../file/tests/sql/schema/create_table_unique.html">tests/sql/schema/create_table_unique</a> b/<a href="../file/tests/sql/schema/create_table_unique.html">tests/sql/schema/create_table_unique</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -1,10 +0,0 @@
</a><a href="#h69-0-0" id="h69-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING UNIQUE)
</a><a href="#h69-0-1" id="h69-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h69-0-2" id="h69-0-2" class="d">-
</a><a href="#h69-0-3" id="h69-0-3" class="d">-Storage:
</a><a href="#h69-0-4" id="h69-0-4" class="d">-CREATE TABLE name (
</a><a href="#h69-0-5" id="h69-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h69-0-6" id="h69-0-6" class="d">-  value STRING DEFAULT NULL UNIQUE INDEX
</a><a href="#h69-0-7" id="h69-0-7" class="d">-)
</a><a href="#h69-0-8" id="h69-0-8" class="d">-
</a><a href="#h69-0-9" id="h69-0-9" class="d">-Index name.value
</a><b>diff --git a/<a id="h70" href="../file/tests/sql/schema/create_table_unique_default.html">tests/sql/schema/create_table_unique_default</a> b/<a href="../file/tests/sql/schema/create_table_unique_default.html">tests/sql/schema/create_table_unique_default</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -1,10 +0,0 @@
</a><a href="#h70-0-0" id="h70-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT &#39;foo&#39; UNIQUE)
</a><a href="#h70-0-1" id="h70-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h70-0-2" id="h70-0-2" class="d">-
</a><a href="#h70-0-3" id="h70-0-3" class="d">-Storage:
</a><a href="#h70-0-4" id="h70-0-4" class="d">-CREATE TABLE name (
</a><a href="#h70-0-5" id="h70-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h70-0-6" id="h70-0-6" class="d">-  value STRING DEFAULT foo UNIQUE INDEX
</a><a href="#h70-0-7" id="h70-0-7" class="d">-)
</a><a href="#h70-0-8" id="h70-0-8" class="d">-
</a><a href="#h70-0-9" id="h70-0-9" class="d">-Index name.value
</a><b>diff --git a/<a id="h71" href="../file/tests/sql/schema/create_table_unique_not_null.html">tests/sql/schema/create_table_unique_not_null</a> b/<a href="../file/tests/sql/schema/create_table_unique_not_null.html">tests/sql/schema/create_table_unique_not_null</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -1,10 +0,0 @@
</a><a href="#h71-0-0" id="h71-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL UNIQUE)
</a><a href="#h71-0-1" id="h71-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h71-0-2" id="h71-0-2" class="d">-
</a><a href="#h71-0-3" id="h71-0-3" class="d">-Storage:
</a><a href="#h71-0-4" id="h71-0-4" class="d">-CREATE TABLE name (
</a><a href="#h71-0-5" id="h71-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h71-0-6" id="h71-0-6" class="d">-  value STRING NOT NULL UNIQUE INDEX
</a><a href="#h71-0-7" id="h71-0-7" class="d">-)
</a><a href="#h71-0-8" id="h71-0-8" class="d">-
</a><a href="#h71-0-9" id="h71-0-9" class="d">-Index name.value
</a><b>diff --git a/<a id="h72" href="../file/tests/sql/schema/create_table_unique_null.html">tests/sql/schema/create_table_unique_null</a> b/<a href="../file/tests/sql/schema/create_table_unique_null.html">tests/sql/schema/create_table_unique_null</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -1,10 +0,0 @@
</a><a href="#h72-0-0" id="h72-0-0" class="d">-Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NULL UNIQUE)
</a><a href="#h72-0-1" id="h72-0-1" class="d">-Result: CreateTable { name: &quot;name&quot; }
</a><a href="#h72-0-2" id="h72-0-2" class="d">-
</a><a href="#h72-0-3" id="h72-0-3" class="d">-Storage:
</a><a href="#h72-0-4" id="h72-0-4" class="d">-CREATE TABLE name (
</a><a href="#h72-0-5" id="h72-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h72-0-6" id="h72-0-6" class="d">-  value STRING DEFAULT NULL UNIQUE INDEX
</a><a href="#h72-0-7" id="h72-0-7" class="d">-)
</a><a href="#h72-0-8" id="h72-0-8" class="d">-
</a><a href="#h72-0-9" id="h72-0-9" class="d">-Index name.value
</a><b>diff --git a/<a id="h73" href="../file/tests/sql/schema/drop_table.html">tests/sql/schema/drop_table</a> b/<a href="../file/tests/sql/schema/drop_table.html">tests/sql/schema/drop_table</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -1,17 +0,0 @@
</a><a href="#h73-0-0" id="h73-0-0" class="d">-Query: DROP TABLE a
</a><a href="#h73-0-1" id="h73-0-1" class="d">-Result: DropTable { name: &quot;a&quot;, existed: true }
</a><a href="#h73-0-2" id="h73-0-2" class="d">-
</a><a href="#h73-0-3" id="h73-0-3" class="d">-Storage:
</a><a href="#h73-0-4" id="h73-0-4" class="d">-CREATE TABLE b (
</a><a href="#h73-0-5" id="h73-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h73-0-6" id="h73-0-6" class="d">-)
</a><a href="#h73-0-7" id="h73-0-7" class="d">-[Integer(21)]
</a><a href="#h73-0-8" id="h73-0-8" class="d">-[Integer(22)]
</a><a href="#h73-0-9" id="h73-0-9" class="d">-[Integer(23)]
</a><a href="#h73-0-10" id="h73-0-10" class="d">-
</a><a href="#h73-0-11" id="h73-0-11" class="d">-CREATE TABLE c (
</a><a href="#h73-0-12" id="h73-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h73-0-13" id="h73-0-13" class="d">-)
</a><a href="#h73-0-14" id="h73-0-14" class="d">-[Integer(31)]
</a><a href="#h73-0-15" id="h73-0-15" class="d">-[Integer(32)]
</a><a href="#h73-0-16" id="h73-0-16" class="d">-[Integer(33)]
</a><b>diff --git a/<a id="h74" href="../file/tests/sql/schema/drop_table_bare.html">tests/sql/schema/drop_table_bare</a> b/<a href="../file/tests/sql/schema/drop_table_bare.html">tests/sql/schema/drop_table_bare</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -1,24 +0,0 @@
</a><a href="#h74-0-0" id="h74-0-0" class="d">-Query: DROP TABLE
</a><a href="#h74-0-1" id="h74-0-1" class="d">-Error: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h74-0-2" id="h74-0-2" class="d">-
</a><a href="#h74-0-3" id="h74-0-3" class="d">-Storage:
</a><a href="#h74-0-4" id="h74-0-4" class="d">-CREATE TABLE a (
</a><a href="#h74-0-5" id="h74-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h74-0-6" id="h74-0-6" class="d">-)
</a><a href="#h74-0-7" id="h74-0-7" class="d">-[Integer(11)]
</a><a href="#h74-0-8" id="h74-0-8" class="d">-[Integer(12)]
</a><a href="#h74-0-9" id="h74-0-9" class="d">-[Integer(13)]
</a><a href="#h74-0-10" id="h74-0-10" class="d">-
</a><a href="#h74-0-11" id="h74-0-11" class="d">-CREATE TABLE b (
</a><a href="#h74-0-12" id="h74-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h74-0-13" id="h74-0-13" class="d">-)
</a><a href="#h74-0-14" id="h74-0-14" class="d">-[Integer(21)]
</a><a href="#h74-0-15" id="h74-0-15" class="d">-[Integer(22)]
</a><a href="#h74-0-16" id="h74-0-16" class="d">-[Integer(23)]
</a><a href="#h74-0-17" id="h74-0-17" class="d">-
</a><a href="#h74-0-18" id="h74-0-18" class="d">-CREATE TABLE c (
</a><a href="#h74-0-19" id="h74-0-19" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h74-0-20" id="h74-0-20" class="d">-)
</a><a href="#h74-0-21" id="h74-0-21" class="d">-[Integer(31)]
</a><a href="#h74-0-22" id="h74-0-22" class="d">-[Integer(32)]
</a><a href="#h74-0-23" id="h74-0-23" class="d">-[Integer(33)]
</a><b>diff --git a/<a id="h75" href="../file/tests/sql/schema/drop_table_if_exists.html">tests/sql/schema/drop_table_if_exists</a> b/<a href="../file/tests/sql/schema/drop_table_if_exists.html">tests/sql/schema/drop_table_if_exists</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -1,17 +0,0 @@
</a><a href="#h75-0-0" id="h75-0-0" class="d">-Query: DROP TABLE IF EXISTS a
</a><a href="#h75-0-1" id="h75-0-1" class="d">-Result: DropTable { name: &quot;a&quot;, existed: true }
</a><a href="#h75-0-2" id="h75-0-2" class="d">-
</a><a href="#h75-0-3" id="h75-0-3" class="d">-Storage:
</a><a href="#h75-0-4" id="h75-0-4" class="d">-CREATE TABLE b (
</a><a href="#h75-0-5" id="h75-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h75-0-6" id="h75-0-6" class="d">-)
</a><a href="#h75-0-7" id="h75-0-7" class="d">-[Integer(21)]
</a><a href="#h75-0-8" id="h75-0-8" class="d">-[Integer(22)]
</a><a href="#h75-0-9" id="h75-0-9" class="d">-[Integer(23)]
</a><a href="#h75-0-10" id="h75-0-10" class="d">-
</a><a href="#h75-0-11" id="h75-0-11" class="d">-CREATE TABLE c (
</a><a href="#h75-0-12" id="h75-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h75-0-13" id="h75-0-13" class="d">-)
</a><a href="#h75-0-14" id="h75-0-14" class="d">-[Integer(31)]
</a><a href="#h75-0-15" id="h75-0-15" class="d">-[Integer(32)]
</a><a href="#h75-0-16" id="h75-0-16" class="d">-[Integer(33)]
</a><b>diff --git a/<a id="h76" href="../file/tests/sql/schema/drop_table_if_exists_missing.html">tests/sql/schema/drop_table_if_exists_missing</a> b/<a href="../file/tests/sql/schema/drop_table_if_exists_missing.html">tests/sql/schema/drop_table_if_exists_missing</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -1,24 +0,0 @@
</a><a href="#h76-0-0" id="h76-0-0" class="d">-Query: DROP TABLE IF EXISTS name
</a><a href="#h76-0-1" id="h76-0-1" class="d">-Result: DropTable { name: &quot;name&quot;, existed: false }
</a><a href="#h76-0-2" id="h76-0-2" class="d">-
</a><a href="#h76-0-3" id="h76-0-3" class="d">-Storage:
</a><a href="#h76-0-4" id="h76-0-4" class="d">-CREATE TABLE a (
</a><a href="#h76-0-5" id="h76-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h76-0-6" id="h76-0-6" class="d">-)
</a><a href="#h76-0-7" id="h76-0-7" class="d">-[Integer(11)]
</a><a href="#h76-0-8" id="h76-0-8" class="d">-[Integer(12)]
</a><a href="#h76-0-9" id="h76-0-9" class="d">-[Integer(13)]
</a><a href="#h76-0-10" id="h76-0-10" class="d">-
</a><a href="#h76-0-11" id="h76-0-11" class="d">-CREATE TABLE b (
</a><a href="#h76-0-12" id="h76-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h76-0-13" id="h76-0-13" class="d">-)
</a><a href="#h76-0-14" id="h76-0-14" class="d">-[Integer(21)]
</a><a href="#h76-0-15" id="h76-0-15" class="d">-[Integer(22)]
</a><a href="#h76-0-16" id="h76-0-16" class="d">-[Integer(23)]
</a><a href="#h76-0-17" id="h76-0-17" class="d">-
</a><a href="#h76-0-18" id="h76-0-18" class="d">-CREATE TABLE c (
</a><a href="#h76-0-19" id="h76-0-19" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h76-0-20" id="h76-0-20" class="d">-)
</a><a href="#h76-0-21" id="h76-0-21" class="d">-[Integer(31)]
</a><a href="#h76-0-22" id="h76-0-22" class="d">-[Integer(32)]
</a><a href="#h76-0-23" id="h76-0-23" class="d">-[Integer(33)]
</a><b>diff --git a/<a id="h77" href="../file/tests/sql/schema/drop_table_missing.html">tests/sql/schema/drop_table_missing</a> b/<a href="../file/tests/sql/schema/drop_table_missing.html">tests/sql/schema/drop_table_missing</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -1,24 +0,0 @@
</a><a href="#h77-0-0" id="h77-0-0" class="d">-Query: DROP TABLE name
</a><a href="#h77-0-1" id="h77-0-1" class="d">-Error: InvalidInput(&quot;table name does not exist&quot;)
</a><a href="#h77-0-2" id="h77-0-2" class="d">-
</a><a href="#h77-0-3" id="h77-0-3" class="d">-Storage:
</a><a href="#h77-0-4" id="h77-0-4" class="d">-CREATE TABLE a (
</a><a href="#h77-0-5" id="h77-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h77-0-6" id="h77-0-6" class="d">-)
</a><a href="#h77-0-7" id="h77-0-7" class="d">-[Integer(11)]
</a><a href="#h77-0-8" id="h77-0-8" class="d">-[Integer(12)]
</a><a href="#h77-0-9" id="h77-0-9" class="d">-[Integer(13)]
</a><a href="#h77-0-10" id="h77-0-10" class="d">-
</a><a href="#h77-0-11" id="h77-0-11" class="d">-CREATE TABLE b (
</a><a href="#h77-0-12" id="h77-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h77-0-13" id="h77-0-13" class="d">-)
</a><a href="#h77-0-14" id="h77-0-14" class="d">-[Integer(21)]
</a><a href="#h77-0-15" id="h77-0-15" class="d">-[Integer(22)]
</a><a href="#h77-0-16" id="h77-0-16" class="d">-[Integer(23)]
</a><a href="#h77-0-17" id="h77-0-17" class="d">-
</a><a href="#h77-0-18" id="h77-0-18" class="d">-CREATE TABLE c (
</a><a href="#h77-0-19" id="h77-0-19" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h77-0-20" id="h77-0-20" class="d">-)
</a><a href="#h77-0-21" id="h77-0-21" class="d">-[Integer(31)]
</a><a href="#h77-0-22" id="h77-0-22" class="d">-[Integer(32)]
</a><a href="#h77-0-23" id="h77-0-23" class="d">-[Integer(33)]
</a><b>diff --git a/<a id="h78" href="../file/tests/sql/schema/drop_table_multiple.html">tests/sql/schema/drop_table_multiple</a> b/<a href="../file/tests/sql/schema/drop_table_multiple.html">tests/sql/schema/drop_table_multiple</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -1,24 +0,0 @@
</a><a href="#h78-0-0" id="h78-0-0" class="d">-Query: DROP TABLE a, c
</a><a href="#h78-0-1" id="h78-0-1" class="d">-Error: InvalidInput(&quot;unexpected token ,&quot;)
</a><a href="#h78-0-2" id="h78-0-2" class="d">-
</a><a href="#h78-0-3" id="h78-0-3" class="d">-Storage:
</a><a href="#h78-0-4" id="h78-0-4" class="d">-CREATE TABLE a (
</a><a href="#h78-0-5" id="h78-0-5" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h78-0-6" id="h78-0-6" class="d">-)
</a><a href="#h78-0-7" id="h78-0-7" class="d">-[Integer(11)]
</a><a href="#h78-0-8" id="h78-0-8" class="d">-[Integer(12)]
</a><a href="#h78-0-9" id="h78-0-9" class="d">-[Integer(13)]
</a><a href="#h78-0-10" id="h78-0-10" class="d">-
</a><a href="#h78-0-11" id="h78-0-11" class="d">-CREATE TABLE b (
</a><a href="#h78-0-12" id="h78-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h78-0-13" id="h78-0-13" class="d">-)
</a><a href="#h78-0-14" id="h78-0-14" class="d">-[Integer(21)]
</a><a href="#h78-0-15" id="h78-0-15" class="d">-[Integer(22)]
</a><a href="#h78-0-16" id="h78-0-16" class="d">-[Integer(23)]
</a><a href="#h78-0-17" id="h78-0-17" class="d">-
</a><a href="#h78-0-18" id="h78-0-18" class="d">-CREATE TABLE c (
</a><a href="#h78-0-19" id="h78-0-19" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h78-0-20" id="h78-0-20" class="d">-)
</a><a href="#h78-0-21" id="h78-0-21" class="d">-[Integer(31)]
</a><a href="#h78-0-22" id="h78-0-22" class="d">-[Integer(32)]
</a><a href="#h78-0-23" id="h78-0-23" class="d">-[Integer(33)]
</a><b>diff --git a/<a id="h79" href="../file/tests/sql/schema/drop_table_ref_self.html">tests/sql/schema/drop_table_ref_self</a> b/<a href="../file/tests/sql/schema/drop_table_ref_self.html">tests/sql/schema/drop_table_ref_self</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -1,14 +0,0 @@
</a><a href="#h79-0-0" id="h79-0-0" class="d">-Query: DROP TABLE self
</a><a href="#h79-0-1" id="h79-0-1" class="d">-Result: DropTable { name: &quot;self&quot;, existed: true }
</a><a href="#h79-0-2" id="h79-0-2" class="d">-
</a><a href="#h79-0-3" id="h79-0-3" class="d">-Storage:
</a><a href="#h79-0-4" id="h79-0-4" class="d">-CREATE TABLE source (
</a><a href="#h79-0-5" id="h79-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h79-0-6" id="h79-0-6" class="d">-  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a><a href="#h79-0-7" id="h79-0-7" class="d">-)
</a><a href="#h79-0-8" id="h79-0-8" class="d">-
</a><a href="#h79-0-9" id="h79-0-9" class="d">-Index source.target_id
</a><a href="#h79-0-10" id="h79-0-10" class="d">-
</a><a href="#h79-0-11" id="h79-0-11" class="d">-CREATE TABLE target (
</a><a href="#h79-0-12" id="h79-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h79-0-13" id="h79-0-13" class="d">-)
</a><b>diff --git a/<a id="h80" href="../file/tests/sql/schema/drop_table_ref_source.html">tests/sql/schema/drop_table_ref_source</a> b/<a href="../file/tests/sql/schema/drop_table_ref_source.html">tests/sql/schema/drop_table_ref_source</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -1,14 +0,0 @@
</a><a href="#h80-0-0" id="h80-0-0" class="d">-Query: DROP TABLE source
</a><a href="#h80-0-1" id="h80-0-1" class="d">-Result: DropTable { name: &quot;source&quot;, existed: true }
</a><a href="#h80-0-2" id="h80-0-2" class="d">-
</a><a href="#h80-0-3" id="h80-0-3" class="d">-Storage:
</a><a href="#h80-0-4" id="h80-0-4" class="d">-CREATE TABLE self (
</a><a href="#h80-0-5" id="h80-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h80-0-6" id="h80-0-6" class="d">-  self_id INTEGER DEFAULT NULL INDEX REFERENCES self
</a><a href="#h80-0-7" id="h80-0-7" class="d">-)
</a><a href="#h80-0-8" id="h80-0-8" class="d">-
</a><a href="#h80-0-9" id="h80-0-9" class="d">-Index self.self_id
</a><a href="#h80-0-10" id="h80-0-10" class="d">-
</a><a href="#h80-0-11" id="h80-0-11" class="d">-CREATE TABLE target (
</a><a href="#h80-0-12" id="h80-0-12" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h80-0-13" id="h80-0-13" class="d">-)
</a><b>diff --git a/<a id="h81" href="../file/tests/sql/schema/drop_table_ref_target.html">tests/sql/schema/drop_table_ref_target</a> b/<a href="../file/tests/sql/schema/drop_table_ref_target.html">tests/sql/schema/drop_table_ref_target</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -1,21 +0,0 @@
</a><a href="#h81-0-0" id="h81-0-0" class="d">-Query: DROP TABLE target
</a><a href="#h81-0-1" id="h81-0-1" class="d">-Error: InvalidInput(&quot;table target is referenced from source.target_id&quot;)
</a><a href="#h81-0-2" id="h81-0-2" class="d">-
</a><a href="#h81-0-3" id="h81-0-3" class="d">-Storage:
</a><a href="#h81-0-4" id="h81-0-4" class="d">-CREATE TABLE self (
</a><a href="#h81-0-5" id="h81-0-5" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h81-0-6" id="h81-0-6" class="d">-  self_id INTEGER DEFAULT NULL INDEX REFERENCES self
</a><a href="#h81-0-7" id="h81-0-7" class="d">-)
</a><a href="#h81-0-8" id="h81-0-8" class="d">-
</a><a href="#h81-0-9" id="h81-0-9" class="d">-Index self.self_id
</a><a href="#h81-0-10" id="h81-0-10" class="d">-
</a><a href="#h81-0-11" id="h81-0-11" class="d">-CREATE TABLE source (
</a><a href="#h81-0-12" id="h81-0-12" class="d">-  id INTEGER PRIMARY KEY,
</a><a href="#h81-0-13" id="h81-0-13" class="d">-  target_id INTEGER DEFAULT NULL INDEX REFERENCES target
</a><a href="#h81-0-14" id="h81-0-14" class="d">-)
</a><a href="#h81-0-15" id="h81-0-15" class="d">-
</a><a href="#h81-0-16" id="h81-0-16" class="d">-Index source.target_id
</a><a href="#h81-0-17" id="h81-0-17" class="d">-
</a><a href="#h81-0-18" id="h81-0-18" class="d">-CREATE TABLE target (
</a><a href="#h81-0-19" id="h81-0-19" class="d">-  id INTEGER PRIMARY KEY
</a><a href="#h81-0-20" id="h81-0-20" class="d">-)
</a></pre>
</div>
</body>
</html>
