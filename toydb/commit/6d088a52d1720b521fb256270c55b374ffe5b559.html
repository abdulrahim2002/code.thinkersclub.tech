<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: fix recursive join pushdown and optimize transverse constant lookups - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/6d088a52d1720b521fb256270c55b374ffe5b559.html">6d088a52d1720b521fb256270c55b374ffe5b559</a>
<b>parent</b> <a href="../commit/c3e58d2fdcb37479b01f555d0f7acc9c69bcd338.html">c3e58d2fdcb37479b01f555d0f7acc9c69bcd338</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Mon,  1 Jun 2020 11:47:39 +0200

sql: fix recursive join pushdown and optimize transverse constant lookups

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/execution/query.rs</a></td><td> | </td><td class="num">42</td><td><span class="i">++++++++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/plan/mod.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/plan/optimizer.rs</a></td><td> | </td><td class="num">110</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/types/expression.rs</a></td><td> | </td><td class="num">53</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">tests/sql/query.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">tests/sql/query/agg_boolean</a></td><td> | </td><td class="num">47</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">tests/sql/query/agg_float</a></td><td> | </td><td class="num">47</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">tests/sql/query/agg_integer</a></td><td> | </td><td class="num">47</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">tests/sql/query/agg_string</a></td><td> | </td><td class="num">47</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query/having</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">76</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/having_nogroup</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">260</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/join_inner_index_transverse</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++</span><span class="d">--</span></td></tr>
<tr><td class="A">A</td><td><a href="#h20">tests/sql/query/join_inner_index_transverse_where</a></td><td> | </td><td class="num">196</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">39</td><td><span class="i">+++++++++++++++++++++++++++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/join_inner_on_where</a></td><td> | </td><td class="num">142</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">101</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">101</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/where_expr</a></td><td> | </td><td class="num">111</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/where_false</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">187</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">179</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/where_float</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/where_index</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/where_index_or</a></td><td> | </td><td class="num">99</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/where_index_or_partial</a></td><td> | </td><td class="num">121</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/where_integer</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/query/where_join_inner</a></td><td> | </td><td class="num">89</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/query/where_null</a></td><td> | </td><td class="num">23</td><td><span class="i">++++++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/query/where_pk</a></td><td> | </td><td class="num">43</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">-------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/query/where_pk_or</a></td><td> | </td><td class="num">89</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/query/where_pk_or_partial</a></td><td> | </td><td class="num">135</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/query/where_string</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/query/where_true</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++</span><span class="d">-----------</span></td></tr>
</table></pre><pre>41 files changed, 1614 insertions(+), 1228 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/execution/query.rs.html">src/sql/execution/query.rs</a> b/<a href="../file/src/sql/execution/query.rs.html">src/sql/execution/query.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -7,35 +7,37 @@ use crate::error::{Error, Result};
</a> /// A filter executor
 pub struct Filter&lt;T: Transaction&gt; {
     source: Box&lt;dyn Executor&lt;T&gt;&gt;,
<a href="#h0-0-3" id="h0-0-3" class="d">-    predicate: Expression,
</a><a href="#h0-0-4" id="h0-0-4" class="i">+    predicate: Option&lt;Expression&gt;,
</a> }
 
 impl&lt;T: Transaction&gt; Filter&lt;T&gt; {
<a href="#h0-0-8" id="h0-0-8" class="d">-    pub fn new(source: Box&lt;dyn Executor&lt;T&gt;&gt;, predicate: Expression) -&gt; Box&lt;Self&gt; {
</a><a href="#h0-0-9" id="h0-0-9" class="i">+    pub fn new(source: Box&lt;dyn Executor&lt;T&gt;&gt;, predicate: Option&lt;Expression&gt;) -&gt; Box&lt;Self&gt; {
</a>         Box::new(Self { source, predicate })
     }
 }
 
 impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Filter&lt;T&gt; {
     fn execute(self: Box&lt;Self&gt;, txn: &amp;mut T) -&gt; Result&lt;ResultSet&gt; {
<a href="#h0-0-16" id="h0-0-16" class="d">-        let result = self.source.execute(txn)?;
</a><a href="#h0-0-17" id="h0-0-17" class="d">-        if let ResultSet::Query { columns, rows } = result {
</a><a href="#h0-0-18" id="h0-0-18" class="d">-            let predicate = self.predicate;
</a><a href="#h0-0-19" id="h0-0-19" class="d">-            Ok(ResultSet::Query {
</a><a href="#h0-0-20" id="h0-0-20" class="d">-                columns,
</a><a href="#h0-0-21" id="h0-0-21" class="d">-                rows: Box::new(rows.filter_map(move |r| {
</a><a href="#h0-0-22" id="h0-0-22" class="d">-                    r.and_then(|row| match predicate.evaluate(Some(&amp;row))? {
</a><a href="#h0-0-23" id="h0-0-23" class="d">-                        Value::Boolean(true) =&gt; Ok(Some(row)),
</a><a href="#h0-0-24" id="h0-0-24" class="d">-                        Value::Boolean(false) =&gt; Ok(None),
</a><a href="#h0-0-25" id="h0-0-25" class="d">-                        Value::Null =&gt; Ok(None),
</a><a href="#h0-0-26" id="h0-0-26" class="d">-                        value =&gt; Err(Error::Value(format!(
</a><a href="#h0-0-27" id="h0-0-27" class="d">-                            &quot;Filter returned {}, expected boolean&quot;,
</a><a href="#h0-0-28" id="h0-0-28" class="d">-                            value
</a><a href="#h0-0-29" id="h0-0-29" class="d">-                        ))),
</a><a href="#h0-0-30" id="h0-0-30" class="d">-                    })
</a><a href="#h0-0-31" id="h0-0-31" class="d">-                    .transpose()
</a><a href="#h0-0-32" id="h0-0-32" class="d">-                })),
</a><a href="#h0-0-33" id="h0-0-33" class="d">-            })
</a><a href="#h0-0-34" id="h0-0-34" class="i">+        if let ResultSet::Query { columns, rows } = self.source.execute(txn)? {
</a><a href="#h0-0-35" id="h0-0-35" class="i">+            if let Some(predicate) = self.predicate {
</a><a href="#h0-0-36" id="h0-0-36" class="i">+                Ok(ResultSet::Query {
</a><a href="#h0-0-37" id="h0-0-37" class="i">+                    columns,
</a><a href="#h0-0-38" id="h0-0-38" class="i">+                    rows: Box::new(rows.filter_map(move |r| {
</a><a href="#h0-0-39" id="h0-0-39" class="i">+                        r.and_then(|row| match predicate.evaluate(Some(&amp;row))? {
</a><a href="#h0-0-40" id="h0-0-40" class="i">+                            Value::Boolean(true) =&gt; Ok(Some(row)),
</a><a href="#h0-0-41" id="h0-0-41" class="i">+                            Value::Boolean(false) =&gt; Ok(None),
</a><a href="#h0-0-42" id="h0-0-42" class="i">+                            Value::Null =&gt; Ok(None),
</a><a href="#h0-0-43" id="h0-0-43" class="i">+                            value =&gt; Err(Error::Value(format!(
</a><a href="#h0-0-44" id="h0-0-44" class="i">+                                &quot;Filter returned {}, expected boolean&quot;,
</a><a href="#h0-0-45" id="h0-0-45" class="i">+                                value
</a><a href="#h0-0-46" id="h0-0-46" class="i">+                            ))),
</a><a href="#h0-0-47" id="h0-0-47" class="i">+                        })
</a><a href="#h0-0-48" id="h0-0-48" class="i">+                        .transpose()
</a><a href="#h0-0-49" id="h0-0-49" class="i">+                    })),
</a><a href="#h0-0-50" id="h0-0-50" class="i">+                })
</a><a href="#h0-0-51" id="h0-0-51" class="i">+            } else {
</a><a href="#h0-0-52" id="h0-0-52" class="i">+                Ok(ResultSet::Query { columns, rows })
</a><a href="#h0-0-53" id="h0-0-53" class="i">+            }
</a>         } else {
             Err(Error::Internal(&quot;Unexpected result&quot;.into()))
         }
<b>diff --git a/<a id="h1" href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a> b/<a href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -57,7 +57,10 @@ pub enum Node {
</a>     },
     Filter {
         source: Box&lt;Node&gt;,
<a href="#h1-0-3" id="h1-0-3" class="d">-        predicate: Expression,
</a><a href="#h1-0-4" id="h1-0-4" class="i">+        // A filter node may not make sense, but it&#39;s useful during planning and optimization
</a><a href="#h1-0-5" id="h1-0-5" class="i">+        // when we&#39;re moving predicates around - in particular, replacing a filter node with
</a><a href="#h1-0-6" id="h1-0-6" class="i">+        // a source node during filter pushdown will cause Node.transform() to skip the source.
</a><a href="#h1-0-7" id="h1-0-7" class="i">+        predicate: Option&lt;Expression&gt;,
</a>     },
     IndexLookup {
         table: String,
<a href="#h1-1" id="h1-1" class="h">@@ -179,6 +182,7 @@ impl Node {
</a>             | n @ Self::CreateTable { .. }
             | n @ Self::Delete { .. }
             | n @ Self::DropTable { .. }
<a href="#h1-1-3" id="h1-1-3" class="i">+            | n @ Self::Filter { predicate: None, .. }
</a>             | n @ Self::IndexLookup { .. }
             | n @ Self::KeyLookup { .. }
             | n @ Self::Limit { .. }
<a href="#h1-2" id="h1-2" class="h">@@ -187,8 +191,8 @@ impl Node {
</a>             | n @ Self::Offset { .. }
             | n @ Self::Scan { filter: None, .. } =&gt; n,
 
<a href="#h1-2-3" id="h1-2-3" class="d">-            Self::Filter { source, predicate } =&gt; {
</a><a href="#h1-2-4" id="h1-2-4" class="d">-                Self::Filter { source, predicate: predicate.transform(before, after)? }
</a><a href="#h1-2-5" id="h1-2-5" class="i">+            Self::Filter { source, predicate: Some(predicate) } =&gt; {
</a><a href="#h1-2-6" id="h1-2-6" class="i">+                Self::Filter { source, predicate: Some(predicate.transform(before, after)?) }
</a>             }
             Self::Insert { table, columns, expressions } =&gt; Self::Insert {
                 table,
<b>diff --git a/<a id="h2" href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a> b/<a href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -1,5 +1,5 @@
</a> use super::super::schema::Catalog;
<a href="#h2-0-1" id="h2-0-1" class="d">-use super::super::types::{Expression, Value};
</a><a href="#h2-0-2" id="h2-0-2" class="i">+use super::super::types::Expression;
</a> use super::Node;
 use crate::error::Result;
 
<a href="#h2-1" id="h2-1" class="h">@@ -37,11 +37,13 @@ impl Optimizer for FilterPushdown {
</a>     fn optimize(&amp;self, node: Node) -&gt; Result&lt;Node&gt; {
         node.transform(
             &amp;|n| match n {
<a href="#h2-1-3" id="h2-1-3" class="d">-                Node::Filter { mut source, predicate } =&gt; {
</a><a href="#h2-1-4" id="h2-1-4" class="d">-                    match self.pushdown(predicate, &amp;mut *source) {
</a><a href="#h2-1-5" id="h2-1-5" class="d">-                        Some(remainder) =&gt; Ok(Node::Filter { source, predicate: remainder }),
</a><a href="#h2-1-6" id="h2-1-6" class="d">-                        None =&gt; Ok(*source),
</a><a href="#h2-1-7" id="h2-1-7" class="d">-                    }
</a><a href="#h2-1-8" id="h2-1-8" class="i">+                Node::Filter { mut source, predicate: Some(predicate) } =&gt; {
</a><a href="#h2-1-9" id="h2-1-9" class="i">+                    // We don&#39;t replace the filter node here, since doing so would cause transform()
</a><a href="#h2-1-10" id="h2-1-10" class="i">+                    // to skip the source as it won&#39;t reapply the transform to the &quot;same&quot; node.
</a><a href="#h2-1-11" id="h2-1-11" class="i">+                    // We leave an empty filter node instead, which will be cleaned up by a separate
</a><a href="#h2-1-12" id="h2-1-12" class="i">+                    // optimizer.
</a><a href="#h2-1-13" id="h2-1-13" class="i">+                    let predicate = self.pushdown(predicate, &amp;mut *source);
</a><a href="#h2-1-14" id="h2-1-14" class="i">+                    Ok(Node::Filter { source, predicate })
</a>                 }
                 Node::NestedLoopJoin {
                     mut outer,
<a href="#h2-2" id="h2-2" class="h">@@ -63,24 +65,18 @@ impl Optimizer for FilterPushdown {
</a> }
 
 impl FilterPushdown {
<a href="#h2-2-3" id="h2-2-3" class="d">-    /// Attempts to push a predicate down into a target node, returns any remaining expression.
</a><a href="#h2-2-4" id="h2-2-4" class="d">-    fn pushdown(&amp;self, mut predicate: Expression, target: &amp;mut Node) -&gt; Option&lt;Expression&gt; {
</a><a href="#h2-2-5" id="h2-2-5" class="i">+    /// Attempts to push an expression down into a target node, returns any remaining expression.
</a><a href="#h2-2-6" id="h2-2-6" class="i">+    fn pushdown(&amp;self, mut expression: Expression, target: &amp;mut Node) -&gt; Option&lt;Expression&gt; {
</a>         match target {
<a href="#h2-2-8" id="h2-2-8" class="d">-            // Filter nodes immediately before a scan node can be trivially pushed down.
</a><a href="#h2-2-9" id="h2-2-9" class="d">-            Node::Scan { ref mut filter, .. } =&gt; {
</a><a href="#h2-2-10" id="h2-2-10" class="d">-                if let Some(filter) = filter.take() {
</a><a href="#h2-2-11" id="h2-2-11" class="d">-                    predicate = Expression::And(Box::new(predicate), Box::new(filter))
</a><a href="#h2-2-12" id="h2-2-12" class="d">-                }
</a><a href="#h2-2-13" id="h2-2-13" class="d">-                filter.replace(predicate)
</a><a href="#h2-2-14" id="h2-2-14" class="d">-            }
</a><a href="#h2-2-15" id="h2-2-15" class="d">-            // Filter nodes immediately before a nested loop join can be trivially pushed down.
</a><a href="#h2-2-16" id="h2-2-16" class="d">-            Node::NestedLoopJoin { predicate: ref mut join_predicate, .. } =&gt; {
</a><a href="#h2-2-17" id="h2-2-17" class="d">-                if let Some(join_predicate) = join_predicate.take() {
</a><a href="#h2-2-18" id="h2-2-18" class="d">-                    predicate = Expression::And(Box::new(predicate), Box::new(join_predicate));
</a><a href="#h2-2-19" id="h2-2-19" class="i">+            Node::Filter { ref mut predicate, .. }
</a><a href="#h2-2-20" id="h2-2-20" class="i">+            | Node::NestedLoopJoin { ref mut predicate, .. }
</a><a href="#h2-2-21" id="h2-2-21" class="i">+            | Node::Scan { filter: ref mut predicate, .. } =&gt; {
</a><a href="#h2-2-22" id="h2-2-22" class="i">+                if let Some(predicate) = predicate.take() {
</a><a href="#h2-2-23" id="h2-2-23" class="i">+                    expression = Expression::And(Box::new(expression), Box::new(predicate));
</a>                 }
<a href="#h2-2-25" id="h2-2-25" class="d">-                join_predicate.replace(predicate)
</a><a href="#h2-2-26" id="h2-2-26" class="i">+                predicate.replace(expression)
</a>             }
<a href="#h2-2-28" id="h2-2-28" class="d">-            _ =&gt; Some(predicate),
</a><a href="#h2-2-29" id="h2-2-29" class="i">+            _ =&gt; Some(expression),
</a>         }
     }
 
<a href="#h2-3" id="h2-3" class="h">@@ -93,22 +89,43 @@ impl FilterPushdown {
</a>         right: &amp;mut Node,
         boundary: usize,
     ) -&gt; Option&lt;Expression&gt; {
<a href="#h2-3-3" id="h2-3-3" class="i">+        // Convert the predicate into conjunctive normal form, and partition into expressions
</a><a href="#h2-3-4" id="h2-3-4" class="i">+        // only referencing the left or right sources, leaving cross-source expressions.
</a>         let cnf = predicate.into_cnf_vec();
<a href="#h2-3-6" id="h2-3-6" class="d">-        let (push_left, cnf): (Vec&lt;Expression&gt;, Vec&lt;Expression&gt;) = cnf.into_iter().partition(|e| {
</a><a href="#h2-3-7" id="h2-3-7" class="d">-            // Partition only if no expressions reference the right-hand source.
</a><a href="#h2-3-8" id="h2-3-8" class="d">-            !e.contains(&amp;|e| match e {
</a><a href="#h2-3-9" id="h2-3-9" class="d">-                Expression::Field(i, _) if i &gt;= &amp;boundary =&gt; true,
</a><a href="#h2-3-10" id="h2-3-10" class="d">-                _ =&gt; false,
</a><a href="#h2-3-11" id="h2-3-11" class="d">-            })
</a><a href="#h2-3-12" id="h2-3-12" class="d">-        });
</a><a href="#h2-3-13" id="h2-3-13" class="d">-        let (push_right, mut cnf): (Vec&lt;Expression&gt;, Vec&lt;Expression&gt;) =
</a><a href="#h2-3-14" id="h2-3-14" class="d">-            // Partition only if no expressions reference the left-hand source.
</a><a href="#h2-3-15" id="h2-3-15" class="i">+        let (mut push_left, cnf): (Vec&lt;Expression&gt;, Vec&lt;Expression&gt;) =
</a>             cnf.into_iter().partition(|e| {
<a href="#h2-3-17" id="h2-3-17" class="i">+                // Partition only if no expressions reference the right-hand source.
</a><a href="#h2-3-18" id="h2-3-18" class="i">+                !e.contains(&amp;|e| match e {
</a><a href="#h2-3-19" id="h2-3-19" class="i">+                    Expression::Field(i, _) if i &gt;= &amp;boundary =&gt; true,
</a><a href="#h2-3-20" id="h2-3-20" class="i">+                    _ =&gt; false,
</a><a href="#h2-3-21" id="h2-3-21" class="i">+                })
</a><a href="#h2-3-22" id="h2-3-22" class="i">+            });
</a><a href="#h2-3-23" id="h2-3-23" class="i">+        let (mut push_right, mut cnf): (Vec&lt;Expression&gt;, Vec&lt;Expression&gt;) =
</a><a href="#h2-3-24" id="h2-3-24" class="i">+            cnf.into_iter().partition(|e| {
</a><a href="#h2-3-25" id="h2-3-25" class="i">+                // Partition only if no expressions reference the left-hand source.
</a>                 !e.contains(&amp;|e| match e {
                     Expression::Field(i, _) if i &lt; &amp;boundary =&gt; true,
                     _ =&gt; false,
                 })
             });
<a href="#h2-3-31" id="h2-3-31" class="i">+
</a><a href="#h2-3-32" id="h2-3-32" class="i">+        // Look for equijoins that have constant lookups on either side, and transfer the constants
</a><a href="#h2-3-33" id="h2-3-33" class="i">+        // to the other side of the join as well. This allows index lookup optimization in both
</a><a href="#h2-3-34" id="h2-3-34" class="i">+        // sides. We already know that the remaining cnf expressions span both sources.
</a><a href="#h2-3-35" id="h2-3-35" class="i">+        for e in &amp;cnf {
</a><a href="#h2-3-36" id="h2-3-36" class="i">+            if let Expression::Equal(ref lhs, ref rhs) = e {
</a><a href="#h2-3-37" id="h2-3-37" class="i">+                if let (Expression::Field(l, ln), Expression::Field(r, rn)) = (&amp;**lhs, &amp;**rhs) {
</a><a href="#h2-3-38" id="h2-3-38" class="i">+                    let (l, ln, r, rn) = if l &gt; r { (r, rn, l, ln) } else { (l, ln, r, rn) };
</a><a href="#h2-3-39" id="h2-3-39" class="i">+                    if let Some(lvals) = push_left.iter().find_map(|e| e.as_lookup(*l)) {
</a><a href="#h2-3-40" id="h2-3-40" class="i">+                        push_right.push(Expression::from_lookup(*r, rn.clone(), lvals));
</a><a href="#h2-3-41" id="h2-3-41" class="i">+                    } else if let Some(rvals) = push_right.iter().find_map(|e| e.as_lookup(*r)) {
</a><a href="#h2-3-42" id="h2-3-42" class="i">+                        push_left.push(Expression::from_lookup(*l, ln.clone(), rvals));
</a><a href="#h2-3-43" id="h2-3-43" class="i">+                    }
</a><a href="#h2-3-44" id="h2-3-44" class="i">+                }
</a><a href="#h2-3-45" id="h2-3-45" class="i">+            }
</a><a href="#h2-3-46" id="h2-3-46" class="i">+        }
</a><a href="#h2-3-47" id="h2-3-47" class="i">+
</a><a href="#h2-3-48" id="h2-3-48" class="i">+        // Push predicates down into the sources.
</a>         if let Some(push_left) = Expression::from_cnf_vec(push_left) {
             if let Some(remainder) = self.pushdown(push_left, left) {
                 cnf.push(remainder)
<a href="#h2-4" id="h2-4" class="h">@@ -143,37 +160,10 @@ impl&lt;&#39;a, C: Catalog&gt; IndexLookup&lt;&#39;a, C&gt; {
</a>         Self { catalog }
     }
 
<a href="#h2-4-3" id="h2-4-3" class="d">-    // Attempts to convert the given expression into a list of field values. Expressions must be a
</a><a href="#h2-4-4" id="h2-4-4" class="d">-    // combination of =, IS NULL, OR to be converted.
</a><a href="#h2-4-5" id="h2-4-5" class="d">-    fn as_lookups(&amp;self, field: usize, expr: &amp;Expression) -&gt; Option&lt;Vec&lt;Value&gt;&gt; {
</a><a href="#h2-4-6" id="h2-4-6" class="d">-        use Expression::*;
</a><a href="#h2-4-7" id="h2-4-7" class="d">-        // FIXME This should use a single match level, but since the child expressions are boxed
</a><a href="#h2-4-8" id="h2-4-8" class="d">-        // that would require box patterns, which are unstable.
</a><a href="#h2-4-9" id="h2-4-9" class="d">-        match &amp;*expr {
</a><a href="#h2-4-10" id="h2-4-10" class="d">-            Equal(lhs, rhs) =&gt; match (&amp;**lhs, &amp;**rhs) {
</a><a href="#h2-4-11" id="h2-4-11" class="d">-                (Field(i, _), Constant(v)) if i == &amp;field =&gt; Some(vec![v.clone()]),
</a><a href="#h2-4-12" id="h2-4-12" class="d">-                (Constant(v), Field(i, _)) if i == &amp;field =&gt; Some(vec![v.clone()]),
</a><a href="#h2-4-13" id="h2-4-13" class="d">-                (_, _) =&gt; None,
</a><a href="#h2-4-14" id="h2-4-14" class="d">-            },
</a><a href="#h2-4-15" id="h2-4-15" class="d">-            IsNull(e) =&gt; match &amp;**e {
</a><a href="#h2-4-16" id="h2-4-16" class="d">-                Field(i, _) if i == &amp;field =&gt; Some(vec![Value::Null]),
</a><a href="#h2-4-17" id="h2-4-17" class="d">-                _ =&gt; None,
</a><a href="#h2-4-18" id="h2-4-18" class="d">-            },
</a><a href="#h2-4-19" id="h2-4-19" class="d">-            Or(lhs, rhs) =&gt; match (self.as_lookups(field, lhs), self.as_lookups(field, rhs)) {
</a><a href="#h2-4-20" id="h2-4-20" class="d">-                (Some(mut lvalues), Some(mut rvalues)) =&gt; {
</a><a href="#h2-4-21" id="h2-4-21" class="d">-                    lvalues.append(&amp;mut rvalues);
</a><a href="#h2-4-22" id="h2-4-22" class="d">-                    Some(lvalues)
</a><a href="#h2-4-23" id="h2-4-23" class="d">-                }
</a><a href="#h2-4-24" id="h2-4-24" class="d">-                _ =&gt; None,
</a><a href="#h2-4-25" id="h2-4-25" class="d">-            },
</a><a href="#h2-4-26" id="h2-4-26" class="d">-            _ =&gt; None,
</a><a href="#h2-4-27" id="h2-4-27" class="d">-        }
</a><a href="#h2-4-28" id="h2-4-28" class="d">-    }
</a><a href="#h2-4-29" id="h2-4-29" class="d">-
</a>     // Wraps a node in a filter for the given CNF vector, if any, otherwise returns the bare node.
     fn wrap_cnf(&amp;self, node: Node, cnf: Vec&lt;Expression&gt;) -&gt; Node {
         if let Some(predicate) = Expression::from_cnf_vec(cnf) {
<a href="#h2-4-33" id="h2-4-33" class="d">-            Node::Filter { source: Box::new(node), predicate }
</a><a href="#h2-4-34" id="h2-4-34" class="i">+            Node::Filter { source: Box::new(node), predicate: Some(predicate) }
</a>         } else {
             node
         }
<a href="#h2-5" id="h2-5" class="h">@@ -192,12 +182,12 @@ impl&lt;&#39;a, C: Catalog&gt; Optimizer for IndexLookup&lt;&#39;a, C&gt; {
</a>                 // apply the remaining conjunctions as a filter node, if any.
                 let mut cnf = filter.clone().into_cnf_vec();
                 for i in 0..cnf.len() {
<a href="#h2-5-3" id="h2-5-3" class="d">-                    if let Some(keys) = self.as_lookups(pk, &amp;cnf[i]) {
</a><a href="#h2-5-4" id="h2-5-4" class="i">+                    if let Some(keys) = cnf[i].as_lookup(pk) {
</a>                         cnf.remove(i);
                         return Ok(self.wrap_cnf(Node::KeyLookup { table, alias, keys }, cnf));
                     }
                     for (ci, column) in columns.iter().enumerate().filter(|(_, c)| c.index) {
<a href="#h2-5-9" id="h2-5-9" class="d">-                        if let Some(values) = self.as_lookups(ci, &amp;cnf[i]) {
</a><a href="#h2-5-10" id="h2-5-10" class="i">+                        if let Some(values) = cnf[i].as_lookup(ci) {
</a>                             cnf.remove(i);
                             return Ok(self.wrap_cnf(
                                 Node::IndexLookup {
<b>diff --git a/<a id="h3" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -137,7 +137,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 if let Some(expr) = r#where {
                     node = Node::Filter {
                         source: Box::new(node),
<a href="#h3-0-3" id="h3-0-3" class="d">-                        predicate: self.build_expression(scope, expr)?,
</a><a href="#h3-0-4" id="h3-0-4" class="i">+                        predicate: Some(self.build_expression(scope, expr)?),
</a>                     };
                 };
 
<a href="#h3-1" id="h3-1" class="h">@@ -188,7 +188,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 if let Some(expr) = having {
                     node = Node::Filter {
                         source: Box::new(node),
<a href="#h3-1-3" id="h3-1-3" class="d">-                        predicate: self.build_expression(scope, expr)?,
</a><a href="#h3-1-4" id="h3-1-4" class="i">+                        predicate: Some(self.build_expression(scope, expr)?),
</a>                     };
                 };
 
<b>diff --git a/<a id="h4" href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a> b/<a href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -461,4 +461,57 @@ impl Expression {
</a>             None
         }
     }
<a href="#h4-0-3" id="h4-0-3" class="i">+
</a><a href="#h4-0-4" id="h4-0-4" class="i">+    // Checks if the expression is a field lookup, and returns the list of values looked up.
</a><a href="#h4-0-5" id="h4-0-5" class="i">+    // Expressions must be a combination of =, IS NULL, OR to be converted.
</a><a href="#h4-0-6" id="h4-0-6" class="i">+    pub fn as_lookup(&amp;self, field: usize) -&gt; Option&lt;Vec&lt;Value&gt;&gt; {
</a><a href="#h4-0-7" id="h4-0-7" class="i">+        use Expression::*;
</a><a href="#h4-0-8" id="h4-0-8" class="i">+        // FIXME This should use a single match level, but since the child expressions are boxed
</a><a href="#h4-0-9" id="h4-0-9" class="i">+        // that would require box patterns, which are unstable.
</a><a href="#h4-0-10" id="h4-0-10" class="i">+        match &amp;*self {
</a><a href="#h4-0-11" id="h4-0-11" class="i">+            Equal(lhs, rhs) =&gt; match (&amp;**lhs, &amp;**rhs) {
</a><a href="#h4-0-12" id="h4-0-12" class="i">+                (Field(i, _), Constant(v)) if i == &amp;field =&gt; Some(vec![v.clone()]),
</a><a href="#h4-0-13" id="h4-0-13" class="i">+                (Constant(v), Field(i, _)) if i == &amp;field =&gt; Some(vec![v.clone()]),
</a><a href="#h4-0-14" id="h4-0-14" class="i">+                (_, _) =&gt; None,
</a><a href="#h4-0-15" id="h4-0-15" class="i">+            },
</a><a href="#h4-0-16" id="h4-0-16" class="i">+            IsNull(e) =&gt; match &amp;**e {
</a><a href="#h4-0-17" id="h4-0-17" class="i">+                Field(i, _) if i == &amp;field =&gt; Some(vec![Value::Null]),
</a><a href="#h4-0-18" id="h4-0-18" class="i">+                _ =&gt; None,
</a><a href="#h4-0-19" id="h4-0-19" class="i">+            },
</a><a href="#h4-0-20" id="h4-0-20" class="i">+            Or(lhs, rhs) =&gt; match (lhs.as_lookup(field), rhs.as_lookup(field)) {
</a><a href="#h4-0-21" id="h4-0-21" class="i">+                (Some(mut lvalues), Some(mut rvalues)) =&gt; {
</a><a href="#h4-0-22" id="h4-0-22" class="i">+                    lvalues.append(&amp;mut rvalues);
</a><a href="#h4-0-23" id="h4-0-23" class="i">+                    Some(lvalues)
</a><a href="#h4-0-24" id="h4-0-24" class="i">+                }
</a><a href="#h4-0-25" id="h4-0-25" class="i">+                _ =&gt; None,
</a><a href="#h4-0-26" id="h4-0-26" class="i">+            },
</a><a href="#h4-0-27" id="h4-0-27" class="i">+            _ =&gt; None,
</a><a href="#h4-0-28" id="h4-0-28" class="i">+        }
</a><a href="#h4-0-29" id="h4-0-29" class="i">+    }
</a><a href="#h4-0-30" id="h4-0-30" class="i">+
</a><a href="#h4-0-31" id="h4-0-31" class="i">+    // Creates an expression from a list of field lookup values.
</a><a href="#h4-0-32" id="h4-0-32" class="i">+    pub fn from_lookup(
</a><a href="#h4-0-33" id="h4-0-33" class="i">+        field: usize,
</a><a href="#h4-0-34" id="h4-0-34" class="i">+        label: Option&lt;(Option&lt;String&gt;, String)&gt;,
</a><a href="#h4-0-35" id="h4-0-35" class="i">+        values: Vec&lt;Value&gt;,
</a><a href="#h4-0-36" id="h4-0-36" class="i">+    ) -&gt; Self {
</a><a href="#h4-0-37" id="h4-0-37" class="i">+        if values.is_empty() {
</a><a href="#h4-0-38" id="h4-0-38" class="i">+            return Expression::Equal(
</a><a href="#h4-0-39" id="h4-0-39" class="i">+                Expression::Field(field, label).into(),
</a><a href="#h4-0-40" id="h4-0-40" class="i">+                Expression::Constant(Value::Null).into(),
</a><a href="#h4-0-41" id="h4-0-41" class="i">+            );
</a><a href="#h4-0-42" id="h4-0-42" class="i">+        }
</a><a href="#h4-0-43" id="h4-0-43" class="i">+        Self::from_dnf_vec(
</a><a href="#h4-0-44" id="h4-0-44" class="i">+            values
</a><a href="#h4-0-45" id="h4-0-45" class="i">+                .into_iter()
</a><a href="#h4-0-46" id="h4-0-46" class="i">+                .map(|v| {
</a><a href="#h4-0-47" id="h4-0-47" class="i">+                    Expression::Equal(
</a><a href="#h4-0-48" id="h4-0-48" class="i">+                        Expression::Field(field, label.clone()).into(),
</a><a href="#h4-0-49" id="h4-0-49" class="i">+                        Expression::Constant(v).into(),
</a><a href="#h4-0-50" id="h4-0-50" class="i">+                    )
</a><a href="#h4-0-51" id="h4-0-51" class="i">+                })
</a><a href="#h4-0-52" id="h4-0-52" class="i">+                .collect(),
</a><a href="#h4-0-53" id="h4-0-53" class="i">+        )
</a><a href="#h4-0-54" id="h4-0-54" class="i">+        .unwrap()
</a><a href="#h4-0-55" id="h4-0-55" class="i">+    }
</a> }
<b>diff --git a/<a id="h5" href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a> b/<a href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -304,6 +304,7 @@ test_query! {
</a>     join_inner_on_missing: &quot;SELECT * FROM movies INNER JOIN genres&quot;,
     join_inner_on_where: &quot;SELECT * FROM movies INNER JOIN genres ON movies.genre_id = genres.id WHERE movies.id &gt;= 3&quot;,
     join_inner_index_transverse: &quot;SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id AND g.id = 4&quot;,
<a href="#h5-0-3" id="h5-0-3" class="i">+    join_inner_index_transverse_where: &quot;SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id WHERE g.id = 4&quot;,
</a>     join_inner_multi: r#&quot;
         SELECT movies.title, genres.name AS genre, studios.name AS studio
         FROM movies
<b>diff --git a/<a id="h6" href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a> b/<a href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -100,14 +100,16 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h6-0-3" id="h6-0-3" class="d">-                    predicate: Not(
</a><a href="#h6-0-4" id="h6-0-4" class="d">-                        IsNull(
</a><a href="#h6-0-5" id="h6-0-5" class="d">-                            Field(
</a><a href="#h6-0-6" id="h6-0-6" class="d">-                                1,
</a><a href="#h6-0-7" id="h6-0-7" class="d">-                                Some(
</a><a href="#h6-0-8" id="h6-0-8" class="d">-                                    (
</a><a href="#h6-0-9" id="h6-0-9" class="d">-                                        None,
</a><a href="#h6-0-10" id="h6-0-10" class="d">-                                        &quot;b&quot;,
</a><a href="#h6-0-11" id="h6-0-11" class="i">+                    predicate: Some(
</a><a href="#h6-0-12" id="h6-0-12" class="i">+                        Not(
</a><a href="#h6-0-13" id="h6-0-13" class="i">+                            IsNull(
</a><a href="#h6-0-14" id="h6-0-14" class="i">+                                Field(
</a><a href="#h6-0-15" id="h6-0-15" class="i">+                                    1,
</a><a href="#h6-0-16" id="h6-0-16" class="i">+                                    Some(
</a><a href="#h6-0-17" id="h6-0-17" class="i">+                                        (
</a><a href="#h6-0-18" id="h6-0-18" class="i">+                                            None,
</a><a href="#h6-0-19" id="h6-0-19" class="i">+                                            &quot;b&quot;,
</a><a href="#h6-0-20" id="h6-0-20" class="i">+                                        ),
</a>                                     ),
                                 ),
                             ),
<a href="#h6-1" id="h6-1" class="h">@@ -229,24 +231,27 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h6-1-3" id="h6-1-3" class="d">-                source: Scan {
</a><a href="#h6-1-4" id="h6-1-4" class="d">-                    table: &quot;booleans&quot;,
</a><a href="#h6-1-5" id="h6-1-5" class="d">-                    alias: None,
</a><a href="#h6-1-6" id="h6-1-6" class="d">-                    filter: Some(
</a><a href="#h6-1-7" id="h6-1-7" class="d">-                        Not(
</a><a href="#h6-1-8" id="h6-1-8" class="d">-                            IsNull(
</a><a href="#h6-1-9" id="h6-1-9" class="d">-                                Field(
</a><a href="#h6-1-10" id="h6-1-10" class="d">-                                    1,
</a><a href="#h6-1-11" id="h6-1-11" class="d">-                                    Some(
</a><a href="#h6-1-12" id="h6-1-12" class="d">-                                        (
</a><a href="#h6-1-13" id="h6-1-13" class="d">-                                            None,
</a><a href="#h6-1-14" id="h6-1-14" class="d">-                                            &quot;b&quot;,
</a><a href="#h6-1-15" id="h6-1-15" class="i">+                source: Filter {
</a><a href="#h6-1-16" id="h6-1-16" class="i">+                    source: Scan {
</a><a href="#h6-1-17" id="h6-1-17" class="i">+                        table: &quot;booleans&quot;,
</a><a href="#h6-1-18" id="h6-1-18" class="i">+                        alias: None,
</a><a href="#h6-1-19" id="h6-1-19" class="i">+                        filter: Some(
</a><a href="#h6-1-20" id="h6-1-20" class="i">+                            Not(
</a><a href="#h6-1-21" id="h6-1-21" class="i">+                                IsNull(
</a><a href="#h6-1-22" id="h6-1-22" class="i">+                                    Field(
</a><a href="#h6-1-23" id="h6-1-23" class="i">+                                        1,
</a><a href="#h6-1-24" id="h6-1-24" class="i">+                                        Some(
</a><a href="#h6-1-25" id="h6-1-25" class="i">+                                            (
</a><a href="#h6-1-26" id="h6-1-26" class="i">+                                                None,
</a><a href="#h6-1-27" id="h6-1-27" class="i">+                                                &quot;b&quot;,
</a><a href="#h6-1-28" id="h6-1-28" class="i">+                                            ),
</a>                                         ),
                                     ),
                                 ),
                             ),
                         ),
<a href="#h6-1-34" id="h6-1-34" class="d">-                    ),
</a><a href="#h6-1-35" id="h6-1-35" class="i">+                    },
</a><a href="#h6-1-36" id="h6-1-36" class="i">+                    predicate: None,
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h7" href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a> b/<a href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -100,14 +100,16 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h7-0-3" id="h7-0-3" class="d">-                    predicate: Not(
</a><a href="#h7-0-4" id="h7-0-4" class="d">-                        IsNull(
</a><a href="#h7-0-5" id="h7-0-5" class="d">-                            Field(
</a><a href="#h7-0-6" id="h7-0-6" class="d">-                                1,
</a><a href="#h7-0-7" id="h7-0-7" class="d">-                                Some(
</a><a href="#h7-0-8" id="h7-0-8" class="d">-                                    (
</a><a href="#h7-0-9" id="h7-0-9" class="d">-                                        None,
</a><a href="#h7-0-10" id="h7-0-10" class="d">-                                        &quot;f&quot;,
</a><a href="#h7-0-11" id="h7-0-11" class="i">+                    predicate: Some(
</a><a href="#h7-0-12" id="h7-0-12" class="i">+                        Not(
</a><a href="#h7-0-13" id="h7-0-13" class="i">+                            IsNull(
</a><a href="#h7-0-14" id="h7-0-14" class="i">+                                Field(
</a><a href="#h7-0-15" id="h7-0-15" class="i">+                                    1,
</a><a href="#h7-0-16" id="h7-0-16" class="i">+                                    Some(
</a><a href="#h7-0-17" id="h7-0-17" class="i">+                                        (
</a><a href="#h7-0-18" id="h7-0-18" class="i">+                                            None,
</a><a href="#h7-0-19" id="h7-0-19" class="i">+                                            &quot;f&quot;,
</a><a href="#h7-0-20" id="h7-0-20" class="i">+                                        ),
</a>                                     ),
                                 ),
                             ),
<a href="#h7-1" id="h7-1" class="h">@@ -229,24 +231,27 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h7-1-3" id="h7-1-3" class="d">-                source: Scan {
</a><a href="#h7-1-4" id="h7-1-4" class="d">-                    table: &quot;floats&quot;,
</a><a href="#h7-1-5" id="h7-1-5" class="d">-                    alias: None,
</a><a href="#h7-1-6" id="h7-1-6" class="d">-                    filter: Some(
</a><a href="#h7-1-7" id="h7-1-7" class="d">-                        Not(
</a><a href="#h7-1-8" id="h7-1-8" class="d">-                            IsNull(
</a><a href="#h7-1-9" id="h7-1-9" class="d">-                                Field(
</a><a href="#h7-1-10" id="h7-1-10" class="d">-                                    1,
</a><a href="#h7-1-11" id="h7-1-11" class="d">-                                    Some(
</a><a href="#h7-1-12" id="h7-1-12" class="d">-                                        (
</a><a href="#h7-1-13" id="h7-1-13" class="d">-                                            None,
</a><a href="#h7-1-14" id="h7-1-14" class="d">-                                            &quot;f&quot;,
</a><a href="#h7-1-15" id="h7-1-15" class="i">+                source: Filter {
</a><a href="#h7-1-16" id="h7-1-16" class="i">+                    source: Scan {
</a><a href="#h7-1-17" id="h7-1-17" class="i">+                        table: &quot;floats&quot;,
</a><a href="#h7-1-18" id="h7-1-18" class="i">+                        alias: None,
</a><a href="#h7-1-19" id="h7-1-19" class="i">+                        filter: Some(
</a><a href="#h7-1-20" id="h7-1-20" class="i">+                            Not(
</a><a href="#h7-1-21" id="h7-1-21" class="i">+                                IsNull(
</a><a href="#h7-1-22" id="h7-1-22" class="i">+                                    Field(
</a><a href="#h7-1-23" id="h7-1-23" class="i">+                                        1,
</a><a href="#h7-1-24" id="h7-1-24" class="i">+                                        Some(
</a><a href="#h7-1-25" id="h7-1-25" class="i">+                                            (
</a><a href="#h7-1-26" id="h7-1-26" class="i">+                                                None,
</a><a href="#h7-1-27" id="h7-1-27" class="i">+                                                &quot;f&quot;,
</a><a href="#h7-1-28" id="h7-1-28" class="i">+                                            ),
</a>                                         ),
                                     ),
                                 ),
                             ),
                         ),
<a href="#h7-1-34" id="h7-1-34" class="d">-                    ),
</a><a href="#h7-1-35" id="h7-1-35" class="i">+                    },
</a><a href="#h7-1-36" id="h7-1-36" class="i">+                    predicate: None,
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h8" href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a> b/<a href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -100,14 +100,16 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h8-0-3" id="h8-0-3" class="d">-                    predicate: Not(
</a><a href="#h8-0-4" id="h8-0-4" class="d">-                        IsNull(
</a><a href="#h8-0-5" id="h8-0-5" class="d">-                            Field(
</a><a href="#h8-0-6" id="h8-0-6" class="d">-                                1,
</a><a href="#h8-0-7" id="h8-0-7" class="d">-                                Some(
</a><a href="#h8-0-8" id="h8-0-8" class="d">-                                    (
</a><a href="#h8-0-9" id="h8-0-9" class="d">-                                        None,
</a><a href="#h8-0-10" id="h8-0-10" class="d">-                                        &quot;i&quot;,
</a><a href="#h8-0-11" id="h8-0-11" class="i">+                    predicate: Some(
</a><a href="#h8-0-12" id="h8-0-12" class="i">+                        Not(
</a><a href="#h8-0-13" id="h8-0-13" class="i">+                            IsNull(
</a><a href="#h8-0-14" id="h8-0-14" class="i">+                                Field(
</a><a href="#h8-0-15" id="h8-0-15" class="i">+                                    1,
</a><a href="#h8-0-16" id="h8-0-16" class="i">+                                    Some(
</a><a href="#h8-0-17" id="h8-0-17" class="i">+                                        (
</a><a href="#h8-0-18" id="h8-0-18" class="i">+                                            None,
</a><a href="#h8-0-19" id="h8-0-19" class="i">+                                            &quot;i&quot;,
</a><a href="#h8-0-20" id="h8-0-20" class="i">+                                        ),
</a>                                     ),
                                 ),
                             ),
<a href="#h8-1" id="h8-1" class="h">@@ -229,24 +231,27 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h8-1-3" id="h8-1-3" class="d">-                source: Scan {
</a><a href="#h8-1-4" id="h8-1-4" class="d">-                    table: &quot;integers&quot;,
</a><a href="#h8-1-5" id="h8-1-5" class="d">-                    alias: None,
</a><a href="#h8-1-6" id="h8-1-6" class="d">-                    filter: Some(
</a><a href="#h8-1-7" id="h8-1-7" class="d">-                        Not(
</a><a href="#h8-1-8" id="h8-1-8" class="d">-                            IsNull(
</a><a href="#h8-1-9" id="h8-1-9" class="d">-                                Field(
</a><a href="#h8-1-10" id="h8-1-10" class="d">-                                    1,
</a><a href="#h8-1-11" id="h8-1-11" class="d">-                                    Some(
</a><a href="#h8-1-12" id="h8-1-12" class="d">-                                        (
</a><a href="#h8-1-13" id="h8-1-13" class="d">-                                            None,
</a><a href="#h8-1-14" id="h8-1-14" class="d">-                                            &quot;i&quot;,
</a><a href="#h8-1-15" id="h8-1-15" class="i">+                source: Filter {
</a><a href="#h8-1-16" id="h8-1-16" class="i">+                    source: Scan {
</a><a href="#h8-1-17" id="h8-1-17" class="i">+                        table: &quot;integers&quot;,
</a><a href="#h8-1-18" id="h8-1-18" class="i">+                        alias: None,
</a><a href="#h8-1-19" id="h8-1-19" class="i">+                        filter: Some(
</a><a href="#h8-1-20" id="h8-1-20" class="i">+                            Not(
</a><a href="#h8-1-21" id="h8-1-21" class="i">+                                IsNull(
</a><a href="#h8-1-22" id="h8-1-22" class="i">+                                    Field(
</a><a href="#h8-1-23" id="h8-1-23" class="i">+                                        1,
</a><a href="#h8-1-24" id="h8-1-24" class="i">+                                        Some(
</a><a href="#h8-1-25" id="h8-1-25" class="i">+                                            (
</a><a href="#h8-1-26" id="h8-1-26" class="i">+                                                None,
</a><a href="#h8-1-27" id="h8-1-27" class="i">+                                                &quot;i&quot;,
</a><a href="#h8-1-28" id="h8-1-28" class="i">+                                            ),
</a>                                         ),
                                     ),
                                 ),
                             ),
                         ),
<a href="#h8-1-34" id="h8-1-34" class="d">-                    ),
</a><a href="#h8-1-35" id="h8-1-35" class="i">+                    },
</a><a href="#h8-1-36" id="h8-1-36" class="i">+                    predicate: None,
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h9" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -93,9 +93,11 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h9-0-3" id="h9-0-3" class="d">-                    predicate: Constant(
</a><a href="#h9-0-4" id="h9-0-4" class="d">-                        Boolean(
</a><a href="#h9-0-5" id="h9-0-5" class="d">-                            false,
</a><a href="#h9-0-6" id="h9-0-6" class="i">+                    predicate: Some(
</a><a href="#h9-0-7" id="h9-0-7" class="i">+                        Constant(
</a><a href="#h9-0-8" id="h9-0-8" class="i">+                            Boolean(
</a><a href="#h9-0-9" id="h9-0-9" class="i">+                                false,
</a><a href="#h9-0-10" id="h9-0-10" class="i">+                            ),
</a>                         ),
                     ),
                 },
<a href="#h9-1" id="h9-1" class="h">@@ -214,16 +216,19 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h9-1-3" id="h9-1-3" class="d">-                source: Scan {
</a><a href="#h9-1-4" id="h9-1-4" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h9-1-5" id="h9-1-5" class="d">-                    alias: None,
</a><a href="#h9-1-6" id="h9-1-6" class="d">-                    filter: Some(
</a><a href="#h9-1-7" id="h9-1-7" class="d">-                        Constant(
</a><a href="#h9-1-8" id="h9-1-8" class="d">-                            Boolean(
</a><a href="#h9-1-9" id="h9-1-9" class="d">-                                false,
</a><a href="#h9-1-10" id="h9-1-10" class="i">+                source: Filter {
</a><a href="#h9-1-11" id="h9-1-11" class="i">+                    source: Scan {
</a><a href="#h9-1-12" id="h9-1-12" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h9-1-13" id="h9-1-13" class="i">+                        alias: None,
</a><a href="#h9-1-14" id="h9-1-14" class="i">+                        filter: Some(
</a><a href="#h9-1-15" id="h9-1-15" class="i">+                            Constant(
</a><a href="#h9-1-16" id="h9-1-16" class="i">+                                Boolean(
</a><a href="#h9-1-17" id="h9-1-17" class="i">+                                    false,
</a><a href="#h9-1-18" id="h9-1-18" class="i">+                                ),
</a>                             ),
                         ),
<a href="#h9-1-21" id="h9-1-21" class="d">-                    ),
</a><a href="#h9-1-22" id="h9-1-22" class="i">+                    },
</a><a href="#h9-1-23" id="h9-1-23" class="i">+                    predicate: None,
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h10" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -98,9 +98,11 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h10-0-3" id="h10-0-3" class="d">-                    predicate: Constant(
</a><a href="#h10-0-4" id="h10-0-4" class="d">-                        Boolean(
</a><a href="#h10-0-5" id="h10-0-5" class="d">-                            false,
</a><a href="#h10-0-6" id="h10-0-6" class="i">+                    predicate: Some(
</a><a href="#h10-0-7" id="h10-0-7" class="i">+                        Constant(
</a><a href="#h10-0-8" id="h10-0-8" class="i">+                            Boolean(
</a><a href="#h10-0-9" id="h10-0-9" class="i">+                                false,
</a><a href="#h10-0-10" id="h10-0-10" class="i">+                            ),
</a>                         ),
                     ),
                 },
<a href="#h10-1" id="h10-1" class="h">@@ -231,16 +233,19 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h10-1-3" id="h10-1-3" class="d">-                source: Scan {
</a><a href="#h10-1-4" id="h10-1-4" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h10-1-5" id="h10-1-5" class="d">-                    alias: None,
</a><a href="#h10-1-6" id="h10-1-6" class="d">-                    filter: Some(
</a><a href="#h10-1-7" id="h10-1-7" class="d">-                        Constant(
</a><a href="#h10-1-8" id="h10-1-8" class="d">-                            Boolean(
</a><a href="#h10-1-9" id="h10-1-9" class="d">-                                false,
</a><a href="#h10-1-10" id="h10-1-10" class="i">+                source: Filter {
</a><a href="#h10-1-11" id="h10-1-11" class="i">+                    source: Scan {
</a><a href="#h10-1-12" id="h10-1-12" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h10-1-13" id="h10-1-13" class="i">+                        alias: None,
</a><a href="#h10-1-14" id="h10-1-14" class="i">+                        filter: Some(
</a><a href="#h10-1-15" id="h10-1-15" class="i">+                            Constant(
</a><a href="#h10-1-16" id="h10-1-16" class="i">+                                Boolean(
</a><a href="#h10-1-17" id="h10-1-17" class="i">+                                    false,
</a><a href="#h10-1-18" id="h10-1-18" class="i">+                                ),
</a>                             ),
                         ),
<a href="#h10-1-21" id="h10-1-21" class="d">-                    ),
</a><a href="#h10-1-22" id="h10-1-22" class="i">+                    },
</a><a href="#h10-1-23" id="h10-1-23" class="i">+                    predicate: None,
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h11" href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a> b/<a href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -100,14 +100,16 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h11-0-3" id="h11-0-3" class="d">-                    predicate: Not(
</a><a href="#h11-0-4" id="h11-0-4" class="d">-                        IsNull(
</a><a href="#h11-0-5" id="h11-0-5" class="d">-                            Field(
</a><a href="#h11-0-6" id="h11-0-6" class="d">-                                1,
</a><a href="#h11-0-7" id="h11-0-7" class="d">-                                Some(
</a><a href="#h11-0-8" id="h11-0-8" class="d">-                                    (
</a><a href="#h11-0-9" id="h11-0-9" class="d">-                                        None,
</a><a href="#h11-0-10" id="h11-0-10" class="d">-                                        &quot;s&quot;,
</a><a href="#h11-0-11" id="h11-0-11" class="i">+                    predicate: Some(
</a><a href="#h11-0-12" id="h11-0-12" class="i">+                        Not(
</a><a href="#h11-0-13" id="h11-0-13" class="i">+                            IsNull(
</a><a href="#h11-0-14" id="h11-0-14" class="i">+                                Field(
</a><a href="#h11-0-15" id="h11-0-15" class="i">+                                    1,
</a><a href="#h11-0-16" id="h11-0-16" class="i">+                                    Some(
</a><a href="#h11-0-17" id="h11-0-17" class="i">+                                        (
</a><a href="#h11-0-18" id="h11-0-18" class="i">+                                            None,
</a><a href="#h11-0-19" id="h11-0-19" class="i">+                                            &quot;s&quot;,
</a><a href="#h11-0-20" id="h11-0-20" class="i">+                                        ),
</a>                                     ),
                                 ),
                             ),
<a href="#h11-1" id="h11-1" class="h">@@ -229,24 +231,27 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h11-1-3" id="h11-1-3" class="d">-                source: Scan {
</a><a href="#h11-1-4" id="h11-1-4" class="d">-                    table: &quot;strings&quot;,
</a><a href="#h11-1-5" id="h11-1-5" class="d">-                    alias: None,
</a><a href="#h11-1-6" id="h11-1-6" class="d">-                    filter: Some(
</a><a href="#h11-1-7" id="h11-1-7" class="d">-                        Not(
</a><a href="#h11-1-8" id="h11-1-8" class="d">-                            IsNull(
</a><a href="#h11-1-9" id="h11-1-9" class="d">-                                Field(
</a><a href="#h11-1-10" id="h11-1-10" class="d">-                                    1,
</a><a href="#h11-1-11" id="h11-1-11" class="d">-                                    Some(
</a><a href="#h11-1-12" id="h11-1-12" class="d">-                                        (
</a><a href="#h11-1-13" id="h11-1-13" class="d">-                                            None,
</a><a href="#h11-1-14" id="h11-1-14" class="d">-                                            &quot;s&quot;,
</a><a href="#h11-1-15" id="h11-1-15" class="i">+                source: Filter {
</a><a href="#h11-1-16" id="h11-1-16" class="i">+                    source: Scan {
</a><a href="#h11-1-17" id="h11-1-17" class="i">+                        table: &quot;strings&quot;,
</a><a href="#h11-1-18" id="h11-1-18" class="i">+                        alias: None,
</a><a href="#h11-1-19" id="h11-1-19" class="i">+                        filter: Some(
</a><a href="#h11-1-20" id="h11-1-20" class="i">+                            Not(
</a><a href="#h11-1-21" id="h11-1-21" class="i">+                                IsNull(
</a><a href="#h11-1-22" id="h11-1-22" class="i">+                                    Field(
</a><a href="#h11-1-23" id="h11-1-23" class="i">+                                        1,
</a><a href="#h11-1-24" id="h11-1-24" class="i">+                                        Some(
</a><a href="#h11-1-25" id="h11-1-25" class="i">+                                            (
</a><a href="#h11-1-26" id="h11-1-26" class="i">+                                                None,
</a><a href="#h11-1-27" id="h11-1-27" class="i">+                                                &quot;s&quot;,
</a><a href="#h11-1-28" id="h11-1-28" class="i">+                                            ),
</a>                                         ),
                                     ),
                                 ),
                             ),
                         ),
<a href="#h11-1-34" id="h11-1-34" class="d">-                    ),
</a><a href="#h11-1-35" id="h11-1-35" class="i">+                    },
</a><a href="#h11-1-36" id="h11-1-36" class="i">+                    predicate: None,
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h12" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -126,14 +126,16 @@ Plan: Plan(
</a>                     ),
                 ],
             },
<a href="#h12-0-3" id="h12-0-3" class="d">-            predicate: GreaterThan(
</a><a href="#h12-0-4" id="h12-0-4" class="d">-                Field(
</a><a href="#h12-0-5" id="h12-0-5" class="d">-                    1,
</a><a href="#h12-0-6" id="h12-0-6" class="d">-                    None,
</a><a href="#h12-0-7" id="h12-0-7" class="d">-                ),
</a><a href="#h12-0-8" id="h12-0-8" class="d">-                Constant(
</a><a href="#h12-0-9" id="h12-0-9" class="d">-                    Integer(
</a><a href="#h12-0-10" id="h12-0-10" class="d">-                        8,
</a><a href="#h12-0-11" id="h12-0-11" class="i">+            predicate: Some(
</a><a href="#h12-0-12" id="h12-0-12" class="i">+                GreaterThan(
</a><a href="#h12-0-13" id="h12-0-13" class="i">+                    Field(
</a><a href="#h12-0-14" id="h12-0-14" class="i">+                        1,
</a><a href="#h12-0-15" id="h12-0-15" class="i">+                        None,
</a><a href="#h12-0-16" id="h12-0-16" class="i">+                    ),
</a><a href="#h12-0-17" id="h12-0-17" class="i">+                    Constant(
</a><a href="#h12-0-18" id="h12-0-18" class="i">+                        Integer(
</a><a href="#h12-0-19" id="h12-0-19" class="i">+                            8,
</a><a href="#h12-0-20" id="h12-0-20" class="i">+                        ),
</a>                     ),
                 ),
             ),
<a href="#h12-1" id="h12-1" class="h">@@ -211,14 +213,16 @@ Optimized plan: Plan(
</a>                     ),
                 ],
             },
<a href="#h12-1-3" id="h12-1-3" class="d">-            predicate: GreaterThan(
</a><a href="#h12-1-4" id="h12-1-4" class="d">-                Field(
</a><a href="#h12-1-5" id="h12-1-5" class="d">-                    1,
</a><a href="#h12-1-6" id="h12-1-6" class="d">-                    None,
</a><a href="#h12-1-7" id="h12-1-7" class="d">-                ),
</a><a href="#h12-1-8" id="h12-1-8" class="d">-                Constant(
</a><a href="#h12-1-9" id="h12-1-9" class="d">-                    Integer(
</a><a href="#h12-1-10" id="h12-1-10" class="d">-                        8,
</a><a href="#h12-1-11" id="h12-1-11" class="i">+            predicate: Some(
</a><a href="#h12-1-12" id="h12-1-12" class="i">+                GreaterThan(
</a><a href="#h12-1-13" id="h12-1-13" class="i">+                    Field(
</a><a href="#h12-1-14" id="h12-1-14" class="i">+                        1,
</a><a href="#h12-1-15" id="h12-1-15" class="i">+                        None,
</a><a href="#h12-1-16" id="h12-1-16" class="i">+                    ),
</a><a href="#h12-1-17" id="h12-1-17" class="i">+                    Constant(
</a><a href="#h12-1-18" id="h12-1-18" class="i">+                        Integer(
</a><a href="#h12-1-19" id="h12-1-19" class="i">+                            8,
</a><a href="#h12-1-20" id="h12-1-20" class="i">+                        ),
</a>                     ),
                 ),
             ),
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -148,14 +148,16 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h13-0-3" id="h13-0-3" class="d">-                predicate: GreaterThan(
</a><a href="#h13-0-4" id="h13-0-4" class="d">-                    Field(
</a><a href="#h13-0-5" id="h13-0-5" class="d">-                        2,
</a><a href="#h13-0-6" id="h13-0-6" class="d">-                        None,
</a><a href="#h13-0-7" id="h13-0-7" class="d">-                    ),
</a><a href="#h13-0-8" id="h13-0-8" class="d">-                    Constant(
</a><a href="#h13-0-9" id="h13-0-9" class="d">-                        Integer(
</a><a href="#h13-0-10" id="h13-0-10" class="d">-                            7,
</a><a href="#h13-0-11" id="h13-0-11" class="i">+                predicate: Some(
</a><a href="#h13-0-12" id="h13-0-12" class="i">+                    GreaterThan(
</a><a href="#h13-0-13" id="h13-0-13" class="i">+                        Field(
</a><a href="#h13-0-14" id="h13-0-14" class="i">+                            2,
</a><a href="#h13-0-15" id="h13-0-15" class="i">+                            None,
</a><a href="#h13-0-16" id="h13-0-16" class="i">+                        ),
</a><a href="#h13-0-17" id="h13-0-17" class="i">+                        Constant(
</a><a href="#h13-0-18" id="h13-0-18" class="i">+                            Integer(
</a><a href="#h13-0-19" id="h13-0-19" class="i">+                                7,
</a><a href="#h13-0-20" id="h13-0-20" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<a href="#h13-1" id="h13-1" class="h">@@ -269,14 +271,16 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h13-1-3" id="h13-1-3" class="d">-                predicate: GreaterThan(
</a><a href="#h13-1-4" id="h13-1-4" class="d">-                    Field(
</a><a href="#h13-1-5" id="h13-1-5" class="d">-                        2,
</a><a href="#h13-1-6" id="h13-1-6" class="d">-                        None,
</a><a href="#h13-1-7" id="h13-1-7" class="d">-                    ),
</a><a href="#h13-1-8" id="h13-1-8" class="d">-                    Constant(
</a><a href="#h13-1-9" id="h13-1-9" class="d">-                        Integer(
</a><a href="#h13-1-10" id="h13-1-10" class="d">-                            7,
</a><a href="#h13-1-11" id="h13-1-11" class="i">+                predicate: Some(
</a><a href="#h13-1-12" id="h13-1-12" class="i">+                    GreaterThan(
</a><a href="#h13-1-13" id="h13-1-13" class="i">+                        Field(
</a><a href="#h13-1-14" id="h13-1-14" class="i">+                            2,
</a><a href="#h13-1-15" id="h13-1-15" class="i">+                            None,
</a><a href="#h13-1-16" id="h13-1-16" class="i">+                        ),
</a><a href="#h13-1-17" id="h13-1-17" class="i">+                        Constant(
</a><a href="#h13-1-18" id="h13-1-18" class="i">+                            Integer(
</a><a href="#h13-1-19" id="h13-1-19" class="i">+                                7,
</a><a href="#h13-1-20" id="h13-1-20" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<b>diff --git a/<a id="h14" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -181,20 +181,22 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h14-0-3" id="h14-0-3" class="d">-                predicate: LessThan(
</a><a href="#h14-0-4" id="h14-0-4" class="d">-                    Subtract(
</a><a href="#h14-0-5" id="h14-0-5" class="d">-                        Field(
</a><a href="#h14-0-6" id="h14-0-6" class="d">-                            2,
</a><a href="#h14-0-7" id="h14-0-7" class="d">-                            None,
</a><a href="#h14-0-8" id="h14-0-8" class="d">-                        ),
</a><a href="#h14-0-9" id="h14-0-9" class="d">-                        Field(
</a><a href="#h14-0-10" id="h14-0-10" class="d">-                            3,
</a><a href="#h14-0-11" id="h14-0-11" class="d">-                            None,
</a><a href="#h14-0-12" id="h14-0-12" class="i">+                predicate: Some(
</a><a href="#h14-0-13" id="h14-0-13" class="i">+                    LessThan(
</a><a href="#h14-0-14" id="h14-0-14" class="i">+                        Subtract(
</a><a href="#h14-0-15" id="h14-0-15" class="i">+                            Field(
</a><a href="#h14-0-16" id="h14-0-16" class="i">+                                2,
</a><a href="#h14-0-17" id="h14-0-17" class="i">+                                None,
</a><a href="#h14-0-18" id="h14-0-18" class="i">+                            ),
</a><a href="#h14-0-19" id="h14-0-19" class="i">+                            Field(
</a><a href="#h14-0-20" id="h14-0-20" class="i">+                                3,
</a><a href="#h14-0-21" id="h14-0-21" class="i">+                                None,
</a><a href="#h14-0-22" id="h14-0-22" class="i">+                            ),
</a>                         ),
<a href="#h14-0-24" id="h14-0-24" class="d">-                    ),
</a><a href="#h14-0-25" id="h14-0-25" class="d">-                    Constant(
</a><a href="#h14-0-26" id="h14-0-26" class="d">-                        Integer(
</a><a href="#h14-0-27" id="h14-0-27" class="d">-                            1,
</a><a href="#h14-0-28" id="h14-0-28" class="i">+                        Constant(
</a><a href="#h14-0-29" id="h14-0-29" class="i">+                            Integer(
</a><a href="#h14-0-30" id="h14-0-30" class="i">+                                1,
</a><a href="#h14-0-31" id="h14-0-31" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<a href="#h14-1" id="h14-1" class="h">@@ -328,20 +330,22 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h14-1-3" id="h14-1-3" class="d">-                predicate: LessThan(
</a><a href="#h14-1-4" id="h14-1-4" class="d">-                    Subtract(
</a><a href="#h14-1-5" id="h14-1-5" class="d">-                        Field(
</a><a href="#h14-1-6" id="h14-1-6" class="d">-                            2,
</a><a href="#h14-1-7" id="h14-1-7" class="d">-                            None,
</a><a href="#h14-1-8" id="h14-1-8" class="d">-                        ),
</a><a href="#h14-1-9" id="h14-1-9" class="d">-                        Field(
</a><a href="#h14-1-10" id="h14-1-10" class="d">-                            3,
</a><a href="#h14-1-11" id="h14-1-11" class="d">-                            None,
</a><a href="#h14-1-12" id="h14-1-12" class="i">+                predicate: Some(
</a><a href="#h14-1-13" id="h14-1-13" class="i">+                    LessThan(
</a><a href="#h14-1-14" id="h14-1-14" class="i">+                        Subtract(
</a><a href="#h14-1-15" id="h14-1-15" class="i">+                            Field(
</a><a href="#h14-1-16" id="h14-1-16" class="i">+                                2,
</a><a href="#h14-1-17" id="h14-1-17" class="i">+                                None,
</a><a href="#h14-1-18" id="h14-1-18" class="i">+                            ),
</a><a href="#h14-1-19" id="h14-1-19" class="i">+                            Field(
</a><a href="#h14-1-20" id="h14-1-20" class="i">+                                3,
</a><a href="#h14-1-21" id="h14-1-21" class="i">+                                None,
</a><a href="#h14-1-22" id="h14-1-22" class="i">+                            ),
</a>                         ),
<a href="#h14-1-24" id="h14-1-24" class="d">-                    ),
</a><a href="#h14-1-25" id="h14-1-25" class="d">-                    Constant(
</a><a href="#h14-1-26" id="h14-1-26" class="d">-                        Integer(
</a><a href="#h14-1-27" id="h14-1-27" class="d">-                            1,
</a><a href="#h14-1-28" id="h14-1-28" class="i">+                        Constant(
</a><a href="#h14-1-29" id="h14-1-29" class="i">+                            Integer(
</a><a href="#h14-1-30" id="h14-1-30" class="i">+                                1,
</a><a href="#h14-1-31" id="h14-1-31" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -139,26 +139,28 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h15-0-3" id="h15-0-3" class="d">-                predicate: Or(
</a><a href="#h15-0-4" id="h15-0-4" class="d">-                    GreaterThan(
</a><a href="#h15-0-5" id="h15-0-5" class="d">-                        Field(
</a><a href="#h15-0-6" id="h15-0-6" class="d">-                            2,
</a><a href="#h15-0-7" id="h15-0-7" class="d">-                            None,
</a><a href="#h15-0-8" id="h15-0-8" class="d">-                        ),
</a><a href="#h15-0-9" id="h15-0-9" class="d">-                        Constant(
</a><a href="#h15-0-10" id="h15-0-10" class="d">-                            Integer(
</a><a href="#h15-0-11" id="h15-0-11" class="d">-                                3,
</a><a href="#h15-0-12" id="h15-0-12" class="i">+                predicate: Some(
</a><a href="#h15-0-13" id="h15-0-13" class="i">+                    Or(
</a><a href="#h15-0-14" id="h15-0-14" class="i">+                        GreaterThan(
</a><a href="#h15-0-15" id="h15-0-15" class="i">+                            Field(
</a><a href="#h15-0-16" id="h15-0-16" class="i">+                                2,
</a><a href="#h15-0-17" id="h15-0-17" class="i">+                                None,
</a><a href="#h15-0-18" id="h15-0-18" class="i">+                            ),
</a><a href="#h15-0-19" id="h15-0-19" class="i">+                            Constant(
</a><a href="#h15-0-20" id="h15-0-20" class="i">+                                Integer(
</a><a href="#h15-0-21" id="h15-0-21" class="i">+                                    3,
</a><a href="#h15-0-22" id="h15-0-22" class="i">+                                ),
</a>                             ),
                         ),
<a href="#h15-0-25" id="h15-0-25" class="d">-                    ),
</a><a href="#h15-0-26" id="h15-0-26" class="d">-                    Equal(
</a><a href="#h15-0-27" id="h15-0-27" class="d">-                        Field(
</a><a href="#h15-0-28" id="h15-0-28" class="d">-                            2,
</a><a href="#h15-0-29" id="h15-0-29" class="d">-                            None,
</a><a href="#h15-0-30" id="h15-0-30" class="d">-                        ),
</a><a href="#h15-0-31" id="h15-0-31" class="d">-                        Constant(
</a><a href="#h15-0-32" id="h15-0-32" class="d">-                            Integer(
</a><a href="#h15-0-33" id="h15-0-33" class="d">-                                3,
</a><a href="#h15-0-34" id="h15-0-34" class="i">+                        Equal(
</a><a href="#h15-0-35" id="h15-0-35" class="i">+                            Field(
</a><a href="#h15-0-36" id="h15-0-36" class="i">+                                2,
</a><a href="#h15-0-37" id="h15-0-37" class="i">+                                None,
</a><a href="#h15-0-38" id="h15-0-38" class="i">+                            ),
</a><a href="#h15-0-39" id="h15-0-39" class="i">+                            Constant(
</a><a href="#h15-0-40" id="h15-0-40" class="i">+                                Integer(
</a><a href="#h15-0-41" id="h15-0-41" class="i">+                                    3,
</a><a href="#h15-0-42" id="h15-0-42" class="i">+                                ),
</a>                             ),
                         ),
                     ),
<a href="#h15-1" id="h15-1" class="h">@@ -267,26 +269,28 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h15-1-3" id="h15-1-3" class="d">-                predicate: Or(
</a><a href="#h15-1-4" id="h15-1-4" class="d">-                    GreaterThan(
</a><a href="#h15-1-5" id="h15-1-5" class="d">-                        Field(
</a><a href="#h15-1-6" id="h15-1-6" class="d">-                            2,
</a><a href="#h15-1-7" id="h15-1-7" class="d">-                            None,
</a><a href="#h15-1-8" id="h15-1-8" class="d">-                        ),
</a><a href="#h15-1-9" id="h15-1-9" class="d">-                        Constant(
</a><a href="#h15-1-10" id="h15-1-10" class="d">-                            Integer(
</a><a href="#h15-1-11" id="h15-1-11" class="d">-                                3,
</a><a href="#h15-1-12" id="h15-1-12" class="i">+                predicate: Some(
</a><a href="#h15-1-13" id="h15-1-13" class="i">+                    Or(
</a><a href="#h15-1-14" id="h15-1-14" class="i">+                        GreaterThan(
</a><a href="#h15-1-15" id="h15-1-15" class="i">+                            Field(
</a><a href="#h15-1-16" id="h15-1-16" class="i">+                                2,
</a><a href="#h15-1-17" id="h15-1-17" class="i">+                                None,
</a><a href="#h15-1-18" id="h15-1-18" class="i">+                            ),
</a><a href="#h15-1-19" id="h15-1-19" class="i">+                            Constant(
</a><a href="#h15-1-20" id="h15-1-20" class="i">+                                Integer(
</a><a href="#h15-1-21" id="h15-1-21" class="i">+                                    3,
</a><a href="#h15-1-22" id="h15-1-22" class="i">+                                ),
</a>                             ),
                         ),
<a href="#h15-1-25" id="h15-1-25" class="d">-                    ),
</a><a href="#h15-1-26" id="h15-1-26" class="d">-                    Equal(
</a><a href="#h15-1-27" id="h15-1-27" class="d">-                        Field(
</a><a href="#h15-1-28" id="h15-1-28" class="d">-                            2,
</a><a href="#h15-1-29" id="h15-1-29" class="d">-                            None,
</a><a href="#h15-1-30" id="h15-1-30" class="d">-                        ),
</a><a href="#h15-1-31" id="h15-1-31" class="d">-                        Constant(
</a><a href="#h15-1-32" id="h15-1-32" class="d">-                            Integer(
</a><a href="#h15-1-33" id="h15-1-33" class="d">-                                3,
</a><a href="#h15-1-34" id="h15-1-34" class="i">+                        Equal(
</a><a href="#h15-1-35" id="h15-1-35" class="i">+                            Field(
</a><a href="#h15-1-36" id="h15-1-36" class="i">+                                2,
</a><a href="#h15-1-37" id="h15-1-37" class="i">+                                None,
</a><a href="#h15-1-38" id="h15-1-38" class="i">+                            ),
</a><a href="#h15-1-39" id="h15-1-39" class="i">+                            Constant(
</a><a href="#h15-1-40" id="h15-1-40" class="i">+                                Integer(
</a><a href="#h15-1-41" id="h15-1-41" class="i">+                                    3,
</a><a href="#h15-1-42" id="h15-1-42" class="i">+                                ),
</a>                             ),
                         ),
                     ),
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a> b/<a href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -102,14 +102,16 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h16-0-3" id="h16-0-3" class="d">-                predicate: GreaterThan(
</a><a href="#h16-0-4" id="h16-0-4" class="d">-                    Field(
</a><a href="#h16-0-5" id="h16-0-5" class="d">-                        2,
</a><a href="#h16-0-6" id="h16-0-6" class="d">-                        None,
</a><a href="#h16-0-7" id="h16-0-7" class="d">-                    ),
</a><a href="#h16-0-8" id="h16-0-8" class="d">-                    Constant(
</a><a href="#h16-0-9" id="h16-0-9" class="d">-                        Integer(
</a><a href="#h16-0-10" id="h16-0-10" class="d">-                            8,
</a><a href="#h16-0-11" id="h16-0-11" class="i">+                predicate: Some(
</a><a href="#h16-0-12" id="h16-0-12" class="i">+                    GreaterThan(
</a><a href="#h16-0-13" id="h16-0-13" class="i">+                        Field(
</a><a href="#h16-0-14" id="h16-0-14" class="i">+                            2,
</a><a href="#h16-0-15" id="h16-0-15" class="i">+                            None,
</a><a href="#h16-0-16" id="h16-0-16" class="i">+                        ),
</a><a href="#h16-0-17" id="h16-0-17" class="i">+                        Constant(
</a><a href="#h16-0-18" id="h16-0-18" class="i">+                            Integer(
</a><a href="#h16-0-19" id="h16-0-19" class="i">+                                8,
</a><a href="#h16-0-20" id="h16-0-20" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<a href="#h16-1" id="h16-1" class="h">@@ -192,14 +194,16 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h16-1-3" id="h16-1-3" class="d">-                predicate: GreaterThan(
</a><a href="#h16-1-4" id="h16-1-4" class="d">-                    Field(
</a><a href="#h16-1-5" id="h16-1-5" class="d">-                        2,
</a><a href="#h16-1-6" id="h16-1-6" class="d">-                        None,
</a><a href="#h16-1-7" id="h16-1-7" class="d">-                    ),
</a><a href="#h16-1-8" id="h16-1-8" class="d">-                    Constant(
</a><a href="#h16-1-9" id="h16-1-9" class="d">-                        Integer(
</a><a href="#h16-1-10" id="h16-1-10" class="d">-                            8,
</a><a href="#h16-1-11" id="h16-1-11" class="i">+                predicate: Some(
</a><a href="#h16-1-12" id="h16-1-12" class="i">+                    GreaterThan(
</a><a href="#h16-1-13" id="h16-1-13" class="i">+                        Field(
</a><a href="#h16-1-14" id="h16-1-14" class="i">+                            2,
</a><a href="#h16-1-15" id="h16-1-15" class="i">+                            None,
</a><a href="#h16-1-16" id="h16-1-16" class="i">+                        ),
</a><a href="#h16-1-17" id="h16-1-17" class="i">+                        Constant(
</a><a href="#h16-1-18" id="h16-1-18" class="i">+                            Integer(
</a><a href="#h16-1-19" id="h16-1-19" class="i">+                                8,
</a><a href="#h16-1-20" id="h16-1-20" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -116,14 +116,16 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h17-0-3" id="h17-0-3" class="d">-                predicate: GreaterThan(
</a><a href="#h17-0-4" id="h17-0-4" class="d">-                    Field(
</a><a href="#h17-0-5" id="h17-0-5" class="d">-                        1,
</a><a href="#h17-0-6" id="h17-0-6" class="d">-                        None,
</a><a href="#h17-0-7" id="h17-0-7" class="d">-                    ),
</a><a href="#h17-0-8" id="h17-0-8" class="d">-                    Constant(
</a><a href="#h17-0-9" id="h17-0-9" class="d">-                        Integer(
</a><a href="#h17-0-10" id="h17-0-10" class="d">-                            8,
</a><a href="#h17-0-11" id="h17-0-11" class="i">+                predicate: Some(
</a><a href="#h17-0-12" id="h17-0-12" class="i">+                    GreaterThan(
</a><a href="#h17-0-13" id="h17-0-13" class="i">+                        Field(
</a><a href="#h17-0-14" id="h17-0-14" class="i">+                            1,
</a><a href="#h17-0-15" id="h17-0-15" class="i">+                            None,
</a><a href="#h17-0-16" id="h17-0-16" class="i">+                        ),
</a><a href="#h17-0-17" id="h17-0-17" class="i">+                        Constant(
</a><a href="#h17-0-18" id="h17-0-18" class="i">+                            Integer(
</a><a href="#h17-0-19" id="h17-0-19" class="i">+                                8,
</a><a href="#h17-0-20" id="h17-0-20" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<a href="#h17-1" id="h17-1" class="h">@@ -210,14 +212,16 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h17-1-3" id="h17-1-3" class="d">-                predicate: GreaterThan(
</a><a href="#h17-1-4" id="h17-1-4" class="d">-                    Field(
</a><a href="#h17-1-5" id="h17-1-5" class="d">-                        1,
</a><a href="#h17-1-6" id="h17-1-6" class="d">-                        None,
</a><a href="#h17-1-7" id="h17-1-7" class="d">-                    ),
</a><a href="#h17-1-8" id="h17-1-8" class="d">-                    Constant(
</a><a href="#h17-1-9" id="h17-1-9" class="d">-                        Integer(
</a><a href="#h17-1-10" id="h17-1-10" class="d">-                            8,
</a><a href="#h17-1-11" id="h17-1-11" class="i">+                predicate: Some(
</a><a href="#h17-1-12" id="h17-1-12" class="i">+                    GreaterThan(
</a><a href="#h17-1-13" id="h17-1-13" class="i">+                        Field(
</a><a href="#h17-1-14" id="h17-1-14" class="i">+                            1,
</a><a href="#h17-1-15" id="h17-1-15" class="i">+                            None,
</a><a href="#h17-1-16" id="h17-1-16" class="i">+                        ),
</a><a href="#h17-1-17" id="h17-1-17" class="i">+                        Constant(
</a><a href="#h17-1-18" id="h17-1-18" class="i">+                            Integer(
</a><a href="#h17-1-19" id="h17-1-19" class="i">+                                8,
</a><a href="#h17-1-20" id="h17-1-20" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -187,34 +187,54 @@ Plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h18-0-3" id="h18-0-3" class="d">-            predicate: And(
</a><a href="#h18-0-4" id="h18-0-4" class="i">+            predicate: Some(
</a>                 And(
<a href="#h18-0-6" id="h18-0-6" class="d">-                    Or(
</a><a href="#h18-0-7" id="h18-0-7" class="d">-                        GreaterThan(
</a><a href="#h18-0-8" id="h18-0-8" class="d">-                            Field(
</a><a href="#h18-0-9" id="h18-0-9" class="d">-                                0,
</a><a href="#h18-0-10" id="h18-0-10" class="d">-                                Some(
</a><a href="#h18-0-11" id="h18-0-11" class="d">-                                    (
</a><a href="#h18-0-12" id="h18-0-12" class="d">-                                        Some(
</a><a href="#h18-0-13" id="h18-0-13" class="d">-                                            &quot;m&quot;,
</a><a href="#h18-0-14" id="h18-0-14" class="i">+                    And(
</a><a href="#h18-0-15" id="h18-0-15" class="i">+                        Or(
</a><a href="#h18-0-16" id="h18-0-16" class="i">+                            GreaterThan(
</a><a href="#h18-0-17" id="h18-0-17" class="i">+                                Field(
</a><a href="#h18-0-18" id="h18-0-18" class="i">+                                    0,
</a><a href="#h18-0-19" id="h18-0-19" class="i">+                                    Some(
</a><a href="#h18-0-20" id="h18-0-20" class="i">+                                        (
</a><a href="#h18-0-21" id="h18-0-21" class="i">+                                            Some(
</a><a href="#h18-0-22" id="h18-0-22" class="i">+                                                &quot;m&quot;,
</a><a href="#h18-0-23" id="h18-0-23" class="i">+                                            ),
</a><a href="#h18-0-24" id="h18-0-24" class="i">+                                            &quot;id&quot;,
</a>                                         ),
<a href="#h18-0-26" id="h18-0-26" class="d">-                                        &quot;id&quot;,
</a><a href="#h18-0-27" id="h18-0-27" class="i">+                                    ),
</a><a href="#h18-0-28" id="h18-0-28" class="i">+                                ),
</a><a href="#h18-0-29" id="h18-0-29" class="i">+                                Constant(
</a><a href="#h18-0-30" id="h18-0-30" class="i">+                                    Integer(
</a><a href="#h18-0-31" id="h18-0-31" class="i">+                                        3,
</a>                                     ),
                                 ),
                             ),
<a href="#h18-0-35" id="h18-0-35" class="d">-                            Constant(
</a><a href="#h18-0-36" id="h18-0-36" class="d">-                                Integer(
</a><a href="#h18-0-37" id="h18-0-37" class="d">-                                    3,
</a><a href="#h18-0-38" id="h18-0-38" class="i">+                            Equal(
</a><a href="#h18-0-39" id="h18-0-39" class="i">+                                Field(
</a><a href="#h18-0-40" id="h18-0-40" class="i">+                                    0,
</a><a href="#h18-0-41" id="h18-0-41" class="i">+                                    Some(
</a><a href="#h18-0-42" id="h18-0-42" class="i">+                                        (
</a><a href="#h18-0-43" id="h18-0-43" class="i">+                                            Some(
</a><a href="#h18-0-44" id="h18-0-44" class="i">+                                                &quot;m&quot;,
</a><a href="#h18-0-45" id="h18-0-45" class="i">+                                            ),
</a><a href="#h18-0-46" id="h18-0-46" class="i">+                                            &quot;id&quot;,
</a><a href="#h18-0-47" id="h18-0-47" class="i">+                                        ),
</a><a href="#h18-0-48" id="h18-0-48" class="i">+                                    ),
</a><a href="#h18-0-49" id="h18-0-49" class="i">+                                ),
</a><a href="#h18-0-50" id="h18-0-50" class="i">+                                Constant(
</a><a href="#h18-0-51" id="h18-0-51" class="i">+                                    Integer(
</a><a href="#h18-0-52" id="h18-0-52" class="i">+                                        3,
</a><a href="#h18-0-53" id="h18-0-53" class="i">+                                    ),
</a>                                 ),
                             ),
                         ),
                         Equal(
                             Field(
<a href="#h18-0-59" id="h18-0-59" class="d">-                                0,
</a><a href="#h18-0-60" id="h18-0-60" class="i">+                                7,
</a>                                 Some(
                                     (
                                         Some(
<a href="#h18-0-64" id="h18-0-64" class="d">-                                            &quot;m&quot;,
</a><a href="#h18-0-65" id="h18-0-65" class="i">+                                            &quot;g&quot;,
</a>                                         ),
                                         &quot;id&quot;,
                                     ),
<a href="#h18-1" id="h18-1" class="h">@@ -222,48 +242,30 @@ Plan: Plan(
</a>                             ),
                             Constant(
                                 Integer(
<a href="#h18-1-3" id="h18-1-3" class="d">-                                    3,
</a><a href="#h18-1-4" id="h18-1-4" class="i">+                                    2,
</a>                                 ),
                             ),
                         ),
                     ),
<a href="#h18-1-9" id="h18-1-9" class="d">-                    Equal(
</a><a href="#h18-1-10" id="h18-1-10" class="d">-                        Field(
</a><a href="#h18-1-11" id="h18-1-11" class="d">-                            7,
</a><a href="#h18-1-12" id="h18-1-12" class="d">-                            Some(
</a><a href="#h18-1-13" id="h18-1-13" class="d">-                                (
</a><a href="#h18-1-14" id="h18-1-14" class="d">-                                    Some(
</a><a href="#h18-1-15" id="h18-1-15" class="d">-                                        &quot;g&quot;,
</a><a href="#h18-1-16" id="h18-1-16" class="i">+                    Not(
</a><a href="#h18-1-17" id="h18-1-17" class="i">+                        Equal(
</a><a href="#h18-1-18" id="h18-1-18" class="i">+                            Field(
</a><a href="#h18-1-19" id="h18-1-19" class="i">+                                9,
</a><a href="#h18-1-20" id="h18-1-20" class="i">+                                Some(
</a><a href="#h18-1-21" id="h18-1-21" class="i">+                                    (
</a><a href="#h18-1-22" id="h18-1-22" class="i">+                                        Some(
</a><a href="#h18-1-23" id="h18-1-23" class="i">+                                            &quot;c&quot;,
</a><a href="#h18-1-24" id="h18-1-24" class="i">+                                        ),
</a><a href="#h18-1-25" id="h18-1-25" class="i">+                                        &quot;id&quot;,
</a>                                     ),
<a href="#h18-1-27" id="h18-1-27" class="d">-                                    &quot;id&quot;,
</a>                                 ),
                             ),
<a href="#h18-1-30" id="h18-1-30" class="d">-                        ),
</a><a href="#h18-1-31" id="h18-1-31" class="d">-                        Constant(
</a><a href="#h18-1-32" id="h18-1-32" class="d">-                            Integer(
</a><a href="#h18-1-33" id="h18-1-33" class="d">-                                2,
</a><a href="#h18-1-34" id="h18-1-34" class="d">-                            ),
</a><a href="#h18-1-35" id="h18-1-35" class="d">-                        ),
</a><a href="#h18-1-36" id="h18-1-36" class="d">-                    ),
</a><a href="#h18-1-37" id="h18-1-37" class="d">-                ),
</a><a href="#h18-1-38" id="h18-1-38" class="d">-                Not(
</a><a href="#h18-1-39" id="h18-1-39" class="d">-                    Equal(
</a><a href="#h18-1-40" id="h18-1-40" class="d">-                        Field(
</a><a href="#h18-1-41" id="h18-1-41" class="d">-                            9,
</a><a href="#h18-1-42" id="h18-1-42" class="d">-                            Some(
</a><a href="#h18-1-43" id="h18-1-43" class="d">-                                (
</a><a href="#h18-1-44" id="h18-1-44" class="d">-                                    Some(
</a><a href="#h18-1-45" id="h18-1-45" class="d">-                                        &quot;c&quot;,
</a><a href="#h18-1-46" id="h18-1-46" class="d">-                                    ),
</a><a href="#h18-1-47" id="h18-1-47" class="d">-                                    &quot;id&quot;,
</a><a href="#h18-1-48" id="h18-1-48" class="i">+                            Constant(
</a><a href="#h18-1-49" id="h18-1-49" class="i">+                                String(
</a><a href="#h18-1-50" id="h18-1-50" class="i">+                                    &quot;us&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h18-1-54" id="h18-1-54" class="d">-                        Constant(
</a><a href="#h18-1-55" id="h18-1-55" class="d">-                            String(
</a><a href="#h18-1-56" id="h18-1-56" class="d">-                                &quot;us&quot;,
</a><a href="#h18-1-57" id="h18-1-57" class="d">-                            ),
</a><a href="#h18-1-58" id="h18-1-58" class="d">-                        ),
</a>                     ),
                 ),
             ),
<a href="#h18-2" id="h18-2" class="h">@@ -359,119 +361,105 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Projection {
<a href="#h18-2-3" id="h18-2-3" class="d">-        source: NestedLoopJoin {
</a><a href="#h18-2-4" id="h18-2-4" class="d">-            outer: NestedLoopJoin {
</a><a href="#h18-2-5" id="h18-2-5" class="d">-                outer: Scan {
</a><a href="#h18-2-6" id="h18-2-6" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h18-2-7" id="h18-2-7" class="d">-                    alias: Some(
</a><a href="#h18-2-8" id="h18-2-8" class="d">-                        &quot;m&quot;,
</a><a href="#h18-2-9" id="h18-2-9" class="d">-                    ),
</a><a href="#h18-2-10" id="h18-2-10" class="d">-                    filter: None,
</a><a href="#h18-2-11" id="h18-2-11" class="d">-                },
</a><a href="#h18-2-12" id="h18-2-12" class="d">-                outer_size: 7,
</a><a href="#h18-2-13" id="h18-2-13" class="d">-                inner: Scan {
</a><a href="#h18-2-14" id="h18-2-14" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h18-2-15" id="h18-2-15" class="d">-                    alias: Some(
</a><a href="#h18-2-16" id="h18-2-16" class="d">-                        &quot;g&quot;,
</a><a href="#h18-2-17" id="h18-2-17" class="d">-                    ),
</a><a href="#h18-2-18" id="h18-2-18" class="d">-                    filter: None,
</a><a href="#h18-2-19" id="h18-2-19" class="d">-                },
</a><a href="#h18-2-20" id="h18-2-20" class="d">-                predicate: None,
</a><a href="#h18-2-21" id="h18-2-21" class="d">-                pad: false,
</a><a href="#h18-2-22" id="h18-2-22" class="d">-                flip: false,
</a><a href="#h18-2-23" id="h18-2-23" class="d">-            },
</a><a href="#h18-2-24" id="h18-2-24" class="d">-            outer_size: 9,
</a><a href="#h18-2-25" id="h18-2-25" class="d">-            inner: Scan {
</a><a href="#h18-2-26" id="h18-2-26" class="d">-                table: &quot;countries&quot;,
</a><a href="#h18-2-27" id="h18-2-27" class="d">-                alias: Some(
</a><a href="#h18-2-28" id="h18-2-28" class="d">-                    &quot;c&quot;,
</a><a href="#h18-2-29" id="h18-2-29" class="d">-                ),
</a><a href="#h18-2-30" id="h18-2-30" class="d">-                filter: None,
</a><a href="#h18-2-31" id="h18-2-31" class="d">-            },
</a><a href="#h18-2-32" id="h18-2-32" class="d">-            predicate: Some(
</a><a href="#h18-2-33" id="h18-2-33" class="d">-                And(
</a><a href="#h18-2-34" id="h18-2-34" class="d">-                    And(
</a><a href="#h18-2-35" id="h18-2-35" class="d">-                        Or(
</a><a href="#h18-2-36" id="h18-2-36" class="d">-                            GreaterThan(
</a><a href="#h18-2-37" id="h18-2-37" class="d">-                                Field(
</a><a href="#h18-2-38" id="h18-2-38" class="d">-                                    0,
</a><a href="#h18-2-39" id="h18-2-39" class="d">-                                    Some(
</a><a href="#h18-2-40" id="h18-2-40" class="d">-                                        (
</a><a href="#h18-2-41" id="h18-2-41" class="d">-                                            Some(
</a><a href="#h18-2-42" id="h18-2-42" class="d">-                                                &quot;m&quot;,
</a><a href="#h18-2-43" id="h18-2-43" class="i">+        source: Filter {
</a><a href="#h18-2-44" id="h18-2-44" class="i">+            source: NestedLoopJoin {
</a><a href="#h18-2-45" id="h18-2-45" class="i">+                outer: NestedLoopJoin {
</a><a href="#h18-2-46" id="h18-2-46" class="i">+                    outer: Scan {
</a><a href="#h18-2-47" id="h18-2-47" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h18-2-48" id="h18-2-48" class="i">+                        alias: Some(
</a><a href="#h18-2-49" id="h18-2-49" class="i">+                            &quot;m&quot;,
</a><a href="#h18-2-50" id="h18-2-50" class="i">+                        ),
</a><a href="#h18-2-51" id="h18-2-51" class="i">+                        filter: Some(
</a><a href="#h18-2-52" id="h18-2-52" class="i">+                            Or(
</a><a href="#h18-2-53" id="h18-2-53" class="i">+                                GreaterThan(
</a><a href="#h18-2-54" id="h18-2-54" class="i">+                                    Field(
</a><a href="#h18-2-55" id="h18-2-55" class="i">+                                        0,
</a><a href="#h18-2-56" id="h18-2-56" class="i">+                                        Some(
</a><a href="#h18-2-57" id="h18-2-57" class="i">+                                            (
</a><a href="#h18-2-58" id="h18-2-58" class="i">+                                                Some(
</a><a href="#h18-2-59" id="h18-2-59" class="i">+                                                    &quot;m&quot;,
</a><a href="#h18-2-60" id="h18-2-60" class="i">+                                                ),
</a><a href="#h18-2-61" id="h18-2-61" class="i">+                                                &quot;id&quot;,
</a>                                             ),
<a href="#h18-2-63" id="h18-2-63" class="d">-                                            &quot;id&quot;,
</a><a href="#h18-2-64" id="h18-2-64" class="i">+                                        ),
</a><a href="#h18-2-65" id="h18-2-65" class="i">+                                    ),
</a><a href="#h18-2-66" id="h18-2-66" class="i">+                                    Constant(
</a><a href="#h18-2-67" id="h18-2-67" class="i">+                                        Integer(
</a><a href="#h18-2-68" id="h18-2-68" class="i">+                                            3,
</a>                                         ),
                                     ),
                                 ),
<a href="#h18-2-72" id="h18-2-72" class="d">-                                Constant(
</a><a href="#h18-2-73" id="h18-2-73" class="d">-                                    Integer(
</a><a href="#h18-2-74" id="h18-2-74" class="d">-                                        3,
</a><a href="#h18-2-75" id="h18-2-75" class="i">+                                Equal(
</a><a href="#h18-2-76" id="h18-2-76" class="i">+                                    Field(
</a><a href="#h18-2-77" id="h18-2-77" class="i">+                                        0,
</a><a href="#h18-2-78" id="h18-2-78" class="i">+                                        Some(
</a><a href="#h18-2-79" id="h18-2-79" class="i">+                                            (
</a><a href="#h18-2-80" id="h18-2-80" class="i">+                                                Some(
</a><a href="#h18-2-81" id="h18-2-81" class="i">+                                                    &quot;m&quot;,
</a><a href="#h18-2-82" id="h18-2-82" class="i">+                                                ),
</a><a href="#h18-2-83" id="h18-2-83" class="i">+                                                &quot;id&quot;,
</a><a href="#h18-2-84" id="h18-2-84" class="i">+                                            ),
</a><a href="#h18-2-85" id="h18-2-85" class="i">+                                        ),
</a><a href="#h18-2-86" id="h18-2-86" class="i">+                                    ),
</a><a href="#h18-2-87" id="h18-2-87" class="i">+                                    Constant(
</a><a href="#h18-2-88" id="h18-2-88" class="i">+                                        Integer(
</a><a href="#h18-2-89" id="h18-2-89" class="i">+                                            3,
</a><a href="#h18-2-90" id="h18-2-90" class="i">+                                        ),
</a>                                     ),
                                 ),
                             ),
<a href="#h18-2-94" id="h18-2-94" class="i">+                        ),
</a><a href="#h18-2-95" id="h18-2-95" class="i">+                    },
</a><a href="#h18-2-96" id="h18-2-96" class="i">+                    outer_size: 7,
</a><a href="#h18-2-97" id="h18-2-97" class="i">+                    inner: KeyLookup {
</a><a href="#h18-2-98" id="h18-2-98" class="i">+                        table: &quot;genres&quot;,
</a><a href="#h18-2-99" id="h18-2-99" class="i">+                        alias: Some(
</a><a href="#h18-2-100" id="h18-2-100" class="i">+                            &quot;g&quot;,
</a><a href="#h18-2-101" id="h18-2-101" class="i">+                        ),
</a><a href="#h18-2-102" id="h18-2-102" class="i">+                        keys: [
</a><a href="#h18-2-103" id="h18-2-103" class="i">+                            Integer(
</a><a href="#h18-2-104" id="h18-2-104" class="i">+                                2,
</a><a href="#h18-2-105" id="h18-2-105" class="i">+                            ),
</a><a href="#h18-2-106" id="h18-2-106" class="i">+                        ],
</a><a href="#h18-2-107" id="h18-2-107" class="i">+                    },
</a><a href="#h18-2-108" id="h18-2-108" class="i">+                    predicate: None,
</a><a href="#h18-2-109" id="h18-2-109" class="i">+                    pad: false,
</a><a href="#h18-2-110" id="h18-2-110" class="i">+                    flip: false,
</a><a href="#h18-2-111" id="h18-2-111" class="i">+                },
</a><a href="#h18-2-112" id="h18-2-112" class="i">+                outer_size: 9,
</a><a href="#h18-2-113" id="h18-2-113" class="i">+                inner: Scan {
</a><a href="#h18-2-114" id="h18-2-114" class="i">+                    table: &quot;countries&quot;,
</a><a href="#h18-2-115" id="h18-2-115" class="i">+                    alias: Some(
</a><a href="#h18-2-116" id="h18-2-116" class="i">+                        &quot;c&quot;,
</a><a href="#h18-2-117" id="h18-2-117" class="i">+                    ),
</a><a href="#h18-2-118" id="h18-2-118" class="i">+                    filter: Some(
</a><a href="#h18-2-119" id="h18-2-119" class="i">+                        Not(
</a>                             Equal(
                                 Field(
                                     0,
                                     Some(
                                         (
                                             Some(
<a href="#h18-2-126" id="h18-2-126" class="d">-                                                &quot;m&quot;,
</a><a href="#h18-2-127" id="h18-2-127" class="i">+                                                &quot;c&quot;,
</a>                                             ),
                                             &quot;id&quot;,
                                         ),
                                     ),
                                 ),
                                 Constant(
<a href="#h18-2-134" id="h18-2-134" class="d">-                                    Integer(
</a><a href="#h18-2-135" id="h18-2-135" class="d">-                                        3,
</a><a href="#h18-2-136" id="h18-2-136" class="i">+                                    String(
</a><a href="#h18-2-137" id="h18-2-137" class="i">+                                        &quot;us&quot;,
</a>                                     ),
                                 ),
                             ),
                         ),
<a href="#h18-2-142" id="h18-2-142" class="d">-                        Equal(
</a><a href="#h18-2-143" id="h18-2-143" class="d">-                            Field(
</a><a href="#h18-2-144" id="h18-2-144" class="d">-                                7,
</a><a href="#h18-2-145" id="h18-2-145" class="d">-                                Some(
</a><a href="#h18-2-146" id="h18-2-146" class="d">-                                    (
</a><a href="#h18-2-147" id="h18-2-147" class="d">-                                        Some(
</a><a href="#h18-2-148" id="h18-2-148" class="d">-                                            &quot;g&quot;,
</a><a href="#h18-2-149" id="h18-2-149" class="d">-                                        ),
</a><a href="#h18-2-150" id="h18-2-150" class="d">-                                        &quot;id&quot;,
</a><a href="#h18-2-151" id="h18-2-151" class="d">-                                    ),
</a><a href="#h18-2-152" id="h18-2-152" class="d">-                                ),
</a><a href="#h18-2-153" id="h18-2-153" class="d">-                            ),
</a><a href="#h18-2-154" id="h18-2-154" class="d">-                            Constant(
</a><a href="#h18-2-155" id="h18-2-155" class="d">-                                Integer(
</a><a href="#h18-2-156" id="h18-2-156" class="d">-                                    2,
</a><a href="#h18-2-157" id="h18-2-157" class="d">-                                ),
</a><a href="#h18-2-158" id="h18-2-158" class="d">-                            ),
</a><a href="#h18-2-159" id="h18-2-159" class="d">-                        ),
</a>                     ),
<a href="#h18-2-161" id="h18-2-161" class="d">-                    Not(
</a><a href="#h18-2-162" id="h18-2-162" class="d">-                        Equal(
</a><a href="#h18-2-163" id="h18-2-163" class="d">-                            Field(
</a><a href="#h18-2-164" id="h18-2-164" class="d">-                                9,
</a><a href="#h18-2-165" id="h18-2-165" class="d">-                                Some(
</a><a href="#h18-2-166" id="h18-2-166" class="d">-                                    (
</a><a href="#h18-2-167" id="h18-2-167" class="d">-                                        Some(
</a><a href="#h18-2-168" id="h18-2-168" class="d">-                                            &quot;c&quot;,
</a><a href="#h18-2-169" id="h18-2-169" class="d">-                                        ),
</a><a href="#h18-2-170" id="h18-2-170" class="d">-                                        &quot;id&quot;,
</a><a href="#h18-2-171" id="h18-2-171" class="d">-                                    ),
</a><a href="#h18-2-172" id="h18-2-172" class="d">-                                ),
</a><a href="#h18-2-173" id="h18-2-173" class="d">-                            ),
</a><a href="#h18-2-174" id="h18-2-174" class="d">-                            Constant(
</a><a href="#h18-2-175" id="h18-2-175" class="d">-                                String(
</a><a href="#h18-2-176" id="h18-2-176" class="d">-                                    &quot;us&quot;,
</a><a href="#h18-2-177" id="h18-2-177" class="d">-                                ),
</a><a href="#h18-2-178" id="h18-2-178" class="d">-                            ),
</a><a href="#h18-2-179" id="h18-2-179" class="d">-                        ),
</a><a href="#h18-2-180" id="h18-2-180" class="d">-                    ),
</a><a href="#h18-2-181" id="h18-2-181" class="d">-                ),
</a><a href="#h18-2-182" id="h18-2-182" class="d">-            ),
</a><a href="#h18-2-183" id="h18-2-183" class="d">-            pad: false,
</a><a href="#h18-2-184" id="h18-2-184" class="d">-            flip: false,
</a><a href="#h18-2-185" id="h18-2-185" class="i">+                },
</a><a href="#h18-2-186" id="h18-2-186" class="i">+                predicate: None,
</a><a href="#h18-2-187" id="h18-2-187" class="i">+                pad: false,
</a><a href="#h18-2-188" id="h18-2-188" class="i">+                flip: false,
</a><a href="#h18-2-189" id="h18-2-189" class="i">+            },
</a><a href="#h18-2-190" id="h18-2-190" class="i">+            predicate: None,
</a>         },
         expressions: [
             (
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -134,12 +134,17 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h19-0-3" id="h19-0-3" class="d">-        outer: Scan {
</a><a href="#h19-0-4" id="h19-0-4" class="i">+        outer: IndexLookup {
</a>             table: &quot;movies&quot;,
             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h19-0-9" id="h19-0-9" class="d">-            filter: None,
</a><a href="#h19-0-10" id="h19-0-10" class="i">+            column: &quot;genre_id&quot;,
</a><a href="#h19-0-11" id="h19-0-11" class="i">+            values: [
</a><a href="#h19-0-12" id="h19-0-12" class="i">+                Integer(
</a><a href="#h19-0-13" id="h19-0-13" class="i">+                    4,
</a><a href="#h19-0-14" id="h19-0-14" class="i">+                ),
</a><a href="#h19-0-15" id="h19-0-15" class="i">+            ],
</a>         },
         outer_size: 7,
         inner: KeyLookup {
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -0,0 +1,196 @@
</a><a href="#h20-0-0" id="h20-0-0" class="i">+Query: SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id WHERE g.id = 4
</a><a href="#h20-0-1" id="h20-0-1" class="i">+
</a><a href="#h20-0-2" id="h20-0-2" class="i">+AST: Select {
</a><a href="#h20-0-3" id="h20-0-3" class="i">+    select: [],
</a><a href="#h20-0-4" id="h20-0-4" class="i">+    from: [
</a><a href="#h20-0-5" id="h20-0-5" class="i">+        Join {
</a><a href="#h20-0-6" id="h20-0-6" class="i">+            left: Table {
</a><a href="#h20-0-7" id="h20-0-7" class="i">+                name: &quot;movies&quot;,
</a><a href="#h20-0-8" id="h20-0-8" class="i">+                alias: Some(
</a><a href="#h20-0-9" id="h20-0-9" class="i">+                    &quot;m&quot;,
</a><a href="#h20-0-10" id="h20-0-10" class="i">+                ),
</a><a href="#h20-0-11" id="h20-0-11" class="i">+            },
</a><a href="#h20-0-12" id="h20-0-12" class="i">+            right: Table {
</a><a href="#h20-0-13" id="h20-0-13" class="i">+                name: &quot;genres&quot;,
</a><a href="#h20-0-14" id="h20-0-14" class="i">+                alias: Some(
</a><a href="#h20-0-15" id="h20-0-15" class="i">+                    &quot;g&quot;,
</a><a href="#h20-0-16" id="h20-0-16" class="i">+                ),
</a><a href="#h20-0-17" id="h20-0-17" class="i">+            },
</a><a href="#h20-0-18" id="h20-0-18" class="i">+            type: Inner,
</a><a href="#h20-0-19" id="h20-0-19" class="i">+            predicate: Some(
</a><a href="#h20-0-20" id="h20-0-20" class="i">+                Operation(
</a><a href="#h20-0-21" id="h20-0-21" class="i">+                    Equal(
</a><a href="#h20-0-22" id="h20-0-22" class="i">+                        Field(
</a><a href="#h20-0-23" id="h20-0-23" class="i">+                            Some(
</a><a href="#h20-0-24" id="h20-0-24" class="i">+                                &quot;m&quot;,
</a><a href="#h20-0-25" id="h20-0-25" class="i">+                            ),
</a><a href="#h20-0-26" id="h20-0-26" class="i">+                            &quot;genre_id&quot;,
</a><a href="#h20-0-27" id="h20-0-27" class="i">+                        ),
</a><a href="#h20-0-28" id="h20-0-28" class="i">+                        Field(
</a><a href="#h20-0-29" id="h20-0-29" class="i">+                            Some(
</a><a href="#h20-0-30" id="h20-0-30" class="i">+                                &quot;g&quot;,
</a><a href="#h20-0-31" id="h20-0-31" class="i">+                            ),
</a><a href="#h20-0-32" id="h20-0-32" class="i">+                            &quot;id&quot;,
</a><a href="#h20-0-33" id="h20-0-33" class="i">+                        ),
</a><a href="#h20-0-34" id="h20-0-34" class="i">+                    ),
</a><a href="#h20-0-35" id="h20-0-35" class="i">+                ),
</a><a href="#h20-0-36" id="h20-0-36" class="i">+            ),
</a><a href="#h20-0-37" id="h20-0-37" class="i">+        },
</a><a href="#h20-0-38" id="h20-0-38" class="i">+    ],
</a><a href="#h20-0-39" id="h20-0-39" class="i">+    where: Some(
</a><a href="#h20-0-40" id="h20-0-40" class="i">+        Operation(
</a><a href="#h20-0-41" id="h20-0-41" class="i">+            Equal(
</a><a href="#h20-0-42" id="h20-0-42" class="i">+                Field(
</a><a href="#h20-0-43" id="h20-0-43" class="i">+                    Some(
</a><a href="#h20-0-44" id="h20-0-44" class="i">+                        &quot;g&quot;,
</a><a href="#h20-0-45" id="h20-0-45" class="i">+                    ),
</a><a href="#h20-0-46" id="h20-0-46" class="i">+                    &quot;id&quot;,
</a><a href="#h20-0-47" id="h20-0-47" class="i">+                ),
</a><a href="#h20-0-48" id="h20-0-48" class="i">+                Literal(
</a><a href="#h20-0-49" id="h20-0-49" class="i">+                    Integer(
</a><a href="#h20-0-50" id="h20-0-50" class="i">+                        4,
</a><a href="#h20-0-51" id="h20-0-51" class="i">+                    ),
</a><a href="#h20-0-52" id="h20-0-52" class="i">+                ),
</a><a href="#h20-0-53" id="h20-0-53" class="i">+            ),
</a><a href="#h20-0-54" id="h20-0-54" class="i">+        ),
</a><a href="#h20-0-55" id="h20-0-55" class="i">+    ),
</a><a href="#h20-0-56" id="h20-0-56" class="i">+    group_by: [],
</a><a href="#h20-0-57" id="h20-0-57" class="i">+    having: None,
</a><a href="#h20-0-58" id="h20-0-58" class="i">+    order: [],
</a><a href="#h20-0-59" id="h20-0-59" class="i">+    offset: None,
</a><a href="#h20-0-60" id="h20-0-60" class="i">+    limit: None,
</a><a href="#h20-0-61" id="h20-0-61" class="i">+}
</a><a href="#h20-0-62" id="h20-0-62" class="i">+
</a><a href="#h20-0-63" id="h20-0-63" class="i">+Plan: Plan(
</a><a href="#h20-0-64" id="h20-0-64" class="i">+    Filter {
</a><a href="#h20-0-65" id="h20-0-65" class="i">+        source: NestedLoopJoin {
</a><a href="#h20-0-66" id="h20-0-66" class="i">+            outer: Scan {
</a><a href="#h20-0-67" id="h20-0-67" class="i">+                table: &quot;movies&quot;,
</a><a href="#h20-0-68" id="h20-0-68" class="i">+                alias: Some(
</a><a href="#h20-0-69" id="h20-0-69" class="i">+                    &quot;m&quot;,
</a><a href="#h20-0-70" id="h20-0-70" class="i">+                ),
</a><a href="#h20-0-71" id="h20-0-71" class="i">+                filter: None,
</a><a href="#h20-0-72" id="h20-0-72" class="i">+            },
</a><a href="#h20-0-73" id="h20-0-73" class="i">+            outer_size: 7,
</a><a href="#h20-0-74" id="h20-0-74" class="i">+            inner: Scan {
</a><a href="#h20-0-75" id="h20-0-75" class="i">+                table: &quot;genres&quot;,
</a><a href="#h20-0-76" id="h20-0-76" class="i">+                alias: Some(
</a><a href="#h20-0-77" id="h20-0-77" class="i">+                    &quot;g&quot;,
</a><a href="#h20-0-78" id="h20-0-78" class="i">+                ),
</a><a href="#h20-0-79" id="h20-0-79" class="i">+                filter: None,
</a><a href="#h20-0-80" id="h20-0-80" class="i">+            },
</a><a href="#h20-0-81" id="h20-0-81" class="i">+            predicate: Some(
</a><a href="#h20-0-82" id="h20-0-82" class="i">+                Equal(
</a><a href="#h20-0-83" id="h20-0-83" class="i">+                    Field(
</a><a href="#h20-0-84" id="h20-0-84" class="i">+                        3,
</a><a href="#h20-0-85" id="h20-0-85" class="i">+                        Some(
</a><a href="#h20-0-86" id="h20-0-86" class="i">+                            (
</a><a href="#h20-0-87" id="h20-0-87" class="i">+                                Some(
</a><a href="#h20-0-88" id="h20-0-88" class="i">+                                    &quot;m&quot;,
</a><a href="#h20-0-89" id="h20-0-89" class="i">+                                ),
</a><a href="#h20-0-90" id="h20-0-90" class="i">+                                &quot;genre_id&quot;,
</a><a href="#h20-0-91" id="h20-0-91" class="i">+                            ),
</a><a href="#h20-0-92" id="h20-0-92" class="i">+                        ),
</a><a href="#h20-0-93" id="h20-0-93" class="i">+                    ),
</a><a href="#h20-0-94" id="h20-0-94" class="i">+                    Field(
</a><a href="#h20-0-95" id="h20-0-95" class="i">+                        7,
</a><a href="#h20-0-96" id="h20-0-96" class="i">+                        Some(
</a><a href="#h20-0-97" id="h20-0-97" class="i">+                            (
</a><a href="#h20-0-98" id="h20-0-98" class="i">+                                Some(
</a><a href="#h20-0-99" id="h20-0-99" class="i">+                                    &quot;g&quot;,
</a><a href="#h20-0-100" id="h20-0-100" class="i">+                                ),
</a><a href="#h20-0-101" id="h20-0-101" class="i">+                                &quot;id&quot;,
</a><a href="#h20-0-102" id="h20-0-102" class="i">+                            ),
</a><a href="#h20-0-103" id="h20-0-103" class="i">+                        ),
</a><a href="#h20-0-104" id="h20-0-104" class="i">+                    ),
</a><a href="#h20-0-105" id="h20-0-105" class="i">+                ),
</a><a href="#h20-0-106" id="h20-0-106" class="i">+            ),
</a><a href="#h20-0-107" id="h20-0-107" class="i">+            pad: false,
</a><a href="#h20-0-108" id="h20-0-108" class="i">+            flip: false,
</a><a href="#h20-0-109" id="h20-0-109" class="i">+        },
</a><a href="#h20-0-110" id="h20-0-110" class="i">+        predicate: Some(
</a><a href="#h20-0-111" id="h20-0-111" class="i">+            Equal(
</a><a href="#h20-0-112" id="h20-0-112" class="i">+                Field(
</a><a href="#h20-0-113" id="h20-0-113" class="i">+                    7,
</a><a href="#h20-0-114" id="h20-0-114" class="i">+                    Some(
</a><a href="#h20-0-115" id="h20-0-115" class="i">+                        (
</a><a href="#h20-0-116" id="h20-0-116" class="i">+                            Some(
</a><a href="#h20-0-117" id="h20-0-117" class="i">+                                &quot;g&quot;,
</a><a href="#h20-0-118" id="h20-0-118" class="i">+                            ),
</a><a href="#h20-0-119" id="h20-0-119" class="i">+                            &quot;id&quot;,
</a><a href="#h20-0-120" id="h20-0-120" class="i">+                        ),
</a><a href="#h20-0-121" id="h20-0-121" class="i">+                    ),
</a><a href="#h20-0-122" id="h20-0-122" class="i">+                ),
</a><a href="#h20-0-123" id="h20-0-123" class="i">+                Constant(
</a><a href="#h20-0-124" id="h20-0-124" class="i">+                    Integer(
</a><a href="#h20-0-125" id="h20-0-125" class="i">+                        4,
</a><a href="#h20-0-126" id="h20-0-126" class="i">+                    ),
</a><a href="#h20-0-127" id="h20-0-127" class="i">+                ),
</a><a href="#h20-0-128" id="h20-0-128" class="i">+            ),
</a><a href="#h20-0-129" id="h20-0-129" class="i">+        ),
</a><a href="#h20-0-130" id="h20-0-130" class="i">+    },
</a><a href="#h20-0-131" id="h20-0-131" class="i">+)
</a><a href="#h20-0-132" id="h20-0-132" class="i">+
</a><a href="#h20-0-133" id="h20-0-133" class="i">+Optimized plan: Plan(
</a><a href="#h20-0-134" id="h20-0-134" class="i">+    Filter {
</a><a href="#h20-0-135" id="h20-0-135" class="i">+        source: NestedLoopJoin {
</a><a href="#h20-0-136" id="h20-0-136" class="i">+            outer: IndexLookup {
</a><a href="#h20-0-137" id="h20-0-137" class="i">+                table: &quot;movies&quot;,
</a><a href="#h20-0-138" id="h20-0-138" class="i">+                alias: Some(
</a><a href="#h20-0-139" id="h20-0-139" class="i">+                    &quot;m&quot;,
</a><a href="#h20-0-140" id="h20-0-140" class="i">+                ),
</a><a href="#h20-0-141" id="h20-0-141" class="i">+                column: &quot;genre_id&quot;,
</a><a href="#h20-0-142" id="h20-0-142" class="i">+                values: [
</a><a href="#h20-0-143" id="h20-0-143" class="i">+                    Integer(
</a><a href="#h20-0-144" id="h20-0-144" class="i">+                        4,
</a><a href="#h20-0-145" id="h20-0-145" class="i">+                    ),
</a><a href="#h20-0-146" id="h20-0-146" class="i">+                ],
</a><a href="#h20-0-147" id="h20-0-147" class="i">+            },
</a><a href="#h20-0-148" id="h20-0-148" class="i">+            outer_size: 7,
</a><a href="#h20-0-149" id="h20-0-149" class="i">+            inner: KeyLookup {
</a><a href="#h20-0-150" id="h20-0-150" class="i">+                table: &quot;genres&quot;,
</a><a href="#h20-0-151" id="h20-0-151" class="i">+                alias: Some(
</a><a href="#h20-0-152" id="h20-0-152" class="i">+                    &quot;g&quot;,
</a><a href="#h20-0-153" id="h20-0-153" class="i">+                ),
</a><a href="#h20-0-154" id="h20-0-154" class="i">+                keys: [
</a><a href="#h20-0-155" id="h20-0-155" class="i">+                    Integer(
</a><a href="#h20-0-156" id="h20-0-156" class="i">+                        4,
</a><a href="#h20-0-157" id="h20-0-157" class="i">+                    ),
</a><a href="#h20-0-158" id="h20-0-158" class="i">+                ],
</a><a href="#h20-0-159" id="h20-0-159" class="i">+            },
</a><a href="#h20-0-160" id="h20-0-160" class="i">+            predicate: Some(
</a><a href="#h20-0-161" id="h20-0-161" class="i">+                Equal(
</a><a href="#h20-0-162" id="h20-0-162" class="i">+                    Field(
</a><a href="#h20-0-163" id="h20-0-163" class="i">+                        3,
</a><a href="#h20-0-164" id="h20-0-164" class="i">+                        Some(
</a><a href="#h20-0-165" id="h20-0-165" class="i">+                            (
</a><a href="#h20-0-166" id="h20-0-166" class="i">+                                Some(
</a><a href="#h20-0-167" id="h20-0-167" class="i">+                                    &quot;m&quot;,
</a><a href="#h20-0-168" id="h20-0-168" class="i">+                                ),
</a><a href="#h20-0-169" id="h20-0-169" class="i">+                                &quot;genre_id&quot;,
</a><a href="#h20-0-170" id="h20-0-170" class="i">+                            ),
</a><a href="#h20-0-171" id="h20-0-171" class="i">+                        ),
</a><a href="#h20-0-172" id="h20-0-172" class="i">+                    ),
</a><a href="#h20-0-173" id="h20-0-173" class="i">+                    Field(
</a><a href="#h20-0-174" id="h20-0-174" class="i">+                        7,
</a><a href="#h20-0-175" id="h20-0-175" class="i">+                        Some(
</a><a href="#h20-0-176" id="h20-0-176" class="i">+                            (
</a><a href="#h20-0-177" id="h20-0-177" class="i">+                                Some(
</a><a href="#h20-0-178" id="h20-0-178" class="i">+                                    &quot;g&quot;,
</a><a href="#h20-0-179" id="h20-0-179" class="i">+                                ),
</a><a href="#h20-0-180" id="h20-0-180" class="i">+                                &quot;id&quot;,
</a><a href="#h20-0-181" id="h20-0-181" class="i">+                            ),
</a><a href="#h20-0-182" id="h20-0-182" class="i">+                        ),
</a><a href="#h20-0-183" id="h20-0-183" class="i">+                    ),
</a><a href="#h20-0-184" id="h20-0-184" class="i">+                ),
</a><a href="#h20-0-185" id="h20-0-185" class="i">+            ),
</a><a href="#h20-0-186" id="h20-0-186" class="i">+            pad: false,
</a><a href="#h20-0-187" id="h20-0-187" class="i">+            flip: false,
</a><a href="#h20-0-188" id="h20-0-188" class="i">+        },
</a><a href="#h20-0-189" id="h20-0-189" class="i">+        predicate: None,
</a><a href="#h20-0-190" id="h20-0-190" class="i">+    },
</a><a href="#h20-0-191" id="h20-0-191" class="i">+)
</a><a href="#h20-0-192" id="h20-0-192" class="i">+
</a><a href="#h20-0-193" id="h20-0-193" class="i">+Query: SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id WHERE g.id = 4
</a><a href="#h20-0-194" id="h20-0-194" class="i">+
</a><a href="#h20-0-195" id="h20-0-195" class="i">+Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
</a><b>diff --git a/<a id="h21" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -326,12 +326,39 @@ Optimized plan: Plan(
</a>     Projection {
         source: NestedLoopJoin {
             outer: NestedLoopJoin {
<a href="#h21-0-3" id="h21-0-3" class="d">-                outer: Scan {
</a><a href="#h21-0-4" id="h21-0-4" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h21-0-5" id="h21-0-5" class="d">-                    alias: Some(
</a><a href="#h21-0-6" id="h21-0-6" class="d">-                        &quot;m&quot;,
</a><a href="#h21-0-7" id="h21-0-7" class="i">+                outer: Filter {
</a><a href="#h21-0-8" id="h21-0-8" class="i">+                    source: IndexLookup {
</a><a href="#h21-0-9" id="h21-0-9" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h21-0-10" id="h21-0-10" class="i">+                        alias: Some(
</a><a href="#h21-0-11" id="h21-0-11" class="i">+                            &quot;m&quot;,
</a><a href="#h21-0-12" id="h21-0-12" class="i">+                        ),
</a><a href="#h21-0-13" id="h21-0-13" class="i">+                        column: &quot;studio_id&quot;,
</a><a href="#h21-0-14" id="h21-0-14" class="i">+                        values: [
</a><a href="#h21-0-15" id="h21-0-15" class="i">+                            Integer(
</a><a href="#h21-0-16" id="h21-0-16" class="i">+                                4,
</a><a href="#h21-0-17" id="h21-0-17" class="i">+                            ),
</a><a href="#h21-0-18" id="h21-0-18" class="i">+                        ],
</a><a href="#h21-0-19" id="h21-0-19" class="i">+                    },
</a><a href="#h21-0-20" id="h21-0-20" class="i">+                    predicate: Some(
</a><a href="#h21-0-21" id="h21-0-21" class="i">+                        Equal(
</a><a href="#h21-0-22" id="h21-0-22" class="i">+                            Field(
</a><a href="#h21-0-23" id="h21-0-23" class="i">+                                3,
</a><a href="#h21-0-24" id="h21-0-24" class="i">+                                Some(
</a><a href="#h21-0-25" id="h21-0-25" class="i">+                                    (
</a><a href="#h21-0-26" id="h21-0-26" class="i">+                                        Some(
</a><a href="#h21-0-27" id="h21-0-27" class="i">+                                            &quot;m&quot;,
</a><a href="#h21-0-28" id="h21-0-28" class="i">+                                        ),
</a><a href="#h21-0-29" id="h21-0-29" class="i">+                                        &quot;genre_id&quot;,
</a><a href="#h21-0-30" id="h21-0-30" class="i">+                                    ),
</a><a href="#h21-0-31" id="h21-0-31" class="i">+                                ),
</a><a href="#h21-0-32" id="h21-0-32" class="i">+                            ),
</a><a href="#h21-0-33" id="h21-0-33" class="i">+                            Constant(
</a><a href="#h21-0-34" id="h21-0-34" class="i">+                                Integer(
</a><a href="#h21-0-35" id="h21-0-35" class="i">+                                    1,
</a><a href="#h21-0-36" id="h21-0-36" class="i">+                                ),
</a><a href="#h21-0-37" id="h21-0-37" class="i">+                            ),
</a><a href="#h21-0-38" id="h21-0-38" class="i">+                        ),
</a>                     ),
<a href="#h21-0-40" id="h21-0-40" class="d">-                    filter: None,
</a>                 },
                 outer_size: 7,
                 inner: KeyLookup {
<a href="#h21-1" id="h21-1" class="h">@@ -474,5 +501,5 @@ Query:
</a> 
 Result: [&quot;title&quot;, &quot;genre&quot;, &quot;studio&quot;]
 [String(&quot;The Fountain&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
<a href="#h21-1-3" id="h21-1-3" class="d">-[String(&quot;Gravity&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
</a> [String(&quot;Inception&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
<a href="#h21-1-5" id="h21-1-5" class="i">+[String(&quot;Gravity&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
</a><b>diff --git a/<a id="h22" href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a> b/<a href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -100,40 +100,42 @@ Plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h22-0-3" id="h22-0-3" class="d">-        predicate: Or(
</a><a href="#h22-0-4" id="h22-0-4" class="d">-            GreaterThan(
</a><a href="#h22-0-5" id="h22-0-5" class="d">-                Field(
</a><a href="#h22-0-6" id="h22-0-6" class="d">-                    0,
</a><a href="#h22-0-7" id="h22-0-7" class="d">-                    Some(
</a><a href="#h22-0-8" id="h22-0-8" class="d">-                        (
</a><a href="#h22-0-9" id="h22-0-9" class="d">-                            Some(
</a><a href="#h22-0-10" id="h22-0-10" class="d">-                                &quot;movies&quot;,
</a><a href="#h22-0-11" id="h22-0-11" class="i">+        predicate: Some(
</a><a href="#h22-0-12" id="h22-0-12" class="i">+            Or(
</a><a href="#h22-0-13" id="h22-0-13" class="i">+                GreaterThan(
</a><a href="#h22-0-14" id="h22-0-14" class="i">+                    Field(
</a><a href="#h22-0-15" id="h22-0-15" class="i">+                        0,
</a><a href="#h22-0-16" id="h22-0-16" class="i">+                        Some(
</a><a href="#h22-0-17" id="h22-0-17" class="i">+                            (
</a><a href="#h22-0-18" id="h22-0-18" class="i">+                                Some(
</a><a href="#h22-0-19" id="h22-0-19" class="i">+                                    &quot;movies&quot;,
</a><a href="#h22-0-20" id="h22-0-20" class="i">+                                ),
</a><a href="#h22-0-21" id="h22-0-21" class="i">+                                &quot;id&quot;,
</a>                             ),
<a href="#h22-0-23" id="h22-0-23" class="d">-                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h22-0-26" id="h22-0-26" class="d">-                ),
</a><a href="#h22-0-27" id="h22-0-27" class="d">-                Constant(
</a><a href="#h22-0-28" id="h22-0-28" class="d">-                    Integer(
</a><a href="#h22-0-29" id="h22-0-29" class="d">-                        3,
</a><a href="#h22-0-30" id="h22-0-30" class="i">+                    Constant(
</a><a href="#h22-0-31" id="h22-0-31" class="i">+                        Integer(
</a><a href="#h22-0-32" id="h22-0-32" class="i">+                            3,
</a><a href="#h22-0-33" id="h22-0-33" class="i">+                        ),
</a>                     ),
                 ),
<a href="#h22-0-36" id="h22-0-36" class="d">-            ),
</a><a href="#h22-0-37" id="h22-0-37" class="d">-            Equal(
</a><a href="#h22-0-38" id="h22-0-38" class="d">-                Field(
</a><a href="#h22-0-39" id="h22-0-39" class="d">-                    0,
</a><a href="#h22-0-40" id="h22-0-40" class="d">-                    Some(
</a><a href="#h22-0-41" id="h22-0-41" class="d">-                        (
</a><a href="#h22-0-42" id="h22-0-42" class="d">-                            Some(
</a><a href="#h22-0-43" id="h22-0-43" class="d">-                                &quot;movies&quot;,
</a><a href="#h22-0-44" id="h22-0-44" class="i">+                Equal(
</a><a href="#h22-0-45" id="h22-0-45" class="i">+                    Field(
</a><a href="#h22-0-46" id="h22-0-46" class="i">+                        0,
</a><a href="#h22-0-47" id="h22-0-47" class="i">+                        Some(
</a><a href="#h22-0-48" id="h22-0-48" class="i">+                            (
</a><a href="#h22-0-49" id="h22-0-49" class="i">+                                Some(
</a><a href="#h22-0-50" id="h22-0-50" class="i">+                                    &quot;movies&quot;,
</a><a href="#h22-0-51" id="h22-0-51" class="i">+                                ),
</a><a href="#h22-0-52" id="h22-0-52" class="i">+                                &quot;id&quot;,
</a>                             ),
<a href="#h22-0-54" id="h22-0-54" class="d">-                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h22-0-57" id="h22-0-57" class="d">-                ),
</a><a href="#h22-0-58" id="h22-0-58" class="d">-                Constant(
</a><a href="#h22-0-59" id="h22-0-59" class="d">-                    Integer(
</a><a href="#h22-0-60" id="h22-0-60" class="d">-                        3,
</a><a href="#h22-0-61" id="h22-0-61" class="i">+                    Constant(
</a><a href="#h22-0-62" id="h22-0-62" class="i">+                        Integer(
</a><a href="#h22-0-63" id="h22-0-63" class="i">+                            3,
</a><a href="#h22-0-64" id="h22-0-64" class="i">+                        ),
</a>                     ),
                 ),
             ),
<a href="#h22-1" id="h22-1" class="h">@@ -142,58 +144,59 @@ Plan: Plan(
</a> )
 
 Optimized plan: Plan(
<a href="#h22-1-3" id="h22-1-3" class="d">-    NestedLoopJoin {
</a><a href="#h22-1-4" id="h22-1-4" class="d">-        outer: Scan {
</a><a href="#h22-1-5" id="h22-1-5" class="d">-            table: &quot;movies&quot;,
</a><a href="#h22-1-6" id="h22-1-6" class="d">-            alias: None,
</a><a href="#h22-1-7" id="h22-1-7" class="d">-            filter: None,
</a><a href="#h22-1-8" id="h22-1-8" class="d">-        },
</a><a href="#h22-1-9" id="h22-1-9" class="d">-        outer_size: 7,
</a><a href="#h22-1-10" id="h22-1-10" class="d">-        inner: Scan {
</a><a href="#h22-1-11" id="h22-1-11" class="d">-            table: &quot;genres&quot;,
</a><a href="#h22-1-12" id="h22-1-12" class="d">-            alias: None,
</a><a href="#h22-1-13" id="h22-1-13" class="d">-            filter: None,
</a><a href="#h22-1-14" id="h22-1-14" class="d">-        },
</a><a href="#h22-1-15" id="h22-1-15" class="d">-        predicate: Some(
</a><a href="#h22-1-16" id="h22-1-16" class="d">-            And(
</a><a href="#h22-1-17" id="h22-1-17" class="d">-                Or(
</a><a href="#h22-1-18" id="h22-1-18" class="d">-                    GreaterThan(
</a><a href="#h22-1-19" id="h22-1-19" class="d">-                        Field(
</a><a href="#h22-1-20" id="h22-1-20" class="d">-                            0,
</a><a href="#h22-1-21" id="h22-1-21" class="d">-                            Some(
</a><a href="#h22-1-22" id="h22-1-22" class="d">-                                (
</a><a href="#h22-1-23" id="h22-1-23" class="d">-                                    Some(
</a><a href="#h22-1-24" id="h22-1-24" class="d">-                                        &quot;movies&quot;,
</a><a href="#h22-1-25" id="h22-1-25" class="i">+    Filter {
</a><a href="#h22-1-26" id="h22-1-26" class="i">+        source: NestedLoopJoin {
</a><a href="#h22-1-27" id="h22-1-27" class="i">+            outer: Scan {
</a><a href="#h22-1-28" id="h22-1-28" class="i">+                table: &quot;movies&quot;,
</a><a href="#h22-1-29" id="h22-1-29" class="i">+                alias: None,
</a><a href="#h22-1-30" id="h22-1-30" class="i">+                filter: Some(
</a><a href="#h22-1-31" id="h22-1-31" class="i">+                    Or(
</a><a href="#h22-1-32" id="h22-1-32" class="i">+                        GreaterThan(
</a><a href="#h22-1-33" id="h22-1-33" class="i">+                            Field(
</a><a href="#h22-1-34" id="h22-1-34" class="i">+                                0,
</a><a href="#h22-1-35" id="h22-1-35" class="i">+                                Some(
</a><a href="#h22-1-36" id="h22-1-36" class="i">+                                    (
</a><a href="#h22-1-37" id="h22-1-37" class="i">+                                        Some(
</a><a href="#h22-1-38" id="h22-1-38" class="i">+                                            &quot;movies&quot;,
</a><a href="#h22-1-39" id="h22-1-39" class="i">+                                        ),
</a><a href="#h22-1-40" id="h22-1-40" class="i">+                                        &quot;id&quot;,
</a>                                     ),
<a href="#h22-1-42" id="h22-1-42" class="d">-                                    &quot;id&quot;,
</a>                                 ),
                             ),
<a href="#h22-1-45" id="h22-1-45" class="d">-                        ),
</a><a href="#h22-1-46" id="h22-1-46" class="d">-                        Constant(
</a><a href="#h22-1-47" id="h22-1-47" class="d">-                            Integer(
</a><a href="#h22-1-48" id="h22-1-48" class="d">-                                3,
</a><a href="#h22-1-49" id="h22-1-49" class="i">+                            Constant(
</a><a href="#h22-1-50" id="h22-1-50" class="i">+                                Integer(
</a><a href="#h22-1-51" id="h22-1-51" class="i">+                                    3,
</a><a href="#h22-1-52" id="h22-1-52" class="i">+                                ),
</a>                             ),
                         ),
<a href="#h22-1-55" id="h22-1-55" class="d">-                    ),
</a><a href="#h22-1-56" id="h22-1-56" class="d">-                    Equal(
</a><a href="#h22-1-57" id="h22-1-57" class="d">-                        Field(
</a><a href="#h22-1-58" id="h22-1-58" class="d">-                            0,
</a><a href="#h22-1-59" id="h22-1-59" class="d">-                            Some(
</a><a href="#h22-1-60" id="h22-1-60" class="d">-                                (
</a><a href="#h22-1-61" id="h22-1-61" class="d">-                                    Some(
</a><a href="#h22-1-62" id="h22-1-62" class="d">-                                        &quot;movies&quot;,
</a><a href="#h22-1-63" id="h22-1-63" class="i">+                        Equal(
</a><a href="#h22-1-64" id="h22-1-64" class="i">+                            Field(
</a><a href="#h22-1-65" id="h22-1-65" class="i">+                                0,
</a><a href="#h22-1-66" id="h22-1-66" class="i">+                                Some(
</a><a href="#h22-1-67" id="h22-1-67" class="i">+                                    (
</a><a href="#h22-1-68" id="h22-1-68" class="i">+                                        Some(
</a><a href="#h22-1-69" id="h22-1-69" class="i">+                                            &quot;movies&quot;,
</a><a href="#h22-1-70" id="h22-1-70" class="i">+                                        ),
</a><a href="#h22-1-71" id="h22-1-71" class="i">+                                        &quot;id&quot;,
</a>                                     ),
<a href="#h22-1-73" id="h22-1-73" class="d">-                                    &quot;id&quot;,
</a>                                 ),
                             ),
<a href="#h22-1-76" id="h22-1-76" class="d">-                        ),
</a><a href="#h22-1-77" id="h22-1-77" class="d">-                        Constant(
</a><a href="#h22-1-78" id="h22-1-78" class="d">-                            Integer(
</a><a href="#h22-1-79" id="h22-1-79" class="d">-                                3,
</a><a href="#h22-1-80" id="h22-1-80" class="i">+                            Constant(
</a><a href="#h22-1-81" id="h22-1-81" class="i">+                                Integer(
</a><a href="#h22-1-82" id="h22-1-82" class="i">+                                    3,
</a><a href="#h22-1-83" id="h22-1-83" class="i">+                                ),
</a>                             ),
                         ),
                     ),
                 ),
<a href="#h22-1-88" id="h22-1-88" class="i">+            },
</a><a href="#h22-1-89" id="h22-1-89" class="i">+            outer_size: 7,
</a><a href="#h22-1-90" id="h22-1-90" class="i">+            inner: Scan {
</a><a href="#h22-1-91" id="h22-1-91" class="i">+                table: &quot;genres&quot;,
</a><a href="#h22-1-92" id="h22-1-92" class="i">+                alias: None,
</a><a href="#h22-1-93" id="h22-1-93" class="i">+                filter: None,
</a><a href="#h22-1-94" id="h22-1-94" class="i">+            },
</a><a href="#h22-1-95" id="h22-1-95" class="i">+            predicate: Some(
</a>                 Equal(
                     Field(
                         3,
<a href="#h22-2" id="h22-2" class="h">@@ -219,9 +222,10 @@ Optimized plan: Plan(
</a>                     ),
                 ),
             ),
<a href="#h22-2-3" id="h22-2-3" class="d">-        ),
</a><a href="#h22-2-4" id="h22-2-4" class="d">-        pad: false,
</a><a href="#h22-2-5" id="h22-2-5" class="d">-        flip: false,
</a><a href="#h22-2-6" id="h22-2-6" class="i">+            pad: false,
</a><a href="#h22-2-7" id="h22-2-7" class="i">+            flip: false,
</a><a href="#h22-2-8" id="h22-2-8" class="i">+        },
</a><a href="#h22-2-9" id="h22-2-9" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -100,26 +100,28 @@ Plan: Plan(
</a>                     pad: false,
                     flip: false,
                 },
<a href="#h23-0-3" id="h23-0-3" class="d">-                predicate: Equal(
</a><a href="#h23-0-4" id="h23-0-4" class="d">-                    Field(
</a><a href="#h23-0-5" id="h23-0-5" class="d">-                        3,
</a><a href="#h23-0-6" id="h23-0-6" class="d">-                        Some(
</a><a href="#h23-0-7" id="h23-0-7" class="d">-                            (
</a><a href="#h23-0-8" id="h23-0-8" class="d">-                                Some(
</a><a href="#h23-0-9" id="h23-0-9" class="d">-                                    &quot;movies&quot;,
</a><a href="#h23-0-10" id="h23-0-10" class="i">+                predicate: Some(
</a><a href="#h23-0-11" id="h23-0-11" class="i">+                    Equal(
</a><a href="#h23-0-12" id="h23-0-12" class="i">+                        Field(
</a><a href="#h23-0-13" id="h23-0-13" class="i">+                            3,
</a><a href="#h23-0-14" id="h23-0-14" class="i">+                            Some(
</a><a href="#h23-0-15" id="h23-0-15" class="i">+                                (
</a><a href="#h23-0-16" id="h23-0-16" class="i">+                                    Some(
</a><a href="#h23-0-17" id="h23-0-17" class="i">+                                        &quot;movies&quot;,
</a><a href="#h23-0-18" id="h23-0-18" class="i">+                                    ),
</a><a href="#h23-0-19" id="h23-0-19" class="i">+                                    &quot;genre_id&quot;,
</a>                                 ),
<a href="#h23-0-21" id="h23-0-21" class="d">-                                &quot;genre_id&quot;,
</a>                             ),
                         ),
<a href="#h23-0-24" id="h23-0-24" class="d">-                    ),
</a><a href="#h23-0-25" id="h23-0-25" class="d">-                    Field(
</a><a href="#h23-0-26" id="h23-0-26" class="d">-                        7,
</a><a href="#h23-0-27" id="h23-0-27" class="d">-                        Some(
</a><a href="#h23-0-28" id="h23-0-28" class="d">-                            (
</a><a href="#h23-0-29" id="h23-0-29" class="d">-                                Some(
</a><a href="#h23-0-30" id="h23-0-30" class="d">-                                    &quot;genres&quot;,
</a><a href="#h23-0-31" id="h23-0-31" class="i">+                        Field(
</a><a href="#h23-0-32" id="h23-0-32" class="i">+                            7,
</a><a href="#h23-0-33" id="h23-0-33" class="i">+                            Some(
</a><a href="#h23-0-34" id="h23-0-34" class="i">+                                (
</a><a href="#h23-0-35" id="h23-0-35" class="i">+                                    Some(
</a><a href="#h23-0-36" id="h23-0-36" class="i">+                                        &quot;genres&quot;,
</a><a href="#h23-0-37" id="h23-0-37" class="i">+                                    ),
</a><a href="#h23-0-38" id="h23-0-38" class="i">+                                    &quot;id&quot;,
</a>                                 ),
<a href="#h23-0-40" id="h23-0-40" class="d">-                                &quot;id&quot;,
</a>                             ),
                         ),
                     ),
<a href="#h23-1" id="h23-1" class="h">@@ -192,46 +194,49 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Order {
         source: Projection {
<a href="#h23-1-3" id="h23-1-3" class="d">-            source: NestedLoopJoin {
</a><a href="#h23-1-4" id="h23-1-4" class="d">-                outer: Scan {
</a><a href="#h23-1-5" id="h23-1-5" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h23-1-6" id="h23-1-6" class="d">-                    alias: None,
</a><a href="#h23-1-7" id="h23-1-7" class="d">-                    filter: None,
</a><a href="#h23-1-8" id="h23-1-8" class="d">-                },
</a><a href="#h23-1-9" id="h23-1-9" class="d">-                outer_size: 7,
</a><a href="#h23-1-10" id="h23-1-10" class="d">-                inner: Scan {
</a><a href="#h23-1-11" id="h23-1-11" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h23-1-12" id="h23-1-12" class="d">-                    alias: None,
</a><a href="#h23-1-13" id="h23-1-13" class="d">-                    filter: None,
</a><a href="#h23-1-14" id="h23-1-14" class="d">-                },
</a><a href="#h23-1-15" id="h23-1-15" class="d">-                predicate: Some(
</a><a href="#h23-1-16" id="h23-1-16" class="d">-                    Equal(
</a><a href="#h23-1-17" id="h23-1-17" class="d">-                        Field(
</a><a href="#h23-1-18" id="h23-1-18" class="d">-                            3,
</a><a href="#h23-1-19" id="h23-1-19" class="d">-                            Some(
</a><a href="#h23-1-20" id="h23-1-20" class="d">-                                (
</a><a href="#h23-1-21" id="h23-1-21" class="d">-                                    Some(
</a><a href="#h23-1-22" id="h23-1-22" class="d">-                                        &quot;movies&quot;,
</a><a href="#h23-1-23" id="h23-1-23" class="i">+            source: Filter {
</a><a href="#h23-1-24" id="h23-1-24" class="i">+                source: NestedLoopJoin {
</a><a href="#h23-1-25" id="h23-1-25" class="i">+                    outer: Scan {
</a><a href="#h23-1-26" id="h23-1-26" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h23-1-27" id="h23-1-27" class="i">+                        alias: None,
</a><a href="#h23-1-28" id="h23-1-28" class="i">+                        filter: None,
</a><a href="#h23-1-29" id="h23-1-29" class="i">+                    },
</a><a href="#h23-1-30" id="h23-1-30" class="i">+                    outer_size: 7,
</a><a href="#h23-1-31" id="h23-1-31" class="i">+                    inner: Scan {
</a><a href="#h23-1-32" id="h23-1-32" class="i">+                        table: &quot;genres&quot;,
</a><a href="#h23-1-33" id="h23-1-33" class="i">+                        alias: None,
</a><a href="#h23-1-34" id="h23-1-34" class="i">+                        filter: None,
</a><a href="#h23-1-35" id="h23-1-35" class="i">+                    },
</a><a href="#h23-1-36" id="h23-1-36" class="i">+                    predicate: Some(
</a><a href="#h23-1-37" id="h23-1-37" class="i">+                        Equal(
</a><a href="#h23-1-38" id="h23-1-38" class="i">+                            Field(
</a><a href="#h23-1-39" id="h23-1-39" class="i">+                                3,
</a><a href="#h23-1-40" id="h23-1-40" class="i">+                                Some(
</a><a href="#h23-1-41" id="h23-1-41" class="i">+                                    (
</a><a href="#h23-1-42" id="h23-1-42" class="i">+                                        Some(
</a><a href="#h23-1-43" id="h23-1-43" class="i">+                                            &quot;movies&quot;,
</a><a href="#h23-1-44" id="h23-1-44" class="i">+                                        ),
</a><a href="#h23-1-45" id="h23-1-45" class="i">+                                        &quot;genre_id&quot;,
</a>                                     ),
<a href="#h23-1-47" id="h23-1-47" class="d">-                                    &quot;genre_id&quot;,
</a>                                 ),
                             ),
<a href="#h23-1-50" id="h23-1-50" class="d">-                        ),
</a><a href="#h23-1-51" id="h23-1-51" class="d">-                        Field(
</a><a href="#h23-1-52" id="h23-1-52" class="d">-                            7,
</a><a href="#h23-1-53" id="h23-1-53" class="d">-                            Some(
</a><a href="#h23-1-54" id="h23-1-54" class="d">-                                (
</a><a href="#h23-1-55" id="h23-1-55" class="d">-                                    Some(
</a><a href="#h23-1-56" id="h23-1-56" class="d">-                                        &quot;genres&quot;,
</a><a href="#h23-1-57" id="h23-1-57" class="i">+                            Field(
</a><a href="#h23-1-58" id="h23-1-58" class="i">+                                7,
</a><a href="#h23-1-59" id="h23-1-59" class="i">+                                Some(
</a><a href="#h23-1-60" id="h23-1-60" class="i">+                                    (
</a><a href="#h23-1-61" id="h23-1-61" class="i">+                                        Some(
</a><a href="#h23-1-62" id="h23-1-62" class="i">+                                            &quot;genres&quot;,
</a><a href="#h23-1-63" id="h23-1-63" class="i">+                                        ),
</a><a href="#h23-1-64" id="h23-1-64" class="i">+                                        &quot;id&quot;,
</a>                                     ),
<a href="#h23-1-66" id="h23-1-66" class="d">-                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
                     ),
<a href="#h23-1-71" id="h23-1-71" class="d">-                ),
</a><a href="#h23-1-72" id="h23-1-72" class="d">-                pad: false,
</a><a href="#h23-1-73" id="h23-1-73" class="d">-                flip: false,
</a><a href="#h23-1-74" id="h23-1-74" class="i">+                    pad: false,
</a><a href="#h23-1-75" id="h23-1-75" class="i">+                    flip: false,
</a><a href="#h23-1-76" id="h23-1-76" class="i">+                },
</a><a href="#h23-1-77" id="h23-1-77" class="i">+                predicate: None,
</a>             },
             expressions: [
                 (
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -101,26 +101,28 @@ Plan: Plan(
</a>                         pad: false,
                         flip: false,
                     },
<a href="#h24-0-3" id="h24-0-3" class="d">-                    predicate: Equal(
</a><a href="#h24-0-4" id="h24-0-4" class="d">-                        Field(
</a><a href="#h24-0-5" id="h24-0-5" class="d">-                            3,
</a><a href="#h24-0-6" id="h24-0-6" class="d">-                            Some(
</a><a href="#h24-0-7" id="h24-0-7" class="d">-                                (
</a><a href="#h24-0-8" id="h24-0-8" class="d">-                                    Some(
</a><a href="#h24-0-9" id="h24-0-9" class="d">-                                        &quot;movies&quot;,
</a><a href="#h24-0-10" id="h24-0-10" class="i">+                    predicate: Some(
</a><a href="#h24-0-11" id="h24-0-11" class="i">+                        Equal(
</a><a href="#h24-0-12" id="h24-0-12" class="i">+                            Field(
</a><a href="#h24-0-13" id="h24-0-13" class="i">+                                3,
</a><a href="#h24-0-14" id="h24-0-14" class="i">+                                Some(
</a><a href="#h24-0-15" id="h24-0-15" class="i">+                                    (
</a><a href="#h24-0-16" id="h24-0-16" class="i">+                                        Some(
</a><a href="#h24-0-17" id="h24-0-17" class="i">+                                            &quot;movies&quot;,
</a><a href="#h24-0-18" id="h24-0-18" class="i">+                                        ),
</a><a href="#h24-0-19" id="h24-0-19" class="i">+                                        &quot;genre_id&quot;,
</a>                                     ),
<a href="#h24-0-21" id="h24-0-21" class="d">-                                    &quot;genre_id&quot;,
</a>                                 ),
                             ),
<a href="#h24-0-24" id="h24-0-24" class="d">-                        ),
</a><a href="#h24-0-25" id="h24-0-25" class="d">-                        Field(
</a><a href="#h24-0-26" id="h24-0-26" class="d">-                            7,
</a><a href="#h24-0-27" id="h24-0-27" class="d">-                            Some(
</a><a href="#h24-0-28" id="h24-0-28" class="d">-                                (
</a><a href="#h24-0-29" id="h24-0-29" class="d">-                                    Some(
</a><a href="#h24-0-30" id="h24-0-30" class="d">-                                        &quot;genres&quot;,
</a><a href="#h24-0-31" id="h24-0-31" class="i">+                            Field(
</a><a href="#h24-0-32" id="h24-0-32" class="i">+                                7,
</a><a href="#h24-0-33" id="h24-0-33" class="i">+                                Some(
</a><a href="#h24-0-34" id="h24-0-34" class="i">+                                    (
</a><a href="#h24-0-35" id="h24-0-35" class="i">+                                        Some(
</a><a href="#h24-0-36" id="h24-0-36" class="i">+                                            &quot;genres&quot;,
</a><a href="#h24-0-37" id="h24-0-37" class="i">+                                        ),
</a><a href="#h24-0-38" id="h24-0-38" class="i">+                                        &quot;id&quot;,
</a>                                     ),
<a href="#h24-0-40" id="h24-0-40" class="d">-                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h24-1" id="h24-1" class="h">@@ -242,46 +244,49 @@ Optimized plan: Plan(
</a>     Projection {
         source: Order {
             source: Projection {
<a href="#h24-1-3" id="h24-1-3" class="d">-                source: NestedLoopJoin {
</a><a href="#h24-1-4" id="h24-1-4" class="d">-                    outer: Scan {
</a><a href="#h24-1-5" id="h24-1-5" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h24-1-6" id="h24-1-6" class="d">-                        alias: None,
</a><a href="#h24-1-7" id="h24-1-7" class="d">-                        filter: None,
</a><a href="#h24-1-8" id="h24-1-8" class="d">-                    },
</a><a href="#h24-1-9" id="h24-1-9" class="d">-                    outer_size: 7,
</a><a href="#h24-1-10" id="h24-1-10" class="d">-                    inner: Scan {
</a><a href="#h24-1-11" id="h24-1-11" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h24-1-12" id="h24-1-12" class="d">-                        alias: None,
</a><a href="#h24-1-13" id="h24-1-13" class="d">-                        filter: None,
</a><a href="#h24-1-14" id="h24-1-14" class="d">-                    },
</a><a href="#h24-1-15" id="h24-1-15" class="d">-                    predicate: Some(
</a><a href="#h24-1-16" id="h24-1-16" class="d">-                        Equal(
</a><a href="#h24-1-17" id="h24-1-17" class="d">-                            Field(
</a><a href="#h24-1-18" id="h24-1-18" class="d">-                                3,
</a><a href="#h24-1-19" id="h24-1-19" class="d">-                                Some(
</a><a href="#h24-1-20" id="h24-1-20" class="d">-                                    (
</a><a href="#h24-1-21" id="h24-1-21" class="d">-                                        Some(
</a><a href="#h24-1-22" id="h24-1-22" class="d">-                                            &quot;movies&quot;,
</a><a href="#h24-1-23" id="h24-1-23" class="i">+                source: Filter {
</a><a href="#h24-1-24" id="h24-1-24" class="i">+                    source: NestedLoopJoin {
</a><a href="#h24-1-25" id="h24-1-25" class="i">+                        outer: Scan {
</a><a href="#h24-1-26" id="h24-1-26" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h24-1-27" id="h24-1-27" class="i">+                            alias: None,
</a><a href="#h24-1-28" id="h24-1-28" class="i">+                            filter: None,
</a><a href="#h24-1-29" id="h24-1-29" class="i">+                        },
</a><a href="#h24-1-30" id="h24-1-30" class="i">+                        outer_size: 7,
</a><a href="#h24-1-31" id="h24-1-31" class="i">+                        inner: Scan {
</a><a href="#h24-1-32" id="h24-1-32" class="i">+                            table: &quot;genres&quot;,
</a><a href="#h24-1-33" id="h24-1-33" class="i">+                            alias: None,
</a><a href="#h24-1-34" id="h24-1-34" class="i">+                            filter: None,
</a><a href="#h24-1-35" id="h24-1-35" class="i">+                        },
</a><a href="#h24-1-36" id="h24-1-36" class="i">+                        predicate: Some(
</a><a href="#h24-1-37" id="h24-1-37" class="i">+                            Equal(
</a><a href="#h24-1-38" id="h24-1-38" class="i">+                                Field(
</a><a href="#h24-1-39" id="h24-1-39" class="i">+                                    3,
</a><a href="#h24-1-40" id="h24-1-40" class="i">+                                    Some(
</a><a href="#h24-1-41" id="h24-1-41" class="i">+                                        (
</a><a href="#h24-1-42" id="h24-1-42" class="i">+                                            Some(
</a><a href="#h24-1-43" id="h24-1-43" class="i">+                                                &quot;movies&quot;,
</a><a href="#h24-1-44" id="h24-1-44" class="i">+                                            ),
</a><a href="#h24-1-45" id="h24-1-45" class="i">+                                            &quot;genre_id&quot;,
</a>                                         ),
<a href="#h24-1-47" id="h24-1-47" class="d">-                                        &quot;genre_id&quot;,
</a>                                     ),
                                 ),
<a href="#h24-1-50" id="h24-1-50" class="d">-                            ),
</a><a href="#h24-1-51" id="h24-1-51" class="d">-                            Field(
</a><a href="#h24-1-52" id="h24-1-52" class="d">-                                7,
</a><a href="#h24-1-53" id="h24-1-53" class="d">-                                Some(
</a><a href="#h24-1-54" id="h24-1-54" class="d">-                                    (
</a><a href="#h24-1-55" id="h24-1-55" class="d">-                                        Some(
</a><a href="#h24-1-56" id="h24-1-56" class="d">-                                            &quot;genres&quot;,
</a><a href="#h24-1-57" id="h24-1-57" class="i">+                                Field(
</a><a href="#h24-1-58" id="h24-1-58" class="i">+                                    7,
</a><a href="#h24-1-59" id="h24-1-59" class="i">+                                    Some(
</a><a href="#h24-1-60" id="h24-1-60" class="i">+                                        (
</a><a href="#h24-1-61" id="h24-1-61" class="i">+                                            Some(
</a><a href="#h24-1-62" id="h24-1-62" class="i">+                                                &quot;genres&quot;,
</a><a href="#h24-1-63" id="h24-1-63" class="i">+                                            ),
</a><a href="#h24-1-64" id="h24-1-64" class="i">+                                            &quot;id&quot;,
</a>                                         ),
<a href="#h24-1-66" id="h24-1-66" class="d">-                                        &quot;id&quot;,
</a>                                     ),
                                 ),
                             ),
                         ),
<a href="#h24-1-71" id="h24-1-71" class="d">-                    ),
</a><a href="#h24-1-72" id="h24-1-72" class="d">-                    pad: false,
</a><a href="#h24-1-73" id="h24-1-73" class="d">-                    flip: false,
</a><a href="#h24-1-74" id="h24-1-74" class="i">+                        pad: false,
</a><a href="#h24-1-75" id="h24-1-75" class="i">+                        flip: false,
</a><a href="#h24-1-76" id="h24-1-76" class="i">+                    },
</a><a href="#h24-1-77" id="h24-1-77" class="i">+                    predicate: None,
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a> b/<a href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -45,59 +45,7 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h25-0-3" id="h25-0-3" class="d">-        predicate: And(
</a><a href="#h25-0-4" id="h25-0-4" class="d">-            Or(
</a><a href="#h25-0-5" id="h25-0-5" class="d">-                GreaterThan(
</a><a href="#h25-0-6" id="h25-0-6" class="d">-                    Field(
</a><a href="#h25-0-7" id="h25-0-7" class="d">-                        4,
</a><a href="#h25-0-8" id="h25-0-8" class="d">-                        Some(
</a><a href="#h25-0-9" id="h25-0-9" class="d">-                            (
</a><a href="#h25-0-10" id="h25-0-10" class="d">-                                None,
</a><a href="#h25-0-11" id="h25-0-11" class="d">-                                &quot;released&quot;,
</a><a href="#h25-0-12" id="h25-0-12" class="d">-                            ),
</a><a href="#h25-0-13" id="h25-0-13" class="d">-                        ),
</a><a href="#h25-0-14" id="h25-0-14" class="d">-                    ),
</a><a href="#h25-0-15" id="h25-0-15" class="d">-                    Constant(
</a><a href="#h25-0-16" id="h25-0-16" class="d">-                        Integer(
</a><a href="#h25-0-17" id="h25-0-17" class="d">-                            2000,
</a><a href="#h25-0-18" id="h25-0-18" class="d">-                        ),
</a><a href="#h25-0-19" id="h25-0-19" class="d">-                    ),
</a><a href="#h25-0-20" id="h25-0-20" class="d">-                ),
</a><a href="#h25-0-21" id="h25-0-21" class="d">-                Equal(
</a><a href="#h25-0-22" id="h25-0-22" class="d">-                    Field(
</a><a href="#h25-0-23" id="h25-0-23" class="d">-                        4,
</a><a href="#h25-0-24" id="h25-0-24" class="d">-                        Some(
</a><a href="#h25-0-25" id="h25-0-25" class="d">-                            (
</a><a href="#h25-0-26" id="h25-0-26" class="d">-                                None,
</a><a href="#h25-0-27" id="h25-0-27" class="d">-                                &quot;released&quot;,
</a><a href="#h25-0-28" id="h25-0-28" class="d">-                            ),
</a><a href="#h25-0-29" id="h25-0-29" class="d">-                        ),
</a><a href="#h25-0-30" id="h25-0-30" class="d">-                    ),
</a><a href="#h25-0-31" id="h25-0-31" class="d">-                    Constant(
</a><a href="#h25-0-32" id="h25-0-32" class="d">-                        Integer(
</a><a href="#h25-0-33" id="h25-0-33" class="d">-                            2000,
</a><a href="#h25-0-34" id="h25-0-34" class="d">-                        ),
</a><a href="#h25-0-35" id="h25-0-35" class="d">-                    ),
</a><a href="#h25-0-36" id="h25-0-36" class="d">-                ),
</a><a href="#h25-0-37" id="h25-0-37" class="d">-            ),
</a><a href="#h25-0-38" id="h25-0-38" class="d">-            Field(
</a><a href="#h25-0-39" id="h25-0-39" class="d">-                6,
</a><a href="#h25-0-40" id="h25-0-40" class="d">-                Some(
</a><a href="#h25-0-41" id="h25-0-41" class="d">-                    (
</a><a href="#h25-0-42" id="h25-0-42" class="d">-                        None,
</a><a href="#h25-0-43" id="h25-0-43" class="d">-                        &quot;ultrahd&quot;,
</a><a href="#h25-0-44" id="h25-0-44" class="d">-                    ),
</a><a href="#h25-0-45" id="h25-0-45" class="d">-                ),
</a><a href="#h25-0-46" id="h25-0-46" class="d">-            ),
</a><a href="#h25-0-47" id="h25-0-47" class="d">-        ),
</a><a href="#h25-0-48" id="h25-0-48" class="d">-    },
</a><a href="#h25-0-49" id="h25-0-49" class="d">-)
</a><a href="#h25-0-50" id="h25-0-50" class="d">-
</a><a href="#h25-0-51" id="h25-0-51" class="d">-Optimized plan: Plan(
</a><a href="#h25-0-52" id="h25-0-52" class="d">-    Scan {
</a><a href="#h25-0-53" id="h25-0-53" class="d">-        table: &quot;movies&quot;,
</a><a href="#h25-0-54" id="h25-0-54" class="d">-        alias: None,
</a><a href="#h25-0-55" id="h25-0-55" class="d">-        filter: Some(
</a><a href="#h25-0-56" id="h25-0-56" class="i">+        predicate: Some(
</a>             And(
                 Or(
                     GreaterThan(
<a href="#h25-1" id="h25-1" class="h">@@ -147,6 +95,63 @@ Optimized plan: Plan(
</a>     },
 )
 
<a href="#h25-1-3" id="h25-1-3" class="i">+Optimized plan: Plan(
</a><a href="#h25-1-4" id="h25-1-4" class="i">+    Filter {
</a><a href="#h25-1-5" id="h25-1-5" class="i">+        source: Scan {
</a><a href="#h25-1-6" id="h25-1-6" class="i">+            table: &quot;movies&quot;,
</a><a href="#h25-1-7" id="h25-1-7" class="i">+            alias: None,
</a><a href="#h25-1-8" id="h25-1-8" class="i">+            filter: Some(
</a><a href="#h25-1-9" id="h25-1-9" class="i">+                And(
</a><a href="#h25-1-10" id="h25-1-10" class="i">+                    Or(
</a><a href="#h25-1-11" id="h25-1-11" class="i">+                        GreaterThan(
</a><a href="#h25-1-12" id="h25-1-12" class="i">+                            Field(
</a><a href="#h25-1-13" id="h25-1-13" class="i">+                                4,
</a><a href="#h25-1-14" id="h25-1-14" class="i">+                                Some(
</a><a href="#h25-1-15" id="h25-1-15" class="i">+                                    (
</a><a href="#h25-1-16" id="h25-1-16" class="i">+                                        None,
</a><a href="#h25-1-17" id="h25-1-17" class="i">+                                        &quot;released&quot;,
</a><a href="#h25-1-18" id="h25-1-18" class="i">+                                    ),
</a><a href="#h25-1-19" id="h25-1-19" class="i">+                                ),
</a><a href="#h25-1-20" id="h25-1-20" class="i">+                            ),
</a><a href="#h25-1-21" id="h25-1-21" class="i">+                            Constant(
</a><a href="#h25-1-22" id="h25-1-22" class="i">+                                Integer(
</a><a href="#h25-1-23" id="h25-1-23" class="i">+                                    2000,
</a><a href="#h25-1-24" id="h25-1-24" class="i">+                                ),
</a><a href="#h25-1-25" id="h25-1-25" class="i">+                            ),
</a><a href="#h25-1-26" id="h25-1-26" class="i">+                        ),
</a><a href="#h25-1-27" id="h25-1-27" class="i">+                        Equal(
</a><a href="#h25-1-28" id="h25-1-28" class="i">+                            Field(
</a><a href="#h25-1-29" id="h25-1-29" class="i">+                                4,
</a><a href="#h25-1-30" id="h25-1-30" class="i">+                                Some(
</a><a href="#h25-1-31" id="h25-1-31" class="i">+                                    (
</a><a href="#h25-1-32" id="h25-1-32" class="i">+                                        None,
</a><a href="#h25-1-33" id="h25-1-33" class="i">+                                        &quot;released&quot;,
</a><a href="#h25-1-34" id="h25-1-34" class="i">+                                    ),
</a><a href="#h25-1-35" id="h25-1-35" class="i">+                                ),
</a><a href="#h25-1-36" id="h25-1-36" class="i">+                            ),
</a><a href="#h25-1-37" id="h25-1-37" class="i">+                            Constant(
</a><a href="#h25-1-38" id="h25-1-38" class="i">+                                Integer(
</a><a href="#h25-1-39" id="h25-1-39" class="i">+                                    2000,
</a><a href="#h25-1-40" id="h25-1-40" class="i">+                                ),
</a><a href="#h25-1-41" id="h25-1-41" class="i">+                            ),
</a><a href="#h25-1-42" id="h25-1-42" class="i">+                        ),
</a><a href="#h25-1-43" id="h25-1-43" class="i">+                    ),
</a><a href="#h25-1-44" id="h25-1-44" class="i">+                    Field(
</a><a href="#h25-1-45" id="h25-1-45" class="i">+                        6,
</a><a href="#h25-1-46" id="h25-1-46" class="i">+                        Some(
</a><a href="#h25-1-47" id="h25-1-47" class="i">+                            (
</a><a href="#h25-1-48" id="h25-1-48" class="i">+                                None,
</a><a href="#h25-1-49" id="h25-1-49" class="i">+                                &quot;ultrahd&quot;,
</a><a href="#h25-1-50" id="h25-1-50" class="i">+                            ),
</a><a href="#h25-1-51" id="h25-1-51" class="i">+                        ),
</a><a href="#h25-1-52" id="h25-1-52" class="i">+                    ),
</a><a href="#h25-1-53" id="h25-1-53" class="i">+                ),
</a><a href="#h25-1-54" id="h25-1-54" class="i">+            ),
</a><a href="#h25-1-55" id="h25-1-55" class="i">+        },
</a><a href="#h25-1-56" id="h25-1-56" class="i">+        predicate: None,
</a><a href="#h25-1-57" id="h25-1-57" class="i">+    },
</a><a href="#h25-1-58" id="h25-1-58" class="i">+)
</a><a href="#h25-1-59" id="h25-1-59" class="i">+
</a> Query: SELECT * FROM movies WHERE released &gt;= 2000 AND ultrahd
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a> b/<a href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -29,25 +29,30 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h26-0-3" id="h26-0-3" class="d">-        predicate: Constant(
</a><a href="#h26-0-4" id="h26-0-4" class="d">-            Boolean(
</a><a href="#h26-0-5" id="h26-0-5" class="d">-                false,
</a><a href="#h26-0-6" id="h26-0-6" class="i">+        predicate: Some(
</a><a href="#h26-0-7" id="h26-0-7" class="i">+            Constant(
</a><a href="#h26-0-8" id="h26-0-8" class="i">+                Boolean(
</a><a href="#h26-0-9" id="h26-0-9" class="i">+                    false,
</a><a href="#h26-0-10" id="h26-0-10" class="i">+                ),
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h26-0-17" id="h26-0-17" class="d">-    Scan {
</a><a href="#h26-0-18" id="h26-0-18" class="d">-        table: &quot;movies&quot;,
</a><a href="#h26-0-19" id="h26-0-19" class="d">-        alias: None,
</a><a href="#h26-0-20" id="h26-0-20" class="d">-        filter: Some(
</a><a href="#h26-0-21" id="h26-0-21" class="d">-            Constant(
</a><a href="#h26-0-22" id="h26-0-22" class="d">-                Boolean(
</a><a href="#h26-0-23" id="h26-0-23" class="d">-                    false,
</a><a href="#h26-0-24" id="h26-0-24" class="i">+    Filter {
</a><a href="#h26-0-25" id="h26-0-25" class="i">+        source: Scan {
</a><a href="#h26-0-26" id="h26-0-26" class="i">+            table: &quot;movies&quot;,
</a><a href="#h26-0-27" id="h26-0-27" class="i">+            alias: None,
</a><a href="#h26-0-28" id="h26-0-28" class="i">+            filter: Some(
</a><a href="#h26-0-29" id="h26-0-29" class="i">+                Constant(
</a><a href="#h26-0-30" id="h26-0-30" class="i">+                    Boolean(
</a><a href="#h26-0-31" id="h26-0-31" class="i">+                        false,
</a><a href="#h26-0-32" id="h26-0-32" class="i">+                    ),
</a>                 ),
             ),
<a href="#h26-0-35" id="h26-0-35" class="d">-        ),
</a><a href="#h26-0-36" id="h26-0-36" class="i">+        },
</a><a href="#h26-0-37" id="h26-0-37" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -101,33 +101,53 @@ Plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h27-0-3" id="h27-0-3" class="d">-            predicate: And(
</a><a href="#h27-0-4" id="h27-0-4" class="d">-                Or(
</a><a href="#h27-0-5" id="h27-0-5" class="d">-                    GreaterThan(
</a><a href="#h27-0-6" id="h27-0-6" class="d">-                        Field(
</a><a href="#h27-0-7" id="h27-0-7" class="d">-                            0,
</a><a href="#h27-0-8" id="h27-0-8" class="d">-                            Some(
</a><a href="#h27-0-9" id="h27-0-9" class="d">-                                (
</a><a href="#h27-0-10" id="h27-0-10" class="d">-                                    Some(
</a><a href="#h27-0-11" id="h27-0-11" class="d">-                                        &quot;m&quot;,
</a><a href="#h27-0-12" id="h27-0-12" class="i">+            predicate: Some(
</a><a href="#h27-0-13" id="h27-0-13" class="i">+                And(
</a><a href="#h27-0-14" id="h27-0-14" class="i">+                    Or(
</a><a href="#h27-0-15" id="h27-0-15" class="i">+                        GreaterThan(
</a><a href="#h27-0-16" id="h27-0-16" class="i">+                            Field(
</a><a href="#h27-0-17" id="h27-0-17" class="i">+                                0,
</a><a href="#h27-0-18" id="h27-0-18" class="i">+                                Some(
</a><a href="#h27-0-19" id="h27-0-19" class="i">+                                    (
</a><a href="#h27-0-20" id="h27-0-20" class="i">+                                        Some(
</a><a href="#h27-0-21" id="h27-0-21" class="i">+                                            &quot;m&quot;,
</a><a href="#h27-0-22" id="h27-0-22" class="i">+                                        ),
</a><a href="#h27-0-23" id="h27-0-23" class="i">+                                        &quot;id&quot;,
</a>                                     ),
<a href="#h27-0-25" id="h27-0-25" class="d">-                                    &quot;id&quot;,
</a><a href="#h27-0-26" id="h27-0-26" class="i">+                                ),
</a><a href="#h27-0-27" id="h27-0-27" class="i">+                            ),
</a><a href="#h27-0-28" id="h27-0-28" class="i">+                            Constant(
</a><a href="#h27-0-29" id="h27-0-29" class="i">+                                Integer(
</a><a href="#h27-0-30" id="h27-0-30" class="i">+                                    3,
</a>                                 ),
                             ),
                         ),
<a href="#h27-0-34" id="h27-0-34" class="d">-                        Constant(
</a><a href="#h27-0-35" id="h27-0-35" class="d">-                            Integer(
</a><a href="#h27-0-36" id="h27-0-36" class="d">-                                3,
</a><a href="#h27-0-37" id="h27-0-37" class="i">+                        Equal(
</a><a href="#h27-0-38" id="h27-0-38" class="i">+                            Field(
</a><a href="#h27-0-39" id="h27-0-39" class="i">+                                0,
</a><a href="#h27-0-40" id="h27-0-40" class="i">+                                Some(
</a><a href="#h27-0-41" id="h27-0-41" class="i">+                                    (
</a><a href="#h27-0-42" id="h27-0-42" class="i">+                                        Some(
</a><a href="#h27-0-43" id="h27-0-43" class="i">+                                            &quot;m&quot;,
</a><a href="#h27-0-44" id="h27-0-44" class="i">+                                        ),
</a><a href="#h27-0-45" id="h27-0-45" class="i">+                                        &quot;id&quot;,
</a><a href="#h27-0-46" id="h27-0-46" class="i">+                                    ),
</a><a href="#h27-0-47" id="h27-0-47" class="i">+                                ),
</a><a href="#h27-0-48" id="h27-0-48" class="i">+                            ),
</a><a href="#h27-0-49" id="h27-0-49" class="i">+                            Constant(
</a><a href="#h27-0-50" id="h27-0-50" class="i">+                                Integer(
</a><a href="#h27-0-51" id="h27-0-51" class="i">+                                    3,
</a><a href="#h27-0-52" id="h27-0-52" class="i">+                                ),
</a>                             ),
                         ),
                     ),
                     Equal(
                         Field(
<a href="#h27-0-58" id="h27-0-58" class="d">-                            0,
</a><a href="#h27-0-59" id="h27-0-59" class="i">+                            7,
</a>                             Some(
                                 (
                                     Some(
<a href="#h27-0-63" id="h27-0-63" class="d">-                                        &quot;m&quot;,
</a><a href="#h27-0-64" id="h27-0-64" class="i">+                                        &quot;g&quot;,
</a>                                     ),
                                     &quot;id&quot;,
                                 ),
<a href="#h27-1" id="h27-1" class="h">@@ -135,28 +155,10 @@ Plan: Plan(
</a>                         ),
                         Constant(
                             Integer(
<a href="#h27-1-3" id="h27-1-3" class="d">-                                3,
</a><a href="#h27-1-4" id="h27-1-4" class="d">-                            ),
</a><a href="#h27-1-5" id="h27-1-5" class="d">-                        ),
</a><a href="#h27-1-6" id="h27-1-6" class="d">-                    ),
</a><a href="#h27-1-7" id="h27-1-7" class="d">-                ),
</a><a href="#h27-1-8" id="h27-1-8" class="d">-                Equal(
</a><a href="#h27-1-9" id="h27-1-9" class="d">-                    Field(
</a><a href="#h27-1-10" id="h27-1-10" class="d">-                        7,
</a><a href="#h27-1-11" id="h27-1-11" class="d">-                        Some(
</a><a href="#h27-1-12" id="h27-1-12" class="d">-                            (
</a><a href="#h27-1-13" id="h27-1-13" class="d">-                                Some(
</a><a href="#h27-1-14" id="h27-1-14" class="d">-                                    &quot;g&quot;,
</a><a href="#h27-1-15" id="h27-1-15" class="d">-                                ),
</a><a href="#h27-1-16" id="h27-1-16" class="d">-                                &quot;id&quot;,
</a><a href="#h27-1-17" id="h27-1-17" class="i">+                                1,
</a>                             ),
                         ),
                     ),
<a href="#h27-1-21" id="h27-1-21" class="d">-                    Constant(
</a><a href="#h27-1-22" id="h27-1-22" class="d">-                        Integer(
</a><a href="#h27-1-23" id="h27-1-23" class="d">-                            1,
</a><a href="#h27-1-24" id="h27-1-24" class="d">-                        ),
</a><a href="#h27-1-25" id="h27-1-25" class="d">-                    ),
</a>                 ),
             ),
         },
<a href="#h27-2" id="h27-2" class="h">@@ -195,84 +197,71 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Projection {
<a href="#h27-2-3" id="h27-2-3" class="d">-        source: NestedLoopJoin {
</a><a href="#h27-2-4" id="h27-2-4" class="d">-            outer: Scan {
</a><a href="#h27-2-5" id="h27-2-5" class="d">-                table: &quot;movies&quot;,
</a><a href="#h27-2-6" id="h27-2-6" class="d">-                alias: Some(
</a><a href="#h27-2-7" id="h27-2-7" class="d">-                    &quot;m&quot;,
</a><a href="#h27-2-8" id="h27-2-8" class="d">-                ),
</a><a href="#h27-2-9" id="h27-2-9" class="d">-                filter: None,
</a><a href="#h27-2-10" id="h27-2-10" class="d">-            },
</a><a href="#h27-2-11" id="h27-2-11" class="d">-            outer_size: 7,
</a><a href="#h27-2-12" id="h27-2-12" class="d">-            inner: Scan {
</a><a href="#h27-2-13" id="h27-2-13" class="d">-                table: &quot;genres&quot;,
</a><a href="#h27-2-14" id="h27-2-14" class="d">-                alias: Some(
</a><a href="#h27-2-15" id="h27-2-15" class="d">-                    &quot;g&quot;,
</a><a href="#h27-2-16" id="h27-2-16" class="d">-                ),
</a><a href="#h27-2-17" id="h27-2-17" class="d">-                filter: None,
</a><a href="#h27-2-18" id="h27-2-18" class="d">-            },
</a><a href="#h27-2-19" id="h27-2-19" class="d">-            predicate: Some(
</a><a href="#h27-2-20" id="h27-2-20" class="d">-                And(
</a><a href="#h27-2-21" id="h27-2-21" class="d">-                    Or(
</a><a href="#h27-2-22" id="h27-2-22" class="d">-                        GreaterThan(
</a><a href="#h27-2-23" id="h27-2-23" class="d">-                            Field(
</a><a href="#h27-2-24" id="h27-2-24" class="d">-                                0,
</a><a href="#h27-2-25" id="h27-2-25" class="d">-                                Some(
</a><a href="#h27-2-26" id="h27-2-26" class="d">-                                    (
</a><a href="#h27-2-27" id="h27-2-27" class="d">-                                        Some(
</a><a href="#h27-2-28" id="h27-2-28" class="d">-                                            &quot;m&quot;,
</a><a href="#h27-2-29" id="h27-2-29" class="i">+        source: Filter {
</a><a href="#h27-2-30" id="h27-2-30" class="i">+            source: NestedLoopJoin {
</a><a href="#h27-2-31" id="h27-2-31" class="i">+                outer: Scan {
</a><a href="#h27-2-32" id="h27-2-32" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h27-2-33" id="h27-2-33" class="i">+                    alias: Some(
</a><a href="#h27-2-34" id="h27-2-34" class="i">+                        &quot;m&quot;,
</a><a href="#h27-2-35" id="h27-2-35" class="i">+                    ),
</a><a href="#h27-2-36" id="h27-2-36" class="i">+                    filter: Some(
</a><a href="#h27-2-37" id="h27-2-37" class="i">+                        Or(
</a><a href="#h27-2-38" id="h27-2-38" class="i">+                            GreaterThan(
</a><a href="#h27-2-39" id="h27-2-39" class="i">+                                Field(
</a><a href="#h27-2-40" id="h27-2-40" class="i">+                                    0,
</a><a href="#h27-2-41" id="h27-2-41" class="i">+                                    Some(
</a><a href="#h27-2-42" id="h27-2-42" class="i">+                                        (
</a><a href="#h27-2-43" id="h27-2-43" class="i">+                                            Some(
</a><a href="#h27-2-44" id="h27-2-44" class="i">+                                                &quot;m&quot;,
</a><a href="#h27-2-45" id="h27-2-45" class="i">+                                            ),
</a><a href="#h27-2-46" id="h27-2-46" class="i">+                                            &quot;id&quot;,
</a>                                         ),
<a href="#h27-2-48" id="h27-2-48" class="d">-                                        &quot;id&quot;,
</a>                                     ),
                                 ),
<a href="#h27-2-51" id="h27-2-51" class="d">-                            ),
</a><a href="#h27-2-52" id="h27-2-52" class="d">-                            Constant(
</a><a href="#h27-2-53" id="h27-2-53" class="d">-                                Integer(
</a><a href="#h27-2-54" id="h27-2-54" class="d">-                                    3,
</a><a href="#h27-2-55" id="h27-2-55" class="i">+                                Constant(
</a><a href="#h27-2-56" id="h27-2-56" class="i">+                                    Integer(
</a><a href="#h27-2-57" id="h27-2-57" class="i">+                                        3,
</a><a href="#h27-2-58" id="h27-2-58" class="i">+                                    ),
</a>                                 ),
                             ),
<a href="#h27-2-61" id="h27-2-61" class="d">-                        ),
</a><a href="#h27-2-62" id="h27-2-62" class="d">-                        Equal(
</a><a href="#h27-2-63" id="h27-2-63" class="d">-                            Field(
</a><a href="#h27-2-64" id="h27-2-64" class="d">-                                0,
</a><a href="#h27-2-65" id="h27-2-65" class="d">-                                Some(
</a><a href="#h27-2-66" id="h27-2-66" class="d">-                                    (
</a><a href="#h27-2-67" id="h27-2-67" class="d">-                                        Some(
</a><a href="#h27-2-68" id="h27-2-68" class="d">-                                            &quot;m&quot;,
</a><a href="#h27-2-69" id="h27-2-69" class="i">+                            Equal(
</a><a href="#h27-2-70" id="h27-2-70" class="i">+                                Field(
</a><a href="#h27-2-71" id="h27-2-71" class="i">+                                    0,
</a><a href="#h27-2-72" id="h27-2-72" class="i">+                                    Some(
</a><a href="#h27-2-73" id="h27-2-73" class="i">+                                        (
</a><a href="#h27-2-74" id="h27-2-74" class="i">+                                            Some(
</a><a href="#h27-2-75" id="h27-2-75" class="i">+                                                &quot;m&quot;,
</a><a href="#h27-2-76" id="h27-2-76" class="i">+                                            ),
</a><a href="#h27-2-77" id="h27-2-77" class="i">+                                            &quot;id&quot;,
</a>                                         ),
<a href="#h27-2-79" id="h27-2-79" class="d">-                                        &quot;id&quot;,
</a>                                     ),
                                 ),
<a href="#h27-2-82" id="h27-2-82" class="d">-                            ),
</a><a href="#h27-2-83" id="h27-2-83" class="d">-                            Constant(
</a><a href="#h27-2-84" id="h27-2-84" class="d">-                                Integer(
</a><a href="#h27-2-85" id="h27-2-85" class="d">-                                    3,
</a><a href="#h27-2-86" id="h27-2-86" class="d">-                                ),
</a><a href="#h27-2-87" id="h27-2-87" class="d">-                            ),
</a><a href="#h27-2-88" id="h27-2-88" class="d">-                        ),
</a><a href="#h27-2-89" id="h27-2-89" class="d">-                    ),
</a><a href="#h27-2-90" id="h27-2-90" class="d">-                    Equal(
</a><a href="#h27-2-91" id="h27-2-91" class="d">-                        Field(
</a><a href="#h27-2-92" id="h27-2-92" class="d">-                            7,
</a><a href="#h27-2-93" id="h27-2-93" class="d">-                            Some(
</a><a href="#h27-2-94" id="h27-2-94" class="d">-                                (
</a><a href="#h27-2-95" id="h27-2-95" class="d">-                                    Some(
</a><a href="#h27-2-96" id="h27-2-96" class="d">-                                        &quot;g&quot;,
</a><a href="#h27-2-97" id="h27-2-97" class="i">+                                Constant(
</a><a href="#h27-2-98" id="h27-2-98" class="i">+                                    Integer(
</a><a href="#h27-2-99" id="h27-2-99" class="i">+                                        3,
</a>                                     ),
<a href="#h27-2-101" id="h27-2-101" class="d">-                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h27-2-105" id="h27-2-105" class="d">-                        Constant(
</a><a href="#h27-2-106" id="h27-2-106" class="d">-                            Integer(
</a><a href="#h27-2-107" id="h27-2-107" class="d">-                                1,
</a><a href="#h27-2-108" id="h27-2-108" class="d">-                            ),
</a><a href="#h27-2-109" id="h27-2-109" class="d">-                        ),
</a>                     ),
<a href="#h27-2-111" id="h27-2-111" class="d">-                ),
</a><a href="#h27-2-112" id="h27-2-112" class="d">-            ),
</a><a href="#h27-2-113" id="h27-2-113" class="d">-            pad: false,
</a><a href="#h27-2-114" id="h27-2-114" class="d">-            flip: false,
</a><a href="#h27-2-115" id="h27-2-115" class="i">+                },
</a><a href="#h27-2-116" id="h27-2-116" class="i">+                outer_size: 7,
</a><a href="#h27-2-117" id="h27-2-117" class="i">+                inner: KeyLookup {
</a><a href="#h27-2-118" id="h27-2-118" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h27-2-119" id="h27-2-119" class="i">+                    alias: Some(
</a><a href="#h27-2-120" id="h27-2-120" class="i">+                        &quot;g&quot;,
</a><a href="#h27-2-121" id="h27-2-121" class="i">+                    ),
</a><a href="#h27-2-122" id="h27-2-122" class="i">+                    keys: [
</a><a href="#h27-2-123" id="h27-2-123" class="i">+                        Integer(
</a><a href="#h27-2-124" id="h27-2-124" class="i">+                            1,
</a><a href="#h27-2-125" id="h27-2-125" class="i">+                        ),
</a><a href="#h27-2-126" id="h27-2-126" class="i">+                    ],
</a><a href="#h27-2-127" id="h27-2-127" class="i">+                },
</a><a href="#h27-2-128" id="h27-2-128" class="i">+                predicate: None,
</a><a href="#h27-2-129" id="h27-2-129" class="i">+                pad: false,
</a><a href="#h27-2-130" id="h27-2-130" class="i">+                flip: false,
</a><a href="#h27-2-131" id="h27-2-131" class="i">+            },
</a><a href="#h27-2-132" id="h27-2-132" class="i">+            predicate: None,
</a>         },
         expressions: [
             (
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -93,33 +93,53 @@ Plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h28-0-3" id="h28-0-3" class="d">-            predicate: And(
</a><a href="#h28-0-4" id="h28-0-4" class="d">-                Or(
</a><a href="#h28-0-5" id="h28-0-5" class="d">-                    GreaterThan(
</a><a href="#h28-0-6" id="h28-0-6" class="d">-                        Field(
</a><a href="#h28-0-7" id="h28-0-7" class="d">-                            0,
</a><a href="#h28-0-8" id="h28-0-8" class="d">-                            Some(
</a><a href="#h28-0-9" id="h28-0-9" class="d">-                                (
</a><a href="#h28-0-10" id="h28-0-10" class="d">-                                    Some(
</a><a href="#h28-0-11" id="h28-0-11" class="d">-                                        &quot;movies&quot;,
</a><a href="#h28-0-12" id="h28-0-12" class="i">+            predicate: Some(
</a><a href="#h28-0-13" id="h28-0-13" class="i">+                And(
</a><a href="#h28-0-14" id="h28-0-14" class="i">+                    Or(
</a><a href="#h28-0-15" id="h28-0-15" class="i">+                        GreaterThan(
</a><a href="#h28-0-16" id="h28-0-16" class="i">+                            Field(
</a><a href="#h28-0-17" id="h28-0-17" class="i">+                                0,
</a><a href="#h28-0-18" id="h28-0-18" class="i">+                                Some(
</a><a href="#h28-0-19" id="h28-0-19" class="i">+                                    (
</a><a href="#h28-0-20" id="h28-0-20" class="i">+                                        Some(
</a><a href="#h28-0-21" id="h28-0-21" class="i">+                                            &quot;movies&quot;,
</a><a href="#h28-0-22" id="h28-0-22" class="i">+                                        ),
</a><a href="#h28-0-23" id="h28-0-23" class="i">+                                        &quot;id&quot;,
</a>                                     ),
<a href="#h28-0-25" id="h28-0-25" class="d">-                                    &quot;id&quot;,
</a><a href="#h28-0-26" id="h28-0-26" class="i">+                                ),
</a><a href="#h28-0-27" id="h28-0-27" class="i">+                            ),
</a><a href="#h28-0-28" id="h28-0-28" class="i">+                            Constant(
</a><a href="#h28-0-29" id="h28-0-29" class="i">+                                Integer(
</a><a href="#h28-0-30" id="h28-0-30" class="i">+                                    3,
</a>                                 ),
                             ),
                         ),
<a href="#h28-0-34" id="h28-0-34" class="d">-                        Constant(
</a><a href="#h28-0-35" id="h28-0-35" class="d">-                            Integer(
</a><a href="#h28-0-36" id="h28-0-36" class="d">-                                3,
</a><a href="#h28-0-37" id="h28-0-37" class="i">+                        Equal(
</a><a href="#h28-0-38" id="h28-0-38" class="i">+                            Field(
</a><a href="#h28-0-39" id="h28-0-39" class="i">+                                0,
</a><a href="#h28-0-40" id="h28-0-40" class="i">+                                Some(
</a><a href="#h28-0-41" id="h28-0-41" class="i">+                                    (
</a><a href="#h28-0-42" id="h28-0-42" class="i">+                                        Some(
</a><a href="#h28-0-43" id="h28-0-43" class="i">+                                            &quot;movies&quot;,
</a><a href="#h28-0-44" id="h28-0-44" class="i">+                                        ),
</a><a href="#h28-0-45" id="h28-0-45" class="i">+                                        &quot;id&quot;,
</a><a href="#h28-0-46" id="h28-0-46" class="i">+                                    ),
</a><a href="#h28-0-47" id="h28-0-47" class="i">+                                ),
</a><a href="#h28-0-48" id="h28-0-48" class="i">+                            ),
</a><a href="#h28-0-49" id="h28-0-49" class="i">+                            Constant(
</a><a href="#h28-0-50" id="h28-0-50" class="i">+                                Integer(
</a><a href="#h28-0-51" id="h28-0-51" class="i">+                                    3,
</a><a href="#h28-0-52" id="h28-0-52" class="i">+                                ),
</a>                             ),
                         ),
                     ),
                     Equal(
                         Field(
<a href="#h28-0-58" id="h28-0-58" class="d">-                            0,
</a><a href="#h28-0-59" id="h28-0-59" class="i">+                            7,
</a>                             Some(
                                 (
                                     Some(
<a href="#h28-0-63" id="h28-0-63" class="d">-                                        &quot;movies&quot;,
</a><a href="#h28-0-64" id="h28-0-64" class="i">+                                        &quot;genres&quot;,
</a>                                     ),
                                     &quot;id&quot;,
                                 ),
<a href="#h28-1" id="h28-1" class="h">@@ -127,28 +147,10 @@ Plan: Plan(
</a>                         ),
                         Constant(
                             Integer(
<a href="#h28-1-3" id="h28-1-3" class="d">-                                3,
</a><a href="#h28-1-4" id="h28-1-4" class="d">-                            ),
</a><a href="#h28-1-5" id="h28-1-5" class="d">-                        ),
</a><a href="#h28-1-6" id="h28-1-6" class="d">-                    ),
</a><a href="#h28-1-7" id="h28-1-7" class="d">-                ),
</a><a href="#h28-1-8" id="h28-1-8" class="d">-                Equal(
</a><a href="#h28-1-9" id="h28-1-9" class="d">-                    Field(
</a><a href="#h28-1-10" id="h28-1-10" class="d">-                        7,
</a><a href="#h28-1-11" id="h28-1-11" class="d">-                        Some(
</a><a href="#h28-1-12" id="h28-1-12" class="d">-                            (
</a><a href="#h28-1-13" id="h28-1-13" class="d">-                                Some(
</a><a href="#h28-1-14" id="h28-1-14" class="d">-                                    &quot;genres&quot;,
</a><a href="#h28-1-15" id="h28-1-15" class="d">-                                ),
</a><a href="#h28-1-16" id="h28-1-16" class="d">-                                &quot;id&quot;,
</a><a href="#h28-1-17" id="h28-1-17" class="i">+                                1,
</a>                             ),
                         ),
                     ),
<a href="#h28-1-21" id="h28-1-21" class="d">-                    Constant(
</a><a href="#h28-1-22" id="h28-1-22" class="d">-                        Integer(
</a><a href="#h28-1-23" id="h28-1-23" class="d">-                            1,
</a><a href="#h28-1-24" id="h28-1-24" class="d">-                        ),
</a><a href="#h28-1-25" id="h28-1-25" class="d">-                    ),
</a>                 ),
             ),
         },
<a href="#h28-2" id="h28-2" class="h">@@ -187,80 +189,67 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Projection {
<a href="#h28-2-3" id="h28-2-3" class="d">-        source: NestedLoopJoin {
</a><a href="#h28-2-4" id="h28-2-4" class="d">-            outer: Scan {
</a><a href="#h28-2-5" id="h28-2-5" class="d">-                table: &quot;movies&quot;,
</a><a href="#h28-2-6" id="h28-2-6" class="d">-                alias: None,
</a><a href="#h28-2-7" id="h28-2-7" class="d">-                filter: None,
</a><a href="#h28-2-8" id="h28-2-8" class="d">-            },
</a><a href="#h28-2-9" id="h28-2-9" class="d">-            outer_size: 7,
</a><a href="#h28-2-10" id="h28-2-10" class="d">-            inner: Scan {
</a><a href="#h28-2-11" id="h28-2-11" class="d">-                table: &quot;genres&quot;,
</a><a href="#h28-2-12" id="h28-2-12" class="d">-                alias: None,
</a><a href="#h28-2-13" id="h28-2-13" class="d">-                filter: None,
</a><a href="#h28-2-14" id="h28-2-14" class="d">-            },
</a><a href="#h28-2-15" id="h28-2-15" class="d">-            predicate: Some(
</a><a href="#h28-2-16" id="h28-2-16" class="d">-                And(
</a><a href="#h28-2-17" id="h28-2-17" class="d">-                    Or(
</a><a href="#h28-2-18" id="h28-2-18" class="d">-                        GreaterThan(
</a><a href="#h28-2-19" id="h28-2-19" class="d">-                            Field(
</a><a href="#h28-2-20" id="h28-2-20" class="d">-                                0,
</a><a href="#h28-2-21" id="h28-2-21" class="d">-                                Some(
</a><a href="#h28-2-22" id="h28-2-22" class="d">-                                    (
</a><a href="#h28-2-23" id="h28-2-23" class="d">-                                        Some(
</a><a href="#h28-2-24" id="h28-2-24" class="d">-                                            &quot;movies&quot;,
</a><a href="#h28-2-25" id="h28-2-25" class="i">+        source: Filter {
</a><a href="#h28-2-26" id="h28-2-26" class="i">+            source: NestedLoopJoin {
</a><a href="#h28-2-27" id="h28-2-27" class="i">+                outer: Scan {
</a><a href="#h28-2-28" id="h28-2-28" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h28-2-29" id="h28-2-29" class="i">+                    alias: None,
</a><a href="#h28-2-30" id="h28-2-30" class="i">+                    filter: Some(
</a><a href="#h28-2-31" id="h28-2-31" class="i">+                        Or(
</a><a href="#h28-2-32" id="h28-2-32" class="i">+                            GreaterThan(
</a><a href="#h28-2-33" id="h28-2-33" class="i">+                                Field(
</a><a href="#h28-2-34" id="h28-2-34" class="i">+                                    0,
</a><a href="#h28-2-35" id="h28-2-35" class="i">+                                    Some(
</a><a href="#h28-2-36" id="h28-2-36" class="i">+                                        (
</a><a href="#h28-2-37" id="h28-2-37" class="i">+                                            Some(
</a><a href="#h28-2-38" id="h28-2-38" class="i">+                                                &quot;movies&quot;,
</a><a href="#h28-2-39" id="h28-2-39" class="i">+                                            ),
</a><a href="#h28-2-40" id="h28-2-40" class="i">+                                            &quot;id&quot;,
</a>                                         ),
<a href="#h28-2-42" id="h28-2-42" class="d">-                                        &quot;id&quot;,
</a>                                     ),
                                 ),
<a href="#h28-2-45" id="h28-2-45" class="d">-                            ),
</a><a href="#h28-2-46" id="h28-2-46" class="d">-                            Constant(
</a><a href="#h28-2-47" id="h28-2-47" class="d">-                                Integer(
</a><a href="#h28-2-48" id="h28-2-48" class="d">-                                    3,
</a><a href="#h28-2-49" id="h28-2-49" class="i">+                                Constant(
</a><a href="#h28-2-50" id="h28-2-50" class="i">+                                    Integer(
</a><a href="#h28-2-51" id="h28-2-51" class="i">+                                        3,
</a><a href="#h28-2-52" id="h28-2-52" class="i">+                                    ),
</a>                                 ),
                             ),
<a href="#h28-2-55" id="h28-2-55" class="d">-                        ),
</a><a href="#h28-2-56" id="h28-2-56" class="d">-                        Equal(
</a><a href="#h28-2-57" id="h28-2-57" class="d">-                            Field(
</a><a href="#h28-2-58" id="h28-2-58" class="d">-                                0,
</a><a href="#h28-2-59" id="h28-2-59" class="d">-                                Some(
</a><a href="#h28-2-60" id="h28-2-60" class="d">-                                    (
</a><a href="#h28-2-61" id="h28-2-61" class="d">-                                        Some(
</a><a href="#h28-2-62" id="h28-2-62" class="d">-                                            &quot;movies&quot;,
</a><a href="#h28-2-63" id="h28-2-63" class="i">+                            Equal(
</a><a href="#h28-2-64" id="h28-2-64" class="i">+                                Field(
</a><a href="#h28-2-65" id="h28-2-65" class="i">+                                    0,
</a><a href="#h28-2-66" id="h28-2-66" class="i">+                                    Some(
</a><a href="#h28-2-67" id="h28-2-67" class="i">+                                        (
</a><a href="#h28-2-68" id="h28-2-68" class="i">+                                            Some(
</a><a href="#h28-2-69" id="h28-2-69" class="i">+                                                &quot;movies&quot;,
</a><a href="#h28-2-70" id="h28-2-70" class="i">+                                            ),
</a><a href="#h28-2-71" id="h28-2-71" class="i">+                                            &quot;id&quot;,
</a>                                         ),
<a href="#h28-2-73" id="h28-2-73" class="d">-                                        &quot;id&quot;,
</a>                                     ),
                                 ),
<a href="#h28-2-76" id="h28-2-76" class="d">-                            ),
</a><a href="#h28-2-77" id="h28-2-77" class="d">-                            Constant(
</a><a href="#h28-2-78" id="h28-2-78" class="d">-                                Integer(
</a><a href="#h28-2-79" id="h28-2-79" class="d">-                                    3,
</a><a href="#h28-2-80" id="h28-2-80" class="d">-                                ),
</a><a href="#h28-2-81" id="h28-2-81" class="d">-                            ),
</a><a href="#h28-2-82" id="h28-2-82" class="d">-                        ),
</a><a href="#h28-2-83" id="h28-2-83" class="d">-                    ),
</a><a href="#h28-2-84" id="h28-2-84" class="d">-                    Equal(
</a><a href="#h28-2-85" id="h28-2-85" class="d">-                        Field(
</a><a href="#h28-2-86" id="h28-2-86" class="d">-                            7,
</a><a href="#h28-2-87" id="h28-2-87" class="d">-                            Some(
</a><a href="#h28-2-88" id="h28-2-88" class="d">-                                (
</a><a href="#h28-2-89" id="h28-2-89" class="d">-                                    Some(
</a><a href="#h28-2-90" id="h28-2-90" class="d">-                                        &quot;genres&quot;,
</a><a href="#h28-2-91" id="h28-2-91" class="i">+                                Constant(
</a><a href="#h28-2-92" id="h28-2-92" class="i">+                                    Integer(
</a><a href="#h28-2-93" id="h28-2-93" class="i">+                                        3,
</a>                                     ),
<a href="#h28-2-95" id="h28-2-95" class="d">-                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h28-2-99" id="h28-2-99" class="d">-                        Constant(
</a><a href="#h28-2-100" id="h28-2-100" class="d">-                            Integer(
</a><a href="#h28-2-101" id="h28-2-101" class="d">-                                1,
</a><a href="#h28-2-102" id="h28-2-102" class="d">-                            ),
</a><a href="#h28-2-103" id="h28-2-103" class="d">-                        ),
</a>                     ),
<a href="#h28-2-105" id="h28-2-105" class="d">-                ),
</a><a href="#h28-2-106" id="h28-2-106" class="d">-            ),
</a><a href="#h28-2-107" id="h28-2-107" class="d">-            pad: false,
</a><a href="#h28-2-108" id="h28-2-108" class="d">-            flip: false,
</a><a href="#h28-2-109" id="h28-2-109" class="i">+                },
</a><a href="#h28-2-110" id="h28-2-110" class="i">+                outer_size: 7,
</a><a href="#h28-2-111" id="h28-2-111" class="i">+                inner: KeyLookup {
</a><a href="#h28-2-112" id="h28-2-112" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h28-2-113" id="h28-2-113" class="i">+                    alias: None,
</a><a href="#h28-2-114" id="h28-2-114" class="i">+                    keys: [
</a><a href="#h28-2-115" id="h28-2-115" class="i">+                        Integer(
</a><a href="#h28-2-116" id="h28-2-116" class="i">+                            1,
</a><a href="#h28-2-117" id="h28-2-117" class="i">+                        ),
</a><a href="#h28-2-118" id="h28-2-118" class="i">+                    ],
</a><a href="#h28-2-119" id="h28-2-119" class="i">+                },
</a><a href="#h28-2-120" id="h28-2-120" class="i">+                predicate: None,
</a><a href="#h28-2-121" id="h28-2-121" class="i">+                pad: false,
</a><a href="#h28-2-122" id="h28-2-122" class="i">+                flip: false,
</a><a href="#h28-2-123" id="h28-2-123" class="i">+            },
</a><a href="#h28-2-124" id="h28-2-124" class="i">+            predicate: None,
</a>         },
         expressions: [
             (
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a> b/<a href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -29,25 +29,30 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h29-0-3" id="h29-0-3" class="d">-        predicate: Constant(
</a><a href="#h29-0-4" id="h29-0-4" class="d">-            Float(
</a><a href="#h29-0-5" id="h29-0-5" class="d">-                3.14,
</a><a href="#h29-0-6" id="h29-0-6" class="i">+        predicate: Some(
</a><a href="#h29-0-7" id="h29-0-7" class="i">+            Constant(
</a><a href="#h29-0-8" id="h29-0-8" class="i">+                Float(
</a><a href="#h29-0-9" id="h29-0-9" class="i">+                    3.14,
</a><a href="#h29-0-10" id="h29-0-10" class="i">+                ),
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h29-0-17" id="h29-0-17" class="d">-    Scan {
</a><a href="#h29-0-18" id="h29-0-18" class="d">-        table: &quot;movies&quot;,
</a><a href="#h29-0-19" id="h29-0-19" class="d">-        alias: None,
</a><a href="#h29-0-20" id="h29-0-20" class="d">-        filter: Some(
</a><a href="#h29-0-21" id="h29-0-21" class="d">-            Constant(
</a><a href="#h29-0-22" id="h29-0-22" class="d">-                Float(
</a><a href="#h29-0-23" id="h29-0-23" class="d">-                    3.14,
</a><a href="#h29-0-24" id="h29-0-24" class="i">+    Filter {
</a><a href="#h29-0-25" id="h29-0-25" class="i">+        source: Scan {
</a><a href="#h29-0-26" id="h29-0-26" class="i">+            table: &quot;movies&quot;,
</a><a href="#h29-0-27" id="h29-0-27" class="i">+            alias: None,
</a><a href="#h29-0-28" id="h29-0-28" class="i">+            filter: Some(
</a><a href="#h29-0-29" id="h29-0-29" class="i">+                Constant(
</a><a href="#h29-0-30" id="h29-0-30" class="i">+                    Float(
</a><a href="#h29-0-31" id="h29-0-31" class="i">+                        3.14,
</a><a href="#h29-0-32" id="h29-0-32" class="i">+                    ),
</a>                 ),
             ),
<a href="#h29-0-35" id="h29-0-35" class="d">-        ),
</a><a href="#h29-0-36" id="h29-0-36" class="i">+        },
</a><a href="#h29-0-37" id="h29-0-37" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a> b/<a href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -46,19 +46,21 @@ Plan: Plan(
</a>                 alias: None,
                 filter: None,
             },
<a href="#h30-0-3" id="h30-0-3" class="d">-            predicate: Equal(
</a><a href="#h30-0-4" id="h30-0-4" class="d">-                Field(
</a><a href="#h30-0-5" id="h30-0-5" class="d">-                    3,
</a><a href="#h30-0-6" id="h30-0-6" class="d">-                    Some(
</a><a href="#h30-0-7" id="h30-0-7" class="d">-                        (
</a><a href="#h30-0-8" id="h30-0-8" class="d">-                            None,
</a><a href="#h30-0-9" id="h30-0-9" class="d">-                            &quot;genre_id&quot;,
</a><a href="#h30-0-10" id="h30-0-10" class="i">+            predicate: Some(
</a><a href="#h30-0-11" id="h30-0-11" class="i">+                Equal(
</a><a href="#h30-0-12" id="h30-0-12" class="i">+                    Field(
</a><a href="#h30-0-13" id="h30-0-13" class="i">+                        3,
</a><a href="#h30-0-14" id="h30-0-14" class="i">+                        Some(
</a><a href="#h30-0-15" id="h30-0-15" class="i">+                            (
</a><a href="#h30-0-16" id="h30-0-16" class="i">+                                None,
</a><a href="#h30-0-17" id="h30-0-17" class="i">+                                &quot;genre_id&quot;,
</a><a href="#h30-0-18" id="h30-0-18" class="i">+                            ),
</a>                         ),
                     ),
<a href="#h30-0-21" id="h30-0-21" class="d">-                ),
</a><a href="#h30-0-22" id="h30-0-22" class="d">-                Constant(
</a><a href="#h30-0-23" id="h30-0-23" class="d">-                    Integer(
</a><a href="#h30-0-24" id="h30-0-24" class="d">-                        2,
</a><a href="#h30-0-25" id="h30-0-25" class="i">+                    Constant(
</a><a href="#h30-0-26" id="h30-0-26" class="i">+                        Integer(
</a><a href="#h30-0-27" id="h30-0-27" class="i">+                            2,
</a><a href="#h30-0-28" id="h30-0-28" class="i">+                        ),
</a>                     ),
                 ),
             ),
<a href="#h30-1" id="h30-1" class="h">@@ -82,15 +84,18 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Order {
<a href="#h30-1-3" id="h30-1-3" class="d">-        source: IndexLookup {
</a><a href="#h30-1-4" id="h30-1-4" class="d">-            table: &quot;movies&quot;,
</a><a href="#h30-1-5" id="h30-1-5" class="d">-            alias: None,
</a><a href="#h30-1-6" id="h30-1-6" class="d">-            column: &quot;genre_id&quot;,
</a><a href="#h30-1-7" id="h30-1-7" class="d">-            values: [
</a><a href="#h30-1-8" id="h30-1-8" class="d">-                Integer(
</a><a href="#h30-1-9" id="h30-1-9" class="d">-                    2,
</a><a href="#h30-1-10" id="h30-1-10" class="d">-                ),
</a><a href="#h30-1-11" id="h30-1-11" class="d">-            ],
</a><a href="#h30-1-12" id="h30-1-12" class="i">+        source: Filter {
</a><a href="#h30-1-13" id="h30-1-13" class="i">+            source: IndexLookup {
</a><a href="#h30-1-14" id="h30-1-14" class="i">+                table: &quot;movies&quot;,
</a><a href="#h30-1-15" id="h30-1-15" class="i">+                alias: None,
</a><a href="#h30-1-16" id="h30-1-16" class="i">+                column: &quot;genre_id&quot;,
</a><a href="#h30-1-17" id="h30-1-17" class="i">+                values: [
</a><a href="#h30-1-18" id="h30-1-18" class="i">+                    Integer(
</a><a href="#h30-1-19" id="h30-1-19" class="i">+                        2,
</a><a href="#h30-1-20" id="h30-1-20" class="i">+                    ),
</a><a href="#h30-1-21" id="h30-1-21" class="i">+                ],
</a><a href="#h30-1-22" id="h30-1-22" class="i">+            },
</a><a href="#h30-1-23" id="h30-1-23" class="i">+            predicate: None,
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h31" href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a> b/<a href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -97,22 +97,40 @@ Plan: Plan(
</a>                 alias: None,
                 filter: None,
             },
<a href="#h31-0-3" id="h31-0-3" class="d">-            predicate: Or(
</a><a href="#h31-0-4" id="h31-0-4" class="i">+            predicate: Some(
</a>                 Or(
                     Or(
<a href="#h31-0-7" id="h31-0-7" class="d">-                        Equal(
</a><a href="#h31-0-8" id="h31-0-8" class="d">-                            Field(
</a><a href="#h31-0-9" id="h31-0-9" class="d">-                                3,
</a><a href="#h31-0-10" id="h31-0-10" class="d">-                                Some(
</a><a href="#h31-0-11" id="h31-0-11" class="d">-                                    (
</a><a href="#h31-0-12" id="h31-0-12" class="d">-                                        None,
</a><a href="#h31-0-13" id="h31-0-13" class="d">-                                        &quot;genre_id&quot;,
</a><a href="#h31-0-14" id="h31-0-14" class="i">+                        Or(
</a><a href="#h31-0-15" id="h31-0-15" class="i">+                            Equal(
</a><a href="#h31-0-16" id="h31-0-16" class="i">+                                Field(
</a><a href="#h31-0-17" id="h31-0-17" class="i">+                                    3,
</a><a href="#h31-0-18" id="h31-0-18" class="i">+                                    Some(
</a><a href="#h31-0-19" id="h31-0-19" class="i">+                                        (
</a><a href="#h31-0-20" id="h31-0-20" class="i">+                                            None,
</a><a href="#h31-0-21" id="h31-0-21" class="i">+                                            &quot;genre_id&quot;,
</a><a href="#h31-0-22" id="h31-0-22" class="i">+                                        ),
</a><a href="#h31-0-23" id="h31-0-23" class="i">+                                    ),
</a><a href="#h31-0-24" id="h31-0-24" class="i">+                                ),
</a><a href="#h31-0-25" id="h31-0-25" class="i">+                                Constant(
</a><a href="#h31-0-26" id="h31-0-26" class="i">+                                    Integer(
</a><a href="#h31-0-27" id="h31-0-27" class="i">+                                        2,
</a>                                     ),
                                 ),
                             ),
<a href="#h31-0-31" id="h31-0-31" class="d">-                            Constant(
</a><a href="#h31-0-32" id="h31-0-32" class="d">-                                Integer(
</a><a href="#h31-0-33" id="h31-0-33" class="d">-                                    2,
</a><a href="#h31-0-34" id="h31-0-34" class="i">+                            Equal(
</a><a href="#h31-0-35" id="h31-0-35" class="i">+                                Field(
</a><a href="#h31-0-36" id="h31-0-36" class="i">+                                    3,
</a><a href="#h31-0-37" id="h31-0-37" class="i">+                                    Some(
</a><a href="#h31-0-38" id="h31-0-38" class="i">+                                        (
</a><a href="#h31-0-39" id="h31-0-39" class="i">+                                            None,
</a><a href="#h31-0-40" id="h31-0-40" class="i">+                                            &quot;genre_id&quot;,
</a><a href="#h31-0-41" id="h31-0-41" class="i">+                                        ),
</a><a href="#h31-0-42" id="h31-0-42" class="i">+                                    ),
</a><a href="#h31-0-43" id="h31-0-43" class="i">+                                ),
</a><a href="#h31-0-44" id="h31-0-44" class="i">+                                Constant(
</a><a href="#h31-0-45" id="h31-0-45" class="i">+                                    Integer(
</a><a href="#h31-0-46" id="h31-0-46" class="i">+                                        3,
</a><a href="#h31-0-47" id="h31-0-47" class="i">+                                    ),
</a>                                 ),
                             ),
                         ),
<a href="#h31-1" id="h31-1" class="h">@@ -128,7 +146,7 @@ Plan: Plan(
</a>                             ),
                             Constant(
                                 Integer(
<a href="#h31-1-3" id="h31-1-3" class="d">-                                    3,
</a><a href="#h31-1-4" id="h31-1-4" class="i">+                                    4,
</a>                                 ),
                             ),
                         ),
<a href="#h31-2" id="h31-2" class="h">@@ -145,26 +163,10 @@ Plan: Plan(
</a>                         ),
                         Constant(
                             Integer(
<a href="#h31-2-3" id="h31-2-3" class="d">-                                4,
</a><a href="#h31-2-4" id="h31-2-4" class="d">-                            ),
</a><a href="#h31-2-5" id="h31-2-5" class="d">-                        ),
</a><a href="#h31-2-6" id="h31-2-6" class="d">-                    ),
</a><a href="#h31-2-7" id="h31-2-7" class="d">-                ),
</a><a href="#h31-2-8" id="h31-2-8" class="d">-                Equal(
</a><a href="#h31-2-9" id="h31-2-9" class="d">-                    Field(
</a><a href="#h31-2-10" id="h31-2-10" class="d">-                        3,
</a><a href="#h31-2-11" id="h31-2-11" class="d">-                        Some(
</a><a href="#h31-2-12" id="h31-2-12" class="d">-                            (
</a><a href="#h31-2-13" id="h31-2-13" class="d">-                                None,
</a><a href="#h31-2-14" id="h31-2-14" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h31-2-15" id="h31-2-15" class="i">+                                5,
</a>                             ),
                         ),
                     ),
<a href="#h31-2-19" id="h31-2-19" class="d">-                    Constant(
</a><a href="#h31-2-20" id="h31-2-20" class="d">-                        Integer(
</a><a href="#h31-2-21" id="h31-2-21" class="d">-                            5,
</a><a href="#h31-2-22" id="h31-2-22" class="d">-                        ),
</a><a href="#h31-2-23" id="h31-2-23" class="d">-                    ),
</a>                 ),
             ),
         },
<a href="#h31-3" id="h31-3" class="h">@@ -187,24 +189,27 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Order {
<a href="#h31-3-3" id="h31-3-3" class="d">-        source: IndexLookup {
</a><a href="#h31-3-4" id="h31-3-4" class="d">-            table: &quot;movies&quot;,
</a><a href="#h31-3-5" id="h31-3-5" class="d">-            alias: None,
</a><a href="#h31-3-6" id="h31-3-6" class="d">-            column: &quot;genre_id&quot;,
</a><a href="#h31-3-7" id="h31-3-7" class="d">-            values: [
</a><a href="#h31-3-8" id="h31-3-8" class="d">-                Integer(
</a><a href="#h31-3-9" id="h31-3-9" class="d">-                    2,
</a><a href="#h31-3-10" id="h31-3-10" class="d">-                ),
</a><a href="#h31-3-11" id="h31-3-11" class="d">-                Integer(
</a><a href="#h31-3-12" id="h31-3-12" class="d">-                    3,
</a><a href="#h31-3-13" id="h31-3-13" class="d">-                ),
</a><a href="#h31-3-14" id="h31-3-14" class="d">-                Integer(
</a><a href="#h31-3-15" id="h31-3-15" class="d">-                    4,
</a><a href="#h31-3-16" id="h31-3-16" class="d">-                ),
</a><a href="#h31-3-17" id="h31-3-17" class="d">-                Integer(
</a><a href="#h31-3-18" id="h31-3-18" class="d">-                    5,
</a><a href="#h31-3-19" id="h31-3-19" class="d">-                ),
</a><a href="#h31-3-20" id="h31-3-20" class="d">-            ],
</a><a href="#h31-3-21" id="h31-3-21" class="i">+        source: Filter {
</a><a href="#h31-3-22" id="h31-3-22" class="i">+            source: IndexLookup {
</a><a href="#h31-3-23" id="h31-3-23" class="i">+                table: &quot;movies&quot;,
</a><a href="#h31-3-24" id="h31-3-24" class="i">+                alias: None,
</a><a href="#h31-3-25" id="h31-3-25" class="i">+                column: &quot;genre_id&quot;,
</a><a href="#h31-3-26" id="h31-3-26" class="i">+                values: [
</a><a href="#h31-3-27" id="h31-3-27" class="i">+                    Integer(
</a><a href="#h31-3-28" id="h31-3-28" class="i">+                        2,
</a><a href="#h31-3-29" id="h31-3-29" class="i">+                    ),
</a><a href="#h31-3-30" id="h31-3-30" class="i">+                    Integer(
</a><a href="#h31-3-31" id="h31-3-31" class="i">+                        3,
</a><a href="#h31-3-32" id="h31-3-32" class="i">+                    ),
</a><a href="#h31-3-33" id="h31-3-33" class="i">+                    Integer(
</a><a href="#h31-3-34" id="h31-3-34" class="i">+                        4,
</a><a href="#h31-3-35" id="h31-3-35" class="i">+                    ),
</a><a href="#h31-3-36" id="h31-3-36" class="i">+                    Integer(
</a><a href="#h31-3-37" id="h31-3-37" class="i">+                        5,
</a><a href="#h31-3-38" id="h31-3-38" class="i">+                    ),
</a><a href="#h31-3-39" id="h31-3-39" class="i">+                ],
</a><a href="#h31-3-40" id="h31-3-40" class="i">+            },
</a><a href="#h31-3-41" id="h31-3-41" class="i">+            predicate: None,
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a> b/<a href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -80,56 +80,58 @@ Plan: Plan(
</a>                 alias: None,
                 filter: None,
             },
<a href="#h32-0-3" id="h32-0-3" class="d">-            predicate: And(
</a><a href="#h32-0-4" id="h32-0-4" class="d">-                Or(
</a><a href="#h32-0-5" id="h32-0-5" class="d">-                    Equal(
</a><a href="#h32-0-6" id="h32-0-6" class="d">-                        Field(
</a><a href="#h32-0-7" id="h32-0-7" class="d">-                            3,
</a><a href="#h32-0-8" id="h32-0-8" class="d">-                            Some(
</a><a href="#h32-0-9" id="h32-0-9" class="d">-                                (
</a><a href="#h32-0-10" id="h32-0-10" class="d">-                                    None,
</a><a href="#h32-0-11" id="h32-0-11" class="d">-                                    &quot;genre_id&quot;,
</a><a href="#h32-0-12" id="h32-0-12" class="i">+            predicate: Some(
</a><a href="#h32-0-13" id="h32-0-13" class="i">+                And(
</a><a href="#h32-0-14" id="h32-0-14" class="i">+                    Or(
</a><a href="#h32-0-15" id="h32-0-15" class="i">+                        Equal(
</a><a href="#h32-0-16" id="h32-0-16" class="i">+                            Field(
</a><a href="#h32-0-17" id="h32-0-17" class="i">+                                3,
</a><a href="#h32-0-18" id="h32-0-18" class="i">+                                Some(
</a><a href="#h32-0-19" id="h32-0-19" class="i">+                                    (
</a><a href="#h32-0-20" id="h32-0-20" class="i">+                                        None,
</a><a href="#h32-0-21" id="h32-0-21" class="i">+                                        &quot;genre_id&quot;,
</a><a href="#h32-0-22" id="h32-0-22" class="i">+                                    ),
</a><a href="#h32-0-23" id="h32-0-23" class="i">+                                ),
</a><a href="#h32-0-24" id="h32-0-24" class="i">+                            ),
</a><a href="#h32-0-25" id="h32-0-25" class="i">+                            Constant(
</a><a href="#h32-0-26" id="h32-0-26" class="i">+                                Integer(
</a><a href="#h32-0-27" id="h32-0-27" class="i">+                                    2,
</a>                                 ),
                             ),
                         ),
<a href="#h32-0-31" id="h32-0-31" class="d">-                        Constant(
</a><a href="#h32-0-32" id="h32-0-32" class="d">-                            Integer(
</a><a href="#h32-0-33" id="h32-0-33" class="d">-                                2,
</a><a href="#h32-0-34" id="h32-0-34" class="i">+                        Equal(
</a><a href="#h32-0-35" id="h32-0-35" class="i">+                            Field(
</a><a href="#h32-0-36" id="h32-0-36" class="i">+                                3,
</a><a href="#h32-0-37" id="h32-0-37" class="i">+                                Some(
</a><a href="#h32-0-38" id="h32-0-38" class="i">+                                    (
</a><a href="#h32-0-39" id="h32-0-39" class="i">+                                        None,
</a><a href="#h32-0-40" id="h32-0-40" class="i">+                                        &quot;genre_id&quot;,
</a><a href="#h32-0-41" id="h32-0-41" class="i">+                                    ),
</a><a href="#h32-0-42" id="h32-0-42" class="i">+                                ),
</a><a href="#h32-0-43" id="h32-0-43" class="i">+                            ),
</a><a href="#h32-0-44" id="h32-0-44" class="i">+                            Constant(
</a><a href="#h32-0-45" id="h32-0-45" class="i">+                                Integer(
</a><a href="#h32-0-46" id="h32-0-46" class="i">+                                    3,
</a><a href="#h32-0-47" id="h32-0-47" class="i">+                                ),
</a>                             ),
                         ),
                     ),
                     Equal(
                         Field(
<a href="#h32-0-53" id="h32-0-53" class="d">-                            3,
</a><a href="#h32-0-54" id="h32-0-54" class="i">+                            2,
</a>                             Some(
                                 (
                                     None,
<a href="#h32-0-58" id="h32-0-58" class="d">-                                    &quot;genre_id&quot;,
</a><a href="#h32-0-59" id="h32-0-59" class="i">+                                    &quot;studio_id&quot;,
</a>                                 ),
                             ),
                         ),
                         Constant(
                             Integer(
<a href="#h32-0-65" id="h32-0-65" class="d">-                                3,
</a><a href="#h32-0-66" id="h32-0-66" class="d">-                            ),
</a><a href="#h32-0-67" id="h32-0-67" class="d">-                        ),
</a><a href="#h32-0-68" id="h32-0-68" class="d">-                    ),
</a><a href="#h32-0-69" id="h32-0-69" class="d">-                ),
</a><a href="#h32-0-70" id="h32-0-70" class="d">-                Equal(
</a><a href="#h32-0-71" id="h32-0-71" class="d">-                    Field(
</a><a href="#h32-0-72" id="h32-0-72" class="d">-                        2,
</a><a href="#h32-0-73" id="h32-0-73" class="d">-                        Some(
</a><a href="#h32-0-74" id="h32-0-74" class="d">-                            (
</a><a href="#h32-0-75" id="h32-0-75" class="d">-                                None,
</a><a href="#h32-0-76" id="h32-0-76" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h32-0-77" id="h32-0-77" class="i">+                                2,
</a>                             ),
                         ),
                     ),
<a href="#h32-0-81" id="h32-0-81" class="d">-                    Constant(
</a><a href="#h32-0-82" id="h32-0-82" class="d">-                        Integer(
</a><a href="#h32-0-83" id="h32-0-83" class="d">-                            2,
</a><a href="#h32-0-84" id="h32-0-84" class="d">-                        ),
</a><a href="#h32-0-85" id="h32-0-85" class="d">-                    ),
</a>                 ),
             ),
         },
<a href="#h32-1" id="h32-1" class="h">@@ -153,35 +155,40 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Order {
         source: Filter {
<a href="#h32-1-3" id="h32-1-3" class="d">-            source: IndexLookup {
</a><a href="#h32-1-4" id="h32-1-4" class="d">-                table: &quot;movies&quot;,
</a><a href="#h32-1-5" id="h32-1-5" class="d">-                alias: None,
</a><a href="#h32-1-6" id="h32-1-6" class="d">-                column: &quot;genre_id&quot;,
</a><a href="#h32-1-7" id="h32-1-7" class="d">-                values: [
</a><a href="#h32-1-8" id="h32-1-8" class="d">-                    Integer(
</a><a href="#h32-1-9" id="h32-1-9" class="d">-                        2,
</a><a href="#h32-1-10" id="h32-1-10" class="d">-                    ),
</a><a href="#h32-1-11" id="h32-1-11" class="d">-                    Integer(
</a><a href="#h32-1-12" id="h32-1-12" class="d">-                        3,
</a><a href="#h32-1-13" id="h32-1-13" class="d">-                    ),
</a><a href="#h32-1-14" id="h32-1-14" class="d">-                ],
</a><a href="#h32-1-15" id="h32-1-15" class="d">-            },
</a><a href="#h32-1-16" id="h32-1-16" class="d">-            predicate: Equal(
</a><a href="#h32-1-17" id="h32-1-17" class="d">-                Field(
</a><a href="#h32-1-18" id="h32-1-18" class="d">-                    2,
</a><a href="#h32-1-19" id="h32-1-19" class="d">-                    Some(
</a><a href="#h32-1-20" id="h32-1-20" class="d">-                        (
</a><a href="#h32-1-21" id="h32-1-21" class="d">-                            None,
</a><a href="#h32-1-22" id="h32-1-22" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h32-1-23" id="h32-1-23" class="i">+            source: Filter {
</a><a href="#h32-1-24" id="h32-1-24" class="i">+                source: IndexLookup {
</a><a href="#h32-1-25" id="h32-1-25" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h32-1-26" id="h32-1-26" class="i">+                    alias: None,
</a><a href="#h32-1-27" id="h32-1-27" class="i">+                    column: &quot;genre_id&quot;,
</a><a href="#h32-1-28" id="h32-1-28" class="i">+                    values: [
</a><a href="#h32-1-29" id="h32-1-29" class="i">+                        Integer(
</a><a href="#h32-1-30" id="h32-1-30" class="i">+                            2,
</a><a href="#h32-1-31" id="h32-1-31" class="i">+                        ),
</a><a href="#h32-1-32" id="h32-1-32" class="i">+                        Integer(
</a><a href="#h32-1-33" id="h32-1-33" class="i">+                            3,
</a><a href="#h32-1-34" id="h32-1-34" class="i">+                        ),
</a><a href="#h32-1-35" id="h32-1-35" class="i">+                    ],
</a><a href="#h32-1-36" id="h32-1-36" class="i">+                },
</a><a href="#h32-1-37" id="h32-1-37" class="i">+                predicate: Some(
</a><a href="#h32-1-38" id="h32-1-38" class="i">+                    Equal(
</a><a href="#h32-1-39" id="h32-1-39" class="i">+                        Field(
</a><a href="#h32-1-40" id="h32-1-40" class="i">+                            2,
</a><a href="#h32-1-41" id="h32-1-41" class="i">+                            Some(
</a><a href="#h32-1-42" id="h32-1-42" class="i">+                                (
</a><a href="#h32-1-43" id="h32-1-43" class="i">+                                    None,
</a><a href="#h32-1-44" id="h32-1-44" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h32-1-45" id="h32-1-45" class="i">+                                ),
</a><a href="#h32-1-46" id="h32-1-46" class="i">+                            ),
</a><a href="#h32-1-47" id="h32-1-47" class="i">+                        ),
</a><a href="#h32-1-48" id="h32-1-48" class="i">+                        Constant(
</a><a href="#h32-1-49" id="h32-1-49" class="i">+                            Integer(
</a><a href="#h32-1-50" id="h32-1-50" class="i">+                                2,
</a><a href="#h32-1-51" id="h32-1-51" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<a href="#h32-1-55" id="h32-1-55" class="d">-                Constant(
</a><a href="#h32-1-56" id="h32-1-56" class="d">-                    Integer(
</a><a href="#h32-1-57" id="h32-1-57" class="d">-                        2,
</a><a href="#h32-1-58" id="h32-1-58" class="d">-                    ),
</a><a href="#h32-1-59" id="h32-1-59" class="d">-                ),
</a><a href="#h32-1-60" id="h32-1-60" class="d">-            ),
</a><a href="#h32-1-61" id="h32-1-61" class="i">+            },
</a><a href="#h32-1-62" id="h32-1-62" class="i">+            predicate: None,
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a> b/<a href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -29,25 +29,30 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h33-0-3" id="h33-0-3" class="d">-        predicate: Constant(
</a><a href="#h33-0-4" id="h33-0-4" class="d">-            Integer(
</a><a href="#h33-0-5" id="h33-0-5" class="d">-                7,
</a><a href="#h33-0-6" id="h33-0-6" class="i">+        predicate: Some(
</a><a href="#h33-0-7" id="h33-0-7" class="i">+            Constant(
</a><a href="#h33-0-8" id="h33-0-8" class="i">+                Integer(
</a><a href="#h33-0-9" id="h33-0-9" class="i">+                    7,
</a><a href="#h33-0-10" id="h33-0-10" class="i">+                ),
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h33-0-17" id="h33-0-17" class="d">-    Scan {
</a><a href="#h33-0-18" id="h33-0-18" class="d">-        table: &quot;movies&quot;,
</a><a href="#h33-0-19" id="h33-0-19" class="d">-        alias: None,
</a><a href="#h33-0-20" id="h33-0-20" class="d">-        filter: Some(
</a><a href="#h33-0-21" id="h33-0-21" class="d">-            Constant(
</a><a href="#h33-0-22" id="h33-0-22" class="d">-                Integer(
</a><a href="#h33-0-23" id="h33-0-23" class="d">-                    7,
</a><a href="#h33-0-24" id="h33-0-24" class="i">+    Filter {
</a><a href="#h33-0-25" id="h33-0-25" class="i">+        source: Scan {
</a><a href="#h33-0-26" id="h33-0-26" class="i">+            table: &quot;movies&quot;,
</a><a href="#h33-0-27" id="h33-0-27" class="i">+            alias: None,
</a><a href="#h33-0-28" id="h33-0-28" class="i">+            filter: Some(
</a><a href="#h33-0-29" id="h33-0-29" class="i">+                Constant(
</a><a href="#h33-0-30" id="h33-0-30" class="i">+                    Integer(
</a><a href="#h33-0-31" id="h33-0-31" class="i">+                        7,
</a><a href="#h33-0-32" id="h33-0-32" class="i">+                    ),
</a>                 ),
             ),
<a href="#h33-0-35" id="h33-0-35" class="d">-        ),
</a><a href="#h33-0-36" id="h33-0-36" class="i">+        },
</a><a href="#h33-0-37" id="h33-0-37" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h34" href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a> b/<a href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -55,46 +55,6 @@ Plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h34-0-3" id="h34-0-3" class="d">-        predicate: Equal(
</a><a href="#h34-0-4" id="h34-0-4" class="d">-            Field(
</a><a href="#h34-0-5" id="h34-0-5" class="d">-                3,
</a><a href="#h34-0-6" id="h34-0-6" class="d">-                Some(
</a><a href="#h34-0-7" id="h34-0-7" class="d">-                    (
</a><a href="#h34-0-8" id="h34-0-8" class="d">-                        Some(
</a><a href="#h34-0-9" id="h34-0-9" class="d">-                            &quot;movies&quot;,
</a><a href="#h34-0-10" id="h34-0-10" class="d">-                        ),
</a><a href="#h34-0-11" id="h34-0-11" class="d">-                        &quot;genre_id&quot;,
</a><a href="#h34-0-12" id="h34-0-12" class="d">-                    ),
</a><a href="#h34-0-13" id="h34-0-13" class="d">-                ),
</a><a href="#h34-0-14" id="h34-0-14" class="d">-            ),
</a><a href="#h34-0-15" id="h34-0-15" class="d">-            Field(
</a><a href="#h34-0-16" id="h34-0-16" class="d">-                7,
</a><a href="#h34-0-17" id="h34-0-17" class="d">-                Some(
</a><a href="#h34-0-18" id="h34-0-18" class="d">-                    (
</a><a href="#h34-0-19" id="h34-0-19" class="d">-                        Some(
</a><a href="#h34-0-20" id="h34-0-20" class="d">-                            &quot;genres&quot;,
</a><a href="#h34-0-21" id="h34-0-21" class="d">-                        ),
</a><a href="#h34-0-22" id="h34-0-22" class="d">-                        &quot;id&quot;,
</a><a href="#h34-0-23" id="h34-0-23" class="d">-                    ),
</a><a href="#h34-0-24" id="h34-0-24" class="d">-                ),
</a><a href="#h34-0-25" id="h34-0-25" class="d">-            ),
</a><a href="#h34-0-26" id="h34-0-26" class="d">-        ),
</a><a href="#h34-0-27" id="h34-0-27" class="d">-    },
</a><a href="#h34-0-28" id="h34-0-28" class="d">-)
</a><a href="#h34-0-29" id="h34-0-29" class="d">-
</a><a href="#h34-0-30" id="h34-0-30" class="d">-Optimized plan: Plan(
</a><a href="#h34-0-31" id="h34-0-31" class="d">-    NestedLoopJoin {
</a><a href="#h34-0-32" id="h34-0-32" class="d">-        outer: Scan {
</a><a href="#h34-0-33" id="h34-0-33" class="d">-            table: &quot;movies&quot;,
</a><a href="#h34-0-34" id="h34-0-34" class="d">-            alias: None,
</a><a href="#h34-0-35" id="h34-0-35" class="d">-            filter: None,
</a><a href="#h34-0-36" id="h34-0-36" class="d">-        },
</a><a href="#h34-0-37" id="h34-0-37" class="d">-        outer_size: 7,
</a><a href="#h34-0-38" id="h34-0-38" class="d">-        inner: Scan {
</a><a href="#h34-0-39" id="h34-0-39" class="d">-            table: &quot;genres&quot;,
</a><a href="#h34-0-40" id="h34-0-40" class="d">-            alias: None,
</a><a href="#h34-0-41" id="h34-0-41" class="d">-            filter: None,
</a><a href="#h34-0-42" id="h34-0-42" class="d">-        },
</a>         predicate: Some(
             Equal(
                 Field(
<a href="#h34-1" id="h34-1" class="h">@@ -121,8 +81,53 @@ Optimized plan: Plan(
</a>                 ),
             ),
         ),
<a href="#h34-1-3" id="h34-1-3" class="d">-        pad: false,
</a><a href="#h34-1-4" id="h34-1-4" class="d">-        flip: false,
</a><a href="#h34-1-5" id="h34-1-5" class="i">+    },
</a><a href="#h34-1-6" id="h34-1-6" class="i">+)
</a><a href="#h34-1-7" id="h34-1-7" class="i">+
</a><a href="#h34-1-8" id="h34-1-8" class="i">+Optimized plan: Plan(
</a><a href="#h34-1-9" id="h34-1-9" class="i">+    Filter {
</a><a href="#h34-1-10" id="h34-1-10" class="i">+        source: NestedLoopJoin {
</a><a href="#h34-1-11" id="h34-1-11" class="i">+            outer: Scan {
</a><a href="#h34-1-12" id="h34-1-12" class="i">+                table: &quot;movies&quot;,
</a><a href="#h34-1-13" id="h34-1-13" class="i">+                alias: None,
</a><a href="#h34-1-14" id="h34-1-14" class="i">+                filter: None,
</a><a href="#h34-1-15" id="h34-1-15" class="i">+            },
</a><a href="#h34-1-16" id="h34-1-16" class="i">+            outer_size: 7,
</a><a href="#h34-1-17" id="h34-1-17" class="i">+            inner: Scan {
</a><a href="#h34-1-18" id="h34-1-18" class="i">+                table: &quot;genres&quot;,
</a><a href="#h34-1-19" id="h34-1-19" class="i">+                alias: None,
</a><a href="#h34-1-20" id="h34-1-20" class="i">+                filter: None,
</a><a href="#h34-1-21" id="h34-1-21" class="i">+            },
</a><a href="#h34-1-22" id="h34-1-22" class="i">+            predicate: Some(
</a><a href="#h34-1-23" id="h34-1-23" class="i">+                Equal(
</a><a href="#h34-1-24" id="h34-1-24" class="i">+                    Field(
</a><a href="#h34-1-25" id="h34-1-25" class="i">+                        3,
</a><a href="#h34-1-26" id="h34-1-26" class="i">+                        Some(
</a><a href="#h34-1-27" id="h34-1-27" class="i">+                            (
</a><a href="#h34-1-28" id="h34-1-28" class="i">+                                Some(
</a><a href="#h34-1-29" id="h34-1-29" class="i">+                                    &quot;movies&quot;,
</a><a href="#h34-1-30" id="h34-1-30" class="i">+                                ),
</a><a href="#h34-1-31" id="h34-1-31" class="i">+                                &quot;genre_id&quot;,
</a><a href="#h34-1-32" id="h34-1-32" class="i">+                            ),
</a><a href="#h34-1-33" id="h34-1-33" class="i">+                        ),
</a><a href="#h34-1-34" id="h34-1-34" class="i">+                    ),
</a><a href="#h34-1-35" id="h34-1-35" class="i">+                    Field(
</a><a href="#h34-1-36" id="h34-1-36" class="i">+                        7,
</a><a href="#h34-1-37" id="h34-1-37" class="i">+                        Some(
</a><a href="#h34-1-38" id="h34-1-38" class="i">+                            (
</a><a href="#h34-1-39" id="h34-1-39" class="i">+                                Some(
</a><a href="#h34-1-40" id="h34-1-40" class="i">+                                    &quot;genres&quot;,
</a><a href="#h34-1-41" id="h34-1-41" class="i">+                                ),
</a><a href="#h34-1-42" id="h34-1-42" class="i">+                                &quot;id&quot;,
</a><a href="#h34-1-43" id="h34-1-43" class="i">+                            ),
</a><a href="#h34-1-44" id="h34-1-44" class="i">+                        ),
</a><a href="#h34-1-45" id="h34-1-45" class="i">+                    ),
</a><a href="#h34-1-46" id="h34-1-46" class="i">+                ),
</a><a href="#h34-1-47" id="h34-1-47" class="i">+            ),
</a><a href="#h34-1-48" id="h34-1-48" class="i">+            pad: false,
</a><a href="#h34-1-49" id="h34-1-49" class="i">+            flip: false,
</a><a href="#h34-1-50" id="h34-1-50" class="i">+        },
</a><a href="#h34-1-51" id="h34-1-51" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h35" href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a> b/<a href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -27,21 +27,26 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h35-0-3" id="h35-0-3" class="d">-        predicate: Constant(
</a><a href="#h35-0-4" id="h35-0-4" class="d">-            Null,
</a><a href="#h35-0-5" id="h35-0-5" class="i">+        predicate: Some(
</a><a href="#h35-0-6" id="h35-0-6" class="i">+            Constant(
</a><a href="#h35-0-7" id="h35-0-7" class="i">+                Null,
</a><a href="#h35-0-8" id="h35-0-8" class="i">+            ),
</a>         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h35-0-14" id="h35-0-14" class="d">-    Scan {
</a><a href="#h35-0-15" id="h35-0-15" class="d">-        table: &quot;movies&quot;,
</a><a href="#h35-0-16" id="h35-0-16" class="d">-        alias: None,
</a><a href="#h35-0-17" id="h35-0-17" class="d">-        filter: Some(
</a><a href="#h35-0-18" id="h35-0-18" class="d">-            Constant(
</a><a href="#h35-0-19" id="h35-0-19" class="d">-                Null,
</a><a href="#h35-0-20" id="h35-0-20" class="i">+    Filter {
</a><a href="#h35-0-21" id="h35-0-21" class="i">+        source: Scan {
</a><a href="#h35-0-22" id="h35-0-22" class="i">+            table: &quot;movies&quot;,
</a><a href="#h35-0-23" id="h35-0-23" class="i">+            alias: None,
</a><a href="#h35-0-24" id="h35-0-24" class="i">+            filter: Some(
</a><a href="#h35-0-25" id="h35-0-25" class="i">+                Constant(
</a><a href="#h35-0-26" id="h35-0-26" class="i">+                    Null,
</a><a href="#h35-0-27" id="h35-0-27" class="i">+                ),
</a>             ),
<a href="#h35-0-29" id="h35-0-29" class="d">-        ),
</a><a href="#h35-0-30" id="h35-0-30" class="i">+        },
</a><a href="#h35-0-31" id="h35-0-31" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h36" href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a> b/<a href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -37,19 +37,21 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h36-0-3" id="h36-0-3" class="d">-        predicate: Equal(
</a><a href="#h36-0-4" id="h36-0-4" class="d">-            Field(
</a><a href="#h36-0-5" id="h36-0-5" class="d">-                0,
</a><a href="#h36-0-6" id="h36-0-6" class="d">-                Some(
</a><a href="#h36-0-7" id="h36-0-7" class="d">-                    (
</a><a href="#h36-0-8" id="h36-0-8" class="d">-                        None,
</a><a href="#h36-0-9" id="h36-0-9" class="d">-                        &quot;id&quot;,
</a><a href="#h36-0-10" id="h36-0-10" class="i">+        predicate: Some(
</a><a href="#h36-0-11" id="h36-0-11" class="i">+            Equal(
</a><a href="#h36-0-12" id="h36-0-12" class="i">+                Field(
</a><a href="#h36-0-13" id="h36-0-13" class="i">+                    0,
</a><a href="#h36-0-14" id="h36-0-14" class="i">+                    Some(
</a><a href="#h36-0-15" id="h36-0-15" class="i">+                        (
</a><a href="#h36-0-16" id="h36-0-16" class="i">+                            None,
</a><a href="#h36-0-17" id="h36-0-17" class="i">+                            &quot;id&quot;,
</a><a href="#h36-0-18" id="h36-0-18" class="i">+                        ),
</a>                     ),
                 ),
<a href="#h36-0-21" id="h36-0-21" class="d">-            ),
</a><a href="#h36-0-22" id="h36-0-22" class="d">-            Constant(
</a><a href="#h36-0-23" id="h36-0-23" class="d">-                Integer(
</a><a href="#h36-0-24" id="h36-0-24" class="d">-                    3,
</a><a href="#h36-0-25" id="h36-0-25" class="i">+                Constant(
</a><a href="#h36-0-26" id="h36-0-26" class="i">+                    Integer(
</a><a href="#h36-0-27" id="h36-0-27" class="i">+                        3,
</a><a href="#h36-0-28" id="h36-0-28" class="i">+                    ),
</a>                 ),
             ),
         ),
<a href="#h36-1" id="h36-1" class="h">@@ -57,14 +59,17 @@ Plan: Plan(
</a> )
 
 Optimized plan: Plan(
<a href="#h36-1-3" id="h36-1-3" class="d">-    KeyLookup {
</a><a href="#h36-1-4" id="h36-1-4" class="d">-        table: &quot;movies&quot;,
</a><a href="#h36-1-5" id="h36-1-5" class="d">-        alias: None,
</a><a href="#h36-1-6" id="h36-1-6" class="d">-        keys: [
</a><a href="#h36-1-7" id="h36-1-7" class="d">-            Integer(
</a><a href="#h36-1-8" id="h36-1-8" class="d">-                3,
</a><a href="#h36-1-9" id="h36-1-9" class="d">-            ),
</a><a href="#h36-1-10" id="h36-1-10" class="d">-        ],
</a><a href="#h36-1-11" id="h36-1-11" class="i">+    Filter {
</a><a href="#h36-1-12" id="h36-1-12" class="i">+        source: KeyLookup {
</a><a href="#h36-1-13" id="h36-1-13" class="i">+            table: &quot;movies&quot;,
</a><a href="#h36-1-14" id="h36-1-14" class="i">+            alias: None,
</a><a href="#h36-1-15" id="h36-1-15" class="i">+            keys: [
</a><a href="#h36-1-16" id="h36-1-16" class="i">+                Integer(
</a><a href="#h36-1-17" id="h36-1-17" class="i">+                    3,
</a><a href="#h36-1-18" id="h36-1-18" class="i">+                ),
</a><a href="#h36-1-19" id="h36-1-19" class="i">+            ],
</a><a href="#h36-1-20" id="h36-1-20" class="i">+        },
</a><a href="#h36-1-21" id="h36-1-21" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h37" href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a> b/<a href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -71,21 +71,39 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h37-0-3" id="h37-0-3" class="d">-        predicate: Or(
</a><a href="#h37-0-4" id="h37-0-4" class="i">+        predicate: Some(
</a>             Or(
<a href="#h37-0-6" id="h37-0-6" class="d">-                Equal(
</a><a href="#h37-0-7" id="h37-0-7" class="d">-                    Field(
</a><a href="#h37-0-8" id="h37-0-8" class="d">-                        0,
</a><a href="#h37-0-9" id="h37-0-9" class="d">-                        Some(
</a><a href="#h37-0-10" id="h37-0-10" class="d">-                            (
</a><a href="#h37-0-11" id="h37-0-11" class="d">-                                None,
</a><a href="#h37-0-12" id="h37-0-12" class="d">-                                &quot;id&quot;,
</a><a href="#h37-0-13" id="h37-0-13" class="i">+                Or(
</a><a href="#h37-0-14" id="h37-0-14" class="i">+                    Equal(
</a><a href="#h37-0-15" id="h37-0-15" class="i">+                        Field(
</a><a href="#h37-0-16" id="h37-0-16" class="i">+                            0,
</a><a href="#h37-0-17" id="h37-0-17" class="i">+                            Some(
</a><a href="#h37-0-18" id="h37-0-18" class="i">+                                (
</a><a href="#h37-0-19" id="h37-0-19" class="i">+                                    None,
</a><a href="#h37-0-20" id="h37-0-20" class="i">+                                    &quot;id&quot;,
</a><a href="#h37-0-21" id="h37-0-21" class="i">+                                ),
</a><a href="#h37-0-22" id="h37-0-22" class="i">+                            ),
</a><a href="#h37-0-23" id="h37-0-23" class="i">+                        ),
</a><a href="#h37-0-24" id="h37-0-24" class="i">+                        Constant(
</a><a href="#h37-0-25" id="h37-0-25" class="i">+                            Integer(
</a><a href="#h37-0-26" id="h37-0-26" class="i">+                                3,
</a>                             ),
                         ),
                     ),
<a href="#h37-0-30" id="h37-0-30" class="d">-                    Constant(
</a><a href="#h37-0-31" id="h37-0-31" class="d">-                        Integer(
</a><a href="#h37-0-32" id="h37-0-32" class="d">-                            3,
</a><a href="#h37-0-33" id="h37-0-33" class="i">+                    Equal(
</a><a href="#h37-0-34" id="h37-0-34" class="i">+                        Field(
</a><a href="#h37-0-35" id="h37-0-35" class="i">+                            0,
</a><a href="#h37-0-36" id="h37-0-36" class="i">+                            Some(
</a><a href="#h37-0-37" id="h37-0-37" class="i">+                                (
</a><a href="#h37-0-38" id="h37-0-38" class="i">+                                    None,
</a><a href="#h37-0-39" id="h37-0-39" class="i">+                                    &quot;id&quot;,
</a><a href="#h37-0-40" id="h37-0-40" class="i">+                                ),
</a><a href="#h37-0-41" id="h37-0-41" class="i">+                            ),
</a><a href="#h37-0-42" id="h37-0-42" class="i">+                        ),
</a><a href="#h37-0-43" id="h37-0-43" class="i">+                        Constant(
</a><a href="#h37-0-44" id="h37-0-44" class="i">+                            Integer(
</a><a href="#h37-0-45" id="h37-0-45" class="i">+                                5,
</a><a href="#h37-0-46" id="h37-0-46" class="i">+                            ),
</a>                         ),
                     ),
                 ),
<a href="#h37-1" id="h37-1" class="h">@@ -101,46 +119,33 @@ Plan: Plan(
</a>                     ),
                     Constant(
                         Integer(
<a href="#h37-1-3" id="h37-1-3" class="d">-                            5,
</a><a href="#h37-1-4" id="h37-1-4" class="i">+                            7,
</a>                         ),
                     ),
                 ),
             ),
<a href="#h37-1-9" id="h37-1-9" class="d">-            Equal(
</a><a href="#h37-1-10" id="h37-1-10" class="d">-                Field(
</a><a href="#h37-1-11" id="h37-1-11" class="d">-                    0,
</a><a href="#h37-1-12" id="h37-1-12" class="d">-                    Some(
</a><a href="#h37-1-13" id="h37-1-13" class="d">-                        (
</a><a href="#h37-1-14" id="h37-1-14" class="d">-                            None,
</a><a href="#h37-1-15" id="h37-1-15" class="d">-                            &quot;id&quot;,
</a><a href="#h37-1-16" id="h37-1-16" class="d">-                        ),
</a><a href="#h37-1-17" id="h37-1-17" class="d">-                    ),
</a><a href="#h37-1-18" id="h37-1-18" class="d">-                ),
</a><a href="#h37-1-19" id="h37-1-19" class="d">-                Constant(
</a><a href="#h37-1-20" id="h37-1-20" class="d">-                    Integer(
</a><a href="#h37-1-21" id="h37-1-21" class="d">-                        7,
</a><a href="#h37-1-22" id="h37-1-22" class="d">-                    ),
</a><a href="#h37-1-23" id="h37-1-23" class="d">-                ),
</a><a href="#h37-1-24" id="h37-1-24" class="d">-            ),
</a>         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h37-1-30" id="h37-1-30" class="d">-    KeyLookup {
</a><a href="#h37-1-31" id="h37-1-31" class="d">-        table: &quot;movies&quot;,
</a><a href="#h37-1-32" id="h37-1-32" class="d">-        alias: None,
</a><a href="#h37-1-33" id="h37-1-33" class="d">-        keys: [
</a><a href="#h37-1-34" id="h37-1-34" class="d">-            Integer(
</a><a href="#h37-1-35" id="h37-1-35" class="d">-                3,
</a><a href="#h37-1-36" id="h37-1-36" class="d">-            ),
</a><a href="#h37-1-37" id="h37-1-37" class="d">-            Integer(
</a><a href="#h37-1-38" id="h37-1-38" class="d">-                5,
</a><a href="#h37-1-39" id="h37-1-39" class="d">-            ),
</a><a href="#h37-1-40" id="h37-1-40" class="d">-            Integer(
</a><a href="#h37-1-41" id="h37-1-41" class="d">-                7,
</a><a href="#h37-1-42" id="h37-1-42" class="d">-            ),
</a><a href="#h37-1-43" id="h37-1-43" class="d">-        ],
</a><a href="#h37-1-44" id="h37-1-44" class="i">+    Filter {
</a><a href="#h37-1-45" id="h37-1-45" class="i">+        source: KeyLookup {
</a><a href="#h37-1-46" id="h37-1-46" class="i">+            table: &quot;movies&quot;,
</a><a href="#h37-1-47" id="h37-1-47" class="i">+            alias: None,
</a><a href="#h37-1-48" id="h37-1-48" class="i">+            keys: [
</a><a href="#h37-1-49" id="h37-1-49" class="i">+                Integer(
</a><a href="#h37-1-50" id="h37-1-50" class="i">+                    3,
</a><a href="#h37-1-51" id="h37-1-51" class="i">+                ),
</a><a href="#h37-1-52" id="h37-1-52" class="i">+                Integer(
</a><a href="#h37-1-53" id="h37-1-53" class="i">+                    5,
</a><a href="#h37-1-54" id="h37-1-54" class="i">+                ),
</a><a href="#h37-1-55" id="h37-1-55" class="i">+                Integer(
</a><a href="#h37-1-56" id="h37-1-56" class="i">+                    7,
</a><a href="#h37-1-57" id="h37-1-57" class="i">+                ),
</a><a href="#h37-1-58" id="h37-1-58" class="i">+            ],
</a><a href="#h37-1-59" id="h37-1-59" class="i">+        },
</a><a href="#h37-1-60" id="h37-1-60" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h38" href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a> b/<a href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -105,23 +105,41 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h38-0-3" id="h38-0-3" class="d">-        predicate: And(
</a><a href="#h38-0-4" id="h38-0-4" class="d">-            Or(
</a><a href="#h38-0-5" id="h38-0-5" class="i">+        predicate: Some(
</a><a href="#h38-0-6" id="h38-0-6" class="i">+            And(
</a>                 Or(
                     Or(
<a href="#h38-0-9" id="h38-0-9" class="d">-                        Equal(
</a><a href="#h38-0-10" id="h38-0-10" class="d">-                            Field(
</a><a href="#h38-0-11" id="h38-0-11" class="d">-                                0,
</a><a href="#h38-0-12" id="h38-0-12" class="d">-                                Some(
</a><a href="#h38-0-13" id="h38-0-13" class="d">-                                    (
</a><a href="#h38-0-14" id="h38-0-14" class="d">-                                        None,
</a><a href="#h38-0-15" id="h38-0-15" class="d">-                                        &quot;id&quot;,
</a><a href="#h38-0-16" id="h38-0-16" class="i">+                        Or(
</a><a href="#h38-0-17" id="h38-0-17" class="i">+                            Equal(
</a><a href="#h38-0-18" id="h38-0-18" class="i">+                                Field(
</a><a href="#h38-0-19" id="h38-0-19" class="i">+                                    0,
</a><a href="#h38-0-20" id="h38-0-20" class="i">+                                    Some(
</a><a href="#h38-0-21" id="h38-0-21" class="i">+                                        (
</a><a href="#h38-0-22" id="h38-0-22" class="i">+                                            None,
</a><a href="#h38-0-23" id="h38-0-23" class="i">+                                            &quot;id&quot;,
</a><a href="#h38-0-24" id="h38-0-24" class="i">+                                        ),
</a><a href="#h38-0-25" id="h38-0-25" class="i">+                                    ),
</a><a href="#h38-0-26" id="h38-0-26" class="i">+                                ),
</a><a href="#h38-0-27" id="h38-0-27" class="i">+                                Constant(
</a><a href="#h38-0-28" id="h38-0-28" class="i">+                                    Integer(
</a><a href="#h38-0-29" id="h38-0-29" class="i">+                                        2,
</a>                                     ),
                                 ),
                             ),
<a href="#h38-0-33" id="h38-0-33" class="d">-                            Constant(
</a><a href="#h38-0-34" id="h38-0-34" class="d">-                                Integer(
</a><a href="#h38-0-35" id="h38-0-35" class="d">-                                    2,
</a><a href="#h38-0-36" id="h38-0-36" class="i">+                            Equal(
</a><a href="#h38-0-37" id="h38-0-37" class="i">+                                Field(
</a><a href="#h38-0-38" id="h38-0-38" class="i">+                                    0,
</a><a href="#h38-0-39" id="h38-0-39" class="i">+                                    Some(
</a><a href="#h38-0-40" id="h38-0-40" class="i">+                                        (
</a><a href="#h38-0-41" id="h38-0-41" class="i">+                                            None,
</a><a href="#h38-0-42" id="h38-0-42" class="i">+                                            &quot;id&quot;,
</a><a href="#h38-0-43" id="h38-0-43" class="i">+                                        ),
</a><a href="#h38-0-44" id="h38-0-44" class="i">+                                    ),
</a><a href="#h38-0-45" id="h38-0-45" class="i">+                                ),
</a><a href="#h38-0-46" id="h38-0-46" class="i">+                                Constant(
</a><a href="#h38-0-47" id="h38-0-47" class="i">+                                    Integer(
</a><a href="#h38-0-48" id="h38-0-48" class="i">+                                        3,
</a><a href="#h38-0-49" id="h38-0-49" class="i">+                                    ),
</a>                                 ),
                             ),
                         ),
<a href="#h38-1" id="h38-1" class="h">@@ -137,7 +155,7 @@ Plan: Plan(
</a>                             ),
                             Constant(
                                 Integer(
<a href="#h38-1-3" id="h38-1-3" class="d">-                                    3,
</a><a href="#h38-1-4" id="h38-1-4" class="i">+                                    4,
</a>                                 ),
                             ),
                         ),
<a href="#h38-2" id="h38-2" class="h">@@ -154,43 +172,27 @@ Plan: Plan(
</a>                         ),
                         Constant(
                             Integer(
<a href="#h38-2-3" id="h38-2-3" class="d">-                                4,
</a><a href="#h38-2-4" id="h38-2-4" class="i">+                                5,
</a>                             ),
                         ),
                     ),
                 ),
                 Equal(
                     Field(
<a href="#h38-2-11" id="h38-2-11" class="d">-                        0,
</a><a href="#h38-2-12" id="h38-2-12" class="i">+                        3,
</a>                         Some(
                             (
                                 None,
<a href="#h38-2-16" id="h38-2-16" class="d">-                                &quot;id&quot;,
</a><a href="#h38-2-17" id="h38-2-17" class="i">+                                &quot;genre_id&quot;,
</a>                             ),
                         ),
                     ),
                     Constant(
                         Integer(
<a href="#h38-2-23" id="h38-2-23" class="d">-                            5,
</a><a href="#h38-2-24" id="h38-2-24" class="d">-                        ),
</a><a href="#h38-2-25" id="h38-2-25" class="d">-                    ),
</a><a href="#h38-2-26" id="h38-2-26" class="d">-                ),
</a><a href="#h38-2-27" id="h38-2-27" class="d">-            ),
</a><a href="#h38-2-28" id="h38-2-28" class="d">-            Equal(
</a><a href="#h38-2-29" id="h38-2-29" class="d">-                Field(
</a><a href="#h38-2-30" id="h38-2-30" class="d">-                    3,
</a><a href="#h38-2-31" id="h38-2-31" class="d">-                    Some(
</a><a href="#h38-2-32" id="h38-2-32" class="d">-                        (
</a><a href="#h38-2-33" id="h38-2-33" class="d">-                            None,
</a><a href="#h38-2-34" id="h38-2-34" class="d">-                            &quot;genre_id&quot;,
</a><a href="#h38-2-35" id="h38-2-35" class="i">+                            1,
</a>                         ),
                     ),
                 ),
<a href="#h38-2-39" id="h38-2-39" class="d">-                Constant(
</a><a href="#h38-2-40" id="h38-2-40" class="d">-                    Integer(
</a><a href="#h38-2-41" id="h38-2-41" class="d">-                        1,
</a><a href="#h38-2-42" id="h38-2-42" class="d">-                    ),
</a><a href="#h38-2-43" id="h38-2-43" class="d">-                ),
</a>             ),
         ),
     },
<a href="#h38-3" id="h38-3" class="h">@@ -198,40 +200,45 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Filter {
<a href="#h38-3-3" id="h38-3-3" class="d">-        source: KeyLookup {
</a><a href="#h38-3-4" id="h38-3-4" class="d">-            table: &quot;movies&quot;,
</a><a href="#h38-3-5" id="h38-3-5" class="d">-            alias: None,
</a><a href="#h38-3-6" id="h38-3-6" class="d">-            keys: [
</a><a href="#h38-3-7" id="h38-3-7" class="d">-                Integer(
</a><a href="#h38-3-8" id="h38-3-8" class="d">-                    2,
</a><a href="#h38-3-9" id="h38-3-9" class="d">-                ),
</a><a href="#h38-3-10" id="h38-3-10" class="d">-                Integer(
</a><a href="#h38-3-11" id="h38-3-11" class="d">-                    3,
</a><a href="#h38-3-12" id="h38-3-12" class="d">-                ),
</a><a href="#h38-3-13" id="h38-3-13" class="d">-                Integer(
</a><a href="#h38-3-14" id="h38-3-14" class="d">-                    4,
</a><a href="#h38-3-15" id="h38-3-15" class="d">-                ),
</a><a href="#h38-3-16" id="h38-3-16" class="d">-                Integer(
</a><a href="#h38-3-17" id="h38-3-17" class="d">-                    5,
</a><a href="#h38-3-18" id="h38-3-18" class="d">-                ),
</a><a href="#h38-3-19" id="h38-3-19" class="d">-            ],
</a><a href="#h38-3-20" id="h38-3-20" class="d">-        },
</a><a href="#h38-3-21" id="h38-3-21" class="d">-        predicate: Equal(
</a><a href="#h38-3-22" id="h38-3-22" class="d">-            Field(
</a><a href="#h38-3-23" id="h38-3-23" class="d">-                3,
</a><a href="#h38-3-24" id="h38-3-24" class="d">-                Some(
</a><a href="#h38-3-25" id="h38-3-25" class="d">-                    (
</a><a href="#h38-3-26" id="h38-3-26" class="d">-                        None,
</a><a href="#h38-3-27" id="h38-3-27" class="d">-                        &quot;genre_id&quot;,
</a><a href="#h38-3-28" id="h38-3-28" class="i">+        source: Filter {
</a><a href="#h38-3-29" id="h38-3-29" class="i">+            source: KeyLookup {
</a><a href="#h38-3-30" id="h38-3-30" class="i">+                table: &quot;movies&quot;,
</a><a href="#h38-3-31" id="h38-3-31" class="i">+                alias: None,
</a><a href="#h38-3-32" id="h38-3-32" class="i">+                keys: [
</a><a href="#h38-3-33" id="h38-3-33" class="i">+                    Integer(
</a><a href="#h38-3-34" id="h38-3-34" class="i">+                        2,
</a><a href="#h38-3-35" id="h38-3-35" class="i">+                    ),
</a><a href="#h38-3-36" id="h38-3-36" class="i">+                    Integer(
</a><a href="#h38-3-37" id="h38-3-37" class="i">+                        3,
</a><a href="#h38-3-38" id="h38-3-38" class="i">+                    ),
</a><a href="#h38-3-39" id="h38-3-39" class="i">+                    Integer(
</a><a href="#h38-3-40" id="h38-3-40" class="i">+                        4,
</a><a href="#h38-3-41" id="h38-3-41" class="i">+                    ),
</a><a href="#h38-3-42" id="h38-3-42" class="i">+                    Integer(
</a><a href="#h38-3-43" id="h38-3-43" class="i">+                        5,
</a><a href="#h38-3-44" id="h38-3-44" class="i">+                    ),
</a><a href="#h38-3-45" id="h38-3-45" class="i">+                ],
</a><a href="#h38-3-46" id="h38-3-46" class="i">+            },
</a><a href="#h38-3-47" id="h38-3-47" class="i">+            predicate: Some(
</a><a href="#h38-3-48" id="h38-3-48" class="i">+                Equal(
</a><a href="#h38-3-49" id="h38-3-49" class="i">+                    Field(
</a><a href="#h38-3-50" id="h38-3-50" class="i">+                        3,
</a><a href="#h38-3-51" id="h38-3-51" class="i">+                        Some(
</a><a href="#h38-3-52" id="h38-3-52" class="i">+                            (
</a><a href="#h38-3-53" id="h38-3-53" class="i">+                                None,
</a><a href="#h38-3-54" id="h38-3-54" class="i">+                                &quot;genre_id&quot;,
</a><a href="#h38-3-55" id="h38-3-55" class="i">+                            ),
</a><a href="#h38-3-56" id="h38-3-56" class="i">+                        ),
</a><a href="#h38-3-57" id="h38-3-57" class="i">+                    ),
</a><a href="#h38-3-58" id="h38-3-58" class="i">+                    Constant(
</a><a href="#h38-3-59" id="h38-3-59" class="i">+                        Integer(
</a><a href="#h38-3-60" id="h38-3-60" class="i">+                            1,
</a><a href="#h38-3-61" id="h38-3-61" class="i">+                        ),
</a>                     ),
                 ),
             ),
<a href="#h38-3-65" id="h38-3-65" class="d">-            Constant(
</a><a href="#h38-3-66" id="h38-3-66" class="d">-                Integer(
</a><a href="#h38-3-67" id="h38-3-67" class="d">-                    1,
</a><a href="#h38-3-68" id="h38-3-68" class="d">-                ),
</a><a href="#h38-3-69" id="h38-3-69" class="d">-            ),
</a><a href="#h38-3-70" id="h38-3-70" class="d">-        ),
</a><a href="#h38-3-71" id="h38-3-71" class="i">+        },
</a><a href="#h38-3-72" id="h38-3-72" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h39" href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a> b/<a href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -29,25 +29,30 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h39-0-3" id="h39-0-3" class="d">-        predicate: Constant(
</a><a href="#h39-0-4" id="h39-0-4" class="d">-            String(
</a><a href="#h39-0-5" id="h39-0-5" class="d">-                &quot;abc&quot;,
</a><a href="#h39-0-6" id="h39-0-6" class="i">+        predicate: Some(
</a><a href="#h39-0-7" id="h39-0-7" class="i">+            Constant(
</a><a href="#h39-0-8" id="h39-0-8" class="i">+                String(
</a><a href="#h39-0-9" id="h39-0-9" class="i">+                    &quot;abc&quot;,
</a><a href="#h39-0-10" id="h39-0-10" class="i">+                ),
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h39-0-17" id="h39-0-17" class="d">-    Scan {
</a><a href="#h39-0-18" id="h39-0-18" class="d">-        table: &quot;movies&quot;,
</a><a href="#h39-0-19" id="h39-0-19" class="d">-        alias: None,
</a><a href="#h39-0-20" id="h39-0-20" class="d">-        filter: Some(
</a><a href="#h39-0-21" id="h39-0-21" class="d">-            Constant(
</a><a href="#h39-0-22" id="h39-0-22" class="d">-                String(
</a><a href="#h39-0-23" id="h39-0-23" class="d">-                    &quot;abc&quot;,
</a><a href="#h39-0-24" id="h39-0-24" class="i">+    Filter {
</a><a href="#h39-0-25" id="h39-0-25" class="i">+        source: Scan {
</a><a href="#h39-0-26" id="h39-0-26" class="i">+            table: &quot;movies&quot;,
</a><a href="#h39-0-27" id="h39-0-27" class="i">+            alias: None,
</a><a href="#h39-0-28" id="h39-0-28" class="i">+            filter: Some(
</a><a href="#h39-0-29" id="h39-0-29" class="i">+                Constant(
</a><a href="#h39-0-30" id="h39-0-30" class="i">+                    String(
</a><a href="#h39-0-31" id="h39-0-31" class="i">+                        &quot;abc&quot;,
</a><a href="#h39-0-32" id="h39-0-32" class="i">+                    ),
</a>                 ),
             ),
<a href="#h39-0-35" id="h39-0-35" class="d">-        ),
</a><a href="#h39-0-36" id="h39-0-36" class="i">+        },
</a><a href="#h39-0-37" id="h39-0-37" class="i">+        predicate: None,
</a>     },
 )
 
<b>diff --git a/<a id="h40" href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a> b/<a href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -29,25 +29,30 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h40-0-3" id="h40-0-3" class="d">-        predicate: Constant(
</a><a href="#h40-0-4" id="h40-0-4" class="d">-            Boolean(
</a><a href="#h40-0-5" id="h40-0-5" class="d">-                true,
</a><a href="#h40-0-6" id="h40-0-6" class="i">+        predicate: Some(
</a><a href="#h40-0-7" id="h40-0-7" class="i">+            Constant(
</a><a href="#h40-0-8" id="h40-0-8" class="i">+                Boolean(
</a><a href="#h40-0-9" id="h40-0-9" class="i">+                    true,
</a><a href="#h40-0-10" id="h40-0-10" class="i">+                ),
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h40-0-17" id="h40-0-17" class="d">-    Scan {
</a><a href="#h40-0-18" id="h40-0-18" class="d">-        table: &quot;movies&quot;,
</a><a href="#h40-0-19" id="h40-0-19" class="d">-        alias: None,
</a><a href="#h40-0-20" id="h40-0-20" class="d">-        filter: Some(
</a><a href="#h40-0-21" id="h40-0-21" class="d">-            Constant(
</a><a href="#h40-0-22" id="h40-0-22" class="d">-                Boolean(
</a><a href="#h40-0-23" id="h40-0-23" class="d">-                    true,
</a><a href="#h40-0-24" id="h40-0-24" class="i">+    Filter {
</a><a href="#h40-0-25" id="h40-0-25" class="i">+        source: Scan {
</a><a href="#h40-0-26" id="h40-0-26" class="i">+            table: &quot;movies&quot;,
</a><a href="#h40-0-27" id="h40-0-27" class="i">+            alias: None,
</a><a href="#h40-0-28" id="h40-0-28" class="i">+            filter: Some(
</a><a href="#h40-0-29" id="h40-0-29" class="i">+                Constant(
</a><a href="#h40-0-30" id="h40-0-30" class="i">+                    Boolean(
</a><a href="#h40-0-31" id="h40-0-31" class="i">+                        true,
</a><a href="#h40-0-32" id="h40-0-32" class="i">+                    ),
</a>                 ),
             ),
<a href="#h40-0-35" id="h40-0-35" class="d">-        ),
</a><a href="#h40-0-36" id="h40-0-36" class="i">+        },
</a><a href="#h40-0-37" id="h40-0-37" class="i">+        predicate: None,
</a>     },
 )
 
</pre>
</div>
</body>
</html>
