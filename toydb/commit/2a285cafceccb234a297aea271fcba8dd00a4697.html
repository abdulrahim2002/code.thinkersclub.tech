<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>error: improve error variants - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/2a285cafceccb234a297aea271fcba8dd00a4697.html">2a285cafceccb234a297aea271fcba8dd00a4697</a>
<b>parent</b> <a href="../commit/cad5c843cc2128556e84001ef53ffceeea22ea93.html">cad5c843cc2128556e84001ef53ffceeea22ea93</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sun,  2 Jun 2024 13:47:10 +0200

error: improve error variants

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/bin/toydb.rs</a></td><td> | </td><td class="num">7</td><td><span class="i">++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/bin/toydump.rs</a></td><td> | </td><td class="num">7</td><td><span class="i">++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/bin/toysql.rs</a></td><td> | </td><td class="num">17</td><td><span class="i">++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/client.rs</a></td><td> | </td><td class="num">13</td><td><span class="i">++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/encoding/bincode.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/encoding/keycode.rs</a></td><td> | </td><td class="num">22</td><td><span class="i">++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/error.rs</a></td><td> | </td><td class="num">169</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/raft/node.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">+++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/raft/testscripts/node/append_conflict_divergent</a></td><td> | </td><td class="num">18</td><td><span class="i">+++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/raft/testscripts/node/append_conflict_replace_term</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/raft/testscripts/node/election_candidate_behind_leader</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/raft/testscripts/node/request_candidate_abort</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/raft/testscripts/node/request_follower_campaign_abort</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/raft/testscripts/node/request_follower_leaderless_abort</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">src/raft/testscripts/node/request_leader_campaign_abort</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">src/sql/engine/kv.rs</a></td><td> | </td><td class="num">34</td><td><span class="i">+++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">src/sql/engine/mod.rs</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/sql/engine/raft.rs</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">src/sql/execution/aggregation.rs</a></td><td> | </td><td class="num">5</td><td><span class="i">+++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">src/sql/execution/join.rs</a></td><td> | </td><td class="num">22</td><td><span class="i">+++++++</span><span class="d">---------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">src/sql/execution/mod.rs</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">src/sql/execution/mutation.rs</a></td><td> | </td><td class="num">15</td><td><span class="i">++++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">src/sql/execution/query.rs</a></td><td> | </td><td class="num">18</td><td><span class="i">++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">src/sql/parser/lexer.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">58</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d">-------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">69</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">src/sql/schema.rs</a></td><td> | </td><td class="num">99</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">src/sql/types/expression.rs</a></td><td> | </td><td class="num">82</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d">--------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">src/sql/types/mod.rs</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">src/storage/golden/mvcc/begin_as_of</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">src/storage/golden/mvcc/resume</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">src/storage/mvcc.rs</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/e2e/client.rs</a></td><td> | </td><td class="num">20</td><td><span class="i">+++++++++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/expression.rs</a></td><td> | </td><td class="num">172</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/mutation/delete_bare</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/mutation/delete_bare_from</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/mutation/delete_bare_where</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/mutation/delete_missing_column_where</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/mutation/delete_missing_table</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/mutation/delete_multiple_tables</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/mutation/delete_where_float</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">tests/sql/mutation/delete_where_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">tests/sql/mutation/delete_where_string</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">tests/sql/mutation/insert_bare</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">tests/sql/mutation/insert_bare_no_table</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">tests/sql/mutation/insert_bare_values</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">tests/sql/mutation/insert_empty_both</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">tests/sql/mutation/insert_empty_columns</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">tests/sql/mutation/insert_empty_values</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">tests/sql/mutation/insert_extra</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">tests/sql/mutation/insert_extra_columns</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">tests/sql/mutation/insert_full_trailing_comma</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">tests/sql/mutation/insert_missing_column</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">tests/sql/mutation/insert_missing_table</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">tests/sql/mutation/insert_multiple_tables</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">tests/sql/mutation/insert_partial_columns</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">tests/sql/mutation/update_bare</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">tests/sql/mutation/update_bare_no_table</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">tests/sql/mutation/update_bare_set</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">tests/sql/mutation/update_bare_where</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">tests/sql/mutation/update_missing_column_set</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">tests/sql/mutation/update_missing_column_where</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">tests/sql/mutation/update_missing_table</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">tests/sql/mutation/update_multiple_tables</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">tests/sql/mutation/update_where_float</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">tests/sql/mutation/update_where_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">tests/sql/mutation/update_where_string</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">tests/sql/query.rs</a></td><td> | </td><td class="num">9</td><td><span class="i">++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">tests/sql/query/agg_nested</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">tests/sql/query/agg_ungrouped</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">tests/sql/query/as_all</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">tests/sql/query/as_bare</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">tests/sql/query/as_qualified</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">tests/sql/query/bare</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">tests/sql/query/expr_dynamic</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">tests/sql/query/field_ambiguous</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">tests/sql/query/field_qualified_nested</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h77">tests/sql/query/field_unknown</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h78">tests/sql/query/field_unknown_aliased</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h79">tests/sql/query/field_unknown_qualified</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h80">tests/sql/query/field_unknown_table</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h81">tests/sql/query/from_alias_duplicate</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h82">tests/sql/query/from_alias_duplicate_join</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h83">tests/sql/query/from_bare</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h84">tests/sql/query/from_duplicate</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h85">tests/sql/query/from_unknown</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h86">tests/sql/query/group_expr_aggr_nogroupref</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h87">tests/sql/query/group_expr_extended</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h88">tests/sql/query/group_unknown</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h89">tests/sql/query/having_aggr_nested</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h90">tests/sql/query/join_cross_on</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h91">tests/sql/query/join_inner_on_missing</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h92">tests/sql/query/limit_boolean</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h93">tests/sql/query/limit_dynamic</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h94">tests/sql/query/limit_float</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h95">tests/sql/query/limit_multi</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h96">tests/sql/query/limit_neg</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h97">tests/sql/query/limit_null</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h98">tests/sql/query/limit_string</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h99">tests/sql/query/offset_boolean</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h100">tests/sql/query/offset_dynamic</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h101">tests/sql/query/offset_float</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h102">tests/sql/query/offset_multi</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h103">tests/sql/query/offset_neg</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h104">tests/sql/query/offset_null</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h105">tests/sql/query/offset_string</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h106">tests/sql/query/order_field_ambiguous</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h107">tests/sql/query/order_field_unknown</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h108">tests/sql/query/order_trailing_comma</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h109">tests/sql/query/order_unknown_dir</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h110">tests/sql/query/trailing_comma</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h111">tests/sql/query/where_bare</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h112">tests/sql/query/where_field_aliased_select</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h113">tests/sql/query/where_field_ambiguous</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h114">tests/sql/query/where_field_unknown</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h115">tests/sql/query/where_float</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h116">tests/sql/query/where_integer</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h117">tests/sql/query/where_multi</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h118">tests/sql/query/where_string</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h119">tests/sql/schema/create_table_bare</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h120">tests/sql/schema/create_table_columns_empty</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h121">tests/sql/schema/create_table_columns_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h122">tests/sql/schema/create_table_datatype_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h123">tests/sql/schema/create_table_datatype_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h124">tests/sql/schema/create_table_default_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h125">tests/sql/schema/create_table_default_conflict_float_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h126">tests/sql/schema/create_table_default_conflict_integer_float</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h127">tests/sql/schema/create_table_default_null_not</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h128">tests/sql/schema/create_table_exists</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h129">tests/sql/schema/create_table_name_emoji</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h130">tests/sql/schema/create_table_name_keyword</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h131">tests/sql/schema/create_table_name_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h132">tests/sql/schema/create_table_name_quote_double_unterminated</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h133">tests/sql/schema/create_table_name_quote_single</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h134">tests/sql/schema/create_table_name_underscore_prefix</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h135">tests/sql/schema/create_table_null_not_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h136">tests/sql/schema/create_table_pk_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h137">tests/sql/schema/create_table_pk_multiple</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h138">tests/sql/schema/create_table_pk_nullable</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h139">tests/sql/schema/create_table_ref_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h140">tests/sql/schema/create_table_ref_self_type</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h141">tests/sql/schema/create_table_ref_type</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h142">tests/sql/schema/delete_ref_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h143">tests/sql/schema/delete_ref_self_all</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h144">tests/sql/schema/delete_ref_self_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h145">tests/sql/schema/drop_table_bare</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h146">tests/sql/schema/drop_table_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h147">tests/sql/schema/drop_table_multiple</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h148">tests/sql/schema/drop_table_ref_target</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h149">tests/sql/schema/insert_boolean_float</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h150">tests/sql/schema/insert_boolean_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h151">tests/sql/schema/insert_boolean_string</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h152">tests/sql/schema/insert_boolean_string_empty</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h153">tests/sql/schema/insert_default_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h154">tests/sql/schema/insert_float_boolean</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h155">tests/sql/schema/insert_float_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h156">tests/sql/schema/insert_float_string</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h157">tests/sql/schema/insert_float_string_empty</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h158">tests/sql/schema/insert_integer_boolean</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h159">tests/sql/schema/insert_integer_float</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h160">tests/sql/schema/insert_integer_float_infinity</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h161">tests/sql/schema/insert_integer_float_nan</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h162">tests/sql/schema/insert_integer_string</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h163">tests/sql/schema/insert_integer_string_empty</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h164">tests/sql/schema/insert_nulls_required</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h165">tests/sql/schema/insert_pk_boolean_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h166">tests/sql/schema/insert_pk_boolean_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h167">tests/sql/schema/insert_pk_float_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h168">tests/sql/schema/insert_pk_float_infinity</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h169">tests/sql/schema/insert_pk_float_nan</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h170">tests/sql/schema/insert_pk_float_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h171">tests/sql/schema/insert_pk_integer_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h172">tests/sql/schema/insert_pk_integer_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h173">tests/sql/schema/insert_pk_string_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h174">tests/sql/schema/insert_pk_string_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h175">tests/sql/schema/insert_ref_boolean_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h176">tests/sql/schema/insert_ref_float_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h177">tests/sql/schema/insert_ref_integer_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h178">tests/sql/schema/insert_ref_self_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h179">tests/sql/schema/insert_ref_string_case</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h180">tests/sql/schema/insert_ref_string_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h181">tests/sql/schema/insert_string_1025</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h182">tests/sql/schema/insert_string_1025_unicode</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h183">tests/sql/schema/insert_string_boolean</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h184">tests/sql/schema/insert_string_float</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h185">tests/sql/schema/insert_string_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h186">tests/sql/schema/insert_unique_boolean_duplicate</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h187">tests/sql/schema/insert_unique_float_duplicate</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h188">tests/sql/schema/insert_unique_integer_duplicate</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h189">tests/sql/schema/insert_unique_string_duplicate</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h190">tests/sql/schema/update_integer_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h191">tests/sql/schema/update_integer_float</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h192">tests/sql/schema/update_pk_boolean_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h193">tests/sql/schema/update_pk_float_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h194">tests/sql/schema/update_pk_float_conflict_all</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h195">tests/sql/schema/update_pk_float_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h196">tests/sql/schema/update_pk_integer_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h197">tests/sql/schema/update_pk_integer_conflict_all</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h198">tests/sql/schema/update_pk_integer_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h199">tests/sql/schema/update_pk_string_conflict</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h200">tests/sql/schema/update_pk_string_conflict_all</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h201">tests/sql/schema/update_pk_string_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h202">tests/sql/schema/update_ref_pk</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h203">tests/sql/schema/update_ref_self_pk</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h204">tests/sql/schema/update_ref_source_missing</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h205">tests/sql/schema/update_unique_boolean_duplicate</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
</table></pre><pre>206 files changed, 741 insertions(+), 770 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/bin/toydb.rs.html">src/bin/toydb.rs</a> b/<a href="../file/src/bin/toydb.rs.html">src/bin/toydb.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -8,7 +8,8 @@
</a> 
 use serde_derive::Deserialize;
 use std::collections::HashMap;
<a href="#h0-0-3" id="h0-0-3" class="d">-use toydb::error::{Error, Result};
</a><a href="#h0-0-4" id="h0-0-4" class="i">+use toydb::errinput;
</a><a href="#h0-0-5" id="h0-0-5" class="i">+use toydb::error::Result;
</a> use toydb::raft;
 use toydb::sql;
 use toydb::storage;
<a href="#h0-1" id="h0-1" class="h">@@ -43,7 +44,7 @@ fn main() -&gt; Result&lt;()&gt; {
</a>             COMPACT_MIN_BYTES,
         )?)?,
         &quot;memory&quot; =&gt; raft::Log::new(storage::Memory::new())?,
<a href="#h0-1-3" id="h0-1-3" class="d">-        name =&gt; return Err(Error::Config(format!(&quot;Unknown Raft storage engine {}&quot;, name))),
</a><a href="#h0-1-4" id="h0-1-4" class="i">+        name =&gt; return errinput!(&quot;invalid Raft storage engine {name}&quot;),
</a>     };
     let raft_state: Box&lt;dyn raft::State&gt; = match cfg.storage_sql.as_str() {
         &quot;bitcask&quot; | &quot;&quot; =&gt; {
<a href="#h0-2" id="h0-2" class="h">@@ -58,7 +59,7 @@ fn main() -&gt; Result&lt;()&gt; {
</a>             let engine = storage::Memory::new();
             Box::new(sql::engine::Raft::new_state(engine)?)
         }
<a href="#h0-2-3" id="h0-2-3" class="d">-        name =&gt; return Err(Error::Config(format!(&quot;Unknown SQL storage engine {}&quot;, name))),
</a><a href="#h0-2-4" id="h0-2-4" class="i">+        name =&gt; return errinput!(&quot;invalid SQL storage engine {name}&quot;),
</a>     };
 
     Server::new(cfg.id, cfg.peers, raft_log, raft_state)?.serve(&amp;cfg.listen_raft, &amp;cfg.listen_sql)
<b>diff --git a/<a id="h1" href="../file/src/bin/toydump.rs.html">src/bin/toydump.rs</a> b/<a href="../file/src/bin/toydump.rs.html">src/bin/toydump.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -2,7 +2,8 @@
</a> //! human-readable form. It only prints live BitCask data, not garbage entries.
 #![warn(clippy::all)]
 
<a href="#h1-0-3" id="h1-0-3" class="d">-use toydb::error::{Error, Result};
</a><a href="#h1-0-4" id="h1-0-4" class="i">+use toydb::errdata;
</a><a href="#h1-0-5" id="h1-0-5" class="i">+use toydb::error::Result;
</a> use toydb::storage::debug;
 use toydb::storage::{BitCask, Engine};
 
<a href="#h1-1" id="h1-1" class="h">@@ -17,9 +18,9 @@ fn main() -&gt; Result&lt;()&gt; {
</a>     let mut scan = engine.scan(..);
     while let Some((key, value)) = scan.next().transpose()? {
         let (fkey, Some(fvalue)) = debug::format_key_value(&amp;key, &amp;Some(value)) else {
<a href="#h1-1-3" id="h1-1-3" class="d">-            return Err(Error::Internal(format!(&quot;Unexpected missing value at key {:?}&quot;, key)));
</a><a href="#h1-1-4" id="h1-1-4" class="i">+            return errdata!(&quot;unexpected missing value at key {:?}&quot;, key);
</a>         };
<a href="#h1-1-6" id="h1-1-6" class="d">-        println!(&quot;{} → {}&quot;, fkey, fvalue);
</a><a href="#h1-1-7" id="h1-1-7" class="i">+        println!(&quot;{fkey} → {fvalue}&quot;);
</a>     }
     Ok(())
 }
<b>diff --git a/<a id="h2" href="../file/src/bin/toysql.rs.html">src/bin/toysql.rs</a> b/<a href="../file/src/bin/toysql.rs.html">src/bin/toysql.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -9,6 +9,7 @@ use rustyline::history::DefaultHistory;
</a> use rustyline::validate::{ValidationContext, ValidationResult, Validator};
 use rustyline::{error::ReadlineError, Editor, Modifiers};
 use rustyline_derive::{Completer, Helper, Highlighter, Hinter};
<a href="#h2-0-3" id="h2-0-3" class="i">+use toydb::errinput;
</a> use toydb::error::{Error, Result};
 use toydb::sql::execution::ResultSet;
 use toydb::sql::parser::{Lexer, Token};
<a href="#h2-1" id="h2-1" class="h">@@ -78,12 +79,12 @@ impl ToySQL {
</a>     /// Handles a REPL command (prefixed by !, e.g. !help)
     fn execute_command(&amp;mut self, input: &amp;str) -&gt; Result&lt;()&gt; {
         let mut input = input.split_ascii_whitespace();
<a href="#h2-1-3" id="h2-1-3" class="d">-        let command = input.next().ok_or_else(|| Error::Parse(&quot;Expected command.&quot;.to_string()))?;
</a><a href="#h2-1-4" id="h2-1-4" class="i">+        let command = input.next().ok_or::&lt;Error&gt;(errinput!(&quot;expected command&quot;))?;
</a> 
         let getargs = |n| {
             let args: Vec&lt;&amp;str&gt; = input.collect();
             if args.len() != n {
<a href="#h2-1-9" id="h2-1-9" class="d">-                Err(Error::Parse(format!(&quot;{}: expected {} args, got {}&quot;, command, n, args.len())))
</a><a href="#h2-1-10" id="h2-1-10" class="i">+                errinput!(&quot;{command}: expected {n} args, got {}&quot;, args.len())
</a>             } else {
                 Ok(args)
             }
<a href="#h2-2" id="h2-2" class="h">@@ -99,7 +100,7 @@ impl ToySQL {
</a>                     self.show_headers = false;
                     println!(&quot;Headers disabled&quot;);
                 }
<a href="#h2-2-3" id="h2-2-3" class="d">-                v =&gt; return Err(Error::Parse(format!(&quot;Invalid value {}, expected on or off&quot;, v))),
</a><a href="#h2-2-4" id="h2-2-4" class="i">+                v =&gt; return errinput!(&quot;invalid value {v}, expected on or off&quot;),
</a>             },
             &quot;!help&quot; =&gt; println!(
                 r#&quot;
<a href="#h2-3" id="h2-3" class="h">@@ -172,7 +173,7 @@ Storage:   {keys} keys, {logical_size} MB logical, {nodes}x {disk_size} MB disk,
</a>                     println!(&quot;{}&quot;, table)
                 }
             }
<a href="#h2-3-3" id="h2-3-3" class="d">-            c =&gt; return Err(Error::Parse(format!(&quot;Unknown command {}&quot;, c))),
</a><a href="#h2-3-4" id="h2-3-4" class="i">+            c =&gt; return errinput!(&quot;unknown command {c}&quot;),
</a>         }
         Ok(())
     }
<a href="#h2-4" id="h2-4" class="h">@@ -254,11 +255,9 @@ Storage:   {keys} keys, {logical_size} MB logical, {nodes}x {disk_size} MB disk,
</a>         println!(&quot;Connected to toyDB node \&quot;{}\&quot;. Enter !help for instructions.&quot;, status.server);
 
         while let Some(input) = self.prompt()? {
<a href="#h2-4-3" id="h2-4-3" class="d">-            match self.execute(&amp;input) {
</a><a href="#h2-4-4" id="h2-4-4" class="d">-                Ok(()) =&gt; {}
</a><a href="#h2-4-5" id="h2-4-5" class="d">-                error @ Err(Error::Internal(_)) =&gt; return error,
</a><a href="#h2-4-6" id="h2-4-6" class="d">-                Err(error) =&gt; println!(&quot;Error: {}&quot;, error),
</a><a href="#h2-4-7" id="h2-4-7" class="d">-            }
</a><a href="#h2-4-8" id="h2-4-8" class="i">+            if let Err(error) = self.execute(&amp;input) {
</a><a href="#h2-4-9" id="h2-4-9" class="i">+                println!(&quot;Error: {error}&quot;);
</a><a href="#h2-4-10" id="h2-4-10" class="i">+            };
</a>         }
 
         if let Some(path) = &amp;self.history_path {
<b>diff --git a/<a id="h3" href="../file/src/client.rs.html">src/client.rs</a> b/<a href="../file/src/client.rs.html">src/client.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -1,6 +1,7 @@
</a> use std::io::Write as _;
 
 use crate::encoding::Value as _;
<a href="#h3-0-3" id="h3-0-3" class="i">+use crate::errdata;
</a> use crate::error::{Error, Result};
 use crate::server::{Request, Response, Status};
 use crate::sql::execution::ResultSet;
<a href="#h3-1" id="h3-1" class="h">@@ -35,7 +36,7 @@ impl Client {
</a>     pub fn execute(&amp;mut self, query: &amp;str) -&gt; Result&lt;ResultSet&gt; {
         let mut resultset = match self.call(Request::Execute(query.into()))? {
             Response::Execute(rs) =&gt; rs,
<a href="#h3-1-3" id="h3-1-3" class="d">-            resp =&gt; return Err(Error::Internal(format!(&quot;Unexpected response {:?}&quot;, resp))),
</a><a href="#h3-1-4" id="h3-1-4" class="i">+            response =&gt; return errdata!(&quot;unexpected response {response:?}&quot;),
</a>         };
         if let ResultSet::Query { columns, .. } = resultset {
             // FIXME We buffer rows for now to avoid lifetime hassles
<a href="#h3-2" id="h3-2" class="h">@@ -44,9 +45,7 @@ impl Client {
</a>                 match Result::&lt;Response&gt;::decode_from(&amp;mut self.reader)?? {
                     Response::Row(Some(row)) =&gt; rows.push(row),
                     Response::Row(None) =&gt; break,
<a href="#h3-2-3" id="h3-2-3" class="d">-                    response =&gt; {
</a><a href="#h3-2-4" id="h3-2-4" class="d">-                        return Err(Error::Internal(format!(&quot;Unexpected response {:?}&quot;, response)))
</a><a href="#h3-2-5" id="h3-2-5" class="d">-                    }
</a><a href="#h3-2-6" id="h3-2-6" class="i">+                    response =&gt; return errdata!(&quot;unexpected response {response:?}&quot;),
</a>                 }
             }
             resultset = ResultSet::Query { columns, rows: Box::new(rows.into_iter().map(Ok)) }
<a href="#h3-3" id="h3-3" class="h">@@ -64,7 +63,7 @@ impl Client {
</a>     pub fn get_table(&amp;mut self, table: &amp;str) -&gt; Result&lt;Table&gt; {
         match self.call(Request::GetTable(table.into()))? {
             Response::GetTable(t) =&gt; Ok(t),
<a href="#h3-3-3" id="h3-3-3" class="d">-            resp =&gt; Err(Error::Value(format!(&quot;Unexpected response: {:?}&quot;, resp))),
</a><a href="#h3-3-4" id="h3-3-4" class="i">+            resp =&gt; errdata!(&quot;unexpected response: {resp:?}&quot;),
</a>         }
     }
 
<a href="#h3-4" id="h3-4" class="h">@@ -72,7 +71,7 @@ impl Client {
</a>     pub fn list_tables(&amp;mut self) -&gt; Result&lt;Vec&lt;String&gt;&gt; {
         match self.call(Request::ListTables)? {
             Response::ListTables(t) =&gt; Ok(t),
<a href="#h3-4-3" id="h3-4-3" class="d">-            resp =&gt; Err(Error::Value(format!(&quot;Unexpected response: {:?}&quot;, resp))),
</a><a href="#h3-4-4" id="h3-4-4" class="i">+            resp =&gt; errdata!(&quot;unexpected response: {resp:?}&quot;),
</a>         }
     }
 
<a href="#h3-5" id="h3-5" class="h">@@ -80,7 +79,7 @@ impl Client {
</a>     pub fn status(&amp;mut self) -&gt; Result&lt;Status&gt; {
         match self.call(Request::Status)? {
             Response::Status(s) =&gt; Ok(s),
<a href="#h3-5-3" id="h3-5-3" class="d">-            resp =&gt; Err(Error::Value(format!(&quot;Unexpected response: {:?}&quot;, resp))),
</a><a href="#h3-5-4" id="h3-5-4" class="i">+            resp =&gt; errdata!(&quot;unexpected response: {resp:?}&quot;),
</a>         }
     }
 
<b>diff --git a/<a id="h4" href="../file/src/encoding/bincode.rs.html">src/encoding/bincode.rs</a> b/<a href="../file/src/encoding/bincode.rs.html">src/encoding/bincode.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -10,7 +10,7 @@
</a> 
 use crate::error::{Error, Result};
 
<a href="#h4-0-3" id="h4-0-3" class="d">-use bincode::Options;
</a><a href="#h4-0-4" id="h4-0-4" class="i">+use bincode::Options as _;
</a> 
 /// Returns the default Bincode options, initialized on first use.
 fn bincode() -&gt; &amp;&#39;static bincode::DefaultOptions {
<b>diff --git a/<a id="h5" href="../file/src/encoding/keycode.rs.html">src/encoding/keycode.rs</a> b/<a href="../file/src/encoding/keycode.rs.html">src/encoding/keycode.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -48,6 +48,7 @@ use de::IntoDeserializer;
</a> use serde::{de, ser};
 
 use crate::error::{Error, Result};
<a href="#h5-0-3" id="h5-0-3" class="i">+use crate::{errassert, errdata};
</a> 
 // Serializes a key to a binary KeyCode representation.
 pub fn serialize&lt;T: serde::Serialize&gt;(key: &amp;T) -&gt; Result&lt;Vec&lt;u8&gt;&gt; {
<a href="#h5-1" id="h5-1" class="h">@@ -61,10 +62,10 @@ pub fn deserialize&lt;&#39;a, T: serde::Deserialize&lt;&#39;a&gt;&gt;(input: &amp;&#39;a [u8]) -&gt; Result&lt;T&gt; 
</a>     let mut deserializer = Deserializer::from_bytes(input);
     let t = T::deserialize(&amp;mut deserializer)?;
     if !deserializer.input.is_empty() {
<a href="#h5-1-3" id="h5-1-3" class="d">-        return Err(Error::Internal(format!(
</a><a href="#h5-1-4" id="h5-1-4" class="d">-            &quot;Unexpected trailing bytes {:x?} at end of key {:x?}&quot;,
</a><a href="#h5-1-5" id="h5-1-5" class="d">-            deserializer.input, input
</a><a href="#h5-1-6" id="h5-1-6" class="d">-        )));
</a><a href="#h5-1-7" id="h5-1-7" class="i">+        return errdata!(
</a><a href="#h5-1-8" id="h5-1-8" class="i">+            &quot;unexpected trailing bytes {:x?} at end of key {input:x?}&quot;,
</a><a href="#h5-1-9" id="h5-1-9" class="i">+            deserializer.input,
</a><a href="#h5-1-10" id="h5-1-10" class="i">+        );
</a>     }
     Ok(t)
 }
<a href="#h5-2" id="h5-2" class="h">@@ -329,10 +330,7 @@ impl&lt;&#39;de&gt; Deserializer&lt;&#39;de&gt; {
</a>     // there aren&#39;t enough bytes left.
     fn take_bytes(&amp;mut self, len: usize) -&gt; Result&lt;&amp;[u8]&gt; {
         if self.input.len() &lt; len {
<a href="#h5-2-3" id="h5-2-3" class="d">-            return Err(Error::Internal(format!(
</a><a href="#h5-2-4" id="h5-2-4" class="d">-                &quot;Insufficient bytes, expected {} bytes for {:x?}&quot;,
</a><a href="#h5-2-5" id="h5-2-5" class="d">-                len, self.input
</a><a href="#h5-2-6" id="h5-2-6" class="d">-            )));
</a><a href="#h5-2-7" id="h5-2-7" class="i">+            return errdata!(&quot;insufficient bytes, expected {len} bytes for {:x?}&quot;, self.input);
</a>         }
         let bytes = &amp;self.input[..len];
         self.input = &amp;self.input[len..];
<a href="#h5-3" id="h5-3" class="h">@@ -351,10 +349,10 @@ impl&lt;&#39;de&gt; Deserializer&lt;&#39;de&gt; {
</a>                 Some((_, 0x00)) =&gt; match iter.next() {
                     Some((i, 0x00)) =&gt; break i + 1,        // terminator
                     Some((_, 0xff)) =&gt; decoded.push(0x00), // escaped 0x00
<a href="#h5-3-3" id="h5-3-3" class="d">-                    _ =&gt; return Err(Error::Value(&quot;Invalid escape sequence&quot;.to_string())),
</a><a href="#h5-3-4" id="h5-3-4" class="i">+                    _ =&gt; return errdata!(&quot;invalid escape sequence&quot;),
</a>                 },
                 Some((_, b)) =&gt; decoded.push(*b),
<a href="#h5-3-7" id="h5-3-7" class="d">-                None =&gt; return Err(Error::Value(&quot;Unexpected end of input&quot;.to_string())),
</a><a href="#h5-3-8" id="h5-3-8" class="i">+                None =&gt; return errdata!(&quot;unexpected end of input&quot;),
</a>             }
         };
         self.input = &amp;self.input[taken..];
<a href="#h5-4" id="h5-4" class="h">@@ -367,14 +365,14 @@ impl&lt;&#39;de, &#39;a&gt; serde::Deserializer&lt;&#39;de&gt; for &amp;&#39;a mut Deserializer&lt;&#39;de&gt; {
</a>     type Error = Error;
 
     fn deserialize_any&lt;V: de::Visitor&lt;&#39;de&gt;&gt;(self, _: V) -&gt; Result&lt;V::Value&gt; {
<a href="#h5-4-3" id="h5-4-3" class="d">-        Err(Error::Internal(&quot;Must provide type, KeyCode is not self-describing&quot;.to_string()))
</a><a href="#h5-4-4" id="h5-4-4" class="i">+        errassert!(&quot;must provide type, KeyCode is not self-describing&quot;)
</a>     }
 
     fn deserialize_bool&lt;V: de::Visitor&lt;&#39;de&gt;&gt;(self, visitor: V) -&gt; Result&lt;V::Value&gt; {
         visitor.visit_bool(match self.take_bytes(1)?[0] {
             0x00 =&gt; false,
             0x01 =&gt; true,
<a href="#h5-4-11" id="h5-4-11" class="d">-            b =&gt; return Err(Error::Internal(format!(&quot;Invalid boolean value {:?}&quot;, b))),
</a><a href="#h5-4-12" id="h5-4-12" class="i">+            b =&gt; return errdata!(&quot;Invalid boolean value {b:?}&quot;),
</a>         })
     }
 
<b>diff --git a/<a id="h6" href="../file/src/error.rs.html">src/error.rs</a> b/<a href="../file/src/error.rs.html">src/error.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,30 +1,69 @@
</a> use serde_derive::{Deserialize, Serialize};
 
<a href="#h6-0-2" id="h6-0-2" class="d">-/// Result returning Error.
</a><a href="#h6-0-3" id="h6-0-3" class="d">-pub type Result&lt;T&gt; = std::result::Result&lt;T, Error&gt;;
</a><a href="#h6-0-4" id="h6-0-4" class="d">-
</a><a href="#h6-0-5" id="h6-0-5" class="d">-impl&lt;T&gt; From&lt;Error&gt; for Result&lt;T&gt; {
</a><a href="#h6-0-6" id="h6-0-6" class="d">-    fn from(error: Error) -&gt; Self {
</a><a href="#h6-0-7" id="h6-0-7" class="d">-        Err(error)
</a><a href="#h6-0-8" id="h6-0-8" class="d">-    }
</a><a href="#h6-0-9" id="h6-0-9" class="d">-}
</a><a href="#h6-0-10" id="h6-0-10" class="d">-
</a><a href="#h6-0-11" id="h6-0-11" class="d">-/// toyDB errors. All except Internal are considered user-facing.
</a><a href="#h6-0-12" id="h6-0-12" class="d">-///
</a><a href="#h6-0-13" id="h6-0-13" class="d">-/// TODO: simplify these. Add an IO kind that is used to signal Raft application
</a><a href="#h6-0-14" id="h6-0-14" class="d">-/// failure.
</a><a href="#h6-0-15" id="h6-0-15" class="i">+/// toyDB errors.
</a> #[derive(Clone, Debug, PartialEq, Serialize, Deserialize)]
 pub enum Error {
<a href="#h6-0-18" id="h6-0-18" class="i">+    /// The operation was aborted and must be retried. This typically happens
</a><a href="#h6-0-19" id="h6-0-19" class="i">+    /// with e.g. Raft leader changes.
</a>     Abort,
<a href="#h6-0-21" id="h6-0-21" class="d">-    Assert(String), // TODO include backtrace
</a><a href="#h6-0-22" id="h6-0-22" class="d">-    Config(String), // TODO replace with Input
</a><a href="#h6-0-23" id="h6-0-23" class="d">-    /// Invalid data, typically decoding errors.
</a><a href="#h6-0-24" id="h6-0-24" class="i">+    /// An assertion failure. Should never happen.
</a><a href="#h6-0-25" id="h6-0-25" class="i">+    /// TODO: include backtrace.
</a><a href="#h6-0-26" id="h6-0-26" class="i">+    Assert(String),
</a><a href="#h6-0-27" id="h6-0-27" class="i">+    /// Invalid data, typically decoding errors or unexpected internal values.
</a>     InvalidData(String),
<a href="#h6-0-29" id="h6-0-29" class="d">-    Internal(String), // TODO remove?
</a><a href="#h6-0-30" id="h6-0-30" class="d">-    Parse(String),    // TODO replace with Input
</a><a href="#h6-0-31" id="h6-0-31" class="i">+    /// Invalid user input, typically parser or query errors.
</a><a href="#h6-0-32" id="h6-0-32" class="i">+    InvalidInput(String),
</a><a href="#h6-0-33" id="h6-0-33" class="i">+    /// An IO error.
</a><a href="#h6-0-34" id="h6-0-34" class="i">+    IO(String),
</a><a href="#h6-0-35" id="h6-0-35" class="i">+    /// A write was attempted in a read-only transaction.
</a>     ReadOnly,
<a href="#h6-0-37" id="h6-0-37" class="i">+    /// A write transaction conflicted with a different writer and lost. The
</a><a href="#h6-0-38" id="h6-0-38" class="i">+    /// transaction must be retried.
</a>     Serialization,
<a href="#h6-0-40" id="h6-0-40" class="d">-    Value(String), // TODO replace with Input or Data
</a><a href="#h6-0-41" id="h6-0-41" class="i">+}
</a><a href="#h6-0-42" id="h6-0-42" class="i">+
</a><a href="#h6-0-43" id="h6-0-43" class="i">+impl std::error::Error for Error {}
</a><a href="#h6-0-44" id="h6-0-44" class="i">+
</a><a href="#h6-0-45" id="h6-0-45" class="i">+impl std::fmt::Display for Error {
</a><a href="#h6-0-46" id="h6-0-46" class="i">+    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter) -&gt; std::fmt::Result {
</a><a href="#h6-0-47" id="h6-0-47" class="i">+        match self {
</a><a href="#h6-0-48" id="h6-0-48" class="i">+            Error::Abort =&gt; write!(f, &quot;operation aborted&quot;),
</a><a href="#h6-0-49" id="h6-0-49" class="i">+            Error::Assert(msg) =&gt; write!(f, &quot;assertion failed: {msg}&quot;),
</a><a href="#h6-0-50" id="h6-0-50" class="i">+            Error::InvalidData(msg) =&gt; write!(f, &quot;invalid data: {msg}&quot;),
</a><a href="#h6-0-51" id="h6-0-51" class="i">+            Error::InvalidInput(msg) =&gt; write!(f, &quot;invalid input: {msg}&quot;),
</a><a href="#h6-0-52" id="h6-0-52" class="i">+            Error::IO(msg) =&gt; write!(f, &quot;io error: {msg}&quot;),
</a><a href="#h6-0-53" id="h6-0-53" class="i">+            Error::ReadOnly =&gt; write!(f, &quot;read-only transaction&quot;),
</a><a href="#h6-0-54" id="h6-0-54" class="i">+            Error::Serialization =&gt; write!(f, &quot;serialization failure, retry transaction&quot;),
</a><a href="#h6-0-55" id="h6-0-55" class="i">+        }
</a><a href="#h6-0-56" id="h6-0-56" class="i">+    }
</a><a href="#h6-0-57" id="h6-0-57" class="i">+}
</a><a href="#h6-0-58" id="h6-0-58" class="i">+
</a><a href="#h6-0-59" id="h6-0-59" class="i">+impl Error {
</a><a href="#h6-0-60" id="h6-0-60" class="i">+    /// Returns whether the error is considered deterministic. State machine
</a><a href="#h6-0-61" id="h6-0-61" class="i">+    /// application needs to know whether a command failure is deterministic on
</a><a href="#h6-0-62" id="h6-0-62" class="i">+    /// the input command -- if it is, the command can be considered applied and
</a><a href="#h6-0-63" id="h6-0-63" class="i">+    /// the error returned to the client, but otherwise the state machine must
</a><a href="#h6-0-64" id="h6-0-64" class="i">+    /// panic to prevent replica divergence.
</a><a href="#h6-0-65" id="h6-0-65" class="i">+    pub fn is_deterministic(&amp;self) -&gt; bool {
</a><a href="#h6-0-66" id="h6-0-66" class="i">+        match self {
</a><a href="#h6-0-67" id="h6-0-67" class="i">+            // Aborts don&#39;t happen during application, only leader changes.
</a><a href="#h6-0-68" id="h6-0-68" class="i">+            Error::Abort =&gt; true,
</a><a href="#h6-0-69" id="h6-0-69" class="i">+            // Assertion failures typically indicate invariant violations or
</a><a href="#h6-0-70" id="h6-0-70" class="i">+            // data corruption, so we should assume it&#39;s unsafe to continue.
</a><a href="#h6-0-71" id="h6-0-71" class="i">+            Error::Assert(_) =&gt; false,
</a><a href="#h6-0-72" id="h6-0-72" class="i">+            // Possible data corruption local to this node.
</a><a href="#h6-0-73" id="h6-0-73" class="i">+            Error::InvalidData(_) =&gt; false,
</a><a href="#h6-0-74" id="h6-0-74" class="i">+            // Input errors are (likely) deterministic. We could employ command
</a><a href="#h6-0-75" id="h6-0-75" class="i">+            // checksums to be sure.
</a><a href="#h6-0-76" id="h6-0-76" class="i">+            Error::InvalidInput(_) =&gt; true,
</a><a href="#h6-0-77" id="h6-0-77" class="i">+            // IO errors are typically node-local.
</a><a href="#h6-0-78" id="h6-0-78" class="i">+            Error::IO(_) =&gt; false,
</a><a href="#h6-0-79" id="h6-0-79" class="i">+            // Write commands in read-only transactions are deterministic.
</a><a href="#h6-0-80" id="h6-0-80" class="i">+            Error::ReadOnly =&gt; true,
</a><a href="#h6-0-81" id="h6-0-81" class="i">+            // Write conflicts are determinstic.
</a><a href="#h6-0-82" id="h6-0-82" class="i">+            Error::Serialization =&gt; true,
</a><a href="#h6-0-83" id="h6-0-83" class="i">+        }
</a><a href="#h6-0-84" id="h6-0-84" class="i">+    }
</a> }
 
 /// Constructs an Error::Assert via format!() and into().
<a href="#h6-1" id="h6-1" class="h">@@ -39,7 +78,14 @@ macro_rules! errdata {
</a>     ($($args:tt)*) =&gt; { $crate::error::Error::InvalidData(format!($($args)*)).into() };
 }
 
<a href="#h6-1-3" id="h6-1-3" class="i">+/// Constructs an Error::InvalidInput via format!() and into().
</a><a href="#h6-1-4" id="h6-1-4" class="i">+#[macro_export]
</a><a href="#h6-1-5" id="h6-1-5" class="i">+macro_rules! errinput {
</a><a href="#h6-1-6" id="h6-1-6" class="i">+    ($($args:tt)*) =&gt; { $crate::error::Error::InvalidInput(format!($($args)*)).into() };
</a><a href="#h6-1-7" id="h6-1-7" class="i">+}
</a><a href="#h6-1-8" id="h6-1-8" class="i">+
</a> /// Returns an Error::Assert if the given condition is false.
<a href="#h6-1-10" id="h6-1-10" class="i">+/// TODO: use this instead of assert! where appropriate.
</a> #[macro_export]
 macro_rules! asserterr {
     ($cond:expr, $($args:tt)*) =&gt; {
<a href="#h6-2" id="h6-2" class="h">@@ -47,33 +93,22 @@ macro_rules! asserterr {
</a>     };
 }
 
<a href="#h6-2-3" id="h6-2-3" class="d">-impl std::error::Error for Error {}
</a><a href="#h6-2-4" id="h6-2-4" class="i">+/// Result returning Error.
</a><a href="#h6-2-5" id="h6-2-5" class="i">+pub type Result&lt;T&gt; = std::result::Result&lt;T, Error&gt;;
</a> 
<a href="#h6-2-7" id="h6-2-7" class="d">-impl std::fmt::Display for Error {
</a><a href="#h6-2-8" id="h6-2-8" class="d">-    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter) -&gt; std::fmt::Result {
</a><a href="#h6-2-9" id="h6-2-9" class="d">-        match self {
</a><a href="#h6-2-10" id="h6-2-10" class="d">-            Error::Config(s)
</a><a href="#h6-2-11" id="h6-2-11" class="d">-            | Error::InvalidData(s)
</a><a href="#h6-2-12" id="h6-2-12" class="d">-            | Error::Internal(s)
</a><a href="#h6-2-13" id="h6-2-13" class="d">-            | Error::Parse(s)
</a><a href="#h6-2-14" id="h6-2-14" class="d">-            | Error::Value(s) =&gt; {
</a><a href="#h6-2-15" id="h6-2-15" class="d">-                write!(f, &quot;{}&quot;, s)
</a><a href="#h6-2-16" id="h6-2-16" class="d">-            }
</a><a href="#h6-2-17" id="h6-2-17" class="d">-            Error::Assert(s) =&gt; write!(f, &quot;assertion failed: {s}&quot;),
</a><a href="#h6-2-18" id="h6-2-18" class="d">-            Error::Abort =&gt; write!(f, &quot;Operation aborted&quot;),
</a><a href="#h6-2-19" id="h6-2-19" class="d">-            Error::Serialization =&gt; write!(f, &quot;Serialization failure, retry transaction&quot;),
</a><a href="#h6-2-20" id="h6-2-20" class="d">-            Error::ReadOnly =&gt; write!(f, &quot;Read-only transaction&quot;),
</a><a href="#h6-2-21" id="h6-2-21" class="d">-        }
</a><a href="#h6-2-22" id="h6-2-22" class="i">+impl&lt;T&gt; From&lt;Error&gt; for Result&lt;T&gt; {
</a><a href="#h6-2-23" id="h6-2-23" class="i">+    fn from(error: Error) -&gt; Self {
</a><a href="#h6-2-24" id="h6-2-24" class="i">+        Err(error)
</a>     }
 }
 
<a href="#h6-2-28" id="h6-2-28" class="d">-impl serde::ser::Error for Error {
</a><a href="#h6-2-29" id="h6-2-29" class="i">+impl serde::de::Error for Error {
</a>     fn custom&lt;T: std::fmt::Display&gt;(msg: T) -&gt; Self {
         Error::InvalidData(msg.to_string())
     }
 }
 
<a href="#h6-2-35" id="h6-2-35" class="d">-impl serde::de::Error for Error {
</a><a href="#h6-2-36" id="h6-2-36" class="i">+impl serde::ser::Error for Error {
</a>     fn custom&lt;T: std::fmt::Display&gt;(msg: T) -&gt; Self {
         Error::InvalidData(msg.to_string())
     }
<a href="#h6-3" id="h6-3" class="h">@@ -87,120 +122,110 @@ impl From&lt;Box&lt;bincode::ErrorKind&gt;&gt; for Error {
</a> 
 impl From&lt;config::ConfigError&gt; for Error {
     fn from(err: config::ConfigError) -&gt; Self {
<a href="#h6-3-3" id="h6-3-3" class="d">-        Error::Config(err.to_string())
</a><a href="#h6-3-4" id="h6-3-4" class="i">+        Error::InvalidInput(err.to_string())
</a>     }
 }
 
 impl From&lt;crossbeam::channel::RecvError&gt; for Error {
     fn from(err: crossbeam::channel::RecvError) -&gt; Self {
<a href="#h6-3-10" id="h6-3-10" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-11" id="h6-3-11" class="i">+        Error::IO(err.to_string())
</a>     }
 }
 
 impl&lt;T&gt; From&lt;crossbeam::channel::SendError&lt;T&gt;&gt; for Error {
     fn from(err: crossbeam::channel::SendError&lt;T&gt;) -&gt; Self {
<a href="#h6-3-17" id="h6-3-17" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-18" id="h6-3-18" class="i">+        Error::IO(err.to_string())
</a>     }
 }
 
 impl From&lt;crossbeam::channel::TryRecvError&gt; for Error {
     fn from(err: crossbeam::channel::TryRecvError) -&gt; Self {
<a href="#h6-3-24" id="h6-3-24" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-25" id="h6-3-25" class="i">+        Error::IO(err.to_string())
</a>     }
 }
 
 impl&lt;T&gt; From&lt;crossbeam::channel::TrySendError&lt;T&gt;&gt; for Error {
     fn from(err: crossbeam::channel::TrySendError&lt;T&gt;) -&gt; Self {
<a href="#h6-3-31" id="h6-3-31" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-32" id="h6-3-32" class="i">+        Error::IO(err.to_string())
</a>     }
 }
 
 impl From&lt;hdrhistogram::CreationError&gt; for Error {
     fn from(err: hdrhistogram::CreationError) -&gt; Self {
<a href="#h6-3-38" id="h6-3-38" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-39" id="h6-3-39" class="i">+        Error::Assert(err.to_string())
</a>     }
 }
 
 impl From&lt;hdrhistogram::RecordError&gt; for Error {
     fn from(err: hdrhistogram::RecordError) -&gt; Self {
<a href="#h6-3-45" id="h6-3-45" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-46" id="h6-3-46" class="d">-    }
</a><a href="#h6-3-47" id="h6-3-47" class="d">-}
</a><a href="#h6-3-48" id="h6-3-48" class="d">-
</a><a href="#h6-3-49" id="h6-3-49" class="d">-impl From&lt;hex::FromHexError&gt; for Error {
</a><a href="#h6-3-50" id="h6-3-50" class="d">-    fn from(err: hex::FromHexError) -&gt; Self {
</a><a href="#h6-3-51" id="h6-3-51" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-52" id="h6-3-52" class="i">+        Error::InvalidInput(err.to_string())
</a>     }
 }
 
 impl From&lt;log::ParseLevelError&gt; for Error {
     fn from(err: log::ParseLevelError) -&gt; Self {
<a href="#h6-3-58" id="h6-3-58" class="d">-        Error::Config(err.to_string())
</a><a href="#h6-3-59" id="h6-3-59" class="i">+        Error::InvalidInput(err.to_string())
</a>     }
 }
 
 impl From&lt;log::SetLoggerError&gt; for Error {
     fn from(err: log::SetLoggerError) -&gt; Self {
<a href="#h6-3-65" id="h6-3-65" class="d">-        Error::Config(err.to_string())
</a><a href="#h6-3-66" id="h6-3-66" class="i">+        Error::Assert(err.to_string())
</a>     }
 }
 
 impl From&lt;regex::Error&gt; for Error {
     fn from(err: regex::Error) -&gt; Self {
<a href="#h6-3-72" id="h6-3-72" class="d">-        Error::Value(err.to_string())
</a><a href="#h6-3-73" id="h6-3-73" class="i">+        Error::Assert(err.to_string())
</a>     }
 }
 
 impl From&lt;rustyline::error::ReadlineError&gt; for Error {
     fn from(err: rustyline::error::ReadlineError) -&gt; Self {
<a href="#h6-3-79" id="h6-3-79" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-80" id="h6-3-80" class="i">+        Error::IO(err.to_string())
</a>     }
 }
 
 impl From&lt;std::array::TryFromSliceError&gt; for Error {
     fn from(err: std::array::TryFromSliceError) -&gt; Self {
<a href="#h6-3-86" id="h6-3-86" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-87" id="h6-3-87" class="d">-    }
</a><a href="#h6-3-88" id="h6-3-88" class="d">-}
</a><a href="#h6-3-89" id="h6-3-89" class="d">-
</a><a href="#h6-3-90" id="h6-3-90" class="d">-impl From&lt;std::num::TryFromIntError&gt; for Error {
</a><a href="#h6-3-91" id="h6-3-91" class="d">-    fn from(err: std::num::TryFromIntError) -&gt; Self {
</a><a href="#h6-3-92" id="h6-3-92" class="d">-        Error::Value(err.to_string())
</a><a href="#h6-3-93" id="h6-3-93" class="i">+        Error::InvalidData(err.to_string())
</a>     }
 }
 
 impl From&lt;std::io::Error&gt; for Error {
     fn from(err: std::io::Error) -&gt; Self {
<a href="#h6-3-99" id="h6-3-99" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-100" id="h6-3-100" class="d">-    }
</a><a href="#h6-3-101" id="h6-3-101" class="d">-}
</a><a href="#h6-3-102" id="h6-3-102" class="d">-
</a><a href="#h6-3-103" id="h6-3-103" class="d">-impl From&lt;std::net::AddrParseError&gt; for Error {
</a><a href="#h6-3-104" id="h6-3-104" class="d">-    fn from(err: std::net::AddrParseError) -&gt; Self {
</a><a href="#h6-3-105" id="h6-3-105" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-106" id="h6-3-106" class="i">+        Error::IO(err.to_string())
</a>     }
 }
 
 impl From&lt;std::num::ParseFloatError&gt; for Error {
     fn from(err: std::num::ParseFloatError) -&gt; Self {
<a href="#h6-3-112" id="h6-3-112" class="d">-        Error::Parse(err.to_string())
</a><a href="#h6-3-113" id="h6-3-113" class="i">+        Error::InvalidInput(err.to_string())
</a>     }
 }
 
 impl From&lt;std::num::ParseIntError&gt; for Error {
     fn from(err: std::num::ParseIntError) -&gt; Self {
<a href="#h6-3-119" id="h6-3-119" class="d">-        Error::Parse(err.to_string())
</a><a href="#h6-3-120" id="h6-3-120" class="i">+        Error::InvalidInput(err.to_string())
</a><a href="#h6-3-121" id="h6-3-121" class="i">+    }
</a><a href="#h6-3-122" id="h6-3-122" class="i">+}
</a><a href="#h6-3-123" id="h6-3-123" class="i">+
</a><a href="#h6-3-124" id="h6-3-124" class="i">+impl From&lt;std::num::TryFromIntError&gt; for Error {
</a><a href="#h6-3-125" id="h6-3-125" class="i">+    fn from(err: std::num::TryFromIntError) -&gt; Self {
</a><a href="#h6-3-126" id="h6-3-126" class="i">+        Error::InvalidData(err.to_string())
</a>     }
 }
 
 impl From&lt;std::string::FromUtf8Error&gt; for Error {
     fn from(err: std::string::FromUtf8Error) -&gt; Self {
<a href="#h6-3-132" id="h6-3-132" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-133" id="h6-3-133" class="i">+        Error::InvalidData(err.to_string())
</a>     }
 }
 
 impl&lt;T&gt; From&lt;std::sync::PoisonError&lt;T&gt;&gt; for Error {
     fn from(err: std::sync::PoisonError&lt;T&gt;) -&gt; Self {
<a href="#h6-3-139" id="h6-3-139" class="d">-        Error::Internal(err.to_string())
</a><a href="#h6-3-140" id="h6-3-140" class="i">+        // This only happens when a different thread panics while holding a
</a><a href="#h6-3-141" id="h6-3-141" class="i">+        // mutex. This should be fatal, so we panic here too.
</a><a href="#h6-3-142" id="h6-3-142" class="i">+        panic!(&quot;{err}&quot;)
</a>     }
 }
<b>diff --git a/<a id="h7" href="../file/src/raft/node.rs.html">src/raft/node.rs</a> b/<a href="../file/src/raft/node.rs.html">src/raft/node.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -173,12 +173,8 @@ impl&lt;R: Role&gt; RawNode&lt;R&gt; {
</a> 
         let mut scan = log.scan((applied_index + 1)..=commit_index)?;
         while let Some(entry) = scan.next().transpose()? {
<a href="#h7-0-3" id="h7-0-3" class="d">-            let index = entry.index;
</a>             debug!(&quot;Applying {:?}&quot;, entry);
<a href="#h7-0-5" id="h7-0-5" class="d">-            match state.apply(entry) {
</a><a href="#h7-0-6" id="h7-0-6" class="d">-                Err(error @ Error::Internal(_)) =&gt; return Err(error),
</a><a href="#h7-0-7" id="h7-0-7" class="d">-                result =&gt; on_apply(index, result)?,
</a><a href="#h7-0-8" id="h7-0-8" class="d">-            }
</a><a href="#h7-0-9" id="h7-0-9" class="i">+            on_apply(entry.index, state.apply(entry))?;
</a>         }
         Ok(())
     }
<a href="#h7-1" id="h7-1" class="h">@@ -1108,6 +1104,7 @@ fn quorum_value&lt;T: Ord + Copy&gt;(mut values: Vec&lt;T&gt;) -&gt; T {
</a> mod tests {
     use super::*;
     use crate::encoding::{self, bincode, Value as _};
<a href="#h7-1-3" id="h7-1-3" class="i">+    use crate::errassert;
</a>     use crate::raft::{
         Entry, Request, RequestID, Response, ELECTION_TIMEOUT_RANGE, HEARTBEAT_INTERVAL,
     };
<a href="#h7-2" id="h7-2" class="h">@@ -1347,9 +1344,7 @@ mod tests {
</a>                     Ok(node.into())
                 }
                 Node::Follower(node) =&gt; Ok(node.into_candidate()?.into()),
<a href="#h7-2-3" id="h7-2-3" class="d">-                Node::Leader(node) =&gt; {
</a><a href="#h7-2-4" id="h7-2-4" class="d">-                    Err(crate::error::Error::Internal(format!(&quot;{} is a leader&quot;, node.id)))
</a><a href="#h7-2-5" id="h7-2-5" class="d">-                }
</a><a href="#h7-2-6" id="h7-2-6" class="i">+                Node::Leader(node) =&gt; errassert!(&quot;{} is a leader&quot;, node.id),
</a>             };
             for id in ids.iter().copied() {
                 self.transition(id, campaign, output)?;
<b>diff --git a/<a id="h8" href="../file/src/raft/testscripts/node/append_conflict_divergent.html">src/raft/testscripts/node/append_conflict_divergent</a> b/<a href="../file/src/raft/testscripts/node/append_conflict_divergent.html">src/raft/testscripts/node/append_conflict_divergent</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -113,23 +113,23 @@ deliver 1 2
</a> ---
 n1@1 leader ⇨ n1@4 follower(n5)
 n1@1 → c1 ClientResponse id=0x04 Error::Abort
<a href="#h8-0-3" id="h8-0-3" class="d">-c1@1 put a=1 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-4" id="h8-0-4" class="i">+c1@1 put a=1 ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x05 Error::Abort
<a href="#h8-0-6" id="h8-0-6" class="d">-c1@1 put a=2 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-7" id="h8-0-7" class="i">+c1@1 put a=2 ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x06 Error::Abort
<a href="#h8-0-9" id="h8-0-9" class="d">-c1@1 put a=3 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-10" id="h8-0-10" class="i">+c1@1 put a=3 ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x07 Error::Abort
<a href="#h8-0-12" id="h8-0-12" class="d">-c1@1 put a=4 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-13" id="h8-0-13" class="i">+c1@1 put a=4 ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x08 Error::Abort
<a href="#h8-0-15" id="h8-0-15" class="d">-c1@1 put a=5 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-16" id="h8-0-16" class="i">+c1@1 put a=5 ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x09 Error::Abort
<a href="#h8-0-18" id="h8-0-18" class="d">-c1@1 put a=6 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-19" id="h8-0-19" class="i">+c1@1 put a=6 ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x0a Error::Abort
<a href="#h8-0-21" id="h8-0-21" class="d">-c1@1 put a=7 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-22" id="h8-0-22" class="i">+c1@1 put a=7 ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x0b Error::Abort
<a href="#h8-0-24" id="h8-0-24" class="d">-c1@1 put a=8 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-25" id="h8-0-25" class="i">+c1@1 put a=8 ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x0c Error::Abort
<a href="#h8-0-27" id="h8-0-27" class="d">-c1@1 put a=9 ⇒ Error::Abort (Operation aborted)
</a><a href="#h8-0-28" id="h8-0-28" class="i">+c1@1 put a=9 ⇒ Error::Abort (operation aborted)
</a> n1@4 → n5 AppendResponse last=10@1 reject=true
 n2@1 follower(n1) ⇨ n2@4 follower(n5)
 n2@4 → n5 AppendResponse last=10@1 reject=true
<b>diff --git a/<a id="h9" href="../file/src/raft/testscripts/node/append_conflict_replace_term.html">src/raft/testscripts/node/append_conflict_replace_term</a> b/<a href="../file/src/raft/testscripts/node/append_conflict_replace_term.html">src/raft/testscripts/node/append_conflict_replace_term</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -82,7 +82,7 @@ n1@1 leader ⇨ n1@2 follower(n5)
</a> n1@2 append 3@2 put b=2
 n1@2 append 4@2 put c=3
 n1@1 → c1 ClientResponse id=0x01 Error::Abort
<a href="#h9-0-3" id="h9-0-3" class="d">-c1@1 put a=1 ⇒ Error::Abort (Operation aborted)
</a><a href="#h9-0-4" id="h9-0-4" class="i">+c1@1 put a=1 ⇒ Error::Abort (operation aborted)
</a> n1@2 → n5 AppendResponse last=4@2 reject=false
 n2@1 follower(n1) ⇨ n2@2 follower(n5)
 n2@2 append 3@2 put b=2
<b>diff --git a/<a id="h10" href="../file/src/raft/testscripts/node/election_candidate_behind_leader.html">src/raft/testscripts/node/election_candidate_behind_leader</a> b/<a href="../file/src/raft/testscripts/node/election_candidate_behind_leader.html">src/raft/testscripts/node/election_candidate_behind_leader</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -55,7 +55,7 @@ n5@2 → n3 Campaign last=1@1
</a> n5@2 → n4 Campaign last=1@1
 n1@1 leader ⇨ n1@2 follower()
 n1@1 → c1 ClientResponse id=0x01 Error::Abort
<a href="#h10-0-3" id="h10-0-3" class="d">-c1@1 put foo=bar ⇒ Error::Abort (Operation aborted)
</a><a href="#h10-0-4" id="h10-0-4" class="i">+c1@1 put foo=bar ⇒ Error::Abort (operation aborted)
</a> n1@2 → n5 CampaignResponse vote=false
 n2@1 follower(n1) ⇨ n2@2 follower()
 n2@2 → n5 CampaignResponse vote=false
<b>diff --git a/<a id="h11" href="../file/src/raft/testscripts/node/request_candidate_abort.html">src/raft/testscripts/node/request_candidate_abort</a> b/<a href="../file/src/raft/testscripts/node/request_candidate_abort.html">src/raft/testscripts/node/request_candidate_abort</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -18,11 +18,11 @@ get 1 foo
</a> ---
 c1@1 → n1 ClientRequest id=0x01 read 0x0003666f6f
 n1@1 → c1 ClientResponse id=0x01 Error::Abort
<a href="#h11-0-3" id="h11-0-3" class="d">-c1@1 get foo ⇒ Error::Abort (Operation aborted)
</a><a href="#h11-0-4" id="h11-0-4" class="i">+c1@1 get foo ⇒ Error::Abort (operation aborted)
</a> 
 # A write request on n1 should be rejected.
 put 1 foo=bar
 ---
 c1@1 → n1 ClientRequest id=0x02 write 0x0103666f6f03626172
 n1@1 → c1 ClientResponse id=0x02 Error::Abort
<a href="#h11-0-11" id="h11-0-11" class="d">-c1@1 put foo=bar ⇒ Error::Abort (Operation aborted)
</a><a href="#h11-0-12" id="h11-0-12" class="i">+c1@1 put foo=bar ⇒ Error::Abort (operation aborted)
</a><b>diff --git a/<a id="h12" href="../file/src/raft/testscripts/node/request_follower_campaign_abort.html">src/raft/testscripts/node/request_follower_campaign_abort</a> b/<a href="../file/src/raft/testscripts/node/request_follower_campaign_abort.html">src/raft/testscripts/node/request_follower_campaign_abort</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -27,7 +27,7 @@ deliver 2 from=3
</a> ---
 n2@1 follower(n1) ⇨ n2@2 follower()
 n2@1 → c2 ClientResponse id=0x01 Error::Abort
<a href="#h12-0-3" id="h12-0-3" class="d">-c2@1 put foo=bar ⇒ Error::Abort (Operation aborted)
</a><a href="#h12-0-4" id="h12-0-4" class="i">+c2@1 put foo=bar ⇒ Error::Abort (operation aborted)
</a> n2@1 → c2 ClientResponse id=0x02 Error::Abort
<a href="#h12-0-6" id="h12-0-6" class="d">-c2@1 get foo ⇒ Error::Abort (Operation aborted)
</a><a href="#h12-0-7" id="h12-0-7" class="i">+c2@1 get foo ⇒ Error::Abort (operation aborted)
</a> n2@2 → n3 CampaignResponse vote=true
<b>diff --git a/<a id="h13" href="../file/src/raft/testscripts/node/request_follower_leaderless_abort.html">src/raft/testscripts/node/request_follower_leaderless_abort</a> b/<a href="../file/src/raft/testscripts/node/request_follower_leaderless_abort.html">src/raft/testscripts/node/request_follower_leaderless_abort</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -11,11 +11,11 @@ get 1 foo
</a> ---
 c1@0 → n1 ClientRequest id=0x01 read 0x0003666f6f
 n1@0 → c1 ClientResponse id=0x01 Error::Abort
<a href="#h13-0-3" id="h13-0-3" class="d">-c1@0 get foo ⇒ Error::Abort (Operation aborted)
</a><a href="#h13-0-4" id="h13-0-4" class="i">+c1@0 get foo ⇒ Error::Abort (operation aborted)
</a> 
 # A write request on n1 should be rejected.
 put 1 foo=bar
 ---
 c1@0 → n1 ClientRequest id=0x02 write 0x0103666f6f03626172
 n1@0 → c1 ClientResponse id=0x02 Error::Abort
<a href="#h13-0-11" id="h13-0-11" class="d">-c1@0 put foo=bar ⇒ Error::Abort (Operation aborted)
</a><a href="#h13-0-12" id="h13-0-12" class="i">+c1@0 put foo=bar ⇒ Error::Abort (operation aborted)
</a><b>diff --git a/<a id="h14" href="../file/src/raft/testscripts/node/request_leader_campaign_abort.html">src/raft/testscripts/node/request_leader_campaign_abort</a> b/<a href="../file/src/raft/testscripts/node/request_leader_campaign_abort.html">src/raft/testscripts/node/request_leader_campaign_abort</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -30,7 +30,7 @@ deliver 1 from=2
</a> ---
 n1@1 leader ⇨ n1@2 follower()
 n1@1 → c1 ClientResponse id=0x01 Error::Abort
<a href="#h14-0-3" id="h14-0-3" class="d">-c1@1 put foo=bar ⇒ Error::Abort (Operation aborted)
</a><a href="#h14-0-4" id="h14-0-4" class="i">+c1@1 put foo=bar ⇒ Error::Abort (operation aborted)
</a> n1@1 → c1 ClientResponse id=0x02 Error::Abort
<a href="#h14-0-6" id="h14-0-6" class="d">-c1@1 get foo ⇒ Error::Abort (Operation aborted)
</a><a href="#h14-0-7" id="h14-0-7" class="i">+c1@1 get foo ⇒ Error::Abort (operation aborted)
</a> n1@2 → n2 CampaignResponse vote=false
<b>diff --git a/<a id="h15" href="../file/src/sql/engine/kv.rs.html">src/sql/engine/kv.rs</a> b/<a href="../file/src/sql/engine/kv.rs.html">src/sql/engine/kv.rs</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -2,8 +2,9 @@ use super::super::schema::{Catalog, Table, Tables};
</a> use super::super::types::{Expression, Row, Value};
 use super::Transaction as _;
 use crate::encoding::{self, Key as _, Value as _};
<a href="#h15-0-3" id="h15-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h15-0-4" id="h15-0-4" class="i">+use crate::error::Result;
</a> use crate::storage;
<a href="#h15-0-6" id="h15-0-6" class="i">+use crate::{errdata, errinput};
</a> 
 use serde::{Deserialize, Serialize};
 use std::borrow::Cow;
<a href="#h15-1" id="h15-1" class="h">@@ -129,10 +130,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>         table.validate_row(&amp;row, self)?;
         let id = table.get_row_key(&amp;row)?;
         if self.read(&amp;table.name, &amp;id)?.is_some() {
<a href="#h15-1-3" id="h15-1-3" class="d">-            return Err(Error::Value(format!(
</a><a href="#h15-1-4" id="h15-1-4" class="d">-                &quot;Primary key {} already exists for table {}&quot;,
</a><a href="#h15-1-5" id="h15-1-5" class="d">-                id, table.name
</a><a href="#h15-1-6" id="h15-1-6" class="d">-            )));
</a><a href="#h15-1-7" id="h15-1-7" class="i">+            return errinput!(&quot;primary key {id} already exists for table {}&quot;, table.name);
</a>         }
         self.txn.set(&amp;Key::Row((&amp;table.name).into(), (&amp;id).into()).encode()?, row.encode()?)?;
 
<a href="#h15-2" id="h15-2" class="h">@@ -157,10 +155,10 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>             while let Some(row) = scan.next().transpose()? {
                 for (i, c) in &amp;cs {
                     if &amp;row[*i] == id &amp;&amp; (table.name != t.name || id != &amp;table.get_row_key(&amp;row)?) {
<a href="#h15-2-3" id="h15-2-3" class="d">-                        return Err(Error::Value(format!(
</a><a href="#h15-2-4" id="h15-2-4" class="d">-                            &quot;Primary key {} is referenced by table {} column {}&quot;,
</a><a href="#h15-2-5" id="h15-2-5" class="d">-                            id, t.name, c
</a><a href="#h15-2-6" id="h15-2-6" class="d">-                        )));
</a><a href="#h15-2-7" id="h15-2-7" class="i">+                        return errinput!(
</a><a href="#h15-2-8" id="h15-2-8" class="i">+                            &quot;primary key {id} referenced by table {} column {c}&quot;,
</a><a href="#h15-2-9" id="h15-2-9" class="i">+                            t.name
</a><a href="#h15-2-10" id="h15-2-10" class="i">+                        );
</a>                     }
                 }
             }
<a href="#h15-3" id="h15-3" class="h">@@ -188,7 +186,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a> 
     fn read_index(&amp;self, table: &amp;str, column: &amp;str, value: &amp;Value) -&gt; Result&lt;HashSet&lt;Value&gt;&gt; {
         if !self.must_read_table(table)?.get_column(column)?.index {
<a href="#h15-3-3" id="h15-3-3" class="d">-            return Err(Error::Value(format!(&quot;No index on {}.{}&quot;, table, column)));
</a><a href="#h15-3-4" id="h15-3-4" class="i">+            return errinput!(&quot;no index on {table}.{column}&quot;);
</a>         }
         self.index_load(table, column, value)
     }
<a href="#h15-4" id="h15-4" class="h">@@ -205,10 +203,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>                         Some(filter) =&gt; match filter.evaluate(Some(&amp;row)) {
                             Ok(Value::Boolean(b)) if b =&gt; Some(Ok(row)),
                             Ok(Value::Boolean(_)) | Ok(Value::Null) =&gt; None,
<a href="#h15-4-3" id="h15-4-3" class="d">-                            Ok(v) =&gt; Some(Err(Error::Value(format!(
</a><a href="#h15-4-4" id="h15-4-4" class="d">-                                &quot;Filter returned {}, expected boolean&quot;,
</a><a href="#h15-4-5" id="h15-4-5" class="d">-                                v
</a><a href="#h15-4-6" id="h15-4-6" class="d">-                            )))),
</a><a href="#h15-4-7" id="h15-4-7" class="i">+                            Ok(v) =&gt; Some(errdata!(&quot;filter returned {v}, expected boolean&quot;)),
</a>                             Err(err) =&gt; Some(Err(err)),
                         },
                         None =&gt; Some(Ok(row)),
<a href="#h15-5" id="h15-5" class="h">@@ -224,7 +219,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>         let table = self.must_read_table(table)?;
         let column = table.get_column(column)?;
         if !column.index {
<a href="#h15-5-3" id="h15-5-3" class="d">-            return Err(Error::Value(format!(&quot;No index for {}.{}&quot;, table.name, column.name)));
</a><a href="#h15-5-4" id="h15-5-4" class="i">+            return errinput!(&quot;no index for {}.{}&quot;, table.name, column.name);
</a>         }
         Ok(Box::new(
             self.txn
<a href="#h15-6" id="h15-6" class="h">@@ -236,7 +231,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a>                     let (k, v) = r?;
                     let value = match Key::decode(&amp;k)? {
                         Key::Index(_, _, pk) =&gt; pk.into_owned(),
<a href="#h15-6-3" id="h15-6-3" class="d">-                        _ =&gt; return Err(Error::Internal(&quot;Invalid index key&quot;.into())),
</a><a href="#h15-6-4" id="h15-6-4" class="i">+                        _ =&gt; return errdata!(&quot;invalid index key&quot;),
</a>                     };
                     Ok((value, HashSet::&lt;Value&gt;::decode(&amp;v)?))
                 })
<a href="#h15-7" id="h15-7" class="h">@@ -280,7 +275,7 @@ impl&lt;E: storage::Engine&gt; super::Transaction for Transaction&lt;E&gt; {
</a> impl&lt;E: storage::Engine&gt; Catalog for Transaction&lt;E&gt; {
     fn create_table(&amp;mut self, table: Table) -&gt; Result&lt;()&gt; {
         if self.read_table(&amp;table.name)?.is_some() {
<a href="#h15-7-3" id="h15-7-3" class="d">-            return Err(Error::Value(format!(&quot;Table {} already exists&quot;, table.name)));
</a><a href="#h15-7-4" id="h15-7-4" class="i">+            return errinput!(&quot;table {} already exists&quot;, table.name);
</a>         }
         table.validate(self)?;
         self.txn.set(&amp;Key::Table((&amp;table.name).into()).encode()?, table.encode()?)
<a href="#h15-8" id="h15-8" class="h">@@ -289,10 +284,7 @@ impl&lt;E: storage::Engine&gt; Catalog for Transaction&lt;E&gt; {
</a>     fn delete_table(&amp;mut self, table: &amp;str) -&gt; Result&lt;()&gt; {
         let table = self.must_read_table(table)?;
         if let Some((t, cs)) = self.table_references(&amp;table.name, false)?.first() {
<a href="#h15-8-3" id="h15-8-3" class="d">-            return Err(Error::Value(format!(
</a><a href="#h15-8-4" id="h15-8-4" class="d">-                &quot;Table {} is referenced by table {} column {}&quot;,
</a><a href="#h15-8-5" id="h15-8-5" class="d">-                table.name, t, cs[0]
</a><a href="#h15-8-6" id="h15-8-6" class="d">-            )));
</a><a href="#h15-8-7" id="h15-8-7" class="i">+            return errinput!(&quot;table {} is referenced by table {} column {}&quot;, table.name, t, cs[0]);
</a>         }
         let mut scan = self.scan(&amp;table.name, None)?;
         while let Some(row) = scan.next().transpose()? {
<b>diff --git a/<a id="h16" href="../file/src/sql/engine/mod.rs.html">src/sql/engine/mod.rs</a> b/<a href="../file/src/sql/engine/mod.rs.html">src/sql/engine/mod.rs</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -9,7 +9,8 @@ use super::parser::{ast, Parser};
</a> use super::plan::Plan;
 use super::schema::Catalog;
 use super::types::{Expression, Row, Value};
<a href="#h16-0-3" id="h16-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h16-0-4" id="h16-0-4" class="i">+use crate::errinput;
</a><a href="#h16-0-5" id="h16-0-5" class="i">+use crate::error::Result;
</a> 
 use std::collections::HashSet;
 
<a href="#h16-1" id="h16-1" class="h">@@ -77,7 +78,7 @@ impl&lt;E: Engine + &#39;static&gt; Session&lt;E&gt; {
</a>         // ...which seems like an arbitrary compiler limitation
         match Parser::new(query).parse()? {
             ast::Statement::Begin { .. } if self.txn.is_some() =&gt; {
<a href="#h16-1-3" id="h16-1-3" class="d">-                Err(Error::Value(&quot;Already in a transaction&quot;.into()))
</a><a href="#h16-1-4" id="h16-1-4" class="i">+                errinput!(&quot;already in a transaction&quot;)
</a>             }
             ast::Statement::Begin { read_only: true, as_of: None } =&gt; {
                 let txn = self.engine.begin_read_only()?;
<a href="#h16-2" id="h16-2" class="h">@@ -92,7 +93,7 @@ impl&lt;E: Engine + &#39;static&gt; Session&lt;E&gt; {
</a>                 Ok(result)
             }
             ast::Statement::Begin { read_only: false, as_of: Some(_) } =&gt; {
<a href="#h16-2-3" id="h16-2-3" class="d">-                Err(Error::Value(&quot;Can&#39;t start read-write transaction in a given version&quot;.into()))
</a><a href="#h16-2-4" id="h16-2-4" class="i">+                errinput!(&quot;can&#39;t start read-write transaction in a given version&quot;)
</a>             }
             ast::Statement::Begin { read_only: false, as_of: None } =&gt; {
                 let txn = self.engine.begin()?;
<a href="#h16-3" id="h16-3" class="h">@@ -101,7 +102,7 @@ impl&lt;E: Engine + &#39;static&gt; Session&lt;E&gt; {
</a>                 Ok(result)
             }
             ast::Statement::Commit | ast::Statement::Rollback if self.txn.is_none() =&gt; {
<a href="#h16-3-3" id="h16-3-3" class="d">-                Err(Error::Value(&quot;Not in a transaction&quot;.into()))
</a><a href="#h16-3-4" id="h16-3-4" class="i">+                errinput!(&quot;not in a transaction&quot;)
</a>             }
             ast::Statement::Commit =&gt; {
                 let txn = self.txn.take().unwrap();
<b>diff --git a/<a id="h17" href="../file/src/sql/engine/raft.rs.html">src/sql/engine/raft.rs</a> b/<a href="../file/src/sql/engine/raft.rs.html">src/sql/engine/raft.rs</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -2,7 +2,8 @@ use super::super::schema::{Catalog, Table, Tables};
</a> use super::super::types::{Expression, Row, Value};
 use super::{Engine as _, IndexScan, Scan, Transaction as _};
 use crate::encoding::{self, bincode, Value as _};
<a href="#h17-0-3" id="h17-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h17-0-4" id="h17-0-4" class="i">+use crate::errdata;
</a><a href="#h17-0-5" id="h17-0-5" class="i">+use crate::error::Result;
</a> use crate::raft::{self, Entry};
 use crate::storage::{self, mvcc::TransactionState};
 
<a href="#h17-1" id="h17-1" class="h">@@ -95,7 +96,7 @@ impl Client {
</a>     fn mutate&lt;V: DeserializeOwned&gt;(&amp;self, mutation: Mutation) -&gt; Result&lt;V&gt; {
         match self.execute(raft::Request::Write(mutation.encode()?))? {
             raft::Response::Write(response) =&gt; Ok(bincode::deserialize(&amp;response)?),
<a href="#h17-1-3" id="h17-1-3" class="d">-            resp =&gt; Err(Error::Internal(format!(&quot;Unexpected Raft mutation response {:?}&quot;, resp))),
</a><a href="#h17-1-4" id="h17-1-4" class="i">+            resp =&gt; errdata!(&quot;unexpected Raft mutation response {resp:?}&quot;),
</a>         }
     }
 
<a href="#h17-2" id="h17-2" class="h">@@ -104,7 +105,7 @@ impl Client {
</a>     fn query&lt;V: DeserializeOwned&gt;(&amp;self, query: Query) -&gt; Result&lt;V&gt; {
         match self.execute(raft::Request::Read(query.encode()?))? {
             raft::Response::Read(response) =&gt; Ok(bincode::deserialize(&amp;response)?),
<a href="#h17-2-3" id="h17-2-3" class="d">-            resp =&gt; Err(Error::Internal(format!(&quot;Unexpected Raft query response {:?}&quot;, resp))),
</a><a href="#h17-2-4" id="h17-2-4" class="i">+            resp =&gt; errdata!(&quot;unexpected Raft query response {resp:?}&quot;),
</a>         }
     }
 
<a href="#h17-3" id="h17-3" class="h">@@ -112,7 +113,7 @@ impl Client {
</a>     fn status(&amp;self) -&gt; Result&lt;raft::Status&gt; {
         match self.execute(raft::Request::Status)? {
             raft::Response::Status(status) =&gt; Ok(status),
<a href="#h17-3-3" id="h17-3-3" class="d">-            resp =&gt; Err(Error::Internal(format!(&quot;Unexpected Raft status response {:?}&quot;, resp))),
</a><a href="#h17-3-4" id="h17-3-4" class="i">+            resp =&gt; errdata!(&quot;unexpected Raft status response {resp:?}&quot;),
</a>         }
     }
 }
<a href="#h17-4" id="h17-4" class="h">@@ -344,7 +345,10 @@ impl&lt;E: storage::Engine&gt; raft::State for State&lt;E&gt; {
</a> 
         let result = match &amp;entry.command {
             Some(command) =&gt; match self.mutate(Mutation::decode(command)?) {
<a href="#h17-4-3" id="h17-4-3" class="d">-                error @ Err(Error::Internal(_)) =&gt; return error, // don&#39;t record as applied
</a><a href="#h17-4-4" id="h17-4-4" class="i">+                // We must panic on non-deterministic apply failures to prevent
</a><a href="#h17-4-5" id="h17-4-5" class="i">+                // replica divergence. See [`raft::State`] documentation for
</a><a href="#h17-4-6" id="h17-4-6" class="i">+                // details.
</a><a href="#h17-4-7" id="h17-4-7" class="i">+                Err(e) if !e.is_deterministic() =&gt; panic!(&quot;non-deterministic apply failure: {e}&quot;),
</a>                 result =&gt; result,
             },
             None =&gt; Ok(Vec::new()),
<b>diff --git a/<a id="h18" href="../file/src/sql/execution/aggregation.rs.html">src/sql/execution/aggregation.rs</a> b/<a href="../file/src/sql/execution/aggregation.rs.html">src/sql/execution/aggregation.rs</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -2,7 +2,8 @@ use super::super::engine::Transaction;
</a> use super::super::plan::Aggregate;
 use super::super::types::{Column, Value};
 use super::{Executor, ResultSet};
<a href="#h18-0-3" id="h18-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h18-0-4" id="h18-0-4" class="i">+use crate::errdata;
</a><a href="#h18-0-5" id="h18-0-5" class="i">+use crate::error::Result;
</a> 
 use std::cmp::Ordering;
 use std::collections::HashMap;
<a href="#h18-1" id="h18-1" class="h">@@ -53,7 +54,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Aggregation&lt;T&gt; {
</a>                     })),
                 })
             }
<a href="#h18-1-3" id="h18-1-3" class="d">-            r =&gt; Err(Error::Internal(format!(&quot;Unexpected result {:?}&quot;, r))),
</a><a href="#h18-1-4" id="h18-1-4" class="i">+            r =&gt; errdata!(&quot;unexpected result {r:?}&quot;),
</a>         }
     }
 }
<b>diff --git a/<a id="h19" href="../file/src/sql/execution/join.rs.html">src/sql/execution/join.rs</a> b/<a href="../file/src/sql/execution/join.rs.html">src/sql/execution/join.rs</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -1,7 +1,8 @@
</a> use super::super::engine::Transaction;
 use super::super::types::{Expression, Rows};
 use super::{Executor, ResultSet, Row, Value};
<a href="#h19-0-3" id="h19-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h19-0-4" id="h19-0-4" class="i">+use crate::errdata;
</a><a href="#h19-0-5" id="h19-0-5" class="i">+use crate::error::Result;
</a> 
 use std::collections::HashMap;
 
<a href="#h19-1" id="h19-1" class="h">@@ -46,7 +47,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for NestedLoopJoin&lt;T&gt; {
</a>                 });
             }
         }
<a href="#h19-1-3" id="h19-1-3" class="d">-        Err(Error::Internal(&quot;Unexpected result set&quot;.into()))
</a><a href="#h19-1-4" id="h19-1-4" class="i">+        errdata!(&quot;unexpected result set&quot;)
</a>     }
 }
 
<a href="#h19-2" id="h19-2" class="h">@@ -117,12 +118,7 @@ impl NestedLoopRows {
</a>                     Value::Boolean(true) =&gt; return Ok(Some(row)),
                     Value::Boolean(false) =&gt; {}
                     Value::Null =&gt; {}
<a href="#h19-2-3" id="h19-2-3" class="d">-                    value =&gt; {
</a><a href="#h19-2-4" id="h19-2-4" class="d">-                        return Err(Error::Value(format!(
</a><a href="#h19-2-5" id="h19-2-5" class="d">-                            &quot;Join predicate returned {}, expected boolean&quot;,
</a><a href="#h19-2-6" id="h19-2-6" class="d">-                            value
</a><a href="#h19-2-7" id="h19-2-7" class="d">-                        )))
</a><a href="#h19-2-8" id="h19-2-8" class="d">-                    }
</a><a href="#h19-2-9" id="h19-2-9" class="i">+                    value =&gt; return errdata!(&quot;join predicate returned {value}, expected boolean&quot;),
</a>                 }
             } else {
                 return Ok(Some(row));
<a href="#h19-3" id="h19-3" class="h">@@ -168,9 +164,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for HashJoin&lt;T&gt; {
</a>                 let (l, r, outer) = (self.left_field, self.right_field, self.outer);
                 let right: HashMap&lt;Value, Row&gt; = rrows
                     .map(|res| match res {
<a href="#h19-3-3" id="h19-3-3" class="d">-                        Ok(row) if row.len() &lt;= r =&gt; {
</a><a href="#h19-3-4" id="h19-3-4" class="d">-                            Err(Error::Internal(format!(&quot;Right index {} out of bounds&quot;, r)))
</a><a href="#h19-3-5" id="h19-3-5" class="d">-                        }
</a><a href="#h19-3-6" id="h19-3-6" class="i">+                        Ok(row) if row.len() &lt;= r =&gt; errdata!(&quot;right index {r} out of bounds&quot;),
</a>                         Ok(row) =&gt; Ok((row[r].clone(), row)),
                         Err(err) =&gt; Err(err),
                     })
<a href="#h19-4" id="h19-4" class="h">@@ -178,9 +172,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for HashJoin&lt;T&gt; {
</a>                 let empty = std::iter::repeat(Value::Null).take(rcolumns.len());
                 columns.extend(rcolumns);
                 let rows = Box::new(rows.filter_map(move |res| match res {
<a href="#h19-4-3" id="h19-4-3" class="d">-                    Ok(row) if row.len() &lt;= l =&gt; {
</a><a href="#h19-4-4" id="h19-4-4" class="d">-                        Some(Err(Error::Value(format!(&quot;Left index {} out of bounds&quot;, l))))
</a><a href="#h19-4-5" id="h19-4-5" class="d">-                    }
</a><a href="#h19-4-6" id="h19-4-6" class="i">+                    Ok(row) if row.len() &lt;= l =&gt; Some(errdata!(&quot;left index {l} out of bounds&quot;)),
</a>                     Ok(mut row) =&gt; match right.get(&amp;row[l]) {
                         Some(hit) =&gt; {
                             row.extend(hit.clone());
<a href="#h19-5" id="h19-5" class="h">@@ -197,6 +189,6 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for HashJoin&lt;T&gt; {
</a>                 return Ok(ResultSet::Query { columns, rows });
             }
         }
<a href="#h19-5-3" id="h19-5-3" class="d">-        Err(Error::Internal(&quot;Unexpected result set&quot;.into()))
</a><a href="#h19-5-4" id="h19-5-4" class="i">+        errdata!(&quot;unexpected result set&quot;)
</a>     }
 }
<b>diff --git a/<a id="h20" href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a> b/<a href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -15,7 +15,8 @@ use source::{IndexLookup, KeyLookup, Nothing, Scan};
</a> use super::engine::Transaction;
 use super::plan::Node;
 use super::types::{Columns, Row, Rows, Value};
<a href="#h20-0-3" id="h20-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h20-0-4" id="h20-0-4" class="i">+use crate::errdata;
</a><a href="#h20-0-5" id="h20-0-5" class="i">+use crate::error::Result;
</a> 
 use derivative::Derivative;
 use serde_derive::{Deserialize, Serialize};
<a href="#h20-1" id="h20-1" class="h">@@ -129,7 +130,7 @@ impl ResultSet {
</a> 
     /// Converts the ResultSet into a row, or errors if not a query result with rows.
     pub fn into_row(self) -&gt; Result&lt;Row&gt; {
<a href="#h20-1-3" id="h20-1-3" class="d">-        self.into_rows()?.next().transpose()?.ok_or_else(|| Error::Value(&quot;No rows returned&quot;.into()))
</a><a href="#h20-1-4" id="h20-1-4" class="i">+        self.into_rows()?.next().transpose()?.ok_or(errdata!(&quot;no rows returned&quot;))
</a>     }
 
     /// Converts the ResultSet into a row iterator, or errors if not a query
<a href="#h20-2" id="h20-2" class="h">@@ -138,12 +139,12 @@ impl ResultSet {
</a>         if let ResultSet::Query { rows, .. } = self {
             Ok(rows)
         } else {
<a href="#h20-2-3" id="h20-2-3" class="d">-            Err(Error::Value(format!(&quot;Not a query result: {:?}&quot;, self)))
</a><a href="#h20-2-4" id="h20-2-4" class="i">+            errdata!(&quot;not a query result: {self:?}&quot;)
</a>         }
     }
 
     /// Converts the ResultSet into a value, if possible.
     pub fn into_value(self) -&gt; Result&lt;Value&gt; {
<a href="#h20-2-10" id="h20-2-10" class="d">-        self.into_row()?.into_iter().next().ok_or_else(|| Error::Value(&quot;No value returned&quot;.into()))
</a><a href="#h20-2-11" id="h20-2-11" class="i">+        self.into_row()?.into_iter().next().ok_or(errdata!(&quot;no value returned&quot;))
</a>     }
 }
<b>diff --git a/<a id="h21" href="../file/src/sql/execution/mutation.rs.html">src/sql/execution/mutation.rs</a> b/<a href="../file/src/sql/execution/mutation.rs.html">src/sql/execution/mutation.rs</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -2,7 +2,8 @@ use super::super::engine::Transaction;
</a> use super::super::schema::Table;
 use super::super::types::{Expression, Row, Value};
 use super::{Executor, ResultSet};
<a href="#h21-0-3" id="h21-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h21-0-4" id="h21-0-4" class="i">+use crate::error::Result;
</a><a href="#h21-0-5" id="h21-0-5" class="i">+use crate::{errdata, errinput};
</a> 
 use std::collections::{HashMap, HashSet};
 
<a href="#h21-1" id="h21-1" class="h">@@ -21,13 +22,13 @@ impl Insert {
</a>     // Builds a row from a set of column names and values, padding it with default values.
     pub fn make_row(table: &amp;Table, columns: &amp;[String], values: Vec&lt;Value&gt;) -&gt; Result&lt;Row&gt; {
         if columns.len() != values.len() {
<a href="#h21-1-3" id="h21-1-3" class="d">-            return Err(Error::Value(&quot;Column and value counts do not match&quot;.into()));
</a><a href="#h21-1-4" id="h21-1-4" class="i">+            return errinput!(&quot;column and value counts do not match&quot;);
</a>         }
         let mut inputs = HashMap::new();
         for (c, v) in columns.iter().zip(values.into_iter()) {
             table.get_column(c)?;
             if inputs.insert(c.clone(), v).is_some() {
<a href="#h21-1-10" id="h21-1-10" class="d">-                return Err(Error::Value(format!(&quot;Column {} given multiple times&quot;, c)));
</a><a href="#h21-1-11" id="h21-1-11" class="i">+                return errinput!(&quot;column {c} given multiple times&quot;);
</a>             }
         }
         let mut row = Row::new();
<a href="#h21-2" id="h21-2" class="h">@@ -37,7 +38,7 @@ impl Insert {
</a>             } else if let Some(value) = &amp;column.default {
                 row.push(value.clone())
             } else {
<a href="#h21-2-3" id="h21-2-3" class="d">-                return Err(Error::Value(format!(&quot;No value given for column {}&quot;, column.name)));
</a><a href="#h21-2-4" id="h21-2-4" class="i">+                return errinput!(&quot;no value given for column {}&quot;, column.name);
</a>             }
         }
         Ok(row)
<a href="#h21-3" id="h21-3" class="h">@@ -49,7 +50,7 @@ impl Insert {
</a>             if let Some(default) = &amp;column.default {
                 row.push(default.clone())
             } else {
<a href="#h21-3-3" id="h21-3-3" class="d">-                return Err(Error::Value(format!(&quot;No default value for column {}&quot;, column.name)));
</a><a href="#h21-3-4" id="h21-3-4" class="i">+                return errinput!(&quot;no default value for column {}&quot;, column.name);
</a>             }
         }
         Ok(row)
<a href="#h21-4" id="h21-4" class="h">@@ -120,7 +121,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Update&lt;T&gt; {
</a>                 }
                 Ok(ResultSet::Update { count: updated.len() as u64 })
             }
<a href="#h21-4-3" id="h21-4-3" class="d">-            r =&gt; Err(Error::Internal(format!(&quot;Unexpected response {:?}&quot;, r))),
</a><a href="#h21-4-4" id="h21-4-4" class="i">+            r =&gt; errdata!(&quot;unexpected response {r:?}&quot;),
</a>         }
     }
 }
<a href="#h21-5" id="h21-5" class="h">@@ -149,7 +150,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Delete&lt;T&gt; {
</a>                 }
                 Ok(ResultSet::Delete { count })
             }
<a href="#h21-5-3" id="h21-5-3" class="d">-            r =&gt; Err(Error::Internal(format!(&quot;Unexpected result {:?}&quot;, r))),
</a><a href="#h21-5-4" id="h21-5-4" class="i">+            r =&gt; errdata!(&quot;unexpected result {r:?}&quot;),
</a>         }
     }
 }
<b>diff --git a/<a id="h22" href="../file/src/sql/execution/query.rs.html">src/sql/execution/query.rs</a> b/<a href="../file/src/sql/execution/query.rs.html">src/sql/execution/query.rs</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -2,7 +2,8 @@ use super::super::engine::Transaction;
</a> use super::super::plan::Direction;
 use super::super::types::{Column, Expression, Row, Value};
 use super::{Executor, ResultSet};
<a href="#h22-0-3" id="h22-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h22-0-4" id="h22-0-4" class="i">+use crate::error::Result;
</a><a href="#h22-0-5" id="h22-0-5" class="i">+use crate::{errdata, errinput};
</a> 
 /// A filter executor
 pub struct Filter&lt;T: Transaction&gt; {
<a href="#h22-1" id="h22-1" class="h">@@ -27,16 +28,13 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Filter&lt;T&gt; {
</a>                         Value::Boolean(true) =&gt; Ok(Some(row)),
                         Value::Boolean(false) =&gt; Ok(None),
                         Value::Null =&gt; Ok(None),
<a href="#h22-1-3" id="h22-1-3" class="d">-                        value =&gt; Err(Error::Value(format!(
</a><a href="#h22-1-4" id="h22-1-4" class="d">-                            &quot;Filter returned {}, expected boolean&quot;,
</a><a href="#h22-1-5" id="h22-1-5" class="d">-                            value
</a><a href="#h22-1-6" id="h22-1-6" class="d">-                        ))),
</a><a href="#h22-1-7" id="h22-1-7" class="i">+                        value =&gt; errinput!(&quot;filter returned {value}, expected boolean&quot;,),
</a>                     })
                     .transpose()
                 })),
             })
         } else {
<a href="#h22-1-13" id="h22-1-13" class="d">-            Err(Error::Internal(&quot;Unexpected result&quot;.into()))
</a><a href="#h22-1-14" id="h22-1-14" class="i">+            errdata!(&quot;unexpected result&quot;)
</a>         }
     }
 }
<a href="#h22-2" id="h22-2" class="h">@@ -81,7 +79,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Projection&lt;T&gt; {
</a>             }));
             Ok(ResultSet::Query { columns, rows })
         } else {
<a href="#h22-2-3" id="h22-2-3" class="d">-            Err(Error::Internal(&quot;Unexpected result&quot;.into()))
</a><a href="#h22-2-4" id="h22-2-4" class="i">+            errdata!(&quot;unexpected result&quot;)
</a>         }
     }
 }
<a href="#h22-3" id="h22-3" class="h">@@ -141,7 +139,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Order&lt;T&gt; {
</a>                     rows: Box::new(items.into_iter().map(|i| Ok(i.row))),
                 })
             }
<a href="#h22-3-3" id="h22-3-3" class="d">-            r =&gt; Err(Error::Internal(format!(&quot;Unexpected result {:?}&quot;, r))),
</a><a href="#h22-3-4" id="h22-3-4" class="i">+            r =&gt; errdata!(&quot;unexpected result {r:?}&quot;),
</a>         }
     }
 }
<a href="#h22-4" id="h22-4" class="h">@@ -163,7 +161,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Limit&lt;T&gt; {
</a>         if let ResultSet::Query { columns, rows } = self.source.execute(txn)? {
             Ok(ResultSet::Query { columns, rows: Box::new(rows.take(self.limit as usize)) })
         } else {
<a href="#h22-4-3" id="h22-4-3" class="d">-            Err(Error::Internal(&quot;Unexpected result&quot;.into()))
</a><a href="#h22-4-4" id="h22-4-4" class="i">+            errdata!(&quot;unexpected result&quot;)
</a>         }
     }
 }
<a href="#h22-5" id="h22-5" class="h">@@ -185,7 +183,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Offset&lt;T&gt; {
</a>         if let ResultSet::Query { columns, rows } = self.source.execute(txn)? {
             Ok(ResultSet::Query { columns, rows: Box::new(rows.skip(self.offset as usize)) })
         } else {
<a href="#h22-5-3" id="h22-5-3" class="d">-            Err(Error::Internal(&quot;Unexpected result&quot;.into()))
</a><a href="#h22-5-4" id="h22-5-4" class="i">+            errdata!(&quot;unexpected result&quot;)
</a>         }
     }
 }
<b>diff --git a/<a id="h23" href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a> b/<a href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -1,4 +1,5 @@
</a><a href="#h23-0-0" id="h23-0-0" class="d">-use crate::error::{Error, Result};
</a><a href="#h23-0-1" id="h23-0-1" class="i">+use crate::errinput;
</a><a href="#h23-0-2" id="h23-0-2" class="i">+use crate::error::Result;
</a> 
 use std::iter::Peekable;
 use std::str::Chars;
<a href="#h23-1" id="h23-1" class="h">@@ -306,9 +307,7 @@ impl&lt;&#39;a&gt; Iterator for Lexer&lt;&#39;a&gt; {
</a>     fn next(&amp;mut self) -&gt; Option&lt;Result&lt;Token&gt;&gt; {
         match self.scan() {
             Ok(Some(token)) =&gt; Some(Ok(token)),
<a href="#h23-1-3" id="h23-1-3" class="d">-            Ok(None) =&gt; {
</a><a href="#h23-1-4" id="h23-1-4" class="d">-                self.iter.peek().map(|c| Err(Error::Parse(format!(&quot;Unexpected character {}&quot;, c))))
</a><a href="#h23-1-5" id="h23-1-5" class="d">-            }
</a><a href="#h23-1-6" id="h23-1-6" class="i">+            Ok(None) =&gt; self.iter.peek().map(|c| errinput!(&quot;unexpected character {c}&quot;)),
</a>             Err(err) =&gt; Some(Err(err)),
         }
     }
<a href="#h23-2" id="h23-2" class="h">@@ -383,7 +382,7 @@ impl&lt;&#39;a&gt; Lexer&lt;&#39;a&gt; {
</a>                 Some(&#39;&quot;&#39;) if self.next_if(|c| c == &#39;&quot;&#39;).is_some() =&gt; ident.push(&#39;&quot;&#39;),
                 Some(&#39;&quot;&#39;) =&gt; break,
                 Some(c) =&gt; ident.push(c),
<a href="#h23-2-3" id="h23-2-3" class="d">-                None =&gt; return Err(Error::Parse(&quot;Unexpected end of quoted identifier&quot;.into())),
</a><a href="#h23-2-4" id="h23-2-4" class="i">+                None =&gt; return errinput!(&quot;unexpected end of quoted identifier&quot;),
</a>             }
         }
         Ok(Some(Token::Ident(ident)))
<a href="#h23-3" id="h23-3" class="h">@@ -421,7 +420,7 @@ impl&lt;&#39;a&gt; Lexer&lt;&#39;a&gt; {
</a>                 Some(&#39;\&#39;&#39;) if self.next_if(|c| c == &#39;\&#39;&#39;).is_some() =&gt; s.push(&#39;\&#39;&#39;),
                 Some(&#39;\&#39;&#39;) =&gt; break,
                 Some(c) =&gt; s.push(c),
<a href="#h23-3-3" id="h23-3-3" class="d">-                None =&gt; return Err(Error::Parse(&quot;Unexpected end of string literal&quot;.into())),
</a><a href="#h23-3-4" id="h23-3-4" class="i">+                None =&gt; return errinput!(&quot;unexpected end of string literal&quot;),
</a>             }
         }
         Ok(Some(Token::String(s)))
<b>diff --git a/<a id="h24" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -3,7 +3,8 @@ mod lexer;
</a> pub use lexer::{Keyword, Lexer, Token};
 
 use super::types::DataType;
<a href="#h24-0-3" id="h24-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h24-0-4" id="h24-0-4" class="i">+use crate::errinput;
</a><a href="#h24-0-5" id="h24-0-5" class="i">+use crate::error::Result;
</a> 
 use regex::Regex;
 use std::collections::BTreeMap;
<a href="#h24-1" id="h24-1" class="h">@@ -29,7 +30,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a> 
     /// Grabs the next lexer token, or throws an error if none is found.
     fn next(&amp;mut self) -&gt; Result&lt;Token&gt; {
<a href="#h24-1-3" id="h24-1-3" class="d">-        self.lexer.next().unwrap_or_else(|| Err(Error::Parse(&quot;Unexpected end of input&quot;.into())))
</a><a href="#h24-1-4" id="h24-1-4" class="i">+        self.lexer.next().unwrap_or_else(|| errinput!(&quot;unexpected end of input&quot;))
</a>     }
 
     /// Grabs the next lexer token, and returns it if it was expected or
<a href="#h24-2" id="h24-2" class="h">@@ -40,10 +41,10 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>             if token == t {
                 Ok(Some(token))
             } else {
<a href="#h24-2-3" id="h24-2-3" class="d">-                Err(Error::Parse(format!(&quot;Expected token {}, found {}&quot;, t, token)))
</a><a href="#h24-2-4" id="h24-2-4" class="i">+                errinput!(&quot;expected token {t}, found {token}&quot;)
</a>             }
         } else if let Some(token) = self.peek()? {
<a href="#h24-2-7" id="h24-2-7" class="d">-            Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token)))
</a><a href="#h24-2-8" id="h24-2-8" class="i">+            errinput!(&quot;unexpected token {token}&quot;)
</a>         } else {
             Ok(None)
         }
<a href="#h24-3" id="h24-3" class="h">@@ -53,7 +54,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>     fn next_ident(&amp;mut self) -&gt; Result&lt;String&gt; {
         match self.next()? {
             Token::Ident(ident) =&gt; Ok(ident),
<a href="#h24-3-3" id="h24-3-3" class="d">-            token =&gt; Err(Error::Parse(format!(&quot;Expected identifier, got {}&quot;, token))),
</a><a href="#h24-3-4" id="h24-3-4" class="i">+            token =&gt; errinput!(&quot;expected identifier, got {token}&quot;),
</a>         }
     }
 
<a href="#h24-4" id="h24-4" class="h">@@ -112,8 +113,8 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a> 
             Some(Token::Keyword(Keyword::Explain)) =&gt; self.parse_statement_explain(),
 
<a href="#h24-4-3" id="h24-4-3" class="d">-            Some(token) =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-4-4" id="h24-4-4" class="d">-            None =&gt; Err(Error::Parse(&quot;Unexpected end of input&quot;.into())),
</a><a href="#h24-4-5" id="h24-4-5" class="i">+            Some(token) =&gt; errinput!(&quot;unexpected token {token}&quot;),
</a><a href="#h24-4-6" id="h24-4-6" class="i">+            None =&gt; errinput!(&quot;unexpected end of input&quot;),
</a>         }
     }
 
<a href="#h24-5" id="h24-5" class="h">@@ -122,13 +123,13 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>         match self.next()? {
             Token::Keyword(Keyword::Create) =&gt; match self.next()? {
                 Token::Keyword(Keyword::Table) =&gt; self.parse_ddl_create_table(),
<a href="#h24-5-3" id="h24-5-3" class="d">-                token =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-5-4" id="h24-5-4" class="i">+                token =&gt; errinput!(&quot;unexpected token {token}&quot;),
</a>             },
             Token::Keyword(Keyword::Drop) =&gt; match self.next()? {
                 Token::Keyword(Keyword::Table) =&gt; self.parse_ddl_drop_table(),
<a href="#h24-5-8" id="h24-5-8" class="d">-                token =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-5-9" id="h24-5-9" class="i">+                token =&gt; errinput!(&quot;unexpected token {token}&quot;),
</a>             },
<a href="#h24-5-11" id="h24-5-11" class="d">-            token =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-5-12" id="h24-5-12" class="i">+            token =&gt; errinput!(&quot;Unexpected token {token}&quot;),
</a>         }
     }
 
<a href="#h24-6" id="h24-6" class="h">@@ -176,7 +177,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                 Token::Keyword(Keyword::String) =&gt; DataType::String,
                 Token::Keyword(Keyword::Text) =&gt; DataType::String,
                 Token::Keyword(Keyword::Varchar) =&gt; DataType::String,
<a href="#h24-6-3" id="h24-6-3" class="d">-                token =&gt; return Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-6-4" id="h24-6-4" class="i">+                token =&gt; return errinput!(&quot;unexpected token {token}&quot;),
</a>             },
             primary_key: false,
             nullable: None,
<a href="#h24-7" id="h24-7" class="h">@@ -193,20 +194,20 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                 }
                 Keyword::Null =&gt; {
                     if let Some(false) = column.nullable {
<a href="#h24-7-3" id="h24-7-3" class="d">-                        return Err(Error::Value(format!(
</a><a href="#h24-7-4" id="h24-7-4" class="d">-                            &quot;Column {} can&#39;t be both not nullable and nullable&quot;,
</a><a href="#h24-7-5" id="h24-7-5" class="i">+                        return errinput!(
</a><a href="#h24-7-6" id="h24-7-6" class="i">+                            &quot;column {} can&#39;t be both not nullable and nullable&quot;,
</a>                             column.name
<a href="#h24-7-8" id="h24-7-8" class="d">-                        )));
</a><a href="#h24-7-9" id="h24-7-9" class="i">+                        );
</a>                     }
                     column.nullable = Some(true)
                 }
                 Keyword::Not =&gt; {
                     self.next_expect(Some(Keyword::Null.into()))?;
                     if let Some(true) = column.nullable {
<a href="#h24-7-16" id="h24-7-16" class="d">-                        return Err(Error::Value(format!(
</a><a href="#h24-7-17" id="h24-7-17" class="d">-                            &quot;Column {} can&#39;t be both not nullable and nullable&quot;,
</a><a href="#h24-7-18" id="h24-7-18" class="i">+                        return errinput!(
</a><a href="#h24-7-19" id="h24-7-19" class="i">+                            &quot;column {} can&#39;t be both not nullable and nullable&quot;,
</a>                             column.name
<a href="#h24-7-21" id="h24-7-21" class="d">-                        )));
</a><a href="#h24-7-22" id="h24-7-22" class="i">+                        );
</a>                     }
                     column.nullable = Some(false)
                 }
<a href="#h24-8" id="h24-8" class="h">@@ -214,7 +215,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                 Keyword::Unique =&gt; column.unique = true,
                 Keyword::Index =&gt; column.index = true,
                 Keyword::References =&gt; column.references = Some(self.next_ident()?),
<a href="#h24-8-3" id="h24-8-3" class="d">-                keyword =&gt; return Err(Error::Parse(format!(&quot;Unexpected keyword {}&quot;, keyword))),
</a><a href="#h24-8-4" id="h24-8-4" class="i">+                keyword =&gt; return errinput!(&quot;unexpected keyword {keyword}&quot;),
</a>             }
         }
         Ok(column)
<a href="#h24-9" id="h24-9" class="h">@@ -232,7 +233,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>     fn parse_statement_explain(&amp;mut self) -&gt; Result&lt;ast::Statement&gt; {
         self.next_expect(Some(Keyword::Explain.into()))?;
         if let Some(Token::Keyword(Keyword::Explain)) = self.peek()? {
<a href="#h24-9-3" id="h24-9-3" class="d">-            return Err(Error::Parse(&quot;Cannot nest EXPLAIN statements&quot;.into()));
</a><a href="#h24-9-4" id="h24-9-4" class="i">+            return errinput!(&quot;cannot nest EXPLAIN statements&quot;);
</a>         }
         Ok(ast::Statement::Explain(Box::new(self.parse_statement()?)))
     }
<a href="#h24-10" id="h24-10" class="h">@@ -250,7 +251,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                 match self.next()? {
                     Token::CloseParen =&gt; break,
                     Token::Comma =&gt; {}
<a href="#h24-10-3" id="h24-10-3" class="d">-                    token =&gt; return Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-10-4" id="h24-10-4" class="i">+                    token =&gt; return errinput!(&quot;Unexpected token {token}&quot;),
</a>                 }
             }
             Some(cols)
<a href="#h24-11" id="h24-11" class="h">@@ -268,7 +269,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                 match self.next()? {
                     Token::CloseParen =&gt; break,
                     Token::Comma =&gt; {}
<a href="#h24-11-3" id="h24-11-3" class="d">-                    token =&gt; return Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-11-4" id="h24-11-4" class="i">+                    token =&gt; return errinput!(&quot;unexpected token {token}&quot;),
</a>                 }
             }
             values.push(exprs);
<a href="#h24-12" id="h24-12" class="h">@@ -314,7 +315,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>             self.next_expect(Some(Token::Equal))?;
             let expr = self.parse_expression(0)?;
             if set.contains_key(&amp;column) {
<a href="#h24-12-3" id="h24-12-3" class="d">-                return Err(Error::Value(format!(&quot;Duplicate values given for column {}&quot;, column)));
</a><a href="#h24-12-4" id="h24-12-4" class="i">+                return errinput!(&quot;duplicate values given for column {column}&quot;);
</a>             }
             set.insert(column, expr);
             if self.next_if_token(Token::Comma).is_none() {
<a href="#h24-13" id="h24-13" class="h">@@ -336,7 +337,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                     match self.next()? {
                         Token::Keyword(Keyword::Only) =&gt; readonly = true,
                         Token::Keyword(Keyword::Write) =&gt; readonly = false,
<a href="#h24-13-3" id="h24-13-3" class="d">-                        token =&gt; return Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-13-4" id="h24-13-4" class="i">+                        token =&gt; return errinput!(&quot;unexpected token {token}&quot;),
</a>                     }
                 }
                 if self.next_if_token(Keyword::As.into()).is_some() {
<a href="#h24-14" id="h24-14" class="h">@@ -345,19 +346,14 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                     self.next_expect(Some(Keyword::Time.into()))?;
                     match self.next()? {
                         Token::Number(n) =&gt; version = Some(n.parse::&lt;u64&gt;()?),
<a href="#h24-14-3" id="h24-14-3" class="d">-                        token =&gt; {
</a><a href="#h24-14-4" id="h24-14-4" class="d">-                            return Err(Error::Parse(format!(
</a><a href="#h24-14-5" id="h24-14-5" class="d">-                                &quot;Unexpected token {}, wanted number&quot;,
</a><a href="#h24-14-6" id="h24-14-6" class="d">-                                token
</a><a href="#h24-14-7" id="h24-14-7" class="d">-                            )))
</a><a href="#h24-14-8" id="h24-14-8" class="d">-                        }
</a><a href="#h24-14-9" id="h24-14-9" class="i">+                        token =&gt; return errinput!(&quot;unexpected token {token}, wanted number&quot;),
</a>                     }
                 }
                 Ok(ast::Statement::Begin { read_only: readonly, as_of: version })
             }
             Token::Keyword(Keyword::Commit) =&gt; Ok(ast::Statement::Commit),
             Token::Keyword(Keyword::Rollback) =&gt; Ok(ast::Statement::Rollback),
<a href="#h24-14-16" id="h24-14-16" class="d">-            token =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h24-14-17" id="h24-14-17" class="i">+            token =&gt; errinput!(&quot;unexpected token {token}&quot;),
</a>         }
     }
 
<a href="#h24-15" id="h24-15" class="h">@@ -578,7 +574,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>             Token::Keyword(Keyword::NaN) =&gt; ast::Literal::Float(std::f64::NAN).into(),
             Token::Keyword(Keyword::Null) =&gt; ast::Literal::Null.into(),
             Token::Keyword(Keyword::True) =&gt; ast::Literal::Boolean(true).into(),
<a href="#h24-15-3" id="h24-15-3" class="d">-            t =&gt; return Err(Error::Parse(format!(&quot;Expected expression atom, found {}&quot;, t))),
</a><a href="#h24-15-4" id="h24-15-4" class="i">+            token =&gt; return errinput!(&quot;expected expression atom, found {token}&quot;),
</a>         })
     }
 }
<b>diff --git a/<a id="h25" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -2,7 +2,8 @@ use super::super::parser::ast;
</a> use super::super::schema::{Catalog, Column, Table};
 use super::super::types::{Expression, Value};
 use super::{Aggregate, Direction, Node, Plan};
<a href="#h25-0-3" id="h25-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h25-0-4" id="h25-0-4" class="i">+use crate::error::Result;
</a><a href="#h25-0-5" id="h25-0-5" class="i">+use crate::{errassert, errinput};
</a> 
 use std::collections::{HashMap, HashSet};
 use std::mem::replace;
<a href="#h25-1" id="h25-1" class="h">@@ -28,15 +29,10 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         Ok(match statement {
             // Transaction control and explain statements should have been handled by session.
             ast::Statement::Begin { .. } | ast::Statement::Commit | ast::Statement::Rollback =&gt; {
<a href="#h25-1-3" id="h25-1-3" class="d">-                return Err(Error::Internal(format!(
</a><a href="#h25-1-4" id="h25-1-4" class="d">-                    &quot;Unexpected transaction statement {:?}&quot;,
</a><a href="#h25-1-5" id="h25-1-5" class="d">-                    statement
</a><a href="#h25-1-6" id="h25-1-6" class="d">-                )))
</a><a href="#h25-1-7" id="h25-1-7" class="i">+                return errassert!(&quot;unexpected transaction statement {statement:?}&quot;)
</a>             }
 
<a href="#h25-1-10" id="h25-1-10" class="d">-            ast::Statement::Explain(_) =&gt; {
</a><a href="#h25-1-11" id="h25-1-11" class="d">-                return Err(Error::Internal(&quot;Unexpected explain statement&quot;.into()))
</a><a href="#h25-1-12" id="h25-1-12" class="d">-            }
</a><a href="#h25-1-13" id="h25-1-13" class="i">+            ast::Statement::Explain(_) =&gt; return errassert!(&quot;unexpected explain statement&quot;),
</a> 
             // DDL statements (schema changes).
             ast::Statement::CreateTable { name, columns } =&gt; Node::CreateTable {
<a href="#h25-2" id="h25-2" class="h">@@ -136,7 +132,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 let mut node = if !from.is_empty() {
                     self.build_from_clause(scope, from)?
                 } else if select.is_empty() {
<a href="#h25-2-3" id="h25-2-3" class="d">-                    return Err(Error::Value(&quot;Can&#39;t select * without a table&quot;.into()));
</a><a href="#h25-2-4" id="h25-2-4" class="i">+                    return errinput!(&quot;can&#39;t select * without a table&quot;);
</a>                 } else {
                     Node::Nothing
                 };
<a href="#h25-3" id="h25-3" class="h">@@ -225,7 +221,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                         source: Box::new(node),
                         offset: match self.evaluate_constant(expr)? {
                             Value::Integer(i) if i &gt;= 0 =&gt; Ok(i as u64),
<a href="#h25-3-3" id="h25-3-3" class="d">-                            v =&gt; Err(Error::Value(format!(&quot;Invalid offset {}&quot;, v))),
</a><a href="#h25-3-4" id="h25-3-4" class="i">+                            v =&gt; errinput!(&quot;invalid offset {v}&quot;),
</a>                         }?,
                     }
                 }
<a href="#h25-4" id="h25-4" class="h">@@ -236,7 +232,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                         source: Box::new(node),
                         limit: match self.evaluate_constant(expr)? {
                             Value::Integer(i) if i &gt;= 0 =&gt; Ok(i as u64),
<a href="#h25-4-3" id="h25-4-3" class="d">-                            v =&gt; Err(Error::Value(format!(&quot;Invalid limit {}&quot;, v))),
</a><a href="#h25-4-4" id="h25-4-4" class="i">+                            v =&gt; errinput!(&quot;invalid limit {v}&quot;),
</a>                         }?,
                     }
                 }
<a href="#h25-5" id="h25-5" class="h">@@ -264,7 +260,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         let mut items = from.into_iter();
         let mut node = match items.next() {
             Some(item) =&gt; self.build_from_item(scope, item)?,
<a href="#h25-5-3" id="h25-5-3" class="d">-            None =&gt; return Err(Error::Value(&quot;No from items given&quot;.into())),
</a><a href="#h25-5-4" id="h25-5-4" class="i">+            None =&gt; return errinput!(&quot;no from items given&quot;),
</a>         };
         for item in items {
             let mut right_scope = base_scope.clone();
<a href="#h25-6" id="h25-6" class="h">@@ -392,7 +388,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         }
         for (_, expr) in &amp;aggregates {
             if self.is_aggregate(expr) {
<a href="#h25-6-3" id="h25-6-3" class="d">-                return Err(Error::Value(&quot;Aggregate functions can&#39;t be nested&quot;.into()));
</a><a href="#h25-6-4" id="h25-6-4" class="i">+                return errinput!(&quot;aggregate functions can&#39;t be nested&quot;);
</a>             }
         }
         Ok(aggregates)
<a href="#h25-7" id="h25-7" class="h">@@ -438,7 +434,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         // during extract_aggregates().
         for (expr, _) in &amp;groups {
             if self.is_aggregate(expr) {
<a href="#h25-7-3" id="h25-7-3" class="d">-                return Err(Error::Value(&quot;Group expression cannot contain aggregates&quot;.into()));
</a><a href="#h25-7-4" id="h25-7-4" class="i">+                return errinput!(&quot;group expression cannot contain aggregates&quot;);
</a>             }
         }
         Ok(groups)
<a href="#h25-8" id="h25-8" class="h">@@ -480,9 +476,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 ast::Expression::Function(f, a) if self.aggregate_from_name(f).is_some() =&gt; {
                     if let ast::Expression::Column(c) = a[0] {
                         if self.is_aggregate(&amp;select[c].0) {
<a href="#h25-8-3" id="h25-8-3" class="d">-                            return Err(Error::Value(
</a><a href="#h25-8-4" id="h25-8-4" class="d">-                                &quot;Aggregate function cannot reference aggregate&quot;.into(),
</a><a href="#h25-8-5" id="h25-8-5" class="d">-                            ));
</a><a href="#h25-8-6" id="h25-8-6" class="i">+                            return errinput!(&quot;aggregate function cannot reference aggregate&quot;);
</a>                         }
                     }
                     select.push((e, None));
<a href="#h25-9" id="h25-9" class="h">@@ -537,9 +531,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>             ast::Expression::Field(table, name) =&gt; {
                 Field(scope.resolve(table.as_deref(), &amp;name)?, Some((table, name)))
             }
<a href="#h25-9-3" id="h25-9-3" class="d">-            ast::Expression::Function(name, _) =&gt; {
</a><a href="#h25-9-4" id="h25-9-4" class="d">-                return Err(Error::Value(format!(&quot;Unknown function {}&quot;, name,)))
</a><a href="#h25-9-5" id="h25-9-5" class="d">-            }
</a><a href="#h25-9-6" id="h25-9-6" class="i">+            ast::Expression::Function(name, _) =&gt; return errinput!(&quot;unknown function {name}&quot;),
</a>             ast::Expression::Operation(op) =&gt; match op {
                 // Logical operators
                 ast::Operation::And(lhs, rhs) =&gt; And(
<a href="#h25-10" id="h25-10" class="h">@@ -706,10 +698,10 @@ impl Scope {
</a>     /// Adds a table to the scope.
     fn add_table(&amp;mut self, label: String, table: Table) -&gt; Result&lt;()&gt; {
         if self.constant {
<a href="#h25-10-3" id="h25-10-3" class="d">-            return Err(Error::Internal(&quot;Can&#39;t modify constant scope&quot;.into()));
</a><a href="#h25-10-4" id="h25-10-4" class="i">+            return errassert!(&quot;can&#39;t modify constant scope&quot;);
</a>         }
         if self.tables.contains_key(&amp;label) {
<a href="#h25-10-7" id="h25-10-7" class="d">-            return Err(Error::Value(format!(&quot;Duplicate table name {}&quot;, label)));
</a><a href="#h25-10-8" id="h25-10-8" class="i">+            return errinput!(&quot;duplicate table name {label}&quot;);
</a>         }
         for column in &amp;table.columns {
             self.add_column(Some(label.clone()), Some(column.name.clone()));
<a href="#h25-11" id="h25-11" class="h">@@ -721,15 +713,9 @@ impl Scope {
</a>     /// Fetches a column from the scope by index.
     fn get_column(&amp;self, index: usize) -&gt; Result&lt;(Option&lt;String&gt;, Option&lt;String&gt;)&gt; {
         if self.constant {
<a href="#h25-11-3" id="h25-11-3" class="d">-            return Err(Error::Value(format!(
</a><a href="#h25-11-4" id="h25-11-4" class="d">-                &quot;Expression must be constant, found column {}&quot;,
</a><a href="#h25-11-5" id="h25-11-5" class="d">-                index
</a><a href="#h25-11-6" id="h25-11-6" class="d">-            )));
</a><a href="#h25-11-7" id="h25-11-7" class="i">+            return errinput!(&quot;expression must be constant, found column {index}&quot;);
</a>         }
<a href="#h25-11-9" id="h25-11-9" class="d">-        self.columns
</a><a href="#h25-11-10" id="h25-11-10" class="d">-            .get(index)
</a><a href="#h25-11-11" id="h25-11-11" class="d">-            .cloned()
</a><a href="#h25-11-12" id="h25-11-12" class="d">-            .ok_or_else(|| Error::Value(format!(&quot;Column index {} not found&quot;, index)))
</a><a href="#h25-11-13" id="h25-11-13" class="i">+        self.columns.get(index).cloned().ok_or(errinput!(&quot;column index {index} not found&quot;))
</a>     }
 
     /// Fetches a column label by index, if any.
<a href="#h25-12" id="h25-12" class="h">@@ -743,11 +729,11 @@ impl Scope {
</a>     /// Merges two scopes, by appending the given scope to self.
     fn merge(&amp;mut self, scope: Scope) -&gt; Result&lt;()&gt; {
         if self.constant {
<a href="#h25-12-3" id="h25-12-3" class="d">-            return Err(Error::Internal(&quot;Can&#39;t modify constant scope&quot;.into()));
</a><a href="#h25-12-4" id="h25-12-4" class="i">+            return errassert!(&quot;can&#39;t modify constant scope&quot;);
</a>         }
         for (label, table) in scope.tables {
             if self.tables.contains_key(&amp;label) {
<a href="#h25-12-8" id="h25-12-8" class="d">-                return Err(Error::Value(format!(&quot;Duplicate table name {}&quot;, label)));
</a><a href="#h25-12-9" id="h25-12-9" class="i">+                return errinput!(&quot;duplicate table name {label}&quot;);
</a>             }
             self.tables.insert(label, table);
         }
<a href="#h25-13" id="h25-13" class="h">@@ -760,26 +746,23 @@ impl Scope {
</a>     /// Resolves a name, optionally qualified by a table name.
     fn resolve(&amp;self, table: Option&lt;&amp;str&gt;, name: &amp;str) -&gt; Result&lt;usize&gt; {
         if self.constant {
<a href="#h25-13-3" id="h25-13-3" class="d">-            return Err(Error::Value(format!(
</a><a href="#h25-13-4" id="h25-13-4" class="d">-                &quot;Expression must be constant, found field {}&quot;,
</a><a href="#h25-13-5" id="h25-13-5" class="i">+            return errinput!(
</a><a href="#h25-13-6" id="h25-13-6" class="i">+                &quot;expression must be constant, found field {}&quot;,
</a>                 if let Some(table) = table { format!(&quot;{}.{}&quot;, table, name) } else { name.into() }
<a href="#h25-13-8" id="h25-13-8" class="d">-            )));
</a><a href="#h25-13-9" id="h25-13-9" class="i">+            );
</a>         }
         if let Some(table) = table {
             if !self.tables.contains_key(table) {
<a href="#h25-13-13" id="h25-13-13" class="d">-                return Err(Error::Value(format!(&quot;Unknown table {}&quot;, table)));
</a><a href="#h25-13-14" id="h25-13-14" class="i">+                return errinput!(&quot;unknown table {table}&quot;);
</a>             }
             self.qualified
                 .get(&amp;(table.into(), name.into()))
                 .copied()
<a href="#h25-13-19" id="h25-13-19" class="d">-                .ok_or_else(|| Error::Value(format!(&quot;Unknown field {}.{}&quot;, table, name)))
</a><a href="#h25-13-20" id="h25-13-20" class="i">+                .ok_or(errinput!(&quot;Unknown field {table}.{name}&quot;))
</a>         } else if self.ambiguous.contains(name) {
<a href="#h25-13-22" id="h25-13-22" class="d">-            Err(Error::Value(format!(&quot;Ambiguous field {}&quot;, name)))
</a><a href="#h25-13-23" id="h25-13-23" class="i">+            errinput!(&quot;ambiguous field {name}&quot;)
</a>         } else {
<a href="#h25-13-25" id="h25-13-25" class="d">-            self.unqualified
</a><a href="#h25-13-26" id="h25-13-26" class="d">-                .get(name)
</a><a href="#h25-13-27" id="h25-13-27" class="d">-                .copied()
</a><a href="#h25-13-28" id="h25-13-28" class="d">-                .ok_or_else(|| Error::Value(format!(&quot;Unknown field {}&quot;, name)))
</a><a href="#h25-13-29" id="h25-13-29" class="i">+            self.unqualified.get(name).copied().ok_or(errinput!(&quot;unknown field {name}&quot;))
</a>         }
     }
 
<a href="#h25-14" id="h25-14" class="h">@@ -792,7 +775,7 @@ impl Scope {
</a>     /// and returns a new scope for the projection.
     fn project(&amp;mut self, projection: &amp;[(Expression, Option&lt;String&gt;)]) -&gt; Result&lt;()&gt; {
         if self.constant {
<a href="#h25-14-3" id="h25-14-3" class="d">-            return Err(Error::Internal(&quot;Can&#39;t modify constant scope&quot;.into()));
</a><a href="#h25-14-4" id="h25-14-4" class="i">+            return errassert!(&quot;can&#39;t modify constant scope&quot;);
</a>         }
         let mut new = Self::new();
         new.tables = self.tables.clone();
<b>diff --git a/<a id="h26" href="../file/src/sql/schema.rs.html">src/sql/schema.rs</a> b/<a href="../file/src/sql/schema.rs.html">src/sql/schema.rs</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -2,6 +2,7 @@ use super::engine::Transaction;
</a> use super::parser::format_ident;
 use super::types::{DataType, Value};
 use crate::encoding;
<a href="#h26-0-3" id="h26-0-3" class="i">+use crate::errinput;
</a> use crate::error::{Error, Result};
 
 use serde_derive::{Deserialize, Serialize};
<a href="#h26-1" id="h26-1" class="h">@@ -20,8 +21,7 @@ pub trait Catalog {
</a> 
     /// Reads a table, and errors if it does not exist
     fn must_read_table(&amp;self, table: &amp;str) -&gt; Result&lt;Table&gt; {
<a href="#h26-1-3" id="h26-1-3" class="d">-        self.read_table(table)?
</a><a href="#h26-1-4" id="h26-1-4" class="d">-            .ok_or_else(|| Error::Value(format!(&quot;Table {} does not exist&quot;, table)))
</a><a href="#h26-1-5" id="h26-1-5" class="i">+        self.read_table(table)?.ok_or(errinput!(&quot;table {table} does not exist&quot;))
</a>     }
 
     /// Returns all references to a table, as table,column pairs.
<a href="#h26-2" id="h26-2" class="h">@@ -65,16 +65,18 @@ impl Table {
</a> 
     /// Fetches a column by name
     pub fn get_column(&amp;self, name: &amp;str) -&gt; Result&lt;&amp;Column&gt; {
<a href="#h26-2-3" id="h26-2-3" class="d">-        self.columns.iter().find(|c| c.name == name).ok_or_else(|| {
</a><a href="#h26-2-4" id="h26-2-4" class="d">-            Error::Value(format!(&quot;Column {} not found in table {}&quot;, name, self.name))
</a><a href="#h26-2-5" id="h26-2-5" class="d">-        })
</a><a href="#h26-2-6" id="h26-2-6" class="i">+        self.columns
</a><a href="#h26-2-7" id="h26-2-7" class="i">+            .iter()
</a><a href="#h26-2-8" id="h26-2-8" class="i">+            .find(|c| c.name == name)
</a><a href="#h26-2-9" id="h26-2-9" class="i">+            .ok_or(errinput!(&quot;column {name} not found in table {}&quot;, self.name))
</a>     }
 
     /// Fetches a column index by name
     pub fn get_column_index(&amp;self, name: &amp;str) -&gt; Result&lt;usize&gt; {
<a href="#h26-2-14" id="h26-2-14" class="d">-        self.columns.iter().position(|c| c.name == name).ok_or_else(|| {
</a><a href="#h26-2-15" id="h26-2-15" class="d">-            Error::Value(format!(&quot;Column {} not found in table {}&quot;, name, self.name))
</a><a href="#h26-2-16" id="h26-2-16" class="d">-        })
</a><a href="#h26-2-17" id="h26-2-17" class="i">+        self.columns
</a><a href="#h26-2-18" id="h26-2-18" class="i">+            .iter()
</a><a href="#h26-2-19" id="h26-2-19" class="i">+            .position(|c| c.name == name)
</a><a href="#h26-2-20" id="h26-2-20" class="i">+            .ok_or(errinput!(&quot;column {name} not found in table {}&quot;, self.name))
</a>     }
 
     /// Returns the primary key column of the table
<a href="#h26-3" id="h26-3" class="h">@@ -82,7 +84,7 @@ impl Table {
</a>         self.columns
             .iter()
             .find(|c| c.primary_key)
<a href="#h26-3-3" id="h26-3-3" class="d">-            .ok_or_else(|| Error::Value(format!(&quot;Primary key not found in table {}&quot;, self.name)))
</a><a href="#h26-3-4" id="h26-3-4" class="i">+            .ok_or(errinput!(&quot;primary key not found in table {}&quot;, self.name))
</a>     }
 
     /// Returns the primary key value of a row
<a href="#h26-4" id="h26-4" class="h">@@ -91,21 +93,21 @@ impl Table {
</a>             self.columns
                 .iter()
                 .position(|c| c.primary_key)
<a href="#h26-4-3" id="h26-4-3" class="d">-                .ok_or_else(|| Error::Value(&quot;Primary key not found&quot;.into()))?,
</a><a href="#h26-4-4" id="h26-4-4" class="i">+                .ok_or::&lt;Error&gt;(errinput!(&quot;primary key not found&quot;))?,
</a>         )
         .cloned()
<a href="#h26-4-7" id="h26-4-7" class="d">-        .ok_or_else(|| Error::Value(&quot;Primary key value not found for row&quot;.into()))
</a><a href="#h26-4-8" id="h26-4-8" class="i">+        .ok_or(errinput!(&quot;primary key value not found for row&quot;))
</a>     }
 
     /// Validates the table schema
     pub fn validate(&amp;self, txn: &amp;mut dyn Transaction) -&gt; Result&lt;()&gt; {
         if self.columns.is_empty() {
<a href="#h26-4-14" id="h26-4-14" class="d">-            return Err(Error::Value(format!(&quot;Table {} has no columns&quot;, self.name)));
</a><a href="#h26-4-15" id="h26-4-15" class="i">+            return errinput!(&quot;table {} has no columns&quot;, self.name);
</a>         }
         match self.columns.iter().filter(|c| c.primary_key).count() {
             1 =&gt; {}
<a href="#h26-4-19" id="h26-4-19" class="d">-            0 =&gt; return Err(Error::Value(format!(&quot;No primary key in table {}&quot;, self.name))),
</a><a href="#h26-4-20" id="h26-4-20" class="d">-            _ =&gt; return Err(Error::Value(format!(&quot;Multiple primary keys in table {}&quot;, self.name))),
</a><a href="#h26-4-21" id="h26-4-21" class="i">+            0 =&gt; return errinput!(&quot;no primary key in table {}&quot;, self.name),
</a><a href="#h26-4-22" id="h26-4-22" class="i">+            _ =&gt; return errinput!(&quot;multiple primary keys in table {}&quot;, self.name),
</a>         };
         for column in &amp;self.columns {
             column.validate(self, txn)?;
<a href="#h26-5" id="h26-5" class="h">@@ -116,7 +118,7 @@ impl Table {
</a>     /// Validates a row
     pub fn validate_row(&amp;self, row: &amp;[Value], txn: &amp;mut dyn Transaction) -&gt; Result&lt;()&gt; {
         if row.len() != self.columns.len() {
<a href="#h26-5-3" id="h26-5-3" class="d">-            return Err(Error::Value(format!(&quot;Invalid row size for table {}&quot;, self.name)));
</a><a href="#h26-5-4" id="h26-5-4" class="i">+            return errinput!(&quot;invalid row size for table {}&quot;, self.name);
</a>         }
         let pk = self.get_row_key(row)?;
         for (column, value) in self.columns.iter().zip(row.iter()) {
<a href="#h26-6" id="h26-6" class="h">@@ -163,32 +165,30 @@ impl Column {
</a>     pub fn validate(&amp;self, table: &amp;Table, txn: &amp;mut dyn Transaction) -&gt; Result&lt;()&gt; {
         // Validate primary key
         if self.primary_key &amp;&amp; self.nullable {
<a href="#h26-6-3" id="h26-6-3" class="d">-            return Err(Error::Value(format!(&quot;Primary key {} cannot be nullable&quot;, self.name)));
</a><a href="#h26-6-4" id="h26-6-4" class="i">+            return errinput!(&quot;primary key {} cannot be nullable&quot;, self.name);
</a>         }
         if self.primary_key &amp;&amp; !self.unique {
<a href="#h26-6-7" id="h26-6-7" class="d">-            return Err(Error::Value(format!(&quot;Primary key {} must be unique&quot;, self.name)));
</a><a href="#h26-6-8" id="h26-6-8" class="i">+            return errinput!(&quot;primary key {} must be unique&quot;, self.name);
</a>         }
 
         // Validate default value
         if let Some(default) = &amp;self.default {
             if let Some(datatype) = default.datatype() {
                 if datatype != self.datatype {
<a href="#h26-6-15" id="h26-6-15" class="d">-                    return Err(Error::Value(format!(
</a><a href="#h26-6-16" id="h26-6-16" class="d">-                        &quot;Default value for column {} has datatype {}, must be {}&quot;,
</a><a href="#h26-6-17" id="h26-6-17" class="d">-                        self.name, datatype, self.datatype
</a><a href="#h26-6-18" id="h26-6-18" class="d">-                    )));
</a><a href="#h26-6-19" id="h26-6-19" class="i">+                    return errinput!(
</a><a href="#h26-6-20" id="h26-6-20" class="i">+                        &quot;default value for column {} has datatype {datatype}, must be {}&quot;,
</a><a href="#h26-6-21" id="h26-6-21" class="i">+                        self.name,
</a><a href="#h26-6-22" id="h26-6-22" class="i">+                        self.datatype
</a><a href="#h26-6-23" id="h26-6-23" class="i">+                    );
</a>                 }
             } else if !self.nullable {
<a href="#h26-6-26" id="h26-6-26" class="d">-                return Err(Error::Value(format!(
</a><a href="#h26-6-27" id="h26-6-27" class="d">-                    &quot;Can&#39;t use NULL as default value for non-nullable column {}&quot;,
</a><a href="#h26-6-28" id="h26-6-28" class="i">+                return errinput!(
</a><a href="#h26-6-29" id="h26-6-29" class="i">+                    &quot;can&#39;t use NULL as default value for non-nullable column {}&quot;,
</a>                     self.name
<a href="#h26-6-31" id="h26-6-31" class="d">-                )));
</a><a href="#h26-6-32" id="h26-6-32" class="i">+                );
</a>             }
         } else if self.nullable {
<a href="#h26-6-35" id="h26-6-35" class="d">-            return Err(Error::Value(format!(
</a><a href="#h26-6-36" id="h26-6-36" class="d">-                &quot;Nullable column {} must have a default value&quot;,
</a><a href="#h26-6-37" id="h26-6-37" class="d">-                self.name
</a><a href="#h26-6-38" id="h26-6-38" class="d">-            )));
</a><a href="#h26-6-39" id="h26-6-39" class="i">+            return errinput!(&quot;nullable column {} must have a default value&quot;, self.name);
</a>         }
 
         // Validate references
<a href="#h26-7" id="h26-7" class="h">@@ -198,19 +198,19 @@ impl Column {
</a>             } else if let Some(table) = txn.read_table(reference)? {
                 table
             } else {
<a href="#h26-7-3" id="h26-7-3" class="d">-                return Err(Error::Value(format!(
</a><a href="#h26-7-4" id="h26-7-4" class="d">-                    &quot;Table {} referenced by column {} does not exist&quot;,
</a><a href="#h26-7-5" id="h26-7-5" class="d">-                    reference, self.name
</a><a href="#h26-7-6" id="h26-7-6" class="d">-                )));
</a><a href="#h26-7-7" id="h26-7-7" class="i">+                return errinput!(
</a><a href="#h26-7-8" id="h26-7-8" class="i">+                    &quot;table {reference} referenced by column {} does not exist&quot;,
</a><a href="#h26-7-9" id="h26-7-9" class="i">+                    self.name
</a><a href="#h26-7-10" id="h26-7-10" class="i">+                );
</a>             };
             if self.datatype != target.get_primary_key()?.datatype {
<a href="#h26-7-13" id="h26-7-13" class="d">-                return Err(Error::Value(format!(
</a><a href="#h26-7-14" id="h26-7-14" class="d">-                    &quot;Can&#39;t reference {} primary key of table {} from {} column {}&quot;,
</a><a href="#h26-7-15" id="h26-7-15" class="i">+                return errinput!(
</a><a href="#h26-7-16" id="h26-7-16" class="i">+                    &quot;can&#39;t reference {} primary key of table {} from {} column {}&quot;,
</a>                     target.get_primary_key()?.datatype,
                     target.name,
                     self.datatype,
                     self.name
<a href="#h26-7-21" id="h26-7-21" class="d">-                )));
</a><a href="#h26-7-22" id="h26-7-22" class="i">+                );
</a>             }
         }
 
<a href="#h26-8" id="h26-8" class="h">@@ -228,18 +228,20 @@ impl Column {
</a>         // Validate datatype
         match value.datatype() {
             None if self.nullable =&gt; Ok(()),
<a href="#h26-8-3" id="h26-8-3" class="d">-            None =&gt; Err(Error::Value(format!(&quot;NULL value not allowed for column {}&quot;, self.name))),
</a><a href="#h26-8-4" id="h26-8-4" class="d">-            Some(ref datatype) if datatype != &amp;self.datatype =&gt; Err(Error::Value(format!(
</a><a href="#h26-8-5" id="h26-8-5" class="d">-                &quot;Invalid datatype {} for {} column {}&quot;,
</a><a href="#h26-8-6" id="h26-8-6" class="d">-                datatype, self.datatype, self.name
</a><a href="#h26-8-7" id="h26-8-7" class="d">-            ))),
</a><a href="#h26-8-8" id="h26-8-8" class="i">+            None =&gt; errinput!(&quot;NULL value not allowed for column {}&quot;, self.name),
</a><a href="#h26-8-9" id="h26-8-9" class="i">+            Some(ref datatype) if datatype != &amp;self.datatype =&gt; errinput!(
</a><a href="#h26-8-10" id="h26-8-10" class="i">+                &quot;invalid datatype {} for {} column {}&quot;,
</a><a href="#h26-8-11" id="h26-8-11" class="i">+                datatype,
</a><a href="#h26-8-12" id="h26-8-12" class="i">+                self.datatype,
</a><a href="#h26-8-13" id="h26-8-13" class="i">+                self.name
</a><a href="#h26-8-14" id="h26-8-14" class="i">+            ),
</a>             _ =&gt; Ok(()),
         }?;
 
         // Validate value
         match value {
             Value::String(s) if s.len() &gt; 1024 =&gt; {
<a href="#h26-8-21" id="h26-8-21" class="d">-                Err(Error::Value(&quot;Strings cannot be more than 1024 bytes&quot;.into()))
</a><a href="#h26-8-22" id="h26-8-22" class="i">+                errinput!(&quot;strings cannot be more than 1024 bytes&quot;)
</a>             }
             _ =&gt; Ok(()),
         }?;
<a href="#h26-9" id="h26-9" class="h">@@ -250,10 +252,9 @@ impl Column {
</a>                 Value::Null =&gt; Ok(()),
                 Value::Float(f) if f.is_nan() =&gt; Ok(()),
                 v if target == &amp;table.name &amp;&amp; v == pk =&gt; Ok(()),
<a href="#h26-9-3" id="h26-9-3" class="d">-                v if txn.read(target, v)?.is_none() =&gt; Err(Error::Value(format!(
</a><a href="#h26-9-4" id="h26-9-4" class="d">-                    &quot;Referenced primary key {} in table {} does not exist&quot;,
</a><a href="#h26-9-5" id="h26-9-5" class="d">-                    v, target,
</a><a href="#h26-9-6" id="h26-9-6" class="d">-                ))),
</a><a href="#h26-9-7" id="h26-9-7" class="i">+                v if txn.read(target, v)?.is_none() =&gt; {
</a><a href="#h26-9-8" id="h26-9-8" class="i">+                    errinput!(&quot;referenced primary key {v} in table {target} does not exist&quot;,)
</a><a href="#h26-9-9" id="h26-9-9" class="i">+                }
</a>                 _ =&gt; Ok(()),
             }?;
         }
<a href="#h26-10" id="h26-10" class="h">@@ -266,10 +267,10 @@ impl Column {
</a>                 if row.get(index).unwrap_or(&amp;Value::Null) == value
                     &amp;&amp; &amp;table.get_row_key(&amp;row)? != pk
                 {
<a href="#h26-10-3" id="h26-10-3" class="d">-                    return Err(Error::Value(format!(
</a><a href="#h26-10-4" id="h26-10-4" class="d">-                        &quot;Unique value {} already exists for column {}&quot;,
</a><a href="#h26-10-5" id="h26-10-5" class="d">-                        value, self.name
</a><a href="#h26-10-6" id="h26-10-6" class="d">-                    )));
</a><a href="#h26-10-7" id="h26-10-7" class="i">+                    return errinput!(
</a><a href="#h26-10-8" id="h26-10-8" class="i">+                        &quot;unique value {value} already exists for column {}&quot;,
</a><a href="#h26-10-9" id="h26-10-9" class="i">+                        self.name
</a><a href="#h26-10-10" id="h26-10-10" class="i">+                    );
</a>                 }
             }
         }
<b>diff --git a/<a id="h27" href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a> b/<a href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -1,4 +1,5 @@
</a> use super::{Row, Value};
<a href="#h27-0-1" id="h27-0-1" class="i">+use crate::errinput;
</a> use crate::error::{Error, Result};
 
 use regex::Regex;
<a href="#h27-1" id="h27-1" class="h">@@ -56,12 +57,12 @@ impl Expression {
</a>                 (Null, Boolean(rhs)) if !rhs =&gt; Boolean(false),
                 (Null, Boolean(_)) =&gt; Null,
                 (Null, Null) =&gt; Null,
<a href="#h27-1-3" id="h27-1-3" class="d">-                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t and {} and {}&quot;, lhs, rhs))),
</a><a href="#h27-1-4" id="h27-1-4" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t and {lhs} and {rhs}&quot;),
</a>             },
             Self::Not(expr) =&gt; match expr.evaluate(row)? {
                 Boolean(b) =&gt; Boolean(!b),
                 Null =&gt; Null,
<a href="#h27-1-9" id="h27-1-9" class="d">-                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t negate {}&quot;, value))),
</a><a href="#h27-1-10" id="h27-1-10" class="i">+                value =&gt; return errinput!(&quot;can&#39;t negate {value}&quot;),
</a>             },
             Self::Or(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
                 (Boolean(lhs), Boolean(rhs)) =&gt; Boolean(lhs || rhs),
<a href="#h27-2" id="h27-2" class="h">@@ -70,7 +71,7 @@ impl Expression {
</a>                 (Null, Boolean(rhs)) if rhs =&gt; Boolean(true),
                 (Null, Boolean(_)) =&gt; Null,
                 (Null, Null) =&gt; Null,
<a href="#h27-2-3" id="h27-2-3" class="d">-                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t or {} and {}&quot;, lhs, rhs))),
</a><a href="#h27-2-4" id="h27-2-4" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t or {lhs} and {rhs}&quot;),
</a>             },
 
             // Comparison operations
<a href="#h27-3" id="h27-3" class="h">@@ -83,9 +84,7 @@ impl Expression {
</a>                 (Float(lhs), Float(rhs)) =&gt; Boolean(lhs == rhs),
                 (String(lhs), String(rhs)) =&gt; Boolean(lhs == rhs),
                 (Null, _) | (_, Null) =&gt; Null,
<a href="#h27-3-3" id="h27-3-3" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h27-3-4" id="h27-3-4" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h27-3-5" id="h27-3-5" class="d">-                }
</a><a href="#h27-3-6" id="h27-3-6" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t compare {lhs} and {rhs}&quot;),
</a>             },
             Self::GreaterThan(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
                 #[allow(clippy::bool_comparison)]
<a href="#h27-4" id="h27-4" class="h">@@ -96,9 +95,7 @@ impl Expression {
</a>                 (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &gt; rhs),
                 (String(lhs), String(rhs)) =&gt; Boolean(lhs &gt; rhs),
                 (Null, _) | (_, Null) =&gt; Null,
<a href="#h27-4-3" id="h27-4-3" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h27-4-4" id="h27-4-4" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h27-4-5" id="h27-4-5" class="d">-                }
</a><a href="#h27-4-6" id="h27-4-6" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t compare {lhs} and {rhs}&quot;),
</a>             },
             Self::LessThan(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
                 #[allow(clippy::bool_comparison)]
<a href="#h27-5" id="h27-5" class="h">@@ -109,9 +106,7 @@ impl Expression {
</a>                 (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &lt; rhs),
                 (String(lhs), String(rhs)) =&gt; Boolean(lhs &lt; rhs),
                 (Null, _) | (_, Null) =&gt; Null,
<a href="#h27-5-3" id="h27-5-3" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h27-5-4" id="h27-5-4" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h27-5-5" id="h27-5-5" class="d">-                }
</a><a href="#h27-5-6" id="h27-5-6" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t compare {lhs} and {rhs}&quot;),
</a>             },
             Self::IsNull(expr) =&gt; match expr.evaluate(row)? {
                 Null =&gt; Boolean(true),
<a href="#h27-6" id="h27-6" class="h">@@ -120,9 +115,9 @@ impl Expression {
</a> 
             // Mathematical operations
             Self::Add(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
<a href="#h27-6-3" id="h27-6-3" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(
</a><a href="#h27-6-4" id="h27-6-4" class="d">-                    lhs.checked_add(rhs).ok_or_else(|| Error::Value(&quot;Integer overflow&quot;.into()))?,
</a><a href="#h27-6-5" id="h27-6-5" class="d">-                ),
</a><a href="#h27-6-6" id="h27-6-6" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; {
</a><a href="#h27-6-7" id="h27-6-7" class="i">+                    Integer(lhs.checked_add(rhs).ok_or::&lt;Error&gt;(errinput!(&quot;integer overflow&quot;))?)
</a><a href="#h27-6-8" id="h27-6-8" class="i">+                }
</a>                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 + rhs),
                 (Integer(_), Null) =&gt; Null,
                 (Float(lhs), Float(rhs)) =&gt; Float(lhs + rhs),
<a href="#h27-7" id="h27-7" class="h">@@ -131,18 +126,16 @@ impl Expression {
</a>                 (Null, Float(_)) =&gt; Null,
                 (Null, Integer(_)) =&gt; Null,
                 (Null, Null) =&gt; Null,
<a href="#h27-7-3" id="h27-7-3" class="d">-                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t add {} and {}&quot;, lhs, rhs))),
</a><a href="#h27-7-4" id="h27-7-4" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t add {lhs} and {rhs}&quot;),
</a>             },
             Self::Assert(expr) =&gt; match expr.evaluate(row)? {
                 Float(f) =&gt; Float(f),
                 Integer(i) =&gt; Integer(i),
                 Null =&gt; Null,
<a href="#h27-7-10" id="h27-7-10" class="d">-                expr =&gt; return Err(Error::Value(format!(&quot;Can&#39;t take the positive of {}&quot;, expr))),
</a><a href="#h27-7-11" id="h27-7-11" class="i">+                expr =&gt; return errinput!(&quot;can&#39;t take the positive of {expr}&quot;),
</a>             },
             Self::Divide(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
<a href="#h27-7-14" id="h27-7-14" class="d">-                (Integer(_), Integer(0)) =&gt; {
</a><a href="#h27-7-15" id="h27-7-15" class="d">-                    return Err(Error::Value(&quot;Can&#39;t divide by zero&quot;.into()))
</a><a href="#h27-7-16" id="h27-7-16" class="d">-                }
</a><a href="#h27-7-17" id="h27-7-17" class="i">+                (Integer(_), Integer(0)) =&gt; return errinput!(&quot;can&#39;t divide by zero&quot;),
</a>                 (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs / rhs),
                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 / rhs),
                 (Integer(_), Null) =&gt; Null,
<a href="#h27-8" id="h27-8" class="h">@@ -152,14 +145,11 @@ impl Expression {
</a>                 (Null, Float(_)) =&gt; Null,
                 (Null, Integer(_)) =&gt; Null,
                 (Null, Null) =&gt; Null,
<a href="#h27-8-3" id="h27-8-3" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h27-8-4" id="h27-8-4" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t divide {} and {}&quot;, lhs, rhs)))
</a><a href="#h27-8-5" id="h27-8-5" class="d">-                }
</a><a href="#h27-8-6" id="h27-8-6" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t divide {lhs} and {rhs}&quot;),
</a>             },
             Self::Exponentiate(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
                 (Integer(lhs), Integer(rhs)) if rhs &gt;= 0 =&gt; Integer(
<a href="#h27-8-10" id="h27-8-10" class="d">-                    lhs.checked_pow(rhs as u32)
</a><a href="#h27-8-11" id="h27-8-11" class="d">-                        .ok_or_else(|| Error::Value(&quot;Integer overflow&quot;.into()))?,
</a><a href="#h27-8-12" id="h27-8-12" class="i">+                    lhs.checked_pow(rhs as u32).ok_or::&lt;Error&gt;(errinput!(&quot;integer overflow&quot;))?,
</a>                 ),
                 (Integer(lhs), Integer(rhs)) =&gt; Float((lhs as f64).powf(rhs as f64)),
                 (Integer(lhs), Float(rhs)) =&gt; Float((lhs as f64).powf(rhs)),
<a href="#h27-9" id="h27-9" class="h">@@ -170,23 +160,17 @@ impl Expression {
</a>                 (Null, Float(_)) =&gt; Null,
                 (Null, Integer(_)) =&gt; Null,
                 (Null, Null) =&gt; Null,
<a href="#h27-9-3" id="h27-9-3" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h27-9-4" id="h27-9-4" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t exponentiate {} and {}&quot;, lhs, rhs)))
</a><a href="#h27-9-5" id="h27-9-5" class="d">-                }
</a><a href="#h27-9-6" id="h27-9-6" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t exponentiate {lhs} and {rhs}&quot;),
</a>             },
             Self::Factorial(expr) =&gt; match expr.evaluate(row)? {
<a href="#h27-9-9" id="h27-9-9" class="d">-                Integer(i) if i &lt; 0 =&gt; {
</a><a href="#h27-9-10" id="h27-9-10" class="d">-                    return Err(Error::Value(&quot;Can&#39;t take factorial of negative number&quot;.into()))
</a><a href="#h27-9-11" id="h27-9-11" class="d">-                }
</a><a href="#h27-9-12" id="h27-9-12" class="i">+                Integer(i) if i &lt; 0 =&gt; return errinput!(&quot;can&#39;t take factorial of negative number&quot;),
</a>                 Integer(i) =&gt; Integer((1..=i).product()),
                 Null =&gt; Null,
<a href="#h27-9-15" id="h27-9-15" class="d">-                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t take factorial of {}&quot;, value))),
</a><a href="#h27-9-16" id="h27-9-16" class="i">+                value =&gt; return errinput!(&quot;can&#39;t take factorial of {value}&quot;),
</a>             },
             Self::Modulo(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
                 // This uses remainder semantics, like Postgres.
<a href="#h27-9-20" id="h27-9-20" class="d">-                (Integer(_), Integer(0)) =&gt; {
</a><a href="#h27-9-21" id="h27-9-21" class="d">-                    return Err(Error::Value(&quot;Can&#39;t divide by zero&quot;.into()))
</a><a href="#h27-9-22" id="h27-9-22" class="d">-                }
</a><a href="#h27-9-23" id="h27-9-23" class="i">+                (Integer(_), Integer(0)) =&gt; return errinput!(&quot;can&#39;t divide by zero&quot;),
</a>                 (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs % rhs),
                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 % rhs),
                 (Integer(_), Null) =&gt; Null,
<a href="#h27-10" id="h27-10" class="h">@@ -196,14 +180,12 @@ impl Expression {
</a>                 (Null, Float(_)) =&gt; Null,
                 (Null, Integer(_)) =&gt; Null,
                 (Null, Null) =&gt; Null,
<a href="#h27-10-3" id="h27-10-3" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h27-10-4" id="h27-10-4" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t take modulo of {} and {}&quot;, lhs, rhs)))
</a><a href="#h27-10-5" id="h27-10-5" class="d">-                }
</a><a href="#h27-10-6" id="h27-10-6" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t take modulo of {lhs} and {rhs}&quot;),
</a>             },
             Self::Multiply(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
<a href="#h27-10-9" id="h27-10-9" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(
</a><a href="#h27-10-10" id="h27-10-10" class="d">-                    lhs.checked_mul(rhs).ok_or_else(|| Error::Value(&quot;Integer overflow&quot;.into()))?,
</a><a href="#h27-10-11" id="h27-10-11" class="d">-                ),
</a><a href="#h27-10-12" id="h27-10-12" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; {
</a><a href="#h27-10-13" id="h27-10-13" class="i">+                    Integer(lhs.checked_mul(rhs).ok_or::&lt;Error&gt;(errinput!(&quot;integer overflow&quot;))?)
</a><a href="#h27-10-14" id="h27-10-14" class="i">+                }
</a>                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 * rhs),
                 (Integer(_), Null) =&gt; Null,
                 (Float(lhs), Integer(rhs)) =&gt; Float(lhs * rhs as f64),
<a href="#h27-11" id="h27-11" class="h">@@ -212,20 +194,18 @@ impl Expression {
</a>                 (Null, Float(_)) =&gt; Null,
                 (Null, Integer(_)) =&gt; Null,
                 (Null, Null) =&gt; Null,
<a href="#h27-11-3" id="h27-11-3" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h27-11-4" id="h27-11-4" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t multiply {} and {}&quot;, lhs, rhs)))
</a><a href="#h27-11-5" id="h27-11-5" class="d">-                }
</a><a href="#h27-11-6" id="h27-11-6" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t multiply {lhs} and {rhs}&quot;),
</a>             },
             Self::Negate(expr) =&gt; match expr.evaluate(row)? {
                 Integer(i) =&gt; Integer(-i),
                 Float(f) =&gt; Float(-f),
                 Null =&gt; Null,
<a href="#h27-11-12" id="h27-11-12" class="d">-                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t negate {}&quot;, value))),
</a><a href="#h27-11-13" id="h27-11-13" class="i">+                value =&gt; return errinput!(&quot;can&#39;t negate {value}&quot;),
</a>             },
             Self::Subtract(lhs, rhs) =&gt; match (lhs.evaluate(row)?, rhs.evaluate(row)?) {
<a href="#h27-11-16" id="h27-11-16" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(
</a><a href="#h27-11-17" id="h27-11-17" class="d">-                    lhs.checked_sub(rhs).ok_or_else(|| Error::Value(&quot;Integer overflow&quot;.into()))?,
</a><a href="#h27-11-18" id="h27-11-18" class="d">-                ),
</a><a href="#h27-11-19" id="h27-11-19" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; {
</a><a href="#h27-11-20" id="h27-11-20" class="i">+                    Integer(lhs.checked_sub(rhs).ok_or::&lt;Error&gt;(errinput!(&quot;integer overflow&quot;))?)
</a><a href="#h27-11-21" id="h27-11-21" class="i">+                }
</a>                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 - rhs),
                 (Integer(_), Null) =&gt; Null,
                 (Float(lhs), Integer(rhs)) =&gt; Float(lhs - rhs as f64),
<a href="#h27-12" id="h27-12" class="h">@@ -234,9 +214,7 @@ impl Expression {
</a>                 (Null, Float(_)) =&gt; Null,
                 (Null, Integer(_)) =&gt; Null,
                 (Null, Null) =&gt; Null,
<a href="#h27-12-3" id="h27-12-3" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h27-12-4" id="h27-12-4" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t subtract {} and {}&quot;, lhs, rhs)))
</a><a href="#h27-12-5" id="h27-12-5" class="d">-                }
</a><a href="#h27-12-6" id="h27-12-6" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t subtract {lhs} and {rhs}&quot;),
</a>             },
 
             // String operations
<a href="#h27-13" id="h27-13" class="h">@@ -254,7 +232,7 @@ impl Expression {
</a>                 ),
                 (String(_), Null) =&gt; Null,
                 (Null, String(_)) =&gt; Null,
<a href="#h27-13-3" id="h27-13-3" class="d">-                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t LIKE {} and {}&quot;, lhs, rhs))),
</a><a href="#h27-13-4" id="h27-13-4" class="i">+                (lhs, rhs) =&gt; return errinput!(&quot;can&#39;t LIKE {lhs} and {rhs}&quot;),
</a>             },
         })
     }
<b>diff --git a/<a id="h28" href="../file/src/sql/types/mod.rs.html">src/sql/types/mod.rs</a> b/<a href="../file/src/sql/types/mod.rs.html">src/sql/types/mod.rs</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -1,8 +1,8 @@
</a> mod expression;
 pub use expression::Expression;
 
<a href="#h28-0-3" id="h28-0-3" class="d">-use crate::encoding;
</a><a href="#h28-0-4" id="h28-0-4" class="d">-use crate::error::{Error, Result};
</a><a href="#h28-0-5" id="h28-0-5" class="i">+use crate::error::Result;
</a><a href="#h28-0-6" id="h28-0-6" class="i">+use crate::{encoding, errdata};
</a> 
 use serde_derive::{Deserialize, Serialize};
 use std::borrow::Cow;
<a href="#h28-1" id="h28-1" class="h">@@ -85,7 +85,7 @@ impl Value {
</a>     pub fn boolean(self) -&gt; Result&lt;bool&gt; {
         match self {
             Self::Boolean(b) =&gt; Ok(b),
<a href="#h28-1-3" id="h28-1-3" class="d">-            v =&gt; Err(Error::Value(format!(&quot;Not a boolean: {:?}&quot;, v))),
</a><a href="#h28-1-4" id="h28-1-4" class="i">+            v =&gt; errdata!(&quot;not a boolean: {v:?}&quot;),
</a>         }
     }
 
<a href="#h28-2" id="h28-2" class="h">@@ -93,7 +93,7 @@ impl Value {
</a>     pub fn float(self) -&gt; Result&lt;f64&gt; {
         match self {
             Self::Float(f) =&gt; Ok(f),
<a href="#h28-2-3" id="h28-2-3" class="d">-            v =&gt; Err(Error::Value(format!(&quot;Not a float: {:?}&quot;, v))),
</a><a href="#h28-2-4" id="h28-2-4" class="i">+            v =&gt; errdata!(&quot;not a float: {v:?}&quot;),
</a>         }
     }
 
<a href="#h28-3" id="h28-3" class="h">@@ -101,7 +101,7 @@ impl Value {
</a>     pub fn integer(self) -&gt; Result&lt;i64&gt; {
         match self {
             Self::Integer(i) =&gt; Ok(i),
<a href="#h28-3-3" id="h28-3-3" class="d">-            v =&gt; Err(Error::Value(format!(&quot;Not an integer: {:?}&quot;, v))),
</a><a href="#h28-3-4" id="h28-3-4" class="i">+            v =&gt; errdata!(&quot;not an integer: {v:?}&quot;),
</a>         }
     }
 
<a href="#h28-4" id="h28-4" class="h">@@ -109,7 +109,7 @@ impl Value {
</a>     pub fn string(self) -&gt; Result&lt;String&gt; {
         match self {
             Self::String(s) =&gt; Ok(s),
<a href="#h28-4-3" id="h28-4-3" class="d">-            v =&gt; Err(Error::Value(format!(&quot;Not a string: {:?}&quot;, v))),
</a><a href="#h28-4-4" id="h28-4-4" class="i">+            v =&gt; errdata!(&quot;not a string: {v:?}&quot;),
</a>         }
     }
 }
<b>diff --git a/<a id="h29" href="../file/src/storage/golden/mvcc/begin_as_of.html">src/storage/golden/mvcc/begin_as_of</a> b/<a href="../file/src/storage/golden/mvcc/begin_as_of.html">src/storage/golden/mvcc/begin_as_of</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -75,9 +75,9 @@ T7: scan ..
</a>     &quot;key&quot; = 0x03
     &quot;other&quot; = 0x01
 
<a href="#h29-0-3" id="h29-0-3" class="d">-T8: begin as of 5 → Error::Value(&quot;Version 5 does not exist&quot;)
</a><a href="#h29-0-4" id="h29-0-4" class="i">+T8: begin as of 5 → Error::InvalidInput(&quot;version 5 does not exist&quot;)
</a> 
<a href="#h29-0-6" id="h29-0-6" class="d">-T9: begin as of 9 → Error::Value(&quot;Version 9 does not exist&quot;)
</a><a href="#h29-0-7" id="h29-0-7" class="i">+T9: begin as of 9 → Error::InvalidInput(&quot;version 9 does not exist&quot;)
</a> 
 Engine state:
 NextVersion = 5
<b>diff --git a/<a id="h30" href="../file/src/storage/golden/mvcc/resume.html">src/storage/golden/mvcc/resume</a> b/<a href="../file/src/storage/golden/mvcc/resume.html">src/storage/golden/mvcc/resume</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -84,7 +84,7 @@ T7: scan ..
</a> T7: rollback
     del TxnActive(6)
 
<a href="#h30-0-3" id="h30-0-3" class="d">-T8: resume → Error::Internal(&quot;No active transaction at version 3&quot;)
</a><a href="#h30-0-4" id="h30-0-4" class="i">+T8: resume → Error::InvalidInput(&quot;no active transaction at version 3&quot;)
</a> 
 T9: begin as of 3 → v3 read-only active={2}
 
<b>diff --git a/<a id="h31" href="../file/src/storage/mvcc.rs.html">src/storage/mvcc.rs</a> b/<a href="../file/src/storage/mvcc.rs.html">src/storage/mvcc.rs</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -142,6 +142,7 @@
</a> use super::engine::Engine;
 use crate::encoding::{self, bincode, Key as _, Value as _};
 use crate::error::{Error, Result};
<a href="#h31-0-3" id="h31-0-3" class="i">+use crate::{errdata, errinput};
</a> 
 use serde::{Deserialize, Serialize};
 use std::borrow::Cow;
<a href="#h31-1" id="h31-1" class="h">@@ -399,7 +400,7 @@ impl&lt;E: Engine&gt; Transaction&lt;E&gt; {
</a>         let mut active = HashSet::new();
         if let Some(as_of) = as_of {
             if as_of &gt;= version {
<a href="#h31-1-3" id="h31-1-3" class="d">-                return Err(Error::Value(format!(&quot;Version {} does not exist&quot;, as_of)));
</a><a href="#h31-1-4" id="h31-1-4" class="i">+                return errinput!(&quot;version {as_of} does not exist&quot;);
</a>             }
             version = as_of;
             if let Some(value) = session.get(&amp;Key::TxnActiveSnapshot(version).encode()?)? {
<a href="#h31-2" id="h31-2" class="h">@@ -419,7 +420,7 @@ impl&lt;E: Engine&gt; Transaction&lt;E&gt; {
</a>         // For read-write transactions, verify that the transaction is still
         // active before making further writes.
         if !s.read_only &amp;&amp; engine.lock()?.get(&amp;Key::TxnActive(s.version).encode()?)?.is_none() {
<a href="#h31-2-3" id="h31-2-3" class="d">-            return Err(Error::Internal(format!(&quot;No active transaction at version {}&quot;, s.version)));
</a><a href="#h31-2-4" id="h31-2-4" class="i">+            return errinput!(&quot;no active transaction at version {}&quot;, s.version);
</a>         }
         Ok(Self { engine, st: s })
     }
<a href="#h31-3" id="h31-3" class="h">@@ -431,7 +432,7 @@ impl&lt;E: Engine&gt; Transaction&lt;E&gt; {
</a>         while let Some((key, _)) = scan.next().transpose()? {
             match Key::decode(&amp;key)? {
                 Key::TxnActive(version) =&gt; active.insert(version),
<a href="#h31-3-3" id="h31-3-3" class="d">-                _ =&gt; return Err(Error::Internal(format!(&quot;Expected TxnActive key, got {:?}&quot;, key))),
</a><a href="#h31-3-4" id="h31-3-4" class="i">+                key =&gt; return errdata!(&quot;expected TxnActive key, got {key:?}&quot;),
</a>             };
         }
         Ok(active)
<a href="#h31-4" id="h31-4" class="h">@@ -489,7 +490,7 @@ impl&lt;E: Engine&gt; Transaction&lt;E&gt; {
</a>                 Key::TxnWrite(_, key) =&gt; {
                     rollback.push(Key::Version(key, self.st.version).encode()?) // the version
                 }
<a href="#h31-4-3" id="h31-4-3" class="d">-                key =&gt; return Err(Error::Internal(format!(&quot;Expected TxnWrite, got {:?}&quot;, key))),
</a><a href="#h31-4-4" id="h31-4-4" class="i">+                key =&gt; return errdata!(&quot;expected TxnWrite, got {key:?}&quot;),
</a>             };
             rollback.push(key); // the TxnWrite record
         }
<a href="#h31-5" id="h31-5" class="h">@@ -537,7 +538,7 @@ impl&lt;E: Engine&gt; Transaction&lt;E&gt; {
</a>                         return Err(Error::Serialization);
                     }
                 }
<a href="#h31-5-3" id="h31-5-3" class="d">-                key =&gt; return Err(Error::Internal(format!(&quot;Expected Key::Version got {:?}&quot;, key))),
</a><a href="#h31-5-4" id="h31-5-4" class="i">+                key =&gt; return errdata!(&quot;expected Key::Version got {key:?}&quot;),
</a>             }
         }
 
<a href="#h31-6" id="h31-6" class="h">@@ -563,7 +564,7 @@ impl&lt;E: Engine&gt; Transaction&lt;E&gt; {
</a>                         return bincode::deserialize(&amp;value);
                     }
                 }
<a href="#h31-6-3" id="h31-6-3" class="d">-                key =&gt; return Err(Error::Internal(format!(&quot;Expected Key::Version got {:?}&quot;, key))),
</a><a href="#h31-6-4" id="h31-6-4" class="i">+                key =&gt; return errdata!(&quot;expected Key::Version got {key:?}&quot;),
</a>             };
         }
         Ok(None)
<a href="#h31-7" id="h31-7" class="h">@@ -738,7 +739,7 @@ impl&lt;&#39;a, E: Engine + &#39;a&gt; VersionIterator&lt;&#39;a, E&gt; {
</a>     fn decode_visible(&amp;self, key: &amp;[u8]) -&gt; Result&lt;Option&lt;(Vec&lt;u8&gt;, Version)&gt;&gt; {
         let (key, version) = match Key::decode(key)? {
             Key::Version(key, version) =&gt; (key.into_owned(), version),
<a href="#h31-7-3" id="h31-7-3" class="d">-            key =&gt; return Err(Error::Internal(format!(&quot;Expected Key::Version got {:?}&quot;, key))),
</a><a href="#h31-7-4" id="h31-7-4" class="i">+            key =&gt; return errdata!(&quot;expected Key::Version got {key:?}&quot;),
</a>         };
         if self.txn.is_visible(version) {
             Ok(Some((key, version)))
<a href="#h31-8" id="h31-8" class="h">@@ -1271,11 +1272,11 @@ pub mod tests {
</a>         // Check that future versions are invalid, including the next.
         assert_eq!(
             mvcc.begin_as_of(5).err(),
<a href="#h31-8-3" id="h31-8-3" class="d">-            Some(Error::Value(&quot;Version 5 does not exist&quot;.into()))
</a><a href="#h31-8-4" id="h31-8-4" class="i">+            Some(Error::InvalidInput(&quot;version 5 does not exist&quot;.into()))
</a>         );
         assert_eq!(
             mvcc.begin_as_of(9).err(),
<a href="#h31-8-8" id="h31-8-8" class="d">-            Some(Error::Value(&quot;Version 9 does not exist&quot;.into()))
</a><a href="#h31-8-9" id="h31-8-9" class="i">+            Some(Error::InvalidInput(&quot;version 9 does not exist&quot;.into()))
</a>         );
 
         Ok(())
<a href="#h31-9" id="h31-9" class="h">@@ -1345,7 +1346,7 @@ pub mod tests {
</a>         // Resuming an inactive transaction should error.
         assert_eq!(
             mvcc.resume(state).err(),
<a href="#h31-9-3" id="h31-9-3" class="d">-            Some(Error::Internal(&quot;No active transaction at version 3&quot;.into()))
</a><a href="#h31-9-4" id="h31-9-4" class="i">+            Some(Error::InvalidInput(&quot;no active transaction at version 3&quot;.into()))
</a>         );
 
         // It should also be possible to start a snapshot transaction in t3
<b>diff --git a/<a id="h32" href="../file/tests/e2e/client.rs.html">tests/e2e/client.rs</a> b/<a href="../file/tests/e2e/client.rs.html">tests/e2e/client.rs</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -18,7 +18,10 @@ fn get_table() -&gt; Result&lt;()&gt; {
</a>     let tc = TestCluster::run_with(5, dataset::MOVIES)?;
     let mut c = tc.connect_any()?;
 
<a href="#h32-0-3" id="h32-0-3" class="d">-    assert_eq!(c.get_table(&quot;unknown&quot;), Err(Error::Value(&quot;Table unknown does not exist&quot;.into())));
</a><a href="#h32-0-4" id="h32-0-4" class="i">+    assert_eq!(
</a><a href="#h32-0-5" id="h32-0-5" class="i">+        c.get_table(&quot;unknown&quot;),
</a><a href="#h32-0-6" id="h32-0-6" class="i">+        Err(Error::InvalidInput(&quot;table unknown does not exist&quot;.into()))
</a><a href="#h32-0-7" id="h32-0-7" class="i">+    );
</a>     assert_eq!(
         c.get_table(&quot;movies&quot;)?,
         schema::Table {
<a href="#h32-1" id="h32-1" class="h">@@ -186,12 +189,15 @@ fn execute() -&gt; Result&lt;()&gt; {
</a>     );
     assert_rows(result, Vec::new());
 
<a href="#h32-1-3" id="h32-1-3" class="d">-    assert_eq!(c.execute(&quot;SELECT * FROM x&quot;), Err(Error::Value(&quot;Table x does not exist&quot;.into())));
</a><a href="#h32-1-4" id="h32-1-4" class="i">+    assert_eq!(
</a><a href="#h32-1-5" id="h32-1-5" class="i">+        c.execute(&quot;SELECT * FROM x&quot;),
</a><a href="#h32-1-6" id="h32-1-6" class="i">+        Err(Error::InvalidInput(&quot;table x does not exist&quot;.into()))
</a><a href="#h32-1-7" id="h32-1-7" class="i">+    );
</a> 
     // INSERT
     assert_eq!(
         c.execute(&quot;INSERT INTO genres VALUES (1, &#39;Western&#39;)&quot;),
<a href="#h32-1-12" id="h32-1-12" class="d">-        Err(Error::Value(&quot;Primary key 1 already exists for table genres&quot;.into())),
</a><a href="#h32-1-13" id="h32-1-13" class="i">+        Err(Error::InvalidInput(&quot;primary key 1 already exists for table genres&quot;.into())),
</a>     );
     assert_eq!(
         c.execute(&quot;INSERT INTO genres VALUES (9, &#39;Western&#39;)&quot;),
<a href="#h32-2" id="h32-2" class="h">@@ -199,7 +205,7 @@ fn execute() -&gt; Result&lt;()&gt; {
</a>     );
     assert_eq!(
         c.execute(&quot;INSERT INTO x VALUES (9, &#39;Western&#39;)&quot;),
<a href="#h32-2-3" id="h32-2-3" class="d">-        Err(Error::Value(&quot;Table x does not exist&quot;.into()))
</a><a href="#h32-2-4" id="h32-2-4" class="i">+        Err(Error::InvalidInput(&quot;table x does not exist&quot;.into()))
</a>     );
 
     // UPDATE
<a href="#h32-3" id="h32-3" class="h">@@ -213,7 +219,7 @@ fn execute() -&gt; Result&lt;()&gt; {
</a>     );
     assert_eq!(
         c.execute(&quot;UPDATE genres SET id = 1 WHERE id = 9&quot;),
<a href="#h32-3-3" id="h32-3-3" class="d">-        Err(Error::Value(&quot;Primary key 1 already exists for table genres&quot;.into()))
</a><a href="#h32-3-4" id="h32-3-4" class="i">+        Err(Error::InvalidInput(&quot;primary key 1 already exists for table genres&quot;.into()))
</a>     );
 
     // DELETE
<a href="#h32-4" id="h32-4" class="h">@@ -221,7 +227,7 @@ fn execute() -&gt; Result&lt;()&gt; {
</a>     assert_eq!(c.execute(&quot;DELETE FROM genres WHERE id = 9&quot;), Ok(ResultSet::Delete { count: 1 }),);
     assert_eq!(
         c.execute(&quot;DELETE FROM genres WHERE x = 1&quot;),
<a href="#h32-4-3" id="h32-4-3" class="d">-        Err(Error::Value(&quot;Unknown field x&quot;.into()))
</a><a href="#h32-4-4" id="h32-4-4" class="i">+        Err(Error::InvalidInput(&quot;unknown field x&quot;.into()))
</a>     );
 
     Ok(())
<a href="#h32-5" id="h32-5" class="h">@@ -296,7 +302,7 @@ fn execute_txn() -&gt; Result&lt;()&gt; {
</a>     c.execute(&quot;INSERT INTO genres VALUES (5, &#39;Horror&#39;)&quot;)?;
     assert_eq!(
         c.execute(&quot;INSERT INTO genres VALUES (5, &#39;Musical&#39;)&quot;),
<a href="#h32-5-3" id="h32-5-3" class="d">-        Err(Error::Value(&quot;Primary key 5 already exists for table genres&quot;.into()))
</a><a href="#h32-5-4" id="h32-5-4" class="i">+        Err(Error::InvalidInput(&quot;primary key 5 already exists for table genres&quot;.into()))
</a>     );
     assert_eq!(c.txn(), Some((4, false)));
     c.execute(&quot;INSERT INTO genres VALUES (6, &#39;Western&#39;)&quot;)?;
<b>diff --git a/<a id="h33" href="../file/tests/sql/expression.rs.html">tests/sql/expression.rs</a> b/<a href="../file/tests/sql/expression.rs.html">tests/sql/expression.rs</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -58,8 +58,8 @@ test_expr! {
</a>     lit_integer_zeroprefix: &quot;03&quot; =&gt; Ok(Integer(3)),
     lit_integer_max: &quot;9223372036854775807&quot; =&gt; Ok(Integer(9_223_372_036_854_775_807)),
     lit_integer_min: &quot;-9223372036854775807&quot; =&gt; Ok(Integer(-9_223_372_036_854_775_807)),
<a href="#h33-0-3" id="h33-0-3" class="d">-    lit_integer_overflow: &quot;9223372036854775808&quot; =&gt; Err(Error::Parse(&quot;number too large to fit in target type&quot;.into())),
</a><a href="#h33-0-4" id="h33-0-4" class="d">-    lit_integer_underflow: &quot;-9223372036854775808&quot; =&gt; Err(Error::Parse(&quot;number too large to fit in target type&quot;.into())),
</a><a href="#h33-0-5" id="h33-0-5" class="i">+    lit_integer_overflow: &quot;9223372036854775808&quot; =&gt; Err(Error::InvalidInput(&quot;number too large to fit in target type&quot;.into())),
</a><a href="#h33-0-6" id="h33-0-6" class="i">+    lit_integer_underflow: &quot;-9223372036854775808&quot; =&gt; Err(Error::InvalidInput(&quot;number too large to fit in target type&quot;.into())),
</a> 
     lit_string: &quot;&#39;Hi! 👋&#39;&quot; =&gt; Ok(String(&quot;Hi! 👋&quot;.into())),
     lit_string_escape: r#&quot;&#39;Try \n newlines and \t tabs&#39;&quot;# =&gt; Ok(String(r#&quot;Try \n newlines and \t tabs&quot;#.into())),
<a href="#h33-1" id="h33-1" class="h">@@ -68,12 +68,12 @@ test_expr! {
</a>     lit_string_long: &amp;format!(&quot;&#39;{}&#39;&quot;, &quot;a&quot;.repeat(4096)) =&gt; Ok(&quot;a&quot;.repeat(4096).into()),
 
     // Functions
<a href="#h33-1-3" id="h33-1-3" class="d">-    func_unknown: &quot;unknown()&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown&quot;.into())),
</a><a href="#h33-1-4" id="h33-1-4" class="d">-    func_unknown_case: &quot;UnKnown ( )&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown&quot;.into())),
</a><a href="#h33-1-5" id="h33-1-5" class="d">-    func_unknown_space: &quot;unknown ( )&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown&quot;.into())),
</a><a href="#h33-1-6" id="h33-1-6" class="d">-    func_unknown_args: &quot;unknown(a, b, c)&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown&quot;.into())),
</a><a href="#h33-1-7" id="h33-1-7" class="d">-    func_unknown_open: &quot;unknown(a, b, c&quot; =&gt; Err(Error::Parse(&quot;Unexpected end of input&quot;.into())),
</a><a href="#h33-1-8" id="h33-1-8" class="d">-    func_unknown_trailing_comma: &quot;unknown(a, b, c,)&quot; =&gt; Err(Error::Parse(&quot;Expected expression atom, found )&quot;.into())),
</a><a href="#h33-1-9" id="h33-1-9" class="i">+    func_unknown: &quot;unknown()&quot; =&gt; Err(Error::InvalidInput(&quot;unknown function unknown&quot;.into())),
</a><a href="#h33-1-10" id="h33-1-10" class="i">+    func_unknown_case: &quot;UnKnown ( )&quot; =&gt; Err(Error::InvalidInput(&quot;unknown function unknown&quot;.into())),
</a><a href="#h33-1-11" id="h33-1-11" class="i">+    func_unknown_space: &quot;unknown ( )&quot; =&gt; Err(Error::InvalidInput(&quot;unknown function unknown&quot;.into())),
</a><a href="#h33-1-12" id="h33-1-12" class="i">+    func_unknown_args: &quot;unknown(a, b, c)&quot; =&gt; Err(Error::InvalidInput(&quot;unknown function unknown&quot;.into())),
</a><a href="#h33-1-13" id="h33-1-13" class="i">+    func_unknown_open: &quot;unknown(a, b, c&quot; =&gt; Err(Error::InvalidInput(&quot;unexpected end of input&quot;.into())),
</a><a href="#h33-1-14" id="h33-1-14" class="i">+    func_unknown_trailing_comma: &quot;unknown(a, b, c,)&quot; =&gt; Err(Error::InvalidInput(&quot;expected expression atom, found )&quot;.into())),
</a> 
     // Logical operators
     op_and_true_true: &quot;TRUE AND TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-2" id="h33-2" class="h">@@ -85,16 +85,16 @@ test_expr! {
</a>     op_and_null_true: &quot;NULL AND TRUE&quot; =&gt; Ok(Null),
     op_and_null_false: &quot;NULL AND FALSE&quot; =&gt; Ok(Boolean(false)),
     op_and_null_null: &quot;NULL AND NULL&quot; =&gt; Ok(Null),
<a href="#h33-2-3" id="h33-2-3" class="d">-    op_and_error_float: &quot;3.14 AND 3.14&quot; =&gt; Err(Error::Value(&quot;Can&#39;t and 3.14 and 3.14&quot;.into())),
</a><a href="#h33-2-4" id="h33-2-4" class="d">-    op_and_error_integer: &quot;3 AND 3&quot; =&gt; Err(Error::Value(&quot;Can&#39;t and 3 and 3&quot;.into())),
</a><a href="#h33-2-5" id="h33-2-5" class="d">-    op_and_error_string: &quot;&#39;a&#39; AND &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t and a and b&quot;.into())),
</a><a href="#h33-2-6" id="h33-2-6" class="i">+    op_and_error_float: &quot;3.14 AND 3.14&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t and 3.14 and 3.14&quot;.into())),
</a><a href="#h33-2-7" id="h33-2-7" class="i">+    op_and_error_integer: &quot;3 AND 3&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t and 3 and 3&quot;.into())),
</a><a href="#h33-2-8" id="h33-2-8" class="i">+    op_and_error_string: &quot;&#39;a&#39; AND &#39;b&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t and a and b&quot;.into())),
</a> 
     op_not_true: &quot;NOT TRUE&quot; =&gt; Ok(Boolean(false)),
     op_not_false: &quot;NOT FALSE&quot; =&gt; Ok(Boolean(true)),
     op_not_null: &quot;NOT NULL&quot; =&gt; Ok(Null),
<a href="#h33-2-13" id="h33-2-13" class="d">-    op_not_error_float: &quot;NOT 3.14&quot; =&gt; Err(Error::Value(&quot;Can&#39;t negate 3.14&quot;.into())),
</a><a href="#h33-2-14" id="h33-2-14" class="d">-    op_not_error_integer: &quot;NOT 3&quot; =&gt; Err(Error::Value(&quot;Can&#39;t negate 3&quot;.into())),
</a><a href="#h33-2-15" id="h33-2-15" class="d">-    op_not_error_string: &quot;NOT &#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t negate abc&quot;.into())),
</a><a href="#h33-2-16" id="h33-2-16" class="i">+    op_not_error_float: &quot;NOT 3.14&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t negate 3.14&quot;.into())),
</a><a href="#h33-2-17" id="h33-2-17" class="i">+    op_not_error_integer: &quot;NOT 3&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t negate 3&quot;.into())),
</a><a href="#h33-2-18" id="h33-2-18" class="i">+    op_not_error_string: &quot;NOT &#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t negate abc&quot;.into())),
</a> 
     op_or_true_true: &quot;TRUE OR TRUE&quot; =&gt; Ok(Boolean(true)),
     op_or_true_false: &quot;TRUE OR FALSE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-3" id="h33-3" class="h">@@ -105,9 +105,9 @@ test_expr! {
</a>     op_or_null_true: &quot;NULL OR TRUE&quot; =&gt; Ok(Boolean(true)),
     op_or_null_false: &quot;NULL OR FALSE&quot; =&gt; Ok(Null),
     op_or_null_null: &quot;NULL OR NULL&quot; =&gt; Ok(Null),
<a href="#h33-3-3" id="h33-3-3" class="d">-    op_or_error_float: &quot;3.14 OR 3.14&quot; =&gt; Err(Error::Value(&quot;Can&#39;t or 3.14 and 3.14&quot;.into())),
</a><a href="#h33-3-4" id="h33-3-4" class="d">-    op_or_error_integer: &quot;3 OR 3&quot; =&gt; Err(Error::Value(&quot;Can&#39;t or 3 and 3&quot;.into())),
</a><a href="#h33-3-5" id="h33-3-5" class="d">-    op_or_error_string: &quot;&#39;a&#39; OR &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t or a and b&quot;.into())),
</a><a href="#h33-3-6" id="h33-3-6" class="i">+    op_or_error_float: &quot;3.14 OR 3.14&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t or 3.14 and 3.14&quot;.into())),
</a><a href="#h33-3-7" id="h33-3-7" class="i">+    op_or_error_integer: &quot;3 OR 3&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t or 3 and 3&quot;.into())),
</a><a href="#h33-3-8" id="h33-3-8" class="i">+    op_or_error_string: &quot;&#39;a&#39; OR &#39;b&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t or a and b&quot;.into())),
</a> 
     // Comparison operators
     op_eq_bool: &quot;TRUE = TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-4" id="h33-4" class="h">@@ -130,7 +130,7 @@ test_expr! {
</a>     op_eq_string_case: &quot;&#39;abc&#39; = &#39;ABC&#39;&quot; =&gt; Ok(Boolean(false)),
     op_eq_string_unicode: &quot;&#39;😀&#39; = &#39;😀&#39;&quot; =&gt; Ok(Boolean(true)),
     op_eq_string_unicode_not: &quot;&#39;😀&#39; = &#39;🙁&#39;&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-4-3" id="h33-4-3" class="d">-    op_eq_conflict: &quot;1 = &#39;a&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 1 and a&quot;.into())),
</a><a href="#h33-4-4" id="h33-4-4" class="i">+    op_eq_conflict: &quot;1 = &#39;a&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 1 and a&quot;.into())),
</a> 
     op_neq_bool: &quot;TRUE != FALSE&quot; =&gt; Ok(Boolean(true)),
     op_neq_bool_not: &quot;TRUE != TRUE&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-5" id="h33-5" class="h">@@ -152,7 +152,7 @@ test_expr! {
</a>     op_neq_string_case: &quot;&#39;abc&#39; != &#39;ABC&#39;&quot; =&gt; Ok(Boolean(true)),
     op_neq_string_unicode: &quot;&#39;😀&#39; != &#39;🙁&#39;&quot; =&gt; Ok(Boolean(true)),
     op_neq_string_unicode_not: &quot;&#39;😀&#39; != &#39;😀&#39;&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-5-3" id="h33-5-3" class="d">-    op_neq_conflict: &quot;1 != &#39;a&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 1 and a&quot;.into())),
</a><a href="#h33-5-4" id="h33-5-4" class="i">+    op_neq_conflict: &quot;1 != &#39;a&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 1 and a&quot;.into())),
</a> 
     op_gt_bool: &quot;TRUE &gt; FALSE&quot; =&gt; Ok(Boolean(true)),
     op_gt_bool_eq: &quot;TRUE &gt; TRUE&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-6" id="h33-6" class="h">@@ -185,7 +185,7 @@ test_expr! {
</a>     op_gt_string_unicode: &quot;&#39;🙁&#39; &gt; &#39;😀&#39;&quot; =&gt; Ok(Boolean(true)),
     op_gt_string_unicode_eq: &quot;&#39;😀&#39; &gt; &#39;😀&#39;&quot; =&gt; Ok(Boolean(false)),
     op_gt_string_unicode_not: &quot;&#39;😀&#39; &gt; &#39;🙁&#39;&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-6-3" id="h33-6-3" class="d">-    op_gt_conflict: &quot;1 &gt; &#39;a&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 1 and a&quot;.into())),
</a><a href="#h33-6-4" id="h33-6-4" class="i">+    op_gt_conflict: &quot;1 &gt; &#39;a&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 1 and a&quot;.into())),
</a> 
     op_gte_bool: &quot;TRUE &gt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_gte_bool_gt: &quot;TRUE &gt;= FALSE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-7" id="h33-7" class="h">@@ -217,7 +217,7 @@ test_expr! {
</a>     op_gte_string_unicode: &quot;&#39;😀&#39; &gt;= &#39;😀&#39;&quot; =&gt; Ok(Boolean(true)),
     op_gte_string_unicode_gt: &quot;&#39;🙁&#39; &gt;= &#39;😀&#39;&quot; =&gt; Ok(Boolean(true)),
     op_gte_string_unicode_not: &quot;&#39;😀&#39; &gt;= &#39;🙁&#39;&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-7-3" id="h33-7-3" class="d">-    op_gte_conflict: &quot;1 &gt;= &#39;a&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 1 and a&quot;.into())),
</a><a href="#h33-7-4" id="h33-7-4" class="i">+    op_gte_conflict: &quot;1 &gt;= &#39;a&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 1 and a&quot;.into())),
</a> 
     op_lt_bool: &quot;FALSE &lt; TRUE&quot; =&gt; Ok(Boolean(true)),
     op_lt_bool_eq: &quot;TRUE &lt; TRUE&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-8" id="h33-8" class="h">@@ -250,7 +250,7 @@ test_expr! {
</a>     op_lt_string_unicode: &quot;&#39;😀&#39; &lt; &#39;🙁&#39;&quot; =&gt; Ok(Boolean(true)),
     op_lt_string_unicode_eq: &quot;&#39;😀&#39; &lt; &#39;😀&#39;&quot; =&gt; Ok(Boolean(false)),
     op_lt_string_unicode_not: &quot;&#39;🙁&#39; &lt; &#39;😀&#39;&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-8-3" id="h33-8-3" class="d">-    op_lt_conflict: &quot;1 &lt; &#39;a&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 1 and a&quot;.into())),
</a><a href="#h33-8-4" id="h33-8-4" class="i">+    op_lt_conflict: &quot;1 &lt; &#39;a&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 1 and a&quot;.into())),
</a> 
     op_lte_bool: &quot;TRUE &lt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_lte_bool_lt: &quot;FALSE &lt;= TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-9" id="h33-9" class="h">@@ -282,13 +282,13 @@ test_expr! {
</a>     op_lte_string_unicode: &quot;&#39;😀&#39; &lt;= &#39;😀&#39;&quot; =&gt; Ok(Boolean(true)),
     op_lte_string_unicode_lt: &quot;&#39;😀&#39; &lt;= &#39;🙁&#39;&quot; =&gt; Ok(Boolean(true)),
     op_lte_string_unicode_not: &quot;&#39;🙁&#39; &lt;= &#39;😀&#39;&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-9-3" id="h33-9-3" class="d">-    op_lte_conflict: &quot;1 &lt;= &#39;a&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 1 and a&quot;.into())),
</a><a href="#h33-9-4" id="h33-9-4" class="i">+    op_lte_conflict: &quot;1 &lt;= &#39;a&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 1 and a&quot;.into())),
</a> 
     op_null: &quot;NULL IS NULL&quot; =&gt; Ok(Boolean(true)),
     op_null_not: &quot;NULL IS NOT NULL&quot; =&gt; Ok(Boolean(false)),
     op_null_bool: &quot;TRUE IS NULL&quot; =&gt; Ok(Boolean(false)),
     op_null_bool_not: &quot;TRUE IS NOT NULL&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-9-10" id="h33-9-10" class="d">-    op_null_rhs_bool: &quot;NULL IS TRUE&quot; =&gt; Err(Error::Parse(&quot;Expected token NULL, found TRUE&quot;.into())),
</a><a href="#h33-9-11" id="h33-9-11" class="i">+    op_null_rhs_bool: &quot;NULL IS TRUE&quot; =&gt; Err(Error::InvalidInput(&quot;expected token NULL, found TRUE&quot;.into())),
</a> 
     // Math operators
     op_add_float_float: &quot;3.1 + 2.71&quot; =&gt; Ok(Float(3.1 + 2.71)),
<a href="#h33-10" id="h33-10" class="h">@@ -303,12 +303,12 @@ test_expr! {
</a>     op_add_negative: &quot;1 + -3&quot; =&gt; Ok(Integer(-2)),
     op_add_infinity: &quot;1 + INFINITY&quot; =&gt; Ok(Float(std::f64::INFINITY)),
     op_add_nan: &quot;1 + NAN&quot; =&gt; Ok(Float(std::f64::NAN)),
<a href="#h33-10-3" id="h33-10-3" class="d">-    op_add_overflow_int: &quot;9223372036854775807 + 1&quot; =&gt; Err(Error::Value(&quot;Integer overflow&quot;.into())),
</a><a href="#h33-10-4" id="h33-10-4" class="d">-    op_add_underflow_int: &quot;-9223372036854775807 + -2&quot; =&gt; Err(Error::Value(&quot;Integer overflow&quot;.into())),
</a><a href="#h33-10-5" id="h33-10-5" class="i">+    op_add_overflow_int: &quot;9223372036854775807 + 1&quot; =&gt; Err(Error::InvalidInput(&quot;integer overflow&quot;.into())),
</a><a href="#h33-10-6" id="h33-10-6" class="i">+    op_add_underflow_int: &quot;-9223372036854775807 + -2&quot; =&gt; Err(Error::InvalidInput(&quot;integer overflow&quot;.into())),
</a>     op_add_overflow_float: &quot;2e308 + 2e308&quot; =&gt; Ok(Float(std::f64::INFINITY)),
     op_add_round_int_float: &quot;9223372036854775807 + 10.0&quot; =&gt; Ok(Float(9_223_372_036_854_776_000.0)),
<a href="#h33-10-9" id="h33-10-9" class="d">-    op_add_error_bool: &quot;TRUE + FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t add TRUE and FALSE&quot;.into())),
</a><a href="#h33-10-10" id="h33-10-10" class="d">-    op_add_error_strings: &quot;&#39;a&#39; + &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t add a and b&quot;.into())),
</a><a href="#h33-10-11" id="h33-10-11" class="i">+    op_add_error_bool: &quot;TRUE + FALSE&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t add TRUE and FALSE&quot;.into())),
</a><a href="#h33-10-12" id="h33-10-12" class="i">+    op_add_error_strings: &quot;&#39;a&#39; + &#39;b&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t add a and b&quot;.into())),
</a> 
     op_assert_float: &quot;+3.72&quot; =&gt; Ok(Float(3.72)),
     op_assert_int: &quot;+1&quot; =&gt; Ok(Integer(1)),
<a href="#h33-11" id="h33-11" class="h">@@ -316,8 +316,8 @@ test_expr! {
</a>     op_assert_infinity: &quot;+INFINITY&quot; =&gt; Ok(Float(std::f64::INFINITY)),
     op_assert_nan: &quot;+NAN&quot; =&gt; Ok(Float(std::f64::NAN)),
     op_assert_multi: &quot;+++1&quot; =&gt; Ok(Integer(1)),
<a href="#h33-11-3" id="h33-11-3" class="d">-    op_assert_error_bool: &quot;+TRUE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take the positive of TRUE&quot;.into())),
</a><a href="#h33-11-4" id="h33-11-4" class="d">-    op_assert_error_string: &quot;+&#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take the positive of abc&quot;.into())),
</a><a href="#h33-11-5" id="h33-11-5" class="i">+    op_assert_error_bool: &quot;+TRUE&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take the positive of TRUE&quot;.into())),
</a><a href="#h33-11-6" id="h33-11-6" class="i">+    op_assert_error_string: &quot;+&#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take the positive of abc&quot;.into())),
</a> 
     op_divide_float_float: &quot;4.16 / 3.2&quot; =&gt; Ok(Float(1.3)),
     op_divide_float_float_zero: &quot;4.16 / 0.0&quot; =&gt; Ok(Float(std::f64::INFINITY)),
<a href="#h33-12" id="h33-12" class="h">@@ -329,7 +329,7 @@ test_expr! {
</a>     op_divide_integer_float_zero: &quot;3 / 0.0&quot; =&gt; Ok(Float(std::f64::INFINITY)),
     op_divide_integer_integer: &quot;8 / 3&quot; =&gt; Ok(Integer(2)),
     op_divide_integer_integer_negative: &quot;8 / -3&quot; =&gt; Ok(Integer(-2)),
<a href="#h33-12-3" id="h33-12-3" class="d">-    op_divide_integer_integer_zero: &quot;1 / 0&quot; =&gt; Err(Error::Value(&quot;Can&#39;t divide by zero&quot;.into())),
</a><a href="#h33-12-4" id="h33-12-4" class="i">+    op_divide_integer_integer_zero: &quot;1 / 0&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t divide by zero&quot;.into())),
</a>     op_divide_integer_null: &quot;1 / NULL&quot; =&gt; Ok(Null),
     op_divide_infinity: &quot;1 / INFINITY&quot; =&gt; Ok(Float(0.0)),
     op_divide_infinity_divisor: &quot;INFINITY / 10&quot; =&gt; Ok(Float(std::f64::INFINITY)),
<a href="#h33-13" id="h33-13" class="h">@@ -338,15 +338,15 @@ test_expr! {
</a>     op_divide_null_float: &quot;NULL / 3.14&quot; =&gt; Ok(Null),
     op_divide_null_integer: &quot;NULL / 1&quot; =&gt; Ok(Null),
     op_divide_null_null: &quot;NULL / NULL&quot; =&gt; Ok(Null),
<a href="#h33-13-3" id="h33-13-3" class="d">-    op_divide_error_bool: &quot;TRUE / FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t divide TRUE and FALSE&quot;.into())),
</a><a href="#h33-13-4" id="h33-13-4" class="d">-    op_divide_error_strings: &quot;&#39;a&#39; / &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t divide a and b&quot;.into())),
</a><a href="#h33-13-5" id="h33-13-5" class="i">+    op_divide_error_bool: &quot;TRUE / FALSE&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t divide TRUE and FALSE&quot;.into())),
</a><a href="#h33-13-6" id="h33-13-6" class="i">+    op_divide_error_strings: &quot;&#39;a&#39; / &#39;b&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t divide a and b&quot;.into())),
</a> 
     op_exp_float_float: &quot;6.25 ^ 0.5&quot; =&gt; Ok(Float(2.5)),
     op_exp_float_int: &quot;6.25 ^ 2&quot; =&gt; Ok(Float(39.0625)),
     op_exp_float_null: &quot;3.14 ^ NULL&quot; =&gt; Ok(Null),
     op_exp_int_float: &quot;9 ^ 0.5&quot; =&gt; Ok(Float(3.0)),
     op_exp_int_int: &quot;2 ^ 3&quot; =&gt; Ok(Integer(8)),
<a href="#h33-13-13" id="h33-13-13" class="d">-    op_exp_int_int_large: &quot;2 ^ 10000000000&quot; =&gt; Err(Error::Value(&quot;Integer overflow&quot;.into())),
</a><a href="#h33-13-14" id="h33-13-14" class="i">+    op_exp_int_int_large: &quot;2 ^ 10000000000&quot; =&gt; Err(Error::InvalidInput(&quot;integer overflow&quot;.into())),
</a>     op_exp_int_null: &quot;1 ^ NULL&quot; =&gt; Ok(Null),
     op_exp_null_float: &quot;NULL ^ 3.14&quot; =&gt; Ok(Null),
     op_exp_null_int: &quot;NULL ^ 1&quot; =&gt; Ok(Null),
<a href="#h33-14" id="h33-14" class="h">@@ -357,18 +357,18 @@ test_expr! {
</a>     op_exp_nan: &quot;NAN ^ 2&quot; =&gt; Ok(Float(std::f64::NAN)),
     op_exp_nan_exp: &quot;2 ^ NAN&quot; =&gt; Ok(Float(std::f64::NAN)),
     op_exp_overflow_float: &quot;10e200 ^ 2&quot; =&gt; Ok(Float(std::f64::INFINITY)),
<a href="#h33-14-3" id="h33-14-3" class="d">-    op_exp_overflow_int: &quot;9223372036854775807 ^ 2&quot; =&gt; Err(Error::Value(&quot;Integer overflow&quot;.into())),
</a><a href="#h33-14-4" id="h33-14-4" class="i">+    op_exp_overflow_int: &quot;9223372036854775807 ^ 2&quot; =&gt; Err(Error::InvalidInput(&quot;integer overflow&quot;.into())),
</a>     op_exp_negative: &quot;2 ^ -3&quot; =&gt; Ok(Float(0.125)),
<a href="#h33-14-6" id="h33-14-6" class="d">-    op_exp_error_bool: &quot;TRUE ^ FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t exponentiate TRUE and FALSE&quot;.into())),
</a><a href="#h33-14-7" id="h33-14-7" class="d">-    op_exp_error_strings: &quot;&#39;a&#39; ^ &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t exponentiate a and b&quot;.into())),
</a><a href="#h33-14-8" id="h33-14-8" class="i">+    op_exp_error_bool: &quot;TRUE ^ FALSE&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t exponentiate TRUE and FALSE&quot;.into())),
</a><a href="#h33-14-9" id="h33-14-9" class="i">+    op_exp_error_strings: &quot;&#39;a&#39; ^ &#39;b&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t exponentiate a and b&quot;.into())),
</a> 
     op_factorial: &quot;3!&quot; =&gt; Ok(Integer(6)),
     op_factorial_zero: &quot;0!&quot; =&gt; Ok(Integer(1)),
     op_factorial_null: &quot;NULL!&quot; =&gt; Ok(Null),
<a href="#h33-14-14" id="h33-14-14" class="d">-    op_factorial_error_bool: &quot;TRUE!&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take factorial of TRUE&quot;.into())),
</a><a href="#h33-14-15" id="h33-14-15" class="d">-    op_factorial_error_float: &quot;3.14!&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take factorial of 3.14&quot;.into())),
</a><a href="#h33-14-16" id="h33-14-16" class="d">-    op_factorial_error_negative: &quot;-3!&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take factorial of negative number&quot;.into())),
</a><a href="#h33-14-17" id="h33-14-17" class="d">-    op_factorial_error_string: &quot;&#39;abc&#39;!&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take factorial of abc&quot;.into())),
</a><a href="#h33-14-18" id="h33-14-18" class="i">+    op_factorial_error_bool: &quot;TRUE!&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take factorial of TRUE&quot;.into())),
</a><a href="#h33-14-19" id="h33-14-19" class="i">+    op_factorial_error_float: &quot;3.14!&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take factorial of 3.14&quot;.into())),
</a><a href="#h33-14-20" id="h33-14-20" class="i">+    op_factorial_error_negative: &quot;-3!&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take factorial of negative number&quot;.into())),
</a><a href="#h33-14-21" id="h33-14-21" class="i">+    op_factorial_error_string: &quot;&#39;abc&#39;!&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take factorial of abc&quot;.into())),
</a> 
     op_modulo_float_float: &quot;6.28 % 2.2&quot; =&gt; Ok(Float(1.88)),
     op_modulo_float_float_zero: &quot;6.28 % 0.0&quot; =&gt; Ok(Float(std::f64::NAN)),
<a href="#h33-15" id="h33-15" class="h">@@ -376,7 +376,7 @@ test_expr! {
</a>     op_modulo_float_null: &quot;3.14 % NULL&quot; =&gt; Ok(Null),
     op_modulo_int_float: &quot;6 % 3.15&quot; =&gt; Ok(Float(2.85)),
     op_modulo_int_int: &quot;5 % 3&quot; =&gt; Ok(Integer(2)),
<a href="#h33-15-3" id="h33-15-3" class="d">-    op_modulo_int_int_zero: &quot;7 % 0&quot; =&gt; Err(Error::Value(&quot;Can&#39;t divide by zero&quot;.into())),
</a><a href="#h33-15-4" id="h33-15-4" class="i">+    op_modulo_int_int_zero: &quot;7 % 0&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t divide by zero&quot;.into())),
</a>     op_modulo_int_null: &quot;1 % NULL&quot; =&gt; Ok(Null),
     op_modulo_null_float: &quot;NULL % 3.14&quot; =&gt; Ok(Null),
     op_modulo_null_int: &quot;NULL % 1&quot; =&gt; Ok(Null),
<a href="#h33-16" id="h33-16" class="h">@@ -386,8 +386,8 @@ test_expr! {
</a>     op_modulo_infinity: &quot;INFINITY % 7&quot; =&gt; Ok(Float(std::f64::NAN)),
     op_modulo_infinity_divisor: &quot;7 % INFINITY&quot; =&gt; Ok(Float(7.0)),
     op_modulo_nan: &quot;7 % NAN&quot; =&gt; Ok(Float(std::f64::NAN)),
<a href="#h33-16-3" id="h33-16-3" class="d">-    op_modulo_error_bool: &quot;TRUE % FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take modulo of TRUE and FALSE&quot;.into())),
</a><a href="#h33-16-4" id="h33-16-4" class="d">-    op_modulo_error_strings: &quot;&#39;a&#39; % &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take modulo of a and b&quot;.into())),
</a><a href="#h33-16-5" id="h33-16-5" class="i">+    op_modulo_error_bool: &quot;TRUE % FALSE&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take modulo of TRUE and FALSE&quot;.into())),
</a><a href="#h33-16-6" id="h33-16-6" class="i">+    op_modulo_error_strings: &quot;&#39;a&#39; % &#39;b&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take modulo of a and b&quot;.into())),
</a> 
     op_multiply_float_float: &quot;3.1 * 2.71&quot; =&gt; Ok(Float(3.1 * 2.71)),
     op_multiply_float_int: &quot;3.72 * 1&quot; =&gt; Ok(Float(3.72 * 1.0)),
<a href="#h33-17" id="h33-17" class="h">@@ -401,12 +401,12 @@ test_expr! {
</a>     op_multiply_negative: &quot;2 * -3&quot; =&gt; Ok(Integer(-6)),
     op_multiply_infinity: &quot;2 * INFINITY&quot; =&gt; Ok(Float(std::f64::INFINITY)),
     op_multiply_nan: &quot;2 * NAN&quot; =&gt; Ok(Float(std::f64::NAN)),
<a href="#h33-17-3" id="h33-17-3" class="d">-    op_multiply_overflow_int: &quot;9223372036854775807 * 2&quot; =&gt; Err(Error::Value(&quot;Integer overflow&quot;.into())),
</a><a href="#h33-17-4" id="h33-17-4" class="d">-    op_multiply_underflow_int: &quot;9223372036854775807 * -2&quot; =&gt; Err(Error::Value(&quot;Integer overflow&quot;.into())),
</a><a href="#h33-17-5" id="h33-17-5" class="i">+    op_multiply_overflow_int: &quot;9223372036854775807 * 2&quot; =&gt; Err(Error::InvalidInput(&quot;integer overflow&quot;.into())),
</a><a href="#h33-17-6" id="h33-17-6" class="i">+    op_multiply_underflow_int: &quot;9223372036854775807 * -2&quot; =&gt; Err(Error::InvalidInput(&quot;integer overflow&quot;.into())),
</a>     op_multiply_overflow_float: &quot;2e308 * 2&quot; =&gt; Ok(Float(std::f64::INFINITY)),
     op_multiply_round_int_float: &quot;9223372036854775807 * 2.0&quot; =&gt; Ok(Float(18_446_744_073_709_552_000.0)),
<a href="#h33-17-9" id="h33-17-9" class="d">-    op_multiply_error_bool: &quot;TRUE * FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t multiply TRUE and FALSE&quot;.into())),
</a><a href="#h33-17-10" id="h33-17-10" class="d">-    op_multiply_error_strings: &quot;&#39;a&#39; * &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t multiply a and b&quot;.into())),
</a><a href="#h33-17-11" id="h33-17-11" class="i">+    op_multiply_error_bool: &quot;TRUE * FALSE&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t multiply TRUE and FALSE&quot;.into())),
</a><a href="#h33-17-12" id="h33-17-12" class="i">+    op_multiply_error_strings: &quot;&#39;a&#39; * &#39;b&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t multiply a and b&quot;.into())),
</a> 
     op_negate: &quot;-1&quot; =&gt; Ok(Integer(-1)),
     op_negate_double: &quot;--1&quot; =&gt; Ok(Integer(1)),
<a href="#h33-18" id="h33-18" class="h">@@ -416,8 +416,8 @@ test_expr! {
</a>     op_negate_null: &quot;-NULL&quot; =&gt; Ok(Null),
     op_negate_infinity: &quot;-INFINITY&quot; =&gt; Ok(Float(-std::f64::INFINITY)),
     op_negate_nan: &quot;-NAN&quot; =&gt; Ok(Float(std::f64::NAN)),
<a href="#h33-18-3" id="h33-18-3" class="d">-    op_negate_error_bool: &quot;-TRUE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t negate TRUE&quot;.into())),
</a><a href="#h33-18-4" id="h33-18-4" class="d">-    op_negate_error_string: &quot;-&#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t negate abc&quot;.into())),
</a><a href="#h33-18-5" id="h33-18-5" class="i">+    op_negate_error_bool: &quot;-TRUE&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t negate TRUE&quot;.into())),
</a><a href="#h33-18-6" id="h33-18-6" class="i">+    op_negate_error_string: &quot;-&#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t negate abc&quot;.into())),
</a> 
     op_subtract_float_float: &quot;3.1 - 2.71&quot; =&gt; Ok(Float(3.1 - 2.71)),
     op_subtract_float_int: &quot;3.72 - 1&quot; =&gt; Ok(Float(3.72 - 1.0)),
<a href="#h33-19" id="h33-19" class="h">@@ -431,12 +431,12 @@ test_expr! {
</a>     op_subtract_negative: &quot;1 - -3&quot; =&gt; Ok(Integer(4)),
     op_subtract_infinity: &quot;1 - INFINITY&quot; =&gt; Ok(Float(-std::f64::INFINITY)),
     op_subtract_nan: &quot;1 - NAN&quot; =&gt; Ok(Float(std::f64::NAN)),
<a href="#h33-19-3" id="h33-19-3" class="d">-    op_subtract_overflow_int: &quot;9223372036854775807 - -1&quot; =&gt; Err(Error::Value(&quot;Integer overflow&quot;.into())),
</a><a href="#h33-19-4" id="h33-19-4" class="d">-    op_subtract_underflow_int: &quot;-9223372036854775807 - 2&quot; =&gt; Err(Error::Value(&quot;Integer overflow&quot;.into())),
</a><a href="#h33-19-5" id="h33-19-5" class="i">+    op_subtract_overflow_int: &quot;9223372036854775807 - -1&quot; =&gt; Err(Error::InvalidInput(&quot;integer overflow&quot;.into())),
</a><a href="#h33-19-6" id="h33-19-6" class="i">+    op_subtract_underflow_int: &quot;-9223372036854775807 - 2&quot; =&gt; Err(Error::InvalidInput(&quot;integer overflow&quot;.into())),
</a>     op_subtract_overflow_float: &quot;2e308 - -2e308&quot; =&gt; Ok(Float(std::f64::INFINITY)),
     op_subtract_round_int_float: &quot;9223372036854775807 - -10.0&quot; =&gt; Ok(Float(9_223_372_036_854_776_000.0)),
<a href="#h33-19-9" id="h33-19-9" class="d">-    op_subtract_error_bool: &quot;TRUE - FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t subtract TRUE and FALSE&quot;.into())),
</a><a href="#h33-19-10" id="h33-19-10" class="d">-    op_subtract_error_strings: &quot;&#39;a&#39; - &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t subtract a and b&quot;.into())),
</a><a href="#h33-19-11" id="h33-19-11" class="i">+    op_subtract_error_bool: &quot;TRUE - FALSE&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t subtract TRUE and FALSE&quot;.into())),
</a><a href="#h33-19-12" id="h33-19-12" class="i">+    op_subtract_error_strings: &quot;&#39;a&#39; - &#39;b&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t subtract a and b&quot;.into())),
</a> 
     // String operators
     op_like_percent: &quot;&#39;abcde&#39; LIKE &#39;a%e&#39;&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-20" id="h33-20" class="h">@@ -461,10 +461,10 @@ test_expr! {
</a> 
     // Operator precedence, testing each operator against the ones at the same level and immediately
     // below it in order.
<a href="#h33-20-3" id="h33-20-3" class="d">-    op_prec_negate_factorial: &quot;-3!&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take factorial of negative number&quot;.into())),
</a><a href="#h33-20-4" id="h33-20-4" class="i">+    op_prec_negate_factorial: &quot;-3!&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t take factorial of negative number&quot;.into())),
</a>     op_prec_negate_factorial_paren: &quot;-(3!)&quot; =&gt; Ok(Integer(-6)),
     op_prec_negate_is: &quot;-NULL IS NULL&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-20-7" id="h33-20-7" class="d">-    op_prec_negate_is_paren: &quot;-(NULL IS NULL)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t negate TRUE&quot;.into())),
</a><a href="#h33-20-8" id="h33-20-8" class="i">+    op_prec_negate_is_paren: &quot;-(NULL IS NULL)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t negate TRUE&quot;.into())),
</a> 
     op_prec_not_factorial: &quot;NOT NULL IS NULL&quot; =&gt; Ok(Boolean(true)),
     op_prec_not_factorial_paren: &quot;NOT (NULL IS NULL)&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-21" id="h33-21" class="h">@@ -474,7 +474,7 @@ test_expr! {
</a>     op_prec_factorial_exp: &quot;2 ^ 3!&quot; =&gt; Ok(Integer(64)),
     op_prec_factorial_exp_paren: &quot;(2 ^ 3)!&quot; =&gt; Ok(Integer(40320)),
 
<a href="#h33-21-3" id="h33-21-3" class="d">-    op_prec_is_exp: &quot;2^NULL IS NULL&quot; =&gt; Err(Error::Value(&quot;Can&#39;t exponentiate 2 and TRUE&quot;.into())),
</a><a href="#h33-21-4" id="h33-21-4" class="i">+    op_prec_is_exp: &quot;2^NULL IS NULL&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t exponentiate 2 and TRUE&quot;.into())),
</a>     op_prec_is_exp_paren: &quot;(2^NULL) IS NULL&quot; =&gt; Ok(Boolean(true)),
 
     op_assoc_exp: &quot;2^3^2&quot; =&gt; Ok(Integer(512)),
<a href="#h33-22" id="h33-22" class="h">@@ -509,78 +509,78 @@ test_expr! {
</a> 
     op_prec_add_subtract: &quot;1 + 2 - 3&quot; =&gt; Ok(Integer(0)),
     op_prec_add_gt: &quot;1 + 2 &gt; 2&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-3" id="h33-22-3" class="d">-    op_prec_add_gt_paren: &quot;1 + (2 &gt; 2)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t add 1 and FALSE&quot;.into())),
</a><a href="#h33-22-4" id="h33-22-4" class="i">+    op_prec_add_gt_paren: &quot;1 + (2 &gt; 2)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t add 1 and FALSE&quot;.into())),
</a>     op_prec_add_gte: &quot;1 + 2 &gt;= 2&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-6" id="h33-22-6" class="d">-    op_prec_add_gte_paren: &quot;1 + (2 &gt;= 2)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t add 1 and TRUE&quot;.into())),
</a><a href="#h33-22-7" id="h33-22-7" class="i">+    op_prec_add_gte_paren: &quot;1 + (2 &gt;= 2)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t add 1 and TRUE&quot;.into())),
</a>     op_prec_add_lt: &quot;1 + 2 &lt; 2&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-22-9" id="h33-22-9" class="d">-    op_prec_add_lt_paren: &quot;1 + (2 &lt; 2)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t add 1 and FALSE&quot;.into())),
</a><a href="#h33-22-10" id="h33-22-10" class="i">+    op_prec_add_lt_paren: &quot;1 + (2 &lt; 2)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t add 1 and FALSE&quot;.into())),
</a>     op_prec_add_lte: &quot;1 + 2 &lt;= 2&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-22-12" id="h33-22-12" class="d">-    op_prec_add_lte_paren: &quot;1 + (2 &lt;= 2)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t add 1 and TRUE&quot;.into())),
</a><a href="#h33-22-13" id="h33-22-13" class="i">+    op_prec_add_lte_paren: &quot;1 + (2 &lt;= 2)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t add 1 and TRUE&quot;.into())),
</a> 
     op_prec_subtract_add: &quot;3 - 2 + 1&quot; =&gt; Ok(Integer(2)),
     op_prec_subtract_gt: &quot;5 - 2 &gt; 2&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-17" id="h33-22-17" class="d">-    op_prec_subtract_gt_paren: &quot;5 - (2 &gt; 2)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t subtract 5 and FALSE&quot;.into())),
</a><a href="#h33-22-18" id="h33-22-18" class="i">+    op_prec_subtract_gt_paren: &quot;5 - (2 &gt; 2)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t subtract 5 and FALSE&quot;.into())),
</a>     op_prec_subtract_gte: &quot;5 - 2 &gt;= 2&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-20" id="h33-22-20" class="d">-    op_prec_subtract_gte_paren: &quot;5 - (2 &gt;= 2)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t subtract 5 and TRUE&quot;.into())),
</a><a href="#h33-22-21" id="h33-22-21" class="i">+    op_prec_subtract_gte_paren: &quot;5 - (2 &gt;= 2)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t subtract 5 and TRUE&quot;.into())),
</a>     op_prec_subtract_lt: &quot;5 - 2 &lt; 2&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-22-23" id="h33-22-23" class="d">-    op_prec_subtract_lt_paren: &quot;5 - (2 &lt; 2)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t subtract 5 and FALSE&quot;.into())),
</a><a href="#h33-22-24" id="h33-22-24" class="i">+    op_prec_subtract_lt_paren: &quot;5 - (2 &lt; 2)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t subtract 5 and FALSE&quot;.into())),
</a>     op_prec_subtract_lte: &quot;5 - 2 &lt;= 2&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-22-26" id="h33-22-26" class="d">-    op_prec_subtract_lte_paren: &quot;5 - (2 &lt;= 2)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t subtract 5 and TRUE&quot;.into())),
</a><a href="#h33-22-27" id="h33-22-27" class="i">+    op_prec_subtract_lte_paren: &quot;5 - (2 &lt;= 2)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t subtract 5 and TRUE&quot;.into())),
</a> 
     op_prec_gt_gte: &quot;5 &gt; 3 &gt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_gt_lt: &quot;5 &gt; 3 &lt; TRUE&quot; =&gt; Ok(Boolean(false)),
     op_prec_gt_lte: &quot;5 &gt; 3 &lt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_gt_eq: &quot;5 &gt; 3 = TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-33" id="h33-22-33" class="d">-    op_prec_gt_eq_paren: &quot;5 &gt; (3 = TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 3 and TRUE&quot;.into())),
</a><a href="#h33-22-34" id="h33-22-34" class="i">+    op_prec_gt_eq_paren: &quot;5 &gt; (3 = TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 3 and TRUE&quot;.into())),
</a>     op_prec_gt_neq: &quot;5 &gt; 3 != TRUE&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-22-36" id="h33-22-36" class="d">-    op_prec_gt_neq_paren: &quot;5 &gt; (3 != TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 3 and TRUE&quot;.into())),
</a><a href="#h33-22-37" id="h33-22-37" class="d">-    op_prec_gt_like: &quot;5 &gt; 3 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-38" id="h33-22-38" class="d">-    op_prec_gt_like_paren: &quot;5 &gt; (3 LIKE &#39;abc&#39;)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE 3 and abc&quot;.into())),
</a><a href="#h33-22-39" id="h33-22-39" class="i">+    op_prec_gt_neq_paren: &quot;5 &gt; (3 != TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 3 and TRUE&quot;.into())),
</a><a href="#h33-22-40" id="h33-22-40" class="i">+    op_prec_gt_like: &quot;5 &gt; 3 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-41" id="h33-22-41" class="i">+    op_prec_gt_like_paren: &quot;5 &gt; (3 LIKE &#39;abc&#39;)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE 3 and abc&quot;.into())),
</a> 
     op_prec_gte_gt: &quot;5 &gt;= 3 &gt; TRUE&quot; =&gt; Ok(Boolean(false)),
     op_prec_gte_lt: &quot;5 &gt;= 3 &lt; TRUE&quot; =&gt; Ok(Boolean(false)),
     op_prec_gte_lte: &quot;5 &gt;= 3 &lt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_gte_eq: &quot;5 &gt;= 3 = TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-47" id="h33-22-47" class="d">-    op_prec_gte_eq_paren: &quot;5 &gt;= (3 = TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 3 and TRUE&quot;.into())),
</a><a href="#h33-22-48" id="h33-22-48" class="i">+    op_prec_gte_eq_paren: &quot;5 &gt;= (3 = TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 3 and TRUE&quot;.into())),
</a>     op_prec_gte_neq: &quot;5 &gt;= 3 != TRUE&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-22-50" id="h33-22-50" class="d">-    op_prec_gte_neq_paren: &quot;5 &gt;= (3 != TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 3 and TRUE&quot;.into())),
</a><a href="#h33-22-51" id="h33-22-51" class="d">-    op_prec_gte_like: &quot;5 &gt;= 3 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-52" id="h33-22-52" class="d">-    op_prec_gte_like_paren: &quot;5 &gt;= (3 LIKE &#39;abc&#39;)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE 3 and abc&quot;.into())),
</a><a href="#h33-22-53" id="h33-22-53" class="i">+    op_prec_gte_neq_paren: &quot;5 &gt;= (3 != TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 3 and TRUE&quot;.into())),
</a><a href="#h33-22-54" id="h33-22-54" class="i">+    op_prec_gte_like: &quot;5 &gt;= 3 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-55" id="h33-22-55" class="i">+    op_prec_gte_like_paren: &quot;5 &gt;= (3 LIKE &#39;abc&#39;)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE 3 and abc&quot;.into())),
</a> 
     op_prec_lt_gt: &quot;3 &lt; 5 &gt; TRUE&quot; =&gt; Ok(Boolean(false)),
     op_prec_lt_gte: &quot;3 &lt; 5 &gt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_lt_lte: &quot;3 &lt; 5 &lt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_lt_eq: &quot;3 &lt; 5 = TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-61" id="h33-22-61" class="d">-    op_prec_lt_eq_paren: &quot;3 &lt; (5 = TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 5 and TRUE&quot;.into())),
</a><a href="#h33-22-62" id="h33-22-62" class="i">+    op_prec_lt_eq_paren: &quot;3 &lt; (5 = TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 5 and TRUE&quot;.into())),
</a>     op_prec_lt_neq: &quot;3 &lt; 5 != TRUE&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-22-64" id="h33-22-64" class="d">-    op_prec_lt_neq_paren: &quot;3 &lt; (5 != TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 5 and TRUE&quot;.into())),
</a><a href="#h33-22-65" id="h33-22-65" class="d">-    op_prec_lt_like: &quot;3 &lt; 5 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-66" id="h33-22-66" class="d">-    op_prec_lt_like_paren: &quot;3 &lt; (5 LIKE &#39;abc&#39;)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE 5 and abc&quot;.into())),
</a><a href="#h33-22-67" id="h33-22-67" class="i">+    op_prec_lt_neq_paren: &quot;3 &lt; (5 != TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 5 and TRUE&quot;.into())),
</a><a href="#h33-22-68" id="h33-22-68" class="i">+    op_prec_lt_like: &quot;3 &lt; 5 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-69" id="h33-22-69" class="i">+    op_prec_lt_like_paren: &quot;3 &lt; (5 LIKE &#39;abc&#39;)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE 5 and abc&quot;.into())),
</a> 
     op_prec_lte_gt: &quot;3 &lt;= 5 &gt; TRUE&quot; =&gt; Ok(Boolean(false)),
     op_prec_lte_gte: &quot;3 &lt;= 5 &gt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_lte_lte: &quot;3 &lt;= 5 &lt;= TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_lte_eq: &quot;3 &lt;= 5 = TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-75" id="h33-22-75" class="d">-    op_prec_lte_eq_paren: &quot;3 &lt;= (5 = TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 5 and TRUE&quot;.into())),
</a><a href="#h33-22-76" id="h33-22-76" class="i">+    op_prec_lte_eq_paren: &quot;3 &lt;= (5 = TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 5 and TRUE&quot;.into())),
</a>     op_prec_lte_neq: &quot;3 &lt;= 5 != TRUE&quot; =&gt; Ok(Boolean(false)),
<a href="#h33-22-78" id="h33-22-78" class="d">-    op_prec_lte_neq_paren: &quot;3 &lt;= (5 != TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 5 and TRUE&quot;.into())),
</a><a href="#h33-22-79" id="h33-22-79" class="d">-    op_prec_lte_like: &quot;3 &lt;= 5 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-80" id="h33-22-80" class="d">-    op_prec_lte_like_paren: &quot;3 &lt;= (5 LIKE &#39;abc&#39;)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE 5 and abc&quot;.into())),
</a><a href="#h33-22-81" id="h33-22-81" class="i">+    op_prec_lte_neq_paren: &quot;3 &lt;= (5 != TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t compare 5 and TRUE&quot;.into())),
</a><a href="#h33-22-82" id="h33-22-82" class="i">+    op_prec_lte_like: &quot;3 &lt;= 5 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-83" id="h33-22-83" class="i">+    op_prec_lte_like_paren: &quot;3 &lt;= (5 LIKE &#39;abc&#39;)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE 5 and abc&quot;.into())),
</a> 
     op_prec_eq_neq: &quot;1 = 1 != FALSE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-86" id="h33-22-86" class="d">-    op_prec_eq_like: &quot;1 = 1 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-87" id="h33-22-87" class="i">+    op_prec_eq_like: &quot;1 = 1 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE TRUE and abc&quot;.into())),
</a>     op_prec_eq_and: &quot;1 = 1 AND TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-89" id="h33-22-89" class="d">-    op_prec_eq_and_paren: &quot;1 = (1 AND TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t and 1 and TRUE&quot;.into())),
</a><a href="#h33-22-90" id="h33-22-90" class="i">+    op_prec_eq_and_paren: &quot;1 = (1 AND TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t and 1 and TRUE&quot;.into())),
</a> 
     op_prec_neq_eq: &quot;1 != 2 = TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-93" id="h33-22-93" class="d">-    op_prec_neq_like: &quot;1 != 2 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t LIKE TRUE and abc&quot;.into())),
</a><a href="#h33-22-94" id="h33-22-94" class="i">+    op_prec_neq_like: &quot;1 != 2 LIKE &#39;abc&#39;&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t LIKE TRUE and abc&quot;.into())),
</a>     op_prec_neq_and: &quot;2 != 1 AND TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-96" id="h33-22-96" class="d">-    op_prec_neq_and_paren: &quot;2 != (1 AND TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t and 1 and TRUE&quot;.into())),
</a><a href="#h33-22-97" id="h33-22-97" class="i">+    op_prec_neq_and_paren: &quot;2 != (1 AND TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t and 1 and TRUE&quot;.into())),
</a> 
     op_prec_like_eq: &quot;&#39;abc&#39; LIKE &#39;abc&#39; = TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_like_neq: &quot;&#39;abc&#39; LIKE &#39;abc&#39; != FALSE&quot; =&gt; Ok(Boolean(true)),
     op_prec_like_and: &quot;&#39;abc&#39; LIKE &#39;abc&#39; AND TRUE&quot; =&gt; Ok(Boolean(true)),
<a href="#h33-22-102" id="h33-22-102" class="d">-    op_prec_like_and_paren: &quot;&#39;abc&#39; LIKE (&#39;abc&#39; AND TRUE)&quot; =&gt; Err(Error::Value(&quot;Can&#39;t and abc and TRUE&quot;.into())),
</a><a href="#h33-22-103" id="h33-22-103" class="i">+    op_prec_like_and_paren: &quot;&#39;abc&#39; LIKE (&#39;abc&#39; AND TRUE)&quot; =&gt; Err(Error::InvalidInput(&quot;can&#39;t and abc and TRUE&quot;.into())),
</a> 
     op_prec_and_or: &quot;FALSE AND TRUE OR TRUE&quot; =&gt; Ok(Boolean(true)),
     op_prec_and_or_paren: &quot;FALSE AND (TRUE OR TRUE)&quot; =&gt; Ok(Boolean(false)),
<b>diff --git a/<a id="h34" href="../file/tests/sql/mutation/delete_bare.html">tests/sql/mutation/delete_bare</a> b/<a href="../file/tests/sql/mutation/delete_bare.html">tests/sql/mutation/delete_bare</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE
<a href="#h34-0-1" id="h34-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h34-0-2" id="h34-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h35" href="../file/tests/sql/mutation/delete_bare_from.html">tests/sql/mutation/delete_bare_from</a> b/<a href="../file/tests/sql/mutation/delete_bare_from.html">tests/sql/mutation/delete_bare_from</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM
<a href="#h35-0-1" id="h35-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h35-0-2" id="h35-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h36" href="../file/tests/sql/mutation/delete_bare_where.html">tests/sql/mutation/delete_bare_where</a> b/<a href="../file/tests/sql/mutation/delete_bare_where.html">tests/sql/mutation/delete_bare_where</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM test WHERE
<a href="#h36-0-1" id="h36-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h36-0-2" id="h36-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h37" href="../file/tests/sql/mutation/delete_missing_column_where.html">tests/sql/mutation/delete_missing_column_where</a> b/<a href="../file/tests/sql/mutation/delete_missing_column_where.html">tests/sql/mutation/delete_missing_column_where</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM test WHERE missing = TRUE
<a href="#h37-0-1" id="h37-0-1" class="d">-Error: Value(&quot;Unknown field missing&quot;)
</a><a href="#h37-0-2" id="h37-0-2" class="i">+Error: InvalidInput(&quot;unknown field missing&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h38" href="../file/tests/sql/mutation/delete_missing_table.html">tests/sql/mutation/delete_missing_table</a> b/<a href="../file/tests/sql/mutation/delete_missing_table.html">tests/sql/mutation/delete_missing_table</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM missing
<a href="#h38-0-1" id="h38-0-1" class="d">-Error: Value(&quot;Table missing does not exist&quot;)
</a><a href="#h38-0-2" id="h38-0-2" class="i">+Error: InvalidInput(&quot;table missing does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h39" href="../file/tests/sql/mutation/delete_multiple_tables.html">tests/sql/mutation/delete_multiple_tables</a> b/<a href="../file/tests/sql/mutation/delete_multiple_tables.html">tests/sql/mutation/delete_multiple_tables</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM test, other WHERE id = 1
<a href="#h39-0-1" id="h39-0-1" class="d">-Error: Parse(&quot;Unexpected token ,&quot;)
</a><a href="#h39-0-2" id="h39-0-2" class="i">+Error: InvalidInput(&quot;unexpected token ,&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h40" href="../file/tests/sql/mutation/delete_where_float.html">tests/sql/mutation/delete_where_float</a> b/<a href="../file/tests/sql/mutation/delete_where_float.html">tests/sql/mutation/delete_where_float</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM test WHERE 3.14
<a href="#h40-0-1" id="h40-0-1" class="d">-Error: Value(&quot;Filter returned 3.14, expected boolean&quot;)
</a><a href="#h40-0-2" id="h40-0-2" class="i">+Error: InvalidData(&quot;filter returned 3.14, expected boolean&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h41" href="../file/tests/sql/mutation/delete_where_integer.html">tests/sql/mutation/delete_where_integer</a> b/<a href="../file/tests/sql/mutation/delete_where_integer.html">tests/sql/mutation/delete_where_integer</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM test WHERE 1
<a href="#h41-0-1" id="h41-0-1" class="d">-Error: Value(&quot;Filter returned 1, expected boolean&quot;)
</a><a href="#h41-0-2" id="h41-0-2" class="i">+Error: InvalidData(&quot;filter returned 1, expected boolean&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h42" href="../file/tests/sql/mutation/delete_where_string.html">tests/sql/mutation/delete_where_string</a> b/<a href="../file/tests/sql/mutation/delete_where_string.html">tests/sql/mutation/delete_where_string</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM test WHERE &#39;a&#39;
<a href="#h42-0-1" id="h42-0-1" class="d">-Error: Value(&quot;Filter returned a, expected boolean&quot;)
</a><a href="#h42-0-2" id="h42-0-2" class="i">+Error: InvalidData(&quot;filter returned a, expected boolean&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h43" href="../file/tests/sql/mutation/insert_bare.html">tests/sql/mutation/insert_bare</a> b/<a href="../file/tests/sql/mutation/insert_bare.html">tests/sql/mutation/insert_bare</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test
<a href="#h43-0-1" id="h43-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h43-0-2" id="h43-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h44" href="../file/tests/sql/mutation/insert_bare_no_table.html">tests/sql/mutation/insert_bare_no_table</a> b/<a href="../file/tests/sql/mutation/insert_bare_no_table.html">tests/sql/mutation/insert_bare_no_table</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO
<a href="#h44-0-1" id="h44-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h44-0-2" id="h44-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h45" href="../file/tests/sql/mutation/insert_bare_values.html">tests/sql/mutation/insert_bare_values</a> b/<a href="../file/tests/sql/mutation/insert_bare_values.html">tests/sql/mutation/insert_bare_values</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test VALUES
<a href="#h45-0-1" id="h45-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h45-0-2" id="h45-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h46" href="../file/tests/sql/mutation/insert_empty_both.html">tests/sql/mutation/insert_empty_both</a> b/<a href="../file/tests/sql/mutation/insert_empty_both.html">tests/sql/mutation/insert_empty_both</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test () VALUES ()
<a href="#h46-0-1" id="h46-0-1" class="d">-Error: Parse(&quot;Expected identifier, got )&quot;)
</a><a href="#h46-0-2" id="h46-0-2" class="i">+Error: InvalidInput(&quot;expected identifier, got )&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h47" href="../file/tests/sql/mutation/insert_empty_columns.html">tests/sql/mutation/insert_empty_columns</a> b/<a href="../file/tests/sql/mutation/insert_empty_columns.html">tests/sql/mutation/insert_empty_columns</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test ()
<a href="#h47-0-1" id="h47-0-1" class="d">-Error: Parse(&quot;Expected identifier, got )&quot;)
</a><a href="#h47-0-2" id="h47-0-2" class="i">+Error: InvalidInput(&quot;expected identifier, got )&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h48" href="../file/tests/sql/mutation/insert_empty_values.html">tests/sql/mutation/insert_empty_values</a> b/<a href="../file/tests/sql/mutation/insert_empty_values.html">tests/sql/mutation/insert_empty_values</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test VALUES ()
<a href="#h48-0-1" id="h48-0-1" class="d">-Error: Parse(&quot;Expected expression atom, found )&quot;)
</a><a href="#h48-0-2" id="h48-0-2" class="i">+Error: InvalidInput(&quot;expected expression atom, found )&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h49" href="../file/tests/sql/mutation/insert_extra.html">tests/sql/mutation/insert_extra</a> b/<a href="../file/tests/sql/mutation/insert_extra.html">tests/sql/mutation/insert_extra</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test VALUES (1, &#39;a&#39;, 100, NULL)
<a href="#h49-0-1" id="h49-0-1" class="d">-Error: Value(&quot;Invalid row size for table test&quot;)
</a><a href="#h49-0-2" id="h49-0-2" class="i">+Error: InvalidInput(&quot;invalid row size for table test&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h50" href="../file/tests/sql/mutation/insert_extra_columns.html">tests/sql/mutation/insert_extra_columns</a> b/<a href="../file/tests/sql/mutation/insert_extra_columns.html">tests/sql/mutation/insert_extra_columns</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test (id, name) VALUES (1, &#39;a&#39;, 100)
<a href="#h50-0-1" id="h50-0-1" class="d">-Error: Value(&quot;Column and value counts do not match&quot;)
</a><a href="#h50-0-2" id="h50-0-2" class="i">+Error: InvalidInput(&quot;column and value counts do not match&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h51" href="../file/tests/sql/mutation/insert_full_trailing_comma.html">tests/sql/mutation/insert_full_trailing_comma</a> b/<a href="../file/tests/sql/mutation/insert_full_trailing_comma.html">tests/sql/mutation/insert_full_trailing_comma</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test (id, name, value) VALUES (1, &#39;a&#39;, 101), (2, &#39;b&#39;, 102),
<a href="#h51-0-1" id="h51-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h51-0-2" id="h51-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h52" href="../file/tests/sql/mutation/insert_missing_column.html">tests/sql/mutation/insert_missing_column</a> b/<a href="../file/tests/sql/mutation/insert_missing_column.html">tests/sql/mutation/insert_missing_column</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test (id, missing) VALUES (0, &#39;x&#39;)
<a href="#h52-0-1" id="h52-0-1" class="d">-Error: Value(&quot;Column missing not found in table test&quot;)
</a><a href="#h52-0-2" id="h52-0-2" class="i">+Error: InvalidInput(&quot;column missing not found in table test&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h53" href="../file/tests/sql/mutation/insert_missing_table.html">tests/sql/mutation/insert_missing_table</a> b/<a href="../file/tests/sql/mutation/insert_missing_table.html">tests/sql/mutation/insert_missing_table</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO missing (id) VALUES (0)
<a href="#h53-0-1" id="h53-0-1" class="d">-Error: Value(&quot;Table missing does not exist&quot;)
</a><a href="#h53-0-2" id="h53-0-2" class="i">+Error: InvalidInput(&quot;table missing does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h54" href="../file/tests/sql/mutation/insert_multiple_tables.html">tests/sql/mutation/insert_multiple_tables</a> b/<a href="../file/tests/sql/mutation/insert_multiple_tables.html">tests/sql/mutation/insert_multiple_tables</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test, other VALUES (1)
<a href="#h54-0-1" id="h54-0-1" class="d">-Error: Parse(&quot;Expected token VALUES, found ,&quot;)
</a><a href="#h54-0-2" id="h54-0-2" class="i">+Error: InvalidInput(&quot;expected token VALUES, found ,&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h55" href="../file/tests/sql/mutation/insert_partial_columns.html">tests/sql/mutation/insert_partial_columns</a> b/<a href="../file/tests/sql/mutation/insert_partial_columns.html">tests/sql/mutation/insert_partial_columns</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO test (id, name, value) VALUES (1, &#39;a&#39;)
<a href="#h55-0-1" id="h55-0-1" class="d">-Error: Value(&quot;Column and value counts do not match&quot;)
</a><a href="#h55-0-2" id="h55-0-2" class="i">+Error: InvalidInput(&quot;column and value counts do not match&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h56" href="../file/tests/sql/mutation/update_bare.html">tests/sql/mutation/update_bare</a> b/<a href="../file/tests/sql/mutation/update_bare.html">tests/sql/mutation/update_bare</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test
<a href="#h56-0-1" id="h56-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h56-0-2" id="h56-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h57" href="../file/tests/sql/mutation/update_bare_no_table.html">tests/sql/mutation/update_bare_no_table</a> b/<a href="../file/tests/sql/mutation/update_bare_no_table.html">tests/sql/mutation/update_bare_no_table</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE
<a href="#h57-0-1" id="h57-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h57-0-2" id="h57-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h58" href="../file/tests/sql/mutation/update_bare_set.html">tests/sql/mutation/update_bare_set</a> b/<a href="../file/tests/sql/mutation/update_bare_set.html">tests/sql/mutation/update_bare_set</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET
<a href="#h58-0-1" id="h58-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h58-0-2" id="h58-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h59" href="../file/tests/sql/mutation/update_bare_where.html">tests/sql/mutation/update_bare_where</a> b/<a href="../file/tests/sql/mutation/update_bare_where.html">tests/sql/mutation/update_bare_where</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET name = &#39;x&#39; WHERE
<a href="#h59-0-1" id="h59-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h59-0-2" id="h59-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h60" href="../file/tests/sql/mutation/update_missing_column_set.html">tests/sql/mutation/update_missing_column_set</a> b/<a href="../file/tests/sql/mutation/update_missing_column_set.html">tests/sql/mutation/update_missing_column_set</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET missing = 0
<a href="#h60-0-1" id="h60-0-1" class="d">-Error: Value(&quot;Unknown field missing&quot;)
</a><a href="#h60-0-2" id="h60-0-2" class="i">+Error: InvalidInput(&quot;unknown field missing&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h61" href="../file/tests/sql/mutation/update_missing_column_where.html">tests/sql/mutation/update_missing_column_where</a> b/<a href="../file/tests/sql/mutation/update_missing_column_where.html">tests/sql/mutation/update_missing_column_where</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET name = &#39;x&#39; WHERE missing = TRUE
<a href="#h61-0-1" id="h61-0-1" class="d">-Error: Value(&quot;Unknown field missing&quot;)
</a><a href="#h61-0-2" id="h61-0-2" class="i">+Error: InvalidInput(&quot;unknown field missing&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h62" href="../file/tests/sql/mutation/update_missing_table.html">tests/sql/mutation/update_missing_table</a> b/<a href="../file/tests/sql/mutation/update_missing_table.html">tests/sql/mutation/update_missing_table</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE missing SET id = 0
<a href="#h62-0-1" id="h62-0-1" class="d">-Error: Value(&quot;Table missing does not exist&quot;)
</a><a href="#h62-0-2" id="h62-0-2" class="i">+Error: InvalidInput(&quot;table missing does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h63" href="../file/tests/sql/mutation/update_multiple_tables.html">tests/sql/mutation/update_multiple_tables</a> b/<a href="../file/tests/sql/mutation/update_multiple_tables.html">tests/sql/mutation/update_multiple_tables</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test, other SET id = 9 WHERE id = 1
<a href="#h63-0-1" id="h63-0-1" class="d">-Error: Parse(&quot;Expected token SET, found ,&quot;)
</a><a href="#h63-0-2" id="h63-0-2" class="i">+Error: InvalidInput(&quot;expected token SET, found ,&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h64" href="../file/tests/sql/mutation/update_where_float.html">tests/sql/mutation/update_where_float</a> b/<a href="../file/tests/sql/mutation/update_where_float.html">tests/sql/mutation/update_where_float</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET name = &#39;x&#39; WHERE 3.14
<a href="#h64-0-1" id="h64-0-1" class="d">-Error: Value(&quot;Filter returned 3.14, expected boolean&quot;)
</a><a href="#h64-0-2" id="h64-0-2" class="i">+Error: InvalidData(&quot;filter returned 3.14, expected boolean&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h65" href="../file/tests/sql/mutation/update_where_integer.html">tests/sql/mutation/update_where_integer</a> b/<a href="../file/tests/sql/mutation/update_where_integer.html">tests/sql/mutation/update_where_integer</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET name = &#39;x&#39; WHERE 1
<a href="#h65-0-1" id="h65-0-1" class="d">-Error: Value(&quot;Filter returned 1, expected boolean&quot;)
</a><a href="#h65-0-2" id="h65-0-2" class="i">+Error: InvalidData(&quot;filter returned 1, expected boolean&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h66" href="../file/tests/sql/mutation/update_where_string.html">tests/sql/mutation/update_where_string</a> b/<a href="../file/tests/sql/mutation/update_where_string.html">tests/sql/mutation/update_where_string</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET name = &#39;x&#39; WHERE &#39;a&#39;
<a href="#h66-0-1" id="h66-0-1" class="d">-Error: Value(&quot;Filter returned a, expected boolean&quot;)
</a><a href="#h66-0-2" id="h66-0-2" class="i">+Error: InvalidData(&quot;filter returned a, expected boolean&quot;)
</a> 
 Storage:
 CREATE TABLE other (
<b>diff --git a/<a id="h67" href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a> b/<a href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -1,6 +1,7 @@
</a> //! Tests for the SQL query engine. Runs SQL queries against an in-memory database,
 //! and compares the results with golden files stored under tests/sql/query/
<a href="#h67-0-2" id="h67-0-2" class="d">-use toydb::error::{Error, Result};
</a><a href="#h67-0-3" id="h67-0-3" class="i">+use toydb::errdata;
</a><a href="#h67-0-4" id="h67-0-4" class="i">+use toydb::error::Result;
</a> use toydb::sql::engine::{Engine, Transaction};
 use toydb::sql::execution::ResultSet;
 use toydb::sql::parser::Parser;
<a href="#h67-1" id="h67-1" class="h">@@ -109,10 +110,8 @@ macro_rules! test_query {
</a>                         write!(f, &quot; &lt;none&gt;\n&quot;)?;
                     }
                 }
<a href="#h67-1-3" id="h67-1-3" class="d">-                Ok(r) =&gt; return Err(Error::Internal(format!(&quot;Unexpected result {:?}\n&quot;, r))),
</a><a href="#h67-1-4" id="h67-1-4" class="d">-                Err(err) =&gt; {
</a><a href="#h67-1-5" id="h67-1-5" class="d">-                    write!(f, &quot;Error: {}\n&quot;, err)?;
</a><a href="#h67-1-6" id="h67-1-6" class="d">-                }
</a><a href="#h67-1-7" id="h67-1-7" class="i">+                Ok(r) =&gt; return errdata!(&quot;unexpected result {r:?}\n&quot;),
</a><a href="#h67-1-8" id="h67-1-8" class="i">+                Err(err) =&gt; write!(f, &quot;Error: {err}\n&quot;)?,
</a>             }
             write!(f, &quot;\n&quot;)?;
 
<b>diff --git a/<a id="h68" href="../file/tests/sql/query/agg_nested.html">tests/sql/query/agg_nested</a> b/<a href="../file/tests/sql/query/agg_nested.html">tests/sql/query/agg_nested</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT MAX(MIN(rating)) FROM movies
 
<a href="#h68-0-2" id="h68-0-2" class="d">-Error: Aggregate functions can&#39;t be nested
</a><a href="#h68-0-3" id="h68-0-3" class="i">+Error: invalid input: aggregate functions can&#39;t be nested
</a> 
 AST: Select {
     select: [
<a href="#h68-1" id="h68-1" class="h">@@ -36,4 +36,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h68-1-3" id="h68-1-3" class="d">-Plan: Value(&quot;Aggregate functions can&#39;t be nested&quot;)
</a><a href="#h68-1-4" id="h68-1-4" class="d">-\ No newline at end of file
</a><a href="#h68-1-5" id="h68-1-5" class="i">+Plan: InvalidInput(&quot;aggregate functions can&#39;t be nested&quot;)
</a><a href="#h68-1-6" id="h68-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h69" href="../file/tests/sql/query/agg_ungrouped.html">tests/sql/query/agg_ungrouped</a> b/<a href="../file/tests/sql/query/agg_ungrouped.html">tests/sql/query/agg_ungrouped</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT studio_id, COUNT(*) FROM movies
 
<a href="#h69-0-2" id="h69-0-2" class="d">-Error: Unknown field studio_id
</a><a href="#h69-0-3" id="h69-0-3" class="i">+Error: invalid input: unknown field studio_id
</a> 
 AST: Select {
     select: [
<a href="#h69-1" id="h69-1" class="h">@@ -39,4 +39,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h69-1-3" id="h69-1-3" class="d">-Plan: Value(&quot;Unknown field studio_id&quot;)
</a><a href="#h69-1-4" id="h69-1-4" class="d">-\ No newline at end of file
</a><a href="#h69-1-5" id="h69-1-5" class="i">+Plan: InvalidInput(&quot;unknown field studio_id&quot;)
</a><a href="#h69-1-6" id="h69-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h70" href="../file/tests/sql/query/as_all.html">tests/sql/query/as_all</a> b/<a href="../file/tests/sql/query/as_all.html">tests/sql/query/as_all</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * AS all FROM movies
 
<a href="#h70-0-2" id="h70-0-2" class="d">-Error: Unexpected token AS
</a><a href="#h70-0-3" id="h70-0-3" class="i">+Error: invalid input: unexpected token AS
</a> 
<a href="#h70-0-5" id="h70-0-5" class="d">-AST: Parse(&quot;Unexpected token AS&quot;)
</a><a href="#h70-0-6" id="h70-0-6" class="d">-\ No newline at end of file
</a><a href="#h70-0-7" id="h70-0-7" class="i">+AST: InvalidInput(&quot;unexpected token AS&quot;)
</a><a href="#h70-0-8" id="h70-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h71" href="../file/tests/sql/query/as_bare.html">tests/sql/query/as_bare</a> b/<a href="../file/tests/sql/query/as_bare.html">tests/sql/query/as_bare</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT 1 AS
 
<a href="#h71-0-2" id="h71-0-2" class="d">-Error: Unexpected end of input
</a><a href="#h71-0-3" id="h71-0-3" class="i">+Error: invalid input: unexpected end of input
</a> 
<a href="#h71-0-5" id="h71-0-5" class="d">-AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h71-0-6" id="h71-0-6" class="d">-\ No newline at end of file
</a><a href="#h71-0-7" id="h71-0-7" class="i">+AST: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h71-0-8" id="h71-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h72" href="../file/tests/sql/query/as_qualified.html">tests/sql/query/as_qualified</a> b/<a href="../file/tests/sql/query/as_qualified.html">tests/sql/query/as_qualified</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT 1 AS a.b FROM movies
 
<a href="#h72-0-2" id="h72-0-2" class="d">-Error: Unexpected token .
</a><a href="#h72-0-3" id="h72-0-3" class="i">+Error: invalid input: unexpected token .
</a> 
<a href="#h72-0-5" id="h72-0-5" class="d">-AST: Parse(&quot;Unexpected token .&quot;)
</a><a href="#h72-0-6" id="h72-0-6" class="d">-\ No newline at end of file
</a><a href="#h72-0-7" id="h72-0-7" class="i">+AST: InvalidInput(&quot;unexpected token .&quot;)
</a><a href="#h72-0-8" id="h72-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h73" href="../file/tests/sql/query/bare.html">tests/sql/query/bare</a> b/<a href="../file/tests/sql/query/bare.html">tests/sql/query/bare</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT
 
<a href="#h73-0-2" id="h73-0-2" class="d">-Error: Unexpected end of input
</a><a href="#h73-0-3" id="h73-0-3" class="i">+Error: invalid input: unexpected end of input
</a> 
<a href="#h73-0-5" id="h73-0-5" class="d">-AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h73-0-6" id="h73-0-6" class="d">-\ No newline at end of file
</a><a href="#h73-0-7" id="h73-0-7" class="i">+AST: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h73-0-8" id="h73-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h74" href="../file/tests/sql/query/expr_dynamic.html">tests/sql/query/expr_dynamic</a> b/<a href="../file/tests/sql/query/expr_dynamic.html">tests/sql/query/expr_dynamic</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT 2020 - year AS age FROM movies
 
<a href="#h74-0-2" id="h74-0-2" class="d">-Error: Unknown field year
</a><a href="#h74-0-3" id="h74-0-3" class="i">+Error: invalid input: unknown field year
</a> 
 AST: Select {
     select: [
<a href="#h74-1" id="h74-1" class="h">@@ -37,4 +37,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h74-1-3" id="h74-1-3" class="d">-Plan: Value(&quot;Unknown field year&quot;)
</a><a href="#h74-1-4" id="h74-1-4" class="d">-\ No newline at end of file
</a><a href="#h74-1-5" id="h74-1-5" class="i">+Plan: InvalidInput(&quot;unknown field year&quot;)
</a><a href="#h74-1-6" id="h74-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h75" href="../file/tests/sql/query/field_ambiguous.html">tests/sql/query/field_ambiguous</a> b/<a href="../file/tests/sql/query/field_ambiguous.html">tests/sql/query/field_ambiguous</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT id FROM movies, genres
 
<a href="#h75-0-2" id="h75-0-2" class="d">-Error: Ambiguous field id
</a><a href="#h75-0-3" id="h75-0-3" class="i">+Error: invalid input: ambiguous field id
</a> 
 AST: Select {
     select: [
<a href="#h75-1" id="h75-1" class="h">@@ -30,4 +30,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h75-1-3" id="h75-1-3" class="d">-Plan: Value(&quot;Ambiguous field id&quot;)
</a><a href="#h75-1-4" id="h75-1-4" class="d">-\ No newline at end of file
</a><a href="#h75-1-5" id="h75-1-5" class="i">+Plan: InvalidInput(&quot;ambiguous field id&quot;)
</a><a href="#h75-1-6" id="h75-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h76" href="../file/tests/sql/query/field_qualified_nested.html">tests/sql/query/field_qualified_nested</a> b/<a href="../file/tests/sql/query/field_qualified_nested.html">tests/sql/query/field_qualified_nested</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT movies.id.value FROM movies
 
<a href="#h76-0-2" id="h76-0-2" class="d">-Error: Unexpected token .
</a><a href="#h76-0-3" id="h76-0-3" class="i">+Error: invalid input: unexpected token .
</a> 
<a href="#h76-0-5" id="h76-0-5" class="d">-AST: Parse(&quot;Unexpected token .&quot;)
</a><a href="#h76-0-6" id="h76-0-6" class="d">-\ No newline at end of file
</a><a href="#h76-0-7" id="h76-0-7" class="i">+AST: InvalidInput(&quot;unexpected token .&quot;)
</a><a href="#h76-0-8" id="h76-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h77" href="../file/tests/sql/query/field_unknown.html">tests/sql/query/field_unknown</a> b/<a href="../file/tests/sql/query/field_unknown.html">tests/sql/query/field_unknown</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT unknown FROM movies
 
<a href="#h77-0-2" id="h77-0-2" class="d">-Error: Unknown field unknown
</a><a href="#h77-0-3" id="h77-0-3" class="i">+Error: invalid input: unknown field unknown
</a> 
 AST: Select {
     select: [
<a href="#h77-1" id="h77-1" class="h">@@ -26,4 +26,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h77-1-3" id="h77-1-3" class="d">-Plan: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h77-1-4" id="h77-1-4" class="d">-\ No newline at end of file
</a><a href="#h77-1-5" id="h77-1-5" class="i">+Plan: InvalidInput(&quot;unknown field unknown&quot;)
</a><a href="#h77-1-6" id="h77-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h78" href="../file/tests/sql/query/field_unknown_aliased.html">tests/sql/query/field_unknown_aliased</a> b/<a href="../file/tests/sql/query/field_unknown_aliased.html">tests/sql/query/field_unknown_aliased</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT movies.id FROM movies AS m
 
<a href="#h78-0-2" id="h78-0-2" class="d">-Error: Unknown table movies
</a><a href="#h78-0-3" id="h78-0-3" class="i">+Error: invalid input: unknown table movies
</a> 
 AST: Select {
     select: [
<a href="#h78-1" id="h78-1" class="h">@@ -30,4 +30,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h78-1-3" id="h78-1-3" class="d">-Plan: Value(&quot;Unknown table movies&quot;)
</a><a href="#h78-1-4" id="h78-1-4" class="d">-\ No newline at end of file
</a><a href="#h78-1-5" id="h78-1-5" class="i">+Plan: InvalidInput(&quot;unknown table movies&quot;)
</a><a href="#h78-1-6" id="h78-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h79" href="../file/tests/sql/query/field_unknown_qualified.html">tests/sql/query/field_unknown_qualified</a> b/<a href="../file/tests/sql/query/field_unknown_qualified.html">tests/sql/query/field_unknown_qualified</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT movies.unknown FROM movies
 
<a href="#h79-0-2" id="h79-0-2" class="d">-Error: Unknown field movies.unknown
</a><a href="#h79-0-3" id="h79-0-3" class="i">+Error: invalid input: Unknown field movies.unknown
</a> 
 AST: Select {
     select: [
<a href="#h79-1" id="h79-1" class="h">@@ -28,4 +28,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h79-1-3" id="h79-1-3" class="d">-Plan: Value(&quot;Unknown field movies.unknown&quot;)
</a><a href="#h79-1-4" id="h79-1-4" class="d">-\ No newline at end of file
</a><a href="#h79-1-5" id="h79-1-5" class="i">+Plan: InvalidInput(&quot;Unknown field movies.unknown&quot;)
</a><a href="#h79-1-6" id="h79-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h80" href="../file/tests/sql/query/field_unknown_table.html">tests/sql/query/field_unknown_table</a> b/<a href="../file/tests/sql/query/field_unknown_table.html">tests/sql/query/field_unknown_table</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT unknown.id FROM movies
 
<a href="#h80-0-2" id="h80-0-2" class="d">-Error: Unknown table unknown
</a><a href="#h80-0-3" id="h80-0-3" class="i">+Error: invalid input: unknown table unknown
</a> 
 AST: Select {
     select: [
<a href="#h80-1" id="h80-1" class="h">@@ -28,4 +28,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h80-1-3" id="h80-1-3" class="d">-Plan: Value(&quot;Unknown table unknown&quot;)
</a><a href="#h80-1-4" id="h80-1-4" class="d">-\ No newline at end of file
</a><a href="#h80-1-5" id="h80-1-5" class="i">+Plan: InvalidInput(&quot;unknown table unknown&quot;)
</a><a href="#h80-1-6" id="h80-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h81" href="../file/tests/sql/query/from_alias_duplicate.html">tests/sql/query/from_alias_duplicate</a> b/<a href="../file/tests/sql/query/from_alias_duplicate.html">tests/sql/query/from_alias_duplicate</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies a, genres a
 
<a href="#h81-0-2" id="h81-0-2" class="d">-Error: Duplicate table name a
</a><a href="#h81-0-3" id="h81-0-3" class="i">+Error: invalid input: duplicate table name a
</a> 
 AST: Select {
     select: [],
<a href="#h81-1" id="h81-1" class="h">@@ -26,4 +26,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h81-1-3" id="h81-1-3" class="d">-Plan: Value(&quot;Duplicate table name a&quot;)
</a><a href="#h81-1-4" id="h81-1-4" class="d">-\ No newline at end of file
</a><a href="#h81-1-5" id="h81-1-5" class="i">+Plan: InvalidInput(&quot;duplicate table name a&quot;)
</a><a href="#h81-1-6" id="h81-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h82" href="../file/tests/sql/query/from_alias_duplicate_join.html">tests/sql/query/from_alias_duplicate_join</a> b/<a href="../file/tests/sql/query/from_alias_duplicate_join.html">tests/sql/query/from_alias_duplicate_join</a></b>
<a href="#h82-0" id="h82-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies a JOIN genres a ON TRUE
 
<a href="#h82-0-2" id="h82-0-2" class="d">-Error: Duplicate table name a
</a><a href="#h82-0-3" id="h82-0-3" class="i">+Error: invalid input: duplicate table name a
</a> 
 AST: Select {
     select: [],
<a href="#h82-1" id="h82-1" class="h">@@ -36,4 +36,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h82-1-3" id="h82-1-3" class="d">-Plan: Value(&quot;Duplicate table name a&quot;)
</a><a href="#h82-1-4" id="h82-1-4" class="d">-\ No newline at end of file
</a><a href="#h82-1-5" id="h82-1-5" class="i">+Plan: InvalidInput(&quot;duplicate table name a&quot;)
</a><a href="#h82-1-6" id="h82-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h83" href="../file/tests/sql/query/from_bare.html">tests/sql/query/from_bare</a> b/<a href="../file/tests/sql/query/from_bare.html">tests/sql/query/from_bare</a></b>
<a href="#h83-0" id="h83-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM
 
<a href="#h83-0-2" id="h83-0-2" class="d">-Error: Unexpected end of input
</a><a href="#h83-0-3" id="h83-0-3" class="i">+Error: invalid input: unexpected end of input
</a> 
<a href="#h83-0-5" id="h83-0-5" class="d">-AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h83-0-6" id="h83-0-6" class="d">-\ No newline at end of file
</a><a href="#h83-0-7" id="h83-0-7" class="i">+AST: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h83-0-8" id="h83-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h84" href="../file/tests/sql/query/from_duplicate.html">tests/sql/query/from_duplicate</a> b/<a href="../file/tests/sql/query/from_duplicate.html">tests/sql/query/from_duplicate</a></b>
<a href="#h84-0" id="h84-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies, movies
 
<a href="#h84-0-2" id="h84-0-2" class="d">-Error: Duplicate table name movies
</a><a href="#h84-0-3" id="h84-0-3" class="i">+Error: invalid input: duplicate table name movies
</a> 
 AST: Select {
     select: [],
<a href="#h84-1" id="h84-1" class="h">@@ -22,4 +22,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h84-1-3" id="h84-1-3" class="d">-Plan: Value(&quot;Duplicate table name movies&quot;)
</a><a href="#h84-1-4" id="h84-1-4" class="d">-\ No newline at end of file
</a><a href="#h84-1-5" id="h84-1-5" class="i">+Plan: InvalidInput(&quot;duplicate table name movies&quot;)
</a><a href="#h84-1-6" id="h84-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h85" href="../file/tests/sql/query/from_unknown.html">tests/sql/query/from_unknown</a> b/<a href="../file/tests/sql/query/from_unknown.html">tests/sql/query/from_unknown</a></b>
<a href="#h85-0" id="h85-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM unknown
 
<a href="#h85-0-2" id="h85-0-2" class="d">-Error: Table unknown does not exist
</a><a href="#h85-0-3" id="h85-0-3" class="i">+Error: invalid input: table unknown does not exist
</a> 
 AST: Select {
     select: [],
<a href="#h85-1" id="h85-1" class="h">@@ -18,4 +18,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h85-1-3" id="h85-1-3" class="d">-Plan: Value(&quot;Table unknown does not exist&quot;)
</a><a href="#h85-1-4" id="h85-1-4" class="d">-\ No newline at end of file
</a><a href="#h85-1-5" id="h85-1-5" class="i">+Plan: InvalidInput(&quot;table unknown does not exist&quot;)
</a><a href="#h85-1-6" id="h85-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h86" href="../file/tests/sql/query/group_expr_aggr_nogroupref.html">tests/sql/query/group_expr_aggr_nogroupref</a> b/<a href="../file/tests/sql/query/group_expr_aggr_nogroupref.html">tests/sql/query/group_expr_aggr_nogroupref</a></b>
<a href="#h86-0" id="h86-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) + id FROM movies GROUP BY studio_id ORDER BY studio_id
 
<a href="#h86-0-2" id="h86-0-2" class="d">-Error: Unknown field id
</a><a href="#h86-0-3" id="h86-0-3" class="i">+Error: invalid input: unknown field id
</a> 
 AST: Select {
     select: [
<a href="#h86-1" id="h86-1" class="h">@@ -82,4 +82,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h86-1-3" id="h86-1-3" class="d">-Plan: Value(&quot;Unknown field id&quot;)
</a><a href="#h86-1-4" id="h86-1-4" class="d">-\ No newline at end of file
</a><a href="#h86-1-5" id="h86-1-5" class="i">+Plan: InvalidInput(&quot;unknown field id&quot;)
</a><a href="#h86-1-6" id="h86-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h87" href="../file/tests/sql/query/group_expr_extended.html">tests/sql/query/group_expr_extended</a> b/<a href="../file/tests/sql/query/group_expr_extended.html">tests/sql/query/group_expr_extended</a></b>
<a href="#h87-0" id="h87-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT studio_id * 2 + 1, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
 
<a href="#h87-0-2" id="h87-0-2" class="d">-Error: Unknown field studio_id
</a><a href="#h87-0-3" id="h87-0-3" class="i">+Error: invalid input: unknown field studio_id
</a> 
 AST: Select {
     select: [
<a href="#h87-1" id="h87-1" class="h">@@ -80,4 +80,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h87-1-3" id="h87-1-3" class="d">-Plan: Value(&quot;Unknown field studio_id&quot;)
</a><a href="#h87-1-4" id="h87-1-4" class="d">-\ No newline at end of file
</a><a href="#h87-1-5" id="h87-1-5" class="i">+Plan: InvalidInput(&quot;unknown field studio_id&quot;)
</a><a href="#h87-1-6" id="h87-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h88" href="../file/tests/sql/query/group_unknown.html">tests/sql/query/group_unknown</a> b/<a href="../file/tests/sql/query/group_unknown.html">tests/sql/query/group_unknown</a></b>
<a href="#h88-0" id="h88-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT COUNT(*) FROM movies GROUP BY unknown
 
<a href="#h88-0-2" id="h88-0-2" class="d">-Error: Unknown field unknown
</a><a href="#h88-0-3" id="h88-0-3" class="i">+Error: invalid input: unknown field unknown
</a> 
 AST: Select {
     select: [
<a href="#h88-1" id="h88-1" class="h">@@ -37,4 +37,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h88-1-3" id="h88-1-3" class="d">-Plan: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h88-1-4" id="h88-1-4" class="d">-\ No newline at end of file
</a><a href="#h88-1-5" id="h88-1-5" class="i">+Plan: InvalidInput(&quot;unknown field unknown&quot;)
</a><a href="#h88-1-6" id="h88-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h89" href="../file/tests/sql/query/having_aggr_nested.html">tests/sql/query/having_aggr_nested</a> b/<a href="../file/tests/sql/query/having_aggr_nested.html">tests/sql/query/having_aggr_nested</a></b>
<a href="#h89-0" id="h89-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT studio_id, MAX(rating) AS best FROM movies GROUP BY studio_id HAVING MIN(best) &gt; 7 ORDER BY studio_id
 
<a href="#h89-0-2" id="h89-0-2" class="d">-Error: Aggregate function cannot reference aggregate
</a><a href="#h89-0-3" id="h89-0-3" class="i">+Error: invalid input: aggregate function cannot reference aggregate
</a> 
 AST: Select {
     select: [
<a href="#h89-1" id="h89-1" class="h">@@ -72,4 +72,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h89-1-3" id="h89-1-3" class="d">-Plan: Value(&quot;Aggregate function cannot reference aggregate&quot;)
</a><a href="#h89-1-4" id="h89-1-4" class="d">-\ No newline at end of file
</a><a href="#h89-1-5" id="h89-1-5" class="i">+Plan: InvalidInput(&quot;aggregate function cannot reference aggregate&quot;)
</a><a href="#h89-1-6" id="h89-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h90" href="../file/tests/sql/query/join_cross_on.html">tests/sql/query/join_cross_on</a> b/<a href="../file/tests/sql/query/join_cross_on.html">tests/sql/query/join_cross_on</a></b>
<a href="#h90-0" id="h90-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM movies CROSS JOIN genres ON movies.genre_id = genres.id
 
<a href="#h90-0-2" id="h90-0-2" class="d">-Error: Unexpected token ON
</a><a href="#h90-0-3" id="h90-0-3" class="i">+Error: invalid input: unexpected token ON
</a> 
<a href="#h90-0-5" id="h90-0-5" class="d">-AST: Parse(&quot;Unexpected token ON&quot;)
</a><a href="#h90-0-6" id="h90-0-6" class="d">-\ No newline at end of file
</a><a href="#h90-0-7" id="h90-0-7" class="i">+AST: InvalidInput(&quot;unexpected token ON&quot;)
</a><a href="#h90-0-8" id="h90-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h91" href="../file/tests/sql/query/join_inner_on_missing.html">tests/sql/query/join_inner_on_missing</a> b/<a href="../file/tests/sql/query/join_inner_on_missing.html">tests/sql/query/join_inner_on_missing</a></b>
<a href="#h91-0" id="h91-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM movies INNER JOIN genres
 
<a href="#h91-0-2" id="h91-0-2" class="d">-Error: Unexpected end of input
</a><a href="#h91-0-3" id="h91-0-3" class="i">+Error: invalid input: unexpected end of input
</a> 
<a href="#h91-0-5" id="h91-0-5" class="d">-AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h91-0-6" id="h91-0-6" class="d">-\ No newline at end of file
</a><a href="#h91-0-7" id="h91-0-7" class="i">+AST: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h91-0-8" id="h91-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h92" href="../file/tests/sql/query/limit_boolean.html">tests/sql/query/limit_boolean</a> b/<a href="../file/tests/sql/query/limit_boolean.html">tests/sql/query/limit_boolean</a></b>
<a href="#h92-0" id="h92-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies LIMIT TRUE
 
<a href="#h92-0-2" id="h92-0-2" class="d">-Error: Invalid limit TRUE
</a><a href="#h92-0-3" id="h92-0-3" class="i">+Error: invalid input: invalid limit TRUE
</a> 
 AST: Select {
     select: [],
<a href="#h92-1" id="h92-1" class="h">@@ -24,4 +24,4 @@ AST: Select {
</a>     ),
 }
 
<a href="#h92-1-3" id="h92-1-3" class="d">-Plan: Value(&quot;Invalid limit TRUE&quot;)
</a><a href="#h92-1-4" id="h92-1-4" class="d">-\ No newline at end of file
</a><a href="#h92-1-5" id="h92-1-5" class="i">+Plan: InvalidInput(&quot;invalid limit TRUE&quot;)
</a><a href="#h92-1-6" id="h92-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h93" href="../file/tests/sql/query/limit_dynamic.html">tests/sql/query/limit_dynamic</a> b/<a href="../file/tests/sql/query/limit_dynamic.html">tests/sql/query/limit_dynamic</a></b>
<a href="#h93-0" id="h93-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies LIMIT 2000 - released
 
<a href="#h93-0-2" id="h93-0-2" class="d">-Error: Expression must be constant, found field released
</a><a href="#h93-0-3" id="h93-0-3" class="i">+Error: invalid input: expression must be constant, found field released
</a> 
 AST: Select {
     select: [],
<a href="#h93-1" id="h93-1" class="h">@@ -32,4 +32,4 @@ AST: Select {
</a>     ),
 }
 
<a href="#h93-1-3" id="h93-1-3" class="d">-Plan: Value(&quot;Expression must be constant, found field released&quot;)
</a><a href="#h93-1-4" id="h93-1-4" class="d">-\ No newline at end of file
</a><a href="#h93-1-5" id="h93-1-5" class="i">+Plan: InvalidInput(&quot;expression must be constant, found field released&quot;)
</a><a href="#h93-1-6" id="h93-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h94" href="../file/tests/sql/query/limit_float.html">tests/sql/query/limit_float</a> b/<a href="../file/tests/sql/query/limit_float.html">tests/sql/query/limit_float</a></b>
<a href="#h94-0" id="h94-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies LIMIT 3.14
 
<a href="#h94-0-2" id="h94-0-2" class="d">-Error: Invalid limit 3.14
</a><a href="#h94-0-3" id="h94-0-3" class="i">+Error: invalid input: invalid limit 3.14
</a> 
 AST: Select {
     select: [],
<a href="#h94-1" id="h94-1" class="h">@@ -24,4 +24,4 @@ AST: Select {
</a>     ),
 }
 
<a href="#h94-1-3" id="h94-1-3" class="d">-Plan: Value(&quot;Invalid limit 3.14&quot;)
</a><a href="#h94-1-4" id="h94-1-4" class="d">-\ No newline at end of file
</a><a href="#h94-1-5" id="h94-1-5" class="i">+Plan: InvalidInput(&quot;invalid limit 3.14&quot;)
</a><a href="#h94-1-6" id="h94-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h95" href="../file/tests/sql/query/limit_multi.html">tests/sql/query/limit_multi</a> b/<a href="../file/tests/sql/query/limit_multi.html">tests/sql/query/limit_multi</a></b>
<a href="#h95-0" id="h95-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM movies LIMIT 3, 4
 
<a href="#h95-0-2" id="h95-0-2" class="d">-Error: Unexpected token ,
</a><a href="#h95-0-3" id="h95-0-3" class="i">+Error: invalid input: unexpected token ,
</a> 
<a href="#h95-0-5" id="h95-0-5" class="d">-AST: Parse(&quot;Unexpected token ,&quot;)
</a><a href="#h95-0-6" id="h95-0-6" class="d">-\ No newline at end of file
</a><a href="#h95-0-7" id="h95-0-7" class="i">+AST: InvalidInput(&quot;unexpected token ,&quot;)
</a><a href="#h95-0-8" id="h95-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h96" href="../file/tests/sql/query/limit_neg.html">tests/sql/query/limit_neg</a> b/<a href="../file/tests/sql/query/limit_neg.html">tests/sql/query/limit_neg</a></b>
<a href="#h96-0" id="h96-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies LIMIT -1
 
<a href="#h96-0-2" id="h96-0-2" class="d">-Error: Invalid limit -1
</a><a href="#h96-0-3" id="h96-0-3" class="i">+Error: invalid input: invalid limit -1
</a> 
 AST: Select {
     select: [],
<a href="#h96-1" id="h96-1" class="h">@@ -28,4 +28,4 @@ AST: Select {
</a>     ),
 }
 
<a href="#h96-1-3" id="h96-1-3" class="d">-Plan: Value(&quot;Invalid limit -1&quot;)
</a><a href="#h96-1-4" id="h96-1-4" class="d">-\ No newline at end of file
</a><a href="#h96-1-5" id="h96-1-5" class="i">+Plan: InvalidInput(&quot;invalid limit -1&quot;)
</a><a href="#h96-1-6" id="h96-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h97" href="../file/tests/sql/query/limit_null.html">tests/sql/query/limit_null</a> b/<a href="../file/tests/sql/query/limit_null.html">tests/sql/query/limit_null</a></b>
<a href="#h97-0" id="h97-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies LIMIT NULL
 
<a href="#h97-0-2" id="h97-0-2" class="d">-Error: Invalid limit NULL
</a><a href="#h97-0-3" id="h97-0-3" class="i">+Error: invalid input: invalid limit NULL
</a> 
 AST: Select {
     select: [],
<a href="#h97-1" id="h97-1" class="h">@@ -22,4 +22,4 @@ AST: Select {
</a>     ),
 }
 
<a href="#h97-1-3" id="h97-1-3" class="d">-Plan: Value(&quot;Invalid limit NULL&quot;)
</a><a href="#h97-1-4" id="h97-1-4" class="d">-\ No newline at end of file
</a><a href="#h97-1-5" id="h97-1-5" class="i">+Plan: InvalidInput(&quot;invalid limit NULL&quot;)
</a><a href="#h97-1-6" id="h97-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h98" href="../file/tests/sql/query/limit_string.html">tests/sql/query/limit_string</a> b/<a href="../file/tests/sql/query/limit_string.html">tests/sql/query/limit_string</a></b>
<a href="#h98-0" id="h98-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies LIMIT &#39;abc&#39;
 
<a href="#h98-0-2" id="h98-0-2" class="d">-Error: Invalid limit abc
</a><a href="#h98-0-3" id="h98-0-3" class="i">+Error: invalid input: invalid limit abc
</a> 
 AST: Select {
     select: [],
<a href="#h98-1" id="h98-1" class="h">@@ -24,4 +24,4 @@ AST: Select {
</a>     ),
 }
 
<a href="#h98-1-3" id="h98-1-3" class="d">-Plan: Value(&quot;Invalid limit abc&quot;)
</a><a href="#h98-1-4" id="h98-1-4" class="d">-\ No newline at end of file
</a><a href="#h98-1-5" id="h98-1-5" class="i">+Plan: InvalidInput(&quot;invalid limit abc&quot;)
</a><a href="#h98-1-6" id="h98-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h99" href="../file/tests/sql/query/offset_boolean.html">tests/sql/query/offset_boolean</a> b/<a href="../file/tests/sql/query/offset_boolean.html">tests/sql/query/offset_boolean</a></b>
<a href="#h99-0" id="h99-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies OFFSET TRUE
 
<a href="#h99-0-2" id="h99-0-2" class="d">-Error: Invalid offset TRUE
</a><a href="#h99-0-3" id="h99-0-3" class="i">+Error: invalid input: invalid offset TRUE
</a> 
 AST: Select {
     select: [],
<a href="#h99-1" id="h99-1" class="h">@@ -24,4 +24,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h99-1-3" id="h99-1-3" class="d">-Plan: Value(&quot;Invalid offset TRUE&quot;)
</a><a href="#h99-1-4" id="h99-1-4" class="d">-\ No newline at end of file
</a><a href="#h99-1-5" id="h99-1-5" class="i">+Plan: InvalidInput(&quot;invalid offset TRUE&quot;)
</a><a href="#h99-1-6" id="h99-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h100" href="../file/tests/sql/query/offset_dynamic.html">tests/sql/query/offset_dynamic</a> b/<a href="../file/tests/sql/query/offset_dynamic.html">tests/sql/query/offset_dynamic</a></b>
<a href="#h100-0" id="h100-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies OFFSET 2000 - released
 
<a href="#h100-0-2" id="h100-0-2" class="d">-Error: Expression must be constant, found field released
</a><a href="#h100-0-3" id="h100-0-3" class="i">+Error: invalid input: expression must be constant, found field released
</a> 
 AST: Select {
     select: [],
<a href="#h100-1" id="h100-1" class="h">@@ -32,4 +32,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h100-1-3" id="h100-1-3" class="d">-Plan: Value(&quot;Expression must be constant, found field released&quot;)
</a><a href="#h100-1-4" id="h100-1-4" class="d">-\ No newline at end of file
</a><a href="#h100-1-5" id="h100-1-5" class="i">+Plan: InvalidInput(&quot;expression must be constant, found field released&quot;)
</a><a href="#h100-1-6" id="h100-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h101" href="../file/tests/sql/query/offset_float.html">tests/sql/query/offset_float</a> b/<a href="../file/tests/sql/query/offset_float.html">tests/sql/query/offset_float</a></b>
<a href="#h101-0" id="h101-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies OFFSET 3.14
 
<a href="#h101-0-2" id="h101-0-2" class="d">-Error: Invalid offset 3.14
</a><a href="#h101-0-3" id="h101-0-3" class="i">+Error: invalid input: invalid offset 3.14
</a> 
 AST: Select {
     select: [],
<a href="#h101-1" id="h101-1" class="h">@@ -24,4 +24,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h101-1-3" id="h101-1-3" class="d">-Plan: Value(&quot;Invalid offset 3.14&quot;)
</a><a href="#h101-1-4" id="h101-1-4" class="d">-\ No newline at end of file
</a><a href="#h101-1-5" id="h101-1-5" class="i">+Plan: InvalidInput(&quot;invalid offset 3.14&quot;)
</a><a href="#h101-1-6" id="h101-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h102" href="../file/tests/sql/query/offset_multi.html">tests/sql/query/offset_multi</a> b/<a href="../file/tests/sql/query/offset_multi.html">tests/sql/query/offset_multi</a></b>
<a href="#h102-0" id="h102-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM movies OFFSET 3, 4
 
<a href="#h102-0-2" id="h102-0-2" class="d">-Error: Unexpected token ,
</a><a href="#h102-0-3" id="h102-0-3" class="i">+Error: invalid input: unexpected token ,
</a> 
<a href="#h102-0-5" id="h102-0-5" class="d">-AST: Parse(&quot;Unexpected token ,&quot;)
</a><a href="#h102-0-6" id="h102-0-6" class="d">-\ No newline at end of file
</a><a href="#h102-0-7" id="h102-0-7" class="i">+AST: InvalidInput(&quot;unexpected token ,&quot;)
</a><a href="#h102-0-8" id="h102-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h103" href="../file/tests/sql/query/offset_neg.html">tests/sql/query/offset_neg</a> b/<a href="../file/tests/sql/query/offset_neg.html">tests/sql/query/offset_neg</a></b>
<a href="#h103-0" id="h103-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies OFFSET -1
 
<a href="#h103-0-2" id="h103-0-2" class="d">-Error: Invalid offset -1
</a><a href="#h103-0-3" id="h103-0-3" class="i">+Error: invalid input: invalid offset -1
</a> 
 AST: Select {
     select: [],
<a href="#h103-1" id="h103-1" class="h">@@ -28,4 +28,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h103-1-3" id="h103-1-3" class="d">-Plan: Value(&quot;Invalid offset -1&quot;)
</a><a href="#h103-1-4" id="h103-1-4" class="d">-\ No newline at end of file
</a><a href="#h103-1-5" id="h103-1-5" class="i">+Plan: InvalidInput(&quot;invalid offset -1&quot;)
</a><a href="#h103-1-6" id="h103-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h104" href="../file/tests/sql/query/offset_null.html">tests/sql/query/offset_null</a> b/<a href="../file/tests/sql/query/offset_null.html">tests/sql/query/offset_null</a></b>
<a href="#h104-0" id="h104-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies OFFSET NULL
 
<a href="#h104-0-2" id="h104-0-2" class="d">-Error: Invalid offset NULL
</a><a href="#h104-0-3" id="h104-0-3" class="i">+Error: invalid input: invalid offset NULL
</a> 
 AST: Select {
     select: [],
<a href="#h104-1" id="h104-1" class="h">@@ -22,4 +22,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h104-1-3" id="h104-1-3" class="d">-Plan: Value(&quot;Invalid offset NULL&quot;)
</a><a href="#h104-1-4" id="h104-1-4" class="d">-\ No newline at end of file
</a><a href="#h104-1-5" id="h104-1-5" class="i">+Plan: InvalidInput(&quot;invalid offset NULL&quot;)
</a><a href="#h104-1-6" id="h104-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h105" href="../file/tests/sql/query/offset_string.html">tests/sql/query/offset_string</a> b/<a href="../file/tests/sql/query/offset_string.html">tests/sql/query/offset_string</a></b>
<a href="#h105-0" id="h105-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies OFFSET &#39;abc&#39;
 
<a href="#h105-0-2" id="h105-0-2" class="d">-Error: Invalid offset abc
</a><a href="#h105-0-3" id="h105-0-3" class="i">+Error: invalid input: invalid offset abc
</a> 
 AST: Select {
     select: [],
<a href="#h105-1" id="h105-1" class="h">@@ -24,4 +24,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h105-1-3" id="h105-1-3" class="d">-Plan: Value(&quot;Invalid offset abc&quot;)
</a><a href="#h105-1-4" id="h105-1-4" class="d">-\ No newline at end of file
</a><a href="#h105-1-5" id="h105-1-5" class="i">+Plan: InvalidInput(&quot;invalid offset abc&quot;)
</a><a href="#h105-1-6" id="h105-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h106" href="../file/tests/sql/query/order_field_ambiguous.html">tests/sql/query/order_field_ambiguous</a> b/<a href="../file/tests/sql/query/order_field_ambiguous.html">tests/sql/query/order_field_ambiguous</a></b>
<a href="#h106-0" id="h106-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY id
 
<a href="#h106-0-2" id="h106-0-2" class="d">-Error: Ambiguous field id
</a><a href="#h106-0-3" id="h106-0-3" class="i">+Error: invalid input: ambiguous field id
</a> 
 AST: Select {
     select: [],
<a href="#h106-1" id="h106-1" class="h">@@ -47,4 +47,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h106-1-3" id="h106-1-3" class="d">-Plan: Value(&quot;Ambiguous field id&quot;)
</a><a href="#h106-1-4" id="h106-1-4" class="d">-\ No newline at end of file
</a><a href="#h106-1-5" id="h106-1-5" class="i">+Plan: InvalidInput(&quot;ambiguous field id&quot;)
</a><a href="#h106-1-6" id="h106-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h107" href="../file/tests/sql/query/order_field_unknown.html">tests/sql/query/order_field_unknown</a> b/<a href="../file/tests/sql/query/order_field_unknown.html">tests/sql/query/order_field_unknown</a></b>
<a href="#h107-0" id="h107-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies ORDER BY unknown
 
<a href="#h107-0-2" id="h107-0-2" class="d">-Error: Unknown field unknown
</a><a href="#h107-0-3" id="h107-0-3" class="i">+Error: invalid input: unknown field unknown
</a> 
 AST: Select {
     select: [],
<a href="#h107-1" id="h107-1" class="h">@@ -26,4 +26,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h107-1-3" id="h107-1-3" class="d">-Plan: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h107-1-4" id="h107-1-4" class="d">-\ No newline at end of file
</a><a href="#h107-1-5" id="h107-1-5" class="i">+Plan: InvalidInput(&quot;unknown field unknown&quot;)
</a><a href="#h107-1-6" id="h107-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h108" href="../file/tests/sql/query/order_trailing_comma.html">tests/sql/query/order_trailing_comma</a> b/<a href="../file/tests/sql/query/order_trailing_comma.html">tests/sql/query/order_trailing_comma</a></b>
<a href="#h108-0" id="h108-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM movies ORDER BY id,
 
<a href="#h108-0-2" id="h108-0-2" class="d">-Error: Unexpected end of input
</a><a href="#h108-0-3" id="h108-0-3" class="i">+Error: invalid input: unexpected end of input
</a> 
<a href="#h108-0-5" id="h108-0-5" class="d">-AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h108-0-6" id="h108-0-6" class="d">-\ No newline at end of file
</a><a href="#h108-0-7" id="h108-0-7" class="i">+AST: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h108-0-8" id="h108-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h109" href="../file/tests/sql/query/order_unknown_dir.html">tests/sql/query/order_unknown_dir</a> b/<a href="../file/tests/sql/query/order_unknown_dir.html">tests/sql/query/order_unknown_dir</a></b>
<a href="#h109-0" id="h109-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM movies ORDER BY id X
 
<a href="#h109-0-2" id="h109-0-2" class="d">-Error: Unexpected token x
</a><a href="#h109-0-3" id="h109-0-3" class="i">+Error: invalid input: unexpected token x
</a> 
<a href="#h109-0-5" id="h109-0-5" class="d">-AST: Parse(&quot;Unexpected token x&quot;)
</a><a href="#h109-0-6" id="h109-0-6" class="d">-\ No newline at end of file
</a><a href="#h109-0-7" id="h109-0-7" class="i">+AST: InvalidInput(&quot;unexpected token x&quot;)
</a><a href="#h109-0-8" id="h109-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h110" href="../file/tests/sql/query/trailing_comma.html">tests/sql/query/trailing_comma</a> b/<a href="../file/tests/sql/query/trailing_comma.html">tests/sql/query/trailing_comma</a></b>
<a href="#h110-0" id="h110-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT 1,
 
<a href="#h110-0-2" id="h110-0-2" class="d">-Error: Unexpected end of input
</a><a href="#h110-0-3" id="h110-0-3" class="i">+Error: invalid input: unexpected end of input
</a> 
<a href="#h110-0-5" id="h110-0-5" class="d">-AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h110-0-6" id="h110-0-6" class="d">-\ No newline at end of file
</a><a href="#h110-0-7" id="h110-0-7" class="i">+AST: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h110-0-8" id="h110-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h111" href="../file/tests/sql/query/where_bare.html">tests/sql/query/where_bare</a> b/<a href="../file/tests/sql/query/where_bare.html">tests/sql/query/where_bare</a></b>
<a href="#h111-0" id="h111-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM movies WHERE
 
<a href="#h111-0-2" id="h111-0-2" class="d">-Error: Unexpected end of input
</a><a href="#h111-0-3" id="h111-0-3" class="i">+Error: invalid input: unexpected end of input
</a> 
<a href="#h111-0-5" id="h111-0-5" class="d">-AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h111-0-6" id="h111-0-6" class="d">-\ No newline at end of file
</a><a href="#h111-0-7" id="h111-0-7" class="i">+AST: InvalidInput(&quot;unexpected end of input&quot;)
</a><a href="#h111-0-8" id="h111-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h112" href="../file/tests/sql/query/where_field_aliased_select.html">tests/sql/query/where_field_aliased_select</a> b/<a href="../file/tests/sql/query/where_field_aliased_select.html">tests/sql/query/where_field_aliased_select</a></b>
<a href="#h112-0" id="h112-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT m.id AS movie_id, g.id AS genre_id FROM movies m, genres g WHERE movie_id &gt;= 3 AND genre_id = 1
 
<a href="#h112-0-2" id="h112-0-2" class="d">-Error: Unknown field movie_id
</a><a href="#h112-0-3" id="h112-0-3" class="i">+Error: invalid input: unknown field movie_id
</a> 
 AST: Select {
     select: [
<a href="#h112-1" id="h112-1" class="h">@@ -80,4 +80,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h112-1-3" id="h112-1-3" class="d">-Plan: Value(&quot;Unknown field movie_id&quot;)
</a><a href="#h112-1-4" id="h112-1-4" class="d">-\ No newline at end of file
</a><a href="#h112-1-5" id="h112-1-5" class="i">+Plan: InvalidInput(&quot;unknown field movie_id&quot;)
</a><a href="#h112-1-6" id="h112-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h113" href="../file/tests/sql/query/where_field_ambiguous.html">tests/sql/query/where_field_ambiguous</a> b/<a href="../file/tests/sql/query/where_field_ambiguous.html">tests/sql/query/where_field_ambiguous</a></b>
<a href="#h113-0" id="h113-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT movies.id, genres.id FROM movies, genres WHERE id &gt;= 3
 
<a href="#h113-0-2" id="h113-0-2" class="d">-Error: Ambiguous field id
</a><a href="#h113-0-3" id="h113-0-3" class="i">+Error: invalid input: ambiguous field id
</a> 
 AST: Select {
     select: [
<a href="#h113-1" id="h113-1" class="h">@@ -55,4 +55,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h113-1-3" id="h113-1-3" class="d">-Plan: Value(&quot;Ambiguous field id&quot;)
</a><a href="#h113-1-4" id="h113-1-4" class="d">-\ No newline at end of file
</a><a href="#h113-1-5" id="h113-1-5" class="i">+Plan: InvalidInput(&quot;ambiguous field id&quot;)
</a><a href="#h113-1-6" id="h113-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h114" href="../file/tests/sql/query/where_field_unknown.html">tests/sql/query/where_field_unknown</a> b/<a href="../file/tests/sql/query/where_field_unknown.html">tests/sql/query/where_field_unknown</a></b>
<a href="#h114-0" id="h114-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT * FROM movies WHERE unknown
 
<a href="#h114-0-2" id="h114-0-2" class="d">-Error: Unknown field unknown
</a><a href="#h114-0-3" id="h114-0-3" class="i">+Error: invalid input: unknown field unknown
</a> 
 AST: Select {
     select: [],
<a href="#h114-1" id="h114-1" class="h">@@ -23,4 +23,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h114-1-3" id="h114-1-3" class="d">-Plan: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h114-1-4" id="h114-1-4" class="d">-\ No newline at end of file
</a><a href="#h114-1-5" id="h114-1-5" class="i">+Plan: InvalidInput(&quot;unknown field unknown&quot;)
</a><a href="#h114-1-6" id="h114-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h115" href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a> b/<a href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a></b>
<a href="#h115-0" id="h115-0" class="h">@@ -3,4 +3,4 @@ Query: SELECT * FROM movies WHERE 3.14
</a> Explain:
 Scan: movies (3.14)
 
<a href="#h115-0-3" id="h115-0-3" class="d">- Value(&quot;Filter returned 3.14, expected boolean&quot;)
</a><a href="#h115-0-4" id="h115-0-4" class="d">-\ No newline at end of file
</a><a href="#h115-0-5" id="h115-0-5" class="i">+ InvalidData(&quot;filter returned 3.14, expected boolean&quot;)
</a><a href="#h115-0-6" id="h115-0-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h116" href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a> b/<a href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a></b>
<a href="#h116-0" id="h116-0" class="h">@@ -3,4 +3,4 @@ Query: SELECT * FROM movies WHERE 7
</a> Explain:
 Scan: movies (7)
 
<a href="#h116-0-3" id="h116-0-3" class="d">- Value(&quot;Filter returned 7, expected boolean&quot;)
</a><a href="#h116-0-4" id="h116-0-4" class="d">-\ No newline at end of file
</a><a href="#h116-0-5" id="h116-0-5" class="i">+ InvalidData(&quot;filter returned 7, expected boolean&quot;)
</a><a href="#h116-0-6" id="h116-0-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h117" href="../file/tests/sql/query/where_multi.html">tests/sql/query/where_multi</a> b/<a href="../file/tests/sql/query/where_multi.html">tests/sql/query/where_multi</a></b>
<a href="#h117-0" id="h117-0" class="h">@@ -1,5 +1,5 @@
</a> Query: SELECT * FROM movies WHERE TRUE, TRUE
 
<a href="#h117-0-2" id="h117-0-2" class="d">-Error: Unexpected token ,
</a><a href="#h117-0-3" id="h117-0-3" class="i">+Error: invalid input: unexpected token ,
</a> 
<a href="#h117-0-5" id="h117-0-5" class="d">-AST: Parse(&quot;Unexpected token ,&quot;)
</a><a href="#h117-0-6" id="h117-0-6" class="d">-\ No newline at end of file
</a><a href="#h117-0-7" id="h117-0-7" class="i">+AST: InvalidInput(&quot;unexpected token ,&quot;)
</a><a href="#h117-0-8" id="h117-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h118" href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a> b/<a href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a></b>
<a href="#h118-0" id="h118-0" class="h">@@ -3,4 +3,4 @@ Query: SELECT * FROM movies WHERE &#39;abc&#39;
</a> Explain:
 Scan: movies (abc)
 
<a href="#h118-0-3" id="h118-0-3" class="d">- Value(&quot;Filter returned abc, expected boolean&quot;)
</a><a href="#h118-0-4" id="h118-0-4" class="d">-\ No newline at end of file
</a><a href="#h118-0-5" id="h118-0-5" class="i">+ InvalidData(&quot;filter returned abc, expected boolean&quot;)
</a><a href="#h118-0-6" id="h118-0-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h119" href="../file/tests/sql/schema/create_table_bare.html">tests/sql/schema/create_table_bare</a> b/<a href="../file/tests/sql/schema/create_table_bare.html">tests/sql/schema/create_table_bare</a></b>
<a href="#h119-0" id="h119-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE
<a href="#h119-0-1" id="h119-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h119-0-2" id="h119-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h120" href="../file/tests/sql/schema/create_table_columns_empty.html">tests/sql/schema/create_table_columns_empty</a> b/<a href="../file/tests/sql/schema/create_table_columns_empty.html">tests/sql/schema/create_table_columns_empty</a></b>
<a href="#h120-0" id="h120-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name ()
<a href="#h120-0-1" id="h120-0-1" class="d">-Error: Parse(&quot;Expected identifier, got )&quot;)
</a><a href="#h120-0-2" id="h120-0-2" class="i">+Error: InvalidInput(&quot;expected identifier, got )&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h121" href="../file/tests/sql/schema/create_table_columns_missing.html">tests/sql/schema/create_table_columns_missing</a> b/<a href="../file/tests/sql/schema/create_table_columns_missing.html">tests/sql/schema/create_table_columns_missing</a></b>
<a href="#h121-0" id="h121-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name
<a href="#h121-0-1" id="h121-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h121-0-2" id="h121-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h122" href="../file/tests/sql/schema/create_table_datatype_missing.html">tests/sql/schema/create_table_datatype_missing</a> b/<a href="../file/tests/sql/schema/create_table_datatype_missing.html">tests/sql/schema/create_table_datatype_missing</a></b>
<a href="#h122-0" id="h122-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id)
<a href="#h122-0-1" id="h122-0-1" class="d">-Error: Parse(&quot;Unexpected token )&quot;)
</a><a href="#h122-0-2" id="h122-0-2" class="i">+Error: InvalidInput(&quot;unexpected token )&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h123" href="../file/tests/sql/schema/create_table_datatype_null.html">tests/sql/schema/create_table_datatype_null</a> b/<a href="../file/tests/sql/schema/create_table_datatype_null.html">tests/sql/schema/create_table_datatype_null</a></b>
<a href="#h123-0" id="h123-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value NULL)
<a href="#h123-0-1" id="h123-0-1" class="d">-Error: Parse(&quot;Unexpected token NULL&quot;)
</a><a href="#h123-0-2" id="h123-0-2" class="i">+Error: InvalidInput(&quot;unexpected token NULL&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h124" href="../file/tests/sql/schema/create_table_default_conflict.html">tests/sql/schema/create_table_default_conflict</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict.html">tests/sql/schema/create_table_default_conflict</a></b>
<a href="#h124-0" id="h124-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING DEFAULT 7)
<a href="#h124-0-1" id="h124-0-1" class="d">-Error: Value(&quot;Default value for column value has datatype INTEGER, must be STRING&quot;)
</a><a href="#h124-0-2" id="h124-0-2" class="i">+Error: InvalidInput(&quot;default value for column value has datatype INTEGER, must be STRING&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h125" href="../file/tests/sql/schema/create_table_default_conflict_float_integer.html">tests/sql/schema/create_table_default_conflict_float_integer</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict_float_integer.html">tests/sql/schema/create_table_default_conflict_float_integer</a></b>
<a href="#h125-0" id="h125-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value FLOAT DEFAULT 7)
<a href="#h125-0-1" id="h125-0-1" class="d">-Error: Value(&quot;Default value for column value has datatype INTEGER, must be FLOAT&quot;)
</a><a href="#h125-0-2" id="h125-0-2" class="i">+Error: InvalidInput(&quot;default value for column value has datatype INTEGER, must be FLOAT&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h126" href="../file/tests/sql/schema/create_table_default_conflict_integer_float.html">tests/sql/schema/create_table_default_conflict_integer_float</a> b/<a href="../file/tests/sql/schema/create_table_default_conflict_integer_float.html">tests/sql/schema/create_table_default_conflict_integer_float</a></b>
<a href="#h126-0" id="h126-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value INTEGER DEFAULT 3.14)
<a href="#h126-0-1" id="h126-0-1" class="d">-Error: Value(&quot;Default value for column value has datatype FLOAT, must be INTEGER&quot;)
</a><a href="#h126-0-2" id="h126-0-2" class="i">+Error: InvalidInput(&quot;default value for column value has datatype FLOAT, must be INTEGER&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h127" href="../file/tests/sql/schema/create_table_default_null_not.html">tests/sql/schema/create_table_default_null_not</a> b/<a href="../file/tests/sql/schema/create_table_default_null_not.html">tests/sql/schema/create_table_default_null_not</a></b>
<a href="#h127-0" id="h127-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NOT NULL DEFAULT NULL)
<a href="#h127-0-1" id="h127-0-1" class="d">-Error: Value(&quot;Can&#39;t use NULL as default value for non-nullable column value&quot;)
</a><a href="#h127-0-2" id="h127-0-2" class="i">+Error: InvalidInput(&quot;can&#39;t use NULL as default value for non-nullable column value&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h128" href="../file/tests/sql/schema/create_table_exists.html">tests/sql/schema/create_table_exists</a> b/<a href="../file/tests/sql/schema/create_table_exists.html">tests/sql/schema/create_table_exists</a></b>
<a href="#h128-0" id="h128-0" class="h">@@ -1,5 +1,5 @@
</a> Query: CREATE TABLE test (id INTEGER PRIMARY KEY)
<a href="#h128-0-1" id="h128-0-1" class="d">-Error: Value(&quot;Table test already exists&quot;)
</a><a href="#h128-0-2" id="h128-0-2" class="i">+Error: InvalidInput(&quot;table test already exists&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h129" href="../file/tests/sql/schema/create_table_name_emoji.html">tests/sql/schema/create_table_name_emoji</a> b/<a href="../file/tests/sql/schema/create_table_name_emoji.html">tests/sql/schema/create_table_name_emoji</a></b>
<a href="#h129-0" id="h129-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE 👋 (🆔 INTEGER PRIMARY KEY)
<a href="#h129-0-1" id="h129-0-1" class="d">-Error: Parse(&quot;Unexpected character 👋&quot;)
</a><a href="#h129-0-2" id="h129-0-2" class="i">+Error: InvalidInput(&quot;unexpected character 👋&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h130" href="../file/tests/sql/schema/create_table_name_keyword.html">tests/sql/schema/create_table_name_keyword</a> b/<a href="../file/tests/sql/schema/create_table_name_keyword.html">tests/sql/schema/create_table_name_keyword</a></b>
<a href="#h130-0" id="h130-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE table (id INTEGER PRIMARY KEY)
<a href="#h130-0-1" id="h130-0-1" class="d">-Error: Parse(&quot;Expected identifier, got TABLE&quot;)
</a><a href="#h130-0-2" id="h130-0-2" class="i">+Error: InvalidInput(&quot;expected identifier, got TABLE&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h131" href="../file/tests/sql/schema/create_table_name_missing.html">tests/sql/schema/create_table_name_missing</a> b/<a href="../file/tests/sql/schema/create_table_name_missing.html">tests/sql/schema/create_table_name_missing</a></b>
<a href="#h131-0" id="h131-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE (id INTEGER PRIMARY KEY)
<a href="#h131-0-1" id="h131-0-1" class="d">-Error: Parse(&quot;Expected identifier, got (&quot;)
</a><a href="#h131-0-2" id="h131-0-2" class="i">+Error: InvalidInput(&quot;expected identifier, got (&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h132" href="../file/tests/sql/schema/create_table_name_quote_double_unterminated.html">tests/sql/schema/create_table_name_quote_double_unterminated</a> b/<a href="../file/tests/sql/schema/create_table_name_quote_double_unterminated.html">tests/sql/schema/create_table_name_quote_double_unterminated</a></b>
<a href="#h132-0" id="h132-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE &quot;name (id INTEGER PRIMARY KEY)
<a href="#h132-0-1" id="h132-0-1" class="d">-Error: Parse(&quot;Unexpected end of quoted identifier&quot;)
</a><a href="#h132-0-2" id="h132-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of quoted identifier&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h133" href="../file/tests/sql/schema/create_table_name_quote_single.html">tests/sql/schema/create_table_name_quote_single</a> b/<a href="../file/tests/sql/schema/create_table_name_quote_single.html">tests/sql/schema/create_table_name_quote_single</a></b>
<a href="#h133-0" id="h133-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE &#39;name&#39; (id INTEGER PRIMARY KEY)
<a href="#h133-0-1" id="h133-0-1" class="d">-Error: Parse(&quot;Expected identifier, got name&quot;)
</a><a href="#h133-0-2" id="h133-0-2" class="i">+Error: InvalidInput(&quot;expected identifier, got name&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h134" href="../file/tests/sql/schema/create_table_name_underscore_prefix.html">tests/sql/schema/create_table_name_underscore_prefix</a> b/<a href="../file/tests/sql/schema/create_table_name_underscore_prefix.html">tests/sql/schema/create_table_name_underscore_prefix</a></b>
<a href="#h134-0" id="h134-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE _name (id INTEGER PRIMARY KEY)
<a href="#h134-0-1" id="h134-0-1" class="d">-Error: Parse(&quot;Unexpected character _&quot;)
</a><a href="#h134-0-2" id="h134-0-2" class="i">+Error: InvalidInput(&quot;unexpected character _&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h135" href="../file/tests/sql/schema/create_table_null_not_null.html">tests/sql/schema/create_table_null_not_null</a> b/<a href="../file/tests/sql/schema/create_table_null_not_null.html">tests/sql/schema/create_table_null_not_null</a></b>
<a href="#h135-0" id="h135-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, value STRING NULL NOT NULL)
<a href="#h135-0-1" id="h135-0-1" class="d">-Error: Value(&quot;Column value can&#39;t be both not nullable and nullable&quot;)
</a><a href="#h135-0-2" id="h135-0-2" class="i">+Error: InvalidInput(&quot;column value can&#39;t be both not nullable and nullable&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h136" href="../file/tests/sql/schema/create_table_pk_missing.html">tests/sql/schema/create_table_pk_missing</a> b/<a href="../file/tests/sql/schema/create_table_pk_missing.html">tests/sql/schema/create_table_pk_missing</a></b>
<a href="#h136-0" id="h136-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER)
<a href="#h136-0-1" id="h136-0-1" class="d">-Error: Value(&quot;No primary key in table name&quot;)
</a><a href="#h136-0-2" id="h136-0-2" class="i">+Error: InvalidInput(&quot;no primary key in table name&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h137" href="../file/tests/sql/schema/create_table_pk_multiple.html">tests/sql/schema/create_table_pk_multiple</a> b/<a href="../file/tests/sql/schema/create_table_pk_multiple.html">tests/sql/schema/create_table_pk_multiple</a></b>
<a href="#h137-0" id="h137-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY, name STRING PRIMARY KEY)
<a href="#h137-0-1" id="h137-0-1" class="d">-Error: Value(&quot;Multiple primary keys in table name&quot;)
</a><a href="#h137-0-2" id="h137-0-2" class="i">+Error: InvalidInput(&quot;multiple primary keys in table name&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h138" href="../file/tests/sql/schema/create_table_pk_nullable.html">tests/sql/schema/create_table_pk_nullable</a> b/<a href="../file/tests/sql/schema/create_table_pk_nullable.html">tests/sql/schema/create_table_pk_nullable</a></b>
<a href="#h138-0" id="h138-0" class="h">@@ -1,4 +1,4 @@
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY NULL)
<a href="#h138-0-1" id="h138-0-1" class="d">-Error: Value(&quot;Primary key id cannot be nullable&quot;)
</a><a href="#h138-0-2" id="h138-0-2" class="i">+Error: InvalidInput(&quot;primary key id cannot be nullable&quot;)
</a> 
 Storage:
 \ No newline at end of file
<b>diff --git a/<a id="h139" href="../file/tests/sql/schema/create_table_ref_missing.html">tests/sql/schema/create_table_ref_missing</a> b/<a href="../file/tests/sql/schema/create_table_ref_missing.html">tests/sql/schema/create_table_ref_missing</a></b>
<a href="#h139-0" id="h139-0" class="h">@@ -1,5 +1,5 @@
</a> Query: CREATE TABLE other (id INTEGER PRIMARY KEY, missing_id INTEGER REFERENCES missing)
<a href="#h139-0-1" id="h139-0-1" class="d">-Error: Value(&quot;Table missing referenced by column missing_id does not exist&quot;)
</a><a href="#h139-0-2" id="h139-0-2" class="i">+Error: InvalidInput(&quot;table missing referenced by column missing_id does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h140" href="../file/tests/sql/schema/create_table_ref_self_type.html">tests/sql/schema/create_table_ref_self_type</a> b/<a href="../file/tests/sql/schema/create_table_ref_self_type.html">tests/sql/schema/create_table_ref_self_type</a></b>
<a href="#h140-0" id="h140-0" class="h">@@ -1,5 +1,5 @@
</a> Query: CREATE TABLE other (id INTEGER PRIMARY KEY, self_id STRING REFERENCES other)
<a href="#h140-0-1" id="h140-0-1" class="d">-Error: Value(&quot;Can&#39;t reference INTEGER primary key of table other from STRING column self_id&quot;)
</a><a href="#h140-0-2" id="h140-0-2" class="i">+Error: InvalidInput(&quot;can&#39;t reference INTEGER primary key of table other from STRING column self_id&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h141" href="../file/tests/sql/schema/create_table_ref_type.html">tests/sql/schema/create_table_ref_type</a> b/<a href="../file/tests/sql/schema/create_table_ref_type.html">tests/sql/schema/create_table_ref_type</a></b>
<a href="#h141-0" id="h141-0" class="h">@@ -1,5 +1,5 @@
</a> Query: CREATE TABLE other (id INTEGER PRIMARY KEY, test_id STRING REFERENCES test)
<a href="#h141-0-1" id="h141-0-1" class="d">-Error: Value(&quot;Can&#39;t reference INTEGER primary key of table test from STRING column test_id&quot;)
</a><a href="#h141-0-2" id="h141-0-2" class="i">+Error: InvalidInput(&quot;can&#39;t reference INTEGER primary key of table test from STRING column test_id&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h142" href="../file/tests/sql/schema/delete_ref_conflict.html">tests/sql/schema/delete_ref_conflict</a> b/<a href="../file/tests/sql/schema/delete_ref_conflict.html">tests/sql/schema/delete_ref_conflict</a></b>
<a href="#h142-0" id="h142-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM target WHERE id = 1
<a href="#h142-0-1" id="h142-0-1" class="d">-Error: Value(&quot;Primary key 1 is referenced by table source column target_id&quot;)
</a><a href="#h142-0-2" id="h142-0-2" class="i">+Error: InvalidInput(&quot;primary key 1 referenced by table source column target_id&quot;)
</a> 
 Storage:
 CREATE TABLE source (
<b>diff --git a/<a id="h143" href="../file/tests/sql/schema/delete_ref_self_all.html">tests/sql/schema/delete_ref_self_all</a> b/<a href="../file/tests/sql/schema/delete_ref_self_all.html">tests/sql/schema/delete_ref_self_all</a></b>
<a href="#h143-0" id="h143-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM self
<a href="#h143-0-1" id="h143-0-1" class="d">-Error: Value(&quot;Primary key 1 is referenced by table self column self_id&quot;)
</a><a href="#h143-0-2" id="h143-0-2" class="i">+Error: InvalidInput(&quot;primary key 1 referenced by table self column self_id&quot;)
</a> 
 Storage:
 CREATE TABLE self (
<b>diff --git a/<a id="h144" href="../file/tests/sql/schema/delete_ref_self_conflict.html">tests/sql/schema/delete_ref_self_conflict</a> b/<a href="../file/tests/sql/schema/delete_ref_self_conflict.html">tests/sql/schema/delete_ref_self_conflict</a></b>
<a href="#h144-0" id="h144-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DELETE FROM self WHERE id = 1
<a href="#h144-0-1" id="h144-0-1" class="d">-Error: Value(&quot;Primary key 1 is referenced by table self column self_id&quot;)
</a><a href="#h144-0-2" id="h144-0-2" class="i">+Error: InvalidInput(&quot;primary key 1 referenced by table self column self_id&quot;)
</a> 
 Storage:
 CREATE TABLE self (
<b>diff --git a/<a id="h145" href="../file/tests/sql/schema/drop_table_bare.html">tests/sql/schema/drop_table_bare</a> b/<a href="../file/tests/sql/schema/drop_table_bare.html">tests/sql/schema/drop_table_bare</a></b>
<a href="#h145-0" id="h145-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DROP TABLE
<a href="#h145-0-1" id="h145-0-1" class="d">-Error: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h145-0-2" id="h145-0-2" class="i">+Error: InvalidInput(&quot;unexpected end of input&quot;)
</a> 
 Storage:
 CREATE TABLE a (
<b>diff --git a/<a id="h146" href="../file/tests/sql/schema/drop_table_missing.html">tests/sql/schema/drop_table_missing</a> b/<a href="../file/tests/sql/schema/drop_table_missing.html">tests/sql/schema/drop_table_missing</a></b>
<a href="#h146-0" id="h146-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DROP TABLE name
<a href="#h146-0-1" id="h146-0-1" class="d">-Error: Value(&quot;Table name does not exist&quot;)
</a><a href="#h146-0-2" id="h146-0-2" class="i">+Error: InvalidInput(&quot;table name does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE a (
<b>diff --git a/<a id="h147" href="../file/tests/sql/schema/drop_table_multiple.html">tests/sql/schema/drop_table_multiple</a> b/<a href="../file/tests/sql/schema/drop_table_multiple.html">tests/sql/schema/drop_table_multiple</a></b>
<a href="#h147-0" id="h147-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DROP TABLE a, c
<a href="#h147-0-1" id="h147-0-1" class="d">-Error: Parse(&quot;Unexpected token ,&quot;)
</a><a href="#h147-0-2" id="h147-0-2" class="i">+Error: InvalidInput(&quot;unexpected token ,&quot;)
</a> 
 Storage:
 CREATE TABLE a (
<b>diff --git a/<a id="h148" href="../file/tests/sql/schema/drop_table_ref_target.html">tests/sql/schema/drop_table_ref_target</a> b/<a href="../file/tests/sql/schema/drop_table_ref_target.html">tests/sql/schema/drop_table_ref_target</a></b>
<a href="#h148-0" id="h148-0" class="h">@@ -1,5 +1,5 @@
</a> Query: DROP TABLE target
<a href="#h148-0-1" id="h148-0-1" class="d">-Error: Value(&quot;Table target is referenced by table source column target_id&quot;)
</a><a href="#h148-0-2" id="h148-0-2" class="i">+Error: InvalidInput(&quot;table target is referenced by table source column target_id&quot;)
</a> 
 Storage:
 CREATE TABLE self (
<b>diff --git a/<a id="h149" href="../file/tests/sql/schema/insert_boolean_float.html">tests/sql/schema/insert_boolean_float</a> b/<a href="../file/tests/sql/schema/insert_boolean_float.html">tests/sql/schema/insert_boolean_float</a></b>
<a href="#h149-0" id="h149-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;boolean&quot;) VALUES (0, 3.14)
<a href="#h149-0-1" id="h149-0-1" class="d">-Error: Value(&quot;Invalid datatype FLOAT for BOOLEAN column boolean&quot;)
</a><a href="#h149-0-2" id="h149-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype FLOAT for BOOLEAN column boolean&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h150" href="../file/tests/sql/schema/insert_boolean_integer.html">tests/sql/schema/insert_boolean_integer</a> b/<a href="../file/tests/sql/schema/insert_boolean_integer.html">tests/sql/schema/insert_boolean_integer</a></b>
<a href="#h150-0" id="h150-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;boolean&quot;) VALUES (0, 1)
<a href="#h150-0-1" id="h150-0-1" class="d">-Error: Value(&quot;Invalid datatype INTEGER for BOOLEAN column boolean&quot;)
</a><a href="#h150-0-2" id="h150-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype INTEGER for BOOLEAN column boolean&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h151" href="../file/tests/sql/schema/insert_boolean_string.html">tests/sql/schema/insert_boolean_string</a> b/<a href="../file/tests/sql/schema/insert_boolean_string.html">tests/sql/schema/insert_boolean_string</a></b>
<a href="#h151-0" id="h151-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;boolean&quot;) VALUES (0, &#39;abc&#39;)
<a href="#h151-0-1" id="h151-0-1" class="d">-Error: Value(&quot;Invalid datatype STRING for BOOLEAN column boolean&quot;)
</a><a href="#h151-0-2" id="h151-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype STRING for BOOLEAN column boolean&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h152" href="../file/tests/sql/schema/insert_boolean_string_empty.html">tests/sql/schema/insert_boolean_string_empty</a> b/<a href="../file/tests/sql/schema/insert_boolean_string_empty.html">tests/sql/schema/insert_boolean_string_empty</a></b>
<a href="#h152-0" id="h152-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;boolean&quot;) VALUES (0, &#39;&#39;)
<a href="#h152-0-1" id="h152-0-1" class="d">-Error: Value(&quot;Invalid datatype STRING for BOOLEAN column boolean&quot;)
</a><a href="#h152-0-2" id="h152-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype STRING for BOOLEAN column boolean&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h153" href="../file/tests/sql/schema/insert_default_missing.html">tests/sql/schema/insert_default_missing</a> b/<a href="../file/tests/sql/schema/insert_default_missing.html">tests/sql/schema/insert_default_missing</a></b>
<a href="#h153-0" id="h153-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO defaults (id) VALUES (1)
<a href="#h153-0-1" id="h153-0-1" class="d">-Error: Value(&quot;No value given for column required&quot;)
</a><a href="#h153-0-2" id="h153-0-2" class="i">+Error: InvalidInput(&quot;no value given for column required&quot;)
</a> 
 Storage:
 CREATE TABLE defaults (
<b>diff --git a/<a id="h154" href="../file/tests/sql/schema/insert_float_boolean.html">tests/sql/schema/insert_float_boolean</a> b/<a href="../file/tests/sql/schema/insert_float_boolean.html">tests/sql/schema/insert_float_boolean</a></b>
<a href="#h154-0" id="h154-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;float&quot;) VALUES (0, FALSE)
<a href="#h154-0-1" id="h154-0-1" class="d">-Error: Value(&quot;Invalid datatype BOOLEAN for FLOAT column float&quot;)
</a><a href="#h154-0-2" id="h154-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype BOOLEAN for FLOAT column float&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h155" href="../file/tests/sql/schema/insert_float_integer.html">tests/sql/schema/insert_float_integer</a> b/<a href="../file/tests/sql/schema/insert_float_integer.html">tests/sql/schema/insert_float_integer</a></b>
<a href="#h155-0" id="h155-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;float&quot;) VALUES (0, 1)
<a href="#h155-0-1" id="h155-0-1" class="d">-Error: Value(&quot;Invalid datatype INTEGER for FLOAT column float&quot;)
</a><a href="#h155-0-2" id="h155-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype INTEGER for FLOAT column float&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h156" href="../file/tests/sql/schema/insert_float_string.html">tests/sql/schema/insert_float_string</a> b/<a href="../file/tests/sql/schema/insert_float_string.html">tests/sql/schema/insert_float_string</a></b>
<a href="#h156-0" id="h156-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;float&quot;) VALUES (0, &#39;a&#39;)
<a href="#h156-0-1" id="h156-0-1" class="d">-Error: Value(&quot;Invalid datatype STRING for FLOAT column float&quot;)
</a><a href="#h156-0-2" id="h156-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype STRING for FLOAT column float&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h157" href="../file/tests/sql/schema/insert_float_string_empty.html">tests/sql/schema/insert_float_string_empty</a> b/<a href="../file/tests/sql/schema/insert_float_string_empty.html">tests/sql/schema/insert_float_string_empty</a></b>
<a href="#h157-0" id="h157-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;float&quot;) VALUES (0, &#39;&#39;)
<a href="#h157-0-1" id="h157-0-1" class="d">-Error: Value(&quot;Invalid datatype STRING for FLOAT column float&quot;)
</a><a href="#h157-0-2" id="h157-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype STRING for FLOAT column float&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h158" href="../file/tests/sql/schema/insert_integer_boolean.html">tests/sql/schema/insert_integer_boolean</a> b/<a href="../file/tests/sql/schema/insert_integer_boolean.html">tests/sql/schema/insert_integer_boolean</a></b>
<a href="#h158-0" id="h158-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;integer&quot;) VALUES (0, FALSE)
<a href="#h158-0-1" id="h158-0-1" class="d">-Error: Value(&quot;Invalid datatype BOOLEAN for INTEGER column integer&quot;)
</a><a href="#h158-0-2" id="h158-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype BOOLEAN for INTEGER column integer&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h159" href="../file/tests/sql/schema/insert_integer_float.html">tests/sql/schema/insert_integer_float</a> b/<a href="../file/tests/sql/schema/insert_integer_float.html">tests/sql/schema/insert_integer_float</a></b>
<a href="#h159-0" id="h159-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;integer&quot;) VALUES (0, 1.0)
<a href="#h159-0-1" id="h159-0-1" class="d">-Error: Value(&quot;Invalid datatype FLOAT for INTEGER column integer&quot;)
</a><a href="#h159-0-2" id="h159-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype FLOAT for INTEGER column integer&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h160" href="../file/tests/sql/schema/insert_integer_float_infinity.html">tests/sql/schema/insert_integer_float_infinity</a> b/<a href="../file/tests/sql/schema/insert_integer_float_infinity.html">tests/sql/schema/insert_integer_float_infinity</a></b>
<a href="#h160-0" id="h160-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;integer&quot;) VALUES (0, INFINITY)
<a href="#h160-0-1" id="h160-0-1" class="d">-Error: Value(&quot;Invalid datatype FLOAT for INTEGER column integer&quot;)
</a><a href="#h160-0-2" id="h160-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype FLOAT for INTEGER column integer&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h161" href="../file/tests/sql/schema/insert_integer_float_nan.html">tests/sql/schema/insert_integer_float_nan</a> b/<a href="../file/tests/sql/schema/insert_integer_float_nan.html">tests/sql/schema/insert_integer_float_nan</a></b>
<a href="#h161-0" id="h161-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;integer&quot;) VALUES (0, NAN)
<a href="#h161-0-1" id="h161-0-1" class="d">-Error: Value(&quot;Invalid datatype FLOAT for INTEGER column integer&quot;)
</a><a href="#h161-0-2" id="h161-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype FLOAT for INTEGER column integer&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h162" href="../file/tests/sql/schema/insert_integer_string.html">tests/sql/schema/insert_integer_string</a> b/<a href="../file/tests/sql/schema/insert_integer_string.html">tests/sql/schema/insert_integer_string</a></b>
<a href="#h162-0" id="h162-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;integer&quot;) VALUES (0, &#39;a&#39;)
<a href="#h162-0-1" id="h162-0-1" class="d">-Error: Value(&quot;Invalid datatype STRING for INTEGER column integer&quot;)
</a><a href="#h162-0-2" id="h162-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype STRING for INTEGER column integer&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h163" href="../file/tests/sql/schema/insert_integer_string_empty.html">tests/sql/schema/insert_integer_string_empty</a> b/<a href="../file/tests/sql/schema/insert_integer_string_empty.html">tests/sql/schema/insert_integer_string_empty</a></b>
<a href="#h163-0" id="h163-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;integer&quot;) VALUES (0, &#39;&#39;)
<a href="#h163-0-1" id="h163-0-1" class="d">-Error: Value(&quot;Invalid datatype STRING for INTEGER column integer&quot;)
</a><a href="#h163-0-2" id="h163-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype STRING for INTEGER column integer&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h164" href="../file/tests/sql/schema/insert_nulls_required.html">tests/sql/schema/insert_nulls_required</a> b/<a href="../file/tests/sql/schema/insert_nulls_required.html">tests/sql/schema/insert_nulls_required</a></b>
<a href="#h164-0" id="h164-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO nulls (id, &quot;null&quot;, not_null, &quot;default&quot;) VALUES (1, NULL, NULL, NULL)
<a href="#h164-0-1" id="h164-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column not_null&quot;)
</a><a href="#h164-0-2" id="h164-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column not_null&quot;)
</a> 
 Storage:
 CREATE TABLE nulls (
<b>diff --git a/<a id="h165" href="../file/tests/sql/schema/insert_pk_boolean_conflict.html">tests/sql/schema/insert_pk_boolean_conflict</a> b/<a href="../file/tests/sql/schema/insert_pk_boolean_conflict.html">tests/sql/schema/insert_pk_boolean_conflict</a></b>
<a href="#h165-0" id="h165-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;boolean&quot; VALUES (FALSE)
<a href="#h165-0-1" id="h165-0-1" class="d">-Error: Value(&quot;Primary key FALSE already exists for table boolean&quot;)
</a><a href="#h165-0-2" id="h165-0-2" class="i">+Error: InvalidInput(&quot;primary key FALSE already exists for table boolean&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;boolean&quot; (
<b>diff --git a/<a id="h166" href="../file/tests/sql/schema/insert_pk_boolean_null.html">tests/sql/schema/insert_pk_boolean_null</a> b/<a href="../file/tests/sql/schema/insert_pk_boolean_null.html">tests/sql/schema/insert_pk_boolean_null</a></b>
<a href="#h166-0" id="h166-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;boolean&quot; VALUES (NULL)
<a href="#h166-0-1" id="h166-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column pk&quot;)
</a><a href="#h166-0-2" id="h166-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column pk&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;boolean&quot; (
<b>diff --git a/<a id="h167" href="../file/tests/sql/schema/insert_pk_float_conflict.html">tests/sql/schema/insert_pk_float_conflict</a> b/<a href="../file/tests/sql/schema/insert_pk_float_conflict.html">tests/sql/schema/insert_pk_float_conflict</a></b>
<a href="#h167-0" id="h167-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;float&quot; VALUES (3.14)
<a href="#h167-0-1" id="h167-0-1" class="d">-Error: Value(&quot;Primary key 3.14 already exists for table float&quot;)
</a><a href="#h167-0-2" id="h167-0-2" class="i">+Error: InvalidInput(&quot;primary key 3.14 already exists for table float&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;float&quot; (
<b>diff --git a/<a id="h168" href="../file/tests/sql/schema/insert_pk_float_infinity.html">tests/sql/schema/insert_pk_float_infinity</a> b/<a href="../file/tests/sql/schema/insert_pk_float_infinity.html">tests/sql/schema/insert_pk_float_infinity</a></b>
<a href="#h168-0" id="h168-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;float&quot; VALUES (INFINITY)
<a href="#h168-0-1" id="h168-0-1" class="d">-Error: Value(&quot;Primary key inf already exists for table float&quot;)
</a><a href="#h168-0-2" id="h168-0-2" class="i">+Error: InvalidInput(&quot;primary key inf already exists for table float&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;float&quot; (
<b>diff --git a/<a id="h169" href="../file/tests/sql/schema/insert_pk_float_nan.html">tests/sql/schema/insert_pk_float_nan</a> b/<a href="../file/tests/sql/schema/insert_pk_float_nan.html">tests/sql/schema/insert_pk_float_nan</a></b>
<a href="#h169-0" id="h169-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;float&quot; VALUES (NAN)
<a href="#h169-0-1" id="h169-0-1" class="d">-Error: Value(&quot;Primary key NaN already exists for table float&quot;)
</a><a href="#h169-0-2" id="h169-0-2" class="i">+Error: InvalidInput(&quot;primary key NaN already exists for table float&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;float&quot; (
<b>diff --git a/<a id="h170" href="../file/tests/sql/schema/insert_pk_float_null.html">tests/sql/schema/insert_pk_float_null</a> b/<a href="../file/tests/sql/schema/insert_pk_float_null.html">tests/sql/schema/insert_pk_float_null</a></b>
<a href="#h170-0" id="h170-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;float&quot; VALUES (NULL)
<a href="#h170-0-1" id="h170-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column pk&quot;)
</a><a href="#h170-0-2" id="h170-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column pk&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;float&quot; (
<b>diff --git a/<a id="h171" href="../file/tests/sql/schema/insert_pk_integer_conflict.html">tests/sql/schema/insert_pk_integer_conflict</a> b/<a href="../file/tests/sql/schema/insert_pk_integer_conflict.html">tests/sql/schema/insert_pk_integer_conflict</a></b>
<a href="#h171-0" id="h171-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;integer&quot; VALUES (1)
<a href="#h171-0-1" id="h171-0-1" class="d">-Error: Value(&quot;Primary key 1 already exists for table integer&quot;)
</a><a href="#h171-0-2" id="h171-0-2" class="i">+Error: InvalidInput(&quot;primary key 1 already exists for table integer&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;integer&quot; (
<b>diff --git a/<a id="h172" href="../file/tests/sql/schema/insert_pk_integer_null.html">tests/sql/schema/insert_pk_integer_null</a> b/<a href="../file/tests/sql/schema/insert_pk_integer_null.html">tests/sql/schema/insert_pk_integer_null</a></b>
<a href="#h172-0" id="h172-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;integer&quot; VALUES (NULL)
<a href="#h172-0-1" id="h172-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column pk&quot;)
</a><a href="#h172-0-2" id="h172-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column pk&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;integer&quot; (
<b>diff --git a/<a id="h173" href="../file/tests/sql/schema/insert_pk_string_conflict.html">tests/sql/schema/insert_pk_string_conflict</a> b/<a href="../file/tests/sql/schema/insert_pk_string_conflict.html">tests/sql/schema/insert_pk_string_conflict</a></b>
<a href="#h173-0" id="h173-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;string&quot; VALUES (&#39;foo&#39;)
<a href="#h173-0-1" id="h173-0-1" class="d">-Error: Value(&quot;Primary key foo already exists for table string&quot;)
</a><a href="#h173-0-2" id="h173-0-2" class="i">+Error: InvalidInput(&quot;primary key foo already exists for table string&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;string&quot; (
<b>diff --git a/<a id="h174" href="../file/tests/sql/schema/insert_pk_string_null.html">tests/sql/schema/insert_pk_string_null</a> b/<a href="../file/tests/sql/schema/insert_pk_string_null.html">tests/sql/schema/insert_pk_string_null</a></b>
<a href="#h174-0" id="h174-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;string&quot; VALUES (NULL)
<a href="#h174-0-1" id="h174-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column pk&quot;)
</a><a href="#h174-0-2" id="h174-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column pk&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;string&quot; (
<b>diff --git a/<a id="h175" href="../file/tests/sql/schema/insert_ref_boolean_missing.html">tests/sql/schema/insert_ref_boolean_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_boolean_missing.html">tests/sql/schema/insert_ref_boolean_missing</a></b>
<a href="#h175-0" id="h175-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO source VALUES (1, FALSE)
<a href="#h175-0-1" id="h175-0-1" class="d">-Error: Value(&quot;Referenced primary key FALSE in table target does not exist&quot;)
</a><a href="#h175-0-2" id="h175-0-2" class="i">+Error: InvalidInput(&quot;referenced primary key FALSE in table target does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE source (
<b>diff --git a/<a id="h176" href="../file/tests/sql/schema/insert_ref_float_missing.html">tests/sql/schema/insert_ref_float_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_float_missing.html">tests/sql/schema/insert_ref_float_missing</a></b>
<a href="#h176-0" id="h176-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO source VALUES (1, 1.618)
<a href="#h176-0-1" id="h176-0-1" class="d">-Error: Value(&quot;Referenced primary key 1.618 in table target does not exist&quot;)
</a><a href="#h176-0-2" id="h176-0-2" class="i">+Error: InvalidInput(&quot;referenced primary key 1.618 in table target does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE source (
<b>diff --git a/<a id="h177" href="../file/tests/sql/schema/insert_ref_integer_missing.html">tests/sql/schema/insert_ref_integer_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_integer_missing.html">tests/sql/schema/insert_ref_integer_missing</a></b>
<a href="#h177-0" id="h177-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO source VALUES (1, 7)
<a href="#h177-0-1" id="h177-0-1" class="d">-Error: Value(&quot;Referenced primary key 7 in table target does not exist&quot;)
</a><a href="#h177-0-2" id="h177-0-2" class="i">+Error: InvalidInput(&quot;referenced primary key 7 in table target does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE source (
<b>diff --git a/<a id="h178" href="../file/tests/sql/schema/insert_ref_self_missing.html">tests/sql/schema/insert_ref_self_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_self_missing.html">tests/sql/schema/insert_ref_self_missing</a></b>
<a href="#h178-0" id="h178-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO self VALUES (5, 9, &#39;e&#39;)
<a href="#h178-0-1" id="h178-0-1" class="d">-Error: Value(&quot;Referenced primary key 9 in table self does not exist&quot;)
</a><a href="#h178-0-2" id="h178-0-2" class="i">+Error: InvalidInput(&quot;referenced primary key 9 in table self does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE self (
<b>diff --git a/<a id="h179" href="../file/tests/sql/schema/insert_ref_string_case.html">tests/sql/schema/insert_ref_string_case</a> b/<a href="../file/tests/sql/schema/insert_ref_string_case.html">tests/sql/schema/insert_ref_string_case</a></b>
<a href="#h179-0" id="h179-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO source VALUES (1, &#39;Foo&#39;)
<a href="#h179-0-1" id="h179-0-1" class="d">-Error: Value(&quot;Referenced primary key Foo in table target does not exist&quot;)
</a><a href="#h179-0-2" id="h179-0-2" class="i">+Error: InvalidInput(&quot;referenced primary key Foo in table target does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE source (
<b>diff --git a/<a id="h180" href="../file/tests/sql/schema/insert_ref_string_missing.html">tests/sql/schema/insert_ref_string_missing</a> b/<a href="../file/tests/sql/schema/insert_ref_string_missing.html">tests/sql/schema/insert_ref_string_missing</a></b>
<a href="#h180-0" id="h180-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO source VALUES (1, &#39;baz&#39;)
<a href="#h180-0-1" id="h180-0-1" class="d">-Error: Value(&quot;Referenced primary key baz in table target does not exist&quot;)
</a><a href="#h180-0-2" id="h180-0-2" class="i">+Error: InvalidInput(&quot;referenced primary key baz in table target does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE source (
<b>diff --git a/<a id="h181" href="../file/tests/sql/schema/insert_string_1025.html">tests/sql/schema/insert_string_1025</a> b/<a href="../file/tests/sql/schema/insert_string_1025.html">tests/sql/schema/insert_string_1025</a></b>
<a href="#h181-0" id="h181-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;string&quot;) VALUES (0, &#39;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#39;)
<a href="#h181-0-1" id="h181-0-1" class="d">-Error: Value(&quot;Strings cannot be more than 1024 bytes&quot;)
</a><a href="#h181-0-2" id="h181-0-2" class="i">+Error: InvalidInput(&quot;strings cannot be more than 1024 bytes&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h182" href="../file/tests/sql/schema/insert_string_1025_unicode.html">tests/sql/schema/insert_string_1025_unicode</a> b/<a href="../file/tests/sql/schema/insert_string_1025_unicode.html">tests/sql/schema/insert_string_1025_unicode</a></b>
<a href="#h182-0" id="h182-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;string&quot;) VALUES (0, &#39;𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈𐍈x&#39;)
<a href="#h182-0-1" id="h182-0-1" class="d">-Error: Value(&quot;Strings cannot be more than 1024 bytes&quot;)
</a><a href="#h182-0-2" id="h182-0-2" class="i">+Error: InvalidInput(&quot;strings cannot be more than 1024 bytes&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h183" href="../file/tests/sql/schema/insert_string_boolean.html">tests/sql/schema/insert_string_boolean</a> b/<a href="../file/tests/sql/schema/insert_string_boolean.html">tests/sql/schema/insert_string_boolean</a></b>
<a href="#h183-0" id="h183-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;string&quot;) VALUES (0, FALSE)
<a href="#h183-0-1" id="h183-0-1" class="d">-Error: Value(&quot;Invalid datatype BOOLEAN for STRING column string&quot;)
</a><a href="#h183-0-2" id="h183-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype BOOLEAN for STRING column string&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h184" href="../file/tests/sql/schema/insert_string_float.html">tests/sql/schema/insert_string_float</a> b/<a href="../file/tests/sql/schema/insert_string_float.html">tests/sql/schema/insert_string_float</a></b>
<a href="#h184-0" id="h184-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;string&quot;) VALUES (0, 3.14)
<a href="#h184-0-1" id="h184-0-1" class="d">-Error: Value(&quot;Invalid datatype FLOAT for STRING column string&quot;)
</a><a href="#h184-0-2" id="h184-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype FLOAT for STRING column string&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h185" href="../file/tests/sql/schema/insert_string_integer.html">tests/sql/schema/insert_string_integer</a> b/<a href="../file/tests/sql/schema/insert_string_integer.html">tests/sql/schema/insert_string_integer</a></b>
<a href="#h185-0" id="h185-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO types (id, &quot;string&quot;) VALUES (0, 1)
<a href="#h185-0-1" id="h185-0-1" class="d">-Error: Value(&quot;Invalid datatype INTEGER for STRING column string&quot;)
</a><a href="#h185-0-2" id="h185-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype INTEGER for STRING column string&quot;)
</a> 
 Storage:
 CREATE TABLE types (
<b>diff --git a/<a id="h186" href="../file/tests/sql/schema/insert_unique_boolean_duplicate.html">tests/sql/schema/insert_unique_boolean_duplicate</a> b/<a href="../file/tests/sql/schema/insert_unique_boolean_duplicate.html">tests/sql/schema/insert_unique_boolean_duplicate</a></b>
<a href="#h186-0" id="h186-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;unique&quot; (id, &quot;boolean&quot;) VALUES (2, TRUE)
<a href="#h186-0-1" id="h186-0-1" class="d">-Error: Value(&quot;Unique value TRUE already exists for column boolean&quot;)
</a><a href="#h186-0-2" id="h186-0-2" class="i">+Error: InvalidInput(&quot;unique value TRUE already exists for column boolean&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;unique&quot; (
<b>diff --git a/<a id="h187" href="../file/tests/sql/schema/insert_unique_float_duplicate.html">tests/sql/schema/insert_unique_float_duplicate</a> b/<a href="../file/tests/sql/schema/insert_unique_float_duplicate.html">tests/sql/schema/insert_unique_float_duplicate</a></b>
<a href="#h187-0" id="h187-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;unique&quot; (id, &quot;float&quot;) VALUES (2, 3.14)
<a href="#h187-0-1" id="h187-0-1" class="d">-Error: Value(&quot;Unique value 3.14 already exists for column float&quot;)
</a><a href="#h187-0-2" id="h187-0-2" class="i">+Error: InvalidInput(&quot;unique value 3.14 already exists for column float&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;unique&quot; (
<b>diff --git a/<a id="h188" href="../file/tests/sql/schema/insert_unique_integer_duplicate.html">tests/sql/schema/insert_unique_integer_duplicate</a> b/<a href="../file/tests/sql/schema/insert_unique_integer_duplicate.html">tests/sql/schema/insert_unique_integer_duplicate</a></b>
<a href="#h188-0" id="h188-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;unique&quot; (id, &quot;integer&quot;) VALUES (2, 7)
<a href="#h188-0-1" id="h188-0-1" class="d">-Error: Value(&quot;Unique value 7 already exists for column integer&quot;)
</a><a href="#h188-0-2" id="h188-0-2" class="i">+Error: InvalidInput(&quot;unique value 7 already exists for column integer&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;unique&quot; (
<b>diff --git a/<a id="h189" href="../file/tests/sql/schema/insert_unique_string_duplicate.html">tests/sql/schema/insert_unique_string_duplicate</a> b/<a href="../file/tests/sql/schema/insert_unique_string_duplicate.html">tests/sql/schema/insert_unique_string_duplicate</a></b>
<a href="#h189-0" id="h189-0" class="h">@@ -1,5 +1,5 @@
</a> Query: INSERT INTO &quot;unique&quot; (id, &quot;string&quot;) VALUES (2, &#39;foo&#39;)
<a href="#h189-0-1" id="h189-0-1" class="d">-Error: Value(&quot;Unique value foo already exists for column string&quot;)
</a><a href="#h189-0-2" id="h189-0-2" class="i">+Error: InvalidInput(&quot;unique value foo already exists for column string&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;unique&quot; (
<b>diff --git a/<a id="h190" href="../file/tests/sql/schema/update_integer_conflict.html">tests/sql/schema/update_integer_conflict</a> b/<a href="../file/tests/sql/schema/update_integer_conflict.html">tests/sql/schema/update_integer_conflict</a></b>
<a href="#h190-0" id="h190-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET value = &#39;abc&#39;
<a href="#h190-0-1" id="h190-0-1" class="d">-Error: Value(&quot;Invalid datatype STRING for INTEGER column value&quot;)
</a><a href="#h190-0-2" id="h190-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype STRING for INTEGER column value&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h191" href="../file/tests/sql/schema/update_integer_float.html">tests/sql/schema/update_integer_float</a> b/<a href="../file/tests/sql/schema/update_integer_float.html">tests/sql/schema/update_integer_float</a></b>
<a href="#h191-0" id="h191-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE test SET value = 3.14
<a href="#h191-0-1" id="h191-0-1" class="d">-Error: Value(&quot;Invalid datatype FLOAT for INTEGER column value&quot;)
</a><a href="#h191-0-2" id="h191-0-2" class="i">+Error: InvalidInput(&quot;invalid datatype FLOAT for INTEGER column value&quot;)
</a> 
 Storage:
 CREATE TABLE test (
<b>diff --git a/<a id="h192" href="../file/tests/sql/schema/update_pk_boolean_null.html">tests/sql/schema/update_pk_boolean_null</a> b/<a href="../file/tests/sql/schema/update_pk_boolean_null.html">tests/sql/schema/update_pk_boolean_null</a></b>
<a href="#h192-0" id="h192-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;boolean&quot; SET pk = NULL WHERE pk = FALSE
<a href="#h192-0-1" id="h192-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column pk&quot;)
</a><a href="#h192-0-2" id="h192-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column pk&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;boolean&quot; (
<b>diff --git a/<a id="h193" href="../file/tests/sql/schema/update_pk_float_conflict.html">tests/sql/schema/update_pk_float_conflict</a> b/<a href="../file/tests/sql/schema/update_pk_float_conflict.html">tests/sql/schema/update_pk_float_conflict</a></b>
<a href="#h193-0" id="h193-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;float&quot; SET pk = 2.718 WHERE pk = 3.14
<a href="#h193-0-1" id="h193-0-1" class="d">-Error: Value(&quot;Primary key 2.718 already exists for table float&quot;)
</a><a href="#h193-0-2" id="h193-0-2" class="i">+Error: InvalidInput(&quot;primary key 2.718 already exists for table float&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;float&quot; (
<b>diff --git a/<a id="h194" href="../file/tests/sql/schema/update_pk_float_conflict_all.html">tests/sql/schema/update_pk_float_conflict_all</a> b/<a href="../file/tests/sql/schema/update_pk_float_conflict_all.html">tests/sql/schema/update_pk_float_conflict_all</a></b>
<a href="#h194-0" id="h194-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;float&quot; SET pk = 3.14
<a href="#h194-0-1" id="h194-0-1" class="d">-Error: Value(&quot;Primary key 3.14 already exists for table float&quot;)
</a><a href="#h194-0-2" id="h194-0-2" class="i">+Error: InvalidInput(&quot;primary key 3.14 already exists for table float&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;float&quot; (
<b>diff --git a/<a id="h195" href="../file/tests/sql/schema/update_pk_float_null.html">tests/sql/schema/update_pk_float_null</a> b/<a href="../file/tests/sql/schema/update_pk_float_null.html">tests/sql/schema/update_pk_float_null</a></b>
<a href="#h195-0" id="h195-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;float&quot; SET pk = NULL WHERE pk = 3.14
<a href="#h195-0-1" id="h195-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column pk&quot;)
</a><a href="#h195-0-2" id="h195-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column pk&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;float&quot; (
<b>diff --git a/<a id="h196" href="../file/tests/sql/schema/update_pk_integer_conflict.html">tests/sql/schema/update_pk_integer_conflict</a> b/<a href="../file/tests/sql/schema/update_pk_integer_conflict.html">tests/sql/schema/update_pk_integer_conflict</a></b>
<a href="#h196-0" id="h196-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;integer&quot; SET pk = 1 WHERE pk = 2
<a href="#h196-0-1" id="h196-0-1" class="d">-Error: Value(&quot;Primary key 1 already exists for table integer&quot;)
</a><a href="#h196-0-2" id="h196-0-2" class="i">+Error: InvalidInput(&quot;primary key 1 already exists for table integer&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;integer&quot; (
<b>diff --git a/<a id="h197" href="../file/tests/sql/schema/update_pk_integer_conflict_all.html">tests/sql/schema/update_pk_integer_conflict_all</a> b/<a href="../file/tests/sql/schema/update_pk_integer_conflict_all.html">tests/sql/schema/update_pk_integer_conflict_all</a></b>
<a href="#h197-0" id="h197-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;integer&quot; SET pk = 1
<a href="#h197-0-1" id="h197-0-1" class="d">-Error: Value(&quot;Primary key 1 already exists for table integer&quot;)
</a><a href="#h197-0-2" id="h197-0-2" class="i">+Error: InvalidInput(&quot;primary key 1 already exists for table integer&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;integer&quot; (
<b>diff --git a/<a id="h198" href="../file/tests/sql/schema/update_pk_integer_null.html">tests/sql/schema/update_pk_integer_null</a> b/<a href="../file/tests/sql/schema/update_pk_integer_null.html">tests/sql/schema/update_pk_integer_null</a></b>
<a href="#h198-0" id="h198-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;integer&quot; SET pk = NULL WHERE pk = 2
<a href="#h198-0-1" id="h198-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column pk&quot;)
</a><a href="#h198-0-2" id="h198-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column pk&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;integer&quot; (
<b>diff --git a/<a id="h199" href="../file/tests/sql/schema/update_pk_string_conflict.html">tests/sql/schema/update_pk_string_conflict</a> b/<a href="../file/tests/sql/schema/update_pk_string_conflict.html">tests/sql/schema/update_pk_string_conflict</a></b>
<a href="#h199-0" id="h199-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;string&quot; SET pk = &#39;bar&#39; WHERE pk = &#39;foo&#39;
<a href="#h199-0-1" id="h199-0-1" class="d">-Error: Value(&quot;Primary key bar already exists for table string&quot;)
</a><a href="#h199-0-2" id="h199-0-2" class="i">+Error: InvalidInput(&quot;primary key bar already exists for table string&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;string&quot; (
<b>diff --git a/<a id="h200" href="../file/tests/sql/schema/update_pk_string_conflict_all.html">tests/sql/schema/update_pk_string_conflict_all</a> b/<a href="../file/tests/sql/schema/update_pk_string_conflict_all.html">tests/sql/schema/update_pk_string_conflict_all</a></b>
<a href="#h200-0" id="h200-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;string&quot; SET pk = &#39;foo&#39;
<a href="#h200-0-1" id="h200-0-1" class="d">-Error: Value(&quot;Primary key foo already exists for table string&quot;)
</a><a href="#h200-0-2" id="h200-0-2" class="i">+Error: InvalidInput(&quot;primary key foo already exists for table string&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;string&quot; (
<b>diff --git a/<a id="h201" href="../file/tests/sql/schema/update_pk_string_null.html">tests/sql/schema/update_pk_string_null</a> b/<a href="../file/tests/sql/schema/update_pk_string_null.html">tests/sql/schema/update_pk_string_null</a></b>
<a href="#h201-0" id="h201-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;string&quot; SET pk = NULL WHERE pk = &#39;foo&#39;
<a href="#h201-0-1" id="h201-0-1" class="d">-Error: Value(&quot;NULL value not allowed for column pk&quot;)
</a><a href="#h201-0-2" id="h201-0-2" class="i">+Error: InvalidInput(&quot;NULL value not allowed for column pk&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;string&quot; (
<b>diff --git a/<a id="h202" href="../file/tests/sql/schema/update_ref_pk.html">tests/sql/schema/update_ref_pk</a> b/<a href="../file/tests/sql/schema/update_ref_pk.html">tests/sql/schema/update_ref_pk</a></b>
<a href="#h202-0" id="h202-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE target SET id = 9 WHERE id = 1
<a href="#h202-0-1" id="h202-0-1" class="d">-Error: Value(&quot;Primary key 1 is referenced by table source column target_id&quot;)
</a><a href="#h202-0-2" id="h202-0-2" class="i">+Error: InvalidInput(&quot;primary key 1 referenced by table source column target_id&quot;)
</a> 
 Storage:
 CREATE TABLE source (
<b>diff --git a/<a id="h203" href="../file/tests/sql/schema/update_ref_self_pk.html">tests/sql/schema/update_ref_self_pk</a> b/<a href="../file/tests/sql/schema/update_ref_self_pk.html">tests/sql/schema/update_ref_self_pk</a></b>
<a href="#h203-0" id="h203-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE self SET id = 9 WHERE id = 1
<a href="#h203-0-1" id="h203-0-1" class="d">-Error: Value(&quot;Primary key 1 is referenced by table self column self_id&quot;)
</a><a href="#h203-0-2" id="h203-0-2" class="i">+Error: InvalidInput(&quot;primary key 1 referenced by table self column self_id&quot;)
</a> 
 Storage:
 CREATE TABLE self (
<b>diff --git a/<a id="h204" href="../file/tests/sql/schema/update_ref_source_missing.html">tests/sql/schema/update_ref_source_missing</a> b/<a href="../file/tests/sql/schema/update_ref_source_missing.html">tests/sql/schema/update_ref_source_missing</a></b>
<a href="#h204-0" id="h204-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE source SET target_id = 9 WHERE id = 4
<a href="#h204-0-1" id="h204-0-1" class="d">-Error: Value(&quot;Referenced primary key 9 in table target does not exist&quot;)
</a><a href="#h204-0-2" id="h204-0-2" class="i">+Error: InvalidInput(&quot;referenced primary key 9 in table target does not exist&quot;)
</a> 
 Storage:
 CREATE TABLE source (
<b>diff --git a/<a id="h205" href="../file/tests/sql/schema/update_unique_boolean_duplicate.html">tests/sql/schema/update_unique_boolean_duplicate</a> b/<a href="../file/tests/sql/schema/update_unique_boolean_duplicate.html">tests/sql/schema/update_unique_boolean_duplicate</a></b>
<a href="#h205-0" id="h205-0" class="h">@@ -1,5 +1,5 @@
</a> Query: UPDATE &quot;unique&quot; SET &quot;boolean&quot; = TRUE WHERE id = 0
<a href="#h205-0-1" id="h205-0-1" class="d">-Error: Value(&quot;Unique value TRUE already exists for column boolean&quot;)
</a><a href="#h205-0-2" id="h205-0-2" class="i">+Error: InvalidInput(&quot;unique value TRUE already exists for column boolean&quot;)
</a> 
 Storage:
 CREATE TABLE &quot;unique&quot; (
</pre>
</div>
</body>
</html>
