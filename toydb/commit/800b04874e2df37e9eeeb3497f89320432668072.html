<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: renamed join fields - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/800b04874e2df37e9eeeb3497f89320432668072.html">800b04874e2df37e9eeeb3497f89320432668072</a>
<b>parent</b> <a href="../commit/d8a2d3e90980c139b62575125b69f74788a8a112.html">d8a2d3e90980c139b62575125b69f74788a8a112</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Thu,  4 Jun 2020 20:22:34 +0200

sql: renamed join fields

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/execution/join.rs</a></td><td> | </td><td class="num">96</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/execution/mod.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/plan/mod.rs</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/plan/optimizer.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">tests/sql/query/field_aliased</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">tests/sql/query/field_qualified_multi</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">tests/sql/query/from_multiple</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">tests/sql/query/group_join</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">tests/sql/query/join_cross</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">tests/sql/query/join_cross_multi</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query/join_inner</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/query/join_inner_implicit</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/join_inner_index_transverse</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/join_inner_index_transverse_where</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/join_inner_multi</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/join_inner_on_aliased</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/join_inner_on_false</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/join_inner_on_multi</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/join_inner_on_true</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/join_inner_on_where</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/join_left</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/join_left_outer</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/join_left_truncate</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/join_right</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/join_right_outer</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/join_right_truncate</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/where_join_inner</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
</table></pre><pre>34 files changed, 287 insertions(+), 288 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/execution/join.rs.html">src/sql/execution/join.rs</a> b/<a href="../file/src/sql/execution/join.rs.html">src/sql/execution/join.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -6,46 +6,46 @@ use crate::error::{Error, Result};
</a> /// A nested loop join executor
 /// FIXME This code is horrible, clean it up at some point
 pub struct NestedLoopJoin&lt;T: Transaction&gt; {
<a href="#h0-0-3" id="h0-0-3" class="d">-    /// The outer source
</a><a href="#h0-0-4" id="h0-0-4" class="d">-    outer: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a><a href="#h0-0-5" id="h0-0-5" class="d">-    /// The inner source
</a><a href="#h0-0-6" id="h0-0-6" class="d">-    inner: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a><a href="#h0-0-7" id="h0-0-7" class="i">+    /// The left source
</a><a href="#h0-0-8" id="h0-0-8" class="i">+    left: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a><a href="#h0-0-9" id="h0-0-9" class="i">+    /// The right source
</a><a href="#h0-0-10" id="h0-0-10" class="i">+    right: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a>     /// The join predicate
     predicate: Option&lt;Expression&gt;,
<a href="#h0-0-13" id="h0-0-13" class="d">-    /// Whether to pad missing inner items (i.e. for outer joins)
</a><a href="#h0-0-14" id="h0-0-14" class="d">-    pad_inner: bool,
</a><a href="#h0-0-15" id="h0-0-15" class="i">+    /// Whether to pad missing right items (for outer joins)
</a><a href="#h0-0-16" id="h0-0-16" class="i">+    pad: bool,
</a>     /// Whether to flip inputs (for right outer joins)
     flip: bool,
 }
 
 impl&lt;T: Transaction&gt; NestedLoopJoin&lt;T&gt; {
     pub fn new(
<a href="#h0-0-23" id="h0-0-23" class="d">-        outer: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a><a href="#h0-0-24" id="h0-0-24" class="d">-        inner: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a><a href="#h0-0-25" id="h0-0-25" class="i">+        left: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a><a href="#h0-0-26" id="h0-0-26" class="i">+        right: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a>         predicate: Option&lt;Expression&gt;,
<a href="#h0-0-28" id="h0-0-28" class="d">-        pad_inner: bool,
</a><a href="#h0-0-29" id="h0-0-29" class="i">+        pad: bool,
</a>         flip: bool,
     ) -&gt; Box&lt;Self&gt; {
<a href="#h0-0-32" id="h0-0-32" class="d">-        Box::new(Self { outer, inner, predicate, pad_inner, flip })
</a><a href="#h0-0-33" id="h0-0-33" class="i">+        Box::new(Self { left, right, predicate, pad, flip })
</a>     }
 }
 
 impl&lt;T: Transaction&gt; Executor&lt;T&gt; for NestedLoopJoin&lt;T&gt; {
     fn execute(self: Box&lt;Self&gt;, txn: &amp;mut T) -&gt; Result&lt;ResultSet&gt; {
<a href="#h0-0-39" id="h0-0-39" class="d">-        let (result, inner) = if self.flip {
</a><a href="#h0-0-40" id="h0-0-40" class="d">-            (self.inner.execute(txn)?, self.outer.execute(txn)?)
</a><a href="#h0-0-41" id="h0-0-41" class="i">+        let (result, right) = if self.flip {
</a><a href="#h0-0-42" id="h0-0-42" class="i">+            (self.right.execute(txn)?, self.left.execute(txn)?)
</a>         } else {
<a href="#h0-0-44" id="h0-0-44" class="d">-            (self.outer.execute(txn)?, self.inner.execute(txn)?)
</a><a href="#h0-0-45" id="h0-0-45" class="i">+            (self.left.execute(txn)?, self.right.execute(txn)?)
</a>         };
         if let ResultSet::Query { columns, rows } = result {
<a href="#h0-0-48" id="h0-0-48" class="d">-            if let ResultSet::Query { columns: inner_columns, rows: inner_rows } = inner {
</a><a href="#h0-0-49" id="h0-0-49" class="i">+            if let ResultSet::Query { columns: right_columns, rows: right_rows } = right {
</a>                 let mut join_columns = Columns::new();
                 if self.flip {
<a href="#h0-0-52" id="h0-0-52" class="d">-                    join_columns.extend(inner_columns);
</a><a href="#h0-0-53" id="h0-0-53" class="i">+                    join_columns.extend(right_columns);
</a>                     join_columns.extend(columns);
                 } else {
                     join_columns.extend(columns);
<a href="#h0-0-57" id="h0-0-57" class="d">-                    join_columns.extend(inner_columns);
</a><a href="#h0-0-58" id="h0-0-58" class="i">+                    join_columns.extend(right_columns);
</a>                 }
 
                 return Ok(ResultSet::Query {
<a href="#h0-1" id="h0-1" class="h">@@ -53,9 +53,9 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for NestedLoopJoin&lt;T&gt; {
</a>                     rows: Box::new(NestedLoopRows::new(
                         join_columns,
                         rows,
<a href="#h0-1-3" id="h0-1-3" class="d">-                        inner_rows.collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?,
</a><a href="#h0-1-4" id="h0-1-4" class="i">+                        right_rows.collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?,
</a>                         self.predicate,
<a href="#h0-1-6" id="h0-1-6" class="d">-                        self.pad_inner,
</a><a href="#h0-1-7" id="h0-1-7" class="i">+                        self.pad,
</a>                         self.flip,
                     )),
                 });
<a href="#h0-2" id="h0-2" class="h">@@ -68,45 +68,45 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for NestedLoopJoin&lt;T&gt; {
</a> struct NestedLoopRows {
     columns: Columns,
     predicate: Option&lt;Expression&gt;,
<a href="#h0-2-3" id="h0-2-3" class="d">-    outer: Rows,
</a><a href="#h0-2-4" id="h0-2-4" class="d">-    outer_cur: Option&lt;Result&lt;Row&gt;&gt;,
</a><a href="#h0-2-5" id="h0-2-5" class="d">-    // FIXME inner should be Rows too, but requires impl Clone
</a><a href="#h0-2-6" id="h0-2-6" class="d">-    inner: Box&lt;dyn Iterator&lt;Item = Row&gt; + Send&gt;,
</a><a href="#h0-2-7" id="h0-2-7" class="d">-    inner_orig: Vec&lt;Row&gt;,
</a><a href="#h0-2-8" id="h0-2-8" class="d">-    inner_pad: bool,
</a><a href="#h0-2-9" id="h0-2-9" class="d">-    inner_emitted: bool,
</a><a href="#h0-2-10" id="h0-2-10" class="i">+    left: Rows,
</a><a href="#h0-2-11" id="h0-2-11" class="i">+    left_cur: Option&lt;Result&lt;Row&gt;&gt;,
</a><a href="#h0-2-12" id="h0-2-12" class="i">+    // FIXME right should be Rows too, but requires impl Clone
</a><a href="#h0-2-13" id="h0-2-13" class="i">+    right: Box&lt;dyn Iterator&lt;Item = Row&gt; + Send&gt;,
</a><a href="#h0-2-14" id="h0-2-14" class="i">+    right_orig: Vec&lt;Row&gt;,
</a><a href="#h0-2-15" id="h0-2-15" class="i">+    right_pad: bool,
</a><a href="#h0-2-16" id="h0-2-16" class="i">+    right_emitted: bool,
</a>     flipped: bool,
 }
 
 impl NestedLoopRows {
     fn new(
         columns: Columns,
<a href="#h0-2-23" id="h0-2-23" class="d">-        mut outer: Rows,
</a><a href="#h0-2-24" id="h0-2-24" class="d">-        inner: Vec&lt;Row&gt;,
</a><a href="#h0-2-25" id="h0-2-25" class="i">+        mut left: Rows,
</a><a href="#h0-2-26" id="h0-2-26" class="i">+        right: Vec&lt;Row&gt;,
</a>         predicate: Option&lt;Expression&gt;,
<a href="#h0-2-28" id="h0-2-28" class="d">-        inner_pad: bool,
</a><a href="#h0-2-29" id="h0-2-29" class="i">+        right_pad: bool,
</a>         flipped: bool,
     ) -&gt; Self {
         Self {
             columns,
             predicate,
<a href="#h0-2-35" id="h0-2-35" class="d">-            outer_cur: outer.next(),
</a><a href="#h0-2-36" id="h0-2-36" class="d">-            outer,
</a><a href="#h0-2-37" id="h0-2-37" class="d">-            inner: Box::new(inner.clone().into_iter()),
</a><a href="#h0-2-38" id="h0-2-38" class="d">-            inner_orig: inner,
</a><a href="#h0-2-39" id="h0-2-39" class="d">-            inner_pad,
</a><a href="#h0-2-40" id="h0-2-40" class="d">-            inner_emitted: false,
</a><a href="#h0-2-41" id="h0-2-41" class="i">+            left_cur: left.next(),
</a><a href="#h0-2-42" id="h0-2-42" class="i">+            left,
</a><a href="#h0-2-43" id="h0-2-43" class="i">+            right: Box::new(right.clone().into_iter()),
</a><a href="#h0-2-44" id="h0-2-44" class="i">+            right_orig: right,
</a><a href="#h0-2-45" id="h0-2-45" class="i">+            right_pad,
</a><a href="#h0-2-46" id="h0-2-46" class="i">+            right_emitted: false,
</a>             flipped,
         }
     }
 
<a href="#h0-2-51" id="h0-2-51" class="d">-    fn next_inner(&amp;mut self) -&gt; Result&lt;Option&lt;Row&gt;&gt; {
</a><a href="#h0-2-52" id="h0-2-52" class="d">-        let o = match self.outer_cur.clone() {
</a><a href="#h0-2-53" id="h0-2-53" class="i">+    fn next_right(&amp;mut self) -&gt; Result&lt;Option&lt;Row&gt;&gt; {
</a><a href="#h0-2-54" id="h0-2-54" class="i">+        let o = match self.left_cur.clone() {
</a>             Some(Ok(o)) =&gt; o,
             Some(Err(e)) =&gt; return Err(e),
             None =&gt; return Ok(None),
         };
<a href="#h0-2-59" id="h0-2-59" class="d">-        while let Some(i) = self.inner.next() {
</a><a href="#h0-2-60" id="h0-2-60" class="i">+        while let Some(i) = self.right.next() {
</a>             if let Some(predicate) = &amp;self.predicate {
                 let mut row = Vec::new();
                 if self.flipped {
<a href="#h0-3" id="h0-3" class="h">@@ -139,20 +139,20 @@ impl Iterator for NestedLoopRows {
</a>     type Item = Result&lt;Row&gt;;
 
     fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
<a href="#h0-3-3" id="h0-3-3" class="d">-        while self.outer_cur.is_some() {
</a><a href="#h0-3-4" id="h0-3-4" class="d">-            if let Some(Err(e)) = &amp;self.outer_cur {
</a><a href="#h0-3-5" id="h0-3-5" class="i">+        while self.left_cur.is_some() {
</a><a href="#h0-3-6" id="h0-3-6" class="i">+            if let Some(Err(e)) = &amp;self.left_cur {
</a>                 return Some(Err(e.clone()));
             }
<a href="#h0-3-9" id="h0-3-9" class="d">-            let mut i = match self.next_inner().transpose() {
</a><a href="#h0-3-10" id="h0-3-10" class="i">+            let mut i = match self.next_right().transpose() {
</a>                 Some(Ok(i)) =&gt; {
<a href="#h0-3-12" id="h0-3-12" class="d">-                    self.inner_emitted = true;
</a><a href="#h0-3-13" id="h0-3-13" class="i">+                    self.right_emitted = true;
</a>                     i
                 }
                 Some(Err(e)) =&gt; return Some(Err(e)),
                 None =&gt; {
<a href="#h0-3-18" id="h0-3-18" class="d">-                    self.inner = Box::new(self.inner_orig.clone().into_iter());
</a><a href="#h0-3-19" id="h0-3-19" class="d">-                    if self.inner_pad &amp;&amp; !self.inner_emitted {
</a><a href="#h0-3-20" id="h0-3-20" class="d">-                        let mut row = self.outer_cur.clone().unwrap().unwrap();
</a><a href="#h0-3-21" id="h0-3-21" class="i">+                    self.right = Box::new(self.right_orig.clone().into_iter());
</a><a href="#h0-3-22" id="h0-3-22" class="i">+                    if self.right_pad &amp;&amp; !self.right_emitted {
</a><a href="#h0-3-23" id="h0-3-23" class="i">+                        let mut row = self.left_cur.clone().unwrap().unwrap();
</a>                         while row.len() &lt; self.columns.len() {
                             if self.flipped {
                                 row.insert(0, Value::Null)
<a href="#h0-4" id="h0-4" class="h">@@ -160,15 +160,15 @@ impl Iterator for NestedLoopRows {
</a>                                 row.push(Value::Null)
                             }
                         }
<a href="#h0-4-3" id="h0-4-3" class="d">-                        self.outer_cur = self.outer.next();
</a><a href="#h0-4-4" id="h0-4-4" class="i">+                        self.left_cur = self.left.next();
</a>                         return Some(Ok(row));
                     }
<a href="#h0-4-7" id="h0-4-7" class="d">-                    self.inner_emitted = false;
</a><a href="#h0-4-8" id="h0-4-8" class="d">-                    self.outer_cur = self.outer.next();
</a><a href="#h0-4-9" id="h0-4-9" class="i">+                    self.right_emitted = false;
</a><a href="#h0-4-10" id="h0-4-10" class="i">+                    self.left_cur = self.left.next();
</a>                     continue;
                 }
             };
<a href="#h0-4-14" id="h0-4-14" class="d">-            let mut o = match self.outer_cur.clone() {
</a><a href="#h0-4-15" id="h0-4-15" class="i">+            let mut o = match self.left_cur.clone() {
</a>                 Some(Ok(o)) =&gt; o,
                 Some(Err(e)) =&gt; return Some(Err(e)),
                 None =&gt; return None,
<b>diff --git a/<a id="h1" href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a> b/<a href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -45,8 +45,8 @@ impl&lt;T: Transaction + &#39;static&gt; dyn Executor&lt;T&gt; {
</a>             }
             Node::KeyLookup { table, alias: _, keys } =&gt; KeyLookup::new(table, keys),
             Node::Limit { source, limit } =&gt; Limit::new(Self::build(*source), limit),
<a href="#h1-0-3" id="h1-0-3" class="d">-            Node::NestedLoopJoin { outer, outer_size: _, inner, predicate, pad, flip } =&gt; {
</a><a href="#h1-0-4" id="h1-0-4" class="d">-                NestedLoopJoin::new(Self::build(*outer), Self::build(*inner), predicate, pad, flip)
</a><a href="#h1-0-5" id="h1-0-5" class="i">+            Node::NestedLoopJoin { left, left_size: _, right, predicate, pad, flip } =&gt; {
</a><a href="#h1-0-6" id="h1-0-6" class="i">+                NestedLoopJoin::new(Self::build(*left), Self::build(*right), predicate, pad, flip)
</a>             }
             Node::Nothing =&gt; Nothing::new(),
             Node::Offset { source, offset } =&gt; Offset::new(Self::build(*source), offset),
<b>diff --git a/<a id="h2" href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a> b/<a href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -88,9 +88,9 @@ pub enum Node {
</a>         limit: u64,
     },
     NestedLoopJoin {
<a href="#h2-0-3" id="h2-0-3" class="d">-        outer: Box&lt;Node&gt;,
</a><a href="#h2-0-4" id="h2-0-4" class="d">-        outer_size: usize,
</a><a href="#h2-0-5" id="h2-0-5" class="d">-        inner: Box&lt;Node&gt;,
</a><a href="#h2-0-6" id="h2-0-6" class="i">+        left: Box&lt;Node&gt;,
</a><a href="#h2-0-7" id="h2-0-7" class="i">+        left_size: usize,
</a><a href="#h2-0-8" id="h2-0-8" class="i">+        right: Box&lt;Node&gt;,
</a>         predicate: Option&lt;Expression&gt;,
         pad: bool,
         flip: bool,
<a href="#h2-1" id="h2-1" class="h">@@ -150,11 +150,11 @@ impl Node {
</a>             Self::Limit { source, limit } =&gt; {
                 Self::Limit { source: source.transform(before, after)?.into(), limit }
             }
<a href="#h2-1-3" id="h2-1-3" class="d">-            Self::NestedLoopJoin { outer, outer_size, inner, predicate, pad, flip } =&gt; {
</a><a href="#h2-1-4" id="h2-1-4" class="i">+            Self::NestedLoopJoin { left, left_size, right, predicate, pad, flip } =&gt; {
</a>                 Self::NestedLoopJoin {
<a href="#h2-1-6" id="h2-1-6" class="d">-                    outer: outer.transform(before, after)?.into(),
</a><a href="#h2-1-7" id="h2-1-7" class="d">-                    outer_size,
</a><a href="#h2-1-8" id="h2-1-8" class="d">-                    inner: inner.transform(before, after)?.into(),
</a><a href="#h2-1-9" id="h2-1-9" class="i">+                    left: left.transform(before, after)?.into(),
</a><a href="#h2-1-10" id="h2-1-10" class="i">+                    left_size,
</a><a href="#h2-1-11" id="h2-1-11" class="i">+                    right: right.transform(before, after)?.into(),
</a>                     predicate,
                     pad,
                     flip,
<a href="#h2-2" id="h2-2" class="h">@@ -297,7 +297,7 @@ impl Node {
</a>                 s += &amp;format!(&quot;Limit: {}\n&quot;, limit);
                 s += &amp;source.format(indent, false, true);
             }
<a href="#h2-2-3" id="h2-2-3" class="d">-            Self::NestedLoopJoin { outer, outer_size: _, inner, predicate, pad, flip } =&gt; {
</a><a href="#h2-2-4" id="h2-2-4" class="i">+            Self::NestedLoopJoin { left, left_size: _, right, predicate, pad, flip } =&gt; {
</a>                 s += &quot;NestedLoopJoin:&quot;;
                 if !pad {
                     s += &quot; inner&quot;;
<a href="#h2-3" id="h2-3" class="h">@@ -310,8 +310,8 @@ impl Node {
</a>                     s += &amp;format!(&quot; on {}&quot;, expr);
                 }
                 s += &quot;\n&quot;;
<a href="#h2-3-3" id="h2-3-3" class="d">-                s += &amp;outer.format(indent.clone(), false, false);
</a><a href="#h2-3-4" id="h2-3-4" class="d">-                s += &amp;inner.format(indent, false, true);
</a><a href="#h2-3-5" id="h2-3-5" class="i">+                s += &amp;left.format(indent.clone(), false, false);
</a><a href="#h2-3-6" id="h2-3-6" class="i">+                s += &amp;right.format(indent, false, true);
</a>             }
             Self::Nothing {} =&gt; {
                 s += &quot;Nothing\n&quot;;
<b>diff --git a/<a id="h3" href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a> b/<a href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -52,16 +52,15 @@ impl Optimizer for FilterPushdown {
</a>                     }
                 }
                 Node::NestedLoopJoin {
<a href="#h3-0-3" id="h3-0-3" class="d">-                    mut outer,
</a><a href="#h3-0-4" id="h3-0-4" class="d">-                    outer_size,
</a><a href="#h3-0-5" id="h3-0-5" class="d">-                    mut inner,
</a><a href="#h3-0-6" id="h3-0-6" class="i">+                    mut left,
</a><a href="#h3-0-7" id="h3-0-7" class="i">+                    left_size,
</a><a href="#h3-0-8" id="h3-0-8" class="i">+                    mut right,
</a>                     predicate: Some(predicate),
                     pad,
                     flip,
                 } =&gt; {
<a href="#h3-0-13" id="h3-0-13" class="d">-                    let predicate =
</a><a href="#h3-0-14" id="h3-0-14" class="d">-                        self.pushdown_join(predicate, &amp;mut outer, &amp;mut inner, outer_size);
</a><a href="#h3-0-15" id="h3-0-15" class="d">-                    Ok(Node::NestedLoopJoin { outer, outer_size, inner, predicate, pad, flip })
</a><a href="#h3-0-16" id="h3-0-16" class="i">+                    let predicate = self.pushdown_join(predicate, &amp;mut left, &amp;mut right, left_size);
</a><a href="#h3-0-17" id="h3-0-17" class="i">+                    Ok(Node::NestedLoopJoin { left, left_size, right, predicate, pad, flip })
</a>                 }
                 n =&gt; Ok(n),
             },
<b>diff --git a/<a id="h4" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -259,9 +259,9 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         };
         for item in items {
             node = Node::NestedLoopJoin {
<a href="#h4-0-3" id="h4-0-3" class="d">-                outer: Box::new(node),
</a><a href="#h4-0-4" id="h4-0-4" class="d">-                outer_size: scope.len(),
</a><a href="#h4-0-5" id="h4-0-5" class="d">-                inner: Box::new(self.build_from_item(scope, item)?),
</a><a href="#h4-0-6" id="h4-0-6" class="i">+                left: Box::new(node),
</a><a href="#h4-0-7" id="h4-0-7" class="i">+                left_size: scope.len(),
</a><a href="#h4-0-8" id="h4-0-8" class="i">+                right: Box::new(self.build_from_item(scope, item)?),
</a>                 predicate: None,
                 pad: false,
                 flip: false,
<a href="#h4-1" id="h4-1" class="h">@@ -286,25 +286,25 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a> 
             ast::FromItem::Join { left, right, r#type, predicate } =&gt; match r#type {
                 ast::JoinType::Cross | ast::JoinType::Inner =&gt; Node::NestedLoopJoin {
<a href="#h4-1-3" id="h4-1-3" class="d">-                    outer: Box::new(self.build_from_item(scope, *left)?),
</a><a href="#h4-1-4" id="h4-1-4" class="d">-                    outer_size: scope.len(),
</a><a href="#h4-1-5" id="h4-1-5" class="d">-                    inner: Box::new(self.build_from_item(scope, *right)?),
</a><a href="#h4-1-6" id="h4-1-6" class="i">+                    left: Box::new(self.build_from_item(scope, *left)?),
</a><a href="#h4-1-7" id="h4-1-7" class="i">+                    left_size: scope.len(),
</a><a href="#h4-1-8" id="h4-1-8" class="i">+                    right: Box::new(self.build_from_item(scope, *right)?),
</a>                     predicate: predicate.map(|e| self.build_expression(scope, e)).transpose()?,
                     pad: false,
                     flip: false,
                 },
                 ast::JoinType::Left =&gt; Node::NestedLoopJoin {
<a href="#h4-1-14" id="h4-1-14" class="d">-                    outer: Box::new(self.build_from_item(scope, *left)?),
</a><a href="#h4-1-15" id="h4-1-15" class="d">-                    outer_size: scope.len(),
</a><a href="#h4-1-16" id="h4-1-16" class="d">-                    inner: Box::new(self.build_from_item(scope, *right)?),
</a><a href="#h4-1-17" id="h4-1-17" class="i">+                    left: Box::new(self.build_from_item(scope, *left)?),
</a><a href="#h4-1-18" id="h4-1-18" class="i">+                    left_size: scope.len(),
</a><a href="#h4-1-19" id="h4-1-19" class="i">+                    right: Box::new(self.build_from_item(scope, *right)?),
</a>                     predicate: predicate.map(|e| self.build_expression(scope, e)).transpose()?,
                     pad: true,
                     flip: false,
                 },
                 ast::JoinType::Right =&gt; Node::NestedLoopJoin {
<a href="#h4-1-25" id="h4-1-25" class="d">-                    outer: Box::new(self.build_from_item(scope, *left)?),
</a><a href="#h4-1-26" id="h4-1-26" class="d">-                    outer_size: scope.len(),
</a><a href="#h4-1-27" id="h4-1-27" class="d">-                    inner: Box::new(self.build_from_item(scope, *right)?),
</a><a href="#h4-1-28" id="h4-1-28" class="i">+                    left: Box::new(self.build_from_item(scope, *left)?),
</a><a href="#h4-1-29" id="h4-1-29" class="i">+                    left_size: scope.len(),
</a><a href="#h4-1-30" id="h4-1-30" class="i">+                    right: Box::new(self.build_from_item(scope, *right)?),
</a>                     predicate: predicate.map(|e| self.build_expression(scope, e)).transpose()?,
                     pad: true,
                     flip: true,
<b>diff --git a/<a id="h5" href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a> b/<a href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -46,15 +46,15 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h5-0-3" id="h5-0-3" class="d">-            outer: Scan {
</a><a href="#h5-0-4" id="h5-0-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h5-0-11" id="h5-0-11" class="d">-            outer_size: 7,
</a><a href="#h5-0-12" id="h5-0-12" class="d">-            inner: Scan {
</a><a href="#h5-0-13" id="h5-0-13" class="i">+            left_size: 7,
</a><a href="#h5-0-14" id="h5-0-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<a href="#h5-1" id="h5-1" class="h">@@ -101,15 +101,15 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h5-1-3" id="h5-1-3" class="d">-            outer: Scan {
</a><a href="#h5-1-4" id="h5-1-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h5-1-11" id="h5-1-11" class="d">-            outer_size: 7,
</a><a href="#h5-1-12" id="h5-1-12" class="d">-            inner: Scan {
</a><a href="#h5-1-13" id="h5-1-13" class="i">+            left_size: 7,
</a><a href="#h5-1-14" id="h5-1-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<b>diff --git a/<a id="h6" href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a> b/<a href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -42,13 +42,13 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h6-0-3" id="h6-0-3" class="d">-            outer: Scan {
</a><a href="#h6-0-4" id="h6-0-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: None,
                 filter: None,
             },
<a href="#h6-0-9" id="h6-0-9" class="d">-            outer_size: 7,
</a><a href="#h6-0-10" id="h6-0-10" class="d">-            inner: Scan {
</a><a href="#h6-0-11" id="h6-0-11" class="i">+            left_size: 7,
</a><a href="#h6-0-12" id="h6-0-12" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: None,
                 filter: None,
<a href="#h6-1" id="h6-1" class="h">@@ -93,13 +93,13 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h6-1-3" id="h6-1-3" class="d">-            outer: Scan {
</a><a href="#h6-1-4" id="h6-1-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: None,
                 filter: None,
             },
<a href="#h6-1-9" id="h6-1-9" class="d">-            outer_size: 7,
</a><a href="#h6-1-10" id="h6-1-10" class="d">-            inner: Scan {
</a><a href="#h6-1-11" id="h6-1-11" class="i">+            left_size: 7,
</a><a href="#h6-1-12" id="h6-1-12" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: None,
                 filter: None,
<b>diff --git a/<a id="h7" href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a> b/<a href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -26,14 +26,14 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h7-0-3" id="h7-0-3" class="d">-        outer: NestedLoopJoin {
</a><a href="#h7-0-4" id="h7-0-4" class="d">-            outer: Scan {
</a><a href="#h7-0-5" id="h7-0-5" class="i">+        left: NestedLoopJoin {
</a><a href="#h7-0-6" id="h7-0-6" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: None,
                 filter: None,
             },
<a href="#h7-0-11" id="h7-0-11" class="d">-            outer_size: 7,
</a><a href="#h7-0-12" id="h7-0-12" class="d">-            inner: Scan {
</a><a href="#h7-0-13" id="h7-0-13" class="i">+            left_size: 7,
</a><a href="#h7-0-14" id="h7-0-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: None,
                 filter: None,
<a href="#h7-1" id="h7-1" class="h">@@ -42,8 +42,8 @@ Plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h7-1-3" id="h7-1-3" class="d">-        outer_size: 9,
</a><a href="#h7-1-4" id="h7-1-4" class="d">-        inner: Scan {
</a><a href="#h7-1-5" id="h7-1-5" class="i">+        left_size: 9,
</a><a href="#h7-1-6" id="h7-1-6" class="i">+        right: Scan {
</a>             table: &quot;countries&quot;,
             alias: None,
             filter: None,
<a href="#h7-2" id="h7-2" class="h">@@ -56,14 +56,14 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h7-2-3" id="h7-2-3" class="d">-        outer: NestedLoopJoin {
</a><a href="#h7-2-4" id="h7-2-4" class="d">-            outer: Scan {
</a><a href="#h7-2-5" id="h7-2-5" class="i">+        left: NestedLoopJoin {
</a><a href="#h7-2-6" id="h7-2-6" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: None,
                 filter: None,
             },
<a href="#h7-2-11" id="h7-2-11" class="d">-            outer_size: 7,
</a><a href="#h7-2-12" id="h7-2-12" class="d">-            inner: Scan {
</a><a href="#h7-2-13" id="h7-2-13" class="i">+            left_size: 7,
</a><a href="#h7-2-14" id="h7-2-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: None,
                 filter: None,
<a href="#h7-3" id="h7-3" class="h">@@ -72,8 +72,8 @@ Optimized plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h7-3-3" id="h7-3-3" class="d">-        outer_size: 9,
</a><a href="#h7-3-4" id="h7-3-4" class="d">-        inner: Scan {
</a><a href="#h7-3-5" id="h7-3-5" class="i">+        left_size: 9,
</a><a href="#h7-3-6" id="h7-3-6" class="i">+        right: Scan {
</a>             table: &quot;countries&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h8" href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a> b/<a href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -91,15 +91,15 @@ Plan: Plan(
</a>             source: Aggregation {
                 source: Projection {
                     source: NestedLoopJoin {
<a href="#h8-0-3" id="h8-0-3" class="d">-                        outer: Scan {
</a><a href="#h8-0-4" id="h8-0-4" class="i">+                        left: Scan {
</a>                             table: &quot;movies&quot;,
                             alias: Some(
                                 &quot;m&quot;,
                             ),
                             filter: None,
                         },
<a href="#h8-0-11" id="h8-0-11" class="d">-                        outer_size: 7,
</a><a href="#h8-0-12" id="h8-0-12" class="d">-                        inner: Scan {
</a><a href="#h8-0-13" id="h8-0-13" class="i">+                        left_size: 7,
</a><a href="#h8-0-14" id="h8-0-14" class="i">+                        right: Scan {
</a>                             table: &quot;studios&quot;,
                             alias: Some(
                                 &quot;s&quot;,
<a href="#h8-1" id="h8-1" class="h">@@ -213,15 +213,15 @@ Optimized plan: Plan(
</a>             source: Aggregation {
                 source: Projection {
                     source: NestedLoopJoin {
<a href="#h8-1-3" id="h8-1-3" class="d">-                        outer: Scan {
</a><a href="#h8-1-4" id="h8-1-4" class="i">+                        left: Scan {
</a>                             table: &quot;movies&quot;,
                             alias: Some(
                                 &quot;m&quot;,
                             ),
                             filter: None,
                         },
<a href="#h8-1-11" id="h8-1-11" class="d">-                        outer_size: 7,
</a><a href="#h8-1-12" id="h8-1-12" class="d">-                        inner: Scan {
</a><a href="#h8-1-13" id="h8-1-13" class="i">+                        left_size: 7,
</a><a href="#h8-1-14" id="h8-1-14" class="i">+                        right: Scan {
</a>                             table: &quot;studios&quot;,
                             alias: Some(
                                 &quot;s&quot;,
<b>diff --git a/<a id="h9" href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a> b/<a href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -26,13 +26,13 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h9-0-3" id="h9-0-3" class="d">-        outer: Scan {
</a><a href="#h9-0-4" id="h9-0-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h9-0-9" id="h9-0-9" class="d">-        outer_size: 7,
</a><a href="#h9-0-10" id="h9-0-10" class="d">-        inner: Scan {
</a><a href="#h9-0-11" id="h9-0-11" class="i">+        left_size: 7,
</a><a href="#h9-0-12" id="h9-0-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<a href="#h9-1" id="h9-1" class="h">@@ -45,13 +45,13 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h9-1-3" id="h9-1-3" class="d">-        outer: Scan {
</a><a href="#h9-1-4" id="h9-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h9-1-9" id="h9-1-9" class="d">-        outer_size: 7,
</a><a href="#h9-1-10" id="h9-1-10" class="d">-        inner: Scan {
</a><a href="#h9-1-11" id="h9-1-11" class="i">+        left_size: 7,
</a><a href="#h9-1-12" id="h9-1-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h10" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -155,16 +155,16 @@ Plan: Plan(
</a>     Projection {
         source: Filter {
             source: NestedLoopJoin {
<a href="#h10-0-3" id="h10-0-3" class="d">-                outer: NestedLoopJoin {
</a><a href="#h10-0-4" id="h10-0-4" class="d">-                    outer: Scan {
</a><a href="#h10-0-5" id="h10-0-5" class="i">+                left: NestedLoopJoin {
</a><a href="#h10-0-6" id="h10-0-6" class="i">+                    left: Scan {
</a>                         table: &quot;movies&quot;,
                         alias: Some(
                             &quot;m&quot;,
                         ),
                         filter: None,
                     },
<a href="#h10-0-13" id="h10-0-13" class="d">-                    outer_size: 7,
</a><a href="#h10-0-14" id="h10-0-14" class="d">-                    inner: Scan {
</a><a href="#h10-0-15" id="h10-0-15" class="i">+                    left_size: 7,
</a><a href="#h10-0-16" id="h10-0-16" class="i">+                    right: Scan {
</a>                         table: &quot;genres&quot;,
                         alias: Some(
                             &quot;g&quot;,
<a href="#h10-1" id="h10-1" class="h">@@ -175,8 +175,8 @@ Plan: Plan(
</a>                     pad: false,
                     flip: false,
                 },
<a href="#h10-1-3" id="h10-1-3" class="d">-                outer_size: 9,
</a><a href="#h10-1-4" id="h10-1-4" class="d">-                inner: Scan {
</a><a href="#h10-1-5" id="h10-1-5" class="i">+                left_size: 9,
</a><a href="#h10-1-6" id="h10-1-6" class="i">+                right: Scan {
</a>                     table: &quot;countries&quot;,
                     alias: Some(
                         &quot;c&quot;,
<a href="#h10-2" id="h10-2" class="h">@@ -360,8 +360,8 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h10-2-3" id="h10-2-3" class="d">-            outer: NestedLoopJoin {
</a><a href="#h10-2-4" id="h10-2-4" class="d">-                outer: Scan {
</a><a href="#h10-2-5" id="h10-2-5" class="i">+            left: NestedLoopJoin {
</a><a href="#h10-2-6" id="h10-2-6" class="i">+                left: Scan {
</a>                     table: &quot;movies&quot;,
                     alias: Some(
                         &quot;m&quot;,
<a href="#h10-3" id="h10-3" class="h">@@ -407,8 +407,8 @@ Optimized plan: Plan(
</a>                         ),
                     ),
                 },
<a href="#h10-3-3" id="h10-3-3" class="d">-                outer_size: 7,
</a><a href="#h10-3-4" id="h10-3-4" class="d">-                inner: KeyLookup {
</a><a href="#h10-3-5" id="h10-3-5" class="i">+                left_size: 7,
</a><a href="#h10-3-6" id="h10-3-6" class="i">+                right: KeyLookup {
</a>                     table: &quot;genres&quot;,
                     alias: Some(
                         &quot;g&quot;,
<a href="#h10-4" id="h10-4" class="h">@@ -423,8 +423,8 @@ Optimized plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h10-4-3" id="h10-4-3" class="d">-            outer_size: 9,
</a><a href="#h10-4-4" id="h10-4-4" class="d">-            inner: Scan {
</a><a href="#h10-4-5" id="h10-4-5" class="i">+            left_size: 9,
</a><a href="#h10-4-6" id="h10-4-6" class="i">+            right: Scan {
</a>                 table: &quot;countries&quot;,
                 alias: Some(
                     &quot;c&quot;,
<b>diff --git a/<a id="h11" href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a> b/<a href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -42,15 +42,15 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h11-0-3" id="h11-0-3" class="d">-        outer: NestedLoopJoin {
</a><a href="#h11-0-4" id="h11-0-4" class="d">-            outer: NestedLoopJoin {
</a><a href="#h11-0-5" id="h11-0-5" class="d">-                outer: Scan {
</a><a href="#h11-0-6" id="h11-0-6" class="i">+        left: NestedLoopJoin {
</a><a href="#h11-0-7" id="h11-0-7" class="i">+            left: NestedLoopJoin {
</a><a href="#h11-0-8" id="h11-0-8" class="i">+                left: Scan {
</a>                     table: &quot;movies&quot;,
                     alias: None,
                     filter: None,
                 },
<a href="#h11-0-13" id="h11-0-13" class="d">-                outer_size: 7,
</a><a href="#h11-0-14" id="h11-0-14" class="d">-                inner: Scan {
</a><a href="#h11-0-15" id="h11-0-15" class="i">+                left_size: 7,
</a><a href="#h11-0-16" id="h11-0-16" class="i">+                right: Scan {
</a>                     table: &quot;genres&quot;,
                     alias: None,
                     filter: None,
<a href="#h11-1" id="h11-1" class="h">@@ -59,8 +59,8 @@ Plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h11-1-3" id="h11-1-3" class="d">-            outer_size: 9,
</a><a href="#h11-1-4" id="h11-1-4" class="d">-            inner: Scan {
</a><a href="#h11-1-5" id="h11-1-5" class="i">+            left_size: 9,
</a><a href="#h11-1-6" id="h11-1-6" class="i">+            right: Scan {
</a>                 table: &quot;countries&quot;,
                 alias: None,
                 filter: None,
<a href="#h11-2" id="h11-2" class="h">@@ -69,8 +69,8 @@ Plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h11-2-3" id="h11-2-3" class="d">-        outer_size: 11,
</a><a href="#h11-2-4" id="h11-2-4" class="d">-        inner: Scan {
</a><a href="#h11-2-5" id="h11-2-5" class="i">+        left_size: 11,
</a><a href="#h11-2-6" id="h11-2-6" class="i">+        right: Scan {
</a>             table: &quot;studios&quot;,
             alias: None,
             filter: None,
<a href="#h11-3" id="h11-3" class="h">@@ -83,15 +83,15 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h11-3-3" id="h11-3-3" class="d">-        outer: NestedLoopJoin {
</a><a href="#h11-3-4" id="h11-3-4" class="d">-            outer: NestedLoopJoin {
</a><a href="#h11-3-5" id="h11-3-5" class="d">-                outer: Scan {
</a><a href="#h11-3-6" id="h11-3-6" class="i">+        left: NestedLoopJoin {
</a><a href="#h11-3-7" id="h11-3-7" class="i">+            left: NestedLoopJoin {
</a><a href="#h11-3-8" id="h11-3-8" class="i">+                left: Scan {
</a>                     table: &quot;movies&quot;,
                     alias: None,
                     filter: None,
                 },
<a href="#h11-3-13" id="h11-3-13" class="d">-                outer_size: 7,
</a><a href="#h11-3-14" id="h11-3-14" class="d">-                inner: Scan {
</a><a href="#h11-3-15" id="h11-3-15" class="i">+                left_size: 7,
</a><a href="#h11-3-16" id="h11-3-16" class="i">+                right: Scan {
</a>                     table: &quot;genres&quot;,
                     alias: None,
                     filter: None,
<a href="#h11-4" id="h11-4" class="h">@@ -100,8 +100,8 @@ Optimized plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h11-4-3" id="h11-4-3" class="d">-            outer_size: 9,
</a><a href="#h11-4-4" id="h11-4-4" class="d">-            inner: Scan {
</a><a href="#h11-4-5" id="h11-4-5" class="i">+            left_size: 9,
</a><a href="#h11-4-6" id="h11-4-6" class="i">+            right: Scan {
</a>                 table: &quot;countries&quot;,
                 alias: None,
                 filter: None,
<a href="#h11-5" id="h11-5" class="h">@@ -110,8 +110,8 @@ Optimized plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h11-5-3" id="h11-5-3" class="d">-        outer_size: 11,
</a><a href="#h11-5-4" id="h11-5-4" class="d">-        inner: Scan {
</a><a href="#h11-5-5" id="h11-5-5" class="i">+        left_size: 11,
</a><a href="#h11-5-6" id="h11-5-6" class="i">+        right: Scan {
</a>             table: &quot;studios&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h12" href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a> b/<a href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -43,13 +43,13 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h12-0-3" id="h12-0-3" class="d">-        outer: Scan {
</a><a href="#h12-0-4" id="h12-0-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h12-0-9" id="h12-0-9" class="d">-        outer_size: 7,
</a><a href="#h12-0-10" id="h12-0-10" class="d">-        inner: Scan {
</a><a href="#h12-0-11" id="h12-0-11" class="i">+        left_size: 7,
</a><a href="#h12-0-12" id="h12-0-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<a href="#h12-1" id="h12-1" class="h">@@ -87,13 +87,13 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h12-1-3" id="h12-1-3" class="d">-        outer: Scan {
</a><a href="#h12-1-4" id="h12-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h12-1-9" id="h12-1-9" class="d">-        outer_size: 7,
</a><a href="#h12-1-10" id="h12-1-10" class="d">-        inner: Scan {
</a><a href="#h12-1-11" id="h12-1-11" class="i">+        left_size: 7,
</a><a href="#h12-1-12" id="h12-1-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a> b/<a href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -43,13 +43,13 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h13-0-3" id="h13-0-3" class="d">-        outer: Scan {
</a><a href="#h13-0-4" id="h13-0-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h13-0-9" id="h13-0-9" class="d">-        outer_size: 7,
</a><a href="#h13-0-10" id="h13-0-10" class="d">-        inner: Scan {
</a><a href="#h13-0-11" id="h13-0-11" class="i">+        left_size: 7,
</a><a href="#h13-0-12" id="h13-0-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<a href="#h13-1" id="h13-1" class="h">@@ -87,13 +87,13 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h13-1-3" id="h13-1-3" class="d">-        outer: Scan {
</a><a href="#h13-1-4" id="h13-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h13-1-9" id="h13-1-9" class="d">-        outer_size: 7,
</a><a href="#h13-1-10" id="h13-1-10" class="d">-        inner: Scan {
</a><a href="#h13-1-11" id="h13-1-11" class="i">+        left_size: 7,
</a><a href="#h13-1-12" id="h13-1-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h14" href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -66,15 +66,15 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h14-0-3" id="h14-0-3" class="d">-        outer: Scan {
</a><a href="#h14-0-4" id="h14-0-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: Some(
                 &quot;m&quot;,
             ),
             filter: None,
         },
<a href="#h14-0-11" id="h14-0-11" class="d">-        outer_size: 7,
</a><a href="#h14-0-12" id="h14-0-12" class="d">-        inner: Scan {
</a><a href="#h14-0-13" id="h14-0-13" class="i">+        left_size: 7,
</a><a href="#h14-0-14" id="h14-0-14" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: Some(
                 &quot;g&quot;,
<a href="#h14-1" id="h14-1" class="h">@@ -134,7 +134,7 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h14-1-3" id="h14-1-3" class="d">-        outer: IndexLookup {
</a><a href="#h14-1-4" id="h14-1-4" class="i">+        left: IndexLookup {
</a>             table: &quot;movies&quot;,
             alias: Some(
                 &quot;m&quot;,
<a href="#h14-2" id="h14-2" class="h">@@ -146,8 +146,8 @@ Optimized plan: Plan(
</a>                 ),
             ],
         },
<a href="#h14-2-3" id="h14-2-3" class="d">-        outer_size: 7,
</a><a href="#h14-2-4" id="h14-2-4" class="d">-        inner: KeyLookup {
</a><a href="#h14-2-5" id="h14-2-5" class="i">+        left_size: 7,
</a><a href="#h14-2-6" id="h14-2-6" class="i">+        right: KeyLookup {
</a>             table: &quot;genres&quot;,
             alias: Some(
                 &quot;g&quot;,
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -64,15 +64,15 @@ AST: Select {
</a> Plan: Plan(
     Filter {
         source: NestedLoopJoin {
<a href="#h15-0-3" id="h15-0-3" class="d">-            outer: Scan {
</a><a href="#h15-0-4" id="h15-0-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h15-0-11" id="h15-0-11" class="d">-            outer_size: 7,
</a><a href="#h15-0-12" id="h15-0-12" class="d">-            inner: Scan {
</a><a href="#h15-0-13" id="h15-0-13" class="i">+            left_size: 7,
</a><a href="#h15-0-14" id="h15-0-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<a href="#h15-1" id="h15-1" class="h">@@ -131,7 +131,7 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h15-1-3" id="h15-1-3" class="d">-        outer: IndexLookup {
</a><a href="#h15-1-4" id="h15-1-4" class="i">+        left: IndexLookup {
</a>             table: &quot;movies&quot;,
             alias: Some(
                 &quot;m&quot;,
<a href="#h15-2" id="h15-2" class="h">@@ -143,8 +143,8 @@ Optimized plan: Plan(
</a>                 ),
             ],
         },
<a href="#h15-2-3" id="h15-2-3" class="d">-        outer_size: 7,
</a><a href="#h15-2-4" id="h15-2-4" class="d">-        inner: KeyLookup {
</a><a href="#h15-2-5" id="h15-2-5" class="i">+        left_size: 7,
</a><a href="#h15-2-6" id="h15-2-6" class="i">+        right: KeyLookup {
</a>             table: &quot;genres&quot;,
             alias: Some(
                 &quot;g&quot;,
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a> b/<a href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -105,14 +105,14 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h16-0-3" id="h16-0-3" class="d">-            outer: NestedLoopJoin {
</a><a href="#h16-0-4" id="h16-0-4" class="d">-                outer: Scan {
</a><a href="#h16-0-5" id="h16-0-5" class="i">+            left: NestedLoopJoin {
</a><a href="#h16-0-6" id="h16-0-6" class="i">+                left: Scan {
</a>                     table: &quot;movies&quot;,
                     alias: None,
                     filter: None,
                 },
<a href="#h16-0-11" id="h16-0-11" class="d">-                outer_size: 7,
</a><a href="#h16-0-12" id="h16-0-12" class="d">-                inner: Scan {
</a><a href="#h16-0-13" id="h16-0-13" class="i">+                left_size: 7,
</a><a href="#h16-0-14" id="h16-0-14" class="i">+                right: Scan {
</a>                     table: &quot;genres&quot;,
                     alias: None,
                     filter: None,
<a href="#h16-1" id="h16-1" class="h">@@ -146,8 +146,8 @@ Plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h16-1-3" id="h16-1-3" class="d">-            outer_size: 9,
</a><a href="#h16-1-4" id="h16-1-4" class="d">-            inner: Scan {
</a><a href="#h16-1-5" id="h16-1-5" class="i">+            left_size: 9,
</a><a href="#h16-1-6" id="h16-1-6" class="i">+            right: Scan {
</a>                 table: &quot;studios&quot;,
                 alias: None,
                 filter: None,
<a href="#h16-2" id="h16-2" class="h">@@ -235,14 +235,14 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h16-2-3" id="h16-2-3" class="d">-            outer: NestedLoopJoin {
</a><a href="#h16-2-4" id="h16-2-4" class="d">-                outer: Scan {
</a><a href="#h16-2-5" id="h16-2-5" class="i">+            left: NestedLoopJoin {
</a><a href="#h16-2-6" id="h16-2-6" class="i">+                left: Scan {
</a>                     table: &quot;movies&quot;,
                     alias: None,
                     filter: None,
                 },
<a href="#h16-2-11" id="h16-2-11" class="d">-                outer_size: 7,
</a><a href="#h16-2-12" id="h16-2-12" class="d">-                inner: Scan {
</a><a href="#h16-2-13" id="h16-2-13" class="i">+                left_size: 7,
</a><a href="#h16-2-14" id="h16-2-14" class="i">+                right: Scan {
</a>                     table: &quot;genres&quot;,
                     alias: None,
                     filter: None,
<a href="#h16-3" id="h16-3" class="h">@@ -276,8 +276,8 @@ Optimized plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h16-3-3" id="h16-3-3" class="d">-            outer_size: 9,
</a><a href="#h16-3-4" id="h16-3-4" class="d">-            inner: Scan {
</a><a href="#h16-3-5" id="h16-3-5" class="i">+            left_size: 9,
</a><a href="#h16-3-6" id="h16-3-6" class="i">+            right: Scan {
</a>                 table: &quot;studios&quot;,
                 alias: None,
                 filter: None,
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -161,16 +161,16 @@ Plan: Plan(
</a>     Order {
         source: Projection {
             source: NestedLoopJoin {
<a href="#h17-0-3" id="h17-0-3" class="d">-                outer: NestedLoopJoin {
</a><a href="#h17-0-4" id="h17-0-4" class="d">-                    outer: Scan {
</a><a href="#h17-0-5" id="h17-0-5" class="i">+                left: NestedLoopJoin {
</a><a href="#h17-0-6" id="h17-0-6" class="i">+                    left: Scan {
</a>                         table: &quot;movies&quot;,
                         alias: Some(
                             &quot;m&quot;,
                         ),
                         filter: None,
                     },
<a href="#h17-0-13" id="h17-0-13" class="d">-                    outer_size: 7,
</a><a href="#h17-0-14" id="h17-0-14" class="d">-                    inner: Scan {
</a><a href="#h17-0-15" id="h17-0-15" class="i">+                    left_size: 7,
</a><a href="#h17-0-16" id="h17-0-16" class="i">+                    right: Scan {
</a>                         table: &quot;genres&quot;,
                         alias: Some(
                             &quot;g&quot;,
<a href="#h17-1" id="h17-1" class="h">@@ -226,8 +226,8 @@ Plan: Plan(
</a>                     pad: false,
                     flip: false,
                 },
<a href="#h17-1-3" id="h17-1-3" class="d">-                outer_size: 9,
</a><a href="#h17-1-4" id="h17-1-4" class="d">-                inner: Scan {
</a><a href="#h17-1-5" id="h17-1-5" class="i">+                left_size: 9,
</a><a href="#h17-1-6" id="h17-1-6" class="i">+                right: Scan {
</a>                     table: &quot;studios&quot;,
                     alias: Some(
                         &quot;s&quot;,
<a href="#h17-2" id="h17-2" class="h">@@ -355,8 +355,8 @@ Optimized plan: Plan(
</a>     Order {
         source: Projection {
             source: NestedLoopJoin {
<a href="#h17-2-3" id="h17-2-3" class="d">-                outer: NestedLoopJoin {
</a><a href="#h17-2-4" id="h17-2-4" class="d">-                    outer: Filter {
</a><a href="#h17-2-5" id="h17-2-5" class="i">+                left: NestedLoopJoin {
</a><a href="#h17-2-6" id="h17-2-6" class="i">+                    left: Filter {
</a>                         source: IndexLookup {
                             table: &quot;movies&quot;,
                             alias: Some(
<a href="#h17-3" id="h17-3" class="h">@@ -388,8 +388,8 @@ Optimized plan: Plan(
</a>                             ),
                         ),
                     },
<a href="#h17-3-3" id="h17-3-3" class="d">-                    outer_size: 7,
</a><a href="#h17-3-4" id="h17-3-4" class="d">-                    inner: KeyLookup {
</a><a href="#h17-3-5" id="h17-3-5" class="i">+                    left_size: 7,
</a><a href="#h17-3-6" id="h17-3-6" class="i">+                    right: KeyLookup {
</a>                         table: &quot;genres&quot;,
                         alias: Some(
                             &quot;g&quot;,
<a href="#h17-4" id="h17-4" class="h">@@ -429,8 +429,8 @@ Optimized plan: Plan(
</a>                     pad: false,
                     flip: false,
                 },
<a href="#h17-4-3" id="h17-4-3" class="d">-                outer_size: 9,
</a><a href="#h17-4-4" id="h17-4-4" class="d">-                inner: KeyLookup {
</a><a href="#h17-4-5" id="h17-4-5" class="i">+                left_size: 9,
</a><a href="#h17-4-6" id="h17-4-6" class="i">+                right: KeyLookup {
</a>                     table: &quot;studios&quot;,
                     alias: Some(
                         &quot;s&quot;,
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a> b/<a href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -47,15 +47,15 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h18-0-3" id="h18-0-3" class="d">-        outer: Scan {
</a><a href="#h18-0-4" id="h18-0-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: Some(
                 &quot;m&quot;,
             ),
             filter: None,
         },
<a href="#h18-0-11" id="h18-0-11" class="d">-        outer_size: 7,
</a><a href="#h18-0-12" id="h18-0-12" class="d">-        inner: Scan {
</a><a href="#h18-0-13" id="h18-0-13" class="i">+        left_size: 7,
</a><a href="#h18-0-14" id="h18-0-14" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: Some(
                 &quot;g&quot;,
<a href="#h18-1" id="h18-1" class="h">@@ -95,15 +95,15 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h18-1-3" id="h18-1-3" class="d">-        outer: Scan {
</a><a href="#h18-1-4" id="h18-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: Some(
                 &quot;m&quot;,
             ),
             filter: None,
         },
<a href="#h18-1-11" id="h18-1-11" class="d">-        outer_size: 7,
</a><a href="#h18-1-12" id="h18-1-12" class="d">-        inner: Scan {
</a><a href="#h18-1-13" id="h18-1-13" class="i">+        left_size: 7,
</a><a href="#h18-1-14" id="h18-1-14" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: Some(
                 &quot;g&quot;,
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a> b/<a href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -32,13 +32,13 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h19-0-3" id="h19-0-3" class="d">-        outer: Scan {
</a><a href="#h19-0-4" id="h19-0-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h19-0-9" id="h19-0-9" class="d">-        outer_size: 7,
</a><a href="#h19-0-10" id="h19-0-10" class="d">-        inner: Scan {
</a><a href="#h19-0-11" id="h19-0-11" class="i">+        left_size: 7,
</a><a href="#h19-0-12" id="h19-0-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<a href="#h19-1" id="h19-1" class="h">@@ -57,7 +57,7 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h19-1-3" id="h19-1-3" class="d">-        outer: Scan {
</a><a href="#h19-1-4" id="h19-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: Some(
<a href="#h19-2" id="h19-2" class="h">@@ -68,8 +68,8 @@ Optimized plan: Plan(
</a>                 ),
             ),
         },
<a href="#h19-2-3" id="h19-2-3" class="d">-        outer_size: 7,
</a><a href="#h19-2-4" id="h19-2-4" class="d">-        inner: Scan {
</a><a href="#h19-2-5" id="h19-2-5" class="i">+        left_size: 7,
</a><a href="#h19-2-6" id="h19-2-6" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a> b/<a href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -63,13 +63,13 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h20-0-3" id="h20-0-3" class="d">-        outer: Scan {
</a><a href="#h20-0-4" id="h20-0-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h20-0-9" id="h20-0-9" class="d">-        outer_size: 7,
</a><a href="#h20-0-10" id="h20-0-10" class="d">-        inner: Scan {
</a><a href="#h20-0-11" id="h20-0-11" class="i">+        left_size: 7,
</a><a href="#h20-0-12" id="h20-0-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<a href="#h20-1" id="h20-1" class="h">@@ -133,13 +133,13 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h20-1-3" id="h20-1-3" class="d">-        outer: Scan {
</a><a href="#h20-1-4" id="h20-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h20-1-9" id="h20-1-9" class="d">-        outer_size: 7,
</a><a href="#h20-1-10" id="h20-1-10" class="d">-        inner: Scan {
</a><a href="#h20-1-11" id="h20-1-11" class="i">+        left_size: 7,
</a><a href="#h20-1-12" id="h20-1-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a> b/<a href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -32,13 +32,13 @@ AST: Select {
</a> 
 Plan: Plan(
     NestedLoopJoin {
<a href="#h21-0-3" id="h21-0-3" class="d">-        outer: Scan {
</a><a href="#h21-0-4" id="h21-0-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h21-0-9" id="h21-0-9" class="d">-        outer_size: 7,
</a><a href="#h21-0-10" id="h21-0-10" class="d">-        inner: Scan {
</a><a href="#h21-0-11" id="h21-0-11" class="i">+        left_size: 7,
</a><a href="#h21-0-12" id="h21-0-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<a href="#h21-1" id="h21-1" class="h">@@ -57,7 +57,7 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h21-1-3" id="h21-1-3" class="d">-        outer: Scan {
</a><a href="#h21-1-4" id="h21-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: Some(
<a href="#h21-2" id="h21-2" class="h">@@ -68,8 +68,8 @@ Optimized plan: Plan(
</a>                 ),
             ),
         },
<a href="#h21-2-3" id="h21-2-3" class="d">-        outer_size: 7,
</a><a href="#h21-2-4" id="h21-2-4" class="d">-        inner: Scan {
</a><a href="#h21-2-5" id="h21-2-5" class="i">+        left_size: 7,
</a><a href="#h21-2-6" id="h21-2-6" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h22" href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a> b/<a href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -60,13 +60,13 @@ AST: Select {
</a> Plan: Plan(
     Filter {
         source: NestedLoopJoin {
<a href="#h22-0-3" id="h22-0-3" class="d">-            outer: Scan {
</a><a href="#h22-0-4" id="h22-0-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: None,
                 filter: None,
             },
<a href="#h22-0-9" id="h22-0-9" class="d">-            outer_size: 7,
</a><a href="#h22-0-10" id="h22-0-10" class="d">-            inner: Scan {
</a><a href="#h22-0-11" id="h22-0-11" class="i">+            left_size: 7,
</a><a href="#h22-0-12" id="h22-0-12" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: None,
                 filter: None,
<a href="#h22-1" id="h22-1" class="h">@@ -143,7 +143,7 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h22-1-3" id="h22-1-3" class="d">-        outer: Scan {
</a><a href="#h22-1-4" id="h22-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: Some(
<a href="#h22-2" id="h22-2" class="h">@@ -187,8 +187,8 @@ Optimized plan: Plan(
</a>                 ),
             ),
         },
<a href="#h22-2-3" id="h22-2-3" class="d">-        outer_size: 7,
</a><a href="#h22-2-4" id="h22-2-4" class="d">-        inner: Scan {
</a><a href="#h22-2-5" id="h22-2-5" class="i">+        left_size: 7,
</a><a href="#h22-2-6" id="h22-2-6" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a> b/<a href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -71,15 +71,15 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h23-0-3" id="h23-0-3" class="d">-            outer: Scan {
</a><a href="#h23-0-4" id="h23-0-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h23-0-11" id="h23-0-11" class="d">-            outer_size: 7,
</a><a href="#h23-0-12" id="h23-0-12" class="d">-            inner: Scan {
</a><a href="#h23-0-13" id="h23-0-13" class="i">+            left_size: 7,
</a><a href="#h23-0-14" id="h23-0-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<a href="#h23-1" id="h23-1" class="h">@@ -155,15 +155,15 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h23-1-3" id="h23-1-3" class="d">-            outer: Scan {
</a><a href="#h23-1-4" id="h23-1-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h23-1-11" id="h23-1-11" class="d">-            outer_size: 7,
</a><a href="#h23-1-12" id="h23-1-12" class="d">-            inner: Scan {
</a><a href="#h23-1-13" id="h23-1-13" class="i">+            left_size: 7,
</a><a href="#h23-1-14" id="h23-1-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a> b/<a href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -71,15 +71,15 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h24-0-3" id="h24-0-3" class="d">-            outer: Scan {
</a><a href="#h24-0-4" id="h24-0-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h24-0-11" id="h24-0-11" class="d">-            outer_size: 7,
</a><a href="#h24-0-12" id="h24-0-12" class="d">-            inner: Scan {
</a><a href="#h24-0-13" id="h24-0-13" class="i">+            left_size: 7,
</a><a href="#h24-0-14" id="h24-0-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<a href="#h24-1" id="h24-1" class="h">@@ -155,15 +155,15 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h24-1-3" id="h24-1-3" class="d">-            outer: Scan {
</a><a href="#h24-1-4" id="h24-1-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h24-1-11" id="h24-1-11" class="d">-            outer_size: 7,
</a><a href="#h24-1-12" id="h24-1-12" class="d">-            inner: Scan {
</a><a href="#h24-1-13" id="h24-1-13" class="i">+            left_size: 7,
</a><a href="#h24-1-14" id="h24-1-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a> b/<a href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -71,15 +71,15 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h25-0-3" id="h25-0-3" class="d">-            outer: Scan {
</a><a href="#h25-0-4" id="h25-0-4" class="i">+            left: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
                 ),
                 filter: None,
             },
<a href="#h25-0-11" id="h25-0-11" class="d">-            outer_size: 2,
</a><a href="#h25-0-12" id="h25-0-12" class="d">-            inner: Scan {
</a><a href="#h25-0-13" id="h25-0-13" class="i">+            left_size: 2,
</a><a href="#h25-0-14" id="h25-0-14" class="i">+            right: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
<a href="#h25-1" id="h25-1" class="h">@@ -155,15 +155,15 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h25-1-3" id="h25-1-3" class="d">-            outer: Scan {
</a><a href="#h25-1-4" id="h25-1-4" class="i">+            left: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
                 ),
                 filter: None,
             },
<a href="#h25-1-11" id="h25-1-11" class="d">-            outer_size: 2,
</a><a href="#h25-1-12" id="h25-1-12" class="d">-            inner: Scan {
</a><a href="#h25-1-13" id="h25-1-13" class="i">+            left_size: 2,
</a><a href="#h25-1-14" id="h25-1-14" class="i">+            right: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a> b/<a href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -71,15 +71,15 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h26-0-3" id="h26-0-3" class="d">-            outer: Scan {
</a><a href="#h26-0-4" id="h26-0-4" class="i">+            left: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
                 ),
                 filter: None,
             },
<a href="#h26-0-11" id="h26-0-11" class="d">-            outer_size: 2,
</a><a href="#h26-0-12" id="h26-0-12" class="d">-            inner: Scan {
</a><a href="#h26-0-13" id="h26-0-13" class="i">+            left_size: 2,
</a><a href="#h26-0-14" id="h26-0-14" class="i">+            right: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
<a href="#h26-1" id="h26-1" class="h">@@ -155,15 +155,15 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h26-1-3" id="h26-1-3" class="d">-            outer: Scan {
</a><a href="#h26-1-4" id="h26-1-4" class="i">+            left: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
                 ),
                 filter: None,
             },
<a href="#h26-1-11" id="h26-1-11" class="d">-            outer_size: 2,
</a><a href="#h26-1-12" id="h26-1-12" class="d">-            inner: Scan {
</a><a href="#h26-1-13" id="h26-1-13" class="i">+            left_size: 2,
</a><a href="#h26-1-14" id="h26-1-14" class="i">+            right: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a> b/<a href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -71,15 +71,15 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h27-0-3" id="h27-0-3" class="d">-            outer: Scan {
</a><a href="#h27-0-4" id="h27-0-4" class="i">+            left: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
                 ),
                 filter: None,
             },
<a href="#h27-0-11" id="h27-0-11" class="d">-            outer_size: 2,
</a><a href="#h27-0-12" id="h27-0-12" class="d">-            inner: Scan {
</a><a href="#h27-0-13" id="h27-0-13" class="i">+            left_size: 2,
</a><a href="#h27-0-14" id="h27-0-14" class="i">+            right: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
<a href="#h27-1" id="h27-1" class="h">@@ -155,15 +155,15 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h27-1-3" id="h27-1-3" class="d">-            outer: Scan {
</a><a href="#h27-1-4" id="h27-1-4" class="i">+            left: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
                 ),
                 filter: None,
             },
<a href="#h27-1-11" id="h27-1-11" class="d">-            outer_size: 2,
</a><a href="#h27-1-12" id="h27-1-12" class="d">-            inner: Scan {
</a><a href="#h27-1-13" id="h27-1-13" class="i">+            left_size: 2,
</a><a href="#h27-1-14" id="h27-1-14" class="i">+            right: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a> b/<a href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -71,15 +71,15 @@ AST: Select {
</a> Plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h28-0-3" id="h28-0-3" class="d">-            outer: Scan {
</a><a href="#h28-0-4" id="h28-0-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h28-0-11" id="h28-0-11" class="d">-            outer_size: 7,
</a><a href="#h28-0-12" id="h28-0-12" class="d">-            inner: Scan {
</a><a href="#h28-0-13" id="h28-0-13" class="i">+            left_size: 7,
</a><a href="#h28-0-14" id="h28-0-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<a href="#h28-1" id="h28-1" class="h">@@ -155,15 +155,15 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h28-1-3" id="h28-1-3" class="d">-            outer: Scan {
</a><a href="#h28-1-4" id="h28-1-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
                 ),
                 filter: None,
             },
<a href="#h28-1-11" id="h28-1-11" class="d">-            outer_size: 7,
</a><a href="#h28-1-12" id="h28-1-12" class="d">-            inner: Scan {
</a><a href="#h28-1-13" id="h28-1-13" class="i">+            left_size: 7,
</a><a href="#h28-1-14" id="h28-1-14" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -85,13 +85,13 @@ Plan: Plan(
</a>         source: Projection {
             source: Filter {
                 source: NestedLoopJoin {
<a href="#h29-0-3" id="h29-0-3" class="d">-                    outer: Scan {
</a><a href="#h29-0-4" id="h29-0-4" class="i">+                    left: Scan {
</a>                         table: &quot;movies&quot;,
                         alias: None,
                         filter: None,
                     },
<a href="#h29-0-9" id="h29-0-9" class="d">-                    outer_size: 7,
</a><a href="#h29-0-10" id="h29-0-10" class="d">-                    inner: Scan {
</a><a href="#h29-0-11" id="h29-0-11" class="i">+                    left_size: 7,
</a><a href="#h29-0-12" id="h29-0-12" class="i">+                    right: Scan {
</a>                         table: &quot;genres&quot;,
                         alias: None,
                         filter: None,
<a href="#h29-1" id="h29-1" class="h">@@ -205,13 +205,13 @@ Optimized plan: Plan(
</a>     Order {
         source: Projection {
             source: NestedLoopJoin {
<a href="#h29-1-3" id="h29-1-3" class="d">-                outer: Scan {
</a><a href="#h29-1-4" id="h29-1-4" class="i">+                left: Scan {
</a>                     table: &quot;movies&quot;,
                     alias: None,
                     filter: None,
                 },
<a href="#h29-1-9" id="h29-1-9" class="d">-                outer_size: 7,
</a><a href="#h29-1-10" id="h29-1-10" class="d">-                inner: Scan {
</a><a href="#h29-1-11" id="h29-1-11" class="i">+                left_size: 7,
</a><a href="#h29-1-12" id="h29-1-12" class="i">+                right: Scan {
</a>                     table: &quot;genres&quot;,
                     alias: None,
                     filter: None,
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -86,13 +86,13 @@ Plan: Plan(
</a>             source: Projection {
                 source: Filter {
                     source: NestedLoopJoin {
<a href="#h30-0-3" id="h30-0-3" class="d">-                        outer: Scan {
</a><a href="#h30-0-4" id="h30-0-4" class="i">+                        left: Scan {
</a>                             table: &quot;movies&quot;,
                             alias: None,
                             filter: None,
                         },
<a href="#h30-0-9" id="h30-0-9" class="d">-                        outer_size: 7,
</a><a href="#h30-0-10" id="h30-0-10" class="d">-                        inner: Scan {
</a><a href="#h30-0-11" id="h30-0-11" class="i">+                        left_size: 7,
</a><a href="#h30-0-12" id="h30-0-12" class="i">+                        right: Scan {
</a>                             table: &quot;genres&quot;,
                             alias: None,
                             filter: None,
<a href="#h30-1" id="h30-1" class="h">@@ -257,13 +257,13 @@ Optimized plan: Plan(
</a>         source: Order {
             source: Projection {
                 source: NestedLoopJoin {
<a href="#h30-1-3" id="h30-1-3" class="d">-                    outer: Scan {
</a><a href="#h30-1-4" id="h30-1-4" class="i">+                    left: Scan {
</a>                         table: &quot;movies&quot;,
                         alias: None,
                         filter: None,
                     },
<a href="#h30-1-9" id="h30-1-9" class="d">-                    outer_size: 7,
</a><a href="#h30-1-10" id="h30-1-10" class="d">-                    inner: Scan {
</a><a href="#h30-1-11" id="h30-1-11" class="i">+                    left_size: 7,
</a><a href="#h30-1-12" id="h30-1-12" class="i">+                    right: Scan {
</a>                         table: &quot;genres&quot;,
                         alias: None,
                         filter: None,
<b>diff --git a/<a id="h31" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -82,15 +82,15 @@ Plan: Plan(
</a>     Projection {
         source: Filter {
             source: NestedLoopJoin {
<a href="#h31-0-3" id="h31-0-3" class="d">-                outer: Scan {
</a><a href="#h31-0-4" id="h31-0-4" class="i">+                left: Scan {
</a>                     table: &quot;movies&quot;,
                     alias: Some(
                         &quot;m&quot;,
                     ),
                     filter: None,
                 },
<a href="#h31-0-11" id="h31-0-11" class="d">-                outer_size: 7,
</a><a href="#h31-0-12" id="h31-0-12" class="d">-                inner: Scan {
</a><a href="#h31-0-13" id="h31-0-13" class="i">+                left_size: 7,
</a><a href="#h31-0-14" id="h31-0-14" class="i">+                right: Scan {
</a>                     table: &quot;genres&quot;,
                     alias: Some(
                         &quot;g&quot;,
<a href="#h31-1" id="h31-1" class="h">@@ -196,7 +196,7 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h31-1-3" id="h31-1-3" class="d">-            outer: Scan {
</a><a href="#h31-1-4" id="h31-1-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: Some(
                     &quot;m&quot;,
<a href="#h31-2" id="h31-2" class="h">@@ -242,8 +242,8 @@ Optimized plan: Plan(
</a>                     ),
                 ),
             },
<a href="#h31-2-3" id="h31-2-3" class="d">-            outer_size: 7,
</a><a href="#h31-2-4" id="h31-2-4" class="d">-            inner: KeyLookup {
</a><a href="#h31-2-5" id="h31-2-5" class="i">+            left_size: 7,
</a><a href="#h31-2-6" id="h31-2-6" class="i">+            right: KeyLookup {
</a>                 table: &quot;genres&quot;,
                 alias: Some(
                     &quot;g&quot;,
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -78,13 +78,13 @@ Plan: Plan(
</a>     Projection {
         source: Filter {
             source: NestedLoopJoin {
<a href="#h32-0-3" id="h32-0-3" class="d">-                outer: Scan {
</a><a href="#h32-0-4" id="h32-0-4" class="i">+                left: Scan {
</a>                     table: &quot;movies&quot;,
                     alias: None,
                     filter: None,
                 },
<a href="#h32-0-9" id="h32-0-9" class="d">-                outer_size: 7,
</a><a href="#h32-0-10" id="h32-0-10" class="d">-                inner: Scan {
</a><a href="#h32-0-11" id="h32-0-11" class="i">+                left_size: 7,
</a><a href="#h32-0-12" id="h32-0-12" class="i">+                right: Scan {
</a>                     table: &quot;genres&quot;,
                     alias: None,
                     filter: None,
<a href="#h32-1" id="h32-1" class="h">@@ -188,7 +188,7 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Projection {
         source: NestedLoopJoin {
<a href="#h32-1-3" id="h32-1-3" class="d">-            outer: Scan {
</a><a href="#h32-1-4" id="h32-1-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: None,
                 filter: Some(
<a href="#h32-2" id="h32-2" class="h">@@ -232,8 +232,8 @@ Optimized plan: Plan(
</a>                     ),
                 ),
             },
<a href="#h32-2-3" id="h32-2-3" class="d">-            outer_size: 7,
</a><a href="#h32-2-4" id="h32-2-4" class="d">-            inner: KeyLookup {
</a><a href="#h32-2-5" id="h32-2-5" class="i">+            left_size: 7,
</a><a href="#h32-2-6" id="h32-2-6" class="i">+            right: KeyLookup {
</a>                 table: &quot;genres&quot;,
                 alias: None,
                 keys: [
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a> b/<a href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -40,13 +40,13 @@ AST: Select {
</a> Plan: Plan(
     Filter {
         source: NestedLoopJoin {
<a href="#h33-0-3" id="h33-0-3" class="d">-            outer: Scan {
</a><a href="#h33-0-4" id="h33-0-4" class="i">+            left: Scan {
</a>                 table: &quot;movies&quot;,
                 alias: None,
                 filter: None,
             },
<a href="#h33-0-9" id="h33-0-9" class="d">-            outer_size: 7,
</a><a href="#h33-0-10" id="h33-0-10" class="d">-            inner: Scan {
</a><a href="#h33-0-11" id="h33-0-11" class="i">+            left_size: 7,
</a><a href="#h33-0-12" id="h33-0-12" class="i">+            right: Scan {
</a>                 table: &quot;genres&quot;,
                 alias: None,
                 filter: None,
<a href="#h33-1" id="h33-1" class="h">@@ -84,13 +84,13 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     NestedLoopJoin {
<a href="#h33-1-3" id="h33-1-3" class="d">-        outer: Scan {
</a><a href="#h33-1-4" id="h33-1-4" class="i">+        left: Scan {
</a>             table: &quot;movies&quot;,
             alias: None,
             filter: None,
         },
<a href="#h33-1-9" id="h33-1-9" class="d">-        outer_size: 7,
</a><a href="#h33-1-10" id="h33-1-10" class="d">-        inner: Scan {
</a><a href="#h33-1-11" id="h33-1-11" class="i">+        left_size: 7,
</a><a href="#h33-1-12" id="h33-1-12" class="i">+        right: Scan {
</a>             table: &quot;genres&quot;,
             alias: None,
             filter: None,
</pre>
</div>
</body>
</html>
