<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: quote `Value::String` when formatting - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/1cbd5ad5495b137ea7a0cfdf12b0c394bbc377e4.html">1cbd5ad5495b137ea7a0cfdf12b0c394bbc377e4</a>
<b>parent</b> <a href="../commit/865e9c284bcc35e9f490e44b9815be6bb6506c3b.html">865e9c284bcc35e9f490e44b9815be6bb6506c3b</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sat, 20 Jul 2024 17:42:27 +0200

sql: quote `Value::String` when formatting

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/encoding/format.rs</a></td><td> | </td><td class="num">13</td><td><span class="i">+++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/testscripts/expressions/func_sqrt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/testscripts/expressions/op_compare_equal</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/testscripts/expressions/op_compare_greater</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/testscripts/expressions/op_compare_lesser</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/testscripts/expressions/op_logic_and</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/testscripts/expressions/op_logic_not</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/testscripts/expressions/op_logic_or</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/testscripts/expressions/op_math_add</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/testscripts/expressions/op_math_divide</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/testscripts/expressions/op_math_exponentiate</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/testscripts/expressions/op_math_factorial</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/sql/testscripts/expressions/op_math_identity</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/sql/testscripts/expressions/op_math_multiply</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">src/sql/testscripts/expressions/op_math_negate</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">src/sql/testscripts/expressions/op_math_remainder</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">src/sql/testscripts/expressions/op_math_subtract</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/sql/testscripts/expressions/op_precedence</a></td><td> | </td><td class="num">28</td><td><span class="i">++++++++++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">src/sql/testscripts/expressions/op_string_like</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">src/sql/testscripts/optimizer/fold_constants</a></td><td> | </td><td class="num">50</td><td><span class="i">+++++++++++++++++++++++++</span><span class="d">-------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">src/sql/testscripts/optimizer/index_lookup</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">src/sql/testscripts/optimizer/join_type</a></td><td> | </td><td class="num">34</td><td><span class="i">+++++++++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">src/sql/testscripts/optimizer/push_filters</a></td><td> | </td><td class="num">68</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">src/sql/testscripts/optimizer/short_circuit</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">src/sql/testscripts/queries/aggregate</a></td><td> | </td><td class="num">22</td><td><span class="i">+++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">src/sql/testscripts/queries/group_by</a></td><td> | </td><td class="num">60</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d">------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">src/sql/testscripts/queries/having</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">src/sql/testscripts/queries/join_cross</a></td><td> | </td><td class="num">1074</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">src/sql/testscripts/queries/join_inner</a></td><td> | </td><td class="num">292</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">src/sql/testscripts/queries/join_outer</a></td><td> | </td><td class="num">158</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">src/sql/testscripts/queries/limit</a></td><td> | </td><td class="num">30</td><td><span class="i">+++++++++++++++</span><span class="d">---------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">src/sql/testscripts/queries/offset</a></td><td> | </td><td class="num">18</td><td><span class="i">+++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">src/sql/testscripts/queries/order</a></td><td> | </td><td class="num">188</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">src/sql/testscripts/queries/select</a></td><td> | </td><td class="num">34</td><td><span class="i">+++++++++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">src/sql/testscripts/queries/where_</a></td><td> | </td><td class="num">32</td><td><span class="i">++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">src/sql/testscripts/queries/where_index</a></td><td> | </td><td class="num">78</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">src/sql/testscripts/queries/where_primary_key</a></td><td> | </td><td class="num">26</td><td><span class="i">+++++++++++++</span><span class="d">-------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">src/sql/testscripts/schema/create_table_default</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">src/sql/testscripts/schema/create_table_reference</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">src/sql/testscripts/schema/drop_table</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">src/sql/testscripts/schema/drop_table_index</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">src/sql/testscripts/schema/drop_table_transaction</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">src/sql/testscripts/writes/delete</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">src/sql/testscripts/writes/delete_index</a></td><td> | </td><td class="num">28</td><td><span class="i">++++++++++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">src/sql/testscripts/writes/delete_reference</a></td><td> | </td><td class="num">54</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d">---------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">src/sql/testscripts/writes/delete_where</a></td><td> | </td><td class="num">34</td><td><span class="i">+++++++++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">src/sql/testscripts/writes/insert</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">src/sql/testscripts/writes/insert_datatypes</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">src/sql/testscripts/writes/insert_default</a></td><td> | </td><td class="num">34</td><td><span class="i">+++++++++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">src/sql/testscripts/writes/insert_index</a></td><td> | </td><td class="num">54</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d">---------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">src/sql/testscripts/writes/insert_null</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">src/sql/testscripts/writes/insert_primary_key</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">src/sql/testscripts/writes/insert_reference</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">src/sql/testscripts/writes/insert_unique</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++++++++</span><span class="d">----------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">src/sql/testscripts/writes/update</a></td><td> | </td><td class="num">18</td><td><span class="i">+++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">src/sql/testscripts/writes/update_datatypes</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">src/sql/testscripts/writes/update_default</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">src/sql/testscripts/writes/update_index</a></td><td> | </td><td class="num">68</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">src/sql/testscripts/writes/update_null</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">src/sql/testscripts/writes/update_primary_key</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">src/sql/testscripts/writes/update_reference</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">src/sql/testscripts/writes/update_unique</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">src/sql/testscripts/writes/update_where</a></td><td> | </td><td class="num">58</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d">-----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">src/sql/types/value.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
</table></pre><pre>64 files changed, 1510 insertions(+), 1517 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/encoding/format.rs.html">src/encoding/format.rs</a> b/<a href="../file/src/encoding/format.rs.html">src/encoding/format.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -150,15 +150,8 @@ impl&lt;I: Formatter&gt; Formatter for MVCC&lt;I&gt; {
</a> pub struct SQL;
 
 impl SQL {
<a href="#h0-0-3" id="h0-0-3" class="d">-    fn literal(value: &amp;sql::types::Value) -&gt; String {
</a><a href="#h0-0-4" id="h0-0-4" class="d">-        match value {
</a><a href="#h0-0-5" id="h0-0-5" class="d">-            sql::types::Value::String(s) =&gt; format!(&quot;{s:?}&quot;), // quoted string
</a><a href="#h0-0-6" id="h0-0-6" class="d">-            value =&gt; value.to_string(),
</a><a href="#h0-0-7" id="h0-0-7" class="d">-        }
</a><a href="#h0-0-8" id="h0-0-8" class="d">-    }
</a><a href="#h0-0-9" id="h0-0-9" class="d">-
</a>     fn values(values: impl IntoIterator&lt;Item = sql::types::Value&gt;) -&gt; String {
<a href="#h0-0-11" id="h0-0-11" class="d">-        values.into_iter().map(|v| Self::literal(&amp;v)).join(&quot;,&quot;)
</a><a href="#h0-0-12" id="h0-0-12" class="i">+        values.into_iter().join(&quot;,&quot;)
</a>     }
 
     fn schema(table: sql::types::Table) -&gt; String {
<a href="#h0-1" id="h0-1" class="h">@@ -178,10 +171,10 @@ impl Formatter for SQL {
</a>         match key {
             sql::engine::Key::Table(name) =&gt; format!(&quot;sql:Table({name})&quot;),
             sql::engine::Key::Index(table, column, value) =&gt; {
<a href="#h0-1-3" id="h0-1-3" class="d">-                format!(&quot;sql:Index({table}.{column}, {})&quot;, Self::literal(&amp;value))
</a><a href="#h0-1-4" id="h0-1-4" class="i">+                format!(&quot;sql:Index({table}.{column}, {value})&quot;)
</a>             }
             sql::engine::Key::Row(table, id) =&gt; {
<a href="#h0-1-7" id="h0-1-7" class="d">-                format!(&quot;sql:Row({table}, {})&quot;, Self::literal(&amp;id))
</a><a href="#h0-1-8" id="h0-1-8" class="i">+                format!(&quot;sql:Row({table}, {id})&quot;)
</a>             }
         }
     }
<b>diff --git a/<a id="h1" href="../file/src/sql/testscripts/expressions/func_sqrt.html">src/sql/testscripts/expressions/func_sqrt</a> b/<a href="../file/src/sql/testscripts/expressions/func_sqrt.html">src/sql/testscripts/expressions/func_sqrt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -49,4 +49,4 @@ Null
</a> !&gt; sqrt(&#39;foo&#39;)
 ---
 Error: invalid input: can&#39;t take square root of TRUE
<a href="#h1-0-3" id="h1-0-3" class="d">-Error: invalid input: can&#39;t take square root of foo
</a><a href="#h1-0-4" id="h1-0-4" class="i">+Error: invalid input: can&#39;t take square root of &#39;foo&#39;
</a><b>diff --git a/<a id="h2" href="../file/src/sql/testscripts/expressions/op_compare_equal.html">src/sql/testscripts/expressions/op_compare_equal</a> b/<a href="../file/src/sql/testscripts/expressions/op_compare_equal.html">src/sql/testscripts/expressions/op_compare_equal</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -80,4 +80,4 @@ Null
</a> !&gt; &#39;true&#39; = true
 ---
 Error: invalid input: can&#39;t compare TRUE and 1
<a href="#h2-0-3" id="h2-0-3" class="d">-Error: invalid input: can&#39;t compare true and TRUE
</a><a href="#h2-0-4" id="h2-0-4" class="i">+Error: invalid input: can&#39;t compare &#39;true&#39; and TRUE
</a><b>diff --git a/<a id="h3" href="../file/src/sql/testscripts/expressions/op_compare_greater.html">src/sql/testscripts/expressions/op_compare_greater</a> b/<a href="../file/src/sql/testscripts/expressions/op_compare_greater.html">src/sql/testscripts/expressions/op_compare_greater</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -132,5 +132,5 @@ Null
</a> !&gt; &#39;&#39; &gt; 1
 ---
 Error: invalid input: can&#39;t compare TRUE and 1
<a href="#h3-0-3" id="h3-0-3" class="d">-Error: invalid input: can&#39;t compare TRUE and 
</a><a href="#h3-0-4" id="h3-0-4" class="d">-Error: invalid input: can&#39;t compare  and 1
</a><a href="#h3-0-5" id="h3-0-5" class="i">+Error: invalid input: can&#39;t compare TRUE and &#39;&#39;
</a><a href="#h3-0-6" id="h3-0-6" class="i">+Error: invalid input: can&#39;t compare &#39;&#39; and 1
</a><b>diff --git a/<a id="h4" href="../file/src/sql/testscripts/expressions/op_compare_lesser.html">src/sql/testscripts/expressions/op_compare_lesser</a> b/<a href="../file/src/sql/testscripts/expressions/op_compare_lesser.html">src/sql/testscripts/expressions/op_compare_lesser</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -132,5 +132,5 @@ Null
</a> !&gt; &#39;&#39; &lt; 1
 ---
 Error: invalid input: can&#39;t compare TRUE and 1
<a href="#h4-0-3" id="h4-0-3" class="d">-Error: invalid input: can&#39;t compare TRUE and 
</a><a href="#h4-0-4" id="h4-0-4" class="d">-Error: invalid input: can&#39;t compare  and 1
</a><a href="#h4-0-5" id="h4-0-5" class="i">+Error: invalid input: can&#39;t compare TRUE and &#39;&#39;
</a><a href="#h4-0-6" id="h4-0-6" class="i">+Error: invalid input: can&#39;t compare &#39;&#39; and 1
</a><b>diff --git a/<a id="h5" href="../file/src/sql/testscripts/expressions/op_logic_and.html">src/sql/testscripts/expressions/op_logic_and</a> b/<a href="../file/src/sql/testscripts/expressions/op_logic_and.html">src/sql/testscripts/expressions/op_logic_and</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -41,6 +41,6 @@ Error: invalid input: can&#39;t and 1 and 1
</a> Error: invalid input: can&#39;t and 3.14 and TRUE
 Error: invalid input: can&#39;t and TRUE and 3.14
 Error: invalid input: can&#39;t and 3.14 and 3.14
<a href="#h5-0-3" id="h5-0-3" class="d">-Error: invalid input: can&#39;t and true and TRUE
</a><a href="#h5-0-4" id="h5-0-4" class="d">-Error: invalid input: can&#39;t and TRUE and true
</a><a href="#h5-0-5" id="h5-0-5" class="d">-Error: invalid input: can&#39;t and true and true
</a><a href="#h5-0-6" id="h5-0-6" class="i">+Error: invalid input: can&#39;t and &#39;true&#39; and TRUE
</a><a href="#h5-0-7" id="h5-0-7" class="i">+Error: invalid input: can&#39;t and TRUE and &#39;true&#39;
</a><a href="#h5-0-8" id="h5-0-8" class="i">+Error: invalid input: can&#39;t and &#39;true&#39; and &#39;true&#39;
</a><b>diff --git a/<a id="h6" href="../file/src/sql/testscripts/expressions/op_logic_not.html">src/sql/testscripts/expressions/op_logic_not</a> b/<a href="../file/src/sql/testscripts/expressions/op_logic_not.html">src/sql/testscripts/expressions/op_logic_not</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -15,4 +15,4 @@ Null
</a> ---
 Error: invalid input: can&#39;t negate 1
 Error: invalid input: can&#39;t negate 3.14
<a href="#h6-0-3" id="h6-0-3" class="d">-Error: invalid input: can&#39;t negate true
</a><a href="#h6-0-4" id="h6-0-4" class="i">+Error: invalid input: can&#39;t negate &#39;true&#39;
</a><b>diff --git a/<a id="h7" href="../file/src/sql/testscripts/expressions/op_logic_or.html">src/sql/testscripts/expressions/op_logic_or</a> b/<a href="../file/src/sql/testscripts/expressions/op_logic_or.html">src/sql/testscripts/expressions/op_logic_or</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -41,6 +41,6 @@ Error: invalid input: can&#39;t or 1 and 1
</a> Error: invalid input: can&#39;t or 3.14 and TRUE
 Error: invalid input: can&#39;t or TRUE and 3.14
 Error: invalid input: can&#39;t or 3.14 and 3.14
<a href="#h7-0-3" id="h7-0-3" class="d">-Error: invalid input: can&#39;t or true and TRUE
</a><a href="#h7-0-4" id="h7-0-4" class="d">-Error: invalid input: can&#39;t or TRUE and true
</a><a href="#h7-0-5" id="h7-0-5" class="d">-Error: invalid input: can&#39;t or true and true
</a><a href="#h7-0-6" id="h7-0-6" class="i">+Error: invalid input: can&#39;t or &#39;true&#39; and TRUE
</a><a href="#h7-0-7" id="h7-0-7" class="i">+Error: invalid input: can&#39;t or TRUE and &#39;true&#39;
</a><a href="#h7-0-8" id="h7-0-8" class="i">+Error: invalid input: can&#39;t or &#39;true&#39; and &#39;true&#39;
</a><b>diff --git a/<a id="h8" href="../file/src/sql/testscripts/expressions/op_math_add.html">src/sql/testscripts/expressions/op_math_add</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_add.html">src/sql/testscripts/expressions/op_math_add</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -67,4 +67,4 @@ Float(inf)
</a> !&gt; &#39;a&#39; + &#39;b&#39;
 ---
 Error: invalid input: can&#39;t add TRUE and FALSE
<a href="#h8-0-3" id="h8-0-3" class="d">-Error: invalid input: can&#39;t add a and b
</a><a href="#h8-0-4" id="h8-0-4" class="i">+Error: invalid input: can&#39;t add &#39;a&#39; and &#39;b&#39;
</a><b>diff --git a/<a id="h9" href="../file/src/sql/testscripts/expressions/op_math_divide.html">src/sql/testscripts/expressions/op_math_divide</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_divide.html">src/sql/testscripts/expressions/op_math_divide</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -94,4 +94,4 @@ Float(NaN)
</a> !&gt; &#39;a&#39; / &#39;b&#39;
 ---
 Error: invalid input: can&#39;t divide TRUE and FALSE
<a href="#h9-0-3" id="h9-0-3" class="d">-Error: invalid input: can&#39;t divide a and b
</a><a href="#h9-0-4" id="h9-0-4" class="i">+Error: invalid input: can&#39;t divide &#39;a&#39; and &#39;b&#39;
</a><b>diff --git a/<a id="h10" href="../file/src/sql/testscripts/expressions/op_math_exponentiate.html">src/sql/testscripts/expressions/op_math_exponentiate</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_exponentiate.html">src/sql/testscripts/expressions/op_math_exponentiate</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -69,4 +69,4 @@ Float(NaN)
</a> !&gt; &#39;a&#39; ^ &#39;b&#39;
 ---
 Error: invalid input: can&#39;t exponentiate TRUE and FALSE
<a href="#h10-0-3" id="h10-0-3" class="d">-Error: invalid input: can&#39;t exponentiate a and b
</a><a href="#h10-0-4" id="h10-0-4" class="i">+Error: invalid input: can&#39;t exponentiate &#39;a&#39; and &#39;b&#39;
</a><b>diff --git a/<a id="h11" href="../file/src/sql/testscripts/expressions/op_math_factorial.html">src/sql/testscripts/expressions/op_math_factorial</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_factorial.html">src/sql/testscripts/expressions/op_math_factorial</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -14,7 +14,7 @@ Integer(6) ← 3!
</a> Error: invalid input: can&#39;t take factorial of 3.14
 Error: invalid input: can&#39;t take factorial of 3.0
 Error: invalid input: can&#39;t take factorial of TRUE
<a href="#h11-0-3" id="h11-0-3" class="d">-Error: invalid input: can&#39;t take factorial of a
</a><a href="#h11-0-4" id="h11-0-4" class="i">+Error: invalid input: can&#39;t take factorial of &#39;a&#39;
</a> 
 # NULL yields null, infinity and NaN error.
 &gt; NULL!
<b>diff --git a/<a id="h12" href="../file/src/sql/testscripts/expressions/op_math_identity.html">src/sql/testscripts/expressions/op_math_identity</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_identity.html">src/sql/testscripts/expressions/op_math_identity</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -26,4 +26,4 @@ Integer(1) ← 1
</a> !&gt; +&#39;a&#39;
 ---
 Error: invalid input: can&#39;t take the identity of TRUE
<a href="#h12-0-3" id="h12-0-3" class="d">-Error: invalid input: can&#39;t take the identity of a
</a><a href="#h12-0-4" id="h12-0-4" class="i">+Error: invalid input: can&#39;t take the identity of &#39;a&#39;
</a><b>diff --git a/<a id="h13" href="../file/src/sql/testscripts/expressions/op_math_multiply.html">src/sql/testscripts/expressions/op_math_multiply</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_multiply.html">src/sql/testscripts/expressions/op_math_multiply</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -71,4 +71,4 @@ Float(NaN)
</a> !&gt; &#39;a&#39; * &#39;b&#39;
 ---
 Error: invalid input: can&#39;t multiply TRUE and FALSE
<a href="#h13-0-3" id="h13-0-3" class="d">-Error: invalid input: can&#39;t multiply a and b
</a><a href="#h13-0-4" id="h13-0-4" class="i">+Error: invalid input: can&#39;t multiply &#39;a&#39; and &#39;b&#39;
</a><b>diff --git a/<a id="h14" href="../file/src/sql/testscripts/expressions/op_math_negate.html">src/sql/testscripts/expressions/op_math_negate</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_negate.html">src/sql/testscripts/expressions/op_math_negate</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -28,4 +28,4 @@ Integer(1) ← ----1
</a> !&gt; -&#39;a&#39;
 ---
 Error: invalid input: can&#39;t negate TRUE
<a href="#h14-0-3" id="h14-0-3" class="d">-Error: invalid input: can&#39;t negate a
</a><a href="#h14-0-4" id="h14-0-4" class="i">+Error: invalid input: can&#39;t negate &#39;a&#39;
</a><b>diff --git a/<a id="h15" href="../file/src/sql/testscripts/expressions/op_math_remainder.html">src/sql/testscripts/expressions/op_math_remainder</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_remainder.html">src/sql/testscripts/expressions/op_math_remainder</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -68,4 +68,4 @@ Float(NaN)
</a> !&gt; &#39;a&#39; % &#39;b&#39;
 ---
 Error: invalid input: can&#39;t take remainder of TRUE and FALSE
<a href="#h15-0-3" id="h15-0-3" class="d">-Error: invalid input: can&#39;t take remainder of a and b
</a><a href="#h15-0-4" id="h15-0-4" class="i">+Error: invalid input: can&#39;t take remainder of &#39;a&#39; and &#39;b&#39;
</a><b>diff --git a/<a id="h16" href="../file/src/sql/testscripts/expressions/op_math_subtract.html">src/sql/testscripts/expressions/op_math_subtract</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_subtract.html">src/sql/testscripts/expressions/op_math_subtract</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -67,4 +67,4 @@ Float(-inf)
</a> !&gt; &#39;a&#39; - &#39;b&#39;
 ---
 Error: invalid input: can&#39;t subtract TRUE and FALSE
<a href="#h16-0-3" id="h16-0-3" class="d">-Error: invalid input: can&#39;t subtract a and b
</a><a href="#h16-0-4" id="h16-0-4" class="i">+Error: invalid input: can&#39;t subtract &#39;a&#39; and &#39;b&#39;
</a><b>diff --git a/<a id="h17" href="../file/src/sql/testscripts/expressions/op_precedence.html">src/sql/testscripts/expressions/op_precedence</a> b/<a href="../file/src/sql/testscripts/expressions/op_precedence.html">src/sql/testscripts/expressions/op_precedence</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -196,8 +196,8 @@ Boolean(true)
</a> Error: invalid input: can&#39;t compare 3 and TRUE
 Boolean(false)
 Error: invalid input: can&#39;t compare 3 and TRUE
<a href="#h17-0-3" id="h17-0-3" class="d">-Error: invalid input: can&#39;t LIKE TRUE and abc
</a><a href="#h17-0-4" id="h17-0-4" class="d">-Error: invalid input: can&#39;t LIKE 3 and abc
</a><a href="#h17-0-5" id="h17-0-5" class="i">+Error: invalid input: can&#39;t LIKE TRUE and &#39;abc&#39;
</a><a href="#h17-0-6" id="h17-0-6" class="i">+Error: invalid input: can&#39;t LIKE 3 and &#39;abc&#39;
</a> Boolean(false)
 Error: invalid input: can&#39;t compare 5 and FALSE
 
<a href="#h17-1" id="h17-1" class="h">@@ -231,8 +231,8 @@ Boolean(true)
</a> Error: invalid input: can&#39;t compare 3 and TRUE
 Boolean(false)
 Error: invalid input: can&#39;t compare 3 and TRUE
<a href="#h17-1-3" id="h17-1-3" class="d">-Error: invalid input: can&#39;t LIKE TRUE and abc
</a><a href="#h17-1-4" id="h17-1-4" class="d">-Error: invalid input: can&#39;t LIKE 3 and abc
</a><a href="#h17-1-5" id="h17-1-5" class="i">+Error: invalid input: can&#39;t LIKE TRUE and &#39;abc&#39;
</a><a href="#h17-1-6" id="h17-1-6" class="i">+Error: invalid input: can&#39;t LIKE 3 and &#39;abc&#39;
</a> Boolean(false)
 Error: invalid input: can&#39;t compare 5 and FALSE
 
<a href="#h17-2" id="h17-2" class="h">@@ -266,8 +266,8 @@ Boolean(false)
</a> Error: invalid input: can&#39;t compare 3 and TRUE
 Boolean(true)
 Error: invalid input: can&#39;t compare 3 and TRUE
<a href="#h17-2-3" id="h17-2-3" class="d">-Error: invalid input: can&#39;t LIKE FALSE and abc
</a><a href="#h17-2-4" id="h17-2-4" class="d">-Error: invalid input: can&#39;t LIKE 3 and abc
</a><a href="#h17-2-5" id="h17-2-5" class="i">+Error: invalid input: can&#39;t LIKE FALSE and &#39;abc&#39;
</a><a href="#h17-2-6" id="h17-2-6" class="i">+Error: invalid input: can&#39;t LIKE 3 and &#39;abc&#39;
</a> Boolean(false)
 Error: invalid input: can&#39;t compare 5 and FALSE
 
<a href="#h17-3" id="h17-3" class="h">@@ -301,8 +301,8 @@ Boolean(false)
</a> Error: invalid input: can&#39;t compare 3 and TRUE
 Boolean(true)
 Error: invalid input: can&#39;t compare 3 and TRUE
<a href="#h17-3-3" id="h17-3-3" class="d">-Error: invalid input: can&#39;t LIKE FALSE and abc
</a><a href="#h17-3-4" id="h17-3-4" class="d">-Error: invalid input: can&#39;t LIKE 3 and abc
</a><a href="#h17-3-5" id="h17-3-5" class="i">+Error: invalid input: can&#39;t LIKE FALSE and &#39;abc&#39;
</a><a href="#h17-3-6" id="h17-3-6" class="i">+Error: invalid input: can&#39;t LIKE 3 and &#39;abc&#39;
</a> Boolean(false)
 Error: invalid input: can&#39;t compare 5 and FALSE
 
<a href="#h17-4" id="h17-4" class="h">@@ -318,8 +318,8 @@ Error: invalid input: can&#39;t compare 5 and FALSE
</a> ---
 Boolean(true)
 Error: invalid input: can&#39;t compare 1 and FALSE
<a href="#h17-4-3" id="h17-4-3" class="d">-Error: invalid input: can&#39;t LIKE TRUE and abc
</a><a href="#h17-4-4" id="h17-4-4" class="d">-Error: invalid input: can&#39;t LIKE 1 and abc
</a><a href="#h17-4-5" id="h17-4-5" class="i">+Error: invalid input: can&#39;t LIKE TRUE and &#39;abc&#39;
</a><a href="#h17-4-6" id="h17-4-6" class="i">+Error: invalid input: can&#39;t LIKE 1 and &#39;abc&#39;
</a> Boolean(true)
 Error: invalid input: can&#39;t compare 1 and TRUE
 Boolean(false)
<a href="#h17-5" id="h17-5" class="h">@@ -337,8 +337,8 @@ Error: invalid input: can&#39;t negate 1
</a> ---
 Boolean(false)
 Error: invalid input: can&#39;t compare 1 and FALSE
<a href="#h17-5-3" id="h17-5-3" class="d">-Error: invalid input: can&#39;t LIKE FALSE and abc
</a><a href="#h17-5-4" id="h17-5-4" class="d">-Error: invalid input: can&#39;t LIKE 1 and abc
</a><a href="#h17-5-5" id="h17-5-5" class="i">+Error: invalid input: can&#39;t LIKE FALSE and &#39;abc&#39;
</a><a href="#h17-5-6" id="h17-5-6" class="i">+Error: invalid input: can&#39;t LIKE 1 and &#39;abc&#39;
</a> Boolean(true)
 Error: invalid input: can&#39;t compare 1 and TRUE
 Boolean(true)
<a href="#h17-6" id="h17-6" class="h">@@ -351,9 +351,9 @@ Error: invalid input: can&#39;t negate 1
</a> !&gt; (NOT &#39;abc&#39;) LIKE &#39;abc&#39;
 ---
 Boolean(true)
<a href="#h17-6-3" id="h17-6-3" class="d">-Error: invalid input: can&#39;t LIKE abc and TRUE
</a><a href="#h17-6-4" id="h17-6-4" class="i">+Error: invalid input: can&#39;t LIKE &#39;abc&#39; and TRUE
</a> Boolean(false)
<a href="#h17-6-6" id="h17-6-6" class="d">-Error: invalid input: can&#39;t negate abc
</a><a href="#h17-6-7" id="h17-6-7" class="i">+Error: invalid input: can&#39;t negate &#39;abc&#39;
</a> 
 # IS NULL
 &gt; NOT NULL IS NULL
<b>diff --git a/<a id="h18" href="../file/src/sql/testscripts/expressions/op_string_like.html">src/sql/testscripts/expressions/op_string_like</a> b/<a href="../file/src/sql/testscripts/expressions/op_string_like.html">src/sql/testscripts/expressions/op_string_like</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -117,9 +117,9 @@ Boolean(false)
</a> !&gt; &#39;abc&#39; LIKE TRUE
 !&gt; TRUE LIKE &#39;abc&#39;
 ---
<a href="#h18-0-3" id="h18-0-3" class="d">-Error: invalid input: can&#39;t LIKE abc and 1
</a><a href="#h18-0-4" id="h18-0-4" class="d">-Error: invalid input: can&#39;t LIKE 1 and abc
</a><a href="#h18-0-5" id="h18-0-5" class="d">-Error: invalid input: can&#39;t LIKE abc and 3.14
</a><a href="#h18-0-6" id="h18-0-6" class="d">-Error: invalid input: can&#39;t LIKE 3.14 and abc
</a><a href="#h18-0-7" id="h18-0-7" class="d">-Error: invalid input: can&#39;t LIKE abc and TRUE
</a><a href="#h18-0-8" id="h18-0-8" class="d">-Error: invalid input: can&#39;t LIKE TRUE and abc
</a><a href="#h18-0-9" id="h18-0-9" class="i">+Error: invalid input: can&#39;t LIKE &#39;abc&#39; and 1
</a><a href="#h18-0-10" id="h18-0-10" class="i">+Error: invalid input: can&#39;t LIKE 1 and &#39;abc&#39;
</a><a href="#h18-0-11" id="h18-0-11" class="i">+Error: invalid input: can&#39;t LIKE &#39;abc&#39; and 3.14
</a><a href="#h18-0-12" id="h18-0-12" class="i">+Error: invalid input: can&#39;t LIKE 3.14 and &#39;abc&#39;
</a><a href="#h18-0-13" id="h18-0-13" class="i">+Error: invalid input: can&#39;t LIKE &#39;abc&#39; and TRUE
</a><a href="#h18-0-14" id="h18-0-14" class="i">+Error: invalid input: can&#39;t LIKE TRUE and &#39;abc&#39;
</a><b>diff --git a/<a id="h19" href="../file/src/sql/testscripts/optimizer/fold_constants.html">src/sql/testscripts/optimizer/fold_constants</a> b/<a href="../file/src/sql/testscripts/optimizer/fold_constants.html">src/sql/testscripts/optimizer/fold_constants</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -46,15 +46,15 @@ Short circuit:
</a>    NestedLoopJoin: inner
    ├─ Scan: test as a
    └─ Scan: test as b
<a href="#h19-0-3" id="h19-0-3" class="d">-1, a, 1, a
</a><a href="#h19-0-4" id="h19-0-4" class="d">-1, a, 2, b
</a><a href="#h19-0-5" id="h19-0-5" class="d">-1, a, 3, c
</a><a href="#h19-0-6" id="h19-0-6" class="d">-2, b, 1, a
</a><a href="#h19-0-7" id="h19-0-7" class="d">-2, b, 2, b
</a><a href="#h19-0-8" id="h19-0-8" class="d">-2, b, 3, c
</a><a href="#h19-0-9" id="h19-0-9" class="d">-3, c, 1, a
</a><a href="#h19-0-10" id="h19-0-10" class="d">-3, c, 2, b
</a><a href="#h19-0-11" id="h19-0-11" class="d">-3, c, 3, c
</a><a href="#h19-0-12" id="h19-0-12" class="i">+1, &#39;a&#39;, 1, &#39;a&#39;
</a><a href="#h19-0-13" id="h19-0-13" class="i">+1, &#39;a&#39;, 2, &#39;b&#39;
</a><a href="#h19-0-14" id="h19-0-14" class="i">+1, &#39;a&#39;, 3, &#39;c&#39;
</a><a href="#h19-0-15" id="h19-0-15" class="i">+2, &#39;b&#39;, 1, &#39;a&#39;
</a><a href="#h19-0-16" id="h19-0-16" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;
</a><a href="#h19-0-17" id="h19-0-17" class="i">+2, &#39;b&#39;, 3, &#39;c&#39;
</a><a href="#h19-0-18" id="h19-0-18" class="i">+3, &#39;c&#39;, 1, &#39;a&#39;
</a><a href="#h19-0-19" id="h19-0-19" class="i">+3, &#39;c&#39;, 2, &#39;b&#39;
</a><a href="#h19-0-20" id="h19-0-20" class="i">+3, &#39;c&#39;, 3, &#39;c&#39;
</a> 
 [opt]&gt; SELECT * FROM test WHERE 1+1 &gt; 1
 ---
<a href="#h19-1" id="h19-1" class="h">@@ -68,9 +68,9 @@ Filter pushdown:
</a>    Scan: test (TRUE)
 Short circuit:
    Scan: test
<a href="#h19-1-3" id="h19-1-3" class="d">-1, a
</a><a href="#h19-1-4" id="h19-1-4" class="d">-2, b
</a><a href="#h19-1-5" id="h19-1-5" class="d">-3, c
</a><a href="#h19-1-6" id="h19-1-6" class="i">+1, &#39;a&#39;
</a><a href="#h19-1-7" id="h19-1-7" class="i">+2, &#39;b&#39;
</a><a href="#h19-1-8" id="h19-1-8" class="i">+3, &#39;c&#39;
</a> 
 [opt]&gt; SELECT * FROM test ORDER BY 1+1
 ---
<a href="#h19-2" id="h19-2" class="h">@@ -80,24 +80,24 @@ Initial:
</a> Constant folding:
    Order: 2 asc
    └─ Scan: test
<a href="#h19-2-3" id="h19-2-3" class="d">-1, a
</a><a href="#h19-2-4" id="h19-2-4" class="d">-2, b
</a><a href="#h19-2-5" id="h19-2-5" class="d">-3, c
</a><a href="#h19-2-6" id="h19-2-6" class="i">+1, &#39;a&#39;
</a><a href="#h19-2-7" id="h19-2-7" class="i">+2, &#39;b&#39;
</a><a href="#h19-2-8" id="h19-2-8" class="i">+3, &#39;c&#39;
</a> 
 [opt]&gt; SELECT * FROM test LIMIT 1+1
 ---
 Initial:
    Limit: 2
    └─ Scan: test
<a href="#h19-2-15" id="h19-2-15" class="d">-1, a
</a><a href="#h19-2-16" id="h19-2-16" class="d">-2, b
</a><a href="#h19-2-17" id="h19-2-17" class="i">+1, &#39;a&#39;
</a><a href="#h19-2-18" id="h19-2-18" class="i">+2, &#39;b&#39;
</a> 
 [opt]&gt; SELECT * FROM test OFFSET 1+1
 ---
 Initial:
    Offset: 2
    └─ Scan: test
<a href="#h19-2-25" id="h19-2-25" class="d">-3, c
</a><a href="#h19-2-26" id="h19-2-26" class="i">+3, &#39;c&#39;
</a> 
 # Constant folding folds the constant parts of a variable expression.
 # TODO: this should fold 4 - 6, but it needs to reorder operations.
<a href="#h19-3" id="h19-3" class="h">@@ -126,9 +126,9 @@ Filter pushdown:
</a>    Scan: test (TRUE)
 Short circuit:
    Scan: test
<a href="#h19-3-3" id="h19-3-3" class="d">-1, a
</a><a href="#h19-3-4" id="h19-3-4" class="d">-2, b
</a><a href="#h19-3-5" id="h19-3-5" class="d">-3, c
</a><a href="#h19-3-6" id="h19-3-6" class="i">+1, &#39;a&#39;
</a><a href="#h19-3-7" id="h19-3-7" class="i">+2, &#39;b&#39;
</a><a href="#h19-3-8" id="h19-3-8" class="i">+3, &#39;c&#39;
</a> 
 [opt]&gt; SELECT * FROM test WHERE 1+1 &lt; 1 OR id &gt; 1
 ---
<a href="#h19-4" id="h19-4" class="h">@@ -140,8 +140,8 @@ Constant folding:
</a>    └─ Scan: test
 Filter pushdown:
    Scan: test (test.id &gt; 1)
<a href="#h19-4-3" id="h19-4-3" class="d">-2, b
</a><a href="#h19-4-4" id="h19-4-4" class="d">-3, c
</a><a href="#h19-4-5" id="h19-4-5" class="i">+2, &#39;b&#39;
</a><a href="#h19-4-6" id="h19-4-6" class="i">+3, &#39;c&#39;
</a> 
 [opt]&gt; SELECT * FROM test WHERE 1+1 &gt; 1 AND id &gt; 1
 ---
<a href="#h19-5" id="h19-5" class="h">@@ -153,8 +153,8 @@ Constant folding:
</a>    └─ Scan: test
 Filter pushdown:
    Scan: test (test.id &gt; 1)
<a href="#h19-5-3" id="h19-5-3" class="d">-2, b
</a><a href="#h19-5-4" id="h19-5-4" class="d">-3, c
</a><a href="#h19-5-5" id="h19-5-5" class="i">+2, &#39;b&#39;
</a><a href="#h19-5-6" id="h19-5-6" class="i">+3, &#39;c&#39;
</a> 
 [opt]&gt; SELECT * FROM test WHERE 1+1 &lt; 1 AND id &gt; 1
 ---
<b>diff --git a/<a id="h20" href="../file/src/sql/testscripts/optimizer/index_lookup.html">src/sql/testscripts/optimizer/index_lookup</a> b/<a href="../file/src/sql/testscripts/optimizer/index_lookup.html">src/sql/testscripts/optimizer/index_lookup</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -17,7 +17,7 @@ Filter pushdown:
</a>    Scan: test (test.id = 2)
 Index lookup:
    KeyLookup: test (2)
<a href="#h20-0-3" id="h20-0-3" class="d">-2, b, NaN
</a><a href="#h20-0-4" id="h20-0-4" class="i">+2, &#39;b&#39;, NaN
</a> 
 [opt]&gt; SELECT * FROM test WHERE id = 1 OR id = 3
 ---
<a href="#h20-1" id="h20-1" class="h">@@ -28,79 +28,79 @@ Filter pushdown:
</a>    Scan: test (test.id = 1 OR test.id = 3)
 Index lookup:
    KeyLookup: test (1, 3)
<a href="#h20-1-3" id="h20-1-3" class="d">-1, a, 3.14
</a><a href="#h20-1-4" id="h20-1-4" class="d">-3, c, 0.0
</a><a href="#h20-1-5" id="h20-1-5" class="i">+1, &#39;a&#39;, 3.14
</a><a href="#h20-1-6" id="h20-1-6" class="i">+3, &#39;c&#39;, 0.0
</a> 
 # Can combine lookups with other predicates, but only AND.
 [opt]&gt; SELECT * FROM test WHERE (id = 1 OR id = 3) AND value &gt; &#39;a&#39;
 ---
 Initial:
<a href="#h20-1-12" id="h20-1-12" class="d">-   Filter: (test.id = 1 OR test.id = 3) AND test.value &gt; a
</a><a href="#h20-1-13" id="h20-1-13" class="i">+   Filter: (test.id = 1 OR test.id = 3) AND test.value &gt; &#39;a&#39;
</a>    └─ Scan: test
 Filter pushdown:
<a href="#h20-1-16" id="h20-1-16" class="d">-   Scan: test ((test.id = 1 OR test.id = 3) AND test.value &gt; a)
</a><a href="#h20-1-17" id="h20-1-17" class="i">+   Scan: test ((test.id = 1 OR test.id = 3) AND test.value &gt; &#39;a&#39;)
</a> Index lookup:
<a href="#h20-1-19" id="h20-1-19" class="d">-   Filter: test.value &gt; a
</a><a href="#h20-1-20" id="h20-1-20" class="i">+   Filter: test.value &gt; &#39;a&#39;
</a>    └─ KeyLookup: test (1, 3)
<a href="#h20-1-22" id="h20-1-22" class="d">-3, c, 0.0
</a><a href="#h20-1-23" id="h20-1-23" class="i">+3, &#39;c&#39;, 0.0
</a> 
 [opt]&gt; SELECT * FROM test WHERE id = 1 OR id = 3 OR value &gt; &#39;a&#39;
 ---
 Initial:
<a href="#h20-1-28" id="h20-1-28" class="d">-   Filter: test.id = 1 OR test.id = 3 OR test.value &gt; a
</a><a href="#h20-1-29" id="h20-1-29" class="i">+   Filter: test.id = 1 OR test.id = 3 OR test.value &gt; &#39;a&#39;
</a>    └─ Scan: test
 Filter pushdown:
<a href="#h20-1-32" id="h20-1-32" class="d">-   Scan: test (test.id = 1 OR test.id = 3 OR test.value &gt; a)
</a><a href="#h20-1-33" id="h20-1-33" class="d">-1, a, 3.14
</a><a href="#h20-1-34" id="h20-1-34" class="d">-2, b, NaN
</a><a href="#h20-1-35" id="h20-1-35" class="d">-3, c, 0.0
</a><a href="#h20-1-36" id="h20-1-36" class="i">+   Scan: test (test.id = 1 OR test.id = 3 OR test.value &gt; &#39;a&#39;)
</a><a href="#h20-1-37" id="h20-1-37" class="i">+1, &#39;a&#39;, 3.14
</a><a href="#h20-1-38" id="h20-1-38" class="i">+2, &#39;b&#39;, NaN
</a><a href="#h20-1-39" id="h20-1-39" class="i">+3, &#39;c&#39;, 0.0
</a> 
 # Same story with secondary indexes.
 [opt]&gt; SELECT * FROM test WHERE value = &#39;b&#39;
 ---
 Initial:
<a href="#h20-1-45" id="h20-1-45" class="d">-   Filter: test.value = b
</a><a href="#h20-1-46" id="h20-1-46" class="i">+   Filter: test.value = &#39;b&#39;
</a>    └─ Scan: test
 Filter pushdown:
<a href="#h20-1-49" id="h20-1-49" class="d">-   Scan: test (test.value = b)
</a><a href="#h20-1-50" id="h20-1-50" class="i">+   Scan: test (test.value = &#39;b&#39;)
</a> Index lookup:
<a href="#h20-1-52" id="h20-1-52" class="d">-   IndexLookup: test.value (b)
</a><a href="#h20-1-53" id="h20-1-53" class="d">-2, b, NaN
</a><a href="#h20-1-54" id="h20-1-54" class="i">+   IndexLookup: test.value (&#39;b&#39;)
</a><a href="#h20-1-55" id="h20-1-55" class="i">+2, &#39;b&#39;, NaN
</a> 
 [opt]&gt; SELECT * FROM test WHERE value = &#39;a&#39; OR value = &#39;c&#39;
 ---
 Initial:
<a href="#h20-1-60" id="h20-1-60" class="d">-   Filter: test.value = a OR test.value = c
</a><a href="#h20-1-61" id="h20-1-61" class="i">+   Filter: test.value = &#39;a&#39; OR test.value = &#39;c&#39;
</a>    └─ Scan: test
 Filter pushdown:
<a href="#h20-1-64" id="h20-1-64" class="d">-   Scan: test (test.value = a OR test.value = c)
</a><a href="#h20-1-65" id="h20-1-65" class="i">+   Scan: test (test.value = &#39;a&#39; OR test.value = &#39;c&#39;)
</a> Index lookup:
<a href="#h20-1-67" id="h20-1-67" class="d">-   IndexLookup: test.value (a, c)
</a><a href="#h20-1-68" id="h20-1-68" class="d">-1, a, 3.14
</a><a href="#h20-1-69" id="h20-1-69" class="d">-3, c, 0.0
</a><a href="#h20-1-70" id="h20-1-70" class="i">+   IndexLookup: test.value (&#39;a&#39;, &#39;c&#39;)
</a><a href="#h20-1-71" id="h20-1-71" class="i">+1, &#39;a&#39;, 3.14
</a><a href="#h20-1-72" id="h20-1-72" class="i">+3, &#39;c&#39;, 0.0
</a> 
 [opt]&gt; SELECT * FROM test WHERE (value = &#39;a&#39; OR value = &#39;c&#39;) AND id &gt; 1
 ---
 Initial:
<a href="#h20-1-77" id="h20-1-77" class="d">-   Filter: (test.value = a OR test.value = c) AND test.id &gt; 1
</a><a href="#h20-1-78" id="h20-1-78" class="i">+   Filter: (test.value = &#39;a&#39; OR test.value = &#39;c&#39;) AND test.id &gt; 1
</a>    └─ Scan: test
 Filter pushdown:
<a href="#h20-1-81" id="h20-1-81" class="d">-   Scan: test ((test.value = a OR test.value = c) AND test.id &gt; 1)
</a><a href="#h20-1-82" id="h20-1-82" class="i">+   Scan: test ((test.value = &#39;a&#39; OR test.value = &#39;c&#39;) AND test.id &gt; 1)
</a> Index lookup:
    Filter: test.id &gt; 1
<a href="#h20-1-85" id="h20-1-85" class="d">-   └─ IndexLookup: test.value (a, c)
</a><a href="#h20-1-86" id="h20-1-86" class="d">-3, c, 0.0
</a><a href="#h20-1-87" id="h20-1-87" class="i">+   └─ IndexLookup: test.value (&#39;a&#39;, &#39;c&#39;)
</a><a href="#h20-1-88" id="h20-1-88" class="i">+3, &#39;c&#39;, 0.0
</a> 
 [opt]&gt; SELECT * FROM test WHERE value = &#39;a&#39; OR value = &#39;c&#39; OR id &gt; 1
 ---
 Initial:
<a href="#h20-1-93" id="h20-1-93" class="d">-   Filter: test.value = a OR test.value = c OR test.id &gt; 1
</a><a href="#h20-1-94" id="h20-1-94" class="i">+   Filter: test.value = &#39;a&#39; OR test.value = &#39;c&#39; OR test.id &gt; 1
</a>    └─ Scan: test
 Filter pushdown:
<a href="#h20-1-97" id="h20-1-97" class="d">-   Scan: test (test.value = a OR test.value = c OR test.id &gt; 1)
</a><a href="#h20-1-98" id="h20-1-98" class="d">-1, a, 3.14
</a><a href="#h20-1-99" id="h20-1-99" class="d">-2, b, NaN
</a><a href="#h20-1-100" id="h20-1-100" class="d">-3, c, 0.0
</a><a href="#h20-1-101" id="h20-1-101" class="i">+   Scan: test (test.value = &#39;a&#39; OR test.value = &#39;c&#39; OR test.id &gt; 1)
</a><a href="#h20-1-102" id="h20-1-102" class="i">+1, &#39;a&#39;, 3.14
</a><a href="#h20-1-103" id="h20-1-103" class="i">+2, &#39;b&#39;, NaN
</a><a href="#h20-1-104" id="h20-1-104" class="i">+3, &#39;c&#39;, 0.0
</a> 
 # NULL lookups should match for IS NULL, but not for = NULL. IS NOT NULL
 # incurs a table scan.
<a href="#h20-2" id="h20-2" class="h">@@ -142,9 +142,9 @@ Initial:
</a>    └─ Scan: test
 Filter pushdown:
    Scan: test (NOT test.value IS NULL)
<a href="#h20-2-3" id="h20-2-3" class="d">-1, a, 3.14
</a><a href="#h20-2-4" id="h20-2-4" class="d">-2, b, NaN
</a><a href="#h20-2-5" id="h20-2-5" class="d">-3, c, 0.0
</a><a href="#h20-2-6" id="h20-2-6" class="i">+1, &#39;a&#39;, 3.14
</a><a href="#h20-2-7" id="h20-2-7" class="i">+2, &#39;b&#39;, NaN
</a><a href="#h20-2-8" id="h20-2-8" class="i">+3, &#39;c&#39;, 0.0
</a> 
 # NAN lookups should be treated similarly to NULLs.
 [opt]&gt; SELECT * FROM test WHERE &quot;float&quot; IS NAN
<a href="#h20-3" id="h20-3" class="h">@@ -156,7 +156,7 @@ Filter pushdown:
</a>    Scan: test (test.float IS NAN)
 Index lookup:
    IndexLookup: test.float (NaN)
<a href="#h20-3-3" id="h20-3-3" class="d">-2, b, NaN
</a><a href="#h20-3-4" id="h20-3-4" class="i">+2, &#39;b&#39;, NaN
</a> 
 [opt]&gt; SELECT * FROM test WHERE &quot;float&quot; = NAN
 ---
<a href="#h20-4" id="h20-4" class="h">@@ -194,9 +194,9 @@ Initial:
</a>    └─ Scan: test
 Filter pushdown:
    Scan: test (NOT test.float = NaN)
<a href="#h20-4-3" id="h20-4-3" class="d">-1, a, 3.14
</a><a href="#h20-4-4" id="h20-4-4" class="d">-2, b, NaN
</a><a href="#h20-4-5" id="h20-4-5" class="d">-3, c, 0.0
</a><a href="#h20-4-6" id="h20-4-6" class="i">+1, &#39;a&#39;, 3.14
</a><a href="#h20-4-7" id="h20-4-7" class="i">+2, &#39;b&#39;, NaN
</a><a href="#h20-4-8" id="h20-4-8" class="i">+3, &#39;c&#39;, 0.0
</a> 
 [opt]&gt; SELECT * FROM test WHERE &quot;float&quot; IS NOT NAN
 ---
<a href="#h20-5" id="h20-5" class="h">@@ -205,8 +205,8 @@ Initial:
</a>    └─ Scan: test
 Filter pushdown:
    Scan: test (NOT test.float IS NAN)
<a href="#h20-5-3" id="h20-5-3" class="d">-1, a, 3.14
</a><a href="#h20-5-4" id="h20-5-4" class="d">-3, c, 0.0
</a><a href="#h20-5-5" id="h20-5-5" class="i">+1, &#39;a&#39;, 3.14
</a><a href="#h20-5-6" id="h20-5-6" class="i">+3, &#39;c&#39;, 0.0
</a> 
 # Inner joins on foreign keys with index lookups are transferred across.
 [opt]&gt; SELECT * FROM test JOIN other ON other.test_id = test.id WHERE test_id = 1 OR test_id = 3
<a href="#h20-6" id="h20-6" class="h">@@ -228,8 +228,8 @@ Join type:
</a>    HashJoin: inner on test.id = other.test_id
    ├─ KeyLookup: test (1, 3)
    └─ IndexLookup: other.test_id (1, 3)
<a href="#h20-6-3" id="h20-6-3" class="d">-1, a, 3.14, 1, 1
</a><a href="#h20-6-4" id="h20-6-4" class="d">-3, c, 0.0, 3, 3
</a><a href="#h20-6-5" id="h20-6-5" class="i">+1, &#39;a&#39;, 3.14, 1, 1
</a><a href="#h20-6-6" id="h20-6-6" class="i">+3, &#39;c&#39;, 0.0, 3, 3
</a> 
 # It&#39;s the same if the index lookups are given in the join predicate.
 [opt]&gt; SELECT * FROM test JOIN other ON other.test_id = test.id AND (test_id = 1 OR test_id = 3)
<a href="#h20-7" id="h20-7" class="h">@@ -250,8 +250,8 @@ Join type:
</a>    HashJoin: inner on test.id = other.test_id
    ├─ KeyLookup: test (1, 3)
    └─ IndexLookup: other.test_id (1, 3)
<a href="#h20-7-3" id="h20-7-3" class="d">-1, a, 3.14, 1, 1
</a><a href="#h20-7-4" id="h20-7-4" class="d">-3, c, 0.0, 3, 3
</a><a href="#h20-7-5" id="h20-7-5" class="i">+1, &#39;a&#39;, 3.14, 1, 1
</a><a href="#h20-7-6" id="h20-7-6" class="i">+3, &#39;c&#39;, 0.0, 3, 3
</a> 
 # It also works with three tables.
 [opt]&gt; SELECT * FROM test \
<a href="#h20-8" id="h20-8" class="h">@@ -282,4 +282,4 @@ Join type:
</a>    │  ├─ KeyLookup: test (2)
    │  └─ IndexLookup: other.test_id as a.test_id (2)
    └─ IndexLookup: other.test_id as b.test_id (1, 3)
<a href="#h20-8-3" id="h20-8-3" class="d">-2, b, NaN, 2, 2, 3, 3
</a><a href="#h20-8-4" id="h20-8-4" class="i">+2, &#39;b&#39;, NaN, 2, 2, 3, 3
</a><b>diff --git a/<a id="h21" href="../file/src/sql/testscripts/optimizer/join_type.html">src/sql/testscripts/optimizer/join_type</a> b/<a href="../file/src/sql/testscripts/optimizer/join_type.html">src/sql/testscripts/optimizer/join_type</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -16,9 +16,9 @@ Join type:
</a>    HashJoin: inner on a.id = b.id
    ├─ Scan: test as a
    └─ Scan: test as b
<a href="#h21-0-3" id="h21-0-3" class="d">-1, a, 1, a
</a><a href="#h21-0-4" id="h21-0-4" class="d">-2, b, 2, b
</a><a href="#h21-0-5" id="h21-0-5" class="d">-3, c, 3, c
</a><a href="#h21-0-6" id="h21-0-6" class="i">+1, &#39;a&#39;, 1, &#39;a&#39;
</a><a href="#h21-0-7" id="h21-0-7" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;
</a><a href="#h21-0-8" id="h21-0-8" class="i">+3, &#39;c&#39;, 3, &#39;c&#39;
</a> 
 # This also works for non-primary key columns.
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.value = b.value
<a href="#h21-1" id="h21-1" class="h">@@ -31,9 +31,9 @@ Join type:
</a>    HashJoin: inner on a.value = b.value
    ├─ Scan: test as a
    └─ Scan: test as b
<a href="#h21-1-3" id="h21-1-3" class="d">-1, a, 1, a
</a><a href="#h21-1-4" id="h21-1-4" class="d">-2, b, 2, b
</a><a href="#h21-1-5" id="h21-1-5" class="d">-3, c, 3, c
</a><a href="#h21-1-6" id="h21-1-6" class="i">+1, &#39;a&#39;, 1, &#39;a&#39;
</a><a href="#h21-1-7" id="h21-1-7" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;
</a><a href="#h21-1-8" id="h21-1-8" class="i">+3, &#39;c&#39;, 3, &#39;c&#39;
</a> 
 # However, it does not work with both.
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.id = b.id AND a.value = b.value 
<a href="#h21-2" id="h21-2" class="h">@@ -42,9 +42,9 @@ Initial:
</a>    NestedLoopJoin: inner on a.id = b.id AND a.value = b.value
    ├─ Scan: test as a
    └─ Scan: test as b
<a href="#h21-2-3" id="h21-2-3" class="d">-1, a, 1, a
</a><a href="#h21-2-4" id="h21-2-4" class="d">-2, b, 2, b
</a><a href="#h21-2-5" id="h21-2-5" class="d">-3, c, 3, c
</a><a href="#h21-2-6" id="h21-2-6" class="i">+1, &#39;a&#39;, 1, &#39;a&#39;
</a><a href="#h21-2-7" id="h21-2-7" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;
</a><a href="#h21-2-8" id="h21-2-8" class="i">+3, &#39;c&#39;, 3, &#39;c&#39;
</a> 
 # It does not work with other predicates either. A smarter optimizer could
 # move the rest of the predicate into a new filter node.
<a href="#h21-3" id="h21-3" class="h">@@ -54,23 +54,23 @@ Initial:
</a>    NestedLoopJoin: inner on a.id = b.id AND (a.value &gt; b.value OR a.value = b.value)
    ├─ Scan: test as a
    └─ Scan: test as b
<a href="#h21-3-3" id="h21-3-3" class="d">-1, a, 1, a
</a><a href="#h21-3-4" id="h21-3-4" class="d">-2, b, 2, b
</a><a href="#h21-3-5" id="h21-3-5" class="d">-3, c, 3, c
</a><a href="#h21-3-6" id="h21-3-6" class="i">+1, &#39;a&#39;, 1, &#39;a&#39;
</a><a href="#h21-3-7" id="h21-3-7" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;
</a><a href="#h21-3-8" id="h21-3-8" class="i">+3, &#39;c&#39;, 3, &#39;c&#39;
</a> 
 # However, the filter pushdown optimizer can save the day by pushing down
 # independent predicates into the scans.
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.id = b.id AND a.value = &#39;b&#39; AND b.value = &#39;c&#39;
 ---
 Initial:
<a href="#h21-3-15" id="h21-3-15" class="d">-   NestedLoopJoin: inner on a.id = b.id AND a.value = b AND b.value = c
</a><a href="#h21-3-16" id="h21-3-16" class="i">+   NestedLoopJoin: inner on a.id = b.id AND a.value = &#39;b&#39; AND b.value = &#39;c&#39;
</a>    ├─ Scan: test as a
    └─ Scan: test as b
 Filter pushdown:
    NestedLoopJoin: inner on a.id = b.id
<a href="#h21-3-21" id="h21-3-21" class="d">-   ├─ Scan: test as a (a.value = b)
</a><a href="#h21-3-22" id="h21-3-22" class="d">-   └─ Scan: test as b (b.value = c)
</a><a href="#h21-3-23" id="h21-3-23" class="i">+   ├─ Scan: test as a (a.value = &#39;b&#39;)
</a><a href="#h21-3-24" id="h21-3-24" class="i">+   └─ Scan: test as b (b.value = &#39;c&#39;)
</a> Join type:
    HashJoin: inner on a.id = b.id
<a href="#h21-3-27" id="h21-3-27" class="d">-   ├─ Scan: test as a (a.value = b)
</a><a href="#h21-3-28" id="h21-3-28" class="d">-   └─ Scan: test as b (b.value = c)
</a><a href="#h21-3-29" id="h21-3-29" class="i">+   ├─ Scan: test as a (a.value = &#39;b&#39;)
</a><a href="#h21-3-30" id="h21-3-30" class="i">+   └─ Scan: test as b (b.value = &#39;c&#39;)
</a><b>diff --git a/<a id="h22" href="../file/src/sql/testscripts/optimizer/push_filters.html">src/sql/testscripts/optimizer/push_filters</a> b/<a href="../file/src/sql/testscripts/optimizer/push_filters.html">src/sql/testscripts/optimizer/push_filters</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -9,99 +9,99 @@ ok
</a> [opt]&gt; SELECT * FROM test WHERE value = &#39;b&#39;
 ---
 Initial:
<a href="#h22-0-3" id="h22-0-3" class="d">-   Filter: test.value = b
</a><a href="#h22-0-4" id="h22-0-4" class="i">+   Filter: test.value = &#39;b&#39;
</a>    └─ Scan: test
 Filter pushdown:
<a href="#h22-0-7" id="h22-0-7" class="d">-   Scan: test (test.value = b)
</a><a href="#h22-0-8" id="h22-0-8" class="d">-2, b
</a><a href="#h22-0-9" id="h22-0-9" class="i">+   Scan: test (test.value = &#39;b&#39;)
</a><a href="#h22-0-10" id="h22-0-10" class="i">+2, &#39;b&#39;
</a> 
 # HAVING filters are not pushed past aggregate nodes, even when possible. The
 # optimizer could do this if it was smarter.
 [opt]&gt; SELECT id, value FROM test GROUP BY id, value HAVING value = &#39;b&#39;
 ---
 Initial:
<a href="#h22-0-17" id="h22-0-17" class="d">-   Filter: test.value = b
</a><a href="#h22-0-18" id="h22-0-18" class="i">+   Filter: test.value = &#39;b&#39;
</a>    └─ Projection: test.id, test.value
       └─ Aggregate: test.id, test.value
          └─ Scan: test
 Short circuit:
<a href="#h22-0-23" id="h22-0-23" class="d">-   Filter: test.value = b
</a><a href="#h22-0-24" id="h22-0-24" class="i">+   Filter: test.value = &#39;b&#39;
</a>    └─ Aggregate: test.id, test.value
       └─ Scan: test
<a href="#h22-0-27" id="h22-0-27" class="d">-2, b
</a><a href="#h22-0-28" id="h22-0-28" class="i">+2, &#39;b&#39;
</a> 
 # Pushes down independent predicates from JOIN nodes.
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.value = &#39;a&#39; AND b.value = &#39;b&#39;
 ---
 Initial:
<a href="#h22-0-34" id="h22-0-34" class="d">-   NestedLoopJoin: inner on a.value = a AND b.value = b
</a><a href="#h22-0-35" id="h22-0-35" class="i">+   NestedLoopJoin: inner on a.value = &#39;a&#39; AND b.value = &#39;b&#39;
</a>    ├─ Scan: test as a
    └─ Scan: test as b
 Filter pushdown:
    NestedLoopJoin: inner
<a href="#h22-0-40" id="h22-0-40" class="d">-   ├─ Scan: test as a (a.value = a)
</a><a href="#h22-0-41" id="h22-0-41" class="d">-   └─ Scan: test as b (b.value = b)
</a><a href="#h22-0-42" id="h22-0-42" class="d">-1, a, 2, b
</a><a href="#h22-0-43" id="h22-0-43" class="i">+   ├─ Scan: test as a (a.value = &#39;a&#39;)
</a><a href="#h22-0-44" id="h22-0-44" class="i">+   └─ Scan: test as b (b.value = &#39;b&#39;)
</a><a href="#h22-0-45" id="h22-0-45" class="i">+1, &#39;a&#39;, 2, &#39;b&#39;
</a> 
 # Pushes down independent predicates from JOIN nodes, even when there
 # are also dependent predicates.
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.id = b.id AND a.value = &#39;a&#39; AND b.value = &#39;b&#39;
 ---
 Initial:
<a href="#h22-0-52" id="h22-0-52" class="d">-   NestedLoopJoin: inner on a.id = b.id AND a.value = a AND b.value = b
</a><a href="#h22-0-53" id="h22-0-53" class="i">+   NestedLoopJoin: inner on a.id = b.id AND a.value = &#39;a&#39; AND b.value = &#39;b&#39;
</a>    ├─ Scan: test as a
    └─ Scan: test as b
 Filter pushdown:
    NestedLoopJoin: inner on a.id = b.id
<a href="#h22-0-58" id="h22-0-58" class="d">-   ├─ Scan: test as a (a.value = a)
</a><a href="#h22-0-59" id="h22-0-59" class="d">-   └─ Scan: test as b (b.value = b)
</a><a href="#h22-0-60" id="h22-0-60" class="i">+   ├─ Scan: test as a (a.value = &#39;a&#39;)
</a><a href="#h22-0-61" id="h22-0-61" class="i">+   └─ Scan: test as b (b.value = &#39;b&#39;)
</a> Join type:
    HashJoin: inner on a.id = b.id
<a href="#h22-0-64" id="h22-0-64" class="d">-   ├─ Scan: test as a (a.value = a)
</a><a href="#h22-0-65" id="h22-0-65" class="d">-   └─ Scan: test as b (b.value = b)
</a><a href="#h22-0-66" id="h22-0-66" class="i">+   ├─ Scan: test as a (a.value = &#39;a&#39;)
</a><a href="#h22-0-67" id="h22-0-67" class="i">+   └─ Scan: test as b (b.value = &#39;b&#39;)
</a> 
 # Does not push down JOIN node OR predicates.
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.value = &#39;a&#39; OR b.value = &#39;b&#39;
 ---
 Initial:
<a href="#h22-0-73" id="h22-0-73" class="d">-   NestedLoopJoin: inner on a.value = a OR b.value = b
</a><a href="#h22-0-74" id="h22-0-74" class="i">+   NestedLoopJoin: inner on a.value = &#39;a&#39; OR b.value = &#39;b&#39;
</a>    ├─ Scan: test as a
    └─ Scan: test as b
<a href="#h22-0-77" id="h22-0-77" class="d">-1, a, 1, a
</a><a href="#h22-0-78" id="h22-0-78" class="d">-1, a, 2, b
</a><a href="#h22-0-79" id="h22-0-79" class="d">-1, a, 3, c
</a><a href="#h22-0-80" id="h22-0-80" class="d">-2, b, 2, b
</a><a href="#h22-0-81" id="h22-0-81" class="d">-3, c, 2, b
</a><a href="#h22-0-82" id="h22-0-82" class="i">+1, &#39;a&#39;, 1, &#39;a&#39;
</a><a href="#h22-0-83" id="h22-0-83" class="i">+1, &#39;a&#39;, 2, &#39;b&#39;
</a><a href="#h22-0-84" id="h22-0-84" class="i">+1, &#39;a&#39;, 3, &#39;c&#39;
</a><a href="#h22-0-85" id="h22-0-85" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;
</a><a href="#h22-0-86" id="h22-0-86" class="i">+3, &#39;c&#39;, 2, &#39;b&#39;
</a> 
 # Pushes WHERE predicates down into and past JOIN nodes.
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.id = b.id WHERE a.value = &#39;a&#39; AND b.value = &#39;b&#39;
 ---
 Initial:
<a href="#h22-0-92" id="h22-0-92" class="d">-   Filter: a.value = a AND b.value = b
</a><a href="#h22-0-93" id="h22-0-93" class="i">+   Filter: a.value = &#39;a&#39; AND b.value = &#39;b&#39;
</a>    └─ NestedLoopJoin: inner on a.id = b.id
       ├─ Scan: test as a
       └─ Scan: test as b
 Filter pushdown:
    NestedLoopJoin: inner on a.id = b.id
<a href="#h22-0-99" id="h22-0-99" class="d">-   ├─ Scan: test as a (a.value = a)
</a><a href="#h22-0-100" id="h22-0-100" class="d">-   └─ Scan: test as b (b.value = b)
</a><a href="#h22-0-101" id="h22-0-101" class="i">+   ├─ Scan: test as a (a.value = &#39;a&#39;)
</a><a href="#h22-0-102" id="h22-0-102" class="i">+   └─ Scan: test as b (b.value = &#39;b&#39;)
</a> Join type:
    HashJoin: inner on a.id = b.id
<a href="#h22-0-105" id="h22-0-105" class="d">-   ├─ Scan: test as a (a.value = a)
</a><a href="#h22-0-106" id="h22-0-106" class="d">-   └─ Scan: test as b (b.value = b)
</a><a href="#h22-0-107" id="h22-0-107" class="i">+   ├─ Scan: test as a (a.value = &#39;a&#39;)
</a><a href="#h22-0-108" id="h22-0-108" class="i">+   └─ Scan: test as b (b.value = &#39;b&#39;)
</a> 
 # Pushes down the parts of predicates that can be pushed.
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.id = b.id WHERE a.value = &#39;a&#39; AND b.value = &#39;b&#39; AND (a.id &gt; 0 OR b.id &gt; 0)
 ---
 Initial:
<a href="#h22-0-114" id="h22-0-114" class="d">-   Filter: a.value = a AND b.value = b AND (a.id &gt; 0 OR b.id &gt; 0)
</a><a href="#h22-0-115" id="h22-0-115" class="i">+   Filter: a.value = &#39;a&#39; AND b.value = &#39;b&#39; AND (a.id &gt; 0 OR b.id &gt; 0)
</a>    └─ NestedLoopJoin: inner on a.id = b.id
       ├─ Scan: test as a
       └─ Scan: test as b
 Filter pushdown:
    NestedLoopJoin: inner on (a.id &gt; 0 OR b.id &gt; 0) AND a.id = b.id
<a href="#h22-0-121" id="h22-0-121" class="d">-   ├─ Scan: test as a (a.value = a)
</a><a href="#h22-0-122" id="h22-0-122" class="d">-   └─ Scan: test as b (b.value = b)
</a><a href="#h22-0-123" id="h22-0-123" class="i">+   ├─ Scan: test as a (a.value = &#39;a&#39;)
</a><a href="#h22-0-124" id="h22-0-124" class="i">+   └─ Scan: test as b (b.value = &#39;b&#39;)
</a> 
 # Equijoin pushdowns can transfer lookups from one relation to the other to make
 # use of indexes.
<a href="#h22-1" id="h22-1" class="h">@@ -124,8 +124,8 @@ Join type:
</a>    HashJoin: inner on a.id = b.id
    ├─ KeyLookup: test as a (1, 2)
    └─ KeyLookup: test as b (1, 2)
<a href="#h22-1-3" id="h22-1-3" class="d">-1, a, 1, a
</a><a href="#h22-1-4" id="h22-1-4" class="d">-2, b, 2, b
</a><a href="#h22-1-5" id="h22-1-5" class="i">+1, &#39;a&#39;, 1, &#39;a&#39;
</a><a href="#h22-1-6" id="h22-1-6" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;
</a> 
 [opt]&gt; SELECT * FROM test a JOIN test b ON a.id = b.id WHERE (b.id = 1 OR b.id = 2)
 ---
<a href="#h22-2" id="h22-2" class="h">@@ -146,8 +146,8 @@ Join type:
</a>    HashJoin: inner on a.id = b.id
    ├─ KeyLookup: test as a (1, 2)
    └─ KeyLookup: test as b (1, 2)
<a href="#h22-2-3" id="h22-2-3" class="d">-1, a, 1, a
</a><a href="#h22-2-4" id="h22-2-4" class="d">-2, b, 2, b
</a><a href="#h22-2-5" id="h22-2-5" class="i">+1, &#39;a&#39;, 1, &#39;a&#39;
</a><a href="#h22-2-6" id="h22-2-6" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;
</a> 
 # Pushdowns can propagate through multiple JOIN nodes.
 [opt]&gt; SELECT * FROM \
<a href="#h22-3" id="h22-3" class="h">@@ -193,4 +193,4 @@ Join type:
</a>    │  └─ Filter: c.id &lt; 3 AND c.id = 2
    │     └─ KeyLookup: test as c (2, 3)
    └─ KeyLookup: test as d (2, 3)
<a href="#h22-3-3" id="h22-3-3" class="d">-2, b, 2, b, 2, b, 2, b
</a><a href="#h22-3-4" id="h22-3-4" class="i">+2, &#39;b&#39;, 2, &#39;b&#39;, 2, &#39;b&#39;, 2, &#39;b&#39;
</a><b>diff --git a/<a id="h23" href="../file/src/sql/testscripts/optimizer/short_circuit.html">src/sql/testscripts/optimizer/short_circuit</a> b/<a href="../file/src/sql/testscripts/optimizer/short_circuit.html">src/sql/testscripts/optimizer/short_circuit</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -17,9 +17,9 @@ Filter pushdown:
</a>    Scan: test (TRUE)
 Short circuit:
    Scan: test
<a href="#h23-0-3" id="h23-0-3" class="d">-1, a
</a><a href="#h23-0-4" id="h23-0-4" class="d">-2, b
</a><a href="#h23-0-5" id="h23-0-5" class="d">-3, c
</a><a href="#h23-0-6" id="h23-0-6" class="i">+1, &#39;a&#39;
</a><a href="#h23-0-7" id="h23-0-7" class="i">+2, &#39;b&#39;
</a><a href="#h23-0-8" id="h23-0-8" class="i">+3, &#39;c&#39;
</a> 
 [opt]&gt; SELECT 1, 2, 3 WHERE TRUE
 ---
<a href="#h23-1" id="h23-1" class="h">@@ -46,15 +46,15 @@ Short circuit:
</a>    NestedLoopJoin: inner
    ├─ Scan: test
    └─ Scan: ref
<a href="#h23-1-3" id="h23-1-3" class="d">-1, a, 1, 1
</a><a href="#h23-1-4" id="h23-1-4" class="d">-1, a, 2, 2
</a><a href="#h23-1-5" id="h23-1-5" class="d">-1, a, 3, 3
</a><a href="#h23-1-6" id="h23-1-6" class="d">-2, b, 1, 1
</a><a href="#h23-1-7" id="h23-1-7" class="d">-2, b, 2, 2
</a><a href="#h23-1-8" id="h23-1-8" class="d">-2, b, 3, 3
</a><a href="#h23-1-9" id="h23-1-9" class="d">-3, c, 1, 1
</a><a href="#h23-1-10" id="h23-1-10" class="d">-3, c, 2, 2
</a><a href="#h23-1-11" id="h23-1-11" class="d">-3, c, 3, 3
</a><a href="#h23-1-12" id="h23-1-12" class="i">+1, &#39;a&#39;, 1, 1
</a><a href="#h23-1-13" id="h23-1-13" class="i">+1, &#39;a&#39;, 2, 2
</a><a href="#h23-1-14" id="h23-1-14" class="i">+1, &#39;a&#39;, 3, 3
</a><a href="#h23-1-15" id="h23-1-15" class="i">+2, &#39;b&#39;, 1, 1
</a><a href="#h23-1-16" id="h23-1-16" class="i">+2, &#39;b&#39;, 2, 2
</a><a href="#h23-1-17" id="h23-1-17" class="i">+2, &#39;b&#39;, 3, 3
</a><a href="#h23-1-18" id="h23-1-18" class="i">+3, &#39;c&#39;, 1, 1
</a><a href="#h23-1-19" id="h23-1-19" class="i">+3, &#39;c&#39;, 2, 2
</a><a href="#h23-1-20" id="h23-1-20" class="i">+3, &#39;c&#39;, 3, 3
</a> 
 # FALSE predicates → Nothing (but retains column headers)
 [opt,header]&gt; SELECT * FROM test WHERE FALSE
<a href="#h23-2" id="h23-2" class="h">@@ -182,9 +182,9 @@ Initial:
</a>    └─ Scan: test
 Short circuit:
    Scan: test
<a href="#h23-2-3" id="h23-2-3" class="d">-1, a
</a><a href="#h23-2-4" id="h23-2-4" class="d">-2, b
</a><a href="#h23-2-5" id="h23-2-5" class="d">-3, c
</a><a href="#h23-2-6" id="h23-2-6" class="i">+1, &#39;a&#39;
</a><a href="#h23-2-7" id="h23-2-7" class="i">+2, &#39;b&#39;
</a><a href="#h23-2-8" id="h23-2-8" class="i">+3, &#39;c&#39;
</a> 
 [opt,header]&gt; SELECT id AS foo, value AS bar FROM test
 ---
<a href="#h23-3" id="h23-3" class="h">@@ -192,9 +192,9 @@ Initial:
</a>    Projection: test.id as foo, test.value as bar
    └─ Scan: test
 foo, bar
<a href="#h23-3-3" id="h23-3-3" class="d">-1, a
</a><a href="#h23-3-4" id="h23-3-4" class="d">-2, b
</a><a href="#h23-3-5" id="h23-3-5" class="d">-3, c
</a><a href="#h23-3-6" id="h23-3-6" class="i">+1, &#39;a&#39;
</a><a href="#h23-3-7" id="h23-3-7" class="i">+2, &#39;b&#39;
</a><a href="#h23-3-8" id="h23-3-8" class="i">+3, &#39;c&#39;
</a> 
 [opt]&gt; SELECT id, MIN(id), MAX(id) FROM test GROUP BY id
 ---
<b>diff --git a/<a id="h24" href="../file/src/sql/testscripts/queries/aggregate.html">src/sql/testscripts/queries/aggregate</a> b/<a href="../file/src/sql/testscripts/queries/aggregate.html">src/sql/testscripts/queries/aggregate</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -26,7 +26,7 @@ Aggregate: count(TRUE)
</a> # COUNT works on constant values.
 [plan,header]&gt; SELECT COUNT(NULL), COUNT(TRUE), COUNT(1), COUNT(3.14), COUNT(NAN), COUNT(&#39;&#39;)
 ---
<a href="#h24-0-3" id="h24-0-3" class="d">-Aggregate: count(NULL), count(TRUE), count(1), count(3.14), count(NaN), count()
</a><a href="#h24-0-4" id="h24-0-4" class="i">+Aggregate: count(NULL), count(TRUE), count(1), count(3.14), count(NaN), count(&#39;&#39;)
</a> └─ Values: blank row
 , , , , , 
 0, 1, 1, 1, 1, 1
<a href="#h24-1" id="h24-1" class="h">@@ -49,9 +49,9 @@ Aggregate: count(test.id), count(test.bool), count(test.float), count(test.strin
</a> # MAX works on constant values.
 [plan]&gt; SELECT MAX(NULL), MAX(TRUE), MAX(1), MAX(3.14), MAX(NAN), MAX(&#39;foo&#39;) FROM test
 ---
<a href="#h24-1-3" id="h24-1-3" class="d">-Aggregate: max(NULL), max(TRUE), max(1), max(3.14), max(NaN), max(foo)
</a><a href="#h24-1-4" id="h24-1-4" class="i">+Aggregate: max(NULL), max(TRUE), max(1), max(3.14), max(NaN), max(&#39;foo&#39;)
</a> └─ Scan: test
<a href="#h24-1-6" id="h24-1-6" class="d">-NULL, TRUE, 1, 3.14, NaN, foo
</a><a href="#h24-1-7" id="h24-1-7" class="i">+NULL, TRUE, 1, 3.14, NaN, &#39;foo&#39;
</a> 
 # MAX works on no rows.
 [plan]&gt; SELECT MAX(id), MAX(&quot;bool&quot;), MAX(&quot;float&quot;), MAX(&quot;string&quot;) FROM test WHERE false
<a href="#h24-2" id="h24-2" class="h">@@ -83,14 +83,14 @@ inf
</a> 
 &gt; SELECT MAX(&quot;string&quot;) FROM test
 ---
<a href="#h24-2-3" id="h24-2-3" class="d">-👋
</a><a href="#h24-2-4" id="h24-2-4" class="i">+&#39;👋&#39;
</a> 
 # MIN works on constant values.
 [plan]&gt; SELECT MIN(NULL), MIN(TRUE), MIN(1), MIN(3.14), MIN(NAN), MIN(&#39;foo&#39;) FROM test
 ---
<a href="#h24-2-9" id="h24-2-9" class="d">-Aggregate: min(NULL), min(TRUE), min(1), min(3.14), min(NaN), min(foo)
</a><a href="#h24-2-10" id="h24-2-10" class="i">+Aggregate: min(NULL), min(TRUE), min(1), min(3.14), min(NaN), min(&#39;foo&#39;)
</a> └─ Scan: test
<a href="#h24-2-12" id="h24-2-12" class="d">-NULL, TRUE, 1, 3.14, NaN, foo
</a><a href="#h24-2-13" id="h24-2-13" class="i">+NULL, TRUE, 1, 3.14, NaN, &#39;foo&#39;
</a> 
 # MIN works on no rows.
 [plan]&gt; SELECT MIN(id), MIN(&quot;bool&quot;), MIN(&quot;float&quot;), MIN(&quot;string&quot;) FROM test WHERE false
<a href="#h24-3" id="h24-3" class="h">@@ -120,7 +120,7 @@ FALSE
</a> 
 &gt; SELECT MIN(&quot;string&quot;) FROM test
 ---
<a href="#h24-3-3" id="h24-3-3" class="d">-&gt; 
</a><a href="#h24-3-4" id="h24-3-4" class="i">+&#39;&#39;
</a> 
 # SUM works on constant values, but only numbers.
 [plan]&gt; SELECT SUM(NULL), SUM(1), SUM(3.14), SUM(NAN) FROM test
<a href="#h24-4" id="h24-4" class="h">@@ -133,7 +133,7 @@ NULL, 6, 18.84, NaN
</a> !&gt; SELECT SUM(&#39;foo&#39;)
 ---
 Error: invalid input: can&#39;t add 0 and TRUE
<a href="#h24-4-3" id="h24-4-3" class="d">-Error: invalid input: can&#39;t add 0 and foo
</a><a href="#h24-4-4" id="h24-4-4" class="i">+Error: invalid input: can&#39;t add 0 and &#39;foo&#39;
</a> 
 # SUM works on no rows.
 [plan]&gt; SELECT SUM(id), SUM(&quot;bool&quot;), SUM(&quot;float&quot;), SUM(&quot;string&quot;) FROM test WHERE false
<a href="#h24-5" id="h24-5" class="h">@@ -166,7 +166,7 @@ inf
</a> 
 !&gt; SELECT SUM(&quot;string&quot;) FROM test
 ---
<a href="#h24-5-3" id="h24-5-3" class="d">-Error: invalid input: can&#39;t add 0 and 
</a><a href="#h24-5-4" id="h24-5-4" class="i">+Error: invalid input: can&#39;t add 0 and &#39;&#39;
</a> 
 # AVG works on constant values, but only numbers.
 [plan]&gt; SELECT AVG(NULL), AVG(1), AVG(3.14), AVG(NAN) FROM test
<a href="#h24-6" id="h24-6" class="h">@@ -179,7 +179,7 @@ NULL, 1, 3.14, NaN
</a> !&gt; SELECT AVG(&#39;foo&#39;)
 ---
 Error: invalid input: can&#39;t add 0 and TRUE
<a href="#h24-6-3" id="h24-6-3" class="d">-Error: invalid input: can&#39;t add 0 and foo
</a><a href="#h24-6-4" id="h24-6-4" class="i">+Error: invalid input: can&#39;t add 0 and &#39;foo&#39;
</a> 
 # AVG works on no rows.
 [plan]&gt; SELECT AVG(id), AVG(&quot;bool&quot;), AVG(&quot;float&quot;), AVG(&quot;string&quot;) FROM test WHERE false
<a href="#h24-7" id="h24-7" class="h">@@ -212,7 +212,7 @@ inf
</a> 
 !&gt; SELECT AVG(&quot;string&quot;) FROM test
 ---
<a href="#h24-7-3" id="h24-7-3" class="d">-Error: invalid input: can&#39;t add 0 and 
</a><a href="#h24-7-4" id="h24-7-4" class="i">+Error: invalid input: can&#39;t add 0 and &#39;&#39;
</a> 
 # Constant aggregates can be used with rows.
 [plan]&gt; SELECT COUNT(1), MIN(1), MAX(1), SUM(1), AVG(1) FROM test
<b>diff --git a/<a id="h25" href="../file/src/sql/testscripts/queries/group_by.html">src/sql/testscripts/queries/group_by</a> b/<a href="../file/src/sql/testscripts/queries/group_by.html">src/sql/testscripts/queries/group_by</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -34,8 +34,8 @@ Projection: #1, #2, #3, #4, #5
</a> Aggregate: test.group, count(TRUE)
 └─ Scan: test
 NULL, 1
<a href="#h25-0-3" id="h25-0-3" class="d">-a, 3
</a><a href="#h25-0-4" id="h25-0-4" class="d">-b, 3
</a><a href="#h25-0-5" id="h25-0-5" class="i">+&#39;a&#39;, 3
</a><a href="#h25-0-6" id="h25-0-6" class="i">+&#39;b&#39;, 3
</a> 
 [plan]&gt; SELECT &quot;group&quot;, COUNT(*), MIN(&quot;bool&quot;), MAX(&quot;string&quot;), SUM(&quot;int&quot;), AVG(&quot;float&quot;) \
     FROM test GROUP BY &quot;group&quot;
<a href="#h25-1" id="h25-1" class="h">@@ -43,8 +43,8 @@ b, 3
</a> Aggregate: test.group, count(TRUE), min(test.bool), max(test.string), sum(test.int), avg(test.float)
 └─ Scan: test
 NULL, 1, NULL, NULL, NULL, NULL
<a href="#h25-1-3" id="h25-1-3" class="d">-a, 3, FALSE, AB, 9, NaN
</a><a href="#h25-1-4" id="h25-1-4" class="d">-b, 3, FALSE, 👋, 41, NaN
</a><a href="#h25-1-5" id="h25-1-5" class="i">+&#39;a&#39;, 3, FALSE, &#39;AB&#39;, 9, NaN
</a><a href="#h25-1-6" id="h25-1-6" class="i">+&#39;b&#39;, 3, FALSE, &#39;👋&#39;, 41, NaN
</a> 
 # GROUP BY works on booleans.
 [plan]&gt; SELECT &quot;bool&quot;, COUNT(*) FROM test GROUP BY &quot;bool&quot;
<a href="#h25-2" id="h25-2" class="h">@@ -84,10 +84,10 @@ NaN, 2
</a> Aggregate: test.string, count(TRUE)
 └─ Scan: test
 NULL, 1
<a href="#h25-2-3" id="h25-2-3" class="d">-, 2
</a><a href="#h25-2-4" id="h25-2-4" class="d">-AB, 1
</a><a href="#h25-2-5" id="h25-2-5" class="d">-abc, 2
</a><a href="#h25-2-6" id="h25-2-6" class="d">-👋, 1
</a><a href="#h25-2-7" id="h25-2-7" class="i">+&#39;&#39;, 2
</a><a href="#h25-2-8" id="h25-2-8" class="i">+&#39;AB&#39;, 1
</a><a href="#h25-2-9" id="h25-2-9" class="i">+&#39;abc&#39;, 2
</a><a href="#h25-2-10" id="h25-2-10" class="i">+&#39;👋&#39;, 1
</a> 
 # GROUP BY works even if the group column isn&#39;t in the result.
 [plan]&gt; SELECT COUNT(*) FROM test GROUP BY &quot;group&quot;
<a href="#h25-3" id="h25-3" class="h">@@ -105,8 +105,8 @@ Projection: #1
</a> Aggregate: test.group
 └─ Scan: test
 NULL
<a href="#h25-3-3" id="h25-3-3" class="d">-a
</a><a href="#h25-3-4" id="h25-3-4" class="d">-b
</a><a href="#h25-3-5" id="h25-3-5" class="i">+&#39;a&#39;
</a><a href="#h25-3-6" id="h25-3-6" class="i">+&#39;b&#39;
</a> 
 # GROUP BY does not work with SELECT aliases (also the case in e.g. SQL server).
 !&gt; SELECT &quot;group&quot; AS g, COUNT(*) FROM test GROUP BY g
<a href="#h25-4" id="h25-4" class="h">@@ -118,8 +118,8 @@ Error: invalid input: unknown column g
</a> Aggregate: t.group, count(TRUE)
 └─ Scan: test as t
 NULL, 1
<a href="#h25-4-3" id="h25-4-3" class="d">-a, 3
</a><a href="#h25-4-4" id="h25-4-4" class="d">-b, 3
</a><a href="#h25-4-5" id="h25-4-5" class="i">+&#39;a&#39;, 3
</a><a href="#h25-4-6" id="h25-4-6" class="i">+&#39;b&#39;, 3
</a> 
 !&gt; SELECT &quot;group&quot;, COUNT(*) FROM test AS t GROUP BY test.&quot;group&quot;
 ---
<a href="#h25-5" id="h25-5" class="h">@@ -191,10 +191,10 @@ Error: invalid input: unknown function min with 1 arguments
</a> Aggregate: test.group, test.bool, count(TRUE)
 └─ Scan: test
 NULL, NULL, 1
<a href="#h25-5-3" id="h25-5-3" class="d">-a, FALSE, 1
</a><a href="#h25-5-4" id="h25-5-4" class="d">-a, TRUE, 2
</a><a href="#h25-5-5" id="h25-5-5" class="d">-b, FALSE, 2
</a><a href="#h25-5-6" id="h25-5-6" class="d">-b, TRUE, 1
</a><a href="#h25-5-7" id="h25-5-7" class="i">+&#39;a&#39;, FALSE, 1
</a><a href="#h25-5-8" id="h25-5-8" class="i">+&#39;a&#39;, TRUE, 2
</a><a href="#h25-5-9" id="h25-5-9" class="i">+&#39;b&#39;, FALSE, 2
</a><a href="#h25-5-10" id="h25-5-10" class="i">+&#39;b&#39;, TRUE, 1
</a> 
 # Repeated GROUP BY column works.
 [plan]&gt; SELECT &quot;group&quot;, &quot;group&quot;, &quot;group&quot;, COUNT(*) FROM test GROUP BY &quot;group&quot;, &quot;group&quot;
<a href="#h25-6" id="h25-6" class="h">@@ -203,8 +203,8 @@ Projection: test.group, test.group, test.group, #1
</a> └─ Aggregate: test.group, count(TRUE)
    └─ Scan: test
 NULL, NULL, NULL, 1
<a href="#h25-6-3" id="h25-6-3" class="d">-a, a, a, 3
</a><a href="#h25-6-4" id="h25-6-4" class="d">-b, b, b, 3
</a><a href="#h25-6-5" id="h25-6-5" class="i">+&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, 3
</a><a href="#h25-6-6" id="h25-6-6" class="i">+&#39;b&#39;, &#39;b&#39;, &#39;b&#39;, 3
</a> 
 # GROUP BY works with joins.
 [plan]&gt; SELECT t.id % 2, COUNT(*) FROM test t JOIN other o ON t.id % 2 = o.id GROUP BY t.id % 2
<a href="#h25-7" id="h25-7" class="h">@@ -225,12 +225,12 @@ Error: invalid input: column test.group must be used in an aggregate or GROUP BY
</a> Aggregate: test.id, test.group, test.bool, test.int, test.float, test.string
 └─ Scan: test
 0, NULL, NULL, NULL, NULL, NULL
<a href="#h25-7-3" id="h25-7-3" class="d">-1, a, TRUE, -1, 3.14, 
</a><a href="#h25-7-4" id="h25-7-4" class="d">-2, b, FALSE, 0, NaN, abc
</a><a href="#h25-7-5" id="h25-7-5" class="d">-3, a, TRUE, 3, 0.0, AB
</a><a href="#h25-7-6" id="h25-7-6" class="d">-4, b, TRUE, 42, inf, 👋
</a><a href="#h25-7-7" id="h25-7-7" class="d">-5, a, FALSE, 7, NaN, 
</a><a href="#h25-7-8" id="h25-7-8" class="d">-6, b, FALSE, -1, 0.0, abc
</a><a href="#h25-7-9" id="h25-7-9" class="i">+1, &#39;a&#39;, TRUE, -1, 3.14, &#39;&#39;
</a><a href="#h25-7-10" id="h25-7-10" class="i">+2, &#39;b&#39;, FALSE, 0, NaN, &#39;abc&#39;
</a><a href="#h25-7-11" id="h25-7-11" class="i">+3, &#39;a&#39;, TRUE, 3, 0.0, &#39;AB&#39;
</a><a href="#h25-7-12" id="h25-7-12" class="i">+4, &#39;b&#39;, TRUE, 42, inf, &#39;👋&#39;
</a><a href="#h25-7-13" id="h25-7-13" class="i">+5, &#39;a&#39;, FALSE, 7, NaN, &#39;&#39;
</a><a href="#h25-7-14" id="h25-7-14" class="i">+6, &#39;b&#39;, FALSE, -1, 0.0, &#39;abc&#39;
</a> 
 [plan]&gt; SELECT * FROM test GROUP BY &quot;bool&quot;, &quot;int&quot;, &quot;float&quot;, &quot;string&quot;, &quot;group&quot;, id
 ---
<a href="#h25-8" id="h25-8" class="h">@@ -238,9 +238,9 @@ Projection: test.id, test.group, test.bool, test.int, test.float, test.string
</a> └─ Aggregate: test.bool, test.int, test.float, test.string, test.group, test.id
    └─ Scan: test
 0, NULL, NULL, NULL, NULL, NULL
<a href="#h25-8-3" id="h25-8-3" class="d">-6, b, FALSE, -1, 0.0, abc
</a><a href="#h25-8-4" id="h25-8-4" class="d">-2, b, FALSE, 0, NaN, abc
</a><a href="#h25-8-5" id="h25-8-5" class="d">-5, a, FALSE, 7, NaN, 
</a><a href="#h25-8-6" id="h25-8-6" class="d">-1, a, TRUE, -1, 3.14, 
</a><a href="#h25-8-7" id="h25-8-7" class="d">-3, a, TRUE, 3, 0.0, AB
</a><a href="#h25-8-8" id="h25-8-8" class="d">-4, b, TRUE, 42, inf, 👋
</a><a href="#h25-8-9" id="h25-8-9" class="i">+6, &#39;b&#39;, FALSE, -1, 0.0, &#39;abc&#39;
</a><a href="#h25-8-10" id="h25-8-10" class="i">+2, &#39;b&#39;, FALSE, 0, NaN, &#39;abc&#39;
</a><a href="#h25-8-11" id="h25-8-11" class="i">+5, &#39;a&#39;, FALSE, 7, NaN, &#39;&#39;
</a><a href="#h25-8-12" id="h25-8-12" class="i">+1, &#39;a&#39;, TRUE, -1, 3.14, &#39;&#39;
</a><a href="#h25-8-13" id="h25-8-13" class="i">+3, &#39;a&#39;, TRUE, 3, 0.0, &#39;AB&#39;
</a><a href="#h25-8-14" id="h25-8-14" class="i">+4, &#39;b&#39;, TRUE, 42, inf, &#39;👋&#39;
</a><b>diff --git a/<a id="h26" href="../file/src/sql/testscripts/queries/having.html">src/sql/testscripts/queries/having</a> b/<a href="../file/src/sql/testscripts/queries/having.html">src/sql/testscripts/queries/having</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -42,7 +42,7 @@ TRUE
</a> Filter: #1 &gt; 10
 └─ Aggregate: test.group, max(test.int)
    └─ Scan: test
<a href="#h26-0-3" id="h26-0-3" class="d">-b, 42
</a><a href="#h26-0-4" id="h26-0-4" class="i">+&#39;b&#39;, 42
</a> 
 [plan]&gt; SELECT &quot;group&quot; FROM test GROUP BY &quot;group&quot; HAVING MAX(&quot;int&quot;) &gt; 10
 ---
<a href="#h26-1" id="h26-1" class="h">@@ -50,7 +50,7 @@ Remap: test.group (dropped: #1)
</a> └─ Filter: #1 &gt; 10
    └─ Aggregate: test.group, max(test.int)
       └─ Scan: test
<a href="#h26-1-3" id="h26-1-3" class="d">-b
</a><a href="#h26-1-4" id="h26-1-4" class="i">+&#39;b&#39;
</a> 
 [plan]&gt; SELECT &quot;group&quot;, MAX(&quot;int&quot;) FROM test GROUP BY &quot;group&quot; HAVING MAX(&quot;int&quot;) - MIN(&quot;int&quot;) &gt; 10
 ---
<a href="#h26-2" id="h26-2" class="h">@@ -58,7 +58,7 @@ Remap: test.group, #1 (dropped: #2)
</a> └─ Filter: #1 - #2 &gt; 10
    └─ Aggregate: test.group, max(test.int), min(test.int)
       └─ Scan: test
<a href="#h26-2-3" id="h26-2-3" class="d">-b, 42
</a><a href="#h26-2-4" id="h26-2-4" class="i">+&#39;b&#39;, 42
</a> 
 # Having works with SELECT aliases.
 [plan]&gt; SELECT &quot;group&quot;, MAX(&quot;int&quot;) AS m FROM test GROUP BY &quot;group&quot; HAVING m &gt; 10
<a href="#h26-3" id="h26-3" class="h">@@ -67,7 +67,7 @@ Filter: m &gt; 10
</a> └─ Projection: test.group, #1 as m
    └─ Aggregate: test.group, max(test.int)
       └─ Scan: test
<a href="#h26-3-3" id="h26-3-3" class="d">-b, 42
</a><a href="#h26-3-4" id="h26-3-4" class="i">+&#39;b&#39;, 42
</a> 
 # Having works with an aggregate function not in the SELECT clause.
 [plan]&gt; SELECT &quot;group&quot;, COUNT(*) FROM test GROUP BY &quot;group&quot; HAVING MAX(&quot;int&quot;) &gt; 10
<a href="#h26-4" id="h26-4" class="h">@@ -76,7 +76,7 @@ Remap: test.group, #1 (dropped: #2)
</a> └─ Filter: #2 &gt; 10
    └─ Aggregate: test.group, count(TRUE), max(test.int)
       └─ Scan: test
<a href="#h26-4-3" id="h26-4-3" class="d">-b, 3
</a><a href="#h26-4-4" id="h26-4-4" class="i">+&#39;b&#39;, 3
</a> 
 # Having works with compound expressions.
 [plan]&gt; SELECT &quot;group&quot;, COUNT(*) FROM test GROUP BY &quot;group&quot; HAVING MAX(&quot;int&quot;) / COUNT(*) &gt; 3
<a href="#h26-5" id="h26-5" class="h">@@ -85,7 +85,7 @@ Remap: test.group, #1 (dropped: #2)
</a> └─ Filter: #2 / #1 &gt; 3
    └─ Aggregate: test.group, count(TRUE), max(test.int)
       └─ Scan: test
<a href="#h26-5-3" id="h26-5-3" class="d">-b, 3
</a><a href="#h26-5-4" id="h26-5-4" class="i">+&#39;b&#39;, 3
</a> 
 # Having works with compound expressions using complex GROUP BY expressions
 # that are not on the SELECT clause.
<a href="#h26-6" id="h26-6" class="h">@@ -103,7 +103,7 @@ Remap: #0 (dropped: #1)
</a> [plan]&gt; SELECT COUNT(*) FROM test GROUP BY &quot;group&quot; HAVING test.&quot;group&quot; = &#39;a&#39;
 ---
 Remap: #0 (dropped: test.group)
<a href="#h26-6-3" id="h26-6-3" class="d">-└─ Filter: test.group = a
</a><a href="#h26-6-4" id="h26-6-4" class="i">+└─ Filter: test.group = &#39;a&#39;
</a>    └─ Projection: #1, test.group
       └─ Aggregate: test.group, count(TRUE)
          └─ Scan: test
<a href="#h26-7" id="h26-7" class="h">@@ -112,7 +112,7 @@ Remap: #0 (dropped: test.group)
</a> [plan]&gt; SELECT COUNT(*) FROM test GROUP BY test.&quot;group&quot; HAVING &quot;group&quot; = &#39;a&#39;
 ---
 Remap: #0 (dropped: test.group)
<a href="#h26-7-3" id="h26-7-3" class="d">-└─ Filter: test.group = a
</a><a href="#h26-7-4" id="h26-7-4" class="i">+└─ Filter: test.group = &#39;a&#39;
</a>    └─ Projection: #1, test.group
       └─ Aggregate: test.group, count(TRUE)
          └─ Scan: test
<b>diff --git a/<a id="h27" href="../file/src/sql/testscripts/queries/join_cross.html">src/sql/testscripts/queries/join_cross</a> b/<a href="../file/src/sql/testscripts/queries/join_cross.html">src/sql/testscripts/queries/join_cross</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -57,36 +57,36 @@ NestedLoopJoin: inner
</a> ├─ Scan: movies
 └─ Scan: genres
 movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, movies.rating, movies.ultrahd, genres.id, genres.name
<a href="#h27-0-3" id="h27-0-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h27-0-4" id="h27-0-4" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action
</a><a href="#h27-0-5" id="h27-0-5" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy
</a><a href="#h27-0-6" id="h27-0-6" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction
</a><a href="#h27-0-7" id="h27-0-7" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h27-0-8" id="h27-0-8" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy
</a><a href="#h27-0-9" id="h27-0-9" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h27-0-10" id="h27-0-10" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action
</a><a href="#h27-0-11" id="h27-0-11" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h27-0-12" id="h27-0-12" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction
</a><a href="#h27-0-13" id="h27-0-13" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h27-0-14" id="h27-0-14" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy
</a><a href="#h27-0-15" id="h27-0-15" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h27-0-16" id="h27-0-16" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action
</a><a href="#h27-0-17" id="h27-0-17" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy
</a><a href="#h27-0-18" id="h27-0-18" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h27-0-19" id="h27-0-19" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action
</a><a href="#h27-0-20" id="h27-0-20" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy
</a><a href="#h27-0-21" id="h27-0-21" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-0-22" id="h27-0-22" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action
</a><a href="#h27-0-23" id="h27-0-23" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy
</a><a href="#h27-0-24" id="h27-0-24" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction
</a><a href="#h27-0-25" id="h27-0-25" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action
</a><a href="#h27-0-26" id="h27-0-26" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h27-0-27" id="h27-0-27" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-0-28" id="h27-0-28" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action
</a><a href="#h27-0-29" id="h27-0-29" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h27-0-30" id="h27-0-30" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h27-0-31" id="h27-0-31" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action
</a><a href="#h27-0-32" id="h27-0-32" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy
</a><a href="#h27-0-33" id="h27-0-33" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-34" id="h27-0-34" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;
</a><a href="#h27-0-35" id="h27-0-35" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-0-36" id="h27-0-36" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-37" id="h27-0-37" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-0-38" id="h27-0-38" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-0-39" id="h27-0-39" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-40" id="h27-0-40" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;
</a><a href="#h27-0-41" id="h27-0-41" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-0-42" id="h27-0-42" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-43" id="h27-0-43" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-0-44" id="h27-0-44" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-0-45" id="h27-0-45" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-46" id="h27-0-46" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;
</a><a href="#h27-0-47" id="h27-0-47" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;
</a><a href="#h27-0-48" id="h27-0-48" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-49" id="h27-0-49" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;
</a><a href="#h27-0-50" id="h27-0-50" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-0-51" id="h27-0-51" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-52" id="h27-0-52" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-0-53" id="h27-0-53" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-0-54" id="h27-0-54" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-55" id="h27-0-55" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-0-56" id="h27-0-56" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-0-57" id="h27-0-57" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-58" id="h27-0-58" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-0-59" id="h27-0-59" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-0-60" id="h27-0-60" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-0-61" id="h27-0-61" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-0-62" id="h27-0-62" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;
</a> 
 # Explicit triple cross join.
 [plan,header]&gt; SELECT * FROM movies CROSS JOIN genres CROSS JOIN studios
<a href="#h27-1" id="h27-1" class="h">@@ -97,126 +97,126 @@ NestedLoopJoin: inner
</a> │  └─ Scan: genres
 └─ Scan: studios
 movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, movies.rating, movies.ultrahd, genres.id, genres.name, studios.id, studios.name, studios.country_id
<a href="#h27-1-3" id="h27-1-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-4" id="h27-1-4" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-5" id="h27-1-5" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-6" id="h27-1-6" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-7" id="h27-1-7" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-8" id="h27-1-8" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-9" id="h27-1-9" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-10" id="h27-1-10" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-11" id="h27-1-11" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-12" id="h27-1-12" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-13" id="h27-1-13" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-14" id="h27-1-14" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-15" id="h27-1-15" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-16" id="h27-1-16" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-17" id="h27-1-17" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-18" id="h27-1-18" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-19" id="h27-1-19" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-20" id="h27-1-20" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-21" id="h27-1-21" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-22" id="h27-1-22" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-23" id="h27-1-23" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-24" id="h27-1-24" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-25" id="h27-1-25" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-26" id="h27-1-26" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-27" id="h27-1-27" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-28" id="h27-1-28" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-29" id="h27-1-29" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-30" id="h27-1-30" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-31" id="h27-1-31" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-32" id="h27-1-32" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-33" id="h27-1-33" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-34" id="h27-1-34" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-35" id="h27-1-35" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-36" id="h27-1-36" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-37" id="h27-1-37" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-38" id="h27-1-38" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-39" id="h27-1-39" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-40" id="h27-1-40" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-41" id="h27-1-41" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-42" id="h27-1-42" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-43" id="h27-1-43" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-44" id="h27-1-44" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-45" id="h27-1-45" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-46" id="h27-1-46" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-47" id="h27-1-47" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-48" id="h27-1-48" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-49" id="h27-1-49" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-50" id="h27-1-50" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-51" id="h27-1-51" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-52" id="h27-1-52" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-53" id="h27-1-53" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-54" id="h27-1-54" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-55" id="h27-1-55" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-56" id="h27-1-56" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-57" id="h27-1-57" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-58" id="h27-1-58" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-59" id="h27-1-59" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-60" id="h27-1-60" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-61" id="h27-1-61" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-62" id="h27-1-62" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-63" id="h27-1-63" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-64" id="h27-1-64" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-65" id="h27-1-65" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-66" id="h27-1-66" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-67" id="h27-1-67" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-68" id="h27-1-68" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-69" id="h27-1-69" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-70" id="h27-1-70" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-71" id="h27-1-71" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-72" id="h27-1-72" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-73" id="h27-1-73" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-74" id="h27-1-74" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-75" id="h27-1-75" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-76" id="h27-1-76" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-77" id="h27-1-77" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-78" id="h27-1-78" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-79" id="h27-1-79" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-80" id="h27-1-80" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-81" id="h27-1-81" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-82" id="h27-1-82" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-83" id="h27-1-83" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-84" id="h27-1-84" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-85" id="h27-1-85" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-86" id="h27-1-86" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-87" id="h27-1-87" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-88" id="h27-1-88" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-89" id="h27-1-89" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-90" id="h27-1-90" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-91" id="h27-1-91" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-92" id="h27-1-92" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-93" id="h27-1-93" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-94" id="h27-1-94" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-95" id="h27-1-95" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-96" id="h27-1-96" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-97" id="h27-1-97" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-98" id="h27-1-98" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-99" id="h27-1-99" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-100" id="h27-1-100" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-101" id="h27-1-101" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-102" id="h27-1-102" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-103" id="h27-1-103" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-104" id="h27-1-104" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-105" id="h27-1-105" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-106" id="h27-1-106" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-107" id="h27-1-107" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-108" id="h27-1-108" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-109" id="h27-1-109" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-110" id="h27-1-110" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-111" id="h27-1-111" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-1-112" id="h27-1-112" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-1-113" id="h27-1-113" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-1-114" id="h27-1-114" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-1-115" id="h27-1-115" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-1-116" id="h27-1-116" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-1-117" id="h27-1-117" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-1-118" id="h27-1-118" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-1-119" id="h27-1-119" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-1-120" id="h27-1-120" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-1-121" id="h27-1-121" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-1-122" id="h27-1-122" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-1-123" id="h27-1-123" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-124" id="h27-1-124" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-125" id="h27-1-125" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-126" id="h27-1-126" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-127" id="h27-1-127" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-128" id="h27-1-128" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-129" id="h27-1-129" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-130" id="h27-1-130" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-131" id="h27-1-131" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-132" id="h27-1-132" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-133" id="h27-1-133" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-134" id="h27-1-134" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-135" id="h27-1-135" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-136" id="h27-1-136" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-137" id="h27-1-137" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-138" id="h27-1-138" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-139" id="h27-1-139" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-140" id="h27-1-140" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-141" id="h27-1-141" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-142" id="h27-1-142" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-143" id="h27-1-143" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-144" id="h27-1-144" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-145" id="h27-1-145" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-146" id="h27-1-146" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-147" id="h27-1-147" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-148" id="h27-1-148" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-149" id="h27-1-149" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-150" id="h27-1-150" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-151" id="h27-1-151" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-152" id="h27-1-152" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-153" id="h27-1-153" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-154" id="h27-1-154" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-155" id="h27-1-155" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-156" id="h27-1-156" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-157" id="h27-1-157" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-158" id="h27-1-158" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-159" id="h27-1-159" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-160" id="h27-1-160" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-161" id="h27-1-161" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-162" id="h27-1-162" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-163" id="h27-1-163" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-164" id="h27-1-164" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-165" id="h27-1-165" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-166" id="h27-1-166" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-167" id="h27-1-167" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-168" id="h27-1-168" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-169" id="h27-1-169" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-170" id="h27-1-170" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-171" id="h27-1-171" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-172" id="h27-1-172" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-173" id="h27-1-173" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-174" id="h27-1-174" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-175" id="h27-1-175" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-176" id="h27-1-176" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-177" id="h27-1-177" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-178" id="h27-1-178" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-179" id="h27-1-179" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-180" id="h27-1-180" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-181" id="h27-1-181" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-182" id="h27-1-182" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-183" id="h27-1-183" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-184" id="h27-1-184" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-185" id="h27-1-185" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-186" id="h27-1-186" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-187" id="h27-1-187" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-188" id="h27-1-188" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-189" id="h27-1-189" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-190" id="h27-1-190" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-191" id="h27-1-191" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-192" id="h27-1-192" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-193" id="h27-1-193" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-194" id="h27-1-194" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-195" id="h27-1-195" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-196" id="h27-1-196" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-197" id="h27-1-197" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-198" id="h27-1-198" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-199" id="h27-1-199" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-200" id="h27-1-200" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-201" id="h27-1-201" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-202" id="h27-1-202" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-203" id="h27-1-203" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-204" id="h27-1-204" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-205" id="h27-1-205" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-206" id="h27-1-206" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-207" id="h27-1-207" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-208" id="h27-1-208" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-209" id="h27-1-209" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-210" id="h27-1-210" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-211" id="h27-1-211" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-212" id="h27-1-212" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-213" id="h27-1-213" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-214" id="h27-1-214" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-215" id="h27-1-215" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-216" id="h27-1-216" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-217" id="h27-1-217" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-218" id="h27-1-218" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-219" id="h27-1-219" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-220" id="h27-1-220" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-221" id="h27-1-221" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-222" id="h27-1-222" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-223" id="h27-1-223" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-224" id="h27-1-224" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-225" id="h27-1-225" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-226" id="h27-1-226" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-227" id="h27-1-227" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-228" id="h27-1-228" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-229" id="h27-1-229" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-230" id="h27-1-230" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-231" id="h27-1-231" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-232" id="h27-1-232" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-233" id="h27-1-233" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-234" id="h27-1-234" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-235" id="h27-1-235" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-236" id="h27-1-236" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-237" id="h27-1-237" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-238" id="h27-1-238" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-1-239" id="h27-1-239" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-1-240" id="h27-1-240" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-1-241" id="h27-1-241" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-1-242" id="h27-1-242" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a> 
 # Explicit cross join with other order.
 [plan,header]&gt; SELECT * FROM studios CROSS JOIN movies CROSS JOIN genres
<a href="#h27-2" id="h27-2" class="h">@@ -227,126 +227,126 @@ NestedLoopJoin: inner
</a> │  └─ Scan: movies
 └─ Scan: genres
 studios.id, studios.name, studios.country_id, movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, movies.rating, movies.ultrahd, genres.id, genres.name
<a href="#h27-2-3" id="h27-2-3" class="d">-1, Mosfilm, ru, 1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h27-2-4" id="h27-2-4" class="d">-1, Mosfilm, ru, 1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action
</a><a href="#h27-2-5" id="h27-2-5" class="d">-1, Mosfilm, ru, 1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy
</a><a href="#h27-2-6" id="h27-2-6" class="d">-1, Mosfilm, ru, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction
</a><a href="#h27-2-7" id="h27-2-7" class="d">-1, Mosfilm, ru, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h27-2-8" id="h27-2-8" class="d">-1, Mosfilm, ru, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy
</a><a href="#h27-2-9" id="h27-2-9" class="d">-1, Mosfilm, ru, 3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h27-2-10" id="h27-2-10" class="d">-1, Mosfilm, ru, 3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action
</a><a href="#h27-2-11" id="h27-2-11" class="d">-1, Mosfilm, ru, 3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h27-2-12" id="h27-2-12" class="d">-1, Mosfilm, ru, 4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction
</a><a href="#h27-2-13" id="h27-2-13" class="d">-1, Mosfilm, ru, 4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h27-2-14" id="h27-2-14" class="d">-1, Mosfilm, ru, 4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy
</a><a href="#h27-2-15" id="h27-2-15" class="d">-1, Mosfilm, ru, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h27-2-16" id="h27-2-16" class="d">-1, Mosfilm, ru, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action
</a><a href="#h27-2-17" id="h27-2-17" class="d">-1, Mosfilm, ru, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy
</a><a href="#h27-2-18" id="h27-2-18" class="d">-1, Mosfilm, ru, 6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h27-2-19" id="h27-2-19" class="d">-1, Mosfilm, ru, 6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action
</a><a href="#h27-2-20" id="h27-2-20" class="d">-1, Mosfilm, ru, 6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy
</a><a href="#h27-2-21" id="h27-2-21" class="d">-1, Mosfilm, ru, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-2-22" id="h27-2-22" class="d">-1, Mosfilm, ru, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action
</a><a href="#h27-2-23" id="h27-2-23" class="d">-1, Mosfilm, ru, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy
</a><a href="#h27-2-24" id="h27-2-24" class="d">-1, Mosfilm, ru, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction
</a><a href="#h27-2-25" id="h27-2-25" class="d">-1, Mosfilm, ru, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action
</a><a href="#h27-2-26" id="h27-2-26" class="d">-1, Mosfilm, ru, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h27-2-27" id="h27-2-27" class="d">-1, Mosfilm, ru, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-2-28" id="h27-2-28" class="d">-1, Mosfilm, ru, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action
</a><a href="#h27-2-29" id="h27-2-29" class="d">-1, Mosfilm, ru, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h27-2-30" id="h27-2-30" class="d">-1, Mosfilm, ru, 10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h27-2-31" id="h27-2-31" class="d">-1, Mosfilm, ru, 10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action
</a><a href="#h27-2-32" id="h27-2-32" class="d">-1, Mosfilm, ru, 10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy
</a><a href="#h27-2-33" id="h27-2-33" class="d">-2, Lionsgate, us, 1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h27-2-34" id="h27-2-34" class="d">-2, Lionsgate, us, 1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action
</a><a href="#h27-2-35" id="h27-2-35" class="d">-2, Lionsgate, us, 1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy
</a><a href="#h27-2-36" id="h27-2-36" class="d">-2, Lionsgate, us, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction
</a><a href="#h27-2-37" id="h27-2-37" class="d">-2, Lionsgate, us, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h27-2-38" id="h27-2-38" class="d">-2, Lionsgate, us, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy
</a><a href="#h27-2-39" id="h27-2-39" class="d">-2, Lionsgate, us, 3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h27-2-40" id="h27-2-40" class="d">-2, Lionsgate, us, 3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action
</a><a href="#h27-2-41" id="h27-2-41" class="d">-2, Lionsgate, us, 3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h27-2-42" id="h27-2-42" class="d">-2, Lionsgate, us, 4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction
</a><a href="#h27-2-43" id="h27-2-43" class="d">-2, Lionsgate, us, 4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h27-2-44" id="h27-2-44" class="d">-2, Lionsgate, us, 4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy
</a><a href="#h27-2-45" id="h27-2-45" class="d">-2, Lionsgate, us, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h27-2-46" id="h27-2-46" class="d">-2, Lionsgate, us, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action
</a><a href="#h27-2-47" id="h27-2-47" class="d">-2, Lionsgate, us, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy
</a><a href="#h27-2-48" id="h27-2-48" class="d">-2, Lionsgate, us, 6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h27-2-49" id="h27-2-49" class="d">-2, Lionsgate, us, 6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action
</a><a href="#h27-2-50" id="h27-2-50" class="d">-2, Lionsgate, us, 6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy
</a><a href="#h27-2-51" id="h27-2-51" class="d">-2, Lionsgate, us, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-2-52" id="h27-2-52" class="d">-2, Lionsgate, us, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action
</a><a href="#h27-2-53" id="h27-2-53" class="d">-2, Lionsgate, us, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy
</a><a href="#h27-2-54" id="h27-2-54" class="d">-2, Lionsgate, us, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction
</a><a href="#h27-2-55" id="h27-2-55" class="d">-2, Lionsgate, us, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action
</a><a href="#h27-2-56" id="h27-2-56" class="d">-2, Lionsgate, us, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h27-2-57" id="h27-2-57" class="d">-2, Lionsgate, us, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-2-58" id="h27-2-58" class="d">-2, Lionsgate, us, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action
</a><a href="#h27-2-59" id="h27-2-59" class="d">-2, Lionsgate, us, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h27-2-60" id="h27-2-60" class="d">-2, Lionsgate, us, 10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h27-2-61" id="h27-2-61" class="d">-2, Lionsgate, us, 10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action
</a><a href="#h27-2-62" id="h27-2-62" class="d">-2, Lionsgate, us, 10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy
</a><a href="#h27-2-63" id="h27-2-63" class="d">-3, StudioCanal, fr, 1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h27-2-64" id="h27-2-64" class="d">-3, StudioCanal, fr, 1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action
</a><a href="#h27-2-65" id="h27-2-65" class="d">-3, StudioCanal, fr, 1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy
</a><a href="#h27-2-66" id="h27-2-66" class="d">-3, StudioCanal, fr, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction
</a><a href="#h27-2-67" id="h27-2-67" class="d">-3, StudioCanal, fr, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h27-2-68" id="h27-2-68" class="d">-3, StudioCanal, fr, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy
</a><a href="#h27-2-69" id="h27-2-69" class="d">-3, StudioCanal, fr, 3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h27-2-70" id="h27-2-70" class="d">-3, StudioCanal, fr, 3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action
</a><a href="#h27-2-71" id="h27-2-71" class="d">-3, StudioCanal, fr, 3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h27-2-72" id="h27-2-72" class="d">-3, StudioCanal, fr, 4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction
</a><a href="#h27-2-73" id="h27-2-73" class="d">-3, StudioCanal, fr, 4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h27-2-74" id="h27-2-74" class="d">-3, StudioCanal, fr, 4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy
</a><a href="#h27-2-75" id="h27-2-75" class="d">-3, StudioCanal, fr, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h27-2-76" id="h27-2-76" class="d">-3, StudioCanal, fr, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action
</a><a href="#h27-2-77" id="h27-2-77" class="d">-3, StudioCanal, fr, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy
</a><a href="#h27-2-78" id="h27-2-78" class="d">-3, StudioCanal, fr, 6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h27-2-79" id="h27-2-79" class="d">-3, StudioCanal, fr, 6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action
</a><a href="#h27-2-80" id="h27-2-80" class="d">-3, StudioCanal, fr, 6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy
</a><a href="#h27-2-81" id="h27-2-81" class="d">-3, StudioCanal, fr, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-2-82" id="h27-2-82" class="d">-3, StudioCanal, fr, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action
</a><a href="#h27-2-83" id="h27-2-83" class="d">-3, StudioCanal, fr, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy
</a><a href="#h27-2-84" id="h27-2-84" class="d">-3, StudioCanal, fr, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction
</a><a href="#h27-2-85" id="h27-2-85" class="d">-3, StudioCanal, fr, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action
</a><a href="#h27-2-86" id="h27-2-86" class="d">-3, StudioCanal, fr, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h27-2-87" id="h27-2-87" class="d">-3, StudioCanal, fr, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-2-88" id="h27-2-88" class="d">-3, StudioCanal, fr, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action
</a><a href="#h27-2-89" id="h27-2-89" class="d">-3, StudioCanal, fr, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h27-2-90" id="h27-2-90" class="d">-3, StudioCanal, fr, 10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h27-2-91" id="h27-2-91" class="d">-3, StudioCanal, fr, 10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action
</a><a href="#h27-2-92" id="h27-2-92" class="d">-3, StudioCanal, fr, 10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy
</a><a href="#h27-2-93" id="h27-2-93" class="d">-4, Warner Bros, us, 1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h27-2-94" id="h27-2-94" class="d">-4, Warner Bros, us, 1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action
</a><a href="#h27-2-95" id="h27-2-95" class="d">-4, Warner Bros, us, 1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy
</a><a href="#h27-2-96" id="h27-2-96" class="d">-4, Warner Bros, us, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction
</a><a href="#h27-2-97" id="h27-2-97" class="d">-4, Warner Bros, us, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h27-2-98" id="h27-2-98" class="d">-4, Warner Bros, us, 2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy
</a><a href="#h27-2-99" id="h27-2-99" class="d">-4, Warner Bros, us, 3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h27-2-100" id="h27-2-100" class="d">-4, Warner Bros, us, 3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action
</a><a href="#h27-2-101" id="h27-2-101" class="d">-4, Warner Bros, us, 3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h27-2-102" id="h27-2-102" class="d">-4, Warner Bros, us, 4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction
</a><a href="#h27-2-103" id="h27-2-103" class="d">-4, Warner Bros, us, 4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h27-2-104" id="h27-2-104" class="d">-4, Warner Bros, us, 4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy
</a><a href="#h27-2-105" id="h27-2-105" class="d">-4, Warner Bros, us, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h27-2-106" id="h27-2-106" class="d">-4, Warner Bros, us, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action
</a><a href="#h27-2-107" id="h27-2-107" class="d">-4, Warner Bros, us, 5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy
</a><a href="#h27-2-108" id="h27-2-108" class="d">-4, Warner Bros, us, 6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h27-2-109" id="h27-2-109" class="d">-4, Warner Bros, us, 6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action
</a><a href="#h27-2-110" id="h27-2-110" class="d">-4, Warner Bros, us, 6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy
</a><a href="#h27-2-111" id="h27-2-111" class="d">-4, Warner Bros, us, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-2-112" id="h27-2-112" class="d">-4, Warner Bros, us, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action
</a><a href="#h27-2-113" id="h27-2-113" class="d">-4, Warner Bros, us, 7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy
</a><a href="#h27-2-114" id="h27-2-114" class="d">-4, Warner Bros, us, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction
</a><a href="#h27-2-115" id="h27-2-115" class="d">-4, Warner Bros, us, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action
</a><a href="#h27-2-116" id="h27-2-116" class="d">-4, Warner Bros, us, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h27-2-117" id="h27-2-117" class="d">-4, Warner Bros, us, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction
</a><a href="#h27-2-118" id="h27-2-118" class="d">-4, Warner Bros, us, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action
</a><a href="#h27-2-119" id="h27-2-119" class="d">-4, Warner Bros, us, 9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h27-2-120" id="h27-2-120" class="d">-4, Warner Bros, us, 10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h27-2-121" id="h27-2-121" class="d">-4, Warner Bros, us, 10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action
</a><a href="#h27-2-122" id="h27-2-122" class="d">-4, Warner Bros, us, 10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy
</a><a href="#h27-2-123" id="h27-2-123" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-124" id="h27-2-124" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-125" id="h27-2-125" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-126" id="h27-2-126" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-127" id="h27-2-127" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-128" id="h27-2-128" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-129" id="h27-2-129" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-130" id="h27-2-130" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-131" id="h27-2-131" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-132" id="h27-2-132" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-133" id="h27-2-133" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-134" id="h27-2-134" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-135" id="h27-2-135" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-136" id="h27-2-136" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;
</a><a href="#h27-2-137" id="h27-2-137" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-138" id="h27-2-138" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-139" id="h27-2-139" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-140" id="h27-2-140" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-141" id="h27-2-141" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-142" id="h27-2-142" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-143" id="h27-2-143" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-144" id="h27-2-144" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-145" id="h27-2-145" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-146" id="h27-2-146" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-147" id="h27-2-147" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-148" id="h27-2-148" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-149" id="h27-2-149" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-150" id="h27-2-150" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-151" id="h27-2-151" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-152" id="h27-2-152" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-153" id="h27-2-153" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-154" id="h27-2-154" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-155" id="h27-2-155" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-156" id="h27-2-156" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-157" id="h27-2-157" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-158" id="h27-2-158" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-159" id="h27-2-159" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-160" id="h27-2-160" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-161" id="h27-2-161" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-162" id="h27-2-162" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-163" id="h27-2-163" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-164" id="h27-2-164" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-165" id="h27-2-165" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-166" id="h27-2-166" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;
</a><a href="#h27-2-167" id="h27-2-167" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-168" id="h27-2-168" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-169" id="h27-2-169" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-170" id="h27-2-170" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-171" id="h27-2-171" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-172" id="h27-2-172" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-173" id="h27-2-173" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-174" id="h27-2-174" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-175" id="h27-2-175" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-176" id="h27-2-176" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-177" id="h27-2-177" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-178" id="h27-2-178" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-179" id="h27-2-179" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-180" id="h27-2-180" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-181" id="h27-2-181" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-182" id="h27-2-182" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-183" id="h27-2-183" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-184" id="h27-2-184" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-185" id="h27-2-185" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-186" id="h27-2-186" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-187" id="h27-2-187" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-188" id="h27-2-188" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-189" id="h27-2-189" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-190" id="h27-2-190" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-191" id="h27-2-191" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-192" id="h27-2-192" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-193" id="h27-2-193" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-194" id="h27-2-194" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-195" id="h27-2-195" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-196" id="h27-2-196" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;
</a><a href="#h27-2-197" id="h27-2-197" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-198" id="h27-2-198" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-199" id="h27-2-199" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-200" id="h27-2-200" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-201" id="h27-2-201" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-202" id="h27-2-202" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-203" id="h27-2-203" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-204" id="h27-2-204" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-205" id="h27-2-205" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-206" id="h27-2-206" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-207" id="h27-2-207" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-208" id="h27-2-208" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-209" id="h27-2-209" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-210" id="h27-2-210" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-211" id="h27-2-211" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-212" id="h27-2-212" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-213" id="h27-2-213" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-214" id="h27-2-214" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-215" id="h27-2-215" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-216" id="h27-2-216" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-217" id="h27-2-217" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-218" id="h27-2-218" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-219" id="h27-2-219" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-220" id="h27-2-220" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-221" id="h27-2-221" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-222" id="h27-2-222" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-223" id="h27-2-223" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-224" id="h27-2-224" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-225" id="h27-2-225" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-226" id="h27-2-226" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;
</a><a href="#h27-2-227" id="h27-2-227" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-228" id="h27-2-228" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-229" id="h27-2-229" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;
</a><a href="#h27-2-230" id="h27-2-230" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;
</a><a href="#h27-2-231" id="h27-2-231" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-232" id="h27-2-232" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-233" id="h27-2-233" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-234" id="h27-2-234" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-235" id="h27-2-235" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-236" id="h27-2-236" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-237" id="h27-2-237" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-238" id="h27-2-238" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-239" id="h27-2-239" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h27-2-240" id="h27-2-240" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h27-2-241" id="h27-2-241" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;
</a><a href="#h27-2-242" id="h27-2-242" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;
</a> 
 # Implicit cross join.
 [plan,header]&gt; SELECT * FROM movies, genres, studios
<a href="#h27-3" id="h27-3" class="h">@@ -357,126 +357,126 @@ NestedLoopJoin: inner
</a> │  └─ Scan: genres
 └─ Scan: studios
 movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, movies.rating, movies.ultrahd, genres.id, genres.name, studios.id, studios.name, studios.country_id
<a href="#h27-3-3" id="h27-3-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-4" id="h27-3-4" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-5" id="h27-3-5" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-6" id="h27-3-6" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-7" id="h27-3-7" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-8" id="h27-3-8" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-9" id="h27-3-9" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-10" id="h27-3-10" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-11" id="h27-3-11" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-12" id="h27-3-12" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-13" id="h27-3-13" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-14" id="h27-3-14" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-15" id="h27-3-15" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-16" id="h27-3-16" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-17" id="h27-3-17" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-18" id="h27-3-18" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-19" id="h27-3-19" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-20" id="h27-3-20" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-21" id="h27-3-21" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-22" id="h27-3-22" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-23" id="h27-3-23" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-24" id="h27-3-24" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-25" id="h27-3-25" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-26" id="h27-3-26" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-27" id="h27-3-27" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-28" id="h27-3-28" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-29" id="h27-3-29" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-30" id="h27-3-30" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-31" id="h27-3-31" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-32" id="h27-3-32" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-33" id="h27-3-33" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-34" id="h27-3-34" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-35" id="h27-3-35" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-36" id="h27-3-36" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-37" id="h27-3-37" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-38" id="h27-3-38" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-39" id="h27-3-39" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-40" id="h27-3-40" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-41" id="h27-3-41" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-42" id="h27-3-42" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-43" id="h27-3-43" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-44" id="h27-3-44" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-45" id="h27-3-45" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-46" id="h27-3-46" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-47" id="h27-3-47" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-48" id="h27-3-48" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-49" id="h27-3-49" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-50" id="h27-3-50" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-51" id="h27-3-51" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-52" id="h27-3-52" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-53" id="h27-3-53" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-54" id="h27-3-54" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-55" id="h27-3-55" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-56" id="h27-3-56" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-57" id="h27-3-57" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-58" id="h27-3-58" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-59" id="h27-3-59" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-60" id="h27-3-60" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-61" id="h27-3-61" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-62" id="h27-3-62" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-63" id="h27-3-63" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-64" id="h27-3-64" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-65" id="h27-3-65" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-66" id="h27-3-66" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-67" id="h27-3-67" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-68" id="h27-3-68" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-69" id="h27-3-69" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-70" id="h27-3-70" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-71" id="h27-3-71" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-72" id="h27-3-72" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-73" id="h27-3-73" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-74" id="h27-3-74" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-75" id="h27-3-75" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-76" id="h27-3-76" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-77" id="h27-3-77" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-78" id="h27-3-78" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-79" id="h27-3-79" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-80" id="h27-3-80" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-81" id="h27-3-81" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-82" id="h27-3-82" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-83" id="h27-3-83" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-84" id="h27-3-84" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-85" id="h27-3-85" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-86" id="h27-3-86" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-87" id="h27-3-87" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-88" id="h27-3-88" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-89" id="h27-3-89" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-90" id="h27-3-90" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-91" id="h27-3-91" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-92" id="h27-3-92" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-93" id="h27-3-93" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-94" id="h27-3-94" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-95" id="h27-3-95" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-96" id="h27-3-96" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-97" id="h27-3-97" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-98" id="h27-3-98" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-99" id="h27-3-99" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-100" id="h27-3-100" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-101" id="h27-3-101" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-102" id="h27-3-102" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-103" id="h27-3-103" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-104" id="h27-3-104" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-105" id="h27-3-105" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-106" id="h27-3-106" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-107" id="h27-3-107" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-108" id="h27-3-108" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-109" id="h27-3-109" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-110" id="h27-3-110" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-111" id="h27-3-111" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-3-112" id="h27-3-112" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-3-113" id="h27-3-113" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-3-114" id="h27-3-114" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-3-115" id="h27-3-115" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-3-116" id="h27-3-116" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-3-117" id="h27-3-117" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-3-118" id="h27-3-118" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-3-119" id="h27-3-119" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-3-120" id="h27-3-120" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-3-121" id="h27-3-121" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-3-122" id="h27-3-122" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-3-123" id="h27-3-123" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-124" id="h27-3-124" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-125" id="h27-3-125" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-126" id="h27-3-126" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-127" id="h27-3-127" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-128" id="h27-3-128" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-129" id="h27-3-129" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-130" id="h27-3-130" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-131" id="h27-3-131" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-132" id="h27-3-132" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-133" id="h27-3-133" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-134" id="h27-3-134" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-135" id="h27-3-135" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-136" id="h27-3-136" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-137" id="h27-3-137" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-138" id="h27-3-138" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-139" id="h27-3-139" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-140" id="h27-3-140" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-141" id="h27-3-141" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-142" id="h27-3-142" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-143" id="h27-3-143" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-144" id="h27-3-144" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-145" id="h27-3-145" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-146" id="h27-3-146" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-147" id="h27-3-147" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-148" id="h27-3-148" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-149" id="h27-3-149" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-150" id="h27-3-150" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-151" id="h27-3-151" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-152" id="h27-3-152" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-153" id="h27-3-153" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-154" id="h27-3-154" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-155" id="h27-3-155" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-156" id="h27-3-156" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-157" id="h27-3-157" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-158" id="h27-3-158" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-159" id="h27-3-159" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-160" id="h27-3-160" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-161" id="h27-3-161" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-162" id="h27-3-162" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-163" id="h27-3-163" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-164" id="h27-3-164" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-165" id="h27-3-165" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-166" id="h27-3-166" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-167" id="h27-3-167" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-168" id="h27-3-168" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-169" id="h27-3-169" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-170" id="h27-3-170" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-171" id="h27-3-171" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-172" id="h27-3-172" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-173" id="h27-3-173" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-174" id="h27-3-174" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-175" id="h27-3-175" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-176" id="h27-3-176" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-177" id="h27-3-177" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-178" id="h27-3-178" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-179" id="h27-3-179" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-180" id="h27-3-180" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-181" id="h27-3-181" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-182" id="h27-3-182" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-183" id="h27-3-183" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-184" id="h27-3-184" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-185" id="h27-3-185" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-186" id="h27-3-186" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-187" id="h27-3-187" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-188" id="h27-3-188" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-189" id="h27-3-189" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-190" id="h27-3-190" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-191" id="h27-3-191" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-192" id="h27-3-192" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-193" id="h27-3-193" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-194" id="h27-3-194" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-195" id="h27-3-195" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-196" id="h27-3-196" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-197" id="h27-3-197" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-198" id="h27-3-198" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-199" id="h27-3-199" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-200" id="h27-3-200" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-201" id="h27-3-201" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-202" id="h27-3-202" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-203" id="h27-3-203" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-204" id="h27-3-204" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-205" id="h27-3-205" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-206" id="h27-3-206" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-207" id="h27-3-207" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-208" id="h27-3-208" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-209" id="h27-3-209" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-210" id="h27-3-210" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-211" id="h27-3-211" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-212" id="h27-3-212" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-213" id="h27-3-213" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-214" id="h27-3-214" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-215" id="h27-3-215" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-216" id="h27-3-216" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-217" id="h27-3-217" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-218" id="h27-3-218" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-219" id="h27-3-219" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-220" id="h27-3-220" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-221" id="h27-3-221" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-222" id="h27-3-222" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-223" id="h27-3-223" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-224" id="h27-3-224" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-225" id="h27-3-225" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-226" id="h27-3-226" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-227" id="h27-3-227" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-228" id="h27-3-228" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-229" id="h27-3-229" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-230" id="h27-3-230" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-231" id="h27-3-231" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-232" id="h27-3-232" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-233" id="h27-3-233" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-234" id="h27-3-234" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-235" id="h27-3-235" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-236" id="h27-3-236" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-237" id="h27-3-237" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-238" id="h27-3-238" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-3-239" id="h27-3-239" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-3-240" id="h27-3-240" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-3-241" id="h27-3-241" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-3-242" id="h27-3-242" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a> 
 # Aliased cross join.
 [plan,header]&gt; SELECT * FROM movies m, genres AS g, studios s
<a href="#h27-4" id="h27-4" class="h">@@ -487,126 +487,126 @@ NestedLoopJoin: inner
</a> │  └─ Scan: genres as g
 └─ Scan: studios as s
 m.id, m.title, m.studio_id, m.genre_id, m.released, m.rating, m.ultrahd, g.id, g.name, s.id, s.name, s.country_id
<a href="#h27-4-3" id="h27-4-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-4" id="h27-4-4" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-5" id="h27-4-5" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-6" id="h27-4-6" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-7" id="h27-4-7" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-8" id="h27-4-8" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-9" id="h27-4-9" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-10" id="h27-4-10" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-11" id="h27-4-11" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-12" id="h27-4-12" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-13" id="h27-4-13" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-14" id="h27-4-14" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-15" id="h27-4-15" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-16" id="h27-4-16" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-17" id="h27-4-17" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-18" id="h27-4-18" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-19" id="h27-4-19" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-20" id="h27-4-20" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-21" id="h27-4-21" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-22" id="h27-4-22" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-23" id="h27-4-23" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-24" id="h27-4-24" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-25" id="h27-4-25" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-26" id="h27-4-26" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-27" id="h27-4-27" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-28" id="h27-4-28" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-29" id="h27-4-29" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-30" id="h27-4-30" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-31" id="h27-4-31" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-32" id="h27-4-32" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-33" id="h27-4-33" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-34" id="h27-4-34" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-35" id="h27-4-35" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-36" id="h27-4-36" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-37" id="h27-4-37" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-38" id="h27-4-38" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-39" id="h27-4-39" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-40" id="h27-4-40" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-41" id="h27-4-41" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-42" id="h27-4-42" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-43" id="h27-4-43" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-44" id="h27-4-44" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-45" id="h27-4-45" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-46" id="h27-4-46" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-47" id="h27-4-47" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-48" id="h27-4-48" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-49" id="h27-4-49" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-50" id="h27-4-50" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-51" id="h27-4-51" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-52" id="h27-4-52" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-53" id="h27-4-53" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-54" id="h27-4-54" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-55" id="h27-4-55" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-56" id="h27-4-56" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-57" id="h27-4-57" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-58" id="h27-4-58" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-59" id="h27-4-59" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-60" id="h27-4-60" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-61" id="h27-4-61" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-62" id="h27-4-62" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-63" id="h27-4-63" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-64" id="h27-4-64" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-65" id="h27-4-65" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-66" id="h27-4-66" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-67" id="h27-4-67" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-68" id="h27-4-68" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-69" id="h27-4-69" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-70" id="h27-4-70" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-71" id="h27-4-71" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-72" id="h27-4-72" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-73" id="h27-4-73" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-74" id="h27-4-74" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-75" id="h27-4-75" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-76" id="h27-4-76" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-77" id="h27-4-77" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-78" id="h27-4-78" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-79" id="h27-4-79" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-80" id="h27-4-80" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-81" id="h27-4-81" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-82" id="h27-4-82" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-83" id="h27-4-83" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-84" id="h27-4-84" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-85" id="h27-4-85" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-86" id="h27-4-86" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-87" id="h27-4-87" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-88" id="h27-4-88" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-89" id="h27-4-89" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-90" id="h27-4-90" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-91" id="h27-4-91" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-92" id="h27-4-92" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-93" id="h27-4-93" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-94" id="h27-4-94" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-95" id="h27-4-95" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-96" id="h27-4-96" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-97" id="h27-4-97" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-98" id="h27-4-98" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-99" id="h27-4-99" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-100" id="h27-4-100" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-101" id="h27-4-101" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-102" id="h27-4-102" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-103" id="h27-4-103" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-104" id="h27-4-104" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-105" id="h27-4-105" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-106" id="h27-4-106" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-107" id="h27-4-107" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-108" id="h27-4-108" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-109" id="h27-4-109" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-110" id="h27-4-110" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-111" id="h27-4-111" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h27-4-112" id="h27-4-112" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 2, Lionsgate, us
</a><a href="#h27-4-113" id="h27-4-113" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h27-4-114" id="h27-4-114" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h27-4-115" id="h27-4-115" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 1, Mosfilm, ru
</a><a href="#h27-4-116" id="h27-4-116" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h27-4-117" id="h27-4-117" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 3, StudioCanal, fr
</a><a href="#h27-4-118" id="h27-4-118" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h27-4-119" id="h27-4-119" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 1, Mosfilm, ru
</a><a href="#h27-4-120" id="h27-4-120" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h27-4-121" id="h27-4-121" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 3, StudioCanal, fr
</a><a href="#h27-4-122" id="h27-4-122" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h27-4-123" id="h27-4-123" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-124" id="h27-4-124" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-125" id="h27-4-125" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-126" id="h27-4-126" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-127" id="h27-4-127" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-128" id="h27-4-128" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-129" id="h27-4-129" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-130" id="h27-4-130" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-131" id="h27-4-131" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-132" id="h27-4-132" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-133" id="h27-4-133" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-134" id="h27-4-134" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-135" id="h27-4-135" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-136" id="h27-4-136" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-137" id="h27-4-137" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-138" id="h27-4-138" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-139" id="h27-4-139" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-140" id="h27-4-140" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-141" id="h27-4-141" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-142" id="h27-4-142" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-143" id="h27-4-143" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-144" id="h27-4-144" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-145" id="h27-4-145" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-146" id="h27-4-146" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-147" id="h27-4-147" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-148" id="h27-4-148" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-149" id="h27-4-149" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-150" id="h27-4-150" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-151" id="h27-4-151" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-152" id="h27-4-152" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-153" id="h27-4-153" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-154" id="h27-4-154" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-155" id="h27-4-155" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-156" id="h27-4-156" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-157" id="h27-4-157" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-158" id="h27-4-158" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-159" id="h27-4-159" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-160" id="h27-4-160" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-161" id="h27-4-161" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-162" id="h27-4-162" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-163" id="h27-4-163" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-164" id="h27-4-164" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-165" id="h27-4-165" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-166" id="h27-4-166" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-167" id="h27-4-167" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-168" id="h27-4-168" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-169" id="h27-4-169" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-170" id="h27-4-170" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-171" id="h27-4-171" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-172" id="h27-4-172" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-173" id="h27-4-173" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-174" id="h27-4-174" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-175" id="h27-4-175" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-176" id="h27-4-176" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-177" id="h27-4-177" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-178" id="h27-4-178" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-179" id="h27-4-179" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-180" id="h27-4-180" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-181" id="h27-4-181" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-182" id="h27-4-182" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-183" id="h27-4-183" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-184" id="h27-4-184" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-185" id="h27-4-185" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-186" id="h27-4-186" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-187" id="h27-4-187" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-188" id="h27-4-188" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-189" id="h27-4-189" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-190" id="h27-4-190" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-191" id="h27-4-191" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-192" id="h27-4-192" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-193" id="h27-4-193" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-194" id="h27-4-194" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-195" id="h27-4-195" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-196" id="h27-4-196" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-197" id="h27-4-197" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-198" id="h27-4-198" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-199" id="h27-4-199" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-200" id="h27-4-200" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-201" id="h27-4-201" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-202" id="h27-4-202" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-203" id="h27-4-203" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-204" id="h27-4-204" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-205" id="h27-4-205" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-206" id="h27-4-206" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-207" id="h27-4-207" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-208" id="h27-4-208" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-209" id="h27-4-209" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-210" id="h27-4-210" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-211" id="h27-4-211" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-212" id="h27-4-212" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-213" id="h27-4-213" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-214" id="h27-4-214" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-215" id="h27-4-215" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-216" id="h27-4-216" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-217" id="h27-4-217" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-218" id="h27-4-218" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-219" id="h27-4-219" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-220" id="h27-4-220" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-221" id="h27-4-221" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-222" id="h27-4-222" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-223" id="h27-4-223" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-224" id="h27-4-224" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-225" id="h27-4-225" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-226" id="h27-4-226" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-227" id="h27-4-227" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-228" id="h27-4-228" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-229" id="h27-4-229" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-230" id="h27-4-230" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-231" id="h27-4-231" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-232" id="h27-4-232" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-233" id="h27-4-233" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-234" id="h27-4-234" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-235" id="h27-4-235" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-236" id="h27-4-236" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-237" id="h27-4-237" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-238" id="h27-4-238" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h27-4-239" id="h27-4-239" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h27-4-240" id="h27-4-240" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h27-4-241" id="h27-4-241" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h27-4-242" id="h27-4-242" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a> 
 # Cross join with self errors.
 !&gt; SELECT * FROM genres, genres
<a href="#h27-5" id="h27-5" class="h">@@ -622,33 +622,33 @@ NestedLoopJoin: inner
</a> │  └─ Scan: genres as b
 └─ Scan: genres as c
 a.id, a.name, b.id, b.name, c.id, c.name
<a href="#h27-5-3" id="h27-5-3" class="d">-1, Science Fiction, 1, Science Fiction, 1, Science Fiction
</a><a href="#h27-5-4" id="h27-5-4" class="d">-1, Science Fiction, 1, Science Fiction, 2, Action
</a><a href="#h27-5-5" id="h27-5-5" class="d">-1, Science Fiction, 1, Science Fiction, 3, Comedy
</a><a href="#h27-5-6" id="h27-5-6" class="d">-1, Science Fiction, 2, Action, 1, Science Fiction
</a><a href="#h27-5-7" id="h27-5-7" class="d">-1, Science Fiction, 2, Action, 2, Action
</a><a href="#h27-5-8" id="h27-5-8" class="d">-1, Science Fiction, 2, Action, 3, Comedy
</a><a href="#h27-5-9" id="h27-5-9" class="d">-1, Science Fiction, 3, Comedy, 1, Science Fiction
</a><a href="#h27-5-10" id="h27-5-10" class="d">-1, Science Fiction, 3, Comedy, 2, Action
</a><a href="#h27-5-11" id="h27-5-11" class="d">-1, Science Fiction, 3, Comedy, 3, Comedy
</a><a href="#h27-5-12" id="h27-5-12" class="d">-2, Action, 1, Science Fiction, 1, Science Fiction
</a><a href="#h27-5-13" id="h27-5-13" class="d">-2, Action, 1, Science Fiction, 2, Action
</a><a href="#h27-5-14" id="h27-5-14" class="d">-2, Action, 1, Science Fiction, 3, Comedy
</a><a href="#h27-5-15" id="h27-5-15" class="d">-2, Action, 2, Action, 1, Science Fiction
</a><a href="#h27-5-16" id="h27-5-16" class="d">-2, Action, 2, Action, 2, Action
</a><a href="#h27-5-17" id="h27-5-17" class="d">-2, Action, 2, Action, 3, Comedy
</a><a href="#h27-5-18" id="h27-5-18" class="d">-2, Action, 3, Comedy, 1, Science Fiction
</a><a href="#h27-5-19" id="h27-5-19" class="d">-2, Action, 3, Comedy, 2, Action
</a><a href="#h27-5-20" id="h27-5-20" class="d">-2, Action, 3, Comedy, 3, Comedy
</a><a href="#h27-5-21" id="h27-5-21" class="d">-3, Comedy, 1, Science Fiction, 1, Science Fiction
</a><a href="#h27-5-22" id="h27-5-22" class="d">-3, Comedy, 1, Science Fiction, 2, Action
</a><a href="#h27-5-23" id="h27-5-23" class="d">-3, Comedy, 1, Science Fiction, 3, Comedy
</a><a href="#h27-5-24" id="h27-5-24" class="d">-3, Comedy, 2, Action, 1, Science Fiction
</a><a href="#h27-5-25" id="h27-5-25" class="d">-3, Comedy, 2, Action, 2, Action
</a><a href="#h27-5-26" id="h27-5-26" class="d">-3, Comedy, 2, Action, 3, Comedy
</a><a href="#h27-5-27" id="h27-5-27" class="d">-3, Comedy, 3, Comedy, 1, Science Fiction
</a><a href="#h27-5-28" id="h27-5-28" class="d">-3, Comedy, 3, Comedy, 2, Action
</a><a href="#h27-5-29" id="h27-5-29" class="d">-3, Comedy, 3, Comedy, 3, Comedy
</a><a href="#h27-5-30" id="h27-5-30" class="i">+1, &#39;Science Fiction&#39;, 1, &#39;Science Fiction&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-31" id="h27-5-31" class="i">+1, &#39;Science Fiction&#39;, 1, &#39;Science Fiction&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-32" id="h27-5-32" class="i">+1, &#39;Science Fiction&#39;, 1, &#39;Science Fiction&#39;, 3, &#39;Comedy&#39;
</a><a href="#h27-5-33" id="h27-5-33" class="i">+1, &#39;Science Fiction&#39;, 2, &#39;Action&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-34" id="h27-5-34" class="i">+1, &#39;Science Fiction&#39;, 2, &#39;Action&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-35" id="h27-5-35" class="i">+1, &#39;Science Fiction&#39;, 2, &#39;Action&#39;, 3, &#39;Comedy&#39;
</a><a href="#h27-5-36" id="h27-5-36" class="i">+1, &#39;Science Fiction&#39;, 3, &#39;Comedy&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-37" id="h27-5-37" class="i">+1, &#39;Science Fiction&#39;, 3, &#39;Comedy&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-38" id="h27-5-38" class="i">+1, &#39;Science Fiction&#39;, 3, &#39;Comedy&#39;, 3, &#39;Comedy&#39;
</a><a href="#h27-5-39" id="h27-5-39" class="i">+2, &#39;Action&#39;, 1, &#39;Science Fiction&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-40" id="h27-5-40" class="i">+2, &#39;Action&#39;, 1, &#39;Science Fiction&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-41" id="h27-5-41" class="i">+2, &#39;Action&#39;, 1, &#39;Science Fiction&#39;, 3, &#39;Comedy&#39;
</a><a href="#h27-5-42" id="h27-5-42" class="i">+2, &#39;Action&#39;, 2, &#39;Action&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-43" id="h27-5-43" class="i">+2, &#39;Action&#39;, 2, &#39;Action&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-44" id="h27-5-44" class="i">+2, &#39;Action&#39;, 2, &#39;Action&#39;, 3, &#39;Comedy&#39;
</a><a href="#h27-5-45" id="h27-5-45" class="i">+2, &#39;Action&#39;, 3, &#39;Comedy&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-46" id="h27-5-46" class="i">+2, &#39;Action&#39;, 3, &#39;Comedy&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-47" id="h27-5-47" class="i">+2, &#39;Action&#39;, 3, &#39;Comedy&#39;, 3, &#39;Comedy&#39;
</a><a href="#h27-5-48" id="h27-5-48" class="i">+3, &#39;Comedy&#39;, 1, &#39;Science Fiction&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-49" id="h27-5-49" class="i">+3, &#39;Comedy&#39;, 1, &#39;Science Fiction&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-50" id="h27-5-50" class="i">+3, &#39;Comedy&#39;, 1, &#39;Science Fiction&#39;, 3, &#39;Comedy&#39;
</a><a href="#h27-5-51" id="h27-5-51" class="i">+3, &#39;Comedy&#39;, 2, &#39;Action&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-52" id="h27-5-52" class="i">+3, &#39;Comedy&#39;, 2, &#39;Action&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-53" id="h27-5-53" class="i">+3, &#39;Comedy&#39;, 2, &#39;Action&#39;, 3, &#39;Comedy&#39;
</a><a href="#h27-5-54" id="h27-5-54" class="i">+3, &#39;Comedy&#39;, 3, &#39;Comedy&#39;, 1, &#39;Science Fiction&#39;
</a><a href="#h27-5-55" id="h27-5-55" class="i">+3, &#39;Comedy&#39;, 3, &#39;Comedy&#39;, 2, &#39;Action&#39;
</a><a href="#h27-5-56" id="h27-5-56" class="i">+3, &#39;Comedy&#39;, 3, &#39;Comedy&#39;, 3, &#39;Comedy&#39;
</a> 
 # Duplicate aliases error.
 !&gt; SELECT * FROM movies a, genres a
<b>diff --git a/<a id="h28" href="../file/src/sql/testscripts/queries/join_inner.html">src/sql/testscripts/queries/join_inner</a> b/<a href="../file/src/sql/testscripts/queries/join_inner.html">src/sql/testscripts/queries/join_inner</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -57,16 +57,16 @@ HashJoin: inner on movies.genre_id = genres.id
</a> ├─ Scan: movies
 └─ Scan: genres
 movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, movies.rating, movies.ultrahd, genres.id, genres.name
<a href="#h28-0-3" id="h28-0-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h28-0-4" id="h28-0-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h28-0-5" id="h28-0-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h28-0-6" id="h28-0-6" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h28-0-7" id="h28-0-7" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h28-0-8" id="h28-0-8" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h28-0-9" id="h28-0-9" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h28-0-10" id="h28-0-10" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h28-0-11" id="h28-0-11" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h28-0-12" id="h28-0-12" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h28-0-13" id="h28-0-13" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-0-14" id="h28-0-14" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-0-15" id="h28-0-15" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-0-16" id="h28-0-16" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-0-17" id="h28-0-17" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-0-18" id="h28-0-18" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-0-19" id="h28-0-19" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-0-20" id="h28-0-20" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-0-21" id="h28-0-21" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-0-22" id="h28-0-22" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a> 
 # Implicit inner join.
 [plan,header]&gt; SELECT * FROM movies JOIN genres ON movies.genre_id = genres.id
<a href="#h28-1" id="h28-1" class="h">@@ -75,16 +75,16 @@ HashJoin: inner on movies.genre_id = genres.id
</a> ├─ Scan: movies
 └─ Scan: genres
 movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, movies.rating, movies.ultrahd, genres.id, genres.name
<a href="#h28-1-3" id="h28-1-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h28-1-4" id="h28-1-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h28-1-5" id="h28-1-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h28-1-6" id="h28-1-6" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h28-1-7" id="h28-1-7" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h28-1-8" id="h28-1-8" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h28-1-9" id="h28-1-9" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h28-1-10" id="h28-1-10" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h28-1-11" id="h28-1-11" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h28-1-12" id="h28-1-12" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h28-1-13" id="h28-1-13" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-1-14" id="h28-1-14" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-1-15" id="h28-1-15" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-1-16" id="h28-1-16" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-1-17" id="h28-1-17" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-1-18" id="h28-1-18" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-1-19" id="h28-1-19" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-1-20" id="h28-1-20" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-1-21" id="h28-1-21" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-1-22" id="h28-1-22" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a> 
 # Implicit inner join with cross join and WHERE.
 [plan,header]&gt; SELECT * FROM movies, genres WHERE movies.genre_id = genres.id
<a href="#h28-2" id="h28-2" class="h">@@ -93,16 +93,16 @@ HashJoin: inner on movies.genre_id = genres.id
</a> ├─ Scan: movies
 └─ Scan: genres
 movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, movies.rating, movies.ultrahd, genres.id, genres.name
<a href="#h28-2-3" id="h28-2-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h28-2-4" id="h28-2-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h28-2-5" id="h28-2-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h28-2-6" id="h28-2-6" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h28-2-7" id="h28-2-7" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h28-2-8" id="h28-2-8" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h28-2-9" id="h28-2-9" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h28-2-10" id="h28-2-10" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h28-2-11" id="h28-2-11" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h28-2-12" id="h28-2-12" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h28-2-13" id="h28-2-13" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-2-14" id="h28-2-14" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-2-15" id="h28-2-15" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-2-16" id="h28-2-16" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-2-17" id="h28-2-17" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-2-18" id="h28-2-18" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-2-19" id="h28-2-19" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-2-20" id="h28-2-20" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-2-21" id="h28-2-21" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-2-22" id="h28-2-22" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a> 
 # Three-way inner join.
 [plan,header]&gt; SELECT * FROM movies \
<a href="#h28-3" id="h28-3" class="h">@@ -115,16 +115,16 @@ HashJoin: inner on movies.studio_id = studios.id
</a> │  └─ Scan: genres
 └─ Scan: studios
 movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, movies.rating, movies.ultrahd, genres.id, genres.name, studios.id, studios.name, studios.country_id
<a href="#h28-3-3" id="h28-3-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h28-3-4" id="h28-3-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h28-3-5" id="h28-3-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h28-3-6" id="h28-3-6" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h28-3-7" id="h28-3-7" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h28-3-8" id="h28-3-8" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h28-3-9" id="h28-3-9" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h28-3-10" id="h28-3-10" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h28-3-11" id="h28-3-11" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h28-3-12" id="h28-3-12" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h28-3-13" id="h28-3-13" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h28-3-14" id="h28-3-14" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h28-3-15" id="h28-3-15" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h28-3-16" id="h28-3-16" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h28-3-17" id="h28-3-17" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h28-3-18" id="h28-3-18" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h28-3-19" id="h28-3-19" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h28-3-20" id="h28-3-20" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h28-3-21" id="h28-3-21" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h28-3-22" id="h28-3-22" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a> 
 # Inner join on TRUE and FALSE.
 [plan]&gt; SELECT * FROM movies INNER JOIN genres ON TRUE
<a href="#h28-4" id="h28-4" class="h">@@ -132,36 +132,36 @@ movies.id, movies.title, movies.studio_id, movies.genre_id, movies.released, mov
</a> NestedLoopJoin: inner
 ├─ Scan: movies
 └─ Scan: genres
<a href="#h28-4-3" id="h28-4-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h28-4-4" id="h28-4-4" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action
</a><a href="#h28-4-5" id="h28-4-5" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy
</a><a href="#h28-4-6" id="h28-4-6" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 1, Science Fiction
</a><a href="#h28-4-7" id="h28-4-7" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h28-4-8" id="h28-4-8" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy
</a><a href="#h28-4-9" id="h28-4-9" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction
</a><a href="#h28-4-10" id="h28-4-10" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 2, Action
</a><a href="#h28-4-11" id="h28-4-11" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h28-4-12" id="h28-4-12" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 1, Science Fiction
</a><a href="#h28-4-13" id="h28-4-13" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action
</a><a href="#h28-4-14" id="h28-4-14" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 3, Comedy
</a><a href="#h28-4-15" id="h28-4-15" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction
</a><a href="#h28-4-16" id="h28-4-16" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 2, Action
</a><a href="#h28-4-17" id="h28-4-17" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 3, Comedy
</a><a href="#h28-4-18" id="h28-4-18" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction
</a><a href="#h28-4-19" id="h28-4-19" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 2, Action
</a><a href="#h28-4-20" id="h28-4-20" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 3, Comedy
</a><a href="#h28-4-21" id="h28-4-21" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction
</a><a href="#h28-4-22" id="h28-4-22" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 2, Action
</a><a href="#h28-4-23" id="h28-4-23" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 3, Comedy
</a><a href="#h28-4-24" id="h28-4-24" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 1, Science Fiction
</a><a href="#h28-4-25" id="h28-4-25" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 2, Action
</a><a href="#h28-4-26" id="h28-4-26" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy
</a><a href="#h28-4-27" id="h28-4-27" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 1, Science Fiction
</a><a href="#h28-4-28" id="h28-4-28" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 2, Action
</a><a href="#h28-4-29" id="h28-4-29" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy
</a><a href="#h28-4-30" id="h28-4-30" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction
</a><a href="#h28-4-31" id="h28-4-31" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 2, Action
</a><a href="#h28-4-32" id="h28-4-32" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 3, Comedy
</a><a href="#h28-4-33" id="h28-4-33" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-34" id="h28-4-34" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;
</a><a href="#h28-4-35" id="h28-4-35" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;
</a><a href="#h28-4-36" id="h28-4-36" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-37" id="h28-4-37" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-4-38" id="h28-4-38" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-4-39" id="h28-4-39" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-40" id="h28-4-40" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 2, &#39;Action&#39;
</a><a href="#h28-4-41" id="h28-4-41" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h28-4-42" id="h28-4-42" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-43" id="h28-4-43" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-4-44" id="h28-4-44" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-4-45" id="h28-4-45" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-46" id="h28-4-46" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 2, &#39;Action&#39;
</a><a href="#h28-4-47" id="h28-4-47" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 3, &#39;Comedy&#39;
</a><a href="#h28-4-48" id="h28-4-48" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-49" id="h28-4-49" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 2, &#39;Action&#39;
</a><a href="#h28-4-50" id="h28-4-50" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 3, &#39;Comedy&#39;
</a><a href="#h28-4-51" id="h28-4-51" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-52" id="h28-4-52" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-4-53" id="h28-4-53" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-4-54" id="h28-4-54" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-55" id="h28-4-55" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-4-56" id="h28-4-56" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-4-57" id="h28-4-57" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-58" id="h28-4-58" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-4-59" id="h28-4-59" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h28-4-60" id="h28-4-60" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;
</a><a href="#h28-4-61" id="h28-4-61" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 2, &#39;Action&#39;
</a><a href="#h28-4-62" id="h28-4-62" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 3, &#39;Comedy&#39;
</a> 
 [plan]&gt; SELECT * FROM movies INNER JOIN genres ON FALSE
 ---
<a href="#h28-5" id="h28-5" class="h">@@ -173,8 +173,8 @@ Nothing
</a> NestedLoopJoin: inner on movies.genre_id = genres.id AND movies.id = genres.id
 ├─ Scan: movies
 └─ Scan: genres
<a href="#h28-5-3" id="h28-5-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h28-5-4" id="h28-5-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h28-5-5" id="h28-5-5" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h28-5-6" id="h28-5-6" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a> 
 # Aliased inner join.
 [plan]&gt; SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id INNER JOIN studios AS s ON m.studio_id = s.id
<a href="#h28-6" id="h28-6" class="h">@@ -184,16 +184,16 @@ HashJoin: inner on m.studio_id = s.id
</a> │  ├─ Scan: movies as m
 │  └─ Scan: genres as g
 └─ Scan: studios as s
<a href="#h28-6-3" id="h28-6-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h28-6-4" id="h28-6-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action, 2, Lionsgate, us
</a><a href="#h28-6-5" id="h28-6-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 1, Science Fiction, 3, StudioCanal, fr
</a><a href="#h28-6-6" id="h28-6-6" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, 2, Action, 4, Warner Bros, us
</a><a href="#h28-6-7" id="h28-6-7" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h28-6-8" id="h28-6-8" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, 1, Science Fiction, 1, Mosfilm, ru
</a><a href="#h28-6-9" id="h28-6-9" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h28-6-10" id="h28-6-10" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, 3, Comedy, 2, Lionsgate, us
</a><a href="#h28-6-11" id="h28-6-11" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, 3, Comedy, 4, Warner Bros, us
</a><a href="#h28-6-12" id="h28-6-12" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, 1, Science Fiction, 4, Warner Bros, us
</a><a href="#h28-6-13" id="h28-6-13" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h28-6-14" id="h28-6-14" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h28-6-15" id="h28-6-15" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 1, &#39;Science Fiction&#39;, 3, &#39;StudioCanal&#39;, &#39;fr&#39;
</a><a href="#h28-6-16" id="h28-6-16" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, 2, &#39;Action&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h28-6-17" id="h28-6-17" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h28-6-18" id="h28-6-18" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, 1, &#39;Science Fiction&#39;, 1, &#39;Mosfilm&#39;, &#39;ru&#39;
</a><a href="#h28-6-19" id="h28-6-19" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h28-6-20" id="h28-6-20" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, 3, &#39;Comedy&#39;, 2, &#39;Lionsgate&#39;, &#39;us&#39;
</a><a href="#h28-6-21" id="h28-6-21" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, 3, &#39;Comedy&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a><a href="#h28-6-22" id="h28-6-22" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, 1, &#39;Science Fiction&#39;, 4, &#39;Warner Bros&#39;, &#39;us&#39;
</a> 
 # Inner join with missing ON errors.
 !&gt; SELECT * FROM movies INNER JOIN genres
<a href="#h28-7" id="h28-7" class="h">@@ -219,16 +219,16 @@ Projection: movies.title, genres.name
</a> └─ HashJoin: inner on movies.genre_id = genres.id
    ├─ Scan: movies
    └─ Scan: genres
<a href="#h28-7-3" id="h28-7-3" class="d">-Stalker, Science Fiction
</a><a href="#h28-7-4" id="h28-7-4" class="d">-Sicario, Action
</a><a href="#h28-7-5" id="h28-7-5" class="d">-Primer, Science Fiction
</a><a href="#h28-7-6" id="h28-7-6" class="d">-Heat, Action
</a><a href="#h28-7-7" id="h28-7-7" class="d">-The Fountain, Science Fiction
</a><a href="#h28-7-8" id="h28-7-8" class="d">-Solaris, Science Fiction
</a><a href="#h28-7-9" id="h28-7-9" class="d">-Gravity, Science Fiction
</a><a href="#h28-7-10" id="h28-7-10" class="d">-Blindspotting, Comedy
</a><a href="#h28-7-11" id="h28-7-11" class="d">-Birdman, Comedy
</a><a href="#h28-7-12" id="h28-7-12" class="d">-Inception, Science Fiction
</a><a href="#h28-7-13" id="h28-7-13" class="i">+&#39;Stalker&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-7-14" id="h28-7-14" class="i">+&#39;Sicario&#39;, &#39;Action&#39;
</a><a href="#h28-7-15" id="h28-7-15" class="i">+&#39;Primer&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-7-16" id="h28-7-16" class="i">+&#39;Heat&#39;, &#39;Action&#39;
</a><a href="#h28-7-17" id="h28-7-17" class="i">+&#39;The Fountain&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-7-18" id="h28-7-18" class="i">+&#39;Solaris&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-7-19" id="h28-7-19" class="i">+&#39;Gravity&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-7-20" id="h28-7-20" class="i">+&#39;Blindspotting&#39;, &#39;Comedy&#39;
</a><a href="#h28-7-21" id="h28-7-21" class="i">+&#39;Birdman&#39;, &#39;Comedy&#39;
</a><a href="#h28-7-22" id="h28-7-22" class="i">+&#39;Inception&#39;, &#39;Science Fiction&#39;
</a> 
 [plan]&gt; SELECT movies.title, genres.name FROM genres JOIN movies ON genres.id = movies.genre_id
 ---
<a href="#h28-8" id="h28-8" class="h">@@ -236,16 +236,16 @@ Projection: movies.title, genres.name
</a> └─ HashJoin: inner on genres.id = movies.genre_id
    ├─ Scan: genres
    └─ Scan: movies
<a href="#h28-8-3" id="h28-8-3" class="d">-Stalker, Science Fiction
</a><a href="#h28-8-4" id="h28-8-4" class="d">-Primer, Science Fiction
</a><a href="#h28-8-5" id="h28-8-5" class="d">-The Fountain, Science Fiction
</a><a href="#h28-8-6" id="h28-8-6" class="d">-Solaris, Science Fiction
</a><a href="#h28-8-7" id="h28-8-7" class="d">-Gravity, Science Fiction
</a><a href="#h28-8-8" id="h28-8-8" class="d">-Inception, Science Fiction
</a><a href="#h28-8-9" id="h28-8-9" class="d">-Sicario, Action
</a><a href="#h28-8-10" id="h28-8-10" class="d">-Heat, Action
</a><a href="#h28-8-11" id="h28-8-11" class="d">-Blindspotting, Comedy
</a><a href="#h28-8-12" id="h28-8-12" class="d">-Birdman, Comedy
</a><a href="#h28-8-13" id="h28-8-13" class="i">+&#39;Stalker&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-8-14" id="h28-8-14" class="i">+&#39;Primer&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-8-15" id="h28-8-15" class="i">+&#39;The Fountain&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-8-16" id="h28-8-16" class="i">+&#39;Solaris&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-8-17" id="h28-8-17" class="i">+&#39;Gravity&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-8-18" id="h28-8-18" class="i">+&#39;Inception&#39;, &#39;Science Fiction&#39;
</a><a href="#h28-8-19" id="h28-8-19" class="i">+&#39;Sicario&#39;, &#39;Action&#39;
</a><a href="#h28-8-20" id="h28-8-20" class="i">+&#39;Heat&#39;, &#39;Action&#39;
</a><a href="#h28-8-21" id="h28-8-21" class="i">+&#39;Blindspotting&#39;, &#39;Comedy&#39;
</a><a href="#h28-8-22" id="h28-8-22" class="i">+&#39;Birdman&#39;, &#39;Comedy&#39;
</a> 
 # Also try multi-match self hash joins joins on ultrahd, where both sides have
 # multiple matches. Note that NULL matches are ignored.
<a href="#h28-9" id="h28-9" class="h">@@ -255,43 +255,43 @@ Projection: a.title, b.title
</a> └─ HashJoin: inner on a.ultrahd = b.ultrahd
    ├─ Scan: movies as a
    └─ Scan: movies as b
<a href="#h28-9-3" id="h28-9-3" class="d">-Sicario, Sicario
</a><a href="#h28-9-4" id="h28-9-4" class="d">-Sicario, Heat
</a><a href="#h28-9-5" id="h28-9-5" class="d">-Sicario, Gravity
</a><a href="#h28-9-6" id="h28-9-6" class="d">-Sicario, Blindspotting
</a><a href="#h28-9-7" id="h28-9-7" class="d">-Sicario, Birdman
</a><a href="#h28-9-8" id="h28-9-8" class="d">-Sicario, Inception
</a><a href="#h28-9-9" id="h28-9-9" class="d">-Heat, Sicario
</a><a href="#h28-9-10" id="h28-9-10" class="d">-Heat, Heat
</a><a href="#h28-9-11" id="h28-9-11" class="d">-Heat, Gravity
</a><a href="#h28-9-12" id="h28-9-12" class="d">-Heat, Blindspotting
</a><a href="#h28-9-13" id="h28-9-13" class="d">-Heat, Birdman
</a><a href="#h28-9-14" id="h28-9-14" class="d">-Heat, Inception
</a><a href="#h28-9-15" id="h28-9-15" class="d">-The Fountain, The Fountain
</a><a href="#h28-9-16" id="h28-9-16" class="d">-Gravity, Sicario
</a><a href="#h28-9-17" id="h28-9-17" class="d">-Gravity, Heat
</a><a href="#h28-9-18" id="h28-9-18" class="d">-Gravity, Gravity
</a><a href="#h28-9-19" id="h28-9-19" class="d">-Gravity, Blindspotting
</a><a href="#h28-9-20" id="h28-9-20" class="d">-Gravity, Birdman
</a><a href="#h28-9-21" id="h28-9-21" class="d">-Gravity, Inception
</a><a href="#h28-9-22" id="h28-9-22" class="d">-Blindspotting, Sicario
</a><a href="#h28-9-23" id="h28-9-23" class="d">-Blindspotting, Heat
</a><a href="#h28-9-24" id="h28-9-24" class="d">-Blindspotting, Gravity
</a><a href="#h28-9-25" id="h28-9-25" class="d">-Blindspotting, Blindspotting
</a><a href="#h28-9-26" id="h28-9-26" class="d">-Blindspotting, Birdman
</a><a href="#h28-9-27" id="h28-9-27" class="d">-Blindspotting, Inception
</a><a href="#h28-9-28" id="h28-9-28" class="d">-Birdman, Sicario
</a><a href="#h28-9-29" id="h28-9-29" class="d">-Birdman, Heat
</a><a href="#h28-9-30" id="h28-9-30" class="d">-Birdman, Gravity
</a><a href="#h28-9-31" id="h28-9-31" class="d">-Birdman, Blindspotting
</a><a href="#h28-9-32" id="h28-9-32" class="d">-Birdman, Birdman
</a><a href="#h28-9-33" id="h28-9-33" class="d">-Birdman, Inception
</a><a href="#h28-9-34" id="h28-9-34" class="d">-Inception, Sicario
</a><a href="#h28-9-35" id="h28-9-35" class="d">-Inception, Heat
</a><a href="#h28-9-36" id="h28-9-36" class="d">-Inception, Gravity
</a><a href="#h28-9-37" id="h28-9-37" class="d">-Inception, Blindspotting
</a><a href="#h28-9-38" id="h28-9-38" class="d">-Inception, Birdman
</a><a href="#h28-9-39" id="h28-9-39" class="d">-Inception, Inception
</a><a href="#h28-9-40" id="h28-9-40" class="i">+&#39;Sicario&#39;, &#39;Sicario&#39;
</a><a href="#h28-9-41" id="h28-9-41" class="i">+&#39;Sicario&#39;, &#39;Heat&#39;
</a><a href="#h28-9-42" id="h28-9-42" class="i">+&#39;Sicario&#39;, &#39;Gravity&#39;
</a><a href="#h28-9-43" id="h28-9-43" class="i">+&#39;Sicario&#39;, &#39;Blindspotting&#39;
</a><a href="#h28-9-44" id="h28-9-44" class="i">+&#39;Sicario&#39;, &#39;Birdman&#39;
</a><a href="#h28-9-45" id="h28-9-45" class="i">+&#39;Sicario&#39;, &#39;Inception&#39;
</a><a href="#h28-9-46" id="h28-9-46" class="i">+&#39;Heat&#39;, &#39;Sicario&#39;
</a><a href="#h28-9-47" id="h28-9-47" class="i">+&#39;Heat&#39;, &#39;Heat&#39;
</a><a href="#h28-9-48" id="h28-9-48" class="i">+&#39;Heat&#39;, &#39;Gravity&#39;
</a><a href="#h28-9-49" id="h28-9-49" class="i">+&#39;Heat&#39;, &#39;Blindspotting&#39;
</a><a href="#h28-9-50" id="h28-9-50" class="i">+&#39;Heat&#39;, &#39;Birdman&#39;
</a><a href="#h28-9-51" id="h28-9-51" class="i">+&#39;Heat&#39;, &#39;Inception&#39;
</a><a href="#h28-9-52" id="h28-9-52" class="i">+&#39;The Fountain&#39;, &#39;The Fountain&#39;
</a><a href="#h28-9-53" id="h28-9-53" class="i">+&#39;Gravity&#39;, &#39;Sicario&#39;
</a><a href="#h28-9-54" id="h28-9-54" class="i">+&#39;Gravity&#39;, &#39;Heat&#39;
</a><a href="#h28-9-55" id="h28-9-55" class="i">+&#39;Gravity&#39;, &#39;Gravity&#39;
</a><a href="#h28-9-56" id="h28-9-56" class="i">+&#39;Gravity&#39;, &#39;Blindspotting&#39;
</a><a href="#h28-9-57" id="h28-9-57" class="i">+&#39;Gravity&#39;, &#39;Birdman&#39;
</a><a href="#h28-9-58" id="h28-9-58" class="i">+&#39;Gravity&#39;, &#39;Inception&#39;
</a><a href="#h28-9-59" id="h28-9-59" class="i">+&#39;Blindspotting&#39;, &#39;Sicario&#39;
</a><a href="#h28-9-60" id="h28-9-60" class="i">+&#39;Blindspotting&#39;, &#39;Heat&#39;
</a><a href="#h28-9-61" id="h28-9-61" class="i">+&#39;Blindspotting&#39;, &#39;Gravity&#39;
</a><a href="#h28-9-62" id="h28-9-62" class="i">+&#39;Blindspotting&#39;, &#39;Blindspotting&#39;
</a><a href="#h28-9-63" id="h28-9-63" class="i">+&#39;Blindspotting&#39;, &#39;Birdman&#39;
</a><a href="#h28-9-64" id="h28-9-64" class="i">+&#39;Blindspotting&#39;, &#39;Inception&#39;
</a><a href="#h28-9-65" id="h28-9-65" class="i">+&#39;Birdman&#39;, &#39;Sicario&#39;
</a><a href="#h28-9-66" id="h28-9-66" class="i">+&#39;Birdman&#39;, &#39;Heat&#39;
</a><a href="#h28-9-67" id="h28-9-67" class="i">+&#39;Birdman&#39;, &#39;Gravity&#39;
</a><a href="#h28-9-68" id="h28-9-68" class="i">+&#39;Birdman&#39;, &#39;Blindspotting&#39;
</a><a href="#h28-9-69" id="h28-9-69" class="i">+&#39;Birdman&#39;, &#39;Birdman&#39;
</a><a href="#h28-9-70" id="h28-9-70" class="i">+&#39;Birdman&#39;, &#39;Inception&#39;
</a><a href="#h28-9-71" id="h28-9-71" class="i">+&#39;Inception&#39;, &#39;Sicario&#39;
</a><a href="#h28-9-72" id="h28-9-72" class="i">+&#39;Inception&#39;, &#39;Heat&#39;
</a><a href="#h28-9-73" id="h28-9-73" class="i">+&#39;Inception&#39;, &#39;Gravity&#39;
</a><a href="#h28-9-74" id="h28-9-74" class="i">+&#39;Inception&#39;, &#39;Blindspotting&#39;
</a><a href="#h28-9-75" id="h28-9-75" class="i">+&#39;Inception&#39;, &#39;Birdman&#39;
</a><a href="#h28-9-76" id="h28-9-76" class="i">+&#39;Inception&#39;, &#39;Inception&#39;
</a> 
 # Try a complex multi-way join with multiple joins of the same table. Uses GROUP
 # BY to discard duplicates from the cross join. The query finds all movies
<a href="#h28-10" id="h28-10" class="h">@@ -314,10 +314,10 @@ Remap: m.id, m.title, genre, studio, m.rating (dropped: m.released)
</a>             └─ HashJoin: inner on s.id = good.studio_id
                ├─ Scan: studios as s
                └─ Scan: movies as good (good.rating &gt; 8 OR good.rating = 8)
<a href="#h28-10-3" id="h28-10-3" class="d">-10, Inception, Science Fiction, Warner Bros, 8.8
</a><a href="#h28-10-4" id="h28-10-4" class="d">-1, Stalker, Science Fiction, Mosfilm, 8.2
</a><a href="#h28-10-5" id="h28-10-5" class="d">-4, Heat, Action, Warner Bros, 8.2
</a><a href="#h28-10-6" id="h28-10-6" class="d">-6, Solaris, Science Fiction, Mosfilm, 8.1
</a><a href="#h28-10-7" id="h28-10-7" class="d">-7, Gravity, Science Fiction, Warner Bros, 7.7
</a><a href="#h28-10-8" id="h28-10-8" class="d">-9, Birdman, Comedy, Warner Bros, 7.7
</a><a href="#h28-10-9" id="h28-10-9" class="d">-5, The Fountain, Science Fiction, Warner Bros, 7.2
</a><a href="#h28-10-10" id="h28-10-10" class="i">+10, &#39;Inception&#39;, &#39;Science Fiction&#39;, &#39;Warner Bros&#39;, 8.8
</a><a href="#h28-10-11" id="h28-10-11" class="i">+1, &#39;Stalker&#39;, &#39;Science Fiction&#39;, &#39;Mosfilm&#39;, 8.2
</a><a href="#h28-10-12" id="h28-10-12" class="i">+4, &#39;Heat&#39;, &#39;Action&#39;, &#39;Warner Bros&#39;, 8.2
</a><a href="#h28-10-13" id="h28-10-13" class="i">+6, &#39;Solaris&#39;, &#39;Science Fiction&#39;, &#39;Mosfilm&#39;, 8.1
</a><a href="#h28-10-14" id="h28-10-14" class="i">+7, &#39;Gravity&#39;, &#39;Science Fiction&#39;, &#39;Warner Bros&#39;, 7.7
</a><a href="#h28-10-15" id="h28-10-15" class="i">+9, &#39;Birdman&#39;, &#39;Comedy&#39;, &#39;Warner Bros&#39;, 7.7
</a><a href="#h28-10-16" id="h28-10-16" class="i">+5, &#39;The Fountain&#39;, &#39;Science Fiction&#39;, &#39;Warner Bros&#39;, 7.2
</a><b>diff --git a/<a id="h29" href="../file/src/sql/testscripts/queries/join_outer.html">src/sql/testscripts/queries/join_outer</a> b/<a href="../file/src/sql/testscripts/queries/join_outer.html">src/sql/testscripts/queries/join_outer</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -56,16 +56,16 @@ ok
</a> HashJoin: outer on movies.id = genres.id
 ├─ Scan: movies
 └─ Scan: genres
<a href="#h29-0-3" id="h29-0-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h29-0-4" id="h29-0-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h29-0-5" id="h29-0-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h29-0-6" id="h29-0-6" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, NULL, NULL
</a><a href="#h29-0-7" id="h29-0-7" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, NULL, NULL
</a><a href="#h29-0-8" id="h29-0-8" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, NULL, NULL
</a><a href="#h29-0-9" id="h29-0-9" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, NULL, NULL
</a><a href="#h29-0-10" id="h29-0-10" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, NULL, NULL
</a><a href="#h29-0-11" id="h29-0-11" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, NULL, NULL
</a><a href="#h29-0-12" id="h29-0-12" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, NULL, NULL
</a><a href="#h29-0-13" id="h29-0-13" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h29-0-14" id="h29-0-14" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h29-0-15" id="h29-0-15" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h29-0-16" id="h29-0-16" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, NULL, NULL
</a><a href="#h29-0-17" id="h29-0-17" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, NULL, NULL
</a><a href="#h29-0-18" id="h29-0-18" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, NULL, NULL
</a><a href="#h29-0-19" id="h29-0-19" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, NULL, NULL
</a><a href="#h29-0-20" id="h29-0-20" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, NULL, NULL
</a><a href="#h29-0-21" id="h29-0-21" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, NULL, NULL
</a><a href="#h29-0-22" id="h29-0-22" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, NULL, NULL
</a> 
 # Right join.
 [plan]&gt; SELECT * FROM genres RIGHT JOIN movies ON movies.id = genres.id
<a href="#h29-1" id="h29-1" class="h">@@ -74,16 +74,16 @@ Remap: genres.id, genres.name, movies.id, movies.title, movies.studio_id, movies
</a> └─ HashJoin: outer on movies.id = genres.id
    ├─ Scan: movies
    └─ Scan: genres
<a href="#h29-1-3" id="h29-1-3" class="d">-1, Science Fiction, 1, Stalker, 1, 1, 1979, 8.2, NULL
</a><a href="#h29-1-4" id="h29-1-4" class="d">-2, Action, 2, Sicario, 2, 2, 2015, 7.6, TRUE
</a><a href="#h29-1-5" id="h29-1-5" class="d">-3, Comedy, 3, Primer, 3, 1, 2004, 6.9, NULL
</a><a href="#h29-1-6" id="h29-1-6" class="d">-NULL, NULL, 4, Heat, 4, 2, 1995, 8.2, TRUE
</a><a href="#h29-1-7" id="h29-1-7" class="d">-NULL, NULL, 5, The Fountain, 4, 1, 2006, 7.2, FALSE
</a><a href="#h29-1-8" id="h29-1-8" class="d">-NULL, NULL, 6, Solaris, 1, 1, 1972, 8.1, NULL
</a><a href="#h29-1-9" id="h29-1-9" class="d">-NULL, NULL, 7, Gravity, 4, 1, 2013, 7.7, TRUE
</a><a href="#h29-1-10" id="h29-1-10" class="d">-NULL, NULL, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE
</a><a href="#h29-1-11" id="h29-1-11" class="d">-NULL, NULL, 9, Birdman, 4, 3, 2014, 7.7, TRUE
</a><a href="#h29-1-12" id="h29-1-12" class="d">-NULL, NULL, 10, Inception, 4, 1, 2010, 8.8, TRUE
</a><a href="#h29-1-13" id="h29-1-13" class="i">+1, &#39;Science Fiction&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL
</a><a href="#h29-1-14" id="h29-1-14" class="i">+2, &#39;Action&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE
</a><a href="#h29-1-15" id="h29-1-15" class="i">+3, &#39;Comedy&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL
</a><a href="#h29-1-16" id="h29-1-16" class="i">+NULL, NULL, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE
</a><a href="#h29-1-17" id="h29-1-17" class="i">+NULL, NULL, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE
</a><a href="#h29-1-18" id="h29-1-18" class="i">+NULL, NULL, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL
</a><a href="#h29-1-19" id="h29-1-19" class="i">+NULL, NULL, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE
</a><a href="#h29-1-20" id="h29-1-20" class="i">+NULL, NULL, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE
</a><a href="#h29-1-21" id="h29-1-21" class="i">+NULL, NULL, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE
</a><a href="#h29-1-22" id="h29-1-22" class="i">+NULL, NULL, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE
</a> 
 # Optional OUTER keyword.
 [plan]&gt; SELECT * FROM movies LEFT OUTER JOIN genres ON movies.id = genres.id
<a href="#h29-2" id="h29-2" class="h">@@ -91,16 +91,16 @@ NULL, NULL, 10, Inception, 4, 1, 2010, 8.8, TRUE
</a> HashJoin: outer on movies.id = genres.id
 ├─ Scan: movies
 └─ Scan: genres
<a href="#h29-2-3" id="h29-2-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h29-2-4" id="h29-2-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h29-2-5" id="h29-2-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h29-2-6" id="h29-2-6" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, NULL, NULL
</a><a href="#h29-2-7" id="h29-2-7" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, NULL, NULL
</a><a href="#h29-2-8" id="h29-2-8" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, NULL, NULL
</a><a href="#h29-2-9" id="h29-2-9" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, NULL, NULL
</a><a href="#h29-2-10" id="h29-2-10" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, NULL, NULL
</a><a href="#h29-2-11" id="h29-2-11" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, NULL, NULL
</a><a href="#h29-2-12" id="h29-2-12" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, NULL, NULL
</a><a href="#h29-2-13" id="h29-2-13" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h29-2-14" id="h29-2-14" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h29-2-15" id="h29-2-15" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h29-2-16" id="h29-2-16" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, NULL, NULL
</a><a href="#h29-2-17" id="h29-2-17" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, NULL, NULL
</a><a href="#h29-2-18" id="h29-2-18" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, NULL, NULL
</a><a href="#h29-2-19" id="h29-2-19" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, NULL, NULL
</a><a href="#h29-2-20" id="h29-2-20" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, NULL, NULL
</a><a href="#h29-2-21" id="h29-2-21" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, NULL, NULL
</a><a href="#h29-2-22" id="h29-2-22" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, NULL, NULL
</a> 
 [plan]&gt; SELECT * FROM genres RIGHT OUTER JOIN movies ON movies.id = genres.id
 ---
<a href="#h29-3" id="h29-3" class="h">@@ -108,16 +108,16 @@ Remap: genres.id, genres.name, movies.id, movies.title, movies.studio_id, movies
</a> └─ HashJoin: outer on movies.id = genres.id
    ├─ Scan: movies
    └─ Scan: genres
<a href="#h29-3-3" id="h29-3-3" class="d">-1, Science Fiction, 1, Stalker, 1, 1, 1979, 8.2, NULL
</a><a href="#h29-3-4" id="h29-3-4" class="d">-2, Action, 2, Sicario, 2, 2, 2015, 7.6, TRUE
</a><a href="#h29-3-5" id="h29-3-5" class="d">-3, Comedy, 3, Primer, 3, 1, 2004, 6.9, NULL
</a><a href="#h29-3-6" id="h29-3-6" class="d">-NULL, NULL, 4, Heat, 4, 2, 1995, 8.2, TRUE
</a><a href="#h29-3-7" id="h29-3-7" class="d">-NULL, NULL, 5, The Fountain, 4, 1, 2006, 7.2, FALSE
</a><a href="#h29-3-8" id="h29-3-8" class="d">-NULL, NULL, 6, Solaris, 1, 1, 1972, 8.1, NULL
</a><a href="#h29-3-9" id="h29-3-9" class="d">-NULL, NULL, 7, Gravity, 4, 1, 2013, 7.7, TRUE
</a><a href="#h29-3-10" id="h29-3-10" class="d">-NULL, NULL, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE
</a><a href="#h29-3-11" id="h29-3-11" class="d">-NULL, NULL, 9, Birdman, 4, 3, 2014, 7.7, TRUE
</a><a href="#h29-3-12" id="h29-3-12" class="d">-NULL, NULL, 10, Inception, 4, 1, 2010, 8.8, TRUE
</a><a href="#h29-3-13" id="h29-3-13" class="i">+1, &#39;Science Fiction&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL
</a><a href="#h29-3-14" id="h29-3-14" class="i">+2, &#39;Action&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE
</a><a href="#h29-3-15" id="h29-3-15" class="i">+3, &#39;Comedy&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL
</a><a href="#h29-3-16" id="h29-3-16" class="i">+NULL, NULL, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE
</a><a href="#h29-3-17" id="h29-3-17" class="i">+NULL, NULL, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE
</a><a href="#h29-3-18" id="h29-3-18" class="i">+NULL, NULL, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL
</a><a href="#h29-3-19" id="h29-3-19" class="i">+NULL, NULL, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE
</a><a href="#h29-3-20" id="h29-3-20" class="i">+NULL, NULL, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE
</a><a href="#h29-3-21" id="h29-3-21" class="i">+NULL, NULL, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE
</a><a href="#h29-3-22" id="h29-3-22" class="i">+NULL, NULL, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE
</a> 
 # Truncates when the inner side is shorter.
 [plan]&gt; SELECT * FROM genres LEFT JOIN movies ON movies.id = genres.id
<a href="#h29-4" id="h29-4" class="h">@@ -125,9 +125,9 @@ NULL, NULL, 10, Inception, 4, 1, 2010, 8.8, TRUE
</a> HashJoin: outer on genres.id = movies.id
 ├─ Scan: genres
 └─ Scan: movies
<a href="#h29-4-3" id="h29-4-3" class="d">-1, Science Fiction, 1, Stalker, 1, 1, 1979, 8.2, NULL
</a><a href="#h29-4-4" id="h29-4-4" class="d">-2, Action, 2, Sicario, 2, 2, 2015, 7.6, TRUE
</a><a href="#h29-4-5" id="h29-4-5" class="d">-3, Comedy, 3, Primer, 3, 1, 2004, 6.9, NULL
</a><a href="#h29-4-6" id="h29-4-6" class="i">+1, &#39;Science Fiction&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL
</a><a href="#h29-4-7" id="h29-4-7" class="i">+2, &#39;Action&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE
</a><a href="#h29-4-8" id="h29-4-8" class="i">+3, &#39;Comedy&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL
</a> 
 [plan]&gt; SELECT * FROM movies RIGHT JOIN genres ON movies.id = genres.id
 ---
<a href="#h29-5" id="h29-5" class="h">@@ -135,9 +135,9 @@ Remap: movies.id, movies.title, movies.studio_id, movies.genre_id, movies.releas
</a> └─ HashJoin: outer on genres.id = movies.id
    ├─ Scan: genres
    └─ Scan: movies
<a href="#h29-5-3" id="h29-5-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h29-5-4" id="h29-5-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h29-5-5" id="h29-5-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h29-5-6" id="h29-5-6" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h29-5-7" id="h29-5-7" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h29-5-8" id="h29-5-8" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a> 
 # Arbitrary predicate.
 [plan]&gt; SELECT * FROM movies LEFT JOIN genres ON genres.id &gt;= movies.id
<a href="#h29-6" id="h29-6" class="h">@@ -145,19 +145,19 @@ Remap: movies.id, movies.title, movies.studio_id, movies.genre_id, movies.releas
</a> NestedLoopJoin: outer on genres.id &gt; movies.id OR genres.id = movies.id
 ├─ Scan: movies
 └─ Scan: genres
<a href="#h29-6-3" id="h29-6-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h29-6-4" id="h29-6-4" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 2, Action
</a><a href="#h29-6-5" id="h29-6-5" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 3, Comedy
</a><a href="#h29-6-6" id="h29-6-6" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h29-6-7" id="h29-6-7" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 3, Comedy
</a><a href="#h29-6-8" id="h29-6-8" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h29-6-9" id="h29-6-9" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, NULL, NULL
</a><a href="#h29-6-10" id="h29-6-10" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, NULL, NULL
</a><a href="#h29-6-11" id="h29-6-11" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, NULL, NULL
</a><a href="#h29-6-12" id="h29-6-12" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, NULL, NULL
</a><a href="#h29-6-13" id="h29-6-13" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, NULL, NULL
</a><a href="#h29-6-14" id="h29-6-14" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, NULL, NULL
</a><a href="#h29-6-15" id="h29-6-15" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, NULL, NULL
</a><a href="#h29-6-16" id="h29-6-16" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h29-6-17" id="h29-6-17" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 2, &#39;Action&#39;
</a><a href="#h29-6-18" id="h29-6-18" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 3, &#39;Comedy&#39;
</a><a href="#h29-6-19" id="h29-6-19" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h29-6-20" id="h29-6-20" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 3, &#39;Comedy&#39;
</a><a href="#h29-6-21" id="h29-6-21" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h29-6-22" id="h29-6-22" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, NULL, NULL
</a><a href="#h29-6-23" id="h29-6-23" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, NULL, NULL
</a><a href="#h29-6-24" id="h29-6-24" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, NULL, NULL
</a><a href="#h29-6-25" id="h29-6-25" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, NULL, NULL
</a><a href="#h29-6-26" id="h29-6-26" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, NULL, NULL
</a><a href="#h29-6-27" id="h29-6-27" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, NULL, NULL
</a><a href="#h29-6-28" id="h29-6-28" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, NULL, NULL
</a> 
 # Three-way join.
 [plan]&gt; SELECT * FROM studios \
<a href="#h29-7" id="h29-7" class="h">@@ -170,16 +170,16 @@ Remap: studios.id, studios.name, studios.country_id, genres.id, genres.name, mov
</a>    └─ HashJoin: outer on studios.id = genres.id
       ├─ Scan: studios
       └─ Scan: genres
<a href="#h29-7-3" id="h29-7-3" class="d">-1, Mosfilm, ru, 1, Science Fiction, 1, Stalker, 1, 1, 1979, 8.2, NULL
</a><a href="#h29-7-4" id="h29-7-4" class="d">-2, Lionsgate, us, 2, Action, 2, Sicario, 2, 2, 2015, 7.6, TRUE
</a><a href="#h29-7-5" id="h29-7-5" class="d">-3, StudioCanal, fr, 3, Comedy, 3, Primer, 3, 1, 2004, 6.9, NULL
</a><a href="#h29-7-6" id="h29-7-6" class="d">-4, Warner Bros, us, NULL, NULL, 4, Heat, 4, 2, 1995, 8.2, TRUE
</a><a href="#h29-7-7" id="h29-7-7" class="d">-NULL, NULL, NULL, NULL, NULL, 5, The Fountain, 4, 1, 2006, 7.2, FALSE
</a><a href="#h29-7-8" id="h29-7-8" class="d">-NULL, NULL, NULL, NULL, NULL, 6, Solaris, 1, 1, 1972, 8.1, NULL
</a><a href="#h29-7-9" id="h29-7-9" class="d">-NULL, NULL, NULL, NULL, NULL, 7, Gravity, 4, 1, 2013, 7.7, TRUE
</a><a href="#h29-7-10" id="h29-7-10" class="d">-NULL, NULL, NULL, NULL, NULL, 8, Blindspotting, 2, 3, 2018, 7.4, TRUE
</a><a href="#h29-7-11" id="h29-7-11" class="d">-NULL, NULL, NULL, NULL, NULL, 9, Birdman, 4, 3, 2014, 7.7, TRUE
</a><a href="#h29-7-12" id="h29-7-12" class="d">-NULL, NULL, NULL, NULL, NULL, 10, Inception, 4, 1, 2010, 8.8, TRUE
</a><a href="#h29-7-13" id="h29-7-13" class="i">+1, &#39;Mosfilm&#39;, &#39;ru&#39;, 1, &#39;Science Fiction&#39;, 1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL
</a><a href="#h29-7-14" id="h29-7-14" class="i">+2, &#39;Lionsgate&#39;, &#39;us&#39;, 2, &#39;Action&#39;, 2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE
</a><a href="#h29-7-15" id="h29-7-15" class="i">+3, &#39;StudioCanal&#39;, &#39;fr&#39;, 3, &#39;Comedy&#39;, 3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL
</a><a href="#h29-7-16" id="h29-7-16" class="i">+4, &#39;Warner Bros&#39;, &#39;us&#39;, NULL, NULL, 4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE
</a><a href="#h29-7-17" id="h29-7-17" class="i">+NULL, NULL, NULL, NULL, NULL, 5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE
</a><a href="#h29-7-18" id="h29-7-18" class="i">+NULL, NULL, NULL, NULL, NULL, 6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL
</a><a href="#h29-7-19" id="h29-7-19" class="i">+NULL, NULL, NULL, NULL, NULL, 7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE
</a><a href="#h29-7-20" id="h29-7-20" class="i">+NULL, NULL, NULL, NULL, NULL, 8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE
</a><a href="#h29-7-21" id="h29-7-21" class="i">+NULL, NULL, NULL, NULL, NULL, 9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE
</a><a href="#h29-7-22" id="h29-7-22" class="i">+NULL, NULL, NULL, NULL, NULL, 10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE
</a> 
 # Aliased tables.
 [plan]&gt; SELECT * FROM movies m LEFT JOIN genres AS g on m.id = g.id
<a href="#h29-8" id="h29-8" class="h">@@ -187,16 +187,16 @@ NULL, NULL, NULL, NULL, NULL, 10, Inception, 4, 1, 2010, 8.8, TRUE
</a> HashJoin: outer on m.id = g.id
 ├─ Scan: movies as m
 └─ Scan: genres as g
<a href="#h29-8-3" id="h29-8-3" class="d">-1, Stalker, 1, 1, 1979, 8.2, NULL, 1, Science Fiction
</a><a href="#h29-8-4" id="h29-8-4" class="d">-2, Sicario, 2, 2, 2015, 7.6, TRUE, 2, Action
</a><a href="#h29-8-5" id="h29-8-5" class="d">-3, Primer, 3, 1, 2004, 6.9, NULL, 3, Comedy
</a><a href="#h29-8-6" id="h29-8-6" class="d">-4, Heat, 4, 2, 1995, 8.2, TRUE, NULL, NULL
</a><a href="#h29-8-7" id="h29-8-7" class="d">-5, The Fountain, 4, 1, 2006, 7.2, FALSE, NULL, NULL
</a><a href="#h29-8-8" id="h29-8-8" class="d">-6, Solaris, 1, 1, 1972, 8.1, NULL, NULL, NULL
</a><a href="#h29-8-9" id="h29-8-9" class="d">-7, Gravity, 4, 1, 2013, 7.7, TRUE, NULL, NULL
</a><a href="#h29-8-10" id="h29-8-10" class="d">-8, Blindspotting, 2, 3, 2018, 7.4, TRUE, NULL, NULL
</a><a href="#h29-8-11" id="h29-8-11" class="d">-9, Birdman, 4, 3, 2014, 7.7, TRUE, NULL, NULL
</a><a href="#h29-8-12" id="h29-8-12" class="d">-10, Inception, 4, 1, 2010, 8.8, TRUE, NULL, NULL
</a><a href="#h29-8-13" id="h29-8-13" class="i">+1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL, 1, &#39;Science Fiction&#39;
</a><a href="#h29-8-14" id="h29-8-14" class="i">+2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE, 2, &#39;Action&#39;
</a><a href="#h29-8-15" id="h29-8-15" class="i">+3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL, 3, &#39;Comedy&#39;
</a><a href="#h29-8-16" id="h29-8-16" class="i">+4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE, NULL, NULL
</a><a href="#h29-8-17" id="h29-8-17" class="i">+5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE, NULL, NULL
</a><a href="#h29-8-18" id="h29-8-18" class="i">+6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL, NULL, NULL
</a><a href="#h29-8-19" id="h29-8-19" class="i">+7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE, NULL, NULL
</a><a href="#h29-8-20" id="h29-8-20" class="i">+8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE, NULL, NULL
</a><a href="#h29-8-21" id="h29-8-21" class="i">+9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE, NULL, NULL
</a><a href="#h29-8-22" id="h29-8-22" class="i">+10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE, NULL, NULL
</a> 
 # Outer joins without ON errors.
 !&gt; SELECT * FROM movies LEFT JOIN genres
<b>diff --git a/<a id="h30" href="../file/src/sql/testscripts/queries/limit.html">src/sql/testscripts/queries/limit</a> b/<a href="../file/src/sql/testscripts/queries/limit.html">src/sql/testscripts/queries/limit</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -10,24 +10,24 @@ ok
</a> ---
 Limit: 4
 └─ Scan: test
<a href="#h30-0-3" id="h30-0-3" class="d">-1, a
</a><a href="#h30-0-4" id="h30-0-4" class="d">-2, b
</a><a href="#h30-0-5" id="h30-0-5" class="d">-3, c
</a><a href="#h30-0-6" id="h30-0-6" class="i">+1, &#39;a&#39;
</a><a href="#h30-0-7" id="h30-0-7" class="i">+2, &#39;b&#39;
</a><a href="#h30-0-8" id="h30-0-8" class="i">+3, &#39;c&#39;
</a> 
 &gt; SELECT * FROM test LIMIT 3
 ---
<a href="#h30-0-12" id="h30-0-12" class="d">-1, a
</a><a href="#h30-0-13" id="h30-0-13" class="d">-2, b
</a><a href="#h30-0-14" id="h30-0-14" class="d">-3, c
</a><a href="#h30-0-15" id="h30-0-15" class="i">+1, &#39;a&#39;
</a><a href="#h30-0-16" id="h30-0-16" class="i">+2, &#39;b&#39;
</a><a href="#h30-0-17" id="h30-0-17" class="i">+3, &#39;c&#39;
</a> 
 &gt; SELECT * FROM test LIMIT 2
 ---
<a href="#h30-0-21" id="h30-0-21" class="d">-1, a
</a><a href="#h30-0-22" id="h30-0-22" class="d">-2, b
</a><a href="#h30-0-23" id="h30-0-23" class="i">+1, &#39;a&#39;
</a><a href="#h30-0-24" id="h30-0-24" class="i">+2, &#39;b&#39;
</a> 
 &gt; SELECT * FROM test LIMIT 1
 ---
<a href="#h30-0-28" id="h30-0-28" class="d">-1, a
</a><a href="#h30-0-29" id="h30-0-29" class="i">+1, &#39;a&#39;
</a> 
 [plan]&gt; SELECT * FROM test LIMIT 0
 ---
<a href="#h30-1" id="h30-1" class="h">@@ -36,9 +36,9 @@ Nothing
</a> # A max i64 limit works.
 &gt; SELECT * FROM test LIMIT 9223372036854775807
 ---
<a href="#h30-1-3" id="h30-1-3" class="d">-1, a
</a><a href="#h30-1-4" id="h30-1-4" class="d">-2, b
</a><a href="#h30-1-5" id="h30-1-5" class="d">-3, c
</a><a href="#h30-1-6" id="h30-1-6" class="i">+1, &#39;a&#39;
</a><a href="#h30-1-7" id="h30-1-7" class="i">+2, &#39;b&#39;
</a><a href="#h30-1-8" id="h30-1-8" class="i">+3, &#39;c&#39;
</a> 
 # Limits can also be used with constant values.
 [plan]&gt; SELECT 1, 2, 3 LIMIT 1
<a href="#h30-2" id="h30-2" class="h">@@ -57,8 +57,8 @@ Nothing
</a> ---
 Limit: 2
 └─ Scan: test
<a href="#h30-2-3" id="h30-2-3" class="d">-1, a
</a><a href="#h30-2-4" id="h30-2-4" class="d">-2, b
</a><a href="#h30-2-5" id="h30-2-5" class="i">+1, &#39;a&#39;
</a><a href="#h30-2-6" id="h30-2-6" class="i">+2, &#39;b&#39;
</a> 
 !&gt; SELECT * FROM test LIMIT id
 ---
<a href="#h30-3" id="h30-3" class="h">@@ -78,7 +78,7 @@ Error: invalid input: invalid limit NULL
</a> ---
 Error: invalid input: invalid limit FALSE
 Error: invalid input: invalid limit 1.0
<a href="#h30-3-3" id="h30-3-3" class="d">-Error: invalid input: invalid limit 1
</a><a href="#h30-3-4" id="h30-3-4" class="i">+Error: invalid input: invalid limit &#39;1&#39;
</a> 
 # Multiple limits error.
 !&gt; SELECT * FROM test LIMIT 1 2
<b>diff --git a/<a id="h31" href="../file/src/sql/testscripts/queries/offset.html">src/sql/testscripts/queries/offset</a> b/<a href="../file/src/sql/testscripts/queries/offset.html">src/sql/testscripts/queries/offset</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -17,20 +17,20 @@ ok
</a> 
 &gt; SELECT * FROM test OFFSET 2
 ---
<a href="#h31-0-3" id="h31-0-3" class="d">-3, c
</a><a href="#h31-0-4" id="h31-0-4" class="i">+3, &#39;c&#39;
</a> 
 &gt; SELECT * FROM test OFFSET 1
 ---
<a href="#h31-0-8" id="h31-0-8" class="d">-2, b
</a><a href="#h31-0-9" id="h31-0-9" class="d">-3, c
</a><a href="#h31-0-10" id="h31-0-10" class="i">+2, &#39;b&#39;
</a><a href="#h31-0-11" id="h31-0-11" class="i">+3, &#39;c&#39;
</a> 
 [plan]&gt; SELECT * FROM test OFFSET 0
 ---
 Offset: 0
 └─ Scan: test
<a href="#h31-0-17" id="h31-0-17" class="d">-1, a
</a><a href="#h31-0-18" id="h31-0-18" class="d">-2, b
</a><a href="#h31-0-19" id="h31-0-19" class="d">-3, c
</a><a href="#h31-0-20" id="h31-0-20" class="i">+1, &#39;a&#39;
</a><a href="#h31-0-21" id="h31-0-21" class="i">+2, &#39;b&#39;
</a><a href="#h31-0-22" id="h31-0-22" class="i">+3, &#39;c&#39;
</a> 
 # A max i64 offset works.
 &gt; SELECT * FROM test OFFSET 9223372036854775807
<a href="#h31-1" id="h31-1" class="h">@@ -56,8 +56,8 @@ Offset: 0
</a> ---
 Offset: 1
 └─ Scan: test
<a href="#h31-1-3" id="h31-1-3" class="d">-2, b
</a><a href="#h31-1-4" id="h31-1-4" class="d">-3, c
</a><a href="#h31-1-5" id="h31-1-5" class="i">+2, &#39;b&#39;
</a><a href="#h31-1-6" id="h31-1-6" class="i">+3, &#39;c&#39;
</a> 
 !&gt; SELECT * FROM test OFFSET id
 ---
<a href="#h31-2" id="h31-2" class="h">@@ -77,7 +77,7 @@ Error: invalid input: invalid offset NULL
</a> ---
 Error: invalid input: invalid offset FALSE
 Error: invalid input: invalid offset 1.0
<a href="#h31-2-3" id="h31-2-3" class="d">-Error: invalid input: invalid offset 1
</a><a href="#h31-2-4" id="h31-2-4" class="i">+Error: invalid input: invalid offset &#39;1&#39;
</a> 
 # Multiple offsets error.
 !&gt; SELECT * FROM test OFFSET 1 2
<b>diff --git a/<a id="h32" href="../file/src/sql/testscripts/queries/order.html">src/sql/testscripts/queries/order</a> b/<a href="../file/src/sql/testscripts/queries/order.html">src/sql/testscripts/queries/order</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -46,29 +46,29 @@ Order: value desc
</a> Order: test.id asc
 └─ Scan: test
 0, NULL, NULL, NULL, NULL, 1
<a href="#h32-0-3" id="h32-0-3" class="d">-1, TRUE, 0, 3.14, a, 1
</a><a href="#h32-0-4" id="h32-0-4" class="d">-2, FALSE, -1, -2.718, ab, 1
</a><a href="#h32-0-5" id="h32-0-5" class="d">-3, NULL, 1, 0.0, aaa, 1
</a><a href="#h32-0-6" id="h32-0-6" class="d">-4, NULL, 1000, 0.0, A, 1
</a><a href="#h32-0-7" id="h32-0-7" class="d">-5, NULL, -1000, inf, , 1
</a><a href="#h32-0-8" id="h32-0-8" class="d">-6, NULL, 7, -inf, åa, 1
</a><a href="#h32-0-9" id="h32-0-9" class="d">-7, NULL, -9, NaN, Åa, 1
</a><a href="#h32-0-10" id="h32-0-10" class="d">-8, NULL, NULL, NULL, B, 1
</a><a href="#h32-0-11" id="h32-0-11" class="d">-9, NULL, NULL, NULL, 👍, 1
</a><a href="#h32-0-12" id="h32-0-12" class="i">+1, TRUE, 0, 3.14, &#39;a&#39;, 1
</a><a href="#h32-0-13" id="h32-0-13" class="i">+2, FALSE, -1, -2.718, &#39;ab&#39;, 1
</a><a href="#h32-0-14" id="h32-0-14" class="i">+3, NULL, 1, 0.0, &#39;aaa&#39;, 1
</a><a href="#h32-0-15" id="h32-0-15" class="i">+4, NULL, 1000, 0.0, &#39;A&#39;, 1
</a><a href="#h32-0-16" id="h32-0-16" class="i">+5, NULL, -1000, inf, &#39;&#39;, 1
</a><a href="#h32-0-17" id="h32-0-17" class="i">+6, NULL, 7, -inf, &#39;åa&#39;, 1
</a><a href="#h32-0-18" id="h32-0-18" class="i">+7, NULL, -9, NaN, &#39;Åa&#39;, 1
</a><a href="#h32-0-19" id="h32-0-19" class="i">+8, NULL, NULL, NULL, &#39;B&#39;, 1
</a><a href="#h32-0-20" id="h32-0-20" class="i">+9, NULL, NULL, NULL, &#39;👍&#39;, 1
</a> 
 [plan]&gt; SELECT * FROM test ORDER BY id DESC
 ---
 Order: test.id desc
 └─ Scan: test
<a href="#h32-0-26" id="h32-0-26" class="d">-9, NULL, NULL, NULL, 👍, 1
</a><a href="#h32-0-27" id="h32-0-27" class="d">-8, NULL, NULL, NULL, B, 1
</a><a href="#h32-0-28" id="h32-0-28" class="d">-7, NULL, -9, NaN, Åa, 1
</a><a href="#h32-0-29" id="h32-0-29" class="d">-6, NULL, 7, -inf, åa, 1
</a><a href="#h32-0-30" id="h32-0-30" class="d">-5, NULL, -1000, inf, , 1
</a><a href="#h32-0-31" id="h32-0-31" class="d">-4, NULL, 1000, 0.0, A, 1
</a><a href="#h32-0-32" id="h32-0-32" class="d">-3, NULL, 1, 0.0, aaa, 1
</a><a href="#h32-0-33" id="h32-0-33" class="d">-2, FALSE, -1, -2.718, ab, 1
</a><a href="#h32-0-34" id="h32-0-34" class="d">-1, TRUE, 0, 3.14, a, 1
</a><a href="#h32-0-35" id="h32-0-35" class="i">+9, NULL, NULL, NULL, &#39;👍&#39;, 1
</a><a href="#h32-0-36" id="h32-0-36" class="i">+8, NULL, NULL, NULL, &#39;B&#39;, 1
</a><a href="#h32-0-37" id="h32-0-37" class="i">+7, NULL, -9, NaN, &#39;Åa&#39;, 1
</a><a href="#h32-0-38" id="h32-0-38" class="i">+6, NULL, 7, -inf, &#39;åa&#39;, 1
</a><a href="#h32-0-39" id="h32-0-39" class="i">+5, NULL, -1000, inf, &#39;&#39;, 1
</a><a href="#h32-0-40" id="h32-0-40" class="i">+4, NULL, 1000, 0.0, &#39;A&#39;, 1
</a><a href="#h32-0-41" id="h32-0-41" class="i">+3, NULL, 1, 0.0, &#39;aaa&#39;, 1
</a><a href="#h32-0-42" id="h32-0-42" class="i">+2, FALSE, -1, -2.718, &#39;ab&#39;, 1
</a><a href="#h32-0-43" id="h32-0-43" class="i">+1, TRUE, 0, 3.14, &#39;a&#39;, 1
</a> 0, NULL, NULL, NULL, NULL, 1
 
 # Booleans.
<a href="#h32-1" id="h32-1" class="h">@@ -156,27 +156,27 @@ Order: test.id desc
</a> &gt; SELECT id, &quot;string&quot; FROM test ORDER BY &quot;string&quot; ASC
 ---
 0, NULL
<a href="#h32-1-3" id="h32-1-3" class="d">-5, 
</a><a href="#h32-1-4" id="h32-1-4" class="d">-4, A
</a><a href="#h32-1-5" id="h32-1-5" class="d">-8, B
</a><a href="#h32-1-6" id="h32-1-6" class="d">-1, a
</a><a href="#h32-1-7" id="h32-1-7" class="d">-3, aaa
</a><a href="#h32-1-8" id="h32-1-8" class="d">-2, ab
</a><a href="#h32-1-9" id="h32-1-9" class="d">-7, Åa
</a><a href="#h32-1-10" id="h32-1-10" class="d">-6, åa
</a><a href="#h32-1-11" id="h32-1-11" class="d">-9, 👍
</a><a href="#h32-1-12" id="h32-1-12" class="i">+5, &#39;&#39;
</a><a href="#h32-1-13" id="h32-1-13" class="i">+4, &#39;A&#39;
</a><a href="#h32-1-14" id="h32-1-14" class="i">+8, &#39;B&#39;
</a><a href="#h32-1-15" id="h32-1-15" class="i">+1, &#39;a&#39;
</a><a href="#h32-1-16" id="h32-1-16" class="i">+3, &#39;aaa&#39;
</a><a href="#h32-1-17" id="h32-1-17" class="i">+2, &#39;ab&#39;
</a><a href="#h32-1-18" id="h32-1-18" class="i">+7, &#39;Åa&#39;
</a><a href="#h32-1-19" id="h32-1-19" class="i">+6, &#39;åa&#39;
</a><a href="#h32-1-20" id="h32-1-20" class="i">+9, &#39;👍&#39;
</a> 
 &gt; SELECT id, &quot;string&quot; FROM test ORDER BY &quot;string&quot; DESC
 ---
<a href="#h32-1-24" id="h32-1-24" class="d">-9, 👍
</a><a href="#h32-1-25" id="h32-1-25" class="d">-6, åa
</a><a href="#h32-1-26" id="h32-1-26" class="d">-7, Åa
</a><a href="#h32-1-27" id="h32-1-27" class="d">-2, ab
</a><a href="#h32-1-28" id="h32-1-28" class="d">-3, aaa
</a><a href="#h32-1-29" id="h32-1-29" class="d">-1, a
</a><a href="#h32-1-30" id="h32-1-30" class="d">-8, B
</a><a href="#h32-1-31" id="h32-1-31" class="d">-4, A
</a><a href="#h32-1-32" id="h32-1-32" class="d">-5, 
</a><a href="#h32-1-33" id="h32-1-33" class="i">+9, &#39;👍&#39;
</a><a href="#h32-1-34" id="h32-1-34" class="i">+6, &#39;åa&#39;
</a><a href="#h32-1-35" id="h32-1-35" class="i">+7, &#39;Åa&#39;
</a><a href="#h32-1-36" id="h32-1-36" class="i">+2, &#39;ab&#39;
</a><a href="#h32-1-37" id="h32-1-37" class="i">+3, &#39;aaa&#39;
</a><a href="#h32-1-38" id="h32-1-38" class="i">+1, &#39;a&#39;
</a><a href="#h32-1-39" id="h32-1-39" class="i">+8, &#39;B&#39;
</a><a href="#h32-1-40" id="h32-1-40" class="i">+4, &#39;A&#39;
</a><a href="#h32-1-41" id="h32-1-41" class="i">+5, &#39;&#39;
</a> 0, NULL
 
 # When all values are equal, they are stably ordered by the primary key in
<a href="#h32-2" id="h32-2" class="h">@@ -212,30 +212,30 @@ Order: test.id desc
</a> &gt; SELECT id, static, &quot;bool&quot;, &quot;int&quot;, &quot;string&quot; FROM test \
   ORDER BY static ASC, &quot;bool&quot; DESC, &quot;int&quot; ASC, &quot;string&quot; DESC
 ---
<a href="#h32-2-3" id="h32-2-3" class="d">-1, 1, TRUE, 0, a
</a><a href="#h32-2-4" id="h32-2-4" class="d">-2, 1, FALSE, -1, ab
</a><a href="#h32-2-5" id="h32-2-5" class="d">-9, 1, NULL, NULL, 👍
</a><a href="#h32-2-6" id="h32-2-6" class="d">-8, 1, NULL, NULL, B
</a><a href="#h32-2-7" id="h32-2-7" class="i">+1, 1, TRUE, 0, &#39;a&#39;
</a><a href="#h32-2-8" id="h32-2-8" class="i">+2, 1, FALSE, -1, &#39;ab&#39;
</a><a href="#h32-2-9" id="h32-2-9" class="i">+9, 1, NULL, NULL, &#39;👍&#39;
</a><a href="#h32-2-10" id="h32-2-10" class="i">+8, 1, NULL, NULL, &#39;B&#39;
</a> 0, 1, NULL, NULL, NULL
<a href="#h32-2-12" id="h32-2-12" class="d">-5, 1, NULL, -1000, 
</a><a href="#h32-2-13" id="h32-2-13" class="d">-7, 1, NULL, -9, Åa
</a><a href="#h32-2-14" id="h32-2-14" class="d">-3, 1, NULL, 1, aaa
</a><a href="#h32-2-15" id="h32-2-15" class="d">-6, 1, NULL, 7, åa
</a><a href="#h32-2-16" id="h32-2-16" class="d">-4, 1, NULL, 1000, A
</a><a href="#h32-2-17" id="h32-2-17" class="i">+5, 1, NULL, -1000, &#39;&#39;
</a><a href="#h32-2-18" id="h32-2-18" class="i">+7, 1, NULL, -9, &#39;Åa&#39;
</a><a href="#h32-2-19" id="h32-2-19" class="i">+3, 1, NULL, 1, &#39;aaa&#39;
</a><a href="#h32-2-20" id="h32-2-20" class="i">+6, 1, NULL, 7, &#39;åa&#39;
</a><a href="#h32-2-21" id="h32-2-21" class="i">+4, 1, NULL, 1000, &#39;A&#39;
</a> 
 &gt; SELECT id, static, &quot;bool&quot;, &quot;int&quot;, &quot;string&quot; FROM test \
   ORDER BY static DESC, &quot;bool&quot; ASC, &quot;int&quot; DESC, &quot;string&quot; ASC
 ---
<a href="#h32-2-26" id="h32-2-26" class="d">-4, 1, NULL, 1000, A
</a><a href="#h32-2-27" id="h32-2-27" class="d">-6, 1, NULL, 7, åa
</a><a href="#h32-2-28" id="h32-2-28" class="d">-3, 1, NULL, 1, aaa
</a><a href="#h32-2-29" id="h32-2-29" class="d">-7, 1, NULL, -9, Åa
</a><a href="#h32-2-30" id="h32-2-30" class="d">-5, 1, NULL, -1000, 
</a><a href="#h32-2-31" id="h32-2-31" class="i">+4, 1, NULL, 1000, &#39;A&#39;
</a><a href="#h32-2-32" id="h32-2-32" class="i">+6, 1, NULL, 7, &#39;åa&#39;
</a><a href="#h32-2-33" id="h32-2-33" class="i">+3, 1, NULL, 1, &#39;aaa&#39;
</a><a href="#h32-2-34" id="h32-2-34" class="i">+7, 1, NULL, -9, &#39;Åa&#39;
</a><a href="#h32-2-35" id="h32-2-35" class="i">+5, 1, NULL, -1000, &#39;&#39;
</a> 0, 1, NULL, NULL, NULL
<a href="#h32-2-37" id="h32-2-37" class="d">-8, 1, NULL, NULL, B
</a><a href="#h32-2-38" id="h32-2-38" class="d">-9, 1, NULL, NULL, 👍
</a><a href="#h32-2-39" id="h32-2-39" class="d">-2, 1, FALSE, -1, ab
</a><a href="#h32-2-40" id="h32-2-40" class="d">-1, 1, TRUE, 0, a
</a><a href="#h32-2-41" id="h32-2-41" class="i">+8, 1, NULL, NULL, &#39;B&#39;
</a><a href="#h32-2-42" id="h32-2-42" class="i">+9, 1, NULL, NULL, &#39;👍&#39;
</a><a href="#h32-2-43" id="h32-2-43" class="i">+2, 1, FALSE, -1, &#39;ab&#39;
</a><a href="#h32-2-44" id="h32-2-44" class="i">+1, 1, TRUE, 0, &#39;a&#39;
</a> 
 # Can order by expressions.
 [plan]&gt; SELECT id, &quot;float&quot; FROM test ORDER BY &quot;float&quot; ^ 2
<a href="#h32-3" id="h32-3" class="h">@@ -421,26 +421,26 @@ Order: other.id desc
</a> └─ NestedLoopJoin: inner
    ├─ Scan: test
    └─ Scan: other
<a href="#h32-3-3" id="h32-3-3" class="d">-0, NULL, NULL, NULL, NULL, 1, 2, b
</a><a href="#h32-3-4" id="h32-3-4" class="d">-1, TRUE, 0, 3.14, a, 1, 2, b
</a><a href="#h32-3-5" id="h32-3-5" class="d">-2, FALSE, -1, -2.718, ab, 1, 2, b
</a><a href="#h32-3-6" id="h32-3-6" class="d">-3, NULL, 1, 0.0, aaa, 1, 2, b
</a><a href="#h32-3-7" id="h32-3-7" class="d">-4, NULL, 1000, 0.0, A, 1, 2, b
</a><a href="#h32-3-8" id="h32-3-8" class="d">-5, NULL, -1000, inf, , 1, 2, b
</a><a href="#h32-3-9" id="h32-3-9" class="d">-6, NULL, 7, -inf, åa, 1, 2, b
</a><a href="#h32-3-10" id="h32-3-10" class="d">-7, NULL, -9, NaN, Åa, 1, 2, b
</a><a href="#h32-3-11" id="h32-3-11" class="d">-8, NULL, NULL, NULL, B, 1, 2, b
</a><a href="#h32-3-12" id="h32-3-12" class="d">-9, NULL, NULL, NULL, 👍, 1, 2, b
</a><a href="#h32-3-13" id="h32-3-13" class="d">-0, NULL, NULL, NULL, NULL, 1, 1, a
</a><a href="#h32-3-14" id="h32-3-14" class="d">-1, TRUE, 0, 3.14, a, 1, 1, a
</a><a href="#h32-3-15" id="h32-3-15" class="d">-2, FALSE, -1, -2.718, ab, 1, 1, a
</a><a href="#h32-3-16" id="h32-3-16" class="d">-3, NULL, 1, 0.0, aaa, 1, 1, a
</a><a href="#h32-3-17" id="h32-3-17" class="d">-4, NULL, 1000, 0.0, A, 1, 1, a
</a><a href="#h32-3-18" id="h32-3-18" class="d">-5, NULL, -1000, inf, , 1, 1, a
</a><a href="#h32-3-19" id="h32-3-19" class="d">-6, NULL, 7, -inf, åa, 1, 1, a
</a><a href="#h32-3-20" id="h32-3-20" class="d">-7, NULL, -9, NaN, Åa, 1, 1, a
</a><a href="#h32-3-21" id="h32-3-21" class="d">-8, NULL, NULL, NULL, B, 1, 1, a
</a><a href="#h32-3-22" id="h32-3-22" class="d">-9, NULL, NULL, NULL, 👍, 1, 1, a
</a><a href="#h32-3-23" id="h32-3-23" class="i">+0, NULL, NULL, NULL, NULL, 1, 2, &#39;b&#39;
</a><a href="#h32-3-24" id="h32-3-24" class="i">+1, TRUE, 0, 3.14, &#39;a&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-25" id="h32-3-25" class="i">+2, FALSE, -1, -2.718, &#39;ab&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-26" id="h32-3-26" class="i">+3, NULL, 1, 0.0, &#39;aaa&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-27" id="h32-3-27" class="i">+4, NULL, 1000, 0.0, &#39;A&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-28" id="h32-3-28" class="i">+5, NULL, -1000, inf, &#39;&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-29" id="h32-3-29" class="i">+6, NULL, 7, -inf, &#39;åa&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-30" id="h32-3-30" class="i">+7, NULL, -9, NaN, &#39;Åa&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-31" id="h32-3-31" class="i">+8, NULL, NULL, NULL, &#39;B&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-32" id="h32-3-32" class="i">+9, NULL, NULL, NULL, &#39;👍&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-3-33" id="h32-3-33" class="i">+0, NULL, NULL, NULL, NULL, 1, 1, &#39;a&#39;
</a><a href="#h32-3-34" id="h32-3-34" class="i">+1, TRUE, 0, 3.14, &#39;a&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-3-35" id="h32-3-35" class="i">+2, FALSE, -1, -2.718, &#39;ab&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-3-36" id="h32-3-36" class="i">+3, NULL, 1, 0.0, &#39;aaa&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-3-37" id="h32-3-37" class="i">+4, NULL, 1000, 0.0, &#39;A&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-3-38" id="h32-3-38" class="i">+5, NULL, -1000, inf, &#39;&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-3-39" id="h32-3-39" class="i">+6, NULL, 7, -inf, &#39;åa&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-3-40" id="h32-3-40" class="i">+7, NULL, -9, NaN, &#39;Åa&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-3-41" id="h32-3-41" class="i">+8, NULL, NULL, NULL, &#39;B&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-3-42" id="h32-3-42" class="i">+9, NULL, NULL, NULL, &#39;👍&#39;, 1, 1, &#39;a&#39;
</a> 
 [plan]&gt; SELECT * FROM test t, other o ORDER BY o.id DESC, t.id ASC
 ---
<a href="#h32-4" id="h32-4" class="h">@@ -448,26 +448,26 @@ Order: o.id desc, t.id asc
</a> └─ NestedLoopJoin: inner
    ├─ Scan: test as t
    └─ Scan: other as o
<a href="#h32-4-3" id="h32-4-3" class="d">-0, NULL, NULL, NULL, NULL, 1, 2, b
</a><a href="#h32-4-4" id="h32-4-4" class="d">-1, TRUE, 0, 3.14, a, 1, 2, b
</a><a href="#h32-4-5" id="h32-4-5" class="d">-2, FALSE, -1, -2.718, ab, 1, 2, b
</a><a href="#h32-4-6" id="h32-4-6" class="d">-3, NULL, 1, 0.0, aaa, 1, 2, b
</a><a href="#h32-4-7" id="h32-4-7" class="d">-4, NULL, 1000, 0.0, A, 1, 2, b
</a><a href="#h32-4-8" id="h32-4-8" class="d">-5, NULL, -1000, inf, , 1, 2, b
</a><a href="#h32-4-9" id="h32-4-9" class="d">-6, NULL, 7, -inf, åa, 1, 2, b
</a><a href="#h32-4-10" id="h32-4-10" class="d">-7, NULL, -9, NaN, Åa, 1, 2, b
</a><a href="#h32-4-11" id="h32-4-11" class="d">-8, NULL, NULL, NULL, B, 1, 2, b
</a><a href="#h32-4-12" id="h32-4-12" class="d">-9, NULL, NULL, NULL, 👍, 1, 2, b
</a><a href="#h32-4-13" id="h32-4-13" class="d">-0, NULL, NULL, NULL, NULL, 1, 1, a
</a><a href="#h32-4-14" id="h32-4-14" class="d">-1, TRUE, 0, 3.14, a, 1, 1, a
</a><a href="#h32-4-15" id="h32-4-15" class="d">-2, FALSE, -1, -2.718, ab, 1, 1, a
</a><a href="#h32-4-16" id="h32-4-16" class="d">-3, NULL, 1, 0.0, aaa, 1, 1, a
</a><a href="#h32-4-17" id="h32-4-17" class="d">-4, NULL, 1000, 0.0, A, 1, 1, a
</a><a href="#h32-4-18" id="h32-4-18" class="d">-5, NULL, -1000, inf, , 1, 1, a
</a><a href="#h32-4-19" id="h32-4-19" class="d">-6, NULL, 7, -inf, åa, 1, 1, a
</a><a href="#h32-4-20" id="h32-4-20" class="d">-7, NULL, -9, NaN, Åa, 1, 1, a
</a><a href="#h32-4-21" id="h32-4-21" class="d">-8, NULL, NULL, NULL, B, 1, 1, a
</a><a href="#h32-4-22" id="h32-4-22" class="d">-9, NULL, NULL, NULL, 👍, 1, 1, a
</a><a href="#h32-4-23" id="h32-4-23" class="i">+0, NULL, NULL, NULL, NULL, 1, 2, &#39;b&#39;
</a><a href="#h32-4-24" id="h32-4-24" class="i">+1, TRUE, 0, 3.14, &#39;a&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-25" id="h32-4-25" class="i">+2, FALSE, -1, -2.718, &#39;ab&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-26" id="h32-4-26" class="i">+3, NULL, 1, 0.0, &#39;aaa&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-27" id="h32-4-27" class="i">+4, NULL, 1000, 0.0, &#39;A&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-28" id="h32-4-28" class="i">+5, NULL, -1000, inf, &#39;&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-29" id="h32-4-29" class="i">+6, NULL, 7, -inf, &#39;åa&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-30" id="h32-4-30" class="i">+7, NULL, -9, NaN, &#39;Åa&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-31" id="h32-4-31" class="i">+8, NULL, NULL, NULL, &#39;B&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-32" id="h32-4-32" class="i">+9, NULL, NULL, NULL, &#39;👍&#39;, 1, 2, &#39;b&#39;
</a><a href="#h32-4-33" id="h32-4-33" class="i">+0, NULL, NULL, NULL, NULL, 1, 1, &#39;a&#39;
</a><a href="#h32-4-34" id="h32-4-34" class="i">+1, TRUE, 0, 3.14, &#39;a&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-4-35" id="h32-4-35" class="i">+2, FALSE, -1, -2.718, &#39;ab&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-4-36" id="h32-4-36" class="i">+3, NULL, 1, 0.0, &#39;aaa&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-4-37" id="h32-4-37" class="i">+4, NULL, 1000, 0.0, &#39;A&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-4-38" id="h32-4-38" class="i">+5, NULL, -1000, inf, &#39;&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-4-39" id="h32-4-39" class="i">+6, NULL, 7, -inf, &#39;åa&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-4-40" id="h32-4-40" class="i">+7, NULL, -9, NaN, &#39;Åa&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-4-41" id="h32-4-41" class="i">+8, NULL, NULL, NULL, &#39;B&#39;, 1, 1, &#39;a&#39;
</a><a href="#h32-4-42" id="h32-4-42" class="i">+9, NULL, NULL, NULL, &#39;👍&#39;, 1, 1, &#39;a&#39;
</a> 
 # Order by aggregates, both when in SELECT and otherwise.
 [plan]&gt; SELECT &quot;bool&quot;, MAX(&quot;int&quot;) FROM test GROUP BY &quot;bool&quot; ORDER BY MAX(&quot;int&quot;) DESC
<b>diff --git a/<a id="h33" href="../file/src/sql/testscripts/queries/select.html">src/sql/testscripts/queries/select</a> b/<a href="../file/src/sql/testscripts/queries/select.html">src/sql/testscripts/queries/select</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -26,9 +26,9 @@ Projection: 1
</a> 
 [plan]&gt; SELECT NULL, NOT FALSE, 2^2+1, 3.14*2, &#39;Hi 👋&#39;
 ---
<a href="#h33-0-3" id="h33-0-3" class="d">-Projection: NULL, TRUE, 5, 6.28, Hi 👋
</a><a href="#h33-0-4" id="h33-0-4" class="i">+Projection: NULL, TRUE, 5, 6.28, &#39;Hi 👋&#39;
</a> └─ Values: blank row
<a href="#h33-0-6" id="h33-0-6" class="d">-NULL, TRUE, 5, 6.28, Hi 👋
</a><a href="#h33-0-7" id="h33-0-7" class="i">+NULL, TRUE, 5, 6.28, &#39;Hi 👋&#39;
</a> 
 # Bare select errors, as does trailing comma and identifier without a table.
 !&gt; SELECT
<a href="#h33-1" id="h33-1" class="h">@@ -44,8 +44,8 @@ Error: invalid input: expression must be constant, found column foo
</a> ---
 Scan: test
 test.id, test.bool, test.float, test.int, test.string
<a href="#h33-1-3" id="h33-1-3" class="d">-1, TRUE, 3.14, 7, foo
</a><a href="#h33-1-4" id="h33-1-4" class="d">-2, FALSE, 2.718, 1, 👍
</a><a href="#h33-1-5" id="h33-1-5" class="i">+1, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h33-1-6" id="h33-1-6" class="i">+2, FALSE, 2.718, 1, &#39;👍&#39;
</a> 3, NULL, NULL, NULL, NULL
 
 [plan,header]&gt; SELECT &quot;bool&quot; FROM test
<a href="#h33-2" id="h33-2" class="h">@@ -84,8 +84,8 @@ Error: invalid input: unsupported use of *
</a> Projection: test.id, test.bool, test.float, test.int, test.string, test.id, test.bool, test.float, test.int, test.string, test.id, test.bool, test.float, test.int, test.string
 └─ Scan: test
 test.id, test.bool, test.float, test.int, test.string, test.id, test.bool, test.float, test.int, test.string, test.id, test.bool, test.float, test.int, test.string
<a href="#h33-2-3" id="h33-2-3" class="d">-1, TRUE, 3.14, 7, foo, 1, TRUE, 3.14, 7, foo, 1, TRUE, 3.14, 7, foo
</a><a href="#h33-2-4" id="h33-2-4" class="d">-2, FALSE, 2.718, 1, 👍, 2, FALSE, 2.718, 1, 👍, 2, FALSE, 2.718, 1, 👍
</a><a href="#h33-2-5" id="h33-2-5" class="i">+1, TRUE, 3.14, 7, &#39;foo&#39;, 1, TRUE, 3.14, 7, &#39;foo&#39;, 1, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h33-2-6" id="h33-2-6" class="i">+2, FALSE, 2.718, 1, &#39;👍&#39;, 2, FALSE, 2.718, 1, &#39;👍&#39;, 2, FALSE, 2.718, 1, &#39;👍&#39;
</a> 3, NULL, NULL, NULL, NULL, 3, NULL, NULL, NULL, NULL, 3, NULL, NULL, NULL, NULL
 
 # Mix *, columns, column expressions, and constant expressions.
<a href="#h33-3" id="h33-3" class="h">@@ -94,8 +94,8 @@ test.id, test.bool, test.float, test.int, test.string, test.id, test.bool, test.
</a> Projection: test.id, 3, test.id, test.bool, test.float, test.int, test.string, test.float ^ 2
 └─ Scan: test
 test.id, , test.id, test.bool, test.float, test.int, test.string, 
<a href="#h33-3-3" id="h33-3-3" class="d">-1, 3, 1, TRUE, 3.14, 7, foo, 9.8596
</a><a href="#h33-3-4" id="h33-3-4" class="d">-2, 3, 2, FALSE, 2.718, 1, 👍, 7.387524
</a><a href="#h33-3-5" id="h33-3-5" class="i">+1, 3, 1, TRUE, 3.14, 7, &#39;foo&#39;, 9.8596
</a><a href="#h33-3-6" id="h33-3-6" class="i">+2, 3, 2, FALSE, 2.718, 1, &#39;👍&#39;, 7.387524
</a> 3, 3, 3, NULL, NULL, NULL, NULL, NULL
 
 # Column names may be qualified or unqualified.
<a href="#h33-4" id="h33-4" class="h">@@ -167,9 +167,9 @@ Error: invalid input: unknown column alias
</a> [header]&gt; SELECT &#39;foo&#39; AS id, id, id + 3 FROM test
 ---
 id, test.id, 
<a href="#h33-4-3" id="h33-4-3" class="d">-foo, 1, 4
</a><a href="#h33-4-4" id="h33-4-4" class="d">-foo, 2, 5
</a><a href="#h33-4-5" id="h33-4-5" class="d">-foo, 3, 6
</a><a href="#h33-4-6" id="h33-4-6" class="i">+&#39;foo&#39;, 1, 4
</a><a href="#h33-4-7" id="h33-4-7" class="i">+&#39;foo&#39;, 2, 5
</a><a href="#h33-4-8" id="h33-4-8" class="i">+&#39;foo&#39;, 3, 6
</a> 
 # Multiple aliases can have the same name.
 [header]&gt; SELECT 1 AS id, id, &quot;float&quot; AS id FROM test
<a href="#h33-5" id="h33-5" class="h">@@ -199,12 +199,12 @@ Error: invalid input: ambiguous column id
</a> # Unambiguous columns don&#39;t, resulting in a cross join.
 &gt; SELECT &quot;bool&quot;, value FROM test, other
 ---
<a href="#h33-5-3" id="h33-5-3" class="d">-TRUE, a
</a><a href="#h33-5-4" id="h33-5-4" class="d">-TRUE, b
</a><a href="#h33-5-5" id="h33-5-5" class="d">-FALSE, a
</a><a href="#h33-5-6" id="h33-5-6" class="d">-FALSE, b
</a><a href="#h33-5-7" id="h33-5-7" class="d">-NULL, a
</a><a href="#h33-5-8" id="h33-5-8" class="d">-NULL, b
</a><a href="#h33-5-9" id="h33-5-9" class="i">+TRUE, &#39;a&#39;
</a><a href="#h33-5-10" id="h33-5-10" class="i">+TRUE, &#39;b&#39;
</a><a href="#h33-5-11" id="h33-5-11" class="i">+FALSE, &#39;a&#39;
</a><a href="#h33-5-12" id="h33-5-12" class="i">+FALSE, &#39;b&#39;
</a><a href="#h33-5-13" id="h33-5-13" class="i">+NULL, &#39;a&#39;
</a><a href="#h33-5-14" id="h33-5-14" class="i">+NULL, &#39;b&#39;
</a> 
 # Qualified columns work, also when aliased.
 &gt; SELECT test.id, other.id FROM test, other
<b>diff --git a/<a id="h34" href="../file/src/sql/testscripts/queries/where_.html">src/sql/testscripts/queries/where_</a> b/<a href="../file/src/sql/testscripts/queries/where_.html">src/sql/testscripts/queries/where_</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -12,9 +12,9 @@ ok
</a> [plan]&gt; SELECT * FROM test WHERE TRUE
 ---
 Scan: test
<a href="#h34-0-3" id="h34-0-3" class="d">-1, a
</a><a href="#h34-0-4" id="h34-0-4" class="d">-2, b
</a><a href="#h34-0-5" id="h34-0-5" class="d">-3, c
</a><a href="#h34-0-6" id="h34-0-6" class="i">+1, &#39;a&#39;
</a><a href="#h34-0-7" id="h34-0-7" class="i">+2, &#39;b&#39;
</a><a href="#h34-0-8" id="h34-0-8" class="i">+3, &#39;c&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE FALSE
 ---
<a href="#h34-1" id="h34-1" class="h">@@ -29,13 +29,13 @@ Nothing
</a> [plan]&gt; SELECT * FROM test WHERE id &gt; 1
 ---
 Scan: test (test.id &gt; 1)
<a href="#h34-1-3" id="h34-1-3" class="d">-2, b
</a><a href="#h34-1-4" id="h34-1-4" class="d">-3, c
</a><a href="#h34-1-5" id="h34-1-5" class="i">+2, &#39;b&#39;
</a><a href="#h34-1-6" id="h34-1-6" class="i">+3, &#39;c&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE id &gt; 1 AND value &lt; &#39;c&#39;
 ---
<a href="#h34-1-10" id="h34-1-10" class="d">-Scan: test (test.id &gt; 1 AND test.value &lt; c)
</a><a href="#h34-1-11" id="h34-1-11" class="d">-2, b
</a><a href="#h34-1-12" id="h34-1-12" class="i">+Scan: test (test.id &gt; 1 AND test.value &lt; &#39;c&#39;)
</a><a href="#h34-1-13" id="h34-1-13" class="i">+2, &#39;b&#39;
</a> 
 # Errors on non-boolean type.
 !&gt; SELECT * FROM test WHERE 1
<a href="#h34-2" id="h34-2" class="h">@@ -44,7 +44,7 @@ Scan: test (test.id &gt; 1 AND test.value &lt; c)
</a> ---
 Error: invalid input: filter returned 1, expected boolean
 Error: invalid input: filter returned 1.0, expected boolean
<a href="#h34-2-3" id="h34-2-3" class="d">-Error: invalid input: filter returned , expected boolean
</a><a href="#h34-2-4" id="h34-2-4" class="i">+Error: invalid input: filter returned &#39;&#39;, expected boolean
</a> 
 # Errors on bare WHERE clause or multiple predicates.
 !&gt; SELECT * FROM test WHERE
<a href="#h34-3" id="h34-3" class="h">@@ -63,7 +63,7 @@ Error: invalid input: unknown table unknown
</a> # Qualified names are valid.
 &gt; SELECT * FROM test WHERE test.value = &#39;b&#39;
 ---
<a href="#h34-3-3" id="h34-3-3" class="d">-2, b
</a><a href="#h34-3-4" id="h34-3-4" class="i">+2, &#39;b&#39;
</a> 
 # Expression and column aliases aren&#39;t visible.
 !&gt; SELECT value AS v FROM test WHERE v = &#39;b&#39;
<a href="#h34-4" id="h34-4" class="h">@@ -75,7 +75,7 @@ Error: invalid input: expression must be constant, found column two
</a> # Table aliases are visible.
 &gt; SELECT * FROM test AS t WHERE t.id = 2
 ---
<a href="#h34-4-3" id="h34-4-3" class="d">-2, b
</a><a href="#h34-4-4" id="h34-4-4" class="i">+2, &#39;b&#39;
</a> 
 # Ambiguous columns error.
 !&gt; SELECT * FROM test, other WHERE id &gt; 1
<a href="#h34-5" id="h34-5" class="h">@@ -85,18 +85,18 @@ Error: invalid input: ambiguous column id
</a> # Unambiguous columns work.
 &gt; SELECT * FROM test, other WHERE value = &#39;b&#39;
 ---
<a href="#h34-5-3" id="h34-5-3" class="d">-2, b, 1, FALSE
</a><a href="#h34-5-4" id="h34-5-4" class="d">-2, b, 2, TRUE
</a><a href="#h34-5-5" id="h34-5-5" class="i">+2, &#39;b&#39;, 1, FALSE
</a><a href="#h34-5-6" id="h34-5-6" class="i">+2, &#39;b&#39;, 2, TRUE
</a> 
 
 # Qualified columns work, also when aliased.
 &gt; SELECT * FROM test, other WHERE test.id = 2 AND other.id = 2
 ---
<a href="#h34-5-12" id="h34-5-12" class="d">-2, b, 2, TRUE
</a><a href="#h34-5-13" id="h34-5-13" class="i">+2, &#39;b&#39;, 2, TRUE
</a> 
 &gt; SELECT * FROM test t, other o WHERE t.id = 2 AND o.id = 2
 ---
<a href="#h34-5-17" id="h34-5-17" class="d">-2, b, 2, TRUE
</a><a href="#h34-5-18" id="h34-5-18" class="i">+2, &#39;b&#39;, 2, TRUE
</a> 
 # WHERE can be combined with joins, even when aliased.
 [plan]&gt; SELECT * FROM test JOIN other ON test.id = other.id WHERE test.id &gt; 1
<a href="#h34-6" id="h34-6" class="h">@@ -104,11 +104,11 @@ Error: invalid input: ambiguous column id
</a> HashJoin: inner on test.id = other.id
 ├─ Scan: test (test.id &gt; 1)
 └─ Scan: other
<a href="#h34-6-3" id="h34-6-3" class="d">-2, b, 2, TRUE
</a><a href="#h34-6-4" id="h34-6-4" class="i">+2, &#39;b&#39;, 2, TRUE
</a> 
 [plan]&gt; SELECT * FROM test t JOIN other o ON t.id = o.id WHERE t.id &gt; 1
 ---
 HashJoin: inner on t.id = o.id
 ├─ Scan: test as t (t.id &gt; 1)
 └─ Scan: other as o
<a href="#h34-6-11" id="h34-6-11" class="d">-2, b, 2, TRUE
</a><a href="#h34-6-12" id="h34-6-12" class="i">+2, &#39;b&#39;, 2, TRUE
</a><b>diff --git a/<a id="h35" href="../file/src/sql/testscripts/queries/where_index.html">src/sql/testscripts/queries/where_index</a> b/<a href="../file/src/sql/testscripts/queries/where_index.html">src/sql/testscripts/queries/where_index</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -22,30 +22,30 @@ ok
</a> [plan]&gt; SELECT * FROM test WHERE &quot;bool&quot; = TRUE
 ---
 IndexLookup: test.bool (TRUE)
<a href="#h35-0-3" id="h35-0-3" class="d">-1, TRUE, 0, 3.14, abc
</a><a href="#h35-0-4" id="h35-0-4" class="d">-3, TRUE, 1, 0.0, ABC
</a><a href="#h35-0-5" id="h35-0-5" class="i">+1, TRUE, 0, 3.14, &#39;abc&#39;
</a><a href="#h35-0-6" id="h35-0-6" class="i">+3, TRUE, 1, 0.0, &#39;ABC&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;bool&quot; = FALSE
 ---
 IndexLookup: test.bool (FALSE)
<a href="#h35-0-11" id="h35-0-11" class="d">-2, FALSE, -1, -2.718, a
</a><a href="#h35-0-12" id="h35-0-12" class="i">+2, FALSE, -1, -2.718, &#39;a&#39;
</a> 
 # Integer lookups, including multiple matches and missing values.
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; = -1
 ---
 IndexLookup: test.int (-1)
<a href="#h35-0-18" id="h35-0-18" class="d">-2, FALSE, -1, -2.718, a
</a><a href="#h35-0-19" id="h35-0-19" class="i">+2, FALSE, -1, -2.718, &#39;a&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; = 0
 ---
 IndexLookup: test.int (0)
<a href="#h35-0-24" id="h35-0-24" class="d">-1, TRUE, 0, 3.14, abc
</a><a href="#h35-0-25" id="h35-0-25" class="i">+1, TRUE, 0, 3.14, &#39;abc&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; = 1
 ---
 IndexLookup: test.int (1)
<a href="#h35-0-30" id="h35-0-30" class="d">-3, TRUE, 1, 0.0, ABC
</a><a href="#h35-0-31" id="h35-0-31" class="d">-4, NULL, 1, 0.0, 👍
</a><a href="#h35-0-32" id="h35-0-32" class="i">+3, TRUE, 1, 0.0, &#39;ABC&#39;
</a><a href="#h35-0-33" id="h35-0-33" class="i">+4, NULL, 1, 0.0, &#39;👍&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; = 7
 ---
<a href="#h35-1" id="h35-1" class="h">@@ -56,29 +56,29 @@ IndexLookup: test.int (7)
</a> [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = -2.718
 ---
 IndexLookup: test.float (-2.718)
<a href="#h35-1-3" id="h35-1-3" class="d">-2, FALSE, -1, -2.718, a
</a><a href="#h35-1-4" id="h35-1-4" class="i">+2, FALSE, -1, -2.718, &#39;a&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = -0.0
 ---
 IndexLookup: test.float (-0.0)
<a href="#h35-1-9" id="h35-1-9" class="d">-3, TRUE, 1, 0.0, ABC
</a><a href="#h35-1-10" id="h35-1-10" class="d">-4, NULL, 1, 0.0, 👍
</a><a href="#h35-1-11" id="h35-1-11" class="i">+3, TRUE, 1, 0.0, &#39;ABC&#39;
</a><a href="#h35-1-12" id="h35-1-12" class="i">+4, NULL, 1, 0.0, &#39;👍&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = 0.0
 ---
 IndexLookup: test.float (0.0)
<a href="#h35-1-17" id="h35-1-17" class="d">-3, TRUE, 1, 0.0, ABC
</a><a href="#h35-1-18" id="h35-1-18" class="d">-4, NULL, 1, 0.0, 👍
</a><a href="#h35-1-19" id="h35-1-19" class="i">+3, TRUE, 1, 0.0, &#39;ABC&#39;
</a><a href="#h35-1-20" id="h35-1-20" class="i">+4, NULL, 1, 0.0, &#39;👍&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = 3.14
 ---
 IndexLookup: test.float (3.14)
<a href="#h35-1-25" id="h35-1-25" class="d">-1, TRUE, 0, 3.14, abc
</a><a href="#h35-1-26" id="h35-1-26" class="i">+1, TRUE, 0, 3.14, &#39;abc&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = INFINITY
 ---
 IndexLookup: test.float (inf)
<a href="#h35-1-31" id="h35-1-31" class="d">-5, NULL, NULL, inf, å
</a><a href="#h35-1-32" id="h35-1-32" class="i">+5, NULL, NULL, inf, &#39;å&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = NAN
 ---
<a href="#h35-2" id="h35-2" class="h">@@ -91,48 +91,48 @@ Nothing
</a> [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; IS NAN
 ---
 IndexLookup: test.float (NaN)
<a href="#h35-2-3" id="h35-2-3" class="d">-6, NULL, NULL, NaN, 
</a><a href="#h35-2-4" id="h35-2-4" class="i">+6, NULL, NULL, NaN, &#39;&#39;
</a> 
 # Strings. Should be case-insensitive.
 [plan]&gt; SELECT * FROM test WHERE &quot;string&quot; = &#39;abc&#39;
 ---
<a href="#h35-2-9" id="h35-2-9" class="d">-IndexLookup: test.string (abc)
</a><a href="#h35-2-10" id="h35-2-10" class="d">-1, TRUE, 0, 3.14, abc
</a><a href="#h35-2-11" id="h35-2-11" class="i">+IndexLookup: test.string (&#39;abc&#39;)
</a><a href="#h35-2-12" id="h35-2-12" class="i">+1, TRUE, 0, 3.14, &#39;abc&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;string&quot; = &#39;a&#39;
 ---
<a href="#h35-2-16" id="h35-2-16" class="d">-IndexLookup: test.string (a)
</a><a href="#h35-2-17" id="h35-2-17" class="d">-2, FALSE, -1, -2.718, a
</a><a href="#h35-2-18" id="h35-2-18" class="i">+IndexLookup: test.string (&#39;a&#39;)
</a><a href="#h35-2-19" id="h35-2-19" class="i">+2, FALSE, -1, -2.718, &#39;a&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;string&quot; = &#39;å&#39;
 ---
<a href="#h35-2-23" id="h35-2-23" class="d">-IndexLookup: test.string (å)
</a><a href="#h35-2-24" id="h35-2-24" class="d">-5, NULL, NULL, inf, å
</a><a href="#h35-2-25" id="h35-2-25" class="i">+IndexLookup: test.string (&#39;å&#39;)
</a><a href="#h35-2-26" id="h35-2-26" class="i">+5, NULL, NULL, inf, &#39;å&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;string&quot; = &#39;👍&#39;
 ---
<a href="#h35-2-30" id="h35-2-30" class="d">-IndexLookup: test.string (👍)
</a><a href="#h35-2-31" id="h35-2-31" class="d">-4, NULL, 1, 0.0, 👍
</a><a href="#h35-2-32" id="h35-2-32" class="i">+IndexLookup: test.string (&#39;👍&#39;)
</a><a href="#h35-2-33" id="h35-2-33" class="i">+4, NULL, 1, 0.0, &#39;👍&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;string&quot; = &#39;&#39;
 ---
<a href="#h35-2-37" id="h35-2-37" class="d">-IndexLookup: test.string ()
</a><a href="#h35-2-38" id="h35-2-38" class="d">-6, NULL, NULL, NaN, 
</a><a href="#h35-2-39" id="h35-2-39" class="i">+IndexLookup: test.string (&#39;&#39;)
</a><a href="#h35-2-40" id="h35-2-40" class="i">+6, NULL, NULL, NaN, &#39;&#39;
</a> 
 # LIKE does not use an index.
 [plan]&gt; SELECT * FROM test WHERE &quot;string&quot; LIKE &#39;a%&#39;
 ---
<a href="#h35-2-45" id="h35-2-45" class="d">-Scan: test (test.string LIKE a%)
</a><a href="#h35-2-46" id="h35-2-46" class="d">-1, TRUE, 0, 3.14, abc
</a><a href="#h35-2-47" id="h35-2-47" class="d">-2, FALSE, -1, -2.718, a
</a><a href="#h35-2-48" id="h35-2-48" class="i">+Scan: test (test.string LIKE &#39;a%&#39;)
</a><a href="#h35-2-49" id="h35-2-49" class="i">+1, TRUE, 0, 3.14, &#39;abc&#39;
</a><a href="#h35-2-50" id="h35-2-50" class="i">+2, FALSE, -1, -2.718, &#39;a&#39;
</a> 
 # IS NULL lookups should use an index. = NULL should give no matches.
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; IS NULL
 ---
 IndexLookup: test.int (NULL)
 0, NULL, NULL, NULL, NULL
<a href="#h35-2-57" id="h35-2-57" class="d">-5, NULL, NULL, inf, å
</a><a href="#h35-2-58" id="h35-2-58" class="d">-6, NULL, NULL, NaN, 
</a><a href="#h35-2-59" id="h35-2-59" class="i">+5, NULL, NULL, inf, &#39;å&#39;
</a><a href="#h35-2-60" id="h35-2-60" class="i">+6, NULL, NULL, NaN, &#39;&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; = NULL
 ---
<a href="#h35-3" id="h35-3" class="h">@@ -142,21 +142,21 @@ Nothing
</a> [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; = -1 OR &quot;int&quot; = 0 OR &quot;int&quot; = 1 OR &quot;int&quot; = 7
 ---
 IndexLookup: test.int (-1, 0, 1, 7)
<a href="#h35-3-3" id="h35-3-3" class="d">-1, TRUE, 0, 3.14, abc
</a><a href="#h35-3-4" id="h35-3-4" class="d">-2, FALSE, -1, -2.718, a
</a><a href="#h35-3-5" id="h35-3-5" class="d">-3, TRUE, 1, 0.0, ABC
</a><a href="#h35-3-6" id="h35-3-6" class="d">-4, NULL, 1, 0.0, 👍
</a><a href="#h35-3-7" id="h35-3-7" class="i">+1, TRUE, 0, 3.14, &#39;abc&#39;
</a><a href="#h35-3-8" id="h35-3-8" class="i">+2, FALSE, -1, -2.718, &#39;a&#39;
</a><a href="#h35-3-9" id="h35-3-9" class="i">+3, TRUE, 1, 0.0, &#39;ABC&#39;
</a><a href="#h35-3-10" id="h35-3-10" class="i">+4, NULL, 1, 0.0, &#39;👍&#39;
</a> 
 # &gt; or &lt; predicates don&#39;t use an index.
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; &lt; 1
 ---
 Scan: test (test.int &lt; 1)
<a href="#h35-3-16" id="h35-3-16" class="d">-1, TRUE, 0, 3.14, abc
</a><a href="#h35-3-17" id="h35-3-17" class="d">-2, FALSE, -1, -2.718, a
</a><a href="#h35-3-18" id="h35-3-18" class="i">+1, TRUE, 0, 3.14, &#39;abc&#39;
</a><a href="#h35-3-19" id="h35-3-19" class="i">+2, FALSE, -1, -2.718, &#39;a&#39;
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; &gt; -1
 ---
 Scan: test (test.int &gt; -1)
<a href="#h35-3-24" id="h35-3-24" class="d">-1, TRUE, 0, 3.14, abc
</a><a href="#h35-3-25" id="h35-3-25" class="d">-3, TRUE, 1, 0.0, ABC
</a><a href="#h35-3-26" id="h35-3-26" class="d">-4, NULL, 1, 0.0, 👍
</a><a href="#h35-3-27" id="h35-3-27" class="i">+1, TRUE, 0, 3.14, &#39;abc&#39;
</a><a href="#h35-3-28" id="h35-3-28" class="i">+3, TRUE, 1, 0.0, &#39;ABC&#39;
</a><a href="#h35-3-29" id="h35-3-29" class="i">+4, NULL, 1, 0.0, &#39;👍&#39;
</a><b>diff --git a/<a id="h36" href="../file/src/sql/testscripts/queries/where_primary_key.html">src/sql/testscripts/queries/where_primary_key</a> b/<a href="../file/src/sql/testscripts/queries/where_primary_key.html">src/sql/testscripts/queries/where_primary_key</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -85,35 +85,35 @@ KeyLookup: float (NaN)
</a> 
 [plan]&gt; SELECT * FROM &quot;string&quot; WHERE id = &#39;&#39;
 ---
<a href="#h36-0-3" id="h36-0-3" class="d">-&gt; KeyLookup: string ()
</a><a href="#h36-0-4" id="h36-0-4" class="d">-&gt; 
</a><a href="#h36-0-5" id="h36-0-5" class="i">+KeyLookup: string (&#39;&#39;)
</a><a href="#h36-0-6" id="h36-0-6" class="i">+&#39;&#39;
</a> 
 [plan]&gt; SELECT * FROM &quot;string&quot; WHERE id = &#39;a&#39;
 ---
<a href="#h36-0-10" id="h36-0-10" class="d">-KeyLookup: string (a)
</a><a href="#h36-0-11" id="h36-0-11" class="d">-a
</a><a href="#h36-0-12" id="h36-0-12" class="i">+KeyLookup: string (&#39;a&#39;)
</a><a href="#h36-0-13" id="h36-0-13" class="i">+&#39;a&#39;
</a> 
 [plan]&gt; SELECT * FROM &quot;string&quot; WHERE id = &#39;å&#39;
 ---
<a href="#h36-0-17" id="h36-0-17" class="d">-KeyLookup: string (å)
</a><a href="#h36-0-18" id="h36-0-18" class="d">-å
</a><a href="#h36-0-19" id="h36-0-19" class="i">+KeyLookup: string (&#39;å&#39;)
</a><a href="#h36-0-20" id="h36-0-20" class="i">+&#39;å&#39;
</a> 
 [plan]&gt; SELECT * FROM &quot;string&quot; WHERE id = &#39;abc&#39;
 ---
<a href="#h36-0-24" id="h36-0-24" class="d">-KeyLookup: string (abc)
</a><a href="#h36-0-25" id="h36-0-25" class="d">-abc
</a><a href="#h36-0-26" id="h36-0-26" class="i">+KeyLookup: string (&#39;abc&#39;)
</a><a href="#h36-0-27" id="h36-0-27" class="i">+&#39;abc&#39;
</a> 
 [plan]&gt; SELECT * FROM &quot;string&quot; WHERE id = &#39;👍&#39;
 ---
<a href="#h36-0-31" id="h36-0-31" class="d">-KeyLookup: string (👍)
</a><a href="#h36-0-32" id="h36-0-32" class="d">-👍
</a><a href="#h36-0-33" id="h36-0-33" class="i">+KeyLookup: string (&#39;👍&#39;)
</a><a href="#h36-0-34" id="h36-0-34" class="i">+&#39;👍&#39;
</a> 
 # LIKE does not use an index.
 [plan]&gt; SELECT * FROM &quot;string&quot; WHERE id LIKE &#39;a%&#39;
 ---
<a href="#h36-0-39" id="h36-0-39" class="d">-Scan: string (string.id LIKE a%)
</a><a href="#h36-0-40" id="h36-0-40" class="d">-a
</a><a href="#h36-0-41" id="h36-0-41" class="d">-abc
</a><a href="#h36-0-42" id="h36-0-42" class="i">+Scan: string (string.id LIKE &#39;a%&#39;)
</a><a href="#h36-0-43" id="h36-0-43" class="i">+&#39;a&#39;
</a><a href="#h36-0-44" id="h36-0-44" class="i">+&#39;abc&#39;
</a> 
 # NULL lookups should be legal but give no matches.
 [plan]&gt; SELECT * FROM &quot;int&quot; WHERE id = NULL
<b>diff --git a/<a id="h37" href="../file/src/sql/testscripts/schema/create_table_default.html">src/sql/testscripts/schema/create_table_default</a> b/<a href="../file/src/sql/testscripts/schema/create_table_default.html">src/sql/testscripts/schema/create_table_default</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -15,7 +15,7 @@ CREATE TABLE datatypes (
</a>   &quot;bool&quot; BOOLEAN DEFAULT TRUE,
   &quot;float&quot; FLOAT DEFAULT 3.14,
   &quot;int&quot; INTEGER DEFAULT 7,
<a href="#h37-0-3" id="h37-0-3" class="d">-  &quot;string&quot; STRING DEFAULT foo
</a><a href="#h37-0-4" id="h37-0-4" class="i">+  &quot;string&quot; STRING DEFAULT &#39;foo&#39;
</a> )
 
 # Default datatypes must match column. This includes float/integer types.
<b>diff --git a/<a id="h38" href="../file/src/sql/testscripts/schema/create_table_reference.html">src/sql/testscripts/schema/create_table_reference</a> b/<a href="../file/src/sql/testscripts/schema/create_table_reference.html">src/sql/testscripts/schema/create_table_reference</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -36,10 +36,10 @@ mvcc:NextVersion → 6 [&quot;\x00&quot; → &quot;\x06&quot;]
</a> mvcc:Version(sql:Table(name), 5) → CREATE TABLE name ( id INTEGER PRIMARY KEY, ref_id INTEGER DEFAULT NULL INDEX REFERENCES ref, sref_id STRING DEFAULT NULL INDEX REFERENCES sref ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x016\x04name\x00\x03\x02id\x01\x00\x00\x01\x00\x00\x06ref_id\x01\x01\x01\x00\x00\x01\x01\x03ref\x07sref_id\x03\x01\x01\x00\x00\x01\x01\x04sref&quot;]
 mvcc:Version(sql:Table(ref), 1) → CREATE TABLE ref ( id INTEGER PRIMARY KEY, value STRING NOT NULL ) [&quot;\x04\x00\xffref\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1b\x03ref\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x00\x00\x00\x00\x00&quot;]
 mvcc:Version(sql:Table(sref), 3) → CREATE TABLE sref ( id STRING PRIMARY KEY, value INTEGER NOT NULL ) [&quot;\x04\x00\xffsref\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x1c\x04sref\x00\x02\x02id\x03\x00\x00\x01\x00\x00\x05value\x01\x00\x00\x00\x00\x00&quot;]
<a href="#h38-0-3" id="h38-0-3" class="d">-mvcc:Version(sql:Row(ref, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h38-0-4" id="h38-0-4" class="d">-mvcc:Version(sql:Row(ref, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h38-0-5" id="h38-0-5" class="d">-mvcc:Version(sql:Row(sref, &quot;a&quot;), 4) → &quot;a&quot;,1 [&quot;\x04\x02sref\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x06\x02\x04\x01a\x02\x02&quot;]
</a><a href="#h38-0-6" id="h38-0-6" class="d">-mvcc:Version(sql:Row(sref, &quot;b&quot;), 4) → &quot;b&quot;,2 [&quot;\x04\x02sref\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x06\x02\x04\x01b\x02\x04&quot;]
</a><a href="#h38-0-7" id="h38-0-7" class="i">+mvcc:Version(sql:Row(ref, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h38-0-8" id="h38-0-8" class="i">+mvcc:Version(sql:Row(ref, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h38-0-9" id="h38-0-9" class="i">+mvcc:Version(sql:Row(sref, &#39;a&#39;), 4) → &#39;a&#39;,1 [&quot;\x04\x02sref\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x06\x02\x04\x01a\x02\x02&quot;]
</a><a href="#h38-0-10" id="h38-0-10" class="i">+mvcc:Version(sql:Row(sref, &#39;b&#39;), 4) → &#39;b&#39;,2 [&quot;\x04\x02sref\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x06\x02\x04\x01b\x02\x04&quot;]
</a> 
 # Missing reference table errors.
 !&gt; CREATE TABLE test (id INT PRIMARY KEY, &quot;ref&quot; INT REFERENCES missing)
<b>diff --git a/<a id="h39" href="../file/src/sql/testscripts/schema/drop_table.html">src/sql/testscripts/schema/drop_table</a> b/<a href="../file/src/sql/testscripts/schema/drop_table.html">src/sql/testscripts/schema/drop_table</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -33,9 +33,9 @@ dump
</a> mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
 mvcc:Version(sql:Table(name), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING NOT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1c\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x00\x00\x00\x00\x00&quot;]
 mvcc:Version(sql:Table(name), 3) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
<a href="#h39-0-3" id="h39-0-3" class="d">-mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h39-0-4" id="h39-0-4" class="i">+mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a> mvcc:Version(sql:Row(name, 1), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
<a href="#h39-0-6" id="h39-0-6" class="d">-mvcc:Version(sql:Row(name, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h39-0-7" id="h39-0-7" class="i">+mvcc:Version(sql:Row(name, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> mvcc:Version(sql:Row(name, 2), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
 
 # Dropping a missing table errors, but not if IF EXISTS is given.
<b>diff --git a/<a id="h40" href="../file/src/sql/testscripts/schema/drop_table_index.html">src/sql/testscripts/schema/drop_table_index</a> b/<a href="../file/src/sql/testscripts/schema/drop_table_index.html">src/sql/testscripts/schema/drop_table_index</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -31,12 +31,12 @@ mvcc:Version(sql:Index(name.unique, 1), 4) → 1 [&quot;\x04\x01name\x00\xff\x00\xffu
</a> mvcc:Version(sql:Index(name.unique, 2), 5) → 2 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
 mvcc:Version(sql:Index(name.unique, 3), 6) → 3 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 mvcc:Version(sql:Index(name.unique, 4), 7) → 4 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x08&quot;]
<a href="#h40-0-3" id="h40-0-3" class="d">-mvcc:Version(sql:Row(name, 1), 4) → 1,&quot;foo&quot;,1,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x0c\x04\x02\x02\x04\x03foo\x02\x02\x02\x02&quot;]
</a><a href="#h40-0-4" id="h40-0-4" class="d">-mvcc:Version(sql:Row(name, 2), 5) → 2,&quot;bar&quot;,2,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x0c\x04\x02\x04\x04\x03bar\x02\x04\x02\x04&quot;]
</a><a href="#h40-0-5" id="h40-0-5" class="d">-mvcc:Version(sql:Row(name, 3), 6) → 3,&quot;foo&quot;,3,NULL [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x0b\x04\x02\x06\x04\x03foo\x02\x06\x00&quot;]
</a><a href="#h40-0-6" id="h40-0-6" class="i">+mvcc:Version(sql:Row(name, 1), 4) → 1,&#39;foo&#39;,1,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x0c\x04\x02\x02\x04\x03foo\x02\x02\x02\x02&quot;]
</a><a href="#h40-0-7" id="h40-0-7" class="i">+mvcc:Version(sql:Row(name, 2), 5) → 2,&#39;bar&#39;,2,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x0c\x04\x02\x04\x04\x03bar\x02\x04\x02\x04&quot;]
</a><a href="#h40-0-8" id="h40-0-8" class="i">+mvcc:Version(sql:Row(name, 3), 6) → 3,&#39;foo&#39;,3,NULL [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x0b\x04\x02\x06\x04\x03foo\x02\x06\x00&quot;]
</a> mvcc:Version(sql:Row(name, 4), 7) → 4,NULL,4,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x08\x04\x02\x08\x00\x02\x08\x02\x04&quot;]
<a href="#h40-0-10" id="h40-0-10" class="d">-mvcc:Version(sql:Row(ref, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h40-0-11" id="h40-0-11" class="d">-mvcc:Version(sql:Row(ref, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h40-0-12" id="h40-0-12" class="i">+mvcc:Version(sql:Row(ref, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h40-0-13" id="h40-0-13" class="i">+mvcc:Version(sql:Row(ref, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> 
 # Dropping the table deletes all index entries.
 [ops]&gt; DROP TABLE name
<a href="#h40-1" id="h40-1" class="h">@@ -104,15 +104,15 @@ mvcc:Version(sql:Index(name.unique, 3), 6) → 3 [&quot;\x04\x01name\x00\xff\x00\xffu
</a> mvcc:Version(sql:Index(name.unique, 3), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
 mvcc:Version(sql:Index(name.unique, 4), 7) → 4 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x08&quot;]
 mvcc:Version(sql:Index(name.unique, 4), 8) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
<a href="#h40-1-3" id="h40-1-3" class="d">-mvcc:Version(sql:Row(name, 1), 4) → 1,&quot;foo&quot;,1,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x0c\x04\x02\x02\x04\x03foo\x02\x02\x02\x02&quot;]
</a><a href="#h40-1-4" id="h40-1-4" class="i">+mvcc:Version(sql:Row(name, 1), 4) → 1,&#39;foo&#39;,1,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x0c\x04\x02\x02\x04\x03foo\x02\x02\x02\x02&quot;]
</a> mvcc:Version(sql:Row(name, 1), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
<a href="#h40-1-6" id="h40-1-6" class="d">-mvcc:Version(sql:Row(name, 2), 5) → 2,&quot;bar&quot;,2,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x0c\x04\x02\x04\x04\x03bar\x02\x04\x02\x04&quot;]
</a><a href="#h40-1-7" id="h40-1-7" class="i">+mvcc:Version(sql:Row(name, 2), 5) → 2,&#39;bar&#39;,2,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x0c\x04\x02\x04\x04\x03bar\x02\x04\x02\x04&quot;]
</a> mvcc:Version(sql:Row(name, 2), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
<a href="#h40-1-9" id="h40-1-9" class="d">-mvcc:Version(sql:Row(name, 3), 6) → 3,&quot;foo&quot;,3,NULL [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x0b\x04\x02\x06\x04\x03foo\x02\x06\x00&quot;]
</a><a href="#h40-1-10" id="h40-1-10" class="i">+mvcc:Version(sql:Row(name, 3), 6) → 3,&#39;foo&#39;,3,NULL [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x0b\x04\x02\x06\x04\x03foo\x02\x06\x00&quot;]
</a> mvcc:Version(sql:Row(name, 3), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
 mvcc:Version(sql:Row(name, 4), 7) → 4,NULL,4,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x08\x04\x02\x08\x00\x02\x08\x02\x04&quot;]
 mvcc:Version(sql:Row(name, 4), 8) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
<a href="#h40-1-14" id="h40-1-14" class="d">-mvcc:Version(sql:Row(ref, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h40-1-15" id="h40-1-15" class="i">+mvcc:Version(sql:Row(ref, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a> mvcc:Version(sql:Row(ref, 1), 9) → None [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
<a href="#h40-1-17" id="h40-1-17" class="d">-mvcc:Version(sql:Row(ref, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h40-1-18" id="h40-1-18" class="i">+mvcc:Version(sql:Row(ref, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> mvcc:Version(sql:Row(ref, 2), 9) → None [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
<b>diff --git a/<a id="h41" href="../file/src/sql/testscripts/schema/drop_table_transaction.html">src/sql/testscripts/schema/drop_table_transaction</a> b/<a href="../file/src/sql/testscripts/schema/drop_table_transaction.html">src/sql/testscripts/schema/drop_table_transaction</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -9,8 +9,8 @@ dump
</a> ---
 mvcc:NextVersion → 3 [&quot;\x00&quot; → &quot;\x03&quot;]
 mvcc:Version(sql:Table(name), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
<a href="#h41-0-3" id="h41-0-3" class="d">-mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h41-0-4" id="h41-0-4" class="d">-mvcc:Version(sql:Row(name, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h41-0-5" id="h41-0-5" class="i">+mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h41-0-6" id="h41-0-6" class="i">+mvcc:Version(sql:Row(name, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> 
 # Drop the table in a transaction.
 &gt; BEGIN
<a href="#h41-1" id="h41-1" class="h">@@ -36,9 +36,9 @@ mvcc:TxnWrite(3, sql:Row(name, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03
</a> mvcc:TxnWrite(3, sql:Row(name, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
 mvcc:Version(sql:Table(name), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
 mvcc:Version(sql:Table(name), 3) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
<a href="#h41-1-3" id="h41-1-3" class="d">-mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h41-1-4" id="h41-1-4" class="i">+mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a> mvcc:Version(sql:Row(name, 1), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
<a href="#h41-1-6" id="h41-1-6" class="d">-mvcc:Version(sql:Row(name, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h41-1-7" id="h41-1-7" class="i">+mvcc:Version(sql:Row(name, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> mvcc:Version(sql:Row(name, 2), 3) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
 
 # Rolling it back undoes it.
<a href="#h41-2" id="h41-2" class="h">@@ -56,8 +56,8 @@ dump
</a> ---
 mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
 mvcc:Version(sql:Table(name), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
<a href="#h41-2-3" id="h41-2-3" class="d">-mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h41-2-4" id="h41-2-4" class="d">-mvcc:Version(sql:Row(name, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h41-2-5" id="h41-2-5" class="i">+mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h41-2-6" id="h41-2-6" class="i">+mvcc:Version(sql:Row(name, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> 
 # Committing the drop also works.
 &gt; BEGIN
<a href="#h41-3" id="h41-3" class="h">@@ -74,7 +74,7 @@ dump
</a> mvcc:NextVersion → 5 [&quot;\x00&quot; → &quot;\x05&quot;]
 mvcc:Version(sql:Table(name), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
 mvcc:Version(sql:Table(name), 4) → None [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x00&quot;]
<a href="#h41-3-3" id="h41-3-3" class="d">-mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h41-3-4" id="h41-3-4" class="i">+mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a> mvcc:Version(sql:Row(name, 1), 4) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x00&quot;]
<a href="#h41-3-6" id="h41-3-6" class="d">-mvcc:Version(sql:Row(name, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h41-3-7" id="h41-3-7" class="i">+mvcc:Version(sql:Row(name, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> mvcc:Version(sql:Row(name, 2), 4) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x00&quot;]
<b>diff --git a/<a id="h42" href="../file/src/sql/testscripts/writes/delete.html">src/sql/testscripts/writes/delete</a> b/<a href="../file/src/sql/testscripts/writes/delete.html">src/sql/testscripts/writes/delete</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -60,11 +60,11 @@ dump
</a> ---
 mvcc:NextVersion → 6 [&quot;\x00&quot; → &quot;\x06&quot;]
 mvcc:Version(sql:Table(name), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
<a href="#h42-0-3" id="h42-0-3" class="d">-mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h42-0-4" id="h42-0-4" class="i">+mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a> mvcc:Version(sql:Row(name, 1), 5) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x00&quot;]
<a href="#h42-0-6" id="h42-0-6" class="d">-mvcc:Version(sql:Row(name, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h42-0-7" id="h42-0-7" class="i">+mvcc:Version(sql:Row(name, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> mvcc:Version(sql:Row(name, 2), 5) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x00&quot;]
<a href="#h42-0-9" id="h42-0-9" class="d">-mvcc:Version(sql:Row(name, 3), 2) → 3,&quot;c&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x06\x04\x01c&quot;]
</a><a href="#h42-0-10" id="h42-0-10" class="i">+mvcc:Version(sql:Row(name, 3), 2) → 3,&#39;c&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x06\x04\x01c&quot;]
</a> mvcc:Version(sql:Row(name, 3), 5) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x00&quot;]
 
 # Bare DELETE errors.
<b>diff --git a/<a id="h43" href="../file/src/sql/testscripts/writes/delete_index.html">src/sql/testscripts/writes/delete_index</a> b/<a href="../file/src/sql/testscripts/writes/delete_index.html">src/sql/testscripts/writes/delete_index</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -24,23 +24,23 @@ storage set mvcc:NextVersion → 10 [&quot;\x00&quot; → &quot;\n&quot;]
</a> storage set mvcc:TxnActive(9) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(9, sql:Index(name.index, 8)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x01name\x00\xff\x00\xffindex\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.index, 8), 9) → None [&quot;\x04\x01name\x00\xff\x00\xffindex\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
<a href="#h43-0-3" id="h43-0-3" class="d">-storage set mvcc:TxnWrite(9, sql:Index(name.unique, &quot;baz&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h43-0-4" id="h43-0-4" class="d">-storage set mvcc:Version(sql:Index(name.unique, &quot;baz&quot;), 9) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
</a><a href="#h43-0-5" id="h43-0-5" class="i">+storage set mvcc:TxnWrite(9, sql:Index(name.unique, &#39;baz&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h43-0-6" id="h43-0-6" class="i">+storage set mvcc:Version(sql:Index(name.unique, &#39;baz&#39;), 9) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
</a> storage set mvcc:TxnWrite(9, sql:Index(name.ref_id, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.ref_id, 2), 9) → 3 [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 storage set mvcc:TxnWrite(9, sql:Row(name, 4)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Row(name, 4), 9) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
 storage delete mvcc:TxnWrite(9, sql:Index(name.index, 8)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x01name\x00\xff\x00\xffindex\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00&quot;]
 storage delete mvcc:TxnWrite(9, sql:Index(name.ref_id, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
<a href="#h43-0-13" id="h43-0-13" class="d">-storage delete mvcc:TxnWrite(9, sql:Index(name.unique, &quot;baz&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h43-0-14" id="h43-0-14" class="i">+storage delete mvcc:TxnWrite(9, sql:Index(name.unique, &#39;baz&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(9, sql:Row(name, 4)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\t\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00&quot;]
 storage delete mvcc:TxnActive(9) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\t&quot;]
 
 # Dump the final state.
 &gt; SELECT * FROM name
 ---
<a href="#h43-0-21" id="h43-0-21" class="d">-1, 2, foo, 1
</a><a href="#h43-0-22" id="h43-0-22" class="d">-2, 4, bar, 1
</a><a href="#h43-0-23" id="h43-0-23" class="i">+1, 2, &#39;foo&#39;, 1
</a><a href="#h43-0-24" id="h43-0-24" class="i">+2, 4, &#39;bar&#39;, 1
</a> 3, 6, NULL, 2
 5, 10, NULL, 1
 
<a href="#h43-1" id="h43-1" class="h">@@ -63,15 +63,15 @@ mvcc:Version(sql:Index(name.ref_id, 2), 7) → 3,4 [&quot;\x04\x01name\x00\xff\x00\xf
</a> mvcc:Version(sql:Index(name.ref_id, 2), 9) → 3 [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 mvcc:Version(sql:Index(name.unique, NULL), 6) → 3 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 mvcc:Version(sql:Index(name.unique, NULL), 8) → 3,5 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x05\x02\x02\x06\x02\n&quot;]
<a href="#h43-1-3" id="h43-1-3" class="d">-mvcc:Version(sql:Index(name.unique, &quot;bar&quot;), 5) → 2 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h43-1-4" id="h43-1-4" class="d">-mvcc:Version(sql:Index(name.unique, &quot;baz&quot;), 7) → 4 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x08&quot;]
</a><a href="#h43-1-5" id="h43-1-5" class="d">-mvcc:Version(sql:Index(name.unique, &quot;baz&quot;), 9) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
</a><a href="#h43-1-6" id="h43-1-6" class="d">-mvcc:Version(sql:Index(name.unique, &quot;foo&quot;), 4) → 1 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h43-1-7" id="h43-1-7" class="d">-mvcc:Version(sql:Row(name, 1), 4) → 1,2,&quot;foo&quot;,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x0c\x04\x02\x02\x02\x04\x04\x03foo\x02\x02&quot;]
</a><a href="#h43-1-8" id="h43-1-8" class="d">-mvcc:Version(sql:Row(name, 2), 5) → 2,4,&quot;bar&quot;,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x0c\x04\x02\x04\x02\x08\x04\x03bar\x02\x02&quot;]
</a><a href="#h43-1-9" id="h43-1-9" class="i">+mvcc:Version(sql:Index(name.unique, &#39;bar&#39;), 5) → 2 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h43-1-10" id="h43-1-10" class="i">+mvcc:Version(sql:Index(name.unique, &#39;baz&#39;), 7) → 4 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x08&quot;]
</a><a href="#h43-1-11" id="h43-1-11" class="i">+mvcc:Version(sql:Index(name.unique, &#39;baz&#39;), 9) → None [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04baz\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
</a><a href="#h43-1-12" id="h43-1-12" class="i">+mvcc:Version(sql:Index(name.unique, &#39;foo&#39;), 4) → 1 [&quot;\x04\x01name\x00\xff\x00\xffunique\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h43-1-13" id="h43-1-13" class="i">+mvcc:Version(sql:Row(name, 1), 4) → 1,2,&#39;foo&#39;,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x0c\x04\x02\x02\x02\x04\x04\x03foo\x02\x02&quot;]
</a><a href="#h43-1-14" id="h43-1-14" class="i">+mvcc:Version(sql:Row(name, 2), 5) → 2,4,&#39;bar&#39;,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot; → &quot;\x01\x0c\x04\x02\x04\x02\x08\x04\x03bar\x02\x02&quot;]
</a> mvcc:Version(sql:Row(name, 3), 6) → 3,6,NULL,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x08\x04\x02\x06\x02\x0c\x00\x02\x04&quot;]
<a href="#h43-1-16" id="h43-1-16" class="d">-mvcc:Version(sql:Row(name, 4), 7) → 4,8,&quot;baz&quot;,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x0c\x04\x02\x08\x02\x10\x04\x03baz\x02\x04&quot;]
</a><a href="#h43-1-17" id="h43-1-17" class="i">+mvcc:Version(sql:Row(name, 4), 7) → 4,8,&#39;baz&#39;,2 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x0c\x04\x02\x08\x02\x10\x04\x03baz\x02\x04&quot;]
</a> mvcc:Version(sql:Row(name, 4), 9) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x00&quot;]
 mvcc:Version(sql:Row(name, 5), 8) → 5,10,NULL,1 [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x08\x04\x02\n\x02\x14\x00\x02\x02&quot;]
<a href="#h43-1-20" id="h43-1-20" class="d">-mvcc:Version(sql:Row(ref, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h43-1-21" id="h43-1-21" class="d">-mvcc:Version(sql:Row(ref, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h43-1-22" id="h43-1-22" class="i">+mvcc:Version(sql:Row(ref, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h43-1-23" id="h43-1-23" class="i">+mvcc:Version(sql:Row(ref, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><b>diff --git a/<a id="h44" href="../file/src/sql/testscripts/writes/delete_reference.html">src/sql/testscripts/writes/delete_reference</a> b/<a href="../file/src/sql/testscripts/writes/delete_reference.html">src/sql/testscripts/writes/delete_reference</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -29,9 +29,9 @@ Error: invalid input: primary key referenced by name.id=1
</a> 
 &gt; SELECT * FROM ref
 ---
<a href="#h44-0-3" id="h44-0-3" class="d">-1, a
</a><a href="#h44-0-4" id="h44-0-4" class="d">-2, b
</a><a href="#h44-0-5" id="h44-0-5" class="d">-3, c
</a><a href="#h44-0-6" id="h44-0-6" class="i">+1, &#39;a&#39;
</a><a href="#h44-0-7" id="h44-0-7" class="i">+2, &#39;b&#39;
</a><a href="#h44-0-8" id="h44-0-8" class="i">+3, &#39;c&#39;
</a> 
 # DELETE of an unreferenced row succeeds.
 [ops]&gt; DELETE FROM ref WHERE id = 3
<a href="#h44-1" id="h44-1" class="h">@@ -45,8 +45,8 @@ storage delete mvcc:TxnActive(13) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\r&quot;]
</a> 
 &gt; SELECT * FROM ref
 ---
<a href="#h44-1-3" id="h44-1-3" class="d">-1, a
</a><a href="#h44-1-4" id="h44-1-4" class="d">-2, b
</a><a href="#h44-1-5" id="h44-1-5" class="i">+1, &#39;a&#39;
</a><a href="#h44-1-6" id="h44-1-6" class="i">+2, &#39;b&#39;
</a> 
 # DELETE in the source table succeeds. It also removes the index entries.
 [ops]&gt; DELETE FROM name WHERE id = 2 OR id = 3
<a href="#h44-2" id="h44-2" class="h">@@ -55,19 +55,19 @@ storage set mvcc:NextVersion → 15 [&quot;\x00&quot; → &quot;\x0f&quot;]
</a> storage set mvcc:TxnActive(14) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(14, sql:Index(name.ref_id, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.ref_id, NULL), 14) → None [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
<a href="#h44-2-3" id="h44-2-3" class="d">-storage set mvcc:TxnWrite(14, sql:Index(name.sref_id, &quot;b&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h44-2-4" id="h44-2-4" class="d">-storage set mvcc:Version(sql:Index(name.sref_id, &quot;b&quot;), 14) → 3 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a><a href="#h44-2-5" id="h44-2-5" class="i">+storage set mvcc:TxnWrite(14, sql:Index(name.sref_id, &#39;b&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h44-2-6" id="h44-2-6" class="i">+storage set mvcc:Version(sql:Index(name.sref_id, &#39;b&#39;), 14) → 3 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a> storage set mvcc:TxnWrite(14, sql:Row(name, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Row(name, 2), 14) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
 storage set mvcc:TxnWrite(14, sql:Index(name.ref_id, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.ref_id, 2), 14) → 4 [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x01\x03\x01\x02\x08&quot;]
<a href="#h44-2-11" id="h44-2-11" class="d">-storage set mvcc:TxnWrite(14, sql:Index(name.sref_id, &quot;b&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h44-2-12" id="h44-2-12" class="d">-storage set mvcc:Version(sql:Index(name.sref_id, &quot;b&quot;), 14) → None [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
</a><a href="#h44-2-13" id="h44-2-13" class="i">+storage set mvcc:TxnWrite(14, sql:Index(name.sref_id, &#39;b&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h44-2-14" id="h44-2-14" class="i">+storage set mvcc:Version(sql:Index(name.sref_id, &#39;b&#39;), 14) → None [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
</a> storage set mvcc:TxnWrite(14, sql:Row(name, 3)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Row(name, 3), 14) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
 storage delete mvcc:TxnWrite(14, sql:Index(name.ref_id, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(14, sql:Index(name.ref_id, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
<a href="#h44-2-19" id="h44-2-19" class="d">-storage delete mvcc:TxnWrite(14, sql:Index(name.sref_id, &quot;b&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h44-2-20" id="h44-2-20" class="i">+storage delete mvcc:TxnWrite(14, sql:Index(name.sref_id, &#39;b&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(14, sql:Row(name, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnWrite(14, sql:Row(name, 3)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot;]
 storage delete mvcc:TxnActive(14) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0e&quot;]
<a href="#h44-3" id="h44-3" class="h">@@ -129,28 +129,28 @@ mvcc:Version(sql:Index(name.ref_id, 1), 10) → 1,5 [&quot;\x04\x01name\x00\xff\x00\x
</a> mvcc:Version(sql:Index(name.ref_id, 2), 8) → 3 [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 mvcc:Version(sql:Index(name.ref_id, 2), 9) → 3,4 [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x01\x05\x02\x02\x06\x02\x08&quot;]
 mvcc:Version(sql:Index(name.ref_id, 2), 14) → 4 [&quot;\x04\x01name\x00\xff\x00\xffref_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x01\x03\x01\x02\x08&quot;]
<a href="#h44-3-3" id="h44-3-3" class="d">-mvcc:Version(sql:Index(name.sref_id, &quot;a&quot;), 6) → 1 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h44-3-4" id="h44-3-4" class="d">-mvcc:Version(sql:Index(name.sref_id, &quot;a&quot;), 9) → 1,4 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x01\x05\x02\x02\x02\x02\x08&quot;]
</a><a href="#h44-3-5" id="h44-3-5" class="d">-mvcc:Version(sql:Index(name.sref_id, &quot;a&quot;), 10) → 1,4,5 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x07\x03\x02\x02\x02\x08\x02\n&quot;]
</a><a href="#h44-3-6" id="h44-3-6" class="d">-mvcc:Version(sql:Index(name.sref_id, &quot;b&quot;), 7) → 2 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h44-3-7" id="h44-3-7" class="d">-mvcc:Version(sql:Index(name.sref_id, &quot;b&quot;), 8) → 2,3 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x05\x02\x02\x04\x02\x06&quot;]
</a><a href="#h44-3-8" id="h44-3-8" class="d">-mvcc:Version(sql:Index(name.sref_id, &quot;b&quot;), 14) → None [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
</a><a href="#h44-3-9" id="h44-3-9" class="i">+mvcc:Version(sql:Index(name.sref_id, &#39;a&#39;), 6) → 1 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h44-3-10" id="h44-3-10" class="i">+mvcc:Version(sql:Index(name.sref_id, &#39;a&#39;), 9) → 1,4 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x01\x05\x02\x02\x02\x02\x08&quot;]
</a><a href="#h44-3-11" id="h44-3-11" class="i">+mvcc:Version(sql:Index(name.sref_id, &#39;a&#39;), 10) → 1,4,5 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x07\x03\x02\x02\x02\x08\x02\n&quot;]
</a><a href="#h44-3-12" id="h44-3-12" class="i">+mvcc:Version(sql:Index(name.sref_id, &#39;b&#39;), 7) → 2 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h44-3-13" id="h44-3-13" class="i">+mvcc:Version(sql:Index(name.sref_id, &#39;b&#39;), 8) → 2,3 [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x05\x02\x02\x04\x02\x06&quot;]
</a><a href="#h44-3-14" id="h44-3-14" class="i">+mvcc:Version(sql:Index(name.sref_id, &#39;b&#39;), 14) → None [&quot;\x04\x01name\x00\xff\x00\xffsref_id\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
</a> mvcc:Version(sql:Index(self.self_id, 1), 17) → 1 [&quot;\x04\x01self\x00\xff\x00\xffself_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 mvcc:Version(sql:Index(self.self_id, 1), 24) → None [&quot;\x04\x01self\x00\xff\x00\xffself_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18&quot; → &quot;\x00&quot;]
 mvcc:Version(sql:Index(self.self_id, 2), 18) → 2 [&quot;\x04\x01self\x00\xff\x00\xffself_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
 mvcc:Version(sql:Index(self.self_id, 2), 19) → 2,3 [&quot;\x04\x01self\x00\xff\x00\xffself_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x05\x02\x02\x04\x02\x06&quot;]
 mvcc:Version(sql:Index(self.self_id, 2), 20) → 2,3,4 [&quot;\x04\x01self\x00\xff\x00\xffself_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x14&quot; → &quot;\x01\x07\x03\x02\x04\x02\x06\x02\x08&quot;]
 mvcc:Version(sql:Index(self.self_id, 2), 23) → 2,3 [&quot;\x04\x01self\x00\xff\x00\xffself_id\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17&quot; → &quot;\x01\x05\x02\x02\x04\x02\x06&quot;]
<a href="#h44-3-21" id="h44-3-21" class="d">-mvcc:Version(sql:Row(name, 1), 6) → 1,1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x08\x03\x02\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h44-3-22" id="h44-3-22" class="d">-mvcc:Version(sql:Row(name, 2), 7) → 2,NULL,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x07\x03\x02\x04\x00\x04\x01b&quot;]
</a><a href="#h44-3-23" id="h44-3-23" class="i">+mvcc:Version(sql:Row(name, 1), 6) → 1,1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x08\x03\x02\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h44-3-24" id="h44-3-24" class="i">+mvcc:Version(sql:Row(name, 2), 7) → 2,NULL,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x07\x03\x02\x04\x00\x04\x01b&quot;]
</a> mvcc:Version(sql:Row(name, 2), 14) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
<a href="#h44-3-26" id="h44-3-26" class="d">-mvcc:Version(sql:Row(name, 3), 8) → 3,2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x08\x03\x02\x06\x02\x04\x04\x01b&quot;]
</a><a href="#h44-3-27" id="h44-3-27" class="i">+mvcc:Version(sql:Row(name, 3), 8) → 3,2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x08\x03\x02\x06\x02\x04\x04\x01b&quot;]
</a> mvcc:Version(sql:Row(name, 3), 14) → None [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e&quot; → &quot;\x00&quot;]
<a href="#h44-3-29" id="h44-3-29" class="d">-mvcc:Version(sql:Row(name, 4), 9) → 4,2,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x01\x08\x03\x02\x08\x02\x04\x04\x01a&quot;]
</a><a href="#h44-3-30" id="h44-3-30" class="d">-mvcc:Version(sql:Row(name, 5), 10) → 5,1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x08\x03\x02\n\x02\x02\x04\x01a&quot;]
</a><a href="#h44-3-31" id="h44-3-31" class="d">-mvcc:Version(sql:Row(ref, 1), 3) → 1,&quot;a&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h44-3-32" id="h44-3-32" class="d">-mvcc:Version(sql:Row(ref, 2), 3) → 2,&quot;b&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h44-3-33" id="h44-3-33" class="d">-mvcc:Version(sql:Row(ref, 3), 3) → 3,&quot;c&quot; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x06\x04\x01c&quot;]
</a><a href="#h44-3-34" id="h44-3-34" class="i">+mvcc:Version(sql:Row(name, 4), 9) → 4,2,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\t&quot; → &quot;\x01\x08\x03\x02\x08\x02\x04\x04\x01a&quot;]
</a><a href="#h44-3-35" id="h44-3-35" class="i">+mvcc:Version(sql:Row(name, 5), 10) → 5,1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x08\x03\x02\n\x02\x02\x04\x01a&quot;]
</a><a href="#h44-3-36" id="h44-3-36" class="i">+mvcc:Version(sql:Row(ref, 1), 3) → 1,&#39;a&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h44-3-37" id="h44-3-37" class="i">+mvcc:Version(sql:Row(ref, 2), 3) → 2,&#39;b&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h44-3-38" id="h44-3-38" class="i">+mvcc:Version(sql:Row(ref, 3), 3) → 3,&#39;c&#39; [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x06\x04\x01c&quot;]
</a> mvcc:Version(sql:Row(ref, 3), 13) → None [&quot;\x04\x02ref\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x00&quot;]
 mvcc:Version(sql:Row(self, 1), 17) → 1,1 [&quot;\x04\x02self\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11&quot; → &quot;\x01\x05\x02\x02\x02\x02\x02&quot;]
 mvcc:Version(sql:Row(self, 1), 24) → None [&quot;\x04\x02self\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18&quot; → &quot;\x00&quot;]
<a href="#h44-4" id="h44-4" class="h">@@ -158,6 +158,6 @@ mvcc:Version(sql:Row(self, 2), 18) → 2,2 [&quot;\x04\x02self\x00\xff\x00\xff\x02\x8
</a> mvcc:Version(sql:Row(self, 3), 19) → 3,2 [&quot;\x04\x02self\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x05\x02\x02\x06\x02\x04&quot;]
 mvcc:Version(sql:Row(self, 4), 20) → 4,2 [&quot;\x04\x02self\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x14&quot; → &quot;\x01\x05\x02\x02\x08\x02\x04&quot;]
 mvcc:Version(sql:Row(self, 4), 23) → None [&quot;\x04\x02self\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17&quot; → &quot;\x00&quot;]
<a href="#h44-4-3" id="h44-4-3" class="d">-mvcc:Version(sql:Row(sref, &quot;a&quot;), 4) → &quot;a&quot; [&quot;\x04\x02sref\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x04\x01\x04\x01a&quot;]
</a><a href="#h44-4-4" id="h44-4-4" class="d">-mvcc:Version(sql:Row(sref, &quot;b&quot;), 4) → &quot;b&quot; [&quot;\x04\x02sref\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x04\x01\x04\x01b&quot;]
</a><a href="#h44-4-5" id="h44-4-5" class="d">-mvcc:Version(sql:Row(sref, &quot;b&quot;), 15) → None [&quot;\x04\x02sref\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; → &quot;\x00&quot;]
</a><a href="#h44-4-6" id="h44-4-6" class="i">+mvcc:Version(sql:Row(sref, &#39;a&#39;), 4) → &#39;a&#39; [&quot;\x04\x02sref\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x04\x01\x04\x01a&quot;]
</a><a href="#h44-4-7" id="h44-4-7" class="i">+mvcc:Version(sql:Row(sref, &#39;b&#39;), 4) → &#39;b&#39; [&quot;\x04\x02sref\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x04\x01\x04\x01b&quot;]
</a><a href="#h44-4-8" id="h44-4-8" class="i">+mvcc:Version(sql:Row(sref, &#39;b&#39;), 15) → None [&quot;\x04\x02sref\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; → &quot;\x00&quot;]
</a><b>diff --git a/<a id="h45" href="../file/src/sql/testscripts/writes/delete_where.html">src/sql/testscripts/writes/delete_where</a> b/<a href="../file/src/sql/testscripts/writes/delete_where.html">src/sql/testscripts/writes/delete_where</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -21,9 +21,9 @@ Delete: name
</a> Delete: name
 └─ Nothing
 0, NULL, NULL
<a href="#h45-0-3" id="h45-0-3" class="d">-1, a, 1
</a><a href="#h45-0-4" id="h45-0-4" class="d">-2, b, 2
</a><a href="#h45-0-5" id="h45-0-5" class="d">-3, c, 3
</a><a href="#h45-0-6" id="h45-0-6" class="i">+1, &#39;a&#39;, 1
</a><a href="#h45-0-7" id="h45-0-7" class="i">+2, &#39;b&#39;, 2
</a><a href="#h45-0-8" id="h45-0-8" class="i">+3, &#39;c&#39;, 3
</a> 
 # Deleting by primary key lookup works.
 &gt; BEGIN
<a href="#h45-1" id="h45-1" class="h">@@ -34,7 +34,7 @@ Delete: name
</a> Delete: name
 └─ KeyLookup: name (1, 3)
 0, NULL, NULL
<a href="#h45-1-3" id="h45-1-3" class="d">-2, b, 2
</a><a href="#h45-1-4" id="h45-1-4" class="i">+2, &#39;b&#39;, 2
</a> 
 # Deleting by secondary index lookup works.
 &gt; BEGIN
<a href="#h45-2" id="h45-2" class="h">@@ -45,8 +45,8 @@ Delete: name
</a> Delete: name
 └─ IndexLookup: name.index (3)
 0, NULL, NULL
<a href="#h45-2-3" id="h45-2-3" class="d">-1, a, 1
</a><a href="#h45-2-4" id="h45-2-4" class="d">-2, b, 2
</a><a href="#h45-2-5" id="h45-2-5" class="i">+1, &#39;a&#39;, 1
</a><a href="#h45-2-6" id="h45-2-6" class="i">+2, &#39;b&#39;, 2
</a> 
 # Including IS NULL predicates.
 &gt; BEGIN
<a href="#h45-3" id="h45-3" class="h">@@ -56,9 +56,9 @@ Delete: name
</a> ---
 Delete: name
 └─ IndexLookup: name.index (NULL)
<a href="#h45-3-3" id="h45-3-3" class="d">-1, a, 1
</a><a href="#h45-3-4" id="h45-3-4" class="d">-2, b, 2
</a><a href="#h45-3-5" id="h45-3-5" class="d">-3, c, 3
</a><a href="#h45-3-6" id="h45-3-6" class="i">+1, &#39;a&#39;, 1
</a><a href="#h45-3-7" id="h45-3-7" class="i">+2, &#39;b&#39;, 2
</a><a href="#h45-3-8" id="h45-3-8" class="i">+3, &#39;c&#39;, 3
</a> 
 # Deleting by arbitrary predicate works.
 &gt; BEGIN
<a href="#h45-4" id="h45-4" class="h">@@ -67,9 +67,9 @@ Delete: name
</a> &gt; ROLLBACK
 ---
 Delete: name
<a href="#h45-4-3" id="h45-4-3" class="d">-└─ Scan: name (name.id &gt; 3 OR name.id = 3 OR name.value LIKE a IS NULL)
</a><a href="#h45-4-4" id="h45-4-4" class="d">-1, a, 1
</a><a href="#h45-4-5" id="h45-4-5" class="d">-2, b, 2
</a><a href="#h45-4-6" id="h45-4-6" class="i">+└─ Scan: name (name.id &gt; 3 OR name.id = 3 OR name.value LIKE &#39;a&#39; IS NULL)
</a><a href="#h45-4-7" id="h45-4-7" class="i">+1, &#39;a&#39;, 1
</a><a href="#h45-4-8" id="h45-4-8" class="i">+2, &#39;b&#39;, 2
</a> 
 # Other types error, except NULL which is equivalent to false.
 !&gt; DELETE FROM name WHERE 0
<a href="#h45-5" id="h45-5" class="h">@@ -83,16 +83,16 @@ Error: invalid input: filter returned 0, expected boolean
</a> Error: invalid input: filter returned 1, expected boolean
 Error: invalid input: filter returned 3.14, expected boolean
 Error: invalid input: filter returned NaN, expected boolean
<a href="#h45-5-3" id="h45-5-3" class="d">-Error: invalid input: filter returned , expected boolean
</a><a href="#h45-5-4" id="h45-5-4" class="d">-Error: invalid input: filter returned true, expected boolean
</a><a href="#h45-5-5" id="h45-5-5" class="i">+Error: invalid input: filter returned &#39;&#39;, expected boolean
</a><a href="#h45-5-6" id="h45-5-6" class="i">+Error: invalid input: filter returned &#39;true&#39;, expected boolean
</a> 
 &gt; DELETE FROM name WHERE NULL
 &gt; SELECT * FROM name
 ---
 0, NULL, NULL
<a href="#h45-5-12" id="h45-5-12" class="d">-1, a, 1
</a><a href="#h45-5-13" id="h45-5-13" class="d">-2, b, 2
</a><a href="#h45-5-14" id="h45-5-14" class="d">-3, c, 3
</a><a href="#h45-5-15" id="h45-5-15" class="i">+1, &#39;a&#39;, 1
</a><a href="#h45-5-16" id="h45-5-16" class="i">+2, &#39;b&#39;, 2
</a><a href="#h45-5-17" id="h45-5-17" class="i">+3, &#39;c&#39;, 3
</a> 
 # Bare WHERE errors.
 !&gt; DELETE FROM name WHERE
<b>diff --git a/<a id="h46" href="../file/src/sql/testscripts/writes/insert.html">src/sql/testscripts/writes/insert</a> b/<a href="../file/src/sql/testscripts/writes/insert.html">src/sql/testscripts/writes/insert</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -8,12 +8,12 @@ ok
</a> [plan,result,ops]&gt; INSERT INTO name VALUES (1, &#39;a&#39;)
 ---
 Insert: name
<a href="#h46-0-3" id="h46-0-3" class="d">-└─ Values: 1, a
</a><a href="#h46-0-4" id="h46-0-4" class="i">+└─ Values: 1, &#39;a&#39;
</a> Insert { count: 1 }
 storage set mvcc:NextVersion → 3 [&quot;\x00&quot; → &quot;\x03&quot;]
 storage set mvcc:TxnActive(2) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(2, sql:Row(name, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h46-0-9" id="h46-0-9" class="d">-storage set mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h46-0-10" id="h46-0-10" class="i">+storage set mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a> storage delete mvcc:TxnWrite(2, sql:Row(name, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(2) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot;]
 
<a href="#h46-1" id="h46-1" class="h">@@ -26,11 +26,11 @@ Insert { count: 3 }
</a> storage set mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
 storage set mvcc:TxnActive(3) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(3, sql:Row(name, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h46-1-3" id="h46-1-3" class="d">-storage set mvcc:Version(sql:Row(name, 2), 3) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h46-1-4" id="h46-1-4" class="i">+storage set mvcc:Version(sql:Row(name, 2), 3) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a> storage set mvcc:TxnWrite(3, sql:Row(name, 3)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot; → &quot;&quot;]
<a href="#h46-1-6" id="h46-1-6" class="d">-storage set mvcc:Version(sql:Row(name, 3), 3) → 3,&quot;c&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x06\x04\x01c&quot;]
</a><a href="#h46-1-7" id="h46-1-7" class="i">+storage set mvcc:Version(sql:Row(name, 3), 3) → 3,&#39;c&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x06\x04\x01c&quot;]
</a> storage set mvcc:TxnWrite(3, sql:Row(name, 4)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00&quot; → &quot;&quot;]
<a href="#h46-1-9" id="h46-1-9" class="d">-storage set mvcc:Version(sql:Row(name, 4), 3) → 4,&quot;d&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x08\x04\x01d&quot;]
</a><a href="#h46-1-10" id="h46-1-10" class="i">+storage set mvcc:Version(sql:Row(name, 4), 3) → 4,&#39;d&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x08\x04\x01d&quot;]
</a> storage delete mvcc:TxnWrite(3, sql:Row(name, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Row(name, 3)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Row(name, 4)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00&quot;]
<a href="#h46-2" id="h46-2" class="h">@@ -38,29 +38,29 @@ storage delete mvcc:TxnActive(3) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
</a> 
 &gt; SELECT * FROM name
 ---
<a href="#h46-2-3" id="h46-2-3" class="d">-1, a
</a><a href="#h46-2-4" id="h46-2-4" class="d">-2, b
</a><a href="#h46-2-5" id="h46-2-5" class="d">-3, c
</a><a href="#h46-2-6" id="h46-2-6" class="d">-4, d
</a><a href="#h46-2-7" id="h46-2-7" class="i">+1, &#39;a&#39;
</a><a href="#h46-2-8" id="h46-2-8" class="i">+2, &#39;b&#39;
</a><a href="#h46-2-9" id="h46-2-9" class="i">+3, &#39;c&#39;
</a><a href="#h46-2-10" id="h46-2-10" class="i">+4, &#39;d&#39;
</a> 
 dump
 ---
 mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
 mvcc:Version(sql:Table(name), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
<a href="#h46-2-16" id="h46-2-16" class="d">-mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h46-2-17" id="h46-2-17" class="d">-mvcc:Version(sql:Row(name, 2), 3) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h46-2-18" id="h46-2-18" class="d">-mvcc:Version(sql:Row(name, 3), 3) → 3,&quot;c&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x06\x04\x01c&quot;]
</a><a href="#h46-2-19" id="h46-2-19" class="d">-mvcc:Version(sql:Row(name, 4), 3) → 4,&quot;d&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x08\x04\x01d&quot;]
</a><a href="#h46-2-20" id="h46-2-20" class="i">+mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h46-2-21" id="h46-2-21" class="i">+mvcc:Version(sql:Row(name, 2), 3) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h46-2-22" id="h46-2-22" class="i">+mvcc:Version(sql:Row(name, 3), 3) → 3,&#39;c&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x06\x04\x01c&quot;]
</a><a href="#h46-2-23" id="h46-2-23" class="i">+mvcc:Version(sql:Row(name, 4), 3) → 4,&#39;d&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x06\x02\x02\x08\x04\x01d&quot;]
</a> 
 # INSERTs can use expressions, but only constant ones.
 &gt; INSERT INTO name VALUES (2^2+1, &#39;abc&#39;)
 &gt; SELECT * FROM name
 ---
<a href="#h46-2-29" id="h46-2-29" class="d">-1, a
</a><a href="#h46-2-30" id="h46-2-30" class="d">-2, b
</a><a href="#h46-2-31" id="h46-2-31" class="d">-3, c
</a><a href="#h46-2-32" id="h46-2-32" class="d">-4, d
</a><a href="#h46-2-33" id="h46-2-33" class="d">-5, abc
</a><a href="#h46-2-34" id="h46-2-34" class="i">+1, &#39;a&#39;
</a><a href="#h46-2-35" id="h46-2-35" class="i">+2, &#39;b&#39;
</a><a href="#h46-2-36" id="h46-2-36" class="i">+3, &#39;c&#39;
</a><a href="#h46-2-37" id="h46-2-37" class="i">+4, &#39;d&#39;
</a><a href="#h46-2-38" id="h46-2-38" class="i">+5, &#39;abc&#39;
</a> 
 !&gt; INSERT INTO name VALUES (id + 2, &#39;abc&#39;)
 ---
<b>diff --git a/<a id="h47" href="../file/src/sql/testscripts/writes/insert_datatypes.html">src/sql/testscripts/writes/insert_datatypes</a> b/<a href="../file/src/sql/testscripts/writes/insert_datatypes.html">src/sql/testscripts/writes/insert_datatypes</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -115,10 +115,10 @@ ok
</a> &gt; SELECT * FROM datatypes
 &gt; ROLLBACK
 ---
<a href="#h47-0-3" id="h47-0-3" class="d">-1, NULL, NULL, NULL, 
</a><a href="#h47-0-4" id="h47-0-4" class="d">-2, NULL, NULL, NULL,   
</a><a href="#h47-0-5" id="h47-0-5" class="d">-3, NULL, NULL, NULL, abc
</a><a href="#h47-0-6" id="h47-0-6" class="d">-4, NULL, NULL, NULL, Hi! 👋
</a><a href="#h47-0-7" id="h47-0-7" class="i">+1, NULL, NULL, NULL, &#39;&#39;
</a><a href="#h47-0-8" id="h47-0-8" class="i">+2, NULL, NULL, NULL, &#39;  &#39;
</a><a href="#h47-0-9" id="h47-0-9" class="i">+3, NULL, NULL, NULL, &#39;abc&#39;
</a><a href="#h47-0-10" id="h47-0-10" class="i">+4, NULL, NULL, NULL, &#39;Hi! 👋&#39;
</a> 5, NULL, NULL, NULL, NULL
 
 !&gt; INSERT INTO datatypes (id, &quot;string&quot;) VALUES (0, false)
<b>diff --git a/<a id="h48" href="../file/src/sql/testscripts/writes/insert_default.html">src/sql/testscripts/writes/insert_default</a> b/<a href="../file/src/sql/testscripts/writes/insert_default.html">src/sql/testscripts/writes/insert_default</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -20,8 +20,8 @@ ok
</a> 
 &gt; SELECT * FROM defaults
 ---
<a href="#h48-0-3" id="h48-0-3" class="d">-1, TRUE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-0-4" id="h48-0-4" class="d">-2, FALSE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-0-5" id="h48-0-5" class="i">+1, TRUE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-0-6" id="h48-0-6" class="i">+2, FALSE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a> 
 # INSERT only specifying some default columns fills in rest.
 &gt; INSERT INTO defaults (&quot;integer&quot;, id, &quot;null&quot;, required) VALUES (9, 3, NULL, false)
<a href="#h48-1" id="h48-1" class="h">@@ -30,9 +30,9 @@ ok
</a> 
 &gt; SELECT * FROM defaults
 ---
<a href="#h48-1-3" id="h48-1-3" class="d">-1, TRUE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-1-4" id="h48-1-4" class="d">-2, FALSE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-1-5" id="h48-1-5" class="d">-3, FALSE, NULL, TRUE, 3.14, 9, foo
</a><a href="#h48-1-6" id="h48-1-6" class="i">+1, TRUE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-1-7" id="h48-1-7" class="i">+2, FALSE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-1-8" id="h48-1-8" class="i">+3, FALSE, NULL, TRUE, 3.14, 9, &#39;foo&#39;
</a> 
 # Using a variable number of values works.
 &gt; INSERT INTO defaults VALUES (4, false, NULL, false), (5, true), (6, true, false, true, 3.14, 9, &#39;bar&#39;)
<a href="#h48-2" id="h48-2" class="h">@@ -41,12 +41,12 @@ ok
</a> 
 &gt; SELECT * FROM defaults
 ---
<a href="#h48-2-3" id="h48-2-3" class="d">-1, TRUE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-2-4" id="h48-2-4" class="d">-2, FALSE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-2-5" id="h48-2-5" class="d">-3, FALSE, NULL, TRUE, 3.14, 9, foo
</a><a href="#h48-2-6" id="h48-2-6" class="d">-4, FALSE, NULL, FALSE, 3.14, 7, foo
</a><a href="#h48-2-7" id="h48-2-7" class="d">-5, TRUE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-2-8" id="h48-2-8" class="d">-6, TRUE, FALSE, TRUE, 3.14, 9, bar
</a><a href="#h48-2-9" id="h48-2-9" class="i">+1, TRUE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-2-10" id="h48-2-10" class="i">+2, FALSE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-2-11" id="h48-2-11" class="i">+3, FALSE, NULL, TRUE, 3.14, 9, &#39;foo&#39;
</a><a href="#h48-2-12" id="h48-2-12" class="i">+4, FALSE, NULL, FALSE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-2-13" id="h48-2-13" class="i">+5, TRUE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-2-14" id="h48-2-14" class="i">+6, TRUE, FALSE, TRUE, 3.14, 9, &#39;bar&#39;
</a> 
 # INSERT with all NULLs does not yield default values.
 &gt; INSERT INTO defaults VALUES (7, false, NULL, NULL, NULL, NULL, NULL)
<a href="#h48-3" id="h48-3" class="h">@@ -55,12 +55,12 @@ ok
</a> 
 &gt; SELECT * FROM defaults
 ---
<a href="#h48-3-3" id="h48-3-3" class="d">-1, TRUE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-3-4" id="h48-3-4" class="d">-2, FALSE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-3-5" id="h48-3-5" class="d">-3, FALSE, NULL, TRUE, 3.14, 9, foo
</a><a href="#h48-3-6" id="h48-3-6" class="d">-4, FALSE, NULL, FALSE, 3.14, 7, foo
</a><a href="#h48-3-7" id="h48-3-7" class="d">-5, TRUE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h48-3-8" id="h48-3-8" class="d">-6, TRUE, FALSE, TRUE, 3.14, 9, bar
</a><a href="#h48-3-9" id="h48-3-9" class="i">+1, TRUE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-3-10" id="h48-3-10" class="i">+2, FALSE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-3-11" id="h48-3-11" class="i">+3, FALSE, NULL, TRUE, 3.14, 9, &#39;foo&#39;
</a><a href="#h48-3-12" id="h48-3-12" class="i">+4, FALSE, NULL, FALSE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-3-13" id="h48-3-13" class="i">+5, TRUE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a><a href="#h48-3-14" id="h48-3-14" class="i">+6, TRUE, FALSE, TRUE, 3.14, 9, &#39;bar&#39;
</a> 7, FALSE, NULL, NULL, NULL, NULL, NULL
 
 # Errors if required column isn&#39;t given.
<b>diff --git a/<a id="h49" href="../file/src/sql/testscripts/writes/insert_index.html">src/sql/testscripts/writes/insert_index</a> b/<a href="../file/src/sql/testscripts/writes/insert_index.html">src/sql/testscripts/writes/insert_index</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -16,19 +16,19 @@ ok
</a> storage set mvcc:NextVersion → 3 [&quot;\x00&quot; → &quot;\x03&quot;]
 storage set mvcc:TxnActive(2) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(2, sql:Row(index, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h49-0-3" id="h49-0-3" class="d">-storage set mvcc:Version(sql:Row(index, 1), 2) → 1,TRUE,7,3.14,&quot;foo&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a><a href="#h49-0-4" id="h49-0-4" class="i">+storage set mvcc:Version(sql:Row(index, 1), 2) → 1,TRUE,7,3.14,&#39;foo&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a> storage set mvcc:TxnWrite(2, sql:Index(index.bool, TRUE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, TRUE), 2) → 1 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(2, sql:Index(index.int, 7)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, 7), 2) → 1 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(2, sql:Index(index.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, 3.14), 2) → 1 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
<a href="#h49-0-11" id="h49-0-11" class="d">-storage set mvcc:TxnWrite(2, sql:Index(index.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-0-12" id="h49-0-12" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;foo&quot;), 2) → 1 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h49-0-13" id="h49-0-13" class="i">+storage set mvcc:TxnWrite(2, sql:Index(index.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-0-14" id="h49-0-14" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;foo&#39;), 2) → 1 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a> storage delete mvcc:TxnWrite(2, sql:Index(index.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(2, sql:Index(index.float, 3.14)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot;]
 storage delete mvcc:TxnWrite(2, sql:Index(index.int, 7)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot;]
<a href="#h49-0-18" id="h49-0-18" class="d">-storage delete mvcc:TxnWrite(2, sql:Index(index.string, &quot;foo&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h49-0-19" id="h49-0-19" class="i">+storage delete mvcc:TxnWrite(2, sql:Index(index.string, &#39;foo&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(2, sql:Row(index, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(2) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot;]
 
<a href="#h49-1" id="h49-1" class="h">@@ -38,19 +38,19 @@ storage delete mvcc:TxnActive(2) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot;]
</a> storage set mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
 storage set mvcc:TxnActive(3) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(3, sql:Row(index, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h49-1-3" id="h49-1-3" class="d">-storage set mvcc:Version(sql:Row(index, 2), 3) → 2,TRUE,7,3.14,&quot;foo&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x15\x05\x02\x04\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a><a href="#h49-1-4" id="h49-1-4" class="i">+storage set mvcc:Version(sql:Row(index, 2), 3) → 2,TRUE,7,3.14,&#39;foo&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x15\x05\x02\x04\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a> storage set mvcc:TxnWrite(3, sql:Index(index.bool, TRUE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, TRUE), 3) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
 storage set mvcc:TxnWrite(3, sql:Index(index.int, 7)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, 7), 3) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
 storage set mvcc:TxnWrite(3, sql:Index(index.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, 3.14), 3) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
<a href="#h49-1-11" id="h49-1-11" class="d">-storage set mvcc:TxnWrite(3, sql:Index(index.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-1-12" id="h49-1-12" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;foo&quot;), 3) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
</a><a href="#h49-1-13" id="h49-1-13" class="i">+storage set mvcc:TxnWrite(3, sql:Index(index.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-1-14" id="h49-1-14" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;foo&#39;), 3) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
</a> storage delete mvcc:TxnWrite(3, sql:Index(index.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Index(index.float, 3.14)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Index(index.int, 7)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot;]
<a href="#h49-1-18" id="h49-1-18" class="d">-storage delete mvcc:TxnWrite(3, sql:Index(index.string, &quot;foo&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h49-1-19" id="h49-1-19" class="i">+storage delete mvcc:TxnWrite(3, sql:Index(index.string, &#39;foo&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(3, sql:Row(index, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnActive(3) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
 
<a href="#h49-2" id="h49-2" class="h">@@ -60,19 +60,19 @@ storage delete mvcc:TxnActive(3) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
</a> storage set mvcc:NextVersion → 5 [&quot;\x00&quot; → &quot;\x05&quot;]
 storage set mvcc:TxnActive(4) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(4, sql:Row(index, 3)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot; → &quot;&quot;]
<a href="#h49-2-3" id="h49-2-3" class="d">-storage set mvcc:Version(sql:Row(index, 3), 4) → 3,FALSE,0,2.718,&quot;&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x12\x05\x02\x06\x01\x00\x02\x00\x03X9\xb4\xc8v\xbe\x05@\x04\x00&quot;]
</a><a href="#h49-2-4" id="h49-2-4" class="i">+storage set mvcc:Version(sql:Row(index, 3), 4) → 3,FALSE,0,2.718,&#39;&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x12\x05\x02\x06\x01\x00\x02\x00\x03X9\xb4\xc8v\xbe\x05@\x04\x00&quot;]
</a> storage set mvcc:TxnWrite(4, sql:Index(index.bool, FALSE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, FALSE), 4) → 3 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 storage set mvcc:TxnWrite(4, sql:Index(index.int, 0)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, 0), 4) → 3 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 storage set mvcc:TxnWrite(4, sql:Index(index.float, 2.718)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, 2.718), 4) → 3 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
<a href="#h49-2-11" id="h49-2-11" class="d">-storage set mvcc:TxnWrite(4, sql:Index(index.string, &quot;&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-2-12" id="h49-2-12" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;&quot;), 4) → 3 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a><a href="#h49-2-13" id="h49-2-13" class="i">+storage set mvcc:TxnWrite(4, sql:Index(index.string, &#39;&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-2-14" id="h49-2-14" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;&#39;), 4) → 3 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a> storage delete mvcc:TxnWrite(4, sql:Index(index.bool, FALSE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(4, sql:Index(index.float, 2.718)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00&quot;]
 storage delete mvcc:TxnWrite(4, sql:Index(index.int, 0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h49-2-18" id="h49-2-18" class="d">-storage delete mvcc:TxnWrite(4, sql:Index(index.string, &quot;&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h49-2-19" id="h49-2-19" class="i">+storage delete mvcc:TxnWrite(4, sql:Index(index.string, &#39;&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(4, sql:Row(index, 3)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot;]
 storage delete mvcc:TxnActive(4) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x04&quot;]
 
<a href="#h49-3" id="h49-3" class="h">@@ -248,29 +248,29 @@ storage delete mvcc:TxnActive(9) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\t&quot;]
</a> storage set mvcc:NextVersion → 11 [&quot;\x00&quot; → &quot;\x0b&quot;]
 storage set mvcc:TxnActive(10) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(10, sql:Row(index, 14)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0e\x00\x00&quot; → &quot;&quot;]
<a href="#h49-3-3" id="h49-3-3" class="d">-storage set mvcc:Version(sql:Row(index, 14), 10) → 14,NULL,NULL,NULL,&quot;&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x08\x05\x02\x1c\x00\x00\x00\x04\x00&quot;]
</a><a href="#h49-3-4" id="h49-3-4" class="i">+storage set mvcc:Version(sql:Row(index, 14), 10) → 14,NULL,NULL,NULL,&#39;&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x08\x05\x02\x1c\x00\x00\x00\x04\x00&quot;]
</a> storage set mvcc:TxnWrite(10, sql:Index(index.bool, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, NULL), 10) → 4,5,6,7,8,9,10,11,12,13,14 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x17\x0b\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1a\x02\x1c&quot;]
 storage set mvcc:TxnWrite(10, sql:Index(index.int, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, NULL), 10) → 4,5,6,7,8,9,10,11,12,13,14 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x17\x0b\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1a\x02\x1c&quot;]
 storage set mvcc:TxnWrite(10, sql:Index(index.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, NULL), 10) → 4,5,14 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x07\x03\x02\x08\x02\n\x02\x1c&quot;]
<a href="#h49-3-11" id="h49-3-11" class="d">-storage set mvcc:TxnWrite(10, sql:Index(index.string, &quot;&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-3-12" id="h49-3-12" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;&quot;), 10) → 3,14 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x05\x02\x02\x06\x02\x1c&quot;]
</a><a href="#h49-3-13" id="h49-3-13" class="i">+storage set mvcc:TxnWrite(10, sql:Index(index.string, &#39;&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-3-14" id="h49-3-14" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;&#39;), 10) → 3,14 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x05\x02\x02\x06\x02\x1c&quot;]
</a> storage set mvcc:TxnWrite(10, sql:Row(index, 15)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0f\x00\x00&quot; → &quot;&quot;]
<a href="#h49-3-16" id="h49-3-16" class="d">-storage set mvcc:Version(sql:Row(index, 15), 10) → 15,NULL,NULL,NULL,&quot;&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x08\x05\x02\x1e\x00\x00\x00\x04\x00&quot;]
</a><a href="#h49-3-17" id="h49-3-17" class="i">+storage set mvcc:Version(sql:Row(index, 15), 10) → 15,NULL,NULL,NULL,&#39;&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x08\x05\x02\x1e\x00\x00\x00\x04\x00&quot;]
</a> storage set mvcc:TxnWrite(10, sql:Index(index.bool, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, NULL), 10) → 4,5,6,7,8,9,10,11,12,13,14,15 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x19\x0c\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1a\x02\x1c\x02\x1e&quot;]
 storage set mvcc:TxnWrite(10, sql:Index(index.int, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, NULL), 10) → 4,5,6,7,8,9,10,11,12,13,14,15 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x19\x0c\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1a\x02\x1c\x02\x1e&quot;]
 storage set mvcc:TxnWrite(10, sql:Index(index.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, NULL), 10) → 4,5,14,15 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\t\x04\x02\x08\x02\n\x02\x1c\x02\x1e&quot;]
<a href="#h49-3-24" id="h49-3-24" class="d">-storage set mvcc:TxnWrite(10, sql:Index(index.string, &quot;&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-3-25" id="h49-3-25" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;&quot;), 10) → 3,14,15 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x07\x03\x02\x06\x02\x1c\x02\x1e&quot;]
</a><a href="#h49-3-26" id="h49-3-26" class="i">+storage set mvcc:TxnWrite(10, sql:Index(index.string, &#39;&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-3-27" id="h49-3-27" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;&#39;), 10) → 3,14,15 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x07\x03\x02\x06\x02\x1c\x02\x1e&quot;]
</a> storage delete mvcc:TxnWrite(10, sql:Index(index.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(10, sql:Index(index.float, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(10, sql:Index(index.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h49-3-31" id="h49-3-31" class="d">-storage delete mvcc:TxnWrite(10, sql:Index(index.string, &quot;&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h49-3-32" id="h49-3-32" class="i">+storage delete mvcc:TxnWrite(10, sql:Index(index.string, &#39;&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(10, sql:Row(index, 14)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0e\x00\x00&quot;]
 storage delete mvcc:TxnWrite(10, sql:Row(index, 15)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0f\x00\x00&quot;]
 storage delete mvcc:TxnActive(10) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\n&quot;]
<a href="#h49-4" id="h49-4" class="h">@@ -281,30 +281,30 @@ storage delete mvcc:TxnActive(10) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\n&quot;]
</a> storage set mvcc:NextVersion → 12 [&quot;\x00&quot; → &quot;\x0c&quot;]
 storage set mvcc:TxnActive(11) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(11, sql:Row(index, 16)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x10\x00\x00&quot; → &quot;&quot;]
<a href="#h49-4-3" id="h49-4-3" class="d">-storage set mvcc:Version(sql:Row(index, 16), 11) → 16,NULL,NULL,NULL,&quot;case&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x0c\x05\x02 \x00\x00\x00\x04\x04case&quot;]
</a><a href="#h49-4-4" id="h49-4-4" class="i">+storage set mvcc:Version(sql:Row(index, 16), 11) → 16,NULL,NULL,NULL,&#39;case&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x0c\x05\x02 \x00\x00\x00\x04\x04case&quot;]
</a> storage set mvcc:TxnWrite(11, sql:Index(index.bool, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, NULL), 11) → 4,5,6,7,8,9,10,11,12,13,14,15,16 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x1b\r\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1a\x02\x1c\x02\x1e\x02 &quot;]
 storage set mvcc:TxnWrite(11, sql:Index(index.int, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, NULL), 11) → 4,5,6,7,8,9,10,11,12,13,14,15,16 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x1b\r\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1a\x02\x1c\x02\x1e\x02 &quot;]
 storage set mvcc:TxnWrite(11, sql:Index(index.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, NULL), 11) → 4,5,14,15,16 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x0b\x05\x02\x08\x02\n\x02\x1c\x02\x1e\x02 &quot;]
<a href="#h49-4-11" id="h49-4-11" class="d">-storage set mvcc:TxnWrite(11, sql:Index(index.string, &quot;case&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-4-12" id="h49-4-12" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;case&quot;), 11) → 16 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x03\x01\x02 &quot;]
</a><a href="#h49-4-13" id="h49-4-13" class="i">+storage set mvcc:TxnWrite(11, sql:Index(index.string, &#39;case&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-4-14" id="h49-4-14" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;case&#39;), 11) → 16 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x03\x01\x02 &quot;]
</a> storage set mvcc:TxnWrite(11, sql:Row(index, 17)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x11\x00\x00&quot; → &quot;&quot;]
<a href="#h49-4-16" id="h49-4-16" class="d">-storage set mvcc:Version(sql:Row(index, 17), 11) → 17,NULL,NULL,NULL,&quot;CaSe&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x0c\x05\x02\&quot;\x00\x00\x00\x04\x04CaSe&quot;]
</a><a href="#h49-4-17" id="h49-4-17" class="i">+storage set mvcc:Version(sql:Row(index, 17), 11) → 17,NULL,NULL,NULL,&#39;CaSe&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x0c\x05\x02\&quot;\x00\x00\x00\x04\x04CaSe&quot;]
</a> storage set mvcc:TxnWrite(11, sql:Index(index.bool, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, NULL), 11) → 4,5,6,7,8,9,10,11,12,13,14,15,16,17 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x1d\x0e\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1a\x02\x1c\x02\x1e\x02 \x02\&quot;&quot;]
 storage set mvcc:TxnWrite(11, sql:Index(index.int, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, NULL), 11) → 4,5,6,7,8,9,10,11,12,13,14,15,16,17 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x1d\x0e\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12\x02\x14\x02\x16\x02\x18\x02\x1a\x02\x1c\x02\x1e\x02 \x02\&quot;&quot;]
 storage set mvcc:TxnWrite(11, sql:Index(index.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, NULL), 11) → 4,5,14,15,16,17 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\r\x06\x02\x08\x02\n\x02\x1c\x02\x1e\x02 \x02\&quot;&quot;]
<a href="#h49-4-24" id="h49-4-24" class="d">-storage set mvcc:TxnWrite(11, sql:Index(index.string, &quot;CaSe&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-4-25" id="h49-4-25" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;CaSe&quot;), 11) → 17 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x03\x01\x02\&quot;&quot;]
</a><a href="#h49-4-26" id="h49-4-26" class="i">+storage set mvcc:TxnWrite(11, sql:Index(index.string, &#39;CaSe&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h49-4-27" id="h49-4-27" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;CaSe&#39;), 11) → 17 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x03\x01\x02\&quot;&quot;]
</a> storage delete mvcc:TxnWrite(11, sql:Index(index.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(11, sql:Index(index.float, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(11, sql:Index(index.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h49-4-31" id="h49-4-31" class="d">-storage delete mvcc:TxnWrite(11, sql:Index(index.string, &quot;CaSe&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h49-4-32" id="h49-4-32" class="d">-storage delete mvcc:TxnWrite(11, sql:Index(index.string, &quot;case&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h49-4-33" id="h49-4-33" class="i">+storage delete mvcc:TxnWrite(11, sql:Index(index.string, &#39;CaSe&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h49-4-34" id="h49-4-34" class="i">+storage delete mvcc:TxnWrite(11, sql:Index(index.string, &#39;case&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(11, sql:Row(index, 16)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x10\x00\x00&quot;]
 storage delete mvcc:TxnWrite(11, sql:Row(index, 17)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x11\x00\x00&quot;]
 storage delete mvcc:TxnActive(11) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0b&quot;]
<b>diff --git a/<a id="h50" href="../file/src/sql/testscripts/writes/insert_null.html">src/sql/testscripts/writes/insert_null</a> b/<a href="../file/src/sql/testscripts/writes/insert_null.html">src/sql/testscripts/writes/insert_null</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -16,7 +16,7 @@ ok
</a> 
 &gt; SELECT * FROM name
 ---
<a href="#h50-0-3" id="h50-0-3" class="d">-1, NULL, foo
</a><a href="#h50-0-4" id="h50-0-4" class="i">+1, NULL, &#39;foo&#39;
</a> 
 # INSERT with NULL into non-NULL columns errors.
 !&gt; INSERT INTO name VALUES (NULL, &#39;foo&#39;, &#39;bar&#39;)
<a href="#h50-1" id="h50-1" class="h">@@ -32,5 +32,5 @@ ok
</a> 
 &gt; SELECT * FROM name
 ---
<a href="#h50-1-3" id="h50-1-3" class="d">-1, NULL, foo
</a><a href="#h50-1-4" id="h50-1-4" class="d">-2, NULL, foo
</a><a href="#h50-1-5" id="h50-1-5" class="i">+1, NULL, &#39;foo&#39;
</a><a href="#h50-1-6" id="h50-1-6" class="i">+2, NULL, &#39;foo&#39;
</a><b>diff --git a/<a id="h51" href="../file/src/sql/testscripts/writes/insert_primary_key.html">src/sql/testscripts/writes/insert_primary_key</a> b/<a href="../file/src/sql/testscripts/writes/insert_primary_key.html">src/sql/testscripts/writes/insert_primary_key</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -96,11 +96,11 @@ Error: invalid input: invalid primary key NULL
</a> &gt; INSERT INTO &quot;string&quot; VALUES (&#39;Hi! 👋&#39;)
 &gt; SELECT * FROM &quot;string&quot;;
 ---
<a href="#h51-0-3" id="h51-0-3" class="d">-&gt; 
</a><a href="#h51-0-4" id="h51-0-4" class="d">-&gt;   
</a><a href="#h51-0-5" id="h51-0-5" class="d">-&gt; ABC
</a><a href="#h51-0-6" id="h51-0-6" class="d">-&gt; Hi! 👋
</a><a href="#h51-0-7" id="h51-0-7" class="d">-&gt; abc
</a><a href="#h51-0-8" id="h51-0-8" class="i">+&#39;&#39;
</a><a href="#h51-0-9" id="h51-0-9" class="i">+&#39;  &#39;
</a><a href="#h51-0-10" id="h51-0-10" class="i">+&#39;ABC&#39;
</a><a href="#h51-0-11" id="h51-0-11" class="i">+&#39;Hi! 👋&#39;
</a><a href="#h51-0-12" id="h51-0-12" class="i">+&#39;abc&#39;
</a> 
 !&gt; INSERT INTO &quot;string&quot; VALUES (&#39;&#39;)
 !&gt; INSERT INTO &quot;string&quot; VALUES (&#39;  &#39;)
<a href="#h51-1" id="h51-1" class="h">@@ -109,9 +109,9 @@ Error: invalid input: invalid primary key NULL
</a> !&gt; INSERT INTO &quot;string&quot; VALUES (&#39;Hi! 👋&#39;)
 !&gt; INSERT INTO &quot;string&quot; VALUES (NULL)
 ---
<a href="#h51-1-3" id="h51-1-3" class="d">-Error: invalid input: primary key  already exists
</a><a href="#h51-1-4" id="h51-1-4" class="d">-Error: invalid input: primary key    already exists
</a><a href="#h51-1-5" id="h51-1-5" class="d">-Error: invalid input: primary key abc already exists
</a><a href="#h51-1-6" id="h51-1-6" class="d">-Error: invalid input: primary key ABC already exists
</a><a href="#h51-1-7" id="h51-1-7" class="d">-Error: invalid input: primary key Hi! 👋 already exists
</a><a href="#h51-1-8" id="h51-1-8" class="i">+Error: invalid input: primary key &#39;&#39; already exists
</a><a href="#h51-1-9" id="h51-1-9" class="i">+Error: invalid input: primary key &#39;  &#39; already exists
</a><a href="#h51-1-10" id="h51-1-10" class="i">+Error: invalid input: primary key &#39;abc&#39; already exists
</a><a href="#h51-1-11" id="h51-1-11" class="i">+Error: invalid input: primary key &#39;ABC&#39; already exists
</a><a href="#h51-1-12" id="h51-1-12" class="i">+Error: invalid input: primary key &#39;Hi! 👋&#39; already exists
</a> Error: invalid input: invalid primary key NULL
<b>diff --git a/<a id="h52" href="../file/src/sql/testscripts/writes/insert_reference.html">src/sql/testscripts/writes/insert_reference</a> b/<a href="../file/src/sql/testscripts/writes/insert_reference.html">src/sql/testscripts/writes/insert_reference</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -29,19 +29,19 @@ ok
</a> storage set mvcc:NextVersion → 11 [&quot;\x00&quot; → &quot;\x0b&quot;]
 storage set mvcc:TxnActive(10) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(10, sql:Row(name, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h52-0-3" id="h52-0-3" class="d">-storage set mvcc:Version(sql:Row(name, 1), 10) → 1,TRUE,1,3.14,&quot;foo&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x02\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a><a href="#h52-0-4" id="h52-0-4" class="i">+storage set mvcc:Version(sql:Row(name, 1), 10) → 1,TRUE,1,3.14,&#39;foo&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x02\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a> storage set mvcc:TxnWrite(10, sql:Index(name.bool, TRUE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.bool, TRUE), 10) → 1 [&quot;\x04\x01name\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(10, sql:Index(name.int, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.int, 1), 10) → 1 [&quot;\x04\x01name\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(10, sql:Index(name.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.float, 3.14), 10) → 1 [&quot;\x04\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
<a href="#h52-0-11" id="h52-0-11" class="d">-storage set mvcc:TxnWrite(10, sql:Index(name.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h52-0-12" id="h52-0-12" class="d">-storage set mvcc:Version(sql:Index(name.string, &quot;foo&quot;), 10) → 1 [&quot;\x04\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h52-0-13" id="h52-0-13" class="i">+storage set mvcc:TxnWrite(10, sql:Index(name.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h52-0-14" id="h52-0-14" class="i">+storage set mvcc:Version(sql:Index(name.string, &#39;foo&#39;), 10) → 1 [&quot;\x04\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\n&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a> storage delete mvcc:TxnWrite(10, sql:Index(name.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(10, sql:Index(name.float, 3.14)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot;]
 storage delete mvcc:TxnWrite(10, sql:Index(name.int, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
<a href="#h52-0-18" id="h52-0-18" class="d">-storage delete mvcc:TxnWrite(10, sql:Index(name.string, &quot;foo&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h52-0-19" id="h52-0-19" class="i">+storage delete mvcc:TxnWrite(10, sql:Index(name.string, &#39;foo&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(10, sql:Row(name, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\n\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(10) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\n&quot;]
 
<a href="#h52-1" id="h52-1" class="h">@@ -54,7 +54,7 @@ storage delete mvcc:TxnActive(10) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\n&quot;]
</a> Error: invalid input: reference FALSE not in table bool
 Error: invalid input: reference 7 not in table int
 Error: invalid input: reference 2.718 not in table float
<a href="#h52-1-3" id="h52-1-3" class="d">-Error: invalid input: reference bar not in table string
</a><a href="#h52-1-4" id="h52-1-4" class="i">+Error: invalid input: reference &#39;bar&#39; not in table string
</a> 
 # -0.0 is equivalent to 0.0.
 [ops]&gt; INSERT INTO name (id, &quot;float&quot;) VALUES (2, -0.0)
<a href="#h52-2" id="h52-2" class="h">@@ -91,7 +91,7 @@ ok
</a> # References are case sensitive.
 !&gt; INSERT INTO name (id, &quot;string&quot;) VALUES (4, &#39;FOO&#39;)
 ---
<a href="#h52-2-3" id="h52-2-3" class="d">-Error: invalid input: reference FOO not in table string
</a><a href="#h52-2-4" id="h52-2-4" class="i">+Error: invalid input: reference &#39;FOO&#39; not in table string
</a> 
 # Empty strings are valid references.
 &gt; INSERT INTO name (id, &quot;string&quot;) VALUES (5, &#39;&#39;)
<a href="#h52-3" id="h52-3" class="h">@@ -105,10 +105,10 @@ ok
</a> 
 &gt; SELECT * FROM name
 ---
<a href="#h52-3-3" id="h52-3-3" class="d">-1, TRUE, 1, 3.14, foo
</a><a href="#h52-3-4" id="h52-3-4" class="i">+1, TRUE, 1, 3.14, &#39;foo&#39;
</a> 2, NULL, NULL, 0.0, NULL
 3, NULL, NULL, inf, NULL
<a href="#h52-3-7" id="h52-3-7" class="d">-5, NULL, NULL, NULL, 
</a><a href="#h52-3-8" id="h52-3-8" class="i">+5, NULL, NULL, NULL, &#39;&#39;
</a> 6, NULL, NULL, NULL, NULL
 
 # Self references are fine.
<b>diff --git a/<a id="h53" href="../file/src/sql/testscripts/writes/insert_unique.html">src/sql/testscripts/writes/insert_unique</a> b/<a href="../file/src/sql/testscripts/writes/insert_unique.html">src/sql/testscripts/writes/insert_unique</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -16,19 +16,19 @@ ok
</a> storage set mvcc:NextVersion → 3 [&quot;\x00&quot; → &quot;\x03&quot;]
 storage set mvcc:TxnActive(2) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(2, sql:Row(unique, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h53-0-3" id="h53-0-3" class="d">-storage set mvcc:Version(sql:Row(unique, 1), 2) → 1,TRUE,7,3.14,&quot;foo&quot; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a><a href="#h53-0-4" id="h53-0-4" class="i">+storage set mvcc:Version(sql:Row(unique, 1), 2) → 1,TRUE,7,3.14,&#39;foo&#39; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a> storage set mvcc:TxnWrite(2, sql:Index(unique.bool, TRUE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.bool, TRUE), 2) → 1 [&quot;\x04\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(2, sql:Index(unique.int, 7)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.int, 7), 2) → 1 [&quot;\x04\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(2, sql:Index(unique.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, 3.14), 2) → 1 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
<a href="#h53-0-11" id="h53-0-11" class="d">-storage set mvcc:TxnWrite(2, sql:Index(unique.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-0-12" id="h53-0-12" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;foo&quot;), 2) → 1 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h53-0-13" id="h53-0-13" class="i">+storage set mvcc:TxnWrite(2, sql:Index(unique.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-0-14" id="h53-0-14" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;foo&#39;), 2) → 1 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a> storage delete mvcc:TxnWrite(2, sql:Index(unique.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(2, sql:Index(unique.float, 3.14)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot;]
 storage delete mvcc:TxnWrite(2, sql:Index(unique.int, 7)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot;]
<a href="#h53-0-18" id="h53-0-18" class="d">-storage delete mvcc:TxnWrite(2, sql:Index(unique.string, &quot;foo&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h53-0-19" id="h53-0-19" class="i">+storage delete mvcc:TxnWrite(2, sql:Index(unique.string, &#39;foo&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(2, sql:Row(unique, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x02\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(2) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot;]
 
<a href="#h53-1" id="h53-1" class="h">@@ -41,7 +41,7 @@ storage delete mvcc:TxnActive(2) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x02&quot;]
</a> Error: invalid input: value TRUE already in unique column bool
 Error: invalid input: value 7 already in unique column int
 Error: invalid input: value 3.14 already in unique column float
<a href="#h53-1-3" id="h53-1-3" class="d">-Error: invalid input: value foo already in unique column string
</a><a href="#h53-1-4" id="h53-1-4" class="i">+Error: invalid input: value &#39;foo&#39; already in unique column string
</a> 
 # An insert with different values writes new index entries.
 [ops]&gt; INSERT INTO &quot;unique&quot; VALUES (3, FALSE, 0, 2.718, &#39;bar&#39;)
<a href="#h53-2" id="h53-2" class="h">@@ -49,19 +49,19 @@ Error: invalid input: value foo already in unique column string
</a> storage set mvcc:NextVersion → 8 [&quot;\x00&quot; → &quot;\x08&quot;]
 storage set mvcc:TxnActive(7) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(7, sql:Row(unique, 3)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot; → &quot;&quot;]
<a href="#h53-2-3" id="h53-2-3" class="d">-storage set mvcc:Version(sql:Row(unique, 3), 7) → 3,FALSE,0,2.718,&quot;bar&quot; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x15\x05\x02\x06\x01\x00\x02\x00\x03X9\xb4\xc8v\xbe\x05@\x04\x03bar&quot;]
</a><a href="#h53-2-4" id="h53-2-4" class="i">+storage set mvcc:Version(sql:Row(unique, 3), 7) → 3,FALSE,0,2.718,&#39;bar&#39; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x15\x05\x02\x06\x01\x00\x02\x00\x03X9\xb4\xc8v\xbe\x05@\x04\x03bar&quot;]
</a> storage set mvcc:TxnWrite(7, sql:Index(unique.bool, FALSE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.bool, FALSE), 7) → 3 [&quot;\x04\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 storage set mvcc:TxnWrite(7, sql:Index(unique.int, 0)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.int, 0), 7) → 3 [&quot;\x04\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
 storage set mvcc:TxnWrite(7, sql:Index(unique.float, 2.718)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, 2.718), 7) → 3 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
<a href="#h53-2-11" id="h53-2-11" class="d">-storage set mvcc:TxnWrite(7, sql:Index(unique.string, &quot;bar&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-2-12" id="h53-2-12" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;bar&quot;), 7) → 3 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a><a href="#h53-2-13" id="h53-2-13" class="i">+storage set mvcc:TxnWrite(7, sql:Index(unique.string, &#39;bar&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-2-14" id="h53-2-14" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;bar&#39;), 7) → 3 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x06&quot;]
</a> storage delete mvcc:TxnWrite(7, sql:Index(unique.bool, FALSE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(unique.float, 2.718)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(unique.int, 0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h53-2-18" id="h53-2-18" class="d">-storage delete mvcc:TxnWrite(7, sql:Index(unique.string, &quot;bar&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h53-2-19" id="h53-2-19" class="i">+storage delete mvcc:TxnWrite(7, sql:Index(unique.string, &#39;bar&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(7, sql:Row(unique, 3)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x03\x00\x00&quot;]
 storage delete mvcc:TxnActive(7) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x07&quot;]
 
<a href="#h53-3" id="h53-3" class="h">@@ -209,25 +209,25 @@ Error: invalid input: value inf already in unique column float
</a> storage set mvcc:NextVersion → 17 [&quot;\x00&quot; → &quot;\x11&quot;]
 storage set mvcc:TxnActive(16) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x10&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(16, sql:Row(unique, 11)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0b\x00\x00&quot; → &quot;&quot;]
<a href="#h53-3-3" id="h53-3-3" class="d">-storage set mvcc:Version(sql:Row(unique, 11), 16) → 11,NULL,NULL,NULL,&quot;&quot; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10&quot; → &quot;\x01\x08\x05\x02\x16\x00\x00\x00\x04\x00&quot;]
</a><a href="#h53-3-4" id="h53-3-4" class="i">+storage set mvcc:Version(sql:Row(unique, 11), 16) → 11,NULL,NULL,NULL,&#39;&#39; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10&quot; → &quot;\x01\x08\x05\x02\x16\x00\x00\x00\x04\x00&quot;]
</a> storage set mvcc:TxnWrite(16, sql:Index(unique.bool, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.bool, NULL), 16) → 4,5,6,7,8,10,11 [&quot;\x04\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10&quot; → &quot;\x01\x0f\x07\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x14\x02\x16&quot;]
 storage set mvcc:TxnWrite(16, sql:Index(unique.int, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.int, NULL), 16) → 4,5,6,7,8,10,11 [&quot;\x04\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10&quot; → &quot;\x01\x0f\x07\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x14\x02\x16&quot;]
 storage set mvcc:TxnWrite(16, sql:Index(unique.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, NULL), 16) → 4,5,11 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10&quot; → &quot;\x01\x07\x03\x02\x08\x02\n\x02\x16&quot;]
<a href="#h53-3-11" id="h53-3-11" class="d">-storage set mvcc:TxnWrite(16, sql:Index(unique.string, &quot;&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-3-12" id="h53-3-12" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;&quot;), 16) → 11 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10&quot; → &quot;\x01\x03\x01\x02\x16&quot;]
</a><a href="#h53-3-13" id="h53-3-13" class="i">+storage set mvcc:TxnWrite(16, sql:Index(unique.string, &#39;&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-3-14" id="h53-3-14" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;&#39;), 16) → 11 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10&quot; → &quot;\x01\x03\x01\x02\x16&quot;]
</a> storage delete mvcc:TxnWrite(16, sql:Index(unique.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(16, sql:Index(unique.float, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(16, sql:Index(unique.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h53-3-18" id="h53-3-18" class="d">-storage delete mvcc:TxnWrite(16, sql:Index(unique.string, &quot;&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h53-3-19" id="h53-3-19" class="i">+storage delete mvcc:TxnWrite(16, sql:Index(unique.string, &#39;&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(16, sql:Row(unique, 11)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x10\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0b\x00\x00&quot;]
 storage delete mvcc:TxnActive(16) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x10&quot;]
 
 !&gt; INSERT INTO &quot;unique&quot; (id, &quot;string&quot;) VALUES (12, &#39;&#39;)
 ---
<a href="#h53-3-25" id="h53-3-25" class="d">-Error: invalid input: value  already in unique column string
</a><a href="#h53-3-26" id="h53-3-26" class="i">+Error: invalid input: value &#39;&#39; already in unique column string
</a> 
 # Case differences are not considered equal.
 [ops]&gt; INSERT INTO &quot;unique&quot; (id, &quot;string&quot;) VALUES (12, &#39;case&#39;)
<a href="#h53-4" id="h53-4" class="h">@@ -235,19 +235,19 @@ Error: invalid input: value  already in unique column string
</a> storage set mvcc:NextVersion → 19 [&quot;\x00&quot; → &quot;\x13&quot;]
 storage set mvcc:TxnActive(18) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(18, sql:Row(unique, 12)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0c\x00\x00&quot; → &quot;&quot;]
<a href="#h53-4-3" id="h53-4-3" class="d">-storage set mvcc:Version(sql:Row(unique, 12), 18) → 12,NULL,NULL,NULL,&quot;case&quot; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;\x01\x0c\x05\x02\x18\x00\x00\x00\x04\x04case&quot;]
</a><a href="#h53-4-4" id="h53-4-4" class="i">+storage set mvcc:Version(sql:Row(unique, 12), 18) → 12,NULL,NULL,NULL,&#39;case&#39; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;\x01\x0c\x05\x02\x18\x00\x00\x00\x04\x04case&quot;]
</a> storage set mvcc:TxnWrite(18, sql:Index(unique.bool, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.bool, NULL), 18) → 4,5,6,7,8,10,11,12 [&quot;\x04\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;\x01\x11\x08\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x14\x02\x16\x02\x18&quot;]
 storage set mvcc:TxnWrite(18, sql:Index(unique.int, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.int, NULL), 18) → 4,5,6,7,8,10,11,12 [&quot;\x04\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;\x01\x11\x08\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x14\x02\x16\x02\x18&quot;]
 storage set mvcc:TxnWrite(18, sql:Index(unique.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, NULL), 18) → 4,5,11,12 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;\x01\t\x04\x02\x08\x02\n\x02\x16\x02\x18&quot;]
<a href="#h53-4-11" id="h53-4-11" class="d">-storage set mvcc:TxnWrite(18, sql:Index(unique.string, &quot;case&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-4-12" id="h53-4-12" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;case&quot;), 18) → 12 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;\x01\x03\x01\x02\x18&quot;]
</a><a href="#h53-4-13" id="h53-4-13" class="i">+storage set mvcc:TxnWrite(18, sql:Index(unique.string, &#39;case&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-4-14" id="h53-4-14" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;case&#39;), 18) → 12 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x12&quot; → &quot;\x01\x03\x01\x02\x18&quot;]
</a> storage delete mvcc:TxnWrite(18, sql:Index(unique.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(18, sql:Index(unique.float, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(18, sql:Index(unique.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h53-4-18" id="h53-4-18" class="d">-storage delete mvcc:TxnWrite(18, sql:Index(unique.string, &quot;case&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h53-4-19" id="h53-4-19" class="i">+storage delete mvcc:TxnWrite(18, sql:Index(unique.string, &#39;case&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(18, sql:Row(unique, 12)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x12\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x0c\x00\x00&quot;]
 storage delete mvcc:TxnActive(18) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x12&quot;]
 
<a href="#h53-5" id="h53-5" class="h">@@ -256,18 +256,18 @@ storage delete mvcc:TxnActive(18) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x12&quot;]
</a> storage set mvcc:NextVersion → 20 [&quot;\x00&quot; → &quot;\x14&quot;]
 storage set mvcc:TxnActive(19) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(19, sql:Row(unique, 13)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\r\x00\x00&quot; → &quot;&quot;]
<a href="#h53-5-3" id="h53-5-3" class="d">-storage set mvcc:Version(sql:Row(unique, 13), 19) → 13,NULL,NULL,NULL,&quot;CaSe&quot; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\r\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x0c\x05\x02\x1a\x00\x00\x00\x04\x04CaSe&quot;]
</a><a href="#h53-5-4" id="h53-5-4" class="i">+storage set mvcc:Version(sql:Row(unique, 13), 19) → 13,NULL,NULL,NULL,&#39;CaSe&#39; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\r\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x0c\x05\x02\x1a\x00\x00\x00\x04\x04CaSe&quot;]
</a> storage set mvcc:TxnWrite(19, sql:Index(unique.bool, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.bool, NULL), 19) → 4,5,6,7,8,10,11,12,13 [&quot;\x04\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x13\t\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x14\x02\x16\x02\x18\x02\x1a&quot;]
 storage set mvcc:TxnWrite(19, sql:Index(unique.int, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.int, NULL), 19) → 4,5,6,7,8,10,11,12,13 [&quot;\x04\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x13\t\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x14\x02\x16\x02\x18\x02\x1a&quot;]
 storage set mvcc:TxnWrite(19, sql:Index(unique.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, NULL), 19) → 4,5,11,12,13 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x0b\x05\x02\x08\x02\n\x02\x16\x02\x18\x02\x1a&quot;]
<a href="#h53-5-11" id="h53-5-11" class="d">-storage set mvcc:TxnWrite(19, sql:Index(unique.string, &quot;CaSe&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-5-12" id="h53-5-12" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;CaSe&quot;), 19) → 13 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x03\x01\x02\x1a&quot;]
</a><a href="#h53-5-13" id="h53-5-13" class="i">+storage set mvcc:TxnWrite(19, sql:Index(unique.string, &#39;CaSe&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h53-5-14" id="h53-5-14" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;CaSe&#39;), 19) → 13 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x13&quot; → &quot;\x01\x03\x01\x02\x1a&quot;]
</a> storage delete mvcc:TxnWrite(19, sql:Index(unique.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(19, sql:Index(unique.float, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(19, sql:Index(unique.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h53-5-18" id="h53-5-18" class="d">-storage delete mvcc:TxnWrite(19, sql:Index(unique.string, &quot;CaSe&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h53-5-19" id="h53-5-19" class="i">+storage delete mvcc:TxnWrite(19, sql:Index(unique.string, &#39;CaSe&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(19, sql:Row(unique, 13)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x13\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\r\x00\x00&quot;]
 storage delete mvcc:TxnActive(19) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x13&quot;]
<b>diff --git a/<a id="h54" href="../file/src/sql/testscripts/writes/update.html">src/sql/testscripts/writes/update</a> b/<a href="../file/src/sql/testscripts/writes/update.html">src/sql/testscripts/writes/update</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -8,32 +8,32 @@ ok
</a> # UPDATE updates rows, and returns the number of rows.
 [plan,result,ops]&gt; UPDATE name SET value = &#39;foo&#39;
 ---
<a href="#h54-0-3" id="h54-0-3" class="d">-Update: name (value=foo)
</a><a href="#h54-0-4" id="h54-0-4" class="i">+Update: name (value=&#39;foo&#39;)
</a> └─ Scan: name
 Update { count: 2 }
 storage set mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
 storage set mvcc:TxnActive(3) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(3, sql:Row(name, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h54-0-10" id="h54-0-10" class="d">-storage set mvcc:Version(sql:Row(name, 1), 3) → 1,&quot;foo&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x08\x02\x02\x02\x04\x03foo&quot;]
</a><a href="#h54-0-11" id="h54-0-11" class="i">+storage set mvcc:Version(sql:Row(name, 1), 3) → 1,&#39;foo&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x08\x02\x02\x02\x04\x03foo&quot;]
</a> storage set mvcc:TxnWrite(3, sql:Row(name, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h54-0-13" id="h54-0-13" class="d">-storage set mvcc:Version(sql:Row(name, 2), 3) → 2,&quot;foo&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x08\x02\x02\x04\x04\x03foo&quot;]
</a><a href="#h54-0-14" id="h54-0-14" class="i">+storage set mvcc:Version(sql:Row(name, 2), 3) → 2,&#39;foo&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x08\x02\x02\x04\x04\x03foo&quot;]
</a> storage delete mvcc:TxnWrite(3, sql:Row(name, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Row(name, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnActive(3) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
 
 &gt; SELECT * FROM name
 ---
<a href="#h54-0-21" id="h54-0-21" class="d">-1, foo
</a><a href="#h54-0-22" id="h54-0-22" class="d">-2, foo
</a><a href="#h54-0-23" id="h54-0-23" class="i">+1, &#39;foo&#39;
</a><a href="#h54-0-24" id="h54-0-24" class="i">+2, &#39;foo&#39;
</a> 
 dump
 ---
 mvcc:NextVersion → 4 [&quot;\x00&quot; → &quot;\x04&quot;]
 mvcc:Version(sql:Table(name), 1) → CREATE TABLE name ( id INTEGER PRIMARY KEY, value STRING DEFAULT NULL ) [&quot;\x04\x00\xffname\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01&quot; → &quot;\x01\x1d\x04name\x00\x02\x02id\x01\x00\x00\x01\x00\x00\x05value\x03\x01\x01\x00\x00\x00\x00&quot;]
<a href="#h54-0-30" id="h54-0-30" class="d">-mvcc:Version(sql:Row(name, 1), 2) → 1,&quot;a&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h54-0-31" id="h54-0-31" class="d">-mvcc:Version(sql:Row(name, 1), 3) → 1,&quot;foo&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x08\x02\x02\x02\x04\x03foo&quot;]
</a><a href="#h54-0-32" id="h54-0-32" class="d">-mvcc:Version(sql:Row(name, 2), 2) → 2,&quot;b&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h54-0-33" id="h54-0-33" class="d">-mvcc:Version(sql:Row(name, 2), 3) → 2,&quot;foo&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x08\x02\x02\x04\x04\x03foo&quot;]
</a><a href="#h54-0-34" id="h54-0-34" class="i">+mvcc:Version(sql:Row(name, 1), 2) → 1,&#39;a&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x02\x04\x01a&quot;]
</a><a href="#h54-0-35" id="h54-0-35" class="i">+mvcc:Version(sql:Row(name, 1), 3) → 1,&#39;foo&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x08\x02\x02\x02\x04\x03foo&quot;]
</a><a href="#h54-0-36" id="h54-0-36" class="i">+mvcc:Version(sql:Row(name, 2), 2) → 2,&#39;b&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02&quot; → &quot;\x01\x06\x02\x02\x04\x04\x01b&quot;]
</a><a href="#h54-0-37" id="h54-0-37" class="i">+mvcc:Version(sql:Row(name, 2), 3) → 2,&#39;foo&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x08\x02\x02\x04\x04\x03foo&quot;]
</a> 
 # Bare UPDATE errors.
 !&gt; UPDATE
<b>diff --git a/<a id="h55" href="../file/src/sql/testscripts/writes/update_datatypes.html">src/sql/testscripts/writes/update_datatypes</a> b/<a href="../file/src/sql/testscripts/writes/update_datatypes.html">src/sql/testscripts/writes/update_datatypes</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -81,7 +81,7 @@ NaN
</a> &gt; UPDATE datatypes SET &quot;string&quot; = &#39;Hi! 👋&#39;
 &gt; SELECT * FROM datatypes
 ---
<a href="#h55-0-3" id="h55-0-3" class="d">-1, TRUE, -9223372036854775807, 0.0, Hi! 👋
</a><a href="#h55-0-4" id="h55-0-4" class="i">+1, TRUE, -9223372036854775807, 0.0, &#39;Hi! 👋&#39;
</a> 
 !&gt; UPDATE datatypes SET &quot;string&quot; = false
 !&gt; UPDATE datatypes SET &quot;string&quot; = 3
<b>diff --git a/<a id="h56" href="../file/src/sql/testscripts/writes/update_default.html">src/sql/testscripts/writes/update_default</a> b/<a href="../file/src/sql/testscripts/writes/update_default.html">src/sql/testscripts/writes/update_default</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -16,7 +16,7 @@ ok
</a> &gt; UPDATE defaults SET &quot;null&quot; = DEFAULT, &quot;boolean&quot; = DEFAULT, &quot;float&quot; = DEFAULT, &quot;integer&quot; = DEFAULT, &quot;string&quot; = DEFAULT
 &gt; SELECT * FROM defaults
 ---
<a href="#h56-0-3" id="h56-0-3" class="d">-1, TRUE, NULL, TRUE, 3.14, 7, foo
</a><a href="#h56-0-4" id="h56-0-4" class="i">+1, TRUE, NULL, TRUE, 3.14, 7, &#39;foo&#39;
</a> 
 # Errors on columns with no default.
 !&gt; UPDATE defaults SET required = DEFAULT
<b>diff --git a/<a id="h57" href="../file/src/sql/testscripts/writes/update_index.html">src/sql/testscripts/writes/update_index</a> b/<a href="../file/src/sql/testscripts/writes/update_index.html">src/sql/testscripts/writes/update_index</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -28,20 +28,20 @@ storage set mvcc:TxnWrite(3, sql:Index(index.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00
</a> storage set mvcc:Version(sql:Index(index.float, 3.14), 3) → None [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
 storage set mvcc:TxnWrite(3, sql:Index(index.float, 2.718)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, 2.718), 3) → 1 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
<a href="#h57-0-3" id="h57-0-3" class="d">-storage set mvcc:TxnWrite(3, sql:Index(index.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-0-4" id="h57-0-4" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;foo&quot;), 3) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h57-0-5" id="h57-0-5" class="d">-storage set mvcc:TxnWrite(3, sql:Index(index.string, &quot;bar&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-0-6" id="h57-0-6" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;bar&quot;), 3) → 1 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h57-0-7" id="h57-0-7" class="i">+storage set mvcc:TxnWrite(3, sql:Index(index.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-0-8" id="h57-0-8" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;foo&#39;), 3) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x00&quot;]
</a><a href="#h57-0-9" id="h57-0-9" class="i">+storage set mvcc:TxnWrite(3, sql:Index(index.string, &#39;bar&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-0-10" id="h57-0-10" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;bar&#39;), 3) → 1 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a> storage set mvcc:TxnWrite(3, sql:Row(index, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h57-0-12" id="h57-0-12" class="d">-storage set mvcc:Version(sql:Row(index, 1), 3) → 1,FALSE,1,2.718,&quot;bar&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x15\x05\x02\x02\x01\x00\x02\x02\x03X9\xb4\xc8v\xbe\x05@\x04\x03bar&quot;]
</a><a href="#h57-0-13" id="h57-0-13" class="i">+storage set mvcc:Version(sql:Row(index, 1), 3) → 1,FALSE,1,2.718,&#39;bar&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03&quot; → &quot;\x01\x15\x05\x02\x02\x01\x00\x02\x02\x03X9\xb4\xc8v\xbe\x05@\x04\x03bar&quot;]
</a> storage delete mvcc:TxnWrite(3, sql:Index(index.bool, FALSE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Index(index.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Index(index.float, 2.718)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Index(index.float, 3.14)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Index(index.int, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(3, sql:Index(index.int, 7)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot;]
<a href="#h57-0-20" id="h57-0-20" class="d">-storage delete mvcc:TxnWrite(3, sql:Index(index.string, &quot;bar&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-0-21" id="h57-0-21" class="d">-storage delete mvcc:TxnWrite(3, sql:Index(index.string, &quot;foo&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-0-22" id="h57-0-22" class="i">+storage delete mvcc:TxnWrite(3, sql:Index(index.string, &#39;bar&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-0-23" id="h57-0-23" class="i">+storage delete mvcc:TxnWrite(3, sql:Index(index.string, &#39;foo&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(3, sql:Row(index, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x03\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(3) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x03&quot;]
 
<a href="#h57-1" id="h57-1" class="h">@@ -55,7 +55,7 @@ storage set mvcc:Version(sql:Index(index.bool, FALSE), 4) → None [&quot;\x04\x01ind
</a> storage set mvcc:TxnWrite(4, sql:Index(index.bool, TRUE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, TRUE), 4) → 1 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(4, sql:Row(index, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h57-1-3" id="h57-1-3" class="d">-storage set mvcc:Version(sql:Row(index, 1), 4) → 1,TRUE,1,2.718,&quot;bar&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x02\x03X9\xb4\xc8v\xbe\x05@\x04\x03bar&quot;]
</a><a href="#h57-1-4" id="h57-1-4" class="i">+storage set mvcc:Version(sql:Row(index, 1), 4) → 1,TRUE,1,2.718,&#39;bar&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x02\x03X9\xb4\xc8v\xbe\x05@\x04\x03bar&quot;]
</a> storage delete mvcc:TxnWrite(4, sql:Index(index.bool, FALSE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(4, sql:Index(index.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(4, sql:Row(index, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
<a href="#h57-2" id="h57-2" class="h">@@ -81,10 +81,10 @@ storage set mvcc:TxnWrite(6, sql:Index(index.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00
</a> storage set mvcc:Version(sql:Index(index.float, 3.14), 6) → 2 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
 storage set mvcc:TxnWrite(6, sql:Index(index.string, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.string, NULL), 6) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x00&quot;]
<a href="#h57-2-3" id="h57-2-3" class="d">-storage set mvcc:TxnWrite(6, sql:Index(index.string, &quot;abc&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-2-4" id="h57-2-4" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;abc&quot;), 6) → 2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h57-2-5" id="h57-2-5" class="i">+storage set mvcc:TxnWrite(6, sql:Index(index.string, &#39;abc&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-2-6" id="h57-2-6" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;abc&#39;), 6) → 2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a> storage set mvcc:TxnWrite(6, sql:Row(index, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h57-2-8" id="h57-2-8" class="d">-storage set mvcc:Version(sql:Row(index, 2), 6) → 2,FALSE,7,3.14,&quot;abc&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x15\x05\x02\x04\x01\x00\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03abc&quot;]
</a><a href="#h57-2-9" id="h57-2-9" class="i">+storage set mvcc:Version(sql:Row(index, 2), 6) → 2,FALSE,7,3.14,&#39;abc&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06&quot; → &quot;\x01\x15\x05\x02\x04\x01\x00\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03abc&quot;]
</a> storage delete mvcc:TxnWrite(6, sql:Index(index.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(6, sql:Index(index.bool, FALSE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(6, sql:Index(index.float, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h57-3" id="h57-3" class="h">@@ -92,14 +92,14 @@ storage delete mvcc:TxnWrite(6, sql:Index(index.float, 3.14)) [&quot;\x03\x00\x00\x00
</a> storage delete mvcc:TxnWrite(6, sql:Index(index.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(6, sql:Index(index.int, 7)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot;]
 storage delete mvcc:TxnWrite(6, sql:Index(index.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h57-3-3" id="h57-3-3" class="d">-storage delete mvcc:TxnWrite(6, sql:Index(index.string, &quot;abc&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-3-4" id="h57-3-4" class="i">+storage delete mvcc:TxnWrite(6, sql:Index(index.string, &#39;abc&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(6, sql:Row(index, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x06\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnActive(6) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x06&quot;]
 
 &gt; SELECT * FROM &quot;index&quot;
 ---
<a href="#h57-3-10" id="h57-3-10" class="d">-1, TRUE, 1, 2.718, bar
</a><a href="#h57-3-11" id="h57-3-11" class="d">-2, FALSE, 7, 3.14, abc
</a><a href="#h57-3-12" id="h57-3-12" class="i">+1, TRUE, 1, 2.718, &#39;bar&#39;
</a><a href="#h57-3-13" id="h57-3-13" class="i">+2, FALSE, 7, 3.14, &#39;abc&#39;
</a> 
 # Updates with same values merges the index entries.
 [ops]&gt; UPDATE &quot;index&quot; SET &quot;bool&quot; = TRUE, &quot;int&quot; = 7, &quot;float&quot; = 3.14, &quot;string&quot; = &#39;foo&#39;
<a href="#h57-4" id="h57-4" class="h">@@ -114,39 +114,39 @@ storage set mvcc:TxnWrite(7, sql:Index(index.float, 2.718)) → &quot;&quot; [&quot;\x03\x00\x0
</a> storage set mvcc:Version(sql:Index(index.float, 2.718), 7) → None [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x00&quot;]
 storage set mvcc:TxnWrite(7, sql:Index(index.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, 3.14), 7) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
<a href="#h57-4-3" id="h57-4-3" class="d">-storage set mvcc:TxnWrite(7, sql:Index(index.string, &quot;bar&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-4-4" id="h57-4-4" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;bar&quot;), 7) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x00&quot;]
</a><a href="#h57-4-5" id="h57-4-5" class="d">-storage set mvcc:TxnWrite(7, sql:Index(index.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-4-6" id="h57-4-6" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;foo&quot;), 7) → 1 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h57-4-7" id="h57-4-7" class="i">+storage set mvcc:TxnWrite(7, sql:Index(index.string, &#39;bar&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-4-8" id="h57-4-8" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;bar&#39;), 7) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x00&quot;]
</a><a href="#h57-4-9" id="h57-4-9" class="i">+storage set mvcc:TxnWrite(7, sql:Index(index.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-4-10" id="h57-4-10" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;foo&#39;), 7) → 1 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a> storage set mvcc:TxnWrite(7, sql:Row(index, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h57-4-12" id="h57-4-12" class="d">-storage set mvcc:Version(sql:Row(index, 1), 7) → 1,TRUE,7,3.14,&quot;foo&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a><a href="#h57-4-13" id="h57-4-13" class="i">+storage set mvcc:Version(sql:Row(index, 1), 7) → 1,TRUE,7,3.14,&#39;foo&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a> storage set mvcc:TxnWrite(7, sql:Index(index.bool, FALSE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, FALSE), 7) → None [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x00&quot;]
 storage set mvcc:TxnWrite(7, sql:Index(index.bool, TRUE)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, TRUE), 7) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
<a href="#h57-4-18" id="h57-4-18" class="d">-storage set mvcc:TxnWrite(7, sql:Index(index.string, &quot;abc&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-4-19" id="h57-4-19" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;abc&quot;), 7) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x00&quot;]
</a><a href="#h57-4-20" id="h57-4-20" class="d">-storage set mvcc:TxnWrite(7, sql:Index(index.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-4-21" id="h57-4-21" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;foo&quot;), 7) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
</a><a href="#h57-4-22" id="h57-4-22" class="i">+storage set mvcc:TxnWrite(7, sql:Index(index.string, &#39;abc&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-4-23" id="h57-4-23" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;abc&#39;), 7) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x00&quot;]
</a><a href="#h57-4-24" id="h57-4-24" class="i">+storage set mvcc:TxnWrite(7, sql:Index(index.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-4-25" id="h57-4-25" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;foo&#39;), 7) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
</a> storage set mvcc:TxnWrite(7, sql:Row(index, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h57-4-27" id="h57-4-27" class="d">-storage set mvcc:Version(sql:Row(index, 2), 7) → 2,TRUE,7,3.14,&quot;foo&quot; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x15\x05\x02\x04\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a><a href="#h57-4-28" id="h57-4-28" class="i">+storage set mvcc:Version(sql:Row(index, 2), 7) → 2,TRUE,7,3.14,&#39;foo&#39; [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; → &quot;\x01\x15\x05\x02\x04\x01\x01\x02\x0e\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a> storage delete mvcc:TxnWrite(7, sql:Index(index.bool, FALSE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(index.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(index.float, 2.718)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(index.float, 3.14)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(index.int, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(index.int, 7)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot;]
<a href="#h57-4-35" id="h57-4-35" class="d">-storage delete mvcc:TxnWrite(7, sql:Index(index.string, &quot;abc&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-4-36" id="h57-4-36" class="d">-storage delete mvcc:TxnWrite(7, sql:Index(index.string, &quot;bar&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-4-37" id="h57-4-37" class="d">-storage delete mvcc:TxnWrite(7, sql:Index(index.string, &quot;foo&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-4-38" id="h57-4-38" class="i">+storage delete mvcc:TxnWrite(7, sql:Index(index.string, &#39;abc&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04abc\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-4-39" id="h57-4-39" class="i">+storage delete mvcc:TxnWrite(7, sql:Index(index.string, &#39;bar&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04bar\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-4-40" id="h57-4-40" class="i">+storage delete mvcc:TxnWrite(7, sql:Index(index.string, &#39;foo&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(7, sql:Row(index, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Row(index, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnActive(7) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x07&quot;]
 
 &gt; SELECT * FROM &quot;index&quot;
 ---
<a href="#h57-4-47" id="h57-4-47" class="d">-1, TRUE, 7, 3.14, foo
</a><a href="#h57-4-48" id="h57-4-48" class="d">-2, TRUE, 7, 3.14, foo
</a><a href="#h57-4-49" id="h57-4-49" class="i">+1, TRUE, 7, 3.14, &#39;foo&#39;
</a><a href="#h57-4-50" id="h57-4-50" class="i">+2, TRUE, 7, 3.14, &#39;foo&#39;
</a> 
 # Updates with all NULLs work and get indexed.
 [ops]&gt; UPDATE &quot;index&quot; SET &quot;bool&quot; = NULL, &quot;int&quot; = NULL, &quot;float&quot; = NULL, &quot;string&quot; = NULL
<a href="#h57-5" id="h57-5" class="h">@@ -165,8 +165,8 @@ storage set mvcc:TxnWrite(8, sql:Index(index.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00
</a> storage set mvcc:Version(sql:Index(index.float, 3.14), 8) → 2 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
 storage set mvcc:TxnWrite(8, sql:Index(index.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, NULL), 8) → 1 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
<a href="#h57-5-3" id="h57-5-3" class="d">-storage set mvcc:TxnWrite(8, sql:Index(index.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-5-4" id="h57-5-4" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;foo&quot;), 8) → 2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h57-5-5" id="h57-5-5" class="i">+storage set mvcc:TxnWrite(8, sql:Index(index.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-5-6" id="h57-5-6" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;foo&#39;), 8) → 2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a> storage set mvcc:TxnWrite(8, sql:Index(index.string, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.string, NULL), 8) → 1 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(8, sql:Row(index, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h57-6" id="h57-6" class="h">@@ -183,8 +183,8 @@ storage set mvcc:TxnWrite(8, sql:Index(index.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00
</a> storage set mvcc:Version(sql:Index(index.float, 3.14), 8) → None [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
 storage set mvcc:TxnWrite(8, sql:Index(index.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.float, NULL), 8) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
<a href="#h57-6-3" id="h57-6-3" class="d">-storage set mvcc:TxnWrite(8, sql:Index(index.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-6-4" id="h57-6-4" class="d">-storage set mvcc:Version(sql:Index(index.string, &quot;foo&quot;), 8) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a><a href="#h57-6-5" id="h57-6-5" class="i">+storage set mvcc:TxnWrite(8, sql:Index(index.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h57-6-6" id="h57-6-6" class="i">+storage set mvcc:Version(sql:Index(index.string, &#39;foo&#39;), 8) → None [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x00&quot;]
</a> storage set mvcc:TxnWrite(8, sql:Index(index.string, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.string, NULL), 8) → 1,2 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
 storage set mvcc:TxnWrite(8, sql:Row(index, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h57-7" id="h57-7" class="h">@@ -196,7 +196,7 @@ storage delete mvcc:TxnWrite(8, sql:Index(index.float, 3.14)) [&quot;\x03\x00\x00\x00
</a> storage delete mvcc:TxnWrite(8, sql:Index(index.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(8, sql:Index(index.int, 7)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x07\x00\x00&quot;]
 storage delete mvcc:TxnWrite(8, sql:Index(index.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h57-7-3" id="h57-7-3" class="d">-storage delete mvcc:TxnWrite(8, sql:Index(index.string, &quot;foo&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h57-7-4" id="h57-7-4" class="i">+storage delete mvcc:TxnWrite(8, sql:Index(index.string, &#39;foo&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(8, sql:Row(index, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(8, sql:Row(index, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x08\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnActive(8) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x08&quot;]
<b>diff --git a/<a id="h58" href="../file/src/sql/testscripts/writes/update_null.html">src/sql/testscripts/writes/update_null</a> b/<a href="../file/src/sql/testscripts/writes/update_null.html">src/sql/testscripts/writes/update_null</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -14,7 +14,7 @@ ok
</a> &gt; UPDATE name SET &quot;null&quot; = NULL
 &gt; SELECT * FROM name
 ---
<a href="#h58-0-3" id="h58-0-3" class="d">-1, NULL, bar
</a><a href="#h58-0-4" id="h58-0-4" class="i">+1, NULL, &#39;bar&#39;
</a> 
 # UPDATE with NULL in non-NULL column errors.
 !&gt; UPDATE name SET id = NULL
<b>diff --git a/<a id="h59" href="../file/src/sql/testscripts/writes/update_primary_key.html">src/sql/testscripts/writes/update_primary_key</a> b/<a href="../file/src/sql/testscripts/writes/update_primary_key.html">src/sql/testscripts/writes/update_primary_key</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -113,14 +113,14 @@ Error: invalid input: invalid primary key NULL
</a> &gt; UPDATE &quot;string&quot; SET id = &#39;Hi! 👋&#39;
 &gt; SELECT * FROM &quot;string&quot;
 ---
<a href="#h59-0-3" id="h59-0-3" class="d">-Hi! 👋
</a><a href="#h59-0-4" id="h59-0-4" class="i">+&#39;Hi! 👋&#39;
</a> 
 &gt; INSERT INTO &quot;string&quot; VALUES (&#39;&#39;)
 &gt; UPDATE &quot;string&quot; SET id = &#39;foo&#39; WHERE id = &#39;&#39;
 &gt; SELECT * FROM &quot;string&quot;
 ---
<a href="#h59-0-10" id="h59-0-10" class="d">-Hi! 👋
</a><a href="#h59-0-11" id="h59-0-11" class="d">-foo
</a><a href="#h59-0-12" id="h59-0-12" class="i">+&#39;Hi! 👋&#39;
</a><a href="#h59-0-13" id="h59-0-13" class="i">+&#39;foo&#39;
</a> 
 !&gt; UPDATE &quot;string&quot; SET id = &#39;&#39;
 !&gt; UPDATE &quot;string&quot; SET id = &#39;  &#39;
<a href="#h59-1" id="h59-1" class="h">@@ -129,11 +129,11 @@ foo
</a> !&gt; UPDATE &quot;string&quot; SET id = &#39;Hi! 👋&#39;
 !&gt; UPDATE &quot;string&quot; SET id = NULL
 ---
<a href="#h59-1-3" id="h59-1-3" class="d">-Error: invalid input: primary key  already exists
</a><a href="#h59-1-4" id="h59-1-4" class="d">-Error: invalid input: primary key    already exists
</a><a href="#h59-1-5" id="h59-1-5" class="d">-Error: invalid input: primary key abc already exists
</a><a href="#h59-1-6" id="h59-1-6" class="d">-Error: invalid input: primary key ABC already exists
</a><a href="#h59-1-7" id="h59-1-7" class="d">-Error: invalid input: primary key Hi! 👋 already exists
</a><a href="#h59-1-8" id="h59-1-8" class="i">+Error: invalid input: primary key &#39;&#39; already exists
</a><a href="#h59-1-9" id="h59-1-9" class="i">+Error: invalid input: primary key &#39;  &#39; already exists
</a><a href="#h59-1-10" id="h59-1-10" class="i">+Error: invalid input: primary key &#39;abc&#39; already exists
</a><a href="#h59-1-11" id="h59-1-11" class="i">+Error: invalid input: primary key &#39;ABC&#39; already exists
</a><a href="#h59-1-12" id="h59-1-12" class="i">+Error: invalid input: primary key &#39;Hi! 👋&#39; already exists
</a> Error: invalid input: invalid primary key NULL
 
 # Primary key updates error if intermediate row updates violate primary key
<b>diff --git a/<a id="h60" href="../file/src/sql/testscripts/writes/update_reference.html">src/sql/testscripts/writes/update_reference</a> b/<a href="../file/src/sql/testscripts/writes/update_reference.html">src/sql/testscripts/writes/update_reference</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -43,10 +43,10 @@ storage set mvcc:TxnWrite(11, sql:Index(name.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x00
</a> storage set mvcc:Version(sql:Index(name.float, 3.14), 11) → 1 [&quot;\x04\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(11, sql:Index(name.string, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.string, NULL), 11) → None [&quot;\x04\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x00&quot;]
<a href="#h60-0-3" id="h60-0-3" class="d">-storage set mvcc:TxnWrite(11, sql:Index(name.string, &quot;foo&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h60-0-4" id="h60-0-4" class="d">-storage set mvcc:Version(sql:Index(name.string, &quot;foo&quot;), 11) → 1 [&quot;\x04\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h60-0-5" id="h60-0-5" class="i">+storage set mvcc:TxnWrite(11, sql:Index(name.string, &#39;foo&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h60-0-6" id="h60-0-6" class="i">+storage set mvcc:Version(sql:Index(name.string, &#39;foo&#39;), 11) → 1 [&quot;\x04\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a> storage set mvcc:TxnWrite(11, sql:Row(name, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h60-0-8" id="h60-0-8" class="d">-storage set mvcc:Version(sql:Row(name, 1), 11) → 1,TRUE,1,3.14,&quot;foo&quot; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x02\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a><a href="#h60-0-9" id="h60-0-9" class="i">+storage set mvcc:Version(sql:Row(name, 1), 11) → 1,TRUE,1,3.14,&#39;foo&#39; [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0b&quot; → &quot;\x01\x15\x05\x02\x02\x01\x01\x02\x02\x03\x1f\x85\xebQ\xb8\x1e\t@\x04\x03foo&quot;]
</a> storage delete mvcc:TxnWrite(11, sql:Index(name.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(11, sql:Index(name.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(11, sql:Index(name.float, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h60-1" id="h60-1" class="h">@@ -54,7 +54,7 @@ storage delete mvcc:TxnWrite(11, sql:Index(name.float, 3.14)) [&quot;\x03\x00\x00\x00
</a> storage delete mvcc:TxnWrite(11, sql:Index(name.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(11, sql:Index(name.int, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(11, sql:Index(name.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h60-1-3" id="h60-1-3" class="d">-storage delete mvcc:TxnWrite(11, sql:Index(name.string, &quot;foo&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h60-1-4" id="h60-1-4" class="i">+storage delete mvcc:TxnWrite(11, sql:Index(name.string, &#39;foo&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x04foo\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(11, sql:Row(name, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0b\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(11) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0b&quot;]
 
<a href="#h60-2" id="h60-2" class="h">@@ -67,7 +67,7 @@ storage delete mvcc:TxnActive(11) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0b&quot;]
</a> Error: invalid input: reference FALSE not in table bool
 Error: invalid input: reference 7 not in table int
 Error: invalid input: reference 2.718 not in table float
<a href="#h60-2-3" id="h60-2-3" class="d">-Error: invalid input: reference bar not in table string
</a><a href="#h60-2-4" id="h60-2-4" class="i">+Error: invalid input: reference &#39;bar&#39; not in table string
</a> 
 # -0.0 equals 0.0.
 &gt; UPDATE name SET &quot;float&quot; = -0.0
<a href="#h60-3" id="h60-3" class="h">@@ -87,7 +87,7 @@ ok
</a> # References are case sensitive.
 !&gt; UPDATE name SET &quot;string&quot; = &#39;FOO&#39;
 ---
<a href="#h60-3-3" id="h60-3-3" class="d">-Error: invalid input: reference FOO not in table string
</a><a href="#h60-3-4" id="h60-3-4" class="i">+Error: invalid input: reference &#39;FOO&#39; not in table string
</a> 
 # Empty strings are valid references.
 &gt; UPDATE name SET &quot;string&quot; = &#39;&#39;
<b>diff --git a/<a id="h61" href="../file/src/sql/testscripts/writes/update_unique.html">src/sql/testscripts/writes/update_unique</a> b/<a href="../file/src/sql/testscripts/writes/update_unique.html">src/sql/testscripts/writes/update_unique</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -33,10 +33,10 @@ storage set mvcc:TxnWrite(4, sql:Index(unique.float, 2.718)) → &quot;&quot; [&quot;\x03\x00\x
</a> storage set mvcc:Version(sql:Index(unique.float, 2.718), 4) → 2 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
 storage set mvcc:TxnWrite(4, sql:Index(unique.string, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.string, NULL), 4) → None [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x00&quot;]
<a href="#h61-0-3" id="h61-0-3" class="d">-storage set mvcc:TxnWrite(4, sql:Index(unique.string, &quot;b&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-0-4" id="h61-0-4" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;b&quot;), 4) → 2 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h61-0-5" id="h61-0-5" class="i">+storage set mvcc:TxnWrite(4, sql:Index(unique.string, &#39;b&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-0-6" id="h61-0-6" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;b&#39;), 4) → 2 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a> storage set mvcc:TxnWrite(4, sql:Row(unique, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h61-0-8" id="h61-0-8" class="d">-storage set mvcc:Version(sql:Row(unique, 2), 4) → 2,TRUE,2,2.718,&quot;b&quot; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x13\x05\x02\x04\x01\x01\x02\x04\x03X9\xb4\xc8v\xbe\x05@\x04\x01b&quot;]
</a><a href="#h61-0-9" id="h61-0-9" class="i">+storage set mvcc:Version(sql:Row(unique, 2), 4) → 2,TRUE,2,2.718,&#39;b&#39; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04&quot; → &quot;\x01\x13\x05\x02\x04\x01\x01\x02\x04\x03X9\xb4\xc8v\xbe\x05@\x04\x01b&quot;]
</a> storage delete mvcc:TxnWrite(4, sql:Index(unique.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(4, sql:Index(unique.bool, TRUE)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x01\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(4, sql:Index(unique.float, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h61-1" id="h61-1" class="h">@@ -44,7 +44,7 @@ storage delete mvcc:TxnWrite(4, sql:Index(unique.float, 2.718)) [&quot;\x03\x00\x00\x
</a> storage delete mvcc:TxnWrite(4, sql:Index(unique.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(4, sql:Index(unique.int, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnWrite(4, sql:Index(unique.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h61-1-3" id="h61-1-3" class="d">-storage delete mvcc:TxnWrite(4, sql:Index(unique.string, &quot;b&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h61-1-4" id="h61-1-4" class="i">+storage delete mvcc:TxnWrite(4, sql:Index(unique.string, &#39;b&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(4, sql:Row(unique, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnActive(4) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x04&quot;]
 
<a href="#h61-2" id="h61-2" class="h">@@ -57,7 +57,7 @@ storage delete mvcc:TxnActive(4) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x04&quot;]
</a> Error: invalid input: value FALSE already in unique column bool
 Error: invalid input: value 1 already in unique column int
 Error: invalid input: value 3.14 already in unique column float
<a href="#h61-2-3" id="h61-2-3" class="d">-Error: invalid input: value a already in unique column string
</a><a href="#h61-2-4" id="h61-2-4" class="i">+Error: invalid input: value &#39;a&#39; already in unique column string
</a> 
 # It also fails when updating all rows.
 !&gt; UPDATE &quot;unique&quot; SET &quot;bool&quot; = FALSE
<a href="#h61-3" id="h61-3" class="h">@@ -68,7 +68,7 @@ Error: invalid input: value a already in unique column string
</a> Error: invalid input: value FALSE already in unique column bool
 Error: invalid input: value 7 already in unique column int
 Error: invalid input: value 0.0 already in unique column float
<a href="#h61-3-3" id="h61-3-3" class="d">-Error: invalid input: value abc already in unique column string
</a><a href="#h61-3-4" id="h61-3-4" class="i">+Error: invalid input: value &#39;abc&#39; already in unique column string
</a> 
 # Updates with NULLS sets NULL entries. Duplicates are allowed.
 [ops]&gt; UPDATE &quot;unique&quot; SET &quot;bool&quot; = NULL, &quot;int&quot; = NULL, &quot;float&quot; = NULL, &quot;string&quot; = NULL
<a href="#h61-4" id="h61-4" class="h">@@ -87,8 +87,8 @@ storage set mvcc:TxnWrite(13, sql:Index(unique.float, 3.14)) → &quot;&quot; [&quot;\x03\x00\x
</a> storage set mvcc:Version(sql:Index(unique.float, 3.14), 13) → None [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\t\x1e\xb8Q\xeb\x85\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x00&quot;]
 storage set mvcc:TxnWrite(13, sql:Index(unique.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, NULL), 13) → 1 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
<a href="#h61-4-3" id="h61-4-3" class="d">-storage set mvcc:TxnWrite(13, sql:Index(unique.string, &quot;a&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-4-4" id="h61-4-4" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;a&quot;), 13) → None [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x00&quot;]
</a><a href="#h61-4-5" id="h61-4-5" class="i">+storage set mvcc:TxnWrite(13, sql:Index(unique.string, &#39;a&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-4-6" id="h61-4-6" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;a&#39;), 13) → None [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x00&quot;]
</a> storage set mvcc:TxnWrite(13, sql:Index(unique.string, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.string, NULL), 13) → 1 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(13, sql:Row(unique, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h61-5" id="h61-5" class="h">@@ -105,8 +105,8 @@ storage set mvcc:TxnWrite(13, sql:Index(unique.float, 2.718)) → &quot;&quot; [&quot;\x03\x00\
</a> storage set mvcc:Version(sql:Index(unique.float, 2.718), 13) → None [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xc0\x05\xbev\xc8\xb49X\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x00&quot;]
 storage set mvcc:TxnWrite(13, sql:Index(unique.float, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, NULL), 13) → 1,2 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
<a href="#h61-5-3" id="h61-5-3" class="d">-storage set mvcc:TxnWrite(13, sql:Index(unique.string, &quot;b&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-5-4" id="h61-5-4" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;b&quot;), 13) → None [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x00&quot;]
</a><a href="#h61-5-5" id="h61-5-5" class="i">+storage set mvcc:TxnWrite(13, sql:Index(unique.string, &#39;b&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-5-6" id="h61-5-6" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;b&#39;), 13) → None [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x00&quot;]
</a> storage set mvcc:TxnWrite(13, sql:Index(unique.string, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.string, NULL), 13) → 1,2 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\r&quot; → &quot;\x01\x05\x02\x02\x02\x02\x04&quot;]
 storage set mvcc:TxnWrite(13, sql:Row(unique, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h61-6" id="h61-6" class="h">@@ -121,8 +121,8 @@ storage delete mvcc:TxnWrite(13, sql:Index(unique.int, NULL)) [&quot;\x03\x00\x00\x00
</a> storage delete mvcc:TxnWrite(13, sql:Index(unique.int, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(13, sql:Index(unique.int, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnWrite(13, sql:Index(unique.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h61-6-3" id="h61-6-3" class="d">-storage delete mvcc:TxnWrite(13, sql:Index(unique.string, &quot;a&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h61-6-4" id="h61-6-4" class="d">-storage delete mvcc:TxnWrite(13, sql:Index(unique.string, &quot;b&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h61-6-5" id="h61-6-5" class="i">+storage delete mvcc:TxnWrite(13, sql:Index(unique.string, &#39;a&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04a\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h61-6-6" id="h61-6-6" class="i">+storage delete mvcc:TxnWrite(13, sql:Index(unique.string, &#39;b&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04b\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(13, sql:Row(unique, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnWrite(13, sql:Row(unique, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\r\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnActive(13) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\r&quot;]
<a href="#h61-7" id="h61-7" class="h">@@ -225,7 +225,7 @@ Error: invalid input: value inf already in unique column float
</a> &gt; UPDATE &quot;unique&quot; SET &quot;string&quot; = &#39;&#39; WHERE id = 1
 !&gt; UPDATE &quot;unique&quot; SET &quot;string&quot; = &#39;&#39; WHERE id = 2
 ---
<a href="#h61-7-3" id="h61-7-3" class="d">-Error: invalid input: value  already in unique column string
</a><a href="#h61-7-4" id="h61-7-4" class="i">+Error: invalid input: value &#39;&#39; already in unique column string
</a> 
 # Case differences are not considered equal.
 [ops]&gt; UPDATE &quot;unique&quot; SET &quot;string&quot; = &#39;case&#39; WHERE id = 1
<a href="#h61-8" id="h61-8" class="h">@@ -233,41 +233,41 @@ Error: invalid input: value  already in unique column string
</a> ---
 storage set mvcc:NextVersion → 23 [&quot;\x00&quot; → &quot;\x17&quot;]
 storage set mvcc:TxnActive(22) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x16&quot; → &quot;&quot;]
<a href="#h61-8-3" id="h61-8-3" class="d">-storage set mvcc:TxnWrite(22, sql:Index(unique.string, &quot;&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-8-4" id="h61-8-4" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;&quot;), 22) → None [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16&quot; → &quot;\x00&quot;]
</a><a href="#h61-8-5" id="h61-8-5" class="d">-storage set mvcc:TxnWrite(22, sql:Index(unique.string, &quot;case&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-8-6" id="h61-8-6" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;case&quot;), 22) → 1 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h61-8-7" id="h61-8-7" class="i">+storage set mvcc:TxnWrite(22, sql:Index(unique.string, &#39;&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-8-8" id="h61-8-8" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;&#39;), 22) → None [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16&quot; → &quot;\x00&quot;]
</a><a href="#h61-8-9" id="h61-8-9" class="i">+storage set mvcc:TxnWrite(22, sql:Index(unique.string, &#39;case&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-8-10" id="h61-8-10" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;case&#39;), 22) → 1 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16&quot; → &quot;\x01\x03\x01\x02\x02&quot;]
</a> storage set mvcc:TxnWrite(22, sql:Row(unique, 1)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; → &quot;&quot;]
<a href="#h61-8-12" id="h61-8-12" class="d">-storage set mvcc:Version(sql:Row(unique, 1), 22) → 1,NULL,NULL,inf,&quot;case&quot; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16&quot; → &quot;\x01\x14\x05\x02\x02\x00\x00\x03\x00\x00\x00\x00\x00\x00\xf0\x7f\x04\x04case&quot;]
</a><a href="#h61-8-13" id="h61-8-13" class="d">-storage delete mvcc:TxnWrite(22, sql:Index(unique.string, &quot;&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h61-8-14" id="h61-8-14" class="d">-storage delete mvcc:TxnWrite(22, sql:Index(unique.string, &quot;case&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h61-8-15" id="h61-8-15" class="i">+storage set mvcc:Version(sql:Row(unique, 1), 22) → 1,NULL,NULL,inf,&#39;case&#39; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16&quot; → &quot;\x01\x14\x05\x02\x02\x00\x00\x03\x00\x00\x00\x00\x00\x00\xf0\x7f\x04\x04case&quot;]
</a><a href="#h61-8-16" id="h61-8-16" class="i">+storage delete mvcc:TxnWrite(22, sql:Index(unique.string, &#39;&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h61-8-17" id="h61-8-17" class="i">+storage delete mvcc:TxnWrite(22, sql:Index(unique.string, &#39;case&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04case\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(22, sql:Row(unique, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x16\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(22) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x16&quot;]
 storage set mvcc:NextVersion → 24 [&quot;\x00&quot; → &quot;\x18&quot;]
 storage set mvcc:TxnActive(23) → &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x17&quot; → &quot;&quot;]
 storage set mvcc:TxnWrite(23, sql:Index(unique.string, NULL)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x17\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.string, NULL), 23) → None [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17&quot; → &quot;\x00&quot;]
<a href="#h61-8-24" id="h61-8-24" class="d">-storage set mvcc:TxnWrite(23, sql:Index(unique.string, &quot;CaSe&quot;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x17\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-8-25" id="h61-8-25" class="d">-storage set mvcc:Version(sql:Index(unique.string, &quot;CaSe&quot;), 23) → 2 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h61-8-26" id="h61-8-26" class="i">+storage set mvcc:TxnWrite(23, sql:Index(unique.string, &#39;CaSe&#39;)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x17\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot; → &quot;&quot;]
</a><a href="#h61-8-27" id="h61-8-27" class="i">+storage set mvcc:Version(sql:Index(unique.string, &#39;CaSe&#39;), 23) → 2 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17&quot; → &quot;\x01\x03\x01\x02\x04&quot;]
</a> storage set mvcc:TxnWrite(23, sql:Row(unique, 2)) → &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x17\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; → &quot;&quot;]
<a href="#h61-8-29" id="h61-8-29" class="d">-storage set mvcc:Version(sql:Row(unique, 2), 23) → 2,NULL,NULL,-inf,&quot;CaSe&quot; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17&quot; → &quot;\x01\x14\x05\x02\x04\x00\x00\x03\x00\x00\x00\x00\x00\x00\xf0\xff\x04\x04CaSe&quot;]
</a><a href="#h61-8-30" id="h61-8-30" class="i">+storage set mvcc:Version(sql:Row(unique, 2), 23) → 2,NULL,NULL,-inf,&#39;CaSe&#39; [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x17&quot; → &quot;\x01\x14\x05\x02\x04\x00\x00\x03\x00\x00\x00\x00\x00\x00\xf0\xff\x04\x04CaSe&quot;]
</a> storage delete mvcc:TxnWrite(23, sql:Index(unique.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x17\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h61-8-32" id="h61-8-32" class="d">-storage delete mvcc:TxnWrite(23, sql:Index(unique.string, &quot;CaSe&quot;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x17\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h61-8-33" id="h61-8-33" class="i">+storage delete mvcc:TxnWrite(23, sql:Index(unique.string, &#39;CaSe&#39;)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x17\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x04CaSe\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(23, sql:Row(unique, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x17\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
 storage delete mvcc:TxnActive(23) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x17&quot;]
 
 &gt; SELECT * FROM &quot;unique&quot;
 ---
<a href="#h61-8-39" id="h61-8-39" class="d">-1, NULL, NULL, inf, case
</a><a href="#h61-8-40" id="h61-8-40" class="d">-2, NULL, NULL, -inf, CaSe
</a><a href="#h61-8-41" id="h61-8-41" class="i">+1, NULL, NULL, inf, &#39;case&#39;
</a><a href="#h61-8-42" id="h61-8-42" class="i">+2, NULL, NULL, -inf, &#39;CaSe&#39;
</a> 
 # An UPDATE errors if intermediate states violate the uniqueness constraints,
 # even if the final state wouldn&#39;t. This is the same in Postgres.
 &gt; UPDATE &quot;unique&quot; SET &quot;bool&quot; = id = 2
 &gt; SELECT * FROM &quot;unique&quot;
 ---
<a href="#h61-8-49" id="h61-8-49" class="d">-1, FALSE, NULL, inf, case
</a><a href="#h61-8-50" id="h61-8-50" class="d">-2, TRUE, NULL, -inf, CaSe
</a><a href="#h61-8-51" id="h61-8-51" class="i">+1, FALSE, NULL, inf, &#39;case&#39;
</a><a href="#h61-8-52" id="h61-8-52" class="i">+2, TRUE, NULL, -inf, &#39;CaSe&#39;
</a> 
 !&gt; UPDATE &quot;unique&quot; SET &quot;bool&quot; = NOT &quot;bool&quot;
 ---
<b>diff --git a/<a id="h62" href="../file/src/sql/testscripts/writes/update_where.html">src/sql/testscripts/writes/update_where</a> b/<a href="../file/src/sql/testscripts/writes/update_where.html">src/sql/testscripts/writes/update_where</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -12,20 +12,20 @@ ok
</a> &gt; SELECT * FROM name
 &gt; ROLLBACK
 ---
<a href="#h62-0-3" id="h62-0-3" class="d">-Update: name (value=foo)
</a><a href="#h62-0-4" id="h62-0-4" class="i">+Update: name (value=&#39;foo&#39;)
</a> └─ Scan: name
<a href="#h62-0-6" id="h62-0-6" class="d">-1, foo, 1
</a><a href="#h62-0-7" id="h62-0-7" class="d">-2, foo, 2
</a><a href="#h62-0-8" id="h62-0-8" class="d">-3, foo, NULL
</a><a href="#h62-0-9" id="h62-0-9" class="i">+1, &#39;foo&#39;, 1
</a><a href="#h62-0-10" id="h62-0-10" class="i">+2, &#39;foo&#39;, 2
</a><a href="#h62-0-11" id="h62-0-11" class="i">+3, &#39;foo&#39;, NULL
</a> 
 [plan]&gt; UPDATE name SET value = &#39;foo&#39; WHERE FALSE
 &gt; SELECT * FROM name
 ---
<a href="#h62-0-16" id="h62-0-16" class="d">-Update: name (value=foo)
</a><a href="#h62-0-17" id="h62-0-17" class="i">+Update: name (value=&#39;foo&#39;)
</a> └─ Nothing
<a href="#h62-0-19" id="h62-0-19" class="d">-1, a, 1
</a><a href="#h62-0-20" id="h62-0-20" class="d">-2, b, 2
</a><a href="#h62-0-21" id="h62-0-21" class="d">-3, c, NULL
</a><a href="#h62-0-22" id="h62-0-22" class="i">+1, &#39;a&#39;, 1
</a><a href="#h62-0-23" id="h62-0-23" class="i">+2, &#39;b&#39;, 2
</a><a href="#h62-0-24" id="h62-0-24" class="i">+3, &#39;c&#39;, NULL
</a> 
 # Updating by primary key lookup.
 &gt; BEGIN
<a href="#h62-1" id="h62-1" class="h">@@ -33,11 +33,11 @@ Update: name (value=foo)
</a> &gt; SELECT * FROM name
 &gt; ROLLBACK
 ---
<a href="#h62-1-3" id="h62-1-3" class="d">-Update: name (value=foo)
</a><a href="#h62-1-4" id="h62-1-4" class="i">+Update: name (value=&#39;foo&#39;)
</a> └─ KeyLookup: name (1, 3)
<a href="#h62-1-6" id="h62-1-6" class="d">-1, foo, 1
</a><a href="#h62-1-7" id="h62-1-7" class="d">-2, b, 2
</a><a href="#h62-1-8" id="h62-1-8" class="d">-3, foo, NULL
</a><a href="#h62-1-9" id="h62-1-9" class="i">+1, &#39;foo&#39;, 1
</a><a href="#h62-1-10" id="h62-1-10" class="i">+2, &#39;b&#39;, 2
</a><a href="#h62-1-11" id="h62-1-11" class="i">+3, &#39;foo&#39;, NULL
</a> 
 # Updating by index lookup.
 &gt; BEGIN
<a href="#h62-2" id="h62-2" class="h">@@ -45,11 +45,11 @@ Update: name (value=foo)
</a> &gt; SELECT * FROM name
 &gt; ROLLBACK
 ---
<a href="#h62-2-3" id="h62-2-3" class="d">-Update: name (value=foo)
</a><a href="#h62-2-4" id="h62-2-4" class="i">+Update: name (value=&#39;foo&#39;)
</a> └─ IndexLookup: name.index (2)
<a href="#h62-2-6" id="h62-2-6" class="d">-1, a, 1
</a><a href="#h62-2-7" id="h62-2-7" class="d">-2, foo, 2
</a><a href="#h62-2-8" id="h62-2-8" class="d">-3, c, NULL
</a><a href="#h62-2-9" id="h62-2-9" class="i">+1, &#39;a&#39;, 1
</a><a href="#h62-2-10" id="h62-2-10" class="i">+2, &#39;foo&#39;, 2
</a><a href="#h62-2-11" id="h62-2-11" class="i">+3, &#39;c&#39;, NULL
</a> 
 # Including IS NULL.
 &gt; BEGIN
<a href="#h62-3" id="h62-3" class="h">@@ -57,11 +57,11 @@ Update: name (value=foo)
</a> &gt; SELECT * FROM name
 &gt; ROLLBACK
 ---
<a href="#h62-3-3" id="h62-3-3" class="d">-Update: name (value=foo)
</a><a href="#h62-3-4" id="h62-3-4" class="i">+Update: name (value=&#39;foo&#39;)
</a> └─ IndexLookup: name.index (NULL)
<a href="#h62-3-6" id="h62-3-6" class="d">-1, a, 1
</a><a href="#h62-3-7" id="h62-3-7" class="d">-2, b, 2
</a><a href="#h62-3-8" id="h62-3-8" class="d">-3, foo, NULL
</a><a href="#h62-3-9" id="h62-3-9" class="i">+1, &#39;a&#39;, 1
</a><a href="#h62-3-10" id="h62-3-10" class="i">+2, &#39;b&#39;, 2
</a><a href="#h62-3-11" id="h62-3-11" class="i">+3, &#39;foo&#39;, NULL
</a> 
 # Updating by arbitrary predicate over full scan.
 &gt; BEGIN
<a href="#h62-4" id="h62-4" class="h">@@ -69,11 +69,11 @@ Update: name (value=foo)
</a> &gt; SELECT * FROM name
 &gt; ROLLBACK
 ---
<a href="#h62-4-3" id="h62-4-3" class="d">-Update: name (value=foo)
</a><a href="#h62-4-4" id="h62-4-4" class="d">-└─ Scan: name (name.id &gt; 3 OR name.id = 3 OR name.value LIKE a IS NULL)
</a><a href="#h62-4-5" id="h62-4-5" class="d">-1, a, 1
</a><a href="#h62-4-6" id="h62-4-6" class="d">-2, b, 2
</a><a href="#h62-4-7" id="h62-4-7" class="d">-3, foo, NULL
</a><a href="#h62-4-8" id="h62-4-8" class="i">+Update: name (value=&#39;foo&#39;)
</a><a href="#h62-4-9" id="h62-4-9" class="i">+└─ Scan: name (name.id &gt; 3 OR name.id = 3 OR name.value LIKE &#39;a&#39; IS NULL)
</a><a href="#h62-4-10" id="h62-4-10" class="i">+1, &#39;a&#39;, 1
</a><a href="#h62-4-11" id="h62-4-11" class="i">+2, &#39;b&#39;, 2
</a><a href="#h62-4-12" id="h62-4-12" class="i">+3, &#39;foo&#39;, NULL
</a> 
 # Non-boolean predicates error, except NULL which is equivalent to FALSE.
 !&gt; UPDATE name SET value = &#39;foo&#39; WHERE 0
<a href="#h62-5" id="h62-5" class="h">@@ -87,15 +87,15 @@ Error: invalid input: filter returned 0, expected boolean
</a> Error: invalid input: filter returned 1, expected boolean
 Error: invalid input: filter returned 3.14, expected boolean
 Error: invalid input: filter returned NaN, expected boolean
<a href="#h62-5-3" id="h62-5-3" class="d">-Error: invalid input: filter returned , expected boolean
</a><a href="#h62-5-4" id="h62-5-4" class="i">+Error: invalid input: filter returned &#39;&#39;, expected boolean
</a> Error: invalid input: unexpected end of string literal
 
 &gt; UPDATE name SET value = &#39;foo&#39; WHERE NULL
 &gt; SELECT * FROM name
 ---
<a href="#h62-5-10" id="h62-5-10" class="d">-1, a, 1
</a><a href="#h62-5-11" id="h62-5-11" class="d">-2, b, 2
</a><a href="#h62-5-12" id="h62-5-12" class="d">-3, c, NULL
</a><a href="#h62-5-13" id="h62-5-13" class="i">+1, &#39;a&#39;, 1
</a><a href="#h62-5-14" id="h62-5-14" class="i">+2, &#39;b&#39;, 2
</a><a href="#h62-5-15" id="h62-5-15" class="i">+3, &#39;c&#39;, NULL
</a> 
 # Bare WHERE errors.
 !&gt; UPDATE name SET value = &#39;foo&#39; WHERE
<b>diff --git a/<a id="h63" href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a> b/<a href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -288,7 +288,7 @@ impl std::fmt::Display for Value {
</a>             Self::Boolean(false) =&gt; f.write_str(&quot;FALSE&quot;),
             Self::Integer(integer) =&gt; integer.fmt(f),
             Self::Float(float) =&gt; write!(f, &quot;{float:?}&quot;),
<a href="#h63-0-3" id="h63-0-3" class="d">-            Self::String(string) =&gt; string.fmt(f),
</a><a href="#h63-0-4" id="h63-0-4" class="i">+            Self::String(string) =&gt; write!(f, &quot;&#39;{}&#39;&quot;, string.escape_debug()),
</a>         }
     }
 }
</pre>
</div>
</body>
</html>
