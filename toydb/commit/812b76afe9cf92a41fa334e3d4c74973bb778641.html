<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: added LIKE operator - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/812b76afe9cf92a41fa334e3d4c74973bb778641.html">812b76afe9cf92a41fa334e3d4c74973bb778641</a>
<b>parent</b> <a href="../commit/5fef150bfb8445a53505f856d310101fcab3fd32.html">5fef150bfb8445a53505f856d310101fcab3fd32</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Thu,  2 Jan 2020 17:20:34 +0100

sql: added LIKE operator

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">Cargo.lock</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">Cargo.toml</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">docs/README.md</a></td><td> | </td><td class="num">5</td><td><span class="i">+++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/error.rs</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/lib.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/parser/ast.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/parser/lexer.rs</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/planner/mod.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/tests/expression.rs</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/types/expression.rs</a></td><td> | </td><td class="num">22</td><td><span class="i">++++++++++++++++++++++</span><span class="d"></span></td></tr>
</table></pre><pre>11 files changed, 63 insertions(+), 3 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/Cargo.lock.html">Cargo.lock</a> b/<a href="../file/Cargo.lock.html">Cargo.lock</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1339,6 +1339,7 @@ dependencies = [
</a>  &quot;protobuf 2.8.1 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
  &quot;protoc-rust-grpc 0.6.1 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
  &quot;rand 0.7.2 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
<a href="#h0-0-3" id="h0-0-3" class="i">+ &quot;regex 1.3.1 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
</a>  &quot;rmp-serde 0.14.0 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
  &quot;rustyline 5.0.4 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
  &quot;serde 1.0.102 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
<b>diff --git a/<a id="h1" href="../file/Cargo.toml.html">Cargo.toml</a> b/<a href="../file/Cargo.toml.html">Cargo.toml</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -14,6 +14,7 @@ grpc = &quot;~0.6.1&quot;
</a> log = &quot;~0.4.6&quot;
 protobuf = &quot;~2.8.1&quot;
 rand = &quot;~0.7.2&quot;
<a href="#h1-0-3" id="h1-0-3" class="i">+regex = &quot;~1.3.1&quot;
</a> rmp-serde = &quot;~0.14.0&quot;
 rustyline = &quot;~5.0.0&quot;
 serde = &quot;~1.0.91&quot;
<b>diff --git a/<a id="h2" href="../file/docs/README.md.html">docs/README.md</a> b/<a href="../file/docs/README.md.html">docs/README.md</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -19,7 +19,7 @@ Numeric types are not interchangable when stored; a float value cannot be stored
</a> 
 Keywords are reserved words that have special meaning in SQL statements, such as `SELECT`. These cannot be used as identifiers, e.g. table names. Keywords are case-insensitive. The complete list of keywords is:
 
<a href="#h2-0-3" id="h2-0-3" class="d">-`AS`, `ASC`, `AND`, `BEGIN`, `BOOL`, `BOOLEAN`, `BY`, `CHAR`, `COMMIT`, `CREATE`, `DELETE`, `DESC`, `DOUBLE`, `DROP`, `FALSE`, `FLOAT`, `FROM`, `INFINITY`, `INSERT`, `INT`, `INTEGER`, `INTO`, `IS`, `KEY`, `LIMIT`, `NAN`, `NOT`, `NULL`, `OF`, `OFFSET`, `ONLY`, `OR`, `ORDER`, `PRIMARY`, `READ`, `ROLLBACK`, `SELECT`, `SET`, `STRING`, `SYSTEM`, `TABLE`, `TEXT`, `TIME`, `TRANSACTION`, `TRUE`, `UPDATE`, `VALUES`, `VARCHAR`, `WHERE`, `WRITE`
</a><a href="#h2-0-4" id="h2-0-4" class="i">+`AS`, `ASC`, `AND`, `BEGIN`, `BOOL`, `BOOLEAN`, `BY`, `CHAR`, `COMMIT`, `CREATE`, `DELETE`, `DESC`, `DOUBLE`, `DROP`, `FALSE`, `FLOAT`, `FROM`, `INFINITY`, `INSERT`, `INT`, `INTEGER`, `INTO`, `IS`, `KEY`, `LIKE`, `LIMIT`, `NAN`, `NOT`, `NULL`, `OF`, `OFFSET`, `ONLY`, `OR`, `ORDER`, `PRIMARY`, `READ`, `ROLLBACK`, `SELECT`, `SET`, `STRING`, `SYSTEM`, `TABLE`, `TEXT`, `TIME`, `TRANSACTION`, `TRUE`, `UPDATE`, `VALUES`, `VARCHAR`, `WHERE`, `WRITE`
</a> 
 ### Identifiers
 
<a href="#h2-1" id="h2-1" class="h">@@ -97,6 +97,7 @@ Binary operators:
</a> * `&gt;=`: greater than or equal, e.g. `1 &gt;= 1` yields `TRUE`.
 * `&lt;`: lesser than, e.g. `1 &lt; 2` yields `TRUE`.
 * `&lt;=`: lesser than or equal, e.g. `1 &lt;= 1` yields `TRUE`.
<a href="#h2-1-3" id="h2-1-3" class="i">+* `LIKE`: compares a string with the given pattern, using `%` as multi-character wildcard and `_` as single-character wildcard, returning `TRUE` if the string matches the pattern - e.g. `&#39;abc&#39; LIKE &#39;a%&#39;` yields `TRUE`.  Literal `%` and `_` can be escaped as `%%` and `__`.
</a> 
 Unary operators:
 
<a href="#h2-2" id="h2-2" class="h">@@ -105,7 +106,7 @@ Unary operators:
</a> 
 #### Mathematical operators
 
<a href="#h2-2-3" id="h2-2-3" class="d">-Mathematical operators apply standard math operations on numeric (`INTEGER` or `FLOAT`) operands. If either operand is a `FLOAT`, both operands are converted to `FLOAT` and the result is a `FLOAT`. The special values `INFINITY` and `NAN` are handled according to the IEEE 754 `binary64` spec.
</a><a href="#h2-2-4" id="h2-2-4" class="i">+Mathematical operators apply standard math operations on numeric (`INTEGER` or `FLOAT`) operands. If either operand is a `FLOAT`, both operands are converted to `FLOAT` and the result is a `FLOAT`. If either operand is `NULL`, the result is `NULL`. The special values `INFINITY` and `NAN` are handled according to the IEEE 754 `binary64` spec.
</a> 
 For `INTEGER` operands, failure conditions such as overflow and division by zero yield an error, while for `FLOAT` operands these return `INFINITY` or `NAN` as appropriate.
 
<b>diff --git a/<a id="h3" href="../file/src/error.rs.html">src/error.rs</a> b/<a href="../file/src/error.rs.html">src/error.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -71,6 +71,12 @@ impl From&lt;log::SetLoggerError&gt; for Error {
</a>     }
 }
 
<a href="#h3-0-3" id="h3-0-3" class="i">+impl From&lt;regex::Error&gt; for Error {
</a><a href="#h3-0-4" id="h3-0-4" class="i">+    fn from(err: regex::Error) -&gt; Self {
</a><a href="#h3-0-5" id="h3-0-5" class="i">+        Error::Value(err.to_string())
</a><a href="#h3-0-6" id="h3-0-6" class="i">+    }
</a><a href="#h3-0-7" id="h3-0-7" class="i">+}
</a><a href="#h3-0-8" id="h3-0-8" class="i">+
</a> impl From&lt;rmps::decode::Error&gt; for Error {
     fn from(err: rmps::decode::Error) -&gt; Self {
         Error::IO(err.to_string())
<b>diff --git a/<a id="h4" href="../file/src/lib.rs.html">src/lib.rs</a> b/<a href="../file/src/lib.rs.html">src/lib.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -12,6 +12,7 @@ extern crate httpbis;
</a> #[macro_use]
 extern crate log;
 extern crate rand;
<a href="#h4-0-3" id="h4-0-3" class="i">+extern crate regex;
</a> extern crate rmp_serde as rmps;
 extern crate rustyline;
 extern crate serde;
<b>diff --git a/<a id="h5" href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a> b/<a href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -117,6 +117,7 @@ pub enum Operation {
</a>     CompareLT(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
     CompareLTE(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
     CompareNull(Box&lt;Expression&gt;),
<a href="#h5-0-3" id="h5-0-3" class="i">+    Like(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a> 
     // Mathematical operators
     Add(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
<b>diff --git a/<a id="h6" href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a> b/<a href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -93,6 +93,7 @@ pub enum Keyword {
</a>     Into,
     Is,
     Key,
<a href="#h6-0-3" id="h6-0-3" class="i">+    Like,
</a>     Limit,
     NaN,
     Not,
<a href="#h6-1" id="h6-1" class="h">@@ -148,6 +149,7 @@ impl Keyword {
</a>             &quot;INTO&quot; =&gt; Self::Into,
             &quot;IS&quot; =&gt; Self::Is,
             &quot;KEY&quot; =&gt; Self::Key,
<a href="#h6-1-3" id="h6-1-3" class="i">+            &quot;LIKE&quot; =&gt; Self::Like,
</a>             &quot;LIMIT&quot; =&gt; Self::Limit,
             &quot;NAN&quot; =&gt; Self::NaN,
             &quot;NOT&quot; =&gt; Self::Not,
<a href="#h6-2" id="h6-2" class="h">@@ -204,6 +206,7 @@ impl Keyword {
</a>             Self::Into =&gt; &quot;INTO&quot;,
             Self::Is =&gt; &quot;IS&quot;,
             Self::Key =&gt; &quot;KEY&quot;,
<a href="#h6-2-3" id="h6-2-3" class="i">+            Self::Like =&gt; &quot;LIKE&quot;,
</a>             Self::Limit =&gt; &quot;LIMIT&quot;,
             Self::NaN =&gt; &quot;NAN&quot;,
             Self::Not =&gt; &quot;NOT&quot;,
<b>diff --git a/<a id="h7" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -509,6 +509,7 @@ enum InfixOperator {
</a>     CompareLTE,
     Divide,
     Exponentiate,
<a href="#h7-0-3" id="h7-0-3" class="i">+    Like,
</a>     Modulo,
     Multiply,
     Or,
<a href="#h7-1" id="h7-1" class="h">@@ -529,6 +530,7 @@ impl InfixOperator {
</a>             Self::CompareLTE =&gt; ast::Operation::CompareLTE(lhs, rhs),
             Self::Divide =&gt; ast::Operation::Divide(lhs, rhs),
             Self::Exponentiate =&gt; ast::Operation::Exponentiate(lhs, rhs),
<a href="#h7-1-3" id="h7-1-3" class="i">+            Self::Like =&gt; ast::Operation::Like(lhs, rhs),
</a>             Self::Modulo =&gt; ast::Operation::Modulo(lhs, rhs),
             Self::Multiply =&gt; ast::Operation::Multiply(lhs, rhs),
             Self::Or =&gt; ast::Operation::Or(lhs, rhs),
<a href="#h7-2" id="h7-2" class="h">@@ -547,6 +549,7 @@ impl Operator for InfixOperator {
</a>             Token::GreaterThan =&gt; Self::CompareGT,
             Token::GreaterThanOrEqual =&gt; Self::CompareGTE,
             Token::Keyword(Keyword::And) =&gt; Self::And,
<a href="#h7-2-3" id="h7-2-3" class="i">+            Token::Keyword(Keyword::Like) =&gt; Self::Like,
</a>             Token::Keyword(Keyword::Or) =&gt; Self::Or,
             Token::LessOrGreaterThan =&gt; Self::CompareNE,
             Token::LessThan =&gt; Self::CompareLT,
<a href="#h7-3" id="h7-3" class="h">@@ -575,7 +578,7 @@ impl Operator for InfixOperator {
</a>         match self {
             Self::Or =&gt; 1,
             Self::And =&gt; 2,
<a href="#h7-3-3" id="h7-3-3" class="d">-            Self::CompareEQ | Self::CompareNE =&gt; 3,
</a><a href="#h7-3-4" id="h7-3-4" class="i">+            Self::CompareEQ | Self::CompareNE | Self::Like =&gt; 3,
</a>             Self::CompareGT | Self::CompareGTE | Self::CompareLT | Self::CompareLTE =&gt; 4,
             Self::Add | Self::Subtract =&gt; 5,
             Self::Multiply | Self::Divide | Self::Modulo =&gt; 6,
<b>diff --git a/<a id="h8" href="../file/src/sql/planner/mod.rs.html">src/sql/planner/mod.rs</a> b/<a href="../file/src/sql/planner/mod.rs.html">src/sql/planner/mod.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -179,6 +179,7 @@ impl From&lt;ast::Expression&gt; for Expression {
</a>                 ast::Operation::CompareLT(lhs, rhs) =&gt; Self::CompareLT(lhs.into(), rhs.into()),
                 ast::Operation::CompareLTE(lhs, rhs) =&gt; Self::CompareLTE(lhs.into(), rhs.into()),
                 ast::Operation::CompareNull(expr) =&gt; Self::CompareNull(expr.into()),
<a href="#h8-0-3" id="h8-0-3" class="i">+                ast::Operation::Like(lhs, rhs) =&gt; Self::Like(lhs.into(), rhs.into()),
</a> 
                 // Mathematical operators
                 ast::Operation::Assert(expr) =&gt; Self::Assert(expr.into()),
<b>diff --git a/<a id="h9" href="../file/src/sql/tests/expression.rs.html">src/sql/tests/expression.rs</a> b/<a href="../file/src/sql/tests/expression.rs.html">src/sql/tests/expression.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -283,6 +283,26 @@ test_expr! {
</a>     op_lte_string_unicode_not: &quot;&#39;🙁&#39; &lt;= &#39;😀&#39;&quot; =&gt; Ok(Boolean(false)),
     op_lte_conflict: &quot;1 &lt;= &#39;a&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t compare 1 and a&quot;.into())),
 
<a href="#h9-0-3" id="h9-0-3" class="i">+    op_like_percent: &quot;&#39;abcde&#39; LIKE &#39;a%e&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-4" id="h9-0-4" class="i">+    op_like_percent_escape: &quot;&#39;ab%de&#39; LIKE &#39;ab%%de&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-5" id="h9-0-5" class="i">+    op_like_percent_escape_not: &quot;&#39;ab%de&#39; LIKE &#39;a%%e&#39;&quot; =&gt; Ok(Boolean(false)),
</a><a href="#h9-0-6" id="h9-0-6" class="i">+    op_like_percent_none: &quot;&#39;abcde&#39; LIKE &#39;abc%de&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-7" id="h9-0-7" class="i">+    op_like_percent_prefix: &quot;&#39;abcde&#39; LIKE &#39;abc%&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-8" id="h9-0-8" class="i">+    op_like_percent_suffix: &quot;&#39;abcde&#39; LIKE &#39;%cde&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-9" id="h9-0-9" class="i">+    op_like_percent_not: &quot;&#39;abcdef&#39; LIKE &#39;a%e&#39;&quot; =&gt; Ok(Boolean(false)),
</a><a href="#h9-0-10" id="h9-0-10" class="i">+    op_like_underscore: &quot;&#39;abc&#39; LIKE &#39;a_c&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-11" id="h9-0-11" class="i">+    op_like_underscore_not: &quot;&#39;abb&#39; LIKE &#39;a_c&#39;&quot; =&gt; Ok(Boolean(false)),
</a><a href="#h9-0-12" id="h9-0-12" class="i">+    op_like_underscore_escape: &quot;&#39;ab_de&#39; LIKE &#39;ab__de&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-13" id="h9-0-13" class="i">+    op_like_underscore_escape_not: &quot;&#39;abcde&#39; LIKE &#39;ab__de&#39;&quot; =&gt; Ok(Boolean(false)),
</a><a href="#h9-0-14" id="h9-0-14" class="i">+    op_like_star: &quot;&#39;abcde&#39; LIKE &#39;a*bcde&#39;&quot; =&gt; Ok(Boolean(false)),
</a><a href="#h9-0-15" id="h9-0-15" class="i">+    op_like_question: &quot;&#39;abc&#39; LIKE &#39;a?bc&#39;&quot; =&gt; Ok(Boolean(false)),
</a><a href="#h9-0-16" id="h9-0-16" class="i">+    op_like_multi: &quot;&#39;abcdefghijklmno&#39; LIKE &#39;a_c%f%i_kl%mno&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-17" id="h9-0-17" class="i">+    op_like_case: &quot;&#39;abcde&#39; LIKE &#39;A%E&#39;&quot; =&gt; Ok(Boolean(false)),
</a><a href="#h9-0-18" id="h9-0-18" class="i">+    op_like_eq: &quot;&#39;abc&#39; LIKE &#39;abc&#39;&quot; =&gt; Ok(Boolean(true)),
</a><a href="#h9-0-19" id="h9-0-19" class="i">+    op_like_neq: &quot;&#39;xyz&#39; LIKE &#39;abc&#39;&quot; =&gt; Ok(Boolean(false)),
</a><a href="#h9-0-20" id="h9-0-20" class="i">+    op_like_null: &quot;&#39;abc&#39; LIKE NULL&quot; =&gt; Ok(Null),
</a><a href="#h9-0-21" id="h9-0-21" class="i">+    op_like_null_lhs: &quot;NULL LIKE &#39;abc&#39;&quot; =&gt; Ok(Null),
</a><a href="#h9-0-22" id="h9-0-22" class="i">+
</a>     op_null: &quot;NULL IS NULL&quot; =&gt; Ok(Boolean(true)),
     op_null_not: &quot;NULL IS NOT NULL&quot; =&gt; Ok(Boolean(false)),
     op_null_bool: &quot;TRUE IS NULL&quot; =&gt; Ok(Boolean(false)),
<b>diff --git a/<a id="h10" href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a> b/<a href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -1,6 +1,7 @@
</a> use super::Value;
 use crate::Error;
 
<a href="#h10-0-3" id="h10-0-3" class="i">+use regex::Regex;
</a> use std::collections::HashMap;
 
 /// An expression, made up of constants and operations
<a href="#h10-1" id="h10-1" class="h">@@ -23,6 +24,7 @@ pub enum Expression {
</a>     CompareLT(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
     CompareLTE(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
     CompareNull(Box&lt;Expression&gt;),
<a href="#h10-1-3" id="h10-1-3" class="i">+    Like(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a> 
     // Mathematical operations
     Add(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
<a href="#h10-2" id="h10-2" class="h">@@ -154,6 +156,22 @@ impl Expression {
</a>                 Null =&gt; Boolean(true),
                 _ =&gt; Boolean(false),
             },
<a href="#h10-2-3" id="h10-2-3" class="i">+            Self::Like(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
</a><a href="#h10-2-4" id="h10-2-4" class="i">+                (String(lhs), String(rhs)) =&gt; Boolean(
</a><a href="#h10-2-5" id="h10-2-5" class="i">+                    Regex::new(&amp;format!(
</a><a href="#h10-2-6" id="h10-2-6" class="i">+                        &quot;^{}$&quot;,
</a><a href="#h10-2-7" id="h10-2-7" class="i">+                        regex::escape(&amp;rhs)
</a><a href="#h10-2-8" id="h10-2-8" class="i">+                            .replace(&quot;%&quot;, &quot;.*&quot;)
</a><a href="#h10-2-9" id="h10-2-9" class="i">+                            .replace(&quot;.*.*&quot;, &quot;%&quot;)
</a><a href="#h10-2-10" id="h10-2-10" class="i">+                            .replace(&quot;_&quot;, &quot;.&quot;)
</a><a href="#h10-2-11" id="h10-2-11" class="i">+                            .replace(&quot;..&quot;, &quot;_&quot;)
</a><a href="#h10-2-12" id="h10-2-12" class="i">+                    ))?
</a><a href="#h10-2-13" id="h10-2-13" class="i">+                    .is_match(&amp;lhs),
</a><a href="#h10-2-14" id="h10-2-14" class="i">+                ),
</a><a href="#h10-2-15" id="h10-2-15" class="i">+                (String(_), Null) =&gt; Null,
</a><a href="#h10-2-16" id="h10-2-16" class="i">+                (Null, String(_)) =&gt; Null,
</a><a href="#h10-2-17" id="h10-2-17" class="i">+                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t LIKE {} and {}&quot;, lhs, rhs))),
</a><a href="#h10-2-18" id="h10-2-18" class="i">+            },
</a> 
             // Mathematical operations
             Self::Add(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
<a href="#h10-3" id="h10-3" class="h">@@ -327,6 +345,9 @@ impl Expression {
</a>                 Self::CompareNE(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
             }
             Self::CompareNull(expr) =&gt; Self::CompareNull(expr.transform(pre, post)?.into()),
<a href="#h10-3-3" id="h10-3-3" class="i">+            Self::Like(lhs, rhs) =&gt; {
</a><a href="#h10-3-4" id="h10-3-4" class="i">+                Self::Like(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h10-3-5" id="h10-3-5" class="i">+            }
</a> 
             // Mathematical operations
             Self::Add(lhs, rhs) =&gt; {
<a href="#h10-4" id="h10-4" class="h">@@ -369,6 +390,7 @@ impl Expression {
</a>             | Self::CompareNE(lhs, rhs)
             | Self::Divide(lhs, rhs)
             | Self::Exponentiate(lhs, rhs)
<a href="#h10-4-3" id="h10-4-3" class="i">+            | Self::Like(lhs, rhs)
</a>             | Self::Modulo(lhs, rhs)
             | Self::Multiply(lhs, rhs)
             | Self::Or(lhs, rhs)
</pre>
</div>
</body>
</html>
