<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: don&#39;t propagate columns during execution - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/cdbd23420279a6dd14030fca4e69839b337cf583.html">cdbd23420279a6dd14030fca4e69839b337cf583</a>
<b>parent</b> <a href="../commit/9b075288551abc163af6b3e2e6e287697e4391fc.html">9b075288551abc163af6b3e2e6e287697e4391fc</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sat, 22 Jun 2024 19:00:16 +0200

sql: don&#39;t propagate columns during execution

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/engine/session.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/execution/aggregate.rs</a></td><td> | </td><td class="num">33</td><td><span class="i">+++++++++++</span><span class="d">----------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/execution/execute.rs</a></td><td> | </td><td class="num">100</td><td><span class="i">++++++++++++++++++++++</span><span class="d">---------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/execution/join.rs</a></td><td> | </td><td class="num">33</td><td><span class="i">++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/execution/mod.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/execution/source.rs</a></td><td> | </td><td class="num">47</td><td><span class="i">+++++++++++++</span><span class="d">----------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/execution/transform.rs</a></td><td> | </td><td class="num">118</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d">--------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/execution/write.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/planner/optimizer.rs</a></td><td> | </td><td class="num">38</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/planner/plan.rs</a></td><td> | </td><td class="num">107</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/planner/planner.rs</a></td><td> | </td><td class="num">12</td><td><span class="i">+++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">tests/e2e/client.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query/agg_boolean</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/query/agg_boolean_null</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/agg_const</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/agg_const_from</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/agg_count_star</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/agg_expr</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/agg_float</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/agg_float_null</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/agg_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/agg_integer_null</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/agg_string</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/agg_string_null</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/field_aliased</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/field_qualified_multi</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/from_multiple</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/group_expr</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/group_expr_aggr</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/group_expr_aggr_selfref</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/group_expr_aliased</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/group_expr_both</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/query/group_expr_multigroup</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/query/group_expr_select</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/query/group_join</a></td><td> | </td><td class="num">32</td><td><span class="i">++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/query/group_noaggregate</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/query/group_noselect</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/query/group_simple</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/query/having</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">tests/sql/query/join_cross</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">35</td><td><span class="i">++++++++</span><span class="d">---------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">tests/sql/query/join_cross_multi</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">tests/sql/query/join_inner</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">tests/sql/query/join_inner_implicit</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">tests/sql/query/join_inner_index_transverse</a></td><td> | </td><td class="num">145</td><td><span class="i">++++++++++++</span><span class="d">-------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">tests/sql/query/join_inner_index_transverse_where</a></td><td> | </td><td class="num">145</td><td><span class="i">++++++++++++</span><span class="d">-------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">tests/sql/query/join_inner_multi</a></td><td> | </td><td class="num">60</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">--------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">219</td><td><span class="i">+++++++++++++++</span><span class="d">----------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">tests/sql/query/join_inner_multi_same</a></td><td> | </td><td class="num">90</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">tests/sql/query/join_inner_on_aliased</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">tests/sql/query/join_inner_on_false</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">tests/sql/query/join_inner_on_multi</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">tests/sql/query/join_inner_on_true</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">tests/sql/query/join_inner_on_where</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">tests/sql/query/join_left</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">tests/sql/query/join_left_all</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">tests/sql/query/join_left_outer</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">tests/sql/query/join_left_truncate</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">tests/sql/query/join_right</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">tests/sql/query/join_right_all</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">tests/sql/query/join_right_outer</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">tests/sql/query/join_right_truncate</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">tests/sql/query/order_aggregate</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">tests/sql/query/order_aggregate_noselect</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">tests/sql/query/order_group_by_noselect</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">33</td><td><span class="i">++++++</span><span class="d">---------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">29</td><td><span class="i">++++</span><span class="d">-------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">tests/sql/query/where_index</a></td><td> | </td><td class="num">80</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">tests/sql/query/where_index_or</a></td><td> | </td><td class="num">80</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h77">tests/sql/query/where_index_or_partial</a></td><td> | </td><td class="num">80</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h78">tests/sql/query/where_join_inner</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h79">tests/sql/query/where_pk</a></td><td> | </td><td class="num">80</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h80">tests/sql/query/where_pk_or</a></td><td> | </td><td class="num">80</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h81">tests/sql/query/where_pk_or_partial</a></td><td> | </td><td class="num">80</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
</table></pre><pre>82 files changed, 725 insertions(+), 1594 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/engine/session.rs.html">src/sql/engine/session.rs</a> b/<a href="../file/src/sql/engine/session.rs.html">src/sql/engine/session.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -154,9 +154,9 @@ impl TryFrom&lt;ExecutionResult&gt; for StatementResult {
</a>             ExecutionResult::Delete { count } =&gt; Self::Delete { count },
             ExecutionResult::Insert { count } =&gt; Self::Insert { count },
             ExecutionResult::Update { count } =&gt; Self::Update { count },
<a href="#h0-0-3" id="h0-0-3" class="d">-            ExecutionResult::Select { iter, labels } =&gt; {
</a><a href="#h0-0-4" id="h0-0-4" class="i">+            ExecutionResult::Select { rows, labels } =&gt; {
</a>                 // We buffer the entire set of rows, for simplicity.
<a href="#h0-0-6" id="h0-0-6" class="d">-                Self::Select { columns: labels, rows: iter.rows.collect::&lt;Result&lt;_&gt;&gt;()? }
</a><a href="#h0-0-7" id="h0-0-7" class="i">+                Self::Select { columns: labels, rows: rows.collect::&lt;Result&lt;_&gt;&gt;()? }
</a>             }
         })
     }
<b>diff --git a/<a id="h1" href="../file/src/sql/execution/aggregate.rs.html">src/sql/execution/aggregate.rs</a> b/<a href="../file/src/sql/execution/aggregate.rs.html">src/sql/execution/aggregate.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -1,15 +1,15 @@
</a><a href="#h1-0-0" id="h1-0-0" class="d">-use super::QueryIterator;
</a> use crate::error::Result;
 use crate::sql::planner::Aggregate;
<a href="#h1-0-3" id="h1-0-3" class="d">-use crate::sql::types::{Row, Value};
</a><a href="#h1-0-4" id="h1-0-4" class="i">+use crate::sql::types::{Row, Rows, Value};
</a> 
 use std::collections::HashMap;
 
 /// Aggregates rows (i.e. GROUP BY).
 pub(super) fn aggregate(
<a href="#h1-0-10" id="h1-0-10" class="d">-    mut source: QueryIterator,
</a><a href="#h1-0-11" id="h1-0-11" class="i">+    mut source: Rows,
</a>     aggregates: Vec&lt;Aggregate&gt;,
<a href="#h1-0-13" id="h1-0-13" class="d">-) -&gt; Result&lt;QueryIterator&gt; {
</a><a href="#h1-0-14" id="h1-0-14" class="i">+    group_by: usize,
</a><a href="#h1-0-15" id="h1-0-15" class="i">+) -&gt; Result&lt;Rows&gt; {
</a>     // Aggregate rows from source, grouped by non-aggregation columns. For
     // example, SELECT a, b, SUM(c), MAX(d) ... uses a,b as grouping buckets and
     // SUM(c),MAX(d) as accumulators for each a,b bucket.
<a href="#h1-1" id="h1-1" class="h">@@ -25,28 +25,17 @@ pub(super) fn aggregate(
</a> 
     // If there were no rows and no group-by columns, return a row of empty
     // accumulators, e.g.: SELECT COUNT(*) FROM t WHERE FALSE
<a href="#h1-1-3" id="h1-1-3" class="d">-    if accumulators.is_empty() &amp;&amp; aggregates.len() == source.columns.len() {
</a><a href="#h1-1-4" id="h1-1-4" class="i">+    if accumulators.is_empty() &amp;&amp; group_by == 0 {
</a>         accumulators.insert(Vec::new(), aggregates.iter().map(Accumulator::new).collect());
     }
 
<a href="#h1-1-8" id="h1-1-8" class="d">-    // Pass through non-aggregation column labels from the source.
</a><a href="#h1-1-9" id="h1-1-9" class="d">-    let columns = source
</a><a href="#h1-1-10" id="h1-1-10" class="d">-        .columns
</a><a href="#h1-1-11" id="h1-1-11" class="d">-        .into_iter()
</a><a href="#h1-1-12" id="h1-1-12" class="d">-        .enumerate()
</a><a href="#h1-1-13" id="h1-1-13" class="d">-        .map(|(i, label)| if i &lt; aggregates.len() { None } else { label })
</a><a href="#h1-1-14" id="h1-1-14" class="d">-        .collect();
</a><a href="#h1-1-15" id="h1-1-15" class="d">-
</a>     // Emit the aggregate and row values for each row bucket.
<a href="#h1-1-17" id="h1-1-17" class="d">-    Ok(QueryIterator {
</a><a href="#h1-1-18" id="h1-1-18" class="d">-        columns,
</a><a href="#h1-1-19" id="h1-1-19" class="d">-        rows: Box::new(accumulators.into_iter().map(|(row, accs)| {
</a><a href="#h1-1-20" id="h1-1-20" class="d">-            accs.into_iter()
</a><a href="#h1-1-21" id="h1-1-21" class="d">-                .map(|acc| acc.value())
</a><a href="#h1-1-22" id="h1-1-22" class="d">-                .chain(row.into_iter().map(Ok))
</a><a href="#h1-1-23" id="h1-1-23" class="d">-                .collect::&lt;Result&lt;_&gt;&gt;()
</a><a href="#h1-1-24" id="h1-1-24" class="d">-        })),
</a><a href="#h1-1-25" id="h1-1-25" class="d">-    })
</a><a href="#h1-1-26" id="h1-1-26" class="i">+    Ok(Box::new(accumulators.into_iter().map(|(row, accs)| {
</a><a href="#h1-1-27" id="h1-1-27" class="i">+        accs.into_iter()
</a><a href="#h1-1-28" id="h1-1-28" class="i">+            .map(|acc| acc.value())
</a><a href="#h1-1-29" id="h1-1-29" class="i">+            .chain(row.into_iter().map(Ok))
</a><a href="#h1-1-30" id="h1-1-30" class="i">+            .collect::&lt;Result&lt;_&gt;&gt;()
</a><a href="#h1-1-31" id="h1-1-31" class="i">+    })))
</a> }
 
 /// Accumulates aggregate values. Uses an enum rather than a trait since we need
<b>diff --git a/<a id="h2" href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a> b/<a href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -6,7 +6,7 @@ use super::write;
</a> use crate::error::Result;
 use crate::sql::engine::{Catalog, Transaction};
 use crate::sql::planner::{Node, Plan};
<a href="#h2-0-3" id="h2-0-3" class="d">-use crate::sql::types::{Label, Row, Rows};
</a><a href="#h2-0-4" id="h2-0-4" class="i">+use crate::sql::types::{Label, Rows};
</a> 
 /// Executes a plan, returning an execution result.
 ///
<a href="#h2-1" id="h2-1" class="h">@@ -43,7 +43,7 @@ pub fn execute_plan(
</a> 
         Plan::Select { root, labels } =&gt; {
             let iter = execute(root, txn)?;
<a href="#h2-1-3" id="h2-1-3" class="d">-            ExecutionResult::Select { iter, labels }
</a><a href="#h2-1-4" id="h2-1-4" class="i">+            ExecutionResult::Select { rows: iter, labels }
</a>         }
 
         Plan::Update { table, primary_key, source, expressions } =&gt; {
<a href="#h2-2" id="h2-2" class="h">@@ -55,14 +55,14 @@ pub fn execute_plan(
</a>     })
 }
 
<a href="#h2-2-3" id="h2-2-3" class="d">-/// Recursively executes a query plan node, returning a query iterator.
</a><a href="#h2-2-4" id="h2-2-4" class="i">+/// Recursively executes a query plan node, returning a row iterator.
</a> ///
 /// TODO: since iterators are lazy, make this infallible if possible.
<a href="#h2-2-7" id="h2-2-7" class="d">-pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;QueryIterator&gt; {
</a><a href="#h2-2-8" id="h2-2-8" class="i">+pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;Rows&gt; {
</a>     match node {
<a href="#h2-2-10" id="h2-2-10" class="d">-        Node::Aggregation { source, aggregates } =&gt; {
</a><a href="#h2-2-11" id="h2-2-11" class="i">+        Node::Aggregation { source, aggregates, group_by } =&gt; {
</a>             let source = execute(*source, txn)?;
<a href="#h2-2-13" id="h2-2-13" class="d">-            aggregate::aggregate(source, aggregates)
</a><a href="#h2-2-14" id="h2-2-14" class="i">+            aggregate::aggregate(source, aggregates, group_by)
</a>         }
 
         Node::Filter { source, predicate } =&gt; {
<a href="#h2-3" id="h2-3" class="h">@@ -70,27 +70,36 @@ pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;QueryIterator&gt; {
</a>             Ok(transform::filter(source, predicate))
         }
 
<a href="#h2-3-3" id="h2-3-3" class="d">-        Node::HashJoin { left, left_field, right, right_field, outer } =&gt; {
</a><a href="#h2-3-4" id="h2-3-4" class="i">+        Node::HashJoin {
</a><a href="#h2-3-5" id="h2-3-5" class="i">+            left,
</a><a href="#h2-3-6" id="h2-3-6" class="i">+            left_field,
</a><a href="#h2-3-7" id="h2-3-7" class="i">+            left_label: _,
</a><a href="#h2-3-8" id="h2-3-8" class="i">+            right,
</a><a href="#h2-3-9" id="h2-3-9" class="i">+            right_field,
</a><a href="#h2-3-10" id="h2-3-10" class="i">+            right_label: _,
</a><a href="#h2-3-11" id="h2-3-11" class="i">+            right_size,
</a><a href="#h2-3-12" id="h2-3-12" class="i">+            outer,
</a><a href="#h2-3-13" id="h2-3-13" class="i">+        } =&gt; {
</a>             let left = execute(*left, txn)?;
             let right = execute(*right, txn)?;
<a href="#h2-3-16" id="h2-3-16" class="d">-            join::hash(left, left_field.0, right, right_field.0, outer)
</a><a href="#h2-3-17" id="h2-3-17" class="i">+            join::hash(left, left_field, right, right_field, right_size, outer)
</a>         }
 
<a href="#h2-3-20" id="h2-3-20" class="d">-        Node::IndexLookup { table, alias: _, column, values } =&gt; {
</a><a href="#h2-3-21" id="h2-3-21" class="i">+        Node::IndexLookup { table, column, values, alias: _ } =&gt; {
</a>             source::lookup_index(txn, table, column, values)
         }
 
<a href="#h2-3-25" id="h2-3-25" class="d">-        Node::KeyLookup { table, alias: _, keys } =&gt; source::lookup_key(txn, table, keys),
</a><a href="#h2-3-26" id="h2-3-26" class="i">+        Node::KeyLookup { table, keys, alias: _ } =&gt; source::lookup_key(txn, table, keys),
</a> 
         Node::Limit { source, limit } =&gt; {
             let source = execute(*source, txn)?;
             Ok(transform::limit(source, limit))
         }
 
<a href="#h2-3-33" id="h2-3-33" class="d">-        Node::NestedLoopJoin { left, left_size: _, right, predicate, outer } =&gt; {
</a><a href="#h2-3-34" id="h2-3-34" class="i">+        Node::NestedLoopJoin { left, left_size: _, right, right_size, predicate, outer } =&gt; {
</a>             let left = execute(*left, txn)?;
             let right = execute(*right, txn)?;
<a href="#h2-3-37" id="h2-3-37" class="d">-            join::nested_loop(left, right, predicate, outer)
</a><a href="#h2-3-38" id="h2-3-38" class="i">+            join::nested_loop(left, right, right_size, predicate, outer)
</a>         }
 
         Node::Nothing =&gt; Ok(source::nothing()),
<a href="#h2-4" id="h2-4" class="h">@@ -102,17 +111,17 @@ pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;QueryIterator&gt; {
</a> 
         Node::Order { source, orders } =&gt; {
             let source = execute(*source, txn)?;
<a href="#h2-4-3" id="h2-4-3" class="d">-            Ok(transform::order(source, orders))
</a><a href="#h2-4-4" id="h2-4-4" class="i">+            transform::order(source, orders)
</a>         }
 
<a href="#h2-4-7" id="h2-4-7" class="d">-        Node::Projection { source, labels, expressions } =&gt; {
</a><a href="#h2-4-8" id="h2-4-8" class="i">+        Node::Projection { source, expressions, labels: _ } =&gt; {
</a>             let source = execute(*source, txn)?;
<a href="#h2-4-10" id="h2-4-10" class="d">-            Ok(transform::project(source, labels, expressions))
</a><a href="#h2-4-11" id="h2-4-11" class="i">+            Ok(transform::project(source, expressions))
</a>         }
 
<a href="#h2-4-14" id="h2-4-14" class="d">-        Node::Scan { table, alias: _, filter } =&gt; source::scan(txn, table, filter),
</a><a href="#h2-4-15" id="h2-4-15" class="i">+        Node::Scan { table, filter, alias: _ } =&gt; source::scan(txn, table, filter),
</a> 
<a href="#h2-4-17" id="h2-4-17" class="d">-        Node::Values { labels, rows } =&gt; Ok(source::values(labels, rows)),
</a><a href="#h2-4-18" id="h2-4-18" class="i">+        Node::Values { rows } =&gt; Ok(source::values(rows)),
</a>     }
 }
 
<a href="#h2-5" id="h2-5" class="h">@@ -123,60 +132,5 @@ pub enum ExecutionResult {
</a>     Delete { count: u64 },
     Insert { count: u64 },
     Update { count: u64 },
<a href="#h2-5-3" id="h2-5-3" class="d">-    Select { iter: QueryIterator, labels: Vec&lt;Option&lt;Label&gt;&gt; },
</a><a href="#h2-5-4" id="h2-5-4" class="d">-}
</a><a href="#h2-5-5" id="h2-5-5" class="d">-
</a><a href="#h2-5-6" id="h2-5-6" class="d">-/// A query result iterator, containing the columns and row iterator.
</a><a href="#h2-5-7" id="h2-5-7" class="d">-///
</a><a href="#h2-5-8" id="h2-5-8" class="d">-/// TODO: now that we resolve labels during planning, we can replace this with a
</a><a href="#h2-5-9" id="h2-5-9" class="d">-/// simple Rows iterator. We can probably also make that generic instead of a
</a><a href="#h2-5-10" id="h2-5-10" class="d">-/// trait object, since we know the type when calling each executor.
</a><a href="#h2-5-11" id="h2-5-11" class="d">-pub struct QueryIterator {
</a><a href="#h2-5-12" id="h2-5-12" class="d">-    /// Column names.
</a><a href="#h2-5-13" id="h2-5-13" class="d">-    pub columns: Vec&lt;Option&lt;Label&gt;&gt;,
</a><a href="#h2-5-14" id="h2-5-14" class="d">-    /// Row iterator.
</a><a href="#h2-5-15" id="h2-5-15" class="d">-    pub rows: Rows,
</a><a href="#h2-5-16" id="h2-5-16" class="d">-}
</a><a href="#h2-5-17" id="h2-5-17" class="d">-
</a><a href="#h2-5-18" id="h2-5-18" class="d">-impl Iterator for QueryIterator {
</a><a href="#h2-5-19" id="h2-5-19" class="d">-    type Item = Result&lt;Row&gt;;
</a><a href="#h2-5-20" id="h2-5-20" class="d">-
</a><a href="#h2-5-21" id="h2-5-21" class="d">-    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
</a><a href="#h2-5-22" id="h2-5-22" class="d">-        self.rows.next()
</a><a href="#h2-5-23" id="h2-5-23" class="d">-    }
</a><a href="#h2-5-24" id="h2-5-24" class="d">-}
</a><a href="#h2-5-25" id="h2-5-25" class="d">-
</a><a href="#h2-5-26" id="h2-5-26" class="d">-impl QueryIterator {
</a><a href="#h2-5-27" id="h2-5-27" class="d">-    /// Replaces the columns with the result of the closure.
</a><a href="#h2-5-28" id="h2-5-28" class="d">-    pub fn map_columns&lt;F&gt;(mut self, f: F) -&gt; Self
</a><a href="#h2-5-29" id="h2-5-29" class="d">-    where
</a><a href="#h2-5-30" id="h2-5-30" class="d">-        F: FnOnce(Vec&lt;Option&lt;Label&gt;&gt;) -&gt; Vec&lt;Option&lt;Label&gt;&gt;,
</a><a href="#h2-5-31" id="h2-5-31" class="d">-    {
</a><a href="#h2-5-32" id="h2-5-32" class="d">-        self.columns = f(self.columns);
</a><a href="#h2-5-33" id="h2-5-33" class="d">-        self
</a><a href="#h2-5-34" id="h2-5-34" class="d">-    }
</a><a href="#h2-5-35" id="h2-5-35" class="d">-
</a><a href="#h2-5-36" id="h2-5-36" class="d">-    /// Replaces the rows iterator with the result of the closure.
</a><a href="#h2-5-37" id="h2-5-37" class="d">-    pub fn map_rows&lt;F, I&gt;(mut self, f: F) -&gt; Self
</a><a href="#h2-5-38" id="h2-5-38" class="d">-    where
</a><a href="#h2-5-39" id="h2-5-39" class="d">-        I: Iterator&lt;Item = Result&lt;Row&gt;&gt; + &#39;static,
</a><a href="#h2-5-40" id="h2-5-40" class="d">-        F: FnOnce(Rows) -&gt; I,
</a><a href="#h2-5-41" id="h2-5-41" class="d">-    {
</a><a href="#h2-5-42" id="h2-5-42" class="d">-        self.rows = Box::new(f(self.rows));
</a><a href="#h2-5-43" id="h2-5-43" class="d">-        self
</a><a href="#h2-5-44" id="h2-5-44" class="d">-    }
</a><a href="#h2-5-45" id="h2-5-45" class="d">-
</a><a href="#h2-5-46" id="h2-5-46" class="d">-    /// Like map_rows, but if the closure errors the row iterator will yield a
</a><a href="#h2-5-47" id="h2-5-47" class="d">-    /// single error item.
</a><a href="#h2-5-48" id="h2-5-48" class="d">-    pub fn try_map_rows&lt;F, I&gt;(mut self, f: F) -&gt; Self
</a><a href="#h2-5-49" id="h2-5-49" class="d">-    where
</a><a href="#h2-5-50" id="h2-5-50" class="d">-        I: Iterator&lt;Item = Result&lt;Row&gt;&gt; + &#39;static,
</a><a href="#h2-5-51" id="h2-5-51" class="d">-        F: FnOnce(Rows) -&gt; Result&lt;I&gt;,
</a><a href="#h2-5-52" id="h2-5-52" class="d">-    {
</a><a href="#h2-5-53" id="h2-5-53" class="d">-        self.rows = match f(self.rows) {
</a><a href="#h2-5-54" id="h2-5-54" class="d">-            Ok(rows) =&gt; Box::new(rows),
</a><a href="#h2-5-55" id="h2-5-55" class="d">-            Err(e) =&gt; Box::new(std::iter::once(Err(e))),
</a><a href="#h2-5-56" id="h2-5-56" class="d">-        };
</a><a href="#h2-5-57" id="h2-5-57" class="d">-        self
</a><a href="#h2-5-58" id="h2-5-58" class="d">-    }
</a><a href="#h2-5-59" id="h2-5-59" class="i">+    Select { rows: Rows, labels: Vec&lt;Option&lt;Label&gt;&gt; },
</a> }
<b>diff --git a/<a id="h3" href="../file/src/sql/execution/join.rs.html">src/sql/execution/join.rs</a> b/<a href="../file/src/sql/execution/join.rs.html">src/sql/execution/join.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -1,4 +1,3 @@
</a><a href="#h3-0-0" id="h3-0-0" class="d">-use super::QueryIterator;
</a> use crate::errdata;
 use crate::error::Result;
 use crate::sql::types::{Expression, Row, Rows, Value};
<a href="#h3-1" id="h3-1" class="h">@@ -13,16 +12,13 @@ use std::iter::Peekable;
</a> /// joined row with NULL values for the right source is returned (typically used
 /// for a LEFT JOIN).
 pub(super) fn nested_loop(
<a href="#h3-1-3" id="h3-1-3" class="d">-    left: QueryIterator,
</a><a href="#h3-1-4" id="h3-1-4" class="d">-    right: QueryIterator,
</a><a href="#h3-1-5" id="h3-1-5" class="i">+    left: Rows,
</a><a href="#h3-1-6" id="h3-1-6" class="i">+    right: Rows,
</a><a href="#h3-1-7" id="h3-1-7" class="i">+    right_size: usize,
</a>     predicate: Option&lt;Expression&gt;,
     outer: bool,
<a href="#h3-1-10" id="h3-1-10" class="d">-) -&gt; Result&lt;QueryIterator&gt; {
</a><a href="#h3-1-11" id="h3-1-11" class="d">-    let right_size = right.columns.len();
</a><a href="#h3-1-12" id="h3-1-12" class="d">-    let columns = left.columns.into_iter().chain(right.columns).collect();
</a><a href="#h3-1-13" id="h3-1-13" class="d">-    let rows =
</a><a href="#h3-1-14" id="h3-1-14" class="d">-        Box::new(NestedLoopIterator::new(left.rows, right.rows, right_size, predicate, outer)?);
</a><a href="#h3-1-15" id="h3-1-15" class="d">-    Ok(QueryIterator { rows, columns })
</a><a href="#h3-1-16" id="h3-1-16" class="i">+) -&gt; Result&lt;Rows&gt; {
</a><a href="#h3-1-17" id="h3-1-17" class="i">+    Ok(Box::new(NestedLoopIterator::new(left, right, right_size, predicate, outer)?))
</a> }
 
 /// NestedLoopIterator implements nested loop joins.
<a href="#h3-2" id="h3-2" class="h">@@ -131,18 +127,15 @@ impl Iterator for NestedLoopIterator {
</a> ///
 /// TODO: add more tests for the multiple match case.
 pub(super) fn hash(
<a href="#h3-2-3" id="h3-2-3" class="d">-    left: QueryIterator,
</a><a href="#h3-2-4" id="h3-2-4" class="i">+    left: Rows,
</a>     left_field: usize,
<a href="#h3-2-6" id="h3-2-6" class="d">-    right: QueryIterator,
</a><a href="#h3-2-7" id="h3-2-7" class="i">+    right: Rows,
</a>     right_field: usize,
<a href="#h3-2-9" id="h3-2-9" class="i">+    right_size: usize,
</a>     outer: bool,
<a href="#h3-2-11" id="h3-2-11" class="d">-) -&gt; Result&lt;QueryIterator&gt; {
</a><a href="#h3-2-12" id="h3-2-12" class="d">-    // Build the combined columns.
</a><a href="#h3-2-13" id="h3-2-13" class="d">-    let right_size = right.columns.len();
</a><a href="#h3-2-14" id="h3-2-14" class="d">-    let columns = left.columns.into_iter().chain(right.columns).collect();
</a><a href="#h3-2-15" id="h3-2-15" class="d">-
</a><a href="#h3-2-16" id="h3-2-16" class="i">+) -&gt; Result&lt;Rows&gt; {
</a>     // Build the hash table from the right source.
<a href="#h3-2-18" id="h3-2-18" class="d">-    let mut rows = right.rows;
</a><a href="#h3-2-19" id="h3-2-19" class="i">+    let mut rows = right;
</a>     let mut right: HashMap&lt;Value, Vec&lt;Row&gt;&gt; = HashMap::new();
     while let Some(row) = rows.next().transpose()? {
         let id = row[right_field].clone();
<a href="#h3-3" id="h3-3" class="h">@@ -153,7 +146,7 @@ pub(super) fn hash(
</a>     let empty = std::iter::repeat(Value::Null).take(right_size);
 
     // Set up the join iterator.
<a href="#h3-3-3" id="h3-3-3" class="d">-    let rows = Box::new(left.rows.flat_map(move |result| -&gt; Rows {
</a><a href="#h3-3-4" id="h3-3-4" class="i">+    Ok(Box::new(left.flat_map(move |result| -&gt; Rows {
</a>         // Pass through errors.
         let Ok(row) = result else {
             return Box::new(std::iter::once(result));
<a href="#h3-4" id="h3-4" class="h">@@ -171,7 +164,5 @@ pub(super) fn hash(
</a>             }
             None =&gt; Box::new(std::iter::empty()),
         }
<a href="#h3-4-3" id="h3-4-3" class="d">-    }));
</a><a href="#h3-4-4" id="h3-4-4" class="d">-
</a><a href="#h3-4-5" id="h3-4-5" class="d">-    Ok(QueryIterator { columns, rows })
</a><a href="#h3-4-6" id="h3-4-6" class="i">+    })))
</a> }
<b>diff --git a/<a id="h4" href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a> b/<a href="../file/src/sql/execution/mod.rs.html">src/sql/execution/mod.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -5,4 +5,4 @@ mod source;
</a> mod transform;
 mod write;
 
<a href="#h4-0-3" id="h4-0-3" class="d">-pub use execute::{execute_plan, ExecutionResult, QueryIterator};
</a><a href="#h4-0-4" id="h4-0-4" class="i">+pub use execute::{execute_plan, ExecutionResult};
</a><b>diff --git a/<a id="h5" href="../file/src/sql/execution/source.rs.html">src/sql/execution/source.rs</a> b/<a href="../file/src/sql/execution/source.rs.html">src/sql/execution/source.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -1,62 +1,41 @@
</a><a href="#h5-0-0" id="h5-0-0" class="d">-use super::QueryIterator;
</a> use crate::error::Result;
 use crate::sql::engine::Transaction;
<a href="#h5-0-3" id="h5-0-3" class="d">-use crate::sql::types::{Expression, Label, Row, Table, Value};
</a><a href="#h5-0-4" id="h5-0-4" class="i">+use crate::sql::types::{Expression, Row, Rows, Table, Value};
</a> 
 /// A table scan source.
 pub(super) fn scan(
     txn: &amp;impl Transaction,
     table: Table,
     filter: Option&lt;Expression&gt;,
<a href="#h5-0-11" id="h5-0-11" class="d">-) -&gt; Result&lt;QueryIterator&gt; {
</a><a href="#h5-0-12" id="h5-0-12" class="d">-    Ok(QueryIterator {
</a><a href="#h5-0-13" id="h5-0-13" class="d">-        columns: table.columns.into_iter().map(|c| Some((None, c.name))).collect(),
</a><a href="#h5-0-14" id="h5-0-14" class="d">-        rows: Box::new(txn.scan(&amp;table.name, filter)?),
</a><a href="#h5-0-15" id="h5-0-15" class="d">-    })
</a><a href="#h5-0-16" id="h5-0-16" class="i">+) -&gt; Result&lt;Rows&gt; {
</a><a href="#h5-0-17" id="h5-0-17" class="i">+    Ok(Box::new(txn.scan(&amp;table.name, filter)?))
</a> }
 
 /// A primary key lookup source.
<a href="#h5-0-21" id="h5-0-21" class="d">-pub(super) fn lookup_key(
</a><a href="#h5-0-22" id="h5-0-22" class="d">-    txn: &amp;impl Transaction,
</a><a href="#h5-0-23" id="h5-0-23" class="d">-    table: Table,
</a><a href="#h5-0-24" id="h5-0-24" class="d">-    keys: Vec&lt;Value&gt;,
</a><a href="#h5-0-25" id="h5-0-25" class="d">-) -&gt; Result&lt;QueryIterator&gt; {
</a><a href="#h5-0-26" id="h5-0-26" class="d">-    Ok(QueryIterator {
</a><a href="#h5-0-27" id="h5-0-27" class="d">-        columns: table.columns.into_iter().map(|c| Some((None, c.name))).collect(),
</a><a href="#h5-0-28" id="h5-0-28" class="d">-        rows: Box::new(txn.get(&amp;table.name, &amp;keys)?.into_iter().map(Ok)),
</a><a href="#h5-0-29" id="h5-0-29" class="d">-    })
</a><a href="#h5-0-30" id="h5-0-30" class="i">+pub(super) fn lookup_key(txn: &amp;impl Transaction, table: String, keys: Vec&lt;Value&gt;) -&gt; Result&lt;Rows&gt; {
</a><a href="#h5-0-31" id="h5-0-31" class="i">+    Ok(Box::new(txn.get(&amp;table, &amp;keys)?.into_iter().map(Ok)))
</a> }
 
 /// An index lookup source.
 pub(super) fn lookup_index(
     txn: &amp;impl Transaction,
<a href="#h5-0-37" id="h5-0-37" class="d">-    table: Table,
</a><a href="#h5-0-38" id="h5-0-38" class="i">+    table: String,
</a>     column: String,
     values: Vec&lt;Value&gt;,
<a href="#h5-0-41" id="h5-0-41" class="d">-) -&gt; Result&lt;QueryIterator&gt; {
</a><a href="#h5-0-42" id="h5-0-42" class="d">-    let pks: Vec&lt;_&gt; = txn.lookup_index(&amp;table.name, &amp;column, &amp;values)?.into_iter().collect();
</a><a href="#h5-0-43" id="h5-0-43" class="d">-    let rows = txn.get(&amp;table.name, &amp;pks)?;
</a><a href="#h5-0-44" id="h5-0-44" class="d">-
</a><a href="#h5-0-45" id="h5-0-45" class="d">-    Ok(QueryIterator {
</a><a href="#h5-0-46" id="h5-0-46" class="d">-        columns: table.columns.into_iter().map(|c| Some((None, c.name))).collect(),
</a><a href="#h5-0-47" id="h5-0-47" class="d">-        rows: Box::new(rows.into_iter().map(Ok)),
</a><a href="#h5-0-48" id="h5-0-48" class="d">-    })
</a><a href="#h5-0-49" id="h5-0-49" class="i">+) -&gt; Result&lt;Rows&gt; {
</a><a href="#h5-0-50" id="h5-0-50" class="i">+    let ids: Vec&lt;_&gt; = txn.lookup_index(&amp;table, &amp;column, &amp;values)?.into_iter().collect();
</a><a href="#h5-0-51" id="h5-0-51" class="i">+    Ok(Box::new(txn.get(&amp;table, &amp;ids)?.into_iter().map(Ok)))
</a> }
 
 /// Produces a single empty row. Used for queries without a FROM clause, e.g.
 /// SELECT 1+1, in order to have something to project against.
 ///
 /// TODO: replace with values.
<a href="#h5-0-58" id="h5-0-58" class="d">-pub(super) fn nothing() -&gt; QueryIterator {
</a><a href="#h5-0-59" id="h5-0-59" class="d">-    QueryIterator { columns: Vec::new(), rows: Box::new(std::iter::once(Ok(Row::new()))) }
</a><a href="#h5-0-60" id="h5-0-60" class="i">+pub(super) fn nothing() -&gt; Rows {
</a><a href="#h5-0-61" id="h5-0-61" class="i">+    Box::new(std::iter::once(Ok(Row::new())))
</a> }
 
 /// Emits predefined constant values.
<a href="#h5-0-65" id="h5-0-65" class="d">-pub(super) fn values(labels: Vec&lt;Option&lt;Label&gt;&gt;, rows: Vec&lt;Vec&lt;Expression&gt;&gt;) -&gt; QueryIterator {
</a><a href="#h5-0-66" id="h5-0-66" class="d">-    QueryIterator {
</a><a href="#h5-0-67" id="h5-0-67" class="d">-        columns: labels,
</a><a href="#h5-0-68" id="h5-0-68" class="d">-        rows: Box::new(
</a><a href="#h5-0-69" id="h5-0-69" class="d">-            rows.into_iter().map(|row| row.into_iter().map(|expr| expr.evaluate(None)).collect()),
</a><a href="#h5-0-70" id="h5-0-70" class="d">-        ),
</a><a href="#h5-0-71" id="h5-0-71" class="d">-    }
</a><a href="#h5-0-72" id="h5-0-72" class="i">+pub(super) fn values(rows: Vec&lt;Vec&lt;Expression&gt;&gt;) -&gt; Rows {
</a><a href="#h5-0-73" id="h5-0-73" class="i">+    Box::new(rows.into_iter().map(|row| row.into_iter().map(|expr| expr.evaluate(None)).collect()))
</a> }
<b>diff --git a/<a id="h6" href="../file/src/sql/execution/transform.rs.html">src/sql/execution/transform.rs</a> b/<a href="../file/src/sql/execution/transform.rs.html">src/sql/execution/transform.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,99 +1,67 @@
</a> use itertools::izip;
 
<a href="#h6-0-2" id="h6-0-2" class="d">-use super::QueryIterator;
</a> use crate::errinput;
 use crate::error::Result;
 use crate::sql::planner::Direction;
<a href="#h6-0-6" id="h6-0-6" class="d">-use crate::sql::types::{Expression, Label, Value};
</a><a href="#h6-0-7" id="h6-0-7" class="i">+use crate::sql::types::{Expression, Rows, Value};
</a> 
 /// Filters the input rows (i.e. WHERE).
<a href="#h6-0-10" id="h6-0-10" class="d">-pub(super) fn filter(source: QueryIterator, predicate: Expression) -&gt; QueryIterator {
</a><a href="#h6-0-11" id="h6-0-11" class="d">-    source.map_rows(|rows| {
</a><a href="#h6-0-12" id="h6-0-12" class="d">-        rows.filter_map(move |r| {
</a><a href="#h6-0-13" id="h6-0-13" class="d">-            r.and_then(|row| match predicate.evaluate(Some(&amp;row))? {
</a><a href="#h6-0-14" id="h6-0-14" class="d">-                Value::Boolean(true) =&gt; Ok(Some(row)),
</a><a href="#h6-0-15" id="h6-0-15" class="d">-                Value::Boolean(false) =&gt; Ok(None),
</a><a href="#h6-0-16" id="h6-0-16" class="d">-                Value::Null =&gt; Ok(None),
</a><a href="#h6-0-17" id="h6-0-17" class="d">-                value =&gt; errinput!(&quot;filter returned {value}, expected boolean&quot;,),
</a><a href="#h6-0-18" id="h6-0-18" class="d">-            })
</a><a href="#h6-0-19" id="h6-0-19" class="d">-            .transpose()
</a><a href="#h6-0-20" id="h6-0-20" class="i">+pub(super) fn filter(source: Rows, predicate: Expression) -&gt; Rows {
</a><a href="#h6-0-21" id="h6-0-21" class="i">+    Box::new(source.filter_map(move |r| {
</a><a href="#h6-0-22" id="h6-0-22" class="i">+        r.and_then(|row| match predicate.evaluate(Some(&amp;row))? {
</a><a href="#h6-0-23" id="h6-0-23" class="i">+            Value::Boolean(true) =&gt; Ok(Some(row)),
</a><a href="#h6-0-24" id="h6-0-24" class="i">+            Value::Boolean(false) =&gt; Ok(None),
</a><a href="#h6-0-25" id="h6-0-25" class="i">+            Value::Null =&gt; Ok(None),
</a><a href="#h6-0-26" id="h6-0-26" class="i">+            value =&gt; errinput!(&quot;filter returned {value}, expected boolean&quot;,),
</a>         })
<a href="#h6-0-28" id="h6-0-28" class="d">-    })
</a><a href="#h6-0-29" id="h6-0-29" class="i">+        .transpose()
</a><a href="#h6-0-30" id="h6-0-30" class="i">+    }))
</a> }
 
 /// Limits the result to the given number of rows (i.e. LIMIT).
<a href="#h6-0-34" id="h6-0-34" class="d">-pub(super) fn limit(source: QueryIterator, limit: usize) -&gt; QueryIterator {
</a><a href="#h6-0-35" id="h6-0-35" class="d">-    source.map_rows(|rows| rows.take(limit))
</a><a href="#h6-0-36" id="h6-0-36" class="i">+pub(super) fn limit(source: Rows, limit: usize) -&gt; Rows {
</a><a href="#h6-0-37" id="h6-0-37" class="i">+    Box::new(source.take(limit))
</a> }
 
 /// Skips the given number of rows (i.e. OFFSET).
<a href="#h6-0-41" id="h6-0-41" class="d">-pub(super) fn offset(source: QueryIterator, offset: usize) -&gt; QueryIterator {
</a><a href="#h6-0-42" id="h6-0-42" class="d">-    source.map_rows(|rows| rows.skip(offset))
</a><a href="#h6-0-43" id="h6-0-43" class="i">+pub(super) fn offset(source: Rows, offset: usize) -&gt; Rows {
</a><a href="#h6-0-44" id="h6-0-44" class="i">+    Box::new(source.skip(offset))
</a> }
 
 /// Sorts the rows (i.e. ORDER BY).
<a href="#h6-0-48" id="h6-0-48" class="d">-pub(super) fn order(source: QueryIterator, order: Vec&lt;(Expression, Direction)&gt;) -&gt; QueryIterator {
</a><a href="#h6-0-49" id="h6-0-49" class="d">-    source.try_map_rows(move |rows| {
</a><a href="#h6-0-50" id="h6-0-50" class="d">-        // We can&#39;t use sort_by_cached_key(), since expression evaluation is
</a><a href="#h6-0-51" id="h6-0-51" class="d">-        // fallible, and since we may have to vary the sort direction of each
</a><a href="#h6-0-52" id="h6-0-52" class="d">-        // expression. Precompute the sort values instead, and map them based on
</a><a href="#h6-0-53" id="h6-0-53" class="d">-        // the row index.
</a><a href="#h6-0-54" id="h6-0-54" class="d">-        let mut irows: Vec&lt;_&gt; =
</a><a href="#h6-0-55" id="h6-0-55" class="d">-            rows.enumerate().map(|(i, r)| r.map(|row| (i, row))).collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h6-0-56" id="h6-0-56" class="i">+pub(super) fn order(source: Rows, order: Vec&lt;(Expression, Direction)&gt;) -&gt; Result&lt;Rows&gt; {
</a><a href="#h6-0-57" id="h6-0-57" class="i">+    // We can&#39;t use sort_by_cached_key(), since expression evaluation is
</a><a href="#h6-0-58" id="h6-0-58" class="i">+    // fallible, and since we may have to vary the sort direction of each
</a><a href="#h6-0-59" id="h6-0-59" class="i">+    // expression. Precompute the sort values instead, and map them based on
</a><a href="#h6-0-60" id="h6-0-60" class="i">+    // the row index.
</a><a href="#h6-0-61" id="h6-0-61" class="i">+    let mut irows: Vec&lt;_&gt; =
</a><a href="#h6-0-62" id="h6-0-62" class="i">+        source.enumerate().map(|(i, r)| r.map(|row| (i, row))).collect::&lt;Result&lt;_&gt;&gt;()?;
</a> 
<a href="#h6-0-64" id="h6-0-64" class="d">-        let mut sort_values = Vec::with_capacity(irows.len());
</a><a href="#h6-0-65" id="h6-0-65" class="d">-        for (_, row) in &amp;irows {
</a><a href="#h6-0-66" id="h6-0-66" class="d">-            let values: Vec&lt;_&gt; =
</a><a href="#h6-0-67" id="h6-0-67" class="d">-                order.iter().map(|(e, _)| e.evaluate(Some(row))).collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h6-0-68" id="h6-0-68" class="d">-            sort_values.push(values)
</a><a href="#h6-0-69" id="h6-0-69" class="d">-        }
</a><a href="#h6-0-70" id="h6-0-70" class="i">+    let mut sort_values = Vec::with_capacity(irows.len());
</a><a href="#h6-0-71" id="h6-0-71" class="i">+    for (_, row) in &amp;irows {
</a><a href="#h6-0-72" id="h6-0-72" class="i">+        let values: Vec&lt;_&gt; =
</a><a href="#h6-0-73" id="h6-0-73" class="i">+            order.iter().map(|(e, _)| e.evaluate(Some(row))).collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h6-0-74" id="h6-0-74" class="i">+        sort_values.push(values)
</a><a href="#h6-0-75" id="h6-0-75" class="i">+    }
</a> 
<a href="#h6-0-77" id="h6-0-77" class="d">-        irows.sort_by(|&amp;(a, _), &amp;(b, _)| {
</a><a href="#h6-0-78" id="h6-0-78" class="d">-            let dirs = order.iter().map(|(_, dir)| dir);
</a><a href="#h6-0-79" id="h6-0-79" class="d">-            for (a, b, dir) in izip!(&amp;sort_values[a], &amp;sort_values[b], dirs) {
</a><a href="#h6-0-80" id="h6-0-80" class="d">-                match a.cmp(b) {
</a><a href="#h6-0-81" id="h6-0-81" class="d">-                    std::cmp::Ordering::Equal =&gt; {}
</a><a href="#h6-0-82" id="h6-0-82" class="d">-                    order if *dir == Direction::Descending =&gt; return order.reverse(),
</a><a href="#h6-0-83" id="h6-0-83" class="d">-                    order =&gt; return order,
</a><a href="#h6-0-84" id="h6-0-84" class="d">-                }
</a><a href="#h6-0-85" id="h6-0-85" class="i">+    irows.sort_by(|&amp;(a, _), &amp;(b, _)| {
</a><a href="#h6-0-86" id="h6-0-86" class="i">+        let dirs = order.iter().map(|(_, dir)| dir);
</a><a href="#h6-0-87" id="h6-0-87" class="i">+        for (a, b, dir) in izip!(&amp;sort_values[a], &amp;sort_values[b], dirs) {
</a><a href="#h6-0-88" id="h6-0-88" class="i">+            match a.cmp(b) {
</a><a href="#h6-0-89" id="h6-0-89" class="i">+                std::cmp::Ordering::Equal =&gt; {}
</a><a href="#h6-0-90" id="h6-0-90" class="i">+                order if *dir == Direction::Descending =&gt; return order.reverse(),
</a><a href="#h6-0-91" id="h6-0-91" class="i">+                order =&gt; return order,
</a>             }
<a href="#h6-0-93" id="h6-0-93" class="d">-            std::cmp::Ordering::Equal
</a><a href="#h6-0-94" id="h6-0-94" class="d">-        });
</a><a href="#h6-0-95" id="h6-0-95" class="i">+        }
</a><a href="#h6-0-96" id="h6-0-96" class="i">+        std::cmp::Ordering::Equal
</a><a href="#h6-0-97" id="h6-0-97" class="i">+    });
</a> 
<a href="#h6-0-99" id="h6-0-99" class="d">-        Ok(irows.into_iter().map(|(_, row)| Ok(row)))
</a><a href="#h6-0-100" id="h6-0-100" class="d">-    })
</a><a href="#h6-0-101" id="h6-0-101" class="i">+    Ok(Box::new(irows.into_iter().map(|(_, row)| Ok(row))))
</a> }
 
<a href="#h6-0-104" id="h6-0-104" class="d">-/// Projects the rows using the given expressions and labels (i.e. SELECT).
</a><a href="#h6-0-105" id="h6-0-105" class="d">-pub(super) fn project(
</a><a href="#h6-0-106" id="h6-0-106" class="d">-    source: QueryIterator,
</a><a href="#h6-0-107" id="h6-0-107" class="d">-    labels: Vec&lt;Option&lt;Label&gt;&gt;,
</a><a href="#h6-0-108" id="h6-0-108" class="d">-    expressions: Vec&lt;Expression&gt;,
</a><a href="#h6-0-109" id="h6-0-109" class="d">-) -&gt; QueryIterator {
</a><a href="#h6-0-110" id="h6-0-110" class="d">-    // Use explicit column label if given, or pass through the source column
</a><a href="#h6-0-111" id="h6-0-111" class="d">-    // label if referenced (e.g. SELECT a, b, a FROM table).
</a><a href="#h6-0-112" id="h6-0-112" class="d">-    //
</a><a href="#h6-0-113" id="h6-0-113" class="d">-    // TODO: the labels can probably be resolved entirely during planning,
</a><a href="#h6-0-114" id="h6-0-114" class="d">-    // without having to plumb them through execution.
</a><a href="#h6-0-115" id="h6-0-115" class="d">-    source
</a><a href="#h6-0-116" id="h6-0-116" class="d">-        .map_columns(|columns| {
</a><a href="#h6-0-117" id="h6-0-117" class="d">-            labels
</a><a href="#h6-0-118" id="h6-0-118" class="d">-                .into_iter()
</a><a href="#h6-0-119" id="h6-0-119" class="d">-                .enumerate()
</a><a href="#h6-0-120" id="h6-0-120" class="d">-                .map(|(i, label)| {
</a><a href="#h6-0-121" id="h6-0-121" class="d">-                    if let Some(label) = label {
</a><a href="#h6-0-122" id="h6-0-122" class="d">-                        Some(label)
</a><a href="#h6-0-123" id="h6-0-123" class="d">-                    } else if let Expression::Field(f, _) = &amp;expressions[i] {
</a><a href="#h6-0-124" id="h6-0-124" class="d">-                        columns.get(*f).cloned().expect(&quot;invalid field reference&quot;)
</a><a href="#h6-0-125" id="h6-0-125" class="d">-                    } else {
</a><a href="#h6-0-126" id="h6-0-126" class="d">-                        None
</a><a href="#h6-0-127" id="h6-0-127" class="d">-                    }
</a><a href="#h6-0-128" id="h6-0-128" class="d">-                })
</a><a href="#h6-0-129" id="h6-0-129" class="d">-                .collect()
</a><a href="#h6-0-130" id="h6-0-130" class="d">-        })
</a><a href="#h6-0-131" id="h6-0-131" class="d">-        .map_rows(|rows| {
</a><a href="#h6-0-132" id="h6-0-132" class="d">-            rows.map(move |r| {
</a><a href="#h6-0-133" id="h6-0-133" class="d">-                r.and_then(|row| expressions.iter().map(|e| e.evaluate(Some(&amp;row))).collect())
</a><a href="#h6-0-134" id="h6-0-134" class="d">-            })
</a><a href="#h6-0-135" id="h6-0-135" class="d">-        })
</a><a href="#h6-0-136" id="h6-0-136" class="i">+/// Projects the rows using the given expressions (i.e. SELECT).
</a><a href="#h6-0-137" id="h6-0-137" class="i">+pub(super) fn project(source: Rows, expressions: Vec&lt;Expression&gt;) -&gt; Rows {
</a><a href="#h6-0-138" id="h6-0-138" class="i">+    Box::new(source.map(move |r| {
</a><a href="#h6-0-139" id="h6-0-139" class="i">+        r.and_then(|row| expressions.iter().map(|e| e.evaluate(Some(&amp;row))).collect())
</a><a href="#h6-0-140" id="h6-0-140" class="i">+    }))
</a> }
<b>diff --git a/<a id="h7" href="../file/src/sql/execution/write.rs.html">src/sql/execution/write.rs</a> b/<a href="../file/src/sql/execution/write.rs.html">src/sql/execution/write.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,7 +1,6 @@
</a><a href="#h7-0-0" id="h7-0-0" class="d">-use super::QueryIterator;
</a> use crate::error::{Error, Result};
 use crate::sql::engine::Transaction;
<a href="#h7-0-3" id="h7-0-3" class="d">-use crate::sql::types::{Expression, Table};
</a><a href="#h7-0-4" id="h7-0-4" class="i">+use crate::sql::types::{Expression, Rows, Table};
</a> use crate::{errdata, errinput};
 
 use std::collections::HashMap;
<a href="#h7-1" id="h7-1" class="h">@@ -12,10 +11,10 @@ pub(super) fn delete(
</a>     txn: &amp;impl Transaction,
     table: String,
     primary_key: usize,
<a href="#h7-1-3" id="h7-1-3" class="d">-    source: QueryIterator,
</a><a href="#h7-1-4" id="h7-1-4" class="i">+    source: Rows,
</a> ) -&gt; Result&lt;u64&gt; {
     let ids = source
<a href="#h7-1-7" id="h7-1-7" class="d">-        // TODO: consider moving this out to a QueryIterator helper.
</a><a href="#h7-1-8" id="h7-1-8" class="i">+        // TODO: consider moving this out to a helper.
</a>         .map(|r| r.and_then(|row| row.into_iter().nth(primary_key).ok_or(errdata!(&quot;short row&quot;))))
         .collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?;
     let count = ids.len() as u64;
<a href="#h7-2" id="h7-2" class="h">@@ -33,7 +32,7 @@ pub(super) fn insert(
</a>     txn: &amp;impl Transaction,
     table: Table,
     column_map: Option&lt;HashMap&lt;usize, usize&gt;&gt;,
<a href="#h7-2-3" id="h7-2-3" class="d">-    mut source: QueryIterator,
</a><a href="#h7-2-4" id="h7-2-4" class="i">+    mut source: Rows,
</a> ) -&gt; Result&lt;u64&gt; {
     let mut rows = Vec::new();
     while let Some(values) = source.next().transpose()? {
<a href="#h7-3" id="h7-3" class="h">@@ -82,7 +81,7 @@ pub(super) fn update(
</a>     txn: &amp;impl Transaction,
     table: String,
     primary_key: usize,
<a href="#h7-3-3" id="h7-3-3" class="d">-    mut source: QueryIterator,
</a><a href="#h7-3-4" id="h7-3-4" class="i">+    mut source: Rows,
</a>     expressions: Vec&lt;(usize, Expression)&gt;,
 ) -&gt; Result&lt;u64&gt; {
     let mut updates = HashMap::new();
<b>diff --git a/<a id="h8" href="../file/src/sql/planner/optimizer.rs.html">src/sql/planner/optimizer.rs</a> b/<a href="../file/src/sql/planner/optimizer.rs.html">src/sql/planner/optimizer.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -54,11 +54,19 @@ impl Optimizer for FilterPushdown {
</a>                     mut left,
                     left_size,
                     mut right,
<a href="#h8-0-3" id="h8-0-3" class="i">+                    right_size,
</a>                     predicate: Some(predicate),
                     outer,
                 } =&gt; {
                     let predicate = self.pushdown_join(predicate, &amp;mut left, &amp;mut right, left_size);
<a href="#h8-0-8" id="h8-0-8" class="d">-                    Ok(Node::NestedLoopJoin { left, left_size, right, predicate, outer })
</a><a href="#h8-0-9" id="h8-0-9" class="i">+                    Ok(Node::NestedLoopJoin {
</a><a href="#h8-0-10" id="h8-0-10" class="i">+                        left,
</a><a href="#h8-0-11" id="h8-0-11" class="i">+                        left_size,
</a><a href="#h8-0-12" id="h8-0-12" class="i">+                        right,
</a><a href="#h8-0-13" id="h8-0-13" class="i">+                        right_size,
</a><a href="#h8-0-14" id="h8-0-14" class="i">+                        predicate,
</a><a href="#h8-0-15" id="h8-0-15" class="i">+                        outer,
</a><a href="#h8-0-16" id="h8-0-16" class="i">+                    })
</a>                 }
                 n =&gt; Ok(n),
             },
<a href="#h8-1" id="h8-1" class="h">@@ -181,17 +189,20 @@ impl Optimizer for IndexLookup {
</a>                 for i in 0..cnf.len() {
                     if let Some(keys) = cnf[i].as_lookup(table.primary_key) {
                         cnf.remove(i);
<a href="#h8-1-3" id="h8-1-3" class="d">-                        return Ok(self.wrap_cnf(Node::KeyLookup { table, alias, keys }, cnf));
</a><a href="#h8-1-4" id="h8-1-4" class="i">+                        return Ok(self.wrap_cnf(
</a><a href="#h8-1-5" id="h8-1-5" class="i">+                            Node::KeyLookup { table: table.name.clone(), keys, alias },
</a><a href="#h8-1-6" id="h8-1-6" class="i">+                            cnf,
</a><a href="#h8-1-7" id="h8-1-7" class="i">+                        ));
</a>                     }
                     for (ci, column) in table.columns.iter().enumerate().filter(|(_, c)| c.index) {
                         if let Some(values) = cnf[i].as_lookup(ci) {
                             cnf.remove(i);
                             return Ok(self.wrap_cnf(
                                 Node::IndexLookup {
<a href="#h8-1-14" id="h8-1-14" class="d">-                                    table: table.clone(),
</a><a href="#h8-1-15" id="h8-1-15" class="d">-                                    alias,
</a><a href="#h8-1-16" id="h8-1-16" class="i">+                                    table: table.name.clone(),
</a>                                     column: column.name.clone(),
                                     values,
<a href="#h8-1-19" id="h8-1-19" class="i">+                                    alias,
</a>                                 },
                                 cnf,
                             ));
<a href="#h8-2" id="h8-2" class="h">@@ -264,21 +275,32 @@ impl Optimizer for JoinType {
</a>                     left,
                     left_size,
                     right,
<a href="#h8-2-3" id="h8-2-3" class="i">+                    right_size,
</a>                     predicate: Some(Expression::Equal(a, b)),
                     outer,
                 } =&gt; match (*a, *b) {
                     (Expression::Field(a, a_label), Expression::Field(b, b_label)) =&gt; {
<a href="#h8-2-8" id="h8-2-8" class="d">-                        let (left_field, right_field) = if a &lt; left_size {
</a><a href="#h8-2-9" id="h8-2-9" class="d">-                            ((a, a_label), (b - left_size, b_label))
</a><a href="#h8-2-10" id="h8-2-10" class="i">+                        let (left_field, left_label, right_field, right_label) = if a &lt; left_size {
</a><a href="#h8-2-11" id="h8-2-11" class="i">+                            (a, a_label, b - left_size, b_label)
</a>                         } else {
<a href="#h8-2-13" id="h8-2-13" class="d">-                            ((b, b_label), (a - left_size, a_label))
</a><a href="#h8-2-14" id="h8-2-14" class="i">+                            (b, b_label, a - left_size, a_label)
</a>                         };
<a href="#h8-2-16" id="h8-2-16" class="d">-                        Ok(Node::HashJoin { left, left_field, right, right_field, outer })
</a><a href="#h8-2-17" id="h8-2-17" class="i">+                        Ok(Node::HashJoin {
</a><a href="#h8-2-18" id="h8-2-18" class="i">+                            left,
</a><a href="#h8-2-19" id="h8-2-19" class="i">+                            left_field,
</a><a href="#h8-2-20" id="h8-2-20" class="i">+                            left_label,
</a><a href="#h8-2-21" id="h8-2-21" class="i">+                            right,
</a><a href="#h8-2-22" id="h8-2-22" class="i">+                            right_field,
</a><a href="#h8-2-23" id="h8-2-23" class="i">+                            right_label,
</a><a href="#h8-2-24" id="h8-2-24" class="i">+                            right_size,
</a><a href="#h8-2-25" id="h8-2-25" class="i">+                            outer,
</a><a href="#h8-2-26" id="h8-2-26" class="i">+                        })
</a>                     }
                     (a, b) =&gt; Ok(Node::NestedLoopJoin {
                         left,
                         left_size,
                         right,
<a href="#h8-2-32" id="h8-2-32" class="i">+                        right_size,
</a>                         predicate: Some(Expression::Equal(a.into(), b.into())),
                         outer,
                     }),
<b>diff --git a/<a id="h9" href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a> b/<a href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -88,10 +88,11 @@ impl Plan {
</a> pub enum Node {
     /// Aggregates the input rows by computing the given aggregates for the
     /// corresponding source columns. Additional columns in source for which
<a href="#h9-0-3" id="h9-0-3" class="d">-    /// there are no aggregates are used as group by buckets.
</a><a href="#h9-0-4" id="h9-0-4" class="i">+    /// there are no aggregates are used as group by buckets, the number of
</a><a href="#h9-0-5" id="h9-0-5" class="i">+    /// such group by columns is given in group_by.
</a>     ///
     /// TODO: consider making aggregates a field/aggregate pair.
<a href="#h9-0-8" id="h9-0-8" class="d">-    Aggregation { source: Box&lt;Node&gt;, aggregates: Vec&lt;Aggregate&gt; },
</a><a href="#h9-0-9" id="h9-0-9" class="i">+    Aggregation { source: Box&lt;Node&gt;, aggregates: Vec&lt;Aggregate&gt;, group_by: usize },
</a>     /// Filters source rows, by only emitting rows for which the predicate
     /// evaluates to true.
     Filter { source: Box&lt;Node&gt;, predicate: Expression },
<a href="#h9-1" id="h9-1" class="h">@@ -99,27 +100,33 @@ pub enum Node {
</a>     /// in-memory hashmap of the right source and looking up matches for each
     /// row in the left source. When outer is true (e.g. LEFT JOIN), a left row
     /// without a right match is emitted anyway, with NULLs for the right row.
<a href="#h9-1-3" id="h9-1-3" class="i">+    /// TODO: do we need the labels?
</a>     HashJoin {
         left: Box&lt;Node&gt;,
<a href="#h9-1-6" id="h9-1-6" class="d">-        left_field: (usize, Option&lt;Label&gt;),
</a><a href="#h9-1-7" id="h9-1-7" class="i">+        left_field: usize,
</a><a href="#h9-1-8" id="h9-1-8" class="i">+        left_label: Option&lt;Label&gt;,
</a>         right: Box&lt;Node&gt;,
<a href="#h9-1-10" id="h9-1-10" class="d">-        right_field: (usize, Option&lt;Label&gt;),
</a><a href="#h9-1-11" id="h9-1-11" class="i">+        right_field: usize,
</a><a href="#h9-1-12" id="h9-1-12" class="i">+        right_label: Option&lt;Label&gt;,
</a><a href="#h9-1-13" id="h9-1-13" class="i">+        right_size: usize,
</a>         outer: bool,
     },
     /// Looks up the given values in a secondary index and emits matching rows.
<a href="#h9-1-17" id="h9-1-17" class="d">-    IndexLookup { table: Table, alias: Option&lt;String&gt;, column: String, values: Vec&lt;Value&gt; },
</a><a href="#h9-1-18" id="h9-1-18" class="i">+    IndexLookup { table: String, column: String, values: Vec&lt;Value&gt;, alias: Option&lt;String&gt; },
</a>     /// Looks up the given primary keys and emits their rows.
<a href="#h9-1-20" id="h9-1-20" class="d">-    KeyLookup { table: Table, alias: Option&lt;String&gt;, keys: Vec&lt;Value&gt; },
</a><a href="#h9-1-21" id="h9-1-21" class="i">+    KeyLookup { table: String, keys: Vec&lt;Value&gt;, alias: Option&lt;String&gt; },
</a>     /// Only emits the first limit rows from the source, discards the rest.
     Limit { source: Box&lt;Node&gt;, limit: usize },
     /// Joins the left and right sources on the given predicate by buffering the
     /// right source and iterating over it for every row in the left source.
     /// When outer is true (e.g. LEFT JOIN), a left row without a right match is
     /// emitted anyway, with NULLs for the right row.
<a href="#h9-1-28" id="h9-1-28" class="i">+    /// TODO: do we need left_size?
</a>     NestedLoopJoin {
         left: Box&lt;Node&gt;,
         left_size: usize,
         right: Box&lt;Node&gt;,
<a href="#h9-1-33" id="h9-1-33" class="i">+        right_size: usize,
</a>         predicate: Option&lt;Expression&gt;,
         outer: bool,
     },
<a href="#h9-2" id="h9-2" class="h">@@ -134,12 +141,11 @@ pub enum Node {
</a>     /// Projects the input rows by evaluating the given expressions.
     /// The labels are only used when displaying the plan.
     Projection { source: Box&lt;Node&gt;, expressions: Vec&lt;Expression&gt;, labels: Vec&lt;Option&lt;Label&gt;&gt; },
<a href="#h9-2-3" id="h9-2-3" class="d">-    /// A full table scan, with an optional filter pushdown. The alias is only
</a><a href="#h9-2-4" id="h9-2-4" class="d">-    /// used when displaying the plan.
</a><a href="#h9-2-5" id="h9-2-5" class="i">+    /// A full table scan, with an optional filter pushdown. The schema is used
</a><a href="#h9-2-6" id="h9-2-6" class="i">+    /// during plan optimization. The alias is only used for formatting.
</a>     Scan { table: Table, filter: Option&lt;Expression&gt;, alias: Option&lt;String&gt; },
     /// A constant set of values.
<a href="#h9-2-9" id="h9-2-9" class="d">-    /// TODO: get rid of the labels.
</a><a href="#h9-2-10" id="h9-2-10" class="d">-    Values { rows: Vec&lt;Vec&lt;Expression&gt;&gt;, labels: Vec&lt;Option&lt;Label&gt;&gt; },
</a><a href="#h9-2-11" id="h9-2-11" class="i">+    Values { rows: Vec&lt;Vec&lt;Expression&gt;&gt; },
</a> }
 
 impl Node {
<a href="#h9-3" id="h9-3" class="h">@@ -158,25 +164,38 @@ impl Node {
</a> 
         self = before(self)?;
         self = match self {
<a href="#h9-3-3" id="h9-3-3" class="d">-            Self::Aggregation { source, aggregates } =&gt; {
</a><a href="#h9-3-4" id="h9-3-4" class="d">-                Self::Aggregation { source: transform(source)?, aggregates }
</a><a href="#h9-3-5" id="h9-3-5" class="i">+            Self::Aggregation { source, aggregates, group_by } =&gt; {
</a><a href="#h9-3-6" id="h9-3-6" class="i">+                Self::Aggregation { source: transform(source)?, aggregates, group_by }
</a>             }
             Self::Filter { source, predicate } =&gt; {
                 Self::Filter { source: transform(source)?, predicate }
             }
<a href="#h9-3-11" id="h9-3-11" class="d">-            Self::HashJoin { left, left_field, right, right_field, outer } =&gt; Self::HashJoin {
</a><a href="#h9-3-12" id="h9-3-12" class="i">+            Self::HashJoin {
</a><a href="#h9-3-13" id="h9-3-13" class="i">+                left,
</a><a href="#h9-3-14" id="h9-3-14" class="i">+                left_field,
</a><a href="#h9-3-15" id="h9-3-15" class="i">+                left_label,
</a><a href="#h9-3-16" id="h9-3-16" class="i">+                right,
</a><a href="#h9-3-17" id="h9-3-17" class="i">+                right_field,
</a><a href="#h9-3-18" id="h9-3-18" class="i">+                right_label,
</a><a href="#h9-3-19" id="h9-3-19" class="i">+                right_size,
</a><a href="#h9-3-20" id="h9-3-20" class="i">+                outer,
</a><a href="#h9-3-21" id="h9-3-21" class="i">+            } =&gt; Self::HashJoin {
</a>                 left: transform(left)?,
                 left_field,
<a href="#h9-3-24" id="h9-3-24" class="i">+                left_label,
</a>                 right: transform(right)?,
                 right_field,
<a href="#h9-3-27" id="h9-3-27" class="i">+                right_label,
</a><a href="#h9-3-28" id="h9-3-28" class="i">+                right_size,
</a>                 outer,
             },
             Self::Limit { source, limit } =&gt; Self::Limit { source: transform(source)?, limit },
<a href="#h9-3-32" id="h9-3-32" class="d">-            Self::NestedLoopJoin { left, left_size, right, predicate, outer } =&gt; {
</a><a href="#h9-3-33" id="h9-3-33" class="i">+            Self::NestedLoopJoin { left, left_size, right, right_size, predicate, outer } =&gt; {
</a>                 Self::NestedLoopJoin {
                     left: transform(left)?,
                     left_size,
                     right: transform(right)?,
<a href="#h9-3-38" id="h9-3-38" class="i">+                    right_size,
</a>                     predicate,
                     outer,
                 }
<a href="#h9-4" id="h9-4" class="h">@@ -215,15 +234,21 @@ impl Node {
</a>                     .map(|(e, o)| e.transform(before, after).map(|e| (e, o)))
                     .collect::&lt;Result&lt;_&gt;&gt;()?,
             },
<a href="#h9-4-3" id="h9-4-3" class="d">-            Self::NestedLoopJoin { left, left_size, right, predicate: Some(predicate), outer } =&gt; {
</a><a href="#h9-4-4" id="h9-4-4" class="d">-                Self::NestedLoopJoin {
</a><a href="#h9-4-5" id="h9-4-5" class="d">-                    left,
</a><a href="#h9-4-6" id="h9-4-6" class="d">-                    left_size,
</a><a href="#h9-4-7" id="h9-4-7" class="d">-                    right,
</a><a href="#h9-4-8" id="h9-4-8" class="d">-                    predicate: Some(predicate.transform(before, after)?),
</a><a href="#h9-4-9" id="h9-4-9" class="d">-                    outer,
</a><a href="#h9-4-10" id="h9-4-10" class="d">-                }
</a><a href="#h9-4-11" id="h9-4-11" class="d">-            }
</a><a href="#h9-4-12" id="h9-4-12" class="i">+            Self::NestedLoopJoin {
</a><a href="#h9-4-13" id="h9-4-13" class="i">+                left,
</a><a href="#h9-4-14" id="h9-4-14" class="i">+                left_size,
</a><a href="#h9-4-15" id="h9-4-15" class="i">+                right,
</a><a href="#h9-4-16" id="h9-4-16" class="i">+                right_size,
</a><a href="#h9-4-17" id="h9-4-17" class="i">+                predicate: Some(predicate),
</a><a href="#h9-4-18" id="h9-4-18" class="i">+                outer,
</a><a href="#h9-4-19" id="h9-4-19" class="i">+            } =&gt; Self::NestedLoopJoin {
</a><a href="#h9-4-20" id="h9-4-20" class="i">+                left,
</a><a href="#h9-4-21" id="h9-4-21" class="i">+                left_size,
</a><a href="#h9-4-22" id="h9-4-22" class="i">+                right,
</a><a href="#h9-4-23" id="h9-4-23" class="i">+                right_size,
</a><a href="#h9-4-24" id="h9-4-24" class="i">+                predicate: Some(predicate.transform(before, after)?),
</a><a href="#h9-4-25" id="h9-4-25" class="i">+                outer,
</a><a href="#h9-4-26" id="h9-4-26" class="i">+            },
</a>             Self::Projection { source, labels, expressions } =&gt; Self::Projection {
                 source,
                 labels,
<a href="#h9-5" id="h9-5" class="h">@@ -235,8 +260,7 @@ impl Node {
</a>             Self::Scan { table, alias, filter: Some(filter) } =&gt; {
                 Self::Scan { table, alias, filter: Some(filter.transform(before, after)?) }
             }
<a href="#h9-5-3" id="h9-5-3" class="d">-            Self::Values { labels, rows } =&gt; Self::Values {
</a><a href="#h9-5-4" id="h9-5-4" class="d">-                labels,
</a><a href="#h9-5-5" id="h9-5-5" class="i">+            Self::Values { rows } =&gt; Self::Values {
</a>                 rows: rows
                     .into_iter()
                     .map(|row| row.into_iter().map(|e| e.transform(before, after)).collect())
<a href="#h9-6" id="h9-6" class="h">@@ -316,7 +340,7 @@ impl Node {
</a> 
         // Format the node.
         match self {
<a href="#h9-6-3" id="h9-6-3" class="d">-            Self::Aggregation { source, aggregates } =&gt; {
</a><a href="#h9-6-4" id="h9-6-4" class="i">+            Self::Aggregation { source, aggregates, .. } =&gt; {
</a>                 write!(f, &quot;Aggregation: {}&quot;, aggregates.iter().join(&quot;, &quot;))?;
                 source.format(f, prefix, false, true)?;
             }
<a href="#h9-7" id="h9-7" class="h">@@ -324,25 +348,34 @@ impl Node {
</a>                 write!(f, &quot;Filter: {predicate}&quot;)?;
                 source.format(f, prefix, false, true)?;
             }
<a href="#h9-7-3" id="h9-7-3" class="d">-            Self::HashJoin { left, left_field, right, right_field, outer } =&gt; {
</a><a href="#h9-7-4" id="h9-7-4" class="i">+            Self::HashJoin {
</a><a href="#h9-7-5" id="h9-7-5" class="i">+                left,
</a><a href="#h9-7-6" id="h9-7-6" class="i">+                left_field,
</a><a href="#h9-7-7" id="h9-7-7" class="i">+                left_label,
</a><a href="#h9-7-8" id="h9-7-8" class="i">+                right,
</a><a href="#h9-7-9" id="h9-7-9" class="i">+                right_field,
</a><a href="#h9-7-10" id="h9-7-10" class="i">+                right_label,
</a><a href="#h9-7-11" id="h9-7-11" class="i">+                outer,
</a><a href="#h9-7-12" id="h9-7-12" class="i">+                ..
</a><a href="#h9-7-13" id="h9-7-13" class="i">+            } =&gt; {
</a>                 let kind = if *outer { &quot;outer&quot; } else { &quot;inner&quot; };
                 // TODO: make Label a proper type with formatting.
<a href="#h9-7-16" id="h9-7-16" class="d">-                let left_label = match left_field {
</a><a href="#h9-7-17" id="h9-7-17" class="d">-                    (_, Some((Some(t), n))) =&gt; format!(&quot;{t}.{n}&quot;),
</a><a href="#h9-7-18" id="h9-7-18" class="d">-                    (_, Some((None, n))) =&gt; n.clone(),
</a><a href="#h9-7-19" id="h9-7-19" class="d">-                    (i, None) =&gt; format!(&quot;left #{}&quot;, i),
</a><a href="#h9-7-20" id="h9-7-20" class="i">+                let left_label = match left_label {
</a><a href="#h9-7-21" id="h9-7-21" class="i">+                    Some((Some(t), n)) =&gt; format!(&quot;{t}.{n}&quot;),
</a><a href="#h9-7-22" id="h9-7-22" class="i">+                    Some((None, n)) =&gt; n.clone(),
</a><a href="#h9-7-23" id="h9-7-23" class="i">+                    None =&gt; format!(&quot;left #{left_field}&quot;),
</a>                 };
<a href="#h9-7-25" id="h9-7-25" class="d">-                let right_label = match right_field {
</a><a href="#h9-7-26" id="h9-7-26" class="d">-                    (_, Some((Some(t), n))) =&gt; format!(&quot;{t}.{n}&quot;),
</a><a href="#h9-7-27" id="h9-7-27" class="d">-                    (_, Some((None, n))) =&gt; n.clone(),
</a><a href="#h9-7-28" id="h9-7-28" class="d">-                    (i, None) =&gt; format!(&quot;right #{}&quot;, i),
</a><a href="#h9-7-29" id="h9-7-29" class="i">+                let right_label = match right_label {
</a><a href="#h9-7-30" id="h9-7-30" class="i">+                    Some((Some(t), n)) =&gt; format!(&quot;{t}.{n}&quot;),
</a><a href="#h9-7-31" id="h9-7-31" class="i">+                    Some((None, n)) =&gt; n.clone(),
</a><a href="#h9-7-32" id="h9-7-32" class="i">+                    None =&gt; format!(&quot;right #{right_field}&quot;),
</a>                 };
                 write!(f, &quot;HashJoin: {kind} on {left_label} = {right_label}&quot;)?;
                 left.format(f, prefix.clone(), false, false)?;
                 right.format(f, prefix, false, true)?;
             }
             Self::IndexLookup { table, column, alias, values } =&gt; {
<a href="#h9-7-39" id="h9-7-39" class="d">-                write!(f, &quot;IndexLookup: {}&quot;, table.name)?;
</a><a href="#h9-7-40" id="h9-7-40" class="i">+                write!(f, &quot;IndexLookup: {table}&quot;)?;
</a>                 if let Some(alias) = alias {
                     write!(f, &quot; as {}&quot;, alias)?;
                 }
<a href="#h9-8" id="h9-8" class="h">@@ -354,7 +387,7 @@ impl Node {
</a>                 }
             }
             Self::KeyLookup { table, alias, keys } =&gt; {
<a href="#h9-8-3" id="h9-8-3" class="d">-                write!(f, &quot;KeyLookup: {}&quot;, table.name)?;
</a><a href="#h9-8-4" id="h9-8-4" class="i">+                write!(f, &quot;KeyLookup: {table}&quot;)?;
</a>                 if let Some(alias) = alias {
                     write!(f, &quot; as {alias}&quot;)?;
                 }
<b>diff --git a/<a id="h10" href="../file/src/sql/planner/planner.rs.html">src/sql/planner/planner.rs</a> b/<a href="../file/src/sql/planner/planner.rs.html">src/sql/planner/planner.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -104,7 +104,6 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 }
             }
         }
<a href="#h10-0-3" id="h10-0-3" class="d">-        let labels = vec![None; values.len()];
</a>         let scope = Scope::new();
         let rows = values
             .into_iter()
<a href="#h10-1" id="h10-1" class="h">@@ -112,7 +111,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 exprs.into_iter().map(|expr| Self::build_expression(expr, &amp;scope)).collect()
             })
             .collect::&lt;Result&lt;_&gt;&gt;()?;
<a href="#h10-1-3" id="h10-1-3" class="d">-        Ok(Plan::Insert { table, column_map, source: Node::Values { labels, rows } })
</a><a href="#h10-1-4" id="h10-1-4" class="i">+        Ok(Plan::Insert { table, column_map, source: Node::Values { rows } })
</a>     }
 
     /// Builds an UPDATE plan.
<a href="#h10-2" id="h10-2" class="h">@@ -297,6 +296,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 left: Box::new(node),
                 left_size: scope.len(),
                 right: Box::new(right),
<a href="#h10-2-3" id="h10-2-3" class="i">+                right_size: right_scope.len(),
</a>                 predicate: None,
                 outer: false,
             };
<a href="#h10-3" id="h10-3" class="h">@@ -328,11 +328,13 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 let left = Box::new(self.build_from(*left, scope)?);
                 let left_size = scope.len();
                 let right = Box::new(self.build_from(*right, scope)?);
<a href="#h10-3-3" id="h10-3-3" class="i">+                let right_size = scope.len() - left_size;
</a> 
                 //  Build the join node.
                 let predicate = predicate.map(|e| Self::build_expression(e, scope)).transpose()?;
                 let outer = r#type.is_outer();
<a href="#h10-3-8" id="h10-3-8" class="d">-                let mut node = Node::NestedLoopJoin { left, left_size, right, predicate, outer };
</a><a href="#h10-3-9" id="h10-3-9" class="i">+                let mut node =
</a><a href="#h10-3-10" id="h10-3-10" class="i">+                    Node::NestedLoopJoin { left, left_size, right, right_size, predicate, outer };
</a> 
                 // For right joins, build a projection to swap the columns.
                 if matches!(r#type, ast::JoinType::Right) {
<a href="#h10-4" id="h10-4" class="h">@@ -392,6 +394,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         )?;
         let node = Node::Aggregation {
             source: Box::new(Node::Projection { source: Box::new(source), labels, expressions }),
<a href="#h10-4-3" id="h10-4-3" class="i">+            group_by: scope.len() - aggregates.len(),
</a>             aggregates,
         };
         Ok(node)
<a href="#h10-5" id="h10-5" class="h">@@ -700,8 +703,7 @@ impl Scope {
</a>     }
 
     /// Fetches a column label by index, if any.
<a href="#h10-5-3" id="h10-5-3" class="d">-    /// TODO: this can possibly be removed if execution doesn&#39;t have to pass
</a><a href="#h10-5-4" id="h10-5-4" class="d">-    /// columns through QueryIterator.
</a><a href="#h10-5-5" id="h10-5-5" class="i">+    /// TODO: this can possibly be removed.
</a>     fn get_column_label(&amp;self, index: usize) -&gt; Result&lt;Option&lt;Label&gt;&gt; {
         if self.columns.is_empty() {
             return errinput!(&quot;expression must be constant, found column index {index}&quot;);
<b>diff --git a/<a id="h11" href="../file/tests/e2e/client.rs.html">tests/e2e/client.rs</a> b/<a href="../file/tests/e2e/client.rs.html">tests/e2e/client.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -158,7 +158,10 @@ fn execute() -&gt; Result&lt;()&gt; {
</a>     assert_eq!(
         result,
         StatementResult::Select {
<a href="#h11-0-3" id="h11-0-3" class="d">-            columns: vec![Some((None, &quot;id&quot;.into())), Some((None, &quot;name&quot;.into()))],
</a><a href="#h11-0-4" id="h11-0-4" class="i">+            columns: vec![
</a><a href="#h11-0-5" id="h11-0-5" class="i">+                Some((Some(&quot;genres&quot;.into()), &quot;id&quot;.into())),
</a><a href="#h11-0-6" id="h11-0-6" class="i">+                Some((Some(&quot;genres&quot;.into()), &quot;name&quot;.into()))
</a><a href="#h11-0-7" id="h11-0-7" class="i">+            ],
</a>             rows: vec![
                 vec![Value::Integer(1), Value::String(&quot;Science Fiction&quot;.into())],
                 vec![Value::Integer(2), Value::String(&quot;Action&quot;.into())],
<a href="#h11-1" id="h11-1" class="h">@@ -171,7 +174,10 @@ fn execute() -&gt; Result&lt;()&gt; {
</a>     assert_eq!(
         result,
         StatementResult::Select {
<a href="#h11-1-3" id="h11-1-3" class="d">-            columns: vec![Some((None, &quot;id&quot;.into())), Some((None, &quot;name&quot;.into()))],
</a><a href="#h11-1-4" id="h11-1-4" class="i">+            columns: vec![
</a><a href="#h11-1-5" id="h11-1-5" class="i">+                Some((Some(&quot;genres&quot;.into()), &quot;id&quot;.into())),
</a><a href="#h11-1-6" id="h11-1-6" class="i">+                Some((Some(&quot;genres&quot;.into()), &quot;name&quot;.into()))
</a><a href="#h11-1-7" id="h11-1-7" class="i">+            ],
</a>             rows: vec![],
         }
     );
<b>diff --git a/<a id="h12" href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a> b/<a href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -209,6 +209,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h12-0-3" id="h12-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h12-1" id="h12-1" class="h">@@ -359,6 +360,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h12-1-3" id="h12-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a> b/<a href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -181,6 +181,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h13-0-3" id="h13-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h13-1" id="h13-1" class="h">@@ -317,6 +318,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h13-1-3" id="h13-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h14" href="../file/tests/sql/query/agg_const.html">tests/sql/query/agg_const</a> b/<a href="../file/tests/sql/query/agg_const.html">tests/sql/query/agg_const</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -133,6 +133,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h14-0-3" id="h14-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h14-1" id="h14-1" class="h">@@ -220,6 +221,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h14-1-3" id="h14-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a> b/<a href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -165,6 +165,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h15-0-3" id="h15-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h15-1" id="h15-1" class="h">@@ -279,6 +280,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h15-1-3" id="h15-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a> b/<a href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -138,6 +138,7 @@ Plan: Select {
</a>             aggregates: [
                 Count,
             ],
<a href="#h16-0-3" id="h16-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h16-1" id="h16-1" class="h">@@ -253,6 +254,7 @@ Optimized plan: Select {
</a>             aggregates: [
                 Count,
             ],
<a href="#h16-1-3" id="h16-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a> b/<a href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -178,6 +178,7 @@ Plan: Select {
</a>                 Sum,
                 Count,
             ],
<a href="#h17-0-3" id="h17-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Divide(
<a href="#h17-1" id="h17-1" class="h">@@ -317,6 +318,7 @@ Optimized plan: Select {
</a>                 Sum,
                 Count,
             ],
<a href="#h17-1-3" id="h17-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Divide(
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a> b/<a href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -210,6 +210,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h18-0-3" id="h18-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h18-1" id="h18-1" class="h">@@ -360,6 +361,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h18-1-3" id="h18-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a> b/<a href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -182,6 +182,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h19-0-3" id="h19-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h19-1" id="h19-1" class="h">@@ -318,6 +319,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h19-1-3" id="h19-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a> b/<a href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -210,6 +210,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h20-0-3" id="h20-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h20-1" id="h20-1" class="h">@@ -360,6 +361,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h20-1-3" id="h20-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a> b/<a href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -182,6 +182,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h21-0-3" id="h21-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h21-1" id="h21-1" class="h">@@ -318,6 +319,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h21-1-3" id="h21-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h22" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -246,6 +246,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h22-0-3" id="h22-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h22-1" id="h22-1" class="h">@@ -439,6 +440,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h22-1-3" id="h22-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -260,6 +260,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h23-0-3" id="h23-0-3" class="i">+            group_by: 1,
</a>         },
         expressions: [
             Field(
<a href="#h23-1" id="h23-1" class="h">@@ -463,6 +464,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h23-1-3" id="h23-1-3" class="i">+            group_by: 1,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a> b/<a href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -209,6 +209,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h24-0-3" id="h24-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h24-1" id="h24-1" class="h">@@ -359,6 +360,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h24-1-3" id="h24-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a> b/<a href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -181,6 +181,7 @@ Plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h25-0-3" id="h25-0-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<a href="#h25-1" id="h25-1" class="h">@@ -317,6 +318,7 @@ Optimized plan: Select {
</a>                 Count,
                 Average,
             ],
<a href="#h25-1-3" id="h25-1-3" class="i">+            group_by: 0,
</a>         },
         expressions: [
             Field(
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a> b/<a href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -198,6 +198,7 @@ Plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h26-0-3" id="h26-0-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<a href="#h26-1" id="h26-1" class="h">@@ -367,6 +368,7 @@ Optimized plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h26-1-3" id="h26-1-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a> b/<a href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -190,6 +190,7 @@ Plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h27-0-3" id="h27-0-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<a href="#h27-1" id="h27-1" class="h">@@ -355,6 +356,7 @@ Optimized plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h27-1-3" id="h27-1-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a> b/<a href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -236,6 +236,7 @@ Plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h28-0-3" id="h28-0-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<a href="#h28-1" id="h28-1" class="h">@@ -268,6 +269,7 @@ Plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h28-1-3" id="h28-1-3" class="i">+        right_size: 2,
</a>         predicate: None,
         outer: false,
     },
<a href="#h28-2" id="h28-2" class="h">@@ -476,6 +478,7 @@ Optimized plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h28-2-3" id="h28-2-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<a href="#h28-3" id="h28-3" class="h">@@ -508,6 +511,7 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h28-3-3" id="h28-3-3" class="i">+        right_size: 2,
</a>         predicate: None,
         outer: false,
     },
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a> b/<a href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -187,6 +187,7 @@ Plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h29-0-3" id="h29-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h29-1" id="h29-1" class="h">@@ -349,6 +350,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h29-1-3" id="h29-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a> b/<a href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -213,6 +213,7 @@ Plan: Select {
</a>                     Sum,
                     Count,
                 ],
<a href="#h30-0-3" id="h30-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h30-1" id="h30-1" class="h">@@ -400,6 +401,7 @@ Optimized plan: Select {
</a>                     Sum,
                     Count,
                 ],
<a href="#h30-1-3" id="h30-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h31" href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a> b/<a href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -221,6 +221,7 @@ Plan: Select {
</a>                     Sum,
                     Count,
                 ],
<a href="#h31-0-3" id="h31-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h31-1" id="h31-1" class="h">@@ -419,6 +420,7 @@ Optimized plan: Select {
</a>                     Sum,
                     Count,
                 ],
<a href="#h31-1-3" id="h31-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a> b/<a href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -199,6 +199,7 @@ Plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h32-0-3" id="h32-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h32-1" id="h32-1" class="h">@@ -377,6 +378,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h32-1-3" id="h32-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a> b/<a href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -203,6 +203,7 @@ Plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h33-0-3" id="h33-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h33-1" id="h33-1" class="h">@@ -371,6 +372,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h33-1-3" id="h33-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h34" href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a> b/<a href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -212,6 +212,7 @@ Plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h34-0-3" id="h34-0-3" class="i">+                group_by: 2,
</a>             },
             expressions: [
                 Add(
<a href="#h34-1" id="h34-1" class="h">@@ -421,6 +422,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h34-1-3" id="h34-1-3" class="i">+                group_by: 2,
</a>             },
             expressions: [
                 Add(
<b>diff --git a/<a id="h35" href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a> b/<a href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -187,6 +187,7 @@ Plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h35-0-3" id="h35-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Multiply(
<a href="#h35-1" id="h35-1" class="h">@@ -360,6 +361,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h35-1-3" id="h35-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Multiply(
<b>diff --git a/<a id="h36" href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a> b/<a href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -233,6 +233,7 @@ Plan: Select {
</a>                                 &quot;s&quot;,
                             ),
                         },
<a href="#h36-0-3" id="h36-0-3" class="i">+                        right_size: 3,
</a>                         predicate: Some(
                             Equal(
                                 Field(
<a href="#h36-1" id="h36-1" class="h">@@ -287,6 +288,7 @@ Plan: Select {
</a>                 aggregates: [
                     Count,
                 ],
<a href="#h36-1-3" id="h36-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h36-2" id="h36-2" class="h">@@ -429,15 +431,13 @@ Optimized plan: Select {
</a>                                 &quot;m&quot;,
                             ),
                         },
<a href="#h36-2-3" id="h36-2-3" class="d">-                        left_field: (
</a><a href="#h36-2-4" id="h36-2-4" class="d">-                            2,
</a><a href="#h36-2-5" id="h36-2-5" class="d">-                            Some(
</a><a href="#h36-2-6" id="h36-2-6" class="d">-                                (
</a><a href="#h36-2-7" id="h36-2-7" class="d">-                                    Some(
</a><a href="#h36-2-8" id="h36-2-8" class="d">-                                        &quot;m&quot;,
</a><a href="#h36-2-9" id="h36-2-9" class="d">-                                    ),
</a><a href="#h36-2-10" id="h36-2-10" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h36-2-11" id="h36-2-11" class="i">+                        left_field: 2,
</a><a href="#h36-2-12" id="h36-2-12" class="i">+                        left_label: Some(
</a><a href="#h36-2-13" id="h36-2-13" class="i">+                            (
</a><a href="#h36-2-14" id="h36-2-14" class="i">+                                Some(
</a><a href="#h36-2-15" id="h36-2-15" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h36-2-17" id="h36-2-17" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
                         right: Scan {
<a href="#h36-3" id="h36-3" class="h">@@ -483,17 +483,16 @@ Optimized plan: Select {
</a>                                 &quot;s&quot;,
                             ),
                         },
<a href="#h36-3-3" id="h36-3-3" class="d">-                        right_field: (
</a><a href="#h36-3-4" id="h36-3-4" class="d">-                            0,
</a><a href="#h36-3-5" id="h36-3-5" class="d">-                            Some(
</a><a href="#h36-3-6" id="h36-3-6" class="d">-                                (
</a><a href="#h36-3-7" id="h36-3-7" class="d">-                                    Some(
</a><a href="#h36-3-8" id="h36-3-8" class="d">-                                        &quot;s&quot;,
</a><a href="#h36-3-9" id="h36-3-9" class="d">-                                    ),
</a><a href="#h36-3-10" id="h36-3-10" class="d">-                                    &quot;id&quot;,
</a><a href="#h36-3-11" id="h36-3-11" class="i">+                        right_field: 0,
</a><a href="#h36-3-12" id="h36-3-12" class="i">+                        right_label: Some(
</a><a href="#h36-3-13" id="h36-3-13" class="i">+                            (
</a><a href="#h36-3-14" id="h36-3-14" class="i">+                                Some(
</a><a href="#h36-3-15" id="h36-3-15" class="i">+                                    &quot;s&quot;,
</a>                                 ),
<a href="#h36-3-17" id="h36-3-17" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h36-3-20" id="h36-3-20" class="i">+                        right_size: 3,
</a>                         outer: false,
                     },
                     expressions: [
<a href="#h36-4" id="h36-4" class="h">@@ -522,6 +521,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Count,
                 ],
<a href="#h36-4-3" id="h36-4-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h37" href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a> b/<a href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -158,6 +158,7 @@ Plan: Select {
</a>                     ],
                 },
                 aggregates: [],
<a href="#h37-0-3" id="h37-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h37-1" id="h37-1" class="h">@@ -307,6 +308,7 @@ Optimized plan: Select {
</a>                     ],
                 },
                 aggregates: [],
<a href="#h37-1-3" id="h37-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h38" href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a> b/<a href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -171,6 +171,7 @@ Plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h38-0-3" id="h38-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h38-1" id="h38-1" class="h">@@ -326,6 +327,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h38-1-3" id="h38-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h39" href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a> b/<a href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -176,6 +176,7 @@ Plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h39-0-3" id="h39-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h39-1" id="h39-1" class="h">@@ -343,6 +344,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h39-1-3" id="h39-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h40" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -192,6 +192,7 @@ Plan: Select {
</a>                     aggregates: [
                         Max,
                     ],
<a href="#h40-0-3" id="h40-0-3" class="i">+                    group_by: 1,
</a>                 },
                 expressions: [
                     Field(
<a href="#h40-1" id="h40-1" class="h">@@ -387,6 +388,7 @@ Optimized plan: Select {
</a>                     aggregates: [
                         Max,
                     ],
<a href="#h40-1-3" id="h40-1-3" class="i">+                    group_by: 1,
</a>                 },
                 expressions: [
                     Field(
<b>diff --git a/<a id="h41" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -209,6 +209,7 @@ Plan: Select {
</a>                             Max,
                             Min,
                         ],
<a href="#h41-0-3" id="h41-0-3" class="i">+                        group_by: 1,
</a>                     },
                     expressions: [
                         Field(
<a href="#h41-1" id="h41-1" class="h">@@ -421,6 +422,7 @@ Optimized plan: Select {
</a>                             Max,
                             Min,
                         ],
<a href="#h41-1-3" id="h41-1-3" class="i">+                        group_by: 1,
</a>                     },
                     expressions: [
                         Field(
<b>diff --git a/<a id="h42" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -233,6 +233,7 @@ Plan: Select {
</a>                             Max,
                             Min,
                         ],
<a href="#h42-0-3" id="h42-0-3" class="i">+                        group_by: 1,
</a>                     },
                     expressions: [
                         Field(
<a href="#h42-1" id="h42-1" class="h">@@ -467,6 +468,7 @@ Optimized plan: Select {
</a>                             Max,
                             Min,
                         ],
<a href="#h42-1-3" id="h42-1-3" class="i">+                        group_by: 1,
</a>                     },
                     expressions: [
                         Field(
<b>diff --git a/<a id="h43" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -194,6 +194,7 @@ Plan: Select {
</a>                         aggregates: [
                             Max,
                         ],
<a href="#h43-0-3" id="h43-0-3" class="i">+                        group_by: 1,
</a>                     },
                     expressions: [
                         Field(
<a href="#h43-1" id="h43-1" class="h">@@ -437,6 +438,7 @@ Optimized plan: Select {
</a>                         aggregates: [
                             Max,
                         ],
<a href="#h43-1-3" id="h43-1-3" class="i">+                        group_by: 1,
</a>                     },
                     expressions: [
                         Field(
<b>diff --git a/<a id="h44" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -185,6 +185,7 @@ Plan: Select {
</a>                         aggregates: [
                             Max,
                         ],
<a href="#h44-0-3" id="h44-0-3" class="i">+                        group_by: 1,
</a>                     },
                     expressions: [
                         Field(
<a href="#h44-1" id="h44-1" class="h">@@ -375,6 +376,7 @@ Optimized plan: Select {
</a>                         aggregates: [
                             Max,
                         ],
<a href="#h44-1-3" id="h44-1-3" class="i">+                        group_by: 1,
</a>                     },
                     expressions: [
                         Field(
<b>diff --git a/<a id="h45" href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a> b/<a href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -173,6 +173,7 @@ Plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h45-0-3" id="h45-0-3" class="i">+        right_size: 2,
</a>         predicate: None,
         outer: false,
     },
<a href="#h45-1" id="h45-1" class="h">@@ -364,6 +365,7 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h45-1-3" id="h45-1-3" class="i">+        right_size: 2,
</a>         predicate: None,
         outer: false,
     },
<b>diff --git a/<a id="h46" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -296,6 +296,7 @@ Plan: Select {
</a>                             &quot;g&quot;,
                         ),
                     },
<a href="#h46-0-3" id="h46-0-3" class="i">+                    right_size: 2,
</a>                     predicate: None,
                     outer: false,
                 },
<a href="#h46-1" id="h46-1" class="h">@@ -330,6 +331,7 @@ Plan: Select {
</a>                         &quot;c&quot;,
                     ),
                 },
<a href="#h46-1-3" id="h46-1-3" class="i">+                right_size: 2,
</a>                 predicate: None,
                 outer: false,
             },
<a href="#h46-2" id="h46-2" class="h">@@ -671,39 +673,17 @@ Optimized plan: Select {
</a>                 },
                 left_size: 7,
                 right: KeyLookup {
<a href="#h46-2-3" id="h46-2-3" class="d">-                    table: Table {
</a><a href="#h46-2-4" id="h46-2-4" class="d">-                        name: &quot;genres&quot;,
</a><a href="#h46-2-5" id="h46-2-5" class="d">-                        primary_key: 0,
</a><a href="#h46-2-6" id="h46-2-6" class="d">-                        columns: [
</a><a href="#h46-2-7" id="h46-2-7" class="d">-                            Column {
</a><a href="#h46-2-8" id="h46-2-8" class="d">-                                name: &quot;id&quot;,
</a><a href="#h46-2-9" id="h46-2-9" class="d">-                                datatype: Integer,
</a><a href="#h46-2-10" id="h46-2-10" class="d">-                                nullable: false,
</a><a href="#h46-2-11" id="h46-2-11" class="d">-                                default: None,
</a><a href="#h46-2-12" id="h46-2-12" class="d">-                                unique: true,
</a><a href="#h46-2-13" id="h46-2-13" class="d">-                                index: false,
</a><a href="#h46-2-14" id="h46-2-14" class="d">-                                references: None,
</a><a href="#h46-2-15" id="h46-2-15" class="d">-                            },
</a><a href="#h46-2-16" id="h46-2-16" class="d">-                            Column {
</a><a href="#h46-2-17" id="h46-2-17" class="d">-                                name: &quot;name&quot;,
</a><a href="#h46-2-18" id="h46-2-18" class="d">-                                datatype: String,
</a><a href="#h46-2-19" id="h46-2-19" class="d">-                                nullable: false,
</a><a href="#h46-2-20" id="h46-2-20" class="d">-                                default: None,
</a><a href="#h46-2-21" id="h46-2-21" class="d">-                                unique: false,
</a><a href="#h46-2-22" id="h46-2-22" class="d">-                                index: false,
</a><a href="#h46-2-23" id="h46-2-23" class="d">-                                references: None,
</a><a href="#h46-2-24" id="h46-2-24" class="d">-                            },
</a><a href="#h46-2-25" id="h46-2-25" class="d">-                        ],
</a><a href="#h46-2-26" id="h46-2-26" class="d">-                    },
</a><a href="#h46-2-27" id="h46-2-27" class="d">-                    alias: Some(
</a><a href="#h46-2-28" id="h46-2-28" class="d">-                        &quot;g&quot;,
</a><a href="#h46-2-29" id="h46-2-29" class="d">-                    ),
</a><a href="#h46-2-30" id="h46-2-30" class="i">+                    table: &quot;genres&quot;,
</a>                     keys: [
                         Integer(
                             2,
                         ),
                     ],
<a href="#h46-2-36" id="h46-2-36" class="i">+                    alias: Some(
</a><a href="#h46-2-37" id="h46-2-37" class="i">+                        &quot;g&quot;,
</a><a href="#h46-2-38" id="h46-2-38" class="i">+                    ),
</a>                 },
<a href="#h46-2-40" id="h46-2-40" class="i">+                right_size: 2,
</a>                 predicate: None,
                 outer: false,
             },
<a href="#h46-3" id="h46-3" class="h">@@ -759,6 +739,7 @@ Optimized plan: Select {
</a>                     &quot;c&quot;,
                 ),
             },
<a href="#h46-3-3" id="h46-3-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<b>diff --git a/<a id="h47" href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a> b/<a href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -525,6 +525,7 @@ Plan: Select {
</a>                     filter: None,
                     alias: None,
                 },
<a href="#h47-0-3" id="h47-0-3" class="i">+                right_size: 2,
</a>                 predicate: None,
                 outer: false,
             },
<a href="#h47-1" id="h47-1" class="h">@@ -557,6 +558,7 @@ Plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h47-1-3" id="h47-1-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<a href="#h47-2" id="h47-2" class="h">@@ -602,6 +604,7 @@ Plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h47-2-3" id="h47-2-3" class="i">+        right_size: 3,
</a>         predicate: None,
         outer: false,
     },
<a href="#h47-3" id="h47-3" class="h">@@ -835,6 +838,7 @@ Optimized plan: Select {
</a>                     filter: None,
                     alias: None,
                 },
<a href="#h47-3-3" id="h47-3-3" class="i">+                right_size: 2,
</a>                 predicate: None,
                 outer: false,
             },
<a href="#h47-4" id="h47-4" class="h">@@ -867,6 +871,7 @@ Optimized plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h47-4-3" id="h47-4-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<a href="#h47-5" id="h47-5" class="h">@@ -912,6 +917,7 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h47-5-3" id="h47-5-3" class="i">+        right_size: 3,
</a>         predicate: None,
         outer: false,
     },
<b>diff --git a/<a id="h48" href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a> b/<a href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -170,6 +170,7 @@ Plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h48-0-3" id="h48-0-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             Equal(
                 Field(
<a href="#h48-1" id="h48-1" class="h">@@ -357,15 +358,13 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h48-1-3" id="h48-1-3" class="d">-        left_field: (
</a><a href="#h48-1-4" id="h48-1-4" class="d">-            3,
</a><a href="#h48-1-5" id="h48-1-5" class="d">-            Some(
</a><a href="#h48-1-6" id="h48-1-6" class="d">-                (
</a><a href="#h48-1-7" id="h48-1-7" class="d">-                    Some(
</a><a href="#h48-1-8" id="h48-1-8" class="d">-                        &quot;movies&quot;,
</a><a href="#h48-1-9" id="h48-1-9" class="d">-                    ),
</a><a href="#h48-1-10" id="h48-1-10" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h48-1-11" id="h48-1-11" class="i">+        left_field: 3,
</a><a href="#h48-1-12" id="h48-1-12" class="i">+        left_label: Some(
</a><a href="#h48-1-13" id="h48-1-13" class="i">+            (
</a><a href="#h48-1-14" id="h48-1-14" class="i">+                Some(
</a><a href="#h48-1-15" id="h48-1-15" class="i">+                    &quot;movies&quot;,
</a>                 ),
<a href="#h48-1-17" id="h48-1-17" class="i">+                &quot;genre_id&quot;,
</a>             ),
         ),
         right: Scan {
<a href="#h48-2" id="h48-2" class="h">@@ -396,17 +395,16 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h48-2-3" id="h48-2-3" class="d">-        right_field: (
</a><a href="#h48-2-4" id="h48-2-4" class="d">-            0,
</a><a href="#h48-2-5" id="h48-2-5" class="d">-            Some(
</a><a href="#h48-2-6" id="h48-2-6" class="d">-                (
</a><a href="#h48-2-7" id="h48-2-7" class="d">-                    Some(
</a><a href="#h48-2-8" id="h48-2-8" class="d">-                        &quot;genres&quot;,
</a><a href="#h48-2-9" id="h48-2-9" class="d">-                    ),
</a><a href="#h48-2-10" id="h48-2-10" class="d">-                    &quot;id&quot;,
</a><a href="#h48-2-11" id="h48-2-11" class="i">+        right_field: 0,
</a><a href="#h48-2-12" id="h48-2-12" class="i">+        right_label: Some(
</a><a href="#h48-2-13" id="h48-2-13" class="i">+            (
</a><a href="#h48-2-14" id="h48-2-14" class="i">+                Some(
</a><a href="#h48-2-15" id="h48-2-15" class="i">+                    &quot;genres&quot;,
</a>                 ),
<a href="#h48-2-17" id="h48-2-17" class="i">+                &quot;id&quot;,
</a>             ),
         ),
<a href="#h48-2-20" id="h48-2-20" class="i">+        right_size: 2,
</a>         outer: false,
     },
     labels: [
<b>diff --git a/<a id="h49" href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a> b/<a href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -170,6 +170,7 @@ Plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h49-0-3" id="h49-0-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             Equal(
                 Field(
<a href="#h49-1" id="h49-1" class="h">@@ -357,15 +358,13 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h49-1-3" id="h49-1-3" class="d">-        left_field: (
</a><a href="#h49-1-4" id="h49-1-4" class="d">-            3,
</a><a href="#h49-1-5" id="h49-1-5" class="d">-            Some(
</a><a href="#h49-1-6" id="h49-1-6" class="d">-                (
</a><a href="#h49-1-7" id="h49-1-7" class="d">-                    Some(
</a><a href="#h49-1-8" id="h49-1-8" class="d">-                        &quot;movies&quot;,
</a><a href="#h49-1-9" id="h49-1-9" class="d">-                    ),
</a><a href="#h49-1-10" id="h49-1-10" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h49-1-11" id="h49-1-11" class="i">+        left_field: 3,
</a><a href="#h49-1-12" id="h49-1-12" class="i">+        left_label: Some(
</a><a href="#h49-1-13" id="h49-1-13" class="i">+            (
</a><a href="#h49-1-14" id="h49-1-14" class="i">+                Some(
</a><a href="#h49-1-15" id="h49-1-15" class="i">+                    &quot;movies&quot;,
</a>                 ),
<a href="#h49-1-17" id="h49-1-17" class="i">+                &quot;genre_id&quot;,
</a>             ),
         ),
         right: Scan {
<a href="#h49-2" id="h49-2" class="h">@@ -396,17 +395,16 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h49-2-3" id="h49-2-3" class="d">-        right_field: (
</a><a href="#h49-2-4" id="h49-2-4" class="d">-            0,
</a><a href="#h49-2-5" id="h49-2-5" class="d">-            Some(
</a><a href="#h49-2-6" id="h49-2-6" class="d">-                (
</a><a href="#h49-2-7" id="h49-2-7" class="d">-                    Some(
</a><a href="#h49-2-8" id="h49-2-8" class="d">-                        &quot;genres&quot;,
</a><a href="#h49-2-9" id="h49-2-9" class="d">-                    ),
</a><a href="#h49-2-10" id="h49-2-10" class="d">-                    &quot;id&quot;,
</a><a href="#h49-2-11" id="h49-2-11" class="i">+        right_field: 0,
</a><a href="#h49-2-12" id="h49-2-12" class="i">+        right_label: Some(
</a><a href="#h49-2-13" id="h49-2-13" class="i">+            (
</a><a href="#h49-2-14" id="h49-2-14" class="i">+                Some(
</a><a href="#h49-2-15" id="h49-2-15" class="i">+                    &quot;genres&quot;,
</a>                 ),
<a href="#h49-2-17" id="h49-2-17" class="i">+                &quot;id&quot;,
</a>             ),
         ),
<a href="#h49-2-20" id="h49-2-20" class="i">+        right_size: 2,
</a>         outer: false,
     },
     labels: [
<b>diff --git a/<a id="h50" href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -187,6 +187,7 @@ Plan: Select {
</a>                 &quot;g&quot;,
             ),
         },
<a href="#h50-0-3" id="h50-0-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             And(
                 Equal(
<a href="#h50-1" id="h50-1" class="h">@@ -314,149 +315,47 @@ Plan: Select {
</a> Optimized plan: Select {
     root: HashJoin {
         left: IndexLookup {
<a href="#h50-1-3" id="h50-1-3" class="d">-            table: Table {
</a><a href="#h50-1-4" id="h50-1-4" class="d">-                name: &quot;movies&quot;,
</a><a href="#h50-1-5" id="h50-1-5" class="d">-                primary_key: 0,
</a><a href="#h50-1-6" id="h50-1-6" class="d">-                columns: [
</a><a href="#h50-1-7" id="h50-1-7" class="d">-                    Column {
</a><a href="#h50-1-8" id="h50-1-8" class="d">-                        name: &quot;id&quot;,
</a><a href="#h50-1-9" id="h50-1-9" class="d">-                        datatype: Integer,
</a><a href="#h50-1-10" id="h50-1-10" class="d">-                        nullable: false,
</a><a href="#h50-1-11" id="h50-1-11" class="d">-                        default: None,
</a><a href="#h50-1-12" id="h50-1-12" class="d">-                        unique: true,
</a><a href="#h50-1-13" id="h50-1-13" class="d">-                        index: false,
</a><a href="#h50-1-14" id="h50-1-14" class="d">-                        references: None,
</a><a href="#h50-1-15" id="h50-1-15" class="d">-                    },
</a><a href="#h50-1-16" id="h50-1-16" class="d">-                    Column {
</a><a href="#h50-1-17" id="h50-1-17" class="d">-                        name: &quot;title&quot;,
</a><a href="#h50-1-18" id="h50-1-18" class="d">-                        datatype: String,
</a><a href="#h50-1-19" id="h50-1-19" class="d">-                        nullable: false,
</a><a href="#h50-1-20" id="h50-1-20" class="d">-                        default: None,
</a><a href="#h50-1-21" id="h50-1-21" class="d">-                        unique: false,
</a><a href="#h50-1-22" id="h50-1-22" class="d">-                        index: false,
</a><a href="#h50-1-23" id="h50-1-23" class="d">-                        references: None,
</a><a href="#h50-1-24" id="h50-1-24" class="d">-                    },
</a><a href="#h50-1-25" id="h50-1-25" class="d">-                    Column {
</a><a href="#h50-1-26" id="h50-1-26" class="d">-                        name: &quot;studio_id&quot;,
</a><a href="#h50-1-27" id="h50-1-27" class="d">-                        datatype: Integer,
</a><a href="#h50-1-28" id="h50-1-28" class="d">-                        nullable: false,
</a><a href="#h50-1-29" id="h50-1-29" class="d">-                        default: None,
</a><a href="#h50-1-30" id="h50-1-30" class="d">-                        unique: false,
</a><a href="#h50-1-31" id="h50-1-31" class="d">-                        index: true,
</a><a href="#h50-1-32" id="h50-1-32" class="d">-                        references: Some(
</a><a href="#h50-1-33" id="h50-1-33" class="d">-                            &quot;studios&quot;,
</a><a href="#h50-1-34" id="h50-1-34" class="d">-                        ),
</a><a href="#h50-1-35" id="h50-1-35" class="d">-                    },
</a><a href="#h50-1-36" id="h50-1-36" class="d">-                    Column {
</a><a href="#h50-1-37" id="h50-1-37" class="d">-                        name: &quot;genre_id&quot;,
</a><a href="#h50-1-38" id="h50-1-38" class="d">-                        datatype: Integer,
</a><a href="#h50-1-39" id="h50-1-39" class="d">-                        nullable: false,
</a><a href="#h50-1-40" id="h50-1-40" class="d">-                        default: None,
</a><a href="#h50-1-41" id="h50-1-41" class="d">-                        unique: false,
</a><a href="#h50-1-42" id="h50-1-42" class="d">-                        index: true,
</a><a href="#h50-1-43" id="h50-1-43" class="d">-                        references: Some(
</a><a href="#h50-1-44" id="h50-1-44" class="d">-                            &quot;genres&quot;,
</a><a href="#h50-1-45" id="h50-1-45" class="d">-                        ),
</a><a href="#h50-1-46" id="h50-1-46" class="d">-                    },
</a><a href="#h50-1-47" id="h50-1-47" class="d">-                    Column {
</a><a href="#h50-1-48" id="h50-1-48" class="d">-                        name: &quot;released&quot;,
</a><a href="#h50-1-49" id="h50-1-49" class="d">-                        datatype: Integer,
</a><a href="#h50-1-50" id="h50-1-50" class="d">-                        nullable: false,
</a><a href="#h50-1-51" id="h50-1-51" class="d">-                        default: None,
</a><a href="#h50-1-52" id="h50-1-52" class="d">-                        unique: false,
</a><a href="#h50-1-53" id="h50-1-53" class="d">-                        index: false,
</a><a href="#h50-1-54" id="h50-1-54" class="d">-                        references: None,
</a><a href="#h50-1-55" id="h50-1-55" class="d">-                    },
</a><a href="#h50-1-56" id="h50-1-56" class="d">-                    Column {
</a><a href="#h50-1-57" id="h50-1-57" class="d">-                        name: &quot;rating&quot;,
</a><a href="#h50-1-58" id="h50-1-58" class="d">-                        datatype: Float,
</a><a href="#h50-1-59" id="h50-1-59" class="d">-                        nullable: true,
</a><a href="#h50-1-60" id="h50-1-60" class="d">-                        default: Some(
</a><a href="#h50-1-61" id="h50-1-61" class="d">-                            Null,
</a><a href="#h50-1-62" id="h50-1-62" class="d">-                        ),
</a><a href="#h50-1-63" id="h50-1-63" class="d">-                        unique: false,
</a><a href="#h50-1-64" id="h50-1-64" class="d">-                        index: false,
</a><a href="#h50-1-65" id="h50-1-65" class="d">-                        references: None,
</a><a href="#h50-1-66" id="h50-1-66" class="d">-                    },
</a><a href="#h50-1-67" id="h50-1-67" class="d">-                    Column {
</a><a href="#h50-1-68" id="h50-1-68" class="d">-                        name: &quot;ultrahd&quot;,
</a><a href="#h50-1-69" id="h50-1-69" class="d">-                        datatype: Boolean,
</a><a href="#h50-1-70" id="h50-1-70" class="d">-                        nullable: true,
</a><a href="#h50-1-71" id="h50-1-71" class="d">-                        default: Some(
</a><a href="#h50-1-72" id="h50-1-72" class="d">-                            Null,
</a><a href="#h50-1-73" id="h50-1-73" class="d">-                        ),
</a><a href="#h50-1-74" id="h50-1-74" class="d">-                        unique: false,
</a><a href="#h50-1-75" id="h50-1-75" class="d">-                        index: false,
</a><a href="#h50-1-76" id="h50-1-76" class="d">-                        references: None,
</a><a href="#h50-1-77" id="h50-1-77" class="d">-                    },
</a><a href="#h50-1-78" id="h50-1-78" class="d">-                ],
</a><a href="#h50-1-79" id="h50-1-79" class="d">-            },
</a><a href="#h50-1-80" id="h50-1-80" class="d">-            alias: Some(
</a><a href="#h50-1-81" id="h50-1-81" class="d">-                &quot;m&quot;,
</a><a href="#h50-1-82" id="h50-1-82" class="d">-            ),
</a><a href="#h50-1-83" id="h50-1-83" class="i">+            table: &quot;movies&quot;,
</a>             column: &quot;genre_id&quot;,
             values: [
                 Integer(
                     4,
                 ),
             ],
<a href="#h50-1-90" id="h50-1-90" class="i">+            alias: Some(
</a><a href="#h50-1-91" id="h50-1-91" class="i">+                &quot;m&quot;,
</a><a href="#h50-1-92" id="h50-1-92" class="i">+            ),
</a>         },
<a href="#h50-1-94" id="h50-1-94" class="d">-        left_field: (
</a><a href="#h50-1-95" id="h50-1-95" class="d">-            3,
</a><a href="#h50-1-96" id="h50-1-96" class="d">-            Some(
</a><a href="#h50-1-97" id="h50-1-97" class="d">-                (
</a><a href="#h50-1-98" id="h50-1-98" class="d">-                    Some(
</a><a href="#h50-1-99" id="h50-1-99" class="d">-                        &quot;m&quot;,
</a><a href="#h50-1-100" id="h50-1-100" class="d">-                    ),
</a><a href="#h50-1-101" id="h50-1-101" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h50-1-102" id="h50-1-102" class="i">+        left_field: 3,
</a><a href="#h50-1-103" id="h50-1-103" class="i">+        left_label: Some(
</a><a href="#h50-1-104" id="h50-1-104" class="i">+            (
</a><a href="#h50-1-105" id="h50-1-105" class="i">+                Some(
</a><a href="#h50-1-106" id="h50-1-106" class="i">+                    &quot;m&quot;,
</a>                 ),
<a href="#h50-1-108" id="h50-1-108" class="i">+                &quot;genre_id&quot;,
</a>             ),
         ),
         right: KeyLookup {
<a href="#h50-1-112" id="h50-1-112" class="d">-            table: Table {
</a><a href="#h50-1-113" id="h50-1-113" class="d">-                name: &quot;genres&quot;,
</a><a href="#h50-1-114" id="h50-1-114" class="d">-                primary_key: 0,
</a><a href="#h50-1-115" id="h50-1-115" class="d">-                columns: [
</a><a href="#h50-1-116" id="h50-1-116" class="d">-                    Column {
</a><a href="#h50-1-117" id="h50-1-117" class="d">-                        name: &quot;id&quot;,
</a><a href="#h50-1-118" id="h50-1-118" class="d">-                        datatype: Integer,
</a><a href="#h50-1-119" id="h50-1-119" class="d">-                        nullable: false,
</a><a href="#h50-1-120" id="h50-1-120" class="d">-                        default: None,
</a><a href="#h50-1-121" id="h50-1-121" class="d">-                        unique: true,
</a><a href="#h50-1-122" id="h50-1-122" class="d">-                        index: false,
</a><a href="#h50-1-123" id="h50-1-123" class="d">-                        references: None,
</a><a href="#h50-1-124" id="h50-1-124" class="d">-                    },
</a><a href="#h50-1-125" id="h50-1-125" class="d">-                    Column {
</a><a href="#h50-1-126" id="h50-1-126" class="d">-                        name: &quot;name&quot;,
</a><a href="#h50-1-127" id="h50-1-127" class="d">-                        datatype: String,
</a><a href="#h50-1-128" id="h50-1-128" class="d">-                        nullable: false,
</a><a href="#h50-1-129" id="h50-1-129" class="d">-                        default: None,
</a><a href="#h50-1-130" id="h50-1-130" class="d">-                        unique: false,
</a><a href="#h50-1-131" id="h50-1-131" class="d">-                        index: false,
</a><a href="#h50-1-132" id="h50-1-132" class="d">-                        references: None,
</a><a href="#h50-1-133" id="h50-1-133" class="d">-                    },
</a><a href="#h50-1-134" id="h50-1-134" class="d">-                ],
</a><a href="#h50-1-135" id="h50-1-135" class="d">-            },
</a><a href="#h50-1-136" id="h50-1-136" class="d">-            alias: Some(
</a><a href="#h50-1-137" id="h50-1-137" class="d">-                &quot;g&quot;,
</a><a href="#h50-1-138" id="h50-1-138" class="d">-            ),
</a><a href="#h50-1-139" id="h50-1-139" class="i">+            table: &quot;genres&quot;,
</a>             keys: [
                 Integer(
                     4,
                 ),
             ],
<a href="#h50-1-145" id="h50-1-145" class="i">+            alias: Some(
</a><a href="#h50-1-146" id="h50-1-146" class="i">+                &quot;g&quot;,
</a><a href="#h50-1-147" id="h50-1-147" class="i">+            ),
</a>         },
<a href="#h50-1-149" id="h50-1-149" class="d">-        right_field: (
</a><a href="#h50-1-150" id="h50-1-150" class="d">-            0,
</a><a href="#h50-1-151" id="h50-1-151" class="d">-            Some(
</a><a href="#h50-1-152" id="h50-1-152" class="d">-                (
</a><a href="#h50-1-153" id="h50-1-153" class="d">-                    Some(
</a><a href="#h50-1-154" id="h50-1-154" class="d">-                        &quot;g&quot;,
</a><a href="#h50-1-155" id="h50-1-155" class="d">-                    ),
</a><a href="#h50-1-156" id="h50-1-156" class="d">-                    &quot;id&quot;,
</a><a href="#h50-1-157" id="h50-1-157" class="i">+        right_field: 0,
</a><a href="#h50-1-158" id="h50-1-158" class="i">+        right_label: Some(
</a><a href="#h50-1-159" id="h50-1-159" class="i">+            (
</a><a href="#h50-1-160" id="h50-1-160" class="i">+                Some(
</a><a href="#h50-1-161" id="h50-1-161" class="i">+                    &quot;g&quot;,
</a>                 ),
<a href="#h50-1-163" id="h50-1-163" class="i">+                &quot;id&quot;,
</a>             ),
         ),
<a href="#h50-1-166" id="h50-1-166" class="i">+        right_size: 2,
</a>         outer: false,
     },
     labels: [
<b>diff --git a/<a id="h51" href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -185,6 +185,7 @@ Plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h51-0-3" id="h51-0-3" class="i">+            right_size: 2,
</a>             predicate: Some(
                 Equal(
                     Field(
<a href="#h51-1" id="h51-1" class="h">@@ -311,149 +312,47 @@ Plan: Select {
</a> Optimized plan: Select {
     root: HashJoin {
         left: IndexLookup {
<a href="#h51-1-3" id="h51-1-3" class="d">-            table: Table {
</a><a href="#h51-1-4" id="h51-1-4" class="d">-                name: &quot;movies&quot;,
</a><a href="#h51-1-5" id="h51-1-5" class="d">-                primary_key: 0,
</a><a href="#h51-1-6" id="h51-1-6" class="d">-                columns: [
</a><a href="#h51-1-7" id="h51-1-7" class="d">-                    Column {
</a><a href="#h51-1-8" id="h51-1-8" class="d">-                        name: &quot;id&quot;,
</a><a href="#h51-1-9" id="h51-1-9" class="d">-                        datatype: Integer,
</a><a href="#h51-1-10" id="h51-1-10" class="d">-                        nullable: false,
</a><a href="#h51-1-11" id="h51-1-11" class="d">-                        default: None,
</a><a href="#h51-1-12" id="h51-1-12" class="d">-                        unique: true,
</a><a href="#h51-1-13" id="h51-1-13" class="d">-                        index: false,
</a><a href="#h51-1-14" id="h51-1-14" class="d">-                        references: None,
</a><a href="#h51-1-15" id="h51-1-15" class="d">-                    },
</a><a href="#h51-1-16" id="h51-1-16" class="d">-                    Column {
</a><a href="#h51-1-17" id="h51-1-17" class="d">-                        name: &quot;title&quot;,
</a><a href="#h51-1-18" id="h51-1-18" class="d">-                        datatype: String,
</a><a href="#h51-1-19" id="h51-1-19" class="d">-                        nullable: false,
</a><a href="#h51-1-20" id="h51-1-20" class="d">-                        default: None,
</a><a href="#h51-1-21" id="h51-1-21" class="d">-                        unique: false,
</a><a href="#h51-1-22" id="h51-1-22" class="d">-                        index: false,
</a><a href="#h51-1-23" id="h51-1-23" class="d">-                        references: None,
</a><a href="#h51-1-24" id="h51-1-24" class="d">-                    },
</a><a href="#h51-1-25" id="h51-1-25" class="d">-                    Column {
</a><a href="#h51-1-26" id="h51-1-26" class="d">-                        name: &quot;studio_id&quot;,
</a><a href="#h51-1-27" id="h51-1-27" class="d">-                        datatype: Integer,
</a><a href="#h51-1-28" id="h51-1-28" class="d">-                        nullable: false,
</a><a href="#h51-1-29" id="h51-1-29" class="d">-                        default: None,
</a><a href="#h51-1-30" id="h51-1-30" class="d">-                        unique: false,
</a><a href="#h51-1-31" id="h51-1-31" class="d">-                        index: true,
</a><a href="#h51-1-32" id="h51-1-32" class="d">-                        references: Some(
</a><a href="#h51-1-33" id="h51-1-33" class="d">-                            &quot;studios&quot;,
</a><a href="#h51-1-34" id="h51-1-34" class="d">-                        ),
</a><a href="#h51-1-35" id="h51-1-35" class="d">-                    },
</a><a href="#h51-1-36" id="h51-1-36" class="d">-                    Column {
</a><a href="#h51-1-37" id="h51-1-37" class="d">-                        name: &quot;genre_id&quot;,
</a><a href="#h51-1-38" id="h51-1-38" class="d">-                        datatype: Integer,
</a><a href="#h51-1-39" id="h51-1-39" class="d">-                        nullable: false,
</a><a href="#h51-1-40" id="h51-1-40" class="d">-                        default: None,
</a><a href="#h51-1-41" id="h51-1-41" class="d">-                        unique: false,
</a><a href="#h51-1-42" id="h51-1-42" class="d">-                        index: true,
</a><a href="#h51-1-43" id="h51-1-43" class="d">-                        references: Some(
</a><a href="#h51-1-44" id="h51-1-44" class="d">-                            &quot;genres&quot;,
</a><a href="#h51-1-45" id="h51-1-45" class="d">-                        ),
</a><a href="#h51-1-46" id="h51-1-46" class="d">-                    },
</a><a href="#h51-1-47" id="h51-1-47" class="d">-                    Column {
</a><a href="#h51-1-48" id="h51-1-48" class="d">-                        name: &quot;released&quot;,
</a><a href="#h51-1-49" id="h51-1-49" class="d">-                        datatype: Integer,
</a><a href="#h51-1-50" id="h51-1-50" class="d">-                        nullable: false,
</a><a href="#h51-1-51" id="h51-1-51" class="d">-                        default: None,
</a><a href="#h51-1-52" id="h51-1-52" class="d">-                        unique: false,
</a><a href="#h51-1-53" id="h51-1-53" class="d">-                        index: false,
</a><a href="#h51-1-54" id="h51-1-54" class="d">-                        references: None,
</a><a href="#h51-1-55" id="h51-1-55" class="d">-                    },
</a><a href="#h51-1-56" id="h51-1-56" class="d">-                    Column {
</a><a href="#h51-1-57" id="h51-1-57" class="d">-                        name: &quot;rating&quot;,
</a><a href="#h51-1-58" id="h51-1-58" class="d">-                        datatype: Float,
</a><a href="#h51-1-59" id="h51-1-59" class="d">-                        nullable: true,
</a><a href="#h51-1-60" id="h51-1-60" class="d">-                        default: Some(
</a><a href="#h51-1-61" id="h51-1-61" class="d">-                            Null,
</a><a href="#h51-1-62" id="h51-1-62" class="d">-                        ),
</a><a href="#h51-1-63" id="h51-1-63" class="d">-                        unique: false,
</a><a href="#h51-1-64" id="h51-1-64" class="d">-                        index: false,
</a><a href="#h51-1-65" id="h51-1-65" class="d">-                        references: None,
</a><a href="#h51-1-66" id="h51-1-66" class="d">-                    },
</a><a href="#h51-1-67" id="h51-1-67" class="d">-                    Column {
</a><a href="#h51-1-68" id="h51-1-68" class="d">-                        name: &quot;ultrahd&quot;,
</a><a href="#h51-1-69" id="h51-1-69" class="d">-                        datatype: Boolean,
</a><a href="#h51-1-70" id="h51-1-70" class="d">-                        nullable: true,
</a><a href="#h51-1-71" id="h51-1-71" class="d">-                        default: Some(
</a><a href="#h51-1-72" id="h51-1-72" class="d">-                            Null,
</a><a href="#h51-1-73" id="h51-1-73" class="d">-                        ),
</a><a href="#h51-1-74" id="h51-1-74" class="d">-                        unique: false,
</a><a href="#h51-1-75" id="h51-1-75" class="d">-                        index: false,
</a><a href="#h51-1-76" id="h51-1-76" class="d">-                        references: None,
</a><a href="#h51-1-77" id="h51-1-77" class="d">-                    },
</a><a href="#h51-1-78" id="h51-1-78" class="d">-                ],
</a><a href="#h51-1-79" id="h51-1-79" class="d">-            },
</a><a href="#h51-1-80" id="h51-1-80" class="d">-            alias: Some(
</a><a href="#h51-1-81" id="h51-1-81" class="d">-                &quot;m&quot;,
</a><a href="#h51-1-82" id="h51-1-82" class="d">-            ),
</a><a href="#h51-1-83" id="h51-1-83" class="i">+            table: &quot;movies&quot;,
</a>             column: &quot;genre_id&quot;,
             values: [
                 Integer(
                     4,
                 ),
             ],
<a href="#h51-1-90" id="h51-1-90" class="i">+            alias: Some(
</a><a href="#h51-1-91" id="h51-1-91" class="i">+                &quot;m&quot;,
</a><a href="#h51-1-92" id="h51-1-92" class="i">+            ),
</a>         },
<a href="#h51-1-94" id="h51-1-94" class="d">-        left_field: (
</a><a href="#h51-1-95" id="h51-1-95" class="d">-            3,
</a><a href="#h51-1-96" id="h51-1-96" class="d">-            Some(
</a><a href="#h51-1-97" id="h51-1-97" class="d">-                (
</a><a href="#h51-1-98" id="h51-1-98" class="d">-                    Some(
</a><a href="#h51-1-99" id="h51-1-99" class="d">-                        &quot;m&quot;,
</a><a href="#h51-1-100" id="h51-1-100" class="d">-                    ),
</a><a href="#h51-1-101" id="h51-1-101" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h51-1-102" id="h51-1-102" class="i">+        left_field: 3,
</a><a href="#h51-1-103" id="h51-1-103" class="i">+        left_label: Some(
</a><a href="#h51-1-104" id="h51-1-104" class="i">+            (
</a><a href="#h51-1-105" id="h51-1-105" class="i">+                Some(
</a><a href="#h51-1-106" id="h51-1-106" class="i">+                    &quot;m&quot;,
</a>                 ),
<a href="#h51-1-108" id="h51-1-108" class="i">+                &quot;genre_id&quot;,
</a>             ),
         ),
         right: KeyLookup {
<a href="#h51-1-112" id="h51-1-112" class="d">-            table: Table {
</a><a href="#h51-1-113" id="h51-1-113" class="d">-                name: &quot;genres&quot;,
</a><a href="#h51-1-114" id="h51-1-114" class="d">-                primary_key: 0,
</a><a href="#h51-1-115" id="h51-1-115" class="d">-                columns: [
</a><a href="#h51-1-116" id="h51-1-116" class="d">-                    Column {
</a><a href="#h51-1-117" id="h51-1-117" class="d">-                        name: &quot;id&quot;,
</a><a href="#h51-1-118" id="h51-1-118" class="d">-                        datatype: Integer,
</a><a href="#h51-1-119" id="h51-1-119" class="d">-                        nullable: false,
</a><a href="#h51-1-120" id="h51-1-120" class="d">-                        default: None,
</a><a href="#h51-1-121" id="h51-1-121" class="d">-                        unique: true,
</a><a href="#h51-1-122" id="h51-1-122" class="d">-                        index: false,
</a><a href="#h51-1-123" id="h51-1-123" class="d">-                        references: None,
</a><a href="#h51-1-124" id="h51-1-124" class="d">-                    },
</a><a href="#h51-1-125" id="h51-1-125" class="d">-                    Column {
</a><a href="#h51-1-126" id="h51-1-126" class="d">-                        name: &quot;name&quot;,
</a><a href="#h51-1-127" id="h51-1-127" class="d">-                        datatype: String,
</a><a href="#h51-1-128" id="h51-1-128" class="d">-                        nullable: false,
</a><a href="#h51-1-129" id="h51-1-129" class="d">-                        default: None,
</a><a href="#h51-1-130" id="h51-1-130" class="d">-                        unique: false,
</a><a href="#h51-1-131" id="h51-1-131" class="d">-                        index: false,
</a><a href="#h51-1-132" id="h51-1-132" class="d">-                        references: None,
</a><a href="#h51-1-133" id="h51-1-133" class="d">-                    },
</a><a href="#h51-1-134" id="h51-1-134" class="d">-                ],
</a><a href="#h51-1-135" id="h51-1-135" class="d">-            },
</a><a href="#h51-1-136" id="h51-1-136" class="d">-            alias: Some(
</a><a href="#h51-1-137" id="h51-1-137" class="d">-                &quot;g&quot;,
</a><a href="#h51-1-138" id="h51-1-138" class="d">-            ),
</a><a href="#h51-1-139" id="h51-1-139" class="i">+            table: &quot;genres&quot;,
</a>             keys: [
                 Integer(
                     4,
                 ),
             ],
<a href="#h51-1-145" id="h51-1-145" class="i">+            alias: Some(
</a><a href="#h51-1-146" id="h51-1-146" class="i">+                &quot;g&quot;,
</a><a href="#h51-1-147" id="h51-1-147" class="i">+            ),
</a>         },
<a href="#h51-1-149" id="h51-1-149" class="d">-        right_field: (
</a><a href="#h51-1-150" id="h51-1-150" class="d">-            0,
</a><a href="#h51-1-151" id="h51-1-151" class="d">-            Some(
</a><a href="#h51-1-152" id="h51-1-152" class="d">-                (
</a><a href="#h51-1-153" id="h51-1-153" class="d">-                    Some(
</a><a href="#h51-1-154" id="h51-1-154" class="d">-                        &quot;g&quot;,
</a><a href="#h51-1-155" id="h51-1-155" class="d">-                    ),
</a><a href="#h51-1-156" id="h51-1-156" class="d">-                    &quot;id&quot;,
</a><a href="#h51-1-157" id="h51-1-157" class="i">+        right_field: 0,
</a><a href="#h51-1-158" id="h51-1-158" class="i">+        right_label: Some(
</a><a href="#h51-1-159" id="h51-1-159" class="i">+            (
</a><a href="#h51-1-160" id="h51-1-160" class="i">+                Some(
</a><a href="#h51-1-161" id="h51-1-161" class="i">+                    &quot;g&quot;,
</a>                 ),
<a href="#h51-1-163" id="h51-1-163" class="i">+                &quot;id&quot;,
</a>             ),
         ),
<a href="#h51-1-166" id="h51-1-166" class="i">+        right_size: 2,
</a>         outer: false,
     },
     labels: [
<b>diff --git a/<a id="h52" href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a> b/<a href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -236,6 +236,7 @@ Plan: Select {
</a>                     filter: None,
                     alias: None,
                 },
<a href="#h52-0-3" id="h52-0-3" class="i">+                right_size: 2,
</a>                 predicate: Some(
                     Equal(
                         Field(
<a href="#h52-1" id="h52-1" class="h">@@ -306,6 +307,7 @@ Plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h52-1-3" id="h52-1-3" class="i">+            right_size: 3,
</a>             predicate: Some(
                 Equal(
                     Field(
<a href="#h52-2" id="h52-2" class="h">@@ -494,15 +496,13 @@ Optimized plan: Select {
</a>                     filter: None,
                     alias: None,
                 },
<a href="#h52-2-3" id="h52-2-3" class="d">-                left_field: (
</a><a href="#h52-2-4" id="h52-2-4" class="d">-                    3,
</a><a href="#h52-2-5" id="h52-2-5" class="d">-                    Some(
</a><a href="#h52-2-6" id="h52-2-6" class="d">-                        (
</a><a href="#h52-2-7" id="h52-2-7" class="d">-                            Some(
</a><a href="#h52-2-8" id="h52-2-8" class="d">-                                &quot;movies&quot;,
</a><a href="#h52-2-9" id="h52-2-9" class="d">-                            ),
</a><a href="#h52-2-10" id="h52-2-10" class="d">-                            &quot;genre_id&quot;,
</a><a href="#h52-2-11" id="h52-2-11" class="i">+                left_field: 3,
</a><a href="#h52-2-12" id="h52-2-12" class="i">+                left_label: Some(
</a><a href="#h52-2-13" id="h52-2-13" class="i">+                    (
</a><a href="#h52-2-14" id="h52-2-14" class="i">+                        Some(
</a><a href="#h52-2-15" id="h52-2-15" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h52-2-17" id="h52-2-17" class="i">+                        &quot;genre_id&quot;,
</a>                     ),
                 ),
                 right: Scan {
<a href="#h52-3" id="h52-3" class="h">@@ -533,28 +533,25 @@ Optimized plan: Select {
</a>                     filter: None,
                     alias: None,
                 },
<a href="#h52-3-3" id="h52-3-3" class="d">-                right_field: (
</a><a href="#h52-3-4" id="h52-3-4" class="d">-                    0,
</a><a href="#h52-3-5" id="h52-3-5" class="d">-                    Some(
</a><a href="#h52-3-6" id="h52-3-6" class="d">-                        (
</a><a href="#h52-3-7" id="h52-3-7" class="d">-                            Some(
</a><a href="#h52-3-8" id="h52-3-8" class="d">-                                &quot;genres&quot;,
</a><a href="#h52-3-9" id="h52-3-9" class="d">-                            ),
</a><a href="#h52-3-10" id="h52-3-10" class="d">-                            &quot;id&quot;,
</a><a href="#h52-3-11" id="h52-3-11" class="i">+                right_field: 0,
</a><a href="#h52-3-12" id="h52-3-12" class="i">+                right_label: Some(
</a><a href="#h52-3-13" id="h52-3-13" class="i">+                    (
</a><a href="#h52-3-14" id="h52-3-14" class="i">+                        Some(
</a><a href="#h52-3-15" id="h52-3-15" class="i">+                            &quot;genres&quot;,
</a>                         ),
<a href="#h52-3-17" id="h52-3-17" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h52-3-20" id="h52-3-20" class="i">+                right_size: 2,
</a>                 outer: false,
             },
<a href="#h52-3-23" id="h52-3-23" class="d">-            left_field: (
</a><a href="#h52-3-24" id="h52-3-24" class="d">-                2,
</a><a href="#h52-3-25" id="h52-3-25" class="d">-                Some(
</a><a href="#h52-3-26" id="h52-3-26" class="d">-                    (
</a><a href="#h52-3-27" id="h52-3-27" class="d">-                        Some(
</a><a href="#h52-3-28" id="h52-3-28" class="d">-                            &quot;movies&quot;,
</a><a href="#h52-3-29" id="h52-3-29" class="d">-                        ),
</a><a href="#h52-3-30" id="h52-3-30" class="d">-                        &quot;studio_id&quot;,
</a><a href="#h52-3-31" id="h52-3-31" class="i">+            left_field: 2,
</a><a href="#h52-3-32" id="h52-3-32" class="i">+            left_label: Some(
</a><a href="#h52-3-33" id="h52-3-33" class="i">+                (
</a><a href="#h52-3-34" id="h52-3-34" class="i">+                    Some(
</a><a href="#h52-3-35" id="h52-3-35" class="i">+                        &quot;movies&quot;,
</a>                     ),
<a href="#h52-3-37" id="h52-3-37" class="i">+                    &quot;studio_id&quot;,
</a>                 ),
             ),
             right: Scan {
<a href="#h52-4" id="h52-4" class="h">@@ -598,17 +595,16 @@ Optimized plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h52-4-3" id="h52-4-3" class="d">-            right_field: (
</a><a href="#h52-4-4" id="h52-4-4" class="d">-                0,
</a><a href="#h52-4-5" id="h52-4-5" class="d">-                Some(
</a><a href="#h52-4-6" id="h52-4-6" class="d">-                    (
</a><a href="#h52-4-7" id="h52-4-7" class="d">-                        Some(
</a><a href="#h52-4-8" id="h52-4-8" class="d">-                            &quot;studios&quot;,
</a><a href="#h52-4-9" id="h52-4-9" class="d">-                        ),
</a><a href="#h52-4-10" id="h52-4-10" class="d">-                        &quot;id&quot;,
</a><a href="#h52-4-11" id="h52-4-11" class="i">+            right_field: 0,
</a><a href="#h52-4-12" id="h52-4-12" class="i">+            right_label: Some(
</a><a href="#h52-4-13" id="h52-4-13" class="i">+                (
</a><a href="#h52-4-14" id="h52-4-14" class="i">+                    Some(
</a><a href="#h52-4-15" id="h52-4-15" class="i">+                        &quot;studios&quot;,
</a>                     ),
<a href="#h52-4-17" id="h52-4-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
<a href="#h52-4-20" id="h52-4-20" class="i">+            right_size: 3,
</a>             outer: false,
         },
         expressions: [
<b>diff --git a/<a id="h53" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -291,6 +291,7 @@ Plan: Select {
</a>                             &quot;g&quot;,
                         ),
                     },
<a href="#h53-0-3" id="h53-0-3" class="i">+                    right_size: 2,
</a>                     predicate: Some(
                         And(
                             Equal(
<a href="#h53-1" id="h53-1" class="h">@@ -383,6 +384,7 @@ Plan: Select {
</a>                         &quot;s&quot;,
                     ),
                 },
<a href="#h53-1-3" id="h53-1-3" class="i">+                right_size: 3,
</a>                 predicate: Some(
                     And(
                         Equal(
<a href="#h53-2" id="h53-2" class="h">@@ -530,92 +532,16 @@ Optimized plan: Select {
</a>                 left: HashJoin {
                     left: Filter {
                         source: IndexLookup {
<a href="#h53-2-3" id="h53-2-3" class="d">-                            table: Table {
</a><a href="#h53-2-4" id="h53-2-4" class="d">-                                name: &quot;movies&quot;,
</a><a href="#h53-2-5" id="h53-2-5" class="d">-                                primary_key: 0,
</a><a href="#h53-2-6" id="h53-2-6" class="d">-                                columns: [
</a><a href="#h53-2-7" id="h53-2-7" class="d">-                                    Column {
</a><a href="#h53-2-8" id="h53-2-8" class="d">-                                        name: &quot;id&quot;,
</a><a href="#h53-2-9" id="h53-2-9" class="d">-                                        datatype: Integer,
</a><a href="#h53-2-10" id="h53-2-10" class="d">-                                        nullable: false,
</a><a href="#h53-2-11" id="h53-2-11" class="d">-                                        default: None,
</a><a href="#h53-2-12" id="h53-2-12" class="d">-                                        unique: true,
</a><a href="#h53-2-13" id="h53-2-13" class="d">-                                        index: false,
</a><a href="#h53-2-14" id="h53-2-14" class="d">-                                        references: None,
</a><a href="#h53-2-15" id="h53-2-15" class="d">-                                    },
</a><a href="#h53-2-16" id="h53-2-16" class="d">-                                    Column {
</a><a href="#h53-2-17" id="h53-2-17" class="d">-                                        name: &quot;title&quot;,
</a><a href="#h53-2-18" id="h53-2-18" class="d">-                                        datatype: String,
</a><a href="#h53-2-19" id="h53-2-19" class="d">-                                        nullable: false,
</a><a href="#h53-2-20" id="h53-2-20" class="d">-                                        default: None,
</a><a href="#h53-2-21" id="h53-2-21" class="d">-                                        unique: false,
</a><a href="#h53-2-22" id="h53-2-22" class="d">-                                        index: false,
</a><a href="#h53-2-23" id="h53-2-23" class="d">-                                        references: None,
</a><a href="#h53-2-24" id="h53-2-24" class="d">-                                    },
</a><a href="#h53-2-25" id="h53-2-25" class="d">-                                    Column {
</a><a href="#h53-2-26" id="h53-2-26" class="d">-                                        name: &quot;studio_id&quot;,
</a><a href="#h53-2-27" id="h53-2-27" class="d">-                                        datatype: Integer,
</a><a href="#h53-2-28" id="h53-2-28" class="d">-                                        nullable: false,
</a><a href="#h53-2-29" id="h53-2-29" class="d">-                                        default: None,
</a><a href="#h53-2-30" id="h53-2-30" class="d">-                                        unique: false,
</a><a href="#h53-2-31" id="h53-2-31" class="d">-                                        index: true,
</a><a href="#h53-2-32" id="h53-2-32" class="d">-                                        references: Some(
</a><a href="#h53-2-33" id="h53-2-33" class="d">-                                            &quot;studios&quot;,
</a><a href="#h53-2-34" id="h53-2-34" class="d">-                                        ),
</a><a href="#h53-2-35" id="h53-2-35" class="d">-                                    },
</a><a href="#h53-2-36" id="h53-2-36" class="d">-                                    Column {
</a><a href="#h53-2-37" id="h53-2-37" class="d">-                                        name: &quot;genre_id&quot;,
</a><a href="#h53-2-38" id="h53-2-38" class="d">-                                        datatype: Integer,
</a><a href="#h53-2-39" id="h53-2-39" class="d">-                                        nullable: false,
</a><a href="#h53-2-40" id="h53-2-40" class="d">-                                        default: None,
</a><a href="#h53-2-41" id="h53-2-41" class="d">-                                        unique: false,
</a><a href="#h53-2-42" id="h53-2-42" class="d">-                                        index: true,
</a><a href="#h53-2-43" id="h53-2-43" class="d">-                                        references: Some(
</a><a href="#h53-2-44" id="h53-2-44" class="d">-                                            &quot;genres&quot;,
</a><a href="#h53-2-45" id="h53-2-45" class="d">-                                        ),
</a><a href="#h53-2-46" id="h53-2-46" class="d">-                                    },
</a><a href="#h53-2-47" id="h53-2-47" class="d">-                                    Column {
</a><a href="#h53-2-48" id="h53-2-48" class="d">-                                        name: &quot;released&quot;,
</a><a href="#h53-2-49" id="h53-2-49" class="d">-                                        datatype: Integer,
</a><a href="#h53-2-50" id="h53-2-50" class="d">-                                        nullable: false,
</a><a href="#h53-2-51" id="h53-2-51" class="d">-                                        default: None,
</a><a href="#h53-2-52" id="h53-2-52" class="d">-                                        unique: false,
</a><a href="#h53-2-53" id="h53-2-53" class="d">-                                        index: false,
</a><a href="#h53-2-54" id="h53-2-54" class="d">-                                        references: None,
</a><a href="#h53-2-55" id="h53-2-55" class="d">-                                    },
</a><a href="#h53-2-56" id="h53-2-56" class="d">-                                    Column {
</a><a href="#h53-2-57" id="h53-2-57" class="d">-                                        name: &quot;rating&quot;,
</a><a href="#h53-2-58" id="h53-2-58" class="d">-                                        datatype: Float,
</a><a href="#h53-2-59" id="h53-2-59" class="d">-                                        nullable: true,
</a><a href="#h53-2-60" id="h53-2-60" class="d">-                                        default: Some(
</a><a href="#h53-2-61" id="h53-2-61" class="d">-                                            Null,
</a><a href="#h53-2-62" id="h53-2-62" class="d">-                                        ),
</a><a href="#h53-2-63" id="h53-2-63" class="d">-                                        unique: false,
</a><a href="#h53-2-64" id="h53-2-64" class="d">-                                        index: false,
</a><a href="#h53-2-65" id="h53-2-65" class="d">-                                        references: None,
</a><a href="#h53-2-66" id="h53-2-66" class="d">-                                    },
</a><a href="#h53-2-67" id="h53-2-67" class="d">-                                    Column {
</a><a href="#h53-2-68" id="h53-2-68" class="d">-                                        name: &quot;ultrahd&quot;,
</a><a href="#h53-2-69" id="h53-2-69" class="d">-                                        datatype: Boolean,
</a><a href="#h53-2-70" id="h53-2-70" class="d">-                                        nullable: true,
</a><a href="#h53-2-71" id="h53-2-71" class="d">-                                        default: Some(
</a><a href="#h53-2-72" id="h53-2-72" class="d">-                                            Null,
</a><a href="#h53-2-73" id="h53-2-73" class="d">-                                        ),
</a><a href="#h53-2-74" id="h53-2-74" class="d">-                                        unique: false,
</a><a href="#h53-2-75" id="h53-2-75" class="d">-                                        index: false,
</a><a href="#h53-2-76" id="h53-2-76" class="d">-                                        references: None,
</a><a href="#h53-2-77" id="h53-2-77" class="d">-                                    },
</a><a href="#h53-2-78" id="h53-2-78" class="d">-                                ],
</a><a href="#h53-2-79" id="h53-2-79" class="d">-                            },
</a><a href="#h53-2-80" id="h53-2-80" class="d">-                            alias: Some(
</a><a href="#h53-2-81" id="h53-2-81" class="d">-                                &quot;m&quot;,
</a><a href="#h53-2-82" id="h53-2-82" class="d">-                            ),
</a><a href="#h53-2-83" id="h53-2-83" class="i">+                            table: &quot;movies&quot;,
</a>                             column: &quot;studio_id&quot;,
                             values: [
                                 Integer(
                                     4,
                                 ),
                             ],
<a href="#h53-2-90" id="h53-2-90" class="i">+                            alias: Some(
</a><a href="#h53-2-91" id="h53-2-91" class="i">+                                &quot;m&quot;,
</a><a href="#h53-2-92" id="h53-2-92" class="i">+                            ),
</a>                         },
                         predicate: Equal(
                             Field(
<a href="#h53-3" id="h53-3" class="h">@@ -636,133 +562,68 @@ Optimized plan: Select {
</a>                             ),
                         ),
                     },
<a href="#h53-3-3" id="h53-3-3" class="d">-                    left_field: (
</a><a href="#h53-3-4" id="h53-3-4" class="d">-                        3,
</a><a href="#h53-3-5" id="h53-3-5" class="d">-                        Some(
</a><a href="#h53-3-6" id="h53-3-6" class="d">-                            (
</a><a href="#h53-3-7" id="h53-3-7" class="d">-                                Some(
</a><a href="#h53-3-8" id="h53-3-8" class="d">-                                    &quot;m&quot;,
</a><a href="#h53-3-9" id="h53-3-9" class="d">-                                ),
</a><a href="#h53-3-10" id="h53-3-10" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h53-3-11" id="h53-3-11" class="i">+                    left_field: 3,
</a><a href="#h53-3-12" id="h53-3-12" class="i">+                    left_label: Some(
</a><a href="#h53-3-13" id="h53-3-13" class="i">+                        (
</a><a href="#h53-3-14" id="h53-3-14" class="i">+                            Some(
</a><a href="#h53-3-15" id="h53-3-15" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h53-3-17" id="h53-3-17" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
                     right: KeyLookup {
<a href="#h53-3-21" id="h53-3-21" class="d">-                        table: Table {
</a><a href="#h53-3-22" id="h53-3-22" class="d">-                            name: &quot;genres&quot;,
</a><a href="#h53-3-23" id="h53-3-23" class="d">-                            primary_key: 0,
</a><a href="#h53-3-24" id="h53-3-24" class="d">-                            columns: [
</a><a href="#h53-3-25" id="h53-3-25" class="d">-                                Column {
</a><a href="#h53-3-26" id="h53-3-26" class="d">-                                    name: &quot;id&quot;,
</a><a href="#h53-3-27" id="h53-3-27" class="d">-                                    datatype: Integer,
</a><a href="#h53-3-28" id="h53-3-28" class="d">-                                    nullable: false,
</a><a href="#h53-3-29" id="h53-3-29" class="d">-                                    default: None,
</a><a href="#h53-3-30" id="h53-3-30" class="d">-                                    unique: true,
</a><a href="#h53-3-31" id="h53-3-31" class="d">-                                    index: false,
</a><a href="#h53-3-32" id="h53-3-32" class="d">-                                    references: None,
</a><a href="#h53-3-33" id="h53-3-33" class="d">-                                },
</a><a href="#h53-3-34" id="h53-3-34" class="d">-                                Column {
</a><a href="#h53-3-35" id="h53-3-35" class="d">-                                    name: &quot;name&quot;,
</a><a href="#h53-3-36" id="h53-3-36" class="d">-                                    datatype: String,
</a><a href="#h53-3-37" id="h53-3-37" class="d">-                                    nullable: false,
</a><a href="#h53-3-38" id="h53-3-38" class="d">-                                    default: None,
</a><a href="#h53-3-39" id="h53-3-39" class="d">-                                    unique: false,
</a><a href="#h53-3-40" id="h53-3-40" class="d">-                                    index: false,
</a><a href="#h53-3-41" id="h53-3-41" class="d">-                                    references: None,
</a><a href="#h53-3-42" id="h53-3-42" class="d">-                                },
</a><a href="#h53-3-43" id="h53-3-43" class="d">-                            ],
</a><a href="#h53-3-44" id="h53-3-44" class="d">-                        },
</a><a href="#h53-3-45" id="h53-3-45" class="d">-                        alias: Some(
</a><a href="#h53-3-46" id="h53-3-46" class="d">-                            &quot;g&quot;,
</a><a href="#h53-3-47" id="h53-3-47" class="d">-                        ),
</a><a href="#h53-3-48" id="h53-3-48" class="i">+                        table: &quot;genres&quot;,
</a>                         keys: [
                             Integer(
                                 1,
                             ),
                         ],
<a href="#h53-3-54" id="h53-3-54" class="i">+                        alias: Some(
</a><a href="#h53-3-55" id="h53-3-55" class="i">+                            &quot;g&quot;,
</a><a href="#h53-3-56" id="h53-3-56" class="i">+                        ),
</a>                     },
<a href="#h53-3-58" id="h53-3-58" class="d">-                    right_field: (
</a><a href="#h53-3-59" id="h53-3-59" class="d">-                        0,
</a><a href="#h53-3-60" id="h53-3-60" class="d">-                        Some(
</a><a href="#h53-3-61" id="h53-3-61" class="d">-                            (
</a><a href="#h53-3-62" id="h53-3-62" class="d">-                                Some(
</a><a href="#h53-3-63" id="h53-3-63" class="d">-                                    &quot;g&quot;,
</a><a href="#h53-3-64" id="h53-3-64" class="d">-                                ),
</a><a href="#h53-3-65" id="h53-3-65" class="d">-                                &quot;id&quot;,
</a><a href="#h53-3-66" id="h53-3-66" class="i">+                    right_field: 0,
</a><a href="#h53-3-67" id="h53-3-67" class="i">+                    right_label: Some(
</a><a href="#h53-3-68" id="h53-3-68" class="i">+                        (
</a><a href="#h53-3-69" id="h53-3-69" class="i">+                            Some(
</a><a href="#h53-3-70" id="h53-3-70" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h53-3-72" id="h53-3-72" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h53-3-75" id="h53-3-75" class="i">+                    right_size: 2,
</a>                     outer: false,
                 },
<a href="#h53-3-78" id="h53-3-78" class="d">-                left_field: (
</a><a href="#h53-3-79" id="h53-3-79" class="d">-                    2,
</a><a href="#h53-3-80" id="h53-3-80" class="d">-                    Some(
</a><a href="#h53-3-81" id="h53-3-81" class="d">-                        (
</a><a href="#h53-3-82" id="h53-3-82" class="d">-                            Some(
</a><a href="#h53-3-83" id="h53-3-83" class="d">-                                &quot;m&quot;,
</a><a href="#h53-3-84" id="h53-3-84" class="d">-                            ),
</a><a href="#h53-3-85" id="h53-3-85" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h53-3-86" id="h53-3-86" class="i">+                left_field: 2,
</a><a href="#h53-3-87" id="h53-3-87" class="i">+                left_label: Some(
</a><a href="#h53-3-88" id="h53-3-88" class="i">+                    (
</a><a href="#h53-3-89" id="h53-3-89" class="i">+                        Some(
</a><a href="#h53-3-90" id="h53-3-90" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h53-3-92" id="h53-3-92" class="i">+                        &quot;studio_id&quot;,
</a>                     ),
                 ),
                 right: KeyLookup {
<a href="#h53-3-96" id="h53-3-96" class="d">-                    table: Table {
</a><a href="#h53-3-97" id="h53-3-97" class="d">-                        name: &quot;studios&quot;,
</a><a href="#h53-3-98" id="h53-3-98" class="d">-                        primary_key: 0,
</a><a href="#h53-3-99" id="h53-3-99" class="d">-                        columns: [
</a><a href="#h53-3-100" id="h53-3-100" class="d">-                            Column {
</a><a href="#h53-3-101" id="h53-3-101" class="d">-                                name: &quot;id&quot;,
</a><a href="#h53-3-102" id="h53-3-102" class="d">-                                datatype: Integer,
</a><a href="#h53-3-103" id="h53-3-103" class="d">-                                nullable: false,
</a><a href="#h53-3-104" id="h53-3-104" class="d">-                                default: None,
</a><a href="#h53-3-105" id="h53-3-105" class="d">-                                unique: true,
</a><a href="#h53-3-106" id="h53-3-106" class="d">-                                index: false,
</a><a href="#h53-3-107" id="h53-3-107" class="d">-                                references: None,
</a><a href="#h53-3-108" id="h53-3-108" class="d">-                            },
</a><a href="#h53-3-109" id="h53-3-109" class="d">-                            Column {
</a><a href="#h53-3-110" id="h53-3-110" class="d">-                                name: &quot;name&quot;,
</a><a href="#h53-3-111" id="h53-3-111" class="d">-                                datatype: String,
</a><a href="#h53-3-112" id="h53-3-112" class="d">-                                nullable: false,
</a><a href="#h53-3-113" id="h53-3-113" class="d">-                                default: None,
</a><a href="#h53-3-114" id="h53-3-114" class="d">-                                unique: false,
</a><a href="#h53-3-115" id="h53-3-115" class="d">-                                index: false,
</a><a href="#h53-3-116" id="h53-3-116" class="d">-                                references: None,
</a><a href="#h53-3-117" id="h53-3-117" class="d">-                            },
</a><a href="#h53-3-118" id="h53-3-118" class="d">-                            Column {
</a><a href="#h53-3-119" id="h53-3-119" class="d">-                                name: &quot;country_id&quot;,
</a><a href="#h53-3-120" id="h53-3-120" class="d">-                                datatype: String,
</a><a href="#h53-3-121" id="h53-3-121" class="d">-                                nullable: true,
</a><a href="#h53-3-122" id="h53-3-122" class="d">-                                default: Some(
</a><a href="#h53-3-123" id="h53-3-123" class="d">-                                    Null,
</a><a href="#h53-3-124" id="h53-3-124" class="d">-                                ),
</a><a href="#h53-3-125" id="h53-3-125" class="d">-                                unique: false,
</a><a href="#h53-3-126" id="h53-3-126" class="d">-                                index: true,
</a><a href="#h53-3-127" id="h53-3-127" class="d">-                                references: Some(
</a><a href="#h53-3-128" id="h53-3-128" class="d">-                                    &quot;countries&quot;,
</a><a href="#h53-3-129" id="h53-3-129" class="d">-                                ),
</a><a href="#h53-3-130" id="h53-3-130" class="d">-                            },
</a><a href="#h53-3-131" id="h53-3-131" class="d">-                        ],
</a><a href="#h53-3-132" id="h53-3-132" class="d">-                    },
</a><a href="#h53-3-133" id="h53-3-133" class="d">-                    alias: Some(
</a><a href="#h53-3-134" id="h53-3-134" class="d">-                        &quot;s&quot;,
</a><a href="#h53-3-135" id="h53-3-135" class="d">-                    ),
</a><a href="#h53-3-136" id="h53-3-136" class="i">+                    table: &quot;studios&quot;,
</a>                     keys: [
                         Integer(
                             4,
                         ),
                     ],
<a href="#h53-3-142" id="h53-3-142" class="i">+                    alias: Some(
</a><a href="#h53-3-143" id="h53-3-143" class="i">+                        &quot;s&quot;,
</a><a href="#h53-3-144" id="h53-3-144" class="i">+                    ),
</a>                 },
<a href="#h53-3-146" id="h53-3-146" class="d">-                right_field: (
</a><a href="#h53-3-147" id="h53-3-147" class="d">-                    0,
</a><a href="#h53-3-148" id="h53-3-148" class="d">-                    Some(
</a><a href="#h53-3-149" id="h53-3-149" class="d">-                        (
</a><a href="#h53-3-150" id="h53-3-150" class="d">-                            Some(
</a><a href="#h53-3-151" id="h53-3-151" class="d">-                                &quot;s&quot;,
</a><a href="#h53-3-152" id="h53-3-152" class="d">-                            ),
</a><a href="#h53-3-153" id="h53-3-153" class="d">-                            &quot;id&quot;,
</a><a href="#h53-3-154" id="h53-3-154" class="i">+                right_field: 0,
</a><a href="#h53-3-155" id="h53-3-155" class="i">+                right_label: Some(
</a><a href="#h53-3-156" id="h53-3-156" class="i">+                    (
</a><a href="#h53-3-157" id="h53-3-157" class="i">+                        Some(
</a><a href="#h53-3-158" id="h53-3-158" class="i">+                            &quot;s&quot;,
</a>                         ),
<a href="#h53-3-160" id="h53-3-160" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h53-3-163" id="h53-3-163" class="i">+                right_size: 3,
</a>                 outer: false,
             },
             expressions: [
<b>diff --git a/<a id="h54" href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a> b/<a href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -347,6 +347,7 @@ Plan: Select {
</a>                                     &quot;g&quot;,
                                 ),
                             },
<a href="#h54-0-3" id="h54-0-3" class="i">+                            right_size: 2,
</a>                             predicate: Some(
                                 Equal(
                                     Field(
<a href="#h54-1" id="h54-1" class="h">@@ -504,6 +505,7 @@ Plan: Select {
</a>                                     &quot;good&quot;,
                                 ),
                             },
<a href="#h54-1-3" id="h54-1-3" class="i">+                            right_size: 7,
</a>                             predicate: Some(
                                 And(
                                     Equal(
<a href="#h54-2" id="h54-2" class="h">@@ -572,6 +574,7 @@ Plan: Select {
</a>                             ),
                             outer: false,
                         },
<a href="#h54-2-3" id="h54-2-3" class="i">+                        right_size: 10,
</a>                         predicate: None,
                         outer: false,
                     },
<a href="#h54-3" id="h54-3" class="h">@@ -891,15 +894,13 @@ Optimized plan: Select {
</a>                                 &quot;m&quot;,
                             ),
                         },
<a href="#h54-3-3" id="h54-3-3" class="d">-                        left_field: (
</a><a href="#h54-3-4" id="h54-3-4" class="d">-                            3,
</a><a href="#h54-3-5" id="h54-3-5" class="d">-                            Some(
</a><a href="#h54-3-6" id="h54-3-6" class="d">-                                (
</a><a href="#h54-3-7" id="h54-3-7" class="d">-                                    Some(
</a><a href="#h54-3-8" id="h54-3-8" class="d">-                                        &quot;m&quot;,
</a><a href="#h54-3-9" id="h54-3-9" class="d">-                                    ),
</a><a href="#h54-3-10" id="h54-3-10" class="d">-                                    &quot;genre_id&quot;,
</a><a href="#h54-3-11" id="h54-3-11" class="i">+                        left_field: 3,
</a><a href="#h54-3-12" id="h54-3-12" class="i">+                        left_label: Some(
</a><a href="#h54-3-13" id="h54-3-13" class="i">+                            (
</a><a href="#h54-3-14" id="h54-3-14" class="i">+                                Some(
</a><a href="#h54-3-15" id="h54-3-15" class="i">+                                    &quot;m&quot;,
</a>                                 ),
<a href="#h54-3-17" id="h54-3-17" class="i">+                                &quot;genre_id&quot;,
</a>                             ),
                         ),
                         right: Scan {
<a href="#h54-4" id="h54-4" class="h">@@ -932,28 +933,25 @@ Optimized plan: Select {
</a>                                 &quot;g&quot;,
                             ),
                         },
<a href="#h54-4-3" id="h54-4-3" class="d">-                        right_field: (
</a><a href="#h54-4-4" id="h54-4-4" class="d">-                            0,
</a><a href="#h54-4-5" id="h54-4-5" class="d">-                            Some(
</a><a href="#h54-4-6" id="h54-4-6" class="d">-                                (
</a><a href="#h54-4-7" id="h54-4-7" class="d">-                                    Some(
</a><a href="#h54-4-8" id="h54-4-8" class="d">-                                        &quot;g&quot;,
</a><a href="#h54-4-9" id="h54-4-9" class="d">-                                    ),
</a><a href="#h54-4-10" id="h54-4-10" class="d">-                                    &quot;id&quot;,
</a><a href="#h54-4-11" id="h54-4-11" class="i">+                        right_field: 0,
</a><a href="#h54-4-12" id="h54-4-12" class="i">+                        right_label: Some(
</a><a href="#h54-4-13" id="h54-4-13" class="i">+                            (
</a><a href="#h54-4-14" id="h54-4-14" class="i">+                                Some(
</a><a href="#h54-4-15" id="h54-4-15" class="i">+                                    &quot;g&quot;,
</a>                                 ),
<a href="#h54-4-17" id="h54-4-17" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h54-4-20" id="h54-4-20" class="i">+                        right_size: 2,
</a>                         outer: false,
                     },
<a href="#h54-4-23" id="h54-4-23" class="d">-                    left_field: (
</a><a href="#h54-4-24" id="h54-4-24" class="d">-                        2,
</a><a href="#h54-4-25" id="h54-4-25" class="d">-                        Some(
</a><a href="#h54-4-26" id="h54-4-26" class="d">-                            (
</a><a href="#h54-4-27" id="h54-4-27" class="d">-                                Some(
</a><a href="#h54-4-28" id="h54-4-28" class="d">-                                    &quot;m&quot;,
</a><a href="#h54-4-29" id="h54-4-29" class="d">-                                ),
</a><a href="#h54-4-30" id="h54-4-30" class="d">-                                &quot;studio_id&quot;,
</a><a href="#h54-4-31" id="h54-4-31" class="i">+                    left_field: 2,
</a><a href="#h54-4-32" id="h54-4-32" class="i">+                    left_label: Some(
</a><a href="#h54-4-33" id="h54-4-33" class="i">+                        (
</a><a href="#h54-4-34" id="h54-4-34" class="i">+                            Some(
</a><a href="#h54-4-35" id="h54-4-35" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h54-4-37" id="h54-4-37" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
                     right: HashJoin {
<a href="#h54-5" id="h54-5" class="h">@@ -1000,15 +998,13 @@ Optimized plan: Select {
</a>                                 &quot;s&quot;,
                             ),
                         },
<a href="#h54-5-3" id="h54-5-3" class="d">-                        left_field: (
</a><a href="#h54-5-4" id="h54-5-4" class="d">-                            0,
</a><a href="#h54-5-5" id="h54-5-5" class="d">-                            Some(
</a><a href="#h54-5-6" id="h54-5-6" class="d">-                                (
</a><a href="#h54-5-7" id="h54-5-7" class="d">-                                    Some(
</a><a href="#h54-5-8" id="h54-5-8" class="d">-                                        &quot;s&quot;,
</a><a href="#h54-5-9" id="h54-5-9" class="d">-                                    ),
</a><a href="#h54-5-10" id="h54-5-10" class="d">-                                    &quot;id&quot;,
</a><a href="#h54-5-11" id="h54-5-11" class="i">+                        left_field: 0,
</a><a href="#h54-5-12" id="h54-5-12" class="i">+                        left_label: Some(
</a><a href="#h54-5-13" id="h54-5-13" class="i">+                            (
</a><a href="#h54-5-14" id="h54-5-14" class="i">+                                Some(
</a><a href="#h54-5-15" id="h54-5-15" class="i">+                                    &quot;s&quot;,
</a>                                 ),
<a href="#h54-5-17" id="h54-5-17" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
                         right: Scan {
<a href="#h54-6" id="h54-6" class="h">@@ -1133,30 +1129,28 @@ Optimized plan: Select {
</a>                                 &quot;good&quot;,
                             ),
                         },
<a href="#h54-6-3" id="h54-6-3" class="d">-                        right_field: (
</a><a href="#h54-6-4" id="h54-6-4" class="d">-                            2,
</a><a href="#h54-6-5" id="h54-6-5" class="d">-                            Some(
</a><a href="#h54-6-6" id="h54-6-6" class="d">-                                (
</a><a href="#h54-6-7" id="h54-6-7" class="d">-                                    Some(
</a><a href="#h54-6-8" id="h54-6-8" class="d">-                                        &quot;good&quot;,
</a><a href="#h54-6-9" id="h54-6-9" class="d">-                                    ),
</a><a href="#h54-6-10" id="h54-6-10" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h54-6-11" id="h54-6-11" class="i">+                        right_field: 2,
</a><a href="#h54-6-12" id="h54-6-12" class="i">+                        right_label: Some(
</a><a href="#h54-6-13" id="h54-6-13" class="i">+                            (
</a><a href="#h54-6-14" id="h54-6-14" class="i">+                                Some(
</a><a href="#h54-6-15" id="h54-6-15" class="i">+                                    &quot;good&quot;,
</a>                                 ),
<a href="#h54-6-17" id="h54-6-17" class="i">+                                &quot;studio_id&quot;,
</a>                             ),
                         ),
<a href="#h54-6-20" id="h54-6-20" class="i">+                        right_size: 7,
</a>                         outer: false,
                     },
<a href="#h54-6-23" id="h54-6-23" class="d">-                    right_field: (
</a><a href="#h54-6-24" id="h54-6-24" class="d">-                        0,
</a><a href="#h54-6-25" id="h54-6-25" class="d">-                        Some(
</a><a href="#h54-6-26" id="h54-6-26" class="d">-                            (
</a><a href="#h54-6-27" id="h54-6-27" class="d">-                                Some(
</a><a href="#h54-6-28" id="h54-6-28" class="d">-                                    &quot;s&quot;,
</a><a href="#h54-6-29" id="h54-6-29" class="d">-                                ),
</a><a href="#h54-6-30" id="h54-6-30" class="d">-                                &quot;id&quot;,
</a><a href="#h54-6-31" id="h54-6-31" class="i">+                    right_field: 0,
</a><a href="#h54-6-32" id="h54-6-32" class="i">+                    right_label: Some(
</a><a href="#h54-6-33" id="h54-6-33" class="i">+                        (
</a><a href="#h54-6-34" id="h54-6-34" class="i">+                            Some(
</a><a href="#h54-6-35" id="h54-6-35" class="i">+                                &quot;s&quot;,
</a>                             ),
<a href="#h54-6-37" id="h54-6-37" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h54-6-40" id="h54-6-40" class="i">+                    right_size: 10,
</a>                     outer: false,
                 },
                 expressions: [
<b>diff --git a/<a id="h55" href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a> b/<a href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -178,6 +178,7 @@ Plan: Select {
</a>                 &quot;g&quot;,
             ),
         },
<a href="#h55-0-3" id="h55-0-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             Equal(
                 Field(
<a href="#h55-1" id="h55-1" class="h">@@ -367,15 +368,13 @@ Optimized plan: Select {
</a>                 &quot;m&quot;,
             ),
         },
<a href="#h55-1-3" id="h55-1-3" class="d">-        left_field: (
</a><a href="#h55-1-4" id="h55-1-4" class="d">-            3,
</a><a href="#h55-1-5" id="h55-1-5" class="d">-            Some(
</a><a href="#h55-1-6" id="h55-1-6" class="d">-                (
</a><a href="#h55-1-7" id="h55-1-7" class="d">-                    Some(
</a><a href="#h55-1-8" id="h55-1-8" class="d">-                        &quot;m&quot;,
</a><a href="#h55-1-9" id="h55-1-9" class="d">-                    ),
</a><a href="#h55-1-10" id="h55-1-10" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h55-1-11" id="h55-1-11" class="i">+        left_field: 3,
</a><a href="#h55-1-12" id="h55-1-12" class="i">+        left_label: Some(
</a><a href="#h55-1-13" id="h55-1-13" class="i">+            (
</a><a href="#h55-1-14" id="h55-1-14" class="i">+                Some(
</a><a href="#h55-1-15" id="h55-1-15" class="i">+                    &quot;m&quot;,
</a>                 ),
<a href="#h55-1-17" id="h55-1-17" class="i">+                &quot;genre_id&quot;,
</a>             ),
         ),
         right: Scan {
<a href="#h55-2" id="h55-2" class="h">@@ -408,17 +407,16 @@ Optimized plan: Select {
</a>                 &quot;g&quot;,
             ),
         },
<a href="#h55-2-3" id="h55-2-3" class="d">-        right_field: (
</a><a href="#h55-2-4" id="h55-2-4" class="d">-            0,
</a><a href="#h55-2-5" id="h55-2-5" class="d">-            Some(
</a><a href="#h55-2-6" id="h55-2-6" class="d">-                (
</a><a href="#h55-2-7" id="h55-2-7" class="d">-                    Some(
</a><a href="#h55-2-8" id="h55-2-8" class="d">-                        &quot;g&quot;,
</a><a href="#h55-2-9" id="h55-2-9" class="d">-                    ),
</a><a href="#h55-2-10" id="h55-2-10" class="d">-                    &quot;id&quot;,
</a><a href="#h55-2-11" id="h55-2-11" class="i">+        right_field: 0,
</a><a href="#h55-2-12" id="h55-2-12" class="i">+        right_label: Some(
</a><a href="#h55-2-13" id="h55-2-13" class="i">+            (
</a><a href="#h55-2-14" id="h55-2-14" class="i">+                Some(
</a><a href="#h55-2-15" id="h55-2-15" class="i">+                    &quot;g&quot;,
</a>                 ),
<a href="#h55-2-17" id="h55-2-17" class="i">+                &quot;id&quot;,
</a>             ),
         ),
<a href="#h55-2-20" id="h55-2-20" class="i">+        right_size: 2,
</a>         outer: false,
     },
     labels: [
<b>diff --git a/<a id="h56" href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a> b/<a href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -149,6 +149,7 @@ Plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h56-0-3" id="h56-0-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             Constant(
                 Boolean(
<a href="#h56-1" id="h56-1" class="h">@@ -352,6 +353,7 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h56-1-3" id="h56-1-3" class="i">+        right_size: 2,
</a>         predicate: None,
         outer: false,
     },
<b>diff --git a/<a id="h57" href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a> b/<a href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -182,6 +182,7 @@ Plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h57-0-3" id="h57-0-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             And(
                 Equal(
<a href="#h57-1" id="h57-1" class="h">@@ -424,6 +425,7 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h57-1-3" id="h57-1-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             And(
                 Equal(
<b>diff --git a/<a id="h58" href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a> b/<a href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -179,6 +179,7 @@ Plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h58-0-3" id="h58-0-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             Constant(
                 Boolean(
<a href="#h58-1" id="h58-1" class="h">@@ -382,6 +383,7 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h58-1-3" id="h58-1-3" class="i">+        right_size: 2,
</a>         predicate: None,
         outer: false,
     },
<b>diff --git a/<a id="h59" href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a> b/<a href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -185,6 +185,7 @@ Plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h59-0-3" id="h59-0-3" class="i">+            right_size: 2,
</a>             predicate: Some(
                 Equal(
                     Field(
<a href="#h59-1" id="h59-1" class="h">@@ -450,15 +451,13 @@ Optimized plan: Select {
</a>             ),
             alias: None,
         },
<a href="#h59-1-3" id="h59-1-3" class="d">-        left_field: (
</a><a href="#h59-1-4" id="h59-1-4" class="d">-            3,
</a><a href="#h59-1-5" id="h59-1-5" class="d">-            Some(
</a><a href="#h59-1-6" id="h59-1-6" class="d">-                (
</a><a href="#h59-1-7" id="h59-1-7" class="d">-                    Some(
</a><a href="#h59-1-8" id="h59-1-8" class="d">-                        &quot;movies&quot;,
</a><a href="#h59-1-9" id="h59-1-9" class="d">-                    ),
</a><a href="#h59-1-10" id="h59-1-10" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h59-1-11" id="h59-1-11" class="i">+        left_field: 3,
</a><a href="#h59-1-12" id="h59-1-12" class="i">+        left_label: Some(
</a><a href="#h59-1-13" id="h59-1-13" class="i">+            (
</a><a href="#h59-1-14" id="h59-1-14" class="i">+                Some(
</a><a href="#h59-1-15" id="h59-1-15" class="i">+                    &quot;movies&quot;,
</a>                 ),
<a href="#h59-1-17" id="h59-1-17" class="i">+                &quot;genre_id&quot;,
</a>             ),
         ),
         right: Scan {
<a href="#h59-2" id="h59-2" class="h">@@ -489,17 +488,16 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h59-2-3" id="h59-2-3" class="d">-        right_field: (
</a><a href="#h59-2-4" id="h59-2-4" class="d">-            0,
</a><a href="#h59-2-5" id="h59-2-5" class="d">-            Some(
</a><a href="#h59-2-6" id="h59-2-6" class="d">-                (
</a><a href="#h59-2-7" id="h59-2-7" class="d">-                    Some(
</a><a href="#h59-2-8" id="h59-2-8" class="d">-                        &quot;genres&quot;,
</a><a href="#h59-2-9" id="h59-2-9" class="d">-                    ),
</a><a href="#h59-2-10" id="h59-2-10" class="d">-                    &quot;id&quot;,
</a><a href="#h59-2-11" id="h59-2-11" class="i">+        right_field: 0,
</a><a href="#h59-2-12" id="h59-2-12" class="i">+        right_label: Some(
</a><a href="#h59-2-13" id="h59-2-13" class="i">+            (
</a><a href="#h59-2-14" id="h59-2-14" class="i">+                Some(
</a><a href="#h59-2-15" id="h59-2-15" class="i">+                    &quot;genres&quot;,
</a>                 ),
<a href="#h59-2-17" id="h59-2-17" class="i">+                &quot;id&quot;,
</a>             ),
         ),
<a href="#h59-2-20" id="h59-2-20" class="i">+        right_size: 2,
</a>         outer: false,
     },
     labels: [
<b>diff --git a/<a id="h60" href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a> b/<a href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -203,6 +203,7 @@ Plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h60-0-3" id="h60-0-3" class="i">+            right_size: 2,
</a>             predicate: Some(
                 Equal(
                     Field(
<a href="#h60-1" id="h60-1" class="h">@@ -372,15 +373,13 @@ Optimized plan: Select {
</a>                     &quot;m&quot;,
                 ),
             },
<a href="#h60-1-3" id="h60-1-3" class="d">-            left_field: (
</a><a href="#h60-1-4" id="h60-1-4" class="d">-                0,
</a><a href="#h60-1-5" id="h60-1-5" class="d">-                Some(
</a><a href="#h60-1-6" id="h60-1-6" class="d">-                    (
</a><a href="#h60-1-7" id="h60-1-7" class="d">-                        Some(
</a><a href="#h60-1-8" id="h60-1-8" class="d">-                            &quot;m&quot;,
</a><a href="#h60-1-9" id="h60-1-9" class="d">-                        ),
</a><a href="#h60-1-10" id="h60-1-10" class="d">-                        &quot;id&quot;,
</a><a href="#h60-1-11" id="h60-1-11" class="i">+            left_field: 0,
</a><a href="#h60-1-12" id="h60-1-12" class="i">+            left_label: Some(
</a><a href="#h60-1-13" id="h60-1-13" class="i">+                (
</a><a href="#h60-1-14" id="h60-1-14" class="i">+                    Some(
</a><a href="#h60-1-15" id="h60-1-15" class="i">+                        &quot;m&quot;,
</a>                     ),
<a href="#h60-1-17" id="h60-1-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
             right: Scan {
<a href="#h60-2" id="h60-2" class="h">@@ -413,17 +412,16 @@ Optimized plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h60-2-3" id="h60-2-3" class="d">-            right_field: (
</a><a href="#h60-2-4" id="h60-2-4" class="d">-                0,
</a><a href="#h60-2-5" id="h60-2-5" class="d">-                Some(
</a><a href="#h60-2-6" id="h60-2-6" class="d">-                    (
</a><a href="#h60-2-7" id="h60-2-7" class="d">-                        Some(
</a><a href="#h60-2-8" id="h60-2-8" class="d">-                            &quot;g&quot;,
</a><a href="#h60-2-9" id="h60-2-9" class="d">-                        ),
</a><a href="#h60-2-10" id="h60-2-10" class="d">-                        &quot;id&quot;,
</a><a href="#h60-2-11" id="h60-2-11" class="i">+            right_field: 0,
</a><a href="#h60-2-12" id="h60-2-12" class="i">+            right_label: Some(
</a><a href="#h60-2-13" id="h60-2-13" class="i">+                (
</a><a href="#h60-2-14" id="h60-2-14" class="i">+                    Some(
</a><a href="#h60-2-15" id="h60-2-15" class="i">+                        &quot;g&quot;,
</a>                     ),
<a href="#h60-2-17" id="h60-2-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
<a href="#h60-2-20" id="h60-2-20" class="i">+            right_size: 2,
</a>             outer: true,
         },
         expressions: [
<b>diff --git a/<a id="h61" href="../file/tests/sql/query/join_left_all.html">tests/sql/query/join_left_all</a> b/<a href="../file/tests/sql/query/join_left_all.html">tests/sql/query/join_left_all</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -178,6 +178,7 @@ Plan: Select {
</a>                 &quot;g&quot;,
             ),
         },
<a href="#h61-0-3" id="h61-0-3" class="i">+        right_size: 2,
</a>         predicate: Some(
             Equal(
                 Field(
<a href="#h61-1" id="h61-1" class="h">@@ -367,15 +368,13 @@ Optimized plan: Select {
</a>                 &quot;m&quot;,
             ),
         },
<a href="#h61-1-3" id="h61-1-3" class="d">-        left_field: (
</a><a href="#h61-1-4" id="h61-1-4" class="d">-            0,
</a><a href="#h61-1-5" id="h61-1-5" class="d">-            Some(
</a><a href="#h61-1-6" id="h61-1-6" class="d">-                (
</a><a href="#h61-1-7" id="h61-1-7" class="d">-                    Some(
</a><a href="#h61-1-8" id="h61-1-8" class="d">-                        &quot;m&quot;,
</a><a href="#h61-1-9" id="h61-1-9" class="d">-                    ),
</a><a href="#h61-1-10" id="h61-1-10" class="d">-                    &quot;id&quot;,
</a><a href="#h61-1-11" id="h61-1-11" class="i">+        left_field: 0,
</a><a href="#h61-1-12" id="h61-1-12" class="i">+        left_label: Some(
</a><a href="#h61-1-13" id="h61-1-13" class="i">+            (
</a><a href="#h61-1-14" id="h61-1-14" class="i">+                Some(
</a><a href="#h61-1-15" id="h61-1-15" class="i">+                    &quot;m&quot;,
</a>                 ),
<a href="#h61-1-17" id="h61-1-17" class="i">+                &quot;id&quot;,
</a>             ),
         ),
         right: Scan {
<a href="#h61-2" id="h61-2" class="h">@@ -408,17 +407,16 @@ Optimized plan: Select {
</a>                 &quot;g&quot;,
             ),
         },
<a href="#h61-2-3" id="h61-2-3" class="d">-        right_field: (
</a><a href="#h61-2-4" id="h61-2-4" class="d">-            0,
</a><a href="#h61-2-5" id="h61-2-5" class="d">-            Some(
</a><a href="#h61-2-6" id="h61-2-6" class="d">-                (
</a><a href="#h61-2-7" id="h61-2-7" class="d">-                    Some(
</a><a href="#h61-2-8" id="h61-2-8" class="d">-                        &quot;g&quot;,
</a><a href="#h61-2-9" id="h61-2-9" class="d">-                    ),
</a><a href="#h61-2-10" id="h61-2-10" class="d">-                    &quot;id&quot;,
</a><a href="#h61-2-11" id="h61-2-11" class="i">+        right_field: 0,
</a><a href="#h61-2-12" id="h61-2-12" class="i">+        right_label: Some(
</a><a href="#h61-2-13" id="h61-2-13" class="i">+            (
</a><a href="#h61-2-14" id="h61-2-14" class="i">+                Some(
</a><a href="#h61-2-15" id="h61-2-15" class="i">+                    &quot;g&quot;,
</a>                 ),
<a href="#h61-2-17" id="h61-2-17" class="i">+                &quot;id&quot;,
</a>             ),
         ),
<a href="#h61-2-20" id="h61-2-20" class="i">+        right_size: 2,
</a>         outer: true,
     },
     labels: [
<b>diff --git a/<a id="h62" href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a> b/<a href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -203,6 +203,7 @@ Plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h62-0-3" id="h62-0-3" class="i">+            right_size: 2,
</a>             predicate: Some(
                 Equal(
                     Field(
<a href="#h62-1" id="h62-1" class="h">@@ -372,15 +373,13 @@ Optimized plan: Select {
</a>                     &quot;m&quot;,
                 ),
             },
<a href="#h62-1-3" id="h62-1-3" class="d">-            left_field: (
</a><a href="#h62-1-4" id="h62-1-4" class="d">-                0,
</a><a href="#h62-1-5" id="h62-1-5" class="d">-                Some(
</a><a href="#h62-1-6" id="h62-1-6" class="d">-                    (
</a><a href="#h62-1-7" id="h62-1-7" class="d">-                        Some(
</a><a href="#h62-1-8" id="h62-1-8" class="d">-                            &quot;m&quot;,
</a><a href="#h62-1-9" id="h62-1-9" class="d">-                        ),
</a><a href="#h62-1-10" id="h62-1-10" class="d">-                        &quot;id&quot;,
</a><a href="#h62-1-11" id="h62-1-11" class="i">+            left_field: 0,
</a><a href="#h62-1-12" id="h62-1-12" class="i">+            left_label: Some(
</a><a href="#h62-1-13" id="h62-1-13" class="i">+                (
</a><a href="#h62-1-14" id="h62-1-14" class="i">+                    Some(
</a><a href="#h62-1-15" id="h62-1-15" class="i">+                        &quot;m&quot;,
</a>                     ),
<a href="#h62-1-17" id="h62-1-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
             right: Scan {
<a href="#h62-2" id="h62-2" class="h">@@ -413,17 +412,16 @@ Optimized plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h62-2-3" id="h62-2-3" class="d">-            right_field: (
</a><a href="#h62-2-4" id="h62-2-4" class="d">-                0,
</a><a href="#h62-2-5" id="h62-2-5" class="d">-                Some(
</a><a href="#h62-2-6" id="h62-2-6" class="d">-                    (
</a><a href="#h62-2-7" id="h62-2-7" class="d">-                        Some(
</a><a href="#h62-2-8" id="h62-2-8" class="d">-                            &quot;g&quot;,
</a><a href="#h62-2-9" id="h62-2-9" class="d">-                        ),
</a><a href="#h62-2-10" id="h62-2-10" class="d">-                        &quot;id&quot;,
</a><a href="#h62-2-11" id="h62-2-11" class="i">+            right_field: 0,
</a><a href="#h62-2-12" id="h62-2-12" class="i">+            right_label: Some(
</a><a href="#h62-2-13" id="h62-2-13" class="i">+                (
</a><a href="#h62-2-14" id="h62-2-14" class="i">+                    Some(
</a><a href="#h62-2-15" id="h62-2-15" class="i">+                        &quot;g&quot;,
</a>                     ),
<a href="#h62-2-17" id="h62-2-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
<a href="#h62-2-20" id="h62-2-20" class="i">+            right_size: 2,
</a>             outer: true,
         },
         expressions: [
<b>diff --git a/<a id="h63" href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a> b/<a href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -196,6 +196,7 @@ Plan: Select {
</a>                     &quot;m&quot;,
                 ),
             },
<a href="#h63-0-3" id="h63-0-3" class="i">+            right_size: 7,
</a>             predicate: Some(
                 Equal(
                     Field(
<a href="#h63-1" id="h63-1" class="h">@@ -312,15 +313,13 @@ Optimized plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h63-1-3" id="h63-1-3" class="d">-            left_field: (
</a><a href="#h63-1-4" id="h63-1-4" class="d">-                0,
</a><a href="#h63-1-5" id="h63-1-5" class="d">-                Some(
</a><a href="#h63-1-6" id="h63-1-6" class="d">-                    (
</a><a href="#h63-1-7" id="h63-1-7" class="d">-                        Some(
</a><a href="#h63-1-8" id="h63-1-8" class="d">-                            &quot;g&quot;,
</a><a href="#h63-1-9" id="h63-1-9" class="d">-                        ),
</a><a href="#h63-1-10" id="h63-1-10" class="d">-                        &quot;id&quot;,
</a><a href="#h63-1-11" id="h63-1-11" class="i">+            left_field: 0,
</a><a href="#h63-1-12" id="h63-1-12" class="i">+            left_label: Some(
</a><a href="#h63-1-13" id="h63-1-13" class="i">+                (
</a><a href="#h63-1-14" id="h63-1-14" class="i">+                    Some(
</a><a href="#h63-1-15" id="h63-1-15" class="i">+                        &quot;g&quot;,
</a>                     ),
<a href="#h63-1-17" id="h63-1-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
             right: Scan {
<a href="#h63-2" id="h63-2" class="h">@@ -406,17 +405,16 @@ Optimized plan: Select {
</a>                     &quot;m&quot;,
                 ),
             },
<a href="#h63-2-3" id="h63-2-3" class="d">-            right_field: (
</a><a href="#h63-2-4" id="h63-2-4" class="d">-                0,
</a><a href="#h63-2-5" id="h63-2-5" class="d">-                Some(
</a><a href="#h63-2-6" id="h63-2-6" class="d">-                    (
</a><a href="#h63-2-7" id="h63-2-7" class="d">-                        Some(
</a><a href="#h63-2-8" id="h63-2-8" class="d">-                            &quot;m&quot;,
</a><a href="#h63-2-9" id="h63-2-9" class="d">-                        ),
</a><a href="#h63-2-10" id="h63-2-10" class="d">-                        &quot;id&quot;,
</a><a href="#h63-2-11" id="h63-2-11" class="i">+            right_field: 0,
</a><a href="#h63-2-12" id="h63-2-12" class="i">+            right_label: Some(
</a><a href="#h63-2-13" id="h63-2-13" class="i">+                (
</a><a href="#h63-2-14" id="h63-2-14" class="i">+                    Some(
</a><a href="#h63-2-15" id="h63-2-15" class="i">+                        &quot;m&quot;,
</a>                     ),
<a href="#h63-2-17" id="h63-2-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
<a href="#h63-2-20" id="h63-2-20" class="i">+            right_size: 7,
</a>             outer: true,
         },
         expressions: [
<b>diff --git a/<a id="h64" href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a> b/<a href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -205,6 +205,7 @@ Plan: Select {
</a>                         &quot;g&quot;,
                     ),
                 },
<a href="#h64-0-3" id="h64-0-3" class="i">+                right_size: 2,
</a>                 predicate: Some(
                     Equal(
                         Field(
<a href="#h64-1" id="h64-1" class="h">@@ -488,15 +489,13 @@ Optimized plan: Select {
</a>                         &quot;m&quot;,
                     ),
                 },
<a href="#h64-1-3" id="h64-1-3" class="d">-                left_field: (
</a><a href="#h64-1-4" id="h64-1-4" class="d">-                    0,
</a><a href="#h64-1-5" id="h64-1-5" class="d">-                    Some(
</a><a href="#h64-1-6" id="h64-1-6" class="d">-                        (
</a><a href="#h64-1-7" id="h64-1-7" class="d">-                            Some(
</a><a href="#h64-1-8" id="h64-1-8" class="d">-                                &quot;m&quot;,
</a><a href="#h64-1-9" id="h64-1-9" class="d">-                            ),
</a><a href="#h64-1-10" id="h64-1-10" class="d">-                            &quot;id&quot;,
</a><a href="#h64-1-11" id="h64-1-11" class="i">+                left_field: 0,
</a><a href="#h64-1-12" id="h64-1-12" class="i">+                left_label: Some(
</a><a href="#h64-1-13" id="h64-1-13" class="i">+                    (
</a><a href="#h64-1-14" id="h64-1-14" class="i">+                        Some(
</a><a href="#h64-1-15" id="h64-1-15" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h64-1-17" id="h64-1-17" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
                 right: Scan {
<a href="#h64-2" id="h64-2" class="h">@@ -529,17 +528,16 @@ Optimized plan: Select {
</a>                         &quot;g&quot;,
                     ),
                 },
<a href="#h64-2-3" id="h64-2-3" class="d">-                right_field: (
</a><a href="#h64-2-4" id="h64-2-4" class="d">-                    0,
</a><a href="#h64-2-5" id="h64-2-5" class="d">-                    Some(
</a><a href="#h64-2-6" id="h64-2-6" class="d">-                        (
</a><a href="#h64-2-7" id="h64-2-7" class="d">-                            Some(
</a><a href="#h64-2-8" id="h64-2-8" class="d">-                                &quot;g&quot;,
</a><a href="#h64-2-9" id="h64-2-9" class="d">-                            ),
</a><a href="#h64-2-10" id="h64-2-10" class="d">-                            &quot;id&quot;,
</a><a href="#h64-2-11" id="h64-2-11" class="i">+                right_field: 0,
</a><a href="#h64-2-12" id="h64-2-12" class="i">+                right_label: Some(
</a><a href="#h64-2-13" id="h64-2-13" class="i">+                    (
</a><a href="#h64-2-14" id="h64-2-14" class="i">+                        Some(
</a><a href="#h64-2-15" id="h64-2-15" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h64-2-17" id="h64-2-17" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h64-2-20" id="h64-2-20" class="i">+                right_size: 2,
</a>                 outer: true,
             },
             expressions: [
<b>diff --git a/<a id="h65" href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a> b/<a href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -180,6 +180,7 @@ Plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h65-0-3" id="h65-0-3" class="i">+            right_size: 2,
</a>             predicate: Some(
                 Equal(
                     Field(
<a href="#h65-1" id="h65-1" class="h">@@ -483,15 +484,13 @@ Optimized plan: Select {
</a>                     &quot;m&quot;,
                 ),
             },
<a href="#h65-1-3" id="h65-1-3" class="d">-            left_field: (
</a><a href="#h65-1-4" id="h65-1-4" class="d">-                0,
</a><a href="#h65-1-5" id="h65-1-5" class="d">-                Some(
</a><a href="#h65-1-6" id="h65-1-6" class="d">-                    (
</a><a href="#h65-1-7" id="h65-1-7" class="d">-                        Some(
</a><a href="#h65-1-8" id="h65-1-8" class="d">-                            &quot;m&quot;,
</a><a href="#h65-1-9" id="h65-1-9" class="d">-                        ),
</a><a href="#h65-1-10" id="h65-1-10" class="d">-                        &quot;id&quot;,
</a><a href="#h65-1-11" id="h65-1-11" class="i">+            left_field: 0,
</a><a href="#h65-1-12" id="h65-1-12" class="i">+            left_label: Some(
</a><a href="#h65-1-13" id="h65-1-13" class="i">+                (
</a><a href="#h65-1-14" id="h65-1-14" class="i">+                    Some(
</a><a href="#h65-1-15" id="h65-1-15" class="i">+                        &quot;m&quot;,
</a>                     ),
<a href="#h65-1-17" id="h65-1-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
             right: Scan {
<a href="#h65-2" id="h65-2" class="h">@@ -524,17 +523,16 @@ Optimized plan: Select {
</a>                     &quot;g&quot;,
                 ),
             },
<a href="#h65-2-3" id="h65-2-3" class="d">-            right_field: (
</a><a href="#h65-2-4" id="h65-2-4" class="d">-                0,
</a><a href="#h65-2-5" id="h65-2-5" class="d">-                Some(
</a><a href="#h65-2-6" id="h65-2-6" class="d">-                    (
</a><a href="#h65-2-7" id="h65-2-7" class="d">-                        Some(
</a><a href="#h65-2-8" id="h65-2-8" class="d">-                            &quot;g&quot;,
</a><a href="#h65-2-9" id="h65-2-9" class="d">-                        ),
</a><a href="#h65-2-10" id="h65-2-10" class="d">-                        &quot;id&quot;,
</a><a href="#h65-2-11" id="h65-2-11" class="i">+            right_field: 0,
</a><a href="#h65-2-12" id="h65-2-12" class="i">+            right_label: Some(
</a><a href="#h65-2-13" id="h65-2-13" class="i">+                (
</a><a href="#h65-2-14" id="h65-2-14" class="i">+                    Some(
</a><a href="#h65-2-15" id="h65-2-15" class="i">+                        &quot;g&quot;,
</a>                     ),
<a href="#h65-2-17" id="h65-2-17" class="i">+                    &quot;id&quot;,
</a>                 ),
             ),
<a href="#h65-2-20" id="h65-2-20" class="i">+            right_size: 2,
</a>             outer: true,
         },
         expressions: [
<b>diff --git a/<a id="h66" href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a> b/<a href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -205,6 +205,7 @@ Plan: Select {
</a>                         &quot;g&quot;,
                     ),
                 },
<a href="#h66-0-3" id="h66-0-3" class="i">+                right_size: 2,
</a>                 predicate: Some(
                     Equal(
                         Field(
<a href="#h66-1" id="h66-1" class="h">@@ -488,15 +489,13 @@ Optimized plan: Select {
</a>                         &quot;m&quot;,
                     ),
                 },
<a href="#h66-1-3" id="h66-1-3" class="d">-                left_field: (
</a><a href="#h66-1-4" id="h66-1-4" class="d">-                    0,
</a><a href="#h66-1-5" id="h66-1-5" class="d">-                    Some(
</a><a href="#h66-1-6" id="h66-1-6" class="d">-                        (
</a><a href="#h66-1-7" id="h66-1-7" class="d">-                            Some(
</a><a href="#h66-1-8" id="h66-1-8" class="d">-                                &quot;m&quot;,
</a><a href="#h66-1-9" id="h66-1-9" class="d">-                            ),
</a><a href="#h66-1-10" id="h66-1-10" class="d">-                            &quot;id&quot;,
</a><a href="#h66-1-11" id="h66-1-11" class="i">+                left_field: 0,
</a><a href="#h66-1-12" id="h66-1-12" class="i">+                left_label: Some(
</a><a href="#h66-1-13" id="h66-1-13" class="i">+                    (
</a><a href="#h66-1-14" id="h66-1-14" class="i">+                        Some(
</a><a href="#h66-1-15" id="h66-1-15" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h66-1-17" id="h66-1-17" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
                 right: Scan {
<a href="#h66-2" id="h66-2" class="h">@@ -529,17 +528,16 @@ Optimized plan: Select {
</a>                         &quot;g&quot;,
                     ),
                 },
<a href="#h66-2-3" id="h66-2-3" class="d">-                right_field: (
</a><a href="#h66-2-4" id="h66-2-4" class="d">-                    0,
</a><a href="#h66-2-5" id="h66-2-5" class="d">-                    Some(
</a><a href="#h66-2-6" id="h66-2-6" class="d">-                        (
</a><a href="#h66-2-7" id="h66-2-7" class="d">-                            Some(
</a><a href="#h66-2-8" id="h66-2-8" class="d">-                                &quot;g&quot;,
</a><a href="#h66-2-9" id="h66-2-9" class="d">-                            ),
</a><a href="#h66-2-10" id="h66-2-10" class="d">-                            &quot;id&quot;,
</a><a href="#h66-2-11" id="h66-2-11" class="i">+                right_field: 0,
</a><a href="#h66-2-12" id="h66-2-12" class="i">+                right_label: Some(
</a><a href="#h66-2-13" id="h66-2-13" class="i">+                    (
</a><a href="#h66-2-14" id="h66-2-14" class="i">+                        Some(
</a><a href="#h66-2-15" id="h66-2-15" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h66-2-17" id="h66-2-17" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h66-2-20" id="h66-2-20" class="i">+                right_size: 2,
</a>                 outer: true,
             },
             expressions: [
<b>diff --git a/<a id="h67" href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a> b/<a href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -198,6 +198,7 @@ Plan: Select {
</a>                         &quot;m&quot;,
                     ),
                 },
<a href="#h67-0-3" id="h67-0-3" class="i">+                right_size: 7,
</a>                 predicate: Some(
                     Equal(
                         Field(
<a href="#h67-1" id="h67-1" class="h">@@ -428,15 +429,13 @@ Optimized plan: Select {
</a>                         &quot;g&quot;,
                     ),
                 },
<a href="#h67-1-3" id="h67-1-3" class="d">-                left_field: (
</a><a href="#h67-1-4" id="h67-1-4" class="d">-                    0,
</a><a href="#h67-1-5" id="h67-1-5" class="d">-                    Some(
</a><a href="#h67-1-6" id="h67-1-6" class="d">-                        (
</a><a href="#h67-1-7" id="h67-1-7" class="d">-                            Some(
</a><a href="#h67-1-8" id="h67-1-8" class="d">-                                &quot;g&quot;,
</a><a href="#h67-1-9" id="h67-1-9" class="d">-                            ),
</a><a href="#h67-1-10" id="h67-1-10" class="d">-                            &quot;id&quot;,
</a><a href="#h67-1-11" id="h67-1-11" class="i">+                left_field: 0,
</a><a href="#h67-1-12" id="h67-1-12" class="i">+                left_label: Some(
</a><a href="#h67-1-13" id="h67-1-13" class="i">+                    (
</a><a href="#h67-1-14" id="h67-1-14" class="i">+                        Some(
</a><a href="#h67-1-15" id="h67-1-15" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h67-1-17" id="h67-1-17" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
                 right: Scan {
<a href="#h67-2" id="h67-2" class="h">@@ -522,17 +521,16 @@ Optimized plan: Select {
</a>                         &quot;m&quot;,
                     ),
                 },
<a href="#h67-2-3" id="h67-2-3" class="d">-                right_field: (
</a><a href="#h67-2-4" id="h67-2-4" class="d">-                    0,
</a><a href="#h67-2-5" id="h67-2-5" class="d">-                    Some(
</a><a href="#h67-2-6" id="h67-2-6" class="d">-                        (
</a><a href="#h67-2-7" id="h67-2-7" class="d">-                            Some(
</a><a href="#h67-2-8" id="h67-2-8" class="d">-                                &quot;m&quot;,
</a><a href="#h67-2-9" id="h67-2-9" class="d">-                            ),
</a><a href="#h67-2-10" id="h67-2-10" class="d">-                            &quot;id&quot;,
</a><a href="#h67-2-11" id="h67-2-11" class="i">+                right_field: 0,
</a><a href="#h67-2-12" id="h67-2-12" class="i">+                right_label: Some(
</a><a href="#h67-2-13" id="h67-2-13" class="i">+                    (
</a><a href="#h67-2-14" id="h67-2-14" class="i">+                        Some(
</a><a href="#h67-2-15" id="h67-2-15" class="i">+                            &quot;m&quot;,
</a>                         ),
<a href="#h67-2-17" id="h67-2-17" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h67-2-20" id="h67-2-20" class="i">+                right_size: 7,
</a>                 outer: true,
             },
             expressions: [
<b>diff --git a/<a id="h68" href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a> b/<a href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -181,6 +181,7 @@ Plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h68-0-3" id="h68-0-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<a href="#h68-1" id="h68-1" class="h">@@ -341,6 +342,7 @@ Optimized plan: Select {
</a>                 aggregates: [
                     Max,
                 ],
<a href="#h68-1-3" id="h68-1-3" class="i">+                group_by: 1,
</a>             },
             expressions: [
                 Field(
<b>diff --git a/<a id="h69" href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a> b/<a href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -194,6 +194,7 @@ Plan: Select {
</a>                         Max,
                         Min,
                     ],
<a href="#h69-0-3" id="h69-0-3" class="i">+                    group_by: 1,
</a>                 },
                 expressions: [
                     Field(
<a href="#h69-1" id="h69-1" class="h">@@ -386,6 +387,7 @@ Optimized plan: Select {
</a>                         Max,
                         Min,
                     ],
<a href="#h69-1-3" id="h69-1-3" class="i">+                    group_by: 1,
</a>                 },
                 expressions: [
                     Field(
<b>diff --git a/<a id="h70" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -214,6 +214,7 @@ Plan: Select {
</a>                         filter: None,
                         alias: None,
                     },
<a href="#h70-0-3" id="h70-0-3" class="i">+                    right_size: 2,
</a>                     predicate: None,
                     outer: false,
                 },
<a href="#h70-1" id="h70-1" class="h">@@ -426,15 +427,13 @@ Optimized plan: Select {
</a>                     filter: None,
                     alias: None,
                 },
<a href="#h70-1-3" id="h70-1-3" class="d">-                left_field: (
</a><a href="#h70-1-4" id="h70-1-4" class="d">-                    3,
</a><a href="#h70-1-5" id="h70-1-5" class="d">-                    Some(
</a><a href="#h70-1-6" id="h70-1-6" class="d">-                        (
</a><a href="#h70-1-7" id="h70-1-7" class="d">-                            Some(
</a><a href="#h70-1-8" id="h70-1-8" class="d">-                                &quot;movies&quot;,
</a><a href="#h70-1-9" id="h70-1-9" class="d">-                            ),
</a><a href="#h70-1-10" id="h70-1-10" class="d">-                            &quot;genre_id&quot;,
</a><a href="#h70-1-11" id="h70-1-11" class="i">+                left_field: 3,
</a><a href="#h70-1-12" id="h70-1-12" class="i">+                left_label: Some(
</a><a href="#h70-1-13" id="h70-1-13" class="i">+                    (
</a><a href="#h70-1-14" id="h70-1-14" class="i">+                        Some(
</a><a href="#h70-1-15" id="h70-1-15" class="i">+                            &quot;movies&quot;,
</a>                         ),
<a href="#h70-1-17" id="h70-1-17" class="i">+                        &quot;genre_id&quot;,
</a>                     ),
                 ),
                 right: Scan {
<a href="#h70-2" id="h70-2" class="h">@@ -465,17 +464,16 @@ Optimized plan: Select {
</a>                     filter: None,
                     alias: None,
                 },
<a href="#h70-2-3" id="h70-2-3" class="d">-                right_field: (
</a><a href="#h70-2-4" id="h70-2-4" class="d">-                    0,
</a><a href="#h70-2-5" id="h70-2-5" class="d">-                    Some(
</a><a href="#h70-2-6" id="h70-2-6" class="d">-                        (
</a><a href="#h70-2-7" id="h70-2-7" class="d">-                            Some(
</a><a href="#h70-2-8" id="h70-2-8" class="d">-                                &quot;genres&quot;,
</a><a href="#h70-2-9" id="h70-2-9" class="d">-                            ),
</a><a href="#h70-2-10" id="h70-2-10" class="d">-                            &quot;id&quot;,
</a><a href="#h70-2-11" id="h70-2-11" class="i">+                right_field: 0,
</a><a href="#h70-2-12" id="h70-2-12" class="i">+                right_label: Some(
</a><a href="#h70-2-13" id="h70-2-13" class="i">+                    (
</a><a href="#h70-2-14" id="h70-2-14" class="i">+                        Some(
</a><a href="#h70-2-15" id="h70-2-15" class="i">+                            &quot;genres&quot;,
</a>                         ),
<a href="#h70-2-17" id="h70-2-17" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h70-2-20" id="h70-2-20" class="i">+                right_size: 2,
</a>                 outer: false,
             },
             expressions: [
<b>diff --git a/<a id="h71" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -216,6 +216,7 @@ Plan: Select {
</a>                             filter: None,
                             alias: None,
                         },
<a href="#h71-0-3" id="h71-0-3" class="i">+                        right_size: 2,
</a>                         predicate: None,
                         outer: false,
                     },
<a href="#h71-1" id="h71-1" class="h">@@ -470,15 +471,13 @@ Optimized plan: Select {
</a>                         filter: None,
                         alias: None,
                     },
<a href="#h71-1-3" id="h71-1-3" class="d">-                    left_field: (
</a><a href="#h71-1-4" id="h71-1-4" class="d">-                        3,
</a><a href="#h71-1-5" id="h71-1-5" class="d">-                        Some(
</a><a href="#h71-1-6" id="h71-1-6" class="d">-                            (
</a><a href="#h71-1-7" id="h71-1-7" class="d">-                                Some(
</a><a href="#h71-1-8" id="h71-1-8" class="d">-                                    &quot;movies&quot;,
</a><a href="#h71-1-9" id="h71-1-9" class="d">-                                ),
</a><a href="#h71-1-10" id="h71-1-10" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h71-1-11" id="h71-1-11" class="i">+                    left_field: 3,
</a><a href="#h71-1-12" id="h71-1-12" class="i">+                    left_label: Some(
</a><a href="#h71-1-13" id="h71-1-13" class="i">+                        (
</a><a href="#h71-1-14" id="h71-1-14" class="i">+                            Some(
</a><a href="#h71-1-15" id="h71-1-15" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h71-1-17" id="h71-1-17" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
                     right: Scan {
<a href="#h71-2" id="h71-2" class="h">@@ -509,17 +508,16 @@ Optimized plan: Select {
</a>                         filter: None,
                         alias: None,
                     },
<a href="#h71-2-3" id="h71-2-3" class="d">-                    right_field: (
</a><a href="#h71-2-4" id="h71-2-4" class="d">-                        0,
</a><a href="#h71-2-5" id="h71-2-5" class="d">-                        Some(
</a><a href="#h71-2-6" id="h71-2-6" class="d">-                            (
</a><a href="#h71-2-7" id="h71-2-7" class="d">-                                Some(
</a><a href="#h71-2-8" id="h71-2-8" class="d">-                                    &quot;genres&quot;,
</a><a href="#h71-2-9" id="h71-2-9" class="d">-                                ),
</a><a href="#h71-2-10" id="h71-2-10" class="d">-                                &quot;id&quot;,
</a><a href="#h71-2-11" id="h71-2-11" class="i">+                    right_field: 0,
</a><a href="#h71-2-12" id="h71-2-12" class="i">+                    right_label: Some(
</a><a href="#h71-2-13" id="h71-2-13" class="i">+                        (
</a><a href="#h71-2-14" id="h71-2-14" class="i">+                            Some(
</a><a href="#h71-2-15" id="h71-2-15" class="i">+                                &quot;genres&quot;,
</a>                             ),
<a href="#h71-2-17" id="h71-2-17" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h71-2-20" id="h71-2-20" class="i">+                    right_size: 2,
</a>                     outer: false,
                 },
                 expressions: [
<b>diff --git a/<a id="h72" href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a> b/<a href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -171,6 +171,7 @@ Plan: Select {
</a>                     aggregates: [
                         Max,
                     ],
<a href="#h72-0-3" id="h72-0-3" class="i">+                    group_by: 1,
</a>                 },
                 expressions: [
                     Field(
<a href="#h72-1" id="h72-1" class="h">@@ -341,6 +342,7 @@ Optimized plan: Select {
</a>                     aggregates: [
                         Max,
                     ],
<a href="#h72-1-3" id="h72-1-3" class="i">+                    group_by: 1,
</a>                 },
                 expressions: [
                     Field(
<b>diff --git a/<a id="h73" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -212,6 +212,7 @@ Plan: Select {
</a>                         &quot;g&quot;,
                     ),
                 },
<a href="#h73-0-3" id="h73-0-3" class="i">+                right_size: 2,
</a>                 predicate: None,
                 outer: false,
             },
<a href="#h73-1" id="h73-1" class="h">@@ -450,39 +451,17 @@ Optimized plan: Select {
</a>             },
             left_size: 7,
             right: KeyLookup {
<a href="#h73-1-3" id="h73-1-3" class="d">-                table: Table {
</a><a href="#h73-1-4" id="h73-1-4" class="d">-                    name: &quot;genres&quot;,
</a><a href="#h73-1-5" id="h73-1-5" class="d">-                    primary_key: 0,
</a><a href="#h73-1-6" id="h73-1-6" class="d">-                    columns: [
</a><a href="#h73-1-7" id="h73-1-7" class="d">-                        Column {
</a><a href="#h73-1-8" id="h73-1-8" class="d">-                            name: &quot;id&quot;,
</a><a href="#h73-1-9" id="h73-1-9" class="d">-                            datatype: Integer,
</a><a href="#h73-1-10" id="h73-1-10" class="d">-                            nullable: false,
</a><a href="#h73-1-11" id="h73-1-11" class="d">-                            default: None,
</a><a href="#h73-1-12" id="h73-1-12" class="d">-                            unique: true,
</a><a href="#h73-1-13" id="h73-1-13" class="d">-                            index: false,
</a><a href="#h73-1-14" id="h73-1-14" class="d">-                            references: None,
</a><a href="#h73-1-15" id="h73-1-15" class="d">-                        },
</a><a href="#h73-1-16" id="h73-1-16" class="d">-                        Column {
</a><a href="#h73-1-17" id="h73-1-17" class="d">-                            name: &quot;name&quot;,
</a><a href="#h73-1-18" id="h73-1-18" class="d">-                            datatype: String,
</a><a href="#h73-1-19" id="h73-1-19" class="d">-                            nullable: false,
</a><a href="#h73-1-20" id="h73-1-20" class="d">-                            default: None,
</a><a href="#h73-1-21" id="h73-1-21" class="d">-                            unique: false,
</a><a href="#h73-1-22" id="h73-1-22" class="d">-                            index: false,
</a><a href="#h73-1-23" id="h73-1-23" class="d">-                            references: None,
</a><a href="#h73-1-24" id="h73-1-24" class="d">-                        },
</a><a href="#h73-1-25" id="h73-1-25" class="d">-                    ],
</a><a href="#h73-1-26" id="h73-1-26" class="d">-                },
</a><a href="#h73-1-27" id="h73-1-27" class="d">-                alias: Some(
</a><a href="#h73-1-28" id="h73-1-28" class="d">-                    &quot;g&quot;,
</a><a href="#h73-1-29" id="h73-1-29" class="d">-                ),
</a><a href="#h73-1-30" id="h73-1-30" class="i">+                table: &quot;genres&quot;,
</a>                 keys: [
                     Integer(
                         1,
                     ),
                 ],
<a href="#h73-1-36" id="h73-1-36" class="i">+                alias: Some(
</a><a href="#h73-1-37" id="h73-1-37" class="i">+                    &quot;g&quot;,
</a><a href="#h73-1-38" id="h73-1-38" class="i">+                ),
</a>             },
<a href="#h73-1-40" id="h73-1-40" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<b>diff --git a/<a id="h74" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -204,6 +204,7 @@ Plan: Select {
</a>                     filter: None,
                     alias: None,
                 },
<a href="#h74-0-3" id="h74-0-3" class="i">+                right_size: 2,
</a>                 predicate: None,
                 outer: false,
             },
<a href="#h74-1" id="h74-1" class="h">@@ -440,37 +441,15 @@ Optimized plan: Select {
</a>             },
             left_size: 7,
             right: KeyLookup {
<a href="#h74-1-3" id="h74-1-3" class="d">-                table: Table {
</a><a href="#h74-1-4" id="h74-1-4" class="d">-                    name: &quot;genres&quot;,
</a><a href="#h74-1-5" id="h74-1-5" class="d">-                    primary_key: 0,
</a><a href="#h74-1-6" id="h74-1-6" class="d">-                    columns: [
</a><a href="#h74-1-7" id="h74-1-7" class="d">-                        Column {
</a><a href="#h74-1-8" id="h74-1-8" class="d">-                            name: &quot;id&quot;,
</a><a href="#h74-1-9" id="h74-1-9" class="d">-                            datatype: Integer,
</a><a href="#h74-1-10" id="h74-1-10" class="d">-                            nullable: false,
</a><a href="#h74-1-11" id="h74-1-11" class="d">-                            default: None,
</a><a href="#h74-1-12" id="h74-1-12" class="d">-                            unique: true,
</a><a href="#h74-1-13" id="h74-1-13" class="d">-                            index: false,
</a><a href="#h74-1-14" id="h74-1-14" class="d">-                            references: None,
</a><a href="#h74-1-15" id="h74-1-15" class="d">-                        },
</a><a href="#h74-1-16" id="h74-1-16" class="d">-                        Column {
</a><a href="#h74-1-17" id="h74-1-17" class="d">-                            name: &quot;name&quot;,
</a><a href="#h74-1-18" id="h74-1-18" class="d">-                            datatype: String,
</a><a href="#h74-1-19" id="h74-1-19" class="d">-                            nullable: false,
</a><a href="#h74-1-20" id="h74-1-20" class="d">-                            default: None,
</a><a href="#h74-1-21" id="h74-1-21" class="d">-                            unique: false,
</a><a href="#h74-1-22" id="h74-1-22" class="d">-                            index: false,
</a><a href="#h74-1-23" id="h74-1-23" class="d">-                            references: None,
</a><a href="#h74-1-24" id="h74-1-24" class="d">-                        },
</a><a href="#h74-1-25" id="h74-1-25" class="d">-                    ],
</a><a href="#h74-1-26" id="h74-1-26" class="d">-                },
</a><a href="#h74-1-27" id="h74-1-27" class="d">-                alias: None,
</a><a href="#h74-1-28" id="h74-1-28" class="i">+                table: &quot;genres&quot;,
</a>                 keys: [
                     Integer(
                         1,
                     ),
                 ],
<a href="#h74-1-34" id="h74-1-34" class="i">+                alias: None,
</a>             },
<a href="#h74-1-36" id="h74-1-36" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<b>diff --git a/<a id="h75" href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a> b/<a href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -225,90 +225,14 @@ Plan: Select {
</a> Optimized plan: Select {
     root: Order {
         source: IndexLookup {
<a href="#h75-0-3" id="h75-0-3" class="d">-            table: Table {
</a><a href="#h75-0-4" id="h75-0-4" class="d">-                name: &quot;movies&quot;,
</a><a href="#h75-0-5" id="h75-0-5" class="d">-                primary_key: 0,
</a><a href="#h75-0-6" id="h75-0-6" class="d">-                columns: [
</a><a href="#h75-0-7" id="h75-0-7" class="d">-                    Column {
</a><a href="#h75-0-8" id="h75-0-8" class="d">-                        name: &quot;id&quot;,
</a><a href="#h75-0-9" id="h75-0-9" class="d">-                        datatype: Integer,
</a><a href="#h75-0-10" id="h75-0-10" class="d">-                        nullable: false,
</a><a href="#h75-0-11" id="h75-0-11" class="d">-                        default: None,
</a><a href="#h75-0-12" id="h75-0-12" class="d">-                        unique: true,
</a><a href="#h75-0-13" id="h75-0-13" class="d">-                        index: false,
</a><a href="#h75-0-14" id="h75-0-14" class="d">-                        references: None,
</a><a href="#h75-0-15" id="h75-0-15" class="d">-                    },
</a><a href="#h75-0-16" id="h75-0-16" class="d">-                    Column {
</a><a href="#h75-0-17" id="h75-0-17" class="d">-                        name: &quot;title&quot;,
</a><a href="#h75-0-18" id="h75-0-18" class="d">-                        datatype: String,
</a><a href="#h75-0-19" id="h75-0-19" class="d">-                        nullable: false,
</a><a href="#h75-0-20" id="h75-0-20" class="d">-                        default: None,
</a><a href="#h75-0-21" id="h75-0-21" class="d">-                        unique: false,
</a><a href="#h75-0-22" id="h75-0-22" class="d">-                        index: false,
</a><a href="#h75-0-23" id="h75-0-23" class="d">-                        references: None,
</a><a href="#h75-0-24" id="h75-0-24" class="d">-                    },
</a><a href="#h75-0-25" id="h75-0-25" class="d">-                    Column {
</a><a href="#h75-0-26" id="h75-0-26" class="d">-                        name: &quot;studio_id&quot;,
</a><a href="#h75-0-27" id="h75-0-27" class="d">-                        datatype: Integer,
</a><a href="#h75-0-28" id="h75-0-28" class="d">-                        nullable: false,
</a><a href="#h75-0-29" id="h75-0-29" class="d">-                        default: None,
</a><a href="#h75-0-30" id="h75-0-30" class="d">-                        unique: false,
</a><a href="#h75-0-31" id="h75-0-31" class="d">-                        index: true,
</a><a href="#h75-0-32" id="h75-0-32" class="d">-                        references: Some(
</a><a href="#h75-0-33" id="h75-0-33" class="d">-                            &quot;studios&quot;,
</a><a href="#h75-0-34" id="h75-0-34" class="d">-                        ),
</a><a href="#h75-0-35" id="h75-0-35" class="d">-                    },
</a><a href="#h75-0-36" id="h75-0-36" class="d">-                    Column {
</a><a href="#h75-0-37" id="h75-0-37" class="d">-                        name: &quot;genre_id&quot;,
</a><a href="#h75-0-38" id="h75-0-38" class="d">-                        datatype: Integer,
</a><a href="#h75-0-39" id="h75-0-39" class="d">-                        nullable: false,
</a><a href="#h75-0-40" id="h75-0-40" class="d">-                        default: None,
</a><a href="#h75-0-41" id="h75-0-41" class="d">-                        unique: false,
</a><a href="#h75-0-42" id="h75-0-42" class="d">-                        index: true,
</a><a href="#h75-0-43" id="h75-0-43" class="d">-                        references: Some(
</a><a href="#h75-0-44" id="h75-0-44" class="d">-                            &quot;genres&quot;,
</a><a href="#h75-0-45" id="h75-0-45" class="d">-                        ),
</a><a href="#h75-0-46" id="h75-0-46" class="d">-                    },
</a><a href="#h75-0-47" id="h75-0-47" class="d">-                    Column {
</a><a href="#h75-0-48" id="h75-0-48" class="d">-                        name: &quot;released&quot;,
</a><a href="#h75-0-49" id="h75-0-49" class="d">-                        datatype: Integer,
</a><a href="#h75-0-50" id="h75-0-50" class="d">-                        nullable: false,
</a><a href="#h75-0-51" id="h75-0-51" class="d">-                        default: None,
</a><a href="#h75-0-52" id="h75-0-52" class="d">-                        unique: false,
</a><a href="#h75-0-53" id="h75-0-53" class="d">-                        index: false,
</a><a href="#h75-0-54" id="h75-0-54" class="d">-                        references: None,
</a><a href="#h75-0-55" id="h75-0-55" class="d">-                    },
</a><a href="#h75-0-56" id="h75-0-56" class="d">-                    Column {
</a><a href="#h75-0-57" id="h75-0-57" class="d">-                        name: &quot;rating&quot;,
</a><a href="#h75-0-58" id="h75-0-58" class="d">-                        datatype: Float,
</a><a href="#h75-0-59" id="h75-0-59" class="d">-                        nullable: true,
</a><a href="#h75-0-60" id="h75-0-60" class="d">-                        default: Some(
</a><a href="#h75-0-61" id="h75-0-61" class="d">-                            Null,
</a><a href="#h75-0-62" id="h75-0-62" class="d">-                        ),
</a><a href="#h75-0-63" id="h75-0-63" class="d">-                        unique: false,
</a><a href="#h75-0-64" id="h75-0-64" class="d">-                        index: false,
</a><a href="#h75-0-65" id="h75-0-65" class="d">-                        references: None,
</a><a href="#h75-0-66" id="h75-0-66" class="d">-                    },
</a><a href="#h75-0-67" id="h75-0-67" class="d">-                    Column {
</a><a href="#h75-0-68" id="h75-0-68" class="d">-                        name: &quot;ultrahd&quot;,
</a><a href="#h75-0-69" id="h75-0-69" class="d">-                        datatype: Boolean,
</a><a href="#h75-0-70" id="h75-0-70" class="d">-                        nullable: true,
</a><a href="#h75-0-71" id="h75-0-71" class="d">-                        default: Some(
</a><a href="#h75-0-72" id="h75-0-72" class="d">-                            Null,
</a><a href="#h75-0-73" id="h75-0-73" class="d">-                        ),
</a><a href="#h75-0-74" id="h75-0-74" class="d">-                        unique: false,
</a><a href="#h75-0-75" id="h75-0-75" class="d">-                        index: false,
</a><a href="#h75-0-76" id="h75-0-76" class="d">-                        references: None,
</a><a href="#h75-0-77" id="h75-0-77" class="d">-                    },
</a><a href="#h75-0-78" id="h75-0-78" class="d">-                ],
</a><a href="#h75-0-79" id="h75-0-79" class="d">-            },
</a><a href="#h75-0-80" id="h75-0-80" class="d">-            alias: None,
</a><a href="#h75-0-81" id="h75-0-81" class="i">+            table: &quot;movies&quot;,
</a>             column: &quot;genre_id&quot;,
             values: [
                 Integer(
                     2,
                 ),
             ],
<a href="#h75-0-88" id="h75-0-88" class="i">+            alias: None,
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h76" href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a> b/<a href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -332,84 +332,7 @@ Plan: Select {
</a> Optimized plan: Select {
     root: Order {
         source: IndexLookup {
<a href="#h76-0-3" id="h76-0-3" class="d">-            table: Table {
</a><a href="#h76-0-4" id="h76-0-4" class="d">-                name: &quot;movies&quot;,
</a><a href="#h76-0-5" id="h76-0-5" class="d">-                primary_key: 0,
</a><a href="#h76-0-6" id="h76-0-6" class="d">-                columns: [
</a><a href="#h76-0-7" id="h76-0-7" class="d">-                    Column {
</a><a href="#h76-0-8" id="h76-0-8" class="d">-                        name: &quot;id&quot;,
</a><a href="#h76-0-9" id="h76-0-9" class="d">-                        datatype: Integer,
</a><a href="#h76-0-10" id="h76-0-10" class="d">-                        nullable: false,
</a><a href="#h76-0-11" id="h76-0-11" class="d">-                        default: None,
</a><a href="#h76-0-12" id="h76-0-12" class="d">-                        unique: true,
</a><a href="#h76-0-13" id="h76-0-13" class="d">-                        index: false,
</a><a href="#h76-0-14" id="h76-0-14" class="d">-                        references: None,
</a><a href="#h76-0-15" id="h76-0-15" class="d">-                    },
</a><a href="#h76-0-16" id="h76-0-16" class="d">-                    Column {
</a><a href="#h76-0-17" id="h76-0-17" class="d">-                        name: &quot;title&quot;,
</a><a href="#h76-0-18" id="h76-0-18" class="d">-                        datatype: String,
</a><a href="#h76-0-19" id="h76-0-19" class="d">-                        nullable: false,
</a><a href="#h76-0-20" id="h76-0-20" class="d">-                        default: None,
</a><a href="#h76-0-21" id="h76-0-21" class="d">-                        unique: false,
</a><a href="#h76-0-22" id="h76-0-22" class="d">-                        index: false,
</a><a href="#h76-0-23" id="h76-0-23" class="d">-                        references: None,
</a><a href="#h76-0-24" id="h76-0-24" class="d">-                    },
</a><a href="#h76-0-25" id="h76-0-25" class="d">-                    Column {
</a><a href="#h76-0-26" id="h76-0-26" class="d">-                        name: &quot;studio_id&quot;,
</a><a href="#h76-0-27" id="h76-0-27" class="d">-                        datatype: Integer,
</a><a href="#h76-0-28" id="h76-0-28" class="d">-                        nullable: false,
</a><a href="#h76-0-29" id="h76-0-29" class="d">-                        default: None,
</a><a href="#h76-0-30" id="h76-0-30" class="d">-                        unique: false,
</a><a href="#h76-0-31" id="h76-0-31" class="d">-                        index: true,
</a><a href="#h76-0-32" id="h76-0-32" class="d">-                        references: Some(
</a><a href="#h76-0-33" id="h76-0-33" class="d">-                            &quot;studios&quot;,
</a><a href="#h76-0-34" id="h76-0-34" class="d">-                        ),
</a><a href="#h76-0-35" id="h76-0-35" class="d">-                    },
</a><a href="#h76-0-36" id="h76-0-36" class="d">-                    Column {
</a><a href="#h76-0-37" id="h76-0-37" class="d">-                        name: &quot;genre_id&quot;,
</a><a href="#h76-0-38" id="h76-0-38" class="d">-                        datatype: Integer,
</a><a href="#h76-0-39" id="h76-0-39" class="d">-                        nullable: false,
</a><a href="#h76-0-40" id="h76-0-40" class="d">-                        default: None,
</a><a href="#h76-0-41" id="h76-0-41" class="d">-                        unique: false,
</a><a href="#h76-0-42" id="h76-0-42" class="d">-                        index: true,
</a><a href="#h76-0-43" id="h76-0-43" class="d">-                        references: Some(
</a><a href="#h76-0-44" id="h76-0-44" class="d">-                            &quot;genres&quot;,
</a><a href="#h76-0-45" id="h76-0-45" class="d">-                        ),
</a><a href="#h76-0-46" id="h76-0-46" class="d">-                    },
</a><a href="#h76-0-47" id="h76-0-47" class="d">-                    Column {
</a><a href="#h76-0-48" id="h76-0-48" class="d">-                        name: &quot;released&quot;,
</a><a href="#h76-0-49" id="h76-0-49" class="d">-                        datatype: Integer,
</a><a href="#h76-0-50" id="h76-0-50" class="d">-                        nullable: false,
</a><a href="#h76-0-51" id="h76-0-51" class="d">-                        default: None,
</a><a href="#h76-0-52" id="h76-0-52" class="d">-                        unique: false,
</a><a href="#h76-0-53" id="h76-0-53" class="d">-                        index: false,
</a><a href="#h76-0-54" id="h76-0-54" class="d">-                        references: None,
</a><a href="#h76-0-55" id="h76-0-55" class="d">-                    },
</a><a href="#h76-0-56" id="h76-0-56" class="d">-                    Column {
</a><a href="#h76-0-57" id="h76-0-57" class="d">-                        name: &quot;rating&quot;,
</a><a href="#h76-0-58" id="h76-0-58" class="d">-                        datatype: Float,
</a><a href="#h76-0-59" id="h76-0-59" class="d">-                        nullable: true,
</a><a href="#h76-0-60" id="h76-0-60" class="d">-                        default: Some(
</a><a href="#h76-0-61" id="h76-0-61" class="d">-                            Null,
</a><a href="#h76-0-62" id="h76-0-62" class="d">-                        ),
</a><a href="#h76-0-63" id="h76-0-63" class="d">-                        unique: false,
</a><a href="#h76-0-64" id="h76-0-64" class="d">-                        index: false,
</a><a href="#h76-0-65" id="h76-0-65" class="d">-                        references: None,
</a><a href="#h76-0-66" id="h76-0-66" class="d">-                    },
</a><a href="#h76-0-67" id="h76-0-67" class="d">-                    Column {
</a><a href="#h76-0-68" id="h76-0-68" class="d">-                        name: &quot;ultrahd&quot;,
</a><a href="#h76-0-69" id="h76-0-69" class="d">-                        datatype: Boolean,
</a><a href="#h76-0-70" id="h76-0-70" class="d">-                        nullable: true,
</a><a href="#h76-0-71" id="h76-0-71" class="d">-                        default: Some(
</a><a href="#h76-0-72" id="h76-0-72" class="d">-                            Null,
</a><a href="#h76-0-73" id="h76-0-73" class="d">-                        ),
</a><a href="#h76-0-74" id="h76-0-74" class="d">-                        unique: false,
</a><a href="#h76-0-75" id="h76-0-75" class="d">-                        index: false,
</a><a href="#h76-0-76" id="h76-0-76" class="d">-                        references: None,
</a><a href="#h76-0-77" id="h76-0-77" class="d">-                    },
</a><a href="#h76-0-78" id="h76-0-78" class="d">-                ],
</a><a href="#h76-0-79" id="h76-0-79" class="d">-            },
</a><a href="#h76-0-80" id="h76-0-80" class="d">-            alias: None,
</a><a href="#h76-0-81" id="h76-0-81" class="i">+            table: &quot;movies&quot;,
</a>             column: &quot;genre_id&quot;,
             values: [
                 Integer(
<a href="#h76-1" id="h76-1" class="h">@@ -425,6 +348,7 @@ Optimized plan: Select {
</a>                     5,
                 ),
             ],
<a href="#h76-1-3" id="h76-1-3" class="i">+            alias: None,
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h77" href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a> b/<a href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -297,84 +297,7 @@ Optimized plan: Select {
</a>     root: Order {
         source: Filter {
             source: IndexLookup {
<a href="#h77-0-3" id="h77-0-3" class="d">-                table: Table {
</a><a href="#h77-0-4" id="h77-0-4" class="d">-                    name: &quot;movies&quot;,
</a><a href="#h77-0-5" id="h77-0-5" class="d">-                    primary_key: 0,
</a><a href="#h77-0-6" id="h77-0-6" class="d">-                    columns: [
</a><a href="#h77-0-7" id="h77-0-7" class="d">-                        Column {
</a><a href="#h77-0-8" id="h77-0-8" class="d">-                            name: &quot;id&quot;,
</a><a href="#h77-0-9" id="h77-0-9" class="d">-                            datatype: Integer,
</a><a href="#h77-0-10" id="h77-0-10" class="d">-                            nullable: false,
</a><a href="#h77-0-11" id="h77-0-11" class="d">-                            default: None,
</a><a href="#h77-0-12" id="h77-0-12" class="d">-                            unique: true,
</a><a href="#h77-0-13" id="h77-0-13" class="d">-                            index: false,
</a><a href="#h77-0-14" id="h77-0-14" class="d">-                            references: None,
</a><a href="#h77-0-15" id="h77-0-15" class="d">-                        },
</a><a href="#h77-0-16" id="h77-0-16" class="d">-                        Column {
</a><a href="#h77-0-17" id="h77-0-17" class="d">-                            name: &quot;title&quot;,
</a><a href="#h77-0-18" id="h77-0-18" class="d">-                            datatype: String,
</a><a href="#h77-0-19" id="h77-0-19" class="d">-                            nullable: false,
</a><a href="#h77-0-20" id="h77-0-20" class="d">-                            default: None,
</a><a href="#h77-0-21" id="h77-0-21" class="d">-                            unique: false,
</a><a href="#h77-0-22" id="h77-0-22" class="d">-                            index: false,
</a><a href="#h77-0-23" id="h77-0-23" class="d">-                            references: None,
</a><a href="#h77-0-24" id="h77-0-24" class="d">-                        },
</a><a href="#h77-0-25" id="h77-0-25" class="d">-                        Column {
</a><a href="#h77-0-26" id="h77-0-26" class="d">-                            name: &quot;studio_id&quot;,
</a><a href="#h77-0-27" id="h77-0-27" class="d">-                            datatype: Integer,
</a><a href="#h77-0-28" id="h77-0-28" class="d">-                            nullable: false,
</a><a href="#h77-0-29" id="h77-0-29" class="d">-                            default: None,
</a><a href="#h77-0-30" id="h77-0-30" class="d">-                            unique: false,
</a><a href="#h77-0-31" id="h77-0-31" class="d">-                            index: true,
</a><a href="#h77-0-32" id="h77-0-32" class="d">-                            references: Some(
</a><a href="#h77-0-33" id="h77-0-33" class="d">-                                &quot;studios&quot;,
</a><a href="#h77-0-34" id="h77-0-34" class="d">-                            ),
</a><a href="#h77-0-35" id="h77-0-35" class="d">-                        },
</a><a href="#h77-0-36" id="h77-0-36" class="d">-                        Column {
</a><a href="#h77-0-37" id="h77-0-37" class="d">-                            name: &quot;genre_id&quot;,
</a><a href="#h77-0-38" id="h77-0-38" class="d">-                            datatype: Integer,
</a><a href="#h77-0-39" id="h77-0-39" class="d">-                            nullable: false,
</a><a href="#h77-0-40" id="h77-0-40" class="d">-                            default: None,
</a><a href="#h77-0-41" id="h77-0-41" class="d">-                            unique: false,
</a><a href="#h77-0-42" id="h77-0-42" class="d">-                            index: true,
</a><a href="#h77-0-43" id="h77-0-43" class="d">-                            references: Some(
</a><a href="#h77-0-44" id="h77-0-44" class="d">-                                &quot;genres&quot;,
</a><a href="#h77-0-45" id="h77-0-45" class="d">-                            ),
</a><a href="#h77-0-46" id="h77-0-46" class="d">-                        },
</a><a href="#h77-0-47" id="h77-0-47" class="d">-                        Column {
</a><a href="#h77-0-48" id="h77-0-48" class="d">-                            name: &quot;released&quot;,
</a><a href="#h77-0-49" id="h77-0-49" class="d">-                            datatype: Integer,
</a><a href="#h77-0-50" id="h77-0-50" class="d">-                            nullable: false,
</a><a href="#h77-0-51" id="h77-0-51" class="d">-                            default: None,
</a><a href="#h77-0-52" id="h77-0-52" class="d">-                            unique: false,
</a><a href="#h77-0-53" id="h77-0-53" class="d">-                            index: false,
</a><a href="#h77-0-54" id="h77-0-54" class="d">-                            references: None,
</a><a href="#h77-0-55" id="h77-0-55" class="d">-                        },
</a><a href="#h77-0-56" id="h77-0-56" class="d">-                        Column {
</a><a href="#h77-0-57" id="h77-0-57" class="d">-                            name: &quot;rating&quot;,
</a><a href="#h77-0-58" id="h77-0-58" class="d">-                            datatype: Float,
</a><a href="#h77-0-59" id="h77-0-59" class="d">-                            nullable: true,
</a><a href="#h77-0-60" id="h77-0-60" class="d">-                            default: Some(
</a><a href="#h77-0-61" id="h77-0-61" class="d">-                                Null,
</a><a href="#h77-0-62" id="h77-0-62" class="d">-                            ),
</a><a href="#h77-0-63" id="h77-0-63" class="d">-                            unique: false,
</a><a href="#h77-0-64" id="h77-0-64" class="d">-                            index: false,
</a><a href="#h77-0-65" id="h77-0-65" class="d">-                            references: None,
</a><a href="#h77-0-66" id="h77-0-66" class="d">-                        },
</a><a href="#h77-0-67" id="h77-0-67" class="d">-                        Column {
</a><a href="#h77-0-68" id="h77-0-68" class="d">-                            name: &quot;ultrahd&quot;,
</a><a href="#h77-0-69" id="h77-0-69" class="d">-                            datatype: Boolean,
</a><a href="#h77-0-70" id="h77-0-70" class="d">-                            nullable: true,
</a><a href="#h77-0-71" id="h77-0-71" class="d">-                            default: Some(
</a><a href="#h77-0-72" id="h77-0-72" class="d">-                                Null,
</a><a href="#h77-0-73" id="h77-0-73" class="d">-                            ),
</a><a href="#h77-0-74" id="h77-0-74" class="d">-                            unique: false,
</a><a href="#h77-0-75" id="h77-0-75" class="d">-                            index: false,
</a><a href="#h77-0-76" id="h77-0-76" class="d">-                            references: None,
</a><a href="#h77-0-77" id="h77-0-77" class="d">-                        },
</a><a href="#h77-0-78" id="h77-0-78" class="d">-                    ],
</a><a href="#h77-0-79" id="h77-0-79" class="d">-                },
</a><a href="#h77-0-80" id="h77-0-80" class="d">-                alias: None,
</a><a href="#h77-0-81" id="h77-0-81" class="i">+                table: &quot;movies&quot;,
</a>                 column: &quot;genre_id&quot;,
                 values: [
                     Integer(
<a href="#h77-1" id="h77-1" class="h">@@ -384,6 +307,7 @@ Optimized plan: Select {
</a>                         3,
                     ),
                 ],
<a href="#h77-1-3" id="h77-1-3" class="i">+                alias: None,
</a>             },
             predicate: Equal(
                 Field(
<b>diff --git a/<a id="h78" href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a> b/<a href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -167,6 +167,7 @@ Plan: Select {
</a>                 filter: None,
                 alias: None,
             },
<a href="#h78-0-3" id="h78-0-3" class="i">+            right_size: 2,
</a>             predicate: None,
             outer: false,
         },
<a href="#h78-1" id="h78-1" class="h">@@ -354,15 +355,13 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h78-1-3" id="h78-1-3" class="d">-        left_field: (
</a><a href="#h78-1-4" id="h78-1-4" class="d">-            3,
</a><a href="#h78-1-5" id="h78-1-5" class="d">-            Some(
</a><a href="#h78-1-6" id="h78-1-6" class="d">-                (
</a><a href="#h78-1-7" id="h78-1-7" class="d">-                    Some(
</a><a href="#h78-1-8" id="h78-1-8" class="d">-                        &quot;movies&quot;,
</a><a href="#h78-1-9" id="h78-1-9" class="d">-                    ),
</a><a href="#h78-1-10" id="h78-1-10" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h78-1-11" id="h78-1-11" class="i">+        left_field: 3,
</a><a href="#h78-1-12" id="h78-1-12" class="i">+        left_label: Some(
</a><a href="#h78-1-13" id="h78-1-13" class="i">+            (
</a><a href="#h78-1-14" id="h78-1-14" class="i">+                Some(
</a><a href="#h78-1-15" id="h78-1-15" class="i">+                    &quot;movies&quot;,
</a>                 ),
<a href="#h78-1-17" id="h78-1-17" class="i">+                &quot;genre_id&quot;,
</a>             ),
         ),
         right: Scan {
<a href="#h78-2" id="h78-2" class="h">@@ -393,17 +392,16 @@ Optimized plan: Select {
</a>             filter: None,
             alias: None,
         },
<a href="#h78-2-3" id="h78-2-3" class="d">-        right_field: (
</a><a href="#h78-2-4" id="h78-2-4" class="d">-            0,
</a><a href="#h78-2-5" id="h78-2-5" class="d">-            Some(
</a><a href="#h78-2-6" id="h78-2-6" class="d">-                (
</a><a href="#h78-2-7" id="h78-2-7" class="d">-                    Some(
</a><a href="#h78-2-8" id="h78-2-8" class="d">-                        &quot;genres&quot;,
</a><a href="#h78-2-9" id="h78-2-9" class="d">-                    ),
</a><a href="#h78-2-10" id="h78-2-10" class="d">-                    &quot;id&quot;,
</a><a href="#h78-2-11" id="h78-2-11" class="i">+        right_field: 0,
</a><a href="#h78-2-12" id="h78-2-12" class="i">+        right_label: Some(
</a><a href="#h78-2-13" id="h78-2-13" class="i">+            (
</a><a href="#h78-2-14" id="h78-2-14" class="i">+                Some(
</a><a href="#h78-2-15" id="h78-2-15" class="i">+                    &quot;genres&quot;,
</a>                 ),
<a href="#h78-2-17" id="h78-2-17" class="i">+                &quot;id&quot;,
</a>             ),
         ),
<a href="#h78-2-20" id="h78-2-20" class="i">+        right_size: 2,
</a>         outer: false,
     },
     labels: [
<b>diff --git a/<a id="h79" href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a> b/<a href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -198,89 +198,13 @@ Plan: Select {
</a> 
 Optimized plan: Select {
     root: KeyLookup {
<a href="#h79-0-3" id="h79-0-3" class="d">-        table: Table {
</a><a href="#h79-0-4" id="h79-0-4" class="d">-            name: &quot;movies&quot;,
</a><a href="#h79-0-5" id="h79-0-5" class="d">-            primary_key: 0,
</a><a href="#h79-0-6" id="h79-0-6" class="d">-            columns: [
</a><a href="#h79-0-7" id="h79-0-7" class="d">-                Column {
</a><a href="#h79-0-8" id="h79-0-8" class="d">-                    name: &quot;id&quot;,
</a><a href="#h79-0-9" id="h79-0-9" class="d">-                    datatype: Integer,
</a><a href="#h79-0-10" id="h79-0-10" class="d">-                    nullable: false,
</a><a href="#h79-0-11" id="h79-0-11" class="d">-                    default: None,
</a><a href="#h79-0-12" id="h79-0-12" class="d">-                    unique: true,
</a><a href="#h79-0-13" id="h79-0-13" class="d">-                    index: false,
</a><a href="#h79-0-14" id="h79-0-14" class="d">-                    references: None,
</a><a href="#h79-0-15" id="h79-0-15" class="d">-                },
</a><a href="#h79-0-16" id="h79-0-16" class="d">-                Column {
</a><a href="#h79-0-17" id="h79-0-17" class="d">-                    name: &quot;title&quot;,
</a><a href="#h79-0-18" id="h79-0-18" class="d">-                    datatype: String,
</a><a href="#h79-0-19" id="h79-0-19" class="d">-                    nullable: false,
</a><a href="#h79-0-20" id="h79-0-20" class="d">-                    default: None,
</a><a href="#h79-0-21" id="h79-0-21" class="d">-                    unique: false,
</a><a href="#h79-0-22" id="h79-0-22" class="d">-                    index: false,
</a><a href="#h79-0-23" id="h79-0-23" class="d">-                    references: None,
</a><a href="#h79-0-24" id="h79-0-24" class="d">-                },
</a><a href="#h79-0-25" id="h79-0-25" class="d">-                Column {
</a><a href="#h79-0-26" id="h79-0-26" class="d">-                    name: &quot;studio_id&quot;,
</a><a href="#h79-0-27" id="h79-0-27" class="d">-                    datatype: Integer,
</a><a href="#h79-0-28" id="h79-0-28" class="d">-                    nullable: false,
</a><a href="#h79-0-29" id="h79-0-29" class="d">-                    default: None,
</a><a href="#h79-0-30" id="h79-0-30" class="d">-                    unique: false,
</a><a href="#h79-0-31" id="h79-0-31" class="d">-                    index: true,
</a><a href="#h79-0-32" id="h79-0-32" class="d">-                    references: Some(
</a><a href="#h79-0-33" id="h79-0-33" class="d">-                        &quot;studios&quot;,
</a><a href="#h79-0-34" id="h79-0-34" class="d">-                    ),
</a><a href="#h79-0-35" id="h79-0-35" class="d">-                },
</a><a href="#h79-0-36" id="h79-0-36" class="d">-                Column {
</a><a href="#h79-0-37" id="h79-0-37" class="d">-                    name: &quot;genre_id&quot;,
</a><a href="#h79-0-38" id="h79-0-38" class="d">-                    datatype: Integer,
</a><a href="#h79-0-39" id="h79-0-39" class="d">-                    nullable: false,
</a><a href="#h79-0-40" id="h79-0-40" class="d">-                    default: None,
</a><a href="#h79-0-41" id="h79-0-41" class="d">-                    unique: false,
</a><a href="#h79-0-42" id="h79-0-42" class="d">-                    index: true,
</a><a href="#h79-0-43" id="h79-0-43" class="d">-                    references: Some(
</a><a href="#h79-0-44" id="h79-0-44" class="d">-                        &quot;genres&quot;,
</a><a href="#h79-0-45" id="h79-0-45" class="d">-                    ),
</a><a href="#h79-0-46" id="h79-0-46" class="d">-                },
</a><a href="#h79-0-47" id="h79-0-47" class="d">-                Column {
</a><a href="#h79-0-48" id="h79-0-48" class="d">-                    name: &quot;released&quot;,
</a><a href="#h79-0-49" id="h79-0-49" class="d">-                    datatype: Integer,
</a><a href="#h79-0-50" id="h79-0-50" class="d">-                    nullable: false,
</a><a href="#h79-0-51" id="h79-0-51" class="d">-                    default: None,
</a><a href="#h79-0-52" id="h79-0-52" class="d">-                    unique: false,
</a><a href="#h79-0-53" id="h79-0-53" class="d">-                    index: false,
</a><a href="#h79-0-54" id="h79-0-54" class="d">-                    references: None,
</a><a href="#h79-0-55" id="h79-0-55" class="d">-                },
</a><a href="#h79-0-56" id="h79-0-56" class="d">-                Column {
</a><a href="#h79-0-57" id="h79-0-57" class="d">-                    name: &quot;rating&quot;,
</a><a href="#h79-0-58" id="h79-0-58" class="d">-                    datatype: Float,
</a><a href="#h79-0-59" id="h79-0-59" class="d">-                    nullable: true,
</a><a href="#h79-0-60" id="h79-0-60" class="d">-                    default: Some(
</a><a href="#h79-0-61" id="h79-0-61" class="d">-                        Null,
</a><a href="#h79-0-62" id="h79-0-62" class="d">-                    ),
</a><a href="#h79-0-63" id="h79-0-63" class="d">-                    unique: false,
</a><a href="#h79-0-64" id="h79-0-64" class="d">-                    index: false,
</a><a href="#h79-0-65" id="h79-0-65" class="d">-                    references: None,
</a><a href="#h79-0-66" id="h79-0-66" class="d">-                },
</a><a href="#h79-0-67" id="h79-0-67" class="d">-                Column {
</a><a href="#h79-0-68" id="h79-0-68" class="d">-                    name: &quot;ultrahd&quot;,
</a><a href="#h79-0-69" id="h79-0-69" class="d">-                    datatype: Boolean,
</a><a href="#h79-0-70" id="h79-0-70" class="d">-                    nullable: true,
</a><a href="#h79-0-71" id="h79-0-71" class="d">-                    default: Some(
</a><a href="#h79-0-72" id="h79-0-72" class="d">-                        Null,
</a><a href="#h79-0-73" id="h79-0-73" class="d">-                    ),
</a><a href="#h79-0-74" id="h79-0-74" class="d">-                    unique: false,
</a><a href="#h79-0-75" id="h79-0-75" class="d">-                    index: false,
</a><a href="#h79-0-76" id="h79-0-76" class="d">-                    references: None,
</a><a href="#h79-0-77" id="h79-0-77" class="d">-                },
</a><a href="#h79-0-78" id="h79-0-78" class="d">-            ],
</a><a href="#h79-0-79" id="h79-0-79" class="d">-        },
</a><a href="#h79-0-80" id="h79-0-80" class="d">-        alias: None,
</a><a href="#h79-0-81" id="h79-0-81" class="i">+        table: &quot;movies&quot;,
</a>         keys: [
             Integer(
                 3,
             ),
         ],
<a href="#h79-0-87" id="h79-0-87" class="i">+        alias: None,
</a>     },
     labels: [
         Some(
<b>diff --git a/<a id="h80" href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a> b/<a href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -270,84 +270,7 @@ Plan: Select {
</a> 
 Optimized plan: Select {
     root: KeyLookup {
<a href="#h80-0-3" id="h80-0-3" class="d">-        table: Table {
</a><a href="#h80-0-4" id="h80-0-4" class="d">-            name: &quot;movies&quot;,
</a><a href="#h80-0-5" id="h80-0-5" class="d">-            primary_key: 0,
</a><a href="#h80-0-6" id="h80-0-6" class="d">-            columns: [
</a><a href="#h80-0-7" id="h80-0-7" class="d">-                Column {
</a><a href="#h80-0-8" id="h80-0-8" class="d">-                    name: &quot;id&quot;,
</a><a href="#h80-0-9" id="h80-0-9" class="d">-                    datatype: Integer,
</a><a href="#h80-0-10" id="h80-0-10" class="d">-                    nullable: false,
</a><a href="#h80-0-11" id="h80-0-11" class="d">-                    default: None,
</a><a href="#h80-0-12" id="h80-0-12" class="d">-                    unique: true,
</a><a href="#h80-0-13" id="h80-0-13" class="d">-                    index: false,
</a><a href="#h80-0-14" id="h80-0-14" class="d">-                    references: None,
</a><a href="#h80-0-15" id="h80-0-15" class="d">-                },
</a><a href="#h80-0-16" id="h80-0-16" class="d">-                Column {
</a><a href="#h80-0-17" id="h80-0-17" class="d">-                    name: &quot;title&quot;,
</a><a href="#h80-0-18" id="h80-0-18" class="d">-                    datatype: String,
</a><a href="#h80-0-19" id="h80-0-19" class="d">-                    nullable: false,
</a><a href="#h80-0-20" id="h80-0-20" class="d">-                    default: None,
</a><a href="#h80-0-21" id="h80-0-21" class="d">-                    unique: false,
</a><a href="#h80-0-22" id="h80-0-22" class="d">-                    index: false,
</a><a href="#h80-0-23" id="h80-0-23" class="d">-                    references: None,
</a><a href="#h80-0-24" id="h80-0-24" class="d">-                },
</a><a href="#h80-0-25" id="h80-0-25" class="d">-                Column {
</a><a href="#h80-0-26" id="h80-0-26" class="d">-                    name: &quot;studio_id&quot;,
</a><a href="#h80-0-27" id="h80-0-27" class="d">-                    datatype: Integer,
</a><a href="#h80-0-28" id="h80-0-28" class="d">-                    nullable: false,
</a><a href="#h80-0-29" id="h80-0-29" class="d">-                    default: None,
</a><a href="#h80-0-30" id="h80-0-30" class="d">-                    unique: false,
</a><a href="#h80-0-31" id="h80-0-31" class="d">-                    index: true,
</a><a href="#h80-0-32" id="h80-0-32" class="d">-                    references: Some(
</a><a href="#h80-0-33" id="h80-0-33" class="d">-                        &quot;studios&quot;,
</a><a href="#h80-0-34" id="h80-0-34" class="d">-                    ),
</a><a href="#h80-0-35" id="h80-0-35" class="d">-                },
</a><a href="#h80-0-36" id="h80-0-36" class="d">-                Column {
</a><a href="#h80-0-37" id="h80-0-37" class="d">-                    name: &quot;genre_id&quot;,
</a><a href="#h80-0-38" id="h80-0-38" class="d">-                    datatype: Integer,
</a><a href="#h80-0-39" id="h80-0-39" class="d">-                    nullable: false,
</a><a href="#h80-0-40" id="h80-0-40" class="d">-                    default: None,
</a><a href="#h80-0-41" id="h80-0-41" class="d">-                    unique: false,
</a><a href="#h80-0-42" id="h80-0-42" class="d">-                    index: true,
</a><a href="#h80-0-43" id="h80-0-43" class="d">-                    references: Some(
</a><a href="#h80-0-44" id="h80-0-44" class="d">-                        &quot;genres&quot;,
</a><a href="#h80-0-45" id="h80-0-45" class="d">-                    ),
</a><a href="#h80-0-46" id="h80-0-46" class="d">-                },
</a><a href="#h80-0-47" id="h80-0-47" class="d">-                Column {
</a><a href="#h80-0-48" id="h80-0-48" class="d">-                    name: &quot;released&quot;,
</a><a href="#h80-0-49" id="h80-0-49" class="d">-                    datatype: Integer,
</a><a href="#h80-0-50" id="h80-0-50" class="d">-                    nullable: false,
</a><a href="#h80-0-51" id="h80-0-51" class="d">-                    default: None,
</a><a href="#h80-0-52" id="h80-0-52" class="d">-                    unique: false,
</a><a href="#h80-0-53" id="h80-0-53" class="d">-                    index: false,
</a><a href="#h80-0-54" id="h80-0-54" class="d">-                    references: None,
</a><a href="#h80-0-55" id="h80-0-55" class="d">-                },
</a><a href="#h80-0-56" id="h80-0-56" class="d">-                Column {
</a><a href="#h80-0-57" id="h80-0-57" class="d">-                    name: &quot;rating&quot;,
</a><a href="#h80-0-58" id="h80-0-58" class="d">-                    datatype: Float,
</a><a href="#h80-0-59" id="h80-0-59" class="d">-                    nullable: true,
</a><a href="#h80-0-60" id="h80-0-60" class="d">-                    default: Some(
</a><a href="#h80-0-61" id="h80-0-61" class="d">-                        Null,
</a><a href="#h80-0-62" id="h80-0-62" class="d">-                    ),
</a><a href="#h80-0-63" id="h80-0-63" class="d">-                    unique: false,
</a><a href="#h80-0-64" id="h80-0-64" class="d">-                    index: false,
</a><a href="#h80-0-65" id="h80-0-65" class="d">-                    references: None,
</a><a href="#h80-0-66" id="h80-0-66" class="d">-                },
</a><a href="#h80-0-67" id="h80-0-67" class="d">-                Column {
</a><a href="#h80-0-68" id="h80-0-68" class="d">-                    name: &quot;ultrahd&quot;,
</a><a href="#h80-0-69" id="h80-0-69" class="d">-                    datatype: Boolean,
</a><a href="#h80-0-70" id="h80-0-70" class="d">-                    nullable: true,
</a><a href="#h80-0-71" id="h80-0-71" class="d">-                    default: Some(
</a><a href="#h80-0-72" id="h80-0-72" class="d">-                        Null,
</a><a href="#h80-0-73" id="h80-0-73" class="d">-                    ),
</a><a href="#h80-0-74" id="h80-0-74" class="d">-                    unique: false,
</a><a href="#h80-0-75" id="h80-0-75" class="d">-                    index: false,
</a><a href="#h80-0-76" id="h80-0-76" class="d">-                    references: None,
</a><a href="#h80-0-77" id="h80-0-77" class="d">-                },
</a><a href="#h80-0-78" id="h80-0-78" class="d">-            ],
</a><a href="#h80-0-79" id="h80-0-79" class="d">-        },
</a><a href="#h80-0-80" id="h80-0-80" class="d">-        alias: None,
</a><a href="#h80-0-81" id="h80-0-81" class="i">+        table: &quot;movies&quot;,
</a>         keys: [
             Integer(
                 3,
<a href="#h80-1" id="h80-1" class="h">@@ -359,6 +282,7 @@ Optimized plan: Select {
</a>                 7,
             ),
         ],
<a href="#h80-1-3" id="h80-1-3" class="i">+        alias: None,
</a>     },
     labels: [
         Some(
<b>diff --git a/<a id="h81" href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a> b/<a href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -341,84 +341,7 @@ Plan: Select {
</a> Optimized plan: Select {
     root: Filter {
         source: KeyLookup {
<a href="#h81-0-3" id="h81-0-3" class="d">-            table: Table {
</a><a href="#h81-0-4" id="h81-0-4" class="d">-                name: &quot;movies&quot;,
</a><a href="#h81-0-5" id="h81-0-5" class="d">-                primary_key: 0,
</a><a href="#h81-0-6" id="h81-0-6" class="d">-                columns: [
</a><a href="#h81-0-7" id="h81-0-7" class="d">-                    Column {
</a><a href="#h81-0-8" id="h81-0-8" class="d">-                        name: &quot;id&quot;,
</a><a href="#h81-0-9" id="h81-0-9" class="d">-                        datatype: Integer,
</a><a href="#h81-0-10" id="h81-0-10" class="d">-                        nullable: false,
</a><a href="#h81-0-11" id="h81-0-11" class="d">-                        default: None,
</a><a href="#h81-0-12" id="h81-0-12" class="d">-                        unique: true,
</a><a href="#h81-0-13" id="h81-0-13" class="d">-                        index: false,
</a><a href="#h81-0-14" id="h81-0-14" class="d">-                        references: None,
</a><a href="#h81-0-15" id="h81-0-15" class="d">-                    },
</a><a href="#h81-0-16" id="h81-0-16" class="d">-                    Column {
</a><a href="#h81-0-17" id="h81-0-17" class="d">-                        name: &quot;title&quot;,
</a><a href="#h81-0-18" id="h81-0-18" class="d">-                        datatype: String,
</a><a href="#h81-0-19" id="h81-0-19" class="d">-                        nullable: false,
</a><a href="#h81-0-20" id="h81-0-20" class="d">-                        default: None,
</a><a href="#h81-0-21" id="h81-0-21" class="d">-                        unique: false,
</a><a href="#h81-0-22" id="h81-0-22" class="d">-                        index: false,
</a><a href="#h81-0-23" id="h81-0-23" class="d">-                        references: None,
</a><a href="#h81-0-24" id="h81-0-24" class="d">-                    },
</a><a href="#h81-0-25" id="h81-0-25" class="d">-                    Column {
</a><a href="#h81-0-26" id="h81-0-26" class="d">-                        name: &quot;studio_id&quot;,
</a><a href="#h81-0-27" id="h81-0-27" class="d">-                        datatype: Integer,
</a><a href="#h81-0-28" id="h81-0-28" class="d">-                        nullable: false,
</a><a href="#h81-0-29" id="h81-0-29" class="d">-                        default: None,
</a><a href="#h81-0-30" id="h81-0-30" class="d">-                        unique: false,
</a><a href="#h81-0-31" id="h81-0-31" class="d">-                        index: true,
</a><a href="#h81-0-32" id="h81-0-32" class="d">-                        references: Some(
</a><a href="#h81-0-33" id="h81-0-33" class="d">-                            &quot;studios&quot;,
</a><a href="#h81-0-34" id="h81-0-34" class="d">-                        ),
</a><a href="#h81-0-35" id="h81-0-35" class="d">-                    },
</a><a href="#h81-0-36" id="h81-0-36" class="d">-                    Column {
</a><a href="#h81-0-37" id="h81-0-37" class="d">-                        name: &quot;genre_id&quot;,
</a><a href="#h81-0-38" id="h81-0-38" class="d">-                        datatype: Integer,
</a><a href="#h81-0-39" id="h81-0-39" class="d">-                        nullable: false,
</a><a href="#h81-0-40" id="h81-0-40" class="d">-                        default: None,
</a><a href="#h81-0-41" id="h81-0-41" class="d">-                        unique: false,
</a><a href="#h81-0-42" id="h81-0-42" class="d">-                        index: true,
</a><a href="#h81-0-43" id="h81-0-43" class="d">-                        references: Some(
</a><a href="#h81-0-44" id="h81-0-44" class="d">-                            &quot;genres&quot;,
</a><a href="#h81-0-45" id="h81-0-45" class="d">-                        ),
</a><a href="#h81-0-46" id="h81-0-46" class="d">-                    },
</a><a href="#h81-0-47" id="h81-0-47" class="d">-                    Column {
</a><a href="#h81-0-48" id="h81-0-48" class="d">-                        name: &quot;released&quot;,
</a><a href="#h81-0-49" id="h81-0-49" class="d">-                        datatype: Integer,
</a><a href="#h81-0-50" id="h81-0-50" class="d">-                        nullable: false,
</a><a href="#h81-0-51" id="h81-0-51" class="d">-                        default: None,
</a><a href="#h81-0-52" id="h81-0-52" class="d">-                        unique: false,
</a><a href="#h81-0-53" id="h81-0-53" class="d">-                        index: false,
</a><a href="#h81-0-54" id="h81-0-54" class="d">-                        references: None,
</a><a href="#h81-0-55" id="h81-0-55" class="d">-                    },
</a><a href="#h81-0-56" id="h81-0-56" class="d">-                    Column {
</a><a href="#h81-0-57" id="h81-0-57" class="d">-                        name: &quot;rating&quot;,
</a><a href="#h81-0-58" id="h81-0-58" class="d">-                        datatype: Float,
</a><a href="#h81-0-59" id="h81-0-59" class="d">-                        nullable: true,
</a><a href="#h81-0-60" id="h81-0-60" class="d">-                        default: Some(
</a><a href="#h81-0-61" id="h81-0-61" class="d">-                            Null,
</a><a href="#h81-0-62" id="h81-0-62" class="d">-                        ),
</a><a href="#h81-0-63" id="h81-0-63" class="d">-                        unique: false,
</a><a href="#h81-0-64" id="h81-0-64" class="d">-                        index: false,
</a><a href="#h81-0-65" id="h81-0-65" class="d">-                        references: None,
</a><a href="#h81-0-66" id="h81-0-66" class="d">-                    },
</a><a href="#h81-0-67" id="h81-0-67" class="d">-                    Column {
</a><a href="#h81-0-68" id="h81-0-68" class="d">-                        name: &quot;ultrahd&quot;,
</a><a href="#h81-0-69" id="h81-0-69" class="d">-                        datatype: Boolean,
</a><a href="#h81-0-70" id="h81-0-70" class="d">-                        nullable: true,
</a><a href="#h81-0-71" id="h81-0-71" class="d">-                        default: Some(
</a><a href="#h81-0-72" id="h81-0-72" class="d">-                            Null,
</a><a href="#h81-0-73" id="h81-0-73" class="d">-                        ),
</a><a href="#h81-0-74" id="h81-0-74" class="d">-                        unique: false,
</a><a href="#h81-0-75" id="h81-0-75" class="d">-                        index: false,
</a><a href="#h81-0-76" id="h81-0-76" class="d">-                        references: None,
</a><a href="#h81-0-77" id="h81-0-77" class="d">-                    },
</a><a href="#h81-0-78" id="h81-0-78" class="d">-                ],
</a><a href="#h81-0-79" id="h81-0-79" class="d">-            },
</a><a href="#h81-0-80" id="h81-0-80" class="d">-            alias: None,
</a><a href="#h81-0-81" id="h81-0-81" class="i">+            table: &quot;movies&quot;,
</a>             keys: [
                 Integer(
                     2,
<a href="#h81-1" id="h81-1" class="h">@@ -433,6 +356,7 @@ Optimized plan: Select {
</a>                     5,
                 ),
             ],
<a href="#h81-1-3" id="h81-1-3" class="i">+            alias: None,
</a>         },
         predicate: Equal(
             Field(
</pre>
</div>
</body>
</html>
