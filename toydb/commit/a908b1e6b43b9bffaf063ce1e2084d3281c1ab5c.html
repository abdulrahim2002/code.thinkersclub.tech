<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: added tests and null handling for math operators - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/a908b1e6b43b9bffaf063ce1e2084d3281c1ab5c.html">a908b1e6b43b9bffaf063ce1e2084d3281c1ab5c</a>
<b>parent</b> <a href="../commit/ac4c1918ef47986e1efa791a005e41cc73fe3cfe.html">ac4c1918ef47986e1efa791a005e41cc73fe3cfe</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Wed, 18 Dec 2019 19:55:58 +0100

sql: added tests and null handling for math operators

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/expression.rs</a></td><td> | </td><td class="num">32</td><td><span class="i">+++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/tests.rs</a></td><td> | </td><td class="num">80</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---</span></td></tr>
</table></pre><pre>2 files changed, 108 insertions(+), 4 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/expression.rs.html">src/sql/expression.rs</a> b/<a href="../file/src/sql/expression.rs.html">src/sql/expression.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -125,6 +125,7 @@ impl Expression {
</a>             },
 
             // Mathematical operations
<a href="#h0-0-3" id="h0-0-3" class="i">+            // FIXME Handle infinity and NaN
</a>             Self::Add(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 + rhs),
                 (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs + rhs),
<a href="#h0-1" id="h0-1" class="h">@@ -144,10 +145,18 @@ impl Expression {
</a>                 expr =&gt; return Err(Error::Value(format!(&quot;Can&#39;t take the positive of {}&quot;, expr))),
             },
             Self::Divide(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
<a href="#h0-1-3" id="h0-1-3" class="i">+                (Integer(_), Integer(rhs)) if rhs == 0 =&gt; {
</a><a href="#h0-1-4" id="h0-1-4" class="i">+                    return Err(Error::Value(&quot;Can&#39;t divide by zero&quot;.into()))
</a><a href="#h0-1-5" id="h0-1-5" class="i">+                }
</a>                 (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs / rhs),
                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 / rhs),
<a href="#h0-1-8" id="h0-1-8" class="i">+                (Integer(_), Null) =&gt; Null,
</a>                 (Float(lhs), Integer(rhs)) =&gt; Float(lhs / rhs as f64),
                 (Float(lhs), Float(rhs)) =&gt; Float(lhs / rhs),
<a href="#h0-1-11" id="h0-1-11" class="i">+                (Float(_), Null) =&gt; Null,
</a><a href="#h0-1-12" id="h0-1-12" class="i">+                (Null, Float(_)) =&gt; Null,
</a><a href="#h0-1-13" id="h0-1-13" class="i">+                (Null, Integer(_)) =&gt; Null,
</a><a href="#h0-1-14" id="h0-1-14" class="i">+                (Null, Null) =&gt; Null,
</a>                 (lhs, rhs) =&gt; {
                     return Err(Error::Value(format!(&quot;Can&#39;t divide {} and {}&quot;, lhs, rhs)))
                 }
<a href="#h0-2" id="h0-2" class="h">@@ -155,9 +164,14 @@ impl Expression {
</a>             Self::Exponentiate(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
                 // FIXME Handle overflow
                 (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs.pow(rhs as u32)),
<a href="#h0-2-3" id="h0-2-3" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Float((lhs as f64).powi(rhs as i32)),
</a><a href="#h0-2-4" id="h0-2-4" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Float((lhs as f64).powf(rhs)),
</a><a href="#h0-2-5" id="h0-2-5" class="i">+                (Integer(_), Null) =&gt; Null,
</a>                 (Float(lhs), Integer(rhs)) =&gt; Float((lhs).powi(rhs as i32)),
                 (Float(lhs), Float(rhs)) =&gt; Float((lhs).powf(rhs)),
<a href="#h0-2-8" id="h0-2-8" class="i">+                (Float(_), Null) =&gt; Null,
</a><a href="#h0-2-9" id="h0-2-9" class="i">+                (Null, Float(_)) =&gt; Null,
</a><a href="#h0-2-10" id="h0-2-10" class="i">+                (Null, Integer(_)) =&gt; Null,
</a><a href="#h0-2-11" id="h0-2-11" class="i">+                (Null, Null) =&gt; Null,
</a>                 (lhs, rhs) =&gt; {
                     return Err(Error::Value(format!(&quot;Can&#39;t exponentiate {} and {}&quot;, lhs, rhs)))
                 }
<a href="#h0-3" id="h0-3" class="h">@@ -171,8 +185,13 @@ impl Expression {
</a>                 // acrobatics to make it work right
                 (Integer(lhs), Integer(rhs)) =&gt; Integer(((lhs % rhs) + rhs) % rhs),
                 (Integer(lhs), Float(rhs)) =&gt; Float(((lhs as f64 % rhs) + rhs) % rhs),
<a href="#h0-3-3" id="h0-3-3" class="i">+                (Integer(_), Null) =&gt; Null,
</a>                 (Float(lhs), Integer(rhs)) =&gt; Float(((lhs % rhs as f64) + rhs as f64) % rhs as f64),
                 (Float(lhs), Float(rhs)) =&gt; Float(((lhs % rhs) + rhs) % rhs),
<a href="#h0-3-6" id="h0-3-6" class="i">+                (Float(_), Null) =&gt; Null,
</a><a href="#h0-3-7" id="h0-3-7" class="i">+                (Null, Float(_)) =&gt; Null,
</a><a href="#h0-3-8" id="h0-3-8" class="i">+                (Null, Integer(_)) =&gt; Null,
</a><a href="#h0-3-9" id="h0-3-9" class="i">+                (Null, Null) =&gt; Null,
</a>                 (lhs, rhs) =&gt; {
                     return Err(Error::Value(format!(&quot;Can&#39;t take modulo of {} and {}&quot;, lhs, rhs)))
                 }
<a href="#h0-4" id="h0-4" class="h">@@ -180,8 +199,13 @@ impl Expression {
</a>             Self::Multiply(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
                 (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs * rhs),
                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 * rhs),
<a href="#h0-4-3" id="h0-4-3" class="i">+                (Integer(_), Null) =&gt; Null,
</a>                 (Float(lhs), Integer(rhs)) =&gt; Float(lhs * rhs as f64),
                 (Float(lhs), Float(rhs)) =&gt; Float(lhs * rhs),
<a href="#h0-4-6" id="h0-4-6" class="i">+                (Float(_), Null) =&gt; Null,
</a><a href="#h0-4-7" id="h0-4-7" class="i">+                (Null, Float(_)) =&gt; Null,
</a><a href="#h0-4-8" id="h0-4-8" class="i">+                (Null, Integer(_)) =&gt; Null,
</a><a href="#h0-4-9" id="h0-4-9" class="i">+                (Null, Null) =&gt; Null,
</a>                 (lhs, rhs) =&gt; {
                     return Err(Error::Value(format!(&quot;Can&#39;t multiply {} and {}&quot;, lhs, rhs)))
                 }
<a href="#h0-5" id="h0-5" class="h">@@ -189,13 +213,19 @@ impl Expression {
</a>             Self::Negate(expr) =&gt; match expr.evaluate(e)? {
                 Integer(i) =&gt; Integer(-i),
                 Float(f) =&gt; Float(-f),
<a href="#h0-5-3" id="h0-5-3" class="i">+                Null =&gt; Null,
</a>                 value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t negate {}&quot;, value))),
             },
             Self::Subtract(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
                 (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs - rhs),
                 (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 - rhs),
<a href="#h0-5-9" id="h0-5-9" class="i">+                (Integer(_), Null) =&gt; Null,
</a>                 (Float(lhs), Integer(rhs)) =&gt; Float(lhs - rhs as f64),
                 (Float(lhs), Float(rhs)) =&gt; Float(lhs - rhs),
<a href="#h0-5-12" id="h0-5-12" class="i">+                (Float(_), Null) =&gt; Null,
</a><a href="#h0-5-13" id="h0-5-13" class="i">+                (Null, Float(_)) =&gt; Null,
</a><a href="#h0-5-14" id="h0-5-14" class="i">+                (Null, Integer(_)) =&gt; Null,
</a><a href="#h0-5-15" id="h0-5-15" class="i">+                (Null, Null) =&gt; Null,
</a>                 (lhs, rhs) =&gt; {
                     return Err(Error::Value(format!(&quot;Can&#39;t subtract {} and {}&quot;, lhs, rhs)))
                 }
<b>diff --git a/<a id="h1" href="../file/src/sql/tests.rs.html">src/sql/tests.rs</a> b/<a href="../file/src/sql/tests.rs.html">src/sql/tests.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -271,11 +271,29 @@ test_expr! {
</a>     op_add_error_bool: &quot;TRUE + FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t add TRUE and FALSE&quot;.into())),
     op_add_error_strings: &quot;&#39;a&#39; + &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t add a and b&quot;.into())),
 
<a href="#h1-0-3" id="h1-0-3" class="d">-    op_assert: &quot;+1&quot; =&gt; Ok(Integer(1)),
</a><a href="#h1-0-4" id="h1-0-4" class="d">-    op_assert_bool: &quot;+TRUE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take the positive of TRUE&quot;.into())),
</a>     op_assert_float: &quot;+3.72&quot; =&gt; Ok(Float(3.72)),
<a href="#h1-0-6" id="h1-0-6" class="d">-    op_assert_multi: &quot;+++1&quot; =&gt; Ok(Integer(1)),
</a><a href="#h1-0-7" id="h1-0-7" class="i">+    op_assert_int: &quot;+1&quot; =&gt; Ok(Integer(1)),
</a>     op_assert_null: &quot;+NULL&quot; =&gt; Ok(Null),
<a href="#h1-0-9" id="h1-0-9" class="i">+    op_assert_multi: &quot;+++1&quot; =&gt; Ok(Integer(1)),
</a><a href="#h1-0-10" id="h1-0-10" class="i">+    op_assert_error_bool: &quot;+TRUE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take the positive of TRUE&quot;.into())),
</a><a href="#h1-0-11" id="h1-0-11" class="i">+    op_assert_error_string: &quot;+&#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take the positive of abc&quot;.into())),
</a><a href="#h1-0-12" id="h1-0-12" class="i">+
</a><a href="#h1-0-13" id="h1-0-13" class="i">+    op_divide_float_float: &quot;4.16 / 3.2&quot; =&gt; Ok(Float(1.3)),
</a><a href="#h1-0-14" id="h1-0-14" class="i">+    op_divide_float_float_zero: &quot;4.16 / 0.0&quot; =&gt; Ok(Float(std::f64::INFINITY)),
</a><a href="#h1-0-15" id="h1-0-15" class="i">+    op_divide_float_integer: &quot;1.5 / 3&quot; =&gt; Ok(Float(0.5)),
</a><a href="#h1-0-16" id="h1-0-16" class="i">+    op_divide_float_integer_zero: &quot;4.16 / 0&quot; =&gt; Ok(Float(std::f64::INFINITY)),
</a><a href="#h1-0-17" id="h1-0-17" class="i">+    op_divide_float_null: &quot;4.16 / NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-0-18" id="h1-0-18" class="i">+    op_divide_integer_float: &quot;3 / 1.2&quot; =&gt; Ok(Float(2.5)),
</a><a href="#h1-0-19" id="h1-0-19" class="i">+    op_divide_integer_float_zero: &quot;3 / 0.0&quot; =&gt; Ok(Float(std::f64::INFINITY)),
</a><a href="#h1-0-20" id="h1-0-20" class="i">+    op_divide_integer_integer: &quot;8 / 3&quot; =&gt; Ok(Integer(2)),
</a><a href="#h1-0-21" id="h1-0-21" class="i">+    op_divide_integer_integer_negative: &quot;8 / -3&quot; =&gt; Ok(Integer(-2)),
</a><a href="#h1-0-22" id="h1-0-22" class="i">+    op_divide_integer_null: &quot;1 / NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-0-23" id="h1-0-23" class="i">+    op_divide_null_float: &quot;NULL / 3.14&quot; =&gt; Ok(Null),
</a><a href="#h1-0-24" id="h1-0-24" class="i">+    op_divide_null_integer: &quot;NULL / 1&quot; =&gt; Ok(Null),
</a><a href="#h1-0-25" id="h1-0-25" class="i">+    op_divide_null_null: &quot;NULL / NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-0-26" id="h1-0-26" class="i">+    op_divide_error_bool: &quot;TRUE / FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t divide TRUE and FALSE&quot;.into())),
</a><a href="#h1-0-27" id="h1-0-27" class="i">+    op_divide_error_integer_zero: &quot;1 / 0&quot; =&gt; Err(Error::Value(&quot;Can&#39;t divide by zero&quot;.into())),
</a><a href="#h1-0-28" id="h1-0-28" class="i">+    op_divide_error_strings: &quot;&#39;a&#39; / &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t divide a and b&quot;.into())),
</a> 
     op_eq_bool_false_false: &quot;FALSE = FALSE&quot; =&gt; Ok(Boolean(true)),
     op_eq_bool_true_false: &quot;TRUE = FALSE&quot; =&gt; Ok(Boolean(false)),
<a href="#h1-1" id="h1-1" class="h">@@ -290,11 +308,54 @@ test_expr! {
</a>     op_eq_str_case: &quot;&#39;abc&#39; = &#39;ABC&#39;&quot; =&gt; Ok(Boolean(false)),
     op_eq_str_neq: &quot;&#39;abc&#39; = &#39;xyz&#39;&quot; =&gt; Ok(Boolean(false)),
 
<a href="#h1-1-3" id="h1-1-3" class="i">+    op_multiply_float_float: &quot;3.1 * 2.71&quot; =&gt; Ok(Float(3.1 * 2.71)),
</a><a href="#h1-1-4" id="h1-1-4" class="i">+    op_multiply_float_int: &quot;3.72 * 1&quot; =&gt; Ok(Float(3.72 * 1.0)),
</a><a href="#h1-1-5" id="h1-1-5" class="i">+    op_multiply_float_null: &quot;3.14 * NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-6" id="h1-1-6" class="i">+    op_multiply_int_float: &quot;1 * 3.72&quot; =&gt; Ok(Float(1.0 * 3.72)),
</a><a href="#h1-1-7" id="h1-1-7" class="i">+    op_multiply_int_int: &quot;2 * 3&quot; =&gt; Ok(Integer(6)),
</a><a href="#h1-1-8" id="h1-1-8" class="i">+    op_multiply_int_null: &quot;1 * NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-9" id="h1-1-9" class="i">+    op_multiply_null_float: &quot;NULL * 3.14&quot; =&gt; Ok(Null),
</a><a href="#h1-1-10" id="h1-1-10" class="i">+    op_multiply_null_int: &quot;NULL * 1&quot; =&gt; Ok(Null),
</a><a href="#h1-1-11" id="h1-1-11" class="i">+    op_multiply_null_null: &quot;NULL * NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-12" id="h1-1-12" class="i">+    op_multiply_negative: &quot;1 * -3&quot; =&gt; Ok(Integer(-3)),
</a><a href="#h1-1-13" id="h1-1-13" class="i">+    op_multiply_error_bool: &quot;TRUE * FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t multiply TRUE and FALSE&quot;.into())),
</a><a href="#h1-1-14" id="h1-1-14" class="i">+    op_multiply_error_strings: &quot;&#39;a&#39; * &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t multiply a and b&quot;.into())),
</a><a href="#h1-1-15" id="h1-1-15" class="i">+
</a><a href="#h1-1-16" id="h1-1-16" class="i">+    op_modulo_float_float: &quot;6.28 % 2.2&quot; =&gt; Ok(Float(1.88)),
</a><a href="#h1-1-17" id="h1-1-17" class="i">+    op_modulo_float_int: &quot;3.15 % 2&quot; =&gt; Ok(Float(1.15)),
</a><a href="#h1-1-18" id="h1-1-18" class="i">+    op_modulo_float_null: &quot;3.14 % NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-19" id="h1-1-19" class="i">+    op_modulo_int_float: &quot;6 % 3.15&quot; =&gt; Ok(Float(2.85)),
</a><a href="#h1-1-20" id="h1-1-20" class="i">+    op_modulo_int_int: &quot;7 % 3&quot; =&gt; Ok(Integer(1)),
</a><a href="#h1-1-21" id="h1-1-21" class="i">+    op_modulo_int_null: &quot;1 % NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-22" id="h1-1-22" class="i">+    op_modulo_null_float: &quot;NULL % 3.14&quot; =&gt; Ok(Null),
</a><a href="#h1-1-23" id="h1-1-23" class="i">+    op_modulo_null_int: &quot;NULL % 1&quot; =&gt; Ok(Null),
</a><a href="#h1-1-24" id="h1-1-24" class="i">+    op_modulo_null_null: &quot;NULL % NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-25" id="h1-1-25" class="i">+    op_modulo_negative: &quot;-5 % 3&quot; =&gt; Ok(Integer(1)),
</a><a href="#h1-1-26" id="h1-1-26" class="i">+    op_modulo_negative_rhs: &quot;5 % -3&quot; =&gt; Ok(Integer(-1)),
</a><a href="#h1-1-27" id="h1-1-27" class="i">+    op_modulo_error_bool: &quot;TRUE % FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take modulo of TRUE and FALSE&quot;.into())),
</a><a href="#h1-1-28" id="h1-1-28" class="i">+    op_modulo_error_strings: &quot;&#39;a&#39; % &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t take modulo of a and b&quot;.into())),
</a><a href="#h1-1-29" id="h1-1-29" class="i">+
</a><a href="#h1-1-30" id="h1-1-30" class="i">+    op_exp_float_float: &quot;6.25 ^ 0.5&quot; =&gt; Ok(Float(2.5)),
</a><a href="#h1-1-31" id="h1-1-31" class="i">+    op_exp_float_int: &quot;6.25 ^ 2&quot; =&gt; Ok(Float(39.0625)),
</a><a href="#h1-1-32" id="h1-1-32" class="i">+    op_exp_float_null: &quot;3.14 ^ NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-33" id="h1-1-33" class="i">+    op_exp_int_float: &quot;9 ^ 0.5&quot; =&gt; Ok(Float(3.0)),
</a><a href="#h1-1-34" id="h1-1-34" class="i">+    op_exp_int_int: &quot;2 ^ 3&quot; =&gt; Ok(Integer(8)),
</a><a href="#h1-1-35" id="h1-1-35" class="i">+    op_exp_int_null: &quot;1 ^ NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-36" id="h1-1-36" class="i">+    op_exp_null_float: &quot;NULL ^ 3.14&quot; =&gt; Ok(Null),
</a><a href="#h1-1-37" id="h1-1-37" class="i">+    op_exp_null_int: &quot;NULL ^ 1&quot; =&gt; Ok(Null),
</a><a href="#h1-1-38" id="h1-1-38" class="i">+    op_exp_null_null: &quot;NULL ^ NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-39" id="h1-1-39" class="i">+    op_exp_negative: &quot;2 ^ -3&quot; =&gt; Ok(Float(0.125)),
</a><a href="#h1-1-40" id="h1-1-40" class="i">+    op_exp_error_bool: &quot;TRUE ^ FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t exponentiate TRUE and FALSE&quot;.into())),
</a><a href="#h1-1-41" id="h1-1-41" class="i">+    op_exp_error_strings: &quot;&#39;a&#39; ^ &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t exponentiate a and b&quot;.into())),
</a><a href="#h1-1-42" id="h1-1-42" class="i">+
</a>     op_negate: &quot;-1&quot; =&gt; Ok(Integer(-1)),
     op_negate_double: &quot;--1&quot; =&gt; Ok(Integer(1)),
     op_negate_float: &quot;-3.72&quot; =&gt; Ok(Float(-3.72)),
     op_negate_mixed: &quot;-+-+-1&quot; =&gt; Ok(Integer(-1)),
     op_negate_multi: &quot;---1&quot; =&gt; Ok(Integer(-1)),
<a href="#h1-1-48" id="h1-1-48" class="i">+    op_negate_null: &quot;-NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-1-49" id="h1-1-49" class="i">+    op_negate_error_bool: &quot;-TRUE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t negate TRUE&quot;.into())),
</a><a href="#h1-1-50" id="h1-1-50" class="i">+    op_negate_error_string: &quot;-&#39;abc&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t negate abc&quot;.into())),
</a> 
     op_neq_bool_false_false: &quot;FALSE != FALSE&quot; =&gt; Ok(Boolean(false)),
     op_neq_bool_true_false: &quot;TRUE != FALSE&quot; =&gt; Ok(Boolean(true)),
<a href="#h1-2" id="h1-2" class="h">@@ -308,4 +369,17 @@ test_expr! {
</a>     op_neq_str: &quot;&#39;abc&#39; != &#39;xyz&#39;&quot; =&gt; Ok(Boolean(true)),
     op_neq_str_case: &quot;&#39;abc&#39; != &#39;ABC&#39;&quot; =&gt; Ok(Boolean(true)),
     op_neq_str_eq: &quot;&#39;abc&#39; != &#39;abc&#39;&quot; =&gt; Ok(Boolean(false)),
<a href="#h1-2-3" id="h1-2-3" class="i">+
</a><a href="#h1-2-4" id="h1-2-4" class="i">+    op_subtract_float_float: &quot;3.1 - 2.71&quot; =&gt; Ok(Float(3.1 - 2.71)),
</a><a href="#h1-2-5" id="h1-2-5" class="i">+    op_subtract_float_int: &quot;3.72 - 1&quot; =&gt; Ok(Float(3.72 - 1.0)),
</a><a href="#h1-2-6" id="h1-2-6" class="i">+    op_subtract_float_null: &quot;3.14 - NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-2-7" id="h1-2-7" class="i">+    op_subtract_int_float: &quot;1 - 3.72&quot; =&gt; Ok(Float(1.0 - 3.72)),
</a><a href="#h1-2-8" id="h1-2-8" class="i">+    op_subtract_int_int: &quot;1 - 2&quot; =&gt; Ok(Integer(-1)),
</a><a href="#h1-2-9" id="h1-2-9" class="i">+    op_subtract_int_null: &quot;1 - NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-2-10" id="h1-2-10" class="i">+    op_subtract_null_float: &quot;NULL - 3.14&quot; =&gt; Ok(Null),
</a><a href="#h1-2-11" id="h1-2-11" class="i">+    op_subtract_null_int: &quot;NULL - 1&quot; =&gt; Ok(Null),
</a><a href="#h1-2-12" id="h1-2-12" class="i">+    op_subtract_null_null: &quot;NULL - NULL&quot; =&gt; Ok(Null),
</a><a href="#h1-2-13" id="h1-2-13" class="i">+    op_subtract_negative: &quot;1 - -3&quot; =&gt; Ok(Integer(4)),
</a><a href="#h1-2-14" id="h1-2-14" class="i">+    op_subtract_error_bool: &quot;TRUE - FALSE&quot; =&gt; Err(Error::Value(&quot;Can&#39;t subtract TRUE and FALSE&quot;.into())),
</a><a href="#h1-2-15" id="h1-2-15" class="i">+    op_subtract_error_strings: &quot;&#39;a&#39; - &#39;b&#39;&quot; =&gt; Err(Error::Value(&quot;Can&#39;t subtract a and b&quot;.into())),
</a> }
</pre>
</div>
</body>
</html>
