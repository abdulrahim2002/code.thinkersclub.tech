<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: add new Nothing node and use in short circuit optimizer - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/dbafc6db374eb632ca6a36c15167d344b04e880c.html">dbafc6db374eb632ca6a36c15167d344b04e880c</a>
<b>parent</b> <a href="../commit/3ecc16b45ba3177a91cc2b3b75d414dc23807891.html">3ecc16b45ba3177a91cc2b3b75d414dc23807891</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Wed, 26 Jun 2024 16:54:14 +0200

sql: add new Nothing node and use in short circuit optimizer

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/execution/execute.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/execution/source.rs</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/planner/optimizer.rs</a></td><td> | </td><td class="num">46</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/planner/plan.rs</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">132</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">139</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">tests/sql/query/join_inner_on_false</a></td><td> | </td><td class="num">126</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">tests/sql/query/where_false</a></td><td> | </td><td class="num">90</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">tests/sql/query/where_null</a></td><td> | </td><td class="num">88</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
</table></pre><pre>9 files changed, 70 insertions(+), 585 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a> b/<a href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -102,6 +102,8 @@ pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;Rows&gt; {
</a>             join::nested_loop(left, right, right_size, predicate, outer)
         }
 
<a href="#h0-0-3" id="h0-0-3" class="i">+        Node::Nothing =&gt; Ok(source::nothing()),
</a><a href="#h0-0-4" id="h0-0-4" class="i">+
</a>         Node::EmptyRow =&gt; Ok(source::empty_row()),
 
         Node::Offset { source, offset } =&gt; {
<b>diff --git a/<a id="h1" href="../file/src/sql/execution/source.rs.html">src/sql/execution/source.rs</a> b/<a href="../file/src/sql/execution/source.rs.html">src/sql/execution/source.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -27,6 +27,11 @@ pub(super) fn lookup_index(
</a>     Ok(Box::new(txn.get(&amp;table, &amp;ids)?.into_iter().map(Ok)))
 }
 
<a href="#h1-0-3" id="h1-0-3" class="i">+/// Returns nothing. Used to short-circuit nodes that can&#39;t produce any rows.
</a><a href="#h1-0-4" id="h1-0-4" class="i">+pub(super) fn nothing() -&gt; Rows {
</a><a href="#h1-0-5" id="h1-0-5" class="i">+    Box::new(std::iter::empty())
</a><a href="#h1-0-6" id="h1-0-6" class="i">+}
</a><a href="#h1-0-7" id="h1-0-7" class="i">+
</a> /// Produces a single empty row. Used for queries without a FROM clause, e.g.
 /// SELECT 1+1, in order to have something to project against.
 /// TODO: remove this.
<b>diff --git a/<a id="h2" href="../file/src/sql/planner/optimizer.rs.html">src/sql/planner/optimizer.rs</a> b/<a href="../file/src/sql/planner/optimizer.rs.html">src/sql/planner/optimizer.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -281,29 +281,55 @@ pub(super) fn join_type(node: Node) -&gt; Result&lt;Node&gt; {
</a>     node.transform(&amp;|n| Ok(transform(n)), &amp;Ok)
 }
 
<a href="#h2-0-3" id="h2-0-3" class="d">-/// Short-circuits useless nodes and expressions.
</a><a href="#h2-0-4" id="h2-0-4" class="d">-///
</a><a href="#h2-0-5" id="h2-0-5" class="d">-/// TODO: this should replace e.g. Filter(false) nodes with Nothing nodes, but
</a><a href="#h2-0-6" id="h2-0-6" class="d">-/// Nothing nodes currently emit a single row (for non-table queries). Once
</a><a href="#h2-0-7" id="h2-0-7" class="d">-/// Nothing doesn&#39;t emit anything, extend this to transform false filters with
</a><a href="#h2-0-8" id="h2-0-8" class="d">-/// Nothing, and then pull this upwards in the tree (e.g. a join or projection
</a><a href="#h2-0-9" id="h2-0-9" class="d">-/// with Nothing is useless).
</a><a href="#h2-0-10" id="h2-0-10" class="i">+/// Short-circuits useless nodes and expressions, by removing them and/or
</a><a href="#h2-0-11" id="h2-0-11" class="i">+/// replacing them with Nothing nodes that yield no rows.
</a> pub(super) fn short_circuit(node: Node) -&gt; Result&lt;Node&gt; {
     const TRUE: Expression = Expression::Constant(Value::Boolean(true));
     const TRUEOPT: Option&lt;Expression&gt; = Some(TRUE);
<a href="#h2-0-15" id="h2-0-15" class="i">+    const FALSE: Expression = Expression::Constant(Value::Boolean(false));
</a><a href="#h2-0-16" id="h2-0-16" class="i">+    const FALSEOPT: Option&lt;Expression&gt; = Some(FALSE);
</a><a href="#h2-0-17" id="h2-0-17" class="i">+    const NULL: Expression = Expression::Constant(Value::Null);
</a><a href="#h2-0-18" id="h2-0-18" class="i">+    const NULLOPT: Option&lt;Expression&gt; = Some(NULL);
</a> 
     let transform = |node| match node {
<a href="#h2-0-21" id="h2-0-21" class="d">-        // Filter nodes that always yield true are unnecessary.
</a><a href="#h2-0-22" id="h2-0-22" class="i">+        // Filter nodes that always yield true are unnecessary: remove them .
</a>         Node::Filter { source, predicate: TRUE } =&gt; *source,
 
<a href="#h2-0-25" id="h2-0-25" class="d">-        // Predicates that always yield true are unnecessary.
</a><a href="#h2-0-26" id="h2-0-26" class="i">+        // Predicates that always yield true are unnecessary: remove them.
</a>         Node::Scan { table, filter: TRUEOPT, alias } =&gt; Node::Scan { table, filter: None, alias },
         Node::NestedLoopJoin { left, left_size, right, right_size, predicate: TRUEOPT, outer } =&gt; {
             Node::NestedLoopJoin { left, left_size, right, right_size, predicate: None, outer }
         }
<a href="#h2-0-31" id="h2-0-31" class="i">+
</a><a href="#h2-0-32" id="h2-0-32" class="i">+        // Short-circuit nodes that can&#39;t produce anything by replacing them
</a><a href="#h2-0-33" id="h2-0-33" class="i">+        // with a Nothing node.
</a><a href="#h2-0-34" id="h2-0-34" class="i">+        Node::Filter { predicate: FALSE | NULL, .. } =&gt; Node::Nothing,
</a><a href="#h2-0-35" id="h2-0-35" class="i">+        Node::IndexLookup { values, .. } if values.is_empty() =&gt; Node::Nothing,
</a><a href="#h2-0-36" id="h2-0-36" class="i">+        Node::KeyLookup { keys, .. } if keys.is_empty() =&gt; Node::Nothing,
</a><a href="#h2-0-37" id="h2-0-37" class="i">+        Node::NestedLoopJoin { predicate: FALSEOPT | NULLOPT, .. } =&gt; Node::Nothing,
</a><a href="#h2-0-38" id="h2-0-38" class="i">+        Node::Scan { filter: FALSEOPT | NULLOPT, .. } =&gt; Node::Nothing,
</a><a href="#h2-0-39" id="h2-0-39" class="i">+        Node::Values { rows, .. } if rows.is_empty() =&gt; Node::Nothing,
</a><a href="#h2-0-40" id="h2-0-40" class="i">+
</a><a href="#h2-0-41" id="h2-0-41" class="i">+        // Short-circuit nodes that pull from a Nothing node.
</a><a href="#h2-0-42" id="h2-0-42" class="i">+        //
</a><a href="#h2-0-43" id="h2-0-43" class="i">+        // NB: does not short-circuit aggregation, since an aggregation over 0
</a><a href="#h2-0-44" id="h2-0-44" class="i">+        // rows should produce a result.
</a><a href="#h2-0-45" id="h2-0-45" class="i">+        Node::Filter { source, .. }
</a><a href="#h2-0-46" id="h2-0-46" class="i">+        | Node::HashJoin { left: source, .. }
</a><a href="#h2-0-47" id="h2-0-47" class="i">+        | Node::HashJoin { right: source, .. }
</a><a href="#h2-0-48" id="h2-0-48" class="i">+        | Node::NestedLoopJoin { left: source, .. }
</a><a href="#h2-0-49" id="h2-0-49" class="i">+        | Node::NestedLoopJoin { right: source, .. }
</a><a href="#h2-0-50" id="h2-0-50" class="i">+        | Node::Offset { source, .. }
</a><a href="#h2-0-51" id="h2-0-51" class="i">+        | Node::Order { source, .. }
</a><a href="#h2-0-52" id="h2-0-52" class="i">+        | Node::Projection { source, .. }
</a><a href="#h2-0-53" id="h2-0-53" class="i">+            if *source == Node::Nothing =&gt;
</a><a href="#h2-0-54" id="h2-0-54" class="i">+        {
</a><a href="#h2-0-55" id="h2-0-55" class="i">+            Node::Nothing
</a><a href="#h2-0-56" id="h2-0-56" class="i">+        }
</a><a href="#h2-0-57" id="h2-0-57" class="i">+
</a>         node =&gt; node,
     };
 
<a href="#h2-0-61" id="h2-0-61" class="d">-    // Transform after descending, to (eventually) pull Nothing nodes upwards.
</a><a href="#h2-0-62" id="h2-0-62" class="i">+    // Transform after descending, to pull Nothing nodes upwards.
</a>     node.transform(&amp;Ok, &amp;|n| Ok(transform(n)))
 }
<b>diff --git a/<a id="h3" href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a> b/<a href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -129,6 +129,8 @@ pub enum Node {
</a>         predicate: Option&lt;Expression&gt;,
         outer: bool,
     },
<a href="#h3-0-3" id="h3-0-3" class="i">+    /// Nothing does not emit anything.
</a><a href="#h3-0-4" id="h3-0-4" class="i">+    Nothing,
</a>     /// Emits a single empty row. Used for SELECT queries with no FROM clause.
     /// TODO: remove this.
     EmptyRow,
<a href="#h3-1" id="h3-1" class="h">@@ -208,6 +210,7 @@ impl Node {
</a>             node @ (Self::IndexLookup { .. }
             | Self::KeyLookup { .. }
             | Self::EmptyRow
<a href="#h3-1-3" id="h3-1-3" class="i">+            | Self::Nothing
</a>             | Self::Scan { .. }
             | Self::Values { .. }) =&gt; node,
         };
<a href="#h3-2" id="h3-2" class="h">@@ -266,15 +269,16 @@ impl Node {
</a>                     .collect::&lt;Result&lt;_&gt;&gt;()?,
             },
 
<a href="#h3-2-3" id="h3-2-3" class="d">-            node @ Self::Aggregation { .. }
</a><a href="#h3-2-4" id="h3-2-4" class="d">-            | node @ Self::HashJoin { .. }
</a><a href="#h3-2-5" id="h3-2-5" class="d">-            | node @ Self::IndexLookup { .. }
</a><a href="#h3-2-6" id="h3-2-6" class="d">-            | node @ Self::KeyLookup { .. }
</a><a href="#h3-2-7" id="h3-2-7" class="d">-            | node @ Self::Limit { .. }
</a><a href="#h3-2-8" id="h3-2-8" class="d">-            | node @ Self::NestedLoopJoin { predicate: None, .. }
</a><a href="#h3-2-9" id="h3-2-9" class="d">-            | node @ Self::EmptyRow
</a><a href="#h3-2-10" id="h3-2-10" class="d">-            | node @ Self::Offset { .. }
</a><a href="#h3-2-11" id="h3-2-11" class="d">-            | node @ Self::Scan { filter: None, .. } =&gt; node,
</a><a href="#h3-2-12" id="h3-2-12" class="i">+            node @ (Self::Aggregation { .. }
</a><a href="#h3-2-13" id="h3-2-13" class="i">+            | Self::HashJoin { .. }
</a><a href="#h3-2-14" id="h3-2-14" class="i">+            | Self::IndexLookup { .. }
</a><a href="#h3-2-15" id="h3-2-15" class="i">+            | Self::KeyLookup { .. }
</a><a href="#h3-2-16" id="h3-2-16" class="i">+            | Self::Limit { .. }
</a><a href="#h3-2-17" id="h3-2-17" class="i">+            | Self::NestedLoopJoin { predicate: None, .. }
</a><a href="#h3-2-18" id="h3-2-18" class="i">+            | Self::Nothing
</a><a href="#h3-2-19" id="h3-2-19" class="i">+            | Self::EmptyRow
</a><a href="#h3-2-20" id="h3-2-20" class="i">+            | Self::Offset { .. }
</a><a href="#h3-2-21" id="h3-2-21" class="i">+            | Self::Scan { filter: None, .. }) =&gt; node,
</a>         })
     }
 }
<a href="#h3-3" id="h3-3" class="h">@@ -405,7 +409,10 @@ impl Node {
</a>                 left.format(f, prefix.clone(), false, false)?;
                 right.format(f, prefix, false, true)?;
             }
<a href="#h3-3-3" id="h3-3-3" class="d">-            Self::EmptyRow {} =&gt; {
</a><a href="#h3-3-4" id="h3-3-4" class="i">+            Self::Nothing =&gt; {
</a><a href="#h3-3-5" id="h3-3-5" class="i">+                write!(f, &quot;Nothing&quot;)?;
</a><a href="#h3-3-6" id="h3-3-6" class="i">+            }
</a><a href="#h3-3-7" id="h3-3-7" class="i">+            Self::EmptyRow =&gt; {
</a>                 write!(f, &quot;EmptyRow&quot;)?;
             }
             Self::Offset { source, offset } =&gt; {
<b>diff --git a/<a id="h4" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -3,8 +3,7 @@ Query: SELECT MIN(id), MAX(id), SUM(id), COUNT(id), AVG(id) FROM movies WHERE FA
</a> Explain:
 Projection: #0, #1, #2, #3, #4
 └─ Aggregation: min, max, sum, count, avg
<a href="#h4-0-3" id="h4-0-3" class="d">-   └─ Projection: id, id, id, id, id
</a><a href="#h4-0-4" id="h4-0-4" class="d">-      └─ Scan: movies (FALSE)
</a><a href="#h4-0-5" id="h4-0-5" class="i">+   └─ Nothing
</a> 
 Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Null, Null, Null, Integer(0), Null]
<a href="#h4-1" id="h4-1" class="h">@@ -275,134 +274,7 @@ Plan: Select {
</a> Optimized plan: Select {
     root: Projection {
         source: Aggregation {
<a href="#h4-1-3" id="h4-1-3" class="d">-            source: Projection {
</a><a href="#h4-1-4" id="h4-1-4" class="d">-                source: Scan {
</a><a href="#h4-1-5" id="h4-1-5" class="d">-                    table: Table {
</a><a href="#h4-1-6" id="h4-1-6" class="d">-                        name: &quot;movies&quot;,
</a><a href="#h4-1-7" id="h4-1-7" class="d">-                        primary_key: 0,
</a><a href="#h4-1-8" id="h4-1-8" class="d">-                        columns: [
</a><a href="#h4-1-9" id="h4-1-9" class="d">-                            Column {
</a><a href="#h4-1-10" id="h4-1-10" class="d">-                                name: &quot;id&quot;,
</a><a href="#h4-1-11" id="h4-1-11" class="d">-                                datatype: Integer,
</a><a href="#h4-1-12" id="h4-1-12" class="d">-                                nullable: false,
</a><a href="#h4-1-13" id="h4-1-13" class="d">-                                default: None,
</a><a href="#h4-1-14" id="h4-1-14" class="d">-                                unique: true,
</a><a href="#h4-1-15" id="h4-1-15" class="d">-                                index: false,
</a><a href="#h4-1-16" id="h4-1-16" class="d">-                                references: None,
</a><a href="#h4-1-17" id="h4-1-17" class="d">-                            },
</a><a href="#h4-1-18" id="h4-1-18" class="d">-                            Column {
</a><a href="#h4-1-19" id="h4-1-19" class="d">-                                name: &quot;title&quot;,
</a><a href="#h4-1-20" id="h4-1-20" class="d">-                                datatype: String,
</a><a href="#h4-1-21" id="h4-1-21" class="d">-                                nullable: false,
</a><a href="#h4-1-22" id="h4-1-22" class="d">-                                default: None,
</a><a href="#h4-1-23" id="h4-1-23" class="d">-                                unique: false,
</a><a href="#h4-1-24" id="h4-1-24" class="d">-                                index: false,
</a><a href="#h4-1-25" id="h4-1-25" class="d">-                                references: None,
</a><a href="#h4-1-26" id="h4-1-26" class="d">-                            },
</a><a href="#h4-1-27" id="h4-1-27" class="d">-                            Column {
</a><a href="#h4-1-28" id="h4-1-28" class="d">-                                name: &quot;studio_id&quot;,
</a><a href="#h4-1-29" id="h4-1-29" class="d">-                                datatype: Integer,
</a><a href="#h4-1-30" id="h4-1-30" class="d">-                                nullable: false,
</a><a href="#h4-1-31" id="h4-1-31" class="d">-                                default: None,
</a><a href="#h4-1-32" id="h4-1-32" class="d">-                                unique: false,
</a><a href="#h4-1-33" id="h4-1-33" class="d">-                                index: true,
</a><a href="#h4-1-34" id="h4-1-34" class="d">-                                references: Some(
</a><a href="#h4-1-35" id="h4-1-35" class="d">-                                    &quot;studios&quot;,
</a><a href="#h4-1-36" id="h4-1-36" class="d">-                                ),
</a><a href="#h4-1-37" id="h4-1-37" class="d">-                            },
</a><a href="#h4-1-38" id="h4-1-38" class="d">-                            Column {
</a><a href="#h4-1-39" id="h4-1-39" class="d">-                                name: &quot;genre_id&quot;,
</a><a href="#h4-1-40" id="h4-1-40" class="d">-                                datatype: Integer,
</a><a href="#h4-1-41" id="h4-1-41" class="d">-                                nullable: false,
</a><a href="#h4-1-42" id="h4-1-42" class="d">-                                default: None,
</a><a href="#h4-1-43" id="h4-1-43" class="d">-                                unique: false,
</a><a href="#h4-1-44" id="h4-1-44" class="d">-                                index: true,
</a><a href="#h4-1-45" id="h4-1-45" class="d">-                                references: Some(
</a><a href="#h4-1-46" id="h4-1-46" class="d">-                                    &quot;genres&quot;,
</a><a href="#h4-1-47" id="h4-1-47" class="d">-                                ),
</a><a href="#h4-1-48" id="h4-1-48" class="d">-                            },
</a><a href="#h4-1-49" id="h4-1-49" class="d">-                            Column {
</a><a href="#h4-1-50" id="h4-1-50" class="d">-                                name: &quot;released&quot;,
</a><a href="#h4-1-51" id="h4-1-51" class="d">-                                datatype: Integer,
</a><a href="#h4-1-52" id="h4-1-52" class="d">-                                nullable: false,
</a><a href="#h4-1-53" id="h4-1-53" class="d">-                                default: None,
</a><a href="#h4-1-54" id="h4-1-54" class="d">-                                unique: false,
</a><a href="#h4-1-55" id="h4-1-55" class="d">-                                index: false,
</a><a href="#h4-1-56" id="h4-1-56" class="d">-                                references: None,
</a><a href="#h4-1-57" id="h4-1-57" class="d">-                            },
</a><a href="#h4-1-58" id="h4-1-58" class="d">-                            Column {
</a><a href="#h4-1-59" id="h4-1-59" class="d">-                                name: &quot;rating&quot;,
</a><a href="#h4-1-60" id="h4-1-60" class="d">-                                datatype: Float,
</a><a href="#h4-1-61" id="h4-1-61" class="d">-                                nullable: true,
</a><a href="#h4-1-62" id="h4-1-62" class="d">-                                default: Some(
</a><a href="#h4-1-63" id="h4-1-63" class="d">-                                    Null,
</a><a href="#h4-1-64" id="h4-1-64" class="d">-                                ),
</a><a href="#h4-1-65" id="h4-1-65" class="d">-                                unique: false,
</a><a href="#h4-1-66" id="h4-1-66" class="d">-                                index: false,
</a><a href="#h4-1-67" id="h4-1-67" class="d">-                                references: None,
</a><a href="#h4-1-68" id="h4-1-68" class="d">-                            },
</a><a href="#h4-1-69" id="h4-1-69" class="d">-                            Column {
</a><a href="#h4-1-70" id="h4-1-70" class="d">-                                name: &quot;ultrahd&quot;,
</a><a href="#h4-1-71" id="h4-1-71" class="d">-                                datatype: Boolean,
</a><a href="#h4-1-72" id="h4-1-72" class="d">-                                nullable: true,
</a><a href="#h4-1-73" id="h4-1-73" class="d">-                                default: Some(
</a><a href="#h4-1-74" id="h4-1-74" class="d">-                                    Null,
</a><a href="#h4-1-75" id="h4-1-75" class="d">-                                ),
</a><a href="#h4-1-76" id="h4-1-76" class="d">-                                unique: false,
</a><a href="#h4-1-77" id="h4-1-77" class="d">-                                index: false,
</a><a href="#h4-1-78" id="h4-1-78" class="d">-                                references: None,
</a><a href="#h4-1-79" id="h4-1-79" class="d">-                            },
</a><a href="#h4-1-80" id="h4-1-80" class="d">-                        ],
</a><a href="#h4-1-81" id="h4-1-81" class="d">-                    },
</a><a href="#h4-1-82" id="h4-1-82" class="d">-                    filter: Some(
</a><a href="#h4-1-83" id="h4-1-83" class="d">-                        Constant(
</a><a href="#h4-1-84" id="h4-1-84" class="d">-                            Boolean(
</a><a href="#h4-1-85" id="h4-1-85" class="d">-                                false,
</a><a href="#h4-1-86" id="h4-1-86" class="d">-                            ),
</a><a href="#h4-1-87" id="h4-1-87" class="d">-                        ),
</a><a href="#h4-1-88" id="h4-1-88" class="d">-                    ),
</a><a href="#h4-1-89" id="h4-1-89" class="d">-                    alias: None,
</a><a href="#h4-1-90" id="h4-1-90" class="d">-                },
</a><a href="#h4-1-91" id="h4-1-91" class="d">-                expressions: [
</a><a href="#h4-1-92" id="h4-1-92" class="d">-                    Field(
</a><a href="#h4-1-93" id="h4-1-93" class="d">-                        0,
</a><a href="#h4-1-94" id="h4-1-94" class="d">-                        Unqualified(
</a><a href="#h4-1-95" id="h4-1-95" class="d">-                            &quot;id&quot;,
</a><a href="#h4-1-96" id="h4-1-96" class="d">-                        ),
</a><a href="#h4-1-97" id="h4-1-97" class="d">-                    ),
</a><a href="#h4-1-98" id="h4-1-98" class="d">-                    Field(
</a><a href="#h4-1-99" id="h4-1-99" class="d">-                        0,
</a><a href="#h4-1-100" id="h4-1-100" class="d">-                        Unqualified(
</a><a href="#h4-1-101" id="h4-1-101" class="d">-                            &quot;id&quot;,
</a><a href="#h4-1-102" id="h4-1-102" class="d">-                        ),
</a><a href="#h4-1-103" id="h4-1-103" class="d">-                    ),
</a><a href="#h4-1-104" id="h4-1-104" class="d">-                    Field(
</a><a href="#h4-1-105" id="h4-1-105" class="d">-                        0,
</a><a href="#h4-1-106" id="h4-1-106" class="d">-                        Unqualified(
</a><a href="#h4-1-107" id="h4-1-107" class="d">-                            &quot;id&quot;,
</a><a href="#h4-1-108" id="h4-1-108" class="d">-                        ),
</a><a href="#h4-1-109" id="h4-1-109" class="d">-                    ),
</a><a href="#h4-1-110" id="h4-1-110" class="d">-                    Field(
</a><a href="#h4-1-111" id="h4-1-111" class="d">-                        0,
</a><a href="#h4-1-112" id="h4-1-112" class="d">-                        Unqualified(
</a><a href="#h4-1-113" id="h4-1-113" class="d">-                            &quot;id&quot;,
</a><a href="#h4-1-114" id="h4-1-114" class="d">-                        ),
</a><a href="#h4-1-115" id="h4-1-115" class="d">-                    ),
</a><a href="#h4-1-116" id="h4-1-116" class="d">-                    Field(
</a><a href="#h4-1-117" id="h4-1-117" class="d">-                        0,
</a><a href="#h4-1-118" id="h4-1-118" class="d">-                        Unqualified(
</a><a href="#h4-1-119" id="h4-1-119" class="d">-                            &quot;id&quot;,
</a><a href="#h4-1-120" id="h4-1-120" class="d">-                        ),
</a><a href="#h4-1-121" id="h4-1-121" class="d">-                    ),
</a><a href="#h4-1-122" id="h4-1-122" class="d">-                ],
</a><a href="#h4-1-123" id="h4-1-123" class="d">-                labels: [
</a><a href="#h4-1-124" id="h4-1-124" class="d">-                    None,
</a><a href="#h4-1-125" id="h4-1-125" class="d">-                    None,
</a><a href="#h4-1-126" id="h4-1-126" class="d">-                    None,
</a><a href="#h4-1-127" id="h4-1-127" class="d">-                    None,
</a><a href="#h4-1-128" id="h4-1-128" class="d">-                    None,
</a><a href="#h4-1-129" id="h4-1-129" class="d">-                ],
</a><a href="#h4-1-130" id="h4-1-130" class="d">-            },
</a><a href="#h4-1-131" id="h4-1-131" class="i">+            source: Nothing,
</a>             aggregates: [
                 Min,
                 Max,
<b>diff --git a/<a id="h5" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -3,8 +3,7 @@ Query: SELECT MIN(id), MAX(id), SUM(id), COUNT(id), AVG(id) FROM movies WHERE FA
</a> Explain:
 Projection: #0, #1, #2, #3, #4
 └─ Aggregation: min, max, sum, count, avg
<a href="#h5-0-3" id="h5-0-3" class="d">-   └─ Projection: id, id, id, id, id, id
</a><a href="#h5-0-4" id="h5-0-4" class="d">-      └─ Scan: movies (FALSE)
</a><a href="#h5-0-5" id="h5-0-5" class="i">+   └─ Nothing
</a> 
 Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 
<a href="#h5-1" id="h5-1" class="h">@@ -286,141 +285,7 @@ Plan: Select {
</a> Optimized plan: Select {
     root: Projection {
         source: Aggregation {
<a href="#h5-1-3" id="h5-1-3" class="d">-            source: Projection {
</a><a href="#h5-1-4" id="h5-1-4" class="d">-                source: Scan {
</a><a href="#h5-1-5" id="h5-1-5" class="d">-                    table: Table {
</a><a href="#h5-1-6" id="h5-1-6" class="d">-                        name: &quot;movies&quot;,
</a><a href="#h5-1-7" id="h5-1-7" class="d">-                        primary_key: 0,
</a><a href="#h5-1-8" id="h5-1-8" class="d">-                        columns: [
</a><a href="#h5-1-9" id="h5-1-9" class="d">-                            Column {
</a><a href="#h5-1-10" id="h5-1-10" class="d">-                                name: &quot;id&quot;,
</a><a href="#h5-1-11" id="h5-1-11" class="d">-                                datatype: Integer,
</a><a href="#h5-1-12" id="h5-1-12" class="d">-                                nullable: false,
</a><a href="#h5-1-13" id="h5-1-13" class="d">-                                default: None,
</a><a href="#h5-1-14" id="h5-1-14" class="d">-                                unique: true,
</a><a href="#h5-1-15" id="h5-1-15" class="d">-                                index: false,
</a><a href="#h5-1-16" id="h5-1-16" class="d">-                                references: None,
</a><a href="#h5-1-17" id="h5-1-17" class="d">-                            },
</a><a href="#h5-1-18" id="h5-1-18" class="d">-                            Column {
</a><a href="#h5-1-19" id="h5-1-19" class="d">-                                name: &quot;title&quot;,
</a><a href="#h5-1-20" id="h5-1-20" class="d">-                                datatype: String,
</a><a href="#h5-1-21" id="h5-1-21" class="d">-                                nullable: false,
</a><a href="#h5-1-22" id="h5-1-22" class="d">-                                default: None,
</a><a href="#h5-1-23" id="h5-1-23" class="d">-                                unique: false,
</a><a href="#h5-1-24" id="h5-1-24" class="d">-                                index: false,
</a><a href="#h5-1-25" id="h5-1-25" class="d">-                                references: None,
</a><a href="#h5-1-26" id="h5-1-26" class="d">-                            },
</a><a href="#h5-1-27" id="h5-1-27" class="d">-                            Column {
</a><a href="#h5-1-28" id="h5-1-28" class="d">-                                name: &quot;studio_id&quot;,
</a><a href="#h5-1-29" id="h5-1-29" class="d">-                                datatype: Integer,
</a><a href="#h5-1-30" id="h5-1-30" class="d">-                                nullable: false,
</a><a href="#h5-1-31" id="h5-1-31" class="d">-                                default: None,
</a><a href="#h5-1-32" id="h5-1-32" class="d">-                                unique: false,
</a><a href="#h5-1-33" id="h5-1-33" class="d">-                                index: true,
</a><a href="#h5-1-34" id="h5-1-34" class="d">-                                references: Some(
</a><a href="#h5-1-35" id="h5-1-35" class="d">-                                    &quot;studios&quot;,
</a><a href="#h5-1-36" id="h5-1-36" class="d">-                                ),
</a><a href="#h5-1-37" id="h5-1-37" class="d">-                            },
</a><a href="#h5-1-38" id="h5-1-38" class="d">-                            Column {
</a><a href="#h5-1-39" id="h5-1-39" class="d">-                                name: &quot;genre_id&quot;,
</a><a href="#h5-1-40" id="h5-1-40" class="d">-                                datatype: Integer,
</a><a href="#h5-1-41" id="h5-1-41" class="d">-                                nullable: false,
</a><a href="#h5-1-42" id="h5-1-42" class="d">-                                default: None,
</a><a href="#h5-1-43" id="h5-1-43" class="d">-                                unique: false,
</a><a href="#h5-1-44" id="h5-1-44" class="d">-                                index: true,
</a><a href="#h5-1-45" id="h5-1-45" class="d">-                                references: Some(
</a><a href="#h5-1-46" id="h5-1-46" class="d">-                                    &quot;genres&quot;,
</a><a href="#h5-1-47" id="h5-1-47" class="d">-                                ),
</a><a href="#h5-1-48" id="h5-1-48" class="d">-                            },
</a><a href="#h5-1-49" id="h5-1-49" class="d">-                            Column {
</a><a href="#h5-1-50" id="h5-1-50" class="d">-                                name: &quot;released&quot;,
</a><a href="#h5-1-51" id="h5-1-51" class="d">-                                datatype: Integer,
</a><a href="#h5-1-52" id="h5-1-52" class="d">-                                nullable: false,
</a><a href="#h5-1-53" id="h5-1-53" class="d">-                                default: None,
</a><a href="#h5-1-54" id="h5-1-54" class="d">-                                unique: false,
</a><a href="#h5-1-55" id="h5-1-55" class="d">-                                index: false,
</a><a href="#h5-1-56" id="h5-1-56" class="d">-                                references: None,
</a><a href="#h5-1-57" id="h5-1-57" class="d">-                            },
</a><a href="#h5-1-58" id="h5-1-58" class="d">-                            Column {
</a><a href="#h5-1-59" id="h5-1-59" class="d">-                                name: &quot;rating&quot;,
</a><a href="#h5-1-60" id="h5-1-60" class="d">-                                datatype: Float,
</a><a href="#h5-1-61" id="h5-1-61" class="d">-                                nullable: true,
</a><a href="#h5-1-62" id="h5-1-62" class="d">-                                default: Some(
</a><a href="#h5-1-63" id="h5-1-63" class="d">-                                    Null,
</a><a href="#h5-1-64" id="h5-1-64" class="d">-                                ),
</a><a href="#h5-1-65" id="h5-1-65" class="d">-                                unique: false,
</a><a href="#h5-1-66" id="h5-1-66" class="d">-                                index: false,
</a><a href="#h5-1-67" id="h5-1-67" class="d">-                                references: None,
</a><a href="#h5-1-68" id="h5-1-68" class="d">-                            },
</a><a href="#h5-1-69" id="h5-1-69" class="d">-                            Column {
</a><a href="#h5-1-70" id="h5-1-70" class="d">-                                name: &quot;ultrahd&quot;,
</a><a href="#h5-1-71" id="h5-1-71" class="d">-                                datatype: Boolean,
</a><a href="#h5-1-72" id="h5-1-72" class="d">-                                nullable: true,
</a><a href="#h5-1-73" id="h5-1-73" class="d">-                                default: Some(
</a><a href="#h5-1-74" id="h5-1-74" class="d">-                                    Null,
</a><a href="#h5-1-75" id="h5-1-75" class="d">-                                ),
</a><a href="#h5-1-76" id="h5-1-76" class="d">-                                unique: false,
</a><a href="#h5-1-77" id="h5-1-77" class="d">-                                index: false,
</a><a href="#h5-1-78" id="h5-1-78" class="d">-                                references: None,
</a><a href="#h5-1-79" id="h5-1-79" class="d">-                            },
</a><a href="#h5-1-80" id="h5-1-80" class="d">-                        ],
</a><a href="#h5-1-81" id="h5-1-81" class="d">-                    },
</a><a href="#h5-1-82" id="h5-1-82" class="d">-                    filter: Some(
</a><a href="#h5-1-83" id="h5-1-83" class="d">-                        Constant(
</a><a href="#h5-1-84" id="h5-1-84" class="d">-                            Boolean(
</a><a href="#h5-1-85" id="h5-1-85" class="d">-                                false,
</a><a href="#h5-1-86" id="h5-1-86" class="d">-                            ),
</a><a href="#h5-1-87" id="h5-1-87" class="d">-                        ),
</a><a href="#h5-1-88" id="h5-1-88" class="d">-                    ),
</a><a href="#h5-1-89" id="h5-1-89" class="d">-                    alias: None,
</a><a href="#h5-1-90" id="h5-1-90" class="d">-                },
</a><a href="#h5-1-91" id="h5-1-91" class="d">-                expressions: [
</a><a href="#h5-1-92" id="h5-1-92" class="d">-                    Field(
</a><a href="#h5-1-93" id="h5-1-93" class="d">-                        0,
</a><a href="#h5-1-94" id="h5-1-94" class="d">-                        Unqualified(
</a><a href="#h5-1-95" id="h5-1-95" class="d">-                            &quot;id&quot;,
</a><a href="#h5-1-96" id="h5-1-96" class="d">-                        ),
</a><a href="#h5-1-97" id="h5-1-97" class="d">-                    ),
</a><a href="#h5-1-98" id="h5-1-98" class="d">-                    Field(
</a><a href="#h5-1-99" id="h5-1-99" class="d">-                        0,
</a><a href="#h5-1-100" id="h5-1-100" class="d">-                        Unqualified(
</a><a href="#h5-1-101" id="h5-1-101" class="d">-                            &quot;id&quot;,
</a><a href="#h5-1-102" id="h5-1-102" class="d">-                        ),
</a><a href="#h5-1-103" id="h5-1-103" class="d">-                    ),
</a><a href="#h5-1-104" id="h5-1-104" class="d">-                    Field(
</a><a href="#h5-1-105" id="h5-1-105" class="d">-                        0,
</a><a href="#h5-1-106" id="h5-1-106" class="d">-                        Unqualified(
</a><a href="#h5-1-107" id="h5-1-107" class="d">-                            &quot;id&quot;,
</a><a href="#h5-1-108" id="h5-1-108" class="d">-                        ),
</a><a href="#h5-1-109" id="h5-1-109" class="d">-                    ),
</a><a href="#h5-1-110" id="h5-1-110" class="d">-                    Field(
</a><a href="#h5-1-111" id="h5-1-111" class="d">-                        0,
</a><a href="#h5-1-112" id="h5-1-112" class="d">-                        Unqualified(
</a><a href="#h5-1-113" id="h5-1-113" class="d">-                            &quot;id&quot;,
</a><a href="#h5-1-114" id="h5-1-114" class="d">-                        ),
</a><a href="#h5-1-115" id="h5-1-115" class="d">-                    ),
</a><a href="#h5-1-116" id="h5-1-116" class="d">-                    Field(
</a><a href="#h5-1-117" id="h5-1-117" class="d">-                        0,
</a><a href="#h5-1-118" id="h5-1-118" class="d">-                        Unqualified(
</a><a href="#h5-1-119" id="h5-1-119" class="d">-                            &quot;id&quot;,
</a><a href="#h5-1-120" id="h5-1-120" class="d">-                        ),
</a><a href="#h5-1-121" id="h5-1-121" class="d">-                    ),
</a><a href="#h5-1-122" id="h5-1-122" class="d">-                    Field(
</a><a href="#h5-1-123" id="h5-1-123" class="d">-                        0,
</a><a href="#h5-1-124" id="h5-1-124" class="d">-                        Unqualified(
</a><a href="#h5-1-125" id="h5-1-125" class="d">-                            &quot;id&quot;,
</a><a href="#h5-1-126" id="h5-1-126" class="d">-                        ),
</a><a href="#h5-1-127" id="h5-1-127" class="d">-                    ),
</a><a href="#h5-1-128" id="h5-1-128" class="d">-                ],
</a><a href="#h5-1-129" id="h5-1-129" class="d">-                labels: [
</a><a href="#h5-1-130" id="h5-1-130" class="d">-                    None,
</a><a href="#h5-1-131" id="h5-1-131" class="d">-                    None,
</a><a href="#h5-1-132" id="h5-1-132" class="d">-                    None,
</a><a href="#h5-1-133" id="h5-1-133" class="d">-                    None,
</a><a href="#h5-1-134" id="h5-1-134" class="d">-                    None,
</a><a href="#h5-1-135" id="h5-1-135" class="d">-                    None,
</a><a href="#h5-1-136" id="h5-1-136" class="d">-                ],
</a><a href="#h5-1-137" id="h5-1-137" class="d">-            },
</a><a href="#h5-1-138" id="h5-1-138" class="i">+            source: Nothing,
</a>             aggregates: [
                 Min,
                 Max,
<b>diff --git a/<a id="h6" href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a> b/<a href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,9 +1,7 @@
</a> Query: SELECT * FROM movies INNER JOIN genres ON FALSE
 
 Explain:
<a href="#h6-0-3" id="h6-0-3" class="d">-NestedLoopJoin: inner
</a><a href="#h6-0-4" id="h6-0-4" class="d">-├─ Scan: movies (FALSE)
</a><a href="#h6-0-5" id="h6-0-5" class="d">-└─ Scan: genres
</a><a href="#h6-0-6" id="h6-0-6" class="i">+Nothing
</a> 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 
<a href="#h6-1" id="h6-1" class="h">@@ -200,127 +198,7 @@ Plan: Select {
</a> }
 
 Optimized plan: Select {
<a href="#h6-1-3" id="h6-1-3" class="d">-    root: NestedLoopJoin {
</a><a href="#h6-1-4" id="h6-1-4" class="d">-        left: Scan {
</a><a href="#h6-1-5" id="h6-1-5" class="d">-            table: Table {
</a><a href="#h6-1-6" id="h6-1-6" class="d">-                name: &quot;movies&quot;,
</a><a href="#h6-1-7" id="h6-1-7" class="d">-                primary_key: 0,
</a><a href="#h6-1-8" id="h6-1-8" class="d">-                columns: [
</a><a href="#h6-1-9" id="h6-1-9" class="d">-                    Column {
</a><a href="#h6-1-10" id="h6-1-10" class="d">-                        name: &quot;id&quot;,
</a><a href="#h6-1-11" id="h6-1-11" class="d">-                        datatype: Integer,
</a><a href="#h6-1-12" id="h6-1-12" class="d">-                        nullable: false,
</a><a href="#h6-1-13" id="h6-1-13" class="d">-                        default: None,
</a><a href="#h6-1-14" id="h6-1-14" class="d">-                        unique: true,
</a><a href="#h6-1-15" id="h6-1-15" class="d">-                        index: false,
</a><a href="#h6-1-16" id="h6-1-16" class="d">-                        references: None,
</a><a href="#h6-1-17" id="h6-1-17" class="d">-                    },
</a><a href="#h6-1-18" id="h6-1-18" class="d">-                    Column {
</a><a href="#h6-1-19" id="h6-1-19" class="d">-                        name: &quot;title&quot;,
</a><a href="#h6-1-20" id="h6-1-20" class="d">-                        datatype: String,
</a><a href="#h6-1-21" id="h6-1-21" class="d">-                        nullable: false,
</a><a href="#h6-1-22" id="h6-1-22" class="d">-                        default: None,
</a><a href="#h6-1-23" id="h6-1-23" class="d">-                        unique: false,
</a><a href="#h6-1-24" id="h6-1-24" class="d">-                        index: false,
</a><a href="#h6-1-25" id="h6-1-25" class="d">-                        references: None,
</a><a href="#h6-1-26" id="h6-1-26" class="d">-                    },
</a><a href="#h6-1-27" id="h6-1-27" class="d">-                    Column {
</a><a href="#h6-1-28" id="h6-1-28" class="d">-                        name: &quot;studio_id&quot;,
</a><a href="#h6-1-29" id="h6-1-29" class="d">-                        datatype: Integer,
</a><a href="#h6-1-30" id="h6-1-30" class="d">-                        nullable: false,
</a><a href="#h6-1-31" id="h6-1-31" class="d">-                        default: None,
</a><a href="#h6-1-32" id="h6-1-32" class="d">-                        unique: false,
</a><a href="#h6-1-33" id="h6-1-33" class="d">-                        index: true,
</a><a href="#h6-1-34" id="h6-1-34" class="d">-                        references: Some(
</a><a href="#h6-1-35" id="h6-1-35" class="d">-                            &quot;studios&quot;,
</a><a href="#h6-1-36" id="h6-1-36" class="d">-                        ),
</a><a href="#h6-1-37" id="h6-1-37" class="d">-                    },
</a><a href="#h6-1-38" id="h6-1-38" class="d">-                    Column {
</a><a href="#h6-1-39" id="h6-1-39" class="d">-                        name: &quot;genre_id&quot;,
</a><a href="#h6-1-40" id="h6-1-40" class="d">-                        datatype: Integer,
</a><a href="#h6-1-41" id="h6-1-41" class="d">-                        nullable: false,
</a><a href="#h6-1-42" id="h6-1-42" class="d">-                        default: None,
</a><a href="#h6-1-43" id="h6-1-43" class="d">-                        unique: false,
</a><a href="#h6-1-44" id="h6-1-44" class="d">-                        index: true,
</a><a href="#h6-1-45" id="h6-1-45" class="d">-                        references: Some(
</a><a href="#h6-1-46" id="h6-1-46" class="d">-                            &quot;genres&quot;,
</a><a href="#h6-1-47" id="h6-1-47" class="d">-                        ),
</a><a href="#h6-1-48" id="h6-1-48" class="d">-                    },
</a><a href="#h6-1-49" id="h6-1-49" class="d">-                    Column {
</a><a href="#h6-1-50" id="h6-1-50" class="d">-                        name: &quot;released&quot;,
</a><a href="#h6-1-51" id="h6-1-51" class="d">-                        datatype: Integer,
</a><a href="#h6-1-52" id="h6-1-52" class="d">-                        nullable: false,
</a><a href="#h6-1-53" id="h6-1-53" class="d">-                        default: None,
</a><a href="#h6-1-54" id="h6-1-54" class="d">-                        unique: false,
</a><a href="#h6-1-55" id="h6-1-55" class="d">-                        index: false,
</a><a href="#h6-1-56" id="h6-1-56" class="d">-                        references: None,
</a><a href="#h6-1-57" id="h6-1-57" class="d">-                    },
</a><a href="#h6-1-58" id="h6-1-58" class="d">-                    Column {
</a><a href="#h6-1-59" id="h6-1-59" class="d">-                        name: &quot;rating&quot;,
</a><a href="#h6-1-60" id="h6-1-60" class="d">-                        datatype: Float,
</a><a href="#h6-1-61" id="h6-1-61" class="d">-                        nullable: true,
</a><a href="#h6-1-62" id="h6-1-62" class="d">-                        default: Some(
</a><a href="#h6-1-63" id="h6-1-63" class="d">-                            Null,
</a><a href="#h6-1-64" id="h6-1-64" class="d">-                        ),
</a><a href="#h6-1-65" id="h6-1-65" class="d">-                        unique: false,
</a><a href="#h6-1-66" id="h6-1-66" class="d">-                        index: false,
</a><a href="#h6-1-67" id="h6-1-67" class="d">-                        references: None,
</a><a href="#h6-1-68" id="h6-1-68" class="d">-                    },
</a><a href="#h6-1-69" id="h6-1-69" class="d">-                    Column {
</a><a href="#h6-1-70" id="h6-1-70" class="d">-                        name: &quot;ultrahd&quot;,
</a><a href="#h6-1-71" id="h6-1-71" class="d">-                        datatype: Boolean,
</a><a href="#h6-1-72" id="h6-1-72" class="d">-                        nullable: true,
</a><a href="#h6-1-73" id="h6-1-73" class="d">-                        default: Some(
</a><a href="#h6-1-74" id="h6-1-74" class="d">-                            Null,
</a><a href="#h6-1-75" id="h6-1-75" class="d">-                        ),
</a><a href="#h6-1-76" id="h6-1-76" class="d">-                        unique: false,
</a><a href="#h6-1-77" id="h6-1-77" class="d">-                        index: false,
</a><a href="#h6-1-78" id="h6-1-78" class="d">-                        references: None,
</a><a href="#h6-1-79" id="h6-1-79" class="d">-                    },
</a><a href="#h6-1-80" id="h6-1-80" class="d">-                ],
</a><a href="#h6-1-81" id="h6-1-81" class="d">-            },
</a><a href="#h6-1-82" id="h6-1-82" class="d">-            filter: Some(
</a><a href="#h6-1-83" id="h6-1-83" class="d">-                Constant(
</a><a href="#h6-1-84" id="h6-1-84" class="d">-                    Boolean(
</a><a href="#h6-1-85" id="h6-1-85" class="d">-                        false,
</a><a href="#h6-1-86" id="h6-1-86" class="d">-                    ),
</a><a href="#h6-1-87" id="h6-1-87" class="d">-                ),
</a><a href="#h6-1-88" id="h6-1-88" class="d">-            ),
</a><a href="#h6-1-89" id="h6-1-89" class="d">-            alias: None,
</a><a href="#h6-1-90" id="h6-1-90" class="d">-        },
</a><a href="#h6-1-91" id="h6-1-91" class="d">-        left_size: 7,
</a><a href="#h6-1-92" id="h6-1-92" class="d">-        right: Scan {
</a><a href="#h6-1-93" id="h6-1-93" class="d">-            table: Table {
</a><a href="#h6-1-94" id="h6-1-94" class="d">-                name: &quot;genres&quot;,
</a><a href="#h6-1-95" id="h6-1-95" class="d">-                primary_key: 0,
</a><a href="#h6-1-96" id="h6-1-96" class="d">-                columns: [
</a><a href="#h6-1-97" id="h6-1-97" class="d">-                    Column {
</a><a href="#h6-1-98" id="h6-1-98" class="d">-                        name: &quot;id&quot;,
</a><a href="#h6-1-99" id="h6-1-99" class="d">-                        datatype: Integer,
</a><a href="#h6-1-100" id="h6-1-100" class="d">-                        nullable: false,
</a><a href="#h6-1-101" id="h6-1-101" class="d">-                        default: None,
</a><a href="#h6-1-102" id="h6-1-102" class="d">-                        unique: true,
</a><a href="#h6-1-103" id="h6-1-103" class="d">-                        index: false,
</a><a href="#h6-1-104" id="h6-1-104" class="d">-                        references: None,
</a><a href="#h6-1-105" id="h6-1-105" class="d">-                    },
</a><a href="#h6-1-106" id="h6-1-106" class="d">-                    Column {
</a><a href="#h6-1-107" id="h6-1-107" class="d">-                        name: &quot;name&quot;,
</a><a href="#h6-1-108" id="h6-1-108" class="d">-                        datatype: String,
</a><a href="#h6-1-109" id="h6-1-109" class="d">-                        nullable: false,
</a><a href="#h6-1-110" id="h6-1-110" class="d">-                        default: None,
</a><a href="#h6-1-111" id="h6-1-111" class="d">-                        unique: false,
</a><a href="#h6-1-112" id="h6-1-112" class="d">-                        index: false,
</a><a href="#h6-1-113" id="h6-1-113" class="d">-                        references: None,
</a><a href="#h6-1-114" id="h6-1-114" class="d">-                    },
</a><a href="#h6-1-115" id="h6-1-115" class="d">-                ],
</a><a href="#h6-1-116" id="h6-1-116" class="d">-            },
</a><a href="#h6-1-117" id="h6-1-117" class="d">-            filter: None,
</a><a href="#h6-1-118" id="h6-1-118" class="d">-            alias: None,
</a><a href="#h6-1-119" id="h6-1-119" class="d">-        },
</a><a href="#h6-1-120" id="h6-1-120" class="d">-        right_size: 2,
</a><a href="#h6-1-121" id="h6-1-121" class="d">-        predicate: None,
</a><a href="#h6-1-122" id="h6-1-122" class="d">-        outer: false,
</a><a href="#h6-1-123" id="h6-1-123" class="d">-    },
</a><a href="#h6-1-124" id="h6-1-124" class="i">+    root: Nothing,
</a>     labels: [
         Qualified(
             &quot;movies&quot;,
<b>diff --git a/<a id="h7" href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a> b/<a href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,7 +1,7 @@
</a> Query: SELECT * FROM movies WHERE FALSE
 
 Explain:
<a href="#h7-0-3" id="h7-0-3" class="d">-Scan: movies (FALSE)
</a><a href="#h7-0-4" id="h7-0-4" class="i">+Nothing
</a> 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 
<a href="#h7-1" id="h7-1" class="h">@@ -149,93 +149,7 @@ Plan: Select {
</a> }
 
 Optimized plan: Select {
<a href="#h7-1-3" id="h7-1-3" class="d">-    root: Scan {
</a><a href="#h7-1-4" id="h7-1-4" class="d">-        table: Table {
</a><a href="#h7-1-5" id="h7-1-5" class="d">-            name: &quot;movies&quot;,
</a><a href="#h7-1-6" id="h7-1-6" class="d">-            primary_key: 0,
</a><a href="#h7-1-7" id="h7-1-7" class="d">-            columns: [
</a><a href="#h7-1-8" id="h7-1-8" class="d">-                Column {
</a><a href="#h7-1-9" id="h7-1-9" class="d">-                    name: &quot;id&quot;,
</a><a href="#h7-1-10" id="h7-1-10" class="d">-                    datatype: Integer,
</a><a href="#h7-1-11" id="h7-1-11" class="d">-                    nullable: false,
</a><a href="#h7-1-12" id="h7-1-12" class="d">-                    default: None,
</a><a href="#h7-1-13" id="h7-1-13" class="d">-                    unique: true,
</a><a href="#h7-1-14" id="h7-1-14" class="d">-                    index: false,
</a><a href="#h7-1-15" id="h7-1-15" class="d">-                    references: None,
</a><a href="#h7-1-16" id="h7-1-16" class="d">-                },
</a><a href="#h7-1-17" id="h7-1-17" class="d">-                Column {
</a><a href="#h7-1-18" id="h7-1-18" class="d">-                    name: &quot;title&quot;,
</a><a href="#h7-1-19" id="h7-1-19" class="d">-                    datatype: String,
</a><a href="#h7-1-20" id="h7-1-20" class="d">-                    nullable: false,
</a><a href="#h7-1-21" id="h7-1-21" class="d">-                    default: None,
</a><a href="#h7-1-22" id="h7-1-22" class="d">-                    unique: false,
</a><a href="#h7-1-23" id="h7-1-23" class="d">-                    index: false,
</a><a href="#h7-1-24" id="h7-1-24" class="d">-                    references: None,
</a><a href="#h7-1-25" id="h7-1-25" class="d">-                },
</a><a href="#h7-1-26" id="h7-1-26" class="d">-                Column {
</a><a href="#h7-1-27" id="h7-1-27" class="d">-                    name: &quot;studio_id&quot;,
</a><a href="#h7-1-28" id="h7-1-28" class="d">-                    datatype: Integer,
</a><a href="#h7-1-29" id="h7-1-29" class="d">-                    nullable: false,
</a><a href="#h7-1-30" id="h7-1-30" class="d">-                    default: None,
</a><a href="#h7-1-31" id="h7-1-31" class="d">-                    unique: false,
</a><a href="#h7-1-32" id="h7-1-32" class="d">-                    index: true,
</a><a href="#h7-1-33" id="h7-1-33" class="d">-                    references: Some(
</a><a href="#h7-1-34" id="h7-1-34" class="d">-                        &quot;studios&quot;,
</a><a href="#h7-1-35" id="h7-1-35" class="d">-                    ),
</a><a href="#h7-1-36" id="h7-1-36" class="d">-                },
</a><a href="#h7-1-37" id="h7-1-37" class="d">-                Column {
</a><a href="#h7-1-38" id="h7-1-38" class="d">-                    name: &quot;genre_id&quot;,
</a><a href="#h7-1-39" id="h7-1-39" class="d">-                    datatype: Integer,
</a><a href="#h7-1-40" id="h7-1-40" class="d">-                    nullable: false,
</a><a href="#h7-1-41" id="h7-1-41" class="d">-                    default: None,
</a><a href="#h7-1-42" id="h7-1-42" class="d">-                    unique: false,
</a><a href="#h7-1-43" id="h7-1-43" class="d">-                    index: true,
</a><a href="#h7-1-44" id="h7-1-44" class="d">-                    references: Some(
</a><a href="#h7-1-45" id="h7-1-45" class="d">-                        &quot;genres&quot;,
</a><a href="#h7-1-46" id="h7-1-46" class="d">-                    ),
</a><a href="#h7-1-47" id="h7-1-47" class="d">-                },
</a><a href="#h7-1-48" id="h7-1-48" class="d">-                Column {
</a><a href="#h7-1-49" id="h7-1-49" class="d">-                    name: &quot;released&quot;,
</a><a href="#h7-1-50" id="h7-1-50" class="d">-                    datatype: Integer,
</a><a href="#h7-1-51" id="h7-1-51" class="d">-                    nullable: false,
</a><a href="#h7-1-52" id="h7-1-52" class="d">-                    default: None,
</a><a href="#h7-1-53" id="h7-1-53" class="d">-                    unique: false,
</a><a href="#h7-1-54" id="h7-1-54" class="d">-                    index: false,
</a><a href="#h7-1-55" id="h7-1-55" class="d">-                    references: None,
</a><a href="#h7-1-56" id="h7-1-56" class="d">-                },
</a><a href="#h7-1-57" id="h7-1-57" class="d">-                Column {
</a><a href="#h7-1-58" id="h7-1-58" class="d">-                    name: &quot;rating&quot;,
</a><a href="#h7-1-59" id="h7-1-59" class="d">-                    datatype: Float,
</a><a href="#h7-1-60" id="h7-1-60" class="d">-                    nullable: true,
</a><a href="#h7-1-61" id="h7-1-61" class="d">-                    default: Some(
</a><a href="#h7-1-62" id="h7-1-62" class="d">-                        Null,
</a><a href="#h7-1-63" id="h7-1-63" class="d">-                    ),
</a><a href="#h7-1-64" id="h7-1-64" class="d">-                    unique: false,
</a><a href="#h7-1-65" id="h7-1-65" class="d">-                    index: false,
</a><a href="#h7-1-66" id="h7-1-66" class="d">-                    references: None,
</a><a href="#h7-1-67" id="h7-1-67" class="d">-                },
</a><a href="#h7-1-68" id="h7-1-68" class="d">-                Column {
</a><a href="#h7-1-69" id="h7-1-69" class="d">-                    name: &quot;ultrahd&quot;,
</a><a href="#h7-1-70" id="h7-1-70" class="d">-                    datatype: Boolean,
</a><a href="#h7-1-71" id="h7-1-71" class="d">-                    nullable: true,
</a><a href="#h7-1-72" id="h7-1-72" class="d">-                    default: Some(
</a><a href="#h7-1-73" id="h7-1-73" class="d">-                        Null,
</a><a href="#h7-1-74" id="h7-1-74" class="d">-                    ),
</a><a href="#h7-1-75" id="h7-1-75" class="d">-                    unique: false,
</a><a href="#h7-1-76" id="h7-1-76" class="d">-                    index: false,
</a><a href="#h7-1-77" id="h7-1-77" class="d">-                    references: None,
</a><a href="#h7-1-78" id="h7-1-78" class="d">-                },
</a><a href="#h7-1-79" id="h7-1-79" class="d">-            ],
</a><a href="#h7-1-80" id="h7-1-80" class="d">-        },
</a><a href="#h7-1-81" id="h7-1-81" class="d">-        filter: Some(
</a><a href="#h7-1-82" id="h7-1-82" class="d">-            Constant(
</a><a href="#h7-1-83" id="h7-1-83" class="d">-                Boolean(
</a><a href="#h7-1-84" id="h7-1-84" class="d">-                    false,
</a><a href="#h7-1-85" id="h7-1-85" class="d">-                ),
</a><a href="#h7-1-86" id="h7-1-86" class="d">-            ),
</a><a href="#h7-1-87" id="h7-1-87" class="d">-        ),
</a><a href="#h7-1-88" id="h7-1-88" class="d">-        alias: None,
</a><a href="#h7-1-89" id="h7-1-89" class="d">-    },
</a><a href="#h7-1-90" id="h7-1-90" class="i">+    root: Nothing,
</a>     labels: [
         Qualified(
             &quot;movies&quot;,
<b>diff --git a/<a id="h8" href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a> b/<a href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -1,7 +1,7 @@
</a> Query: SELECT * FROM movies WHERE NULL
 
 Explain:
<a href="#h8-0-3" id="h8-0-3" class="d">-Scan: movies (NULL)
</a><a href="#h8-0-4" id="h8-0-4" class="i">+Nothing
</a> 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 
<a href="#h8-1" id="h8-1" class="h">@@ -145,91 +145,7 @@ Plan: Select {
</a> }
 
 Optimized plan: Select {
<a href="#h8-1-3" id="h8-1-3" class="d">-    root: Scan {
</a><a href="#h8-1-4" id="h8-1-4" class="d">-        table: Table {
</a><a href="#h8-1-5" id="h8-1-5" class="d">-            name: &quot;movies&quot;,
</a><a href="#h8-1-6" id="h8-1-6" class="d">-            primary_key: 0,
</a><a href="#h8-1-7" id="h8-1-7" class="d">-            columns: [
</a><a href="#h8-1-8" id="h8-1-8" class="d">-                Column {
</a><a href="#h8-1-9" id="h8-1-9" class="d">-                    name: &quot;id&quot;,
</a><a href="#h8-1-10" id="h8-1-10" class="d">-                    datatype: Integer,
</a><a href="#h8-1-11" id="h8-1-11" class="d">-                    nullable: false,
</a><a href="#h8-1-12" id="h8-1-12" class="d">-                    default: None,
</a><a href="#h8-1-13" id="h8-1-13" class="d">-                    unique: true,
</a><a href="#h8-1-14" id="h8-1-14" class="d">-                    index: false,
</a><a href="#h8-1-15" id="h8-1-15" class="d">-                    references: None,
</a><a href="#h8-1-16" id="h8-1-16" class="d">-                },
</a><a href="#h8-1-17" id="h8-1-17" class="d">-                Column {
</a><a href="#h8-1-18" id="h8-1-18" class="d">-                    name: &quot;title&quot;,
</a><a href="#h8-1-19" id="h8-1-19" class="d">-                    datatype: String,
</a><a href="#h8-1-20" id="h8-1-20" class="d">-                    nullable: false,
</a><a href="#h8-1-21" id="h8-1-21" class="d">-                    default: None,
</a><a href="#h8-1-22" id="h8-1-22" class="d">-                    unique: false,
</a><a href="#h8-1-23" id="h8-1-23" class="d">-                    index: false,
</a><a href="#h8-1-24" id="h8-1-24" class="d">-                    references: None,
</a><a href="#h8-1-25" id="h8-1-25" class="d">-                },
</a><a href="#h8-1-26" id="h8-1-26" class="d">-                Column {
</a><a href="#h8-1-27" id="h8-1-27" class="d">-                    name: &quot;studio_id&quot;,
</a><a href="#h8-1-28" id="h8-1-28" class="d">-                    datatype: Integer,
</a><a href="#h8-1-29" id="h8-1-29" class="d">-                    nullable: false,
</a><a href="#h8-1-30" id="h8-1-30" class="d">-                    default: None,
</a><a href="#h8-1-31" id="h8-1-31" class="d">-                    unique: false,
</a><a href="#h8-1-32" id="h8-1-32" class="d">-                    index: true,
</a><a href="#h8-1-33" id="h8-1-33" class="d">-                    references: Some(
</a><a href="#h8-1-34" id="h8-1-34" class="d">-                        &quot;studios&quot;,
</a><a href="#h8-1-35" id="h8-1-35" class="d">-                    ),
</a><a href="#h8-1-36" id="h8-1-36" class="d">-                },
</a><a href="#h8-1-37" id="h8-1-37" class="d">-                Column {
</a><a href="#h8-1-38" id="h8-1-38" class="d">-                    name: &quot;genre_id&quot;,
</a><a href="#h8-1-39" id="h8-1-39" class="d">-                    datatype: Integer,
</a><a href="#h8-1-40" id="h8-1-40" class="d">-                    nullable: false,
</a><a href="#h8-1-41" id="h8-1-41" class="d">-                    default: None,
</a><a href="#h8-1-42" id="h8-1-42" class="d">-                    unique: false,
</a><a href="#h8-1-43" id="h8-1-43" class="d">-                    index: true,
</a><a href="#h8-1-44" id="h8-1-44" class="d">-                    references: Some(
</a><a href="#h8-1-45" id="h8-1-45" class="d">-                        &quot;genres&quot;,
</a><a href="#h8-1-46" id="h8-1-46" class="d">-                    ),
</a><a href="#h8-1-47" id="h8-1-47" class="d">-                },
</a><a href="#h8-1-48" id="h8-1-48" class="d">-                Column {
</a><a href="#h8-1-49" id="h8-1-49" class="d">-                    name: &quot;released&quot;,
</a><a href="#h8-1-50" id="h8-1-50" class="d">-                    datatype: Integer,
</a><a href="#h8-1-51" id="h8-1-51" class="d">-                    nullable: false,
</a><a href="#h8-1-52" id="h8-1-52" class="d">-                    default: None,
</a><a href="#h8-1-53" id="h8-1-53" class="d">-                    unique: false,
</a><a href="#h8-1-54" id="h8-1-54" class="d">-                    index: false,
</a><a href="#h8-1-55" id="h8-1-55" class="d">-                    references: None,
</a><a href="#h8-1-56" id="h8-1-56" class="d">-                },
</a><a href="#h8-1-57" id="h8-1-57" class="d">-                Column {
</a><a href="#h8-1-58" id="h8-1-58" class="d">-                    name: &quot;rating&quot;,
</a><a href="#h8-1-59" id="h8-1-59" class="d">-                    datatype: Float,
</a><a href="#h8-1-60" id="h8-1-60" class="d">-                    nullable: true,
</a><a href="#h8-1-61" id="h8-1-61" class="d">-                    default: Some(
</a><a href="#h8-1-62" id="h8-1-62" class="d">-                        Null,
</a><a href="#h8-1-63" id="h8-1-63" class="d">-                    ),
</a><a href="#h8-1-64" id="h8-1-64" class="d">-                    unique: false,
</a><a href="#h8-1-65" id="h8-1-65" class="d">-                    index: false,
</a><a href="#h8-1-66" id="h8-1-66" class="d">-                    references: None,
</a><a href="#h8-1-67" id="h8-1-67" class="d">-                },
</a><a href="#h8-1-68" id="h8-1-68" class="d">-                Column {
</a><a href="#h8-1-69" id="h8-1-69" class="d">-                    name: &quot;ultrahd&quot;,
</a><a href="#h8-1-70" id="h8-1-70" class="d">-                    datatype: Boolean,
</a><a href="#h8-1-71" id="h8-1-71" class="d">-                    nullable: true,
</a><a href="#h8-1-72" id="h8-1-72" class="d">-                    default: Some(
</a><a href="#h8-1-73" id="h8-1-73" class="d">-                        Null,
</a><a href="#h8-1-74" id="h8-1-74" class="d">-                    ),
</a><a href="#h8-1-75" id="h8-1-75" class="d">-                    unique: false,
</a><a href="#h8-1-76" id="h8-1-76" class="d">-                    index: false,
</a><a href="#h8-1-77" id="h8-1-77" class="d">-                    references: None,
</a><a href="#h8-1-78" id="h8-1-78" class="d">-                },
</a><a href="#h8-1-79" id="h8-1-79" class="d">-            ],
</a><a href="#h8-1-80" id="h8-1-80" class="d">-        },
</a><a href="#h8-1-81" id="h8-1-81" class="d">-        filter: Some(
</a><a href="#h8-1-82" id="h8-1-82" class="d">-            Constant(
</a><a href="#h8-1-83" id="h8-1-83" class="d">-                Null,
</a><a href="#h8-1-84" id="h8-1-84" class="d">-            ),
</a><a href="#h8-1-85" id="h8-1-85" class="d">-        ),
</a><a href="#h8-1-86" id="h8-1-86" class="d">-        alias: None,
</a><a href="#h8-1-87" id="h8-1-87" class="d">-    },
</a><a href="#h8-1-88" id="h8-1-88" class="i">+    root: Nothing,
</a>     labels: [
         Qualified(
             &quot;movies&quot;,
</pre>
</div>
</body>
</html>
