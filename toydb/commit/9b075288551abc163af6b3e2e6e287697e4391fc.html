<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: clean up planner module - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/9b075288551abc163af6b3e2e6e287697e4391fc.html">9b075288551abc163af6b3e2e6e287697e4391fc</a>
<b>parent</b> <a href="../commit/91501dc9af6970d159abd0fddf40b3e0b6c43a7d.html">91501dc9af6970d159abd0fddf40b3e0b6c43a7d</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Fri, 21 Jun 2024 17:46:34 +0200

sql: clean up planner module

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/engine/session.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/execution/execute.rs</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/parser/ast.rs</a></td><td> | </td><td class="num">13</td><td><span class="i">+++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/planner/plan.rs</a></td><td> | </td><td class="num">38</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/planner/planner.rs</a></td><td> | </td><td class="num">950</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/types/value.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">tests/sql/query/agg_boolean</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">tests/sql/query/agg_boolean_null</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">tests/sql/query/agg_const</a></td><td> | </td><td class="num">84</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">tests/sql/query/agg_const_from</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">tests/sql/query/agg_count_star</a></td><td> | </td><td class="num">46</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">tests/sql/query/agg_expr</a></td><td> | </td><td class="num">50</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">----------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query/agg_float</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/query/agg_float_null</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/agg_integer</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/agg_integer_null</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">92</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/agg_string</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/agg_string_null</a></td><td> | </td><td class="num">88</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/all</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/as_</a></td><td> | </td><td class="num">178</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/as_duplicate</a></td><td> | </td><td class="num">68</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/expr_mixed</a></td><td> | </td><td class="num">70</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/expr_static</a></td><td> | </td><td class="num">54</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/field_aliased</a></td><td> | </td><td class="num">72</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/field_multi</a></td><td> | </td><td class="num">68</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/field_qualified</a></td><td> | </td><td class="num">48</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/field_qualified_multi</a></td><td> | </td><td class="num">72</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/field_single</a></td><td> | </td><td class="num">48</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/field_unknown_qualified</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/from_multiple</a></td><td> | </td><td class="num">204</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/group_expr</a></td><td> | </td><td class="num">74</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/group_expr_aggr</a></td><td> | </td><td class="num">74</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/query/group_expr_aggr_selfref</a></td><td> | </td><td class="num">74</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/query/group_expr_aliased</a></td><td> | </td><td class="num">108</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/query/group_expr_both</a></td><td> | </td><td class="num">88</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/query/group_expr_multigroup</a></td><td> | </td><td class="num">122</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/query/group_expr_select</a></td><td> | </td><td class="num">88</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/query/group_join</a></td><td> | </td><td class="num">74</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/query/group_noaggregate</a></td><td> | </td><td class="num">60</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">tests/sql/query/group_noselect</a></td><td> | </td><td class="num">74</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">tests/sql/query/group_simple</a></td><td> | </td><td class="num">72</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">tests/sql/query/having</a></td><td> | </td><td class="num">102</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">96</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">104</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">122</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">tests/sql/query/having_nogroup</a></td><td> | </td><td class="num">88</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">82</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">tests/sql/query/join_cross</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">162</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">tests/sql/query/join_cross_multi</a></td><td> | </td><td class="num">256</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">tests/sql/query/join_inner</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">tests/sql/query/join_inner_implicit</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">tests/sql/query/join_inner_index_transverse</a></td><td> | </td><td class="num">164</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">tests/sql/query/join_inner_index_transverse_where</a></td><td> | </td><td class="num">164</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">tests/sql/query/join_inner_multi</a></td><td> | </td><td class="num">128</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">122</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">tests/sql/query/join_inner_multi_same</a></td><td> | </td><td class="num">208</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">tests/sql/query/join_inner_on_aliased</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">tests/sql/query/join_inner_on_false</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">tests/sql/query/join_inner_on_multi</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">tests/sql/query/join_inner_on_true</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">tests/sql/query/join_inner_on_where</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">tests/sql/query/join_left</a></td><td> | </td><td class="num">104</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">tests/sql/query/join_left_all</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">tests/sql/query/join_left_outer</a></td><td> | </td><td class="num">104</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">tests/sql/query/join_left_truncate</a></td><td> | </td><td class="num">104</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">tests/sql/query/join_right</a></td><td> | </td><td class="num">148</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">tests/sql/query/join_right_all</a></td><td> | </td><td class="num">212</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">tests/sql/query/join_right_outer</a></td><td> | </td><td class="num">148</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">tests/sql/query/join_right_truncate</a></td><td> | </td><td class="num">148</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">tests/sql/query/limit</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">tests/sql/query/limit_expr</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">tests/sql/query/limit_large</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">tests/sql/query/limit_offset</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">tests/sql/query/limit_zero</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h77">tests/sql/query/lowercase</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h78">tests/sql/query/offset</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h79">tests/sql/query/offset_expr</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h80">tests/sql/query/offset_large</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h81">tests/sql/query/offset_zero</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h82">tests/sql/query/order</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h83">tests/sql/query/order_aggregate</a></td><td> | </td><td class="num">72</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h84">tests/sql/query/order_aggregate_noselect</a></td><td> | </td><td class="num">96</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h85">tests/sql/query/order_asc</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h86">tests/sql/query/order_asc_lowercase</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h87">tests/sql/query/order_boolean_asc</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h88">tests/sql/query/order_boolean_desc</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h89">tests/sql/query/order_desc</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h90">tests/sql/query/order_desc_lowercase</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h91">tests/sql/query/order_expr</a></td><td> | </td><td class="num">124</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h92">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">108</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h93">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">120</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h94">tests/sql/query/order_float_asc</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h95">tests/sql/query/order_float_desc</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h96">tests/sql/query/order_group_by_noselect</a></td><td> | </td><td class="num">68</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h97">tests/sql/query/order_integer_asc</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h98">tests/sql/query/order_integer_desc</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h99">tests/sql/query/order_multi</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h100">tests/sql/query/order_noselect</a></td><td> | </td><td class="num">88</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h101">tests/sql/query/order_string_asc</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h102">tests/sql/query/order_string_desc</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h103">tests/sql/query/where_expr</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h104">tests/sql/query/where_false</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h105">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">74</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h106">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">70</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h107">tests/sql/query/where_float</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h108">tests/sql/query/where_index</a></td><td> | </td><td class="num">130</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h109">tests/sql/query/where_index_or</a></td><td> | </td><td class="num">130</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h110">tests/sql/query/where_index_or_partial</a></td><td> | </td><td class="num">130</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h111">tests/sql/query/where_integer</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h112">tests/sql/query/where_join_inner</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h113">tests/sql/query/where_null</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h114">tests/sql/query/where_pk</a></td><td> | </td><td class="num">130</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h115">tests/sql/query/where_pk_or</a></td><td> | </td><td class="num">130</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h116">tests/sql/query/where_pk_or_partial</a></td><td> | </td><td class="num">130</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h117">tests/sql/query/where_string</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h118">tests/sql/query/where_true</a></td><td> | </td><td class="num">132</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
</table></pre><pre>119 files changed, 10520 insertions(+), 2972 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/engine/session.rs.html">src/sql/engine/session.rs</a> b/<a href="../file/src/sql/engine/session.rs.html">src/sql/engine/session.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -154,9 +154,9 @@ impl TryFrom&lt;ExecutionResult&gt; for StatementResult {
</a>             ExecutionResult::Delete { count } =&gt; Self::Delete { count },
             ExecutionResult::Insert { count } =&gt; Self::Insert { count },
             ExecutionResult::Update { count } =&gt; Self::Update { count },
<a href="#h0-0-3" id="h0-0-3" class="d">-            ExecutionResult::Select { iter } =&gt; {
</a><a href="#h0-0-4" id="h0-0-4" class="i">+            ExecutionResult::Select { iter, labels } =&gt; {
</a>                 // We buffer the entire set of rows, for simplicity.
<a href="#h0-0-6" id="h0-0-6" class="d">-                Self::Select { columns: iter.columns, rows: iter.rows.collect::&lt;Result&lt;_&gt;&gt;()? }
</a><a href="#h0-0-7" id="h0-0-7" class="i">+                Self::Select { columns: labels, rows: iter.rows.collect::&lt;Result&lt;_&gt;&gt;()? }
</a>             }
         })
     }
<b>diff --git a/<a id="h1" href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a> b/<a href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -41,7 +41,10 @@ pub fn execute_plan(
</a>             ExecutionResult::Insert { count }
         }
 
<a href="#h1-0-3" id="h1-0-3" class="d">-        Plan::Select(node) =&gt; ExecutionResult::Select { iter: execute(node, txn)? },
</a><a href="#h1-0-4" id="h1-0-4" class="i">+        Plan::Select { root, labels } =&gt; {
</a><a href="#h1-0-5" id="h1-0-5" class="i">+            let iter = execute(root, txn)?;
</a><a href="#h1-0-6" id="h1-0-6" class="i">+            ExecutionResult::Select { iter, labels }
</a><a href="#h1-0-7" id="h1-0-7" class="i">+        }
</a> 
         Plan::Update { table, primary_key, source, expressions } =&gt; {
             let source = execute(source, txn)?;
<a href="#h1-1" id="h1-1" class="h">@@ -120,12 +123,12 @@ pub enum ExecutionResult {
</a>     Delete { count: u64 },
     Insert { count: u64 },
     Update { count: u64 },
<a href="#h1-1-3" id="h1-1-3" class="d">-    Select { iter: QueryIterator },
</a><a href="#h1-1-4" id="h1-1-4" class="i">+    Select { iter: QueryIterator, labels: Vec&lt;Option&lt;Label&gt;&gt; },
</a> }
 
 /// A query result iterator, containing the columns and row iterator.
 ///
<a href="#h1-1-9" id="h1-1-9" class="d">-/// TODO: if we resolve labels during planning, we can replace this with a
</a><a href="#h1-1-10" id="h1-1-10" class="i">+/// TODO: now that we resolve labels during planning, we can replace this with a
</a> /// simple Rows iterator. We can probably also make that generic instead of a
 /// trait object, since we know the type when calling each executor.
 pub struct QueryIterator {
<b>diff --git a/<a id="h2" href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a> b/<a href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -76,6 +76,17 @@ pub enum JoinType {
</a>     Right,
 }
 
<a href="#h2-0-3" id="h2-0-3" class="i">+impl JoinType {
</a><a href="#h2-0-4" id="h2-0-4" class="i">+    // If true, the join is an outer join -- rows with no join match are emitted
</a><a href="#h2-0-5" id="h2-0-5" class="i">+    // with a NULL match.
</a><a href="#h2-0-6" id="h2-0-6" class="i">+    pub fn is_outer(&amp;self) -&gt; bool {
</a><a href="#h2-0-7" id="h2-0-7" class="i">+        match self {
</a><a href="#h2-0-8" id="h2-0-8" class="i">+            Self::Left | Self::Right =&gt; true,
</a><a href="#h2-0-9" id="h2-0-9" class="i">+            Self::Cross | Self::Inner =&gt; false,
</a><a href="#h2-0-10" id="h2-0-10" class="i">+        }
</a><a href="#h2-0-11" id="h2-0-11" class="i">+    }
</a><a href="#h2-0-12" id="h2-0-12" class="i">+}
</a><a href="#h2-0-13" id="h2-0-13" class="i">+
</a> /// Sort orders.
 #[derive(Debug)]
 pub enum Order {
<a href="#h2-1" id="h2-1" class="h">@@ -144,6 +155,8 @@ pub enum Operator {
</a> impl Expression {
     /// Transforms the expression tree depth-first by applying a closure before
     /// and after descending.
<a href="#h2-1-3" id="h2-1-3" class="i">+    ///
</a><a href="#h2-1-4" id="h2-1-4" class="i">+    /// TODO: make closures non-mut.
</a>     pub fn transform&lt;B, A&gt;(mut self, before: &amp;mut B, after: &amp;mut A) -&gt; Result&lt;Self&gt;
     where
         B: FnMut(Self) -&gt; Result&lt;Self&gt;,
<b>diff --git a/<a id="h3" href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a> b/<a href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -45,8 +45,8 @@ pub enum Plan {
</a>         expressions: Vec&lt;(usize, String, Expression)&gt;,
     },
     /// A SELECT plan. Recursively executes the query plan tree and returns the
<a href="#h3-0-3" id="h3-0-3" class="d">-    /// resulting rows.
</a><a href="#h3-0-4" id="h3-0-4" class="d">-    Select(Node),
</a><a href="#h3-0-5" id="h3-0-5" class="i">+    /// resulting rows. Also includes the output column labels.
</a><a href="#h3-0-6" id="h3-0-6" class="i">+    Select { root: Node, labels: Vec&lt;Option&lt;Label&gt;&gt; },
</a> }
 
 impl Plan {
<a href="#h3-1" id="h3-1" class="h">@@ -78,7 +78,7 @@ impl Plan {
</a>             Self::Update { table, primary_key, source, expressions } =&gt; {
                 Self::Update { table, primary_key, source: optimize(source)?, expressions }
             }
<a href="#h3-1-3" id="h3-1-3" class="d">-            Self::Select(root) =&gt; Self::Select(optimize(root)?),
</a><a href="#h3-1-4" id="h3-1-4" class="i">+            Self::Select { root, labels } =&gt; Self::Select { root: optimize(root)?, labels },
</a>         })
     }
 }
<a href="#h3-2" id="h3-2" class="h">@@ -132,11 +132,14 @@ pub enum Node {
</a>     /// the entire row set in memory.
     Order { source: Box&lt;Node&gt;, orders: Vec&lt;(Expression, Direction)&gt; },
     /// Projects the input rows by evaluating the given expressions.
<a href="#h3-2-3" id="h3-2-3" class="d">-    Projection { source: Box&lt;Node&gt;, labels: Vec&lt;Option&lt;Label&gt;&gt;, expressions: Vec&lt;Expression&gt; },
</a><a href="#h3-2-4" id="h3-2-4" class="d">-    /// A full table scan, with an optional filter pushdown.
</a><a href="#h3-2-5" id="h3-2-5" class="d">-    Scan { table: Table, alias: Option&lt;String&gt;, filter: Option&lt;Expression&gt; },
</a><a href="#h3-2-6" id="h3-2-6" class="i">+    /// The labels are only used when displaying the plan.
</a><a href="#h3-2-7" id="h3-2-7" class="i">+    Projection { source: Box&lt;Node&gt;, expressions: Vec&lt;Expression&gt;, labels: Vec&lt;Option&lt;Label&gt;&gt; },
</a><a href="#h3-2-8" id="h3-2-8" class="i">+    /// A full table scan, with an optional filter pushdown. The alias is only
</a><a href="#h3-2-9" id="h3-2-9" class="i">+    /// used when displaying the plan.
</a><a href="#h3-2-10" id="h3-2-10" class="i">+    Scan { table: Table, filter: Option&lt;Expression&gt;, alias: Option&lt;String&gt; },
</a>     /// A constant set of values.
<a href="#h3-2-12" id="h3-2-12" class="d">-    Values { labels: Vec&lt;Option&lt;Label&gt;&gt;, rows: Vec&lt;Vec&lt;Expression&gt;&gt; },
</a><a href="#h3-2-13" id="h3-2-13" class="i">+    /// TODO: get rid of the labels.
</a><a href="#h3-2-14" id="h3-2-14" class="i">+    Values { rows: Vec&lt;Vec&lt;Expression&gt;&gt;, labels: Vec&lt;Option&lt;Label&gt;&gt; },
</a> }
 
 impl Node {
<a href="#h3-3" id="h3-3" class="h">@@ -272,7 +275,7 @@ impl std::fmt::Display for Plan {
</a>                 write!(f, &quot;Update: {table} ({expressions})&quot;)?;
                 source.format(f, String::new(), false, true)
             }
<a href="#h3-3-3" id="h3-3-3" class="d">-            Self::Select(root) =&gt; root.fmt(f),
</a><a href="#h3-3-4" id="h3-3-4" class="i">+            Self::Select { root, .. } =&gt; root.fmt(f),
</a>         }
     }
 }
<a href="#h3-4" id="h3-4" class="h">@@ -419,15 +422,28 @@ pub enum Aggregate {
</a> impl std::fmt::Display for Aggregate {
     fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {
         match self {
<a href="#h3-4-3" id="h3-4-3" class="d">-            Self::Average =&gt; write!(f, &quot;average&quot;),
</a><a href="#h3-4-4" id="h3-4-4" class="i">+            Self::Average =&gt; write!(f, &quot;avg&quot;),
</a>             Self::Count =&gt; write!(f, &quot;count&quot;),
<a href="#h3-4-6" id="h3-4-6" class="d">-            Self::Max =&gt; write!(f, &quot;maximum&quot;),
</a><a href="#h3-4-7" id="h3-4-7" class="d">-            Self::Min =&gt; write!(f, &quot;minimum&quot;),
</a><a href="#h3-4-8" id="h3-4-8" class="i">+            Self::Max =&gt; write!(f, &quot;max&quot;),
</a><a href="#h3-4-9" id="h3-4-9" class="i">+            Self::Min =&gt; write!(f, &quot;min&quot;),
</a>             Self::Sum =&gt; write!(f, &quot;sum&quot;),
         }
     }
 }
 
<a href="#h3-4-15" id="h3-4-15" class="i">+impl Aggregate {
</a><a href="#h3-4-16" id="h3-4-16" class="i">+    pub(super) fn from_name(name: &amp;str) -&gt; Option&lt;Self&gt; {
</a><a href="#h3-4-17" id="h3-4-17" class="i">+        match name {
</a><a href="#h3-4-18" id="h3-4-18" class="i">+            &quot;avg&quot; =&gt; Some(Aggregate::Average),
</a><a href="#h3-4-19" id="h3-4-19" class="i">+            &quot;count&quot; =&gt; Some(Aggregate::Count),
</a><a href="#h3-4-20" id="h3-4-20" class="i">+            &quot;max&quot; =&gt; Some(Aggregate::Max),
</a><a href="#h3-4-21" id="h3-4-21" class="i">+            &quot;min&quot; =&gt; Some(Aggregate::Min),
</a><a href="#h3-4-22" id="h3-4-22" class="i">+            &quot;sum&quot; =&gt; Some(Aggregate::Sum),
</a><a href="#h3-4-23" id="h3-4-23" class="i">+            _ =&gt; None,
</a><a href="#h3-4-24" id="h3-4-24" class="i">+        }
</a><a href="#h3-4-25" id="h3-4-25" class="i">+    }
</a><a href="#h3-4-26" id="h3-4-26" class="i">+}
</a><a href="#h3-4-27" id="h3-4-27" class="i">+
</a> /// A sort order direction.
 #[derive(Debug, PartialEq, Serialize, Deserialize)]
 pub enum Direction {
<b>diff --git a/<a id="h4" href="../file/src/sql/planner/planner.rs.html">src/sql/planner/planner.rs</a> b/<a href="../file/src/sql/planner/planner.rs.html">src/sql/planner/planner.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -1,16 +1,17 @@
</a> #![allow(clippy::module_inception)]
 
<a href="#h4-0-2" id="h4-0-2" class="d">-use super::super::parser::ast;
</a><a href="#h4-0-3" id="h4-0-3" class="d">-use super::{plan::Node, plan::Plan, Aggregate, Direction};
</a><a href="#h4-0-4" id="h4-0-4" class="i">+use super::{Aggregate, Direction, Node, Plan};
</a> use crate::errinput;
 use crate::error::Result;
 use crate::sql::engine::Catalog;
<a href="#h4-0-8" id="h4-0-8" class="i">+use crate::sql::parser::ast;
</a> use crate::sql::types::{Column, Expression, Label, Table, Value};
 
<a href="#h4-0-11" id="h4-0-11" class="d">-use std::collections::{HashMap, HashSet};
</a><a href="#h4-0-12" id="h4-0-12" class="d">-use std::mem::replace;
</a><a href="#h4-0-13" id="h4-0-13" class="i">+use itertools::Itertools as _;
</a><a href="#h4-0-14" id="h4-0-14" class="i">+use std::collections::{BTreeMap, HashMap, HashSet};
</a> 
<a href="#h4-0-16" id="h4-0-16" class="d">-/// A query plan builder.
</a><a href="#h4-0-17" id="h4-0-17" class="i">+/// A statement plan builder. Takes a statement AST from the parser and builds
</a><a href="#h4-0-18" id="h4-0-18" class="i">+/// an execution plan for it, using the catalog for schema information.
</a> pub struct Planner&lt;&#39;a, C: Catalog&gt; {
     catalog: &amp;&#39;a C,
 }
<a href="#h4-1" id="h4-1" class="h">@@ -23,269 +24,275 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a> 
     /// Builds a plan for an AST statement.
     pub fn build(&amp;mut self, statement: ast::Statement) -&gt; Result&lt;Plan&gt; {
<a href="#h4-1-3" id="h4-1-3" class="d">-        self.build_statement(statement)
</a><a href="#h4-1-4" id="h4-1-4" class="d">-    }
</a><a href="#h4-1-5" id="h4-1-5" class="d">-
</a><a href="#h4-1-6" id="h4-1-6" class="d">-    /// Builds a plan for a statement.
</a><a href="#h4-1-7" id="h4-1-7" class="d">-    fn build_statement(&amp;self, statement: ast::Statement) -&gt; Result&lt;Plan&gt; {
</a><a href="#h4-1-8" id="h4-1-8" class="d">-        Ok(match statement {
</a><a href="#h4-1-9" id="h4-1-9" class="d">-            // Transaction control and explain statements should have been handled by session.
</a><a href="#h4-1-10" id="h4-1-10" class="d">-            ast::Statement::Begin { .. } | ast::Statement::Commit | ast::Statement::Rollback =&gt; {
</a><a href="#h4-1-11" id="h4-1-11" class="d">-                panic!(&quot;unexpected transaction statement {statement:?}&quot;)
</a><a href="#h4-1-12" id="h4-1-12" class="d">-            }
</a><a href="#h4-1-13" id="h4-1-13" class="d">-
</a><a href="#h4-1-14" id="h4-1-14" class="d">-            ast::Statement::Explain(_) =&gt; panic!(&quot;unexpected explain statement&quot;),
</a><a href="#h4-1-15" id="h4-1-15" class="d">-
</a><a href="#h4-1-16" id="h4-1-16" class="d">-            // DDL statements (schema changes).
</a><a href="#h4-1-17" id="h4-1-17" class="d">-            ast::Statement::CreateTable { name, columns } =&gt; {
</a><a href="#h4-1-18" id="h4-1-18" class="d">-                let Some(primary_key) = columns.iter().position(|c| c.primary_key) else {
</a><a href="#h4-1-19" id="h4-1-19" class="d">-                    return errinput!(&quot;no primary key for table {name}&quot;);
</a><a href="#h4-1-20" id="h4-1-20" class="d">-                };
</a><a href="#h4-1-21" id="h4-1-21" class="d">-                if columns.iter().filter(|c| c.primary_key).count() &gt; 1 {
</a><a href="#h4-1-22" id="h4-1-22" class="d">-                    return errinput!(&quot;multiple primary keys for table {name}&quot;);
</a><a href="#h4-1-23" id="h4-1-23" class="d">-                }
</a><a href="#h4-1-24" id="h4-1-24" class="d">-                let columns = columns
</a><a href="#h4-1-25" id="h4-1-25" class="d">-                    .into_iter()
</a><a href="#h4-1-26" id="h4-1-26" class="d">-                    .map(|c| {
</a><a href="#h4-1-27" id="h4-1-27" class="d">-                        let nullable = c.nullable.unwrap_or(!c.primary_key);
</a><a href="#h4-1-28" id="h4-1-28" class="d">-                        Ok(Column {
</a><a href="#h4-1-29" id="h4-1-29" class="d">-                            name: c.name,
</a><a href="#h4-1-30" id="h4-1-30" class="d">-                            datatype: c.datatype,
</a><a href="#h4-1-31" id="h4-1-31" class="d">-                            nullable,
</a><a href="#h4-1-32" id="h4-1-32" class="d">-                            default: match c.default {
</a><a href="#h4-1-33" id="h4-1-33" class="d">-                                Some(expr) =&gt; Some(self.evaluate_constant(expr)?),
</a><a href="#h4-1-34" id="h4-1-34" class="d">-                                None if nullable =&gt; Some(Value::Null),
</a><a href="#h4-1-35" id="h4-1-35" class="d">-                                None =&gt; None,
</a><a href="#h4-1-36" id="h4-1-36" class="d">-                            },
</a><a href="#h4-1-37" id="h4-1-37" class="d">-                            unique: c.unique || c.primary_key,
</a><a href="#h4-1-38" id="h4-1-38" class="d">-                            index: (c.index || c.unique || c.references.is_some())
</a><a href="#h4-1-39" id="h4-1-39" class="d">-                                &amp;&amp; !c.primary_key,
</a><a href="#h4-1-40" id="h4-1-40" class="d">-                            references: c.references,
</a><a href="#h4-1-41" id="h4-1-41" class="d">-                        })
</a><a href="#h4-1-42" id="h4-1-42" class="d">-                    })
</a><a href="#h4-1-43" id="h4-1-43" class="d">-                    .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h4-1-44" id="h4-1-44" class="d">-                Plan::CreateTable { schema: Table { name, primary_key, columns } }
</a><a href="#h4-1-45" id="h4-1-45" class="i">+        use ast::Statement::*;
</a><a href="#h4-1-46" id="h4-1-46" class="i">+        match statement {
</a><a href="#h4-1-47" id="h4-1-47" class="i">+            CreateTable { name, columns } =&gt; self.build_create_table(name, columns),
</a><a href="#h4-1-48" id="h4-1-48" class="i">+            DropTable { name, if_exists } =&gt; Ok(Plan::DropTable { table: name, if_exists }),
</a><a href="#h4-1-49" id="h4-1-49" class="i">+            Delete { table, r#where } =&gt; self.build_delete(table, r#where),
</a><a href="#h4-1-50" id="h4-1-50" class="i">+            Insert { table, columns, values } =&gt; self.build_insert(table, columns, values),
</a><a href="#h4-1-51" id="h4-1-51" class="i">+            Update { table, set, r#where } =&gt; self.build_update(table, set, r#where),
</a><a href="#h4-1-52" id="h4-1-52" class="i">+            Select { select, from, r#where, group_by, having, order, offset, limit } =&gt; {
</a><a href="#h4-1-53" id="h4-1-53" class="i">+                self.build_select(select, from, r#where, group_by, having, order, offset, limit)
</a>             }
 
<a href="#h4-1-56" id="h4-1-56" class="d">-            ast::Statement::DropTable { name, if_exists } =&gt; {
</a><a href="#h4-1-57" id="h4-1-57" class="d">-                Plan::DropTable { table: name, if_exists }
</a><a href="#h4-1-58" id="h4-1-58" class="i">+            // Transaction and explain statements are handled by Session.
</a><a href="#h4-1-59" id="h4-1-59" class="i">+            Begin { .. } | Commit | Rollback | Explain(_) =&gt; {
</a><a href="#h4-1-60" id="h4-1-60" class="i">+                panic!(&quot;unexpected statement {statement:?}&quot;)
</a>             }
<a href="#h4-1-62" id="h4-1-62" class="i">+        }
</a><a href="#h4-1-63" id="h4-1-63" class="i">+    }
</a> 
<a href="#h4-1-65" id="h4-1-65" class="d">-            // DML statements (mutations).
</a><a href="#h4-1-66" id="h4-1-66" class="d">-            ast::Statement::Delete { table, r#where } =&gt; {
</a><a href="#h4-1-67" id="h4-1-67" class="d">-                let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h4-1-68" id="h4-1-68" class="d">-                let scope = &amp;mut Scope::from_table(table.clone())?;
</a><a href="#h4-1-69" id="h4-1-69" class="d">-                Plan::Delete {
</a><a href="#h4-1-70" id="h4-1-70" class="d">-                    table: table.name.clone(),
</a><a href="#h4-1-71" id="h4-1-71" class="d">-                    primary_key: table.primary_key,
</a><a href="#h4-1-72" id="h4-1-72" class="d">-                    source: Node::Scan {
</a><a href="#h4-1-73" id="h4-1-73" class="d">-                        table,
</a><a href="#h4-1-74" id="h4-1-74" class="d">-                        alias: None,
</a><a href="#h4-1-75" id="h4-1-75" class="d">-                        filter: r#where.map(|e| self.build_expression(scope, e)).transpose()?,
</a><a href="#h4-1-76" id="h4-1-76" class="i">+    /// Builds a CREATE TABLE plan.
</a><a href="#h4-1-77" id="h4-1-77" class="i">+    fn build_create_table(&amp;self, name: String, columns: Vec&lt;ast::Column&gt;) -&gt; Result&lt;Plan&gt; {
</a><a href="#h4-1-78" id="h4-1-78" class="i">+        let Some(primary_key) = columns.iter().position(|c| c.primary_key) else {
</a><a href="#h4-1-79" id="h4-1-79" class="i">+            return errinput!(&quot;no primary key for table {name}&quot;);
</a><a href="#h4-1-80" id="h4-1-80" class="i">+        };
</a><a href="#h4-1-81" id="h4-1-81" class="i">+        if columns.iter().filter(|c| c.primary_key).count() &gt; 1 {
</a><a href="#h4-1-82" id="h4-1-82" class="i">+            return errinput!(&quot;multiple primary keys for table {name}&quot;);
</a><a href="#h4-1-83" id="h4-1-83" class="i">+        }
</a><a href="#h4-1-84" id="h4-1-84" class="i">+        let columns = columns
</a><a href="#h4-1-85" id="h4-1-85" class="i">+            .into_iter()
</a><a href="#h4-1-86" id="h4-1-86" class="i">+            .map(|c| {
</a><a href="#h4-1-87" id="h4-1-87" class="i">+                let nullable = c.nullable.unwrap_or(!c.primary_key);
</a><a href="#h4-1-88" id="h4-1-88" class="i">+                Ok(Column {
</a><a href="#h4-1-89" id="h4-1-89" class="i">+                    name: c.name,
</a><a href="#h4-1-90" id="h4-1-90" class="i">+                    datatype: c.datatype,
</a><a href="#h4-1-91" id="h4-1-91" class="i">+                    nullable,
</a><a href="#h4-1-92" id="h4-1-92" class="i">+                    default: match c.default {
</a><a href="#h4-1-93" id="h4-1-93" class="i">+                        Some(expr) =&gt; Some(Self::evaluate_constant(expr)?),
</a><a href="#h4-1-94" id="h4-1-94" class="i">+                        None if nullable =&gt; Some(Value::Null),
</a><a href="#h4-1-95" id="h4-1-95" class="i">+                        None =&gt; None,
</a>                     },
<a href="#h4-1-97" id="h4-1-97" class="d">-                }
</a><a href="#h4-1-98" id="h4-1-98" class="d">-            }
</a><a href="#h4-1-99" id="h4-1-99" class="i">+                    unique: c.unique || c.primary_key,
</a><a href="#h4-1-100" id="h4-1-100" class="i">+                    index: (c.index || c.unique || c.references.is_some()) &amp;&amp; !c.primary_key,
</a><a href="#h4-1-101" id="h4-1-101" class="i">+                    references: c.references,
</a><a href="#h4-1-102" id="h4-1-102" class="i">+                })
</a><a href="#h4-1-103" id="h4-1-103" class="i">+            })
</a><a href="#h4-1-104" id="h4-1-104" class="i">+            .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h4-1-105" id="h4-1-105" class="i">+        Ok(Plan::CreateTable { schema: Table { name, primary_key, columns } })
</a><a href="#h4-1-106" id="h4-1-106" class="i">+    }
</a> 
<a href="#h4-1-108" id="h4-1-108" class="d">-            ast::Statement::Insert { table, columns, values } =&gt; {
</a><a href="#h4-1-109" id="h4-1-109" class="d">-                let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h4-1-110" id="h4-1-110" class="d">-                let mut column_map = None;
</a><a href="#h4-1-111" id="h4-1-111" class="d">-                if let Some(columns) = columns {
</a><a href="#h4-1-112" id="h4-1-112" class="d">-                    let column_map = column_map.insert(HashMap::new());
</a><a href="#h4-1-113" id="h4-1-113" class="d">-                    for (vidx, name) in columns.into_iter().enumerate() {
</a><a href="#h4-1-114" id="h4-1-114" class="d">-                        let Some(cidx) = table.columns.iter().position(|c| c.name == name) else {
</a><a href="#h4-1-115" id="h4-1-115" class="d">-                            return errinput!(&quot;unknown column {name} in table {}&quot;, table.name);
</a><a href="#h4-1-116" id="h4-1-116" class="d">-                        };
</a><a href="#h4-1-117" id="h4-1-117" class="d">-                        if column_map.insert(cidx, vidx).is_some() {
</a><a href="#h4-1-118" id="h4-1-118" class="d">-                            return errinput!(&quot;column {name} given multiple times&quot;);
</a><a href="#h4-1-119" id="h4-1-119" class="d">-                        }
</a><a href="#h4-1-120" id="h4-1-120" class="d">-                    }
</a><a href="#h4-1-121" id="h4-1-121" class="d">-                }
</a><a href="#h4-1-122" id="h4-1-122" class="d">-                let labels = vec![None; values.len()];
</a><a href="#h4-1-123" id="h4-1-123" class="d">-                let rows = values
</a><a href="#h4-1-124" id="h4-1-124" class="d">-                    .into_iter()
</a><a href="#h4-1-125" id="h4-1-125" class="d">-                    .map(|exprs| {
</a><a href="#h4-1-126" id="h4-1-126" class="d">-                        exprs
</a><a href="#h4-1-127" id="h4-1-127" class="d">-                            .into_iter()
</a><a href="#h4-1-128" id="h4-1-128" class="d">-                            .map(|expr| self.build_expression(&amp;mut Scope::constant(), expr))
</a><a href="#h4-1-129" id="h4-1-129" class="d">-                            .collect::&lt;Result&lt;_&gt;&gt;()
</a><a href="#h4-1-130" id="h4-1-130" class="d">-                    })
</a><a href="#h4-1-131" id="h4-1-131" class="d">-                    .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h4-1-132" id="h4-1-132" class="d">-                Plan::Insert { table, column_map, source: Node::Values { labels, rows } }
</a><a href="#h4-1-133" id="h4-1-133" class="d">-            }
</a><a href="#h4-1-134" id="h4-1-134" class="i">+    /// Builds a DELETE plan.
</a><a href="#h4-1-135" id="h4-1-135" class="i">+    fn build_delete(&amp;self, table: String, r#where: Option&lt;ast::Expression&gt;) -&gt; Result&lt;Plan&gt; {
</a><a href="#h4-1-136" id="h4-1-136" class="i">+        let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h4-1-137" id="h4-1-137" class="i">+        let scope = Scope::from_table(&amp;table)?;
</a><a href="#h4-1-138" id="h4-1-138" class="i">+        let filter = r#where.map(|e| Self::build_expression(e, &amp;scope)).transpose()?;
</a><a href="#h4-1-139" id="h4-1-139" class="i">+        Ok(Plan::Delete {
</a><a href="#h4-1-140" id="h4-1-140" class="i">+            table: table.name.clone(),
</a><a href="#h4-1-141" id="h4-1-141" class="i">+            primary_key: table.primary_key,
</a><a href="#h4-1-142" id="h4-1-142" class="i">+            source: Node::Scan { table, alias: None, filter },
</a><a href="#h4-1-143" id="h4-1-143" class="i">+        })
</a><a href="#h4-1-144" id="h4-1-144" class="i">+    }
</a> 
<a href="#h4-1-146" id="h4-1-146" class="d">-            ast::Statement::Update { table, set, r#where } =&gt; {
</a><a href="#h4-1-147" id="h4-1-147" class="d">-                let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h4-1-148" id="h4-1-148" class="d">-                let scope = &amp;mut Scope::from_table(table.clone())?;
</a><a href="#h4-1-149" id="h4-1-149" class="d">-                Plan::Update {
</a><a href="#h4-1-150" id="h4-1-150" class="d">-                    table: table.name.clone(),
</a><a href="#h4-1-151" id="h4-1-151" class="d">-                    primary_key: table.primary_key,
</a><a href="#h4-1-152" id="h4-1-152" class="d">-                    source: Node::Scan {
</a><a href="#h4-1-153" id="h4-1-153" class="d">-                        table,
</a><a href="#h4-1-154" id="h4-1-154" class="d">-                        alias: None,
</a><a href="#h4-1-155" id="h4-1-155" class="d">-                        filter: r#where.map(|e| self.build_expression(scope, e)).transpose()?,
</a><a href="#h4-1-156" id="h4-1-156" class="d">-                    },
</a><a href="#h4-1-157" id="h4-1-157" class="d">-                    expressions: set
</a><a href="#h4-1-158" id="h4-1-158" class="d">-                        .into_iter()
</a><a href="#h4-1-159" id="h4-1-159" class="d">-                        .map(|(c, e)| {
</a><a href="#h4-1-160" id="h4-1-160" class="d">-                            Ok((scope.resolve(None, &amp;c)?, c, self.build_expression(scope, e)?))
</a><a href="#h4-1-161" id="h4-1-161" class="d">-                        })
</a><a href="#h4-1-162" id="h4-1-162" class="d">-                        .collect::&lt;Result&lt;_&gt;&gt;()?,
</a><a href="#h4-1-163" id="h4-1-163" class="i">+    /// Builds an INSERT plan.
</a><a href="#h4-1-164" id="h4-1-164" class="i">+    fn build_insert(
</a><a href="#h4-1-165" id="h4-1-165" class="i">+        &amp;self,
</a><a href="#h4-1-166" id="h4-1-166" class="i">+        table: String,
</a><a href="#h4-1-167" id="h4-1-167" class="i">+        columns: Option&lt;Vec&lt;String&gt;&gt;,
</a><a href="#h4-1-168" id="h4-1-168" class="i">+        values: Vec&lt;Vec&lt;ast::Expression&gt;&gt;,
</a><a href="#h4-1-169" id="h4-1-169" class="i">+    ) -&gt; Result&lt;Plan&gt; {
</a><a href="#h4-1-170" id="h4-1-170" class="i">+        let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h4-1-171" id="h4-1-171" class="i">+        let mut column_map = None;
</a><a href="#h4-1-172" id="h4-1-172" class="i">+        if let Some(columns) = columns {
</a><a href="#h4-1-173" id="h4-1-173" class="i">+            let column_map = column_map.insert(HashMap::new());
</a><a href="#h4-1-174" id="h4-1-174" class="i">+            for (vidx, name) in columns.into_iter().enumerate() {
</a><a href="#h4-1-175" id="h4-1-175" class="i">+                let Some(cidx) = table.columns.iter().position(|c| c.name == name) else {
</a><a href="#h4-1-176" id="h4-1-176" class="i">+                    return errinput!(&quot;unknown column {name} in table {}&quot;, table.name);
</a><a href="#h4-1-177" id="h4-1-177" class="i">+                };
</a><a href="#h4-1-178" id="h4-1-178" class="i">+                if column_map.insert(cidx, vidx).is_some() {
</a><a href="#h4-1-179" id="h4-1-179" class="i">+                    return errinput!(&quot;column {name} given multiple times&quot;);
</a>                 }
             }
<a href="#h4-1-182" id="h4-1-182" class="i">+        }
</a><a href="#h4-1-183" id="h4-1-183" class="i">+        let labels = vec![None; values.len()];
</a><a href="#h4-1-184" id="h4-1-184" class="i">+        let scope = Scope::new();
</a><a href="#h4-1-185" id="h4-1-185" class="i">+        let rows = values
</a><a href="#h4-1-186" id="h4-1-186" class="i">+            .into_iter()
</a><a href="#h4-1-187" id="h4-1-187" class="i">+            .map(|exprs| {
</a><a href="#h4-1-188" id="h4-1-188" class="i">+                exprs.into_iter().map(|expr| Self::build_expression(expr, &amp;scope)).collect()
</a><a href="#h4-1-189" id="h4-1-189" class="i">+            })
</a><a href="#h4-1-190" id="h4-1-190" class="i">+            .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h4-1-191" id="h4-1-191" class="i">+        Ok(Plan::Insert { table, column_map, source: Node::Values { labels, rows } })
</a><a href="#h4-1-192" id="h4-1-192" class="i">+    }
</a> 
<a href="#h4-1-194" id="h4-1-194" class="d">-            // Queries.
</a><a href="#h4-1-195" id="h4-1-195" class="d">-            ast::Statement::Select {
</a><a href="#h4-1-196" id="h4-1-196" class="d">-                mut select,
</a><a href="#h4-1-197" id="h4-1-197" class="d">-                from,
</a><a href="#h4-1-198" id="h4-1-198" class="d">-                r#where,
</a><a href="#h4-1-199" id="h4-1-199" class="d">-                group_by,
</a><a href="#h4-1-200" id="h4-1-200" class="d">-                mut having,
</a><a href="#h4-1-201" id="h4-1-201" class="d">-                mut order,
</a><a href="#h4-1-202" id="h4-1-202" class="d">-                offset,
</a><a href="#h4-1-203" id="h4-1-203" class="d">-                limit,
</a><a href="#h4-1-204" id="h4-1-204" class="d">-            } =&gt; {
</a><a href="#h4-1-205" id="h4-1-205" class="d">-                let scope = &amp;mut Scope::new();
</a><a href="#h4-1-206" id="h4-1-206" class="d">-
</a><a href="#h4-1-207" id="h4-1-207" class="d">-                // Build FROM clause.
</a><a href="#h4-1-208" id="h4-1-208" class="d">-                let mut node = if !from.is_empty() {
</a><a href="#h4-1-209" id="h4-1-209" class="d">-                    self.build_from_clause(scope, from)?
</a><a href="#h4-1-210" id="h4-1-210" class="d">-                } else if select.is_empty() {
</a><a href="#h4-1-211" id="h4-1-211" class="d">-                    return errinput!(&quot;can&#39;t select * without a table&quot;);
</a><a href="#h4-1-212" id="h4-1-212" class="d">-                } else {
</a><a href="#h4-1-213" id="h4-1-213" class="d">-                    Node::Nothing
</a><a href="#h4-1-214" id="h4-1-214" class="d">-                };
</a><a href="#h4-1-215" id="h4-1-215" class="d">-
</a><a href="#h4-1-216" id="h4-1-216" class="d">-                // Build WHERE clause.
</a><a href="#h4-1-217" id="h4-1-217" class="d">-                if let Some(expr) = r#where {
</a><a href="#h4-1-218" id="h4-1-218" class="d">-                    node = Node::Filter {
</a><a href="#h4-1-219" id="h4-1-219" class="d">-                        source: Box::new(node),
</a><a href="#h4-1-220" id="h4-1-220" class="d">-                        predicate: self.build_expression(scope, expr)?,
</a><a href="#h4-1-221" id="h4-1-221" class="d">-                    };
</a><a href="#h4-1-222" id="h4-1-222" class="d">-                };
</a><a href="#h4-1-223" id="h4-1-223" class="i">+    /// Builds an UPDATE plan.
</a><a href="#h4-1-224" id="h4-1-224" class="i">+    fn build_update(
</a><a href="#h4-1-225" id="h4-1-225" class="i">+        &amp;self,
</a><a href="#h4-1-226" id="h4-1-226" class="i">+        table: String,
</a><a href="#h4-1-227" id="h4-1-227" class="i">+        set: BTreeMap&lt;String, ast::Expression&gt;,
</a><a href="#h4-1-228" id="h4-1-228" class="i">+        r#where: Option&lt;ast::Expression&gt;,
</a><a href="#h4-1-229" id="h4-1-229" class="i">+    ) -&gt; Result&lt;Plan&gt; {
</a><a href="#h4-1-230" id="h4-1-230" class="i">+        let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h4-1-231" id="h4-1-231" class="i">+        let scope = Scope::from_table(&amp;table)?;
</a><a href="#h4-1-232" id="h4-1-232" class="i">+        let filter = r#where.map(|e| Self::build_expression(e, &amp;scope)).transpose()?;
</a><a href="#h4-1-233" id="h4-1-233" class="i">+        let expressions = set
</a><a href="#h4-1-234" id="h4-1-234" class="i">+            .into_iter()
</a><a href="#h4-1-235" id="h4-1-235" class="i">+            .map(|(c, e)| {
</a><a href="#h4-1-236" id="h4-1-236" class="i">+                Ok((scope.get_column_index(None, &amp;c)?, c, Self::build_expression(e, &amp;scope)?))
</a><a href="#h4-1-237" id="h4-1-237" class="i">+            })
</a><a href="#h4-1-238" id="h4-1-238" class="i">+            .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h4-1-239" id="h4-1-239" class="i">+        Ok(Plan::Update {
</a><a href="#h4-1-240" id="h4-1-240" class="i">+            table: table.name.clone(),
</a><a href="#h4-1-241" id="h4-1-241" class="i">+            primary_key: table.primary_key,
</a><a href="#h4-1-242" id="h4-1-242" class="i">+            source: Node::Scan { table, alias: None, filter },
</a><a href="#h4-1-243" id="h4-1-243" class="i">+            expressions,
</a><a href="#h4-1-244" id="h4-1-244" class="i">+        })
</a><a href="#h4-1-245" id="h4-1-245" class="i">+    }
</a> 
<a href="#h4-1-247" id="h4-1-247" class="d">-                // Build SELECT clause.
</a><a href="#h4-1-248" id="h4-1-248" class="d">-                let mut hidden = 0;
</a><a href="#h4-1-249" id="h4-1-249" class="d">-                if !select.is_empty() {
</a><a href="#h4-1-250" id="h4-1-250" class="d">-                    // Inject hidden SELECT columns for fields and aggregates used in ORDER BY and
</a><a href="#h4-1-251" id="h4-1-251" class="d">-                    // HAVING expressions but not present in existing SELECT output. These will be
</a><a href="#h4-1-252" id="h4-1-252" class="d">-                    // removed again by a later projection.
</a><a href="#h4-1-253" id="h4-1-253" class="d">-                    if let Some(ref mut expr) = having {
</a><a href="#h4-1-254" id="h4-1-254" class="d">-                        hidden += self.inject_hidden(expr, &amp;mut select)?;
</a><a href="#h4-1-255" id="h4-1-255" class="d">-                    }
</a><a href="#h4-1-256" id="h4-1-256" class="d">-                    for (expr, _) in order.iter_mut() {
</a><a href="#h4-1-257" id="h4-1-257" class="d">-                        hidden += self.inject_hidden(expr, &amp;mut select)?;
</a><a href="#h4-1-258" id="h4-1-258" class="d">-                    }
</a><a href="#h4-1-259" id="h4-1-259" class="i">+    /// Builds a SELECT plan.
</a><a href="#h4-1-260" id="h4-1-260" class="i">+    #[allow(clippy::too_many_arguments)]
</a><a href="#h4-1-261" id="h4-1-261" class="i">+    fn build_select(
</a><a href="#h4-1-262" id="h4-1-262" class="i">+        &amp;self,
</a><a href="#h4-1-263" id="h4-1-263" class="i">+        mut select: Vec&lt;(ast::Expression, Option&lt;String&gt;)&gt;,
</a><a href="#h4-1-264" id="h4-1-264" class="i">+        from: Vec&lt;ast::From&gt;,
</a><a href="#h4-1-265" id="h4-1-265" class="i">+        r#where: Option&lt;ast::Expression&gt;,
</a><a href="#h4-1-266" id="h4-1-266" class="i">+        group_by: Vec&lt;ast::Expression&gt;,
</a><a href="#h4-1-267" id="h4-1-267" class="i">+        mut having: Option&lt;ast::Expression&gt;,
</a><a href="#h4-1-268" id="h4-1-268" class="i">+        mut order: Vec&lt;(ast::Expression, ast::Order)&gt;,
</a><a href="#h4-1-269" id="h4-1-269" class="i">+        offset: Option&lt;ast::Expression&gt;,
</a><a href="#h4-1-270" id="h4-1-270" class="i">+        limit: Option&lt;ast::Expression&gt;,
</a><a href="#h4-1-271" id="h4-1-271" class="i">+    ) -&gt; Result&lt;Plan&gt; {
</a><a href="#h4-1-272" id="h4-1-272" class="i">+        let mut scope = Scope::new();
</a><a href="#h4-1-273" id="h4-1-273" class="i">+
</a><a href="#h4-1-274" id="h4-1-274" class="i">+        // Build FROM clause.
</a><a href="#h4-1-275" id="h4-1-275" class="i">+        let mut node = if !from.is_empty() {
</a><a href="#h4-1-276" id="h4-1-276" class="i">+            self.build_from_clause(&amp;mut scope, from)?
</a><a href="#h4-1-277" id="h4-1-277" class="i">+        } else if select.is_empty() {
</a><a href="#h4-1-278" id="h4-1-278" class="i">+            return errinput!(&quot;can&#39;t select * without a table&quot;);
</a><a href="#h4-1-279" id="h4-1-279" class="i">+        } else {
</a><a href="#h4-1-280" id="h4-1-280" class="i">+            Node::Nothing
</a><a href="#h4-1-281" id="h4-1-281" class="i">+        };
</a> 
<a href="#h4-1-283" id="h4-1-283" class="d">-                    // Extract any aggregate functions and GROUP BY expressions, replacing them with
</a><a href="#h4-1-284" id="h4-1-284" class="d">-                    // Column placeholders. Aggregations are handled by evaluating group expressions
</a><a href="#h4-1-285" id="h4-1-285" class="d">-                    // and aggregate function arguments in a pre-projection, passing the results
</a><a href="#h4-1-286" id="h4-1-286" class="d">-                    // to an aggregation node, and then evaluating the final SELECT expressions
</a><a href="#h4-1-287" id="h4-1-287" class="d">-                    // in the post-projection. For example:
</a><a href="#h4-1-288" id="h4-1-288" class="d">-                    //
</a><a href="#h4-1-289" id="h4-1-289" class="d">-                    // SELECT (MAX(rating * 100) - MIN(rating * 100)) / 100
</a><a href="#h4-1-290" id="h4-1-290" class="d">-                    // FROM movies
</a><a href="#h4-1-291" id="h4-1-291" class="d">-                    // GROUP BY released - 2000
</a><a href="#h4-1-292" id="h4-1-292" class="d">-                    //
</a><a href="#h4-1-293" id="h4-1-293" class="d">-                    // Results in the following nodes:
</a><a href="#h4-1-294" id="h4-1-294" class="d">-                    //
</a><a href="#h4-1-295" id="h4-1-295" class="d">-                    // - Projection: rating * 100, rating * 100, released - 2000
</a><a href="#h4-1-296" id="h4-1-296" class="d">-                    // - Aggregation: max(#0), min(#1) group by #2
</a><a href="#h4-1-297" id="h4-1-297" class="d">-                    // - Projection: (#0 - #1) / 100
</a><a href="#h4-1-298" id="h4-1-298" class="d">-                    let aggregates = self.extract_aggregates(&amp;mut select)?;
</a><a href="#h4-1-299" id="h4-1-299" class="d">-                    let groups = self.extract_groups(&amp;mut select, group_by, aggregates.len())?;
</a><a href="#h4-1-300" id="h4-1-300" class="d">-                    if !aggregates.is_empty() || !groups.is_empty() {
</a><a href="#h4-1-301" id="h4-1-301" class="d">-                        node = self.build_aggregation(scope, node, groups, aggregates)?;
</a><a href="#h4-1-302" id="h4-1-302" class="d">-                    }
</a><a href="#h4-1-303" id="h4-1-303" class="i">+        // Build WHERE clause.
</a><a href="#h4-1-304" id="h4-1-304" class="i">+        if let Some(expr) = r#where {
</a><a href="#h4-1-305" id="h4-1-305" class="i">+            node = Node::Filter {
</a><a href="#h4-1-306" id="h4-1-306" class="i">+                source: Box::new(node),
</a><a href="#h4-1-307" id="h4-1-307" class="i">+                predicate: Self::build_expression(expr, &amp;scope)?,
</a><a href="#h4-1-308" id="h4-1-308" class="i">+            };
</a><a href="#h4-1-309" id="h4-1-309" class="i">+        };
</a> 
<a href="#h4-1-311" id="h4-1-311" class="d">-                    // Build the remaining non-aggregate projection.
</a><a href="#h4-1-312" id="h4-1-312" class="d">-                    let labels: Vec&lt;_&gt; =
</a><a href="#h4-1-313" id="h4-1-313" class="d">-                        select.iter().map(|(_, l)| l.clone().map(|l| (None, l))).collect();
</a><a href="#h4-1-314" id="h4-1-314" class="d">-                    let expressions: Vec&lt;_&gt; = select
</a><a href="#h4-1-315" id="h4-1-315" class="d">-                        .into_iter()
</a><a href="#h4-1-316" id="h4-1-316" class="d">-                        .map(|(e, _)| self.build_expression(scope, e))
</a><a href="#h4-1-317" id="h4-1-317" class="d">-                        .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h4-1-318" id="h4-1-318" class="d">-                    scope.project(&amp;expressions, &amp;labels)?;
</a><a href="#h4-1-319" id="h4-1-319" class="d">-                    node = Node::Projection { source: Box::new(node), labels, expressions };
</a><a href="#h4-1-320" id="h4-1-320" class="d">-                };
</a><a href="#h4-1-321" id="h4-1-321" class="i">+        // Build SELECT clause.
</a><a href="#h4-1-322" id="h4-1-322" class="i">+        let mut hidden = 0;
</a><a href="#h4-1-323" id="h4-1-323" class="i">+        if !select.is_empty() {
</a><a href="#h4-1-324" id="h4-1-324" class="i">+            // Inject hidden SELECT columns for fields and aggregates used in ORDER BY and
</a><a href="#h4-1-325" id="h4-1-325" class="i">+            // HAVING expressions but not present in existing SELECT output. These will be
</a><a href="#h4-1-326" id="h4-1-326" class="i">+            // removed again by a later projection.
</a><a href="#h4-1-327" id="h4-1-327" class="i">+            if let Some(ref mut expr) = having {
</a><a href="#h4-1-328" id="h4-1-328" class="i">+                hidden += self.inject_hidden(expr, &amp;mut select)?;
</a><a href="#h4-1-329" id="h4-1-329" class="i">+            }
</a><a href="#h4-1-330" id="h4-1-330" class="i">+            for (expr, _) in order.iter_mut() {
</a><a href="#h4-1-331" id="h4-1-331" class="i">+                hidden += self.inject_hidden(expr, &amp;mut select)?;
</a><a href="#h4-1-332" id="h4-1-332" class="i">+            }
</a> 
<a href="#h4-1-334" id="h4-1-334" class="d">-                // Build HAVING clause.
</a><a href="#h4-1-335" id="h4-1-335" class="d">-                if let Some(expr) = having {
</a><a href="#h4-1-336" id="h4-1-336" class="d">-                    node = Node::Filter {
</a><a href="#h4-1-337" id="h4-1-337" class="d">-                        source: Box::new(node),
</a><a href="#h4-1-338" id="h4-1-338" class="d">-                        predicate: self.build_expression(scope, expr)?,
</a><a href="#h4-1-339" id="h4-1-339" class="d">-                    };
</a><a href="#h4-1-340" id="h4-1-340" class="d">-                };
</a><a href="#h4-1-341" id="h4-1-341" class="i">+            // Extract any aggregate functions and GROUP BY expressions, replacing them with
</a><a href="#h4-1-342" id="h4-1-342" class="i">+            // Column placeholders. Aggregations are handled by evaluating group expressions
</a><a href="#h4-1-343" id="h4-1-343" class="i">+            // and aggregate function arguments in a pre-projection, passing the results
</a><a href="#h4-1-344" id="h4-1-344" class="i">+            // to an aggregation node, and then evaluating the final SELECT expressions
</a><a href="#h4-1-345" id="h4-1-345" class="i">+            // in the post-projection. For example:
</a><a href="#h4-1-346" id="h4-1-346" class="i">+            //
</a><a href="#h4-1-347" id="h4-1-347" class="i">+            // SELECT (MAX(rating * 100) - MIN(rating * 100)) / 100
</a><a href="#h4-1-348" id="h4-1-348" class="i">+            // FROM movies
</a><a href="#h4-1-349" id="h4-1-349" class="i">+            // GROUP BY released - 2000
</a><a href="#h4-1-350" id="h4-1-350" class="i">+            //
</a><a href="#h4-1-351" id="h4-1-351" class="i">+            // Results in the following nodes:
</a><a href="#h4-1-352" id="h4-1-352" class="i">+            //
</a><a href="#h4-1-353" id="h4-1-353" class="i">+            // - Projection: rating * 100, rating * 100, released - 2000
</a><a href="#h4-1-354" id="h4-1-354" class="i">+            // - Aggregation: max(#0), min(#1) group by #2
</a><a href="#h4-1-355" id="h4-1-355" class="i">+            // - Projection: (#0 - #1) / 100
</a><a href="#h4-1-356" id="h4-1-356" class="i">+            let aggregates = self.extract_aggregates(&amp;mut select)?;
</a><a href="#h4-1-357" id="h4-1-357" class="i">+            let groups = self.extract_groups(&amp;mut select, group_by, aggregates.len())?;
</a><a href="#h4-1-358" id="h4-1-358" class="i">+            if !aggregates.is_empty() || !groups.is_empty() {
</a><a href="#h4-1-359" id="h4-1-359" class="i">+                node = self.build_aggregation(&amp;mut scope, node, groups, aggregates)?;
</a><a href="#h4-1-360" id="h4-1-360" class="i">+            }
</a> 
<a href="#h4-1-362" id="h4-1-362" class="d">-                // Build ORDER clause.
</a><a href="#h4-1-363" id="h4-1-363" class="d">-                if !order.is_empty() {
</a><a href="#h4-1-364" id="h4-1-364" class="d">-                    node = Node::Order {
</a><a href="#h4-1-365" id="h4-1-365" class="d">-                        source: Box::new(node),
</a><a href="#h4-1-366" id="h4-1-366" class="d">-                        orders: order
</a><a href="#h4-1-367" id="h4-1-367" class="d">-                            .into_iter()
</a><a href="#h4-1-368" id="h4-1-368" class="d">-                            .map(|(e, o)| {
</a><a href="#h4-1-369" id="h4-1-369" class="d">-                                Ok((
</a><a href="#h4-1-370" id="h4-1-370" class="d">-                                    self.build_expression(scope, e)?,
</a><a href="#h4-1-371" id="h4-1-371" class="d">-                                    match o {
</a><a href="#h4-1-372" id="h4-1-372" class="d">-                                        ast::Order::Ascending =&gt; Direction::Ascending,
</a><a href="#h4-1-373" id="h4-1-373" class="d">-                                        ast::Order::Descending =&gt; Direction::Descending,
</a><a href="#h4-1-374" id="h4-1-374" class="d">-                                    },
</a><a href="#h4-1-375" id="h4-1-375" class="d">-                                ))
</a><a href="#h4-1-376" id="h4-1-376" class="d">-                            })
</a><a href="#h4-1-377" id="h4-1-377" class="d">-                            .collect::&lt;Result&lt;_&gt;&gt;()?,
</a><a href="#h4-1-378" id="h4-1-378" class="d">-                    };
</a><a href="#h4-1-379" id="h4-1-379" class="d">-                }
</a><a href="#h4-1-380" id="h4-1-380" class="i">+            // Build the remaining non-aggregate projection.
</a><a href="#h4-1-381" id="h4-1-381" class="i">+            let labels = select.iter().map(|(_, l)| l.clone().map(|l| (None, l))).collect_vec();
</a><a href="#h4-1-382" id="h4-1-382" class="i">+            let expressions = select
</a><a href="#h4-1-383" id="h4-1-383" class="i">+                .into_iter()
</a><a href="#h4-1-384" id="h4-1-384" class="i">+                .map(|(e, _)| Self::build_expression(e, &amp;scope))
</a><a href="#h4-1-385" id="h4-1-385" class="i">+                .collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?;
</a><a href="#h4-1-386" id="h4-1-386" class="i">+            scope.project(&amp;expressions, &amp;labels)?;
</a><a href="#h4-1-387" id="h4-1-387" class="i">+            node = Node::Projection { source: Box::new(node), expressions, labels };
</a><a href="#h4-1-388" id="h4-1-388" class="i">+        };
</a> 
<a href="#h4-1-390" id="h4-1-390" class="d">-                // Build OFFSET clause.
</a><a href="#h4-1-391" id="h4-1-391" class="d">-                if let Some(expr) = offset {
</a><a href="#h4-1-392" id="h4-1-392" class="d">-                    node = Node::Offset {
</a><a href="#h4-1-393" id="h4-1-393" class="d">-                        source: Box::new(node),
</a><a href="#h4-1-394" id="h4-1-394" class="d">-                        offset: match self.evaluate_constant(expr)? {
</a><a href="#h4-1-395" id="h4-1-395" class="d">-                            Value::Integer(i) if i &gt;= 0 =&gt; Ok(i as usize),
</a><a href="#h4-1-396" id="h4-1-396" class="d">-                            v =&gt; errinput!(&quot;invalid offset {v}&quot;),
</a><a href="#h4-1-397" id="h4-1-397" class="d">-                        }?,
</a><a href="#h4-1-398" id="h4-1-398" class="d">-                    }
</a><a href="#h4-1-399" id="h4-1-399" class="d">-                }
</a><a href="#h4-1-400" id="h4-1-400" class="i">+        // Build HAVING clause.
</a><a href="#h4-1-401" id="h4-1-401" class="i">+        if let Some(expr) = having {
</a><a href="#h4-1-402" id="h4-1-402" class="i">+            node = Node::Filter {
</a><a href="#h4-1-403" id="h4-1-403" class="i">+                source: Box::new(node),
</a><a href="#h4-1-404" id="h4-1-404" class="i">+                predicate: Self::build_expression(expr, &amp;scope)?,
</a><a href="#h4-1-405" id="h4-1-405" class="i">+            };
</a><a href="#h4-1-406" id="h4-1-406" class="i">+        };
</a> 
<a href="#h4-1-408" id="h4-1-408" class="d">-                // Build LIMIT clause.
</a><a href="#h4-1-409" id="h4-1-409" class="d">-                if let Some(expr) = limit {
</a><a href="#h4-1-410" id="h4-1-410" class="d">-                    node = Node::Limit {
</a><a href="#h4-1-411" id="h4-1-411" class="d">-                        source: Box::new(node),
</a><a href="#h4-1-412" id="h4-1-412" class="d">-                        limit: match self.evaluate_constant(expr)? {
</a><a href="#h4-1-413" id="h4-1-413" class="d">-                            Value::Integer(i) if i &gt;= 0 =&gt; Ok(i as usize),
</a><a href="#h4-1-414" id="h4-1-414" class="d">-                            v =&gt; errinput!(&quot;invalid limit {v}&quot;),
</a><a href="#h4-1-415" id="h4-1-415" class="d">-                        }?,
</a><a href="#h4-1-416" id="h4-1-416" class="d">-                    }
</a><a href="#h4-1-417" id="h4-1-417" class="d">-                }
</a><a href="#h4-1-418" id="h4-1-418" class="i">+        // Build ORDER clause.
</a><a href="#h4-1-419" id="h4-1-419" class="i">+        if !order.is_empty() {
</a><a href="#h4-1-420" id="h4-1-420" class="i">+            let orders = order
</a><a href="#h4-1-421" id="h4-1-421" class="i">+                .into_iter()
</a><a href="#h4-1-422" id="h4-1-422" class="i">+                .map(|(e, o)| {
</a><a href="#h4-1-423" id="h4-1-423" class="i">+                    Ok((
</a><a href="#h4-1-424" id="h4-1-424" class="i">+                        Self::build_expression(e, &amp;scope)?,
</a><a href="#h4-1-425" id="h4-1-425" class="i">+                        match o {
</a><a href="#h4-1-426" id="h4-1-426" class="i">+                            ast::Order::Ascending =&gt; Direction::Ascending,
</a><a href="#h4-1-427" id="h4-1-427" class="i">+                            ast::Order::Descending =&gt; Direction::Descending,
</a><a href="#h4-1-428" id="h4-1-428" class="i">+                        },
</a><a href="#h4-1-429" id="h4-1-429" class="i">+                    ))
</a><a href="#h4-1-430" id="h4-1-430" class="i">+                })
</a><a href="#h4-1-431" id="h4-1-431" class="i">+                .collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h4-1-432" id="h4-1-432" class="i">+            node = Node::Order { source: Box::new(node), orders };
</a><a href="#h4-1-433" id="h4-1-433" class="i">+        }
</a> 
<a href="#h4-1-435" id="h4-1-435" class="d">-                // Remove any hidden columns.
</a><a href="#h4-1-436" id="h4-1-436" class="d">-                if hidden &gt; 0 {
</a><a href="#h4-1-437" id="h4-1-437" class="d">-                    node = Node::Projection {
</a><a href="#h4-1-438" id="h4-1-438" class="d">-                        source: Box::new(node),
</a><a href="#h4-1-439" id="h4-1-439" class="d">-                        labels: vec![None; scope.len() - hidden],
</a><a href="#h4-1-440" id="h4-1-440" class="d">-                        expressions: (0..(scope.len() - hidden))
</a><a href="#h4-1-441" id="h4-1-441" class="d">-                            .map(|i| Expression::Field(i, None))
</a><a href="#h4-1-442" id="h4-1-442" class="d">-                            .collect(),
</a><a href="#h4-1-443" id="h4-1-443" class="d">-                    }
</a><a href="#h4-1-444" id="h4-1-444" class="d">-                }
</a><a href="#h4-1-445" id="h4-1-445" class="i">+        // Build OFFSET clause.
</a><a href="#h4-1-446" id="h4-1-446" class="i">+        if let Some(expr) = offset {
</a><a href="#h4-1-447" id="h4-1-447" class="i">+            node = Node::Offset {
</a><a href="#h4-1-448" id="h4-1-448" class="i">+                source: Box::new(node),
</a><a href="#h4-1-449" id="h4-1-449" class="i">+                offset: match Self::evaluate_constant(expr)? {
</a><a href="#h4-1-450" id="h4-1-450" class="i">+                    Value::Integer(offset) if offset &gt;= 0 =&gt; Ok(offset as usize),
</a><a href="#h4-1-451" id="h4-1-451" class="i">+                    value =&gt; errinput!(&quot;invalid offset {value}&quot;),
</a><a href="#h4-1-452" id="h4-1-452" class="i">+                }?,
</a><a href="#h4-1-453" id="h4-1-453" class="i">+            }
</a><a href="#h4-1-454" id="h4-1-454" class="i">+        }
</a> 
<a href="#h4-1-456" id="h4-1-456" class="d">-                Plan::Select(node)
</a><a href="#h4-1-457" id="h4-1-457" class="i">+        // Build LIMIT clause.
</a><a href="#h4-1-458" id="h4-1-458" class="i">+        if let Some(expr) = limit {
</a><a href="#h4-1-459" id="h4-1-459" class="i">+            node = Node::Limit {
</a><a href="#h4-1-460" id="h4-1-460" class="i">+                source: Box::new(node),
</a><a href="#h4-1-461" id="h4-1-461" class="i">+                limit: match Self::evaluate_constant(expr)? {
</a><a href="#h4-1-462" id="h4-1-462" class="i">+                    Value::Integer(limit) if limit &gt;= 0 =&gt; Ok(limit as usize),
</a><a href="#h4-1-463" id="h4-1-463" class="i">+                    value =&gt; errinput!(&quot;invalid limit {value}&quot;),
</a><a href="#h4-1-464" id="h4-1-464" class="i">+                }?,
</a>             }
<a href="#h4-1-466" id="h4-1-466" class="d">-        })
</a><a href="#h4-1-467" id="h4-1-467" class="i">+        }
</a><a href="#h4-1-468" id="h4-1-468" class="i">+
</a><a href="#h4-1-469" id="h4-1-469" class="i">+        // Remove any hidden columns.
</a><a href="#h4-1-470" id="h4-1-470" class="i">+        if hidden &gt; 0 {
</a><a href="#h4-1-471" id="h4-1-471" class="i">+            let columns = scope.len() - hidden;
</a><a href="#h4-1-472" id="h4-1-472" class="i">+            let labels = vec![None; columns];
</a><a href="#h4-1-473" id="h4-1-473" class="i">+            let expressions = (0..columns).map(|i| Expression::Field(i, None)).collect_vec();
</a><a href="#h4-1-474" id="h4-1-474" class="i">+            scope.project(&amp;expressions, &amp;labels)?;
</a><a href="#h4-1-475" id="h4-1-475" class="i">+            node = Node::Projection { source: Box::new(node), labels, expressions }
</a><a href="#h4-1-476" id="h4-1-476" class="i">+        }
</a><a href="#h4-1-477" id="h4-1-477" class="i">+
</a><a href="#h4-1-478" id="h4-1-478" class="i">+        Ok(Plan::Select { root: node, labels: scope.columns })
</a>     }
 
<a href="#h4-1-481" id="h4-1-481" class="d">-    /// Builds a FROM clause consisting of several items. Each item is either a single table or a
</a><a href="#h4-1-482" id="h4-1-482" class="d">-    /// join of an arbitrary number of tables. All of the items are joined, since e.g. &#39;SELECT * FROM
</a><a href="#h4-1-483" id="h4-1-483" class="d">-    /// a, b&#39; is an implicit join of a and b.
</a><a href="#h4-1-484" id="h4-1-484" class="i">+    /// Builds a FROM clause consisting of one or more items. Each item is
</a><a href="#h4-1-485" id="h4-1-485" class="i">+    /// either a table or a join of two or more tables. All items are implicitly
</a><a href="#h4-1-486" id="h4-1-486" class="i">+    /// joined, e.g. &quot;SELECT * FROM a, b&quot; is an implicit full join of a and b.
</a>     fn build_from_clause(&amp;self, scope: &amp;mut Scope, from: Vec&lt;ast::From&gt;) -&gt; Result&lt;Node&gt; {
<a href="#h4-1-488" id="h4-1-488" class="d">-        let base_scope = scope.clone();
</a><a href="#h4-1-489" id="h4-1-489" class="i">+        // Build the first FROM item. A FROM clause must have at least one.
</a>         let mut items = from.into_iter();
         let mut node = match items.next() {
<a href="#h4-1-492" id="h4-1-492" class="d">-            Some(item) =&gt; self.build_from_item(scope, item)?,
</a><a href="#h4-1-493" id="h4-1-493" class="i">+            Some(from) =&gt; self.build_from(from, scope)?,
</a>             None =&gt; return errinput!(&quot;no from items given&quot;),
         };
<a href="#h4-1-496" id="h4-1-496" class="d">-        for item in items {
</a><a href="#h4-1-497" id="h4-1-497" class="d">-            let mut right_scope = base_scope.clone();
</a><a href="#h4-1-498" id="h4-1-498" class="d">-            let right = self.build_from_item(&amp;mut right_scope, item)?;
</a><a href="#h4-1-499" id="h4-1-499" class="i">+
</a><a href="#h4-1-500" id="h4-1-500" class="i">+        // Build and implicitly join additional items.
</a><a href="#h4-1-501" id="h4-1-501" class="i">+        for from in items {
</a><a href="#h4-1-502" id="h4-1-502" class="i">+            // Each item is evaluated in its own, initially empty scope, and
</a><a href="#h4-1-503" id="h4-1-503" class="i">+            // can&#39;t reference previous items. Consider e.g. &quot;SELECT * FROM a,
</a><a href="#h4-1-504" id="h4-1-504" class="i">+            // b JOIN c ON c.id = a.id&quot; which is illegal (the join predicate can
</a><a href="#h4-1-505" id="h4-1-505" class="i">+            // reference b or c, but not a).
</a><a href="#h4-1-506" id="h4-1-506" class="i">+            let mut right_scope = Scope::new();
</a><a href="#h4-1-507" id="h4-1-507" class="i">+            let right = self.build_from(from, &amp;mut right_scope)?;
</a>             node = Node::NestedLoopJoin {
                 left: Box::new(node),
                 left_size: scope.len(),
<a href="#h4-2" id="h4-2" class="h">@@ -298,42 +305,44 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         Ok(node)
     }
 
<a href="#h4-2-3" id="h4-2-3" class="d">-    /// Builds FROM items, which can either be a single table or a chained join of multiple tables,
</a><a href="#h4-2-4" id="h4-2-4" class="d">-    /// e.g. &#39;SELECT * FROM a LEFT JOIN b ON b.a_id = a.id&#39;. Any tables will be stored in
</a><a href="#h4-2-5" id="h4-2-5" class="d">-    /// self.tables keyed by their query name (i.e. alias if given, otherwise name). The table can
</a><a href="#h4-2-6" id="h4-2-6" class="d">-    /// only be referenced by the query name (so if alias is given, cannot reference by name).
</a><a href="#h4-2-7" id="h4-2-7" class="d">-    fn build_from_item(&amp;self, scope: &amp;mut Scope, item: ast::From) -&gt; Result&lt;Node&gt; {
</a><a href="#h4-2-8" id="h4-2-8" class="d">-        Ok(match item {
</a><a href="#h4-2-9" id="h4-2-9" class="i">+    /// Builds FROM items, which can either be a single table or a chained join
</a><a href="#h4-2-10" id="h4-2-10" class="i">+    /// of multiple tables, e.g. &quot;SELECT * FROM a LEFT JOIN b ON b.a_id = a.id&quot;.
</a><a href="#h4-2-11" id="h4-2-11" class="i">+    fn build_from(&amp;self, from: ast::From, scope: &amp;mut Scope) -&gt; Result&lt;Node&gt; {
</a><a href="#h4-2-12" id="h4-2-12" class="i">+        Ok(match from {
</a><a href="#h4-2-13" id="h4-2-13" class="i">+            // A full table scan.
</a>             ast::From::Table { name, alias } =&gt; {
                 let table = self.catalog.must_get_table(&amp;name)?;
<a href="#h4-2-16" id="h4-2-16" class="d">-                scope.add_table(alias.clone().unwrap_or_else(|| name.clone()), table.clone())?;
</a><a href="#h4-2-17" id="h4-2-17" class="i">+                scope.add_table(alias.as_ref().unwrap_or(&amp;name), &amp;table)?;
</a>                 Node::Scan { table, alias, filter: None }
             }
 
<a href="#h4-2-21" id="h4-2-21" class="d">-            ast::From::Join { left, right, r#type, predicate } =&gt; {
</a><a href="#h4-2-22" id="h4-2-22" class="d">-                // Right outer joins are built as a left outer join with an additional projection
</a><a href="#h4-2-23" id="h4-2-23" class="d">-                // to swap the resulting columns.
</a><a href="#h4-2-24" id="h4-2-24" class="d">-                let (left, right) = match r#type {
</a><a href="#h4-2-25" id="h4-2-25" class="d">-                    ast::JoinType::Right =&gt; (right, left),
</a><a href="#h4-2-26" id="h4-2-26" class="d">-                    _ =&gt; (left, right),
</a><a href="#h4-2-27" id="h4-2-27" class="d">-                };
</a><a href="#h4-2-28" id="h4-2-28" class="d">-                let left = Box::new(self.build_from_item(scope, *left)?);
</a><a href="#h4-2-29" id="h4-2-29" class="i">+            // A two-way join. The left or right nodes may be chained joins.
</a><a href="#h4-2-30" id="h4-2-30" class="i">+            ast::From::Join { mut left, mut right, r#type, predicate } =&gt; {
</a><a href="#h4-2-31" id="h4-2-31" class="i">+                // Right joins are built as a left join with an additional
</a><a href="#h4-2-32" id="h4-2-32" class="i">+                // projection to swap the resulting columns.
</a><a href="#h4-2-33" id="h4-2-33" class="i">+                if matches!(r#type, ast::JoinType::Right) {
</a><a href="#h4-2-34" id="h4-2-34" class="i">+                    (left, right) = (right, left)
</a><a href="#h4-2-35" id="h4-2-35" class="i">+                }
</a><a href="#h4-2-36" id="h4-2-36" class="i">+
</a><a href="#h4-2-37" id="h4-2-37" class="i">+                // Build the left and right nodes.
</a><a href="#h4-2-38" id="h4-2-38" class="i">+                let left = Box::new(self.build_from(*left, scope)?);
</a>                 let left_size = scope.len();
<a href="#h4-2-40" id="h4-2-40" class="d">-                let right = Box::new(self.build_from_item(scope, *right)?);
</a><a href="#h4-2-41" id="h4-2-41" class="d">-                let predicate = predicate.map(|e| self.build_expression(scope, e)).transpose()?;
</a><a href="#h4-2-42" id="h4-2-42" class="d">-                let outer = match r#type {
</a><a href="#h4-2-43" id="h4-2-43" class="d">-                    ast::JoinType::Cross | ast::JoinType::Inner =&gt; false,
</a><a href="#h4-2-44" id="h4-2-44" class="d">-                    ast::JoinType::Left | ast::JoinType::Right =&gt; true,
</a><a href="#h4-2-45" id="h4-2-45" class="d">-                };
</a><a href="#h4-2-46" id="h4-2-46" class="i">+                let right = Box::new(self.build_from(*right, scope)?);
</a><a href="#h4-2-47" id="h4-2-47" class="i">+
</a><a href="#h4-2-48" id="h4-2-48" class="i">+                //  Build the join node.
</a><a href="#h4-2-49" id="h4-2-49" class="i">+                let predicate = predicate.map(|e| Self::build_expression(e, scope)).transpose()?;
</a><a href="#h4-2-50" id="h4-2-50" class="i">+                let outer = r#type.is_outer();
</a>                 let mut node = Node::NestedLoopJoin { left, left_size, right, predicate, outer };
<a href="#h4-2-52" id="h4-2-52" class="i">+
</a><a href="#h4-2-53" id="h4-2-53" class="i">+                // For right joins, build a projection to swap the columns.
</a>                 if matches!(r#type, ast::JoinType::Right) {
                     let labels = vec![None; scope.len()];
                     let expressions = (left_size..scope.len())
                         .chain(0..left_size)
<a href="#h4-2-58" id="h4-2-58" class="d">-                        .map(|i| Ok(Expression::Field(i, scope.get_label(i)?)))
</a><a href="#h4-2-59" id="h4-2-59" class="i">+                        .map(|i| Ok(Expression::Field(i, scope.get_column_label(i)?)))
</a>                         .collect::&lt;Result&lt;Vec&lt;_&gt;&gt;&gt;()?;
                     scope.project(&amp;expressions, &amp;labels)?;
<a href="#h4-2-62" id="h4-2-62" class="d">-                    node = Node::Projection { source: Box::new(node), labels, expressions }
</a><a href="#h4-2-63" id="h4-2-63" class="i">+                    node = Node::Projection { source: Box::new(node), expressions, labels }
</a>                 }
                 node
             }
<a href="#h4-3" id="h4-3" class="h">@@ -343,6 +352,8 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>     /// Builds an aggregation node. All aggregate parameters and GROUP BY expressions are evaluated
     /// in a pre-projection, whose results are fed into an Aggregate node. This node computes the
     /// aggregates for the given groups, passing the group values through directly.
<a href="#h4-3-3" id="h4-3-3" class="i">+    ///
</a><a href="#h4-3-4" id="h4-3-4" class="i">+    /// TODO: revisit this.
</a>     fn build_aggregation(
         &amp;self,
         scope: &amp;mut Scope,
<a href="#h4-4" id="h4-4" class="h">@@ -355,11 +366,11 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         let mut labels = Vec::new();
         for (aggregate, expr) in aggregations {
             aggregates.push(aggregate);
<a href="#h4-4-3" id="h4-4-3" class="d">-            expressions.push(self.build_expression(scope, expr)?);
</a><a href="#h4-4-4" id="h4-4-4" class="i">+            expressions.push(Self::build_expression(expr, scope)?);
</a>             labels.push(None);
         }
         for (expr, label) in groups {
<a href="#h4-4-8" id="h4-4-8" class="d">-            expressions.push(self.build_expression(scope, expr)?);
</a><a href="#h4-4-9" id="h4-4-9" class="i">+            expressions.push(Self::build_expression(expr, scope)?);
</a>             labels.push(label.map(|l| (None, l)));
         }
         scope.project(
<a href="#h4-5" id="h4-5" class="h">@@ -398,7 +409,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>             expr.transform_mut(
                 &amp;mut |mut e| match &amp;mut e {
                     ast::Expression::Function(f, args) if args.len() == 1 =&gt; {
<a href="#h4-5-3" id="h4-5-3" class="d">-                        if let Some(aggregate) = self.aggregate_from_name(f) {
</a><a href="#h4-5-4" id="h4-5-4" class="i">+                        if let Some(aggregate) = Aggregate::from_name(f) {
</a>                             aggregates.push((aggregate, args.remove(0)));
                             Ok(ast::Expression::Column(aggregates.len() - 1))
                         } else {
<a href="#h4-6" id="h4-6" class="h">@@ -411,7 +422,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>             )?;
         }
         for (_, expr) in &amp;aggregates {
<a href="#h4-6-3" id="h4-6-3" class="d">-            if self.is_aggregate(expr) {
</a><a href="#h4-6-4" id="h4-6-4" class="i">+            if Self::is_aggregate(expr) {
</a>                 return errinput!(&quot;aggregate functions can&#39;t be nested&quot;);
             }
         }
<a href="#h4-7" id="h4-7" class="h">@@ -437,7 +448,10 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>             if let ast::Expression::Field(None, label) = &amp;g {
                 if let Some(i) = exprs.iter().position(|(_, l)| l.as_deref() == Some(label)) {
                     groups.push((
<a href="#h4-7-3" id="h4-7-3" class="d">-                        replace(&amp;mut exprs[i].0, ast::Expression::Column(offset + groups.len())),
</a><a href="#h4-7-4" id="h4-7-4" class="i">+                        std::mem::replace(
</a><a href="#h4-7-5" id="h4-7-5" class="i">+                            &amp;mut exprs[i].0,
</a><a href="#h4-7-6" id="h4-7-6" class="i">+                            ast::Expression::Column(offset + groups.len()),
</a><a href="#h4-7-7" id="h4-7-7" class="i">+                        ),
</a>                         exprs[i].1.clone(),
                     ));
                     continue;
<a href="#h4-8" id="h4-8" class="h">@@ -446,7 +460,10 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>             // Look for expressions exactly equal to the group expression
             if let Some(i) = exprs.iter().position(|(e, _)| e == &amp;g) {
                 groups.push((
<a href="#h4-8-3" id="h4-8-3" class="d">-                    replace(&amp;mut exprs[i].0, ast::Expression::Column(offset + groups.len())),
</a><a href="#h4-8-4" id="h4-8-4" class="i">+                    std::mem::replace(
</a><a href="#h4-8-5" id="h4-8-5" class="i">+                        &amp;mut exprs[i].0,
</a><a href="#h4-8-6" id="h4-8-6" class="i">+                        ast::Expression::Column(offset + groups.len()),
</a><a href="#h4-8-7" id="h4-8-7" class="i">+                    ),
</a>                     exprs[i].1.clone(),
                 ));
                 continue;
<a href="#h4-9" id="h4-9" class="h">@@ -457,7 +474,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         // Make sure no group expressions contain Column references, which would be placed here
         // during extract_aggregates().
         for (expr, _) in &amp;groups {
<a href="#h4-9-3" id="h4-9-3" class="d">-            if self.is_aggregate(expr) {
</a><a href="#h4-9-4" id="h4-9-4" class="i">+            if Self::is_aggregate(expr) {
</a>                 return errinput!(&quot;group expression cannot contain aggregates&quot;);
             }
         }
<a href="#h4-10" id="h4-10" class="h">@@ -497,9 +514,9 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         let mut hidden = 0;
         expr.transform_mut(
             &amp;mut |e| match &amp;e {
<a href="#h4-10-3" id="h4-10-3" class="d">-                ast::Expression::Function(f, a) if self.aggregate_from_name(f).is_some() =&gt; {
</a><a href="#h4-10-4" id="h4-10-4" class="i">+                ast::Expression::Function(f, a) if Aggregate::from_name(f).is_some() =&gt; {
</a>                     if let ast::Expression::Column(c) = a[0] {
<a href="#h4-10-6" id="h4-10-6" class="d">-                        if self.is_aggregate(&amp;select[c].0) {
</a><a href="#h4-10-7" id="h4-10-7" class="i">+                        if Self::is_aggregate(&amp;select[c].0) {
</a>                             return errinput!(&quot;aggregate function cannot reference aggregate&quot;);
                         }
                     }
<a href="#h4-11" id="h4-11" class="h">@@ -519,30 +536,15 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         Ok(hidden)
     }
 
<a href="#h4-11-3" id="h4-11-3" class="d">-    /// Returns the aggregate corresponding to the given aggregate function name.
</a><a href="#h4-11-4" id="h4-11-4" class="d">-    fn aggregate_from_name(&amp;self, name: &amp;str) -&gt; Option&lt;Aggregate&gt; {
</a><a href="#h4-11-5" id="h4-11-5" class="d">-        match name {
</a><a href="#h4-11-6" id="h4-11-6" class="d">-            &quot;avg&quot; =&gt; Some(Aggregate::Average),
</a><a href="#h4-11-7" id="h4-11-7" class="d">-            &quot;count&quot; =&gt; Some(Aggregate::Count),
</a><a href="#h4-11-8" id="h4-11-8" class="d">-            &quot;max&quot; =&gt; Some(Aggregate::Max),
</a><a href="#h4-11-9" id="h4-11-9" class="d">-            &quot;min&quot; =&gt; Some(Aggregate::Min),
</a><a href="#h4-11-10" id="h4-11-10" class="d">-            &quot;sum&quot; =&gt; Some(Aggregate::Sum),
</a><a href="#h4-11-11" id="h4-11-11" class="d">-            _ =&gt; None,
</a><a href="#h4-11-12" id="h4-11-12" class="d">-        }
</a><a href="#h4-11-13" id="h4-11-13" class="d">-    }
</a><a href="#h4-11-14" id="h4-11-14" class="i">+    /// Builds an expression from an AST expression.
</a><a href="#h4-11-15" id="h4-11-15" class="i">+    fn build_expression(expr: ast::Expression, scope: &amp;Scope) -&gt; Result&lt;Expression&gt; {
</a><a href="#h4-11-16" id="h4-11-16" class="i">+        use Expression::*;
</a> 
<a href="#h4-11-18" id="h4-11-18" class="d">-    /// Checks whether a given expression is an aggregate expression.
</a><a href="#h4-11-19" id="h4-11-19" class="d">-    fn is_aggregate(&amp;self, expr: &amp;ast::Expression) -&gt; bool {
</a><a href="#h4-11-20" id="h4-11-20" class="d">-        expr.contains(&amp;|e| match e {
</a><a href="#h4-11-21" id="h4-11-21" class="d">-            ast::Expression::Function(f, _) =&gt; self.aggregate_from_name(f).is_some(),
</a><a href="#h4-11-22" id="h4-11-22" class="d">-            _ =&gt; false,
</a><a href="#h4-11-23" id="h4-11-23" class="d">-        })
</a><a href="#h4-11-24" id="h4-11-24" class="d">-    }
</a><a href="#h4-11-25" id="h4-11-25" class="i">+        // Helper for building a boxed expression.
</a><a href="#h4-11-26" id="h4-11-26" class="i">+        let build = |expr: Box&lt;ast::Expression&gt;| -&gt; Result&lt;Box&lt;Expression&gt;&gt; {
</a><a href="#h4-11-27" id="h4-11-27" class="i">+            Ok(Box::new(Self::build_expression(*expr, scope)?))
</a><a href="#h4-11-28" id="h4-11-28" class="i">+        };
</a> 
<a href="#h4-11-30" id="h4-11-30" class="d">-    /// Builds an expression from an AST expression
</a><a href="#h4-11-31" id="h4-11-31" class="d">-    #[allow(clippy::only_used_in_recursion)]
</a><a href="#h4-11-32" id="h4-11-32" class="d">-    fn build_expression(&amp;self, scope: &amp;mut Scope, expr: ast::Expression) -&gt; Result&lt;Expression&gt; {
</a><a href="#h4-11-33" id="h4-11-33" class="d">-        use Expression::*;
</a>         Ok(match expr {
             ast::Expression::Literal(l) =&gt; Constant(match l {
                 ast::Literal::Null =&gt; Value::Null,
<a href="#h4-12" id="h4-12" class="h">@@ -551,280 +553,218 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 ast::Literal::Float(f) =&gt; Value::Float(f),
                 ast::Literal::String(s) =&gt; Value::String(s),
             }),
<a href="#h4-12-3" id="h4-12-3" class="d">-            ast::Expression::Column(i) =&gt; Field(i, scope.get_label(i)?),
</a><a href="#h4-12-4" id="h4-12-4" class="i">+            ast::Expression::Column(i) =&gt; Field(i, scope.get_column_label(i)?),
</a>             ast::Expression::Field(table, name) =&gt; {
<a href="#h4-12-6" id="h4-12-6" class="d">-                Field(scope.resolve(table.as_deref(), &amp;name)?, Some((table, name)))
</a><a href="#h4-12-7" id="h4-12-7" class="i">+                Field(scope.get_column_index(table.as_deref(), &amp;name)?, Some((table, name)))
</a>             }
<a href="#h4-12-9" id="h4-12-9" class="i">+            // All functions are currently aggregate functions, which should be
</a><a href="#h4-12-10" id="h4-12-10" class="i">+            // processed separately.
</a><a href="#h4-12-11" id="h4-12-11" class="i">+            // TODO: consider adding some basic functions for fun.
</a>             ast::Expression::Function(name, _) =&gt; return errinput!(&quot;unknown function {name}&quot;),
             ast::Expression::Operator(op) =&gt; match op {
<a href="#h4-12-14" id="h4-12-14" class="d">-                // Logical operators
</a><a href="#h4-12-15" id="h4-12-15" class="d">-                ast::Operator::And(lhs, rhs) =&gt; And(
</a><a href="#h4-12-16" id="h4-12-16" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-17" id="h4-12-17" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-18" id="h4-12-18" class="d">-                ),
</a><a href="#h4-12-19" id="h4-12-19" class="d">-                ast::Operator::Not(expr) =&gt; Not(self.build_expression(scope, *expr)?.into()),
</a><a href="#h4-12-20" id="h4-12-20" class="d">-                ast::Operator::Or(lhs, rhs) =&gt; Or(
</a><a href="#h4-12-21" id="h4-12-21" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-22" id="h4-12-22" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-23" id="h4-12-23" class="d">-                ),
</a><a href="#h4-12-24" id="h4-12-24" class="i">+                ast::Operator::And(lhs, rhs) =&gt; And(build(lhs)?, build(rhs)?),
</a><a href="#h4-12-25" id="h4-12-25" class="i">+                ast::Operator::Not(expr) =&gt; Not(build(expr)?),
</a><a href="#h4-12-26" id="h4-12-26" class="i">+                ast::Operator::Or(lhs, rhs) =&gt; Or(build(lhs)?, build(rhs)?),
</a> 
<a href="#h4-12-28" id="h4-12-28" class="d">-                // Comparison operators
</a><a href="#h4-12-29" id="h4-12-29" class="d">-                ast::Operator::Equal(lhs, rhs) =&gt; Equal(
</a><a href="#h4-12-30" id="h4-12-30" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-31" id="h4-12-31" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-32" id="h4-12-32" class="d">-                ),
</a><a href="#h4-12-33" id="h4-12-33" class="d">-                ast::Operator::GreaterThan(lhs, rhs) =&gt; GreaterThan(
</a><a href="#h4-12-34" id="h4-12-34" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-35" id="h4-12-35" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-36" id="h4-12-36" class="d">-                ),
</a><a href="#h4-12-37" id="h4-12-37" class="i">+                ast::Operator::Equal(lhs, rhs) =&gt; Equal(build(lhs)?, build(rhs)?),
</a><a href="#h4-12-38" id="h4-12-38" class="i">+                ast::Operator::GreaterThan(lhs, rhs) =&gt; GreaterThan(build(lhs)?, build(rhs)?),
</a>                 ast::Operator::GreaterThanOrEqual(lhs, rhs) =&gt; Or(
<a href="#h4-12-40" id="h4-12-40" class="d">-                    GreaterThan(
</a><a href="#h4-12-41" id="h4-12-41" class="d">-                        self.build_expression(scope, *lhs.clone())?.into(),
</a><a href="#h4-12-42" id="h4-12-42" class="d">-                        self.build_expression(scope, *rhs.clone())?.into(),
</a><a href="#h4-12-43" id="h4-12-43" class="d">-                    )
</a><a href="#h4-12-44" id="h4-12-44" class="d">-                    .into(),
</a><a href="#h4-12-45" id="h4-12-45" class="d">-                    Equal(
</a><a href="#h4-12-46" id="h4-12-46" class="d">-                        self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-47" id="h4-12-47" class="d">-                        self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-48" id="h4-12-48" class="d">-                    )
</a><a href="#h4-12-49" id="h4-12-49" class="d">-                    .into(),
</a><a href="#h4-12-50" id="h4-12-50" class="d">-                ),
</a><a href="#h4-12-51" id="h4-12-51" class="d">-                ast::Operator::IsNull(expr) =&gt; IsNull(self.build_expression(scope, *expr)?.into()),
</a><a href="#h4-12-52" id="h4-12-52" class="d">-                ast::Operator::LessThan(lhs, rhs) =&gt; LessThan(
</a><a href="#h4-12-53" id="h4-12-53" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-54" id="h4-12-54" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-55" id="h4-12-55" class="i">+                    GreaterThan(build(lhs.clone())?, build(rhs.clone())?).into(),
</a><a href="#h4-12-56" id="h4-12-56" class="i">+                    Equal(build(lhs)?, build(rhs)?).into(),
</a>                 ),
<a href="#h4-12-58" id="h4-12-58" class="i">+                ast::Operator::IsNull(expr) =&gt; IsNull(build(expr)?),
</a><a href="#h4-12-59" id="h4-12-59" class="i">+                ast::Operator::LessThan(lhs, rhs) =&gt; LessThan(build(lhs)?, build(rhs)?),
</a>                 ast::Operator::LessThanOrEqual(lhs, rhs) =&gt; Or(
<a href="#h4-12-61" id="h4-12-61" class="d">-                    LessThan(
</a><a href="#h4-12-62" id="h4-12-62" class="d">-                        self.build_expression(scope, *lhs.clone())?.into(),
</a><a href="#h4-12-63" id="h4-12-63" class="d">-                        self.build_expression(scope, *rhs.clone())?.into(),
</a><a href="#h4-12-64" id="h4-12-64" class="d">-                    )
</a><a href="#h4-12-65" id="h4-12-65" class="d">-                    .into(),
</a><a href="#h4-12-66" id="h4-12-66" class="d">-                    Equal(
</a><a href="#h4-12-67" id="h4-12-67" class="d">-                        self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-68" id="h4-12-68" class="d">-                        self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-69" id="h4-12-69" class="d">-                    )
</a><a href="#h4-12-70" id="h4-12-70" class="d">-                    .into(),
</a><a href="#h4-12-71" id="h4-12-71" class="d">-                ),
</a><a href="#h4-12-72" id="h4-12-72" class="d">-                ast::Operator::Like(lhs, rhs) =&gt; Like(
</a><a href="#h4-12-73" id="h4-12-73" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-74" id="h4-12-74" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-75" id="h4-12-75" class="d">-                ),
</a><a href="#h4-12-76" id="h4-12-76" class="d">-                ast::Operator::NotEqual(lhs, rhs) =&gt; Not(Equal(
</a><a href="#h4-12-77" id="h4-12-77" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-78" id="h4-12-78" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-79" id="h4-12-79" class="d">-                )
</a><a href="#h4-12-80" id="h4-12-80" class="d">-                .into()),
</a><a href="#h4-12-81" id="h4-12-81" class="d">-
</a><a href="#h4-12-82" id="h4-12-82" class="d">-                // Mathematical operators
</a><a href="#h4-12-83" id="h4-12-83" class="d">-                ast::Operator::Add(lhs, rhs) =&gt; Add(
</a><a href="#h4-12-84" id="h4-12-84" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-85" id="h4-12-85" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-86" id="h4-12-86" class="d">-                ),
</a><a href="#h4-12-87" id="h4-12-87" class="d">-                ast::Operator::Divide(lhs, rhs) =&gt; Divide(
</a><a href="#h4-12-88" id="h4-12-88" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-89" id="h4-12-89" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-90" id="h4-12-90" class="d">-                ),
</a><a href="#h4-12-91" id="h4-12-91" class="d">-                ast::Operator::Exponentiate(lhs, rhs) =&gt; Exponentiate(
</a><a href="#h4-12-92" id="h4-12-92" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-93" id="h4-12-93" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-94" id="h4-12-94" class="d">-                ),
</a><a href="#h4-12-95" id="h4-12-95" class="d">-                ast::Operator::Factorial(expr) =&gt; {
</a><a href="#h4-12-96" id="h4-12-96" class="d">-                    Factorial(self.build_expression(scope, *expr)?.into())
</a><a href="#h4-12-97" id="h4-12-97" class="d">-                }
</a><a href="#h4-12-98" id="h4-12-98" class="d">-                ast::Operator::Identity(expr) =&gt; {
</a><a href="#h4-12-99" id="h4-12-99" class="d">-                    Identity(self.build_expression(scope, *expr)?.into())
</a><a href="#h4-12-100" id="h4-12-100" class="d">-                }
</a><a href="#h4-12-101" id="h4-12-101" class="d">-                ast::Operator::Modulo(lhs, rhs) =&gt; Modulo(
</a><a href="#h4-12-102" id="h4-12-102" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-103" id="h4-12-103" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-104" id="h4-12-104" class="d">-                ),
</a><a href="#h4-12-105" id="h4-12-105" class="d">-                ast::Operator::Multiply(lhs, rhs) =&gt; Multiply(
</a><a href="#h4-12-106" id="h4-12-106" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-107" id="h4-12-107" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-108" id="h4-12-108" class="d">-                ),
</a><a href="#h4-12-109" id="h4-12-109" class="d">-                ast::Operator::Negate(expr) =&gt; Negate(self.build_expression(scope, *expr)?.into()),
</a><a href="#h4-12-110" id="h4-12-110" class="d">-                ast::Operator::Subtract(lhs, rhs) =&gt; Subtract(
</a><a href="#h4-12-111" id="h4-12-111" class="d">-                    self.build_expression(scope, *lhs)?.into(),
</a><a href="#h4-12-112" id="h4-12-112" class="d">-                    self.build_expression(scope, *rhs)?.into(),
</a><a href="#h4-12-113" id="h4-12-113" class="i">+                    LessThan(build(lhs.clone())?, build(rhs.clone())?).into(),
</a><a href="#h4-12-114" id="h4-12-114" class="i">+                    Equal(build(lhs)?, build(rhs)?).into(),
</a>                 ),
<a href="#h4-12-116" id="h4-12-116" class="i">+                ast::Operator::Like(lhs, rhs) =&gt; Like(build(lhs)?, build(rhs)?),
</a><a href="#h4-12-117" id="h4-12-117" class="i">+                ast::Operator::NotEqual(lhs, rhs) =&gt; Not(Equal(build(lhs)?, build(rhs)?).into()),
</a><a href="#h4-12-118" id="h4-12-118" class="i">+
</a><a href="#h4-12-119" id="h4-12-119" class="i">+                ast::Operator::Add(lhs, rhs) =&gt; Add(build(lhs)?, build(rhs)?),
</a><a href="#h4-12-120" id="h4-12-120" class="i">+                ast::Operator::Divide(lhs, rhs) =&gt; Divide(build(lhs)?, build(rhs)?),
</a><a href="#h4-12-121" id="h4-12-121" class="i">+                ast::Operator::Exponentiate(lhs, rhs) =&gt; Exponentiate(build(lhs)?, build(rhs)?),
</a><a href="#h4-12-122" id="h4-12-122" class="i">+                ast::Operator::Factorial(expr) =&gt; Factorial(build(expr)?),
</a><a href="#h4-12-123" id="h4-12-123" class="i">+                ast::Operator::Identity(expr) =&gt; Identity(build(expr)?),
</a><a href="#h4-12-124" id="h4-12-124" class="i">+                ast::Operator::Modulo(lhs, rhs) =&gt; Modulo(build(lhs)?, build(rhs)?),
</a><a href="#h4-12-125" id="h4-12-125" class="i">+                ast::Operator::Multiply(lhs, rhs) =&gt; Multiply(build(lhs)?, build(rhs)?),
</a><a href="#h4-12-126" id="h4-12-126" class="i">+                ast::Operator::Negate(expr) =&gt; Negate(build(expr)?),
</a><a href="#h4-12-127" id="h4-12-127" class="i">+                ast::Operator::Subtract(lhs, rhs) =&gt; Subtract(build(lhs)?, build(rhs)?),
</a>             },
         })
     }
 
     /// Builds and evaluates a constant AST expression.
<a href="#h4-12-133" id="h4-12-133" class="d">-    fn evaluate_constant(&amp;self, expr: ast::Expression) -&gt; Result&lt;Value&gt; {
</a><a href="#h4-12-134" id="h4-12-134" class="d">-        self.build_expression(&amp;mut Scope::constant(), expr)?.evaluate(None)
</a><a href="#h4-12-135" id="h4-12-135" class="i">+    fn evaluate_constant(expr: ast::Expression) -&gt; Result&lt;Value&gt; {
</a><a href="#h4-12-136" id="h4-12-136" class="i">+        Self::build_expression(expr, &amp;Scope::new())?.evaluate(None)
</a><a href="#h4-12-137" id="h4-12-137" class="i">+    }
</a><a href="#h4-12-138" id="h4-12-138" class="i">+
</a><a href="#h4-12-139" id="h4-12-139" class="i">+    /// Checks whether a given expression is an aggregate expression.
</a><a href="#h4-12-140" id="h4-12-140" class="i">+    fn is_aggregate(expr: &amp;ast::Expression) -&gt; bool {
</a><a href="#h4-12-141" id="h4-12-141" class="i">+        expr.contains(
</a><a href="#h4-12-142" id="h4-12-142" class="i">+            &amp;|e| matches!(e, ast::Expression::Function(f, _) if Aggregate::from_name(f).is_some()),
</a><a href="#h4-12-143" id="h4-12-143" class="i">+        )
</a>     }
 }
 
<a href="#h4-12-147" id="h4-12-147" class="d">-/// Manages names available to expressions and executors, and maps them onto columns/fields.
</a><a href="#h4-12-148" id="h4-12-148" class="d">-#[derive(Clone, Debug)]
</a><a href="#h4-12-149" id="h4-12-149" class="i">+/// A scope maps column/table names to input column indexes for expressions,
</a><a href="#h4-12-150" id="h4-12-150" class="i">+/// and keeps track of output column names.
</a><a href="#h4-12-151" id="h4-12-151" class="i">+///
</a><a href="#h4-12-152" id="h4-12-152" class="i">+/// Expression evaluation generally happens in the context of an input row. This
</a><a href="#h4-12-153" id="h4-12-153" class="i">+/// row may come directly from a single table, or it may be the result of a long
</a><a href="#h4-12-154" id="h4-12-154" class="i">+/// chain of joins and projections. The scope keeps track of which columns are
</a><a href="#h4-12-155" id="h4-12-155" class="i">+/// currently visible and what names they have. During expression planning, the
</a><a href="#h4-12-156" id="h4-12-156" class="i">+/// scope is used to resolve column names to column indexes, which are placed in
</a><a href="#h4-12-157" id="h4-12-157" class="i">+/// the plan and used during execution.
</a><a href="#h4-12-158" id="h4-12-158" class="i">+///
</a><a href="#h4-12-159" id="h4-12-159" class="i">+/// TODO: try to use borrows in the scope, to avoid cloning all the time.
</a> pub struct Scope {
<a href="#h4-12-161" id="h4-12-161" class="d">-    // If true, the scope is constant and cannot contain any variables.
</a><a href="#h4-12-162" id="h4-12-162" class="d">-    constant: bool,
</a><a href="#h4-12-163" id="h4-12-163" class="d">-    // Currently visible tables, by query name (i.e. alias or actual name).
</a><a href="#h4-12-164" id="h4-12-164" class="d">-    tables: HashMap&lt;String, Table&gt;,
</a><a href="#h4-12-165" id="h4-12-165" class="d">-    // Column labels, if any (qualified by table name when available)
</a><a href="#h4-12-166" id="h4-12-166" class="d">-    columns: Vec&lt;(Option&lt;String&gt;, Option&lt;String&gt;)&gt;,
</a><a href="#h4-12-167" id="h4-12-167" class="d">-    // Qualified names to column indexes.
</a><a href="#h4-12-168" id="h4-12-168" class="i">+    /// The currently visible columns. If empty, only constant expressions can
</a><a href="#h4-12-169" id="h4-12-169" class="i">+    /// be used (no field references).
</a><a href="#h4-12-170" id="h4-12-170" class="i">+    columns: Vec&lt;Option&lt;Label&gt;&gt;,
</a><a href="#h4-12-171" id="h4-12-171" class="i">+    /// Index of currently visible tables, by query name (e.g. may be aliased).
</a><a href="#h4-12-172" id="h4-12-172" class="i">+    tables: HashSet&lt;String&gt;,
</a><a href="#h4-12-173" id="h4-12-173" class="i">+    /// Index of fully qualified table.column names to column indexes. Qualified
</a><a href="#h4-12-174" id="h4-12-174" class="i">+    /// names are always unique within a scope.
</a>     qualified: HashMap&lt;(String, String), usize&gt;,
<a href="#h4-12-176" id="h4-12-176" class="d">-    // Unqualified names to column indexes, if unique.
</a><a href="#h4-12-177" id="h4-12-177" class="d">-    unqualified: HashMap&lt;String, usize&gt;,
</a><a href="#h4-12-178" id="h4-12-178" class="d">-    // Unqialified ambiguous names.
</a><a href="#h4-12-179" id="h4-12-179" class="d">-    ambiguous: HashSet&lt;String&gt;,
</a><a href="#h4-12-180" id="h4-12-180" class="i">+    /// Index of unqualified column names to column indexes. If a name points
</a><a href="#h4-12-181" id="h4-12-181" class="i">+    /// to multiple columns, lookups will fail with an ambiguous name error.
</a><a href="#h4-12-182" id="h4-12-182" class="i">+    unqualified: HashMap&lt;String, Vec&lt;usize&gt;&gt;,
</a> }
 
 impl Scope {
     /// Creates a new, empty scope.
     fn new() -&gt; Self {
         Self {
<a href="#h4-12-189" id="h4-12-189" class="d">-            constant: false,
</a><a href="#h4-12-190" id="h4-12-190" class="d">-            tables: HashMap::new(),
</a>             columns: Vec::new(),
<a href="#h4-12-192" id="h4-12-192" class="i">+            tables: HashSet::new(),
</a>             qualified: HashMap::new(),
             unqualified: HashMap::new(),
<a href="#h4-12-195" id="h4-12-195" class="d">-            ambiguous: HashSet::new(),
</a>         }
     }
 
<a href="#h4-12-199" id="h4-12-199" class="d">-    /// Creates a constant scope.
</a><a href="#h4-12-200" id="h4-12-200" class="d">-    fn constant() -&gt; Self {
</a><a href="#h4-12-201" id="h4-12-201" class="i">+    /// Creates a scope from a table, using the table&#39;s original name.
</a><a href="#h4-12-202" id="h4-12-202" class="i">+    fn from_table(table: &amp;Table) -&gt; Result&lt;Self&gt; {
</a>         let mut scope = Self::new();
<a href="#h4-12-204" id="h4-12-204" class="d">-        scope.constant = true;
</a><a href="#h4-12-205" id="h4-12-205" class="d">-        scope
</a><a href="#h4-12-206" id="h4-12-206" class="d">-    }
</a><a href="#h4-12-207" id="h4-12-207" class="d">-
</a><a href="#h4-12-208" id="h4-12-208" class="d">-    /// Creates a scope from a table.
</a><a href="#h4-12-209" id="h4-12-209" class="d">-    fn from_table(table: Table) -&gt; Result&lt;Self&gt; {
</a><a href="#h4-12-210" id="h4-12-210" class="d">-        let mut scope = Self::new();
</a><a href="#h4-12-211" id="h4-12-211" class="d">-        scope.add_table(table.name.clone(), table)?;
</a><a href="#h4-12-212" id="h4-12-212" class="i">+        scope.add_table(&amp;table.name, table)?;
</a>         Ok(scope)
     }
 
<a href="#h4-12-216" id="h4-12-216" class="d">-    /// Adds a column to the scope.
</a><a href="#h4-12-217" id="h4-12-217" class="d">-    #[allow(clippy::map_entry)]
</a><a href="#h4-12-218" id="h4-12-218" class="d">-    fn add_column(&amp;mut self, table: Option&lt;String&gt;, label: Option&lt;String&gt;) {
</a><a href="#h4-12-219" id="h4-12-219" class="d">-        if let Some(l) = label.clone() {
</a><a href="#h4-12-220" id="h4-12-220" class="d">-            if let Some(t) = table.clone() {
</a><a href="#h4-12-221" id="h4-12-221" class="d">-                self.qualified.insert((t, l.clone()), self.columns.len());
</a><a href="#h4-12-222" id="h4-12-222" class="d">-            }
</a><a href="#h4-12-223" id="h4-12-223" class="d">-            if !self.ambiguous.contains(&amp;l) {
</a><a href="#h4-12-224" id="h4-12-224" class="d">-                if !self.unqualified.contains_key(&amp;l) {
</a><a href="#h4-12-225" id="h4-12-225" class="d">-                    self.unqualified.insert(l, self.columns.len());
</a><a href="#h4-12-226" id="h4-12-226" class="d">-                } else {
</a><a href="#h4-12-227" id="h4-12-227" class="d">-                    self.unqualified.remove(&amp;l);
</a><a href="#h4-12-228" id="h4-12-228" class="d">-                    self.ambiguous.insert(l);
</a><a href="#h4-12-229" id="h4-12-229" class="d">-                }
</a><a href="#h4-12-230" id="h4-12-230" class="d">-            }
</a><a href="#h4-12-231" id="h4-12-231" class="d">-        }
</a><a href="#h4-12-232" id="h4-12-232" class="d">-        self.columns.push((table, label));
</a><a href="#h4-12-233" id="h4-12-233" class="d">-    }
</a><a href="#h4-12-234" id="h4-12-234" class="d">-
</a><a href="#h4-12-235" id="h4-12-235" class="d">-    /// Adds a table to the scope.
</a><a href="#h4-12-236" id="h4-12-236" class="d">-    fn add_table(&amp;mut self, label: String, table: Table) -&gt; Result&lt;()&gt; {
</a><a href="#h4-12-237" id="h4-12-237" class="d">-        if self.constant {
</a><a href="#h4-12-238" id="h4-12-238" class="d">-            panic!(&quot;can&#39;t modify constant scope&quot;);
</a><a href="#h4-12-239" id="h4-12-239" class="d">-        }
</a><a href="#h4-12-240" id="h4-12-240" class="d">-        if self.tables.contains_key(&amp;label) {
</a><a href="#h4-12-241" id="h4-12-241" class="i">+    /// Adds a table to the scope. The label is either the table&#39;s original name
</a><a href="#h4-12-242" id="h4-12-242" class="i">+    /// or an alias, and must be unique. All table columns are added, in order.
</a><a href="#h4-12-243" id="h4-12-243" class="i">+    fn add_table(&amp;mut self, label: &amp;str, table: &amp;Table) -&gt; Result&lt;()&gt; {
</a><a href="#h4-12-244" id="h4-12-244" class="i">+        if self.tables.contains(label) {
</a>             return errinput!(&quot;duplicate table name {label}&quot;);
         }
         for column in &amp;table.columns {
<a href="#h4-12-248" id="h4-12-248" class="d">-            self.add_column(Some(label.clone()), Some(column.name.clone()));
</a><a href="#h4-12-249" id="h4-12-249" class="i">+            self.add_column(Some((Some(label.to_string()), column.name.clone())));
</a>         }
<a href="#h4-12-251" id="h4-12-251" class="d">-        self.tables.insert(label, table);
</a><a href="#h4-12-252" id="h4-12-252" class="i">+        self.tables.insert(label.to_string());
</a>         Ok(())
     }
 
<a href="#h4-12-256" id="h4-12-256" class="d">-    /// Fetches a column from the scope by index.
</a><a href="#h4-12-257" id="h4-12-257" class="d">-    fn get_column(&amp;self, index: usize) -&gt; Result&lt;(Option&lt;String&gt;, Option&lt;String&gt;)&gt; {
</a><a href="#h4-12-258" id="h4-12-258" class="d">-        if self.constant {
</a><a href="#h4-12-259" id="h4-12-259" class="d">-            return errinput!(&quot;expression must be constant, found column {index}&quot;);
</a><a href="#h4-12-260" id="h4-12-260" class="d">-        }
</a><a href="#h4-12-261" id="h4-12-261" class="d">-        self.columns.get(index).cloned().ok_or(errinput!(&quot;column index {index} not found&quot;))
</a><a href="#h4-12-262" id="h4-12-262" class="d">-    }
</a><a href="#h4-12-263" id="h4-12-263" class="d">-
</a><a href="#h4-12-264" id="h4-12-264" class="d">-    /// Fetches a column label by index, if any.
</a><a href="#h4-12-265" id="h4-12-265" class="d">-    fn get_label(&amp;self, index: usize) -&gt; Result&lt;Option&lt;(Option&lt;String&gt;, String)&gt;&gt; {
</a><a href="#h4-12-266" id="h4-12-266" class="d">-        Ok(match self.get_column(index)? {
</a><a href="#h4-12-267" id="h4-12-267" class="d">-            (table, Some(name)) =&gt; Some((table, name)),
</a><a href="#h4-12-268" id="h4-12-268" class="d">-            _ =&gt; None,
</a><a href="#h4-12-269" id="h4-12-269" class="d">-        })
</a><a href="#h4-12-270" id="h4-12-270" class="d">-    }
</a><a href="#h4-12-271" id="h4-12-271" class="d">-
</a><a href="#h4-12-272" id="h4-12-272" class="d">-    /// Merges two scopes, by appending the given scope to self.
</a><a href="#h4-12-273" id="h4-12-273" class="d">-    fn merge(&amp;mut self, scope: Scope) -&gt; Result&lt;()&gt; {
</a><a href="#h4-12-274" id="h4-12-274" class="d">-        if self.constant {
</a><a href="#h4-12-275" id="h4-12-275" class="d">-            panic!(&quot;can&#39;t modify constant scope&quot;);
</a><a href="#h4-12-276" id="h4-12-276" class="d">-        }
</a><a href="#h4-12-277" id="h4-12-277" class="d">-        for (label, table) in scope.tables {
</a><a href="#h4-12-278" id="h4-12-278" class="d">-            if self.tables.contains_key(&amp;label) {
</a><a href="#h4-12-279" id="h4-12-279" class="d">-                return errinput!(&quot;duplicate table name {label}&quot;);
</a><a href="#h4-12-280" id="h4-12-280" class="i">+    /// Adds a column and label to the scope.
</a><a href="#h4-12-281" id="h4-12-281" class="i">+    fn add_column(&amp;mut self, label: Option&lt;Label&gt;) {
</a><a href="#h4-12-282" id="h4-12-282" class="i">+        if let Some((table, column)) = &amp;label {
</a><a href="#h4-12-283" id="h4-12-283" class="i">+            let index = self.len();
</a><a href="#h4-12-284" id="h4-12-284" class="i">+            if let Some(table) = table {
</a><a href="#h4-12-285" id="h4-12-285" class="i">+                self.qualified.insert((table.clone(), column.clone()), index);
</a>             }
<a href="#h4-12-287" id="h4-12-287" class="d">-            self.tables.insert(label, table);
</a><a href="#h4-12-288" id="h4-12-288" class="i">+            self.unqualified.entry(column.clone()).or_default().push(index)
</a>         }
<a href="#h4-12-290" id="h4-12-290" class="d">-        for (table, label) in scope.columns {
</a><a href="#h4-12-291" id="h4-12-291" class="d">-            self.add_column(table, label);
</a><a href="#h4-12-292" id="h4-12-292" class="d">-        }
</a><a href="#h4-12-293" id="h4-12-293" class="d">-        Ok(())
</a><a href="#h4-12-294" id="h4-12-294" class="i">+        self.columns.push(label)
</a>     }
 
<a href="#h4-12-297" id="h4-12-297" class="d">-    /// Resolves a name, optionally qualified by a table name.
</a><a href="#h4-12-298" id="h4-12-298" class="d">-    fn resolve(&amp;self, table: Option&lt;&amp;str&gt;, name: &amp;str) -&gt; Result&lt;usize&gt; {
</a><a href="#h4-12-299" id="h4-12-299" class="d">-        if self.constant {
</a><a href="#h4-12-300" id="h4-12-300" class="d">-            return errinput!(
</a><a href="#h4-12-301" id="h4-12-301" class="d">-                &quot;expression must be constant, found field {}&quot;,
</a><a href="#h4-12-302" id="h4-12-302" class="d">-                if let Some(table) = table { format!(&quot;{}.{}&quot;, table, name) } else { name.into() }
</a><a href="#h4-12-303" id="h4-12-303" class="d">-            );
</a><a href="#h4-12-304" id="h4-12-304" class="i">+    /// Looks up a column index by name, if possible.
</a><a href="#h4-12-305" id="h4-12-305" class="i">+    fn get_column_index(&amp;self, table: Option&lt;&amp;str&gt;, name: &amp;str) -&gt; Result&lt;usize&gt; {
</a><a href="#h4-12-306" id="h4-12-306" class="i">+        if self.columns.is_empty() {
</a><a href="#h4-12-307" id="h4-12-307" class="i">+            let field = table.map(|t| format!(&quot;{t}.{name}&quot;)).unwrap_or(name.to_string());
</a><a href="#h4-12-308" id="h4-12-308" class="i">+            return errinput!(&quot;expression must be constant, found field {field}&quot;);
</a>         }
         if let Some(table) = table {
<a href="#h4-12-311" id="h4-12-311" class="d">-            if !self.tables.contains_key(table) {
</a><a href="#h4-12-312" id="h4-12-312" class="i">+            if !self.tables.contains(table) {
</a>                 return errinput!(&quot;unknown table {table}&quot;);
             }
             self.qualified
<a href="#h4-12-316" id="h4-12-316" class="d">-                .get(&amp;(table.into(), name.into()))
</a><a href="#h4-12-317" id="h4-12-317" class="i">+                .get(&amp;(table.to_string(), name.to_string()))
</a>                 .copied()
<a href="#h4-12-319" id="h4-12-319" class="d">-                .ok_or(errinput!(&quot;Unknown field {table}.{name}&quot;))
</a><a href="#h4-12-320" id="h4-12-320" class="d">-        } else if self.ambiguous.contains(name) {
</a><a href="#h4-12-321" id="h4-12-321" class="d">-            errinput!(&quot;ambiguous field {name}&quot;)
</a><a href="#h4-12-322" id="h4-12-322" class="i">+                .ok_or(errinput!(&quot;unknown field {table}.{name}&quot;))
</a><a href="#h4-12-323" id="h4-12-323" class="i">+        } else if let Some(indexes) = self.unqualified.get(name) {
</a><a href="#h4-12-324" id="h4-12-324" class="i">+            if indexes.len() &gt; 1 {
</a><a href="#h4-12-325" id="h4-12-325" class="i">+                return errinput!(&quot;ambiguous field {name}&quot;);
</a><a href="#h4-12-326" id="h4-12-326" class="i">+            }
</a><a href="#h4-12-327" id="h4-12-327" class="i">+            Ok(indexes[0])
</a>         } else {
<a href="#h4-12-329" id="h4-12-329" class="d">-            self.unqualified.get(name).copied().ok_or(errinput!(&quot;unknown field {name}&quot;))
</a><a href="#h4-12-330" id="h4-12-330" class="i">+            errinput!(&quot;unknown field {name}&quot;)
</a><a href="#h4-12-331" id="h4-12-331" class="i">+        }
</a><a href="#h4-12-332" id="h4-12-332" class="i">+    }
</a><a href="#h4-12-333" id="h4-12-333" class="i">+
</a><a href="#h4-12-334" id="h4-12-334" class="i">+    /// Fetches a column label by index, if any.
</a><a href="#h4-12-335" id="h4-12-335" class="i">+    /// TODO: this can possibly be removed if execution doesn&#39;t have to pass
</a><a href="#h4-12-336" id="h4-12-336" class="i">+    /// columns through QueryIterator.
</a><a href="#h4-12-337" id="h4-12-337" class="i">+    fn get_column_label(&amp;self, index: usize) -&gt; Result&lt;Option&lt;Label&gt;&gt; {
</a><a href="#h4-12-338" id="h4-12-338" class="i">+        if self.columns.is_empty() {
</a><a href="#h4-12-339" id="h4-12-339" class="i">+            return errinput!(&quot;expression must be constant, found column index {index}&quot;);
</a><a href="#h4-12-340" id="h4-12-340" class="i">+        }
</a><a href="#h4-12-341" id="h4-12-341" class="i">+        match self.columns.get(index) {
</a><a href="#h4-12-342" id="h4-12-342" class="i">+            Some(label) =&gt; Ok(label.clone()),
</a><a href="#h4-12-343" id="h4-12-343" class="i">+            None =&gt; errinput!(&quot;column index {index} not found&quot;),
</a>         }
     }
 
<a href="#h4-12-347" id="h4-12-347" class="d">-    /// Number of columns in the current scope.
</a><a href="#h4-12-348" id="h4-12-348" class="i">+    /// Resolves a name, optionally qualified by a table name.
</a><a href="#h4-12-349" id="h4-12-349" class="i">+    /// Number of columns currently in the scope.
</a>     fn len(&amp;self) -&gt; usize {
         self.columns.len()
     }
 
<a href="#h4-12-354" id="h4-12-354" class="d">-    /// Projects the scope. This takes a set of expressions and labels in the current scope,
</a><a href="#h4-12-355" id="h4-12-355" class="d">-    /// and returns a new scope for the projection.
</a><a href="#h4-12-356" id="h4-12-356" class="i">+    /// Merges two scopes, by appending the given scope to self.
</a><a href="#h4-12-357" id="h4-12-357" class="i">+    fn merge(&amp;mut self, scope: Scope) -&gt; Result&lt;()&gt; {
</a><a href="#h4-12-358" id="h4-12-358" class="i">+        for table in scope.tables {
</a><a href="#h4-12-359" id="h4-12-359" class="i">+            if self.tables.contains(&amp;table) {
</a><a href="#h4-12-360" id="h4-12-360" class="i">+                return errinput!(&quot;duplicate table name {table}&quot;);
</a><a href="#h4-12-361" id="h4-12-361" class="i">+            }
</a><a href="#h4-12-362" id="h4-12-362" class="i">+            self.tables.insert(table);
</a><a href="#h4-12-363" id="h4-12-363" class="i">+        }
</a><a href="#h4-12-364" id="h4-12-364" class="i">+        for label in scope.columns {
</a><a href="#h4-12-365" id="h4-12-365" class="i">+            self.add_column(label);
</a><a href="#h4-12-366" id="h4-12-366" class="i">+        }
</a><a href="#h4-12-367" id="h4-12-367" class="i">+        Ok(())
</a><a href="#h4-12-368" id="h4-12-368" class="i">+    }
</a><a href="#h4-12-369" id="h4-12-369" class="i">+
</a><a href="#h4-12-370" id="h4-12-370" class="i">+    /// Projects the scope via the given expressions, creating a new scope with
</a><a href="#h4-12-371" id="h4-12-371" class="i">+    /// one column per expression. These may be a simple field reference (e.g.
</a><a href="#h4-12-372" id="h4-12-372" class="i">+    /// &quot;SELECT b, a FROM table&quot;), which passes through the corresponding column
</a><a href="#h4-12-373" id="h4-12-373" class="i">+    /// from the original scope and retains its qualified and unqualified names.
</a><a href="#h4-12-374" id="h4-12-374" class="i">+    /// Otherwise, for non-trivial field references, a new column is created for
</a><a href="#h4-12-375" id="h4-12-375" class="i">+    /// the expression. An explicit label may also be given for each column.
</a><a href="#h4-12-376" id="h4-12-376" class="i">+    /// Table sets are retained.
</a>     fn project(&amp;mut self, expressions: &amp;[Expression], labels: &amp;[Option&lt;Label&gt;]) -&gt; Result&lt;()&gt; {
<a href="#h4-12-378" id="h4-12-378" class="d">-        if self.constant {
</a><a href="#h4-12-379" id="h4-12-379" class="d">-            panic!(&quot;can&#39;t modify constant scope&quot;);
</a><a href="#h4-12-380" id="h4-12-380" class="i">+        assert_eq!(expressions.len(), labels.len());
</a><a href="#h4-12-381" id="h4-12-381" class="i">+
</a><a href="#h4-12-382" id="h4-12-382" class="i">+        // Extract the old columns and clear the indexes. Keep the table index.
</a><a href="#h4-12-383" id="h4-12-383" class="i">+        let columns = std::mem::take(&amp;mut self.columns);
</a><a href="#h4-12-384" id="h4-12-384" class="i">+        self.qualified.clear();
</a><a href="#h4-12-385" id="h4-12-385" class="i">+        self.unqualified.clear();
</a><a href="#h4-12-386" id="h4-12-386" class="i">+
</a><a href="#h4-12-387" id="h4-12-387" class="i">+        // Map projected field references to old columns.
</a><a href="#h4-12-388" id="h4-12-388" class="i">+        let mut field_map: HashMap&lt;usize, usize&gt; = HashMap::new();
</a><a href="#h4-12-389" id="h4-12-389" class="i">+        for (i, expr) in expressions.iter().enumerate() {
</a><a href="#h4-12-390" id="h4-12-390" class="i">+            if let Expression::Field(f, _) = expr {
</a><a href="#h4-12-391" id="h4-12-391" class="i">+                field_map.insert(i, *f);
</a><a href="#h4-12-392" id="h4-12-392" class="i">+            }
</a>         }
<a href="#h4-12-394" id="h4-12-394" class="d">-        let mut new = Self::new();
</a><a href="#h4-12-395" id="h4-12-395" class="d">-        new.tables = self.tables.clone();
</a><a href="#h4-12-396" id="h4-12-396" class="d">-        for (expr, label) in expressions.iter().zip(labels) {
</a><a href="#h4-12-397" id="h4-12-397" class="d">-            match (expr, label) {
</a><a href="#h4-12-398" id="h4-12-398" class="d">-                (_, Some((None, label))) =&gt; new.add_column(None, Some(label.clone())),
</a><a href="#h4-12-399" id="h4-12-399" class="d">-                (Expression::Field(_, Some((Some(table), name))), _) =&gt; {
</a><a href="#h4-12-400" id="h4-12-400" class="d">-                    new.add_column(Some(table.clone()), Some(name.clone()))
</a><a href="#h4-12-401" id="h4-12-401" class="d">-                }
</a><a href="#h4-12-402" id="h4-12-402" class="d">-                (Expression::Field(_, Some((None, name))), _) =&gt; {
</a><a href="#h4-12-403" id="h4-12-403" class="d">-                    if let Some(i) = self.unqualified.get(name) {
</a><a href="#h4-12-404" id="h4-12-404" class="d">-                        let (table, name) = self.columns[*i].clone();
</a><a href="#h4-12-405" id="h4-12-405" class="d">-                        new.add_column(table, name);
</a><a href="#h4-12-406" id="h4-12-406" class="d">-                    }
</a><a href="#h4-12-407" id="h4-12-407" class="d">-                }
</a><a href="#h4-12-408" id="h4-12-408" class="d">-                (Expression::Field(i, None), _) =&gt; {
</a><a href="#h4-12-409" id="h4-12-409" class="d">-                    let (table, label) = self.columns.get(*i).cloned().unwrap_or((None, None));
</a><a href="#h4-12-410" id="h4-12-410" class="d">-                    new.add_column(table, label)
</a><a href="#h4-12-411" id="h4-12-411" class="d">-                }
</a><a href="#h4-12-412" id="h4-12-412" class="d">-                _ =&gt; new.add_column(None, None),
</a><a href="#h4-12-413" id="h4-12-413" class="i">+
</a><a href="#h4-12-414" id="h4-12-414" class="i">+        // Construct the new columns and labels.
</a><a href="#h4-12-415" id="h4-12-415" class="i">+        for (i, label) in labels.iter().enumerate() {
</a><a href="#h4-12-416" id="h4-12-416" class="i">+            if label.is_some() {
</a><a href="#h4-12-417" id="h4-12-417" class="i">+                self.add_column(label.clone()); // explicit label
</a><a href="#h4-12-418" id="h4-12-418" class="i">+            } else if let Some(f) = field_map.get(&amp;i) {
</a><a href="#h4-12-419" id="h4-12-419" class="i">+                self.add_column(columns[*f].clone()) // field reference
</a><a href="#h4-12-420" id="h4-12-420" class="i">+            } else {
</a><a href="#h4-12-421" id="h4-12-421" class="i">+                self.add_column(None) // unlabeled expression
</a>             }
         }
<a href="#h4-12-424" id="h4-12-424" class="d">-        *self = new;
</a>         Ok(())
     }
 }
<b>diff --git a/<a id="h5" href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a> b/<a href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -321,7 +321,7 @@ pub type Row = Vec&lt;Value&gt;;
</a> /// TODO: try to avoid boxing here.
 pub type Rows = Box&lt;dyn Iterator&lt;Item = Result&lt;Row&gt;&gt;&gt;;
 
<a href="#h5-0-3" id="h5-0-3" class="d">-/// A column label, consisting of an option table name and a column name.
</a><a href="#h5-0-4" id="h5-0-4" class="i">+/// A column label, consisting of an optional table name and a column name.
</a> ///
 /// TODO: use this more broadly.
 pub type Label = (Option&lt;String&gt;, String);
<b>diff --git a/<a id="h6" href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a> b/<a href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans WHERE b IS 
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h6-0-3" id="h6-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h6-0-4" id="h6-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: b, b, b, b, b
       └─ Scan: booleans (NOT b IS NULL)
 
<a href="#h6-1" id="h6-1" class="h">@@ -98,8 +98,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h6-1-3" id="h6-1-3" class="d">-Plan: Select(
</a><a href="#h6-1-4" id="h6-1-4" class="d">-    Projection {
</a><a href="#h6-1-5" id="h6-1-5" class="i">+Plan: Select {
</a><a href="#h6-1-6" id="h6-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Filter {
<a href="#h6-2" id="h6-2" class="h">@@ -130,8 +130,8 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h6-2-3" id="h6-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h6-2-5" id="h6-2-5" class="i">+                        alias: None,
</a>                     },
                     predicate: Not(
                         IsNull(
<a href="#h6-3" id="h6-3" class="h">@@ -147,13 +147,6 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h6-3-3" id="h6-3-3" class="d">-                labels: [
</a><a href="#h6-3-4" id="h6-3-4" class="d">-                    None,
</a><a href="#h6-3-5" id="h6-3-5" class="d">-                    None,
</a><a href="#h6-3-6" id="h6-3-6" class="d">-                    None,
</a><a href="#h6-3-7" id="h6-3-7" class="d">-                    None,
</a><a href="#h6-3-8" id="h6-3-8" class="d">-                    None,
</a><a href="#h6-3-9" id="h6-3-9" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h6-4" id="h6-4" class="h">@@ -201,6 +194,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h6-4-3" id="h6-4-3" class="i">+                labels: [
</a><a href="#h6-4-4" id="h6-4-4" class="i">+                    None,
</a><a href="#h6-4-5" id="h6-4-5" class="i">+                    None,
</a><a href="#h6-4-6" id="h6-4-6" class="i">+                    None,
</a><a href="#h6-4-7" id="h6-4-7" class="i">+                    None,
</a><a href="#h6-4-8" id="h6-4-8" class="i">+                    None,
</a><a href="#h6-4-9" id="h6-4-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h6-5" id="h6-5" class="h">@@ -210,13 +210,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h6-5-3" id="h6-5-3" class="d">-        labels: [
</a><a href="#h6-5-4" id="h6-5-4" class="d">-            None,
</a><a href="#h6-5-5" id="h6-5-5" class="d">-            None,
</a><a href="#h6-5-6" id="h6-5-6" class="d">-            None,
</a><a href="#h6-5-7" id="h6-5-7" class="d">-            None,
</a><a href="#h6-5-8" id="h6-5-8" class="d">-            None,
</a><a href="#h6-5-9" id="h6-5-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h6-6" id="h6-6" class="h">@@ -239,11 +232,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h6-6-3" id="h6-6-3" class="i">+        labels: [
</a><a href="#h6-6-4" id="h6-6-4" class="i">+            None,
</a><a href="#h6-6-5" id="h6-6-5" class="i">+            None,
</a><a href="#h6-6-6" id="h6-6-6" class="i">+            None,
</a><a href="#h6-6-7" id="h6-6-7" class="i">+            None,
</a><a href="#h6-6-8" id="h6-6-8" class="i">+            None,
</a><a href="#h6-6-9" id="h6-6-9" class="i">+        ],
</a>     },
<a href="#h6-6-11" id="h6-6-11" class="d">-)
</a><a href="#h6-6-12" id="h6-6-12" class="i">+    labels: [
</a><a href="#h6-6-13" id="h6-6-13" class="i">+        None,
</a><a href="#h6-6-14" id="h6-6-14" class="i">+        None,
</a><a href="#h6-6-15" id="h6-6-15" class="i">+        None,
</a><a href="#h6-6-16" id="h6-6-16" class="i">+        None,
</a><a href="#h6-6-17" id="h6-6-17" class="i">+        None,
</a><a href="#h6-6-18" id="h6-6-18" class="i">+    ],
</a><a href="#h6-6-19" id="h6-6-19" class="i">+}
</a> 
<a href="#h6-6-21" id="h6-6-21" class="d">-Optimized plan: Select(
</a><a href="#h6-6-22" id="h6-6-22" class="d">-    Projection {
</a><a href="#h6-6-23" id="h6-6-23" class="i">+Optimized plan: Select {
</a><a href="#h6-6-24" id="h6-6-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h6-7" id="h6-7" class="h">@@ -273,7 +280,6 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h6-7-3" id="h6-7-3" class="d">-                    alias: None,
</a>                     filter: Some(
                         Not(
                             IsNull(
<a href="#h6-8" id="h6-8" class="h">@@ -289,14 +295,8 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h6-8-3" id="h6-8-3" class="i">+                    alias: None,
</a>                 },
<a href="#h6-8-5" id="h6-8-5" class="d">-                labels: [
</a><a href="#h6-8-6" id="h6-8-6" class="d">-                    None,
</a><a href="#h6-8-7" id="h6-8-7" class="d">-                    None,
</a><a href="#h6-8-8" id="h6-8-8" class="d">-                    None,
</a><a href="#h6-8-9" id="h6-8-9" class="d">-                    None,
</a><a href="#h6-8-10" id="h6-8-10" class="d">-                    None,
</a><a href="#h6-8-11" id="h6-8-11" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h6-9" id="h6-9" class="h">@@ -344,6 +344,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h6-9-3" id="h6-9-3" class="i">+                labels: [
</a><a href="#h6-9-4" id="h6-9-4" class="i">+                    None,
</a><a href="#h6-9-5" id="h6-9-5" class="i">+                    None,
</a><a href="#h6-9-6" id="h6-9-6" class="i">+                    None,
</a><a href="#h6-9-7" id="h6-9-7" class="i">+                    None,
</a><a href="#h6-9-8" id="h6-9-8" class="i">+                    None,
</a><a href="#h6-9-9" id="h6-9-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h6-10" id="h6-10" class="h">@@ -353,13 +360,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h6-10-3" id="h6-10-3" class="d">-        labels: [
</a><a href="#h6-10-4" id="h6-10-4" class="d">-            None,
</a><a href="#h6-10-5" id="h6-10-5" class="d">-            None,
</a><a href="#h6-10-6" id="h6-10-6" class="d">-            None,
</a><a href="#h6-10-7" id="h6-10-7" class="d">-            None,
</a><a href="#h6-10-8" id="h6-10-8" class="d">-            None,
</a><a href="#h6-10-9" id="h6-10-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h6-11" id="h6-11" class="h">@@ -382,6 +382,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h6-11-3" id="h6-11-3" class="i">+        labels: [
</a><a href="#h6-11-4" id="h6-11-4" class="i">+            None,
</a><a href="#h6-11-5" id="h6-11-5" class="i">+            None,
</a><a href="#h6-11-6" id="h6-11-6" class="i">+            None,
</a><a href="#h6-11-7" id="h6-11-7" class="i">+            None,
</a><a href="#h6-11-8" id="h6-11-8" class="i">+            None,
</a><a href="#h6-11-9" id="h6-11-9" class="i">+        ],
</a>     },
<a href="#h6-11-11" id="h6-11-11" class="d">-)
</a><a href="#h6-11-12" id="h6-11-12" class="i">+    labels: [
</a><a href="#h6-11-13" id="h6-11-13" class="i">+        None,
</a><a href="#h6-11-14" id="h6-11-14" class="i">+        None,
</a><a href="#h6-11-15" id="h6-11-15" class="i">+        None,
</a><a href="#h6-11-16" id="h6-11-16" class="i">+        None,
</a><a href="#h6-11-17" id="h6-11-17" class="i">+        None,
</a><a href="#h6-11-18" id="h6-11-18" class="i">+    ],
</a><a href="#h6-11-19" id="h6-11-19" class="i">+}
</a> 
<b>diff --git a/<a id="h7" href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a> b/<a href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h7-0-3" id="h7-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h7-0-4" id="h7-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: b, b, b, b, b
       └─ Scan: booleans
 
<a href="#h7-1" id="h7-1" class="h">@@ -85,8 +85,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h7-1-3" id="h7-1-3" class="d">-Plan: Select(
</a><a href="#h7-1-4" id="h7-1-4" class="d">-    Projection {
</a><a href="#h7-1-5" id="h7-1-5" class="i">+Plan: Select {
</a><a href="#h7-1-6" id="h7-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h7-2" id="h7-2" class="h">@@ -116,16 +116,9 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h7-2-3" id="h7-2-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h7-2-5" id="h7-2-5" class="i">+                    alias: None,
</a>                 },
<a href="#h7-2-7" id="h7-2-7" class="d">-                labels: [
</a><a href="#h7-2-8" id="h7-2-8" class="d">-                    None,
</a><a href="#h7-2-9" id="h7-2-9" class="d">-                    None,
</a><a href="#h7-2-10" id="h7-2-10" class="d">-                    None,
</a><a href="#h7-2-11" id="h7-2-11" class="d">-                    None,
</a><a href="#h7-2-12" id="h7-2-12" class="d">-                    None,
</a><a href="#h7-2-13" id="h7-2-13" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h7-3" id="h7-3" class="h">@@ -173,6 +166,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h7-3-3" id="h7-3-3" class="i">+                labels: [
</a><a href="#h7-3-4" id="h7-3-4" class="i">+                    None,
</a><a href="#h7-3-5" id="h7-3-5" class="i">+                    None,
</a><a href="#h7-3-6" id="h7-3-6" class="i">+                    None,
</a><a href="#h7-3-7" id="h7-3-7" class="i">+                    None,
</a><a href="#h7-3-8" id="h7-3-8" class="i">+                    None,
</a><a href="#h7-3-9" id="h7-3-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h7-4" id="h7-4" class="h">@@ -182,13 +182,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h7-4-3" id="h7-4-3" class="d">-        labels: [
</a><a href="#h7-4-4" id="h7-4-4" class="d">-            None,
</a><a href="#h7-4-5" id="h7-4-5" class="d">-            None,
</a><a href="#h7-4-6" id="h7-4-6" class="d">-            None,
</a><a href="#h7-4-7" id="h7-4-7" class="d">-            None,
</a><a href="#h7-4-8" id="h7-4-8" class="d">-            None,
</a><a href="#h7-4-9" id="h7-4-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h7-5" id="h7-5" class="h">@@ -211,11 +204,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h7-5-3" id="h7-5-3" class="i">+        labels: [
</a><a href="#h7-5-4" id="h7-5-4" class="i">+            None,
</a><a href="#h7-5-5" id="h7-5-5" class="i">+            None,
</a><a href="#h7-5-6" id="h7-5-6" class="i">+            None,
</a><a href="#h7-5-7" id="h7-5-7" class="i">+            None,
</a><a href="#h7-5-8" id="h7-5-8" class="i">+            None,
</a><a href="#h7-5-9" id="h7-5-9" class="i">+        ],
</a>     },
<a href="#h7-5-11" id="h7-5-11" class="d">-)
</a><a href="#h7-5-12" id="h7-5-12" class="i">+    labels: [
</a><a href="#h7-5-13" id="h7-5-13" class="i">+        None,
</a><a href="#h7-5-14" id="h7-5-14" class="i">+        None,
</a><a href="#h7-5-15" id="h7-5-15" class="i">+        None,
</a><a href="#h7-5-16" id="h7-5-16" class="i">+        None,
</a><a href="#h7-5-17" id="h7-5-17" class="i">+        None,
</a><a href="#h7-5-18" id="h7-5-18" class="i">+    ],
</a><a href="#h7-5-19" id="h7-5-19" class="i">+}
</a> 
<a href="#h7-5-21" id="h7-5-21" class="d">-Optimized plan: Select(
</a><a href="#h7-5-22" id="h7-5-22" class="d">-    Projection {
</a><a href="#h7-5-23" id="h7-5-23" class="i">+Optimized plan: Select {
</a><a href="#h7-5-24" id="h7-5-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h7-6" id="h7-6" class="h">@@ -245,16 +252,9 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h7-6-3" id="h7-6-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h7-6-5" id="h7-6-5" class="i">+                    alias: None,
</a>                 },
<a href="#h7-6-7" id="h7-6-7" class="d">-                labels: [
</a><a href="#h7-6-8" id="h7-6-8" class="d">-                    None,
</a><a href="#h7-6-9" id="h7-6-9" class="d">-                    None,
</a><a href="#h7-6-10" id="h7-6-10" class="d">-                    None,
</a><a href="#h7-6-11" id="h7-6-11" class="d">-                    None,
</a><a href="#h7-6-12" id="h7-6-12" class="d">-                    None,
</a><a href="#h7-6-13" id="h7-6-13" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h7-7" id="h7-7" class="h">@@ -302,6 +302,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h7-7-3" id="h7-7-3" class="i">+                labels: [
</a><a href="#h7-7-4" id="h7-7-4" class="i">+                    None,
</a><a href="#h7-7-5" id="h7-7-5" class="i">+                    None,
</a><a href="#h7-7-6" id="h7-7-6" class="i">+                    None,
</a><a href="#h7-7-7" id="h7-7-7" class="i">+                    None,
</a><a href="#h7-7-8" id="h7-7-8" class="i">+                    None,
</a><a href="#h7-7-9" id="h7-7-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h7-8" id="h7-8" class="h">@@ -311,13 +318,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h7-8-3" id="h7-8-3" class="d">-        labels: [
</a><a href="#h7-8-4" id="h7-8-4" class="d">-            None,
</a><a href="#h7-8-5" id="h7-8-5" class="d">-            None,
</a><a href="#h7-8-6" id="h7-8-6" class="d">-            None,
</a><a href="#h7-8-7" id="h7-8-7" class="d">-            None,
</a><a href="#h7-8-8" id="h7-8-8" class="d">-            None,
</a><a href="#h7-8-9" id="h7-8-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h7-9" id="h7-9" class="h">@@ -340,6 +340,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h7-9-3" id="h7-9-3" class="i">+        labels: [
</a><a href="#h7-9-4" id="h7-9-4" class="i">+            None,
</a><a href="#h7-9-5" id="h7-9-5" class="i">+            None,
</a><a href="#h7-9-6" id="h7-9-6" class="i">+            None,
</a><a href="#h7-9-7" id="h7-9-7" class="i">+            None,
</a><a href="#h7-9-8" id="h7-9-8" class="i">+            None,
</a><a href="#h7-9-9" id="h7-9-9" class="i">+        ],
</a>     },
<a href="#h7-9-11" id="h7-9-11" class="d">-)
</a><a href="#h7-9-12" id="h7-9-12" class="i">+    labels: [
</a><a href="#h7-9-13" id="h7-9-13" class="i">+        None,
</a><a href="#h7-9-14" id="h7-9-14" class="i">+        None,
</a><a href="#h7-9-15" id="h7-9-15" class="i">+        None,
</a><a href="#h7-9-16" id="h7-9-16" class="i">+        None,
</a><a href="#h7-9-17" id="h7-9-17" class="i">+        None,
</a><a href="#h7-9-18" id="h7-9-18" class="i">+    ],
</a><a href="#h7-9-19" id="h7-9-19" class="i">+}
</a> 
<b>diff --git a/<a id="h8" href="../file/tests/sql/query/agg_const.html">tests/sql/query/agg_const</a> b/<a href="../file/tests/sql/query/agg_const.html">tests/sql/query/agg_const</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3)
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h8-0-3" id="h8-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h8-0-4" id="h8-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: 3, 3, 3, 3, 3
       └─ Nothing
 
<a href="#h8-1" id="h8-1" class="h">@@ -86,18 +86,11 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h8-1-3" id="h8-1-3" class="d">-Plan: Select(
</a><a href="#h8-1-4" id="h8-1-4" class="d">-    Projection {
</a><a href="#h8-1-5" id="h8-1-5" class="i">+Plan: Select {
</a><a href="#h8-1-6" id="h8-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Nothing,
<a href="#h8-1-10" id="h8-1-10" class="d">-                labels: [
</a><a href="#h8-1-11" id="h8-1-11" class="d">-                    None,
</a><a href="#h8-1-12" id="h8-1-12" class="d">-                    None,
</a><a href="#h8-1-13" id="h8-1-13" class="d">-                    None,
</a><a href="#h8-1-14" id="h8-1-14" class="d">-                    None,
</a><a href="#h8-1-15" id="h8-1-15" class="d">-                    None,
</a><a href="#h8-1-16" id="h8-1-16" class="d">-                ],
</a>                 expressions: [
                     Constant(
                         Integer(
<a href="#h8-2" id="h8-2" class="h">@@ -125,6 +118,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h8-2-3" id="h8-2-3" class="i">+                labels: [
</a><a href="#h8-2-4" id="h8-2-4" class="i">+                    None,
</a><a href="#h8-2-5" id="h8-2-5" class="i">+                    None,
</a><a href="#h8-2-6" id="h8-2-6" class="i">+                    None,
</a><a href="#h8-2-7" id="h8-2-7" class="i">+                    None,
</a><a href="#h8-2-8" id="h8-2-8" class="i">+                    None,
</a><a href="#h8-2-9" id="h8-2-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h8-3" id="h8-3" class="h">@@ -134,13 +134,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h8-3-3" id="h8-3-3" class="d">-        labels: [
</a><a href="#h8-3-4" id="h8-3-4" class="d">-            None,
</a><a href="#h8-3-5" id="h8-3-5" class="d">-            None,
</a><a href="#h8-3-6" id="h8-3-6" class="d">-            None,
</a><a href="#h8-3-7" id="h8-3-7" class="d">-            None,
</a><a href="#h8-3-8" id="h8-3-8" class="d">-            None,
</a><a href="#h8-3-9" id="h8-3-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h8-4" id="h8-4" class="h">@@ -163,21 +156,28 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h8-4-3" id="h8-4-3" class="i">+        labels: [
</a><a href="#h8-4-4" id="h8-4-4" class="i">+            None,
</a><a href="#h8-4-5" id="h8-4-5" class="i">+            None,
</a><a href="#h8-4-6" id="h8-4-6" class="i">+            None,
</a><a href="#h8-4-7" id="h8-4-7" class="i">+            None,
</a><a href="#h8-4-8" id="h8-4-8" class="i">+            None,
</a><a href="#h8-4-9" id="h8-4-9" class="i">+        ],
</a>     },
<a href="#h8-4-11" id="h8-4-11" class="d">-)
</a><a href="#h8-4-12" id="h8-4-12" class="i">+    labels: [
</a><a href="#h8-4-13" id="h8-4-13" class="i">+        None,
</a><a href="#h8-4-14" id="h8-4-14" class="i">+        None,
</a><a href="#h8-4-15" id="h8-4-15" class="i">+        None,
</a><a href="#h8-4-16" id="h8-4-16" class="i">+        None,
</a><a href="#h8-4-17" id="h8-4-17" class="i">+        None,
</a><a href="#h8-4-18" id="h8-4-18" class="i">+    ],
</a><a href="#h8-4-19" id="h8-4-19" class="i">+}
</a> 
<a href="#h8-4-21" id="h8-4-21" class="d">-Optimized plan: Select(
</a><a href="#h8-4-22" id="h8-4-22" class="d">-    Projection {
</a><a href="#h8-4-23" id="h8-4-23" class="i">+Optimized plan: Select {
</a><a href="#h8-4-24" id="h8-4-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Nothing,
<a href="#h8-4-28" id="h8-4-28" class="d">-                labels: [
</a><a href="#h8-4-29" id="h8-4-29" class="d">-                    None,
</a><a href="#h8-4-30" id="h8-4-30" class="d">-                    None,
</a><a href="#h8-4-31" id="h8-4-31" class="d">-                    None,
</a><a href="#h8-4-32" id="h8-4-32" class="d">-                    None,
</a><a href="#h8-4-33" id="h8-4-33" class="d">-                    None,
</a><a href="#h8-4-34" id="h8-4-34" class="d">-                ],
</a>                 expressions: [
                     Constant(
                         Integer(
<a href="#h8-5" id="h8-5" class="h">@@ -205,6 +205,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h8-5-3" id="h8-5-3" class="i">+                labels: [
</a><a href="#h8-5-4" id="h8-5-4" class="i">+                    None,
</a><a href="#h8-5-5" id="h8-5-5" class="i">+                    None,
</a><a href="#h8-5-6" id="h8-5-6" class="i">+                    None,
</a><a href="#h8-5-7" id="h8-5-7" class="i">+                    None,
</a><a href="#h8-5-8" id="h8-5-8" class="i">+                    None,
</a><a href="#h8-5-9" id="h8-5-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h8-6" id="h8-6" class="h">@@ -214,13 +221,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h8-6-3" id="h8-6-3" class="d">-        labels: [
</a><a href="#h8-6-4" id="h8-6-4" class="d">-            None,
</a><a href="#h8-6-5" id="h8-6-5" class="d">-            None,
</a><a href="#h8-6-6" id="h8-6-6" class="d">-            None,
</a><a href="#h8-6-7" id="h8-6-7" class="d">-            None,
</a><a href="#h8-6-8" id="h8-6-8" class="d">-            None,
</a><a href="#h8-6-9" id="h8-6-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h8-7" id="h8-7" class="h">@@ -243,6 +243,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h8-7-3" id="h8-7-3" class="i">+        labels: [
</a><a href="#h8-7-4" id="h8-7-4" class="i">+            None,
</a><a href="#h8-7-5" id="h8-7-5" class="i">+            None,
</a><a href="#h8-7-6" id="h8-7-6" class="i">+            None,
</a><a href="#h8-7-7" id="h8-7-7" class="i">+            None,
</a><a href="#h8-7-8" id="h8-7-8" class="i">+            None,
</a><a href="#h8-7-9" id="h8-7-9" class="i">+        ],
</a>     },
<a href="#h8-7-11" id="h8-7-11" class="d">-)
</a><a href="#h8-7-12" id="h8-7-12" class="i">+    labels: [
</a><a href="#h8-7-13" id="h8-7-13" class="i">+        None,
</a><a href="#h8-7-14" id="h8-7-14" class="i">+        None,
</a><a href="#h8-7-15" id="h8-7-15" class="i">+        None,
</a><a href="#h8-7-16" id="h8-7-16" class="i">+        None,
</a><a href="#h8-7-17" id="h8-7-17" class="i">+        None,
</a><a href="#h8-7-18" id="h8-7-18" class="i">+    ],
</a><a href="#h8-7-19" id="h8-7-19" class="i">+}
</a> 
<b>diff --git a/<a id="h9" href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a> b/<a href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3) FROM genres
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h9-0-3" id="h9-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h9-0-4" id="h9-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: 3, 3, 3, 3, 3
       └─ Scan: genres
 
<a href="#h9-1" id="h9-1" class="h">@@ -91,8 +91,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h9-1-3" id="h9-1-3" class="d">-Plan: Select(
</a><a href="#h9-1-4" id="h9-1-4" class="d">-    Projection {
</a><a href="#h9-1-5" id="h9-1-5" class="i">+Plan: Select {
</a><a href="#h9-1-6" id="h9-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h9-2" id="h9-2" class="h">@@ -120,16 +120,9 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h9-2-3" id="h9-2-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h9-2-5" id="h9-2-5" class="i">+                    alias: None,
</a>                 },
<a href="#h9-2-7" id="h9-2-7" class="d">-                labels: [
</a><a href="#h9-2-8" id="h9-2-8" class="d">-                    None,
</a><a href="#h9-2-9" id="h9-2-9" class="d">-                    None,
</a><a href="#h9-2-10" id="h9-2-10" class="d">-                    None,
</a><a href="#h9-2-11" id="h9-2-11" class="d">-                    None,
</a><a href="#h9-2-12" id="h9-2-12" class="d">-                    None,
</a><a href="#h9-2-13" id="h9-2-13" class="d">-                ],
</a>                 expressions: [
                     Constant(
                         Integer(
<a href="#h9-3" id="h9-3" class="h">@@ -157,6 +150,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h9-3-3" id="h9-3-3" class="i">+                labels: [
</a><a href="#h9-3-4" id="h9-3-4" class="i">+                    None,
</a><a href="#h9-3-5" id="h9-3-5" class="i">+                    None,
</a><a href="#h9-3-6" id="h9-3-6" class="i">+                    None,
</a><a href="#h9-3-7" id="h9-3-7" class="i">+                    None,
</a><a href="#h9-3-8" id="h9-3-8" class="i">+                    None,
</a><a href="#h9-3-9" id="h9-3-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h9-4" id="h9-4" class="h">@@ -166,13 +166,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h9-4-3" id="h9-4-3" class="d">-        labels: [
</a><a href="#h9-4-4" id="h9-4-4" class="d">-            None,
</a><a href="#h9-4-5" id="h9-4-5" class="d">-            None,
</a><a href="#h9-4-6" id="h9-4-6" class="d">-            None,
</a><a href="#h9-4-7" id="h9-4-7" class="d">-            None,
</a><a href="#h9-4-8" id="h9-4-8" class="d">-            None,
</a><a href="#h9-4-9" id="h9-4-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h9-5" id="h9-5" class="h">@@ -195,11 +188,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h9-5-3" id="h9-5-3" class="i">+        labels: [
</a><a href="#h9-5-4" id="h9-5-4" class="i">+            None,
</a><a href="#h9-5-5" id="h9-5-5" class="i">+            None,
</a><a href="#h9-5-6" id="h9-5-6" class="i">+            None,
</a><a href="#h9-5-7" id="h9-5-7" class="i">+            None,
</a><a href="#h9-5-8" id="h9-5-8" class="i">+            None,
</a><a href="#h9-5-9" id="h9-5-9" class="i">+        ],
</a>     },
<a href="#h9-5-11" id="h9-5-11" class="d">-)
</a><a href="#h9-5-12" id="h9-5-12" class="i">+    labels: [
</a><a href="#h9-5-13" id="h9-5-13" class="i">+        None,
</a><a href="#h9-5-14" id="h9-5-14" class="i">+        None,
</a><a href="#h9-5-15" id="h9-5-15" class="i">+        None,
</a><a href="#h9-5-16" id="h9-5-16" class="i">+        None,
</a><a href="#h9-5-17" id="h9-5-17" class="i">+        None,
</a><a href="#h9-5-18" id="h9-5-18" class="i">+    ],
</a><a href="#h9-5-19" id="h9-5-19" class="i">+}
</a> 
<a href="#h9-5-21" id="h9-5-21" class="d">-Optimized plan: Select(
</a><a href="#h9-5-22" id="h9-5-22" class="d">-    Projection {
</a><a href="#h9-5-23" id="h9-5-23" class="i">+Optimized plan: Select {
</a><a href="#h9-5-24" id="h9-5-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h9-6" id="h9-6" class="h">@@ -227,16 +234,9 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h9-6-3" id="h9-6-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h9-6-5" id="h9-6-5" class="i">+                    alias: None,
</a>                 },
<a href="#h9-6-7" id="h9-6-7" class="d">-                labels: [
</a><a href="#h9-6-8" id="h9-6-8" class="d">-                    None,
</a><a href="#h9-6-9" id="h9-6-9" class="d">-                    None,
</a><a href="#h9-6-10" id="h9-6-10" class="d">-                    None,
</a><a href="#h9-6-11" id="h9-6-11" class="d">-                    None,
</a><a href="#h9-6-12" id="h9-6-12" class="d">-                    None,
</a><a href="#h9-6-13" id="h9-6-13" class="d">-                ],
</a>                 expressions: [
                     Constant(
                         Integer(
<a href="#h9-7" id="h9-7" class="h">@@ -264,6 +264,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h9-7-3" id="h9-7-3" class="i">+                labels: [
</a><a href="#h9-7-4" id="h9-7-4" class="i">+                    None,
</a><a href="#h9-7-5" id="h9-7-5" class="i">+                    None,
</a><a href="#h9-7-6" id="h9-7-6" class="i">+                    None,
</a><a href="#h9-7-7" id="h9-7-7" class="i">+                    None,
</a><a href="#h9-7-8" id="h9-7-8" class="i">+                    None,
</a><a href="#h9-7-9" id="h9-7-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h9-8" id="h9-8" class="h">@@ -273,13 +280,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h9-8-3" id="h9-8-3" class="d">-        labels: [
</a><a href="#h9-8-4" id="h9-8-4" class="d">-            None,
</a><a href="#h9-8-5" id="h9-8-5" class="d">-            None,
</a><a href="#h9-8-6" id="h9-8-6" class="d">-            None,
</a><a href="#h9-8-7" id="h9-8-7" class="d">-            None,
</a><a href="#h9-8-8" id="h9-8-8" class="d">-            None,
</a><a href="#h9-8-9" id="h9-8-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h9-9" id="h9-9" class="h">@@ -302,6 +302,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h9-9-3" id="h9-9-3" class="i">+        labels: [
</a><a href="#h9-9-4" id="h9-9-4" class="i">+            None,
</a><a href="#h9-9-5" id="h9-9-5" class="i">+            None,
</a><a href="#h9-9-6" id="h9-9-6" class="i">+            None,
</a><a href="#h9-9-7" id="h9-9-7" class="i">+            None,
</a><a href="#h9-9-8" id="h9-9-8" class="i">+            None,
</a><a href="#h9-9-9" id="h9-9-9" class="i">+        ],
</a>     },
<a href="#h9-9-11" id="h9-9-11" class="d">-)
</a><a href="#h9-9-12" id="h9-9-12" class="i">+    labels: [
</a><a href="#h9-9-13" id="h9-9-13" class="i">+        None,
</a><a href="#h9-9-14" id="h9-9-14" class="i">+        None,
</a><a href="#h9-9-15" id="h9-9-15" class="i">+        None,
</a><a href="#h9-9-16" id="h9-9-16" class="i">+        None,
</a><a href="#h9-9-17" id="h9-9-17" class="i">+        None,
</a><a href="#h9-9-18" id="h9-9-18" class="i">+    ],
</a><a href="#h9-9-19" id="h9-9-19" class="i">+}
</a> 
<b>diff --git a/<a id="h10" href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a> b/<a href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -39,8 +39,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h10-0-3" id="h10-0-3" class="d">-Plan: Select(
</a><a href="#h10-0-4" id="h10-0-4" class="d">-    Projection {
</a><a href="#h10-0-5" id="h10-0-5" class="i">+Plan: Select {
</a><a href="#h10-0-6" id="h10-0-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h10-1" id="h10-1" class="h">@@ -121,12 +121,9 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h10-1-3" id="h10-1-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h10-1-5" id="h10-1-5" class="i">+                    alias: None,
</a>                 },
<a href="#h10-1-7" id="h10-1-7" class="d">-                labels: [
</a><a href="#h10-1-8" id="h10-1-8" class="d">-                    None,
</a><a href="#h10-1-9" id="h10-1-9" class="d">-                ],
</a>                 expressions: [
                     Constant(
                         Boolean(
<a href="#h10-2" id="h10-2" class="h">@@ -134,25 +131,31 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h10-2-3" id="h10-2-3" class="i">+                labels: [
</a><a href="#h10-2-4" id="h10-2-4" class="i">+                    None,
</a><a href="#h10-2-5" id="h10-2-5" class="i">+                ],
</a>             },
             aggregates: [
                 Count,
             ],
         },
<a href="#h10-2-11" id="h10-2-11" class="d">-        labels: [
</a><a href="#h10-2-12" id="h10-2-12" class="d">-            None,
</a><a href="#h10-2-13" id="h10-2-13" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
                 None,
             ),
         ],
<a href="#h10-2-20" id="h10-2-20" class="i">+        labels: [
</a><a href="#h10-2-21" id="h10-2-21" class="i">+            None,
</a><a href="#h10-2-22" id="h10-2-22" class="i">+        ],
</a>     },
<a href="#h10-2-24" id="h10-2-24" class="d">-)
</a><a href="#h10-2-25" id="h10-2-25" class="i">+    labels: [
</a><a href="#h10-2-26" id="h10-2-26" class="i">+        None,
</a><a href="#h10-2-27" id="h10-2-27" class="i">+    ],
</a><a href="#h10-2-28" id="h10-2-28" class="i">+}
</a> 
<a href="#h10-2-30" id="h10-2-30" class="d">-Optimized plan: Select(
</a><a href="#h10-2-31" id="h10-2-31" class="d">-    Projection {
</a><a href="#h10-2-32" id="h10-2-32" class="i">+Optimized plan: Select {
</a><a href="#h10-2-33" id="h10-2-33" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h10-3" id="h10-3" class="h">@@ -233,12 +236,9 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h10-3-3" id="h10-3-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h10-3-5" id="h10-3-5" class="i">+                    alias: None,
</a>                 },
<a href="#h10-3-7" id="h10-3-7" class="d">-                labels: [
</a><a href="#h10-3-8" id="h10-3-8" class="d">-                    None,
</a><a href="#h10-3-9" id="h10-3-9" class="d">-                ],
</a>                 expressions: [
                     Constant(
                         Boolean(
<a href="#h10-4" id="h10-4" class="h">@@ -246,20 +246,26 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h10-4-3" id="h10-4-3" class="i">+                labels: [
</a><a href="#h10-4-4" id="h10-4-4" class="i">+                    None,
</a><a href="#h10-4-5" id="h10-4-5" class="i">+                ],
</a>             },
             aggregates: [
                 Count,
             ],
         },
<a href="#h10-4-11" id="h10-4-11" class="d">-        labels: [
</a><a href="#h10-4-12" id="h10-4-12" class="d">-            None,
</a><a href="#h10-4-13" id="h10-4-13" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
                 None,
             ),
         ],
<a href="#h10-4-20" id="h10-4-20" class="i">+        labels: [
</a><a href="#h10-4-21" id="h10-4-21" class="i">+            None,
</a><a href="#h10-4-22" id="h10-4-22" class="i">+        ],
</a>     },
<a href="#h10-4-24" id="h10-4-24" class="d">-)
</a><a href="#h10-4-25" id="h10-4-25" class="i">+    labels: [
</a><a href="#h10-4-26" id="h10-4-26" class="i">+        None,
</a><a href="#h10-4-27" id="h10-4-27" class="i">+    ],
</a><a href="#h10-4-28" id="h10-4-28" class="i">+}
</a> 
<b>diff --git a/<a id="h11" href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a> b/<a href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -61,8 +61,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h11-0-3" id="h11-0-3" class="d">-Plan: Select(
</a><a href="#h11-0-4" id="h11-0-4" class="d">-    Projection {
</a><a href="#h11-0-5" id="h11-0-5" class="i">+Plan: Select {
</a><a href="#h11-0-6" id="h11-0-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h11-1" id="h11-1" class="h">@@ -143,13 +143,9 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h11-1-3" id="h11-1-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h11-1-5" id="h11-1-5" class="i">+                    alias: None,
</a>                 },
<a href="#h11-1-7" id="h11-1-7" class="d">-                labels: [
</a><a href="#h11-1-8" id="h11-1-8" class="d">-                    None,
</a><a href="#h11-1-9" id="h11-1-9" class="d">-                    None,
</a><a href="#h11-1-10" id="h11-1-10" class="d">-                ],
</a>                 expressions: [
                     Multiply(
                         Field(
<a href="#h11-2" id="h11-2" class="h">@@ -173,15 +169,16 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h11-2-3" id="h11-2-3" class="i">+                labels: [
</a><a href="#h11-2-4" id="h11-2-4" class="i">+                    None,
</a><a href="#h11-2-5" id="h11-2-5" class="i">+                    None,
</a><a href="#h11-2-6" id="h11-2-6" class="i">+                ],
</a>             },
             aggregates: [
                 Sum,
                 Count,
             ],
         },
<a href="#h11-2-13" id="h11-2-13" class="d">-        labels: [
</a><a href="#h11-2-14" id="h11-2-14" class="d">-            None,
</a><a href="#h11-2-15" id="h11-2-15" class="d">-        ],
</a>         expressions: [
             Divide(
                 Field(
<a href="#h11-3" id="h11-3" class="h">@@ -194,11 +191,17 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h11-3-3" id="h11-3-3" class="i">+        labels: [
</a><a href="#h11-3-4" id="h11-3-4" class="i">+            None,
</a><a href="#h11-3-5" id="h11-3-5" class="i">+        ],
</a>     },
<a href="#h11-3-7" id="h11-3-7" class="d">-)
</a><a href="#h11-3-8" id="h11-3-8" class="i">+    labels: [
</a><a href="#h11-3-9" id="h11-3-9" class="i">+        None,
</a><a href="#h11-3-10" id="h11-3-10" class="i">+    ],
</a><a href="#h11-3-11" id="h11-3-11" class="i">+}
</a> 
<a href="#h11-3-13" id="h11-3-13" class="d">-Optimized plan: Select(
</a><a href="#h11-3-14" id="h11-3-14" class="d">-    Projection {
</a><a href="#h11-3-15" id="h11-3-15" class="i">+Optimized plan: Select {
</a><a href="#h11-3-16" id="h11-3-16" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h11-4" id="h11-4" class="h">@@ -279,13 +282,9 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h11-4-3" id="h11-4-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h11-4-5" id="h11-4-5" class="i">+                    alias: None,
</a>                 },
<a href="#h11-4-7" id="h11-4-7" class="d">-                labels: [
</a><a href="#h11-4-8" id="h11-4-8" class="d">-                    None,
</a><a href="#h11-4-9" id="h11-4-9" class="d">-                    None,
</a><a href="#h11-4-10" id="h11-4-10" class="d">-                ],
</a>                 expressions: [
                     Multiply(
                         Field(
<a href="#h11-5" id="h11-5" class="h">@@ -309,15 +308,16 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h11-5-3" id="h11-5-3" class="i">+                labels: [
</a><a href="#h11-5-4" id="h11-5-4" class="i">+                    None,
</a><a href="#h11-5-5" id="h11-5-5" class="i">+                    None,
</a><a href="#h11-5-6" id="h11-5-6" class="i">+                ],
</a>             },
             aggregates: [
                 Sum,
                 Count,
             ],
         },
<a href="#h11-5-13" id="h11-5-13" class="d">-        labels: [
</a><a href="#h11-5-14" id="h11-5-14" class="d">-            None,
</a><a href="#h11-5-15" id="h11-5-15" class="d">-        ],
</a>         expressions: [
             Divide(
                 Field(
<a href="#h11-6" id="h11-6" class="h">@@ -330,6 +330,12 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h11-6-3" id="h11-6-3" class="i">+        labels: [
</a><a href="#h11-6-4" id="h11-6-4" class="i">+            None,
</a><a href="#h11-6-5" id="h11-6-5" class="i">+        ],
</a>     },
<a href="#h11-6-7" id="h11-6-7" class="d">-)
</a><a href="#h11-6-8" id="h11-6-8" class="i">+    labels: [
</a><a href="#h11-6-9" id="h11-6-9" class="i">+        None,
</a><a href="#h11-6-10" id="h11-6-10" class="i">+    ],
</a><a href="#h11-6-11" id="h11-6-11" class="i">+}
</a> 
<b>diff --git a/<a id="h12" href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a> b/<a href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats WHERE f IS NO
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h12-0-3" id="h12-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h12-0-4" id="h12-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: f, f, f, f, f
       └─ Scan: floats (NOT f IS NULL)
 
<a href="#h12-1" id="h12-1" class="h">@@ -99,8 +99,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h12-1-3" id="h12-1-3" class="d">-Plan: Select(
</a><a href="#h12-1-4" id="h12-1-4" class="d">-    Projection {
</a><a href="#h12-1-5" id="h12-1-5" class="i">+Plan: Select {
</a><a href="#h12-1-6" id="h12-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Filter {
<a href="#h12-2" id="h12-2" class="h">@@ -131,8 +131,8 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h12-2-3" id="h12-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h12-2-5" id="h12-2-5" class="i">+                        alias: None,
</a>                     },
                     predicate: Not(
                         IsNull(
<a href="#h12-3" id="h12-3" class="h">@@ -148,13 +148,6 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h12-3-3" id="h12-3-3" class="d">-                labels: [
</a><a href="#h12-3-4" id="h12-3-4" class="d">-                    None,
</a><a href="#h12-3-5" id="h12-3-5" class="d">-                    None,
</a><a href="#h12-3-6" id="h12-3-6" class="d">-                    None,
</a><a href="#h12-3-7" id="h12-3-7" class="d">-                    None,
</a><a href="#h12-3-8" id="h12-3-8" class="d">-                    None,
</a><a href="#h12-3-9" id="h12-3-9" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h12-4" id="h12-4" class="h">@@ -202,6 +195,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h12-4-3" id="h12-4-3" class="i">+                labels: [
</a><a href="#h12-4-4" id="h12-4-4" class="i">+                    None,
</a><a href="#h12-4-5" id="h12-4-5" class="i">+                    None,
</a><a href="#h12-4-6" id="h12-4-6" class="i">+                    None,
</a><a href="#h12-4-7" id="h12-4-7" class="i">+                    None,
</a><a href="#h12-4-8" id="h12-4-8" class="i">+                    None,
</a><a href="#h12-4-9" id="h12-4-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h12-5" id="h12-5" class="h">@@ -211,13 +211,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h12-5-3" id="h12-5-3" class="d">-        labels: [
</a><a href="#h12-5-4" id="h12-5-4" class="d">-            None,
</a><a href="#h12-5-5" id="h12-5-5" class="d">-            None,
</a><a href="#h12-5-6" id="h12-5-6" class="d">-            None,
</a><a href="#h12-5-7" id="h12-5-7" class="d">-            None,
</a><a href="#h12-5-8" id="h12-5-8" class="d">-            None,
</a><a href="#h12-5-9" id="h12-5-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h12-6" id="h12-6" class="h">@@ -240,11 +233,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h12-6-3" id="h12-6-3" class="i">+        labels: [
</a><a href="#h12-6-4" id="h12-6-4" class="i">+            None,
</a><a href="#h12-6-5" id="h12-6-5" class="i">+            None,
</a><a href="#h12-6-6" id="h12-6-6" class="i">+            None,
</a><a href="#h12-6-7" id="h12-6-7" class="i">+            None,
</a><a href="#h12-6-8" id="h12-6-8" class="i">+            None,
</a><a href="#h12-6-9" id="h12-6-9" class="i">+        ],
</a>     },
<a href="#h12-6-11" id="h12-6-11" class="d">-)
</a><a href="#h12-6-12" id="h12-6-12" class="i">+    labels: [
</a><a href="#h12-6-13" id="h12-6-13" class="i">+        None,
</a><a href="#h12-6-14" id="h12-6-14" class="i">+        None,
</a><a href="#h12-6-15" id="h12-6-15" class="i">+        None,
</a><a href="#h12-6-16" id="h12-6-16" class="i">+        None,
</a><a href="#h12-6-17" id="h12-6-17" class="i">+        None,
</a><a href="#h12-6-18" id="h12-6-18" class="i">+    ],
</a><a href="#h12-6-19" id="h12-6-19" class="i">+}
</a> 
<a href="#h12-6-21" id="h12-6-21" class="d">-Optimized plan: Select(
</a><a href="#h12-6-22" id="h12-6-22" class="d">-    Projection {
</a><a href="#h12-6-23" id="h12-6-23" class="i">+Optimized plan: Select {
</a><a href="#h12-6-24" id="h12-6-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h12-7" id="h12-7" class="h">@@ -274,7 +281,6 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h12-7-3" id="h12-7-3" class="d">-                    alias: None,
</a>                     filter: Some(
                         Not(
                             IsNull(
<a href="#h12-8" id="h12-8" class="h">@@ -290,14 +296,8 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h12-8-3" id="h12-8-3" class="i">+                    alias: None,
</a>                 },
<a href="#h12-8-5" id="h12-8-5" class="d">-                labels: [
</a><a href="#h12-8-6" id="h12-8-6" class="d">-                    None,
</a><a href="#h12-8-7" id="h12-8-7" class="d">-                    None,
</a><a href="#h12-8-8" id="h12-8-8" class="d">-                    None,
</a><a href="#h12-8-9" id="h12-8-9" class="d">-                    None,
</a><a href="#h12-8-10" id="h12-8-10" class="d">-                    None,
</a><a href="#h12-8-11" id="h12-8-11" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h12-9" id="h12-9" class="h">@@ -345,6 +345,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h12-9-3" id="h12-9-3" class="i">+                labels: [
</a><a href="#h12-9-4" id="h12-9-4" class="i">+                    None,
</a><a href="#h12-9-5" id="h12-9-5" class="i">+                    None,
</a><a href="#h12-9-6" id="h12-9-6" class="i">+                    None,
</a><a href="#h12-9-7" id="h12-9-7" class="i">+                    None,
</a><a href="#h12-9-8" id="h12-9-8" class="i">+                    None,
</a><a href="#h12-9-9" id="h12-9-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h12-10" id="h12-10" class="h">@@ -354,13 +361,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h12-10-3" id="h12-10-3" class="d">-        labels: [
</a><a href="#h12-10-4" id="h12-10-4" class="d">-            None,
</a><a href="#h12-10-5" id="h12-10-5" class="d">-            None,
</a><a href="#h12-10-6" id="h12-10-6" class="d">-            None,
</a><a href="#h12-10-7" id="h12-10-7" class="d">-            None,
</a><a href="#h12-10-8" id="h12-10-8" class="d">-            None,
</a><a href="#h12-10-9" id="h12-10-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h12-11" id="h12-11" class="h">@@ -383,6 +383,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h12-11-3" id="h12-11-3" class="i">+        labels: [
</a><a href="#h12-11-4" id="h12-11-4" class="i">+            None,
</a><a href="#h12-11-5" id="h12-11-5" class="i">+            None,
</a><a href="#h12-11-6" id="h12-11-6" class="i">+            None,
</a><a href="#h12-11-7" id="h12-11-7" class="i">+            None,
</a><a href="#h12-11-8" id="h12-11-8" class="i">+            None,
</a><a href="#h12-11-9" id="h12-11-9" class="i">+        ],
</a>     },
<a href="#h12-11-11" id="h12-11-11" class="d">-)
</a><a href="#h12-11-12" id="h12-11-12" class="i">+    labels: [
</a><a href="#h12-11-13" id="h12-11-13" class="i">+        None,
</a><a href="#h12-11-14" id="h12-11-14" class="i">+        None,
</a><a href="#h12-11-15" id="h12-11-15" class="i">+        None,
</a><a href="#h12-11-16" id="h12-11-16" class="i">+        None,
</a><a href="#h12-11-17" id="h12-11-17" class="i">+        None,
</a><a href="#h12-11-18" id="h12-11-18" class="i">+    ],
</a><a href="#h12-11-19" id="h12-11-19" class="i">+}
</a> 
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a> b/<a href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h13-0-3" id="h13-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h13-0-4" id="h13-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: f, f, f, f, f
       └─ Scan: floats
 
<a href="#h13-1" id="h13-1" class="h">@@ -86,8 +86,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h13-1-3" id="h13-1-3" class="d">-Plan: Select(
</a><a href="#h13-1-4" id="h13-1-4" class="d">-    Projection {
</a><a href="#h13-1-5" id="h13-1-5" class="i">+Plan: Select {
</a><a href="#h13-1-6" id="h13-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h13-2" id="h13-2" class="h">@@ -117,16 +117,9 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h13-2-3" id="h13-2-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h13-2-5" id="h13-2-5" class="i">+                    alias: None,
</a>                 },
<a href="#h13-2-7" id="h13-2-7" class="d">-                labels: [
</a><a href="#h13-2-8" id="h13-2-8" class="d">-                    None,
</a><a href="#h13-2-9" id="h13-2-9" class="d">-                    None,
</a><a href="#h13-2-10" id="h13-2-10" class="d">-                    None,
</a><a href="#h13-2-11" id="h13-2-11" class="d">-                    None,
</a><a href="#h13-2-12" id="h13-2-12" class="d">-                    None,
</a><a href="#h13-2-13" id="h13-2-13" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h13-3" id="h13-3" class="h">@@ -174,6 +167,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h13-3-3" id="h13-3-3" class="i">+                labels: [
</a><a href="#h13-3-4" id="h13-3-4" class="i">+                    None,
</a><a href="#h13-3-5" id="h13-3-5" class="i">+                    None,
</a><a href="#h13-3-6" id="h13-3-6" class="i">+                    None,
</a><a href="#h13-3-7" id="h13-3-7" class="i">+                    None,
</a><a href="#h13-3-8" id="h13-3-8" class="i">+                    None,
</a><a href="#h13-3-9" id="h13-3-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h13-4" id="h13-4" class="h">@@ -183,13 +183,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h13-4-3" id="h13-4-3" class="d">-        labels: [
</a><a href="#h13-4-4" id="h13-4-4" class="d">-            None,
</a><a href="#h13-4-5" id="h13-4-5" class="d">-            None,
</a><a href="#h13-4-6" id="h13-4-6" class="d">-            None,
</a><a href="#h13-4-7" id="h13-4-7" class="d">-            None,
</a><a href="#h13-4-8" id="h13-4-8" class="d">-            None,
</a><a href="#h13-4-9" id="h13-4-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h13-5" id="h13-5" class="h">@@ -212,11 +205,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h13-5-3" id="h13-5-3" class="i">+        labels: [
</a><a href="#h13-5-4" id="h13-5-4" class="i">+            None,
</a><a href="#h13-5-5" id="h13-5-5" class="i">+            None,
</a><a href="#h13-5-6" id="h13-5-6" class="i">+            None,
</a><a href="#h13-5-7" id="h13-5-7" class="i">+            None,
</a><a href="#h13-5-8" id="h13-5-8" class="i">+            None,
</a><a href="#h13-5-9" id="h13-5-9" class="i">+        ],
</a>     },
<a href="#h13-5-11" id="h13-5-11" class="d">-)
</a><a href="#h13-5-12" id="h13-5-12" class="i">+    labels: [
</a><a href="#h13-5-13" id="h13-5-13" class="i">+        None,
</a><a href="#h13-5-14" id="h13-5-14" class="i">+        None,
</a><a href="#h13-5-15" id="h13-5-15" class="i">+        None,
</a><a href="#h13-5-16" id="h13-5-16" class="i">+        None,
</a><a href="#h13-5-17" id="h13-5-17" class="i">+        None,
</a><a href="#h13-5-18" id="h13-5-18" class="i">+    ],
</a><a href="#h13-5-19" id="h13-5-19" class="i">+}
</a> 
<a href="#h13-5-21" id="h13-5-21" class="d">-Optimized plan: Select(
</a><a href="#h13-5-22" id="h13-5-22" class="d">-    Projection {
</a><a href="#h13-5-23" id="h13-5-23" class="i">+Optimized plan: Select {
</a><a href="#h13-5-24" id="h13-5-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h13-6" id="h13-6" class="h">@@ -246,16 +253,9 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h13-6-3" id="h13-6-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h13-6-5" id="h13-6-5" class="i">+                    alias: None,
</a>                 },
<a href="#h13-6-7" id="h13-6-7" class="d">-                labels: [
</a><a href="#h13-6-8" id="h13-6-8" class="d">-                    None,
</a><a href="#h13-6-9" id="h13-6-9" class="d">-                    None,
</a><a href="#h13-6-10" id="h13-6-10" class="d">-                    None,
</a><a href="#h13-6-11" id="h13-6-11" class="d">-                    None,
</a><a href="#h13-6-12" id="h13-6-12" class="d">-                    None,
</a><a href="#h13-6-13" id="h13-6-13" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h13-7" id="h13-7" class="h">@@ -303,6 +303,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h13-7-3" id="h13-7-3" class="i">+                labels: [
</a><a href="#h13-7-4" id="h13-7-4" class="i">+                    None,
</a><a href="#h13-7-5" id="h13-7-5" class="i">+                    None,
</a><a href="#h13-7-6" id="h13-7-6" class="i">+                    None,
</a><a href="#h13-7-7" id="h13-7-7" class="i">+                    None,
</a><a href="#h13-7-8" id="h13-7-8" class="i">+                    None,
</a><a href="#h13-7-9" id="h13-7-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h13-8" id="h13-8" class="h">@@ -312,13 +319,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h13-8-3" id="h13-8-3" class="d">-        labels: [
</a><a href="#h13-8-4" id="h13-8-4" class="d">-            None,
</a><a href="#h13-8-5" id="h13-8-5" class="d">-            None,
</a><a href="#h13-8-6" id="h13-8-6" class="d">-            None,
</a><a href="#h13-8-7" id="h13-8-7" class="d">-            None,
</a><a href="#h13-8-8" id="h13-8-8" class="d">-            None,
</a><a href="#h13-8-9" id="h13-8-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h13-9" id="h13-9" class="h">@@ -341,6 +341,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h13-9-3" id="h13-9-3" class="i">+        labels: [
</a><a href="#h13-9-4" id="h13-9-4" class="i">+            None,
</a><a href="#h13-9-5" id="h13-9-5" class="i">+            None,
</a><a href="#h13-9-6" id="h13-9-6" class="i">+            None,
</a><a href="#h13-9-7" id="h13-9-7" class="i">+            None,
</a><a href="#h13-9-8" id="h13-9-8" class="i">+            None,
</a><a href="#h13-9-9" id="h13-9-9" class="i">+        ],
</a>     },
<a href="#h13-9-11" id="h13-9-11" class="d">-)
</a><a href="#h13-9-12" id="h13-9-12" class="i">+    labels: [
</a><a href="#h13-9-13" id="h13-9-13" class="i">+        None,
</a><a href="#h13-9-14" id="h13-9-14" class="i">+        None,
</a><a href="#h13-9-15" id="h13-9-15" class="i">+        None,
</a><a href="#h13-9-16" id="h13-9-16" class="i">+        None,
</a><a href="#h13-9-17" id="h13-9-17" class="i">+        None,
</a><a href="#h13-9-18" id="h13-9-18" class="i">+    ],
</a><a href="#h13-9-19" id="h13-9-19" class="i">+}
</a> 
<b>diff --git a/<a id="h14" href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a> b/<a href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers WHERE i IS 
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h14-0-3" id="h14-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h14-0-4" id="h14-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: i, i, i, i, i
       └─ Scan: integers (NOT i IS NULL)
 
<a href="#h14-1" id="h14-1" class="h">@@ -99,8 +99,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h14-1-3" id="h14-1-3" class="d">-Plan: Select(
</a><a href="#h14-1-4" id="h14-1-4" class="d">-    Projection {
</a><a href="#h14-1-5" id="h14-1-5" class="i">+Plan: Select {
</a><a href="#h14-1-6" id="h14-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Filter {
<a href="#h14-2" id="h14-2" class="h">@@ -131,8 +131,8 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h14-2-3" id="h14-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h14-2-5" id="h14-2-5" class="i">+                        alias: None,
</a>                     },
                     predicate: Not(
                         IsNull(
<a href="#h14-3" id="h14-3" class="h">@@ -148,13 +148,6 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h14-3-3" id="h14-3-3" class="d">-                labels: [
</a><a href="#h14-3-4" id="h14-3-4" class="d">-                    None,
</a><a href="#h14-3-5" id="h14-3-5" class="d">-                    None,
</a><a href="#h14-3-6" id="h14-3-6" class="d">-                    None,
</a><a href="#h14-3-7" id="h14-3-7" class="d">-                    None,
</a><a href="#h14-3-8" id="h14-3-8" class="d">-                    None,
</a><a href="#h14-3-9" id="h14-3-9" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h14-4" id="h14-4" class="h">@@ -202,6 +195,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h14-4-3" id="h14-4-3" class="i">+                labels: [
</a><a href="#h14-4-4" id="h14-4-4" class="i">+                    None,
</a><a href="#h14-4-5" id="h14-4-5" class="i">+                    None,
</a><a href="#h14-4-6" id="h14-4-6" class="i">+                    None,
</a><a href="#h14-4-7" id="h14-4-7" class="i">+                    None,
</a><a href="#h14-4-8" id="h14-4-8" class="i">+                    None,
</a><a href="#h14-4-9" id="h14-4-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h14-5" id="h14-5" class="h">@@ -211,13 +211,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h14-5-3" id="h14-5-3" class="d">-        labels: [
</a><a href="#h14-5-4" id="h14-5-4" class="d">-            None,
</a><a href="#h14-5-5" id="h14-5-5" class="d">-            None,
</a><a href="#h14-5-6" id="h14-5-6" class="d">-            None,
</a><a href="#h14-5-7" id="h14-5-7" class="d">-            None,
</a><a href="#h14-5-8" id="h14-5-8" class="d">-            None,
</a><a href="#h14-5-9" id="h14-5-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h14-6" id="h14-6" class="h">@@ -240,11 +233,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h14-6-3" id="h14-6-3" class="i">+        labels: [
</a><a href="#h14-6-4" id="h14-6-4" class="i">+            None,
</a><a href="#h14-6-5" id="h14-6-5" class="i">+            None,
</a><a href="#h14-6-6" id="h14-6-6" class="i">+            None,
</a><a href="#h14-6-7" id="h14-6-7" class="i">+            None,
</a><a href="#h14-6-8" id="h14-6-8" class="i">+            None,
</a><a href="#h14-6-9" id="h14-6-9" class="i">+        ],
</a>     },
<a href="#h14-6-11" id="h14-6-11" class="d">-)
</a><a href="#h14-6-12" id="h14-6-12" class="i">+    labels: [
</a><a href="#h14-6-13" id="h14-6-13" class="i">+        None,
</a><a href="#h14-6-14" id="h14-6-14" class="i">+        None,
</a><a href="#h14-6-15" id="h14-6-15" class="i">+        None,
</a><a href="#h14-6-16" id="h14-6-16" class="i">+        None,
</a><a href="#h14-6-17" id="h14-6-17" class="i">+        None,
</a><a href="#h14-6-18" id="h14-6-18" class="i">+    ],
</a><a href="#h14-6-19" id="h14-6-19" class="i">+}
</a> 
<a href="#h14-6-21" id="h14-6-21" class="d">-Optimized plan: Select(
</a><a href="#h14-6-22" id="h14-6-22" class="d">-    Projection {
</a><a href="#h14-6-23" id="h14-6-23" class="i">+Optimized plan: Select {
</a><a href="#h14-6-24" id="h14-6-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h14-7" id="h14-7" class="h">@@ -274,7 +281,6 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h14-7-3" id="h14-7-3" class="d">-                    alias: None,
</a>                     filter: Some(
                         Not(
                             IsNull(
<a href="#h14-8" id="h14-8" class="h">@@ -290,14 +296,8 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h14-8-3" id="h14-8-3" class="i">+                    alias: None,
</a>                 },
<a href="#h14-8-5" id="h14-8-5" class="d">-                labels: [
</a><a href="#h14-8-6" id="h14-8-6" class="d">-                    None,
</a><a href="#h14-8-7" id="h14-8-7" class="d">-                    None,
</a><a href="#h14-8-8" id="h14-8-8" class="d">-                    None,
</a><a href="#h14-8-9" id="h14-8-9" class="d">-                    None,
</a><a href="#h14-8-10" id="h14-8-10" class="d">-                    None,
</a><a href="#h14-8-11" id="h14-8-11" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h14-9" id="h14-9" class="h">@@ -345,6 +345,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h14-9-3" id="h14-9-3" class="i">+                labels: [
</a><a href="#h14-9-4" id="h14-9-4" class="i">+                    None,
</a><a href="#h14-9-5" id="h14-9-5" class="i">+                    None,
</a><a href="#h14-9-6" id="h14-9-6" class="i">+                    None,
</a><a href="#h14-9-7" id="h14-9-7" class="i">+                    None,
</a><a href="#h14-9-8" id="h14-9-8" class="i">+                    None,
</a><a href="#h14-9-9" id="h14-9-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h14-10" id="h14-10" class="h">@@ -354,13 +361,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h14-10-3" id="h14-10-3" class="d">-        labels: [
</a><a href="#h14-10-4" id="h14-10-4" class="d">-            None,
</a><a href="#h14-10-5" id="h14-10-5" class="d">-            None,
</a><a href="#h14-10-6" id="h14-10-6" class="d">-            None,
</a><a href="#h14-10-7" id="h14-10-7" class="d">-            None,
</a><a href="#h14-10-8" id="h14-10-8" class="d">-            None,
</a><a href="#h14-10-9" id="h14-10-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h14-11" id="h14-11" class="h">@@ -383,6 +383,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h14-11-3" id="h14-11-3" class="i">+        labels: [
</a><a href="#h14-11-4" id="h14-11-4" class="i">+            None,
</a><a href="#h14-11-5" id="h14-11-5" class="i">+            None,
</a><a href="#h14-11-6" id="h14-11-6" class="i">+            None,
</a><a href="#h14-11-7" id="h14-11-7" class="i">+            None,
</a><a href="#h14-11-8" id="h14-11-8" class="i">+            None,
</a><a href="#h14-11-9" id="h14-11-9" class="i">+        ],
</a>     },
<a href="#h14-11-11" id="h14-11-11" class="d">-)
</a><a href="#h14-11-12" id="h14-11-12" class="i">+    labels: [
</a><a href="#h14-11-13" id="h14-11-13" class="i">+        None,
</a><a href="#h14-11-14" id="h14-11-14" class="i">+        None,
</a><a href="#h14-11-15" id="h14-11-15" class="i">+        None,
</a><a href="#h14-11-16" id="h14-11-16" class="i">+        None,
</a><a href="#h14-11-17" id="h14-11-17" class="i">+        None,
</a><a href="#h14-11-18" id="h14-11-18" class="i">+    ],
</a><a href="#h14-11-19" id="h14-11-19" class="i">+}
</a> 
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a> b/<a href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h15-0-3" id="h15-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h15-0-4" id="h15-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: i, i, i, i, i
       └─ Scan: integers
 
<a href="#h15-1" id="h15-1" class="h">@@ -86,8 +86,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h15-1-3" id="h15-1-3" class="d">-Plan: Select(
</a><a href="#h15-1-4" id="h15-1-4" class="d">-    Projection {
</a><a href="#h15-1-5" id="h15-1-5" class="i">+Plan: Select {
</a><a href="#h15-1-6" id="h15-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h15-2" id="h15-2" class="h">@@ -117,16 +117,9 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h15-2-3" id="h15-2-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h15-2-5" id="h15-2-5" class="i">+                    alias: None,
</a>                 },
<a href="#h15-2-7" id="h15-2-7" class="d">-                labels: [
</a><a href="#h15-2-8" id="h15-2-8" class="d">-                    None,
</a><a href="#h15-2-9" id="h15-2-9" class="d">-                    None,
</a><a href="#h15-2-10" id="h15-2-10" class="d">-                    None,
</a><a href="#h15-2-11" id="h15-2-11" class="d">-                    None,
</a><a href="#h15-2-12" id="h15-2-12" class="d">-                    None,
</a><a href="#h15-2-13" id="h15-2-13" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h15-3" id="h15-3" class="h">@@ -174,6 +167,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h15-3-3" id="h15-3-3" class="i">+                labels: [
</a><a href="#h15-3-4" id="h15-3-4" class="i">+                    None,
</a><a href="#h15-3-5" id="h15-3-5" class="i">+                    None,
</a><a href="#h15-3-6" id="h15-3-6" class="i">+                    None,
</a><a href="#h15-3-7" id="h15-3-7" class="i">+                    None,
</a><a href="#h15-3-8" id="h15-3-8" class="i">+                    None,
</a><a href="#h15-3-9" id="h15-3-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h15-4" id="h15-4" class="h">@@ -183,13 +183,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h15-4-3" id="h15-4-3" class="d">-        labels: [
</a><a href="#h15-4-4" id="h15-4-4" class="d">-            None,
</a><a href="#h15-4-5" id="h15-4-5" class="d">-            None,
</a><a href="#h15-4-6" id="h15-4-6" class="d">-            None,
</a><a href="#h15-4-7" id="h15-4-7" class="d">-            None,
</a><a href="#h15-4-8" id="h15-4-8" class="d">-            None,
</a><a href="#h15-4-9" id="h15-4-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h15-5" id="h15-5" class="h">@@ -212,11 +205,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h15-5-3" id="h15-5-3" class="i">+        labels: [
</a><a href="#h15-5-4" id="h15-5-4" class="i">+            None,
</a><a href="#h15-5-5" id="h15-5-5" class="i">+            None,
</a><a href="#h15-5-6" id="h15-5-6" class="i">+            None,
</a><a href="#h15-5-7" id="h15-5-7" class="i">+            None,
</a><a href="#h15-5-8" id="h15-5-8" class="i">+            None,
</a><a href="#h15-5-9" id="h15-5-9" class="i">+        ],
</a>     },
<a href="#h15-5-11" id="h15-5-11" class="d">-)
</a><a href="#h15-5-12" id="h15-5-12" class="i">+    labels: [
</a><a href="#h15-5-13" id="h15-5-13" class="i">+        None,
</a><a href="#h15-5-14" id="h15-5-14" class="i">+        None,
</a><a href="#h15-5-15" id="h15-5-15" class="i">+        None,
</a><a href="#h15-5-16" id="h15-5-16" class="i">+        None,
</a><a href="#h15-5-17" id="h15-5-17" class="i">+        None,
</a><a href="#h15-5-18" id="h15-5-18" class="i">+    ],
</a><a href="#h15-5-19" id="h15-5-19" class="i">+}
</a> 
<a href="#h15-5-21" id="h15-5-21" class="d">-Optimized plan: Select(
</a><a href="#h15-5-22" id="h15-5-22" class="d">-    Projection {
</a><a href="#h15-5-23" id="h15-5-23" class="i">+Optimized plan: Select {
</a><a href="#h15-5-24" id="h15-5-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h15-6" id="h15-6" class="h">@@ -246,16 +253,9 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h15-6-3" id="h15-6-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h15-6-5" id="h15-6-5" class="i">+                    alias: None,
</a>                 },
<a href="#h15-6-7" id="h15-6-7" class="d">-                labels: [
</a><a href="#h15-6-8" id="h15-6-8" class="d">-                    None,
</a><a href="#h15-6-9" id="h15-6-9" class="d">-                    None,
</a><a href="#h15-6-10" id="h15-6-10" class="d">-                    None,
</a><a href="#h15-6-11" id="h15-6-11" class="d">-                    None,
</a><a href="#h15-6-12" id="h15-6-12" class="d">-                    None,
</a><a href="#h15-6-13" id="h15-6-13" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h15-7" id="h15-7" class="h">@@ -303,6 +303,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h15-7-3" id="h15-7-3" class="i">+                labels: [
</a><a href="#h15-7-4" id="h15-7-4" class="i">+                    None,
</a><a href="#h15-7-5" id="h15-7-5" class="i">+                    None,
</a><a href="#h15-7-6" id="h15-7-6" class="i">+                    None,
</a><a href="#h15-7-7" id="h15-7-7" class="i">+                    None,
</a><a href="#h15-7-8" id="h15-7-8" class="i">+                    None,
</a><a href="#h15-7-9" id="h15-7-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h15-8" id="h15-8" class="h">@@ -312,13 +319,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h15-8-3" id="h15-8-3" class="d">-        labels: [
</a><a href="#h15-8-4" id="h15-8-4" class="d">-            None,
</a><a href="#h15-8-5" id="h15-8-5" class="d">-            None,
</a><a href="#h15-8-6" id="h15-8-6" class="d">-            None,
</a><a href="#h15-8-7" id="h15-8-7" class="d">-            None,
</a><a href="#h15-8-8" id="h15-8-8" class="d">-            None,
</a><a href="#h15-8-9" id="h15-8-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h15-9" id="h15-9" class="h">@@ -341,6 +341,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h15-9-3" id="h15-9-3" class="i">+        labels: [
</a><a href="#h15-9-4" id="h15-9-4" class="i">+            None,
</a><a href="#h15-9-5" id="h15-9-5" class="i">+            None,
</a><a href="#h15-9-6" id="h15-9-6" class="i">+            None,
</a><a href="#h15-9-7" id="h15-9-7" class="i">+            None,
</a><a href="#h15-9-8" id="h15-9-8" class="i">+            None,
</a><a href="#h15-9-9" id="h15-9-9" class="i">+        ],
</a>     },
<a href="#h15-9-11" id="h15-9-11" class="d">-)
</a><a href="#h15-9-12" id="h15-9-12" class="i">+    labels: [
</a><a href="#h15-9-13" id="h15-9-13" class="i">+        None,
</a><a href="#h15-9-14" id="h15-9-14" class="i">+        None,
</a><a href="#h15-9-15" id="h15-9-15" class="i">+        None,
</a><a href="#h15-9-16" id="h15-9-16" class="i">+        None,
</a><a href="#h15-9-17" id="h15-9-17" class="i">+        None,
</a><a href="#h15-9-18" id="h15-9-18" class="i">+    ],
</a><a href="#h15-9-19" id="h15-9-19" class="i">+}
</a> 
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(id), MAX(id), SUM(id), COUNT(id), AVG(id) FROM movies WHERE FA
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h16-0-3" id="h16-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h16-0-4" id="h16-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: id, id, id, id, id
       └─ Scan: movies (FALSE)
 
<a href="#h16-1" id="h16-1" class="h">@@ -92,8 +92,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h16-1-3" id="h16-1-3" class="d">-Plan: Select(
</a><a href="#h16-1-4" id="h16-1-4" class="d">-    Projection {
</a><a href="#h16-1-5" id="h16-1-5" class="i">+Plan: Select {
</a><a href="#h16-1-6" id="h16-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Filter {
<a href="#h16-2" id="h16-2" class="h">@@ -175,8 +175,8 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h16-2-3" id="h16-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h16-2-5" id="h16-2-5" class="i">+                        alias: None,
</a>                     },
                     predicate: Constant(
                         Boolean(
<a href="#h16-3" id="h16-3" class="h">@@ -184,13 +184,6 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h16-3-3" id="h16-3-3" class="d">-                labels: [
</a><a href="#h16-3-4" id="h16-3-4" class="d">-                    None,
</a><a href="#h16-3-5" id="h16-3-5" class="d">-                    None,
</a><a href="#h16-3-6" id="h16-3-6" class="d">-                    None,
</a><a href="#h16-3-7" id="h16-3-7" class="d">-                    None,
</a><a href="#h16-3-8" id="h16-3-8" class="d">-                    None,
</a><a href="#h16-3-9" id="h16-3-9" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h16-4" id="h16-4" class="h">@@ -238,6 +231,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h16-4-3" id="h16-4-3" class="i">+                labels: [
</a><a href="#h16-4-4" id="h16-4-4" class="i">+                    None,
</a><a href="#h16-4-5" id="h16-4-5" class="i">+                    None,
</a><a href="#h16-4-6" id="h16-4-6" class="i">+                    None,
</a><a href="#h16-4-7" id="h16-4-7" class="i">+                    None,
</a><a href="#h16-4-8" id="h16-4-8" class="i">+                    None,
</a><a href="#h16-4-9" id="h16-4-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h16-5" id="h16-5" class="h">@@ -247,13 +247,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h16-5-3" id="h16-5-3" class="d">-        labels: [
</a><a href="#h16-5-4" id="h16-5-4" class="d">-            None,
</a><a href="#h16-5-5" id="h16-5-5" class="d">-            None,
</a><a href="#h16-5-6" id="h16-5-6" class="d">-            None,
</a><a href="#h16-5-7" id="h16-5-7" class="d">-            None,
</a><a href="#h16-5-8" id="h16-5-8" class="d">-            None,
</a><a href="#h16-5-9" id="h16-5-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h16-6" id="h16-6" class="h">@@ -276,11 +269,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h16-6-3" id="h16-6-3" class="i">+        labels: [
</a><a href="#h16-6-4" id="h16-6-4" class="i">+            None,
</a><a href="#h16-6-5" id="h16-6-5" class="i">+            None,
</a><a href="#h16-6-6" id="h16-6-6" class="i">+            None,
</a><a href="#h16-6-7" id="h16-6-7" class="i">+            None,
</a><a href="#h16-6-8" id="h16-6-8" class="i">+            None,
</a><a href="#h16-6-9" id="h16-6-9" class="i">+        ],
</a>     },
<a href="#h16-6-11" id="h16-6-11" class="d">-)
</a><a href="#h16-6-12" id="h16-6-12" class="i">+    labels: [
</a><a href="#h16-6-13" id="h16-6-13" class="i">+        None,
</a><a href="#h16-6-14" id="h16-6-14" class="i">+        None,
</a><a href="#h16-6-15" id="h16-6-15" class="i">+        None,
</a><a href="#h16-6-16" id="h16-6-16" class="i">+        None,
</a><a href="#h16-6-17" id="h16-6-17" class="i">+        None,
</a><a href="#h16-6-18" id="h16-6-18" class="i">+    ],
</a><a href="#h16-6-19" id="h16-6-19" class="i">+}
</a> 
<a href="#h16-6-21" id="h16-6-21" class="d">-Optimized plan: Select(
</a><a href="#h16-6-22" id="h16-6-22" class="d">-    Projection {
</a><a href="#h16-6-23" id="h16-6-23" class="i">+Optimized plan: Select {
</a><a href="#h16-6-24" id="h16-6-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h16-7" id="h16-7" class="h">@@ -361,7 +368,6 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h16-7-3" id="h16-7-3" class="d">-                    alias: None,
</a>                     filter: Some(
                         Constant(
                             Boolean(
<a href="#h16-8" id="h16-8" class="h">@@ -369,14 +375,8 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h16-8-3" id="h16-8-3" class="i">+                    alias: None,
</a>                 },
<a href="#h16-8-5" id="h16-8-5" class="d">-                labels: [
</a><a href="#h16-8-6" id="h16-8-6" class="d">-                    None,
</a><a href="#h16-8-7" id="h16-8-7" class="d">-                    None,
</a><a href="#h16-8-8" id="h16-8-8" class="d">-                    None,
</a><a href="#h16-8-9" id="h16-8-9" class="d">-                    None,
</a><a href="#h16-8-10" id="h16-8-10" class="d">-                    None,
</a><a href="#h16-8-11" id="h16-8-11" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h16-9" id="h16-9" class="h">@@ -424,6 +424,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h16-9-3" id="h16-9-3" class="i">+                labels: [
</a><a href="#h16-9-4" id="h16-9-4" class="i">+                    None,
</a><a href="#h16-9-5" id="h16-9-5" class="i">+                    None,
</a><a href="#h16-9-6" id="h16-9-6" class="i">+                    None,
</a><a href="#h16-9-7" id="h16-9-7" class="i">+                    None,
</a><a href="#h16-9-8" id="h16-9-8" class="i">+                    None,
</a><a href="#h16-9-9" id="h16-9-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h16-10" id="h16-10" class="h">@@ -433,13 +440,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h16-10-3" id="h16-10-3" class="d">-        labels: [
</a><a href="#h16-10-4" id="h16-10-4" class="d">-            None,
</a><a href="#h16-10-5" id="h16-10-5" class="d">-            None,
</a><a href="#h16-10-6" id="h16-10-6" class="d">-            None,
</a><a href="#h16-10-7" id="h16-10-7" class="d">-            None,
</a><a href="#h16-10-8" id="h16-10-8" class="d">-            None,
</a><a href="#h16-10-9" id="h16-10-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h16-11" id="h16-11" class="h">@@ -462,6 +462,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h16-11-3" id="h16-11-3" class="i">+        labels: [
</a><a href="#h16-11-4" id="h16-11-4" class="i">+            None,
</a><a href="#h16-11-5" id="h16-11-5" class="i">+            None,
</a><a href="#h16-11-6" id="h16-11-6" class="i">+            None,
</a><a href="#h16-11-7" id="h16-11-7" class="i">+            None,
</a><a href="#h16-11-8" id="h16-11-8" class="i">+            None,
</a><a href="#h16-11-9" id="h16-11-9" class="i">+        ],
</a>     },
<a href="#h16-11-11" id="h16-11-11" class="d">-)
</a><a href="#h16-11-12" id="h16-11-12" class="i">+    labels: [
</a><a href="#h16-11-13" id="h16-11-13" class="i">+        None,
</a><a href="#h16-11-14" id="h16-11-14" class="i">+        None,
</a><a href="#h16-11-15" id="h16-11-15" class="i">+        None,
</a><a href="#h16-11-16" id="h16-11-16" class="i">+        None,
</a><a href="#h16-11-17" id="h16-11-17" class="i">+        None,
</a><a href="#h16-11-18" id="h16-11-18" class="i">+    ],
</a><a href="#h16-11-19" id="h16-11-19" class="i">+}
</a> 
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(id), MAX(id), SUM(id), COUNT(id), AVG(id) FROM movies WHERE FA
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h17-0-3" id="h17-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h17-0-4" id="h17-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: id, id, id, id, id, id
       └─ Scan: movies (FALSE)
 
<a href="#h17-1" id="h17-1" class="h">@@ -96,8 +96,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h17-1-3" id="h17-1-3" class="d">-Plan: Select(
</a><a href="#h17-1-4" id="h17-1-4" class="d">-    Projection {
</a><a href="#h17-1-5" id="h17-1-5" class="i">+Plan: Select {
</a><a href="#h17-1-6" id="h17-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Filter {
<a href="#h17-2" id="h17-2" class="h">@@ -179,8 +179,8 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h17-2-3" id="h17-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h17-2-5" id="h17-2-5" class="i">+                        alias: None,
</a>                     },
                     predicate: Constant(
                         Boolean(
<a href="#h17-3" id="h17-3" class="h">@@ -188,14 +188,6 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h17-3-3" id="h17-3-3" class="d">-                labels: [
</a><a href="#h17-3-4" id="h17-3-4" class="d">-                    None,
</a><a href="#h17-3-5" id="h17-3-5" class="d">-                    None,
</a><a href="#h17-3-6" id="h17-3-6" class="d">-                    None,
</a><a href="#h17-3-7" id="h17-3-7" class="d">-                    None,
</a><a href="#h17-3-8" id="h17-3-8" class="d">-                    None,
</a><a href="#h17-3-9" id="h17-3-9" class="d">-                    None,
</a><a href="#h17-3-10" id="h17-3-10" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h17-4" id="h17-4" class="h">@@ -252,6 +244,14 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h17-4-3" id="h17-4-3" class="i">+                labels: [
</a><a href="#h17-4-4" id="h17-4-4" class="i">+                    None,
</a><a href="#h17-4-5" id="h17-4-5" class="i">+                    None,
</a><a href="#h17-4-6" id="h17-4-6" class="i">+                    None,
</a><a href="#h17-4-7" id="h17-4-7" class="i">+                    None,
</a><a href="#h17-4-8" id="h17-4-8" class="i">+                    None,
</a><a href="#h17-4-9" id="h17-4-9" class="i">+                    None,
</a><a href="#h17-4-10" id="h17-4-10" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h17-5" id="h17-5" class="h">@@ -261,13 +261,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h17-5-3" id="h17-5-3" class="d">-        labels: [
</a><a href="#h17-5-4" id="h17-5-4" class="d">-            None,
</a><a href="#h17-5-5" id="h17-5-5" class="d">-            None,
</a><a href="#h17-5-6" id="h17-5-6" class="d">-            None,
</a><a href="#h17-5-7" id="h17-5-7" class="d">-            None,
</a><a href="#h17-5-8" id="h17-5-8" class="d">-            None,
</a><a href="#h17-5-9" id="h17-5-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h17-6" id="h17-6" class="h">@@ -290,11 +283,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h17-6-3" id="h17-6-3" class="i">+        labels: [
</a><a href="#h17-6-4" id="h17-6-4" class="i">+            None,
</a><a href="#h17-6-5" id="h17-6-5" class="i">+            None,
</a><a href="#h17-6-6" id="h17-6-6" class="i">+            None,
</a><a href="#h17-6-7" id="h17-6-7" class="i">+            None,
</a><a href="#h17-6-8" id="h17-6-8" class="i">+            None,
</a><a href="#h17-6-9" id="h17-6-9" class="i">+        ],
</a>     },
<a href="#h17-6-11" id="h17-6-11" class="d">-)
</a><a href="#h17-6-12" id="h17-6-12" class="i">+    labels: [
</a><a href="#h17-6-13" id="h17-6-13" class="i">+        None,
</a><a href="#h17-6-14" id="h17-6-14" class="i">+        None,
</a><a href="#h17-6-15" id="h17-6-15" class="i">+        None,
</a><a href="#h17-6-16" id="h17-6-16" class="i">+        None,
</a><a href="#h17-6-17" id="h17-6-17" class="i">+        None,
</a><a href="#h17-6-18" id="h17-6-18" class="i">+    ],
</a><a href="#h17-6-19" id="h17-6-19" class="i">+}
</a> 
<a href="#h17-6-21" id="h17-6-21" class="d">-Optimized plan: Select(
</a><a href="#h17-6-22" id="h17-6-22" class="d">-    Projection {
</a><a href="#h17-6-23" id="h17-6-23" class="i">+Optimized plan: Select {
</a><a href="#h17-6-24" id="h17-6-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h17-7" id="h17-7" class="h">@@ -375,7 +382,6 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h17-7-3" id="h17-7-3" class="d">-                    alias: None,
</a>                     filter: Some(
                         Constant(
                             Boolean(
<a href="#h17-8" id="h17-8" class="h">@@ -383,15 +389,8 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h17-8-3" id="h17-8-3" class="i">+                    alias: None,
</a>                 },
<a href="#h17-8-5" id="h17-8-5" class="d">-                labels: [
</a><a href="#h17-8-6" id="h17-8-6" class="d">-                    None,
</a><a href="#h17-8-7" id="h17-8-7" class="d">-                    None,
</a><a href="#h17-8-8" id="h17-8-8" class="d">-                    None,
</a><a href="#h17-8-9" id="h17-8-9" class="d">-                    None,
</a><a href="#h17-8-10" id="h17-8-10" class="d">-                    None,
</a><a href="#h17-8-11" id="h17-8-11" class="d">-                    None,
</a><a href="#h17-8-12" id="h17-8-12" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h17-9" id="h17-9" class="h">@@ -448,6 +447,14 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h17-9-3" id="h17-9-3" class="i">+                labels: [
</a><a href="#h17-9-4" id="h17-9-4" class="i">+                    None,
</a><a href="#h17-9-5" id="h17-9-5" class="i">+                    None,
</a><a href="#h17-9-6" id="h17-9-6" class="i">+                    None,
</a><a href="#h17-9-7" id="h17-9-7" class="i">+                    None,
</a><a href="#h17-9-8" id="h17-9-8" class="i">+                    None,
</a><a href="#h17-9-9" id="h17-9-9" class="i">+                    None,
</a><a href="#h17-9-10" id="h17-9-10" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h17-10" id="h17-10" class="h">@@ -457,13 +464,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h17-10-3" id="h17-10-3" class="d">-        labels: [
</a><a href="#h17-10-4" id="h17-10-4" class="d">-            None,
</a><a href="#h17-10-5" id="h17-10-5" class="d">-            None,
</a><a href="#h17-10-6" id="h17-10-6" class="d">-            None,
</a><a href="#h17-10-7" id="h17-10-7" class="d">-            None,
</a><a href="#h17-10-8" id="h17-10-8" class="d">-            None,
</a><a href="#h17-10-9" id="h17-10-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h17-11" id="h17-11" class="h">@@ -486,6 +486,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h17-11-3" id="h17-11-3" class="i">+        labels: [
</a><a href="#h17-11-4" id="h17-11-4" class="i">+            None,
</a><a href="#h17-11-5" id="h17-11-5" class="i">+            None,
</a><a href="#h17-11-6" id="h17-11-6" class="i">+            None,
</a><a href="#h17-11-7" id="h17-11-7" class="i">+            None,
</a><a href="#h17-11-8" id="h17-11-8" class="i">+            None,
</a><a href="#h17-11-9" id="h17-11-9" class="i">+        ],
</a>     },
<a href="#h17-11-11" id="h17-11-11" class="d">-)
</a><a href="#h17-11-12" id="h17-11-12" class="i">+    labels: [
</a><a href="#h17-11-13" id="h17-11-13" class="i">+        None,
</a><a href="#h17-11-14" id="h17-11-14" class="i">+        None,
</a><a href="#h17-11-15" id="h17-11-15" class="i">+        None,
</a><a href="#h17-11-16" id="h17-11-16" class="i">+        None,
</a><a href="#h17-11-17" id="h17-11-17" class="i">+        None,
</a><a href="#h17-11-18" id="h17-11-18" class="i">+    ],
</a><a href="#h17-11-19" id="h17-11-19" class="i">+}
</a> 
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a> b/<a href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings WHERE s IS N
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h18-0-3" id="h18-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h18-0-4" id="h18-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: s, s, s, s, s
       └─ Scan: strings (NOT s IS NULL)
 
<a href="#h18-1" id="h18-1" class="h">@@ -98,8 +98,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h18-1-3" id="h18-1-3" class="d">-Plan: Select(
</a><a href="#h18-1-4" id="h18-1-4" class="d">-    Projection {
</a><a href="#h18-1-5" id="h18-1-5" class="i">+Plan: Select {
</a><a href="#h18-1-6" id="h18-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Filter {
<a href="#h18-2" id="h18-2" class="h">@@ -130,8 +130,8 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h18-2-3" id="h18-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h18-2-5" id="h18-2-5" class="i">+                        alias: None,
</a>                     },
                     predicate: Not(
                         IsNull(
<a href="#h18-3" id="h18-3" class="h">@@ -147,13 +147,6 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h18-3-3" id="h18-3-3" class="d">-                labels: [
</a><a href="#h18-3-4" id="h18-3-4" class="d">-                    None,
</a><a href="#h18-3-5" id="h18-3-5" class="d">-                    None,
</a><a href="#h18-3-6" id="h18-3-6" class="d">-                    None,
</a><a href="#h18-3-7" id="h18-3-7" class="d">-                    None,
</a><a href="#h18-3-8" id="h18-3-8" class="d">-                    None,
</a><a href="#h18-3-9" id="h18-3-9" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h18-4" id="h18-4" class="h">@@ -201,6 +194,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h18-4-3" id="h18-4-3" class="i">+                labels: [
</a><a href="#h18-4-4" id="h18-4-4" class="i">+                    None,
</a><a href="#h18-4-5" id="h18-4-5" class="i">+                    None,
</a><a href="#h18-4-6" id="h18-4-6" class="i">+                    None,
</a><a href="#h18-4-7" id="h18-4-7" class="i">+                    None,
</a><a href="#h18-4-8" id="h18-4-8" class="i">+                    None,
</a><a href="#h18-4-9" id="h18-4-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h18-5" id="h18-5" class="h">@@ -210,13 +210,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h18-5-3" id="h18-5-3" class="d">-        labels: [
</a><a href="#h18-5-4" id="h18-5-4" class="d">-            None,
</a><a href="#h18-5-5" id="h18-5-5" class="d">-            None,
</a><a href="#h18-5-6" id="h18-5-6" class="d">-            None,
</a><a href="#h18-5-7" id="h18-5-7" class="d">-            None,
</a><a href="#h18-5-8" id="h18-5-8" class="d">-            None,
</a><a href="#h18-5-9" id="h18-5-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h18-6" id="h18-6" class="h">@@ -239,11 +232,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h18-6-3" id="h18-6-3" class="i">+        labels: [
</a><a href="#h18-6-4" id="h18-6-4" class="i">+            None,
</a><a href="#h18-6-5" id="h18-6-5" class="i">+            None,
</a><a href="#h18-6-6" id="h18-6-6" class="i">+            None,
</a><a href="#h18-6-7" id="h18-6-7" class="i">+            None,
</a><a href="#h18-6-8" id="h18-6-8" class="i">+            None,
</a><a href="#h18-6-9" id="h18-6-9" class="i">+        ],
</a>     },
<a href="#h18-6-11" id="h18-6-11" class="d">-)
</a><a href="#h18-6-12" id="h18-6-12" class="i">+    labels: [
</a><a href="#h18-6-13" id="h18-6-13" class="i">+        None,
</a><a href="#h18-6-14" id="h18-6-14" class="i">+        None,
</a><a href="#h18-6-15" id="h18-6-15" class="i">+        None,
</a><a href="#h18-6-16" id="h18-6-16" class="i">+        None,
</a><a href="#h18-6-17" id="h18-6-17" class="i">+        None,
</a><a href="#h18-6-18" id="h18-6-18" class="i">+    ],
</a><a href="#h18-6-19" id="h18-6-19" class="i">+}
</a> 
<a href="#h18-6-21" id="h18-6-21" class="d">-Optimized plan: Select(
</a><a href="#h18-6-22" id="h18-6-22" class="d">-    Projection {
</a><a href="#h18-6-23" id="h18-6-23" class="i">+Optimized plan: Select {
</a><a href="#h18-6-24" id="h18-6-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h18-7" id="h18-7" class="h">@@ -273,7 +280,6 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h18-7-3" id="h18-7-3" class="d">-                    alias: None,
</a>                     filter: Some(
                         Not(
                             IsNull(
<a href="#h18-8" id="h18-8" class="h">@@ -289,14 +295,8 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h18-8-3" id="h18-8-3" class="i">+                    alias: None,
</a>                 },
<a href="#h18-8-5" id="h18-8-5" class="d">-                labels: [
</a><a href="#h18-8-6" id="h18-8-6" class="d">-                    None,
</a><a href="#h18-8-7" id="h18-8-7" class="d">-                    None,
</a><a href="#h18-8-8" id="h18-8-8" class="d">-                    None,
</a><a href="#h18-8-9" id="h18-8-9" class="d">-                    None,
</a><a href="#h18-8-10" id="h18-8-10" class="d">-                    None,
</a><a href="#h18-8-11" id="h18-8-11" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h18-9" id="h18-9" class="h">@@ -344,6 +344,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h18-9-3" id="h18-9-3" class="i">+                labels: [
</a><a href="#h18-9-4" id="h18-9-4" class="i">+                    None,
</a><a href="#h18-9-5" id="h18-9-5" class="i">+                    None,
</a><a href="#h18-9-6" id="h18-9-6" class="i">+                    None,
</a><a href="#h18-9-7" id="h18-9-7" class="i">+                    None,
</a><a href="#h18-9-8" id="h18-9-8" class="i">+                    None,
</a><a href="#h18-9-9" id="h18-9-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h18-10" id="h18-10" class="h">@@ -353,13 +360,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h18-10-3" id="h18-10-3" class="d">-        labels: [
</a><a href="#h18-10-4" id="h18-10-4" class="d">-            None,
</a><a href="#h18-10-5" id="h18-10-5" class="d">-            None,
</a><a href="#h18-10-6" id="h18-10-6" class="d">-            None,
</a><a href="#h18-10-7" id="h18-10-7" class="d">-            None,
</a><a href="#h18-10-8" id="h18-10-8" class="d">-            None,
</a><a href="#h18-10-9" id="h18-10-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h18-11" id="h18-11" class="h">@@ -382,6 +382,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h18-11-3" id="h18-11-3" class="i">+        labels: [
</a><a href="#h18-11-4" id="h18-11-4" class="i">+            None,
</a><a href="#h18-11-5" id="h18-11-5" class="i">+            None,
</a><a href="#h18-11-6" id="h18-11-6" class="i">+            None,
</a><a href="#h18-11-7" id="h18-11-7" class="i">+            None,
</a><a href="#h18-11-8" id="h18-11-8" class="i">+            None,
</a><a href="#h18-11-9" id="h18-11-9" class="i">+        ],
</a>     },
<a href="#h18-11-11" id="h18-11-11" class="d">-)
</a><a href="#h18-11-12" id="h18-11-12" class="i">+    labels: [
</a><a href="#h18-11-13" id="h18-11-13" class="i">+        None,
</a><a href="#h18-11-14" id="h18-11-14" class="i">+        None,
</a><a href="#h18-11-15" id="h18-11-15" class="i">+        None,
</a><a href="#h18-11-16" id="h18-11-16" class="i">+        None,
</a><a href="#h18-11-17" id="h18-11-17" class="i">+        None,
</a><a href="#h18-11-18" id="h18-11-18" class="i">+    ],
</a><a href="#h18-11-19" id="h18-11-19" class="i">+}
</a> 
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a> b/<a href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -2,7 +2,7 @@ Query: SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings
</a> 
 Explain:
 Projection: #0, #1, #2, #3, #4
<a href="#h19-0-3" id="h19-0-3" class="d">-└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h19-0-4" id="h19-0-4" class="i">+└─ Aggregation: min, max, sum, count, avg
</a>    └─ Projection: s, s, s, s, s
       └─ Scan: strings
 
<a href="#h19-1" id="h19-1" class="h">@@ -85,8 +85,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h19-1-3" id="h19-1-3" class="d">-Plan: Select(
</a><a href="#h19-1-4" id="h19-1-4" class="d">-    Projection {
</a><a href="#h19-1-5" id="h19-1-5" class="i">+Plan: Select {
</a><a href="#h19-1-6" id="h19-1-6" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h19-2" id="h19-2" class="h">@@ -116,16 +116,9 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h19-2-3" id="h19-2-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h19-2-5" id="h19-2-5" class="i">+                    alias: None,
</a>                 },
<a href="#h19-2-7" id="h19-2-7" class="d">-                labels: [
</a><a href="#h19-2-8" id="h19-2-8" class="d">-                    None,
</a><a href="#h19-2-9" id="h19-2-9" class="d">-                    None,
</a><a href="#h19-2-10" id="h19-2-10" class="d">-                    None,
</a><a href="#h19-2-11" id="h19-2-11" class="d">-                    None,
</a><a href="#h19-2-12" id="h19-2-12" class="d">-                    None,
</a><a href="#h19-2-13" id="h19-2-13" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h19-3" id="h19-3" class="h">@@ -173,6 +166,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h19-3-3" id="h19-3-3" class="i">+                labels: [
</a><a href="#h19-3-4" id="h19-3-4" class="i">+                    None,
</a><a href="#h19-3-5" id="h19-3-5" class="i">+                    None,
</a><a href="#h19-3-6" id="h19-3-6" class="i">+                    None,
</a><a href="#h19-3-7" id="h19-3-7" class="i">+                    None,
</a><a href="#h19-3-8" id="h19-3-8" class="i">+                    None,
</a><a href="#h19-3-9" id="h19-3-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h19-4" id="h19-4" class="h">@@ -182,13 +182,6 @@ Plan: Select(
</a>                 Average,
             ],
         },
<a href="#h19-4-3" id="h19-4-3" class="d">-        labels: [
</a><a href="#h19-4-4" id="h19-4-4" class="d">-            None,
</a><a href="#h19-4-5" id="h19-4-5" class="d">-            None,
</a><a href="#h19-4-6" id="h19-4-6" class="d">-            None,
</a><a href="#h19-4-7" id="h19-4-7" class="d">-            None,
</a><a href="#h19-4-8" id="h19-4-8" class="d">-            None,
</a><a href="#h19-4-9" id="h19-4-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h19-5" id="h19-5" class="h">@@ -211,11 +204,25 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h19-5-3" id="h19-5-3" class="i">+        labels: [
</a><a href="#h19-5-4" id="h19-5-4" class="i">+            None,
</a><a href="#h19-5-5" id="h19-5-5" class="i">+            None,
</a><a href="#h19-5-6" id="h19-5-6" class="i">+            None,
</a><a href="#h19-5-7" id="h19-5-7" class="i">+            None,
</a><a href="#h19-5-8" id="h19-5-8" class="i">+            None,
</a><a href="#h19-5-9" id="h19-5-9" class="i">+        ],
</a>     },
<a href="#h19-5-11" id="h19-5-11" class="d">-)
</a><a href="#h19-5-12" id="h19-5-12" class="i">+    labels: [
</a><a href="#h19-5-13" id="h19-5-13" class="i">+        None,
</a><a href="#h19-5-14" id="h19-5-14" class="i">+        None,
</a><a href="#h19-5-15" id="h19-5-15" class="i">+        None,
</a><a href="#h19-5-16" id="h19-5-16" class="i">+        None,
</a><a href="#h19-5-17" id="h19-5-17" class="i">+        None,
</a><a href="#h19-5-18" id="h19-5-18" class="i">+    ],
</a><a href="#h19-5-19" id="h19-5-19" class="i">+}
</a> 
<a href="#h19-5-21" id="h19-5-21" class="d">-Optimized plan: Select(
</a><a href="#h19-5-22" id="h19-5-22" class="d">-    Projection {
</a><a href="#h19-5-23" id="h19-5-23" class="i">+Optimized plan: Select {
</a><a href="#h19-5-24" id="h19-5-24" class="i">+    root: Projection {
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h19-6" id="h19-6" class="h">@@ -245,16 +252,9 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h19-6-3" id="h19-6-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h19-6-5" id="h19-6-5" class="i">+                    alias: None,
</a>                 },
<a href="#h19-6-7" id="h19-6-7" class="d">-                labels: [
</a><a href="#h19-6-8" id="h19-6-8" class="d">-                    None,
</a><a href="#h19-6-9" id="h19-6-9" class="d">-                    None,
</a><a href="#h19-6-10" id="h19-6-10" class="d">-                    None,
</a><a href="#h19-6-11" id="h19-6-11" class="d">-                    None,
</a><a href="#h19-6-12" id="h19-6-12" class="d">-                    None,
</a><a href="#h19-6-13" id="h19-6-13" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h19-7" id="h19-7" class="h">@@ -302,6 +302,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h19-7-3" id="h19-7-3" class="i">+                labels: [
</a><a href="#h19-7-4" id="h19-7-4" class="i">+                    None,
</a><a href="#h19-7-5" id="h19-7-5" class="i">+                    None,
</a><a href="#h19-7-6" id="h19-7-6" class="i">+                    None,
</a><a href="#h19-7-7" id="h19-7-7" class="i">+                    None,
</a><a href="#h19-7-8" id="h19-7-8" class="i">+                    None,
</a><a href="#h19-7-9" id="h19-7-9" class="i">+                ],
</a>             },
             aggregates: [
                 Min,
<a href="#h19-8" id="h19-8" class="h">@@ -311,13 +318,6 @@ Optimized plan: Select(
</a>                 Average,
             ],
         },
<a href="#h19-8-3" id="h19-8-3" class="d">-        labels: [
</a><a href="#h19-8-4" id="h19-8-4" class="d">-            None,
</a><a href="#h19-8-5" id="h19-8-5" class="d">-            None,
</a><a href="#h19-8-6" id="h19-8-6" class="d">-            None,
</a><a href="#h19-8-7" id="h19-8-7" class="d">-            None,
</a><a href="#h19-8-8" id="h19-8-8" class="d">-            None,
</a><a href="#h19-8-9" id="h19-8-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h19-9" id="h19-9" class="h">@@ -340,6 +340,20 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h19-9-3" id="h19-9-3" class="i">+        labels: [
</a><a href="#h19-9-4" id="h19-9-4" class="i">+            None,
</a><a href="#h19-9-5" id="h19-9-5" class="i">+            None,
</a><a href="#h19-9-6" id="h19-9-6" class="i">+            None,
</a><a href="#h19-9-7" id="h19-9-7" class="i">+            None,
</a><a href="#h19-9-8" id="h19-9-8" class="i">+            None,
</a><a href="#h19-9-9" id="h19-9-9" class="i">+        ],
</a>     },
<a href="#h19-9-11" id="h19-9-11" class="d">-)
</a><a href="#h19-9-12" id="h19-9-12" class="i">+    labels: [
</a><a href="#h19-9-13" id="h19-9-13" class="i">+        None,
</a><a href="#h19-9-14" id="h19-9-14" class="i">+        None,
</a><a href="#h19-9-15" id="h19-9-15" class="i">+        None,
</a><a href="#h19-9-16" id="h19-9-16" class="i">+        None,
</a><a href="#h19-9-17" id="h19-9-17" class="i">+        None,
</a><a href="#h19-9-18" id="h19-9-18" class="i">+    ],
</a><a href="#h19-9-19" id="h19-9-19" class="i">+}
</a> 
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/all.html">tests/sql/query/all</a> b/<a href="../file/tests/sql/query/all.html">tests/sql/query/all</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -31,8 +31,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h20-0-3" id="h20-0-3" class="d">-Plan: Select(
</a><a href="#h20-0-4" id="h20-0-4" class="d">-    Scan {
</a><a href="#h20-0-5" id="h20-0-5" class="i">+Plan: Select {
</a><a href="#h20-0-6" id="h20-0-6" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h20-1" id="h20-1" class="h">@@ -110,13 +110,71 @@ Plan: Select(
</a>                 },
             ],
         },
<a href="#h20-1-3" id="h20-1-3" class="d">-        alias: None,
</a>         filter: None,
<a href="#h20-1-5" id="h20-1-5" class="i">+        alias: None,
</a>     },
<a href="#h20-1-7" id="h20-1-7" class="d">-)
</a><a href="#h20-1-8" id="h20-1-8" class="i">+    labels: [
</a><a href="#h20-1-9" id="h20-1-9" class="i">+        Some(
</a><a href="#h20-1-10" id="h20-1-10" class="i">+            (
</a><a href="#h20-1-11" id="h20-1-11" class="i">+                Some(
</a><a href="#h20-1-12" id="h20-1-12" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-1-13" id="h20-1-13" class="i">+                ),
</a><a href="#h20-1-14" id="h20-1-14" class="i">+                &quot;id&quot;,
</a><a href="#h20-1-15" id="h20-1-15" class="i">+            ),
</a><a href="#h20-1-16" id="h20-1-16" class="i">+        ),
</a><a href="#h20-1-17" id="h20-1-17" class="i">+        Some(
</a><a href="#h20-1-18" id="h20-1-18" class="i">+            (
</a><a href="#h20-1-19" id="h20-1-19" class="i">+                Some(
</a><a href="#h20-1-20" id="h20-1-20" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-1-21" id="h20-1-21" class="i">+                ),
</a><a href="#h20-1-22" id="h20-1-22" class="i">+                &quot;title&quot;,
</a><a href="#h20-1-23" id="h20-1-23" class="i">+            ),
</a><a href="#h20-1-24" id="h20-1-24" class="i">+        ),
</a><a href="#h20-1-25" id="h20-1-25" class="i">+        Some(
</a><a href="#h20-1-26" id="h20-1-26" class="i">+            (
</a><a href="#h20-1-27" id="h20-1-27" class="i">+                Some(
</a><a href="#h20-1-28" id="h20-1-28" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-1-29" id="h20-1-29" class="i">+                ),
</a><a href="#h20-1-30" id="h20-1-30" class="i">+                &quot;studio_id&quot;,
</a><a href="#h20-1-31" id="h20-1-31" class="i">+            ),
</a><a href="#h20-1-32" id="h20-1-32" class="i">+        ),
</a><a href="#h20-1-33" id="h20-1-33" class="i">+        Some(
</a><a href="#h20-1-34" id="h20-1-34" class="i">+            (
</a><a href="#h20-1-35" id="h20-1-35" class="i">+                Some(
</a><a href="#h20-1-36" id="h20-1-36" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-1-37" id="h20-1-37" class="i">+                ),
</a><a href="#h20-1-38" id="h20-1-38" class="i">+                &quot;genre_id&quot;,
</a><a href="#h20-1-39" id="h20-1-39" class="i">+            ),
</a><a href="#h20-1-40" id="h20-1-40" class="i">+        ),
</a><a href="#h20-1-41" id="h20-1-41" class="i">+        Some(
</a><a href="#h20-1-42" id="h20-1-42" class="i">+            (
</a><a href="#h20-1-43" id="h20-1-43" class="i">+                Some(
</a><a href="#h20-1-44" id="h20-1-44" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-1-45" id="h20-1-45" class="i">+                ),
</a><a href="#h20-1-46" id="h20-1-46" class="i">+                &quot;released&quot;,
</a><a href="#h20-1-47" id="h20-1-47" class="i">+            ),
</a><a href="#h20-1-48" id="h20-1-48" class="i">+        ),
</a><a href="#h20-1-49" id="h20-1-49" class="i">+        Some(
</a><a href="#h20-1-50" id="h20-1-50" class="i">+            (
</a><a href="#h20-1-51" id="h20-1-51" class="i">+                Some(
</a><a href="#h20-1-52" id="h20-1-52" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-1-53" id="h20-1-53" class="i">+                ),
</a><a href="#h20-1-54" id="h20-1-54" class="i">+                &quot;rating&quot;,
</a><a href="#h20-1-55" id="h20-1-55" class="i">+            ),
</a><a href="#h20-1-56" id="h20-1-56" class="i">+        ),
</a><a href="#h20-1-57" id="h20-1-57" class="i">+        Some(
</a><a href="#h20-1-58" id="h20-1-58" class="i">+            (
</a><a href="#h20-1-59" id="h20-1-59" class="i">+                Some(
</a><a href="#h20-1-60" id="h20-1-60" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-1-61" id="h20-1-61" class="i">+                ),
</a><a href="#h20-1-62" id="h20-1-62" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h20-1-63" id="h20-1-63" class="i">+            ),
</a><a href="#h20-1-64" id="h20-1-64" class="i">+        ),
</a><a href="#h20-1-65" id="h20-1-65" class="i">+    ],
</a><a href="#h20-1-66" id="h20-1-66" class="i">+}
</a> 
<a href="#h20-1-68" id="h20-1-68" class="d">-Optimized plan: Select(
</a><a href="#h20-1-69" id="h20-1-69" class="d">-    Scan {
</a><a href="#h20-1-70" id="h20-1-70" class="i">+Optimized plan: Select {
</a><a href="#h20-1-71" id="h20-1-71" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h20-2" id="h20-2" class="h">@@ -194,8 +252,66 @@ Optimized plan: Select(
</a>                 },
             ],
         },
<a href="#h20-2-3" id="h20-2-3" class="d">-        alias: None,
</a>         filter: None,
<a href="#h20-2-5" id="h20-2-5" class="i">+        alias: None,
</a>     },
<a href="#h20-2-7" id="h20-2-7" class="d">-)
</a><a href="#h20-2-8" id="h20-2-8" class="i">+    labels: [
</a><a href="#h20-2-9" id="h20-2-9" class="i">+        Some(
</a><a href="#h20-2-10" id="h20-2-10" class="i">+            (
</a><a href="#h20-2-11" id="h20-2-11" class="i">+                Some(
</a><a href="#h20-2-12" id="h20-2-12" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-2-13" id="h20-2-13" class="i">+                ),
</a><a href="#h20-2-14" id="h20-2-14" class="i">+                &quot;id&quot;,
</a><a href="#h20-2-15" id="h20-2-15" class="i">+            ),
</a><a href="#h20-2-16" id="h20-2-16" class="i">+        ),
</a><a href="#h20-2-17" id="h20-2-17" class="i">+        Some(
</a><a href="#h20-2-18" id="h20-2-18" class="i">+            (
</a><a href="#h20-2-19" id="h20-2-19" class="i">+                Some(
</a><a href="#h20-2-20" id="h20-2-20" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-2-21" id="h20-2-21" class="i">+                ),
</a><a href="#h20-2-22" id="h20-2-22" class="i">+                &quot;title&quot;,
</a><a href="#h20-2-23" id="h20-2-23" class="i">+            ),
</a><a href="#h20-2-24" id="h20-2-24" class="i">+        ),
</a><a href="#h20-2-25" id="h20-2-25" class="i">+        Some(
</a><a href="#h20-2-26" id="h20-2-26" class="i">+            (
</a><a href="#h20-2-27" id="h20-2-27" class="i">+                Some(
</a><a href="#h20-2-28" id="h20-2-28" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-2-29" id="h20-2-29" class="i">+                ),
</a><a href="#h20-2-30" id="h20-2-30" class="i">+                &quot;studio_id&quot;,
</a><a href="#h20-2-31" id="h20-2-31" class="i">+            ),
</a><a href="#h20-2-32" id="h20-2-32" class="i">+        ),
</a><a href="#h20-2-33" id="h20-2-33" class="i">+        Some(
</a><a href="#h20-2-34" id="h20-2-34" class="i">+            (
</a><a href="#h20-2-35" id="h20-2-35" class="i">+                Some(
</a><a href="#h20-2-36" id="h20-2-36" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-2-37" id="h20-2-37" class="i">+                ),
</a><a href="#h20-2-38" id="h20-2-38" class="i">+                &quot;genre_id&quot;,
</a><a href="#h20-2-39" id="h20-2-39" class="i">+            ),
</a><a href="#h20-2-40" id="h20-2-40" class="i">+        ),
</a><a href="#h20-2-41" id="h20-2-41" class="i">+        Some(
</a><a href="#h20-2-42" id="h20-2-42" class="i">+            (
</a><a href="#h20-2-43" id="h20-2-43" class="i">+                Some(
</a><a href="#h20-2-44" id="h20-2-44" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-2-45" id="h20-2-45" class="i">+                ),
</a><a href="#h20-2-46" id="h20-2-46" class="i">+                &quot;released&quot;,
</a><a href="#h20-2-47" id="h20-2-47" class="i">+            ),
</a><a href="#h20-2-48" id="h20-2-48" class="i">+        ),
</a><a href="#h20-2-49" id="h20-2-49" class="i">+        Some(
</a><a href="#h20-2-50" id="h20-2-50" class="i">+            (
</a><a href="#h20-2-51" id="h20-2-51" class="i">+                Some(
</a><a href="#h20-2-52" id="h20-2-52" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-2-53" id="h20-2-53" class="i">+                ),
</a><a href="#h20-2-54" id="h20-2-54" class="i">+                &quot;rating&quot;,
</a><a href="#h20-2-55" id="h20-2-55" class="i">+            ),
</a><a href="#h20-2-56" id="h20-2-56" class="i">+        ),
</a><a href="#h20-2-57" id="h20-2-57" class="i">+        Some(
</a><a href="#h20-2-58" id="h20-2-58" class="i">+            (
</a><a href="#h20-2-59" id="h20-2-59" class="i">+                Some(
</a><a href="#h20-2-60" id="h20-2-60" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-2-61" id="h20-2-61" class="i">+                ),
</a><a href="#h20-2-62" id="h20-2-62" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h20-2-63" id="h20-2-63" class="i">+            ),
</a><a href="#h20-2-64" id="h20-2-64" class="i">+        ),
</a><a href="#h20-2-65" id="h20-2-65" class="i">+    ],
</a><a href="#h20-2-66" id="h20-2-66" class="i">+}
</a> 
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a> b/<a href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -80,8 +80,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h21-0-3" id="h21-0-3" class="d">-Plan: Select(
</a><a href="#h21-0-4" id="h21-0-4" class="d">-    Projection {
</a><a href="#h21-0-5" id="h21-0-5" class="i">+Plan: Select {
</a><a href="#h21-0-6" id="h21-0-6" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h21-1" id="h21-1" class="h">@@ -160,36 +160,9 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h21-1-3" id="h21-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h21-1-5" id="h21-1-5" class="i">+            alias: None,
</a>         },
<a href="#h21-1-7" id="h21-1-7" class="d">-        labels: [
</a><a href="#h21-1-8" id="h21-1-8" class="d">-            None,
</a><a href="#h21-1-9" id="h21-1-9" class="d">-            Some(
</a><a href="#h21-1-10" id="h21-1-10" class="d">-                (
</a><a href="#h21-1-11" id="h21-1-11" class="d">-                    None,
</a><a href="#h21-1-12" id="h21-1-12" class="d">-                    &quot;b&quot;,
</a><a href="#h21-1-13" id="h21-1-13" class="d">-                ),
</a><a href="#h21-1-14" id="h21-1-14" class="d">-            ),
</a><a href="#h21-1-15" id="h21-1-15" class="d">-            Some(
</a><a href="#h21-1-16" id="h21-1-16" class="d">-                (
</a><a href="#h21-1-17" id="h21-1-17" class="d">-                    None,
</a><a href="#h21-1-18" id="h21-1-18" class="d">-                    &quot;c&quot;,
</a><a href="#h21-1-19" id="h21-1-19" class="d">-                ),
</a><a href="#h21-1-20" id="h21-1-20" class="d">-            ),
</a><a href="#h21-1-21" id="h21-1-21" class="d">-            Some(
</a><a href="#h21-1-22" id="h21-1-22" class="d">-                (
</a><a href="#h21-1-23" id="h21-1-23" class="d">-                    None,
</a><a href="#h21-1-24" id="h21-1-24" class="d">-                    &quot;👋&quot;,
</a><a href="#h21-1-25" id="h21-1-25" class="d">-                ),
</a><a href="#h21-1-26" id="h21-1-26" class="d">-            ),
</a><a href="#h21-1-27" id="h21-1-27" class="d">-            Some(
</a><a href="#h21-1-28" id="h21-1-28" class="d">-                (
</a><a href="#h21-1-29" id="h21-1-29" class="d">-                    None,
</a><a href="#h21-1-30" id="h21-1-30" class="d">-                    &quot;some id&quot;,
</a><a href="#h21-1-31" id="h21-1-31" class="d">-                ),
</a><a href="#h21-1-32" id="h21-1-32" class="d">-            ),
</a><a href="#h21-1-33" id="h21-1-33" class="d">-        ],
</a>         expressions: [
             Constant(
                 Integer(
<a href="#h21-2" id="h21-2" class="h">@@ -221,11 +194,65 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h21-2-3" id="h21-2-3" class="i">+        labels: [
</a><a href="#h21-2-4" id="h21-2-4" class="i">+            None,
</a><a href="#h21-2-5" id="h21-2-5" class="i">+            Some(
</a><a href="#h21-2-6" id="h21-2-6" class="i">+                (
</a><a href="#h21-2-7" id="h21-2-7" class="i">+                    None,
</a><a href="#h21-2-8" id="h21-2-8" class="i">+                    &quot;b&quot;,
</a><a href="#h21-2-9" id="h21-2-9" class="i">+                ),
</a><a href="#h21-2-10" id="h21-2-10" class="i">+            ),
</a><a href="#h21-2-11" id="h21-2-11" class="i">+            Some(
</a><a href="#h21-2-12" id="h21-2-12" class="i">+                (
</a><a href="#h21-2-13" id="h21-2-13" class="i">+                    None,
</a><a href="#h21-2-14" id="h21-2-14" class="i">+                    &quot;c&quot;,
</a><a href="#h21-2-15" id="h21-2-15" class="i">+                ),
</a><a href="#h21-2-16" id="h21-2-16" class="i">+            ),
</a><a href="#h21-2-17" id="h21-2-17" class="i">+            Some(
</a><a href="#h21-2-18" id="h21-2-18" class="i">+                (
</a><a href="#h21-2-19" id="h21-2-19" class="i">+                    None,
</a><a href="#h21-2-20" id="h21-2-20" class="i">+                    &quot;👋&quot;,
</a><a href="#h21-2-21" id="h21-2-21" class="i">+                ),
</a><a href="#h21-2-22" id="h21-2-22" class="i">+            ),
</a><a href="#h21-2-23" id="h21-2-23" class="i">+            Some(
</a><a href="#h21-2-24" id="h21-2-24" class="i">+                (
</a><a href="#h21-2-25" id="h21-2-25" class="i">+                    None,
</a><a href="#h21-2-26" id="h21-2-26" class="i">+                    &quot;some id&quot;,
</a><a href="#h21-2-27" id="h21-2-27" class="i">+                ),
</a><a href="#h21-2-28" id="h21-2-28" class="i">+            ),
</a><a href="#h21-2-29" id="h21-2-29" class="i">+        ],
</a>     },
<a href="#h21-2-31" id="h21-2-31" class="d">-)
</a><a href="#h21-2-32" id="h21-2-32" class="i">+    labels: [
</a><a href="#h21-2-33" id="h21-2-33" class="i">+        None,
</a><a href="#h21-2-34" id="h21-2-34" class="i">+        Some(
</a><a href="#h21-2-35" id="h21-2-35" class="i">+            (
</a><a href="#h21-2-36" id="h21-2-36" class="i">+                None,
</a><a href="#h21-2-37" id="h21-2-37" class="i">+                &quot;b&quot;,
</a><a href="#h21-2-38" id="h21-2-38" class="i">+            ),
</a><a href="#h21-2-39" id="h21-2-39" class="i">+        ),
</a><a href="#h21-2-40" id="h21-2-40" class="i">+        Some(
</a><a href="#h21-2-41" id="h21-2-41" class="i">+            (
</a><a href="#h21-2-42" id="h21-2-42" class="i">+                None,
</a><a href="#h21-2-43" id="h21-2-43" class="i">+                &quot;c&quot;,
</a><a href="#h21-2-44" id="h21-2-44" class="i">+            ),
</a><a href="#h21-2-45" id="h21-2-45" class="i">+        ),
</a><a href="#h21-2-46" id="h21-2-46" class="i">+        Some(
</a><a href="#h21-2-47" id="h21-2-47" class="i">+            (
</a><a href="#h21-2-48" id="h21-2-48" class="i">+                None,
</a><a href="#h21-2-49" id="h21-2-49" class="i">+                &quot;👋&quot;,
</a><a href="#h21-2-50" id="h21-2-50" class="i">+            ),
</a><a href="#h21-2-51" id="h21-2-51" class="i">+        ),
</a><a href="#h21-2-52" id="h21-2-52" class="i">+        Some(
</a><a href="#h21-2-53" id="h21-2-53" class="i">+            (
</a><a href="#h21-2-54" id="h21-2-54" class="i">+                None,
</a><a href="#h21-2-55" id="h21-2-55" class="i">+                &quot;some id&quot;,
</a><a href="#h21-2-56" id="h21-2-56" class="i">+            ),
</a><a href="#h21-2-57" id="h21-2-57" class="i">+        ),
</a><a href="#h21-2-58" id="h21-2-58" class="i">+    ],
</a><a href="#h21-2-59" id="h21-2-59" class="i">+}
</a> 
<a href="#h21-2-61" id="h21-2-61" class="d">-Optimized plan: Select(
</a><a href="#h21-2-62" id="h21-2-62" class="d">-    Projection {
</a><a href="#h21-2-63" id="h21-2-63" class="i">+Optimized plan: Select {
</a><a href="#h21-2-64" id="h21-2-64" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h21-3" id="h21-3" class="h">@@ -304,36 +331,9 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h21-3-3" id="h21-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h21-3-5" id="h21-3-5" class="i">+            alias: None,
</a>         },
<a href="#h21-3-7" id="h21-3-7" class="d">-        labels: [
</a><a href="#h21-3-8" id="h21-3-8" class="d">-            None,
</a><a href="#h21-3-9" id="h21-3-9" class="d">-            Some(
</a><a href="#h21-3-10" id="h21-3-10" class="d">-                (
</a><a href="#h21-3-11" id="h21-3-11" class="d">-                    None,
</a><a href="#h21-3-12" id="h21-3-12" class="d">-                    &quot;b&quot;,
</a><a href="#h21-3-13" id="h21-3-13" class="d">-                ),
</a><a href="#h21-3-14" id="h21-3-14" class="d">-            ),
</a><a href="#h21-3-15" id="h21-3-15" class="d">-            Some(
</a><a href="#h21-3-16" id="h21-3-16" class="d">-                (
</a><a href="#h21-3-17" id="h21-3-17" class="d">-                    None,
</a><a href="#h21-3-18" id="h21-3-18" class="d">-                    &quot;c&quot;,
</a><a href="#h21-3-19" id="h21-3-19" class="d">-                ),
</a><a href="#h21-3-20" id="h21-3-20" class="d">-            ),
</a><a href="#h21-3-21" id="h21-3-21" class="d">-            Some(
</a><a href="#h21-3-22" id="h21-3-22" class="d">-                (
</a><a href="#h21-3-23" id="h21-3-23" class="d">-                    None,
</a><a href="#h21-3-24" id="h21-3-24" class="d">-                    &quot;👋&quot;,
</a><a href="#h21-3-25" id="h21-3-25" class="d">-                ),
</a><a href="#h21-3-26" id="h21-3-26" class="d">-            ),
</a><a href="#h21-3-27" id="h21-3-27" class="d">-            Some(
</a><a href="#h21-3-28" id="h21-3-28" class="d">-                (
</a><a href="#h21-3-29" id="h21-3-29" class="d">-                    None,
</a><a href="#h21-3-30" id="h21-3-30" class="d">-                    &quot;some id&quot;,
</a><a href="#h21-3-31" id="h21-3-31" class="d">-                ),
</a><a href="#h21-3-32" id="h21-3-32" class="d">-            ),
</a><a href="#h21-3-33" id="h21-3-33" class="d">-        ],
</a>         expressions: [
             Constant(
                 Integer(
<a href="#h21-4" id="h21-4" class="h">@@ -365,6 +365,60 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h21-4-3" id="h21-4-3" class="i">+        labels: [
</a><a href="#h21-4-4" id="h21-4-4" class="i">+            None,
</a><a href="#h21-4-5" id="h21-4-5" class="i">+            Some(
</a><a href="#h21-4-6" id="h21-4-6" class="i">+                (
</a><a href="#h21-4-7" id="h21-4-7" class="i">+                    None,
</a><a href="#h21-4-8" id="h21-4-8" class="i">+                    &quot;b&quot;,
</a><a href="#h21-4-9" id="h21-4-9" class="i">+                ),
</a><a href="#h21-4-10" id="h21-4-10" class="i">+            ),
</a><a href="#h21-4-11" id="h21-4-11" class="i">+            Some(
</a><a href="#h21-4-12" id="h21-4-12" class="i">+                (
</a><a href="#h21-4-13" id="h21-4-13" class="i">+                    None,
</a><a href="#h21-4-14" id="h21-4-14" class="i">+                    &quot;c&quot;,
</a><a href="#h21-4-15" id="h21-4-15" class="i">+                ),
</a><a href="#h21-4-16" id="h21-4-16" class="i">+            ),
</a><a href="#h21-4-17" id="h21-4-17" class="i">+            Some(
</a><a href="#h21-4-18" id="h21-4-18" class="i">+                (
</a><a href="#h21-4-19" id="h21-4-19" class="i">+                    None,
</a><a href="#h21-4-20" id="h21-4-20" class="i">+                    &quot;👋&quot;,
</a><a href="#h21-4-21" id="h21-4-21" class="i">+                ),
</a><a href="#h21-4-22" id="h21-4-22" class="i">+            ),
</a><a href="#h21-4-23" id="h21-4-23" class="i">+            Some(
</a><a href="#h21-4-24" id="h21-4-24" class="i">+                (
</a><a href="#h21-4-25" id="h21-4-25" class="i">+                    None,
</a><a href="#h21-4-26" id="h21-4-26" class="i">+                    &quot;some id&quot;,
</a><a href="#h21-4-27" id="h21-4-27" class="i">+                ),
</a><a href="#h21-4-28" id="h21-4-28" class="i">+            ),
</a><a href="#h21-4-29" id="h21-4-29" class="i">+        ],
</a>     },
<a href="#h21-4-31" id="h21-4-31" class="d">-)
</a><a href="#h21-4-32" id="h21-4-32" class="i">+    labels: [
</a><a href="#h21-4-33" id="h21-4-33" class="i">+        None,
</a><a href="#h21-4-34" id="h21-4-34" class="i">+        Some(
</a><a href="#h21-4-35" id="h21-4-35" class="i">+            (
</a><a href="#h21-4-36" id="h21-4-36" class="i">+                None,
</a><a href="#h21-4-37" id="h21-4-37" class="i">+                &quot;b&quot;,
</a><a href="#h21-4-38" id="h21-4-38" class="i">+            ),
</a><a href="#h21-4-39" id="h21-4-39" class="i">+        ),
</a><a href="#h21-4-40" id="h21-4-40" class="i">+        Some(
</a><a href="#h21-4-41" id="h21-4-41" class="i">+            (
</a><a href="#h21-4-42" id="h21-4-42" class="i">+                None,
</a><a href="#h21-4-43" id="h21-4-43" class="i">+                &quot;c&quot;,
</a><a href="#h21-4-44" id="h21-4-44" class="i">+            ),
</a><a href="#h21-4-45" id="h21-4-45" class="i">+        ),
</a><a href="#h21-4-46" id="h21-4-46" class="i">+        Some(
</a><a href="#h21-4-47" id="h21-4-47" class="i">+            (
</a><a href="#h21-4-48" id="h21-4-48" class="i">+                None,
</a><a href="#h21-4-49" id="h21-4-49" class="i">+                &quot;👋&quot;,
</a><a href="#h21-4-50" id="h21-4-50" class="i">+            ),
</a><a href="#h21-4-51" id="h21-4-51" class="i">+        ),
</a><a href="#h21-4-52" id="h21-4-52" class="i">+        Some(
</a><a href="#h21-4-53" id="h21-4-53" class="i">+            (
</a><a href="#h21-4-54" id="h21-4-54" class="i">+                None,
</a><a href="#h21-4-55" id="h21-4-55" class="i">+                &quot;some id&quot;,
</a><a href="#h21-4-56" id="h21-4-56" class="i">+            ),
</a><a href="#h21-4-57" id="h21-4-57" class="i">+        ),
</a><a href="#h21-4-58" id="h21-4-58" class="i">+    ],
</a><a href="#h21-4-59" id="h21-4-59" class="i">+}
</a> 
<b>diff --git a/<a id="h22" href="../file/tests/sql/query/as_duplicate.html">tests/sql/query/as_duplicate</a> b/<a href="../file/tests/sql/query/as_duplicate.html">tests/sql/query/as_duplicate</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -39,9 +39,21 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h22-0-3" id="h22-0-3" class="d">-Plan: Select(
</a><a href="#h22-0-4" id="h22-0-4" class="d">-    Projection {
</a><a href="#h22-0-5" id="h22-0-5" class="i">+Plan: Select {
</a><a href="#h22-0-6" id="h22-0-6" class="i">+    root: Projection {
</a>         source: Nothing,
<a href="#h22-0-8" id="h22-0-8" class="i">+        expressions: [
</a><a href="#h22-0-9" id="h22-0-9" class="i">+            Constant(
</a><a href="#h22-0-10" id="h22-0-10" class="i">+                Integer(
</a><a href="#h22-0-11" id="h22-0-11" class="i">+                    1,
</a><a href="#h22-0-12" id="h22-0-12" class="i">+                ),
</a><a href="#h22-0-13" id="h22-0-13" class="i">+            ),
</a><a href="#h22-0-14" id="h22-0-14" class="i">+            Constant(
</a><a href="#h22-0-15" id="h22-0-15" class="i">+                Integer(
</a><a href="#h22-0-16" id="h22-0-16" class="i">+                    2,
</a><a href="#h22-0-17" id="h22-0-17" class="i">+                ),
</a><a href="#h22-0-18" id="h22-0-18" class="i">+            ),
</a><a href="#h22-0-19" id="h22-0-19" class="i">+        ],
</a>         labels: [
             Some(
                 (
<a href="#h22-1" id="h22-1" class="h">@@ -56,6 +68,26 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h22-1-3" id="h22-1-3" class="i">+    },
</a><a href="#h22-1-4" id="h22-1-4" class="i">+    labels: [
</a><a href="#h22-1-5" id="h22-1-5" class="i">+        Some(
</a><a href="#h22-1-6" id="h22-1-6" class="i">+            (
</a><a href="#h22-1-7" id="h22-1-7" class="i">+                None,
</a><a href="#h22-1-8" id="h22-1-8" class="i">+                &quot;a&quot;,
</a><a href="#h22-1-9" id="h22-1-9" class="i">+            ),
</a><a href="#h22-1-10" id="h22-1-10" class="i">+        ),
</a><a href="#h22-1-11" id="h22-1-11" class="i">+        Some(
</a><a href="#h22-1-12" id="h22-1-12" class="i">+            (
</a><a href="#h22-1-13" id="h22-1-13" class="i">+                None,
</a><a href="#h22-1-14" id="h22-1-14" class="i">+                &quot;a&quot;,
</a><a href="#h22-1-15" id="h22-1-15" class="i">+            ),
</a><a href="#h22-1-16" id="h22-1-16" class="i">+        ),
</a><a href="#h22-1-17" id="h22-1-17" class="i">+    ],
</a><a href="#h22-1-18" id="h22-1-18" class="i">+}
</a><a href="#h22-1-19" id="h22-1-19" class="i">+
</a><a href="#h22-1-20" id="h22-1-20" class="i">+Optimized plan: Select {
</a><a href="#h22-1-21" id="h22-1-21" class="i">+    root: Projection {
</a><a href="#h22-1-22" id="h22-1-22" class="i">+        source: Nothing,
</a>         expressions: [
             Constant(
                 Integer(
<a href="#h22-2" id="h22-2" class="h">@@ -68,12 +100,6 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h22-2-3" id="h22-2-3" class="d">-    },
</a><a href="#h22-2-4" id="h22-2-4" class="d">-)
</a><a href="#h22-2-5" id="h22-2-5" class="d">-
</a><a href="#h22-2-6" id="h22-2-6" class="d">-Optimized plan: Select(
</a><a href="#h22-2-7" id="h22-2-7" class="d">-    Projection {
</a><a href="#h22-2-8" id="h22-2-8" class="d">-        source: Nothing,
</a>         labels: [
             Some(
                 (
<a href="#h22-3" id="h22-3" class="h">@@ -88,18 +114,20 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h22-3-3" id="h22-3-3" class="d">-        expressions: [
</a><a href="#h22-3-4" id="h22-3-4" class="d">-            Constant(
</a><a href="#h22-3-5" id="h22-3-5" class="d">-                Integer(
</a><a href="#h22-3-6" id="h22-3-6" class="d">-                    1,
</a><a href="#h22-3-7" id="h22-3-7" class="d">-                ),
</a><a href="#h22-3-8" id="h22-3-8" class="i">+    },
</a><a href="#h22-3-9" id="h22-3-9" class="i">+    labels: [
</a><a href="#h22-3-10" id="h22-3-10" class="i">+        Some(
</a><a href="#h22-3-11" id="h22-3-11" class="i">+            (
</a><a href="#h22-3-12" id="h22-3-12" class="i">+                None,
</a><a href="#h22-3-13" id="h22-3-13" class="i">+                &quot;a&quot;,
</a>             ),
<a href="#h22-3-15" id="h22-3-15" class="d">-            Constant(
</a><a href="#h22-3-16" id="h22-3-16" class="d">-                Integer(
</a><a href="#h22-3-17" id="h22-3-17" class="d">-                    2,
</a><a href="#h22-3-18" id="h22-3-18" class="d">-                ),
</a><a href="#h22-3-19" id="h22-3-19" class="i">+        ),
</a><a href="#h22-3-20" id="h22-3-20" class="i">+        Some(
</a><a href="#h22-3-21" id="h22-3-21" class="i">+            (
</a><a href="#h22-3-22" id="h22-3-22" class="i">+                None,
</a><a href="#h22-3-23" id="h22-3-23" class="i">+                &quot;a&quot;,
</a>             ),
<a href="#h22-3-25" id="h22-3-25" class="d">-        ],
</a><a href="#h22-3-26" id="h22-3-26" class="d">-    },
</a><a href="#h22-3-27" id="h22-3-27" class="d">-)
</a><a href="#h22-3-28" id="h22-3-28" class="i">+        ),
</a><a href="#h22-3-29" id="h22-3-29" class="i">+    ],
</a><a href="#h22-3-30" id="h22-3-30" class="i">+}
</a> 
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a> b/<a href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -77,8 +77,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h23-0-3" id="h23-0-3" class="d">-Plan: Select(
</a><a href="#h23-0-4" id="h23-0-4" class="d">-    Projection {
</a><a href="#h23-0-5" id="h23-0-5" class="i">+Plan: Select {
</a><a href="#h23-0-6" id="h23-0-6" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h23-1" id="h23-1" class="h">@@ -157,18 +157,9 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h23-1-3" id="h23-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h23-1-5" id="h23-1-5" class="i">+            alias: None,
</a>         },
<a href="#h23-1-7" id="h23-1-7" class="d">-        labels: [
</a><a href="#h23-1-8" id="h23-1-8" class="d">-            None,
</a><a href="#h23-1-9" id="h23-1-9" class="d">-            Some(
</a><a href="#h23-1-10" id="h23-1-10" class="d">-                (
</a><a href="#h23-1-11" id="h23-1-11" class="d">-                    None,
</a><a href="#h23-1-12" id="h23-1-12" class="d">-                    &quot;age&quot;,
</a><a href="#h23-1-13" id="h23-1-13" class="d">-                ),
</a><a href="#h23-1-14" id="h23-1-14" class="d">-            ),
</a><a href="#h23-1-15" id="h23-1-15" class="d">-        ],
</a>         expressions: [
             Add(
                 Constant(
<a href="#h23-2" id="h23-2" class="h">@@ -206,11 +197,29 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h23-2-3" id="h23-2-3" class="i">+        labels: [
</a><a href="#h23-2-4" id="h23-2-4" class="i">+            None,
</a><a href="#h23-2-5" id="h23-2-5" class="i">+            Some(
</a><a href="#h23-2-6" id="h23-2-6" class="i">+                (
</a><a href="#h23-2-7" id="h23-2-7" class="i">+                    None,
</a><a href="#h23-2-8" id="h23-2-8" class="i">+                    &quot;age&quot;,
</a><a href="#h23-2-9" id="h23-2-9" class="i">+                ),
</a><a href="#h23-2-10" id="h23-2-10" class="i">+            ),
</a><a href="#h23-2-11" id="h23-2-11" class="i">+        ],
</a>     },
<a href="#h23-2-13" id="h23-2-13" class="d">-)
</a><a href="#h23-2-14" id="h23-2-14" class="i">+    labels: [
</a><a href="#h23-2-15" id="h23-2-15" class="i">+        None,
</a><a href="#h23-2-16" id="h23-2-16" class="i">+        Some(
</a><a href="#h23-2-17" id="h23-2-17" class="i">+            (
</a><a href="#h23-2-18" id="h23-2-18" class="i">+                None,
</a><a href="#h23-2-19" id="h23-2-19" class="i">+                &quot;age&quot;,
</a><a href="#h23-2-20" id="h23-2-20" class="i">+            ),
</a><a href="#h23-2-21" id="h23-2-21" class="i">+        ),
</a><a href="#h23-2-22" id="h23-2-22" class="i">+    ],
</a><a href="#h23-2-23" id="h23-2-23" class="i">+}
</a> 
<a href="#h23-2-25" id="h23-2-25" class="d">-Optimized plan: Select(
</a><a href="#h23-2-26" id="h23-2-26" class="d">-    Projection {
</a><a href="#h23-2-27" id="h23-2-27" class="i">+Optimized plan: Select {
</a><a href="#h23-2-28" id="h23-2-28" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h23-3" id="h23-3" class="h">@@ -289,18 +298,9 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h23-3-3" id="h23-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h23-3-5" id="h23-3-5" class="i">+            alias: None,
</a>         },
<a href="#h23-3-7" id="h23-3-7" class="d">-        labels: [
</a><a href="#h23-3-8" id="h23-3-8" class="d">-            None,
</a><a href="#h23-3-9" id="h23-3-9" class="d">-            Some(
</a><a href="#h23-3-10" id="h23-3-10" class="d">-                (
</a><a href="#h23-3-11" id="h23-3-11" class="d">-                    None,
</a><a href="#h23-3-12" id="h23-3-12" class="d">-                    &quot;age&quot;,
</a><a href="#h23-3-13" id="h23-3-13" class="d">-                ),
</a><a href="#h23-3-14" id="h23-3-14" class="d">-            ),
</a><a href="#h23-3-15" id="h23-3-15" class="d">-        ],
</a>         expressions: [
             Constant(
                 Integer(
<a href="#h23-4" id="h23-4" class="h">@@ -324,6 +324,24 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h23-4-3" id="h23-4-3" class="i">+        labels: [
</a><a href="#h23-4-4" id="h23-4-4" class="i">+            None,
</a><a href="#h23-4-5" id="h23-4-5" class="i">+            Some(
</a><a href="#h23-4-6" id="h23-4-6" class="i">+                (
</a><a href="#h23-4-7" id="h23-4-7" class="i">+                    None,
</a><a href="#h23-4-8" id="h23-4-8" class="i">+                    &quot;age&quot;,
</a><a href="#h23-4-9" id="h23-4-9" class="i">+                ),
</a><a href="#h23-4-10" id="h23-4-10" class="i">+            ),
</a><a href="#h23-4-11" id="h23-4-11" class="i">+        ],
</a>     },
<a href="#h23-4-13" id="h23-4-13" class="d">-)
</a><a href="#h23-4-14" id="h23-4-14" class="i">+    labels: [
</a><a href="#h23-4-15" id="h23-4-15" class="i">+        None,
</a><a href="#h23-4-16" id="h23-4-16" class="i">+        Some(
</a><a href="#h23-4-17" id="h23-4-17" class="i">+            (
</a><a href="#h23-4-18" id="h23-4-18" class="i">+                None,
</a><a href="#h23-4-19" id="h23-4-19" class="i">+                &quot;age&quot;,
</a><a href="#h23-4-20" id="h23-4-20" class="i">+            ),
</a><a href="#h23-4-21" id="h23-4-21" class="i">+        ),
</a><a href="#h23-4-22" id="h23-4-22" class="i">+    ],
</a><a href="#h23-4-23" id="h23-4-23" class="i">+}
</a> 
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/expr_static.html">tests/sql/query/expr_static</a> b/<a href="../file/tests/sql/query/expr_static.html">tests/sql/query/expr_static</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -64,18 +64,9 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h24-0-3" id="h24-0-3" class="d">-Plan: Select(
</a><a href="#h24-0-4" id="h24-0-4" class="d">-    Projection {
</a><a href="#h24-0-5" id="h24-0-5" class="i">+Plan: Select {
</a><a href="#h24-0-6" id="h24-0-6" class="i">+    root: Projection {
</a>         source: Nothing,
<a href="#h24-0-8" id="h24-0-8" class="d">-        labels: [
</a><a href="#h24-0-9" id="h24-0-9" class="d">-            None,
</a><a href="#h24-0-10" id="h24-0-10" class="d">-            Some(
</a><a href="#h24-0-11" id="h24-0-11" class="d">-                (
</a><a href="#h24-0-12" id="h24-0-12" class="d">-                    None,
</a><a href="#h24-0-13" id="h24-0-13" class="d">-                    &quot;nope&quot;,
</a><a href="#h24-0-14" id="h24-0-14" class="d">-                ),
</a><a href="#h24-0-15" id="h24-0-15" class="d">-            ),
</a><a href="#h24-0-16" id="h24-0-16" class="d">-        ],
</a>         expressions: [
             Add(
                 Constant(
<a href="#h24-1" id="h24-1" class="h">@@ -109,12 +100,6 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h24-1-3" id="h24-1-3" class="d">-    },
</a><a href="#h24-1-4" id="h24-1-4" class="d">-)
</a><a href="#h24-1-5" id="h24-1-5" class="d">-
</a><a href="#h24-1-6" id="h24-1-6" class="d">-Optimized plan: Select(
</a><a href="#h24-1-7" id="h24-1-7" class="d">-    Projection {
</a><a href="#h24-1-8" id="h24-1-8" class="d">-        source: Nothing,
</a>         labels: [
             None,
             Some(
<a href="#h24-2" id="h24-2" class="h">@@ -124,6 +109,21 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h24-2-3" id="h24-2-3" class="i">+    },
</a><a href="#h24-2-4" id="h24-2-4" class="i">+    labels: [
</a><a href="#h24-2-5" id="h24-2-5" class="i">+        None,
</a><a href="#h24-2-6" id="h24-2-6" class="i">+        Some(
</a><a href="#h24-2-7" id="h24-2-7" class="i">+            (
</a><a href="#h24-2-8" id="h24-2-8" class="i">+                None,
</a><a href="#h24-2-9" id="h24-2-9" class="i">+                &quot;nope&quot;,
</a><a href="#h24-2-10" id="h24-2-10" class="i">+            ),
</a><a href="#h24-2-11" id="h24-2-11" class="i">+        ),
</a><a href="#h24-2-12" id="h24-2-12" class="i">+    ],
</a><a href="#h24-2-13" id="h24-2-13" class="i">+}
</a><a href="#h24-2-14" id="h24-2-14" class="i">+
</a><a href="#h24-2-15" id="h24-2-15" class="i">+Optimized plan: Select {
</a><a href="#h24-2-16" id="h24-2-16" class="i">+    root: Projection {
</a><a href="#h24-2-17" id="h24-2-17" class="i">+        source: Nothing,
</a>         expressions: [
             Constant(
                 Integer(
<a href="#h24-3" id="h24-3" class="h">@@ -136,6 +136,24 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h24-3-3" id="h24-3-3" class="i">+        labels: [
</a><a href="#h24-3-4" id="h24-3-4" class="i">+            None,
</a><a href="#h24-3-5" id="h24-3-5" class="i">+            Some(
</a><a href="#h24-3-6" id="h24-3-6" class="i">+                (
</a><a href="#h24-3-7" id="h24-3-7" class="i">+                    None,
</a><a href="#h24-3-8" id="h24-3-8" class="i">+                    &quot;nope&quot;,
</a><a href="#h24-3-9" id="h24-3-9" class="i">+                ),
</a><a href="#h24-3-10" id="h24-3-10" class="i">+            ),
</a><a href="#h24-3-11" id="h24-3-11" class="i">+        ],
</a>     },
<a href="#h24-3-13" id="h24-3-13" class="d">-)
</a><a href="#h24-3-14" id="h24-3-14" class="i">+    labels: [
</a><a href="#h24-3-15" id="h24-3-15" class="i">+        None,
</a><a href="#h24-3-16" id="h24-3-16" class="i">+        Some(
</a><a href="#h24-3-17" id="h24-3-17" class="i">+            (
</a><a href="#h24-3-18" id="h24-3-18" class="i">+                None,
</a><a href="#h24-3-19" id="h24-3-19" class="i">+                &quot;nope&quot;,
</a><a href="#h24-3-20" id="h24-3-20" class="i">+            ),
</a><a href="#h24-3-21" id="h24-3-21" class="i">+        ),
</a><a href="#h24-3-22" id="h24-3-22" class="i">+    ],
</a><a href="#h24-3-23" id="h24-3-23" class="i">+}
</a> 
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a> b/<a href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -81,8 +81,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h25-0-3" id="h25-0-3" class="d">-Plan: Select(
</a><a href="#h25-0-4" id="h25-0-4" class="d">-    Projection {
</a><a href="#h25-0-5" id="h25-0-5" class="i">+Plan: Select {
</a><a href="#h25-0-6" id="h25-0-6" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h25-1" id="h25-1" class="h">@@ -162,10 +162,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h25-1-3" id="h25-1-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h25-1-7" id="h25-1-7" class="d">-                filter: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h25-2" id="h25-2" class="h">@@ -193,18 +193,14 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h25-2-3" id="h25-2-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h25-2-7" id="h25-2-7" class="d">-                filter: None,
</a>             },
             predicate: None,
             outer: false,
         },
<a href="#h25-2-12" id="h25-2-12" class="d">-        labels: [
</a><a href="#h25-2-13" id="h25-2-13" class="d">-            None,
</a><a href="#h25-2-14" id="h25-2-14" class="d">-            None,
</a><a href="#h25-2-15" id="h25-2-15" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h25-3" id="h25-3" class="h">@@ -229,11 +225,33 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h25-3-3" id="h25-3-3" class="i">+        labels: [
</a><a href="#h25-3-4" id="h25-3-4" class="i">+            None,
</a><a href="#h25-3-5" id="h25-3-5" class="i">+            None,
</a><a href="#h25-3-6" id="h25-3-6" class="i">+        ],
</a>     },
<a href="#h25-3-8" id="h25-3-8" class="d">-)
</a><a href="#h25-3-9" id="h25-3-9" class="i">+    labels: [
</a><a href="#h25-3-10" id="h25-3-10" class="i">+        Some(
</a><a href="#h25-3-11" id="h25-3-11" class="i">+            (
</a><a href="#h25-3-12" id="h25-3-12" class="i">+                Some(
</a><a href="#h25-3-13" id="h25-3-13" class="i">+                    &quot;m&quot;,
</a><a href="#h25-3-14" id="h25-3-14" class="i">+                ),
</a><a href="#h25-3-15" id="h25-3-15" class="i">+                &quot;id&quot;,
</a><a href="#h25-3-16" id="h25-3-16" class="i">+            ),
</a><a href="#h25-3-17" id="h25-3-17" class="i">+        ),
</a><a href="#h25-3-18" id="h25-3-18" class="i">+        Some(
</a><a href="#h25-3-19" id="h25-3-19" class="i">+            (
</a><a href="#h25-3-20" id="h25-3-20" class="i">+                Some(
</a><a href="#h25-3-21" id="h25-3-21" class="i">+                    &quot;g&quot;,
</a><a href="#h25-3-22" id="h25-3-22" class="i">+                ),
</a><a href="#h25-3-23" id="h25-3-23" class="i">+                &quot;id&quot;,
</a><a href="#h25-3-24" id="h25-3-24" class="i">+            ),
</a><a href="#h25-3-25" id="h25-3-25" class="i">+        ),
</a><a href="#h25-3-26" id="h25-3-26" class="i">+    ],
</a><a href="#h25-3-27" id="h25-3-27" class="i">+}
</a> 
<a href="#h25-3-29" id="h25-3-29" class="d">-Optimized plan: Select(
</a><a href="#h25-3-30" id="h25-3-30" class="d">-    Projection {
</a><a href="#h25-3-31" id="h25-3-31" class="i">+Optimized plan: Select {
</a><a href="#h25-3-32" id="h25-3-32" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h25-4" id="h25-4" class="h">@@ -313,10 +331,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h25-4-3" id="h25-4-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h25-4-7" id="h25-4-7" class="d">-                filter: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h25-5" id="h25-5" class="h">@@ -344,18 +362,14 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h25-5-3" id="h25-5-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h25-5-7" id="h25-5-7" class="d">-                filter: None,
</a>             },
             predicate: None,
             outer: false,
         },
<a href="#h25-5-12" id="h25-5-12" class="d">-        labels: [
</a><a href="#h25-5-13" id="h25-5-13" class="d">-            None,
</a><a href="#h25-5-14" id="h25-5-14" class="d">-            None,
</a><a href="#h25-5-15" id="h25-5-15" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h25-6" id="h25-6" class="h">@@ -380,6 +394,28 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h25-6-3" id="h25-6-3" class="i">+        labels: [
</a><a href="#h25-6-4" id="h25-6-4" class="i">+            None,
</a><a href="#h25-6-5" id="h25-6-5" class="i">+            None,
</a><a href="#h25-6-6" id="h25-6-6" class="i">+        ],
</a>     },
<a href="#h25-6-8" id="h25-6-8" class="d">-)
</a><a href="#h25-6-9" id="h25-6-9" class="i">+    labels: [
</a><a href="#h25-6-10" id="h25-6-10" class="i">+        Some(
</a><a href="#h25-6-11" id="h25-6-11" class="i">+            (
</a><a href="#h25-6-12" id="h25-6-12" class="i">+                Some(
</a><a href="#h25-6-13" id="h25-6-13" class="i">+                    &quot;m&quot;,
</a><a href="#h25-6-14" id="h25-6-14" class="i">+                ),
</a><a href="#h25-6-15" id="h25-6-15" class="i">+                &quot;id&quot;,
</a><a href="#h25-6-16" id="h25-6-16" class="i">+            ),
</a><a href="#h25-6-17" id="h25-6-17" class="i">+        ),
</a><a href="#h25-6-18" id="h25-6-18" class="i">+        Some(
</a><a href="#h25-6-19" id="h25-6-19" class="i">+            (
</a><a href="#h25-6-20" id="h25-6-20" class="i">+                Some(
</a><a href="#h25-6-21" id="h25-6-21" class="i">+                    &quot;g&quot;,
</a><a href="#h25-6-22" id="h25-6-22" class="i">+                ),
</a><a href="#h25-6-23" id="h25-6-23" class="i">+                &quot;id&quot;,
</a><a href="#h25-6-24" id="h25-6-24" class="i">+            ),
</a><a href="#h25-6-25" id="h25-6-25" class="i">+        ),
</a><a href="#h25-6-26" id="h25-6-26" class="i">+    ],
</a><a href="#h25-6-27" id="h25-6-27" class="i">+}
</a> 
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a> b/<a href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -47,8 +47,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h26-0-3" id="h26-0-3" class="d">-Plan: Select(
</a><a href="#h26-0-4" id="h26-0-4" class="d">-    Projection {
</a><a href="#h26-0-5" id="h26-0-5" class="i">+Plan: Select {
</a><a href="#h26-0-6" id="h26-0-6" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h26-1" id="h26-1" class="h">@@ -127,13 +127,9 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h26-1-3" id="h26-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h26-1-5" id="h26-1-5" class="i">+            alias: None,
</a>         },
<a href="#h26-1-7" id="h26-1-7" class="d">-        labels: [
</a><a href="#h26-1-8" id="h26-1-8" class="d">-            None,
</a><a href="#h26-1-9" id="h26-1-9" class="d">-            None,
</a><a href="#h26-1-10" id="h26-1-10" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h26-2" id="h26-2" class="h">@@ -154,11 +150,33 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h26-2-3" id="h26-2-3" class="i">+        labels: [
</a><a href="#h26-2-4" id="h26-2-4" class="i">+            None,
</a><a href="#h26-2-5" id="h26-2-5" class="i">+            None,
</a><a href="#h26-2-6" id="h26-2-6" class="i">+        ],
</a>     },
<a href="#h26-2-8" id="h26-2-8" class="d">-)
</a><a href="#h26-2-9" id="h26-2-9" class="i">+    labels: [
</a><a href="#h26-2-10" id="h26-2-10" class="i">+        Some(
</a><a href="#h26-2-11" id="h26-2-11" class="i">+            (
</a><a href="#h26-2-12" id="h26-2-12" class="i">+                Some(
</a><a href="#h26-2-13" id="h26-2-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h26-2-14" id="h26-2-14" class="i">+                ),
</a><a href="#h26-2-15" id="h26-2-15" class="i">+                &quot;id&quot;,
</a><a href="#h26-2-16" id="h26-2-16" class="i">+            ),
</a><a href="#h26-2-17" id="h26-2-17" class="i">+        ),
</a><a href="#h26-2-18" id="h26-2-18" class="i">+        Some(
</a><a href="#h26-2-19" id="h26-2-19" class="i">+            (
</a><a href="#h26-2-20" id="h26-2-20" class="i">+                Some(
</a><a href="#h26-2-21" id="h26-2-21" class="i">+                    &quot;movies&quot;,
</a><a href="#h26-2-22" id="h26-2-22" class="i">+                ),
</a><a href="#h26-2-23" id="h26-2-23" class="i">+                &quot;title&quot;,
</a><a href="#h26-2-24" id="h26-2-24" class="i">+            ),
</a><a href="#h26-2-25" id="h26-2-25" class="i">+        ),
</a><a href="#h26-2-26" id="h26-2-26" class="i">+    ],
</a><a href="#h26-2-27" id="h26-2-27" class="i">+}
</a> 
<a href="#h26-2-29" id="h26-2-29" class="d">-Optimized plan: Select(
</a><a href="#h26-2-30" id="h26-2-30" class="d">-    Projection {
</a><a href="#h26-2-31" id="h26-2-31" class="i">+Optimized plan: Select {
</a><a href="#h26-2-32" id="h26-2-32" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h26-3" id="h26-3" class="h">@@ -237,13 +255,9 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h26-3-3" id="h26-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h26-3-5" id="h26-3-5" class="i">+            alias: None,
</a>         },
<a href="#h26-3-7" id="h26-3-7" class="d">-        labels: [
</a><a href="#h26-3-8" id="h26-3-8" class="d">-            None,
</a><a href="#h26-3-9" id="h26-3-9" class="d">-            None,
</a><a href="#h26-3-10" id="h26-3-10" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h26-4" id="h26-4" class="h">@@ -264,6 +278,28 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h26-4-3" id="h26-4-3" class="i">+        labels: [
</a><a href="#h26-4-4" id="h26-4-4" class="i">+            None,
</a><a href="#h26-4-5" id="h26-4-5" class="i">+            None,
</a><a href="#h26-4-6" id="h26-4-6" class="i">+        ],
</a>     },
<a href="#h26-4-8" id="h26-4-8" class="d">-)
</a><a href="#h26-4-9" id="h26-4-9" class="i">+    labels: [
</a><a href="#h26-4-10" id="h26-4-10" class="i">+        Some(
</a><a href="#h26-4-11" id="h26-4-11" class="i">+            (
</a><a href="#h26-4-12" id="h26-4-12" class="i">+                Some(
</a><a href="#h26-4-13" id="h26-4-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h26-4-14" id="h26-4-14" class="i">+                ),
</a><a href="#h26-4-15" id="h26-4-15" class="i">+                &quot;id&quot;,
</a><a href="#h26-4-16" id="h26-4-16" class="i">+            ),
</a><a href="#h26-4-17" id="h26-4-17" class="i">+        ),
</a><a href="#h26-4-18" id="h26-4-18" class="i">+        Some(
</a><a href="#h26-4-19" id="h26-4-19" class="i">+            (
</a><a href="#h26-4-20" id="h26-4-20" class="i">+                Some(
</a><a href="#h26-4-21" id="h26-4-21" class="i">+                    &quot;movies&quot;,
</a><a href="#h26-4-22" id="h26-4-22" class="i">+                ),
</a><a href="#h26-4-23" id="h26-4-23" class="i">+                &quot;title&quot;,
</a><a href="#h26-4-24" id="h26-4-24" class="i">+            ),
</a><a href="#h26-4-25" id="h26-4-25" class="i">+        ),
</a><a href="#h26-4-26" id="h26-4-26" class="i">+    ],
</a><a href="#h26-4-27" id="h26-4-27" class="i">+}
</a> 
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a> b/<a href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -42,8 +42,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h27-0-3" id="h27-0-3" class="d">-Plan: Select(
</a><a href="#h27-0-4" id="h27-0-4" class="d">-    Projection {
</a><a href="#h27-0-5" id="h27-0-5" class="i">+Plan: Select {
</a><a href="#h27-0-6" id="h27-0-6" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h27-1" id="h27-1" class="h">@@ -122,12 +122,9 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h27-1-3" id="h27-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h27-1-5" id="h27-1-5" class="i">+            alias: None,
</a>         },
<a href="#h27-1-7" id="h27-1-7" class="d">-        labels: [
</a><a href="#h27-1-8" id="h27-1-8" class="d">-            None,
</a><a href="#h27-1-9" id="h27-1-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h27-2" id="h27-2" class="h">@@ -141,11 +138,24 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h27-2-3" id="h27-2-3" class="i">+        labels: [
</a><a href="#h27-2-4" id="h27-2-4" class="i">+            None,
</a><a href="#h27-2-5" id="h27-2-5" class="i">+        ],
</a>     },
<a href="#h27-2-7" id="h27-2-7" class="d">-)
</a><a href="#h27-2-8" id="h27-2-8" class="i">+    labels: [
</a><a href="#h27-2-9" id="h27-2-9" class="i">+        Some(
</a><a href="#h27-2-10" id="h27-2-10" class="i">+            (
</a><a href="#h27-2-11" id="h27-2-11" class="i">+                Some(
</a><a href="#h27-2-12" id="h27-2-12" class="i">+                    &quot;movies&quot;,
</a><a href="#h27-2-13" id="h27-2-13" class="i">+                ),
</a><a href="#h27-2-14" id="h27-2-14" class="i">+                &quot;id&quot;,
</a><a href="#h27-2-15" id="h27-2-15" class="i">+            ),
</a><a href="#h27-2-16" id="h27-2-16" class="i">+        ),
</a><a href="#h27-2-17" id="h27-2-17" class="i">+    ],
</a><a href="#h27-2-18" id="h27-2-18" class="i">+}
</a> 
<a href="#h27-2-20" id="h27-2-20" class="d">-Optimized plan: Select(
</a><a href="#h27-2-21" id="h27-2-21" class="d">-    Projection {
</a><a href="#h27-2-22" id="h27-2-22" class="i">+Optimized plan: Select {
</a><a href="#h27-2-23" id="h27-2-23" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h27-3" id="h27-3" class="h">@@ -224,12 +234,9 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h27-3-3" id="h27-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h27-3-5" id="h27-3-5" class="i">+            alias: None,
</a>         },
<a href="#h27-3-7" id="h27-3-7" class="d">-        labels: [
</a><a href="#h27-3-8" id="h27-3-8" class="d">-            None,
</a><a href="#h27-3-9" id="h27-3-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h27-4" id="h27-4" class="h">@@ -243,6 +250,19 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h27-4-3" id="h27-4-3" class="i">+        labels: [
</a><a href="#h27-4-4" id="h27-4-4" class="i">+            None,
</a><a href="#h27-4-5" id="h27-4-5" class="i">+        ],
</a>     },
<a href="#h27-4-7" id="h27-4-7" class="d">-)
</a><a href="#h27-4-8" id="h27-4-8" class="i">+    labels: [
</a><a href="#h27-4-9" id="h27-4-9" class="i">+        Some(
</a><a href="#h27-4-10" id="h27-4-10" class="i">+            (
</a><a href="#h27-4-11" id="h27-4-11" class="i">+                Some(
</a><a href="#h27-4-12" id="h27-4-12" class="i">+                    &quot;movies&quot;,
</a><a href="#h27-4-13" id="h27-4-13" class="i">+                ),
</a><a href="#h27-4-14" id="h27-4-14" class="i">+                &quot;id&quot;,
</a><a href="#h27-4-15" id="h27-4-15" class="i">+            ),
</a><a href="#h27-4-16" id="h27-4-16" class="i">+        ),
</a><a href="#h27-4-17" id="h27-4-17" class="i">+    ],
</a><a href="#h27-4-18" id="h27-4-18" class="i">+}
</a> 
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a> b/<a href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -77,8 +77,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h28-0-3" id="h28-0-3" class="d">-Plan: Select(
</a><a href="#h28-0-4" id="h28-0-4" class="d">-    Projection {
</a><a href="#h28-0-5" id="h28-0-5" class="i">+Plan: Select {
</a><a href="#h28-0-6" id="h28-0-6" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h28-1" id="h28-1" class="h">@@ -158,8 +158,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h28-1-3" id="h28-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h28-1-5" id="h28-1-5" class="i">+                alias: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h28-2" id="h28-2" class="h">@@ -187,16 +187,12 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h28-2-3" id="h28-2-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h28-2-5" id="h28-2-5" class="i">+                alias: None,
</a>             },
             predicate: None,
             outer: false,
         },
<a href="#h28-2-10" id="h28-2-10" class="d">-        labels: [
</a><a href="#h28-2-11" id="h28-2-11" class="d">-            None,
</a><a href="#h28-2-12" id="h28-2-12" class="d">-            None,
</a><a href="#h28-2-13" id="h28-2-13" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h28-3" id="h28-3" class="h">@@ -221,11 +217,33 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h28-3-3" id="h28-3-3" class="i">+        labels: [
</a><a href="#h28-3-4" id="h28-3-4" class="i">+            None,
</a><a href="#h28-3-5" id="h28-3-5" class="i">+            None,
</a><a href="#h28-3-6" id="h28-3-6" class="i">+        ],
</a>     },
<a href="#h28-3-8" id="h28-3-8" class="d">-)
</a><a href="#h28-3-9" id="h28-3-9" class="i">+    labels: [
</a><a href="#h28-3-10" id="h28-3-10" class="i">+        Some(
</a><a href="#h28-3-11" id="h28-3-11" class="i">+            (
</a><a href="#h28-3-12" id="h28-3-12" class="i">+                Some(
</a><a href="#h28-3-13" id="h28-3-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h28-3-14" id="h28-3-14" class="i">+                ),
</a><a href="#h28-3-15" id="h28-3-15" class="i">+                &quot;id&quot;,
</a><a href="#h28-3-16" id="h28-3-16" class="i">+            ),
</a><a href="#h28-3-17" id="h28-3-17" class="i">+        ),
</a><a href="#h28-3-18" id="h28-3-18" class="i">+        Some(
</a><a href="#h28-3-19" id="h28-3-19" class="i">+            (
</a><a href="#h28-3-20" id="h28-3-20" class="i">+                Some(
</a><a href="#h28-3-21" id="h28-3-21" class="i">+                    &quot;genres&quot;,
</a><a href="#h28-3-22" id="h28-3-22" class="i">+                ),
</a><a href="#h28-3-23" id="h28-3-23" class="i">+                &quot;id&quot;,
</a><a href="#h28-3-24" id="h28-3-24" class="i">+            ),
</a><a href="#h28-3-25" id="h28-3-25" class="i">+        ),
</a><a href="#h28-3-26" id="h28-3-26" class="i">+    ],
</a><a href="#h28-3-27" id="h28-3-27" class="i">+}
</a> 
<a href="#h28-3-29" id="h28-3-29" class="d">-Optimized plan: Select(
</a><a href="#h28-3-30" id="h28-3-30" class="d">-    Projection {
</a><a href="#h28-3-31" id="h28-3-31" class="i">+Optimized plan: Select {
</a><a href="#h28-3-32" id="h28-3-32" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h28-4" id="h28-4" class="h">@@ -305,8 +323,8 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h28-4-3" id="h28-4-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h28-4-5" id="h28-4-5" class="i">+                alias: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h28-5" id="h28-5" class="h">@@ -334,16 +352,12 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h28-5-3" id="h28-5-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h28-5-5" id="h28-5-5" class="i">+                alias: None,
</a>             },
             predicate: None,
             outer: false,
         },
<a href="#h28-5-10" id="h28-5-10" class="d">-        labels: [
</a><a href="#h28-5-11" id="h28-5-11" class="d">-            None,
</a><a href="#h28-5-12" id="h28-5-12" class="d">-            None,
</a><a href="#h28-5-13" id="h28-5-13" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h28-6" id="h28-6" class="h">@@ -368,6 +382,28 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h28-6-3" id="h28-6-3" class="i">+        labels: [
</a><a href="#h28-6-4" id="h28-6-4" class="i">+            None,
</a><a href="#h28-6-5" id="h28-6-5" class="i">+            None,
</a><a href="#h28-6-6" id="h28-6-6" class="i">+        ],
</a>     },
<a href="#h28-6-8" id="h28-6-8" class="d">-)
</a><a href="#h28-6-9" id="h28-6-9" class="i">+    labels: [
</a><a href="#h28-6-10" id="h28-6-10" class="i">+        Some(
</a><a href="#h28-6-11" id="h28-6-11" class="i">+            (
</a><a href="#h28-6-12" id="h28-6-12" class="i">+                Some(
</a><a href="#h28-6-13" id="h28-6-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h28-6-14" id="h28-6-14" class="i">+                ),
</a><a href="#h28-6-15" id="h28-6-15" class="i">+                &quot;id&quot;,
</a><a href="#h28-6-16" id="h28-6-16" class="i">+            ),
</a><a href="#h28-6-17" id="h28-6-17" class="i">+        ),
</a><a href="#h28-6-18" id="h28-6-18" class="i">+        Some(
</a><a href="#h28-6-19" id="h28-6-19" class="i">+            (
</a><a href="#h28-6-20" id="h28-6-20" class="i">+                Some(
</a><a href="#h28-6-21" id="h28-6-21" class="i">+                    &quot;genres&quot;,
</a><a href="#h28-6-22" id="h28-6-22" class="i">+                ),
</a><a href="#h28-6-23" id="h28-6-23" class="i">+                &quot;id&quot;,
</a><a href="#h28-6-24" id="h28-6-24" class="i">+            ),
</a><a href="#h28-6-25" id="h28-6-25" class="i">+        ),
</a><a href="#h28-6-26" id="h28-6-26" class="i">+    ],
</a><a href="#h28-6-27" id="h28-6-27" class="i">+}
</a> 
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a> b/<a href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -40,8 +40,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h29-0-3" id="h29-0-3" class="d">-Plan: Select(
</a><a href="#h29-0-4" id="h29-0-4" class="d">-    Projection {
</a><a href="#h29-0-5" id="h29-0-5" class="i">+Plan: Select {
</a><a href="#h29-0-6" id="h29-0-6" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h29-1" id="h29-1" class="h">@@ -120,12 +120,9 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h29-1-3" id="h29-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h29-1-5" id="h29-1-5" class="i">+            alias: None,
</a>         },
<a href="#h29-1-7" id="h29-1-7" class="d">-        labels: [
</a><a href="#h29-1-8" id="h29-1-8" class="d">-            None,
</a><a href="#h29-1-9" id="h29-1-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h29-2" id="h29-2" class="h">@@ -137,11 +134,24 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h29-2-3" id="h29-2-3" class="i">+        labels: [
</a><a href="#h29-2-4" id="h29-2-4" class="i">+            None,
</a><a href="#h29-2-5" id="h29-2-5" class="i">+        ],
</a>     },
<a href="#h29-2-7" id="h29-2-7" class="d">-)
</a><a href="#h29-2-8" id="h29-2-8" class="i">+    labels: [
</a><a href="#h29-2-9" id="h29-2-9" class="i">+        Some(
</a><a href="#h29-2-10" id="h29-2-10" class="i">+            (
</a><a href="#h29-2-11" id="h29-2-11" class="i">+                Some(
</a><a href="#h29-2-12" id="h29-2-12" class="i">+                    &quot;movies&quot;,
</a><a href="#h29-2-13" id="h29-2-13" class="i">+                ),
</a><a href="#h29-2-14" id="h29-2-14" class="i">+                &quot;id&quot;,
</a><a href="#h29-2-15" id="h29-2-15" class="i">+            ),
</a><a href="#h29-2-16" id="h29-2-16" class="i">+        ),
</a><a href="#h29-2-17" id="h29-2-17" class="i">+    ],
</a><a href="#h29-2-18" id="h29-2-18" class="i">+}
</a> 
<a href="#h29-2-20" id="h29-2-20" class="d">-Optimized plan: Select(
</a><a href="#h29-2-21" id="h29-2-21" class="d">-    Projection {
</a><a href="#h29-2-22" id="h29-2-22" class="i">+Optimized plan: Select {
</a><a href="#h29-2-23" id="h29-2-23" class="i">+    root: Projection {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h29-3" id="h29-3" class="h">@@ -220,12 +230,9 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h29-3-3" id="h29-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h29-3-5" id="h29-3-5" class="i">+            alias: None,
</a>         },
<a href="#h29-3-7" id="h29-3-7" class="d">-        labels: [
</a><a href="#h29-3-8" id="h29-3-8" class="d">-            None,
</a><a href="#h29-3-9" id="h29-3-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h29-4" id="h29-4" class="h">@@ -237,6 +244,19 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h29-4-3" id="h29-4-3" class="i">+        labels: [
</a><a href="#h29-4-4" id="h29-4-4" class="i">+            None,
</a><a href="#h29-4-5" id="h29-4-5" class="i">+        ],
</a>     },
<a href="#h29-4-7" id="h29-4-7" class="d">-)
</a><a href="#h29-4-8" id="h29-4-8" class="i">+    labels: [
</a><a href="#h29-4-9" id="h29-4-9" class="i">+        Some(
</a><a href="#h29-4-10" id="h29-4-10" class="i">+            (
</a><a href="#h29-4-11" id="h29-4-11" class="i">+                Some(
</a><a href="#h29-4-12" id="h29-4-12" class="i">+                    &quot;movies&quot;,
</a><a href="#h29-4-13" id="h29-4-13" class="i">+                ),
</a><a href="#h29-4-14" id="h29-4-14" class="i">+                &quot;id&quot;,
</a><a href="#h29-4-15" id="h29-4-15" class="i">+            ),
</a><a href="#h29-4-16" id="h29-4-16" class="i">+        ),
</a><a href="#h29-4-17" id="h29-4-17" class="i">+    ],
</a><a href="#h29-4-18" id="h29-4-18" class="i">+}
</a> 
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/field_unknown_qualified.html">tests/sql/query/field_unknown_qualified</a> b/<a href="../file/tests/sql/query/field_unknown_qualified.html">tests/sql/query/field_unknown_qualified</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -1,6 +1,6 @@
</a> Query: SELECT movies.unknown FROM movies
 
<a href="#h30-0-2" id="h30-0-2" class="d">-Error: invalid input: Unknown field movies.unknown
</a><a href="#h30-0-3" id="h30-0-3" class="i">+Error: invalid input: unknown field movies.unknown
</a> 
 AST: Select {
     select: [
<a href="#h30-1" id="h30-1" class="h">@@ -28,4 +28,4 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h30-1-3" id="h30-1-3" class="d">-Plan: InvalidInput(&quot;Unknown field movies.unknown&quot;)
</a><a href="#h30-1-4" id="h30-1-4" class="d">-\ No newline at end of file
</a><a href="#h30-1-5" id="h30-1-5" class="i">+Plan: InvalidInput(&quot;unknown field movies.unknown&quot;)
</a><a href="#h30-1-6" id="h30-1-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h31" href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a> b/<a href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -123,8 +123,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h31-0-3" id="h31-0-3" class="d">-Plan: Select(
</a><a href="#h31-0-4" id="h31-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h31-0-5" id="h31-0-5" class="i">+Plan: Select {
</a><a href="#h31-0-6" id="h31-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h31-1" id="h31-1" class="h">@@ -204,8 +204,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h31-1-3" id="h31-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h31-1-5" id="h31-1-5" class="i">+                alias: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h31-2" id="h31-2" class="h">@@ -233,8 +233,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h31-2-3" id="h31-2-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h31-2-5" id="h31-2-5" class="i">+                alias: None,
</a>             },
             predicate: None,
             outer: false,
<a href="#h31-3" id="h31-3" class="h">@@ -265,16 +265,106 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h31-3-3" id="h31-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h31-3-5" id="h31-3-5" class="i">+            alias: None,
</a>         },
         predicate: None,
         outer: false,
     },
<a href="#h31-3-10" id="h31-3-10" class="d">-)
</a><a href="#h31-3-11" id="h31-3-11" class="i">+    labels: [
</a><a href="#h31-3-12" id="h31-3-12" class="i">+        Some(
</a><a href="#h31-3-13" id="h31-3-13" class="i">+            (
</a><a href="#h31-3-14" id="h31-3-14" class="i">+                Some(
</a><a href="#h31-3-15" id="h31-3-15" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-3-16" id="h31-3-16" class="i">+                ),
</a><a href="#h31-3-17" id="h31-3-17" class="i">+                &quot;id&quot;,
</a><a href="#h31-3-18" id="h31-3-18" class="i">+            ),
</a><a href="#h31-3-19" id="h31-3-19" class="i">+        ),
</a><a href="#h31-3-20" id="h31-3-20" class="i">+        Some(
</a><a href="#h31-3-21" id="h31-3-21" class="i">+            (
</a><a href="#h31-3-22" id="h31-3-22" class="i">+                Some(
</a><a href="#h31-3-23" id="h31-3-23" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-3-24" id="h31-3-24" class="i">+                ),
</a><a href="#h31-3-25" id="h31-3-25" class="i">+                &quot;title&quot;,
</a><a href="#h31-3-26" id="h31-3-26" class="i">+            ),
</a><a href="#h31-3-27" id="h31-3-27" class="i">+        ),
</a><a href="#h31-3-28" id="h31-3-28" class="i">+        Some(
</a><a href="#h31-3-29" id="h31-3-29" class="i">+            (
</a><a href="#h31-3-30" id="h31-3-30" class="i">+                Some(
</a><a href="#h31-3-31" id="h31-3-31" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-3-32" id="h31-3-32" class="i">+                ),
</a><a href="#h31-3-33" id="h31-3-33" class="i">+                &quot;studio_id&quot;,
</a><a href="#h31-3-34" id="h31-3-34" class="i">+            ),
</a><a href="#h31-3-35" id="h31-3-35" class="i">+        ),
</a><a href="#h31-3-36" id="h31-3-36" class="i">+        Some(
</a><a href="#h31-3-37" id="h31-3-37" class="i">+            (
</a><a href="#h31-3-38" id="h31-3-38" class="i">+                Some(
</a><a href="#h31-3-39" id="h31-3-39" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-3-40" id="h31-3-40" class="i">+                ),
</a><a href="#h31-3-41" id="h31-3-41" class="i">+                &quot;genre_id&quot;,
</a><a href="#h31-3-42" id="h31-3-42" class="i">+            ),
</a><a href="#h31-3-43" id="h31-3-43" class="i">+        ),
</a><a href="#h31-3-44" id="h31-3-44" class="i">+        Some(
</a><a href="#h31-3-45" id="h31-3-45" class="i">+            (
</a><a href="#h31-3-46" id="h31-3-46" class="i">+                Some(
</a><a href="#h31-3-47" id="h31-3-47" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-3-48" id="h31-3-48" class="i">+                ),
</a><a href="#h31-3-49" id="h31-3-49" class="i">+                &quot;released&quot;,
</a><a href="#h31-3-50" id="h31-3-50" class="i">+            ),
</a><a href="#h31-3-51" id="h31-3-51" class="i">+        ),
</a><a href="#h31-3-52" id="h31-3-52" class="i">+        Some(
</a><a href="#h31-3-53" id="h31-3-53" class="i">+            (
</a><a href="#h31-3-54" id="h31-3-54" class="i">+                Some(
</a><a href="#h31-3-55" id="h31-3-55" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-3-56" id="h31-3-56" class="i">+                ),
</a><a href="#h31-3-57" id="h31-3-57" class="i">+                &quot;rating&quot;,
</a><a href="#h31-3-58" id="h31-3-58" class="i">+            ),
</a><a href="#h31-3-59" id="h31-3-59" class="i">+        ),
</a><a href="#h31-3-60" id="h31-3-60" class="i">+        Some(
</a><a href="#h31-3-61" id="h31-3-61" class="i">+            (
</a><a href="#h31-3-62" id="h31-3-62" class="i">+                Some(
</a><a href="#h31-3-63" id="h31-3-63" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-3-64" id="h31-3-64" class="i">+                ),
</a><a href="#h31-3-65" id="h31-3-65" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h31-3-66" id="h31-3-66" class="i">+            ),
</a><a href="#h31-3-67" id="h31-3-67" class="i">+        ),
</a><a href="#h31-3-68" id="h31-3-68" class="i">+        Some(
</a><a href="#h31-3-69" id="h31-3-69" class="i">+            (
</a><a href="#h31-3-70" id="h31-3-70" class="i">+                Some(
</a><a href="#h31-3-71" id="h31-3-71" class="i">+                    &quot;genres&quot;,
</a><a href="#h31-3-72" id="h31-3-72" class="i">+                ),
</a><a href="#h31-3-73" id="h31-3-73" class="i">+                &quot;id&quot;,
</a><a href="#h31-3-74" id="h31-3-74" class="i">+            ),
</a><a href="#h31-3-75" id="h31-3-75" class="i">+        ),
</a><a href="#h31-3-76" id="h31-3-76" class="i">+        Some(
</a><a href="#h31-3-77" id="h31-3-77" class="i">+            (
</a><a href="#h31-3-78" id="h31-3-78" class="i">+                Some(
</a><a href="#h31-3-79" id="h31-3-79" class="i">+                    &quot;genres&quot;,
</a><a href="#h31-3-80" id="h31-3-80" class="i">+                ),
</a><a href="#h31-3-81" id="h31-3-81" class="i">+                &quot;name&quot;,
</a><a href="#h31-3-82" id="h31-3-82" class="i">+            ),
</a><a href="#h31-3-83" id="h31-3-83" class="i">+        ),
</a><a href="#h31-3-84" id="h31-3-84" class="i">+        Some(
</a><a href="#h31-3-85" id="h31-3-85" class="i">+            (
</a><a href="#h31-3-86" id="h31-3-86" class="i">+                Some(
</a><a href="#h31-3-87" id="h31-3-87" class="i">+                    &quot;countries&quot;,
</a><a href="#h31-3-88" id="h31-3-88" class="i">+                ),
</a><a href="#h31-3-89" id="h31-3-89" class="i">+                &quot;id&quot;,
</a><a href="#h31-3-90" id="h31-3-90" class="i">+            ),
</a><a href="#h31-3-91" id="h31-3-91" class="i">+        ),
</a><a href="#h31-3-92" id="h31-3-92" class="i">+        Some(
</a><a href="#h31-3-93" id="h31-3-93" class="i">+            (
</a><a href="#h31-3-94" id="h31-3-94" class="i">+                Some(
</a><a href="#h31-3-95" id="h31-3-95" class="i">+                    &quot;countries&quot;,
</a><a href="#h31-3-96" id="h31-3-96" class="i">+                ),
</a><a href="#h31-3-97" id="h31-3-97" class="i">+                &quot;name&quot;,
</a><a href="#h31-3-98" id="h31-3-98" class="i">+            ),
</a><a href="#h31-3-99" id="h31-3-99" class="i">+        ),
</a><a href="#h31-3-100" id="h31-3-100" class="i">+    ],
</a><a href="#h31-3-101" id="h31-3-101" class="i">+}
</a> 
<a href="#h31-3-103" id="h31-3-103" class="d">-Optimized plan: Select(
</a><a href="#h31-3-104" id="h31-3-104" class="d">-    NestedLoopJoin {
</a><a href="#h31-3-105" id="h31-3-105" class="i">+Optimized plan: Select {
</a><a href="#h31-3-106" id="h31-3-106" class="i">+    root: NestedLoopJoin {
</a>         left: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h31-4" id="h31-4" class="h">@@ -354,8 +444,8 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h31-4-3" id="h31-4-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h31-4-5" id="h31-4-5" class="i">+                alias: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h31-5" id="h31-5" class="h">@@ -383,8 +473,8 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h31-5-3" id="h31-5-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h31-5-5" id="h31-5-5" class="i">+                alias: None,
</a>             },
             predicate: None,
             outer: false,
<a href="#h31-6" id="h31-6" class="h">@@ -415,11 +505,101 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h31-6-3" id="h31-6-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h31-6-5" id="h31-6-5" class="i">+            alias: None,
</a>         },
         predicate: None,
         outer: false,
     },
<a href="#h31-6-10" id="h31-6-10" class="d">-)
</a><a href="#h31-6-11" id="h31-6-11" class="i">+    labels: [
</a><a href="#h31-6-12" id="h31-6-12" class="i">+        Some(
</a><a href="#h31-6-13" id="h31-6-13" class="i">+            (
</a><a href="#h31-6-14" id="h31-6-14" class="i">+                Some(
</a><a href="#h31-6-15" id="h31-6-15" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-6-16" id="h31-6-16" class="i">+                ),
</a><a href="#h31-6-17" id="h31-6-17" class="i">+                &quot;id&quot;,
</a><a href="#h31-6-18" id="h31-6-18" class="i">+            ),
</a><a href="#h31-6-19" id="h31-6-19" class="i">+        ),
</a><a href="#h31-6-20" id="h31-6-20" class="i">+        Some(
</a><a href="#h31-6-21" id="h31-6-21" class="i">+            (
</a><a href="#h31-6-22" id="h31-6-22" class="i">+                Some(
</a><a href="#h31-6-23" id="h31-6-23" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-6-24" id="h31-6-24" class="i">+                ),
</a><a href="#h31-6-25" id="h31-6-25" class="i">+                &quot;title&quot;,
</a><a href="#h31-6-26" id="h31-6-26" class="i">+            ),
</a><a href="#h31-6-27" id="h31-6-27" class="i">+        ),
</a><a href="#h31-6-28" id="h31-6-28" class="i">+        Some(
</a><a href="#h31-6-29" id="h31-6-29" class="i">+            (
</a><a href="#h31-6-30" id="h31-6-30" class="i">+                Some(
</a><a href="#h31-6-31" id="h31-6-31" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-6-32" id="h31-6-32" class="i">+                ),
</a><a href="#h31-6-33" id="h31-6-33" class="i">+                &quot;studio_id&quot;,
</a><a href="#h31-6-34" id="h31-6-34" class="i">+            ),
</a><a href="#h31-6-35" id="h31-6-35" class="i">+        ),
</a><a href="#h31-6-36" id="h31-6-36" class="i">+        Some(
</a><a href="#h31-6-37" id="h31-6-37" class="i">+            (
</a><a href="#h31-6-38" id="h31-6-38" class="i">+                Some(
</a><a href="#h31-6-39" id="h31-6-39" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-6-40" id="h31-6-40" class="i">+                ),
</a><a href="#h31-6-41" id="h31-6-41" class="i">+                &quot;genre_id&quot;,
</a><a href="#h31-6-42" id="h31-6-42" class="i">+            ),
</a><a href="#h31-6-43" id="h31-6-43" class="i">+        ),
</a><a href="#h31-6-44" id="h31-6-44" class="i">+        Some(
</a><a href="#h31-6-45" id="h31-6-45" class="i">+            (
</a><a href="#h31-6-46" id="h31-6-46" class="i">+                Some(
</a><a href="#h31-6-47" id="h31-6-47" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-6-48" id="h31-6-48" class="i">+                ),
</a><a href="#h31-6-49" id="h31-6-49" class="i">+                &quot;released&quot;,
</a><a href="#h31-6-50" id="h31-6-50" class="i">+            ),
</a><a href="#h31-6-51" id="h31-6-51" class="i">+        ),
</a><a href="#h31-6-52" id="h31-6-52" class="i">+        Some(
</a><a href="#h31-6-53" id="h31-6-53" class="i">+            (
</a><a href="#h31-6-54" id="h31-6-54" class="i">+                Some(
</a><a href="#h31-6-55" id="h31-6-55" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-6-56" id="h31-6-56" class="i">+                ),
</a><a href="#h31-6-57" id="h31-6-57" class="i">+                &quot;rating&quot;,
</a><a href="#h31-6-58" id="h31-6-58" class="i">+            ),
</a><a href="#h31-6-59" id="h31-6-59" class="i">+        ),
</a><a href="#h31-6-60" id="h31-6-60" class="i">+        Some(
</a><a href="#h31-6-61" id="h31-6-61" class="i">+            (
</a><a href="#h31-6-62" id="h31-6-62" class="i">+                Some(
</a><a href="#h31-6-63" id="h31-6-63" class="i">+                    &quot;movies&quot;,
</a><a href="#h31-6-64" id="h31-6-64" class="i">+                ),
</a><a href="#h31-6-65" id="h31-6-65" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h31-6-66" id="h31-6-66" class="i">+            ),
</a><a href="#h31-6-67" id="h31-6-67" class="i">+        ),
</a><a href="#h31-6-68" id="h31-6-68" class="i">+        Some(
</a><a href="#h31-6-69" id="h31-6-69" class="i">+            (
</a><a href="#h31-6-70" id="h31-6-70" class="i">+                Some(
</a><a href="#h31-6-71" id="h31-6-71" class="i">+                    &quot;genres&quot;,
</a><a href="#h31-6-72" id="h31-6-72" class="i">+                ),
</a><a href="#h31-6-73" id="h31-6-73" class="i">+                &quot;id&quot;,
</a><a href="#h31-6-74" id="h31-6-74" class="i">+            ),
</a><a href="#h31-6-75" id="h31-6-75" class="i">+        ),
</a><a href="#h31-6-76" id="h31-6-76" class="i">+        Some(
</a><a href="#h31-6-77" id="h31-6-77" class="i">+            (
</a><a href="#h31-6-78" id="h31-6-78" class="i">+                Some(
</a><a href="#h31-6-79" id="h31-6-79" class="i">+                    &quot;genres&quot;,
</a><a href="#h31-6-80" id="h31-6-80" class="i">+                ),
</a><a href="#h31-6-81" id="h31-6-81" class="i">+                &quot;name&quot;,
</a><a href="#h31-6-82" id="h31-6-82" class="i">+            ),
</a><a href="#h31-6-83" id="h31-6-83" class="i">+        ),
</a><a href="#h31-6-84" id="h31-6-84" class="i">+        Some(
</a><a href="#h31-6-85" id="h31-6-85" class="i">+            (
</a><a href="#h31-6-86" id="h31-6-86" class="i">+                Some(
</a><a href="#h31-6-87" id="h31-6-87" class="i">+                    &quot;countries&quot;,
</a><a href="#h31-6-88" id="h31-6-88" class="i">+                ),
</a><a href="#h31-6-89" id="h31-6-89" class="i">+                &quot;id&quot;,
</a><a href="#h31-6-90" id="h31-6-90" class="i">+            ),
</a><a href="#h31-6-91" id="h31-6-91" class="i">+        ),
</a><a href="#h31-6-92" id="h31-6-92" class="i">+        Some(
</a><a href="#h31-6-93" id="h31-6-93" class="i">+            (
</a><a href="#h31-6-94" id="h31-6-94" class="i">+                Some(
</a><a href="#h31-6-95" id="h31-6-95" class="i">+                    &quot;countries&quot;,
</a><a href="#h31-6-96" id="h31-6-96" class="i">+                ),
</a><a href="#h31-6-97" id="h31-6-97" class="i">+                &quot;name&quot;,
</a><a href="#h31-6-98" id="h31-6-98" class="i">+            ),
</a><a href="#h31-6-99" id="h31-6-99" class="i">+        ),
</a><a href="#h31-6-100" id="h31-6-100" class="i">+    ],
</a><a href="#h31-6-101" id="h31-6-101" class="i">+}
</a> 
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a> b/<a href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -3,7 +3,7 @@ Query: SELECT MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY 
</a> Explain:
 Order: rating asc
 └─ Projection: #0
<a href="#h32-0-3" id="h32-0-3" class="d">-   └─ Aggregation: maximum
</a><a href="#h32-0-4" id="h32-0-4" class="i">+   └─ Aggregation: max
</a>       └─ Projection: rating, studio_id * 2
          └─ Scan: movies
 
<a href="#h32-1" id="h32-1" class="h">@@ -66,8 +66,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h32-1-3" id="h32-1-3" class="d">-Plan: Select(
</a><a href="#h32-1-4" id="h32-1-4" class="d">-    Order {
</a><a href="#h32-1-5" id="h32-1-5" class="i">+Plan: Select {
</a><a href="#h32-1-6" id="h32-1-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h32-2" id="h32-2" class="h">@@ -149,13 +149,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h32-2-3" id="h32-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h32-2-5" id="h32-2-5" class="i">+                        alias: None,
</a>                     },
<a href="#h32-2-7" id="h32-2-7" class="d">-                    labels: [
</a><a href="#h32-2-8" id="h32-2-8" class="d">-                        None,
</a><a href="#h32-2-9" id="h32-2-9" class="d">-                        None,
</a><a href="#h32-2-10" id="h32-2-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h32-3" id="h32-3" class="h">@@ -183,11 +179,21 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h32-3-3" id="h32-3-3" class="i">+                    labels: [
</a><a href="#h32-3-4" id="h32-3-4" class="i">+                        None,
</a><a href="#h32-3-5" id="h32-3-5" class="i">+                        None,
</a><a href="#h32-3-6" id="h32-3-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h32-3-12" id="h32-3-12" class="i">+            expressions: [
</a><a href="#h32-3-13" id="h32-3-13" class="i">+                Field(
</a><a href="#h32-3-14" id="h32-3-14" class="i">+                    0,
</a><a href="#h32-3-15" id="h32-3-15" class="i">+                    None,
</a><a href="#h32-3-16" id="h32-3-16" class="i">+                ),
</a><a href="#h32-3-17" id="h32-3-17" class="i">+            ],
</a>             labels: [
                 Some(
                     (
<a href="#h32-4" id="h32-4" class="h">@@ -196,12 +202,6 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h32-4-3" id="h32-4-3" class="d">-            expressions: [
</a><a href="#h32-4-4" id="h32-4-4" class="d">-                Field(
</a><a href="#h32-4-5" id="h32-4-5" class="d">-                    0,
</a><a href="#h32-4-6" id="h32-4-6" class="d">-                    None,
</a><a href="#h32-4-7" id="h32-4-7" class="d">-                ),
</a><a href="#h32-4-8" id="h32-4-8" class="d">-            ],
</a>         },
         orders: [
             (
<a href="#h32-5" id="h32-5" class="h">@@ -218,10 +218,18 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h32-5-3" id="h32-5-3" class="d">-)
</a><a href="#h32-5-4" id="h32-5-4" class="i">+    labels: [
</a><a href="#h32-5-5" id="h32-5-5" class="i">+        Some(
</a><a href="#h32-5-6" id="h32-5-6" class="i">+            (
</a><a href="#h32-5-7" id="h32-5-7" class="i">+                None,
</a><a href="#h32-5-8" id="h32-5-8" class="i">+                &quot;rating&quot;,
</a><a href="#h32-5-9" id="h32-5-9" class="i">+            ),
</a><a href="#h32-5-10" id="h32-5-10" class="i">+        ),
</a><a href="#h32-5-11" id="h32-5-11" class="i">+    ],
</a><a href="#h32-5-12" id="h32-5-12" class="i">+}
</a> 
<a href="#h32-5-14" id="h32-5-14" class="d">-Optimized plan: Select(
</a><a href="#h32-5-15" id="h32-5-15" class="d">-    Order {
</a><a href="#h32-5-16" id="h32-5-16" class="i">+Optimized plan: Select {
</a><a href="#h32-5-17" id="h32-5-17" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h32-6" id="h32-6" class="h">@@ -303,13 +311,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h32-6-3" id="h32-6-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h32-6-5" id="h32-6-5" class="i">+                        alias: None,
</a>                     },
<a href="#h32-6-7" id="h32-6-7" class="d">-                    labels: [
</a><a href="#h32-6-8" id="h32-6-8" class="d">-                        None,
</a><a href="#h32-6-9" id="h32-6-9" class="d">-                        None,
</a><a href="#h32-6-10" id="h32-6-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h32-7" id="h32-7" class="h">@@ -337,11 +341,21 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h32-7-3" id="h32-7-3" class="i">+                    labels: [
</a><a href="#h32-7-4" id="h32-7-4" class="i">+                        None,
</a><a href="#h32-7-5" id="h32-7-5" class="i">+                        None,
</a><a href="#h32-7-6" id="h32-7-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h32-7-12" id="h32-7-12" class="i">+            expressions: [
</a><a href="#h32-7-13" id="h32-7-13" class="i">+                Field(
</a><a href="#h32-7-14" id="h32-7-14" class="i">+                    0,
</a><a href="#h32-7-15" id="h32-7-15" class="i">+                    None,
</a><a href="#h32-7-16" id="h32-7-16" class="i">+                ),
</a><a href="#h32-7-17" id="h32-7-17" class="i">+            ],
</a>             labels: [
                 Some(
                     (
<a href="#h32-8" id="h32-8" class="h">@@ -350,12 +364,6 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h32-8-3" id="h32-8-3" class="d">-            expressions: [
</a><a href="#h32-8-4" id="h32-8-4" class="d">-                Field(
</a><a href="#h32-8-5" id="h32-8-5" class="d">-                    0,
</a><a href="#h32-8-6" id="h32-8-6" class="d">-                    None,
</a><a href="#h32-8-7" id="h32-8-7" class="d">-                ),
</a><a href="#h32-8-8" id="h32-8-8" class="d">-            ],
</a>         },
         orders: [
             (
<a href="#h32-9" id="h32-9" class="h">@@ -372,5 +380,13 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h32-9-3" id="h32-9-3" class="d">-)
</a><a href="#h32-9-4" id="h32-9-4" class="i">+    labels: [
</a><a href="#h32-9-5" id="h32-9-5" class="i">+        Some(
</a><a href="#h32-9-6" id="h32-9-6" class="i">+            (
</a><a href="#h32-9-7" id="h32-9-7" class="i">+                None,
</a><a href="#h32-9-8" id="h32-9-8" class="i">+                &quot;rating&quot;,
</a><a href="#h32-9-9" id="h32-9-9" class="i">+            ),
</a><a href="#h32-9-10" id="h32-9-10" class="i">+        ),
</a><a href="#h32-9-11" id="h32-9-11" class="i">+    ],
</a><a href="#h32-9-12" id="h32-9-12" class="i">+}
</a> 
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a> b/<a href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -85,8 +85,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h33-0-3" id="h33-0-3" class="d">-Plan: Select(
</a><a href="#h33-0-4" id="h33-0-4" class="d">-    Order {
</a><a href="#h33-0-5" id="h33-0-5" class="i">+Plan: Select {
</a><a href="#h33-0-6" id="h33-0-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h33-1" id="h33-1" class="h">@@ -168,14 +168,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h33-1-3" id="h33-1-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h33-1-5" id="h33-1-5" class="i">+                        alias: None,
</a>                     },
<a href="#h33-1-7" id="h33-1-7" class="d">-                    labels: [
</a><a href="#h33-1-8" id="h33-1-8" class="d">-                        None,
</a><a href="#h33-1-9" id="h33-1-9" class="d">-                        None,
</a><a href="#h33-1-10" id="h33-1-10" class="d">-                        None,
</a><a href="#h33-1-11" id="h33-1-11" class="d">-                    ],
</a>                     expressions: [
                         Multiply(
                             Field(
<a href="#h33-2" id="h33-2" class="h">@@ -208,16 +203,17 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h33-2-3" id="h33-2-3" class="i">+                    labels: [
</a><a href="#h33-2-4" id="h33-2-4" class="i">+                        None,
</a><a href="#h33-2-5" id="h33-2-5" class="i">+                        None,
</a><a href="#h33-2-6" id="h33-2-6" class="i">+                        None,
</a><a href="#h33-2-7" id="h33-2-7" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Sum,
                     Count,
                 ],
             },
<a href="#h33-2-14" id="h33-2-14" class="d">-            labels: [
</a><a href="#h33-2-15" id="h33-2-15" class="d">-                None,
</a><a href="#h33-2-16" id="h33-2-16" class="d">-                None,
</a><a href="#h33-2-17" id="h33-2-17" class="d">-            ],
</a>             expressions: [
                 Field(
                     2,
<a href="#h33-3" id="h33-3" class="h">@@ -241,6 +237,10 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h33-3-3" id="h33-3-3" class="i">+            labels: [
</a><a href="#h33-3-4" id="h33-3-4" class="i">+                None,
</a><a href="#h33-3-5" id="h33-3-5" class="i">+                None,
</a><a href="#h33-3-6" id="h33-3-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h33-4" id="h33-4" class="h">@@ -259,10 +259,21 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h33-4-3" id="h33-4-3" class="d">-)
</a><a href="#h33-4-4" id="h33-4-4" class="i">+    labels: [
</a><a href="#h33-4-5" id="h33-4-5" class="i">+        Some(
</a><a href="#h33-4-6" id="h33-4-6" class="i">+            (
</a><a href="#h33-4-7" id="h33-4-7" class="i">+                Some(
</a><a href="#h33-4-8" id="h33-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h33-4-9" id="h33-4-9" class="i">+                ),
</a><a href="#h33-4-10" id="h33-4-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h33-4-11" id="h33-4-11" class="i">+            ),
</a><a href="#h33-4-12" id="h33-4-12" class="i">+        ),
</a><a href="#h33-4-13" id="h33-4-13" class="i">+        None,
</a><a href="#h33-4-14" id="h33-4-14" class="i">+    ],
</a><a href="#h33-4-15" id="h33-4-15" class="i">+}
</a> 
<a href="#h33-4-17" id="h33-4-17" class="d">-Optimized plan: Select(
</a><a href="#h33-4-18" id="h33-4-18" class="d">-    Order {
</a><a href="#h33-4-19" id="h33-4-19" class="i">+Optimized plan: Select {
</a><a href="#h33-4-20" id="h33-4-20" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h33-5" id="h33-5" class="h">@@ -344,14 +355,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h33-5-3" id="h33-5-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h33-5-5" id="h33-5-5" class="i">+                        alias: None,
</a>                     },
<a href="#h33-5-7" id="h33-5-7" class="d">-                    labels: [
</a><a href="#h33-5-8" id="h33-5-8" class="d">-                        None,
</a><a href="#h33-5-9" id="h33-5-9" class="d">-                        None,
</a><a href="#h33-5-10" id="h33-5-10" class="d">-                        None,
</a><a href="#h33-5-11" id="h33-5-11" class="d">-                    ],
</a>                     expressions: [
                         Multiply(
                             Field(
<a href="#h33-6" id="h33-6" class="h">@@ -384,16 +390,17 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h33-6-3" id="h33-6-3" class="i">+                    labels: [
</a><a href="#h33-6-4" id="h33-6-4" class="i">+                        None,
</a><a href="#h33-6-5" id="h33-6-5" class="i">+                        None,
</a><a href="#h33-6-6" id="h33-6-6" class="i">+                        None,
</a><a href="#h33-6-7" id="h33-6-7" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Sum,
                     Count,
                 ],
             },
<a href="#h33-6-14" id="h33-6-14" class="d">-            labels: [
</a><a href="#h33-6-15" id="h33-6-15" class="d">-                None,
</a><a href="#h33-6-16" id="h33-6-16" class="d">-                None,
</a><a href="#h33-6-17" id="h33-6-17" class="d">-            ],
</a>             expressions: [
                 Field(
                     2,
<a href="#h33-7" id="h33-7" class="h">@@ -417,6 +424,10 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h33-7-3" id="h33-7-3" class="i">+            labels: [
</a><a href="#h33-7-4" id="h33-7-4" class="i">+                None,
</a><a href="#h33-7-5" id="h33-7-5" class="i">+                None,
</a><a href="#h33-7-6" id="h33-7-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h33-8" id="h33-8" class="h">@@ -435,5 +446,16 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h33-8-3" id="h33-8-3" class="d">-)
</a><a href="#h33-8-4" id="h33-8-4" class="i">+    labels: [
</a><a href="#h33-8-5" id="h33-8-5" class="i">+        Some(
</a><a href="#h33-8-6" id="h33-8-6" class="i">+            (
</a><a href="#h33-8-7" id="h33-8-7" class="i">+                Some(
</a><a href="#h33-8-8" id="h33-8-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h33-8-9" id="h33-8-9" class="i">+                ),
</a><a href="#h33-8-10" id="h33-8-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h33-8-11" id="h33-8-11" class="i">+            ),
</a><a href="#h33-8-12" id="h33-8-12" class="i">+        ),
</a><a href="#h33-8-13" id="h33-8-13" class="i">+        None,
</a><a href="#h33-8-14" id="h33-8-14" class="i">+    ],
</a><a href="#h33-8-15" id="h33-8-15" class="i">+}
</a> 
<b>diff --git a/<a id="h34" href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a> b/<a href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -93,8 +93,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h34-0-3" id="h34-0-3" class="d">-Plan: Select(
</a><a href="#h34-0-4" id="h34-0-4" class="d">-    Order {
</a><a href="#h34-0-5" id="h34-0-5" class="i">+Plan: Select {
</a><a href="#h34-0-6" id="h34-0-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h34-1" id="h34-1" class="h">@@ -176,14 +176,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h34-1-3" id="h34-1-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h34-1-5" id="h34-1-5" class="i">+                        alias: None,
</a>                     },
<a href="#h34-1-7" id="h34-1-7" class="d">-                    labels: [
</a><a href="#h34-1-8" id="h34-1-8" class="d">-                        None,
</a><a href="#h34-1-9" id="h34-1-9" class="d">-                        None,
</a><a href="#h34-1-10" id="h34-1-10" class="d">-                        None,
</a><a href="#h34-1-11" id="h34-1-11" class="d">-                    ],
</a>                     expressions: [
                         Multiply(
                             Field(
<a href="#h34-2" id="h34-2" class="h">@@ -216,16 +211,17 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h34-2-3" id="h34-2-3" class="i">+                    labels: [
</a><a href="#h34-2-4" id="h34-2-4" class="i">+                        None,
</a><a href="#h34-2-5" id="h34-2-5" class="i">+                        None,
</a><a href="#h34-2-6" id="h34-2-6" class="i">+                        None,
</a><a href="#h34-2-7" id="h34-2-7" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Sum,
                     Count,
                 ],
             },
<a href="#h34-2-14" id="h34-2-14" class="d">-            labels: [
</a><a href="#h34-2-15" id="h34-2-15" class="d">-                None,
</a><a href="#h34-2-16" id="h34-2-16" class="d">-                None,
</a><a href="#h34-2-17" id="h34-2-17" class="d">-            ],
</a>             expressions: [
                 Field(
                     2,
<a href="#h34-3" id="h34-3" class="h">@@ -260,6 +256,10 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h34-3-3" id="h34-3-3" class="i">+            labels: [
</a><a href="#h34-3-4" id="h34-3-4" class="i">+                None,
</a><a href="#h34-3-5" id="h34-3-5" class="i">+                None,
</a><a href="#h34-3-6" id="h34-3-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h34-4" id="h34-4" class="h">@@ -278,10 +278,21 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h34-4-3" id="h34-4-3" class="d">-)
</a><a href="#h34-4-4" id="h34-4-4" class="i">+    labels: [
</a><a href="#h34-4-5" id="h34-4-5" class="i">+        Some(
</a><a href="#h34-4-6" id="h34-4-6" class="i">+            (
</a><a href="#h34-4-7" id="h34-4-7" class="i">+                Some(
</a><a href="#h34-4-8" id="h34-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h34-4-9" id="h34-4-9" class="i">+                ),
</a><a href="#h34-4-10" id="h34-4-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h34-4-11" id="h34-4-11" class="i">+            ),
</a><a href="#h34-4-12" id="h34-4-12" class="i">+        ),
</a><a href="#h34-4-13" id="h34-4-13" class="i">+        None,
</a><a href="#h34-4-14" id="h34-4-14" class="i">+    ],
</a><a href="#h34-4-15" id="h34-4-15" class="i">+}
</a> 
<a href="#h34-4-17" id="h34-4-17" class="d">-Optimized plan: Select(
</a><a href="#h34-4-18" id="h34-4-18" class="d">-    Order {
</a><a href="#h34-4-19" id="h34-4-19" class="i">+Optimized plan: Select {
</a><a href="#h34-4-20" id="h34-4-20" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h34-5" id="h34-5" class="h">@@ -363,14 +374,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h34-5-3" id="h34-5-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h34-5-5" id="h34-5-5" class="i">+                        alias: None,
</a>                     },
<a href="#h34-5-7" id="h34-5-7" class="d">-                    labels: [
</a><a href="#h34-5-8" id="h34-5-8" class="d">-                        None,
</a><a href="#h34-5-9" id="h34-5-9" class="d">-                        None,
</a><a href="#h34-5-10" id="h34-5-10" class="d">-                        None,
</a><a href="#h34-5-11" id="h34-5-11" class="d">-                    ],
</a>                     expressions: [
                         Multiply(
                             Field(
<a href="#h34-6" id="h34-6" class="h">@@ -403,16 +409,17 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h34-6-3" id="h34-6-3" class="i">+                    labels: [
</a><a href="#h34-6-4" id="h34-6-4" class="i">+                        None,
</a><a href="#h34-6-5" id="h34-6-5" class="i">+                        None,
</a><a href="#h34-6-6" id="h34-6-6" class="i">+                        None,
</a><a href="#h34-6-7" id="h34-6-7" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Sum,
                     Count,
                 ],
             },
<a href="#h34-6-14" id="h34-6-14" class="d">-            labels: [
</a><a href="#h34-6-15" id="h34-6-15" class="d">-                None,
</a><a href="#h34-6-16" id="h34-6-16" class="d">-                None,
</a><a href="#h34-6-17" id="h34-6-17" class="d">-            ],
</a>             expressions: [
                 Field(
                     2,
<a href="#h34-7" id="h34-7" class="h">@@ -447,6 +454,10 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h34-7-3" id="h34-7-3" class="i">+            labels: [
</a><a href="#h34-7-4" id="h34-7-4" class="i">+                None,
</a><a href="#h34-7-5" id="h34-7-5" class="i">+                None,
</a><a href="#h34-7-6" id="h34-7-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h34-8" id="h34-8" class="h">@@ -465,5 +476,16 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h34-8-3" id="h34-8-3" class="d">-)
</a><a href="#h34-8-4" id="h34-8-4" class="i">+    labels: [
</a><a href="#h34-8-5" id="h34-8-5" class="i">+        Some(
</a><a href="#h34-8-6" id="h34-8-6" class="i">+            (
</a><a href="#h34-8-7" id="h34-8-7" class="i">+                Some(
</a><a href="#h34-8-8" id="h34-8-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h34-8-9" id="h34-8-9" class="i">+                ),
</a><a href="#h34-8-10" id="h34-8-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h34-8-11" id="h34-8-11" class="i">+            ),
</a><a href="#h34-8-12" id="h34-8-12" class="i">+        ),
</a><a href="#h34-8-13" id="h34-8-13" class="i">+        None,
</a><a href="#h34-8-14" id="h34-8-14" class="i">+    ],
</a><a href="#h34-8-15" id="h34-8-15" class="i">+}
</a> 
<b>diff --git a/<a id="h35" href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a> b/<a href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -3,7 +3,7 @@ Query: SELECT studio_id * 2 AS twice, MAX(rating) FROM movies GROUP BY twice ORD
</a> Explain:
 Order: twice asc
 └─ Projection: twice, #0
<a href="#h35-0-3" id="h35-0-3" class="d">-   └─ Aggregation: maximum
</a><a href="#h35-0-4" id="h35-0-4" class="i">+   └─ Aggregation: max
</a>       └─ Projection: rating, studio_id * 2
          └─ Scan: movies
 
<a href="#h35-1" id="h35-1" class="h">@@ -73,8 +73,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h35-1-3" id="h35-1-3" class="d">-Plan: Select(
</a><a href="#h35-1-4" id="h35-1-4" class="d">-    Order {
</a><a href="#h35-1-5" id="h35-1-5" class="i">+Plan: Select {
</a><a href="#h35-1-6" id="h35-1-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h35-2" id="h35-2" class="h">@@ -156,18 +156,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h35-2-3" id="h35-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h35-2-5" id="h35-2-5" class="i">+                        alias: None,
</a>                     },
<a href="#h35-2-7" id="h35-2-7" class="d">-                    labels: [
</a><a href="#h35-2-8" id="h35-2-8" class="d">-                        None,
</a><a href="#h35-2-9" id="h35-2-9" class="d">-                        Some(
</a><a href="#h35-2-10" id="h35-2-10" class="d">-                            (
</a><a href="#h35-2-11" id="h35-2-11" class="d">-                                None,
</a><a href="#h35-2-12" id="h35-2-12" class="d">-                                &quot;twice&quot;,
</a><a href="#h35-2-13" id="h35-2-13" class="d">-                            ),
</a><a href="#h35-2-14" id="h35-2-14" class="d">-                        ),
</a><a href="#h35-2-15" id="h35-2-15" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h35-3" id="h35-3" class="h">@@ -195,20 +186,20 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h35-3-3" id="h35-3-3" class="i">+                    labels: [
</a><a href="#h35-3-4" id="h35-3-4" class="i">+                        None,
</a><a href="#h35-3-5" id="h35-3-5" class="i">+                        Some(
</a><a href="#h35-3-6" id="h35-3-6" class="i">+                            (
</a><a href="#h35-3-7" id="h35-3-7" class="i">+                                None,
</a><a href="#h35-3-8" id="h35-3-8" class="i">+                                &quot;twice&quot;,
</a><a href="#h35-3-9" id="h35-3-9" class="i">+                            ),
</a><a href="#h35-3-10" id="h35-3-10" class="i">+                        ),
</a><a href="#h35-3-11" id="h35-3-11" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h35-3-17" id="h35-3-17" class="d">-            labels: [
</a><a href="#h35-3-18" id="h35-3-18" class="d">-                Some(
</a><a href="#h35-3-19" id="h35-3-19" class="d">-                    (
</a><a href="#h35-3-20" id="h35-3-20" class="d">-                        None,
</a><a href="#h35-3-21" id="h35-3-21" class="d">-                        &quot;twice&quot;,
</a><a href="#h35-3-22" id="h35-3-22" class="d">-                    ),
</a><a href="#h35-3-23" id="h35-3-23" class="d">-                ),
</a><a href="#h35-3-24" id="h35-3-24" class="d">-                None,
</a><a href="#h35-3-25" id="h35-3-25" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h35-4" id="h35-4" class="h">@@ -224,6 +215,15 @@ Plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h35-4-3" id="h35-4-3" class="i">+            labels: [
</a><a href="#h35-4-4" id="h35-4-4" class="i">+                Some(
</a><a href="#h35-4-5" id="h35-4-5" class="i">+                    (
</a><a href="#h35-4-6" id="h35-4-6" class="i">+                        None,
</a><a href="#h35-4-7" id="h35-4-7" class="i">+                        &quot;twice&quot;,
</a><a href="#h35-4-8" id="h35-4-8" class="i">+                    ),
</a><a href="#h35-4-9" id="h35-4-9" class="i">+                ),
</a><a href="#h35-4-10" id="h35-4-10" class="i">+                None,
</a><a href="#h35-4-11" id="h35-4-11" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h35-5" id="h35-5" class="h">@@ -240,10 +240,19 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h35-5-3" id="h35-5-3" class="d">-)
</a><a href="#h35-5-4" id="h35-5-4" class="i">+    labels: [
</a><a href="#h35-5-5" id="h35-5-5" class="i">+        Some(
</a><a href="#h35-5-6" id="h35-5-6" class="i">+            (
</a><a href="#h35-5-7" id="h35-5-7" class="i">+                None,
</a><a href="#h35-5-8" id="h35-5-8" class="i">+                &quot;twice&quot;,
</a><a href="#h35-5-9" id="h35-5-9" class="i">+            ),
</a><a href="#h35-5-10" id="h35-5-10" class="i">+        ),
</a><a href="#h35-5-11" id="h35-5-11" class="i">+        None,
</a><a href="#h35-5-12" id="h35-5-12" class="i">+    ],
</a><a href="#h35-5-13" id="h35-5-13" class="i">+}
</a> 
<a href="#h35-5-15" id="h35-5-15" class="d">-Optimized plan: Select(
</a><a href="#h35-5-16" id="h35-5-16" class="d">-    Order {
</a><a href="#h35-5-17" id="h35-5-17" class="i">+Optimized plan: Select {
</a><a href="#h35-5-18" id="h35-5-18" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h35-6" id="h35-6" class="h">@@ -325,18 +334,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h35-6-3" id="h35-6-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h35-6-5" id="h35-6-5" class="i">+                        alias: None,
</a>                     },
<a href="#h35-6-7" id="h35-6-7" class="d">-                    labels: [
</a><a href="#h35-6-8" id="h35-6-8" class="d">-                        None,
</a><a href="#h35-6-9" id="h35-6-9" class="d">-                        Some(
</a><a href="#h35-6-10" id="h35-6-10" class="d">-                            (
</a><a href="#h35-6-11" id="h35-6-11" class="d">-                                None,
</a><a href="#h35-6-12" id="h35-6-12" class="d">-                                &quot;twice&quot;,
</a><a href="#h35-6-13" id="h35-6-13" class="d">-                            ),
</a><a href="#h35-6-14" id="h35-6-14" class="d">-                        ),
</a><a href="#h35-6-15" id="h35-6-15" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h35-7" id="h35-7" class="h">@@ -364,20 +364,20 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h35-7-3" id="h35-7-3" class="i">+                    labels: [
</a><a href="#h35-7-4" id="h35-7-4" class="i">+                        None,
</a><a href="#h35-7-5" id="h35-7-5" class="i">+                        Some(
</a><a href="#h35-7-6" id="h35-7-6" class="i">+                            (
</a><a href="#h35-7-7" id="h35-7-7" class="i">+                                None,
</a><a href="#h35-7-8" id="h35-7-8" class="i">+                                &quot;twice&quot;,
</a><a href="#h35-7-9" id="h35-7-9" class="i">+                            ),
</a><a href="#h35-7-10" id="h35-7-10" class="i">+                        ),
</a><a href="#h35-7-11" id="h35-7-11" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h35-7-17" id="h35-7-17" class="d">-            labels: [
</a><a href="#h35-7-18" id="h35-7-18" class="d">-                Some(
</a><a href="#h35-7-19" id="h35-7-19" class="d">-                    (
</a><a href="#h35-7-20" id="h35-7-20" class="d">-                        None,
</a><a href="#h35-7-21" id="h35-7-21" class="d">-                        &quot;twice&quot;,
</a><a href="#h35-7-22" id="h35-7-22" class="d">-                    ),
</a><a href="#h35-7-23" id="h35-7-23" class="d">-                ),
</a><a href="#h35-7-24" id="h35-7-24" class="d">-                None,
</a><a href="#h35-7-25" id="h35-7-25" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h35-8" id="h35-8" class="h">@@ -393,6 +393,15 @@ Optimized plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h35-8-3" id="h35-8-3" class="i">+            labels: [
</a><a href="#h35-8-4" id="h35-8-4" class="i">+                Some(
</a><a href="#h35-8-5" id="h35-8-5" class="i">+                    (
</a><a href="#h35-8-6" id="h35-8-6" class="i">+                        None,
</a><a href="#h35-8-7" id="h35-8-7" class="i">+                        &quot;twice&quot;,
</a><a href="#h35-8-8" id="h35-8-8" class="i">+                    ),
</a><a href="#h35-8-9" id="h35-8-9" class="i">+                ),
</a><a href="#h35-8-10" id="h35-8-10" class="i">+                None,
</a><a href="#h35-8-11" id="h35-8-11" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h35-9" id="h35-9" class="h">@@ -409,5 +418,14 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h35-9-3" id="h35-9-3" class="d">-)
</a><a href="#h35-9-4" id="h35-9-4" class="i">+    labels: [
</a><a href="#h35-9-5" id="h35-9-5" class="i">+        Some(
</a><a href="#h35-9-6" id="h35-9-6" class="i">+            (
</a><a href="#h35-9-7" id="h35-9-7" class="i">+                None,
</a><a href="#h35-9-8" id="h35-9-8" class="i">+                &quot;twice&quot;,
</a><a href="#h35-9-9" id="h35-9-9" class="i">+            ),
</a><a href="#h35-9-10" id="h35-9-10" class="i">+        ),
</a><a href="#h35-9-11" id="h35-9-11" class="i">+        None,
</a><a href="#h35-9-12" id="h35-9-12" class="i">+    ],
</a><a href="#h35-9-13" id="h35-9-13" class="i">+}
</a> 
<b>diff --git a/<a id="h36" href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a> b/<a href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -3,7 +3,7 @@ Query: SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_i
</a> Explain:
 Order: rating asc
 └─ Projection: #1, #0
<a href="#h36-0-3" id="h36-0-3" class="d">-   └─ Aggregation: maximum
</a><a href="#h36-0-4" id="h36-0-4" class="i">+   └─ Aggregation: max
</a>       └─ Projection: rating, studio_id * 2
          └─ Scan: movies
 
<a href="#h36-1" id="h36-1" class="h">@@ -82,8 +82,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h36-1-3" id="h36-1-3" class="d">-Plan: Select(
</a><a href="#h36-1-4" id="h36-1-4" class="d">-    Order {
</a><a href="#h36-1-5" id="h36-1-5" class="i">+Plan: Select {
</a><a href="#h36-1-6" id="h36-1-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h36-2" id="h36-2" class="h">@@ -165,13 +165,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h36-2-3" id="h36-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h36-2-5" id="h36-2-5" class="i">+                        alias: None,
</a>                     },
<a href="#h36-2-7" id="h36-2-7" class="d">-                    labels: [
</a><a href="#h36-2-8" id="h36-2-8" class="d">-                        None,
</a><a href="#h36-2-9" id="h36-2-9" class="d">-                        None,
</a><a href="#h36-2-10" id="h36-2-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h36-3" id="h36-3" class="h">@@ -199,20 +195,15 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h36-3-3" id="h36-3-3" class="i">+                    labels: [
</a><a href="#h36-3-4" id="h36-3-4" class="i">+                        None,
</a><a href="#h36-3-5" id="h36-3-5" class="i">+                        None,
</a><a href="#h36-3-6" id="h36-3-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h36-3-12" id="h36-3-12" class="d">-            labels: [
</a><a href="#h36-3-13" id="h36-3-13" class="d">-                None,
</a><a href="#h36-3-14" id="h36-3-14" class="d">-                Some(
</a><a href="#h36-3-15" id="h36-3-15" class="d">-                    (
</a><a href="#h36-3-16" id="h36-3-16" class="d">-                        None,
</a><a href="#h36-3-17" id="h36-3-17" class="d">-                        &quot;rating&quot;,
</a><a href="#h36-3-18" id="h36-3-18" class="d">-                    ),
</a><a href="#h36-3-19" id="h36-3-19" class="d">-                ),
</a><a href="#h36-3-20" id="h36-3-20" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h36-4" id="h36-4" class="h">@@ -223,6 +214,15 @@ Plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h36-4-3" id="h36-4-3" class="i">+            labels: [
</a><a href="#h36-4-4" id="h36-4-4" class="i">+                None,
</a><a href="#h36-4-5" id="h36-4-5" class="i">+                Some(
</a><a href="#h36-4-6" id="h36-4-6" class="i">+                    (
</a><a href="#h36-4-7" id="h36-4-7" class="i">+                        None,
</a><a href="#h36-4-8" id="h36-4-8" class="i">+                        &quot;rating&quot;,
</a><a href="#h36-4-9" id="h36-4-9" class="i">+                    ),
</a><a href="#h36-4-10" id="h36-4-10" class="i">+                ),
</a><a href="#h36-4-11" id="h36-4-11" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h36-5" id="h36-5" class="h">@@ -239,10 +239,19 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h36-5-3" id="h36-5-3" class="d">-)
</a><a href="#h36-5-4" id="h36-5-4" class="i">+    labels: [
</a><a href="#h36-5-5" id="h36-5-5" class="i">+        None,
</a><a href="#h36-5-6" id="h36-5-6" class="i">+        Some(
</a><a href="#h36-5-7" id="h36-5-7" class="i">+            (
</a><a href="#h36-5-8" id="h36-5-8" class="i">+                None,
</a><a href="#h36-5-9" id="h36-5-9" class="i">+                &quot;rating&quot;,
</a><a href="#h36-5-10" id="h36-5-10" class="i">+            ),
</a><a href="#h36-5-11" id="h36-5-11" class="i">+        ),
</a><a href="#h36-5-12" id="h36-5-12" class="i">+    ],
</a><a href="#h36-5-13" id="h36-5-13" class="i">+}
</a> 
<a href="#h36-5-15" id="h36-5-15" class="d">-Optimized plan: Select(
</a><a href="#h36-5-16" id="h36-5-16" class="d">-    Order {
</a><a href="#h36-5-17" id="h36-5-17" class="i">+Optimized plan: Select {
</a><a href="#h36-5-18" id="h36-5-18" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h36-6" id="h36-6" class="h">@@ -324,13 +333,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h36-6-3" id="h36-6-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h36-6-5" id="h36-6-5" class="i">+                        alias: None,
</a>                     },
<a href="#h36-6-7" id="h36-6-7" class="d">-                    labels: [
</a><a href="#h36-6-8" id="h36-6-8" class="d">-                        None,
</a><a href="#h36-6-9" id="h36-6-9" class="d">-                        None,
</a><a href="#h36-6-10" id="h36-6-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h36-7" id="h36-7" class="h">@@ -358,20 +363,15 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h36-7-3" id="h36-7-3" class="i">+                    labels: [
</a><a href="#h36-7-4" id="h36-7-4" class="i">+                        None,
</a><a href="#h36-7-5" id="h36-7-5" class="i">+                        None,
</a><a href="#h36-7-6" id="h36-7-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h36-7-12" id="h36-7-12" class="d">-            labels: [
</a><a href="#h36-7-13" id="h36-7-13" class="d">-                None,
</a><a href="#h36-7-14" id="h36-7-14" class="d">-                Some(
</a><a href="#h36-7-15" id="h36-7-15" class="d">-                    (
</a><a href="#h36-7-16" id="h36-7-16" class="d">-                        None,
</a><a href="#h36-7-17" id="h36-7-17" class="d">-                        &quot;rating&quot;,
</a><a href="#h36-7-18" id="h36-7-18" class="d">-                    ),
</a><a href="#h36-7-19" id="h36-7-19" class="d">-                ),
</a><a href="#h36-7-20" id="h36-7-20" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h36-8" id="h36-8" class="h">@@ -382,6 +382,15 @@ Optimized plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h36-8-3" id="h36-8-3" class="i">+            labels: [
</a><a href="#h36-8-4" id="h36-8-4" class="i">+                None,
</a><a href="#h36-8-5" id="h36-8-5" class="i">+                Some(
</a><a href="#h36-8-6" id="h36-8-6" class="i">+                    (
</a><a href="#h36-8-7" id="h36-8-7" class="i">+                        None,
</a><a href="#h36-8-8" id="h36-8-8" class="i">+                        &quot;rating&quot;,
</a><a href="#h36-8-9" id="h36-8-9" class="i">+                    ),
</a><a href="#h36-8-10" id="h36-8-10" class="i">+                ),
</a><a href="#h36-8-11" id="h36-8-11" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h36-9" id="h36-9" class="h">@@ -398,5 +407,14 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h36-9-3" id="h36-9-3" class="d">-)
</a><a href="#h36-9-4" id="h36-9-4" class="i">+    labels: [
</a><a href="#h36-9-5" id="h36-9-5" class="i">+        None,
</a><a href="#h36-9-6" id="h36-9-6" class="i">+        Some(
</a><a href="#h36-9-7" id="h36-9-7" class="i">+            (
</a><a href="#h36-9-8" id="h36-9-8" class="i">+                None,
</a><a href="#h36-9-9" id="h36-9-9" class="i">+                &quot;rating&quot;,
</a><a href="#h36-9-10" id="h36-9-10" class="i">+            ),
</a><a href="#h36-9-11" id="h36-9-11" class="i">+        ),
</a><a href="#h36-9-12" id="h36-9-12" class="i">+    ],
</a><a href="#h36-9-13" id="h36-9-13" class="i">+}
</a> 
<b>diff --git a/<a id="h37" href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a> b/<a href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -3,7 +3,7 @@ Query: SELECT studio_id + genre_id AS multi, MAX(rating) AS rating FROM movies G
</a> Explain:
 Order: rating asc, multi asc
 └─ Projection: studio_id + genre_id, #0
<a href="#h37-0-3" id="h37-0-3" class="d">-   └─ Aggregation: maximum
</a><a href="#h37-0-4" id="h37-0-4" class="i">+   └─ Aggregation: max
</a>       └─ Projection: rating, studio_id, genre_id
          └─ Scan: movies
 
<a href="#h37-1" id="h37-1" class="h">@@ -88,8 +88,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h37-1-3" id="h37-1-3" class="d">-Plan: Select(
</a><a href="#h37-1-4" id="h37-1-4" class="d">-    Order {
</a><a href="#h37-1-5" id="h37-1-5" class="i">+Plan: Select {
</a><a href="#h37-1-6" id="h37-1-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h37-2" id="h37-2" class="h">@@ -171,14 +171,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h37-2-3" id="h37-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h37-2-5" id="h37-2-5" class="i">+                        alias: None,
</a>                     },
<a href="#h37-2-7" id="h37-2-7" class="d">-                    labels: [
</a><a href="#h37-2-8" id="h37-2-8" class="d">-                        None,
</a><a href="#h37-2-9" id="h37-2-9" class="d">-                        None,
</a><a href="#h37-2-10" id="h37-2-10" class="d">-                        None,
</a><a href="#h37-2-11" id="h37-2-11" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h37-3" id="h37-3" class="h">@@ -208,25 +203,16 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h37-3-3" id="h37-3-3" class="i">+                    labels: [
</a><a href="#h37-3-4" id="h37-3-4" class="i">+                        None,
</a><a href="#h37-3-5" id="h37-3-5" class="i">+                        None,
</a><a href="#h37-3-6" id="h37-3-6" class="i">+                        None,
</a><a href="#h37-3-7" id="h37-3-7" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h37-3-13" id="h37-3-13" class="d">-            labels: [
</a><a href="#h37-3-14" id="h37-3-14" class="d">-                Some(
</a><a href="#h37-3-15" id="h37-3-15" class="d">-                    (
</a><a href="#h37-3-16" id="h37-3-16" class="d">-                        None,
</a><a href="#h37-3-17" id="h37-3-17" class="d">-                        &quot;multi&quot;,
</a><a href="#h37-3-18" id="h37-3-18" class="d">-                    ),
</a><a href="#h37-3-19" id="h37-3-19" class="d">-                ),
</a><a href="#h37-3-20" id="h37-3-20" class="d">-                Some(
</a><a href="#h37-3-21" id="h37-3-21" class="d">-                    (
</a><a href="#h37-3-22" id="h37-3-22" class="d">-                        None,
</a><a href="#h37-3-23" id="h37-3-23" class="d">-                        &quot;rating&quot;,
</a><a href="#h37-3-24" id="h37-3-24" class="d">-                    ),
</a><a href="#h37-3-25" id="h37-3-25" class="d">-                ),
</a><a href="#h37-3-26" id="h37-3-26" class="d">-            ],
</a>             expressions: [
                 Add(
                     Field(
<a href="#h37-4" id="h37-4" class="h">@@ -253,6 +239,20 @@ Plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h37-4-3" id="h37-4-3" class="i">+            labels: [
</a><a href="#h37-4-4" id="h37-4-4" class="i">+                Some(
</a><a href="#h37-4-5" id="h37-4-5" class="i">+                    (
</a><a href="#h37-4-6" id="h37-4-6" class="i">+                        None,
</a><a href="#h37-4-7" id="h37-4-7" class="i">+                        &quot;multi&quot;,
</a><a href="#h37-4-8" id="h37-4-8" class="i">+                    ),
</a><a href="#h37-4-9" id="h37-4-9" class="i">+                ),
</a><a href="#h37-4-10" id="h37-4-10" class="i">+                Some(
</a><a href="#h37-4-11" id="h37-4-11" class="i">+                    (
</a><a href="#h37-4-12" id="h37-4-12" class="i">+                        None,
</a><a href="#h37-4-13" id="h37-4-13" class="i">+                        &quot;rating&quot;,
</a><a href="#h37-4-14" id="h37-4-14" class="i">+                    ),
</a><a href="#h37-4-15" id="h37-4-15" class="i">+                ),
</a><a href="#h37-4-16" id="h37-4-16" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h37-5" id="h37-5" class="h">@@ -281,10 +281,24 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h37-5-3" id="h37-5-3" class="d">-)
</a><a href="#h37-5-4" id="h37-5-4" class="i">+    labels: [
</a><a href="#h37-5-5" id="h37-5-5" class="i">+        Some(
</a><a href="#h37-5-6" id="h37-5-6" class="i">+            (
</a><a href="#h37-5-7" id="h37-5-7" class="i">+                None,
</a><a href="#h37-5-8" id="h37-5-8" class="i">+                &quot;multi&quot;,
</a><a href="#h37-5-9" id="h37-5-9" class="i">+            ),
</a><a href="#h37-5-10" id="h37-5-10" class="i">+        ),
</a><a href="#h37-5-11" id="h37-5-11" class="i">+        Some(
</a><a href="#h37-5-12" id="h37-5-12" class="i">+            (
</a><a href="#h37-5-13" id="h37-5-13" class="i">+                None,
</a><a href="#h37-5-14" id="h37-5-14" class="i">+                &quot;rating&quot;,
</a><a href="#h37-5-15" id="h37-5-15" class="i">+            ),
</a><a href="#h37-5-16" id="h37-5-16" class="i">+        ),
</a><a href="#h37-5-17" id="h37-5-17" class="i">+    ],
</a><a href="#h37-5-18" id="h37-5-18" class="i">+}
</a> 
<a href="#h37-5-20" id="h37-5-20" class="d">-Optimized plan: Select(
</a><a href="#h37-5-21" id="h37-5-21" class="d">-    Order {
</a><a href="#h37-5-22" id="h37-5-22" class="i">+Optimized plan: Select {
</a><a href="#h37-5-23" id="h37-5-23" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h37-6" id="h37-6" class="h">@@ -366,14 +380,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h37-6-3" id="h37-6-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h37-6-5" id="h37-6-5" class="i">+                        alias: None,
</a>                     },
<a href="#h37-6-7" id="h37-6-7" class="d">-                    labels: [
</a><a href="#h37-6-8" id="h37-6-8" class="d">-                        None,
</a><a href="#h37-6-9" id="h37-6-9" class="d">-                        None,
</a><a href="#h37-6-10" id="h37-6-10" class="d">-                        None,
</a><a href="#h37-6-11" id="h37-6-11" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h37-7" id="h37-7" class="h">@@ -403,25 +412,16 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h37-7-3" id="h37-7-3" class="i">+                    labels: [
</a><a href="#h37-7-4" id="h37-7-4" class="i">+                        None,
</a><a href="#h37-7-5" id="h37-7-5" class="i">+                        None,
</a><a href="#h37-7-6" id="h37-7-6" class="i">+                        None,
</a><a href="#h37-7-7" id="h37-7-7" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h37-7-13" id="h37-7-13" class="d">-            labels: [
</a><a href="#h37-7-14" id="h37-7-14" class="d">-                Some(
</a><a href="#h37-7-15" id="h37-7-15" class="d">-                    (
</a><a href="#h37-7-16" id="h37-7-16" class="d">-                        None,
</a><a href="#h37-7-17" id="h37-7-17" class="d">-                        &quot;multi&quot;,
</a><a href="#h37-7-18" id="h37-7-18" class="d">-                    ),
</a><a href="#h37-7-19" id="h37-7-19" class="d">-                ),
</a><a href="#h37-7-20" id="h37-7-20" class="d">-                Some(
</a><a href="#h37-7-21" id="h37-7-21" class="d">-                    (
</a><a href="#h37-7-22" id="h37-7-22" class="d">-                        None,
</a><a href="#h37-7-23" id="h37-7-23" class="d">-                        &quot;rating&quot;,
</a><a href="#h37-7-24" id="h37-7-24" class="d">-                    ),
</a><a href="#h37-7-25" id="h37-7-25" class="d">-                ),
</a><a href="#h37-7-26" id="h37-7-26" class="d">-            ],
</a>             expressions: [
                 Add(
                     Field(
<a href="#h37-8" id="h37-8" class="h">@@ -448,6 +448,20 @@ Optimized plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h37-8-3" id="h37-8-3" class="i">+            labels: [
</a><a href="#h37-8-4" id="h37-8-4" class="i">+                Some(
</a><a href="#h37-8-5" id="h37-8-5" class="i">+                    (
</a><a href="#h37-8-6" id="h37-8-6" class="i">+                        None,
</a><a href="#h37-8-7" id="h37-8-7" class="i">+                        &quot;multi&quot;,
</a><a href="#h37-8-8" id="h37-8-8" class="i">+                    ),
</a><a href="#h37-8-9" id="h37-8-9" class="i">+                ),
</a><a href="#h37-8-10" id="h37-8-10" class="i">+                Some(
</a><a href="#h37-8-11" id="h37-8-11" class="i">+                    (
</a><a href="#h37-8-12" id="h37-8-12" class="i">+                        None,
</a><a href="#h37-8-13" id="h37-8-13" class="i">+                        &quot;rating&quot;,
</a><a href="#h37-8-14" id="h37-8-14" class="i">+                    ),
</a><a href="#h37-8-15" id="h37-8-15" class="i">+                ),
</a><a href="#h37-8-16" id="h37-8-16" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h37-9" id="h37-9" class="h">@@ -476,5 +490,19 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h37-9-3" id="h37-9-3" class="d">-)
</a><a href="#h37-9-4" id="h37-9-4" class="i">+    labels: [
</a><a href="#h37-9-5" id="h37-9-5" class="i">+        Some(
</a><a href="#h37-9-6" id="h37-9-6" class="i">+            (
</a><a href="#h37-9-7" id="h37-9-7" class="i">+                None,
</a><a href="#h37-9-8" id="h37-9-8" class="i">+                &quot;multi&quot;,
</a><a href="#h37-9-9" id="h37-9-9" class="i">+            ),
</a><a href="#h37-9-10" id="h37-9-10" class="i">+        ),
</a><a href="#h37-9-11" id="h37-9-11" class="i">+        Some(
</a><a href="#h37-9-12" id="h37-9-12" class="i">+            (
</a><a href="#h37-9-13" id="h37-9-13" class="i">+                None,
</a><a href="#h37-9-14" id="h37-9-14" class="i">+                &quot;rating&quot;,
</a><a href="#h37-9-15" id="h37-9-15" class="i">+            ),
</a><a href="#h37-9-16" id="h37-9-16" class="i">+        ),
</a><a href="#h37-9-17" id="h37-9-17" class="i">+    ],
</a><a href="#h37-9-18" id="h37-9-18" class="i">+}
</a> 
<b>diff --git a/<a id="h38" href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a> b/<a href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -3,7 +3,7 @@ Query: SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_i
</a> Explain:
 Order: rating asc
 └─ Projection: studio_id * 2, #0
<a href="#h38-0-3" id="h38-0-3" class="d">-   └─ Aggregation: maximum
</a><a href="#h38-0-4" id="h38-0-4" class="i">+   └─ Aggregation: max
</a>       └─ Projection: rating, studio_id
          └─ Scan: movies
 
<a href="#h38-1" id="h38-1" class="h">@@ -73,8 +73,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h38-1-3" id="h38-1-3" class="d">-Plan: Select(
</a><a href="#h38-1-4" id="h38-1-4" class="d">-    Order {
</a><a href="#h38-1-5" id="h38-1-5" class="i">+Plan: Select {
</a><a href="#h38-1-6" id="h38-1-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h38-2" id="h38-2" class="h">@@ -156,13 +156,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h38-2-3" id="h38-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h38-2-5" id="h38-2-5" class="i">+                        alias: None,
</a>                     },
<a href="#h38-2-7" id="h38-2-7" class="d">-                    labels: [
</a><a href="#h38-2-8" id="h38-2-8" class="d">-                        None,
</a><a href="#h38-2-9" id="h38-2-9" class="d">-                        None,
</a><a href="#h38-2-10" id="h38-2-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h38-3" id="h38-3" class="h">@@ -183,20 +179,15 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h38-3-3" id="h38-3-3" class="i">+                    labels: [
</a><a href="#h38-3-4" id="h38-3-4" class="i">+                        None,
</a><a href="#h38-3-5" id="h38-3-5" class="i">+                        None,
</a><a href="#h38-3-6" id="h38-3-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h38-3-12" id="h38-3-12" class="d">-            labels: [
</a><a href="#h38-3-13" id="h38-3-13" class="d">-                None,
</a><a href="#h38-3-14" id="h38-3-14" class="d">-                Some(
</a><a href="#h38-3-15" id="h38-3-15" class="d">-                    (
</a><a href="#h38-3-16" id="h38-3-16" class="d">-                        None,
</a><a href="#h38-3-17" id="h38-3-17" class="d">-                        &quot;rating&quot;,
</a><a href="#h38-3-18" id="h38-3-18" class="d">-                    ),
</a><a href="#h38-3-19" id="h38-3-19" class="d">-                ),
</a><a href="#h38-3-20" id="h38-3-20" class="d">-            ],
</a>             expressions: [
                 Multiply(
                     Field(
<a href="#h38-4" id="h38-4" class="h">@@ -219,6 +210,15 @@ Plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h38-4-3" id="h38-4-3" class="i">+            labels: [
</a><a href="#h38-4-4" id="h38-4-4" class="i">+                None,
</a><a href="#h38-4-5" id="h38-4-5" class="i">+                Some(
</a><a href="#h38-4-6" id="h38-4-6" class="i">+                    (
</a><a href="#h38-4-7" id="h38-4-7" class="i">+                        None,
</a><a href="#h38-4-8" id="h38-4-8" class="i">+                        &quot;rating&quot;,
</a><a href="#h38-4-9" id="h38-4-9" class="i">+                    ),
</a><a href="#h38-4-10" id="h38-4-10" class="i">+                ),
</a><a href="#h38-4-11" id="h38-4-11" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h38-5" id="h38-5" class="h">@@ -235,10 +235,19 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h38-5-3" id="h38-5-3" class="d">-)
</a><a href="#h38-5-4" id="h38-5-4" class="i">+    labels: [
</a><a href="#h38-5-5" id="h38-5-5" class="i">+        None,
</a><a href="#h38-5-6" id="h38-5-6" class="i">+        Some(
</a><a href="#h38-5-7" id="h38-5-7" class="i">+            (
</a><a href="#h38-5-8" id="h38-5-8" class="i">+                None,
</a><a href="#h38-5-9" id="h38-5-9" class="i">+                &quot;rating&quot;,
</a><a href="#h38-5-10" id="h38-5-10" class="i">+            ),
</a><a href="#h38-5-11" id="h38-5-11" class="i">+        ),
</a><a href="#h38-5-12" id="h38-5-12" class="i">+    ],
</a><a href="#h38-5-13" id="h38-5-13" class="i">+}
</a> 
<a href="#h38-5-15" id="h38-5-15" class="d">-Optimized plan: Select(
</a><a href="#h38-5-16" id="h38-5-16" class="d">-    Order {
</a><a href="#h38-5-17" id="h38-5-17" class="i">+Optimized plan: Select {
</a><a href="#h38-5-18" id="h38-5-18" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h38-6" id="h38-6" class="h">@@ -320,13 +329,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h38-6-3" id="h38-6-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h38-6-5" id="h38-6-5" class="i">+                        alias: None,
</a>                     },
<a href="#h38-6-7" id="h38-6-7" class="d">-                    labels: [
</a><a href="#h38-6-8" id="h38-6-8" class="d">-                        None,
</a><a href="#h38-6-9" id="h38-6-9" class="d">-                        None,
</a><a href="#h38-6-10" id="h38-6-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h38-7" id="h38-7" class="h">@@ -347,20 +352,15 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h38-7-3" id="h38-7-3" class="i">+                    labels: [
</a><a href="#h38-7-4" id="h38-7-4" class="i">+                        None,
</a><a href="#h38-7-5" id="h38-7-5" class="i">+                        None,
</a><a href="#h38-7-6" id="h38-7-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h38-7-12" id="h38-7-12" class="d">-            labels: [
</a><a href="#h38-7-13" id="h38-7-13" class="d">-                None,
</a><a href="#h38-7-14" id="h38-7-14" class="d">-                Some(
</a><a href="#h38-7-15" id="h38-7-15" class="d">-                    (
</a><a href="#h38-7-16" id="h38-7-16" class="d">-                        None,
</a><a href="#h38-7-17" id="h38-7-17" class="d">-                        &quot;rating&quot;,
</a><a href="#h38-7-18" id="h38-7-18" class="d">-                    ),
</a><a href="#h38-7-19" id="h38-7-19" class="d">-                ),
</a><a href="#h38-7-20" id="h38-7-20" class="d">-            ],
</a>             expressions: [
                 Multiply(
                     Field(
<a href="#h38-8" id="h38-8" class="h">@@ -383,6 +383,15 @@ Optimized plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h38-8-3" id="h38-8-3" class="i">+            labels: [
</a><a href="#h38-8-4" id="h38-8-4" class="i">+                None,
</a><a href="#h38-8-5" id="h38-8-5" class="i">+                Some(
</a><a href="#h38-8-6" id="h38-8-6" class="i">+                    (
</a><a href="#h38-8-7" id="h38-8-7" class="i">+                        None,
</a><a href="#h38-8-8" id="h38-8-8" class="i">+                        &quot;rating&quot;,
</a><a href="#h38-8-9" id="h38-8-9" class="i">+                    ),
</a><a href="#h38-8-10" id="h38-8-10" class="i">+                ),
</a><a href="#h38-8-11" id="h38-8-11" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h38-9" id="h38-9" class="h">@@ -399,5 +408,14 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h38-9-3" id="h38-9-3" class="d">-)
</a><a href="#h38-9-4" id="h38-9-4" class="i">+    labels: [
</a><a href="#h38-9-5" id="h38-9-5" class="i">+        None,
</a><a href="#h38-9-6" id="h38-9-6" class="i">+        Some(
</a><a href="#h38-9-7" id="h38-9-7" class="i">+            (
</a><a href="#h38-9-8" id="h38-9-8" class="i">+                None,
</a><a href="#h38-9-9" id="h38-9-9" class="i">+                &quot;rating&quot;,
</a><a href="#h38-9-10" id="h38-9-10" class="i">+            ),
</a><a href="#h38-9-11" id="h38-9-11" class="i">+        ),
</a><a href="#h38-9-12" id="h38-9-12" class="i">+    ],
</a><a href="#h38-9-13" id="h38-9-13" class="i">+}
</a> 
<b>diff --git a/<a id="h39" href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a> b/<a href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -100,8 +100,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h39-0-3" id="h39-0-3" class="d">-Plan: Select(
</a><a href="#h39-0-4" id="h39-0-4" class="d">-    Order {
</a><a href="#h39-0-5" id="h39-0-5" class="i">+Plan: Select {
</a><a href="#h39-0-6" id="h39-0-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h39-1" id="h39-1" class="h">@@ -184,10 +184,10 @@ Plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h39-1-3" id="h39-1-3" class="i">+                            filter: None,
</a>                             alias: Some(
                                 &quot;m&quot;,
                             ),
<a href="#h39-1-7" id="h39-1-7" class="d">-                            filter: None,
</a>                         },
                         left_size: 7,
                         right: Scan {
<a href="#h39-2" id="h39-2" class="h">@@ -228,10 +228,10 @@ Plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h39-2-3" id="h39-2-3" class="i">+                            filter: None,
</a>                             alias: Some(
                                 &quot;s&quot;,
                             ),
<a href="#h39-2-7" id="h39-2-7" class="d">-                            filter: None,
</a>                         },
                         predicate: Some(
                             Equal(
<a href="#h39-3" id="h39-3" class="h">@@ -261,10 +261,6 @@ Plan: Select(
</a>                         ),
                         outer: false,
                     },
<a href="#h39-3-3" id="h39-3-3" class="d">-                    labels: [
</a><a href="#h39-3-4" id="h39-3-4" class="d">-                        None,
</a><a href="#h39-3-5" id="h39-3-5" class="d">-                        None,
</a><a href="#h39-3-6" id="h39-3-6" class="d">-                    ],
</a>                     expressions: [
                         Constant(
                             Boolean(
<a href="#h39-4" id="h39-4" class="h">@@ -283,15 +279,15 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h39-4-3" id="h39-4-3" class="i">+                    labels: [
</a><a href="#h39-4-4" id="h39-4-4" class="i">+                        None,
</a><a href="#h39-4-5" id="h39-4-5" class="i">+                        None,
</a><a href="#h39-4-6" id="h39-4-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Count,
                 ],
             },
<a href="#h39-4-12" id="h39-4-12" class="d">-            labels: [
</a><a href="#h39-4-13" id="h39-4-13" class="d">-                None,
</a><a href="#h39-4-14" id="h39-4-14" class="d">-                None,
</a><a href="#h39-4-15" id="h39-4-15" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h39-5" id="h39-5" class="h">@@ -309,6 +305,10 @@ Plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h39-5-3" id="h39-5-3" class="i">+            labels: [
</a><a href="#h39-5-4" id="h39-5-4" class="i">+                None,
</a><a href="#h39-5-5" id="h39-5-5" class="i">+                None,
</a><a href="#h39-5-6" id="h39-5-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h39-6" id="h39-6" class="h">@@ -327,10 +327,21 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h39-6-3" id="h39-6-3" class="d">-)
</a><a href="#h39-6-4" id="h39-6-4" class="i">+    labels: [
</a><a href="#h39-6-5" id="h39-6-5" class="i">+        Some(
</a><a href="#h39-6-6" id="h39-6-6" class="i">+            (
</a><a href="#h39-6-7" id="h39-6-7" class="i">+                Some(
</a><a href="#h39-6-8" id="h39-6-8" class="i">+                    &quot;s&quot;,
</a><a href="#h39-6-9" id="h39-6-9" class="i">+                ),
</a><a href="#h39-6-10" id="h39-6-10" class="i">+                &quot;name&quot;,
</a><a href="#h39-6-11" id="h39-6-11" class="i">+            ),
</a><a href="#h39-6-12" id="h39-6-12" class="i">+        ),
</a><a href="#h39-6-13" id="h39-6-13" class="i">+        None,
</a><a href="#h39-6-14" id="h39-6-14" class="i">+    ],
</a><a href="#h39-6-15" id="h39-6-15" class="i">+}
</a> 
<a href="#h39-6-17" id="h39-6-17" class="d">-Optimized plan: Select(
</a><a href="#h39-6-18" id="h39-6-18" class="d">-    Order {
</a><a href="#h39-6-19" id="h39-6-19" class="i">+Optimized plan: Select {
</a><a href="#h39-6-20" id="h39-6-20" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h39-7" id="h39-7" class="h">@@ -413,10 +424,10 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h39-7-3" id="h39-7-3" class="i">+                            filter: None,
</a>                             alias: Some(
                                 &quot;m&quot;,
                             ),
<a href="#h39-7-7" id="h39-7-7" class="d">-                            filter: None,
</a>                         },
                         left_field: (
                             2,
<a href="#h39-8" id="h39-8" class="h">@@ -467,10 +478,10 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h39-8-3" id="h39-8-3" class="i">+                            filter: None,
</a>                             alias: Some(
                                 &quot;s&quot;,
                             ),
<a href="#h39-8-7" id="h39-8-7" class="d">-                            filter: None,
</a>                         },
                         right_field: (
                             0,
<a href="#h39-9" id="h39-9" class="h">@@ -485,10 +496,6 @@ Optimized plan: Select(
</a>                         ),
                         outer: false,
                     },
<a href="#h39-9-3" id="h39-9-3" class="d">-                    labels: [
</a><a href="#h39-9-4" id="h39-9-4" class="d">-                        None,
</a><a href="#h39-9-5" id="h39-9-5" class="d">-                        None,
</a><a href="#h39-9-6" id="h39-9-6" class="d">-                    ],
</a>                     expressions: [
                         Constant(
                             Boolean(
<a href="#h39-10" id="h39-10" class="h">@@ -507,15 +514,15 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h39-10-3" id="h39-10-3" class="i">+                    labels: [
</a><a href="#h39-10-4" id="h39-10-4" class="i">+                        None,
</a><a href="#h39-10-5" id="h39-10-5" class="i">+                        None,
</a><a href="#h39-10-6" id="h39-10-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Count,
                 ],
             },
<a href="#h39-10-12" id="h39-10-12" class="d">-            labels: [
</a><a href="#h39-10-13" id="h39-10-13" class="d">-                None,
</a><a href="#h39-10-14" id="h39-10-14" class="d">-                None,
</a><a href="#h39-10-15" id="h39-10-15" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h39-11" id="h39-11" class="h">@@ -533,6 +540,10 @@ Optimized plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h39-11-3" id="h39-11-3" class="i">+            labels: [
</a><a href="#h39-11-4" id="h39-11-4" class="i">+                None,
</a><a href="#h39-11-5" id="h39-11-5" class="i">+                None,
</a><a href="#h39-11-6" id="h39-11-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h39-12" id="h39-12" class="h">@@ -551,5 +562,16 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h39-12-3" id="h39-12-3" class="d">-)
</a><a href="#h39-12-4" id="h39-12-4" class="i">+    labels: [
</a><a href="#h39-12-5" id="h39-12-5" class="i">+        Some(
</a><a href="#h39-12-6" id="h39-12-6" class="i">+            (
</a><a href="#h39-12-7" id="h39-12-7" class="i">+                Some(
</a><a href="#h39-12-8" id="h39-12-8" class="i">+                    &quot;s&quot;,
</a><a href="#h39-12-9" id="h39-12-9" class="i">+                ),
</a><a href="#h39-12-10" id="h39-12-10" class="i">+                &quot;name&quot;,
</a><a href="#h39-12-11" id="h39-12-11" class="i">+            ),
</a><a href="#h39-12-12" id="h39-12-12" class="i">+        ),
</a><a href="#h39-12-13" id="h39-12-13" class="i">+        None,
</a><a href="#h39-12-14" id="h39-12-14" class="i">+    ],
</a><a href="#h39-12-15" id="h39-12-15" class="i">+}
</a> 
<b>diff --git a/<a id="h40" href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a> b/<a href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -56,8 +56,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h40-0-3" id="h40-0-3" class="d">-Plan: Select(
</a><a href="#h40-0-4" id="h40-0-4" class="d">-    Order {
</a><a href="#h40-0-5" id="h40-0-5" class="i">+Plan: Select {
</a><a href="#h40-0-6" id="h40-0-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h40-1" id="h40-1" class="h">@@ -139,12 +139,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h40-1-3" id="h40-1-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h40-1-5" id="h40-1-5" class="i">+                        alias: None,
</a>                     },
<a href="#h40-1-7" id="h40-1-7" class="d">-                    labels: [
</a><a href="#h40-1-8" id="h40-1-8" class="d">-                        None,
</a><a href="#h40-1-9" id="h40-1-9" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             1,
<a href="#h40-2" id="h40-2" class="h">@@ -156,12 +153,12 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h40-2-3" id="h40-2-3" class="i">+                    labels: [
</a><a href="#h40-2-4" id="h40-2-4" class="i">+                        None,
</a><a href="#h40-2-5" id="h40-2-5" class="i">+                    ],
</a>                 },
                 aggregates: [],
             },
<a href="#h40-2-9" id="h40-2-9" class="d">-            labels: [
</a><a href="#h40-2-10" id="h40-2-10" class="d">-                None,
</a><a href="#h40-2-11" id="h40-2-11" class="d">-            ],
</a>             expressions: [
                 Field(
                     0,
<a href="#h40-3" id="h40-3" class="h">@@ -175,6 +172,9 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h40-3-3" id="h40-3-3" class="i">+            labels: [
</a><a href="#h40-3-4" id="h40-3-4" class="i">+                None,
</a><a href="#h40-3-5" id="h40-3-5" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h40-4" id="h40-4" class="h">@@ -193,10 +193,20 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h40-4-3" id="h40-4-3" class="d">-)
</a><a href="#h40-4-4" id="h40-4-4" class="i">+    labels: [
</a><a href="#h40-4-5" id="h40-4-5" class="i">+        Some(
</a><a href="#h40-4-6" id="h40-4-6" class="i">+            (
</a><a href="#h40-4-7" id="h40-4-7" class="i">+                Some(
</a><a href="#h40-4-8" id="h40-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h40-4-9" id="h40-4-9" class="i">+                ),
</a><a href="#h40-4-10" id="h40-4-10" class="i">+                &quot;title&quot;,
</a><a href="#h40-4-11" id="h40-4-11" class="i">+            ),
</a><a href="#h40-4-12" id="h40-4-12" class="i">+        ),
</a><a href="#h40-4-13" id="h40-4-13" class="i">+    ],
</a><a href="#h40-4-14" id="h40-4-14" class="i">+}
</a> 
<a href="#h40-4-16" id="h40-4-16" class="d">-Optimized plan: Select(
</a><a href="#h40-4-17" id="h40-4-17" class="d">-    Order {
</a><a href="#h40-4-18" id="h40-4-18" class="i">+Optimized plan: Select {
</a><a href="#h40-4-19" id="h40-4-19" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h40-5" id="h40-5" class="h">@@ -278,12 +288,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h40-5-3" id="h40-5-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h40-5-5" id="h40-5-5" class="i">+                        alias: None,
</a>                     },
<a href="#h40-5-7" id="h40-5-7" class="d">-                    labels: [
</a><a href="#h40-5-8" id="h40-5-8" class="d">-                        None,
</a><a href="#h40-5-9" id="h40-5-9" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             1,
<a href="#h40-6" id="h40-6" class="h">@@ -295,12 +302,12 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h40-6-3" id="h40-6-3" class="i">+                    labels: [
</a><a href="#h40-6-4" id="h40-6-4" class="i">+                        None,
</a><a href="#h40-6-5" id="h40-6-5" class="i">+                    ],
</a>                 },
                 aggregates: [],
             },
<a href="#h40-6-9" id="h40-6-9" class="d">-            labels: [
</a><a href="#h40-6-10" id="h40-6-10" class="d">-                None,
</a><a href="#h40-6-11" id="h40-6-11" class="d">-            ],
</a>             expressions: [
                 Field(
                     0,
<a href="#h40-7" id="h40-7" class="h">@@ -314,6 +321,9 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h40-7-3" id="h40-7-3" class="i">+            labels: [
</a><a href="#h40-7-4" id="h40-7-4" class="i">+                None,
</a><a href="#h40-7-5" id="h40-7-5" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h40-8" id="h40-8" class="h">@@ -332,5 +342,15 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h40-8-3" id="h40-8-3" class="d">-)
</a><a href="#h40-8-4" id="h40-8-4" class="i">+    labels: [
</a><a href="#h40-8-5" id="h40-8-5" class="i">+        Some(
</a><a href="#h40-8-6" id="h40-8-6" class="i">+            (
</a><a href="#h40-8-7" id="h40-8-7" class="i">+                Some(
</a><a href="#h40-8-8" id="h40-8-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h40-8-9" id="h40-8-9" class="i">+                ),
</a><a href="#h40-8-10" id="h40-8-10" class="i">+                &quot;title&quot;,
</a><a href="#h40-8-11" id="h40-8-11" class="i">+            ),
</a><a href="#h40-8-12" id="h40-8-12" class="i">+        ),
</a><a href="#h40-8-13" id="h40-8-13" class="i">+    ],
</a><a href="#h40-8-14" id="h40-8-14" class="i">+}
</a> 
<b>diff --git a/<a id="h41" href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a> b/<a href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -3,7 +3,7 @@ Query: SELECT MAX(rating) AS best FROM movies GROUP BY studio_id ORDER BY best D
</a> Explain:
 Order: best desc
 └─ Projection: #0
<a href="#h41-0-3" id="h41-0-3" class="d">-   └─ Aggregation: maximum
</a><a href="#h41-0-4" id="h41-0-4" class="i">+   └─ Aggregation: max
</a>       └─ Projection: rating, studio_id
          └─ Scan: movies
 
<a href="#h41-1" id="h41-1" class="h">@@ -57,8 +57,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h41-1-3" id="h41-1-3" class="d">-Plan: Select(
</a><a href="#h41-1-4" id="h41-1-4" class="d">-    Order {
</a><a href="#h41-1-5" id="h41-1-5" class="i">+Plan: Select {
</a><a href="#h41-1-6" id="h41-1-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h41-2" id="h41-2" class="h">@@ -140,13 +140,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h41-2-3" id="h41-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h41-2-5" id="h41-2-5" class="i">+                        alias: None,
</a>                     },
<a href="#h41-2-7" id="h41-2-7" class="d">-                    labels: [
</a><a href="#h41-2-8" id="h41-2-8" class="d">-                        None,
</a><a href="#h41-2-9" id="h41-2-9" class="d">-                        None,
</a><a href="#h41-2-10" id="h41-2-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h41-3" id="h41-3" class="h">@@ -167,11 +163,21 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h41-3-3" id="h41-3-3" class="i">+                    labels: [
</a><a href="#h41-3-4" id="h41-3-4" class="i">+                        None,
</a><a href="#h41-3-5" id="h41-3-5" class="i">+                        None,
</a><a href="#h41-3-6" id="h41-3-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h41-3-12" id="h41-3-12" class="i">+            expressions: [
</a><a href="#h41-3-13" id="h41-3-13" class="i">+                Field(
</a><a href="#h41-3-14" id="h41-3-14" class="i">+                    0,
</a><a href="#h41-3-15" id="h41-3-15" class="i">+                    None,
</a><a href="#h41-3-16" id="h41-3-16" class="i">+                ),
</a><a href="#h41-3-17" id="h41-3-17" class="i">+            ],
</a>             labels: [
                 Some(
                     (
<a href="#h41-4" id="h41-4" class="h">@@ -180,12 +186,6 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h41-4-3" id="h41-4-3" class="d">-            expressions: [
</a><a href="#h41-4-4" id="h41-4-4" class="d">-                Field(
</a><a href="#h41-4-5" id="h41-4-5" class="d">-                    0,
</a><a href="#h41-4-6" id="h41-4-6" class="d">-                    None,
</a><a href="#h41-4-7" id="h41-4-7" class="d">-                ),
</a><a href="#h41-4-8" id="h41-4-8" class="d">-            ],
</a>         },
         orders: [
             (
<a href="#h41-5" id="h41-5" class="h">@@ -202,10 +202,18 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h41-5-3" id="h41-5-3" class="d">-)
</a><a href="#h41-5-4" id="h41-5-4" class="i">+    labels: [
</a><a href="#h41-5-5" id="h41-5-5" class="i">+        Some(
</a><a href="#h41-5-6" id="h41-5-6" class="i">+            (
</a><a href="#h41-5-7" id="h41-5-7" class="i">+                None,
</a><a href="#h41-5-8" id="h41-5-8" class="i">+                &quot;best&quot;,
</a><a href="#h41-5-9" id="h41-5-9" class="i">+            ),
</a><a href="#h41-5-10" id="h41-5-10" class="i">+        ),
</a><a href="#h41-5-11" id="h41-5-11" class="i">+    ],
</a><a href="#h41-5-12" id="h41-5-12" class="i">+}
</a> 
<a href="#h41-5-14" id="h41-5-14" class="d">-Optimized plan: Select(
</a><a href="#h41-5-15" id="h41-5-15" class="d">-    Order {
</a><a href="#h41-5-16" id="h41-5-16" class="i">+Optimized plan: Select {
</a><a href="#h41-5-17" id="h41-5-17" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h41-6" id="h41-6" class="h">@@ -287,13 +295,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h41-6-3" id="h41-6-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h41-6-5" id="h41-6-5" class="i">+                        alias: None,
</a>                     },
<a href="#h41-6-7" id="h41-6-7" class="d">-                    labels: [
</a><a href="#h41-6-8" id="h41-6-8" class="d">-                        None,
</a><a href="#h41-6-9" id="h41-6-9" class="d">-                        None,
</a><a href="#h41-6-10" id="h41-6-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h41-7" id="h41-7" class="h">@@ -314,11 +318,21 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h41-7-3" id="h41-7-3" class="i">+                    labels: [
</a><a href="#h41-7-4" id="h41-7-4" class="i">+                        None,
</a><a href="#h41-7-5" id="h41-7-5" class="i">+                        None,
</a><a href="#h41-7-6" id="h41-7-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h41-7-12" id="h41-7-12" class="i">+            expressions: [
</a><a href="#h41-7-13" id="h41-7-13" class="i">+                Field(
</a><a href="#h41-7-14" id="h41-7-14" class="i">+                    0,
</a><a href="#h41-7-15" id="h41-7-15" class="i">+                    None,
</a><a href="#h41-7-16" id="h41-7-16" class="i">+                ),
</a><a href="#h41-7-17" id="h41-7-17" class="i">+            ],
</a>             labels: [
                 Some(
                     (
<a href="#h41-8" id="h41-8" class="h">@@ -327,12 +341,6 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h41-8-3" id="h41-8-3" class="d">-            expressions: [
</a><a href="#h41-8-4" id="h41-8-4" class="d">-                Field(
</a><a href="#h41-8-5" id="h41-8-5" class="d">-                    0,
</a><a href="#h41-8-6" id="h41-8-6" class="d">-                    None,
</a><a href="#h41-8-7" id="h41-8-7" class="d">-                ),
</a><a href="#h41-8-8" id="h41-8-8" class="d">-            ],
</a>         },
         orders: [
             (
<a href="#h41-9" id="h41-9" class="h">@@ -349,5 +357,13 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h41-9-3" id="h41-9-3" class="d">-)
</a><a href="#h41-9-4" id="h41-9-4" class="i">+    labels: [
</a><a href="#h41-9-5" id="h41-9-5" class="i">+        Some(
</a><a href="#h41-9-6" id="h41-9-6" class="i">+            (
</a><a href="#h41-9-7" id="h41-9-7" class="i">+                None,
</a><a href="#h41-9-8" id="h41-9-8" class="i">+                &quot;best&quot;,
</a><a href="#h41-9-9" id="h41-9-9" class="i">+            ),
</a><a href="#h41-9-10" id="h41-9-10" class="i">+        ),
</a><a href="#h41-9-11" id="h41-9-11" class="i">+    ],
</a><a href="#h41-9-12" id="h41-9-12" class="i">+}
</a> 
<b>diff --git a/<a id="h42" href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a> b/<a href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -3,7 +3,7 @@ Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY stu
</a> Explain:
 Order: movies.studio_id asc
 └─ Projection: movies.studio_id, #0
<a href="#h42-0-3" id="h42-0-3" class="d">-   └─ Aggregation: maximum
</a><a href="#h42-0-4" id="h42-0-4" class="i">+   └─ Aggregation: max
</a>       └─ Projection: rating, studio_id
          └─ Scan: movies
 
<a href="#h42-1" id="h42-1" class="h">@@ -62,8 +62,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h42-1-3" id="h42-1-3" class="d">-Plan: Select(
</a><a href="#h42-1-4" id="h42-1-4" class="d">-    Order {
</a><a href="#h42-1-5" id="h42-1-5" class="i">+Plan: Select {
</a><a href="#h42-1-6" id="h42-1-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h42-2" id="h42-2" class="h">@@ -145,13 +145,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h42-2-3" id="h42-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h42-2-5" id="h42-2-5" class="i">+                        alias: None,
</a>                     },
<a href="#h42-2-7" id="h42-2-7" class="d">-                    labels: [
</a><a href="#h42-2-8" id="h42-2-8" class="d">-                        None,
</a><a href="#h42-2-9" id="h42-2-9" class="d">-                        None,
</a><a href="#h42-2-10" id="h42-2-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h42-3" id="h42-3" class="h">@@ -172,15 +168,15 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h42-3-3" id="h42-3-3" class="i">+                    labels: [
</a><a href="#h42-3-4" id="h42-3-4" class="i">+                        None,
</a><a href="#h42-3-5" id="h42-3-5" class="i">+                        None,
</a><a href="#h42-3-6" id="h42-3-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h42-3-12" id="h42-3-12" class="d">-            labels: [
</a><a href="#h42-3-13" id="h42-3-13" class="d">-                None,
</a><a href="#h42-3-14" id="h42-3-14" class="d">-                None,
</a><a href="#h42-3-15" id="h42-3-15" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h42-4" id="h42-4" class="h">@@ -198,6 +194,10 @@ Plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h42-4-3" id="h42-4-3" class="i">+            labels: [
</a><a href="#h42-4-4" id="h42-4-4" class="i">+                None,
</a><a href="#h42-4-5" id="h42-4-5" class="i">+                None,
</a><a href="#h42-4-6" id="h42-4-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h42-5" id="h42-5" class="h">@@ -216,10 +216,21 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h42-5-3" id="h42-5-3" class="d">-)
</a><a href="#h42-5-4" id="h42-5-4" class="i">+    labels: [
</a><a href="#h42-5-5" id="h42-5-5" class="i">+        Some(
</a><a href="#h42-5-6" id="h42-5-6" class="i">+            (
</a><a href="#h42-5-7" id="h42-5-7" class="i">+                Some(
</a><a href="#h42-5-8" id="h42-5-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h42-5-9" id="h42-5-9" class="i">+                ),
</a><a href="#h42-5-10" id="h42-5-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h42-5-11" id="h42-5-11" class="i">+            ),
</a><a href="#h42-5-12" id="h42-5-12" class="i">+        ),
</a><a href="#h42-5-13" id="h42-5-13" class="i">+        None,
</a><a href="#h42-5-14" id="h42-5-14" class="i">+    ],
</a><a href="#h42-5-15" id="h42-5-15" class="i">+}
</a> 
<a href="#h42-5-17" id="h42-5-17" class="d">-Optimized plan: Select(
</a><a href="#h42-5-18" id="h42-5-18" class="d">-    Order {
</a><a href="#h42-5-19" id="h42-5-19" class="i">+Optimized plan: Select {
</a><a href="#h42-5-20" id="h42-5-20" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h42-6" id="h42-6" class="h">@@ -301,13 +312,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h42-6-3" id="h42-6-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h42-6-5" id="h42-6-5" class="i">+                        alias: None,
</a>                     },
<a href="#h42-6-7" id="h42-6-7" class="d">-                    labels: [
</a><a href="#h42-6-8" id="h42-6-8" class="d">-                        None,
</a><a href="#h42-6-9" id="h42-6-9" class="d">-                        None,
</a><a href="#h42-6-10" id="h42-6-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h42-7" id="h42-7" class="h">@@ -328,15 +335,15 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h42-7-3" id="h42-7-3" class="i">+                    labels: [
</a><a href="#h42-7-4" id="h42-7-4" class="i">+                        None,
</a><a href="#h42-7-5" id="h42-7-5" class="i">+                        None,
</a><a href="#h42-7-6" id="h42-7-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h42-7-12" id="h42-7-12" class="d">-            labels: [
</a><a href="#h42-7-13" id="h42-7-13" class="d">-                None,
</a><a href="#h42-7-14" id="h42-7-14" class="d">-                None,
</a><a href="#h42-7-15" id="h42-7-15" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h42-8" id="h42-8" class="h">@@ -354,6 +361,10 @@ Optimized plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h42-8-3" id="h42-8-3" class="i">+            labels: [
</a><a href="#h42-8-4" id="h42-8-4" class="i">+                None,
</a><a href="#h42-8-5" id="h42-8-5" class="i">+                None,
</a><a href="#h42-8-6" id="h42-8-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h42-9" id="h42-9" class="h">@@ -372,5 +383,16 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h42-9-3" id="h42-9-3" class="d">-)
</a><a href="#h42-9-4" id="h42-9-4" class="i">+    labels: [
</a><a href="#h42-9-5" id="h42-9-5" class="i">+        Some(
</a><a href="#h42-9-6" id="h42-9-6" class="i">+            (
</a><a href="#h42-9-7" id="h42-9-7" class="i">+                Some(
</a><a href="#h42-9-8" id="h42-9-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h42-9-9" id="h42-9-9" class="i">+                ),
</a><a href="#h42-9-10" id="h42-9-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h42-9-11" id="h42-9-11" class="i">+            ),
</a><a href="#h42-9-12" id="h42-9-12" class="i">+        ),
</a><a href="#h42-9-13" id="h42-9-13" class="i">+        None,
</a><a href="#h42-9-14" id="h42-9-14" class="i">+    ],
</a><a href="#h42-9-15" id="h42-9-15" class="i">+}
</a> 
<b>diff --git a/<a id="h43" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -4,7 +4,7 @@ Explain:
</a> Order: movies.studio_id asc
 └─ Filter: rating &gt; 8
    └─ Projection: movies.studio_id, #0
<a href="#h43-0-3" id="h43-0-3" class="d">-      └─ Aggregation: maximum
</a><a href="#h43-0-4" id="h43-0-4" class="i">+      └─ Aggregation: max
</a>          └─ Projection: rating, studio_id
             └─ Scan: movies
 
<a href="#h43-1" id="h43-1" class="h">@@ -77,8 +77,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h43-1-3" id="h43-1-3" class="d">-Plan: Select(
</a><a href="#h43-1-4" id="h43-1-4" class="d">-    Order {
</a><a href="#h43-1-5" id="h43-1-5" class="i">+Plan: Select {
</a><a href="#h43-1-6" id="h43-1-6" class="i">+    root: Order {
</a>         source: Filter {
             source: Projection {
                 source: Aggregation {
<a href="#h43-2" id="h43-2" class="h">@@ -161,13 +161,9 @@ Plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h43-2-3" id="h43-2-3" class="d">-                            alias: None,
</a>                             filter: None,
<a href="#h43-2-5" id="h43-2-5" class="i">+                            alias: None,
</a>                         },
<a href="#h43-2-7" id="h43-2-7" class="d">-                        labels: [
</a><a href="#h43-2-8" id="h43-2-8" class="d">-                            None,
</a><a href="#h43-2-9" id="h43-2-9" class="d">-                            None,
</a><a href="#h43-2-10" id="h43-2-10" class="d">-                        ],
</a>                         expressions: [
                             Field(
                                 5,
<a href="#h43-3" id="h43-3" class="h">@@ -188,20 +184,15 @@ Plan: Select(
</a>                                 ),
                             ),
                         ],
<a href="#h43-3-3" id="h43-3-3" class="i">+                        labels: [
</a><a href="#h43-3-4" id="h43-3-4" class="i">+                            None,
</a><a href="#h43-3-5" id="h43-3-5" class="i">+                            None,
</a><a href="#h43-3-6" id="h43-3-6" class="i">+                        ],
</a>                     },
                     aggregates: [
                         Max,
                     ],
                 },
<a href="#h43-3-12" id="h43-3-12" class="d">-                labels: [
</a><a href="#h43-3-13" id="h43-3-13" class="d">-                    None,
</a><a href="#h43-3-14" id="h43-3-14" class="d">-                    Some(
</a><a href="#h43-3-15" id="h43-3-15" class="d">-                        (
</a><a href="#h43-3-16" id="h43-3-16" class="d">-                            None,
</a><a href="#h43-3-17" id="h43-3-17" class="d">-                            &quot;rating&quot;,
</a><a href="#h43-3-18" id="h43-3-18" class="d">-                        ),
</a><a href="#h43-3-19" id="h43-3-19" class="d">-                    ),
</a><a href="#h43-3-20" id="h43-3-20" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h43-4" id="h43-4" class="h">@@ -219,6 +210,15 @@ Plan: Select(
</a>                         None,
                     ),
                 ],
<a href="#h43-4-3" id="h43-4-3" class="i">+                labels: [
</a><a href="#h43-4-4" id="h43-4-4" class="i">+                    None,
</a><a href="#h43-4-5" id="h43-4-5" class="i">+                    Some(
</a><a href="#h43-4-6" id="h43-4-6" class="i">+                        (
</a><a href="#h43-4-7" id="h43-4-7" class="i">+                            None,
</a><a href="#h43-4-8" id="h43-4-8" class="i">+                            &quot;rating&quot;,
</a><a href="#h43-4-9" id="h43-4-9" class="i">+                        ),
</a><a href="#h43-4-10" id="h43-4-10" class="i">+                    ),
</a><a href="#h43-4-11" id="h43-4-11" class="i">+                ],
</a>             },
             predicate: GreaterThan(
                 Field(
<a href="#h43-5" id="h43-5" class="h">@@ -254,10 +254,26 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h43-5-3" id="h43-5-3" class="d">-)
</a><a href="#h43-5-4" id="h43-5-4" class="i">+    labels: [
</a><a href="#h43-5-5" id="h43-5-5" class="i">+        Some(
</a><a href="#h43-5-6" id="h43-5-6" class="i">+            (
</a><a href="#h43-5-7" id="h43-5-7" class="i">+                Some(
</a><a href="#h43-5-8" id="h43-5-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h43-5-9" id="h43-5-9" class="i">+                ),
</a><a href="#h43-5-10" id="h43-5-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h43-5-11" id="h43-5-11" class="i">+            ),
</a><a href="#h43-5-12" id="h43-5-12" class="i">+        ),
</a><a href="#h43-5-13" id="h43-5-13" class="i">+        Some(
</a><a href="#h43-5-14" id="h43-5-14" class="i">+            (
</a><a href="#h43-5-15" id="h43-5-15" class="i">+                None,
</a><a href="#h43-5-16" id="h43-5-16" class="i">+                &quot;rating&quot;,
</a><a href="#h43-5-17" id="h43-5-17" class="i">+            ),
</a><a href="#h43-5-18" id="h43-5-18" class="i">+        ),
</a><a href="#h43-5-19" id="h43-5-19" class="i">+    ],
</a><a href="#h43-5-20" id="h43-5-20" class="i">+}
</a> 
<a href="#h43-5-22" id="h43-5-22" class="d">-Optimized plan: Select(
</a><a href="#h43-5-23" id="h43-5-23" class="d">-    Order {
</a><a href="#h43-5-24" id="h43-5-24" class="i">+Optimized plan: Select {
</a><a href="#h43-5-25" id="h43-5-25" class="i">+    root: Order {
</a>         source: Filter {
             source: Projection {
                 source: Aggregation {
<a href="#h43-6" id="h43-6" class="h">@@ -340,13 +356,9 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h43-6-3" id="h43-6-3" class="d">-                            alias: None,
</a>                             filter: None,
<a href="#h43-6-5" id="h43-6-5" class="i">+                            alias: None,
</a>                         },
<a href="#h43-6-7" id="h43-6-7" class="d">-                        labels: [
</a><a href="#h43-6-8" id="h43-6-8" class="d">-                            None,
</a><a href="#h43-6-9" id="h43-6-9" class="d">-                            None,
</a><a href="#h43-6-10" id="h43-6-10" class="d">-                        ],
</a>                         expressions: [
                             Field(
                                 5,
<a href="#h43-7" id="h43-7" class="h">@@ -367,20 +379,15 @@ Optimized plan: Select(
</a>                                 ),
                             ),
                         ],
<a href="#h43-7-3" id="h43-7-3" class="i">+                        labels: [
</a><a href="#h43-7-4" id="h43-7-4" class="i">+                            None,
</a><a href="#h43-7-5" id="h43-7-5" class="i">+                            None,
</a><a href="#h43-7-6" id="h43-7-6" class="i">+                        ],
</a>                     },
                     aggregates: [
                         Max,
                     ],
                 },
<a href="#h43-7-12" id="h43-7-12" class="d">-                labels: [
</a><a href="#h43-7-13" id="h43-7-13" class="d">-                    None,
</a><a href="#h43-7-14" id="h43-7-14" class="d">-                    Some(
</a><a href="#h43-7-15" id="h43-7-15" class="d">-                        (
</a><a href="#h43-7-16" id="h43-7-16" class="d">-                            None,
</a><a href="#h43-7-17" id="h43-7-17" class="d">-                            &quot;rating&quot;,
</a><a href="#h43-7-18" id="h43-7-18" class="d">-                        ),
</a><a href="#h43-7-19" id="h43-7-19" class="d">-                    ),
</a><a href="#h43-7-20" id="h43-7-20" class="d">-                ],
</a>                 expressions: [
                     Field(
                         1,
<a href="#h43-8" id="h43-8" class="h">@@ -398,6 +405,15 @@ Optimized plan: Select(
</a>                         None,
                     ),
                 ],
<a href="#h43-8-3" id="h43-8-3" class="i">+                labels: [
</a><a href="#h43-8-4" id="h43-8-4" class="i">+                    None,
</a><a href="#h43-8-5" id="h43-8-5" class="i">+                    Some(
</a><a href="#h43-8-6" id="h43-8-6" class="i">+                        (
</a><a href="#h43-8-7" id="h43-8-7" class="i">+                            None,
</a><a href="#h43-8-8" id="h43-8-8" class="i">+                            &quot;rating&quot;,
</a><a href="#h43-8-9" id="h43-8-9" class="i">+                        ),
</a><a href="#h43-8-10" id="h43-8-10" class="i">+                    ),
</a><a href="#h43-8-11" id="h43-8-11" class="i">+                ],
</a>             },
             predicate: GreaterThan(
                 Field(
<a href="#h43-9" id="h43-9" class="h">@@ -433,5 +449,21 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h43-9-3" id="h43-9-3" class="d">-)
</a><a href="#h43-9-4" id="h43-9-4" class="i">+    labels: [
</a><a href="#h43-9-5" id="h43-9-5" class="i">+        Some(
</a><a href="#h43-9-6" id="h43-9-6" class="i">+            (
</a><a href="#h43-9-7" id="h43-9-7" class="i">+                Some(
</a><a href="#h43-9-8" id="h43-9-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h43-9-9" id="h43-9-9" class="i">+                ),
</a><a href="#h43-9-10" id="h43-9-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h43-9-11" id="h43-9-11" class="i">+            ),
</a><a href="#h43-9-12" id="h43-9-12" class="i">+        ),
</a><a href="#h43-9-13" id="h43-9-13" class="i">+        Some(
</a><a href="#h43-9-14" id="h43-9-14" class="i">+            (
</a><a href="#h43-9-15" id="h43-9-15" class="i">+                None,
</a><a href="#h43-9-16" id="h43-9-16" class="i">+                &quot;rating&quot;,
</a><a href="#h43-9-17" id="h43-9-17" class="i">+            ),
</a><a href="#h43-9-18" id="h43-9-18" class="i">+        ),
</a><a href="#h43-9-19" id="h43-9-19" class="i">+    ],
</a><a href="#h43-9-20" id="h43-9-20" class="i">+}
</a> 
<b>diff --git a/<a id="h44" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -5,7 +5,7 @@ Projection: #0, #1
</a> └─ Order: movies.studio_id asc
    └─ Filter: #2 &gt; 7
       └─ Projection: movies.studio_id, #0, #1
<a href="#h44-0-3" id="h44-0-3" class="d">-         └─ Aggregation: maximum, minimum
</a><a href="#h44-0-4" id="h44-0-4" class="i">+         └─ Aggregation: max, min
</a>             └─ Projection: rating, rating, studio_id
                └─ Scan: movies
 
<a href="#h44-1" id="h44-1" class="h">@@ -82,8 +82,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h44-1-3" id="h44-1-3" class="d">-Plan: Select(
</a><a href="#h44-1-4" id="h44-1-4" class="d">-    Projection {
</a><a href="#h44-1-5" id="h44-1-5" class="i">+Plan: Select {
</a><a href="#h44-1-6" id="h44-1-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h44-2" id="h44-2" class="h">@@ -167,14 +167,9 @@ Plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h44-2-3" id="h44-2-3" class="d">-                                alias: None,
</a>                                 filter: None,
<a href="#h44-2-5" id="h44-2-5" class="i">+                                alias: None,
</a>                             },
<a href="#h44-2-7" id="h44-2-7" class="d">-                            labels: [
</a><a href="#h44-2-8" id="h44-2-8" class="d">-                                None,
</a><a href="#h44-2-9" id="h44-2-9" class="d">-                                None,
</a><a href="#h44-2-10" id="h44-2-10" class="d">-                                None,
</a><a href="#h44-2-11" id="h44-2-11" class="d">-                            ],
</a>                             expressions: [
                                 Field(
                                     5,
<a href="#h44-3" id="h44-3" class="h">@@ -204,17 +199,17 @@ Plan: Select(
</a>                                     ),
                                 ),
                             ],
<a href="#h44-3-3" id="h44-3-3" class="i">+                            labels: [
</a><a href="#h44-3-4" id="h44-3-4" class="i">+                                None,
</a><a href="#h44-3-5" id="h44-3-5" class="i">+                                None,
</a><a href="#h44-3-6" id="h44-3-6" class="i">+                                None,
</a><a href="#h44-3-7" id="h44-3-7" class="i">+                            ],
</a>                         },
                         aggregates: [
                             Max,
                             Min,
                         ],
                     },
<a href="#h44-3-14" id="h44-3-14" class="d">-                    labels: [
</a><a href="#h44-3-15" id="h44-3-15" class="d">-                        None,
</a><a href="#h44-3-16" id="h44-3-16" class="d">-                        None,
</a><a href="#h44-3-17" id="h44-3-17" class="d">-                        None,
</a><a href="#h44-3-18" id="h44-3-18" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             2,
<a href="#h44-4" id="h44-4" class="h">@@ -236,6 +231,11 @@ Plan: Select(
</a>                             None,
                         ),
                     ],
<a href="#h44-4-3" id="h44-4-3" class="i">+                    labels: [
</a><a href="#h44-4-4" id="h44-4-4" class="i">+                        None,
</a><a href="#h44-4-5" id="h44-4-5" class="i">+                        None,
</a><a href="#h44-4-6" id="h44-4-6" class="i">+                        None,
</a><a href="#h44-4-7" id="h44-4-7" class="i">+                    ],
</a>                 },
                 predicate: GreaterThan(
                     Field(
<a href="#h44-5" id="h44-5" class="h">@@ -266,10 +266,6 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h44-5-3" id="h44-5-3" class="d">-        labels: [
</a><a href="#h44-5-4" id="h44-5-4" class="d">-            None,
</a><a href="#h44-5-5" id="h44-5-5" class="d">-            None,
</a><a href="#h44-5-6" id="h44-5-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h44-6" id="h44-6" class="h">@@ -280,11 +276,26 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h44-6-3" id="h44-6-3" class="i">+        labels: [
</a><a href="#h44-6-4" id="h44-6-4" class="i">+            None,
</a><a href="#h44-6-5" id="h44-6-5" class="i">+            None,
</a><a href="#h44-6-6" id="h44-6-6" class="i">+        ],
</a>     },
<a href="#h44-6-8" id="h44-6-8" class="d">-)
</a><a href="#h44-6-9" id="h44-6-9" class="i">+    labels: [
</a><a href="#h44-6-10" id="h44-6-10" class="i">+        Some(
</a><a href="#h44-6-11" id="h44-6-11" class="i">+            (
</a><a href="#h44-6-12" id="h44-6-12" class="i">+                Some(
</a><a href="#h44-6-13" id="h44-6-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h44-6-14" id="h44-6-14" class="i">+                ),
</a><a href="#h44-6-15" id="h44-6-15" class="i">+                &quot;studio_id&quot;,
</a><a href="#h44-6-16" id="h44-6-16" class="i">+            ),
</a><a href="#h44-6-17" id="h44-6-17" class="i">+        ),
</a><a href="#h44-6-18" id="h44-6-18" class="i">+        None,
</a><a href="#h44-6-19" id="h44-6-19" class="i">+    ],
</a><a href="#h44-6-20" id="h44-6-20" class="i">+}
</a> 
<a href="#h44-6-22" id="h44-6-22" class="d">-Optimized plan: Select(
</a><a href="#h44-6-23" id="h44-6-23" class="d">-    Projection {
</a><a href="#h44-6-24" id="h44-6-24" class="i">+Optimized plan: Select {
</a><a href="#h44-6-25" id="h44-6-25" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h44-7" id="h44-7" class="h">@@ -368,14 +379,9 @@ Optimized plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h44-7-3" id="h44-7-3" class="d">-                                alias: None,
</a>                                 filter: None,
<a href="#h44-7-5" id="h44-7-5" class="i">+                                alias: None,
</a>                             },
<a href="#h44-7-7" id="h44-7-7" class="d">-                            labels: [
</a><a href="#h44-7-8" id="h44-7-8" class="d">-                                None,
</a><a href="#h44-7-9" id="h44-7-9" class="d">-                                None,
</a><a href="#h44-7-10" id="h44-7-10" class="d">-                                None,
</a><a href="#h44-7-11" id="h44-7-11" class="d">-                            ],
</a>                             expressions: [
                                 Field(
                                     5,
<a href="#h44-8" id="h44-8" class="h">@@ -405,17 +411,17 @@ Optimized plan: Select(
</a>                                     ),
                                 ),
                             ],
<a href="#h44-8-3" id="h44-8-3" class="i">+                            labels: [
</a><a href="#h44-8-4" id="h44-8-4" class="i">+                                None,
</a><a href="#h44-8-5" id="h44-8-5" class="i">+                                None,
</a><a href="#h44-8-6" id="h44-8-6" class="i">+                                None,
</a><a href="#h44-8-7" id="h44-8-7" class="i">+                            ],
</a>                         },
                         aggregates: [
                             Max,
                             Min,
                         ],
                     },
<a href="#h44-8-14" id="h44-8-14" class="d">-                    labels: [
</a><a href="#h44-8-15" id="h44-8-15" class="d">-                        None,
</a><a href="#h44-8-16" id="h44-8-16" class="d">-                        None,
</a><a href="#h44-8-17" id="h44-8-17" class="d">-                        None,
</a><a href="#h44-8-18" id="h44-8-18" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             2,
<a href="#h44-9" id="h44-9" class="h">@@ -437,6 +443,11 @@ Optimized plan: Select(
</a>                             None,
                         ),
                     ],
<a href="#h44-9-3" id="h44-9-3" class="i">+                    labels: [
</a><a href="#h44-9-4" id="h44-9-4" class="i">+                        None,
</a><a href="#h44-9-5" id="h44-9-5" class="i">+                        None,
</a><a href="#h44-9-6" id="h44-9-6" class="i">+                        None,
</a><a href="#h44-9-7" id="h44-9-7" class="i">+                    ],
</a>                 },
                 predicate: GreaterThan(
                     Field(
<a href="#h44-10" id="h44-10" class="h">@@ -467,10 +478,6 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h44-10-3" id="h44-10-3" class="d">-        labels: [
</a><a href="#h44-10-4" id="h44-10-4" class="d">-            None,
</a><a href="#h44-10-5" id="h44-10-5" class="d">-            None,
</a><a href="#h44-10-6" id="h44-10-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h44-11" id="h44-11" class="h">@@ -481,6 +488,21 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h44-11-3" id="h44-11-3" class="i">+        labels: [
</a><a href="#h44-11-4" id="h44-11-4" class="i">+            None,
</a><a href="#h44-11-5" id="h44-11-5" class="i">+            None,
</a><a href="#h44-11-6" id="h44-11-6" class="i">+        ],
</a>     },
<a href="#h44-11-8" id="h44-11-8" class="d">-)
</a><a href="#h44-11-9" id="h44-11-9" class="i">+    labels: [
</a><a href="#h44-11-10" id="h44-11-10" class="i">+        Some(
</a><a href="#h44-11-11" id="h44-11-11" class="i">+            (
</a><a href="#h44-11-12" id="h44-11-12" class="i">+                Some(
</a><a href="#h44-11-13" id="h44-11-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h44-11-14" id="h44-11-14" class="i">+                ),
</a><a href="#h44-11-15" id="h44-11-15" class="i">+                &quot;studio_id&quot;,
</a><a href="#h44-11-16" id="h44-11-16" class="i">+            ),
</a><a href="#h44-11-17" id="h44-11-17" class="i">+        ),
</a><a href="#h44-11-18" id="h44-11-18" class="i">+        None,
</a><a href="#h44-11-19" id="h44-11-19" class="i">+    ],
</a><a href="#h44-11-20" id="h44-11-20" class="i">+}
</a> 
<b>diff --git a/<a id="h45" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -5,7 +5,7 @@ Projection: #0, #1
</a> └─ Order: movies.studio_id asc
    └─ Filter: #2 - #3 &lt; 1
       └─ Projection: movies.studio_id, #0, #1, #2
<a href="#h45-0-3" id="h45-0-3" class="d">-         └─ Aggregation: maximum, maximum, minimum
</a><a href="#h45-0-4" id="h45-0-4" class="i">+         └─ Aggregation: max, max, min
</a>             └─ Projection: rating, rating, rating, studio_id
                └─ Scan: movies
 
<a href="#h45-1" id="h45-1" class="h">@@ -95,8 +95,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h45-1-3" id="h45-1-3" class="d">-Plan: Select(
</a><a href="#h45-1-4" id="h45-1-4" class="d">-    Projection {
</a><a href="#h45-1-5" id="h45-1-5" class="i">+Plan: Select {
</a><a href="#h45-1-6" id="h45-1-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h45-2" id="h45-2" class="h">@@ -180,15 +180,9 @@ Plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h45-2-3" id="h45-2-3" class="d">-                                alias: None,
</a>                                 filter: None,
<a href="#h45-2-5" id="h45-2-5" class="i">+                                alias: None,
</a>                             },
<a href="#h45-2-7" id="h45-2-7" class="d">-                            labels: [
</a><a href="#h45-2-8" id="h45-2-8" class="d">-                                None,
</a><a href="#h45-2-9" id="h45-2-9" class="d">-                                None,
</a><a href="#h45-2-10" id="h45-2-10" class="d">-                                None,
</a><a href="#h45-2-11" id="h45-2-11" class="d">-                                None,
</a><a href="#h45-2-12" id="h45-2-12" class="d">-                            ],
</a>                             expressions: [
                                 Field(
                                     5,
<a href="#h45-3" id="h45-3" class="h">@@ -227,6 +221,12 @@ Plan: Select(
</a>                                     ),
                                 ),
                             ],
<a href="#h45-3-3" id="h45-3-3" class="i">+                            labels: [
</a><a href="#h45-3-4" id="h45-3-4" class="i">+                                None,
</a><a href="#h45-3-5" id="h45-3-5" class="i">+                                None,
</a><a href="#h45-3-6" id="h45-3-6" class="i">+                                None,
</a><a href="#h45-3-7" id="h45-3-7" class="i">+                                None,
</a><a href="#h45-3-8" id="h45-3-8" class="i">+                            ],
</a>                         },
                         aggregates: [
                             Max,
<a href="#h45-4" id="h45-4" class="h">@@ -234,12 +234,6 @@ Plan: Select(
</a>                             Min,
                         ],
                     },
<a href="#h45-4-3" id="h45-4-3" class="d">-                    labels: [
</a><a href="#h45-4-4" id="h45-4-4" class="d">-                        None,
</a><a href="#h45-4-5" id="h45-4-5" class="d">-                        None,
</a><a href="#h45-4-6" id="h45-4-6" class="d">-                        None,
</a><a href="#h45-4-7" id="h45-4-7" class="d">-                        None,
</a><a href="#h45-4-8" id="h45-4-8" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             3,
<a href="#h45-5" id="h45-5" class="h">@@ -265,6 +259,12 @@ Plan: Select(
</a>                             None,
                         ),
                     ],
<a href="#h45-5-3" id="h45-5-3" class="i">+                    labels: [
</a><a href="#h45-5-4" id="h45-5-4" class="i">+                        None,
</a><a href="#h45-5-5" id="h45-5-5" class="i">+                        None,
</a><a href="#h45-5-6" id="h45-5-6" class="i">+                        None,
</a><a href="#h45-5-7" id="h45-5-7" class="i">+                        None,
</a><a href="#h45-5-8" id="h45-5-8" class="i">+                    ],
</a>                 },
                 predicate: LessThan(
                     Subtract(
<a href="#h45-6" id="h45-6" class="h">@@ -301,10 +301,6 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h45-6-3" id="h45-6-3" class="d">-        labels: [
</a><a href="#h45-6-4" id="h45-6-4" class="d">-            None,
</a><a href="#h45-6-5" id="h45-6-5" class="d">-            None,
</a><a href="#h45-6-6" id="h45-6-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h45-7" id="h45-7" class="h">@@ -315,11 +311,26 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h45-7-3" id="h45-7-3" class="i">+        labels: [
</a><a href="#h45-7-4" id="h45-7-4" class="i">+            None,
</a><a href="#h45-7-5" id="h45-7-5" class="i">+            None,
</a><a href="#h45-7-6" id="h45-7-6" class="i">+        ],
</a>     },
<a href="#h45-7-8" id="h45-7-8" class="d">-)
</a><a href="#h45-7-9" id="h45-7-9" class="i">+    labels: [
</a><a href="#h45-7-10" id="h45-7-10" class="i">+        Some(
</a><a href="#h45-7-11" id="h45-7-11" class="i">+            (
</a><a href="#h45-7-12" id="h45-7-12" class="i">+                Some(
</a><a href="#h45-7-13" id="h45-7-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h45-7-14" id="h45-7-14" class="i">+                ),
</a><a href="#h45-7-15" id="h45-7-15" class="i">+                &quot;studio_id&quot;,
</a><a href="#h45-7-16" id="h45-7-16" class="i">+            ),
</a><a href="#h45-7-17" id="h45-7-17" class="i">+        ),
</a><a href="#h45-7-18" id="h45-7-18" class="i">+        None,
</a><a href="#h45-7-19" id="h45-7-19" class="i">+    ],
</a><a href="#h45-7-20" id="h45-7-20" class="i">+}
</a> 
<a href="#h45-7-22" id="h45-7-22" class="d">-Optimized plan: Select(
</a><a href="#h45-7-23" id="h45-7-23" class="d">-    Projection {
</a><a href="#h45-7-24" id="h45-7-24" class="i">+Optimized plan: Select {
</a><a href="#h45-7-25" id="h45-7-25" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h45-8" id="h45-8" class="h">@@ -403,15 +414,9 @@ Optimized plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h45-8-3" id="h45-8-3" class="d">-                                alias: None,
</a>                                 filter: None,
<a href="#h45-8-5" id="h45-8-5" class="i">+                                alias: None,
</a>                             },
<a href="#h45-8-7" id="h45-8-7" class="d">-                            labels: [
</a><a href="#h45-8-8" id="h45-8-8" class="d">-                                None,
</a><a href="#h45-8-9" id="h45-8-9" class="d">-                                None,
</a><a href="#h45-8-10" id="h45-8-10" class="d">-                                None,
</a><a href="#h45-8-11" id="h45-8-11" class="d">-                                None,
</a><a href="#h45-8-12" id="h45-8-12" class="d">-                            ],
</a>                             expressions: [
                                 Field(
                                     5,
<a href="#h45-9" id="h45-9" class="h">@@ -450,6 +455,12 @@ Optimized plan: Select(
</a>                                     ),
                                 ),
                             ],
<a href="#h45-9-3" id="h45-9-3" class="i">+                            labels: [
</a><a href="#h45-9-4" id="h45-9-4" class="i">+                                None,
</a><a href="#h45-9-5" id="h45-9-5" class="i">+                                None,
</a><a href="#h45-9-6" id="h45-9-6" class="i">+                                None,
</a><a href="#h45-9-7" id="h45-9-7" class="i">+                                None,
</a><a href="#h45-9-8" id="h45-9-8" class="i">+                            ],
</a>                         },
                         aggregates: [
                             Max,
<a href="#h45-10" id="h45-10" class="h">@@ -457,12 +468,6 @@ Optimized plan: Select(
</a>                             Min,
                         ],
                     },
<a href="#h45-10-3" id="h45-10-3" class="d">-                    labels: [
</a><a href="#h45-10-4" id="h45-10-4" class="d">-                        None,
</a><a href="#h45-10-5" id="h45-10-5" class="d">-                        None,
</a><a href="#h45-10-6" id="h45-10-6" class="d">-                        None,
</a><a href="#h45-10-7" id="h45-10-7" class="d">-                        None,
</a><a href="#h45-10-8" id="h45-10-8" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             3,
<a href="#h45-11" id="h45-11" class="h">@@ -488,6 +493,12 @@ Optimized plan: Select(
</a>                             None,
                         ),
                     ],
<a href="#h45-11-3" id="h45-11-3" class="i">+                    labels: [
</a><a href="#h45-11-4" id="h45-11-4" class="i">+                        None,
</a><a href="#h45-11-5" id="h45-11-5" class="i">+                        None,
</a><a href="#h45-11-6" id="h45-11-6" class="i">+                        None,
</a><a href="#h45-11-7" id="h45-11-7" class="i">+                        None,
</a><a href="#h45-11-8" id="h45-11-8" class="i">+                    ],
</a>                 },
                 predicate: LessThan(
                     Subtract(
<a href="#h45-12" id="h45-12" class="h">@@ -524,10 +535,6 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h45-12-3" id="h45-12-3" class="d">-        labels: [
</a><a href="#h45-12-4" id="h45-12-4" class="d">-            None,
</a><a href="#h45-12-5" id="h45-12-5" class="d">-            None,
</a><a href="#h45-12-6" id="h45-12-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h45-13" id="h45-13" class="h">@@ -538,6 +545,21 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h45-13-3" id="h45-13-3" class="i">+        labels: [
</a><a href="#h45-13-4" id="h45-13-4" class="i">+            None,
</a><a href="#h45-13-5" id="h45-13-5" class="i">+            None,
</a><a href="#h45-13-6" id="h45-13-6" class="i">+        ],
</a>     },
<a href="#h45-13-8" id="h45-13-8" class="d">-)
</a><a href="#h45-13-9" id="h45-13-9" class="i">+    labels: [
</a><a href="#h45-13-10" id="h45-13-10" class="i">+        Some(
</a><a href="#h45-13-11" id="h45-13-11" class="i">+            (
</a><a href="#h45-13-12" id="h45-13-12" class="i">+                Some(
</a><a href="#h45-13-13" id="h45-13-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h45-13-14" id="h45-13-14" class="i">+                ),
</a><a href="#h45-13-15" id="h45-13-15" class="i">+                &quot;studio_id&quot;,
</a><a href="#h45-13-16" id="h45-13-16" class="i">+            ),
</a><a href="#h45-13-17" id="h45-13-17" class="i">+        ),
</a><a href="#h45-13-18" id="h45-13-18" class="i">+        None,
</a><a href="#h45-13-19" id="h45-13-19" class="i">+    ],
</a><a href="#h45-13-20" id="h45-13-20" class="i">+}
</a> 
<b>diff --git a/<a id="h46" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -5,7 +5,7 @@ Projection: #0, #1
</a> └─ Order: movies.studio_id asc
    └─ Filter: movies.studio_id &gt; 3 OR movies.studio_id = 3
       └─ Projection: movies.studio_id, #0, studio_id
<a href="#h46-0-3" id="h46-0-3" class="d">-         └─ Aggregation: maximum
</a><a href="#h46-0-4" id="h46-0-4" class="i">+         └─ Aggregation: max
</a>             └─ Projection: rating, studio_id
                └─ Scan: movies
 
<a href="#h46-1" id="h46-1" class="h">@@ -78,8 +78,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h46-1-3" id="h46-1-3" class="d">-Plan: Select(
</a><a href="#h46-1-4" id="h46-1-4" class="d">-    Projection {
</a><a href="#h46-1-5" id="h46-1-5" class="i">+Plan: Select {
</a><a href="#h46-1-6" id="h46-1-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h46-2" id="h46-2" class="h">@@ -163,13 +163,9 @@ Plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h46-2-3" id="h46-2-3" class="d">-                                alias: None,
</a>                                 filter: None,
<a href="#h46-2-5" id="h46-2-5" class="i">+                                alias: None,
</a>                             },
<a href="#h46-2-7" id="h46-2-7" class="d">-                            labels: [
</a><a href="#h46-2-8" id="h46-2-8" class="d">-                                None,
</a><a href="#h46-2-9" id="h46-2-9" class="d">-                                None,
</a><a href="#h46-2-10" id="h46-2-10" class="d">-                            ],
</a>                             expressions: [
                                 Field(
                                     5,
<a href="#h46-3" id="h46-3" class="h">@@ -190,21 +186,15 @@ Plan: Select(
</a>                                     ),
                                 ),
                             ],
<a href="#h46-3-3" id="h46-3-3" class="i">+                            labels: [
</a><a href="#h46-3-4" id="h46-3-4" class="i">+                                None,
</a><a href="#h46-3-5" id="h46-3-5" class="i">+                                None,
</a><a href="#h46-3-6" id="h46-3-6" class="i">+                            ],
</a>                         },
                         aggregates: [
                             Max,
                         ],
                     },
<a href="#h46-3-12" id="h46-3-12" class="d">-                    labels: [
</a><a href="#h46-3-13" id="h46-3-13" class="d">-                        None,
</a><a href="#h46-3-14" id="h46-3-14" class="d">-                        Some(
</a><a href="#h46-3-15" id="h46-3-15" class="d">-                            (
</a><a href="#h46-3-16" id="h46-3-16" class="d">-                                None,
</a><a href="#h46-3-17" id="h46-3-17" class="d">-                                &quot;rating&quot;,
</a><a href="#h46-3-18" id="h46-3-18" class="d">-                            ),
</a><a href="#h46-3-19" id="h46-3-19" class="d">-                        ),
</a><a href="#h46-3-20" id="h46-3-20" class="d">-                        None,
</a><a href="#h46-3-21" id="h46-3-21" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             1,
<a href="#h46-4" id="h46-4" class="h">@@ -231,6 +221,16 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h46-4-3" id="h46-4-3" class="i">+                    labels: [
</a><a href="#h46-4-4" id="h46-4-4" class="i">+                        None,
</a><a href="#h46-4-5" id="h46-4-5" class="i">+                        Some(
</a><a href="#h46-4-6" id="h46-4-6" class="i">+                            (
</a><a href="#h46-4-7" id="h46-4-7" class="i">+                                None,
</a><a href="#h46-4-8" id="h46-4-8" class="i">+                                &quot;rating&quot;,
</a><a href="#h46-4-9" id="h46-4-9" class="i">+                            ),
</a><a href="#h46-4-10" id="h46-4-10" class="i">+                        ),
</a><a href="#h46-4-11" id="h46-4-11" class="i">+                        None,
</a><a href="#h46-4-12" id="h46-4-12" class="i">+                    ],
</a>                 },
                 predicate: Or(
                     GreaterThan(
<a href="#h46-5" id="h46-5" class="h">@@ -288,10 +288,6 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h46-5-3" id="h46-5-3" class="d">-        labels: [
</a><a href="#h46-5-4" id="h46-5-4" class="d">-            None,
</a><a href="#h46-5-5" id="h46-5-5" class="d">-            None,
</a><a href="#h46-5-6" id="h46-5-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h46-6" id="h46-6" class="h">@@ -302,11 +298,31 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h46-6-3" id="h46-6-3" class="i">+        labels: [
</a><a href="#h46-6-4" id="h46-6-4" class="i">+            None,
</a><a href="#h46-6-5" id="h46-6-5" class="i">+            None,
</a><a href="#h46-6-6" id="h46-6-6" class="i">+        ],
</a>     },
<a href="#h46-6-8" id="h46-6-8" class="d">-)
</a><a href="#h46-6-9" id="h46-6-9" class="i">+    labels: [
</a><a href="#h46-6-10" id="h46-6-10" class="i">+        Some(
</a><a href="#h46-6-11" id="h46-6-11" class="i">+            (
</a><a href="#h46-6-12" id="h46-6-12" class="i">+                Some(
</a><a href="#h46-6-13" id="h46-6-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h46-6-14" id="h46-6-14" class="i">+                ),
</a><a href="#h46-6-15" id="h46-6-15" class="i">+                &quot;studio_id&quot;,
</a><a href="#h46-6-16" id="h46-6-16" class="i">+            ),
</a><a href="#h46-6-17" id="h46-6-17" class="i">+        ),
</a><a href="#h46-6-18" id="h46-6-18" class="i">+        Some(
</a><a href="#h46-6-19" id="h46-6-19" class="i">+            (
</a><a href="#h46-6-20" id="h46-6-20" class="i">+                None,
</a><a href="#h46-6-21" id="h46-6-21" class="i">+                &quot;rating&quot;,
</a><a href="#h46-6-22" id="h46-6-22" class="i">+            ),
</a><a href="#h46-6-23" id="h46-6-23" class="i">+        ),
</a><a href="#h46-6-24" id="h46-6-24" class="i">+    ],
</a><a href="#h46-6-25" id="h46-6-25" class="i">+}
</a> 
<a href="#h46-6-27" id="h46-6-27" class="d">-Optimized plan: Select(
</a><a href="#h46-6-28" id="h46-6-28" class="d">-    Projection {
</a><a href="#h46-6-29" id="h46-6-29" class="i">+Optimized plan: Select {
</a><a href="#h46-6-30" id="h46-6-30" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h46-7" id="h46-7" class="h">@@ -390,13 +406,9 @@ Optimized plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h46-7-3" id="h46-7-3" class="d">-                                alias: None,
</a>                                 filter: None,
<a href="#h46-7-5" id="h46-7-5" class="i">+                                alias: None,
</a>                             },
<a href="#h46-7-7" id="h46-7-7" class="d">-                            labels: [
</a><a href="#h46-7-8" id="h46-7-8" class="d">-                                None,
</a><a href="#h46-7-9" id="h46-7-9" class="d">-                                None,
</a><a href="#h46-7-10" id="h46-7-10" class="d">-                            ],
</a>                             expressions: [
                                 Field(
                                     5,
<a href="#h46-8" id="h46-8" class="h">@@ -417,21 +429,15 @@ Optimized plan: Select(
</a>                                     ),
                                 ),
                             ],
<a href="#h46-8-3" id="h46-8-3" class="i">+                            labels: [
</a><a href="#h46-8-4" id="h46-8-4" class="i">+                                None,
</a><a href="#h46-8-5" id="h46-8-5" class="i">+                                None,
</a><a href="#h46-8-6" id="h46-8-6" class="i">+                            ],
</a>                         },
                         aggregates: [
                             Max,
                         ],
                     },
<a href="#h46-8-12" id="h46-8-12" class="d">-                    labels: [
</a><a href="#h46-8-13" id="h46-8-13" class="d">-                        None,
</a><a href="#h46-8-14" id="h46-8-14" class="d">-                        Some(
</a><a href="#h46-8-15" id="h46-8-15" class="d">-                            (
</a><a href="#h46-8-16" id="h46-8-16" class="d">-                                None,
</a><a href="#h46-8-17" id="h46-8-17" class="d">-                                &quot;rating&quot;,
</a><a href="#h46-8-18" id="h46-8-18" class="d">-                            ),
</a><a href="#h46-8-19" id="h46-8-19" class="d">-                        ),
</a><a href="#h46-8-20" id="h46-8-20" class="d">-                        None,
</a><a href="#h46-8-21" id="h46-8-21" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             1,
<a href="#h46-9" id="h46-9" class="h">@@ -458,6 +464,16 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h46-9-3" id="h46-9-3" class="i">+                    labels: [
</a><a href="#h46-9-4" id="h46-9-4" class="i">+                        None,
</a><a href="#h46-9-5" id="h46-9-5" class="i">+                        Some(
</a><a href="#h46-9-6" id="h46-9-6" class="i">+                            (
</a><a href="#h46-9-7" id="h46-9-7" class="i">+                                None,
</a><a href="#h46-9-8" id="h46-9-8" class="i">+                                &quot;rating&quot;,
</a><a href="#h46-9-9" id="h46-9-9" class="i">+                            ),
</a><a href="#h46-9-10" id="h46-9-10" class="i">+                        ),
</a><a href="#h46-9-11" id="h46-9-11" class="i">+                        None,
</a><a href="#h46-9-12" id="h46-9-12" class="i">+                    ],
</a>                 },
                 predicate: Or(
                     GreaterThan(
<a href="#h46-10" id="h46-10" class="h">@@ -515,10 +531,6 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h46-10-3" id="h46-10-3" class="d">-        labels: [
</a><a href="#h46-10-4" id="h46-10-4" class="d">-            None,
</a><a href="#h46-10-5" id="h46-10-5" class="d">-            None,
</a><a href="#h46-10-6" id="h46-10-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h46-11" id="h46-11" class="h">@@ -529,6 +541,26 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h46-11-3" id="h46-11-3" class="i">+        labels: [
</a><a href="#h46-11-4" id="h46-11-4" class="i">+            None,
</a><a href="#h46-11-5" id="h46-11-5" class="i">+            None,
</a><a href="#h46-11-6" id="h46-11-6" class="i">+        ],
</a>     },
<a href="#h46-11-8" id="h46-11-8" class="d">-)
</a><a href="#h46-11-9" id="h46-11-9" class="i">+    labels: [
</a><a href="#h46-11-10" id="h46-11-10" class="i">+        Some(
</a><a href="#h46-11-11" id="h46-11-11" class="i">+            (
</a><a href="#h46-11-12" id="h46-11-12" class="i">+                Some(
</a><a href="#h46-11-13" id="h46-11-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h46-11-14" id="h46-11-14" class="i">+                ),
</a><a href="#h46-11-15" id="h46-11-15" class="i">+                &quot;studio_id&quot;,
</a><a href="#h46-11-16" id="h46-11-16" class="i">+            ),
</a><a href="#h46-11-17" id="h46-11-17" class="i">+        ),
</a><a href="#h46-11-18" id="h46-11-18" class="i">+        Some(
</a><a href="#h46-11-19" id="h46-11-19" class="i">+            (
</a><a href="#h46-11-20" id="h46-11-20" class="i">+                None,
</a><a href="#h46-11-21" id="h46-11-21" class="i">+                &quot;rating&quot;,
</a><a href="#h46-11-22" id="h46-11-22" class="i">+            ),
</a><a href="#h46-11-23" id="h46-11-23" class="i">+        ),
</a><a href="#h46-11-24" id="h46-11-24" class="i">+    ],
</a><a href="#h46-11-25" id="h46-11-25" class="i">+}
</a> 
<b>diff --git a/<a id="h47" href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a> b/<a href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -66,8 +66,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h47-0-3" id="h47-0-3" class="d">-Plan: Select(
</a><a href="#h47-0-4" id="h47-0-4" class="d">-    Projection {
</a><a href="#h47-0-5" id="h47-0-5" class="i">+Plan: Select {
</a><a href="#h47-0-6" id="h47-0-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h47-1" id="h47-1" class="h">@@ -149,14 +149,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h47-1-3" id="h47-1-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h47-1-5" id="h47-1-5" class="i">+                        alias: None,
</a>                     },
<a href="#h47-1-7" id="h47-1-7" class="d">-                    labels: [
</a><a href="#h47-1-8" id="h47-1-8" class="d">-                        None,
</a><a href="#h47-1-9" id="h47-1-9" class="d">-                        None,
</a><a href="#h47-1-10" id="h47-1-10" class="d">-                        None,
</a><a href="#h47-1-11" id="h47-1-11" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             0,
<a href="#h47-2" id="h47-2" class="h">@@ -186,6 +181,11 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h47-2-3" id="h47-2-3" class="i">+                    labels: [
</a><a href="#h47-2-4" id="h47-2-4" class="i">+                        None,
</a><a href="#h47-2-5" id="h47-2-5" class="i">+                        None,
</a><a href="#h47-2-6" id="h47-2-6" class="i">+                        None,
</a><a href="#h47-2-7" id="h47-2-7" class="i">+                    ],
</a>                 },
                 predicate: GreaterThan(
                     Field(
<a href="#h47-3" id="h47-3" class="h">@@ -223,10 +223,6 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h47-3-3" id="h47-3-3" class="d">-        labels: [
</a><a href="#h47-3-4" id="h47-3-4" class="d">-            None,
</a><a href="#h47-3-5" id="h47-3-5" class="d">-            None,
</a><a href="#h47-3-6" id="h47-3-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h47-4" id="h47-4" class="h">@@ -237,11 +233,33 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h47-4-3" id="h47-4-3" class="i">+        labels: [
</a><a href="#h47-4-4" id="h47-4-4" class="i">+            None,
</a><a href="#h47-4-5" id="h47-4-5" class="i">+            None,
</a><a href="#h47-4-6" id="h47-4-6" class="i">+        ],
</a>     },
<a href="#h47-4-8" id="h47-4-8" class="d">-)
</a><a href="#h47-4-9" id="h47-4-9" class="i">+    labels: [
</a><a href="#h47-4-10" id="h47-4-10" class="i">+        Some(
</a><a href="#h47-4-11" id="h47-4-11" class="i">+            (
</a><a href="#h47-4-12" id="h47-4-12" class="i">+                Some(
</a><a href="#h47-4-13" id="h47-4-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h47-4-14" id="h47-4-14" class="i">+                ),
</a><a href="#h47-4-15" id="h47-4-15" class="i">+                &quot;id&quot;,
</a><a href="#h47-4-16" id="h47-4-16" class="i">+            ),
</a><a href="#h47-4-17" id="h47-4-17" class="i">+        ),
</a><a href="#h47-4-18" id="h47-4-18" class="i">+        Some(
</a><a href="#h47-4-19" id="h47-4-19" class="i">+            (
</a><a href="#h47-4-20" id="h47-4-20" class="i">+                Some(
</a><a href="#h47-4-21" id="h47-4-21" class="i">+                    &quot;movies&quot;,
</a><a href="#h47-4-22" id="h47-4-22" class="i">+                ),
</a><a href="#h47-4-23" id="h47-4-23" class="i">+                &quot;rating&quot;,
</a><a href="#h47-4-24" id="h47-4-24" class="i">+            ),
</a><a href="#h47-4-25" id="h47-4-25" class="i">+        ),
</a><a href="#h47-4-26" id="h47-4-26" class="i">+    ],
</a><a href="#h47-4-27" id="h47-4-27" class="i">+}
</a> 
<a href="#h47-4-29" id="h47-4-29" class="d">-Optimized plan: Select(
</a><a href="#h47-4-30" id="h47-4-30" class="d">-    Projection {
</a><a href="#h47-4-31" id="h47-4-31" class="i">+Optimized plan: Select {
</a><a href="#h47-4-32" id="h47-4-32" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h47-5" id="h47-5" class="h">@@ -323,14 +341,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h47-5-3" id="h47-5-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h47-5-5" id="h47-5-5" class="i">+                        alias: None,
</a>                     },
<a href="#h47-5-7" id="h47-5-7" class="d">-                    labels: [
</a><a href="#h47-5-8" id="h47-5-8" class="d">-                        None,
</a><a href="#h47-5-9" id="h47-5-9" class="d">-                        None,
</a><a href="#h47-5-10" id="h47-5-10" class="d">-                        None,
</a><a href="#h47-5-11" id="h47-5-11" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             0,
<a href="#h47-6" id="h47-6" class="h">@@ -360,6 +373,11 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h47-6-3" id="h47-6-3" class="i">+                    labels: [
</a><a href="#h47-6-4" id="h47-6-4" class="i">+                        None,
</a><a href="#h47-6-5" id="h47-6-5" class="i">+                        None,
</a><a href="#h47-6-6" id="h47-6-6" class="i">+                        None,
</a><a href="#h47-6-7" id="h47-6-7" class="i">+                    ],
</a>                 },
                 predicate: GreaterThan(
                     Field(
<a href="#h47-7" id="h47-7" class="h">@@ -397,10 +415,6 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h47-7-3" id="h47-7-3" class="d">-        labels: [
</a><a href="#h47-7-4" id="h47-7-4" class="d">-            None,
</a><a href="#h47-7-5" id="h47-7-5" class="d">-            None,
</a><a href="#h47-7-6" id="h47-7-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h47-8" id="h47-8" class="h">@@ -411,6 +425,28 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h47-8-3" id="h47-8-3" class="i">+        labels: [
</a><a href="#h47-8-4" id="h47-8-4" class="i">+            None,
</a><a href="#h47-8-5" id="h47-8-5" class="i">+            None,
</a><a href="#h47-8-6" id="h47-8-6" class="i">+        ],
</a>     },
<a href="#h47-8-8" id="h47-8-8" class="d">-)
</a><a href="#h47-8-9" id="h47-8-9" class="i">+    labels: [
</a><a href="#h47-8-10" id="h47-8-10" class="i">+        Some(
</a><a href="#h47-8-11" id="h47-8-11" class="i">+            (
</a><a href="#h47-8-12" id="h47-8-12" class="i">+                Some(
</a><a href="#h47-8-13" id="h47-8-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h47-8-14" id="h47-8-14" class="i">+                ),
</a><a href="#h47-8-15" id="h47-8-15" class="i">+                &quot;id&quot;,
</a><a href="#h47-8-16" id="h47-8-16" class="i">+            ),
</a><a href="#h47-8-17" id="h47-8-17" class="i">+        ),
</a><a href="#h47-8-18" id="h47-8-18" class="i">+        Some(
</a><a href="#h47-8-19" id="h47-8-19" class="i">+            (
</a><a href="#h47-8-20" id="h47-8-20" class="i">+                Some(
</a><a href="#h47-8-21" id="h47-8-21" class="i">+                    &quot;movies&quot;,
</a><a href="#h47-8-22" id="h47-8-22" class="i">+                ),
</a><a href="#h47-8-23" id="h47-8-23" class="i">+                &quot;rating&quot;,
</a><a href="#h47-8-24" id="h47-8-24" class="i">+            ),
</a><a href="#h47-8-25" id="h47-8-25" class="i">+        ),
</a><a href="#h47-8-26" id="h47-8-26" class="i">+    ],
</a><a href="#h47-8-27" id="h47-8-27" class="i">+}
</a> 
<b>diff --git a/<a id="h48" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -5,7 +5,7 @@ Projection: #0
</a> └─ Order: movies.studio_id asc
    └─ Filter: #1 &gt; 8
       └─ Projection: movies.studio_id, #0
<a href="#h48-0-3" id="h48-0-3" class="d">-         └─ Aggregation: maximum
</a><a href="#h48-0-4" id="h48-0-4" class="i">+         └─ Aggregation: max
</a>             └─ Projection: rating, studio_id
                └─ Scan: movies
 
<a href="#h48-1" id="h48-1" class="h">@@ -69,8 +69,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h48-1-3" id="h48-1-3" class="d">-Plan: Select(
</a><a href="#h48-1-4" id="h48-1-4" class="d">-    Projection {
</a><a href="#h48-1-5" id="h48-1-5" class="i">+Plan: Select {
</a><a href="#h48-1-6" id="h48-1-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h48-2" id="h48-2" class="h">@@ -154,13 +154,9 @@ Plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h48-2-3" id="h48-2-3" class="d">-                                alias: None,
</a>                                 filter: None,
<a href="#h48-2-5" id="h48-2-5" class="i">+                                alias: None,
</a>                             },
<a href="#h48-2-7" id="h48-2-7" class="d">-                            labels: [
</a><a href="#h48-2-8" id="h48-2-8" class="d">-                                None,
</a><a href="#h48-2-9" id="h48-2-9" class="d">-                                None,
</a><a href="#h48-2-10" id="h48-2-10" class="d">-                            ],
</a>                             expressions: [
                                 Field(
                                     5,
<a href="#h48-3" id="h48-3" class="h">@@ -181,15 +177,15 @@ Plan: Select(
</a>                                     ),
                                 ),
                             ],
<a href="#h48-3-3" id="h48-3-3" class="i">+                            labels: [
</a><a href="#h48-3-4" id="h48-3-4" class="i">+                                None,
</a><a href="#h48-3-5" id="h48-3-5" class="i">+                                None,
</a><a href="#h48-3-6" id="h48-3-6" class="i">+                            ],
</a>                         },
                         aggregates: [
                             Max,
                         ],
                     },
<a href="#h48-3-12" id="h48-3-12" class="d">-                    labels: [
</a><a href="#h48-3-13" id="h48-3-13" class="d">-                        None,
</a><a href="#h48-3-14" id="h48-3-14" class="d">-                        None,
</a><a href="#h48-3-15" id="h48-3-15" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             1,
<a href="#h48-4" id="h48-4" class="h">@@ -207,6 +203,10 @@ Plan: Select(
</a>                             None,
                         ),
                     ],
<a href="#h48-4-3" id="h48-4-3" class="i">+                    labels: [
</a><a href="#h48-4-4" id="h48-4-4" class="i">+                        None,
</a><a href="#h48-4-5" id="h48-4-5" class="i">+                        None,
</a><a href="#h48-4-6" id="h48-4-6" class="i">+                    ],
</a>                 },
                 predicate: GreaterThan(
                     Field(
<a href="#h48-5" id="h48-5" class="h">@@ -237,20 +237,30 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h48-5-3" id="h48-5-3" class="d">-        labels: [
</a><a href="#h48-5-4" id="h48-5-4" class="d">-            None,
</a><a href="#h48-5-5" id="h48-5-5" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
                 None,
             ),
         ],
<a href="#h48-5-12" id="h48-5-12" class="i">+        labels: [
</a><a href="#h48-5-13" id="h48-5-13" class="i">+            None,
</a><a href="#h48-5-14" id="h48-5-14" class="i">+        ],
</a>     },
<a href="#h48-5-16" id="h48-5-16" class="d">-)
</a><a href="#h48-5-17" id="h48-5-17" class="i">+    labels: [
</a><a href="#h48-5-18" id="h48-5-18" class="i">+        Some(
</a><a href="#h48-5-19" id="h48-5-19" class="i">+            (
</a><a href="#h48-5-20" id="h48-5-20" class="i">+                Some(
</a><a href="#h48-5-21" id="h48-5-21" class="i">+                    &quot;movies&quot;,
</a><a href="#h48-5-22" id="h48-5-22" class="i">+                ),
</a><a href="#h48-5-23" id="h48-5-23" class="i">+                &quot;studio_id&quot;,
</a><a href="#h48-5-24" id="h48-5-24" class="i">+            ),
</a><a href="#h48-5-25" id="h48-5-25" class="i">+        ),
</a><a href="#h48-5-26" id="h48-5-26" class="i">+    ],
</a><a href="#h48-5-27" id="h48-5-27" class="i">+}
</a> 
<a href="#h48-5-29" id="h48-5-29" class="d">-Optimized plan: Select(
</a><a href="#h48-5-30" id="h48-5-30" class="d">-    Projection {
</a><a href="#h48-5-31" id="h48-5-31" class="i">+Optimized plan: Select {
</a><a href="#h48-5-32" id="h48-5-32" class="i">+    root: Projection {
</a>         source: Order {
             source: Filter {
                 source: Projection {
<a href="#h48-6" id="h48-6" class="h">@@ -334,13 +344,9 @@ Optimized plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h48-6-3" id="h48-6-3" class="d">-                                alias: None,
</a>                                 filter: None,
<a href="#h48-6-5" id="h48-6-5" class="i">+                                alias: None,
</a>                             },
<a href="#h48-6-7" id="h48-6-7" class="d">-                            labels: [
</a><a href="#h48-6-8" id="h48-6-8" class="d">-                                None,
</a><a href="#h48-6-9" id="h48-6-9" class="d">-                                None,
</a><a href="#h48-6-10" id="h48-6-10" class="d">-                            ],
</a>                             expressions: [
                                 Field(
                                     5,
<a href="#h48-7" id="h48-7" class="h">@@ -361,15 +367,15 @@ Optimized plan: Select(
</a>                                     ),
                                 ),
                             ],
<a href="#h48-7-3" id="h48-7-3" class="i">+                            labels: [
</a><a href="#h48-7-4" id="h48-7-4" class="i">+                                None,
</a><a href="#h48-7-5" id="h48-7-5" class="i">+                                None,
</a><a href="#h48-7-6" id="h48-7-6" class="i">+                            ],
</a>                         },
                         aggregates: [
                             Max,
                         ],
                     },
<a href="#h48-7-12" id="h48-7-12" class="d">-                    labels: [
</a><a href="#h48-7-13" id="h48-7-13" class="d">-                        None,
</a><a href="#h48-7-14" id="h48-7-14" class="d">-                        None,
</a><a href="#h48-7-15" id="h48-7-15" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             1,
<a href="#h48-8" id="h48-8" class="h">@@ -387,6 +393,10 @@ Optimized plan: Select(
</a>                             None,
                         ),
                     ],
<a href="#h48-8-3" id="h48-8-3" class="i">+                    labels: [
</a><a href="#h48-8-4" id="h48-8-4" class="i">+                        None,
</a><a href="#h48-8-5" id="h48-8-5" class="i">+                        None,
</a><a href="#h48-8-6" id="h48-8-6" class="i">+                    ],
</a>                 },
                 predicate: GreaterThan(
                     Field(
<a href="#h48-9" id="h48-9" class="h">@@ -417,15 +427,25 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h48-9-3" id="h48-9-3" class="d">-        labels: [
</a><a href="#h48-9-4" id="h48-9-4" class="d">-            None,
</a><a href="#h48-9-5" id="h48-9-5" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
                 None,
             ),
         ],
<a href="#h48-9-12" id="h48-9-12" class="i">+        labels: [
</a><a href="#h48-9-13" id="h48-9-13" class="i">+            None,
</a><a href="#h48-9-14" id="h48-9-14" class="i">+        ],
</a>     },
<a href="#h48-9-16" id="h48-9-16" class="d">-)
</a><a href="#h48-9-17" id="h48-9-17" class="i">+    labels: [
</a><a href="#h48-9-18" id="h48-9-18" class="i">+        Some(
</a><a href="#h48-9-19" id="h48-9-19" class="i">+            (
</a><a href="#h48-9-20" id="h48-9-20" class="i">+                Some(
</a><a href="#h48-9-21" id="h48-9-21" class="i">+                    &quot;movies&quot;,
</a><a href="#h48-9-22" id="h48-9-22" class="i">+                ),
</a><a href="#h48-9-23" id="h48-9-23" class="i">+                &quot;studio_id&quot;,
</a><a href="#h48-9-24" id="h48-9-24" class="i">+            ),
</a><a href="#h48-9-25" id="h48-9-25" class="i">+        ),
</a><a href="#h48-9-26" id="h48-9-26" class="i">+    ],
</a><a href="#h48-9-27" id="h48-9-27" class="i">+}
</a> 
<b>diff --git a/<a id="h49" href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a> b/<a href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -61,8 +61,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h49-0-3" id="h49-0-3" class="d">-Plan: Select(
</a><a href="#h49-0-4" id="h49-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h49-0-5" id="h49-0-5" class="i">+Plan: Select {
</a><a href="#h49-0-6" id="h49-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h49-1" id="h49-1" class="h">@@ -141,8 +141,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h49-1-3" id="h49-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h49-1-5" id="h49-1-5" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h49-2" id="h49-2" class="h">@@ -170,16 +170,90 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h49-2-3" id="h49-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h49-2-5" id="h49-2-5" class="i">+            alias: None,
</a>         },
         predicate: None,
         outer: false,
     },
<a href="#h49-2-10" id="h49-2-10" class="d">-)
</a><a href="#h49-2-11" id="h49-2-11" class="i">+    labels: [
</a><a href="#h49-2-12" id="h49-2-12" class="i">+        Some(
</a><a href="#h49-2-13" id="h49-2-13" class="i">+            (
</a><a href="#h49-2-14" id="h49-2-14" class="i">+                Some(
</a><a href="#h49-2-15" id="h49-2-15" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-2-16" id="h49-2-16" class="i">+                ),
</a><a href="#h49-2-17" id="h49-2-17" class="i">+                &quot;id&quot;,
</a><a href="#h49-2-18" id="h49-2-18" class="i">+            ),
</a><a href="#h49-2-19" id="h49-2-19" class="i">+        ),
</a><a href="#h49-2-20" id="h49-2-20" class="i">+        Some(
</a><a href="#h49-2-21" id="h49-2-21" class="i">+            (
</a><a href="#h49-2-22" id="h49-2-22" class="i">+                Some(
</a><a href="#h49-2-23" id="h49-2-23" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-2-24" id="h49-2-24" class="i">+                ),
</a><a href="#h49-2-25" id="h49-2-25" class="i">+                &quot;title&quot;,
</a><a href="#h49-2-26" id="h49-2-26" class="i">+            ),
</a><a href="#h49-2-27" id="h49-2-27" class="i">+        ),
</a><a href="#h49-2-28" id="h49-2-28" class="i">+        Some(
</a><a href="#h49-2-29" id="h49-2-29" class="i">+            (
</a><a href="#h49-2-30" id="h49-2-30" class="i">+                Some(
</a><a href="#h49-2-31" id="h49-2-31" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-2-32" id="h49-2-32" class="i">+                ),
</a><a href="#h49-2-33" id="h49-2-33" class="i">+                &quot;studio_id&quot;,
</a><a href="#h49-2-34" id="h49-2-34" class="i">+            ),
</a><a href="#h49-2-35" id="h49-2-35" class="i">+        ),
</a><a href="#h49-2-36" id="h49-2-36" class="i">+        Some(
</a><a href="#h49-2-37" id="h49-2-37" class="i">+            (
</a><a href="#h49-2-38" id="h49-2-38" class="i">+                Some(
</a><a href="#h49-2-39" id="h49-2-39" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-2-40" id="h49-2-40" class="i">+                ),
</a><a href="#h49-2-41" id="h49-2-41" class="i">+                &quot;genre_id&quot;,
</a><a href="#h49-2-42" id="h49-2-42" class="i">+            ),
</a><a href="#h49-2-43" id="h49-2-43" class="i">+        ),
</a><a href="#h49-2-44" id="h49-2-44" class="i">+        Some(
</a><a href="#h49-2-45" id="h49-2-45" class="i">+            (
</a><a href="#h49-2-46" id="h49-2-46" class="i">+                Some(
</a><a href="#h49-2-47" id="h49-2-47" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-2-48" id="h49-2-48" class="i">+                ),
</a><a href="#h49-2-49" id="h49-2-49" class="i">+                &quot;released&quot;,
</a><a href="#h49-2-50" id="h49-2-50" class="i">+            ),
</a><a href="#h49-2-51" id="h49-2-51" class="i">+        ),
</a><a href="#h49-2-52" id="h49-2-52" class="i">+        Some(
</a><a href="#h49-2-53" id="h49-2-53" class="i">+            (
</a><a href="#h49-2-54" id="h49-2-54" class="i">+                Some(
</a><a href="#h49-2-55" id="h49-2-55" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-2-56" id="h49-2-56" class="i">+                ),
</a><a href="#h49-2-57" id="h49-2-57" class="i">+                &quot;rating&quot;,
</a><a href="#h49-2-58" id="h49-2-58" class="i">+            ),
</a><a href="#h49-2-59" id="h49-2-59" class="i">+        ),
</a><a href="#h49-2-60" id="h49-2-60" class="i">+        Some(
</a><a href="#h49-2-61" id="h49-2-61" class="i">+            (
</a><a href="#h49-2-62" id="h49-2-62" class="i">+                Some(
</a><a href="#h49-2-63" id="h49-2-63" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-2-64" id="h49-2-64" class="i">+                ),
</a><a href="#h49-2-65" id="h49-2-65" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h49-2-66" id="h49-2-66" class="i">+            ),
</a><a href="#h49-2-67" id="h49-2-67" class="i">+        ),
</a><a href="#h49-2-68" id="h49-2-68" class="i">+        Some(
</a><a href="#h49-2-69" id="h49-2-69" class="i">+            (
</a><a href="#h49-2-70" id="h49-2-70" class="i">+                Some(
</a><a href="#h49-2-71" id="h49-2-71" class="i">+                    &quot;genres&quot;,
</a><a href="#h49-2-72" id="h49-2-72" class="i">+                ),
</a><a href="#h49-2-73" id="h49-2-73" class="i">+                &quot;id&quot;,
</a><a href="#h49-2-74" id="h49-2-74" class="i">+            ),
</a><a href="#h49-2-75" id="h49-2-75" class="i">+        ),
</a><a href="#h49-2-76" id="h49-2-76" class="i">+        Some(
</a><a href="#h49-2-77" id="h49-2-77" class="i">+            (
</a><a href="#h49-2-78" id="h49-2-78" class="i">+                Some(
</a><a href="#h49-2-79" id="h49-2-79" class="i">+                    &quot;genres&quot;,
</a><a href="#h49-2-80" id="h49-2-80" class="i">+                ),
</a><a href="#h49-2-81" id="h49-2-81" class="i">+                &quot;name&quot;,
</a><a href="#h49-2-82" id="h49-2-82" class="i">+            ),
</a><a href="#h49-2-83" id="h49-2-83" class="i">+        ),
</a><a href="#h49-2-84" id="h49-2-84" class="i">+    ],
</a><a href="#h49-2-85" id="h49-2-85" class="i">+}
</a> 
<a href="#h49-2-87" id="h49-2-87" class="d">-Optimized plan: Select(
</a><a href="#h49-2-88" id="h49-2-88" class="d">-    NestedLoopJoin {
</a><a href="#h49-2-89" id="h49-2-89" class="i">+Optimized plan: Select {
</a><a href="#h49-2-90" id="h49-2-90" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h49-3" id="h49-3" class="h">@@ -258,8 +332,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h49-3-3" id="h49-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h49-3-5" id="h49-3-5" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h49-4" id="h49-4" class="h">@@ -287,11 +361,85 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h49-4-3" id="h49-4-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h49-4-5" id="h49-4-5" class="i">+            alias: None,
</a>         },
         predicate: None,
         outer: false,
     },
<a href="#h49-4-10" id="h49-4-10" class="d">-)
</a><a href="#h49-4-11" id="h49-4-11" class="i">+    labels: [
</a><a href="#h49-4-12" id="h49-4-12" class="i">+        Some(
</a><a href="#h49-4-13" id="h49-4-13" class="i">+            (
</a><a href="#h49-4-14" id="h49-4-14" class="i">+                Some(
</a><a href="#h49-4-15" id="h49-4-15" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-4-16" id="h49-4-16" class="i">+                ),
</a><a href="#h49-4-17" id="h49-4-17" class="i">+                &quot;id&quot;,
</a><a href="#h49-4-18" id="h49-4-18" class="i">+            ),
</a><a href="#h49-4-19" id="h49-4-19" class="i">+        ),
</a><a href="#h49-4-20" id="h49-4-20" class="i">+        Some(
</a><a href="#h49-4-21" id="h49-4-21" class="i">+            (
</a><a href="#h49-4-22" id="h49-4-22" class="i">+                Some(
</a><a href="#h49-4-23" id="h49-4-23" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-4-24" id="h49-4-24" class="i">+                ),
</a><a href="#h49-4-25" id="h49-4-25" class="i">+                &quot;title&quot;,
</a><a href="#h49-4-26" id="h49-4-26" class="i">+            ),
</a><a href="#h49-4-27" id="h49-4-27" class="i">+        ),
</a><a href="#h49-4-28" id="h49-4-28" class="i">+        Some(
</a><a href="#h49-4-29" id="h49-4-29" class="i">+            (
</a><a href="#h49-4-30" id="h49-4-30" class="i">+                Some(
</a><a href="#h49-4-31" id="h49-4-31" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-4-32" id="h49-4-32" class="i">+                ),
</a><a href="#h49-4-33" id="h49-4-33" class="i">+                &quot;studio_id&quot;,
</a><a href="#h49-4-34" id="h49-4-34" class="i">+            ),
</a><a href="#h49-4-35" id="h49-4-35" class="i">+        ),
</a><a href="#h49-4-36" id="h49-4-36" class="i">+        Some(
</a><a href="#h49-4-37" id="h49-4-37" class="i">+            (
</a><a href="#h49-4-38" id="h49-4-38" class="i">+                Some(
</a><a href="#h49-4-39" id="h49-4-39" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-4-40" id="h49-4-40" class="i">+                ),
</a><a href="#h49-4-41" id="h49-4-41" class="i">+                &quot;genre_id&quot;,
</a><a href="#h49-4-42" id="h49-4-42" class="i">+            ),
</a><a href="#h49-4-43" id="h49-4-43" class="i">+        ),
</a><a href="#h49-4-44" id="h49-4-44" class="i">+        Some(
</a><a href="#h49-4-45" id="h49-4-45" class="i">+            (
</a><a href="#h49-4-46" id="h49-4-46" class="i">+                Some(
</a><a href="#h49-4-47" id="h49-4-47" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-4-48" id="h49-4-48" class="i">+                ),
</a><a href="#h49-4-49" id="h49-4-49" class="i">+                &quot;released&quot;,
</a><a href="#h49-4-50" id="h49-4-50" class="i">+            ),
</a><a href="#h49-4-51" id="h49-4-51" class="i">+        ),
</a><a href="#h49-4-52" id="h49-4-52" class="i">+        Some(
</a><a href="#h49-4-53" id="h49-4-53" class="i">+            (
</a><a href="#h49-4-54" id="h49-4-54" class="i">+                Some(
</a><a href="#h49-4-55" id="h49-4-55" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-4-56" id="h49-4-56" class="i">+                ),
</a><a href="#h49-4-57" id="h49-4-57" class="i">+                &quot;rating&quot;,
</a><a href="#h49-4-58" id="h49-4-58" class="i">+            ),
</a><a href="#h49-4-59" id="h49-4-59" class="i">+        ),
</a><a href="#h49-4-60" id="h49-4-60" class="i">+        Some(
</a><a href="#h49-4-61" id="h49-4-61" class="i">+            (
</a><a href="#h49-4-62" id="h49-4-62" class="i">+                Some(
</a><a href="#h49-4-63" id="h49-4-63" class="i">+                    &quot;movies&quot;,
</a><a href="#h49-4-64" id="h49-4-64" class="i">+                ),
</a><a href="#h49-4-65" id="h49-4-65" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h49-4-66" id="h49-4-66" class="i">+            ),
</a><a href="#h49-4-67" id="h49-4-67" class="i">+        ),
</a><a href="#h49-4-68" id="h49-4-68" class="i">+        Some(
</a><a href="#h49-4-69" id="h49-4-69" class="i">+            (
</a><a href="#h49-4-70" id="h49-4-70" class="i">+                Some(
</a><a href="#h49-4-71" id="h49-4-71" class="i">+                    &quot;genres&quot;,
</a><a href="#h49-4-72" id="h49-4-72" class="i">+                ),
</a><a href="#h49-4-73" id="h49-4-73" class="i">+                &quot;id&quot;,
</a><a href="#h49-4-74" id="h49-4-74" class="i">+            ),
</a><a href="#h49-4-75" id="h49-4-75" class="i">+        ),
</a><a href="#h49-4-76" id="h49-4-76" class="i">+        Some(
</a><a href="#h49-4-77" id="h49-4-77" class="i">+            (
</a><a href="#h49-4-78" id="h49-4-78" class="i">+                Some(
</a><a href="#h49-4-79" id="h49-4-79" class="i">+                    &quot;genres&quot;,
</a><a href="#h49-4-80" id="h49-4-80" class="i">+                ),
</a><a href="#h49-4-81" id="h49-4-81" class="i">+                &quot;name&quot;,
</a><a href="#h49-4-82" id="h49-4-82" class="i">+            ),
</a><a href="#h49-4-83" id="h49-4-83" class="i">+        ),
</a><a href="#h49-4-84" id="h49-4-84" class="i">+    ],
</a><a href="#h49-4-85" id="h49-4-85" class="i">+}
</a> 
<b>diff --git a/<a id="h50" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -177,8 +177,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h50-0-3" id="h50-0-3" class="d">-Plan: Select(
</a><a href="#h50-0-4" id="h50-0-4" class="d">-    Projection {
</a><a href="#h50-0-5" id="h50-0-5" class="i">+Plan: Select {
</a><a href="#h50-0-6" id="h50-0-6" class="i">+    root: Projection {
</a>         source: Filter {
             source: NestedLoopJoin {
                 left: NestedLoopJoin {
<a href="#h50-1" id="h50-1" class="h">@@ -260,10 +260,10 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h50-1-3" id="h50-1-3" class="i">+                        filter: None,
</a>                         alias: Some(
                             &quot;m&quot;,
                         ),
<a href="#h50-1-7" id="h50-1-7" class="d">-                        filter: None,
</a>                     },
                     left_size: 7,
                     right: Scan {
<a href="#h50-2" id="h50-2" class="h">@@ -291,10 +291,10 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h50-2-3" id="h50-2-3" class="i">+                        filter: None,
</a>                         alias: Some(
                             &quot;g&quot;,
                         ),
<a href="#h50-2-7" id="h50-2-7" class="d">-                        filter: None,
</a>                     },
                     predicate: None,
                     outer: false,
<a href="#h50-3" id="h50-3" class="h">@@ -325,10 +325,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h50-3-3" id="h50-3-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;c&quot;,
                     ),
<a href="#h50-3-7" id="h50-3-7" class="d">-                    filter: None,
</a>                 },
                 predicate: None,
                 outer: false,
<a href="#h50-4" id="h50-4" class="h">@@ -414,14 +414,6 @@ Plan: Select(
</a>                 ),
             ),
         },
<a href="#h50-4-3" id="h50-4-3" class="d">-        labels: [
</a><a href="#h50-4-4" id="h50-4-4" class="d">-            None,
</a><a href="#h50-4-5" id="h50-4-5" class="d">-            None,
</a><a href="#h50-4-6" id="h50-4-6" class="d">-            None,
</a><a href="#h50-4-7" id="h50-4-7" class="d">-            None,
</a><a href="#h50-4-8" id="h50-4-8" class="d">-            None,
</a><a href="#h50-4-9" id="h50-4-9" class="d">-            None,
</a><a href="#h50-4-10" id="h50-4-10" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h50-5" id="h50-5" class="h">@@ -490,11 +482,69 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h50-5-3" id="h50-5-3" class="i">+        labels: [
</a><a href="#h50-5-4" id="h50-5-4" class="i">+            None,
</a><a href="#h50-5-5" id="h50-5-5" class="i">+            None,
</a><a href="#h50-5-6" id="h50-5-6" class="i">+            None,
</a><a href="#h50-5-7" id="h50-5-7" class="i">+            None,
</a><a href="#h50-5-8" id="h50-5-8" class="i">+            None,
</a><a href="#h50-5-9" id="h50-5-9" class="i">+            None,
</a><a href="#h50-5-10" id="h50-5-10" class="i">+        ],
</a>     },
<a href="#h50-5-12" id="h50-5-12" class="d">-)
</a><a href="#h50-5-13" id="h50-5-13" class="i">+    labels: [
</a><a href="#h50-5-14" id="h50-5-14" class="i">+        Some(
</a><a href="#h50-5-15" id="h50-5-15" class="i">+            (
</a><a href="#h50-5-16" id="h50-5-16" class="i">+                Some(
</a><a href="#h50-5-17" id="h50-5-17" class="i">+                    &quot;m&quot;,
</a><a href="#h50-5-18" id="h50-5-18" class="i">+                ),
</a><a href="#h50-5-19" id="h50-5-19" class="i">+                &quot;id&quot;,
</a><a href="#h50-5-20" id="h50-5-20" class="i">+            ),
</a><a href="#h50-5-21" id="h50-5-21" class="i">+        ),
</a><a href="#h50-5-22" id="h50-5-22" class="i">+        Some(
</a><a href="#h50-5-23" id="h50-5-23" class="i">+            (
</a><a href="#h50-5-24" id="h50-5-24" class="i">+                Some(
</a><a href="#h50-5-25" id="h50-5-25" class="i">+                    &quot;m&quot;,
</a><a href="#h50-5-26" id="h50-5-26" class="i">+                ),
</a><a href="#h50-5-27" id="h50-5-27" class="i">+                &quot;title&quot;,
</a><a href="#h50-5-28" id="h50-5-28" class="i">+            ),
</a><a href="#h50-5-29" id="h50-5-29" class="i">+        ),
</a><a href="#h50-5-30" id="h50-5-30" class="i">+        Some(
</a><a href="#h50-5-31" id="h50-5-31" class="i">+            (
</a><a href="#h50-5-32" id="h50-5-32" class="i">+                Some(
</a><a href="#h50-5-33" id="h50-5-33" class="i">+                    &quot;g&quot;,
</a><a href="#h50-5-34" id="h50-5-34" class="i">+                ),
</a><a href="#h50-5-35" id="h50-5-35" class="i">+                &quot;id&quot;,
</a><a href="#h50-5-36" id="h50-5-36" class="i">+            ),
</a><a href="#h50-5-37" id="h50-5-37" class="i">+        ),
</a><a href="#h50-5-38" id="h50-5-38" class="i">+        Some(
</a><a href="#h50-5-39" id="h50-5-39" class="i">+            (
</a><a href="#h50-5-40" id="h50-5-40" class="i">+                Some(
</a><a href="#h50-5-41" id="h50-5-41" class="i">+                    &quot;g&quot;,
</a><a href="#h50-5-42" id="h50-5-42" class="i">+                ),
</a><a href="#h50-5-43" id="h50-5-43" class="i">+                &quot;name&quot;,
</a><a href="#h50-5-44" id="h50-5-44" class="i">+            ),
</a><a href="#h50-5-45" id="h50-5-45" class="i">+        ),
</a><a href="#h50-5-46" id="h50-5-46" class="i">+        Some(
</a><a href="#h50-5-47" id="h50-5-47" class="i">+            (
</a><a href="#h50-5-48" id="h50-5-48" class="i">+                Some(
</a><a href="#h50-5-49" id="h50-5-49" class="i">+                    &quot;c&quot;,
</a><a href="#h50-5-50" id="h50-5-50" class="i">+                ),
</a><a href="#h50-5-51" id="h50-5-51" class="i">+                &quot;id&quot;,
</a><a href="#h50-5-52" id="h50-5-52" class="i">+            ),
</a><a href="#h50-5-53" id="h50-5-53" class="i">+        ),
</a><a href="#h50-5-54" id="h50-5-54" class="i">+        Some(
</a><a href="#h50-5-55" id="h50-5-55" class="i">+            (
</a><a href="#h50-5-56" id="h50-5-56" class="i">+                Some(
</a><a href="#h50-5-57" id="h50-5-57" class="i">+                    &quot;c&quot;,
</a><a href="#h50-5-58" id="h50-5-58" class="i">+                ),
</a><a href="#h50-5-59" id="h50-5-59" class="i">+                &quot;name&quot;,
</a><a href="#h50-5-60" id="h50-5-60" class="i">+            ),
</a><a href="#h50-5-61" id="h50-5-61" class="i">+        ),
</a><a href="#h50-5-62" id="h50-5-62" class="i">+    ],
</a><a href="#h50-5-63" id="h50-5-63" class="i">+}
</a> 
<a href="#h50-5-65" id="h50-5-65" class="d">-Optimized plan: Select(
</a><a href="#h50-5-66" id="h50-5-66" class="d">-    Projection {
</a><a href="#h50-5-67" id="h50-5-67" class="i">+Optimized plan: Select {
</a><a href="#h50-5-68" id="h50-5-68" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: NestedLoopJoin {
                 left: Scan {
<a href="#h50-6" id="h50-6" class="h">@@ -575,9 +625,6 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h50-6-3" id="h50-6-3" class="d">-                    alias: Some(
</a><a href="#h50-6-4" id="h50-6-4" class="d">-                        &quot;m&quot;,
</a><a href="#h50-6-5" id="h50-6-5" class="d">-                    ),
</a>                     filter: Some(
                         Or(
                             GreaterThan(
<a href="#h50-7" id="h50-7" class="h">@@ -618,6 +665,9 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ),
<a href="#h50-7-3" id="h50-7-3" class="i">+                    alias: Some(
</a><a href="#h50-7-4" id="h50-7-4" class="i">+                        &quot;m&quot;,
</a><a href="#h50-7-5" id="h50-7-5" class="i">+                    ),
</a>                 },
                 left_size: 7,
                 right: KeyLookup {
<a href="#h50-8" id="h50-8" class="h">@@ -683,9 +733,6 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h50-8-3" id="h50-8-3" class="d">-                alias: Some(
</a><a href="#h50-8-4" id="h50-8-4" class="d">-                    &quot;c&quot;,
</a><a href="#h50-8-5" id="h50-8-5" class="d">-                ),
</a>                 filter: Some(
                     Not(
                         Equal(
<a href="#h50-9" id="h50-9" class="h">@@ -708,18 +755,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ),
<a href="#h50-9-3" id="h50-9-3" class="i">+                alias: Some(
</a><a href="#h50-9-4" id="h50-9-4" class="i">+                    &quot;c&quot;,
</a><a href="#h50-9-5" id="h50-9-5" class="i">+                ),
</a>             },
             predicate: None,
             outer: false,
         },
<a href="#h50-9-10" id="h50-9-10" class="d">-        labels: [
</a><a href="#h50-9-11" id="h50-9-11" class="d">-            None,
</a><a href="#h50-9-12" id="h50-9-12" class="d">-            None,
</a><a href="#h50-9-13" id="h50-9-13" class="d">-            None,
</a><a href="#h50-9-14" id="h50-9-14" class="d">-            None,
</a><a href="#h50-9-15" id="h50-9-15" class="d">-            None,
</a><a href="#h50-9-16" id="h50-9-16" class="d">-            None,
</a><a href="#h50-9-17" id="h50-9-17" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h50-10" id="h50-10" class="h">@@ -788,6 +830,64 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h50-10-3" id="h50-10-3" class="i">+        labels: [
</a><a href="#h50-10-4" id="h50-10-4" class="i">+            None,
</a><a href="#h50-10-5" id="h50-10-5" class="i">+            None,
</a><a href="#h50-10-6" id="h50-10-6" class="i">+            None,
</a><a href="#h50-10-7" id="h50-10-7" class="i">+            None,
</a><a href="#h50-10-8" id="h50-10-8" class="i">+            None,
</a><a href="#h50-10-9" id="h50-10-9" class="i">+            None,
</a><a href="#h50-10-10" id="h50-10-10" class="i">+        ],
</a>     },
<a href="#h50-10-12" id="h50-10-12" class="d">-)
</a><a href="#h50-10-13" id="h50-10-13" class="i">+    labels: [
</a><a href="#h50-10-14" id="h50-10-14" class="i">+        Some(
</a><a href="#h50-10-15" id="h50-10-15" class="i">+            (
</a><a href="#h50-10-16" id="h50-10-16" class="i">+                Some(
</a><a href="#h50-10-17" id="h50-10-17" class="i">+                    &quot;m&quot;,
</a><a href="#h50-10-18" id="h50-10-18" class="i">+                ),
</a><a href="#h50-10-19" id="h50-10-19" class="i">+                &quot;id&quot;,
</a><a href="#h50-10-20" id="h50-10-20" class="i">+            ),
</a><a href="#h50-10-21" id="h50-10-21" class="i">+        ),
</a><a href="#h50-10-22" id="h50-10-22" class="i">+        Some(
</a><a href="#h50-10-23" id="h50-10-23" class="i">+            (
</a><a href="#h50-10-24" id="h50-10-24" class="i">+                Some(
</a><a href="#h50-10-25" id="h50-10-25" class="i">+                    &quot;m&quot;,
</a><a href="#h50-10-26" id="h50-10-26" class="i">+                ),
</a><a href="#h50-10-27" id="h50-10-27" class="i">+                &quot;title&quot;,
</a><a href="#h50-10-28" id="h50-10-28" class="i">+            ),
</a><a href="#h50-10-29" id="h50-10-29" class="i">+        ),
</a><a href="#h50-10-30" id="h50-10-30" class="i">+        Some(
</a><a href="#h50-10-31" id="h50-10-31" class="i">+            (
</a><a href="#h50-10-32" id="h50-10-32" class="i">+                Some(
</a><a href="#h50-10-33" id="h50-10-33" class="i">+                    &quot;g&quot;,
</a><a href="#h50-10-34" id="h50-10-34" class="i">+                ),
</a><a href="#h50-10-35" id="h50-10-35" class="i">+                &quot;id&quot;,
</a><a href="#h50-10-36" id="h50-10-36" class="i">+            ),
</a><a href="#h50-10-37" id="h50-10-37" class="i">+        ),
</a><a href="#h50-10-38" id="h50-10-38" class="i">+        Some(
</a><a href="#h50-10-39" id="h50-10-39" class="i">+            (
</a><a href="#h50-10-40" id="h50-10-40" class="i">+                Some(
</a><a href="#h50-10-41" id="h50-10-41" class="i">+                    &quot;g&quot;,
</a><a href="#h50-10-42" id="h50-10-42" class="i">+                ),
</a><a href="#h50-10-43" id="h50-10-43" class="i">+                &quot;name&quot;,
</a><a href="#h50-10-44" id="h50-10-44" class="i">+            ),
</a><a href="#h50-10-45" id="h50-10-45" class="i">+        ),
</a><a href="#h50-10-46" id="h50-10-46" class="i">+        Some(
</a><a href="#h50-10-47" id="h50-10-47" class="i">+            (
</a><a href="#h50-10-48" id="h50-10-48" class="i">+                Some(
</a><a href="#h50-10-49" id="h50-10-49" class="i">+                    &quot;c&quot;,
</a><a href="#h50-10-50" id="h50-10-50" class="i">+                ),
</a><a href="#h50-10-51" id="h50-10-51" class="i">+                &quot;id&quot;,
</a><a href="#h50-10-52" id="h50-10-52" class="i">+            ),
</a><a href="#h50-10-53" id="h50-10-53" class="i">+        ),
</a><a href="#h50-10-54" id="h50-10-54" class="i">+        Some(
</a><a href="#h50-10-55" id="h50-10-55" class="i">+            (
</a><a href="#h50-10-56" id="h50-10-56" class="i">+                Some(
</a><a href="#h50-10-57" id="h50-10-57" class="i">+                    &quot;c&quot;,
</a><a href="#h50-10-58" id="h50-10-58" class="i">+                ),
</a><a href="#h50-10-59" id="h50-10-59" class="i">+                &quot;name&quot;,
</a><a href="#h50-10-60" id="h50-10-60" class="i">+            ),
</a><a href="#h50-10-61" id="h50-10-61" class="i">+        ),
</a><a href="#h50-10-62" id="h50-10-62" class="i">+    ],
</a><a href="#h50-10-63" id="h50-10-63" class="i">+}
</a> 
<b>diff --git a/<a id="h51" href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a> b/<a href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -411,8 +411,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h51-0-3" id="h51-0-3" class="d">-Plan: Select(
</a><a href="#h51-0-4" id="h51-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h51-0-5" id="h51-0-5" class="i">+Plan: Select {
</a><a href="#h51-0-6" id="h51-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: NestedLoopJoin {
             left: NestedLoopJoin {
                 left: Scan {
<a href="#h51-1" id="h51-1" class="h">@@ -493,8 +493,8 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h51-1-3" id="h51-1-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h51-1-5" id="h51-1-5" class="i">+                    alias: None,
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h51-2" id="h51-2" class="h">@@ -522,8 +522,8 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h51-2-3" id="h51-2-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h51-2-5" id="h51-2-5" class="i">+                    alias: None,
</a>                 },
                 predicate: None,
                 outer: false,
<a href="#h51-3" id="h51-3" class="h">@@ -554,8 +554,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h51-3-3" id="h51-3-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h51-3-5" id="h51-3-5" class="i">+                alias: None,
</a>             },
             predicate: None,
             outer: false,
<a href="#h51-4" id="h51-4" class="h">@@ -599,16 +599,130 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h51-4-3" id="h51-4-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h51-4-5" id="h51-4-5" class="i">+            alias: None,
</a>         },
         predicate: None,
         outer: false,
     },
<a href="#h51-4-10" id="h51-4-10" class="d">-)
</a><a href="#h51-4-11" id="h51-4-11" class="i">+    labels: [
</a><a href="#h51-4-12" id="h51-4-12" class="i">+        Some(
</a><a href="#h51-4-13" id="h51-4-13" class="i">+            (
</a><a href="#h51-4-14" id="h51-4-14" class="i">+                Some(
</a><a href="#h51-4-15" id="h51-4-15" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-4-16" id="h51-4-16" class="i">+                ),
</a><a href="#h51-4-17" id="h51-4-17" class="i">+                &quot;id&quot;,
</a><a href="#h51-4-18" id="h51-4-18" class="i">+            ),
</a><a href="#h51-4-19" id="h51-4-19" class="i">+        ),
</a><a href="#h51-4-20" id="h51-4-20" class="i">+        Some(
</a><a href="#h51-4-21" id="h51-4-21" class="i">+            (
</a><a href="#h51-4-22" id="h51-4-22" class="i">+                Some(
</a><a href="#h51-4-23" id="h51-4-23" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-4-24" id="h51-4-24" class="i">+                ),
</a><a href="#h51-4-25" id="h51-4-25" class="i">+                &quot;title&quot;,
</a><a href="#h51-4-26" id="h51-4-26" class="i">+            ),
</a><a href="#h51-4-27" id="h51-4-27" class="i">+        ),
</a><a href="#h51-4-28" id="h51-4-28" class="i">+        Some(
</a><a href="#h51-4-29" id="h51-4-29" class="i">+            (
</a><a href="#h51-4-30" id="h51-4-30" class="i">+                Some(
</a><a href="#h51-4-31" id="h51-4-31" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-4-32" id="h51-4-32" class="i">+                ),
</a><a href="#h51-4-33" id="h51-4-33" class="i">+                &quot;studio_id&quot;,
</a><a href="#h51-4-34" id="h51-4-34" class="i">+            ),
</a><a href="#h51-4-35" id="h51-4-35" class="i">+        ),
</a><a href="#h51-4-36" id="h51-4-36" class="i">+        Some(
</a><a href="#h51-4-37" id="h51-4-37" class="i">+            (
</a><a href="#h51-4-38" id="h51-4-38" class="i">+                Some(
</a><a href="#h51-4-39" id="h51-4-39" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-4-40" id="h51-4-40" class="i">+                ),
</a><a href="#h51-4-41" id="h51-4-41" class="i">+                &quot;genre_id&quot;,
</a><a href="#h51-4-42" id="h51-4-42" class="i">+            ),
</a><a href="#h51-4-43" id="h51-4-43" class="i">+        ),
</a><a href="#h51-4-44" id="h51-4-44" class="i">+        Some(
</a><a href="#h51-4-45" id="h51-4-45" class="i">+            (
</a><a href="#h51-4-46" id="h51-4-46" class="i">+                Some(
</a><a href="#h51-4-47" id="h51-4-47" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-4-48" id="h51-4-48" class="i">+                ),
</a><a href="#h51-4-49" id="h51-4-49" class="i">+                &quot;released&quot;,
</a><a href="#h51-4-50" id="h51-4-50" class="i">+            ),
</a><a href="#h51-4-51" id="h51-4-51" class="i">+        ),
</a><a href="#h51-4-52" id="h51-4-52" class="i">+        Some(
</a><a href="#h51-4-53" id="h51-4-53" class="i">+            (
</a><a href="#h51-4-54" id="h51-4-54" class="i">+                Some(
</a><a href="#h51-4-55" id="h51-4-55" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-4-56" id="h51-4-56" class="i">+                ),
</a><a href="#h51-4-57" id="h51-4-57" class="i">+                &quot;rating&quot;,
</a><a href="#h51-4-58" id="h51-4-58" class="i">+            ),
</a><a href="#h51-4-59" id="h51-4-59" class="i">+        ),
</a><a href="#h51-4-60" id="h51-4-60" class="i">+        Some(
</a><a href="#h51-4-61" id="h51-4-61" class="i">+            (
</a><a href="#h51-4-62" id="h51-4-62" class="i">+                Some(
</a><a href="#h51-4-63" id="h51-4-63" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-4-64" id="h51-4-64" class="i">+                ),
</a><a href="#h51-4-65" id="h51-4-65" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h51-4-66" id="h51-4-66" class="i">+            ),
</a><a href="#h51-4-67" id="h51-4-67" class="i">+        ),
</a><a href="#h51-4-68" id="h51-4-68" class="i">+        Some(
</a><a href="#h51-4-69" id="h51-4-69" class="i">+            (
</a><a href="#h51-4-70" id="h51-4-70" class="i">+                Some(
</a><a href="#h51-4-71" id="h51-4-71" class="i">+                    &quot;genres&quot;,
</a><a href="#h51-4-72" id="h51-4-72" class="i">+                ),
</a><a href="#h51-4-73" id="h51-4-73" class="i">+                &quot;id&quot;,
</a><a href="#h51-4-74" id="h51-4-74" class="i">+            ),
</a><a href="#h51-4-75" id="h51-4-75" class="i">+        ),
</a><a href="#h51-4-76" id="h51-4-76" class="i">+        Some(
</a><a href="#h51-4-77" id="h51-4-77" class="i">+            (
</a><a href="#h51-4-78" id="h51-4-78" class="i">+                Some(
</a><a href="#h51-4-79" id="h51-4-79" class="i">+                    &quot;genres&quot;,
</a><a href="#h51-4-80" id="h51-4-80" class="i">+                ),
</a><a href="#h51-4-81" id="h51-4-81" class="i">+                &quot;name&quot;,
</a><a href="#h51-4-82" id="h51-4-82" class="i">+            ),
</a><a href="#h51-4-83" id="h51-4-83" class="i">+        ),
</a><a href="#h51-4-84" id="h51-4-84" class="i">+        Some(
</a><a href="#h51-4-85" id="h51-4-85" class="i">+            (
</a><a href="#h51-4-86" id="h51-4-86" class="i">+                Some(
</a><a href="#h51-4-87" id="h51-4-87" class="i">+                    &quot;countries&quot;,
</a><a href="#h51-4-88" id="h51-4-88" class="i">+                ),
</a><a href="#h51-4-89" id="h51-4-89" class="i">+                &quot;id&quot;,
</a><a href="#h51-4-90" id="h51-4-90" class="i">+            ),
</a><a href="#h51-4-91" id="h51-4-91" class="i">+        ),
</a><a href="#h51-4-92" id="h51-4-92" class="i">+        Some(
</a><a href="#h51-4-93" id="h51-4-93" class="i">+            (
</a><a href="#h51-4-94" id="h51-4-94" class="i">+                Some(
</a><a href="#h51-4-95" id="h51-4-95" class="i">+                    &quot;countries&quot;,
</a><a href="#h51-4-96" id="h51-4-96" class="i">+                ),
</a><a href="#h51-4-97" id="h51-4-97" class="i">+                &quot;name&quot;,
</a><a href="#h51-4-98" id="h51-4-98" class="i">+            ),
</a><a href="#h51-4-99" id="h51-4-99" class="i">+        ),
</a><a href="#h51-4-100" id="h51-4-100" class="i">+        Some(
</a><a href="#h51-4-101" id="h51-4-101" class="i">+            (
</a><a href="#h51-4-102" id="h51-4-102" class="i">+                Some(
</a><a href="#h51-4-103" id="h51-4-103" class="i">+                    &quot;studios&quot;,
</a><a href="#h51-4-104" id="h51-4-104" class="i">+                ),
</a><a href="#h51-4-105" id="h51-4-105" class="i">+                &quot;id&quot;,
</a><a href="#h51-4-106" id="h51-4-106" class="i">+            ),
</a><a href="#h51-4-107" id="h51-4-107" class="i">+        ),
</a><a href="#h51-4-108" id="h51-4-108" class="i">+        Some(
</a><a href="#h51-4-109" id="h51-4-109" class="i">+            (
</a><a href="#h51-4-110" id="h51-4-110" class="i">+                Some(
</a><a href="#h51-4-111" id="h51-4-111" class="i">+                    &quot;studios&quot;,
</a><a href="#h51-4-112" id="h51-4-112" class="i">+                ),
</a><a href="#h51-4-113" id="h51-4-113" class="i">+                &quot;name&quot;,
</a><a href="#h51-4-114" id="h51-4-114" class="i">+            ),
</a><a href="#h51-4-115" id="h51-4-115" class="i">+        ),
</a><a href="#h51-4-116" id="h51-4-116" class="i">+        Some(
</a><a href="#h51-4-117" id="h51-4-117" class="i">+            (
</a><a href="#h51-4-118" id="h51-4-118" class="i">+                Some(
</a><a href="#h51-4-119" id="h51-4-119" class="i">+                    &quot;studios&quot;,
</a><a href="#h51-4-120" id="h51-4-120" class="i">+                ),
</a><a href="#h51-4-121" id="h51-4-121" class="i">+                &quot;country_id&quot;,
</a><a href="#h51-4-122" id="h51-4-122" class="i">+            ),
</a><a href="#h51-4-123" id="h51-4-123" class="i">+        ),
</a><a href="#h51-4-124" id="h51-4-124" class="i">+    ],
</a><a href="#h51-4-125" id="h51-4-125" class="i">+}
</a> 
<a href="#h51-4-127" id="h51-4-127" class="d">-Optimized plan: Select(
</a><a href="#h51-4-128" id="h51-4-128" class="d">-    NestedLoopJoin {
</a><a href="#h51-4-129" id="h51-4-129" class="i">+Optimized plan: Select {
</a><a href="#h51-4-130" id="h51-4-130" class="i">+    root: NestedLoopJoin {
</a>         left: NestedLoopJoin {
             left: NestedLoopJoin {
                 left: Scan {
<a href="#h51-5" id="h51-5" class="h">@@ -689,8 +803,8 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h51-5-3" id="h51-5-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h51-5-5" id="h51-5-5" class="i">+                    alias: None,
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h51-6" id="h51-6" class="h">@@ -718,8 +832,8 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h51-6-3" id="h51-6-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h51-6-5" id="h51-6-5" class="i">+                    alias: None,
</a>                 },
                 predicate: None,
                 outer: false,
<a href="#h51-7" id="h51-7" class="h">@@ -750,8 +864,8 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h51-7-3" id="h51-7-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h51-7-5" id="h51-7-5" class="i">+                alias: None,
</a>             },
             predicate: None,
             outer: false,
<a href="#h51-8" id="h51-8" class="h">@@ -795,11 +909,125 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h51-8-3" id="h51-8-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h51-8-5" id="h51-8-5" class="i">+            alias: None,
</a>         },
         predicate: None,
         outer: false,
     },
<a href="#h51-8-10" id="h51-8-10" class="d">-)
</a><a href="#h51-8-11" id="h51-8-11" class="i">+    labels: [
</a><a href="#h51-8-12" id="h51-8-12" class="i">+        Some(
</a><a href="#h51-8-13" id="h51-8-13" class="i">+            (
</a><a href="#h51-8-14" id="h51-8-14" class="i">+                Some(
</a><a href="#h51-8-15" id="h51-8-15" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-8-16" id="h51-8-16" class="i">+                ),
</a><a href="#h51-8-17" id="h51-8-17" class="i">+                &quot;id&quot;,
</a><a href="#h51-8-18" id="h51-8-18" class="i">+            ),
</a><a href="#h51-8-19" id="h51-8-19" class="i">+        ),
</a><a href="#h51-8-20" id="h51-8-20" class="i">+        Some(
</a><a href="#h51-8-21" id="h51-8-21" class="i">+            (
</a><a href="#h51-8-22" id="h51-8-22" class="i">+                Some(
</a><a href="#h51-8-23" id="h51-8-23" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-8-24" id="h51-8-24" class="i">+                ),
</a><a href="#h51-8-25" id="h51-8-25" class="i">+                &quot;title&quot;,
</a><a href="#h51-8-26" id="h51-8-26" class="i">+            ),
</a><a href="#h51-8-27" id="h51-8-27" class="i">+        ),
</a><a href="#h51-8-28" id="h51-8-28" class="i">+        Some(
</a><a href="#h51-8-29" id="h51-8-29" class="i">+            (
</a><a href="#h51-8-30" id="h51-8-30" class="i">+                Some(
</a><a href="#h51-8-31" id="h51-8-31" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-8-32" id="h51-8-32" class="i">+                ),
</a><a href="#h51-8-33" id="h51-8-33" class="i">+                &quot;studio_id&quot;,
</a><a href="#h51-8-34" id="h51-8-34" class="i">+            ),
</a><a href="#h51-8-35" id="h51-8-35" class="i">+        ),
</a><a href="#h51-8-36" id="h51-8-36" class="i">+        Some(
</a><a href="#h51-8-37" id="h51-8-37" class="i">+            (
</a><a href="#h51-8-38" id="h51-8-38" class="i">+                Some(
</a><a href="#h51-8-39" id="h51-8-39" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-8-40" id="h51-8-40" class="i">+                ),
</a><a href="#h51-8-41" id="h51-8-41" class="i">+                &quot;genre_id&quot;,
</a><a href="#h51-8-42" id="h51-8-42" class="i">+            ),
</a><a href="#h51-8-43" id="h51-8-43" class="i">+        ),
</a><a href="#h51-8-44" id="h51-8-44" class="i">+        Some(
</a><a href="#h51-8-45" id="h51-8-45" class="i">+            (
</a><a href="#h51-8-46" id="h51-8-46" class="i">+                Some(
</a><a href="#h51-8-47" id="h51-8-47" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-8-48" id="h51-8-48" class="i">+                ),
</a><a href="#h51-8-49" id="h51-8-49" class="i">+                &quot;released&quot;,
</a><a href="#h51-8-50" id="h51-8-50" class="i">+            ),
</a><a href="#h51-8-51" id="h51-8-51" class="i">+        ),
</a><a href="#h51-8-52" id="h51-8-52" class="i">+        Some(
</a><a href="#h51-8-53" id="h51-8-53" class="i">+            (
</a><a href="#h51-8-54" id="h51-8-54" class="i">+                Some(
</a><a href="#h51-8-55" id="h51-8-55" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-8-56" id="h51-8-56" class="i">+                ),
</a><a href="#h51-8-57" id="h51-8-57" class="i">+                &quot;rating&quot;,
</a><a href="#h51-8-58" id="h51-8-58" class="i">+            ),
</a><a href="#h51-8-59" id="h51-8-59" class="i">+        ),
</a><a href="#h51-8-60" id="h51-8-60" class="i">+        Some(
</a><a href="#h51-8-61" id="h51-8-61" class="i">+            (
</a><a href="#h51-8-62" id="h51-8-62" class="i">+                Some(
</a><a href="#h51-8-63" id="h51-8-63" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-8-64" id="h51-8-64" class="i">+                ),
</a><a href="#h51-8-65" id="h51-8-65" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h51-8-66" id="h51-8-66" class="i">+            ),
</a><a href="#h51-8-67" id="h51-8-67" class="i">+        ),
</a><a href="#h51-8-68" id="h51-8-68" class="i">+        Some(
</a><a href="#h51-8-69" id="h51-8-69" class="i">+            (
</a><a href="#h51-8-70" id="h51-8-70" class="i">+                Some(
</a><a href="#h51-8-71" id="h51-8-71" class="i">+                    &quot;genres&quot;,
</a><a href="#h51-8-72" id="h51-8-72" class="i">+                ),
</a><a href="#h51-8-73" id="h51-8-73" class="i">+                &quot;id&quot;,
</a><a href="#h51-8-74" id="h51-8-74" class="i">+            ),
</a><a href="#h51-8-75" id="h51-8-75" class="i">+        ),
</a><a href="#h51-8-76" id="h51-8-76" class="i">+        Some(
</a><a href="#h51-8-77" id="h51-8-77" class="i">+            (
</a><a href="#h51-8-78" id="h51-8-78" class="i">+                Some(
</a><a href="#h51-8-79" id="h51-8-79" class="i">+                    &quot;genres&quot;,
</a><a href="#h51-8-80" id="h51-8-80" class="i">+                ),
</a><a href="#h51-8-81" id="h51-8-81" class="i">+                &quot;name&quot;,
</a><a href="#h51-8-82" id="h51-8-82" class="i">+            ),
</a><a href="#h51-8-83" id="h51-8-83" class="i">+        ),
</a><a href="#h51-8-84" id="h51-8-84" class="i">+        Some(
</a><a href="#h51-8-85" id="h51-8-85" class="i">+            (
</a><a href="#h51-8-86" id="h51-8-86" class="i">+                Some(
</a><a href="#h51-8-87" id="h51-8-87" class="i">+                    &quot;countries&quot;,
</a><a href="#h51-8-88" id="h51-8-88" class="i">+                ),
</a><a href="#h51-8-89" id="h51-8-89" class="i">+                &quot;id&quot;,
</a><a href="#h51-8-90" id="h51-8-90" class="i">+            ),
</a><a href="#h51-8-91" id="h51-8-91" class="i">+        ),
</a><a href="#h51-8-92" id="h51-8-92" class="i">+        Some(
</a><a href="#h51-8-93" id="h51-8-93" class="i">+            (
</a><a href="#h51-8-94" id="h51-8-94" class="i">+                Some(
</a><a href="#h51-8-95" id="h51-8-95" class="i">+                    &quot;countries&quot;,
</a><a href="#h51-8-96" id="h51-8-96" class="i">+                ),
</a><a href="#h51-8-97" id="h51-8-97" class="i">+                &quot;name&quot;,
</a><a href="#h51-8-98" id="h51-8-98" class="i">+            ),
</a><a href="#h51-8-99" id="h51-8-99" class="i">+        ),
</a><a href="#h51-8-100" id="h51-8-100" class="i">+        Some(
</a><a href="#h51-8-101" id="h51-8-101" class="i">+            (
</a><a href="#h51-8-102" id="h51-8-102" class="i">+                Some(
</a><a href="#h51-8-103" id="h51-8-103" class="i">+                    &quot;studios&quot;,
</a><a href="#h51-8-104" id="h51-8-104" class="i">+                ),
</a><a href="#h51-8-105" id="h51-8-105" class="i">+                &quot;id&quot;,
</a><a href="#h51-8-106" id="h51-8-106" class="i">+            ),
</a><a href="#h51-8-107" id="h51-8-107" class="i">+        ),
</a><a href="#h51-8-108" id="h51-8-108" class="i">+        Some(
</a><a href="#h51-8-109" id="h51-8-109" class="i">+            (
</a><a href="#h51-8-110" id="h51-8-110" class="i">+                Some(
</a><a href="#h51-8-111" id="h51-8-111" class="i">+                    &quot;studios&quot;,
</a><a href="#h51-8-112" id="h51-8-112" class="i">+                ),
</a><a href="#h51-8-113" id="h51-8-113" class="i">+                &quot;name&quot;,
</a><a href="#h51-8-114" id="h51-8-114" class="i">+            ),
</a><a href="#h51-8-115" id="h51-8-115" class="i">+        ),
</a><a href="#h51-8-116" id="h51-8-116" class="i">+        Some(
</a><a href="#h51-8-117" id="h51-8-117" class="i">+            (
</a><a href="#h51-8-118" id="h51-8-118" class="i">+                Some(
</a><a href="#h51-8-119" id="h51-8-119" class="i">+                    &quot;studios&quot;,
</a><a href="#h51-8-120" id="h51-8-120" class="i">+                ),
</a><a href="#h51-8-121" id="h51-8-121" class="i">+                &quot;country_id&quot;,
</a><a href="#h51-8-122" id="h51-8-122" class="i">+            ),
</a><a href="#h51-8-123" id="h51-8-123" class="i">+        ),
</a><a href="#h51-8-124" id="h51-8-124" class="i">+    ],
</a><a href="#h51-8-125" id="h51-8-125" class="i">+}
</a> 
<b>diff --git a/<a id="h52" href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a> b/<a href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -58,8 +58,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h52-0-3" id="h52-0-3" class="d">-Plan: Select(
</a><a href="#h52-0-4" id="h52-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h52-0-5" id="h52-0-5" class="i">+Plan: Select {
</a><a href="#h52-0-6" id="h52-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h52-1" id="h52-1" class="h">@@ -138,8 +138,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h52-1-3" id="h52-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h52-1-5" id="h52-1-5" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h52-2" id="h52-2" class="h">@@ -167,8 +167,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h52-2-3" id="h52-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h52-2-5" id="h52-2-5" class="i">+            alias: None,
</a>         },
         predicate: Some(
             Equal(
<a href="#h52-3" id="h52-3" class="h">@@ -198,10 +198,84 @@ Plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h52-3-3" id="h52-3-3" class="d">-)
</a><a href="#h52-3-4" id="h52-3-4" class="i">+    labels: [
</a><a href="#h52-3-5" id="h52-3-5" class="i">+        Some(
</a><a href="#h52-3-6" id="h52-3-6" class="i">+            (
</a><a href="#h52-3-7" id="h52-3-7" class="i">+                Some(
</a><a href="#h52-3-8" id="h52-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-3-9" id="h52-3-9" class="i">+                ),
</a><a href="#h52-3-10" id="h52-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h52-3-11" id="h52-3-11" class="i">+            ),
</a><a href="#h52-3-12" id="h52-3-12" class="i">+        ),
</a><a href="#h52-3-13" id="h52-3-13" class="i">+        Some(
</a><a href="#h52-3-14" id="h52-3-14" class="i">+            (
</a><a href="#h52-3-15" id="h52-3-15" class="i">+                Some(
</a><a href="#h52-3-16" id="h52-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-3-17" id="h52-3-17" class="i">+                ),
</a><a href="#h52-3-18" id="h52-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h52-3-19" id="h52-3-19" class="i">+            ),
</a><a href="#h52-3-20" id="h52-3-20" class="i">+        ),
</a><a href="#h52-3-21" id="h52-3-21" class="i">+        Some(
</a><a href="#h52-3-22" id="h52-3-22" class="i">+            (
</a><a href="#h52-3-23" id="h52-3-23" class="i">+                Some(
</a><a href="#h52-3-24" id="h52-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-3-25" id="h52-3-25" class="i">+                ),
</a><a href="#h52-3-26" id="h52-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h52-3-27" id="h52-3-27" class="i">+            ),
</a><a href="#h52-3-28" id="h52-3-28" class="i">+        ),
</a><a href="#h52-3-29" id="h52-3-29" class="i">+        Some(
</a><a href="#h52-3-30" id="h52-3-30" class="i">+            (
</a><a href="#h52-3-31" id="h52-3-31" class="i">+                Some(
</a><a href="#h52-3-32" id="h52-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-3-33" id="h52-3-33" class="i">+                ),
</a><a href="#h52-3-34" id="h52-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h52-3-35" id="h52-3-35" class="i">+            ),
</a><a href="#h52-3-36" id="h52-3-36" class="i">+        ),
</a><a href="#h52-3-37" id="h52-3-37" class="i">+        Some(
</a><a href="#h52-3-38" id="h52-3-38" class="i">+            (
</a><a href="#h52-3-39" id="h52-3-39" class="i">+                Some(
</a><a href="#h52-3-40" id="h52-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-3-41" id="h52-3-41" class="i">+                ),
</a><a href="#h52-3-42" id="h52-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h52-3-43" id="h52-3-43" class="i">+            ),
</a><a href="#h52-3-44" id="h52-3-44" class="i">+        ),
</a><a href="#h52-3-45" id="h52-3-45" class="i">+        Some(
</a><a href="#h52-3-46" id="h52-3-46" class="i">+            (
</a><a href="#h52-3-47" id="h52-3-47" class="i">+                Some(
</a><a href="#h52-3-48" id="h52-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-3-49" id="h52-3-49" class="i">+                ),
</a><a href="#h52-3-50" id="h52-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h52-3-51" id="h52-3-51" class="i">+            ),
</a><a href="#h52-3-52" id="h52-3-52" class="i">+        ),
</a><a href="#h52-3-53" id="h52-3-53" class="i">+        Some(
</a><a href="#h52-3-54" id="h52-3-54" class="i">+            (
</a><a href="#h52-3-55" id="h52-3-55" class="i">+                Some(
</a><a href="#h52-3-56" id="h52-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-3-57" id="h52-3-57" class="i">+                ),
</a><a href="#h52-3-58" id="h52-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h52-3-59" id="h52-3-59" class="i">+            ),
</a><a href="#h52-3-60" id="h52-3-60" class="i">+        ),
</a><a href="#h52-3-61" id="h52-3-61" class="i">+        Some(
</a><a href="#h52-3-62" id="h52-3-62" class="i">+            (
</a><a href="#h52-3-63" id="h52-3-63" class="i">+                Some(
</a><a href="#h52-3-64" id="h52-3-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h52-3-65" id="h52-3-65" class="i">+                ),
</a><a href="#h52-3-66" id="h52-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h52-3-67" id="h52-3-67" class="i">+            ),
</a><a href="#h52-3-68" id="h52-3-68" class="i">+        ),
</a><a href="#h52-3-69" id="h52-3-69" class="i">+        Some(
</a><a href="#h52-3-70" id="h52-3-70" class="i">+            (
</a><a href="#h52-3-71" id="h52-3-71" class="i">+                Some(
</a><a href="#h52-3-72" id="h52-3-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h52-3-73" id="h52-3-73" class="i">+                ),
</a><a href="#h52-3-74" id="h52-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h52-3-75" id="h52-3-75" class="i">+            ),
</a><a href="#h52-3-76" id="h52-3-76" class="i">+        ),
</a><a href="#h52-3-77" id="h52-3-77" class="i">+    ],
</a><a href="#h52-3-78" id="h52-3-78" class="i">+}
</a> 
<a href="#h52-3-80" id="h52-3-80" class="d">-Optimized plan: Select(
</a><a href="#h52-3-81" id="h52-3-81" class="d">-    HashJoin {
</a><a href="#h52-3-82" id="h52-3-82" class="i">+Optimized plan: Select {
</a><a href="#h52-3-83" id="h52-3-83" class="i">+    root: HashJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h52-4" id="h52-4" class="h">@@ -280,8 +354,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h52-4-3" id="h52-4-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h52-4-5" id="h52-4-5" class="i">+            alias: None,
</a>         },
         left_field: (
             3,
<a href="#h52-5" id="h52-5" class="h">@@ -319,8 +393,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h52-5-3" id="h52-5-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h52-5-5" id="h52-5-5" class="i">+            alias: None,
</a>         },
         right_field: (
             0,
<a href="#h52-6" id="h52-6" class="h">@@ -335,5 +409,79 @@ Optimized plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h52-6-3" id="h52-6-3" class="d">-)
</a><a href="#h52-6-4" id="h52-6-4" class="i">+    labels: [
</a><a href="#h52-6-5" id="h52-6-5" class="i">+        Some(
</a><a href="#h52-6-6" id="h52-6-6" class="i">+            (
</a><a href="#h52-6-7" id="h52-6-7" class="i">+                Some(
</a><a href="#h52-6-8" id="h52-6-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-6-9" id="h52-6-9" class="i">+                ),
</a><a href="#h52-6-10" id="h52-6-10" class="i">+                &quot;id&quot;,
</a><a href="#h52-6-11" id="h52-6-11" class="i">+            ),
</a><a href="#h52-6-12" id="h52-6-12" class="i">+        ),
</a><a href="#h52-6-13" id="h52-6-13" class="i">+        Some(
</a><a href="#h52-6-14" id="h52-6-14" class="i">+            (
</a><a href="#h52-6-15" id="h52-6-15" class="i">+                Some(
</a><a href="#h52-6-16" id="h52-6-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-6-17" id="h52-6-17" class="i">+                ),
</a><a href="#h52-6-18" id="h52-6-18" class="i">+                &quot;title&quot;,
</a><a href="#h52-6-19" id="h52-6-19" class="i">+            ),
</a><a href="#h52-6-20" id="h52-6-20" class="i">+        ),
</a><a href="#h52-6-21" id="h52-6-21" class="i">+        Some(
</a><a href="#h52-6-22" id="h52-6-22" class="i">+            (
</a><a href="#h52-6-23" id="h52-6-23" class="i">+                Some(
</a><a href="#h52-6-24" id="h52-6-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-6-25" id="h52-6-25" class="i">+                ),
</a><a href="#h52-6-26" id="h52-6-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h52-6-27" id="h52-6-27" class="i">+            ),
</a><a href="#h52-6-28" id="h52-6-28" class="i">+        ),
</a><a href="#h52-6-29" id="h52-6-29" class="i">+        Some(
</a><a href="#h52-6-30" id="h52-6-30" class="i">+            (
</a><a href="#h52-6-31" id="h52-6-31" class="i">+                Some(
</a><a href="#h52-6-32" id="h52-6-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-6-33" id="h52-6-33" class="i">+                ),
</a><a href="#h52-6-34" id="h52-6-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h52-6-35" id="h52-6-35" class="i">+            ),
</a><a href="#h52-6-36" id="h52-6-36" class="i">+        ),
</a><a href="#h52-6-37" id="h52-6-37" class="i">+        Some(
</a><a href="#h52-6-38" id="h52-6-38" class="i">+            (
</a><a href="#h52-6-39" id="h52-6-39" class="i">+                Some(
</a><a href="#h52-6-40" id="h52-6-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-6-41" id="h52-6-41" class="i">+                ),
</a><a href="#h52-6-42" id="h52-6-42" class="i">+                &quot;released&quot;,
</a><a href="#h52-6-43" id="h52-6-43" class="i">+            ),
</a><a href="#h52-6-44" id="h52-6-44" class="i">+        ),
</a><a href="#h52-6-45" id="h52-6-45" class="i">+        Some(
</a><a href="#h52-6-46" id="h52-6-46" class="i">+            (
</a><a href="#h52-6-47" id="h52-6-47" class="i">+                Some(
</a><a href="#h52-6-48" id="h52-6-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-6-49" id="h52-6-49" class="i">+                ),
</a><a href="#h52-6-50" id="h52-6-50" class="i">+                &quot;rating&quot;,
</a><a href="#h52-6-51" id="h52-6-51" class="i">+            ),
</a><a href="#h52-6-52" id="h52-6-52" class="i">+        ),
</a><a href="#h52-6-53" id="h52-6-53" class="i">+        Some(
</a><a href="#h52-6-54" id="h52-6-54" class="i">+            (
</a><a href="#h52-6-55" id="h52-6-55" class="i">+                Some(
</a><a href="#h52-6-56" id="h52-6-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-6-57" id="h52-6-57" class="i">+                ),
</a><a href="#h52-6-58" id="h52-6-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h52-6-59" id="h52-6-59" class="i">+            ),
</a><a href="#h52-6-60" id="h52-6-60" class="i">+        ),
</a><a href="#h52-6-61" id="h52-6-61" class="i">+        Some(
</a><a href="#h52-6-62" id="h52-6-62" class="i">+            (
</a><a href="#h52-6-63" id="h52-6-63" class="i">+                Some(
</a><a href="#h52-6-64" id="h52-6-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h52-6-65" id="h52-6-65" class="i">+                ),
</a><a href="#h52-6-66" id="h52-6-66" class="i">+                &quot;id&quot;,
</a><a href="#h52-6-67" id="h52-6-67" class="i">+            ),
</a><a href="#h52-6-68" id="h52-6-68" class="i">+        ),
</a><a href="#h52-6-69" id="h52-6-69" class="i">+        Some(
</a><a href="#h52-6-70" id="h52-6-70" class="i">+            (
</a><a href="#h52-6-71" id="h52-6-71" class="i">+                Some(
</a><a href="#h52-6-72" id="h52-6-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h52-6-73" id="h52-6-73" class="i">+                ),
</a><a href="#h52-6-74" id="h52-6-74" class="i">+                &quot;name&quot;,
</a><a href="#h52-6-75" id="h52-6-75" class="i">+            ),
</a><a href="#h52-6-76" id="h52-6-76" class="i">+        ),
</a><a href="#h52-6-77" id="h52-6-77" class="i">+    ],
</a><a href="#h52-6-78" id="h52-6-78" class="i">+}
</a> 
<b>diff --git a/<a id="h53" href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a> b/<a href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -58,8 +58,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h53-0-3" id="h53-0-3" class="d">-Plan: Select(
</a><a href="#h53-0-4" id="h53-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h53-0-5" id="h53-0-5" class="i">+Plan: Select {
</a><a href="#h53-0-6" id="h53-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h53-1" id="h53-1" class="h">@@ -138,8 +138,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h53-1-3" id="h53-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h53-1-5" id="h53-1-5" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h53-2" id="h53-2" class="h">@@ -167,8 +167,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h53-2-3" id="h53-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h53-2-5" id="h53-2-5" class="i">+            alias: None,
</a>         },
         predicate: Some(
             Equal(
<a href="#h53-3" id="h53-3" class="h">@@ -198,10 +198,84 @@ Plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h53-3-3" id="h53-3-3" class="d">-)
</a><a href="#h53-3-4" id="h53-3-4" class="i">+    labels: [
</a><a href="#h53-3-5" id="h53-3-5" class="i">+        Some(
</a><a href="#h53-3-6" id="h53-3-6" class="i">+            (
</a><a href="#h53-3-7" id="h53-3-7" class="i">+                Some(
</a><a href="#h53-3-8" id="h53-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-3-9" id="h53-3-9" class="i">+                ),
</a><a href="#h53-3-10" id="h53-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h53-3-11" id="h53-3-11" class="i">+            ),
</a><a href="#h53-3-12" id="h53-3-12" class="i">+        ),
</a><a href="#h53-3-13" id="h53-3-13" class="i">+        Some(
</a><a href="#h53-3-14" id="h53-3-14" class="i">+            (
</a><a href="#h53-3-15" id="h53-3-15" class="i">+                Some(
</a><a href="#h53-3-16" id="h53-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-3-17" id="h53-3-17" class="i">+                ),
</a><a href="#h53-3-18" id="h53-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h53-3-19" id="h53-3-19" class="i">+            ),
</a><a href="#h53-3-20" id="h53-3-20" class="i">+        ),
</a><a href="#h53-3-21" id="h53-3-21" class="i">+        Some(
</a><a href="#h53-3-22" id="h53-3-22" class="i">+            (
</a><a href="#h53-3-23" id="h53-3-23" class="i">+                Some(
</a><a href="#h53-3-24" id="h53-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-3-25" id="h53-3-25" class="i">+                ),
</a><a href="#h53-3-26" id="h53-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h53-3-27" id="h53-3-27" class="i">+            ),
</a><a href="#h53-3-28" id="h53-3-28" class="i">+        ),
</a><a href="#h53-3-29" id="h53-3-29" class="i">+        Some(
</a><a href="#h53-3-30" id="h53-3-30" class="i">+            (
</a><a href="#h53-3-31" id="h53-3-31" class="i">+                Some(
</a><a href="#h53-3-32" id="h53-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-3-33" id="h53-3-33" class="i">+                ),
</a><a href="#h53-3-34" id="h53-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h53-3-35" id="h53-3-35" class="i">+            ),
</a><a href="#h53-3-36" id="h53-3-36" class="i">+        ),
</a><a href="#h53-3-37" id="h53-3-37" class="i">+        Some(
</a><a href="#h53-3-38" id="h53-3-38" class="i">+            (
</a><a href="#h53-3-39" id="h53-3-39" class="i">+                Some(
</a><a href="#h53-3-40" id="h53-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-3-41" id="h53-3-41" class="i">+                ),
</a><a href="#h53-3-42" id="h53-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h53-3-43" id="h53-3-43" class="i">+            ),
</a><a href="#h53-3-44" id="h53-3-44" class="i">+        ),
</a><a href="#h53-3-45" id="h53-3-45" class="i">+        Some(
</a><a href="#h53-3-46" id="h53-3-46" class="i">+            (
</a><a href="#h53-3-47" id="h53-3-47" class="i">+                Some(
</a><a href="#h53-3-48" id="h53-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-3-49" id="h53-3-49" class="i">+                ),
</a><a href="#h53-3-50" id="h53-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h53-3-51" id="h53-3-51" class="i">+            ),
</a><a href="#h53-3-52" id="h53-3-52" class="i">+        ),
</a><a href="#h53-3-53" id="h53-3-53" class="i">+        Some(
</a><a href="#h53-3-54" id="h53-3-54" class="i">+            (
</a><a href="#h53-3-55" id="h53-3-55" class="i">+                Some(
</a><a href="#h53-3-56" id="h53-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-3-57" id="h53-3-57" class="i">+                ),
</a><a href="#h53-3-58" id="h53-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h53-3-59" id="h53-3-59" class="i">+            ),
</a><a href="#h53-3-60" id="h53-3-60" class="i">+        ),
</a><a href="#h53-3-61" id="h53-3-61" class="i">+        Some(
</a><a href="#h53-3-62" id="h53-3-62" class="i">+            (
</a><a href="#h53-3-63" id="h53-3-63" class="i">+                Some(
</a><a href="#h53-3-64" id="h53-3-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h53-3-65" id="h53-3-65" class="i">+                ),
</a><a href="#h53-3-66" id="h53-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h53-3-67" id="h53-3-67" class="i">+            ),
</a><a href="#h53-3-68" id="h53-3-68" class="i">+        ),
</a><a href="#h53-3-69" id="h53-3-69" class="i">+        Some(
</a><a href="#h53-3-70" id="h53-3-70" class="i">+            (
</a><a href="#h53-3-71" id="h53-3-71" class="i">+                Some(
</a><a href="#h53-3-72" id="h53-3-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h53-3-73" id="h53-3-73" class="i">+                ),
</a><a href="#h53-3-74" id="h53-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h53-3-75" id="h53-3-75" class="i">+            ),
</a><a href="#h53-3-76" id="h53-3-76" class="i">+        ),
</a><a href="#h53-3-77" id="h53-3-77" class="i">+    ],
</a><a href="#h53-3-78" id="h53-3-78" class="i">+}
</a> 
<a href="#h53-3-80" id="h53-3-80" class="d">-Optimized plan: Select(
</a><a href="#h53-3-81" id="h53-3-81" class="d">-    HashJoin {
</a><a href="#h53-3-82" id="h53-3-82" class="i">+Optimized plan: Select {
</a><a href="#h53-3-83" id="h53-3-83" class="i">+    root: HashJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h53-4" id="h53-4" class="h">@@ -280,8 +354,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h53-4-3" id="h53-4-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h53-4-5" id="h53-4-5" class="i">+            alias: None,
</a>         },
         left_field: (
             3,
<a href="#h53-5" id="h53-5" class="h">@@ -319,8 +393,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h53-5-3" id="h53-5-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h53-5-5" id="h53-5-5" class="i">+            alias: None,
</a>         },
         right_field: (
             0,
<a href="#h53-6" id="h53-6" class="h">@@ -335,5 +409,79 @@ Optimized plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h53-6-3" id="h53-6-3" class="d">-)
</a><a href="#h53-6-4" id="h53-6-4" class="i">+    labels: [
</a><a href="#h53-6-5" id="h53-6-5" class="i">+        Some(
</a><a href="#h53-6-6" id="h53-6-6" class="i">+            (
</a><a href="#h53-6-7" id="h53-6-7" class="i">+                Some(
</a><a href="#h53-6-8" id="h53-6-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-6-9" id="h53-6-9" class="i">+                ),
</a><a href="#h53-6-10" id="h53-6-10" class="i">+                &quot;id&quot;,
</a><a href="#h53-6-11" id="h53-6-11" class="i">+            ),
</a><a href="#h53-6-12" id="h53-6-12" class="i">+        ),
</a><a href="#h53-6-13" id="h53-6-13" class="i">+        Some(
</a><a href="#h53-6-14" id="h53-6-14" class="i">+            (
</a><a href="#h53-6-15" id="h53-6-15" class="i">+                Some(
</a><a href="#h53-6-16" id="h53-6-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-6-17" id="h53-6-17" class="i">+                ),
</a><a href="#h53-6-18" id="h53-6-18" class="i">+                &quot;title&quot;,
</a><a href="#h53-6-19" id="h53-6-19" class="i">+            ),
</a><a href="#h53-6-20" id="h53-6-20" class="i">+        ),
</a><a href="#h53-6-21" id="h53-6-21" class="i">+        Some(
</a><a href="#h53-6-22" id="h53-6-22" class="i">+            (
</a><a href="#h53-6-23" id="h53-6-23" class="i">+                Some(
</a><a href="#h53-6-24" id="h53-6-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-6-25" id="h53-6-25" class="i">+                ),
</a><a href="#h53-6-26" id="h53-6-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h53-6-27" id="h53-6-27" class="i">+            ),
</a><a href="#h53-6-28" id="h53-6-28" class="i">+        ),
</a><a href="#h53-6-29" id="h53-6-29" class="i">+        Some(
</a><a href="#h53-6-30" id="h53-6-30" class="i">+            (
</a><a href="#h53-6-31" id="h53-6-31" class="i">+                Some(
</a><a href="#h53-6-32" id="h53-6-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-6-33" id="h53-6-33" class="i">+                ),
</a><a href="#h53-6-34" id="h53-6-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h53-6-35" id="h53-6-35" class="i">+            ),
</a><a href="#h53-6-36" id="h53-6-36" class="i">+        ),
</a><a href="#h53-6-37" id="h53-6-37" class="i">+        Some(
</a><a href="#h53-6-38" id="h53-6-38" class="i">+            (
</a><a href="#h53-6-39" id="h53-6-39" class="i">+                Some(
</a><a href="#h53-6-40" id="h53-6-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-6-41" id="h53-6-41" class="i">+                ),
</a><a href="#h53-6-42" id="h53-6-42" class="i">+                &quot;released&quot;,
</a><a href="#h53-6-43" id="h53-6-43" class="i">+            ),
</a><a href="#h53-6-44" id="h53-6-44" class="i">+        ),
</a><a href="#h53-6-45" id="h53-6-45" class="i">+        Some(
</a><a href="#h53-6-46" id="h53-6-46" class="i">+            (
</a><a href="#h53-6-47" id="h53-6-47" class="i">+                Some(
</a><a href="#h53-6-48" id="h53-6-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-6-49" id="h53-6-49" class="i">+                ),
</a><a href="#h53-6-50" id="h53-6-50" class="i">+                &quot;rating&quot;,
</a><a href="#h53-6-51" id="h53-6-51" class="i">+            ),
</a><a href="#h53-6-52" id="h53-6-52" class="i">+        ),
</a><a href="#h53-6-53" id="h53-6-53" class="i">+        Some(
</a><a href="#h53-6-54" id="h53-6-54" class="i">+            (
</a><a href="#h53-6-55" id="h53-6-55" class="i">+                Some(
</a><a href="#h53-6-56" id="h53-6-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h53-6-57" id="h53-6-57" class="i">+                ),
</a><a href="#h53-6-58" id="h53-6-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h53-6-59" id="h53-6-59" class="i">+            ),
</a><a href="#h53-6-60" id="h53-6-60" class="i">+        ),
</a><a href="#h53-6-61" id="h53-6-61" class="i">+        Some(
</a><a href="#h53-6-62" id="h53-6-62" class="i">+            (
</a><a href="#h53-6-63" id="h53-6-63" class="i">+                Some(
</a><a href="#h53-6-64" id="h53-6-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h53-6-65" id="h53-6-65" class="i">+                ),
</a><a href="#h53-6-66" id="h53-6-66" class="i">+                &quot;id&quot;,
</a><a href="#h53-6-67" id="h53-6-67" class="i">+            ),
</a><a href="#h53-6-68" id="h53-6-68" class="i">+        ),
</a><a href="#h53-6-69" id="h53-6-69" class="i">+        Some(
</a><a href="#h53-6-70" id="h53-6-70" class="i">+            (
</a><a href="#h53-6-71" id="h53-6-71" class="i">+                Some(
</a><a href="#h53-6-72" id="h53-6-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h53-6-73" id="h53-6-73" class="i">+                ),
</a><a href="#h53-6-74" id="h53-6-74" class="i">+                &quot;name&quot;,
</a><a href="#h53-6-75" id="h53-6-75" class="i">+            ),
</a><a href="#h53-6-76" id="h53-6-76" class="i">+        ),
</a><a href="#h53-6-77" id="h53-6-77" class="i">+    ],
</a><a href="#h53-6-78" id="h53-6-78" class="i">+}
</a> 
<b>diff --git a/<a id="h54" href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -71,8 +71,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h54-0-3" id="h54-0-3" class="d">-Plan: Select(
</a><a href="#h54-0-4" id="h54-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h54-0-5" id="h54-0-5" class="i">+Plan: Select {
</a><a href="#h54-0-6" id="h54-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h54-1" id="h54-1" class="h">@@ -151,10 +151,10 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h54-1-3" id="h54-1-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h54-1-7" id="h54-1-7" class="d">-            filter: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h54-2" id="h54-2" class="h">@@ -182,10 +182,10 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h54-2-3" id="h54-2-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<a href="#h54-2-7" id="h54-2-7" class="d">-            filter: None,
</a>         },
         predicate: Some(
             And(
<a href="#h54-3" id="h54-3" class="h">@@ -235,10 +235,84 @@ Plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h54-3-3" id="h54-3-3" class="d">-)
</a><a href="#h54-3-4" id="h54-3-4" class="i">+    labels: [
</a><a href="#h54-3-5" id="h54-3-5" class="i">+        Some(
</a><a href="#h54-3-6" id="h54-3-6" class="i">+            (
</a><a href="#h54-3-7" id="h54-3-7" class="i">+                Some(
</a><a href="#h54-3-8" id="h54-3-8" class="i">+                    &quot;m&quot;,
</a><a href="#h54-3-9" id="h54-3-9" class="i">+                ),
</a><a href="#h54-3-10" id="h54-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h54-3-11" id="h54-3-11" class="i">+            ),
</a><a href="#h54-3-12" id="h54-3-12" class="i">+        ),
</a><a href="#h54-3-13" id="h54-3-13" class="i">+        Some(
</a><a href="#h54-3-14" id="h54-3-14" class="i">+            (
</a><a href="#h54-3-15" id="h54-3-15" class="i">+                Some(
</a><a href="#h54-3-16" id="h54-3-16" class="i">+                    &quot;m&quot;,
</a><a href="#h54-3-17" id="h54-3-17" class="i">+                ),
</a><a href="#h54-3-18" id="h54-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h54-3-19" id="h54-3-19" class="i">+            ),
</a><a href="#h54-3-20" id="h54-3-20" class="i">+        ),
</a><a href="#h54-3-21" id="h54-3-21" class="i">+        Some(
</a><a href="#h54-3-22" id="h54-3-22" class="i">+            (
</a><a href="#h54-3-23" id="h54-3-23" class="i">+                Some(
</a><a href="#h54-3-24" id="h54-3-24" class="i">+                    &quot;m&quot;,
</a><a href="#h54-3-25" id="h54-3-25" class="i">+                ),
</a><a href="#h54-3-26" id="h54-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h54-3-27" id="h54-3-27" class="i">+            ),
</a><a href="#h54-3-28" id="h54-3-28" class="i">+        ),
</a><a href="#h54-3-29" id="h54-3-29" class="i">+        Some(
</a><a href="#h54-3-30" id="h54-3-30" class="i">+            (
</a><a href="#h54-3-31" id="h54-3-31" class="i">+                Some(
</a><a href="#h54-3-32" id="h54-3-32" class="i">+                    &quot;m&quot;,
</a><a href="#h54-3-33" id="h54-3-33" class="i">+                ),
</a><a href="#h54-3-34" id="h54-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h54-3-35" id="h54-3-35" class="i">+            ),
</a><a href="#h54-3-36" id="h54-3-36" class="i">+        ),
</a><a href="#h54-3-37" id="h54-3-37" class="i">+        Some(
</a><a href="#h54-3-38" id="h54-3-38" class="i">+            (
</a><a href="#h54-3-39" id="h54-3-39" class="i">+                Some(
</a><a href="#h54-3-40" id="h54-3-40" class="i">+                    &quot;m&quot;,
</a><a href="#h54-3-41" id="h54-3-41" class="i">+                ),
</a><a href="#h54-3-42" id="h54-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h54-3-43" id="h54-3-43" class="i">+            ),
</a><a href="#h54-3-44" id="h54-3-44" class="i">+        ),
</a><a href="#h54-3-45" id="h54-3-45" class="i">+        Some(
</a><a href="#h54-3-46" id="h54-3-46" class="i">+            (
</a><a href="#h54-3-47" id="h54-3-47" class="i">+                Some(
</a><a href="#h54-3-48" id="h54-3-48" class="i">+                    &quot;m&quot;,
</a><a href="#h54-3-49" id="h54-3-49" class="i">+                ),
</a><a href="#h54-3-50" id="h54-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h54-3-51" id="h54-3-51" class="i">+            ),
</a><a href="#h54-3-52" id="h54-3-52" class="i">+        ),
</a><a href="#h54-3-53" id="h54-3-53" class="i">+        Some(
</a><a href="#h54-3-54" id="h54-3-54" class="i">+            (
</a><a href="#h54-3-55" id="h54-3-55" class="i">+                Some(
</a><a href="#h54-3-56" id="h54-3-56" class="i">+                    &quot;m&quot;,
</a><a href="#h54-3-57" id="h54-3-57" class="i">+                ),
</a><a href="#h54-3-58" id="h54-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h54-3-59" id="h54-3-59" class="i">+            ),
</a><a href="#h54-3-60" id="h54-3-60" class="i">+        ),
</a><a href="#h54-3-61" id="h54-3-61" class="i">+        Some(
</a><a href="#h54-3-62" id="h54-3-62" class="i">+            (
</a><a href="#h54-3-63" id="h54-3-63" class="i">+                Some(
</a><a href="#h54-3-64" id="h54-3-64" class="i">+                    &quot;g&quot;,
</a><a href="#h54-3-65" id="h54-3-65" class="i">+                ),
</a><a href="#h54-3-66" id="h54-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h54-3-67" id="h54-3-67" class="i">+            ),
</a><a href="#h54-3-68" id="h54-3-68" class="i">+        ),
</a><a href="#h54-3-69" id="h54-3-69" class="i">+        Some(
</a><a href="#h54-3-70" id="h54-3-70" class="i">+            (
</a><a href="#h54-3-71" id="h54-3-71" class="i">+                Some(
</a><a href="#h54-3-72" id="h54-3-72" class="i">+                    &quot;g&quot;,
</a><a href="#h54-3-73" id="h54-3-73" class="i">+                ),
</a><a href="#h54-3-74" id="h54-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h54-3-75" id="h54-3-75" class="i">+            ),
</a><a href="#h54-3-76" id="h54-3-76" class="i">+        ),
</a><a href="#h54-3-77" id="h54-3-77" class="i">+    ],
</a><a href="#h54-3-78" id="h54-3-78" class="i">+}
</a> 
<a href="#h54-3-80" id="h54-3-80" class="d">-Optimized plan: Select(
</a><a href="#h54-3-81" id="h54-3-81" class="d">-    HashJoin {
</a><a href="#h54-3-82" id="h54-3-82" class="i">+Optimized plan: Select {
</a><a href="#h54-3-83" id="h54-3-83" class="i">+    root: HashJoin {
</a>         left: IndexLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h54-4" id="h54-4" class="h">@@ -385,5 +459,79 @@ Optimized plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h54-4-3" id="h54-4-3" class="d">-)
</a><a href="#h54-4-4" id="h54-4-4" class="i">+    labels: [
</a><a href="#h54-4-5" id="h54-4-5" class="i">+        Some(
</a><a href="#h54-4-6" id="h54-4-6" class="i">+            (
</a><a href="#h54-4-7" id="h54-4-7" class="i">+                Some(
</a><a href="#h54-4-8" id="h54-4-8" class="i">+                    &quot;m&quot;,
</a><a href="#h54-4-9" id="h54-4-9" class="i">+                ),
</a><a href="#h54-4-10" id="h54-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h54-4-11" id="h54-4-11" class="i">+            ),
</a><a href="#h54-4-12" id="h54-4-12" class="i">+        ),
</a><a href="#h54-4-13" id="h54-4-13" class="i">+        Some(
</a><a href="#h54-4-14" id="h54-4-14" class="i">+            (
</a><a href="#h54-4-15" id="h54-4-15" class="i">+                Some(
</a><a href="#h54-4-16" id="h54-4-16" class="i">+                    &quot;m&quot;,
</a><a href="#h54-4-17" id="h54-4-17" class="i">+                ),
</a><a href="#h54-4-18" id="h54-4-18" class="i">+                &quot;title&quot;,
</a><a href="#h54-4-19" id="h54-4-19" class="i">+            ),
</a><a href="#h54-4-20" id="h54-4-20" class="i">+        ),
</a><a href="#h54-4-21" id="h54-4-21" class="i">+        Some(
</a><a href="#h54-4-22" id="h54-4-22" class="i">+            (
</a><a href="#h54-4-23" id="h54-4-23" class="i">+                Some(
</a><a href="#h54-4-24" id="h54-4-24" class="i">+                    &quot;m&quot;,
</a><a href="#h54-4-25" id="h54-4-25" class="i">+                ),
</a><a href="#h54-4-26" id="h54-4-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h54-4-27" id="h54-4-27" class="i">+            ),
</a><a href="#h54-4-28" id="h54-4-28" class="i">+        ),
</a><a href="#h54-4-29" id="h54-4-29" class="i">+        Some(
</a><a href="#h54-4-30" id="h54-4-30" class="i">+            (
</a><a href="#h54-4-31" id="h54-4-31" class="i">+                Some(
</a><a href="#h54-4-32" id="h54-4-32" class="i">+                    &quot;m&quot;,
</a><a href="#h54-4-33" id="h54-4-33" class="i">+                ),
</a><a href="#h54-4-34" id="h54-4-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h54-4-35" id="h54-4-35" class="i">+            ),
</a><a href="#h54-4-36" id="h54-4-36" class="i">+        ),
</a><a href="#h54-4-37" id="h54-4-37" class="i">+        Some(
</a><a href="#h54-4-38" id="h54-4-38" class="i">+            (
</a><a href="#h54-4-39" id="h54-4-39" class="i">+                Some(
</a><a href="#h54-4-40" id="h54-4-40" class="i">+                    &quot;m&quot;,
</a><a href="#h54-4-41" id="h54-4-41" class="i">+                ),
</a><a href="#h54-4-42" id="h54-4-42" class="i">+                &quot;released&quot;,
</a><a href="#h54-4-43" id="h54-4-43" class="i">+            ),
</a><a href="#h54-4-44" id="h54-4-44" class="i">+        ),
</a><a href="#h54-4-45" id="h54-4-45" class="i">+        Some(
</a><a href="#h54-4-46" id="h54-4-46" class="i">+            (
</a><a href="#h54-4-47" id="h54-4-47" class="i">+                Some(
</a><a href="#h54-4-48" id="h54-4-48" class="i">+                    &quot;m&quot;,
</a><a href="#h54-4-49" id="h54-4-49" class="i">+                ),
</a><a href="#h54-4-50" id="h54-4-50" class="i">+                &quot;rating&quot;,
</a><a href="#h54-4-51" id="h54-4-51" class="i">+            ),
</a><a href="#h54-4-52" id="h54-4-52" class="i">+        ),
</a><a href="#h54-4-53" id="h54-4-53" class="i">+        Some(
</a><a href="#h54-4-54" id="h54-4-54" class="i">+            (
</a><a href="#h54-4-55" id="h54-4-55" class="i">+                Some(
</a><a href="#h54-4-56" id="h54-4-56" class="i">+                    &quot;m&quot;,
</a><a href="#h54-4-57" id="h54-4-57" class="i">+                ),
</a><a href="#h54-4-58" id="h54-4-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h54-4-59" id="h54-4-59" class="i">+            ),
</a><a href="#h54-4-60" id="h54-4-60" class="i">+        ),
</a><a href="#h54-4-61" id="h54-4-61" class="i">+        Some(
</a><a href="#h54-4-62" id="h54-4-62" class="i">+            (
</a><a href="#h54-4-63" id="h54-4-63" class="i">+                Some(
</a><a href="#h54-4-64" id="h54-4-64" class="i">+                    &quot;g&quot;,
</a><a href="#h54-4-65" id="h54-4-65" class="i">+                ),
</a><a href="#h54-4-66" id="h54-4-66" class="i">+                &quot;id&quot;,
</a><a href="#h54-4-67" id="h54-4-67" class="i">+            ),
</a><a href="#h54-4-68" id="h54-4-68" class="i">+        ),
</a><a href="#h54-4-69" id="h54-4-69" class="i">+        Some(
</a><a href="#h54-4-70" id="h54-4-70" class="i">+            (
</a><a href="#h54-4-71" id="h54-4-71" class="i">+                Some(
</a><a href="#h54-4-72" id="h54-4-72" class="i">+                    &quot;g&quot;,
</a><a href="#h54-4-73" id="h54-4-73" class="i">+                ),
</a><a href="#h54-4-74" id="h54-4-74" class="i">+                &quot;name&quot;,
</a><a href="#h54-4-75" id="h54-4-75" class="i">+            ),
</a><a href="#h54-4-76" id="h54-4-76" class="i">+        ),
</a><a href="#h54-4-77" id="h54-4-77" class="i">+    ],
</a><a href="#h54-4-78" id="h54-4-78" class="i">+}
</a> 
<b>diff --git a/<a id="h55" href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -68,8 +68,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h55-0-3" id="h55-0-3" class="d">-Plan: Select(
</a><a href="#h55-0-4" id="h55-0-4" class="d">-    Filter {
</a><a href="#h55-0-5" id="h55-0-5" class="i">+Plan: Select {
</a><a href="#h55-0-6" id="h55-0-6" class="i">+    root: Filter {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h55-1" id="h55-1" class="h">@@ -149,10 +149,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h55-1-3" id="h55-1-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h55-1-7" id="h55-1-7" class="d">-                filter: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h55-2" id="h55-2" class="h">@@ -180,10 +180,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h55-2-3" id="h55-2-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h55-2-7" id="h55-2-7" class="d">-                filter: None,
</a>             },
             predicate: Some(
                 Equal(
<a href="#h55-3" id="h55-3" class="h">@@ -232,10 +232,84 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h55-3-3" id="h55-3-3" class="d">-)
</a><a href="#h55-3-4" id="h55-3-4" class="i">+    labels: [
</a><a href="#h55-3-5" id="h55-3-5" class="i">+        Some(
</a><a href="#h55-3-6" id="h55-3-6" class="i">+            (
</a><a href="#h55-3-7" id="h55-3-7" class="i">+                Some(
</a><a href="#h55-3-8" id="h55-3-8" class="i">+                    &quot;m&quot;,
</a><a href="#h55-3-9" id="h55-3-9" class="i">+                ),
</a><a href="#h55-3-10" id="h55-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h55-3-11" id="h55-3-11" class="i">+            ),
</a><a href="#h55-3-12" id="h55-3-12" class="i">+        ),
</a><a href="#h55-3-13" id="h55-3-13" class="i">+        Some(
</a><a href="#h55-3-14" id="h55-3-14" class="i">+            (
</a><a href="#h55-3-15" id="h55-3-15" class="i">+                Some(
</a><a href="#h55-3-16" id="h55-3-16" class="i">+                    &quot;m&quot;,
</a><a href="#h55-3-17" id="h55-3-17" class="i">+                ),
</a><a href="#h55-3-18" id="h55-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h55-3-19" id="h55-3-19" class="i">+            ),
</a><a href="#h55-3-20" id="h55-3-20" class="i">+        ),
</a><a href="#h55-3-21" id="h55-3-21" class="i">+        Some(
</a><a href="#h55-3-22" id="h55-3-22" class="i">+            (
</a><a href="#h55-3-23" id="h55-3-23" class="i">+                Some(
</a><a href="#h55-3-24" id="h55-3-24" class="i">+                    &quot;m&quot;,
</a><a href="#h55-3-25" id="h55-3-25" class="i">+                ),
</a><a href="#h55-3-26" id="h55-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h55-3-27" id="h55-3-27" class="i">+            ),
</a><a href="#h55-3-28" id="h55-3-28" class="i">+        ),
</a><a href="#h55-3-29" id="h55-3-29" class="i">+        Some(
</a><a href="#h55-3-30" id="h55-3-30" class="i">+            (
</a><a href="#h55-3-31" id="h55-3-31" class="i">+                Some(
</a><a href="#h55-3-32" id="h55-3-32" class="i">+                    &quot;m&quot;,
</a><a href="#h55-3-33" id="h55-3-33" class="i">+                ),
</a><a href="#h55-3-34" id="h55-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h55-3-35" id="h55-3-35" class="i">+            ),
</a><a href="#h55-3-36" id="h55-3-36" class="i">+        ),
</a><a href="#h55-3-37" id="h55-3-37" class="i">+        Some(
</a><a href="#h55-3-38" id="h55-3-38" class="i">+            (
</a><a href="#h55-3-39" id="h55-3-39" class="i">+                Some(
</a><a href="#h55-3-40" id="h55-3-40" class="i">+                    &quot;m&quot;,
</a><a href="#h55-3-41" id="h55-3-41" class="i">+                ),
</a><a href="#h55-3-42" id="h55-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h55-3-43" id="h55-3-43" class="i">+            ),
</a><a href="#h55-3-44" id="h55-3-44" class="i">+        ),
</a><a href="#h55-3-45" id="h55-3-45" class="i">+        Some(
</a><a href="#h55-3-46" id="h55-3-46" class="i">+            (
</a><a href="#h55-3-47" id="h55-3-47" class="i">+                Some(
</a><a href="#h55-3-48" id="h55-3-48" class="i">+                    &quot;m&quot;,
</a><a href="#h55-3-49" id="h55-3-49" class="i">+                ),
</a><a href="#h55-3-50" id="h55-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h55-3-51" id="h55-3-51" class="i">+            ),
</a><a href="#h55-3-52" id="h55-3-52" class="i">+        ),
</a><a href="#h55-3-53" id="h55-3-53" class="i">+        Some(
</a><a href="#h55-3-54" id="h55-3-54" class="i">+            (
</a><a href="#h55-3-55" id="h55-3-55" class="i">+                Some(
</a><a href="#h55-3-56" id="h55-3-56" class="i">+                    &quot;m&quot;,
</a><a href="#h55-3-57" id="h55-3-57" class="i">+                ),
</a><a href="#h55-3-58" id="h55-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h55-3-59" id="h55-3-59" class="i">+            ),
</a><a href="#h55-3-60" id="h55-3-60" class="i">+        ),
</a><a href="#h55-3-61" id="h55-3-61" class="i">+        Some(
</a><a href="#h55-3-62" id="h55-3-62" class="i">+            (
</a><a href="#h55-3-63" id="h55-3-63" class="i">+                Some(
</a><a href="#h55-3-64" id="h55-3-64" class="i">+                    &quot;g&quot;,
</a><a href="#h55-3-65" id="h55-3-65" class="i">+                ),
</a><a href="#h55-3-66" id="h55-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h55-3-67" id="h55-3-67" class="i">+            ),
</a><a href="#h55-3-68" id="h55-3-68" class="i">+        ),
</a><a href="#h55-3-69" id="h55-3-69" class="i">+        Some(
</a><a href="#h55-3-70" id="h55-3-70" class="i">+            (
</a><a href="#h55-3-71" id="h55-3-71" class="i">+                Some(
</a><a href="#h55-3-72" id="h55-3-72" class="i">+                    &quot;g&quot;,
</a><a href="#h55-3-73" id="h55-3-73" class="i">+                ),
</a><a href="#h55-3-74" id="h55-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h55-3-75" id="h55-3-75" class="i">+            ),
</a><a href="#h55-3-76" id="h55-3-76" class="i">+        ),
</a><a href="#h55-3-77" id="h55-3-77" class="i">+    ],
</a><a href="#h55-3-78" id="h55-3-78" class="i">+}
</a> 
<a href="#h55-3-80" id="h55-3-80" class="d">-Optimized plan: Select(
</a><a href="#h55-3-81" id="h55-3-81" class="d">-    HashJoin {
</a><a href="#h55-3-82" id="h55-3-82" class="i">+Optimized plan: Select {
</a><a href="#h55-3-83" id="h55-3-83" class="i">+    root: HashJoin {
</a>         left: IndexLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h55-4" id="h55-4" class="h">@@ -382,5 +456,79 @@ Optimized plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h55-4-3" id="h55-4-3" class="d">-)
</a><a href="#h55-4-4" id="h55-4-4" class="i">+    labels: [
</a><a href="#h55-4-5" id="h55-4-5" class="i">+        Some(
</a><a href="#h55-4-6" id="h55-4-6" class="i">+            (
</a><a href="#h55-4-7" id="h55-4-7" class="i">+                Some(
</a><a href="#h55-4-8" id="h55-4-8" class="i">+                    &quot;m&quot;,
</a><a href="#h55-4-9" id="h55-4-9" class="i">+                ),
</a><a href="#h55-4-10" id="h55-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h55-4-11" id="h55-4-11" class="i">+            ),
</a><a href="#h55-4-12" id="h55-4-12" class="i">+        ),
</a><a href="#h55-4-13" id="h55-4-13" class="i">+        Some(
</a><a href="#h55-4-14" id="h55-4-14" class="i">+            (
</a><a href="#h55-4-15" id="h55-4-15" class="i">+                Some(
</a><a href="#h55-4-16" id="h55-4-16" class="i">+                    &quot;m&quot;,
</a><a href="#h55-4-17" id="h55-4-17" class="i">+                ),
</a><a href="#h55-4-18" id="h55-4-18" class="i">+                &quot;title&quot;,
</a><a href="#h55-4-19" id="h55-4-19" class="i">+            ),
</a><a href="#h55-4-20" id="h55-4-20" class="i">+        ),
</a><a href="#h55-4-21" id="h55-4-21" class="i">+        Some(
</a><a href="#h55-4-22" id="h55-4-22" class="i">+            (
</a><a href="#h55-4-23" id="h55-4-23" class="i">+                Some(
</a><a href="#h55-4-24" id="h55-4-24" class="i">+                    &quot;m&quot;,
</a><a href="#h55-4-25" id="h55-4-25" class="i">+                ),
</a><a href="#h55-4-26" id="h55-4-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h55-4-27" id="h55-4-27" class="i">+            ),
</a><a href="#h55-4-28" id="h55-4-28" class="i">+        ),
</a><a href="#h55-4-29" id="h55-4-29" class="i">+        Some(
</a><a href="#h55-4-30" id="h55-4-30" class="i">+            (
</a><a href="#h55-4-31" id="h55-4-31" class="i">+                Some(
</a><a href="#h55-4-32" id="h55-4-32" class="i">+                    &quot;m&quot;,
</a><a href="#h55-4-33" id="h55-4-33" class="i">+                ),
</a><a href="#h55-4-34" id="h55-4-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h55-4-35" id="h55-4-35" class="i">+            ),
</a><a href="#h55-4-36" id="h55-4-36" class="i">+        ),
</a><a href="#h55-4-37" id="h55-4-37" class="i">+        Some(
</a><a href="#h55-4-38" id="h55-4-38" class="i">+            (
</a><a href="#h55-4-39" id="h55-4-39" class="i">+                Some(
</a><a href="#h55-4-40" id="h55-4-40" class="i">+                    &quot;m&quot;,
</a><a href="#h55-4-41" id="h55-4-41" class="i">+                ),
</a><a href="#h55-4-42" id="h55-4-42" class="i">+                &quot;released&quot;,
</a><a href="#h55-4-43" id="h55-4-43" class="i">+            ),
</a><a href="#h55-4-44" id="h55-4-44" class="i">+        ),
</a><a href="#h55-4-45" id="h55-4-45" class="i">+        Some(
</a><a href="#h55-4-46" id="h55-4-46" class="i">+            (
</a><a href="#h55-4-47" id="h55-4-47" class="i">+                Some(
</a><a href="#h55-4-48" id="h55-4-48" class="i">+                    &quot;m&quot;,
</a><a href="#h55-4-49" id="h55-4-49" class="i">+                ),
</a><a href="#h55-4-50" id="h55-4-50" class="i">+                &quot;rating&quot;,
</a><a href="#h55-4-51" id="h55-4-51" class="i">+            ),
</a><a href="#h55-4-52" id="h55-4-52" class="i">+        ),
</a><a href="#h55-4-53" id="h55-4-53" class="i">+        Some(
</a><a href="#h55-4-54" id="h55-4-54" class="i">+            (
</a><a href="#h55-4-55" id="h55-4-55" class="i">+                Some(
</a><a href="#h55-4-56" id="h55-4-56" class="i">+                    &quot;m&quot;,
</a><a href="#h55-4-57" id="h55-4-57" class="i">+                ),
</a><a href="#h55-4-58" id="h55-4-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h55-4-59" id="h55-4-59" class="i">+            ),
</a><a href="#h55-4-60" id="h55-4-60" class="i">+        ),
</a><a href="#h55-4-61" id="h55-4-61" class="i">+        Some(
</a><a href="#h55-4-62" id="h55-4-62" class="i">+            (
</a><a href="#h55-4-63" id="h55-4-63" class="i">+                Some(
</a><a href="#h55-4-64" id="h55-4-64" class="i">+                    &quot;g&quot;,
</a><a href="#h55-4-65" id="h55-4-65" class="i">+                ),
</a><a href="#h55-4-66" id="h55-4-66" class="i">+                &quot;id&quot;,
</a><a href="#h55-4-67" id="h55-4-67" class="i">+            ),
</a><a href="#h55-4-68" id="h55-4-68" class="i">+        ),
</a><a href="#h55-4-69" id="h55-4-69" class="i">+        Some(
</a><a href="#h55-4-70" id="h55-4-70" class="i">+            (
</a><a href="#h55-4-71" id="h55-4-71" class="i">+                Some(
</a><a href="#h55-4-72" id="h55-4-72" class="i">+                    &quot;g&quot;,
</a><a href="#h55-4-73" id="h55-4-73" class="i">+                ),
</a><a href="#h55-4-74" id="h55-4-74" class="i">+                &quot;name&quot;,
</a><a href="#h55-4-75" id="h55-4-75" class="i">+            ),
</a><a href="#h55-4-76" id="h55-4-76" class="i">+        ),
</a><a href="#h55-4-77" id="h55-4-77" class="i">+    ],
</a><a href="#h55-4-78" id="h55-4-78" class="i">+}
</a> 
<b>diff --git a/<a id="h56" href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a> b/<a href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -122,8 +122,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h56-0-3" id="h56-0-3" class="d">-Plan: Select(
</a><a href="#h56-0-4" id="h56-0-4" class="d">-    Projection {
</a><a href="#h56-0-5" id="h56-0-5" class="i">+Plan: Select {
</a><a href="#h56-0-6" id="h56-0-6" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: NestedLoopJoin {
                 left: Scan {
<a href="#h56-1" id="h56-1" class="h">@@ -204,8 +204,8 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h56-1-3" id="h56-1-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h56-1-5" id="h56-1-5" class="i">+                    alias: None,
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h56-2" id="h56-2" class="h">@@ -233,8 +233,8 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h56-2-3" id="h56-2-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h56-2-5" id="h56-2-5" class="i">+                    alias: None,
</a>                 },
                 predicate: Some(
                     Equal(
<a href="#h56-3" id="h56-3" class="h">@@ -303,8 +303,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h56-3-3" id="h56-3-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h56-3-5" id="h56-3-5" class="i">+                alias: None,
</a>             },
             predicate: Some(
                 Equal(
<a href="#h56-4" id="h56-4" class="h">@@ -334,21 +334,6 @@ Plan: Select(
</a>             ),
             outer: false,
         },
<a href="#h56-4-3" id="h56-4-3" class="d">-        labels: [
</a><a href="#h56-4-4" id="h56-4-4" class="d">-            None,
</a><a href="#h56-4-5" id="h56-4-5" class="d">-            Some(
</a><a href="#h56-4-6" id="h56-4-6" class="d">-                (
</a><a href="#h56-4-7" id="h56-4-7" class="d">-                    None,
</a><a href="#h56-4-8" id="h56-4-8" class="d">-                    &quot;genre&quot;,
</a><a href="#h56-4-9" id="h56-4-9" class="d">-                ),
</a><a href="#h56-4-10" id="h56-4-10" class="d">-            ),
</a><a href="#h56-4-11" id="h56-4-11" class="d">-            Some(
</a><a href="#h56-4-12" id="h56-4-12" class="d">-                (
</a><a href="#h56-4-13" id="h56-4-13" class="d">-                    None,
</a><a href="#h56-4-14" id="h56-4-14" class="d">-                    &quot;studio&quot;,
</a><a href="#h56-4-15" id="h56-4-15" class="d">-                ),
</a><a href="#h56-4-16" id="h56-4-16" class="d">-            ),
</a><a href="#h56-4-17" id="h56-4-17" class="d">-        ],
</a>         expressions: [
             Field(
                 1,
<a href="#h56-5" id="h56-5" class="h">@@ -384,11 +369,48 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h56-5-3" id="h56-5-3" class="i">+        labels: [
</a><a href="#h56-5-4" id="h56-5-4" class="i">+            None,
</a><a href="#h56-5-5" id="h56-5-5" class="i">+            Some(
</a><a href="#h56-5-6" id="h56-5-6" class="i">+                (
</a><a href="#h56-5-7" id="h56-5-7" class="i">+                    None,
</a><a href="#h56-5-8" id="h56-5-8" class="i">+                    &quot;genre&quot;,
</a><a href="#h56-5-9" id="h56-5-9" class="i">+                ),
</a><a href="#h56-5-10" id="h56-5-10" class="i">+            ),
</a><a href="#h56-5-11" id="h56-5-11" class="i">+            Some(
</a><a href="#h56-5-12" id="h56-5-12" class="i">+                (
</a><a href="#h56-5-13" id="h56-5-13" class="i">+                    None,
</a><a href="#h56-5-14" id="h56-5-14" class="i">+                    &quot;studio&quot;,
</a><a href="#h56-5-15" id="h56-5-15" class="i">+                ),
</a><a href="#h56-5-16" id="h56-5-16" class="i">+            ),
</a><a href="#h56-5-17" id="h56-5-17" class="i">+        ],
</a>     },
<a href="#h56-5-19" id="h56-5-19" class="d">-)
</a><a href="#h56-5-20" id="h56-5-20" class="i">+    labels: [
</a><a href="#h56-5-21" id="h56-5-21" class="i">+        Some(
</a><a href="#h56-5-22" id="h56-5-22" class="i">+            (
</a><a href="#h56-5-23" id="h56-5-23" class="i">+                Some(
</a><a href="#h56-5-24" id="h56-5-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h56-5-25" id="h56-5-25" class="i">+                ),
</a><a href="#h56-5-26" id="h56-5-26" class="i">+                &quot;title&quot;,
</a><a href="#h56-5-27" id="h56-5-27" class="i">+            ),
</a><a href="#h56-5-28" id="h56-5-28" class="i">+        ),
</a><a href="#h56-5-29" id="h56-5-29" class="i">+        Some(
</a><a href="#h56-5-30" id="h56-5-30" class="i">+            (
</a><a href="#h56-5-31" id="h56-5-31" class="i">+                None,
</a><a href="#h56-5-32" id="h56-5-32" class="i">+                &quot;genre&quot;,
</a><a href="#h56-5-33" id="h56-5-33" class="i">+            ),
</a><a href="#h56-5-34" id="h56-5-34" class="i">+        ),
</a><a href="#h56-5-35" id="h56-5-35" class="i">+        Some(
</a><a href="#h56-5-36" id="h56-5-36" class="i">+            (
</a><a href="#h56-5-37" id="h56-5-37" class="i">+                None,
</a><a href="#h56-5-38" id="h56-5-38" class="i">+                &quot;studio&quot;,
</a><a href="#h56-5-39" id="h56-5-39" class="i">+            ),
</a><a href="#h56-5-40" id="h56-5-40" class="i">+        ),
</a><a href="#h56-5-41" id="h56-5-41" class="i">+    ],
</a><a href="#h56-5-42" id="h56-5-42" class="i">+}
</a> 
<a href="#h56-5-44" id="h56-5-44" class="d">-Optimized plan: Select(
</a><a href="#h56-5-45" id="h56-5-45" class="d">-    Projection {
</a><a href="#h56-5-46" id="h56-5-46" class="i">+Optimized plan: Select {
</a><a href="#h56-5-47" id="h56-5-47" class="i">+    root: Projection {
</a>         source: HashJoin {
             left: HashJoin {
                 left: Scan {
<a href="#h56-6" id="h56-6" class="h">@@ -469,8 +491,8 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h56-6-3" id="h56-6-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h56-6-5" id="h56-6-5" class="i">+                    alias: None,
</a>                 },
                 left_field: (
                     3,
<a href="#h56-7" id="h56-7" class="h">@@ -508,8 +530,8 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h56-7-3" id="h56-7-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h56-7-5" id="h56-7-5" class="i">+                    alias: None,
</a>                 },
                 right_field: (
                     0,
<a href="#h56-8" id="h56-8" class="h">@@ -573,8 +595,8 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h56-8-3" id="h56-8-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h56-8-5" id="h56-8-5" class="i">+                alias: None,
</a>             },
             right_field: (
                 0,
<a href="#h56-9" id="h56-9" class="h">@@ -589,21 +611,6 @@ Optimized plan: Select(
</a>             ),
             outer: false,
         },
<a href="#h56-9-3" id="h56-9-3" class="d">-        labels: [
</a><a href="#h56-9-4" id="h56-9-4" class="d">-            None,
</a><a href="#h56-9-5" id="h56-9-5" class="d">-            Some(
</a><a href="#h56-9-6" id="h56-9-6" class="d">-                (
</a><a href="#h56-9-7" id="h56-9-7" class="d">-                    None,
</a><a href="#h56-9-8" id="h56-9-8" class="d">-                    &quot;genre&quot;,
</a><a href="#h56-9-9" id="h56-9-9" class="d">-                ),
</a><a href="#h56-9-10" id="h56-9-10" class="d">-            ),
</a><a href="#h56-9-11" id="h56-9-11" class="d">-            Some(
</a><a href="#h56-9-12" id="h56-9-12" class="d">-                (
</a><a href="#h56-9-13" id="h56-9-13" class="d">-                    None,
</a><a href="#h56-9-14" id="h56-9-14" class="d">-                    &quot;studio&quot;,
</a><a href="#h56-9-15" id="h56-9-15" class="d">-                ),
</a><a href="#h56-9-16" id="h56-9-16" class="d">-            ),
</a><a href="#h56-9-17" id="h56-9-17" class="d">-        ],
</a>         expressions: [
             Field(
                 1,
<a href="#h56-10" id="h56-10" class="h">@@ -639,6 +646,43 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h56-10-3" id="h56-10-3" class="i">+        labels: [
</a><a href="#h56-10-4" id="h56-10-4" class="i">+            None,
</a><a href="#h56-10-5" id="h56-10-5" class="i">+            Some(
</a><a href="#h56-10-6" id="h56-10-6" class="i">+                (
</a><a href="#h56-10-7" id="h56-10-7" class="i">+                    None,
</a><a href="#h56-10-8" id="h56-10-8" class="i">+                    &quot;genre&quot;,
</a><a href="#h56-10-9" id="h56-10-9" class="i">+                ),
</a><a href="#h56-10-10" id="h56-10-10" class="i">+            ),
</a><a href="#h56-10-11" id="h56-10-11" class="i">+            Some(
</a><a href="#h56-10-12" id="h56-10-12" class="i">+                (
</a><a href="#h56-10-13" id="h56-10-13" class="i">+                    None,
</a><a href="#h56-10-14" id="h56-10-14" class="i">+                    &quot;studio&quot;,
</a><a href="#h56-10-15" id="h56-10-15" class="i">+                ),
</a><a href="#h56-10-16" id="h56-10-16" class="i">+            ),
</a><a href="#h56-10-17" id="h56-10-17" class="i">+        ],
</a>     },
<a href="#h56-10-19" id="h56-10-19" class="d">-)
</a><a href="#h56-10-20" id="h56-10-20" class="i">+    labels: [
</a><a href="#h56-10-21" id="h56-10-21" class="i">+        Some(
</a><a href="#h56-10-22" id="h56-10-22" class="i">+            (
</a><a href="#h56-10-23" id="h56-10-23" class="i">+                Some(
</a><a href="#h56-10-24" id="h56-10-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h56-10-25" id="h56-10-25" class="i">+                ),
</a><a href="#h56-10-26" id="h56-10-26" class="i">+                &quot;title&quot;,
</a><a href="#h56-10-27" id="h56-10-27" class="i">+            ),
</a><a href="#h56-10-28" id="h56-10-28" class="i">+        ),
</a><a href="#h56-10-29" id="h56-10-29" class="i">+        Some(
</a><a href="#h56-10-30" id="h56-10-30" class="i">+            (
</a><a href="#h56-10-31" id="h56-10-31" class="i">+                None,
</a><a href="#h56-10-32" id="h56-10-32" class="i">+                &quot;genre&quot;,
</a><a href="#h56-10-33" id="h56-10-33" class="i">+            ),
</a><a href="#h56-10-34" id="h56-10-34" class="i">+        ),
</a><a href="#h56-10-35" id="h56-10-35" class="i">+        Some(
</a><a href="#h56-10-36" id="h56-10-36" class="i">+            (
</a><a href="#h56-10-37" id="h56-10-37" class="i">+                None,
</a><a href="#h56-10-38" id="h56-10-38" class="i">+                &quot;studio&quot;,
</a><a href="#h56-10-39" id="h56-10-39" class="i">+            ),
</a><a href="#h56-10-40" id="h56-10-40" class="i">+        ),
</a><a href="#h56-10-41" id="h56-10-41" class="i">+    ],
</a><a href="#h56-10-42" id="h56-10-42" class="i">+}
</a> 
<b>diff --git a/<a id="h57" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -172,8 +172,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h57-0-3" id="h57-0-3" class="d">-Plan: Select(
</a><a href="#h57-0-4" id="h57-0-4" class="d">-    Order {
</a><a href="#h57-0-5" id="h57-0-5" class="i">+Plan: Select {
</a><a href="#h57-0-6" id="h57-0-6" class="i">+    root: Order {
</a>         source: Projection {
             source: NestedLoopJoin {
                 left: NestedLoopJoin {
<a href="#h57-1" id="h57-1" class="h">@@ -255,10 +255,10 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h57-1-3" id="h57-1-3" class="i">+                        filter: None,
</a>                         alias: Some(
                             &quot;m&quot;,
                         ),
<a href="#h57-1-7" id="h57-1-7" class="d">-                        filter: None,
</a>                     },
                     left_size: 7,
                     right: Scan {
<a href="#h57-2" id="h57-2" class="h">@@ -286,10 +286,10 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h57-2-3" id="h57-2-3" class="i">+                        filter: None,
</a>                         alias: Some(
                             &quot;g&quot;,
                         ),
<a href="#h57-2-7" id="h57-2-7" class="d">-                        filter: None,
</a>                     },
                     predicate: Some(
                         And(
<a href="#h57-3" id="h57-3" class="h">@@ -378,10 +378,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h57-3-3" id="h57-3-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;s&quot;,
                     ),
<a href="#h57-3-7" id="h57-3-7" class="d">-                    filter: None,
</a>                 },
                 predicate: Some(
                     And(
<a href="#h57-4" id="h57-4" class="h">@@ -431,21 +431,6 @@ Plan: Select(
</a>                 ),
                 outer: false,
             },
<a href="#h57-4-3" id="h57-4-3" class="d">-            labels: [
</a><a href="#h57-4-4" id="h57-4-4" class="d">-                None,
</a><a href="#h57-4-5" id="h57-4-5" class="d">-                Some(
</a><a href="#h57-4-6" id="h57-4-6" class="d">-                    (
</a><a href="#h57-4-7" id="h57-4-7" class="d">-                        None,
</a><a href="#h57-4-8" id="h57-4-8" class="d">-                        &quot;genre&quot;,
</a><a href="#h57-4-9" id="h57-4-9" class="d">-                    ),
</a><a href="#h57-4-10" id="h57-4-10" class="d">-                ),
</a><a href="#h57-4-11" id="h57-4-11" class="d">-                Some(
</a><a href="#h57-4-12" id="h57-4-12" class="d">-                    (
</a><a href="#h57-4-13" id="h57-4-13" class="d">-                        None,
</a><a href="#h57-4-14" id="h57-4-14" class="d">-                        &quot;studio&quot;,
</a><a href="#h57-4-15" id="h57-4-15" class="d">-                    ),
</a><a href="#h57-4-16" id="h57-4-16" class="d">-                ),
</a><a href="#h57-4-17" id="h57-4-17" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h57-5" id="h57-5" class="h">@@ -481,6 +466,21 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h57-5-3" id="h57-5-3" class="i">+            labels: [
</a><a href="#h57-5-4" id="h57-5-4" class="i">+                None,
</a><a href="#h57-5-5" id="h57-5-5" class="i">+                Some(
</a><a href="#h57-5-6" id="h57-5-6" class="i">+                    (
</a><a href="#h57-5-7" id="h57-5-7" class="i">+                        None,
</a><a href="#h57-5-8" id="h57-5-8" class="i">+                        &quot;genre&quot;,
</a><a href="#h57-5-9" id="h57-5-9" class="i">+                    ),
</a><a href="#h57-5-10" id="h57-5-10" class="i">+                ),
</a><a href="#h57-5-11" id="h57-5-11" class="i">+                Some(
</a><a href="#h57-5-12" id="h57-5-12" class="i">+                    (
</a><a href="#h57-5-13" id="h57-5-13" class="i">+                        None,
</a><a href="#h57-5-14" id="h57-5-14" class="i">+                        &quot;studio&quot;,
</a><a href="#h57-5-15" id="h57-5-15" class="i">+                    ),
</a><a href="#h57-5-16" id="h57-5-16" class="i">+                ),
</a><a href="#h57-5-17" id="h57-5-17" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h57-6" id="h57-6" class="h">@@ -499,10 +499,32 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h57-6-3" id="h57-6-3" class="d">-)
</a><a href="#h57-6-4" id="h57-6-4" class="i">+    labels: [
</a><a href="#h57-6-5" id="h57-6-5" class="i">+        Some(
</a><a href="#h57-6-6" id="h57-6-6" class="i">+            (
</a><a href="#h57-6-7" id="h57-6-7" class="i">+                Some(
</a><a href="#h57-6-8" id="h57-6-8" class="i">+                    &quot;m&quot;,
</a><a href="#h57-6-9" id="h57-6-9" class="i">+                ),
</a><a href="#h57-6-10" id="h57-6-10" class="i">+                &quot;title&quot;,
</a><a href="#h57-6-11" id="h57-6-11" class="i">+            ),
</a><a href="#h57-6-12" id="h57-6-12" class="i">+        ),
</a><a href="#h57-6-13" id="h57-6-13" class="i">+        Some(
</a><a href="#h57-6-14" id="h57-6-14" class="i">+            (
</a><a href="#h57-6-15" id="h57-6-15" class="i">+                None,
</a><a href="#h57-6-16" id="h57-6-16" class="i">+                &quot;genre&quot;,
</a><a href="#h57-6-17" id="h57-6-17" class="i">+            ),
</a><a href="#h57-6-18" id="h57-6-18" class="i">+        ),
</a><a href="#h57-6-19" id="h57-6-19" class="i">+        Some(
</a><a href="#h57-6-20" id="h57-6-20" class="i">+            (
</a><a href="#h57-6-21" id="h57-6-21" class="i">+                None,
</a><a href="#h57-6-22" id="h57-6-22" class="i">+                &quot;studio&quot;,
</a><a href="#h57-6-23" id="h57-6-23" class="i">+            ),
</a><a href="#h57-6-24" id="h57-6-24" class="i">+        ),
</a><a href="#h57-6-25" id="h57-6-25" class="i">+    ],
</a><a href="#h57-6-26" id="h57-6-26" class="i">+}
</a> 
<a href="#h57-6-28" id="h57-6-28" class="d">-Optimized plan: Select(
</a><a href="#h57-6-29" id="h57-6-29" class="d">-    Order {
</a><a href="#h57-6-30" id="h57-6-30" class="i">+Optimized plan: Select {
</a><a href="#h57-6-31" id="h57-6-31" class="i">+    root: Order {
</a>         source: Projection {
             source: HashJoin {
                 left: HashJoin {
<a href="#h57-7" id="h57-7" class="h">@@ -743,21 +765,6 @@ Optimized plan: Select(
</a>                 ),
                 outer: false,
             },
<a href="#h57-7-3" id="h57-7-3" class="d">-            labels: [
</a><a href="#h57-7-4" id="h57-7-4" class="d">-                None,
</a><a href="#h57-7-5" id="h57-7-5" class="d">-                Some(
</a><a href="#h57-7-6" id="h57-7-6" class="d">-                    (
</a><a href="#h57-7-7" id="h57-7-7" class="d">-                        None,
</a><a href="#h57-7-8" id="h57-7-8" class="d">-                        &quot;genre&quot;,
</a><a href="#h57-7-9" id="h57-7-9" class="d">-                    ),
</a><a href="#h57-7-10" id="h57-7-10" class="d">-                ),
</a><a href="#h57-7-11" id="h57-7-11" class="d">-                Some(
</a><a href="#h57-7-12" id="h57-7-12" class="d">-                    (
</a><a href="#h57-7-13" id="h57-7-13" class="d">-                        None,
</a><a href="#h57-7-14" id="h57-7-14" class="d">-                        &quot;studio&quot;,
</a><a href="#h57-7-15" id="h57-7-15" class="d">-                    ),
</a><a href="#h57-7-16" id="h57-7-16" class="d">-                ),
</a><a href="#h57-7-17" id="h57-7-17" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h57-8" id="h57-8" class="h">@@ -793,6 +800,21 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h57-8-3" id="h57-8-3" class="i">+            labels: [
</a><a href="#h57-8-4" id="h57-8-4" class="i">+                None,
</a><a href="#h57-8-5" id="h57-8-5" class="i">+                Some(
</a><a href="#h57-8-6" id="h57-8-6" class="i">+                    (
</a><a href="#h57-8-7" id="h57-8-7" class="i">+                        None,
</a><a href="#h57-8-8" id="h57-8-8" class="i">+                        &quot;genre&quot;,
</a><a href="#h57-8-9" id="h57-8-9" class="i">+                    ),
</a><a href="#h57-8-10" id="h57-8-10" class="i">+                ),
</a><a href="#h57-8-11" id="h57-8-11" class="i">+                Some(
</a><a href="#h57-8-12" id="h57-8-12" class="i">+                    (
</a><a href="#h57-8-13" id="h57-8-13" class="i">+                        None,
</a><a href="#h57-8-14" id="h57-8-14" class="i">+                        &quot;studio&quot;,
</a><a href="#h57-8-15" id="h57-8-15" class="i">+                    ),
</a><a href="#h57-8-16" id="h57-8-16" class="i">+                ),
</a><a href="#h57-8-17" id="h57-8-17" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h57-9" id="h57-9" class="h">@@ -811,5 +833,27 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h57-9-3" id="h57-9-3" class="d">-)
</a><a href="#h57-9-4" id="h57-9-4" class="i">+    labels: [
</a><a href="#h57-9-5" id="h57-9-5" class="i">+        Some(
</a><a href="#h57-9-6" id="h57-9-6" class="i">+            (
</a><a href="#h57-9-7" id="h57-9-7" class="i">+                Some(
</a><a href="#h57-9-8" id="h57-9-8" class="i">+                    &quot;m&quot;,
</a><a href="#h57-9-9" id="h57-9-9" class="i">+                ),
</a><a href="#h57-9-10" id="h57-9-10" class="i">+                &quot;title&quot;,
</a><a href="#h57-9-11" id="h57-9-11" class="i">+            ),
</a><a href="#h57-9-12" id="h57-9-12" class="i">+        ),
</a><a href="#h57-9-13" id="h57-9-13" class="i">+        Some(
</a><a href="#h57-9-14" id="h57-9-14" class="i">+            (
</a><a href="#h57-9-15" id="h57-9-15" class="i">+                None,
</a><a href="#h57-9-16" id="h57-9-16" class="i">+                &quot;genre&quot;,
</a><a href="#h57-9-17" id="h57-9-17" class="i">+            ),
</a><a href="#h57-9-18" id="h57-9-18" class="i">+        ),
</a><a href="#h57-9-19" id="h57-9-19" class="i">+        Some(
</a><a href="#h57-9-20" id="h57-9-20" class="i">+            (
</a><a href="#h57-9-21" id="h57-9-21" class="i">+                None,
</a><a href="#h57-9-22" id="h57-9-22" class="i">+                &quot;studio&quot;,
</a><a href="#h57-9-23" id="h57-9-23" class="i">+            ),
</a><a href="#h57-9-24" id="h57-9-24" class="i">+        ),
</a><a href="#h57-9-25" id="h57-9-25" class="i">+    ],
</a><a href="#h57-9-26" id="h57-9-26" class="i">+}
</a> 
<b>diff --git a/<a id="h58" href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a> b/<a href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -226,8 +226,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h58-0-3" id="h58-0-3" class="d">-Plan: Select(
</a><a href="#h58-0-4" id="h58-0-4" class="d">-    Projection {
</a><a href="#h58-0-5" id="h58-0-5" class="i">+Plan: Select {
</a><a href="#h58-0-6" id="h58-0-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: Filter {
<a href="#h58-1" id="h58-1" class="h">@@ -311,10 +311,10 @@ Plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h58-1-3" id="h58-1-3" class="i">+                                filter: None,
</a>                                 alias: Some(
                                     &quot;m&quot;,
                                 ),
<a href="#h58-1-7" id="h58-1-7" class="d">-                                filter: None,
</a>                             },
                             left_size: 7,
                             right: Scan {
<a href="#h58-2" id="h58-2" class="h">@@ -342,10 +342,10 @@ Plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h58-2-3" id="h58-2-3" class="i">+                                filter: None,
</a>                                 alias: Some(
                                     &quot;g&quot;,
                                 ),
<a href="#h58-2-7" id="h58-2-7" class="d">-                                filter: None,
</a>                             },
                             predicate: Some(
                                 Equal(
<a href="#h58-3" id="h58-3" class="h">@@ -415,10 +415,10 @@ Plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h58-3-3" id="h58-3-3" class="i">+                                filter: None,
</a>                                 alias: Some(
                                     &quot;s&quot;,
                                 ),
<a href="#h58-3-7" id="h58-3-7" class="d">-                                filter: None,
</a>                             },
                             left_size: 3,
                             right: Scan {
<a href="#h58-4" id="h58-4" class="h">@@ -499,10 +499,10 @@ Plan: Select(
</a>                                         },
                                     ],
                                 },
<a href="#h58-4-3" id="h58-4-3" class="i">+                                filter: None,
</a>                                 alias: Some(
                                     &quot;good&quot;,
                                 ),
<a href="#h58-4-7" id="h58-4-7" class="d">-                                filter: None,
</a>                             },
                             predicate: Some(
                                 And(
<a href="#h58-5" id="h58-5" class="h">@@ -600,24 +600,6 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h58-5-3" id="h58-5-3" class="d">-                labels: [
</a><a href="#h58-5-4" id="h58-5-4" class="d">-                    None,
</a><a href="#h58-5-5" id="h58-5-5" class="d">-                    None,
</a><a href="#h58-5-6" id="h58-5-6" class="d">-                    Some(
</a><a href="#h58-5-7" id="h58-5-7" class="d">-                        (
</a><a href="#h58-5-8" id="h58-5-8" class="d">-                            None,
</a><a href="#h58-5-9" id="h58-5-9" class="d">-                            &quot;genre&quot;,
</a><a href="#h58-5-10" id="h58-5-10" class="d">-                        ),
</a><a href="#h58-5-11" id="h58-5-11" class="d">-                    ),
</a><a href="#h58-5-12" id="h58-5-12" class="d">-                    Some(
</a><a href="#h58-5-13" id="h58-5-13" class="d">-                        (
</a><a href="#h58-5-14" id="h58-5-14" class="d">-                            None,
</a><a href="#h58-5-15" id="h58-5-15" class="d">-                            &quot;studio&quot;,
</a><a href="#h58-5-16" id="h58-5-16" class="d">-                        ),
</a><a href="#h58-5-17" id="h58-5-17" class="d">-                    ),
</a><a href="#h58-5-18" id="h58-5-18" class="d">-                    None,
</a><a href="#h58-5-19" id="h58-5-19" class="d">-                    None,
</a><a href="#h58-5-20" id="h58-5-20" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h58-6" id="h58-6" class="h">@@ -686,6 +668,24 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h58-6-3" id="h58-6-3" class="i">+                labels: [
</a><a href="#h58-6-4" id="h58-6-4" class="i">+                    None,
</a><a href="#h58-6-5" id="h58-6-5" class="i">+                    None,
</a><a href="#h58-6-6" id="h58-6-6" class="i">+                    Some(
</a><a href="#h58-6-7" id="h58-6-7" class="i">+                        (
</a><a href="#h58-6-8" id="h58-6-8" class="i">+                            None,
</a><a href="#h58-6-9" id="h58-6-9" class="i">+                            &quot;genre&quot;,
</a><a href="#h58-6-10" id="h58-6-10" class="i">+                        ),
</a><a href="#h58-6-11" id="h58-6-11" class="i">+                    ),
</a><a href="#h58-6-12" id="h58-6-12" class="i">+                    Some(
</a><a href="#h58-6-13" id="h58-6-13" class="i">+                        (
</a><a href="#h58-6-14" id="h58-6-14" class="i">+                            None,
</a><a href="#h58-6-15" id="h58-6-15" class="i">+                            &quot;studio&quot;,
</a><a href="#h58-6-16" id="h58-6-16" class="i">+                        ),
</a><a href="#h58-6-17" id="h58-6-17" class="i">+                    ),
</a><a href="#h58-6-18" id="h58-6-18" class="i">+                    None,
</a><a href="#h58-6-19" id="h58-6-19" class="i">+                    None,
</a><a href="#h58-6-20" id="h58-6-20" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h58-7" id="h58-7" class="h">@@ -732,13 +732,6 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h58-7-3" id="h58-7-3" class="d">-        labels: [
</a><a href="#h58-7-4" id="h58-7-4" class="d">-            None,
</a><a href="#h58-7-5" id="h58-7-5" class="d">-            None,
</a><a href="#h58-7-6" id="h58-7-6" class="d">-            None,
</a><a href="#h58-7-7" id="h58-7-7" class="d">-            None,
</a><a href="#h58-7-8" id="h58-7-8" class="d">-            None,
</a><a href="#h58-7-9" id="h58-7-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h58-8" id="h58-8" class="h">@@ -761,11 +754,56 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h58-8-3" id="h58-8-3" class="i">+        labels: [
</a><a href="#h58-8-4" id="h58-8-4" class="i">+            None,
</a><a href="#h58-8-5" id="h58-8-5" class="i">+            None,
</a><a href="#h58-8-6" id="h58-8-6" class="i">+            None,
</a><a href="#h58-8-7" id="h58-8-7" class="i">+            None,
</a><a href="#h58-8-8" id="h58-8-8" class="i">+            None,
</a><a href="#h58-8-9" id="h58-8-9" class="i">+        ],
</a>     },
<a href="#h58-8-11" id="h58-8-11" class="d">-)
</a><a href="#h58-8-12" id="h58-8-12" class="i">+    labels: [
</a><a href="#h58-8-13" id="h58-8-13" class="i">+        Some(
</a><a href="#h58-8-14" id="h58-8-14" class="i">+            (
</a><a href="#h58-8-15" id="h58-8-15" class="i">+                Some(
</a><a href="#h58-8-16" id="h58-8-16" class="i">+                    &quot;m&quot;,
</a><a href="#h58-8-17" id="h58-8-17" class="i">+                ),
</a><a href="#h58-8-18" id="h58-8-18" class="i">+                &quot;id&quot;,
</a><a href="#h58-8-19" id="h58-8-19" class="i">+            ),
</a><a href="#h58-8-20" id="h58-8-20" class="i">+        ),
</a><a href="#h58-8-21" id="h58-8-21" class="i">+        Some(
</a><a href="#h58-8-22" id="h58-8-22" class="i">+            (
</a><a href="#h58-8-23" id="h58-8-23" class="i">+                Some(
</a><a href="#h58-8-24" id="h58-8-24" class="i">+                    &quot;m&quot;,
</a><a href="#h58-8-25" id="h58-8-25" class="i">+                ),
</a><a href="#h58-8-26" id="h58-8-26" class="i">+                &quot;title&quot;,
</a><a href="#h58-8-27" id="h58-8-27" class="i">+            ),
</a><a href="#h58-8-28" id="h58-8-28" class="i">+        ),
</a><a href="#h58-8-29" id="h58-8-29" class="i">+        Some(
</a><a href="#h58-8-30" id="h58-8-30" class="i">+            (
</a><a href="#h58-8-31" id="h58-8-31" class="i">+                None,
</a><a href="#h58-8-32" id="h58-8-32" class="i">+                &quot;genre&quot;,
</a><a href="#h58-8-33" id="h58-8-33" class="i">+            ),
</a><a href="#h58-8-34" id="h58-8-34" class="i">+        ),
</a><a href="#h58-8-35" id="h58-8-35" class="i">+        Some(
</a><a href="#h58-8-36" id="h58-8-36" class="i">+            (
</a><a href="#h58-8-37" id="h58-8-37" class="i">+                None,
</a><a href="#h58-8-38" id="h58-8-38" class="i">+                &quot;studio&quot;,
</a><a href="#h58-8-39" id="h58-8-39" class="i">+            ),
</a><a href="#h58-8-40" id="h58-8-40" class="i">+        ),
</a><a href="#h58-8-41" id="h58-8-41" class="i">+        Some(
</a><a href="#h58-8-42" id="h58-8-42" class="i">+            (
</a><a href="#h58-8-43" id="h58-8-43" class="i">+                Some(
</a><a href="#h58-8-44" id="h58-8-44" class="i">+                    &quot;m&quot;,
</a><a href="#h58-8-45" id="h58-8-45" class="i">+                ),
</a><a href="#h58-8-46" id="h58-8-46" class="i">+                &quot;rating&quot;,
</a><a href="#h58-8-47" id="h58-8-47" class="i">+            ),
</a><a href="#h58-8-48" id="h58-8-48" class="i">+        ),
</a><a href="#h58-8-49" id="h58-8-49" class="i">+    ],
</a><a href="#h58-8-50" id="h58-8-50" class="i">+}
</a> 
<a href="#h58-8-52" id="h58-8-52" class="d">-Optimized plan: Select(
</a><a href="#h58-8-53" id="h58-8-53" class="d">-    Projection {
</a><a href="#h58-8-54" id="h58-8-54" class="i">+Optimized plan: Select {
</a><a href="#h58-8-55" id="h58-8-55" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: HashJoin {
<a href="#h58-9" id="h58-9" class="h">@@ -848,10 +886,10 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h58-9-3" id="h58-9-3" class="i">+                            filter: None,
</a>                             alias: Some(
                                 &quot;m&quot;,
                             ),
<a href="#h58-9-7" id="h58-9-7" class="d">-                            filter: None,
</a>                         },
                         left_field: (
                             3,
<a href="#h58-10" id="h58-10" class="h">@@ -889,10 +927,10 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h58-10-3" id="h58-10-3" class="i">+                            filter: None,
</a>                             alias: Some(
                                 &quot;g&quot;,
                             ),
<a href="#h58-10-7" id="h58-10-7" class="d">-                            filter: None,
</a>                         },
                         right_field: (
                             0,
<a href="#h58-11" id="h58-11" class="h">@@ -957,10 +995,10 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h58-11-3" id="h58-11-3" class="i">+                            filter: None,
</a>                             alias: Some(
                                 &quot;s&quot;,
                             ),
<a href="#h58-11-7" id="h58-11-7" class="d">-                            filter: None,
</a>                         },
                         left_field: (
                             0,
<a href="#h58-12" id="h58-12" class="h">@@ -1051,9 +1089,6 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h58-12-3" id="h58-12-3" class="d">-                            alias: Some(
</a><a href="#h58-12-4" id="h58-12-4" class="d">-                                &quot;good&quot;,
</a><a href="#h58-12-5" id="h58-12-5" class="d">-                            ),
</a>                             filter: Some(
                                 Or(
                                     GreaterThan(
<a href="#h58-13" id="h58-13" class="h">@@ -1094,6 +1129,9 @@ Optimized plan: Select(
</a>                                     ),
                                 ),
                             ),
<a href="#h58-13-3" id="h58-13-3" class="i">+                            alias: Some(
</a><a href="#h58-13-4" id="h58-13-4" class="i">+                                &quot;good&quot;,
</a><a href="#h58-13-5" id="h58-13-5" class="i">+                            ),
</a>                         },
                         right_field: (
                             2,
<a href="#h58-14" id="h58-14" class="h">@@ -1121,24 +1159,6 @@ Optimized plan: Select(
</a>                     ),
                     outer: false,
                 },
<a href="#h58-14-3" id="h58-14-3" class="d">-                labels: [
</a><a href="#h58-14-4" id="h58-14-4" class="d">-                    None,
</a><a href="#h58-14-5" id="h58-14-5" class="d">-                    None,
</a><a href="#h58-14-6" id="h58-14-6" class="d">-                    Some(
</a><a href="#h58-14-7" id="h58-14-7" class="d">-                        (
</a><a href="#h58-14-8" id="h58-14-8" class="d">-                            None,
</a><a href="#h58-14-9" id="h58-14-9" class="d">-                            &quot;genre&quot;,
</a><a href="#h58-14-10" id="h58-14-10" class="d">-                        ),
</a><a href="#h58-14-11" id="h58-14-11" class="d">-                    ),
</a><a href="#h58-14-12" id="h58-14-12" class="d">-                    Some(
</a><a href="#h58-14-13" id="h58-14-13" class="d">-                        (
</a><a href="#h58-14-14" id="h58-14-14" class="d">-                            None,
</a><a href="#h58-14-15" id="h58-14-15" class="d">-                            &quot;studio&quot;,
</a><a href="#h58-14-16" id="h58-14-16" class="d">-                        ),
</a><a href="#h58-14-17" id="h58-14-17" class="d">-                    ),
</a><a href="#h58-14-18" id="h58-14-18" class="d">-                    None,
</a><a href="#h58-14-19" id="h58-14-19" class="d">-                    None,
</a><a href="#h58-14-20" id="h58-14-20" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h58-15" id="h58-15" class="h">@@ -1207,6 +1227,24 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h58-15-3" id="h58-15-3" class="i">+                labels: [
</a><a href="#h58-15-4" id="h58-15-4" class="i">+                    None,
</a><a href="#h58-15-5" id="h58-15-5" class="i">+                    None,
</a><a href="#h58-15-6" id="h58-15-6" class="i">+                    Some(
</a><a href="#h58-15-7" id="h58-15-7" class="i">+                        (
</a><a href="#h58-15-8" id="h58-15-8" class="i">+                            None,
</a><a href="#h58-15-9" id="h58-15-9" class="i">+                            &quot;genre&quot;,
</a><a href="#h58-15-10" id="h58-15-10" class="i">+                        ),
</a><a href="#h58-15-11" id="h58-15-11" class="i">+                    ),
</a><a href="#h58-15-12" id="h58-15-12" class="i">+                    Some(
</a><a href="#h58-15-13" id="h58-15-13" class="i">+                        (
</a><a href="#h58-15-14" id="h58-15-14" class="i">+                            None,
</a><a href="#h58-15-15" id="h58-15-15" class="i">+                            &quot;studio&quot;,
</a><a href="#h58-15-16" id="h58-15-16" class="i">+                        ),
</a><a href="#h58-15-17" id="h58-15-17" class="i">+                    ),
</a><a href="#h58-15-18" id="h58-15-18" class="i">+                    None,
</a><a href="#h58-15-19" id="h58-15-19" class="i">+                    None,
</a><a href="#h58-15-20" id="h58-15-20" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h58-16" id="h58-16" class="h">@@ -1253,13 +1291,6 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h58-16-3" id="h58-16-3" class="d">-        labels: [
</a><a href="#h58-16-4" id="h58-16-4" class="d">-            None,
</a><a href="#h58-16-5" id="h58-16-5" class="d">-            None,
</a><a href="#h58-16-6" id="h58-16-6" class="d">-            None,
</a><a href="#h58-16-7" id="h58-16-7" class="d">-            None,
</a><a href="#h58-16-8" id="h58-16-8" class="d">-            None,
</a><a href="#h58-16-9" id="h58-16-9" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h58-17" id="h58-17" class="h">@@ -1282,6 +1313,51 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h58-17-3" id="h58-17-3" class="i">+        labels: [
</a><a href="#h58-17-4" id="h58-17-4" class="i">+            None,
</a><a href="#h58-17-5" id="h58-17-5" class="i">+            None,
</a><a href="#h58-17-6" id="h58-17-6" class="i">+            None,
</a><a href="#h58-17-7" id="h58-17-7" class="i">+            None,
</a><a href="#h58-17-8" id="h58-17-8" class="i">+            None,
</a><a href="#h58-17-9" id="h58-17-9" class="i">+        ],
</a>     },
<a href="#h58-17-11" id="h58-17-11" class="d">-)
</a><a href="#h58-17-12" id="h58-17-12" class="i">+    labels: [
</a><a href="#h58-17-13" id="h58-17-13" class="i">+        Some(
</a><a href="#h58-17-14" id="h58-17-14" class="i">+            (
</a><a href="#h58-17-15" id="h58-17-15" class="i">+                Some(
</a><a href="#h58-17-16" id="h58-17-16" class="i">+                    &quot;m&quot;,
</a><a href="#h58-17-17" id="h58-17-17" class="i">+                ),
</a><a href="#h58-17-18" id="h58-17-18" class="i">+                &quot;id&quot;,
</a><a href="#h58-17-19" id="h58-17-19" class="i">+            ),
</a><a href="#h58-17-20" id="h58-17-20" class="i">+        ),
</a><a href="#h58-17-21" id="h58-17-21" class="i">+        Some(
</a><a href="#h58-17-22" id="h58-17-22" class="i">+            (
</a><a href="#h58-17-23" id="h58-17-23" class="i">+                Some(
</a><a href="#h58-17-24" id="h58-17-24" class="i">+                    &quot;m&quot;,
</a><a href="#h58-17-25" id="h58-17-25" class="i">+                ),
</a><a href="#h58-17-26" id="h58-17-26" class="i">+                &quot;title&quot;,
</a><a href="#h58-17-27" id="h58-17-27" class="i">+            ),
</a><a href="#h58-17-28" id="h58-17-28" class="i">+        ),
</a><a href="#h58-17-29" id="h58-17-29" class="i">+        Some(
</a><a href="#h58-17-30" id="h58-17-30" class="i">+            (
</a><a href="#h58-17-31" id="h58-17-31" class="i">+                None,
</a><a href="#h58-17-32" id="h58-17-32" class="i">+                &quot;genre&quot;,
</a><a href="#h58-17-33" id="h58-17-33" class="i">+            ),
</a><a href="#h58-17-34" id="h58-17-34" class="i">+        ),
</a><a href="#h58-17-35" id="h58-17-35" class="i">+        Some(
</a><a href="#h58-17-36" id="h58-17-36" class="i">+            (
</a><a href="#h58-17-37" id="h58-17-37" class="i">+                None,
</a><a href="#h58-17-38" id="h58-17-38" class="i">+                &quot;studio&quot;,
</a><a href="#h58-17-39" id="h58-17-39" class="i">+            ),
</a><a href="#h58-17-40" id="h58-17-40" class="i">+        ),
</a><a href="#h58-17-41" id="h58-17-41" class="i">+        Some(
</a><a href="#h58-17-42" id="h58-17-42" class="i">+            (
</a><a href="#h58-17-43" id="h58-17-43" class="i">+                Some(
</a><a href="#h58-17-44" id="h58-17-44" class="i">+                    &quot;m&quot;,
</a><a href="#h58-17-45" id="h58-17-45" class="i">+                ),
</a><a href="#h58-17-46" id="h58-17-46" class="i">+                &quot;rating&quot;,
</a><a href="#h58-17-47" id="h58-17-47" class="i">+            ),
</a><a href="#h58-17-48" id="h58-17-48" class="i">+        ),
</a><a href="#h58-17-49" id="h58-17-49" class="i">+    ],
</a><a href="#h58-17-50" id="h58-17-50" class="i">+}
</a> 
<b>diff --git a/<a id="h59" href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a> b/<a href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -62,8 +62,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h59-0-3" id="h59-0-3" class="d">-Plan: Select(
</a><a href="#h59-0-4" id="h59-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h59-0-5" id="h59-0-5" class="i">+Plan: Select {
</a><a href="#h59-0-6" id="h59-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h59-1" id="h59-1" class="h">@@ -142,10 +142,10 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h59-1-3" id="h59-1-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h59-1-7" id="h59-1-7" class="d">-            filter: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h59-2" id="h59-2" class="h">@@ -173,10 +173,10 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h59-2-3" id="h59-2-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<a href="#h59-2-7" id="h59-2-7" class="d">-            filter: None,
</a>         },
         predicate: Some(
             Equal(
<a href="#h59-3" id="h59-3" class="h">@@ -206,10 +206,84 @@ Plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h59-3-3" id="h59-3-3" class="d">-)
</a><a href="#h59-3-4" id="h59-3-4" class="i">+    labels: [
</a><a href="#h59-3-5" id="h59-3-5" class="i">+        Some(
</a><a href="#h59-3-6" id="h59-3-6" class="i">+            (
</a><a href="#h59-3-7" id="h59-3-7" class="i">+                Some(
</a><a href="#h59-3-8" id="h59-3-8" class="i">+                    &quot;m&quot;,
</a><a href="#h59-3-9" id="h59-3-9" class="i">+                ),
</a><a href="#h59-3-10" id="h59-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h59-3-11" id="h59-3-11" class="i">+            ),
</a><a href="#h59-3-12" id="h59-3-12" class="i">+        ),
</a><a href="#h59-3-13" id="h59-3-13" class="i">+        Some(
</a><a href="#h59-3-14" id="h59-3-14" class="i">+            (
</a><a href="#h59-3-15" id="h59-3-15" class="i">+                Some(
</a><a href="#h59-3-16" id="h59-3-16" class="i">+                    &quot;m&quot;,
</a><a href="#h59-3-17" id="h59-3-17" class="i">+                ),
</a><a href="#h59-3-18" id="h59-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h59-3-19" id="h59-3-19" class="i">+            ),
</a><a href="#h59-3-20" id="h59-3-20" class="i">+        ),
</a><a href="#h59-3-21" id="h59-3-21" class="i">+        Some(
</a><a href="#h59-3-22" id="h59-3-22" class="i">+            (
</a><a href="#h59-3-23" id="h59-3-23" class="i">+                Some(
</a><a href="#h59-3-24" id="h59-3-24" class="i">+                    &quot;m&quot;,
</a><a href="#h59-3-25" id="h59-3-25" class="i">+                ),
</a><a href="#h59-3-26" id="h59-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h59-3-27" id="h59-3-27" class="i">+            ),
</a><a href="#h59-3-28" id="h59-3-28" class="i">+        ),
</a><a href="#h59-3-29" id="h59-3-29" class="i">+        Some(
</a><a href="#h59-3-30" id="h59-3-30" class="i">+            (
</a><a href="#h59-3-31" id="h59-3-31" class="i">+                Some(
</a><a href="#h59-3-32" id="h59-3-32" class="i">+                    &quot;m&quot;,
</a><a href="#h59-3-33" id="h59-3-33" class="i">+                ),
</a><a href="#h59-3-34" id="h59-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h59-3-35" id="h59-3-35" class="i">+            ),
</a><a href="#h59-3-36" id="h59-3-36" class="i">+        ),
</a><a href="#h59-3-37" id="h59-3-37" class="i">+        Some(
</a><a href="#h59-3-38" id="h59-3-38" class="i">+            (
</a><a href="#h59-3-39" id="h59-3-39" class="i">+                Some(
</a><a href="#h59-3-40" id="h59-3-40" class="i">+                    &quot;m&quot;,
</a><a href="#h59-3-41" id="h59-3-41" class="i">+                ),
</a><a href="#h59-3-42" id="h59-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h59-3-43" id="h59-3-43" class="i">+            ),
</a><a href="#h59-3-44" id="h59-3-44" class="i">+        ),
</a><a href="#h59-3-45" id="h59-3-45" class="i">+        Some(
</a><a href="#h59-3-46" id="h59-3-46" class="i">+            (
</a><a href="#h59-3-47" id="h59-3-47" class="i">+                Some(
</a><a href="#h59-3-48" id="h59-3-48" class="i">+                    &quot;m&quot;,
</a><a href="#h59-3-49" id="h59-3-49" class="i">+                ),
</a><a href="#h59-3-50" id="h59-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h59-3-51" id="h59-3-51" class="i">+            ),
</a><a href="#h59-3-52" id="h59-3-52" class="i">+        ),
</a><a href="#h59-3-53" id="h59-3-53" class="i">+        Some(
</a><a href="#h59-3-54" id="h59-3-54" class="i">+            (
</a><a href="#h59-3-55" id="h59-3-55" class="i">+                Some(
</a><a href="#h59-3-56" id="h59-3-56" class="i">+                    &quot;m&quot;,
</a><a href="#h59-3-57" id="h59-3-57" class="i">+                ),
</a><a href="#h59-3-58" id="h59-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h59-3-59" id="h59-3-59" class="i">+            ),
</a><a href="#h59-3-60" id="h59-3-60" class="i">+        ),
</a><a href="#h59-3-61" id="h59-3-61" class="i">+        Some(
</a><a href="#h59-3-62" id="h59-3-62" class="i">+            (
</a><a href="#h59-3-63" id="h59-3-63" class="i">+                Some(
</a><a href="#h59-3-64" id="h59-3-64" class="i">+                    &quot;g&quot;,
</a><a href="#h59-3-65" id="h59-3-65" class="i">+                ),
</a><a href="#h59-3-66" id="h59-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h59-3-67" id="h59-3-67" class="i">+            ),
</a><a href="#h59-3-68" id="h59-3-68" class="i">+        ),
</a><a href="#h59-3-69" id="h59-3-69" class="i">+        Some(
</a><a href="#h59-3-70" id="h59-3-70" class="i">+            (
</a><a href="#h59-3-71" id="h59-3-71" class="i">+                Some(
</a><a href="#h59-3-72" id="h59-3-72" class="i">+                    &quot;g&quot;,
</a><a href="#h59-3-73" id="h59-3-73" class="i">+                ),
</a><a href="#h59-3-74" id="h59-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h59-3-75" id="h59-3-75" class="i">+            ),
</a><a href="#h59-3-76" id="h59-3-76" class="i">+        ),
</a><a href="#h59-3-77" id="h59-3-77" class="i">+    ],
</a><a href="#h59-3-78" id="h59-3-78" class="i">+}
</a> 
<a href="#h59-3-80" id="h59-3-80" class="d">-Optimized plan: Select(
</a><a href="#h59-3-81" id="h59-3-81" class="d">-    HashJoin {
</a><a href="#h59-3-82" id="h59-3-82" class="i">+Optimized plan: Select {
</a><a href="#h59-3-83" id="h59-3-83" class="i">+    root: HashJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h59-4" id="h59-4" class="h">@@ -288,10 +362,10 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h59-4-3" id="h59-4-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h59-4-7" id="h59-4-7" class="d">-            filter: None,
</a>         },
         left_field: (
             3,
<a href="#h59-5" id="h59-5" class="h">@@ -329,10 +403,10 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h59-5-3" id="h59-5-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<a href="#h59-5-7" id="h59-5-7" class="d">-            filter: None,
</a>         },
         right_field: (
             0,
<a href="#h59-6" id="h59-6" class="h">@@ -347,5 +421,79 @@ Optimized plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h59-6-3" id="h59-6-3" class="d">-)
</a><a href="#h59-6-4" id="h59-6-4" class="i">+    labels: [
</a><a href="#h59-6-5" id="h59-6-5" class="i">+        Some(
</a><a href="#h59-6-6" id="h59-6-6" class="i">+            (
</a><a href="#h59-6-7" id="h59-6-7" class="i">+                Some(
</a><a href="#h59-6-8" id="h59-6-8" class="i">+                    &quot;m&quot;,
</a><a href="#h59-6-9" id="h59-6-9" class="i">+                ),
</a><a href="#h59-6-10" id="h59-6-10" class="i">+                &quot;id&quot;,
</a><a href="#h59-6-11" id="h59-6-11" class="i">+            ),
</a><a href="#h59-6-12" id="h59-6-12" class="i">+        ),
</a><a href="#h59-6-13" id="h59-6-13" class="i">+        Some(
</a><a href="#h59-6-14" id="h59-6-14" class="i">+            (
</a><a href="#h59-6-15" id="h59-6-15" class="i">+                Some(
</a><a href="#h59-6-16" id="h59-6-16" class="i">+                    &quot;m&quot;,
</a><a href="#h59-6-17" id="h59-6-17" class="i">+                ),
</a><a href="#h59-6-18" id="h59-6-18" class="i">+                &quot;title&quot;,
</a><a href="#h59-6-19" id="h59-6-19" class="i">+            ),
</a><a href="#h59-6-20" id="h59-6-20" class="i">+        ),
</a><a href="#h59-6-21" id="h59-6-21" class="i">+        Some(
</a><a href="#h59-6-22" id="h59-6-22" class="i">+            (
</a><a href="#h59-6-23" id="h59-6-23" class="i">+                Some(
</a><a href="#h59-6-24" id="h59-6-24" class="i">+                    &quot;m&quot;,
</a><a href="#h59-6-25" id="h59-6-25" class="i">+                ),
</a><a href="#h59-6-26" id="h59-6-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h59-6-27" id="h59-6-27" class="i">+            ),
</a><a href="#h59-6-28" id="h59-6-28" class="i">+        ),
</a><a href="#h59-6-29" id="h59-6-29" class="i">+        Some(
</a><a href="#h59-6-30" id="h59-6-30" class="i">+            (
</a><a href="#h59-6-31" id="h59-6-31" class="i">+                Some(
</a><a href="#h59-6-32" id="h59-6-32" class="i">+                    &quot;m&quot;,
</a><a href="#h59-6-33" id="h59-6-33" class="i">+                ),
</a><a href="#h59-6-34" id="h59-6-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h59-6-35" id="h59-6-35" class="i">+            ),
</a><a href="#h59-6-36" id="h59-6-36" class="i">+        ),
</a><a href="#h59-6-37" id="h59-6-37" class="i">+        Some(
</a><a href="#h59-6-38" id="h59-6-38" class="i">+            (
</a><a href="#h59-6-39" id="h59-6-39" class="i">+                Some(
</a><a href="#h59-6-40" id="h59-6-40" class="i">+                    &quot;m&quot;,
</a><a href="#h59-6-41" id="h59-6-41" class="i">+                ),
</a><a href="#h59-6-42" id="h59-6-42" class="i">+                &quot;released&quot;,
</a><a href="#h59-6-43" id="h59-6-43" class="i">+            ),
</a><a href="#h59-6-44" id="h59-6-44" class="i">+        ),
</a><a href="#h59-6-45" id="h59-6-45" class="i">+        Some(
</a><a href="#h59-6-46" id="h59-6-46" class="i">+            (
</a><a href="#h59-6-47" id="h59-6-47" class="i">+                Some(
</a><a href="#h59-6-48" id="h59-6-48" class="i">+                    &quot;m&quot;,
</a><a href="#h59-6-49" id="h59-6-49" class="i">+                ),
</a><a href="#h59-6-50" id="h59-6-50" class="i">+                &quot;rating&quot;,
</a><a href="#h59-6-51" id="h59-6-51" class="i">+            ),
</a><a href="#h59-6-52" id="h59-6-52" class="i">+        ),
</a><a href="#h59-6-53" id="h59-6-53" class="i">+        Some(
</a><a href="#h59-6-54" id="h59-6-54" class="i">+            (
</a><a href="#h59-6-55" id="h59-6-55" class="i">+                Some(
</a><a href="#h59-6-56" id="h59-6-56" class="i">+                    &quot;m&quot;,
</a><a href="#h59-6-57" id="h59-6-57" class="i">+                ),
</a><a href="#h59-6-58" id="h59-6-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h59-6-59" id="h59-6-59" class="i">+            ),
</a><a href="#h59-6-60" id="h59-6-60" class="i">+        ),
</a><a href="#h59-6-61" id="h59-6-61" class="i">+        Some(
</a><a href="#h59-6-62" id="h59-6-62" class="i">+            (
</a><a href="#h59-6-63" id="h59-6-63" class="i">+                Some(
</a><a href="#h59-6-64" id="h59-6-64" class="i">+                    &quot;g&quot;,
</a><a href="#h59-6-65" id="h59-6-65" class="i">+                ),
</a><a href="#h59-6-66" id="h59-6-66" class="i">+                &quot;id&quot;,
</a><a href="#h59-6-67" id="h59-6-67" class="i">+            ),
</a><a href="#h59-6-68" id="h59-6-68" class="i">+        ),
</a><a href="#h59-6-69" id="h59-6-69" class="i">+        Some(
</a><a href="#h59-6-70" id="h59-6-70" class="i">+            (
</a><a href="#h59-6-71" id="h59-6-71" class="i">+                Some(
</a><a href="#h59-6-72" id="h59-6-72" class="i">+                    &quot;g&quot;,
</a><a href="#h59-6-73" id="h59-6-73" class="i">+                ),
</a><a href="#h59-6-74" id="h59-6-74" class="i">+                &quot;name&quot;,
</a><a href="#h59-6-75" id="h59-6-75" class="i">+            ),
</a><a href="#h59-6-76" id="h59-6-76" class="i">+        ),
</a><a href="#h59-6-77" id="h59-6-77" class="i">+    ],
</a><a href="#h59-6-78" id="h59-6-78" class="i">+}
</a> 
<b>diff --git a/<a id="h60" href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a> b/<a href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -37,8 +37,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h60-0-3" id="h60-0-3" class="d">-Plan: Select(
</a><a href="#h60-0-4" id="h60-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h60-0-5" id="h60-0-5" class="i">+Plan: Select {
</a><a href="#h60-0-6" id="h60-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h60-1" id="h60-1" class="h">@@ -117,8 +117,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h60-1-3" id="h60-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h60-1-5" id="h60-1-5" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h60-2" id="h60-2" class="h">@@ -146,8 +146,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h60-2-3" id="h60-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h60-2-5" id="h60-2-5" class="i">+            alias: None,
</a>         },
         predicate: Some(
             Constant(
<a href="#h60-3" id="h60-3" class="h">@@ -158,10 +158,84 @@ Plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h60-3-3" id="h60-3-3" class="d">-)
</a><a href="#h60-3-4" id="h60-3-4" class="i">+    labels: [
</a><a href="#h60-3-5" id="h60-3-5" class="i">+        Some(
</a><a href="#h60-3-6" id="h60-3-6" class="i">+            (
</a><a href="#h60-3-7" id="h60-3-7" class="i">+                Some(
</a><a href="#h60-3-8" id="h60-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-3-9" id="h60-3-9" class="i">+                ),
</a><a href="#h60-3-10" id="h60-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h60-3-11" id="h60-3-11" class="i">+            ),
</a><a href="#h60-3-12" id="h60-3-12" class="i">+        ),
</a><a href="#h60-3-13" id="h60-3-13" class="i">+        Some(
</a><a href="#h60-3-14" id="h60-3-14" class="i">+            (
</a><a href="#h60-3-15" id="h60-3-15" class="i">+                Some(
</a><a href="#h60-3-16" id="h60-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-3-17" id="h60-3-17" class="i">+                ),
</a><a href="#h60-3-18" id="h60-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h60-3-19" id="h60-3-19" class="i">+            ),
</a><a href="#h60-3-20" id="h60-3-20" class="i">+        ),
</a><a href="#h60-3-21" id="h60-3-21" class="i">+        Some(
</a><a href="#h60-3-22" id="h60-3-22" class="i">+            (
</a><a href="#h60-3-23" id="h60-3-23" class="i">+                Some(
</a><a href="#h60-3-24" id="h60-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-3-25" id="h60-3-25" class="i">+                ),
</a><a href="#h60-3-26" id="h60-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h60-3-27" id="h60-3-27" class="i">+            ),
</a><a href="#h60-3-28" id="h60-3-28" class="i">+        ),
</a><a href="#h60-3-29" id="h60-3-29" class="i">+        Some(
</a><a href="#h60-3-30" id="h60-3-30" class="i">+            (
</a><a href="#h60-3-31" id="h60-3-31" class="i">+                Some(
</a><a href="#h60-3-32" id="h60-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-3-33" id="h60-3-33" class="i">+                ),
</a><a href="#h60-3-34" id="h60-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h60-3-35" id="h60-3-35" class="i">+            ),
</a><a href="#h60-3-36" id="h60-3-36" class="i">+        ),
</a><a href="#h60-3-37" id="h60-3-37" class="i">+        Some(
</a><a href="#h60-3-38" id="h60-3-38" class="i">+            (
</a><a href="#h60-3-39" id="h60-3-39" class="i">+                Some(
</a><a href="#h60-3-40" id="h60-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-3-41" id="h60-3-41" class="i">+                ),
</a><a href="#h60-3-42" id="h60-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h60-3-43" id="h60-3-43" class="i">+            ),
</a><a href="#h60-3-44" id="h60-3-44" class="i">+        ),
</a><a href="#h60-3-45" id="h60-3-45" class="i">+        Some(
</a><a href="#h60-3-46" id="h60-3-46" class="i">+            (
</a><a href="#h60-3-47" id="h60-3-47" class="i">+                Some(
</a><a href="#h60-3-48" id="h60-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-3-49" id="h60-3-49" class="i">+                ),
</a><a href="#h60-3-50" id="h60-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h60-3-51" id="h60-3-51" class="i">+            ),
</a><a href="#h60-3-52" id="h60-3-52" class="i">+        ),
</a><a href="#h60-3-53" id="h60-3-53" class="i">+        Some(
</a><a href="#h60-3-54" id="h60-3-54" class="i">+            (
</a><a href="#h60-3-55" id="h60-3-55" class="i">+                Some(
</a><a href="#h60-3-56" id="h60-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-3-57" id="h60-3-57" class="i">+                ),
</a><a href="#h60-3-58" id="h60-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h60-3-59" id="h60-3-59" class="i">+            ),
</a><a href="#h60-3-60" id="h60-3-60" class="i">+        ),
</a><a href="#h60-3-61" id="h60-3-61" class="i">+        Some(
</a><a href="#h60-3-62" id="h60-3-62" class="i">+            (
</a><a href="#h60-3-63" id="h60-3-63" class="i">+                Some(
</a><a href="#h60-3-64" id="h60-3-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h60-3-65" id="h60-3-65" class="i">+                ),
</a><a href="#h60-3-66" id="h60-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h60-3-67" id="h60-3-67" class="i">+            ),
</a><a href="#h60-3-68" id="h60-3-68" class="i">+        ),
</a><a href="#h60-3-69" id="h60-3-69" class="i">+        Some(
</a><a href="#h60-3-70" id="h60-3-70" class="i">+            (
</a><a href="#h60-3-71" id="h60-3-71" class="i">+                Some(
</a><a href="#h60-3-72" id="h60-3-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h60-3-73" id="h60-3-73" class="i">+                ),
</a><a href="#h60-3-74" id="h60-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h60-3-75" id="h60-3-75" class="i">+            ),
</a><a href="#h60-3-76" id="h60-3-76" class="i">+        ),
</a><a href="#h60-3-77" id="h60-3-77" class="i">+    ],
</a><a href="#h60-3-78" id="h60-3-78" class="i">+}
</a> 
<a href="#h60-3-80" id="h60-3-80" class="d">-Optimized plan: Select(
</a><a href="#h60-3-81" id="h60-3-81" class="d">-    NestedLoopJoin {
</a><a href="#h60-3-82" id="h60-3-82" class="i">+Optimized plan: Select {
</a><a href="#h60-3-83" id="h60-3-83" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h60-4" id="h60-4" class="h">@@ -240,7 +314,6 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h60-4-3" id="h60-4-3" class="d">-            alias: None,
</a>             filter: Some(
                 Constant(
                     Boolean(
<a href="#h60-5" id="h60-5" class="h">@@ -248,6 +321,7 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ),
<a href="#h60-5-3" id="h60-5-3" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h60-6" id="h60-6" class="h">@@ -275,11 +349,85 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h60-6-3" id="h60-6-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h60-6-5" id="h60-6-5" class="i">+            alias: None,
</a>         },
         predicate: None,
         outer: false,
     },
<a href="#h60-6-10" id="h60-6-10" class="d">-)
</a><a href="#h60-6-11" id="h60-6-11" class="i">+    labels: [
</a><a href="#h60-6-12" id="h60-6-12" class="i">+        Some(
</a><a href="#h60-6-13" id="h60-6-13" class="i">+            (
</a><a href="#h60-6-14" id="h60-6-14" class="i">+                Some(
</a><a href="#h60-6-15" id="h60-6-15" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-6-16" id="h60-6-16" class="i">+                ),
</a><a href="#h60-6-17" id="h60-6-17" class="i">+                &quot;id&quot;,
</a><a href="#h60-6-18" id="h60-6-18" class="i">+            ),
</a><a href="#h60-6-19" id="h60-6-19" class="i">+        ),
</a><a href="#h60-6-20" id="h60-6-20" class="i">+        Some(
</a><a href="#h60-6-21" id="h60-6-21" class="i">+            (
</a><a href="#h60-6-22" id="h60-6-22" class="i">+                Some(
</a><a href="#h60-6-23" id="h60-6-23" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-6-24" id="h60-6-24" class="i">+                ),
</a><a href="#h60-6-25" id="h60-6-25" class="i">+                &quot;title&quot;,
</a><a href="#h60-6-26" id="h60-6-26" class="i">+            ),
</a><a href="#h60-6-27" id="h60-6-27" class="i">+        ),
</a><a href="#h60-6-28" id="h60-6-28" class="i">+        Some(
</a><a href="#h60-6-29" id="h60-6-29" class="i">+            (
</a><a href="#h60-6-30" id="h60-6-30" class="i">+                Some(
</a><a href="#h60-6-31" id="h60-6-31" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-6-32" id="h60-6-32" class="i">+                ),
</a><a href="#h60-6-33" id="h60-6-33" class="i">+                &quot;studio_id&quot;,
</a><a href="#h60-6-34" id="h60-6-34" class="i">+            ),
</a><a href="#h60-6-35" id="h60-6-35" class="i">+        ),
</a><a href="#h60-6-36" id="h60-6-36" class="i">+        Some(
</a><a href="#h60-6-37" id="h60-6-37" class="i">+            (
</a><a href="#h60-6-38" id="h60-6-38" class="i">+                Some(
</a><a href="#h60-6-39" id="h60-6-39" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-6-40" id="h60-6-40" class="i">+                ),
</a><a href="#h60-6-41" id="h60-6-41" class="i">+                &quot;genre_id&quot;,
</a><a href="#h60-6-42" id="h60-6-42" class="i">+            ),
</a><a href="#h60-6-43" id="h60-6-43" class="i">+        ),
</a><a href="#h60-6-44" id="h60-6-44" class="i">+        Some(
</a><a href="#h60-6-45" id="h60-6-45" class="i">+            (
</a><a href="#h60-6-46" id="h60-6-46" class="i">+                Some(
</a><a href="#h60-6-47" id="h60-6-47" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-6-48" id="h60-6-48" class="i">+                ),
</a><a href="#h60-6-49" id="h60-6-49" class="i">+                &quot;released&quot;,
</a><a href="#h60-6-50" id="h60-6-50" class="i">+            ),
</a><a href="#h60-6-51" id="h60-6-51" class="i">+        ),
</a><a href="#h60-6-52" id="h60-6-52" class="i">+        Some(
</a><a href="#h60-6-53" id="h60-6-53" class="i">+            (
</a><a href="#h60-6-54" id="h60-6-54" class="i">+                Some(
</a><a href="#h60-6-55" id="h60-6-55" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-6-56" id="h60-6-56" class="i">+                ),
</a><a href="#h60-6-57" id="h60-6-57" class="i">+                &quot;rating&quot;,
</a><a href="#h60-6-58" id="h60-6-58" class="i">+            ),
</a><a href="#h60-6-59" id="h60-6-59" class="i">+        ),
</a><a href="#h60-6-60" id="h60-6-60" class="i">+        Some(
</a><a href="#h60-6-61" id="h60-6-61" class="i">+            (
</a><a href="#h60-6-62" id="h60-6-62" class="i">+                Some(
</a><a href="#h60-6-63" id="h60-6-63" class="i">+                    &quot;movies&quot;,
</a><a href="#h60-6-64" id="h60-6-64" class="i">+                ),
</a><a href="#h60-6-65" id="h60-6-65" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h60-6-66" id="h60-6-66" class="i">+            ),
</a><a href="#h60-6-67" id="h60-6-67" class="i">+        ),
</a><a href="#h60-6-68" id="h60-6-68" class="i">+        Some(
</a><a href="#h60-6-69" id="h60-6-69" class="i">+            (
</a><a href="#h60-6-70" id="h60-6-70" class="i">+                Some(
</a><a href="#h60-6-71" id="h60-6-71" class="i">+                    &quot;genres&quot;,
</a><a href="#h60-6-72" id="h60-6-72" class="i">+                ),
</a><a href="#h60-6-73" id="h60-6-73" class="i">+                &quot;id&quot;,
</a><a href="#h60-6-74" id="h60-6-74" class="i">+            ),
</a><a href="#h60-6-75" id="h60-6-75" class="i">+        ),
</a><a href="#h60-6-76" id="h60-6-76" class="i">+        Some(
</a><a href="#h60-6-77" id="h60-6-77" class="i">+            (
</a><a href="#h60-6-78" id="h60-6-78" class="i">+                Some(
</a><a href="#h60-6-79" id="h60-6-79" class="i">+                    &quot;genres&quot;,
</a><a href="#h60-6-80" id="h60-6-80" class="i">+                ),
</a><a href="#h60-6-81" id="h60-6-81" class="i">+                &quot;name&quot;,
</a><a href="#h60-6-82" id="h60-6-82" class="i">+            ),
</a><a href="#h60-6-83" id="h60-6-83" class="i">+        ),
</a><a href="#h60-6-84" id="h60-6-84" class="i">+    ],
</a><a href="#h60-6-85" id="h60-6-85" class="i">+}
</a> 
<b>diff --git a/<a id="h61" href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a> b/<a href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -70,8 +70,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h61-0-3" id="h61-0-3" class="d">-Plan: Select(
</a><a href="#h61-0-4" id="h61-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h61-0-5" id="h61-0-5" class="i">+Plan: Select {
</a><a href="#h61-0-6" id="h61-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h61-1" id="h61-1" class="h">@@ -150,8 +150,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h61-1-3" id="h61-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h61-1-5" id="h61-1-5" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h61-2" id="h61-2" class="h">@@ -179,8 +179,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h61-2-3" id="h61-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h61-2-5" id="h61-2-5" class="i">+            alias: None,
</a>         },
         predicate: Some(
             And(
<a href="#h61-3" id="h61-3" class="h">@@ -236,10 +236,84 @@ Plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h61-3-3" id="h61-3-3" class="d">-)
</a><a href="#h61-3-4" id="h61-3-4" class="i">+    labels: [
</a><a href="#h61-3-5" id="h61-3-5" class="i">+        Some(
</a><a href="#h61-3-6" id="h61-3-6" class="i">+            (
</a><a href="#h61-3-7" id="h61-3-7" class="i">+                Some(
</a><a href="#h61-3-8" id="h61-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-3-9" id="h61-3-9" class="i">+                ),
</a><a href="#h61-3-10" id="h61-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h61-3-11" id="h61-3-11" class="i">+            ),
</a><a href="#h61-3-12" id="h61-3-12" class="i">+        ),
</a><a href="#h61-3-13" id="h61-3-13" class="i">+        Some(
</a><a href="#h61-3-14" id="h61-3-14" class="i">+            (
</a><a href="#h61-3-15" id="h61-3-15" class="i">+                Some(
</a><a href="#h61-3-16" id="h61-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-3-17" id="h61-3-17" class="i">+                ),
</a><a href="#h61-3-18" id="h61-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h61-3-19" id="h61-3-19" class="i">+            ),
</a><a href="#h61-3-20" id="h61-3-20" class="i">+        ),
</a><a href="#h61-3-21" id="h61-3-21" class="i">+        Some(
</a><a href="#h61-3-22" id="h61-3-22" class="i">+            (
</a><a href="#h61-3-23" id="h61-3-23" class="i">+                Some(
</a><a href="#h61-3-24" id="h61-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-3-25" id="h61-3-25" class="i">+                ),
</a><a href="#h61-3-26" id="h61-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h61-3-27" id="h61-3-27" class="i">+            ),
</a><a href="#h61-3-28" id="h61-3-28" class="i">+        ),
</a><a href="#h61-3-29" id="h61-3-29" class="i">+        Some(
</a><a href="#h61-3-30" id="h61-3-30" class="i">+            (
</a><a href="#h61-3-31" id="h61-3-31" class="i">+                Some(
</a><a href="#h61-3-32" id="h61-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-3-33" id="h61-3-33" class="i">+                ),
</a><a href="#h61-3-34" id="h61-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h61-3-35" id="h61-3-35" class="i">+            ),
</a><a href="#h61-3-36" id="h61-3-36" class="i">+        ),
</a><a href="#h61-3-37" id="h61-3-37" class="i">+        Some(
</a><a href="#h61-3-38" id="h61-3-38" class="i">+            (
</a><a href="#h61-3-39" id="h61-3-39" class="i">+                Some(
</a><a href="#h61-3-40" id="h61-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-3-41" id="h61-3-41" class="i">+                ),
</a><a href="#h61-3-42" id="h61-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h61-3-43" id="h61-3-43" class="i">+            ),
</a><a href="#h61-3-44" id="h61-3-44" class="i">+        ),
</a><a href="#h61-3-45" id="h61-3-45" class="i">+        Some(
</a><a href="#h61-3-46" id="h61-3-46" class="i">+            (
</a><a href="#h61-3-47" id="h61-3-47" class="i">+                Some(
</a><a href="#h61-3-48" id="h61-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-3-49" id="h61-3-49" class="i">+                ),
</a><a href="#h61-3-50" id="h61-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h61-3-51" id="h61-3-51" class="i">+            ),
</a><a href="#h61-3-52" id="h61-3-52" class="i">+        ),
</a><a href="#h61-3-53" id="h61-3-53" class="i">+        Some(
</a><a href="#h61-3-54" id="h61-3-54" class="i">+            (
</a><a href="#h61-3-55" id="h61-3-55" class="i">+                Some(
</a><a href="#h61-3-56" id="h61-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-3-57" id="h61-3-57" class="i">+                ),
</a><a href="#h61-3-58" id="h61-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h61-3-59" id="h61-3-59" class="i">+            ),
</a><a href="#h61-3-60" id="h61-3-60" class="i">+        ),
</a><a href="#h61-3-61" id="h61-3-61" class="i">+        Some(
</a><a href="#h61-3-62" id="h61-3-62" class="i">+            (
</a><a href="#h61-3-63" id="h61-3-63" class="i">+                Some(
</a><a href="#h61-3-64" id="h61-3-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h61-3-65" id="h61-3-65" class="i">+                ),
</a><a href="#h61-3-66" id="h61-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h61-3-67" id="h61-3-67" class="i">+            ),
</a><a href="#h61-3-68" id="h61-3-68" class="i">+        ),
</a><a href="#h61-3-69" id="h61-3-69" class="i">+        Some(
</a><a href="#h61-3-70" id="h61-3-70" class="i">+            (
</a><a href="#h61-3-71" id="h61-3-71" class="i">+                Some(
</a><a href="#h61-3-72" id="h61-3-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h61-3-73" id="h61-3-73" class="i">+                ),
</a><a href="#h61-3-74" id="h61-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h61-3-75" id="h61-3-75" class="i">+            ),
</a><a href="#h61-3-76" id="h61-3-76" class="i">+        ),
</a><a href="#h61-3-77" id="h61-3-77" class="i">+    ],
</a><a href="#h61-3-78" id="h61-3-78" class="i">+}
</a> 
<a href="#h61-3-80" id="h61-3-80" class="d">-Optimized plan: Select(
</a><a href="#h61-3-81" id="h61-3-81" class="d">-    NestedLoopJoin {
</a><a href="#h61-3-82" id="h61-3-82" class="i">+Optimized plan: Select {
</a><a href="#h61-3-83" id="h61-3-83" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h61-4" id="h61-4" class="h">@@ -318,8 +392,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h61-4-3" id="h61-4-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h61-4-5" id="h61-4-5" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h61-5" id="h61-5" class="h">@@ -347,8 +421,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h61-5-3" id="h61-5-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h61-5-5" id="h61-5-5" class="i">+            alias: None,
</a>         },
         predicate: Some(
             And(
<a href="#h61-6" id="h61-6" class="h">@@ -404,5 +478,79 @@ Optimized plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h61-6-3" id="h61-6-3" class="d">-)
</a><a href="#h61-6-4" id="h61-6-4" class="i">+    labels: [
</a><a href="#h61-6-5" id="h61-6-5" class="i">+        Some(
</a><a href="#h61-6-6" id="h61-6-6" class="i">+            (
</a><a href="#h61-6-7" id="h61-6-7" class="i">+                Some(
</a><a href="#h61-6-8" id="h61-6-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-6-9" id="h61-6-9" class="i">+                ),
</a><a href="#h61-6-10" id="h61-6-10" class="i">+                &quot;id&quot;,
</a><a href="#h61-6-11" id="h61-6-11" class="i">+            ),
</a><a href="#h61-6-12" id="h61-6-12" class="i">+        ),
</a><a href="#h61-6-13" id="h61-6-13" class="i">+        Some(
</a><a href="#h61-6-14" id="h61-6-14" class="i">+            (
</a><a href="#h61-6-15" id="h61-6-15" class="i">+                Some(
</a><a href="#h61-6-16" id="h61-6-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-6-17" id="h61-6-17" class="i">+                ),
</a><a href="#h61-6-18" id="h61-6-18" class="i">+                &quot;title&quot;,
</a><a href="#h61-6-19" id="h61-6-19" class="i">+            ),
</a><a href="#h61-6-20" id="h61-6-20" class="i">+        ),
</a><a href="#h61-6-21" id="h61-6-21" class="i">+        Some(
</a><a href="#h61-6-22" id="h61-6-22" class="i">+            (
</a><a href="#h61-6-23" id="h61-6-23" class="i">+                Some(
</a><a href="#h61-6-24" id="h61-6-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-6-25" id="h61-6-25" class="i">+                ),
</a><a href="#h61-6-26" id="h61-6-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h61-6-27" id="h61-6-27" class="i">+            ),
</a><a href="#h61-6-28" id="h61-6-28" class="i">+        ),
</a><a href="#h61-6-29" id="h61-6-29" class="i">+        Some(
</a><a href="#h61-6-30" id="h61-6-30" class="i">+            (
</a><a href="#h61-6-31" id="h61-6-31" class="i">+                Some(
</a><a href="#h61-6-32" id="h61-6-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-6-33" id="h61-6-33" class="i">+                ),
</a><a href="#h61-6-34" id="h61-6-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h61-6-35" id="h61-6-35" class="i">+            ),
</a><a href="#h61-6-36" id="h61-6-36" class="i">+        ),
</a><a href="#h61-6-37" id="h61-6-37" class="i">+        Some(
</a><a href="#h61-6-38" id="h61-6-38" class="i">+            (
</a><a href="#h61-6-39" id="h61-6-39" class="i">+                Some(
</a><a href="#h61-6-40" id="h61-6-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-6-41" id="h61-6-41" class="i">+                ),
</a><a href="#h61-6-42" id="h61-6-42" class="i">+                &quot;released&quot;,
</a><a href="#h61-6-43" id="h61-6-43" class="i">+            ),
</a><a href="#h61-6-44" id="h61-6-44" class="i">+        ),
</a><a href="#h61-6-45" id="h61-6-45" class="i">+        Some(
</a><a href="#h61-6-46" id="h61-6-46" class="i">+            (
</a><a href="#h61-6-47" id="h61-6-47" class="i">+                Some(
</a><a href="#h61-6-48" id="h61-6-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-6-49" id="h61-6-49" class="i">+                ),
</a><a href="#h61-6-50" id="h61-6-50" class="i">+                &quot;rating&quot;,
</a><a href="#h61-6-51" id="h61-6-51" class="i">+            ),
</a><a href="#h61-6-52" id="h61-6-52" class="i">+        ),
</a><a href="#h61-6-53" id="h61-6-53" class="i">+        Some(
</a><a href="#h61-6-54" id="h61-6-54" class="i">+            (
</a><a href="#h61-6-55" id="h61-6-55" class="i">+                Some(
</a><a href="#h61-6-56" id="h61-6-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h61-6-57" id="h61-6-57" class="i">+                ),
</a><a href="#h61-6-58" id="h61-6-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h61-6-59" id="h61-6-59" class="i">+            ),
</a><a href="#h61-6-60" id="h61-6-60" class="i">+        ),
</a><a href="#h61-6-61" id="h61-6-61" class="i">+        Some(
</a><a href="#h61-6-62" id="h61-6-62" class="i">+            (
</a><a href="#h61-6-63" id="h61-6-63" class="i">+                Some(
</a><a href="#h61-6-64" id="h61-6-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h61-6-65" id="h61-6-65" class="i">+                ),
</a><a href="#h61-6-66" id="h61-6-66" class="i">+                &quot;id&quot;,
</a><a href="#h61-6-67" id="h61-6-67" class="i">+            ),
</a><a href="#h61-6-68" id="h61-6-68" class="i">+        ),
</a><a href="#h61-6-69" id="h61-6-69" class="i">+        Some(
</a><a href="#h61-6-70" id="h61-6-70" class="i">+            (
</a><a href="#h61-6-71" id="h61-6-71" class="i">+                Some(
</a><a href="#h61-6-72" id="h61-6-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h61-6-73" id="h61-6-73" class="i">+                ),
</a><a href="#h61-6-74" id="h61-6-74" class="i">+                &quot;name&quot;,
</a><a href="#h61-6-75" id="h61-6-75" class="i">+            ),
</a><a href="#h61-6-76" id="h61-6-76" class="i">+        ),
</a><a href="#h61-6-77" id="h61-6-77" class="i">+    ],
</a><a href="#h61-6-78" id="h61-6-78" class="i">+}
</a> 
<b>diff --git a/<a id="h62" href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a> b/<a href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -67,8 +67,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h62-0-3" id="h62-0-3" class="d">-Plan: Select(
</a><a href="#h62-0-4" id="h62-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h62-0-5" id="h62-0-5" class="i">+Plan: Select {
</a><a href="#h62-0-6" id="h62-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h62-1" id="h62-1" class="h">@@ -147,8 +147,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h62-1-3" id="h62-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h62-1-5" id="h62-1-5" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h62-2" id="h62-2" class="h">@@ -176,8 +176,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h62-2-3" id="h62-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h62-2-5" id="h62-2-5" class="i">+            alias: None,
</a>         },
         predicate: Some(
             Constant(
<a href="#h62-3" id="h62-3" class="h">@@ -188,10 +188,84 @@ Plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h62-3-3" id="h62-3-3" class="d">-)
</a><a href="#h62-3-4" id="h62-3-4" class="i">+    labels: [
</a><a href="#h62-3-5" id="h62-3-5" class="i">+        Some(
</a><a href="#h62-3-6" id="h62-3-6" class="i">+            (
</a><a href="#h62-3-7" id="h62-3-7" class="i">+                Some(
</a><a href="#h62-3-8" id="h62-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-3-9" id="h62-3-9" class="i">+                ),
</a><a href="#h62-3-10" id="h62-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h62-3-11" id="h62-3-11" class="i">+            ),
</a><a href="#h62-3-12" id="h62-3-12" class="i">+        ),
</a><a href="#h62-3-13" id="h62-3-13" class="i">+        Some(
</a><a href="#h62-3-14" id="h62-3-14" class="i">+            (
</a><a href="#h62-3-15" id="h62-3-15" class="i">+                Some(
</a><a href="#h62-3-16" id="h62-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-3-17" id="h62-3-17" class="i">+                ),
</a><a href="#h62-3-18" id="h62-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h62-3-19" id="h62-3-19" class="i">+            ),
</a><a href="#h62-3-20" id="h62-3-20" class="i">+        ),
</a><a href="#h62-3-21" id="h62-3-21" class="i">+        Some(
</a><a href="#h62-3-22" id="h62-3-22" class="i">+            (
</a><a href="#h62-3-23" id="h62-3-23" class="i">+                Some(
</a><a href="#h62-3-24" id="h62-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-3-25" id="h62-3-25" class="i">+                ),
</a><a href="#h62-3-26" id="h62-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h62-3-27" id="h62-3-27" class="i">+            ),
</a><a href="#h62-3-28" id="h62-3-28" class="i">+        ),
</a><a href="#h62-3-29" id="h62-3-29" class="i">+        Some(
</a><a href="#h62-3-30" id="h62-3-30" class="i">+            (
</a><a href="#h62-3-31" id="h62-3-31" class="i">+                Some(
</a><a href="#h62-3-32" id="h62-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-3-33" id="h62-3-33" class="i">+                ),
</a><a href="#h62-3-34" id="h62-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h62-3-35" id="h62-3-35" class="i">+            ),
</a><a href="#h62-3-36" id="h62-3-36" class="i">+        ),
</a><a href="#h62-3-37" id="h62-3-37" class="i">+        Some(
</a><a href="#h62-3-38" id="h62-3-38" class="i">+            (
</a><a href="#h62-3-39" id="h62-3-39" class="i">+                Some(
</a><a href="#h62-3-40" id="h62-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-3-41" id="h62-3-41" class="i">+                ),
</a><a href="#h62-3-42" id="h62-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h62-3-43" id="h62-3-43" class="i">+            ),
</a><a href="#h62-3-44" id="h62-3-44" class="i">+        ),
</a><a href="#h62-3-45" id="h62-3-45" class="i">+        Some(
</a><a href="#h62-3-46" id="h62-3-46" class="i">+            (
</a><a href="#h62-3-47" id="h62-3-47" class="i">+                Some(
</a><a href="#h62-3-48" id="h62-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-3-49" id="h62-3-49" class="i">+                ),
</a><a href="#h62-3-50" id="h62-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h62-3-51" id="h62-3-51" class="i">+            ),
</a><a href="#h62-3-52" id="h62-3-52" class="i">+        ),
</a><a href="#h62-3-53" id="h62-3-53" class="i">+        Some(
</a><a href="#h62-3-54" id="h62-3-54" class="i">+            (
</a><a href="#h62-3-55" id="h62-3-55" class="i">+                Some(
</a><a href="#h62-3-56" id="h62-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-3-57" id="h62-3-57" class="i">+                ),
</a><a href="#h62-3-58" id="h62-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h62-3-59" id="h62-3-59" class="i">+            ),
</a><a href="#h62-3-60" id="h62-3-60" class="i">+        ),
</a><a href="#h62-3-61" id="h62-3-61" class="i">+        Some(
</a><a href="#h62-3-62" id="h62-3-62" class="i">+            (
</a><a href="#h62-3-63" id="h62-3-63" class="i">+                Some(
</a><a href="#h62-3-64" id="h62-3-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h62-3-65" id="h62-3-65" class="i">+                ),
</a><a href="#h62-3-66" id="h62-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h62-3-67" id="h62-3-67" class="i">+            ),
</a><a href="#h62-3-68" id="h62-3-68" class="i">+        ),
</a><a href="#h62-3-69" id="h62-3-69" class="i">+        Some(
</a><a href="#h62-3-70" id="h62-3-70" class="i">+            (
</a><a href="#h62-3-71" id="h62-3-71" class="i">+                Some(
</a><a href="#h62-3-72" id="h62-3-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h62-3-73" id="h62-3-73" class="i">+                ),
</a><a href="#h62-3-74" id="h62-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h62-3-75" id="h62-3-75" class="i">+            ),
</a><a href="#h62-3-76" id="h62-3-76" class="i">+        ),
</a><a href="#h62-3-77" id="h62-3-77" class="i">+    ],
</a><a href="#h62-3-78" id="h62-3-78" class="i">+}
</a> 
<a href="#h62-3-80" id="h62-3-80" class="d">-Optimized plan: Select(
</a><a href="#h62-3-81" id="h62-3-81" class="d">-    NestedLoopJoin {
</a><a href="#h62-3-82" id="h62-3-82" class="i">+Optimized plan: Select {
</a><a href="#h62-3-83" id="h62-3-83" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h62-4" id="h62-4" class="h">@@ -270,7 +344,6 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h62-4-3" id="h62-4-3" class="d">-            alias: None,
</a>             filter: Some(
                 Constant(
                     Boolean(
<a href="#h62-5" id="h62-5" class="h">@@ -278,6 +351,7 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ),
<a href="#h62-5-3" id="h62-5-3" class="i">+            alias: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h62-6" id="h62-6" class="h">@@ -305,11 +379,85 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h62-6-3" id="h62-6-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h62-6-5" id="h62-6-5" class="i">+            alias: None,
</a>         },
         predicate: None,
         outer: false,
     },
<a href="#h62-6-10" id="h62-6-10" class="d">-)
</a><a href="#h62-6-11" id="h62-6-11" class="i">+    labels: [
</a><a href="#h62-6-12" id="h62-6-12" class="i">+        Some(
</a><a href="#h62-6-13" id="h62-6-13" class="i">+            (
</a><a href="#h62-6-14" id="h62-6-14" class="i">+                Some(
</a><a href="#h62-6-15" id="h62-6-15" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-6-16" id="h62-6-16" class="i">+                ),
</a><a href="#h62-6-17" id="h62-6-17" class="i">+                &quot;id&quot;,
</a><a href="#h62-6-18" id="h62-6-18" class="i">+            ),
</a><a href="#h62-6-19" id="h62-6-19" class="i">+        ),
</a><a href="#h62-6-20" id="h62-6-20" class="i">+        Some(
</a><a href="#h62-6-21" id="h62-6-21" class="i">+            (
</a><a href="#h62-6-22" id="h62-6-22" class="i">+                Some(
</a><a href="#h62-6-23" id="h62-6-23" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-6-24" id="h62-6-24" class="i">+                ),
</a><a href="#h62-6-25" id="h62-6-25" class="i">+                &quot;title&quot;,
</a><a href="#h62-6-26" id="h62-6-26" class="i">+            ),
</a><a href="#h62-6-27" id="h62-6-27" class="i">+        ),
</a><a href="#h62-6-28" id="h62-6-28" class="i">+        Some(
</a><a href="#h62-6-29" id="h62-6-29" class="i">+            (
</a><a href="#h62-6-30" id="h62-6-30" class="i">+                Some(
</a><a href="#h62-6-31" id="h62-6-31" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-6-32" id="h62-6-32" class="i">+                ),
</a><a href="#h62-6-33" id="h62-6-33" class="i">+                &quot;studio_id&quot;,
</a><a href="#h62-6-34" id="h62-6-34" class="i">+            ),
</a><a href="#h62-6-35" id="h62-6-35" class="i">+        ),
</a><a href="#h62-6-36" id="h62-6-36" class="i">+        Some(
</a><a href="#h62-6-37" id="h62-6-37" class="i">+            (
</a><a href="#h62-6-38" id="h62-6-38" class="i">+                Some(
</a><a href="#h62-6-39" id="h62-6-39" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-6-40" id="h62-6-40" class="i">+                ),
</a><a href="#h62-6-41" id="h62-6-41" class="i">+                &quot;genre_id&quot;,
</a><a href="#h62-6-42" id="h62-6-42" class="i">+            ),
</a><a href="#h62-6-43" id="h62-6-43" class="i">+        ),
</a><a href="#h62-6-44" id="h62-6-44" class="i">+        Some(
</a><a href="#h62-6-45" id="h62-6-45" class="i">+            (
</a><a href="#h62-6-46" id="h62-6-46" class="i">+                Some(
</a><a href="#h62-6-47" id="h62-6-47" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-6-48" id="h62-6-48" class="i">+                ),
</a><a href="#h62-6-49" id="h62-6-49" class="i">+                &quot;released&quot;,
</a><a href="#h62-6-50" id="h62-6-50" class="i">+            ),
</a><a href="#h62-6-51" id="h62-6-51" class="i">+        ),
</a><a href="#h62-6-52" id="h62-6-52" class="i">+        Some(
</a><a href="#h62-6-53" id="h62-6-53" class="i">+            (
</a><a href="#h62-6-54" id="h62-6-54" class="i">+                Some(
</a><a href="#h62-6-55" id="h62-6-55" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-6-56" id="h62-6-56" class="i">+                ),
</a><a href="#h62-6-57" id="h62-6-57" class="i">+                &quot;rating&quot;,
</a><a href="#h62-6-58" id="h62-6-58" class="i">+            ),
</a><a href="#h62-6-59" id="h62-6-59" class="i">+        ),
</a><a href="#h62-6-60" id="h62-6-60" class="i">+        Some(
</a><a href="#h62-6-61" id="h62-6-61" class="i">+            (
</a><a href="#h62-6-62" id="h62-6-62" class="i">+                Some(
</a><a href="#h62-6-63" id="h62-6-63" class="i">+                    &quot;movies&quot;,
</a><a href="#h62-6-64" id="h62-6-64" class="i">+                ),
</a><a href="#h62-6-65" id="h62-6-65" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h62-6-66" id="h62-6-66" class="i">+            ),
</a><a href="#h62-6-67" id="h62-6-67" class="i">+        ),
</a><a href="#h62-6-68" id="h62-6-68" class="i">+        Some(
</a><a href="#h62-6-69" id="h62-6-69" class="i">+            (
</a><a href="#h62-6-70" id="h62-6-70" class="i">+                Some(
</a><a href="#h62-6-71" id="h62-6-71" class="i">+                    &quot;genres&quot;,
</a><a href="#h62-6-72" id="h62-6-72" class="i">+                ),
</a><a href="#h62-6-73" id="h62-6-73" class="i">+                &quot;id&quot;,
</a><a href="#h62-6-74" id="h62-6-74" class="i">+            ),
</a><a href="#h62-6-75" id="h62-6-75" class="i">+        ),
</a><a href="#h62-6-76" id="h62-6-76" class="i">+        Some(
</a><a href="#h62-6-77" id="h62-6-77" class="i">+            (
</a><a href="#h62-6-78" id="h62-6-78" class="i">+                Some(
</a><a href="#h62-6-79" id="h62-6-79" class="i">+                    &quot;genres&quot;,
</a><a href="#h62-6-80" id="h62-6-80" class="i">+                ),
</a><a href="#h62-6-81" id="h62-6-81" class="i">+                &quot;name&quot;,
</a><a href="#h62-6-82" id="h62-6-82" class="i">+            ),
</a><a href="#h62-6-83" id="h62-6-83" class="i">+        ),
</a><a href="#h62-6-84" id="h62-6-84" class="i">+    ],
</a><a href="#h62-6-85" id="h62-6-85" class="i">+}
</a> 
<b>diff --git a/<a id="h63" href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a> b/<a href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -72,8 +72,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h63-0-3" id="h63-0-3" class="d">-Plan: Select(
</a><a href="#h63-0-4" id="h63-0-4" class="d">-    Filter {
</a><a href="#h63-0-5" id="h63-0-5" class="i">+Plan: Select {
</a><a href="#h63-0-6" id="h63-0-6" class="i">+    root: Filter {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h63-1" id="h63-1" class="h">@@ -153,8 +153,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h63-1-3" id="h63-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h63-1-5" id="h63-1-5" class="i">+                alias: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h63-2" id="h63-2" class="h">@@ -182,8 +182,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h63-2-3" id="h63-2-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h63-2-5" id="h63-2-5" class="i">+                alias: None,
</a>             },
             predicate: Some(
                 Equal(
<a href="#h63-3" id="h63-3" class="h">@@ -252,10 +252,84 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h63-3-3" id="h63-3-3" class="d">-)
</a><a href="#h63-3-4" id="h63-3-4" class="i">+    labels: [
</a><a href="#h63-3-5" id="h63-3-5" class="i">+        Some(
</a><a href="#h63-3-6" id="h63-3-6" class="i">+            (
</a><a href="#h63-3-7" id="h63-3-7" class="i">+                Some(
</a><a href="#h63-3-8" id="h63-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-3-9" id="h63-3-9" class="i">+                ),
</a><a href="#h63-3-10" id="h63-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h63-3-11" id="h63-3-11" class="i">+            ),
</a><a href="#h63-3-12" id="h63-3-12" class="i">+        ),
</a><a href="#h63-3-13" id="h63-3-13" class="i">+        Some(
</a><a href="#h63-3-14" id="h63-3-14" class="i">+            (
</a><a href="#h63-3-15" id="h63-3-15" class="i">+                Some(
</a><a href="#h63-3-16" id="h63-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-3-17" id="h63-3-17" class="i">+                ),
</a><a href="#h63-3-18" id="h63-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h63-3-19" id="h63-3-19" class="i">+            ),
</a><a href="#h63-3-20" id="h63-3-20" class="i">+        ),
</a><a href="#h63-3-21" id="h63-3-21" class="i">+        Some(
</a><a href="#h63-3-22" id="h63-3-22" class="i">+            (
</a><a href="#h63-3-23" id="h63-3-23" class="i">+                Some(
</a><a href="#h63-3-24" id="h63-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-3-25" id="h63-3-25" class="i">+                ),
</a><a href="#h63-3-26" id="h63-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h63-3-27" id="h63-3-27" class="i">+            ),
</a><a href="#h63-3-28" id="h63-3-28" class="i">+        ),
</a><a href="#h63-3-29" id="h63-3-29" class="i">+        Some(
</a><a href="#h63-3-30" id="h63-3-30" class="i">+            (
</a><a href="#h63-3-31" id="h63-3-31" class="i">+                Some(
</a><a href="#h63-3-32" id="h63-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-3-33" id="h63-3-33" class="i">+                ),
</a><a href="#h63-3-34" id="h63-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h63-3-35" id="h63-3-35" class="i">+            ),
</a><a href="#h63-3-36" id="h63-3-36" class="i">+        ),
</a><a href="#h63-3-37" id="h63-3-37" class="i">+        Some(
</a><a href="#h63-3-38" id="h63-3-38" class="i">+            (
</a><a href="#h63-3-39" id="h63-3-39" class="i">+                Some(
</a><a href="#h63-3-40" id="h63-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-3-41" id="h63-3-41" class="i">+                ),
</a><a href="#h63-3-42" id="h63-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h63-3-43" id="h63-3-43" class="i">+            ),
</a><a href="#h63-3-44" id="h63-3-44" class="i">+        ),
</a><a href="#h63-3-45" id="h63-3-45" class="i">+        Some(
</a><a href="#h63-3-46" id="h63-3-46" class="i">+            (
</a><a href="#h63-3-47" id="h63-3-47" class="i">+                Some(
</a><a href="#h63-3-48" id="h63-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-3-49" id="h63-3-49" class="i">+                ),
</a><a href="#h63-3-50" id="h63-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h63-3-51" id="h63-3-51" class="i">+            ),
</a><a href="#h63-3-52" id="h63-3-52" class="i">+        ),
</a><a href="#h63-3-53" id="h63-3-53" class="i">+        Some(
</a><a href="#h63-3-54" id="h63-3-54" class="i">+            (
</a><a href="#h63-3-55" id="h63-3-55" class="i">+                Some(
</a><a href="#h63-3-56" id="h63-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-3-57" id="h63-3-57" class="i">+                ),
</a><a href="#h63-3-58" id="h63-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h63-3-59" id="h63-3-59" class="i">+            ),
</a><a href="#h63-3-60" id="h63-3-60" class="i">+        ),
</a><a href="#h63-3-61" id="h63-3-61" class="i">+        Some(
</a><a href="#h63-3-62" id="h63-3-62" class="i">+            (
</a><a href="#h63-3-63" id="h63-3-63" class="i">+                Some(
</a><a href="#h63-3-64" id="h63-3-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h63-3-65" id="h63-3-65" class="i">+                ),
</a><a href="#h63-3-66" id="h63-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h63-3-67" id="h63-3-67" class="i">+            ),
</a><a href="#h63-3-68" id="h63-3-68" class="i">+        ),
</a><a href="#h63-3-69" id="h63-3-69" class="i">+        Some(
</a><a href="#h63-3-70" id="h63-3-70" class="i">+            (
</a><a href="#h63-3-71" id="h63-3-71" class="i">+                Some(
</a><a href="#h63-3-72" id="h63-3-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h63-3-73" id="h63-3-73" class="i">+                ),
</a><a href="#h63-3-74" id="h63-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h63-3-75" id="h63-3-75" class="i">+            ),
</a><a href="#h63-3-76" id="h63-3-76" class="i">+        ),
</a><a href="#h63-3-77" id="h63-3-77" class="i">+    ],
</a><a href="#h63-3-78" id="h63-3-78" class="i">+}
</a> 
<a href="#h63-3-80" id="h63-3-80" class="d">-Optimized plan: Select(
</a><a href="#h63-3-81" id="h63-3-81" class="d">-    HashJoin {
</a><a href="#h63-3-82" id="h63-3-82" class="i">+Optimized plan: Select {
</a><a href="#h63-3-83" id="h63-3-83" class="i">+    root: HashJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h63-4" id="h63-4" class="h">@@ -334,7 +408,6 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h63-4-3" id="h63-4-3" class="d">-            alias: None,
</a>             filter: Some(
                 Or(
                     GreaterThan(
<a href="#h63-5" id="h63-5" class="h">@@ -375,6 +448,7 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ),
<a href="#h63-5-3" id="h63-5-3" class="i">+            alias: None,
</a>         },
         left_field: (
             3,
<a href="#h63-6" id="h63-6" class="h">@@ -412,8 +486,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h63-6-3" id="h63-6-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h63-6-5" id="h63-6-5" class="i">+            alias: None,
</a>         },
         right_field: (
             0,
<a href="#h63-7" id="h63-7" class="h">@@ -428,5 +502,79 @@ Optimized plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h63-7-3" id="h63-7-3" class="d">-)
</a><a href="#h63-7-4" id="h63-7-4" class="i">+    labels: [
</a><a href="#h63-7-5" id="h63-7-5" class="i">+        Some(
</a><a href="#h63-7-6" id="h63-7-6" class="i">+            (
</a><a href="#h63-7-7" id="h63-7-7" class="i">+                Some(
</a><a href="#h63-7-8" id="h63-7-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-7-9" id="h63-7-9" class="i">+                ),
</a><a href="#h63-7-10" id="h63-7-10" class="i">+                &quot;id&quot;,
</a><a href="#h63-7-11" id="h63-7-11" class="i">+            ),
</a><a href="#h63-7-12" id="h63-7-12" class="i">+        ),
</a><a href="#h63-7-13" id="h63-7-13" class="i">+        Some(
</a><a href="#h63-7-14" id="h63-7-14" class="i">+            (
</a><a href="#h63-7-15" id="h63-7-15" class="i">+                Some(
</a><a href="#h63-7-16" id="h63-7-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-7-17" id="h63-7-17" class="i">+                ),
</a><a href="#h63-7-18" id="h63-7-18" class="i">+                &quot;title&quot;,
</a><a href="#h63-7-19" id="h63-7-19" class="i">+            ),
</a><a href="#h63-7-20" id="h63-7-20" class="i">+        ),
</a><a href="#h63-7-21" id="h63-7-21" class="i">+        Some(
</a><a href="#h63-7-22" id="h63-7-22" class="i">+            (
</a><a href="#h63-7-23" id="h63-7-23" class="i">+                Some(
</a><a href="#h63-7-24" id="h63-7-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-7-25" id="h63-7-25" class="i">+                ),
</a><a href="#h63-7-26" id="h63-7-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h63-7-27" id="h63-7-27" class="i">+            ),
</a><a href="#h63-7-28" id="h63-7-28" class="i">+        ),
</a><a href="#h63-7-29" id="h63-7-29" class="i">+        Some(
</a><a href="#h63-7-30" id="h63-7-30" class="i">+            (
</a><a href="#h63-7-31" id="h63-7-31" class="i">+                Some(
</a><a href="#h63-7-32" id="h63-7-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-7-33" id="h63-7-33" class="i">+                ),
</a><a href="#h63-7-34" id="h63-7-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h63-7-35" id="h63-7-35" class="i">+            ),
</a><a href="#h63-7-36" id="h63-7-36" class="i">+        ),
</a><a href="#h63-7-37" id="h63-7-37" class="i">+        Some(
</a><a href="#h63-7-38" id="h63-7-38" class="i">+            (
</a><a href="#h63-7-39" id="h63-7-39" class="i">+                Some(
</a><a href="#h63-7-40" id="h63-7-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-7-41" id="h63-7-41" class="i">+                ),
</a><a href="#h63-7-42" id="h63-7-42" class="i">+                &quot;released&quot;,
</a><a href="#h63-7-43" id="h63-7-43" class="i">+            ),
</a><a href="#h63-7-44" id="h63-7-44" class="i">+        ),
</a><a href="#h63-7-45" id="h63-7-45" class="i">+        Some(
</a><a href="#h63-7-46" id="h63-7-46" class="i">+            (
</a><a href="#h63-7-47" id="h63-7-47" class="i">+                Some(
</a><a href="#h63-7-48" id="h63-7-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-7-49" id="h63-7-49" class="i">+                ),
</a><a href="#h63-7-50" id="h63-7-50" class="i">+                &quot;rating&quot;,
</a><a href="#h63-7-51" id="h63-7-51" class="i">+            ),
</a><a href="#h63-7-52" id="h63-7-52" class="i">+        ),
</a><a href="#h63-7-53" id="h63-7-53" class="i">+        Some(
</a><a href="#h63-7-54" id="h63-7-54" class="i">+            (
</a><a href="#h63-7-55" id="h63-7-55" class="i">+                Some(
</a><a href="#h63-7-56" id="h63-7-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h63-7-57" id="h63-7-57" class="i">+                ),
</a><a href="#h63-7-58" id="h63-7-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h63-7-59" id="h63-7-59" class="i">+            ),
</a><a href="#h63-7-60" id="h63-7-60" class="i">+        ),
</a><a href="#h63-7-61" id="h63-7-61" class="i">+        Some(
</a><a href="#h63-7-62" id="h63-7-62" class="i">+            (
</a><a href="#h63-7-63" id="h63-7-63" class="i">+                Some(
</a><a href="#h63-7-64" id="h63-7-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h63-7-65" id="h63-7-65" class="i">+                ),
</a><a href="#h63-7-66" id="h63-7-66" class="i">+                &quot;id&quot;,
</a><a href="#h63-7-67" id="h63-7-67" class="i">+            ),
</a><a href="#h63-7-68" id="h63-7-68" class="i">+        ),
</a><a href="#h63-7-69" id="h63-7-69" class="i">+        Some(
</a><a href="#h63-7-70" id="h63-7-70" class="i">+            (
</a><a href="#h63-7-71" id="h63-7-71" class="i">+                Some(
</a><a href="#h63-7-72" id="h63-7-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h63-7-73" id="h63-7-73" class="i">+                ),
</a><a href="#h63-7-74" id="h63-7-74" class="i">+                &quot;name&quot;,
</a><a href="#h63-7-75" id="h63-7-75" class="i">+            ),
</a><a href="#h63-7-76" id="h63-7-76" class="i">+        ),
</a><a href="#h63-7-77" id="h63-7-77" class="i">+    ],
</a><a href="#h63-7-78" id="h63-7-78" class="i">+}
</a> 
<b>diff --git a/<a id="h64" href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a> b/<a href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -86,8 +86,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h64-0-3" id="h64-0-3" class="d">-Plan: Select(
</a><a href="#h64-0-4" id="h64-0-4" class="d">-    Projection {
</a><a href="#h64-0-5" id="h64-0-5" class="i">+Plan: Select {
</a><a href="#h64-0-6" id="h64-0-6" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h64-1" id="h64-1" class="h">@@ -167,10 +167,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h64-1-3" id="h64-1-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h64-1-7" id="h64-1-7" class="d">-                filter: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h64-2" id="h64-2" class="h">@@ -198,10 +198,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h64-2-3" id="h64-2-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h64-2-7" id="h64-2-7" class="d">-                filter: None,
</a>             },
             predicate: Some(
                 Equal(
<a href="#h64-3" id="h64-3" class="h">@@ -231,20 +231,6 @@ Plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h64-3-3" id="h64-3-3" class="d">-        labels: [
</a><a href="#h64-3-4" id="h64-3-4" class="d">-            Some(
</a><a href="#h64-3-5" id="h64-3-5" class="d">-                (
</a><a href="#h64-3-6" id="h64-3-6" class="d">-                    None,
</a><a href="#h64-3-7" id="h64-3-7" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h64-3-8" id="h64-3-8" class="d">-                ),
</a><a href="#h64-3-9" id="h64-3-9" class="d">-            ),
</a><a href="#h64-3-10" id="h64-3-10" class="d">-            Some(
</a><a href="#h64-3-11" id="h64-3-11" class="d">-                (
</a><a href="#h64-3-12" id="h64-3-12" class="d">-                    None,
</a><a href="#h64-3-13" id="h64-3-13" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h64-3-14" id="h64-3-14" class="d">-                ),
</a><a href="#h64-3-15" id="h64-3-15" class="d">-            ),
</a><a href="#h64-3-16" id="h64-3-16" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h64-4" id="h64-4" class="h">@@ -269,11 +255,39 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h64-4-3" id="h64-4-3" class="i">+        labels: [
</a><a href="#h64-4-4" id="h64-4-4" class="i">+            Some(
</a><a href="#h64-4-5" id="h64-4-5" class="i">+                (
</a><a href="#h64-4-6" id="h64-4-6" class="i">+                    None,
</a><a href="#h64-4-7" id="h64-4-7" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h64-4-8" id="h64-4-8" class="i">+                ),
</a><a href="#h64-4-9" id="h64-4-9" class="i">+            ),
</a><a href="#h64-4-10" id="h64-4-10" class="i">+            Some(
</a><a href="#h64-4-11" id="h64-4-11" class="i">+                (
</a><a href="#h64-4-12" id="h64-4-12" class="i">+                    None,
</a><a href="#h64-4-13" id="h64-4-13" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h64-4-14" id="h64-4-14" class="i">+                ),
</a><a href="#h64-4-15" id="h64-4-15" class="i">+            ),
</a><a href="#h64-4-16" id="h64-4-16" class="i">+        ],
</a>     },
<a href="#h64-4-18" id="h64-4-18" class="d">-)
</a><a href="#h64-4-19" id="h64-4-19" class="i">+    labels: [
</a><a href="#h64-4-20" id="h64-4-20" class="i">+        Some(
</a><a href="#h64-4-21" id="h64-4-21" class="i">+            (
</a><a href="#h64-4-22" id="h64-4-22" class="i">+                None,
</a><a href="#h64-4-23" id="h64-4-23" class="i">+                &quot;movie_id&quot;,
</a><a href="#h64-4-24" id="h64-4-24" class="i">+            ),
</a><a href="#h64-4-25" id="h64-4-25" class="i">+        ),
</a><a href="#h64-4-26" id="h64-4-26" class="i">+        Some(
</a><a href="#h64-4-27" id="h64-4-27" class="i">+            (
</a><a href="#h64-4-28" id="h64-4-28" class="i">+                None,
</a><a href="#h64-4-29" id="h64-4-29" class="i">+                &quot;genre_id&quot;,
</a><a href="#h64-4-30" id="h64-4-30" class="i">+            ),
</a><a href="#h64-4-31" id="h64-4-31" class="i">+        ),
</a><a href="#h64-4-32" id="h64-4-32" class="i">+    ],
</a><a href="#h64-4-33" id="h64-4-33" class="i">+}
</a> 
<a href="#h64-4-35" id="h64-4-35" class="d">-Optimized plan: Select(
</a><a href="#h64-4-36" id="h64-4-36" class="d">-    Projection {
</a><a href="#h64-4-37" id="h64-4-37" class="i">+Optimized plan: Select {
</a><a href="#h64-4-38" id="h64-4-38" class="i">+    root: Projection {
</a>         source: HashJoin {
             left: Scan {
                 table: Table {
<a href="#h64-5" id="h64-5" class="h">@@ -353,10 +367,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h64-5-3" id="h64-5-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h64-5-7" id="h64-5-7" class="d">-                filter: None,
</a>             },
             left_field: (
                 0,
<a href="#h64-6" id="h64-6" class="h">@@ -394,10 +408,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h64-6-3" id="h64-6-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h64-6-7" id="h64-6-7" class="d">-                filter: None,
</a>             },
             right_field: (
                 0,
<a href="#h64-7" id="h64-7" class="h">@@ -412,20 +426,6 @@ Optimized plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h64-7-3" id="h64-7-3" class="d">-        labels: [
</a><a href="#h64-7-4" id="h64-7-4" class="d">-            Some(
</a><a href="#h64-7-5" id="h64-7-5" class="d">-                (
</a><a href="#h64-7-6" id="h64-7-6" class="d">-                    None,
</a><a href="#h64-7-7" id="h64-7-7" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h64-7-8" id="h64-7-8" class="d">-                ),
</a><a href="#h64-7-9" id="h64-7-9" class="d">-            ),
</a><a href="#h64-7-10" id="h64-7-10" class="d">-            Some(
</a><a href="#h64-7-11" id="h64-7-11" class="d">-                (
</a><a href="#h64-7-12" id="h64-7-12" class="d">-                    None,
</a><a href="#h64-7-13" id="h64-7-13" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h64-7-14" id="h64-7-14" class="d">-                ),
</a><a href="#h64-7-15" id="h64-7-15" class="d">-            ),
</a><a href="#h64-7-16" id="h64-7-16" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h64-8" id="h64-8" class="h">@@ -450,6 +450,34 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h64-8-3" id="h64-8-3" class="i">+        labels: [
</a><a href="#h64-8-4" id="h64-8-4" class="i">+            Some(
</a><a href="#h64-8-5" id="h64-8-5" class="i">+                (
</a><a href="#h64-8-6" id="h64-8-6" class="i">+                    None,
</a><a href="#h64-8-7" id="h64-8-7" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h64-8-8" id="h64-8-8" class="i">+                ),
</a><a href="#h64-8-9" id="h64-8-9" class="i">+            ),
</a><a href="#h64-8-10" id="h64-8-10" class="i">+            Some(
</a><a href="#h64-8-11" id="h64-8-11" class="i">+                (
</a><a href="#h64-8-12" id="h64-8-12" class="i">+                    None,
</a><a href="#h64-8-13" id="h64-8-13" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h64-8-14" id="h64-8-14" class="i">+                ),
</a><a href="#h64-8-15" id="h64-8-15" class="i">+            ),
</a><a href="#h64-8-16" id="h64-8-16" class="i">+        ],
</a>     },
<a href="#h64-8-18" id="h64-8-18" class="d">-)
</a><a href="#h64-8-19" id="h64-8-19" class="i">+    labels: [
</a><a href="#h64-8-20" id="h64-8-20" class="i">+        Some(
</a><a href="#h64-8-21" id="h64-8-21" class="i">+            (
</a><a href="#h64-8-22" id="h64-8-22" class="i">+                None,
</a><a href="#h64-8-23" id="h64-8-23" class="i">+                &quot;movie_id&quot;,
</a><a href="#h64-8-24" id="h64-8-24" class="i">+            ),
</a><a href="#h64-8-25" id="h64-8-25" class="i">+        ),
</a><a href="#h64-8-26" id="h64-8-26" class="i">+        Some(
</a><a href="#h64-8-27" id="h64-8-27" class="i">+            (
</a><a href="#h64-8-28" id="h64-8-28" class="i">+                None,
</a><a href="#h64-8-29" id="h64-8-29" class="i">+                &quot;genre_id&quot;,
</a><a href="#h64-8-30" id="h64-8-30" class="i">+            ),
</a><a href="#h64-8-31" id="h64-8-31" class="i">+        ),
</a><a href="#h64-8-32" id="h64-8-32" class="i">+    ],
</a><a href="#h64-8-33" id="h64-8-33" class="i">+}
</a> 
<b>diff --git a/<a id="h65" href="../file/tests/sql/query/join_left_all.html">tests/sql/query/join_left_all</a> b/<a href="../file/tests/sql/query/join_left_all.html">tests/sql/query/join_left_all</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -62,8 +62,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h65-0-3" id="h65-0-3" class="d">-Plan: Select(
</a><a href="#h65-0-4" id="h65-0-4" class="d">-    NestedLoopJoin {
</a><a href="#h65-0-5" id="h65-0-5" class="i">+Plan: Select {
</a><a href="#h65-0-6" id="h65-0-6" class="i">+    root: NestedLoopJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h65-1" id="h65-1" class="h">@@ -142,10 +142,10 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h65-1-3" id="h65-1-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h65-1-7" id="h65-1-7" class="d">-            filter: None,
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h65-2" id="h65-2" class="h">@@ -173,10 +173,10 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h65-2-3" id="h65-2-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<a href="#h65-2-7" id="h65-2-7" class="d">-            filter: None,
</a>         },
         predicate: Some(
             Equal(
<a href="#h65-3" id="h65-3" class="h">@@ -206,10 +206,84 @@ Plan: Select(
</a>         ),
         outer: true,
     },
<a href="#h65-3-3" id="h65-3-3" class="d">-)
</a><a href="#h65-3-4" id="h65-3-4" class="i">+    labels: [
</a><a href="#h65-3-5" id="h65-3-5" class="i">+        Some(
</a><a href="#h65-3-6" id="h65-3-6" class="i">+            (
</a><a href="#h65-3-7" id="h65-3-7" class="i">+                Some(
</a><a href="#h65-3-8" id="h65-3-8" class="i">+                    &quot;m&quot;,
</a><a href="#h65-3-9" id="h65-3-9" class="i">+                ),
</a><a href="#h65-3-10" id="h65-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h65-3-11" id="h65-3-11" class="i">+            ),
</a><a href="#h65-3-12" id="h65-3-12" class="i">+        ),
</a><a href="#h65-3-13" id="h65-3-13" class="i">+        Some(
</a><a href="#h65-3-14" id="h65-3-14" class="i">+            (
</a><a href="#h65-3-15" id="h65-3-15" class="i">+                Some(
</a><a href="#h65-3-16" id="h65-3-16" class="i">+                    &quot;m&quot;,
</a><a href="#h65-3-17" id="h65-3-17" class="i">+                ),
</a><a href="#h65-3-18" id="h65-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h65-3-19" id="h65-3-19" class="i">+            ),
</a><a href="#h65-3-20" id="h65-3-20" class="i">+        ),
</a><a href="#h65-3-21" id="h65-3-21" class="i">+        Some(
</a><a href="#h65-3-22" id="h65-3-22" class="i">+            (
</a><a href="#h65-3-23" id="h65-3-23" class="i">+                Some(
</a><a href="#h65-3-24" id="h65-3-24" class="i">+                    &quot;m&quot;,
</a><a href="#h65-3-25" id="h65-3-25" class="i">+                ),
</a><a href="#h65-3-26" id="h65-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h65-3-27" id="h65-3-27" class="i">+            ),
</a><a href="#h65-3-28" id="h65-3-28" class="i">+        ),
</a><a href="#h65-3-29" id="h65-3-29" class="i">+        Some(
</a><a href="#h65-3-30" id="h65-3-30" class="i">+            (
</a><a href="#h65-3-31" id="h65-3-31" class="i">+                Some(
</a><a href="#h65-3-32" id="h65-3-32" class="i">+                    &quot;m&quot;,
</a><a href="#h65-3-33" id="h65-3-33" class="i">+                ),
</a><a href="#h65-3-34" id="h65-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h65-3-35" id="h65-3-35" class="i">+            ),
</a><a href="#h65-3-36" id="h65-3-36" class="i">+        ),
</a><a href="#h65-3-37" id="h65-3-37" class="i">+        Some(
</a><a href="#h65-3-38" id="h65-3-38" class="i">+            (
</a><a href="#h65-3-39" id="h65-3-39" class="i">+                Some(
</a><a href="#h65-3-40" id="h65-3-40" class="i">+                    &quot;m&quot;,
</a><a href="#h65-3-41" id="h65-3-41" class="i">+                ),
</a><a href="#h65-3-42" id="h65-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h65-3-43" id="h65-3-43" class="i">+            ),
</a><a href="#h65-3-44" id="h65-3-44" class="i">+        ),
</a><a href="#h65-3-45" id="h65-3-45" class="i">+        Some(
</a><a href="#h65-3-46" id="h65-3-46" class="i">+            (
</a><a href="#h65-3-47" id="h65-3-47" class="i">+                Some(
</a><a href="#h65-3-48" id="h65-3-48" class="i">+                    &quot;m&quot;,
</a><a href="#h65-3-49" id="h65-3-49" class="i">+                ),
</a><a href="#h65-3-50" id="h65-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h65-3-51" id="h65-3-51" class="i">+            ),
</a><a href="#h65-3-52" id="h65-3-52" class="i">+        ),
</a><a href="#h65-3-53" id="h65-3-53" class="i">+        Some(
</a><a href="#h65-3-54" id="h65-3-54" class="i">+            (
</a><a href="#h65-3-55" id="h65-3-55" class="i">+                Some(
</a><a href="#h65-3-56" id="h65-3-56" class="i">+                    &quot;m&quot;,
</a><a href="#h65-3-57" id="h65-3-57" class="i">+                ),
</a><a href="#h65-3-58" id="h65-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h65-3-59" id="h65-3-59" class="i">+            ),
</a><a href="#h65-3-60" id="h65-3-60" class="i">+        ),
</a><a href="#h65-3-61" id="h65-3-61" class="i">+        Some(
</a><a href="#h65-3-62" id="h65-3-62" class="i">+            (
</a><a href="#h65-3-63" id="h65-3-63" class="i">+                Some(
</a><a href="#h65-3-64" id="h65-3-64" class="i">+                    &quot;g&quot;,
</a><a href="#h65-3-65" id="h65-3-65" class="i">+                ),
</a><a href="#h65-3-66" id="h65-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h65-3-67" id="h65-3-67" class="i">+            ),
</a><a href="#h65-3-68" id="h65-3-68" class="i">+        ),
</a><a href="#h65-3-69" id="h65-3-69" class="i">+        Some(
</a><a href="#h65-3-70" id="h65-3-70" class="i">+            (
</a><a href="#h65-3-71" id="h65-3-71" class="i">+                Some(
</a><a href="#h65-3-72" id="h65-3-72" class="i">+                    &quot;g&quot;,
</a><a href="#h65-3-73" id="h65-3-73" class="i">+                ),
</a><a href="#h65-3-74" id="h65-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h65-3-75" id="h65-3-75" class="i">+            ),
</a><a href="#h65-3-76" id="h65-3-76" class="i">+        ),
</a><a href="#h65-3-77" id="h65-3-77" class="i">+    ],
</a><a href="#h65-3-78" id="h65-3-78" class="i">+}
</a> 
<a href="#h65-3-80" id="h65-3-80" class="d">-Optimized plan: Select(
</a><a href="#h65-3-81" id="h65-3-81" class="d">-    HashJoin {
</a><a href="#h65-3-82" id="h65-3-82" class="i">+Optimized plan: Select {
</a><a href="#h65-3-83" id="h65-3-83" class="i">+    root: HashJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h65-4" id="h65-4" class="h">@@ -288,10 +362,10 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h65-4-3" id="h65-4-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h65-4-7" id="h65-4-7" class="d">-            filter: None,
</a>         },
         left_field: (
             0,
<a href="#h65-5" id="h65-5" class="h">@@ -329,10 +403,10 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h65-5-3" id="h65-5-3" class="i">+            filter: None,
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<a href="#h65-5-7" id="h65-5-7" class="d">-            filter: None,
</a>         },
         right_field: (
             0,
<a href="#h65-6" id="h65-6" class="h">@@ -347,5 +421,79 @@ Optimized plan: Select(
</a>         ),
         outer: true,
     },
<a href="#h65-6-3" id="h65-6-3" class="d">-)
</a><a href="#h65-6-4" id="h65-6-4" class="i">+    labels: [
</a><a href="#h65-6-5" id="h65-6-5" class="i">+        Some(
</a><a href="#h65-6-6" id="h65-6-6" class="i">+            (
</a><a href="#h65-6-7" id="h65-6-7" class="i">+                Some(
</a><a href="#h65-6-8" id="h65-6-8" class="i">+                    &quot;m&quot;,
</a><a href="#h65-6-9" id="h65-6-9" class="i">+                ),
</a><a href="#h65-6-10" id="h65-6-10" class="i">+                &quot;id&quot;,
</a><a href="#h65-6-11" id="h65-6-11" class="i">+            ),
</a><a href="#h65-6-12" id="h65-6-12" class="i">+        ),
</a><a href="#h65-6-13" id="h65-6-13" class="i">+        Some(
</a><a href="#h65-6-14" id="h65-6-14" class="i">+            (
</a><a href="#h65-6-15" id="h65-6-15" class="i">+                Some(
</a><a href="#h65-6-16" id="h65-6-16" class="i">+                    &quot;m&quot;,
</a><a href="#h65-6-17" id="h65-6-17" class="i">+                ),
</a><a href="#h65-6-18" id="h65-6-18" class="i">+                &quot;title&quot;,
</a><a href="#h65-6-19" id="h65-6-19" class="i">+            ),
</a><a href="#h65-6-20" id="h65-6-20" class="i">+        ),
</a><a href="#h65-6-21" id="h65-6-21" class="i">+        Some(
</a><a href="#h65-6-22" id="h65-6-22" class="i">+            (
</a><a href="#h65-6-23" id="h65-6-23" class="i">+                Some(
</a><a href="#h65-6-24" id="h65-6-24" class="i">+                    &quot;m&quot;,
</a><a href="#h65-6-25" id="h65-6-25" class="i">+                ),
</a><a href="#h65-6-26" id="h65-6-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h65-6-27" id="h65-6-27" class="i">+            ),
</a><a href="#h65-6-28" id="h65-6-28" class="i">+        ),
</a><a href="#h65-6-29" id="h65-6-29" class="i">+        Some(
</a><a href="#h65-6-30" id="h65-6-30" class="i">+            (
</a><a href="#h65-6-31" id="h65-6-31" class="i">+                Some(
</a><a href="#h65-6-32" id="h65-6-32" class="i">+                    &quot;m&quot;,
</a><a href="#h65-6-33" id="h65-6-33" class="i">+                ),
</a><a href="#h65-6-34" id="h65-6-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h65-6-35" id="h65-6-35" class="i">+            ),
</a><a href="#h65-6-36" id="h65-6-36" class="i">+        ),
</a><a href="#h65-6-37" id="h65-6-37" class="i">+        Some(
</a><a href="#h65-6-38" id="h65-6-38" class="i">+            (
</a><a href="#h65-6-39" id="h65-6-39" class="i">+                Some(
</a><a href="#h65-6-40" id="h65-6-40" class="i">+                    &quot;m&quot;,
</a><a href="#h65-6-41" id="h65-6-41" class="i">+                ),
</a><a href="#h65-6-42" id="h65-6-42" class="i">+                &quot;released&quot;,
</a><a href="#h65-6-43" id="h65-6-43" class="i">+            ),
</a><a href="#h65-6-44" id="h65-6-44" class="i">+        ),
</a><a href="#h65-6-45" id="h65-6-45" class="i">+        Some(
</a><a href="#h65-6-46" id="h65-6-46" class="i">+            (
</a><a href="#h65-6-47" id="h65-6-47" class="i">+                Some(
</a><a href="#h65-6-48" id="h65-6-48" class="i">+                    &quot;m&quot;,
</a><a href="#h65-6-49" id="h65-6-49" class="i">+                ),
</a><a href="#h65-6-50" id="h65-6-50" class="i">+                &quot;rating&quot;,
</a><a href="#h65-6-51" id="h65-6-51" class="i">+            ),
</a><a href="#h65-6-52" id="h65-6-52" class="i">+        ),
</a><a href="#h65-6-53" id="h65-6-53" class="i">+        Some(
</a><a href="#h65-6-54" id="h65-6-54" class="i">+            (
</a><a href="#h65-6-55" id="h65-6-55" class="i">+                Some(
</a><a href="#h65-6-56" id="h65-6-56" class="i">+                    &quot;m&quot;,
</a><a href="#h65-6-57" id="h65-6-57" class="i">+                ),
</a><a href="#h65-6-58" id="h65-6-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h65-6-59" id="h65-6-59" class="i">+            ),
</a><a href="#h65-6-60" id="h65-6-60" class="i">+        ),
</a><a href="#h65-6-61" id="h65-6-61" class="i">+        Some(
</a><a href="#h65-6-62" id="h65-6-62" class="i">+            (
</a><a href="#h65-6-63" id="h65-6-63" class="i">+                Some(
</a><a href="#h65-6-64" id="h65-6-64" class="i">+                    &quot;g&quot;,
</a><a href="#h65-6-65" id="h65-6-65" class="i">+                ),
</a><a href="#h65-6-66" id="h65-6-66" class="i">+                &quot;id&quot;,
</a><a href="#h65-6-67" id="h65-6-67" class="i">+            ),
</a><a href="#h65-6-68" id="h65-6-68" class="i">+        ),
</a><a href="#h65-6-69" id="h65-6-69" class="i">+        Some(
</a><a href="#h65-6-70" id="h65-6-70" class="i">+            (
</a><a href="#h65-6-71" id="h65-6-71" class="i">+                Some(
</a><a href="#h65-6-72" id="h65-6-72" class="i">+                    &quot;g&quot;,
</a><a href="#h65-6-73" id="h65-6-73" class="i">+                ),
</a><a href="#h65-6-74" id="h65-6-74" class="i">+                &quot;name&quot;,
</a><a href="#h65-6-75" id="h65-6-75" class="i">+            ),
</a><a href="#h65-6-76" id="h65-6-76" class="i">+        ),
</a><a href="#h65-6-77" id="h65-6-77" class="i">+    ],
</a><a href="#h65-6-78" id="h65-6-78" class="i">+}
</a> 
<b>diff --git a/<a id="h66" href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a> b/<a href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -86,8 +86,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h66-0-3" id="h66-0-3" class="d">-Plan: Select(
</a><a href="#h66-0-4" id="h66-0-4" class="d">-    Projection {
</a><a href="#h66-0-5" id="h66-0-5" class="i">+Plan: Select {
</a><a href="#h66-0-6" id="h66-0-6" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h66-1" id="h66-1" class="h">@@ -167,10 +167,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h66-1-3" id="h66-1-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h66-1-7" id="h66-1-7" class="d">-                filter: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h66-2" id="h66-2" class="h">@@ -198,10 +198,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h66-2-3" id="h66-2-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h66-2-7" id="h66-2-7" class="d">-                filter: None,
</a>             },
             predicate: Some(
                 Equal(
<a href="#h66-3" id="h66-3" class="h">@@ -231,20 +231,6 @@ Plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h66-3-3" id="h66-3-3" class="d">-        labels: [
</a><a href="#h66-3-4" id="h66-3-4" class="d">-            Some(
</a><a href="#h66-3-5" id="h66-3-5" class="d">-                (
</a><a href="#h66-3-6" id="h66-3-6" class="d">-                    None,
</a><a href="#h66-3-7" id="h66-3-7" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h66-3-8" id="h66-3-8" class="d">-                ),
</a><a href="#h66-3-9" id="h66-3-9" class="d">-            ),
</a><a href="#h66-3-10" id="h66-3-10" class="d">-            Some(
</a><a href="#h66-3-11" id="h66-3-11" class="d">-                (
</a><a href="#h66-3-12" id="h66-3-12" class="d">-                    None,
</a><a href="#h66-3-13" id="h66-3-13" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h66-3-14" id="h66-3-14" class="d">-                ),
</a><a href="#h66-3-15" id="h66-3-15" class="d">-            ),
</a><a href="#h66-3-16" id="h66-3-16" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h66-4" id="h66-4" class="h">@@ -269,11 +255,39 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h66-4-3" id="h66-4-3" class="i">+        labels: [
</a><a href="#h66-4-4" id="h66-4-4" class="i">+            Some(
</a><a href="#h66-4-5" id="h66-4-5" class="i">+                (
</a><a href="#h66-4-6" id="h66-4-6" class="i">+                    None,
</a><a href="#h66-4-7" id="h66-4-7" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h66-4-8" id="h66-4-8" class="i">+                ),
</a><a href="#h66-4-9" id="h66-4-9" class="i">+            ),
</a><a href="#h66-4-10" id="h66-4-10" class="i">+            Some(
</a><a href="#h66-4-11" id="h66-4-11" class="i">+                (
</a><a href="#h66-4-12" id="h66-4-12" class="i">+                    None,
</a><a href="#h66-4-13" id="h66-4-13" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h66-4-14" id="h66-4-14" class="i">+                ),
</a><a href="#h66-4-15" id="h66-4-15" class="i">+            ),
</a><a href="#h66-4-16" id="h66-4-16" class="i">+        ],
</a>     },
<a href="#h66-4-18" id="h66-4-18" class="d">-)
</a><a href="#h66-4-19" id="h66-4-19" class="i">+    labels: [
</a><a href="#h66-4-20" id="h66-4-20" class="i">+        Some(
</a><a href="#h66-4-21" id="h66-4-21" class="i">+            (
</a><a href="#h66-4-22" id="h66-4-22" class="i">+                None,
</a><a href="#h66-4-23" id="h66-4-23" class="i">+                &quot;movie_id&quot;,
</a><a href="#h66-4-24" id="h66-4-24" class="i">+            ),
</a><a href="#h66-4-25" id="h66-4-25" class="i">+        ),
</a><a href="#h66-4-26" id="h66-4-26" class="i">+        Some(
</a><a href="#h66-4-27" id="h66-4-27" class="i">+            (
</a><a href="#h66-4-28" id="h66-4-28" class="i">+                None,
</a><a href="#h66-4-29" id="h66-4-29" class="i">+                &quot;genre_id&quot;,
</a><a href="#h66-4-30" id="h66-4-30" class="i">+            ),
</a><a href="#h66-4-31" id="h66-4-31" class="i">+        ),
</a><a href="#h66-4-32" id="h66-4-32" class="i">+    ],
</a><a href="#h66-4-33" id="h66-4-33" class="i">+}
</a> 
<a href="#h66-4-35" id="h66-4-35" class="d">-Optimized plan: Select(
</a><a href="#h66-4-36" id="h66-4-36" class="d">-    Projection {
</a><a href="#h66-4-37" id="h66-4-37" class="i">+Optimized plan: Select {
</a><a href="#h66-4-38" id="h66-4-38" class="i">+    root: Projection {
</a>         source: HashJoin {
             left: Scan {
                 table: Table {
<a href="#h66-5" id="h66-5" class="h">@@ -353,10 +367,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h66-5-3" id="h66-5-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h66-5-7" id="h66-5-7" class="d">-                filter: None,
</a>             },
             left_field: (
                 0,
<a href="#h66-6" id="h66-6" class="h">@@ -394,10 +408,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h66-6-3" id="h66-6-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h66-6-7" id="h66-6-7" class="d">-                filter: None,
</a>             },
             right_field: (
                 0,
<a href="#h66-7" id="h66-7" class="h">@@ -412,20 +426,6 @@ Optimized plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h66-7-3" id="h66-7-3" class="d">-        labels: [
</a><a href="#h66-7-4" id="h66-7-4" class="d">-            Some(
</a><a href="#h66-7-5" id="h66-7-5" class="d">-                (
</a><a href="#h66-7-6" id="h66-7-6" class="d">-                    None,
</a><a href="#h66-7-7" id="h66-7-7" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h66-7-8" id="h66-7-8" class="d">-                ),
</a><a href="#h66-7-9" id="h66-7-9" class="d">-            ),
</a><a href="#h66-7-10" id="h66-7-10" class="d">-            Some(
</a><a href="#h66-7-11" id="h66-7-11" class="d">-                (
</a><a href="#h66-7-12" id="h66-7-12" class="d">-                    None,
</a><a href="#h66-7-13" id="h66-7-13" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h66-7-14" id="h66-7-14" class="d">-                ),
</a><a href="#h66-7-15" id="h66-7-15" class="d">-            ),
</a><a href="#h66-7-16" id="h66-7-16" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h66-8" id="h66-8" class="h">@@ -450,6 +450,34 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h66-8-3" id="h66-8-3" class="i">+        labels: [
</a><a href="#h66-8-4" id="h66-8-4" class="i">+            Some(
</a><a href="#h66-8-5" id="h66-8-5" class="i">+                (
</a><a href="#h66-8-6" id="h66-8-6" class="i">+                    None,
</a><a href="#h66-8-7" id="h66-8-7" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h66-8-8" id="h66-8-8" class="i">+                ),
</a><a href="#h66-8-9" id="h66-8-9" class="i">+            ),
</a><a href="#h66-8-10" id="h66-8-10" class="i">+            Some(
</a><a href="#h66-8-11" id="h66-8-11" class="i">+                (
</a><a href="#h66-8-12" id="h66-8-12" class="i">+                    None,
</a><a href="#h66-8-13" id="h66-8-13" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h66-8-14" id="h66-8-14" class="i">+                ),
</a><a href="#h66-8-15" id="h66-8-15" class="i">+            ),
</a><a href="#h66-8-16" id="h66-8-16" class="i">+        ],
</a>     },
<a href="#h66-8-18" id="h66-8-18" class="d">-)
</a><a href="#h66-8-19" id="h66-8-19" class="i">+    labels: [
</a><a href="#h66-8-20" id="h66-8-20" class="i">+        Some(
</a><a href="#h66-8-21" id="h66-8-21" class="i">+            (
</a><a href="#h66-8-22" id="h66-8-22" class="i">+                None,
</a><a href="#h66-8-23" id="h66-8-23" class="i">+                &quot;movie_id&quot;,
</a><a href="#h66-8-24" id="h66-8-24" class="i">+            ),
</a><a href="#h66-8-25" id="h66-8-25" class="i">+        ),
</a><a href="#h66-8-26" id="h66-8-26" class="i">+        Some(
</a><a href="#h66-8-27" id="h66-8-27" class="i">+            (
</a><a href="#h66-8-28" id="h66-8-28" class="i">+                None,
</a><a href="#h66-8-29" id="h66-8-29" class="i">+                &quot;genre_id&quot;,
</a><a href="#h66-8-30" id="h66-8-30" class="i">+            ),
</a><a href="#h66-8-31" id="h66-8-31" class="i">+        ),
</a><a href="#h66-8-32" id="h66-8-32" class="i">+    ],
</a><a href="#h66-8-33" id="h66-8-33" class="i">+}
</a> 
<b>diff --git a/<a id="h67" href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a> b/<a href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -79,8 +79,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h67-0-3" id="h67-0-3" class="d">-Plan: Select(
</a><a href="#h67-0-4" id="h67-0-4" class="d">-    Projection {
</a><a href="#h67-0-5" id="h67-0-5" class="i">+Plan: Select {
</a><a href="#h67-0-6" id="h67-0-6" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h67-1" id="h67-1" class="h">@@ -107,10 +107,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h67-1-3" id="h67-1-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h67-1-7" id="h67-1-7" class="d">-                filter: None,
</a>             },
             left_size: 2,
             right: Scan {
<a href="#h67-2" id="h67-2" class="h">@@ -191,10 +191,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h67-2-3" id="h67-2-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h67-2-7" id="h67-2-7" class="d">-                filter: None,
</a>             },
             predicate: Some(
                 Equal(
<a href="#h67-3" id="h67-3" class="h">@@ -224,20 +224,6 @@ Plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h67-3-3" id="h67-3-3" class="d">-        labels: [
</a><a href="#h67-3-4" id="h67-3-4" class="d">-            Some(
</a><a href="#h67-3-5" id="h67-3-5" class="d">-                (
</a><a href="#h67-3-6" id="h67-3-6" class="d">-                    None,
</a><a href="#h67-3-7" id="h67-3-7" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h67-3-8" id="h67-3-8" class="d">-                ),
</a><a href="#h67-3-9" id="h67-3-9" class="d">-            ),
</a><a href="#h67-3-10" id="h67-3-10" class="d">-            Some(
</a><a href="#h67-3-11" id="h67-3-11" class="d">-                (
</a><a href="#h67-3-12" id="h67-3-12" class="d">-                    None,
</a><a href="#h67-3-13" id="h67-3-13" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h67-3-14" id="h67-3-14" class="d">-                ),
</a><a href="#h67-3-15" id="h67-3-15" class="d">-            ),
</a><a href="#h67-3-16" id="h67-3-16" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h67-4" id="h67-4" class="h">@@ -262,11 +248,39 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h67-4-3" id="h67-4-3" class="i">+        labels: [
</a><a href="#h67-4-4" id="h67-4-4" class="i">+            Some(
</a><a href="#h67-4-5" id="h67-4-5" class="i">+                (
</a><a href="#h67-4-6" id="h67-4-6" class="i">+                    None,
</a><a href="#h67-4-7" id="h67-4-7" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h67-4-8" id="h67-4-8" class="i">+                ),
</a><a href="#h67-4-9" id="h67-4-9" class="i">+            ),
</a><a href="#h67-4-10" id="h67-4-10" class="i">+            Some(
</a><a href="#h67-4-11" id="h67-4-11" class="i">+                (
</a><a href="#h67-4-12" id="h67-4-12" class="i">+                    None,
</a><a href="#h67-4-13" id="h67-4-13" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h67-4-14" id="h67-4-14" class="i">+                ),
</a><a href="#h67-4-15" id="h67-4-15" class="i">+            ),
</a><a href="#h67-4-16" id="h67-4-16" class="i">+        ],
</a>     },
<a href="#h67-4-18" id="h67-4-18" class="d">-)
</a><a href="#h67-4-19" id="h67-4-19" class="i">+    labels: [
</a><a href="#h67-4-20" id="h67-4-20" class="i">+        Some(
</a><a href="#h67-4-21" id="h67-4-21" class="i">+            (
</a><a href="#h67-4-22" id="h67-4-22" class="i">+                None,
</a><a href="#h67-4-23" id="h67-4-23" class="i">+                &quot;genre_id&quot;,
</a><a href="#h67-4-24" id="h67-4-24" class="i">+            ),
</a><a href="#h67-4-25" id="h67-4-25" class="i">+        ),
</a><a href="#h67-4-26" id="h67-4-26" class="i">+        Some(
</a><a href="#h67-4-27" id="h67-4-27" class="i">+            (
</a><a href="#h67-4-28" id="h67-4-28" class="i">+                None,
</a><a href="#h67-4-29" id="h67-4-29" class="i">+                &quot;movie_id&quot;,
</a><a href="#h67-4-30" id="h67-4-30" class="i">+            ),
</a><a href="#h67-4-31" id="h67-4-31" class="i">+        ),
</a><a href="#h67-4-32" id="h67-4-32" class="i">+    ],
</a><a href="#h67-4-33" id="h67-4-33" class="i">+}
</a> 
<a href="#h67-4-35" id="h67-4-35" class="d">-Optimized plan: Select(
</a><a href="#h67-4-36" id="h67-4-36" class="d">-    Projection {
</a><a href="#h67-4-37" id="h67-4-37" class="i">+Optimized plan: Select {
</a><a href="#h67-4-38" id="h67-4-38" class="i">+    root: Projection {
</a>         source: HashJoin {
             left: Scan {
                 table: Table {
<a href="#h67-5" id="h67-5" class="h">@@ -293,10 +307,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h67-5-3" id="h67-5-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h67-5-7" id="h67-5-7" class="d">-                filter: None,
</a>             },
             left_field: (
                 0,
<a href="#h67-6" id="h67-6" class="h">@@ -387,10 +401,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h67-6-3" id="h67-6-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h67-6-7" id="h67-6-7" class="d">-                filter: None,
</a>             },
             right_field: (
                 0,
<a href="#h67-7" id="h67-7" class="h">@@ -405,20 +419,6 @@ Optimized plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h67-7-3" id="h67-7-3" class="d">-        labels: [
</a><a href="#h67-7-4" id="h67-7-4" class="d">-            Some(
</a><a href="#h67-7-5" id="h67-7-5" class="d">-                (
</a><a href="#h67-7-6" id="h67-7-6" class="d">-                    None,
</a><a href="#h67-7-7" id="h67-7-7" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h67-7-8" id="h67-7-8" class="d">-                ),
</a><a href="#h67-7-9" id="h67-7-9" class="d">-            ),
</a><a href="#h67-7-10" id="h67-7-10" class="d">-            Some(
</a><a href="#h67-7-11" id="h67-7-11" class="d">-                (
</a><a href="#h67-7-12" id="h67-7-12" class="d">-                    None,
</a><a href="#h67-7-13" id="h67-7-13" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h67-7-14" id="h67-7-14" class="d">-                ),
</a><a href="#h67-7-15" id="h67-7-15" class="d">-            ),
</a><a href="#h67-7-16" id="h67-7-16" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h67-8" id="h67-8" class="h">@@ -443,6 +443,34 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h67-8-3" id="h67-8-3" class="i">+        labels: [
</a><a href="#h67-8-4" id="h67-8-4" class="i">+            Some(
</a><a href="#h67-8-5" id="h67-8-5" class="i">+                (
</a><a href="#h67-8-6" id="h67-8-6" class="i">+                    None,
</a><a href="#h67-8-7" id="h67-8-7" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h67-8-8" id="h67-8-8" class="i">+                ),
</a><a href="#h67-8-9" id="h67-8-9" class="i">+            ),
</a><a href="#h67-8-10" id="h67-8-10" class="i">+            Some(
</a><a href="#h67-8-11" id="h67-8-11" class="i">+                (
</a><a href="#h67-8-12" id="h67-8-12" class="i">+                    None,
</a><a href="#h67-8-13" id="h67-8-13" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h67-8-14" id="h67-8-14" class="i">+                ),
</a><a href="#h67-8-15" id="h67-8-15" class="i">+            ),
</a><a href="#h67-8-16" id="h67-8-16" class="i">+        ],
</a>     },
<a href="#h67-8-18" id="h67-8-18" class="d">-)
</a><a href="#h67-8-19" id="h67-8-19" class="i">+    labels: [
</a><a href="#h67-8-20" id="h67-8-20" class="i">+        Some(
</a><a href="#h67-8-21" id="h67-8-21" class="i">+            (
</a><a href="#h67-8-22" id="h67-8-22" class="i">+                None,
</a><a href="#h67-8-23" id="h67-8-23" class="i">+                &quot;genre_id&quot;,
</a><a href="#h67-8-24" id="h67-8-24" class="i">+            ),
</a><a href="#h67-8-25" id="h67-8-25" class="i">+        ),
</a><a href="#h67-8-26" id="h67-8-26" class="i">+        Some(
</a><a href="#h67-8-27" id="h67-8-27" class="i">+            (
</a><a href="#h67-8-28" id="h67-8-28" class="i">+                None,
</a><a href="#h67-8-29" id="h67-8-29" class="i">+                &quot;movie_id&quot;,
</a><a href="#h67-8-30" id="h67-8-30" class="i">+            ),
</a><a href="#h67-8-31" id="h67-8-31" class="i">+        ),
</a><a href="#h67-8-32" id="h67-8-32" class="i">+    ],
</a><a href="#h67-8-33" id="h67-8-33" class="i">+}
</a> 
<b>diff --git a/<a id="h68" href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a> b/<a href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -87,8 +87,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h68-0-3" id="h68-0-3" class="d">-Plan: Select(
</a><a href="#h68-0-4" id="h68-0-4" class="d">-    Projection {
</a><a href="#h68-0-5" id="h68-0-5" class="i">+Plan: Select {
</a><a href="#h68-0-6" id="h68-0-6" class="i">+    root: Projection {
</a>         source: Projection {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h68-1" id="h68-1" class="h">@@ -169,10 +169,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h68-1-3" id="h68-1-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h68-1-7" id="h68-1-7" class="d">-                    filter: None,
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h68-2" id="h68-2" class="h">@@ -200,10 +200,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h68-2-3" id="h68-2-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h68-2-7" id="h68-2-7" class="d">-                    filter: None,
</a>                 },
                 predicate: Some(
                     Equal(
<a href="#h68-3" id="h68-3" class="h">@@ -233,17 +233,6 @@ Plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h68-3-3" id="h68-3-3" class="d">-            labels: [
</a><a href="#h68-3-4" id="h68-3-4" class="d">-                None,
</a><a href="#h68-3-5" id="h68-3-5" class="d">-                None,
</a><a href="#h68-3-6" id="h68-3-6" class="d">-                None,
</a><a href="#h68-3-7" id="h68-3-7" class="d">-                None,
</a><a href="#h68-3-8" id="h68-3-8" class="d">-                None,
</a><a href="#h68-3-9" id="h68-3-9" class="d">-                None,
</a><a href="#h68-3-10" id="h68-3-10" class="d">-                None,
</a><a href="#h68-3-11" id="h68-3-11" class="d">-                None,
</a><a href="#h68-3-12" id="h68-3-12" class="d">-                None,
</a><a href="#h68-3-13" id="h68-3-13" class="d">-            ],
</a>             expressions: [
                 Field(
                     7,
<a href="#h68-4" id="h68-4" class="h">@@ -345,21 +334,18 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h68-4-3" id="h68-4-3" class="i">+            labels: [
</a><a href="#h68-4-4" id="h68-4-4" class="i">+                None,
</a><a href="#h68-4-5" id="h68-4-5" class="i">+                None,
</a><a href="#h68-4-6" id="h68-4-6" class="i">+                None,
</a><a href="#h68-4-7" id="h68-4-7" class="i">+                None,
</a><a href="#h68-4-8" id="h68-4-8" class="i">+                None,
</a><a href="#h68-4-9" id="h68-4-9" class="i">+                None,
</a><a href="#h68-4-10" id="h68-4-10" class="i">+                None,
</a><a href="#h68-4-11" id="h68-4-11" class="i">+                None,
</a><a href="#h68-4-12" id="h68-4-12" class="i">+                None,
</a><a href="#h68-4-13" id="h68-4-13" class="i">+            ],
</a>         },
<a href="#h68-4-15" id="h68-4-15" class="d">-        labels: [
</a><a href="#h68-4-16" id="h68-4-16" class="d">-            Some(
</a><a href="#h68-4-17" id="h68-4-17" class="d">-                (
</a><a href="#h68-4-18" id="h68-4-18" class="d">-                    None,
</a><a href="#h68-4-19" id="h68-4-19" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h68-4-20" id="h68-4-20" class="d">-                ),
</a><a href="#h68-4-21" id="h68-4-21" class="d">-            ),
</a><a href="#h68-4-22" id="h68-4-22" class="d">-            Some(
</a><a href="#h68-4-23" id="h68-4-23" class="d">-                (
</a><a href="#h68-4-24" id="h68-4-24" class="d">-                    None,
</a><a href="#h68-4-25" id="h68-4-25" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h68-4-26" id="h68-4-26" class="d">-                ),
</a><a href="#h68-4-27" id="h68-4-27" class="d">-            ),
</a><a href="#h68-4-28" id="h68-4-28" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h68-5" id="h68-5" class="h">@@ -384,11 +370,39 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h68-5-3" id="h68-5-3" class="i">+        labels: [
</a><a href="#h68-5-4" id="h68-5-4" class="i">+            Some(
</a><a href="#h68-5-5" id="h68-5-5" class="i">+                (
</a><a href="#h68-5-6" id="h68-5-6" class="i">+                    None,
</a><a href="#h68-5-7" id="h68-5-7" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h68-5-8" id="h68-5-8" class="i">+                ),
</a><a href="#h68-5-9" id="h68-5-9" class="i">+            ),
</a><a href="#h68-5-10" id="h68-5-10" class="i">+            Some(
</a><a href="#h68-5-11" id="h68-5-11" class="i">+                (
</a><a href="#h68-5-12" id="h68-5-12" class="i">+                    None,
</a><a href="#h68-5-13" id="h68-5-13" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h68-5-14" id="h68-5-14" class="i">+                ),
</a><a href="#h68-5-15" id="h68-5-15" class="i">+            ),
</a><a href="#h68-5-16" id="h68-5-16" class="i">+        ],
</a>     },
<a href="#h68-5-18" id="h68-5-18" class="d">-)
</a><a href="#h68-5-19" id="h68-5-19" class="i">+    labels: [
</a><a href="#h68-5-20" id="h68-5-20" class="i">+        Some(
</a><a href="#h68-5-21" id="h68-5-21" class="i">+            (
</a><a href="#h68-5-22" id="h68-5-22" class="i">+                None,
</a><a href="#h68-5-23" id="h68-5-23" class="i">+                &quot;genre_id&quot;,
</a><a href="#h68-5-24" id="h68-5-24" class="i">+            ),
</a><a href="#h68-5-25" id="h68-5-25" class="i">+        ),
</a><a href="#h68-5-26" id="h68-5-26" class="i">+        Some(
</a><a href="#h68-5-27" id="h68-5-27" class="i">+            (
</a><a href="#h68-5-28" id="h68-5-28" class="i">+                None,
</a><a href="#h68-5-29" id="h68-5-29" class="i">+                &quot;movie_id&quot;,
</a><a href="#h68-5-30" id="h68-5-30" class="i">+            ),
</a><a href="#h68-5-31" id="h68-5-31" class="i">+        ),
</a><a href="#h68-5-32" id="h68-5-32" class="i">+    ],
</a><a href="#h68-5-33" id="h68-5-33" class="i">+}
</a> 
<a href="#h68-5-35" id="h68-5-35" class="d">-Optimized plan: Select(
</a><a href="#h68-5-36" id="h68-5-36" class="d">-    Projection {
</a><a href="#h68-5-37" id="h68-5-37" class="i">+Optimized plan: Select {
</a><a href="#h68-5-38" id="h68-5-38" class="i">+    root: Projection {
</a>         source: Projection {
             source: HashJoin {
                 left: Scan {
<a href="#h68-6" id="h68-6" class="h">@@ -469,10 +483,10 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h68-6-3" id="h68-6-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h68-6-7" id="h68-6-7" class="d">-                    filter: None,
</a>                 },
                 left_field: (
                     0,
<a href="#h68-7" id="h68-7" class="h">@@ -510,10 +524,10 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h68-7-3" id="h68-7-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h68-7-7" id="h68-7-7" class="d">-                    filter: None,
</a>                 },
                 right_field: (
                     0,
<a href="#h68-8" id="h68-8" class="h">@@ -528,17 +542,6 @@ Optimized plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h68-8-3" id="h68-8-3" class="d">-            labels: [
</a><a href="#h68-8-4" id="h68-8-4" class="d">-                None,
</a><a href="#h68-8-5" id="h68-8-5" class="d">-                None,
</a><a href="#h68-8-6" id="h68-8-6" class="d">-                None,
</a><a href="#h68-8-7" id="h68-8-7" class="d">-                None,
</a><a href="#h68-8-8" id="h68-8-8" class="d">-                None,
</a><a href="#h68-8-9" id="h68-8-9" class="d">-                None,
</a><a href="#h68-8-10" id="h68-8-10" class="d">-                None,
</a><a href="#h68-8-11" id="h68-8-11" class="d">-                None,
</a><a href="#h68-8-12" id="h68-8-12" class="d">-                None,
</a><a href="#h68-8-13" id="h68-8-13" class="d">-            ],
</a>             expressions: [
                 Field(
                     7,
<a href="#h68-9" id="h68-9" class="h">@@ -640,21 +643,18 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h68-9-3" id="h68-9-3" class="i">+            labels: [
</a><a href="#h68-9-4" id="h68-9-4" class="i">+                None,
</a><a href="#h68-9-5" id="h68-9-5" class="i">+                None,
</a><a href="#h68-9-6" id="h68-9-6" class="i">+                None,
</a><a href="#h68-9-7" id="h68-9-7" class="i">+                None,
</a><a href="#h68-9-8" id="h68-9-8" class="i">+                None,
</a><a href="#h68-9-9" id="h68-9-9" class="i">+                None,
</a><a href="#h68-9-10" id="h68-9-10" class="i">+                None,
</a><a href="#h68-9-11" id="h68-9-11" class="i">+                None,
</a><a href="#h68-9-12" id="h68-9-12" class="i">+                None,
</a><a href="#h68-9-13" id="h68-9-13" class="i">+            ],
</a>         },
<a href="#h68-9-15" id="h68-9-15" class="d">-        labels: [
</a><a href="#h68-9-16" id="h68-9-16" class="d">-            Some(
</a><a href="#h68-9-17" id="h68-9-17" class="d">-                (
</a><a href="#h68-9-18" id="h68-9-18" class="d">-                    None,
</a><a href="#h68-9-19" id="h68-9-19" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h68-9-20" id="h68-9-20" class="d">-                ),
</a><a href="#h68-9-21" id="h68-9-21" class="d">-            ),
</a><a href="#h68-9-22" id="h68-9-22" class="d">-            Some(
</a><a href="#h68-9-23" id="h68-9-23" class="d">-                (
</a><a href="#h68-9-24" id="h68-9-24" class="d">-                    None,
</a><a href="#h68-9-25" id="h68-9-25" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h68-9-26" id="h68-9-26" class="d">-                ),
</a><a href="#h68-9-27" id="h68-9-27" class="d">-            ),
</a><a href="#h68-9-28" id="h68-9-28" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h68-10" id="h68-10" class="h">@@ -679,6 +679,34 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h68-10-3" id="h68-10-3" class="i">+        labels: [
</a><a href="#h68-10-4" id="h68-10-4" class="i">+            Some(
</a><a href="#h68-10-5" id="h68-10-5" class="i">+                (
</a><a href="#h68-10-6" id="h68-10-6" class="i">+                    None,
</a><a href="#h68-10-7" id="h68-10-7" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h68-10-8" id="h68-10-8" class="i">+                ),
</a><a href="#h68-10-9" id="h68-10-9" class="i">+            ),
</a><a href="#h68-10-10" id="h68-10-10" class="i">+            Some(
</a><a href="#h68-10-11" id="h68-10-11" class="i">+                (
</a><a href="#h68-10-12" id="h68-10-12" class="i">+                    None,
</a><a href="#h68-10-13" id="h68-10-13" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h68-10-14" id="h68-10-14" class="i">+                ),
</a><a href="#h68-10-15" id="h68-10-15" class="i">+            ),
</a><a href="#h68-10-16" id="h68-10-16" class="i">+        ],
</a>     },
<a href="#h68-10-18" id="h68-10-18" class="d">-)
</a><a href="#h68-10-19" id="h68-10-19" class="i">+    labels: [
</a><a href="#h68-10-20" id="h68-10-20" class="i">+        Some(
</a><a href="#h68-10-21" id="h68-10-21" class="i">+            (
</a><a href="#h68-10-22" id="h68-10-22" class="i">+                None,
</a><a href="#h68-10-23" id="h68-10-23" class="i">+                &quot;genre_id&quot;,
</a><a href="#h68-10-24" id="h68-10-24" class="i">+            ),
</a><a href="#h68-10-25" id="h68-10-25" class="i">+        ),
</a><a href="#h68-10-26" id="h68-10-26" class="i">+        Some(
</a><a href="#h68-10-27" id="h68-10-27" class="i">+            (
</a><a href="#h68-10-28" id="h68-10-28" class="i">+                None,
</a><a href="#h68-10-29" id="h68-10-29" class="i">+                &quot;movie_id&quot;,
</a><a href="#h68-10-30" id="h68-10-30" class="i">+            ),
</a><a href="#h68-10-31" id="h68-10-31" class="i">+        ),
</a><a href="#h68-10-32" id="h68-10-32" class="i">+    ],
</a><a href="#h68-10-33" id="h68-10-33" class="i">+}
</a> 
<b>diff --git a/<a id="h69" href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a> b/<a href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -63,8 +63,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h69-0-3" id="h69-0-3" class="d">-Plan: Select(
</a><a href="#h69-0-4" id="h69-0-4" class="d">-    Projection {
</a><a href="#h69-0-5" id="h69-0-5" class="i">+Plan: Select {
</a><a href="#h69-0-6" id="h69-0-6" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h69-1" id="h69-1" class="h">@@ -144,10 +144,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h69-1-3" id="h69-1-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h69-1-7" id="h69-1-7" class="d">-                filter: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h69-2" id="h69-2" class="h">@@ -175,10 +175,10 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h69-2-3" id="h69-2-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h69-2-7" id="h69-2-7" class="d">-                filter: None,
</a>             },
             predicate: Some(
                 Equal(
<a href="#h69-3" id="h69-3" class="h">@@ -208,17 +208,6 @@ Plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h69-3-3" id="h69-3-3" class="d">-        labels: [
</a><a href="#h69-3-4" id="h69-3-4" class="d">-            None,
</a><a href="#h69-3-5" id="h69-3-5" class="d">-            None,
</a><a href="#h69-3-6" id="h69-3-6" class="d">-            None,
</a><a href="#h69-3-7" id="h69-3-7" class="d">-            None,
</a><a href="#h69-3-8" id="h69-3-8" class="d">-            None,
</a><a href="#h69-3-9" id="h69-3-9" class="d">-            None,
</a><a href="#h69-3-10" id="h69-3-10" class="d">-            None,
</a><a href="#h69-3-11" id="h69-3-11" class="d">-            None,
</a><a href="#h69-3-12" id="h69-3-12" class="d">-            None,
</a><a href="#h69-3-13" id="h69-3-13" class="d">-        ],
</a>         expressions: [
             Field(
                 7,
<a href="#h69-4" id="h69-4" class="h">@@ -320,11 +309,96 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h69-4-3" id="h69-4-3" class="i">+        labels: [
</a><a href="#h69-4-4" id="h69-4-4" class="i">+            None,
</a><a href="#h69-4-5" id="h69-4-5" class="i">+            None,
</a><a href="#h69-4-6" id="h69-4-6" class="i">+            None,
</a><a href="#h69-4-7" id="h69-4-7" class="i">+            None,
</a><a href="#h69-4-8" id="h69-4-8" class="i">+            None,
</a><a href="#h69-4-9" id="h69-4-9" class="i">+            None,
</a><a href="#h69-4-10" id="h69-4-10" class="i">+            None,
</a><a href="#h69-4-11" id="h69-4-11" class="i">+            None,
</a><a href="#h69-4-12" id="h69-4-12" class="i">+            None,
</a><a href="#h69-4-13" id="h69-4-13" class="i">+        ],
</a>     },
<a href="#h69-4-15" id="h69-4-15" class="d">-)
</a><a href="#h69-4-16" id="h69-4-16" class="i">+    labels: [
</a><a href="#h69-4-17" id="h69-4-17" class="i">+        Some(
</a><a href="#h69-4-18" id="h69-4-18" class="i">+            (
</a><a href="#h69-4-19" id="h69-4-19" class="i">+                Some(
</a><a href="#h69-4-20" id="h69-4-20" class="i">+                    &quot;g&quot;,
</a><a href="#h69-4-21" id="h69-4-21" class="i">+                ),
</a><a href="#h69-4-22" id="h69-4-22" class="i">+                &quot;id&quot;,
</a><a href="#h69-4-23" id="h69-4-23" class="i">+            ),
</a><a href="#h69-4-24" id="h69-4-24" class="i">+        ),
</a><a href="#h69-4-25" id="h69-4-25" class="i">+        Some(
</a><a href="#h69-4-26" id="h69-4-26" class="i">+            (
</a><a href="#h69-4-27" id="h69-4-27" class="i">+                Some(
</a><a href="#h69-4-28" id="h69-4-28" class="i">+                    &quot;g&quot;,
</a><a href="#h69-4-29" id="h69-4-29" class="i">+                ),
</a><a href="#h69-4-30" id="h69-4-30" class="i">+                &quot;name&quot;,
</a><a href="#h69-4-31" id="h69-4-31" class="i">+            ),
</a><a href="#h69-4-32" id="h69-4-32" class="i">+        ),
</a><a href="#h69-4-33" id="h69-4-33" class="i">+        Some(
</a><a href="#h69-4-34" id="h69-4-34" class="i">+            (
</a><a href="#h69-4-35" id="h69-4-35" class="i">+                Some(
</a><a href="#h69-4-36" id="h69-4-36" class="i">+                    &quot;m&quot;,
</a><a href="#h69-4-37" id="h69-4-37" class="i">+                ),
</a><a href="#h69-4-38" id="h69-4-38" class="i">+                &quot;id&quot;,
</a><a href="#h69-4-39" id="h69-4-39" class="i">+            ),
</a><a href="#h69-4-40" id="h69-4-40" class="i">+        ),
</a><a href="#h69-4-41" id="h69-4-41" class="i">+        Some(
</a><a href="#h69-4-42" id="h69-4-42" class="i">+            (
</a><a href="#h69-4-43" id="h69-4-43" class="i">+                Some(
</a><a href="#h69-4-44" id="h69-4-44" class="i">+                    &quot;m&quot;,
</a><a href="#h69-4-45" id="h69-4-45" class="i">+                ),
</a><a href="#h69-4-46" id="h69-4-46" class="i">+                &quot;title&quot;,
</a><a href="#h69-4-47" id="h69-4-47" class="i">+            ),
</a><a href="#h69-4-48" id="h69-4-48" class="i">+        ),
</a><a href="#h69-4-49" id="h69-4-49" class="i">+        Some(
</a><a href="#h69-4-50" id="h69-4-50" class="i">+            (
</a><a href="#h69-4-51" id="h69-4-51" class="i">+                Some(
</a><a href="#h69-4-52" id="h69-4-52" class="i">+                    &quot;m&quot;,
</a><a href="#h69-4-53" id="h69-4-53" class="i">+                ),
</a><a href="#h69-4-54" id="h69-4-54" class="i">+                &quot;studio_id&quot;,
</a><a href="#h69-4-55" id="h69-4-55" class="i">+            ),
</a><a href="#h69-4-56" id="h69-4-56" class="i">+        ),
</a><a href="#h69-4-57" id="h69-4-57" class="i">+        Some(
</a><a href="#h69-4-58" id="h69-4-58" class="i">+            (
</a><a href="#h69-4-59" id="h69-4-59" class="i">+                Some(
</a><a href="#h69-4-60" id="h69-4-60" class="i">+                    &quot;m&quot;,
</a><a href="#h69-4-61" id="h69-4-61" class="i">+                ),
</a><a href="#h69-4-62" id="h69-4-62" class="i">+                &quot;genre_id&quot;,
</a><a href="#h69-4-63" id="h69-4-63" class="i">+            ),
</a><a href="#h69-4-64" id="h69-4-64" class="i">+        ),
</a><a href="#h69-4-65" id="h69-4-65" class="i">+        Some(
</a><a href="#h69-4-66" id="h69-4-66" class="i">+            (
</a><a href="#h69-4-67" id="h69-4-67" class="i">+                Some(
</a><a href="#h69-4-68" id="h69-4-68" class="i">+                    &quot;m&quot;,
</a><a href="#h69-4-69" id="h69-4-69" class="i">+                ),
</a><a href="#h69-4-70" id="h69-4-70" class="i">+                &quot;released&quot;,
</a><a href="#h69-4-71" id="h69-4-71" class="i">+            ),
</a><a href="#h69-4-72" id="h69-4-72" class="i">+        ),
</a><a href="#h69-4-73" id="h69-4-73" class="i">+        Some(
</a><a href="#h69-4-74" id="h69-4-74" class="i">+            (
</a><a href="#h69-4-75" id="h69-4-75" class="i">+                Some(
</a><a href="#h69-4-76" id="h69-4-76" class="i">+                    &quot;m&quot;,
</a><a href="#h69-4-77" id="h69-4-77" class="i">+                ),
</a><a href="#h69-4-78" id="h69-4-78" class="i">+                &quot;rating&quot;,
</a><a href="#h69-4-79" id="h69-4-79" class="i">+            ),
</a><a href="#h69-4-80" id="h69-4-80" class="i">+        ),
</a><a href="#h69-4-81" id="h69-4-81" class="i">+        Some(
</a><a href="#h69-4-82" id="h69-4-82" class="i">+            (
</a><a href="#h69-4-83" id="h69-4-83" class="i">+                Some(
</a><a href="#h69-4-84" id="h69-4-84" class="i">+                    &quot;m&quot;,
</a><a href="#h69-4-85" id="h69-4-85" class="i">+                ),
</a><a href="#h69-4-86" id="h69-4-86" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h69-4-87" id="h69-4-87" class="i">+            ),
</a><a href="#h69-4-88" id="h69-4-88" class="i">+        ),
</a><a href="#h69-4-89" id="h69-4-89" class="i">+    ],
</a><a href="#h69-4-90" id="h69-4-90" class="i">+}
</a> 
<a href="#h69-4-92" id="h69-4-92" class="d">-Optimized plan: Select(
</a><a href="#h69-4-93" id="h69-4-93" class="d">-    Projection {
</a><a href="#h69-4-94" id="h69-4-94" class="i">+Optimized plan: Select {
</a><a href="#h69-4-95" id="h69-4-95" class="i">+    root: Projection {
</a>         source: HashJoin {
             left: Scan {
                 table: Table {
<a href="#h69-5" id="h69-5" class="h">@@ -404,10 +478,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h69-5-3" id="h69-5-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h69-5-7" id="h69-5-7" class="d">-                filter: None,
</a>             },
             left_field: (
                 0,
<a href="#h69-6" id="h69-6" class="h">@@ -445,10 +519,10 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h69-6-3" id="h69-6-3" class="i">+                filter: None,
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h69-6-7" id="h69-6-7" class="d">-                filter: None,
</a>             },
             right_field: (
                 0,
<a href="#h69-7" id="h69-7" class="h">@@ -463,17 +537,6 @@ Optimized plan: Select(
</a>             ),
             outer: true,
         },
<a href="#h69-7-3" id="h69-7-3" class="d">-        labels: [
</a><a href="#h69-7-4" id="h69-7-4" class="d">-            None,
</a><a href="#h69-7-5" id="h69-7-5" class="d">-            None,
</a><a href="#h69-7-6" id="h69-7-6" class="d">-            None,
</a><a href="#h69-7-7" id="h69-7-7" class="d">-            None,
</a><a href="#h69-7-8" id="h69-7-8" class="d">-            None,
</a><a href="#h69-7-9" id="h69-7-9" class="d">-            None,
</a><a href="#h69-7-10" id="h69-7-10" class="d">-            None,
</a><a href="#h69-7-11" id="h69-7-11" class="d">-            None,
</a><a href="#h69-7-12" id="h69-7-12" class="d">-            None,
</a><a href="#h69-7-13" id="h69-7-13" class="d">-        ],
</a>         expressions: [
             Field(
                 7,
<a href="#h69-8" id="h69-8" class="h">@@ -575,6 +638,91 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h69-8-3" id="h69-8-3" class="i">+        labels: [
</a><a href="#h69-8-4" id="h69-8-4" class="i">+            None,
</a><a href="#h69-8-5" id="h69-8-5" class="i">+            None,
</a><a href="#h69-8-6" id="h69-8-6" class="i">+            None,
</a><a href="#h69-8-7" id="h69-8-7" class="i">+            None,
</a><a href="#h69-8-8" id="h69-8-8" class="i">+            None,
</a><a href="#h69-8-9" id="h69-8-9" class="i">+            None,
</a><a href="#h69-8-10" id="h69-8-10" class="i">+            None,
</a><a href="#h69-8-11" id="h69-8-11" class="i">+            None,
</a><a href="#h69-8-12" id="h69-8-12" class="i">+            None,
</a><a href="#h69-8-13" id="h69-8-13" class="i">+        ],
</a>     },
<a href="#h69-8-15" id="h69-8-15" class="d">-)
</a><a href="#h69-8-16" id="h69-8-16" class="i">+    labels: [
</a><a href="#h69-8-17" id="h69-8-17" class="i">+        Some(
</a><a href="#h69-8-18" id="h69-8-18" class="i">+            (
</a><a href="#h69-8-19" id="h69-8-19" class="i">+                Some(
</a><a href="#h69-8-20" id="h69-8-20" class="i">+                    &quot;g&quot;,
</a><a href="#h69-8-21" id="h69-8-21" class="i">+                ),
</a><a href="#h69-8-22" id="h69-8-22" class="i">+                &quot;id&quot;,
</a><a href="#h69-8-23" id="h69-8-23" class="i">+            ),
</a><a href="#h69-8-24" id="h69-8-24" class="i">+        ),
</a><a href="#h69-8-25" id="h69-8-25" class="i">+        Some(
</a><a href="#h69-8-26" id="h69-8-26" class="i">+            (
</a><a href="#h69-8-27" id="h69-8-27" class="i">+                Some(
</a><a href="#h69-8-28" id="h69-8-28" class="i">+                    &quot;g&quot;,
</a><a href="#h69-8-29" id="h69-8-29" class="i">+                ),
</a><a href="#h69-8-30" id="h69-8-30" class="i">+                &quot;name&quot;,
</a><a href="#h69-8-31" id="h69-8-31" class="i">+            ),
</a><a href="#h69-8-32" id="h69-8-32" class="i">+        ),
</a><a href="#h69-8-33" id="h69-8-33" class="i">+        Some(
</a><a href="#h69-8-34" id="h69-8-34" class="i">+            (
</a><a href="#h69-8-35" id="h69-8-35" class="i">+                Some(
</a><a href="#h69-8-36" id="h69-8-36" class="i">+                    &quot;m&quot;,
</a><a href="#h69-8-37" id="h69-8-37" class="i">+                ),
</a><a href="#h69-8-38" id="h69-8-38" class="i">+                &quot;id&quot;,
</a><a href="#h69-8-39" id="h69-8-39" class="i">+            ),
</a><a href="#h69-8-40" id="h69-8-40" class="i">+        ),
</a><a href="#h69-8-41" id="h69-8-41" class="i">+        Some(
</a><a href="#h69-8-42" id="h69-8-42" class="i">+            (
</a><a href="#h69-8-43" id="h69-8-43" class="i">+                Some(
</a><a href="#h69-8-44" id="h69-8-44" class="i">+                    &quot;m&quot;,
</a><a href="#h69-8-45" id="h69-8-45" class="i">+                ),
</a><a href="#h69-8-46" id="h69-8-46" class="i">+                &quot;title&quot;,
</a><a href="#h69-8-47" id="h69-8-47" class="i">+            ),
</a><a href="#h69-8-48" id="h69-8-48" class="i">+        ),
</a><a href="#h69-8-49" id="h69-8-49" class="i">+        Some(
</a><a href="#h69-8-50" id="h69-8-50" class="i">+            (
</a><a href="#h69-8-51" id="h69-8-51" class="i">+                Some(
</a><a href="#h69-8-52" id="h69-8-52" class="i">+                    &quot;m&quot;,
</a><a href="#h69-8-53" id="h69-8-53" class="i">+                ),
</a><a href="#h69-8-54" id="h69-8-54" class="i">+                &quot;studio_id&quot;,
</a><a href="#h69-8-55" id="h69-8-55" class="i">+            ),
</a><a href="#h69-8-56" id="h69-8-56" class="i">+        ),
</a><a href="#h69-8-57" id="h69-8-57" class="i">+        Some(
</a><a href="#h69-8-58" id="h69-8-58" class="i">+            (
</a><a href="#h69-8-59" id="h69-8-59" class="i">+                Some(
</a><a href="#h69-8-60" id="h69-8-60" class="i">+                    &quot;m&quot;,
</a><a href="#h69-8-61" id="h69-8-61" class="i">+                ),
</a><a href="#h69-8-62" id="h69-8-62" class="i">+                &quot;genre_id&quot;,
</a><a href="#h69-8-63" id="h69-8-63" class="i">+            ),
</a><a href="#h69-8-64" id="h69-8-64" class="i">+        ),
</a><a href="#h69-8-65" id="h69-8-65" class="i">+        Some(
</a><a href="#h69-8-66" id="h69-8-66" class="i">+            (
</a><a href="#h69-8-67" id="h69-8-67" class="i">+                Some(
</a><a href="#h69-8-68" id="h69-8-68" class="i">+                    &quot;m&quot;,
</a><a href="#h69-8-69" id="h69-8-69" class="i">+                ),
</a><a href="#h69-8-70" id="h69-8-70" class="i">+                &quot;released&quot;,
</a><a href="#h69-8-71" id="h69-8-71" class="i">+            ),
</a><a href="#h69-8-72" id="h69-8-72" class="i">+        ),
</a><a href="#h69-8-73" id="h69-8-73" class="i">+        Some(
</a><a href="#h69-8-74" id="h69-8-74" class="i">+            (
</a><a href="#h69-8-75" id="h69-8-75" class="i">+                Some(
</a><a href="#h69-8-76" id="h69-8-76" class="i">+                    &quot;m&quot;,
</a><a href="#h69-8-77" id="h69-8-77" class="i">+                ),
</a><a href="#h69-8-78" id="h69-8-78" class="i">+                &quot;rating&quot;,
</a><a href="#h69-8-79" id="h69-8-79" class="i">+            ),
</a><a href="#h69-8-80" id="h69-8-80" class="i">+        ),
</a><a href="#h69-8-81" id="h69-8-81" class="i">+        Some(
</a><a href="#h69-8-82" id="h69-8-82" class="i">+            (
</a><a href="#h69-8-83" id="h69-8-83" class="i">+                Some(
</a><a href="#h69-8-84" id="h69-8-84" class="i">+                    &quot;m&quot;,
</a><a href="#h69-8-85" id="h69-8-85" class="i">+                ),
</a><a href="#h69-8-86" id="h69-8-86" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h69-8-87" id="h69-8-87" class="i">+            ),
</a><a href="#h69-8-88" id="h69-8-88" class="i">+        ),
</a><a href="#h69-8-89" id="h69-8-89" class="i">+    ],
</a><a href="#h69-8-90" id="h69-8-90" class="i">+}
</a> 
<b>diff --git a/<a id="h70" href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a> b/<a href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -87,8 +87,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h70-0-3" id="h70-0-3" class="d">-Plan: Select(
</a><a href="#h70-0-4" id="h70-0-4" class="d">-    Projection {
</a><a href="#h70-0-5" id="h70-0-5" class="i">+Plan: Select {
</a><a href="#h70-0-6" id="h70-0-6" class="i">+    root: Projection {
</a>         source: Projection {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h70-1" id="h70-1" class="h">@@ -169,10 +169,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h70-1-3" id="h70-1-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h70-1-7" id="h70-1-7" class="d">-                    filter: None,
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h70-2" id="h70-2" class="h">@@ -200,10 +200,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h70-2-3" id="h70-2-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h70-2-7" id="h70-2-7" class="d">-                    filter: None,
</a>                 },
                 predicate: Some(
                     Equal(
<a href="#h70-3" id="h70-3" class="h">@@ -233,17 +233,6 @@ Plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h70-3-3" id="h70-3-3" class="d">-            labels: [
</a><a href="#h70-3-4" id="h70-3-4" class="d">-                None,
</a><a href="#h70-3-5" id="h70-3-5" class="d">-                None,
</a><a href="#h70-3-6" id="h70-3-6" class="d">-                None,
</a><a href="#h70-3-7" id="h70-3-7" class="d">-                None,
</a><a href="#h70-3-8" id="h70-3-8" class="d">-                None,
</a><a href="#h70-3-9" id="h70-3-9" class="d">-                None,
</a><a href="#h70-3-10" id="h70-3-10" class="d">-                None,
</a><a href="#h70-3-11" id="h70-3-11" class="d">-                None,
</a><a href="#h70-3-12" id="h70-3-12" class="d">-                None,
</a><a href="#h70-3-13" id="h70-3-13" class="d">-            ],
</a>             expressions: [
                 Field(
                     7,
<a href="#h70-4" id="h70-4" class="h">@@ -345,21 +334,18 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h70-4-3" id="h70-4-3" class="i">+            labels: [
</a><a href="#h70-4-4" id="h70-4-4" class="i">+                None,
</a><a href="#h70-4-5" id="h70-4-5" class="i">+                None,
</a><a href="#h70-4-6" id="h70-4-6" class="i">+                None,
</a><a href="#h70-4-7" id="h70-4-7" class="i">+                None,
</a><a href="#h70-4-8" id="h70-4-8" class="i">+                None,
</a><a href="#h70-4-9" id="h70-4-9" class="i">+                None,
</a><a href="#h70-4-10" id="h70-4-10" class="i">+                None,
</a><a href="#h70-4-11" id="h70-4-11" class="i">+                None,
</a><a href="#h70-4-12" id="h70-4-12" class="i">+                None,
</a><a href="#h70-4-13" id="h70-4-13" class="i">+            ],
</a>         },
<a href="#h70-4-15" id="h70-4-15" class="d">-        labels: [
</a><a href="#h70-4-16" id="h70-4-16" class="d">-            Some(
</a><a href="#h70-4-17" id="h70-4-17" class="d">-                (
</a><a href="#h70-4-18" id="h70-4-18" class="d">-                    None,
</a><a href="#h70-4-19" id="h70-4-19" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h70-4-20" id="h70-4-20" class="d">-                ),
</a><a href="#h70-4-21" id="h70-4-21" class="d">-            ),
</a><a href="#h70-4-22" id="h70-4-22" class="d">-            Some(
</a><a href="#h70-4-23" id="h70-4-23" class="d">-                (
</a><a href="#h70-4-24" id="h70-4-24" class="d">-                    None,
</a><a href="#h70-4-25" id="h70-4-25" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h70-4-26" id="h70-4-26" class="d">-                ),
</a><a href="#h70-4-27" id="h70-4-27" class="d">-            ),
</a><a href="#h70-4-28" id="h70-4-28" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h70-5" id="h70-5" class="h">@@ -384,11 +370,39 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h70-5-3" id="h70-5-3" class="i">+        labels: [
</a><a href="#h70-5-4" id="h70-5-4" class="i">+            Some(
</a><a href="#h70-5-5" id="h70-5-5" class="i">+                (
</a><a href="#h70-5-6" id="h70-5-6" class="i">+                    None,
</a><a href="#h70-5-7" id="h70-5-7" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h70-5-8" id="h70-5-8" class="i">+                ),
</a><a href="#h70-5-9" id="h70-5-9" class="i">+            ),
</a><a href="#h70-5-10" id="h70-5-10" class="i">+            Some(
</a><a href="#h70-5-11" id="h70-5-11" class="i">+                (
</a><a href="#h70-5-12" id="h70-5-12" class="i">+                    None,
</a><a href="#h70-5-13" id="h70-5-13" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h70-5-14" id="h70-5-14" class="i">+                ),
</a><a href="#h70-5-15" id="h70-5-15" class="i">+            ),
</a><a href="#h70-5-16" id="h70-5-16" class="i">+        ],
</a>     },
<a href="#h70-5-18" id="h70-5-18" class="d">-)
</a><a href="#h70-5-19" id="h70-5-19" class="i">+    labels: [
</a><a href="#h70-5-20" id="h70-5-20" class="i">+        Some(
</a><a href="#h70-5-21" id="h70-5-21" class="i">+            (
</a><a href="#h70-5-22" id="h70-5-22" class="i">+                None,
</a><a href="#h70-5-23" id="h70-5-23" class="i">+                &quot;genre_id&quot;,
</a><a href="#h70-5-24" id="h70-5-24" class="i">+            ),
</a><a href="#h70-5-25" id="h70-5-25" class="i">+        ),
</a><a href="#h70-5-26" id="h70-5-26" class="i">+        Some(
</a><a href="#h70-5-27" id="h70-5-27" class="i">+            (
</a><a href="#h70-5-28" id="h70-5-28" class="i">+                None,
</a><a href="#h70-5-29" id="h70-5-29" class="i">+                &quot;movie_id&quot;,
</a><a href="#h70-5-30" id="h70-5-30" class="i">+            ),
</a><a href="#h70-5-31" id="h70-5-31" class="i">+        ),
</a><a href="#h70-5-32" id="h70-5-32" class="i">+    ],
</a><a href="#h70-5-33" id="h70-5-33" class="i">+}
</a> 
<a href="#h70-5-35" id="h70-5-35" class="d">-Optimized plan: Select(
</a><a href="#h70-5-36" id="h70-5-36" class="d">-    Projection {
</a><a href="#h70-5-37" id="h70-5-37" class="i">+Optimized plan: Select {
</a><a href="#h70-5-38" id="h70-5-38" class="i">+    root: Projection {
</a>         source: Projection {
             source: HashJoin {
                 left: Scan {
<a href="#h70-6" id="h70-6" class="h">@@ -469,10 +483,10 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h70-6-3" id="h70-6-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h70-6-7" id="h70-6-7" class="d">-                    filter: None,
</a>                 },
                 left_field: (
                     0,
<a href="#h70-7" id="h70-7" class="h">@@ -510,10 +524,10 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h70-7-3" id="h70-7-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h70-7-7" id="h70-7-7" class="d">-                    filter: None,
</a>                 },
                 right_field: (
                     0,
<a href="#h70-8" id="h70-8" class="h">@@ -528,17 +542,6 @@ Optimized plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h70-8-3" id="h70-8-3" class="d">-            labels: [
</a><a href="#h70-8-4" id="h70-8-4" class="d">-                None,
</a><a href="#h70-8-5" id="h70-8-5" class="d">-                None,
</a><a href="#h70-8-6" id="h70-8-6" class="d">-                None,
</a><a href="#h70-8-7" id="h70-8-7" class="d">-                None,
</a><a href="#h70-8-8" id="h70-8-8" class="d">-                None,
</a><a href="#h70-8-9" id="h70-8-9" class="d">-                None,
</a><a href="#h70-8-10" id="h70-8-10" class="d">-                None,
</a><a href="#h70-8-11" id="h70-8-11" class="d">-                None,
</a><a href="#h70-8-12" id="h70-8-12" class="d">-                None,
</a><a href="#h70-8-13" id="h70-8-13" class="d">-            ],
</a>             expressions: [
                 Field(
                     7,
<a href="#h70-9" id="h70-9" class="h">@@ -640,21 +643,18 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h70-9-3" id="h70-9-3" class="i">+            labels: [
</a><a href="#h70-9-4" id="h70-9-4" class="i">+                None,
</a><a href="#h70-9-5" id="h70-9-5" class="i">+                None,
</a><a href="#h70-9-6" id="h70-9-6" class="i">+                None,
</a><a href="#h70-9-7" id="h70-9-7" class="i">+                None,
</a><a href="#h70-9-8" id="h70-9-8" class="i">+                None,
</a><a href="#h70-9-9" id="h70-9-9" class="i">+                None,
</a><a href="#h70-9-10" id="h70-9-10" class="i">+                None,
</a><a href="#h70-9-11" id="h70-9-11" class="i">+                None,
</a><a href="#h70-9-12" id="h70-9-12" class="i">+                None,
</a><a href="#h70-9-13" id="h70-9-13" class="i">+            ],
</a>         },
<a href="#h70-9-15" id="h70-9-15" class="d">-        labels: [
</a><a href="#h70-9-16" id="h70-9-16" class="d">-            Some(
</a><a href="#h70-9-17" id="h70-9-17" class="d">-                (
</a><a href="#h70-9-18" id="h70-9-18" class="d">-                    None,
</a><a href="#h70-9-19" id="h70-9-19" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h70-9-20" id="h70-9-20" class="d">-                ),
</a><a href="#h70-9-21" id="h70-9-21" class="d">-            ),
</a><a href="#h70-9-22" id="h70-9-22" class="d">-            Some(
</a><a href="#h70-9-23" id="h70-9-23" class="d">-                (
</a><a href="#h70-9-24" id="h70-9-24" class="d">-                    None,
</a><a href="#h70-9-25" id="h70-9-25" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h70-9-26" id="h70-9-26" class="d">-                ),
</a><a href="#h70-9-27" id="h70-9-27" class="d">-            ),
</a><a href="#h70-9-28" id="h70-9-28" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h70-10" id="h70-10" class="h">@@ -679,6 +679,34 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h70-10-3" id="h70-10-3" class="i">+        labels: [
</a><a href="#h70-10-4" id="h70-10-4" class="i">+            Some(
</a><a href="#h70-10-5" id="h70-10-5" class="i">+                (
</a><a href="#h70-10-6" id="h70-10-6" class="i">+                    None,
</a><a href="#h70-10-7" id="h70-10-7" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h70-10-8" id="h70-10-8" class="i">+                ),
</a><a href="#h70-10-9" id="h70-10-9" class="i">+            ),
</a><a href="#h70-10-10" id="h70-10-10" class="i">+            Some(
</a><a href="#h70-10-11" id="h70-10-11" class="i">+                (
</a><a href="#h70-10-12" id="h70-10-12" class="i">+                    None,
</a><a href="#h70-10-13" id="h70-10-13" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h70-10-14" id="h70-10-14" class="i">+                ),
</a><a href="#h70-10-15" id="h70-10-15" class="i">+            ),
</a><a href="#h70-10-16" id="h70-10-16" class="i">+        ],
</a>     },
<a href="#h70-10-18" id="h70-10-18" class="d">-)
</a><a href="#h70-10-19" id="h70-10-19" class="i">+    labels: [
</a><a href="#h70-10-20" id="h70-10-20" class="i">+        Some(
</a><a href="#h70-10-21" id="h70-10-21" class="i">+            (
</a><a href="#h70-10-22" id="h70-10-22" class="i">+                None,
</a><a href="#h70-10-23" id="h70-10-23" class="i">+                &quot;genre_id&quot;,
</a><a href="#h70-10-24" id="h70-10-24" class="i">+            ),
</a><a href="#h70-10-25" id="h70-10-25" class="i">+        ),
</a><a href="#h70-10-26" id="h70-10-26" class="i">+        Some(
</a><a href="#h70-10-27" id="h70-10-27" class="i">+            (
</a><a href="#h70-10-28" id="h70-10-28" class="i">+                None,
</a><a href="#h70-10-29" id="h70-10-29" class="i">+                &quot;movie_id&quot;,
</a><a href="#h70-10-30" id="h70-10-30" class="i">+            ),
</a><a href="#h70-10-31" id="h70-10-31" class="i">+        ),
</a><a href="#h70-10-32" id="h70-10-32" class="i">+    ],
</a><a href="#h70-10-33" id="h70-10-33" class="i">+}
</a> 
<b>diff --git a/<a id="h71" href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a> b/<a href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -80,8 +80,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h71-0-3" id="h71-0-3" class="d">-Plan: Select(
</a><a href="#h71-0-4" id="h71-0-4" class="d">-    Projection {
</a><a href="#h71-0-5" id="h71-0-5" class="i">+Plan: Select {
</a><a href="#h71-0-6" id="h71-0-6" class="i">+    root: Projection {
</a>         source: Projection {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h71-1" id="h71-1" class="h">@@ -109,10 +109,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h71-1-3" id="h71-1-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h71-1-7" id="h71-1-7" class="d">-                    filter: None,
</a>                 },
                 left_size: 2,
                 right: Scan {
<a href="#h71-2" id="h71-2" class="h">@@ -193,10 +193,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h71-2-3" id="h71-2-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h71-2-7" id="h71-2-7" class="d">-                    filter: None,
</a>                 },
                 predicate: Some(
                     Equal(
<a href="#h71-3" id="h71-3" class="h">@@ -226,17 +226,6 @@ Plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h71-3-3" id="h71-3-3" class="d">-            labels: [
</a><a href="#h71-3-4" id="h71-3-4" class="d">-                None,
</a><a href="#h71-3-5" id="h71-3-5" class="d">-                None,
</a><a href="#h71-3-6" id="h71-3-6" class="d">-                None,
</a><a href="#h71-3-7" id="h71-3-7" class="d">-                None,
</a><a href="#h71-3-8" id="h71-3-8" class="d">-                None,
</a><a href="#h71-3-9" id="h71-3-9" class="d">-                None,
</a><a href="#h71-3-10" id="h71-3-10" class="d">-                None,
</a><a href="#h71-3-11" id="h71-3-11" class="d">-                None,
</a><a href="#h71-3-12" id="h71-3-12" class="d">-                None,
</a><a href="#h71-3-13" id="h71-3-13" class="d">-            ],
</a>             expressions: [
                 Field(
                     2,
<a href="#h71-4" id="h71-4" class="h">@@ -338,21 +327,18 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h71-4-3" id="h71-4-3" class="i">+            labels: [
</a><a href="#h71-4-4" id="h71-4-4" class="i">+                None,
</a><a href="#h71-4-5" id="h71-4-5" class="i">+                None,
</a><a href="#h71-4-6" id="h71-4-6" class="i">+                None,
</a><a href="#h71-4-7" id="h71-4-7" class="i">+                None,
</a><a href="#h71-4-8" id="h71-4-8" class="i">+                None,
</a><a href="#h71-4-9" id="h71-4-9" class="i">+                None,
</a><a href="#h71-4-10" id="h71-4-10" class="i">+                None,
</a><a href="#h71-4-11" id="h71-4-11" class="i">+                None,
</a><a href="#h71-4-12" id="h71-4-12" class="i">+                None,
</a><a href="#h71-4-13" id="h71-4-13" class="i">+            ],
</a>         },
<a href="#h71-4-15" id="h71-4-15" class="d">-        labels: [
</a><a href="#h71-4-16" id="h71-4-16" class="d">-            Some(
</a><a href="#h71-4-17" id="h71-4-17" class="d">-                (
</a><a href="#h71-4-18" id="h71-4-18" class="d">-                    None,
</a><a href="#h71-4-19" id="h71-4-19" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h71-4-20" id="h71-4-20" class="d">-                ),
</a><a href="#h71-4-21" id="h71-4-21" class="d">-            ),
</a><a href="#h71-4-22" id="h71-4-22" class="d">-            Some(
</a><a href="#h71-4-23" id="h71-4-23" class="d">-                (
</a><a href="#h71-4-24" id="h71-4-24" class="d">-                    None,
</a><a href="#h71-4-25" id="h71-4-25" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h71-4-26" id="h71-4-26" class="d">-                ),
</a><a href="#h71-4-27" id="h71-4-27" class="d">-            ),
</a><a href="#h71-4-28" id="h71-4-28" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h71-5" id="h71-5" class="h">@@ -377,11 +363,39 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h71-5-3" id="h71-5-3" class="i">+        labels: [
</a><a href="#h71-5-4" id="h71-5-4" class="i">+            Some(
</a><a href="#h71-5-5" id="h71-5-5" class="i">+                (
</a><a href="#h71-5-6" id="h71-5-6" class="i">+                    None,
</a><a href="#h71-5-7" id="h71-5-7" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h71-5-8" id="h71-5-8" class="i">+                ),
</a><a href="#h71-5-9" id="h71-5-9" class="i">+            ),
</a><a href="#h71-5-10" id="h71-5-10" class="i">+            Some(
</a><a href="#h71-5-11" id="h71-5-11" class="i">+                (
</a><a href="#h71-5-12" id="h71-5-12" class="i">+                    None,
</a><a href="#h71-5-13" id="h71-5-13" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h71-5-14" id="h71-5-14" class="i">+                ),
</a><a href="#h71-5-15" id="h71-5-15" class="i">+            ),
</a><a href="#h71-5-16" id="h71-5-16" class="i">+        ],
</a>     },
<a href="#h71-5-18" id="h71-5-18" class="d">-)
</a><a href="#h71-5-19" id="h71-5-19" class="i">+    labels: [
</a><a href="#h71-5-20" id="h71-5-20" class="i">+        Some(
</a><a href="#h71-5-21" id="h71-5-21" class="i">+            (
</a><a href="#h71-5-22" id="h71-5-22" class="i">+                None,
</a><a href="#h71-5-23" id="h71-5-23" class="i">+                &quot;movie_id&quot;,
</a><a href="#h71-5-24" id="h71-5-24" class="i">+            ),
</a><a href="#h71-5-25" id="h71-5-25" class="i">+        ),
</a><a href="#h71-5-26" id="h71-5-26" class="i">+        Some(
</a><a href="#h71-5-27" id="h71-5-27" class="i">+            (
</a><a href="#h71-5-28" id="h71-5-28" class="i">+                None,
</a><a href="#h71-5-29" id="h71-5-29" class="i">+                &quot;genre_id&quot;,
</a><a href="#h71-5-30" id="h71-5-30" class="i">+            ),
</a><a href="#h71-5-31" id="h71-5-31" class="i">+        ),
</a><a href="#h71-5-32" id="h71-5-32" class="i">+    ],
</a><a href="#h71-5-33" id="h71-5-33" class="i">+}
</a> 
<a href="#h71-5-35" id="h71-5-35" class="d">-Optimized plan: Select(
</a><a href="#h71-5-36" id="h71-5-36" class="d">-    Projection {
</a><a href="#h71-5-37" id="h71-5-37" class="i">+Optimized plan: Select {
</a><a href="#h71-5-38" id="h71-5-38" class="i">+    root: Projection {
</a>         source: Projection {
             source: HashJoin {
                 left: Scan {
<a href="#h71-6" id="h71-6" class="h">@@ -409,10 +423,10 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h71-6-3" id="h71-6-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h71-6-7" id="h71-6-7" class="d">-                    filter: None,
</a>                 },
                 left_field: (
                     0,
<a href="#h71-7" id="h71-7" class="h">@@ -503,10 +517,10 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h71-7-3" id="h71-7-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h71-7-7" id="h71-7-7" class="d">-                    filter: None,
</a>                 },
                 right_field: (
                     0,
<a href="#h71-8" id="h71-8" class="h">@@ -521,17 +535,6 @@ Optimized plan: Select(
</a>                 ),
                 outer: true,
             },
<a href="#h71-8-3" id="h71-8-3" class="d">-            labels: [
</a><a href="#h71-8-4" id="h71-8-4" class="d">-                None,
</a><a href="#h71-8-5" id="h71-8-5" class="d">-                None,
</a><a href="#h71-8-6" id="h71-8-6" class="d">-                None,
</a><a href="#h71-8-7" id="h71-8-7" class="d">-                None,
</a><a href="#h71-8-8" id="h71-8-8" class="d">-                None,
</a><a href="#h71-8-9" id="h71-8-9" class="d">-                None,
</a><a href="#h71-8-10" id="h71-8-10" class="d">-                None,
</a><a href="#h71-8-11" id="h71-8-11" class="d">-                None,
</a><a href="#h71-8-12" id="h71-8-12" class="d">-                None,
</a><a href="#h71-8-13" id="h71-8-13" class="d">-            ],
</a>             expressions: [
                 Field(
                     2,
<a href="#h71-9" id="h71-9" class="h">@@ -633,21 +636,18 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h71-9-3" id="h71-9-3" class="i">+            labels: [
</a><a href="#h71-9-4" id="h71-9-4" class="i">+                None,
</a><a href="#h71-9-5" id="h71-9-5" class="i">+                None,
</a><a href="#h71-9-6" id="h71-9-6" class="i">+                None,
</a><a href="#h71-9-7" id="h71-9-7" class="i">+                None,
</a><a href="#h71-9-8" id="h71-9-8" class="i">+                None,
</a><a href="#h71-9-9" id="h71-9-9" class="i">+                None,
</a><a href="#h71-9-10" id="h71-9-10" class="i">+                None,
</a><a href="#h71-9-11" id="h71-9-11" class="i">+                None,
</a><a href="#h71-9-12" id="h71-9-12" class="i">+                None,
</a><a href="#h71-9-13" id="h71-9-13" class="i">+            ],
</a>         },
<a href="#h71-9-15" id="h71-9-15" class="d">-        labels: [
</a><a href="#h71-9-16" id="h71-9-16" class="d">-            Some(
</a><a href="#h71-9-17" id="h71-9-17" class="d">-                (
</a><a href="#h71-9-18" id="h71-9-18" class="d">-                    None,
</a><a href="#h71-9-19" id="h71-9-19" class="d">-                    &quot;movie_id&quot;,
</a><a href="#h71-9-20" id="h71-9-20" class="d">-                ),
</a><a href="#h71-9-21" id="h71-9-21" class="d">-            ),
</a><a href="#h71-9-22" id="h71-9-22" class="d">-            Some(
</a><a href="#h71-9-23" id="h71-9-23" class="d">-                (
</a><a href="#h71-9-24" id="h71-9-24" class="d">-                    None,
</a><a href="#h71-9-25" id="h71-9-25" class="d">-                    &quot;genre_id&quot;,
</a><a href="#h71-9-26" id="h71-9-26" class="d">-                ),
</a><a href="#h71-9-27" id="h71-9-27" class="d">-            ),
</a><a href="#h71-9-28" id="h71-9-28" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h71-10" id="h71-10" class="h">@@ -672,6 +672,34 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h71-10-3" id="h71-10-3" class="i">+        labels: [
</a><a href="#h71-10-4" id="h71-10-4" class="i">+            Some(
</a><a href="#h71-10-5" id="h71-10-5" class="i">+                (
</a><a href="#h71-10-6" id="h71-10-6" class="i">+                    None,
</a><a href="#h71-10-7" id="h71-10-7" class="i">+                    &quot;movie_id&quot;,
</a><a href="#h71-10-8" id="h71-10-8" class="i">+                ),
</a><a href="#h71-10-9" id="h71-10-9" class="i">+            ),
</a><a href="#h71-10-10" id="h71-10-10" class="i">+            Some(
</a><a href="#h71-10-11" id="h71-10-11" class="i">+                (
</a><a href="#h71-10-12" id="h71-10-12" class="i">+                    None,
</a><a href="#h71-10-13" id="h71-10-13" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h71-10-14" id="h71-10-14" class="i">+                ),
</a><a href="#h71-10-15" id="h71-10-15" class="i">+            ),
</a><a href="#h71-10-16" id="h71-10-16" class="i">+        ],
</a>     },
<a href="#h71-10-18" id="h71-10-18" class="d">-)
</a><a href="#h71-10-19" id="h71-10-19" class="i">+    labels: [
</a><a href="#h71-10-20" id="h71-10-20" class="i">+        Some(
</a><a href="#h71-10-21" id="h71-10-21" class="i">+            (
</a><a href="#h71-10-22" id="h71-10-22" class="i">+                None,
</a><a href="#h71-10-23" id="h71-10-23" class="i">+                &quot;movie_id&quot;,
</a><a href="#h71-10-24" id="h71-10-24" class="i">+            ),
</a><a href="#h71-10-25" id="h71-10-25" class="i">+        ),
</a><a href="#h71-10-26" id="h71-10-26" class="i">+        Some(
</a><a href="#h71-10-27" id="h71-10-27" class="i">+            (
</a><a href="#h71-10-28" id="h71-10-28" class="i">+                None,
</a><a href="#h71-10-29" id="h71-10-29" class="i">+                &quot;genre_id&quot;,
</a><a href="#h71-10-30" id="h71-10-30" class="i">+            ),
</a><a href="#h71-10-31" id="h71-10-31" class="i">+        ),
</a><a href="#h71-10-32" id="h71-10-32" class="i">+    ],
</a><a href="#h71-10-33" id="h71-10-33" class="i">+}
</a> 
<b>diff --git a/<a id="h72" href="../file/tests/sql/query/limit.html">tests/sql/query/limit</a> b/<a href="../file/tests/sql/query/limit.html">tests/sql/query/limit</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -31,8 +31,8 @@ AST: Select {
</a>     ),
 }
 
<a href="#h72-0-3" id="h72-0-3" class="d">-Plan: Select(
</a><a href="#h72-0-4" id="h72-0-4" class="d">-    Limit {
</a><a href="#h72-0-5" id="h72-0-5" class="i">+Plan: Select {
</a><a href="#h72-0-6" id="h72-0-6" class="i">+    root: Limit {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h72-1" id="h72-1" class="h">@@ -111,15 +111,73 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h72-1-3" id="h72-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h72-1-5" id="h72-1-5" class="i">+            alias: None,
</a>         },
         limit: 3,
     },
<a href="#h72-1-9" id="h72-1-9" class="d">-)
</a><a href="#h72-1-10" id="h72-1-10" class="i">+    labels: [
</a><a href="#h72-1-11" id="h72-1-11" class="i">+        Some(
</a><a href="#h72-1-12" id="h72-1-12" class="i">+            (
</a><a href="#h72-1-13" id="h72-1-13" class="i">+                Some(
</a><a href="#h72-1-14" id="h72-1-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-1-15" id="h72-1-15" class="i">+                ),
</a><a href="#h72-1-16" id="h72-1-16" class="i">+                &quot;id&quot;,
</a><a href="#h72-1-17" id="h72-1-17" class="i">+            ),
</a><a href="#h72-1-18" id="h72-1-18" class="i">+        ),
</a><a href="#h72-1-19" id="h72-1-19" class="i">+        Some(
</a><a href="#h72-1-20" id="h72-1-20" class="i">+            (
</a><a href="#h72-1-21" id="h72-1-21" class="i">+                Some(
</a><a href="#h72-1-22" id="h72-1-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-1-23" id="h72-1-23" class="i">+                ),
</a><a href="#h72-1-24" id="h72-1-24" class="i">+                &quot;title&quot;,
</a><a href="#h72-1-25" id="h72-1-25" class="i">+            ),
</a><a href="#h72-1-26" id="h72-1-26" class="i">+        ),
</a><a href="#h72-1-27" id="h72-1-27" class="i">+        Some(
</a><a href="#h72-1-28" id="h72-1-28" class="i">+            (
</a><a href="#h72-1-29" id="h72-1-29" class="i">+                Some(
</a><a href="#h72-1-30" id="h72-1-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-1-31" id="h72-1-31" class="i">+                ),
</a><a href="#h72-1-32" id="h72-1-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h72-1-33" id="h72-1-33" class="i">+            ),
</a><a href="#h72-1-34" id="h72-1-34" class="i">+        ),
</a><a href="#h72-1-35" id="h72-1-35" class="i">+        Some(
</a><a href="#h72-1-36" id="h72-1-36" class="i">+            (
</a><a href="#h72-1-37" id="h72-1-37" class="i">+                Some(
</a><a href="#h72-1-38" id="h72-1-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-1-39" id="h72-1-39" class="i">+                ),
</a><a href="#h72-1-40" id="h72-1-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h72-1-41" id="h72-1-41" class="i">+            ),
</a><a href="#h72-1-42" id="h72-1-42" class="i">+        ),
</a><a href="#h72-1-43" id="h72-1-43" class="i">+        Some(
</a><a href="#h72-1-44" id="h72-1-44" class="i">+            (
</a><a href="#h72-1-45" id="h72-1-45" class="i">+                Some(
</a><a href="#h72-1-46" id="h72-1-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-1-47" id="h72-1-47" class="i">+                ),
</a><a href="#h72-1-48" id="h72-1-48" class="i">+                &quot;released&quot;,
</a><a href="#h72-1-49" id="h72-1-49" class="i">+            ),
</a><a href="#h72-1-50" id="h72-1-50" class="i">+        ),
</a><a href="#h72-1-51" id="h72-1-51" class="i">+        Some(
</a><a href="#h72-1-52" id="h72-1-52" class="i">+            (
</a><a href="#h72-1-53" id="h72-1-53" class="i">+                Some(
</a><a href="#h72-1-54" id="h72-1-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-1-55" id="h72-1-55" class="i">+                ),
</a><a href="#h72-1-56" id="h72-1-56" class="i">+                &quot;rating&quot;,
</a><a href="#h72-1-57" id="h72-1-57" class="i">+            ),
</a><a href="#h72-1-58" id="h72-1-58" class="i">+        ),
</a><a href="#h72-1-59" id="h72-1-59" class="i">+        Some(
</a><a href="#h72-1-60" id="h72-1-60" class="i">+            (
</a><a href="#h72-1-61" id="h72-1-61" class="i">+                Some(
</a><a href="#h72-1-62" id="h72-1-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-1-63" id="h72-1-63" class="i">+                ),
</a><a href="#h72-1-64" id="h72-1-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h72-1-65" id="h72-1-65" class="i">+            ),
</a><a href="#h72-1-66" id="h72-1-66" class="i">+        ),
</a><a href="#h72-1-67" id="h72-1-67" class="i">+    ],
</a><a href="#h72-1-68" id="h72-1-68" class="i">+}
</a> 
<a href="#h72-1-70" id="h72-1-70" class="d">-Optimized plan: Select(
</a><a href="#h72-1-71" id="h72-1-71" class="d">-    Limit {
</a><a href="#h72-1-72" id="h72-1-72" class="i">+Optimized plan: Select {
</a><a href="#h72-1-73" id="h72-1-73" class="i">+    root: Limit {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h72-2" id="h72-2" class="h">@@ -198,10 +256,68 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h72-2-3" id="h72-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h72-2-5" id="h72-2-5" class="i">+            alias: None,
</a>         },
         limit: 3,
     },
<a href="#h72-2-9" id="h72-2-9" class="d">-)
</a><a href="#h72-2-10" id="h72-2-10" class="i">+    labels: [
</a><a href="#h72-2-11" id="h72-2-11" class="i">+        Some(
</a><a href="#h72-2-12" id="h72-2-12" class="i">+            (
</a><a href="#h72-2-13" id="h72-2-13" class="i">+                Some(
</a><a href="#h72-2-14" id="h72-2-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-2-15" id="h72-2-15" class="i">+                ),
</a><a href="#h72-2-16" id="h72-2-16" class="i">+                &quot;id&quot;,
</a><a href="#h72-2-17" id="h72-2-17" class="i">+            ),
</a><a href="#h72-2-18" id="h72-2-18" class="i">+        ),
</a><a href="#h72-2-19" id="h72-2-19" class="i">+        Some(
</a><a href="#h72-2-20" id="h72-2-20" class="i">+            (
</a><a href="#h72-2-21" id="h72-2-21" class="i">+                Some(
</a><a href="#h72-2-22" id="h72-2-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-2-23" id="h72-2-23" class="i">+                ),
</a><a href="#h72-2-24" id="h72-2-24" class="i">+                &quot;title&quot;,
</a><a href="#h72-2-25" id="h72-2-25" class="i">+            ),
</a><a href="#h72-2-26" id="h72-2-26" class="i">+        ),
</a><a href="#h72-2-27" id="h72-2-27" class="i">+        Some(
</a><a href="#h72-2-28" id="h72-2-28" class="i">+            (
</a><a href="#h72-2-29" id="h72-2-29" class="i">+                Some(
</a><a href="#h72-2-30" id="h72-2-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-2-31" id="h72-2-31" class="i">+                ),
</a><a href="#h72-2-32" id="h72-2-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h72-2-33" id="h72-2-33" class="i">+            ),
</a><a href="#h72-2-34" id="h72-2-34" class="i">+        ),
</a><a href="#h72-2-35" id="h72-2-35" class="i">+        Some(
</a><a href="#h72-2-36" id="h72-2-36" class="i">+            (
</a><a href="#h72-2-37" id="h72-2-37" class="i">+                Some(
</a><a href="#h72-2-38" id="h72-2-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-2-39" id="h72-2-39" class="i">+                ),
</a><a href="#h72-2-40" id="h72-2-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h72-2-41" id="h72-2-41" class="i">+            ),
</a><a href="#h72-2-42" id="h72-2-42" class="i">+        ),
</a><a href="#h72-2-43" id="h72-2-43" class="i">+        Some(
</a><a href="#h72-2-44" id="h72-2-44" class="i">+            (
</a><a href="#h72-2-45" id="h72-2-45" class="i">+                Some(
</a><a href="#h72-2-46" id="h72-2-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-2-47" id="h72-2-47" class="i">+                ),
</a><a href="#h72-2-48" id="h72-2-48" class="i">+                &quot;released&quot;,
</a><a href="#h72-2-49" id="h72-2-49" class="i">+            ),
</a><a href="#h72-2-50" id="h72-2-50" class="i">+        ),
</a><a href="#h72-2-51" id="h72-2-51" class="i">+        Some(
</a><a href="#h72-2-52" id="h72-2-52" class="i">+            (
</a><a href="#h72-2-53" id="h72-2-53" class="i">+                Some(
</a><a href="#h72-2-54" id="h72-2-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-2-55" id="h72-2-55" class="i">+                ),
</a><a href="#h72-2-56" id="h72-2-56" class="i">+                &quot;rating&quot;,
</a><a href="#h72-2-57" id="h72-2-57" class="i">+            ),
</a><a href="#h72-2-58" id="h72-2-58" class="i">+        ),
</a><a href="#h72-2-59" id="h72-2-59" class="i">+        Some(
</a><a href="#h72-2-60" id="h72-2-60" class="i">+            (
</a><a href="#h72-2-61" id="h72-2-61" class="i">+                Some(
</a><a href="#h72-2-62" id="h72-2-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h72-2-63" id="h72-2-63" class="i">+                ),
</a><a href="#h72-2-64" id="h72-2-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h72-2-65" id="h72-2-65" class="i">+            ),
</a><a href="#h72-2-66" id="h72-2-66" class="i">+        ),
</a><a href="#h72-2-67" id="h72-2-67" class="i">+    ],
</a><a href="#h72-2-68" id="h72-2-68" class="i">+}
</a> 
<b>diff --git a/<a id="h73" href="../file/tests/sql/query/limit_expr.html">tests/sql/query/limit_expr</a> b/<a href="../file/tests/sql/query/limit_expr.html">tests/sql/query/limit_expr</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -40,8 +40,8 @@ AST: Select {
</a>     ),
 }
 
<a href="#h73-0-3" id="h73-0-3" class="d">-Plan: Select(
</a><a href="#h73-0-4" id="h73-0-4" class="d">-    Limit {
</a><a href="#h73-0-5" id="h73-0-5" class="i">+Plan: Select {
</a><a href="#h73-0-6" id="h73-0-6" class="i">+    root: Limit {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h73-1" id="h73-1" class="h">@@ -120,15 +120,73 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h73-1-3" id="h73-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h73-1-5" id="h73-1-5" class="i">+            alias: None,
</a>         },
         limit: 3,
     },
<a href="#h73-1-9" id="h73-1-9" class="d">-)
</a><a href="#h73-1-10" id="h73-1-10" class="i">+    labels: [
</a><a href="#h73-1-11" id="h73-1-11" class="i">+        Some(
</a><a href="#h73-1-12" id="h73-1-12" class="i">+            (
</a><a href="#h73-1-13" id="h73-1-13" class="i">+                Some(
</a><a href="#h73-1-14" id="h73-1-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-1-15" id="h73-1-15" class="i">+                ),
</a><a href="#h73-1-16" id="h73-1-16" class="i">+                &quot;id&quot;,
</a><a href="#h73-1-17" id="h73-1-17" class="i">+            ),
</a><a href="#h73-1-18" id="h73-1-18" class="i">+        ),
</a><a href="#h73-1-19" id="h73-1-19" class="i">+        Some(
</a><a href="#h73-1-20" id="h73-1-20" class="i">+            (
</a><a href="#h73-1-21" id="h73-1-21" class="i">+                Some(
</a><a href="#h73-1-22" id="h73-1-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-1-23" id="h73-1-23" class="i">+                ),
</a><a href="#h73-1-24" id="h73-1-24" class="i">+                &quot;title&quot;,
</a><a href="#h73-1-25" id="h73-1-25" class="i">+            ),
</a><a href="#h73-1-26" id="h73-1-26" class="i">+        ),
</a><a href="#h73-1-27" id="h73-1-27" class="i">+        Some(
</a><a href="#h73-1-28" id="h73-1-28" class="i">+            (
</a><a href="#h73-1-29" id="h73-1-29" class="i">+                Some(
</a><a href="#h73-1-30" id="h73-1-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-1-31" id="h73-1-31" class="i">+                ),
</a><a href="#h73-1-32" id="h73-1-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h73-1-33" id="h73-1-33" class="i">+            ),
</a><a href="#h73-1-34" id="h73-1-34" class="i">+        ),
</a><a href="#h73-1-35" id="h73-1-35" class="i">+        Some(
</a><a href="#h73-1-36" id="h73-1-36" class="i">+            (
</a><a href="#h73-1-37" id="h73-1-37" class="i">+                Some(
</a><a href="#h73-1-38" id="h73-1-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-1-39" id="h73-1-39" class="i">+                ),
</a><a href="#h73-1-40" id="h73-1-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h73-1-41" id="h73-1-41" class="i">+            ),
</a><a href="#h73-1-42" id="h73-1-42" class="i">+        ),
</a><a href="#h73-1-43" id="h73-1-43" class="i">+        Some(
</a><a href="#h73-1-44" id="h73-1-44" class="i">+            (
</a><a href="#h73-1-45" id="h73-1-45" class="i">+                Some(
</a><a href="#h73-1-46" id="h73-1-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-1-47" id="h73-1-47" class="i">+                ),
</a><a href="#h73-1-48" id="h73-1-48" class="i">+                &quot;released&quot;,
</a><a href="#h73-1-49" id="h73-1-49" class="i">+            ),
</a><a href="#h73-1-50" id="h73-1-50" class="i">+        ),
</a><a href="#h73-1-51" id="h73-1-51" class="i">+        Some(
</a><a href="#h73-1-52" id="h73-1-52" class="i">+            (
</a><a href="#h73-1-53" id="h73-1-53" class="i">+                Some(
</a><a href="#h73-1-54" id="h73-1-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-1-55" id="h73-1-55" class="i">+                ),
</a><a href="#h73-1-56" id="h73-1-56" class="i">+                &quot;rating&quot;,
</a><a href="#h73-1-57" id="h73-1-57" class="i">+            ),
</a><a href="#h73-1-58" id="h73-1-58" class="i">+        ),
</a><a href="#h73-1-59" id="h73-1-59" class="i">+        Some(
</a><a href="#h73-1-60" id="h73-1-60" class="i">+            (
</a><a href="#h73-1-61" id="h73-1-61" class="i">+                Some(
</a><a href="#h73-1-62" id="h73-1-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-1-63" id="h73-1-63" class="i">+                ),
</a><a href="#h73-1-64" id="h73-1-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h73-1-65" id="h73-1-65" class="i">+            ),
</a><a href="#h73-1-66" id="h73-1-66" class="i">+        ),
</a><a href="#h73-1-67" id="h73-1-67" class="i">+    ],
</a><a href="#h73-1-68" id="h73-1-68" class="i">+}
</a> 
<a href="#h73-1-70" id="h73-1-70" class="d">-Optimized plan: Select(
</a><a href="#h73-1-71" id="h73-1-71" class="d">-    Limit {
</a><a href="#h73-1-72" id="h73-1-72" class="i">+Optimized plan: Select {
</a><a href="#h73-1-73" id="h73-1-73" class="i">+    root: Limit {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h73-2" id="h73-2" class="h">@@ -207,10 +265,68 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h73-2-3" id="h73-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h73-2-5" id="h73-2-5" class="i">+            alias: None,
</a>         },
         limit: 3,
     },
<a href="#h73-2-9" id="h73-2-9" class="d">-)
</a><a href="#h73-2-10" id="h73-2-10" class="i">+    labels: [
</a><a href="#h73-2-11" id="h73-2-11" class="i">+        Some(
</a><a href="#h73-2-12" id="h73-2-12" class="i">+            (
</a><a href="#h73-2-13" id="h73-2-13" class="i">+                Some(
</a><a href="#h73-2-14" id="h73-2-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-2-15" id="h73-2-15" class="i">+                ),
</a><a href="#h73-2-16" id="h73-2-16" class="i">+                &quot;id&quot;,
</a><a href="#h73-2-17" id="h73-2-17" class="i">+            ),
</a><a href="#h73-2-18" id="h73-2-18" class="i">+        ),
</a><a href="#h73-2-19" id="h73-2-19" class="i">+        Some(
</a><a href="#h73-2-20" id="h73-2-20" class="i">+            (
</a><a href="#h73-2-21" id="h73-2-21" class="i">+                Some(
</a><a href="#h73-2-22" id="h73-2-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-2-23" id="h73-2-23" class="i">+                ),
</a><a href="#h73-2-24" id="h73-2-24" class="i">+                &quot;title&quot;,
</a><a href="#h73-2-25" id="h73-2-25" class="i">+            ),
</a><a href="#h73-2-26" id="h73-2-26" class="i">+        ),
</a><a href="#h73-2-27" id="h73-2-27" class="i">+        Some(
</a><a href="#h73-2-28" id="h73-2-28" class="i">+            (
</a><a href="#h73-2-29" id="h73-2-29" class="i">+                Some(
</a><a href="#h73-2-30" id="h73-2-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-2-31" id="h73-2-31" class="i">+                ),
</a><a href="#h73-2-32" id="h73-2-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h73-2-33" id="h73-2-33" class="i">+            ),
</a><a href="#h73-2-34" id="h73-2-34" class="i">+        ),
</a><a href="#h73-2-35" id="h73-2-35" class="i">+        Some(
</a><a href="#h73-2-36" id="h73-2-36" class="i">+            (
</a><a href="#h73-2-37" id="h73-2-37" class="i">+                Some(
</a><a href="#h73-2-38" id="h73-2-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-2-39" id="h73-2-39" class="i">+                ),
</a><a href="#h73-2-40" id="h73-2-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h73-2-41" id="h73-2-41" class="i">+            ),
</a><a href="#h73-2-42" id="h73-2-42" class="i">+        ),
</a><a href="#h73-2-43" id="h73-2-43" class="i">+        Some(
</a><a href="#h73-2-44" id="h73-2-44" class="i">+            (
</a><a href="#h73-2-45" id="h73-2-45" class="i">+                Some(
</a><a href="#h73-2-46" id="h73-2-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-2-47" id="h73-2-47" class="i">+                ),
</a><a href="#h73-2-48" id="h73-2-48" class="i">+                &quot;released&quot;,
</a><a href="#h73-2-49" id="h73-2-49" class="i">+            ),
</a><a href="#h73-2-50" id="h73-2-50" class="i">+        ),
</a><a href="#h73-2-51" id="h73-2-51" class="i">+        Some(
</a><a href="#h73-2-52" id="h73-2-52" class="i">+            (
</a><a href="#h73-2-53" id="h73-2-53" class="i">+                Some(
</a><a href="#h73-2-54" id="h73-2-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-2-55" id="h73-2-55" class="i">+                ),
</a><a href="#h73-2-56" id="h73-2-56" class="i">+                &quot;rating&quot;,
</a><a href="#h73-2-57" id="h73-2-57" class="i">+            ),
</a><a href="#h73-2-58" id="h73-2-58" class="i">+        ),
</a><a href="#h73-2-59" id="h73-2-59" class="i">+        Some(
</a><a href="#h73-2-60" id="h73-2-60" class="i">+            (
</a><a href="#h73-2-61" id="h73-2-61" class="i">+                Some(
</a><a href="#h73-2-62" id="h73-2-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h73-2-63" id="h73-2-63" class="i">+                ),
</a><a href="#h73-2-64" id="h73-2-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h73-2-65" id="h73-2-65" class="i">+            ),
</a><a href="#h73-2-66" id="h73-2-66" class="i">+        ),
</a><a href="#h73-2-67" id="h73-2-67" class="i">+    ],
</a><a href="#h73-2-68" id="h73-2-68" class="i">+}
</a> 
<b>diff --git a/<a id="h74" href="../file/tests/sql/query/limit_large.html">tests/sql/query/limit_large</a> b/<a href="../file/tests/sql/query/limit_large.html">tests/sql/query/limit_large</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -38,8 +38,8 @@ AST: Select {
</a>     ),
 }
 
<a href="#h74-0-3" id="h74-0-3" class="d">-Plan: Select(
</a><a href="#h74-0-4" id="h74-0-4" class="d">-    Limit {
</a><a href="#h74-0-5" id="h74-0-5" class="i">+Plan: Select {
</a><a href="#h74-0-6" id="h74-0-6" class="i">+    root: Limit {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h74-1" id="h74-1" class="h">@@ -118,15 +118,73 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h74-1-3" id="h74-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h74-1-5" id="h74-1-5" class="i">+            alias: None,
</a>         },
         limit: 9223372036854775807,
     },
<a href="#h74-1-9" id="h74-1-9" class="d">-)
</a><a href="#h74-1-10" id="h74-1-10" class="i">+    labels: [
</a><a href="#h74-1-11" id="h74-1-11" class="i">+        Some(
</a><a href="#h74-1-12" id="h74-1-12" class="i">+            (
</a><a href="#h74-1-13" id="h74-1-13" class="i">+                Some(
</a><a href="#h74-1-14" id="h74-1-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-1-15" id="h74-1-15" class="i">+                ),
</a><a href="#h74-1-16" id="h74-1-16" class="i">+                &quot;id&quot;,
</a><a href="#h74-1-17" id="h74-1-17" class="i">+            ),
</a><a href="#h74-1-18" id="h74-1-18" class="i">+        ),
</a><a href="#h74-1-19" id="h74-1-19" class="i">+        Some(
</a><a href="#h74-1-20" id="h74-1-20" class="i">+            (
</a><a href="#h74-1-21" id="h74-1-21" class="i">+                Some(
</a><a href="#h74-1-22" id="h74-1-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-1-23" id="h74-1-23" class="i">+                ),
</a><a href="#h74-1-24" id="h74-1-24" class="i">+                &quot;title&quot;,
</a><a href="#h74-1-25" id="h74-1-25" class="i">+            ),
</a><a href="#h74-1-26" id="h74-1-26" class="i">+        ),
</a><a href="#h74-1-27" id="h74-1-27" class="i">+        Some(
</a><a href="#h74-1-28" id="h74-1-28" class="i">+            (
</a><a href="#h74-1-29" id="h74-1-29" class="i">+                Some(
</a><a href="#h74-1-30" id="h74-1-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-1-31" id="h74-1-31" class="i">+                ),
</a><a href="#h74-1-32" id="h74-1-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h74-1-33" id="h74-1-33" class="i">+            ),
</a><a href="#h74-1-34" id="h74-1-34" class="i">+        ),
</a><a href="#h74-1-35" id="h74-1-35" class="i">+        Some(
</a><a href="#h74-1-36" id="h74-1-36" class="i">+            (
</a><a href="#h74-1-37" id="h74-1-37" class="i">+                Some(
</a><a href="#h74-1-38" id="h74-1-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-1-39" id="h74-1-39" class="i">+                ),
</a><a href="#h74-1-40" id="h74-1-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h74-1-41" id="h74-1-41" class="i">+            ),
</a><a href="#h74-1-42" id="h74-1-42" class="i">+        ),
</a><a href="#h74-1-43" id="h74-1-43" class="i">+        Some(
</a><a href="#h74-1-44" id="h74-1-44" class="i">+            (
</a><a href="#h74-1-45" id="h74-1-45" class="i">+                Some(
</a><a href="#h74-1-46" id="h74-1-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-1-47" id="h74-1-47" class="i">+                ),
</a><a href="#h74-1-48" id="h74-1-48" class="i">+                &quot;released&quot;,
</a><a href="#h74-1-49" id="h74-1-49" class="i">+            ),
</a><a href="#h74-1-50" id="h74-1-50" class="i">+        ),
</a><a href="#h74-1-51" id="h74-1-51" class="i">+        Some(
</a><a href="#h74-1-52" id="h74-1-52" class="i">+            (
</a><a href="#h74-1-53" id="h74-1-53" class="i">+                Some(
</a><a href="#h74-1-54" id="h74-1-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-1-55" id="h74-1-55" class="i">+                ),
</a><a href="#h74-1-56" id="h74-1-56" class="i">+                &quot;rating&quot;,
</a><a href="#h74-1-57" id="h74-1-57" class="i">+            ),
</a><a href="#h74-1-58" id="h74-1-58" class="i">+        ),
</a><a href="#h74-1-59" id="h74-1-59" class="i">+        Some(
</a><a href="#h74-1-60" id="h74-1-60" class="i">+            (
</a><a href="#h74-1-61" id="h74-1-61" class="i">+                Some(
</a><a href="#h74-1-62" id="h74-1-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-1-63" id="h74-1-63" class="i">+                ),
</a><a href="#h74-1-64" id="h74-1-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h74-1-65" id="h74-1-65" class="i">+            ),
</a><a href="#h74-1-66" id="h74-1-66" class="i">+        ),
</a><a href="#h74-1-67" id="h74-1-67" class="i">+    ],
</a><a href="#h74-1-68" id="h74-1-68" class="i">+}
</a> 
<a href="#h74-1-70" id="h74-1-70" class="d">-Optimized plan: Select(
</a><a href="#h74-1-71" id="h74-1-71" class="d">-    Limit {
</a><a href="#h74-1-72" id="h74-1-72" class="i">+Optimized plan: Select {
</a><a href="#h74-1-73" id="h74-1-73" class="i">+    root: Limit {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h74-2" id="h74-2" class="h">@@ -205,10 +263,68 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h74-2-3" id="h74-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h74-2-5" id="h74-2-5" class="i">+            alias: None,
</a>         },
         limit: 9223372036854775807,
     },
<a href="#h74-2-9" id="h74-2-9" class="d">-)
</a><a href="#h74-2-10" id="h74-2-10" class="i">+    labels: [
</a><a href="#h74-2-11" id="h74-2-11" class="i">+        Some(
</a><a href="#h74-2-12" id="h74-2-12" class="i">+            (
</a><a href="#h74-2-13" id="h74-2-13" class="i">+                Some(
</a><a href="#h74-2-14" id="h74-2-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-2-15" id="h74-2-15" class="i">+                ),
</a><a href="#h74-2-16" id="h74-2-16" class="i">+                &quot;id&quot;,
</a><a href="#h74-2-17" id="h74-2-17" class="i">+            ),
</a><a href="#h74-2-18" id="h74-2-18" class="i">+        ),
</a><a href="#h74-2-19" id="h74-2-19" class="i">+        Some(
</a><a href="#h74-2-20" id="h74-2-20" class="i">+            (
</a><a href="#h74-2-21" id="h74-2-21" class="i">+                Some(
</a><a href="#h74-2-22" id="h74-2-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-2-23" id="h74-2-23" class="i">+                ),
</a><a href="#h74-2-24" id="h74-2-24" class="i">+                &quot;title&quot;,
</a><a href="#h74-2-25" id="h74-2-25" class="i">+            ),
</a><a href="#h74-2-26" id="h74-2-26" class="i">+        ),
</a><a href="#h74-2-27" id="h74-2-27" class="i">+        Some(
</a><a href="#h74-2-28" id="h74-2-28" class="i">+            (
</a><a href="#h74-2-29" id="h74-2-29" class="i">+                Some(
</a><a href="#h74-2-30" id="h74-2-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-2-31" id="h74-2-31" class="i">+                ),
</a><a href="#h74-2-32" id="h74-2-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h74-2-33" id="h74-2-33" class="i">+            ),
</a><a href="#h74-2-34" id="h74-2-34" class="i">+        ),
</a><a href="#h74-2-35" id="h74-2-35" class="i">+        Some(
</a><a href="#h74-2-36" id="h74-2-36" class="i">+            (
</a><a href="#h74-2-37" id="h74-2-37" class="i">+                Some(
</a><a href="#h74-2-38" id="h74-2-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-2-39" id="h74-2-39" class="i">+                ),
</a><a href="#h74-2-40" id="h74-2-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h74-2-41" id="h74-2-41" class="i">+            ),
</a><a href="#h74-2-42" id="h74-2-42" class="i">+        ),
</a><a href="#h74-2-43" id="h74-2-43" class="i">+        Some(
</a><a href="#h74-2-44" id="h74-2-44" class="i">+            (
</a><a href="#h74-2-45" id="h74-2-45" class="i">+                Some(
</a><a href="#h74-2-46" id="h74-2-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-2-47" id="h74-2-47" class="i">+                ),
</a><a href="#h74-2-48" id="h74-2-48" class="i">+                &quot;released&quot;,
</a><a href="#h74-2-49" id="h74-2-49" class="i">+            ),
</a><a href="#h74-2-50" id="h74-2-50" class="i">+        ),
</a><a href="#h74-2-51" id="h74-2-51" class="i">+        Some(
</a><a href="#h74-2-52" id="h74-2-52" class="i">+            (
</a><a href="#h74-2-53" id="h74-2-53" class="i">+                Some(
</a><a href="#h74-2-54" id="h74-2-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-2-55" id="h74-2-55" class="i">+                ),
</a><a href="#h74-2-56" id="h74-2-56" class="i">+                &quot;rating&quot;,
</a><a href="#h74-2-57" id="h74-2-57" class="i">+            ),
</a><a href="#h74-2-58" id="h74-2-58" class="i">+        ),
</a><a href="#h74-2-59" id="h74-2-59" class="i">+        Some(
</a><a href="#h74-2-60" id="h74-2-60" class="i">+            (
</a><a href="#h74-2-61" id="h74-2-61" class="i">+                Some(
</a><a href="#h74-2-62" id="h74-2-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h74-2-63" id="h74-2-63" class="i">+                ),
</a><a href="#h74-2-64" id="h74-2-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h74-2-65" id="h74-2-65" class="i">+            ),
</a><a href="#h74-2-66" id="h74-2-66" class="i">+        ),
</a><a href="#h74-2-67" id="h74-2-67" class="i">+    ],
</a><a href="#h74-2-68" id="h74-2-68" class="i">+}
</a> 
<b>diff --git a/<a id="h75" href="../file/tests/sql/query/limit_offset.html">tests/sql/query/limit_offset</a> b/<a href="../file/tests/sql/query/limit_offset.html">tests/sql/query/limit_offset</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -37,8 +37,8 @@ AST: Select {
</a>     ),
 }
 
<a href="#h75-0-3" id="h75-0-3" class="d">-Plan: Select(
</a><a href="#h75-0-4" id="h75-0-4" class="d">-    Limit {
</a><a href="#h75-0-5" id="h75-0-5" class="i">+Plan: Select {
</a><a href="#h75-0-6" id="h75-0-6" class="i">+    root: Limit {
</a>         source: Offset {
             source: Scan {
                 table: Table {
<a href="#h75-1" id="h75-1" class="h">@@ -118,17 +118,75 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h75-1-3" id="h75-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h75-1-5" id="h75-1-5" class="i">+                alias: None,
</a>             },
             offset: 1,
         },
         limit: 2,
     },
<a href="#h75-1-11" id="h75-1-11" class="d">-)
</a><a href="#h75-1-12" id="h75-1-12" class="i">+    labels: [
</a><a href="#h75-1-13" id="h75-1-13" class="i">+        Some(
</a><a href="#h75-1-14" id="h75-1-14" class="i">+            (
</a><a href="#h75-1-15" id="h75-1-15" class="i">+                Some(
</a><a href="#h75-1-16" id="h75-1-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-1-17" id="h75-1-17" class="i">+                ),
</a><a href="#h75-1-18" id="h75-1-18" class="i">+                &quot;id&quot;,
</a><a href="#h75-1-19" id="h75-1-19" class="i">+            ),
</a><a href="#h75-1-20" id="h75-1-20" class="i">+        ),
</a><a href="#h75-1-21" id="h75-1-21" class="i">+        Some(
</a><a href="#h75-1-22" id="h75-1-22" class="i">+            (
</a><a href="#h75-1-23" id="h75-1-23" class="i">+                Some(
</a><a href="#h75-1-24" id="h75-1-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-1-25" id="h75-1-25" class="i">+                ),
</a><a href="#h75-1-26" id="h75-1-26" class="i">+                &quot;title&quot;,
</a><a href="#h75-1-27" id="h75-1-27" class="i">+            ),
</a><a href="#h75-1-28" id="h75-1-28" class="i">+        ),
</a><a href="#h75-1-29" id="h75-1-29" class="i">+        Some(
</a><a href="#h75-1-30" id="h75-1-30" class="i">+            (
</a><a href="#h75-1-31" id="h75-1-31" class="i">+                Some(
</a><a href="#h75-1-32" id="h75-1-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-1-33" id="h75-1-33" class="i">+                ),
</a><a href="#h75-1-34" id="h75-1-34" class="i">+                &quot;studio_id&quot;,
</a><a href="#h75-1-35" id="h75-1-35" class="i">+            ),
</a><a href="#h75-1-36" id="h75-1-36" class="i">+        ),
</a><a href="#h75-1-37" id="h75-1-37" class="i">+        Some(
</a><a href="#h75-1-38" id="h75-1-38" class="i">+            (
</a><a href="#h75-1-39" id="h75-1-39" class="i">+                Some(
</a><a href="#h75-1-40" id="h75-1-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-1-41" id="h75-1-41" class="i">+                ),
</a><a href="#h75-1-42" id="h75-1-42" class="i">+                &quot;genre_id&quot;,
</a><a href="#h75-1-43" id="h75-1-43" class="i">+            ),
</a><a href="#h75-1-44" id="h75-1-44" class="i">+        ),
</a><a href="#h75-1-45" id="h75-1-45" class="i">+        Some(
</a><a href="#h75-1-46" id="h75-1-46" class="i">+            (
</a><a href="#h75-1-47" id="h75-1-47" class="i">+                Some(
</a><a href="#h75-1-48" id="h75-1-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-1-49" id="h75-1-49" class="i">+                ),
</a><a href="#h75-1-50" id="h75-1-50" class="i">+                &quot;released&quot;,
</a><a href="#h75-1-51" id="h75-1-51" class="i">+            ),
</a><a href="#h75-1-52" id="h75-1-52" class="i">+        ),
</a><a href="#h75-1-53" id="h75-1-53" class="i">+        Some(
</a><a href="#h75-1-54" id="h75-1-54" class="i">+            (
</a><a href="#h75-1-55" id="h75-1-55" class="i">+                Some(
</a><a href="#h75-1-56" id="h75-1-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-1-57" id="h75-1-57" class="i">+                ),
</a><a href="#h75-1-58" id="h75-1-58" class="i">+                &quot;rating&quot;,
</a><a href="#h75-1-59" id="h75-1-59" class="i">+            ),
</a><a href="#h75-1-60" id="h75-1-60" class="i">+        ),
</a><a href="#h75-1-61" id="h75-1-61" class="i">+        Some(
</a><a href="#h75-1-62" id="h75-1-62" class="i">+            (
</a><a href="#h75-1-63" id="h75-1-63" class="i">+                Some(
</a><a href="#h75-1-64" id="h75-1-64" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-1-65" id="h75-1-65" class="i">+                ),
</a><a href="#h75-1-66" id="h75-1-66" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h75-1-67" id="h75-1-67" class="i">+            ),
</a><a href="#h75-1-68" id="h75-1-68" class="i">+        ),
</a><a href="#h75-1-69" id="h75-1-69" class="i">+    ],
</a><a href="#h75-1-70" id="h75-1-70" class="i">+}
</a> 
<a href="#h75-1-72" id="h75-1-72" class="d">-Optimized plan: Select(
</a><a href="#h75-1-73" id="h75-1-73" class="d">-    Limit {
</a><a href="#h75-1-74" id="h75-1-74" class="i">+Optimized plan: Select {
</a><a href="#h75-1-75" id="h75-1-75" class="i">+    root: Limit {
</a>         source: Offset {
             source: Scan {
                 table: Table {
<a href="#h75-2" id="h75-2" class="h">@@ -208,12 +266,70 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h75-2-3" id="h75-2-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h75-2-5" id="h75-2-5" class="i">+                alias: None,
</a>             },
             offset: 1,
         },
         limit: 2,
     },
<a href="#h75-2-11" id="h75-2-11" class="d">-)
</a><a href="#h75-2-12" id="h75-2-12" class="i">+    labels: [
</a><a href="#h75-2-13" id="h75-2-13" class="i">+        Some(
</a><a href="#h75-2-14" id="h75-2-14" class="i">+            (
</a><a href="#h75-2-15" id="h75-2-15" class="i">+                Some(
</a><a href="#h75-2-16" id="h75-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-2-17" id="h75-2-17" class="i">+                ),
</a><a href="#h75-2-18" id="h75-2-18" class="i">+                &quot;id&quot;,
</a><a href="#h75-2-19" id="h75-2-19" class="i">+            ),
</a><a href="#h75-2-20" id="h75-2-20" class="i">+        ),
</a><a href="#h75-2-21" id="h75-2-21" class="i">+        Some(
</a><a href="#h75-2-22" id="h75-2-22" class="i">+            (
</a><a href="#h75-2-23" id="h75-2-23" class="i">+                Some(
</a><a href="#h75-2-24" id="h75-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-2-25" id="h75-2-25" class="i">+                ),
</a><a href="#h75-2-26" id="h75-2-26" class="i">+                &quot;title&quot;,
</a><a href="#h75-2-27" id="h75-2-27" class="i">+            ),
</a><a href="#h75-2-28" id="h75-2-28" class="i">+        ),
</a><a href="#h75-2-29" id="h75-2-29" class="i">+        Some(
</a><a href="#h75-2-30" id="h75-2-30" class="i">+            (
</a><a href="#h75-2-31" id="h75-2-31" class="i">+                Some(
</a><a href="#h75-2-32" id="h75-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-2-33" id="h75-2-33" class="i">+                ),
</a><a href="#h75-2-34" id="h75-2-34" class="i">+                &quot;studio_id&quot;,
</a><a href="#h75-2-35" id="h75-2-35" class="i">+            ),
</a><a href="#h75-2-36" id="h75-2-36" class="i">+        ),
</a><a href="#h75-2-37" id="h75-2-37" class="i">+        Some(
</a><a href="#h75-2-38" id="h75-2-38" class="i">+            (
</a><a href="#h75-2-39" id="h75-2-39" class="i">+                Some(
</a><a href="#h75-2-40" id="h75-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-2-41" id="h75-2-41" class="i">+                ),
</a><a href="#h75-2-42" id="h75-2-42" class="i">+                &quot;genre_id&quot;,
</a><a href="#h75-2-43" id="h75-2-43" class="i">+            ),
</a><a href="#h75-2-44" id="h75-2-44" class="i">+        ),
</a><a href="#h75-2-45" id="h75-2-45" class="i">+        Some(
</a><a href="#h75-2-46" id="h75-2-46" class="i">+            (
</a><a href="#h75-2-47" id="h75-2-47" class="i">+                Some(
</a><a href="#h75-2-48" id="h75-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-2-49" id="h75-2-49" class="i">+                ),
</a><a href="#h75-2-50" id="h75-2-50" class="i">+                &quot;released&quot;,
</a><a href="#h75-2-51" id="h75-2-51" class="i">+            ),
</a><a href="#h75-2-52" id="h75-2-52" class="i">+        ),
</a><a href="#h75-2-53" id="h75-2-53" class="i">+        Some(
</a><a href="#h75-2-54" id="h75-2-54" class="i">+            (
</a><a href="#h75-2-55" id="h75-2-55" class="i">+                Some(
</a><a href="#h75-2-56" id="h75-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-2-57" id="h75-2-57" class="i">+                ),
</a><a href="#h75-2-58" id="h75-2-58" class="i">+                &quot;rating&quot;,
</a><a href="#h75-2-59" id="h75-2-59" class="i">+            ),
</a><a href="#h75-2-60" id="h75-2-60" class="i">+        ),
</a><a href="#h75-2-61" id="h75-2-61" class="i">+        Some(
</a><a href="#h75-2-62" id="h75-2-62" class="i">+            (
</a><a href="#h75-2-63" id="h75-2-63" class="i">+                Some(
</a><a href="#h75-2-64" id="h75-2-64" class="i">+                    &quot;movies&quot;,
</a><a href="#h75-2-65" id="h75-2-65" class="i">+                ),
</a><a href="#h75-2-66" id="h75-2-66" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h75-2-67" id="h75-2-67" class="i">+            ),
</a><a href="#h75-2-68" id="h75-2-68" class="i">+        ),
</a><a href="#h75-2-69" id="h75-2-69" class="i">+    ],
</a><a href="#h75-2-70" id="h75-2-70" class="i">+}
</a> 
<b>diff --git a/<a id="h76" href="../file/tests/sql/query/limit_zero.html">tests/sql/query/limit_zero</a> b/<a href="../file/tests/sql/query/limit_zero.html">tests/sql/query/limit_zero</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -28,8 +28,8 @@ AST: Select {
</a>     ),
 }
 
<a href="#h76-0-3" id="h76-0-3" class="d">-Plan: Select(
</a><a href="#h76-0-4" id="h76-0-4" class="d">-    Limit {
</a><a href="#h76-0-5" id="h76-0-5" class="i">+Plan: Select {
</a><a href="#h76-0-6" id="h76-0-6" class="i">+    root: Limit {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h76-1" id="h76-1" class="h">@@ -108,15 +108,73 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h76-1-3" id="h76-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h76-1-5" id="h76-1-5" class="i">+            alias: None,
</a>         },
         limit: 0,
     },
<a href="#h76-1-9" id="h76-1-9" class="d">-)
</a><a href="#h76-1-10" id="h76-1-10" class="i">+    labels: [
</a><a href="#h76-1-11" id="h76-1-11" class="i">+        Some(
</a><a href="#h76-1-12" id="h76-1-12" class="i">+            (
</a><a href="#h76-1-13" id="h76-1-13" class="i">+                Some(
</a><a href="#h76-1-14" id="h76-1-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-1-15" id="h76-1-15" class="i">+                ),
</a><a href="#h76-1-16" id="h76-1-16" class="i">+                &quot;id&quot;,
</a><a href="#h76-1-17" id="h76-1-17" class="i">+            ),
</a><a href="#h76-1-18" id="h76-1-18" class="i">+        ),
</a><a href="#h76-1-19" id="h76-1-19" class="i">+        Some(
</a><a href="#h76-1-20" id="h76-1-20" class="i">+            (
</a><a href="#h76-1-21" id="h76-1-21" class="i">+                Some(
</a><a href="#h76-1-22" id="h76-1-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-1-23" id="h76-1-23" class="i">+                ),
</a><a href="#h76-1-24" id="h76-1-24" class="i">+                &quot;title&quot;,
</a><a href="#h76-1-25" id="h76-1-25" class="i">+            ),
</a><a href="#h76-1-26" id="h76-1-26" class="i">+        ),
</a><a href="#h76-1-27" id="h76-1-27" class="i">+        Some(
</a><a href="#h76-1-28" id="h76-1-28" class="i">+            (
</a><a href="#h76-1-29" id="h76-1-29" class="i">+                Some(
</a><a href="#h76-1-30" id="h76-1-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-1-31" id="h76-1-31" class="i">+                ),
</a><a href="#h76-1-32" id="h76-1-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h76-1-33" id="h76-1-33" class="i">+            ),
</a><a href="#h76-1-34" id="h76-1-34" class="i">+        ),
</a><a href="#h76-1-35" id="h76-1-35" class="i">+        Some(
</a><a href="#h76-1-36" id="h76-1-36" class="i">+            (
</a><a href="#h76-1-37" id="h76-1-37" class="i">+                Some(
</a><a href="#h76-1-38" id="h76-1-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-1-39" id="h76-1-39" class="i">+                ),
</a><a href="#h76-1-40" id="h76-1-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h76-1-41" id="h76-1-41" class="i">+            ),
</a><a href="#h76-1-42" id="h76-1-42" class="i">+        ),
</a><a href="#h76-1-43" id="h76-1-43" class="i">+        Some(
</a><a href="#h76-1-44" id="h76-1-44" class="i">+            (
</a><a href="#h76-1-45" id="h76-1-45" class="i">+                Some(
</a><a href="#h76-1-46" id="h76-1-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-1-47" id="h76-1-47" class="i">+                ),
</a><a href="#h76-1-48" id="h76-1-48" class="i">+                &quot;released&quot;,
</a><a href="#h76-1-49" id="h76-1-49" class="i">+            ),
</a><a href="#h76-1-50" id="h76-1-50" class="i">+        ),
</a><a href="#h76-1-51" id="h76-1-51" class="i">+        Some(
</a><a href="#h76-1-52" id="h76-1-52" class="i">+            (
</a><a href="#h76-1-53" id="h76-1-53" class="i">+                Some(
</a><a href="#h76-1-54" id="h76-1-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-1-55" id="h76-1-55" class="i">+                ),
</a><a href="#h76-1-56" id="h76-1-56" class="i">+                &quot;rating&quot;,
</a><a href="#h76-1-57" id="h76-1-57" class="i">+            ),
</a><a href="#h76-1-58" id="h76-1-58" class="i">+        ),
</a><a href="#h76-1-59" id="h76-1-59" class="i">+        Some(
</a><a href="#h76-1-60" id="h76-1-60" class="i">+            (
</a><a href="#h76-1-61" id="h76-1-61" class="i">+                Some(
</a><a href="#h76-1-62" id="h76-1-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-1-63" id="h76-1-63" class="i">+                ),
</a><a href="#h76-1-64" id="h76-1-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h76-1-65" id="h76-1-65" class="i">+            ),
</a><a href="#h76-1-66" id="h76-1-66" class="i">+        ),
</a><a href="#h76-1-67" id="h76-1-67" class="i">+    ],
</a><a href="#h76-1-68" id="h76-1-68" class="i">+}
</a> 
<a href="#h76-1-70" id="h76-1-70" class="d">-Optimized plan: Select(
</a><a href="#h76-1-71" id="h76-1-71" class="d">-    Limit {
</a><a href="#h76-1-72" id="h76-1-72" class="i">+Optimized plan: Select {
</a><a href="#h76-1-73" id="h76-1-73" class="i">+    root: Limit {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h76-2" id="h76-2" class="h">@@ -195,10 +253,68 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h76-2-3" id="h76-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h76-2-5" id="h76-2-5" class="i">+            alias: None,
</a>         },
         limit: 0,
     },
<a href="#h76-2-9" id="h76-2-9" class="d">-)
</a><a href="#h76-2-10" id="h76-2-10" class="i">+    labels: [
</a><a href="#h76-2-11" id="h76-2-11" class="i">+        Some(
</a><a href="#h76-2-12" id="h76-2-12" class="i">+            (
</a><a href="#h76-2-13" id="h76-2-13" class="i">+                Some(
</a><a href="#h76-2-14" id="h76-2-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-2-15" id="h76-2-15" class="i">+                ),
</a><a href="#h76-2-16" id="h76-2-16" class="i">+                &quot;id&quot;,
</a><a href="#h76-2-17" id="h76-2-17" class="i">+            ),
</a><a href="#h76-2-18" id="h76-2-18" class="i">+        ),
</a><a href="#h76-2-19" id="h76-2-19" class="i">+        Some(
</a><a href="#h76-2-20" id="h76-2-20" class="i">+            (
</a><a href="#h76-2-21" id="h76-2-21" class="i">+                Some(
</a><a href="#h76-2-22" id="h76-2-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-2-23" id="h76-2-23" class="i">+                ),
</a><a href="#h76-2-24" id="h76-2-24" class="i">+                &quot;title&quot;,
</a><a href="#h76-2-25" id="h76-2-25" class="i">+            ),
</a><a href="#h76-2-26" id="h76-2-26" class="i">+        ),
</a><a href="#h76-2-27" id="h76-2-27" class="i">+        Some(
</a><a href="#h76-2-28" id="h76-2-28" class="i">+            (
</a><a href="#h76-2-29" id="h76-2-29" class="i">+                Some(
</a><a href="#h76-2-30" id="h76-2-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-2-31" id="h76-2-31" class="i">+                ),
</a><a href="#h76-2-32" id="h76-2-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h76-2-33" id="h76-2-33" class="i">+            ),
</a><a href="#h76-2-34" id="h76-2-34" class="i">+        ),
</a><a href="#h76-2-35" id="h76-2-35" class="i">+        Some(
</a><a href="#h76-2-36" id="h76-2-36" class="i">+            (
</a><a href="#h76-2-37" id="h76-2-37" class="i">+                Some(
</a><a href="#h76-2-38" id="h76-2-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-2-39" id="h76-2-39" class="i">+                ),
</a><a href="#h76-2-40" id="h76-2-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h76-2-41" id="h76-2-41" class="i">+            ),
</a><a href="#h76-2-42" id="h76-2-42" class="i">+        ),
</a><a href="#h76-2-43" id="h76-2-43" class="i">+        Some(
</a><a href="#h76-2-44" id="h76-2-44" class="i">+            (
</a><a href="#h76-2-45" id="h76-2-45" class="i">+                Some(
</a><a href="#h76-2-46" id="h76-2-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-2-47" id="h76-2-47" class="i">+                ),
</a><a href="#h76-2-48" id="h76-2-48" class="i">+                &quot;released&quot;,
</a><a href="#h76-2-49" id="h76-2-49" class="i">+            ),
</a><a href="#h76-2-50" id="h76-2-50" class="i">+        ),
</a><a href="#h76-2-51" id="h76-2-51" class="i">+        Some(
</a><a href="#h76-2-52" id="h76-2-52" class="i">+            (
</a><a href="#h76-2-53" id="h76-2-53" class="i">+                Some(
</a><a href="#h76-2-54" id="h76-2-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-2-55" id="h76-2-55" class="i">+                ),
</a><a href="#h76-2-56" id="h76-2-56" class="i">+                &quot;rating&quot;,
</a><a href="#h76-2-57" id="h76-2-57" class="i">+            ),
</a><a href="#h76-2-58" id="h76-2-58" class="i">+        ),
</a><a href="#h76-2-59" id="h76-2-59" class="i">+        Some(
</a><a href="#h76-2-60" id="h76-2-60" class="i">+            (
</a><a href="#h76-2-61" id="h76-2-61" class="i">+                Some(
</a><a href="#h76-2-62" id="h76-2-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h76-2-63" id="h76-2-63" class="i">+                ),
</a><a href="#h76-2-64" id="h76-2-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h76-2-65" id="h76-2-65" class="i">+            ),
</a><a href="#h76-2-66" id="h76-2-66" class="i">+        ),
</a><a href="#h76-2-67" id="h76-2-67" class="i">+    ],
</a><a href="#h76-2-68" id="h76-2-68" class="i">+}
</a> 
<b>diff --git a/<a id="h77" href="../file/tests/sql/query/lowercase.html">tests/sql/query/lowercase</a> b/<a href="../file/tests/sql/query/lowercase.html">tests/sql/query/lowercase</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -27,12 +27,9 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h77-0-3" id="h77-0-3" class="d">-Plan: Select(
</a><a href="#h77-0-4" id="h77-0-4" class="d">-    Projection {
</a><a href="#h77-0-5" id="h77-0-5" class="i">+Plan: Select {
</a><a href="#h77-0-6" id="h77-0-6" class="i">+    root: Projection {
</a>         source: Nothing,
<a href="#h77-0-8" id="h77-0-8" class="d">-        labels: [
</a><a href="#h77-0-9" id="h77-0-9" class="d">-            None,
</a><a href="#h77-0-10" id="h77-0-10" class="d">-        ],
</a>         expressions: [
             Constant(
                 Integer(
<a href="#h77-1" id="h77-1" class="h">@@ -40,15 +37,18 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h77-1-3" id="h77-1-3" class="d">-    },
</a><a href="#h77-1-4" id="h77-1-4" class="d">-)
</a><a href="#h77-1-5" id="h77-1-5" class="d">-
</a><a href="#h77-1-6" id="h77-1-6" class="d">-Optimized plan: Select(
</a><a href="#h77-1-7" id="h77-1-7" class="d">-    Projection {
</a><a href="#h77-1-8" id="h77-1-8" class="d">-        source: Nothing,
</a>         labels: [
             None,
         ],
<a href="#h77-1-12" id="h77-1-12" class="i">+    },
</a><a href="#h77-1-13" id="h77-1-13" class="i">+    labels: [
</a><a href="#h77-1-14" id="h77-1-14" class="i">+        None,
</a><a href="#h77-1-15" id="h77-1-15" class="i">+    ],
</a><a href="#h77-1-16" id="h77-1-16" class="i">+}
</a><a href="#h77-1-17" id="h77-1-17" class="i">+
</a><a href="#h77-1-18" id="h77-1-18" class="i">+Optimized plan: Select {
</a><a href="#h77-1-19" id="h77-1-19" class="i">+    root: Projection {
</a><a href="#h77-1-20" id="h77-1-20" class="i">+        source: Nothing,
</a>         expressions: [
             Constant(
                 Integer(
<a href="#h77-2" id="h77-2" class="h">@@ -56,6 +56,12 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h77-2-3" id="h77-2-3" class="i">+        labels: [
</a><a href="#h77-2-4" id="h77-2-4" class="i">+            None,
</a><a href="#h77-2-5" id="h77-2-5" class="i">+        ],
</a>     },
<a href="#h77-2-7" id="h77-2-7" class="d">-)
</a><a href="#h77-2-8" id="h77-2-8" class="i">+    labels: [
</a><a href="#h77-2-9" id="h77-2-9" class="i">+        None,
</a><a href="#h77-2-10" id="h77-2-10" class="i">+    ],
</a><a href="#h77-2-11" id="h77-2-11" class="i">+}
</a> 
<b>diff --git a/<a id="h78" href="../file/tests/sql/query/offset.html">tests/sql/query/offset</a> b/<a href="../file/tests/sql/query/offset.html">tests/sql/query/offset</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -35,8 +35,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h78-0-3" id="h78-0-3" class="d">-Plan: Select(
</a><a href="#h78-0-4" id="h78-0-4" class="d">-    Offset {
</a><a href="#h78-0-5" id="h78-0-5" class="i">+Plan: Select {
</a><a href="#h78-0-6" id="h78-0-6" class="i">+    root: Offset {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h78-1" id="h78-1" class="h">@@ -115,15 +115,73 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h78-1-3" id="h78-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h78-1-5" id="h78-1-5" class="i">+            alias: None,
</a>         },
         offset: 3,
     },
<a href="#h78-1-9" id="h78-1-9" class="d">-)
</a><a href="#h78-1-10" id="h78-1-10" class="i">+    labels: [
</a><a href="#h78-1-11" id="h78-1-11" class="i">+        Some(
</a><a href="#h78-1-12" id="h78-1-12" class="i">+            (
</a><a href="#h78-1-13" id="h78-1-13" class="i">+                Some(
</a><a href="#h78-1-14" id="h78-1-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-1-15" id="h78-1-15" class="i">+                ),
</a><a href="#h78-1-16" id="h78-1-16" class="i">+                &quot;id&quot;,
</a><a href="#h78-1-17" id="h78-1-17" class="i">+            ),
</a><a href="#h78-1-18" id="h78-1-18" class="i">+        ),
</a><a href="#h78-1-19" id="h78-1-19" class="i">+        Some(
</a><a href="#h78-1-20" id="h78-1-20" class="i">+            (
</a><a href="#h78-1-21" id="h78-1-21" class="i">+                Some(
</a><a href="#h78-1-22" id="h78-1-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-1-23" id="h78-1-23" class="i">+                ),
</a><a href="#h78-1-24" id="h78-1-24" class="i">+                &quot;title&quot;,
</a><a href="#h78-1-25" id="h78-1-25" class="i">+            ),
</a><a href="#h78-1-26" id="h78-1-26" class="i">+        ),
</a><a href="#h78-1-27" id="h78-1-27" class="i">+        Some(
</a><a href="#h78-1-28" id="h78-1-28" class="i">+            (
</a><a href="#h78-1-29" id="h78-1-29" class="i">+                Some(
</a><a href="#h78-1-30" id="h78-1-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-1-31" id="h78-1-31" class="i">+                ),
</a><a href="#h78-1-32" id="h78-1-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h78-1-33" id="h78-1-33" class="i">+            ),
</a><a href="#h78-1-34" id="h78-1-34" class="i">+        ),
</a><a href="#h78-1-35" id="h78-1-35" class="i">+        Some(
</a><a href="#h78-1-36" id="h78-1-36" class="i">+            (
</a><a href="#h78-1-37" id="h78-1-37" class="i">+                Some(
</a><a href="#h78-1-38" id="h78-1-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-1-39" id="h78-1-39" class="i">+                ),
</a><a href="#h78-1-40" id="h78-1-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h78-1-41" id="h78-1-41" class="i">+            ),
</a><a href="#h78-1-42" id="h78-1-42" class="i">+        ),
</a><a href="#h78-1-43" id="h78-1-43" class="i">+        Some(
</a><a href="#h78-1-44" id="h78-1-44" class="i">+            (
</a><a href="#h78-1-45" id="h78-1-45" class="i">+                Some(
</a><a href="#h78-1-46" id="h78-1-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-1-47" id="h78-1-47" class="i">+                ),
</a><a href="#h78-1-48" id="h78-1-48" class="i">+                &quot;released&quot;,
</a><a href="#h78-1-49" id="h78-1-49" class="i">+            ),
</a><a href="#h78-1-50" id="h78-1-50" class="i">+        ),
</a><a href="#h78-1-51" id="h78-1-51" class="i">+        Some(
</a><a href="#h78-1-52" id="h78-1-52" class="i">+            (
</a><a href="#h78-1-53" id="h78-1-53" class="i">+                Some(
</a><a href="#h78-1-54" id="h78-1-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-1-55" id="h78-1-55" class="i">+                ),
</a><a href="#h78-1-56" id="h78-1-56" class="i">+                &quot;rating&quot;,
</a><a href="#h78-1-57" id="h78-1-57" class="i">+            ),
</a><a href="#h78-1-58" id="h78-1-58" class="i">+        ),
</a><a href="#h78-1-59" id="h78-1-59" class="i">+        Some(
</a><a href="#h78-1-60" id="h78-1-60" class="i">+            (
</a><a href="#h78-1-61" id="h78-1-61" class="i">+                Some(
</a><a href="#h78-1-62" id="h78-1-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-1-63" id="h78-1-63" class="i">+                ),
</a><a href="#h78-1-64" id="h78-1-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h78-1-65" id="h78-1-65" class="i">+            ),
</a><a href="#h78-1-66" id="h78-1-66" class="i">+        ),
</a><a href="#h78-1-67" id="h78-1-67" class="i">+    ],
</a><a href="#h78-1-68" id="h78-1-68" class="i">+}
</a> 
<a href="#h78-1-70" id="h78-1-70" class="d">-Optimized plan: Select(
</a><a href="#h78-1-71" id="h78-1-71" class="d">-    Offset {
</a><a href="#h78-1-72" id="h78-1-72" class="i">+Optimized plan: Select {
</a><a href="#h78-1-73" id="h78-1-73" class="i">+    root: Offset {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h78-2" id="h78-2" class="h">@@ -202,10 +260,68 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h78-2-3" id="h78-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h78-2-5" id="h78-2-5" class="i">+            alias: None,
</a>         },
         offset: 3,
     },
<a href="#h78-2-9" id="h78-2-9" class="d">-)
</a><a href="#h78-2-10" id="h78-2-10" class="i">+    labels: [
</a><a href="#h78-2-11" id="h78-2-11" class="i">+        Some(
</a><a href="#h78-2-12" id="h78-2-12" class="i">+            (
</a><a href="#h78-2-13" id="h78-2-13" class="i">+                Some(
</a><a href="#h78-2-14" id="h78-2-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-2-15" id="h78-2-15" class="i">+                ),
</a><a href="#h78-2-16" id="h78-2-16" class="i">+                &quot;id&quot;,
</a><a href="#h78-2-17" id="h78-2-17" class="i">+            ),
</a><a href="#h78-2-18" id="h78-2-18" class="i">+        ),
</a><a href="#h78-2-19" id="h78-2-19" class="i">+        Some(
</a><a href="#h78-2-20" id="h78-2-20" class="i">+            (
</a><a href="#h78-2-21" id="h78-2-21" class="i">+                Some(
</a><a href="#h78-2-22" id="h78-2-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-2-23" id="h78-2-23" class="i">+                ),
</a><a href="#h78-2-24" id="h78-2-24" class="i">+                &quot;title&quot;,
</a><a href="#h78-2-25" id="h78-2-25" class="i">+            ),
</a><a href="#h78-2-26" id="h78-2-26" class="i">+        ),
</a><a href="#h78-2-27" id="h78-2-27" class="i">+        Some(
</a><a href="#h78-2-28" id="h78-2-28" class="i">+            (
</a><a href="#h78-2-29" id="h78-2-29" class="i">+                Some(
</a><a href="#h78-2-30" id="h78-2-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-2-31" id="h78-2-31" class="i">+                ),
</a><a href="#h78-2-32" id="h78-2-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h78-2-33" id="h78-2-33" class="i">+            ),
</a><a href="#h78-2-34" id="h78-2-34" class="i">+        ),
</a><a href="#h78-2-35" id="h78-2-35" class="i">+        Some(
</a><a href="#h78-2-36" id="h78-2-36" class="i">+            (
</a><a href="#h78-2-37" id="h78-2-37" class="i">+                Some(
</a><a href="#h78-2-38" id="h78-2-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-2-39" id="h78-2-39" class="i">+                ),
</a><a href="#h78-2-40" id="h78-2-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h78-2-41" id="h78-2-41" class="i">+            ),
</a><a href="#h78-2-42" id="h78-2-42" class="i">+        ),
</a><a href="#h78-2-43" id="h78-2-43" class="i">+        Some(
</a><a href="#h78-2-44" id="h78-2-44" class="i">+            (
</a><a href="#h78-2-45" id="h78-2-45" class="i">+                Some(
</a><a href="#h78-2-46" id="h78-2-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-2-47" id="h78-2-47" class="i">+                ),
</a><a href="#h78-2-48" id="h78-2-48" class="i">+                &quot;released&quot;,
</a><a href="#h78-2-49" id="h78-2-49" class="i">+            ),
</a><a href="#h78-2-50" id="h78-2-50" class="i">+        ),
</a><a href="#h78-2-51" id="h78-2-51" class="i">+        Some(
</a><a href="#h78-2-52" id="h78-2-52" class="i">+            (
</a><a href="#h78-2-53" id="h78-2-53" class="i">+                Some(
</a><a href="#h78-2-54" id="h78-2-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-2-55" id="h78-2-55" class="i">+                ),
</a><a href="#h78-2-56" id="h78-2-56" class="i">+                &quot;rating&quot;,
</a><a href="#h78-2-57" id="h78-2-57" class="i">+            ),
</a><a href="#h78-2-58" id="h78-2-58" class="i">+        ),
</a><a href="#h78-2-59" id="h78-2-59" class="i">+        Some(
</a><a href="#h78-2-60" id="h78-2-60" class="i">+            (
</a><a href="#h78-2-61" id="h78-2-61" class="i">+                Some(
</a><a href="#h78-2-62" id="h78-2-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h78-2-63" id="h78-2-63" class="i">+                ),
</a><a href="#h78-2-64" id="h78-2-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h78-2-65" id="h78-2-65" class="i">+            ),
</a><a href="#h78-2-66" id="h78-2-66" class="i">+        ),
</a><a href="#h78-2-67" id="h78-2-67" class="i">+    ],
</a><a href="#h78-2-68" id="h78-2-68" class="i">+}
</a> 
<b>diff --git a/<a id="h79" href="../file/tests/sql/query/offset_expr.html">tests/sql/query/offset_expr</a> b/<a href="../file/tests/sql/query/offset_expr.html">tests/sql/query/offset_expr</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -44,8 +44,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h79-0-3" id="h79-0-3" class="d">-Plan: Select(
</a><a href="#h79-0-4" id="h79-0-4" class="d">-    Offset {
</a><a href="#h79-0-5" id="h79-0-5" class="i">+Plan: Select {
</a><a href="#h79-0-6" id="h79-0-6" class="i">+    root: Offset {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h79-1" id="h79-1" class="h">@@ -124,15 +124,73 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h79-1-3" id="h79-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h79-1-5" id="h79-1-5" class="i">+            alias: None,
</a>         },
         offset: 3,
     },
<a href="#h79-1-9" id="h79-1-9" class="d">-)
</a><a href="#h79-1-10" id="h79-1-10" class="i">+    labels: [
</a><a href="#h79-1-11" id="h79-1-11" class="i">+        Some(
</a><a href="#h79-1-12" id="h79-1-12" class="i">+            (
</a><a href="#h79-1-13" id="h79-1-13" class="i">+                Some(
</a><a href="#h79-1-14" id="h79-1-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-1-15" id="h79-1-15" class="i">+                ),
</a><a href="#h79-1-16" id="h79-1-16" class="i">+                &quot;id&quot;,
</a><a href="#h79-1-17" id="h79-1-17" class="i">+            ),
</a><a href="#h79-1-18" id="h79-1-18" class="i">+        ),
</a><a href="#h79-1-19" id="h79-1-19" class="i">+        Some(
</a><a href="#h79-1-20" id="h79-1-20" class="i">+            (
</a><a href="#h79-1-21" id="h79-1-21" class="i">+                Some(
</a><a href="#h79-1-22" id="h79-1-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-1-23" id="h79-1-23" class="i">+                ),
</a><a href="#h79-1-24" id="h79-1-24" class="i">+                &quot;title&quot;,
</a><a href="#h79-1-25" id="h79-1-25" class="i">+            ),
</a><a href="#h79-1-26" id="h79-1-26" class="i">+        ),
</a><a href="#h79-1-27" id="h79-1-27" class="i">+        Some(
</a><a href="#h79-1-28" id="h79-1-28" class="i">+            (
</a><a href="#h79-1-29" id="h79-1-29" class="i">+                Some(
</a><a href="#h79-1-30" id="h79-1-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-1-31" id="h79-1-31" class="i">+                ),
</a><a href="#h79-1-32" id="h79-1-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h79-1-33" id="h79-1-33" class="i">+            ),
</a><a href="#h79-1-34" id="h79-1-34" class="i">+        ),
</a><a href="#h79-1-35" id="h79-1-35" class="i">+        Some(
</a><a href="#h79-1-36" id="h79-1-36" class="i">+            (
</a><a href="#h79-1-37" id="h79-1-37" class="i">+                Some(
</a><a href="#h79-1-38" id="h79-1-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-1-39" id="h79-1-39" class="i">+                ),
</a><a href="#h79-1-40" id="h79-1-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h79-1-41" id="h79-1-41" class="i">+            ),
</a><a href="#h79-1-42" id="h79-1-42" class="i">+        ),
</a><a href="#h79-1-43" id="h79-1-43" class="i">+        Some(
</a><a href="#h79-1-44" id="h79-1-44" class="i">+            (
</a><a href="#h79-1-45" id="h79-1-45" class="i">+                Some(
</a><a href="#h79-1-46" id="h79-1-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-1-47" id="h79-1-47" class="i">+                ),
</a><a href="#h79-1-48" id="h79-1-48" class="i">+                &quot;released&quot;,
</a><a href="#h79-1-49" id="h79-1-49" class="i">+            ),
</a><a href="#h79-1-50" id="h79-1-50" class="i">+        ),
</a><a href="#h79-1-51" id="h79-1-51" class="i">+        Some(
</a><a href="#h79-1-52" id="h79-1-52" class="i">+            (
</a><a href="#h79-1-53" id="h79-1-53" class="i">+                Some(
</a><a href="#h79-1-54" id="h79-1-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-1-55" id="h79-1-55" class="i">+                ),
</a><a href="#h79-1-56" id="h79-1-56" class="i">+                &quot;rating&quot;,
</a><a href="#h79-1-57" id="h79-1-57" class="i">+            ),
</a><a href="#h79-1-58" id="h79-1-58" class="i">+        ),
</a><a href="#h79-1-59" id="h79-1-59" class="i">+        Some(
</a><a href="#h79-1-60" id="h79-1-60" class="i">+            (
</a><a href="#h79-1-61" id="h79-1-61" class="i">+                Some(
</a><a href="#h79-1-62" id="h79-1-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-1-63" id="h79-1-63" class="i">+                ),
</a><a href="#h79-1-64" id="h79-1-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h79-1-65" id="h79-1-65" class="i">+            ),
</a><a href="#h79-1-66" id="h79-1-66" class="i">+        ),
</a><a href="#h79-1-67" id="h79-1-67" class="i">+    ],
</a><a href="#h79-1-68" id="h79-1-68" class="i">+}
</a> 
<a href="#h79-1-70" id="h79-1-70" class="d">-Optimized plan: Select(
</a><a href="#h79-1-71" id="h79-1-71" class="d">-    Offset {
</a><a href="#h79-1-72" id="h79-1-72" class="i">+Optimized plan: Select {
</a><a href="#h79-1-73" id="h79-1-73" class="i">+    root: Offset {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h79-2" id="h79-2" class="h">@@ -211,10 +269,68 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h79-2-3" id="h79-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h79-2-5" id="h79-2-5" class="i">+            alias: None,
</a>         },
         offset: 3,
     },
<a href="#h79-2-9" id="h79-2-9" class="d">-)
</a><a href="#h79-2-10" id="h79-2-10" class="i">+    labels: [
</a><a href="#h79-2-11" id="h79-2-11" class="i">+        Some(
</a><a href="#h79-2-12" id="h79-2-12" class="i">+            (
</a><a href="#h79-2-13" id="h79-2-13" class="i">+                Some(
</a><a href="#h79-2-14" id="h79-2-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-2-15" id="h79-2-15" class="i">+                ),
</a><a href="#h79-2-16" id="h79-2-16" class="i">+                &quot;id&quot;,
</a><a href="#h79-2-17" id="h79-2-17" class="i">+            ),
</a><a href="#h79-2-18" id="h79-2-18" class="i">+        ),
</a><a href="#h79-2-19" id="h79-2-19" class="i">+        Some(
</a><a href="#h79-2-20" id="h79-2-20" class="i">+            (
</a><a href="#h79-2-21" id="h79-2-21" class="i">+                Some(
</a><a href="#h79-2-22" id="h79-2-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-2-23" id="h79-2-23" class="i">+                ),
</a><a href="#h79-2-24" id="h79-2-24" class="i">+                &quot;title&quot;,
</a><a href="#h79-2-25" id="h79-2-25" class="i">+            ),
</a><a href="#h79-2-26" id="h79-2-26" class="i">+        ),
</a><a href="#h79-2-27" id="h79-2-27" class="i">+        Some(
</a><a href="#h79-2-28" id="h79-2-28" class="i">+            (
</a><a href="#h79-2-29" id="h79-2-29" class="i">+                Some(
</a><a href="#h79-2-30" id="h79-2-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-2-31" id="h79-2-31" class="i">+                ),
</a><a href="#h79-2-32" id="h79-2-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h79-2-33" id="h79-2-33" class="i">+            ),
</a><a href="#h79-2-34" id="h79-2-34" class="i">+        ),
</a><a href="#h79-2-35" id="h79-2-35" class="i">+        Some(
</a><a href="#h79-2-36" id="h79-2-36" class="i">+            (
</a><a href="#h79-2-37" id="h79-2-37" class="i">+                Some(
</a><a href="#h79-2-38" id="h79-2-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-2-39" id="h79-2-39" class="i">+                ),
</a><a href="#h79-2-40" id="h79-2-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h79-2-41" id="h79-2-41" class="i">+            ),
</a><a href="#h79-2-42" id="h79-2-42" class="i">+        ),
</a><a href="#h79-2-43" id="h79-2-43" class="i">+        Some(
</a><a href="#h79-2-44" id="h79-2-44" class="i">+            (
</a><a href="#h79-2-45" id="h79-2-45" class="i">+                Some(
</a><a href="#h79-2-46" id="h79-2-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-2-47" id="h79-2-47" class="i">+                ),
</a><a href="#h79-2-48" id="h79-2-48" class="i">+                &quot;released&quot;,
</a><a href="#h79-2-49" id="h79-2-49" class="i">+            ),
</a><a href="#h79-2-50" id="h79-2-50" class="i">+        ),
</a><a href="#h79-2-51" id="h79-2-51" class="i">+        Some(
</a><a href="#h79-2-52" id="h79-2-52" class="i">+            (
</a><a href="#h79-2-53" id="h79-2-53" class="i">+                Some(
</a><a href="#h79-2-54" id="h79-2-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-2-55" id="h79-2-55" class="i">+                ),
</a><a href="#h79-2-56" id="h79-2-56" class="i">+                &quot;rating&quot;,
</a><a href="#h79-2-57" id="h79-2-57" class="i">+            ),
</a><a href="#h79-2-58" id="h79-2-58" class="i">+        ),
</a><a href="#h79-2-59" id="h79-2-59" class="i">+        Some(
</a><a href="#h79-2-60" id="h79-2-60" class="i">+            (
</a><a href="#h79-2-61" id="h79-2-61" class="i">+                Some(
</a><a href="#h79-2-62" id="h79-2-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h79-2-63" id="h79-2-63" class="i">+                ),
</a><a href="#h79-2-64" id="h79-2-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h79-2-65" id="h79-2-65" class="i">+            ),
</a><a href="#h79-2-66" id="h79-2-66" class="i">+        ),
</a><a href="#h79-2-67" id="h79-2-67" class="i">+    ],
</a><a href="#h79-2-68" id="h79-2-68" class="i">+}
</a> 
<b>diff --git a/<a id="h80" href="../file/tests/sql/query/offset_large.html">tests/sql/query/offset_large</a> b/<a href="../file/tests/sql/query/offset_large.html">tests/sql/query/offset_large</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -28,8 +28,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h80-0-3" id="h80-0-3" class="d">-Plan: Select(
</a><a href="#h80-0-4" id="h80-0-4" class="d">-    Offset {
</a><a href="#h80-0-5" id="h80-0-5" class="i">+Plan: Select {
</a><a href="#h80-0-6" id="h80-0-6" class="i">+    root: Offset {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h80-1" id="h80-1" class="h">@@ -108,15 +108,73 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h80-1-3" id="h80-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h80-1-5" id="h80-1-5" class="i">+            alias: None,
</a>         },
         offset: 9223372036854775807,
     },
<a href="#h80-1-9" id="h80-1-9" class="d">-)
</a><a href="#h80-1-10" id="h80-1-10" class="i">+    labels: [
</a><a href="#h80-1-11" id="h80-1-11" class="i">+        Some(
</a><a href="#h80-1-12" id="h80-1-12" class="i">+            (
</a><a href="#h80-1-13" id="h80-1-13" class="i">+                Some(
</a><a href="#h80-1-14" id="h80-1-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-1-15" id="h80-1-15" class="i">+                ),
</a><a href="#h80-1-16" id="h80-1-16" class="i">+                &quot;id&quot;,
</a><a href="#h80-1-17" id="h80-1-17" class="i">+            ),
</a><a href="#h80-1-18" id="h80-1-18" class="i">+        ),
</a><a href="#h80-1-19" id="h80-1-19" class="i">+        Some(
</a><a href="#h80-1-20" id="h80-1-20" class="i">+            (
</a><a href="#h80-1-21" id="h80-1-21" class="i">+                Some(
</a><a href="#h80-1-22" id="h80-1-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-1-23" id="h80-1-23" class="i">+                ),
</a><a href="#h80-1-24" id="h80-1-24" class="i">+                &quot;title&quot;,
</a><a href="#h80-1-25" id="h80-1-25" class="i">+            ),
</a><a href="#h80-1-26" id="h80-1-26" class="i">+        ),
</a><a href="#h80-1-27" id="h80-1-27" class="i">+        Some(
</a><a href="#h80-1-28" id="h80-1-28" class="i">+            (
</a><a href="#h80-1-29" id="h80-1-29" class="i">+                Some(
</a><a href="#h80-1-30" id="h80-1-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-1-31" id="h80-1-31" class="i">+                ),
</a><a href="#h80-1-32" id="h80-1-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h80-1-33" id="h80-1-33" class="i">+            ),
</a><a href="#h80-1-34" id="h80-1-34" class="i">+        ),
</a><a href="#h80-1-35" id="h80-1-35" class="i">+        Some(
</a><a href="#h80-1-36" id="h80-1-36" class="i">+            (
</a><a href="#h80-1-37" id="h80-1-37" class="i">+                Some(
</a><a href="#h80-1-38" id="h80-1-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-1-39" id="h80-1-39" class="i">+                ),
</a><a href="#h80-1-40" id="h80-1-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h80-1-41" id="h80-1-41" class="i">+            ),
</a><a href="#h80-1-42" id="h80-1-42" class="i">+        ),
</a><a href="#h80-1-43" id="h80-1-43" class="i">+        Some(
</a><a href="#h80-1-44" id="h80-1-44" class="i">+            (
</a><a href="#h80-1-45" id="h80-1-45" class="i">+                Some(
</a><a href="#h80-1-46" id="h80-1-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-1-47" id="h80-1-47" class="i">+                ),
</a><a href="#h80-1-48" id="h80-1-48" class="i">+                &quot;released&quot;,
</a><a href="#h80-1-49" id="h80-1-49" class="i">+            ),
</a><a href="#h80-1-50" id="h80-1-50" class="i">+        ),
</a><a href="#h80-1-51" id="h80-1-51" class="i">+        Some(
</a><a href="#h80-1-52" id="h80-1-52" class="i">+            (
</a><a href="#h80-1-53" id="h80-1-53" class="i">+                Some(
</a><a href="#h80-1-54" id="h80-1-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-1-55" id="h80-1-55" class="i">+                ),
</a><a href="#h80-1-56" id="h80-1-56" class="i">+                &quot;rating&quot;,
</a><a href="#h80-1-57" id="h80-1-57" class="i">+            ),
</a><a href="#h80-1-58" id="h80-1-58" class="i">+        ),
</a><a href="#h80-1-59" id="h80-1-59" class="i">+        Some(
</a><a href="#h80-1-60" id="h80-1-60" class="i">+            (
</a><a href="#h80-1-61" id="h80-1-61" class="i">+                Some(
</a><a href="#h80-1-62" id="h80-1-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-1-63" id="h80-1-63" class="i">+                ),
</a><a href="#h80-1-64" id="h80-1-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h80-1-65" id="h80-1-65" class="i">+            ),
</a><a href="#h80-1-66" id="h80-1-66" class="i">+        ),
</a><a href="#h80-1-67" id="h80-1-67" class="i">+    ],
</a><a href="#h80-1-68" id="h80-1-68" class="i">+}
</a> 
<a href="#h80-1-70" id="h80-1-70" class="d">-Optimized plan: Select(
</a><a href="#h80-1-71" id="h80-1-71" class="d">-    Offset {
</a><a href="#h80-1-72" id="h80-1-72" class="i">+Optimized plan: Select {
</a><a href="#h80-1-73" id="h80-1-73" class="i">+    root: Offset {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h80-2" id="h80-2" class="h">@@ -195,10 +253,68 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h80-2-3" id="h80-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h80-2-5" id="h80-2-5" class="i">+            alias: None,
</a>         },
         offset: 9223372036854775807,
     },
<a href="#h80-2-9" id="h80-2-9" class="d">-)
</a><a href="#h80-2-10" id="h80-2-10" class="i">+    labels: [
</a><a href="#h80-2-11" id="h80-2-11" class="i">+        Some(
</a><a href="#h80-2-12" id="h80-2-12" class="i">+            (
</a><a href="#h80-2-13" id="h80-2-13" class="i">+                Some(
</a><a href="#h80-2-14" id="h80-2-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-2-15" id="h80-2-15" class="i">+                ),
</a><a href="#h80-2-16" id="h80-2-16" class="i">+                &quot;id&quot;,
</a><a href="#h80-2-17" id="h80-2-17" class="i">+            ),
</a><a href="#h80-2-18" id="h80-2-18" class="i">+        ),
</a><a href="#h80-2-19" id="h80-2-19" class="i">+        Some(
</a><a href="#h80-2-20" id="h80-2-20" class="i">+            (
</a><a href="#h80-2-21" id="h80-2-21" class="i">+                Some(
</a><a href="#h80-2-22" id="h80-2-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-2-23" id="h80-2-23" class="i">+                ),
</a><a href="#h80-2-24" id="h80-2-24" class="i">+                &quot;title&quot;,
</a><a href="#h80-2-25" id="h80-2-25" class="i">+            ),
</a><a href="#h80-2-26" id="h80-2-26" class="i">+        ),
</a><a href="#h80-2-27" id="h80-2-27" class="i">+        Some(
</a><a href="#h80-2-28" id="h80-2-28" class="i">+            (
</a><a href="#h80-2-29" id="h80-2-29" class="i">+                Some(
</a><a href="#h80-2-30" id="h80-2-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-2-31" id="h80-2-31" class="i">+                ),
</a><a href="#h80-2-32" id="h80-2-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h80-2-33" id="h80-2-33" class="i">+            ),
</a><a href="#h80-2-34" id="h80-2-34" class="i">+        ),
</a><a href="#h80-2-35" id="h80-2-35" class="i">+        Some(
</a><a href="#h80-2-36" id="h80-2-36" class="i">+            (
</a><a href="#h80-2-37" id="h80-2-37" class="i">+                Some(
</a><a href="#h80-2-38" id="h80-2-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-2-39" id="h80-2-39" class="i">+                ),
</a><a href="#h80-2-40" id="h80-2-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h80-2-41" id="h80-2-41" class="i">+            ),
</a><a href="#h80-2-42" id="h80-2-42" class="i">+        ),
</a><a href="#h80-2-43" id="h80-2-43" class="i">+        Some(
</a><a href="#h80-2-44" id="h80-2-44" class="i">+            (
</a><a href="#h80-2-45" id="h80-2-45" class="i">+                Some(
</a><a href="#h80-2-46" id="h80-2-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-2-47" id="h80-2-47" class="i">+                ),
</a><a href="#h80-2-48" id="h80-2-48" class="i">+                &quot;released&quot;,
</a><a href="#h80-2-49" id="h80-2-49" class="i">+            ),
</a><a href="#h80-2-50" id="h80-2-50" class="i">+        ),
</a><a href="#h80-2-51" id="h80-2-51" class="i">+        Some(
</a><a href="#h80-2-52" id="h80-2-52" class="i">+            (
</a><a href="#h80-2-53" id="h80-2-53" class="i">+                Some(
</a><a href="#h80-2-54" id="h80-2-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-2-55" id="h80-2-55" class="i">+                ),
</a><a href="#h80-2-56" id="h80-2-56" class="i">+                &quot;rating&quot;,
</a><a href="#h80-2-57" id="h80-2-57" class="i">+            ),
</a><a href="#h80-2-58" id="h80-2-58" class="i">+        ),
</a><a href="#h80-2-59" id="h80-2-59" class="i">+        Some(
</a><a href="#h80-2-60" id="h80-2-60" class="i">+            (
</a><a href="#h80-2-61" id="h80-2-61" class="i">+                Some(
</a><a href="#h80-2-62" id="h80-2-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h80-2-63" id="h80-2-63" class="i">+                ),
</a><a href="#h80-2-64" id="h80-2-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h80-2-65" id="h80-2-65" class="i">+            ),
</a><a href="#h80-2-66" id="h80-2-66" class="i">+        ),
</a><a href="#h80-2-67" id="h80-2-67" class="i">+    ],
</a><a href="#h80-2-68" id="h80-2-68" class="i">+}
</a> 
<b>diff --git a/<a id="h81" href="../file/tests/sql/query/offset_zero.html">tests/sql/query/offset_zero</a> b/<a href="../file/tests/sql/query/offset_zero.html">tests/sql/query/offset_zero</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -38,8 +38,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h81-0-3" id="h81-0-3" class="d">-Plan: Select(
</a><a href="#h81-0-4" id="h81-0-4" class="d">-    Offset {
</a><a href="#h81-0-5" id="h81-0-5" class="i">+Plan: Select {
</a><a href="#h81-0-6" id="h81-0-6" class="i">+    root: Offset {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h81-1" id="h81-1" class="h">@@ -118,15 +118,73 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h81-1-3" id="h81-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h81-1-5" id="h81-1-5" class="i">+            alias: None,
</a>         },
         offset: 0,
     },
<a href="#h81-1-9" id="h81-1-9" class="d">-)
</a><a href="#h81-1-10" id="h81-1-10" class="i">+    labels: [
</a><a href="#h81-1-11" id="h81-1-11" class="i">+        Some(
</a><a href="#h81-1-12" id="h81-1-12" class="i">+            (
</a><a href="#h81-1-13" id="h81-1-13" class="i">+                Some(
</a><a href="#h81-1-14" id="h81-1-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-1-15" id="h81-1-15" class="i">+                ),
</a><a href="#h81-1-16" id="h81-1-16" class="i">+                &quot;id&quot;,
</a><a href="#h81-1-17" id="h81-1-17" class="i">+            ),
</a><a href="#h81-1-18" id="h81-1-18" class="i">+        ),
</a><a href="#h81-1-19" id="h81-1-19" class="i">+        Some(
</a><a href="#h81-1-20" id="h81-1-20" class="i">+            (
</a><a href="#h81-1-21" id="h81-1-21" class="i">+                Some(
</a><a href="#h81-1-22" id="h81-1-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-1-23" id="h81-1-23" class="i">+                ),
</a><a href="#h81-1-24" id="h81-1-24" class="i">+                &quot;title&quot;,
</a><a href="#h81-1-25" id="h81-1-25" class="i">+            ),
</a><a href="#h81-1-26" id="h81-1-26" class="i">+        ),
</a><a href="#h81-1-27" id="h81-1-27" class="i">+        Some(
</a><a href="#h81-1-28" id="h81-1-28" class="i">+            (
</a><a href="#h81-1-29" id="h81-1-29" class="i">+                Some(
</a><a href="#h81-1-30" id="h81-1-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-1-31" id="h81-1-31" class="i">+                ),
</a><a href="#h81-1-32" id="h81-1-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h81-1-33" id="h81-1-33" class="i">+            ),
</a><a href="#h81-1-34" id="h81-1-34" class="i">+        ),
</a><a href="#h81-1-35" id="h81-1-35" class="i">+        Some(
</a><a href="#h81-1-36" id="h81-1-36" class="i">+            (
</a><a href="#h81-1-37" id="h81-1-37" class="i">+                Some(
</a><a href="#h81-1-38" id="h81-1-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-1-39" id="h81-1-39" class="i">+                ),
</a><a href="#h81-1-40" id="h81-1-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h81-1-41" id="h81-1-41" class="i">+            ),
</a><a href="#h81-1-42" id="h81-1-42" class="i">+        ),
</a><a href="#h81-1-43" id="h81-1-43" class="i">+        Some(
</a><a href="#h81-1-44" id="h81-1-44" class="i">+            (
</a><a href="#h81-1-45" id="h81-1-45" class="i">+                Some(
</a><a href="#h81-1-46" id="h81-1-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-1-47" id="h81-1-47" class="i">+                ),
</a><a href="#h81-1-48" id="h81-1-48" class="i">+                &quot;released&quot;,
</a><a href="#h81-1-49" id="h81-1-49" class="i">+            ),
</a><a href="#h81-1-50" id="h81-1-50" class="i">+        ),
</a><a href="#h81-1-51" id="h81-1-51" class="i">+        Some(
</a><a href="#h81-1-52" id="h81-1-52" class="i">+            (
</a><a href="#h81-1-53" id="h81-1-53" class="i">+                Some(
</a><a href="#h81-1-54" id="h81-1-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-1-55" id="h81-1-55" class="i">+                ),
</a><a href="#h81-1-56" id="h81-1-56" class="i">+                &quot;rating&quot;,
</a><a href="#h81-1-57" id="h81-1-57" class="i">+            ),
</a><a href="#h81-1-58" id="h81-1-58" class="i">+        ),
</a><a href="#h81-1-59" id="h81-1-59" class="i">+        Some(
</a><a href="#h81-1-60" id="h81-1-60" class="i">+            (
</a><a href="#h81-1-61" id="h81-1-61" class="i">+                Some(
</a><a href="#h81-1-62" id="h81-1-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-1-63" id="h81-1-63" class="i">+                ),
</a><a href="#h81-1-64" id="h81-1-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h81-1-65" id="h81-1-65" class="i">+            ),
</a><a href="#h81-1-66" id="h81-1-66" class="i">+        ),
</a><a href="#h81-1-67" id="h81-1-67" class="i">+    ],
</a><a href="#h81-1-68" id="h81-1-68" class="i">+}
</a> 
<a href="#h81-1-70" id="h81-1-70" class="d">-Optimized plan: Select(
</a><a href="#h81-1-71" id="h81-1-71" class="d">-    Offset {
</a><a href="#h81-1-72" id="h81-1-72" class="i">+Optimized plan: Select {
</a><a href="#h81-1-73" id="h81-1-73" class="i">+    root: Offset {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h81-2" id="h81-2" class="h">@@ -205,10 +263,68 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h81-2-3" id="h81-2-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h81-2-5" id="h81-2-5" class="i">+            alias: None,
</a>         },
         offset: 0,
     },
<a href="#h81-2-9" id="h81-2-9" class="d">-)
</a><a href="#h81-2-10" id="h81-2-10" class="i">+    labels: [
</a><a href="#h81-2-11" id="h81-2-11" class="i">+        Some(
</a><a href="#h81-2-12" id="h81-2-12" class="i">+            (
</a><a href="#h81-2-13" id="h81-2-13" class="i">+                Some(
</a><a href="#h81-2-14" id="h81-2-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-2-15" id="h81-2-15" class="i">+                ),
</a><a href="#h81-2-16" id="h81-2-16" class="i">+                &quot;id&quot;,
</a><a href="#h81-2-17" id="h81-2-17" class="i">+            ),
</a><a href="#h81-2-18" id="h81-2-18" class="i">+        ),
</a><a href="#h81-2-19" id="h81-2-19" class="i">+        Some(
</a><a href="#h81-2-20" id="h81-2-20" class="i">+            (
</a><a href="#h81-2-21" id="h81-2-21" class="i">+                Some(
</a><a href="#h81-2-22" id="h81-2-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-2-23" id="h81-2-23" class="i">+                ),
</a><a href="#h81-2-24" id="h81-2-24" class="i">+                &quot;title&quot;,
</a><a href="#h81-2-25" id="h81-2-25" class="i">+            ),
</a><a href="#h81-2-26" id="h81-2-26" class="i">+        ),
</a><a href="#h81-2-27" id="h81-2-27" class="i">+        Some(
</a><a href="#h81-2-28" id="h81-2-28" class="i">+            (
</a><a href="#h81-2-29" id="h81-2-29" class="i">+                Some(
</a><a href="#h81-2-30" id="h81-2-30" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-2-31" id="h81-2-31" class="i">+                ),
</a><a href="#h81-2-32" id="h81-2-32" class="i">+                &quot;studio_id&quot;,
</a><a href="#h81-2-33" id="h81-2-33" class="i">+            ),
</a><a href="#h81-2-34" id="h81-2-34" class="i">+        ),
</a><a href="#h81-2-35" id="h81-2-35" class="i">+        Some(
</a><a href="#h81-2-36" id="h81-2-36" class="i">+            (
</a><a href="#h81-2-37" id="h81-2-37" class="i">+                Some(
</a><a href="#h81-2-38" id="h81-2-38" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-2-39" id="h81-2-39" class="i">+                ),
</a><a href="#h81-2-40" id="h81-2-40" class="i">+                &quot;genre_id&quot;,
</a><a href="#h81-2-41" id="h81-2-41" class="i">+            ),
</a><a href="#h81-2-42" id="h81-2-42" class="i">+        ),
</a><a href="#h81-2-43" id="h81-2-43" class="i">+        Some(
</a><a href="#h81-2-44" id="h81-2-44" class="i">+            (
</a><a href="#h81-2-45" id="h81-2-45" class="i">+                Some(
</a><a href="#h81-2-46" id="h81-2-46" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-2-47" id="h81-2-47" class="i">+                ),
</a><a href="#h81-2-48" id="h81-2-48" class="i">+                &quot;released&quot;,
</a><a href="#h81-2-49" id="h81-2-49" class="i">+            ),
</a><a href="#h81-2-50" id="h81-2-50" class="i">+        ),
</a><a href="#h81-2-51" id="h81-2-51" class="i">+        Some(
</a><a href="#h81-2-52" id="h81-2-52" class="i">+            (
</a><a href="#h81-2-53" id="h81-2-53" class="i">+                Some(
</a><a href="#h81-2-54" id="h81-2-54" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-2-55" id="h81-2-55" class="i">+                ),
</a><a href="#h81-2-56" id="h81-2-56" class="i">+                &quot;rating&quot;,
</a><a href="#h81-2-57" id="h81-2-57" class="i">+            ),
</a><a href="#h81-2-58" id="h81-2-58" class="i">+        ),
</a><a href="#h81-2-59" id="h81-2-59" class="i">+        Some(
</a><a href="#h81-2-60" id="h81-2-60" class="i">+            (
</a><a href="#h81-2-61" id="h81-2-61" class="i">+                Some(
</a><a href="#h81-2-62" id="h81-2-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h81-2-63" id="h81-2-63" class="i">+                ),
</a><a href="#h81-2-64" id="h81-2-64" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h81-2-65" id="h81-2-65" class="i">+            ),
</a><a href="#h81-2-66" id="h81-2-66" class="i">+        ),
</a><a href="#h81-2-67" id="h81-2-67" class="i">+    ],
</a><a href="#h81-2-68" id="h81-2-68" class="i">+}
</a> 
<b>diff --git a/<a id="h82" href="../file/tests/sql/query/order.html">tests/sql/query/order</a> b/<a href="../file/tests/sql/query/order.html">tests/sql/query/order</a></b>
<a href="#h82-0" id="h82-0" class="h">@@ -40,8 +40,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h82-0-3" id="h82-0-3" class="d">-Plan: Select(
</a><a href="#h82-0-4" id="h82-0-4" class="d">-    Order {
</a><a href="#h82-0-5" id="h82-0-5" class="i">+Plan: Select {
</a><a href="#h82-0-6" id="h82-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h82-1" id="h82-1" class="h">@@ -120,8 +120,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h82-1-3" id="h82-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h82-1-5" id="h82-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h82-2" id="h82-2" class="h">@@ -138,10 +138,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h82-2-3" id="h82-2-3" class="d">-)
</a><a href="#h82-2-4" id="h82-2-4" class="i">+    labels: [
</a><a href="#h82-2-5" id="h82-2-5" class="i">+        Some(
</a><a href="#h82-2-6" id="h82-2-6" class="i">+            (
</a><a href="#h82-2-7" id="h82-2-7" class="i">+                Some(
</a><a href="#h82-2-8" id="h82-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-2-9" id="h82-2-9" class="i">+                ),
</a><a href="#h82-2-10" id="h82-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h82-2-11" id="h82-2-11" class="i">+            ),
</a><a href="#h82-2-12" id="h82-2-12" class="i">+        ),
</a><a href="#h82-2-13" id="h82-2-13" class="i">+        Some(
</a><a href="#h82-2-14" id="h82-2-14" class="i">+            (
</a><a href="#h82-2-15" id="h82-2-15" class="i">+                Some(
</a><a href="#h82-2-16" id="h82-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-2-17" id="h82-2-17" class="i">+                ),
</a><a href="#h82-2-18" id="h82-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h82-2-19" id="h82-2-19" class="i">+            ),
</a><a href="#h82-2-20" id="h82-2-20" class="i">+        ),
</a><a href="#h82-2-21" id="h82-2-21" class="i">+        Some(
</a><a href="#h82-2-22" id="h82-2-22" class="i">+            (
</a><a href="#h82-2-23" id="h82-2-23" class="i">+                Some(
</a><a href="#h82-2-24" id="h82-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-2-25" id="h82-2-25" class="i">+                ),
</a><a href="#h82-2-26" id="h82-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h82-2-27" id="h82-2-27" class="i">+            ),
</a><a href="#h82-2-28" id="h82-2-28" class="i">+        ),
</a><a href="#h82-2-29" id="h82-2-29" class="i">+        Some(
</a><a href="#h82-2-30" id="h82-2-30" class="i">+            (
</a><a href="#h82-2-31" id="h82-2-31" class="i">+                Some(
</a><a href="#h82-2-32" id="h82-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-2-33" id="h82-2-33" class="i">+                ),
</a><a href="#h82-2-34" id="h82-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h82-2-35" id="h82-2-35" class="i">+            ),
</a><a href="#h82-2-36" id="h82-2-36" class="i">+        ),
</a><a href="#h82-2-37" id="h82-2-37" class="i">+        Some(
</a><a href="#h82-2-38" id="h82-2-38" class="i">+            (
</a><a href="#h82-2-39" id="h82-2-39" class="i">+                Some(
</a><a href="#h82-2-40" id="h82-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-2-41" id="h82-2-41" class="i">+                ),
</a><a href="#h82-2-42" id="h82-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h82-2-43" id="h82-2-43" class="i">+            ),
</a><a href="#h82-2-44" id="h82-2-44" class="i">+        ),
</a><a href="#h82-2-45" id="h82-2-45" class="i">+        Some(
</a><a href="#h82-2-46" id="h82-2-46" class="i">+            (
</a><a href="#h82-2-47" id="h82-2-47" class="i">+                Some(
</a><a href="#h82-2-48" id="h82-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-2-49" id="h82-2-49" class="i">+                ),
</a><a href="#h82-2-50" id="h82-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h82-2-51" id="h82-2-51" class="i">+            ),
</a><a href="#h82-2-52" id="h82-2-52" class="i">+        ),
</a><a href="#h82-2-53" id="h82-2-53" class="i">+        Some(
</a><a href="#h82-2-54" id="h82-2-54" class="i">+            (
</a><a href="#h82-2-55" id="h82-2-55" class="i">+                Some(
</a><a href="#h82-2-56" id="h82-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-2-57" id="h82-2-57" class="i">+                ),
</a><a href="#h82-2-58" id="h82-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h82-2-59" id="h82-2-59" class="i">+            ),
</a><a href="#h82-2-60" id="h82-2-60" class="i">+        ),
</a><a href="#h82-2-61" id="h82-2-61" class="i">+    ],
</a><a href="#h82-2-62" id="h82-2-62" class="i">+}
</a> 
<a href="#h82-2-64" id="h82-2-64" class="d">-Optimized plan: Select(
</a><a href="#h82-2-65" id="h82-2-65" class="d">-    Order {
</a><a href="#h82-2-66" id="h82-2-66" class="i">+Optimized plan: Select {
</a><a href="#h82-2-67" id="h82-2-67" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h82-3" id="h82-3" class="h">@@ -220,8 +278,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h82-3-3" id="h82-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h82-3-5" id="h82-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h82-4" id="h82-4" class="h">@@ -238,5 +296,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h82-4-3" id="h82-4-3" class="d">-)
</a><a href="#h82-4-4" id="h82-4-4" class="i">+    labels: [
</a><a href="#h82-4-5" id="h82-4-5" class="i">+        Some(
</a><a href="#h82-4-6" id="h82-4-6" class="i">+            (
</a><a href="#h82-4-7" id="h82-4-7" class="i">+                Some(
</a><a href="#h82-4-8" id="h82-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-4-9" id="h82-4-9" class="i">+                ),
</a><a href="#h82-4-10" id="h82-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h82-4-11" id="h82-4-11" class="i">+            ),
</a><a href="#h82-4-12" id="h82-4-12" class="i">+        ),
</a><a href="#h82-4-13" id="h82-4-13" class="i">+        Some(
</a><a href="#h82-4-14" id="h82-4-14" class="i">+            (
</a><a href="#h82-4-15" id="h82-4-15" class="i">+                Some(
</a><a href="#h82-4-16" id="h82-4-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-4-17" id="h82-4-17" class="i">+                ),
</a><a href="#h82-4-18" id="h82-4-18" class="i">+                &quot;title&quot;,
</a><a href="#h82-4-19" id="h82-4-19" class="i">+            ),
</a><a href="#h82-4-20" id="h82-4-20" class="i">+        ),
</a><a href="#h82-4-21" id="h82-4-21" class="i">+        Some(
</a><a href="#h82-4-22" id="h82-4-22" class="i">+            (
</a><a href="#h82-4-23" id="h82-4-23" class="i">+                Some(
</a><a href="#h82-4-24" id="h82-4-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-4-25" id="h82-4-25" class="i">+                ),
</a><a href="#h82-4-26" id="h82-4-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h82-4-27" id="h82-4-27" class="i">+            ),
</a><a href="#h82-4-28" id="h82-4-28" class="i">+        ),
</a><a href="#h82-4-29" id="h82-4-29" class="i">+        Some(
</a><a href="#h82-4-30" id="h82-4-30" class="i">+            (
</a><a href="#h82-4-31" id="h82-4-31" class="i">+                Some(
</a><a href="#h82-4-32" id="h82-4-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-4-33" id="h82-4-33" class="i">+                ),
</a><a href="#h82-4-34" id="h82-4-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h82-4-35" id="h82-4-35" class="i">+            ),
</a><a href="#h82-4-36" id="h82-4-36" class="i">+        ),
</a><a href="#h82-4-37" id="h82-4-37" class="i">+        Some(
</a><a href="#h82-4-38" id="h82-4-38" class="i">+            (
</a><a href="#h82-4-39" id="h82-4-39" class="i">+                Some(
</a><a href="#h82-4-40" id="h82-4-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-4-41" id="h82-4-41" class="i">+                ),
</a><a href="#h82-4-42" id="h82-4-42" class="i">+                &quot;released&quot;,
</a><a href="#h82-4-43" id="h82-4-43" class="i">+            ),
</a><a href="#h82-4-44" id="h82-4-44" class="i">+        ),
</a><a href="#h82-4-45" id="h82-4-45" class="i">+        Some(
</a><a href="#h82-4-46" id="h82-4-46" class="i">+            (
</a><a href="#h82-4-47" id="h82-4-47" class="i">+                Some(
</a><a href="#h82-4-48" id="h82-4-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-4-49" id="h82-4-49" class="i">+                ),
</a><a href="#h82-4-50" id="h82-4-50" class="i">+                &quot;rating&quot;,
</a><a href="#h82-4-51" id="h82-4-51" class="i">+            ),
</a><a href="#h82-4-52" id="h82-4-52" class="i">+        ),
</a><a href="#h82-4-53" id="h82-4-53" class="i">+        Some(
</a><a href="#h82-4-54" id="h82-4-54" class="i">+            (
</a><a href="#h82-4-55" id="h82-4-55" class="i">+                Some(
</a><a href="#h82-4-56" id="h82-4-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h82-4-57" id="h82-4-57" class="i">+                ),
</a><a href="#h82-4-58" id="h82-4-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h82-4-59" id="h82-4-59" class="i">+            ),
</a><a href="#h82-4-60" id="h82-4-60" class="i">+        ),
</a><a href="#h82-4-61" id="h82-4-61" class="i">+    ],
</a><a href="#h82-4-62" id="h82-4-62" class="i">+}
</a> 
<b>diff --git a/<a id="h83" href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a> b/<a href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a></b>
<a href="#h83-0" id="h83-0" class="h">@@ -3,7 +3,7 @@ Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX
</a> Explain:
 Order: #1 asc
 └─ Projection: movies.studio_id, #0
<a href="#h83-0-3" id="h83-0-3" class="d">-   └─ Aggregation: maximum
</a><a href="#h83-0-4" id="h83-0-4" class="i">+   └─ Aggregation: max
</a>       └─ Projection: rating, studio_id
          └─ Scan: movies
 
<a href="#h83-1" id="h83-1" class="h">@@ -67,8 +67,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h83-1-3" id="h83-1-3" class="d">-Plan: Select(
</a><a href="#h83-1-4" id="h83-1-4" class="d">-    Order {
</a><a href="#h83-1-5" id="h83-1-5" class="i">+Plan: Select {
</a><a href="#h83-1-6" id="h83-1-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h83-2" id="h83-2" class="h">@@ -150,13 +150,9 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h83-2-3" id="h83-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h83-2-5" id="h83-2-5" class="i">+                        alias: None,
</a>                     },
<a href="#h83-2-7" id="h83-2-7" class="d">-                    labels: [
</a><a href="#h83-2-8" id="h83-2-8" class="d">-                        None,
</a><a href="#h83-2-9" id="h83-2-9" class="d">-                        None,
</a><a href="#h83-2-10" id="h83-2-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h83-3" id="h83-3" class="h">@@ -177,15 +173,15 @@ Plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h83-3-3" id="h83-3-3" class="i">+                    labels: [
</a><a href="#h83-3-4" id="h83-3-4" class="i">+                        None,
</a><a href="#h83-3-5" id="h83-3-5" class="i">+                        None,
</a><a href="#h83-3-6" id="h83-3-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h83-3-12" id="h83-3-12" class="d">-            labels: [
</a><a href="#h83-3-13" id="h83-3-13" class="d">-                None,
</a><a href="#h83-3-14" id="h83-3-14" class="d">-                None,
</a><a href="#h83-3-15" id="h83-3-15" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h83-4" id="h83-4" class="h">@@ -203,6 +199,10 @@ Plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h83-4-3" id="h83-4-3" class="i">+            labels: [
</a><a href="#h83-4-4" id="h83-4-4" class="i">+                None,
</a><a href="#h83-4-5" id="h83-4-5" class="i">+                None,
</a><a href="#h83-4-6" id="h83-4-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h83-5" id="h83-5" class="h">@@ -214,10 +214,21 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h83-5-3" id="h83-5-3" class="d">-)
</a><a href="#h83-5-4" id="h83-5-4" class="i">+    labels: [
</a><a href="#h83-5-5" id="h83-5-5" class="i">+        Some(
</a><a href="#h83-5-6" id="h83-5-6" class="i">+            (
</a><a href="#h83-5-7" id="h83-5-7" class="i">+                Some(
</a><a href="#h83-5-8" id="h83-5-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h83-5-9" id="h83-5-9" class="i">+                ),
</a><a href="#h83-5-10" id="h83-5-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h83-5-11" id="h83-5-11" class="i">+            ),
</a><a href="#h83-5-12" id="h83-5-12" class="i">+        ),
</a><a href="#h83-5-13" id="h83-5-13" class="i">+        None,
</a><a href="#h83-5-14" id="h83-5-14" class="i">+    ],
</a><a href="#h83-5-15" id="h83-5-15" class="i">+}
</a> 
<a href="#h83-5-17" id="h83-5-17" class="d">-Optimized plan: Select(
</a><a href="#h83-5-18" id="h83-5-18" class="d">-    Order {
</a><a href="#h83-5-19" id="h83-5-19" class="i">+Optimized plan: Select {
</a><a href="#h83-5-20" id="h83-5-20" class="i">+    root: Order {
</a>         source: Projection {
             source: Aggregation {
                 source: Projection {
<a href="#h83-6" id="h83-6" class="h">@@ -299,13 +310,9 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h83-6-3" id="h83-6-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h83-6-5" id="h83-6-5" class="i">+                        alias: None,
</a>                     },
<a href="#h83-6-7" id="h83-6-7" class="d">-                    labels: [
</a><a href="#h83-6-8" id="h83-6-8" class="d">-                        None,
</a><a href="#h83-6-9" id="h83-6-9" class="d">-                        None,
</a><a href="#h83-6-10" id="h83-6-10" class="d">-                    ],
</a>                     expressions: [
                         Field(
                             5,
<a href="#h83-7" id="h83-7" class="h">@@ -326,15 +333,15 @@ Optimized plan: Select(
</a>                             ),
                         ),
                     ],
<a href="#h83-7-3" id="h83-7-3" class="i">+                    labels: [
</a><a href="#h83-7-4" id="h83-7-4" class="i">+                        None,
</a><a href="#h83-7-5" id="h83-7-5" class="i">+                        None,
</a><a href="#h83-7-6" id="h83-7-6" class="i">+                    ],
</a>                 },
                 aggregates: [
                     Max,
                 ],
             },
<a href="#h83-7-12" id="h83-7-12" class="d">-            labels: [
</a><a href="#h83-7-13" id="h83-7-13" class="d">-                None,
</a><a href="#h83-7-14" id="h83-7-14" class="d">-                None,
</a><a href="#h83-7-15" id="h83-7-15" class="d">-            ],
</a>             expressions: [
                 Field(
                     1,
<a href="#h83-8" id="h83-8" class="h">@@ -352,6 +359,10 @@ Optimized plan: Select(
</a>                     None,
                 ),
             ],
<a href="#h83-8-3" id="h83-8-3" class="i">+            labels: [
</a><a href="#h83-8-4" id="h83-8-4" class="i">+                None,
</a><a href="#h83-8-5" id="h83-8-5" class="i">+                None,
</a><a href="#h83-8-6" id="h83-8-6" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h83-9" id="h83-9" class="h">@@ -363,5 +374,16 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h83-9-3" id="h83-9-3" class="d">-)
</a><a href="#h83-9-4" id="h83-9-4" class="i">+    labels: [
</a><a href="#h83-9-5" id="h83-9-5" class="i">+        Some(
</a><a href="#h83-9-6" id="h83-9-6" class="i">+            (
</a><a href="#h83-9-7" id="h83-9-7" class="i">+                Some(
</a><a href="#h83-9-8" id="h83-9-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h83-9-9" id="h83-9-9" class="i">+                ),
</a><a href="#h83-9-10" id="h83-9-10" class="i">+                &quot;studio_id&quot;,
</a><a href="#h83-9-11" id="h83-9-11" class="i">+            ),
</a><a href="#h83-9-12" id="h83-9-12" class="i">+        ),
</a><a href="#h83-9-13" id="h83-9-13" class="i">+        None,
</a><a href="#h83-9-14" id="h83-9-14" class="i">+    ],
</a><a href="#h83-9-15" id="h83-9-15" class="i">+}
</a> 
<b>diff --git a/<a id="h84" href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a> b/<a href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a></b>
<a href="#h84-0" id="h84-0" class="h">@@ -4,7 +4,7 @@ Explain:
</a> Projection: #0, #1
 └─ Order: #2 asc
    └─ Projection: movies.studio_id, #0, #1
<a href="#h84-0-3" id="h84-0-3" class="d">-      └─ Aggregation: maximum, minimum
</a><a href="#h84-0-4" id="h84-0-4" class="i">+      └─ Aggregation: max, min
</a>          └─ Projection: rating, rating, studio_id
             └─ Scan: movies
 
<a href="#h84-1" id="h84-1" class="h">@@ -68,8 +68,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h84-1-3" id="h84-1-3" class="d">-Plan: Select(
</a><a href="#h84-1-4" id="h84-1-4" class="d">-    Projection {
</a><a href="#h84-1-5" id="h84-1-5" class="i">+Plan: Select {
</a><a href="#h84-1-6" id="h84-1-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: Aggregation {
<a href="#h84-2" id="h84-2" class="h">@@ -152,14 +152,9 @@ Plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h84-2-3" id="h84-2-3" class="d">-                            alias: None,
</a>                             filter: None,
<a href="#h84-2-5" id="h84-2-5" class="i">+                            alias: None,
</a>                         },
<a href="#h84-2-7" id="h84-2-7" class="d">-                        labels: [
</a><a href="#h84-2-8" id="h84-2-8" class="d">-                            None,
</a><a href="#h84-2-9" id="h84-2-9" class="d">-                            None,
</a><a href="#h84-2-10" id="h84-2-10" class="d">-                            None,
</a><a href="#h84-2-11" id="h84-2-11" class="d">-                        ],
</a>                         expressions: [
                             Field(
                                 5,
<a href="#h84-3" id="h84-3" class="h">@@ -189,17 +184,17 @@ Plan: Select(
</a>                                 ),
                             ),
                         ],
<a href="#h84-3-3" id="h84-3-3" class="i">+                        labels: [
</a><a href="#h84-3-4" id="h84-3-4" class="i">+                            None,
</a><a href="#h84-3-5" id="h84-3-5" class="i">+                            None,
</a><a href="#h84-3-6" id="h84-3-6" class="i">+                            None,
</a><a href="#h84-3-7" id="h84-3-7" class="i">+                        ],
</a>                     },
                     aggregates: [
                         Max,
                         Min,
                     ],
                 },
<a href="#h84-3-14" id="h84-3-14" class="d">-                labels: [
</a><a href="#h84-3-15" id="h84-3-15" class="d">-                    None,
</a><a href="#h84-3-16" id="h84-3-16" class="d">-                    None,
</a><a href="#h84-3-17" id="h84-3-17" class="d">-                    None,
</a><a href="#h84-3-18" id="h84-3-18" class="d">-                ],
</a>                 expressions: [
                     Field(
                         2,
<a href="#h84-4" id="h84-4" class="h">@@ -221,6 +216,11 @@ Plan: Select(
</a>                         None,
                     ),
                 ],
<a href="#h84-4-3" id="h84-4-3" class="i">+                labels: [
</a><a href="#h84-4-4" id="h84-4-4" class="i">+                    None,
</a><a href="#h84-4-5" id="h84-4-5" class="i">+                    None,
</a><a href="#h84-4-6" id="h84-4-6" class="i">+                    None,
</a><a href="#h84-4-7" id="h84-4-7" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h84-5" id="h84-5" class="h">@@ -232,10 +232,6 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h84-5-3" id="h84-5-3" class="d">-        labels: [
</a><a href="#h84-5-4" id="h84-5-4" class="d">-            None,
</a><a href="#h84-5-5" id="h84-5-5" class="d">-            None,
</a><a href="#h84-5-6" id="h84-5-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h84-6" id="h84-6" class="h">@@ -246,11 +242,26 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h84-6-3" id="h84-6-3" class="i">+        labels: [
</a><a href="#h84-6-4" id="h84-6-4" class="i">+            None,
</a><a href="#h84-6-5" id="h84-6-5" class="i">+            None,
</a><a href="#h84-6-6" id="h84-6-6" class="i">+        ],
</a>     },
<a href="#h84-6-8" id="h84-6-8" class="d">-)
</a><a href="#h84-6-9" id="h84-6-9" class="i">+    labels: [
</a><a href="#h84-6-10" id="h84-6-10" class="i">+        Some(
</a><a href="#h84-6-11" id="h84-6-11" class="i">+            (
</a><a href="#h84-6-12" id="h84-6-12" class="i">+                Some(
</a><a href="#h84-6-13" id="h84-6-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h84-6-14" id="h84-6-14" class="i">+                ),
</a><a href="#h84-6-15" id="h84-6-15" class="i">+                &quot;studio_id&quot;,
</a><a href="#h84-6-16" id="h84-6-16" class="i">+            ),
</a><a href="#h84-6-17" id="h84-6-17" class="i">+        ),
</a><a href="#h84-6-18" id="h84-6-18" class="i">+        None,
</a><a href="#h84-6-19" id="h84-6-19" class="i">+    ],
</a><a href="#h84-6-20" id="h84-6-20" class="i">+}
</a> 
<a href="#h84-6-22" id="h84-6-22" class="d">-Optimized plan: Select(
</a><a href="#h84-6-23" id="h84-6-23" class="d">-    Projection {
</a><a href="#h84-6-24" id="h84-6-24" class="i">+Optimized plan: Select {
</a><a href="#h84-6-25" id="h84-6-25" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: Aggregation {
<a href="#h84-7" id="h84-7" class="h">@@ -333,14 +344,9 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h84-7-3" id="h84-7-3" class="d">-                            alias: None,
</a>                             filter: None,
<a href="#h84-7-5" id="h84-7-5" class="i">+                            alias: None,
</a>                         },
<a href="#h84-7-7" id="h84-7-7" class="d">-                        labels: [
</a><a href="#h84-7-8" id="h84-7-8" class="d">-                            None,
</a><a href="#h84-7-9" id="h84-7-9" class="d">-                            None,
</a><a href="#h84-7-10" id="h84-7-10" class="d">-                            None,
</a><a href="#h84-7-11" id="h84-7-11" class="d">-                        ],
</a>                         expressions: [
                             Field(
                                 5,
<a href="#h84-8" id="h84-8" class="h">@@ -370,17 +376,17 @@ Optimized plan: Select(
</a>                                 ),
                             ),
                         ],
<a href="#h84-8-3" id="h84-8-3" class="i">+                        labels: [
</a><a href="#h84-8-4" id="h84-8-4" class="i">+                            None,
</a><a href="#h84-8-5" id="h84-8-5" class="i">+                            None,
</a><a href="#h84-8-6" id="h84-8-6" class="i">+                            None,
</a><a href="#h84-8-7" id="h84-8-7" class="i">+                        ],
</a>                     },
                     aggregates: [
                         Max,
                         Min,
                     ],
                 },
<a href="#h84-8-14" id="h84-8-14" class="d">-                labels: [
</a><a href="#h84-8-15" id="h84-8-15" class="d">-                    None,
</a><a href="#h84-8-16" id="h84-8-16" class="d">-                    None,
</a><a href="#h84-8-17" id="h84-8-17" class="d">-                    None,
</a><a href="#h84-8-18" id="h84-8-18" class="d">-                ],
</a>                 expressions: [
                     Field(
                         2,
<a href="#h84-9" id="h84-9" class="h">@@ -402,6 +408,11 @@ Optimized plan: Select(
</a>                         None,
                     ),
                 ],
<a href="#h84-9-3" id="h84-9-3" class="i">+                labels: [
</a><a href="#h84-9-4" id="h84-9-4" class="i">+                    None,
</a><a href="#h84-9-5" id="h84-9-5" class="i">+                    None,
</a><a href="#h84-9-6" id="h84-9-6" class="i">+                    None,
</a><a href="#h84-9-7" id="h84-9-7" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h84-10" id="h84-10" class="h">@@ -413,10 +424,6 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h84-10-3" id="h84-10-3" class="d">-        labels: [
</a><a href="#h84-10-4" id="h84-10-4" class="d">-            None,
</a><a href="#h84-10-5" id="h84-10-5" class="d">-            None,
</a><a href="#h84-10-6" id="h84-10-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h84-11" id="h84-11" class="h">@@ -427,6 +434,21 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h84-11-3" id="h84-11-3" class="i">+        labels: [
</a><a href="#h84-11-4" id="h84-11-4" class="i">+            None,
</a><a href="#h84-11-5" id="h84-11-5" class="i">+            None,
</a><a href="#h84-11-6" id="h84-11-6" class="i">+        ],
</a>     },
<a href="#h84-11-8" id="h84-11-8" class="d">-)
</a><a href="#h84-11-9" id="h84-11-9" class="i">+    labels: [
</a><a href="#h84-11-10" id="h84-11-10" class="i">+        Some(
</a><a href="#h84-11-11" id="h84-11-11" class="i">+            (
</a><a href="#h84-11-12" id="h84-11-12" class="i">+                Some(
</a><a href="#h84-11-13" id="h84-11-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h84-11-14" id="h84-11-14" class="i">+                ),
</a><a href="#h84-11-15" id="h84-11-15" class="i">+                &quot;studio_id&quot;,
</a><a href="#h84-11-16" id="h84-11-16" class="i">+            ),
</a><a href="#h84-11-17" id="h84-11-17" class="i">+        ),
</a><a href="#h84-11-18" id="h84-11-18" class="i">+        None,
</a><a href="#h84-11-19" id="h84-11-19" class="i">+    ],
</a><a href="#h84-11-20" id="h84-11-20" class="i">+}
</a> 
<b>diff --git a/<a id="h85" href="../file/tests/sql/query/order_asc.html">tests/sql/query/order_asc</a> b/<a href="../file/tests/sql/query/order_asc.html">tests/sql/query/order_asc</a></b>
<a href="#h85-0" id="h85-0" class="h">@@ -40,8 +40,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h85-0-3" id="h85-0-3" class="d">-Plan: Select(
</a><a href="#h85-0-4" id="h85-0-4" class="d">-    Order {
</a><a href="#h85-0-5" id="h85-0-5" class="i">+Plan: Select {
</a><a href="#h85-0-6" id="h85-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h85-1" id="h85-1" class="h">@@ -120,8 +120,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h85-1-3" id="h85-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h85-1-5" id="h85-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h85-2" id="h85-2" class="h">@@ -138,10 +138,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h85-2-3" id="h85-2-3" class="d">-)
</a><a href="#h85-2-4" id="h85-2-4" class="i">+    labels: [
</a><a href="#h85-2-5" id="h85-2-5" class="i">+        Some(
</a><a href="#h85-2-6" id="h85-2-6" class="i">+            (
</a><a href="#h85-2-7" id="h85-2-7" class="i">+                Some(
</a><a href="#h85-2-8" id="h85-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-2-9" id="h85-2-9" class="i">+                ),
</a><a href="#h85-2-10" id="h85-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h85-2-11" id="h85-2-11" class="i">+            ),
</a><a href="#h85-2-12" id="h85-2-12" class="i">+        ),
</a><a href="#h85-2-13" id="h85-2-13" class="i">+        Some(
</a><a href="#h85-2-14" id="h85-2-14" class="i">+            (
</a><a href="#h85-2-15" id="h85-2-15" class="i">+                Some(
</a><a href="#h85-2-16" id="h85-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-2-17" id="h85-2-17" class="i">+                ),
</a><a href="#h85-2-18" id="h85-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h85-2-19" id="h85-2-19" class="i">+            ),
</a><a href="#h85-2-20" id="h85-2-20" class="i">+        ),
</a><a href="#h85-2-21" id="h85-2-21" class="i">+        Some(
</a><a href="#h85-2-22" id="h85-2-22" class="i">+            (
</a><a href="#h85-2-23" id="h85-2-23" class="i">+                Some(
</a><a href="#h85-2-24" id="h85-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-2-25" id="h85-2-25" class="i">+                ),
</a><a href="#h85-2-26" id="h85-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h85-2-27" id="h85-2-27" class="i">+            ),
</a><a href="#h85-2-28" id="h85-2-28" class="i">+        ),
</a><a href="#h85-2-29" id="h85-2-29" class="i">+        Some(
</a><a href="#h85-2-30" id="h85-2-30" class="i">+            (
</a><a href="#h85-2-31" id="h85-2-31" class="i">+                Some(
</a><a href="#h85-2-32" id="h85-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-2-33" id="h85-2-33" class="i">+                ),
</a><a href="#h85-2-34" id="h85-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h85-2-35" id="h85-2-35" class="i">+            ),
</a><a href="#h85-2-36" id="h85-2-36" class="i">+        ),
</a><a href="#h85-2-37" id="h85-2-37" class="i">+        Some(
</a><a href="#h85-2-38" id="h85-2-38" class="i">+            (
</a><a href="#h85-2-39" id="h85-2-39" class="i">+                Some(
</a><a href="#h85-2-40" id="h85-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-2-41" id="h85-2-41" class="i">+                ),
</a><a href="#h85-2-42" id="h85-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h85-2-43" id="h85-2-43" class="i">+            ),
</a><a href="#h85-2-44" id="h85-2-44" class="i">+        ),
</a><a href="#h85-2-45" id="h85-2-45" class="i">+        Some(
</a><a href="#h85-2-46" id="h85-2-46" class="i">+            (
</a><a href="#h85-2-47" id="h85-2-47" class="i">+                Some(
</a><a href="#h85-2-48" id="h85-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-2-49" id="h85-2-49" class="i">+                ),
</a><a href="#h85-2-50" id="h85-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h85-2-51" id="h85-2-51" class="i">+            ),
</a><a href="#h85-2-52" id="h85-2-52" class="i">+        ),
</a><a href="#h85-2-53" id="h85-2-53" class="i">+        Some(
</a><a href="#h85-2-54" id="h85-2-54" class="i">+            (
</a><a href="#h85-2-55" id="h85-2-55" class="i">+                Some(
</a><a href="#h85-2-56" id="h85-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-2-57" id="h85-2-57" class="i">+                ),
</a><a href="#h85-2-58" id="h85-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h85-2-59" id="h85-2-59" class="i">+            ),
</a><a href="#h85-2-60" id="h85-2-60" class="i">+        ),
</a><a href="#h85-2-61" id="h85-2-61" class="i">+    ],
</a><a href="#h85-2-62" id="h85-2-62" class="i">+}
</a> 
<a href="#h85-2-64" id="h85-2-64" class="d">-Optimized plan: Select(
</a><a href="#h85-2-65" id="h85-2-65" class="d">-    Order {
</a><a href="#h85-2-66" id="h85-2-66" class="i">+Optimized plan: Select {
</a><a href="#h85-2-67" id="h85-2-67" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h85-3" id="h85-3" class="h">@@ -220,8 +278,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h85-3-3" id="h85-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h85-3-5" id="h85-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h85-4" id="h85-4" class="h">@@ -238,5 +296,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h85-4-3" id="h85-4-3" class="d">-)
</a><a href="#h85-4-4" id="h85-4-4" class="i">+    labels: [
</a><a href="#h85-4-5" id="h85-4-5" class="i">+        Some(
</a><a href="#h85-4-6" id="h85-4-6" class="i">+            (
</a><a href="#h85-4-7" id="h85-4-7" class="i">+                Some(
</a><a href="#h85-4-8" id="h85-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-4-9" id="h85-4-9" class="i">+                ),
</a><a href="#h85-4-10" id="h85-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h85-4-11" id="h85-4-11" class="i">+            ),
</a><a href="#h85-4-12" id="h85-4-12" class="i">+        ),
</a><a href="#h85-4-13" id="h85-4-13" class="i">+        Some(
</a><a href="#h85-4-14" id="h85-4-14" class="i">+            (
</a><a href="#h85-4-15" id="h85-4-15" class="i">+                Some(
</a><a href="#h85-4-16" id="h85-4-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-4-17" id="h85-4-17" class="i">+                ),
</a><a href="#h85-4-18" id="h85-4-18" class="i">+                &quot;title&quot;,
</a><a href="#h85-4-19" id="h85-4-19" class="i">+            ),
</a><a href="#h85-4-20" id="h85-4-20" class="i">+        ),
</a><a href="#h85-4-21" id="h85-4-21" class="i">+        Some(
</a><a href="#h85-4-22" id="h85-4-22" class="i">+            (
</a><a href="#h85-4-23" id="h85-4-23" class="i">+                Some(
</a><a href="#h85-4-24" id="h85-4-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-4-25" id="h85-4-25" class="i">+                ),
</a><a href="#h85-4-26" id="h85-4-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h85-4-27" id="h85-4-27" class="i">+            ),
</a><a href="#h85-4-28" id="h85-4-28" class="i">+        ),
</a><a href="#h85-4-29" id="h85-4-29" class="i">+        Some(
</a><a href="#h85-4-30" id="h85-4-30" class="i">+            (
</a><a href="#h85-4-31" id="h85-4-31" class="i">+                Some(
</a><a href="#h85-4-32" id="h85-4-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-4-33" id="h85-4-33" class="i">+                ),
</a><a href="#h85-4-34" id="h85-4-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h85-4-35" id="h85-4-35" class="i">+            ),
</a><a href="#h85-4-36" id="h85-4-36" class="i">+        ),
</a><a href="#h85-4-37" id="h85-4-37" class="i">+        Some(
</a><a href="#h85-4-38" id="h85-4-38" class="i">+            (
</a><a href="#h85-4-39" id="h85-4-39" class="i">+                Some(
</a><a href="#h85-4-40" id="h85-4-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-4-41" id="h85-4-41" class="i">+                ),
</a><a href="#h85-4-42" id="h85-4-42" class="i">+                &quot;released&quot;,
</a><a href="#h85-4-43" id="h85-4-43" class="i">+            ),
</a><a href="#h85-4-44" id="h85-4-44" class="i">+        ),
</a><a href="#h85-4-45" id="h85-4-45" class="i">+        Some(
</a><a href="#h85-4-46" id="h85-4-46" class="i">+            (
</a><a href="#h85-4-47" id="h85-4-47" class="i">+                Some(
</a><a href="#h85-4-48" id="h85-4-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-4-49" id="h85-4-49" class="i">+                ),
</a><a href="#h85-4-50" id="h85-4-50" class="i">+                &quot;rating&quot;,
</a><a href="#h85-4-51" id="h85-4-51" class="i">+            ),
</a><a href="#h85-4-52" id="h85-4-52" class="i">+        ),
</a><a href="#h85-4-53" id="h85-4-53" class="i">+        Some(
</a><a href="#h85-4-54" id="h85-4-54" class="i">+            (
</a><a href="#h85-4-55" id="h85-4-55" class="i">+                Some(
</a><a href="#h85-4-56" id="h85-4-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h85-4-57" id="h85-4-57" class="i">+                ),
</a><a href="#h85-4-58" id="h85-4-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h85-4-59" id="h85-4-59" class="i">+            ),
</a><a href="#h85-4-60" id="h85-4-60" class="i">+        ),
</a><a href="#h85-4-61" id="h85-4-61" class="i">+    ],
</a><a href="#h85-4-62" id="h85-4-62" class="i">+}
</a> 
<b>diff --git a/<a id="h86" href="../file/tests/sql/query/order_asc_lowercase.html">tests/sql/query/order_asc_lowercase</a> b/<a href="../file/tests/sql/query/order_asc_lowercase.html">tests/sql/query/order_asc_lowercase</a></b>
<a href="#h86-0" id="h86-0" class="h">@@ -40,8 +40,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h86-0-3" id="h86-0-3" class="d">-Plan: Select(
</a><a href="#h86-0-4" id="h86-0-4" class="d">-    Order {
</a><a href="#h86-0-5" id="h86-0-5" class="i">+Plan: Select {
</a><a href="#h86-0-6" id="h86-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h86-1" id="h86-1" class="h">@@ -120,8 +120,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h86-1-3" id="h86-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h86-1-5" id="h86-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h86-2" id="h86-2" class="h">@@ -138,10 +138,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h86-2-3" id="h86-2-3" class="d">-)
</a><a href="#h86-2-4" id="h86-2-4" class="i">+    labels: [
</a><a href="#h86-2-5" id="h86-2-5" class="i">+        Some(
</a><a href="#h86-2-6" id="h86-2-6" class="i">+            (
</a><a href="#h86-2-7" id="h86-2-7" class="i">+                Some(
</a><a href="#h86-2-8" id="h86-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-2-9" id="h86-2-9" class="i">+                ),
</a><a href="#h86-2-10" id="h86-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h86-2-11" id="h86-2-11" class="i">+            ),
</a><a href="#h86-2-12" id="h86-2-12" class="i">+        ),
</a><a href="#h86-2-13" id="h86-2-13" class="i">+        Some(
</a><a href="#h86-2-14" id="h86-2-14" class="i">+            (
</a><a href="#h86-2-15" id="h86-2-15" class="i">+                Some(
</a><a href="#h86-2-16" id="h86-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-2-17" id="h86-2-17" class="i">+                ),
</a><a href="#h86-2-18" id="h86-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h86-2-19" id="h86-2-19" class="i">+            ),
</a><a href="#h86-2-20" id="h86-2-20" class="i">+        ),
</a><a href="#h86-2-21" id="h86-2-21" class="i">+        Some(
</a><a href="#h86-2-22" id="h86-2-22" class="i">+            (
</a><a href="#h86-2-23" id="h86-2-23" class="i">+                Some(
</a><a href="#h86-2-24" id="h86-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-2-25" id="h86-2-25" class="i">+                ),
</a><a href="#h86-2-26" id="h86-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h86-2-27" id="h86-2-27" class="i">+            ),
</a><a href="#h86-2-28" id="h86-2-28" class="i">+        ),
</a><a href="#h86-2-29" id="h86-2-29" class="i">+        Some(
</a><a href="#h86-2-30" id="h86-2-30" class="i">+            (
</a><a href="#h86-2-31" id="h86-2-31" class="i">+                Some(
</a><a href="#h86-2-32" id="h86-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-2-33" id="h86-2-33" class="i">+                ),
</a><a href="#h86-2-34" id="h86-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h86-2-35" id="h86-2-35" class="i">+            ),
</a><a href="#h86-2-36" id="h86-2-36" class="i">+        ),
</a><a href="#h86-2-37" id="h86-2-37" class="i">+        Some(
</a><a href="#h86-2-38" id="h86-2-38" class="i">+            (
</a><a href="#h86-2-39" id="h86-2-39" class="i">+                Some(
</a><a href="#h86-2-40" id="h86-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-2-41" id="h86-2-41" class="i">+                ),
</a><a href="#h86-2-42" id="h86-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h86-2-43" id="h86-2-43" class="i">+            ),
</a><a href="#h86-2-44" id="h86-2-44" class="i">+        ),
</a><a href="#h86-2-45" id="h86-2-45" class="i">+        Some(
</a><a href="#h86-2-46" id="h86-2-46" class="i">+            (
</a><a href="#h86-2-47" id="h86-2-47" class="i">+                Some(
</a><a href="#h86-2-48" id="h86-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-2-49" id="h86-2-49" class="i">+                ),
</a><a href="#h86-2-50" id="h86-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h86-2-51" id="h86-2-51" class="i">+            ),
</a><a href="#h86-2-52" id="h86-2-52" class="i">+        ),
</a><a href="#h86-2-53" id="h86-2-53" class="i">+        Some(
</a><a href="#h86-2-54" id="h86-2-54" class="i">+            (
</a><a href="#h86-2-55" id="h86-2-55" class="i">+                Some(
</a><a href="#h86-2-56" id="h86-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-2-57" id="h86-2-57" class="i">+                ),
</a><a href="#h86-2-58" id="h86-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h86-2-59" id="h86-2-59" class="i">+            ),
</a><a href="#h86-2-60" id="h86-2-60" class="i">+        ),
</a><a href="#h86-2-61" id="h86-2-61" class="i">+    ],
</a><a href="#h86-2-62" id="h86-2-62" class="i">+}
</a> 
<a href="#h86-2-64" id="h86-2-64" class="d">-Optimized plan: Select(
</a><a href="#h86-2-65" id="h86-2-65" class="d">-    Order {
</a><a href="#h86-2-66" id="h86-2-66" class="i">+Optimized plan: Select {
</a><a href="#h86-2-67" id="h86-2-67" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h86-3" id="h86-3" class="h">@@ -220,8 +278,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h86-3-3" id="h86-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h86-3-5" id="h86-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h86-4" id="h86-4" class="h">@@ -238,5 +296,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h86-4-3" id="h86-4-3" class="d">-)
</a><a href="#h86-4-4" id="h86-4-4" class="i">+    labels: [
</a><a href="#h86-4-5" id="h86-4-5" class="i">+        Some(
</a><a href="#h86-4-6" id="h86-4-6" class="i">+            (
</a><a href="#h86-4-7" id="h86-4-7" class="i">+                Some(
</a><a href="#h86-4-8" id="h86-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-4-9" id="h86-4-9" class="i">+                ),
</a><a href="#h86-4-10" id="h86-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h86-4-11" id="h86-4-11" class="i">+            ),
</a><a href="#h86-4-12" id="h86-4-12" class="i">+        ),
</a><a href="#h86-4-13" id="h86-4-13" class="i">+        Some(
</a><a href="#h86-4-14" id="h86-4-14" class="i">+            (
</a><a href="#h86-4-15" id="h86-4-15" class="i">+                Some(
</a><a href="#h86-4-16" id="h86-4-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-4-17" id="h86-4-17" class="i">+                ),
</a><a href="#h86-4-18" id="h86-4-18" class="i">+                &quot;title&quot;,
</a><a href="#h86-4-19" id="h86-4-19" class="i">+            ),
</a><a href="#h86-4-20" id="h86-4-20" class="i">+        ),
</a><a href="#h86-4-21" id="h86-4-21" class="i">+        Some(
</a><a href="#h86-4-22" id="h86-4-22" class="i">+            (
</a><a href="#h86-4-23" id="h86-4-23" class="i">+                Some(
</a><a href="#h86-4-24" id="h86-4-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-4-25" id="h86-4-25" class="i">+                ),
</a><a href="#h86-4-26" id="h86-4-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h86-4-27" id="h86-4-27" class="i">+            ),
</a><a href="#h86-4-28" id="h86-4-28" class="i">+        ),
</a><a href="#h86-4-29" id="h86-4-29" class="i">+        Some(
</a><a href="#h86-4-30" id="h86-4-30" class="i">+            (
</a><a href="#h86-4-31" id="h86-4-31" class="i">+                Some(
</a><a href="#h86-4-32" id="h86-4-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-4-33" id="h86-4-33" class="i">+                ),
</a><a href="#h86-4-34" id="h86-4-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h86-4-35" id="h86-4-35" class="i">+            ),
</a><a href="#h86-4-36" id="h86-4-36" class="i">+        ),
</a><a href="#h86-4-37" id="h86-4-37" class="i">+        Some(
</a><a href="#h86-4-38" id="h86-4-38" class="i">+            (
</a><a href="#h86-4-39" id="h86-4-39" class="i">+                Some(
</a><a href="#h86-4-40" id="h86-4-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-4-41" id="h86-4-41" class="i">+                ),
</a><a href="#h86-4-42" id="h86-4-42" class="i">+                &quot;released&quot;,
</a><a href="#h86-4-43" id="h86-4-43" class="i">+            ),
</a><a href="#h86-4-44" id="h86-4-44" class="i">+        ),
</a><a href="#h86-4-45" id="h86-4-45" class="i">+        Some(
</a><a href="#h86-4-46" id="h86-4-46" class="i">+            (
</a><a href="#h86-4-47" id="h86-4-47" class="i">+                Some(
</a><a href="#h86-4-48" id="h86-4-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-4-49" id="h86-4-49" class="i">+                ),
</a><a href="#h86-4-50" id="h86-4-50" class="i">+                &quot;rating&quot;,
</a><a href="#h86-4-51" id="h86-4-51" class="i">+            ),
</a><a href="#h86-4-52" id="h86-4-52" class="i">+        ),
</a><a href="#h86-4-53" id="h86-4-53" class="i">+        Some(
</a><a href="#h86-4-54" id="h86-4-54" class="i">+            (
</a><a href="#h86-4-55" id="h86-4-55" class="i">+                Some(
</a><a href="#h86-4-56" id="h86-4-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h86-4-57" id="h86-4-57" class="i">+                ),
</a><a href="#h86-4-58" id="h86-4-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h86-4-59" id="h86-4-59" class="i">+            ),
</a><a href="#h86-4-60" id="h86-4-60" class="i">+        ),
</a><a href="#h86-4-61" id="h86-4-61" class="i">+    ],
</a><a href="#h86-4-62" id="h86-4-62" class="i">+}
</a> 
<b>diff --git a/<a id="h87" href="../file/tests/sql/query/order_boolean_asc.html">tests/sql/query/order_boolean_asc</a> b/<a href="../file/tests/sql/query/order_boolean_asc.html">tests/sql/query/order_boolean_asc</a></b>
<a href="#h87-0" id="h87-0" class="h">@@ -33,8 +33,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h87-0-3" id="h87-0-3" class="d">-Plan: Select(
</a><a href="#h87-0-4" id="h87-0-4" class="d">-    Order {
</a><a href="#h87-0-5" id="h87-0-5" class="i">+Plan: Select {
</a><a href="#h87-0-6" id="h87-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;booleans&quot;,
<a href="#h87-1" id="h87-1" class="h">@@ -62,8 +62,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h87-1-3" id="h87-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h87-1-5" id="h87-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h87-2" id="h87-2" class="h">@@ -80,10 +80,28 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h87-2-3" id="h87-2-3" class="d">-)
</a><a href="#h87-2-4" id="h87-2-4" class="i">+    labels: [
</a><a href="#h87-2-5" id="h87-2-5" class="i">+        Some(
</a><a href="#h87-2-6" id="h87-2-6" class="i">+            (
</a><a href="#h87-2-7" id="h87-2-7" class="i">+                Some(
</a><a href="#h87-2-8" id="h87-2-8" class="i">+                    &quot;booleans&quot;,
</a><a href="#h87-2-9" id="h87-2-9" class="i">+                ),
</a><a href="#h87-2-10" id="h87-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h87-2-11" id="h87-2-11" class="i">+            ),
</a><a href="#h87-2-12" id="h87-2-12" class="i">+        ),
</a><a href="#h87-2-13" id="h87-2-13" class="i">+        Some(
</a><a href="#h87-2-14" id="h87-2-14" class="i">+            (
</a><a href="#h87-2-15" id="h87-2-15" class="i">+                Some(
</a><a href="#h87-2-16" id="h87-2-16" class="i">+                    &quot;booleans&quot;,
</a><a href="#h87-2-17" id="h87-2-17" class="i">+                ),
</a><a href="#h87-2-18" id="h87-2-18" class="i">+                &quot;value&quot;,
</a><a href="#h87-2-19" id="h87-2-19" class="i">+            ),
</a><a href="#h87-2-20" id="h87-2-20" class="i">+        ),
</a><a href="#h87-2-21" id="h87-2-21" class="i">+    ],
</a><a href="#h87-2-22" id="h87-2-22" class="i">+}
</a> 
<a href="#h87-2-24" id="h87-2-24" class="d">-Optimized plan: Select(
</a><a href="#h87-2-25" id="h87-2-25" class="d">-    Order {
</a><a href="#h87-2-26" id="h87-2-26" class="i">+Optimized plan: Select {
</a><a href="#h87-2-27" id="h87-2-27" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;booleans&quot;,
<a href="#h87-3" id="h87-3" class="h">@@ -111,8 +129,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h87-3-3" id="h87-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h87-3-5" id="h87-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h87-4" id="h87-4" class="h">@@ -129,5 +147,23 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h87-4-3" id="h87-4-3" class="d">-)
</a><a href="#h87-4-4" id="h87-4-4" class="i">+    labels: [
</a><a href="#h87-4-5" id="h87-4-5" class="i">+        Some(
</a><a href="#h87-4-6" id="h87-4-6" class="i">+            (
</a><a href="#h87-4-7" id="h87-4-7" class="i">+                Some(
</a><a href="#h87-4-8" id="h87-4-8" class="i">+                    &quot;booleans&quot;,
</a><a href="#h87-4-9" id="h87-4-9" class="i">+                ),
</a><a href="#h87-4-10" id="h87-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h87-4-11" id="h87-4-11" class="i">+            ),
</a><a href="#h87-4-12" id="h87-4-12" class="i">+        ),
</a><a href="#h87-4-13" id="h87-4-13" class="i">+        Some(
</a><a href="#h87-4-14" id="h87-4-14" class="i">+            (
</a><a href="#h87-4-15" id="h87-4-15" class="i">+                Some(
</a><a href="#h87-4-16" id="h87-4-16" class="i">+                    &quot;booleans&quot;,
</a><a href="#h87-4-17" id="h87-4-17" class="i">+                ),
</a><a href="#h87-4-18" id="h87-4-18" class="i">+                &quot;value&quot;,
</a><a href="#h87-4-19" id="h87-4-19" class="i">+            ),
</a><a href="#h87-4-20" id="h87-4-20" class="i">+        ),
</a><a href="#h87-4-21" id="h87-4-21" class="i">+    ],
</a><a href="#h87-4-22" id="h87-4-22" class="i">+}
</a> 
<b>diff --git a/<a id="h88" href="../file/tests/sql/query/order_boolean_desc.html">tests/sql/query/order_boolean_desc</a> b/<a href="../file/tests/sql/query/order_boolean_desc.html">tests/sql/query/order_boolean_desc</a></b>
<a href="#h88-0" id="h88-0" class="h">@@ -33,8 +33,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h88-0-3" id="h88-0-3" class="d">-Plan: Select(
</a><a href="#h88-0-4" id="h88-0-4" class="d">-    Order {
</a><a href="#h88-0-5" id="h88-0-5" class="i">+Plan: Select {
</a><a href="#h88-0-6" id="h88-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;booleans&quot;,
<a href="#h88-1" id="h88-1" class="h">@@ -62,8 +62,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h88-1-3" id="h88-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h88-1-5" id="h88-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h88-2" id="h88-2" class="h">@@ -80,10 +80,28 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h88-2-3" id="h88-2-3" class="d">-)
</a><a href="#h88-2-4" id="h88-2-4" class="i">+    labels: [
</a><a href="#h88-2-5" id="h88-2-5" class="i">+        Some(
</a><a href="#h88-2-6" id="h88-2-6" class="i">+            (
</a><a href="#h88-2-7" id="h88-2-7" class="i">+                Some(
</a><a href="#h88-2-8" id="h88-2-8" class="i">+                    &quot;booleans&quot;,
</a><a href="#h88-2-9" id="h88-2-9" class="i">+                ),
</a><a href="#h88-2-10" id="h88-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h88-2-11" id="h88-2-11" class="i">+            ),
</a><a href="#h88-2-12" id="h88-2-12" class="i">+        ),
</a><a href="#h88-2-13" id="h88-2-13" class="i">+        Some(
</a><a href="#h88-2-14" id="h88-2-14" class="i">+            (
</a><a href="#h88-2-15" id="h88-2-15" class="i">+                Some(
</a><a href="#h88-2-16" id="h88-2-16" class="i">+                    &quot;booleans&quot;,
</a><a href="#h88-2-17" id="h88-2-17" class="i">+                ),
</a><a href="#h88-2-18" id="h88-2-18" class="i">+                &quot;value&quot;,
</a><a href="#h88-2-19" id="h88-2-19" class="i">+            ),
</a><a href="#h88-2-20" id="h88-2-20" class="i">+        ),
</a><a href="#h88-2-21" id="h88-2-21" class="i">+    ],
</a><a href="#h88-2-22" id="h88-2-22" class="i">+}
</a> 
<a href="#h88-2-24" id="h88-2-24" class="d">-Optimized plan: Select(
</a><a href="#h88-2-25" id="h88-2-25" class="d">-    Order {
</a><a href="#h88-2-26" id="h88-2-26" class="i">+Optimized plan: Select {
</a><a href="#h88-2-27" id="h88-2-27" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;booleans&quot;,
<a href="#h88-3" id="h88-3" class="h">@@ -111,8 +129,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h88-3-3" id="h88-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h88-3-5" id="h88-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h88-4" id="h88-4" class="h">@@ -129,5 +147,23 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h88-4-3" id="h88-4-3" class="d">-)
</a><a href="#h88-4-4" id="h88-4-4" class="i">+    labels: [
</a><a href="#h88-4-5" id="h88-4-5" class="i">+        Some(
</a><a href="#h88-4-6" id="h88-4-6" class="i">+            (
</a><a href="#h88-4-7" id="h88-4-7" class="i">+                Some(
</a><a href="#h88-4-8" id="h88-4-8" class="i">+                    &quot;booleans&quot;,
</a><a href="#h88-4-9" id="h88-4-9" class="i">+                ),
</a><a href="#h88-4-10" id="h88-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h88-4-11" id="h88-4-11" class="i">+            ),
</a><a href="#h88-4-12" id="h88-4-12" class="i">+        ),
</a><a href="#h88-4-13" id="h88-4-13" class="i">+        Some(
</a><a href="#h88-4-14" id="h88-4-14" class="i">+            (
</a><a href="#h88-4-15" id="h88-4-15" class="i">+                Some(
</a><a href="#h88-4-16" id="h88-4-16" class="i">+                    &quot;booleans&quot;,
</a><a href="#h88-4-17" id="h88-4-17" class="i">+                ),
</a><a href="#h88-4-18" id="h88-4-18" class="i">+                &quot;value&quot;,
</a><a href="#h88-4-19" id="h88-4-19" class="i">+            ),
</a><a href="#h88-4-20" id="h88-4-20" class="i">+        ),
</a><a href="#h88-4-21" id="h88-4-21" class="i">+    ],
</a><a href="#h88-4-22" id="h88-4-22" class="i">+}
</a> 
<b>diff --git a/<a id="h89" href="../file/tests/sql/query/order_desc.html">tests/sql/query/order_desc</a> b/<a href="../file/tests/sql/query/order_desc.html">tests/sql/query/order_desc</a></b>
<a href="#h89-0" id="h89-0" class="h">@@ -40,8 +40,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h89-0-3" id="h89-0-3" class="d">-Plan: Select(
</a><a href="#h89-0-4" id="h89-0-4" class="d">-    Order {
</a><a href="#h89-0-5" id="h89-0-5" class="i">+Plan: Select {
</a><a href="#h89-0-6" id="h89-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h89-1" id="h89-1" class="h">@@ -120,8 +120,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h89-1-3" id="h89-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h89-1-5" id="h89-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h89-2" id="h89-2" class="h">@@ -138,10 +138,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h89-2-3" id="h89-2-3" class="d">-)
</a><a href="#h89-2-4" id="h89-2-4" class="i">+    labels: [
</a><a href="#h89-2-5" id="h89-2-5" class="i">+        Some(
</a><a href="#h89-2-6" id="h89-2-6" class="i">+            (
</a><a href="#h89-2-7" id="h89-2-7" class="i">+                Some(
</a><a href="#h89-2-8" id="h89-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-2-9" id="h89-2-9" class="i">+                ),
</a><a href="#h89-2-10" id="h89-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h89-2-11" id="h89-2-11" class="i">+            ),
</a><a href="#h89-2-12" id="h89-2-12" class="i">+        ),
</a><a href="#h89-2-13" id="h89-2-13" class="i">+        Some(
</a><a href="#h89-2-14" id="h89-2-14" class="i">+            (
</a><a href="#h89-2-15" id="h89-2-15" class="i">+                Some(
</a><a href="#h89-2-16" id="h89-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-2-17" id="h89-2-17" class="i">+                ),
</a><a href="#h89-2-18" id="h89-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h89-2-19" id="h89-2-19" class="i">+            ),
</a><a href="#h89-2-20" id="h89-2-20" class="i">+        ),
</a><a href="#h89-2-21" id="h89-2-21" class="i">+        Some(
</a><a href="#h89-2-22" id="h89-2-22" class="i">+            (
</a><a href="#h89-2-23" id="h89-2-23" class="i">+                Some(
</a><a href="#h89-2-24" id="h89-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-2-25" id="h89-2-25" class="i">+                ),
</a><a href="#h89-2-26" id="h89-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h89-2-27" id="h89-2-27" class="i">+            ),
</a><a href="#h89-2-28" id="h89-2-28" class="i">+        ),
</a><a href="#h89-2-29" id="h89-2-29" class="i">+        Some(
</a><a href="#h89-2-30" id="h89-2-30" class="i">+            (
</a><a href="#h89-2-31" id="h89-2-31" class="i">+                Some(
</a><a href="#h89-2-32" id="h89-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-2-33" id="h89-2-33" class="i">+                ),
</a><a href="#h89-2-34" id="h89-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h89-2-35" id="h89-2-35" class="i">+            ),
</a><a href="#h89-2-36" id="h89-2-36" class="i">+        ),
</a><a href="#h89-2-37" id="h89-2-37" class="i">+        Some(
</a><a href="#h89-2-38" id="h89-2-38" class="i">+            (
</a><a href="#h89-2-39" id="h89-2-39" class="i">+                Some(
</a><a href="#h89-2-40" id="h89-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-2-41" id="h89-2-41" class="i">+                ),
</a><a href="#h89-2-42" id="h89-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h89-2-43" id="h89-2-43" class="i">+            ),
</a><a href="#h89-2-44" id="h89-2-44" class="i">+        ),
</a><a href="#h89-2-45" id="h89-2-45" class="i">+        Some(
</a><a href="#h89-2-46" id="h89-2-46" class="i">+            (
</a><a href="#h89-2-47" id="h89-2-47" class="i">+                Some(
</a><a href="#h89-2-48" id="h89-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-2-49" id="h89-2-49" class="i">+                ),
</a><a href="#h89-2-50" id="h89-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h89-2-51" id="h89-2-51" class="i">+            ),
</a><a href="#h89-2-52" id="h89-2-52" class="i">+        ),
</a><a href="#h89-2-53" id="h89-2-53" class="i">+        Some(
</a><a href="#h89-2-54" id="h89-2-54" class="i">+            (
</a><a href="#h89-2-55" id="h89-2-55" class="i">+                Some(
</a><a href="#h89-2-56" id="h89-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-2-57" id="h89-2-57" class="i">+                ),
</a><a href="#h89-2-58" id="h89-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h89-2-59" id="h89-2-59" class="i">+            ),
</a><a href="#h89-2-60" id="h89-2-60" class="i">+        ),
</a><a href="#h89-2-61" id="h89-2-61" class="i">+    ],
</a><a href="#h89-2-62" id="h89-2-62" class="i">+}
</a> 
<a href="#h89-2-64" id="h89-2-64" class="d">-Optimized plan: Select(
</a><a href="#h89-2-65" id="h89-2-65" class="d">-    Order {
</a><a href="#h89-2-66" id="h89-2-66" class="i">+Optimized plan: Select {
</a><a href="#h89-2-67" id="h89-2-67" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h89-3" id="h89-3" class="h">@@ -220,8 +278,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h89-3-3" id="h89-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h89-3-5" id="h89-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h89-4" id="h89-4" class="h">@@ -238,5 +296,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h89-4-3" id="h89-4-3" class="d">-)
</a><a href="#h89-4-4" id="h89-4-4" class="i">+    labels: [
</a><a href="#h89-4-5" id="h89-4-5" class="i">+        Some(
</a><a href="#h89-4-6" id="h89-4-6" class="i">+            (
</a><a href="#h89-4-7" id="h89-4-7" class="i">+                Some(
</a><a href="#h89-4-8" id="h89-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-4-9" id="h89-4-9" class="i">+                ),
</a><a href="#h89-4-10" id="h89-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h89-4-11" id="h89-4-11" class="i">+            ),
</a><a href="#h89-4-12" id="h89-4-12" class="i">+        ),
</a><a href="#h89-4-13" id="h89-4-13" class="i">+        Some(
</a><a href="#h89-4-14" id="h89-4-14" class="i">+            (
</a><a href="#h89-4-15" id="h89-4-15" class="i">+                Some(
</a><a href="#h89-4-16" id="h89-4-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-4-17" id="h89-4-17" class="i">+                ),
</a><a href="#h89-4-18" id="h89-4-18" class="i">+                &quot;title&quot;,
</a><a href="#h89-4-19" id="h89-4-19" class="i">+            ),
</a><a href="#h89-4-20" id="h89-4-20" class="i">+        ),
</a><a href="#h89-4-21" id="h89-4-21" class="i">+        Some(
</a><a href="#h89-4-22" id="h89-4-22" class="i">+            (
</a><a href="#h89-4-23" id="h89-4-23" class="i">+                Some(
</a><a href="#h89-4-24" id="h89-4-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-4-25" id="h89-4-25" class="i">+                ),
</a><a href="#h89-4-26" id="h89-4-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h89-4-27" id="h89-4-27" class="i">+            ),
</a><a href="#h89-4-28" id="h89-4-28" class="i">+        ),
</a><a href="#h89-4-29" id="h89-4-29" class="i">+        Some(
</a><a href="#h89-4-30" id="h89-4-30" class="i">+            (
</a><a href="#h89-4-31" id="h89-4-31" class="i">+                Some(
</a><a href="#h89-4-32" id="h89-4-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-4-33" id="h89-4-33" class="i">+                ),
</a><a href="#h89-4-34" id="h89-4-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h89-4-35" id="h89-4-35" class="i">+            ),
</a><a href="#h89-4-36" id="h89-4-36" class="i">+        ),
</a><a href="#h89-4-37" id="h89-4-37" class="i">+        Some(
</a><a href="#h89-4-38" id="h89-4-38" class="i">+            (
</a><a href="#h89-4-39" id="h89-4-39" class="i">+                Some(
</a><a href="#h89-4-40" id="h89-4-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-4-41" id="h89-4-41" class="i">+                ),
</a><a href="#h89-4-42" id="h89-4-42" class="i">+                &quot;released&quot;,
</a><a href="#h89-4-43" id="h89-4-43" class="i">+            ),
</a><a href="#h89-4-44" id="h89-4-44" class="i">+        ),
</a><a href="#h89-4-45" id="h89-4-45" class="i">+        Some(
</a><a href="#h89-4-46" id="h89-4-46" class="i">+            (
</a><a href="#h89-4-47" id="h89-4-47" class="i">+                Some(
</a><a href="#h89-4-48" id="h89-4-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-4-49" id="h89-4-49" class="i">+                ),
</a><a href="#h89-4-50" id="h89-4-50" class="i">+                &quot;rating&quot;,
</a><a href="#h89-4-51" id="h89-4-51" class="i">+            ),
</a><a href="#h89-4-52" id="h89-4-52" class="i">+        ),
</a><a href="#h89-4-53" id="h89-4-53" class="i">+        Some(
</a><a href="#h89-4-54" id="h89-4-54" class="i">+            (
</a><a href="#h89-4-55" id="h89-4-55" class="i">+                Some(
</a><a href="#h89-4-56" id="h89-4-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h89-4-57" id="h89-4-57" class="i">+                ),
</a><a href="#h89-4-58" id="h89-4-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h89-4-59" id="h89-4-59" class="i">+            ),
</a><a href="#h89-4-60" id="h89-4-60" class="i">+        ),
</a><a href="#h89-4-61" id="h89-4-61" class="i">+    ],
</a><a href="#h89-4-62" id="h89-4-62" class="i">+}
</a> 
<b>diff --git a/<a id="h90" href="../file/tests/sql/query/order_desc_lowercase.html">tests/sql/query/order_desc_lowercase</a> b/<a href="../file/tests/sql/query/order_desc_lowercase.html">tests/sql/query/order_desc_lowercase</a></b>
<a href="#h90-0" id="h90-0" class="h">@@ -40,8 +40,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h90-0-3" id="h90-0-3" class="d">-Plan: Select(
</a><a href="#h90-0-4" id="h90-0-4" class="d">-    Order {
</a><a href="#h90-0-5" id="h90-0-5" class="i">+Plan: Select {
</a><a href="#h90-0-6" id="h90-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h90-1" id="h90-1" class="h">@@ -120,8 +120,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h90-1-3" id="h90-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h90-1-5" id="h90-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h90-2" id="h90-2" class="h">@@ -138,10 +138,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h90-2-3" id="h90-2-3" class="d">-)
</a><a href="#h90-2-4" id="h90-2-4" class="i">+    labels: [
</a><a href="#h90-2-5" id="h90-2-5" class="i">+        Some(
</a><a href="#h90-2-6" id="h90-2-6" class="i">+            (
</a><a href="#h90-2-7" id="h90-2-7" class="i">+                Some(
</a><a href="#h90-2-8" id="h90-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-2-9" id="h90-2-9" class="i">+                ),
</a><a href="#h90-2-10" id="h90-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h90-2-11" id="h90-2-11" class="i">+            ),
</a><a href="#h90-2-12" id="h90-2-12" class="i">+        ),
</a><a href="#h90-2-13" id="h90-2-13" class="i">+        Some(
</a><a href="#h90-2-14" id="h90-2-14" class="i">+            (
</a><a href="#h90-2-15" id="h90-2-15" class="i">+                Some(
</a><a href="#h90-2-16" id="h90-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-2-17" id="h90-2-17" class="i">+                ),
</a><a href="#h90-2-18" id="h90-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h90-2-19" id="h90-2-19" class="i">+            ),
</a><a href="#h90-2-20" id="h90-2-20" class="i">+        ),
</a><a href="#h90-2-21" id="h90-2-21" class="i">+        Some(
</a><a href="#h90-2-22" id="h90-2-22" class="i">+            (
</a><a href="#h90-2-23" id="h90-2-23" class="i">+                Some(
</a><a href="#h90-2-24" id="h90-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-2-25" id="h90-2-25" class="i">+                ),
</a><a href="#h90-2-26" id="h90-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h90-2-27" id="h90-2-27" class="i">+            ),
</a><a href="#h90-2-28" id="h90-2-28" class="i">+        ),
</a><a href="#h90-2-29" id="h90-2-29" class="i">+        Some(
</a><a href="#h90-2-30" id="h90-2-30" class="i">+            (
</a><a href="#h90-2-31" id="h90-2-31" class="i">+                Some(
</a><a href="#h90-2-32" id="h90-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-2-33" id="h90-2-33" class="i">+                ),
</a><a href="#h90-2-34" id="h90-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h90-2-35" id="h90-2-35" class="i">+            ),
</a><a href="#h90-2-36" id="h90-2-36" class="i">+        ),
</a><a href="#h90-2-37" id="h90-2-37" class="i">+        Some(
</a><a href="#h90-2-38" id="h90-2-38" class="i">+            (
</a><a href="#h90-2-39" id="h90-2-39" class="i">+                Some(
</a><a href="#h90-2-40" id="h90-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-2-41" id="h90-2-41" class="i">+                ),
</a><a href="#h90-2-42" id="h90-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h90-2-43" id="h90-2-43" class="i">+            ),
</a><a href="#h90-2-44" id="h90-2-44" class="i">+        ),
</a><a href="#h90-2-45" id="h90-2-45" class="i">+        Some(
</a><a href="#h90-2-46" id="h90-2-46" class="i">+            (
</a><a href="#h90-2-47" id="h90-2-47" class="i">+                Some(
</a><a href="#h90-2-48" id="h90-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-2-49" id="h90-2-49" class="i">+                ),
</a><a href="#h90-2-50" id="h90-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h90-2-51" id="h90-2-51" class="i">+            ),
</a><a href="#h90-2-52" id="h90-2-52" class="i">+        ),
</a><a href="#h90-2-53" id="h90-2-53" class="i">+        Some(
</a><a href="#h90-2-54" id="h90-2-54" class="i">+            (
</a><a href="#h90-2-55" id="h90-2-55" class="i">+                Some(
</a><a href="#h90-2-56" id="h90-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-2-57" id="h90-2-57" class="i">+                ),
</a><a href="#h90-2-58" id="h90-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h90-2-59" id="h90-2-59" class="i">+            ),
</a><a href="#h90-2-60" id="h90-2-60" class="i">+        ),
</a><a href="#h90-2-61" id="h90-2-61" class="i">+    ],
</a><a href="#h90-2-62" id="h90-2-62" class="i">+}
</a> 
<a href="#h90-2-64" id="h90-2-64" class="d">-Optimized plan: Select(
</a><a href="#h90-2-65" id="h90-2-65" class="d">-    Order {
</a><a href="#h90-2-66" id="h90-2-66" class="i">+Optimized plan: Select {
</a><a href="#h90-2-67" id="h90-2-67" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h90-3" id="h90-3" class="h">@@ -220,8 +278,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h90-3-3" id="h90-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h90-3-5" id="h90-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h90-4" id="h90-4" class="h">@@ -238,5 +296,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h90-4-3" id="h90-4-3" class="d">-)
</a><a href="#h90-4-4" id="h90-4-4" class="i">+    labels: [
</a><a href="#h90-4-5" id="h90-4-5" class="i">+        Some(
</a><a href="#h90-4-6" id="h90-4-6" class="i">+            (
</a><a href="#h90-4-7" id="h90-4-7" class="i">+                Some(
</a><a href="#h90-4-8" id="h90-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-4-9" id="h90-4-9" class="i">+                ),
</a><a href="#h90-4-10" id="h90-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h90-4-11" id="h90-4-11" class="i">+            ),
</a><a href="#h90-4-12" id="h90-4-12" class="i">+        ),
</a><a href="#h90-4-13" id="h90-4-13" class="i">+        Some(
</a><a href="#h90-4-14" id="h90-4-14" class="i">+            (
</a><a href="#h90-4-15" id="h90-4-15" class="i">+                Some(
</a><a href="#h90-4-16" id="h90-4-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-4-17" id="h90-4-17" class="i">+                ),
</a><a href="#h90-4-18" id="h90-4-18" class="i">+                &quot;title&quot;,
</a><a href="#h90-4-19" id="h90-4-19" class="i">+            ),
</a><a href="#h90-4-20" id="h90-4-20" class="i">+        ),
</a><a href="#h90-4-21" id="h90-4-21" class="i">+        Some(
</a><a href="#h90-4-22" id="h90-4-22" class="i">+            (
</a><a href="#h90-4-23" id="h90-4-23" class="i">+                Some(
</a><a href="#h90-4-24" id="h90-4-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-4-25" id="h90-4-25" class="i">+                ),
</a><a href="#h90-4-26" id="h90-4-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h90-4-27" id="h90-4-27" class="i">+            ),
</a><a href="#h90-4-28" id="h90-4-28" class="i">+        ),
</a><a href="#h90-4-29" id="h90-4-29" class="i">+        Some(
</a><a href="#h90-4-30" id="h90-4-30" class="i">+            (
</a><a href="#h90-4-31" id="h90-4-31" class="i">+                Some(
</a><a href="#h90-4-32" id="h90-4-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-4-33" id="h90-4-33" class="i">+                ),
</a><a href="#h90-4-34" id="h90-4-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h90-4-35" id="h90-4-35" class="i">+            ),
</a><a href="#h90-4-36" id="h90-4-36" class="i">+        ),
</a><a href="#h90-4-37" id="h90-4-37" class="i">+        Some(
</a><a href="#h90-4-38" id="h90-4-38" class="i">+            (
</a><a href="#h90-4-39" id="h90-4-39" class="i">+                Some(
</a><a href="#h90-4-40" id="h90-4-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-4-41" id="h90-4-41" class="i">+                ),
</a><a href="#h90-4-42" id="h90-4-42" class="i">+                &quot;released&quot;,
</a><a href="#h90-4-43" id="h90-4-43" class="i">+            ),
</a><a href="#h90-4-44" id="h90-4-44" class="i">+        ),
</a><a href="#h90-4-45" id="h90-4-45" class="i">+        Some(
</a><a href="#h90-4-46" id="h90-4-46" class="i">+            (
</a><a href="#h90-4-47" id="h90-4-47" class="i">+                Some(
</a><a href="#h90-4-48" id="h90-4-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-4-49" id="h90-4-49" class="i">+                ),
</a><a href="#h90-4-50" id="h90-4-50" class="i">+                &quot;rating&quot;,
</a><a href="#h90-4-51" id="h90-4-51" class="i">+            ),
</a><a href="#h90-4-52" id="h90-4-52" class="i">+        ),
</a><a href="#h90-4-53" id="h90-4-53" class="i">+        Some(
</a><a href="#h90-4-54" id="h90-4-54" class="i">+            (
</a><a href="#h90-4-55" id="h90-4-55" class="i">+                Some(
</a><a href="#h90-4-56" id="h90-4-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h90-4-57" id="h90-4-57" class="i">+                ),
</a><a href="#h90-4-58" id="h90-4-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h90-4-59" id="h90-4-59" class="i">+            ),
</a><a href="#h90-4-60" id="h90-4-60" class="i">+        ),
</a><a href="#h90-4-61" id="h90-4-61" class="i">+    ],
</a><a href="#h90-4-62" id="h90-4-62" class="i">+}
</a> 
<b>diff --git a/<a id="h91" href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a> b/<a href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a></b>
<a href="#h91-0" id="h91-0" class="h">@@ -90,8 +90,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h91-0-3" id="h91-0-3" class="d">-Plan: Select(
</a><a href="#h91-0-4" id="h91-0-4" class="d">-    Order {
</a><a href="#h91-0-5" id="h91-0-5" class="i">+Plan: Select {
</a><a href="#h91-0-6" id="h91-0-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Scan {
                 table: Table {
<a href="#h91-1" id="h91-1" class="h">@@ -171,20 +171,9 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h91-1-3" id="h91-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h91-1-5" id="h91-1-5" class="i">+                alias: None,
</a>             },
<a href="#h91-1-7" id="h91-1-7" class="d">-            labels: [
</a><a href="#h91-1-8" id="h91-1-8" class="d">-                None,
</a><a href="#h91-1-9" id="h91-1-9" class="d">-                None,
</a><a href="#h91-1-10" id="h91-1-10" class="d">-                None,
</a><a href="#h91-1-11" id="h91-1-11" class="d">-                Some(
</a><a href="#h91-1-12" id="h91-1-12" class="d">-                    (
</a><a href="#h91-1-13" id="h91-1-13" class="d">-                        None,
</a><a href="#h91-1-14" id="h91-1-14" class="d">-                        &quot;ord&quot;,
</a><a href="#h91-1-15" id="h91-1-15" class="d">-                    ),
</a><a href="#h91-1-16" id="h91-1-16" class="d">-                ),
</a><a href="#h91-1-17" id="h91-1-17" class="d">-            ],
</a>             expressions: [
                 Field(
                     0,
<a href="#h91-2" id="h91-2" class="h">@@ -230,6 +219,17 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h91-2-3" id="h91-2-3" class="i">+            labels: [
</a><a href="#h91-2-4" id="h91-2-4" class="i">+                None,
</a><a href="#h91-2-5" id="h91-2-5" class="i">+                None,
</a><a href="#h91-2-6" id="h91-2-6" class="i">+                None,
</a><a href="#h91-2-7" id="h91-2-7" class="i">+                Some(
</a><a href="#h91-2-8" id="h91-2-8" class="i">+                    (
</a><a href="#h91-2-9" id="h91-2-9" class="i">+                        None,
</a><a href="#h91-2-10" id="h91-2-10" class="i">+                        &quot;ord&quot;,
</a><a href="#h91-2-11" id="h91-2-11" class="i">+                    ),
</a><a href="#h91-2-12" id="h91-2-12" class="i">+                ),
</a><a href="#h91-2-13" id="h91-2-13" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h91-3" id="h91-3" class="h">@@ -246,10 +246,42 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h91-3-3" id="h91-3-3" class="d">-)
</a><a href="#h91-3-4" id="h91-3-4" class="i">+    labels: [
</a><a href="#h91-3-5" id="h91-3-5" class="i">+        Some(
</a><a href="#h91-3-6" id="h91-3-6" class="i">+            (
</a><a href="#h91-3-7" id="h91-3-7" class="i">+                Some(
</a><a href="#h91-3-8" id="h91-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h91-3-9" id="h91-3-9" class="i">+                ),
</a><a href="#h91-3-10" id="h91-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h91-3-11" id="h91-3-11" class="i">+            ),
</a><a href="#h91-3-12" id="h91-3-12" class="i">+        ),
</a><a href="#h91-3-13" id="h91-3-13" class="i">+        Some(
</a><a href="#h91-3-14" id="h91-3-14" class="i">+            (
</a><a href="#h91-3-15" id="h91-3-15" class="i">+                Some(
</a><a href="#h91-3-16" id="h91-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h91-3-17" id="h91-3-17" class="i">+                ),
</a><a href="#h91-3-18" id="h91-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h91-3-19" id="h91-3-19" class="i">+            ),
</a><a href="#h91-3-20" id="h91-3-20" class="i">+        ),
</a><a href="#h91-3-21" id="h91-3-21" class="i">+        Some(
</a><a href="#h91-3-22" id="h91-3-22" class="i">+            (
</a><a href="#h91-3-23" id="h91-3-23" class="i">+                Some(
</a><a href="#h91-3-24" id="h91-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h91-3-25" id="h91-3-25" class="i">+                ),
</a><a href="#h91-3-26" id="h91-3-26" class="i">+                &quot;released&quot;,
</a><a href="#h91-3-27" id="h91-3-27" class="i">+            ),
</a><a href="#h91-3-28" id="h91-3-28" class="i">+        ),
</a><a href="#h91-3-29" id="h91-3-29" class="i">+        Some(
</a><a href="#h91-3-30" id="h91-3-30" class="i">+            (
</a><a href="#h91-3-31" id="h91-3-31" class="i">+                None,
</a><a href="#h91-3-32" id="h91-3-32" class="i">+                &quot;ord&quot;,
</a><a href="#h91-3-33" id="h91-3-33" class="i">+            ),
</a><a href="#h91-3-34" id="h91-3-34" class="i">+        ),
</a><a href="#h91-3-35" id="h91-3-35" class="i">+    ],
</a><a href="#h91-3-36" id="h91-3-36" class="i">+}
</a> 
<a href="#h91-3-38" id="h91-3-38" class="d">-Optimized plan: Select(
</a><a href="#h91-3-39" id="h91-3-39" class="d">-    Order {
</a><a href="#h91-3-40" id="h91-3-40" class="i">+Optimized plan: Select {
</a><a href="#h91-3-41" id="h91-3-41" class="i">+    root: Order {
</a>         source: Projection {
             source: Scan {
                 table: Table {
<a href="#h91-4" id="h91-4" class="h">@@ -329,20 +361,9 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h91-4-3" id="h91-4-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h91-4-5" id="h91-4-5" class="i">+                alias: None,
</a>             },
<a href="#h91-4-7" id="h91-4-7" class="d">-            labels: [
</a><a href="#h91-4-8" id="h91-4-8" class="d">-                None,
</a><a href="#h91-4-9" id="h91-4-9" class="d">-                None,
</a><a href="#h91-4-10" id="h91-4-10" class="d">-                None,
</a><a href="#h91-4-11" id="h91-4-11" class="d">-                Some(
</a><a href="#h91-4-12" id="h91-4-12" class="d">-                    (
</a><a href="#h91-4-13" id="h91-4-13" class="d">-                        None,
</a><a href="#h91-4-14" id="h91-4-14" class="d">-                        &quot;ord&quot;,
</a><a href="#h91-4-15" id="h91-4-15" class="d">-                    ),
</a><a href="#h91-4-16" id="h91-4-16" class="d">-                ),
</a><a href="#h91-4-17" id="h91-4-17" class="d">-            ],
</a>             expressions: [
                 Field(
                     0,
<a href="#h91-5" id="h91-5" class="h">@@ -388,6 +409,17 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h91-5-3" id="h91-5-3" class="i">+            labels: [
</a><a href="#h91-5-4" id="h91-5-4" class="i">+                None,
</a><a href="#h91-5-5" id="h91-5-5" class="i">+                None,
</a><a href="#h91-5-6" id="h91-5-6" class="i">+                None,
</a><a href="#h91-5-7" id="h91-5-7" class="i">+                Some(
</a><a href="#h91-5-8" id="h91-5-8" class="i">+                    (
</a><a href="#h91-5-9" id="h91-5-9" class="i">+                        None,
</a><a href="#h91-5-10" id="h91-5-10" class="i">+                        &quot;ord&quot;,
</a><a href="#h91-5-11" id="h91-5-11" class="i">+                    ),
</a><a href="#h91-5-12" id="h91-5-12" class="i">+                ),
</a><a href="#h91-5-13" id="h91-5-13" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h91-6" id="h91-6" class="h">@@ -404,5 +436,37 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h91-6-3" id="h91-6-3" class="d">-)
</a><a href="#h91-6-4" id="h91-6-4" class="i">+    labels: [
</a><a href="#h91-6-5" id="h91-6-5" class="i">+        Some(
</a><a href="#h91-6-6" id="h91-6-6" class="i">+            (
</a><a href="#h91-6-7" id="h91-6-7" class="i">+                Some(
</a><a href="#h91-6-8" id="h91-6-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h91-6-9" id="h91-6-9" class="i">+                ),
</a><a href="#h91-6-10" id="h91-6-10" class="i">+                &quot;id&quot;,
</a><a href="#h91-6-11" id="h91-6-11" class="i">+            ),
</a><a href="#h91-6-12" id="h91-6-12" class="i">+        ),
</a><a href="#h91-6-13" id="h91-6-13" class="i">+        Some(
</a><a href="#h91-6-14" id="h91-6-14" class="i">+            (
</a><a href="#h91-6-15" id="h91-6-15" class="i">+                Some(
</a><a href="#h91-6-16" id="h91-6-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h91-6-17" id="h91-6-17" class="i">+                ),
</a><a href="#h91-6-18" id="h91-6-18" class="i">+                &quot;title&quot;,
</a><a href="#h91-6-19" id="h91-6-19" class="i">+            ),
</a><a href="#h91-6-20" id="h91-6-20" class="i">+        ),
</a><a href="#h91-6-21" id="h91-6-21" class="i">+        Some(
</a><a href="#h91-6-22" id="h91-6-22" class="i">+            (
</a><a href="#h91-6-23" id="h91-6-23" class="i">+                Some(
</a><a href="#h91-6-24" id="h91-6-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h91-6-25" id="h91-6-25" class="i">+                ),
</a><a href="#h91-6-26" id="h91-6-26" class="i">+                &quot;released&quot;,
</a><a href="#h91-6-27" id="h91-6-27" class="i">+            ),
</a><a href="#h91-6-28" id="h91-6-28" class="i">+        ),
</a><a href="#h91-6-29" id="h91-6-29" class="i">+        Some(
</a><a href="#h91-6-30" id="h91-6-30" class="i">+            (
</a><a href="#h91-6-31" id="h91-6-31" class="i">+                None,
</a><a href="#h91-6-32" id="h91-6-32" class="i">+                &quot;ord&quot;,
</a><a href="#h91-6-33" id="h91-6-33" class="i">+            ),
</a><a href="#h91-6-34" id="h91-6-34" class="i">+        ),
</a><a href="#h91-6-35" id="h91-6-35" class="i">+    ],
</a><a href="#h91-6-36" id="h91-6-36" class="i">+}
</a> 
<b>diff --git a/<a id="h92" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h92-0" id="h92-0" class="h">@@ -99,8 +99,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h92-0-3" id="h92-0-3" class="d">-Plan: Select(
</a><a href="#h92-0-4" id="h92-0-4" class="d">-    Order {
</a><a href="#h92-0-5" id="h92-0-5" class="i">+Plan: Select {
</a><a href="#h92-0-6" id="h92-0-6" class="i">+    root: Order {
</a>         source: Projection {
             source: Filter {
                 source: NestedLoopJoin {
<a href="#h92-1" id="h92-1" class="h">@@ -182,8 +182,8 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h92-1-3" id="h92-1-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h92-1-5" id="h92-1-5" class="i">+                        alias: None,
</a>                     },
                     left_size: 7,
                     right: Scan {
<a href="#h92-2" id="h92-2" class="h">@@ -211,8 +211,8 @@ Plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h92-2-3" id="h92-2-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h92-2-5" id="h92-2-5" class="i">+                        alias: None,
</a>                     },
                     predicate: None,
                     outer: false,
<a href="#h92-3" id="h92-3" class="h">@@ -242,16 +242,6 @@ Plan: Select(
</a>                     ),
                 ),
             },
<a href="#h92-3-3" id="h92-3-3" class="d">-            labels: [
</a><a href="#h92-3-4" id="h92-3-4" class="d">-                None,
</a><a href="#h92-3-5" id="h92-3-5" class="d">-                None,
</a><a href="#h92-3-6" id="h92-3-6" class="d">-                Some(
</a><a href="#h92-3-7" id="h92-3-7" class="d">-                    (
</a><a href="#h92-3-8" id="h92-3-8" class="d">-                        None,
</a><a href="#h92-3-9" id="h92-3-9" class="d">-                        &quot;genre&quot;,
</a><a href="#h92-3-10" id="h92-3-10" class="d">-                    ),
</a><a href="#h92-3-11" id="h92-3-11" class="d">-                ),
</a><a href="#h92-3-12" id="h92-3-12" class="d">-            ],
</a>             expressions: [
                 Field(
                     0,
<a href="#h92-4" id="h92-4" class="h">@@ -285,6 +275,16 @@ Plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h92-4-3" id="h92-4-3" class="i">+            labels: [
</a><a href="#h92-4-4" id="h92-4-4" class="i">+                None,
</a><a href="#h92-4-5" id="h92-4-5" class="i">+                None,
</a><a href="#h92-4-6" id="h92-4-6" class="i">+                Some(
</a><a href="#h92-4-7" id="h92-4-7" class="i">+                    (
</a><a href="#h92-4-8" id="h92-4-8" class="i">+                        None,
</a><a href="#h92-4-9" id="h92-4-9" class="i">+                        &quot;genre&quot;,
</a><a href="#h92-4-10" id="h92-4-10" class="i">+                    ),
</a><a href="#h92-4-11" id="h92-4-11" class="i">+                ),
</a><a href="#h92-4-12" id="h92-4-12" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h92-5" id="h92-5" class="h">@@ -315,10 +315,34 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h92-5-3" id="h92-5-3" class="d">-)
</a><a href="#h92-5-4" id="h92-5-4" class="i">+    labels: [
</a><a href="#h92-5-5" id="h92-5-5" class="i">+        Some(
</a><a href="#h92-5-6" id="h92-5-6" class="i">+            (
</a><a href="#h92-5-7" id="h92-5-7" class="i">+                Some(
</a><a href="#h92-5-8" id="h92-5-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h92-5-9" id="h92-5-9" class="i">+                ),
</a><a href="#h92-5-10" id="h92-5-10" class="i">+                &quot;id&quot;,
</a><a href="#h92-5-11" id="h92-5-11" class="i">+            ),
</a><a href="#h92-5-12" id="h92-5-12" class="i">+        ),
</a><a href="#h92-5-13" id="h92-5-13" class="i">+        Some(
</a><a href="#h92-5-14" id="h92-5-14" class="i">+            (
</a><a href="#h92-5-15" id="h92-5-15" class="i">+                Some(
</a><a href="#h92-5-16" id="h92-5-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h92-5-17" id="h92-5-17" class="i">+                ),
</a><a href="#h92-5-18" id="h92-5-18" class="i">+                &quot;title&quot;,
</a><a href="#h92-5-19" id="h92-5-19" class="i">+            ),
</a><a href="#h92-5-20" id="h92-5-20" class="i">+        ),
</a><a href="#h92-5-21" id="h92-5-21" class="i">+        Some(
</a><a href="#h92-5-22" id="h92-5-22" class="i">+            (
</a><a href="#h92-5-23" id="h92-5-23" class="i">+                None,
</a><a href="#h92-5-24" id="h92-5-24" class="i">+                &quot;genre&quot;,
</a><a href="#h92-5-25" id="h92-5-25" class="i">+            ),
</a><a href="#h92-5-26" id="h92-5-26" class="i">+        ),
</a><a href="#h92-5-27" id="h92-5-27" class="i">+    ],
</a><a href="#h92-5-28" id="h92-5-28" class="i">+}
</a> 
<a href="#h92-5-30" id="h92-5-30" class="d">-Optimized plan: Select(
</a><a href="#h92-5-31" id="h92-5-31" class="d">-    Order {
</a><a href="#h92-5-32" id="h92-5-32" class="i">+Optimized plan: Select {
</a><a href="#h92-5-33" id="h92-5-33" class="i">+    root: Order {
</a>         source: Projection {
             source: HashJoin {
                 left: Scan {
<a href="#h92-6" id="h92-6" class="h">@@ -399,8 +423,8 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h92-6-3" id="h92-6-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h92-6-5" id="h92-6-5" class="i">+                    alias: None,
</a>                 },
                 left_field: (
                     3,
<a href="#h92-7" id="h92-7" class="h">@@ -438,8 +462,8 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h92-7-3" id="h92-7-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h92-7-5" id="h92-7-5" class="i">+                    alias: None,
</a>                 },
                 right_field: (
                     0,
<a href="#h92-8" id="h92-8" class="h">@@ -454,16 +478,6 @@ Optimized plan: Select(
</a>                 ),
                 outer: false,
             },
<a href="#h92-8-3" id="h92-8-3" class="d">-            labels: [
</a><a href="#h92-8-4" id="h92-8-4" class="d">-                None,
</a><a href="#h92-8-5" id="h92-8-5" class="d">-                None,
</a><a href="#h92-8-6" id="h92-8-6" class="d">-                Some(
</a><a href="#h92-8-7" id="h92-8-7" class="d">-                    (
</a><a href="#h92-8-8" id="h92-8-8" class="d">-                        None,
</a><a href="#h92-8-9" id="h92-8-9" class="d">-                        &quot;genre&quot;,
</a><a href="#h92-8-10" id="h92-8-10" class="d">-                    ),
</a><a href="#h92-8-11" id="h92-8-11" class="d">-                ),
</a><a href="#h92-8-12" id="h92-8-12" class="d">-            ],
</a>             expressions: [
                 Field(
                     0,
<a href="#h92-9" id="h92-9" class="h">@@ -497,6 +511,16 @@ Optimized plan: Select(
</a>                     ),
                 ),
             ],
<a href="#h92-9-3" id="h92-9-3" class="i">+            labels: [
</a><a href="#h92-9-4" id="h92-9-4" class="i">+                None,
</a><a href="#h92-9-5" id="h92-9-5" class="i">+                None,
</a><a href="#h92-9-6" id="h92-9-6" class="i">+                Some(
</a><a href="#h92-9-7" id="h92-9-7" class="i">+                    (
</a><a href="#h92-9-8" id="h92-9-8" class="i">+                        None,
</a><a href="#h92-9-9" id="h92-9-9" class="i">+                        &quot;genre&quot;,
</a><a href="#h92-9-10" id="h92-9-10" class="i">+                    ),
</a><a href="#h92-9-11" id="h92-9-11" class="i">+                ),
</a><a href="#h92-9-12" id="h92-9-12" class="i">+            ],
</a>         },
         orders: [
             (
<a href="#h92-10" id="h92-10" class="h">@@ -527,5 +551,29 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h92-10-3" id="h92-10-3" class="d">-)
</a><a href="#h92-10-4" id="h92-10-4" class="i">+    labels: [
</a><a href="#h92-10-5" id="h92-10-5" class="i">+        Some(
</a><a href="#h92-10-6" id="h92-10-6" class="i">+            (
</a><a href="#h92-10-7" id="h92-10-7" class="i">+                Some(
</a><a href="#h92-10-8" id="h92-10-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h92-10-9" id="h92-10-9" class="i">+                ),
</a><a href="#h92-10-10" id="h92-10-10" class="i">+                &quot;id&quot;,
</a><a href="#h92-10-11" id="h92-10-11" class="i">+            ),
</a><a href="#h92-10-12" id="h92-10-12" class="i">+        ),
</a><a href="#h92-10-13" id="h92-10-13" class="i">+        Some(
</a><a href="#h92-10-14" id="h92-10-14" class="i">+            (
</a><a href="#h92-10-15" id="h92-10-15" class="i">+                Some(
</a><a href="#h92-10-16" id="h92-10-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h92-10-17" id="h92-10-17" class="i">+                ),
</a><a href="#h92-10-18" id="h92-10-18" class="i">+                &quot;title&quot;,
</a><a href="#h92-10-19" id="h92-10-19" class="i">+            ),
</a><a href="#h92-10-20" id="h92-10-20" class="i">+        ),
</a><a href="#h92-10-21" id="h92-10-21" class="i">+        Some(
</a><a href="#h92-10-22" id="h92-10-22" class="i">+            (
</a><a href="#h92-10-23" id="h92-10-23" class="i">+                None,
</a><a href="#h92-10-24" id="h92-10-24" class="i">+                &quot;genre&quot;,
</a><a href="#h92-10-25" id="h92-10-25" class="i">+            ),
</a><a href="#h92-10-26" id="h92-10-26" class="i">+        ),
</a><a href="#h92-10-27" id="h92-10-27" class="i">+    ],
</a><a href="#h92-10-28" id="h92-10-28" class="i">+}
</a> 
<b>diff --git a/<a id="h93" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h93-0" id="h93-0" class="h">@@ -100,8 +100,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h93-0-3" id="h93-0-3" class="d">-Plan: Select(
</a><a href="#h93-0-4" id="h93-0-4" class="d">-    Projection {
</a><a href="#h93-0-5" id="h93-0-5" class="i">+Plan: Select {
</a><a href="#h93-0-6" id="h93-0-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: Filter {
<a href="#h93-1" id="h93-1" class="h">@@ -184,8 +184,8 @@ Plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h93-1-3" id="h93-1-3" class="d">-                            alias: None,
</a>                             filter: None,
<a href="#h93-1-5" id="h93-1-5" class="i">+                            alias: None,
</a>                         },
                         left_size: 7,
                         right: Scan {
<a href="#h93-2" id="h93-2" class="h">@@ -213,8 +213,8 @@ Plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h93-2-3" id="h93-2-3" class="d">-                            alias: None,
</a>                             filter: None,
<a href="#h93-2-5" id="h93-2-5" class="i">+                            alias: None,
</a>                         },
                         predicate: None,
                         outer: false,
<a href="#h93-3" id="h93-3" class="h">@@ -244,13 +244,6 @@ Plan: Select(
</a>                         ),
                     ),
                 },
<a href="#h93-3-3" id="h93-3-3" class="d">-                labels: [
</a><a href="#h93-3-4" id="h93-3-4" class="d">-                    None,
</a><a href="#h93-3-5" id="h93-3-5" class="d">-                    None,
</a><a href="#h93-3-6" id="h93-3-6" class="d">-                    None,
</a><a href="#h93-3-7" id="h93-3-7" class="d">-                    None,
</a><a href="#h93-3-8" id="h93-3-8" class="d">-                    None,
</a><a href="#h93-3-9" id="h93-3-9" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h93-4" id="h93-4" class="h">@@ -304,6 +297,13 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h93-4-3" id="h93-4-3" class="i">+                labels: [
</a><a href="#h93-4-4" id="h93-4-4" class="i">+                    None,
</a><a href="#h93-4-5" id="h93-4-5" class="i">+                    None,
</a><a href="#h93-4-6" id="h93-4-6" class="i">+                    None,
</a><a href="#h93-4-7" id="h93-4-7" class="i">+                    None,
</a><a href="#h93-4-8" id="h93-4-8" class="i">+                    None,
</a><a href="#h93-4-9" id="h93-4-9" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h93-5" id="h93-5" class="h">@@ -336,11 +336,6 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h93-5-3" id="h93-5-3" class="d">-        labels: [
</a><a href="#h93-5-4" id="h93-5-4" class="d">-            None,
</a><a href="#h93-5-5" id="h93-5-5" class="d">-            None,
</a><a href="#h93-5-6" id="h93-5-6" class="d">-            None,
</a><a href="#h93-5-7" id="h93-5-7" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h93-6" id="h93-6" class="h">@@ -355,11 +350,42 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h93-6-3" id="h93-6-3" class="i">+        labels: [
</a><a href="#h93-6-4" id="h93-6-4" class="i">+            None,
</a><a href="#h93-6-5" id="h93-6-5" class="i">+            None,
</a><a href="#h93-6-6" id="h93-6-6" class="i">+            None,
</a><a href="#h93-6-7" id="h93-6-7" class="i">+        ],
</a>     },
<a href="#h93-6-9" id="h93-6-9" class="d">-)
</a><a href="#h93-6-10" id="h93-6-10" class="i">+    labels: [
</a><a href="#h93-6-11" id="h93-6-11" class="i">+        Some(
</a><a href="#h93-6-12" id="h93-6-12" class="i">+            (
</a><a href="#h93-6-13" id="h93-6-13" class="i">+                Some(
</a><a href="#h93-6-14" id="h93-6-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h93-6-15" id="h93-6-15" class="i">+                ),
</a><a href="#h93-6-16" id="h93-6-16" class="i">+                &quot;id&quot;,
</a><a href="#h93-6-17" id="h93-6-17" class="i">+            ),
</a><a href="#h93-6-18" id="h93-6-18" class="i">+        ),
</a><a href="#h93-6-19" id="h93-6-19" class="i">+        Some(
</a><a href="#h93-6-20" id="h93-6-20" class="i">+            (
</a><a href="#h93-6-21" id="h93-6-21" class="i">+                Some(
</a><a href="#h93-6-22" id="h93-6-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h93-6-23" id="h93-6-23" class="i">+                ),
</a><a href="#h93-6-24" id="h93-6-24" class="i">+                &quot;title&quot;,
</a><a href="#h93-6-25" id="h93-6-25" class="i">+            ),
</a><a href="#h93-6-26" id="h93-6-26" class="i">+        ),
</a><a href="#h93-6-27" id="h93-6-27" class="i">+        Some(
</a><a href="#h93-6-28" id="h93-6-28" class="i">+            (
</a><a href="#h93-6-29" id="h93-6-29" class="i">+                Some(
</a><a href="#h93-6-30" id="h93-6-30" class="i">+                    &quot;genres&quot;,
</a><a href="#h93-6-31" id="h93-6-31" class="i">+                ),
</a><a href="#h93-6-32" id="h93-6-32" class="i">+                &quot;name&quot;,
</a><a href="#h93-6-33" id="h93-6-33" class="i">+            ),
</a><a href="#h93-6-34" id="h93-6-34" class="i">+        ),
</a><a href="#h93-6-35" id="h93-6-35" class="i">+    ],
</a><a href="#h93-6-36" id="h93-6-36" class="i">+}
</a> 
<a href="#h93-6-38" id="h93-6-38" class="d">-Optimized plan: Select(
</a><a href="#h93-6-39" id="h93-6-39" class="d">-    Projection {
</a><a href="#h93-6-40" id="h93-6-40" class="i">+Optimized plan: Select {
</a><a href="#h93-6-41" id="h93-6-41" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: HashJoin {
<a href="#h93-7" id="h93-7" class="h">@@ -441,8 +467,8 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h93-7-3" id="h93-7-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h93-7-5" id="h93-7-5" class="i">+                        alias: None,
</a>                     },
                     left_field: (
                         3,
<a href="#h93-8" id="h93-8" class="h">@@ -480,8 +506,8 @@ Optimized plan: Select(
</a>                                 },
                             ],
                         },
<a href="#h93-8-3" id="h93-8-3" class="d">-                        alias: None,
</a>                         filter: None,
<a href="#h93-8-5" id="h93-8-5" class="i">+                        alias: None,
</a>                     },
                     right_field: (
                         0,
<a href="#h93-9" id="h93-9" class="h">@@ -496,13 +522,6 @@ Optimized plan: Select(
</a>                     ),
                     outer: false,
                 },
<a href="#h93-9-3" id="h93-9-3" class="d">-                labels: [
</a><a href="#h93-9-4" id="h93-9-4" class="d">-                    None,
</a><a href="#h93-9-5" id="h93-9-5" class="d">-                    None,
</a><a href="#h93-9-6" id="h93-9-6" class="d">-                    None,
</a><a href="#h93-9-7" id="h93-9-7" class="d">-                    None,
</a><a href="#h93-9-8" id="h93-9-8" class="d">-                    None,
</a><a href="#h93-9-9" id="h93-9-9" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h93-10" id="h93-10" class="h">@@ -556,6 +575,13 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h93-10-3" id="h93-10-3" class="i">+                labels: [
</a><a href="#h93-10-4" id="h93-10-4" class="i">+                    None,
</a><a href="#h93-10-5" id="h93-10-5" class="i">+                    None,
</a><a href="#h93-10-6" id="h93-10-6" class="i">+                    None,
</a><a href="#h93-10-7" id="h93-10-7" class="i">+                    None,
</a><a href="#h93-10-8" id="h93-10-8" class="i">+                    None,
</a><a href="#h93-10-9" id="h93-10-9" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h93-11" id="h93-11" class="h">@@ -588,11 +614,6 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h93-11-3" id="h93-11-3" class="d">-        labels: [
</a><a href="#h93-11-4" id="h93-11-4" class="d">-            None,
</a><a href="#h93-11-5" id="h93-11-5" class="d">-            None,
</a><a href="#h93-11-6" id="h93-11-6" class="d">-            None,
</a><a href="#h93-11-7" id="h93-11-7" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h93-12" id="h93-12" class="h">@@ -607,6 +628,37 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h93-12-3" id="h93-12-3" class="i">+        labels: [
</a><a href="#h93-12-4" id="h93-12-4" class="i">+            None,
</a><a href="#h93-12-5" id="h93-12-5" class="i">+            None,
</a><a href="#h93-12-6" id="h93-12-6" class="i">+            None,
</a><a href="#h93-12-7" id="h93-12-7" class="i">+        ],
</a>     },
<a href="#h93-12-9" id="h93-12-9" class="d">-)
</a><a href="#h93-12-10" id="h93-12-10" class="i">+    labels: [
</a><a href="#h93-12-11" id="h93-12-11" class="i">+        Some(
</a><a href="#h93-12-12" id="h93-12-12" class="i">+            (
</a><a href="#h93-12-13" id="h93-12-13" class="i">+                Some(
</a><a href="#h93-12-14" id="h93-12-14" class="i">+                    &quot;movies&quot;,
</a><a href="#h93-12-15" id="h93-12-15" class="i">+                ),
</a><a href="#h93-12-16" id="h93-12-16" class="i">+                &quot;id&quot;,
</a><a href="#h93-12-17" id="h93-12-17" class="i">+            ),
</a><a href="#h93-12-18" id="h93-12-18" class="i">+        ),
</a><a href="#h93-12-19" id="h93-12-19" class="i">+        Some(
</a><a href="#h93-12-20" id="h93-12-20" class="i">+            (
</a><a href="#h93-12-21" id="h93-12-21" class="i">+                Some(
</a><a href="#h93-12-22" id="h93-12-22" class="i">+                    &quot;movies&quot;,
</a><a href="#h93-12-23" id="h93-12-23" class="i">+                ),
</a><a href="#h93-12-24" id="h93-12-24" class="i">+                &quot;title&quot;,
</a><a href="#h93-12-25" id="h93-12-25" class="i">+            ),
</a><a href="#h93-12-26" id="h93-12-26" class="i">+        ),
</a><a href="#h93-12-27" id="h93-12-27" class="i">+        Some(
</a><a href="#h93-12-28" id="h93-12-28" class="i">+            (
</a><a href="#h93-12-29" id="h93-12-29" class="i">+                Some(
</a><a href="#h93-12-30" id="h93-12-30" class="i">+                    &quot;genres&quot;,
</a><a href="#h93-12-31" id="h93-12-31" class="i">+                ),
</a><a href="#h93-12-32" id="h93-12-32" class="i">+                &quot;name&quot;,
</a><a href="#h93-12-33" id="h93-12-33" class="i">+            ),
</a><a href="#h93-12-34" id="h93-12-34" class="i">+        ),
</a><a href="#h93-12-35" id="h93-12-35" class="i">+    ],
</a><a href="#h93-12-36" id="h93-12-36" class="i">+}
</a> 
<b>diff --git a/<a id="h94" href="../file/tests/sql/query/order_float_asc.html">tests/sql/query/order_float_asc</a> b/<a href="../file/tests/sql/query/order_float_asc.html">tests/sql/query/order_float_asc</a></b>
<a href="#h94-0" id="h94-0" class="h">@@ -35,8 +35,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h94-0-3" id="h94-0-3" class="d">-Plan: Select(
</a><a href="#h94-0-4" id="h94-0-4" class="d">-    Order {
</a><a href="#h94-0-5" id="h94-0-5" class="i">+Plan: Select {
</a><a href="#h94-0-6" id="h94-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;floats&quot;,
<a href="#h94-1" id="h94-1" class="h">@@ -64,8 +64,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h94-1-3" id="h94-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h94-1-5" id="h94-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h94-2" id="h94-2" class="h">@@ -82,10 +82,28 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h94-2-3" id="h94-2-3" class="d">-)
</a><a href="#h94-2-4" id="h94-2-4" class="i">+    labels: [
</a><a href="#h94-2-5" id="h94-2-5" class="i">+        Some(
</a><a href="#h94-2-6" id="h94-2-6" class="i">+            (
</a><a href="#h94-2-7" id="h94-2-7" class="i">+                Some(
</a><a href="#h94-2-8" id="h94-2-8" class="i">+                    &quot;floats&quot;,
</a><a href="#h94-2-9" id="h94-2-9" class="i">+                ),
</a><a href="#h94-2-10" id="h94-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h94-2-11" id="h94-2-11" class="i">+            ),
</a><a href="#h94-2-12" id="h94-2-12" class="i">+        ),
</a><a href="#h94-2-13" id="h94-2-13" class="i">+        Some(
</a><a href="#h94-2-14" id="h94-2-14" class="i">+            (
</a><a href="#h94-2-15" id="h94-2-15" class="i">+                Some(
</a><a href="#h94-2-16" id="h94-2-16" class="i">+                    &quot;floats&quot;,
</a><a href="#h94-2-17" id="h94-2-17" class="i">+                ),
</a><a href="#h94-2-18" id="h94-2-18" class="i">+                &quot;value&quot;,
</a><a href="#h94-2-19" id="h94-2-19" class="i">+            ),
</a><a href="#h94-2-20" id="h94-2-20" class="i">+        ),
</a><a href="#h94-2-21" id="h94-2-21" class="i">+    ],
</a><a href="#h94-2-22" id="h94-2-22" class="i">+}
</a> 
<a href="#h94-2-24" id="h94-2-24" class="d">-Optimized plan: Select(
</a><a href="#h94-2-25" id="h94-2-25" class="d">-    Order {
</a><a href="#h94-2-26" id="h94-2-26" class="i">+Optimized plan: Select {
</a><a href="#h94-2-27" id="h94-2-27" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;floats&quot;,
<a href="#h94-3" id="h94-3" class="h">@@ -113,8 +131,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h94-3-3" id="h94-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h94-3-5" id="h94-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h94-4" id="h94-4" class="h">@@ -131,5 +149,23 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h94-4-3" id="h94-4-3" class="d">-)
</a><a href="#h94-4-4" id="h94-4-4" class="i">+    labels: [
</a><a href="#h94-4-5" id="h94-4-5" class="i">+        Some(
</a><a href="#h94-4-6" id="h94-4-6" class="i">+            (
</a><a href="#h94-4-7" id="h94-4-7" class="i">+                Some(
</a><a href="#h94-4-8" id="h94-4-8" class="i">+                    &quot;floats&quot;,
</a><a href="#h94-4-9" id="h94-4-9" class="i">+                ),
</a><a href="#h94-4-10" id="h94-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h94-4-11" id="h94-4-11" class="i">+            ),
</a><a href="#h94-4-12" id="h94-4-12" class="i">+        ),
</a><a href="#h94-4-13" id="h94-4-13" class="i">+        Some(
</a><a href="#h94-4-14" id="h94-4-14" class="i">+            (
</a><a href="#h94-4-15" id="h94-4-15" class="i">+                Some(
</a><a href="#h94-4-16" id="h94-4-16" class="i">+                    &quot;floats&quot;,
</a><a href="#h94-4-17" id="h94-4-17" class="i">+                ),
</a><a href="#h94-4-18" id="h94-4-18" class="i">+                &quot;value&quot;,
</a><a href="#h94-4-19" id="h94-4-19" class="i">+            ),
</a><a href="#h94-4-20" id="h94-4-20" class="i">+        ),
</a><a href="#h94-4-21" id="h94-4-21" class="i">+    ],
</a><a href="#h94-4-22" id="h94-4-22" class="i">+}
</a> 
<b>diff --git a/<a id="h95" href="../file/tests/sql/query/order_float_desc.html">tests/sql/query/order_float_desc</a> b/<a href="../file/tests/sql/query/order_float_desc.html">tests/sql/query/order_float_desc</a></b>
<a href="#h95-0" id="h95-0" class="h">@@ -35,8 +35,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h95-0-3" id="h95-0-3" class="d">-Plan: Select(
</a><a href="#h95-0-4" id="h95-0-4" class="d">-    Order {
</a><a href="#h95-0-5" id="h95-0-5" class="i">+Plan: Select {
</a><a href="#h95-0-6" id="h95-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;floats&quot;,
<a href="#h95-1" id="h95-1" class="h">@@ -64,8 +64,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h95-1-3" id="h95-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h95-1-5" id="h95-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h95-2" id="h95-2" class="h">@@ -82,10 +82,28 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h95-2-3" id="h95-2-3" class="d">-)
</a><a href="#h95-2-4" id="h95-2-4" class="i">+    labels: [
</a><a href="#h95-2-5" id="h95-2-5" class="i">+        Some(
</a><a href="#h95-2-6" id="h95-2-6" class="i">+            (
</a><a href="#h95-2-7" id="h95-2-7" class="i">+                Some(
</a><a href="#h95-2-8" id="h95-2-8" class="i">+                    &quot;floats&quot;,
</a><a href="#h95-2-9" id="h95-2-9" class="i">+                ),
</a><a href="#h95-2-10" id="h95-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h95-2-11" id="h95-2-11" class="i">+            ),
</a><a href="#h95-2-12" id="h95-2-12" class="i">+        ),
</a><a href="#h95-2-13" id="h95-2-13" class="i">+        Some(
</a><a href="#h95-2-14" id="h95-2-14" class="i">+            (
</a><a href="#h95-2-15" id="h95-2-15" class="i">+                Some(
</a><a href="#h95-2-16" id="h95-2-16" class="i">+                    &quot;floats&quot;,
</a><a href="#h95-2-17" id="h95-2-17" class="i">+                ),
</a><a href="#h95-2-18" id="h95-2-18" class="i">+                &quot;value&quot;,
</a><a href="#h95-2-19" id="h95-2-19" class="i">+            ),
</a><a href="#h95-2-20" id="h95-2-20" class="i">+        ),
</a><a href="#h95-2-21" id="h95-2-21" class="i">+    ],
</a><a href="#h95-2-22" id="h95-2-22" class="i">+}
</a> 
<a href="#h95-2-24" id="h95-2-24" class="d">-Optimized plan: Select(
</a><a href="#h95-2-25" id="h95-2-25" class="d">-    Order {
</a><a href="#h95-2-26" id="h95-2-26" class="i">+Optimized plan: Select {
</a><a href="#h95-2-27" id="h95-2-27" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;floats&quot;,
<a href="#h95-3" id="h95-3" class="h">@@ -113,8 +131,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h95-3-3" id="h95-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h95-3-5" id="h95-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h95-4" id="h95-4" class="h">@@ -131,5 +149,23 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h95-4-3" id="h95-4-3" class="d">-)
</a><a href="#h95-4-4" id="h95-4-4" class="i">+    labels: [
</a><a href="#h95-4-5" id="h95-4-5" class="i">+        Some(
</a><a href="#h95-4-6" id="h95-4-6" class="i">+            (
</a><a href="#h95-4-7" id="h95-4-7" class="i">+                Some(
</a><a href="#h95-4-8" id="h95-4-8" class="i">+                    &quot;floats&quot;,
</a><a href="#h95-4-9" id="h95-4-9" class="i">+                ),
</a><a href="#h95-4-10" id="h95-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h95-4-11" id="h95-4-11" class="i">+            ),
</a><a href="#h95-4-12" id="h95-4-12" class="i">+        ),
</a><a href="#h95-4-13" id="h95-4-13" class="i">+        Some(
</a><a href="#h95-4-14" id="h95-4-14" class="i">+            (
</a><a href="#h95-4-15" id="h95-4-15" class="i">+                Some(
</a><a href="#h95-4-16" id="h95-4-16" class="i">+                    &quot;floats&quot;,
</a><a href="#h95-4-17" id="h95-4-17" class="i">+                ),
</a><a href="#h95-4-18" id="h95-4-18" class="i">+                &quot;value&quot;,
</a><a href="#h95-4-19" id="h95-4-19" class="i">+            ),
</a><a href="#h95-4-20" id="h95-4-20" class="i">+        ),
</a><a href="#h95-4-21" id="h95-4-21" class="i">+    ],
</a><a href="#h95-4-22" id="h95-4-22" class="i">+}
</a> 
<b>diff --git a/<a id="h96" href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a> b/<a href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a></b>
<a href="#h96-0" id="h96-0" class="h">@@ -4,7 +4,7 @@ Explain:
</a> Projection: #0
 └─ Order: movies.studio_id asc
    └─ Projection: #0, movies.studio_id
<a href="#h96-0-3" id="h96-0-3" class="d">-      └─ Aggregation: maximum
</a><a href="#h96-0-4" id="h96-0-4" class="i">+      └─ Aggregation: max
</a>          └─ Projection: rating, studio_id
             └─ Scan: movies
 
<a href="#h96-1" id="h96-1" class="h">@@ -56,8 +56,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h96-1-3" id="h96-1-3" class="d">-Plan: Select(
</a><a href="#h96-1-4" id="h96-1-4" class="d">-    Projection {
</a><a href="#h96-1-5" id="h96-1-5" class="i">+Plan: Select {
</a><a href="#h96-1-6" id="h96-1-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: Aggregation {
<a href="#h96-2" id="h96-2" class="h">@@ -140,13 +140,9 @@ Plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h96-2-3" id="h96-2-3" class="d">-                            alias: None,
</a>                             filter: None,
<a href="#h96-2-5" id="h96-2-5" class="i">+                            alias: None,
</a>                         },
<a href="#h96-2-7" id="h96-2-7" class="d">-                        labels: [
</a><a href="#h96-2-8" id="h96-2-8" class="d">-                            None,
</a><a href="#h96-2-9" id="h96-2-9" class="d">-                            None,
</a><a href="#h96-2-10" id="h96-2-10" class="d">-                        ],
</a>                         expressions: [
                             Field(
                                 5,
<a href="#h96-3" id="h96-3" class="h">@@ -167,15 +163,15 @@ Plan: Select(
</a>                                 ),
                             ),
                         ],
<a href="#h96-3-3" id="h96-3-3" class="i">+                        labels: [
</a><a href="#h96-3-4" id="h96-3-4" class="i">+                            None,
</a><a href="#h96-3-5" id="h96-3-5" class="i">+                            None,
</a><a href="#h96-3-6" id="h96-3-6" class="i">+                        ],
</a>                     },
                     aggregates: [
                         Max,
                     ],
                 },
<a href="#h96-3-12" id="h96-3-12" class="d">-                labels: [
</a><a href="#h96-3-13" id="h96-3-13" class="d">-                    None,
</a><a href="#h96-3-14" id="h96-3-14" class="d">-                    None,
</a><a href="#h96-3-15" id="h96-3-15" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h96-4" id="h96-4" class="h">@@ -193,6 +189,10 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h96-4-3" id="h96-4-3" class="i">+                labels: [
</a><a href="#h96-4-4" id="h96-4-4" class="i">+                    None,
</a><a href="#h96-4-5" id="h96-4-5" class="i">+                    None,
</a><a href="#h96-4-6" id="h96-4-6" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h96-5" id="h96-5" class="h">@@ -211,20 +211,23 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h96-5-3" id="h96-5-3" class="d">-        labels: [
</a><a href="#h96-5-4" id="h96-5-4" class="d">-            None,
</a><a href="#h96-5-5" id="h96-5-5" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
                 None,
             ),
         ],
<a href="#h96-5-12" id="h96-5-12" class="i">+        labels: [
</a><a href="#h96-5-13" id="h96-5-13" class="i">+            None,
</a><a href="#h96-5-14" id="h96-5-14" class="i">+        ],
</a>     },
<a href="#h96-5-16" id="h96-5-16" class="d">-)
</a><a href="#h96-5-17" id="h96-5-17" class="i">+    labels: [
</a><a href="#h96-5-18" id="h96-5-18" class="i">+        None,
</a><a href="#h96-5-19" id="h96-5-19" class="i">+    ],
</a><a href="#h96-5-20" id="h96-5-20" class="i">+}
</a> 
<a href="#h96-5-22" id="h96-5-22" class="d">-Optimized plan: Select(
</a><a href="#h96-5-23" id="h96-5-23" class="d">-    Projection {
</a><a href="#h96-5-24" id="h96-5-24" class="i">+Optimized plan: Select {
</a><a href="#h96-5-25" id="h96-5-25" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: Aggregation {
<a href="#h96-6" id="h96-6" class="h">@@ -307,13 +310,9 @@ Optimized plan: Select(
</a>                                     },
                                 ],
                             },
<a href="#h96-6-3" id="h96-6-3" class="d">-                            alias: None,
</a>                             filter: None,
<a href="#h96-6-5" id="h96-6-5" class="i">+                            alias: None,
</a>                         },
<a href="#h96-6-7" id="h96-6-7" class="d">-                        labels: [
</a><a href="#h96-6-8" id="h96-6-8" class="d">-                            None,
</a><a href="#h96-6-9" id="h96-6-9" class="d">-                            None,
</a><a href="#h96-6-10" id="h96-6-10" class="d">-                        ],
</a>                         expressions: [
                             Field(
                                 5,
<a href="#h96-7" id="h96-7" class="h">@@ -334,15 +333,15 @@ Optimized plan: Select(
</a>                                 ),
                             ),
                         ],
<a href="#h96-7-3" id="h96-7-3" class="i">+                        labels: [
</a><a href="#h96-7-4" id="h96-7-4" class="i">+                            None,
</a><a href="#h96-7-5" id="h96-7-5" class="i">+                            None,
</a><a href="#h96-7-6" id="h96-7-6" class="i">+                        ],
</a>                     },
                     aggregates: [
                         Max,
                     ],
                 },
<a href="#h96-7-12" id="h96-7-12" class="d">-                labels: [
</a><a href="#h96-7-13" id="h96-7-13" class="d">-                    None,
</a><a href="#h96-7-14" id="h96-7-14" class="d">-                    None,
</a><a href="#h96-7-15" id="h96-7-15" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h96-8" id="h96-8" class="h">@@ -360,6 +359,10 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h96-8-3" id="h96-8-3" class="i">+                labels: [
</a><a href="#h96-8-4" id="h96-8-4" class="i">+                    None,
</a><a href="#h96-8-5" id="h96-8-5" class="i">+                    None,
</a><a href="#h96-8-6" id="h96-8-6" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h96-9" id="h96-9" class="h">@@ -378,15 +381,18 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h96-9-3" id="h96-9-3" class="d">-        labels: [
</a><a href="#h96-9-4" id="h96-9-4" class="d">-            None,
</a><a href="#h96-9-5" id="h96-9-5" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
                 None,
             ),
         ],
<a href="#h96-9-12" id="h96-9-12" class="i">+        labels: [
</a><a href="#h96-9-13" id="h96-9-13" class="i">+            None,
</a><a href="#h96-9-14" id="h96-9-14" class="i">+        ],
</a>     },
<a href="#h96-9-16" id="h96-9-16" class="d">-)
</a><a href="#h96-9-17" id="h96-9-17" class="i">+    labels: [
</a><a href="#h96-9-18" id="h96-9-18" class="i">+        None,
</a><a href="#h96-9-19" id="h96-9-19" class="i">+    ],
</a><a href="#h96-9-20" id="h96-9-20" class="i">+}
</a> 
<b>diff --git a/<a id="h97" href="../file/tests/sql/query/order_integer_asc.html">tests/sql/query/order_integer_asc</a> b/<a href="../file/tests/sql/query/order_integer_asc.html">tests/sql/query/order_integer_asc</a></b>
<a href="#h97-0" id="h97-0" class="h">@@ -35,8 +35,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h97-0-3" id="h97-0-3" class="d">-Plan: Select(
</a><a href="#h97-0-4" id="h97-0-4" class="d">-    Order {
</a><a href="#h97-0-5" id="h97-0-5" class="i">+Plan: Select {
</a><a href="#h97-0-6" id="h97-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;integers&quot;,
<a href="#h97-1" id="h97-1" class="h">@@ -64,8 +64,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h97-1-3" id="h97-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h97-1-5" id="h97-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h97-2" id="h97-2" class="h">@@ -82,10 +82,28 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h97-2-3" id="h97-2-3" class="d">-)
</a><a href="#h97-2-4" id="h97-2-4" class="i">+    labels: [
</a><a href="#h97-2-5" id="h97-2-5" class="i">+        Some(
</a><a href="#h97-2-6" id="h97-2-6" class="i">+            (
</a><a href="#h97-2-7" id="h97-2-7" class="i">+                Some(
</a><a href="#h97-2-8" id="h97-2-8" class="i">+                    &quot;integers&quot;,
</a><a href="#h97-2-9" id="h97-2-9" class="i">+                ),
</a><a href="#h97-2-10" id="h97-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h97-2-11" id="h97-2-11" class="i">+            ),
</a><a href="#h97-2-12" id="h97-2-12" class="i">+        ),
</a><a href="#h97-2-13" id="h97-2-13" class="i">+        Some(
</a><a href="#h97-2-14" id="h97-2-14" class="i">+            (
</a><a href="#h97-2-15" id="h97-2-15" class="i">+                Some(
</a><a href="#h97-2-16" id="h97-2-16" class="i">+                    &quot;integers&quot;,
</a><a href="#h97-2-17" id="h97-2-17" class="i">+                ),
</a><a href="#h97-2-18" id="h97-2-18" class="i">+                &quot;value&quot;,
</a><a href="#h97-2-19" id="h97-2-19" class="i">+            ),
</a><a href="#h97-2-20" id="h97-2-20" class="i">+        ),
</a><a href="#h97-2-21" id="h97-2-21" class="i">+    ],
</a><a href="#h97-2-22" id="h97-2-22" class="i">+}
</a> 
<a href="#h97-2-24" id="h97-2-24" class="d">-Optimized plan: Select(
</a><a href="#h97-2-25" id="h97-2-25" class="d">-    Order {
</a><a href="#h97-2-26" id="h97-2-26" class="i">+Optimized plan: Select {
</a><a href="#h97-2-27" id="h97-2-27" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;integers&quot;,
<a href="#h97-3" id="h97-3" class="h">@@ -113,8 +131,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h97-3-3" id="h97-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h97-3-5" id="h97-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h97-4" id="h97-4" class="h">@@ -131,5 +149,23 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h97-4-3" id="h97-4-3" class="d">-)
</a><a href="#h97-4-4" id="h97-4-4" class="i">+    labels: [
</a><a href="#h97-4-5" id="h97-4-5" class="i">+        Some(
</a><a href="#h97-4-6" id="h97-4-6" class="i">+            (
</a><a href="#h97-4-7" id="h97-4-7" class="i">+                Some(
</a><a href="#h97-4-8" id="h97-4-8" class="i">+                    &quot;integers&quot;,
</a><a href="#h97-4-9" id="h97-4-9" class="i">+                ),
</a><a href="#h97-4-10" id="h97-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h97-4-11" id="h97-4-11" class="i">+            ),
</a><a href="#h97-4-12" id="h97-4-12" class="i">+        ),
</a><a href="#h97-4-13" id="h97-4-13" class="i">+        Some(
</a><a href="#h97-4-14" id="h97-4-14" class="i">+            (
</a><a href="#h97-4-15" id="h97-4-15" class="i">+                Some(
</a><a href="#h97-4-16" id="h97-4-16" class="i">+                    &quot;integers&quot;,
</a><a href="#h97-4-17" id="h97-4-17" class="i">+                ),
</a><a href="#h97-4-18" id="h97-4-18" class="i">+                &quot;value&quot;,
</a><a href="#h97-4-19" id="h97-4-19" class="i">+            ),
</a><a href="#h97-4-20" id="h97-4-20" class="i">+        ),
</a><a href="#h97-4-21" id="h97-4-21" class="i">+    ],
</a><a href="#h97-4-22" id="h97-4-22" class="i">+}
</a> 
<b>diff --git a/<a id="h98" href="../file/tests/sql/query/order_integer_desc.html">tests/sql/query/order_integer_desc</a> b/<a href="../file/tests/sql/query/order_integer_desc.html">tests/sql/query/order_integer_desc</a></b>
<a href="#h98-0" id="h98-0" class="h">@@ -35,8 +35,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h98-0-3" id="h98-0-3" class="d">-Plan: Select(
</a><a href="#h98-0-4" id="h98-0-4" class="d">-    Order {
</a><a href="#h98-0-5" id="h98-0-5" class="i">+Plan: Select {
</a><a href="#h98-0-6" id="h98-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;integers&quot;,
<a href="#h98-1" id="h98-1" class="h">@@ -64,8 +64,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h98-1-3" id="h98-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h98-1-5" id="h98-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h98-2" id="h98-2" class="h">@@ -82,10 +82,28 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h98-2-3" id="h98-2-3" class="d">-)
</a><a href="#h98-2-4" id="h98-2-4" class="i">+    labels: [
</a><a href="#h98-2-5" id="h98-2-5" class="i">+        Some(
</a><a href="#h98-2-6" id="h98-2-6" class="i">+            (
</a><a href="#h98-2-7" id="h98-2-7" class="i">+                Some(
</a><a href="#h98-2-8" id="h98-2-8" class="i">+                    &quot;integers&quot;,
</a><a href="#h98-2-9" id="h98-2-9" class="i">+                ),
</a><a href="#h98-2-10" id="h98-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h98-2-11" id="h98-2-11" class="i">+            ),
</a><a href="#h98-2-12" id="h98-2-12" class="i">+        ),
</a><a href="#h98-2-13" id="h98-2-13" class="i">+        Some(
</a><a href="#h98-2-14" id="h98-2-14" class="i">+            (
</a><a href="#h98-2-15" id="h98-2-15" class="i">+                Some(
</a><a href="#h98-2-16" id="h98-2-16" class="i">+                    &quot;integers&quot;,
</a><a href="#h98-2-17" id="h98-2-17" class="i">+                ),
</a><a href="#h98-2-18" id="h98-2-18" class="i">+                &quot;value&quot;,
</a><a href="#h98-2-19" id="h98-2-19" class="i">+            ),
</a><a href="#h98-2-20" id="h98-2-20" class="i">+        ),
</a><a href="#h98-2-21" id="h98-2-21" class="i">+    ],
</a><a href="#h98-2-22" id="h98-2-22" class="i">+}
</a> 
<a href="#h98-2-24" id="h98-2-24" class="d">-Optimized plan: Select(
</a><a href="#h98-2-25" id="h98-2-25" class="d">-    Order {
</a><a href="#h98-2-26" id="h98-2-26" class="i">+Optimized plan: Select {
</a><a href="#h98-2-27" id="h98-2-27" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;integers&quot;,
<a href="#h98-3" id="h98-3" class="h">@@ -113,8 +131,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h98-3-3" id="h98-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h98-3-5" id="h98-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h98-4" id="h98-4" class="h">@@ -131,5 +149,23 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h98-4-3" id="h98-4-3" class="d">-)
</a><a href="#h98-4-4" id="h98-4-4" class="i">+    labels: [
</a><a href="#h98-4-5" id="h98-4-5" class="i">+        Some(
</a><a href="#h98-4-6" id="h98-4-6" class="i">+            (
</a><a href="#h98-4-7" id="h98-4-7" class="i">+                Some(
</a><a href="#h98-4-8" id="h98-4-8" class="i">+                    &quot;integers&quot;,
</a><a href="#h98-4-9" id="h98-4-9" class="i">+                ),
</a><a href="#h98-4-10" id="h98-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h98-4-11" id="h98-4-11" class="i">+            ),
</a><a href="#h98-4-12" id="h98-4-12" class="i">+        ),
</a><a href="#h98-4-13" id="h98-4-13" class="i">+        Some(
</a><a href="#h98-4-14" id="h98-4-14" class="i">+            (
</a><a href="#h98-4-15" id="h98-4-15" class="i">+                Some(
</a><a href="#h98-4-16" id="h98-4-16" class="i">+                    &quot;integers&quot;,
</a><a href="#h98-4-17" id="h98-4-17" class="i">+                ),
</a><a href="#h98-4-18" id="h98-4-18" class="i">+                &quot;value&quot;,
</a><a href="#h98-4-19" id="h98-4-19" class="i">+            ),
</a><a href="#h98-4-20" id="h98-4-20" class="i">+        ),
</a><a href="#h98-4-21" id="h98-4-21" class="i">+    ],
</a><a href="#h98-4-22" id="h98-4-22" class="i">+}
</a> 
<b>diff --git a/<a id="h99" href="../file/tests/sql/query/order_multi.html">tests/sql/query/order_multi</a> b/<a href="../file/tests/sql/query/order_multi.html">tests/sql/query/order_multi</a></b>
<a href="#h99-0" id="h99-0" class="h">@@ -47,8 +47,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h99-0-3" id="h99-0-3" class="d">-Plan: Select(
</a><a href="#h99-0-4" id="h99-0-4" class="d">-    Order {
</a><a href="#h99-0-5" id="h99-0-5" class="i">+Plan: Select {
</a><a href="#h99-0-6" id="h99-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h99-1" id="h99-1" class="h">@@ -127,8 +127,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h99-1-3" id="h99-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h99-1-5" id="h99-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h99-2" id="h99-2" class="h">@@ -157,10 +157,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h99-2-3" id="h99-2-3" class="d">-)
</a><a href="#h99-2-4" id="h99-2-4" class="i">+    labels: [
</a><a href="#h99-2-5" id="h99-2-5" class="i">+        Some(
</a><a href="#h99-2-6" id="h99-2-6" class="i">+            (
</a><a href="#h99-2-7" id="h99-2-7" class="i">+                Some(
</a><a href="#h99-2-8" id="h99-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-2-9" id="h99-2-9" class="i">+                ),
</a><a href="#h99-2-10" id="h99-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h99-2-11" id="h99-2-11" class="i">+            ),
</a><a href="#h99-2-12" id="h99-2-12" class="i">+        ),
</a><a href="#h99-2-13" id="h99-2-13" class="i">+        Some(
</a><a href="#h99-2-14" id="h99-2-14" class="i">+            (
</a><a href="#h99-2-15" id="h99-2-15" class="i">+                Some(
</a><a href="#h99-2-16" id="h99-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-2-17" id="h99-2-17" class="i">+                ),
</a><a href="#h99-2-18" id="h99-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h99-2-19" id="h99-2-19" class="i">+            ),
</a><a href="#h99-2-20" id="h99-2-20" class="i">+        ),
</a><a href="#h99-2-21" id="h99-2-21" class="i">+        Some(
</a><a href="#h99-2-22" id="h99-2-22" class="i">+            (
</a><a href="#h99-2-23" id="h99-2-23" class="i">+                Some(
</a><a href="#h99-2-24" id="h99-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-2-25" id="h99-2-25" class="i">+                ),
</a><a href="#h99-2-26" id="h99-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h99-2-27" id="h99-2-27" class="i">+            ),
</a><a href="#h99-2-28" id="h99-2-28" class="i">+        ),
</a><a href="#h99-2-29" id="h99-2-29" class="i">+        Some(
</a><a href="#h99-2-30" id="h99-2-30" class="i">+            (
</a><a href="#h99-2-31" id="h99-2-31" class="i">+                Some(
</a><a href="#h99-2-32" id="h99-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-2-33" id="h99-2-33" class="i">+                ),
</a><a href="#h99-2-34" id="h99-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h99-2-35" id="h99-2-35" class="i">+            ),
</a><a href="#h99-2-36" id="h99-2-36" class="i">+        ),
</a><a href="#h99-2-37" id="h99-2-37" class="i">+        Some(
</a><a href="#h99-2-38" id="h99-2-38" class="i">+            (
</a><a href="#h99-2-39" id="h99-2-39" class="i">+                Some(
</a><a href="#h99-2-40" id="h99-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-2-41" id="h99-2-41" class="i">+                ),
</a><a href="#h99-2-42" id="h99-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h99-2-43" id="h99-2-43" class="i">+            ),
</a><a href="#h99-2-44" id="h99-2-44" class="i">+        ),
</a><a href="#h99-2-45" id="h99-2-45" class="i">+        Some(
</a><a href="#h99-2-46" id="h99-2-46" class="i">+            (
</a><a href="#h99-2-47" id="h99-2-47" class="i">+                Some(
</a><a href="#h99-2-48" id="h99-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-2-49" id="h99-2-49" class="i">+                ),
</a><a href="#h99-2-50" id="h99-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h99-2-51" id="h99-2-51" class="i">+            ),
</a><a href="#h99-2-52" id="h99-2-52" class="i">+        ),
</a><a href="#h99-2-53" id="h99-2-53" class="i">+        Some(
</a><a href="#h99-2-54" id="h99-2-54" class="i">+            (
</a><a href="#h99-2-55" id="h99-2-55" class="i">+                Some(
</a><a href="#h99-2-56" id="h99-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-2-57" id="h99-2-57" class="i">+                ),
</a><a href="#h99-2-58" id="h99-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h99-2-59" id="h99-2-59" class="i">+            ),
</a><a href="#h99-2-60" id="h99-2-60" class="i">+        ),
</a><a href="#h99-2-61" id="h99-2-61" class="i">+    ],
</a><a href="#h99-2-62" id="h99-2-62" class="i">+}
</a> 
<a href="#h99-2-64" id="h99-2-64" class="d">-Optimized plan: Select(
</a><a href="#h99-2-65" id="h99-2-65" class="d">-    Order {
</a><a href="#h99-2-66" id="h99-2-66" class="i">+Optimized plan: Select {
</a><a href="#h99-2-67" id="h99-2-67" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h99-3" id="h99-3" class="h">@@ -239,8 +297,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h99-3-3" id="h99-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h99-3-5" id="h99-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h99-4" id="h99-4" class="h">@@ -269,5 +327,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h99-4-3" id="h99-4-3" class="d">-)
</a><a href="#h99-4-4" id="h99-4-4" class="i">+    labels: [
</a><a href="#h99-4-5" id="h99-4-5" class="i">+        Some(
</a><a href="#h99-4-6" id="h99-4-6" class="i">+            (
</a><a href="#h99-4-7" id="h99-4-7" class="i">+                Some(
</a><a href="#h99-4-8" id="h99-4-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-4-9" id="h99-4-9" class="i">+                ),
</a><a href="#h99-4-10" id="h99-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h99-4-11" id="h99-4-11" class="i">+            ),
</a><a href="#h99-4-12" id="h99-4-12" class="i">+        ),
</a><a href="#h99-4-13" id="h99-4-13" class="i">+        Some(
</a><a href="#h99-4-14" id="h99-4-14" class="i">+            (
</a><a href="#h99-4-15" id="h99-4-15" class="i">+                Some(
</a><a href="#h99-4-16" id="h99-4-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-4-17" id="h99-4-17" class="i">+                ),
</a><a href="#h99-4-18" id="h99-4-18" class="i">+                &quot;title&quot;,
</a><a href="#h99-4-19" id="h99-4-19" class="i">+            ),
</a><a href="#h99-4-20" id="h99-4-20" class="i">+        ),
</a><a href="#h99-4-21" id="h99-4-21" class="i">+        Some(
</a><a href="#h99-4-22" id="h99-4-22" class="i">+            (
</a><a href="#h99-4-23" id="h99-4-23" class="i">+                Some(
</a><a href="#h99-4-24" id="h99-4-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-4-25" id="h99-4-25" class="i">+                ),
</a><a href="#h99-4-26" id="h99-4-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h99-4-27" id="h99-4-27" class="i">+            ),
</a><a href="#h99-4-28" id="h99-4-28" class="i">+        ),
</a><a href="#h99-4-29" id="h99-4-29" class="i">+        Some(
</a><a href="#h99-4-30" id="h99-4-30" class="i">+            (
</a><a href="#h99-4-31" id="h99-4-31" class="i">+                Some(
</a><a href="#h99-4-32" id="h99-4-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-4-33" id="h99-4-33" class="i">+                ),
</a><a href="#h99-4-34" id="h99-4-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h99-4-35" id="h99-4-35" class="i">+            ),
</a><a href="#h99-4-36" id="h99-4-36" class="i">+        ),
</a><a href="#h99-4-37" id="h99-4-37" class="i">+        Some(
</a><a href="#h99-4-38" id="h99-4-38" class="i">+            (
</a><a href="#h99-4-39" id="h99-4-39" class="i">+                Some(
</a><a href="#h99-4-40" id="h99-4-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-4-41" id="h99-4-41" class="i">+                ),
</a><a href="#h99-4-42" id="h99-4-42" class="i">+                &quot;released&quot;,
</a><a href="#h99-4-43" id="h99-4-43" class="i">+            ),
</a><a href="#h99-4-44" id="h99-4-44" class="i">+        ),
</a><a href="#h99-4-45" id="h99-4-45" class="i">+        Some(
</a><a href="#h99-4-46" id="h99-4-46" class="i">+            (
</a><a href="#h99-4-47" id="h99-4-47" class="i">+                Some(
</a><a href="#h99-4-48" id="h99-4-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-4-49" id="h99-4-49" class="i">+                ),
</a><a href="#h99-4-50" id="h99-4-50" class="i">+                &quot;rating&quot;,
</a><a href="#h99-4-51" id="h99-4-51" class="i">+            ),
</a><a href="#h99-4-52" id="h99-4-52" class="i">+        ),
</a><a href="#h99-4-53" id="h99-4-53" class="i">+        Some(
</a><a href="#h99-4-54" id="h99-4-54" class="i">+            (
</a><a href="#h99-4-55" id="h99-4-55" class="i">+                Some(
</a><a href="#h99-4-56" id="h99-4-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h99-4-57" id="h99-4-57" class="i">+                ),
</a><a href="#h99-4-58" id="h99-4-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h99-4-59" id="h99-4-59" class="i">+            ),
</a><a href="#h99-4-60" id="h99-4-60" class="i">+        ),
</a><a href="#h99-4-61" id="h99-4-61" class="i">+    ],
</a><a href="#h99-4-62" id="h99-4-62" class="i">+}
</a> 
<b>diff --git a/<a id="h100" href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a> b/<a href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a></b>
<a href="#h100-0" id="h100-0" class="h">@@ -57,8 +57,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h100-0-3" id="h100-0-3" class="d">-Plan: Select(
</a><a href="#h100-0-4" id="h100-0-4" class="d">-    Projection {
</a><a href="#h100-0-5" id="h100-0-5" class="i">+Plan: Select {
</a><a href="#h100-0-6" id="h100-0-6" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: Scan {
<a href="#h100-1" id="h100-1" class="h">@@ -139,14 +139,9 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h100-1-3" id="h100-1-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h100-1-5" id="h100-1-5" class="i">+                    alias: None,
</a>                 },
<a href="#h100-1-7" id="h100-1-7" class="d">-                labels: [
</a><a href="#h100-1-8" id="h100-1-8" class="d">-                    None,
</a><a href="#h100-1-9" id="h100-1-9" class="d">-                    None,
</a><a href="#h100-1-10" id="h100-1-10" class="d">-                    None,
</a><a href="#h100-1-11" id="h100-1-11" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h100-2" id="h100-2" class="h">@@ -176,6 +171,11 @@ Plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h100-2-3" id="h100-2-3" class="i">+                labels: [
</a><a href="#h100-2-4" id="h100-2-4" class="i">+                    None,
</a><a href="#h100-2-5" id="h100-2-5" class="i">+                    None,
</a><a href="#h100-2-6" id="h100-2-6" class="i">+                    None,
</a><a href="#h100-2-7" id="h100-2-7" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h100-3" id="h100-3" class="h">@@ -194,10 +194,6 @@ Plan: Select(
</a>                 ),
             ],
         },
<a href="#h100-3-3" id="h100-3-3" class="d">-        labels: [
</a><a href="#h100-3-4" id="h100-3-4" class="d">-            None,
</a><a href="#h100-3-5" id="h100-3-5" class="d">-            None,
</a><a href="#h100-3-6" id="h100-3-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h100-4" id="h100-4" class="h">@@ -208,11 +204,33 @@ Plan: Select(
</a>                 None,
             ),
         ],
<a href="#h100-4-3" id="h100-4-3" class="i">+        labels: [
</a><a href="#h100-4-4" id="h100-4-4" class="i">+            None,
</a><a href="#h100-4-5" id="h100-4-5" class="i">+            None,
</a><a href="#h100-4-6" id="h100-4-6" class="i">+        ],
</a>     },
<a href="#h100-4-8" id="h100-4-8" class="d">-)
</a><a href="#h100-4-9" id="h100-4-9" class="i">+    labels: [
</a><a href="#h100-4-10" id="h100-4-10" class="i">+        Some(
</a><a href="#h100-4-11" id="h100-4-11" class="i">+            (
</a><a href="#h100-4-12" id="h100-4-12" class="i">+                Some(
</a><a href="#h100-4-13" id="h100-4-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h100-4-14" id="h100-4-14" class="i">+                ),
</a><a href="#h100-4-15" id="h100-4-15" class="i">+                &quot;id&quot;,
</a><a href="#h100-4-16" id="h100-4-16" class="i">+            ),
</a><a href="#h100-4-17" id="h100-4-17" class="i">+        ),
</a><a href="#h100-4-18" id="h100-4-18" class="i">+        Some(
</a><a href="#h100-4-19" id="h100-4-19" class="i">+            (
</a><a href="#h100-4-20" id="h100-4-20" class="i">+                Some(
</a><a href="#h100-4-21" id="h100-4-21" class="i">+                    &quot;movies&quot;,
</a><a href="#h100-4-22" id="h100-4-22" class="i">+                ),
</a><a href="#h100-4-23" id="h100-4-23" class="i">+                &quot;title&quot;,
</a><a href="#h100-4-24" id="h100-4-24" class="i">+            ),
</a><a href="#h100-4-25" id="h100-4-25" class="i">+        ),
</a><a href="#h100-4-26" id="h100-4-26" class="i">+    ],
</a><a href="#h100-4-27" id="h100-4-27" class="i">+}
</a> 
<a href="#h100-4-29" id="h100-4-29" class="d">-Optimized plan: Select(
</a><a href="#h100-4-30" id="h100-4-30" class="d">-    Projection {
</a><a href="#h100-4-31" id="h100-4-31" class="i">+Optimized plan: Select {
</a><a href="#h100-4-32" id="h100-4-32" class="i">+    root: Projection {
</a>         source: Order {
             source: Projection {
                 source: Scan {
<a href="#h100-5" id="h100-5" class="h">@@ -293,14 +311,9 @@ Optimized plan: Select(
</a>                             },
                         ],
                     },
<a href="#h100-5-3" id="h100-5-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h100-5-5" id="h100-5-5" class="i">+                    alias: None,
</a>                 },
<a href="#h100-5-7" id="h100-5-7" class="d">-                labels: [
</a><a href="#h100-5-8" id="h100-5-8" class="d">-                    None,
</a><a href="#h100-5-9" id="h100-5-9" class="d">-                    None,
</a><a href="#h100-5-10" id="h100-5-10" class="d">-                    None,
</a><a href="#h100-5-11" id="h100-5-11" class="d">-                ],
</a>                 expressions: [
                     Field(
                         0,
<a href="#h100-6" id="h100-6" class="h">@@ -330,6 +343,11 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ],
<a href="#h100-6-3" id="h100-6-3" class="i">+                labels: [
</a><a href="#h100-6-4" id="h100-6-4" class="i">+                    None,
</a><a href="#h100-6-5" id="h100-6-5" class="i">+                    None,
</a><a href="#h100-6-6" id="h100-6-6" class="i">+                    None,
</a><a href="#h100-6-7" id="h100-6-7" class="i">+                ],
</a>             },
             orders: [
                 (
<a href="#h100-7" id="h100-7" class="h">@@ -348,10 +366,6 @@ Optimized plan: Select(
</a>                 ),
             ],
         },
<a href="#h100-7-3" id="h100-7-3" class="d">-        labels: [
</a><a href="#h100-7-4" id="h100-7-4" class="d">-            None,
</a><a href="#h100-7-5" id="h100-7-5" class="d">-            None,
</a><a href="#h100-7-6" id="h100-7-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h100-8" id="h100-8" class="h">@@ -362,6 +376,28 @@ Optimized plan: Select(
</a>                 None,
             ),
         ],
<a href="#h100-8-3" id="h100-8-3" class="i">+        labels: [
</a><a href="#h100-8-4" id="h100-8-4" class="i">+            None,
</a><a href="#h100-8-5" id="h100-8-5" class="i">+            None,
</a><a href="#h100-8-6" id="h100-8-6" class="i">+        ],
</a>     },
<a href="#h100-8-8" id="h100-8-8" class="d">-)
</a><a href="#h100-8-9" id="h100-8-9" class="i">+    labels: [
</a><a href="#h100-8-10" id="h100-8-10" class="i">+        Some(
</a><a href="#h100-8-11" id="h100-8-11" class="i">+            (
</a><a href="#h100-8-12" id="h100-8-12" class="i">+                Some(
</a><a href="#h100-8-13" id="h100-8-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h100-8-14" id="h100-8-14" class="i">+                ),
</a><a href="#h100-8-15" id="h100-8-15" class="i">+                &quot;id&quot;,
</a><a href="#h100-8-16" id="h100-8-16" class="i">+            ),
</a><a href="#h100-8-17" id="h100-8-17" class="i">+        ),
</a><a href="#h100-8-18" id="h100-8-18" class="i">+        Some(
</a><a href="#h100-8-19" id="h100-8-19" class="i">+            (
</a><a href="#h100-8-20" id="h100-8-20" class="i">+                Some(
</a><a href="#h100-8-21" id="h100-8-21" class="i">+                    &quot;movies&quot;,
</a><a href="#h100-8-22" id="h100-8-22" class="i">+                ),
</a><a href="#h100-8-23" id="h100-8-23" class="i">+                &quot;title&quot;,
</a><a href="#h100-8-24" id="h100-8-24" class="i">+            ),
</a><a href="#h100-8-25" id="h100-8-25" class="i">+        ),
</a><a href="#h100-8-26" id="h100-8-26" class="i">+    ],
</a><a href="#h100-8-27" id="h100-8-27" class="i">+}
</a> 
<b>diff --git a/<a id="h101" href="../file/tests/sql/query/order_string_asc.html">tests/sql/query/order_string_asc</a> b/<a href="../file/tests/sql/query/order_string_asc.html">tests/sql/query/order_string_asc</a></b>
<a href="#h101-0" id="h101-0" class="h">@@ -38,8 +38,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h101-0-3" id="h101-0-3" class="d">-Plan: Select(
</a><a href="#h101-0-4" id="h101-0-4" class="d">-    Order {
</a><a href="#h101-0-5" id="h101-0-5" class="i">+Plan: Select {
</a><a href="#h101-0-6" id="h101-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;strings&quot;,
<a href="#h101-1" id="h101-1" class="h">@@ -67,8 +67,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h101-1-3" id="h101-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h101-1-5" id="h101-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h101-2" id="h101-2" class="h">@@ -85,10 +85,28 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h101-2-3" id="h101-2-3" class="d">-)
</a><a href="#h101-2-4" id="h101-2-4" class="i">+    labels: [
</a><a href="#h101-2-5" id="h101-2-5" class="i">+        Some(
</a><a href="#h101-2-6" id="h101-2-6" class="i">+            (
</a><a href="#h101-2-7" id="h101-2-7" class="i">+                Some(
</a><a href="#h101-2-8" id="h101-2-8" class="i">+                    &quot;strings&quot;,
</a><a href="#h101-2-9" id="h101-2-9" class="i">+                ),
</a><a href="#h101-2-10" id="h101-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h101-2-11" id="h101-2-11" class="i">+            ),
</a><a href="#h101-2-12" id="h101-2-12" class="i">+        ),
</a><a href="#h101-2-13" id="h101-2-13" class="i">+        Some(
</a><a href="#h101-2-14" id="h101-2-14" class="i">+            (
</a><a href="#h101-2-15" id="h101-2-15" class="i">+                Some(
</a><a href="#h101-2-16" id="h101-2-16" class="i">+                    &quot;strings&quot;,
</a><a href="#h101-2-17" id="h101-2-17" class="i">+                ),
</a><a href="#h101-2-18" id="h101-2-18" class="i">+                &quot;value&quot;,
</a><a href="#h101-2-19" id="h101-2-19" class="i">+            ),
</a><a href="#h101-2-20" id="h101-2-20" class="i">+        ),
</a><a href="#h101-2-21" id="h101-2-21" class="i">+    ],
</a><a href="#h101-2-22" id="h101-2-22" class="i">+}
</a> 
<a href="#h101-2-24" id="h101-2-24" class="d">-Optimized plan: Select(
</a><a href="#h101-2-25" id="h101-2-25" class="d">-    Order {
</a><a href="#h101-2-26" id="h101-2-26" class="i">+Optimized plan: Select {
</a><a href="#h101-2-27" id="h101-2-27" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;strings&quot;,
<a href="#h101-3" id="h101-3" class="h">@@ -116,8 +134,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h101-3-3" id="h101-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h101-3-5" id="h101-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h101-4" id="h101-4" class="h">@@ -134,5 +152,23 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h101-4-3" id="h101-4-3" class="d">-)
</a><a href="#h101-4-4" id="h101-4-4" class="i">+    labels: [
</a><a href="#h101-4-5" id="h101-4-5" class="i">+        Some(
</a><a href="#h101-4-6" id="h101-4-6" class="i">+            (
</a><a href="#h101-4-7" id="h101-4-7" class="i">+                Some(
</a><a href="#h101-4-8" id="h101-4-8" class="i">+                    &quot;strings&quot;,
</a><a href="#h101-4-9" id="h101-4-9" class="i">+                ),
</a><a href="#h101-4-10" id="h101-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h101-4-11" id="h101-4-11" class="i">+            ),
</a><a href="#h101-4-12" id="h101-4-12" class="i">+        ),
</a><a href="#h101-4-13" id="h101-4-13" class="i">+        Some(
</a><a href="#h101-4-14" id="h101-4-14" class="i">+            (
</a><a href="#h101-4-15" id="h101-4-15" class="i">+                Some(
</a><a href="#h101-4-16" id="h101-4-16" class="i">+                    &quot;strings&quot;,
</a><a href="#h101-4-17" id="h101-4-17" class="i">+                ),
</a><a href="#h101-4-18" id="h101-4-18" class="i">+                &quot;value&quot;,
</a><a href="#h101-4-19" id="h101-4-19" class="i">+            ),
</a><a href="#h101-4-20" id="h101-4-20" class="i">+        ),
</a><a href="#h101-4-21" id="h101-4-21" class="i">+    ],
</a><a href="#h101-4-22" id="h101-4-22" class="i">+}
</a> 
<b>diff --git a/<a id="h102" href="../file/tests/sql/query/order_string_desc.html">tests/sql/query/order_string_desc</a> b/<a href="../file/tests/sql/query/order_string_desc.html">tests/sql/query/order_string_desc</a></b>
<a href="#h102-0" id="h102-0" class="h">@@ -38,8 +38,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h102-0-3" id="h102-0-3" class="d">-Plan: Select(
</a><a href="#h102-0-4" id="h102-0-4" class="d">-    Order {
</a><a href="#h102-0-5" id="h102-0-5" class="i">+Plan: Select {
</a><a href="#h102-0-6" id="h102-0-6" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;strings&quot;,
<a href="#h102-1" id="h102-1" class="h">@@ -67,8 +67,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h102-1-3" id="h102-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h102-1-5" id="h102-1-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h102-2" id="h102-2" class="h">@@ -85,10 +85,28 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h102-2-3" id="h102-2-3" class="d">-)
</a><a href="#h102-2-4" id="h102-2-4" class="i">+    labels: [
</a><a href="#h102-2-5" id="h102-2-5" class="i">+        Some(
</a><a href="#h102-2-6" id="h102-2-6" class="i">+            (
</a><a href="#h102-2-7" id="h102-2-7" class="i">+                Some(
</a><a href="#h102-2-8" id="h102-2-8" class="i">+                    &quot;strings&quot;,
</a><a href="#h102-2-9" id="h102-2-9" class="i">+                ),
</a><a href="#h102-2-10" id="h102-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h102-2-11" id="h102-2-11" class="i">+            ),
</a><a href="#h102-2-12" id="h102-2-12" class="i">+        ),
</a><a href="#h102-2-13" id="h102-2-13" class="i">+        Some(
</a><a href="#h102-2-14" id="h102-2-14" class="i">+            (
</a><a href="#h102-2-15" id="h102-2-15" class="i">+                Some(
</a><a href="#h102-2-16" id="h102-2-16" class="i">+                    &quot;strings&quot;,
</a><a href="#h102-2-17" id="h102-2-17" class="i">+                ),
</a><a href="#h102-2-18" id="h102-2-18" class="i">+                &quot;value&quot;,
</a><a href="#h102-2-19" id="h102-2-19" class="i">+            ),
</a><a href="#h102-2-20" id="h102-2-20" class="i">+        ),
</a><a href="#h102-2-21" id="h102-2-21" class="i">+    ],
</a><a href="#h102-2-22" id="h102-2-22" class="i">+}
</a> 
<a href="#h102-2-24" id="h102-2-24" class="d">-Optimized plan: Select(
</a><a href="#h102-2-25" id="h102-2-25" class="d">-    Order {
</a><a href="#h102-2-26" id="h102-2-26" class="i">+Optimized plan: Select {
</a><a href="#h102-2-27" id="h102-2-27" class="i">+    root: Order {
</a>         source: Scan {
             table: Table {
                 name: &quot;strings&quot;,
<a href="#h102-3" id="h102-3" class="h">@@ -116,8 +134,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h102-3-3" id="h102-3-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h102-3-5" id="h102-3-5" class="i">+            alias: None,
</a>         },
         orders: [
             (
<a href="#h102-4" id="h102-4" class="h">@@ -134,5 +152,23 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h102-4-3" id="h102-4-3" class="d">-)
</a><a href="#h102-4-4" id="h102-4-4" class="i">+    labels: [
</a><a href="#h102-4-5" id="h102-4-5" class="i">+        Some(
</a><a href="#h102-4-6" id="h102-4-6" class="i">+            (
</a><a href="#h102-4-7" id="h102-4-7" class="i">+                Some(
</a><a href="#h102-4-8" id="h102-4-8" class="i">+                    &quot;strings&quot;,
</a><a href="#h102-4-9" id="h102-4-9" class="i">+                ),
</a><a href="#h102-4-10" id="h102-4-10" class="i">+                &quot;id&quot;,
</a><a href="#h102-4-11" id="h102-4-11" class="i">+            ),
</a><a href="#h102-4-12" id="h102-4-12" class="i">+        ),
</a><a href="#h102-4-13" id="h102-4-13" class="i">+        Some(
</a><a href="#h102-4-14" id="h102-4-14" class="i">+            (
</a><a href="#h102-4-15" id="h102-4-15" class="i">+                Some(
</a><a href="#h102-4-16" id="h102-4-16" class="i">+                    &quot;strings&quot;,
</a><a href="#h102-4-17" id="h102-4-17" class="i">+                ),
</a><a href="#h102-4-18" id="h102-4-18" class="i">+                &quot;value&quot;,
</a><a href="#h102-4-19" id="h102-4-19" class="i">+            ),
</a><a href="#h102-4-20" id="h102-4-20" class="i">+        ),
</a><a href="#h102-4-21" id="h102-4-21" class="i">+    ],
</a><a href="#h102-4-22" id="h102-4-22" class="i">+}
</a> 
<b>diff --git a/<a id="h103" href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a> b/<a href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a></b>
<a href="#h103-0" id="h103-0" class="h">@@ -48,8 +48,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h103-0-3" id="h103-0-3" class="d">-Plan: Select(
</a><a href="#h103-0-4" id="h103-0-4" class="d">-    Filter {
</a><a href="#h103-0-5" id="h103-0-5" class="i">+Plan: Select {
</a><a href="#h103-0-6" id="h103-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h103-1" id="h103-1" class="h">@@ -128,8 +128,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h103-1-3" id="h103-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h103-1-5" id="h103-1-5" class="i">+            alias: None,
</a>         },
         predicate: And(
             Or(
<a href="#h103-2" id="h103-2" class="h">@@ -177,10 +177,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h103-2-3" id="h103-2-3" class="d">-)
</a><a href="#h103-2-4" id="h103-2-4" class="i">+    labels: [
</a><a href="#h103-2-5" id="h103-2-5" class="i">+        Some(
</a><a href="#h103-2-6" id="h103-2-6" class="i">+            (
</a><a href="#h103-2-7" id="h103-2-7" class="i">+                Some(
</a><a href="#h103-2-8" id="h103-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-2-9" id="h103-2-9" class="i">+                ),
</a><a href="#h103-2-10" id="h103-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h103-2-11" id="h103-2-11" class="i">+            ),
</a><a href="#h103-2-12" id="h103-2-12" class="i">+        ),
</a><a href="#h103-2-13" id="h103-2-13" class="i">+        Some(
</a><a href="#h103-2-14" id="h103-2-14" class="i">+            (
</a><a href="#h103-2-15" id="h103-2-15" class="i">+                Some(
</a><a href="#h103-2-16" id="h103-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-2-17" id="h103-2-17" class="i">+                ),
</a><a href="#h103-2-18" id="h103-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h103-2-19" id="h103-2-19" class="i">+            ),
</a><a href="#h103-2-20" id="h103-2-20" class="i">+        ),
</a><a href="#h103-2-21" id="h103-2-21" class="i">+        Some(
</a><a href="#h103-2-22" id="h103-2-22" class="i">+            (
</a><a href="#h103-2-23" id="h103-2-23" class="i">+                Some(
</a><a href="#h103-2-24" id="h103-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-2-25" id="h103-2-25" class="i">+                ),
</a><a href="#h103-2-26" id="h103-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h103-2-27" id="h103-2-27" class="i">+            ),
</a><a href="#h103-2-28" id="h103-2-28" class="i">+        ),
</a><a href="#h103-2-29" id="h103-2-29" class="i">+        Some(
</a><a href="#h103-2-30" id="h103-2-30" class="i">+            (
</a><a href="#h103-2-31" id="h103-2-31" class="i">+                Some(
</a><a href="#h103-2-32" id="h103-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-2-33" id="h103-2-33" class="i">+                ),
</a><a href="#h103-2-34" id="h103-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h103-2-35" id="h103-2-35" class="i">+            ),
</a><a href="#h103-2-36" id="h103-2-36" class="i">+        ),
</a><a href="#h103-2-37" id="h103-2-37" class="i">+        Some(
</a><a href="#h103-2-38" id="h103-2-38" class="i">+            (
</a><a href="#h103-2-39" id="h103-2-39" class="i">+                Some(
</a><a href="#h103-2-40" id="h103-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-2-41" id="h103-2-41" class="i">+                ),
</a><a href="#h103-2-42" id="h103-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h103-2-43" id="h103-2-43" class="i">+            ),
</a><a href="#h103-2-44" id="h103-2-44" class="i">+        ),
</a><a href="#h103-2-45" id="h103-2-45" class="i">+        Some(
</a><a href="#h103-2-46" id="h103-2-46" class="i">+            (
</a><a href="#h103-2-47" id="h103-2-47" class="i">+                Some(
</a><a href="#h103-2-48" id="h103-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-2-49" id="h103-2-49" class="i">+                ),
</a><a href="#h103-2-50" id="h103-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h103-2-51" id="h103-2-51" class="i">+            ),
</a><a href="#h103-2-52" id="h103-2-52" class="i">+        ),
</a><a href="#h103-2-53" id="h103-2-53" class="i">+        Some(
</a><a href="#h103-2-54" id="h103-2-54" class="i">+            (
</a><a href="#h103-2-55" id="h103-2-55" class="i">+                Some(
</a><a href="#h103-2-56" id="h103-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-2-57" id="h103-2-57" class="i">+                ),
</a><a href="#h103-2-58" id="h103-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h103-2-59" id="h103-2-59" class="i">+            ),
</a><a href="#h103-2-60" id="h103-2-60" class="i">+        ),
</a><a href="#h103-2-61" id="h103-2-61" class="i">+    ],
</a><a href="#h103-2-62" id="h103-2-62" class="i">+}
</a> 
<a href="#h103-2-64" id="h103-2-64" class="d">-Optimized plan: Select(
</a><a href="#h103-2-65" id="h103-2-65" class="d">-    Scan {
</a><a href="#h103-2-66" id="h103-2-66" class="i">+Optimized plan: Select {
</a><a href="#h103-2-67" id="h103-2-67" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h103-3" id="h103-3" class="h">@@ -258,7 +316,6 @@ Optimized plan: Select(
</a>                 },
             ],
         },
<a href="#h103-3-3" id="h103-3-3" class="d">-        alias: None,
</a>         filter: Some(
             And(
                 Or(
<a href="#h103-4" id="h103-4" class="h">@@ -306,6 +363,65 @@ Optimized plan: Select(
</a>                 ),
             ),
         ),
<a href="#h103-4-3" id="h103-4-3" class="i">+        alias: None,
</a>     },
<a href="#h103-4-5" id="h103-4-5" class="d">-)
</a><a href="#h103-4-6" id="h103-4-6" class="i">+    labels: [
</a><a href="#h103-4-7" id="h103-4-7" class="i">+        Some(
</a><a href="#h103-4-8" id="h103-4-8" class="i">+            (
</a><a href="#h103-4-9" id="h103-4-9" class="i">+                Some(
</a><a href="#h103-4-10" id="h103-4-10" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-4-11" id="h103-4-11" class="i">+                ),
</a><a href="#h103-4-12" id="h103-4-12" class="i">+                &quot;id&quot;,
</a><a href="#h103-4-13" id="h103-4-13" class="i">+            ),
</a><a href="#h103-4-14" id="h103-4-14" class="i">+        ),
</a><a href="#h103-4-15" id="h103-4-15" class="i">+        Some(
</a><a href="#h103-4-16" id="h103-4-16" class="i">+            (
</a><a href="#h103-4-17" id="h103-4-17" class="i">+                Some(
</a><a href="#h103-4-18" id="h103-4-18" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-4-19" id="h103-4-19" class="i">+                ),
</a><a href="#h103-4-20" id="h103-4-20" class="i">+                &quot;title&quot;,
</a><a href="#h103-4-21" id="h103-4-21" class="i">+            ),
</a><a href="#h103-4-22" id="h103-4-22" class="i">+        ),
</a><a href="#h103-4-23" id="h103-4-23" class="i">+        Some(
</a><a href="#h103-4-24" id="h103-4-24" class="i">+            (
</a><a href="#h103-4-25" id="h103-4-25" class="i">+                Some(
</a><a href="#h103-4-26" id="h103-4-26" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-4-27" id="h103-4-27" class="i">+                ),
</a><a href="#h103-4-28" id="h103-4-28" class="i">+                &quot;studio_id&quot;,
</a><a href="#h103-4-29" id="h103-4-29" class="i">+            ),
</a><a href="#h103-4-30" id="h103-4-30" class="i">+        ),
</a><a href="#h103-4-31" id="h103-4-31" class="i">+        Some(
</a><a href="#h103-4-32" id="h103-4-32" class="i">+            (
</a><a href="#h103-4-33" id="h103-4-33" class="i">+                Some(
</a><a href="#h103-4-34" id="h103-4-34" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-4-35" id="h103-4-35" class="i">+                ),
</a><a href="#h103-4-36" id="h103-4-36" class="i">+                &quot;genre_id&quot;,
</a><a href="#h103-4-37" id="h103-4-37" class="i">+            ),
</a><a href="#h103-4-38" id="h103-4-38" class="i">+        ),
</a><a href="#h103-4-39" id="h103-4-39" class="i">+        Some(
</a><a href="#h103-4-40" id="h103-4-40" class="i">+            (
</a><a href="#h103-4-41" id="h103-4-41" class="i">+                Some(
</a><a href="#h103-4-42" id="h103-4-42" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-4-43" id="h103-4-43" class="i">+                ),
</a><a href="#h103-4-44" id="h103-4-44" class="i">+                &quot;released&quot;,
</a><a href="#h103-4-45" id="h103-4-45" class="i">+            ),
</a><a href="#h103-4-46" id="h103-4-46" class="i">+        ),
</a><a href="#h103-4-47" id="h103-4-47" class="i">+        Some(
</a><a href="#h103-4-48" id="h103-4-48" class="i">+            (
</a><a href="#h103-4-49" id="h103-4-49" class="i">+                Some(
</a><a href="#h103-4-50" id="h103-4-50" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-4-51" id="h103-4-51" class="i">+                ),
</a><a href="#h103-4-52" id="h103-4-52" class="i">+                &quot;rating&quot;,
</a><a href="#h103-4-53" id="h103-4-53" class="i">+            ),
</a><a href="#h103-4-54" id="h103-4-54" class="i">+        ),
</a><a href="#h103-4-55" id="h103-4-55" class="i">+        Some(
</a><a href="#h103-4-56" id="h103-4-56" class="i">+            (
</a><a href="#h103-4-57" id="h103-4-57" class="i">+                Some(
</a><a href="#h103-4-58" id="h103-4-58" class="i">+                    &quot;movies&quot;,
</a><a href="#h103-4-59" id="h103-4-59" class="i">+                ),
</a><a href="#h103-4-60" id="h103-4-60" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h103-4-61" id="h103-4-61" class="i">+            ),
</a><a href="#h103-4-62" id="h103-4-62" class="i">+        ),
</a><a href="#h103-4-63" id="h103-4-63" class="i">+    ],
</a><a href="#h103-4-64" id="h103-4-64" class="i">+}
</a> 
<b>diff --git a/<a id="h104" href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a> b/<a href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a></b>
<a href="#h104-0" id="h104-0" class="h">@@ -27,8 +27,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h104-0-3" id="h104-0-3" class="d">-Plan: Select(
</a><a href="#h104-0-4" id="h104-0-4" class="d">-    Filter {
</a><a href="#h104-0-5" id="h104-0-5" class="i">+Plan: Select {
</a><a href="#h104-0-6" id="h104-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h104-1" id="h104-1" class="h">@@ -107,8 +107,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h104-1-3" id="h104-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h104-1-5" id="h104-1-5" class="i">+            alias: None,
</a>         },
         predicate: Constant(
             Boolean(
<a href="#h104-2" id="h104-2" class="h">@@ -116,10 +116,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h104-2-3" id="h104-2-3" class="d">-)
</a><a href="#h104-2-4" id="h104-2-4" class="i">+    labels: [
</a><a href="#h104-2-5" id="h104-2-5" class="i">+        Some(
</a><a href="#h104-2-6" id="h104-2-6" class="i">+            (
</a><a href="#h104-2-7" id="h104-2-7" class="i">+                Some(
</a><a href="#h104-2-8" id="h104-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-2-9" id="h104-2-9" class="i">+                ),
</a><a href="#h104-2-10" id="h104-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h104-2-11" id="h104-2-11" class="i">+            ),
</a><a href="#h104-2-12" id="h104-2-12" class="i">+        ),
</a><a href="#h104-2-13" id="h104-2-13" class="i">+        Some(
</a><a href="#h104-2-14" id="h104-2-14" class="i">+            (
</a><a href="#h104-2-15" id="h104-2-15" class="i">+                Some(
</a><a href="#h104-2-16" id="h104-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-2-17" id="h104-2-17" class="i">+                ),
</a><a href="#h104-2-18" id="h104-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h104-2-19" id="h104-2-19" class="i">+            ),
</a><a href="#h104-2-20" id="h104-2-20" class="i">+        ),
</a><a href="#h104-2-21" id="h104-2-21" class="i">+        Some(
</a><a href="#h104-2-22" id="h104-2-22" class="i">+            (
</a><a href="#h104-2-23" id="h104-2-23" class="i">+                Some(
</a><a href="#h104-2-24" id="h104-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-2-25" id="h104-2-25" class="i">+                ),
</a><a href="#h104-2-26" id="h104-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h104-2-27" id="h104-2-27" class="i">+            ),
</a><a href="#h104-2-28" id="h104-2-28" class="i">+        ),
</a><a href="#h104-2-29" id="h104-2-29" class="i">+        Some(
</a><a href="#h104-2-30" id="h104-2-30" class="i">+            (
</a><a href="#h104-2-31" id="h104-2-31" class="i">+                Some(
</a><a href="#h104-2-32" id="h104-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-2-33" id="h104-2-33" class="i">+                ),
</a><a href="#h104-2-34" id="h104-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h104-2-35" id="h104-2-35" class="i">+            ),
</a><a href="#h104-2-36" id="h104-2-36" class="i">+        ),
</a><a href="#h104-2-37" id="h104-2-37" class="i">+        Some(
</a><a href="#h104-2-38" id="h104-2-38" class="i">+            (
</a><a href="#h104-2-39" id="h104-2-39" class="i">+                Some(
</a><a href="#h104-2-40" id="h104-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-2-41" id="h104-2-41" class="i">+                ),
</a><a href="#h104-2-42" id="h104-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h104-2-43" id="h104-2-43" class="i">+            ),
</a><a href="#h104-2-44" id="h104-2-44" class="i">+        ),
</a><a href="#h104-2-45" id="h104-2-45" class="i">+        Some(
</a><a href="#h104-2-46" id="h104-2-46" class="i">+            (
</a><a href="#h104-2-47" id="h104-2-47" class="i">+                Some(
</a><a href="#h104-2-48" id="h104-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-2-49" id="h104-2-49" class="i">+                ),
</a><a href="#h104-2-50" id="h104-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h104-2-51" id="h104-2-51" class="i">+            ),
</a><a href="#h104-2-52" id="h104-2-52" class="i">+        ),
</a><a href="#h104-2-53" id="h104-2-53" class="i">+        Some(
</a><a href="#h104-2-54" id="h104-2-54" class="i">+            (
</a><a href="#h104-2-55" id="h104-2-55" class="i">+                Some(
</a><a href="#h104-2-56" id="h104-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-2-57" id="h104-2-57" class="i">+                ),
</a><a href="#h104-2-58" id="h104-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h104-2-59" id="h104-2-59" class="i">+            ),
</a><a href="#h104-2-60" id="h104-2-60" class="i">+        ),
</a><a href="#h104-2-61" id="h104-2-61" class="i">+    ],
</a><a href="#h104-2-62" id="h104-2-62" class="i">+}
</a> 
<a href="#h104-2-64" id="h104-2-64" class="d">-Optimized plan: Select(
</a><a href="#h104-2-65" id="h104-2-65" class="d">-    Scan {
</a><a href="#h104-2-66" id="h104-2-66" class="i">+Optimized plan: Select {
</a><a href="#h104-2-67" id="h104-2-67" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h104-3" id="h104-3" class="h">@@ -197,7 +255,6 @@ Optimized plan: Select(
</a>                 },
             ],
         },
<a href="#h104-3-3" id="h104-3-3" class="d">-        alias: None,
</a>         filter: Some(
             Constant(
                 Boolean(
<a href="#h104-4" id="h104-4" class="h">@@ -205,6 +262,65 @@ Optimized plan: Select(
</a>                 ),
             ),
         ),
<a href="#h104-4-3" id="h104-4-3" class="i">+        alias: None,
</a>     },
<a href="#h104-4-5" id="h104-4-5" class="d">-)
</a><a href="#h104-4-6" id="h104-4-6" class="i">+    labels: [
</a><a href="#h104-4-7" id="h104-4-7" class="i">+        Some(
</a><a href="#h104-4-8" id="h104-4-8" class="i">+            (
</a><a href="#h104-4-9" id="h104-4-9" class="i">+                Some(
</a><a href="#h104-4-10" id="h104-4-10" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-4-11" id="h104-4-11" class="i">+                ),
</a><a href="#h104-4-12" id="h104-4-12" class="i">+                &quot;id&quot;,
</a><a href="#h104-4-13" id="h104-4-13" class="i">+            ),
</a><a href="#h104-4-14" id="h104-4-14" class="i">+        ),
</a><a href="#h104-4-15" id="h104-4-15" class="i">+        Some(
</a><a href="#h104-4-16" id="h104-4-16" class="i">+            (
</a><a href="#h104-4-17" id="h104-4-17" class="i">+                Some(
</a><a href="#h104-4-18" id="h104-4-18" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-4-19" id="h104-4-19" class="i">+                ),
</a><a href="#h104-4-20" id="h104-4-20" class="i">+                &quot;title&quot;,
</a><a href="#h104-4-21" id="h104-4-21" class="i">+            ),
</a><a href="#h104-4-22" id="h104-4-22" class="i">+        ),
</a><a href="#h104-4-23" id="h104-4-23" class="i">+        Some(
</a><a href="#h104-4-24" id="h104-4-24" class="i">+            (
</a><a href="#h104-4-25" id="h104-4-25" class="i">+                Some(
</a><a href="#h104-4-26" id="h104-4-26" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-4-27" id="h104-4-27" class="i">+                ),
</a><a href="#h104-4-28" id="h104-4-28" class="i">+                &quot;studio_id&quot;,
</a><a href="#h104-4-29" id="h104-4-29" class="i">+            ),
</a><a href="#h104-4-30" id="h104-4-30" class="i">+        ),
</a><a href="#h104-4-31" id="h104-4-31" class="i">+        Some(
</a><a href="#h104-4-32" id="h104-4-32" class="i">+            (
</a><a href="#h104-4-33" id="h104-4-33" class="i">+                Some(
</a><a href="#h104-4-34" id="h104-4-34" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-4-35" id="h104-4-35" class="i">+                ),
</a><a href="#h104-4-36" id="h104-4-36" class="i">+                &quot;genre_id&quot;,
</a><a href="#h104-4-37" id="h104-4-37" class="i">+            ),
</a><a href="#h104-4-38" id="h104-4-38" class="i">+        ),
</a><a href="#h104-4-39" id="h104-4-39" class="i">+        Some(
</a><a href="#h104-4-40" id="h104-4-40" class="i">+            (
</a><a href="#h104-4-41" id="h104-4-41" class="i">+                Some(
</a><a href="#h104-4-42" id="h104-4-42" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-4-43" id="h104-4-43" class="i">+                ),
</a><a href="#h104-4-44" id="h104-4-44" class="i">+                &quot;released&quot;,
</a><a href="#h104-4-45" id="h104-4-45" class="i">+            ),
</a><a href="#h104-4-46" id="h104-4-46" class="i">+        ),
</a><a href="#h104-4-47" id="h104-4-47" class="i">+        Some(
</a><a href="#h104-4-48" id="h104-4-48" class="i">+            (
</a><a href="#h104-4-49" id="h104-4-49" class="i">+                Some(
</a><a href="#h104-4-50" id="h104-4-50" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-4-51" id="h104-4-51" class="i">+                ),
</a><a href="#h104-4-52" id="h104-4-52" class="i">+                &quot;rating&quot;,
</a><a href="#h104-4-53" id="h104-4-53" class="i">+            ),
</a><a href="#h104-4-54" id="h104-4-54" class="i">+        ),
</a><a href="#h104-4-55" id="h104-4-55" class="i">+        Some(
</a><a href="#h104-4-56" id="h104-4-56" class="i">+            (
</a><a href="#h104-4-57" id="h104-4-57" class="i">+                Some(
</a><a href="#h104-4-58" id="h104-4-58" class="i">+                    &quot;movies&quot;,
</a><a href="#h104-4-59" id="h104-4-59" class="i">+                ),
</a><a href="#h104-4-60" id="h104-4-60" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h104-4-61" id="h104-4-61" class="i">+            ),
</a><a href="#h104-4-62" id="h104-4-62" class="i">+        ),
</a><a href="#h104-4-63" id="h104-4-63" class="i">+    ],
</a><a href="#h104-4-64" id="h104-4-64" class="i">+}
</a> 
<b>diff --git a/<a id="h105" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h105-0" id="h105-0" class="h">@@ -94,8 +94,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h105-0-3" id="h105-0-3" class="d">-Plan: Select(
</a><a href="#h105-0-4" id="h105-0-4" class="d">-    Projection {
</a><a href="#h105-0-5" id="h105-0-5" class="i">+Plan: Select {
</a><a href="#h105-0-6" id="h105-0-6" class="i">+    root: Projection {
</a>         source: Filter {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h105-1" id="h105-1" class="h">@@ -176,10 +176,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h105-1-3" id="h105-1-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h105-1-7" id="h105-1-7" class="d">-                    filter: None,
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h105-2" id="h105-2" class="h">@@ -207,10 +207,10 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h105-2-3" id="h105-2-3" class="i">+                    filter: None,
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h105-2-7" id="h105-2-7" class="d">-                    filter: None,
</a>                 },
                 predicate: None,
                 outer: false,
<a href="#h105-3" id="h105-3" class="h">@@ -274,10 +274,6 @@ Plan: Select(
</a>                 ),
             ),
         },
<a href="#h105-3-3" id="h105-3-3" class="d">-        labels: [
</a><a href="#h105-3-4" id="h105-3-4" class="d">-            None,
</a><a href="#h105-3-5" id="h105-3-5" class="d">-            None,
</a><a href="#h105-3-6" id="h105-3-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h105-4" id="h105-4" class="h">@@ -302,11 +298,33 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h105-4-3" id="h105-4-3" class="i">+        labels: [
</a><a href="#h105-4-4" id="h105-4-4" class="i">+            None,
</a><a href="#h105-4-5" id="h105-4-5" class="i">+            None,
</a><a href="#h105-4-6" id="h105-4-6" class="i">+        ],
</a>     },
<a href="#h105-4-8" id="h105-4-8" class="d">-)
</a><a href="#h105-4-9" id="h105-4-9" class="i">+    labels: [
</a><a href="#h105-4-10" id="h105-4-10" class="i">+        Some(
</a><a href="#h105-4-11" id="h105-4-11" class="i">+            (
</a><a href="#h105-4-12" id="h105-4-12" class="i">+                Some(
</a><a href="#h105-4-13" id="h105-4-13" class="i">+                    &quot;m&quot;,
</a><a href="#h105-4-14" id="h105-4-14" class="i">+                ),
</a><a href="#h105-4-15" id="h105-4-15" class="i">+                &quot;id&quot;,
</a><a href="#h105-4-16" id="h105-4-16" class="i">+            ),
</a><a href="#h105-4-17" id="h105-4-17" class="i">+        ),
</a><a href="#h105-4-18" id="h105-4-18" class="i">+        Some(
</a><a href="#h105-4-19" id="h105-4-19" class="i">+            (
</a><a href="#h105-4-20" id="h105-4-20" class="i">+                Some(
</a><a href="#h105-4-21" id="h105-4-21" class="i">+                    &quot;g&quot;,
</a><a href="#h105-4-22" id="h105-4-22" class="i">+                ),
</a><a href="#h105-4-23" id="h105-4-23" class="i">+                &quot;id&quot;,
</a><a href="#h105-4-24" id="h105-4-24" class="i">+            ),
</a><a href="#h105-4-25" id="h105-4-25" class="i">+        ),
</a><a href="#h105-4-26" id="h105-4-26" class="i">+    ],
</a><a href="#h105-4-27" id="h105-4-27" class="i">+}
</a> 
<a href="#h105-4-29" id="h105-4-29" class="d">-Optimized plan: Select(
</a><a href="#h105-4-30" id="h105-4-30" class="d">-    Projection {
</a><a href="#h105-4-31" id="h105-4-31" class="i">+Optimized plan: Select {
</a><a href="#h105-4-32" id="h105-4-32" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h105-5" id="h105-5" class="h">@@ -386,9 +404,6 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h105-5-3" id="h105-5-3" class="d">-                alias: Some(
</a><a href="#h105-5-4" id="h105-5-4" class="d">-                    &quot;m&quot;,
</a><a href="#h105-5-5" id="h105-5-5" class="d">-                ),
</a>                 filter: Some(
                     Or(
                         GreaterThan(
<a href="#h105-6" id="h105-6" class="h">@@ -429,6 +444,9 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ),
<a href="#h105-6-3" id="h105-6-3" class="i">+                alias: Some(
</a><a href="#h105-6-4" id="h105-6-4" class="i">+                    &quot;m&quot;,
</a><a href="#h105-6-5" id="h105-6-5" class="i">+                ),
</a>             },
             left_size: 7,
             right: KeyLookup {
<a href="#h105-7" id="h105-7" class="h">@@ -468,10 +486,6 @@ Optimized plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h105-7-3" id="h105-7-3" class="d">-        labels: [
</a><a href="#h105-7-4" id="h105-7-4" class="d">-            None,
</a><a href="#h105-7-5" id="h105-7-5" class="d">-            None,
</a><a href="#h105-7-6" id="h105-7-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h105-8" id="h105-8" class="h">@@ -496,6 +510,28 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h105-8-3" id="h105-8-3" class="i">+        labels: [
</a><a href="#h105-8-4" id="h105-8-4" class="i">+            None,
</a><a href="#h105-8-5" id="h105-8-5" class="i">+            None,
</a><a href="#h105-8-6" id="h105-8-6" class="i">+        ],
</a>     },
<a href="#h105-8-8" id="h105-8-8" class="d">-)
</a><a href="#h105-8-9" id="h105-8-9" class="i">+    labels: [
</a><a href="#h105-8-10" id="h105-8-10" class="i">+        Some(
</a><a href="#h105-8-11" id="h105-8-11" class="i">+            (
</a><a href="#h105-8-12" id="h105-8-12" class="i">+                Some(
</a><a href="#h105-8-13" id="h105-8-13" class="i">+                    &quot;m&quot;,
</a><a href="#h105-8-14" id="h105-8-14" class="i">+                ),
</a><a href="#h105-8-15" id="h105-8-15" class="i">+                &quot;id&quot;,
</a><a href="#h105-8-16" id="h105-8-16" class="i">+            ),
</a><a href="#h105-8-17" id="h105-8-17" class="i">+        ),
</a><a href="#h105-8-18" id="h105-8-18" class="i">+        Some(
</a><a href="#h105-8-19" id="h105-8-19" class="i">+            (
</a><a href="#h105-8-20" id="h105-8-20" class="i">+                Some(
</a><a href="#h105-8-21" id="h105-8-21" class="i">+                    &quot;g&quot;,
</a><a href="#h105-8-22" id="h105-8-22" class="i">+                ),
</a><a href="#h105-8-23" id="h105-8-23" class="i">+                &quot;id&quot;,
</a><a href="#h105-8-24" id="h105-8-24" class="i">+            ),
</a><a href="#h105-8-25" id="h105-8-25" class="i">+        ),
</a><a href="#h105-8-26" id="h105-8-26" class="i">+    ],
</a><a href="#h105-8-27" id="h105-8-27" class="i">+}
</a> 
<b>diff --git a/<a id="h106" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h106-0" id="h106-0" class="h">@@ -90,8 +90,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h106-0-3" id="h106-0-3" class="d">-Plan: Select(
</a><a href="#h106-0-4" id="h106-0-4" class="d">-    Projection {
</a><a href="#h106-0-5" id="h106-0-5" class="i">+Plan: Select {
</a><a href="#h106-0-6" id="h106-0-6" class="i">+    root: Projection {
</a>         source: Filter {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h106-1" id="h106-1" class="h">@@ -172,8 +172,8 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h106-1-3" id="h106-1-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h106-1-5" id="h106-1-5" class="i">+                    alias: None,
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h106-2" id="h106-2" class="h">@@ -201,8 +201,8 @@ Plan: Select(
</a>                             },
                         ],
                     },
<a href="#h106-2-3" id="h106-2-3" class="d">-                    alias: None,
</a>                     filter: None,
<a href="#h106-2-5" id="h106-2-5" class="i">+                    alias: None,
</a>                 },
                 predicate: None,
                 outer: false,
<a href="#h106-3" id="h106-3" class="h">@@ -266,10 +266,6 @@ Plan: Select(
</a>                 ),
             ),
         },
<a href="#h106-3-3" id="h106-3-3" class="d">-        labels: [
</a><a href="#h106-3-4" id="h106-3-4" class="d">-            None,
</a><a href="#h106-3-5" id="h106-3-5" class="d">-            None,
</a><a href="#h106-3-6" id="h106-3-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h106-4" id="h106-4" class="h">@@ -294,11 +290,33 @@ Plan: Select(
</a>                 ),
             ),
         ],
<a href="#h106-4-3" id="h106-4-3" class="i">+        labels: [
</a><a href="#h106-4-4" id="h106-4-4" class="i">+            None,
</a><a href="#h106-4-5" id="h106-4-5" class="i">+            None,
</a><a href="#h106-4-6" id="h106-4-6" class="i">+        ],
</a>     },
<a href="#h106-4-8" id="h106-4-8" class="d">-)
</a><a href="#h106-4-9" id="h106-4-9" class="i">+    labels: [
</a><a href="#h106-4-10" id="h106-4-10" class="i">+        Some(
</a><a href="#h106-4-11" id="h106-4-11" class="i">+            (
</a><a href="#h106-4-12" id="h106-4-12" class="i">+                Some(
</a><a href="#h106-4-13" id="h106-4-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h106-4-14" id="h106-4-14" class="i">+                ),
</a><a href="#h106-4-15" id="h106-4-15" class="i">+                &quot;id&quot;,
</a><a href="#h106-4-16" id="h106-4-16" class="i">+            ),
</a><a href="#h106-4-17" id="h106-4-17" class="i">+        ),
</a><a href="#h106-4-18" id="h106-4-18" class="i">+        Some(
</a><a href="#h106-4-19" id="h106-4-19" class="i">+            (
</a><a href="#h106-4-20" id="h106-4-20" class="i">+                Some(
</a><a href="#h106-4-21" id="h106-4-21" class="i">+                    &quot;genres&quot;,
</a><a href="#h106-4-22" id="h106-4-22" class="i">+                ),
</a><a href="#h106-4-23" id="h106-4-23" class="i">+                &quot;id&quot;,
</a><a href="#h106-4-24" id="h106-4-24" class="i">+            ),
</a><a href="#h106-4-25" id="h106-4-25" class="i">+        ),
</a><a href="#h106-4-26" id="h106-4-26" class="i">+    ],
</a><a href="#h106-4-27" id="h106-4-27" class="i">+}
</a> 
<a href="#h106-4-29" id="h106-4-29" class="d">-Optimized plan: Select(
</a><a href="#h106-4-30" id="h106-4-30" class="d">-    Projection {
</a><a href="#h106-4-31" id="h106-4-31" class="i">+Optimized plan: Select {
</a><a href="#h106-4-32" id="h106-4-32" class="i">+    root: Projection {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h106-5" id="h106-5" class="h">@@ -378,7 +396,6 @@ Optimized plan: Select(
</a>                         },
                     ],
                 },
<a href="#h106-5-3" id="h106-5-3" class="d">-                alias: None,
</a>                 filter: Some(
                     Or(
                         GreaterThan(
<a href="#h106-6" id="h106-6" class="h">@@ -419,6 +436,7 @@ Optimized plan: Select(
</a>                         ),
                     ),
                 ),
<a href="#h106-6-3" id="h106-6-3" class="i">+                alias: None,
</a>             },
             left_size: 7,
             right: KeyLookup {
<a href="#h106-7" id="h106-7" class="h">@@ -456,10 +474,6 @@ Optimized plan: Select(
</a>             predicate: None,
             outer: false,
         },
<a href="#h106-7-3" id="h106-7-3" class="d">-        labels: [
</a><a href="#h106-7-4" id="h106-7-4" class="d">-            None,
</a><a href="#h106-7-5" id="h106-7-5" class="d">-            None,
</a><a href="#h106-7-6" id="h106-7-6" class="d">-        ],
</a>         expressions: [
             Field(
                 0,
<a href="#h106-8" id="h106-8" class="h">@@ -484,6 +498,28 @@ Optimized plan: Select(
</a>                 ),
             ),
         ],
<a href="#h106-8-3" id="h106-8-3" class="i">+        labels: [
</a><a href="#h106-8-4" id="h106-8-4" class="i">+            None,
</a><a href="#h106-8-5" id="h106-8-5" class="i">+            None,
</a><a href="#h106-8-6" id="h106-8-6" class="i">+        ],
</a>     },
<a href="#h106-8-8" id="h106-8-8" class="d">-)
</a><a href="#h106-8-9" id="h106-8-9" class="i">+    labels: [
</a><a href="#h106-8-10" id="h106-8-10" class="i">+        Some(
</a><a href="#h106-8-11" id="h106-8-11" class="i">+            (
</a><a href="#h106-8-12" id="h106-8-12" class="i">+                Some(
</a><a href="#h106-8-13" id="h106-8-13" class="i">+                    &quot;movies&quot;,
</a><a href="#h106-8-14" id="h106-8-14" class="i">+                ),
</a><a href="#h106-8-15" id="h106-8-15" class="i">+                &quot;id&quot;,
</a><a href="#h106-8-16" id="h106-8-16" class="i">+            ),
</a><a href="#h106-8-17" id="h106-8-17" class="i">+        ),
</a><a href="#h106-8-18" id="h106-8-18" class="i">+        Some(
</a><a href="#h106-8-19" id="h106-8-19" class="i">+            (
</a><a href="#h106-8-20" id="h106-8-20" class="i">+                Some(
</a><a href="#h106-8-21" id="h106-8-21" class="i">+                    &quot;genres&quot;,
</a><a href="#h106-8-22" id="h106-8-22" class="i">+                ),
</a><a href="#h106-8-23" id="h106-8-23" class="i">+                &quot;id&quot;,
</a><a href="#h106-8-24" id="h106-8-24" class="i">+            ),
</a><a href="#h106-8-25" id="h106-8-25" class="i">+        ),
</a><a href="#h106-8-26" id="h106-8-26" class="i">+    ],
</a><a href="#h106-8-27" id="h106-8-27" class="i">+}
</a> 
<b>diff --git a/<a id="h107" href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a> b/<a href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a></b>
<a href="#h107-0" id="h107-0" class="h">@@ -27,8 +27,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h107-0-3" id="h107-0-3" class="d">-Plan: Select(
</a><a href="#h107-0-4" id="h107-0-4" class="d">-    Filter {
</a><a href="#h107-0-5" id="h107-0-5" class="i">+Plan: Select {
</a><a href="#h107-0-6" id="h107-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h107-1" id="h107-1" class="h">@@ -107,8 +107,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h107-1-3" id="h107-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h107-1-5" id="h107-1-5" class="i">+            alias: None,
</a>         },
         predicate: Constant(
             Float(
<a href="#h107-2" id="h107-2" class="h">@@ -116,10 +116,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h107-2-3" id="h107-2-3" class="d">-)
</a><a href="#h107-2-4" id="h107-2-4" class="i">+    labels: [
</a><a href="#h107-2-5" id="h107-2-5" class="i">+        Some(
</a><a href="#h107-2-6" id="h107-2-6" class="i">+            (
</a><a href="#h107-2-7" id="h107-2-7" class="i">+                Some(
</a><a href="#h107-2-8" id="h107-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-2-9" id="h107-2-9" class="i">+                ),
</a><a href="#h107-2-10" id="h107-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h107-2-11" id="h107-2-11" class="i">+            ),
</a><a href="#h107-2-12" id="h107-2-12" class="i">+        ),
</a><a href="#h107-2-13" id="h107-2-13" class="i">+        Some(
</a><a href="#h107-2-14" id="h107-2-14" class="i">+            (
</a><a href="#h107-2-15" id="h107-2-15" class="i">+                Some(
</a><a href="#h107-2-16" id="h107-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-2-17" id="h107-2-17" class="i">+                ),
</a><a href="#h107-2-18" id="h107-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h107-2-19" id="h107-2-19" class="i">+            ),
</a><a href="#h107-2-20" id="h107-2-20" class="i">+        ),
</a><a href="#h107-2-21" id="h107-2-21" class="i">+        Some(
</a><a href="#h107-2-22" id="h107-2-22" class="i">+            (
</a><a href="#h107-2-23" id="h107-2-23" class="i">+                Some(
</a><a href="#h107-2-24" id="h107-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-2-25" id="h107-2-25" class="i">+                ),
</a><a href="#h107-2-26" id="h107-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h107-2-27" id="h107-2-27" class="i">+            ),
</a><a href="#h107-2-28" id="h107-2-28" class="i">+        ),
</a><a href="#h107-2-29" id="h107-2-29" class="i">+        Some(
</a><a href="#h107-2-30" id="h107-2-30" class="i">+            (
</a><a href="#h107-2-31" id="h107-2-31" class="i">+                Some(
</a><a href="#h107-2-32" id="h107-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-2-33" id="h107-2-33" class="i">+                ),
</a><a href="#h107-2-34" id="h107-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h107-2-35" id="h107-2-35" class="i">+            ),
</a><a href="#h107-2-36" id="h107-2-36" class="i">+        ),
</a><a href="#h107-2-37" id="h107-2-37" class="i">+        Some(
</a><a href="#h107-2-38" id="h107-2-38" class="i">+            (
</a><a href="#h107-2-39" id="h107-2-39" class="i">+                Some(
</a><a href="#h107-2-40" id="h107-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-2-41" id="h107-2-41" class="i">+                ),
</a><a href="#h107-2-42" id="h107-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h107-2-43" id="h107-2-43" class="i">+            ),
</a><a href="#h107-2-44" id="h107-2-44" class="i">+        ),
</a><a href="#h107-2-45" id="h107-2-45" class="i">+        Some(
</a><a href="#h107-2-46" id="h107-2-46" class="i">+            (
</a><a href="#h107-2-47" id="h107-2-47" class="i">+                Some(
</a><a href="#h107-2-48" id="h107-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-2-49" id="h107-2-49" class="i">+                ),
</a><a href="#h107-2-50" id="h107-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h107-2-51" id="h107-2-51" class="i">+            ),
</a><a href="#h107-2-52" id="h107-2-52" class="i">+        ),
</a><a href="#h107-2-53" id="h107-2-53" class="i">+        Some(
</a><a href="#h107-2-54" id="h107-2-54" class="i">+            (
</a><a href="#h107-2-55" id="h107-2-55" class="i">+                Some(
</a><a href="#h107-2-56" id="h107-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-2-57" id="h107-2-57" class="i">+                ),
</a><a href="#h107-2-58" id="h107-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h107-2-59" id="h107-2-59" class="i">+            ),
</a><a href="#h107-2-60" id="h107-2-60" class="i">+        ),
</a><a href="#h107-2-61" id="h107-2-61" class="i">+    ],
</a><a href="#h107-2-62" id="h107-2-62" class="i">+}
</a> 
<a href="#h107-2-64" id="h107-2-64" class="d">-Optimized plan: Select(
</a><a href="#h107-2-65" id="h107-2-65" class="d">-    Scan {
</a><a href="#h107-2-66" id="h107-2-66" class="i">+Optimized plan: Select {
</a><a href="#h107-2-67" id="h107-2-67" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h107-3" id="h107-3" class="h">@@ -197,7 +255,6 @@ Optimized plan: Select(
</a>                 },
             ],
         },
<a href="#h107-3-3" id="h107-3-3" class="d">-        alias: None,
</a>         filter: Some(
             Constant(
                 Float(
<a href="#h107-4" id="h107-4" class="h">@@ -205,6 +262,65 @@ Optimized plan: Select(
</a>                 ),
             ),
         ),
<a href="#h107-4-3" id="h107-4-3" class="i">+        alias: None,
</a>     },
<a href="#h107-4-5" id="h107-4-5" class="d">-)
</a><a href="#h107-4-6" id="h107-4-6" class="i">+    labels: [
</a><a href="#h107-4-7" id="h107-4-7" class="i">+        Some(
</a><a href="#h107-4-8" id="h107-4-8" class="i">+            (
</a><a href="#h107-4-9" id="h107-4-9" class="i">+                Some(
</a><a href="#h107-4-10" id="h107-4-10" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-4-11" id="h107-4-11" class="i">+                ),
</a><a href="#h107-4-12" id="h107-4-12" class="i">+                &quot;id&quot;,
</a><a href="#h107-4-13" id="h107-4-13" class="i">+            ),
</a><a href="#h107-4-14" id="h107-4-14" class="i">+        ),
</a><a href="#h107-4-15" id="h107-4-15" class="i">+        Some(
</a><a href="#h107-4-16" id="h107-4-16" class="i">+            (
</a><a href="#h107-4-17" id="h107-4-17" class="i">+                Some(
</a><a href="#h107-4-18" id="h107-4-18" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-4-19" id="h107-4-19" class="i">+                ),
</a><a href="#h107-4-20" id="h107-4-20" class="i">+                &quot;title&quot;,
</a><a href="#h107-4-21" id="h107-4-21" class="i">+            ),
</a><a href="#h107-4-22" id="h107-4-22" class="i">+        ),
</a><a href="#h107-4-23" id="h107-4-23" class="i">+        Some(
</a><a href="#h107-4-24" id="h107-4-24" class="i">+            (
</a><a href="#h107-4-25" id="h107-4-25" class="i">+                Some(
</a><a href="#h107-4-26" id="h107-4-26" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-4-27" id="h107-4-27" class="i">+                ),
</a><a href="#h107-4-28" id="h107-4-28" class="i">+                &quot;studio_id&quot;,
</a><a href="#h107-4-29" id="h107-4-29" class="i">+            ),
</a><a href="#h107-4-30" id="h107-4-30" class="i">+        ),
</a><a href="#h107-4-31" id="h107-4-31" class="i">+        Some(
</a><a href="#h107-4-32" id="h107-4-32" class="i">+            (
</a><a href="#h107-4-33" id="h107-4-33" class="i">+                Some(
</a><a href="#h107-4-34" id="h107-4-34" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-4-35" id="h107-4-35" class="i">+                ),
</a><a href="#h107-4-36" id="h107-4-36" class="i">+                &quot;genre_id&quot;,
</a><a href="#h107-4-37" id="h107-4-37" class="i">+            ),
</a><a href="#h107-4-38" id="h107-4-38" class="i">+        ),
</a><a href="#h107-4-39" id="h107-4-39" class="i">+        Some(
</a><a href="#h107-4-40" id="h107-4-40" class="i">+            (
</a><a href="#h107-4-41" id="h107-4-41" class="i">+                Some(
</a><a href="#h107-4-42" id="h107-4-42" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-4-43" id="h107-4-43" class="i">+                ),
</a><a href="#h107-4-44" id="h107-4-44" class="i">+                &quot;released&quot;,
</a><a href="#h107-4-45" id="h107-4-45" class="i">+            ),
</a><a href="#h107-4-46" id="h107-4-46" class="i">+        ),
</a><a href="#h107-4-47" id="h107-4-47" class="i">+        Some(
</a><a href="#h107-4-48" id="h107-4-48" class="i">+            (
</a><a href="#h107-4-49" id="h107-4-49" class="i">+                Some(
</a><a href="#h107-4-50" id="h107-4-50" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-4-51" id="h107-4-51" class="i">+                ),
</a><a href="#h107-4-52" id="h107-4-52" class="i">+                &quot;rating&quot;,
</a><a href="#h107-4-53" id="h107-4-53" class="i">+            ),
</a><a href="#h107-4-54" id="h107-4-54" class="i">+        ),
</a><a href="#h107-4-55" id="h107-4-55" class="i">+        Some(
</a><a href="#h107-4-56" id="h107-4-56" class="i">+            (
</a><a href="#h107-4-57" id="h107-4-57" class="i">+                Some(
</a><a href="#h107-4-58" id="h107-4-58" class="i">+                    &quot;movies&quot;,
</a><a href="#h107-4-59" id="h107-4-59" class="i">+                ),
</a><a href="#h107-4-60" id="h107-4-60" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h107-4-61" id="h107-4-61" class="i">+            ),
</a><a href="#h107-4-62" id="h107-4-62" class="i">+        ),
</a><a href="#h107-4-63" id="h107-4-63" class="i">+    ],
</a><a href="#h107-4-64" id="h107-4-64" class="i">+}
</a> 
<b>diff --git a/<a id="h108" href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a> b/<a href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a></b>
<a href="#h108-0" id="h108-0" class="h">@@ -46,8 +46,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h108-0-3" id="h108-0-3" class="d">-Plan: Select(
</a><a href="#h108-0-4" id="h108-0-4" class="d">-    Order {
</a><a href="#h108-0-5" id="h108-0-5" class="i">+Plan: Select {
</a><a href="#h108-0-6" id="h108-0-6" class="i">+    root: Order {
</a>         source: Filter {
             source: Scan {
                 table: Table {
<a href="#h108-1" id="h108-1" class="h">@@ -127,8 +127,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h108-1-3" id="h108-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h108-1-5" id="h108-1-5" class="i">+                alias: None,
</a>             },
             predicate: Equal(
                 Field(
<a href="#h108-2" id="h108-2" class="h">@@ -162,10 +162,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h108-2-3" id="h108-2-3" class="d">-)
</a><a href="#h108-2-4" id="h108-2-4" class="i">+    labels: [
</a><a href="#h108-2-5" id="h108-2-5" class="i">+        Some(
</a><a href="#h108-2-6" id="h108-2-6" class="i">+            (
</a><a href="#h108-2-7" id="h108-2-7" class="i">+                Some(
</a><a href="#h108-2-8" id="h108-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-2-9" id="h108-2-9" class="i">+                ),
</a><a href="#h108-2-10" id="h108-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h108-2-11" id="h108-2-11" class="i">+            ),
</a><a href="#h108-2-12" id="h108-2-12" class="i">+        ),
</a><a href="#h108-2-13" id="h108-2-13" class="i">+        Some(
</a><a href="#h108-2-14" id="h108-2-14" class="i">+            (
</a><a href="#h108-2-15" id="h108-2-15" class="i">+                Some(
</a><a href="#h108-2-16" id="h108-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-2-17" id="h108-2-17" class="i">+                ),
</a><a href="#h108-2-18" id="h108-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h108-2-19" id="h108-2-19" class="i">+            ),
</a><a href="#h108-2-20" id="h108-2-20" class="i">+        ),
</a><a href="#h108-2-21" id="h108-2-21" class="i">+        Some(
</a><a href="#h108-2-22" id="h108-2-22" class="i">+            (
</a><a href="#h108-2-23" id="h108-2-23" class="i">+                Some(
</a><a href="#h108-2-24" id="h108-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-2-25" id="h108-2-25" class="i">+                ),
</a><a href="#h108-2-26" id="h108-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h108-2-27" id="h108-2-27" class="i">+            ),
</a><a href="#h108-2-28" id="h108-2-28" class="i">+        ),
</a><a href="#h108-2-29" id="h108-2-29" class="i">+        Some(
</a><a href="#h108-2-30" id="h108-2-30" class="i">+            (
</a><a href="#h108-2-31" id="h108-2-31" class="i">+                Some(
</a><a href="#h108-2-32" id="h108-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-2-33" id="h108-2-33" class="i">+                ),
</a><a href="#h108-2-34" id="h108-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h108-2-35" id="h108-2-35" class="i">+            ),
</a><a href="#h108-2-36" id="h108-2-36" class="i">+        ),
</a><a href="#h108-2-37" id="h108-2-37" class="i">+        Some(
</a><a href="#h108-2-38" id="h108-2-38" class="i">+            (
</a><a href="#h108-2-39" id="h108-2-39" class="i">+                Some(
</a><a href="#h108-2-40" id="h108-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-2-41" id="h108-2-41" class="i">+                ),
</a><a href="#h108-2-42" id="h108-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h108-2-43" id="h108-2-43" class="i">+            ),
</a><a href="#h108-2-44" id="h108-2-44" class="i">+        ),
</a><a href="#h108-2-45" id="h108-2-45" class="i">+        Some(
</a><a href="#h108-2-46" id="h108-2-46" class="i">+            (
</a><a href="#h108-2-47" id="h108-2-47" class="i">+                Some(
</a><a href="#h108-2-48" id="h108-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-2-49" id="h108-2-49" class="i">+                ),
</a><a href="#h108-2-50" id="h108-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h108-2-51" id="h108-2-51" class="i">+            ),
</a><a href="#h108-2-52" id="h108-2-52" class="i">+        ),
</a><a href="#h108-2-53" id="h108-2-53" class="i">+        Some(
</a><a href="#h108-2-54" id="h108-2-54" class="i">+            (
</a><a href="#h108-2-55" id="h108-2-55" class="i">+                Some(
</a><a href="#h108-2-56" id="h108-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-2-57" id="h108-2-57" class="i">+                ),
</a><a href="#h108-2-58" id="h108-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h108-2-59" id="h108-2-59" class="i">+            ),
</a><a href="#h108-2-60" id="h108-2-60" class="i">+        ),
</a><a href="#h108-2-61" id="h108-2-61" class="i">+    ],
</a><a href="#h108-2-62" id="h108-2-62" class="i">+}
</a> 
<a href="#h108-2-64" id="h108-2-64" class="d">-Optimized plan: Select(
</a><a href="#h108-2-65" id="h108-2-65" class="d">-    Order {
</a><a href="#h108-2-66" id="h108-2-66" class="i">+Optimized plan: Select {
</a><a href="#h108-2-67" id="h108-2-67" class="i">+    root: Order {
</a>         source: IndexLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h108-3" id="h108-3" class="h">@@ -267,5 +325,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h108-3-3" id="h108-3-3" class="d">-)
</a><a href="#h108-3-4" id="h108-3-4" class="i">+    labels: [
</a><a href="#h108-3-5" id="h108-3-5" class="i">+        Some(
</a><a href="#h108-3-6" id="h108-3-6" class="i">+            (
</a><a href="#h108-3-7" id="h108-3-7" class="i">+                Some(
</a><a href="#h108-3-8" id="h108-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-3-9" id="h108-3-9" class="i">+                ),
</a><a href="#h108-3-10" id="h108-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h108-3-11" id="h108-3-11" class="i">+            ),
</a><a href="#h108-3-12" id="h108-3-12" class="i">+        ),
</a><a href="#h108-3-13" id="h108-3-13" class="i">+        Some(
</a><a href="#h108-3-14" id="h108-3-14" class="i">+            (
</a><a href="#h108-3-15" id="h108-3-15" class="i">+                Some(
</a><a href="#h108-3-16" id="h108-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-3-17" id="h108-3-17" class="i">+                ),
</a><a href="#h108-3-18" id="h108-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h108-3-19" id="h108-3-19" class="i">+            ),
</a><a href="#h108-3-20" id="h108-3-20" class="i">+        ),
</a><a href="#h108-3-21" id="h108-3-21" class="i">+        Some(
</a><a href="#h108-3-22" id="h108-3-22" class="i">+            (
</a><a href="#h108-3-23" id="h108-3-23" class="i">+                Some(
</a><a href="#h108-3-24" id="h108-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-3-25" id="h108-3-25" class="i">+                ),
</a><a href="#h108-3-26" id="h108-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h108-3-27" id="h108-3-27" class="i">+            ),
</a><a href="#h108-3-28" id="h108-3-28" class="i">+        ),
</a><a href="#h108-3-29" id="h108-3-29" class="i">+        Some(
</a><a href="#h108-3-30" id="h108-3-30" class="i">+            (
</a><a href="#h108-3-31" id="h108-3-31" class="i">+                Some(
</a><a href="#h108-3-32" id="h108-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-3-33" id="h108-3-33" class="i">+                ),
</a><a href="#h108-3-34" id="h108-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h108-3-35" id="h108-3-35" class="i">+            ),
</a><a href="#h108-3-36" id="h108-3-36" class="i">+        ),
</a><a href="#h108-3-37" id="h108-3-37" class="i">+        Some(
</a><a href="#h108-3-38" id="h108-3-38" class="i">+            (
</a><a href="#h108-3-39" id="h108-3-39" class="i">+                Some(
</a><a href="#h108-3-40" id="h108-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-3-41" id="h108-3-41" class="i">+                ),
</a><a href="#h108-3-42" id="h108-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h108-3-43" id="h108-3-43" class="i">+            ),
</a><a href="#h108-3-44" id="h108-3-44" class="i">+        ),
</a><a href="#h108-3-45" id="h108-3-45" class="i">+        Some(
</a><a href="#h108-3-46" id="h108-3-46" class="i">+            (
</a><a href="#h108-3-47" id="h108-3-47" class="i">+                Some(
</a><a href="#h108-3-48" id="h108-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-3-49" id="h108-3-49" class="i">+                ),
</a><a href="#h108-3-50" id="h108-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h108-3-51" id="h108-3-51" class="i">+            ),
</a><a href="#h108-3-52" id="h108-3-52" class="i">+        ),
</a><a href="#h108-3-53" id="h108-3-53" class="i">+        Some(
</a><a href="#h108-3-54" id="h108-3-54" class="i">+            (
</a><a href="#h108-3-55" id="h108-3-55" class="i">+                Some(
</a><a href="#h108-3-56" id="h108-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h108-3-57" id="h108-3-57" class="i">+                ),
</a><a href="#h108-3-58" id="h108-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h108-3-59" id="h108-3-59" class="i">+            ),
</a><a href="#h108-3-60" id="h108-3-60" class="i">+        ),
</a><a href="#h108-3-61" id="h108-3-61" class="i">+    ],
</a><a href="#h108-3-62" id="h108-3-62" class="i">+}
</a> 
<b>diff --git a/<a id="h109" href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a> b/<a href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a></b>
<a href="#h109-0" id="h109-0" class="h">@@ -99,8 +99,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h109-0-3" id="h109-0-3" class="d">-Plan: Select(
</a><a href="#h109-0-4" id="h109-0-4" class="d">-    Order {
</a><a href="#h109-0-5" id="h109-0-5" class="i">+Plan: Select {
</a><a href="#h109-0-6" id="h109-0-6" class="i">+    root: Order {
</a>         source: Filter {
             source: Scan {
                 table: Table {
<a href="#h109-1" id="h109-1" class="h">@@ -180,8 +180,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h109-1-3" id="h109-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h109-1-5" id="h109-1-5" class="i">+                alias: None,
</a>             },
             predicate: Or(
                 Or(
<a href="#h109-2" id="h109-2" class="h">@@ -269,10 +269,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h109-2-3" id="h109-2-3" class="d">-)
</a><a href="#h109-2-4" id="h109-2-4" class="i">+    labels: [
</a><a href="#h109-2-5" id="h109-2-5" class="i">+        Some(
</a><a href="#h109-2-6" id="h109-2-6" class="i">+            (
</a><a href="#h109-2-7" id="h109-2-7" class="i">+                Some(
</a><a href="#h109-2-8" id="h109-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-2-9" id="h109-2-9" class="i">+                ),
</a><a href="#h109-2-10" id="h109-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h109-2-11" id="h109-2-11" class="i">+            ),
</a><a href="#h109-2-12" id="h109-2-12" class="i">+        ),
</a><a href="#h109-2-13" id="h109-2-13" class="i">+        Some(
</a><a href="#h109-2-14" id="h109-2-14" class="i">+            (
</a><a href="#h109-2-15" id="h109-2-15" class="i">+                Some(
</a><a href="#h109-2-16" id="h109-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-2-17" id="h109-2-17" class="i">+                ),
</a><a href="#h109-2-18" id="h109-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h109-2-19" id="h109-2-19" class="i">+            ),
</a><a href="#h109-2-20" id="h109-2-20" class="i">+        ),
</a><a href="#h109-2-21" id="h109-2-21" class="i">+        Some(
</a><a href="#h109-2-22" id="h109-2-22" class="i">+            (
</a><a href="#h109-2-23" id="h109-2-23" class="i">+                Some(
</a><a href="#h109-2-24" id="h109-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-2-25" id="h109-2-25" class="i">+                ),
</a><a href="#h109-2-26" id="h109-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h109-2-27" id="h109-2-27" class="i">+            ),
</a><a href="#h109-2-28" id="h109-2-28" class="i">+        ),
</a><a href="#h109-2-29" id="h109-2-29" class="i">+        Some(
</a><a href="#h109-2-30" id="h109-2-30" class="i">+            (
</a><a href="#h109-2-31" id="h109-2-31" class="i">+                Some(
</a><a href="#h109-2-32" id="h109-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-2-33" id="h109-2-33" class="i">+                ),
</a><a href="#h109-2-34" id="h109-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h109-2-35" id="h109-2-35" class="i">+            ),
</a><a href="#h109-2-36" id="h109-2-36" class="i">+        ),
</a><a href="#h109-2-37" id="h109-2-37" class="i">+        Some(
</a><a href="#h109-2-38" id="h109-2-38" class="i">+            (
</a><a href="#h109-2-39" id="h109-2-39" class="i">+                Some(
</a><a href="#h109-2-40" id="h109-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-2-41" id="h109-2-41" class="i">+                ),
</a><a href="#h109-2-42" id="h109-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h109-2-43" id="h109-2-43" class="i">+            ),
</a><a href="#h109-2-44" id="h109-2-44" class="i">+        ),
</a><a href="#h109-2-45" id="h109-2-45" class="i">+        Some(
</a><a href="#h109-2-46" id="h109-2-46" class="i">+            (
</a><a href="#h109-2-47" id="h109-2-47" class="i">+                Some(
</a><a href="#h109-2-48" id="h109-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-2-49" id="h109-2-49" class="i">+                ),
</a><a href="#h109-2-50" id="h109-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h109-2-51" id="h109-2-51" class="i">+            ),
</a><a href="#h109-2-52" id="h109-2-52" class="i">+        ),
</a><a href="#h109-2-53" id="h109-2-53" class="i">+        Some(
</a><a href="#h109-2-54" id="h109-2-54" class="i">+            (
</a><a href="#h109-2-55" id="h109-2-55" class="i">+                Some(
</a><a href="#h109-2-56" id="h109-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-2-57" id="h109-2-57" class="i">+                ),
</a><a href="#h109-2-58" id="h109-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h109-2-59" id="h109-2-59" class="i">+            ),
</a><a href="#h109-2-60" id="h109-2-60" class="i">+        ),
</a><a href="#h109-2-61" id="h109-2-61" class="i">+    ],
</a><a href="#h109-2-62" id="h109-2-62" class="i">+}
</a> 
<a href="#h109-2-64" id="h109-2-64" class="d">-Optimized plan: Select(
</a><a href="#h109-2-65" id="h109-2-65" class="d">-    Order {
</a><a href="#h109-2-66" id="h109-2-66" class="i">+Optimized plan: Select {
</a><a href="#h109-2-67" id="h109-2-67" class="i">+    root: Order {
</a>         source: IndexLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h109-3" id="h109-3" class="h">@@ -383,5 +441,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h109-3-3" id="h109-3-3" class="d">-)
</a><a href="#h109-3-4" id="h109-3-4" class="i">+    labels: [
</a><a href="#h109-3-5" id="h109-3-5" class="i">+        Some(
</a><a href="#h109-3-6" id="h109-3-6" class="i">+            (
</a><a href="#h109-3-7" id="h109-3-7" class="i">+                Some(
</a><a href="#h109-3-8" id="h109-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-3-9" id="h109-3-9" class="i">+                ),
</a><a href="#h109-3-10" id="h109-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h109-3-11" id="h109-3-11" class="i">+            ),
</a><a href="#h109-3-12" id="h109-3-12" class="i">+        ),
</a><a href="#h109-3-13" id="h109-3-13" class="i">+        Some(
</a><a href="#h109-3-14" id="h109-3-14" class="i">+            (
</a><a href="#h109-3-15" id="h109-3-15" class="i">+                Some(
</a><a href="#h109-3-16" id="h109-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-3-17" id="h109-3-17" class="i">+                ),
</a><a href="#h109-3-18" id="h109-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h109-3-19" id="h109-3-19" class="i">+            ),
</a><a href="#h109-3-20" id="h109-3-20" class="i">+        ),
</a><a href="#h109-3-21" id="h109-3-21" class="i">+        Some(
</a><a href="#h109-3-22" id="h109-3-22" class="i">+            (
</a><a href="#h109-3-23" id="h109-3-23" class="i">+                Some(
</a><a href="#h109-3-24" id="h109-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-3-25" id="h109-3-25" class="i">+                ),
</a><a href="#h109-3-26" id="h109-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h109-3-27" id="h109-3-27" class="i">+            ),
</a><a href="#h109-3-28" id="h109-3-28" class="i">+        ),
</a><a href="#h109-3-29" id="h109-3-29" class="i">+        Some(
</a><a href="#h109-3-30" id="h109-3-30" class="i">+            (
</a><a href="#h109-3-31" id="h109-3-31" class="i">+                Some(
</a><a href="#h109-3-32" id="h109-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-3-33" id="h109-3-33" class="i">+                ),
</a><a href="#h109-3-34" id="h109-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h109-3-35" id="h109-3-35" class="i">+            ),
</a><a href="#h109-3-36" id="h109-3-36" class="i">+        ),
</a><a href="#h109-3-37" id="h109-3-37" class="i">+        Some(
</a><a href="#h109-3-38" id="h109-3-38" class="i">+            (
</a><a href="#h109-3-39" id="h109-3-39" class="i">+                Some(
</a><a href="#h109-3-40" id="h109-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-3-41" id="h109-3-41" class="i">+                ),
</a><a href="#h109-3-42" id="h109-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h109-3-43" id="h109-3-43" class="i">+            ),
</a><a href="#h109-3-44" id="h109-3-44" class="i">+        ),
</a><a href="#h109-3-45" id="h109-3-45" class="i">+        Some(
</a><a href="#h109-3-46" id="h109-3-46" class="i">+            (
</a><a href="#h109-3-47" id="h109-3-47" class="i">+                Some(
</a><a href="#h109-3-48" id="h109-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-3-49" id="h109-3-49" class="i">+                ),
</a><a href="#h109-3-50" id="h109-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h109-3-51" id="h109-3-51" class="i">+            ),
</a><a href="#h109-3-52" id="h109-3-52" class="i">+        ),
</a><a href="#h109-3-53" id="h109-3-53" class="i">+        Some(
</a><a href="#h109-3-54" id="h109-3-54" class="i">+            (
</a><a href="#h109-3-55" id="h109-3-55" class="i">+                Some(
</a><a href="#h109-3-56" id="h109-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h109-3-57" id="h109-3-57" class="i">+                ),
</a><a href="#h109-3-58" id="h109-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h109-3-59" id="h109-3-59" class="i">+            ),
</a><a href="#h109-3-60" id="h109-3-60" class="i">+        ),
</a><a href="#h109-3-61" id="h109-3-61" class="i">+    ],
</a><a href="#h109-3-62" id="h109-3-62" class="i">+}
</a> 
<b>diff --git a/<a id="h110" href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a> b/<a href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a></b>
<a href="#h110-0" id="h110-0" class="h">@@ -81,8 +81,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h110-0-3" id="h110-0-3" class="d">-Plan: Select(
</a><a href="#h110-0-4" id="h110-0-4" class="d">-    Order {
</a><a href="#h110-0-5" id="h110-0-5" class="i">+Plan: Select {
</a><a href="#h110-0-6" id="h110-0-6" class="i">+    root: Order {
</a>         source: Filter {
             source: Scan {
                 table: Table {
<a href="#h110-1" id="h110-1" class="h">@@ -162,8 +162,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h110-1-3" id="h110-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h110-1-5" id="h110-1-5" class="i">+                alias: None,
</a>             },
             predicate: And(
                 Or(
<a href="#h110-2" id="h110-2" class="h">@@ -233,10 +233,68 @@ Plan: Select(
</a>             ),
         ],
     },
<a href="#h110-2-3" id="h110-2-3" class="d">-)
</a><a href="#h110-2-4" id="h110-2-4" class="i">+    labels: [
</a><a href="#h110-2-5" id="h110-2-5" class="i">+        Some(
</a><a href="#h110-2-6" id="h110-2-6" class="i">+            (
</a><a href="#h110-2-7" id="h110-2-7" class="i">+                Some(
</a><a href="#h110-2-8" id="h110-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-2-9" id="h110-2-9" class="i">+                ),
</a><a href="#h110-2-10" id="h110-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h110-2-11" id="h110-2-11" class="i">+            ),
</a><a href="#h110-2-12" id="h110-2-12" class="i">+        ),
</a><a href="#h110-2-13" id="h110-2-13" class="i">+        Some(
</a><a href="#h110-2-14" id="h110-2-14" class="i">+            (
</a><a href="#h110-2-15" id="h110-2-15" class="i">+                Some(
</a><a href="#h110-2-16" id="h110-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-2-17" id="h110-2-17" class="i">+                ),
</a><a href="#h110-2-18" id="h110-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h110-2-19" id="h110-2-19" class="i">+            ),
</a><a href="#h110-2-20" id="h110-2-20" class="i">+        ),
</a><a href="#h110-2-21" id="h110-2-21" class="i">+        Some(
</a><a href="#h110-2-22" id="h110-2-22" class="i">+            (
</a><a href="#h110-2-23" id="h110-2-23" class="i">+                Some(
</a><a href="#h110-2-24" id="h110-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-2-25" id="h110-2-25" class="i">+                ),
</a><a href="#h110-2-26" id="h110-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h110-2-27" id="h110-2-27" class="i">+            ),
</a><a href="#h110-2-28" id="h110-2-28" class="i">+        ),
</a><a href="#h110-2-29" id="h110-2-29" class="i">+        Some(
</a><a href="#h110-2-30" id="h110-2-30" class="i">+            (
</a><a href="#h110-2-31" id="h110-2-31" class="i">+                Some(
</a><a href="#h110-2-32" id="h110-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-2-33" id="h110-2-33" class="i">+                ),
</a><a href="#h110-2-34" id="h110-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h110-2-35" id="h110-2-35" class="i">+            ),
</a><a href="#h110-2-36" id="h110-2-36" class="i">+        ),
</a><a href="#h110-2-37" id="h110-2-37" class="i">+        Some(
</a><a href="#h110-2-38" id="h110-2-38" class="i">+            (
</a><a href="#h110-2-39" id="h110-2-39" class="i">+                Some(
</a><a href="#h110-2-40" id="h110-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-2-41" id="h110-2-41" class="i">+                ),
</a><a href="#h110-2-42" id="h110-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h110-2-43" id="h110-2-43" class="i">+            ),
</a><a href="#h110-2-44" id="h110-2-44" class="i">+        ),
</a><a href="#h110-2-45" id="h110-2-45" class="i">+        Some(
</a><a href="#h110-2-46" id="h110-2-46" class="i">+            (
</a><a href="#h110-2-47" id="h110-2-47" class="i">+                Some(
</a><a href="#h110-2-48" id="h110-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-2-49" id="h110-2-49" class="i">+                ),
</a><a href="#h110-2-50" id="h110-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h110-2-51" id="h110-2-51" class="i">+            ),
</a><a href="#h110-2-52" id="h110-2-52" class="i">+        ),
</a><a href="#h110-2-53" id="h110-2-53" class="i">+        Some(
</a><a href="#h110-2-54" id="h110-2-54" class="i">+            (
</a><a href="#h110-2-55" id="h110-2-55" class="i">+                Some(
</a><a href="#h110-2-56" id="h110-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-2-57" id="h110-2-57" class="i">+                ),
</a><a href="#h110-2-58" id="h110-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h110-2-59" id="h110-2-59" class="i">+            ),
</a><a href="#h110-2-60" id="h110-2-60" class="i">+        ),
</a><a href="#h110-2-61" id="h110-2-61" class="i">+    ],
</a><a href="#h110-2-62" id="h110-2-62" class="i">+}
</a> 
<a href="#h110-2-64" id="h110-2-64" class="d">-Optimized plan: Select(
</a><a href="#h110-2-65" id="h110-2-65" class="d">-    Order {
</a><a href="#h110-2-66" id="h110-2-66" class="i">+Optimized plan: Select {
</a><a href="#h110-2-67" id="h110-2-67" class="i">+    root: Order {
</a>         source: Filter {
             source: IndexLookup {
                 table: Table {
<a href="#h110-3" id="h110-3" class="h">@@ -359,5 +417,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h110-3-3" id="h110-3-3" class="d">-)
</a><a href="#h110-3-4" id="h110-3-4" class="i">+    labels: [
</a><a href="#h110-3-5" id="h110-3-5" class="i">+        Some(
</a><a href="#h110-3-6" id="h110-3-6" class="i">+            (
</a><a href="#h110-3-7" id="h110-3-7" class="i">+                Some(
</a><a href="#h110-3-8" id="h110-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-3-9" id="h110-3-9" class="i">+                ),
</a><a href="#h110-3-10" id="h110-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h110-3-11" id="h110-3-11" class="i">+            ),
</a><a href="#h110-3-12" id="h110-3-12" class="i">+        ),
</a><a href="#h110-3-13" id="h110-3-13" class="i">+        Some(
</a><a href="#h110-3-14" id="h110-3-14" class="i">+            (
</a><a href="#h110-3-15" id="h110-3-15" class="i">+                Some(
</a><a href="#h110-3-16" id="h110-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-3-17" id="h110-3-17" class="i">+                ),
</a><a href="#h110-3-18" id="h110-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h110-3-19" id="h110-3-19" class="i">+            ),
</a><a href="#h110-3-20" id="h110-3-20" class="i">+        ),
</a><a href="#h110-3-21" id="h110-3-21" class="i">+        Some(
</a><a href="#h110-3-22" id="h110-3-22" class="i">+            (
</a><a href="#h110-3-23" id="h110-3-23" class="i">+                Some(
</a><a href="#h110-3-24" id="h110-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-3-25" id="h110-3-25" class="i">+                ),
</a><a href="#h110-3-26" id="h110-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h110-3-27" id="h110-3-27" class="i">+            ),
</a><a href="#h110-3-28" id="h110-3-28" class="i">+        ),
</a><a href="#h110-3-29" id="h110-3-29" class="i">+        Some(
</a><a href="#h110-3-30" id="h110-3-30" class="i">+            (
</a><a href="#h110-3-31" id="h110-3-31" class="i">+                Some(
</a><a href="#h110-3-32" id="h110-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-3-33" id="h110-3-33" class="i">+                ),
</a><a href="#h110-3-34" id="h110-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h110-3-35" id="h110-3-35" class="i">+            ),
</a><a href="#h110-3-36" id="h110-3-36" class="i">+        ),
</a><a href="#h110-3-37" id="h110-3-37" class="i">+        Some(
</a><a href="#h110-3-38" id="h110-3-38" class="i">+            (
</a><a href="#h110-3-39" id="h110-3-39" class="i">+                Some(
</a><a href="#h110-3-40" id="h110-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-3-41" id="h110-3-41" class="i">+                ),
</a><a href="#h110-3-42" id="h110-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h110-3-43" id="h110-3-43" class="i">+            ),
</a><a href="#h110-3-44" id="h110-3-44" class="i">+        ),
</a><a href="#h110-3-45" id="h110-3-45" class="i">+        Some(
</a><a href="#h110-3-46" id="h110-3-46" class="i">+            (
</a><a href="#h110-3-47" id="h110-3-47" class="i">+                Some(
</a><a href="#h110-3-48" id="h110-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-3-49" id="h110-3-49" class="i">+                ),
</a><a href="#h110-3-50" id="h110-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h110-3-51" id="h110-3-51" class="i">+            ),
</a><a href="#h110-3-52" id="h110-3-52" class="i">+        ),
</a><a href="#h110-3-53" id="h110-3-53" class="i">+        Some(
</a><a href="#h110-3-54" id="h110-3-54" class="i">+            (
</a><a href="#h110-3-55" id="h110-3-55" class="i">+                Some(
</a><a href="#h110-3-56" id="h110-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h110-3-57" id="h110-3-57" class="i">+                ),
</a><a href="#h110-3-58" id="h110-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h110-3-59" id="h110-3-59" class="i">+            ),
</a><a href="#h110-3-60" id="h110-3-60" class="i">+        ),
</a><a href="#h110-3-61" id="h110-3-61" class="i">+    ],
</a><a href="#h110-3-62" id="h110-3-62" class="i">+}
</a> 
<b>diff --git a/<a id="h111" href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a> b/<a href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a></b>
<a href="#h111-0" id="h111-0" class="h">@@ -27,8 +27,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h111-0-3" id="h111-0-3" class="d">-Plan: Select(
</a><a href="#h111-0-4" id="h111-0-4" class="d">-    Filter {
</a><a href="#h111-0-5" id="h111-0-5" class="i">+Plan: Select {
</a><a href="#h111-0-6" id="h111-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h111-1" id="h111-1" class="h">@@ -107,8 +107,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h111-1-3" id="h111-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h111-1-5" id="h111-1-5" class="i">+            alias: None,
</a>         },
         predicate: Constant(
             Integer(
<a href="#h111-2" id="h111-2" class="h">@@ -116,10 +116,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h111-2-3" id="h111-2-3" class="d">-)
</a><a href="#h111-2-4" id="h111-2-4" class="i">+    labels: [
</a><a href="#h111-2-5" id="h111-2-5" class="i">+        Some(
</a><a href="#h111-2-6" id="h111-2-6" class="i">+            (
</a><a href="#h111-2-7" id="h111-2-7" class="i">+                Some(
</a><a href="#h111-2-8" id="h111-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-2-9" id="h111-2-9" class="i">+                ),
</a><a href="#h111-2-10" id="h111-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h111-2-11" id="h111-2-11" class="i">+            ),
</a><a href="#h111-2-12" id="h111-2-12" class="i">+        ),
</a><a href="#h111-2-13" id="h111-2-13" class="i">+        Some(
</a><a href="#h111-2-14" id="h111-2-14" class="i">+            (
</a><a href="#h111-2-15" id="h111-2-15" class="i">+                Some(
</a><a href="#h111-2-16" id="h111-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-2-17" id="h111-2-17" class="i">+                ),
</a><a href="#h111-2-18" id="h111-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h111-2-19" id="h111-2-19" class="i">+            ),
</a><a href="#h111-2-20" id="h111-2-20" class="i">+        ),
</a><a href="#h111-2-21" id="h111-2-21" class="i">+        Some(
</a><a href="#h111-2-22" id="h111-2-22" class="i">+            (
</a><a href="#h111-2-23" id="h111-2-23" class="i">+                Some(
</a><a href="#h111-2-24" id="h111-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-2-25" id="h111-2-25" class="i">+                ),
</a><a href="#h111-2-26" id="h111-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h111-2-27" id="h111-2-27" class="i">+            ),
</a><a href="#h111-2-28" id="h111-2-28" class="i">+        ),
</a><a href="#h111-2-29" id="h111-2-29" class="i">+        Some(
</a><a href="#h111-2-30" id="h111-2-30" class="i">+            (
</a><a href="#h111-2-31" id="h111-2-31" class="i">+                Some(
</a><a href="#h111-2-32" id="h111-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-2-33" id="h111-2-33" class="i">+                ),
</a><a href="#h111-2-34" id="h111-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h111-2-35" id="h111-2-35" class="i">+            ),
</a><a href="#h111-2-36" id="h111-2-36" class="i">+        ),
</a><a href="#h111-2-37" id="h111-2-37" class="i">+        Some(
</a><a href="#h111-2-38" id="h111-2-38" class="i">+            (
</a><a href="#h111-2-39" id="h111-2-39" class="i">+                Some(
</a><a href="#h111-2-40" id="h111-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-2-41" id="h111-2-41" class="i">+                ),
</a><a href="#h111-2-42" id="h111-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h111-2-43" id="h111-2-43" class="i">+            ),
</a><a href="#h111-2-44" id="h111-2-44" class="i">+        ),
</a><a href="#h111-2-45" id="h111-2-45" class="i">+        Some(
</a><a href="#h111-2-46" id="h111-2-46" class="i">+            (
</a><a href="#h111-2-47" id="h111-2-47" class="i">+                Some(
</a><a href="#h111-2-48" id="h111-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-2-49" id="h111-2-49" class="i">+                ),
</a><a href="#h111-2-50" id="h111-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h111-2-51" id="h111-2-51" class="i">+            ),
</a><a href="#h111-2-52" id="h111-2-52" class="i">+        ),
</a><a href="#h111-2-53" id="h111-2-53" class="i">+        Some(
</a><a href="#h111-2-54" id="h111-2-54" class="i">+            (
</a><a href="#h111-2-55" id="h111-2-55" class="i">+                Some(
</a><a href="#h111-2-56" id="h111-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-2-57" id="h111-2-57" class="i">+                ),
</a><a href="#h111-2-58" id="h111-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h111-2-59" id="h111-2-59" class="i">+            ),
</a><a href="#h111-2-60" id="h111-2-60" class="i">+        ),
</a><a href="#h111-2-61" id="h111-2-61" class="i">+    ],
</a><a href="#h111-2-62" id="h111-2-62" class="i">+}
</a> 
<a href="#h111-2-64" id="h111-2-64" class="d">-Optimized plan: Select(
</a><a href="#h111-2-65" id="h111-2-65" class="d">-    Scan {
</a><a href="#h111-2-66" id="h111-2-66" class="i">+Optimized plan: Select {
</a><a href="#h111-2-67" id="h111-2-67" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h111-3" id="h111-3" class="h">@@ -197,7 +255,6 @@ Optimized plan: Select(
</a>                 },
             ],
         },
<a href="#h111-3-3" id="h111-3-3" class="d">-        alias: None,
</a>         filter: Some(
             Constant(
                 Integer(
<a href="#h111-4" id="h111-4" class="h">@@ -205,6 +262,65 @@ Optimized plan: Select(
</a>                 ),
             ),
         ),
<a href="#h111-4-3" id="h111-4-3" class="i">+        alias: None,
</a>     },
<a href="#h111-4-5" id="h111-4-5" class="d">-)
</a><a href="#h111-4-6" id="h111-4-6" class="i">+    labels: [
</a><a href="#h111-4-7" id="h111-4-7" class="i">+        Some(
</a><a href="#h111-4-8" id="h111-4-8" class="i">+            (
</a><a href="#h111-4-9" id="h111-4-9" class="i">+                Some(
</a><a href="#h111-4-10" id="h111-4-10" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-4-11" id="h111-4-11" class="i">+                ),
</a><a href="#h111-4-12" id="h111-4-12" class="i">+                &quot;id&quot;,
</a><a href="#h111-4-13" id="h111-4-13" class="i">+            ),
</a><a href="#h111-4-14" id="h111-4-14" class="i">+        ),
</a><a href="#h111-4-15" id="h111-4-15" class="i">+        Some(
</a><a href="#h111-4-16" id="h111-4-16" class="i">+            (
</a><a href="#h111-4-17" id="h111-4-17" class="i">+                Some(
</a><a href="#h111-4-18" id="h111-4-18" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-4-19" id="h111-4-19" class="i">+                ),
</a><a href="#h111-4-20" id="h111-4-20" class="i">+                &quot;title&quot;,
</a><a href="#h111-4-21" id="h111-4-21" class="i">+            ),
</a><a href="#h111-4-22" id="h111-4-22" class="i">+        ),
</a><a href="#h111-4-23" id="h111-4-23" class="i">+        Some(
</a><a href="#h111-4-24" id="h111-4-24" class="i">+            (
</a><a href="#h111-4-25" id="h111-4-25" class="i">+                Some(
</a><a href="#h111-4-26" id="h111-4-26" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-4-27" id="h111-4-27" class="i">+                ),
</a><a href="#h111-4-28" id="h111-4-28" class="i">+                &quot;studio_id&quot;,
</a><a href="#h111-4-29" id="h111-4-29" class="i">+            ),
</a><a href="#h111-4-30" id="h111-4-30" class="i">+        ),
</a><a href="#h111-4-31" id="h111-4-31" class="i">+        Some(
</a><a href="#h111-4-32" id="h111-4-32" class="i">+            (
</a><a href="#h111-4-33" id="h111-4-33" class="i">+                Some(
</a><a href="#h111-4-34" id="h111-4-34" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-4-35" id="h111-4-35" class="i">+                ),
</a><a href="#h111-4-36" id="h111-4-36" class="i">+                &quot;genre_id&quot;,
</a><a href="#h111-4-37" id="h111-4-37" class="i">+            ),
</a><a href="#h111-4-38" id="h111-4-38" class="i">+        ),
</a><a href="#h111-4-39" id="h111-4-39" class="i">+        Some(
</a><a href="#h111-4-40" id="h111-4-40" class="i">+            (
</a><a href="#h111-4-41" id="h111-4-41" class="i">+                Some(
</a><a href="#h111-4-42" id="h111-4-42" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-4-43" id="h111-4-43" class="i">+                ),
</a><a href="#h111-4-44" id="h111-4-44" class="i">+                &quot;released&quot;,
</a><a href="#h111-4-45" id="h111-4-45" class="i">+            ),
</a><a href="#h111-4-46" id="h111-4-46" class="i">+        ),
</a><a href="#h111-4-47" id="h111-4-47" class="i">+        Some(
</a><a href="#h111-4-48" id="h111-4-48" class="i">+            (
</a><a href="#h111-4-49" id="h111-4-49" class="i">+                Some(
</a><a href="#h111-4-50" id="h111-4-50" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-4-51" id="h111-4-51" class="i">+                ),
</a><a href="#h111-4-52" id="h111-4-52" class="i">+                &quot;rating&quot;,
</a><a href="#h111-4-53" id="h111-4-53" class="i">+            ),
</a><a href="#h111-4-54" id="h111-4-54" class="i">+        ),
</a><a href="#h111-4-55" id="h111-4-55" class="i">+        Some(
</a><a href="#h111-4-56" id="h111-4-56" class="i">+            (
</a><a href="#h111-4-57" id="h111-4-57" class="i">+                Some(
</a><a href="#h111-4-58" id="h111-4-58" class="i">+                    &quot;movies&quot;,
</a><a href="#h111-4-59" id="h111-4-59" class="i">+                ),
</a><a href="#h111-4-60" id="h111-4-60" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h111-4-61" id="h111-4-61" class="i">+            ),
</a><a href="#h111-4-62" id="h111-4-62" class="i">+        ),
</a><a href="#h111-4-63" id="h111-4-63" class="i">+    ],
</a><a href="#h111-4-64" id="h111-4-64" class="i">+}
</a> 
<b>diff --git a/<a id="h112" href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a> b/<a href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a></b>
<a href="#h112-0" id="h112-0" class="h">@@ -54,8 +54,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h112-0-3" id="h112-0-3" class="d">-Plan: Select(
</a><a href="#h112-0-4" id="h112-0-4" class="d">-    Filter {
</a><a href="#h112-0-5" id="h112-0-5" class="i">+Plan: Select {
</a><a href="#h112-0-6" id="h112-0-6" class="i">+    root: Filter {
</a>         source: NestedLoopJoin {
             left: Scan {
                 table: Table {
<a href="#h112-1" id="h112-1" class="h">@@ -135,8 +135,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h112-1-3" id="h112-1-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h112-1-5" id="h112-1-5" class="i">+                alias: None,
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h112-2" id="h112-2" class="h">@@ -164,8 +164,8 @@ Plan: Select(
</a>                         },
                     ],
                 },
<a href="#h112-2-3" id="h112-2-3" class="d">-                alias: None,
</a>                 filter: None,
<a href="#h112-2-5" id="h112-2-5" class="i">+                alias: None,
</a>             },
             predicate: None,
             outer: false,
<a href="#h112-3" id="h112-3" class="h">@@ -195,10 +195,84 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h112-3-3" id="h112-3-3" class="d">-)
</a><a href="#h112-3-4" id="h112-3-4" class="i">+    labels: [
</a><a href="#h112-3-5" id="h112-3-5" class="i">+        Some(
</a><a href="#h112-3-6" id="h112-3-6" class="i">+            (
</a><a href="#h112-3-7" id="h112-3-7" class="i">+                Some(
</a><a href="#h112-3-8" id="h112-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-3-9" id="h112-3-9" class="i">+                ),
</a><a href="#h112-3-10" id="h112-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h112-3-11" id="h112-3-11" class="i">+            ),
</a><a href="#h112-3-12" id="h112-3-12" class="i">+        ),
</a><a href="#h112-3-13" id="h112-3-13" class="i">+        Some(
</a><a href="#h112-3-14" id="h112-3-14" class="i">+            (
</a><a href="#h112-3-15" id="h112-3-15" class="i">+                Some(
</a><a href="#h112-3-16" id="h112-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-3-17" id="h112-3-17" class="i">+                ),
</a><a href="#h112-3-18" id="h112-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h112-3-19" id="h112-3-19" class="i">+            ),
</a><a href="#h112-3-20" id="h112-3-20" class="i">+        ),
</a><a href="#h112-3-21" id="h112-3-21" class="i">+        Some(
</a><a href="#h112-3-22" id="h112-3-22" class="i">+            (
</a><a href="#h112-3-23" id="h112-3-23" class="i">+                Some(
</a><a href="#h112-3-24" id="h112-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-3-25" id="h112-3-25" class="i">+                ),
</a><a href="#h112-3-26" id="h112-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h112-3-27" id="h112-3-27" class="i">+            ),
</a><a href="#h112-3-28" id="h112-3-28" class="i">+        ),
</a><a href="#h112-3-29" id="h112-3-29" class="i">+        Some(
</a><a href="#h112-3-30" id="h112-3-30" class="i">+            (
</a><a href="#h112-3-31" id="h112-3-31" class="i">+                Some(
</a><a href="#h112-3-32" id="h112-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-3-33" id="h112-3-33" class="i">+                ),
</a><a href="#h112-3-34" id="h112-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h112-3-35" id="h112-3-35" class="i">+            ),
</a><a href="#h112-3-36" id="h112-3-36" class="i">+        ),
</a><a href="#h112-3-37" id="h112-3-37" class="i">+        Some(
</a><a href="#h112-3-38" id="h112-3-38" class="i">+            (
</a><a href="#h112-3-39" id="h112-3-39" class="i">+                Some(
</a><a href="#h112-3-40" id="h112-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-3-41" id="h112-3-41" class="i">+                ),
</a><a href="#h112-3-42" id="h112-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h112-3-43" id="h112-3-43" class="i">+            ),
</a><a href="#h112-3-44" id="h112-3-44" class="i">+        ),
</a><a href="#h112-3-45" id="h112-3-45" class="i">+        Some(
</a><a href="#h112-3-46" id="h112-3-46" class="i">+            (
</a><a href="#h112-3-47" id="h112-3-47" class="i">+                Some(
</a><a href="#h112-3-48" id="h112-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-3-49" id="h112-3-49" class="i">+                ),
</a><a href="#h112-3-50" id="h112-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h112-3-51" id="h112-3-51" class="i">+            ),
</a><a href="#h112-3-52" id="h112-3-52" class="i">+        ),
</a><a href="#h112-3-53" id="h112-3-53" class="i">+        Some(
</a><a href="#h112-3-54" id="h112-3-54" class="i">+            (
</a><a href="#h112-3-55" id="h112-3-55" class="i">+                Some(
</a><a href="#h112-3-56" id="h112-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-3-57" id="h112-3-57" class="i">+                ),
</a><a href="#h112-3-58" id="h112-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h112-3-59" id="h112-3-59" class="i">+            ),
</a><a href="#h112-3-60" id="h112-3-60" class="i">+        ),
</a><a href="#h112-3-61" id="h112-3-61" class="i">+        Some(
</a><a href="#h112-3-62" id="h112-3-62" class="i">+            (
</a><a href="#h112-3-63" id="h112-3-63" class="i">+                Some(
</a><a href="#h112-3-64" id="h112-3-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h112-3-65" id="h112-3-65" class="i">+                ),
</a><a href="#h112-3-66" id="h112-3-66" class="i">+                &quot;id&quot;,
</a><a href="#h112-3-67" id="h112-3-67" class="i">+            ),
</a><a href="#h112-3-68" id="h112-3-68" class="i">+        ),
</a><a href="#h112-3-69" id="h112-3-69" class="i">+        Some(
</a><a href="#h112-3-70" id="h112-3-70" class="i">+            (
</a><a href="#h112-3-71" id="h112-3-71" class="i">+                Some(
</a><a href="#h112-3-72" id="h112-3-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h112-3-73" id="h112-3-73" class="i">+                ),
</a><a href="#h112-3-74" id="h112-3-74" class="i">+                &quot;name&quot;,
</a><a href="#h112-3-75" id="h112-3-75" class="i">+            ),
</a><a href="#h112-3-76" id="h112-3-76" class="i">+        ),
</a><a href="#h112-3-77" id="h112-3-77" class="i">+    ],
</a><a href="#h112-3-78" id="h112-3-78" class="i">+}
</a> 
<a href="#h112-3-80" id="h112-3-80" class="d">-Optimized plan: Select(
</a><a href="#h112-3-81" id="h112-3-81" class="d">-    HashJoin {
</a><a href="#h112-3-82" id="h112-3-82" class="i">+Optimized plan: Select {
</a><a href="#h112-3-83" id="h112-3-83" class="i">+    root: HashJoin {
</a>         left: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h112-4" id="h112-4" class="h">@@ -277,8 +351,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h112-4-3" id="h112-4-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h112-4-5" id="h112-4-5" class="i">+            alias: None,
</a>         },
         left_field: (
             3,
<a href="#h112-5" id="h112-5" class="h">@@ -316,8 +390,8 @@ Optimized plan: Select(
</a>                     },
                 ],
             },
<a href="#h112-5-3" id="h112-5-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h112-5-5" id="h112-5-5" class="i">+            alias: None,
</a>         },
         right_field: (
             0,
<a href="#h112-6" id="h112-6" class="h">@@ -332,5 +406,79 @@ Optimized plan: Select(
</a>         ),
         outer: false,
     },
<a href="#h112-6-3" id="h112-6-3" class="d">-)
</a><a href="#h112-6-4" id="h112-6-4" class="i">+    labels: [
</a><a href="#h112-6-5" id="h112-6-5" class="i">+        Some(
</a><a href="#h112-6-6" id="h112-6-6" class="i">+            (
</a><a href="#h112-6-7" id="h112-6-7" class="i">+                Some(
</a><a href="#h112-6-8" id="h112-6-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-6-9" id="h112-6-9" class="i">+                ),
</a><a href="#h112-6-10" id="h112-6-10" class="i">+                &quot;id&quot;,
</a><a href="#h112-6-11" id="h112-6-11" class="i">+            ),
</a><a href="#h112-6-12" id="h112-6-12" class="i">+        ),
</a><a href="#h112-6-13" id="h112-6-13" class="i">+        Some(
</a><a href="#h112-6-14" id="h112-6-14" class="i">+            (
</a><a href="#h112-6-15" id="h112-6-15" class="i">+                Some(
</a><a href="#h112-6-16" id="h112-6-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-6-17" id="h112-6-17" class="i">+                ),
</a><a href="#h112-6-18" id="h112-6-18" class="i">+                &quot;title&quot;,
</a><a href="#h112-6-19" id="h112-6-19" class="i">+            ),
</a><a href="#h112-6-20" id="h112-6-20" class="i">+        ),
</a><a href="#h112-6-21" id="h112-6-21" class="i">+        Some(
</a><a href="#h112-6-22" id="h112-6-22" class="i">+            (
</a><a href="#h112-6-23" id="h112-6-23" class="i">+                Some(
</a><a href="#h112-6-24" id="h112-6-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-6-25" id="h112-6-25" class="i">+                ),
</a><a href="#h112-6-26" id="h112-6-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h112-6-27" id="h112-6-27" class="i">+            ),
</a><a href="#h112-6-28" id="h112-6-28" class="i">+        ),
</a><a href="#h112-6-29" id="h112-6-29" class="i">+        Some(
</a><a href="#h112-6-30" id="h112-6-30" class="i">+            (
</a><a href="#h112-6-31" id="h112-6-31" class="i">+                Some(
</a><a href="#h112-6-32" id="h112-6-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-6-33" id="h112-6-33" class="i">+                ),
</a><a href="#h112-6-34" id="h112-6-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h112-6-35" id="h112-6-35" class="i">+            ),
</a><a href="#h112-6-36" id="h112-6-36" class="i">+        ),
</a><a href="#h112-6-37" id="h112-6-37" class="i">+        Some(
</a><a href="#h112-6-38" id="h112-6-38" class="i">+            (
</a><a href="#h112-6-39" id="h112-6-39" class="i">+                Some(
</a><a href="#h112-6-40" id="h112-6-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-6-41" id="h112-6-41" class="i">+                ),
</a><a href="#h112-6-42" id="h112-6-42" class="i">+                &quot;released&quot;,
</a><a href="#h112-6-43" id="h112-6-43" class="i">+            ),
</a><a href="#h112-6-44" id="h112-6-44" class="i">+        ),
</a><a href="#h112-6-45" id="h112-6-45" class="i">+        Some(
</a><a href="#h112-6-46" id="h112-6-46" class="i">+            (
</a><a href="#h112-6-47" id="h112-6-47" class="i">+                Some(
</a><a href="#h112-6-48" id="h112-6-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-6-49" id="h112-6-49" class="i">+                ),
</a><a href="#h112-6-50" id="h112-6-50" class="i">+                &quot;rating&quot;,
</a><a href="#h112-6-51" id="h112-6-51" class="i">+            ),
</a><a href="#h112-6-52" id="h112-6-52" class="i">+        ),
</a><a href="#h112-6-53" id="h112-6-53" class="i">+        Some(
</a><a href="#h112-6-54" id="h112-6-54" class="i">+            (
</a><a href="#h112-6-55" id="h112-6-55" class="i">+                Some(
</a><a href="#h112-6-56" id="h112-6-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h112-6-57" id="h112-6-57" class="i">+                ),
</a><a href="#h112-6-58" id="h112-6-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h112-6-59" id="h112-6-59" class="i">+            ),
</a><a href="#h112-6-60" id="h112-6-60" class="i">+        ),
</a><a href="#h112-6-61" id="h112-6-61" class="i">+        Some(
</a><a href="#h112-6-62" id="h112-6-62" class="i">+            (
</a><a href="#h112-6-63" id="h112-6-63" class="i">+                Some(
</a><a href="#h112-6-64" id="h112-6-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h112-6-65" id="h112-6-65" class="i">+                ),
</a><a href="#h112-6-66" id="h112-6-66" class="i">+                &quot;id&quot;,
</a><a href="#h112-6-67" id="h112-6-67" class="i">+            ),
</a><a href="#h112-6-68" id="h112-6-68" class="i">+        ),
</a><a href="#h112-6-69" id="h112-6-69" class="i">+        Some(
</a><a href="#h112-6-70" id="h112-6-70" class="i">+            (
</a><a href="#h112-6-71" id="h112-6-71" class="i">+                Some(
</a><a href="#h112-6-72" id="h112-6-72" class="i">+                    &quot;genres&quot;,
</a><a href="#h112-6-73" id="h112-6-73" class="i">+                ),
</a><a href="#h112-6-74" id="h112-6-74" class="i">+                &quot;name&quot;,
</a><a href="#h112-6-75" id="h112-6-75" class="i">+            ),
</a><a href="#h112-6-76" id="h112-6-76" class="i">+        ),
</a><a href="#h112-6-77" id="h112-6-77" class="i">+    ],
</a><a href="#h112-6-78" id="h112-6-78" class="i">+}
</a> 
<b>diff --git a/<a id="h113" href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a> b/<a href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a></b>
<a href="#h113-0" id="h113-0" class="h">@@ -25,8 +25,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h113-0-3" id="h113-0-3" class="d">-Plan: Select(
</a><a href="#h113-0-4" id="h113-0-4" class="d">-    Filter {
</a><a href="#h113-0-5" id="h113-0-5" class="i">+Plan: Select {
</a><a href="#h113-0-6" id="h113-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h113-1" id="h113-1" class="h">@@ -105,17 +105,75 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h113-1-3" id="h113-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h113-1-5" id="h113-1-5" class="i">+            alias: None,
</a>         },
         predicate: Constant(
             Null,
         ),
     },
<a href="#h113-1-11" id="h113-1-11" class="d">-)
</a><a href="#h113-1-12" id="h113-1-12" class="i">+    labels: [
</a><a href="#h113-1-13" id="h113-1-13" class="i">+        Some(
</a><a href="#h113-1-14" id="h113-1-14" class="i">+            (
</a><a href="#h113-1-15" id="h113-1-15" class="i">+                Some(
</a><a href="#h113-1-16" id="h113-1-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-1-17" id="h113-1-17" class="i">+                ),
</a><a href="#h113-1-18" id="h113-1-18" class="i">+                &quot;id&quot;,
</a><a href="#h113-1-19" id="h113-1-19" class="i">+            ),
</a><a href="#h113-1-20" id="h113-1-20" class="i">+        ),
</a><a href="#h113-1-21" id="h113-1-21" class="i">+        Some(
</a><a href="#h113-1-22" id="h113-1-22" class="i">+            (
</a><a href="#h113-1-23" id="h113-1-23" class="i">+                Some(
</a><a href="#h113-1-24" id="h113-1-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-1-25" id="h113-1-25" class="i">+                ),
</a><a href="#h113-1-26" id="h113-1-26" class="i">+                &quot;title&quot;,
</a><a href="#h113-1-27" id="h113-1-27" class="i">+            ),
</a><a href="#h113-1-28" id="h113-1-28" class="i">+        ),
</a><a href="#h113-1-29" id="h113-1-29" class="i">+        Some(
</a><a href="#h113-1-30" id="h113-1-30" class="i">+            (
</a><a href="#h113-1-31" id="h113-1-31" class="i">+                Some(
</a><a href="#h113-1-32" id="h113-1-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-1-33" id="h113-1-33" class="i">+                ),
</a><a href="#h113-1-34" id="h113-1-34" class="i">+                &quot;studio_id&quot;,
</a><a href="#h113-1-35" id="h113-1-35" class="i">+            ),
</a><a href="#h113-1-36" id="h113-1-36" class="i">+        ),
</a><a href="#h113-1-37" id="h113-1-37" class="i">+        Some(
</a><a href="#h113-1-38" id="h113-1-38" class="i">+            (
</a><a href="#h113-1-39" id="h113-1-39" class="i">+                Some(
</a><a href="#h113-1-40" id="h113-1-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-1-41" id="h113-1-41" class="i">+                ),
</a><a href="#h113-1-42" id="h113-1-42" class="i">+                &quot;genre_id&quot;,
</a><a href="#h113-1-43" id="h113-1-43" class="i">+            ),
</a><a href="#h113-1-44" id="h113-1-44" class="i">+        ),
</a><a href="#h113-1-45" id="h113-1-45" class="i">+        Some(
</a><a href="#h113-1-46" id="h113-1-46" class="i">+            (
</a><a href="#h113-1-47" id="h113-1-47" class="i">+                Some(
</a><a href="#h113-1-48" id="h113-1-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-1-49" id="h113-1-49" class="i">+                ),
</a><a href="#h113-1-50" id="h113-1-50" class="i">+                &quot;released&quot;,
</a><a href="#h113-1-51" id="h113-1-51" class="i">+            ),
</a><a href="#h113-1-52" id="h113-1-52" class="i">+        ),
</a><a href="#h113-1-53" id="h113-1-53" class="i">+        Some(
</a><a href="#h113-1-54" id="h113-1-54" class="i">+            (
</a><a href="#h113-1-55" id="h113-1-55" class="i">+                Some(
</a><a href="#h113-1-56" id="h113-1-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-1-57" id="h113-1-57" class="i">+                ),
</a><a href="#h113-1-58" id="h113-1-58" class="i">+                &quot;rating&quot;,
</a><a href="#h113-1-59" id="h113-1-59" class="i">+            ),
</a><a href="#h113-1-60" id="h113-1-60" class="i">+        ),
</a><a href="#h113-1-61" id="h113-1-61" class="i">+        Some(
</a><a href="#h113-1-62" id="h113-1-62" class="i">+            (
</a><a href="#h113-1-63" id="h113-1-63" class="i">+                Some(
</a><a href="#h113-1-64" id="h113-1-64" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-1-65" id="h113-1-65" class="i">+                ),
</a><a href="#h113-1-66" id="h113-1-66" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h113-1-67" id="h113-1-67" class="i">+            ),
</a><a href="#h113-1-68" id="h113-1-68" class="i">+        ),
</a><a href="#h113-1-69" id="h113-1-69" class="i">+    ],
</a><a href="#h113-1-70" id="h113-1-70" class="i">+}
</a> 
<a href="#h113-1-72" id="h113-1-72" class="d">-Optimized plan: Select(
</a><a href="#h113-1-73" id="h113-1-73" class="d">-    Scan {
</a><a href="#h113-1-74" id="h113-1-74" class="i">+Optimized plan: Select {
</a><a href="#h113-1-75" id="h113-1-75" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h113-2" id="h113-2" class="h">@@ -193,12 +251,70 @@ Optimized plan: Select(
</a>                 },
             ],
         },
<a href="#h113-2-3" id="h113-2-3" class="d">-        alias: None,
</a>         filter: Some(
             Constant(
                 Null,
             ),
         ),
<a href="#h113-2-9" id="h113-2-9" class="i">+        alias: None,
</a>     },
<a href="#h113-2-11" id="h113-2-11" class="d">-)
</a><a href="#h113-2-12" id="h113-2-12" class="i">+    labels: [
</a><a href="#h113-2-13" id="h113-2-13" class="i">+        Some(
</a><a href="#h113-2-14" id="h113-2-14" class="i">+            (
</a><a href="#h113-2-15" id="h113-2-15" class="i">+                Some(
</a><a href="#h113-2-16" id="h113-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-2-17" id="h113-2-17" class="i">+                ),
</a><a href="#h113-2-18" id="h113-2-18" class="i">+                &quot;id&quot;,
</a><a href="#h113-2-19" id="h113-2-19" class="i">+            ),
</a><a href="#h113-2-20" id="h113-2-20" class="i">+        ),
</a><a href="#h113-2-21" id="h113-2-21" class="i">+        Some(
</a><a href="#h113-2-22" id="h113-2-22" class="i">+            (
</a><a href="#h113-2-23" id="h113-2-23" class="i">+                Some(
</a><a href="#h113-2-24" id="h113-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-2-25" id="h113-2-25" class="i">+                ),
</a><a href="#h113-2-26" id="h113-2-26" class="i">+                &quot;title&quot;,
</a><a href="#h113-2-27" id="h113-2-27" class="i">+            ),
</a><a href="#h113-2-28" id="h113-2-28" class="i">+        ),
</a><a href="#h113-2-29" id="h113-2-29" class="i">+        Some(
</a><a href="#h113-2-30" id="h113-2-30" class="i">+            (
</a><a href="#h113-2-31" id="h113-2-31" class="i">+                Some(
</a><a href="#h113-2-32" id="h113-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-2-33" id="h113-2-33" class="i">+                ),
</a><a href="#h113-2-34" id="h113-2-34" class="i">+                &quot;studio_id&quot;,
</a><a href="#h113-2-35" id="h113-2-35" class="i">+            ),
</a><a href="#h113-2-36" id="h113-2-36" class="i">+        ),
</a><a href="#h113-2-37" id="h113-2-37" class="i">+        Some(
</a><a href="#h113-2-38" id="h113-2-38" class="i">+            (
</a><a href="#h113-2-39" id="h113-2-39" class="i">+                Some(
</a><a href="#h113-2-40" id="h113-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-2-41" id="h113-2-41" class="i">+                ),
</a><a href="#h113-2-42" id="h113-2-42" class="i">+                &quot;genre_id&quot;,
</a><a href="#h113-2-43" id="h113-2-43" class="i">+            ),
</a><a href="#h113-2-44" id="h113-2-44" class="i">+        ),
</a><a href="#h113-2-45" id="h113-2-45" class="i">+        Some(
</a><a href="#h113-2-46" id="h113-2-46" class="i">+            (
</a><a href="#h113-2-47" id="h113-2-47" class="i">+                Some(
</a><a href="#h113-2-48" id="h113-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-2-49" id="h113-2-49" class="i">+                ),
</a><a href="#h113-2-50" id="h113-2-50" class="i">+                &quot;released&quot;,
</a><a href="#h113-2-51" id="h113-2-51" class="i">+            ),
</a><a href="#h113-2-52" id="h113-2-52" class="i">+        ),
</a><a href="#h113-2-53" id="h113-2-53" class="i">+        Some(
</a><a href="#h113-2-54" id="h113-2-54" class="i">+            (
</a><a href="#h113-2-55" id="h113-2-55" class="i">+                Some(
</a><a href="#h113-2-56" id="h113-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-2-57" id="h113-2-57" class="i">+                ),
</a><a href="#h113-2-58" id="h113-2-58" class="i">+                &quot;rating&quot;,
</a><a href="#h113-2-59" id="h113-2-59" class="i">+            ),
</a><a href="#h113-2-60" id="h113-2-60" class="i">+        ),
</a><a href="#h113-2-61" id="h113-2-61" class="i">+        Some(
</a><a href="#h113-2-62" id="h113-2-62" class="i">+            (
</a><a href="#h113-2-63" id="h113-2-63" class="i">+                Some(
</a><a href="#h113-2-64" id="h113-2-64" class="i">+                    &quot;movies&quot;,
</a><a href="#h113-2-65" id="h113-2-65" class="i">+                ),
</a><a href="#h113-2-66" id="h113-2-66" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h113-2-67" id="h113-2-67" class="i">+            ),
</a><a href="#h113-2-68" id="h113-2-68" class="i">+        ),
</a><a href="#h113-2-69" id="h113-2-69" class="i">+    ],
</a><a href="#h113-2-70" id="h113-2-70" class="i">+}
</a> 
<b>diff --git a/<a id="h114" href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a> b/<a href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a></b>
<a href="#h114-0" id="h114-0" class="h">@@ -36,8 +36,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h114-0-3" id="h114-0-3" class="d">-Plan: Select(
</a><a href="#h114-0-4" id="h114-0-4" class="d">-    Filter {
</a><a href="#h114-0-5" id="h114-0-5" class="i">+Plan: Select {
</a><a href="#h114-0-6" id="h114-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h114-1" id="h114-1" class="h">@@ -116,8 +116,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h114-1-3" id="h114-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h114-1-5" id="h114-1-5" class="i">+            alias: None,
</a>         },
         predicate: Equal(
             Field(
<a href="#h114-2" id="h114-2" class="h">@@ -136,10 +136,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h114-2-3" id="h114-2-3" class="d">-)
</a><a href="#h114-2-4" id="h114-2-4" class="i">+    labels: [
</a><a href="#h114-2-5" id="h114-2-5" class="i">+        Some(
</a><a href="#h114-2-6" id="h114-2-6" class="i">+            (
</a><a href="#h114-2-7" id="h114-2-7" class="i">+                Some(
</a><a href="#h114-2-8" id="h114-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-2-9" id="h114-2-9" class="i">+                ),
</a><a href="#h114-2-10" id="h114-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h114-2-11" id="h114-2-11" class="i">+            ),
</a><a href="#h114-2-12" id="h114-2-12" class="i">+        ),
</a><a href="#h114-2-13" id="h114-2-13" class="i">+        Some(
</a><a href="#h114-2-14" id="h114-2-14" class="i">+            (
</a><a href="#h114-2-15" id="h114-2-15" class="i">+                Some(
</a><a href="#h114-2-16" id="h114-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-2-17" id="h114-2-17" class="i">+                ),
</a><a href="#h114-2-18" id="h114-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h114-2-19" id="h114-2-19" class="i">+            ),
</a><a href="#h114-2-20" id="h114-2-20" class="i">+        ),
</a><a href="#h114-2-21" id="h114-2-21" class="i">+        Some(
</a><a href="#h114-2-22" id="h114-2-22" class="i">+            (
</a><a href="#h114-2-23" id="h114-2-23" class="i">+                Some(
</a><a href="#h114-2-24" id="h114-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-2-25" id="h114-2-25" class="i">+                ),
</a><a href="#h114-2-26" id="h114-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h114-2-27" id="h114-2-27" class="i">+            ),
</a><a href="#h114-2-28" id="h114-2-28" class="i">+        ),
</a><a href="#h114-2-29" id="h114-2-29" class="i">+        Some(
</a><a href="#h114-2-30" id="h114-2-30" class="i">+            (
</a><a href="#h114-2-31" id="h114-2-31" class="i">+                Some(
</a><a href="#h114-2-32" id="h114-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-2-33" id="h114-2-33" class="i">+                ),
</a><a href="#h114-2-34" id="h114-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h114-2-35" id="h114-2-35" class="i">+            ),
</a><a href="#h114-2-36" id="h114-2-36" class="i">+        ),
</a><a href="#h114-2-37" id="h114-2-37" class="i">+        Some(
</a><a href="#h114-2-38" id="h114-2-38" class="i">+            (
</a><a href="#h114-2-39" id="h114-2-39" class="i">+                Some(
</a><a href="#h114-2-40" id="h114-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-2-41" id="h114-2-41" class="i">+                ),
</a><a href="#h114-2-42" id="h114-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h114-2-43" id="h114-2-43" class="i">+            ),
</a><a href="#h114-2-44" id="h114-2-44" class="i">+        ),
</a><a href="#h114-2-45" id="h114-2-45" class="i">+        Some(
</a><a href="#h114-2-46" id="h114-2-46" class="i">+            (
</a><a href="#h114-2-47" id="h114-2-47" class="i">+                Some(
</a><a href="#h114-2-48" id="h114-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-2-49" id="h114-2-49" class="i">+                ),
</a><a href="#h114-2-50" id="h114-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h114-2-51" id="h114-2-51" class="i">+            ),
</a><a href="#h114-2-52" id="h114-2-52" class="i">+        ),
</a><a href="#h114-2-53" id="h114-2-53" class="i">+        Some(
</a><a href="#h114-2-54" id="h114-2-54" class="i">+            (
</a><a href="#h114-2-55" id="h114-2-55" class="i">+                Some(
</a><a href="#h114-2-56" id="h114-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-2-57" id="h114-2-57" class="i">+                ),
</a><a href="#h114-2-58" id="h114-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h114-2-59" id="h114-2-59" class="i">+            ),
</a><a href="#h114-2-60" id="h114-2-60" class="i">+        ),
</a><a href="#h114-2-61" id="h114-2-61" class="i">+    ],
</a><a href="#h114-2-62" id="h114-2-62" class="i">+}
</a> 
<a href="#h114-2-64" id="h114-2-64" class="d">-Optimized plan: Select(
</a><a href="#h114-2-65" id="h114-2-65" class="d">-    KeyLookup {
</a><a href="#h114-2-66" id="h114-2-66" class="i">+Optimized plan: Select {
</a><a href="#h114-2-67" id="h114-2-67" class="i">+    root: KeyLookup {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h114-3" id="h114-3" class="h">@@ -224,5 +282,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h114-3-3" id="h114-3-3" class="d">-)
</a><a href="#h114-3-4" id="h114-3-4" class="i">+    labels: [
</a><a href="#h114-3-5" id="h114-3-5" class="i">+        Some(
</a><a href="#h114-3-6" id="h114-3-6" class="i">+            (
</a><a href="#h114-3-7" id="h114-3-7" class="i">+                Some(
</a><a href="#h114-3-8" id="h114-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-3-9" id="h114-3-9" class="i">+                ),
</a><a href="#h114-3-10" id="h114-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h114-3-11" id="h114-3-11" class="i">+            ),
</a><a href="#h114-3-12" id="h114-3-12" class="i">+        ),
</a><a href="#h114-3-13" id="h114-3-13" class="i">+        Some(
</a><a href="#h114-3-14" id="h114-3-14" class="i">+            (
</a><a href="#h114-3-15" id="h114-3-15" class="i">+                Some(
</a><a href="#h114-3-16" id="h114-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-3-17" id="h114-3-17" class="i">+                ),
</a><a href="#h114-3-18" id="h114-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h114-3-19" id="h114-3-19" class="i">+            ),
</a><a href="#h114-3-20" id="h114-3-20" class="i">+        ),
</a><a href="#h114-3-21" id="h114-3-21" class="i">+        Some(
</a><a href="#h114-3-22" id="h114-3-22" class="i">+            (
</a><a href="#h114-3-23" id="h114-3-23" class="i">+                Some(
</a><a href="#h114-3-24" id="h114-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-3-25" id="h114-3-25" class="i">+                ),
</a><a href="#h114-3-26" id="h114-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h114-3-27" id="h114-3-27" class="i">+            ),
</a><a href="#h114-3-28" id="h114-3-28" class="i">+        ),
</a><a href="#h114-3-29" id="h114-3-29" class="i">+        Some(
</a><a href="#h114-3-30" id="h114-3-30" class="i">+            (
</a><a href="#h114-3-31" id="h114-3-31" class="i">+                Some(
</a><a href="#h114-3-32" id="h114-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-3-33" id="h114-3-33" class="i">+                ),
</a><a href="#h114-3-34" id="h114-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h114-3-35" id="h114-3-35" class="i">+            ),
</a><a href="#h114-3-36" id="h114-3-36" class="i">+        ),
</a><a href="#h114-3-37" id="h114-3-37" class="i">+        Some(
</a><a href="#h114-3-38" id="h114-3-38" class="i">+            (
</a><a href="#h114-3-39" id="h114-3-39" class="i">+                Some(
</a><a href="#h114-3-40" id="h114-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-3-41" id="h114-3-41" class="i">+                ),
</a><a href="#h114-3-42" id="h114-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h114-3-43" id="h114-3-43" class="i">+            ),
</a><a href="#h114-3-44" id="h114-3-44" class="i">+        ),
</a><a href="#h114-3-45" id="h114-3-45" class="i">+        Some(
</a><a href="#h114-3-46" id="h114-3-46" class="i">+            (
</a><a href="#h114-3-47" id="h114-3-47" class="i">+                Some(
</a><a href="#h114-3-48" id="h114-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-3-49" id="h114-3-49" class="i">+                ),
</a><a href="#h114-3-50" id="h114-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h114-3-51" id="h114-3-51" class="i">+            ),
</a><a href="#h114-3-52" id="h114-3-52" class="i">+        ),
</a><a href="#h114-3-53" id="h114-3-53" class="i">+        Some(
</a><a href="#h114-3-54" id="h114-3-54" class="i">+            (
</a><a href="#h114-3-55" id="h114-3-55" class="i">+                Some(
</a><a href="#h114-3-56" id="h114-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h114-3-57" id="h114-3-57" class="i">+                ),
</a><a href="#h114-3-58" id="h114-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h114-3-59" id="h114-3-59" class="i">+            ),
</a><a href="#h114-3-60" id="h114-3-60" class="i">+        ),
</a><a href="#h114-3-61" id="h114-3-61" class="i">+    ],
</a><a href="#h114-3-62" id="h114-3-62" class="i">+}
</a> 
<b>diff --git a/<a id="h115" href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a> b/<a href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a></b>
<a href="#h115-0" id="h115-0" class="h">@@ -72,8 +72,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h115-0-3" id="h115-0-3" class="d">-Plan: Select(
</a><a href="#h115-0-4" id="h115-0-4" class="d">-    Filter {
</a><a href="#h115-0-5" id="h115-0-5" class="i">+Plan: Select {
</a><a href="#h115-0-6" id="h115-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h115-1" id="h115-1" class="h">@@ -152,8 +152,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h115-1-3" id="h115-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h115-1-5" id="h115-1-5" class="i">+            alias: None,
</a>         },
         predicate: Or(
             Or(
<a href="#h115-2" id="h115-2" class="h">@@ -208,10 +208,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h115-2-3" id="h115-2-3" class="d">-)
</a><a href="#h115-2-4" id="h115-2-4" class="i">+    labels: [
</a><a href="#h115-2-5" id="h115-2-5" class="i">+        Some(
</a><a href="#h115-2-6" id="h115-2-6" class="i">+            (
</a><a href="#h115-2-7" id="h115-2-7" class="i">+                Some(
</a><a href="#h115-2-8" id="h115-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-2-9" id="h115-2-9" class="i">+                ),
</a><a href="#h115-2-10" id="h115-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h115-2-11" id="h115-2-11" class="i">+            ),
</a><a href="#h115-2-12" id="h115-2-12" class="i">+        ),
</a><a href="#h115-2-13" id="h115-2-13" class="i">+        Some(
</a><a href="#h115-2-14" id="h115-2-14" class="i">+            (
</a><a href="#h115-2-15" id="h115-2-15" class="i">+                Some(
</a><a href="#h115-2-16" id="h115-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-2-17" id="h115-2-17" class="i">+                ),
</a><a href="#h115-2-18" id="h115-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h115-2-19" id="h115-2-19" class="i">+            ),
</a><a href="#h115-2-20" id="h115-2-20" class="i">+        ),
</a><a href="#h115-2-21" id="h115-2-21" class="i">+        Some(
</a><a href="#h115-2-22" id="h115-2-22" class="i">+            (
</a><a href="#h115-2-23" id="h115-2-23" class="i">+                Some(
</a><a href="#h115-2-24" id="h115-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-2-25" id="h115-2-25" class="i">+                ),
</a><a href="#h115-2-26" id="h115-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h115-2-27" id="h115-2-27" class="i">+            ),
</a><a href="#h115-2-28" id="h115-2-28" class="i">+        ),
</a><a href="#h115-2-29" id="h115-2-29" class="i">+        Some(
</a><a href="#h115-2-30" id="h115-2-30" class="i">+            (
</a><a href="#h115-2-31" id="h115-2-31" class="i">+                Some(
</a><a href="#h115-2-32" id="h115-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-2-33" id="h115-2-33" class="i">+                ),
</a><a href="#h115-2-34" id="h115-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h115-2-35" id="h115-2-35" class="i">+            ),
</a><a href="#h115-2-36" id="h115-2-36" class="i">+        ),
</a><a href="#h115-2-37" id="h115-2-37" class="i">+        Some(
</a><a href="#h115-2-38" id="h115-2-38" class="i">+            (
</a><a href="#h115-2-39" id="h115-2-39" class="i">+                Some(
</a><a href="#h115-2-40" id="h115-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-2-41" id="h115-2-41" class="i">+                ),
</a><a href="#h115-2-42" id="h115-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h115-2-43" id="h115-2-43" class="i">+            ),
</a><a href="#h115-2-44" id="h115-2-44" class="i">+        ),
</a><a href="#h115-2-45" id="h115-2-45" class="i">+        Some(
</a><a href="#h115-2-46" id="h115-2-46" class="i">+            (
</a><a href="#h115-2-47" id="h115-2-47" class="i">+                Some(
</a><a href="#h115-2-48" id="h115-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-2-49" id="h115-2-49" class="i">+                ),
</a><a href="#h115-2-50" id="h115-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h115-2-51" id="h115-2-51" class="i">+            ),
</a><a href="#h115-2-52" id="h115-2-52" class="i">+        ),
</a><a href="#h115-2-53" id="h115-2-53" class="i">+        Some(
</a><a href="#h115-2-54" id="h115-2-54" class="i">+            (
</a><a href="#h115-2-55" id="h115-2-55" class="i">+                Some(
</a><a href="#h115-2-56" id="h115-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-2-57" id="h115-2-57" class="i">+                ),
</a><a href="#h115-2-58" id="h115-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h115-2-59" id="h115-2-59" class="i">+            ),
</a><a href="#h115-2-60" id="h115-2-60" class="i">+        ),
</a><a href="#h115-2-61" id="h115-2-61" class="i">+    ],
</a><a href="#h115-2-62" id="h115-2-62" class="i">+}
</a> 
<a href="#h115-2-64" id="h115-2-64" class="d">-Optimized plan: Select(
</a><a href="#h115-2-65" id="h115-2-65" class="d">-    KeyLookup {
</a><a href="#h115-2-66" id="h115-2-66" class="i">+Optimized plan: Select {
</a><a href="#h115-2-67" id="h115-2-67" class="i">+    root: KeyLookup {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h115-3" id="h115-3" class="h">@@ -302,5 +360,63 @@ Optimized plan: Select(
</a>             ),
         ],
     },
<a href="#h115-3-3" id="h115-3-3" class="d">-)
</a><a href="#h115-3-4" id="h115-3-4" class="i">+    labels: [
</a><a href="#h115-3-5" id="h115-3-5" class="i">+        Some(
</a><a href="#h115-3-6" id="h115-3-6" class="i">+            (
</a><a href="#h115-3-7" id="h115-3-7" class="i">+                Some(
</a><a href="#h115-3-8" id="h115-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-3-9" id="h115-3-9" class="i">+                ),
</a><a href="#h115-3-10" id="h115-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h115-3-11" id="h115-3-11" class="i">+            ),
</a><a href="#h115-3-12" id="h115-3-12" class="i">+        ),
</a><a href="#h115-3-13" id="h115-3-13" class="i">+        Some(
</a><a href="#h115-3-14" id="h115-3-14" class="i">+            (
</a><a href="#h115-3-15" id="h115-3-15" class="i">+                Some(
</a><a href="#h115-3-16" id="h115-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-3-17" id="h115-3-17" class="i">+                ),
</a><a href="#h115-3-18" id="h115-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h115-3-19" id="h115-3-19" class="i">+            ),
</a><a href="#h115-3-20" id="h115-3-20" class="i">+        ),
</a><a href="#h115-3-21" id="h115-3-21" class="i">+        Some(
</a><a href="#h115-3-22" id="h115-3-22" class="i">+            (
</a><a href="#h115-3-23" id="h115-3-23" class="i">+                Some(
</a><a href="#h115-3-24" id="h115-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-3-25" id="h115-3-25" class="i">+                ),
</a><a href="#h115-3-26" id="h115-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h115-3-27" id="h115-3-27" class="i">+            ),
</a><a href="#h115-3-28" id="h115-3-28" class="i">+        ),
</a><a href="#h115-3-29" id="h115-3-29" class="i">+        Some(
</a><a href="#h115-3-30" id="h115-3-30" class="i">+            (
</a><a href="#h115-3-31" id="h115-3-31" class="i">+                Some(
</a><a href="#h115-3-32" id="h115-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-3-33" id="h115-3-33" class="i">+                ),
</a><a href="#h115-3-34" id="h115-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h115-3-35" id="h115-3-35" class="i">+            ),
</a><a href="#h115-3-36" id="h115-3-36" class="i">+        ),
</a><a href="#h115-3-37" id="h115-3-37" class="i">+        Some(
</a><a href="#h115-3-38" id="h115-3-38" class="i">+            (
</a><a href="#h115-3-39" id="h115-3-39" class="i">+                Some(
</a><a href="#h115-3-40" id="h115-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-3-41" id="h115-3-41" class="i">+                ),
</a><a href="#h115-3-42" id="h115-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h115-3-43" id="h115-3-43" class="i">+            ),
</a><a href="#h115-3-44" id="h115-3-44" class="i">+        ),
</a><a href="#h115-3-45" id="h115-3-45" class="i">+        Some(
</a><a href="#h115-3-46" id="h115-3-46" class="i">+            (
</a><a href="#h115-3-47" id="h115-3-47" class="i">+                Some(
</a><a href="#h115-3-48" id="h115-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-3-49" id="h115-3-49" class="i">+                ),
</a><a href="#h115-3-50" id="h115-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h115-3-51" id="h115-3-51" class="i">+            ),
</a><a href="#h115-3-52" id="h115-3-52" class="i">+        ),
</a><a href="#h115-3-53" id="h115-3-53" class="i">+        Some(
</a><a href="#h115-3-54" id="h115-3-54" class="i">+            (
</a><a href="#h115-3-55" id="h115-3-55" class="i">+                Some(
</a><a href="#h115-3-56" id="h115-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h115-3-57" id="h115-3-57" class="i">+                ),
</a><a href="#h115-3-58" id="h115-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h115-3-59" id="h115-3-59" class="i">+            ),
</a><a href="#h115-3-60" id="h115-3-60" class="i">+        ),
</a><a href="#h115-3-61" id="h115-3-61" class="i">+    ],
</a><a href="#h115-3-62" id="h115-3-62" class="i">+}
</a> 
<b>diff --git a/<a id="h116" href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a> b/<a href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a></b>
<a href="#h116-0" id="h116-0" class="h">@@ -106,8 +106,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h116-0-3" id="h116-0-3" class="d">-Plan: Select(
</a><a href="#h116-0-4" id="h116-0-4" class="d">-    Filter {
</a><a href="#h116-0-5" id="h116-0-5" class="i">+Plan: Select {
</a><a href="#h116-0-6" id="h116-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h116-1" id="h116-1" class="h">@@ -186,8 +186,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h116-1-3" id="h116-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h116-1-5" id="h116-1-5" class="i">+            alias: None,
</a>         },
         predicate: And(
             Or(
<a href="#h116-2" id="h116-2" class="h">@@ -278,10 +278,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h116-2-3" id="h116-2-3" class="d">-)
</a><a href="#h116-2-4" id="h116-2-4" class="i">+    labels: [
</a><a href="#h116-2-5" id="h116-2-5" class="i">+        Some(
</a><a href="#h116-2-6" id="h116-2-6" class="i">+            (
</a><a href="#h116-2-7" id="h116-2-7" class="i">+                Some(
</a><a href="#h116-2-8" id="h116-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-2-9" id="h116-2-9" class="i">+                ),
</a><a href="#h116-2-10" id="h116-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h116-2-11" id="h116-2-11" class="i">+            ),
</a><a href="#h116-2-12" id="h116-2-12" class="i">+        ),
</a><a href="#h116-2-13" id="h116-2-13" class="i">+        Some(
</a><a href="#h116-2-14" id="h116-2-14" class="i">+            (
</a><a href="#h116-2-15" id="h116-2-15" class="i">+                Some(
</a><a href="#h116-2-16" id="h116-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-2-17" id="h116-2-17" class="i">+                ),
</a><a href="#h116-2-18" id="h116-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h116-2-19" id="h116-2-19" class="i">+            ),
</a><a href="#h116-2-20" id="h116-2-20" class="i">+        ),
</a><a href="#h116-2-21" id="h116-2-21" class="i">+        Some(
</a><a href="#h116-2-22" id="h116-2-22" class="i">+            (
</a><a href="#h116-2-23" id="h116-2-23" class="i">+                Some(
</a><a href="#h116-2-24" id="h116-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-2-25" id="h116-2-25" class="i">+                ),
</a><a href="#h116-2-26" id="h116-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h116-2-27" id="h116-2-27" class="i">+            ),
</a><a href="#h116-2-28" id="h116-2-28" class="i">+        ),
</a><a href="#h116-2-29" id="h116-2-29" class="i">+        Some(
</a><a href="#h116-2-30" id="h116-2-30" class="i">+            (
</a><a href="#h116-2-31" id="h116-2-31" class="i">+                Some(
</a><a href="#h116-2-32" id="h116-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-2-33" id="h116-2-33" class="i">+                ),
</a><a href="#h116-2-34" id="h116-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h116-2-35" id="h116-2-35" class="i">+            ),
</a><a href="#h116-2-36" id="h116-2-36" class="i">+        ),
</a><a href="#h116-2-37" id="h116-2-37" class="i">+        Some(
</a><a href="#h116-2-38" id="h116-2-38" class="i">+            (
</a><a href="#h116-2-39" id="h116-2-39" class="i">+                Some(
</a><a href="#h116-2-40" id="h116-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-2-41" id="h116-2-41" class="i">+                ),
</a><a href="#h116-2-42" id="h116-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h116-2-43" id="h116-2-43" class="i">+            ),
</a><a href="#h116-2-44" id="h116-2-44" class="i">+        ),
</a><a href="#h116-2-45" id="h116-2-45" class="i">+        Some(
</a><a href="#h116-2-46" id="h116-2-46" class="i">+            (
</a><a href="#h116-2-47" id="h116-2-47" class="i">+                Some(
</a><a href="#h116-2-48" id="h116-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-2-49" id="h116-2-49" class="i">+                ),
</a><a href="#h116-2-50" id="h116-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h116-2-51" id="h116-2-51" class="i">+            ),
</a><a href="#h116-2-52" id="h116-2-52" class="i">+        ),
</a><a href="#h116-2-53" id="h116-2-53" class="i">+        Some(
</a><a href="#h116-2-54" id="h116-2-54" class="i">+            (
</a><a href="#h116-2-55" id="h116-2-55" class="i">+                Some(
</a><a href="#h116-2-56" id="h116-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-2-57" id="h116-2-57" class="i">+                ),
</a><a href="#h116-2-58" id="h116-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h116-2-59" id="h116-2-59" class="i">+            ),
</a><a href="#h116-2-60" id="h116-2-60" class="i">+        ),
</a><a href="#h116-2-61" id="h116-2-61" class="i">+    ],
</a><a href="#h116-2-62" id="h116-2-62" class="i">+}
</a> 
<a href="#h116-2-64" id="h116-2-64" class="d">-Optimized plan: Select(
</a><a href="#h116-2-65" id="h116-2-65" class="d">-    Filter {
</a><a href="#h116-2-66" id="h116-2-66" class="i">+Optimized plan: Select {
</a><a href="#h116-2-67" id="h116-2-67" class="i">+    root: Filter {
</a>         source: KeyLookup {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h116-3" id="h116-3" class="h">@@ -393,5 +451,63 @@ Optimized plan: Select(
</a>             ),
         ),
     },
<a href="#h116-3-3" id="h116-3-3" class="d">-)
</a><a href="#h116-3-4" id="h116-3-4" class="i">+    labels: [
</a><a href="#h116-3-5" id="h116-3-5" class="i">+        Some(
</a><a href="#h116-3-6" id="h116-3-6" class="i">+            (
</a><a href="#h116-3-7" id="h116-3-7" class="i">+                Some(
</a><a href="#h116-3-8" id="h116-3-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-3-9" id="h116-3-9" class="i">+                ),
</a><a href="#h116-3-10" id="h116-3-10" class="i">+                &quot;id&quot;,
</a><a href="#h116-3-11" id="h116-3-11" class="i">+            ),
</a><a href="#h116-3-12" id="h116-3-12" class="i">+        ),
</a><a href="#h116-3-13" id="h116-3-13" class="i">+        Some(
</a><a href="#h116-3-14" id="h116-3-14" class="i">+            (
</a><a href="#h116-3-15" id="h116-3-15" class="i">+                Some(
</a><a href="#h116-3-16" id="h116-3-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-3-17" id="h116-3-17" class="i">+                ),
</a><a href="#h116-3-18" id="h116-3-18" class="i">+                &quot;title&quot;,
</a><a href="#h116-3-19" id="h116-3-19" class="i">+            ),
</a><a href="#h116-3-20" id="h116-3-20" class="i">+        ),
</a><a href="#h116-3-21" id="h116-3-21" class="i">+        Some(
</a><a href="#h116-3-22" id="h116-3-22" class="i">+            (
</a><a href="#h116-3-23" id="h116-3-23" class="i">+                Some(
</a><a href="#h116-3-24" id="h116-3-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-3-25" id="h116-3-25" class="i">+                ),
</a><a href="#h116-3-26" id="h116-3-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h116-3-27" id="h116-3-27" class="i">+            ),
</a><a href="#h116-3-28" id="h116-3-28" class="i">+        ),
</a><a href="#h116-3-29" id="h116-3-29" class="i">+        Some(
</a><a href="#h116-3-30" id="h116-3-30" class="i">+            (
</a><a href="#h116-3-31" id="h116-3-31" class="i">+                Some(
</a><a href="#h116-3-32" id="h116-3-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-3-33" id="h116-3-33" class="i">+                ),
</a><a href="#h116-3-34" id="h116-3-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h116-3-35" id="h116-3-35" class="i">+            ),
</a><a href="#h116-3-36" id="h116-3-36" class="i">+        ),
</a><a href="#h116-3-37" id="h116-3-37" class="i">+        Some(
</a><a href="#h116-3-38" id="h116-3-38" class="i">+            (
</a><a href="#h116-3-39" id="h116-3-39" class="i">+                Some(
</a><a href="#h116-3-40" id="h116-3-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-3-41" id="h116-3-41" class="i">+                ),
</a><a href="#h116-3-42" id="h116-3-42" class="i">+                &quot;released&quot;,
</a><a href="#h116-3-43" id="h116-3-43" class="i">+            ),
</a><a href="#h116-3-44" id="h116-3-44" class="i">+        ),
</a><a href="#h116-3-45" id="h116-3-45" class="i">+        Some(
</a><a href="#h116-3-46" id="h116-3-46" class="i">+            (
</a><a href="#h116-3-47" id="h116-3-47" class="i">+                Some(
</a><a href="#h116-3-48" id="h116-3-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-3-49" id="h116-3-49" class="i">+                ),
</a><a href="#h116-3-50" id="h116-3-50" class="i">+                &quot;rating&quot;,
</a><a href="#h116-3-51" id="h116-3-51" class="i">+            ),
</a><a href="#h116-3-52" id="h116-3-52" class="i">+        ),
</a><a href="#h116-3-53" id="h116-3-53" class="i">+        Some(
</a><a href="#h116-3-54" id="h116-3-54" class="i">+            (
</a><a href="#h116-3-55" id="h116-3-55" class="i">+                Some(
</a><a href="#h116-3-56" id="h116-3-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h116-3-57" id="h116-3-57" class="i">+                ),
</a><a href="#h116-3-58" id="h116-3-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h116-3-59" id="h116-3-59" class="i">+            ),
</a><a href="#h116-3-60" id="h116-3-60" class="i">+        ),
</a><a href="#h116-3-61" id="h116-3-61" class="i">+    ],
</a><a href="#h116-3-62" id="h116-3-62" class="i">+}
</a> 
<b>diff --git a/<a id="h117" href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a> b/<a href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a></b>
<a href="#h117-0" id="h117-0" class="h">@@ -27,8 +27,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h117-0-3" id="h117-0-3" class="d">-Plan: Select(
</a><a href="#h117-0-4" id="h117-0-4" class="d">-    Filter {
</a><a href="#h117-0-5" id="h117-0-5" class="i">+Plan: Select {
</a><a href="#h117-0-6" id="h117-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h117-1" id="h117-1" class="h">@@ -107,8 +107,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h117-1-3" id="h117-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h117-1-5" id="h117-1-5" class="i">+            alias: None,
</a>         },
         predicate: Constant(
             String(
<a href="#h117-2" id="h117-2" class="h">@@ -116,10 +116,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h117-2-3" id="h117-2-3" class="d">-)
</a><a href="#h117-2-4" id="h117-2-4" class="i">+    labels: [
</a><a href="#h117-2-5" id="h117-2-5" class="i">+        Some(
</a><a href="#h117-2-6" id="h117-2-6" class="i">+            (
</a><a href="#h117-2-7" id="h117-2-7" class="i">+                Some(
</a><a href="#h117-2-8" id="h117-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-2-9" id="h117-2-9" class="i">+                ),
</a><a href="#h117-2-10" id="h117-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h117-2-11" id="h117-2-11" class="i">+            ),
</a><a href="#h117-2-12" id="h117-2-12" class="i">+        ),
</a><a href="#h117-2-13" id="h117-2-13" class="i">+        Some(
</a><a href="#h117-2-14" id="h117-2-14" class="i">+            (
</a><a href="#h117-2-15" id="h117-2-15" class="i">+                Some(
</a><a href="#h117-2-16" id="h117-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-2-17" id="h117-2-17" class="i">+                ),
</a><a href="#h117-2-18" id="h117-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h117-2-19" id="h117-2-19" class="i">+            ),
</a><a href="#h117-2-20" id="h117-2-20" class="i">+        ),
</a><a href="#h117-2-21" id="h117-2-21" class="i">+        Some(
</a><a href="#h117-2-22" id="h117-2-22" class="i">+            (
</a><a href="#h117-2-23" id="h117-2-23" class="i">+                Some(
</a><a href="#h117-2-24" id="h117-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-2-25" id="h117-2-25" class="i">+                ),
</a><a href="#h117-2-26" id="h117-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h117-2-27" id="h117-2-27" class="i">+            ),
</a><a href="#h117-2-28" id="h117-2-28" class="i">+        ),
</a><a href="#h117-2-29" id="h117-2-29" class="i">+        Some(
</a><a href="#h117-2-30" id="h117-2-30" class="i">+            (
</a><a href="#h117-2-31" id="h117-2-31" class="i">+                Some(
</a><a href="#h117-2-32" id="h117-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-2-33" id="h117-2-33" class="i">+                ),
</a><a href="#h117-2-34" id="h117-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h117-2-35" id="h117-2-35" class="i">+            ),
</a><a href="#h117-2-36" id="h117-2-36" class="i">+        ),
</a><a href="#h117-2-37" id="h117-2-37" class="i">+        Some(
</a><a href="#h117-2-38" id="h117-2-38" class="i">+            (
</a><a href="#h117-2-39" id="h117-2-39" class="i">+                Some(
</a><a href="#h117-2-40" id="h117-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-2-41" id="h117-2-41" class="i">+                ),
</a><a href="#h117-2-42" id="h117-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h117-2-43" id="h117-2-43" class="i">+            ),
</a><a href="#h117-2-44" id="h117-2-44" class="i">+        ),
</a><a href="#h117-2-45" id="h117-2-45" class="i">+        Some(
</a><a href="#h117-2-46" id="h117-2-46" class="i">+            (
</a><a href="#h117-2-47" id="h117-2-47" class="i">+                Some(
</a><a href="#h117-2-48" id="h117-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-2-49" id="h117-2-49" class="i">+                ),
</a><a href="#h117-2-50" id="h117-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h117-2-51" id="h117-2-51" class="i">+            ),
</a><a href="#h117-2-52" id="h117-2-52" class="i">+        ),
</a><a href="#h117-2-53" id="h117-2-53" class="i">+        Some(
</a><a href="#h117-2-54" id="h117-2-54" class="i">+            (
</a><a href="#h117-2-55" id="h117-2-55" class="i">+                Some(
</a><a href="#h117-2-56" id="h117-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-2-57" id="h117-2-57" class="i">+                ),
</a><a href="#h117-2-58" id="h117-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h117-2-59" id="h117-2-59" class="i">+            ),
</a><a href="#h117-2-60" id="h117-2-60" class="i">+        ),
</a><a href="#h117-2-61" id="h117-2-61" class="i">+    ],
</a><a href="#h117-2-62" id="h117-2-62" class="i">+}
</a> 
<a href="#h117-2-64" id="h117-2-64" class="d">-Optimized plan: Select(
</a><a href="#h117-2-65" id="h117-2-65" class="d">-    Scan {
</a><a href="#h117-2-66" id="h117-2-66" class="i">+Optimized plan: Select {
</a><a href="#h117-2-67" id="h117-2-67" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h117-3" id="h117-3" class="h">@@ -197,7 +255,6 @@ Optimized plan: Select(
</a>                 },
             ],
         },
<a href="#h117-3-3" id="h117-3-3" class="d">-        alias: None,
</a>         filter: Some(
             Constant(
                 String(
<a href="#h117-4" id="h117-4" class="h">@@ -205,6 +262,65 @@ Optimized plan: Select(
</a>                 ),
             ),
         ),
<a href="#h117-4-3" id="h117-4-3" class="i">+        alias: None,
</a>     },
<a href="#h117-4-5" id="h117-4-5" class="d">-)
</a><a href="#h117-4-6" id="h117-4-6" class="i">+    labels: [
</a><a href="#h117-4-7" id="h117-4-7" class="i">+        Some(
</a><a href="#h117-4-8" id="h117-4-8" class="i">+            (
</a><a href="#h117-4-9" id="h117-4-9" class="i">+                Some(
</a><a href="#h117-4-10" id="h117-4-10" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-4-11" id="h117-4-11" class="i">+                ),
</a><a href="#h117-4-12" id="h117-4-12" class="i">+                &quot;id&quot;,
</a><a href="#h117-4-13" id="h117-4-13" class="i">+            ),
</a><a href="#h117-4-14" id="h117-4-14" class="i">+        ),
</a><a href="#h117-4-15" id="h117-4-15" class="i">+        Some(
</a><a href="#h117-4-16" id="h117-4-16" class="i">+            (
</a><a href="#h117-4-17" id="h117-4-17" class="i">+                Some(
</a><a href="#h117-4-18" id="h117-4-18" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-4-19" id="h117-4-19" class="i">+                ),
</a><a href="#h117-4-20" id="h117-4-20" class="i">+                &quot;title&quot;,
</a><a href="#h117-4-21" id="h117-4-21" class="i">+            ),
</a><a href="#h117-4-22" id="h117-4-22" class="i">+        ),
</a><a href="#h117-4-23" id="h117-4-23" class="i">+        Some(
</a><a href="#h117-4-24" id="h117-4-24" class="i">+            (
</a><a href="#h117-4-25" id="h117-4-25" class="i">+                Some(
</a><a href="#h117-4-26" id="h117-4-26" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-4-27" id="h117-4-27" class="i">+                ),
</a><a href="#h117-4-28" id="h117-4-28" class="i">+                &quot;studio_id&quot;,
</a><a href="#h117-4-29" id="h117-4-29" class="i">+            ),
</a><a href="#h117-4-30" id="h117-4-30" class="i">+        ),
</a><a href="#h117-4-31" id="h117-4-31" class="i">+        Some(
</a><a href="#h117-4-32" id="h117-4-32" class="i">+            (
</a><a href="#h117-4-33" id="h117-4-33" class="i">+                Some(
</a><a href="#h117-4-34" id="h117-4-34" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-4-35" id="h117-4-35" class="i">+                ),
</a><a href="#h117-4-36" id="h117-4-36" class="i">+                &quot;genre_id&quot;,
</a><a href="#h117-4-37" id="h117-4-37" class="i">+            ),
</a><a href="#h117-4-38" id="h117-4-38" class="i">+        ),
</a><a href="#h117-4-39" id="h117-4-39" class="i">+        Some(
</a><a href="#h117-4-40" id="h117-4-40" class="i">+            (
</a><a href="#h117-4-41" id="h117-4-41" class="i">+                Some(
</a><a href="#h117-4-42" id="h117-4-42" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-4-43" id="h117-4-43" class="i">+                ),
</a><a href="#h117-4-44" id="h117-4-44" class="i">+                &quot;released&quot;,
</a><a href="#h117-4-45" id="h117-4-45" class="i">+            ),
</a><a href="#h117-4-46" id="h117-4-46" class="i">+        ),
</a><a href="#h117-4-47" id="h117-4-47" class="i">+        Some(
</a><a href="#h117-4-48" id="h117-4-48" class="i">+            (
</a><a href="#h117-4-49" id="h117-4-49" class="i">+                Some(
</a><a href="#h117-4-50" id="h117-4-50" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-4-51" id="h117-4-51" class="i">+                ),
</a><a href="#h117-4-52" id="h117-4-52" class="i">+                &quot;rating&quot;,
</a><a href="#h117-4-53" id="h117-4-53" class="i">+            ),
</a><a href="#h117-4-54" id="h117-4-54" class="i">+        ),
</a><a href="#h117-4-55" id="h117-4-55" class="i">+        Some(
</a><a href="#h117-4-56" id="h117-4-56" class="i">+            (
</a><a href="#h117-4-57" id="h117-4-57" class="i">+                Some(
</a><a href="#h117-4-58" id="h117-4-58" class="i">+                    &quot;movies&quot;,
</a><a href="#h117-4-59" id="h117-4-59" class="i">+                ),
</a><a href="#h117-4-60" id="h117-4-60" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h117-4-61" id="h117-4-61" class="i">+            ),
</a><a href="#h117-4-62" id="h117-4-62" class="i">+        ),
</a><a href="#h117-4-63" id="h117-4-63" class="i">+    ],
</a><a href="#h117-4-64" id="h117-4-64" class="i">+}
</a> 
<b>diff --git a/<a id="h118" href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a> b/<a href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a></b>
<a href="#h118-0" id="h118-0" class="h">@@ -37,8 +37,8 @@ AST: Select {
</a>     limit: None,
 }
 
<a href="#h118-0-3" id="h118-0-3" class="d">-Plan: Select(
</a><a href="#h118-0-4" id="h118-0-4" class="d">-    Filter {
</a><a href="#h118-0-5" id="h118-0-5" class="i">+Plan: Select {
</a><a href="#h118-0-6" id="h118-0-6" class="i">+    root: Filter {
</a>         source: Scan {
             table: Table {
                 name: &quot;movies&quot;,
<a href="#h118-1" id="h118-1" class="h">@@ -117,8 +117,8 @@ Plan: Select(
</a>                     },
                 ],
             },
<a href="#h118-1-3" id="h118-1-3" class="d">-            alias: None,
</a>             filter: None,
<a href="#h118-1-5" id="h118-1-5" class="i">+            alias: None,
</a>         },
         predicate: Constant(
             Boolean(
<a href="#h118-2" id="h118-2" class="h">@@ -126,10 +126,68 @@ Plan: Select(
</a>             ),
         ),
     },
<a href="#h118-2-3" id="h118-2-3" class="d">-)
</a><a href="#h118-2-4" id="h118-2-4" class="i">+    labels: [
</a><a href="#h118-2-5" id="h118-2-5" class="i">+        Some(
</a><a href="#h118-2-6" id="h118-2-6" class="i">+            (
</a><a href="#h118-2-7" id="h118-2-7" class="i">+                Some(
</a><a href="#h118-2-8" id="h118-2-8" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-2-9" id="h118-2-9" class="i">+                ),
</a><a href="#h118-2-10" id="h118-2-10" class="i">+                &quot;id&quot;,
</a><a href="#h118-2-11" id="h118-2-11" class="i">+            ),
</a><a href="#h118-2-12" id="h118-2-12" class="i">+        ),
</a><a href="#h118-2-13" id="h118-2-13" class="i">+        Some(
</a><a href="#h118-2-14" id="h118-2-14" class="i">+            (
</a><a href="#h118-2-15" id="h118-2-15" class="i">+                Some(
</a><a href="#h118-2-16" id="h118-2-16" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-2-17" id="h118-2-17" class="i">+                ),
</a><a href="#h118-2-18" id="h118-2-18" class="i">+                &quot;title&quot;,
</a><a href="#h118-2-19" id="h118-2-19" class="i">+            ),
</a><a href="#h118-2-20" id="h118-2-20" class="i">+        ),
</a><a href="#h118-2-21" id="h118-2-21" class="i">+        Some(
</a><a href="#h118-2-22" id="h118-2-22" class="i">+            (
</a><a href="#h118-2-23" id="h118-2-23" class="i">+                Some(
</a><a href="#h118-2-24" id="h118-2-24" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-2-25" id="h118-2-25" class="i">+                ),
</a><a href="#h118-2-26" id="h118-2-26" class="i">+                &quot;studio_id&quot;,
</a><a href="#h118-2-27" id="h118-2-27" class="i">+            ),
</a><a href="#h118-2-28" id="h118-2-28" class="i">+        ),
</a><a href="#h118-2-29" id="h118-2-29" class="i">+        Some(
</a><a href="#h118-2-30" id="h118-2-30" class="i">+            (
</a><a href="#h118-2-31" id="h118-2-31" class="i">+                Some(
</a><a href="#h118-2-32" id="h118-2-32" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-2-33" id="h118-2-33" class="i">+                ),
</a><a href="#h118-2-34" id="h118-2-34" class="i">+                &quot;genre_id&quot;,
</a><a href="#h118-2-35" id="h118-2-35" class="i">+            ),
</a><a href="#h118-2-36" id="h118-2-36" class="i">+        ),
</a><a href="#h118-2-37" id="h118-2-37" class="i">+        Some(
</a><a href="#h118-2-38" id="h118-2-38" class="i">+            (
</a><a href="#h118-2-39" id="h118-2-39" class="i">+                Some(
</a><a href="#h118-2-40" id="h118-2-40" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-2-41" id="h118-2-41" class="i">+                ),
</a><a href="#h118-2-42" id="h118-2-42" class="i">+                &quot;released&quot;,
</a><a href="#h118-2-43" id="h118-2-43" class="i">+            ),
</a><a href="#h118-2-44" id="h118-2-44" class="i">+        ),
</a><a href="#h118-2-45" id="h118-2-45" class="i">+        Some(
</a><a href="#h118-2-46" id="h118-2-46" class="i">+            (
</a><a href="#h118-2-47" id="h118-2-47" class="i">+                Some(
</a><a href="#h118-2-48" id="h118-2-48" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-2-49" id="h118-2-49" class="i">+                ),
</a><a href="#h118-2-50" id="h118-2-50" class="i">+                &quot;rating&quot;,
</a><a href="#h118-2-51" id="h118-2-51" class="i">+            ),
</a><a href="#h118-2-52" id="h118-2-52" class="i">+        ),
</a><a href="#h118-2-53" id="h118-2-53" class="i">+        Some(
</a><a href="#h118-2-54" id="h118-2-54" class="i">+            (
</a><a href="#h118-2-55" id="h118-2-55" class="i">+                Some(
</a><a href="#h118-2-56" id="h118-2-56" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-2-57" id="h118-2-57" class="i">+                ),
</a><a href="#h118-2-58" id="h118-2-58" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h118-2-59" id="h118-2-59" class="i">+            ),
</a><a href="#h118-2-60" id="h118-2-60" class="i">+        ),
</a><a href="#h118-2-61" id="h118-2-61" class="i">+    ],
</a><a href="#h118-2-62" id="h118-2-62" class="i">+}
</a> 
<a href="#h118-2-64" id="h118-2-64" class="d">-Optimized plan: Select(
</a><a href="#h118-2-65" id="h118-2-65" class="d">-    Scan {
</a><a href="#h118-2-66" id="h118-2-66" class="i">+Optimized plan: Select {
</a><a href="#h118-2-67" id="h118-2-67" class="i">+    root: Scan {
</a>         table: Table {
             name: &quot;movies&quot;,
             primary_key: 0,
<a href="#h118-3" id="h118-3" class="h">@@ -207,7 +265,6 @@ Optimized plan: Select(
</a>                 },
             ],
         },
<a href="#h118-3-3" id="h118-3-3" class="d">-        alias: None,
</a>         filter: Some(
             Constant(
                 Boolean(
<a href="#h118-4" id="h118-4" class="h">@@ -215,6 +272,65 @@ Optimized plan: Select(
</a>                 ),
             ),
         ),
<a href="#h118-4-3" id="h118-4-3" class="i">+        alias: None,
</a>     },
<a href="#h118-4-5" id="h118-4-5" class="d">-)
</a><a href="#h118-4-6" id="h118-4-6" class="i">+    labels: [
</a><a href="#h118-4-7" id="h118-4-7" class="i">+        Some(
</a><a href="#h118-4-8" id="h118-4-8" class="i">+            (
</a><a href="#h118-4-9" id="h118-4-9" class="i">+                Some(
</a><a href="#h118-4-10" id="h118-4-10" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-4-11" id="h118-4-11" class="i">+                ),
</a><a href="#h118-4-12" id="h118-4-12" class="i">+                &quot;id&quot;,
</a><a href="#h118-4-13" id="h118-4-13" class="i">+            ),
</a><a href="#h118-4-14" id="h118-4-14" class="i">+        ),
</a><a href="#h118-4-15" id="h118-4-15" class="i">+        Some(
</a><a href="#h118-4-16" id="h118-4-16" class="i">+            (
</a><a href="#h118-4-17" id="h118-4-17" class="i">+                Some(
</a><a href="#h118-4-18" id="h118-4-18" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-4-19" id="h118-4-19" class="i">+                ),
</a><a href="#h118-4-20" id="h118-4-20" class="i">+                &quot;title&quot;,
</a><a href="#h118-4-21" id="h118-4-21" class="i">+            ),
</a><a href="#h118-4-22" id="h118-4-22" class="i">+        ),
</a><a href="#h118-4-23" id="h118-4-23" class="i">+        Some(
</a><a href="#h118-4-24" id="h118-4-24" class="i">+            (
</a><a href="#h118-4-25" id="h118-4-25" class="i">+                Some(
</a><a href="#h118-4-26" id="h118-4-26" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-4-27" id="h118-4-27" class="i">+                ),
</a><a href="#h118-4-28" id="h118-4-28" class="i">+                &quot;studio_id&quot;,
</a><a href="#h118-4-29" id="h118-4-29" class="i">+            ),
</a><a href="#h118-4-30" id="h118-4-30" class="i">+        ),
</a><a href="#h118-4-31" id="h118-4-31" class="i">+        Some(
</a><a href="#h118-4-32" id="h118-4-32" class="i">+            (
</a><a href="#h118-4-33" id="h118-4-33" class="i">+                Some(
</a><a href="#h118-4-34" id="h118-4-34" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-4-35" id="h118-4-35" class="i">+                ),
</a><a href="#h118-4-36" id="h118-4-36" class="i">+                &quot;genre_id&quot;,
</a><a href="#h118-4-37" id="h118-4-37" class="i">+            ),
</a><a href="#h118-4-38" id="h118-4-38" class="i">+        ),
</a><a href="#h118-4-39" id="h118-4-39" class="i">+        Some(
</a><a href="#h118-4-40" id="h118-4-40" class="i">+            (
</a><a href="#h118-4-41" id="h118-4-41" class="i">+                Some(
</a><a href="#h118-4-42" id="h118-4-42" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-4-43" id="h118-4-43" class="i">+                ),
</a><a href="#h118-4-44" id="h118-4-44" class="i">+                &quot;released&quot;,
</a><a href="#h118-4-45" id="h118-4-45" class="i">+            ),
</a><a href="#h118-4-46" id="h118-4-46" class="i">+        ),
</a><a href="#h118-4-47" id="h118-4-47" class="i">+        Some(
</a><a href="#h118-4-48" id="h118-4-48" class="i">+            (
</a><a href="#h118-4-49" id="h118-4-49" class="i">+                Some(
</a><a href="#h118-4-50" id="h118-4-50" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-4-51" id="h118-4-51" class="i">+                ),
</a><a href="#h118-4-52" id="h118-4-52" class="i">+                &quot;rating&quot;,
</a><a href="#h118-4-53" id="h118-4-53" class="i">+            ),
</a><a href="#h118-4-54" id="h118-4-54" class="i">+        ),
</a><a href="#h118-4-55" id="h118-4-55" class="i">+        Some(
</a><a href="#h118-4-56" id="h118-4-56" class="i">+            (
</a><a href="#h118-4-57" id="h118-4-57" class="i">+                Some(
</a><a href="#h118-4-58" id="h118-4-58" class="i">+                    &quot;movies&quot;,
</a><a href="#h118-4-59" id="h118-4-59" class="i">+                ),
</a><a href="#h118-4-60" id="h118-4-60" class="i">+                &quot;ultrahd&quot;,
</a><a href="#h118-4-61" id="h118-4-61" class="i">+            ),
</a><a href="#h118-4-62" id="h118-4-62" class="i">+        ),
</a><a href="#h118-4-63" id="h118-4-63" class="i">+    ],
</a><a href="#h118-4-64" id="h118-4-64" class="i">+}
</a> 
</pre>
</div>
</body>
</html>
