<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: always include decimal point when formatting floats - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/865e9c284bcc35e9f490e44b9815be6bb6506c3b.html">865e9c284bcc35e9f490e44b9815be6bb6506c3b</a>
<b>parent</b> <a href="../commit/dc046c4f5fc96c2dc567d3a2bfbd384e233dc1cd.html">dc046c4f5fc96c2dc567d3a2bfbd384e233dc1cd</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sat, 20 Jul 2024 17:30:49 +0200

sql: always include decimal point when formatting floats

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/testscripts/expressions/op_compare_greater_equal</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/testscripts/expressions/op_compare_lesser_equal</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/testscripts/expressions/op_compare_not_equal</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/testscripts/expressions/op_math_factorial</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/testscripts/optimizer/index_lookup</a></td><td> | </td><td class="num">22</td><td><span class="i">+++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/testscripts/queries/aggregate</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/testscripts/queries/group_by</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/testscripts/queries/limit</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/testscripts/queries/offset</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/testscripts/queries/order</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/testscripts/queries/where_</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/testscripts/queries/where_index</a></td><td> | </td><td class="num">28</td><td><span class="i">++++++++++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/sql/testscripts/queries/where_primary_key</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/sql/testscripts/writes/insert_datatypes</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">src/sql/testscripts/writes/insert_index</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">src/sql/testscripts/writes/insert_primary_key</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">src/sql/testscripts/writes/insert_reference</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/sql/testscripts/writes/insert_unique</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">src/sql/testscripts/writes/update_datatypes</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">src/sql/testscripts/writes/update_primary_key</a></td><td> | </td><td class="num">18</td><td><span class="i">+++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">src/sql/testscripts/writes/update_unique</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">src/sql/types/value.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
</table></pre><pre>22 files changed, 113 insertions(+), 113 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/testscripts/expressions/op_compare_greater_equal.html">src/sql/testscripts/expressions/op_compare_greater_equal</a> b/<a href="../file/src/sql/testscripts/expressions/op_compare_greater_equal.html">src/sql/testscripts/expressions/op_compare_greater_equal</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -14,7 +14,7 @@ Boolean(true) ‚Üê 0 &gt; -1 OR 0 = -1
</a> [expr]&gt; INFINITY &gt;= INFINITY
 [expr]&gt; NAN &gt;= NAN
 ---
<a href="#h0-0-3" id="h0-0-3" class="d">-Boolean(true) ‚Üê -0 &gt; 0 OR -0 = 0
</a><a href="#h0-0-4" id="h0-0-4" class="i">+Boolean(true) ‚Üê -0.0 &gt; 0.0 OR -0.0 = 0.0
</a> Boolean(true) ‚Üê inf &gt; inf OR inf = inf
 Boolean(false) ‚Üê NaN &gt; NaN OR NaN = NaN
 
<b>diff --git a/<a id="h1" href="../file/src/sql/testscripts/expressions/op_compare_lesser_equal.html">src/sql/testscripts/expressions/op_compare_lesser_equal</a> b/<a href="../file/src/sql/testscripts/expressions/op_compare_lesser_equal.html">src/sql/testscripts/expressions/op_compare_lesser_equal</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -14,7 +14,7 @@ Boolean(true) ‚Üê -1 &lt; 0 OR -1 = 0
</a> [expr]&gt; INFINITY &lt;= INFINITY
 [expr]&gt; NAN &lt;= NAN
 ---
<a href="#h1-0-3" id="h1-0-3" class="d">-Boolean(true) ‚Üê 0 &lt; -0 OR 0 = -0
</a><a href="#h1-0-4" id="h1-0-4" class="i">+Boolean(true) ‚Üê 0.0 &lt; -0.0 OR 0.0 = -0.0
</a> Boolean(true) ‚Üê inf &lt; inf OR inf = inf
 Boolean(false) ‚Üê NaN &lt; NaN OR NaN = NaN
 
<b>diff --git a/<a id="h2" href="../file/src/sql/testscripts/expressions/op_compare_not_equal.html">src/sql/testscripts/expressions/op_compare_not_equal</a> b/<a href="../file/src/sql/testscripts/expressions/op_compare_not_equal.html">src/sql/testscripts/expressions/op_compare_not_equal</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -13,8 +13,8 @@ Null ‚Üê NOT 1 = NULL
</a> [expr]&gt; 3.0 != 3
 [expr]&gt; 0.0 != -0.0
 ---
<a href="#h2-0-3" id="h2-0-3" class="d">-Boolean(false) ‚Üê NOT 3 = 3
</a><a href="#h2-0-4" id="h2-0-4" class="d">-Boolean(false) ‚Üê NOT 0 = -0
</a><a href="#h2-0-5" id="h2-0-5" class="i">+Boolean(false) ‚Üê NOT 3.0 = 3
</a><a href="#h2-0-6" id="h2-0-6" class="i">+Boolean(false) ‚Üê NOT 0.0 = -0.0
</a> 
 [expr]&gt; NAN != NAN
 [expr]&gt; INFINITY != INFINITY
<b>diff --git a/<a id="h3" href="../file/src/sql/testscripts/expressions/op_math_factorial.html">src/sql/testscripts/expressions/op_math_factorial</a> b/<a href="../file/src/sql/testscripts/expressions/op_math_factorial.html">src/sql/testscripts/expressions/op_math_factorial</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -12,7 +12,7 @@ Integer(6) ‚Üê 3!
</a> !&gt; &#39;a&#39;!
 ---
 Error: invalid input: can&#39;t take factorial of 3.14
<a href="#h3-0-3" id="h3-0-3" class="d">-Error: invalid input: can&#39;t take factorial of 3
</a><a href="#h3-0-4" id="h3-0-4" class="i">+Error: invalid input: can&#39;t take factorial of 3.0
</a> Error: invalid input: can&#39;t take factorial of TRUE
 Error: invalid input: can&#39;t take factorial of a
 
<b>diff --git a/<a id="h4" href="../file/src/sql/testscripts/optimizer/index_lookup.html">src/sql/testscripts/optimizer/index_lookup</a> b/<a href="../file/src/sql/testscripts/optimizer/index_lookup.html">src/sql/testscripts/optimizer/index_lookup</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -29,7 +29,7 @@ Filter pushdown:
</a> Index lookup:
    KeyLookup: test (1, 3)
 1, a, 3.14
<a href="#h4-0-3" id="h4-0-3" class="d">-3, c, 0
</a><a href="#h4-0-4" id="h4-0-4" class="i">+3, c, 0.0
</a> 
 # Can combine lookups with other predicates, but only AND.
 [opt]&gt; SELECT * FROM test WHERE (id = 1 OR id = 3) AND value &gt; &#39;a&#39;
<a href="#h4-1" id="h4-1" class="h">@@ -42,7 +42,7 @@ Filter pushdown:
</a> Index lookup:
    Filter: test.value &gt; a
    ‚îî‚îÄ KeyLookup: test (1, 3)
<a href="#h4-1-3" id="h4-1-3" class="d">-3, c, 0
</a><a href="#h4-1-4" id="h4-1-4" class="i">+3, c, 0.0
</a> 
 [opt]&gt; SELECT * FROM test WHERE id = 1 OR id = 3 OR value &gt; &#39;a&#39;
 ---
<a href="#h4-2" id="h4-2" class="h">@@ -53,7 +53,7 @@ Filter pushdown:
</a>    Scan: test (test.id = 1 OR test.id = 3 OR test.value &gt; a)
 1, a, 3.14
 2, b, NaN
<a href="#h4-2-3" id="h4-2-3" class="d">-3, c, 0
</a><a href="#h4-2-4" id="h4-2-4" class="i">+3, c, 0.0
</a> 
 # Same story with secondary indexes.
 [opt]&gt; SELECT * FROM test WHERE value = &#39;b&#39;
<a href="#h4-3" id="h4-3" class="h">@@ -77,7 +77,7 @@ Filter pushdown:
</a> Index lookup:
    IndexLookup: test.value (a, c)
 1, a, 3.14
<a href="#h4-3-3" id="h4-3-3" class="d">-3, c, 0
</a><a href="#h4-3-4" id="h4-3-4" class="i">+3, c, 0.0
</a> 
 [opt]&gt; SELECT * FROM test WHERE (value = &#39;a&#39; OR value = &#39;c&#39;) AND id &gt; 1
 ---
<a href="#h4-4" id="h4-4" class="h">@@ -89,7 +89,7 @@ Filter pushdown:
</a> Index lookup:
    Filter: test.id &gt; 1
    ‚îî‚îÄ IndexLookup: test.value (a, c)
<a href="#h4-4-3" id="h4-4-3" class="d">-3, c, 0
</a><a href="#h4-4-4" id="h4-4-4" class="i">+3, c, 0.0
</a> 
 [opt]&gt; SELECT * FROM test WHERE value = &#39;a&#39; OR value = &#39;c&#39; OR id &gt; 1
 ---
<a href="#h4-5" id="h4-5" class="h">@@ -100,7 +100,7 @@ Filter pushdown:
</a>    Scan: test (test.value = a OR test.value = c OR test.id &gt; 1)
 1, a, 3.14
 2, b, NaN
<a href="#h4-5-3" id="h4-5-3" class="d">-3, c, 0
</a><a href="#h4-5-4" id="h4-5-4" class="i">+3, c, 0.0
</a> 
 # NULL lookups should match for IS NULL, but not for = NULL. IS NOT NULL
 # incurs a table scan.
<a href="#h4-6" id="h4-6" class="h">@@ -144,7 +144,7 @@ Filter pushdown:
</a>    Scan: test (NOT test.value IS NULL)
 1, a, 3.14
 2, b, NaN
<a href="#h4-6-3" id="h4-6-3" class="d">-3, c, 0
</a><a href="#h4-6-4" id="h4-6-4" class="i">+3, c, 0.0
</a> 
 # NAN lookups should be treated similarly to NULLs.
 [opt]&gt; SELECT * FROM test WHERE &quot;float&quot; IS NAN
<a href="#h4-7" id="h4-7" class="h">@@ -196,7 +196,7 @@ Filter pushdown:
</a>    Scan: test (NOT test.float = NaN)
 1, a, 3.14
 2, b, NaN
<a href="#h4-7-3" id="h4-7-3" class="d">-3, c, 0
</a><a href="#h4-7-4" id="h4-7-4" class="i">+3, c, 0.0
</a> 
 [opt]&gt; SELECT * FROM test WHERE &quot;float&quot; IS NOT NAN
 ---
<a href="#h4-8" id="h4-8" class="h">@@ -206,7 +206,7 @@ Initial:
</a> Filter pushdown:
    Scan: test (NOT test.float IS NAN)
 1, a, 3.14
<a href="#h4-8-3" id="h4-8-3" class="d">-3, c, 0
</a><a href="#h4-8-4" id="h4-8-4" class="i">+3, c, 0.0
</a> 
 # Inner joins on foreign keys with index lookups are transferred across.
 [opt]&gt; SELECT * FROM test JOIN other ON other.test_id = test.id WHERE test_id = 1 OR test_id = 3
<a href="#h4-9" id="h4-9" class="h">@@ -229,7 +229,7 @@ Join type:
</a>    ‚îú‚îÄ KeyLookup: test (1, 3)
    ‚îî‚îÄ IndexLookup: other.test_id (1, 3)
 1, a, 3.14, 1, 1
<a href="#h4-9-3" id="h4-9-3" class="d">-3, c, 0, 3, 3
</a><a href="#h4-9-4" id="h4-9-4" class="i">+3, c, 0.0, 3, 3
</a> 
 # It&#39;s the same if the index lookups are given in the join predicate.
 [opt]&gt; SELECT * FROM test JOIN other ON other.test_id = test.id AND (test_id = 1 OR test_id = 3)
<a href="#h4-10" id="h4-10" class="h">@@ -251,7 +251,7 @@ Join type:
</a>    ‚îú‚îÄ KeyLookup: test (1, 3)
    ‚îî‚îÄ IndexLookup: other.test_id (1, 3)
 1, a, 3.14, 1, 1
<a href="#h4-10-3" id="h4-10-3" class="d">-3, c, 0, 3, 3
</a><a href="#h4-10-4" id="h4-10-4" class="i">+3, c, 0.0, 3, 3
</a> 
 # It also works with three tables.
 [opt]&gt; SELECT * FROM test \
<b>diff --git a/<a id="h5" href="../file/src/sql/testscripts/queries/aggregate.html">src/sql/testscripts/queries/aggregate</a> b/<a href="../file/src/sql/testscripts/queries/aggregate.html">src/sql/testscripts/queries/aggregate</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -116,7 +116,7 @@ FALSE
</a> 
 &gt; SELECT MIN(&quot;float&quot;) FROM test
 ---
<a href="#h5-0-3" id="h5-0-3" class="d">-0
</a><a href="#h5-0-4" id="h5-0-4" class="i">+0.0
</a> 
 &gt; SELECT MIN(&quot;string&quot;) FROM test
 ---
<b>diff --git a/<a id="h6" href="../file/src/sql/testscripts/queries/group_by.html">src/sql/testscripts/queries/group_by</a> b/<a href="../file/src/sql/testscripts/queries/group_by.html">src/sql/testscripts/queries/group_by</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -73,7 +73,7 @@ NULL, 1
</a> Aggregate: test.float, count(TRUE)
 ‚îî‚îÄ Scan: test
 NULL, 1
<a href="#h6-0-3" id="h6-0-3" class="d">-0, 2
</a><a href="#h6-0-4" id="h6-0-4" class="i">+0.0, 2
</a> 3.14, 1
 inf, 1
 NaN, 2
<a href="#h6-1" id="h6-1" class="h">@@ -227,10 +227,10 @@ Aggregate: test.id, test.group, test.bool, test.int, test.float, test.string
</a> 0, NULL, NULL, NULL, NULL, NULL
 1, a, TRUE, -1, 3.14, 
 2, b, FALSE, 0, NaN, abc
<a href="#h6-1-3" id="h6-1-3" class="d">-3, a, TRUE, 3, 0, AB
</a><a href="#h6-1-4" id="h6-1-4" class="i">+3, a, TRUE, 3, 0.0, AB
</a> 4, b, TRUE, 42, inf, üëã
 5, a, FALSE, 7, NaN, 
<a href="#h6-1-7" id="h6-1-7" class="d">-6, b, FALSE, -1, 0, abc
</a><a href="#h6-1-8" id="h6-1-8" class="i">+6, b, FALSE, -1, 0.0, abc
</a> 
 [plan]&gt; SELECT * FROM test GROUP BY &quot;bool&quot;, &quot;int&quot;, &quot;float&quot;, &quot;string&quot;, &quot;group&quot;, id
 ---
<a href="#h6-2" id="h6-2" class="h">@@ -238,9 +238,9 @@ Projection: test.id, test.group, test.bool, test.int, test.float, test.string
</a> ‚îî‚îÄ Aggregate: test.bool, test.int, test.float, test.string, test.group, test.id
    ‚îî‚îÄ Scan: test
 0, NULL, NULL, NULL, NULL, NULL
<a href="#h6-2-3" id="h6-2-3" class="d">-6, b, FALSE, -1, 0, abc
</a><a href="#h6-2-4" id="h6-2-4" class="i">+6, b, FALSE, -1, 0.0, abc
</a> 2, b, FALSE, 0, NaN, abc
 5, a, FALSE, 7, NaN, 
 1, a, TRUE, -1, 3.14, 
<a href="#h6-2-8" id="h6-2-8" class="d">-3, a, TRUE, 3, 0, AB
</a><a href="#h6-2-9" id="h6-2-9" class="i">+3, a, TRUE, 3, 0.0, AB
</a> 4, b, TRUE, 42, inf, üëã
<b>diff --git a/<a id="h7" href="../file/src/sql/testscripts/queries/limit.html">src/sql/testscripts/queries/limit</a> b/<a href="../file/src/sql/testscripts/queries/limit.html">src/sql/testscripts/queries/limit</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -77,7 +77,7 @@ Error: invalid input: invalid limit NULL
</a> !&gt; SELECT * FROM test LIMIT &#39;1&#39;
 ---
 Error: invalid input: invalid limit FALSE
<a href="#h7-0-3" id="h7-0-3" class="d">-Error: invalid input: invalid limit 1
</a><a href="#h7-0-4" id="h7-0-4" class="i">+Error: invalid input: invalid limit 1.0
</a> Error: invalid input: invalid limit 1
 
 # Multiple limits error.
<b>diff --git a/<a id="h8" href="../file/src/sql/testscripts/queries/offset.html">src/sql/testscripts/queries/offset</a> b/<a href="../file/src/sql/testscripts/queries/offset.html">src/sql/testscripts/queries/offset</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -76,7 +76,7 @@ Error: invalid input: invalid offset NULL
</a> !&gt; SELECT * FROM test OFFSET &#39;1&#39;
 ---
 Error: invalid input: invalid offset FALSE
<a href="#h8-0-3" id="h8-0-3" class="d">-Error: invalid input: invalid offset 1
</a><a href="#h8-0-4" id="h8-0-4" class="i">+Error: invalid input: invalid offset 1.0
</a> Error: invalid input: invalid offset 1
 
 # Multiple offsets error.
<b>diff --git a/<a id="h9" href="../file/src/sql/testscripts/queries/order.html">src/sql/testscripts/queries/order</a> b/<a href="../file/src/sql/testscripts/queries/order.html">src/sql/testscripts/queries/order</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -48,8 +48,8 @@ Order: test.id asc
</a> 0, NULL, NULL, NULL, NULL, 1
 1, TRUE, 0, 3.14, a, 1
 2, FALSE, -1, -2.718, ab, 1
<a href="#h9-0-3" id="h9-0-3" class="d">-3, NULL, 1, 0, aaa, 1
</a><a href="#h9-0-4" id="h9-0-4" class="d">-4, NULL, 1000, 0, A, 1
</a><a href="#h9-0-5" id="h9-0-5" class="i">+3, NULL, 1, 0.0, aaa, 1
</a><a href="#h9-0-6" id="h9-0-6" class="i">+4, NULL, 1000, 0.0, A, 1
</a> 5, NULL, -1000, inf, , 1
 6, NULL, 7, -inf, √•a, 1
 7, NULL, -9, NaN, √Öa, 1
<a href="#h9-1" id="h9-1" class="h">@@ -65,8 +65,8 @@ Order: test.id desc
</a> 7, NULL, -9, NaN, √Öa, 1
 6, NULL, 7, -inf, √•a, 1
 5, NULL, -1000, inf, , 1
<a href="#h9-1-3" id="h9-1-3" class="d">-4, NULL, 1000, 0, A, 1
</a><a href="#h9-1-4" id="h9-1-4" class="d">-3, NULL, 1, 0, aaa, 1
</a><a href="#h9-1-5" id="h9-1-5" class="i">+4, NULL, 1000, 0.0, A, 1
</a><a href="#h9-1-6" id="h9-1-6" class="i">+3, NULL, 1, 0.0, aaa, 1
</a> 2, FALSE, -1, -2.718, ab, 1
 1, TRUE, 0, 3.14, a, 1
 0, NULL, NULL, NULL, NULL, 1
<a href="#h9-2" id="h9-2" class="h">@@ -133,8 +133,8 @@ Order: test.id desc
</a> 9, NULL
 6, -inf
 2, -2.718
<a href="#h9-2-3" id="h9-2-3" class="d">-3, 0
</a><a href="#h9-2-4" id="h9-2-4" class="d">-4, 0
</a><a href="#h9-2-5" id="h9-2-5" class="i">+3, 0.0
</a><a href="#h9-2-6" id="h9-2-6" class="i">+4, 0.0
</a> 1, 3.14
 5, inf
 7, NaN
<a href="#h9-3" id="h9-3" class="h">@@ -144,8 +144,8 @@ Order: test.id desc
</a> 7, NaN
 5, inf
 1, 3.14
<a href="#h9-3-3" id="h9-3-3" class="d">-3, 0
</a><a href="#h9-3-4" id="h9-3-4" class="d">-4, 0
</a><a href="#h9-3-5" id="h9-3-5" class="i">+3, 0.0
</a><a href="#h9-3-6" id="h9-3-6" class="i">+4, 0.0
</a> 2, -2.718
 6, -inf
 0, NULL
<a href="#h9-4" id="h9-4" class="h">@@ -246,8 +246,8 @@ Order: test.float ^ 2 asc
</a> 0, NULL
 8, NULL
 9, NULL
<a href="#h9-4-3" id="h9-4-3" class="d">-3, 0
</a><a href="#h9-4-4" id="h9-4-4" class="d">-4, 0
</a><a href="#h9-4-5" id="h9-4-5" class="i">+3, 0.0
</a><a href="#h9-4-6" id="h9-4-6" class="i">+4, 0.0
</a> 2, -2.718
 1, 3.14
 5, inf
<a href="#h9-5" id="h9-5" class="h">@@ -424,8 +424,8 @@ Order: other.id desc
</a> 0, NULL, NULL, NULL, NULL, 1, 2, b
 1, TRUE, 0, 3.14, a, 1, 2, b
 2, FALSE, -1, -2.718, ab, 1, 2, b
<a href="#h9-5-3" id="h9-5-3" class="d">-3, NULL, 1, 0, aaa, 1, 2, b
</a><a href="#h9-5-4" id="h9-5-4" class="d">-4, NULL, 1000, 0, A, 1, 2, b
</a><a href="#h9-5-5" id="h9-5-5" class="i">+3, NULL, 1, 0.0, aaa, 1, 2, b
</a><a href="#h9-5-6" id="h9-5-6" class="i">+4, NULL, 1000, 0.0, A, 1, 2, b
</a> 5, NULL, -1000, inf, , 1, 2, b
 6, NULL, 7, -inf, √•a, 1, 2, b
 7, NULL, -9, NaN, √Öa, 1, 2, b
<a href="#h9-6" id="h9-6" class="h">@@ -434,8 +434,8 @@ Order: other.id desc
</a> 0, NULL, NULL, NULL, NULL, 1, 1, a
 1, TRUE, 0, 3.14, a, 1, 1, a
 2, FALSE, -1, -2.718, ab, 1, 1, a
<a href="#h9-6-3" id="h9-6-3" class="d">-3, NULL, 1, 0, aaa, 1, 1, a
</a><a href="#h9-6-4" id="h9-6-4" class="d">-4, NULL, 1000, 0, A, 1, 1, a
</a><a href="#h9-6-5" id="h9-6-5" class="i">+3, NULL, 1, 0.0, aaa, 1, 1, a
</a><a href="#h9-6-6" id="h9-6-6" class="i">+4, NULL, 1000, 0.0, A, 1, 1, a
</a> 5, NULL, -1000, inf, , 1, 1, a
 6, NULL, 7, -inf, √•a, 1, 1, a
 7, NULL, -9, NaN, √Öa, 1, 1, a
<a href="#h9-7" id="h9-7" class="h">@@ -451,8 +451,8 @@ Order: o.id desc, t.id asc
</a> 0, NULL, NULL, NULL, NULL, 1, 2, b
 1, TRUE, 0, 3.14, a, 1, 2, b
 2, FALSE, -1, -2.718, ab, 1, 2, b
<a href="#h9-7-3" id="h9-7-3" class="d">-3, NULL, 1, 0, aaa, 1, 2, b
</a><a href="#h9-7-4" id="h9-7-4" class="d">-4, NULL, 1000, 0, A, 1, 2, b
</a><a href="#h9-7-5" id="h9-7-5" class="i">+3, NULL, 1, 0.0, aaa, 1, 2, b
</a><a href="#h9-7-6" id="h9-7-6" class="i">+4, NULL, 1000, 0.0, A, 1, 2, b
</a> 5, NULL, -1000, inf, , 1, 2, b
 6, NULL, 7, -inf, √•a, 1, 2, b
 7, NULL, -9, NaN, √Öa, 1, 2, b
<a href="#h9-8" id="h9-8" class="h">@@ -461,8 +461,8 @@ Order: o.id desc, t.id asc
</a> 0, NULL, NULL, NULL, NULL, 1, 1, a
 1, TRUE, 0, 3.14, a, 1, 1, a
 2, FALSE, -1, -2.718, ab, 1, 1, a
<a href="#h9-8-3" id="h9-8-3" class="d">-3, NULL, 1, 0, aaa, 1, 1, a
</a><a href="#h9-8-4" id="h9-8-4" class="d">-4, NULL, 1000, 0, A, 1, 1, a
</a><a href="#h9-8-5" id="h9-8-5" class="i">+3, NULL, 1, 0.0, aaa, 1, 1, a
</a><a href="#h9-8-6" id="h9-8-6" class="i">+4, NULL, 1000, 0.0, A, 1, 1, a
</a> 5, NULL, -1000, inf, , 1, 1, a
 6, NULL, 7, -inf, √•a, 1, 1, a
 7, NULL, -9, NaN, √Öa, 1, 1, a
<b>diff --git a/<a id="h10" href="../file/src/sql/testscripts/queries/where_.html">src/sql/testscripts/queries/where_</a> b/<a href="../file/src/sql/testscripts/queries/where_.html">src/sql/testscripts/queries/where_</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -43,7 +43,7 @@ Scan: test (test.id &gt; 1 AND test.value &lt; c)
</a> !&gt; SELECT * FROM test WHERE &#39;&#39;
 ---
 Error: invalid input: filter returned 1, expected boolean
<a href="#h10-0-3" id="h10-0-3" class="d">-Error: invalid input: filter returned 1, expected boolean
</a><a href="#h10-0-4" id="h10-0-4" class="i">+Error: invalid input: filter returned 1.0, expected boolean
</a> Error: invalid input: filter returned , expected boolean
 
 # Errors on bare WHERE clause or multiple predicates.
<b>diff --git a/<a id="h11" href="../file/src/sql/testscripts/queries/where_index.html">src/sql/testscripts/queries/where_index</a> b/<a href="../file/src/sql/testscripts/queries/where_index.html">src/sql/testscripts/queries/where_index</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -23,7 +23,7 @@ ok
</a> ---
 IndexLookup: test.bool (TRUE)
 1, TRUE, 0, 3.14, abc
<a href="#h11-0-3" id="h11-0-3" class="d">-3, TRUE, 1, 0, ABC
</a><a href="#h11-0-4" id="h11-0-4" class="i">+3, TRUE, 1, 0.0, ABC
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;bool&quot; = FALSE
 ---
<a href="#h11-1" id="h11-1" class="h">@@ -44,8 +44,8 @@ IndexLookup: test.int (0)
</a> [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; = 1
 ---
 IndexLookup: test.int (1)
<a href="#h11-1-3" id="h11-1-3" class="d">-3, TRUE, 1, 0, ABC
</a><a href="#h11-1-4" id="h11-1-4" class="d">-4, NULL, 1, 0, üëç
</a><a href="#h11-1-5" id="h11-1-5" class="i">+3, TRUE, 1, 0.0, ABC
</a><a href="#h11-1-6" id="h11-1-6" class="i">+4, NULL, 1, 0.0, üëç
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; = 7
 ---
<a href="#h11-2" id="h11-2" class="h">@@ -60,15 +60,15 @@ IndexLookup: test.float (-2.718)
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = -0.0
 ---
<a href="#h11-2-3" id="h11-2-3" class="d">-IndexLookup: test.float (-0)
</a><a href="#h11-2-4" id="h11-2-4" class="d">-3, TRUE, 1, 0, ABC
</a><a href="#h11-2-5" id="h11-2-5" class="d">-4, NULL, 1, 0, üëç
</a><a href="#h11-2-6" id="h11-2-6" class="i">+IndexLookup: test.float (-0.0)
</a><a href="#h11-2-7" id="h11-2-7" class="i">+3, TRUE, 1, 0.0, ABC
</a><a href="#h11-2-8" id="h11-2-8" class="i">+4, NULL, 1, 0.0, üëç
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = 0.0
 ---
<a href="#h11-2-12" id="h11-2-12" class="d">-IndexLookup: test.float (0)
</a><a href="#h11-2-13" id="h11-2-13" class="d">-3, TRUE, 1, 0, ABC
</a><a href="#h11-2-14" id="h11-2-14" class="d">-4, NULL, 1, 0, üëç
</a><a href="#h11-2-15" id="h11-2-15" class="i">+IndexLookup: test.float (0.0)
</a><a href="#h11-2-16" id="h11-2-16" class="i">+3, TRUE, 1, 0.0, ABC
</a><a href="#h11-2-17" id="h11-2-17" class="i">+4, NULL, 1, 0.0, üëç
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;float&quot; = 3.14
 ---
<a href="#h11-3" id="h11-3" class="h">@@ -112,7 +112,7 @@ IndexLookup: test.string (√•)
</a> [plan]&gt; SELECT * FROM test WHERE &quot;string&quot; = &#39;üëç&#39;
 ---
 IndexLookup: test.string (üëç)
<a href="#h11-3-3" id="h11-3-3" class="d">-4, NULL, 1, 0, üëç
</a><a href="#h11-3-4" id="h11-3-4" class="i">+4, NULL, 1, 0.0, üëç
</a> 
 [plan]&gt; SELECT * FROM test WHERE &quot;string&quot; = &#39;&#39;
 ---
<a href="#h11-4" id="h11-4" class="h">@@ -144,8 +144,8 @@ Nothing
</a> IndexLookup: test.int (-1, 0, 1, 7)
 1, TRUE, 0, 3.14, abc
 2, FALSE, -1, -2.718, a
<a href="#h11-4-3" id="h11-4-3" class="d">-3, TRUE, 1, 0, ABC
</a><a href="#h11-4-4" id="h11-4-4" class="d">-4, NULL, 1, 0, üëç
</a><a href="#h11-4-5" id="h11-4-5" class="i">+3, TRUE, 1, 0.0, ABC
</a><a href="#h11-4-6" id="h11-4-6" class="i">+4, NULL, 1, 0.0, üëç
</a> 
 # &gt; or &lt; predicates don&#39;t use an index.
 [plan]&gt; SELECT * FROM test WHERE &quot;int&quot; &lt; 1
<a href="#h11-5" id="h11-5" class="h">@@ -158,5 +158,5 @@ Scan: test (test.int &lt; 1)
</a> ---
 Scan: test (test.int &gt; -1)
 1, TRUE, 0, 3.14, abc
<a href="#h11-5-3" id="h11-5-3" class="d">-3, TRUE, 1, 0, ABC
</a><a href="#h11-5-4" id="h11-5-4" class="d">-4, NULL, 1, 0, üëç
</a><a href="#h11-5-5" id="h11-5-5" class="i">+3, TRUE, 1, 0.0, ABC
</a><a href="#h11-5-6" id="h11-5-6" class="i">+4, NULL, 1, 0.0, üëç
</a><b>diff --git a/<a id="h12" href="../file/src/sql/testscripts/queries/where_primary_key.html">src/sql/testscripts/queries/where_primary_key</a> b/<a href="../file/src/sql/testscripts/queries/where_primary_key.html">src/sql/testscripts/queries/where_primary_key</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -53,13 +53,13 @@ KeyLookup: float (-2.718)
</a> 
 [plan]&gt; SELECT * FROM &quot;float&quot; WHERE id = -0.0
 ---
<a href="#h12-0-3" id="h12-0-3" class="d">-KeyLookup: float (-0)
</a><a href="#h12-0-4" id="h12-0-4" class="d">-0
</a><a href="#h12-0-5" id="h12-0-5" class="i">+KeyLookup: float (-0.0)
</a><a href="#h12-0-6" id="h12-0-6" class="i">+0.0
</a> 
 [plan]&gt; SELECT * FROM &quot;float&quot; WHERE id = 0.0
 ---
<a href="#h12-0-10" id="h12-0-10" class="d">-KeyLookup: float (0)
</a><a href="#h12-0-11" id="h12-0-11" class="d">-0
</a><a href="#h12-0-12" id="h12-0-12" class="i">+KeyLookup: float (0.0)
</a><a href="#h12-0-13" id="h12-0-13" class="i">+0.0
</a> 
 [plan]&gt; SELECT * FROM &quot;float&quot; WHERE id = 3.14
 ---
<b>diff --git a/<a id="h13" href="../file/src/sql/testscripts/writes/insert_datatypes.html">src/sql/testscripts/writes/insert_datatypes</a> b/<a href="../file/src/sql/testscripts/writes/insert_datatypes.html">src/sql/testscripts/writes/insert_datatypes</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -84,10 +84,10 @@ ok
</a> ---
 1, NULL, NULL, 3.14, NULL
 2, NULL, NULL, -3.14, NULL
<a href="#h13-0-3" id="h13-0-3" class="d">-3, NULL, NULL, 0, NULL
</a><a href="#h13-0-4" id="h13-0-4" class="d">-4, NULL, NULL, 0, NULL
</a><a href="#h13-0-5" id="h13-0-5" class="d">-5, NULL, NULL, 123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000, NULL
</a><a href="#h13-0-6" id="h13-0-6" class="d">-6, NULL, NULL, -123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000, NULL
</a><a href="#h13-0-7" id="h13-0-7" class="i">+3, NULL, NULL, 0.0, NULL
</a><a href="#h13-0-8" id="h13-0-8" class="i">+4, NULL, NULL, 0.0, NULL
</a><a href="#h13-0-9" id="h13-0-9" class="i">+5, NULL, NULL, 1.23456789012345e308, NULL
</a><a href="#h13-0-10" id="h13-0-10" class="i">+6, NULL, NULL, -1.23456789012345e308, NULL
</a> 7, NULL, NULL, inf, NULL
 8, NULL, NULL, -inf, NULL
 9, NULL, NULL, NaN, NULL
<b>diff --git a/<a id="h14" href="../file/src/sql/testscripts/writes/insert_index.html">src/sql/testscripts/writes/insert_index</a> b/<a href="../file/src/sql/testscripts/writes/insert_index.html">src/sql/testscripts/writes/insert_index</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -148,27 +148,27 @@ storage delete mvcc:TxnActive(6) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x06&quot;]
</a> storage set mvcc:NextVersion ‚Üí 8 [&quot;\x00&quot; ‚Üí &quot;\x08&quot;]
 storage set mvcc:TxnActive(7) ‚Üí &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;&quot;]
 storage set mvcc:TxnWrite(7, sql:Row(index, 8)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00&quot; ‚Üí &quot;&quot;]
<a href="#h14-0-3" id="h14-0-3" class="d">-storage set mvcc:Version(sql:Row(index, 8), 7) ‚Üí 8,NULL,NULL,0,NULL [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x0f\x05\x02\x10\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a><a href="#h14-0-4" id="h14-0-4" class="i">+storage set mvcc:Version(sql:Row(index, 8), 7) ‚Üí 8,NULL,NULL,0.0,NULL [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x0f\x05\x02\x10\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a> storage set mvcc:TxnWrite(7, sql:Index(index.bool, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, NULL), 7) ‚Üí 4,5,6,7,8 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x0b\x05\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10&quot;]
 storage set mvcc:TxnWrite(7, sql:Index(index.int, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, NULL), 7) ‚Üí 4,5,6,7,8 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x0b\x05\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10&quot;]
<a href="#h14-0-9" id="h14-0-9" class="d">-storage set mvcc:TxnWrite(7, sql:Index(index.float, 0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h14-0-10" id="h14-0-10" class="d">-storage set mvcc:Version(sql:Index(index.float, 0), 7) ‚Üí 8 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x03\x01\x02\x10&quot;]
</a><a href="#h14-0-11" id="h14-0-11" class="i">+storage set mvcc:TxnWrite(7, sql:Index(index.float, 0.0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h14-0-12" id="h14-0-12" class="i">+storage set mvcc:Version(sql:Index(index.float, 0.0), 7) ‚Üí 8 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x03\x01\x02\x10&quot;]
</a> storage set mvcc:TxnWrite(7, sql:Index(index.string, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.string, NULL), 7) ‚Üí 4,5,6,7,8 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x0b\x05\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10&quot;]
 storage set mvcc:TxnWrite(7, sql:Row(index, 9)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\t\x00\x00&quot; ‚Üí &quot;&quot;]
<a href="#h14-0-16" id="h14-0-16" class="d">-storage set mvcc:Version(sql:Row(index, 9), 7) ‚Üí 9,NULL,NULL,0,NULL [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\t\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x0f\x05\x02\x12\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a><a href="#h14-0-17" id="h14-0-17" class="i">+storage set mvcc:Version(sql:Row(index, 9), 7) ‚Üí 9,NULL,NULL,0.0,NULL [&quot;\x04\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\t\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x0f\x05\x02\x12\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a> storage set mvcc:TxnWrite(7, sql:Index(index.bool, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.bool, NULL), 7) ‚Üí 4,5,6,7,8,9 [&quot;\x04\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\r\x06\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12&quot;]
 storage set mvcc:TxnWrite(7, sql:Index(index.int, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.int, NULL), 7) ‚Üí 4,5,6,7,8,9 [&quot;\x04\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\r\x06\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12&quot;]
<a href="#h14-0-22" id="h14-0-22" class="d">-storage set mvcc:TxnWrite(7, sql:Index(index.float, 0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h14-0-23" id="h14-0-23" class="d">-storage set mvcc:Version(sql:Index(index.float, 0), 7) ‚Üí 8,9 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x05\x02\x02\x10\x02\x12&quot;]
</a><a href="#h14-0-24" id="h14-0-24" class="i">+storage set mvcc:TxnWrite(7, sql:Index(index.float, 0.0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h14-0-25" id="h14-0-25" class="i">+storage set mvcc:Version(sql:Index(index.float, 0.0), 7) ‚Üí 8,9 [&quot;\x04\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\x05\x02\x02\x10\x02\x12&quot;]
</a> storage set mvcc:TxnWrite(7, sql:Index(index.string, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(index.string, NULL), 7) ‚Üí 4,5,6,7,8,9 [&quot;\x04\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07&quot; ‚Üí &quot;\x01\r\x06\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10\x02\x12&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(index.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h14-0-29" id="h14-0-29" class="d">-storage delete mvcc:TxnWrite(7, sql:Index(index.float, 0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h14-0-30" id="h14-0-30" class="i">+storage delete mvcc:TxnWrite(7, sql:Index(index.float, 0.0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(7, sql:Index(index.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Index(index.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x01index\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(7, sql:Row(index, 8)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x07\x02index\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00&quot;]
<b>diff --git a/<a id="h15" href="../file/src/sql/testscripts/writes/insert_primary_key.html">src/sql/testscripts/writes/insert_primary_key</a> b/<a href="../file/src/sql/testscripts/writes/insert_primary_key.html">src/sql/testscripts/writes/insert_primary_key</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -58,11 +58,11 @@ Error: invalid input: invalid primary key NULL
</a> &gt; SELECT * FROM &quot;float&quot;;
 ---
 -inf
<a href="#h15-0-3" id="h15-0-3" class="d">--123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
</a><a href="#h15-0-4" id="h15-0-4" class="i">+-1.23456789012345e308
</a> -3.14
<a href="#h15-0-6" id="h15-0-6" class="d">-0
</a><a href="#h15-0-7" id="h15-0-7" class="i">+0.0
</a> 3.14
<a href="#h15-0-9" id="h15-0-9" class="d">-123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
</a><a href="#h15-0-10" id="h15-0-10" class="i">+1.23456789012345e308
</a> inf
 
 !&gt; INSERT INTO &quot;float&quot; VALUES (3.14)
<a href="#h15-1" id="h15-1" class="h">@@ -78,10 +78,10 @@ inf
</a> ---
 Error: invalid input: primary key 3.14 already exists
 Error: invalid input: primary key -3.14 already exists
<a href="#h15-1-3" id="h15-1-3" class="d">-Error: invalid input: primary key 0 already exists
</a><a href="#h15-1-4" id="h15-1-4" class="d">-Error: invalid input: primary key 0 already exists
</a><a href="#h15-1-5" id="h15-1-5" class="d">-Error: invalid input: primary key 123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 already exists
</a><a href="#h15-1-6" id="h15-1-6" class="d">-Error: invalid input: primary key -123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 already exists
</a><a href="#h15-1-7" id="h15-1-7" class="i">+Error: invalid input: primary key 0.0 already exists
</a><a href="#h15-1-8" id="h15-1-8" class="i">+Error: invalid input: primary key 0.0 already exists
</a><a href="#h15-1-9" id="h15-1-9" class="i">+Error: invalid input: primary key 1.23456789012345e308 already exists
</a><a href="#h15-1-10" id="h15-1-10" class="i">+Error: invalid input: primary key -1.23456789012345e308 already exists
</a> Error: invalid input: primary key inf already exists
 Error: invalid input: primary key -inf already exists
 Error: invalid input: invalid primary key NaN
<b>diff --git a/<a id="h16" href="../file/src/sql/testscripts/writes/insert_reference.html">src/sql/testscripts/writes/insert_reference</a> b/<a href="../file/src/sql/testscripts/writes/insert_reference.html">src/sql/testscripts/writes/insert_reference</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -62,17 +62,17 @@ Error: invalid input: reference bar not in table string
</a> storage set mvcc:NextVersion ‚Üí 16 [&quot;\x00&quot; ‚Üí &quot;\x10&quot;]
 storage set mvcc:TxnActive(15) ‚Üí &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;&quot;]
 storage set mvcc:TxnWrite(15, sql:Row(name, 2)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot; ‚Üí &quot;&quot;]
<a href="#h16-0-3" id="h16-0-3" class="d">-storage set mvcc:Version(sql:Row(name, 2), 15) ‚Üí 2,NULL,NULL,0,NULL [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x0f\x05\x02\x04\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a><a href="#h16-0-4" id="h16-0-4" class="i">+storage set mvcc:Version(sql:Row(name, 2), 15) ‚Üí 2,NULL,NULL,0.0,NULL [&quot;\x04\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x0f\x05\x02\x04\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a> storage set mvcc:TxnWrite(15, sql:Index(name.bool, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.bool, NULL), 15) ‚Üí 2 [&quot;\x04\x01name\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x03\x01\x02\x04&quot;]
 storage set mvcc:TxnWrite(15, sql:Index(name.int, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.int, NULL), 15) ‚Üí 2 [&quot;\x04\x01name\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x03\x01\x02\x04&quot;]
<a href="#h16-0-9" id="h16-0-9" class="d">-storage set mvcc:TxnWrite(15, sql:Index(name.float, 0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h16-0-10" id="h16-0-10" class="d">-storage set mvcc:Version(sql:Index(name.float, 0), 15) ‚Üí 2 [&quot;\x04\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x03\x01\x02\x04&quot;]
</a><a href="#h16-0-11" id="h16-0-11" class="i">+storage set mvcc:TxnWrite(15, sql:Index(name.float, 0.0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h16-0-12" id="h16-0-12" class="i">+storage set mvcc:Version(sql:Index(name.float, 0.0), 15) ‚Üí 2 [&quot;\x04\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x03\x01\x02\x04&quot;]
</a> storage set mvcc:TxnWrite(15, sql:Index(name.string, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(name.string, NULL), 15) ‚Üí 2 [&quot;\x04\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x03\x01\x02\x04&quot;]
 storage delete mvcc:TxnWrite(15, sql:Index(name.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h16-0-16" id="h16-0-16" class="d">-storage delete mvcc:TxnWrite(15, sql:Index(name.float, 0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h16-0-17" id="h16-0-17" class="i">+storage delete mvcc:TxnWrite(15, sql:Index(name.float, 0.0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(15, sql:Index(name.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(15, sql:Index(name.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01name\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(15, sql:Row(name, 2)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x02name\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x02\x00\x00&quot;]
<a href="#h16-1" id="h16-1" class="h">@@ -106,7 +106,7 @@ ok
</a> &gt; SELECT * FROM name
 ---
 1, TRUE, 1, 3.14, foo
<a href="#h16-1-3" id="h16-1-3" class="d">-2, NULL, NULL, 0, NULL
</a><a href="#h16-1-4" id="h16-1-4" class="i">+2, NULL, NULL, 0.0, NULL
</a> 3, NULL, NULL, inf, NULL
 5, NULL, NULL, NULL, 
 6, NULL, NULL, NULL, NULL
<b>diff --git a/<a id="h17" href="../file/src/sql/testscripts/writes/insert_unique.html">src/sql/testscripts/writes/insert_unique</a> b/<a href="../file/src/sql/testscripts/writes/insert_unique.html">src/sql/testscripts/writes/insert_unique</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -157,17 +157,17 @@ storage delete mvcc:TxnActive(11) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0b&quot;]
</a> storage set mvcc:NextVersion ‚Üí 13 [&quot;\x00&quot; ‚Üí &quot;\r&quot;]
 storage set mvcc:TxnActive(12) ‚Üí &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0c&quot; ‚Üí &quot;&quot;]
 storage set mvcc:TxnWrite(12, sql:Row(unique, 8)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00&quot; ‚Üí &quot;&quot;]
<a href="#h17-0-3" id="h17-0-3" class="d">-storage set mvcc:Version(sql:Row(unique, 8), 12) ‚Üí 8,NULL,NULL,0,NULL [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c&quot; ‚Üí &quot;\x01\x0f\x05\x02\x10\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a><a href="#h17-0-4" id="h17-0-4" class="i">+storage set mvcc:Version(sql:Row(unique, 8), 12) ‚Üí 8,NULL,NULL,0.0,NULL [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c&quot; ‚Üí &quot;\x01\x0f\x05\x02\x10\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a> storage set mvcc:TxnWrite(12, sql:Index(unique.bool, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.bool, NULL), 12) ‚Üí 4,5,6,7,8 [&quot;\x04\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c&quot; ‚Üí &quot;\x01\x0b\x05\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10&quot;]
 storage set mvcc:TxnWrite(12, sql:Index(unique.int, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.int, NULL), 12) ‚Üí 4,5,6,7,8 [&quot;\x04\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c&quot; ‚Üí &quot;\x01\x0b\x05\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10&quot;]
<a href="#h17-0-9" id="h17-0-9" class="d">-storage set mvcc:TxnWrite(12, sql:Index(unique.float, 0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h17-0-10" id="h17-0-10" class="d">-storage set mvcc:Version(sql:Index(unique.float, 0), 12) ‚Üí 8 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c&quot; ‚Üí &quot;\x01\x03\x01\x02\x10&quot;]
</a><a href="#h17-0-11" id="h17-0-11" class="i">+storage set mvcc:TxnWrite(12, sql:Index(unique.float, 0.0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h17-0-12" id="h17-0-12" class="i">+storage set mvcc:Version(sql:Index(unique.float, 0.0), 12) ‚Üí 8 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c&quot; ‚Üí &quot;\x01\x03\x01\x02\x10&quot;]
</a> storage set mvcc:TxnWrite(12, sql:Index(unique.string, NULL)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.string, NULL), 12) ‚Üí 4,5,6,7,8 [&quot;\x04\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c&quot; ‚Üí &quot;\x01\x0b\x05\x02\x08\x02\n\x02\x0c\x02\x0e\x02\x10&quot;]
 storage delete mvcc:TxnWrite(12, sql:Index(unique.bool, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xffbool\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
<a href="#h17-0-16" id="h17-0-16" class="d">-storage delete mvcc:TxnWrite(12, sql:Index(unique.float, 0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h17-0-17" id="h17-0-17" class="i">+storage delete mvcc:TxnWrite(12, sql:Index(unique.float, 0.0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(12, sql:Index(unique.int, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xffint\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(12, sql:Index(unique.string, NULL)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x01unique\x00\xff\x00\xffstring\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(12, sql:Row(unique, 8)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0c\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x08\x00\x00&quot;]
<a href="#h17-1" id="h17-1" class="h">@@ -175,7 +175,7 @@ storage delete mvcc:TxnActive(12) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0c&quot;]
</a> 
 !&gt; INSERT INTO &quot;unique&quot; (id, &quot;float&quot;) VALUES (9, 0.0)
 ---
<a href="#h17-1-3" id="h17-1-3" class="d">-Error: invalid input: value 0 already in unique column float
</a><a href="#h17-1-4" id="h17-1-4" class="i">+Error: invalid input: value 0.0 already in unique column float
</a> 
 # Float INFINITY is also unique.
 [ops]&gt; INSERT INTO &quot;unique&quot; (id, &quot;float&quot;) VALUES (10, INFINITY)
<b>diff --git a/<a id="h18" href="../file/src/sql/testscripts/writes/update_datatypes.html">src/sql/testscripts/writes/update_datatypes</a> b/<a href="../file/src/sql/testscripts/writes/update_datatypes.html">src/sql/testscripts/writes/update_datatypes</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -70,8 +70,8 @@ Error: invalid input: invalid datatype STRING for INTEGER column int
</a> ---
 NaN
 NaN
<a href="#h18-0-3" id="h18-0-3" class="d">-0
</a><a href="#h18-0-4" id="h18-0-4" class="d">-0
</a><a href="#h18-0-5" id="h18-0-5" class="i">+0.0
</a><a href="#h18-0-6" id="h18-0-6" class="i">+0.0
</a> 
 # Strings.
 &gt; UPDATE datatypes SET &quot;string&quot; = NULL
<a href="#h18-1" id="h18-1" class="h">@@ -81,7 +81,7 @@ NaN
</a> &gt; UPDATE datatypes SET &quot;string&quot; = &#39;Hi! üëã&#39;
 &gt; SELECT * FROM datatypes
 ---
<a href="#h18-1-3" id="h18-1-3" class="d">-1, TRUE, -9223372036854775807, 0, Hi! üëã
</a><a href="#h18-1-4" id="h18-1-4" class="i">+1, TRUE, -9223372036854775807, 0.0, Hi! üëã
</a> 
 !&gt; UPDATE datatypes SET &quot;string&quot; = false
 !&gt; UPDATE datatypes SET &quot;string&quot; = 3
<b>diff --git a/<a id="h19" href="../file/src/sql/testscripts/writes/update_primary_key.html">src/sql/testscripts/writes/update_primary_key</a> b/<a href="../file/src/sql/testscripts/writes/update_primary_key.html">src/sql/testscripts/writes/update_primary_key</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -67,10 +67,10 @@ Error: invalid input: primary key 2 already exists
</a> ---
 3.14
 -3.14
<a href="#h19-0-3" id="h19-0-3" class="d">-0
</a><a href="#h19-0-4" id="h19-0-4" class="d">-0
</a><a href="#h19-0-5" id="h19-0-5" class="d">-123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
</a><a href="#h19-0-6" id="h19-0-6" class="d">--123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
</a><a href="#h19-0-7" id="h19-0-7" class="i">+0.0
</a><a href="#h19-0-8" id="h19-0-8" class="i">+0.0
</a><a href="#h19-0-9" id="h19-0-9" class="i">+1.23456789012345e308
</a><a href="#h19-0-10" id="h19-0-10" class="i">+-1.23456789012345e308
</a> inf
 -inf
 
<a href="#h19-1" id="h19-1" class="h">@@ -79,7 +79,7 @@ inf
</a> &gt; SELECT * FROM &quot;float&quot;
 ---
 -inf
<a href="#h19-1-3" id="h19-1-3" class="d">-0
</a><a href="#h19-1-4" id="h19-1-4" class="i">+0.0
</a> 
 !&gt; UPDATE &quot;float&quot; SET id = 3.14
 !&gt; UPDATE &quot;float&quot; SET id = -3.14
<a href="#h19-2" id="h19-2" class="h">@@ -94,10 +94,10 @@ inf
</a> ---
 Error: invalid input: primary key 3.14 already exists
 Error: invalid input: primary key -3.14 already exists
<a href="#h19-2-3" id="h19-2-3" class="d">-Error: invalid input: primary key 0 already exists
</a><a href="#h19-2-4" id="h19-2-4" class="d">-Error: invalid input: primary key 0 already exists
</a><a href="#h19-2-5" id="h19-2-5" class="d">-Error: invalid input: primary key 123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 already exists
</a><a href="#h19-2-6" id="h19-2-6" class="d">-Error: invalid input: primary key -123456789012345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 already exists
</a><a href="#h19-2-7" id="h19-2-7" class="i">+Error: invalid input: primary key 0.0 already exists
</a><a href="#h19-2-8" id="h19-2-8" class="i">+Error: invalid input: primary key 0.0 already exists
</a><a href="#h19-2-9" id="h19-2-9" class="i">+Error: invalid input: primary key 1.23456789012345e308 already exists
</a><a href="#h19-2-10" id="h19-2-10" class="i">+Error: invalid input: primary key -1.23456789012345e308 already exists
</a> Error: invalid input: primary key inf already exists
 Error: invalid input: primary key -inf already exists
 Error: invalid input: invalid primary key NaN
<b>diff --git a/<a id="h20" href="../file/src/sql/testscripts/writes/update_unique.html">src/sql/testscripts/writes/update_unique</a> b/<a href="../file/src/sql/testscripts/writes/update_unique.html">src/sql/testscripts/writes/update_unique</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -67,7 +67,7 @@ Error: invalid input: value a already in unique column string
</a> ---
 Error: invalid input: value FALSE already in unique column bool
 Error: invalid input: value 7 already in unique column int
<a href="#h20-0-3" id="h20-0-3" class="d">-Error: invalid input: value 0 already in unique column float
</a><a href="#h20-0-4" id="h20-0-4" class="i">+Error: invalid input: value 0.0 already in unique column float
</a> Error: invalid input: value abc already in unique column string
 
 # Updates with NULLS sets NULL entries. Duplicates are allowed.
<a href="#h20-1" id="h20-1" class="h">@@ -168,19 +168,19 @@ storage set mvcc:NextVersion ‚Üí 16 [&quot;\x00&quot; ‚Üí &quot;\x10&quot;]
</a> storage set mvcc:TxnActive(15) ‚Üí &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;&quot;]
 storage set mvcc:TxnWrite(15, sql:Index(unique.float, NaN)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xff\xf8\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, NaN), 15) ‚Üí 2 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xff\xf8\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x03\x01\x02\x04&quot;]
<a href="#h20-1-3" id="h20-1-3" class="d">-storage set mvcc:TxnWrite(15, sql:Index(unique.float, 0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h20-1-4" id="h20-1-4" class="d">-storage set mvcc:Version(sql:Index(unique.float, 0), 15) ‚Üí 1 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x03\x01\x02\x02&quot;]
</a><a href="#h20-1-5" id="h20-1-5" class="i">+storage set mvcc:TxnWrite(15, sql:Index(unique.float, 0.0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h20-1-6" id="h20-1-6" class="i">+storage set mvcc:Version(sql:Index(unique.float, 0.0), 15) ‚Üí 1 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x03\x01\x02\x02&quot;]
</a> storage set mvcc:TxnWrite(15, sql:Row(unique, 1)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; ‚Üí &quot;&quot;]
<a href="#h20-1-8" id="h20-1-8" class="d">-storage set mvcc:Version(sql:Row(unique, 1), 15) ‚Üí 1,NULL,NULL,0,NULL [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x0f\x05\x02\x02\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a><a href="#h20-1-9" id="h20-1-9" class="d">-storage delete mvcc:TxnWrite(15, sql:Index(unique.float, 0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h20-1-10" id="h20-1-10" class="i">+storage set mvcc:Version(sql:Row(unique, 1), 15) ‚Üí 1,NULL,NULL,0.0,NULL [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0f&quot; ‚Üí &quot;\x01\x0f\x05\x02\x02\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;]
</a><a href="#h20-1-11" id="h20-1-11" class="i">+storage delete mvcc:TxnWrite(15, sql:Index(unique.float, 0.0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(15, sql:Index(unique.float, NaN)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xff\xf8\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(15, sql:Row(unique, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x0f\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(15) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x0f&quot;]
<a href="#h20-1-15" id="h20-1-15" class="d">-Error: invalid input: value 0 already in unique column float
</a><a href="#h20-1-16" id="h20-1-16" class="i">+Error: invalid input: value 0.0 already in unique column float
</a> 
 &gt; SELECT * FROM &quot;unique&quot;
 ---
<a href="#h20-1-20" id="h20-1-20" class="d">-1, NULL, NULL, 0, NULL
</a><a href="#h20-1-21" id="h20-1-21" class="i">+1, NULL, NULL, 0.0, NULL
</a> 2, NULL, NULL, NaN, NULL
 
 # Float INFINITY is considered equal.
<a href="#h20-2" id="h20-2" class="h">@@ -189,13 +189,13 @@ Error: invalid input: value 0 already in unique column float
</a> ---
 storage set mvcc:NextVersion ‚Üí 18 [&quot;\x00&quot; ‚Üí &quot;\x12&quot;]
 storage set mvcc:TxnActive(17) ‚Üí &quot;&quot; [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x11&quot; ‚Üí &quot;&quot;]
<a href="#h20-2-3" id="h20-2-3" class="d">-storage set mvcc:TxnWrite(17, sql:Index(unique.float, 0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x11\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h20-2-4" id="h20-2-4" class="d">-storage set mvcc:Version(sql:Index(unique.float, 0), 17) ‚Üí None [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11&quot; ‚Üí &quot;\x00&quot;]
</a><a href="#h20-2-5" id="h20-2-5" class="i">+storage set mvcc:TxnWrite(17, sql:Index(unique.float, 0.0)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x11\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
</a><a href="#h20-2-6" id="h20-2-6" class="i">+storage set mvcc:Version(sql:Index(unique.float, 0.0), 17) ‚Üí None [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11&quot; ‚Üí &quot;\x00&quot;]
</a> storage set mvcc:TxnWrite(17, sql:Index(unique.float, inf)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x11\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xff\xf0\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Index(unique.float, inf), 17) ‚Üí 1 [&quot;\x04\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xff\xf0\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11&quot; ‚Üí &quot;\x01\x03\x01\x02\x02&quot;]
 storage set mvcc:TxnWrite(17, sql:Row(unique, 1)) ‚Üí &quot;&quot; [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x11\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot; ‚Üí &quot;&quot;]
 storage set mvcc:Version(sql:Row(unique, 1), 17) ‚Üí 1,NULL,NULL,inf,NULL [&quot;\x04\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11&quot; ‚Üí &quot;\x01\x0f\x05\x02\x02\x00\x00\x03\x00\x00\x00\x00\x00\x00\xf0\x7f\x00&quot;]
<a href="#h20-2-11" id="h20-2-11" class="d">-storage delete mvcc:TxnWrite(17, sql:Index(unique.float, 0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x11\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a><a href="#h20-2-12" id="h20-2-12" class="i">+storage delete mvcc:TxnWrite(17, sql:Index(unique.float, 0.0)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x11\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
</a> storage delete mvcc:TxnWrite(17, sql:Index(unique.float, inf)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x11\x01unique\x00\xff\x00\xfffloat\x00\xff\x00\xff\x03\xff\xf0\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\x00&quot;]
 storage delete mvcc:TxnWrite(17, sql:Row(unique, 1)) [&quot;\x03\x00\x00\x00\x00\x00\x00\x00\x11\x02unique\x00\xff\x00\xff\x02\x80\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x00\xff\x01\x00\x00&quot;]
 storage delete mvcc:TxnActive(17) [&quot;\x01\x00\x00\x00\x00\x00\x00\x00\x11&quot;]
<b>diff --git a/<a id="h21" href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a> b/<a href="../file/src/sql/types/value.rs.html">src/sql/types/value.rs</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -287,8 +287,8 @@ impl std::fmt::Display for Value {
</a>             Self::Boolean(true) =&gt; f.write_str(&quot;TRUE&quot;),
             Self::Boolean(false) =&gt; f.write_str(&quot;FALSE&quot;),
             Self::Integer(integer) =&gt; integer.fmt(f),
<a href="#h21-0-3" id="h21-0-3" class="d">-            Self::Float(float) =&gt; float.fmt(f),
</a><a href="#h21-0-4" id="h21-0-4" class="d">-            Self::String(string) =&gt; f.write_str(string),
</a><a href="#h21-0-5" id="h21-0-5" class="i">+            Self::Float(float) =&gt; write!(f, &quot;{float:?}&quot;),
</a><a href="#h21-0-6" id="h21-0-6" class="i">+            Self::String(string) =&gt; string.fmt(f),
</a>         }
     }
 }
</pre>
</div>
</body>
</html>
