<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: restructured execution engine. - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/fe8f3221529ca985ef11757506352c35600907f0.html">fe8f3221529ca985ef11757506352c35600907f0</a>
<b>parent</b> <a href="../commit/84e5033d540fa2e2785e1f386081220ada5020b3.html">84e5033d540fa2e2785e1f386081220ada5020b3</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sun,  8 Sep 2019 13:41:57 +0200

sql: restructured execution engine.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">Cargo.lock</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">Cargo.toml</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">README.md</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/kv/file.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/kv/memory.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/kv/mod.rs</a></td><td> | </td><td class="num">12</td><td><span class="i">+++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/kv/raft.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/lib.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/server/toydb.rs</a></td><td> | </td><td class="num">43</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">---------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h9">src/sql/expression.rs</a></td><td> | </td><td class="num">181</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/mod.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/parser/ast.rs</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">18</td><td><span class="i">+++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="A">A</td><td><a href="#h13">src/sql/plan/create_table.rs</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h14">src/sql/plan/drop_table.rs</a></td><td> | </td><td class="num">29</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h15">src/sql/plan/expression.rs</a></td><td> | </td><td class="num">181</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h16">src/sql/plan/insert.rs</a></td><td> | </td><td class="num">38</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/sql/plan/mod.rs</a></td><td> | </td><td class="num">227</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h18">src/sql/plan/node.rs</a></td><td> | </td><td class="num">82</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h19">src/sql/plan/nothing.rs</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h20">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">162</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h21">src/sql/plan/projection.rs</a></td><td> | </td><td class="num">35</td><td><span class="i">+++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h22">src/sql/plan/scan.rs</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">src/sql/storage.rs</a></td><td> | </td><td class="num">22</td><td><span class="i">++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h24">src/sql/testdata/create_table</a></td><td> | </td><td class="num">166</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h25">src/sql/testdata/create_table/ast</a></td><td> | </td><td class="num">46</td><td><span class="i"></span><span class="d">----------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h26">src/sql/testdata/create_table/plan</a></td><td> | </td><td class="num">45</td><td><span class="i"></span><span class="d">---------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h27">src/sql/testdata/create_table/query.sql</a></td><td> | </td><td class="num">10</td><td><span class="i"></span><span class="d">----------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h28">src/sql/testdata/create_table/tokens</a></td><td> | </td><td class="num">70</td><td><span class="i"></span><span class="d">----------------------------------------------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h29">src/sql/testdata/create_table_error_bare</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h30">src/sql/testdata/create_table_error_bare/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h31">src/sql/testdata/create_table_error_bare/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h32">src/sql/testdata/create_table_error_bare/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h33">src/sql/testdata/create_table_error_bare/tokens</a></td><td> | </td><td class="num">9</td><td><span class="i"></span><span class="d">---------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h34">src/sql/testdata/create_table_error_empty_columns</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h35">src/sql/testdata/create_table_error_empty_columns/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h36">src/sql/testdata/create_table_error_empty_columns/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h37">src/sql/testdata/create_table_error_empty_columns/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h38">src/sql/testdata/create_table_error_empty_columns/tokens</a></td><td> | </td><td class="num">14</td><td><span class="i"></span><span class="d">--------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h39">src/sql/testdata/create_table_error_exists</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h40">src/sql/testdata/create_table_error_multiple_primary_key</a></td><td> | </td><td class="num">38</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h41">src/sql/testdata/create_table_error_multiple_primary_key/ast</a></td><td> | </td><td class="num">18</td><td><span class="i"></span><span class="d">------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h42">src/sql/testdata/create_table_error_multiple_primary_key/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h43">src/sql/testdata/create_table_error_multiple_primary_key/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h44">src/sql/testdata/create_table_error_multiple_primary_key/tokens</a></td><td> | </td><td class="num">39</td><td><span class="i"></span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h45">src/sql/testdata/create_table_error_no_columns</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h46">src/sql/testdata/create_table_error_no_columns/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h47">src/sql/testdata/create_table_error_no_columns/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h48">src/sql/testdata/create_table_error_no_columns/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h49">src/sql/testdata/create_table_error_no_columns/tokens</a></td><td> | </td><td class="num">12</td><td><span class="i"></span><span class="d">------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h50">src/sql/testdata/create_table_error_no_datatype</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h51">src/sql/testdata/create_table_error_no_datatype/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h52">src/sql/testdata/create_table_error_no_datatype/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h53">src/sql/testdata/create_table_error_no_datatype/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h54">src/sql/testdata/create_table_error_no_datatype/tokens</a></td><td> | </td><td class="num">17</td><td><span class="i"></span><span class="d">-----------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h55">src/sql/testdata/create_table_error_no_name</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h56">src/sql/testdata/create_table_error_no_name/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h57">src/sql/testdata/create_table_error_no_name/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h58">src/sql/testdata/create_table_error_no_name/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h59">src/sql/testdata/create_table_error_no_name/tokens</a></td><td> | </td><td class="num">17</td><td><span class="i"></span><span class="d">-----------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h60">src/sql/testdata/create_table_error_no_primary_key</a></td><td> | </td><td class="num">25</td><td><span class="i">+++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h61">src/sql/testdata/create_table_error_no_primary_key/ast</a></td><td> | </td><td class="num">12</td><td><span class="i"></span><span class="d">------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h62">src/sql/testdata/create_table_error_no_primary_key/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h63">src/sql/testdata/create_table_error_no_primary_key/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h64">src/sql/testdata/create_table_error_no_primary_key/tokens</a></td><td> | </td><td class="num">20</td><td><span class="i"></span><span class="d">--------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h65">src/sql/testdata/create_table_single_column</a></td><td> | </td><td class="num">68</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h66">src/sql/testdata/create_table_single_column/ast</a></td><td> | </td><td class="num">12</td><td><span class="i"></span><span class="d">------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h67">src/sql/testdata/create_table_single_column/plan</a></td><td> | </td><td class="num">20</td><td><span class="i"></span><span class="d">--------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h68">src/sql/testdata/create_table_single_column/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h69">src/sql/testdata/create_table_single_column/tokens</a></td><td> | </td><td class="num">26</td><td><span class="i"></span><span class="d">--------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h70">src/sql/testdata/drop_table</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h71">src/sql/testdata/drop_table/ast</a></td><td> | </td><td class="num">4</td><td><span class="i"></span><span class="d">----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h72">src/sql/testdata/drop_table/plan</a></td><td> | </td><td class="num">10</td><td><span class="i"></span><span class="d">----------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h73">src/sql/testdata/drop_table/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h74">src/sql/testdata/drop_table/tokens</a></td><td> | </td><td class="num">12</td><td><span class="i"></span><span class="d">------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h75">src/sql/testdata/drop_table_error_bare</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h76">src/sql/testdata/drop_table_error_bare/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h77">src/sql/testdata/drop_table_error_bare/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h78">src/sql/testdata/drop_table_error_bare/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h79">src/sql/testdata/drop_table_error_bare/tokens</a></td><td> | </td><td class="num">9</td><td><span class="i"></span><span class="d">---------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h80">src/sql/testdata/expr_datatypes</a></td><td> | </td><td class="num">128</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h81">src/sql/testdata/expr_literal_numbers</a></td><td> | </td><td class="num">203</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h82">src/sql/testdata/expr_literal_string_quotes</a></td><td> | </td><td class="num">62</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h83">src/sql/testdata/select_aliases</a></td><td> | </td><td class="num">97</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h84">src/sql/testdata/select_all_from_table</a></td><td> | </td><td class="num">54</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h85">src/sql/testdata/select_alone_aliases/ast</a></td><td> | </td><td class="num">31</td><td><span class="i"></span><span class="d">-------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h86">src/sql/testdata/select_alone_aliases/plan</a></td><td> | </td><td class="num">35</td><td><span class="i"></span><span class="d">-----------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h87">src/sql/testdata/select_alone_aliases/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h88">src/sql/testdata/select_alone_aliases/tokens</a></td><td> | </td><td class="num">26</td><td><span class="i"></span><span class="d">--------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h89">src/sql/testdata/select_alone_datatypes/ast</a></td><td> | </td><td class="num">43</td><td><span class="i"></span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h90">src/sql/testdata/select_alone_datatypes/plan</a></td><td> | </td><td class="num">54</td><td><span class="i"></span><span class="d">------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h91">src/sql/testdata/select_alone_datatypes/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h92">src/sql/testdata/select_alone_datatypes/tokens</a></td><td> | </td><td class="num">29</td><td><span class="i"></span><span class="d">-----------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h93">src/sql/testdata/select_alone_literal_numbers/ast</a></td><td> | </td><td class="num">79</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h94">src/sql/testdata/select_alone_literal_numbers/plan</a></td><td> | </td><td class="num">85</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h95">src/sql/testdata/select_alone_literal_numbers/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h96">src/sql/testdata/select_alone_literal_numbers/tokens</a></td><td> | </td><td class="num">46</td><td><span class="i"></span><span class="d">----------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h97">src/sql/testdata/select_alone_literal_string_quotes/ast</a></td><td> | </td><td class="num">15</td><td><span class="i"></span><span class="d">---------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h98">src/sql/testdata/select_alone_literal_string_quotes/plan</a></td><td> | </td><td class="num">21</td><td><span class="i"></span><span class="d">---------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h99">src/sql/testdata/select_alone_literal_string_quotes/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h100">src/sql/testdata/select_alone_literal_string_quotes/tokens</a></td><td> | </td><td class="num">9</td><td><span class="i"></span><span class="d">---------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h101">src/sql/testdata/select_error_bare</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h102">src/sql/testdata/select_error_bare/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h103">src/sql/testdata/select_error_bare/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h104">src/sql/testdata/select_error_bare/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h105">src/sql/testdata/select_error_bare/tokens</a></td><td> | </td><td class="num">6</td><td><span class="i"></span><span class="d">------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h106">src/sql/testdata/select_error_bare_as</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h107">src/sql/testdata/select_error_bare_as/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h108">src/sql/testdata/select_error_bare_as/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h109">src/sql/testdata/select_error_bare_as/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h110">src/sql/testdata/select_error_bare_as/tokens</a></td><td> | </td><td class="num">16</td><td><span class="i"></span><span class="d">----------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h111">src/sql/testdata/select_error_bare_from</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h112">src/sql/testdata/select_error_from_bare/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h113">src/sql/testdata/select_error_from_bare/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h114">src/sql/testdata/select_error_from_bare/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h115">src/sql/testdata/select_error_from_bare/tokens</a></td><td> | </td><td class="num">12</td><td><span class="i"></span><span class="d">------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h116">src/sql/testdata/select_error_trailing_comma</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h117">src/sql/testdata/select_error_trailing_comma/ast</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h118">src/sql/testdata/select_error_trailing_comma/plan</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h119">src/sql/testdata/select_error_trailing_comma/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="D">D</td><td><a href="#h120">src/sql/testdata/select_error_trailing_comma/tokens</a></td><td> | </td><td class="num">14</td><td><span class="i"></span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h121">src/sql/tests.rs</a></td><td> | </td><td class="num">183</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------------</span></td></tr>
</table></pre><pre>122 files changed, 1865 insertions(+), 1534 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/Cargo.lock.html">Cargo.lock</a> b/<a href="../file/Cargo.lock.html">Cargo.lock</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -231,6 +231,16 @@ dependencies = [
</a> ]
 
 [[package]]
<a href="#h0-0-3" id="h0-0-3" class="i">+name = &quot;derivative&quot;
</a><a href="#h0-0-4" id="h0-0-4" class="i">+version = &quot;1.0.3&quot;
</a><a href="#h0-0-5" id="h0-0-5" class="i">+source = &quot;registry+https://github.com/rust-lang/crates.io-index&quot;
</a><a href="#h0-0-6" id="h0-0-6" class="i">+dependencies = [
</a><a href="#h0-0-7" id="h0-0-7" class="i">+ &quot;proc-macro2 0.4.30 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
</a><a href="#h0-0-8" id="h0-0-8" class="i">+ &quot;quote 0.6.12 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
</a><a href="#h0-0-9" id="h0-0-9" class="i">+ &quot;syn 0.15.34 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
</a><a href="#h0-0-10" id="h0-0-10" class="i">+]
</a><a href="#h0-0-11" id="h0-0-11" class="i">+
</a><a href="#h0-0-12" id="h0-0-12" class="i">+[[package]]
</a> name = &quot;difference&quot;
 version = &quot;2.0.0&quot;
 source = &quot;registry+https://github.com/rust-lang/crates.io-index&quot;
<a href="#h0-1" id="h0-1" class="h">@@ -1424,6 +1434,7 @@ dependencies = [
</a>  &quot;clap 2.33.0 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
  &quot;config 0.9.3 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
  &quot;crossbeam-channel 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
<a href="#h0-1-3" id="h0-1-3" class="i">+ &quot;derivative 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
</a>  &quot;goldenfile 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
  &quot;grpc 0.6.1 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
  &quot;httpbis 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)&quot;,
<a href="#h0-2" id="h0-2" class="h">@@ -1581,6 +1592,7 @@ dependencies = [
</a> &quot;checksum crossbeam-epoch 0.7.1 (registry+https://github.com/rust-lang/crates.io-index)&quot; = &quot;04c9e3102cc2d69cd681412141b390abd55a362afc1540965dad0ad4d34280b4&quot;
 &quot;checksum crossbeam-queue 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)&quot; = &quot;7c979cd6cfe72335896575c6b5688da489e420d36a27a0b9eb0c73db574b4a4b&quot;
 &quot;checksum crossbeam-utils 0.6.5 (registry+https://github.com/rust-lang/crates.io-index)&quot; = &quot;f8306fcef4a7b563b76b7dd949ca48f52bc1141aa067d2ea09565f3e2652aa5c&quot;
<a href="#h0-2-3" id="h0-2-3" class="i">+&quot;checksum derivative 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)&quot; = &quot;942ca430eef7a3806595a6737bc388bf51adb888d3fc0dd1b50f1c170167ee3a&quot;
</a> &quot;checksum difference 2.0.0 (registry+https://github.com/rust-lang/crates.io-index)&quot; = &quot;524cbf6897b527295dff137cec09ecf3a05f4fddffd7dfcd1585403449e74198&quot;
 &quot;checksum dirs 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)&quot; = &quot;3fd78930633bd1c6e35c4b42b1df7b0cbc6bc191146e512bb3bedf243fcc3901&quot;
 &quot;checksum dirs 2.0.2 (registry+https://github.com/rust-lang/crates.io-index)&quot; = &quot;13aea89a5c93364a98e9b37b2fa237effbb694d5cfe01c5b70941f7eb087d5e3&quot;
<b>diff --git a/<a id="h1" href="../file/Cargo.toml.html">Cargo.toml</a> b/<a href="../file/Cargo.toml.html">Cargo.toml</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -10,6 +10,7 @@ default-run = &quot;toydb&quot;
</a> clap = &quot;~2.33.0&quot;
 config = &quot;~0.9.3&quot;
 crossbeam-channel = &quot;~0.3.8&quot;
<a href="#h1-0-3" id="h1-0-3" class="i">+derivative = &quot;~1.0.3&quot;
</a> grpc = &quot;~0.6.1&quot;
 log = &quot;~0.4.6&quot;
 protobuf = &quot;~2.5.0&quot;
<b>diff --git a/<a id="h2" href="../file/README.md.html">README.md</a> b/<a href="../file/README.md.html">README.md</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -19,8 +19,13 @@ by running:
</a> 
 ```
 $ cargo run --bin toysql
<a href="#h2-0-3" id="h2-0-3" class="d">-Connected to node &quot;toydb&quot; (version 0.1.0). Enter !help for instructions.
</a><a href="#h2-0-4" id="h2-0-4" class="d">-toydb&gt; 
</a><a href="#h2-0-5" id="h2-0-5" class="i">+Connected to node &quot;toydb-e&quot; (version 0.1.0). Enter !help for instructions.
</a><a href="#h2-0-6" id="h2-0-6" class="i">+toydb&gt; CREATE TABLE movie (id INTEGER PRIMARY KEY, title VARCHAR NOT NULL)
</a><a href="#h2-0-7" id="h2-0-7" class="i">+toydb&gt; INSERT INTO movie VALUES (1, &#39;Sicario&#39;), (2, &#39;Stalker&#39;), (3, &#39;Her&#39;)
</a><a href="#h2-0-8" id="h2-0-8" class="i">+toydb&gt; SELECT * FROM movie
</a><a href="#h2-0-9" id="h2-0-9" class="i">+1|Sicario
</a><a href="#h2-0-10" id="h2-0-10" class="i">+2|Stalker
</a><a href="#h2-0-11" id="h2-0-11" class="i">+3|Her
</a> ```
 
 ## Project Outline
<b>diff --git a/<a id="h3" href="../file/src/kv/file.rs.html">src/kv/file.rs</a> b/<a href="../file/src/kv/file.rs.html">src/kv/file.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h3-0-0" id="h3-0-0" class="d">-use super::{Iter, Pair, Store};
</a><a href="#h3-0-1" id="h3-0-1" class="i">+use super::{Iter, Range, Store};
</a> use crate::Error;
 use std::collections::BTreeMap;
 use std::io::Seek;
<a href="#h3-1" id="h3-1" class="h">@@ -42,7 +42,7 @@ impl Store for File {
</a>         Ok(self.data.get(key).cloned())
     }
 
<a href="#h3-1-3" id="h3-1-3" class="d">-    fn iter_prefix(&amp;self, prefix: &amp;str) -&gt; Box&lt;dyn Iterator&lt;Item = Result&lt;Pair, Error&gt;&gt;&gt; {
</a><a href="#h3-1-4" id="h3-1-4" class="i">+    fn iter_prefix(&amp;self, prefix: &amp;str) -&gt; Box&lt;Range&gt; {
</a>         let from = prefix.to_string();
         let to = from.clone() + &amp;std::char::MAX.to_string();
         Box::new(Iter::from(self.data.range(from..to)))
<b>diff --git a/<a id="h4" href="../file/src/kv/memory.rs.html">src/kv/memory.rs</a> b/<a href="../file/src/kv/memory.rs.html">src/kv/memory.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h4-0-0" id="h4-0-0" class="d">-use super::{Iter, Pair, Store};
</a><a href="#h4-0-1" id="h4-0-1" class="i">+use super::{Iter, Range, Store};
</a> use crate::Error;
 use std::collections::BTreeMap;
 use std::sync::{Arc, RwLock};
<a href="#h4-1" id="h4-1" class="h">@@ -28,7 +28,7 @@ impl Store for Memory {
</a>         Ok(self.data.read()?.get(key).cloned())
     }
 
<a href="#h4-1-3" id="h4-1-3" class="d">-    fn iter_prefix(&amp;self, prefix: &amp;str) -&gt; Box&lt;dyn Iterator&lt;Item = Result&lt;Pair, Error&gt;&gt;&gt; {
</a><a href="#h4-1-4" id="h4-1-4" class="i">+    fn iter_prefix(&amp;self, prefix: &amp;str) -&gt; Box&lt;Range&gt; {
</a>         let from = prefix.to_string();
         let to = from.clone() + &amp;std::char::MAX.to_string();
         Box::new(Iter::from(self.data.read().unwrap().range(from..to)))
<b>diff --git a/<a id="h5" href="../file/src/kv/mod.rs.html">src/kv/mod.rs</a> b/<a href="../file/src/kv/mod.rs.html">src/kv/mod.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -9,7 +9,7 @@ pub use file::File;
</a> pub use memory::Memory;
 pub use raft::Raft;
 
<a href="#h5-0-3" id="h5-0-3" class="d">-type Pair = (String, Vec&lt;u8&gt;);
</a><a href="#h5-0-4" id="h5-0-4" class="i">+type Range = dyn Iterator&lt;Item = Result&lt;(String, Vec&lt;u8&gt;), Error&gt;&gt; + Sync + Send;
</a> 
 /// A key-value store
 pub trait Store: &#39;static + Sync + Send + std::fmt::Debug {
<a href="#h5-1" id="h5-1" class="h">@@ -20,7 +20,7 @@ pub trait Store: &#39;static + Sync + Send + std::fmt::Debug {
</a>     fn get(&amp;self, key: &amp;str) -&gt; Result&lt;Option&lt;Vec&lt;u8&gt;&gt;, Error&gt;;
 
     /// Returns an iterator over all pairs in the store under a key prefix
<a href="#h5-1-3" id="h5-1-3" class="d">-    fn iter_prefix(&amp;self, prefix: &amp;str) -&gt; Box&lt;dyn Iterator&lt;Item = Result&lt;Pair, Error&gt;&gt;&gt;;
</a><a href="#h5-1-4" id="h5-1-4" class="i">+    fn iter_prefix(&amp;self, prefix: &amp;str) -&gt; Box&lt;Range&gt;;
</a> 
     /// Sets a value in the store
     fn set(&amp;mut self, key: &amp;str, value: Vec&lt;u8&gt;) -&gt; Result&lt;(), Error&gt;;
<a href="#h5-2" id="h5-2" class="h">@@ -29,7 +29,7 @@ pub trait Store: &#39;static + Sync + Send + std::fmt::Debug {
</a> /// This is a terrible, temporary iterator implementation which is prepopulated
 /// with all data, to avoid having to deal with trait lifetimes right now.
 struct Iter {
<a href="#h5-2-3" id="h5-2-3" class="d">-    stack: Vec&lt;Result&lt;Pair, Error&gt;&gt;,
</a><a href="#h5-2-4" id="h5-2-4" class="i">+    stack: Vec&lt;Result&lt;(String, Vec&lt;u8&gt;), Error&gt;&gt;,
</a> }
 
 impl Iter {
<a href="#h5-3" id="h5-3" class="h">@@ -41,14 +41,12 @@ impl Iter {
</a>     }
 
     fn from_vec(vec: Vec&lt;(String, Vec&lt;u8&gt;)&gt;) -&gt; Self {
<a href="#h5-3-3" id="h5-3-3" class="d">-        Self{
</a><a href="#h5-3-4" id="h5-3-4" class="d">-            stack: vec.into_iter().map(Ok).rev().collect(),
</a><a href="#h5-3-5" id="h5-3-5" class="d">-        }
</a><a href="#h5-3-6" id="h5-3-6" class="i">+        Self { stack: vec.into_iter().map(Ok).rev().collect() }
</a>     }
 }
 
 impl Iterator for Iter {
<a href="#h5-3-11" id="h5-3-11" class="d">-    type Item = Result&lt;Pair, Error&gt;;
</a><a href="#h5-3-12" id="h5-3-12" class="i">+    type Item = Result&lt;(String, Vec&lt;u8&gt;), Error&gt;;
</a> 
     fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
         self.stack.pop()
<b>diff --git a/<a id="h6" href="../file/src/kv/raft.rs.html">src/kv/raft.rs</a> b/<a href="../file/src/kv/raft.rs.html">src/kv/raft.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h6-0-0" id="h6-0-0" class="d">-use super::{Iter, Pair, Store};
</a><a href="#h6-0-1" id="h6-0-1" class="i">+use super::{Iter, Range, Store};
</a> use crate::raft;
 use crate::utility::{deserialize, serialize};
 use crate::Error;
<a href="#h6-1" id="h6-1" class="h">@@ -38,7 +38,7 @@ impl Store for Raft {
</a>         Ok(deserialize(self.raft.read(serialize(Read::Get(key.to_string()))?)?)?)
     }
 
<a href="#h6-1-3" id="h6-1-3" class="d">-    fn iter_prefix(&amp;self, prefix: &amp;str) -&gt; Box&lt;dyn Iterator&lt;Item = Result&lt;Pair, Error&gt;&gt;&gt; {
</a><a href="#h6-1-4" id="h6-1-4" class="i">+    fn iter_prefix(&amp;self, prefix: &amp;str) -&gt; Box&lt;Range&gt; {
</a>         let items: Vec&lt;(String, Vec&lt;u8&gt;)&gt; = deserialize(
             self.raft.read(serialize(Read::GetPrefix(prefix.to_string())).unwrap()).unwrap(),
         )
<b>diff --git a/<a id="h7" href="../file/src/lib.rs.html">src/lib.rs</a> b/<a href="../file/src/lib.rs.html">src/lib.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -6,6 +6,8 @@ extern crate assert_matches;
</a> extern crate config;
 #[macro_use(select)]
 extern crate crossbeam_channel;
<a href="#h7-0-3" id="h7-0-3" class="i">+#[macro_use]
</a><a href="#h7-0-4" id="h7-0-4" class="i">+extern crate derivative;
</a> #[cfg(test)]
 extern crate goldenfile;
 extern crate httpbis;
<b>diff --git a/<a id="h8" href="../file/src/server/toydb.rs.html">src/server/toydb.rs</a> b/<a href="../file/src/server/toydb.rs.html">src/server/toydb.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -1,14 +1,14 @@
</a><a href="#h8-0-0" id="h8-0-0" class="d">-use crate::Error;
</a> use crate::raft::Raft;
 use crate::service;
 use crate::sql::types::{Row, Value};
<a href="#h8-0-4" id="h8-0-4" class="d">-use crate::sql::{Parser, Plan, Planner, Storage};
</a><a href="#h8-0-5" id="h8-0-5" class="i">+use crate::sql;
</a> use crate::utility::serialize;
<a href="#h8-0-7" id="h8-0-7" class="i">+use crate::Error;
</a> 
 pub struct ToyDB {
     pub id: String,
     pub raft: Raft,
<a href="#h8-0-12" id="h8-0-12" class="d">-    pub storage: Box&lt;Storage&gt;,
</a><a href="#h8-0-13" id="h8-0-13" class="i">+    pub storage: Box&lt;sql::Storage&gt;,
</a> }
 
 impl service::ToyDB for ToyDB {
<a href="#h8-1" id="h8-1" class="h">@@ -43,20 +43,28 @@ impl service::ToyDB for ToyDB {
</a>         _: grpc::RequestOptions,
         req: service::QueryRequest,
     ) -&gt; grpc::StreamingResponse&lt;service::Row&gt; {
<a href="#h8-1-3" id="h8-1-3" class="d">-        let plan = match self.execute(&amp;req.query) {
</a><a href="#h8-1-4" id="h8-1-4" class="d">-            Ok(plan) =&gt; plan,
</a><a href="#h8-1-5" id="h8-1-5" class="d">-            Err(err) =&gt; return grpc::StreamingResponse::completed(vec![service::Row{
</a><a href="#h8-1-6" id="h8-1-6" class="d">-                error: Self::error_to_protobuf(err),
</a><a href="#h8-1-7" id="h8-1-7" class="d">-                ..Default::default()
</a><a href="#h8-1-8" id="h8-1-8" class="d">-            }])
</a><a href="#h8-1-9" id="h8-1-9" class="i">+        let result = match self.execute(&amp;req.query) {
</a><a href="#h8-1-10" id="h8-1-10" class="i">+            Ok(result) =&gt; result,
</a><a href="#h8-1-11" id="h8-1-11" class="i">+            Err(err) =&gt; {
</a><a href="#h8-1-12" id="h8-1-12" class="i">+                return grpc::StreamingResponse::completed(vec![service::Row {
</a><a href="#h8-1-13" id="h8-1-13" class="i">+                    error: Self::error_to_protobuf(err),
</a><a href="#h8-1-14" id="h8-1-14" class="i">+                    ..Default::default()
</a><a href="#h8-1-15" id="h8-1-15" class="i">+                }])
</a><a href="#h8-1-16" id="h8-1-16" class="i">+            }
</a>         };
         let mut metadata = grpc::Metadata::new();
<a href="#h8-1-19" id="h8-1-19" class="d">-        metadata.add(grpc::MetadataKey::from(&quot;columns&quot;), serialize(&amp;plan.columns).unwrap().into());
</a><a href="#h8-1-20" id="h8-1-20" class="i">+        // FIXME metadata.add(grpc::MetadataKey::from(&quot;columns&quot;), serialize(&amp;plan.columns).unwrap().into());
</a><a href="#h8-1-21" id="h8-1-21" class="i">+        metadata.add(
</a><a href="#h8-1-22" id="h8-1-22" class="i">+            grpc::MetadataKey::from(&quot;columns&quot;),
</a><a href="#h8-1-23" id="h8-1-23" class="i">+            serialize(Vec::&lt;String&gt;::new()).unwrap().into(),
</a><a href="#h8-1-24" id="h8-1-24" class="i">+        );
</a>         grpc::StreamingResponse::iter_with_metadata(
             metadata,
<a href="#h8-1-27" id="h8-1-27" class="d">-            plan.map(|result| match result {
</a><a href="#h8-1-28" id="h8-1-28" class="i">+            result.map(|r| match r {
</a>                 Ok(row) =&gt; Self::row_to_protobuf(row),
<a href="#h8-1-30" id="h8-1-30" class="d">-                Err(err) =&gt; service::Row{error: Self::error_to_protobuf(err), ..Default::default()},
</a><a href="#h8-1-31" id="h8-1-31" class="i">+                Err(err) =&gt; {
</a><a href="#h8-1-32" id="h8-1-32" class="i">+                    service::Row { error: Self::error_to_protobuf(err), ..Default::default() }
</a><a href="#h8-1-33" id="h8-1-33" class="i">+                }
</a>             }),
         )
     }
<a href="#h8-2" id="h8-2" class="h">@@ -76,13 +84,18 @@ impl service::ToyDB for ToyDB {
</a> 
 impl ToyDB {
     /// Executes an SQL statement
<a href="#h8-2-3" id="h8-2-3" class="d">-    fn execute(&amp;self, query: &amp;str) -&gt; Result&lt;Plan, Error&gt; {
</a><a href="#h8-2-4" id="h8-2-4" class="d">-        Planner::new(self.storage.clone()).build(Parser::new(query).parse()?)
</a><a href="#h8-2-5" id="h8-2-5" class="i">+    fn execute(&amp;self, query: &amp;str) -&gt; Result&lt;sql::ResultSet, Error&gt; {
</a><a href="#h8-2-6" id="h8-2-6" class="i">+        sql::Plan::build(sql::Parser::new(query).parse()?)?.execute(sql::Context{
</a><a href="#h8-2-7" id="h8-2-7" class="i">+            storage: self.storage.clone(),
</a><a href="#h8-2-8" id="h8-2-8" class="i">+        })
</a>     }
 
     /// Converts an error into a protobuf object
     fn error_to_protobuf(err: Error) -&gt; protobuf::SingularPtrField&lt;service::Error&gt; {
<a href="#h8-2-13" id="h8-2-13" class="d">-        protobuf::SingularPtrField::from(Some(service::Error { message: err.to_string(), ..Default::default() }))
</a><a href="#h8-2-14" id="h8-2-14" class="i">+        protobuf::SingularPtrField::from(Some(service::Error {
</a><a href="#h8-2-15" id="h8-2-15" class="i">+            message: err.to_string(),
</a><a href="#h8-2-16" id="h8-2-16" class="i">+            ..Default::default()
</a><a href="#h8-2-17" id="h8-2-17" class="i">+        }))
</a>     }
 
     /// Converts a row into a protobuf row
<b>diff --git a/<a id="h9" href="../file/src/sql/expression.rs.html">src/sql/expression.rs</a> b/<a href="../file/src/sql/expression.rs.html">src/sql/expression.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -0,0 +1,181 @@
</a><a href="#h9-0-0" id="h9-0-0" class="i">+use super::types::Value;
</a><a href="#h9-0-1" id="h9-0-1" class="i">+use crate::Error;
</a><a href="#h9-0-2" id="h9-0-2" class="i">+
</a><a href="#h9-0-3" id="h9-0-3" class="i">+/// An expression
</a><a href="#h9-0-4" id="h9-0-4" class="i">+#[derive(Debug)]
</a><a href="#h9-0-5" id="h9-0-5" class="i">+pub enum Expression {
</a><a href="#h9-0-6" id="h9-0-6" class="i">+    Constant(Value),
</a><a href="#h9-0-7" id="h9-0-7" class="i">+
</a><a href="#h9-0-8" id="h9-0-8" class="i">+    // Logical operations
</a><a href="#h9-0-9" id="h9-0-9" class="i">+    And(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-10" id="h9-0-10" class="i">+    Not(Box&lt;Expression&gt;),
</a><a href="#h9-0-11" id="h9-0-11" class="i">+    Or(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-12" id="h9-0-12" class="i">+
</a><a href="#h9-0-13" id="h9-0-13" class="i">+    // Comparisons
</a><a href="#h9-0-14" id="h9-0-14" class="i">+    CompareEQ(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-15" id="h9-0-15" class="i">+    CompareGT(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-16" id="h9-0-16" class="i">+    CompareGTE(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-17" id="h9-0-17" class="i">+    CompareLT(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-18" id="h9-0-18" class="i">+    CompareLTE(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-19" id="h9-0-19" class="i">+    CompareNE(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-20" id="h9-0-20" class="i">+
</a><a href="#h9-0-21" id="h9-0-21" class="i">+    // Mathematical operations
</a><a href="#h9-0-22" id="h9-0-22" class="i">+    Add(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-23" id="h9-0-23" class="i">+    Divide(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-24" id="h9-0-24" class="i">+    Exponentiate(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-25" id="h9-0-25" class="i">+    Factorial(Box&lt;Expression&gt;),
</a><a href="#h9-0-26" id="h9-0-26" class="i">+    Modulo(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-27" id="h9-0-27" class="i">+    Multiply(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-28" id="h9-0-28" class="i">+    Negate(Box&lt;Expression&gt;),
</a><a href="#h9-0-29" id="h9-0-29" class="i">+    Subtract(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h9-0-30" id="h9-0-30" class="i">+}
</a><a href="#h9-0-31" id="h9-0-31" class="i">+
</a><a href="#h9-0-32" id="h9-0-32" class="i">+pub type Expressions = Vec&lt;Expression&gt;;
</a><a href="#h9-0-33" id="h9-0-33" class="i">+
</a><a href="#h9-0-34" id="h9-0-34" class="i">+impl Expression {
</a><a href="#h9-0-35" id="h9-0-35" class="i">+    /// Evaluates an expression to a value
</a><a href="#h9-0-36" id="h9-0-36" class="i">+    pub fn evaluate(&amp;self) -&gt; Result&lt;Value, Error&gt; {
</a><a href="#h9-0-37" id="h9-0-37" class="i">+        use Value::*;
</a><a href="#h9-0-38" id="h9-0-38" class="i">+        Ok(match self {
</a><a href="#h9-0-39" id="h9-0-39" class="i">+            // Logical operations
</a><a href="#h9-0-40" id="h9-0-40" class="i">+            Expression::And(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-41" id="h9-0-41" class="i">+                (Boolean(lhs), Boolean(rhs)) =&gt; Boolean(lhs &amp;&amp; rhs),
</a><a href="#h9-0-42" id="h9-0-42" class="i">+                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t and {} and {}&quot;, lhs, rhs))),
</a><a href="#h9-0-43" id="h9-0-43" class="i">+            },
</a><a href="#h9-0-44" id="h9-0-44" class="i">+            Expression::Not(expr) =&gt; match expr.evaluate()? {
</a><a href="#h9-0-45" id="h9-0-45" class="i">+                Boolean(b) =&gt; Boolean(!b),
</a><a href="#h9-0-46" id="h9-0-46" class="i">+                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t negate {}&quot;, value))),
</a><a href="#h9-0-47" id="h9-0-47" class="i">+            },
</a><a href="#h9-0-48" id="h9-0-48" class="i">+            Expression::Or(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-49" id="h9-0-49" class="i">+                (Boolean(lhs), Boolean(rhs)) =&gt; Boolean(lhs || rhs),
</a><a href="#h9-0-50" id="h9-0-50" class="i">+                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t or {} and {}&quot;, lhs, rhs))),
</a><a href="#h9-0-51" id="h9-0-51" class="i">+            },
</a><a href="#h9-0-52" id="h9-0-52" class="i">+
</a><a href="#h9-0-53" id="h9-0-53" class="i">+            // Comparison operations
</a><a href="#h9-0-54" id="h9-0-54" class="i">+            #[allow(clippy::float_cmp)] // Up to the user if they want to compare or not
</a><a href="#h9-0-55" id="h9-0-55" class="i">+            Expression::CompareEQ(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-56" id="h9-0-56" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs == rhs),
</a><a href="#h9-0-57" id="h9-0-57" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Boolean(lhs as f64 == rhs),
</a><a href="#h9-0-58" id="h9-0-58" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs == rhs as f64),
</a><a href="#h9-0-59" id="h9-0-59" class="i">+                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs == rhs),
</a><a href="#h9-0-60" id="h9-0-60" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-61" id="h9-0-61" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-62" id="h9-0-62" class="i">+                }
</a><a href="#h9-0-63" id="h9-0-63" class="i">+            },
</a><a href="#h9-0-64" id="h9-0-64" class="i">+            Expression::CompareGT(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-65" id="h9-0-65" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs &gt; rhs),
</a><a href="#h9-0-66" id="h9-0-66" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Boolean(lhs as f64 &gt; rhs),
</a><a href="#h9-0-67" id="h9-0-67" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs &gt; rhs as f64),
</a><a href="#h9-0-68" id="h9-0-68" class="i">+                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &gt; rhs),
</a><a href="#h9-0-69" id="h9-0-69" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-70" id="h9-0-70" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-71" id="h9-0-71" class="i">+                }
</a><a href="#h9-0-72" id="h9-0-72" class="i">+            },
</a><a href="#h9-0-73" id="h9-0-73" class="i">+            Expression::CompareGTE(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-74" id="h9-0-74" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs &gt;= rhs),
</a><a href="#h9-0-75" id="h9-0-75" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Boolean(lhs as f64 &gt;= rhs),
</a><a href="#h9-0-76" id="h9-0-76" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs &gt;= rhs as f64),
</a><a href="#h9-0-77" id="h9-0-77" class="i">+                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &gt;= rhs),
</a><a href="#h9-0-78" id="h9-0-78" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-79" id="h9-0-79" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-80" id="h9-0-80" class="i">+                }
</a><a href="#h9-0-81" id="h9-0-81" class="i">+            },
</a><a href="#h9-0-82" id="h9-0-82" class="i">+            Expression::CompareLT(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-83" id="h9-0-83" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs &lt; rhs),
</a><a href="#h9-0-84" id="h9-0-84" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Boolean((lhs as f64) &lt; rhs),
</a><a href="#h9-0-85" id="h9-0-85" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs &lt; rhs as f64),
</a><a href="#h9-0-86" id="h9-0-86" class="i">+                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &lt; rhs),
</a><a href="#h9-0-87" id="h9-0-87" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-88" id="h9-0-88" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-89" id="h9-0-89" class="i">+                }
</a><a href="#h9-0-90" id="h9-0-90" class="i">+            },
</a><a href="#h9-0-91" id="h9-0-91" class="i">+            Expression::CompareLTE(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-92" id="h9-0-92" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs &lt;= rhs),
</a><a href="#h9-0-93" id="h9-0-93" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Boolean((lhs as f64) &lt;= rhs),
</a><a href="#h9-0-94" id="h9-0-94" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs &lt;= rhs as f64),
</a><a href="#h9-0-95" id="h9-0-95" class="i">+                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &lt;= rhs),
</a><a href="#h9-0-96" id="h9-0-96" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-97" id="h9-0-97" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-98" id="h9-0-98" class="i">+                }
</a><a href="#h9-0-99" id="h9-0-99" class="i">+            },
</a><a href="#h9-0-100" id="h9-0-100" class="i">+            #[allow(clippy::float_cmp)] // Up to the user if they want to compare or not
</a><a href="#h9-0-101" id="h9-0-101" class="i">+            Expression::CompareNE(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-102" id="h9-0-102" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs != rhs),
</a><a href="#h9-0-103" id="h9-0-103" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Boolean(lhs as f64 != rhs),
</a><a href="#h9-0-104" id="h9-0-104" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs != rhs as f64),
</a><a href="#h9-0-105" id="h9-0-105" class="i">+                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs != rhs),
</a><a href="#h9-0-106" id="h9-0-106" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-107" id="h9-0-107" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-108" id="h9-0-108" class="i">+                }
</a><a href="#h9-0-109" id="h9-0-109" class="i">+            },
</a><a href="#h9-0-110" id="h9-0-110" class="i">+
</a><a href="#h9-0-111" id="h9-0-111" class="i">+            // Mathematical operations
</a><a href="#h9-0-112" id="h9-0-112" class="i">+            Expression::Add(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-113" id="h9-0-113" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs + rhs),
</a><a href="#h9-0-114" id="h9-0-114" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 + rhs),
</a><a href="#h9-0-115" id="h9-0-115" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Float(lhs + rhs as f64),
</a><a href="#h9-0-116" id="h9-0-116" class="i">+                (Float(lhs), Float(rhs)) =&gt; Float(lhs + rhs),
</a><a href="#h9-0-117" id="h9-0-117" class="i">+                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t add {} and {}&quot;, lhs, rhs))),
</a><a href="#h9-0-118" id="h9-0-118" class="i">+            },
</a><a href="#h9-0-119" id="h9-0-119" class="i">+            Expression::Divide(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-120" id="h9-0-120" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs / rhs),
</a><a href="#h9-0-121" id="h9-0-121" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 / rhs),
</a><a href="#h9-0-122" id="h9-0-122" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Float(lhs / rhs as f64),
</a><a href="#h9-0-123" id="h9-0-123" class="i">+                (Float(lhs), Float(rhs)) =&gt; Float(lhs / rhs),
</a><a href="#h9-0-124" id="h9-0-124" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-125" id="h9-0-125" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t divide {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-126" id="h9-0-126" class="i">+                }
</a><a href="#h9-0-127" id="h9-0-127" class="i">+            },
</a><a href="#h9-0-128" id="h9-0-128" class="i">+            Expression::Exponentiate(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-129" id="h9-0-129" class="i">+                // FIXME Handle overflow
</a><a href="#h9-0-130" id="h9-0-130" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs.pow(rhs as u32)),
</a><a href="#h9-0-131" id="h9-0-131" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Float((lhs as f64).powi(rhs as i32)),
</a><a href="#h9-0-132" id="h9-0-132" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Float((lhs).powi(rhs as i32)),
</a><a href="#h9-0-133" id="h9-0-133" class="i">+                (Float(lhs), Float(rhs)) =&gt; Float((lhs).powf(rhs)),
</a><a href="#h9-0-134" id="h9-0-134" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-135" id="h9-0-135" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t exponentiate {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-136" id="h9-0-136" class="i">+                }
</a><a href="#h9-0-137" id="h9-0-137" class="i">+            },
</a><a href="#h9-0-138" id="h9-0-138" class="i">+            Expression::Factorial(expr) =&gt; match expr.evaluate()? {
</a><a href="#h9-0-139" id="h9-0-139" class="i">+                Integer(i) =&gt; Integer((1..=i).fold(1, |a, b| a * b as i64)),
</a><a href="#h9-0-140" id="h9-0-140" class="i">+                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t take factorial of {}&quot;, value))),
</a><a href="#h9-0-141" id="h9-0-141" class="i">+            },
</a><a href="#h9-0-142" id="h9-0-142" class="i">+            Expression::Modulo(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-143" id="h9-0-143" class="i">+                // The % operator in Rust is remainder, not modulo, so we have to do a bit of
</a><a href="#h9-0-144" id="h9-0-144" class="i">+                // acrobatics to make it work right
</a><a href="#h9-0-145" id="h9-0-145" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Integer(((lhs % rhs) + rhs) % rhs),
</a><a href="#h9-0-146" id="h9-0-146" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Float(((lhs as f64 % rhs) + rhs) % rhs),
</a><a href="#h9-0-147" id="h9-0-147" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Float(((lhs % rhs as f64) + rhs as f64) % rhs as f64),
</a><a href="#h9-0-148" id="h9-0-148" class="i">+                (Float(lhs), Float(rhs)) =&gt; Float(((lhs % rhs) + rhs) % rhs),
</a><a href="#h9-0-149" id="h9-0-149" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-150" id="h9-0-150" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t take modulo of {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-151" id="h9-0-151" class="i">+                }
</a><a href="#h9-0-152" id="h9-0-152" class="i">+            },
</a><a href="#h9-0-153" id="h9-0-153" class="i">+            Expression::Multiply(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-154" id="h9-0-154" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs * rhs),
</a><a href="#h9-0-155" id="h9-0-155" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 * rhs),
</a><a href="#h9-0-156" id="h9-0-156" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Float(lhs * rhs as f64),
</a><a href="#h9-0-157" id="h9-0-157" class="i">+                (Float(lhs), Float(rhs)) =&gt; Float(lhs * rhs),
</a><a href="#h9-0-158" id="h9-0-158" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-159" id="h9-0-159" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t multiply {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-160" id="h9-0-160" class="i">+                }
</a><a href="#h9-0-161" id="h9-0-161" class="i">+            },
</a><a href="#h9-0-162" id="h9-0-162" class="i">+            Expression::Negate(expr) =&gt; match expr.evaluate()? {
</a><a href="#h9-0-163" id="h9-0-163" class="i">+                Integer(i) =&gt; Integer(-i),
</a><a href="#h9-0-164" id="h9-0-164" class="i">+                Float(f) =&gt; Float(-f),
</a><a href="#h9-0-165" id="h9-0-165" class="i">+                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t negate {}&quot;, value))),
</a><a href="#h9-0-166" id="h9-0-166" class="i">+            },
</a><a href="#h9-0-167" id="h9-0-167" class="i">+            Expression::Subtract(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h9-0-168" id="h9-0-168" class="i">+                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs - rhs),
</a><a href="#h9-0-169" id="h9-0-169" class="i">+                (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 - rhs),
</a><a href="#h9-0-170" id="h9-0-170" class="i">+                (Float(lhs), Integer(rhs)) =&gt; Float(lhs - rhs as f64),
</a><a href="#h9-0-171" id="h9-0-171" class="i">+                (Float(lhs), Float(rhs)) =&gt; Float(lhs - rhs),
</a><a href="#h9-0-172" id="h9-0-172" class="i">+                (lhs, rhs) =&gt; {
</a><a href="#h9-0-173" id="h9-0-173" class="i">+                    return Err(Error::Value(format!(&quot;Can&#39;t subtract {} and {}&quot;, lhs, rhs)))
</a><a href="#h9-0-174" id="h9-0-174" class="i">+                }
</a><a href="#h9-0-175" id="h9-0-175" class="i">+            },
</a><a href="#h9-0-176" id="h9-0-176" class="i">+
</a><a href="#h9-0-177" id="h9-0-177" class="i">+            Expression::Constant(c) =&gt; c.clone(),
</a><a href="#h9-0-178" id="h9-0-178" class="i">+        })
</a><a href="#h9-0-179" id="h9-0-179" class="i">+    }
</a><a href="#h9-0-180" id="h9-0-180" class="i">+}
</a><b>diff --git a/<a id="h10" href="../file/src/sql/mod.rs.html">src/sql/mod.rs</a> b/<a href="../file/src/sql/mod.rs.html">src/sql/mod.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -1,3 +1,4 @@
</a><a href="#h10-0-0" id="h10-0-0" class="i">+mod expression;
</a> mod parser;
 mod plan;
 mod schema;
<a href="#h10-1" id="h10-1" class="h">@@ -6,6 +7,7 @@ mod storage;
</a> mod tests;
 pub mod types;
 
<a href="#h10-1-3" id="h10-1-3" class="i">+pub use expression::Expression;
</a> pub use parser::{ast, lexer, Parser};
<a href="#h10-1-5" id="h10-1-5" class="d">-pub use plan::{Plan, Planner};
</a><a href="#h10-1-6" id="h10-1-6" class="i">+pub use plan::{Context, Plan, ResultSet};
</a> pub use storage::Storage;
<b>diff --git a/<a id="h11" href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a> b/<a href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -8,15 +8,13 @@ pub enum Statement {
</a>     /// A DROP TABLE statement
     DropTable(String),
     /// An INSERT statement
<a href="#h11-0-3" id="h11-0-3" class="d">-    Insert {
</a><a href="#h11-0-4" id="h11-0-4" class="d">-        table: String,
</a><a href="#h11-0-5" id="h11-0-5" class="d">-        columns: Option&lt;Vec&lt;String&gt;&gt;,
</a><a href="#h11-0-6" id="h11-0-6" class="d">-        values: Vec&lt;Expressions&gt;,
</a><a href="#h11-0-7" id="h11-0-7" class="d">-    },
</a><a href="#h11-0-8" id="h11-0-8" class="i">+    Insert { table: String, columns: Option&lt;Vec&lt;String&gt;&gt;, values: Vec&lt;Expressions&gt; },
</a>     /// A SELECT statement
     Select {
         /// The select clause
         select: SelectClause,
<a href="#h11-0-13" id="h11-0-13" class="i">+        /// The from clause,
</a><a href="#h11-0-14" id="h11-0-14" class="i">+        from: Option&lt;FromClause&gt;,
</a>     },
 }
 
<a href="#h11-1" id="h11-1" class="h">@@ -32,12 +30,18 @@ pub struct ColumnSpec {
</a> /// A SELECT clause
 #[derive(Clone, Debug, PartialEq)]
 pub struct SelectClause {
<a href="#h11-1-3" id="h11-1-3" class="d">-    /// The expressions to select
</a><a href="#h11-1-4" id="h11-1-4" class="i">+    /// The expressions to select. Empty list means everything, i.e. *.
</a>     pub expressions: Vec&lt;Expression&gt;,
     /// The expression labels, if any
     pub labels: Vec&lt;Option&lt;String&gt;&gt;,
 }
 
<a href="#h11-1-10" id="h11-1-10" class="i">+/// A FROM clause
</a><a href="#h11-1-11" id="h11-1-11" class="i">+#[derive(Clone, Debug, PartialEq)]
</a><a href="#h11-1-12" id="h11-1-12" class="i">+pub struct FromClause {
</a><a href="#h11-1-13" id="h11-1-13" class="i">+    pub tables: Vec&lt;String&gt;,
</a><a href="#h11-1-14" id="h11-1-14" class="i">+}
</a><a href="#h11-1-15" id="h11-1-15" class="i">+
</a> /// Expressions
 #[derive(Clone, Debug, PartialEq)]
 pub enum Expression {
<b>diff --git a/<a id="h12" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -230,7 +230,20 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a> 
     /// Parses a select statement
     fn parse_statement_select(&amp;mut self) -&gt; Result&lt;ast::Statement, Error&gt; {
<a href="#h12-0-3" id="h12-0-3" class="d">-        Ok(ast::Statement::Select { select: self.parse_clause_select()?.unwrap() })
</a><a href="#h12-0-4" id="h12-0-4" class="i">+        Ok(ast::Statement::Select {
</a><a href="#h12-0-5" id="h12-0-5" class="i">+            select: self.parse_clause_select()?.unwrap(),
</a><a href="#h12-0-6" id="h12-0-6" class="i">+            from: self.parse_clause_from()?,
</a><a href="#h12-0-7" id="h12-0-7" class="i">+        })
</a><a href="#h12-0-8" id="h12-0-8" class="i">+    }
</a><a href="#h12-0-9" id="h12-0-9" class="i">+
</a><a href="#h12-0-10" id="h12-0-10" class="i">+    /// Parses a from clause
</a><a href="#h12-0-11" id="h12-0-11" class="i">+    fn parse_clause_from(&amp;mut self) -&gt; Result&lt;Option&lt;ast::FromClause&gt;, Error&gt; {
</a><a href="#h12-0-12" id="h12-0-12" class="i">+        if self.next_if_token(Keyword::From.into()).is_none() {
</a><a href="#h12-0-13" id="h12-0-13" class="i">+            return Ok(None);
</a><a href="#h12-0-14" id="h12-0-14" class="i">+        }
</a><a href="#h12-0-15" id="h12-0-15" class="i">+        let mut clause = ast::FromClause { tables: Vec::new() };
</a><a href="#h12-0-16" id="h12-0-16" class="i">+        clause.tables.push(self.next_ident()?);
</a><a href="#h12-0-17" id="h12-0-17" class="i">+        Ok(Some(clause))
</a>     }
 
     /// Parses a select clause
<a href="#h12-1" id="h12-1" class="h">@@ -240,6 +253,9 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>         }
         let mut clause = ast::SelectClause { expressions: Vec::new(), labels: Vec::new() };
         loop {
<a href="#h12-1-3" id="h12-1-3" class="i">+            if self.next_if_token(Token::Asterisk).is_some() &amp;&amp; clause.expressions.is_empty() {
</a><a href="#h12-1-4" id="h12-1-4" class="i">+                break;
</a><a href="#h12-1-5" id="h12-1-5" class="i">+            }
</a>             clause.expressions.push(self.parse_expression(0)?);
             clause.labels.push(match self.peek()? {
                 Some(Token::Keyword(Keyword::As)) =&gt; {
<b>diff --git a/<a id="h13" href="../file/src/sql/plan/create_table.rs.html">src/sql/plan/create_table.rs</a> b/<a href="../file/src/sql/plan/create_table.rs.html">src/sql/plan/create_table.rs</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -0,0 +1,30 @@
</a><a href="#h13-0-0" id="h13-0-0" class="i">+use super::super::schema;
</a><a href="#h13-0-1" id="h13-0-1" class="i">+use super::super::types::Row;
</a><a href="#h13-0-2" id="h13-0-2" class="i">+use super::{Context, Node};
</a><a href="#h13-0-3" id="h13-0-3" class="i">+use crate::Error;
</a><a href="#h13-0-4" id="h13-0-4" class="i">+
</a><a href="#h13-0-5" id="h13-0-5" class="i">+/// A CREATE TABLE node
</a><a href="#h13-0-6" id="h13-0-6" class="i">+#[derive(Debug)]
</a><a href="#h13-0-7" id="h13-0-7" class="i">+pub struct CreateTable {
</a><a href="#h13-0-8" id="h13-0-8" class="i">+    schema: schema::Table,
</a><a href="#h13-0-9" id="h13-0-9" class="i">+}
</a><a href="#h13-0-10" id="h13-0-10" class="i">+
</a><a href="#h13-0-11" id="h13-0-11" class="i">+impl CreateTable {
</a><a href="#h13-0-12" id="h13-0-12" class="i">+    pub fn new(schema: schema::Table) -&gt; Self {
</a><a href="#h13-0-13" id="h13-0-13" class="i">+        Self { schema }
</a><a href="#h13-0-14" id="h13-0-14" class="i">+    }
</a><a href="#h13-0-15" id="h13-0-15" class="i">+}
</a><a href="#h13-0-16" id="h13-0-16" class="i">+
</a><a href="#h13-0-17" id="h13-0-17" class="i">+impl Node for CreateTable {
</a><a href="#h13-0-18" id="h13-0-18" class="i">+    fn execute(&amp;mut self, ctx: &amp;mut Context) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h13-0-19" id="h13-0-19" class="i">+        ctx.storage.create_table(&amp;self.schema)
</a><a href="#h13-0-20" id="h13-0-20" class="i">+    }
</a><a href="#h13-0-21" id="h13-0-21" class="i">+}
</a><a href="#h13-0-22" id="h13-0-22" class="i">+
</a><a href="#h13-0-23" id="h13-0-23" class="i">+impl Iterator for CreateTable {
</a><a href="#h13-0-24" id="h13-0-24" class="i">+    type Item = Result&lt;Row, Error&gt;;
</a><a href="#h13-0-25" id="h13-0-25" class="i">+
</a><a href="#h13-0-26" id="h13-0-26" class="i">+    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
</a><a href="#h13-0-27" id="h13-0-27" class="i">+        None
</a><a href="#h13-0-28" id="h13-0-28" class="i">+    }
</a><a href="#h13-0-29" id="h13-0-29" class="i">+}
</a><b>diff --git a/<a id="h14" href="../file/src/sql/plan/drop_table.rs.html">src/sql/plan/drop_table.rs</a> b/<a href="../file/src/sql/plan/drop_table.rs.html">src/sql/plan/drop_table.rs</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -0,0 +1,29 @@
</a><a href="#h14-0-0" id="h14-0-0" class="i">+use super::super::types::Row;
</a><a href="#h14-0-1" id="h14-0-1" class="i">+use super::{Context, Node};
</a><a href="#h14-0-2" id="h14-0-2" class="i">+use crate::Error;
</a><a href="#h14-0-3" id="h14-0-3" class="i">+
</a><a href="#h14-0-4" id="h14-0-4" class="i">+/// A CREATE TABLE node
</a><a href="#h14-0-5" id="h14-0-5" class="i">+#[derive(Debug)]
</a><a href="#h14-0-6" id="h14-0-6" class="i">+pub struct DropTable {
</a><a href="#h14-0-7" id="h14-0-7" class="i">+    table: String,
</a><a href="#h14-0-8" id="h14-0-8" class="i">+}
</a><a href="#h14-0-9" id="h14-0-9" class="i">+
</a><a href="#h14-0-10" id="h14-0-10" class="i">+impl DropTable {
</a><a href="#h14-0-11" id="h14-0-11" class="i">+    pub fn new(table: String) -&gt; Self {
</a><a href="#h14-0-12" id="h14-0-12" class="i">+        Self { table }
</a><a href="#h14-0-13" id="h14-0-13" class="i">+    }
</a><a href="#h14-0-14" id="h14-0-14" class="i">+}
</a><a href="#h14-0-15" id="h14-0-15" class="i">+
</a><a href="#h14-0-16" id="h14-0-16" class="i">+impl Node for DropTable {
</a><a href="#h14-0-17" id="h14-0-17" class="i">+    fn execute(&amp;mut self, ctx: &amp;mut Context) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h14-0-18" id="h14-0-18" class="i">+        ctx.storage.drop_table(&amp;self.table)
</a><a href="#h14-0-19" id="h14-0-19" class="i">+    }
</a><a href="#h14-0-20" id="h14-0-20" class="i">+}
</a><a href="#h14-0-21" id="h14-0-21" class="i">+
</a><a href="#h14-0-22" id="h14-0-22" class="i">+impl Iterator for DropTable {
</a><a href="#h14-0-23" id="h14-0-23" class="i">+    type Item = Result&lt;Row, Error&gt;;
</a><a href="#h14-0-24" id="h14-0-24" class="i">+
</a><a href="#h14-0-25" id="h14-0-25" class="i">+    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
</a><a href="#h14-0-26" id="h14-0-26" class="i">+        None
</a><a href="#h14-0-27" id="h14-0-27" class="i">+    }
</a><a href="#h14-0-28" id="h14-0-28" class="i">+}
</a><b>diff --git a/<a id="h15" href="../file/src/sql/plan/expression.rs.html">src/sql/plan/expression.rs</a> b/<a href="../file/src/sql/plan/expression.rs.html">src/sql/plan/expression.rs</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -1,181 +0,0 @@
</a><a href="#h15-0-0" id="h15-0-0" class="d">-use super::super::types::Value;
</a><a href="#h15-0-1" id="h15-0-1" class="d">-use crate::Error;
</a><a href="#h15-0-2" id="h15-0-2" class="d">-
</a><a href="#h15-0-3" id="h15-0-3" class="d">-/// An expression
</a><a href="#h15-0-4" id="h15-0-4" class="d">-#[derive(Debug)]
</a><a href="#h15-0-5" id="h15-0-5" class="d">-pub enum Expression {
</a><a href="#h15-0-6" id="h15-0-6" class="d">-    Constant(Value),
</a><a href="#h15-0-7" id="h15-0-7" class="d">-
</a><a href="#h15-0-8" id="h15-0-8" class="d">-    // Logical operations
</a><a href="#h15-0-9" id="h15-0-9" class="d">-    And(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-10" id="h15-0-10" class="d">-    Not(Box&lt;Expression&gt;),
</a><a href="#h15-0-11" id="h15-0-11" class="d">-    Or(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-12" id="h15-0-12" class="d">-
</a><a href="#h15-0-13" id="h15-0-13" class="d">-    // Comparisons
</a><a href="#h15-0-14" id="h15-0-14" class="d">-    CompareEQ(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-15" id="h15-0-15" class="d">-    CompareGT(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-16" id="h15-0-16" class="d">-    CompareGTE(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-17" id="h15-0-17" class="d">-    CompareLT(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-18" id="h15-0-18" class="d">-    CompareLTE(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-19" id="h15-0-19" class="d">-    CompareNE(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-20" id="h15-0-20" class="d">-
</a><a href="#h15-0-21" id="h15-0-21" class="d">-    // Mathematical operations
</a><a href="#h15-0-22" id="h15-0-22" class="d">-    Add(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-23" id="h15-0-23" class="d">-    Divide(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-24" id="h15-0-24" class="d">-    Exponentiate(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-25" id="h15-0-25" class="d">-    Factorial(Box&lt;Expression&gt;),
</a><a href="#h15-0-26" id="h15-0-26" class="d">-    Modulo(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-27" id="h15-0-27" class="d">-    Multiply(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-28" id="h15-0-28" class="d">-    Negate(Box&lt;Expression&gt;),
</a><a href="#h15-0-29" id="h15-0-29" class="d">-    Subtract(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
</a><a href="#h15-0-30" id="h15-0-30" class="d">-}
</a><a href="#h15-0-31" id="h15-0-31" class="d">-
</a><a href="#h15-0-32" id="h15-0-32" class="d">-pub type Expressions = Vec&lt;Expression&gt;;
</a><a href="#h15-0-33" id="h15-0-33" class="d">-
</a><a href="#h15-0-34" id="h15-0-34" class="d">-impl Expression {
</a><a href="#h15-0-35" id="h15-0-35" class="d">-    /// Evaluates an expression to a value
</a><a href="#h15-0-36" id="h15-0-36" class="d">-    pub fn evaluate(&amp;self) -&gt; Result&lt;Value, Error&gt; {
</a><a href="#h15-0-37" id="h15-0-37" class="d">-        use Value::*;
</a><a href="#h15-0-38" id="h15-0-38" class="d">-        Ok(match self {
</a><a href="#h15-0-39" id="h15-0-39" class="d">-            // Logical operations
</a><a href="#h15-0-40" id="h15-0-40" class="d">-            Expression::And(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-41" id="h15-0-41" class="d">-                (Boolean(lhs), Boolean(rhs)) =&gt; Boolean(lhs &amp;&amp; rhs),
</a><a href="#h15-0-42" id="h15-0-42" class="d">-                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t and {} and {}&quot;, lhs, rhs))),
</a><a href="#h15-0-43" id="h15-0-43" class="d">-            },
</a><a href="#h15-0-44" id="h15-0-44" class="d">-            Expression::Not(expr) =&gt; match expr.evaluate()? {
</a><a href="#h15-0-45" id="h15-0-45" class="d">-                Boolean(b) =&gt; Boolean(!b),
</a><a href="#h15-0-46" id="h15-0-46" class="d">-                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t negate {}&quot;, value))),
</a><a href="#h15-0-47" id="h15-0-47" class="d">-            },
</a><a href="#h15-0-48" id="h15-0-48" class="d">-            Expression::Or(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-49" id="h15-0-49" class="d">-                (Boolean(lhs), Boolean(rhs)) =&gt; Boolean(lhs || rhs),
</a><a href="#h15-0-50" id="h15-0-50" class="d">-                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t or {} and {}&quot;, lhs, rhs))),
</a><a href="#h15-0-51" id="h15-0-51" class="d">-            },
</a><a href="#h15-0-52" id="h15-0-52" class="d">-
</a><a href="#h15-0-53" id="h15-0-53" class="d">-            // Comparison operations
</a><a href="#h15-0-54" id="h15-0-54" class="d">-            #[allow(clippy::float_cmp)] // Up to the user if they want to compare or not
</a><a href="#h15-0-55" id="h15-0-55" class="d">-            Expression::CompareEQ(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-56" id="h15-0-56" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs == rhs),
</a><a href="#h15-0-57" id="h15-0-57" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Boolean(lhs as f64 == rhs),
</a><a href="#h15-0-58" id="h15-0-58" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs == rhs as f64),
</a><a href="#h15-0-59" id="h15-0-59" class="d">-                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs == rhs),
</a><a href="#h15-0-60" id="h15-0-60" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-61" id="h15-0-61" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-62" id="h15-0-62" class="d">-                }
</a><a href="#h15-0-63" id="h15-0-63" class="d">-            },
</a><a href="#h15-0-64" id="h15-0-64" class="d">-            Expression::CompareGT(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-65" id="h15-0-65" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs &gt; rhs),
</a><a href="#h15-0-66" id="h15-0-66" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Boolean(lhs as f64 &gt; rhs),
</a><a href="#h15-0-67" id="h15-0-67" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs &gt; rhs as f64),
</a><a href="#h15-0-68" id="h15-0-68" class="d">-                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &gt; rhs),
</a><a href="#h15-0-69" id="h15-0-69" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-70" id="h15-0-70" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-71" id="h15-0-71" class="d">-                }
</a><a href="#h15-0-72" id="h15-0-72" class="d">-            },
</a><a href="#h15-0-73" id="h15-0-73" class="d">-            Expression::CompareGTE(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-74" id="h15-0-74" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs &gt;= rhs),
</a><a href="#h15-0-75" id="h15-0-75" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Boolean(lhs as f64 &gt;= rhs),
</a><a href="#h15-0-76" id="h15-0-76" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs &gt;= rhs as f64),
</a><a href="#h15-0-77" id="h15-0-77" class="d">-                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &gt;= rhs),
</a><a href="#h15-0-78" id="h15-0-78" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-79" id="h15-0-79" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-80" id="h15-0-80" class="d">-                }
</a><a href="#h15-0-81" id="h15-0-81" class="d">-            },
</a><a href="#h15-0-82" id="h15-0-82" class="d">-            Expression::CompareLT(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-83" id="h15-0-83" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs &lt; rhs),
</a><a href="#h15-0-84" id="h15-0-84" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Boolean((lhs as f64) &lt; rhs),
</a><a href="#h15-0-85" id="h15-0-85" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs &lt; rhs as f64),
</a><a href="#h15-0-86" id="h15-0-86" class="d">-                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &lt; rhs),
</a><a href="#h15-0-87" id="h15-0-87" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-88" id="h15-0-88" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-89" id="h15-0-89" class="d">-                }
</a><a href="#h15-0-90" id="h15-0-90" class="d">-            },
</a><a href="#h15-0-91" id="h15-0-91" class="d">-            Expression::CompareLTE(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-92" id="h15-0-92" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs &lt;= rhs),
</a><a href="#h15-0-93" id="h15-0-93" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Boolean((lhs as f64) &lt;= rhs),
</a><a href="#h15-0-94" id="h15-0-94" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs &lt;= rhs as f64),
</a><a href="#h15-0-95" id="h15-0-95" class="d">-                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs &lt;= rhs),
</a><a href="#h15-0-96" id="h15-0-96" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-97" id="h15-0-97" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-98" id="h15-0-98" class="d">-                }
</a><a href="#h15-0-99" id="h15-0-99" class="d">-            },
</a><a href="#h15-0-100" id="h15-0-100" class="d">-            #[allow(clippy::float_cmp)] // Up to the user if they want to compare or not
</a><a href="#h15-0-101" id="h15-0-101" class="d">-            Expression::CompareNE(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-102" id="h15-0-102" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Boolean(lhs != rhs),
</a><a href="#h15-0-103" id="h15-0-103" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Boolean(lhs as f64 != rhs),
</a><a href="#h15-0-104" id="h15-0-104" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Boolean(lhs != rhs as f64),
</a><a href="#h15-0-105" id="h15-0-105" class="d">-                (Float(lhs), Float(rhs)) =&gt; Boolean(lhs != rhs),
</a><a href="#h15-0-106" id="h15-0-106" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-107" id="h15-0-107" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t compare {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-108" id="h15-0-108" class="d">-                }
</a><a href="#h15-0-109" id="h15-0-109" class="d">-            },
</a><a href="#h15-0-110" id="h15-0-110" class="d">-
</a><a href="#h15-0-111" id="h15-0-111" class="d">-            // Mathematical operations
</a><a href="#h15-0-112" id="h15-0-112" class="d">-            Expression::Add(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-113" id="h15-0-113" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs + rhs),
</a><a href="#h15-0-114" id="h15-0-114" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 + rhs),
</a><a href="#h15-0-115" id="h15-0-115" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Float(lhs + rhs as f64),
</a><a href="#h15-0-116" id="h15-0-116" class="d">-                (Float(lhs), Float(rhs)) =&gt; Float(lhs + rhs),
</a><a href="#h15-0-117" id="h15-0-117" class="d">-                (lhs, rhs) =&gt; return Err(Error::Value(format!(&quot;Can&#39;t add {} and {}&quot;, lhs, rhs))),
</a><a href="#h15-0-118" id="h15-0-118" class="d">-            },
</a><a href="#h15-0-119" id="h15-0-119" class="d">-            Expression::Divide(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-120" id="h15-0-120" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs / rhs),
</a><a href="#h15-0-121" id="h15-0-121" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 / rhs),
</a><a href="#h15-0-122" id="h15-0-122" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Float(lhs / rhs as f64),
</a><a href="#h15-0-123" id="h15-0-123" class="d">-                (Float(lhs), Float(rhs)) =&gt; Float(lhs / rhs),
</a><a href="#h15-0-124" id="h15-0-124" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-125" id="h15-0-125" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t divide {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-126" id="h15-0-126" class="d">-                }
</a><a href="#h15-0-127" id="h15-0-127" class="d">-            },
</a><a href="#h15-0-128" id="h15-0-128" class="d">-            Expression::Exponentiate(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-129" id="h15-0-129" class="d">-                // FIXME Handle overflow
</a><a href="#h15-0-130" id="h15-0-130" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs.pow(rhs as u32)),
</a><a href="#h15-0-131" id="h15-0-131" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Float((lhs as f64).powi(rhs as i32)),
</a><a href="#h15-0-132" id="h15-0-132" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Float((lhs).powi(rhs as i32)),
</a><a href="#h15-0-133" id="h15-0-133" class="d">-                (Float(lhs), Float(rhs)) =&gt; Float((lhs).powf(rhs)),
</a><a href="#h15-0-134" id="h15-0-134" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-135" id="h15-0-135" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t exponentiate {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-136" id="h15-0-136" class="d">-                }
</a><a href="#h15-0-137" id="h15-0-137" class="d">-            },
</a><a href="#h15-0-138" id="h15-0-138" class="d">-            Expression::Factorial(expr) =&gt; match expr.evaluate()? {
</a><a href="#h15-0-139" id="h15-0-139" class="d">-                Integer(i) =&gt; Integer((1..=i).fold(1, |a, b| a * b as i64)),
</a><a href="#h15-0-140" id="h15-0-140" class="d">-                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t take factorial of {}&quot;, value))),
</a><a href="#h15-0-141" id="h15-0-141" class="d">-            },
</a><a href="#h15-0-142" id="h15-0-142" class="d">-            Expression::Modulo(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-143" id="h15-0-143" class="d">-                // The % operator in Rust is remainder, not modulo, so we have to do a bit of
</a><a href="#h15-0-144" id="h15-0-144" class="d">-                // acrobatics to make it work right
</a><a href="#h15-0-145" id="h15-0-145" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(((lhs % rhs) + rhs) % rhs),
</a><a href="#h15-0-146" id="h15-0-146" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Float(((lhs as f64 % rhs) + rhs) % rhs),
</a><a href="#h15-0-147" id="h15-0-147" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Float(((lhs % rhs as f64) + rhs as f64) % rhs as f64),
</a><a href="#h15-0-148" id="h15-0-148" class="d">-                (Float(lhs), Float(rhs)) =&gt; Float(((lhs % rhs) + rhs) % rhs),
</a><a href="#h15-0-149" id="h15-0-149" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-150" id="h15-0-150" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t take modulo of {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-151" id="h15-0-151" class="d">-                }
</a><a href="#h15-0-152" id="h15-0-152" class="d">-            },
</a><a href="#h15-0-153" id="h15-0-153" class="d">-            Expression::Multiply(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-154" id="h15-0-154" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs * rhs),
</a><a href="#h15-0-155" id="h15-0-155" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 * rhs),
</a><a href="#h15-0-156" id="h15-0-156" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Float(lhs * rhs as f64),
</a><a href="#h15-0-157" id="h15-0-157" class="d">-                (Float(lhs), Float(rhs)) =&gt; Float(lhs * rhs),
</a><a href="#h15-0-158" id="h15-0-158" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-159" id="h15-0-159" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t multiply {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-160" id="h15-0-160" class="d">-                }
</a><a href="#h15-0-161" id="h15-0-161" class="d">-            },
</a><a href="#h15-0-162" id="h15-0-162" class="d">-            Expression::Negate(expr) =&gt; match expr.evaluate()? {
</a><a href="#h15-0-163" id="h15-0-163" class="d">-                Integer(i) =&gt; Integer(-i),
</a><a href="#h15-0-164" id="h15-0-164" class="d">-                Float(f) =&gt; Float(-f),
</a><a href="#h15-0-165" id="h15-0-165" class="d">-                value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t negate {}&quot;, value))),
</a><a href="#h15-0-166" id="h15-0-166" class="d">-            },
</a><a href="#h15-0-167" id="h15-0-167" class="d">-            Expression::Subtract(lhs, rhs) =&gt; match (lhs.evaluate()?, rhs.evaluate()?) {
</a><a href="#h15-0-168" id="h15-0-168" class="d">-                (Integer(lhs), Integer(rhs)) =&gt; Integer(lhs - rhs),
</a><a href="#h15-0-169" id="h15-0-169" class="d">-                (Integer(lhs), Float(rhs)) =&gt; Float(lhs as f64 - rhs),
</a><a href="#h15-0-170" id="h15-0-170" class="d">-                (Float(lhs), Integer(rhs)) =&gt; Float(lhs - rhs as f64),
</a><a href="#h15-0-171" id="h15-0-171" class="d">-                (Float(lhs), Float(rhs)) =&gt; Float(lhs - rhs),
</a><a href="#h15-0-172" id="h15-0-172" class="d">-                (lhs, rhs) =&gt; {
</a><a href="#h15-0-173" id="h15-0-173" class="d">-                    return Err(Error::Value(format!(&quot;Can&#39;t subtract {} and {}&quot;, lhs, rhs)))
</a><a href="#h15-0-174" id="h15-0-174" class="d">-                }
</a><a href="#h15-0-175" id="h15-0-175" class="d">-            },
</a><a href="#h15-0-176" id="h15-0-176" class="d">-
</a><a href="#h15-0-177" id="h15-0-177" class="d">-            Expression::Constant(c) =&gt; c.clone(),
</a><a href="#h15-0-178" id="h15-0-178" class="d">-        })
</a><a href="#h15-0-179" id="h15-0-179" class="d">-    }
</a><a href="#h15-0-180" id="h15-0-180" class="d">-}
</a><b>diff --git a/<a id="h16" href="../file/src/sql/plan/insert.rs.html">src/sql/plan/insert.rs</a> b/<a href="../file/src/sql/plan/insert.rs.html">src/sql/plan/insert.rs</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -0,0 +1,38 @@
</a><a href="#h16-0-0" id="h16-0-0" class="i">+use super::super::expression::Expressions;
</a><a href="#h16-0-1" id="h16-0-1" class="i">+use super::super::types::Row;
</a><a href="#h16-0-2" id="h16-0-2" class="i">+use super::{Context, Node};
</a><a href="#h16-0-3" id="h16-0-3" class="i">+use crate::Error;
</a><a href="#h16-0-4" id="h16-0-4" class="i">+
</a><a href="#h16-0-5" id="h16-0-5" class="i">+/// An INSERT node
</a><a href="#h16-0-6" id="h16-0-6" class="i">+#[derive(Debug)]
</a><a href="#h16-0-7" id="h16-0-7" class="i">+pub struct Insert {
</a><a href="#h16-0-8" id="h16-0-8" class="i">+    table: String,
</a><a href="#h16-0-9" id="h16-0-9" class="i">+    expressions: Vec&lt;Expressions&gt;,
</a><a href="#h16-0-10" id="h16-0-10" class="i">+}
</a><a href="#h16-0-11" id="h16-0-11" class="i">+
</a><a href="#h16-0-12" id="h16-0-12" class="i">+impl Insert {
</a><a href="#h16-0-13" id="h16-0-13" class="i">+    pub fn new(table: String, expressions: Vec&lt;Expressions&gt;) -&gt; Self {
</a><a href="#h16-0-14" id="h16-0-14" class="i">+        Self { table, expressions }
</a><a href="#h16-0-15" id="h16-0-15" class="i">+    }
</a><a href="#h16-0-16" id="h16-0-16" class="i">+}
</a><a href="#h16-0-17" id="h16-0-17" class="i">+
</a><a href="#h16-0-18" id="h16-0-18" class="i">+impl Node for Insert {
</a><a href="#h16-0-19" id="h16-0-19" class="i">+    fn execute(&amp;mut self, ctx: &amp;mut Context) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h16-0-20" id="h16-0-20" class="i">+        for exprs in &amp;self.expressions {
</a><a href="#h16-0-21" id="h16-0-21" class="i">+            let mut row = Row::new();
</a><a href="#h16-0-22" id="h16-0-22" class="i">+            for expr in exprs {
</a><a href="#h16-0-23" id="h16-0-23" class="i">+                row.push(expr.evaluate()?);
</a><a href="#h16-0-24" id="h16-0-24" class="i">+            }
</a><a href="#h16-0-25" id="h16-0-25" class="i">+            ctx.storage.create_row(&amp;self.table, row)?;
</a><a href="#h16-0-26" id="h16-0-26" class="i">+        }
</a><a href="#h16-0-27" id="h16-0-27" class="i">+        Ok(())
</a><a href="#h16-0-28" id="h16-0-28" class="i">+    }
</a><a href="#h16-0-29" id="h16-0-29" class="i">+}
</a><a href="#h16-0-30" id="h16-0-30" class="i">+
</a><a href="#h16-0-31" id="h16-0-31" class="i">+impl Iterator for Insert {
</a><a href="#h16-0-32" id="h16-0-32" class="i">+    type Item = Result&lt;Row, Error&gt;;
</a><a href="#h16-0-33" id="h16-0-33" class="i">+
</a><a href="#h16-0-34" id="h16-0-34" class="i">+    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
</a><a href="#h16-0-35" id="h16-0-35" class="i">+        None
</a><a href="#h16-0-36" id="h16-0-36" class="i">+    }
</a><a href="#h16-0-37" id="h16-0-37" class="i">+}
</a><b>diff --git a/<a id="h17" href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a> b/<a href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -1,27 +1,228 @@
</a><a href="#h17-0-0" id="h17-0-0" class="d">-mod expression;
</a><a href="#h17-0-1" id="h17-0-1" class="d">-mod node;
</a><a href="#h17-0-2" id="h17-0-2" class="d">-mod planner;
</a><a href="#h17-0-3" id="h17-0-3" class="i">+mod create_table;
</a><a href="#h17-0-4" id="h17-0-4" class="i">+mod drop_table;
</a><a href="#h17-0-5" id="h17-0-5" class="i">+mod insert;
</a><a href="#h17-0-6" id="h17-0-6" class="i">+mod nothing;
</a><a href="#h17-0-7" id="h17-0-7" class="i">+mod projection;
</a><a href="#h17-0-8" id="h17-0-8" class="i">+mod scan;
</a> 
<a href="#h17-0-10" id="h17-0-10" class="d">-pub use node::Node;
</a><a href="#h17-0-11" id="h17-0-11" class="d">-
</a><a href="#h17-0-12" id="h17-0-12" class="d">-use super::types::Row;
</a><a href="#h17-0-13" id="h17-0-13" class="i">+use super::expression::Expression;
</a><a href="#h17-0-14" id="h17-0-14" class="i">+use super::parser::ast;
</a><a href="#h17-0-15" id="h17-0-15" class="i">+use super::schema;
</a><a href="#h17-0-16" id="h17-0-16" class="i">+use super::storage::Storage;
</a><a href="#h17-0-17" id="h17-0-17" class="i">+use super::types::{Row, Value};
</a> use crate::Error;
<a href="#h17-0-19" id="h17-0-19" class="d">-pub use planner::Planner;
</a><a href="#h17-0-20" id="h17-0-20" class="i">+use create_table::CreateTable;
</a><a href="#h17-0-21" id="h17-0-21" class="i">+use drop_table::DropTable;
</a><a href="#h17-0-22" id="h17-0-22" class="i">+use insert::Insert;
</a><a href="#h17-0-23" id="h17-0-23" class="i">+use nothing::Nothing;
</a><a href="#h17-0-24" id="h17-0-24" class="i">+use projection::Projection;
</a><a href="#h17-0-25" id="h17-0-25" class="i">+use scan::Scan;
</a> 
 /// A plan
 #[derive(Debug)]
 pub struct Plan {
<a href="#h17-0-30" id="h17-0-30" class="d">-    /// The plan column names
</a><a href="#h17-0-31" id="h17-0-31" class="d">-    pub columns: Vec&lt;String&gt;,
</a><a href="#h17-0-32" id="h17-0-32" class="d">-
</a>     /// The plan root
<a href="#h17-0-34" id="h17-0-34" class="d">-    pub root: Node,
</a><a href="#h17-0-35" id="h17-0-35" class="i">+    root: Box&lt;dyn Node&gt;,
</a><a href="#h17-0-36" id="h17-0-36" class="i">+}
</a><a href="#h17-0-37" id="h17-0-37" class="i">+
</a><a href="#h17-0-38" id="h17-0-38" class="i">+impl Plan {
</a><a href="#h17-0-39" id="h17-0-39" class="i">+    pub fn build(statement: ast::Statement) -&gt; Result&lt;Self, Error&gt; {
</a><a href="#h17-0-40" id="h17-0-40" class="i">+        Planner::new().build(statement)
</a><a href="#h17-0-41" id="h17-0-41" class="i">+    }
</a><a href="#h17-0-42" id="h17-0-42" class="i">+
</a><a href="#h17-0-43" id="h17-0-43" class="i">+    pub fn execute(mut self, mut context: Context) -&gt; Result&lt;ResultSet, Error&gt; {
</a><a href="#h17-0-44" id="h17-0-44" class="i">+        self.root.execute(&amp;mut context)?;
</a><a href="#h17-0-45" id="h17-0-45" class="i">+        Ok(ResultSet { root: self.root })
</a><a href="#h17-0-46" id="h17-0-46" class="i">+    }
</a><a href="#h17-0-47" id="h17-0-47" class="i">+}
</a><a href="#h17-0-48" id="h17-0-48" class="i">+
</a><a href="#h17-0-49" id="h17-0-49" class="i">+/// A plan execution context
</a><a href="#h17-0-50" id="h17-0-50" class="i">+pub struct Context {
</a><a href="#h17-0-51" id="h17-0-51" class="i">+    /// The underlying storage
</a><a href="#h17-0-52" id="h17-0-52" class="i">+    pub storage: Box&lt;Storage&gt;,
</a><a href="#h17-0-53" id="h17-0-53" class="i">+}
</a><a href="#h17-0-54" id="h17-0-54" class="i">+
</a><a href="#h17-0-55" id="h17-0-55" class="i">+/// A plan execution result
</a><a href="#h17-0-56" id="h17-0-56" class="i">+pub struct ResultSet {
</a><a href="#h17-0-57" id="h17-0-57" class="i">+    root: Box&lt;dyn Node&gt;,
</a> }
 
<a href="#h17-0-60" id="h17-0-60" class="d">-impl Iterator for Plan {
</a><a href="#h17-0-61" id="h17-0-61" class="i">+impl Iterator for ResultSet {
</a>     type Item = Result&lt;Row, Error&gt;;
 
<a href="#h17-0-64" id="h17-0-64" class="d">-    fn next(&amp;mut self) -&gt; Option&lt;Result&lt;Row, Error&gt;&gt; {
</a><a href="#h17-0-65" id="h17-0-65" class="i">+    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
</a>         self.root.next()
     }
 }
<a href="#h17-0-69" id="h17-0-69" class="i">+
</a><a href="#h17-0-70" id="h17-0-70" class="i">+/// A plan node
</a><a href="#h17-0-71" id="h17-0-71" class="i">+pub trait Node:
</a><a href="#h17-0-72" id="h17-0-72" class="i">+    Iterator&lt;Item = Result&lt;Row, Error&gt;&gt; + std::fmt::Debug + Send + Sync + &#39;static
</a><a href="#h17-0-73" id="h17-0-73" class="i">+{
</a><a href="#h17-0-74" id="h17-0-74" class="i">+    /// Execute starts execution of the plan
</a><a href="#h17-0-75" id="h17-0-75" class="i">+    fn execute(&amp;mut self, ctx: &amp;mut Context) -&gt; Result&lt;(), Error&gt;;
</a><a href="#h17-0-76" id="h17-0-76" class="i">+}
</a><a href="#h17-0-77" id="h17-0-77" class="i">+
</a><a href="#h17-0-78" id="h17-0-78" class="i">+impl&lt;N: Node&gt; From&lt;N&gt; for Box&lt;dyn Node&gt; {
</a><a href="#h17-0-79" id="h17-0-79" class="i">+    fn from(n: N) -&gt; Self {
</a><a href="#h17-0-80" id="h17-0-80" class="i">+        Box::new(n)
</a><a href="#h17-0-81" id="h17-0-81" class="i">+    }
</a><a href="#h17-0-82" id="h17-0-82" class="i">+}
</a><a href="#h17-0-83" id="h17-0-83" class="i">+
</a><a href="#h17-0-84" id="h17-0-84" class="i">+/// The plan builder
</a><a href="#h17-0-85" id="h17-0-85" class="i">+struct Planner {}
</a><a href="#h17-0-86" id="h17-0-86" class="i">+
</a><a href="#h17-0-87" id="h17-0-87" class="i">+impl Planner {
</a><a href="#h17-0-88" id="h17-0-88" class="i">+    /// Creates a new planner
</a><a href="#h17-0-89" id="h17-0-89" class="i">+    pub fn new() -&gt; Self {
</a><a href="#h17-0-90" id="h17-0-90" class="i">+        Self {}
</a><a href="#h17-0-91" id="h17-0-91" class="i">+    }
</a><a href="#h17-0-92" id="h17-0-92" class="i">+
</a><a href="#h17-0-93" id="h17-0-93" class="i">+    /// Builds a plan tree for an AST statement
</a><a href="#h17-0-94" id="h17-0-94" class="i">+    pub fn build(&amp;self, statement: ast::Statement) -&gt; Result&lt;Plan, Error&gt; {
</a><a href="#h17-0-95" id="h17-0-95" class="i">+        Ok(Plan { root: self.build_statement(statement)? })
</a><a href="#h17-0-96" id="h17-0-96" class="i">+    }
</a><a href="#h17-0-97" id="h17-0-97" class="i">+
</a><a href="#h17-0-98" id="h17-0-98" class="i">+    /// Builds a plan node for a statement
</a><a href="#h17-0-99" id="h17-0-99" class="i">+    fn build_statement(&amp;self, statement: ast::Statement) -&gt; Result&lt;Box&lt;dyn Node&gt;, Error&gt; {
</a><a href="#h17-0-100" id="h17-0-100" class="i">+        Ok(match statement {
</a><a href="#h17-0-101" id="h17-0-101" class="i">+            ast::Statement::CreateTable { name, columns } =&gt; {
</a><a href="#h17-0-102" id="h17-0-102" class="i">+                CreateTable::new(self.build_schema_table(name, columns)?).into()
</a><a href="#h17-0-103" id="h17-0-103" class="i">+            }
</a><a href="#h17-0-104" id="h17-0-104" class="i">+            ast::Statement::DropTable(name) =&gt; DropTable::new(name).into(),
</a><a href="#h17-0-105" id="h17-0-105" class="i">+            ast::Statement::Insert { table, values, .. } =&gt; {
</a><a href="#h17-0-106" id="h17-0-106" class="i">+                // FIXME Needs to handle columns
</a><a href="#h17-0-107" id="h17-0-107" class="i">+                Insert::new(
</a><a href="#h17-0-108" id="h17-0-108" class="i">+                    table,
</a><a href="#h17-0-109" id="h17-0-109" class="i">+                    values
</a><a href="#h17-0-110" id="h17-0-110" class="i">+                        .into_iter()
</a><a href="#h17-0-111" id="h17-0-111" class="i">+                        .map(|exprs| exprs.into_iter().map(|expr| expr.into()).collect())
</a><a href="#h17-0-112" id="h17-0-112" class="i">+                        .collect(),
</a><a href="#h17-0-113" id="h17-0-113" class="i">+                )
</a><a href="#h17-0-114" id="h17-0-114" class="i">+                .into()
</a><a href="#h17-0-115" id="h17-0-115" class="i">+            }
</a><a href="#h17-0-116" id="h17-0-116" class="i">+            ast::Statement::Select { select, from } =&gt; {
</a><a href="#h17-0-117" id="h17-0-117" class="i">+                let mut n: Box&lt;dyn Node&gt; = match from {
</a><a href="#h17-0-118" id="h17-0-118" class="i">+                    // FIXME Handle multiple FROM tables
</a><a href="#h17-0-119" id="h17-0-119" class="i">+                    Some(from) =&gt; Scan::new(from.tables[0].clone()).into(),
</a><a href="#h17-0-120" id="h17-0-120" class="i">+                    None if select.expressions.is_empty() =&gt; {
</a><a href="#h17-0-121" id="h17-0-121" class="i">+                        return Err(Error::Value(&quot;Can&#39;t select * without a table&quot;.into()))
</a><a href="#h17-0-122" id="h17-0-122" class="i">+                    }
</a><a href="#h17-0-123" id="h17-0-123" class="i">+                    None =&gt; Nothing::new().into(),
</a><a href="#h17-0-124" id="h17-0-124" class="i">+                };
</a><a href="#h17-0-125" id="h17-0-125" class="i">+                if !select.expressions.is_empty() {
</a><a href="#h17-0-126" id="h17-0-126" class="i">+                    n = Projection::new(
</a><a href="#h17-0-127" id="h17-0-127" class="i">+                        n,
</a><a href="#h17-0-128" id="h17-0-128" class="i">+                        select
</a><a href="#h17-0-129" id="h17-0-129" class="i">+                            .labels
</a><a href="#h17-0-130" id="h17-0-130" class="i">+                            .into_iter()
</a><a href="#h17-0-131" id="h17-0-131" class="i">+                            .map(|l| l.unwrap_or_else(|| &quot;?&quot;.into()))
</a><a href="#h17-0-132" id="h17-0-132" class="i">+                            .collect(),
</a><a href="#h17-0-133" id="h17-0-133" class="i">+                        self.build_expressions(select.expressions)?,
</a><a href="#h17-0-134" id="h17-0-134" class="i">+                    )
</a><a href="#h17-0-135" id="h17-0-135" class="i">+                    .into();
</a><a href="#h17-0-136" id="h17-0-136" class="i">+                };
</a><a href="#h17-0-137" id="h17-0-137" class="i">+                n
</a><a href="#h17-0-138" id="h17-0-138" class="i">+            }
</a><a href="#h17-0-139" id="h17-0-139" class="i">+        })
</a><a href="#h17-0-140" id="h17-0-140" class="i">+    }
</a><a href="#h17-0-141" id="h17-0-141" class="i">+
</a><a href="#h17-0-142" id="h17-0-142" class="i">+    /// Builds a plan expression from an AST expression
</a><a href="#h17-0-143" id="h17-0-143" class="i">+    fn build_expression(&amp;self, expr: ast::Expression) -&gt; Result&lt;Expression, Error&gt; {
</a><a href="#h17-0-144" id="h17-0-144" class="i">+        Ok(expr.into())
</a><a href="#h17-0-145" id="h17-0-145" class="i">+    }
</a><a href="#h17-0-146" id="h17-0-146" class="i">+
</a><a href="#h17-0-147" id="h17-0-147" class="i">+    /// Builds an array of plan expressions from AST expressions
</a><a href="#h17-0-148" id="h17-0-148" class="i">+    fn build_expressions(&amp;self, exprs: Vec&lt;ast::Expression&gt;) -&gt; Result&lt;Vec&lt;Expression&gt;, Error&gt; {
</a><a href="#h17-0-149" id="h17-0-149" class="i">+        exprs.into_iter().map(|e| self.build_expression(e)).collect()
</a><a href="#h17-0-150" id="h17-0-150" class="i">+    }
</a><a href="#h17-0-151" id="h17-0-151" class="i">+
</a><a href="#h17-0-152" id="h17-0-152" class="i">+    /// Builds a table schema from an AST CreateTable node
</a><a href="#h17-0-153" id="h17-0-153" class="i">+    fn build_schema_table(
</a><a href="#h17-0-154" id="h17-0-154" class="i">+        &amp;self,
</a><a href="#h17-0-155" id="h17-0-155" class="i">+        name: String,
</a><a href="#h17-0-156" id="h17-0-156" class="i">+        columnspecs: Vec&lt;ast::ColumnSpec&gt;,
</a><a href="#h17-0-157" id="h17-0-157" class="i">+    ) -&gt; Result&lt;schema::Table, Error&gt; {
</a><a href="#h17-0-158" id="h17-0-158" class="i">+        let primary_keys: Vec&lt;&amp;ast::ColumnSpec&gt; =
</a><a href="#h17-0-159" id="h17-0-159" class="i">+            columnspecs.iter().filter(|c| c.primary_key).collect();
</a><a href="#h17-0-160" id="h17-0-160" class="i">+        if primary_keys.is_empty() {
</a><a href="#h17-0-161" id="h17-0-161" class="i">+            return Err(Error::Value(format!(&quot;No primary key defined for table {}&quot;, name)));
</a><a href="#h17-0-162" id="h17-0-162" class="i">+        } else if primary_keys.len() &gt; 1 {
</a><a href="#h17-0-163" id="h17-0-163" class="i">+            return Err(Error::Value(format!(
</a><a href="#h17-0-164" id="h17-0-164" class="i">+                &quot;{} primary keys defined for table {}, must set exactly 1&quot;,
</a><a href="#h17-0-165" id="h17-0-165" class="i">+                primary_keys.len(),
</a><a href="#h17-0-166" id="h17-0-166" class="i">+                name
</a><a href="#h17-0-167" id="h17-0-167" class="i">+            )));
</a><a href="#h17-0-168" id="h17-0-168" class="i">+        }
</a><a href="#h17-0-169" id="h17-0-169" class="i">+        let primary_key = primary_keys[0];
</a><a href="#h17-0-170" id="h17-0-170" class="i">+        if let Some(true) = primary_key.nullable {
</a><a href="#h17-0-171" id="h17-0-171" class="i">+            return Err(Error::Value(&quot;Primary key cannot be nullable&quot;.into()));
</a><a href="#h17-0-172" id="h17-0-172" class="i">+        }
</a><a href="#h17-0-173" id="h17-0-173" class="i">+
</a><a href="#h17-0-174" id="h17-0-174" class="i">+        Ok(schema::Table {
</a><a href="#h17-0-175" id="h17-0-175" class="i">+            name,
</a><a href="#h17-0-176" id="h17-0-176" class="i">+            primary_key: primary_key.name.clone(),
</a><a href="#h17-0-177" id="h17-0-177" class="i">+            columns: columnspecs
</a><a href="#h17-0-178" id="h17-0-178" class="i">+                .into_iter()
</a><a href="#h17-0-179" id="h17-0-179" class="i">+                .map(|spec| schema::Column {
</a><a href="#h17-0-180" id="h17-0-180" class="i">+                    name: spec.name,
</a><a href="#h17-0-181" id="h17-0-181" class="i">+                    datatype: spec.datatype,
</a><a href="#h17-0-182" id="h17-0-182" class="i">+                    nullable: spec.nullable.unwrap_or(!spec.primary_key),
</a><a href="#h17-0-183" id="h17-0-183" class="i">+                })
</a><a href="#h17-0-184" id="h17-0-184" class="i">+                .collect(),
</a><a href="#h17-0-185" id="h17-0-185" class="i">+        })
</a><a href="#h17-0-186" id="h17-0-186" class="i">+    }
</a><a href="#h17-0-187" id="h17-0-187" class="i">+}
</a><a href="#h17-0-188" id="h17-0-188" class="i">+
</a><a href="#h17-0-189" id="h17-0-189" class="i">+/// Helpers to convert AST expressions into plan expressions
</a><a href="#h17-0-190" id="h17-0-190" class="i">+impl From&lt;ast::Expression&gt; for Expression {
</a><a href="#h17-0-191" id="h17-0-191" class="i">+    fn from(expr: ast::Expression) -&gt; Self {
</a><a href="#h17-0-192" id="h17-0-192" class="i">+        match expr {
</a><a href="#h17-0-193" id="h17-0-193" class="i">+            ast::Expression::Literal(l) =&gt; Expression::Constant(l.into()),
</a><a href="#h17-0-194" id="h17-0-194" class="i">+            ast::Expression::Operation(op) =&gt; match op {
</a><a href="#h17-0-195" id="h17-0-195" class="i">+                // Logical operators
</a><a href="#h17-0-196" id="h17-0-196" class="i">+                ast::Operation::And(lhs, rhs) =&gt; Self::And(lhs.into(), rhs.into()),
</a><a href="#h17-0-197" id="h17-0-197" class="i">+                ast::Operation::Not(expr) =&gt; Self::Not(expr.into()),
</a><a href="#h17-0-198" id="h17-0-198" class="i">+                ast::Operation::Or(lhs, rhs) =&gt; Self::Or(lhs.into(), rhs.into()),
</a><a href="#h17-0-199" id="h17-0-199" class="i">+
</a><a href="#h17-0-200" id="h17-0-200" class="i">+                // Comparison operators
</a><a href="#h17-0-201" id="h17-0-201" class="i">+                ast::Operation::CompareEQ(lhs, rhs) =&gt; Self::CompareEQ(lhs.into(), rhs.into()),
</a><a href="#h17-0-202" id="h17-0-202" class="i">+                ast::Operation::CompareGT(lhs, rhs) =&gt; Self::CompareGT(lhs.into(), rhs.into()),
</a><a href="#h17-0-203" id="h17-0-203" class="i">+                ast::Operation::CompareGTE(lhs, rhs) =&gt; Self::CompareGTE(lhs.into(), rhs.into()),
</a><a href="#h17-0-204" id="h17-0-204" class="i">+                ast::Operation::CompareLT(lhs, rhs) =&gt; Self::CompareLT(lhs.into(), rhs.into()),
</a><a href="#h17-0-205" id="h17-0-205" class="i">+                ast::Operation::CompareLTE(lhs, rhs) =&gt; Self::CompareLTE(lhs.into(), rhs.into()),
</a><a href="#h17-0-206" id="h17-0-206" class="i">+                ast::Operation::CompareNE(lhs, rhs) =&gt; Self::CompareNE(lhs.into(), rhs.into()),
</a><a href="#h17-0-207" id="h17-0-207" class="i">+
</a><a href="#h17-0-208" id="h17-0-208" class="i">+                // Mathematical operators
</a><a href="#h17-0-209" id="h17-0-209" class="i">+                ast::Operation::Add(lhs, rhs) =&gt; Self::Add(lhs.into(), rhs.into()),
</a><a href="#h17-0-210" id="h17-0-210" class="i">+                ast::Operation::Divide(lhs, rhs) =&gt; Self::Divide(lhs.into(), rhs.into()),
</a><a href="#h17-0-211" id="h17-0-211" class="i">+                ast::Operation::Exponentiate(lhs, rhs) =&gt; {
</a><a href="#h17-0-212" id="h17-0-212" class="i">+                    Self::Exponentiate(lhs.into(), rhs.into())
</a><a href="#h17-0-213" id="h17-0-213" class="i">+                }
</a><a href="#h17-0-214" id="h17-0-214" class="i">+                ast::Operation::Factorial(expr) =&gt; Self::Factorial(expr.into()),
</a><a href="#h17-0-215" id="h17-0-215" class="i">+                ast::Operation::Modulo(lhs, rhs) =&gt; Self::Modulo(lhs.into(), rhs.into()),
</a><a href="#h17-0-216" id="h17-0-216" class="i">+                ast::Operation::Multiply(lhs, rhs) =&gt; Self::Multiply(lhs.into(), rhs.into()),
</a><a href="#h17-0-217" id="h17-0-217" class="i">+                ast::Operation::Negate(expr) =&gt; Self::Negate(expr.into()),
</a><a href="#h17-0-218" id="h17-0-218" class="i">+                ast::Operation::Subtract(lhs, rhs) =&gt; Self::Subtract(lhs.into(), rhs.into()),
</a><a href="#h17-0-219" id="h17-0-219" class="i">+            },
</a><a href="#h17-0-220" id="h17-0-220" class="i">+        }
</a><a href="#h17-0-221" id="h17-0-221" class="i">+    }
</a><a href="#h17-0-222" id="h17-0-222" class="i">+}
</a><a href="#h17-0-223" id="h17-0-223" class="i">+
</a><a href="#h17-0-224" id="h17-0-224" class="i">+impl From&lt;Box&lt;ast::Expression&gt;&gt; for Box&lt;Expression&gt; {
</a><a href="#h17-0-225" id="h17-0-225" class="i">+    fn from(expr: Box&lt;ast::Expression&gt;) -&gt; Self {
</a><a href="#h17-0-226" id="h17-0-226" class="i">+        Box::new((*expr).into())
</a><a href="#h17-0-227" id="h17-0-227" class="i">+    }
</a><a href="#h17-0-228" id="h17-0-228" class="i">+}
</a><a href="#h17-0-229" id="h17-0-229" class="i">+
</a><a href="#h17-0-230" id="h17-0-230" class="i">+impl From&lt;ast::Literal&gt; for Value {
</a><a href="#h17-0-231" id="h17-0-231" class="i">+    fn from(literal: ast::Literal) -&gt; Self {
</a><a href="#h17-0-232" id="h17-0-232" class="i">+        match literal {
</a><a href="#h17-0-233" id="h17-0-233" class="i">+            ast::Literal::Null =&gt; Value::Null,
</a><a href="#h17-0-234" id="h17-0-234" class="i">+            ast::Literal::Boolean(b) =&gt; b.into(),
</a><a href="#h17-0-235" id="h17-0-235" class="i">+            ast::Literal::Float(f) =&gt; f.into(),
</a><a href="#h17-0-236" id="h17-0-236" class="i">+            ast::Literal::Integer(i) =&gt; i.into(),
</a><a href="#h17-0-237" id="h17-0-237" class="i">+            ast::Literal::String(s) =&gt; s.into(),
</a><a href="#h17-0-238" id="h17-0-238" class="i">+        }
</a><a href="#h17-0-239" id="h17-0-239" class="i">+    }
</a><a href="#h17-0-240" id="h17-0-240" class="i">+}
</a><b>diff --git a/<a id="h18" href="../file/src/sql/plan/node.rs.html">src/sql/plan/node.rs</a> b/<a href="../file/src/sql/plan/node.rs.html">src/sql/plan/node.rs</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -1,82 +0,0 @@
</a><a href="#h18-0-0" id="h18-0-0" class="d">-use super::super::schema;
</a><a href="#h18-0-1" id="h18-0-1" class="d">-use super::super::storage::Storage;
</a><a href="#h18-0-2" id="h18-0-2" class="d">-use super::super::types::Row;
</a><a href="#h18-0-3" id="h18-0-3" class="d">-use super::expression::{Expression, Expressions};
</a><a href="#h18-0-4" id="h18-0-4" class="d">-use crate::Error;
</a><a href="#h18-0-5" id="h18-0-5" class="d">-
</a><a href="#h18-0-6" id="h18-0-6" class="d">-/// A plan node
</a><a href="#h18-0-7" id="h18-0-7" class="d">-#[derive(Debug)]
</a><a href="#h18-0-8" id="h18-0-8" class="d">-pub enum Node {
</a><a href="#h18-0-9" id="h18-0-9" class="d">-    DDL { storage: Box&lt;Storage&gt;, ddl: DDL },
</a><a href="#h18-0-10" id="h18-0-10" class="d">-    DML { storage: Box&lt;Storage&gt;, dml: DML },
</a><a href="#h18-0-11" id="h18-0-11" class="d">-    Projection { labels: Vec&lt;String&gt;, source: Box&lt;Node&gt;, expressions: Vec&lt;Expression&gt; },
</a><a href="#h18-0-12" id="h18-0-12" class="d">-    Nothing { done: bool },
</a><a href="#h18-0-13" id="h18-0-13" class="d">-}
</a><a href="#h18-0-14" id="h18-0-14" class="d">-
</a><a href="#h18-0-15" id="h18-0-15" class="d">-impl Iterator for Node {
</a><a href="#h18-0-16" id="h18-0-16" class="d">-    type Item = Result&lt;Row, Error&gt;;
</a><a href="#h18-0-17" id="h18-0-17" class="d">-
</a><a href="#h18-0-18" id="h18-0-18" class="d">-    fn next(&amp;mut self) -&gt; Option&lt;Result&lt;Row, Error&gt;&gt; {
</a><a href="#h18-0-19" id="h18-0-19" class="d">-        match self {
</a><a href="#h18-0-20" id="h18-0-20" class="d">-            Node::DDL { storage, ddl } =&gt; match ddl.execute(*storage.clone()) {
</a><a href="#h18-0-21" id="h18-0-21" class="d">-                Err(err) =&gt; Some(Err(err)),
</a><a href="#h18-0-22" id="h18-0-22" class="d">-                _ =&gt; None,
</a><a href="#h18-0-23" id="h18-0-23" class="d">-            },
</a><a href="#h18-0-24" id="h18-0-24" class="d">-            Node::DML { storage, dml } =&gt; match dml.execute(*storage.clone()) {
</a><a href="#h18-0-25" id="h18-0-25" class="d">-                Err(err) =&gt; Some(Err(err)),
</a><a href="#h18-0-26" id="h18-0-26" class="d">-                _ =&gt; None,
</a><a href="#h18-0-27" id="h18-0-27" class="d">-            },
</a><a href="#h18-0-28" id="h18-0-28" class="d">-            Node::Projection { source, expressions, .. } =&gt; match source.next()? {
</a><a href="#h18-0-29" id="h18-0-29" class="d">-                Err(err) =&gt; Some(Err(err)),
</a><a href="#h18-0-30" id="h18-0-30" class="d">-                _ =&gt; Some(expressions.iter().map(|e| e.evaluate()).collect()),
</a><a href="#h18-0-31" id="h18-0-31" class="d">-            },
</a><a href="#h18-0-32" id="h18-0-32" class="d">-            Node::Nothing { ref mut done } =&gt; {
</a><a href="#h18-0-33" id="h18-0-33" class="d">-                if !*done {
</a><a href="#h18-0-34" id="h18-0-34" class="d">-                    *done = true;
</a><a href="#h18-0-35" id="h18-0-35" class="d">-                    Some(Ok(vec![]))
</a><a href="#h18-0-36" id="h18-0-36" class="d">-                } else {
</a><a href="#h18-0-37" id="h18-0-37" class="d">-                    None
</a><a href="#h18-0-38" id="h18-0-38" class="d">-                }
</a><a href="#h18-0-39" id="h18-0-39" class="d">-            }
</a><a href="#h18-0-40" id="h18-0-40" class="d">-        }
</a><a href="#h18-0-41" id="h18-0-41" class="d">-    }
</a><a href="#h18-0-42" id="h18-0-42" class="d">-}
</a><a href="#h18-0-43" id="h18-0-43" class="d">-
</a><a href="#h18-0-44" id="h18-0-44" class="d">-/// A DDL operation
</a><a href="#h18-0-45" id="h18-0-45" class="d">-#[derive(Debug)]
</a><a href="#h18-0-46" id="h18-0-46" class="d">-pub enum DDL {
</a><a href="#h18-0-47" id="h18-0-47" class="d">-    CreateTable(schema::Table),
</a><a href="#h18-0-48" id="h18-0-48" class="d">-    DropTable(String),
</a><a href="#h18-0-49" id="h18-0-49" class="d">-}
</a><a href="#h18-0-50" id="h18-0-50" class="d">-
</a><a href="#h18-0-51" id="h18-0-51" class="d">-impl DDL {
</a><a href="#h18-0-52" id="h18-0-52" class="d">-    fn execute(&amp;self, mut storage: Storage) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h18-0-53" id="h18-0-53" class="d">-        match self {
</a><a href="#h18-0-54" id="h18-0-54" class="d">-            Self::CreateTable(schema) =&gt; storage.create_table(schema.clone()),
</a><a href="#h18-0-55" id="h18-0-55" class="d">-            Self::DropTable(name) =&gt; storage.drop_table(name),
</a><a href="#h18-0-56" id="h18-0-56" class="d">-        }
</a><a href="#h18-0-57" id="h18-0-57" class="d">-    }
</a><a href="#h18-0-58" id="h18-0-58" class="d">-}
</a><a href="#h18-0-59" id="h18-0-59" class="d">-
</a><a href="#h18-0-60" id="h18-0-60" class="d">-/// A DML operation
</a><a href="#h18-0-61" id="h18-0-61" class="d">-#[derive(Debug)]
</a><a href="#h18-0-62" id="h18-0-62" class="d">-pub enum DML {
</a><a href="#h18-0-63" id="h18-0-63" class="d">-    Insert(String, Vec&lt;Expressions&gt;),
</a><a href="#h18-0-64" id="h18-0-64" class="d">-}
</a><a href="#h18-0-65" id="h18-0-65" class="d">-
</a><a href="#h18-0-66" id="h18-0-66" class="d">-impl DML {
</a><a href="#h18-0-67" id="h18-0-67" class="d">-    fn execute(&amp;self, mut storage: Storage) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h18-0-68" id="h18-0-68" class="d">-        match self {
</a><a href="#h18-0-69" id="h18-0-69" class="d">-            Self::Insert(table, values) =&gt; {
</a><a href="#h18-0-70" id="h18-0-70" class="d">-                for exprs in values {
</a><a href="#h18-0-71" id="h18-0-71" class="d">-                    let mut row = Row::new();
</a><a href="#h18-0-72" id="h18-0-72" class="d">-                    for expr in exprs {
</a><a href="#h18-0-73" id="h18-0-73" class="d">-                        row.push(expr.evaluate()?);
</a><a href="#h18-0-74" id="h18-0-74" class="d">-                    }
</a><a href="#h18-0-75" id="h18-0-75" class="d">-                    storage.create_row(table, row)?;
</a><a href="#h18-0-76" id="h18-0-76" class="d">-                }
</a><a href="#h18-0-77" id="h18-0-77" class="d">-                Ok(())
</a><a href="#h18-0-78" id="h18-0-78" class="d">-            }
</a><a href="#h18-0-79" id="h18-0-79" class="d">-        }
</a><a href="#h18-0-80" id="h18-0-80" class="d">-    }
</a><a href="#h18-0-81" id="h18-0-81" class="d">-}
</a><b>diff --git a/<a id="h19" href="../file/src/sql/plan/nothing.rs.html">src/sql/plan/nothing.rs</a> b/<a href="../file/src/sql/plan/nothing.rs.html">src/sql/plan/nothing.rs</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -0,0 +1,36 @@
</a><a href="#h19-0-0" id="h19-0-0" class="i">+use super::super::types::Row;
</a><a href="#h19-0-1" id="h19-0-1" class="i">+use super::{Context, Node};
</a><a href="#h19-0-2" id="h19-0-2" class="i">+use crate::Error;
</a><a href="#h19-0-3" id="h19-0-3" class="i">+
</a><a href="#h19-0-4" id="h19-0-4" class="i">+/// A source node which produces a single empty row
</a><a href="#h19-0-5" id="h19-0-5" class="i">+#[derive(Derivative)]
</a><a href="#h19-0-6" id="h19-0-6" class="i">+#[derivative(Debug)]
</a><a href="#h19-0-7" id="h19-0-7" class="i">+pub struct Nothing {
</a><a href="#h19-0-8" id="h19-0-8" class="i">+    #[derivative(Debug = &quot;ignore&quot;)]
</a><a href="#h19-0-9" id="h19-0-9" class="i">+    done: bool,
</a><a href="#h19-0-10" id="h19-0-10" class="i">+}
</a><a href="#h19-0-11" id="h19-0-11" class="i">+
</a><a href="#h19-0-12" id="h19-0-12" class="i">+impl Nothing {
</a><a href="#h19-0-13" id="h19-0-13" class="i">+    pub fn new() -&gt; Self {
</a><a href="#h19-0-14" id="h19-0-14" class="i">+        Self { done: false }
</a><a href="#h19-0-15" id="h19-0-15" class="i">+    }
</a><a href="#h19-0-16" id="h19-0-16" class="i">+}
</a><a href="#h19-0-17" id="h19-0-17" class="i">+
</a><a href="#h19-0-18" id="h19-0-18" class="i">+impl Node for Nothing {
</a><a href="#h19-0-19" id="h19-0-19" class="i">+    fn execute(&amp;mut self, _: &amp;mut Context) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h19-0-20" id="h19-0-20" class="i">+        Ok(())
</a><a href="#h19-0-21" id="h19-0-21" class="i">+    }
</a><a href="#h19-0-22" id="h19-0-22" class="i">+}
</a><a href="#h19-0-23" id="h19-0-23" class="i">+
</a><a href="#h19-0-24" id="h19-0-24" class="i">+impl Iterator for Nothing {
</a><a href="#h19-0-25" id="h19-0-25" class="i">+    type Item = Result&lt;Row, Error&gt;;
</a><a href="#h19-0-26" id="h19-0-26" class="i">+
</a><a href="#h19-0-27" id="h19-0-27" class="i">+    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
</a><a href="#h19-0-28" id="h19-0-28" class="i">+        if self.done {
</a><a href="#h19-0-29" id="h19-0-29" class="i">+            None
</a><a href="#h19-0-30" id="h19-0-30" class="i">+        } else {
</a><a href="#h19-0-31" id="h19-0-31" class="i">+            self.done = true;
</a><a href="#h19-0-32" id="h19-0-32" class="i">+            Some(Ok(Row::new()))
</a><a href="#h19-0-33" id="h19-0-33" class="i">+        }
</a><a href="#h19-0-34" id="h19-0-34" class="i">+    }
</a><a href="#h19-0-35" id="h19-0-35" class="i">+}
</a><b>diff --git a/<a id="h20" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -1,162 +0,0 @@
</a><a href="#h20-0-0" id="h20-0-0" class="d">-use super::super::parser::ast;
</a><a href="#h20-0-1" id="h20-0-1" class="d">-use super::super::schema;
</a><a href="#h20-0-2" id="h20-0-2" class="d">-use super::super::storage::Storage;
</a><a href="#h20-0-3" id="h20-0-3" class="d">-use super::super::types::Value;
</a><a href="#h20-0-4" id="h20-0-4" class="d">-use super::expression::Expression;
</a><a href="#h20-0-5" id="h20-0-5" class="d">-use super::node::{Node, DDL, DML};
</a><a href="#h20-0-6" id="h20-0-6" class="d">-use super::Plan;
</a><a href="#h20-0-7" id="h20-0-7" class="d">-use crate::Error;
</a><a href="#h20-0-8" id="h20-0-8" class="d">-
</a><a href="#h20-0-9" id="h20-0-9" class="d">-pub struct Planner {
</a><a href="#h20-0-10" id="h20-0-10" class="d">-    storage: Box&lt;Storage&gt;,
</a><a href="#h20-0-11" id="h20-0-11" class="d">-}
</a><a href="#h20-0-12" id="h20-0-12" class="d">-
</a><a href="#h20-0-13" id="h20-0-13" class="d">-impl Planner {
</a><a href="#h20-0-14" id="h20-0-14" class="d">-    /// Creates a new planner
</a><a href="#h20-0-15" id="h20-0-15" class="d">-    pub fn new(storage: Box&lt;Storage&gt;) -&gt; Self {
</a><a href="#h20-0-16" id="h20-0-16" class="d">-        Self { storage }
</a><a href="#h20-0-17" id="h20-0-17" class="d">-    }
</a><a href="#h20-0-18" id="h20-0-18" class="d">-
</a><a href="#h20-0-19" id="h20-0-19" class="d">-    /// Builds a plan tree for an AST statement
</a><a href="#h20-0-20" id="h20-0-20" class="d">-    pub fn build(&amp;self, statement: ast::Statement) -&gt; Result&lt;Plan, Error&gt; {
</a><a href="#h20-0-21" id="h20-0-21" class="d">-        let root = self.build_statement(statement)?;
</a><a href="#h20-0-22" id="h20-0-22" class="d">-        Ok(Plan {
</a><a href="#h20-0-23" id="h20-0-23" class="d">-            columns: match &amp;root {
</a><a href="#h20-0-24" id="h20-0-24" class="d">-                Node::Projection { labels, .. } =&gt; labels.clone(),
</a><a href="#h20-0-25" id="h20-0-25" class="d">-                Node::DDL { .. } =&gt; vec![],
</a><a href="#h20-0-26" id="h20-0-26" class="d">-                Node::DML { .. } =&gt; vec![],
</a><a href="#h20-0-27" id="h20-0-27" class="d">-                _ =&gt; panic!(&quot;Not implemented&quot;),
</a><a href="#h20-0-28" id="h20-0-28" class="d">-            },
</a><a href="#h20-0-29" id="h20-0-29" class="d">-            root,
</a><a href="#h20-0-30" id="h20-0-30" class="d">-        })
</a><a href="#h20-0-31" id="h20-0-31" class="d">-    }
</a><a href="#h20-0-32" id="h20-0-32" class="d">-
</a><a href="#h20-0-33" id="h20-0-33" class="d">-    /// Builds a plan node for a statement
</a><a href="#h20-0-34" id="h20-0-34" class="d">-    fn build_statement(&amp;self, statement: ast::Statement) -&gt; Result&lt;Node, Error&gt; {
</a><a href="#h20-0-35" id="h20-0-35" class="d">-        Ok(match statement {
</a><a href="#h20-0-36" id="h20-0-36" class="d">-            ast::Statement::CreateTable { name, columns } =&gt; Node::DDL {
</a><a href="#h20-0-37" id="h20-0-37" class="d">-                storage: self.storage.clone(),
</a><a href="#h20-0-38" id="h20-0-38" class="d">-                ddl: DDL::CreateTable(self.build_schema_table(name, columns)?),
</a><a href="#h20-0-39" id="h20-0-39" class="d">-            },
</a><a href="#h20-0-40" id="h20-0-40" class="d">-            ast::Statement::DropTable(name) =&gt; {
</a><a href="#h20-0-41" id="h20-0-41" class="d">-                Node::DDL { storage: self.storage.clone(), ddl: DDL::DropTable(name) }
</a><a href="#h20-0-42" id="h20-0-42" class="d">-            }
</a><a href="#h20-0-43" id="h20-0-43" class="d">-            ast::Statement::Insert { table, values, .. } =&gt; {
</a><a href="#h20-0-44" id="h20-0-44" class="d">-                // FIXME Needs to handle columns
</a><a href="#h20-0-45" id="h20-0-45" class="d">-                let values = values
</a><a href="#h20-0-46" id="h20-0-46" class="d">-                    .into_iter()
</a><a href="#h20-0-47" id="h20-0-47" class="d">-                    .map(|exprs| exprs.into_iter().map(|expr| expr.into()).collect())
</a><a href="#h20-0-48" id="h20-0-48" class="d">-                    .collect();
</a><a href="#h20-0-49" id="h20-0-49" class="d">-                Node::DML { storage: self.storage.clone(), dml: DML::Insert(table, values) }
</a><a href="#h20-0-50" id="h20-0-50" class="d">-            }
</a><a href="#h20-0-51" id="h20-0-51" class="d">-            ast::Statement::Select { select } =&gt; Node::Projection {
</a><a href="#h20-0-52" id="h20-0-52" class="d">-                labels: select
</a><a href="#h20-0-53" id="h20-0-53" class="d">-                    .labels
</a><a href="#h20-0-54" id="h20-0-54" class="d">-                    .into_iter()
</a><a href="#h20-0-55" id="h20-0-55" class="d">-                    .map(|l| l.unwrap_or_else(|| &quot;?&quot;.into()))
</a><a href="#h20-0-56" id="h20-0-56" class="d">-                    .collect(),
</a><a href="#h20-0-57" id="h20-0-57" class="d">-                expressions: self.build_expressions(select.expressions)?,
</a><a href="#h20-0-58" id="h20-0-58" class="d">-                source: Box::new(Node::Nothing { done: false }),
</a><a href="#h20-0-59" id="h20-0-59" class="d">-            },
</a><a href="#h20-0-60" id="h20-0-60" class="d">-        })
</a><a href="#h20-0-61" id="h20-0-61" class="d">-    }
</a><a href="#h20-0-62" id="h20-0-62" class="d">-
</a><a href="#h20-0-63" id="h20-0-63" class="d">-    /// Builds a plan expression from an AST expression
</a><a href="#h20-0-64" id="h20-0-64" class="d">-    fn build_expression(&amp;self, expr: ast::Expression) -&gt; Result&lt;Expression, Error&gt; {
</a><a href="#h20-0-65" id="h20-0-65" class="d">-        Ok(expr.into())
</a><a href="#h20-0-66" id="h20-0-66" class="d">-    }
</a><a href="#h20-0-67" id="h20-0-67" class="d">-
</a><a href="#h20-0-68" id="h20-0-68" class="d">-    /// Builds an array of plan expressions from AST expressions
</a><a href="#h20-0-69" id="h20-0-69" class="d">-    fn build_expressions(&amp;self, exprs: Vec&lt;ast::Expression&gt;) -&gt; Result&lt;Vec&lt;Expression&gt;, Error&gt; {
</a><a href="#h20-0-70" id="h20-0-70" class="d">-        exprs.into_iter().map(|e| self.build_expression(e)).collect()
</a><a href="#h20-0-71" id="h20-0-71" class="d">-    }
</a><a href="#h20-0-72" id="h20-0-72" class="d">-
</a><a href="#h20-0-73" id="h20-0-73" class="d">-    /// Builds a table schema from an AST CreateTable node
</a><a href="#h20-0-74" id="h20-0-74" class="d">-    fn build_schema_table(
</a><a href="#h20-0-75" id="h20-0-75" class="d">-        &amp;self,
</a><a href="#h20-0-76" id="h20-0-76" class="d">-        name: String,
</a><a href="#h20-0-77" id="h20-0-77" class="d">-        columnspecs: Vec&lt;ast::ColumnSpec&gt;,
</a><a href="#h20-0-78" id="h20-0-78" class="d">-    ) -&gt; Result&lt;schema::Table, Error&gt; {
</a><a href="#h20-0-79" id="h20-0-79" class="d">-        let primary_keys: Vec&lt;&amp;ast::ColumnSpec&gt; =
</a><a href="#h20-0-80" id="h20-0-80" class="d">-            columnspecs.iter().filter(|c| c.primary_key).collect();
</a><a href="#h20-0-81" id="h20-0-81" class="d">-        if primary_keys.is_empty() {
</a><a href="#h20-0-82" id="h20-0-82" class="d">-            return Err(Error::Value(format!(&quot;No primary key defined for table {}&quot;, name)));
</a><a href="#h20-0-83" id="h20-0-83" class="d">-        } else if primary_keys.len() &gt; 1 {
</a><a href="#h20-0-84" id="h20-0-84" class="d">-            return Err(Error::Value(format!(
</a><a href="#h20-0-85" id="h20-0-85" class="d">-                &quot;{} primary keys defined for table {}, must set exactly 1&quot;,
</a><a href="#h20-0-86" id="h20-0-86" class="d">-                primary_keys.len(),
</a><a href="#h20-0-87" id="h20-0-87" class="d">-                name
</a><a href="#h20-0-88" id="h20-0-88" class="d">-            )));
</a><a href="#h20-0-89" id="h20-0-89" class="d">-        }
</a><a href="#h20-0-90" id="h20-0-90" class="d">-        let primary_key = primary_keys[0];
</a><a href="#h20-0-91" id="h20-0-91" class="d">-        if let Some(true) = primary_key.nullable {
</a><a href="#h20-0-92" id="h20-0-92" class="d">-            return Err(Error::Value(&quot;Primary key cannot be nullable&quot;.into()));
</a><a href="#h20-0-93" id="h20-0-93" class="d">-        }
</a><a href="#h20-0-94" id="h20-0-94" class="d">-
</a><a href="#h20-0-95" id="h20-0-95" class="d">-        Ok(schema::Table {
</a><a href="#h20-0-96" id="h20-0-96" class="d">-            name,
</a><a href="#h20-0-97" id="h20-0-97" class="d">-            primary_key: primary_key.name.clone(),
</a><a href="#h20-0-98" id="h20-0-98" class="d">-            columns: columnspecs
</a><a href="#h20-0-99" id="h20-0-99" class="d">-                .into_iter()
</a><a href="#h20-0-100" id="h20-0-100" class="d">-                .map(|spec| schema::Column {
</a><a href="#h20-0-101" id="h20-0-101" class="d">-                    name: spec.name,
</a><a href="#h20-0-102" id="h20-0-102" class="d">-                    datatype: spec.datatype,
</a><a href="#h20-0-103" id="h20-0-103" class="d">-                    nullable: spec.nullable.unwrap_or(!spec.primary_key),
</a><a href="#h20-0-104" id="h20-0-104" class="d">-                })
</a><a href="#h20-0-105" id="h20-0-105" class="d">-                .collect(),
</a><a href="#h20-0-106" id="h20-0-106" class="d">-        })
</a><a href="#h20-0-107" id="h20-0-107" class="d">-    }
</a><a href="#h20-0-108" id="h20-0-108" class="d">-}
</a><a href="#h20-0-109" id="h20-0-109" class="d">-
</a><a href="#h20-0-110" id="h20-0-110" class="d">-/// Helpers to convert AST expressions into plan expressions
</a><a href="#h20-0-111" id="h20-0-111" class="d">-impl From&lt;ast::Expression&gt; for Expression {
</a><a href="#h20-0-112" id="h20-0-112" class="d">-    fn from(expr: ast::Expression) -&gt; Self {
</a><a href="#h20-0-113" id="h20-0-113" class="d">-        match expr {
</a><a href="#h20-0-114" id="h20-0-114" class="d">-            ast::Expression::Literal(l) =&gt; Expression::Constant(l.into()),
</a><a href="#h20-0-115" id="h20-0-115" class="d">-            ast::Expression::Operation(op) =&gt; match op {
</a><a href="#h20-0-116" id="h20-0-116" class="d">-                // Logical operators
</a><a href="#h20-0-117" id="h20-0-117" class="d">-                ast::Operation::And(lhs, rhs) =&gt; Self::And(lhs.into(), rhs.into()),
</a><a href="#h20-0-118" id="h20-0-118" class="d">-                ast::Operation::Not(expr) =&gt; Self::Not(expr.into()),
</a><a href="#h20-0-119" id="h20-0-119" class="d">-                ast::Operation::Or(lhs, rhs) =&gt; Self::Or(lhs.into(), rhs.into()),
</a><a href="#h20-0-120" id="h20-0-120" class="d">-
</a><a href="#h20-0-121" id="h20-0-121" class="d">-                // Comparison operators
</a><a href="#h20-0-122" id="h20-0-122" class="d">-                ast::Operation::CompareEQ(lhs, rhs) =&gt; Self::CompareEQ(lhs.into(), rhs.into()),
</a><a href="#h20-0-123" id="h20-0-123" class="d">-                ast::Operation::CompareGT(lhs, rhs) =&gt; Self::CompareGT(lhs.into(), rhs.into()),
</a><a href="#h20-0-124" id="h20-0-124" class="d">-                ast::Operation::CompareGTE(lhs, rhs) =&gt; Self::CompareGTE(lhs.into(), rhs.into()),
</a><a href="#h20-0-125" id="h20-0-125" class="d">-                ast::Operation::CompareLT(lhs, rhs) =&gt; Self::CompareLT(lhs.into(), rhs.into()),
</a><a href="#h20-0-126" id="h20-0-126" class="d">-                ast::Operation::CompareLTE(lhs, rhs) =&gt; Self::CompareLTE(lhs.into(), rhs.into()),
</a><a href="#h20-0-127" id="h20-0-127" class="d">-                ast::Operation::CompareNE(lhs, rhs) =&gt; Self::CompareNE(lhs.into(), rhs.into()),
</a><a href="#h20-0-128" id="h20-0-128" class="d">-
</a><a href="#h20-0-129" id="h20-0-129" class="d">-                // Mathematical operators
</a><a href="#h20-0-130" id="h20-0-130" class="d">-                ast::Operation::Add(lhs, rhs) =&gt; Self::Add(lhs.into(), rhs.into()),
</a><a href="#h20-0-131" id="h20-0-131" class="d">-                ast::Operation::Divide(lhs, rhs) =&gt; Self::Divide(lhs.into(), rhs.into()),
</a><a href="#h20-0-132" id="h20-0-132" class="d">-                ast::Operation::Exponentiate(lhs, rhs) =&gt; {
</a><a href="#h20-0-133" id="h20-0-133" class="d">-                    Self::Exponentiate(lhs.into(), rhs.into())
</a><a href="#h20-0-134" id="h20-0-134" class="d">-                }
</a><a href="#h20-0-135" id="h20-0-135" class="d">-                ast::Operation::Factorial(expr) =&gt; Self::Factorial(expr.into()),
</a><a href="#h20-0-136" id="h20-0-136" class="d">-                ast::Operation::Modulo(lhs, rhs) =&gt; Self::Modulo(lhs.into(), rhs.into()),
</a><a href="#h20-0-137" id="h20-0-137" class="d">-                ast::Operation::Multiply(lhs, rhs) =&gt; Self::Multiply(lhs.into(), rhs.into()),
</a><a href="#h20-0-138" id="h20-0-138" class="d">-                ast::Operation::Negate(expr) =&gt; Self::Negate(expr.into()),
</a><a href="#h20-0-139" id="h20-0-139" class="d">-                ast::Operation::Subtract(lhs, rhs) =&gt; Self::Subtract(lhs.into(), rhs.into()),
</a><a href="#h20-0-140" id="h20-0-140" class="d">-            },
</a><a href="#h20-0-141" id="h20-0-141" class="d">-        }
</a><a href="#h20-0-142" id="h20-0-142" class="d">-    }
</a><a href="#h20-0-143" id="h20-0-143" class="d">-}
</a><a href="#h20-0-144" id="h20-0-144" class="d">-
</a><a href="#h20-0-145" id="h20-0-145" class="d">-impl From&lt;Box&lt;ast::Expression&gt;&gt; for Box&lt;Expression&gt; {
</a><a href="#h20-0-146" id="h20-0-146" class="d">-    fn from(expr: Box&lt;ast::Expression&gt;) -&gt; Self {
</a><a href="#h20-0-147" id="h20-0-147" class="d">-        Box::new((*expr).into())
</a><a href="#h20-0-148" id="h20-0-148" class="d">-    }
</a><a href="#h20-0-149" id="h20-0-149" class="d">-}
</a><a href="#h20-0-150" id="h20-0-150" class="d">-
</a><a href="#h20-0-151" id="h20-0-151" class="d">-impl From&lt;ast::Literal&gt; for Value {
</a><a href="#h20-0-152" id="h20-0-152" class="d">-    fn from(literal: ast::Literal) -&gt; Self {
</a><a href="#h20-0-153" id="h20-0-153" class="d">-        match literal {
</a><a href="#h20-0-154" id="h20-0-154" class="d">-            ast::Literal::Null =&gt; Value::Null,
</a><a href="#h20-0-155" id="h20-0-155" class="d">-            ast::Literal::Boolean(b) =&gt; b.into(),
</a><a href="#h20-0-156" id="h20-0-156" class="d">-            ast::Literal::Float(f) =&gt; f.into(),
</a><a href="#h20-0-157" id="h20-0-157" class="d">-            ast::Literal::Integer(i) =&gt; i.into(),
</a><a href="#h20-0-158" id="h20-0-158" class="d">-            ast::Literal::String(s) =&gt; s.into(),
</a><a href="#h20-0-159" id="h20-0-159" class="d">-        }
</a><a href="#h20-0-160" id="h20-0-160" class="d">-    }
</a><a href="#h20-0-161" id="h20-0-161" class="d">-}
</a><b>diff --git a/<a id="h21" href="../file/src/sql/plan/projection.rs.html">src/sql/plan/projection.rs</a> b/<a href="../file/src/sql/plan/projection.rs.html">src/sql/plan/projection.rs</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -0,0 +1,35 @@
</a><a href="#h21-0-0" id="h21-0-0" class="i">+use super::super::expression::Expressions;
</a><a href="#h21-0-1" id="h21-0-1" class="i">+use super::super::types::Row;
</a><a href="#h21-0-2" id="h21-0-2" class="i">+use super::{Context, Node};
</a><a href="#h21-0-3" id="h21-0-3" class="i">+use crate::Error;
</a><a href="#h21-0-4" id="h21-0-4" class="i">+
</a><a href="#h21-0-5" id="h21-0-5" class="i">+/// A projection node
</a><a href="#h21-0-6" id="h21-0-6" class="i">+#[derive(Debug)]
</a><a href="#h21-0-7" id="h21-0-7" class="i">+pub struct Projection {
</a><a href="#h21-0-8" id="h21-0-8" class="i">+    source: Box&lt;dyn Node&gt;,
</a><a href="#h21-0-9" id="h21-0-9" class="i">+    labels: Vec&lt;String&gt;,
</a><a href="#h21-0-10" id="h21-0-10" class="i">+    expressions: Expressions,
</a><a href="#h21-0-11" id="h21-0-11" class="i">+}
</a><a href="#h21-0-12" id="h21-0-12" class="i">+
</a><a href="#h21-0-13" id="h21-0-13" class="i">+impl Projection {
</a><a href="#h21-0-14" id="h21-0-14" class="i">+    pub fn new(source: Box&lt;dyn Node&gt;, labels: Vec&lt;String&gt;, expressions: Expressions) -&gt; Self {
</a><a href="#h21-0-15" id="h21-0-15" class="i">+        Self { source, labels, expressions }
</a><a href="#h21-0-16" id="h21-0-16" class="i">+    }
</a><a href="#h21-0-17" id="h21-0-17" class="i">+}
</a><a href="#h21-0-18" id="h21-0-18" class="i">+
</a><a href="#h21-0-19" id="h21-0-19" class="i">+impl Node for Projection {
</a><a href="#h21-0-20" id="h21-0-20" class="i">+    fn execute(&amp;mut self, ctx: &amp;mut Context) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h21-0-21" id="h21-0-21" class="i">+        self.source.execute(ctx)
</a><a href="#h21-0-22" id="h21-0-22" class="i">+    }
</a><a href="#h21-0-23" id="h21-0-23" class="i">+}
</a><a href="#h21-0-24" id="h21-0-24" class="i">+
</a><a href="#h21-0-25" id="h21-0-25" class="i">+impl Iterator for Projection {
</a><a href="#h21-0-26" id="h21-0-26" class="i">+    type Item = Result&lt;Row, Error&gt;;
</a><a href="#h21-0-27" id="h21-0-27" class="i">+
</a><a href="#h21-0-28" id="h21-0-28" class="i">+    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
</a><a href="#h21-0-29" id="h21-0-29" class="i">+        match self.source.next()? {
</a><a href="#h21-0-30" id="h21-0-30" class="i">+            Err(err) =&gt; Some(Err(err)),
</a><a href="#h21-0-31" id="h21-0-31" class="i">+            _ =&gt; Some(self.expressions.iter().map(|e| e.evaluate()).collect()),
</a><a href="#h21-0-32" id="h21-0-32" class="i">+        }
</a><a href="#h21-0-33" id="h21-0-33" class="i">+    }
</a><a href="#h21-0-34" id="h21-0-34" class="i">+}
</a><b>diff --git a/<a id="h22" href="../file/src/sql/plan/scan.rs.html">src/sql/plan/scan.rs</a> b/<a href="../file/src/sql/plan/scan.rs.html">src/sql/plan/scan.rs</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -0,0 +1,36 @@
</a><a href="#h22-0-0" id="h22-0-0" class="i">+use super::super::types::Row;
</a><a href="#h22-0-1" id="h22-0-1" class="i">+use super::{Context, Node};
</a><a href="#h22-0-2" id="h22-0-2" class="i">+use crate::Error;
</a><a href="#h22-0-3" id="h22-0-3" class="i">+
</a><a href="#h22-0-4" id="h22-0-4" class="i">+/// A table scan node
</a><a href="#h22-0-5" id="h22-0-5" class="i">+#[derive(Derivative)]
</a><a href="#h22-0-6" id="h22-0-6" class="i">+#[derivative(Debug)]
</a><a href="#h22-0-7" id="h22-0-7" class="i">+pub struct Scan {
</a><a href="#h22-0-8" id="h22-0-8" class="i">+    table: String,
</a><a href="#h22-0-9" id="h22-0-9" class="i">+    #[derivative(Debug = &quot;ignore&quot;)]
</a><a href="#h22-0-10" id="h22-0-10" class="i">+    range: Option&lt;Box&lt;dyn Iterator&lt;Item = Result&lt;Row, Error&gt;&gt; + Sync + Send + &#39;static&gt;&gt;,
</a><a href="#h22-0-11" id="h22-0-11" class="i">+}
</a><a href="#h22-0-12" id="h22-0-12" class="i">+
</a><a href="#h22-0-13" id="h22-0-13" class="i">+impl Scan {
</a><a href="#h22-0-14" id="h22-0-14" class="i">+    pub fn new(table: String) -&gt; Self {
</a><a href="#h22-0-15" id="h22-0-15" class="i">+        Self { table, range: None }
</a><a href="#h22-0-16" id="h22-0-16" class="i">+    }
</a><a href="#h22-0-17" id="h22-0-17" class="i">+}
</a><a href="#h22-0-18" id="h22-0-18" class="i">+
</a><a href="#h22-0-19" id="h22-0-19" class="i">+impl Node for Scan {
</a><a href="#h22-0-20" id="h22-0-20" class="i">+    fn execute(&amp;mut self, ctx: &amp;mut Context) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h22-0-21" id="h22-0-21" class="i">+        self.range = Some(ctx.storage.scan_rows(&amp;self.table));
</a><a href="#h22-0-22" id="h22-0-22" class="i">+        Ok(())
</a><a href="#h22-0-23" id="h22-0-23" class="i">+    }
</a><a href="#h22-0-24" id="h22-0-24" class="i">+}
</a><a href="#h22-0-25" id="h22-0-25" class="i">+
</a><a href="#h22-0-26" id="h22-0-26" class="i">+impl Iterator for Scan {
</a><a href="#h22-0-27" id="h22-0-27" class="i">+    type Item = Result&lt;Row, Error&gt;;
</a><a href="#h22-0-28" id="h22-0-28" class="i">+
</a><a href="#h22-0-29" id="h22-0-29" class="i">+    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
</a><a href="#h22-0-30" id="h22-0-30" class="i">+        match self.range {
</a><a href="#h22-0-31" id="h22-0-31" class="i">+            Some(ref mut iter) =&gt; iter.next(),
</a><a href="#h22-0-32" id="h22-0-32" class="i">+            None =&gt; None,
</a><a href="#h22-0-33" id="h22-0-33" class="i">+        }
</a><a href="#h22-0-34" id="h22-0-34" class="i">+    }
</a><a href="#h22-0-35" id="h22-0-35" class="i">+}
</a><b>diff --git a/<a id="h23" href="../file/src/sql/storage.rs.html">src/sql/storage.rs</a> b/<a href="../file/src/sql/storage.rs.html">src/sql/storage.rs</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -10,12 +10,6 @@ pub struct Storage {
</a>     kv: Arc&lt;RwLock&lt;Box&lt;dyn kv::Store&gt;&gt;&gt;,
 }
 
<a href="#h23-0-3" id="h23-0-3" class="d">-impl std::fmt::Debug for Storage {
</a><a href="#h23-0-4" id="h23-0-4" class="d">-    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {
</a><a href="#h23-0-5" id="h23-0-5" class="d">-        write!(f, &quot;Storage&quot;)
</a><a href="#h23-0-6" id="h23-0-6" class="d">-    }
</a><a href="#h23-0-7" id="h23-0-7" class="d">-}
</a><a href="#h23-0-8" id="h23-0-8" class="d">-
</a> impl Storage {
     /// Creates a new Storage
     pub fn new&lt;S: kv::Store&gt;(store: S) -&gt; Self {
<a href="#h23-1" id="h23-1" class="h">@@ -34,7 +28,7 @@ impl Storage {
</a>     }
 
     /// Creates a table
<a href="#h23-1-3" id="h23-1-3" class="d">-    pub fn create_table(&amp;mut self, table: schema::Table) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h23-1-4" id="h23-1-4" class="i">+    pub fn create_table(&amp;mut self, table: &amp;schema::Table) -&gt; Result&lt;(), Error&gt; {
</a>         if self.table_exists(&amp;table.name)? {
             Err(Error::Value(format!(&quot;Table {} already exists&quot;, table.name)))
         } else {
<a href="#h23-2" id="h23-2" class="h">@@ -71,6 +65,18 @@ impl Storage {
</a>         Ok(tables)
     }
 
<a href="#h23-2-3" id="h23-2-3" class="i">+    /// Creates an iterator over the rows of a table
</a><a href="#h23-2-4" id="h23-2-4" class="i">+    pub fn scan_rows(
</a><a href="#h23-2-5" id="h23-2-5" class="i">+        &amp;self,
</a><a href="#h23-2-6" id="h23-2-6" class="i">+        table: &amp;str,
</a><a href="#h23-2-7" id="h23-2-7" class="i">+    ) -&gt; Box&lt;dyn Iterator&lt;Item = Result&lt;types::Row, Error&gt;&gt; + Sync + Send&gt; {
</a><a href="#h23-2-8" id="h23-2-8" class="i">+        let key = table.to_string() + &quot;.&quot;;
</a><a href="#h23-2-9" id="h23-2-9" class="i">+        Box::new(self.kv.read().unwrap().iter_prefix(&amp;key).map(|res| match res {
</a><a href="#h23-2-10" id="h23-2-10" class="i">+            Ok((_, v)) =&gt; deserialize(v),
</a><a href="#h23-2-11" id="h23-2-11" class="i">+            Err(err) =&gt; Err(err),
</a><a href="#h23-2-12" id="h23-2-12" class="i">+        }))
</a><a href="#h23-2-13" id="h23-2-13" class="i">+    }
</a><a href="#h23-2-14" id="h23-2-14" class="i">+
</a>     /// Checks if a table exists
     pub fn table_exists(&amp;self, table: &amp;str) -&gt; Result&lt;bool, Error&gt; {
         Ok(self.kv.read()?.get(&amp;Self::key_table(table))?.is_some())
<a href="#h23-3" id="h23-3" class="h">@@ -78,7 +84,7 @@ impl Storage {
</a> 
     /// Generates a key for a row
     fn key_row(table: &amp;str, id: &amp;str) -&gt; String {
<a href="#h23-3-3" id="h23-3-3" class="d">-        format!(&quot;{}.{}&quot;, Self::key_table(table), id)
</a><a href="#h23-3-4" id="h23-3-4" class="i">+        format!(&quot;{}.{}&quot;, table, id)
</a>     }
 
     /// Generates a key for a table
<b>diff --git a/<a id="h24" href="../file/src/sql/testdata/create_table.html">src/sql/testdata/create_table</a> b/<a href="../file/src/sql/testdata/create_table.html">src/sql/testdata/create_table</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -0,0 +1,166 @@
</a><a href="#h24-0-0" id="h24-0-0" class="i">+Query: 
</a><a href="#h24-0-1" id="h24-0-1" class="i">+        CREATE TABLE name (
</a><a href="#h24-0-2" id="h24-0-2" class="i">+            id INTEGER PRIMARY KEY,
</a><a href="#h24-0-3" id="h24-0-3" class="i">+            string VARCHAR NOT NULL,
</a><a href="#h24-0-4" id="h24-0-4" class="i">+            text VARCHAR,
</a><a href="#h24-0-5" id="h24-0-5" class="i">+            number INTEGER,
</a><a href="#h24-0-6" id="h24-0-6" class="i">+            decimal FLOAT,
</a><a href="#h24-0-7" id="h24-0-7" class="i">+            bool BOOLEAN NULL
</a><a href="#h24-0-8" id="h24-0-8" class="i">+        )
</a><a href="#h24-0-9" id="h24-0-9" class="i">+
</a><a href="#h24-0-10" id="h24-0-10" class="i">+Tokens:
</a><a href="#h24-0-11" id="h24-0-11" class="i">+  Keyword(Create)
</a><a href="#h24-0-12" id="h24-0-12" class="i">+  Keyword(Table)
</a><a href="#h24-0-13" id="h24-0-13" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h24-0-14" id="h24-0-14" class="i">+  OpenParen
</a><a href="#h24-0-15" id="h24-0-15" class="i">+  Ident(&quot;id&quot;)
</a><a href="#h24-0-16" id="h24-0-16" class="i">+  Keyword(Integer)
</a><a href="#h24-0-17" id="h24-0-17" class="i">+  Keyword(Primary)
</a><a href="#h24-0-18" id="h24-0-18" class="i">+  Keyword(Key)
</a><a href="#h24-0-19" id="h24-0-19" class="i">+  Comma
</a><a href="#h24-0-20" id="h24-0-20" class="i">+  Ident(&quot;string&quot;)
</a><a href="#h24-0-21" id="h24-0-21" class="i">+  Keyword(Varchar)
</a><a href="#h24-0-22" id="h24-0-22" class="i">+  Keyword(Not)
</a><a href="#h24-0-23" id="h24-0-23" class="i">+  Keyword(Null)
</a><a href="#h24-0-24" id="h24-0-24" class="i">+  Comma
</a><a href="#h24-0-25" id="h24-0-25" class="i">+  Ident(&quot;text&quot;)
</a><a href="#h24-0-26" id="h24-0-26" class="i">+  Keyword(Varchar)
</a><a href="#h24-0-27" id="h24-0-27" class="i">+  Comma
</a><a href="#h24-0-28" id="h24-0-28" class="i">+  Ident(&quot;number&quot;)
</a><a href="#h24-0-29" id="h24-0-29" class="i">+  Keyword(Integer)
</a><a href="#h24-0-30" id="h24-0-30" class="i">+  Comma
</a><a href="#h24-0-31" id="h24-0-31" class="i">+  Ident(&quot;decimal&quot;)
</a><a href="#h24-0-32" id="h24-0-32" class="i">+  Keyword(Float)
</a><a href="#h24-0-33" id="h24-0-33" class="i">+  Comma
</a><a href="#h24-0-34" id="h24-0-34" class="i">+  Ident(&quot;bool&quot;)
</a><a href="#h24-0-35" id="h24-0-35" class="i">+  Keyword(Boolean)
</a><a href="#h24-0-36" id="h24-0-36" class="i">+  Keyword(Null)
</a><a href="#h24-0-37" id="h24-0-37" class="i">+  CloseParen
</a><a href="#h24-0-38" id="h24-0-38" class="i">+
</a><a href="#h24-0-39" id="h24-0-39" class="i">+AST: CreateTable {
</a><a href="#h24-0-40" id="h24-0-40" class="i">+    name: &quot;name&quot;,
</a><a href="#h24-0-41" id="h24-0-41" class="i">+    columns: [
</a><a href="#h24-0-42" id="h24-0-42" class="i">+        ColumnSpec {
</a><a href="#h24-0-43" id="h24-0-43" class="i">+            name: &quot;id&quot;,
</a><a href="#h24-0-44" id="h24-0-44" class="i">+            datatype: Integer,
</a><a href="#h24-0-45" id="h24-0-45" class="i">+            primary_key: true,
</a><a href="#h24-0-46" id="h24-0-46" class="i">+            nullable: None,
</a><a href="#h24-0-47" id="h24-0-47" class="i">+        },
</a><a href="#h24-0-48" id="h24-0-48" class="i">+        ColumnSpec {
</a><a href="#h24-0-49" id="h24-0-49" class="i">+            name: &quot;string&quot;,
</a><a href="#h24-0-50" id="h24-0-50" class="i">+            datatype: String,
</a><a href="#h24-0-51" id="h24-0-51" class="i">+            primary_key: false,
</a><a href="#h24-0-52" id="h24-0-52" class="i">+            nullable: Some(
</a><a href="#h24-0-53" id="h24-0-53" class="i">+                false,
</a><a href="#h24-0-54" id="h24-0-54" class="i">+            ),
</a><a href="#h24-0-55" id="h24-0-55" class="i">+        },
</a><a href="#h24-0-56" id="h24-0-56" class="i">+        ColumnSpec {
</a><a href="#h24-0-57" id="h24-0-57" class="i">+            name: &quot;text&quot;,
</a><a href="#h24-0-58" id="h24-0-58" class="i">+            datatype: String,
</a><a href="#h24-0-59" id="h24-0-59" class="i">+            primary_key: false,
</a><a href="#h24-0-60" id="h24-0-60" class="i">+            nullable: None,
</a><a href="#h24-0-61" id="h24-0-61" class="i">+        },
</a><a href="#h24-0-62" id="h24-0-62" class="i">+        ColumnSpec {
</a><a href="#h24-0-63" id="h24-0-63" class="i">+            name: &quot;number&quot;,
</a><a href="#h24-0-64" id="h24-0-64" class="i">+            datatype: Integer,
</a><a href="#h24-0-65" id="h24-0-65" class="i">+            primary_key: false,
</a><a href="#h24-0-66" id="h24-0-66" class="i">+            nullable: None,
</a><a href="#h24-0-67" id="h24-0-67" class="i">+        },
</a><a href="#h24-0-68" id="h24-0-68" class="i">+        ColumnSpec {
</a><a href="#h24-0-69" id="h24-0-69" class="i">+            name: &quot;decimal&quot;,
</a><a href="#h24-0-70" id="h24-0-70" class="i">+            datatype: Float,
</a><a href="#h24-0-71" id="h24-0-71" class="i">+            primary_key: false,
</a><a href="#h24-0-72" id="h24-0-72" class="i">+            nullable: None,
</a><a href="#h24-0-73" id="h24-0-73" class="i">+        },
</a><a href="#h24-0-74" id="h24-0-74" class="i">+        ColumnSpec {
</a><a href="#h24-0-75" id="h24-0-75" class="i">+            name: &quot;bool&quot;,
</a><a href="#h24-0-76" id="h24-0-76" class="i">+            datatype: Boolean,
</a><a href="#h24-0-77" id="h24-0-77" class="i">+            primary_key: false,
</a><a href="#h24-0-78" id="h24-0-78" class="i">+            nullable: Some(
</a><a href="#h24-0-79" id="h24-0-79" class="i">+                true,
</a><a href="#h24-0-80" id="h24-0-80" class="i">+            ),
</a><a href="#h24-0-81" id="h24-0-81" class="i">+        },
</a><a href="#h24-0-82" id="h24-0-82" class="i">+    ],
</a><a href="#h24-0-83" id="h24-0-83" class="i">+}
</a><a href="#h24-0-84" id="h24-0-84" class="i">+
</a><a href="#h24-0-85" id="h24-0-85" class="i">+Plan: Plan {
</a><a href="#h24-0-86" id="h24-0-86" class="i">+    root: CreateTable {
</a><a href="#h24-0-87" id="h24-0-87" class="i">+        schema: Table {
</a><a href="#h24-0-88" id="h24-0-88" class="i">+            name: &quot;name&quot;,
</a><a href="#h24-0-89" id="h24-0-89" class="i">+            columns: [
</a><a href="#h24-0-90" id="h24-0-90" class="i">+                Column {
</a><a href="#h24-0-91" id="h24-0-91" class="i">+                    name: &quot;id&quot;,
</a><a href="#h24-0-92" id="h24-0-92" class="i">+                    datatype: Integer,
</a><a href="#h24-0-93" id="h24-0-93" class="i">+                    nullable: false,
</a><a href="#h24-0-94" id="h24-0-94" class="i">+                },
</a><a href="#h24-0-95" id="h24-0-95" class="i">+                Column {
</a><a href="#h24-0-96" id="h24-0-96" class="i">+                    name: &quot;string&quot;,
</a><a href="#h24-0-97" id="h24-0-97" class="i">+                    datatype: String,
</a><a href="#h24-0-98" id="h24-0-98" class="i">+                    nullable: false,
</a><a href="#h24-0-99" id="h24-0-99" class="i">+                },
</a><a href="#h24-0-100" id="h24-0-100" class="i">+                Column {
</a><a href="#h24-0-101" id="h24-0-101" class="i">+                    name: &quot;text&quot;,
</a><a href="#h24-0-102" id="h24-0-102" class="i">+                    datatype: String,
</a><a href="#h24-0-103" id="h24-0-103" class="i">+                    nullable: true,
</a><a href="#h24-0-104" id="h24-0-104" class="i">+                },
</a><a href="#h24-0-105" id="h24-0-105" class="i">+                Column {
</a><a href="#h24-0-106" id="h24-0-106" class="i">+                    name: &quot;number&quot;,
</a><a href="#h24-0-107" id="h24-0-107" class="i">+                    datatype: Integer,
</a><a href="#h24-0-108" id="h24-0-108" class="i">+                    nullable: true,
</a><a href="#h24-0-109" id="h24-0-109" class="i">+                },
</a><a href="#h24-0-110" id="h24-0-110" class="i">+                Column {
</a><a href="#h24-0-111" id="h24-0-111" class="i">+                    name: &quot;decimal&quot;,
</a><a href="#h24-0-112" id="h24-0-112" class="i">+                    datatype: Float,
</a><a href="#h24-0-113" id="h24-0-113" class="i">+                    nullable: true,
</a><a href="#h24-0-114" id="h24-0-114" class="i">+                },
</a><a href="#h24-0-115" id="h24-0-115" class="i">+                Column {
</a><a href="#h24-0-116" id="h24-0-116" class="i">+                    name: &quot;bool&quot;,
</a><a href="#h24-0-117" id="h24-0-117" class="i">+                    datatype: Boolean,
</a><a href="#h24-0-118" id="h24-0-118" class="i">+                    nullable: true,
</a><a href="#h24-0-119" id="h24-0-119" class="i">+                },
</a><a href="#h24-0-120" id="h24-0-120" class="i">+            ],
</a><a href="#h24-0-121" id="h24-0-121" class="i">+            primary_key: &quot;id&quot;,
</a><a href="#h24-0-122" id="h24-0-122" class="i">+        },
</a><a href="#h24-0-123" id="h24-0-123" class="i">+    },
</a><a href="#h24-0-124" id="h24-0-124" class="i">+}
</a><a href="#h24-0-125" id="h24-0-125" class="i">+
</a><a href="#h24-0-126" id="h24-0-126" class="i">+Query: 
</a><a href="#h24-0-127" id="h24-0-127" class="i">+        CREATE TABLE name (
</a><a href="#h24-0-128" id="h24-0-128" class="i">+            id INTEGER PRIMARY KEY,
</a><a href="#h24-0-129" id="h24-0-129" class="i">+            string VARCHAR NOT NULL,
</a><a href="#h24-0-130" id="h24-0-130" class="i">+            text VARCHAR,
</a><a href="#h24-0-131" id="h24-0-131" class="i">+            number INTEGER,
</a><a href="#h24-0-132" id="h24-0-132" class="i">+            decimal FLOAT,
</a><a href="#h24-0-133" id="h24-0-133" class="i">+            bool BOOLEAN NULL
</a><a href="#h24-0-134" id="h24-0-134" class="i">+        )
</a><a href="#h24-0-135" id="h24-0-135" class="i">+
</a><a href="#h24-0-136" id="h24-0-136" class="i">+Result:
</a><a href="#h24-0-137" id="h24-0-137" class="i">+
</a><a href="#h24-0-138" id="h24-0-138" class="i">+Storage:
</a><a href="#h24-0-139" id="h24-0-139" class="i">+CREATE TABLE genres (
</a><a href="#h24-0-140" id="h24-0-140" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h24-0-141" id="h24-0-141" class="i">+  name VARCHAR NOT NULL,
</a><a href="#h24-0-142" id="h24-0-142" class="i">+)
</a><a href="#h24-0-143" id="h24-0-143" class="i">+[Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h24-0-144" id="h24-0-144" class="i">+[Integer(2), String(&quot;Action&quot;)]
</a><a href="#h24-0-145" id="h24-0-145" class="i">+
</a><a href="#h24-0-146" id="h24-0-146" class="i">+CREATE TABLE movies (
</a><a href="#h24-0-147" id="h24-0-147" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h24-0-148" id="h24-0-148" class="i">+  title VARCHAR NOT NULL,
</a><a href="#h24-0-149" id="h24-0-149" class="i">+  genre_id INTEGER NOT NULL,
</a><a href="#h24-0-150" id="h24-0-150" class="i">+  released INTEGER NOT NULL,
</a><a href="#h24-0-151" id="h24-0-151" class="i">+  rating FLOAT NULL,
</a><a href="#h24-0-152" id="h24-0-152" class="i">+  bluray BOOLEAN NULL,
</a><a href="#h24-0-153" id="h24-0-153" class="i">+)
</a><a href="#h24-0-154" id="h24-0-154" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h24-0-155" id="h24-0-155" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><a href="#h24-0-156" id="h24-0-156" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(1), Integer(2004), Float(6.9), Null]
</a><a href="#h24-0-157" id="h24-0-157" class="i">+
</a><a href="#h24-0-158" id="h24-0-158" class="i">+CREATE TABLE name (
</a><a href="#h24-0-159" id="h24-0-159" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h24-0-160" id="h24-0-160" class="i">+  string VARCHAR NOT NULL,
</a><a href="#h24-0-161" id="h24-0-161" class="i">+  text VARCHAR NULL,
</a><a href="#h24-0-162" id="h24-0-162" class="i">+  number INTEGER NULL,
</a><a href="#h24-0-163" id="h24-0-163" class="i">+  decimal FLOAT NULL,
</a><a href="#h24-0-164" id="h24-0-164" class="i">+  bool BOOLEAN NULL,
</a><a href="#h24-0-165" id="h24-0-165" class="i">+)
</a><b>diff --git a/<a id="h25" href="../file/src/sql/testdata/create_table/ast.html">src/sql/testdata/create_table/ast</a> b/<a href="../file/src/sql/testdata/create_table/ast.html">src/sql/testdata/create_table/ast</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -1,45 +0,0 @@
</a><a href="#h25-0-0" id="h25-0-0" class="d">-CreateTable {
</a><a href="#h25-0-1" id="h25-0-1" class="d">-    name: &quot;name&quot;,
</a><a href="#h25-0-2" id="h25-0-2" class="d">-    columns: [
</a><a href="#h25-0-3" id="h25-0-3" class="d">-        ColumnSpec {
</a><a href="#h25-0-4" id="h25-0-4" class="d">-            name: &quot;id&quot;,
</a><a href="#h25-0-5" id="h25-0-5" class="d">-            datatype: Integer,
</a><a href="#h25-0-6" id="h25-0-6" class="d">-            primary_key: true,
</a><a href="#h25-0-7" id="h25-0-7" class="d">-            nullable: None,
</a><a href="#h25-0-8" id="h25-0-8" class="d">-        },
</a><a href="#h25-0-9" id="h25-0-9" class="d">-        ColumnSpec {
</a><a href="#h25-0-10" id="h25-0-10" class="d">-            name: &quot;string&quot;,
</a><a href="#h25-0-11" id="h25-0-11" class="d">-            datatype: String,
</a><a href="#h25-0-12" id="h25-0-12" class="d">-            primary_key: false,
</a><a href="#h25-0-13" id="h25-0-13" class="d">-            nullable: Some(
</a><a href="#h25-0-14" id="h25-0-14" class="d">-                false,
</a><a href="#h25-0-15" id="h25-0-15" class="d">-            ),
</a><a href="#h25-0-16" id="h25-0-16" class="d">-        },
</a><a href="#h25-0-17" id="h25-0-17" class="d">-        ColumnSpec {
</a><a href="#h25-0-18" id="h25-0-18" class="d">-            name: &quot;text&quot;,
</a><a href="#h25-0-19" id="h25-0-19" class="d">-            datatype: String,
</a><a href="#h25-0-20" id="h25-0-20" class="d">-            primary_key: false,
</a><a href="#h25-0-21" id="h25-0-21" class="d">-            nullable: None,
</a><a href="#h25-0-22" id="h25-0-22" class="d">-        },
</a><a href="#h25-0-23" id="h25-0-23" class="d">-        ColumnSpec {
</a><a href="#h25-0-24" id="h25-0-24" class="d">-            name: &quot;number&quot;,
</a><a href="#h25-0-25" id="h25-0-25" class="d">-            datatype: Integer,
</a><a href="#h25-0-26" id="h25-0-26" class="d">-            primary_key: false,
</a><a href="#h25-0-27" id="h25-0-27" class="d">-            nullable: None,
</a><a href="#h25-0-28" id="h25-0-28" class="d">-        },
</a><a href="#h25-0-29" id="h25-0-29" class="d">-        ColumnSpec {
</a><a href="#h25-0-30" id="h25-0-30" class="d">-            name: &quot;decimal&quot;,
</a><a href="#h25-0-31" id="h25-0-31" class="d">-            datatype: Float,
</a><a href="#h25-0-32" id="h25-0-32" class="d">-            primary_key: false,
</a><a href="#h25-0-33" id="h25-0-33" class="d">-            nullable: None,
</a><a href="#h25-0-34" id="h25-0-34" class="d">-        },
</a><a href="#h25-0-35" id="h25-0-35" class="d">-        ColumnSpec {
</a><a href="#h25-0-36" id="h25-0-36" class="d">-            name: &quot;bool&quot;,
</a><a href="#h25-0-37" id="h25-0-37" class="d">-            datatype: Boolean,
</a><a href="#h25-0-38" id="h25-0-38" class="d">-            primary_key: false,
</a><a href="#h25-0-39" id="h25-0-39" class="d">-            nullable: Some(
</a><a href="#h25-0-40" id="h25-0-40" class="d">-                true,
</a><a href="#h25-0-41" id="h25-0-41" class="d">-            ),
</a><a href="#h25-0-42" id="h25-0-42" class="d">-        },
</a><a href="#h25-0-43" id="h25-0-43" class="d">-    ],
</a><a href="#h25-0-44" id="h25-0-44" class="d">-}
</a><a href="#h25-0-45" id="h25-0-45" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h26" href="../file/src/sql/testdata/create_table/plan.html">src/sql/testdata/create_table/plan</a> b/<a href="../file/src/sql/testdata/create_table/plan.html">src/sql/testdata/create_table/plan</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -1,44 +0,0 @@
</a><a href="#h26-0-0" id="h26-0-0" class="d">-Plan {
</a><a href="#h26-0-1" id="h26-0-1" class="d">-    columns: [],
</a><a href="#h26-0-2" id="h26-0-2" class="d">-    root: DDL {
</a><a href="#h26-0-3" id="h26-0-3" class="d">-        storage: Storage,
</a><a href="#h26-0-4" id="h26-0-4" class="d">-        ddl: CreateTable(
</a><a href="#h26-0-5" id="h26-0-5" class="d">-            Table {
</a><a href="#h26-0-6" id="h26-0-6" class="d">-                name: &quot;name&quot;,
</a><a href="#h26-0-7" id="h26-0-7" class="d">-                columns: [
</a><a href="#h26-0-8" id="h26-0-8" class="d">-                    Column {
</a><a href="#h26-0-9" id="h26-0-9" class="d">-                        name: &quot;id&quot;,
</a><a href="#h26-0-10" id="h26-0-10" class="d">-                        datatype: Integer,
</a><a href="#h26-0-11" id="h26-0-11" class="d">-                        nullable: false,
</a><a href="#h26-0-12" id="h26-0-12" class="d">-                    },
</a><a href="#h26-0-13" id="h26-0-13" class="d">-                    Column {
</a><a href="#h26-0-14" id="h26-0-14" class="d">-                        name: &quot;string&quot;,
</a><a href="#h26-0-15" id="h26-0-15" class="d">-                        datatype: String,
</a><a href="#h26-0-16" id="h26-0-16" class="d">-                        nullable: false,
</a><a href="#h26-0-17" id="h26-0-17" class="d">-                    },
</a><a href="#h26-0-18" id="h26-0-18" class="d">-                    Column {
</a><a href="#h26-0-19" id="h26-0-19" class="d">-                        name: &quot;text&quot;,
</a><a href="#h26-0-20" id="h26-0-20" class="d">-                        datatype: String,
</a><a href="#h26-0-21" id="h26-0-21" class="d">-                        nullable: true,
</a><a href="#h26-0-22" id="h26-0-22" class="d">-                    },
</a><a href="#h26-0-23" id="h26-0-23" class="d">-                    Column {
</a><a href="#h26-0-24" id="h26-0-24" class="d">-                        name: &quot;number&quot;,
</a><a href="#h26-0-25" id="h26-0-25" class="d">-                        datatype: Integer,
</a><a href="#h26-0-26" id="h26-0-26" class="d">-                        nullable: true,
</a><a href="#h26-0-27" id="h26-0-27" class="d">-                    },
</a><a href="#h26-0-28" id="h26-0-28" class="d">-                    Column {
</a><a href="#h26-0-29" id="h26-0-29" class="d">-                        name: &quot;decimal&quot;,
</a><a href="#h26-0-30" id="h26-0-30" class="d">-                        datatype: Float,
</a><a href="#h26-0-31" id="h26-0-31" class="d">-                        nullable: true,
</a><a href="#h26-0-32" id="h26-0-32" class="d">-                    },
</a><a href="#h26-0-33" id="h26-0-33" class="d">-                    Column {
</a><a href="#h26-0-34" id="h26-0-34" class="d">-                        name: &quot;bool&quot;,
</a><a href="#h26-0-35" id="h26-0-35" class="d">-                        datatype: Boolean,
</a><a href="#h26-0-36" id="h26-0-36" class="d">-                        nullable: true,
</a><a href="#h26-0-37" id="h26-0-37" class="d">-                    },
</a><a href="#h26-0-38" id="h26-0-38" class="d">-                ],
</a><a href="#h26-0-39" id="h26-0-39" class="d">-                primary_key: &quot;id&quot;,
</a><a href="#h26-0-40" id="h26-0-40" class="d">-            },
</a><a href="#h26-0-41" id="h26-0-41" class="d">-        ),
</a><a href="#h26-0-42" id="h26-0-42" class="d">-    },
</a><a href="#h26-0-43" id="h26-0-43" class="d">-}
</a><a href="#h26-0-44" id="h26-0-44" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h27" href="../file/src/sql/testdata/create_table/query.sql.html">src/sql/testdata/create_table/query.sql</a> b/<a href="../file/src/sql/testdata/create_table/query.sql.html">src/sql/testdata/create_table/query.sql</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -1,9 +0,0 @@
</a><a href="#h27-0-0" id="h27-0-0" class="d">-
</a><a href="#h27-0-1" id="h27-0-1" class="d">-        CREATE TABLE name (
</a><a href="#h27-0-2" id="h27-0-2" class="d">-            id INTEGER PRIMARY KEY,
</a><a href="#h27-0-3" id="h27-0-3" class="d">-            string VARCHAR NOT NULL,
</a><a href="#h27-0-4" id="h27-0-4" class="d">-            text VARCHAR,
</a><a href="#h27-0-5" id="h27-0-5" class="d">-            number INTEGER,
</a><a href="#h27-0-6" id="h27-0-6" class="d">-            decimal FLOAT,
</a><a href="#h27-0-7" id="h27-0-7" class="d">-            bool BOOLEAN NULL
</a><a href="#h27-0-8" id="h27-0-8" class="d">-        )
</a><a href="#h27-0-9" id="h27-0-9" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h28" href="../file/src/sql/testdata/create_table/tokens.html">src/sql/testdata/create_table/tokens</a> b/<a href="../file/src/sql/testdata/create_table/tokens.html">src/sql/testdata/create_table/tokens</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -1,69 +0,0 @@
</a><a href="#h28-0-0" id="h28-0-0" class="d">-[
</a><a href="#h28-0-1" id="h28-0-1" class="d">-    Keyword(
</a><a href="#h28-0-2" id="h28-0-2" class="d">-        Create,
</a><a href="#h28-0-3" id="h28-0-3" class="d">-    ),
</a><a href="#h28-0-4" id="h28-0-4" class="d">-    Keyword(
</a><a href="#h28-0-5" id="h28-0-5" class="d">-        Table,
</a><a href="#h28-0-6" id="h28-0-6" class="d">-    ),
</a><a href="#h28-0-7" id="h28-0-7" class="d">-    Ident(
</a><a href="#h28-0-8" id="h28-0-8" class="d">-        &quot;name&quot;,
</a><a href="#h28-0-9" id="h28-0-9" class="d">-    ),
</a><a href="#h28-0-10" id="h28-0-10" class="d">-    OpenParen,
</a><a href="#h28-0-11" id="h28-0-11" class="d">-    Ident(
</a><a href="#h28-0-12" id="h28-0-12" class="d">-        &quot;id&quot;,
</a><a href="#h28-0-13" id="h28-0-13" class="d">-    ),
</a><a href="#h28-0-14" id="h28-0-14" class="d">-    Keyword(
</a><a href="#h28-0-15" id="h28-0-15" class="d">-        Integer,
</a><a href="#h28-0-16" id="h28-0-16" class="d">-    ),
</a><a href="#h28-0-17" id="h28-0-17" class="d">-    Keyword(
</a><a href="#h28-0-18" id="h28-0-18" class="d">-        Primary,
</a><a href="#h28-0-19" id="h28-0-19" class="d">-    ),
</a><a href="#h28-0-20" id="h28-0-20" class="d">-    Keyword(
</a><a href="#h28-0-21" id="h28-0-21" class="d">-        Key,
</a><a href="#h28-0-22" id="h28-0-22" class="d">-    ),
</a><a href="#h28-0-23" id="h28-0-23" class="d">-    Comma,
</a><a href="#h28-0-24" id="h28-0-24" class="d">-    Ident(
</a><a href="#h28-0-25" id="h28-0-25" class="d">-        &quot;string&quot;,
</a><a href="#h28-0-26" id="h28-0-26" class="d">-    ),
</a><a href="#h28-0-27" id="h28-0-27" class="d">-    Keyword(
</a><a href="#h28-0-28" id="h28-0-28" class="d">-        Varchar,
</a><a href="#h28-0-29" id="h28-0-29" class="d">-    ),
</a><a href="#h28-0-30" id="h28-0-30" class="d">-    Keyword(
</a><a href="#h28-0-31" id="h28-0-31" class="d">-        Not,
</a><a href="#h28-0-32" id="h28-0-32" class="d">-    ),
</a><a href="#h28-0-33" id="h28-0-33" class="d">-    Keyword(
</a><a href="#h28-0-34" id="h28-0-34" class="d">-        Null,
</a><a href="#h28-0-35" id="h28-0-35" class="d">-    ),
</a><a href="#h28-0-36" id="h28-0-36" class="d">-    Comma,
</a><a href="#h28-0-37" id="h28-0-37" class="d">-    Ident(
</a><a href="#h28-0-38" id="h28-0-38" class="d">-        &quot;text&quot;,
</a><a href="#h28-0-39" id="h28-0-39" class="d">-    ),
</a><a href="#h28-0-40" id="h28-0-40" class="d">-    Keyword(
</a><a href="#h28-0-41" id="h28-0-41" class="d">-        Varchar,
</a><a href="#h28-0-42" id="h28-0-42" class="d">-    ),
</a><a href="#h28-0-43" id="h28-0-43" class="d">-    Comma,
</a><a href="#h28-0-44" id="h28-0-44" class="d">-    Ident(
</a><a href="#h28-0-45" id="h28-0-45" class="d">-        &quot;number&quot;,
</a><a href="#h28-0-46" id="h28-0-46" class="d">-    ),
</a><a href="#h28-0-47" id="h28-0-47" class="d">-    Keyword(
</a><a href="#h28-0-48" id="h28-0-48" class="d">-        Integer,
</a><a href="#h28-0-49" id="h28-0-49" class="d">-    ),
</a><a href="#h28-0-50" id="h28-0-50" class="d">-    Comma,
</a><a href="#h28-0-51" id="h28-0-51" class="d">-    Ident(
</a><a href="#h28-0-52" id="h28-0-52" class="d">-        &quot;decimal&quot;,
</a><a href="#h28-0-53" id="h28-0-53" class="d">-    ),
</a><a href="#h28-0-54" id="h28-0-54" class="d">-    Keyword(
</a><a href="#h28-0-55" id="h28-0-55" class="d">-        Float,
</a><a href="#h28-0-56" id="h28-0-56" class="d">-    ),
</a><a href="#h28-0-57" id="h28-0-57" class="d">-    Comma,
</a><a href="#h28-0-58" id="h28-0-58" class="d">-    Ident(
</a><a href="#h28-0-59" id="h28-0-59" class="d">-        &quot;bool&quot;,
</a><a href="#h28-0-60" id="h28-0-60" class="d">-    ),
</a><a href="#h28-0-61" id="h28-0-61" class="d">-    Keyword(
</a><a href="#h28-0-62" id="h28-0-62" class="d">-        Boolean,
</a><a href="#h28-0-63" id="h28-0-63" class="d">-    ),
</a><a href="#h28-0-64" id="h28-0-64" class="d">-    Keyword(
</a><a href="#h28-0-65" id="h28-0-65" class="d">-        Null,
</a><a href="#h28-0-66" id="h28-0-66" class="d">-    ),
</a><a href="#h28-0-67" id="h28-0-67" class="d">-    CloseParen,
</a><a href="#h28-0-68" id="h28-0-68" class="d">-]
</a><a href="#h28-0-69" id="h28-0-69" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h29" href="../file/src/sql/testdata/create_table_error_bare.html">src/sql/testdata/create_table_error_bare</a> b/<a href="../file/src/sql/testdata/create_table_error_bare.html">src/sql/testdata/create_table_error_bare</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -0,0 +1,7 @@
</a><a href="#h29-0-0" id="h29-0-0" class="i">+Query: CREATE TABLE
</a><a href="#h29-0-1" id="h29-0-1" class="i">+
</a><a href="#h29-0-2" id="h29-0-2" class="i">+Tokens:
</a><a href="#h29-0-3" id="h29-0-3" class="i">+  Keyword(Create)
</a><a href="#h29-0-4" id="h29-0-4" class="i">+  Keyword(Table)
</a><a href="#h29-0-5" id="h29-0-5" class="i">+
</a><a href="#h29-0-6" id="h29-0-6" class="i">+AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h29-0-7" id="h29-0-7" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h30" href="../file/src/sql/testdata/create_table_error_bare/ast.html">src/sql/testdata/create_table_error_bare/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_bare/ast.html">src/sql/testdata/create_table_error_bare/ast</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -1 +0,0 @@
</a><a href="#h30-0-0" id="h30-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h30-0-1" id="h30-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h31" href="../file/src/sql/testdata/create_table_error_bare/plan.html">src/sql/testdata/create_table_error_bare/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_bare/plan.html">src/sql/testdata/create_table_error_bare/plan</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -1 +0,0 @@
</a><a href="#h31-0-0" id="h31-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h31-0-1" id="h31-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h32" href="../file/src/sql/testdata/create_table_error_bare/query.sql.html">src/sql/testdata/create_table_error_bare/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_bare/query.sql.html">src/sql/testdata/create_table_error_bare/query.sql</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -1 +0,0 @@
</a><a href="#h32-0-0" id="h32-0-0" class="d">-CREATE TABLE
</a><a href="#h32-0-1" id="h32-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h33" href="../file/src/sql/testdata/create_table_error_bare/tokens.html">src/sql/testdata/create_table_error_bare/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_bare/tokens.html">src/sql/testdata/create_table_error_bare/tokens</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h33-0-0" id="h33-0-0" class="d">-[
</a><a href="#h33-0-1" id="h33-0-1" class="d">-    Keyword(
</a><a href="#h33-0-2" id="h33-0-2" class="d">-        Create,
</a><a href="#h33-0-3" id="h33-0-3" class="d">-    ),
</a><a href="#h33-0-4" id="h33-0-4" class="d">-    Keyword(
</a><a href="#h33-0-5" id="h33-0-5" class="d">-        Table,
</a><a href="#h33-0-6" id="h33-0-6" class="d">-    ),
</a><a href="#h33-0-7" id="h33-0-7" class="d">-]
</a><a href="#h33-0-8" id="h33-0-8" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h34" href="../file/src/sql/testdata/create_table_error_empty_columns.html">src/sql/testdata/create_table_error_empty_columns</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns.html">src/sql/testdata/create_table_error_empty_columns</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -0,0 +1,10 @@
</a><a href="#h34-0-0" id="h34-0-0" class="i">+Query: CREATE TABLE name ()
</a><a href="#h34-0-1" id="h34-0-1" class="i">+
</a><a href="#h34-0-2" id="h34-0-2" class="i">+Tokens:
</a><a href="#h34-0-3" id="h34-0-3" class="i">+  Keyword(Create)
</a><a href="#h34-0-4" id="h34-0-4" class="i">+  Keyword(Table)
</a><a href="#h34-0-5" id="h34-0-5" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h34-0-6" id="h34-0-6" class="i">+  OpenParen
</a><a href="#h34-0-7" id="h34-0-7" class="i">+  CloseParen
</a><a href="#h34-0-8" id="h34-0-8" class="i">+
</a><a href="#h34-0-9" id="h34-0-9" class="i">+AST: Parse(&quot;Expected identifier, got )&quot;)
</a><a href="#h34-0-10" id="h34-0-10" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h35" href="../file/src/sql/testdata/create_table_error_empty_columns/ast.html">src/sql/testdata/create_table_error_empty_columns/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns/ast.html">src/sql/testdata/create_table_error_empty_columns/ast</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -1 +0,0 @@
</a><a href="#h35-0-0" id="h35-0-0" class="d">-Err(Parse(&quot;Expected identifier, got )&quot;))
</a><a href="#h35-0-1" id="h35-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h36" href="../file/src/sql/testdata/create_table_error_empty_columns/plan.html">src/sql/testdata/create_table_error_empty_columns/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns/plan.html">src/sql/testdata/create_table_error_empty_columns/plan</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -1 +0,0 @@
</a><a href="#h36-0-0" id="h36-0-0" class="d">-Err(Parse(&quot;Expected identifier, got )&quot;))
</a><a href="#h36-0-1" id="h36-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h37" href="../file/src/sql/testdata/create_table_error_empty_columns/query.sql.html">src/sql/testdata/create_table_error_empty_columns/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns/query.sql.html">src/sql/testdata/create_table_error_empty_columns/query.sql</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -1 +0,0 @@
</a><a href="#h37-0-0" id="h37-0-0" class="d">-CREATE TABLE name ()
</a><a href="#h37-0-1" id="h37-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h38" href="../file/src/sql/testdata/create_table_error_empty_columns/tokens.html">src/sql/testdata/create_table_error_empty_columns/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns/tokens.html">src/sql/testdata/create_table_error_empty_columns/tokens</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -1,13 +0,0 @@
</a><a href="#h38-0-0" id="h38-0-0" class="d">-[
</a><a href="#h38-0-1" id="h38-0-1" class="d">-    Keyword(
</a><a href="#h38-0-2" id="h38-0-2" class="d">-        Create,
</a><a href="#h38-0-3" id="h38-0-3" class="d">-    ),
</a><a href="#h38-0-4" id="h38-0-4" class="d">-    Keyword(
</a><a href="#h38-0-5" id="h38-0-5" class="d">-        Table,
</a><a href="#h38-0-6" id="h38-0-6" class="d">-    ),
</a><a href="#h38-0-7" id="h38-0-7" class="d">-    Ident(
</a><a href="#h38-0-8" id="h38-0-8" class="d">-        &quot;name&quot;,
</a><a href="#h38-0-9" id="h38-0-9" class="d">-    ),
</a><a href="#h38-0-10" id="h38-0-10" class="d">-    OpenParen,
</a><a href="#h38-0-11" id="h38-0-11" class="d">-    CloseParen,
</a><a href="#h38-0-12" id="h38-0-12" class="d">-]
</a><a href="#h38-0-13" id="h38-0-13" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h39" href="../file/src/sql/testdata/create_table_error_exists.html">src/sql/testdata/create_table_error_exists</a> b/<a href="../file/src/sql/testdata/create_table_error_exists.html">src/sql/testdata/create_table_error_exists</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -0,0 +1,44 @@
</a><a href="#h39-0-0" id="h39-0-0" class="i">+Query: CREATE TABLE movies (id INTEGER PRIMARY KEY)
</a><a href="#h39-0-1" id="h39-0-1" class="i">+
</a><a href="#h39-0-2" id="h39-0-2" class="i">+Tokens:
</a><a href="#h39-0-3" id="h39-0-3" class="i">+  Keyword(Create)
</a><a href="#h39-0-4" id="h39-0-4" class="i">+  Keyword(Table)
</a><a href="#h39-0-5" id="h39-0-5" class="i">+  Ident(&quot;movies&quot;)
</a><a href="#h39-0-6" id="h39-0-6" class="i">+  OpenParen
</a><a href="#h39-0-7" id="h39-0-7" class="i">+  Ident(&quot;id&quot;)
</a><a href="#h39-0-8" id="h39-0-8" class="i">+  Keyword(Integer)
</a><a href="#h39-0-9" id="h39-0-9" class="i">+  Keyword(Primary)
</a><a href="#h39-0-10" id="h39-0-10" class="i">+  Keyword(Key)
</a><a href="#h39-0-11" id="h39-0-11" class="i">+  CloseParen
</a><a href="#h39-0-12" id="h39-0-12" class="i">+
</a><a href="#h39-0-13" id="h39-0-13" class="i">+AST: CreateTable {
</a><a href="#h39-0-14" id="h39-0-14" class="i">+    name: &quot;movies&quot;,
</a><a href="#h39-0-15" id="h39-0-15" class="i">+    columns: [
</a><a href="#h39-0-16" id="h39-0-16" class="i">+        ColumnSpec {
</a><a href="#h39-0-17" id="h39-0-17" class="i">+            name: &quot;id&quot;,
</a><a href="#h39-0-18" id="h39-0-18" class="i">+            datatype: Integer,
</a><a href="#h39-0-19" id="h39-0-19" class="i">+            primary_key: true,
</a><a href="#h39-0-20" id="h39-0-20" class="i">+            nullable: None,
</a><a href="#h39-0-21" id="h39-0-21" class="i">+        },
</a><a href="#h39-0-22" id="h39-0-22" class="i">+    ],
</a><a href="#h39-0-23" id="h39-0-23" class="i">+}
</a><a href="#h39-0-24" id="h39-0-24" class="i">+
</a><a href="#h39-0-25" id="h39-0-25" class="i">+Plan: Plan {
</a><a href="#h39-0-26" id="h39-0-26" class="i">+    root: CreateTable {
</a><a href="#h39-0-27" id="h39-0-27" class="i">+        schema: Table {
</a><a href="#h39-0-28" id="h39-0-28" class="i">+            name: &quot;movies&quot;,
</a><a href="#h39-0-29" id="h39-0-29" class="i">+            columns: [
</a><a href="#h39-0-30" id="h39-0-30" class="i">+                Column {
</a><a href="#h39-0-31" id="h39-0-31" class="i">+                    name: &quot;id&quot;,
</a><a href="#h39-0-32" id="h39-0-32" class="i">+                    datatype: Integer,
</a><a href="#h39-0-33" id="h39-0-33" class="i">+                    nullable: false,
</a><a href="#h39-0-34" id="h39-0-34" class="i">+                },
</a><a href="#h39-0-35" id="h39-0-35" class="i">+            ],
</a><a href="#h39-0-36" id="h39-0-36" class="i">+            primary_key: &quot;id&quot;,
</a><a href="#h39-0-37" id="h39-0-37" class="i">+        },
</a><a href="#h39-0-38" id="h39-0-38" class="i">+    },
</a><a href="#h39-0-39" id="h39-0-39" class="i">+}
</a><a href="#h39-0-40" id="h39-0-40" class="i">+
</a><a href="#h39-0-41" id="h39-0-41" class="i">+Query: CREATE TABLE movies (id INTEGER PRIMARY KEY)
</a><a href="#h39-0-42" id="h39-0-42" class="i">+
</a><a href="#h39-0-43" id="h39-0-43" class="i">+Result: Value(&quot;Table movies already exists&quot;)
</a><a href="#h39-0-44" id="h39-0-44" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h40" href="../file/src/sql/testdata/create_table_error_multiple_primary_key.html">src/sql/testdata/create_table_error_multiple_primary_key</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key.html">src/sql/testdata/create_table_error_multiple_primary_key</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -0,0 +1,37 @@
</a><a href="#h40-0-0" id="h40-0-0" class="i">+Query: CREATE TABLE name (id INTEGER PRIMARY KEY, name VARCHAR PRIMARY KEY)
</a><a href="#h40-0-1" id="h40-0-1" class="i">+
</a><a href="#h40-0-2" id="h40-0-2" class="i">+Tokens:
</a><a href="#h40-0-3" id="h40-0-3" class="i">+  Keyword(Create)
</a><a href="#h40-0-4" id="h40-0-4" class="i">+  Keyword(Table)
</a><a href="#h40-0-5" id="h40-0-5" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h40-0-6" id="h40-0-6" class="i">+  OpenParen
</a><a href="#h40-0-7" id="h40-0-7" class="i">+  Ident(&quot;id&quot;)
</a><a href="#h40-0-8" id="h40-0-8" class="i">+  Keyword(Integer)
</a><a href="#h40-0-9" id="h40-0-9" class="i">+  Keyword(Primary)
</a><a href="#h40-0-10" id="h40-0-10" class="i">+  Keyword(Key)
</a><a href="#h40-0-11" id="h40-0-11" class="i">+  Comma
</a><a href="#h40-0-12" id="h40-0-12" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h40-0-13" id="h40-0-13" class="i">+  Keyword(Varchar)
</a><a href="#h40-0-14" id="h40-0-14" class="i">+  Keyword(Primary)
</a><a href="#h40-0-15" id="h40-0-15" class="i">+  Keyword(Key)
</a><a href="#h40-0-16" id="h40-0-16" class="i">+  CloseParen
</a><a href="#h40-0-17" id="h40-0-17" class="i">+
</a><a href="#h40-0-18" id="h40-0-18" class="i">+AST: CreateTable {
</a><a href="#h40-0-19" id="h40-0-19" class="i">+    name: &quot;name&quot;,
</a><a href="#h40-0-20" id="h40-0-20" class="i">+    columns: [
</a><a href="#h40-0-21" id="h40-0-21" class="i">+        ColumnSpec {
</a><a href="#h40-0-22" id="h40-0-22" class="i">+            name: &quot;id&quot;,
</a><a href="#h40-0-23" id="h40-0-23" class="i">+            datatype: Integer,
</a><a href="#h40-0-24" id="h40-0-24" class="i">+            primary_key: true,
</a><a href="#h40-0-25" id="h40-0-25" class="i">+            nullable: None,
</a><a href="#h40-0-26" id="h40-0-26" class="i">+        },
</a><a href="#h40-0-27" id="h40-0-27" class="i">+        ColumnSpec {
</a><a href="#h40-0-28" id="h40-0-28" class="i">+            name: &quot;name&quot;,
</a><a href="#h40-0-29" id="h40-0-29" class="i">+            datatype: String,
</a><a href="#h40-0-30" id="h40-0-30" class="i">+            primary_key: true,
</a><a href="#h40-0-31" id="h40-0-31" class="i">+            nullable: None,
</a><a href="#h40-0-32" id="h40-0-32" class="i">+        },
</a><a href="#h40-0-33" id="h40-0-33" class="i">+    ],
</a><a href="#h40-0-34" id="h40-0-34" class="i">+}
</a><a href="#h40-0-35" id="h40-0-35" class="i">+
</a><a href="#h40-0-36" id="h40-0-36" class="i">+Plan: Value(&quot;2 primary keys defined for table name, must set exactly 1&quot;)
</a><a href="#h40-0-37" id="h40-0-37" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h41" href="../file/src/sql/testdata/create_table_error_multiple_primary_key/ast.html">src/sql/testdata/create_table_error_multiple_primary_key/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key/ast.html">src/sql/testdata/create_table_error_multiple_primary_key/ast</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -1,17 +0,0 @@
</a><a href="#h41-0-0" id="h41-0-0" class="d">-CreateTable {
</a><a href="#h41-0-1" id="h41-0-1" class="d">-    name: &quot;name&quot;,
</a><a href="#h41-0-2" id="h41-0-2" class="d">-    columns: [
</a><a href="#h41-0-3" id="h41-0-3" class="d">-        ColumnSpec {
</a><a href="#h41-0-4" id="h41-0-4" class="d">-            name: &quot;id&quot;,
</a><a href="#h41-0-5" id="h41-0-5" class="d">-            datatype: Integer,
</a><a href="#h41-0-6" id="h41-0-6" class="d">-            primary_key: true,
</a><a href="#h41-0-7" id="h41-0-7" class="d">-            nullable: None,
</a><a href="#h41-0-8" id="h41-0-8" class="d">-        },
</a><a href="#h41-0-9" id="h41-0-9" class="d">-        ColumnSpec {
</a><a href="#h41-0-10" id="h41-0-10" class="d">-            name: &quot;name&quot;,
</a><a href="#h41-0-11" id="h41-0-11" class="d">-            datatype: String,
</a><a href="#h41-0-12" id="h41-0-12" class="d">-            primary_key: true,
</a><a href="#h41-0-13" id="h41-0-13" class="d">-            nullable: None,
</a><a href="#h41-0-14" id="h41-0-14" class="d">-        },
</a><a href="#h41-0-15" id="h41-0-15" class="d">-    ],
</a><a href="#h41-0-16" id="h41-0-16" class="d">-}
</a><a href="#h41-0-17" id="h41-0-17" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h42" href="../file/src/sql/testdata/create_table_error_multiple_primary_key/plan.html">src/sql/testdata/create_table_error_multiple_primary_key/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key/plan.html">src/sql/testdata/create_table_error_multiple_primary_key/plan</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -1 +0,0 @@
</a><a href="#h42-0-0" id="h42-0-0" class="d">-Err(Value(&quot;2 primary keys defined for table name, must set exactly 1&quot;))
</a><a href="#h42-0-1" id="h42-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h43" href="../file/src/sql/testdata/create_table_error_multiple_primary_key/query.sql.html">src/sql/testdata/create_table_error_multiple_primary_key/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key/query.sql.html">src/sql/testdata/create_table_error_multiple_primary_key/query.sql</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -1 +0,0 @@
</a><a href="#h43-0-0" id="h43-0-0" class="d">-CREATE TABLE name (id INTEGER PRIMARY KEY, name VARCHAR PRIMARY KEY)
</a><a href="#h43-0-1" id="h43-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h44" href="../file/src/sql/testdata/create_table_error_multiple_primary_key/tokens.html">src/sql/testdata/create_table_error_multiple_primary_key/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key/tokens.html">src/sql/testdata/create_table_error_multiple_primary_key/tokens</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -1,38 +0,0 @@
</a><a href="#h44-0-0" id="h44-0-0" class="d">-[
</a><a href="#h44-0-1" id="h44-0-1" class="d">-    Keyword(
</a><a href="#h44-0-2" id="h44-0-2" class="d">-        Create,
</a><a href="#h44-0-3" id="h44-0-3" class="d">-    ),
</a><a href="#h44-0-4" id="h44-0-4" class="d">-    Keyword(
</a><a href="#h44-0-5" id="h44-0-5" class="d">-        Table,
</a><a href="#h44-0-6" id="h44-0-6" class="d">-    ),
</a><a href="#h44-0-7" id="h44-0-7" class="d">-    Ident(
</a><a href="#h44-0-8" id="h44-0-8" class="d">-        &quot;name&quot;,
</a><a href="#h44-0-9" id="h44-0-9" class="d">-    ),
</a><a href="#h44-0-10" id="h44-0-10" class="d">-    OpenParen,
</a><a href="#h44-0-11" id="h44-0-11" class="d">-    Ident(
</a><a href="#h44-0-12" id="h44-0-12" class="d">-        &quot;id&quot;,
</a><a href="#h44-0-13" id="h44-0-13" class="d">-    ),
</a><a href="#h44-0-14" id="h44-0-14" class="d">-    Keyword(
</a><a href="#h44-0-15" id="h44-0-15" class="d">-        Integer,
</a><a href="#h44-0-16" id="h44-0-16" class="d">-    ),
</a><a href="#h44-0-17" id="h44-0-17" class="d">-    Keyword(
</a><a href="#h44-0-18" id="h44-0-18" class="d">-        Primary,
</a><a href="#h44-0-19" id="h44-0-19" class="d">-    ),
</a><a href="#h44-0-20" id="h44-0-20" class="d">-    Keyword(
</a><a href="#h44-0-21" id="h44-0-21" class="d">-        Key,
</a><a href="#h44-0-22" id="h44-0-22" class="d">-    ),
</a><a href="#h44-0-23" id="h44-0-23" class="d">-    Comma,
</a><a href="#h44-0-24" id="h44-0-24" class="d">-    Ident(
</a><a href="#h44-0-25" id="h44-0-25" class="d">-        &quot;name&quot;,
</a><a href="#h44-0-26" id="h44-0-26" class="d">-    ),
</a><a href="#h44-0-27" id="h44-0-27" class="d">-    Keyword(
</a><a href="#h44-0-28" id="h44-0-28" class="d">-        Varchar,
</a><a href="#h44-0-29" id="h44-0-29" class="d">-    ),
</a><a href="#h44-0-30" id="h44-0-30" class="d">-    Keyword(
</a><a href="#h44-0-31" id="h44-0-31" class="d">-        Primary,
</a><a href="#h44-0-32" id="h44-0-32" class="d">-    ),
</a><a href="#h44-0-33" id="h44-0-33" class="d">-    Keyword(
</a><a href="#h44-0-34" id="h44-0-34" class="d">-        Key,
</a><a href="#h44-0-35" id="h44-0-35" class="d">-    ),
</a><a href="#h44-0-36" id="h44-0-36" class="d">-    CloseParen,
</a><a href="#h44-0-37" id="h44-0-37" class="d">-]
</a><a href="#h44-0-38" id="h44-0-38" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h45" href="../file/src/sql/testdata/create_table_error_no_columns.html">src/sql/testdata/create_table_error_no_columns</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns.html">src/sql/testdata/create_table_error_no_columns</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -0,0 +1,8 @@
</a><a href="#h45-0-0" id="h45-0-0" class="i">+Query: CREATE TABLE name
</a><a href="#h45-0-1" id="h45-0-1" class="i">+
</a><a href="#h45-0-2" id="h45-0-2" class="i">+Tokens:
</a><a href="#h45-0-3" id="h45-0-3" class="i">+  Keyword(Create)
</a><a href="#h45-0-4" id="h45-0-4" class="i">+  Keyword(Table)
</a><a href="#h45-0-5" id="h45-0-5" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h45-0-6" id="h45-0-6" class="i">+
</a><a href="#h45-0-7" id="h45-0-7" class="i">+AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h45-0-8" id="h45-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h46" href="../file/src/sql/testdata/create_table_error_no_columns/ast.html">src/sql/testdata/create_table_error_no_columns/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns/ast.html">src/sql/testdata/create_table_error_no_columns/ast</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -1 +0,0 @@
</a><a href="#h46-0-0" id="h46-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h46-0-1" id="h46-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h47" href="../file/src/sql/testdata/create_table_error_no_columns/plan.html">src/sql/testdata/create_table_error_no_columns/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns/plan.html">src/sql/testdata/create_table_error_no_columns/plan</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -1 +0,0 @@
</a><a href="#h47-0-0" id="h47-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h47-0-1" id="h47-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h48" href="../file/src/sql/testdata/create_table_error_no_columns/query.sql.html">src/sql/testdata/create_table_error_no_columns/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns/query.sql.html">src/sql/testdata/create_table_error_no_columns/query.sql</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -1 +0,0 @@
</a><a href="#h48-0-0" id="h48-0-0" class="d">-CREATE TABLE name
</a><a href="#h48-0-1" id="h48-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h49" href="../file/src/sql/testdata/create_table_error_no_columns/tokens.html">src/sql/testdata/create_table_error_no_columns/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns/tokens.html">src/sql/testdata/create_table_error_no_columns/tokens</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -1,11 +0,0 @@
</a><a href="#h49-0-0" id="h49-0-0" class="d">-[
</a><a href="#h49-0-1" id="h49-0-1" class="d">-    Keyword(
</a><a href="#h49-0-2" id="h49-0-2" class="d">-        Create,
</a><a href="#h49-0-3" id="h49-0-3" class="d">-    ),
</a><a href="#h49-0-4" id="h49-0-4" class="d">-    Keyword(
</a><a href="#h49-0-5" id="h49-0-5" class="d">-        Table,
</a><a href="#h49-0-6" id="h49-0-6" class="d">-    ),
</a><a href="#h49-0-7" id="h49-0-7" class="d">-    Ident(
</a><a href="#h49-0-8" id="h49-0-8" class="d">-        &quot;name&quot;,
</a><a href="#h49-0-9" id="h49-0-9" class="d">-    ),
</a><a href="#h49-0-10" id="h49-0-10" class="d">-]
</a><a href="#h49-0-11" id="h49-0-11" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h50" href="../file/src/sql/testdata/create_table_error_no_datatype.html">src/sql/testdata/create_table_error_no_datatype</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype.html">src/sql/testdata/create_table_error_no_datatype</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h50-0-0" id="h50-0-0" class="i">+Query: CREATE TABLE name (id)
</a><a href="#h50-0-1" id="h50-0-1" class="i">+
</a><a href="#h50-0-2" id="h50-0-2" class="i">+Tokens:
</a><a href="#h50-0-3" id="h50-0-3" class="i">+  Keyword(Create)
</a><a href="#h50-0-4" id="h50-0-4" class="i">+  Keyword(Table)
</a><a href="#h50-0-5" id="h50-0-5" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h50-0-6" id="h50-0-6" class="i">+  OpenParen
</a><a href="#h50-0-7" id="h50-0-7" class="i">+  Ident(&quot;id&quot;)
</a><a href="#h50-0-8" id="h50-0-8" class="i">+  CloseParen
</a><a href="#h50-0-9" id="h50-0-9" class="i">+
</a><a href="#h50-0-10" id="h50-0-10" class="i">+AST: Parse(&quot;Unexpected token )&quot;)
</a><a href="#h50-0-11" id="h50-0-11" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h51" href="../file/src/sql/testdata/create_table_error_no_datatype/ast.html">src/sql/testdata/create_table_error_no_datatype/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype/ast.html">src/sql/testdata/create_table_error_no_datatype/ast</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -1 +0,0 @@
</a><a href="#h51-0-0" id="h51-0-0" class="d">-Err(Parse(&quot;Unexpected token )&quot;))
</a><a href="#h51-0-1" id="h51-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h52" href="../file/src/sql/testdata/create_table_error_no_datatype/plan.html">src/sql/testdata/create_table_error_no_datatype/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype/plan.html">src/sql/testdata/create_table_error_no_datatype/plan</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -1 +0,0 @@
</a><a href="#h52-0-0" id="h52-0-0" class="d">-Err(Parse(&quot;Unexpected token )&quot;))
</a><a href="#h52-0-1" id="h52-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h53" href="../file/src/sql/testdata/create_table_error_no_datatype/query.sql.html">src/sql/testdata/create_table_error_no_datatype/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype/query.sql.html">src/sql/testdata/create_table_error_no_datatype/query.sql</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -1 +0,0 @@
</a><a href="#h53-0-0" id="h53-0-0" class="d">-CREATE TABLE name (id)
</a><a href="#h53-0-1" id="h53-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h54" href="../file/src/sql/testdata/create_table_error_no_datatype/tokens.html">src/sql/testdata/create_table_error_no_datatype/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype/tokens.html">src/sql/testdata/create_table_error_no_datatype/tokens</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -1,16 +0,0 @@
</a><a href="#h54-0-0" id="h54-0-0" class="d">-[
</a><a href="#h54-0-1" id="h54-0-1" class="d">-    Keyword(
</a><a href="#h54-0-2" id="h54-0-2" class="d">-        Create,
</a><a href="#h54-0-3" id="h54-0-3" class="d">-    ),
</a><a href="#h54-0-4" id="h54-0-4" class="d">-    Keyword(
</a><a href="#h54-0-5" id="h54-0-5" class="d">-        Table,
</a><a href="#h54-0-6" id="h54-0-6" class="d">-    ),
</a><a href="#h54-0-7" id="h54-0-7" class="d">-    Ident(
</a><a href="#h54-0-8" id="h54-0-8" class="d">-        &quot;name&quot;,
</a><a href="#h54-0-9" id="h54-0-9" class="d">-    ),
</a><a href="#h54-0-10" id="h54-0-10" class="d">-    OpenParen,
</a><a href="#h54-0-11" id="h54-0-11" class="d">-    Ident(
</a><a href="#h54-0-12" id="h54-0-12" class="d">-        &quot;id&quot;,
</a><a href="#h54-0-13" id="h54-0-13" class="d">-    ),
</a><a href="#h54-0-14" id="h54-0-14" class="d">-    CloseParen,
</a><a href="#h54-0-15" id="h54-0-15" class="d">-]
</a><a href="#h54-0-16" id="h54-0-16" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h55" href="../file/src/sql/testdata/create_table_error_no_name.html">src/sql/testdata/create_table_error_no_name</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name.html">src/sql/testdata/create_table_error_no_name</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h55-0-0" id="h55-0-0" class="i">+Query: CREATE TABLE (id INTEGER)
</a><a href="#h55-0-1" id="h55-0-1" class="i">+
</a><a href="#h55-0-2" id="h55-0-2" class="i">+Tokens:
</a><a href="#h55-0-3" id="h55-0-3" class="i">+  Keyword(Create)
</a><a href="#h55-0-4" id="h55-0-4" class="i">+  Keyword(Table)
</a><a href="#h55-0-5" id="h55-0-5" class="i">+  OpenParen
</a><a href="#h55-0-6" id="h55-0-6" class="i">+  Ident(&quot;id&quot;)
</a><a href="#h55-0-7" id="h55-0-7" class="i">+  Keyword(Integer)
</a><a href="#h55-0-8" id="h55-0-8" class="i">+  CloseParen
</a><a href="#h55-0-9" id="h55-0-9" class="i">+
</a><a href="#h55-0-10" id="h55-0-10" class="i">+AST: Parse(&quot;Expected identifier, got (&quot;)
</a><a href="#h55-0-11" id="h55-0-11" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h56" href="../file/src/sql/testdata/create_table_error_no_name/ast.html">src/sql/testdata/create_table_error_no_name/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name/ast.html">src/sql/testdata/create_table_error_no_name/ast</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -1 +0,0 @@
</a><a href="#h56-0-0" id="h56-0-0" class="d">-Err(Parse(&quot;Expected identifier, got (&quot;))
</a><a href="#h56-0-1" id="h56-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h57" href="../file/src/sql/testdata/create_table_error_no_name/plan.html">src/sql/testdata/create_table_error_no_name/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name/plan.html">src/sql/testdata/create_table_error_no_name/plan</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -1 +0,0 @@
</a><a href="#h57-0-0" id="h57-0-0" class="d">-Err(Parse(&quot;Expected identifier, got (&quot;))
</a><a href="#h57-0-1" id="h57-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h58" href="../file/src/sql/testdata/create_table_error_no_name/query.sql.html">src/sql/testdata/create_table_error_no_name/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name/query.sql.html">src/sql/testdata/create_table_error_no_name/query.sql</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -1 +0,0 @@
</a><a href="#h58-0-0" id="h58-0-0" class="d">-CREATE TABLE (id INTEGER)
</a><a href="#h58-0-1" id="h58-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h59" href="../file/src/sql/testdata/create_table_error_no_name/tokens.html">src/sql/testdata/create_table_error_no_name/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name/tokens.html">src/sql/testdata/create_table_error_no_name/tokens</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -1,16 +0,0 @@
</a><a href="#h59-0-0" id="h59-0-0" class="d">-[
</a><a href="#h59-0-1" id="h59-0-1" class="d">-    Keyword(
</a><a href="#h59-0-2" id="h59-0-2" class="d">-        Create,
</a><a href="#h59-0-3" id="h59-0-3" class="d">-    ),
</a><a href="#h59-0-4" id="h59-0-4" class="d">-    Keyword(
</a><a href="#h59-0-5" id="h59-0-5" class="d">-        Table,
</a><a href="#h59-0-6" id="h59-0-6" class="d">-    ),
</a><a href="#h59-0-7" id="h59-0-7" class="d">-    OpenParen,
</a><a href="#h59-0-8" id="h59-0-8" class="d">-    Ident(
</a><a href="#h59-0-9" id="h59-0-9" class="d">-        &quot;id&quot;,
</a><a href="#h59-0-10" id="h59-0-10" class="d">-    ),
</a><a href="#h59-0-11" id="h59-0-11" class="d">-    Keyword(
</a><a href="#h59-0-12" id="h59-0-12" class="d">-        Integer,
</a><a href="#h59-0-13" id="h59-0-13" class="d">-    ),
</a><a href="#h59-0-14" id="h59-0-14" class="d">-    CloseParen,
</a><a href="#h59-0-15" id="h59-0-15" class="d">-]
</a><a href="#h59-0-16" id="h59-0-16" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h60" href="../file/src/sql/testdata/create_table_error_no_primary_key.html">src/sql/testdata/create_table_error_no_primary_key</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key.html">src/sql/testdata/create_table_error_no_primary_key</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -0,0 +1,24 @@
</a><a href="#h60-0-0" id="h60-0-0" class="i">+Query: CREATE TABLE name (id INTEGER)
</a><a href="#h60-0-1" id="h60-0-1" class="i">+
</a><a href="#h60-0-2" id="h60-0-2" class="i">+Tokens:
</a><a href="#h60-0-3" id="h60-0-3" class="i">+  Keyword(Create)
</a><a href="#h60-0-4" id="h60-0-4" class="i">+  Keyword(Table)
</a><a href="#h60-0-5" id="h60-0-5" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h60-0-6" id="h60-0-6" class="i">+  OpenParen
</a><a href="#h60-0-7" id="h60-0-7" class="i">+  Ident(&quot;id&quot;)
</a><a href="#h60-0-8" id="h60-0-8" class="i">+  Keyword(Integer)
</a><a href="#h60-0-9" id="h60-0-9" class="i">+  CloseParen
</a><a href="#h60-0-10" id="h60-0-10" class="i">+
</a><a href="#h60-0-11" id="h60-0-11" class="i">+AST: CreateTable {
</a><a href="#h60-0-12" id="h60-0-12" class="i">+    name: &quot;name&quot;,
</a><a href="#h60-0-13" id="h60-0-13" class="i">+    columns: [
</a><a href="#h60-0-14" id="h60-0-14" class="i">+        ColumnSpec {
</a><a href="#h60-0-15" id="h60-0-15" class="i">+            name: &quot;id&quot;,
</a><a href="#h60-0-16" id="h60-0-16" class="i">+            datatype: Integer,
</a><a href="#h60-0-17" id="h60-0-17" class="i">+            primary_key: false,
</a><a href="#h60-0-18" id="h60-0-18" class="i">+            nullable: None,
</a><a href="#h60-0-19" id="h60-0-19" class="i">+        },
</a><a href="#h60-0-20" id="h60-0-20" class="i">+    ],
</a><a href="#h60-0-21" id="h60-0-21" class="i">+}
</a><a href="#h60-0-22" id="h60-0-22" class="i">+
</a><a href="#h60-0-23" id="h60-0-23" class="i">+Plan: Value(&quot;No primary key defined for table name&quot;)
</a><a href="#h60-0-24" id="h60-0-24" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h61" href="../file/src/sql/testdata/create_table_error_no_primary_key/ast.html">src/sql/testdata/create_table_error_no_primary_key/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key/ast.html">src/sql/testdata/create_table_error_no_primary_key/ast</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -1,11 +0,0 @@
</a><a href="#h61-0-0" id="h61-0-0" class="d">-CreateTable {
</a><a href="#h61-0-1" id="h61-0-1" class="d">-    name: &quot;name&quot;,
</a><a href="#h61-0-2" id="h61-0-2" class="d">-    columns: [
</a><a href="#h61-0-3" id="h61-0-3" class="d">-        ColumnSpec {
</a><a href="#h61-0-4" id="h61-0-4" class="d">-            name: &quot;id&quot;,
</a><a href="#h61-0-5" id="h61-0-5" class="d">-            datatype: Integer,
</a><a href="#h61-0-6" id="h61-0-6" class="d">-            primary_key: false,
</a><a href="#h61-0-7" id="h61-0-7" class="d">-            nullable: None,
</a><a href="#h61-0-8" id="h61-0-8" class="d">-        },
</a><a href="#h61-0-9" id="h61-0-9" class="d">-    ],
</a><a href="#h61-0-10" id="h61-0-10" class="d">-}
</a><a href="#h61-0-11" id="h61-0-11" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h62" href="../file/src/sql/testdata/create_table_error_no_primary_key/plan.html">src/sql/testdata/create_table_error_no_primary_key/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key/plan.html">src/sql/testdata/create_table_error_no_primary_key/plan</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -1 +0,0 @@
</a><a href="#h62-0-0" id="h62-0-0" class="d">-Err(Value(&quot;No primary key defined for table name&quot;))
</a><a href="#h62-0-1" id="h62-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h63" href="../file/src/sql/testdata/create_table_error_no_primary_key/query.sql.html">src/sql/testdata/create_table_error_no_primary_key/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key/query.sql.html">src/sql/testdata/create_table_error_no_primary_key/query.sql</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -1 +0,0 @@
</a><a href="#h63-0-0" id="h63-0-0" class="d">-CREATE TABLE name (id INTEGER)
</a><a href="#h63-0-1" id="h63-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h64" href="../file/src/sql/testdata/create_table_error_no_primary_key/tokens.html">src/sql/testdata/create_table_error_no_primary_key/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key/tokens.html">src/sql/testdata/create_table_error_no_primary_key/tokens</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -1,19 +0,0 @@
</a><a href="#h64-0-0" id="h64-0-0" class="d">-[
</a><a href="#h64-0-1" id="h64-0-1" class="d">-    Keyword(
</a><a href="#h64-0-2" id="h64-0-2" class="d">-        Create,
</a><a href="#h64-0-3" id="h64-0-3" class="d">-    ),
</a><a href="#h64-0-4" id="h64-0-4" class="d">-    Keyword(
</a><a href="#h64-0-5" id="h64-0-5" class="d">-        Table,
</a><a href="#h64-0-6" id="h64-0-6" class="d">-    ),
</a><a href="#h64-0-7" id="h64-0-7" class="d">-    Ident(
</a><a href="#h64-0-8" id="h64-0-8" class="d">-        &quot;name&quot;,
</a><a href="#h64-0-9" id="h64-0-9" class="d">-    ),
</a><a href="#h64-0-10" id="h64-0-10" class="d">-    OpenParen,
</a><a href="#h64-0-11" id="h64-0-11" class="d">-    Ident(
</a><a href="#h64-0-12" id="h64-0-12" class="d">-        &quot;id&quot;,
</a><a href="#h64-0-13" id="h64-0-13" class="d">-    ),
</a><a href="#h64-0-14" id="h64-0-14" class="d">-    Keyword(
</a><a href="#h64-0-15" id="h64-0-15" class="d">-        Integer,
</a><a href="#h64-0-16" id="h64-0-16" class="d">-    ),
</a><a href="#h64-0-17" id="h64-0-17" class="d">-    CloseParen,
</a><a href="#h64-0-18" id="h64-0-18" class="d">-]
</a><a href="#h64-0-19" id="h64-0-19" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h65" href="../file/src/sql/testdata/create_table_single_column.html">src/sql/testdata/create_table_single_column</a> b/<a href="../file/src/sql/testdata/create_table_single_column.html">src/sql/testdata/create_table_single_column</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -0,0 +1,68 @@
</a><a href="#h65-0-0" id="h65-0-0" class="i">+Query: CREATE TABLE name (id INTEGER PRIMARY KEY)
</a><a href="#h65-0-1" id="h65-0-1" class="i">+
</a><a href="#h65-0-2" id="h65-0-2" class="i">+Tokens:
</a><a href="#h65-0-3" id="h65-0-3" class="i">+  Keyword(Create)
</a><a href="#h65-0-4" id="h65-0-4" class="i">+  Keyword(Table)
</a><a href="#h65-0-5" id="h65-0-5" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h65-0-6" id="h65-0-6" class="i">+  OpenParen
</a><a href="#h65-0-7" id="h65-0-7" class="i">+  Ident(&quot;id&quot;)
</a><a href="#h65-0-8" id="h65-0-8" class="i">+  Keyword(Integer)
</a><a href="#h65-0-9" id="h65-0-9" class="i">+  Keyword(Primary)
</a><a href="#h65-0-10" id="h65-0-10" class="i">+  Keyword(Key)
</a><a href="#h65-0-11" id="h65-0-11" class="i">+  CloseParen
</a><a href="#h65-0-12" id="h65-0-12" class="i">+
</a><a href="#h65-0-13" id="h65-0-13" class="i">+AST: CreateTable {
</a><a href="#h65-0-14" id="h65-0-14" class="i">+    name: &quot;name&quot;,
</a><a href="#h65-0-15" id="h65-0-15" class="i">+    columns: [
</a><a href="#h65-0-16" id="h65-0-16" class="i">+        ColumnSpec {
</a><a href="#h65-0-17" id="h65-0-17" class="i">+            name: &quot;id&quot;,
</a><a href="#h65-0-18" id="h65-0-18" class="i">+            datatype: Integer,
</a><a href="#h65-0-19" id="h65-0-19" class="i">+            primary_key: true,
</a><a href="#h65-0-20" id="h65-0-20" class="i">+            nullable: None,
</a><a href="#h65-0-21" id="h65-0-21" class="i">+        },
</a><a href="#h65-0-22" id="h65-0-22" class="i">+    ],
</a><a href="#h65-0-23" id="h65-0-23" class="i">+}
</a><a href="#h65-0-24" id="h65-0-24" class="i">+
</a><a href="#h65-0-25" id="h65-0-25" class="i">+Plan: Plan {
</a><a href="#h65-0-26" id="h65-0-26" class="i">+    root: CreateTable {
</a><a href="#h65-0-27" id="h65-0-27" class="i">+        schema: Table {
</a><a href="#h65-0-28" id="h65-0-28" class="i">+            name: &quot;name&quot;,
</a><a href="#h65-0-29" id="h65-0-29" class="i">+            columns: [
</a><a href="#h65-0-30" id="h65-0-30" class="i">+                Column {
</a><a href="#h65-0-31" id="h65-0-31" class="i">+                    name: &quot;id&quot;,
</a><a href="#h65-0-32" id="h65-0-32" class="i">+                    datatype: Integer,
</a><a href="#h65-0-33" id="h65-0-33" class="i">+                    nullable: false,
</a><a href="#h65-0-34" id="h65-0-34" class="i">+                },
</a><a href="#h65-0-35" id="h65-0-35" class="i">+            ],
</a><a href="#h65-0-36" id="h65-0-36" class="i">+            primary_key: &quot;id&quot;,
</a><a href="#h65-0-37" id="h65-0-37" class="i">+        },
</a><a href="#h65-0-38" id="h65-0-38" class="i">+    },
</a><a href="#h65-0-39" id="h65-0-39" class="i">+}
</a><a href="#h65-0-40" id="h65-0-40" class="i">+
</a><a href="#h65-0-41" id="h65-0-41" class="i">+Query: CREATE TABLE name (id INTEGER PRIMARY KEY)
</a><a href="#h65-0-42" id="h65-0-42" class="i">+
</a><a href="#h65-0-43" id="h65-0-43" class="i">+Result:
</a><a href="#h65-0-44" id="h65-0-44" class="i">+
</a><a href="#h65-0-45" id="h65-0-45" class="i">+Storage:
</a><a href="#h65-0-46" id="h65-0-46" class="i">+CREATE TABLE genres (
</a><a href="#h65-0-47" id="h65-0-47" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h65-0-48" id="h65-0-48" class="i">+  name VARCHAR NOT NULL,
</a><a href="#h65-0-49" id="h65-0-49" class="i">+)
</a><a href="#h65-0-50" id="h65-0-50" class="i">+[Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h65-0-51" id="h65-0-51" class="i">+[Integer(2), String(&quot;Action&quot;)]
</a><a href="#h65-0-52" id="h65-0-52" class="i">+
</a><a href="#h65-0-53" id="h65-0-53" class="i">+CREATE TABLE movies (
</a><a href="#h65-0-54" id="h65-0-54" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h65-0-55" id="h65-0-55" class="i">+  title VARCHAR NOT NULL,
</a><a href="#h65-0-56" id="h65-0-56" class="i">+  genre_id INTEGER NOT NULL,
</a><a href="#h65-0-57" id="h65-0-57" class="i">+  released INTEGER NOT NULL,
</a><a href="#h65-0-58" id="h65-0-58" class="i">+  rating FLOAT NULL,
</a><a href="#h65-0-59" id="h65-0-59" class="i">+  bluray BOOLEAN NULL,
</a><a href="#h65-0-60" id="h65-0-60" class="i">+)
</a><a href="#h65-0-61" id="h65-0-61" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h65-0-62" id="h65-0-62" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><a href="#h65-0-63" id="h65-0-63" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(1), Integer(2004), Float(6.9), Null]
</a><a href="#h65-0-64" id="h65-0-64" class="i">+
</a><a href="#h65-0-65" id="h65-0-65" class="i">+CREATE TABLE name (
</a><a href="#h65-0-66" id="h65-0-66" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h65-0-67" id="h65-0-67" class="i">+)
</a><b>diff --git a/<a id="h66" href="../file/src/sql/testdata/create_table_single_column/ast.html">src/sql/testdata/create_table_single_column/ast</a> b/<a href="../file/src/sql/testdata/create_table_single_column/ast.html">src/sql/testdata/create_table_single_column/ast</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -1,11 +0,0 @@
</a><a href="#h66-0-0" id="h66-0-0" class="d">-CreateTable {
</a><a href="#h66-0-1" id="h66-0-1" class="d">-    name: &quot;name&quot;,
</a><a href="#h66-0-2" id="h66-0-2" class="d">-    columns: [
</a><a href="#h66-0-3" id="h66-0-3" class="d">-        ColumnSpec {
</a><a href="#h66-0-4" id="h66-0-4" class="d">-            name: &quot;id&quot;,
</a><a href="#h66-0-5" id="h66-0-5" class="d">-            datatype: Integer,
</a><a href="#h66-0-6" id="h66-0-6" class="d">-            primary_key: true,
</a><a href="#h66-0-7" id="h66-0-7" class="d">-            nullable: None,
</a><a href="#h66-0-8" id="h66-0-8" class="d">-        },
</a><a href="#h66-0-9" id="h66-0-9" class="d">-    ],
</a><a href="#h66-0-10" id="h66-0-10" class="d">-}
</a><a href="#h66-0-11" id="h66-0-11" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h67" href="../file/src/sql/testdata/create_table_single_column/plan.html">src/sql/testdata/create_table_single_column/plan</a> b/<a href="../file/src/sql/testdata/create_table_single_column/plan.html">src/sql/testdata/create_table_single_column/plan</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -1,19 +0,0 @@
</a><a href="#h67-0-0" id="h67-0-0" class="d">-Plan {
</a><a href="#h67-0-1" id="h67-0-1" class="d">-    columns: [],
</a><a href="#h67-0-2" id="h67-0-2" class="d">-    root: DDL {
</a><a href="#h67-0-3" id="h67-0-3" class="d">-        storage: Storage,
</a><a href="#h67-0-4" id="h67-0-4" class="d">-        ddl: CreateTable(
</a><a href="#h67-0-5" id="h67-0-5" class="d">-            Table {
</a><a href="#h67-0-6" id="h67-0-6" class="d">-                name: &quot;name&quot;,
</a><a href="#h67-0-7" id="h67-0-7" class="d">-                columns: [
</a><a href="#h67-0-8" id="h67-0-8" class="d">-                    Column {
</a><a href="#h67-0-9" id="h67-0-9" class="d">-                        name: &quot;id&quot;,
</a><a href="#h67-0-10" id="h67-0-10" class="d">-                        datatype: Integer,
</a><a href="#h67-0-11" id="h67-0-11" class="d">-                        nullable: false,
</a><a href="#h67-0-12" id="h67-0-12" class="d">-                    },
</a><a href="#h67-0-13" id="h67-0-13" class="d">-                ],
</a><a href="#h67-0-14" id="h67-0-14" class="d">-                primary_key: &quot;id&quot;,
</a><a href="#h67-0-15" id="h67-0-15" class="d">-            },
</a><a href="#h67-0-16" id="h67-0-16" class="d">-        ),
</a><a href="#h67-0-17" id="h67-0-17" class="d">-    },
</a><a href="#h67-0-18" id="h67-0-18" class="d">-}
</a><a href="#h67-0-19" id="h67-0-19" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h68" href="../file/src/sql/testdata/create_table_single_column/query.sql.html">src/sql/testdata/create_table_single_column/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_single_column/query.sql.html">src/sql/testdata/create_table_single_column/query.sql</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -1 +0,0 @@
</a><a href="#h68-0-0" id="h68-0-0" class="d">-CREATE TABLE name (id INTEGER PRIMARY KEY)
</a><a href="#h68-0-1" id="h68-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h69" href="../file/src/sql/testdata/create_table_single_column/tokens.html">src/sql/testdata/create_table_single_column/tokens</a> b/<a href="../file/src/sql/testdata/create_table_single_column/tokens.html">src/sql/testdata/create_table_single_column/tokens</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -1,25 +0,0 @@
</a><a href="#h69-0-0" id="h69-0-0" class="d">-[
</a><a href="#h69-0-1" id="h69-0-1" class="d">-    Keyword(
</a><a href="#h69-0-2" id="h69-0-2" class="d">-        Create,
</a><a href="#h69-0-3" id="h69-0-3" class="d">-    ),
</a><a href="#h69-0-4" id="h69-0-4" class="d">-    Keyword(
</a><a href="#h69-0-5" id="h69-0-5" class="d">-        Table,
</a><a href="#h69-0-6" id="h69-0-6" class="d">-    ),
</a><a href="#h69-0-7" id="h69-0-7" class="d">-    Ident(
</a><a href="#h69-0-8" id="h69-0-8" class="d">-        &quot;name&quot;,
</a><a href="#h69-0-9" id="h69-0-9" class="d">-    ),
</a><a href="#h69-0-10" id="h69-0-10" class="d">-    OpenParen,
</a><a href="#h69-0-11" id="h69-0-11" class="d">-    Ident(
</a><a href="#h69-0-12" id="h69-0-12" class="d">-        &quot;id&quot;,
</a><a href="#h69-0-13" id="h69-0-13" class="d">-    ),
</a><a href="#h69-0-14" id="h69-0-14" class="d">-    Keyword(
</a><a href="#h69-0-15" id="h69-0-15" class="d">-        Integer,
</a><a href="#h69-0-16" id="h69-0-16" class="d">-    ),
</a><a href="#h69-0-17" id="h69-0-17" class="d">-    Keyword(
</a><a href="#h69-0-18" id="h69-0-18" class="d">-        Primary,
</a><a href="#h69-0-19" id="h69-0-19" class="d">-    ),
</a><a href="#h69-0-20" id="h69-0-20" class="d">-    Keyword(
</a><a href="#h69-0-21" id="h69-0-21" class="d">-        Key,
</a><a href="#h69-0-22" id="h69-0-22" class="d">-    ),
</a><a href="#h69-0-23" id="h69-0-23" class="d">-    CloseParen,
</a><a href="#h69-0-24" id="h69-0-24" class="d">-]
</a><a href="#h69-0-25" id="h69-0-25" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h70" href="../file/src/sql/testdata/drop_table.html">src/sql/testdata/drop_table</a> b/<a href="../file/src/sql/testdata/drop_table.html">src/sql/testdata/drop_table</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -0,0 +1,20 @@
</a><a href="#h70-0-0" id="h70-0-0" class="i">+Query: DROP TABLE name
</a><a href="#h70-0-1" id="h70-0-1" class="i">+
</a><a href="#h70-0-2" id="h70-0-2" class="i">+Tokens:
</a><a href="#h70-0-3" id="h70-0-3" class="i">+  Keyword(Drop)
</a><a href="#h70-0-4" id="h70-0-4" class="i">+  Keyword(Table)
</a><a href="#h70-0-5" id="h70-0-5" class="i">+  Ident(&quot;name&quot;)
</a><a href="#h70-0-6" id="h70-0-6" class="i">+
</a><a href="#h70-0-7" id="h70-0-7" class="i">+AST: DropTable(
</a><a href="#h70-0-8" id="h70-0-8" class="i">+    &quot;name&quot;,
</a><a href="#h70-0-9" id="h70-0-9" class="i">+)
</a><a href="#h70-0-10" id="h70-0-10" class="i">+
</a><a href="#h70-0-11" id="h70-0-11" class="i">+Plan: Plan {
</a><a href="#h70-0-12" id="h70-0-12" class="i">+    root: DropTable {
</a><a href="#h70-0-13" id="h70-0-13" class="i">+        table: &quot;name&quot;,
</a><a href="#h70-0-14" id="h70-0-14" class="i">+    },
</a><a href="#h70-0-15" id="h70-0-15" class="i">+}
</a><a href="#h70-0-16" id="h70-0-16" class="i">+
</a><a href="#h70-0-17" id="h70-0-17" class="i">+Query: DROP TABLE name
</a><a href="#h70-0-18" id="h70-0-18" class="i">+
</a><a href="#h70-0-19" id="h70-0-19" class="i">+Result: Value(&quot;Table name does not exist&quot;)
</a><a href="#h70-0-20" id="h70-0-20" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h71" href="../file/src/sql/testdata/drop_table/ast.html">src/sql/testdata/drop_table/ast</a> b/<a href="../file/src/sql/testdata/drop_table/ast.html">src/sql/testdata/drop_table/ast</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -1,3 +0,0 @@
</a><a href="#h71-0-0" id="h71-0-0" class="d">-DropTable(
</a><a href="#h71-0-1" id="h71-0-1" class="d">-    &quot;name&quot;,
</a><a href="#h71-0-2" id="h71-0-2" class="d">-)
</a><a href="#h71-0-3" id="h71-0-3" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h72" href="../file/src/sql/testdata/drop_table/plan.html">src/sql/testdata/drop_table/plan</a> b/<a href="../file/src/sql/testdata/drop_table/plan.html">src/sql/testdata/drop_table/plan</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -1,9 +0,0 @@
</a><a href="#h72-0-0" id="h72-0-0" class="d">-Plan {
</a><a href="#h72-0-1" id="h72-0-1" class="d">-    columns: [],
</a><a href="#h72-0-2" id="h72-0-2" class="d">-    root: DDL {
</a><a href="#h72-0-3" id="h72-0-3" class="d">-        storage: Storage,
</a><a href="#h72-0-4" id="h72-0-4" class="d">-        ddl: DropTable(
</a><a href="#h72-0-5" id="h72-0-5" class="d">-            &quot;name&quot;,
</a><a href="#h72-0-6" id="h72-0-6" class="d">-        ),
</a><a href="#h72-0-7" id="h72-0-7" class="d">-    },
</a><a href="#h72-0-8" id="h72-0-8" class="d">-}
</a><a href="#h72-0-9" id="h72-0-9" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h73" href="../file/src/sql/testdata/drop_table/query.sql.html">src/sql/testdata/drop_table/query.sql</a> b/<a href="../file/src/sql/testdata/drop_table/query.sql.html">src/sql/testdata/drop_table/query.sql</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -1 +0,0 @@
</a><a href="#h73-0-0" id="h73-0-0" class="d">-DROP TABLE name
</a><a href="#h73-0-1" id="h73-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h74" href="../file/src/sql/testdata/drop_table/tokens.html">src/sql/testdata/drop_table/tokens</a> b/<a href="../file/src/sql/testdata/drop_table/tokens.html">src/sql/testdata/drop_table/tokens</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -1,11 +0,0 @@
</a><a href="#h74-0-0" id="h74-0-0" class="d">-[
</a><a href="#h74-0-1" id="h74-0-1" class="d">-    Keyword(
</a><a href="#h74-0-2" id="h74-0-2" class="d">-        Drop,
</a><a href="#h74-0-3" id="h74-0-3" class="d">-    ),
</a><a href="#h74-0-4" id="h74-0-4" class="d">-    Keyword(
</a><a href="#h74-0-5" id="h74-0-5" class="d">-        Table,
</a><a href="#h74-0-6" id="h74-0-6" class="d">-    ),
</a><a href="#h74-0-7" id="h74-0-7" class="d">-    Ident(
</a><a href="#h74-0-8" id="h74-0-8" class="d">-        &quot;name&quot;,
</a><a href="#h74-0-9" id="h74-0-9" class="d">-    ),
</a><a href="#h74-0-10" id="h74-0-10" class="d">-]
</a><a href="#h74-0-11" id="h74-0-11" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h75" href="../file/src/sql/testdata/drop_table_error_bare.html">src/sql/testdata/drop_table_error_bare</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare.html">src/sql/testdata/drop_table_error_bare</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -0,0 +1,7 @@
</a><a href="#h75-0-0" id="h75-0-0" class="i">+Query: DROP TABLE
</a><a href="#h75-0-1" id="h75-0-1" class="i">+
</a><a href="#h75-0-2" id="h75-0-2" class="i">+Tokens:
</a><a href="#h75-0-3" id="h75-0-3" class="i">+  Keyword(Drop)
</a><a href="#h75-0-4" id="h75-0-4" class="i">+  Keyword(Table)
</a><a href="#h75-0-5" id="h75-0-5" class="i">+
</a><a href="#h75-0-6" id="h75-0-6" class="i">+AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h75-0-7" id="h75-0-7" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h76" href="../file/src/sql/testdata/drop_table_error_bare/ast.html">src/sql/testdata/drop_table_error_bare/ast</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare/ast.html">src/sql/testdata/drop_table_error_bare/ast</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -1 +0,0 @@
</a><a href="#h76-0-0" id="h76-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h76-0-1" id="h76-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h77" href="../file/src/sql/testdata/drop_table_error_bare/plan.html">src/sql/testdata/drop_table_error_bare/plan</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare/plan.html">src/sql/testdata/drop_table_error_bare/plan</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -1 +0,0 @@
</a><a href="#h77-0-0" id="h77-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h77-0-1" id="h77-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h78" href="../file/src/sql/testdata/drop_table_error_bare/query.sql.html">src/sql/testdata/drop_table_error_bare/query.sql</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare/query.sql.html">src/sql/testdata/drop_table_error_bare/query.sql</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -1 +0,0 @@
</a><a href="#h78-0-0" id="h78-0-0" class="d">-DROP TABLE
</a><a href="#h78-0-1" id="h78-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h79" href="../file/src/sql/testdata/drop_table_error_bare/tokens.html">src/sql/testdata/drop_table_error_bare/tokens</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare/tokens.html">src/sql/testdata/drop_table_error_bare/tokens</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h79-0-0" id="h79-0-0" class="d">-[
</a><a href="#h79-0-1" id="h79-0-1" class="d">-    Keyword(
</a><a href="#h79-0-2" id="h79-0-2" class="d">-        Drop,
</a><a href="#h79-0-3" id="h79-0-3" class="d">-    ),
</a><a href="#h79-0-4" id="h79-0-4" class="d">-    Keyword(
</a><a href="#h79-0-5" id="h79-0-5" class="d">-        Table,
</a><a href="#h79-0-6" id="h79-0-6" class="d">-    ),
</a><a href="#h79-0-7" id="h79-0-7" class="d">-]
</a><a href="#h79-0-8" id="h79-0-8" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h80" href="../file/src/sql/testdata/expr_datatypes.html">src/sql/testdata/expr_datatypes</a> b/<a href="../file/src/sql/testdata/expr_datatypes.html">src/sql/testdata/expr_datatypes</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -0,0 +1,128 @@
</a><a href="#h80-0-0" id="h80-0-0" class="i">+Query: SELECT NULL, TRUE, FALSE, 1, 3.14, &#39;Hi! 👋&#39;
</a><a href="#h80-0-1" id="h80-0-1" class="i">+
</a><a href="#h80-0-2" id="h80-0-2" class="i">+Tokens:
</a><a href="#h80-0-3" id="h80-0-3" class="i">+  Keyword(Select)
</a><a href="#h80-0-4" id="h80-0-4" class="i">+  Keyword(Null)
</a><a href="#h80-0-5" id="h80-0-5" class="i">+  Comma
</a><a href="#h80-0-6" id="h80-0-6" class="i">+  Keyword(True)
</a><a href="#h80-0-7" id="h80-0-7" class="i">+  Comma
</a><a href="#h80-0-8" id="h80-0-8" class="i">+  Keyword(False)
</a><a href="#h80-0-9" id="h80-0-9" class="i">+  Comma
</a><a href="#h80-0-10" id="h80-0-10" class="i">+  Number(&quot;1&quot;)
</a><a href="#h80-0-11" id="h80-0-11" class="i">+  Comma
</a><a href="#h80-0-12" id="h80-0-12" class="i">+  Number(&quot;3.14&quot;)
</a><a href="#h80-0-13" id="h80-0-13" class="i">+  Comma
</a><a href="#h80-0-14" id="h80-0-14" class="i">+  String(&quot;Hi! 👋&quot;)
</a><a href="#h80-0-15" id="h80-0-15" class="i">+
</a><a href="#h80-0-16" id="h80-0-16" class="i">+AST: Select {
</a><a href="#h80-0-17" id="h80-0-17" class="i">+    select: SelectClause {
</a><a href="#h80-0-18" id="h80-0-18" class="i">+        expressions: [
</a><a href="#h80-0-19" id="h80-0-19" class="i">+            Literal(
</a><a href="#h80-0-20" id="h80-0-20" class="i">+                Null,
</a><a href="#h80-0-21" id="h80-0-21" class="i">+            ),
</a><a href="#h80-0-22" id="h80-0-22" class="i">+            Literal(
</a><a href="#h80-0-23" id="h80-0-23" class="i">+                Boolean(
</a><a href="#h80-0-24" id="h80-0-24" class="i">+                    true,
</a><a href="#h80-0-25" id="h80-0-25" class="i">+                ),
</a><a href="#h80-0-26" id="h80-0-26" class="i">+            ),
</a><a href="#h80-0-27" id="h80-0-27" class="i">+            Literal(
</a><a href="#h80-0-28" id="h80-0-28" class="i">+                Boolean(
</a><a href="#h80-0-29" id="h80-0-29" class="i">+                    false,
</a><a href="#h80-0-30" id="h80-0-30" class="i">+                ),
</a><a href="#h80-0-31" id="h80-0-31" class="i">+            ),
</a><a href="#h80-0-32" id="h80-0-32" class="i">+            Literal(
</a><a href="#h80-0-33" id="h80-0-33" class="i">+                Integer(
</a><a href="#h80-0-34" id="h80-0-34" class="i">+                    1,
</a><a href="#h80-0-35" id="h80-0-35" class="i">+                ),
</a><a href="#h80-0-36" id="h80-0-36" class="i">+            ),
</a><a href="#h80-0-37" id="h80-0-37" class="i">+            Literal(
</a><a href="#h80-0-38" id="h80-0-38" class="i">+                Float(
</a><a href="#h80-0-39" id="h80-0-39" class="i">+                    3.14,
</a><a href="#h80-0-40" id="h80-0-40" class="i">+                ),
</a><a href="#h80-0-41" id="h80-0-41" class="i">+            ),
</a><a href="#h80-0-42" id="h80-0-42" class="i">+            Literal(
</a><a href="#h80-0-43" id="h80-0-43" class="i">+                String(
</a><a href="#h80-0-44" id="h80-0-44" class="i">+                    &quot;Hi! 👋&quot;,
</a><a href="#h80-0-45" id="h80-0-45" class="i">+                ),
</a><a href="#h80-0-46" id="h80-0-46" class="i">+            ),
</a><a href="#h80-0-47" id="h80-0-47" class="i">+        ],
</a><a href="#h80-0-48" id="h80-0-48" class="i">+        labels: [
</a><a href="#h80-0-49" id="h80-0-49" class="i">+            None,
</a><a href="#h80-0-50" id="h80-0-50" class="i">+            None,
</a><a href="#h80-0-51" id="h80-0-51" class="i">+            None,
</a><a href="#h80-0-52" id="h80-0-52" class="i">+            None,
</a><a href="#h80-0-53" id="h80-0-53" class="i">+            None,
</a><a href="#h80-0-54" id="h80-0-54" class="i">+            None,
</a><a href="#h80-0-55" id="h80-0-55" class="i">+        ],
</a><a href="#h80-0-56" id="h80-0-56" class="i">+    },
</a><a href="#h80-0-57" id="h80-0-57" class="i">+    from: None,
</a><a href="#h80-0-58" id="h80-0-58" class="i">+}
</a><a href="#h80-0-59" id="h80-0-59" class="i">+
</a><a href="#h80-0-60" id="h80-0-60" class="i">+Plan: Plan {
</a><a href="#h80-0-61" id="h80-0-61" class="i">+    root: Projection {
</a><a href="#h80-0-62" id="h80-0-62" class="i">+        source: Nothing,
</a><a href="#h80-0-63" id="h80-0-63" class="i">+        labels: [
</a><a href="#h80-0-64" id="h80-0-64" class="i">+            &quot;?&quot;,
</a><a href="#h80-0-65" id="h80-0-65" class="i">+            &quot;?&quot;,
</a><a href="#h80-0-66" id="h80-0-66" class="i">+            &quot;?&quot;,
</a><a href="#h80-0-67" id="h80-0-67" class="i">+            &quot;?&quot;,
</a><a href="#h80-0-68" id="h80-0-68" class="i">+            &quot;?&quot;,
</a><a href="#h80-0-69" id="h80-0-69" class="i">+            &quot;?&quot;,
</a><a href="#h80-0-70" id="h80-0-70" class="i">+        ],
</a><a href="#h80-0-71" id="h80-0-71" class="i">+        expressions: [
</a><a href="#h80-0-72" id="h80-0-72" class="i">+            Constant(
</a><a href="#h80-0-73" id="h80-0-73" class="i">+                Null,
</a><a href="#h80-0-74" id="h80-0-74" class="i">+            ),
</a><a href="#h80-0-75" id="h80-0-75" class="i">+            Constant(
</a><a href="#h80-0-76" id="h80-0-76" class="i">+                Boolean(
</a><a href="#h80-0-77" id="h80-0-77" class="i">+                    true,
</a><a href="#h80-0-78" id="h80-0-78" class="i">+                ),
</a><a href="#h80-0-79" id="h80-0-79" class="i">+            ),
</a><a href="#h80-0-80" id="h80-0-80" class="i">+            Constant(
</a><a href="#h80-0-81" id="h80-0-81" class="i">+                Boolean(
</a><a href="#h80-0-82" id="h80-0-82" class="i">+                    false,
</a><a href="#h80-0-83" id="h80-0-83" class="i">+                ),
</a><a href="#h80-0-84" id="h80-0-84" class="i">+            ),
</a><a href="#h80-0-85" id="h80-0-85" class="i">+            Constant(
</a><a href="#h80-0-86" id="h80-0-86" class="i">+                Integer(
</a><a href="#h80-0-87" id="h80-0-87" class="i">+                    1,
</a><a href="#h80-0-88" id="h80-0-88" class="i">+                ),
</a><a href="#h80-0-89" id="h80-0-89" class="i">+            ),
</a><a href="#h80-0-90" id="h80-0-90" class="i">+            Constant(
</a><a href="#h80-0-91" id="h80-0-91" class="i">+                Float(
</a><a href="#h80-0-92" id="h80-0-92" class="i">+                    3.14,
</a><a href="#h80-0-93" id="h80-0-93" class="i">+                ),
</a><a href="#h80-0-94" id="h80-0-94" class="i">+            ),
</a><a href="#h80-0-95" id="h80-0-95" class="i">+            Constant(
</a><a href="#h80-0-96" id="h80-0-96" class="i">+                String(
</a><a href="#h80-0-97" id="h80-0-97" class="i">+                    &quot;Hi! 👋&quot;,
</a><a href="#h80-0-98" id="h80-0-98" class="i">+                ),
</a><a href="#h80-0-99" id="h80-0-99" class="i">+            ),
</a><a href="#h80-0-100" id="h80-0-100" class="i">+        ],
</a><a href="#h80-0-101" id="h80-0-101" class="i">+    },
</a><a href="#h80-0-102" id="h80-0-102" class="i">+}
</a><a href="#h80-0-103" id="h80-0-103" class="i">+
</a><a href="#h80-0-104" id="h80-0-104" class="i">+Query: SELECT NULL, TRUE, FALSE, 1, 3.14, &#39;Hi! 👋&#39;
</a><a href="#h80-0-105" id="h80-0-105" class="i">+
</a><a href="#h80-0-106" id="h80-0-106" class="i">+Result:
</a><a href="#h80-0-107" id="h80-0-107" class="i">+[Null, Boolean(true), Boolean(false), Integer(1), Float(3.14), String(&quot;Hi! 👋&quot;)]
</a><a href="#h80-0-108" id="h80-0-108" class="i">+
</a><a href="#h80-0-109" id="h80-0-109" class="i">+Storage:
</a><a href="#h80-0-110" id="h80-0-110" class="i">+CREATE TABLE genres (
</a><a href="#h80-0-111" id="h80-0-111" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h80-0-112" id="h80-0-112" class="i">+  name VARCHAR NOT NULL,
</a><a href="#h80-0-113" id="h80-0-113" class="i">+)
</a><a href="#h80-0-114" id="h80-0-114" class="i">+[Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h80-0-115" id="h80-0-115" class="i">+[Integer(2), String(&quot;Action&quot;)]
</a><a href="#h80-0-116" id="h80-0-116" class="i">+
</a><a href="#h80-0-117" id="h80-0-117" class="i">+CREATE TABLE movies (
</a><a href="#h80-0-118" id="h80-0-118" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h80-0-119" id="h80-0-119" class="i">+  title VARCHAR NOT NULL,
</a><a href="#h80-0-120" id="h80-0-120" class="i">+  genre_id INTEGER NOT NULL,
</a><a href="#h80-0-121" id="h80-0-121" class="i">+  released INTEGER NOT NULL,
</a><a href="#h80-0-122" id="h80-0-122" class="i">+  rating FLOAT NULL,
</a><a href="#h80-0-123" id="h80-0-123" class="i">+  bluray BOOLEAN NULL,
</a><a href="#h80-0-124" id="h80-0-124" class="i">+)
</a><a href="#h80-0-125" id="h80-0-125" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h80-0-126" id="h80-0-126" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><a href="#h80-0-127" id="h80-0-127" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(1), Integer(2004), Float(6.9), Null]
</a><b>diff --git a/<a id="h81" href="../file/src/sql/testdata/expr_literal_numbers.html">src/sql/testdata/expr_literal_numbers</a> b/<a href="../file/src/sql/testdata/expr_literal_numbers.html">src/sql/testdata/expr_literal_numbers</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -0,0 +1,203 @@
</a><a href="#h81-0-0" id="h81-0-0" class="i">+Query: SELECT 0, 1, -2, --3, +-4, 3.14, 293, 3.14e3, 2.718E-2
</a><a href="#h81-0-1" id="h81-0-1" class="i">+
</a><a href="#h81-0-2" id="h81-0-2" class="i">+Tokens:
</a><a href="#h81-0-3" id="h81-0-3" class="i">+  Keyword(Select)
</a><a href="#h81-0-4" id="h81-0-4" class="i">+  Number(&quot;0&quot;)
</a><a href="#h81-0-5" id="h81-0-5" class="i">+  Comma
</a><a href="#h81-0-6" id="h81-0-6" class="i">+  Number(&quot;1&quot;)
</a><a href="#h81-0-7" id="h81-0-7" class="i">+  Comma
</a><a href="#h81-0-8" id="h81-0-8" class="i">+  Minus
</a><a href="#h81-0-9" id="h81-0-9" class="i">+  Number(&quot;2&quot;)
</a><a href="#h81-0-10" id="h81-0-10" class="i">+  Comma
</a><a href="#h81-0-11" id="h81-0-11" class="i">+  Minus
</a><a href="#h81-0-12" id="h81-0-12" class="i">+  Minus
</a><a href="#h81-0-13" id="h81-0-13" class="i">+  Number(&quot;3&quot;)
</a><a href="#h81-0-14" id="h81-0-14" class="i">+  Comma
</a><a href="#h81-0-15" id="h81-0-15" class="i">+  Plus
</a><a href="#h81-0-16" id="h81-0-16" class="i">+  Minus
</a><a href="#h81-0-17" id="h81-0-17" class="i">+  Number(&quot;4&quot;)
</a><a href="#h81-0-18" id="h81-0-18" class="i">+  Comma
</a><a href="#h81-0-19" id="h81-0-19" class="i">+  Number(&quot;3.14&quot;)
</a><a href="#h81-0-20" id="h81-0-20" class="i">+  Comma
</a><a href="#h81-0-21" id="h81-0-21" class="i">+  Number(&quot;293&quot;)
</a><a href="#h81-0-22" id="h81-0-22" class="i">+  Comma
</a><a href="#h81-0-23" id="h81-0-23" class="i">+  Number(&quot;3.14e3&quot;)
</a><a href="#h81-0-24" id="h81-0-24" class="i">+  Comma
</a><a href="#h81-0-25" id="h81-0-25" class="i">+  Number(&quot;2.718E-2&quot;)
</a><a href="#h81-0-26" id="h81-0-26" class="i">+
</a><a href="#h81-0-27" id="h81-0-27" class="i">+AST: Select {
</a><a href="#h81-0-28" id="h81-0-28" class="i">+    select: SelectClause {
</a><a href="#h81-0-29" id="h81-0-29" class="i">+        expressions: [
</a><a href="#h81-0-30" id="h81-0-30" class="i">+            Literal(
</a><a href="#h81-0-31" id="h81-0-31" class="i">+                Integer(
</a><a href="#h81-0-32" id="h81-0-32" class="i">+                    0,
</a><a href="#h81-0-33" id="h81-0-33" class="i">+                ),
</a><a href="#h81-0-34" id="h81-0-34" class="i">+            ),
</a><a href="#h81-0-35" id="h81-0-35" class="i">+            Literal(
</a><a href="#h81-0-36" id="h81-0-36" class="i">+                Integer(
</a><a href="#h81-0-37" id="h81-0-37" class="i">+                    1,
</a><a href="#h81-0-38" id="h81-0-38" class="i">+                ),
</a><a href="#h81-0-39" id="h81-0-39" class="i">+            ),
</a><a href="#h81-0-40" id="h81-0-40" class="i">+            Operation(
</a><a href="#h81-0-41" id="h81-0-41" class="i">+                Negate(
</a><a href="#h81-0-42" id="h81-0-42" class="i">+                    Literal(
</a><a href="#h81-0-43" id="h81-0-43" class="i">+                        Integer(
</a><a href="#h81-0-44" id="h81-0-44" class="i">+                            2,
</a><a href="#h81-0-45" id="h81-0-45" class="i">+                        ),
</a><a href="#h81-0-46" id="h81-0-46" class="i">+                    ),
</a><a href="#h81-0-47" id="h81-0-47" class="i">+                ),
</a><a href="#h81-0-48" id="h81-0-48" class="i">+            ),
</a><a href="#h81-0-49" id="h81-0-49" class="i">+            Operation(
</a><a href="#h81-0-50" id="h81-0-50" class="i">+                Negate(
</a><a href="#h81-0-51" id="h81-0-51" class="i">+                    Operation(
</a><a href="#h81-0-52" id="h81-0-52" class="i">+                        Negate(
</a><a href="#h81-0-53" id="h81-0-53" class="i">+                            Literal(
</a><a href="#h81-0-54" id="h81-0-54" class="i">+                                Integer(
</a><a href="#h81-0-55" id="h81-0-55" class="i">+                                    3,
</a><a href="#h81-0-56" id="h81-0-56" class="i">+                                ),
</a><a href="#h81-0-57" id="h81-0-57" class="i">+                            ),
</a><a href="#h81-0-58" id="h81-0-58" class="i">+                        ),
</a><a href="#h81-0-59" id="h81-0-59" class="i">+                    ),
</a><a href="#h81-0-60" id="h81-0-60" class="i">+                ),
</a><a href="#h81-0-61" id="h81-0-61" class="i">+            ),
</a><a href="#h81-0-62" id="h81-0-62" class="i">+            Operation(
</a><a href="#h81-0-63" id="h81-0-63" class="i">+                Negate(
</a><a href="#h81-0-64" id="h81-0-64" class="i">+                    Literal(
</a><a href="#h81-0-65" id="h81-0-65" class="i">+                        Integer(
</a><a href="#h81-0-66" id="h81-0-66" class="i">+                            4,
</a><a href="#h81-0-67" id="h81-0-67" class="i">+                        ),
</a><a href="#h81-0-68" id="h81-0-68" class="i">+                    ),
</a><a href="#h81-0-69" id="h81-0-69" class="i">+                ),
</a><a href="#h81-0-70" id="h81-0-70" class="i">+            ),
</a><a href="#h81-0-71" id="h81-0-71" class="i">+            Literal(
</a><a href="#h81-0-72" id="h81-0-72" class="i">+                Float(
</a><a href="#h81-0-73" id="h81-0-73" class="i">+                    3.14,
</a><a href="#h81-0-74" id="h81-0-74" class="i">+                ),
</a><a href="#h81-0-75" id="h81-0-75" class="i">+            ),
</a><a href="#h81-0-76" id="h81-0-76" class="i">+            Literal(
</a><a href="#h81-0-77" id="h81-0-77" class="i">+                Integer(
</a><a href="#h81-0-78" id="h81-0-78" class="i">+                    293,
</a><a href="#h81-0-79" id="h81-0-79" class="i">+                ),
</a><a href="#h81-0-80" id="h81-0-80" class="i">+            ),
</a><a href="#h81-0-81" id="h81-0-81" class="i">+            Literal(
</a><a href="#h81-0-82" id="h81-0-82" class="i">+                Float(
</a><a href="#h81-0-83" id="h81-0-83" class="i">+                    3140.0,
</a><a href="#h81-0-84" id="h81-0-84" class="i">+                ),
</a><a href="#h81-0-85" id="h81-0-85" class="i">+            ),
</a><a href="#h81-0-86" id="h81-0-86" class="i">+            Literal(
</a><a href="#h81-0-87" id="h81-0-87" class="i">+                Float(
</a><a href="#h81-0-88" id="h81-0-88" class="i">+                    0.02718,
</a><a href="#h81-0-89" id="h81-0-89" class="i">+                ),
</a><a href="#h81-0-90" id="h81-0-90" class="i">+            ),
</a><a href="#h81-0-91" id="h81-0-91" class="i">+        ],
</a><a href="#h81-0-92" id="h81-0-92" class="i">+        labels: [
</a><a href="#h81-0-93" id="h81-0-93" class="i">+            None,
</a><a href="#h81-0-94" id="h81-0-94" class="i">+            None,
</a><a href="#h81-0-95" id="h81-0-95" class="i">+            None,
</a><a href="#h81-0-96" id="h81-0-96" class="i">+            None,
</a><a href="#h81-0-97" id="h81-0-97" class="i">+            None,
</a><a href="#h81-0-98" id="h81-0-98" class="i">+            None,
</a><a href="#h81-0-99" id="h81-0-99" class="i">+            None,
</a><a href="#h81-0-100" id="h81-0-100" class="i">+            None,
</a><a href="#h81-0-101" id="h81-0-101" class="i">+            None,
</a><a href="#h81-0-102" id="h81-0-102" class="i">+        ],
</a><a href="#h81-0-103" id="h81-0-103" class="i">+    },
</a><a href="#h81-0-104" id="h81-0-104" class="i">+    from: None,
</a><a href="#h81-0-105" id="h81-0-105" class="i">+}
</a><a href="#h81-0-106" id="h81-0-106" class="i">+
</a><a href="#h81-0-107" id="h81-0-107" class="i">+Plan: Plan {
</a><a href="#h81-0-108" id="h81-0-108" class="i">+    root: Projection {
</a><a href="#h81-0-109" id="h81-0-109" class="i">+        source: Nothing,
</a><a href="#h81-0-110" id="h81-0-110" class="i">+        labels: [
</a><a href="#h81-0-111" id="h81-0-111" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-112" id="h81-0-112" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-113" id="h81-0-113" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-114" id="h81-0-114" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-115" id="h81-0-115" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-116" id="h81-0-116" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-117" id="h81-0-117" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-118" id="h81-0-118" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-119" id="h81-0-119" class="i">+            &quot;?&quot;,
</a><a href="#h81-0-120" id="h81-0-120" class="i">+        ],
</a><a href="#h81-0-121" id="h81-0-121" class="i">+        expressions: [
</a><a href="#h81-0-122" id="h81-0-122" class="i">+            Constant(
</a><a href="#h81-0-123" id="h81-0-123" class="i">+                Integer(
</a><a href="#h81-0-124" id="h81-0-124" class="i">+                    0,
</a><a href="#h81-0-125" id="h81-0-125" class="i">+                ),
</a><a href="#h81-0-126" id="h81-0-126" class="i">+            ),
</a><a href="#h81-0-127" id="h81-0-127" class="i">+            Constant(
</a><a href="#h81-0-128" id="h81-0-128" class="i">+                Integer(
</a><a href="#h81-0-129" id="h81-0-129" class="i">+                    1,
</a><a href="#h81-0-130" id="h81-0-130" class="i">+                ),
</a><a href="#h81-0-131" id="h81-0-131" class="i">+            ),
</a><a href="#h81-0-132" id="h81-0-132" class="i">+            Negate(
</a><a href="#h81-0-133" id="h81-0-133" class="i">+                Constant(
</a><a href="#h81-0-134" id="h81-0-134" class="i">+                    Integer(
</a><a href="#h81-0-135" id="h81-0-135" class="i">+                        2,
</a><a href="#h81-0-136" id="h81-0-136" class="i">+                    ),
</a><a href="#h81-0-137" id="h81-0-137" class="i">+                ),
</a><a href="#h81-0-138" id="h81-0-138" class="i">+            ),
</a><a href="#h81-0-139" id="h81-0-139" class="i">+            Negate(
</a><a href="#h81-0-140" id="h81-0-140" class="i">+                Negate(
</a><a href="#h81-0-141" id="h81-0-141" class="i">+                    Constant(
</a><a href="#h81-0-142" id="h81-0-142" class="i">+                        Integer(
</a><a href="#h81-0-143" id="h81-0-143" class="i">+                            3,
</a><a href="#h81-0-144" id="h81-0-144" class="i">+                        ),
</a><a href="#h81-0-145" id="h81-0-145" class="i">+                    ),
</a><a href="#h81-0-146" id="h81-0-146" class="i">+                ),
</a><a href="#h81-0-147" id="h81-0-147" class="i">+            ),
</a><a href="#h81-0-148" id="h81-0-148" class="i">+            Negate(
</a><a href="#h81-0-149" id="h81-0-149" class="i">+                Constant(
</a><a href="#h81-0-150" id="h81-0-150" class="i">+                    Integer(
</a><a href="#h81-0-151" id="h81-0-151" class="i">+                        4,
</a><a href="#h81-0-152" id="h81-0-152" class="i">+                    ),
</a><a href="#h81-0-153" id="h81-0-153" class="i">+                ),
</a><a href="#h81-0-154" id="h81-0-154" class="i">+            ),
</a><a href="#h81-0-155" id="h81-0-155" class="i">+            Constant(
</a><a href="#h81-0-156" id="h81-0-156" class="i">+                Float(
</a><a href="#h81-0-157" id="h81-0-157" class="i">+                    3.14,
</a><a href="#h81-0-158" id="h81-0-158" class="i">+                ),
</a><a href="#h81-0-159" id="h81-0-159" class="i">+            ),
</a><a href="#h81-0-160" id="h81-0-160" class="i">+            Constant(
</a><a href="#h81-0-161" id="h81-0-161" class="i">+                Integer(
</a><a href="#h81-0-162" id="h81-0-162" class="i">+                    293,
</a><a href="#h81-0-163" id="h81-0-163" class="i">+                ),
</a><a href="#h81-0-164" id="h81-0-164" class="i">+            ),
</a><a href="#h81-0-165" id="h81-0-165" class="i">+            Constant(
</a><a href="#h81-0-166" id="h81-0-166" class="i">+                Float(
</a><a href="#h81-0-167" id="h81-0-167" class="i">+                    3140.0,
</a><a href="#h81-0-168" id="h81-0-168" class="i">+                ),
</a><a href="#h81-0-169" id="h81-0-169" class="i">+            ),
</a><a href="#h81-0-170" id="h81-0-170" class="i">+            Constant(
</a><a href="#h81-0-171" id="h81-0-171" class="i">+                Float(
</a><a href="#h81-0-172" id="h81-0-172" class="i">+                    0.02718,
</a><a href="#h81-0-173" id="h81-0-173" class="i">+                ),
</a><a href="#h81-0-174" id="h81-0-174" class="i">+            ),
</a><a href="#h81-0-175" id="h81-0-175" class="i">+        ],
</a><a href="#h81-0-176" id="h81-0-176" class="i">+    },
</a><a href="#h81-0-177" id="h81-0-177" class="i">+}
</a><a href="#h81-0-178" id="h81-0-178" class="i">+
</a><a href="#h81-0-179" id="h81-0-179" class="i">+Query: SELECT 0, 1, -2, --3, +-4, 3.14, 293, 3.14e3, 2.718E-2
</a><a href="#h81-0-180" id="h81-0-180" class="i">+
</a><a href="#h81-0-181" id="h81-0-181" class="i">+Result:
</a><a href="#h81-0-182" id="h81-0-182" class="i">+[Integer(0), Integer(1), Integer(-2), Integer(3), Integer(-4), Float(3.14), Integer(293), Float(3140.0), Float(0.02718)]
</a><a href="#h81-0-183" id="h81-0-183" class="i">+
</a><a href="#h81-0-184" id="h81-0-184" class="i">+Storage:
</a><a href="#h81-0-185" id="h81-0-185" class="i">+CREATE TABLE genres (
</a><a href="#h81-0-186" id="h81-0-186" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h81-0-187" id="h81-0-187" class="i">+  name VARCHAR NOT NULL,
</a><a href="#h81-0-188" id="h81-0-188" class="i">+)
</a><a href="#h81-0-189" id="h81-0-189" class="i">+[Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h81-0-190" id="h81-0-190" class="i">+[Integer(2), String(&quot;Action&quot;)]
</a><a href="#h81-0-191" id="h81-0-191" class="i">+
</a><a href="#h81-0-192" id="h81-0-192" class="i">+CREATE TABLE movies (
</a><a href="#h81-0-193" id="h81-0-193" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h81-0-194" id="h81-0-194" class="i">+  title VARCHAR NOT NULL,
</a><a href="#h81-0-195" id="h81-0-195" class="i">+  genre_id INTEGER NOT NULL,
</a><a href="#h81-0-196" id="h81-0-196" class="i">+  released INTEGER NOT NULL,
</a><a href="#h81-0-197" id="h81-0-197" class="i">+  rating FLOAT NULL,
</a><a href="#h81-0-198" id="h81-0-198" class="i">+  bluray BOOLEAN NULL,
</a><a href="#h81-0-199" id="h81-0-199" class="i">+)
</a><a href="#h81-0-200" id="h81-0-200" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h81-0-201" id="h81-0-201" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><a href="#h81-0-202" id="h81-0-202" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(1), Integer(2004), Float(6.9), Null]
</a><b>diff --git a/<a id="h82" href="../file/src/sql/testdata/expr_literal_string_quotes.html">src/sql/testdata/expr_literal_string_quotes</a> b/<a href="../file/src/sql/testdata/expr_literal_string_quotes.html">src/sql/testdata/expr_literal_string_quotes</a></b>
<a href="#h82-0" id="h82-0" class="h">@@ -0,0 +1,62 @@
</a><a href="#h82-0-0" id="h82-0-0" class="i">+Query: SELECT &#39;Literal with &#39;&#39;single&#39;&#39; and &quot;double&quot; quotes&#39;
</a><a href="#h82-0-1" id="h82-0-1" class="i">+
</a><a href="#h82-0-2" id="h82-0-2" class="i">+Tokens:
</a><a href="#h82-0-3" id="h82-0-3" class="i">+  Keyword(Select)
</a><a href="#h82-0-4" id="h82-0-4" class="i">+  String(&quot;Literal with \&#39;single\&#39; and \&quot;double\&quot; quotes&quot;)
</a><a href="#h82-0-5" id="h82-0-5" class="i">+
</a><a href="#h82-0-6" id="h82-0-6" class="i">+AST: Select {
</a><a href="#h82-0-7" id="h82-0-7" class="i">+    select: SelectClause {
</a><a href="#h82-0-8" id="h82-0-8" class="i">+        expressions: [
</a><a href="#h82-0-9" id="h82-0-9" class="i">+            Literal(
</a><a href="#h82-0-10" id="h82-0-10" class="i">+                String(
</a><a href="#h82-0-11" id="h82-0-11" class="i">+                    &quot;Literal with \&#39;single\&#39; and \&quot;double\&quot; quotes&quot;,
</a><a href="#h82-0-12" id="h82-0-12" class="i">+                ),
</a><a href="#h82-0-13" id="h82-0-13" class="i">+            ),
</a><a href="#h82-0-14" id="h82-0-14" class="i">+        ],
</a><a href="#h82-0-15" id="h82-0-15" class="i">+        labels: [
</a><a href="#h82-0-16" id="h82-0-16" class="i">+            None,
</a><a href="#h82-0-17" id="h82-0-17" class="i">+        ],
</a><a href="#h82-0-18" id="h82-0-18" class="i">+    },
</a><a href="#h82-0-19" id="h82-0-19" class="i">+    from: None,
</a><a href="#h82-0-20" id="h82-0-20" class="i">+}
</a><a href="#h82-0-21" id="h82-0-21" class="i">+
</a><a href="#h82-0-22" id="h82-0-22" class="i">+Plan: Plan {
</a><a href="#h82-0-23" id="h82-0-23" class="i">+    root: Projection {
</a><a href="#h82-0-24" id="h82-0-24" class="i">+        source: Nothing,
</a><a href="#h82-0-25" id="h82-0-25" class="i">+        labels: [
</a><a href="#h82-0-26" id="h82-0-26" class="i">+            &quot;?&quot;,
</a><a href="#h82-0-27" id="h82-0-27" class="i">+        ],
</a><a href="#h82-0-28" id="h82-0-28" class="i">+        expressions: [
</a><a href="#h82-0-29" id="h82-0-29" class="i">+            Constant(
</a><a href="#h82-0-30" id="h82-0-30" class="i">+                String(
</a><a href="#h82-0-31" id="h82-0-31" class="i">+                    &quot;Literal with \&#39;single\&#39; and \&quot;double\&quot; quotes&quot;,
</a><a href="#h82-0-32" id="h82-0-32" class="i">+                ),
</a><a href="#h82-0-33" id="h82-0-33" class="i">+            ),
</a><a href="#h82-0-34" id="h82-0-34" class="i">+        ],
</a><a href="#h82-0-35" id="h82-0-35" class="i">+    },
</a><a href="#h82-0-36" id="h82-0-36" class="i">+}
</a><a href="#h82-0-37" id="h82-0-37" class="i">+
</a><a href="#h82-0-38" id="h82-0-38" class="i">+Query: SELECT &#39;Literal with &#39;&#39;single&#39;&#39; and &quot;double&quot; quotes&#39;
</a><a href="#h82-0-39" id="h82-0-39" class="i">+
</a><a href="#h82-0-40" id="h82-0-40" class="i">+Result:
</a><a href="#h82-0-41" id="h82-0-41" class="i">+[String(&quot;Literal with \&#39;single\&#39; and \&quot;double\&quot; quotes&quot;)]
</a><a href="#h82-0-42" id="h82-0-42" class="i">+
</a><a href="#h82-0-43" id="h82-0-43" class="i">+Storage:
</a><a href="#h82-0-44" id="h82-0-44" class="i">+CREATE TABLE genres (
</a><a href="#h82-0-45" id="h82-0-45" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h82-0-46" id="h82-0-46" class="i">+  name VARCHAR NOT NULL,
</a><a href="#h82-0-47" id="h82-0-47" class="i">+)
</a><a href="#h82-0-48" id="h82-0-48" class="i">+[Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h82-0-49" id="h82-0-49" class="i">+[Integer(2), String(&quot;Action&quot;)]
</a><a href="#h82-0-50" id="h82-0-50" class="i">+
</a><a href="#h82-0-51" id="h82-0-51" class="i">+CREATE TABLE movies (
</a><a href="#h82-0-52" id="h82-0-52" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h82-0-53" id="h82-0-53" class="i">+  title VARCHAR NOT NULL,
</a><a href="#h82-0-54" id="h82-0-54" class="i">+  genre_id INTEGER NOT NULL,
</a><a href="#h82-0-55" id="h82-0-55" class="i">+  released INTEGER NOT NULL,
</a><a href="#h82-0-56" id="h82-0-56" class="i">+  rating FLOAT NULL,
</a><a href="#h82-0-57" id="h82-0-57" class="i">+  bluray BOOLEAN NULL,
</a><a href="#h82-0-58" id="h82-0-58" class="i">+)
</a><a href="#h82-0-59" id="h82-0-59" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h82-0-60" id="h82-0-60" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><a href="#h82-0-61" id="h82-0-61" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(1), Integer(2004), Float(6.9), Null]
</a><b>diff --git a/<a id="h83" href="../file/src/sql/testdata/select_aliases.html">src/sql/testdata/select_aliases</a> b/<a href="../file/src/sql/testdata/select_aliases.html">src/sql/testdata/select_aliases</a></b>
<a href="#h83-0" id="h83-0" class="h">@@ -0,0 +1,97 @@
</a><a href="#h83-0-0" id="h83-0-0" class="i">+Query: SELECT 1, 2 b, 3 AS c
</a><a href="#h83-0-1" id="h83-0-1" class="i">+
</a><a href="#h83-0-2" id="h83-0-2" class="i">+Tokens:
</a><a href="#h83-0-3" id="h83-0-3" class="i">+  Keyword(Select)
</a><a href="#h83-0-4" id="h83-0-4" class="i">+  Number(&quot;1&quot;)
</a><a href="#h83-0-5" id="h83-0-5" class="i">+  Comma
</a><a href="#h83-0-6" id="h83-0-6" class="i">+  Number(&quot;2&quot;)
</a><a href="#h83-0-7" id="h83-0-7" class="i">+  Ident(&quot;b&quot;)
</a><a href="#h83-0-8" id="h83-0-8" class="i">+  Comma
</a><a href="#h83-0-9" id="h83-0-9" class="i">+  Number(&quot;3&quot;)
</a><a href="#h83-0-10" id="h83-0-10" class="i">+  Keyword(As)
</a><a href="#h83-0-11" id="h83-0-11" class="i">+  Ident(&quot;c&quot;)
</a><a href="#h83-0-12" id="h83-0-12" class="i">+
</a><a href="#h83-0-13" id="h83-0-13" class="i">+AST: Select {
</a><a href="#h83-0-14" id="h83-0-14" class="i">+    select: SelectClause {
</a><a href="#h83-0-15" id="h83-0-15" class="i">+        expressions: [
</a><a href="#h83-0-16" id="h83-0-16" class="i">+            Literal(
</a><a href="#h83-0-17" id="h83-0-17" class="i">+                Integer(
</a><a href="#h83-0-18" id="h83-0-18" class="i">+                    1,
</a><a href="#h83-0-19" id="h83-0-19" class="i">+                ),
</a><a href="#h83-0-20" id="h83-0-20" class="i">+            ),
</a><a href="#h83-0-21" id="h83-0-21" class="i">+            Literal(
</a><a href="#h83-0-22" id="h83-0-22" class="i">+                Integer(
</a><a href="#h83-0-23" id="h83-0-23" class="i">+                    2,
</a><a href="#h83-0-24" id="h83-0-24" class="i">+                ),
</a><a href="#h83-0-25" id="h83-0-25" class="i">+            ),
</a><a href="#h83-0-26" id="h83-0-26" class="i">+            Literal(
</a><a href="#h83-0-27" id="h83-0-27" class="i">+                Integer(
</a><a href="#h83-0-28" id="h83-0-28" class="i">+                    3,
</a><a href="#h83-0-29" id="h83-0-29" class="i">+                ),
</a><a href="#h83-0-30" id="h83-0-30" class="i">+            ),
</a><a href="#h83-0-31" id="h83-0-31" class="i">+        ],
</a><a href="#h83-0-32" id="h83-0-32" class="i">+        labels: [
</a><a href="#h83-0-33" id="h83-0-33" class="i">+            None,
</a><a href="#h83-0-34" id="h83-0-34" class="i">+            Some(
</a><a href="#h83-0-35" id="h83-0-35" class="i">+                &quot;b&quot;,
</a><a href="#h83-0-36" id="h83-0-36" class="i">+            ),
</a><a href="#h83-0-37" id="h83-0-37" class="i">+            Some(
</a><a href="#h83-0-38" id="h83-0-38" class="i">+                &quot;c&quot;,
</a><a href="#h83-0-39" id="h83-0-39" class="i">+            ),
</a><a href="#h83-0-40" id="h83-0-40" class="i">+        ],
</a><a href="#h83-0-41" id="h83-0-41" class="i">+    },
</a><a href="#h83-0-42" id="h83-0-42" class="i">+    from: None,
</a><a href="#h83-0-43" id="h83-0-43" class="i">+}
</a><a href="#h83-0-44" id="h83-0-44" class="i">+
</a><a href="#h83-0-45" id="h83-0-45" class="i">+Plan: Plan {
</a><a href="#h83-0-46" id="h83-0-46" class="i">+    root: Projection {
</a><a href="#h83-0-47" id="h83-0-47" class="i">+        source: Nothing,
</a><a href="#h83-0-48" id="h83-0-48" class="i">+        labels: [
</a><a href="#h83-0-49" id="h83-0-49" class="i">+            &quot;?&quot;,
</a><a href="#h83-0-50" id="h83-0-50" class="i">+            &quot;b&quot;,
</a><a href="#h83-0-51" id="h83-0-51" class="i">+            &quot;c&quot;,
</a><a href="#h83-0-52" id="h83-0-52" class="i">+        ],
</a><a href="#h83-0-53" id="h83-0-53" class="i">+        expressions: [
</a><a href="#h83-0-54" id="h83-0-54" class="i">+            Constant(
</a><a href="#h83-0-55" id="h83-0-55" class="i">+                Integer(
</a><a href="#h83-0-56" id="h83-0-56" class="i">+                    1,
</a><a href="#h83-0-57" id="h83-0-57" class="i">+                ),
</a><a href="#h83-0-58" id="h83-0-58" class="i">+            ),
</a><a href="#h83-0-59" id="h83-0-59" class="i">+            Constant(
</a><a href="#h83-0-60" id="h83-0-60" class="i">+                Integer(
</a><a href="#h83-0-61" id="h83-0-61" class="i">+                    2,
</a><a href="#h83-0-62" id="h83-0-62" class="i">+                ),
</a><a href="#h83-0-63" id="h83-0-63" class="i">+            ),
</a><a href="#h83-0-64" id="h83-0-64" class="i">+            Constant(
</a><a href="#h83-0-65" id="h83-0-65" class="i">+                Integer(
</a><a href="#h83-0-66" id="h83-0-66" class="i">+                    3,
</a><a href="#h83-0-67" id="h83-0-67" class="i">+                ),
</a><a href="#h83-0-68" id="h83-0-68" class="i">+            ),
</a><a href="#h83-0-69" id="h83-0-69" class="i">+        ],
</a><a href="#h83-0-70" id="h83-0-70" class="i">+    },
</a><a href="#h83-0-71" id="h83-0-71" class="i">+}
</a><a href="#h83-0-72" id="h83-0-72" class="i">+
</a><a href="#h83-0-73" id="h83-0-73" class="i">+Query: SELECT 1, 2 b, 3 AS c
</a><a href="#h83-0-74" id="h83-0-74" class="i">+
</a><a href="#h83-0-75" id="h83-0-75" class="i">+Result:
</a><a href="#h83-0-76" id="h83-0-76" class="i">+[Integer(1), Integer(2), Integer(3)]
</a><a href="#h83-0-77" id="h83-0-77" class="i">+
</a><a href="#h83-0-78" id="h83-0-78" class="i">+Storage:
</a><a href="#h83-0-79" id="h83-0-79" class="i">+CREATE TABLE genres (
</a><a href="#h83-0-80" id="h83-0-80" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h83-0-81" id="h83-0-81" class="i">+  name VARCHAR NOT NULL,
</a><a href="#h83-0-82" id="h83-0-82" class="i">+)
</a><a href="#h83-0-83" id="h83-0-83" class="i">+[Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h83-0-84" id="h83-0-84" class="i">+[Integer(2), String(&quot;Action&quot;)]
</a><a href="#h83-0-85" id="h83-0-85" class="i">+
</a><a href="#h83-0-86" id="h83-0-86" class="i">+CREATE TABLE movies (
</a><a href="#h83-0-87" id="h83-0-87" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h83-0-88" id="h83-0-88" class="i">+  title VARCHAR NOT NULL,
</a><a href="#h83-0-89" id="h83-0-89" class="i">+  genre_id INTEGER NOT NULL,
</a><a href="#h83-0-90" id="h83-0-90" class="i">+  released INTEGER NOT NULL,
</a><a href="#h83-0-91" id="h83-0-91" class="i">+  rating FLOAT NULL,
</a><a href="#h83-0-92" id="h83-0-92" class="i">+  bluray BOOLEAN NULL,
</a><a href="#h83-0-93" id="h83-0-93" class="i">+)
</a><a href="#h83-0-94" id="h83-0-94" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h83-0-95" id="h83-0-95" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><a href="#h83-0-96" id="h83-0-96" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(1), Integer(2004), Float(6.9), Null]
</a><b>diff --git a/<a id="h84" href="../file/src/sql/testdata/select_all_from_table.html">src/sql/testdata/select_all_from_table</a> b/<a href="../file/src/sql/testdata/select_all_from_table.html">src/sql/testdata/select_all_from_table</a></b>
<a href="#h84-0" id="h84-0" class="h">@@ -0,0 +1,54 @@
</a><a href="#h84-0-0" id="h84-0-0" class="i">+Query: SELECT * FROM movies
</a><a href="#h84-0-1" id="h84-0-1" class="i">+
</a><a href="#h84-0-2" id="h84-0-2" class="i">+Tokens:
</a><a href="#h84-0-3" id="h84-0-3" class="i">+  Keyword(Select)
</a><a href="#h84-0-4" id="h84-0-4" class="i">+  Asterisk
</a><a href="#h84-0-5" id="h84-0-5" class="i">+  Keyword(From)
</a><a href="#h84-0-6" id="h84-0-6" class="i">+  Ident(&quot;movies&quot;)
</a><a href="#h84-0-7" id="h84-0-7" class="i">+
</a><a href="#h84-0-8" id="h84-0-8" class="i">+AST: Select {
</a><a href="#h84-0-9" id="h84-0-9" class="i">+    select: SelectClause {
</a><a href="#h84-0-10" id="h84-0-10" class="i">+        expressions: [],
</a><a href="#h84-0-11" id="h84-0-11" class="i">+        labels: [],
</a><a href="#h84-0-12" id="h84-0-12" class="i">+    },
</a><a href="#h84-0-13" id="h84-0-13" class="i">+    from: Some(
</a><a href="#h84-0-14" id="h84-0-14" class="i">+        FromClause {
</a><a href="#h84-0-15" id="h84-0-15" class="i">+            tables: [
</a><a href="#h84-0-16" id="h84-0-16" class="i">+                &quot;movies&quot;,
</a><a href="#h84-0-17" id="h84-0-17" class="i">+            ],
</a><a href="#h84-0-18" id="h84-0-18" class="i">+        },
</a><a href="#h84-0-19" id="h84-0-19" class="i">+    ),
</a><a href="#h84-0-20" id="h84-0-20" class="i">+}
</a><a href="#h84-0-21" id="h84-0-21" class="i">+
</a><a href="#h84-0-22" id="h84-0-22" class="i">+Plan: Plan {
</a><a href="#h84-0-23" id="h84-0-23" class="i">+    root: Scan {
</a><a href="#h84-0-24" id="h84-0-24" class="i">+        table: &quot;movies&quot;,
</a><a href="#h84-0-25" id="h84-0-25" class="i">+    },
</a><a href="#h84-0-26" id="h84-0-26" class="i">+}
</a><a href="#h84-0-27" id="h84-0-27" class="i">+
</a><a href="#h84-0-28" id="h84-0-28" class="i">+Query: SELECT * FROM movies
</a><a href="#h84-0-29" id="h84-0-29" class="i">+
</a><a href="#h84-0-30" id="h84-0-30" class="i">+Result:
</a><a href="#h84-0-31" id="h84-0-31" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h84-0-32" id="h84-0-32" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><a href="#h84-0-33" id="h84-0-33" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(1), Integer(2004), Float(6.9), Null]
</a><a href="#h84-0-34" id="h84-0-34" class="i">+
</a><a href="#h84-0-35" id="h84-0-35" class="i">+Storage:
</a><a href="#h84-0-36" id="h84-0-36" class="i">+CREATE TABLE genres (
</a><a href="#h84-0-37" id="h84-0-37" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h84-0-38" id="h84-0-38" class="i">+  name VARCHAR NOT NULL,
</a><a href="#h84-0-39" id="h84-0-39" class="i">+)
</a><a href="#h84-0-40" id="h84-0-40" class="i">+[Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h84-0-41" id="h84-0-41" class="i">+[Integer(2), String(&quot;Action&quot;)]
</a><a href="#h84-0-42" id="h84-0-42" class="i">+
</a><a href="#h84-0-43" id="h84-0-43" class="i">+CREATE TABLE movies (
</a><a href="#h84-0-44" id="h84-0-44" class="i">+  id INTEGER PRIMARY KEY NOT NULL,
</a><a href="#h84-0-45" id="h84-0-45" class="i">+  title VARCHAR NOT NULL,
</a><a href="#h84-0-46" id="h84-0-46" class="i">+  genre_id INTEGER NOT NULL,
</a><a href="#h84-0-47" id="h84-0-47" class="i">+  released INTEGER NOT NULL,
</a><a href="#h84-0-48" id="h84-0-48" class="i">+  rating FLOAT NULL,
</a><a href="#h84-0-49" id="h84-0-49" class="i">+  bluray BOOLEAN NULL,
</a><a href="#h84-0-50" id="h84-0-50" class="i">+)
</a><a href="#h84-0-51" id="h84-0-51" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h84-0-52" id="h84-0-52" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</a><a href="#h84-0-53" id="h84-0-53" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(1), Integer(2004), Float(6.9), Null]
</a><b>diff --git a/<a id="h85" href="../file/src/sql/testdata/select_alone_aliases/ast.html">src/sql/testdata/select_alone_aliases/ast</a> b/<a href="../file/src/sql/testdata/select_alone_aliases/ast.html">src/sql/testdata/select_alone_aliases/ast</a></b>
<a href="#h85-0" id="h85-0" class="h">@@ -1,30 +0,0 @@
</a><a href="#h85-0-0" id="h85-0-0" class="d">-Select {
</a><a href="#h85-0-1" id="h85-0-1" class="d">-    select: SelectClause {
</a><a href="#h85-0-2" id="h85-0-2" class="d">-        expressions: [
</a><a href="#h85-0-3" id="h85-0-3" class="d">-            Literal(
</a><a href="#h85-0-4" id="h85-0-4" class="d">-                Integer(
</a><a href="#h85-0-5" id="h85-0-5" class="d">-                    1,
</a><a href="#h85-0-6" id="h85-0-6" class="d">-                ),
</a><a href="#h85-0-7" id="h85-0-7" class="d">-            ),
</a><a href="#h85-0-8" id="h85-0-8" class="d">-            Literal(
</a><a href="#h85-0-9" id="h85-0-9" class="d">-                Integer(
</a><a href="#h85-0-10" id="h85-0-10" class="d">-                    2,
</a><a href="#h85-0-11" id="h85-0-11" class="d">-                ),
</a><a href="#h85-0-12" id="h85-0-12" class="d">-            ),
</a><a href="#h85-0-13" id="h85-0-13" class="d">-            Literal(
</a><a href="#h85-0-14" id="h85-0-14" class="d">-                Integer(
</a><a href="#h85-0-15" id="h85-0-15" class="d">-                    3,
</a><a href="#h85-0-16" id="h85-0-16" class="d">-                ),
</a><a href="#h85-0-17" id="h85-0-17" class="d">-            ),
</a><a href="#h85-0-18" id="h85-0-18" class="d">-        ],
</a><a href="#h85-0-19" id="h85-0-19" class="d">-        labels: [
</a><a href="#h85-0-20" id="h85-0-20" class="d">-            None,
</a><a href="#h85-0-21" id="h85-0-21" class="d">-            Some(
</a><a href="#h85-0-22" id="h85-0-22" class="d">-                &quot;b&quot;,
</a><a href="#h85-0-23" id="h85-0-23" class="d">-            ),
</a><a href="#h85-0-24" id="h85-0-24" class="d">-            Some(
</a><a href="#h85-0-25" id="h85-0-25" class="d">-                &quot;c&quot;,
</a><a href="#h85-0-26" id="h85-0-26" class="d">-            ),
</a><a href="#h85-0-27" id="h85-0-27" class="d">-        ],
</a><a href="#h85-0-28" id="h85-0-28" class="d">-    },
</a><a href="#h85-0-29" id="h85-0-29" class="d">-}
</a><a href="#h85-0-30" id="h85-0-30" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h86" href="../file/src/sql/testdata/select_alone_aliases/plan.html">src/sql/testdata/select_alone_aliases/plan</a> b/<a href="../file/src/sql/testdata/select_alone_aliases/plan.html">src/sql/testdata/select_alone_aliases/plan</a></b>
<a href="#h86-0" id="h86-0" class="h">@@ -1,34 +0,0 @@
</a><a href="#h86-0-0" id="h86-0-0" class="d">-Plan {
</a><a href="#h86-0-1" id="h86-0-1" class="d">-    columns: [
</a><a href="#h86-0-2" id="h86-0-2" class="d">-        &quot;?&quot;,
</a><a href="#h86-0-3" id="h86-0-3" class="d">-        &quot;b&quot;,
</a><a href="#h86-0-4" id="h86-0-4" class="d">-        &quot;c&quot;,
</a><a href="#h86-0-5" id="h86-0-5" class="d">-    ],
</a><a href="#h86-0-6" id="h86-0-6" class="d">-    root: Projection {
</a><a href="#h86-0-7" id="h86-0-7" class="d">-        labels: [
</a><a href="#h86-0-8" id="h86-0-8" class="d">-            &quot;?&quot;,
</a><a href="#h86-0-9" id="h86-0-9" class="d">-            &quot;b&quot;,
</a><a href="#h86-0-10" id="h86-0-10" class="d">-            &quot;c&quot;,
</a><a href="#h86-0-11" id="h86-0-11" class="d">-        ],
</a><a href="#h86-0-12" id="h86-0-12" class="d">-        source: Nothing {
</a><a href="#h86-0-13" id="h86-0-13" class="d">-            done: false,
</a><a href="#h86-0-14" id="h86-0-14" class="d">-        },
</a><a href="#h86-0-15" id="h86-0-15" class="d">-        expressions: [
</a><a href="#h86-0-16" id="h86-0-16" class="d">-            Constant(
</a><a href="#h86-0-17" id="h86-0-17" class="d">-                Integer(
</a><a href="#h86-0-18" id="h86-0-18" class="d">-                    1,
</a><a href="#h86-0-19" id="h86-0-19" class="d">-                ),
</a><a href="#h86-0-20" id="h86-0-20" class="d">-            ),
</a><a href="#h86-0-21" id="h86-0-21" class="d">-            Constant(
</a><a href="#h86-0-22" id="h86-0-22" class="d">-                Integer(
</a><a href="#h86-0-23" id="h86-0-23" class="d">-                    2,
</a><a href="#h86-0-24" id="h86-0-24" class="d">-                ),
</a><a href="#h86-0-25" id="h86-0-25" class="d">-            ),
</a><a href="#h86-0-26" id="h86-0-26" class="d">-            Constant(
</a><a href="#h86-0-27" id="h86-0-27" class="d">-                Integer(
</a><a href="#h86-0-28" id="h86-0-28" class="d">-                    3,
</a><a href="#h86-0-29" id="h86-0-29" class="d">-                ),
</a><a href="#h86-0-30" id="h86-0-30" class="d">-            ),
</a><a href="#h86-0-31" id="h86-0-31" class="d">-        ],
</a><a href="#h86-0-32" id="h86-0-32" class="d">-    },
</a><a href="#h86-0-33" id="h86-0-33" class="d">-}
</a><a href="#h86-0-34" id="h86-0-34" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h87" href="../file/src/sql/testdata/select_alone_aliases/query.sql.html">src/sql/testdata/select_alone_aliases/query.sql</a> b/<a href="../file/src/sql/testdata/select_alone_aliases/query.sql.html">src/sql/testdata/select_alone_aliases/query.sql</a></b>
<a href="#h87-0" id="h87-0" class="h">@@ -1 +0,0 @@
</a><a href="#h87-0-0" id="h87-0-0" class="d">-SELECT 1, 2 b, 3 AS c
</a><a href="#h87-0-1" id="h87-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h88" href="../file/src/sql/testdata/select_alone_aliases/tokens.html">src/sql/testdata/select_alone_aliases/tokens</a> b/<a href="../file/src/sql/testdata/select_alone_aliases/tokens.html">src/sql/testdata/select_alone_aliases/tokens</a></b>
<a href="#h88-0" id="h88-0" class="h">@@ -1,25 +0,0 @@
</a><a href="#h88-0-0" id="h88-0-0" class="d">-[
</a><a href="#h88-0-1" id="h88-0-1" class="d">-    Keyword(
</a><a href="#h88-0-2" id="h88-0-2" class="d">-        Select,
</a><a href="#h88-0-3" id="h88-0-3" class="d">-    ),
</a><a href="#h88-0-4" id="h88-0-4" class="d">-    Number(
</a><a href="#h88-0-5" id="h88-0-5" class="d">-        &quot;1&quot;,
</a><a href="#h88-0-6" id="h88-0-6" class="d">-    ),
</a><a href="#h88-0-7" id="h88-0-7" class="d">-    Comma,
</a><a href="#h88-0-8" id="h88-0-8" class="d">-    Number(
</a><a href="#h88-0-9" id="h88-0-9" class="d">-        &quot;2&quot;,
</a><a href="#h88-0-10" id="h88-0-10" class="d">-    ),
</a><a href="#h88-0-11" id="h88-0-11" class="d">-    Ident(
</a><a href="#h88-0-12" id="h88-0-12" class="d">-        &quot;b&quot;,
</a><a href="#h88-0-13" id="h88-0-13" class="d">-    ),
</a><a href="#h88-0-14" id="h88-0-14" class="d">-    Comma,
</a><a href="#h88-0-15" id="h88-0-15" class="d">-    Number(
</a><a href="#h88-0-16" id="h88-0-16" class="d">-        &quot;3&quot;,
</a><a href="#h88-0-17" id="h88-0-17" class="d">-    ),
</a><a href="#h88-0-18" id="h88-0-18" class="d">-    Keyword(
</a><a href="#h88-0-19" id="h88-0-19" class="d">-        As,
</a><a href="#h88-0-20" id="h88-0-20" class="d">-    ),
</a><a href="#h88-0-21" id="h88-0-21" class="d">-    Ident(
</a><a href="#h88-0-22" id="h88-0-22" class="d">-        &quot;c&quot;,
</a><a href="#h88-0-23" id="h88-0-23" class="d">-    ),
</a><a href="#h88-0-24" id="h88-0-24" class="d">-]
</a><a href="#h88-0-25" id="h88-0-25" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h89" href="../file/src/sql/testdata/select_alone_datatypes/ast.html">src/sql/testdata/select_alone_datatypes/ast</a> b/<a href="../file/src/sql/testdata/select_alone_datatypes/ast.html">src/sql/testdata/select_alone_datatypes/ast</a></b>
<a href="#h89-0" id="h89-0" class="h">@@ -1,42 +0,0 @@
</a><a href="#h89-0-0" id="h89-0-0" class="d">-Select {
</a><a href="#h89-0-1" id="h89-0-1" class="d">-    select: SelectClause {
</a><a href="#h89-0-2" id="h89-0-2" class="d">-        expressions: [
</a><a href="#h89-0-3" id="h89-0-3" class="d">-            Literal(
</a><a href="#h89-0-4" id="h89-0-4" class="d">-                Null,
</a><a href="#h89-0-5" id="h89-0-5" class="d">-            ),
</a><a href="#h89-0-6" id="h89-0-6" class="d">-            Literal(
</a><a href="#h89-0-7" id="h89-0-7" class="d">-                Boolean(
</a><a href="#h89-0-8" id="h89-0-8" class="d">-                    true,
</a><a href="#h89-0-9" id="h89-0-9" class="d">-                ),
</a><a href="#h89-0-10" id="h89-0-10" class="d">-            ),
</a><a href="#h89-0-11" id="h89-0-11" class="d">-            Literal(
</a><a href="#h89-0-12" id="h89-0-12" class="d">-                Boolean(
</a><a href="#h89-0-13" id="h89-0-13" class="d">-                    false,
</a><a href="#h89-0-14" id="h89-0-14" class="d">-                ),
</a><a href="#h89-0-15" id="h89-0-15" class="d">-            ),
</a><a href="#h89-0-16" id="h89-0-16" class="d">-            Literal(
</a><a href="#h89-0-17" id="h89-0-17" class="d">-                Integer(
</a><a href="#h89-0-18" id="h89-0-18" class="d">-                    1,
</a><a href="#h89-0-19" id="h89-0-19" class="d">-                ),
</a><a href="#h89-0-20" id="h89-0-20" class="d">-            ),
</a><a href="#h89-0-21" id="h89-0-21" class="d">-            Literal(
</a><a href="#h89-0-22" id="h89-0-22" class="d">-                Float(
</a><a href="#h89-0-23" id="h89-0-23" class="d">-                    3.14,
</a><a href="#h89-0-24" id="h89-0-24" class="d">-                ),
</a><a href="#h89-0-25" id="h89-0-25" class="d">-            ),
</a><a href="#h89-0-26" id="h89-0-26" class="d">-            Literal(
</a><a href="#h89-0-27" id="h89-0-27" class="d">-                String(
</a><a href="#h89-0-28" id="h89-0-28" class="d">-                    &quot;Hi! 👋&quot;,
</a><a href="#h89-0-29" id="h89-0-29" class="d">-                ),
</a><a href="#h89-0-30" id="h89-0-30" class="d">-            ),
</a><a href="#h89-0-31" id="h89-0-31" class="d">-        ],
</a><a href="#h89-0-32" id="h89-0-32" class="d">-        labels: [
</a><a href="#h89-0-33" id="h89-0-33" class="d">-            None,
</a><a href="#h89-0-34" id="h89-0-34" class="d">-            None,
</a><a href="#h89-0-35" id="h89-0-35" class="d">-            None,
</a><a href="#h89-0-36" id="h89-0-36" class="d">-            None,
</a><a href="#h89-0-37" id="h89-0-37" class="d">-            None,
</a><a href="#h89-0-38" id="h89-0-38" class="d">-            None,
</a><a href="#h89-0-39" id="h89-0-39" class="d">-        ],
</a><a href="#h89-0-40" id="h89-0-40" class="d">-    },
</a><a href="#h89-0-41" id="h89-0-41" class="d">-}
</a><a href="#h89-0-42" id="h89-0-42" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h90" href="../file/src/sql/testdata/select_alone_datatypes/plan.html">src/sql/testdata/select_alone_datatypes/plan</a> b/<a href="../file/src/sql/testdata/select_alone_datatypes/plan.html">src/sql/testdata/select_alone_datatypes/plan</a></b>
<a href="#h90-0" id="h90-0" class="h">@@ -1,53 +0,0 @@
</a><a href="#h90-0-0" id="h90-0-0" class="d">-Plan {
</a><a href="#h90-0-1" id="h90-0-1" class="d">-    columns: [
</a><a href="#h90-0-2" id="h90-0-2" class="d">-        &quot;?&quot;,
</a><a href="#h90-0-3" id="h90-0-3" class="d">-        &quot;?&quot;,
</a><a href="#h90-0-4" id="h90-0-4" class="d">-        &quot;?&quot;,
</a><a href="#h90-0-5" id="h90-0-5" class="d">-        &quot;?&quot;,
</a><a href="#h90-0-6" id="h90-0-6" class="d">-        &quot;?&quot;,
</a><a href="#h90-0-7" id="h90-0-7" class="d">-        &quot;?&quot;,
</a><a href="#h90-0-8" id="h90-0-8" class="d">-    ],
</a><a href="#h90-0-9" id="h90-0-9" class="d">-    root: Projection {
</a><a href="#h90-0-10" id="h90-0-10" class="d">-        labels: [
</a><a href="#h90-0-11" id="h90-0-11" class="d">-            &quot;?&quot;,
</a><a href="#h90-0-12" id="h90-0-12" class="d">-            &quot;?&quot;,
</a><a href="#h90-0-13" id="h90-0-13" class="d">-            &quot;?&quot;,
</a><a href="#h90-0-14" id="h90-0-14" class="d">-            &quot;?&quot;,
</a><a href="#h90-0-15" id="h90-0-15" class="d">-            &quot;?&quot;,
</a><a href="#h90-0-16" id="h90-0-16" class="d">-            &quot;?&quot;,
</a><a href="#h90-0-17" id="h90-0-17" class="d">-        ],
</a><a href="#h90-0-18" id="h90-0-18" class="d">-        source: Nothing {
</a><a href="#h90-0-19" id="h90-0-19" class="d">-            done: false,
</a><a href="#h90-0-20" id="h90-0-20" class="d">-        },
</a><a href="#h90-0-21" id="h90-0-21" class="d">-        expressions: [
</a><a href="#h90-0-22" id="h90-0-22" class="d">-            Constant(
</a><a href="#h90-0-23" id="h90-0-23" class="d">-                Null,
</a><a href="#h90-0-24" id="h90-0-24" class="d">-            ),
</a><a href="#h90-0-25" id="h90-0-25" class="d">-            Constant(
</a><a href="#h90-0-26" id="h90-0-26" class="d">-                Boolean(
</a><a href="#h90-0-27" id="h90-0-27" class="d">-                    true,
</a><a href="#h90-0-28" id="h90-0-28" class="d">-                ),
</a><a href="#h90-0-29" id="h90-0-29" class="d">-            ),
</a><a href="#h90-0-30" id="h90-0-30" class="d">-            Constant(
</a><a href="#h90-0-31" id="h90-0-31" class="d">-                Boolean(
</a><a href="#h90-0-32" id="h90-0-32" class="d">-                    false,
</a><a href="#h90-0-33" id="h90-0-33" class="d">-                ),
</a><a href="#h90-0-34" id="h90-0-34" class="d">-            ),
</a><a href="#h90-0-35" id="h90-0-35" class="d">-            Constant(
</a><a href="#h90-0-36" id="h90-0-36" class="d">-                Integer(
</a><a href="#h90-0-37" id="h90-0-37" class="d">-                    1,
</a><a href="#h90-0-38" id="h90-0-38" class="d">-                ),
</a><a href="#h90-0-39" id="h90-0-39" class="d">-            ),
</a><a href="#h90-0-40" id="h90-0-40" class="d">-            Constant(
</a><a href="#h90-0-41" id="h90-0-41" class="d">-                Float(
</a><a href="#h90-0-42" id="h90-0-42" class="d">-                    3.14,
</a><a href="#h90-0-43" id="h90-0-43" class="d">-                ),
</a><a href="#h90-0-44" id="h90-0-44" class="d">-            ),
</a><a href="#h90-0-45" id="h90-0-45" class="d">-            Constant(
</a><a href="#h90-0-46" id="h90-0-46" class="d">-                String(
</a><a href="#h90-0-47" id="h90-0-47" class="d">-                    &quot;Hi! 👋&quot;,
</a><a href="#h90-0-48" id="h90-0-48" class="d">-                ),
</a><a href="#h90-0-49" id="h90-0-49" class="d">-            ),
</a><a href="#h90-0-50" id="h90-0-50" class="d">-        ],
</a><a href="#h90-0-51" id="h90-0-51" class="d">-    },
</a><a href="#h90-0-52" id="h90-0-52" class="d">-}
</a><a href="#h90-0-53" id="h90-0-53" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h91" href="../file/src/sql/testdata/select_alone_datatypes/query.sql.html">src/sql/testdata/select_alone_datatypes/query.sql</a> b/<a href="../file/src/sql/testdata/select_alone_datatypes/query.sql.html">src/sql/testdata/select_alone_datatypes/query.sql</a></b>
<a href="#h91-0" id="h91-0" class="h">@@ -1 +0,0 @@
</a><a href="#h91-0-0" id="h91-0-0" class="d">-SELECT NULL, TRUE, FALSE, 1, 3.14, &#39;Hi! 👋&#39;
</a><a href="#h91-0-1" id="h91-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h92" href="../file/src/sql/testdata/select_alone_datatypes/tokens.html">src/sql/testdata/select_alone_datatypes/tokens</a> b/<a href="../file/src/sql/testdata/select_alone_datatypes/tokens.html">src/sql/testdata/select_alone_datatypes/tokens</a></b>
<a href="#h92-0" id="h92-0" class="h">@@ -1,28 +0,0 @@
</a><a href="#h92-0-0" id="h92-0-0" class="d">-[
</a><a href="#h92-0-1" id="h92-0-1" class="d">-    Keyword(
</a><a href="#h92-0-2" id="h92-0-2" class="d">-        Select,
</a><a href="#h92-0-3" id="h92-0-3" class="d">-    ),
</a><a href="#h92-0-4" id="h92-0-4" class="d">-    Keyword(
</a><a href="#h92-0-5" id="h92-0-5" class="d">-        Null,
</a><a href="#h92-0-6" id="h92-0-6" class="d">-    ),
</a><a href="#h92-0-7" id="h92-0-7" class="d">-    Comma,
</a><a href="#h92-0-8" id="h92-0-8" class="d">-    Keyword(
</a><a href="#h92-0-9" id="h92-0-9" class="d">-        True,
</a><a href="#h92-0-10" id="h92-0-10" class="d">-    ),
</a><a href="#h92-0-11" id="h92-0-11" class="d">-    Comma,
</a><a href="#h92-0-12" id="h92-0-12" class="d">-    Keyword(
</a><a href="#h92-0-13" id="h92-0-13" class="d">-        False,
</a><a href="#h92-0-14" id="h92-0-14" class="d">-    ),
</a><a href="#h92-0-15" id="h92-0-15" class="d">-    Comma,
</a><a href="#h92-0-16" id="h92-0-16" class="d">-    Number(
</a><a href="#h92-0-17" id="h92-0-17" class="d">-        &quot;1&quot;,
</a><a href="#h92-0-18" id="h92-0-18" class="d">-    ),
</a><a href="#h92-0-19" id="h92-0-19" class="d">-    Comma,
</a><a href="#h92-0-20" id="h92-0-20" class="d">-    Number(
</a><a href="#h92-0-21" id="h92-0-21" class="d">-        &quot;3.14&quot;,
</a><a href="#h92-0-22" id="h92-0-22" class="d">-    ),
</a><a href="#h92-0-23" id="h92-0-23" class="d">-    Comma,
</a><a href="#h92-0-24" id="h92-0-24" class="d">-    String(
</a><a href="#h92-0-25" id="h92-0-25" class="d">-        &quot;Hi! 👋&quot;,
</a><a href="#h92-0-26" id="h92-0-26" class="d">-    ),
</a><a href="#h92-0-27" id="h92-0-27" class="d">-]
</a><a href="#h92-0-28" id="h92-0-28" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h93" href="../file/src/sql/testdata/select_alone_literal_numbers/ast.html">src/sql/testdata/select_alone_literal_numbers/ast</a> b/<a href="../file/src/sql/testdata/select_alone_literal_numbers/ast.html">src/sql/testdata/select_alone_literal_numbers/ast</a></b>
<a href="#h93-0" id="h93-0" class="h">@@ -1,78 +0,0 @@
</a><a href="#h93-0-0" id="h93-0-0" class="d">-Select {
</a><a href="#h93-0-1" id="h93-0-1" class="d">-    select: SelectClause {
</a><a href="#h93-0-2" id="h93-0-2" class="d">-        expressions: [
</a><a href="#h93-0-3" id="h93-0-3" class="d">-            Literal(
</a><a href="#h93-0-4" id="h93-0-4" class="d">-                Integer(
</a><a href="#h93-0-5" id="h93-0-5" class="d">-                    0,
</a><a href="#h93-0-6" id="h93-0-6" class="d">-                ),
</a><a href="#h93-0-7" id="h93-0-7" class="d">-            ),
</a><a href="#h93-0-8" id="h93-0-8" class="d">-            Literal(
</a><a href="#h93-0-9" id="h93-0-9" class="d">-                Integer(
</a><a href="#h93-0-10" id="h93-0-10" class="d">-                    1,
</a><a href="#h93-0-11" id="h93-0-11" class="d">-                ),
</a><a href="#h93-0-12" id="h93-0-12" class="d">-            ),
</a><a href="#h93-0-13" id="h93-0-13" class="d">-            Operation(
</a><a href="#h93-0-14" id="h93-0-14" class="d">-                Negate(
</a><a href="#h93-0-15" id="h93-0-15" class="d">-                    Literal(
</a><a href="#h93-0-16" id="h93-0-16" class="d">-                        Integer(
</a><a href="#h93-0-17" id="h93-0-17" class="d">-                            2,
</a><a href="#h93-0-18" id="h93-0-18" class="d">-                        ),
</a><a href="#h93-0-19" id="h93-0-19" class="d">-                    ),
</a><a href="#h93-0-20" id="h93-0-20" class="d">-                ),
</a><a href="#h93-0-21" id="h93-0-21" class="d">-            ),
</a><a href="#h93-0-22" id="h93-0-22" class="d">-            Operation(
</a><a href="#h93-0-23" id="h93-0-23" class="d">-                Negate(
</a><a href="#h93-0-24" id="h93-0-24" class="d">-                    Operation(
</a><a href="#h93-0-25" id="h93-0-25" class="d">-                        Negate(
</a><a href="#h93-0-26" id="h93-0-26" class="d">-                            Literal(
</a><a href="#h93-0-27" id="h93-0-27" class="d">-                                Integer(
</a><a href="#h93-0-28" id="h93-0-28" class="d">-                                    3,
</a><a href="#h93-0-29" id="h93-0-29" class="d">-                                ),
</a><a href="#h93-0-30" id="h93-0-30" class="d">-                            ),
</a><a href="#h93-0-31" id="h93-0-31" class="d">-                        ),
</a><a href="#h93-0-32" id="h93-0-32" class="d">-                    ),
</a><a href="#h93-0-33" id="h93-0-33" class="d">-                ),
</a><a href="#h93-0-34" id="h93-0-34" class="d">-            ),
</a><a href="#h93-0-35" id="h93-0-35" class="d">-            Operation(
</a><a href="#h93-0-36" id="h93-0-36" class="d">-                Negate(
</a><a href="#h93-0-37" id="h93-0-37" class="d">-                    Literal(
</a><a href="#h93-0-38" id="h93-0-38" class="d">-                        Integer(
</a><a href="#h93-0-39" id="h93-0-39" class="d">-                            4,
</a><a href="#h93-0-40" id="h93-0-40" class="d">-                        ),
</a><a href="#h93-0-41" id="h93-0-41" class="d">-                    ),
</a><a href="#h93-0-42" id="h93-0-42" class="d">-                ),
</a><a href="#h93-0-43" id="h93-0-43" class="d">-            ),
</a><a href="#h93-0-44" id="h93-0-44" class="d">-            Literal(
</a><a href="#h93-0-45" id="h93-0-45" class="d">-                Float(
</a><a href="#h93-0-46" id="h93-0-46" class="d">-                    3.14,
</a><a href="#h93-0-47" id="h93-0-47" class="d">-                ),
</a><a href="#h93-0-48" id="h93-0-48" class="d">-            ),
</a><a href="#h93-0-49" id="h93-0-49" class="d">-            Literal(
</a><a href="#h93-0-50" id="h93-0-50" class="d">-                Integer(
</a><a href="#h93-0-51" id="h93-0-51" class="d">-                    293,
</a><a href="#h93-0-52" id="h93-0-52" class="d">-                ),
</a><a href="#h93-0-53" id="h93-0-53" class="d">-            ),
</a><a href="#h93-0-54" id="h93-0-54" class="d">-            Literal(
</a><a href="#h93-0-55" id="h93-0-55" class="d">-                Float(
</a><a href="#h93-0-56" id="h93-0-56" class="d">-                    3140.0,
</a><a href="#h93-0-57" id="h93-0-57" class="d">-                ),
</a><a href="#h93-0-58" id="h93-0-58" class="d">-            ),
</a><a href="#h93-0-59" id="h93-0-59" class="d">-            Literal(
</a><a href="#h93-0-60" id="h93-0-60" class="d">-                Float(
</a><a href="#h93-0-61" id="h93-0-61" class="d">-                    0.02718,
</a><a href="#h93-0-62" id="h93-0-62" class="d">-                ),
</a><a href="#h93-0-63" id="h93-0-63" class="d">-            ),
</a><a href="#h93-0-64" id="h93-0-64" class="d">-        ],
</a><a href="#h93-0-65" id="h93-0-65" class="d">-        labels: [
</a><a href="#h93-0-66" id="h93-0-66" class="d">-            None,
</a><a href="#h93-0-67" id="h93-0-67" class="d">-            None,
</a><a href="#h93-0-68" id="h93-0-68" class="d">-            None,
</a><a href="#h93-0-69" id="h93-0-69" class="d">-            None,
</a><a href="#h93-0-70" id="h93-0-70" class="d">-            None,
</a><a href="#h93-0-71" id="h93-0-71" class="d">-            None,
</a><a href="#h93-0-72" id="h93-0-72" class="d">-            None,
</a><a href="#h93-0-73" id="h93-0-73" class="d">-            None,
</a><a href="#h93-0-74" id="h93-0-74" class="d">-            None,
</a><a href="#h93-0-75" id="h93-0-75" class="d">-        ],
</a><a href="#h93-0-76" id="h93-0-76" class="d">-    },
</a><a href="#h93-0-77" id="h93-0-77" class="d">-}
</a><a href="#h93-0-78" id="h93-0-78" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h94" href="../file/src/sql/testdata/select_alone_literal_numbers/plan.html">src/sql/testdata/select_alone_literal_numbers/plan</a> b/<a href="../file/src/sql/testdata/select_alone_literal_numbers/plan.html">src/sql/testdata/select_alone_literal_numbers/plan</a></b>
<a href="#h94-0" id="h94-0" class="h">@@ -1,84 +0,0 @@
</a><a href="#h94-0-0" id="h94-0-0" class="d">-Plan {
</a><a href="#h94-0-1" id="h94-0-1" class="d">-    columns: [
</a><a href="#h94-0-2" id="h94-0-2" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-3" id="h94-0-3" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-4" id="h94-0-4" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-5" id="h94-0-5" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-6" id="h94-0-6" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-7" id="h94-0-7" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-8" id="h94-0-8" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-9" id="h94-0-9" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-10" id="h94-0-10" class="d">-        &quot;?&quot;,
</a><a href="#h94-0-11" id="h94-0-11" class="d">-    ],
</a><a href="#h94-0-12" id="h94-0-12" class="d">-    root: Projection {
</a><a href="#h94-0-13" id="h94-0-13" class="d">-        labels: [
</a><a href="#h94-0-14" id="h94-0-14" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-15" id="h94-0-15" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-16" id="h94-0-16" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-17" id="h94-0-17" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-18" id="h94-0-18" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-19" id="h94-0-19" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-20" id="h94-0-20" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-21" id="h94-0-21" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-22" id="h94-0-22" class="d">-            &quot;?&quot;,
</a><a href="#h94-0-23" id="h94-0-23" class="d">-        ],
</a><a href="#h94-0-24" id="h94-0-24" class="d">-        source: Nothing {
</a><a href="#h94-0-25" id="h94-0-25" class="d">-            done: false,
</a><a href="#h94-0-26" id="h94-0-26" class="d">-        },
</a><a href="#h94-0-27" id="h94-0-27" class="d">-        expressions: [
</a><a href="#h94-0-28" id="h94-0-28" class="d">-            Constant(
</a><a href="#h94-0-29" id="h94-0-29" class="d">-                Integer(
</a><a href="#h94-0-30" id="h94-0-30" class="d">-                    0,
</a><a href="#h94-0-31" id="h94-0-31" class="d">-                ),
</a><a href="#h94-0-32" id="h94-0-32" class="d">-            ),
</a><a href="#h94-0-33" id="h94-0-33" class="d">-            Constant(
</a><a href="#h94-0-34" id="h94-0-34" class="d">-                Integer(
</a><a href="#h94-0-35" id="h94-0-35" class="d">-                    1,
</a><a href="#h94-0-36" id="h94-0-36" class="d">-                ),
</a><a href="#h94-0-37" id="h94-0-37" class="d">-            ),
</a><a href="#h94-0-38" id="h94-0-38" class="d">-            Negate(
</a><a href="#h94-0-39" id="h94-0-39" class="d">-                Constant(
</a><a href="#h94-0-40" id="h94-0-40" class="d">-                    Integer(
</a><a href="#h94-0-41" id="h94-0-41" class="d">-                        2,
</a><a href="#h94-0-42" id="h94-0-42" class="d">-                    ),
</a><a href="#h94-0-43" id="h94-0-43" class="d">-                ),
</a><a href="#h94-0-44" id="h94-0-44" class="d">-            ),
</a><a href="#h94-0-45" id="h94-0-45" class="d">-            Negate(
</a><a href="#h94-0-46" id="h94-0-46" class="d">-                Negate(
</a><a href="#h94-0-47" id="h94-0-47" class="d">-                    Constant(
</a><a href="#h94-0-48" id="h94-0-48" class="d">-                        Integer(
</a><a href="#h94-0-49" id="h94-0-49" class="d">-                            3,
</a><a href="#h94-0-50" id="h94-0-50" class="d">-                        ),
</a><a href="#h94-0-51" id="h94-0-51" class="d">-                    ),
</a><a href="#h94-0-52" id="h94-0-52" class="d">-                ),
</a><a href="#h94-0-53" id="h94-0-53" class="d">-            ),
</a><a href="#h94-0-54" id="h94-0-54" class="d">-            Negate(
</a><a href="#h94-0-55" id="h94-0-55" class="d">-                Constant(
</a><a href="#h94-0-56" id="h94-0-56" class="d">-                    Integer(
</a><a href="#h94-0-57" id="h94-0-57" class="d">-                        4,
</a><a href="#h94-0-58" id="h94-0-58" class="d">-                    ),
</a><a href="#h94-0-59" id="h94-0-59" class="d">-                ),
</a><a href="#h94-0-60" id="h94-0-60" class="d">-            ),
</a><a href="#h94-0-61" id="h94-0-61" class="d">-            Constant(
</a><a href="#h94-0-62" id="h94-0-62" class="d">-                Float(
</a><a href="#h94-0-63" id="h94-0-63" class="d">-                    3.14,
</a><a href="#h94-0-64" id="h94-0-64" class="d">-                ),
</a><a href="#h94-0-65" id="h94-0-65" class="d">-            ),
</a><a href="#h94-0-66" id="h94-0-66" class="d">-            Constant(
</a><a href="#h94-0-67" id="h94-0-67" class="d">-                Integer(
</a><a href="#h94-0-68" id="h94-0-68" class="d">-                    293,
</a><a href="#h94-0-69" id="h94-0-69" class="d">-                ),
</a><a href="#h94-0-70" id="h94-0-70" class="d">-            ),
</a><a href="#h94-0-71" id="h94-0-71" class="d">-            Constant(
</a><a href="#h94-0-72" id="h94-0-72" class="d">-                Float(
</a><a href="#h94-0-73" id="h94-0-73" class="d">-                    3140.0,
</a><a href="#h94-0-74" id="h94-0-74" class="d">-                ),
</a><a href="#h94-0-75" id="h94-0-75" class="d">-            ),
</a><a href="#h94-0-76" id="h94-0-76" class="d">-            Constant(
</a><a href="#h94-0-77" id="h94-0-77" class="d">-                Float(
</a><a href="#h94-0-78" id="h94-0-78" class="d">-                    0.02718,
</a><a href="#h94-0-79" id="h94-0-79" class="d">-                ),
</a><a href="#h94-0-80" id="h94-0-80" class="d">-            ),
</a><a href="#h94-0-81" id="h94-0-81" class="d">-        ],
</a><a href="#h94-0-82" id="h94-0-82" class="d">-    },
</a><a href="#h94-0-83" id="h94-0-83" class="d">-}
</a><a href="#h94-0-84" id="h94-0-84" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h95" href="../file/src/sql/testdata/select_alone_literal_numbers/query.sql.html">src/sql/testdata/select_alone_literal_numbers/query.sql</a> b/<a href="../file/src/sql/testdata/select_alone_literal_numbers/query.sql.html">src/sql/testdata/select_alone_literal_numbers/query.sql</a></b>
<a href="#h95-0" id="h95-0" class="h">@@ -1 +0,0 @@
</a><a href="#h95-0-0" id="h95-0-0" class="d">-SELECT 0, 1, -2, --3, +-4, 3.14, 293, 3.14e3, 2.718E-2
</a><a href="#h95-0-1" id="h95-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h96" href="../file/src/sql/testdata/select_alone_literal_numbers/tokens.html">src/sql/testdata/select_alone_literal_numbers/tokens</a> b/<a href="../file/src/sql/testdata/select_alone_literal_numbers/tokens.html">src/sql/testdata/select_alone_literal_numbers/tokens</a></b>
<a href="#h96-0" id="h96-0" class="h">@@ -1,45 +0,0 @@
</a><a href="#h96-0-0" id="h96-0-0" class="d">-[
</a><a href="#h96-0-1" id="h96-0-1" class="d">-    Keyword(
</a><a href="#h96-0-2" id="h96-0-2" class="d">-        Select,
</a><a href="#h96-0-3" id="h96-0-3" class="d">-    ),
</a><a href="#h96-0-4" id="h96-0-4" class="d">-    Number(
</a><a href="#h96-0-5" id="h96-0-5" class="d">-        &quot;0&quot;,
</a><a href="#h96-0-6" id="h96-0-6" class="d">-    ),
</a><a href="#h96-0-7" id="h96-0-7" class="d">-    Comma,
</a><a href="#h96-0-8" id="h96-0-8" class="d">-    Number(
</a><a href="#h96-0-9" id="h96-0-9" class="d">-        &quot;1&quot;,
</a><a href="#h96-0-10" id="h96-0-10" class="d">-    ),
</a><a href="#h96-0-11" id="h96-0-11" class="d">-    Comma,
</a><a href="#h96-0-12" id="h96-0-12" class="d">-    Minus,
</a><a href="#h96-0-13" id="h96-0-13" class="d">-    Number(
</a><a href="#h96-0-14" id="h96-0-14" class="d">-        &quot;2&quot;,
</a><a href="#h96-0-15" id="h96-0-15" class="d">-    ),
</a><a href="#h96-0-16" id="h96-0-16" class="d">-    Comma,
</a><a href="#h96-0-17" id="h96-0-17" class="d">-    Minus,
</a><a href="#h96-0-18" id="h96-0-18" class="d">-    Minus,
</a><a href="#h96-0-19" id="h96-0-19" class="d">-    Number(
</a><a href="#h96-0-20" id="h96-0-20" class="d">-        &quot;3&quot;,
</a><a href="#h96-0-21" id="h96-0-21" class="d">-    ),
</a><a href="#h96-0-22" id="h96-0-22" class="d">-    Comma,
</a><a href="#h96-0-23" id="h96-0-23" class="d">-    Plus,
</a><a href="#h96-0-24" id="h96-0-24" class="d">-    Minus,
</a><a href="#h96-0-25" id="h96-0-25" class="d">-    Number(
</a><a href="#h96-0-26" id="h96-0-26" class="d">-        &quot;4&quot;,
</a><a href="#h96-0-27" id="h96-0-27" class="d">-    ),
</a><a href="#h96-0-28" id="h96-0-28" class="d">-    Comma,
</a><a href="#h96-0-29" id="h96-0-29" class="d">-    Number(
</a><a href="#h96-0-30" id="h96-0-30" class="d">-        &quot;3.14&quot;,
</a><a href="#h96-0-31" id="h96-0-31" class="d">-    ),
</a><a href="#h96-0-32" id="h96-0-32" class="d">-    Comma,
</a><a href="#h96-0-33" id="h96-0-33" class="d">-    Number(
</a><a href="#h96-0-34" id="h96-0-34" class="d">-        &quot;293&quot;,
</a><a href="#h96-0-35" id="h96-0-35" class="d">-    ),
</a><a href="#h96-0-36" id="h96-0-36" class="d">-    Comma,
</a><a href="#h96-0-37" id="h96-0-37" class="d">-    Number(
</a><a href="#h96-0-38" id="h96-0-38" class="d">-        &quot;3.14e3&quot;,
</a><a href="#h96-0-39" id="h96-0-39" class="d">-    ),
</a><a href="#h96-0-40" id="h96-0-40" class="d">-    Comma,
</a><a href="#h96-0-41" id="h96-0-41" class="d">-    Number(
</a><a href="#h96-0-42" id="h96-0-42" class="d">-        &quot;2.718E-2&quot;,
</a><a href="#h96-0-43" id="h96-0-43" class="d">-    ),
</a><a href="#h96-0-44" id="h96-0-44" class="d">-]
</a><a href="#h96-0-45" id="h96-0-45" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h97" href="../file/src/sql/testdata/select_alone_literal_string_quotes/ast.html">src/sql/testdata/select_alone_literal_string_quotes/ast</a> b/<a href="../file/src/sql/testdata/select_alone_literal_string_quotes/ast.html">src/sql/testdata/select_alone_literal_string_quotes/ast</a></b>
<a href="#h97-0" id="h97-0" class="h">@@ -1,14 +0,0 @@
</a><a href="#h97-0-0" id="h97-0-0" class="d">-Select {
</a><a href="#h97-0-1" id="h97-0-1" class="d">-    select: SelectClause {
</a><a href="#h97-0-2" id="h97-0-2" class="d">-        expressions: [
</a><a href="#h97-0-3" id="h97-0-3" class="d">-            Literal(
</a><a href="#h97-0-4" id="h97-0-4" class="d">-                String(
</a><a href="#h97-0-5" id="h97-0-5" class="d">-                    &quot;Literal with \&#39;single\&#39; and \&quot;double\&quot; quotes&quot;,
</a><a href="#h97-0-6" id="h97-0-6" class="d">-                ),
</a><a href="#h97-0-7" id="h97-0-7" class="d">-            ),
</a><a href="#h97-0-8" id="h97-0-8" class="d">-        ],
</a><a href="#h97-0-9" id="h97-0-9" class="d">-        labels: [
</a><a href="#h97-0-10" id="h97-0-10" class="d">-            None,
</a><a href="#h97-0-11" id="h97-0-11" class="d">-        ],
</a><a href="#h97-0-12" id="h97-0-12" class="d">-    },
</a><a href="#h97-0-13" id="h97-0-13" class="d">-}
</a><a href="#h97-0-14" id="h97-0-14" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h98" href="../file/src/sql/testdata/select_alone_literal_string_quotes/plan.html">src/sql/testdata/select_alone_literal_string_quotes/plan</a> b/<a href="../file/src/sql/testdata/select_alone_literal_string_quotes/plan.html">src/sql/testdata/select_alone_literal_string_quotes/plan</a></b>
<a href="#h98-0" id="h98-0" class="h">@@ -1,20 +0,0 @@
</a><a href="#h98-0-0" id="h98-0-0" class="d">-Plan {
</a><a href="#h98-0-1" id="h98-0-1" class="d">-    columns: [
</a><a href="#h98-0-2" id="h98-0-2" class="d">-        &quot;?&quot;,
</a><a href="#h98-0-3" id="h98-0-3" class="d">-    ],
</a><a href="#h98-0-4" id="h98-0-4" class="d">-    root: Projection {
</a><a href="#h98-0-5" id="h98-0-5" class="d">-        labels: [
</a><a href="#h98-0-6" id="h98-0-6" class="d">-            &quot;?&quot;,
</a><a href="#h98-0-7" id="h98-0-7" class="d">-        ],
</a><a href="#h98-0-8" id="h98-0-8" class="d">-        source: Nothing {
</a><a href="#h98-0-9" id="h98-0-9" class="d">-            done: false,
</a><a href="#h98-0-10" id="h98-0-10" class="d">-        },
</a><a href="#h98-0-11" id="h98-0-11" class="d">-        expressions: [
</a><a href="#h98-0-12" id="h98-0-12" class="d">-            Constant(
</a><a href="#h98-0-13" id="h98-0-13" class="d">-                String(
</a><a href="#h98-0-14" id="h98-0-14" class="d">-                    &quot;Literal with \&#39;single\&#39; and \&quot;double\&quot; quotes&quot;,
</a><a href="#h98-0-15" id="h98-0-15" class="d">-                ),
</a><a href="#h98-0-16" id="h98-0-16" class="d">-            ),
</a><a href="#h98-0-17" id="h98-0-17" class="d">-        ],
</a><a href="#h98-0-18" id="h98-0-18" class="d">-    },
</a><a href="#h98-0-19" id="h98-0-19" class="d">-}
</a><a href="#h98-0-20" id="h98-0-20" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h99" href="../file/src/sql/testdata/select_alone_literal_string_quotes/query.sql.html">src/sql/testdata/select_alone_literal_string_quotes/query.sql</a> b/<a href="../file/src/sql/testdata/select_alone_literal_string_quotes/query.sql.html">src/sql/testdata/select_alone_literal_string_quotes/query.sql</a></b>
<a href="#h99-0" id="h99-0" class="h">@@ -1 +0,0 @@
</a><a href="#h99-0-0" id="h99-0-0" class="d">-SELECT &#39;Literal with &#39;&#39;single&#39;&#39; and &quot;double&quot; quotes&#39;
</a><a href="#h99-0-1" id="h99-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h100" href="../file/src/sql/testdata/select_alone_literal_string_quotes/tokens.html">src/sql/testdata/select_alone_literal_string_quotes/tokens</a> b/<a href="../file/src/sql/testdata/select_alone_literal_string_quotes/tokens.html">src/sql/testdata/select_alone_literal_string_quotes/tokens</a></b>
<a href="#h100-0" id="h100-0" class="h">@@ -1,8 +0,0 @@
</a><a href="#h100-0-0" id="h100-0-0" class="d">-[
</a><a href="#h100-0-1" id="h100-0-1" class="d">-    Keyword(
</a><a href="#h100-0-2" id="h100-0-2" class="d">-        Select,
</a><a href="#h100-0-3" id="h100-0-3" class="d">-    ),
</a><a href="#h100-0-4" id="h100-0-4" class="d">-    String(
</a><a href="#h100-0-5" id="h100-0-5" class="d">-        &quot;Literal with \&#39;single\&#39; and \&quot;double\&quot; quotes&quot;,
</a><a href="#h100-0-6" id="h100-0-6" class="d">-    ),
</a><a href="#h100-0-7" id="h100-0-7" class="d">-]
</a><a href="#h100-0-8" id="h100-0-8" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h101" href="../file/src/sql/testdata/select_error_bare.html">src/sql/testdata/select_error_bare</a> b/<a href="../file/src/sql/testdata/select_error_bare.html">src/sql/testdata/select_error_bare</a></b>
<a href="#h101-0" id="h101-0" class="h">@@ -0,0 +1,6 @@
</a><a href="#h101-0-0" id="h101-0-0" class="i">+Query: SELECT
</a><a href="#h101-0-1" id="h101-0-1" class="i">+
</a><a href="#h101-0-2" id="h101-0-2" class="i">+Tokens:
</a><a href="#h101-0-3" id="h101-0-3" class="i">+  Keyword(Select)
</a><a href="#h101-0-4" id="h101-0-4" class="i">+
</a><a href="#h101-0-5" id="h101-0-5" class="i">+AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h101-0-6" id="h101-0-6" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h102" href="../file/src/sql/testdata/select_error_bare/ast.html">src/sql/testdata/select_error_bare/ast</a> b/<a href="../file/src/sql/testdata/select_error_bare/ast.html">src/sql/testdata/select_error_bare/ast</a></b>
<a href="#h102-0" id="h102-0" class="h">@@ -1 +0,0 @@
</a><a href="#h102-0-0" id="h102-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h102-0-1" id="h102-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h103" href="../file/src/sql/testdata/select_error_bare/plan.html">src/sql/testdata/select_error_bare/plan</a> b/<a href="../file/src/sql/testdata/select_error_bare/plan.html">src/sql/testdata/select_error_bare/plan</a></b>
<a href="#h103-0" id="h103-0" class="h">@@ -1 +0,0 @@
</a><a href="#h103-0-0" id="h103-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h103-0-1" id="h103-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h104" href="../file/src/sql/testdata/select_error_bare/query.sql.html">src/sql/testdata/select_error_bare/query.sql</a> b/<a href="../file/src/sql/testdata/select_error_bare/query.sql.html">src/sql/testdata/select_error_bare/query.sql</a></b>
<a href="#h104-0" id="h104-0" class="h">@@ -1 +0,0 @@
</a><a href="#h104-0-0" id="h104-0-0" class="d">-SELECT
</a><a href="#h104-0-1" id="h104-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h105" href="../file/src/sql/testdata/select_error_bare/tokens.html">src/sql/testdata/select_error_bare/tokens</a> b/<a href="../file/src/sql/testdata/select_error_bare/tokens.html">src/sql/testdata/select_error_bare/tokens</a></b>
<a href="#h105-0" id="h105-0" class="h">@@ -1,5 +0,0 @@
</a><a href="#h105-0-0" id="h105-0-0" class="d">-[
</a><a href="#h105-0-1" id="h105-0-1" class="d">-    Keyword(
</a><a href="#h105-0-2" id="h105-0-2" class="d">-        Select,
</a><a href="#h105-0-3" id="h105-0-3" class="d">-    ),
</a><a href="#h105-0-4" id="h105-0-4" class="d">-]
</a><a href="#h105-0-5" id="h105-0-5" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h106" href="../file/src/sql/testdata/select_error_bare_as.html">src/sql/testdata/select_error_bare_as</a> b/<a href="../file/src/sql/testdata/select_error_bare_as.html">src/sql/testdata/select_error_bare_as</a></b>
<a href="#h106-0" id="h106-0" class="h">@@ -0,0 +1,10 @@
</a><a href="#h106-0-0" id="h106-0-0" class="i">+Query: SELECT 1 AS, 2
</a><a href="#h106-0-1" id="h106-0-1" class="i">+
</a><a href="#h106-0-2" id="h106-0-2" class="i">+Tokens:
</a><a href="#h106-0-3" id="h106-0-3" class="i">+  Keyword(Select)
</a><a href="#h106-0-4" id="h106-0-4" class="i">+  Number(&quot;1&quot;)
</a><a href="#h106-0-5" id="h106-0-5" class="i">+  Keyword(As)
</a><a href="#h106-0-6" id="h106-0-6" class="i">+  Comma
</a><a href="#h106-0-7" id="h106-0-7" class="i">+  Number(&quot;2&quot;)
</a><a href="#h106-0-8" id="h106-0-8" class="i">+
</a><a href="#h106-0-9" id="h106-0-9" class="i">+AST: Parse(&quot;Expected identifier, got ,&quot;)
</a><a href="#h106-0-10" id="h106-0-10" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h107" href="../file/src/sql/testdata/select_error_bare_as/ast.html">src/sql/testdata/select_error_bare_as/ast</a> b/<a href="../file/src/sql/testdata/select_error_bare_as/ast.html">src/sql/testdata/select_error_bare_as/ast</a></b>
<a href="#h107-0" id="h107-0" class="h">@@ -1 +0,0 @@
</a><a href="#h107-0-0" id="h107-0-0" class="d">-Err(Parse(&quot;Expected identifier, got ,&quot;))
</a><a href="#h107-0-1" id="h107-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h108" href="../file/src/sql/testdata/select_error_bare_as/plan.html">src/sql/testdata/select_error_bare_as/plan</a> b/<a href="../file/src/sql/testdata/select_error_bare_as/plan.html">src/sql/testdata/select_error_bare_as/plan</a></b>
<a href="#h108-0" id="h108-0" class="h">@@ -1 +0,0 @@
</a><a href="#h108-0-0" id="h108-0-0" class="d">-Err(Parse(&quot;Expected identifier, got ,&quot;))
</a><a href="#h108-0-1" id="h108-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h109" href="../file/src/sql/testdata/select_error_bare_as/query.sql.html">src/sql/testdata/select_error_bare_as/query.sql</a> b/<a href="../file/src/sql/testdata/select_error_bare_as/query.sql.html">src/sql/testdata/select_error_bare_as/query.sql</a></b>
<a href="#h109-0" id="h109-0" class="h">@@ -1 +0,0 @@
</a><a href="#h109-0-0" id="h109-0-0" class="d">-SELECT 1 AS, 2
</a><a href="#h109-0-1" id="h109-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h110" href="../file/src/sql/testdata/select_error_bare_as/tokens.html">src/sql/testdata/select_error_bare_as/tokens</a> b/<a href="../file/src/sql/testdata/select_error_bare_as/tokens.html">src/sql/testdata/select_error_bare_as/tokens</a></b>
<a href="#h110-0" id="h110-0" class="h">@@ -1,15 +0,0 @@
</a><a href="#h110-0-0" id="h110-0-0" class="d">-[
</a><a href="#h110-0-1" id="h110-0-1" class="d">-    Keyword(
</a><a href="#h110-0-2" id="h110-0-2" class="d">-        Select,
</a><a href="#h110-0-3" id="h110-0-3" class="d">-    ),
</a><a href="#h110-0-4" id="h110-0-4" class="d">-    Number(
</a><a href="#h110-0-5" id="h110-0-5" class="d">-        &quot;1&quot;,
</a><a href="#h110-0-6" id="h110-0-6" class="d">-    ),
</a><a href="#h110-0-7" id="h110-0-7" class="d">-    Keyword(
</a><a href="#h110-0-8" id="h110-0-8" class="d">-        As,
</a><a href="#h110-0-9" id="h110-0-9" class="d">-    ),
</a><a href="#h110-0-10" id="h110-0-10" class="d">-    Comma,
</a><a href="#h110-0-11" id="h110-0-11" class="d">-    Number(
</a><a href="#h110-0-12" id="h110-0-12" class="d">-        &quot;2&quot;,
</a><a href="#h110-0-13" id="h110-0-13" class="d">-    ),
</a><a href="#h110-0-14" id="h110-0-14" class="d">-]
</a><a href="#h110-0-15" id="h110-0-15" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h111" href="../file/src/sql/testdata/select_error_bare_from.html">src/sql/testdata/select_error_bare_from</a> b/<a href="../file/src/sql/testdata/select_error_bare_from.html">src/sql/testdata/select_error_bare_from</a></b>
<a href="#h111-0" id="h111-0" class="h">@@ -0,0 +1,8 @@
</a><a href="#h111-0-0" id="h111-0-0" class="i">+Query: SELECT 1 FROM
</a><a href="#h111-0-1" id="h111-0-1" class="i">+
</a><a href="#h111-0-2" id="h111-0-2" class="i">+Tokens:
</a><a href="#h111-0-3" id="h111-0-3" class="i">+  Keyword(Select)
</a><a href="#h111-0-4" id="h111-0-4" class="i">+  Number(&quot;1&quot;)
</a><a href="#h111-0-5" id="h111-0-5" class="i">+  Keyword(From)
</a><a href="#h111-0-6" id="h111-0-6" class="i">+
</a><a href="#h111-0-7" id="h111-0-7" class="i">+AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h111-0-8" id="h111-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h112" href="../file/src/sql/testdata/select_error_from_bare/ast.html">src/sql/testdata/select_error_from_bare/ast</a> b/<a href="../file/src/sql/testdata/select_error_from_bare/ast.html">src/sql/testdata/select_error_from_bare/ast</a></b>
<a href="#h112-0" id="h112-0" class="h">@@ -1 +0,0 @@
</a><a href="#h112-0-0" id="h112-0-0" class="d">-Err(Parse(&quot;Unexpected token FROM&quot;))
</a><a href="#h112-0-1" id="h112-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h113" href="../file/src/sql/testdata/select_error_from_bare/plan.html">src/sql/testdata/select_error_from_bare/plan</a> b/<a href="../file/src/sql/testdata/select_error_from_bare/plan.html">src/sql/testdata/select_error_from_bare/plan</a></b>
<a href="#h113-0" id="h113-0" class="h">@@ -1 +0,0 @@
</a><a href="#h113-0-0" id="h113-0-0" class="d">-Err(Parse(&quot;Unexpected token FROM&quot;))
</a><a href="#h113-0-1" id="h113-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h114" href="../file/src/sql/testdata/select_error_from_bare/query.sql.html">src/sql/testdata/select_error_from_bare/query.sql</a> b/<a href="../file/src/sql/testdata/select_error_from_bare/query.sql.html">src/sql/testdata/select_error_from_bare/query.sql</a></b>
<a href="#h114-0" id="h114-0" class="h">@@ -1 +0,0 @@
</a><a href="#h114-0-0" id="h114-0-0" class="d">-SELECT 1 FROM
</a><a href="#h114-0-1" id="h114-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h115" href="../file/src/sql/testdata/select_error_from_bare/tokens.html">src/sql/testdata/select_error_from_bare/tokens</a> b/<a href="../file/src/sql/testdata/select_error_from_bare/tokens.html">src/sql/testdata/select_error_from_bare/tokens</a></b>
<a href="#h115-0" id="h115-0" class="h">@@ -1,11 +0,0 @@
</a><a href="#h115-0-0" id="h115-0-0" class="d">-[
</a><a href="#h115-0-1" id="h115-0-1" class="d">-    Keyword(
</a><a href="#h115-0-2" id="h115-0-2" class="d">-        Select,
</a><a href="#h115-0-3" id="h115-0-3" class="d">-    ),
</a><a href="#h115-0-4" id="h115-0-4" class="d">-    Number(
</a><a href="#h115-0-5" id="h115-0-5" class="d">-        &quot;1&quot;,
</a><a href="#h115-0-6" id="h115-0-6" class="d">-    ),
</a><a href="#h115-0-7" id="h115-0-7" class="d">-    Keyword(
</a><a href="#h115-0-8" id="h115-0-8" class="d">-        From,
</a><a href="#h115-0-9" id="h115-0-9" class="d">-    ),
</a><a href="#h115-0-10" id="h115-0-10" class="d">-]
</a><a href="#h115-0-11" id="h115-0-11" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h116" href="../file/src/sql/testdata/select_error_trailing_comma.html">src/sql/testdata/select_error_trailing_comma</a> b/<a href="../file/src/sql/testdata/select_error_trailing_comma.html">src/sql/testdata/select_error_trailing_comma</a></b>
<a href="#h116-0" id="h116-0" class="h">@@ -0,0 +1,10 @@
</a><a href="#h116-0-0" id="h116-0-0" class="i">+Query: SELECT 1, 2,
</a><a href="#h116-0-1" id="h116-0-1" class="i">+
</a><a href="#h116-0-2" id="h116-0-2" class="i">+Tokens:
</a><a href="#h116-0-3" id="h116-0-3" class="i">+  Keyword(Select)
</a><a href="#h116-0-4" id="h116-0-4" class="i">+  Number(&quot;1&quot;)
</a><a href="#h116-0-5" id="h116-0-5" class="i">+  Comma
</a><a href="#h116-0-6" id="h116-0-6" class="i">+  Number(&quot;2&quot;)
</a><a href="#h116-0-7" id="h116-0-7" class="i">+  Comma
</a><a href="#h116-0-8" id="h116-0-8" class="i">+
</a><a href="#h116-0-9" id="h116-0-9" class="i">+AST: Parse(&quot;Unexpected end of input&quot;)
</a><a href="#h116-0-10" id="h116-0-10" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h117" href="../file/src/sql/testdata/select_error_trailing_comma/ast.html">src/sql/testdata/select_error_trailing_comma/ast</a> b/<a href="../file/src/sql/testdata/select_error_trailing_comma/ast.html">src/sql/testdata/select_error_trailing_comma/ast</a></b>
<a href="#h117-0" id="h117-0" class="h">@@ -1 +0,0 @@
</a><a href="#h117-0-0" id="h117-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h117-0-1" id="h117-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h118" href="../file/src/sql/testdata/select_error_trailing_comma/plan.html">src/sql/testdata/select_error_trailing_comma/plan</a> b/<a href="../file/src/sql/testdata/select_error_trailing_comma/plan.html">src/sql/testdata/select_error_trailing_comma/plan</a></b>
<a href="#h118-0" id="h118-0" class="h">@@ -1 +0,0 @@
</a><a href="#h118-0-0" id="h118-0-0" class="d">-Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h118-0-1" id="h118-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h119" href="../file/src/sql/testdata/select_error_trailing_comma/query.sql.html">src/sql/testdata/select_error_trailing_comma/query.sql</a> b/<a href="../file/src/sql/testdata/select_error_trailing_comma/query.sql.html">src/sql/testdata/select_error_trailing_comma/query.sql</a></b>
<a href="#h119-0" id="h119-0" class="h">@@ -1 +0,0 @@
</a><a href="#h119-0-0" id="h119-0-0" class="d">-SELECT 1, 2,
</a><a href="#h119-0-1" id="h119-0-1" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h120" href="../file/src/sql/testdata/select_error_trailing_comma/tokens.html">src/sql/testdata/select_error_trailing_comma/tokens</a> b/<a href="../file/src/sql/testdata/select_error_trailing_comma/tokens.html">src/sql/testdata/select_error_trailing_comma/tokens</a></b>
<a href="#h120-0" id="h120-0" class="h">@@ -1,13 +0,0 @@
</a><a href="#h120-0-0" id="h120-0-0" class="d">-[
</a><a href="#h120-0-1" id="h120-0-1" class="d">-    Keyword(
</a><a href="#h120-0-2" id="h120-0-2" class="d">-        Select,
</a><a href="#h120-0-3" id="h120-0-3" class="d">-    ),
</a><a href="#h120-0-4" id="h120-0-4" class="d">-    Number(
</a><a href="#h120-0-5" id="h120-0-5" class="d">-        &quot;1&quot;,
</a><a href="#h120-0-6" id="h120-0-6" class="d">-    ),
</a><a href="#h120-0-7" id="h120-0-7" class="d">-    Comma,
</a><a href="#h120-0-8" id="h120-0-8" class="d">-    Number(
</a><a href="#h120-0-9" id="h120-0-9" class="d">-        &quot;2&quot;,
</a><a href="#h120-0-10" id="h120-0-10" class="d">-    ),
</a><a href="#h120-0-11" id="h120-0-11" class="d">-    Comma,
</a><a href="#h120-0-12" id="h120-0-12" class="d">-]
</a><a href="#h120-0-13" id="h120-0-13" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h121" href="../file/src/sql/tests.rs.html">src/sql/tests.rs</a> b/<a href="../file/src/sql/tests.rs.html">src/sql/tests.rs</a></b>
<a href="#h121-0" id="h121-0" class="h">@@ -1,40 +1,164 @@
</a> use super::lexer::{Lexer, Token};
<a href="#h121-0-1" id="h121-0-1" class="d">-use super::{Parser, Planner, Storage};
</a><a href="#h121-0-2" id="h121-0-2" class="i">+use super::schema;
</a><a href="#h121-0-3" id="h121-0-3" class="i">+use super::types::{DataType, Row, Value};
</a><a href="#h121-0-4" id="h121-0-4" class="i">+use super::{Context, Parser, Plan, Storage};
</a> use crate::kv;
 use crate::Error;
 use goldenfile::Mint;
 use std::io::Write;
 
<a href="#h121-0-10" id="h121-0-10" class="i">+// test_sql! tests
</a> macro_rules! test_sql {
     ( $( $name:ident: $sql:expr, )* ) =&gt; {
     $(
         #[test]
         fn $name() {
<a href="#h121-0-16" id="h121-0-16" class="d">-            let storage = Storage::new(kv::Memory::new());
</a><a href="#h121-0-17" id="h121-0-17" class="d">-            let mut mint = Mint::new(format!(&quot;src/sql/testdata/{}&quot;, stringify!($name)));
</a><a href="#h121-0-18" id="h121-0-18" class="d">-            write!(mint.new_goldenfile(&quot;query.sql&quot;).unwrap(), &quot;{}&quot;, $sql).unwrap();
</a><a href="#h121-0-19" id="h121-0-19" class="i">+            let mut storage = Storage::new(kv::Memory::new());
</a><a href="#h121-0-20" id="h121-0-20" class="i">+            storage.create_table(&amp;schema::Table{
</a><a href="#h121-0-21" id="h121-0-21" class="i">+                name: &quot;genres&quot;.into(),
</a><a href="#h121-0-22" id="h121-0-22" class="i">+                columns: vec![
</a><a href="#h121-0-23" id="h121-0-23" class="i">+                    schema::Column{
</a><a href="#h121-0-24" id="h121-0-24" class="i">+                        name: &quot;id&quot;.into(),
</a><a href="#h121-0-25" id="h121-0-25" class="i">+                        datatype: DataType::Integer,
</a><a href="#h121-0-26" id="h121-0-26" class="i">+                        nullable: false,
</a><a href="#h121-0-27" id="h121-0-27" class="i">+                    },
</a><a href="#h121-0-28" id="h121-0-28" class="i">+                    schema::Column{
</a><a href="#h121-0-29" id="h121-0-29" class="i">+                        name: &quot;name&quot;.into(),
</a><a href="#h121-0-30" id="h121-0-30" class="i">+                        datatype: DataType::String,
</a><a href="#h121-0-31" id="h121-0-31" class="i">+                        nullable: false,
</a><a href="#h121-0-32" id="h121-0-32" class="i">+                    },
</a><a href="#h121-0-33" id="h121-0-33" class="i">+                ],
</a><a href="#h121-0-34" id="h121-0-34" class="i">+                primary_key: &quot;id&quot;.into(),
</a><a href="#h121-0-35" id="h121-0-35" class="i">+            }).unwrap();
</a><a href="#h121-0-36" id="h121-0-36" class="i">+            storage.create_table(&amp;schema::Table{
</a><a href="#h121-0-37" id="h121-0-37" class="i">+                name: &quot;movies&quot;.into(),
</a><a href="#h121-0-38" id="h121-0-38" class="i">+                columns: vec![
</a><a href="#h121-0-39" id="h121-0-39" class="i">+                    schema::Column{
</a><a href="#h121-0-40" id="h121-0-40" class="i">+                        name: &quot;id&quot;.into(),
</a><a href="#h121-0-41" id="h121-0-41" class="i">+                        datatype: DataType::Integer,
</a><a href="#h121-0-42" id="h121-0-42" class="i">+                        nullable: false,
</a><a href="#h121-0-43" id="h121-0-43" class="i">+                    },
</a><a href="#h121-0-44" id="h121-0-44" class="i">+                    schema::Column{
</a><a href="#h121-0-45" id="h121-0-45" class="i">+                        name: &quot;title&quot;.into(),
</a><a href="#h121-0-46" id="h121-0-46" class="i">+                        datatype: DataType::String,
</a><a href="#h121-0-47" id="h121-0-47" class="i">+                        nullable: false,
</a><a href="#h121-0-48" id="h121-0-48" class="i">+                    },
</a><a href="#h121-0-49" id="h121-0-49" class="i">+                    schema::Column{
</a><a href="#h121-0-50" id="h121-0-50" class="i">+                        name: &quot;genre_id&quot;.into(),
</a><a href="#h121-0-51" id="h121-0-51" class="i">+                        datatype: DataType::Integer,
</a><a href="#h121-0-52" id="h121-0-52" class="i">+                        nullable: false,
</a><a href="#h121-0-53" id="h121-0-53" class="i">+                    },
</a><a href="#h121-0-54" id="h121-0-54" class="i">+                    schema::Column{
</a><a href="#h121-0-55" id="h121-0-55" class="i">+                        name: &quot;released&quot;.into(),
</a><a href="#h121-0-56" id="h121-0-56" class="i">+                        datatype: DataType::Integer,
</a><a href="#h121-0-57" id="h121-0-57" class="i">+                        nullable: false,
</a><a href="#h121-0-58" id="h121-0-58" class="i">+                    },
</a><a href="#h121-0-59" id="h121-0-59" class="i">+                    schema::Column{
</a><a href="#h121-0-60" id="h121-0-60" class="i">+                        name: &quot;rating&quot;.into(),
</a><a href="#h121-0-61" id="h121-0-61" class="i">+                        datatype: DataType::Float,
</a><a href="#h121-0-62" id="h121-0-62" class="i">+                        nullable: true,
</a><a href="#h121-0-63" id="h121-0-63" class="i">+                    },
</a><a href="#h121-0-64" id="h121-0-64" class="i">+                    schema::Column{
</a><a href="#h121-0-65" id="h121-0-65" class="i">+                        name: &quot;bluray&quot;.into(),
</a><a href="#h121-0-66" id="h121-0-66" class="i">+                        datatype: DataType::Boolean,
</a><a href="#h121-0-67" id="h121-0-67" class="i">+                        nullable: true,
</a><a href="#h121-0-68" id="h121-0-68" class="i">+                    },
</a><a href="#h121-0-69" id="h121-0-69" class="i">+                ],
</a><a href="#h121-0-70" id="h121-0-70" class="i">+                primary_key: &quot;id&quot;.into(),
</a><a href="#h121-0-71" id="h121-0-71" class="i">+            }).unwrap();
</a><a href="#h121-0-72" id="h121-0-72" class="i">+            storage.create_row(&quot;genres&quot;, vec![
</a><a href="#h121-0-73" id="h121-0-73" class="i">+                Value::Integer(1),
</a><a href="#h121-0-74" id="h121-0-74" class="i">+                Value::String(&quot;Science Fiction&quot;.into()),
</a><a href="#h121-0-75" id="h121-0-75" class="i">+            ]).unwrap();
</a><a href="#h121-0-76" id="h121-0-76" class="i">+            storage.create_row(&quot;genres&quot;, vec![
</a><a href="#h121-0-77" id="h121-0-77" class="i">+                Value::Integer(2),
</a><a href="#h121-0-78" id="h121-0-78" class="i">+                Value::String(&quot;Action&quot;.into()),
</a><a href="#h121-0-79" id="h121-0-79" class="i">+            ]).unwrap();
</a><a href="#h121-0-80" id="h121-0-80" class="i">+            storage.create_row(&quot;movies&quot;, vec![
</a><a href="#h121-0-81" id="h121-0-81" class="i">+                Value::Integer(1),
</a><a href="#h121-0-82" id="h121-0-82" class="i">+                Value::String(&quot;Stalker&quot;.into()),
</a><a href="#h121-0-83" id="h121-0-83" class="i">+                Value::Integer(1),
</a><a href="#h121-0-84" id="h121-0-84" class="i">+                Value::Integer(1979),
</a><a href="#h121-0-85" id="h121-0-85" class="i">+                Value::Float(8.2),
</a><a href="#h121-0-86" id="h121-0-86" class="i">+                Value::Boolean(false),
</a><a href="#h121-0-87" id="h121-0-87" class="i">+            ]).unwrap();
</a><a href="#h121-0-88" id="h121-0-88" class="i">+            storage.create_row(&quot;movies&quot;, vec![
</a><a href="#h121-0-89" id="h121-0-89" class="i">+                Value::Integer(2),
</a><a href="#h121-0-90" id="h121-0-90" class="i">+                Value::String(&quot;Sicario&quot;.into()),
</a><a href="#h121-0-91" id="h121-0-91" class="i">+                Value::Integer(2),
</a><a href="#h121-0-92" id="h121-0-92" class="i">+                Value::Integer(2015),
</a><a href="#h121-0-93" id="h121-0-93" class="i">+                Value::Float(7.6),
</a><a href="#h121-0-94" id="h121-0-94" class="i">+                Value::Boolean(true),
</a><a href="#h121-0-95" id="h121-0-95" class="i">+            ]).unwrap();
</a><a href="#h121-0-96" id="h121-0-96" class="i">+            storage.create_row(&quot;movies&quot;, vec![
</a><a href="#h121-0-97" id="h121-0-97" class="i">+                Value::Integer(3),
</a><a href="#h121-0-98" id="h121-0-98" class="i">+                Value::String(&quot;Primer&quot;.into()),
</a><a href="#h121-0-99" id="h121-0-99" class="i">+                Value::Integer(1),
</a><a href="#h121-0-100" id="h121-0-100" class="i">+                Value::Integer(2004),
</a><a href="#h121-0-101" id="h121-0-101" class="i">+                Value::Float(6.9),
</a><a href="#h121-0-102" id="h121-0-102" class="i">+                Value::Null,
</a><a href="#h121-0-103" id="h121-0-103" class="i">+            ]).unwrap();
</a> 
<a href="#h121-0-105" id="h121-0-105" class="d">-            let mut f = mint.new_goldenfile(&quot;tokens&quot;).unwrap();
</a><a href="#h121-0-106" id="h121-0-106" class="d">-            match Lexer::new($sql).collect::&lt;Result&lt;Vec&lt;Token&gt;, Error&gt;&gt;() {
</a><a href="#h121-0-107" id="h121-0-107" class="d">-                Ok(tokens) =&gt; write!(f, &quot;{:#?}&quot;, tokens).unwrap(),
</a><a href="#h121-0-108" id="h121-0-108" class="d">-                err =&gt; write!(f, &quot;{:?}&quot;, err).unwrap(),
</a><a href="#h121-0-109" id="h121-0-109" class="d">-            };
</a><a href="#h121-0-110" id="h121-0-110" class="i">+            let mut mint = Mint::new(&quot;src/sql/testdata&quot;);
</a><a href="#h121-0-111" id="h121-0-111" class="i">+            let mut f = mint.new_goldenfile(format!(&quot;{}&quot;, stringify!($name))).unwrap();
</a><a href="#h121-0-112" id="h121-0-112" class="i">+
</a><a href="#h121-0-113" id="h121-0-113" class="i">+            write!(f, &quot;Query: {}\n\n&quot;, $sql).unwrap();
</a> 
<a href="#h121-0-115" id="h121-0-115" class="d">-            let mut f_ast = mint.new_goldenfile(&quot;ast&quot;).unwrap();
</a><a href="#h121-0-116" id="h121-0-116" class="d">-            let mut f_plan = mint.new_goldenfile(&quot;plan&quot;).unwrap();
</a><a href="#h121-0-117" id="h121-0-117" class="d">-            match Parser::new($sql).parse() {
</a><a href="#h121-0-118" id="h121-0-118" class="d">-                Ok(ast) =&gt; {
</a><a href="#h121-0-119" id="h121-0-119" class="d">-                    write!(f_ast, &quot;{:#?}&quot;, ast).unwrap();
</a><a href="#h121-0-120" id="h121-0-120" class="d">-                    match Planner::new(Box::new(storage)).build(ast) {
</a><a href="#h121-0-121" id="h121-0-121" class="d">-                        Ok(plan) =&gt; write!(f_plan, &quot;{:#?}&quot;, plan).unwrap(),
</a><a href="#h121-0-122" id="h121-0-122" class="d">-                        err =&gt; write!(f_plan, &quot;{:?}&quot;, err).unwrap(),
</a><a href="#h121-0-123" id="h121-0-123" class="d">-                    };
</a><a href="#h121-0-124" id="h121-0-124" class="d">-                },
</a><a href="#h121-0-125" id="h121-0-125" class="i">+            write!(f, &quot;Tokens:\n&quot;).unwrap();
</a><a href="#h121-0-126" id="h121-0-126" class="i">+            let tokens = match Lexer::new($sql).collect::&lt;Result&lt;Vec&lt;Token&gt;, Error&gt;&gt;() {
</a><a href="#h121-0-127" id="h121-0-127" class="i">+                Ok(tokens) =&gt; tokens,
</a>                 err =&gt; {
<a href="#h121-0-129" id="h121-0-129" class="d">-                    write!(f_ast, &quot;{:?}&quot;, err).unwrap();
</a><a href="#h121-0-130" id="h121-0-130" class="d">-                    write!(f_plan, &quot;{:?}&quot;, err).unwrap();
</a><a href="#h121-0-131" id="h121-0-131" class="d">-                },
</a><a href="#h121-0-132" id="h121-0-132" class="i">+                    write!(f, &quot;{:?}&quot;, err).unwrap();
</a><a href="#h121-0-133" id="h121-0-133" class="i">+                    return
</a><a href="#h121-0-134" id="h121-0-134" class="i">+                }
</a><a href="#h121-0-135" id="h121-0-135" class="i">+            };
</a><a href="#h121-0-136" id="h121-0-136" class="i">+            for token in tokens {
</a><a href="#h121-0-137" id="h121-0-137" class="i">+                write!(f, &quot;  {:?}\n&quot;, token).unwrap();
</a><a href="#h121-0-138" id="h121-0-138" class="i">+            }
</a><a href="#h121-0-139" id="h121-0-139" class="i">+            write!(f, &quot;\n&quot;).unwrap();
</a><a href="#h121-0-140" id="h121-0-140" class="i">+
</a><a href="#h121-0-141" id="h121-0-141" class="i">+            write!(f, &quot;AST: &quot;).unwrap();
</a><a href="#h121-0-142" id="h121-0-142" class="i">+            let ast = match Parser::new($sql).parse() {
</a><a href="#h121-0-143" id="h121-0-143" class="i">+                Ok(ast) =&gt; ast,
</a><a href="#h121-0-144" id="h121-0-144" class="i">+                Err(err) =&gt; {
</a><a href="#h121-0-145" id="h121-0-145" class="i">+                    write!(f, &quot;{:?}&quot;, err).unwrap();
</a><a href="#h121-0-146" id="h121-0-146" class="i">+                    return
</a><a href="#h121-0-147" id="h121-0-147" class="i">+                }
</a>             };
<a href="#h121-0-149" id="h121-0-149" class="i">+            write!(f, &quot;{:#?}\n\n&quot;, ast).unwrap();
</a><a href="#h121-0-150" id="h121-0-150" class="i">+
</a><a href="#h121-0-151" id="h121-0-151" class="i">+            write!(f, &quot;Plan: &quot;).unwrap();
</a><a href="#h121-0-152" id="h121-0-152" class="i">+            let plan = match Plan::build(ast) {
</a><a href="#h121-0-153" id="h121-0-153" class="i">+                Ok(plan) =&gt; plan,
</a><a href="#h121-0-154" id="h121-0-154" class="i">+                Err(err) =&gt; {
</a><a href="#h121-0-155" id="h121-0-155" class="i">+                    write!(f, &quot;{:?}&quot;, err).unwrap();
</a><a href="#h121-0-156" id="h121-0-156" class="i">+                    return
</a><a href="#h121-0-157" id="h121-0-157" class="i">+                }
</a><a href="#h121-0-158" id="h121-0-158" class="i">+            };
</a><a href="#h121-0-159" id="h121-0-159" class="i">+            write!(f, &quot;{:#?}\n\n&quot;, plan).unwrap();
</a><a href="#h121-0-160" id="h121-0-160" class="i">+
</a><a href="#h121-0-161" id="h121-0-161" class="i">+            write!(f, &quot;Query: {}\n\n&quot;, $sql).unwrap();
</a><a href="#h121-0-162" id="h121-0-162" class="i">+
</a><a href="#h121-0-163" id="h121-0-163" class="i">+            write!(f, &quot;Result:&quot;).unwrap();
</a><a href="#h121-0-164" id="h121-0-164" class="i">+            let result: Vec&lt;Row&gt; = match plan.execute(Context{storage: Box::new(storage.clone())}).and_then(|i| i.collect()) {
</a><a href="#h121-0-165" id="h121-0-165" class="i">+                Ok(result) =&gt; result,
</a><a href="#h121-0-166" id="h121-0-166" class="i">+                Err(err) =&gt; {
</a><a href="#h121-0-167" id="h121-0-167" class="i">+                    write!(f, &quot; {:?}&quot;, err).unwrap();
</a><a href="#h121-0-168" id="h121-0-168" class="i">+                    return
</a><a href="#h121-0-169" id="h121-0-169" class="i">+                }
</a><a href="#h121-0-170" id="h121-0-170" class="i">+            };
</a><a href="#h121-0-171" id="h121-0-171" class="i">+            for row in result {
</a><a href="#h121-0-172" id="h121-0-172" class="i">+                write!(f, &quot;\n{:?}&quot;, row).unwrap();
</a><a href="#h121-0-173" id="h121-0-173" class="i">+            }
</a><a href="#h121-0-174" id="h121-0-174" class="i">+
</a><a href="#h121-0-175" id="h121-0-175" class="i">+            write!(f, &quot;\n\nStorage:&quot;).unwrap();
</a><a href="#h121-0-176" id="h121-0-176" class="i">+            for table in &amp;storage.list_tables().unwrap() {
</a><a href="#h121-0-177" id="h121-0-177" class="i">+                let schema = &amp;storage.get_table(&amp;table).unwrap();
</a><a href="#h121-0-178" id="h121-0-178" class="i">+                write!(f, &quot;\n{}\n&quot;, schema.to_query()).unwrap();
</a><a href="#h121-0-179" id="h121-0-179" class="i">+                for row in storage.scan_rows(&amp;table) {
</a><a href="#h121-0-180" id="h121-0-180" class="i">+                    write!(f, &quot;{:?}\n&quot;, row.unwrap()).unwrap();
</a><a href="#h121-0-181" id="h121-0-181" class="i">+                }
</a><a href="#h121-0-182" id="h121-0-182" class="i">+            }
</a>         }
     )*
     }
<a href="#h121-1" id="h121-1" class="h">@@ -53,19 +177,24 @@ test_sql! {
</a>     create_table_single_column: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY)&quot;,
     create_table_error_bare: &quot;CREATE TABLE&quot;,
     create_table_error_empty_columns: &quot;CREATE TABLE name ()&quot;,
<a href="#h121-1-3" id="h121-1-3" class="i">+    create_table_error_exists: &quot;CREATE TABLE movies (id INTEGER PRIMARY KEY)&quot;,
</a>     create_table_error_no_columns: &quot;CREATE TABLE name&quot;,
     create_table_error_no_datatype: &quot;CREATE TABLE name (id)&quot;,
     create_table_error_no_name: &quot;CREATE TABLE (id INTEGER)&quot;,
     create_table_error_no_primary_key: &quot;CREATE TABLE name (id INTEGER)&quot;,
     create_table_error_multiple_primary_key: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, name VARCHAR PRIMARY KEY)&quot;,
<a href="#h121-1-9" id="h121-1-9" class="i">+
</a>     drop_table: &quot;DROP TABLE name&quot;,
     drop_table_error_bare: &quot;DROP TABLE&quot;,
<a href="#h121-1-12" id="h121-1-12" class="d">-    select_alone_aliases: &quot;SELECT 1, 2 b, 3 AS c&quot;,
</a><a href="#h121-1-13" id="h121-1-13" class="d">-    select_alone_datatypes: &quot;SELECT NULL, TRUE, FALSE, 1, 3.14, &#39;Hi! 👋&#39;&quot;,
</a><a href="#h121-1-14" id="h121-1-14" class="d">-    select_alone_literal_numbers: &quot;SELECT 0, 1, -2, --3, +-4, 3.14, 293, 3.14e3, 2.718E-2&quot;,
</a><a href="#h121-1-15" id="h121-1-15" class="d">-    select_alone_literal_string_quotes: r#&quot;SELECT &#39;Literal with &#39;&#39;single&#39;&#39; and &quot;double&quot; quotes&#39;&quot;#,
</a><a href="#h121-1-16" id="h121-1-16" class="i">+
</a><a href="#h121-1-17" id="h121-1-17" class="i">+    expr_datatypes: &quot;SELECT NULL, TRUE, FALSE, 1, 3.14, &#39;Hi! 👋&#39;&quot;,
</a><a href="#h121-1-18" id="h121-1-18" class="i">+    expr_literal_numbers: &quot;SELECT 0, 1, -2, --3, +-4, 3.14, 293, 3.14e3, 2.718E-2&quot;,
</a><a href="#h121-1-19" id="h121-1-19" class="i">+    expr_literal_string_quotes: r#&quot;SELECT &#39;Literal with &#39;&#39;single&#39;&#39; and &quot;double&quot; quotes&#39;&quot;#,
</a><a href="#h121-1-20" id="h121-1-20" class="i">+
</a><a href="#h121-1-21" id="h121-1-21" class="i">+    select_all_from_table: &quot;SELECT * FROM movies&quot;,
</a><a href="#h121-1-22" id="h121-1-22" class="i">+    select_aliases: &quot;SELECT 1, 2 b, 3 AS c&quot;,
</a>     select_error_bare: &quot;SELECT&quot;,
     select_error_bare_as: &quot;SELECT 1 AS, 2&quot;,
<a href="#h121-1-25" id="h121-1-25" class="d">-    select_error_from_bare: &quot;SELECT 1 FROM&quot;,
</a><a href="#h121-1-26" id="h121-1-26" class="i">+    select_error_bare_from: &quot;SELECT 1 FROM&quot;,
</a>     select_error_trailing_comma: &quot;SELECT 1, 2,&quot;,
 }
</pre>
</div>
</body>
</html>
