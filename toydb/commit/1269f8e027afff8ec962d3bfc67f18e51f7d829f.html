<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: split transaction and catalog traits, and use catalog during planning - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/1269f8e027afff8ec962d3bfc67f18e51f7d829f.html">1269f8e027afff8ec962d3bfc67f18e51f7d829f</a>
<b>parent</b> <a href="../commit/5a1756a90f2d3adcca09544d0e47ec19fd8b4ac2.html">5a1756a90f2d3adcca09544d0e47ec19fd8b4ac2</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Tue, 18 Jun 2024 12:51:34 +0200

sql: split transaction and catalog traits, and use catalog during planning

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/engine/engine.rs</a></td><td> | </td><td class="num">18</td><td><span class="i">++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/engine/local.rs</a></td><td> | </td><td class="num">13</td><td><span class="i">++++++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/engine/raft.rs</a></td><td> | </td><td class="num">15</td><td><span class="i">+++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/engine/session.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/execution/execute.rs</a></td><td> | </td><td class="num">31</td><td><span class="i">+++++++++++++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/execution/schema.rs</a></td><td> | </td><td class="num">15</td><td><span class="i">+++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/execution/source.rs</a></td><td> | </td><td class="num">17</td><td><span class="i">++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/execution/write.rs</a></td><td> | </td><td class="num">25</td><td><span class="i">+++++++++++++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/plan/optimizer.rs</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/plan/plan.rs</a></td><td> | </td><td class="num">49</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">54</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d">------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/types/schema.rs</a></td><td> | </td><td class="num">30</td><td><span class="i">+++++++++++++++++</span><span class="d">-------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/query/agg_boolean</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/agg_boolean_null</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/agg_const_from</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/agg_count_star</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/agg_expr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/agg_float</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/agg_float_null</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/agg_integer</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/agg_integer_null</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/agg_string</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/agg_string_null</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/all</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/as_</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/expr_mixed</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/field_aliased</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/field_multi</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/field_qualified</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/field_qualified_multi</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/field_single</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/query/from_multiple</a></td><td> | </td><td class="num">272</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/query/group_expr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/query/group_expr_aggr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/query/group_expr_aggr_selfref</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/query/group_expr_aliased</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/query/group_expr_both</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/query/group_expr_multigroup</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">tests/sql/query/group_expr_select</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">tests/sql/query/group_join</a></td><td> | </td><td class="num">248</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">tests/sql/query/group_noaggregate</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">tests/sql/query/group_noselect</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">tests/sql/query/group_simple</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">tests/sql/query/having</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">tests/sql/query/having_nogroup</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">tests/sql/query/join_cross</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">272</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">tests/sql/query/join_cross_multi</a></td><td> | </td><td class="num">352</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">tests/sql/query/join_inner</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">tests/sql/query/join_inner_implicit</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">tests/sql/query/join_inner_index_transverse</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">tests/sql/query/join_inner_index_transverse_where</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">tests/sql/query/join_inner_multi</a></td><td> | </td><td class="num">300</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">300</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">tests/sql/query/join_inner_multi_same</a></td><td> | </td><td class="num">468</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">tests/sql/query/join_inner_on_aliased</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">tests/sql/query/join_inner_on_false</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">tests/sql/query/join_inner_on_multi</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">tests/sql/query/join_inner_on_true</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">tests/sql/query/join_inner_on_where</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">tests/sql/query/join_left</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">tests/sql/query/join_left_all</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">tests/sql/query/join_left_outer</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">tests/sql/query/join_left_truncate</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">tests/sql/query/join_right</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">tests/sql/query/join_right_all</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">tests/sql/query/join_right_outer</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">tests/sql/query/join_right_truncate</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">tests/sql/query/limit</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">tests/sql/query/limit_expr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h77">tests/sql/query/limit_large</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h78">tests/sql/query/limit_offset</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h79">tests/sql/query/limit_zero</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h80">tests/sql/query/offset</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h81">tests/sql/query/offset_expr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h82">tests/sql/query/offset_large</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h83">tests/sql/query/offset_zero</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h84">tests/sql/query/order</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h85">tests/sql/query/order_aggregate</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h86">tests/sql/query/order_aggregate_noselect</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h87">tests/sql/query/order_asc</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h88">tests/sql/query/order_asc_lowercase</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h89">tests/sql/query/order_boolean_asc</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h90">tests/sql/query/order_boolean_desc</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h91">tests/sql/query/order_desc</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h92">tests/sql/query/order_desc_lowercase</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h93">tests/sql/query/order_expr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h94">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h95">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h96">tests/sql/query/order_float_asc</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h97">tests/sql/query/order_float_desc</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h98">tests/sql/query/order_group_by_noselect</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h99">tests/sql/query/order_integer_asc</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h100">tests/sql/query/order_integer_desc</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h101">tests/sql/query/order_multi</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h102">tests/sql/query/order_noselect</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h103">tests/sql/query/order_string_asc</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h104">tests/sql/query/order_string_desc</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h105">tests/sql/query/where_expr</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h106">tests/sql/query/where_false</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h107">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h108">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h109">tests/sql/query/where_float</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h110">tests/sql/query/where_index</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h111">tests/sql/query/where_index_or</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h112">tests/sql/query/where_index_or_partial</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h113">tests/sql/query/where_integer</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h114">tests/sql/query/where_join_inner</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h115">tests/sql/query/where_null</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h116">tests/sql/query/where_pk</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h117">tests/sql/query/where_pk_or</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h118">tests/sql/query/where_pk_or_partial</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h119">tests/sql/query/where_string</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h120">tests/sql/query/where_true</a></td><td> | </td><td class="num">168</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
</table></pre><pre>121 files changed, 18427 insertions(+), 440 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/engine/engine.rs.html">src/sql/engine/engine.rs</a> b/<a href="../file/src/sql/engine/engine.rs.html">src/sql/engine/engine.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -12,7 +12,7 @@ use std::collections::{HashMap, HashSet};
</a> /// The SQL engine interface.
 pub trait Engine&lt;&#39;a&gt;: Sized {
     /// The transaction type.
<a href="#h0-0-3" id="h0-0-3" class="d">-    type Transaction: Transaction + &#39;a;
</a><a href="#h0-0-4" id="h0-0-4" class="i">+    type Transaction: Transaction + Catalog + &#39;a;
</a> 
     /// Begins a read-write transaction.
     fn begin(&amp;self) -&gt; Result&lt;Self::Transaction&gt;;
<a href="#h0-1" id="h0-1" class="h">@@ -32,11 +32,7 @@ pub trait Engine&lt;&#39;a&gt;: Sized {
</a> /// All methods operate on row batches rather than single rows to amortize the
 /// cost. We have to do a Raft roundtrip for every call, and we&#39;d rather not
 /// have to do a Raft roundtrip for every row.
<a href="#h0-1-3" id="h0-1-3" class="d">-///
</a><a href="#h0-1-4" id="h0-1-4" class="d">-/// TODO: split out Catalog trait and don&#39;t have Transaction depend on it. This
</a><a href="#h0-1-5" id="h0-1-5" class="d">-/// enforces cleaner separation of when catalog access is valid (i.e. during
</a><a href="#h0-1-6" id="h0-1-6" class="d">-/// planning but not execution).
</a><a href="#h0-1-7" id="h0-1-7" class="d">-pub trait Transaction: Catalog {
</a><a href="#h0-1-8" id="h0-1-8" class="i">+pub trait Transaction {
</a>     /// The transaction&#39;s MVCC version.
     fn version(&amp;self) -&gt; mvcc::Version;
     /// Whether the transaction is read-only.
<a href="#h0-2" id="h0-2" class="h">@@ -68,15 +64,13 @@ pub trait Transaction: Catalog {
</a> /// An index scan iterator.
 pub type IndexScan = Box&lt;dyn Iterator&lt;Item = Result&lt;(Value, HashSet&lt;Value&gt;)&gt;&gt;&gt;;
 
<a href="#h0-2-3" id="h0-2-3" class="d">-/// The catalog stores schema information
</a><a href="#h0-2-4" id="h0-2-4" class="i">+/// The catalog stores schema information.
</a> pub trait Catalog {
     /// Creates a new table.
     fn create_table(&amp;self, table: Table) -&gt; Result&lt;()&gt;;
<a href="#h0-2-8" id="h0-2-8" class="d">-    /// Drops a table. Errors if it does not exist.
</a><a href="#h0-2-9" id="h0-2-9" class="d">-    ///
</a><a href="#h0-2-10" id="h0-2-10" class="d">-    /// TODO: consider taking an if_exists parameter, but that will incur a Raft
</a><a href="#h0-2-11" id="h0-2-11" class="d">-    /// roundtrip.
</a><a href="#h0-2-12" id="h0-2-12" class="d">-    fn drop_table(&amp;self, table: &amp;str) -&gt; Result&lt;()&gt;;
</a><a href="#h0-2-13" id="h0-2-13" class="i">+    /// Drops a table. Errors if it does not exist, unless if_exists is true.
</a><a href="#h0-2-14" id="h0-2-14" class="i">+    /// Returns true if the table existed and was deleted.
</a><a href="#h0-2-15" id="h0-2-15" class="i">+    fn drop_table(&amp;self, table: &amp;str, if_exists: bool) -&gt; Result&lt;bool&gt;;
</a>     /// Fetches a table schema.
     fn get_table(&amp;self, table: &amp;str) -&gt; Result&lt;Option&lt;Table&gt;&gt;;
     /// Lists tables.
<b>diff --git a/<a id="h1" href="../file/src/sql/engine/local.rs.html">src/sql/engine/local.rs</a> b/<a href="../file/src/sql/engine/local.rs.html">src/sql/engine/local.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -296,8 +296,14 @@ impl&lt;E: storage::Engine&gt; Catalog for Transaction&lt;E&gt; {
</a>         self.txn.set(&amp;Key::Table((&amp;table.name).into()).encode(), table.encode())
     }
 
<a href="#h1-0-3" id="h1-0-3" class="d">-    fn drop_table(&amp;self, table: &amp;str) -&gt; Result&lt;()&gt; {
</a><a href="#h1-0-4" id="h1-0-4" class="d">-        let table = self.must_get_table(table)?;
</a><a href="#h1-0-5" id="h1-0-5" class="i">+    fn drop_table(&amp;self, table: &amp;str, if_exists: bool) -&gt; Result&lt;bool&gt; {
</a><a href="#h1-0-6" id="h1-0-6" class="i">+        let table = if !if_exists {
</a><a href="#h1-0-7" id="h1-0-7" class="i">+            self.must_get_table(table)?
</a><a href="#h1-0-8" id="h1-0-8" class="i">+        } else if let Some(table) = self.get_table(table)? {
</a><a href="#h1-0-9" id="h1-0-9" class="i">+            table
</a><a href="#h1-0-10" id="h1-0-10" class="i">+        } else {
</a><a href="#h1-0-11" id="h1-0-11" class="i">+            return Ok(false);
</a><a href="#h1-0-12" id="h1-0-12" class="i">+        };
</a>         if let Some((t, cs)) = self.references(&amp;table.name, false)?.first() {
             return errinput!(&quot;table {} is referenced by table {} column {}&quot;, table.name, t, cs[0]);
         }
<a href="#h1-1" id="h1-1" class="h">@@ -305,7 +311,8 @@ impl&lt;E: storage::Engine&gt; Catalog for Transaction&lt;E&gt; {
</a>         while let Some(row) = scan.next().transpose()? {
             self.delete(&amp;table.name, &amp;[table.get_row_key(&amp;row)?])?
         }
<a href="#h1-1-3" id="h1-1-3" class="d">-        self.txn.delete(&amp;Key::Table(table.name.into()).encode())
</a><a href="#h1-1-4" id="h1-1-4" class="i">+        self.txn.delete(&amp;Key::Table(table.name.into()).encode())?;
</a><a href="#h1-1-5" id="h1-1-5" class="i">+        Ok(true)
</a>     }
 
     fn get_table(&amp;self, table: &amp;str) -&gt; Result&lt;Option&lt;Table&gt;&gt; {
<b>diff --git a/<a id="h2" href="../file/src/sql/engine/raft.rs.html">src/sql/engine/raft.rs</a> b/<a href="../file/src/sql/engine/raft.rs.html">src/sql/engine/raft.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -33,7 +33,7 @@ enum Mutation {
</a>     /// Creates a table
     CreateTable { txn: TransactionState, schema: Table },
     /// Deletes a table
<a href="#h2-0-3" id="h2-0-3" class="d">-    DeleteTable { txn: TransactionState, table: String },
</a><a href="#h2-0-4" id="h2-0-4" class="i">+    DeleteTable { txn: TransactionState, table: String, if_exists: bool },
</a> }
 
 impl encoding::Value for Mutation {}
<a href="#h2-1" id="h2-1" class="h">@@ -270,9 +270,12 @@ impl Catalog for Transaction {
</a>         self.client.mutate(Mutation::CreateTable { txn: self.state.clone(), schema: table })
     }
 
<a href="#h2-1-3" id="h2-1-3" class="d">-    fn drop_table(&amp;self, table: &amp;str) -&gt; Result&lt;()&gt; {
</a><a href="#h2-1-4" id="h2-1-4" class="d">-        self.client
</a><a href="#h2-1-5" id="h2-1-5" class="d">-            .mutate(Mutation::DeleteTable { txn: self.state.clone(), table: table.to_string() })
</a><a href="#h2-1-6" id="h2-1-6" class="i">+    fn drop_table(&amp;self, table: &amp;str, if_exists: bool) -&gt; Result&lt;bool&gt; {
</a><a href="#h2-1-7" id="h2-1-7" class="i">+        self.client.mutate(Mutation::DeleteTable {
</a><a href="#h2-1-8" id="h2-1-8" class="i">+            txn: self.state.clone(),
</a><a href="#h2-1-9" id="h2-1-9" class="i">+            table: table.to_string(),
</a><a href="#h2-1-10" id="h2-1-10" class="i">+            if_exists,
</a><a href="#h2-1-11" id="h2-1-11" class="i">+        })
</a>     }
 
     fn get_table(&amp;self, table: &amp;str) -&gt; Result&lt;Option&lt;Table&gt;&gt; {
<a href="#h2-2" id="h2-2" class="h">@@ -323,8 +326,8 @@ impl&lt;E: storage::Engine&gt; State&lt;E&gt; {
</a>             Mutation::CreateTable { txn, schema } =&gt; {
                 bincode::serialize(&amp;self.engine.resume(txn)?.create_table(schema)?)
             }
<a href="#h2-2-3" id="h2-2-3" class="d">-            Mutation::DeleteTable { txn, table } =&gt; {
</a><a href="#h2-2-4" id="h2-2-4" class="d">-                bincode::serialize(&amp;self.engine.resume(txn)?.drop_table(&amp;table)?)
</a><a href="#h2-2-5" id="h2-2-5" class="i">+            Mutation::DeleteTable { txn, table, if_exists } =&gt; {
</a><a href="#h2-2-6" id="h2-2-6" class="i">+                bincode::serialize(&amp;self.engine.resume(txn)?.drop_table(&amp;table, if_exists)?)
</a>             }
         };
         Ok(response)
<b>diff --git a/<a id="h3" href="../file/src/sql/engine/session.rs.html">src/sql/engine/session.rs</a> b/<a href="../file/src/sql/engine/session.rs.html">src/sql/engine/session.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -69,7 +69,7 @@ impl&lt;&#39;a, E: Engine&lt;&#39;a&gt;&gt; Session&lt;&#39;a, E&gt; {
</a>             }
             // TODO: this needs testing.
             ast::Statement::Explain(statement) =&gt; self.with_txn_read_only(|txn| {
<a href="#h3-0-3" id="h3-0-3" class="d">-                Ok(StatementResult::Explain(Plan::build(*statement, txn)?.optimize(txn)?))
</a><a href="#h3-0-4" id="h3-0-4" class="i">+                Ok(StatementResult::Explain(Plan::build(*statement, txn)?.optimize()?))
</a>             }),
             statement if self.txn.is_some() =&gt; {
                 Self::execute_with(statement, self.txn.as_mut().unwrap())
<a href="#h3-1" id="h3-1" class="h">@@ -101,7 +101,7 @@ impl&lt;&#39;a, E: Engine&lt;&#39;a&gt;&gt; Session&lt;&#39;a, E&gt; {
</a>         statement: ast::Statement,
         txn: &amp;mut E::Transaction,
     ) -&gt; Result&lt;StatementResult&gt; {
<a href="#h3-1-3" id="h3-1-3" class="d">-        Plan::build(statement, txn)?.optimize(txn)?.execute(txn)?.try_into()
</a><a href="#h3-1-4" id="h3-1-4" class="i">+        Plan::build(statement, txn)?.optimize()?.execute(txn)?.try_into()
</a>     }
 
     /// Runs a read-only closure in the session&#39;s transaction, or a new
<b>diff --git a/<a id="h4" href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a> b/<a href="../file/src/sql/execution/execute.rs.html">src/sql/execution/execute.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -5,41 +5,45 @@ use super::source;
</a> use super::transform;
 use super::write;
 use crate::error::Result;
<a href="#h4-0-3" id="h4-0-3" class="d">-use crate::sql::engine::Transaction;
</a><a href="#h4-0-4" id="h4-0-4" class="i">+use crate::sql::engine::{Catalog, Transaction};
</a> use crate::sql::plan::{Node, Plan};
 use crate::sql::types::{Columns, Row, Rows};
 
 /// Executes a plan, returning an execution result.
<a href="#h4-0-9" id="h4-0-9" class="d">-pub fn execute_plan(plan: Plan, txn: &amp;impl Transaction) -&gt; Result&lt;ExecutionResult&gt; {
</a><a href="#h4-0-10" id="h4-0-10" class="i">+pub fn execute_plan(
</a><a href="#h4-0-11" id="h4-0-11" class="i">+    plan: Plan,
</a><a href="#h4-0-12" id="h4-0-12" class="i">+    txn: &amp;impl Transaction,
</a><a href="#h4-0-13" id="h4-0-13" class="i">+    catalog: &amp;impl Catalog,
</a><a href="#h4-0-14" id="h4-0-14" class="i">+) -&gt; Result&lt;ExecutionResult&gt; {
</a>     Ok(match plan {
         Plan::CreateTable { schema } =&gt; {
             let name = schema.name.clone();
<a href="#h4-0-18" id="h4-0-18" class="d">-            schema::create_table(txn, schema)?;
</a><a href="#h4-0-19" id="h4-0-19" class="i">+            schema::create_table(catalog, schema)?;
</a>             ExecutionResult::CreateTable { name }
         }
 
         Plan::DropTable { table, if_exists } =&gt; {
<a href="#h4-0-24" id="h4-0-24" class="d">-            let existed = schema::drop_table(txn, &amp;table, if_exists)?;
</a><a href="#h4-0-25" id="h4-0-25" class="i">+            let existed = schema::drop_table(catalog, &amp;table, if_exists)?;
</a>             ExecutionResult::DropTable { name: table, existed }
         }
 
<a href="#h4-0-29" id="h4-0-29" class="d">-        Plan::Delete { table, source } =&gt; {
</a><a href="#h4-0-30" id="h4-0-30" class="i">+        Plan::Delete { table, key_index, source } =&gt; {
</a>             let source = execute(source, txn)?;
<a href="#h4-0-32" id="h4-0-32" class="d">-            let count = write::delete(txn, &amp;table, source)?;
</a><a href="#h4-0-33" id="h4-0-33" class="i">+            let count = write::delete(txn, table, key_index, source)?;
</a>             ExecutionResult::Delete { count }
         }
 
         Plan::Insert { table, columns, expressions } =&gt; {
<a href="#h4-0-38" id="h4-0-38" class="d">-            let count = write::insert(txn, &amp;table, columns, expressions)?;
</a><a href="#h4-0-39" id="h4-0-39" class="i">+            let count = write::insert(txn, table, columns, expressions)?;
</a>             ExecutionResult::Insert { count }
         }
 
         Plan::Select(node) =&gt; ExecutionResult::Select { iter: execute(node, txn)? },
 
<a href="#h4-0-45" id="h4-0-45" class="d">-        Plan::Update { table, source, expressions } =&gt; {
</a><a href="#h4-0-46" id="h4-0-46" class="i">+        Plan::Update { table, key_index, source, expressions } =&gt; {
</a>             let source = execute(source, txn)?;
             let expressions = expressions.into_iter().map(|(i, _, expr)| (i, expr)).collect();
<a href="#h4-0-49" id="h4-0-49" class="d">-            let count = write::update(txn, &amp;table, source, expressions)?;
</a><a href="#h4-0-50" id="h4-0-50" class="i">+            let count = write::update(txn, table, key_index, source, expressions)?;
</a>             ExecutionResult::Update { count }
         }
     })
<a href="#h4-1" id="h4-1" class="h">@@ -47,8 +51,7 @@ pub fn execute_plan(plan: Plan, txn: &amp;impl Transaction) -&gt; Result&lt;ExecutionResul
</a> 
 /// Recursively executes a query plan node, returning a query iterator.
 ///
<a href="#h4-1-3" id="h4-1-3" class="d">-/// TODO: since iterators are lazy, make this infallible and move all catalog
</a><a href="#h4-1-4" id="h4-1-4" class="d">-/// lookups to planning.
</a><a href="#h4-1-5" id="h4-1-5" class="i">+/// TODO: since iterators are lazy, make this infallible if possible.
</a> pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;QueryIterator&gt; {
     match node {
         Node::Aggregation { source, aggregates } =&gt; {
<a href="#h4-2" id="h4-2" class="h">@@ -68,10 +71,10 @@ pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;QueryIterator&gt; {
</a>         }
 
         Node::IndexLookup { table, alias: _, column, values } =&gt; {
<a href="#h4-2-3" id="h4-2-3" class="d">-            source::lookup_index(txn, &amp;table, &amp;column, values)
</a><a href="#h4-2-4" id="h4-2-4" class="i">+            source::lookup_index(txn, table, column, values)
</a>         }
 
<a href="#h4-2-7" id="h4-2-7" class="d">-        Node::KeyLookup { table, alias: _, keys } =&gt; source::lookup_key(txn, &amp;table, keys),
</a><a href="#h4-2-8" id="h4-2-8" class="i">+        Node::KeyLookup { table, alias: _, keys } =&gt; source::lookup_key(txn, table, keys),
</a> 
         Node::Limit { source, limit } =&gt; {
             let source = execute(*source, txn)?;
<a href="#h4-3" id="h4-3" class="h">@@ -101,7 +104,7 @@ pub fn execute(node: Node, txn: &amp;impl Transaction) -&gt; Result&lt;QueryIterator&gt; {
</a>             Ok(transform::project(source, expressions))
         }
 
<a href="#h4-3-3" id="h4-3-3" class="d">-        Node::Scan { table, alias: _, filter } =&gt; source::scan(txn, &amp;table, filter),
</a><a href="#h4-3-4" id="h4-3-4" class="i">+        Node::Scan { table, alias: _, filter } =&gt; source::scan(txn, table, filter),
</a>     }
 }
 
<b>diff --git a/<a id="h5" href="../file/src/sql/execution/schema.rs.html">src/sql/execution/schema.rs</a> b/<a href="../file/src/sql/execution/schema.rs.html">src/sql/execution/schema.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -1,18 +1,13 @@
</a> use crate::error::Result;
<a href="#h5-0-1" id="h5-0-1" class="d">-use crate::sql::engine::Transaction;
</a><a href="#h5-0-2" id="h5-0-2" class="i">+use crate::sql::engine::Catalog;
</a> use crate::sql::types::schema::Table;
 
 // Creates a table (i.e. CREATE TABLE).
<a href="#h5-0-6" id="h5-0-6" class="d">-pub(super) fn create_table(txn: &amp;impl Transaction, schema: Table) -&gt; Result&lt;()&gt; {
</a><a href="#h5-0-7" id="h5-0-7" class="d">-    txn.create_table(schema)
</a><a href="#h5-0-8" id="h5-0-8" class="i">+pub(super) fn create_table(catalog: &amp;impl Catalog, schema: Table) -&gt; Result&lt;()&gt; {
</a><a href="#h5-0-9" id="h5-0-9" class="i">+    catalog.create_table(schema)
</a> }
 
 /// Deletes a table (i.e. DROP TABLE). Returns true if the table existed.
<a href="#h5-0-13" id="h5-0-13" class="d">-pub(super) fn drop_table(txn: &amp;impl Transaction, table: &amp;str, if_exists: bool) -&gt; Result&lt;bool&gt; {
</a><a href="#h5-0-14" id="h5-0-14" class="d">-    // TODO the planner should deal with this.
</a><a href="#h5-0-15" id="h5-0-15" class="d">-    if if_exists &amp;&amp; txn.get_table(table)?.is_none() {
</a><a href="#h5-0-16" id="h5-0-16" class="d">-        return Ok(false);
</a><a href="#h5-0-17" id="h5-0-17" class="d">-    }
</a><a href="#h5-0-18" id="h5-0-18" class="d">-    txn.drop_table(table)?;
</a><a href="#h5-0-19" id="h5-0-19" class="d">-    Ok(true)
</a><a href="#h5-0-20" id="h5-0-20" class="i">+pub(super) fn drop_table(catalog: &amp;impl Catalog, table: &amp;str, if_exists: bool) -&gt; Result&lt;bool&gt; {
</a><a href="#h5-0-21" id="h5-0-21" class="i">+    catalog.drop_table(table, if_exists)
</a> }
<b>diff --git a/<a id="h6" href="../file/src/sql/execution/source.rs.html">src/sql/execution/source.rs</a> b/<a href="../file/src/sql/execution/source.rs.html">src/sql/execution/source.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,16 +1,15 @@
</a> use super::QueryIterator;
 use crate::error::Result;
 use crate::sql::engine::Transaction;
<a href="#h6-0-3" id="h6-0-3" class="i">+use crate::sql::types::schema::Table;
</a> use crate::sql::types::{Column, Expression, Row, Value};
 
 /// A table scan source.
 pub(super) fn scan(
     txn: &amp;impl Transaction,
<a href="#h6-0-9" id="h6-0-9" class="d">-    table: &amp;str,
</a><a href="#h6-0-10" id="h6-0-10" class="i">+    table: Table,
</a>     filter: Option&lt;Expression&gt;,
 ) -&gt; Result&lt;QueryIterator&gt; {
<a href="#h6-0-13" id="h6-0-13" class="d">-    // TODO: this should not be fallible. Pass the schema in the plan node.
</a><a href="#h6-0-14" id="h6-0-14" class="d">-    let table = txn.must_get_table(table)?;
</a>     Ok(QueryIterator {
         columns: table.columns.into_iter().map(|c| Column { name: Some(c.name) }).collect(),
         rows: Box::new(txn.scan(&amp;table.name, filter)?),
<a href="#h6-1" id="h6-1" class="h">@@ -20,11 +19,9 @@ pub(super) fn scan(
</a> /// A primary key lookup source.
 pub(super) fn lookup_key(
     txn: &amp;impl Transaction,
<a href="#h6-1-3" id="h6-1-3" class="d">-    table: &amp;str,
</a><a href="#h6-1-4" id="h6-1-4" class="i">+    table: Table,
</a>     keys: Vec&lt;Value&gt;,
 ) -&gt; Result&lt;QueryIterator&gt; {
<a href="#h6-1-7" id="h6-1-7" class="d">-    // TODO: move catalog lookup elsewhere and make this infallible.
</a><a href="#h6-1-8" id="h6-1-8" class="d">-    let table = txn.must_get_table(table)?;
</a>     Ok(QueryIterator {
         columns: table.columns.iter().map(|c| Column { name: Some(c.name.clone()) }).collect(),
         rows: Box::new(txn.get(&amp;table.name, &amp;keys)?.into_iter().map(Ok)),
<a href="#h6-2" id="h6-2" class="h">@@ -34,13 +31,11 @@ pub(super) fn lookup_key(
</a> /// An index lookup source.
 pub(super) fn lookup_index(
     txn: &amp;impl Transaction,
<a href="#h6-2-3" id="h6-2-3" class="d">-    table: &amp;str,
</a><a href="#h6-2-4" id="h6-2-4" class="d">-    column: &amp;str,
</a><a href="#h6-2-5" id="h6-2-5" class="i">+    table: Table,
</a><a href="#h6-2-6" id="h6-2-6" class="i">+    column: String,
</a>     values: Vec&lt;Value&gt;,
 ) -&gt; Result&lt;QueryIterator&gt; {
<a href="#h6-2-9" id="h6-2-9" class="d">-    // TODO: pass in from planner.
</a><a href="#h6-2-10" id="h6-2-10" class="d">-    let table = txn.must_get_table(table)?;
</a><a href="#h6-2-11" id="h6-2-11" class="d">-    let pks: Vec&lt;_&gt; = txn.lookup_index(&amp;table.name, column, &amp;values)?.into_iter().collect();
</a><a href="#h6-2-12" id="h6-2-12" class="i">+    let pks: Vec&lt;_&gt; = txn.lookup_index(&amp;table.name, &amp;column, &amp;values)?.into_iter().collect();
</a>     let rows = txn.get(&amp;table.name, &amp;pks)?;
 
     Ok(QueryIterator {
<b>diff --git a/<a id="h7" href="../file/src/sql/execution/write.rs.html">src/sql/execution/write.rs</a> b/<a href="../file/src/sql/execution/write.rs.html">src/sql/execution/write.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -7,13 +7,15 @@ use crate::sql::types::{Expression, Row, Value};
</a> 
 /// Deletes rows, taking primary keys from the source (i.e. DELETE).
 /// Returns the number of rows deleted.
<a href="#h7-0-3" id="h7-0-3" class="d">-pub(super) fn delete(txn: &amp;impl Transaction, table: &amp;str, source: QueryIterator) -&gt; Result&lt;u64&gt; {
</a><a href="#h7-0-4" id="h7-0-4" class="d">-    // TODO: should be prepared by planner.
</a><a href="#h7-0-5" id="h7-0-5" class="d">-    let table = txn.must_get_table(table)?;
</a><a href="#h7-0-6" id="h7-0-6" class="d">-    let ids: Vec&lt;_&gt; =
</a><a href="#h7-0-7" id="h7-0-7" class="d">-        source.map(|r| r.and_then(|row| table.get_row_key(&amp;row))).collect::&lt;Result&lt;_&gt;&gt;()?;
</a><a href="#h7-0-8" id="h7-0-8" class="i">+pub(super) fn delete(
</a><a href="#h7-0-9" id="h7-0-9" class="i">+    txn: &amp;impl Transaction,
</a><a href="#h7-0-10" id="h7-0-10" class="i">+    table: String,
</a><a href="#h7-0-11" id="h7-0-11" class="i">+    key_index: usize,
</a><a href="#h7-0-12" id="h7-0-12" class="i">+    source: QueryIterator,
</a><a href="#h7-0-13" id="h7-0-13" class="i">+) -&gt; Result&lt;u64&gt; {
</a><a href="#h7-0-14" id="h7-0-14" class="i">+    let ids: Vec&lt;_&gt; = source.map(|r| r.map(|row| row[key_index].clone())).collect::&lt;Result&lt;_&gt;&gt;()?;
</a>     let count = ids.len() as u64;
<a href="#h7-0-16" id="h7-0-16" class="d">-    txn.delete(&amp;table.name, &amp;ids)?;
</a><a href="#h7-0-17" id="h7-0-17" class="i">+    txn.delete(&amp;table, &amp;ids)?;
</a>     Ok(count)
 }
 
<a href="#h7-1" id="h7-1" class="h">@@ -22,11 +24,10 @@ pub(super) fn delete(txn: &amp;impl Transaction, table: &amp;str, source: QueryIterator)
</a> /// TODO: this should take rows from a values source.
 pub(super) fn insert(
     txn: &amp;impl Transaction,
<a href="#h7-1-3" id="h7-1-3" class="d">-    table: &amp;str,
</a><a href="#h7-1-4" id="h7-1-4" class="i">+    table: Table,
</a>     columns: Vec&lt;String&gt;,
     values: Vec&lt;Vec&lt;Expression&gt;&gt;,
 ) -&gt; Result&lt;u64&gt; {
<a href="#h7-1-8" id="h7-1-8" class="d">-    let table = txn.must_get_table(table)?;
</a>     let mut rows = Vec::with_capacity(values.len());
     for expressions in values {
         let mut row =
<a href="#h7-2" id="h7-2" class="h">@@ -47,14 +48,14 @@ pub(super) fn insert(
</a> /// rows updated.
 pub(super) fn update(
     txn: &amp;impl Transaction,
<a href="#h7-2-3" id="h7-2-3" class="d">-    table: &amp;str,
</a><a href="#h7-2-4" id="h7-2-4" class="i">+    table: String,
</a><a href="#h7-2-5" id="h7-2-5" class="i">+    key_index: usize,
</a>     mut source: QueryIterator,
     expressions: Vec&lt;(usize, Expression)&gt;,
 ) -&gt; Result&lt;u64&gt; {
<a href="#h7-2-9" id="h7-2-9" class="d">-    let table = txn.must_get_table(table)?;
</a>     let mut update = std::collections::HashMap::new();
     while let Some(row) = source.next().transpose()? {
<a href="#h7-2-12" id="h7-2-12" class="d">-        let id = table.get_row_key(&amp;row)?;
</a><a href="#h7-2-13" id="h7-2-13" class="i">+        let id = row[key_index].clone();
</a>         let mut new = row.clone();
         for (field, expr) in &amp;expressions {
             new[*field] = expr.evaluate(Some(&amp;row))?;
<a href="#h7-3" id="h7-3" class="h">@@ -62,7 +63,7 @@ pub(super) fn update(
</a>         update.insert(id, new);
     }
     let count = update.len() as u64;
<a href="#h7-3-3" id="h7-3-3" class="d">-    txn.update(&amp;table.name, update)?;
</a><a href="#h7-3-4" id="h7-3-4" class="i">+    txn.update(&amp;table, update)?;
</a>     Ok(count)
 }
 
<b>diff --git a/<a id="h8" href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a> b/<a href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -1,7 +1,6 @@
</a> use super::super::types::{Expression, Value};
 use super::plan::Node;
 use crate::error::Result;
<a href="#h8-0-3" id="h8-0-3" class="d">-use crate::sql::engine::Catalog;
</a> 
 use std::mem::replace;
 
<a href="#h8-1" id="h8-1" class="h">@@ -158,15 +157,9 @@ impl FilterPushdown {
</a> }
 
 /// An index lookup optimizer, which converts table scans to index lookups.
<a href="#h8-1-3" id="h8-1-3" class="d">-pub struct IndexLookup&lt;&#39;a, C: Catalog&gt; {
</a><a href="#h8-1-4" id="h8-1-4" class="d">-    catalog: &amp;&#39;a mut C,
</a><a href="#h8-1-5" id="h8-1-5" class="d">-}
</a><a href="#h8-1-6" id="h8-1-6" class="d">-
</a><a href="#h8-1-7" id="h8-1-7" class="d">-impl&lt;&#39;a, C: Catalog&gt; IndexLookup&lt;&#39;a, C&gt; {
</a><a href="#h8-1-8" id="h8-1-8" class="d">-    pub fn new(catalog: &amp;&#39;a mut C) -&gt; Self {
</a><a href="#h8-1-9" id="h8-1-9" class="d">-        Self { catalog }
</a><a href="#h8-1-10" id="h8-1-10" class="d">-    }
</a><a href="#h8-1-11" id="h8-1-11" class="i">+pub struct IndexLookup;
</a> 
<a href="#h8-1-13" id="h8-1-13" class="i">+impl IndexLookup {
</a>     // Wraps a node in a filter for the given CNF vector, if any, otherwise returns the bare node.
     fn wrap_cnf(&amp;self, node: Node, cnf: Vec&lt;Expression&gt;) -&gt; Node {
         if let Some(predicate) = Expression::from_cnf_vec(cnf) {
<a href="#h8-2" id="h8-2" class="h">@@ -177,12 +170,11 @@ impl&lt;&#39;a, C: Catalog&gt; IndexLookup&lt;&#39;a, C&gt; {
</a>     }
 }
 
<a href="#h8-2-3" id="h8-2-3" class="d">-impl&lt;&#39;a, C: Catalog&gt; Optimizer for IndexLookup&lt;&#39;a, C&gt; {
</a><a href="#h8-2-4" id="h8-2-4" class="i">+impl Optimizer for IndexLookup {
</a>     fn optimize(&amp;self, node: Node) -&gt; Result&lt;Node&gt; {
         node.transform(&amp;Ok, &amp;|n| match n {
             Node::Scan { table, alias, filter: Some(filter) } =&gt; {
<a href="#h8-2-8" id="h8-2-8" class="d">-                let columns = self.catalog.must_get_table(&amp;table)?.columns;
</a><a href="#h8-2-9" id="h8-2-9" class="d">-                let pk = columns.iter().position(|c| c.primary_key).unwrap();
</a><a href="#h8-2-10" id="h8-2-10" class="i">+                let pk = table.columns.iter().position(|c| c.primary_key).unwrap();
</a> 
                 // Convert the filter into conjunctive normal form, and try to convert each
                 // sub-expression into a lookup. If a lookup is found, return a lookup node and then
<a href="#h8-3" id="h8-3" class="h">@@ -193,12 +185,12 @@ impl&lt;&#39;a, C: Catalog&gt; Optimizer for IndexLookup&lt;&#39;a, C&gt; {
</a>                         cnf.remove(i);
                         return Ok(self.wrap_cnf(Node::KeyLookup { table, alias, keys }, cnf));
                     }
<a href="#h8-3-3" id="h8-3-3" class="d">-                    for (ci, column) in columns.iter().enumerate().filter(|(_, c)| c.index) {
</a><a href="#h8-3-4" id="h8-3-4" class="i">+                    for (ci, column) in table.columns.iter().enumerate().filter(|(_, c)| c.index) {
</a>                         if let Some(values) = cnf[i].as_lookup(ci) {
                             cnf.remove(i);
                             return Ok(self.wrap_cnf(
                                 Node::IndexLookup {
<a href="#h8-3-9" id="h8-3-9" class="d">-                                    table,
</a><a href="#h8-3-10" id="h8-3-10" class="i">+                                    table: table.clone(),
</a>                                     alias,
                                     column: column.name.clone(),
                                     values,
<b>diff --git a/<a id="h9" href="../file/src/sql/plan/plan.rs.html">src/sql/plan/plan.rs</a> b/<a href="../file/src/sql/plan/plan.rs.html">src/sql/plan/plan.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -21,42 +21,49 @@ pub enum Plan {
</a>     /// A DROP TABLE plan.
     DropTable { table: String, if_exists: bool },
     /// A DELETE plan.
<a href="#h9-0-3" id="h9-0-3" class="d">-    Delete { table: String, source: Node },
</a><a href="#h9-0-4" id="h9-0-4" class="i">+    Delete { table: String, key_index: usize, source: Node },
</a>     /// An INSERT plan.
     /// TODO: consider using a source which generates expression rows.
<a href="#h9-0-7" id="h9-0-7" class="d">-    Insert { table: String, columns: Vec&lt;String&gt;, expressions: Vec&lt;Vec&lt;Expression&gt;&gt; },
</a><a href="#h9-0-8" id="h9-0-8" class="i">+    Insert { table: Table, columns: Vec&lt;String&gt;, expressions: Vec&lt;Vec&lt;Expression&gt;&gt; },
</a>     /// An UPDATE plan.
<a href="#h9-0-10" id="h9-0-10" class="d">-    Update { table: String, source: Node, expressions: Vec&lt;(usize, Option&lt;String&gt;, Expression)&gt; },
</a><a href="#h9-0-11" id="h9-0-11" class="i">+    Update {
</a><a href="#h9-0-12" id="h9-0-12" class="i">+        table: String,
</a><a href="#h9-0-13" id="h9-0-13" class="i">+        key_index: usize,
</a><a href="#h9-0-14" id="h9-0-14" class="i">+        source: Node,
</a><a href="#h9-0-15" id="h9-0-15" class="i">+        expressions: Vec&lt;(usize, Option&lt;String&gt;, Expression)&gt;,
</a><a href="#h9-0-16" id="h9-0-16" class="i">+    },
</a>     /// A SELECT plan.
     Select(Node),
 }
 
 impl Plan {
     /// Builds a plan from an AST statement.
<a href="#h9-0-23" id="h9-0-23" class="d">-    pub fn build&lt;C: Catalog&gt;(statement: ast::Statement, catalog: &amp;mut C) -&gt; Result&lt;Self&gt; {
</a><a href="#h9-0-24" id="h9-0-24" class="i">+    pub fn build(statement: ast::Statement, catalog: &amp;impl Catalog) -&gt; Result&lt;Self&gt; {
</a>         Planner::new(catalog).build(statement)
     }
 
     /// Executes the plan, consuming it.
<a href="#h9-0-29" id="h9-0-29" class="d">-    pub fn execute(self, txn: &amp;mut impl Transaction) -&gt; Result&lt;ExecutionResult&gt; {
</a><a href="#h9-0-30" id="h9-0-30" class="d">-        execution::execute_plan(self, txn)
</a><a href="#h9-0-31" id="h9-0-31" class="i">+    pub fn execute(self, txn: &amp;(impl Transaction + Catalog)) -&gt; Result&lt;ExecutionResult&gt; {
</a><a href="#h9-0-32" id="h9-0-32" class="i">+        execution::execute_plan(self, txn, txn)
</a>     }
 
     /// Optimizes the plan, consuming it.
<a href="#h9-0-36" id="h9-0-36" class="d">-    pub fn optimize&lt;C: Catalog&gt;(self, catalog: &amp;mut C) -&gt; Result&lt;Self&gt; {
</a><a href="#h9-0-37" id="h9-0-37" class="d">-        let mut optimize = |mut node| -&gt; Result&lt;Node&gt; {
</a><a href="#h9-0-38" id="h9-0-38" class="i">+    pub fn optimize(self) -&gt; Result&lt;Self&gt; {
</a><a href="#h9-0-39" id="h9-0-39" class="i">+        let optimize = |mut node| -&gt; Result&lt;Node&gt; {
</a>             node = optimizer::ConstantFolder.optimize(node)?;
             node = optimizer::FilterPushdown.optimize(node)?;
<a href="#h9-0-42" id="h9-0-42" class="d">-            node = optimizer::IndexLookup::new(catalog).optimize(node)?;
</a><a href="#h9-0-43" id="h9-0-43" class="i">+            node = optimizer::IndexLookup.optimize(node)?;
</a>             node = optimizer::NoopCleaner.optimize(node)?;
             node = optimizer::JoinType.optimize(node)?;
             Ok(node)
         };
         Ok(match self {
             Self::CreateTable { .. } | Self::DropTable { .. } | Self::Insert { .. } =&gt; self,
<a href="#h9-0-50" id="h9-0-50" class="d">-            Self::Delete { table, source } =&gt; Self::Delete { table, source: optimize(source)? },
</a><a href="#h9-0-51" id="h9-0-51" class="d">-            Self::Update { table, source, expressions } =&gt; {
</a><a href="#h9-0-52" id="h9-0-52" class="d">-                Self::Update { table, source: optimize(source)?, expressions }
</a><a href="#h9-0-53" id="h9-0-53" class="i">+            Self::Delete { table, key_index, source } =&gt; {
</a><a href="#h9-0-54" id="h9-0-54" class="i">+                Self::Delete { table, key_index, source: optimize(source)? }
</a><a href="#h9-0-55" id="h9-0-55" class="i">+            }
</a><a href="#h9-0-56" id="h9-0-56" class="i">+            Self::Update { table, key_index, source, expressions } =&gt; {
</a><a href="#h9-0-57" id="h9-0-57" class="i">+                Self::Update { table, key_index, source: optimize(source)?, expressions }
</a>             }
             Self::Select(root) =&gt; Self::Select(optimize(root)?),
         })
<a href="#h9-1" id="h9-1" class="h">@@ -69,7 +76,7 @@ impl std::fmt::Display for Plan {
</a>         match self {
             Self::CreateTable { schema } =&gt; write!(f, &quot;CreateTable: {}&quot;, schema.name),
             Self::DropTable { table, if_exists: _ } =&gt; write!(f, &quot;DropTable: {table}&quot;),
<a href="#h9-1-3" id="h9-1-3" class="d">-            Self::Delete { source, table } =&gt; {
</a><a href="#h9-1-4" id="h9-1-4" class="i">+            Self::Delete { table, key_index: _, source } =&gt; {
</a>                 write!(
                     f,
                     &quot;Delete: {table}\n{}&quot;,
<a href="#h9-2" id="h9-2" class="h">@@ -77,10 +84,10 @@ impl std::fmt::Display for Plan {
</a>                 )
             }
             Self::Insert { table, columns: _, expressions } =&gt; {
<a href="#h9-2-3" id="h9-2-3" class="d">-                write!(f, &quot;Insert: {table} ({} rows)&quot;, expressions.len())
</a><a href="#h9-2-4" id="h9-2-4" class="i">+                write!(f, &quot;Insert: {} ({} rows)&quot;, table.name, expressions.len())
</a>             }
             Self::Select(root) =&gt; root.fmt(f),
<a href="#h9-2-7" id="h9-2-7" class="d">-            Self::Update { source, table, expressions } =&gt; {
</a><a href="#h9-2-8" id="h9-2-8" class="i">+            Self::Update { table, key_index: _, source, expressions } =&gt; {
</a>                 write!(
                     f,
                     &quot;Update: {table} ({})\n{}&quot;,
<a href="#h9-3" id="h9-3" class="h">@@ -119,13 +126,13 @@ pub enum Node {
</a>         outer: bool,
     },
     IndexLookup {
<a href="#h9-3-3" id="h9-3-3" class="d">-        table: String,
</a><a href="#h9-3-4" id="h9-3-4" class="i">+        table: Table,
</a>         alias: Option&lt;String&gt;,
         column: String,
         values: Vec&lt;Value&gt;,
     },
     KeyLookup {
<a href="#h9-3-10" id="h9-3-10" class="d">-        table: String,
</a><a href="#h9-3-11" id="h9-3-11" class="i">+        table: Table,
</a>         alias: Option&lt;String&gt;,
         keys: Vec&lt;Value&gt;,
     },
<a href="#h9-4" id="h9-4" class="h">@@ -154,7 +161,7 @@ pub enum Node {
</a>         expressions: Vec&lt;(Expression, Option&lt;String&gt;)&gt;,
     },
     Scan {
<a href="#h9-4-3" id="h9-4-3" class="d">-        table: String,
</a><a href="#h9-4-4" id="h9-4-4" class="i">+        table: Table,
</a>         alias: Option&lt;String&gt;,
         filter: Option&lt;Expression&gt;,
     },
<a href="#h9-5" id="h9-5" class="h">@@ -305,7 +312,7 @@ impl Node {
</a>                 s += &amp;right.format(indent, false, true);
             }
             Self::IndexLookup { table, column, alias, values } =&gt; {
<a href="#h9-5-3" id="h9-5-3" class="d">-                s += &amp;format!(&quot;IndexLookup: {}&quot;, table);
</a><a href="#h9-5-4" id="h9-5-4" class="i">+                s += &amp;format!(&quot;IndexLookup: {}&quot;, table.name);
</a>                 if let Some(alias) = alias {
                     s += &amp;format!(&quot; as {}&quot;, alias);
                 }
<a href="#h9-6" id="h9-6" class="h">@@ -321,7 +328,7 @@ impl Node {
</a>                 s += &quot;\n&quot;;
             }
             Self::KeyLookup { table, alias, keys } =&gt; {
<a href="#h9-6-3" id="h9-6-3" class="d">-                s += &amp;format!(&quot;KeyLookup: {}&quot;, table);
</a><a href="#h9-6-4" id="h9-6-4" class="i">+                s += &amp;format!(&quot;KeyLookup: {}&quot;, table.name);
</a>                 if let Some(alias) = alias {
                     s += &amp;format!(&quot; as {}&quot;, alias);
                 }
<a href="#h9-7" id="h9-7" class="h">@@ -378,7 +385,7 @@ impl Node {
</a>                 s += &amp;source.format(indent, false, true);
             }
             Self::Scan { table, alias, filter } =&gt; {
<a href="#h9-7-3" id="h9-7-3" class="d">-                s += &amp;format!(&quot;Scan: {}&quot;, table);
</a><a href="#h9-7-4" id="h9-7-4" class="i">+                s += &amp;format!(&quot;Scan: {}&quot;, table.name);
</a>                 if let Some(alias) = alias {
                     s += &amp;format!(&quot; as {}&quot;, alias);
                 }
<b>diff --git a/<a id="h10" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -11,12 +11,12 @@ use std::mem::replace;
</a> 
 /// A query plan builder.
 pub struct Planner&lt;&#39;a, C: Catalog&gt; {
<a href="#h10-0-3" id="h10-0-3" class="d">-    catalog: &amp;&#39;a mut C,
</a><a href="#h10-0-4" id="h10-0-4" class="i">+    catalog: &amp;&#39;a C,
</a> }
 
 impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
     /// Creates a new planner.
<a href="#h10-0-9" id="h10-0-9" class="d">-    pub fn new(catalog: &amp;&#39;a mut C) -&gt; Self {
</a><a href="#h10-0-10" id="h10-0-10" class="i">+    pub fn new(catalog: &amp;&#39;a C) -&gt; Self {
</a>         Self { catalog }
     }
 
<a href="#h10-1" id="h10-1" class="h">@@ -69,9 +69,11 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a> 
             // DML statements (mutations).
             ast::Statement::Delete { table, r#where } =&gt; {
<a href="#h10-1-3" id="h10-1-3" class="d">-                let scope = &amp;mut Scope::from_table(self.catalog.must_get_table(&amp;table)?)?;
</a><a href="#h10-1-4" id="h10-1-4" class="i">+                let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h10-1-5" id="h10-1-5" class="i">+                let scope = &amp;mut Scope::from_table(table.clone())?;
</a>                 Plan::Delete {
<a href="#h10-1-7" id="h10-1-7" class="d">-                    table: table.clone(),
</a><a href="#h10-1-8" id="h10-1-8" class="i">+                    table: table.name.clone(),
</a><a href="#h10-1-9" id="h10-1-9" class="i">+                    key_index: table.get_row_key_index()?,
</a>                     source: Node::Scan {
                         table,
                         alias: None,
<a href="#h10-2" id="h10-2" class="h">@@ -80,24 +82,30 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 }
             }
 
<a href="#h10-2-3" id="h10-2-3" class="d">-            ast::Statement::Insert { table, columns, values } =&gt; Plan::Insert {
</a><a href="#h10-2-4" id="h10-2-4" class="d">-                table,
</a><a href="#h10-2-5" id="h10-2-5" class="d">-                columns: columns.unwrap_or_default(),
</a><a href="#h10-2-6" id="h10-2-6" class="d">-                expressions: values
</a><a href="#h10-2-7" id="h10-2-7" class="d">-                    .into_iter()
</a><a href="#h10-2-8" id="h10-2-8" class="d">-                    .map(|exprs| {
</a><a href="#h10-2-9" id="h10-2-9" class="d">-                        exprs
</a><a href="#h10-2-10" id="h10-2-10" class="d">-                            .into_iter()
</a><a href="#h10-2-11" id="h10-2-11" class="d">-                            .map(|expr| self.build_expression(&amp;mut Scope::constant(), expr))
</a><a href="#h10-2-12" id="h10-2-12" class="d">-                            .collect::&lt;Result&lt;_&gt;&gt;()
</a><a href="#h10-2-13" id="h10-2-13" class="d">-                    })
</a><a href="#h10-2-14" id="h10-2-14" class="d">-                    .collect::&lt;Result&lt;_&gt;&gt;()?,
</a><a href="#h10-2-15" id="h10-2-15" class="d">-            },
</a><a href="#h10-2-16" id="h10-2-16" class="i">+            ast::Statement::Insert { table, columns, values } =&gt; {
</a><a href="#h10-2-17" id="h10-2-17" class="i">+                let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h10-2-18" id="h10-2-18" class="i">+                Plan::Insert {
</a><a href="#h10-2-19" id="h10-2-19" class="i">+                    table,
</a><a href="#h10-2-20" id="h10-2-20" class="i">+                    columns: columns.unwrap_or_default(),
</a><a href="#h10-2-21" id="h10-2-21" class="i">+                    expressions: values
</a><a href="#h10-2-22" id="h10-2-22" class="i">+                        .into_iter()
</a><a href="#h10-2-23" id="h10-2-23" class="i">+                        .map(|exprs| {
</a><a href="#h10-2-24" id="h10-2-24" class="i">+                            exprs
</a><a href="#h10-2-25" id="h10-2-25" class="i">+                                .into_iter()
</a><a href="#h10-2-26" id="h10-2-26" class="i">+                                .map(|expr| self.build_expression(&amp;mut Scope::constant(), expr))
</a><a href="#h10-2-27" id="h10-2-27" class="i">+                                .collect::&lt;Result&lt;_&gt;&gt;()
</a><a href="#h10-2-28" id="h10-2-28" class="i">+                        })
</a><a href="#h10-2-29" id="h10-2-29" class="i">+                        .collect::&lt;Result&lt;_&gt;&gt;()?,
</a><a href="#h10-2-30" id="h10-2-30" class="i">+                }
</a><a href="#h10-2-31" id="h10-2-31" class="i">+            }
</a> 
             ast::Statement::Update { table, set, r#where } =&gt; {
<a href="#h10-2-34" id="h10-2-34" class="d">-                let scope = &amp;mut Scope::from_table(self.catalog.must_get_table(&amp;table)?)?;
</a><a href="#h10-2-35" id="h10-2-35" class="i">+                let table = self.catalog.must_get_table(&amp;table)?;
</a><a href="#h10-2-36" id="h10-2-36" class="i">+                let key_index = table.get_row_key_index()?;
</a><a href="#h10-2-37" id="h10-2-37" class="i">+                let scope = &amp;mut Scope::from_table(table.clone())?;
</a>                 Plan::Update {
<a href="#h10-2-39" id="h10-2-39" class="d">-                    table: table.clone(),
</a><a href="#h10-2-40" id="h10-2-40" class="i">+                    table: table.name.clone(),
</a><a href="#h10-2-41" id="h10-2-41" class="i">+                    key_index,
</a>                     source: Node::Scan {
                         table,
                         alias: None,
<a href="#h10-3" id="h10-3" class="h">@@ -285,11 +293,9 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>     fn build_from_item(&amp;self, scope: &amp;mut Scope, item: ast::FromItem) -&gt; Result&lt;Node&gt; {
         Ok(match item {
             ast::FromItem::Table { name, alias } =&gt; {
<a href="#h10-3-3" id="h10-3-3" class="d">-                scope.add_table(
</a><a href="#h10-3-4" id="h10-3-4" class="d">-                    alias.clone().unwrap_or_else(|| name.clone()),
</a><a href="#h10-3-5" id="h10-3-5" class="d">-                    self.catalog.must_get_table(&amp;name)?,
</a><a href="#h10-3-6" id="h10-3-6" class="d">-                )?;
</a><a href="#h10-3-7" id="h10-3-7" class="d">-                Node::Scan { table: name, alias, filter: None }
</a><a href="#h10-3-8" id="h10-3-8" class="i">+                let table = self.catalog.must_get_table(&amp;name)?;
</a><a href="#h10-3-9" id="h10-3-9" class="i">+                scope.add_table(alias.clone().unwrap_or_else(|| name.clone()), table.clone())?;
</a><a href="#h10-3-10" id="h10-3-10" class="i">+                Node::Scan { table, alias, filter: None }
</a>             }
 
             ast::FromItem::Join { left, right, r#type, predicate } =&gt; {
<b>diff --git a/<a id="h11" href="../file/src/sql/types/schema.rs.html">src/sql/types/schema.rs</a> b/<a href="../file/src/sql/types/schema.rs.html">src/sql/types/schema.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -1,7 +1,8 @@
</a> use super::{DataType, Value};
 use crate::encoding;
 use crate::errinput;
<a href="#h11-0-3" id="h11-0-3" class="d">-use crate::error::{Error, Result};
</a><a href="#h11-0-4" id="h11-0-4" class="i">+use crate::error::Result;
</a><a href="#h11-0-5" id="h11-0-5" class="i">+use crate::sql::engine::Catalog;
</a> use crate::sql::engine::Transaction;
 use crate::sql::parser::format_ident;
 
<a href="#h11-1" id="h11-1" class="h">@@ -50,18 +51,21 @@ impl Table {
</a> 
     /// Returns the primary key value of a row
     pub fn get_row_key(&amp;self, row: &amp;[Value]) -&gt; Result&lt;Value&gt; {
<a href="#h11-1-3" id="h11-1-3" class="d">-        row.get(
</a><a href="#h11-1-4" id="h11-1-4" class="d">-            self.columns
</a><a href="#h11-1-5" id="h11-1-5" class="d">-                .iter()
</a><a href="#h11-1-6" id="h11-1-6" class="d">-                .position(|c| c.primary_key)
</a><a href="#h11-1-7" id="h11-1-7" class="d">-                .ok_or::&lt;Error&gt;(errinput!(&quot;primary key not found&quot;))?,
</a><a href="#h11-1-8" id="h11-1-8" class="d">-        )
</a><a href="#h11-1-9" id="h11-1-9" class="d">-        .cloned()
</a><a href="#h11-1-10" id="h11-1-10" class="d">-        .ok_or(errinput!(&quot;primary key value not found for row&quot;))
</a><a href="#h11-1-11" id="h11-1-11" class="i">+        self.get_row_key_at(row, self.get_row_key_index()?)
</a><a href="#h11-1-12" id="h11-1-12" class="i">+    }
</a><a href="#h11-1-13" id="h11-1-13" class="i">+
</a><a href="#h11-1-14" id="h11-1-14" class="i">+    /// Returns the primary key value at the given index.
</a><a href="#h11-1-15" id="h11-1-15" class="i">+    pub fn get_row_key_at(&amp;self, row: &amp;[Value], index: usize) -&gt; Result&lt;Value&gt; {
</a><a href="#h11-1-16" id="h11-1-16" class="i">+        row.get(index).cloned().ok_or(errinput!(&quot;primary key value not found for row&quot;))
</a><a href="#h11-1-17" id="h11-1-17" class="i">+    }
</a><a href="#h11-1-18" id="h11-1-18" class="i">+
</a><a href="#h11-1-19" id="h11-1-19" class="i">+    /// Returns the index of the primary key field.
</a><a href="#h11-1-20" id="h11-1-20" class="i">+    pub fn get_row_key_index(&amp;self) -&gt; Result&lt;usize&gt; {
</a><a href="#h11-1-21" id="h11-1-21" class="i">+        self.columns.iter().position(|c| c.primary_key).ok_or(errinput!(&quot;primary key not found&quot;))
</a>     }
 
     /// Validates the table schema
<a href="#h11-1-25" id="h11-1-25" class="d">-    pub fn validate(&amp;self, txn: &amp;dyn Transaction) -&gt; Result&lt;()&gt; {
</a><a href="#h11-1-26" id="h11-1-26" class="i">+    pub fn validate(&amp;self, catalog: &amp;dyn Catalog) -&gt; Result&lt;()&gt; {
</a>         if self.columns.is_empty() {
             return errinput!(&quot;table {} has no columns&quot;, self.name);
         }
<a href="#h11-2" id="h11-2" class="h">@@ -71,7 +75,7 @@ impl Table {
</a>             _ =&gt; return errinput!(&quot;multiple primary keys in table {}&quot;, self.name),
         };
         for column in &amp;self.columns {
<a href="#h11-2-3" id="h11-2-3" class="d">-            column.validate(self, txn)?;
</a><a href="#h11-2-4" id="h11-2-4" class="i">+            column.validate(self, catalog)?;
</a>         }
         Ok(())
     }
<a href="#h11-3" id="h11-3" class="h">@@ -123,7 +127,7 @@ pub struct Column {
</a> 
 impl Column {
     /// Validates the column schema
<a href="#h11-3-3" id="h11-3-3" class="d">-    pub fn validate(&amp;self, table: &amp;Table, txn: &amp;dyn Transaction) -&gt; Result&lt;()&gt; {
</a><a href="#h11-3-4" id="h11-3-4" class="i">+    pub fn validate(&amp;self, table: &amp;Table, catalog: &amp;dyn Catalog) -&gt; Result&lt;()&gt; {
</a>         // Validate primary key
         if self.primary_key &amp;&amp; self.nullable {
             return errinput!(&quot;primary key {} cannot be nullable&quot;, self.name);
<a href="#h11-4" id="h11-4" class="h">@@ -156,7 +160,7 @@ impl Column {
</a>         if let Some(reference) = &amp;self.references {
             let target = if reference == &amp;table.name {
                 table.clone()
<a href="#h11-4-3" id="h11-4-3" class="d">-            } else if let Some(table) = txn.get_table(reference)? {
</a><a href="#h11-4-4" id="h11-4-4" class="i">+            } else if let Some(table) = catalog.get_table(reference)? {
</a>                 table
             } else {
                 return errinput!(
<b>diff --git a/<a id="h12" href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a> b/<a href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -80,7 +80,7 @@ macro_rules! test_query {
</a>             // First, just try to generate a plan and execute it
             let result = Parser::new($query).parse()
                 .and_then(|ast| Plan::build(ast, &amp;mut txn))
<a href="#h12-0-3" id="h12-0-3" class="d">-                .and_then(|plan| plan.optimize(&amp;mut txn))
</a><a href="#h12-0-4" id="h12-0-4" class="i">+                .and_then(|plan| plan.optimize())
</a>                 .and_then(|plan| {
                     write!(f, &quot;Explain:\n{}\n\n&quot;, plan)?;
                     plan.execute(&amp;mut txn).and_then(|r| r.try_into())
<a href="#h12-1" id="h12-1" class="h">@@ -128,7 +128,7 @@ macro_rules! test_query {
</a>             write!(f, &quot;{:#?}\n\n&quot;, plan)?;
 
             write!(f, &quot;Optimized plan: &quot;)?;
<a href="#h12-1-3" id="h12-1-3" class="d">-            let plan = match plan.optimize(&amp;mut txn) {
</a><a href="#h12-1-4" id="h12-1-4" class="i">+            let plan = match plan.optimize() {
</a>                 Ok(plan) =&gt; plan,
                 Err(err) =&gt; {
                     write!(f, &quot;{:?}&quot;, err)?;
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a> b/<a href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -105,7 +105,33 @@ Plan: Select(
</a>             source: Projection {
                 source: Filter {
                     source: Scan {
<a href="#h13-0-3" id="h13-0-3" class="d">-                        table: &quot;booleans&quot;,
</a><a href="#h13-0-4" id="h13-0-4" class="i">+                        table: Table {
</a><a href="#h13-0-5" id="h13-0-5" class="i">+                            name: &quot;booleans&quot;,
</a><a href="#h13-0-6" id="h13-0-6" class="i">+                            columns: [
</a><a href="#h13-0-7" id="h13-0-7" class="i">+                                Column {
</a><a href="#h13-0-8" id="h13-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h13-0-9" id="h13-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h13-0-10" id="h13-0-10" class="i">+                                    primary_key: true,
</a><a href="#h13-0-11" id="h13-0-11" class="i">+                                    nullable: false,
</a><a href="#h13-0-12" id="h13-0-12" class="i">+                                    default: None,
</a><a href="#h13-0-13" id="h13-0-13" class="i">+                                    unique: true,
</a><a href="#h13-0-14" id="h13-0-14" class="i">+                                    references: None,
</a><a href="#h13-0-15" id="h13-0-15" class="i">+                                    index: false,
</a><a href="#h13-0-16" id="h13-0-16" class="i">+                                },
</a><a href="#h13-0-17" id="h13-0-17" class="i">+                                Column {
</a><a href="#h13-0-18" id="h13-0-18" class="i">+                                    name: &quot;b&quot;,
</a><a href="#h13-0-19" id="h13-0-19" class="i">+                                    datatype: Boolean,
</a><a href="#h13-0-20" id="h13-0-20" class="i">+                                    primary_key: false,
</a><a href="#h13-0-21" id="h13-0-21" class="i">+                                    nullable: true,
</a><a href="#h13-0-22" id="h13-0-22" class="i">+                                    default: Some(
</a><a href="#h13-0-23" id="h13-0-23" class="i">+                                        Null,
</a><a href="#h13-0-24" id="h13-0-24" class="i">+                                    ),
</a><a href="#h13-0-25" id="h13-0-25" class="i">+                                    unique: false,
</a><a href="#h13-0-26" id="h13-0-26" class="i">+                                    references: None,
</a><a href="#h13-0-27" id="h13-0-27" class="i">+                                    index: false,
</a><a href="#h13-0-28" id="h13-0-28" class="i">+                                },
</a><a href="#h13-0-29" id="h13-0-29" class="i">+                            ],
</a><a href="#h13-0-30" id="h13-0-30" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h13-1" id="h13-1" class="h">@@ -239,7 +265,33 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h13-1-3" id="h13-1-3" class="d">-                    table: &quot;booleans&quot;,
</a><a href="#h13-1-4" id="h13-1-4" class="i">+                    table: Table {
</a><a href="#h13-1-5" id="h13-1-5" class="i">+                        name: &quot;booleans&quot;,
</a><a href="#h13-1-6" id="h13-1-6" class="i">+                        columns: [
</a><a href="#h13-1-7" id="h13-1-7" class="i">+                            Column {
</a><a href="#h13-1-8" id="h13-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h13-1-9" id="h13-1-9" class="i">+                                datatype: Integer,
</a><a href="#h13-1-10" id="h13-1-10" class="i">+                                primary_key: true,
</a><a href="#h13-1-11" id="h13-1-11" class="i">+                                nullable: false,
</a><a href="#h13-1-12" id="h13-1-12" class="i">+                                default: None,
</a><a href="#h13-1-13" id="h13-1-13" class="i">+                                unique: true,
</a><a href="#h13-1-14" id="h13-1-14" class="i">+                                references: None,
</a><a href="#h13-1-15" id="h13-1-15" class="i">+                                index: false,
</a><a href="#h13-1-16" id="h13-1-16" class="i">+                            },
</a><a href="#h13-1-17" id="h13-1-17" class="i">+                            Column {
</a><a href="#h13-1-18" id="h13-1-18" class="i">+                                name: &quot;b&quot;,
</a><a href="#h13-1-19" id="h13-1-19" class="i">+                                datatype: Boolean,
</a><a href="#h13-1-20" id="h13-1-20" class="i">+                                primary_key: false,
</a><a href="#h13-1-21" id="h13-1-21" class="i">+                                nullable: true,
</a><a href="#h13-1-22" id="h13-1-22" class="i">+                                default: Some(
</a><a href="#h13-1-23" id="h13-1-23" class="i">+                                    Null,
</a><a href="#h13-1-24" id="h13-1-24" class="i">+                                ),
</a><a href="#h13-1-25" id="h13-1-25" class="i">+                                unique: false,
</a><a href="#h13-1-26" id="h13-1-26" class="i">+                                references: None,
</a><a href="#h13-1-27" id="h13-1-27" class="i">+                                index: false,
</a><a href="#h13-1-28" id="h13-1-28" class="i">+                            },
</a><a href="#h13-1-29" id="h13-1-29" class="i">+                        ],
</a><a href="#h13-1-30" id="h13-1-30" class="i">+                    },
</a>                     alias: None,
                     filter: Some(
                         Not(
<b>diff --git a/<a id="h14" href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a> b/<a href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -91,7 +91,33 @@ Plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h14-0-3" id="h14-0-3" class="d">-                    table: &quot;booleans&quot;,
</a><a href="#h14-0-4" id="h14-0-4" class="i">+                    table: Table {
</a><a href="#h14-0-5" id="h14-0-5" class="i">+                        name: &quot;booleans&quot;,
</a><a href="#h14-0-6" id="h14-0-6" class="i">+                        columns: [
</a><a href="#h14-0-7" id="h14-0-7" class="i">+                            Column {
</a><a href="#h14-0-8" id="h14-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h14-0-9" id="h14-0-9" class="i">+                                datatype: Integer,
</a><a href="#h14-0-10" id="h14-0-10" class="i">+                                primary_key: true,
</a><a href="#h14-0-11" id="h14-0-11" class="i">+                                nullable: false,
</a><a href="#h14-0-12" id="h14-0-12" class="i">+                                default: None,
</a><a href="#h14-0-13" id="h14-0-13" class="i">+                                unique: true,
</a><a href="#h14-0-14" id="h14-0-14" class="i">+                                references: None,
</a><a href="#h14-0-15" id="h14-0-15" class="i">+                                index: false,
</a><a href="#h14-0-16" id="h14-0-16" class="i">+                            },
</a><a href="#h14-0-17" id="h14-0-17" class="i">+                            Column {
</a><a href="#h14-0-18" id="h14-0-18" class="i">+                                name: &quot;b&quot;,
</a><a href="#h14-0-19" id="h14-0-19" class="i">+                                datatype: Boolean,
</a><a href="#h14-0-20" id="h14-0-20" class="i">+                                primary_key: false,
</a><a href="#h14-0-21" id="h14-0-21" class="i">+                                nullable: true,
</a><a href="#h14-0-22" id="h14-0-22" class="i">+                                default: Some(
</a><a href="#h14-0-23" id="h14-0-23" class="i">+                                    Null,
</a><a href="#h14-0-24" id="h14-0-24" class="i">+                                ),
</a><a href="#h14-0-25" id="h14-0-25" class="i">+                                unique: false,
</a><a href="#h14-0-26" id="h14-0-26" class="i">+                                references: None,
</a><a href="#h14-0-27" id="h14-0-27" class="i">+                                index: false,
</a><a href="#h14-0-28" id="h14-0-28" class="i">+                            },
</a><a href="#h14-0-29" id="h14-0-29" class="i">+                        ],
</a><a href="#h14-0-30" id="h14-0-30" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h14-1" id="h14-1" class="h">@@ -211,7 +237,33 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h14-1-3" id="h14-1-3" class="d">-                    table: &quot;booleans&quot;,
</a><a href="#h14-1-4" id="h14-1-4" class="i">+                    table: Table {
</a><a href="#h14-1-5" id="h14-1-5" class="i">+                        name: &quot;booleans&quot;,
</a><a href="#h14-1-6" id="h14-1-6" class="i">+                        columns: [
</a><a href="#h14-1-7" id="h14-1-7" class="i">+                            Column {
</a><a href="#h14-1-8" id="h14-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h14-1-9" id="h14-1-9" class="i">+                                datatype: Integer,
</a><a href="#h14-1-10" id="h14-1-10" class="i">+                                primary_key: true,
</a><a href="#h14-1-11" id="h14-1-11" class="i">+                                nullable: false,
</a><a href="#h14-1-12" id="h14-1-12" class="i">+                                default: None,
</a><a href="#h14-1-13" id="h14-1-13" class="i">+                                unique: true,
</a><a href="#h14-1-14" id="h14-1-14" class="i">+                                references: None,
</a><a href="#h14-1-15" id="h14-1-15" class="i">+                                index: false,
</a><a href="#h14-1-16" id="h14-1-16" class="i">+                            },
</a><a href="#h14-1-17" id="h14-1-17" class="i">+                            Column {
</a><a href="#h14-1-18" id="h14-1-18" class="i">+                                name: &quot;b&quot;,
</a><a href="#h14-1-19" id="h14-1-19" class="i">+                                datatype: Boolean,
</a><a href="#h14-1-20" id="h14-1-20" class="i">+                                primary_key: false,
</a><a href="#h14-1-21" id="h14-1-21" class="i">+                                nullable: true,
</a><a href="#h14-1-22" id="h14-1-22" class="i">+                                default: Some(
</a><a href="#h14-1-23" id="h14-1-23" class="i">+                                    Null,
</a><a href="#h14-1-24" id="h14-1-24" class="i">+                                ),
</a><a href="#h14-1-25" id="h14-1-25" class="i">+                                unique: false,
</a><a href="#h14-1-26" id="h14-1-26" class="i">+                                references: None,
</a><a href="#h14-1-27" id="h14-1-27" class="i">+                                index: false,
</a><a href="#h14-1-28" id="h14-1-28" class="i">+                            },
</a><a href="#h14-1-29" id="h14-1-29" class="i">+                        ],
</a><a href="#h14-1-30" id="h14-1-30" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a> b/<a href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -96,7 +96,31 @@ Plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h15-0-3" id="h15-0-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h15-0-4" id="h15-0-4" class="i">+                    table: Table {
</a><a href="#h15-0-5" id="h15-0-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h15-0-6" id="h15-0-6" class="i">+                        columns: [
</a><a href="#h15-0-7" id="h15-0-7" class="i">+                            Column {
</a><a href="#h15-0-8" id="h15-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h15-0-9" id="h15-0-9" class="i">+                                datatype: Integer,
</a><a href="#h15-0-10" id="h15-0-10" class="i">+                                primary_key: true,
</a><a href="#h15-0-11" id="h15-0-11" class="i">+                                nullable: false,
</a><a href="#h15-0-12" id="h15-0-12" class="i">+                                default: None,
</a><a href="#h15-0-13" id="h15-0-13" class="i">+                                unique: true,
</a><a href="#h15-0-14" id="h15-0-14" class="i">+                                references: None,
</a><a href="#h15-0-15" id="h15-0-15" class="i">+                                index: false,
</a><a href="#h15-0-16" id="h15-0-16" class="i">+                            },
</a><a href="#h15-0-17" id="h15-0-17" class="i">+                            Column {
</a><a href="#h15-0-18" id="h15-0-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h15-0-19" id="h15-0-19" class="i">+                                datatype: String,
</a><a href="#h15-0-20" id="h15-0-20" class="i">+                                primary_key: false,
</a><a href="#h15-0-21" id="h15-0-21" class="i">+                                nullable: false,
</a><a href="#h15-0-22" id="h15-0-22" class="i">+                                default: None,
</a><a href="#h15-0-23" id="h15-0-23" class="i">+                                unique: false,
</a><a href="#h15-0-24" id="h15-0-24" class="i">+                                references: None,
</a><a href="#h15-0-25" id="h15-0-25" class="i">+                                index: false,
</a><a href="#h15-0-26" id="h15-0-26" class="i">+                            },
</a><a href="#h15-0-27" id="h15-0-27" class="i">+                        ],
</a><a href="#h15-0-28" id="h15-0-28" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h15-1" id="h15-1" class="h">@@ -196,7 +220,31 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h15-1-3" id="h15-1-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h15-1-4" id="h15-1-4" class="i">+                    table: Table {
</a><a href="#h15-1-5" id="h15-1-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h15-1-6" id="h15-1-6" class="i">+                        columns: [
</a><a href="#h15-1-7" id="h15-1-7" class="i">+                            Column {
</a><a href="#h15-1-8" id="h15-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h15-1-9" id="h15-1-9" class="i">+                                datatype: Integer,
</a><a href="#h15-1-10" id="h15-1-10" class="i">+                                primary_key: true,
</a><a href="#h15-1-11" id="h15-1-11" class="i">+                                nullable: false,
</a><a href="#h15-1-12" id="h15-1-12" class="i">+                                default: None,
</a><a href="#h15-1-13" id="h15-1-13" class="i">+                                unique: true,
</a><a href="#h15-1-14" id="h15-1-14" class="i">+                                references: None,
</a><a href="#h15-1-15" id="h15-1-15" class="i">+                                index: false,
</a><a href="#h15-1-16" id="h15-1-16" class="i">+                            },
</a><a href="#h15-1-17" id="h15-1-17" class="i">+                            Column {
</a><a href="#h15-1-18" id="h15-1-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h15-1-19" id="h15-1-19" class="i">+                                datatype: String,
</a><a href="#h15-1-20" id="h15-1-20" class="i">+                                primary_key: false,
</a><a href="#h15-1-21" id="h15-1-21" class="i">+                                nullable: false,
</a><a href="#h15-1-22" id="h15-1-22" class="i">+                                default: None,
</a><a href="#h15-1-23" id="h15-1-23" class="i">+                                unique: false,
</a><a href="#h15-1-24" id="h15-1-24" class="i">+                                references: None,
</a><a href="#h15-1-25" id="h15-1-25" class="i">+                                index: false,
</a><a href="#h15-1-26" id="h15-1-26" class="i">+                            },
</a><a href="#h15-1-27" id="h15-1-27" class="i">+                        ],
</a><a href="#h15-1-28" id="h15-1-28" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a> b/<a href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -44,7 +44,89 @@ Plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h16-0-3" id="h16-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h16-0-4" id="h16-0-4" class="i">+                    table: Table {
</a><a href="#h16-0-5" id="h16-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h16-0-6" id="h16-0-6" class="i">+                        columns: [
</a><a href="#h16-0-7" id="h16-0-7" class="i">+                            Column {
</a><a href="#h16-0-8" id="h16-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h16-0-9" id="h16-0-9" class="i">+                                datatype: Integer,
</a><a href="#h16-0-10" id="h16-0-10" class="i">+                                primary_key: true,
</a><a href="#h16-0-11" id="h16-0-11" class="i">+                                nullable: false,
</a><a href="#h16-0-12" id="h16-0-12" class="i">+                                default: None,
</a><a href="#h16-0-13" id="h16-0-13" class="i">+                                unique: true,
</a><a href="#h16-0-14" id="h16-0-14" class="i">+                                references: None,
</a><a href="#h16-0-15" id="h16-0-15" class="i">+                                index: false,
</a><a href="#h16-0-16" id="h16-0-16" class="i">+                            },
</a><a href="#h16-0-17" id="h16-0-17" class="i">+                            Column {
</a><a href="#h16-0-18" id="h16-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h16-0-19" id="h16-0-19" class="i">+                                datatype: String,
</a><a href="#h16-0-20" id="h16-0-20" class="i">+                                primary_key: false,
</a><a href="#h16-0-21" id="h16-0-21" class="i">+                                nullable: false,
</a><a href="#h16-0-22" id="h16-0-22" class="i">+                                default: None,
</a><a href="#h16-0-23" id="h16-0-23" class="i">+                                unique: false,
</a><a href="#h16-0-24" id="h16-0-24" class="i">+                                references: None,
</a><a href="#h16-0-25" id="h16-0-25" class="i">+                                index: false,
</a><a href="#h16-0-26" id="h16-0-26" class="i">+                            },
</a><a href="#h16-0-27" id="h16-0-27" class="i">+                            Column {
</a><a href="#h16-0-28" id="h16-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h16-0-29" id="h16-0-29" class="i">+                                datatype: Integer,
</a><a href="#h16-0-30" id="h16-0-30" class="i">+                                primary_key: false,
</a><a href="#h16-0-31" id="h16-0-31" class="i">+                                nullable: false,
</a><a href="#h16-0-32" id="h16-0-32" class="i">+                                default: None,
</a><a href="#h16-0-33" id="h16-0-33" class="i">+                                unique: false,
</a><a href="#h16-0-34" id="h16-0-34" class="i">+                                references: Some(
</a><a href="#h16-0-35" id="h16-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h16-0-36" id="h16-0-36" class="i">+                                ),
</a><a href="#h16-0-37" id="h16-0-37" class="i">+                                index: true,
</a><a href="#h16-0-38" id="h16-0-38" class="i">+                            },
</a><a href="#h16-0-39" id="h16-0-39" class="i">+                            Column {
</a><a href="#h16-0-40" id="h16-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h16-0-41" id="h16-0-41" class="i">+                                datatype: Integer,
</a><a href="#h16-0-42" id="h16-0-42" class="i">+                                primary_key: false,
</a><a href="#h16-0-43" id="h16-0-43" class="i">+                                nullable: false,
</a><a href="#h16-0-44" id="h16-0-44" class="i">+                                default: None,
</a><a href="#h16-0-45" id="h16-0-45" class="i">+                                unique: false,
</a><a href="#h16-0-46" id="h16-0-46" class="i">+                                references: Some(
</a><a href="#h16-0-47" id="h16-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h16-0-48" id="h16-0-48" class="i">+                                ),
</a><a href="#h16-0-49" id="h16-0-49" class="i">+                                index: true,
</a><a href="#h16-0-50" id="h16-0-50" class="i">+                            },
</a><a href="#h16-0-51" id="h16-0-51" class="i">+                            Column {
</a><a href="#h16-0-52" id="h16-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h16-0-53" id="h16-0-53" class="i">+                                datatype: Integer,
</a><a href="#h16-0-54" id="h16-0-54" class="i">+                                primary_key: false,
</a><a href="#h16-0-55" id="h16-0-55" class="i">+                                nullable: false,
</a><a href="#h16-0-56" id="h16-0-56" class="i">+                                default: None,
</a><a href="#h16-0-57" id="h16-0-57" class="i">+                                unique: false,
</a><a href="#h16-0-58" id="h16-0-58" class="i">+                                references: None,
</a><a href="#h16-0-59" id="h16-0-59" class="i">+                                index: false,
</a><a href="#h16-0-60" id="h16-0-60" class="i">+                            },
</a><a href="#h16-0-61" id="h16-0-61" class="i">+                            Column {
</a><a href="#h16-0-62" id="h16-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h16-0-63" id="h16-0-63" class="i">+                                datatype: Float,
</a><a href="#h16-0-64" id="h16-0-64" class="i">+                                primary_key: false,
</a><a href="#h16-0-65" id="h16-0-65" class="i">+                                nullable: true,
</a><a href="#h16-0-66" id="h16-0-66" class="i">+                                default: Some(
</a><a href="#h16-0-67" id="h16-0-67" class="i">+                                    Null,
</a><a href="#h16-0-68" id="h16-0-68" class="i">+                                ),
</a><a href="#h16-0-69" id="h16-0-69" class="i">+                                unique: false,
</a><a href="#h16-0-70" id="h16-0-70" class="i">+                                references: None,
</a><a href="#h16-0-71" id="h16-0-71" class="i">+                                index: false,
</a><a href="#h16-0-72" id="h16-0-72" class="i">+                            },
</a><a href="#h16-0-73" id="h16-0-73" class="i">+                            Column {
</a><a href="#h16-0-74" id="h16-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h16-0-75" id="h16-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h16-0-76" id="h16-0-76" class="i">+                                primary_key: false,
</a><a href="#h16-0-77" id="h16-0-77" class="i">+                                nullable: true,
</a><a href="#h16-0-78" id="h16-0-78" class="i">+                                default: Some(
</a><a href="#h16-0-79" id="h16-0-79" class="i">+                                    Null,
</a><a href="#h16-0-80" id="h16-0-80" class="i">+                                ),
</a><a href="#h16-0-81" id="h16-0-81" class="i">+                                unique: false,
</a><a href="#h16-0-82" id="h16-0-82" class="i">+                                references: None,
</a><a href="#h16-0-83" id="h16-0-83" class="i">+                                index: false,
</a><a href="#h16-0-84" id="h16-0-84" class="i">+                            },
</a><a href="#h16-0-85" id="h16-0-85" class="i">+                        ],
</a><a href="#h16-0-86" id="h16-0-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h16-1" id="h16-1" class="h">@@ -80,7 +162,89 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h16-1-3" id="h16-1-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h16-1-4" id="h16-1-4" class="i">+                    table: Table {
</a><a href="#h16-1-5" id="h16-1-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h16-1-6" id="h16-1-6" class="i">+                        columns: [
</a><a href="#h16-1-7" id="h16-1-7" class="i">+                            Column {
</a><a href="#h16-1-8" id="h16-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h16-1-9" id="h16-1-9" class="i">+                                datatype: Integer,
</a><a href="#h16-1-10" id="h16-1-10" class="i">+                                primary_key: true,
</a><a href="#h16-1-11" id="h16-1-11" class="i">+                                nullable: false,
</a><a href="#h16-1-12" id="h16-1-12" class="i">+                                default: None,
</a><a href="#h16-1-13" id="h16-1-13" class="i">+                                unique: true,
</a><a href="#h16-1-14" id="h16-1-14" class="i">+                                references: None,
</a><a href="#h16-1-15" id="h16-1-15" class="i">+                                index: false,
</a><a href="#h16-1-16" id="h16-1-16" class="i">+                            },
</a><a href="#h16-1-17" id="h16-1-17" class="i">+                            Column {
</a><a href="#h16-1-18" id="h16-1-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h16-1-19" id="h16-1-19" class="i">+                                datatype: String,
</a><a href="#h16-1-20" id="h16-1-20" class="i">+                                primary_key: false,
</a><a href="#h16-1-21" id="h16-1-21" class="i">+                                nullable: false,
</a><a href="#h16-1-22" id="h16-1-22" class="i">+                                default: None,
</a><a href="#h16-1-23" id="h16-1-23" class="i">+                                unique: false,
</a><a href="#h16-1-24" id="h16-1-24" class="i">+                                references: None,
</a><a href="#h16-1-25" id="h16-1-25" class="i">+                                index: false,
</a><a href="#h16-1-26" id="h16-1-26" class="i">+                            },
</a><a href="#h16-1-27" id="h16-1-27" class="i">+                            Column {
</a><a href="#h16-1-28" id="h16-1-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h16-1-29" id="h16-1-29" class="i">+                                datatype: Integer,
</a><a href="#h16-1-30" id="h16-1-30" class="i">+                                primary_key: false,
</a><a href="#h16-1-31" id="h16-1-31" class="i">+                                nullable: false,
</a><a href="#h16-1-32" id="h16-1-32" class="i">+                                default: None,
</a><a href="#h16-1-33" id="h16-1-33" class="i">+                                unique: false,
</a><a href="#h16-1-34" id="h16-1-34" class="i">+                                references: Some(
</a><a href="#h16-1-35" id="h16-1-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h16-1-36" id="h16-1-36" class="i">+                                ),
</a><a href="#h16-1-37" id="h16-1-37" class="i">+                                index: true,
</a><a href="#h16-1-38" id="h16-1-38" class="i">+                            },
</a><a href="#h16-1-39" id="h16-1-39" class="i">+                            Column {
</a><a href="#h16-1-40" id="h16-1-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h16-1-41" id="h16-1-41" class="i">+                                datatype: Integer,
</a><a href="#h16-1-42" id="h16-1-42" class="i">+                                primary_key: false,
</a><a href="#h16-1-43" id="h16-1-43" class="i">+                                nullable: false,
</a><a href="#h16-1-44" id="h16-1-44" class="i">+                                default: None,
</a><a href="#h16-1-45" id="h16-1-45" class="i">+                                unique: false,
</a><a href="#h16-1-46" id="h16-1-46" class="i">+                                references: Some(
</a><a href="#h16-1-47" id="h16-1-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h16-1-48" id="h16-1-48" class="i">+                                ),
</a><a href="#h16-1-49" id="h16-1-49" class="i">+                                index: true,
</a><a href="#h16-1-50" id="h16-1-50" class="i">+                            },
</a><a href="#h16-1-51" id="h16-1-51" class="i">+                            Column {
</a><a href="#h16-1-52" id="h16-1-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h16-1-53" id="h16-1-53" class="i">+                                datatype: Integer,
</a><a href="#h16-1-54" id="h16-1-54" class="i">+                                primary_key: false,
</a><a href="#h16-1-55" id="h16-1-55" class="i">+                                nullable: false,
</a><a href="#h16-1-56" id="h16-1-56" class="i">+                                default: None,
</a><a href="#h16-1-57" id="h16-1-57" class="i">+                                unique: false,
</a><a href="#h16-1-58" id="h16-1-58" class="i">+                                references: None,
</a><a href="#h16-1-59" id="h16-1-59" class="i">+                                index: false,
</a><a href="#h16-1-60" id="h16-1-60" class="i">+                            },
</a><a href="#h16-1-61" id="h16-1-61" class="i">+                            Column {
</a><a href="#h16-1-62" id="h16-1-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h16-1-63" id="h16-1-63" class="i">+                                datatype: Float,
</a><a href="#h16-1-64" id="h16-1-64" class="i">+                                primary_key: false,
</a><a href="#h16-1-65" id="h16-1-65" class="i">+                                nullable: true,
</a><a href="#h16-1-66" id="h16-1-66" class="i">+                                default: Some(
</a><a href="#h16-1-67" id="h16-1-67" class="i">+                                    Null,
</a><a href="#h16-1-68" id="h16-1-68" class="i">+                                ),
</a><a href="#h16-1-69" id="h16-1-69" class="i">+                                unique: false,
</a><a href="#h16-1-70" id="h16-1-70" class="i">+                                references: None,
</a><a href="#h16-1-71" id="h16-1-71" class="i">+                                index: false,
</a><a href="#h16-1-72" id="h16-1-72" class="i">+                            },
</a><a href="#h16-1-73" id="h16-1-73" class="i">+                            Column {
</a><a href="#h16-1-74" id="h16-1-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h16-1-75" id="h16-1-75" class="i">+                                datatype: Boolean,
</a><a href="#h16-1-76" id="h16-1-76" class="i">+                                primary_key: false,
</a><a href="#h16-1-77" id="h16-1-77" class="i">+                                nullable: true,
</a><a href="#h16-1-78" id="h16-1-78" class="i">+                                default: Some(
</a><a href="#h16-1-79" id="h16-1-79" class="i">+                                    Null,
</a><a href="#h16-1-80" id="h16-1-80" class="i">+                                ),
</a><a href="#h16-1-81" id="h16-1-81" class="i">+                                unique: false,
</a><a href="#h16-1-82" id="h16-1-82" class="i">+                                references: None,
</a><a href="#h16-1-83" id="h16-1-83" class="i">+                                index: false,
</a><a href="#h16-1-84" id="h16-1-84" class="i">+                            },
</a><a href="#h16-1-85" id="h16-1-85" class="i">+                        ],
</a><a href="#h16-1-86" id="h16-1-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a> b/<a href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -66,7 +66,89 @@ Plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h17-0-3" id="h17-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h17-0-4" id="h17-0-4" class="i">+                    table: Table {
</a><a href="#h17-0-5" id="h17-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h17-0-6" id="h17-0-6" class="i">+                        columns: [
</a><a href="#h17-0-7" id="h17-0-7" class="i">+                            Column {
</a><a href="#h17-0-8" id="h17-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h17-0-9" id="h17-0-9" class="i">+                                datatype: Integer,
</a><a href="#h17-0-10" id="h17-0-10" class="i">+                                primary_key: true,
</a><a href="#h17-0-11" id="h17-0-11" class="i">+                                nullable: false,
</a><a href="#h17-0-12" id="h17-0-12" class="i">+                                default: None,
</a><a href="#h17-0-13" id="h17-0-13" class="i">+                                unique: true,
</a><a href="#h17-0-14" id="h17-0-14" class="i">+                                references: None,
</a><a href="#h17-0-15" id="h17-0-15" class="i">+                                index: false,
</a><a href="#h17-0-16" id="h17-0-16" class="i">+                            },
</a><a href="#h17-0-17" id="h17-0-17" class="i">+                            Column {
</a><a href="#h17-0-18" id="h17-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h17-0-19" id="h17-0-19" class="i">+                                datatype: String,
</a><a href="#h17-0-20" id="h17-0-20" class="i">+                                primary_key: false,
</a><a href="#h17-0-21" id="h17-0-21" class="i">+                                nullable: false,
</a><a href="#h17-0-22" id="h17-0-22" class="i">+                                default: None,
</a><a href="#h17-0-23" id="h17-0-23" class="i">+                                unique: false,
</a><a href="#h17-0-24" id="h17-0-24" class="i">+                                references: None,
</a><a href="#h17-0-25" id="h17-0-25" class="i">+                                index: false,
</a><a href="#h17-0-26" id="h17-0-26" class="i">+                            },
</a><a href="#h17-0-27" id="h17-0-27" class="i">+                            Column {
</a><a href="#h17-0-28" id="h17-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h17-0-29" id="h17-0-29" class="i">+                                datatype: Integer,
</a><a href="#h17-0-30" id="h17-0-30" class="i">+                                primary_key: false,
</a><a href="#h17-0-31" id="h17-0-31" class="i">+                                nullable: false,
</a><a href="#h17-0-32" id="h17-0-32" class="i">+                                default: None,
</a><a href="#h17-0-33" id="h17-0-33" class="i">+                                unique: false,
</a><a href="#h17-0-34" id="h17-0-34" class="i">+                                references: Some(
</a><a href="#h17-0-35" id="h17-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h17-0-36" id="h17-0-36" class="i">+                                ),
</a><a href="#h17-0-37" id="h17-0-37" class="i">+                                index: true,
</a><a href="#h17-0-38" id="h17-0-38" class="i">+                            },
</a><a href="#h17-0-39" id="h17-0-39" class="i">+                            Column {
</a><a href="#h17-0-40" id="h17-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h17-0-41" id="h17-0-41" class="i">+                                datatype: Integer,
</a><a href="#h17-0-42" id="h17-0-42" class="i">+                                primary_key: false,
</a><a href="#h17-0-43" id="h17-0-43" class="i">+                                nullable: false,
</a><a href="#h17-0-44" id="h17-0-44" class="i">+                                default: None,
</a><a href="#h17-0-45" id="h17-0-45" class="i">+                                unique: false,
</a><a href="#h17-0-46" id="h17-0-46" class="i">+                                references: Some(
</a><a href="#h17-0-47" id="h17-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h17-0-48" id="h17-0-48" class="i">+                                ),
</a><a href="#h17-0-49" id="h17-0-49" class="i">+                                index: true,
</a><a href="#h17-0-50" id="h17-0-50" class="i">+                            },
</a><a href="#h17-0-51" id="h17-0-51" class="i">+                            Column {
</a><a href="#h17-0-52" id="h17-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h17-0-53" id="h17-0-53" class="i">+                                datatype: Integer,
</a><a href="#h17-0-54" id="h17-0-54" class="i">+                                primary_key: false,
</a><a href="#h17-0-55" id="h17-0-55" class="i">+                                nullable: false,
</a><a href="#h17-0-56" id="h17-0-56" class="i">+                                default: None,
</a><a href="#h17-0-57" id="h17-0-57" class="i">+                                unique: false,
</a><a href="#h17-0-58" id="h17-0-58" class="i">+                                references: None,
</a><a href="#h17-0-59" id="h17-0-59" class="i">+                                index: false,
</a><a href="#h17-0-60" id="h17-0-60" class="i">+                            },
</a><a href="#h17-0-61" id="h17-0-61" class="i">+                            Column {
</a><a href="#h17-0-62" id="h17-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h17-0-63" id="h17-0-63" class="i">+                                datatype: Float,
</a><a href="#h17-0-64" id="h17-0-64" class="i">+                                primary_key: false,
</a><a href="#h17-0-65" id="h17-0-65" class="i">+                                nullable: true,
</a><a href="#h17-0-66" id="h17-0-66" class="i">+                                default: Some(
</a><a href="#h17-0-67" id="h17-0-67" class="i">+                                    Null,
</a><a href="#h17-0-68" id="h17-0-68" class="i">+                                ),
</a><a href="#h17-0-69" id="h17-0-69" class="i">+                                unique: false,
</a><a href="#h17-0-70" id="h17-0-70" class="i">+                                references: None,
</a><a href="#h17-0-71" id="h17-0-71" class="i">+                                index: false,
</a><a href="#h17-0-72" id="h17-0-72" class="i">+                            },
</a><a href="#h17-0-73" id="h17-0-73" class="i">+                            Column {
</a><a href="#h17-0-74" id="h17-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h17-0-75" id="h17-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h17-0-76" id="h17-0-76" class="i">+                                primary_key: false,
</a><a href="#h17-0-77" id="h17-0-77" class="i">+                                nullable: true,
</a><a href="#h17-0-78" id="h17-0-78" class="i">+                                default: Some(
</a><a href="#h17-0-79" id="h17-0-79" class="i">+                                    Null,
</a><a href="#h17-0-80" id="h17-0-80" class="i">+                                ),
</a><a href="#h17-0-81" id="h17-0-81" class="i">+                                unique: false,
</a><a href="#h17-0-82" id="h17-0-82" class="i">+                                references: None,
</a><a href="#h17-0-83" id="h17-0-83" class="i">+                                index: false,
</a><a href="#h17-0-84" id="h17-0-84" class="i">+                            },
</a><a href="#h17-0-85" id="h17-0-85" class="i">+                        ],
</a><a href="#h17-0-86" id="h17-0-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h17-1" id="h17-1" class="h">@@ -128,7 +210,89 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h17-1-3" id="h17-1-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h17-1-4" id="h17-1-4" class="i">+                    table: Table {
</a><a href="#h17-1-5" id="h17-1-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h17-1-6" id="h17-1-6" class="i">+                        columns: [
</a><a href="#h17-1-7" id="h17-1-7" class="i">+                            Column {
</a><a href="#h17-1-8" id="h17-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h17-1-9" id="h17-1-9" class="i">+                                datatype: Integer,
</a><a href="#h17-1-10" id="h17-1-10" class="i">+                                primary_key: true,
</a><a href="#h17-1-11" id="h17-1-11" class="i">+                                nullable: false,
</a><a href="#h17-1-12" id="h17-1-12" class="i">+                                default: None,
</a><a href="#h17-1-13" id="h17-1-13" class="i">+                                unique: true,
</a><a href="#h17-1-14" id="h17-1-14" class="i">+                                references: None,
</a><a href="#h17-1-15" id="h17-1-15" class="i">+                                index: false,
</a><a href="#h17-1-16" id="h17-1-16" class="i">+                            },
</a><a href="#h17-1-17" id="h17-1-17" class="i">+                            Column {
</a><a href="#h17-1-18" id="h17-1-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h17-1-19" id="h17-1-19" class="i">+                                datatype: String,
</a><a href="#h17-1-20" id="h17-1-20" class="i">+                                primary_key: false,
</a><a href="#h17-1-21" id="h17-1-21" class="i">+                                nullable: false,
</a><a href="#h17-1-22" id="h17-1-22" class="i">+                                default: None,
</a><a href="#h17-1-23" id="h17-1-23" class="i">+                                unique: false,
</a><a href="#h17-1-24" id="h17-1-24" class="i">+                                references: None,
</a><a href="#h17-1-25" id="h17-1-25" class="i">+                                index: false,
</a><a href="#h17-1-26" id="h17-1-26" class="i">+                            },
</a><a href="#h17-1-27" id="h17-1-27" class="i">+                            Column {
</a><a href="#h17-1-28" id="h17-1-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h17-1-29" id="h17-1-29" class="i">+                                datatype: Integer,
</a><a href="#h17-1-30" id="h17-1-30" class="i">+                                primary_key: false,
</a><a href="#h17-1-31" id="h17-1-31" class="i">+                                nullable: false,
</a><a href="#h17-1-32" id="h17-1-32" class="i">+                                default: None,
</a><a href="#h17-1-33" id="h17-1-33" class="i">+                                unique: false,
</a><a href="#h17-1-34" id="h17-1-34" class="i">+                                references: Some(
</a><a href="#h17-1-35" id="h17-1-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h17-1-36" id="h17-1-36" class="i">+                                ),
</a><a href="#h17-1-37" id="h17-1-37" class="i">+                                index: true,
</a><a href="#h17-1-38" id="h17-1-38" class="i">+                            },
</a><a href="#h17-1-39" id="h17-1-39" class="i">+                            Column {
</a><a href="#h17-1-40" id="h17-1-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h17-1-41" id="h17-1-41" class="i">+                                datatype: Integer,
</a><a href="#h17-1-42" id="h17-1-42" class="i">+                                primary_key: false,
</a><a href="#h17-1-43" id="h17-1-43" class="i">+                                nullable: false,
</a><a href="#h17-1-44" id="h17-1-44" class="i">+                                default: None,
</a><a href="#h17-1-45" id="h17-1-45" class="i">+                                unique: false,
</a><a href="#h17-1-46" id="h17-1-46" class="i">+                                references: Some(
</a><a href="#h17-1-47" id="h17-1-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h17-1-48" id="h17-1-48" class="i">+                                ),
</a><a href="#h17-1-49" id="h17-1-49" class="i">+                                index: true,
</a><a href="#h17-1-50" id="h17-1-50" class="i">+                            },
</a><a href="#h17-1-51" id="h17-1-51" class="i">+                            Column {
</a><a href="#h17-1-52" id="h17-1-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h17-1-53" id="h17-1-53" class="i">+                                datatype: Integer,
</a><a href="#h17-1-54" id="h17-1-54" class="i">+                                primary_key: false,
</a><a href="#h17-1-55" id="h17-1-55" class="i">+                                nullable: false,
</a><a href="#h17-1-56" id="h17-1-56" class="i">+                                default: None,
</a><a href="#h17-1-57" id="h17-1-57" class="i">+                                unique: false,
</a><a href="#h17-1-58" id="h17-1-58" class="i">+                                references: None,
</a><a href="#h17-1-59" id="h17-1-59" class="i">+                                index: false,
</a><a href="#h17-1-60" id="h17-1-60" class="i">+                            },
</a><a href="#h17-1-61" id="h17-1-61" class="i">+                            Column {
</a><a href="#h17-1-62" id="h17-1-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h17-1-63" id="h17-1-63" class="i">+                                datatype: Float,
</a><a href="#h17-1-64" id="h17-1-64" class="i">+                                primary_key: false,
</a><a href="#h17-1-65" id="h17-1-65" class="i">+                                nullable: true,
</a><a href="#h17-1-66" id="h17-1-66" class="i">+                                default: Some(
</a><a href="#h17-1-67" id="h17-1-67" class="i">+                                    Null,
</a><a href="#h17-1-68" id="h17-1-68" class="i">+                                ),
</a><a href="#h17-1-69" id="h17-1-69" class="i">+                                unique: false,
</a><a href="#h17-1-70" id="h17-1-70" class="i">+                                references: None,
</a><a href="#h17-1-71" id="h17-1-71" class="i">+                                index: false,
</a><a href="#h17-1-72" id="h17-1-72" class="i">+                            },
</a><a href="#h17-1-73" id="h17-1-73" class="i">+                            Column {
</a><a href="#h17-1-74" id="h17-1-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h17-1-75" id="h17-1-75" class="i">+                                datatype: Boolean,
</a><a href="#h17-1-76" id="h17-1-76" class="i">+                                primary_key: false,
</a><a href="#h17-1-77" id="h17-1-77" class="i">+                                nullable: true,
</a><a href="#h17-1-78" id="h17-1-78" class="i">+                                default: Some(
</a><a href="#h17-1-79" id="h17-1-79" class="i">+                                    Null,
</a><a href="#h17-1-80" id="h17-1-80" class="i">+                                ),
</a><a href="#h17-1-81" id="h17-1-81" class="i">+                                unique: false,
</a><a href="#h17-1-82" id="h17-1-82" class="i">+                                references: None,
</a><a href="#h17-1-83" id="h17-1-83" class="i">+                                index: false,
</a><a href="#h17-1-84" id="h17-1-84" class="i">+                            },
</a><a href="#h17-1-85" id="h17-1-85" class="i">+                        ],
</a><a href="#h17-1-86" id="h17-1-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a> b/<a href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -105,7 +105,33 @@ Plan: Select(
</a>             source: Projection {
                 source: Filter {
                     source: Scan {
<a href="#h18-0-3" id="h18-0-3" class="d">-                        table: &quot;floats&quot;,
</a><a href="#h18-0-4" id="h18-0-4" class="i">+                        table: Table {
</a><a href="#h18-0-5" id="h18-0-5" class="i">+                            name: &quot;floats&quot;,
</a><a href="#h18-0-6" id="h18-0-6" class="i">+                            columns: [
</a><a href="#h18-0-7" id="h18-0-7" class="i">+                                Column {
</a><a href="#h18-0-8" id="h18-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h18-0-9" id="h18-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h18-0-10" id="h18-0-10" class="i">+                                    primary_key: true,
</a><a href="#h18-0-11" id="h18-0-11" class="i">+                                    nullable: false,
</a><a href="#h18-0-12" id="h18-0-12" class="i">+                                    default: None,
</a><a href="#h18-0-13" id="h18-0-13" class="i">+                                    unique: true,
</a><a href="#h18-0-14" id="h18-0-14" class="i">+                                    references: None,
</a><a href="#h18-0-15" id="h18-0-15" class="i">+                                    index: false,
</a><a href="#h18-0-16" id="h18-0-16" class="i">+                                },
</a><a href="#h18-0-17" id="h18-0-17" class="i">+                                Column {
</a><a href="#h18-0-18" id="h18-0-18" class="i">+                                    name: &quot;f&quot;,
</a><a href="#h18-0-19" id="h18-0-19" class="i">+                                    datatype: Float,
</a><a href="#h18-0-20" id="h18-0-20" class="i">+                                    primary_key: false,
</a><a href="#h18-0-21" id="h18-0-21" class="i">+                                    nullable: true,
</a><a href="#h18-0-22" id="h18-0-22" class="i">+                                    default: Some(
</a><a href="#h18-0-23" id="h18-0-23" class="i">+                                        Null,
</a><a href="#h18-0-24" id="h18-0-24" class="i">+                                    ),
</a><a href="#h18-0-25" id="h18-0-25" class="i">+                                    unique: false,
</a><a href="#h18-0-26" id="h18-0-26" class="i">+                                    references: None,
</a><a href="#h18-0-27" id="h18-0-27" class="i">+                                    index: false,
</a><a href="#h18-0-28" id="h18-0-28" class="i">+                                },
</a><a href="#h18-0-29" id="h18-0-29" class="i">+                            ],
</a><a href="#h18-0-30" id="h18-0-30" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h18-1" id="h18-1" class="h">@@ -239,7 +265,33 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h18-1-3" id="h18-1-3" class="d">-                    table: &quot;floats&quot;,
</a><a href="#h18-1-4" id="h18-1-4" class="i">+                    table: Table {
</a><a href="#h18-1-5" id="h18-1-5" class="i">+                        name: &quot;floats&quot;,
</a><a href="#h18-1-6" id="h18-1-6" class="i">+                        columns: [
</a><a href="#h18-1-7" id="h18-1-7" class="i">+                            Column {
</a><a href="#h18-1-8" id="h18-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h18-1-9" id="h18-1-9" class="i">+                                datatype: Integer,
</a><a href="#h18-1-10" id="h18-1-10" class="i">+                                primary_key: true,
</a><a href="#h18-1-11" id="h18-1-11" class="i">+                                nullable: false,
</a><a href="#h18-1-12" id="h18-1-12" class="i">+                                default: None,
</a><a href="#h18-1-13" id="h18-1-13" class="i">+                                unique: true,
</a><a href="#h18-1-14" id="h18-1-14" class="i">+                                references: None,
</a><a href="#h18-1-15" id="h18-1-15" class="i">+                                index: false,
</a><a href="#h18-1-16" id="h18-1-16" class="i">+                            },
</a><a href="#h18-1-17" id="h18-1-17" class="i">+                            Column {
</a><a href="#h18-1-18" id="h18-1-18" class="i">+                                name: &quot;f&quot;,
</a><a href="#h18-1-19" id="h18-1-19" class="i">+                                datatype: Float,
</a><a href="#h18-1-20" id="h18-1-20" class="i">+                                primary_key: false,
</a><a href="#h18-1-21" id="h18-1-21" class="i">+                                nullable: true,
</a><a href="#h18-1-22" id="h18-1-22" class="i">+                                default: Some(
</a><a href="#h18-1-23" id="h18-1-23" class="i">+                                    Null,
</a><a href="#h18-1-24" id="h18-1-24" class="i">+                                ),
</a><a href="#h18-1-25" id="h18-1-25" class="i">+                                unique: false,
</a><a href="#h18-1-26" id="h18-1-26" class="i">+                                references: None,
</a><a href="#h18-1-27" id="h18-1-27" class="i">+                                index: false,
</a><a href="#h18-1-28" id="h18-1-28" class="i">+                            },
</a><a href="#h18-1-29" id="h18-1-29" class="i">+                        ],
</a><a href="#h18-1-30" id="h18-1-30" class="i">+                    },
</a>                     alias: None,
                     filter: Some(
                         Not(
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a> b/<a href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -91,7 +91,33 @@ Plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h19-0-3" id="h19-0-3" class="d">-                    table: &quot;floats&quot;,
</a><a href="#h19-0-4" id="h19-0-4" class="i">+                    table: Table {
</a><a href="#h19-0-5" id="h19-0-5" class="i">+                        name: &quot;floats&quot;,
</a><a href="#h19-0-6" id="h19-0-6" class="i">+                        columns: [
</a><a href="#h19-0-7" id="h19-0-7" class="i">+                            Column {
</a><a href="#h19-0-8" id="h19-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h19-0-9" id="h19-0-9" class="i">+                                datatype: Integer,
</a><a href="#h19-0-10" id="h19-0-10" class="i">+                                primary_key: true,
</a><a href="#h19-0-11" id="h19-0-11" class="i">+                                nullable: false,
</a><a href="#h19-0-12" id="h19-0-12" class="i">+                                default: None,
</a><a href="#h19-0-13" id="h19-0-13" class="i">+                                unique: true,
</a><a href="#h19-0-14" id="h19-0-14" class="i">+                                references: None,
</a><a href="#h19-0-15" id="h19-0-15" class="i">+                                index: false,
</a><a href="#h19-0-16" id="h19-0-16" class="i">+                            },
</a><a href="#h19-0-17" id="h19-0-17" class="i">+                            Column {
</a><a href="#h19-0-18" id="h19-0-18" class="i">+                                name: &quot;f&quot;,
</a><a href="#h19-0-19" id="h19-0-19" class="i">+                                datatype: Float,
</a><a href="#h19-0-20" id="h19-0-20" class="i">+                                primary_key: false,
</a><a href="#h19-0-21" id="h19-0-21" class="i">+                                nullable: true,
</a><a href="#h19-0-22" id="h19-0-22" class="i">+                                default: Some(
</a><a href="#h19-0-23" id="h19-0-23" class="i">+                                    Null,
</a><a href="#h19-0-24" id="h19-0-24" class="i">+                                ),
</a><a href="#h19-0-25" id="h19-0-25" class="i">+                                unique: false,
</a><a href="#h19-0-26" id="h19-0-26" class="i">+                                references: None,
</a><a href="#h19-0-27" id="h19-0-27" class="i">+                                index: false,
</a><a href="#h19-0-28" id="h19-0-28" class="i">+                            },
</a><a href="#h19-0-29" id="h19-0-29" class="i">+                        ],
</a><a href="#h19-0-30" id="h19-0-30" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h19-1" id="h19-1" class="h">@@ -211,7 +237,33 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h19-1-3" id="h19-1-3" class="d">-                    table: &quot;floats&quot;,
</a><a href="#h19-1-4" id="h19-1-4" class="i">+                    table: Table {
</a><a href="#h19-1-5" id="h19-1-5" class="i">+                        name: &quot;floats&quot;,
</a><a href="#h19-1-6" id="h19-1-6" class="i">+                        columns: [
</a><a href="#h19-1-7" id="h19-1-7" class="i">+                            Column {
</a><a href="#h19-1-8" id="h19-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h19-1-9" id="h19-1-9" class="i">+                                datatype: Integer,
</a><a href="#h19-1-10" id="h19-1-10" class="i">+                                primary_key: true,
</a><a href="#h19-1-11" id="h19-1-11" class="i">+                                nullable: false,
</a><a href="#h19-1-12" id="h19-1-12" class="i">+                                default: None,
</a><a href="#h19-1-13" id="h19-1-13" class="i">+                                unique: true,
</a><a href="#h19-1-14" id="h19-1-14" class="i">+                                references: None,
</a><a href="#h19-1-15" id="h19-1-15" class="i">+                                index: false,
</a><a href="#h19-1-16" id="h19-1-16" class="i">+                            },
</a><a href="#h19-1-17" id="h19-1-17" class="i">+                            Column {
</a><a href="#h19-1-18" id="h19-1-18" class="i">+                                name: &quot;f&quot;,
</a><a href="#h19-1-19" id="h19-1-19" class="i">+                                datatype: Float,
</a><a href="#h19-1-20" id="h19-1-20" class="i">+                                primary_key: false,
</a><a href="#h19-1-21" id="h19-1-21" class="i">+                                nullable: true,
</a><a href="#h19-1-22" id="h19-1-22" class="i">+                                default: Some(
</a><a href="#h19-1-23" id="h19-1-23" class="i">+                                    Null,
</a><a href="#h19-1-24" id="h19-1-24" class="i">+                                ),
</a><a href="#h19-1-25" id="h19-1-25" class="i">+                                unique: false,
</a><a href="#h19-1-26" id="h19-1-26" class="i">+                                references: None,
</a><a href="#h19-1-27" id="h19-1-27" class="i">+                                index: false,
</a><a href="#h19-1-28" id="h19-1-28" class="i">+                            },
</a><a href="#h19-1-29" id="h19-1-29" class="i">+                        ],
</a><a href="#h19-1-30" id="h19-1-30" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a> b/<a href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -105,7 +105,33 @@ Plan: Select(
</a>             source: Projection {
                 source: Filter {
                     source: Scan {
<a href="#h20-0-3" id="h20-0-3" class="d">-                        table: &quot;integers&quot;,
</a><a href="#h20-0-4" id="h20-0-4" class="i">+                        table: Table {
</a><a href="#h20-0-5" id="h20-0-5" class="i">+                            name: &quot;integers&quot;,
</a><a href="#h20-0-6" id="h20-0-6" class="i">+                            columns: [
</a><a href="#h20-0-7" id="h20-0-7" class="i">+                                Column {
</a><a href="#h20-0-8" id="h20-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h20-0-9" id="h20-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h20-0-10" id="h20-0-10" class="i">+                                    primary_key: true,
</a><a href="#h20-0-11" id="h20-0-11" class="i">+                                    nullable: false,
</a><a href="#h20-0-12" id="h20-0-12" class="i">+                                    default: None,
</a><a href="#h20-0-13" id="h20-0-13" class="i">+                                    unique: true,
</a><a href="#h20-0-14" id="h20-0-14" class="i">+                                    references: None,
</a><a href="#h20-0-15" id="h20-0-15" class="i">+                                    index: false,
</a><a href="#h20-0-16" id="h20-0-16" class="i">+                                },
</a><a href="#h20-0-17" id="h20-0-17" class="i">+                                Column {
</a><a href="#h20-0-18" id="h20-0-18" class="i">+                                    name: &quot;i&quot;,
</a><a href="#h20-0-19" id="h20-0-19" class="i">+                                    datatype: Integer,
</a><a href="#h20-0-20" id="h20-0-20" class="i">+                                    primary_key: false,
</a><a href="#h20-0-21" id="h20-0-21" class="i">+                                    nullable: true,
</a><a href="#h20-0-22" id="h20-0-22" class="i">+                                    default: Some(
</a><a href="#h20-0-23" id="h20-0-23" class="i">+                                        Null,
</a><a href="#h20-0-24" id="h20-0-24" class="i">+                                    ),
</a><a href="#h20-0-25" id="h20-0-25" class="i">+                                    unique: false,
</a><a href="#h20-0-26" id="h20-0-26" class="i">+                                    references: None,
</a><a href="#h20-0-27" id="h20-0-27" class="i">+                                    index: false,
</a><a href="#h20-0-28" id="h20-0-28" class="i">+                                },
</a><a href="#h20-0-29" id="h20-0-29" class="i">+                            ],
</a><a href="#h20-0-30" id="h20-0-30" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h20-1" id="h20-1" class="h">@@ -239,7 +265,33 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h20-1-3" id="h20-1-3" class="d">-                    table: &quot;integers&quot;,
</a><a href="#h20-1-4" id="h20-1-4" class="i">+                    table: Table {
</a><a href="#h20-1-5" id="h20-1-5" class="i">+                        name: &quot;integers&quot;,
</a><a href="#h20-1-6" id="h20-1-6" class="i">+                        columns: [
</a><a href="#h20-1-7" id="h20-1-7" class="i">+                            Column {
</a><a href="#h20-1-8" id="h20-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h20-1-9" id="h20-1-9" class="i">+                                datatype: Integer,
</a><a href="#h20-1-10" id="h20-1-10" class="i">+                                primary_key: true,
</a><a href="#h20-1-11" id="h20-1-11" class="i">+                                nullable: false,
</a><a href="#h20-1-12" id="h20-1-12" class="i">+                                default: None,
</a><a href="#h20-1-13" id="h20-1-13" class="i">+                                unique: true,
</a><a href="#h20-1-14" id="h20-1-14" class="i">+                                references: None,
</a><a href="#h20-1-15" id="h20-1-15" class="i">+                                index: false,
</a><a href="#h20-1-16" id="h20-1-16" class="i">+                            },
</a><a href="#h20-1-17" id="h20-1-17" class="i">+                            Column {
</a><a href="#h20-1-18" id="h20-1-18" class="i">+                                name: &quot;i&quot;,
</a><a href="#h20-1-19" id="h20-1-19" class="i">+                                datatype: Integer,
</a><a href="#h20-1-20" id="h20-1-20" class="i">+                                primary_key: false,
</a><a href="#h20-1-21" id="h20-1-21" class="i">+                                nullable: true,
</a><a href="#h20-1-22" id="h20-1-22" class="i">+                                default: Some(
</a><a href="#h20-1-23" id="h20-1-23" class="i">+                                    Null,
</a><a href="#h20-1-24" id="h20-1-24" class="i">+                                ),
</a><a href="#h20-1-25" id="h20-1-25" class="i">+                                unique: false,
</a><a href="#h20-1-26" id="h20-1-26" class="i">+                                references: None,
</a><a href="#h20-1-27" id="h20-1-27" class="i">+                                index: false,
</a><a href="#h20-1-28" id="h20-1-28" class="i">+                            },
</a><a href="#h20-1-29" id="h20-1-29" class="i">+                        ],
</a><a href="#h20-1-30" id="h20-1-30" class="i">+                    },
</a>                     alias: None,
                     filter: Some(
                         Not(
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a> b/<a href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -91,7 +91,33 @@ Plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h21-0-3" id="h21-0-3" class="d">-                    table: &quot;integers&quot;,
</a><a href="#h21-0-4" id="h21-0-4" class="i">+                    table: Table {
</a><a href="#h21-0-5" id="h21-0-5" class="i">+                        name: &quot;integers&quot;,
</a><a href="#h21-0-6" id="h21-0-6" class="i">+                        columns: [
</a><a href="#h21-0-7" id="h21-0-7" class="i">+                            Column {
</a><a href="#h21-0-8" id="h21-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h21-0-9" id="h21-0-9" class="i">+                                datatype: Integer,
</a><a href="#h21-0-10" id="h21-0-10" class="i">+                                primary_key: true,
</a><a href="#h21-0-11" id="h21-0-11" class="i">+                                nullable: false,
</a><a href="#h21-0-12" id="h21-0-12" class="i">+                                default: None,
</a><a href="#h21-0-13" id="h21-0-13" class="i">+                                unique: true,
</a><a href="#h21-0-14" id="h21-0-14" class="i">+                                references: None,
</a><a href="#h21-0-15" id="h21-0-15" class="i">+                                index: false,
</a><a href="#h21-0-16" id="h21-0-16" class="i">+                            },
</a><a href="#h21-0-17" id="h21-0-17" class="i">+                            Column {
</a><a href="#h21-0-18" id="h21-0-18" class="i">+                                name: &quot;i&quot;,
</a><a href="#h21-0-19" id="h21-0-19" class="i">+                                datatype: Integer,
</a><a href="#h21-0-20" id="h21-0-20" class="i">+                                primary_key: false,
</a><a href="#h21-0-21" id="h21-0-21" class="i">+                                nullable: true,
</a><a href="#h21-0-22" id="h21-0-22" class="i">+                                default: Some(
</a><a href="#h21-0-23" id="h21-0-23" class="i">+                                    Null,
</a><a href="#h21-0-24" id="h21-0-24" class="i">+                                ),
</a><a href="#h21-0-25" id="h21-0-25" class="i">+                                unique: false,
</a><a href="#h21-0-26" id="h21-0-26" class="i">+                                references: None,
</a><a href="#h21-0-27" id="h21-0-27" class="i">+                                index: false,
</a><a href="#h21-0-28" id="h21-0-28" class="i">+                            },
</a><a href="#h21-0-29" id="h21-0-29" class="i">+                        ],
</a><a href="#h21-0-30" id="h21-0-30" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h21-1" id="h21-1" class="h">@@ -211,7 +237,33 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h21-1-3" id="h21-1-3" class="d">-                    table: &quot;integers&quot;,
</a><a href="#h21-1-4" id="h21-1-4" class="i">+                    table: Table {
</a><a href="#h21-1-5" id="h21-1-5" class="i">+                        name: &quot;integers&quot;,
</a><a href="#h21-1-6" id="h21-1-6" class="i">+                        columns: [
</a><a href="#h21-1-7" id="h21-1-7" class="i">+                            Column {
</a><a href="#h21-1-8" id="h21-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h21-1-9" id="h21-1-9" class="i">+                                datatype: Integer,
</a><a href="#h21-1-10" id="h21-1-10" class="i">+                                primary_key: true,
</a><a href="#h21-1-11" id="h21-1-11" class="i">+                                nullable: false,
</a><a href="#h21-1-12" id="h21-1-12" class="i">+                                default: None,
</a><a href="#h21-1-13" id="h21-1-13" class="i">+                                unique: true,
</a><a href="#h21-1-14" id="h21-1-14" class="i">+                                references: None,
</a><a href="#h21-1-15" id="h21-1-15" class="i">+                                index: false,
</a><a href="#h21-1-16" id="h21-1-16" class="i">+                            },
</a><a href="#h21-1-17" id="h21-1-17" class="i">+                            Column {
</a><a href="#h21-1-18" id="h21-1-18" class="i">+                                name: &quot;i&quot;,
</a><a href="#h21-1-19" id="h21-1-19" class="i">+                                datatype: Integer,
</a><a href="#h21-1-20" id="h21-1-20" class="i">+                                primary_key: false,
</a><a href="#h21-1-21" id="h21-1-21" class="i">+                                nullable: true,
</a><a href="#h21-1-22" id="h21-1-22" class="i">+                                default: Some(
</a><a href="#h21-1-23" id="h21-1-23" class="i">+                                    Null,
</a><a href="#h21-1-24" id="h21-1-24" class="i">+                                ),
</a><a href="#h21-1-25" id="h21-1-25" class="i">+                                unique: false,
</a><a href="#h21-1-26" id="h21-1-26" class="i">+                                references: None,
</a><a href="#h21-1-27" id="h21-1-27" class="i">+                                index: false,
</a><a href="#h21-1-28" id="h21-1-28" class="i">+                            },
</a><a href="#h21-1-29" id="h21-1-29" class="i">+                        ],
</a><a href="#h21-1-30" id="h21-1-30" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h22" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -98,7 +98,89 @@ Plan: Select(
</a>             source: Projection {
                 source: Filter {
                     source: Scan {
<a href="#h22-0-3" id="h22-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h22-0-4" id="h22-0-4" class="i">+                        table: Table {
</a><a href="#h22-0-5" id="h22-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h22-0-6" id="h22-0-6" class="i">+                            columns: [
</a><a href="#h22-0-7" id="h22-0-7" class="i">+                                Column {
</a><a href="#h22-0-8" id="h22-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h22-0-9" id="h22-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h22-0-10" id="h22-0-10" class="i">+                                    primary_key: true,
</a><a href="#h22-0-11" id="h22-0-11" class="i">+                                    nullable: false,
</a><a href="#h22-0-12" id="h22-0-12" class="i">+                                    default: None,
</a><a href="#h22-0-13" id="h22-0-13" class="i">+                                    unique: true,
</a><a href="#h22-0-14" id="h22-0-14" class="i">+                                    references: None,
</a><a href="#h22-0-15" id="h22-0-15" class="i">+                                    index: false,
</a><a href="#h22-0-16" id="h22-0-16" class="i">+                                },
</a><a href="#h22-0-17" id="h22-0-17" class="i">+                                Column {
</a><a href="#h22-0-18" id="h22-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h22-0-19" id="h22-0-19" class="i">+                                    datatype: String,
</a><a href="#h22-0-20" id="h22-0-20" class="i">+                                    primary_key: false,
</a><a href="#h22-0-21" id="h22-0-21" class="i">+                                    nullable: false,
</a><a href="#h22-0-22" id="h22-0-22" class="i">+                                    default: None,
</a><a href="#h22-0-23" id="h22-0-23" class="i">+                                    unique: false,
</a><a href="#h22-0-24" id="h22-0-24" class="i">+                                    references: None,
</a><a href="#h22-0-25" id="h22-0-25" class="i">+                                    index: false,
</a><a href="#h22-0-26" id="h22-0-26" class="i">+                                },
</a><a href="#h22-0-27" id="h22-0-27" class="i">+                                Column {
</a><a href="#h22-0-28" id="h22-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h22-0-29" id="h22-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h22-0-30" id="h22-0-30" class="i">+                                    primary_key: false,
</a><a href="#h22-0-31" id="h22-0-31" class="i">+                                    nullable: false,
</a><a href="#h22-0-32" id="h22-0-32" class="i">+                                    default: None,
</a><a href="#h22-0-33" id="h22-0-33" class="i">+                                    unique: false,
</a><a href="#h22-0-34" id="h22-0-34" class="i">+                                    references: Some(
</a><a href="#h22-0-35" id="h22-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h22-0-36" id="h22-0-36" class="i">+                                    ),
</a><a href="#h22-0-37" id="h22-0-37" class="i">+                                    index: true,
</a><a href="#h22-0-38" id="h22-0-38" class="i">+                                },
</a><a href="#h22-0-39" id="h22-0-39" class="i">+                                Column {
</a><a href="#h22-0-40" id="h22-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h22-0-41" id="h22-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h22-0-42" id="h22-0-42" class="i">+                                    primary_key: false,
</a><a href="#h22-0-43" id="h22-0-43" class="i">+                                    nullable: false,
</a><a href="#h22-0-44" id="h22-0-44" class="i">+                                    default: None,
</a><a href="#h22-0-45" id="h22-0-45" class="i">+                                    unique: false,
</a><a href="#h22-0-46" id="h22-0-46" class="i">+                                    references: Some(
</a><a href="#h22-0-47" id="h22-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h22-0-48" id="h22-0-48" class="i">+                                    ),
</a><a href="#h22-0-49" id="h22-0-49" class="i">+                                    index: true,
</a><a href="#h22-0-50" id="h22-0-50" class="i">+                                },
</a><a href="#h22-0-51" id="h22-0-51" class="i">+                                Column {
</a><a href="#h22-0-52" id="h22-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h22-0-53" id="h22-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h22-0-54" id="h22-0-54" class="i">+                                    primary_key: false,
</a><a href="#h22-0-55" id="h22-0-55" class="i">+                                    nullable: false,
</a><a href="#h22-0-56" id="h22-0-56" class="i">+                                    default: None,
</a><a href="#h22-0-57" id="h22-0-57" class="i">+                                    unique: false,
</a><a href="#h22-0-58" id="h22-0-58" class="i">+                                    references: None,
</a><a href="#h22-0-59" id="h22-0-59" class="i">+                                    index: false,
</a><a href="#h22-0-60" id="h22-0-60" class="i">+                                },
</a><a href="#h22-0-61" id="h22-0-61" class="i">+                                Column {
</a><a href="#h22-0-62" id="h22-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h22-0-63" id="h22-0-63" class="i">+                                    datatype: Float,
</a><a href="#h22-0-64" id="h22-0-64" class="i">+                                    primary_key: false,
</a><a href="#h22-0-65" id="h22-0-65" class="i">+                                    nullable: true,
</a><a href="#h22-0-66" id="h22-0-66" class="i">+                                    default: Some(
</a><a href="#h22-0-67" id="h22-0-67" class="i">+                                        Null,
</a><a href="#h22-0-68" id="h22-0-68" class="i">+                                    ),
</a><a href="#h22-0-69" id="h22-0-69" class="i">+                                    unique: false,
</a><a href="#h22-0-70" id="h22-0-70" class="i">+                                    references: None,
</a><a href="#h22-0-71" id="h22-0-71" class="i">+                                    index: false,
</a><a href="#h22-0-72" id="h22-0-72" class="i">+                                },
</a><a href="#h22-0-73" id="h22-0-73" class="i">+                                Column {
</a><a href="#h22-0-74" id="h22-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h22-0-75" id="h22-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h22-0-76" id="h22-0-76" class="i">+                                    primary_key: false,
</a><a href="#h22-0-77" id="h22-0-77" class="i">+                                    nullable: true,
</a><a href="#h22-0-78" id="h22-0-78" class="i">+                                    default: Some(
</a><a href="#h22-0-79" id="h22-0-79" class="i">+                                        Null,
</a><a href="#h22-0-80" id="h22-0-80" class="i">+                                    ),
</a><a href="#h22-0-81" id="h22-0-81" class="i">+                                    unique: false,
</a><a href="#h22-0-82" id="h22-0-82" class="i">+                                    references: None,
</a><a href="#h22-0-83" id="h22-0-83" class="i">+                                    index: false,
</a><a href="#h22-0-84" id="h22-0-84" class="i">+                                },
</a><a href="#h22-0-85" id="h22-0-85" class="i">+                            ],
</a><a href="#h22-0-86" id="h22-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h22-1" id="h22-1" class="h">@@ -224,7 +306,89 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h22-1-3" id="h22-1-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h22-1-4" id="h22-1-4" class="i">+                    table: Table {
</a><a href="#h22-1-5" id="h22-1-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h22-1-6" id="h22-1-6" class="i">+                        columns: [
</a><a href="#h22-1-7" id="h22-1-7" class="i">+                            Column {
</a><a href="#h22-1-8" id="h22-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h22-1-9" id="h22-1-9" class="i">+                                datatype: Integer,
</a><a href="#h22-1-10" id="h22-1-10" class="i">+                                primary_key: true,
</a><a href="#h22-1-11" id="h22-1-11" class="i">+                                nullable: false,
</a><a href="#h22-1-12" id="h22-1-12" class="i">+                                default: None,
</a><a href="#h22-1-13" id="h22-1-13" class="i">+                                unique: true,
</a><a href="#h22-1-14" id="h22-1-14" class="i">+                                references: None,
</a><a href="#h22-1-15" id="h22-1-15" class="i">+                                index: false,
</a><a href="#h22-1-16" id="h22-1-16" class="i">+                            },
</a><a href="#h22-1-17" id="h22-1-17" class="i">+                            Column {
</a><a href="#h22-1-18" id="h22-1-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h22-1-19" id="h22-1-19" class="i">+                                datatype: String,
</a><a href="#h22-1-20" id="h22-1-20" class="i">+                                primary_key: false,
</a><a href="#h22-1-21" id="h22-1-21" class="i">+                                nullable: false,
</a><a href="#h22-1-22" id="h22-1-22" class="i">+                                default: None,
</a><a href="#h22-1-23" id="h22-1-23" class="i">+                                unique: false,
</a><a href="#h22-1-24" id="h22-1-24" class="i">+                                references: None,
</a><a href="#h22-1-25" id="h22-1-25" class="i">+                                index: false,
</a><a href="#h22-1-26" id="h22-1-26" class="i">+                            },
</a><a href="#h22-1-27" id="h22-1-27" class="i">+                            Column {
</a><a href="#h22-1-28" id="h22-1-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h22-1-29" id="h22-1-29" class="i">+                                datatype: Integer,
</a><a href="#h22-1-30" id="h22-1-30" class="i">+                                primary_key: false,
</a><a href="#h22-1-31" id="h22-1-31" class="i">+                                nullable: false,
</a><a href="#h22-1-32" id="h22-1-32" class="i">+                                default: None,
</a><a href="#h22-1-33" id="h22-1-33" class="i">+                                unique: false,
</a><a href="#h22-1-34" id="h22-1-34" class="i">+                                references: Some(
</a><a href="#h22-1-35" id="h22-1-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h22-1-36" id="h22-1-36" class="i">+                                ),
</a><a href="#h22-1-37" id="h22-1-37" class="i">+                                index: true,
</a><a href="#h22-1-38" id="h22-1-38" class="i">+                            },
</a><a href="#h22-1-39" id="h22-1-39" class="i">+                            Column {
</a><a href="#h22-1-40" id="h22-1-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h22-1-41" id="h22-1-41" class="i">+                                datatype: Integer,
</a><a href="#h22-1-42" id="h22-1-42" class="i">+                                primary_key: false,
</a><a href="#h22-1-43" id="h22-1-43" class="i">+                                nullable: false,
</a><a href="#h22-1-44" id="h22-1-44" class="i">+                                default: None,
</a><a href="#h22-1-45" id="h22-1-45" class="i">+                                unique: false,
</a><a href="#h22-1-46" id="h22-1-46" class="i">+                                references: Some(
</a><a href="#h22-1-47" id="h22-1-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h22-1-48" id="h22-1-48" class="i">+                                ),
</a><a href="#h22-1-49" id="h22-1-49" class="i">+                                index: true,
</a><a href="#h22-1-50" id="h22-1-50" class="i">+                            },
</a><a href="#h22-1-51" id="h22-1-51" class="i">+                            Column {
</a><a href="#h22-1-52" id="h22-1-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h22-1-53" id="h22-1-53" class="i">+                                datatype: Integer,
</a><a href="#h22-1-54" id="h22-1-54" class="i">+                                primary_key: false,
</a><a href="#h22-1-55" id="h22-1-55" class="i">+                                nullable: false,
</a><a href="#h22-1-56" id="h22-1-56" class="i">+                                default: None,
</a><a href="#h22-1-57" id="h22-1-57" class="i">+                                unique: false,
</a><a href="#h22-1-58" id="h22-1-58" class="i">+                                references: None,
</a><a href="#h22-1-59" id="h22-1-59" class="i">+                                index: false,
</a><a href="#h22-1-60" id="h22-1-60" class="i">+                            },
</a><a href="#h22-1-61" id="h22-1-61" class="i">+                            Column {
</a><a href="#h22-1-62" id="h22-1-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h22-1-63" id="h22-1-63" class="i">+                                datatype: Float,
</a><a href="#h22-1-64" id="h22-1-64" class="i">+                                primary_key: false,
</a><a href="#h22-1-65" id="h22-1-65" class="i">+                                nullable: true,
</a><a href="#h22-1-66" id="h22-1-66" class="i">+                                default: Some(
</a><a href="#h22-1-67" id="h22-1-67" class="i">+                                    Null,
</a><a href="#h22-1-68" id="h22-1-68" class="i">+                                ),
</a><a href="#h22-1-69" id="h22-1-69" class="i">+                                unique: false,
</a><a href="#h22-1-70" id="h22-1-70" class="i">+                                references: None,
</a><a href="#h22-1-71" id="h22-1-71" class="i">+                                index: false,
</a><a href="#h22-1-72" id="h22-1-72" class="i">+                            },
</a><a href="#h22-1-73" id="h22-1-73" class="i">+                            Column {
</a><a href="#h22-1-74" id="h22-1-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h22-1-75" id="h22-1-75" class="i">+                                datatype: Boolean,
</a><a href="#h22-1-76" id="h22-1-76" class="i">+                                primary_key: false,
</a><a href="#h22-1-77" id="h22-1-77" class="i">+                                nullable: true,
</a><a href="#h22-1-78" id="h22-1-78" class="i">+                                default: Some(
</a><a href="#h22-1-79" id="h22-1-79" class="i">+                                    Null,
</a><a href="#h22-1-80" id="h22-1-80" class="i">+                                ),
</a><a href="#h22-1-81" id="h22-1-81" class="i">+                                unique: false,
</a><a href="#h22-1-82" id="h22-1-82" class="i">+                                references: None,
</a><a href="#h22-1-83" id="h22-1-83" class="i">+                                index: false,
</a><a href="#h22-1-84" id="h22-1-84" class="i">+                            },
</a><a href="#h22-1-85" id="h22-1-85" class="i">+                        ],
</a><a href="#h22-1-86" id="h22-1-86" class="i">+                    },
</a>                     alias: None,
                     filter: Some(
                         Constant(
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -102,7 +102,89 @@ Plan: Select(
</a>             source: Projection {
                 source: Filter {
                     source: Scan {
<a href="#h23-0-3" id="h23-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h23-0-4" id="h23-0-4" class="i">+                        table: Table {
</a><a href="#h23-0-5" id="h23-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h23-0-6" id="h23-0-6" class="i">+                            columns: [
</a><a href="#h23-0-7" id="h23-0-7" class="i">+                                Column {
</a><a href="#h23-0-8" id="h23-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h23-0-9" id="h23-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h23-0-10" id="h23-0-10" class="i">+                                    primary_key: true,
</a><a href="#h23-0-11" id="h23-0-11" class="i">+                                    nullable: false,
</a><a href="#h23-0-12" id="h23-0-12" class="i">+                                    default: None,
</a><a href="#h23-0-13" id="h23-0-13" class="i">+                                    unique: true,
</a><a href="#h23-0-14" id="h23-0-14" class="i">+                                    references: None,
</a><a href="#h23-0-15" id="h23-0-15" class="i">+                                    index: false,
</a><a href="#h23-0-16" id="h23-0-16" class="i">+                                },
</a><a href="#h23-0-17" id="h23-0-17" class="i">+                                Column {
</a><a href="#h23-0-18" id="h23-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h23-0-19" id="h23-0-19" class="i">+                                    datatype: String,
</a><a href="#h23-0-20" id="h23-0-20" class="i">+                                    primary_key: false,
</a><a href="#h23-0-21" id="h23-0-21" class="i">+                                    nullable: false,
</a><a href="#h23-0-22" id="h23-0-22" class="i">+                                    default: None,
</a><a href="#h23-0-23" id="h23-0-23" class="i">+                                    unique: false,
</a><a href="#h23-0-24" id="h23-0-24" class="i">+                                    references: None,
</a><a href="#h23-0-25" id="h23-0-25" class="i">+                                    index: false,
</a><a href="#h23-0-26" id="h23-0-26" class="i">+                                },
</a><a href="#h23-0-27" id="h23-0-27" class="i">+                                Column {
</a><a href="#h23-0-28" id="h23-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h23-0-29" id="h23-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h23-0-30" id="h23-0-30" class="i">+                                    primary_key: false,
</a><a href="#h23-0-31" id="h23-0-31" class="i">+                                    nullable: false,
</a><a href="#h23-0-32" id="h23-0-32" class="i">+                                    default: None,
</a><a href="#h23-0-33" id="h23-0-33" class="i">+                                    unique: false,
</a><a href="#h23-0-34" id="h23-0-34" class="i">+                                    references: Some(
</a><a href="#h23-0-35" id="h23-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h23-0-36" id="h23-0-36" class="i">+                                    ),
</a><a href="#h23-0-37" id="h23-0-37" class="i">+                                    index: true,
</a><a href="#h23-0-38" id="h23-0-38" class="i">+                                },
</a><a href="#h23-0-39" id="h23-0-39" class="i">+                                Column {
</a><a href="#h23-0-40" id="h23-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h23-0-41" id="h23-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h23-0-42" id="h23-0-42" class="i">+                                    primary_key: false,
</a><a href="#h23-0-43" id="h23-0-43" class="i">+                                    nullable: false,
</a><a href="#h23-0-44" id="h23-0-44" class="i">+                                    default: None,
</a><a href="#h23-0-45" id="h23-0-45" class="i">+                                    unique: false,
</a><a href="#h23-0-46" id="h23-0-46" class="i">+                                    references: Some(
</a><a href="#h23-0-47" id="h23-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h23-0-48" id="h23-0-48" class="i">+                                    ),
</a><a href="#h23-0-49" id="h23-0-49" class="i">+                                    index: true,
</a><a href="#h23-0-50" id="h23-0-50" class="i">+                                },
</a><a href="#h23-0-51" id="h23-0-51" class="i">+                                Column {
</a><a href="#h23-0-52" id="h23-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h23-0-53" id="h23-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h23-0-54" id="h23-0-54" class="i">+                                    primary_key: false,
</a><a href="#h23-0-55" id="h23-0-55" class="i">+                                    nullable: false,
</a><a href="#h23-0-56" id="h23-0-56" class="i">+                                    default: None,
</a><a href="#h23-0-57" id="h23-0-57" class="i">+                                    unique: false,
</a><a href="#h23-0-58" id="h23-0-58" class="i">+                                    references: None,
</a><a href="#h23-0-59" id="h23-0-59" class="i">+                                    index: false,
</a><a href="#h23-0-60" id="h23-0-60" class="i">+                                },
</a><a href="#h23-0-61" id="h23-0-61" class="i">+                                Column {
</a><a href="#h23-0-62" id="h23-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h23-0-63" id="h23-0-63" class="i">+                                    datatype: Float,
</a><a href="#h23-0-64" id="h23-0-64" class="i">+                                    primary_key: false,
</a><a href="#h23-0-65" id="h23-0-65" class="i">+                                    nullable: true,
</a><a href="#h23-0-66" id="h23-0-66" class="i">+                                    default: Some(
</a><a href="#h23-0-67" id="h23-0-67" class="i">+                                        Null,
</a><a href="#h23-0-68" id="h23-0-68" class="i">+                                    ),
</a><a href="#h23-0-69" id="h23-0-69" class="i">+                                    unique: false,
</a><a href="#h23-0-70" id="h23-0-70" class="i">+                                    references: None,
</a><a href="#h23-0-71" id="h23-0-71" class="i">+                                    index: false,
</a><a href="#h23-0-72" id="h23-0-72" class="i">+                                },
</a><a href="#h23-0-73" id="h23-0-73" class="i">+                                Column {
</a><a href="#h23-0-74" id="h23-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h23-0-75" id="h23-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h23-0-76" id="h23-0-76" class="i">+                                    primary_key: false,
</a><a href="#h23-0-77" id="h23-0-77" class="i">+                                    nullable: true,
</a><a href="#h23-0-78" id="h23-0-78" class="i">+                                    default: Some(
</a><a href="#h23-0-79" id="h23-0-79" class="i">+                                        Null,
</a><a href="#h23-0-80" id="h23-0-80" class="i">+                                    ),
</a><a href="#h23-0-81" id="h23-0-81" class="i">+                                    unique: false,
</a><a href="#h23-0-82" id="h23-0-82" class="i">+                                    references: None,
</a><a href="#h23-0-83" id="h23-0-83" class="i">+                                    index: false,
</a><a href="#h23-0-84" id="h23-0-84" class="i">+                                },
</a><a href="#h23-0-85" id="h23-0-85" class="i">+                            ],
</a><a href="#h23-0-86" id="h23-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h23-1" id="h23-1" class="h">@@ -240,7 +322,89 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h23-1-3" id="h23-1-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h23-1-4" id="h23-1-4" class="i">+                    table: Table {
</a><a href="#h23-1-5" id="h23-1-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h23-1-6" id="h23-1-6" class="i">+                        columns: [
</a><a href="#h23-1-7" id="h23-1-7" class="i">+                            Column {
</a><a href="#h23-1-8" id="h23-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h23-1-9" id="h23-1-9" class="i">+                                datatype: Integer,
</a><a href="#h23-1-10" id="h23-1-10" class="i">+                                primary_key: true,
</a><a href="#h23-1-11" id="h23-1-11" class="i">+                                nullable: false,
</a><a href="#h23-1-12" id="h23-1-12" class="i">+                                default: None,
</a><a href="#h23-1-13" id="h23-1-13" class="i">+                                unique: true,
</a><a href="#h23-1-14" id="h23-1-14" class="i">+                                references: None,
</a><a href="#h23-1-15" id="h23-1-15" class="i">+                                index: false,
</a><a href="#h23-1-16" id="h23-1-16" class="i">+                            },
</a><a href="#h23-1-17" id="h23-1-17" class="i">+                            Column {
</a><a href="#h23-1-18" id="h23-1-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h23-1-19" id="h23-1-19" class="i">+                                datatype: String,
</a><a href="#h23-1-20" id="h23-1-20" class="i">+                                primary_key: false,
</a><a href="#h23-1-21" id="h23-1-21" class="i">+                                nullable: false,
</a><a href="#h23-1-22" id="h23-1-22" class="i">+                                default: None,
</a><a href="#h23-1-23" id="h23-1-23" class="i">+                                unique: false,
</a><a href="#h23-1-24" id="h23-1-24" class="i">+                                references: None,
</a><a href="#h23-1-25" id="h23-1-25" class="i">+                                index: false,
</a><a href="#h23-1-26" id="h23-1-26" class="i">+                            },
</a><a href="#h23-1-27" id="h23-1-27" class="i">+                            Column {
</a><a href="#h23-1-28" id="h23-1-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h23-1-29" id="h23-1-29" class="i">+                                datatype: Integer,
</a><a href="#h23-1-30" id="h23-1-30" class="i">+                                primary_key: false,
</a><a href="#h23-1-31" id="h23-1-31" class="i">+                                nullable: false,
</a><a href="#h23-1-32" id="h23-1-32" class="i">+                                default: None,
</a><a href="#h23-1-33" id="h23-1-33" class="i">+                                unique: false,
</a><a href="#h23-1-34" id="h23-1-34" class="i">+                                references: Some(
</a><a href="#h23-1-35" id="h23-1-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h23-1-36" id="h23-1-36" class="i">+                                ),
</a><a href="#h23-1-37" id="h23-1-37" class="i">+                                index: true,
</a><a href="#h23-1-38" id="h23-1-38" class="i">+                            },
</a><a href="#h23-1-39" id="h23-1-39" class="i">+                            Column {
</a><a href="#h23-1-40" id="h23-1-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h23-1-41" id="h23-1-41" class="i">+                                datatype: Integer,
</a><a href="#h23-1-42" id="h23-1-42" class="i">+                                primary_key: false,
</a><a href="#h23-1-43" id="h23-1-43" class="i">+                                nullable: false,
</a><a href="#h23-1-44" id="h23-1-44" class="i">+                                default: None,
</a><a href="#h23-1-45" id="h23-1-45" class="i">+                                unique: false,
</a><a href="#h23-1-46" id="h23-1-46" class="i">+                                references: Some(
</a><a href="#h23-1-47" id="h23-1-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h23-1-48" id="h23-1-48" class="i">+                                ),
</a><a href="#h23-1-49" id="h23-1-49" class="i">+                                index: true,
</a><a href="#h23-1-50" id="h23-1-50" class="i">+                            },
</a><a href="#h23-1-51" id="h23-1-51" class="i">+                            Column {
</a><a href="#h23-1-52" id="h23-1-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h23-1-53" id="h23-1-53" class="i">+                                datatype: Integer,
</a><a href="#h23-1-54" id="h23-1-54" class="i">+                                primary_key: false,
</a><a href="#h23-1-55" id="h23-1-55" class="i">+                                nullable: false,
</a><a href="#h23-1-56" id="h23-1-56" class="i">+                                default: None,
</a><a href="#h23-1-57" id="h23-1-57" class="i">+                                unique: false,
</a><a href="#h23-1-58" id="h23-1-58" class="i">+                                references: None,
</a><a href="#h23-1-59" id="h23-1-59" class="i">+                                index: false,
</a><a href="#h23-1-60" id="h23-1-60" class="i">+                            },
</a><a href="#h23-1-61" id="h23-1-61" class="i">+                            Column {
</a><a href="#h23-1-62" id="h23-1-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h23-1-63" id="h23-1-63" class="i">+                                datatype: Float,
</a><a href="#h23-1-64" id="h23-1-64" class="i">+                                primary_key: false,
</a><a href="#h23-1-65" id="h23-1-65" class="i">+                                nullable: true,
</a><a href="#h23-1-66" id="h23-1-66" class="i">+                                default: Some(
</a><a href="#h23-1-67" id="h23-1-67" class="i">+                                    Null,
</a><a href="#h23-1-68" id="h23-1-68" class="i">+                                ),
</a><a href="#h23-1-69" id="h23-1-69" class="i">+                                unique: false,
</a><a href="#h23-1-70" id="h23-1-70" class="i">+                                references: None,
</a><a href="#h23-1-71" id="h23-1-71" class="i">+                                index: false,
</a><a href="#h23-1-72" id="h23-1-72" class="i">+                            },
</a><a href="#h23-1-73" id="h23-1-73" class="i">+                            Column {
</a><a href="#h23-1-74" id="h23-1-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h23-1-75" id="h23-1-75" class="i">+                                datatype: Boolean,
</a><a href="#h23-1-76" id="h23-1-76" class="i">+                                primary_key: false,
</a><a href="#h23-1-77" id="h23-1-77" class="i">+                                nullable: true,
</a><a href="#h23-1-78" id="h23-1-78" class="i">+                                default: Some(
</a><a href="#h23-1-79" id="h23-1-79" class="i">+                                    Null,
</a><a href="#h23-1-80" id="h23-1-80" class="i">+                                ),
</a><a href="#h23-1-81" id="h23-1-81" class="i">+                                unique: false,
</a><a href="#h23-1-82" id="h23-1-82" class="i">+                                references: None,
</a><a href="#h23-1-83" id="h23-1-83" class="i">+                                index: false,
</a><a href="#h23-1-84" id="h23-1-84" class="i">+                            },
</a><a href="#h23-1-85" id="h23-1-85" class="i">+                        ],
</a><a href="#h23-1-86" id="h23-1-86" class="i">+                    },
</a>                     alias: None,
                     filter: Some(
                         Constant(
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a> b/<a href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -105,7 +105,33 @@ Plan: Select(
</a>             source: Projection {
                 source: Filter {
                     source: Scan {
<a href="#h24-0-3" id="h24-0-3" class="d">-                        table: &quot;strings&quot;,
</a><a href="#h24-0-4" id="h24-0-4" class="i">+                        table: Table {
</a><a href="#h24-0-5" id="h24-0-5" class="i">+                            name: &quot;strings&quot;,
</a><a href="#h24-0-6" id="h24-0-6" class="i">+                            columns: [
</a><a href="#h24-0-7" id="h24-0-7" class="i">+                                Column {
</a><a href="#h24-0-8" id="h24-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h24-0-9" id="h24-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h24-0-10" id="h24-0-10" class="i">+                                    primary_key: true,
</a><a href="#h24-0-11" id="h24-0-11" class="i">+                                    nullable: false,
</a><a href="#h24-0-12" id="h24-0-12" class="i">+                                    default: None,
</a><a href="#h24-0-13" id="h24-0-13" class="i">+                                    unique: true,
</a><a href="#h24-0-14" id="h24-0-14" class="i">+                                    references: None,
</a><a href="#h24-0-15" id="h24-0-15" class="i">+                                    index: false,
</a><a href="#h24-0-16" id="h24-0-16" class="i">+                                },
</a><a href="#h24-0-17" id="h24-0-17" class="i">+                                Column {
</a><a href="#h24-0-18" id="h24-0-18" class="i">+                                    name: &quot;s&quot;,
</a><a href="#h24-0-19" id="h24-0-19" class="i">+                                    datatype: String,
</a><a href="#h24-0-20" id="h24-0-20" class="i">+                                    primary_key: false,
</a><a href="#h24-0-21" id="h24-0-21" class="i">+                                    nullable: true,
</a><a href="#h24-0-22" id="h24-0-22" class="i">+                                    default: Some(
</a><a href="#h24-0-23" id="h24-0-23" class="i">+                                        Null,
</a><a href="#h24-0-24" id="h24-0-24" class="i">+                                    ),
</a><a href="#h24-0-25" id="h24-0-25" class="i">+                                    unique: false,
</a><a href="#h24-0-26" id="h24-0-26" class="i">+                                    references: None,
</a><a href="#h24-0-27" id="h24-0-27" class="i">+                                    index: false,
</a><a href="#h24-0-28" id="h24-0-28" class="i">+                                },
</a><a href="#h24-0-29" id="h24-0-29" class="i">+                            ],
</a><a href="#h24-0-30" id="h24-0-30" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h24-1" id="h24-1" class="h">@@ -239,7 +265,33 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h24-1-3" id="h24-1-3" class="d">-                    table: &quot;strings&quot;,
</a><a href="#h24-1-4" id="h24-1-4" class="i">+                    table: Table {
</a><a href="#h24-1-5" id="h24-1-5" class="i">+                        name: &quot;strings&quot;,
</a><a href="#h24-1-6" id="h24-1-6" class="i">+                        columns: [
</a><a href="#h24-1-7" id="h24-1-7" class="i">+                            Column {
</a><a href="#h24-1-8" id="h24-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h24-1-9" id="h24-1-9" class="i">+                                datatype: Integer,
</a><a href="#h24-1-10" id="h24-1-10" class="i">+                                primary_key: true,
</a><a href="#h24-1-11" id="h24-1-11" class="i">+                                nullable: false,
</a><a href="#h24-1-12" id="h24-1-12" class="i">+                                default: None,
</a><a href="#h24-1-13" id="h24-1-13" class="i">+                                unique: true,
</a><a href="#h24-1-14" id="h24-1-14" class="i">+                                references: None,
</a><a href="#h24-1-15" id="h24-1-15" class="i">+                                index: false,
</a><a href="#h24-1-16" id="h24-1-16" class="i">+                            },
</a><a href="#h24-1-17" id="h24-1-17" class="i">+                            Column {
</a><a href="#h24-1-18" id="h24-1-18" class="i">+                                name: &quot;s&quot;,
</a><a href="#h24-1-19" id="h24-1-19" class="i">+                                datatype: String,
</a><a href="#h24-1-20" id="h24-1-20" class="i">+                                primary_key: false,
</a><a href="#h24-1-21" id="h24-1-21" class="i">+                                nullable: true,
</a><a href="#h24-1-22" id="h24-1-22" class="i">+                                default: Some(
</a><a href="#h24-1-23" id="h24-1-23" class="i">+                                    Null,
</a><a href="#h24-1-24" id="h24-1-24" class="i">+                                ),
</a><a href="#h24-1-25" id="h24-1-25" class="i">+                                unique: false,
</a><a href="#h24-1-26" id="h24-1-26" class="i">+                                references: None,
</a><a href="#h24-1-27" id="h24-1-27" class="i">+                                index: false,
</a><a href="#h24-1-28" id="h24-1-28" class="i">+                            },
</a><a href="#h24-1-29" id="h24-1-29" class="i">+                        ],
</a><a href="#h24-1-30" id="h24-1-30" class="i">+                    },
</a>                     alias: None,
                     filter: Some(
                         Not(
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a> b/<a href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -91,7 +91,33 @@ Plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h25-0-3" id="h25-0-3" class="d">-                    table: &quot;strings&quot;,
</a><a href="#h25-0-4" id="h25-0-4" class="i">+                    table: Table {
</a><a href="#h25-0-5" id="h25-0-5" class="i">+                        name: &quot;strings&quot;,
</a><a href="#h25-0-6" id="h25-0-6" class="i">+                        columns: [
</a><a href="#h25-0-7" id="h25-0-7" class="i">+                            Column {
</a><a href="#h25-0-8" id="h25-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h25-0-9" id="h25-0-9" class="i">+                                datatype: Integer,
</a><a href="#h25-0-10" id="h25-0-10" class="i">+                                primary_key: true,
</a><a href="#h25-0-11" id="h25-0-11" class="i">+                                nullable: false,
</a><a href="#h25-0-12" id="h25-0-12" class="i">+                                default: None,
</a><a href="#h25-0-13" id="h25-0-13" class="i">+                                unique: true,
</a><a href="#h25-0-14" id="h25-0-14" class="i">+                                references: None,
</a><a href="#h25-0-15" id="h25-0-15" class="i">+                                index: false,
</a><a href="#h25-0-16" id="h25-0-16" class="i">+                            },
</a><a href="#h25-0-17" id="h25-0-17" class="i">+                            Column {
</a><a href="#h25-0-18" id="h25-0-18" class="i">+                                name: &quot;s&quot;,
</a><a href="#h25-0-19" id="h25-0-19" class="i">+                                datatype: String,
</a><a href="#h25-0-20" id="h25-0-20" class="i">+                                primary_key: false,
</a><a href="#h25-0-21" id="h25-0-21" class="i">+                                nullable: true,
</a><a href="#h25-0-22" id="h25-0-22" class="i">+                                default: Some(
</a><a href="#h25-0-23" id="h25-0-23" class="i">+                                    Null,
</a><a href="#h25-0-24" id="h25-0-24" class="i">+                                ),
</a><a href="#h25-0-25" id="h25-0-25" class="i">+                                unique: false,
</a><a href="#h25-0-26" id="h25-0-26" class="i">+                                references: None,
</a><a href="#h25-0-27" id="h25-0-27" class="i">+                                index: false,
</a><a href="#h25-0-28" id="h25-0-28" class="i">+                            },
</a><a href="#h25-0-29" id="h25-0-29" class="i">+                        ],
</a><a href="#h25-0-30" id="h25-0-30" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h25-1" id="h25-1" class="h">@@ -211,7 +237,33 @@ Optimized plan: Select(
</a>         source: Aggregation {
             source: Projection {
                 source: Scan {
<a href="#h25-1-3" id="h25-1-3" class="d">-                    table: &quot;strings&quot;,
</a><a href="#h25-1-4" id="h25-1-4" class="i">+                    table: Table {
</a><a href="#h25-1-5" id="h25-1-5" class="i">+                        name: &quot;strings&quot;,
</a><a href="#h25-1-6" id="h25-1-6" class="i">+                        columns: [
</a><a href="#h25-1-7" id="h25-1-7" class="i">+                            Column {
</a><a href="#h25-1-8" id="h25-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h25-1-9" id="h25-1-9" class="i">+                                datatype: Integer,
</a><a href="#h25-1-10" id="h25-1-10" class="i">+                                primary_key: true,
</a><a href="#h25-1-11" id="h25-1-11" class="i">+                                nullable: false,
</a><a href="#h25-1-12" id="h25-1-12" class="i">+                                default: None,
</a><a href="#h25-1-13" id="h25-1-13" class="i">+                                unique: true,
</a><a href="#h25-1-14" id="h25-1-14" class="i">+                                references: None,
</a><a href="#h25-1-15" id="h25-1-15" class="i">+                                index: false,
</a><a href="#h25-1-16" id="h25-1-16" class="i">+                            },
</a><a href="#h25-1-17" id="h25-1-17" class="i">+                            Column {
</a><a href="#h25-1-18" id="h25-1-18" class="i">+                                name: &quot;s&quot;,
</a><a href="#h25-1-19" id="h25-1-19" class="i">+                                datatype: String,
</a><a href="#h25-1-20" id="h25-1-20" class="i">+                                primary_key: false,
</a><a href="#h25-1-21" id="h25-1-21" class="i">+                                nullable: true,
</a><a href="#h25-1-22" id="h25-1-22" class="i">+                                default: Some(
</a><a href="#h25-1-23" id="h25-1-23" class="i">+                                    Null,
</a><a href="#h25-1-24" id="h25-1-24" class="i">+                                ),
</a><a href="#h25-1-25" id="h25-1-25" class="i">+                                unique: false,
</a><a href="#h25-1-26" id="h25-1-26" class="i">+                                references: None,
</a><a href="#h25-1-27" id="h25-1-27" class="i">+                                index: false,
</a><a href="#h25-1-28" id="h25-1-28" class="i">+                            },
</a><a href="#h25-1-29" id="h25-1-29" class="i">+                        ],
</a><a href="#h25-1-30" id="h25-1-30" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/all.html">tests/sql/query/all</a> b/<a href="../file/tests/sql/query/all.html">tests/sql/query/all</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -33,7 +33,89 @@ AST: Select {
</a> 
 Plan: Select(
     Scan {
<a href="#h26-0-3" id="h26-0-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h26-0-4" id="h26-0-4" class="i">+        table: Table {
</a><a href="#h26-0-5" id="h26-0-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h26-0-6" id="h26-0-6" class="i">+            columns: [
</a><a href="#h26-0-7" id="h26-0-7" class="i">+                Column {
</a><a href="#h26-0-8" id="h26-0-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h26-0-9" id="h26-0-9" class="i">+                    datatype: Integer,
</a><a href="#h26-0-10" id="h26-0-10" class="i">+                    primary_key: true,
</a><a href="#h26-0-11" id="h26-0-11" class="i">+                    nullable: false,
</a><a href="#h26-0-12" id="h26-0-12" class="i">+                    default: None,
</a><a href="#h26-0-13" id="h26-0-13" class="i">+                    unique: true,
</a><a href="#h26-0-14" id="h26-0-14" class="i">+                    references: None,
</a><a href="#h26-0-15" id="h26-0-15" class="i">+                    index: false,
</a><a href="#h26-0-16" id="h26-0-16" class="i">+                },
</a><a href="#h26-0-17" id="h26-0-17" class="i">+                Column {
</a><a href="#h26-0-18" id="h26-0-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h26-0-19" id="h26-0-19" class="i">+                    datatype: String,
</a><a href="#h26-0-20" id="h26-0-20" class="i">+                    primary_key: false,
</a><a href="#h26-0-21" id="h26-0-21" class="i">+                    nullable: false,
</a><a href="#h26-0-22" id="h26-0-22" class="i">+                    default: None,
</a><a href="#h26-0-23" id="h26-0-23" class="i">+                    unique: false,
</a><a href="#h26-0-24" id="h26-0-24" class="i">+                    references: None,
</a><a href="#h26-0-25" id="h26-0-25" class="i">+                    index: false,
</a><a href="#h26-0-26" id="h26-0-26" class="i">+                },
</a><a href="#h26-0-27" id="h26-0-27" class="i">+                Column {
</a><a href="#h26-0-28" id="h26-0-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h26-0-29" id="h26-0-29" class="i">+                    datatype: Integer,
</a><a href="#h26-0-30" id="h26-0-30" class="i">+                    primary_key: false,
</a><a href="#h26-0-31" id="h26-0-31" class="i">+                    nullable: false,
</a><a href="#h26-0-32" id="h26-0-32" class="i">+                    default: None,
</a><a href="#h26-0-33" id="h26-0-33" class="i">+                    unique: false,
</a><a href="#h26-0-34" id="h26-0-34" class="i">+                    references: Some(
</a><a href="#h26-0-35" id="h26-0-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h26-0-36" id="h26-0-36" class="i">+                    ),
</a><a href="#h26-0-37" id="h26-0-37" class="i">+                    index: true,
</a><a href="#h26-0-38" id="h26-0-38" class="i">+                },
</a><a href="#h26-0-39" id="h26-0-39" class="i">+                Column {
</a><a href="#h26-0-40" id="h26-0-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h26-0-41" id="h26-0-41" class="i">+                    datatype: Integer,
</a><a href="#h26-0-42" id="h26-0-42" class="i">+                    primary_key: false,
</a><a href="#h26-0-43" id="h26-0-43" class="i">+                    nullable: false,
</a><a href="#h26-0-44" id="h26-0-44" class="i">+                    default: None,
</a><a href="#h26-0-45" id="h26-0-45" class="i">+                    unique: false,
</a><a href="#h26-0-46" id="h26-0-46" class="i">+                    references: Some(
</a><a href="#h26-0-47" id="h26-0-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h26-0-48" id="h26-0-48" class="i">+                    ),
</a><a href="#h26-0-49" id="h26-0-49" class="i">+                    index: true,
</a><a href="#h26-0-50" id="h26-0-50" class="i">+                },
</a><a href="#h26-0-51" id="h26-0-51" class="i">+                Column {
</a><a href="#h26-0-52" id="h26-0-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h26-0-53" id="h26-0-53" class="i">+                    datatype: Integer,
</a><a href="#h26-0-54" id="h26-0-54" class="i">+                    primary_key: false,
</a><a href="#h26-0-55" id="h26-0-55" class="i">+                    nullable: false,
</a><a href="#h26-0-56" id="h26-0-56" class="i">+                    default: None,
</a><a href="#h26-0-57" id="h26-0-57" class="i">+                    unique: false,
</a><a href="#h26-0-58" id="h26-0-58" class="i">+                    references: None,
</a><a href="#h26-0-59" id="h26-0-59" class="i">+                    index: false,
</a><a href="#h26-0-60" id="h26-0-60" class="i">+                },
</a><a href="#h26-0-61" id="h26-0-61" class="i">+                Column {
</a><a href="#h26-0-62" id="h26-0-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h26-0-63" id="h26-0-63" class="i">+                    datatype: Float,
</a><a href="#h26-0-64" id="h26-0-64" class="i">+                    primary_key: false,
</a><a href="#h26-0-65" id="h26-0-65" class="i">+                    nullable: true,
</a><a href="#h26-0-66" id="h26-0-66" class="i">+                    default: Some(
</a><a href="#h26-0-67" id="h26-0-67" class="i">+                        Null,
</a><a href="#h26-0-68" id="h26-0-68" class="i">+                    ),
</a><a href="#h26-0-69" id="h26-0-69" class="i">+                    unique: false,
</a><a href="#h26-0-70" id="h26-0-70" class="i">+                    references: None,
</a><a href="#h26-0-71" id="h26-0-71" class="i">+                    index: false,
</a><a href="#h26-0-72" id="h26-0-72" class="i">+                },
</a><a href="#h26-0-73" id="h26-0-73" class="i">+                Column {
</a><a href="#h26-0-74" id="h26-0-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h26-0-75" id="h26-0-75" class="i">+                    datatype: Boolean,
</a><a href="#h26-0-76" id="h26-0-76" class="i">+                    primary_key: false,
</a><a href="#h26-0-77" id="h26-0-77" class="i">+                    nullable: true,
</a><a href="#h26-0-78" id="h26-0-78" class="i">+                    default: Some(
</a><a href="#h26-0-79" id="h26-0-79" class="i">+                        Null,
</a><a href="#h26-0-80" id="h26-0-80" class="i">+                    ),
</a><a href="#h26-0-81" id="h26-0-81" class="i">+                    unique: false,
</a><a href="#h26-0-82" id="h26-0-82" class="i">+                    references: None,
</a><a href="#h26-0-83" id="h26-0-83" class="i">+                    index: false,
</a><a href="#h26-0-84" id="h26-0-84" class="i">+                },
</a><a href="#h26-0-85" id="h26-0-85" class="i">+            ],
</a><a href="#h26-0-86" id="h26-0-86" class="i">+        },
</a>         alias: None,
         filter: None,
     },
<a href="#h26-1" id="h26-1" class="h">@@ -41,7 +123,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     Scan {
<a href="#h26-1-3" id="h26-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h26-1-4" id="h26-1-4" class="i">+        table: Table {
</a><a href="#h26-1-5" id="h26-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h26-1-6" id="h26-1-6" class="i">+            columns: [
</a><a href="#h26-1-7" id="h26-1-7" class="i">+                Column {
</a><a href="#h26-1-8" id="h26-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h26-1-9" id="h26-1-9" class="i">+                    datatype: Integer,
</a><a href="#h26-1-10" id="h26-1-10" class="i">+                    primary_key: true,
</a><a href="#h26-1-11" id="h26-1-11" class="i">+                    nullable: false,
</a><a href="#h26-1-12" id="h26-1-12" class="i">+                    default: None,
</a><a href="#h26-1-13" id="h26-1-13" class="i">+                    unique: true,
</a><a href="#h26-1-14" id="h26-1-14" class="i">+                    references: None,
</a><a href="#h26-1-15" id="h26-1-15" class="i">+                    index: false,
</a><a href="#h26-1-16" id="h26-1-16" class="i">+                },
</a><a href="#h26-1-17" id="h26-1-17" class="i">+                Column {
</a><a href="#h26-1-18" id="h26-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h26-1-19" id="h26-1-19" class="i">+                    datatype: String,
</a><a href="#h26-1-20" id="h26-1-20" class="i">+                    primary_key: false,
</a><a href="#h26-1-21" id="h26-1-21" class="i">+                    nullable: false,
</a><a href="#h26-1-22" id="h26-1-22" class="i">+                    default: None,
</a><a href="#h26-1-23" id="h26-1-23" class="i">+                    unique: false,
</a><a href="#h26-1-24" id="h26-1-24" class="i">+                    references: None,
</a><a href="#h26-1-25" id="h26-1-25" class="i">+                    index: false,
</a><a href="#h26-1-26" id="h26-1-26" class="i">+                },
</a><a href="#h26-1-27" id="h26-1-27" class="i">+                Column {
</a><a href="#h26-1-28" id="h26-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h26-1-29" id="h26-1-29" class="i">+                    datatype: Integer,
</a><a href="#h26-1-30" id="h26-1-30" class="i">+                    primary_key: false,
</a><a href="#h26-1-31" id="h26-1-31" class="i">+                    nullable: false,
</a><a href="#h26-1-32" id="h26-1-32" class="i">+                    default: None,
</a><a href="#h26-1-33" id="h26-1-33" class="i">+                    unique: false,
</a><a href="#h26-1-34" id="h26-1-34" class="i">+                    references: Some(
</a><a href="#h26-1-35" id="h26-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h26-1-36" id="h26-1-36" class="i">+                    ),
</a><a href="#h26-1-37" id="h26-1-37" class="i">+                    index: true,
</a><a href="#h26-1-38" id="h26-1-38" class="i">+                },
</a><a href="#h26-1-39" id="h26-1-39" class="i">+                Column {
</a><a href="#h26-1-40" id="h26-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h26-1-41" id="h26-1-41" class="i">+                    datatype: Integer,
</a><a href="#h26-1-42" id="h26-1-42" class="i">+                    primary_key: false,
</a><a href="#h26-1-43" id="h26-1-43" class="i">+                    nullable: false,
</a><a href="#h26-1-44" id="h26-1-44" class="i">+                    default: None,
</a><a href="#h26-1-45" id="h26-1-45" class="i">+                    unique: false,
</a><a href="#h26-1-46" id="h26-1-46" class="i">+                    references: Some(
</a><a href="#h26-1-47" id="h26-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h26-1-48" id="h26-1-48" class="i">+                    ),
</a><a href="#h26-1-49" id="h26-1-49" class="i">+                    index: true,
</a><a href="#h26-1-50" id="h26-1-50" class="i">+                },
</a><a href="#h26-1-51" id="h26-1-51" class="i">+                Column {
</a><a href="#h26-1-52" id="h26-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h26-1-53" id="h26-1-53" class="i">+                    datatype: Integer,
</a><a href="#h26-1-54" id="h26-1-54" class="i">+                    primary_key: false,
</a><a href="#h26-1-55" id="h26-1-55" class="i">+                    nullable: false,
</a><a href="#h26-1-56" id="h26-1-56" class="i">+                    default: None,
</a><a href="#h26-1-57" id="h26-1-57" class="i">+                    unique: false,
</a><a href="#h26-1-58" id="h26-1-58" class="i">+                    references: None,
</a><a href="#h26-1-59" id="h26-1-59" class="i">+                    index: false,
</a><a href="#h26-1-60" id="h26-1-60" class="i">+                },
</a><a href="#h26-1-61" id="h26-1-61" class="i">+                Column {
</a><a href="#h26-1-62" id="h26-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h26-1-63" id="h26-1-63" class="i">+                    datatype: Float,
</a><a href="#h26-1-64" id="h26-1-64" class="i">+                    primary_key: false,
</a><a href="#h26-1-65" id="h26-1-65" class="i">+                    nullable: true,
</a><a href="#h26-1-66" id="h26-1-66" class="i">+                    default: Some(
</a><a href="#h26-1-67" id="h26-1-67" class="i">+                        Null,
</a><a href="#h26-1-68" id="h26-1-68" class="i">+                    ),
</a><a href="#h26-1-69" id="h26-1-69" class="i">+                    unique: false,
</a><a href="#h26-1-70" id="h26-1-70" class="i">+                    references: None,
</a><a href="#h26-1-71" id="h26-1-71" class="i">+                    index: false,
</a><a href="#h26-1-72" id="h26-1-72" class="i">+                },
</a><a href="#h26-1-73" id="h26-1-73" class="i">+                Column {
</a><a href="#h26-1-74" id="h26-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h26-1-75" id="h26-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h26-1-76" id="h26-1-76" class="i">+                    primary_key: false,
</a><a href="#h26-1-77" id="h26-1-77" class="i">+                    nullable: true,
</a><a href="#h26-1-78" id="h26-1-78" class="i">+                    default: Some(
</a><a href="#h26-1-79" id="h26-1-79" class="i">+                        Null,
</a><a href="#h26-1-80" id="h26-1-80" class="i">+                    ),
</a><a href="#h26-1-81" id="h26-1-81" class="i">+                    unique: false,
</a><a href="#h26-1-82" id="h26-1-82" class="i">+                    references: None,
</a><a href="#h26-1-83" id="h26-1-83" class="i">+                    index: false,
</a><a href="#h26-1-84" id="h26-1-84" class="i">+                },
</a><a href="#h26-1-85" id="h26-1-85" class="i">+            ],
</a><a href="#h26-1-86" id="h26-1-86" class="i">+        },
</a>         alias: None,
         filter: None,
     },
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a> b/<a href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -83,7 +83,89 @@ AST: Select {
</a> Plan: Select(
     Projection {
         source: Scan {
<a href="#h27-0-3" id="h27-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h27-0-4" id="h27-0-4" class="i">+            table: Table {
</a><a href="#h27-0-5" id="h27-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h27-0-6" id="h27-0-6" class="i">+                columns: [
</a><a href="#h27-0-7" id="h27-0-7" class="i">+                    Column {
</a><a href="#h27-0-8" id="h27-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h27-0-9" id="h27-0-9" class="i">+                        datatype: Integer,
</a><a href="#h27-0-10" id="h27-0-10" class="i">+                        primary_key: true,
</a><a href="#h27-0-11" id="h27-0-11" class="i">+                        nullable: false,
</a><a href="#h27-0-12" id="h27-0-12" class="i">+                        default: None,
</a><a href="#h27-0-13" id="h27-0-13" class="i">+                        unique: true,
</a><a href="#h27-0-14" id="h27-0-14" class="i">+                        references: None,
</a><a href="#h27-0-15" id="h27-0-15" class="i">+                        index: false,
</a><a href="#h27-0-16" id="h27-0-16" class="i">+                    },
</a><a href="#h27-0-17" id="h27-0-17" class="i">+                    Column {
</a><a href="#h27-0-18" id="h27-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h27-0-19" id="h27-0-19" class="i">+                        datatype: String,
</a><a href="#h27-0-20" id="h27-0-20" class="i">+                        primary_key: false,
</a><a href="#h27-0-21" id="h27-0-21" class="i">+                        nullable: false,
</a><a href="#h27-0-22" id="h27-0-22" class="i">+                        default: None,
</a><a href="#h27-0-23" id="h27-0-23" class="i">+                        unique: false,
</a><a href="#h27-0-24" id="h27-0-24" class="i">+                        references: None,
</a><a href="#h27-0-25" id="h27-0-25" class="i">+                        index: false,
</a><a href="#h27-0-26" id="h27-0-26" class="i">+                    },
</a><a href="#h27-0-27" id="h27-0-27" class="i">+                    Column {
</a><a href="#h27-0-28" id="h27-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h27-0-29" id="h27-0-29" class="i">+                        datatype: Integer,
</a><a href="#h27-0-30" id="h27-0-30" class="i">+                        primary_key: false,
</a><a href="#h27-0-31" id="h27-0-31" class="i">+                        nullable: false,
</a><a href="#h27-0-32" id="h27-0-32" class="i">+                        default: None,
</a><a href="#h27-0-33" id="h27-0-33" class="i">+                        unique: false,
</a><a href="#h27-0-34" id="h27-0-34" class="i">+                        references: Some(
</a><a href="#h27-0-35" id="h27-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h27-0-36" id="h27-0-36" class="i">+                        ),
</a><a href="#h27-0-37" id="h27-0-37" class="i">+                        index: true,
</a><a href="#h27-0-38" id="h27-0-38" class="i">+                    },
</a><a href="#h27-0-39" id="h27-0-39" class="i">+                    Column {
</a><a href="#h27-0-40" id="h27-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h27-0-41" id="h27-0-41" class="i">+                        datatype: Integer,
</a><a href="#h27-0-42" id="h27-0-42" class="i">+                        primary_key: false,
</a><a href="#h27-0-43" id="h27-0-43" class="i">+                        nullable: false,
</a><a href="#h27-0-44" id="h27-0-44" class="i">+                        default: None,
</a><a href="#h27-0-45" id="h27-0-45" class="i">+                        unique: false,
</a><a href="#h27-0-46" id="h27-0-46" class="i">+                        references: Some(
</a><a href="#h27-0-47" id="h27-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h27-0-48" id="h27-0-48" class="i">+                        ),
</a><a href="#h27-0-49" id="h27-0-49" class="i">+                        index: true,
</a><a href="#h27-0-50" id="h27-0-50" class="i">+                    },
</a><a href="#h27-0-51" id="h27-0-51" class="i">+                    Column {
</a><a href="#h27-0-52" id="h27-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h27-0-53" id="h27-0-53" class="i">+                        datatype: Integer,
</a><a href="#h27-0-54" id="h27-0-54" class="i">+                        primary_key: false,
</a><a href="#h27-0-55" id="h27-0-55" class="i">+                        nullable: false,
</a><a href="#h27-0-56" id="h27-0-56" class="i">+                        default: None,
</a><a href="#h27-0-57" id="h27-0-57" class="i">+                        unique: false,
</a><a href="#h27-0-58" id="h27-0-58" class="i">+                        references: None,
</a><a href="#h27-0-59" id="h27-0-59" class="i">+                        index: false,
</a><a href="#h27-0-60" id="h27-0-60" class="i">+                    },
</a><a href="#h27-0-61" id="h27-0-61" class="i">+                    Column {
</a><a href="#h27-0-62" id="h27-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h27-0-63" id="h27-0-63" class="i">+                        datatype: Float,
</a><a href="#h27-0-64" id="h27-0-64" class="i">+                        primary_key: false,
</a><a href="#h27-0-65" id="h27-0-65" class="i">+                        nullable: true,
</a><a href="#h27-0-66" id="h27-0-66" class="i">+                        default: Some(
</a><a href="#h27-0-67" id="h27-0-67" class="i">+                            Null,
</a><a href="#h27-0-68" id="h27-0-68" class="i">+                        ),
</a><a href="#h27-0-69" id="h27-0-69" class="i">+                        unique: false,
</a><a href="#h27-0-70" id="h27-0-70" class="i">+                        references: None,
</a><a href="#h27-0-71" id="h27-0-71" class="i">+                        index: false,
</a><a href="#h27-0-72" id="h27-0-72" class="i">+                    },
</a><a href="#h27-0-73" id="h27-0-73" class="i">+                    Column {
</a><a href="#h27-0-74" id="h27-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h27-0-75" id="h27-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h27-0-76" id="h27-0-76" class="i">+                        primary_key: false,
</a><a href="#h27-0-77" id="h27-0-77" class="i">+                        nullable: true,
</a><a href="#h27-0-78" id="h27-0-78" class="i">+                        default: Some(
</a><a href="#h27-0-79" id="h27-0-79" class="i">+                            Null,
</a><a href="#h27-0-80" id="h27-0-80" class="i">+                        ),
</a><a href="#h27-0-81" id="h27-0-81" class="i">+                        unique: false,
</a><a href="#h27-0-82" id="h27-0-82" class="i">+                        references: None,
</a><a href="#h27-0-83" id="h27-0-83" class="i">+                        index: false,
</a><a href="#h27-0-84" id="h27-0-84" class="i">+                    },
</a><a href="#h27-0-85" id="h27-0-85" class="i">+                ],
</a><a href="#h27-0-86" id="h27-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h27-1" id="h27-1" class="h">@@ -147,7 +229,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Projection {
         source: Scan {
<a href="#h27-1-3" id="h27-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h27-1-4" id="h27-1-4" class="i">+            table: Table {
</a><a href="#h27-1-5" id="h27-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h27-1-6" id="h27-1-6" class="i">+                columns: [
</a><a href="#h27-1-7" id="h27-1-7" class="i">+                    Column {
</a><a href="#h27-1-8" id="h27-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h27-1-9" id="h27-1-9" class="i">+                        datatype: Integer,
</a><a href="#h27-1-10" id="h27-1-10" class="i">+                        primary_key: true,
</a><a href="#h27-1-11" id="h27-1-11" class="i">+                        nullable: false,
</a><a href="#h27-1-12" id="h27-1-12" class="i">+                        default: None,
</a><a href="#h27-1-13" id="h27-1-13" class="i">+                        unique: true,
</a><a href="#h27-1-14" id="h27-1-14" class="i">+                        references: None,
</a><a href="#h27-1-15" id="h27-1-15" class="i">+                        index: false,
</a><a href="#h27-1-16" id="h27-1-16" class="i">+                    },
</a><a href="#h27-1-17" id="h27-1-17" class="i">+                    Column {
</a><a href="#h27-1-18" id="h27-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h27-1-19" id="h27-1-19" class="i">+                        datatype: String,
</a><a href="#h27-1-20" id="h27-1-20" class="i">+                        primary_key: false,
</a><a href="#h27-1-21" id="h27-1-21" class="i">+                        nullable: false,
</a><a href="#h27-1-22" id="h27-1-22" class="i">+                        default: None,
</a><a href="#h27-1-23" id="h27-1-23" class="i">+                        unique: false,
</a><a href="#h27-1-24" id="h27-1-24" class="i">+                        references: None,
</a><a href="#h27-1-25" id="h27-1-25" class="i">+                        index: false,
</a><a href="#h27-1-26" id="h27-1-26" class="i">+                    },
</a><a href="#h27-1-27" id="h27-1-27" class="i">+                    Column {
</a><a href="#h27-1-28" id="h27-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h27-1-29" id="h27-1-29" class="i">+                        datatype: Integer,
</a><a href="#h27-1-30" id="h27-1-30" class="i">+                        primary_key: false,
</a><a href="#h27-1-31" id="h27-1-31" class="i">+                        nullable: false,
</a><a href="#h27-1-32" id="h27-1-32" class="i">+                        default: None,
</a><a href="#h27-1-33" id="h27-1-33" class="i">+                        unique: false,
</a><a href="#h27-1-34" id="h27-1-34" class="i">+                        references: Some(
</a><a href="#h27-1-35" id="h27-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h27-1-36" id="h27-1-36" class="i">+                        ),
</a><a href="#h27-1-37" id="h27-1-37" class="i">+                        index: true,
</a><a href="#h27-1-38" id="h27-1-38" class="i">+                    },
</a><a href="#h27-1-39" id="h27-1-39" class="i">+                    Column {
</a><a href="#h27-1-40" id="h27-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h27-1-41" id="h27-1-41" class="i">+                        datatype: Integer,
</a><a href="#h27-1-42" id="h27-1-42" class="i">+                        primary_key: false,
</a><a href="#h27-1-43" id="h27-1-43" class="i">+                        nullable: false,
</a><a href="#h27-1-44" id="h27-1-44" class="i">+                        default: None,
</a><a href="#h27-1-45" id="h27-1-45" class="i">+                        unique: false,
</a><a href="#h27-1-46" id="h27-1-46" class="i">+                        references: Some(
</a><a href="#h27-1-47" id="h27-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h27-1-48" id="h27-1-48" class="i">+                        ),
</a><a href="#h27-1-49" id="h27-1-49" class="i">+                        index: true,
</a><a href="#h27-1-50" id="h27-1-50" class="i">+                    },
</a><a href="#h27-1-51" id="h27-1-51" class="i">+                    Column {
</a><a href="#h27-1-52" id="h27-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h27-1-53" id="h27-1-53" class="i">+                        datatype: Integer,
</a><a href="#h27-1-54" id="h27-1-54" class="i">+                        primary_key: false,
</a><a href="#h27-1-55" id="h27-1-55" class="i">+                        nullable: false,
</a><a href="#h27-1-56" id="h27-1-56" class="i">+                        default: None,
</a><a href="#h27-1-57" id="h27-1-57" class="i">+                        unique: false,
</a><a href="#h27-1-58" id="h27-1-58" class="i">+                        references: None,
</a><a href="#h27-1-59" id="h27-1-59" class="i">+                        index: false,
</a><a href="#h27-1-60" id="h27-1-60" class="i">+                    },
</a><a href="#h27-1-61" id="h27-1-61" class="i">+                    Column {
</a><a href="#h27-1-62" id="h27-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h27-1-63" id="h27-1-63" class="i">+                        datatype: Float,
</a><a href="#h27-1-64" id="h27-1-64" class="i">+                        primary_key: false,
</a><a href="#h27-1-65" id="h27-1-65" class="i">+                        nullable: true,
</a><a href="#h27-1-66" id="h27-1-66" class="i">+                        default: Some(
</a><a href="#h27-1-67" id="h27-1-67" class="i">+                            Null,
</a><a href="#h27-1-68" id="h27-1-68" class="i">+                        ),
</a><a href="#h27-1-69" id="h27-1-69" class="i">+                        unique: false,
</a><a href="#h27-1-70" id="h27-1-70" class="i">+                        references: None,
</a><a href="#h27-1-71" id="h27-1-71" class="i">+                        index: false,
</a><a href="#h27-1-72" id="h27-1-72" class="i">+                    },
</a><a href="#h27-1-73" id="h27-1-73" class="i">+                    Column {
</a><a href="#h27-1-74" id="h27-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h27-1-75" id="h27-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h27-1-76" id="h27-1-76" class="i">+                        primary_key: false,
</a><a href="#h27-1-77" id="h27-1-77" class="i">+                        nullable: true,
</a><a href="#h27-1-78" id="h27-1-78" class="i">+                        default: Some(
</a><a href="#h27-1-79" id="h27-1-79" class="i">+                            Null,
</a><a href="#h27-1-80" id="h27-1-80" class="i">+                        ),
</a><a href="#h27-1-81" id="h27-1-81" class="i">+                        unique: false,
</a><a href="#h27-1-82" id="h27-1-82" class="i">+                        references: None,
</a><a href="#h27-1-83" id="h27-1-83" class="i">+                        index: false,
</a><a href="#h27-1-84" id="h27-1-84" class="i">+                    },
</a><a href="#h27-1-85" id="h27-1-85" class="i">+                ],
</a><a href="#h27-1-86" id="h27-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a> b/<a href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -80,7 +80,89 @@ AST: Select {
</a> Plan: Select(
     Projection {
         source: Scan {
<a href="#h28-0-3" id="h28-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h28-0-4" id="h28-0-4" class="i">+            table: Table {
</a><a href="#h28-0-5" id="h28-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h28-0-6" id="h28-0-6" class="i">+                columns: [
</a><a href="#h28-0-7" id="h28-0-7" class="i">+                    Column {
</a><a href="#h28-0-8" id="h28-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h28-0-9" id="h28-0-9" class="i">+                        datatype: Integer,
</a><a href="#h28-0-10" id="h28-0-10" class="i">+                        primary_key: true,
</a><a href="#h28-0-11" id="h28-0-11" class="i">+                        nullable: false,
</a><a href="#h28-0-12" id="h28-0-12" class="i">+                        default: None,
</a><a href="#h28-0-13" id="h28-0-13" class="i">+                        unique: true,
</a><a href="#h28-0-14" id="h28-0-14" class="i">+                        references: None,
</a><a href="#h28-0-15" id="h28-0-15" class="i">+                        index: false,
</a><a href="#h28-0-16" id="h28-0-16" class="i">+                    },
</a><a href="#h28-0-17" id="h28-0-17" class="i">+                    Column {
</a><a href="#h28-0-18" id="h28-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h28-0-19" id="h28-0-19" class="i">+                        datatype: String,
</a><a href="#h28-0-20" id="h28-0-20" class="i">+                        primary_key: false,
</a><a href="#h28-0-21" id="h28-0-21" class="i">+                        nullable: false,
</a><a href="#h28-0-22" id="h28-0-22" class="i">+                        default: None,
</a><a href="#h28-0-23" id="h28-0-23" class="i">+                        unique: false,
</a><a href="#h28-0-24" id="h28-0-24" class="i">+                        references: None,
</a><a href="#h28-0-25" id="h28-0-25" class="i">+                        index: false,
</a><a href="#h28-0-26" id="h28-0-26" class="i">+                    },
</a><a href="#h28-0-27" id="h28-0-27" class="i">+                    Column {
</a><a href="#h28-0-28" id="h28-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h28-0-29" id="h28-0-29" class="i">+                        datatype: Integer,
</a><a href="#h28-0-30" id="h28-0-30" class="i">+                        primary_key: false,
</a><a href="#h28-0-31" id="h28-0-31" class="i">+                        nullable: false,
</a><a href="#h28-0-32" id="h28-0-32" class="i">+                        default: None,
</a><a href="#h28-0-33" id="h28-0-33" class="i">+                        unique: false,
</a><a href="#h28-0-34" id="h28-0-34" class="i">+                        references: Some(
</a><a href="#h28-0-35" id="h28-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h28-0-36" id="h28-0-36" class="i">+                        ),
</a><a href="#h28-0-37" id="h28-0-37" class="i">+                        index: true,
</a><a href="#h28-0-38" id="h28-0-38" class="i">+                    },
</a><a href="#h28-0-39" id="h28-0-39" class="i">+                    Column {
</a><a href="#h28-0-40" id="h28-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h28-0-41" id="h28-0-41" class="i">+                        datatype: Integer,
</a><a href="#h28-0-42" id="h28-0-42" class="i">+                        primary_key: false,
</a><a href="#h28-0-43" id="h28-0-43" class="i">+                        nullable: false,
</a><a href="#h28-0-44" id="h28-0-44" class="i">+                        default: None,
</a><a href="#h28-0-45" id="h28-0-45" class="i">+                        unique: false,
</a><a href="#h28-0-46" id="h28-0-46" class="i">+                        references: Some(
</a><a href="#h28-0-47" id="h28-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h28-0-48" id="h28-0-48" class="i">+                        ),
</a><a href="#h28-0-49" id="h28-0-49" class="i">+                        index: true,
</a><a href="#h28-0-50" id="h28-0-50" class="i">+                    },
</a><a href="#h28-0-51" id="h28-0-51" class="i">+                    Column {
</a><a href="#h28-0-52" id="h28-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h28-0-53" id="h28-0-53" class="i">+                        datatype: Integer,
</a><a href="#h28-0-54" id="h28-0-54" class="i">+                        primary_key: false,
</a><a href="#h28-0-55" id="h28-0-55" class="i">+                        nullable: false,
</a><a href="#h28-0-56" id="h28-0-56" class="i">+                        default: None,
</a><a href="#h28-0-57" id="h28-0-57" class="i">+                        unique: false,
</a><a href="#h28-0-58" id="h28-0-58" class="i">+                        references: None,
</a><a href="#h28-0-59" id="h28-0-59" class="i">+                        index: false,
</a><a href="#h28-0-60" id="h28-0-60" class="i">+                    },
</a><a href="#h28-0-61" id="h28-0-61" class="i">+                    Column {
</a><a href="#h28-0-62" id="h28-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h28-0-63" id="h28-0-63" class="i">+                        datatype: Float,
</a><a href="#h28-0-64" id="h28-0-64" class="i">+                        primary_key: false,
</a><a href="#h28-0-65" id="h28-0-65" class="i">+                        nullable: true,
</a><a href="#h28-0-66" id="h28-0-66" class="i">+                        default: Some(
</a><a href="#h28-0-67" id="h28-0-67" class="i">+                            Null,
</a><a href="#h28-0-68" id="h28-0-68" class="i">+                        ),
</a><a href="#h28-0-69" id="h28-0-69" class="i">+                        unique: false,
</a><a href="#h28-0-70" id="h28-0-70" class="i">+                        references: None,
</a><a href="#h28-0-71" id="h28-0-71" class="i">+                        index: false,
</a><a href="#h28-0-72" id="h28-0-72" class="i">+                    },
</a><a href="#h28-0-73" id="h28-0-73" class="i">+                    Column {
</a><a href="#h28-0-74" id="h28-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h28-0-75" id="h28-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h28-0-76" id="h28-0-76" class="i">+                        primary_key: false,
</a><a href="#h28-0-77" id="h28-0-77" class="i">+                        nullable: true,
</a><a href="#h28-0-78" id="h28-0-78" class="i">+                        default: Some(
</a><a href="#h28-0-79" id="h28-0-79" class="i">+                            Null,
</a><a href="#h28-0-80" id="h28-0-80" class="i">+                        ),
</a><a href="#h28-0-81" id="h28-0-81" class="i">+                        unique: false,
</a><a href="#h28-0-82" id="h28-0-82" class="i">+                        references: None,
</a><a href="#h28-0-83" id="h28-0-83" class="i">+                        index: false,
</a><a href="#h28-0-84" id="h28-0-84" class="i">+                    },
</a><a href="#h28-0-85" id="h28-0-85" class="i">+                ],
</a><a href="#h28-0-86" id="h28-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h28-1" id="h28-1" class="h">@@ -135,7 +217,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Projection {
         source: Scan {
<a href="#h28-1-3" id="h28-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h28-1-4" id="h28-1-4" class="i">+            table: Table {
</a><a href="#h28-1-5" id="h28-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h28-1-6" id="h28-1-6" class="i">+                columns: [
</a><a href="#h28-1-7" id="h28-1-7" class="i">+                    Column {
</a><a href="#h28-1-8" id="h28-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h28-1-9" id="h28-1-9" class="i">+                        datatype: Integer,
</a><a href="#h28-1-10" id="h28-1-10" class="i">+                        primary_key: true,
</a><a href="#h28-1-11" id="h28-1-11" class="i">+                        nullable: false,
</a><a href="#h28-1-12" id="h28-1-12" class="i">+                        default: None,
</a><a href="#h28-1-13" id="h28-1-13" class="i">+                        unique: true,
</a><a href="#h28-1-14" id="h28-1-14" class="i">+                        references: None,
</a><a href="#h28-1-15" id="h28-1-15" class="i">+                        index: false,
</a><a href="#h28-1-16" id="h28-1-16" class="i">+                    },
</a><a href="#h28-1-17" id="h28-1-17" class="i">+                    Column {
</a><a href="#h28-1-18" id="h28-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h28-1-19" id="h28-1-19" class="i">+                        datatype: String,
</a><a href="#h28-1-20" id="h28-1-20" class="i">+                        primary_key: false,
</a><a href="#h28-1-21" id="h28-1-21" class="i">+                        nullable: false,
</a><a href="#h28-1-22" id="h28-1-22" class="i">+                        default: None,
</a><a href="#h28-1-23" id="h28-1-23" class="i">+                        unique: false,
</a><a href="#h28-1-24" id="h28-1-24" class="i">+                        references: None,
</a><a href="#h28-1-25" id="h28-1-25" class="i">+                        index: false,
</a><a href="#h28-1-26" id="h28-1-26" class="i">+                    },
</a><a href="#h28-1-27" id="h28-1-27" class="i">+                    Column {
</a><a href="#h28-1-28" id="h28-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h28-1-29" id="h28-1-29" class="i">+                        datatype: Integer,
</a><a href="#h28-1-30" id="h28-1-30" class="i">+                        primary_key: false,
</a><a href="#h28-1-31" id="h28-1-31" class="i">+                        nullable: false,
</a><a href="#h28-1-32" id="h28-1-32" class="i">+                        default: None,
</a><a href="#h28-1-33" id="h28-1-33" class="i">+                        unique: false,
</a><a href="#h28-1-34" id="h28-1-34" class="i">+                        references: Some(
</a><a href="#h28-1-35" id="h28-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h28-1-36" id="h28-1-36" class="i">+                        ),
</a><a href="#h28-1-37" id="h28-1-37" class="i">+                        index: true,
</a><a href="#h28-1-38" id="h28-1-38" class="i">+                    },
</a><a href="#h28-1-39" id="h28-1-39" class="i">+                    Column {
</a><a href="#h28-1-40" id="h28-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h28-1-41" id="h28-1-41" class="i">+                        datatype: Integer,
</a><a href="#h28-1-42" id="h28-1-42" class="i">+                        primary_key: false,
</a><a href="#h28-1-43" id="h28-1-43" class="i">+                        nullable: false,
</a><a href="#h28-1-44" id="h28-1-44" class="i">+                        default: None,
</a><a href="#h28-1-45" id="h28-1-45" class="i">+                        unique: false,
</a><a href="#h28-1-46" id="h28-1-46" class="i">+                        references: Some(
</a><a href="#h28-1-47" id="h28-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h28-1-48" id="h28-1-48" class="i">+                        ),
</a><a href="#h28-1-49" id="h28-1-49" class="i">+                        index: true,
</a><a href="#h28-1-50" id="h28-1-50" class="i">+                    },
</a><a href="#h28-1-51" id="h28-1-51" class="i">+                    Column {
</a><a href="#h28-1-52" id="h28-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h28-1-53" id="h28-1-53" class="i">+                        datatype: Integer,
</a><a href="#h28-1-54" id="h28-1-54" class="i">+                        primary_key: false,
</a><a href="#h28-1-55" id="h28-1-55" class="i">+                        nullable: false,
</a><a href="#h28-1-56" id="h28-1-56" class="i">+                        default: None,
</a><a href="#h28-1-57" id="h28-1-57" class="i">+                        unique: false,
</a><a href="#h28-1-58" id="h28-1-58" class="i">+                        references: None,
</a><a href="#h28-1-59" id="h28-1-59" class="i">+                        index: false,
</a><a href="#h28-1-60" id="h28-1-60" class="i">+                    },
</a><a href="#h28-1-61" id="h28-1-61" class="i">+                    Column {
</a><a href="#h28-1-62" id="h28-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h28-1-63" id="h28-1-63" class="i">+                        datatype: Float,
</a><a href="#h28-1-64" id="h28-1-64" class="i">+                        primary_key: false,
</a><a href="#h28-1-65" id="h28-1-65" class="i">+                        nullable: true,
</a><a href="#h28-1-66" id="h28-1-66" class="i">+                        default: Some(
</a><a href="#h28-1-67" id="h28-1-67" class="i">+                            Null,
</a><a href="#h28-1-68" id="h28-1-68" class="i">+                        ),
</a><a href="#h28-1-69" id="h28-1-69" class="i">+                        unique: false,
</a><a href="#h28-1-70" id="h28-1-70" class="i">+                        references: None,
</a><a href="#h28-1-71" id="h28-1-71" class="i">+                        index: false,
</a><a href="#h28-1-72" id="h28-1-72" class="i">+                    },
</a><a href="#h28-1-73" id="h28-1-73" class="i">+                    Column {
</a><a href="#h28-1-74" id="h28-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h28-1-75" id="h28-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h28-1-76" id="h28-1-76" class="i">+                        primary_key: false,
</a><a href="#h28-1-77" id="h28-1-77" class="i">+                        nullable: true,
</a><a href="#h28-1-78" id="h28-1-78" class="i">+                        default: Some(
</a><a href="#h28-1-79" id="h28-1-79" class="i">+                            Null,
</a><a href="#h28-1-80" id="h28-1-80" class="i">+                        ),
</a><a href="#h28-1-81" id="h28-1-81" class="i">+                        unique: false,
</a><a href="#h28-1-82" id="h28-1-82" class="i">+                        references: None,
</a><a href="#h28-1-83" id="h28-1-83" class="i">+                        index: false,
</a><a href="#h28-1-84" id="h28-1-84" class="i">+                    },
</a><a href="#h28-1-85" id="h28-1-85" class="i">+                ],
</a><a href="#h28-1-86" id="h28-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a> b/<a href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -85,7 +85,89 @@ Plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h29-0-3" id="h29-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h29-0-4" id="h29-0-4" class="i">+                table: Table {
</a><a href="#h29-0-5" id="h29-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h29-0-6" id="h29-0-6" class="i">+                    columns: [
</a><a href="#h29-0-7" id="h29-0-7" class="i">+                        Column {
</a><a href="#h29-0-8" id="h29-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h29-0-9" id="h29-0-9" class="i">+                            datatype: Integer,
</a><a href="#h29-0-10" id="h29-0-10" class="i">+                            primary_key: true,
</a><a href="#h29-0-11" id="h29-0-11" class="i">+                            nullable: false,
</a><a href="#h29-0-12" id="h29-0-12" class="i">+                            default: None,
</a><a href="#h29-0-13" id="h29-0-13" class="i">+                            unique: true,
</a><a href="#h29-0-14" id="h29-0-14" class="i">+                            references: None,
</a><a href="#h29-0-15" id="h29-0-15" class="i">+                            index: false,
</a><a href="#h29-0-16" id="h29-0-16" class="i">+                        },
</a><a href="#h29-0-17" id="h29-0-17" class="i">+                        Column {
</a><a href="#h29-0-18" id="h29-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h29-0-19" id="h29-0-19" class="i">+                            datatype: String,
</a><a href="#h29-0-20" id="h29-0-20" class="i">+                            primary_key: false,
</a><a href="#h29-0-21" id="h29-0-21" class="i">+                            nullable: false,
</a><a href="#h29-0-22" id="h29-0-22" class="i">+                            default: None,
</a><a href="#h29-0-23" id="h29-0-23" class="i">+                            unique: false,
</a><a href="#h29-0-24" id="h29-0-24" class="i">+                            references: None,
</a><a href="#h29-0-25" id="h29-0-25" class="i">+                            index: false,
</a><a href="#h29-0-26" id="h29-0-26" class="i">+                        },
</a><a href="#h29-0-27" id="h29-0-27" class="i">+                        Column {
</a><a href="#h29-0-28" id="h29-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h29-0-29" id="h29-0-29" class="i">+                            datatype: Integer,
</a><a href="#h29-0-30" id="h29-0-30" class="i">+                            primary_key: false,
</a><a href="#h29-0-31" id="h29-0-31" class="i">+                            nullable: false,
</a><a href="#h29-0-32" id="h29-0-32" class="i">+                            default: None,
</a><a href="#h29-0-33" id="h29-0-33" class="i">+                            unique: false,
</a><a href="#h29-0-34" id="h29-0-34" class="i">+                            references: Some(
</a><a href="#h29-0-35" id="h29-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h29-0-36" id="h29-0-36" class="i">+                            ),
</a><a href="#h29-0-37" id="h29-0-37" class="i">+                            index: true,
</a><a href="#h29-0-38" id="h29-0-38" class="i">+                        },
</a><a href="#h29-0-39" id="h29-0-39" class="i">+                        Column {
</a><a href="#h29-0-40" id="h29-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h29-0-41" id="h29-0-41" class="i">+                            datatype: Integer,
</a><a href="#h29-0-42" id="h29-0-42" class="i">+                            primary_key: false,
</a><a href="#h29-0-43" id="h29-0-43" class="i">+                            nullable: false,
</a><a href="#h29-0-44" id="h29-0-44" class="i">+                            default: None,
</a><a href="#h29-0-45" id="h29-0-45" class="i">+                            unique: false,
</a><a href="#h29-0-46" id="h29-0-46" class="i">+                            references: Some(
</a><a href="#h29-0-47" id="h29-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h29-0-48" id="h29-0-48" class="i">+                            ),
</a><a href="#h29-0-49" id="h29-0-49" class="i">+                            index: true,
</a><a href="#h29-0-50" id="h29-0-50" class="i">+                        },
</a><a href="#h29-0-51" id="h29-0-51" class="i">+                        Column {
</a><a href="#h29-0-52" id="h29-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h29-0-53" id="h29-0-53" class="i">+                            datatype: Integer,
</a><a href="#h29-0-54" id="h29-0-54" class="i">+                            primary_key: false,
</a><a href="#h29-0-55" id="h29-0-55" class="i">+                            nullable: false,
</a><a href="#h29-0-56" id="h29-0-56" class="i">+                            default: None,
</a><a href="#h29-0-57" id="h29-0-57" class="i">+                            unique: false,
</a><a href="#h29-0-58" id="h29-0-58" class="i">+                            references: None,
</a><a href="#h29-0-59" id="h29-0-59" class="i">+                            index: false,
</a><a href="#h29-0-60" id="h29-0-60" class="i">+                        },
</a><a href="#h29-0-61" id="h29-0-61" class="i">+                        Column {
</a><a href="#h29-0-62" id="h29-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h29-0-63" id="h29-0-63" class="i">+                            datatype: Float,
</a><a href="#h29-0-64" id="h29-0-64" class="i">+                            primary_key: false,
</a><a href="#h29-0-65" id="h29-0-65" class="i">+                            nullable: true,
</a><a href="#h29-0-66" id="h29-0-66" class="i">+                            default: Some(
</a><a href="#h29-0-67" id="h29-0-67" class="i">+                                Null,
</a><a href="#h29-0-68" id="h29-0-68" class="i">+                            ),
</a><a href="#h29-0-69" id="h29-0-69" class="i">+                            unique: false,
</a><a href="#h29-0-70" id="h29-0-70" class="i">+                            references: None,
</a><a href="#h29-0-71" id="h29-0-71" class="i">+                            index: false,
</a><a href="#h29-0-72" id="h29-0-72" class="i">+                        },
</a><a href="#h29-0-73" id="h29-0-73" class="i">+                        Column {
</a><a href="#h29-0-74" id="h29-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h29-0-75" id="h29-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h29-0-76" id="h29-0-76" class="i">+                            primary_key: false,
</a><a href="#h29-0-77" id="h29-0-77" class="i">+                            nullable: true,
</a><a href="#h29-0-78" id="h29-0-78" class="i">+                            default: Some(
</a><a href="#h29-0-79" id="h29-0-79" class="i">+                                Null,
</a><a href="#h29-0-80" id="h29-0-80" class="i">+                            ),
</a><a href="#h29-0-81" id="h29-0-81" class="i">+                            unique: false,
</a><a href="#h29-0-82" id="h29-0-82" class="i">+                            references: None,
</a><a href="#h29-0-83" id="h29-0-83" class="i">+                            index: false,
</a><a href="#h29-0-84" id="h29-0-84" class="i">+                        },
</a><a href="#h29-0-85" id="h29-0-85" class="i">+                    ],
</a><a href="#h29-0-86" id="h29-0-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h29-1" id="h29-1" class="h">@@ -93,7 +175,31 @@ Plan: Select(
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h29-1-3" id="h29-1-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h29-1-4" id="h29-1-4" class="i">+                table: Table {
</a><a href="#h29-1-5" id="h29-1-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h29-1-6" id="h29-1-6" class="i">+                    columns: [
</a><a href="#h29-1-7" id="h29-1-7" class="i">+                        Column {
</a><a href="#h29-1-8" id="h29-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h29-1-9" id="h29-1-9" class="i">+                            datatype: Integer,
</a><a href="#h29-1-10" id="h29-1-10" class="i">+                            primary_key: true,
</a><a href="#h29-1-11" id="h29-1-11" class="i">+                            nullable: false,
</a><a href="#h29-1-12" id="h29-1-12" class="i">+                            default: None,
</a><a href="#h29-1-13" id="h29-1-13" class="i">+                            unique: true,
</a><a href="#h29-1-14" id="h29-1-14" class="i">+                            references: None,
</a><a href="#h29-1-15" id="h29-1-15" class="i">+                            index: false,
</a><a href="#h29-1-16" id="h29-1-16" class="i">+                        },
</a><a href="#h29-1-17" id="h29-1-17" class="i">+                        Column {
</a><a href="#h29-1-18" id="h29-1-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h29-1-19" id="h29-1-19" class="i">+                            datatype: String,
</a><a href="#h29-1-20" id="h29-1-20" class="i">+                            primary_key: false,
</a><a href="#h29-1-21" id="h29-1-21" class="i">+                            nullable: false,
</a><a href="#h29-1-22" id="h29-1-22" class="i">+                            default: None,
</a><a href="#h29-1-23" id="h29-1-23" class="i">+                            unique: false,
</a><a href="#h29-1-24" id="h29-1-24" class="i">+                            references: None,
</a><a href="#h29-1-25" id="h29-1-25" class="i">+                            index: false,
</a><a href="#h29-1-26" id="h29-1-26" class="i">+                        },
</a><a href="#h29-1-27" id="h29-1-27" class="i">+                    ],
</a><a href="#h29-1-28" id="h29-1-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h29-2" id="h29-2" class="h">@@ -139,7 +245,89 @@ Optimized plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h29-2-3" id="h29-2-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h29-2-4" id="h29-2-4" class="i">+                table: Table {
</a><a href="#h29-2-5" id="h29-2-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h29-2-6" id="h29-2-6" class="i">+                    columns: [
</a><a href="#h29-2-7" id="h29-2-7" class="i">+                        Column {
</a><a href="#h29-2-8" id="h29-2-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h29-2-9" id="h29-2-9" class="i">+                            datatype: Integer,
</a><a href="#h29-2-10" id="h29-2-10" class="i">+                            primary_key: true,
</a><a href="#h29-2-11" id="h29-2-11" class="i">+                            nullable: false,
</a><a href="#h29-2-12" id="h29-2-12" class="i">+                            default: None,
</a><a href="#h29-2-13" id="h29-2-13" class="i">+                            unique: true,
</a><a href="#h29-2-14" id="h29-2-14" class="i">+                            references: None,
</a><a href="#h29-2-15" id="h29-2-15" class="i">+                            index: false,
</a><a href="#h29-2-16" id="h29-2-16" class="i">+                        },
</a><a href="#h29-2-17" id="h29-2-17" class="i">+                        Column {
</a><a href="#h29-2-18" id="h29-2-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h29-2-19" id="h29-2-19" class="i">+                            datatype: String,
</a><a href="#h29-2-20" id="h29-2-20" class="i">+                            primary_key: false,
</a><a href="#h29-2-21" id="h29-2-21" class="i">+                            nullable: false,
</a><a href="#h29-2-22" id="h29-2-22" class="i">+                            default: None,
</a><a href="#h29-2-23" id="h29-2-23" class="i">+                            unique: false,
</a><a href="#h29-2-24" id="h29-2-24" class="i">+                            references: None,
</a><a href="#h29-2-25" id="h29-2-25" class="i">+                            index: false,
</a><a href="#h29-2-26" id="h29-2-26" class="i">+                        },
</a><a href="#h29-2-27" id="h29-2-27" class="i">+                        Column {
</a><a href="#h29-2-28" id="h29-2-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h29-2-29" id="h29-2-29" class="i">+                            datatype: Integer,
</a><a href="#h29-2-30" id="h29-2-30" class="i">+                            primary_key: false,
</a><a href="#h29-2-31" id="h29-2-31" class="i">+                            nullable: false,
</a><a href="#h29-2-32" id="h29-2-32" class="i">+                            default: None,
</a><a href="#h29-2-33" id="h29-2-33" class="i">+                            unique: false,
</a><a href="#h29-2-34" id="h29-2-34" class="i">+                            references: Some(
</a><a href="#h29-2-35" id="h29-2-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h29-2-36" id="h29-2-36" class="i">+                            ),
</a><a href="#h29-2-37" id="h29-2-37" class="i">+                            index: true,
</a><a href="#h29-2-38" id="h29-2-38" class="i">+                        },
</a><a href="#h29-2-39" id="h29-2-39" class="i">+                        Column {
</a><a href="#h29-2-40" id="h29-2-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h29-2-41" id="h29-2-41" class="i">+                            datatype: Integer,
</a><a href="#h29-2-42" id="h29-2-42" class="i">+                            primary_key: false,
</a><a href="#h29-2-43" id="h29-2-43" class="i">+                            nullable: false,
</a><a href="#h29-2-44" id="h29-2-44" class="i">+                            default: None,
</a><a href="#h29-2-45" id="h29-2-45" class="i">+                            unique: false,
</a><a href="#h29-2-46" id="h29-2-46" class="i">+                            references: Some(
</a><a href="#h29-2-47" id="h29-2-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h29-2-48" id="h29-2-48" class="i">+                            ),
</a><a href="#h29-2-49" id="h29-2-49" class="i">+                            index: true,
</a><a href="#h29-2-50" id="h29-2-50" class="i">+                        },
</a><a href="#h29-2-51" id="h29-2-51" class="i">+                        Column {
</a><a href="#h29-2-52" id="h29-2-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h29-2-53" id="h29-2-53" class="i">+                            datatype: Integer,
</a><a href="#h29-2-54" id="h29-2-54" class="i">+                            primary_key: false,
</a><a href="#h29-2-55" id="h29-2-55" class="i">+                            nullable: false,
</a><a href="#h29-2-56" id="h29-2-56" class="i">+                            default: None,
</a><a href="#h29-2-57" id="h29-2-57" class="i">+                            unique: false,
</a><a href="#h29-2-58" id="h29-2-58" class="i">+                            references: None,
</a><a href="#h29-2-59" id="h29-2-59" class="i">+                            index: false,
</a><a href="#h29-2-60" id="h29-2-60" class="i">+                        },
</a><a href="#h29-2-61" id="h29-2-61" class="i">+                        Column {
</a><a href="#h29-2-62" id="h29-2-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h29-2-63" id="h29-2-63" class="i">+                            datatype: Float,
</a><a href="#h29-2-64" id="h29-2-64" class="i">+                            primary_key: false,
</a><a href="#h29-2-65" id="h29-2-65" class="i">+                            nullable: true,
</a><a href="#h29-2-66" id="h29-2-66" class="i">+                            default: Some(
</a><a href="#h29-2-67" id="h29-2-67" class="i">+                                Null,
</a><a href="#h29-2-68" id="h29-2-68" class="i">+                            ),
</a><a href="#h29-2-69" id="h29-2-69" class="i">+                            unique: false,
</a><a href="#h29-2-70" id="h29-2-70" class="i">+                            references: None,
</a><a href="#h29-2-71" id="h29-2-71" class="i">+                            index: false,
</a><a href="#h29-2-72" id="h29-2-72" class="i">+                        },
</a><a href="#h29-2-73" id="h29-2-73" class="i">+                        Column {
</a><a href="#h29-2-74" id="h29-2-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h29-2-75" id="h29-2-75" class="i">+                            datatype: Boolean,
</a><a href="#h29-2-76" id="h29-2-76" class="i">+                            primary_key: false,
</a><a href="#h29-2-77" id="h29-2-77" class="i">+                            nullable: true,
</a><a href="#h29-2-78" id="h29-2-78" class="i">+                            default: Some(
</a><a href="#h29-2-79" id="h29-2-79" class="i">+                                Null,
</a><a href="#h29-2-80" id="h29-2-80" class="i">+                            ),
</a><a href="#h29-2-81" id="h29-2-81" class="i">+                            unique: false,
</a><a href="#h29-2-82" id="h29-2-82" class="i">+                            references: None,
</a><a href="#h29-2-83" id="h29-2-83" class="i">+                            index: false,
</a><a href="#h29-2-84" id="h29-2-84" class="i">+                        },
</a><a href="#h29-2-85" id="h29-2-85" class="i">+                    ],
</a><a href="#h29-2-86" id="h29-2-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h29-3" id="h29-3" class="h">@@ -147,7 +335,31 @@ Optimized plan: Select(
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h29-3-3" id="h29-3-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h29-3-4" id="h29-3-4" class="i">+                table: Table {
</a><a href="#h29-3-5" id="h29-3-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h29-3-6" id="h29-3-6" class="i">+                    columns: [
</a><a href="#h29-3-7" id="h29-3-7" class="i">+                        Column {
</a><a href="#h29-3-8" id="h29-3-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h29-3-9" id="h29-3-9" class="i">+                            datatype: Integer,
</a><a href="#h29-3-10" id="h29-3-10" class="i">+                            primary_key: true,
</a><a href="#h29-3-11" id="h29-3-11" class="i">+                            nullable: false,
</a><a href="#h29-3-12" id="h29-3-12" class="i">+                            default: None,
</a><a href="#h29-3-13" id="h29-3-13" class="i">+                            unique: true,
</a><a href="#h29-3-14" id="h29-3-14" class="i">+                            references: None,
</a><a href="#h29-3-15" id="h29-3-15" class="i">+                            index: false,
</a><a href="#h29-3-16" id="h29-3-16" class="i">+                        },
</a><a href="#h29-3-17" id="h29-3-17" class="i">+                        Column {
</a><a href="#h29-3-18" id="h29-3-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h29-3-19" id="h29-3-19" class="i">+                            datatype: String,
</a><a href="#h29-3-20" id="h29-3-20" class="i">+                            primary_key: false,
</a><a href="#h29-3-21" id="h29-3-21" class="i">+                            nullable: false,
</a><a href="#h29-3-22" id="h29-3-22" class="i">+                            default: None,
</a><a href="#h29-3-23" id="h29-3-23" class="i">+                            unique: false,
</a><a href="#h29-3-24" id="h29-3-24" class="i">+                            references: None,
</a><a href="#h29-3-25" id="h29-3-25" class="i">+                            index: false,
</a><a href="#h29-3-26" id="h29-3-26" class="i">+                        },
</a><a href="#h29-3-27" id="h29-3-27" class="i">+                    ],
</a><a href="#h29-3-28" id="h29-3-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a> b/<a href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -50,7 +50,89 @@ AST: Select {
</a> Plan: Select(
     Projection {
         source: Scan {
<a href="#h30-0-3" id="h30-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h30-0-4" id="h30-0-4" class="i">+            table: Table {
</a><a href="#h30-0-5" id="h30-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h30-0-6" id="h30-0-6" class="i">+                columns: [
</a><a href="#h30-0-7" id="h30-0-7" class="i">+                    Column {
</a><a href="#h30-0-8" id="h30-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h30-0-9" id="h30-0-9" class="i">+                        datatype: Integer,
</a><a href="#h30-0-10" id="h30-0-10" class="i">+                        primary_key: true,
</a><a href="#h30-0-11" id="h30-0-11" class="i">+                        nullable: false,
</a><a href="#h30-0-12" id="h30-0-12" class="i">+                        default: None,
</a><a href="#h30-0-13" id="h30-0-13" class="i">+                        unique: true,
</a><a href="#h30-0-14" id="h30-0-14" class="i">+                        references: None,
</a><a href="#h30-0-15" id="h30-0-15" class="i">+                        index: false,
</a><a href="#h30-0-16" id="h30-0-16" class="i">+                    },
</a><a href="#h30-0-17" id="h30-0-17" class="i">+                    Column {
</a><a href="#h30-0-18" id="h30-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h30-0-19" id="h30-0-19" class="i">+                        datatype: String,
</a><a href="#h30-0-20" id="h30-0-20" class="i">+                        primary_key: false,
</a><a href="#h30-0-21" id="h30-0-21" class="i">+                        nullable: false,
</a><a href="#h30-0-22" id="h30-0-22" class="i">+                        default: None,
</a><a href="#h30-0-23" id="h30-0-23" class="i">+                        unique: false,
</a><a href="#h30-0-24" id="h30-0-24" class="i">+                        references: None,
</a><a href="#h30-0-25" id="h30-0-25" class="i">+                        index: false,
</a><a href="#h30-0-26" id="h30-0-26" class="i">+                    },
</a><a href="#h30-0-27" id="h30-0-27" class="i">+                    Column {
</a><a href="#h30-0-28" id="h30-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h30-0-29" id="h30-0-29" class="i">+                        datatype: Integer,
</a><a href="#h30-0-30" id="h30-0-30" class="i">+                        primary_key: false,
</a><a href="#h30-0-31" id="h30-0-31" class="i">+                        nullable: false,
</a><a href="#h30-0-32" id="h30-0-32" class="i">+                        default: None,
</a><a href="#h30-0-33" id="h30-0-33" class="i">+                        unique: false,
</a><a href="#h30-0-34" id="h30-0-34" class="i">+                        references: Some(
</a><a href="#h30-0-35" id="h30-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h30-0-36" id="h30-0-36" class="i">+                        ),
</a><a href="#h30-0-37" id="h30-0-37" class="i">+                        index: true,
</a><a href="#h30-0-38" id="h30-0-38" class="i">+                    },
</a><a href="#h30-0-39" id="h30-0-39" class="i">+                    Column {
</a><a href="#h30-0-40" id="h30-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h30-0-41" id="h30-0-41" class="i">+                        datatype: Integer,
</a><a href="#h30-0-42" id="h30-0-42" class="i">+                        primary_key: false,
</a><a href="#h30-0-43" id="h30-0-43" class="i">+                        nullable: false,
</a><a href="#h30-0-44" id="h30-0-44" class="i">+                        default: None,
</a><a href="#h30-0-45" id="h30-0-45" class="i">+                        unique: false,
</a><a href="#h30-0-46" id="h30-0-46" class="i">+                        references: Some(
</a><a href="#h30-0-47" id="h30-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h30-0-48" id="h30-0-48" class="i">+                        ),
</a><a href="#h30-0-49" id="h30-0-49" class="i">+                        index: true,
</a><a href="#h30-0-50" id="h30-0-50" class="i">+                    },
</a><a href="#h30-0-51" id="h30-0-51" class="i">+                    Column {
</a><a href="#h30-0-52" id="h30-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h30-0-53" id="h30-0-53" class="i">+                        datatype: Integer,
</a><a href="#h30-0-54" id="h30-0-54" class="i">+                        primary_key: false,
</a><a href="#h30-0-55" id="h30-0-55" class="i">+                        nullable: false,
</a><a href="#h30-0-56" id="h30-0-56" class="i">+                        default: None,
</a><a href="#h30-0-57" id="h30-0-57" class="i">+                        unique: false,
</a><a href="#h30-0-58" id="h30-0-58" class="i">+                        references: None,
</a><a href="#h30-0-59" id="h30-0-59" class="i">+                        index: false,
</a><a href="#h30-0-60" id="h30-0-60" class="i">+                    },
</a><a href="#h30-0-61" id="h30-0-61" class="i">+                    Column {
</a><a href="#h30-0-62" id="h30-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h30-0-63" id="h30-0-63" class="i">+                        datatype: Float,
</a><a href="#h30-0-64" id="h30-0-64" class="i">+                        primary_key: false,
</a><a href="#h30-0-65" id="h30-0-65" class="i">+                        nullable: true,
</a><a href="#h30-0-66" id="h30-0-66" class="i">+                        default: Some(
</a><a href="#h30-0-67" id="h30-0-67" class="i">+                            Null,
</a><a href="#h30-0-68" id="h30-0-68" class="i">+                        ),
</a><a href="#h30-0-69" id="h30-0-69" class="i">+                        unique: false,
</a><a href="#h30-0-70" id="h30-0-70" class="i">+                        references: None,
</a><a href="#h30-0-71" id="h30-0-71" class="i">+                        index: false,
</a><a href="#h30-0-72" id="h30-0-72" class="i">+                    },
</a><a href="#h30-0-73" id="h30-0-73" class="i">+                    Column {
</a><a href="#h30-0-74" id="h30-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h30-0-75" id="h30-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h30-0-76" id="h30-0-76" class="i">+                        primary_key: false,
</a><a href="#h30-0-77" id="h30-0-77" class="i">+                        nullable: true,
</a><a href="#h30-0-78" id="h30-0-78" class="i">+                        default: Some(
</a><a href="#h30-0-79" id="h30-0-79" class="i">+                            Null,
</a><a href="#h30-0-80" id="h30-0-80" class="i">+                        ),
</a><a href="#h30-0-81" id="h30-0-81" class="i">+                        unique: false,
</a><a href="#h30-0-82" id="h30-0-82" class="i">+                        references: None,
</a><a href="#h30-0-83" id="h30-0-83" class="i">+                        index: false,
</a><a href="#h30-0-84" id="h30-0-84" class="i">+                    },
</a><a href="#h30-0-85" id="h30-0-85" class="i">+                ],
</a><a href="#h30-0-86" id="h30-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h30-1" id="h30-1" class="h">@@ -86,7 +168,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Projection {
         source: Scan {
<a href="#h30-1-3" id="h30-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h30-1-4" id="h30-1-4" class="i">+            table: Table {
</a><a href="#h30-1-5" id="h30-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h30-1-6" id="h30-1-6" class="i">+                columns: [
</a><a href="#h30-1-7" id="h30-1-7" class="i">+                    Column {
</a><a href="#h30-1-8" id="h30-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h30-1-9" id="h30-1-9" class="i">+                        datatype: Integer,
</a><a href="#h30-1-10" id="h30-1-10" class="i">+                        primary_key: true,
</a><a href="#h30-1-11" id="h30-1-11" class="i">+                        nullable: false,
</a><a href="#h30-1-12" id="h30-1-12" class="i">+                        default: None,
</a><a href="#h30-1-13" id="h30-1-13" class="i">+                        unique: true,
</a><a href="#h30-1-14" id="h30-1-14" class="i">+                        references: None,
</a><a href="#h30-1-15" id="h30-1-15" class="i">+                        index: false,
</a><a href="#h30-1-16" id="h30-1-16" class="i">+                    },
</a><a href="#h30-1-17" id="h30-1-17" class="i">+                    Column {
</a><a href="#h30-1-18" id="h30-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h30-1-19" id="h30-1-19" class="i">+                        datatype: String,
</a><a href="#h30-1-20" id="h30-1-20" class="i">+                        primary_key: false,
</a><a href="#h30-1-21" id="h30-1-21" class="i">+                        nullable: false,
</a><a href="#h30-1-22" id="h30-1-22" class="i">+                        default: None,
</a><a href="#h30-1-23" id="h30-1-23" class="i">+                        unique: false,
</a><a href="#h30-1-24" id="h30-1-24" class="i">+                        references: None,
</a><a href="#h30-1-25" id="h30-1-25" class="i">+                        index: false,
</a><a href="#h30-1-26" id="h30-1-26" class="i">+                    },
</a><a href="#h30-1-27" id="h30-1-27" class="i">+                    Column {
</a><a href="#h30-1-28" id="h30-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h30-1-29" id="h30-1-29" class="i">+                        datatype: Integer,
</a><a href="#h30-1-30" id="h30-1-30" class="i">+                        primary_key: false,
</a><a href="#h30-1-31" id="h30-1-31" class="i">+                        nullable: false,
</a><a href="#h30-1-32" id="h30-1-32" class="i">+                        default: None,
</a><a href="#h30-1-33" id="h30-1-33" class="i">+                        unique: false,
</a><a href="#h30-1-34" id="h30-1-34" class="i">+                        references: Some(
</a><a href="#h30-1-35" id="h30-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h30-1-36" id="h30-1-36" class="i">+                        ),
</a><a href="#h30-1-37" id="h30-1-37" class="i">+                        index: true,
</a><a href="#h30-1-38" id="h30-1-38" class="i">+                    },
</a><a href="#h30-1-39" id="h30-1-39" class="i">+                    Column {
</a><a href="#h30-1-40" id="h30-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h30-1-41" id="h30-1-41" class="i">+                        datatype: Integer,
</a><a href="#h30-1-42" id="h30-1-42" class="i">+                        primary_key: false,
</a><a href="#h30-1-43" id="h30-1-43" class="i">+                        nullable: false,
</a><a href="#h30-1-44" id="h30-1-44" class="i">+                        default: None,
</a><a href="#h30-1-45" id="h30-1-45" class="i">+                        unique: false,
</a><a href="#h30-1-46" id="h30-1-46" class="i">+                        references: Some(
</a><a href="#h30-1-47" id="h30-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h30-1-48" id="h30-1-48" class="i">+                        ),
</a><a href="#h30-1-49" id="h30-1-49" class="i">+                        index: true,
</a><a href="#h30-1-50" id="h30-1-50" class="i">+                    },
</a><a href="#h30-1-51" id="h30-1-51" class="i">+                    Column {
</a><a href="#h30-1-52" id="h30-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h30-1-53" id="h30-1-53" class="i">+                        datatype: Integer,
</a><a href="#h30-1-54" id="h30-1-54" class="i">+                        primary_key: false,
</a><a href="#h30-1-55" id="h30-1-55" class="i">+                        nullable: false,
</a><a href="#h30-1-56" id="h30-1-56" class="i">+                        default: None,
</a><a href="#h30-1-57" id="h30-1-57" class="i">+                        unique: false,
</a><a href="#h30-1-58" id="h30-1-58" class="i">+                        references: None,
</a><a href="#h30-1-59" id="h30-1-59" class="i">+                        index: false,
</a><a href="#h30-1-60" id="h30-1-60" class="i">+                    },
</a><a href="#h30-1-61" id="h30-1-61" class="i">+                    Column {
</a><a href="#h30-1-62" id="h30-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h30-1-63" id="h30-1-63" class="i">+                        datatype: Float,
</a><a href="#h30-1-64" id="h30-1-64" class="i">+                        primary_key: false,
</a><a href="#h30-1-65" id="h30-1-65" class="i">+                        nullable: true,
</a><a href="#h30-1-66" id="h30-1-66" class="i">+                        default: Some(
</a><a href="#h30-1-67" id="h30-1-67" class="i">+                            Null,
</a><a href="#h30-1-68" id="h30-1-68" class="i">+                        ),
</a><a href="#h30-1-69" id="h30-1-69" class="i">+                        unique: false,
</a><a href="#h30-1-70" id="h30-1-70" class="i">+                        references: None,
</a><a href="#h30-1-71" id="h30-1-71" class="i">+                        index: false,
</a><a href="#h30-1-72" id="h30-1-72" class="i">+                    },
</a><a href="#h30-1-73" id="h30-1-73" class="i">+                    Column {
</a><a href="#h30-1-74" id="h30-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h30-1-75" id="h30-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h30-1-76" id="h30-1-76" class="i">+                        primary_key: false,
</a><a href="#h30-1-77" id="h30-1-77" class="i">+                        nullable: true,
</a><a href="#h30-1-78" id="h30-1-78" class="i">+                        default: Some(
</a><a href="#h30-1-79" id="h30-1-79" class="i">+                            Null,
</a><a href="#h30-1-80" id="h30-1-80" class="i">+                        ),
</a><a href="#h30-1-81" id="h30-1-81" class="i">+                        unique: false,
</a><a href="#h30-1-82" id="h30-1-82" class="i">+                        references: None,
</a><a href="#h30-1-83" id="h30-1-83" class="i">+                        index: false,
</a><a href="#h30-1-84" id="h30-1-84" class="i">+                    },
</a><a href="#h30-1-85" id="h30-1-85" class="i">+                ],
</a><a href="#h30-1-86" id="h30-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h31" href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a> b/<a href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -45,7 +45,89 @@ AST: Select {
</a> Plan: Select(
     Projection {
         source: Scan {
<a href="#h31-0-3" id="h31-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h31-0-4" id="h31-0-4" class="i">+            table: Table {
</a><a href="#h31-0-5" id="h31-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h31-0-6" id="h31-0-6" class="i">+                columns: [
</a><a href="#h31-0-7" id="h31-0-7" class="i">+                    Column {
</a><a href="#h31-0-8" id="h31-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h31-0-9" id="h31-0-9" class="i">+                        datatype: Integer,
</a><a href="#h31-0-10" id="h31-0-10" class="i">+                        primary_key: true,
</a><a href="#h31-0-11" id="h31-0-11" class="i">+                        nullable: false,
</a><a href="#h31-0-12" id="h31-0-12" class="i">+                        default: None,
</a><a href="#h31-0-13" id="h31-0-13" class="i">+                        unique: true,
</a><a href="#h31-0-14" id="h31-0-14" class="i">+                        references: None,
</a><a href="#h31-0-15" id="h31-0-15" class="i">+                        index: false,
</a><a href="#h31-0-16" id="h31-0-16" class="i">+                    },
</a><a href="#h31-0-17" id="h31-0-17" class="i">+                    Column {
</a><a href="#h31-0-18" id="h31-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h31-0-19" id="h31-0-19" class="i">+                        datatype: String,
</a><a href="#h31-0-20" id="h31-0-20" class="i">+                        primary_key: false,
</a><a href="#h31-0-21" id="h31-0-21" class="i">+                        nullable: false,
</a><a href="#h31-0-22" id="h31-0-22" class="i">+                        default: None,
</a><a href="#h31-0-23" id="h31-0-23" class="i">+                        unique: false,
</a><a href="#h31-0-24" id="h31-0-24" class="i">+                        references: None,
</a><a href="#h31-0-25" id="h31-0-25" class="i">+                        index: false,
</a><a href="#h31-0-26" id="h31-0-26" class="i">+                    },
</a><a href="#h31-0-27" id="h31-0-27" class="i">+                    Column {
</a><a href="#h31-0-28" id="h31-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h31-0-29" id="h31-0-29" class="i">+                        datatype: Integer,
</a><a href="#h31-0-30" id="h31-0-30" class="i">+                        primary_key: false,
</a><a href="#h31-0-31" id="h31-0-31" class="i">+                        nullable: false,
</a><a href="#h31-0-32" id="h31-0-32" class="i">+                        default: None,
</a><a href="#h31-0-33" id="h31-0-33" class="i">+                        unique: false,
</a><a href="#h31-0-34" id="h31-0-34" class="i">+                        references: Some(
</a><a href="#h31-0-35" id="h31-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h31-0-36" id="h31-0-36" class="i">+                        ),
</a><a href="#h31-0-37" id="h31-0-37" class="i">+                        index: true,
</a><a href="#h31-0-38" id="h31-0-38" class="i">+                    },
</a><a href="#h31-0-39" id="h31-0-39" class="i">+                    Column {
</a><a href="#h31-0-40" id="h31-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h31-0-41" id="h31-0-41" class="i">+                        datatype: Integer,
</a><a href="#h31-0-42" id="h31-0-42" class="i">+                        primary_key: false,
</a><a href="#h31-0-43" id="h31-0-43" class="i">+                        nullable: false,
</a><a href="#h31-0-44" id="h31-0-44" class="i">+                        default: None,
</a><a href="#h31-0-45" id="h31-0-45" class="i">+                        unique: false,
</a><a href="#h31-0-46" id="h31-0-46" class="i">+                        references: Some(
</a><a href="#h31-0-47" id="h31-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h31-0-48" id="h31-0-48" class="i">+                        ),
</a><a href="#h31-0-49" id="h31-0-49" class="i">+                        index: true,
</a><a href="#h31-0-50" id="h31-0-50" class="i">+                    },
</a><a href="#h31-0-51" id="h31-0-51" class="i">+                    Column {
</a><a href="#h31-0-52" id="h31-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h31-0-53" id="h31-0-53" class="i">+                        datatype: Integer,
</a><a href="#h31-0-54" id="h31-0-54" class="i">+                        primary_key: false,
</a><a href="#h31-0-55" id="h31-0-55" class="i">+                        nullable: false,
</a><a href="#h31-0-56" id="h31-0-56" class="i">+                        default: None,
</a><a href="#h31-0-57" id="h31-0-57" class="i">+                        unique: false,
</a><a href="#h31-0-58" id="h31-0-58" class="i">+                        references: None,
</a><a href="#h31-0-59" id="h31-0-59" class="i">+                        index: false,
</a><a href="#h31-0-60" id="h31-0-60" class="i">+                    },
</a><a href="#h31-0-61" id="h31-0-61" class="i">+                    Column {
</a><a href="#h31-0-62" id="h31-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h31-0-63" id="h31-0-63" class="i">+                        datatype: Float,
</a><a href="#h31-0-64" id="h31-0-64" class="i">+                        primary_key: false,
</a><a href="#h31-0-65" id="h31-0-65" class="i">+                        nullable: true,
</a><a href="#h31-0-66" id="h31-0-66" class="i">+                        default: Some(
</a><a href="#h31-0-67" id="h31-0-67" class="i">+                            Null,
</a><a href="#h31-0-68" id="h31-0-68" class="i">+                        ),
</a><a href="#h31-0-69" id="h31-0-69" class="i">+                        unique: false,
</a><a href="#h31-0-70" id="h31-0-70" class="i">+                        references: None,
</a><a href="#h31-0-71" id="h31-0-71" class="i">+                        index: false,
</a><a href="#h31-0-72" id="h31-0-72" class="i">+                    },
</a><a href="#h31-0-73" id="h31-0-73" class="i">+                    Column {
</a><a href="#h31-0-74" id="h31-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h31-0-75" id="h31-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h31-0-76" id="h31-0-76" class="i">+                        primary_key: false,
</a><a href="#h31-0-77" id="h31-0-77" class="i">+                        nullable: true,
</a><a href="#h31-0-78" id="h31-0-78" class="i">+                        default: Some(
</a><a href="#h31-0-79" id="h31-0-79" class="i">+                            Null,
</a><a href="#h31-0-80" id="h31-0-80" class="i">+                        ),
</a><a href="#h31-0-81" id="h31-0-81" class="i">+                        unique: false,
</a><a href="#h31-0-82" id="h31-0-82" class="i">+                        references: None,
</a><a href="#h31-0-83" id="h31-0-83" class="i">+                        index: false,
</a><a href="#h31-0-84" id="h31-0-84" class="i">+                    },
</a><a href="#h31-0-85" id="h31-0-85" class="i">+                ],
</a><a href="#h31-0-86" id="h31-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h31-1" id="h31-1" class="h">@@ -71,7 +153,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Projection {
         source: Scan {
<a href="#h31-1-3" id="h31-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h31-1-4" id="h31-1-4" class="i">+            table: Table {
</a><a href="#h31-1-5" id="h31-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h31-1-6" id="h31-1-6" class="i">+                columns: [
</a><a href="#h31-1-7" id="h31-1-7" class="i">+                    Column {
</a><a href="#h31-1-8" id="h31-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h31-1-9" id="h31-1-9" class="i">+                        datatype: Integer,
</a><a href="#h31-1-10" id="h31-1-10" class="i">+                        primary_key: true,
</a><a href="#h31-1-11" id="h31-1-11" class="i">+                        nullable: false,
</a><a href="#h31-1-12" id="h31-1-12" class="i">+                        default: None,
</a><a href="#h31-1-13" id="h31-1-13" class="i">+                        unique: true,
</a><a href="#h31-1-14" id="h31-1-14" class="i">+                        references: None,
</a><a href="#h31-1-15" id="h31-1-15" class="i">+                        index: false,
</a><a href="#h31-1-16" id="h31-1-16" class="i">+                    },
</a><a href="#h31-1-17" id="h31-1-17" class="i">+                    Column {
</a><a href="#h31-1-18" id="h31-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h31-1-19" id="h31-1-19" class="i">+                        datatype: String,
</a><a href="#h31-1-20" id="h31-1-20" class="i">+                        primary_key: false,
</a><a href="#h31-1-21" id="h31-1-21" class="i">+                        nullable: false,
</a><a href="#h31-1-22" id="h31-1-22" class="i">+                        default: None,
</a><a href="#h31-1-23" id="h31-1-23" class="i">+                        unique: false,
</a><a href="#h31-1-24" id="h31-1-24" class="i">+                        references: None,
</a><a href="#h31-1-25" id="h31-1-25" class="i">+                        index: false,
</a><a href="#h31-1-26" id="h31-1-26" class="i">+                    },
</a><a href="#h31-1-27" id="h31-1-27" class="i">+                    Column {
</a><a href="#h31-1-28" id="h31-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h31-1-29" id="h31-1-29" class="i">+                        datatype: Integer,
</a><a href="#h31-1-30" id="h31-1-30" class="i">+                        primary_key: false,
</a><a href="#h31-1-31" id="h31-1-31" class="i">+                        nullable: false,
</a><a href="#h31-1-32" id="h31-1-32" class="i">+                        default: None,
</a><a href="#h31-1-33" id="h31-1-33" class="i">+                        unique: false,
</a><a href="#h31-1-34" id="h31-1-34" class="i">+                        references: Some(
</a><a href="#h31-1-35" id="h31-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h31-1-36" id="h31-1-36" class="i">+                        ),
</a><a href="#h31-1-37" id="h31-1-37" class="i">+                        index: true,
</a><a href="#h31-1-38" id="h31-1-38" class="i">+                    },
</a><a href="#h31-1-39" id="h31-1-39" class="i">+                    Column {
</a><a href="#h31-1-40" id="h31-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h31-1-41" id="h31-1-41" class="i">+                        datatype: Integer,
</a><a href="#h31-1-42" id="h31-1-42" class="i">+                        primary_key: false,
</a><a href="#h31-1-43" id="h31-1-43" class="i">+                        nullable: false,
</a><a href="#h31-1-44" id="h31-1-44" class="i">+                        default: None,
</a><a href="#h31-1-45" id="h31-1-45" class="i">+                        unique: false,
</a><a href="#h31-1-46" id="h31-1-46" class="i">+                        references: Some(
</a><a href="#h31-1-47" id="h31-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h31-1-48" id="h31-1-48" class="i">+                        ),
</a><a href="#h31-1-49" id="h31-1-49" class="i">+                        index: true,
</a><a href="#h31-1-50" id="h31-1-50" class="i">+                    },
</a><a href="#h31-1-51" id="h31-1-51" class="i">+                    Column {
</a><a href="#h31-1-52" id="h31-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h31-1-53" id="h31-1-53" class="i">+                        datatype: Integer,
</a><a href="#h31-1-54" id="h31-1-54" class="i">+                        primary_key: false,
</a><a href="#h31-1-55" id="h31-1-55" class="i">+                        nullable: false,
</a><a href="#h31-1-56" id="h31-1-56" class="i">+                        default: None,
</a><a href="#h31-1-57" id="h31-1-57" class="i">+                        unique: false,
</a><a href="#h31-1-58" id="h31-1-58" class="i">+                        references: None,
</a><a href="#h31-1-59" id="h31-1-59" class="i">+                        index: false,
</a><a href="#h31-1-60" id="h31-1-60" class="i">+                    },
</a><a href="#h31-1-61" id="h31-1-61" class="i">+                    Column {
</a><a href="#h31-1-62" id="h31-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h31-1-63" id="h31-1-63" class="i">+                        datatype: Float,
</a><a href="#h31-1-64" id="h31-1-64" class="i">+                        primary_key: false,
</a><a href="#h31-1-65" id="h31-1-65" class="i">+                        nullable: true,
</a><a href="#h31-1-66" id="h31-1-66" class="i">+                        default: Some(
</a><a href="#h31-1-67" id="h31-1-67" class="i">+                            Null,
</a><a href="#h31-1-68" id="h31-1-68" class="i">+                        ),
</a><a href="#h31-1-69" id="h31-1-69" class="i">+                        unique: false,
</a><a href="#h31-1-70" id="h31-1-70" class="i">+                        references: None,
</a><a href="#h31-1-71" id="h31-1-71" class="i">+                        index: false,
</a><a href="#h31-1-72" id="h31-1-72" class="i">+                    },
</a><a href="#h31-1-73" id="h31-1-73" class="i">+                    Column {
</a><a href="#h31-1-74" id="h31-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h31-1-75" id="h31-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h31-1-76" id="h31-1-76" class="i">+                        primary_key: false,
</a><a href="#h31-1-77" id="h31-1-77" class="i">+                        nullable: true,
</a><a href="#h31-1-78" id="h31-1-78" class="i">+                        default: Some(
</a><a href="#h31-1-79" id="h31-1-79" class="i">+                            Null,
</a><a href="#h31-1-80" id="h31-1-80" class="i">+                        ),
</a><a href="#h31-1-81" id="h31-1-81" class="i">+                        unique: false,
</a><a href="#h31-1-82" id="h31-1-82" class="i">+                        references: None,
</a><a href="#h31-1-83" id="h31-1-83" class="i">+                        index: false,
</a><a href="#h31-1-84" id="h31-1-84" class="i">+                    },
</a><a href="#h31-1-85" id="h31-1-85" class="i">+                ],
</a><a href="#h31-1-86" id="h31-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a> b/<a href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -81,13 +81,119 @@ Plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h32-0-3" id="h32-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h32-0-4" id="h32-0-4" class="i">+                table: Table {
</a><a href="#h32-0-5" id="h32-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h32-0-6" id="h32-0-6" class="i">+                    columns: [
</a><a href="#h32-0-7" id="h32-0-7" class="i">+                        Column {
</a><a href="#h32-0-8" id="h32-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h32-0-9" id="h32-0-9" class="i">+                            datatype: Integer,
</a><a href="#h32-0-10" id="h32-0-10" class="i">+                            primary_key: true,
</a><a href="#h32-0-11" id="h32-0-11" class="i">+                            nullable: false,
</a><a href="#h32-0-12" id="h32-0-12" class="i">+                            default: None,
</a><a href="#h32-0-13" id="h32-0-13" class="i">+                            unique: true,
</a><a href="#h32-0-14" id="h32-0-14" class="i">+                            references: None,
</a><a href="#h32-0-15" id="h32-0-15" class="i">+                            index: false,
</a><a href="#h32-0-16" id="h32-0-16" class="i">+                        },
</a><a href="#h32-0-17" id="h32-0-17" class="i">+                        Column {
</a><a href="#h32-0-18" id="h32-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h32-0-19" id="h32-0-19" class="i">+                            datatype: String,
</a><a href="#h32-0-20" id="h32-0-20" class="i">+                            primary_key: false,
</a><a href="#h32-0-21" id="h32-0-21" class="i">+                            nullable: false,
</a><a href="#h32-0-22" id="h32-0-22" class="i">+                            default: None,
</a><a href="#h32-0-23" id="h32-0-23" class="i">+                            unique: false,
</a><a href="#h32-0-24" id="h32-0-24" class="i">+                            references: None,
</a><a href="#h32-0-25" id="h32-0-25" class="i">+                            index: false,
</a><a href="#h32-0-26" id="h32-0-26" class="i">+                        },
</a><a href="#h32-0-27" id="h32-0-27" class="i">+                        Column {
</a><a href="#h32-0-28" id="h32-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h32-0-29" id="h32-0-29" class="i">+                            datatype: Integer,
</a><a href="#h32-0-30" id="h32-0-30" class="i">+                            primary_key: false,
</a><a href="#h32-0-31" id="h32-0-31" class="i">+                            nullable: false,
</a><a href="#h32-0-32" id="h32-0-32" class="i">+                            default: None,
</a><a href="#h32-0-33" id="h32-0-33" class="i">+                            unique: false,
</a><a href="#h32-0-34" id="h32-0-34" class="i">+                            references: Some(
</a><a href="#h32-0-35" id="h32-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h32-0-36" id="h32-0-36" class="i">+                            ),
</a><a href="#h32-0-37" id="h32-0-37" class="i">+                            index: true,
</a><a href="#h32-0-38" id="h32-0-38" class="i">+                        },
</a><a href="#h32-0-39" id="h32-0-39" class="i">+                        Column {
</a><a href="#h32-0-40" id="h32-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h32-0-41" id="h32-0-41" class="i">+                            datatype: Integer,
</a><a href="#h32-0-42" id="h32-0-42" class="i">+                            primary_key: false,
</a><a href="#h32-0-43" id="h32-0-43" class="i">+                            nullable: false,
</a><a href="#h32-0-44" id="h32-0-44" class="i">+                            default: None,
</a><a href="#h32-0-45" id="h32-0-45" class="i">+                            unique: false,
</a><a href="#h32-0-46" id="h32-0-46" class="i">+                            references: Some(
</a><a href="#h32-0-47" id="h32-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h32-0-48" id="h32-0-48" class="i">+                            ),
</a><a href="#h32-0-49" id="h32-0-49" class="i">+                            index: true,
</a><a href="#h32-0-50" id="h32-0-50" class="i">+                        },
</a><a href="#h32-0-51" id="h32-0-51" class="i">+                        Column {
</a><a href="#h32-0-52" id="h32-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h32-0-53" id="h32-0-53" class="i">+                            datatype: Integer,
</a><a href="#h32-0-54" id="h32-0-54" class="i">+                            primary_key: false,
</a><a href="#h32-0-55" id="h32-0-55" class="i">+                            nullable: false,
</a><a href="#h32-0-56" id="h32-0-56" class="i">+                            default: None,
</a><a href="#h32-0-57" id="h32-0-57" class="i">+                            unique: false,
</a><a href="#h32-0-58" id="h32-0-58" class="i">+                            references: None,
</a><a href="#h32-0-59" id="h32-0-59" class="i">+                            index: false,
</a><a href="#h32-0-60" id="h32-0-60" class="i">+                        },
</a><a href="#h32-0-61" id="h32-0-61" class="i">+                        Column {
</a><a href="#h32-0-62" id="h32-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h32-0-63" id="h32-0-63" class="i">+                            datatype: Float,
</a><a href="#h32-0-64" id="h32-0-64" class="i">+                            primary_key: false,
</a><a href="#h32-0-65" id="h32-0-65" class="i">+                            nullable: true,
</a><a href="#h32-0-66" id="h32-0-66" class="i">+                            default: Some(
</a><a href="#h32-0-67" id="h32-0-67" class="i">+                                Null,
</a><a href="#h32-0-68" id="h32-0-68" class="i">+                            ),
</a><a href="#h32-0-69" id="h32-0-69" class="i">+                            unique: false,
</a><a href="#h32-0-70" id="h32-0-70" class="i">+                            references: None,
</a><a href="#h32-0-71" id="h32-0-71" class="i">+                            index: false,
</a><a href="#h32-0-72" id="h32-0-72" class="i">+                        },
</a><a href="#h32-0-73" id="h32-0-73" class="i">+                        Column {
</a><a href="#h32-0-74" id="h32-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h32-0-75" id="h32-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h32-0-76" id="h32-0-76" class="i">+                            primary_key: false,
</a><a href="#h32-0-77" id="h32-0-77" class="i">+                            nullable: true,
</a><a href="#h32-0-78" id="h32-0-78" class="i">+                            default: Some(
</a><a href="#h32-0-79" id="h32-0-79" class="i">+                                Null,
</a><a href="#h32-0-80" id="h32-0-80" class="i">+                            ),
</a><a href="#h32-0-81" id="h32-0-81" class="i">+                            unique: false,
</a><a href="#h32-0-82" id="h32-0-82" class="i">+                            references: None,
</a><a href="#h32-0-83" id="h32-0-83" class="i">+                            index: false,
</a><a href="#h32-0-84" id="h32-0-84" class="i">+                        },
</a><a href="#h32-0-85" id="h32-0-85" class="i">+                    ],
</a><a href="#h32-0-86" id="h32-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
             left_size: 7,
             right: Scan {
<a href="#h32-0-92" id="h32-0-92" class="d">-                table: &quot;genres&quot;,
</a><a href="#h32-0-93" id="h32-0-93" class="i">+                table: Table {
</a><a href="#h32-0-94" id="h32-0-94" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h32-0-95" id="h32-0-95" class="i">+                    columns: [
</a><a href="#h32-0-96" id="h32-0-96" class="i">+                        Column {
</a><a href="#h32-0-97" id="h32-0-97" class="i">+                            name: &quot;id&quot;,
</a><a href="#h32-0-98" id="h32-0-98" class="i">+                            datatype: Integer,
</a><a href="#h32-0-99" id="h32-0-99" class="i">+                            primary_key: true,
</a><a href="#h32-0-100" id="h32-0-100" class="i">+                            nullable: false,
</a><a href="#h32-0-101" id="h32-0-101" class="i">+                            default: None,
</a><a href="#h32-0-102" id="h32-0-102" class="i">+                            unique: true,
</a><a href="#h32-0-103" id="h32-0-103" class="i">+                            references: None,
</a><a href="#h32-0-104" id="h32-0-104" class="i">+                            index: false,
</a><a href="#h32-0-105" id="h32-0-105" class="i">+                        },
</a><a href="#h32-0-106" id="h32-0-106" class="i">+                        Column {
</a><a href="#h32-0-107" id="h32-0-107" class="i">+                            name: &quot;name&quot;,
</a><a href="#h32-0-108" id="h32-0-108" class="i">+                            datatype: String,
</a><a href="#h32-0-109" id="h32-0-109" class="i">+                            primary_key: false,
</a><a href="#h32-0-110" id="h32-0-110" class="i">+                            nullable: false,
</a><a href="#h32-0-111" id="h32-0-111" class="i">+                            default: None,
</a><a href="#h32-0-112" id="h32-0-112" class="i">+                            unique: false,
</a><a href="#h32-0-113" id="h32-0-113" class="i">+                            references: None,
</a><a href="#h32-0-114" id="h32-0-114" class="i">+                            index: false,
</a><a href="#h32-0-115" id="h32-0-115" class="i">+                        },
</a><a href="#h32-0-116" id="h32-0-116" class="i">+                    ],
</a><a href="#h32-0-117" id="h32-0-117" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h32-1" id="h32-1" class="h">@@ -131,13 +237,119 @@ Optimized plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h32-1-3" id="h32-1-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h32-1-4" id="h32-1-4" class="i">+                table: Table {
</a><a href="#h32-1-5" id="h32-1-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h32-1-6" id="h32-1-6" class="i">+                    columns: [
</a><a href="#h32-1-7" id="h32-1-7" class="i">+                        Column {
</a><a href="#h32-1-8" id="h32-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h32-1-9" id="h32-1-9" class="i">+                            datatype: Integer,
</a><a href="#h32-1-10" id="h32-1-10" class="i">+                            primary_key: true,
</a><a href="#h32-1-11" id="h32-1-11" class="i">+                            nullable: false,
</a><a href="#h32-1-12" id="h32-1-12" class="i">+                            default: None,
</a><a href="#h32-1-13" id="h32-1-13" class="i">+                            unique: true,
</a><a href="#h32-1-14" id="h32-1-14" class="i">+                            references: None,
</a><a href="#h32-1-15" id="h32-1-15" class="i">+                            index: false,
</a><a href="#h32-1-16" id="h32-1-16" class="i">+                        },
</a><a href="#h32-1-17" id="h32-1-17" class="i">+                        Column {
</a><a href="#h32-1-18" id="h32-1-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h32-1-19" id="h32-1-19" class="i">+                            datatype: String,
</a><a href="#h32-1-20" id="h32-1-20" class="i">+                            primary_key: false,
</a><a href="#h32-1-21" id="h32-1-21" class="i">+                            nullable: false,
</a><a href="#h32-1-22" id="h32-1-22" class="i">+                            default: None,
</a><a href="#h32-1-23" id="h32-1-23" class="i">+                            unique: false,
</a><a href="#h32-1-24" id="h32-1-24" class="i">+                            references: None,
</a><a href="#h32-1-25" id="h32-1-25" class="i">+                            index: false,
</a><a href="#h32-1-26" id="h32-1-26" class="i">+                        },
</a><a href="#h32-1-27" id="h32-1-27" class="i">+                        Column {
</a><a href="#h32-1-28" id="h32-1-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h32-1-29" id="h32-1-29" class="i">+                            datatype: Integer,
</a><a href="#h32-1-30" id="h32-1-30" class="i">+                            primary_key: false,
</a><a href="#h32-1-31" id="h32-1-31" class="i">+                            nullable: false,
</a><a href="#h32-1-32" id="h32-1-32" class="i">+                            default: None,
</a><a href="#h32-1-33" id="h32-1-33" class="i">+                            unique: false,
</a><a href="#h32-1-34" id="h32-1-34" class="i">+                            references: Some(
</a><a href="#h32-1-35" id="h32-1-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h32-1-36" id="h32-1-36" class="i">+                            ),
</a><a href="#h32-1-37" id="h32-1-37" class="i">+                            index: true,
</a><a href="#h32-1-38" id="h32-1-38" class="i">+                        },
</a><a href="#h32-1-39" id="h32-1-39" class="i">+                        Column {
</a><a href="#h32-1-40" id="h32-1-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h32-1-41" id="h32-1-41" class="i">+                            datatype: Integer,
</a><a href="#h32-1-42" id="h32-1-42" class="i">+                            primary_key: false,
</a><a href="#h32-1-43" id="h32-1-43" class="i">+                            nullable: false,
</a><a href="#h32-1-44" id="h32-1-44" class="i">+                            default: None,
</a><a href="#h32-1-45" id="h32-1-45" class="i">+                            unique: false,
</a><a href="#h32-1-46" id="h32-1-46" class="i">+                            references: Some(
</a><a href="#h32-1-47" id="h32-1-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h32-1-48" id="h32-1-48" class="i">+                            ),
</a><a href="#h32-1-49" id="h32-1-49" class="i">+                            index: true,
</a><a href="#h32-1-50" id="h32-1-50" class="i">+                        },
</a><a href="#h32-1-51" id="h32-1-51" class="i">+                        Column {
</a><a href="#h32-1-52" id="h32-1-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h32-1-53" id="h32-1-53" class="i">+                            datatype: Integer,
</a><a href="#h32-1-54" id="h32-1-54" class="i">+                            primary_key: false,
</a><a href="#h32-1-55" id="h32-1-55" class="i">+                            nullable: false,
</a><a href="#h32-1-56" id="h32-1-56" class="i">+                            default: None,
</a><a href="#h32-1-57" id="h32-1-57" class="i">+                            unique: false,
</a><a href="#h32-1-58" id="h32-1-58" class="i">+                            references: None,
</a><a href="#h32-1-59" id="h32-1-59" class="i">+                            index: false,
</a><a href="#h32-1-60" id="h32-1-60" class="i">+                        },
</a><a href="#h32-1-61" id="h32-1-61" class="i">+                        Column {
</a><a href="#h32-1-62" id="h32-1-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h32-1-63" id="h32-1-63" class="i">+                            datatype: Float,
</a><a href="#h32-1-64" id="h32-1-64" class="i">+                            primary_key: false,
</a><a href="#h32-1-65" id="h32-1-65" class="i">+                            nullable: true,
</a><a href="#h32-1-66" id="h32-1-66" class="i">+                            default: Some(
</a><a href="#h32-1-67" id="h32-1-67" class="i">+                                Null,
</a><a href="#h32-1-68" id="h32-1-68" class="i">+                            ),
</a><a href="#h32-1-69" id="h32-1-69" class="i">+                            unique: false,
</a><a href="#h32-1-70" id="h32-1-70" class="i">+                            references: None,
</a><a href="#h32-1-71" id="h32-1-71" class="i">+                            index: false,
</a><a href="#h32-1-72" id="h32-1-72" class="i">+                        },
</a><a href="#h32-1-73" id="h32-1-73" class="i">+                        Column {
</a><a href="#h32-1-74" id="h32-1-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h32-1-75" id="h32-1-75" class="i">+                            datatype: Boolean,
</a><a href="#h32-1-76" id="h32-1-76" class="i">+                            primary_key: false,
</a><a href="#h32-1-77" id="h32-1-77" class="i">+                            nullable: true,
</a><a href="#h32-1-78" id="h32-1-78" class="i">+                            default: Some(
</a><a href="#h32-1-79" id="h32-1-79" class="i">+                                Null,
</a><a href="#h32-1-80" id="h32-1-80" class="i">+                            ),
</a><a href="#h32-1-81" id="h32-1-81" class="i">+                            unique: false,
</a><a href="#h32-1-82" id="h32-1-82" class="i">+                            references: None,
</a><a href="#h32-1-83" id="h32-1-83" class="i">+                            index: false,
</a><a href="#h32-1-84" id="h32-1-84" class="i">+                        },
</a><a href="#h32-1-85" id="h32-1-85" class="i">+                    ],
</a><a href="#h32-1-86" id="h32-1-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
             left_size: 7,
             right: Scan {
<a href="#h32-1-92" id="h32-1-92" class="d">-                table: &quot;genres&quot;,
</a><a href="#h32-1-93" id="h32-1-93" class="i">+                table: Table {
</a><a href="#h32-1-94" id="h32-1-94" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h32-1-95" id="h32-1-95" class="i">+                    columns: [
</a><a href="#h32-1-96" id="h32-1-96" class="i">+                        Column {
</a><a href="#h32-1-97" id="h32-1-97" class="i">+                            name: &quot;id&quot;,
</a><a href="#h32-1-98" id="h32-1-98" class="i">+                            datatype: Integer,
</a><a href="#h32-1-99" id="h32-1-99" class="i">+                            primary_key: true,
</a><a href="#h32-1-100" id="h32-1-100" class="i">+                            nullable: false,
</a><a href="#h32-1-101" id="h32-1-101" class="i">+                            default: None,
</a><a href="#h32-1-102" id="h32-1-102" class="i">+                            unique: true,
</a><a href="#h32-1-103" id="h32-1-103" class="i">+                            references: None,
</a><a href="#h32-1-104" id="h32-1-104" class="i">+                            index: false,
</a><a href="#h32-1-105" id="h32-1-105" class="i">+                        },
</a><a href="#h32-1-106" id="h32-1-106" class="i">+                        Column {
</a><a href="#h32-1-107" id="h32-1-107" class="i">+                            name: &quot;name&quot;,
</a><a href="#h32-1-108" id="h32-1-108" class="i">+                            datatype: String,
</a><a href="#h32-1-109" id="h32-1-109" class="i">+                            primary_key: false,
</a><a href="#h32-1-110" id="h32-1-110" class="i">+                            nullable: false,
</a><a href="#h32-1-111" id="h32-1-111" class="i">+                            default: None,
</a><a href="#h32-1-112" id="h32-1-112" class="i">+                            unique: false,
</a><a href="#h32-1-113" id="h32-1-113" class="i">+                            references: None,
</a><a href="#h32-1-114" id="h32-1-114" class="i">+                            index: false,
</a><a href="#h32-1-115" id="h32-1-115" class="i">+                        },
</a><a href="#h32-1-116" id="h32-1-116" class="i">+                    ],
</a><a href="#h32-1-117" id="h32-1-117" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a> b/<a href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -43,7 +43,89 @@ AST: Select {
</a> Plan: Select(
     Projection {
         source: Scan {
<a href="#h33-0-3" id="h33-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h33-0-4" id="h33-0-4" class="i">+            table: Table {
</a><a href="#h33-0-5" id="h33-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h33-0-6" id="h33-0-6" class="i">+                columns: [
</a><a href="#h33-0-7" id="h33-0-7" class="i">+                    Column {
</a><a href="#h33-0-8" id="h33-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h33-0-9" id="h33-0-9" class="i">+                        datatype: Integer,
</a><a href="#h33-0-10" id="h33-0-10" class="i">+                        primary_key: true,
</a><a href="#h33-0-11" id="h33-0-11" class="i">+                        nullable: false,
</a><a href="#h33-0-12" id="h33-0-12" class="i">+                        default: None,
</a><a href="#h33-0-13" id="h33-0-13" class="i">+                        unique: true,
</a><a href="#h33-0-14" id="h33-0-14" class="i">+                        references: None,
</a><a href="#h33-0-15" id="h33-0-15" class="i">+                        index: false,
</a><a href="#h33-0-16" id="h33-0-16" class="i">+                    },
</a><a href="#h33-0-17" id="h33-0-17" class="i">+                    Column {
</a><a href="#h33-0-18" id="h33-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h33-0-19" id="h33-0-19" class="i">+                        datatype: String,
</a><a href="#h33-0-20" id="h33-0-20" class="i">+                        primary_key: false,
</a><a href="#h33-0-21" id="h33-0-21" class="i">+                        nullable: false,
</a><a href="#h33-0-22" id="h33-0-22" class="i">+                        default: None,
</a><a href="#h33-0-23" id="h33-0-23" class="i">+                        unique: false,
</a><a href="#h33-0-24" id="h33-0-24" class="i">+                        references: None,
</a><a href="#h33-0-25" id="h33-0-25" class="i">+                        index: false,
</a><a href="#h33-0-26" id="h33-0-26" class="i">+                    },
</a><a href="#h33-0-27" id="h33-0-27" class="i">+                    Column {
</a><a href="#h33-0-28" id="h33-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h33-0-29" id="h33-0-29" class="i">+                        datatype: Integer,
</a><a href="#h33-0-30" id="h33-0-30" class="i">+                        primary_key: false,
</a><a href="#h33-0-31" id="h33-0-31" class="i">+                        nullable: false,
</a><a href="#h33-0-32" id="h33-0-32" class="i">+                        default: None,
</a><a href="#h33-0-33" id="h33-0-33" class="i">+                        unique: false,
</a><a href="#h33-0-34" id="h33-0-34" class="i">+                        references: Some(
</a><a href="#h33-0-35" id="h33-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h33-0-36" id="h33-0-36" class="i">+                        ),
</a><a href="#h33-0-37" id="h33-0-37" class="i">+                        index: true,
</a><a href="#h33-0-38" id="h33-0-38" class="i">+                    },
</a><a href="#h33-0-39" id="h33-0-39" class="i">+                    Column {
</a><a href="#h33-0-40" id="h33-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h33-0-41" id="h33-0-41" class="i">+                        datatype: Integer,
</a><a href="#h33-0-42" id="h33-0-42" class="i">+                        primary_key: false,
</a><a href="#h33-0-43" id="h33-0-43" class="i">+                        nullable: false,
</a><a href="#h33-0-44" id="h33-0-44" class="i">+                        default: None,
</a><a href="#h33-0-45" id="h33-0-45" class="i">+                        unique: false,
</a><a href="#h33-0-46" id="h33-0-46" class="i">+                        references: Some(
</a><a href="#h33-0-47" id="h33-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h33-0-48" id="h33-0-48" class="i">+                        ),
</a><a href="#h33-0-49" id="h33-0-49" class="i">+                        index: true,
</a><a href="#h33-0-50" id="h33-0-50" class="i">+                    },
</a><a href="#h33-0-51" id="h33-0-51" class="i">+                    Column {
</a><a href="#h33-0-52" id="h33-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h33-0-53" id="h33-0-53" class="i">+                        datatype: Integer,
</a><a href="#h33-0-54" id="h33-0-54" class="i">+                        primary_key: false,
</a><a href="#h33-0-55" id="h33-0-55" class="i">+                        nullable: false,
</a><a href="#h33-0-56" id="h33-0-56" class="i">+                        default: None,
</a><a href="#h33-0-57" id="h33-0-57" class="i">+                        unique: false,
</a><a href="#h33-0-58" id="h33-0-58" class="i">+                        references: None,
</a><a href="#h33-0-59" id="h33-0-59" class="i">+                        index: false,
</a><a href="#h33-0-60" id="h33-0-60" class="i">+                    },
</a><a href="#h33-0-61" id="h33-0-61" class="i">+                    Column {
</a><a href="#h33-0-62" id="h33-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h33-0-63" id="h33-0-63" class="i">+                        datatype: Float,
</a><a href="#h33-0-64" id="h33-0-64" class="i">+                        primary_key: false,
</a><a href="#h33-0-65" id="h33-0-65" class="i">+                        nullable: true,
</a><a href="#h33-0-66" id="h33-0-66" class="i">+                        default: Some(
</a><a href="#h33-0-67" id="h33-0-67" class="i">+                            Null,
</a><a href="#h33-0-68" id="h33-0-68" class="i">+                        ),
</a><a href="#h33-0-69" id="h33-0-69" class="i">+                        unique: false,
</a><a href="#h33-0-70" id="h33-0-70" class="i">+                        references: None,
</a><a href="#h33-0-71" id="h33-0-71" class="i">+                        index: false,
</a><a href="#h33-0-72" id="h33-0-72" class="i">+                    },
</a><a href="#h33-0-73" id="h33-0-73" class="i">+                    Column {
</a><a href="#h33-0-74" id="h33-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h33-0-75" id="h33-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h33-0-76" id="h33-0-76" class="i">+                        primary_key: false,
</a><a href="#h33-0-77" id="h33-0-77" class="i">+                        nullable: true,
</a><a href="#h33-0-78" id="h33-0-78" class="i">+                        default: Some(
</a><a href="#h33-0-79" id="h33-0-79" class="i">+                            Null,
</a><a href="#h33-0-80" id="h33-0-80" class="i">+                        ),
</a><a href="#h33-0-81" id="h33-0-81" class="i">+                        unique: false,
</a><a href="#h33-0-82" id="h33-0-82" class="i">+                        references: None,
</a><a href="#h33-0-83" id="h33-0-83" class="i">+                        index: false,
</a><a href="#h33-0-84" id="h33-0-84" class="i">+                    },
</a><a href="#h33-0-85" id="h33-0-85" class="i">+                ],
</a><a href="#h33-0-86" id="h33-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h33-1" id="h33-1" class="h">@@ -67,7 +149,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Projection {
         source: Scan {
<a href="#h33-1-3" id="h33-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h33-1-4" id="h33-1-4" class="i">+            table: Table {
</a><a href="#h33-1-5" id="h33-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h33-1-6" id="h33-1-6" class="i">+                columns: [
</a><a href="#h33-1-7" id="h33-1-7" class="i">+                    Column {
</a><a href="#h33-1-8" id="h33-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h33-1-9" id="h33-1-9" class="i">+                        datatype: Integer,
</a><a href="#h33-1-10" id="h33-1-10" class="i">+                        primary_key: true,
</a><a href="#h33-1-11" id="h33-1-11" class="i">+                        nullable: false,
</a><a href="#h33-1-12" id="h33-1-12" class="i">+                        default: None,
</a><a href="#h33-1-13" id="h33-1-13" class="i">+                        unique: true,
</a><a href="#h33-1-14" id="h33-1-14" class="i">+                        references: None,
</a><a href="#h33-1-15" id="h33-1-15" class="i">+                        index: false,
</a><a href="#h33-1-16" id="h33-1-16" class="i">+                    },
</a><a href="#h33-1-17" id="h33-1-17" class="i">+                    Column {
</a><a href="#h33-1-18" id="h33-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h33-1-19" id="h33-1-19" class="i">+                        datatype: String,
</a><a href="#h33-1-20" id="h33-1-20" class="i">+                        primary_key: false,
</a><a href="#h33-1-21" id="h33-1-21" class="i">+                        nullable: false,
</a><a href="#h33-1-22" id="h33-1-22" class="i">+                        default: None,
</a><a href="#h33-1-23" id="h33-1-23" class="i">+                        unique: false,
</a><a href="#h33-1-24" id="h33-1-24" class="i">+                        references: None,
</a><a href="#h33-1-25" id="h33-1-25" class="i">+                        index: false,
</a><a href="#h33-1-26" id="h33-1-26" class="i">+                    },
</a><a href="#h33-1-27" id="h33-1-27" class="i">+                    Column {
</a><a href="#h33-1-28" id="h33-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h33-1-29" id="h33-1-29" class="i">+                        datatype: Integer,
</a><a href="#h33-1-30" id="h33-1-30" class="i">+                        primary_key: false,
</a><a href="#h33-1-31" id="h33-1-31" class="i">+                        nullable: false,
</a><a href="#h33-1-32" id="h33-1-32" class="i">+                        default: None,
</a><a href="#h33-1-33" id="h33-1-33" class="i">+                        unique: false,
</a><a href="#h33-1-34" id="h33-1-34" class="i">+                        references: Some(
</a><a href="#h33-1-35" id="h33-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h33-1-36" id="h33-1-36" class="i">+                        ),
</a><a href="#h33-1-37" id="h33-1-37" class="i">+                        index: true,
</a><a href="#h33-1-38" id="h33-1-38" class="i">+                    },
</a><a href="#h33-1-39" id="h33-1-39" class="i">+                    Column {
</a><a href="#h33-1-40" id="h33-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h33-1-41" id="h33-1-41" class="i">+                        datatype: Integer,
</a><a href="#h33-1-42" id="h33-1-42" class="i">+                        primary_key: false,
</a><a href="#h33-1-43" id="h33-1-43" class="i">+                        nullable: false,
</a><a href="#h33-1-44" id="h33-1-44" class="i">+                        default: None,
</a><a href="#h33-1-45" id="h33-1-45" class="i">+                        unique: false,
</a><a href="#h33-1-46" id="h33-1-46" class="i">+                        references: Some(
</a><a href="#h33-1-47" id="h33-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h33-1-48" id="h33-1-48" class="i">+                        ),
</a><a href="#h33-1-49" id="h33-1-49" class="i">+                        index: true,
</a><a href="#h33-1-50" id="h33-1-50" class="i">+                    },
</a><a href="#h33-1-51" id="h33-1-51" class="i">+                    Column {
</a><a href="#h33-1-52" id="h33-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h33-1-53" id="h33-1-53" class="i">+                        datatype: Integer,
</a><a href="#h33-1-54" id="h33-1-54" class="i">+                        primary_key: false,
</a><a href="#h33-1-55" id="h33-1-55" class="i">+                        nullable: false,
</a><a href="#h33-1-56" id="h33-1-56" class="i">+                        default: None,
</a><a href="#h33-1-57" id="h33-1-57" class="i">+                        unique: false,
</a><a href="#h33-1-58" id="h33-1-58" class="i">+                        references: None,
</a><a href="#h33-1-59" id="h33-1-59" class="i">+                        index: false,
</a><a href="#h33-1-60" id="h33-1-60" class="i">+                    },
</a><a href="#h33-1-61" id="h33-1-61" class="i">+                    Column {
</a><a href="#h33-1-62" id="h33-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h33-1-63" id="h33-1-63" class="i">+                        datatype: Float,
</a><a href="#h33-1-64" id="h33-1-64" class="i">+                        primary_key: false,
</a><a href="#h33-1-65" id="h33-1-65" class="i">+                        nullable: true,
</a><a href="#h33-1-66" id="h33-1-66" class="i">+                        default: Some(
</a><a href="#h33-1-67" id="h33-1-67" class="i">+                            Null,
</a><a href="#h33-1-68" id="h33-1-68" class="i">+                        ),
</a><a href="#h33-1-69" id="h33-1-69" class="i">+                        unique: false,
</a><a href="#h33-1-70" id="h33-1-70" class="i">+                        references: None,
</a><a href="#h33-1-71" id="h33-1-71" class="i">+                        index: false,
</a><a href="#h33-1-72" id="h33-1-72" class="i">+                    },
</a><a href="#h33-1-73" id="h33-1-73" class="i">+                    Column {
</a><a href="#h33-1-74" id="h33-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h33-1-75" id="h33-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h33-1-76" id="h33-1-76" class="i">+                        primary_key: false,
</a><a href="#h33-1-77" id="h33-1-77" class="i">+                        nullable: true,
</a><a href="#h33-1-78" id="h33-1-78" class="i">+                        default: Some(
</a><a href="#h33-1-79" id="h33-1-79" class="i">+                            Null,
</a><a href="#h33-1-80" id="h33-1-80" class="i">+                        ),
</a><a href="#h33-1-81" id="h33-1-81" class="i">+                        unique: false,
</a><a href="#h33-1-82" id="h33-1-82" class="i">+                        references: None,
</a><a href="#h33-1-83" id="h33-1-83" class="i">+                        index: false,
</a><a href="#h33-1-84" id="h33-1-84" class="i">+                    },
</a><a href="#h33-1-85" id="h33-1-85" class="i">+                ],
</a><a href="#h33-1-86" id="h33-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h34" href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a> b/<a href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -127,13 +127,119 @@ Plan: Select(
</a>     NestedLoopJoin {
         left: NestedLoopJoin {
             left: Scan {
<a href="#h34-0-3" id="h34-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h34-0-4" id="h34-0-4" class="i">+                table: Table {
</a><a href="#h34-0-5" id="h34-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h34-0-6" id="h34-0-6" class="i">+                    columns: [
</a><a href="#h34-0-7" id="h34-0-7" class="i">+                        Column {
</a><a href="#h34-0-8" id="h34-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h34-0-9" id="h34-0-9" class="i">+                            datatype: Integer,
</a><a href="#h34-0-10" id="h34-0-10" class="i">+                            primary_key: true,
</a><a href="#h34-0-11" id="h34-0-11" class="i">+                            nullable: false,
</a><a href="#h34-0-12" id="h34-0-12" class="i">+                            default: None,
</a><a href="#h34-0-13" id="h34-0-13" class="i">+                            unique: true,
</a><a href="#h34-0-14" id="h34-0-14" class="i">+                            references: None,
</a><a href="#h34-0-15" id="h34-0-15" class="i">+                            index: false,
</a><a href="#h34-0-16" id="h34-0-16" class="i">+                        },
</a><a href="#h34-0-17" id="h34-0-17" class="i">+                        Column {
</a><a href="#h34-0-18" id="h34-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h34-0-19" id="h34-0-19" class="i">+                            datatype: String,
</a><a href="#h34-0-20" id="h34-0-20" class="i">+                            primary_key: false,
</a><a href="#h34-0-21" id="h34-0-21" class="i">+                            nullable: false,
</a><a href="#h34-0-22" id="h34-0-22" class="i">+                            default: None,
</a><a href="#h34-0-23" id="h34-0-23" class="i">+                            unique: false,
</a><a href="#h34-0-24" id="h34-0-24" class="i">+                            references: None,
</a><a href="#h34-0-25" id="h34-0-25" class="i">+                            index: false,
</a><a href="#h34-0-26" id="h34-0-26" class="i">+                        },
</a><a href="#h34-0-27" id="h34-0-27" class="i">+                        Column {
</a><a href="#h34-0-28" id="h34-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h34-0-29" id="h34-0-29" class="i">+                            datatype: Integer,
</a><a href="#h34-0-30" id="h34-0-30" class="i">+                            primary_key: false,
</a><a href="#h34-0-31" id="h34-0-31" class="i">+                            nullable: false,
</a><a href="#h34-0-32" id="h34-0-32" class="i">+                            default: None,
</a><a href="#h34-0-33" id="h34-0-33" class="i">+                            unique: false,
</a><a href="#h34-0-34" id="h34-0-34" class="i">+                            references: Some(
</a><a href="#h34-0-35" id="h34-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h34-0-36" id="h34-0-36" class="i">+                            ),
</a><a href="#h34-0-37" id="h34-0-37" class="i">+                            index: true,
</a><a href="#h34-0-38" id="h34-0-38" class="i">+                        },
</a><a href="#h34-0-39" id="h34-0-39" class="i">+                        Column {
</a><a href="#h34-0-40" id="h34-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h34-0-41" id="h34-0-41" class="i">+                            datatype: Integer,
</a><a href="#h34-0-42" id="h34-0-42" class="i">+                            primary_key: false,
</a><a href="#h34-0-43" id="h34-0-43" class="i">+                            nullable: false,
</a><a href="#h34-0-44" id="h34-0-44" class="i">+                            default: None,
</a><a href="#h34-0-45" id="h34-0-45" class="i">+                            unique: false,
</a><a href="#h34-0-46" id="h34-0-46" class="i">+                            references: Some(
</a><a href="#h34-0-47" id="h34-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h34-0-48" id="h34-0-48" class="i">+                            ),
</a><a href="#h34-0-49" id="h34-0-49" class="i">+                            index: true,
</a><a href="#h34-0-50" id="h34-0-50" class="i">+                        },
</a><a href="#h34-0-51" id="h34-0-51" class="i">+                        Column {
</a><a href="#h34-0-52" id="h34-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h34-0-53" id="h34-0-53" class="i">+                            datatype: Integer,
</a><a href="#h34-0-54" id="h34-0-54" class="i">+                            primary_key: false,
</a><a href="#h34-0-55" id="h34-0-55" class="i">+                            nullable: false,
</a><a href="#h34-0-56" id="h34-0-56" class="i">+                            default: None,
</a><a href="#h34-0-57" id="h34-0-57" class="i">+                            unique: false,
</a><a href="#h34-0-58" id="h34-0-58" class="i">+                            references: None,
</a><a href="#h34-0-59" id="h34-0-59" class="i">+                            index: false,
</a><a href="#h34-0-60" id="h34-0-60" class="i">+                        },
</a><a href="#h34-0-61" id="h34-0-61" class="i">+                        Column {
</a><a href="#h34-0-62" id="h34-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h34-0-63" id="h34-0-63" class="i">+                            datatype: Float,
</a><a href="#h34-0-64" id="h34-0-64" class="i">+                            primary_key: false,
</a><a href="#h34-0-65" id="h34-0-65" class="i">+                            nullable: true,
</a><a href="#h34-0-66" id="h34-0-66" class="i">+                            default: Some(
</a><a href="#h34-0-67" id="h34-0-67" class="i">+                                Null,
</a><a href="#h34-0-68" id="h34-0-68" class="i">+                            ),
</a><a href="#h34-0-69" id="h34-0-69" class="i">+                            unique: false,
</a><a href="#h34-0-70" id="h34-0-70" class="i">+                            references: None,
</a><a href="#h34-0-71" id="h34-0-71" class="i">+                            index: false,
</a><a href="#h34-0-72" id="h34-0-72" class="i">+                        },
</a><a href="#h34-0-73" id="h34-0-73" class="i">+                        Column {
</a><a href="#h34-0-74" id="h34-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h34-0-75" id="h34-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h34-0-76" id="h34-0-76" class="i">+                            primary_key: false,
</a><a href="#h34-0-77" id="h34-0-77" class="i">+                            nullable: true,
</a><a href="#h34-0-78" id="h34-0-78" class="i">+                            default: Some(
</a><a href="#h34-0-79" id="h34-0-79" class="i">+                                Null,
</a><a href="#h34-0-80" id="h34-0-80" class="i">+                            ),
</a><a href="#h34-0-81" id="h34-0-81" class="i">+                            unique: false,
</a><a href="#h34-0-82" id="h34-0-82" class="i">+                            references: None,
</a><a href="#h34-0-83" id="h34-0-83" class="i">+                            index: false,
</a><a href="#h34-0-84" id="h34-0-84" class="i">+                        },
</a><a href="#h34-0-85" id="h34-0-85" class="i">+                    ],
</a><a href="#h34-0-86" id="h34-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
             left_size: 7,
             right: Scan {
<a href="#h34-0-92" id="h34-0-92" class="d">-                table: &quot;genres&quot;,
</a><a href="#h34-0-93" id="h34-0-93" class="i">+                table: Table {
</a><a href="#h34-0-94" id="h34-0-94" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h34-0-95" id="h34-0-95" class="i">+                    columns: [
</a><a href="#h34-0-96" id="h34-0-96" class="i">+                        Column {
</a><a href="#h34-0-97" id="h34-0-97" class="i">+                            name: &quot;id&quot;,
</a><a href="#h34-0-98" id="h34-0-98" class="i">+                            datatype: Integer,
</a><a href="#h34-0-99" id="h34-0-99" class="i">+                            primary_key: true,
</a><a href="#h34-0-100" id="h34-0-100" class="i">+                            nullable: false,
</a><a href="#h34-0-101" id="h34-0-101" class="i">+                            default: None,
</a><a href="#h34-0-102" id="h34-0-102" class="i">+                            unique: true,
</a><a href="#h34-0-103" id="h34-0-103" class="i">+                            references: None,
</a><a href="#h34-0-104" id="h34-0-104" class="i">+                            index: false,
</a><a href="#h34-0-105" id="h34-0-105" class="i">+                        },
</a><a href="#h34-0-106" id="h34-0-106" class="i">+                        Column {
</a><a href="#h34-0-107" id="h34-0-107" class="i">+                            name: &quot;name&quot;,
</a><a href="#h34-0-108" id="h34-0-108" class="i">+                            datatype: String,
</a><a href="#h34-0-109" id="h34-0-109" class="i">+                            primary_key: false,
</a><a href="#h34-0-110" id="h34-0-110" class="i">+                            nullable: false,
</a><a href="#h34-0-111" id="h34-0-111" class="i">+                            default: None,
</a><a href="#h34-0-112" id="h34-0-112" class="i">+                            unique: false,
</a><a href="#h34-0-113" id="h34-0-113" class="i">+                            references: None,
</a><a href="#h34-0-114" id="h34-0-114" class="i">+                            index: false,
</a><a href="#h34-0-115" id="h34-0-115" class="i">+                        },
</a><a href="#h34-0-116" id="h34-0-116" class="i">+                    ],
</a><a href="#h34-0-117" id="h34-0-117" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h34-1" id="h34-1" class="h">@@ -142,7 +248,31 @@ Plan: Select(
</a>         },
         left_size: 9,
         right: Scan {
<a href="#h34-1-3" id="h34-1-3" class="d">-            table: &quot;countries&quot;,
</a><a href="#h34-1-4" id="h34-1-4" class="i">+            table: Table {
</a><a href="#h34-1-5" id="h34-1-5" class="i">+                name: &quot;countries&quot;,
</a><a href="#h34-1-6" id="h34-1-6" class="i">+                columns: [
</a><a href="#h34-1-7" id="h34-1-7" class="i">+                    Column {
</a><a href="#h34-1-8" id="h34-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h34-1-9" id="h34-1-9" class="i">+                        datatype: String,
</a><a href="#h34-1-10" id="h34-1-10" class="i">+                        primary_key: true,
</a><a href="#h34-1-11" id="h34-1-11" class="i">+                        nullable: false,
</a><a href="#h34-1-12" id="h34-1-12" class="i">+                        default: None,
</a><a href="#h34-1-13" id="h34-1-13" class="i">+                        unique: true,
</a><a href="#h34-1-14" id="h34-1-14" class="i">+                        references: None,
</a><a href="#h34-1-15" id="h34-1-15" class="i">+                        index: false,
</a><a href="#h34-1-16" id="h34-1-16" class="i">+                    },
</a><a href="#h34-1-17" id="h34-1-17" class="i">+                    Column {
</a><a href="#h34-1-18" id="h34-1-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h34-1-19" id="h34-1-19" class="i">+                        datatype: String,
</a><a href="#h34-1-20" id="h34-1-20" class="i">+                        primary_key: false,
</a><a href="#h34-1-21" id="h34-1-21" class="i">+                        nullable: false,
</a><a href="#h34-1-22" id="h34-1-22" class="i">+                        default: None,
</a><a href="#h34-1-23" id="h34-1-23" class="i">+                        unique: false,
</a><a href="#h34-1-24" id="h34-1-24" class="i">+                        references: None,
</a><a href="#h34-1-25" id="h34-1-25" class="i">+                        index: false,
</a><a href="#h34-1-26" id="h34-1-26" class="i">+                    },
</a><a href="#h34-1-27" id="h34-1-27" class="i">+                ],
</a><a href="#h34-1-28" id="h34-1-28" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h34-2" id="h34-2" class="h">@@ -155,13 +285,119 @@ Optimized plan: Select(
</a>     NestedLoopJoin {
         left: NestedLoopJoin {
             left: Scan {
<a href="#h34-2-3" id="h34-2-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h34-2-4" id="h34-2-4" class="i">+                table: Table {
</a><a href="#h34-2-5" id="h34-2-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h34-2-6" id="h34-2-6" class="i">+                    columns: [
</a><a href="#h34-2-7" id="h34-2-7" class="i">+                        Column {
</a><a href="#h34-2-8" id="h34-2-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h34-2-9" id="h34-2-9" class="i">+                            datatype: Integer,
</a><a href="#h34-2-10" id="h34-2-10" class="i">+                            primary_key: true,
</a><a href="#h34-2-11" id="h34-2-11" class="i">+                            nullable: false,
</a><a href="#h34-2-12" id="h34-2-12" class="i">+                            default: None,
</a><a href="#h34-2-13" id="h34-2-13" class="i">+                            unique: true,
</a><a href="#h34-2-14" id="h34-2-14" class="i">+                            references: None,
</a><a href="#h34-2-15" id="h34-2-15" class="i">+                            index: false,
</a><a href="#h34-2-16" id="h34-2-16" class="i">+                        },
</a><a href="#h34-2-17" id="h34-2-17" class="i">+                        Column {
</a><a href="#h34-2-18" id="h34-2-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h34-2-19" id="h34-2-19" class="i">+                            datatype: String,
</a><a href="#h34-2-20" id="h34-2-20" class="i">+                            primary_key: false,
</a><a href="#h34-2-21" id="h34-2-21" class="i">+                            nullable: false,
</a><a href="#h34-2-22" id="h34-2-22" class="i">+                            default: None,
</a><a href="#h34-2-23" id="h34-2-23" class="i">+                            unique: false,
</a><a href="#h34-2-24" id="h34-2-24" class="i">+                            references: None,
</a><a href="#h34-2-25" id="h34-2-25" class="i">+                            index: false,
</a><a href="#h34-2-26" id="h34-2-26" class="i">+                        },
</a><a href="#h34-2-27" id="h34-2-27" class="i">+                        Column {
</a><a href="#h34-2-28" id="h34-2-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h34-2-29" id="h34-2-29" class="i">+                            datatype: Integer,
</a><a href="#h34-2-30" id="h34-2-30" class="i">+                            primary_key: false,
</a><a href="#h34-2-31" id="h34-2-31" class="i">+                            nullable: false,
</a><a href="#h34-2-32" id="h34-2-32" class="i">+                            default: None,
</a><a href="#h34-2-33" id="h34-2-33" class="i">+                            unique: false,
</a><a href="#h34-2-34" id="h34-2-34" class="i">+                            references: Some(
</a><a href="#h34-2-35" id="h34-2-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h34-2-36" id="h34-2-36" class="i">+                            ),
</a><a href="#h34-2-37" id="h34-2-37" class="i">+                            index: true,
</a><a href="#h34-2-38" id="h34-2-38" class="i">+                        },
</a><a href="#h34-2-39" id="h34-2-39" class="i">+                        Column {
</a><a href="#h34-2-40" id="h34-2-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h34-2-41" id="h34-2-41" class="i">+                            datatype: Integer,
</a><a href="#h34-2-42" id="h34-2-42" class="i">+                            primary_key: false,
</a><a href="#h34-2-43" id="h34-2-43" class="i">+                            nullable: false,
</a><a href="#h34-2-44" id="h34-2-44" class="i">+                            default: None,
</a><a href="#h34-2-45" id="h34-2-45" class="i">+                            unique: false,
</a><a href="#h34-2-46" id="h34-2-46" class="i">+                            references: Some(
</a><a href="#h34-2-47" id="h34-2-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h34-2-48" id="h34-2-48" class="i">+                            ),
</a><a href="#h34-2-49" id="h34-2-49" class="i">+                            index: true,
</a><a href="#h34-2-50" id="h34-2-50" class="i">+                        },
</a><a href="#h34-2-51" id="h34-2-51" class="i">+                        Column {
</a><a href="#h34-2-52" id="h34-2-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h34-2-53" id="h34-2-53" class="i">+                            datatype: Integer,
</a><a href="#h34-2-54" id="h34-2-54" class="i">+                            primary_key: false,
</a><a href="#h34-2-55" id="h34-2-55" class="i">+                            nullable: false,
</a><a href="#h34-2-56" id="h34-2-56" class="i">+                            default: None,
</a><a href="#h34-2-57" id="h34-2-57" class="i">+                            unique: false,
</a><a href="#h34-2-58" id="h34-2-58" class="i">+                            references: None,
</a><a href="#h34-2-59" id="h34-2-59" class="i">+                            index: false,
</a><a href="#h34-2-60" id="h34-2-60" class="i">+                        },
</a><a href="#h34-2-61" id="h34-2-61" class="i">+                        Column {
</a><a href="#h34-2-62" id="h34-2-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h34-2-63" id="h34-2-63" class="i">+                            datatype: Float,
</a><a href="#h34-2-64" id="h34-2-64" class="i">+                            primary_key: false,
</a><a href="#h34-2-65" id="h34-2-65" class="i">+                            nullable: true,
</a><a href="#h34-2-66" id="h34-2-66" class="i">+                            default: Some(
</a><a href="#h34-2-67" id="h34-2-67" class="i">+                                Null,
</a><a href="#h34-2-68" id="h34-2-68" class="i">+                            ),
</a><a href="#h34-2-69" id="h34-2-69" class="i">+                            unique: false,
</a><a href="#h34-2-70" id="h34-2-70" class="i">+                            references: None,
</a><a href="#h34-2-71" id="h34-2-71" class="i">+                            index: false,
</a><a href="#h34-2-72" id="h34-2-72" class="i">+                        },
</a><a href="#h34-2-73" id="h34-2-73" class="i">+                        Column {
</a><a href="#h34-2-74" id="h34-2-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h34-2-75" id="h34-2-75" class="i">+                            datatype: Boolean,
</a><a href="#h34-2-76" id="h34-2-76" class="i">+                            primary_key: false,
</a><a href="#h34-2-77" id="h34-2-77" class="i">+                            nullable: true,
</a><a href="#h34-2-78" id="h34-2-78" class="i">+                            default: Some(
</a><a href="#h34-2-79" id="h34-2-79" class="i">+                                Null,
</a><a href="#h34-2-80" id="h34-2-80" class="i">+                            ),
</a><a href="#h34-2-81" id="h34-2-81" class="i">+                            unique: false,
</a><a href="#h34-2-82" id="h34-2-82" class="i">+                            references: None,
</a><a href="#h34-2-83" id="h34-2-83" class="i">+                            index: false,
</a><a href="#h34-2-84" id="h34-2-84" class="i">+                        },
</a><a href="#h34-2-85" id="h34-2-85" class="i">+                    ],
</a><a href="#h34-2-86" id="h34-2-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
             left_size: 7,
             right: Scan {
<a href="#h34-2-92" id="h34-2-92" class="d">-                table: &quot;genres&quot;,
</a><a href="#h34-2-93" id="h34-2-93" class="i">+                table: Table {
</a><a href="#h34-2-94" id="h34-2-94" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h34-2-95" id="h34-2-95" class="i">+                    columns: [
</a><a href="#h34-2-96" id="h34-2-96" class="i">+                        Column {
</a><a href="#h34-2-97" id="h34-2-97" class="i">+                            name: &quot;id&quot;,
</a><a href="#h34-2-98" id="h34-2-98" class="i">+                            datatype: Integer,
</a><a href="#h34-2-99" id="h34-2-99" class="i">+                            primary_key: true,
</a><a href="#h34-2-100" id="h34-2-100" class="i">+                            nullable: false,
</a><a href="#h34-2-101" id="h34-2-101" class="i">+                            default: None,
</a><a href="#h34-2-102" id="h34-2-102" class="i">+                            unique: true,
</a><a href="#h34-2-103" id="h34-2-103" class="i">+                            references: None,
</a><a href="#h34-2-104" id="h34-2-104" class="i">+                            index: false,
</a><a href="#h34-2-105" id="h34-2-105" class="i">+                        },
</a><a href="#h34-2-106" id="h34-2-106" class="i">+                        Column {
</a><a href="#h34-2-107" id="h34-2-107" class="i">+                            name: &quot;name&quot;,
</a><a href="#h34-2-108" id="h34-2-108" class="i">+                            datatype: String,
</a><a href="#h34-2-109" id="h34-2-109" class="i">+                            primary_key: false,
</a><a href="#h34-2-110" id="h34-2-110" class="i">+                            nullable: false,
</a><a href="#h34-2-111" id="h34-2-111" class="i">+                            default: None,
</a><a href="#h34-2-112" id="h34-2-112" class="i">+                            unique: false,
</a><a href="#h34-2-113" id="h34-2-113" class="i">+                            references: None,
</a><a href="#h34-2-114" id="h34-2-114" class="i">+                            index: false,
</a><a href="#h34-2-115" id="h34-2-115" class="i">+                        },
</a><a href="#h34-2-116" id="h34-2-116" class="i">+                    ],
</a><a href="#h34-2-117" id="h34-2-117" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h34-3" id="h34-3" class="h">@@ -170,7 +406,31 @@ Optimized plan: Select(
</a>         },
         left_size: 9,
         right: Scan {
<a href="#h34-3-3" id="h34-3-3" class="d">-            table: &quot;countries&quot;,
</a><a href="#h34-3-4" id="h34-3-4" class="i">+            table: Table {
</a><a href="#h34-3-5" id="h34-3-5" class="i">+                name: &quot;countries&quot;,
</a><a href="#h34-3-6" id="h34-3-6" class="i">+                columns: [
</a><a href="#h34-3-7" id="h34-3-7" class="i">+                    Column {
</a><a href="#h34-3-8" id="h34-3-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h34-3-9" id="h34-3-9" class="i">+                        datatype: String,
</a><a href="#h34-3-10" id="h34-3-10" class="i">+                        primary_key: true,
</a><a href="#h34-3-11" id="h34-3-11" class="i">+                        nullable: false,
</a><a href="#h34-3-12" id="h34-3-12" class="i">+                        default: None,
</a><a href="#h34-3-13" id="h34-3-13" class="i">+                        unique: true,
</a><a href="#h34-3-14" id="h34-3-14" class="i">+                        references: None,
</a><a href="#h34-3-15" id="h34-3-15" class="i">+                        index: false,
</a><a href="#h34-3-16" id="h34-3-16" class="i">+                    },
</a><a href="#h34-3-17" id="h34-3-17" class="i">+                    Column {
</a><a href="#h34-3-18" id="h34-3-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h34-3-19" id="h34-3-19" class="i">+                        datatype: String,
</a><a href="#h34-3-20" id="h34-3-20" class="i">+                        primary_key: false,
</a><a href="#h34-3-21" id="h34-3-21" class="i">+                        nullable: false,
</a><a href="#h34-3-22" id="h34-3-22" class="i">+                        default: None,
</a><a href="#h34-3-23" id="h34-3-23" class="i">+                        unique: false,
</a><a href="#h34-3-24" id="h34-3-24" class="i">+                        references: None,
</a><a href="#h34-3-25" id="h34-3-25" class="i">+                        index: false,
</a><a href="#h34-3-26" id="h34-3-26" class="i">+                    },
</a><a href="#h34-3-27" id="h34-3-27" class="i">+                ],
</a><a href="#h34-3-28" id="h34-3-28" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h35" href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a> b/<a href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -72,7 +72,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h35-0-3" id="h35-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h35-0-4" id="h35-0-4" class="i">+                        table: Table {
</a><a href="#h35-0-5" id="h35-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h35-0-6" id="h35-0-6" class="i">+                            columns: [
</a><a href="#h35-0-7" id="h35-0-7" class="i">+                                Column {
</a><a href="#h35-0-8" id="h35-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h35-0-9" id="h35-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h35-0-10" id="h35-0-10" class="i">+                                    primary_key: true,
</a><a href="#h35-0-11" id="h35-0-11" class="i">+                                    nullable: false,
</a><a href="#h35-0-12" id="h35-0-12" class="i">+                                    default: None,
</a><a href="#h35-0-13" id="h35-0-13" class="i">+                                    unique: true,
</a><a href="#h35-0-14" id="h35-0-14" class="i">+                                    references: None,
</a><a href="#h35-0-15" id="h35-0-15" class="i">+                                    index: false,
</a><a href="#h35-0-16" id="h35-0-16" class="i">+                                },
</a><a href="#h35-0-17" id="h35-0-17" class="i">+                                Column {
</a><a href="#h35-0-18" id="h35-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h35-0-19" id="h35-0-19" class="i">+                                    datatype: String,
</a><a href="#h35-0-20" id="h35-0-20" class="i">+                                    primary_key: false,
</a><a href="#h35-0-21" id="h35-0-21" class="i">+                                    nullable: false,
</a><a href="#h35-0-22" id="h35-0-22" class="i">+                                    default: None,
</a><a href="#h35-0-23" id="h35-0-23" class="i">+                                    unique: false,
</a><a href="#h35-0-24" id="h35-0-24" class="i">+                                    references: None,
</a><a href="#h35-0-25" id="h35-0-25" class="i">+                                    index: false,
</a><a href="#h35-0-26" id="h35-0-26" class="i">+                                },
</a><a href="#h35-0-27" id="h35-0-27" class="i">+                                Column {
</a><a href="#h35-0-28" id="h35-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h35-0-29" id="h35-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h35-0-30" id="h35-0-30" class="i">+                                    primary_key: false,
</a><a href="#h35-0-31" id="h35-0-31" class="i">+                                    nullable: false,
</a><a href="#h35-0-32" id="h35-0-32" class="i">+                                    default: None,
</a><a href="#h35-0-33" id="h35-0-33" class="i">+                                    unique: false,
</a><a href="#h35-0-34" id="h35-0-34" class="i">+                                    references: Some(
</a><a href="#h35-0-35" id="h35-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h35-0-36" id="h35-0-36" class="i">+                                    ),
</a><a href="#h35-0-37" id="h35-0-37" class="i">+                                    index: true,
</a><a href="#h35-0-38" id="h35-0-38" class="i">+                                },
</a><a href="#h35-0-39" id="h35-0-39" class="i">+                                Column {
</a><a href="#h35-0-40" id="h35-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h35-0-41" id="h35-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h35-0-42" id="h35-0-42" class="i">+                                    primary_key: false,
</a><a href="#h35-0-43" id="h35-0-43" class="i">+                                    nullable: false,
</a><a href="#h35-0-44" id="h35-0-44" class="i">+                                    default: None,
</a><a href="#h35-0-45" id="h35-0-45" class="i">+                                    unique: false,
</a><a href="#h35-0-46" id="h35-0-46" class="i">+                                    references: Some(
</a><a href="#h35-0-47" id="h35-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h35-0-48" id="h35-0-48" class="i">+                                    ),
</a><a href="#h35-0-49" id="h35-0-49" class="i">+                                    index: true,
</a><a href="#h35-0-50" id="h35-0-50" class="i">+                                },
</a><a href="#h35-0-51" id="h35-0-51" class="i">+                                Column {
</a><a href="#h35-0-52" id="h35-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h35-0-53" id="h35-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h35-0-54" id="h35-0-54" class="i">+                                    primary_key: false,
</a><a href="#h35-0-55" id="h35-0-55" class="i">+                                    nullable: false,
</a><a href="#h35-0-56" id="h35-0-56" class="i">+                                    default: None,
</a><a href="#h35-0-57" id="h35-0-57" class="i">+                                    unique: false,
</a><a href="#h35-0-58" id="h35-0-58" class="i">+                                    references: None,
</a><a href="#h35-0-59" id="h35-0-59" class="i">+                                    index: false,
</a><a href="#h35-0-60" id="h35-0-60" class="i">+                                },
</a><a href="#h35-0-61" id="h35-0-61" class="i">+                                Column {
</a><a href="#h35-0-62" id="h35-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h35-0-63" id="h35-0-63" class="i">+                                    datatype: Float,
</a><a href="#h35-0-64" id="h35-0-64" class="i">+                                    primary_key: false,
</a><a href="#h35-0-65" id="h35-0-65" class="i">+                                    nullable: true,
</a><a href="#h35-0-66" id="h35-0-66" class="i">+                                    default: Some(
</a><a href="#h35-0-67" id="h35-0-67" class="i">+                                        Null,
</a><a href="#h35-0-68" id="h35-0-68" class="i">+                                    ),
</a><a href="#h35-0-69" id="h35-0-69" class="i">+                                    unique: false,
</a><a href="#h35-0-70" id="h35-0-70" class="i">+                                    references: None,
</a><a href="#h35-0-71" id="h35-0-71" class="i">+                                    index: false,
</a><a href="#h35-0-72" id="h35-0-72" class="i">+                                },
</a><a href="#h35-0-73" id="h35-0-73" class="i">+                                Column {
</a><a href="#h35-0-74" id="h35-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h35-0-75" id="h35-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h35-0-76" id="h35-0-76" class="i">+                                    primary_key: false,
</a><a href="#h35-0-77" id="h35-0-77" class="i">+                                    nullable: true,
</a><a href="#h35-0-78" id="h35-0-78" class="i">+                                    default: Some(
</a><a href="#h35-0-79" id="h35-0-79" class="i">+                                        Null,
</a><a href="#h35-0-80" id="h35-0-80" class="i">+                                    ),
</a><a href="#h35-0-81" id="h35-0-81" class="i">+                                    unique: false,
</a><a href="#h35-0-82" id="h35-0-82" class="i">+                                    references: None,
</a><a href="#h35-0-83" id="h35-0-83" class="i">+                                    index: false,
</a><a href="#h35-0-84" id="h35-0-84" class="i">+                                },
</a><a href="#h35-0-85" id="h35-0-85" class="i">+                            ],
</a><a href="#h35-0-86" id="h35-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h35-1" id="h35-1" class="h">@@ -149,7 +231,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h35-1-3" id="h35-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h35-1-4" id="h35-1-4" class="i">+                        table: Table {
</a><a href="#h35-1-5" id="h35-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h35-1-6" id="h35-1-6" class="i">+                            columns: [
</a><a href="#h35-1-7" id="h35-1-7" class="i">+                                Column {
</a><a href="#h35-1-8" id="h35-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h35-1-9" id="h35-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h35-1-10" id="h35-1-10" class="i">+                                    primary_key: true,
</a><a href="#h35-1-11" id="h35-1-11" class="i">+                                    nullable: false,
</a><a href="#h35-1-12" id="h35-1-12" class="i">+                                    default: None,
</a><a href="#h35-1-13" id="h35-1-13" class="i">+                                    unique: true,
</a><a href="#h35-1-14" id="h35-1-14" class="i">+                                    references: None,
</a><a href="#h35-1-15" id="h35-1-15" class="i">+                                    index: false,
</a><a href="#h35-1-16" id="h35-1-16" class="i">+                                },
</a><a href="#h35-1-17" id="h35-1-17" class="i">+                                Column {
</a><a href="#h35-1-18" id="h35-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h35-1-19" id="h35-1-19" class="i">+                                    datatype: String,
</a><a href="#h35-1-20" id="h35-1-20" class="i">+                                    primary_key: false,
</a><a href="#h35-1-21" id="h35-1-21" class="i">+                                    nullable: false,
</a><a href="#h35-1-22" id="h35-1-22" class="i">+                                    default: None,
</a><a href="#h35-1-23" id="h35-1-23" class="i">+                                    unique: false,
</a><a href="#h35-1-24" id="h35-1-24" class="i">+                                    references: None,
</a><a href="#h35-1-25" id="h35-1-25" class="i">+                                    index: false,
</a><a href="#h35-1-26" id="h35-1-26" class="i">+                                },
</a><a href="#h35-1-27" id="h35-1-27" class="i">+                                Column {
</a><a href="#h35-1-28" id="h35-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h35-1-29" id="h35-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h35-1-30" id="h35-1-30" class="i">+                                    primary_key: false,
</a><a href="#h35-1-31" id="h35-1-31" class="i">+                                    nullable: false,
</a><a href="#h35-1-32" id="h35-1-32" class="i">+                                    default: None,
</a><a href="#h35-1-33" id="h35-1-33" class="i">+                                    unique: false,
</a><a href="#h35-1-34" id="h35-1-34" class="i">+                                    references: Some(
</a><a href="#h35-1-35" id="h35-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h35-1-36" id="h35-1-36" class="i">+                                    ),
</a><a href="#h35-1-37" id="h35-1-37" class="i">+                                    index: true,
</a><a href="#h35-1-38" id="h35-1-38" class="i">+                                },
</a><a href="#h35-1-39" id="h35-1-39" class="i">+                                Column {
</a><a href="#h35-1-40" id="h35-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h35-1-41" id="h35-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h35-1-42" id="h35-1-42" class="i">+                                    primary_key: false,
</a><a href="#h35-1-43" id="h35-1-43" class="i">+                                    nullable: false,
</a><a href="#h35-1-44" id="h35-1-44" class="i">+                                    default: None,
</a><a href="#h35-1-45" id="h35-1-45" class="i">+                                    unique: false,
</a><a href="#h35-1-46" id="h35-1-46" class="i">+                                    references: Some(
</a><a href="#h35-1-47" id="h35-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h35-1-48" id="h35-1-48" class="i">+                                    ),
</a><a href="#h35-1-49" id="h35-1-49" class="i">+                                    index: true,
</a><a href="#h35-1-50" id="h35-1-50" class="i">+                                },
</a><a href="#h35-1-51" id="h35-1-51" class="i">+                                Column {
</a><a href="#h35-1-52" id="h35-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h35-1-53" id="h35-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h35-1-54" id="h35-1-54" class="i">+                                    primary_key: false,
</a><a href="#h35-1-55" id="h35-1-55" class="i">+                                    nullable: false,
</a><a href="#h35-1-56" id="h35-1-56" class="i">+                                    default: None,
</a><a href="#h35-1-57" id="h35-1-57" class="i">+                                    unique: false,
</a><a href="#h35-1-58" id="h35-1-58" class="i">+                                    references: None,
</a><a href="#h35-1-59" id="h35-1-59" class="i">+                                    index: false,
</a><a href="#h35-1-60" id="h35-1-60" class="i">+                                },
</a><a href="#h35-1-61" id="h35-1-61" class="i">+                                Column {
</a><a href="#h35-1-62" id="h35-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h35-1-63" id="h35-1-63" class="i">+                                    datatype: Float,
</a><a href="#h35-1-64" id="h35-1-64" class="i">+                                    primary_key: false,
</a><a href="#h35-1-65" id="h35-1-65" class="i">+                                    nullable: true,
</a><a href="#h35-1-66" id="h35-1-66" class="i">+                                    default: Some(
</a><a href="#h35-1-67" id="h35-1-67" class="i">+                                        Null,
</a><a href="#h35-1-68" id="h35-1-68" class="i">+                                    ),
</a><a href="#h35-1-69" id="h35-1-69" class="i">+                                    unique: false,
</a><a href="#h35-1-70" id="h35-1-70" class="i">+                                    references: None,
</a><a href="#h35-1-71" id="h35-1-71" class="i">+                                    index: false,
</a><a href="#h35-1-72" id="h35-1-72" class="i">+                                },
</a><a href="#h35-1-73" id="h35-1-73" class="i">+                                Column {
</a><a href="#h35-1-74" id="h35-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h35-1-75" id="h35-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h35-1-76" id="h35-1-76" class="i">+                                    primary_key: false,
</a><a href="#h35-1-77" id="h35-1-77" class="i">+                                    nullable: true,
</a><a href="#h35-1-78" id="h35-1-78" class="i">+                                    default: Some(
</a><a href="#h35-1-79" id="h35-1-79" class="i">+                                        Null,
</a><a href="#h35-1-80" id="h35-1-80" class="i">+                                    ),
</a><a href="#h35-1-81" id="h35-1-81" class="i">+                                    unique: false,
</a><a href="#h35-1-82" id="h35-1-82" class="i">+                                    references: None,
</a><a href="#h35-1-83" id="h35-1-83" class="i">+                                    index: false,
</a><a href="#h35-1-84" id="h35-1-84" class="i">+                                },
</a><a href="#h35-1-85" id="h35-1-85" class="i">+                            ],
</a><a href="#h35-1-86" id="h35-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h36" href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a> b/<a href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -91,7 +91,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h36-0-3" id="h36-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h36-0-4" id="h36-0-4" class="i">+                        table: Table {
</a><a href="#h36-0-5" id="h36-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h36-0-6" id="h36-0-6" class="i">+                            columns: [
</a><a href="#h36-0-7" id="h36-0-7" class="i">+                                Column {
</a><a href="#h36-0-8" id="h36-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h36-0-9" id="h36-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h36-0-10" id="h36-0-10" class="i">+                                    primary_key: true,
</a><a href="#h36-0-11" id="h36-0-11" class="i">+                                    nullable: false,
</a><a href="#h36-0-12" id="h36-0-12" class="i">+                                    default: None,
</a><a href="#h36-0-13" id="h36-0-13" class="i">+                                    unique: true,
</a><a href="#h36-0-14" id="h36-0-14" class="i">+                                    references: None,
</a><a href="#h36-0-15" id="h36-0-15" class="i">+                                    index: false,
</a><a href="#h36-0-16" id="h36-0-16" class="i">+                                },
</a><a href="#h36-0-17" id="h36-0-17" class="i">+                                Column {
</a><a href="#h36-0-18" id="h36-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h36-0-19" id="h36-0-19" class="i">+                                    datatype: String,
</a><a href="#h36-0-20" id="h36-0-20" class="i">+                                    primary_key: false,
</a><a href="#h36-0-21" id="h36-0-21" class="i">+                                    nullable: false,
</a><a href="#h36-0-22" id="h36-0-22" class="i">+                                    default: None,
</a><a href="#h36-0-23" id="h36-0-23" class="i">+                                    unique: false,
</a><a href="#h36-0-24" id="h36-0-24" class="i">+                                    references: None,
</a><a href="#h36-0-25" id="h36-0-25" class="i">+                                    index: false,
</a><a href="#h36-0-26" id="h36-0-26" class="i">+                                },
</a><a href="#h36-0-27" id="h36-0-27" class="i">+                                Column {
</a><a href="#h36-0-28" id="h36-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h36-0-29" id="h36-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h36-0-30" id="h36-0-30" class="i">+                                    primary_key: false,
</a><a href="#h36-0-31" id="h36-0-31" class="i">+                                    nullable: false,
</a><a href="#h36-0-32" id="h36-0-32" class="i">+                                    default: None,
</a><a href="#h36-0-33" id="h36-0-33" class="i">+                                    unique: false,
</a><a href="#h36-0-34" id="h36-0-34" class="i">+                                    references: Some(
</a><a href="#h36-0-35" id="h36-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h36-0-36" id="h36-0-36" class="i">+                                    ),
</a><a href="#h36-0-37" id="h36-0-37" class="i">+                                    index: true,
</a><a href="#h36-0-38" id="h36-0-38" class="i">+                                },
</a><a href="#h36-0-39" id="h36-0-39" class="i">+                                Column {
</a><a href="#h36-0-40" id="h36-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h36-0-41" id="h36-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h36-0-42" id="h36-0-42" class="i">+                                    primary_key: false,
</a><a href="#h36-0-43" id="h36-0-43" class="i">+                                    nullable: false,
</a><a href="#h36-0-44" id="h36-0-44" class="i">+                                    default: None,
</a><a href="#h36-0-45" id="h36-0-45" class="i">+                                    unique: false,
</a><a href="#h36-0-46" id="h36-0-46" class="i">+                                    references: Some(
</a><a href="#h36-0-47" id="h36-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h36-0-48" id="h36-0-48" class="i">+                                    ),
</a><a href="#h36-0-49" id="h36-0-49" class="i">+                                    index: true,
</a><a href="#h36-0-50" id="h36-0-50" class="i">+                                },
</a><a href="#h36-0-51" id="h36-0-51" class="i">+                                Column {
</a><a href="#h36-0-52" id="h36-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h36-0-53" id="h36-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h36-0-54" id="h36-0-54" class="i">+                                    primary_key: false,
</a><a href="#h36-0-55" id="h36-0-55" class="i">+                                    nullable: false,
</a><a href="#h36-0-56" id="h36-0-56" class="i">+                                    default: None,
</a><a href="#h36-0-57" id="h36-0-57" class="i">+                                    unique: false,
</a><a href="#h36-0-58" id="h36-0-58" class="i">+                                    references: None,
</a><a href="#h36-0-59" id="h36-0-59" class="i">+                                    index: false,
</a><a href="#h36-0-60" id="h36-0-60" class="i">+                                },
</a><a href="#h36-0-61" id="h36-0-61" class="i">+                                Column {
</a><a href="#h36-0-62" id="h36-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h36-0-63" id="h36-0-63" class="i">+                                    datatype: Float,
</a><a href="#h36-0-64" id="h36-0-64" class="i">+                                    primary_key: false,
</a><a href="#h36-0-65" id="h36-0-65" class="i">+                                    nullable: true,
</a><a href="#h36-0-66" id="h36-0-66" class="i">+                                    default: Some(
</a><a href="#h36-0-67" id="h36-0-67" class="i">+                                        Null,
</a><a href="#h36-0-68" id="h36-0-68" class="i">+                                    ),
</a><a href="#h36-0-69" id="h36-0-69" class="i">+                                    unique: false,
</a><a href="#h36-0-70" id="h36-0-70" class="i">+                                    references: None,
</a><a href="#h36-0-71" id="h36-0-71" class="i">+                                    index: false,
</a><a href="#h36-0-72" id="h36-0-72" class="i">+                                },
</a><a href="#h36-0-73" id="h36-0-73" class="i">+                                Column {
</a><a href="#h36-0-74" id="h36-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h36-0-75" id="h36-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h36-0-76" id="h36-0-76" class="i">+                                    primary_key: false,
</a><a href="#h36-0-77" id="h36-0-77" class="i">+                                    nullable: true,
</a><a href="#h36-0-78" id="h36-0-78" class="i">+                                    default: Some(
</a><a href="#h36-0-79" id="h36-0-79" class="i">+                                        Null,
</a><a href="#h36-0-80" id="h36-0-80" class="i">+                                    ),
</a><a href="#h36-0-81" id="h36-0-81" class="i">+                                    unique: false,
</a><a href="#h36-0-82" id="h36-0-82" class="i">+                                    references: None,
</a><a href="#h36-0-83" id="h36-0-83" class="i">+                                    index: false,
</a><a href="#h36-0-84" id="h36-0-84" class="i">+                                },
</a><a href="#h36-0-85" id="h36-0-85" class="i">+                            ],
</a><a href="#h36-0-86" id="h36-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h36-1" id="h36-1" class="h">@@ -197,7 +279,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h36-1-3" id="h36-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h36-1-4" id="h36-1-4" class="i">+                        table: Table {
</a><a href="#h36-1-5" id="h36-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h36-1-6" id="h36-1-6" class="i">+                            columns: [
</a><a href="#h36-1-7" id="h36-1-7" class="i">+                                Column {
</a><a href="#h36-1-8" id="h36-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h36-1-9" id="h36-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h36-1-10" id="h36-1-10" class="i">+                                    primary_key: true,
</a><a href="#h36-1-11" id="h36-1-11" class="i">+                                    nullable: false,
</a><a href="#h36-1-12" id="h36-1-12" class="i">+                                    default: None,
</a><a href="#h36-1-13" id="h36-1-13" class="i">+                                    unique: true,
</a><a href="#h36-1-14" id="h36-1-14" class="i">+                                    references: None,
</a><a href="#h36-1-15" id="h36-1-15" class="i">+                                    index: false,
</a><a href="#h36-1-16" id="h36-1-16" class="i">+                                },
</a><a href="#h36-1-17" id="h36-1-17" class="i">+                                Column {
</a><a href="#h36-1-18" id="h36-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h36-1-19" id="h36-1-19" class="i">+                                    datatype: String,
</a><a href="#h36-1-20" id="h36-1-20" class="i">+                                    primary_key: false,
</a><a href="#h36-1-21" id="h36-1-21" class="i">+                                    nullable: false,
</a><a href="#h36-1-22" id="h36-1-22" class="i">+                                    default: None,
</a><a href="#h36-1-23" id="h36-1-23" class="i">+                                    unique: false,
</a><a href="#h36-1-24" id="h36-1-24" class="i">+                                    references: None,
</a><a href="#h36-1-25" id="h36-1-25" class="i">+                                    index: false,
</a><a href="#h36-1-26" id="h36-1-26" class="i">+                                },
</a><a href="#h36-1-27" id="h36-1-27" class="i">+                                Column {
</a><a href="#h36-1-28" id="h36-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h36-1-29" id="h36-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h36-1-30" id="h36-1-30" class="i">+                                    primary_key: false,
</a><a href="#h36-1-31" id="h36-1-31" class="i">+                                    nullable: false,
</a><a href="#h36-1-32" id="h36-1-32" class="i">+                                    default: None,
</a><a href="#h36-1-33" id="h36-1-33" class="i">+                                    unique: false,
</a><a href="#h36-1-34" id="h36-1-34" class="i">+                                    references: Some(
</a><a href="#h36-1-35" id="h36-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h36-1-36" id="h36-1-36" class="i">+                                    ),
</a><a href="#h36-1-37" id="h36-1-37" class="i">+                                    index: true,
</a><a href="#h36-1-38" id="h36-1-38" class="i">+                                },
</a><a href="#h36-1-39" id="h36-1-39" class="i">+                                Column {
</a><a href="#h36-1-40" id="h36-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h36-1-41" id="h36-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h36-1-42" id="h36-1-42" class="i">+                                    primary_key: false,
</a><a href="#h36-1-43" id="h36-1-43" class="i">+                                    nullable: false,
</a><a href="#h36-1-44" id="h36-1-44" class="i">+                                    default: None,
</a><a href="#h36-1-45" id="h36-1-45" class="i">+                                    unique: false,
</a><a href="#h36-1-46" id="h36-1-46" class="i">+                                    references: Some(
</a><a href="#h36-1-47" id="h36-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h36-1-48" id="h36-1-48" class="i">+                                    ),
</a><a href="#h36-1-49" id="h36-1-49" class="i">+                                    index: true,
</a><a href="#h36-1-50" id="h36-1-50" class="i">+                                },
</a><a href="#h36-1-51" id="h36-1-51" class="i">+                                Column {
</a><a href="#h36-1-52" id="h36-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h36-1-53" id="h36-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h36-1-54" id="h36-1-54" class="i">+                                    primary_key: false,
</a><a href="#h36-1-55" id="h36-1-55" class="i">+                                    nullable: false,
</a><a href="#h36-1-56" id="h36-1-56" class="i">+                                    default: None,
</a><a href="#h36-1-57" id="h36-1-57" class="i">+                                    unique: false,
</a><a href="#h36-1-58" id="h36-1-58" class="i">+                                    references: None,
</a><a href="#h36-1-59" id="h36-1-59" class="i">+                                    index: false,
</a><a href="#h36-1-60" id="h36-1-60" class="i">+                                },
</a><a href="#h36-1-61" id="h36-1-61" class="i">+                                Column {
</a><a href="#h36-1-62" id="h36-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h36-1-63" id="h36-1-63" class="i">+                                    datatype: Float,
</a><a href="#h36-1-64" id="h36-1-64" class="i">+                                    primary_key: false,
</a><a href="#h36-1-65" id="h36-1-65" class="i">+                                    nullable: true,
</a><a href="#h36-1-66" id="h36-1-66" class="i">+                                    default: Some(
</a><a href="#h36-1-67" id="h36-1-67" class="i">+                                        Null,
</a><a href="#h36-1-68" id="h36-1-68" class="i">+                                    ),
</a><a href="#h36-1-69" id="h36-1-69" class="i">+                                    unique: false,
</a><a href="#h36-1-70" id="h36-1-70" class="i">+                                    references: None,
</a><a href="#h36-1-71" id="h36-1-71" class="i">+                                    index: false,
</a><a href="#h36-1-72" id="h36-1-72" class="i">+                                },
</a><a href="#h36-1-73" id="h36-1-73" class="i">+                                Column {
</a><a href="#h36-1-74" id="h36-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h36-1-75" id="h36-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h36-1-76" id="h36-1-76" class="i">+                                    primary_key: false,
</a><a href="#h36-1-77" id="h36-1-77" class="i">+                                    nullable: true,
</a><a href="#h36-1-78" id="h36-1-78" class="i">+                                    default: Some(
</a><a href="#h36-1-79" id="h36-1-79" class="i">+                                        Null,
</a><a href="#h36-1-80" id="h36-1-80" class="i">+                                    ),
</a><a href="#h36-1-81" id="h36-1-81" class="i">+                                    unique: false,
</a><a href="#h36-1-82" id="h36-1-82" class="i">+                                    references: None,
</a><a href="#h36-1-83" id="h36-1-83" class="i">+                                    index: false,
</a><a href="#h36-1-84" id="h36-1-84" class="i">+                                },
</a><a href="#h36-1-85" id="h36-1-85" class="i">+                            ],
</a><a href="#h36-1-86" id="h36-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h37" href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a> b/<a href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -99,7 +99,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h37-0-3" id="h37-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h37-0-4" id="h37-0-4" class="i">+                        table: Table {
</a><a href="#h37-0-5" id="h37-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h37-0-6" id="h37-0-6" class="i">+                            columns: [
</a><a href="#h37-0-7" id="h37-0-7" class="i">+                                Column {
</a><a href="#h37-0-8" id="h37-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h37-0-9" id="h37-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h37-0-10" id="h37-0-10" class="i">+                                    primary_key: true,
</a><a href="#h37-0-11" id="h37-0-11" class="i">+                                    nullable: false,
</a><a href="#h37-0-12" id="h37-0-12" class="i">+                                    default: None,
</a><a href="#h37-0-13" id="h37-0-13" class="i">+                                    unique: true,
</a><a href="#h37-0-14" id="h37-0-14" class="i">+                                    references: None,
</a><a href="#h37-0-15" id="h37-0-15" class="i">+                                    index: false,
</a><a href="#h37-0-16" id="h37-0-16" class="i">+                                },
</a><a href="#h37-0-17" id="h37-0-17" class="i">+                                Column {
</a><a href="#h37-0-18" id="h37-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h37-0-19" id="h37-0-19" class="i">+                                    datatype: String,
</a><a href="#h37-0-20" id="h37-0-20" class="i">+                                    primary_key: false,
</a><a href="#h37-0-21" id="h37-0-21" class="i">+                                    nullable: false,
</a><a href="#h37-0-22" id="h37-0-22" class="i">+                                    default: None,
</a><a href="#h37-0-23" id="h37-0-23" class="i">+                                    unique: false,
</a><a href="#h37-0-24" id="h37-0-24" class="i">+                                    references: None,
</a><a href="#h37-0-25" id="h37-0-25" class="i">+                                    index: false,
</a><a href="#h37-0-26" id="h37-0-26" class="i">+                                },
</a><a href="#h37-0-27" id="h37-0-27" class="i">+                                Column {
</a><a href="#h37-0-28" id="h37-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h37-0-29" id="h37-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h37-0-30" id="h37-0-30" class="i">+                                    primary_key: false,
</a><a href="#h37-0-31" id="h37-0-31" class="i">+                                    nullable: false,
</a><a href="#h37-0-32" id="h37-0-32" class="i">+                                    default: None,
</a><a href="#h37-0-33" id="h37-0-33" class="i">+                                    unique: false,
</a><a href="#h37-0-34" id="h37-0-34" class="i">+                                    references: Some(
</a><a href="#h37-0-35" id="h37-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h37-0-36" id="h37-0-36" class="i">+                                    ),
</a><a href="#h37-0-37" id="h37-0-37" class="i">+                                    index: true,
</a><a href="#h37-0-38" id="h37-0-38" class="i">+                                },
</a><a href="#h37-0-39" id="h37-0-39" class="i">+                                Column {
</a><a href="#h37-0-40" id="h37-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h37-0-41" id="h37-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h37-0-42" id="h37-0-42" class="i">+                                    primary_key: false,
</a><a href="#h37-0-43" id="h37-0-43" class="i">+                                    nullable: false,
</a><a href="#h37-0-44" id="h37-0-44" class="i">+                                    default: None,
</a><a href="#h37-0-45" id="h37-0-45" class="i">+                                    unique: false,
</a><a href="#h37-0-46" id="h37-0-46" class="i">+                                    references: Some(
</a><a href="#h37-0-47" id="h37-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h37-0-48" id="h37-0-48" class="i">+                                    ),
</a><a href="#h37-0-49" id="h37-0-49" class="i">+                                    index: true,
</a><a href="#h37-0-50" id="h37-0-50" class="i">+                                },
</a><a href="#h37-0-51" id="h37-0-51" class="i">+                                Column {
</a><a href="#h37-0-52" id="h37-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h37-0-53" id="h37-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h37-0-54" id="h37-0-54" class="i">+                                    primary_key: false,
</a><a href="#h37-0-55" id="h37-0-55" class="i">+                                    nullable: false,
</a><a href="#h37-0-56" id="h37-0-56" class="i">+                                    default: None,
</a><a href="#h37-0-57" id="h37-0-57" class="i">+                                    unique: false,
</a><a href="#h37-0-58" id="h37-0-58" class="i">+                                    references: None,
</a><a href="#h37-0-59" id="h37-0-59" class="i">+                                    index: false,
</a><a href="#h37-0-60" id="h37-0-60" class="i">+                                },
</a><a href="#h37-0-61" id="h37-0-61" class="i">+                                Column {
</a><a href="#h37-0-62" id="h37-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h37-0-63" id="h37-0-63" class="i">+                                    datatype: Float,
</a><a href="#h37-0-64" id="h37-0-64" class="i">+                                    primary_key: false,
</a><a href="#h37-0-65" id="h37-0-65" class="i">+                                    nullable: true,
</a><a href="#h37-0-66" id="h37-0-66" class="i">+                                    default: Some(
</a><a href="#h37-0-67" id="h37-0-67" class="i">+                                        Null,
</a><a href="#h37-0-68" id="h37-0-68" class="i">+                                    ),
</a><a href="#h37-0-69" id="h37-0-69" class="i">+                                    unique: false,
</a><a href="#h37-0-70" id="h37-0-70" class="i">+                                    references: None,
</a><a href="#h37-0-71" id="h37-0-71" class="i">+                                    index: false,
</a><a href="#h37-0-72" id="h37-0-72" class="i">+                                },
</a><a href="#h37-0-73" id="h37-0-73" class="i">+                                Column {
</a><a href="#h37-0-74" id="h37-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h37-0-75" id="h37-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h37-0-76" id="h37-0-76" class="i">+                                    primary_key: false,
</a><a href="#h37-0-77" id="h37-0-77" class="i">+                                    nullable: true,
</a><a href="#h37-0-78" id="h37-0-78" class="i">+                                    default: Some(
</a><a href="#h37-0-79" id="h37-0-79" class="i">+                                        Null,
</a><a href="#h37-0-80" id="h37-0-80" class="i">+                                    ),
</a><a href="#h37-0-81" id="h37-0-81" class="i">+                                    unique: false,
</a><a href="#h37-0-82" id="h37-0-82" class="i">+                                    references: None,
</a><a href="#h37-0-83" id="h37-0-83" class="i">+                                    index: false,
</a><a href="#h37-0-84" id="h37-0-84" class="i">+                                },
</a><a href="#h37-0-85" id="h37-0-85" class="i">+                            ],
</a><a href="#h37-0-86" id="h37-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h37-1" id="h37-1" class="h">@@ -216,7 +298,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h37-1-3" id="h37-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h37-1-4" id="h37-1-4" class="i">+                        table: Table {
</a><a href="#h37-1-5" id="h37-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h37-1-6" id="h37-1-6" class="i">+                            columns: [
</a><a href="#h37-1-7" id="h37-1-7" class="i">+                                Column {
</a><a href="#h37-1-8" id="h37-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h37-1-9" id="h37-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h37-1-10" id="h37-1-10" class="i">+                                    primary_key: true,
</a><a href="#h37-1-11" id="h37-1-11" class="i">+                                    nullable: false,
</a><a href="#h37-1-12" id="h37-1-12" class="i">+                                    default: None,
</a><a href="#h37-1-13" id="h37-1-13" class="i">+                                    unique: true,
</a><a href="#h37-1-14" id="h37-1-14" class="i">+                                    references: None,
</a><a href="#h37-1-15" id="h37-1-15" class="i">+                                    index: false,
</a><a href="#h37-1-16" id="h37-1-16" class="i">+                                },
</a><a href="#h37-1-17" id="h37-1-17" class="i">+                                Column {
</a><a href="#h37-1-18" id="h37-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h37-1-19" id="h37-1-19" class="i">+                                    datatype: String,
</a><a href="#h37-1-20" id="h37-1-20" class="i">+                                    primary_key: false,
</a><a href="#h37-1-21" id="h37-1-21" class="i">+                                    nullable: false,
</a><a href="#h37-1-22" id="h37-1-22" class="i">+                                    default: None,
</a><a href="#h37-1-23" id="h37-1-23" class="i">+                                    unique: false,
</a><a href="#h37-1-24" id="h37-1-24" class="i">+                                    references: None,
</a><a href="#h37-1-25" id="h37-1-25" class="i">+                                    index: false,
</a><a href="#h37-1-26" id="h37-1-26" class="i">+                                },
</a><a href="#h37-1-27" id="h37-1-27" class="i">+                                Column {
</a><a href="#h37-1-28" id="h37-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h37-1-29" id="h37-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h37-1-30" id="h37-1-30" class="i">+                                    primary_key: false,
</a><a href="#h37-1-31" id="h37-1-31" class="i">+                                    nullable: false,
</a><a href="#h37-1-32" id="h37-1-32" class="i">+                                    default: None,
</a><a href="#h37-1-33" id="h37-1-33" class="i">+                                    unique: false,
</a><a href="#h37-1-34" id="h37-1-34" class="i">+                                    references: Some(
</a><a href="#h37-1-35" id="h37-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h37-1-36" id="h37-1-36" class="i">+                                    ),
</a><a href="#h37-1-37" id="h37-1-37" class="i">+                                    index: true,
</a><a href="#h37-1-38" id="h37-1-38" class="i">+                                },
</a><a href="#h37-1-39" id="h37-1-39" class="i">+                                Column {
</a><a href="#h37-1-40" id="h37-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h37-1-41" id="h37-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h37-1-42" id="h37-1-42" class="i">+                                    primary_key: false,
</a><a href="#h37-1-43" id="h37-1-43" class="i">+                                    nullable: false,
</a><a href="#h37-1-44" id="h37-1-44" class="i">+                                    default: None,
</a><a href="#h37-1-45" id="h37-1-45" class="i">+                                    unique: false,
</a><a href="#h37-1-46" id="h37-1-46" class="i">+                                    references: Some(
</a><a href="#h37-1-47" id="h37-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h37-1-48" id="h37-1-48" class="i">+                                    ),
</a><a href="#h37-1-49" id="h37-1-49" class="i">+                                    index: true,
</a><a href="#h37-1-50" id="h37-1-50" class="i">+                                },
</a><a href="#h37-1-51" id="h37-1-51" class="i">+                                Column {
</a><a href="#h37-1-52" id="h37-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h37-1-53" id="h37-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h37-1-54" id="h37-1-54" class="i">+                                    primary_key: false,
</a><a href="#h37-1-55" id="h37-1-55" class="i">+                                    nullable: false,
</a><a href="#h37-1-56" id="h37-1-56" class="i">+                                    default: None,
</a><a href="#h37-1-57" id="h37-1-57" class="i">+                                    unique: false,
</a><a href="#h37-1-58" id="h37-1-58" class="i">+                                    references: None,
</a><a href="#h37-1-59" id="h37-1-59" class="i">+                                    index: false,
</a><a href="#h37-1-60" id="h37-1-60" class="i">+                                },
</a><a href="#h37-1-61" id="h37-1-61" class="i">+                                Column {
</a><a href="#h37-1-62" id="h37-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h37-1-63" id="h37-1-63" class="i">+                                    datatype: Float,
</a><a href="#h37-1-64" id="h37-1-64" class="i">+                                    primary_key: false,
</a><a href="#h37-1-65" id="h37-1-65" class="i">+                                    nullable: true,
</a><a href="#h37-1-66" id="h37-1-66" class="i">+                                    default: Some(
</a><a href="#h37-1-67" id="h37-1-67" class="i">+                                        Null,
</a><a href="#h37-1-68" id="h37-1-68" class="i">+                                    ),
</a><a href="#h37-1-69" id="h37-1-69" class="i">+                                    unique: false,
</a><a href="#h37-1-70" id="h37-1-70" class="i">+                                    references: None,
</a><a href="#h37-1-71" id="h37-1-71" class="i">+                                    index: false,
</a><a href="#h37-1-72" id="h37-1-72" class="i">+                                },
</a><a href="#h37-1-73" id="h37-1-73" class="i">+                                Column {
</a><a href="#h37-1-74" id="h37-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h37-1-75" id="h37-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h37-1-76" id="h37-1-76" class="i">+                                    primary_key: false,
</a><a href="#h37-1-77" id="h37-1-77" class="i">+                                    nullable: true,
</a><a href="#h37-1-78" id="h37-1-78" class="i">+                                    default: Some(
</a><a href="#h37-1-79" id="h37-1-79" class="i">+                                        Null,
</a><a href="#h37-1-80" id="h37-1-80" class="i">+                                    ),
</a><a href="#h37-1-81" id="h37-1-81" class="i">+                                    unique: false,
</a><a href="#h37-1-82" id="h37-1-82" class="i">+                                    references: None,
</a><a href="#h37-1-83" id="h37-1-83" class="i">+                                    index: false,
</a><a href="#h37-1-84" id="h37-1-84" class="i">+                                },
</a><a href="#h37-1-85" id="h37-1-85" class="i">+                            ],
</a><a href="#h37-1-86" id="h37-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h38" href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a> b/<a href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -79,7 +79,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h38-0-3" id="h38-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h38-0-4" id="h38-0-4" class="i">+                        table: Table {
</a><a href="#h38-0-5" id="h38-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h38-0-6" id="h38-0-6" class="i">+                            columns: [
</a><a href="#h38-0-7" id="h38-0-7" class="i">+                                Column {
</a><a href="#h38-0-8" id="h38-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h38-0-9" id="h38-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h38-0-10" id="h38-0-10" class="i">+                                    primary_key: true,
</a><a href="#h38-0-11" id="h38-0-11" class="i">+                                    nullable: false,
</a><a href="#h38-0-12" id="h38-0-12" class="i">+                                    default: None,
</a><a href="#h38-0-13" id="h38-0-13" class="i">+                                    unique: true,
</a><a href="#h38-0-14" id="h38-0-14" class="i">+                                    references: None,
</a><a href="#h38-0-15" id="h38-0-15" class="i">+                                    index: false,
</a><a href="#h38-0-16" id="h38-0-16" class="i">+                                },
</a><a href="#h38-0-17" id="h38-0-17" class="i">+                                Column {
</a><a href="#h38-0-18" id="h38-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h38-0-19" id="h38-0-19" class="i">+                                    datatype: String,
</a><a href="#h38-0-20" id="h38-0-20" class="i">+                                    primary_key: false,
</a><a href="#h38-0-21" id="h38-0-21" class="i">+                                    nullable: false,
</a><a href="#h38-0-22" id="h38-0-22" class="i">+                                    default: None,
</a><a href="#h38-0-23" id="h38-0-23" class="i">+                                    unique: false,
</a><a href="#h38-0-24" id="h38-0-24" class="i">+                                    references: None,
</a><a href="#h38-0-25" id="h38-0-25" class="i">+                                    index: false,
</a><a href="#h38-0-26" id="h38-0-26" class="i">+                                },
</a><a href="#h38-0-27" id="h38-0-27" class="i">+                                Column {
</a><a href="#h38-0-28" id="h38-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h38-0-29" id="h38-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h38-0-30" id="h38-0-30" class="i">+                                    primary_key: false,
</a><a href="#h38-0-31" id="h38-0-31" class="i">+                                    nullable: false,
</a><a href="#h38-0-32" id="h38-0-32" class="i">+                                    default: None,
</a><a href="#h38-0-33" id="h38-0-33" class="i">+                                    unique: false,
</a><a href="#h38-0-34" id="h38-0-34" class="i">+                                    references: Some(
</a><a href="#h38-0-35" id="h38-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h38-0-36" id="h38-0-36" class="i">+                                    ),
</a><a href="#h38-0-37" id="h38-0-37" class="i">+                                    index: true,
</a><a href="#h38-0-38" id="h38-0-38" class="i">+                                },
</a><a href="#h38-0-39" id="h38-0-39" class="i">+                                Column {
</a><a href="#h38-0-40" id="h38-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h38-0-41" id="h38-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h38-0-42" id="h38-0-42" class="i">+                                    primary_key: false,
</a><a href="#h38-0-43" id="h38-0-43" class="i">+                                    nullable: false,
</a><a href="#h38-0-44" id="h38-0-44" class="i">+                                    default: None,
</a><a href="#h38-0-45" id="h38-0-45" class="i">+                                    unique: false,
</a><a href="#h38-0-46" id="h38-0-46" class="i">+                                    references: Some(
</a><a href="#h38-0-47" id="h38-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h38-0-48" id="h38-0-48" class="i">+                                    ),
</a><a href="#h38-0-49" id="h38-0-49" class="i">+                                    index: true,
</a><a href="#h38-0-50" id="h38-0-50" class="i">+                                },
</a><a href="#h38-0-51" id="h38-0-51" class="i">+                                Column {
</a><a href="#h38-0-52" id="h38-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h38-0-53" id="h38-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h38-0-54" id="h38-0-54" class="i">+                                    primary_key: false,
</a><a href="#h38-0-55" id="h38-0-55" class="i">+                                    nullable: false,
</a><a href="#h38-0-56" id="h38-0-56" class="i">+                                    default: None,
</a><a href="#h38-0-57" id="h38-0-57" class="i">+                                    unique: false,
</a><a href="#h38-0-58" id="h38-0-58" class="i">+                                    references: None,
</a><a href="#h38-0-59" id="h38-0-59" class="i">+                                    index: false,
</a><a href="#h38-0-60" id="h38-0-60" class="i">+                                },
</a><a href="#h38-0-61" id="h38-0-61" class="i">+                                Column {
</a><a href="#h38-0-62" id="h38-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h38-0-63" id="h38-0-63" class="i">+                                    datatype: Float,
</a><a href="#h38-0-64" id="h38-0-64" class="i">+                                    primary_key: false,
</a><a href="#h38-0-65" id="h38-0-65" class="i">+                                    nullable: true,
</a><a href="#h38-0-66" id="h38-0-66" class="i">+                                    default: Some(
</a><a href="#h38-0-67" id="h38-0-67" class="i">+                                        Null,
</a><a href="#h38-0-68" id="h38-0-68" class="i">+                                    ),
</a><a href="#h38-0-69" id="h38-0-69" class="i">+                                    unique: false,
</a><a href="#h38-0-70" id="h38-0-70" class="i">+                                    references: None,
</a><a href="#h38-0-71" id="h38-0-71" class="i">+                                    index: false,
</a><a href="#h38-0-72" id="h38-0-72" class="i">+                                },
</a><a href="#h38-0-73" id="h38-0-73" class="i">+                                Column {
</a><a href="#h38-0-74" id="h38-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h38-0-75" id="h38-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h38-0-76" id="h38-0-76" class="i">+                                    primary_key: false,
</a><a href="#h38-0-77" id="h38-0-77" class="i">+                                    nullable: true,
</a><a href="#h38-0-78" id="h38-0-78" class="i">+                                    default: Some(
</a><a href="#h38-0-79" id="h38-0-79" class="i">+                                        Null,
</a><a href="#h38-0-80" id="h38-0-80" class="i">+                                    ),
</a><a href="#h38-0-81" id="h38-0-81" class="i">+                                    unique: false,
</a><a href="#h38-0-82" id="h38-0-82" class="i">+                                    references: None,
</a><a href="#h38-0-83" id="h38-0-83" class="i">+                                    index: false,
</a><a href="#h38-0-84" id="h38-0-84" class="i">+                                },
</a><a href="#h38-0-85" id="h38-0-85" class="i">+                            ],
</a><a href="#h38-0-86" id="h38-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h38-1" id="h38-1" class="h">@@ -170,7 +252,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h38-1-3" id="h38-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h38-1-4" id="h38-1-4" class="i">+                        table: Table {
</a><a href="#h38-1-5" id="h38-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h38-1-6" id="h38-1-6" class="i">+                            columns: [
</a><a href="#h38-1-7" id="h38-1-7" class="i">+                                Column {
</a><a href="#h38-1-8" id="h38-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h38-1-9" id="h38-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h38-1-10" id="h38-1-10" class="i">+                                    primary_key: true,
</a><a href="#h38-1-11" id="h38-1-11" class="i">+                                    nullable: false,
</a><a href="#h38-1-12" id="h38-1-12" class="i">+                                    default: None,
</a><a href="#h38-1-13" id="h38-1-13" class="i">+                                    unique: true,
</a><a href="#h38-1-14" id="h38-1-14" class="i">+                                    references: None,
</a><a href="#h38-1-15" id="h38-1-15" class="i">+                                    index: false,
</a><a href="#h38-1-16" id="h38-1-16" class="i">+                                },
</a><a href="#h38-1-17" id="h38-1-17" class="i">+                                Column {
</a><a href="#h38-1-18" id="h38-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h38-1-19" id="h38-1-19" class="i">+                                    datatype: String,
</a><a href="#h38-1-20" id="h38-1-20" class="i">+                                    primary_key: false,
</a><a href="#h38-1-21" id="h38-1-21" class="i">+                                    nullable: false,
</a><a href="#h38-1-22" id="h38-1-22" class="i">+                                    default: None,
</a><a href="#h38-1-23" id="h38-1-23" class="i">+                                    unique: false,
</a><a href="#h38-1-24" id="h38-1-24" class="i">+                                    references: None,
</a><a href="#h38-1-25" id="h38-1-25" class="i">+                                    index: false,
</a><a href="#h38-1-26" id="h38-1-26" class="i">+                                },
</a><a href="#h38-1-27" id="h38-1-27" class="i">+                                Column {
</a><a href="#h38-1-28" id="h38-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h38-1-29" id="h38-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h38-1-30" id="h38-1-30" class="i">+                                    primary_key: false,
</a><a href="#h38-1-31" id="h38-1-31" class="i">+                                    nullable: false,
</a><a href="#h38-1-32" id="h38-1-32" class="i">+                                    default: None,
</a><a href="#h38-1-33" id="h38-1-33" class="i">+                                    unique: false,
</a><a href="#h38-1-34" id="h38-1-34" class="i">+                                    references: Some(
</a><a href="#h38-1-35" id="h38-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h38-1-36" id="h38-1-36" class="i">+                                    ),
</a><a href="#h38-1-37" id="h38-1-37" class="i">+                                    index: true,
</a><a href="#h38-1-38" id="h38-1-38" class="i">+                                },
</a><a href="#h38-1-39" id="h38-1-39" class="i">+                                Column {
</a><a href="#h38-1-40" id="h38-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h38-1-41" id="h38-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h38-1-42" id="h38-1-42" class="i">+                                    primary_key: false,
</a><a href="#h38-1-43" id="h38-1-43" class="i">+                                    nullable: false,
</a><a href="#h38-1-44" id="h38-1-44" class="i">+                                    default: None,
</a><a href="#h38-1-45" id="h38-1-45" class="i">+                                    unique: false,
</a><a href="#h38-1-46" id="h38-1-46" class="i">+                                    references: Some(
</a><a href="#h38-1-47" id="h38-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h38-1-48" id="h38-1-48" class="i">+                                    ),
</a><a href="#h38-1-49" id="h38-1-49" class="i">+                                    index: true,
</a><a href="#h38-1-50" id="h38-1-50" class="i">+                                },
</a><a href="#h38-1-51" id="h38-1-51" class="i">+                                Column {
</a><a href="#h38-1-52" id="h38-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h38-1-53" id="h38-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h38-1-54" id="h38-1-54" class="i">+                                    primary_key: false,
</a><a href="#h38-1-55" id="h38-1-55" class="i">+                                    nullable: false,
</a><a href="#h38-1-56" id="h38-1-56" class="i">+                                    default: None,
</a><a href="#h38-1-57" id="h38-1-57" class="i">+                                    unique: false,
</a><a href="#h38-1-58" id="h38-1-58" class="i">+                                    references: None,
</a><a href="#h38-1-59" id="h38-1-59" class="i">+                                    index: false,
</a><a href="#h38-1-60" id="h38-1-60" class="i">+                                },
</a><a href="#h38-1-61" id="h38-1-61" class="i">+                                Column {
</a><a href="#h38-1-62" id="h38-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h38-1-63" id="h38-1-63" class="i">+                                    datatype: Float,
</a><a href="#h38-1-64" id="h38-1-64" class="i">+                                    primary_key: false,
</a><a href="#h38-1-65" id="h38-1-65" class="i">+                                    nullable: true,
</a><a href="#h38-1-66" id="h38-1-66" class="i">+                                    default: Some(
</a><a href="#h38-1-67" id="h38-1-67" class="i">+                                        Null,
</a><a href="#h38-1-68" id="h38-1-68" class="i">+                                    ),
</a><a href="#h38-1-69" id="h38-1-69" class="i">+                                    unique: false,
</a><a href="#h38-1-70" id="h38-1-70" class="i">+                                    references: None,
</a><a href="#h38-1-71" id="h38-1-71" class="i">+                                    index: false,
</a><a href="#h38-1-72" id="h38-1-72" class="i">+                                },
</a><a href="#h38-1-73" id="h38-1-73" class="i">+                                Column {
</a><a href="#h38-1-74" id="h38-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h38-1-75" id="h38-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h38-1-76" id="h38-1-76" class="i">+                                    primary_key: false,
</a><a href="#h38-1-77" id="h38-1-77" class="i">+                                    nullable: true,
</a><a href="#h38-1-78" id="h38-1-78" class="i">+                                    default: Some(
</a><a href="#h38-1-79" id="h38-1-79" class="i">+                                        Null,
</a><a href="#h38-1-80" id="h38-1-80" class="i">+                                    ),
</a><a href="#h38-1-81" id="h38-1-81" class="i">+                                    unique: false,
</a><a href="#h38-1-82" id="h38-1-82" class="i">+                                    references: None,
</a><a href="#h38-1-83" id="h38-1-83" class="i">+                                    index: false,
</a><a href="#h38-1-84" id="h38-1-84" class="i">+                                },
</a><a href="#h38-1-85" id="h38-1-85" class="i">+                            ],
</a><a href="#h38-1-86" id="h38-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h39" href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a> b/<a href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -88,7 +88,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h39-0-3" id="h39-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h39-0-4" id="h39-0-4" class="i">+                        table: Table {
</a><a href="#h39-0-5" id="h39-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h39-0-6" id="h39-0-6" class="i">+                            columns: [
</a><a href="#h39-0-7" id="h39-0-7" class="i">+                                Column {
</a><a href="#h39-0-8" id="h39-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h39-0-9" id="h39-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h39-0-10" id="h39-0-10" class="i">+                                    primary_key: true,
</a><a href="#h39-0-11" id="h39-0-11" class="i">+                                    nullable: false,
</a><a href="#h39-0-12" id="h39-0-12" class="i">+                                    default: None,
</a><a href="#h39-0-13" id="h39-0-13" class="i">+                                    unique: true,
</a><a href="#h39-0-14" id="h39-0-14" class="i">+                                    references: None,
</a><a href="#h39-0-15" id="h39-0-15" class="i">+                                    index: false,
</a><a href="#h39-0-16" id="h39-0-16" class="i">+                                },
</a><a href="#h39-0-17" id="h39-0-17" class="i">+                                Column {
</a><a href="#h39-0-18" id="h39-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h39-0-19" id="h39-0-19" class="i">+                                    datatype: String,
</a><a href="#h39-0-20" id="h39-0-20" class="i">+                                    primary_key: false,
</a><a href="#h39-0-21" id="h39-0-21" class="i">+                                    nullable: false,
</a><a href="#h39-0-22" id="h39-0-22" class="i">+                                    default: None,
</a><a href="#h39-0-23" id="h39-0-23" class="i">+                                    unique: false,
</a><a href="#h39-0-24" id="h39-0-24" class="i">+                                    references: None,
</a><a href="#h39-0-25" id="h39-0-25" class="i">+                                    index: false,
</a><a href="#h39-0-26" id="h39-0-26" class="i">+                                },
</a><a href="#h39-0-27" id="h39-0-27" class="i">+                                Column {
</a><a href="#h39-0-28" id="h39-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h39-0-29" id="h39-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h39-0-30" id="h39-0-30" class="i">+                                    primary_key: false,
</a><a href="#h39-0-31" id="h39-0-31" class="i">+                                    nullable: false,
</a><a href="#h39-0-32" id="h39-0-32" class="i">+                                    default: None,
</a><a href="#h39-0-33" id="h39-0-33" class="i">+                                    unique: false,
</a><a href="#h39-0-34" id="h39-0-34" class="i">+                                    references: Some(
</a><a href="#h39-0-35" id="h39-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h39-0-36" id="h39-0-36" class="i">+                                    ),
</a><a href="#h39-0-37" id="h39-0-37" class="i">+                                    index: true,
</a><a href="#h39-0-38" id="h39-0-38" class="i">+                                },
</a><a href="#h39-0-39" id="h39-0-39" class="i">+                                Column {
</a><a href="#h39-0-40" id="h39-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h39-0-41" id="h39-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h39-0-42" id="h39-0-42" class="i">+                                    primary_key: false,
</a><a href="#h39-0-43" id="h39-0-43" class="i">+                                    nullable: false,
</a><a href="#h39-0-44" id="h39-0-44" class="i">+                                    default: None,
</a><a href="#h39-0-45" id="h39-0-45" class="i">+                                    unique: false,
</a><a href="#h39-0-46" id="h39-0-46" class="i">+                                    references: Some(
</a><a href="#h39-0-47" id="h39-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h39-0-48" id="h39-0-48" class="i">+                                    ),
</a><a href="#h39-0-49" id="h39-0-49" class="i">+                                    index: true,
</a><a href="#h39-0-50" id="h39-0-50" class="i">+                                },
</a><a href="#h39-0-51" id="h39-0-51" class="i">+                                Column {
</a><a href="#h39-0-52" id="h39-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h39-0-53" id="h39-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h39-0-54" id="h39-0-54" class="i">+                                    primary_key: false,
</a><a href="#h39-0-55" id="h39-0-55" class="i">+                                    nullable: false,
</a><a href="#h39-0-56" id="h39-0-56" class="i">+                                    default: None,
</a><a href="#h39-0-57" id="h39-0-57" class="i">+                                    unique: false,
</a><a href="#h39-0-58" id="h39-0-58" class="i">+                                    references: None,
</a><a href="#h39-0-59" id="h39-0-59" class="i">+                                    index: false,
</a><a href="#h39-0-60" id="h39-0-60" class="i">+                                },
</a><a href="#h39-0-61" id="h39-0-61" class="i">+                                Column {
</a><a href="#h39-0-62" id="h39-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h39-0-63" id="h39-0-63" class="i">+                                    datatype: Float,
</a><a href="#h39-0-64" id="h39-0-64" class="i">+                                    primary_key: false,
</a><a href="#h39-0-65" id="h39-0-65" class="i">+                                    nullable: true,
</a><a href="#h39-0-66" id="h39-0-66" class="i">+                                    default: Some(
</a><a href="#h39-0-67" id="h39-0-67" class="i">+                                        Null,
</a><a href="#h39-0-68" id="h39-0-68" class="i">+                                    ),
</a><a href="#h39-0-69" id="h39-0-69" class="i">+                                    unique: false,
</a><a href="#h39-0-70" id="h39-0-70" class="i">+                                    references: None,
</a><a href="#h39-0-71" id="h39-0-71" class="i">+                                    index: false,
</a><a href="#h39-0-72" id="h39-0-72" class="i">+                                },
</a><a href="#h39-0-73" id="h39-0-73" class="i">+                                Column {
</a><a href="#h39-0-74" id="h39-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h39-0-75" id="h39-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h39-0-76" id="h39-0-76" class="i">+                                    primary_key: false,
</a><a href="#h39-0-77" id="h39-0-77" class="i">+                                    nullable: true,
</a><a href="#h39-0-78" id="h39-0-78" class="i">+                                    default: Some(
</a><a href="#h39-0-79" id="h39-0-79" class="i">+                                        Null,
</a><a href="#h39-0-80" id="h39-0-80" class="i">+                                    ),
</a><a href="#h39-0-81" id="h39-0-81" class="i">+                                    unique: false,
</a><a href="#h39-0-82" id="h39-0-82" class="i">+                                    references: None,
</a><a href="#h39-0-83" id="h39-0-83" class="i">+                                    index: false,
</a><a href="#h39-0-84" id="h39-0-84" class="i">+                                },
</a><a href="#h39-0-85" id="h39-0-85" class="i">+                            ],
</a><a href="#h39-0-86" id="h39-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h39-1" id="h39-1" class="h">@@ -172,7 +254,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h39-1-3" id="h39-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h39-1-4" id="h39-1-4" class="i">+                        table: Table {
</a><a href="#h39-1-5" id="h39-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h39-1-6" id="h39-1-6" class="i">+                            columns: [
</a><a href="#h39-1-7" id="h39-1-7" class="i">+                                Column {
</a><a href="#h39-1-8" id="h39-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h39-1-9" id="h39-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h39-1-10" id="h39-1-10" class="i">+                                    primary_key: true,
</a><a href="#h39-1-11" id="h39-1-11" class="i">+                                    nullable: false,
</a><a href="#h39-1-12" id="h39-1-12" class="i">+                                    default: None,
</a><a href="#h39-1-13" id="h39-1-13" class="i">+                                    unique: true,
</a><a href="#h39-1-14" id="h39-1-14" class="i">+                                    references: None,
</a><a href="#h39-1-15" id="h39-1-15" class="i">+                                    index: false,
</a><a href="#h39-1-16" id="h39-1-16" class="i">+                                },
</a><a href="#h39-1-17" id="h39-1-17" class="i">+                                Column {
</a><a href="#h39-1-18" id="h39-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h39-1-19" id="h39-1-19" class="i">+                                    datatype: String,
</a><a href="#h39-1-20" id="h39-1-20" class="i">+                                    primary_key: false,
</a><a href="#h39-1-21" id="h39-1-21" class="i">+                                    nullable: false,
</a><a href="#h39-1-22" id="h39-1-22" class="i">+                                    default: None,
</a><a href="#h39-1-23" id="h39-1-23" class="i">+                                    unique: false,
</a><a href="#h39-1-24" id="h39-1-24" class="i">+                                    references: None,
</a><a href="#h39-1-25" id="h39-1-25" class="i">+                                    index: false,
</a><a href="#h39-1-26" id="h39-1-26" class="i">+                                },
</a><a href="#h39-1-27" id="h39-1-27" class="i">+                                Column {
</a><a href="#h39-1-28" id="h39-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h39-1-29" id="h39-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h39-1-30" id="h39-1-30" class="i">+                                    primary_key: false,
</a><a href="#h39-1-31" id="h39-1-31" class="i">+                                    nullable: false,
</a><a href="#h39-1-32" id="h39-1-32" class="i">+                                    default: None,
</a><a href="#h39-1-33" id="h39-1-33" class="i">+                                    unique: false,
</a><a href="#h39-1-34" id="h39-1-34" class="i">+                                    references: Some(
</a><a href="#h39-1-35" id="h39-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h39-1-36" id="h39-1-36" class="i">+                                    ),
</a><a href="#h39-1-37" id="h39-1-37" class="i">+                                    index: true,
</a><a href="#h39-1-38" id="h39-1-38" class="i">+                                },
</a><a href="#h39-1-39" id="h39-1-39" class="i">+                                Column {
</a><a href="#h39-1-40" id="h39-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h39-1-41" id="h39-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h39-1-42" id="h39-1-42" class="i">+                                    primary_key: false,
</a><a href="#h39-1-43" id="h39-1-43" class="i">+                                    nullable: false,
</a><a href="#h39-1-44" id="h39-1-44" class="i">+                                    default: None,
</a><a href="#h39-1-45" id="h39-1-45" class="i">+                                    unique: false,
</a><a href="#h39-1-46" id="h39-1-46" class="i">+                                    references: Some(
</a><a href="#h39-1-47" id="h39-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h39-1-48" id="h39-1-48" class="i">+                                    ),
</a><a href="#h39-1-49" id="h39-1-49" class="i">+                                    index: true,
</a><a href="#h39-1-50" id="h39-1-50" class="i">+                                },
</a><a href="#h39-1-51" id="h39-1-51" class="i">+                                Column {
</a><a href="#h39-1-52" id="h39-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h39-1-53" id="h39-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h39-1-54" id="h39-1-54" class="i">+                                    primary_key: false,
</a><a href="#h39-1-55" id="h39-1-55" class="i">+                                    nullable: false,
</a><a href="#h39-1-56" id="h39-1-56" class="i">+                                    default: None,
</a><a href="#h39-1-57" id="h39-1-57" class="i">+                                    unique: false,
</a><a href="#h39-1-58" id="h39-1-58" class="i">+                                    references: None,
</a><a href="#h39-1-59" id="h39-1-59" class="i">+                                    index: false,
</a><a href="#h39-1-60" id="h39-1-60" class="i">+                                },
</a><a href="#h39-1-61" id="h39-1-61" class="i">+                                Column {
</a><a href="#h39-1-62" id="h39-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h39-1-63" id="h39-1-63" class="i">+                                    datatype: Float,
</a><a href="#h39-1-64" id="h39-1-64" class="i">+                                    primary_key: false,
</a><a href="#h39-1-65" id="h39-1-65" class="i">+                                    nullable: true,
</a><a href="#h39-1-66" id="h39-1-66" class="i">+                                    default: Some(
</a><a href="#h39-1-67" id="h39-1-67" class="i">+                                        Null,
</a><a href="#h39-1-68" id="h39-1-68" class="i">+                                    ),
</a><a href="#h39-1-69" id="h39-1-69" class="i">+                                    unique: false,
</a><a href="#h39-1-70" id="h39-1-70" class="i">+                                    references: None,
</a><a href="#h39-1-71" id="h39-1-71" class="i">+                                    index: false,
</a><a href="#h39-1-72" id="h39-1-72" class="i">+                                },
</a><a href="#h39-1-73" id="h39-1-73" class="i">+                                Column {
</a><a href="#h39-1-74" id="h39-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h39-1-75" id="h39-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h39-1-76" id="h39-1-76" class="i">+                                    primary_key: false,
</a><a href="#h39-1-77" id="h39-1-77" class="i">+                                    nullable: true,
</a><a href="#h39-1-78" id="h39-1-78" class="i">+                                    default: Some(
</a><a href="#h39-1-79" id="h39-1-79" class="i">+                                        Null,
</a><a href="#h39-1-80" id="h39-1-80" class="i">+                                    ),
</a><a href="#h39-1-81" id="h39-1-81" class="i">+                                    unique: false,
</a><a href="#h39-1-82" id="h39-1-82" class="i">+                                    references: None,
</a><a href="#h39-1-83" id="h39-1-83" class="i">+                                    index: false,
</a><a href="#h39-1-84" id="h39-1-84" class="i">+                                },
</a><a href="#h39-1-85" id="h39-1-85" class="i">+                            ],
</a><a href="#h39-1-86" id="h39-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h40" href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a> b/<a href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -94,7 +94,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h40-0-3" id="h40-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h40-0-4" id="h40-0-4" class="i">+                        table: Table {
</a><a href="#h40-0-5" id="h40-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h40-0-6" id="h40-0-6" class="i">+                            columns: [
</a><a href="#h40-0-7" id="h40-0-7" class="i">+                                Column {
</a><a href="#h40-0-8" id="h40-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h40-0-9" id="h40-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h40-0-10" id="h40-0-10" class="i">+                                    primary_key: true,
</a><a href="#h40-0-11" id="h40-0-11" class="i">+                                    nullable: false,
</a><a href="#h40-0-12" id="h40-0-12" class="i">+                                    default: None,
</a><a href="#h40-0-13" id="h40-0-13" class="i">+                                    unique: true,
</a><a href="#h40-0-14" id="h40-0-14" class="i">+                                    references: None,
</a><a href="#h40-0-15" id="h40-0-15" class="i">+                                    index: false,
</a><a href="#h40-0-16" id="h40-0-16" class="i">+                                },
</a><a href="#h40-0-17" id="h40-0-17" class="i">+                                Column {
</a><a href="#h40-0-18" id="h40-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h40-0-19" id="h40-0-19" class="i">+                                    datatype: String,
</a><a href="#h40-0-20" id="h40-0-20" class="i">+                                    primary_key: false,
</a><a href="#h40-0-21" id="h40-0-21" class="i">+                                    nullable: false,
</a><a href="#h40-0-22" id="h40-0-22" class="i">+                                    default: None,
</a><a href="#h40-0-23" id="h40-0-23" class="i">+                                    unique: false,
</a><a href="#h40-0-24" id="h40-0-24" class="i">+                                    references: None,
</a><a href="#h40-0-25" id="h40-0-25" class="i">+                                    index: false,
</a><a href="#h40-0-26" id="h40-0-26" class="i">+                                },
</a><a href="#h40-0-27" id="h40-0-27" class="i">+                                Column {
</a><a href="#h40-0-28" id="h40-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h40-0-29" id="h40-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h40-0-30" id="h40-0-30" class="i">+                                    primary_key: false,
</a><a href="#h40-0-31" id="h40-0-31" class="i">+                                    nullable: false,
</a><a href="#h40-0-32" id="h40-0-32" class="i">+                                    default: None,
</a><a href="#h40-0-33" id="h40-0-33" class="i">+                                    unique: false,
</a><a href="#h40-0-34" id="h40-0-34" class="i">+                                    references: Some(
</a><a href="#h40-0-35" id="h40-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h40-0-36" id="h40-0-36" class="i">+                                    ),
</a><a href="#h40-0-37" id="h40-0-37" class="i">+                                    index: true,
</a><a href="#h40-0-38" id="h40-0-38" class="i">+                                },
</a><a href="#h40-0-39" id="h40-0-39" class="i">+                                Column {
</a><a href="#h40-0-40" id="h40-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h40-0-41" id="h40-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h40-0-42" id="h40-0-42" class="i">+                                    primary_key: false,
</a><a href="#h40-0-43" id="h40-0-43" class="i">+                                    nullable: false,
</a><a href="#h40-0-44" id="h40-0-44" class="i">+                                    default: None,
</a><a href="#h40-0-45" id="h40-0-45" class="i">+                                    unique: false,
</a><a href="#h40-0-46" id="h40-0-46" class="i">+                                    references: Some(
</a><a href="#h40-0-47" id="h40-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h40-0-48" id="h40-0-48" class="i">+                                    ),
</a><a href="#h40-0-49" id="h40-0-49" class="i">+                                    index: true,
</a><a href="#h40-0-50" id="h40-0-50" class="i">+                                },
</a><a href="#h40-0-51" id="h40-0-51" class="i">+                                Column {
</a><a href="#h40-0-52" id="h40-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h40-0-53" id="h40-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h40-0-54" id="h40-0-54" class="i">+                                    primary_key: false,
</a><a href="#h40-0-55" id="h40-0-55" class="i">+                                    nullable: false,
</a><a href="#h40-0-56" id="h40-0-56" class="i">+                                    default: None,
</a><a href="#h40-0-57" id="h40-0-57" class="i">+                                    unique: false,
</a><a href="#h40-0-58" id="h40-0-58" class="i">+                                    references: None,
</a><a href="#h40-0-59" id="h40-0-59" class="i">+                                    index: false,
</a><a href="#h40-0-60" id="h40-0-60" class="i">+                                },
</a><a href="#h40-0-61" id="h40-0-61" class="i">+                                Column {
</a><a href="#h40-0-62" id="h40-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h40-0-63" id="h40-0-63" class="i">+                                    datatype: Float,
</a><a href="#h40-0-64" id="h40-0-64" class="i">+                                    primary_key: false,
</a><a href="#h40-0-65" id="h40-0-65" class="i">+                                    nullable: true,
</a><a href="#h40-0-66" id="h40-0-66" class="i">+                                    default: Some(
</a><a href="#h40-0-67" id="h40-0-67" class="i">+                                        Null,
</a><a href="#h40-0-68" id="h40-0-68" class="i">+                                    ),
</a><a href="#h40-0-69" id="h40-0-69" class="i">+                                    unique: false,
</a><a href="#h40-0-70" id="h40-0-70" class="i">+                                    references: None,
</a><a href="#h40-0-71" id="h40-0-71" class="i">+                                    index: false,
</a><a href="#h40-0-72" id="h40-0-72" class="i">+                                },
</a><a href="#h40-0-73" id="h40-0-73" class="i">+                                Column {
</a><a href="#h40-0-74" id="h40-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h40-0-75" id="h40-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h40-0-76" id="h40-0-76" class="i">+                                    primary_key: false,
</a><a href="#h40-0-77" id="h40-0-77" class="i">+                                    nullable: true,
</a><a href="#h40-0-78" id="h40-0-78" class="i">+                                    default: Some(
</a><a href="#h40-0-79" id="h40-0-79" class="i">+                                        Null,
</a><a href="#h40-0-80" id="h40-0-80" class="i">+                                    ),
</a><a href="#h40-0-81" id="h40-0-81" class="i">+                                    unique: false,
</a><a href="#h40-0-82" id="h40-0-82" class="i">+                                    references: None,
</a><a href="#h40-0-83" id="h40-0-83" class="i">+                                    index: false,
</a><a href="#h40-0-84" id="h40-0-84" class="i">+                                },
</a><a href="#h40-0-85" id="h40-0-85" class="i">+                            ],
</a><a href="#h40-0-86" id="h40-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h40-1" id="h40-1" class="h">@@ -213,7 +295,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h40-1-3" id="h40-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h40-1-4" id="h40-1-4" class="i">+                        table: Table {
</a><a href="#h40-1-5" id="h40-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h40-1-6" id="h40-1-6" class="i">+                            columns: [
</a><a href="#h40-1-7" id="h40-1-7" class="i">+                                Column {
</a><a href="#h40-1-8" id="h40-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h40-1-9" id="h40-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h40-1-10" id="h40-1-10" class="i">+                                    primary_key: true,
</a><a href="#h40-1-11" id="h40-1-11" class="i">+                                    nullable: false,
</a><a href="#h40-1-12" id="h40-1-12" class="i">+                                    default: None,
</a><a href="#h40-1-13" id="h40-1-13" class="i">+                                    unique: true,
</a><a href="#h40-1-14" id="h40-1-14" class="i">+                                    references: None,
</a><a href="#h40-1-15" id="h40-1-15" class="i">+                                    index: false,
</a><a href="#h40-1-16" id="h40-1-16" class="i">+                                },
</a><a href="#h40-1-17" id="h40-1-17" class="i">+                                Column {
</a><a href="#h40-1-18" id="h40-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h40-1-19" id="h40-1-19" class="i">+                                    datatype: String,
</a><a href="#h40-1-20" id="h40-1-20" class="i">+                                    primary_key: false,
</a><a href="#h40-1-21" id="h40-1-21" class="i">+                                    nullable: false,
</a><a href="#h40-1-22" id="h40-1-22" class="i">+                                    default: None,
</a><a href="#h40-1-23" id="h40-1-23" class="i">+                                    unique: false,
</a><a href="#h40-1-24" id="h40-1-24" class="i">+                                    references: None,
</a><a href="#h40-1-25" id="h40-1-25" class="i">+                                    index: false,
</a><a href="#h40-1-26" id="h40-1-26" class="i">+                                },
</a><a href="#h40-1-27" id="h40-1-27" class="i">+                                Column {
</a><a href="#h40-1-28" id="h40-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h40-1-29" id="h40-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h40-1-30" id="h40-1-30" class="i">+                                    primary_key: false,
</a><a href="#h40-1-31" id="h40-1-31" class="i">+                                    nullable: false,
</a><a href="#h40-1-32" id="h40-1-32" class="i">+                                    default: None,
</a><a href="#h40-1-33" id="h40-1-33" class="i">+                                    unique: false,
</a><a href="#h40-1-34" id="h40-1-34" class="i">+                                    references: Some(
</a><a href="#h40-1-35" id="h40-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h40-1-36" id="h40-1-36" class="i">+                                    ),
</a><a href="#h40-1-37" id="h40-1-37" class="i">+                                    index: true,
</a><a href="#h40-1-38" id="h40-1-38" class="i">+                                },
</a><a href="#h40-1-39" id="h40-1-39" class="i">+                                Column {
</a><a href="#h40-1-40" id="h40-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h40-1-41" id="h40-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h40-1-42" id="h40-1-42" class="i">+                                    primary_key: false,
</a><a href="#h40-1-43" id="h40-1-43" class="i">+                                    nullable: false,
</a><a href="#h40-1-44" id="h40-1-44" class="i">+                                    default: None,
</a><a href="#h40-1-45" id="h40-1-45" class="i">+                                    unique: false,
</a><a href="#h40-1-46" id="h40-1-46" class="i">+                                    references: Some(
</a><a href="#h40-1-47" id="h40-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h40-1-48" id="h40-1-48" class="i">+                                    ),
</a><a href="#h40-1-49" id="h40-1-49" class="i">+                                    index: true,
</a><a href="#h40-1-50" id="h40-1-50" class="i">+                                },
</a><a href="#h40-1-51" id="h40-1-51" class="i">+                                Column {
</a><a href="#h40-1-52" id="h40-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h40-1-53" id="h40-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h40-1-54" id="h40-1-54" class="i">+                                    primary_key: false,
</a><a href="#h40-1-55" id="h40-1-55" class="i">+                                    nullable: false,
</a><a href="#h40-1-56" id="h40-1-56" class="i">+                                    default: None,
</a><a href="#h40-1-57" id="h40-1-57" class="i">+                                    unique: false,
</a><a href="#h40-1-58" id="h40-1-58" class="i">+                                    references: None,
</a><a href="#h40-1-59" id="h40-1-59" class="i">+                                    index: false,
</a><a href="#h40-1-60" id="h40-1-60" class="i">+                                },
</a><a href="#h40-1-61" id="h40-1-61" class="i">+                                Column {
</a><a href="#h40-1-62" id="h40-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h40-1-63" id="h40-1-63" class="i">+                                    datatype: Float,
</a><a href="#h40-1-64" id="h40-1-64" class="i">+                                    primary_key: false,
</a><a href="#h40-1-65" id="h40-1-65" class="i">+                                    nullable: true,
</a><a href="#h40-1-66" id="h40-1-66" class="i">+                                    default: Some(
</a><a href="#h40-1-67" id="h40-1-67" class="i">+                                        Null,
</a><a href="#h40-1-68" id="h40-1-68" class="i">+                                    ),
</a><a href="#h40-1-69" id="h40-1-69" class="i">+                                    unique: false,
</a><a href="#h40-1-70" id="h40-1-70" class="i">+                                    references: None,
</a><a href="#h40-1-71" id="h40-1-71" class="i">+                                    index: false,
</a><a href="#h40-1-72" id="h40-1-72" class="i">+                                },
</a><a href="#h40-1-73" id="h40-1-73" class="i">+                                Column {
</a><a href="#h40-1-74" id="h40-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h40-1-75" id="h40-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h40-1-76" id="h40-1-76" class="i">+                                    primary_key: false,
</a><a href="#h40-1-77" id="h40-1-77" class="i">+                                    nullable: true,
</a><a href="#h40-1-78" id="h40-1-78" class="i">+                                    default: Some(
</a><a href="#h40-1-79" id="h40-1-79" class="i">+                                        Null,
</a><a href="#h40-1-80" id="h40-1-80" class="i">+                                    ),
</a><a href="#h40-1-81" id="h40-1-81" class="i">+                                    unique: false,
</a><a href="#h40-1-82" id="h40-1-82" class="i">+                                    references: None,
</a><a href="#h40-1-83" id="h40-1-83" class="i">+                                    index: false,
</a><a href="#h40-1-84" id="h40-1-84" class="i">+                                },
</a><a href="#h40-1-85" id="h40-1-85" class="i">+                            ],
</a><a href="#h40-1-86" id="h40-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h41" href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a> b/<a href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -79,7 +79,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h41-0-3" id="h41-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h41-0-4" id="h41-0-4" class="i">+                        table: Table {
</a><a href="#h41-0-5" id="h41-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h41-0-6" id="h41-0-6" class="i">+                            columns: [
</a><a href="#h41-0-7" id="h41-0-7" class="i">+                                Column {
</a><a href="#h41-0-8" id="h41-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h41-0-9" id="h41-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h41-0-10" id="h41-0-10" class="i">+                                    primary_key: true,
</a><a href="#h41-0-11" id="h41-0-11" class="i">+                                    nullable: false,
</a><a href="#h41-0-12" id="h41-0-12" class="i">+                                    default: None,
</a><a href="#h41-0-13" id="h41-0-13" class="i">+                                    unique: true,
</a><a href="#h41-0-14" id="h41-0-14" class="i">+                                    references: None,
</a><a href="#h41-0-15" id="h41-0-15" class="i">+                                    index: false,
</a><a href="#h41-0-16" id="h41-0-16" class="i">+                                },
</a><a href="#h41-0-17" id="h41-0-17" class="i">+                                Column {
</a><a href="#h41-0-18" id="h41-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h41-0-19" id="h41-0-19" class="i">+                                    datatype: String,
</a><a href="#h41-0-20" id="h41-0-20" class="i">+                                    primary_key: false,
</a><a href="#h41-0-21" id="h41-0-21" class="i">+                                    nullable: false,
</a><a href="#h41-0-22" id="h41-0-22" class="i">+                                    default: None,
</a><a href="#h41-0-23" id="h41-0-23" class="i">+                                    unique: false,
</a><a href="#h41-0-24" id="h41-0-24" class="i">+                                    references: None,
</a><a href="#h41-0-25" id="h41-0-25" class="i">+                                    index: false,
</a><a href="#h41-0-26" id="h41-0-26" class="i">+                                },
</a><a href="#h41-0-27" id="h41-0-27" class="i">+                                Column {
</a><a href="#h41-0-28" id="h41-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h41-0-29" id="h41-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h41-0-30" id="h41-0-30" class="i">+                                    primary_key: false,
</a><a href="#h41-0-31" id="h41-0-31" class="i">+                                    nullable: false,
</a><a href="#h41-0-32" id="h41-0-32" class="i">+                                    default: None,
</a><a href="#h41-0-33" id="h41-0-33" class="i">+                                    unique: false,
</a><a href="#h41-0-34" id="h41-0-34" class="i">+                                    references: Some(
</a><a href="#h41-0-35" id="h41-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h41-0-36" id="h41-0-36" class="i">+                                    ),
</a><a href="#h41-0-37" id="h41-0-37" class="i">+                                    index: true,
</a><a href="#h41-0-38" id="h41-0-38" class="i">+                                },
</a><a href="#h41-0-39" id="h41-0-39" class="i">+                                Column {
</a><a href="#h41-0-40" id="h41-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h41-0-41" id="h41-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h41-0-42" id="h41-0-42" class="i">+                                    primary_key: false,
</a><a href="#h41-0-43" id="h41-0-43" class="i">+                                    nullable: false,
</a><a href="#h41-0-44" id="h41-0-44" class="i">+                                    default: None,
</a><a href="#h41-0-45" id="h41-0-45" class="i">+                                    unique: false,
</a><a href="#h41-0-46" id="h41-0-46" class="i">+                                    references: Some(
</a><a href="#h41-0-47" id="h41-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h41-0-48" id="h41-0-48" class="i">+                                    ),
</a><a href="#h41-0-49" id="h41-0-49" class="i">+                                    index: true,
</a><a href="#h41-0-50" id="h41-0-50" class="i">+                                },
</a><a href="#h41-0-51" id="h41-0-51" class="i">+                                Column {
</a><a href="#h41-0-52" id="h41-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h41-0-53" id="h41-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h41-0-54" id="h41-0-54" class="i">+                                    primary_key: false,
</a><a href="#h41-0-55" id="h41-0-55" class="i">+                                    nullable: false,
</a><a href="#h41-0-56" id="h41-0-56" class="i">+                                    default: None,
</a><a href="#h41-0-57" id="h41-0-57" class="i">+                                    unique: false,
</a><a href="#h41-0-58" id="h41-0-58" class="i">+                                    references: None,
</a><a href="#h41-0-59" id="h41-0-59" class="i">+                                    index: false,
</a><a href="#h41-0-60" id="h41-0-60" class="i">+                                },
</a><a href="#h41-0-61" id="h41-0-61" class="i">+                                Column {
</a><a href="#h41-0-62" id="h41-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h41-0-63" id="h41-0-63" class="i">+                                    datatype: Float,
</a><a href="#h41-0-64" id="h41-0-64" class="i">+                                    primary_key: false,
</a><a href="#h41-0-65" id="h41-0-65" class="i">+                                    nullable: true,
</a><a href="#h41-0-66" id="h41-0-66" class="i">+                                    default: Some(
</a><a href="#h41-0-67" id="h41-0-67" class="i">+                                        Null,
</a><a href="#h41-0-68" id="h41-0-68" class="i">+                                    ),
</a><a href="#h41-0-69" id="h41-0-69" class="i">+                                    unique: false,
</a><a href="#h41-0-70" id="h41-0-70" class="i">+                                    references: None,
</a><a href="#h41-0-71" id="h41-0-71" class="i">+                                    index: false,
</a><a href="#h41-0-72" id="h41-0-72" class="i">+                                },
</a><a href="#h41-0-73" id="h41-0-73" class="i">+                                Column {
</a><a href="#h41-0-74" id="h41-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h41-0-75" id="h41-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h41-0-76" id="h41-0-76" class="i">+                                    primary_key: false,
</a><a href="#h41-0-77" id="h41-0-77" class="i">+                                    nullable: true,
</a><a href="#h41-0-78" id="h41-0-78" class="i">+                                    default: Some(
</a><a href="#h41-0-79" id="h41-0-79" class="i">+                                        Null,
</a><a href="#h41-0-80" id="h41-0-80" class="i">+                                    ),
</a><a href="#h41-0-81" id="h41-0-81" class="i">+                                    unique: false,
</a><a href="#h41-0-82" id="h41-0-82" class="i">+                                    references: None,
</a><a href="#h41-0-83" id="h41-0-83" class="i">+                                    index: false,
</a><a href="#h41-0-84" id="h41-0-84" class="i">+                                },
</a><a href="#h41-0-85" id="h41-0-85" class="i">+                            ],
</a><a href="#h41-0-86" id="h41-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h41-1" id="h41-1" class="h">@@ -168,7 +250,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h41-1-3" id="h41-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h41-1-4" id="h41-1-4" class="i">+                        table: Table {
</a><a href="#h41-1-5" id="h41-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h41-1-6" id="h41-1-6" class="i">+                            columns: [
</a><a href="#h41-1-7" id="h41-1-7" class="i">+                                Column {
</a><a href="#h41-1-8" id="h41-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h41-1-9" id="h41-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h41-1-10" id="h41-1-10" class="i">+                                    primary_key: true,
</a><a href="#h41-1-11" id="h41-1-11" class="i">+                                    nullable: false,
</a><a href="#h41-1-12" id="h41-1-12" class="i">+                                    default: None,
</a><a href="#h41-1-13" id="h41-1-13" class="i">+                                    unique: true,
</a><a href="#h41-1-14" id="h41-1-14" class="i">+                                    references: None,
</a><a href="#h41-1-15" id="h41-1-15" class="i">+                                    index: false,
</a><a href="#h41-1-16" id="h41-1-16" class="i">+                                },
</a><a href="#h41-1-17" id="h41-1-17" class="i">+                                Column {
</a><a href="#h41-1-18" id="h41-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h41-1-19" id="h41-1-19" class="i">+                                    datatype: String,
</a><a href="#h41-1-20" id="h41-1-20" class="i">+                                    primary_key: false,
</a><a href="#h41-1-21" id="h41-1-21" class="i">+                                    nullable: false,
</a><a href="#h41-1-22" id="h41-1-22" class="i">+                                    default: None,
</a><a href="#h41-1-23" id="h41-1-23" class="i">+                                    unique: false,
</a><a href="#h41-1-24" id="h41-1-24" class="i">+                                    references: None,
</a><a href="#h41-1-25" id="h41-1-25" class="i">+                                    index: false,
</a><a href="#h41-1-26" id="h41-1-26" class="i">+                                },
</a><a href="#h41-1-27" id="h41-1-27" class="i">+                                Column {
</a><a href="#h41-1-28" id="h41-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h41-1-29" id="h41-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h41-1-30" id="h41-1-30" class="i">+                                    primary_key: false,
</a><a href="#h41-1-31" id="h41-1-31" class="i">+                                    nullable: false,
</a><a href="#h41-1-32" id="h41-1-32" class="i">+                                    default: None,
</a><a href="#h41-1-33" id="h41-1-33" class="i">+                                    unique: false,
</a><a href="#h41-1-34" id="h41-1-34" class="i">+                                    references: Some(
</a><a href="#h41-1-35" id="h41-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h41-1-36" id="h41-1-36" class="i">+                                    ),
</a><a href="#h41-1-37" id="h41-1-37" class="i">+                                    index: true,
</a><a href="#h41-1-38" id="h41-1-38" class="i">+                                },
</a><a href="#h41-1-39" id="h41-1-39" class="i">+                                Column {
</a><a href="#h41-1-40" id="h41-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h41-1-41" id="h41-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h41-1-42" id="h41-1-42" class="i">+                                    primary_key: false,
</a><a href="#h41-1-43" id="h41-1-43" class="i">+                                    nullable: false,
</a><a href="#h41-1-44" id="h41-1-44" class="i">+                                    default: None,
</a><a href="#h41-1-45" id="h41-1-45" class="i">+                                    unique: false,
</a><a href="#h41-1-46" id="h41-1-46" class="i">+                                    references: Some(
</a><a href="#h41-1-47" id="h41-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h41-1-48" id="h41-1-48" class="i">+                                    ),
</a><a href="#h41-1-49" id="h41-1-49" class="i">+                                    index: true,
</a><a href="#h41-1-50" id="h41-1-50" class="i">+                                },
</a><a href="#h41-1-51" id="h41-1-51" class="i">+                                Column {
</a><a href="#h41-1-52" id="h41-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h41-1-53" id="h41-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h41-1-54" id="h41-1-54" class="i">+                                    primary_key: false,
</a><a href="#h41-1-55" id="h41-1-55" class="i">+                                    nullable: false,
</a><a href="#h41-1-56" id="h41-1-56" class="i">+                                    default: None,
</a><a href="#h41-1-57" id="h41-1-57" class="i">+                                    unique: false,
</a><a href="#h41-1-58" id="h41-1-58" class="i">+                                    references: None,
</a><a href="#h41-1-59" id="h41-1-59" class="i">+                                    index: false,
</a><a href="#h41-1-60" id="h41-1-60" class="i">+                                },
</a><a href="#h41-1-61" id="h41-1-61" class="i">+                                Column {
</a><a href="#h41-1-62" id="h41-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h41-1-63" id="h41-1-63" class="i">+                                    datatype: Float,
</a><a href="#h41-1-64" id="h41-1-64" class="i">+                                    primary_key: false,
</a><a href="#h41-1-65" id="h41-1-65" class="i">+                                    nullable: true,
</a><a href="#h41-1-66" id="h41-1-66" class="i">+                                    default: Some(
</a><a href="#h41-1-67" id="h41-1-67" class="i">+                                        Null,
</a><a href="#h41-1-68" id="h41-1-68" class="i">+                                    ),
</a><a href="#h41-1-69" id="h41-1-69" class="i">+                                    unique: false,
</a><a href="#h41-1-70" id="h41-1-70" class="i">+                                    references: None,
</a><a href="#h41-1-71" id="h41-1-71" class="i">+                                    index: false,
</a><a href="#h41-1-72" id="h41-1-72" class="i">+                                },
</a><a href="#h41-1-73" id="h41-1-73" class="i">+                                Column {
</a><a href="#h41-1-74" id="h41-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h41-1-75" id="h41-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h41-1-76" id="h41-1-76" class="i">+                                    primary_key: false,
</a><a href="#h41-1-77" id="h41-1-77" class="i">+                                    nullable: true,
</a><a href="#h41-1-78" id="h41-1-78" class="i">+                                    default: Some(
</a><a href="#h41-1-79" id="h41-1-79" class="i">+                                        Null,
</a><a href="#h41-1-80" id="h41-1-80" class="i">+                                    ),
</a><a href="#h41-1-81" id="h41-1-81" class="i">+                                    unique: false,
</a><a href="#h41-1-82" id="h41-1-82" class="i">+                                    references: None,
</a><a href="#h41-1-83" id="h41-1-83" class="i">+                                    index: false,
</a><a href="#h41-1-84" id="h41-1-84" class="i">+                                },
</a><a href="#h41-1-85" id="h41-1-85" class="i">+                            ],
</a><a href="#h41-1-86" id="h41-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h42" href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a> b/<a href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -107,7 +107,89 @@ Plan: Select(
</a>                 source: Projection {
                     source: NestedLoopJoin {
                         left: Scan {
<a href="#h42-0-3" id="h42-0-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h42-0-4" id="h42-0-4" class="i">+                            table: Table {
</a><a href="#h42-0-5" id="h42-0-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h42-0-6" id="h42-0-6" class="i">+                                columns: [
</a><a href="#h42-0-7" id="h42-0-7" class="i">+                                    Column {
</a><a href="#h42-0-8" id="h42-0-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h42-0-9" id="h42-0-9" class="i">+                                        datatype: Integer,
</a><a href="#h42-0-10" id="h42-0-10" class="i">+                                        primary_key: true,
</a><a href="#h42-0-11" id="h42-0-11" class="i">+                                        nullable: false,
</a><a href="#h42-0-12" id="h42-0-12" class="i">+                                        default: None,
</a><a href="#h42-0-13" id="h42-0-13" class="i">+                                        unique: true,
</a><a href="#h42-0-14" id="h42-0-14" class="i">+                                        references: None,
</a><a href="#h42-0-15" id="h42-0-15" class="i">+                                        index: false,
</a><a href="#h42-0-16" id="h42-0-16" class="i">+                                    },
</a><a href="#h42-0-17" id="h42-0-17" class="i">+                                    Column {
</a><a href="#h42-0-18" id="h42-0-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h42-0-19" id="h42-0-19" class="i">+                                        datatype: String,
</a><a href="#h42-0-20" id="h42-0-20" class="i">+                                        primary_key: false,
</a><a href="#h42-0-21" id="h42-0-21" class="i">+                                        nullable: false,
</a><a href="#h42-0-22" id="h42-0-22" class="i">+                                        default: None,
</a><a href="#h42-0-23" id="h42-0-23" class="i">+                                        unique: false,
</a><a href="#h42-0-24" id="h42-0-24" class="i">+                                        references: None,
</a><a href="#h42-0-25" id="h42-0-25" class="i">+                                        index: false,
</a><a href="#h42-0-26" id="h42-0-26" class="i">+                                    },
</a><a href="#h42-0-27" id="h42-0-27" class="i">+                                    Column {
</a><a href="#h42-0-28" id="h42-0-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h42-0-29" id="h42-0-29" class="i">+                                        datatype: Integer,
</a><a href="#h42-0-30" id="h42-0-30" class="i">+                                        primary_key: false,
</a><a href="#h42-0-31" id="h42-0-31" class="i">+                                        nullable: false,
</a><a href="#h42-0-32" id="h42-0-32" class="i">+                                        default: None,
</a><a href="#h42-0-33" id="h42-0-33" class="i">+                                        unique: false,
</a><a href="#h42-0-34" id="h42-0-34" class="i">+                                        references: Some(
</a><a href="#h42-0-35" id="h42-0-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h42-0-36" id="h42-0-36" class="i">+                                        ),
</a><a href="#h42-0-37" id="h42-0-37" class="i">+                                        index: true,
</a><a href="#h42-0-38" id="h42-0-38" class="i">+                                    },
</a><a href="#h42-0-39" id="h42-0-39" class="i">+                                    Column {
</a><a href="#h42-0-40" id="h42-0-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h42-0-41" id="h42-0-41" class="i">+                                        datatype: Integer,
</a><a href="#h42-0-42" id="h42-0-42" class="i">+                                        primary_key: false,
</a><a href="#h42-0-43" id="h42-0-43" class="i">+                                        nullable: false,
</a><a href="#h42-0-44" id="h42-0-44" class="i">+                                        default: None,
</a><a href="#h42-0-45" id="h42-0-45" class="i">+                                        unique: false,
</a><a href="#h42-0-46" id="h42-0-46" class="i">+                                        references: Some(
</a><a href="#h42-0-47" id="h42-0-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h42-0-48" id="h42-0-48" class="i">+                                        ),
</a><a href="#h42-0-49" id="h42-0-49" class="i">+                                        index: true,
</a><a href="#h42-0-50" id="h42-0-50" class="i">+                                    },
</a><a href="#h42-0-51" id="h42-0-51" class="i">+                                    Column {
</a><a href="#h42-0-52" id="h42-0-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h42-0-53" id="h42-0-53" class="i">+                                        datatype: Integer,
</a><a href="#h42-0-54" id="h42-0-54" class="i">+                                        primary_key: false,
</a><a href="#h42-0-55" id="h42-0-55" class="i">+                                        nullable: false,
</a><a href="#h42-0-56" id="h42-0-56" class="i">+                                        default: None,
</a><a href="#h42-0-57" id="h42-0-57" class="i">+                                        unique: false,
</a><a href="#h42-0-58" id="h42-0-58" class="i">+                                        references: None,
</a><a href="#h42-0-59" id="h42-0-59" class="i">+                                        index: false,
</a><a href="#h42-0-60" id="h42-0-60" class="i">+                                    },
</a><a href="#h42-0-61" id="h42-0-61" class="i">+                                    Column {
</a><a href="#h42-0-62" id="h42-0-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h42-0-63" id="h42-0-63" class="i">+                                        datatype: Float,
</a><a href="#h42-0-64" id="h42-0-64" class="i">+                                        primary_key: false,
</a><a href="#h42-0-65" id="h42-0-65" class="i">+                                        nullable: true,
</a><a href="#h42-0-66" id="h42-0-66" class="i">+                                        default: Some(
</a><a href="#h42-0-67" id="h42-0-67" class="i">+                                            Null,
</a><a href="#h42-0-68" id="h42-0-68" class="i">+                                        ),
</a><a href="#h42-0-69" id="h42-0-69" class="i">+                                        unique: false,
</a><a href="#h42-0-70" id="h42-0-70" class="i">+                                        references: None,
</a><a href="#h42-0-71" id="h42-0-71" class="i">+                                        index: false,
</a><a href="#h42-0-72" id="h42-0-72" class="i">+                                    },
</a><a href="#h42-0-73" id="h42-0-73" class="i">+                                    Column {
</a><a href="#h42-0-74" id="h42-0-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h42-0-75" id="h42-0-75" class="i">+                                        datatype: Boolean,
</a><a href="#h42-0-76" id="h42-0-76" class="i">+                                        primary_key: false,
</a><a href="#h42-0-77" id="h42-0-77" class="i">+                                        nullable: true,
</a><a href="#h42-0-78" id="h42-0-78" class="i">+                                        default: Some(
</a><a href="#h42-0-79" id="h42-0-79" class="i">+                                            Null,
</a><a href="#h42-0-80" id="h42-0-80" class="i">+                                        ),
</a><a href="#h42-0-81" id="h42-0-81" class="i">+                                        unique: false,
</a><a href="#h42-0-82" id="h42-0-82" class="i">+                                        references: None,
</a><a href="#h42-0-83" id="h42-0-83" class="i">+                                        index: false,
</a><a href="#h42-0-84" id="h42-0-84" class="i">+                                    },
</a><a href="#h42-0-85" id="h42-0-85" class="i">+                                ],
</a><a href="#h42-0-86" id="h42-0-86" class="i">+                            },
</a>                             alias: Some(
                                 &quot;m&quot;,
                             ),
<a href="#h42-1" id="h42-1" class="h">@@ -115,7 +197,45 @@ Plan: Select(
</a>                         },
                         left_size: 7,
                         right: Scan {
<a href="#h42-1-3" id="h42-1-3" class="d">-                            table: &quot;studios&quot;,
</a><a href="#h42-1-4" id="h42-1-4" class="i">+                            table: Table {
</a><a href="#h42-1-5" id="h42-1-5" class="i">+                                name: &quot;studios&quot;,
</a><a href="#h42-1-6" id="h42-1-6" class="i">+                                columns: [
</a><a href="#h42-1-7" id="h42-1-7" class="i">+                                    Column {
</a><a href="#h42-1-8" id="h42-1-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h42-1-9" id="h42-1-9" class="i">+                                        datatype: Integer,
</a><a href="#h42-1-10" id="h42-1-10" class="i">+                                        primary_key: true,
</a><a href="#h42-1-11" id="h42-1-11" class="i">+                                        nullable: false,
</a><a href="#h42-1-12" id="h42-1-12" class="i">+                                        default: None,
</a><a href="#h42-1-13" id="h42-1-13" class="i">+                                        unique: true,
</a><a href="#h42-1-14" id="h42-1-14" class="i">+                                        references: None,
</a><a href="#h42-1-15" id="h42-1-15" class="i">+                                        index: false,
</a><a href="#h42-1-16" id="h42-1-16" class="i">+                                    },
</a><a href="#h42-1-17" id="h42-1-17" class="i">+                                    Column {
</a><a href="#h42-1-18" id="h42-1-18" class="i">+                                        name: &quot;name&quot;,
</a><a href="#h42-1-19" id="h42-1-19" class="i">+                                        datatype: String,
</a><a href="#h42-1-20" id="h42-1-20" class="i">+                                        primary_key: false,
</a><a href="#h42-1-21" id="h42-1-21" class="i">+                                        nullable: false,
</a><a href="#h42-1-22" id="h42-1-22" class="i">+                                        default: None,
</a><a href="#h42-1-23" id="h42-1-23" class="i">+                                        unique: false,
</a><a href="#h42-1-24" id="h42-1-24" class="i">+                                        references: None,
</a><a href="#h42-1-25" id="h42-1-25" class="i">+                                        index: false,
</a><a href="#h42-1-26" id="h42-1-26" class="i">+                                    },
</a><a href="#h42-1-27" id="h42-1-27" class="i">+                                    Column {
</a><a href="#h42-1-28" id="h42-1-28" class="i">+                                        name: &quot;country_id&quot;,
</a><a href="#h42-1-29" id="h42-1-29" class="i">+                                        datatype: String,
</a><a href="#h42-1-30" id="h42-1-30" class="i">+                                        primary_key: false,
</a><a href="#h42-1-31" id="h42-1-31" class="i">+                                        nullable: true,
</a><a href="#h42-1-32" id="h42-1-32" class="i">+                                        default: Some(
</a><a href="#h42-1-33" id="h42-1-33" class="i">+                                            Null,
</a><a href="#h42-1-34" id="h42-1-34" class="i">+                                        ),
</a><a href="#h42-1-35" id="h42-1-35" class="i">+                                        unique: false,
</a><a href="#h42-1-36" id="h42-1-36" class="i">+                                        references: Some(
</a><a href="#h42-1-37" id="h42-1-37" class="i">+                                            &quot;countries&quot;,
</a><a href="#h42-1-38" id="h42-1-38" class="i">+                                        ),
</a><a href="#h42-1-39" id="h42-1-39" class="i">+                                        index: true,
</a><a href="#h42-1-40" id="h42-1-40" class="i">+                                    },
</a><a href="#h42-1-41" id="h42-1-41" class="i">+                                ],
</a><a href="#h42-1-42" id="h42-1-42" class="i">+                            },
</a>                             alias: Some(
                                 &quot;s&quot;,
                             ),
<a href="#h42-2" id="h42-2" class="h">@@ -228,7 +348,89 @@ Optimized plan: Select(
</a>                 source: Projection {
                     source: HashJoin {
                         left: Scan {
<a href="#h42-2-3" id="h42-2-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h42-2-4" id="h42-2-4" class="i">+                            table: Table {
</a><a href="#h42-2-5" id="h42-2-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h42-2-6" id="h42-2-6" class="i">+                                columns: [
</a><a href="#h42-2-7" id="h42-2-7" class="i">+                                    Column {
</a><a href="#h42-2-8" id="h42-2-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h42-2-9" id="h42-2-9" class="i">+                                        datatype: Integer,
</a><a href="#h42-2-10" id="h42-2-10" class="i">+                                        primary_key: true,
</a><a href="#h42-2-11" id="h42-2-11" class="i">+                                        nullable: false,
</a><a href="#h42-2-12" id="h42-2-12" class="i">+                                        default: None,
</a><a href="#h42-2-13" id="h42-2-13" class="i">+                                        unique: true,
</a><a href="#h42-2-14" id="h42-2-14" class="i">+                                        references: None,
</a><a href="#h42-2-15" id="h42-2-15" class="i">+                                        index: false,
</a><a href="#h42-2-16" id="h42-2-16" class="i">+                                    },
</a><a href="#h42-2-17" id="h42-2-17" class="i">+                                    Column {
</a><a href="#h42-2-18" id="h42-2-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h42-2-19" id="h42-2-19" class="i">+                                        datatype: String,
</a><a href="#h42-2-20" id="h42-2-20" class="i">+                                        primary_key: false,
</a><a href="#h42-2-21" id="h42-2-21" class="i">+                                        nullable: false,
</a><a href="#h42-2-22" id="h42-2-22" class="i">+                                        default: None,
</a><a href="#h42-2-23" id="h42-2-23" class="i">+                                        unique: false,
</a><a href="#h42-2-24" id="h42-2-24" class="i">+                                        references: None,
</a><a href="#h42-2-25" id="h42-2-25" class="i">+                                        index: false,
</a><a href="#h42-2-26" id="h42-2-26" class="i">+                                    },
</a><a href="#h42-2-27" id="h42-2-27" class="i">+                                    Column {
</a><a href="#h42-2-28" id="h42-2-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h42-2-29" id="h42-2-29" class="i">+                                        datatype: Integer,
</a><a href="#h42-2-30" id="h42-2-30" class="i">+                                        primary_key: false,
</a><a href="#h42-2-31" id="h42-2-31" class="i">+                                        nullable: false,
</a><a href="#h42-2-32" id="h42-2-32" class="i">+                                        default: None,
</a><a href="#h42-2-33" id="h42-2-33" class="i">+                                        unique: false,
</a><a href="#h42-2-34" id="h42-2-34" class="i">+                                        references: Some(
</a><a href="#h42-2-35" id="h42-2-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h42-2-36" id="h42-2-36" class="i">+                                        ),
</a><a href="#h42-2-37" id="h42-2-37" class="i">+                                        index: true,
</a><a href="#h42-2-38" id="h42-2-38" class="i">+                                    },
</a><a href="#h42-2-39" id="h42-2-39" class="i">+                                    Column {
</a><a href="#h42-2-40" id="h42-2-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h42-2-41" id="h42-2-41" class="i">+                                        datatype: Integer,
</a><a href="#h42-2-42" id="h42-2-42" class="i">+                                        primary_key: false,
</a><a href="#h42-2-43" id="h42-2-43" class="i">+                                        nullable: false,
</a><a href="#h42-2-44" id="h42-2-44" class="i">+                                        default: None,
</a><a href="#h42-2-45" id="h42-2-45" class="i">+                                        unique: false,
</a><a href="#h42-2-46" id="h42-2-46" class="i">+                                        references: Some(
</a><a href="#h42-2-47" id="h42-2-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h42-2-48" id="h42-2-48" class="i">+                                        ),
</a><a href="#h42-2-49" id="h42-2-49" class="i">+                                        index: true,
</a><a href="#h42-2-50" id="h42-2-50" class="i">+                                    },
</a><a href="#h42-2-51" id="h42-2-51" class="i">+                                    Column {
</a><a href="#h42-2-52" id="h42-2-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h42-2-53" id="h42-2-53" class="i">+                                        datatype: Integer,
</a><a href="#h42-2-54" id="h42-2-54" class="i">+                                        primary_key: false,
</a><a href="#h42-2-55" id="h42-2-55" class="i">+                                        nullable: false,
</a><a href="#h42-2-56" id="h42-2-56" class="i">+                                        default: None,
</a><a href="#h42-2-57" id="h42-2-57" class="i">+                                        unique: false,
</a><a href="#h42-2-58" id="h42-2-58" class="i">+                                        references: None,
</a><a href="#h42-2-59" id="h42-2-59" class="i">+                                        index: false,
</a><a href="#h42-2-60" id="h42-2-60" class="i">+                                    },
</a><a href="#h42-2-61" id="h42-2-61" class="i">+                                    Column {
</a><a href="#h42-2-62" id="h42-2-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h42-2-63" id="h42-2-63" class="i">+                                        datatype: Float,
</a><a href="#h42-2-64" id="h42-2-64" class="i">+                                        primary_key: false,
</a><a href="#h42-2-65" id="h42-2-65" class="i">+                                        nullable: true,
</a><a href="#h42-2-66" id="h42-2-66" class="i">+                                        default: Some(
</a><a href="#h42-2-67" id="h42-2-67" class="i">+                                            Null,
</a><a href="#h42-2-68" id="h42-2-68" class="i">+                                        ),
</a><a href="#h42-2-69" id="h42-2-69" class="i">+                                        unique: false,
</a><a href="#h42-2-70" id="h42-2-70" class="i">+                                        references: None,
</a><a href="#h42-2-71" id="h42-2-71" class="i">+                                        index: false,
</a><a href="#h42-2-72" id="h42-2-72" class="i">+                                    },
</a><a href="#h42-2-73" id="h42-2-73" class="i">+                                    Column {
</a><a href="#h42-2-74" id="h42-2-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h42-2-75" id="h42-2-75" class="i">+                                        datatype: Boolean,
</a><a href="#h42-2-76" id="h42-2-76" class="i">+                                        primary_key: false,
</a><a href="#h42-2-77" id="h42-2-77" class="i">+                                        nullable: true,
</a><a href="#h42-2-78" id="h42-2-78" class="i">+                                        default: Some(
</a><a href="#h42-2-79" id="h42-2-79" class="i">+                                            Null,
</a><a href="#h42-2-80" id="h42-2-80" class="i">+                                        ),
</a><a href="#h42-2-81" id="h42-2-81" class="i">+                                        unique: false,
</a><a href="#h42-2-82" id="h42-2-82" class="i">+                                        references: None,
</a><a href="#h42-2-83" id="h42-2-83" class="i">+                                        index: false,
</a><a href="#h42-2-84" id="h42-2-84" class="i">+                                    },
</a><a href="#h42-2-85" id="h42-2-85" class="i">+                                ],
</a><a href="#h42-2-86" id="h42-2-86" class="i">+                            },
</a>                             alias: Some(
                                 &quot;m&quot;,
                             ),
<a href="#h42-3" id="h42-3" class="h">@@ -246,7 +448,45 @@ Optimized plan: Select(
</a>                             ),
                         ),
                         right: Scan {
<a href="#h42-3-3" id="h42-3-3" class="d">-                            table: &quot;studios&quot;,
</a><a href="#h42-3-4" id="h42-3-4" class="i">+                            table: Table {
</a><a href="#h42-3-5" id="h42-3-5" class="i">+                                name: &quot;studios&quot;,
</a><a href="#h42-3-6" id="h42-3-6" class="i">+                                columns: [
</a><a href="#h42-3-7" id="h42-3-7" class="i">+                                    Column {
</a><a href="#h42-3-8" id="h42-3-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h42-3-9" id="h42-3-9" class="i">+                                        datatype: Integer,
</a><a href="#h42-3-10" id="h42-3-10" class="i">+                                        primary_key: true,
</a><a href="#h42-3-11" id="h42-3-11" class="i">+                                        nullable: false,
</a><a href="#h42-3-12" id="h42-3-12" class="i">+                                        default: None,
</a><a href="#h42-3-13" id="h42-3-13" class="i">+                                        unique: true,
</a><a href="#h42-3-14" id="h42-3-14" class="i">+                                        references: None,
</a><a href="#h42-3-15" id="h42-3-15" class="i">+                                        index: false,
</a><a href="#h42-3-16" id="h42-3-16" class="i">+                                    },
</a><a href="#h42-3-17" id="h42-3-17" class="i">+                                    Column {
</a><a href="#h42-3-18" id="h42-3-18" class="i">+                                        name: &quot;name&quot;,
</a><a href="#h42-3-19" id="h42-3-19" class="i">+                                        datatype: String,
</a><a href="#h42-3-20" id="h42-3-20" class="i">+                                        primary_key: false,
</a><a href="#h42-3-21" id="h42-3-21" class="i">+                                        nullable: false,
</a><a href="#h42-3-22" id="h42-3-22" class="i">+                                        default: None,
</a><a href="#h42-3-23" id="h42-3-23" class="i">+                                        unique: false,
</a><a href="#h42-3-24" id="h42-3-24" class="i">+                                        references: None,
</a><a href="#h42-3-25" id="h42-3-25" class="i">+                                        index: false,
</a><a href="#h42-3-26" id="h42-3-26" class="i">+                                    },
</a><a href="#h42-3-27" id="h42-3-27" class="i">+                                    Column {
</a><a href="#h42-3-28" id="h42-3-28" class="i">+                                        name: &quot;country_id&quot;,
</a><a href="#h42-3-29" id="h42-3-29" class="i">+                                        datatype: String,
</a><a href="#h42-3-30" id="h42-3-30" class="i">+                                        primary_key: false,
</a><a href="#h42-3-31" id="h42-3-31" class="i">+                                        nullable: true,
</a><a href="#h42-3-32" id="h42-3-32" class="i">+                                        default: Some(
</a><a href="#h42-3-33" id="h42-3-33" class="i">+                                            Null,
</a><a href="#h42-3-34" id="h42-3-34" class="i">+                                        ),
</a><a href="#h42-3-35" id="h42-3-35" class="i">+                                        unique: false,
</a><a href="#h42-3-36" id="h42-3-36" class="i">+                                        references: Some(
</a><a href="#h42-3-37" id="h42-3-37" class="i">+                                            &quot;countries&quot;,
</a><a href="#h42-3-38" id="h42-3-38" class="i">+                                        ),
</a><a href="#h42-3-39" id="h42-3-39" class="i">+                                        index: true,
</a><a href="#h42-3-40" id="h42-3-40" class="i">+                                    },
</a><a href="#h42-3-41" id="h42-3-41" class="i">+                                ],
</a><a href="#h42-3-42" id="h42-3-42" class="i">+                            },
</a>                             alias: Some(
                                 &quot;s&quot;,
                             ),
<b>diff --git a/<a id="h43" href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a> b/<a href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -62,7 +62,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h43-0-3" id="h43-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h43-0-4" id="h43-0-4" class="i">+                        table: Table {
</a><a href="#h43-0-5" id="h43-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h43-0-6" id="h43-0-6" class="i">+                            columns: [
</a><a href="#h43-0-7" id="h43-0-7" class="i">+                                Column {
</a><a href="#h43-0-8" id="h43-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h43-0-9" id="h43-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h43-0-10" id="h43-0-10" class="i">+                                    primary_key: true,
</a><a href="#h43-0-11" id="h43-0-11" class="i">+                                    nullable: false,
</a><a href="#h43-0-12" id="h43-0-12" class="i">+                                    default: None,
</a><a href="#h43-0-13" id="h43-0-13" class="i">+                                    unique: true,
</a><a href="#h43-0-14" id="h43-0-14" class="i">+                                    references: None,
</a><a href="#h43-0-15" id="h43-0-15" class="i">+                                    index: false,
</a><a href="#h43-0-16" id="h43-0-16" class="i">+                                },
</a><a href="#h43-0-17" id="h43-0-17" class="i">+                                Column {
</a><a href="#h43-0-18" id="h43-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h43-0-19" id="h43-0-19" class="i">+                                    datatype: String,
</a><a href="#h43-0-20" id="h43-0-20" class="i">+                                    primary_key: false,
</a><a href="#h43-0-21" id="h43-0-21" class="i">+                                    nullable: false,
</a><a href="#h43-0-22" id="h43-0-22" class="i">+                                    default: None,
</a><a href="#h43-0-23" id="h43-0-23" class="i">+                                    unique: false,
</a><a href="#h43-0-24" id="h43-0-24" class="i">+                                    references: None,
</a><a href="#h43-0-25" id="h43-0-25" class="i">+                                    index: false,
</a><a href="#h43-0-26" id="h43-0-26" class="i">+                                },
</a><a href="#h43-0-27" id="h43-0-27" class="i">+                                Column {
</a><a href="#h43-0-28" id="h43-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h43-0-29" id="h43-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h43-0-30" id="h43-0-30" class="i">+                                    primary_key: false,
</a><a href="#h43-0-31" id="h43-0-31" class="i">+                                    nullable: false,
</a><a href="#h43-0-32" id="h43-0-32" class="i">+                                    default: None,
</a><a href="#h43-0-33" id="h43-0-33" class="i">+                                    unique: false,
</a><a href="#h43-0-34" id="h43-0-34" class="i">+                                    references: Some(
</a><a href="#h43-0-35" id="h43-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h43-0-36" id="h43-0-36" class="i">+                                    ),
</a><a href="#h43-0-37" id="h43-0-37" class="i">+                                    index: true,
</a><a href="#h43-0-38" id="h43-0-38" class="i">+                                },
</a><a href="#h43-0-39" id="h43-0-39" class="i">+                                Column {
</a><a href="#h43-0-40" id="h43-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h43-0-41" id="h43-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h43-0-42" id="h43-0-42" class="i">+                                    primary_key: false,
</a><a href="#h43-0-43" id="h43-0-43" class="i">+                                    nullable: false,
</a><a href="#h43-0-44" id="h43-0-44" class="i">+                                    default: None,
</a><a href="#h43-0-45" id="h43-0-45" class="i">+                                    unique: false,
</a><a href="#h43-0-46" id="h43-0-46" class="i">+                                    references: Some(
</a><a href="#h43-0-47" id="h43-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h43-0-48" id="h43-0-48" class="i">+                                    ),
</a><a href="#h43-0-49" id="h43-0-49" class="i">+                                    index: true,
</a><a href="#h43-0-50" id="h43-0-50" class="i">+                                },
</a><a href="#h43-0-51" id="h43-0-51" class="i">+                                Column {
</a><a href="#h43-0-52" id="h43-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h43-0-53" id="h43-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h43-0-54" id="h43-0-54" class="i">+                                    primary_key: false,
</a><a href="#h43-0-55" id="h43-0-55" class="i">+                                    nullable: false,
</a><a href="#h43-0-56" id="h43-0-56" class="i">+                                    default: None,
</a><a href="#h43-0-57" id="h43-0-57" class="i">+                                    unique: false,
</a><a href="#h43-0-58" id="h43-0-58" class="i">+                                    references: None,
</a><a href="#h43-0-59" id="h43-0-59" class="i">+                                    index: false,
</a><a href="#h43-0-60" id="h43-0-60" class="i">+                                },
</a><a href="#h43-0-61" id="h43-0-61" class="i">+                                Column {
</a><a href="#h43-0-62" id="h43-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h43-0-63" id="h43-0-63" class="i">+                                    datatype: Float,
</a><a href="#h43-0-64" id="h43-0-64" class="i">+                                    primary_key: false,
</a><a href="#h43-0-65" id="h43-0-65" class="i">+                                    nullable: true,
</a><a href="#h43-0-66" id="h43-0-66" class="i">+                                    default: Some(
</a><a href="#h43-0-67" id="h43-0-67" class="i">+                                        Null,
</a><a href="#h43-0-68" id="h43-0-68" class="i">+                                    ),
</a><a href="#h43-0-69" id="h43-0-69" class="i">+                                    unique: false,
</a><a href="#h43-0-70" id="h43-0-70" class="i">+                                    references: None,
</a><a href="#h43-0-71" id="h43-0-71" class="i">+                                    index: false,
</a><a href="#h43-0-72" id="h43-0-72" class="i">+                                },
</a><a href="#h43-0-73" id="h43-0-73" class="i">+                                Column {
</a><a href="#h43-0-74" id="h43-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h43-0-75" id="h43-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h43-0-76" id="h43-0-76" class="i">+                                    primary_key: false,
</a><a href="#h43-0-77" id="h43-0-77" class="i">+                                    nullable: true,
</a><a href="#h43-0-78" id="h43-0-78" class="i">+                                    default: Some(
</a><a href="#h43-0-79" id="h43-0-79" class="i">+                                        Null,
</a><a href="#h43-0-80" id="h43-0-80" class="i">+                                    ),
</a><a href="#h43-0-81" id="h43-0-81" class="i">+                                    unique: false,
</a><a href="#h43-0-82" id="h43-0-82" class="i">+                                    references: None,
</a><a href="#h43-0-83" id="h43-0-83" class="i">+                                    index: false,
</a><a href="#h43-0-84" id="h43-0-84" class="i">+                                },
</a><a href="#h43-0-85" id="h43-0-85" class="i">+                            ],
</a><a href="#h43-0-86" id="h43-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h43-1" id="h43-1" class="h">@@ -125,7 +207,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h43-1-3" id="h43-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h43-1-4" id="h43-1-4" class="i">+                        table: Table {
</a><a href="#h43-1-5" id="h43-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h43-1-6" id="h43-1-6" class="i">+                            columns: [
</a><a href="#h43-1-7" id="h43-1-7" class="i">+                                Column {
</a><a href="#h43-1-8" id="h43-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h43-1-9" id="h43-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h43-1-10" id="h43-1-10" class="i">+                                    primary_key: true,
</a><a href="#h43-1-11" id="h43-1-11" class="i">+                                    nullable: false,
</a><a href="#h43-1-12" id="h43-1-12" class="i">+                                    default: None,
</a><a href="#h43-1-13" id="h43-1-13" class="i">+                                    unique: true,
</a><a href="#h43-1-14" id="h43-1-14" class="i">+                                    references: None,
</a><a href="#h43-1-15" id="h43-1-15" class="i">+                                    index: false,
</a><a href="#h43-1-16" id="h43-1-16" class="i">+                                },
</a><a href="#h43-1-17" id="h43-1-17" class="i">+                                Column {
</a><a href="#h43-1-18" id="h43-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h43-1-19" id="h43-1-19" class="i">+                                    datatype: String,
</a><a href="#h43-1-20" id="h43-1-20" class="i">+                                    primary_key: false,
</a><a href="#h43-1-21" id="h43-1-21" class="i">+                                    nullable: false,
</a><a href="#h43-1-22" id="h43-1-22" class="i">+                                    default: None,
</a><a href="#h43-1-23" id="h43-1-23" class="i">+                                    unique: false,
</a><a href="#h43-1-24" id="h43-1-24" class="i">+                                    references: None,
</a><a href="#h43-1-25" id="h43-1-25" class="i">+                                    index: false,
</a><a href="#h43-1-26" id="h43-1-26" class="i">+                                },
</a><a href="#h43-1-27" id="h43-1-27" class="i">+                                Column {
</a><a href="#h43-1-28" id="h43-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h43-1-29" id="h43-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h43-1-30" id="h43-1-30" class="i">+                                    primary_key: false,
</a><a href="#h43-1-31" id="h43-1-31" class="i">+                                    nullable: false,
</a><a href="#h43-1-32" id="h43-1-32" class="i">+                                    default: None,
</a><a href="#h43-1-33" id="h43-1-33" class="i">+                                    unique: false,
</a><a href="#h43-1-34" id="h43-1-34" class="i">+                                    references: Some(
</a><a href="#h43-1-35" id="h43-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h43-1-36" id="h43-1-36" class="i">+                                    ),
</a><a href="#h43-1-37" id="h43-1-37" class="i">+                                    index: true,
</a><a href="#h43-1-38" id="h43-1-38" class="i">+                                },
</a><a href="#h43-1-39" id="h43-1-39" class="i">+                                Column {
</a><a href="#h43-1-40" id="h43-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h43-1-41" id="h43-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h43-1-42" id="h43-1-42" class="i">+                                    primary_key: false,
</a><a href="#h43-1-43" id="h43-1-43" class="i">+                                    nullable: false,
</a><a href="#h43-1-44" id="h43-1-44" class="i">+                                    default: None,
</a><a href="#h43-1-45" id="h43-1-45" class="i">+                                    unique: false,
</a><a href="#h43-1-46" id="h43-1-46" class="i">+                                    references: Some(
</a><a href="#h43-1-47" id="h43-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h43-1-48" id="h43-1-48" class="i">+                                    ),
</a><a href="#h43-1-49" id="h43-1-49" class="i">+                                    index: true,
</a><a href="#h43-1-50" id="h43-1-50" class="i">+                                },
</a><a href="#h43-1-51" id="h43-1-51" class="i">+                                Column {
</a><a href="#h43-1-52" id="h43-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h43-1-53" id="h43-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h43-1-54" id="h43-1-54" class="i">+                                    primary_key: false,
</a><a href="#h43-1-55" id="h43-1-55" class="i">+                                    nullable: false,
</a><a href="#h43-1-56" id="h43-1-56" class="i">+                                    default: None,
</a><a href="#h43-1-57" id="h43-1-57" class="i">+                                    unique: false,
</a><a href="#h43-1-58" id="h43-1-58" class="i">+                                    references: None,
</a><a href="#h43-1-59" id="h43-1-59" class="i">+                                    index: false,
</a><a href="#h43-1-60" id="h43-1-60" class="i">+                                },
</a><a href="#h43-1-61" id="h43-1-61" class="i">+                                Column {
</a><a href="#h43-1-62" id="h43-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h43-1-63" id="h43-1-63" class="i">+                                    datatype: Float,
</a><a href="#h43-1-64" id="h43-1-64" class="i">+                                    primary_key: false,
</a><a href="#h43-1-65" id="h43-1-65" class="i">+                                    nullable: true,
</a><a href="#h43-1-66" id="h43-1-66" class="i">+                                    default: Some(
</a><a href="#h43-1-67" id="h43-1-67" class="i">+                                        Null,
</a><a href="#h43-1-68" id="h43-1-68" class="i">+                                    ),
</a><a href="#h43-1-69" id="h43-1-69" class="i">+                                    unique: false,
</a><a href="#h43-1-70" id="h43-1-70" class="i">+                                    references: None,
</a><a href="#h43-1-71" id="h43-1-71" class="i">+                                    index: false,
</a><a href="#h43-1-72" id="h43-1-72" class="i">+                                },
</a><a href="#h43-1-73" id="h43-1-73" class="i">+                                Column {
</a><a href="#h43-1-74" id="h43-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h43-1-75" id="h43-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h43-1-76" id="h43-1-76" class="i">+                                    primary_key: false,
</a><a href="#h43-1-77" id="h43-1-77" class="i">+                                    nullable: true,
</a><a href="#h43-1-78" id="h43-1-78" class="i">+                                    default: Some(
</a><a href="#h43-1-79" id="h43-1-79" class="i">+                                        Null,
</a><a href="#h43-1-80" id="h43-1-80" class="i">+                                    ),
</a><a href="#h43-1-81" id="h43-1-81" class="i">+                                    unique: false,
</a><a href="#h43-1-82" id="h43-1-82" class="i">+                                    references: None,
</a><a href="#h43-1-83" id="h43-1-83" class="i">+                                    index: false,
</a><a href="#h43-1-84" id="h43-1-84" class="i">+                                },
</a><a href="#h43-1-85" id="h43-1-85" class="i">+                            ],
</a><a href="#h43-1-86" id="h43-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h44" href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a> b/<a href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -63,7 +63,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h44-0-3" id="h44-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h44-0-4" id="h44-0-4" class="i">+                        table: Table {
</a><a href="#h44-0-5" id="h44-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h44-0-6" id="h44-0-6" class="i">+                            columns: [
</a><a href="#h44-0-7" id="h44-0-7" class="i">+                                Column {
</a><a href="#h44-0-8" id="h44-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h44-0-9" id="h44-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h44-0-10" id="h44-0-10" class="i">+                                    primary_key: true,
</a><a href="#h44-0-11" id="h44-0-11" class="i">+                                    nullable: false,
</a><a href="#h44-0-12" id="h44-0-12" class="i">+                                    default: None,
</a><a href="#h44-0-13" id="h44-0-13" class="i">+                                    unique: true,
</a><a href="#h44-0-14" id="h44-0-14" class="i">+                                    references: None,
</a><a href="#h44-0-15" id="h44-0-15" class="i">+                                    index: false,
</a><a href="#h44-0-16" id="h44-0-16" class="i">+                                },
</a><a href="#h44-0-17" id="h44-0-17" class="i">+                                Column {
</a><a href="#h44-0-18" id="h44-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h44-0-19" id="h44-0-19" class="i">+                                    datatype: String,
</a><a href="#h44-0-20" id="h44-0-20" class="i">+                                    primary_key: false,
</a><a href="#h44-0-21" id="h44-0-21" class="i">+                                    nullable: false,
</a><a href="#h44-0-22" id="h44-0-22" class="i">+                                    default: None,
</a><a href="#h44-0-23" id="h44-0-23" class="i">+                                    unique: false,
</a><a href="#h44-0-24" id="h44-0-24" class="i">+                                    references: None,
</a><a href="#h44-0-25" id="h44-0-25" class="i">+                                    index: false,
</a><a href="#h44-0-26" id="h44-0-26" class="i">+                                },
</a><a href="#h44-0-27" id="h44-0-27" class="i">+                                Column {
</a><a href="#h44-0-28" id="h44-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h44-0-29" id="h44-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h44-0-30" id="h44-0-30" class="i">+                                    primary_key: false,
</a><a href="#h44-0-31" id="h44-0-31" class="i">+                                    nullable: false,
</a><a href="#h44-0-32" id="h44-0-32" class="i">+                                    default: None,
</a><a href="#h44-0-33" id="h44-0-33" class="i">+                                    unique: false,
</a><a href="#h44-0-34" id="h44-0-34" class="i">+                                    references: Some(
</a><a href="#h44-0-35" id="h44-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h44-0-36" id="h44-0-36" class="i">+                                    ),
</a><a href="#h44-0-37" id="h44-0-37" class="i">+                                    index: true,
</a><a href="#h44-0-38" id="h44-0-38" class="i">+                                },
</a><a href="#h44-0-39" id="h44-0-39" class="i">+                                Column {
</a><a href="#h44-0-40" id="h44-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h44-0-41" id="h44-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h44-0-42" id="h44-0-42" class="i">+                                    primary_key: false,
</a><a href="#h44-0-43" id="h44-0-43" class="i">+                                    nullable: false,
</a><a href="#h44-0-44" id="h44-0-44" class="i">+                                    default: None,
</a><a href="#h44-0-45" id="h44-0-45" class="i">+                                    unique: false,
</a><a href="#h44-0-46" id="h44-0-46" class="i">+                                    references: Some(
</a><a href="#h44-0-47" id="h44-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h44-0-48" id="h44-0-48" class="i">+                                    ),
</a><a href="#h44-0-49" id="h44-0-49" class="i">+                                    index: true,
</a><a href="#h44-0-50" id="h44-0-50" class="i">+                                },
</a><a href="#h44-0-51" id="h44-0-51" class="i">+                                Column {
</a><a href="#h44-0-52" id="h44-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h44-0-53" id="h44-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h44-0-54" id="h44-0-54" class="i">+                                    primary_key: false,
</a><a href="#h44-0-55" id="h44-0-55" class="i">+                                    nullable: false,
</a><a href="#h44-0-56" id="h44-0-56" class="i">+                                    default: None,
</a><a href="#h44-0-57" id="h44-0-57" class="i">+                                    unique: false,
</a><a href="#h44-0-58" id="h44-0-58" class="i">+                                    references: None,
</a><a href="#h44-0-59" id="h44-0-59" class="i">+                                    index: false,
</a><a href="#h44-0-60" id="h44-0-60" class="i">+                                },
</a><a href="#h44-0-61" id="h44-0-61" class="i">+                                Column {
</a><a href="#h44-0-62" id="h44-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h44-0-63" id="h44-0-63" class="i">+                                    datatype: Float,
</a><a href="#h44-0-64" id="h44-0-64" class="i">+                                    primary_key: false,
</a><a href="#h44-0-65" id="h44-0-65" class="i">+                                    nullable: true,
</a><a href="#h44-0-66" id="h44-0-66" class="i">+                                    default: Some(
</a><a href="#h44-0-67" id="h44-0-67" class="i">+                                        Null,
</a><a href="#h44-0-68" id="h44-0-68" class="i">+                                    ),
</a><a href="#h44-0-69" id="h44-0-69" class="i">+                                    unique: false,
</a><a href="#h44-0-70" id="h44-0-70" class="i">+                                    references: None,
</a><a href="#h44-0-71" id="h44-0-71" class="i">+                                    index: false,
</a><a href="#h44-0-72" id="h44-0-72" class="i">+                                },
</a><a href="#h44-0-73" id="h44-0-73" class="i">+                                Column {
</a><a href="#h44-0-74" id="h44-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h44-0-75" id="h44-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h44-0-76" id="h44-0-76" class="i">+                                    primary_key: false,
</a><a href="#h44-0-77" id="h44-0-77" class="i">+                                    nullable: true,
</a><a href="#h44-0-78" id="h44-0-78" class="i">+                                    default: Some(
</a><a href="#h44-0-79" id="h44-0-79" class="i">+                                        Null,
</a><a href="#h44-0-80" id="h44-0-80" class="i">+                                    ),
</a><a href="#h44-0-81" id="h44-0-81" class="i">+                                    unique: false,
</a><a href="#h44-0-82" id="h44-0-82" class="i">+                                    references: None,
</a><a href="#h44-0-83" id="h44-0-83" class="i">+                                    index: false,
</a><a href="#h44-0-84" id="h44-0-84" class="i">+                                },
</a><a href="#h44-0-85" id="h44-0-85" class="i">+                            ],
</a><a href="#h44-0-86" id="h44-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h44-1" id="h44-1" class="h">@@ -133,7 +215,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h44-1-3" id="h44-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h44-1-4" id="h44-1-4" class="i">+                        table: Table {
</a><a href="#h44-1-5" id="h44-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h44-1-6" id="h44-1-6" class="i">+                            columns: [
</a><a href="#h44-1-7" id="h44-1-7" class="i">+                                Column {
</a><a href="#h44-1-8" id="h44-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h44-1-9" id="h44-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h44-1-10" id="h44-1-10" class="i">+                                    primary_key: true,
</a><a href="#h44-1-11" id="h44-1-11" class="i">+                                    nullable: false,
</a><a href="#h44-1-12" id="h44-1-12" class="i">+                                    default: None,
</a><a href="#h44-1-13" id="h44-1-13" class="i">+                                    unique: true,
</a><a href="#h44-1-14" id="h44-1-14" class="i">+                                    references: None,
</a><a href="#h44-1-15" id="h44-1-15" class="i">+                                    index: false,
</a><a href="#h44-1-16" id="h44-1-16" class="i">+                                },
</a><a href="#h44-1-17" id="h44-1-17" class="i">+                                Column {
</a><a href="#h44-1-18" id="h44-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h44-1-19" id="h44-1-19" class="i">+                                    datatype: String,
</a><a href="#h44-1-20" id="h44-1-20" class="i">+                                    primary_key: false,
</a><a href="#h44-1-21" id="h44-1-21" class="i">+                                    nullable: false,
</a><a href="#h44-1-22" id="h44-1-22" class="i">+                                    default: None,
</a><a href="#h44-1-23" id="h44-1-23" class="i">+                                    unique: false,
</a><a href="#h44-1-24" id="h44-1-24" class="i">+                                    references: None,
</a><a href="#h44-1-25" id="h44-1-25" class="i">+                                    index: false,
</a><a href="#h44-1-26" id="h44-1-26" class="i">+                                },
</a><a href="#h44-1-27" id="h44-1-27" class="i">+                                Column {
</a><a href="#h44-1-28" id="h44-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h44-1-29" id="h44-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h44-1-30" id="h44-1-30" class="i">+                                    primary_key: false,
</a><a href="#h44-1-31" id="h44-1-31" class="i">+                                    nullable: false,
</a><a href="#h44-1-32" id="h44-1-32" class="i">+                                    default: None,
</a><a href="#h44-1-33" id="h44-1-33" class="i">+                                    unique: false,
</a><a href="#h44-1-34" id="h44-1-34" class="i">+                                    references: Some(
</a><a href="#h44-1-35" id="h44-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h44-1-36" id="h44-1-36" class="i">+                                    ),
</a><a href="#h44-1-37" id="h44-1-37" class="i">+                                    index: true,
</a><a href="#h44-1-38" id="h44-1-38" class="i">+                                },
</a><a href="#h44-1-39" id="h44-1-39" class="i">+                                Column {
</a><a href="#h44-1-40" id="h44-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h44-1-41" id="h44-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h44-1-42" id="h44-1-42" class="i">+                                    primary_key: false,
</a><a href="#h44-1-43" id="h44-1-43" class="i">+                                    nullable: false,
</a><a href="#h44-1-44" id="h44-1-44" class="i">+                                    default: None,
</a><a href="#h44-1-45" id="h44-1-45" class="i">+                                    unique: false,
</a><a href="#h44-1-46" id="h44-1-46" class="i">+                                    references: Some(
</a><a href="#h44-1-47" id="h44-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h44-1-48" id="h44-1-48" class="i">+                                    ),
</a><a href="#h44-1-49" id="h44-1-49" class="i">+                                    index: true,
</a><a href="#h44-1-50" id="h44-1-50" class="i">+                                },
</a><a href="#h44-1-51" id="h44-1-51" class="i">+                                Column {
</a><a href="#h44-1-52" id="h44-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h44-1-53" id="h44-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h44-1-54" id="h44-1-54" class="i">+                                    primary_key: false,
</a><a href="#h44-1-55" id="h44-1-55" class="i">+                                    nullable: false,
</a><a href="#h44-1-56" id="h44-1-56" class="i">+                                    default: None,
</a><a href="#h44-1-57" id="h44-1-57" class="i">+                                    unique: false,
</a><a href="#h44-1-58" id="h44-1-58" class="i">+                                    references: None,
</a><a href="#h44-1-59" id="h44-1-59" class="i">+                                    index: false,
</a><a href="#h44-1-60" id="h44-1-60" class="i">+                                },
</a><a href="#h44-1-61" id="h44-1-61" class="i">+                                Column {
</a><a href="#h44-1-62" id="h44-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h44-1-63" id="h44-1-63" class="i">+                                    datatype: Float,
</a><a href="#h44-1-64" id="h44-1-64" class="i">+                                    primary_key: false,
</a><a href="#h44-1-65" id="h44-1-65" class="i">+                                    nullable: true,
</a><a href="#h44-1-66" id="h44-1-66" class="i">+                                    default: Some(
</a><a href="#h44-1-67" id="h44-1-67" class="i">+                                        Null,
</a><a href="#h44-1-68" id="h44-1-68" class="i">+                                    ),
</a><a href="#h44-1-69" id="h44-1-69" class="i">+                                    unique: false,
</a><a href="#h44-1-70" id="h44-1-70" class="i">+                                    references: None,
</a><a href="#h44-1-71" id="h44-1-71" class="i">+                                    index: false,
</a><a href="#h44-1-72" id="h44-1-72" class="i">+                                },
</a><a href="#h44-1-73" id="h44-1-73" class="i">+                                Column {
</a><a href="#h44-1-74" id="h44-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h44-1-75" id="h44-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h44-1-76" id="h44-1-76" class="i">+                                    primary_key: false,
</a><a href="#h44-1-77" id="h44-1-77" class="i">+                                    nullable: true,
</a><a href="#h44-1-78" id="h44-1-78" class="i">+                                    default: Some(
</a><a href="#h44-1-79" id="h44-1-79" class="i">+                                        Null,
</a><a href="#h44-1-80" id="h44-1-80" class="i">+                                    ),
</a><a href="#h44-1-81" id="h44-1-81" class="i">+                                    unique: false,
</a><a href="#h44-1-82" id="h44-1-82" class="i">+                                    references: None,
</a><a href="#h44-1-83" id="h44-1-83" class="i">+                                    index: false,
</a><a href="#h44-1-84" id="h44-1-84" class="i">+                                },
</a><a href="#h44-1-85" id="h44-1-85" class="i">+                            ],
</a><a href="#h44-1-86" id="h44-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h45" href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a> b/<a href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -68,7 +68,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h45-0-3" id="h45-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h45-0-4" id="h45-0-4" class="i">+                        table: Table {
</a><a href="#h45-0-5" id="h45-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h45-0-6" id="h45-0-6" class="i">+                            columns: [
</a><a href="#h45-0-7" id="h45-0-7" class="i">+                                Column {
</a><a href="#h45-0-8" id="h45-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h45-0-9" id="h45-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h45-0-10" id="h45-0-10" class="i">+                                    primary_key: true,
</a><a href="#h45-0-11" id="h45-0-11" class="i">+                                    nullable: false,
</a><a href="#h45-0-12" id="h45-0-12" class="i">+                                    default: None,
</a><a href="#h45-0-13" id="h45-0-13" class="i">+                                    unique: true,
</a><a href="#h45-0-14" id="h45-0-14" class="i">+                                    references: None,
</a><a href="#h45-0-15" id="h45-0-15" class="i">+                                    index: false,
</a><a href="#h45-0-16" id="h45-0-16" class="i">+                                },
</a><a href="#h45-0-17" id="h45-0-17" class="i">+                                Column {
</a><a href="#h45-0-18" id="h45-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h45-0-19" id="h45-0-19" class="i">+                                    datatype: String,
</a><a href="#h45-0-20" id="h45-0-20" class="i">+                                    primary_key: false,
</a><a href="#h45-0-21" id="h45-0-21" class="i">+                                    nullable: false,
</a><a href="#h45-0-22" id="h45-0-22" class="i">+                                    default: None,
</a><a href="#h45-0-23" id="h45-0-23" class="i">+                                    unique: false,
</a><a href="#h45-0-24" id="h45-0-24" class="i">+                                    references: None,
</a><a href="#h45-0-25" id="h45-0-25" class="i">+                                    index: false,
</a><a href="#h45-0-26" id="h45-0-26" class="i">+                                },
</a><a href="#h45-0-27" id="h45-0-27" class="i">+                                Column {
</a><a href="#h45-0-28" id="h45-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h45-0-29" id="h45-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h45-0-30" id="h45-0-30" class="i">+                                    primary_key: false,
</a><a href="#h45-0-31" id="h45-0-31" class="i">+                                    nullable: false,
</a><a href="#h45-0-32" id="h45-0-32" class="i">+                                    default: None,
</a><a href="#h45-0-33" id="h45-0-33" class="i">+                                    unique: false,
</a><a href="#h45-0-34" id="h45-0-34" class="i">+                                    references: Some(
</a><a href="#h45-0-35" id="h45-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h45-0-36" id="h45-0-36" class="i">+                                    ),
</a><a href="#h45-0-37" id="h45-0-37" class="i">+                                    index: true,
</a><a href="#h45-0-38" id="h45-0-38" class="i">+                                },
</a><a href="#h45-0-39" id="h45-0-39" class="i">+                                Column {
</a><a href="#h45-0-40" id="h45-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h45-0-41" id="h45-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h45-0-42" id="h45-0-42" class="i">+                                    primary_key: false,
</a><a href="#h45-0-43" id="h45-0-43" class="i">+                                    nullable: false,
</a><a href="#h45-0-44" id="h45-0-44" class="i">+                                    default: None,
</a><a href="#h45-0-45" id="h45-0-45" class="i">+                                    unique: false,
</a><a href="#h45-0-46" id="h45-0-46" class="i">+                                    references: Some(
</a><a href="#h45-0-47" id="h45-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h45-0-48" id="h45-0-48" class="i">+                                    ),
</a><a href="#h45-0-49" id="h45-0-49" class="i">+                                    index: true,
</a><a href="#h45-0-50" id="h45-0-50" class="i">+                                },
</a><a href="#h45-0-51" id="h45-0-51" class="i">+                                Column {
</a><a href="#h45-0-52" id="h45-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h45-0-53" id="h45-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h45-0-54" id="h45-0-54" class="i">+                                    primary_key: false,
</a><a href="#h45-0-55" id="h45-0-55" class="i">+                                    nullable: false,
</a><a href="#h45-0-56" id="h45-0-56" class="i">+                                    default: None,
</a><a href="#h45-0-57" id="h45-0-57" class="i">+                                    unique: false,
</a><a href="#h45-0-58" id="h45-0-58" class="i">+                                    references: None,
</a><a href="#h45-0-59" id="h45-0-59" class="i">+                                    index: false,
</a><a href="#h45-0-60" id="h45-0-60" class="i">+                                },
</a><a href="#h45-0-61" id="h45-0-61" class="i">+                                Column {
</a><a href="#h45-0-62" id="h45-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h45-0-63" id="h45-0-63" class="i">+                                    datatype: Float,
</a><a href="#h45-0-64" id="h45-0-64" class="i">+                                    primary_key: false,
</a><a href="#h45-0-65" id="h45-0-65" class="i">+                                    nullable: true,
</a><a href="#h45-0-66" id="h45-0-66" class="i">+                                    default: Some(
</a><a href="#h45-0-67" id="h45-0-67" class="i">+                                        Null,
</a><a href="#h45-0-68" id="h45-0-68" class="i">+                                    ),
</a><a href="#h45-0-69" id="h45-0-69" class="i">+                                    unique: false,
</a><a href="#h45-0-70" id="h45-0-70" class="i">+                                    references: None,
</a><a href="#h45-0-71" id="h45-0-71" class="i">+                                    index: false,
</a><a href="#h45-0-72" id="h45-0-72" class="i">+                                },
</a><a href="#h45-0-73" id="h45-0-73" class="i">+                                Column {
</a><a href="#h45-0-74" id="h45-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h45-0-75" id="h45-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h45-0-76" id="h45-0-76" class="i">+                                    primary_key: false,
</a><a href="#h45-0-77" id="h45-0-77" class="i">+                                    nullable: true,
</a><a href="#h45-0-78" id="h45-0-78" class="i">+                                    default: Some(
</a><a href="#h45-0-79" id="h45-0-79" class="i">+                                        Null,
</a><a href="#h45-0-80" id="h45-0-80" class="i">+                                    ),
</a><a href="#h45-0-81" id="h45-0-81" class="i">+                                    unique: false,
</a><a href="#h45-0-82" id="h45-0-82" class="i">+                                    references: None,
</a><a href="#h45-0-83" id="h45-0-83" class="i">+                                    index: false,
</a><a href="#h45-0-84" id="h45-0-84" class="i">+                                },
</a><a href="#h45-0-85" id="h45-0-85" class="i">+                            ],
</a><a href="#h45-0-86" id="h45-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h45-1" id="h45-1" class="h">@@ -152,7 +234,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h45-1-3" id="h45-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h45-1-4" id="h45-1-4" class="i">+                        table: Table {
</a><a href="#h45-1-5" id="h45-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h45-1-6" id="h45-1-6" class="i">+                            columns: [
</a><a href="#h45-1-7" id="h45-1-7" class="i">+                                Column {
</a><a href="#h45-1-8" id="h45-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h45-1-9" id="h45-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h45-1-10" id="h45-1-10" class="i">+                                    primary_key: true,
</a><a href="#h45-1-11" id="h45-1-11" class="i">+                                    nullable: false,
</a><a href="#h45-1-12" id="h45-1-12" class="i">+                                    default: None,
</a><a href="#h45-1-13" id="h45-1-13" class="i">+                                    unique: true,
</a><a href="#h45-1-14" id="h45-1-14" class="i">+                                    references: None,
</a><a href="#h45-1-15" id="h45-1-15" class="i">+                                    index: false,
</a><a href="#h45-1-16" id="h45-1-16" class="i">+                                },
</a><a href="#h45-1-17" id="h45-1-17" class="i">+                                Column {
</a><a href="#h45-1-18" id="h45-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h45-1-19" id="h45-1-19" class="i">+                                    datatype: String,
</a><a href="#h45-1-20" id="h45-1-20" class="i">+                                    primary_key: false,
</a><a href="#h45-1-21" id="h45-1-21" class="i">+                                    nullable: false,
</a><a href="#h45-1-22" id="h45-1-22" class="i">+                                    default: None,
</a><a href="#h45-1-23" id="h45-1-23" class="i">+                                    unique: false,
</a><a href="#h45-1-24" id="h45-1-24" class="i">+                                    references: None,
</a><a href="#h45-1-25" id="h45-1-25" class="i">+                                    index: false,
</a><a href="#h45-1-26" id="h45-1-26" class="i">+                                },
</a><a href="#h45-1-27" id="h45-1-27" class="i">+                                Column {
</a><a href="#h45-1-28" id="h45-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h45-1-29" id="h45-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h45-1-30" id="h45-1-30" class="i">+                                    primary_key: false,
</a><a href="#h45-1-31" id="h45-1-31" class="i">+                                    nullable: false,
</a><a href="#h45-1-32" id="h45-1-32" class="i">+                                    default: None,
</a><a href="#h45-1-33" id="h45-1-33" class="i">+                                    unique: false,
</a><a href="#h45-1-34" id="h45-1-34" class="i">+                                    references: Some(
</a><a href="#h45-1-35" id="h45-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h45-1-36" id="h45-1-36" class="i">+                                    ),
</a><a href="#h45-1-37" id="h45-1-37" class="i">+                                    index: true,
</a><a href="#h45-1-38" id="h45-1-38" class="i">+                                },
</a><a href="#h45-1-39" id="h45-1-39" class="i">+                                Column {
</a><a href="#h45-1-40" id="h45-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h45-1-41" id="h45-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h45-1-42" id="h45-1-42" class="i">+                                    primary_key: false,
</a><a href="#h45-1-43" id="h45-1-43" class="i">+                                    nullable: false,
</a><a href="#h45-1-44" id="h45-1-44" class="i">+                                    default: None,
</a><a href="#h45-1-45" id="h45-1-45" class="i">+                                    unique: false,
</a><a href="#h45-1-46" id="h45-1-46" class="i">+                                    references: Some(
</a><a href="#h45-1-47" id="h45-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h45-1-48" id="h45-1-48" class="i">+                                    ),
</a><a href="#h45-1-49" id="h45-1-49" class="i">+                                    index: true,
</a><a href="#h45-1-50" id="h45-1-50" class="i">+                                },
</a><a href="#h45-1-51" id="h45-1-51" class="i">+                                Column {
</a><a href="#h45-1-52" id="h45-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h45-1-53" id="h45-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h45-1-54" id="h45-1-54" class="i">+                                    primary_key: false,
</a><a href="#h45-1-55" id="h45-1-55" class="i">+                                    nullable: false,
</a><a href="#h45-1-56" id="h45-1-56" class="i">+                                    default: None,
</a><a href="#h45-1-57" id="h45-1-57" class="i">+                                    unique: false,
</a><a href="#h45-1-58" id="h45-1-58" class="i">+                                    references: None,
</a><a href="#h45-1-59" id="h45-1-59" class="i">+                                    index: false,
</a><a href="#h45-1-60" id="h45-1-60" class="i">+                                },
</a><a href="#h45-1-61" id="h45-1-61" class="i">+                                Column {
</a><a href="#h45-1-62" id="h45-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h45-1-63" id="h45-1-63" class="i">+                                    datatype: Float,
</a><a href="#h45-1-64" id="h45-1-64" class="i">+                                    primary_key: false,
</a><a href="#h45-1-65" id="h45-1-65" class="i">+                                    nullable: true,
</a><a href="#h45-1-66" id="h45-1-66" class="i">+                                    default: Some(
</a><a href="#h45-1-67" id="h45-1-67" class="i">+                                        Null,
</a><a href="#h45-1-68" id="h45-1-68" class="i">+                                    ),
</a><a href="#h45-1-69" id="h45-1-69" class="i">+                                    unique: false,
</a><a href="#h45-1-70" id="h45-1-70" class="i">+                                    references: None,
</a><a href="#h45-1-71" id="h45-1-71" class="i">+                                    index: false,
</a><a href="#h45-1-72" id="h45-1-72" class="i">+                                },
</a><a href="#h45-1-73" id="h45-1-73" class="i">+                                Column {
</a><a href="#h45-1-74" id="h45-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h45-1-75" id="h45-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h45-1-76" id="h45-1-76" class="i">+                                    primary_key: false,
</a><a href="#h45-1-77" id="h45-1-77" class="i">+                                    nullable: true,
</a><a href="#h45-1-78" id="h45-1-78" class="i">+                                    default: Some(
</a><a href="#h45-1-79" id="h45-1-79" class="i">+                                        Null,
</a><a href="#h45-1-80" id="h45-1-80" class="i">+                                    ),
</a><a href="#h45-1-81" id="h45-1-81" class="i">+                                    unique: false,
</a><a href="#h45-1-82" id="h45-1-82" class="i">+                                    references: None,
</a><a href="#h45-1-83" id="h45-1-83" class="i">+                                    index: false,
</a><a href="#h45-1-84" id="h45-1-84" class="i">+                                },
</a><a href="#h45-1-85" id="h45-1-85" class="i">+                            ],
</a><a href="#h45-1-86" id="h45-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h46" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -84,7 +84,89 @@ Plan: Select(
</a>                 source: Aggregation {
                     source: Projection {
                         source: Scan {
<a href="#h46-0-3" id="h46-0-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h46-0-4" id="h46-0-4" class="i">+                            table: Table {
</a><a href="#h46-0-5" id="h46-0-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h46-0-6" id="h46-0-6" class="i">+                                columns: [
</a><a href="#h46-0-7" id="h46-0-7" class="i">+                                    Column {
</a><a href="#h46-0-8" id="h46-0-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h46-0-9" id="h46-0-9" class="i">+                                        datatype: Integer,
</a><a href="#h46-0-10" id="h46-0-10" class="i">+                                        primary_key: true,
</a><a href="#h46-0-11" id="h46-0-11" class="i">+                                        nullable: false,
</a><a href="#h46-0-12" id="h46-0-12" class="i">+                                        default: None,
</a><a href="#h46-0-13" id="h46-0-13" class="i">+                                        unique: true,
</a><a href="#h46-0-14" id="h46-0-14" class="i">+                                        references: None,
</a><a href="#h46-0-15" id="h46-0-15" class="i">+                                        index: false,
</a><a href="#h46-0-16" id="h46-0-16" class="i">+                                    },
</a><a href="#h46-0-17" id="h46-0-17" class="i">+                                    Column {
</a><a href="#h46-0-18" id="h46-0-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h46-0-19" id="h46-0-19" class="i">+                                        datatype: String,
</a><a href="#h46-0-20" id="h46-0-20" class="i">+                                        primary_key: false,
</a><a href="#h46-0-21" id="h46-0-21" class="i">+                                        nullable: false,
</a><a href="#h46-0-22" id="h46-0-22" class="i">+                                        default: None,
</a><a href="#h46-0-23" id="h46-0-23" class="i">+                                        unique: false,
</a><a href="#h46-0-24" id="h46-0-24" class="i">+                                        references: None,
</a><a href="#h46-0-25" id="h46-0-25" class="i">+                                        index: false,
</a><a href="#h46-0-26" id="h46-0-26" class="i">+                                    },
</a><a href="#h46-0-27" id="h46-0-27" class="i">+                                    Column {
</a><a href="#h46-0-28" id="h46-0-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h46-0-29" id="h46-0-29" class="i">+                                        datatype: Integer,
</a><a href="#h46-0-30" id="h46-0-30" class="i">+                                        primary_key: false,
</a><a href="#h46-0-31" id="h46-0-31" class="i">+                                        nullable: false,
</a><a href="#h46-0-32" id="h46-0-32" class="i">+                                        default: None,
</a><a href="#h46-0-33" id="h46-0-33" class="i">+                                        unique: false,
</a><a href="#h46-0-34" id="h46-0-34" class="i">+                                        references: Some(
</a><a href="#h46-0-35" id="h46-0-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h46-0-36" id="h46-0-36" class="i">+                                        ),
</a><a href="#h46-0-37" id="h46-0-37" class="i">+                                        index: true,
</a><a href="#h46-0-38" id="h46-0-38" class="i">+                                    },
</a><a href="#h46-0-39" id="h46-0-39" class="i">+                                    Column {
</a><a href="#h46-0-40" id="h46-0-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h46-0-41" id="h46-0-41" class="i">+                                        datatype: Integer,
</a><a href="#h46-0-42" id="h46-0-42" class="i">+                                        primary_key: false,
</a><a href="#h46-0-43" id="h46-0-43" class="i">+                                        nullable: false,
</a><a href="#h46-0-44" id="h46-0-44" class="i">+                                        default: None,
</a><a href="#h46-0-45" id="h46-0-45" class="i">+                                        unique: false,
</a><a href="#h46-0-46" id="h46-0-46" class="i">+                                        references: Some(
</a><a href="#h46-0-47" id="h46-0-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h46-0-48" id="h46-0-48" class="i">+                                        ),
</a><a href="#h46-0-49" id="h46-0-49" class="i">+                                        index: true,
</a><a href="#h46-0-50" id="h46-0-50" class="i">+                                    },
</a><a href="#h46-0-51" id="h46-0-51" class="i">+                                    Column {
</a><a href="#h46-0-52" id="h46-0-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h46-0-53" id="h46-0-53" class="i">+                                        datatype: Integer,
</a><a href="#h46-0-54" id="h46-0-54" class="i">+                                        primary_key: false,
</a><a href="#h46-0-55" id="h46-0-55" class="i">+                                        nullable: false,
</a><a href="#h46-0-56" id="h46-0-56" class="i">+                                        default: None,
</a><a href="#h46-0-57" id="h46-0-57" class="i">+                                        unique: false,
</a><a href="#h46-0-58" id="h46-0-58" class="i">+                                        references: None,
</a><a href="#h46-0-59" id="h46-0-59" class="i">+                                        index: false,
</a><a href="#h46-0-60" id="h46-0-60" class="i">+                                    },
</a><a href="#h46-0-61" id="h46-0-61" class="i">+                                    Column {
</a><a href="#h46-0-62" id="h46-0-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h46-0-63" id="h46-0-63" class="i">+                                        datatype: Float,
</a><a href="#h46-0-64" id="h46-0-64" class="i">+                                        primary_key: false,
</a><a href="#h46-0-65" id="h46-0-65" class="i">+                                        nullable: true,
</a><a href="#h46-0-66" id="h46-0-66" class="i">+                                        default: Some(
</a><a href="#h46-0-67" id="h46-0-67" class="i">+                                            Null,
</a><a href="#h46-0-68" id="h46-0-68" class="i">+                                        ),
</a><a href="#h46-0-69" id="h46-0-69" class="i">+                                        unique: false,
</a><a href="#h46-0-70" id="h46-0-70" class="i">+                                        references: None,
</a><a href="#h46-0-71" id="h46-0-71" class="i">+                                        index: false,
</a><a href="#h46-0-72" id="h46-0-72" class="i">+                                    },
</a><a href="#h46-0-73" id="h46-0-73" class="i">+                                    Column {
</a><a href="#h46-0-74" id="h46-0-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h46-0-75" id="h46-0-75" class="i">+                                        datatype: Boolean,
</a><a href="#h46-0-76" id="h46-0-76" class="i">+                                        primary_key: false,
</a><a href="#h46-0-77" id="h46-0-77" class="i">+                                        nullable: true,
</a><a href="#h46-0-78" id="h46-0-78" class="i">+                                        default: Some(
</a><a href="#h46-0-79" id="h46-0-79" class="i">+                                            Null,
</a><a href="#h46-0-80" id="h46-0-80" class="i">+                                        ),
</a><a href="#h46-0-81" id="h46-0-81" class="i">+                                        unique: false,
</a><a href="#h46-0-82" id="h46-0-82" class="i">+                                        references: None,
</a><a href="#h46-0-83" id="h46-0-83" class="i">+                                        index: false,
</a><a href="#h46-0-84" id="h46-0-84" class="i">+                                    },
</a><a href="#h46-0-85" id="h46-0-85" class="i">+                                ],
</a><a href="#h46-0-86" id="h46-0-86" class="i">+                            },
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h46-1" id="h46-1" class="h">@@ -188,7 +270,89 @@ Optimized plan: Select(
</a>                 source: Aggregation {
                     source: Projection {
                         source: Scan {
<a href="#h46-1-3" id="h46-1-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h46-1-4" id="h46-1-4" class="i">+                            table: Table {
</a><a href="#h46-1-5" id="h46-1-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h46-1-6" id="h46-1-6" class="i">+                                columns: [
</a><a href="#h46-1-7" id="h46-1-7" class="i">+                                    Column {
</a><a href="#h46-1-8" id="h46-1-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h46-1-9" id="h46-1-9" class="i">+                                        datatype: Integer,
</a><a href="#h46-1-10" id="h46-1-10" class="i">+                                        primary_key: true,
</a><a href="#h46-1-11" id="h46-1-11" class="i">+                                        nullable: false,
</a><a href="#h46-1-12" id="h46-1-12" class="i">+                                        default: None,
</a><a href="#h46-1-13" id="h46-1-13" class="i">+                                        unique: true,
</a><a href="#h46-1-14" id="h46-1-14" class="i">+                                        references: None,
</a><a href="#h46-1-15" id="h46-1-15" class="i">+                                        index: false,
</a><a href="#h46-1-16" id="h46-1-16" class="i">+                                    },
</a><a href="#h46-1-17" id="h46-1-17" class="i">+                                    Column {
</a><a href="#h46-1-18" id="h46-1-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h46-1-19" id="h46-1-19" class="i">+                                        datatype: String,
</a><a href="#h46-1-20" id="h46-1-20" class="i">+                                        primary_key: false,
</a><a href="#h46-1-21" id="h46-1-21" class="i">+                                        nullable: false,
</a><a href="#h46-1-22" id="h46-1-22" class="i">+                                        default: None,
</a><a href="#h46-1-23" id="h46-1-23" class="i">+                                        unique: false,
</a><a href="#h46-1-24" id="h46-1-24" class="i">+                                        references: None,
</a><a href="#h46-1-25" id="h46-1-25" class="i">+                                        index: false,
</a><a href="#h46-1-26" id="h46-1-26" class="i">+                                    },
</a><a href="#h46-1-27" id="h46-1-27" class="i">+                                    Column {
</a><a href="#h46-1-28" id="h46-1-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h46-1-29" id="h46-1-29" class="i">+                                        datatype: Integer,
</a><a href="#h46-1-30" id="h46-1-30" class="i">+                                        primary_key: false,
</a><a href="#h46-1-31" id="h46-1-31" class="i">+                                        nullable: false,
</a><a href="#h46-1-32" id="h46-1-32" class="i">+                                        default: None,
</a><a href="#h46-1-33" id="h46-1-33" class="i">+                                        unique: false,
</a><a href="#h46-1-34" id="h46-1-34" class="i">+                                        references: Some(
</a><a href="#h46-1-35" id="h46-1-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h46-1-36" id="h46-1-36" class="i">+                                        ),
</a><a href="#h46-1-37" id="h46-1-37" class="i">+                                        index: true,
</a><a href="#h46-1-38" id="h46-1-38" class="i">+                                    },
</a><a href="#h46-1-39" id="h46-1-39" class="i">+                                    Column {
</a><a href="#h46-1-40" id="h46-1-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h46-1-41" id="h46-1-41" class="i">+                                        datatype: Integer,
</a><a href="#h46-1-42" id="h46-1-42" class="i">+                                        primary_key: false,
</a><a href="#h46-1-43" id="h46-1-43" class="i">+                                        nullable: false,
</a><a href="#h46-1-44" id="h46-1-44" class="i">+                                        default: None,
</a><a href="#h46-1-45" id="h46-1-45" class="i">+                                        unique: false,
</a><a href="#h46-1-46" id="h46-1-46" class="i">+                                        references: Some(
</a><a href="#h46-1-47" id="h46-1-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h46-1-48" id="h46-1-48" class="i">+                                        ),
</a><a href="#h46-1-49" id="h46-1-49" class="i">+                                        index: true,
</a><a href="#h46-1-50" id="h46-1-50" class="i">+                                    },
</a><a href="#h46-1-51" id="h46-1-51" class="i">+                                    Column {
</a><a href="#h46-1-52" id="h46-1-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h46-1-53" id="h46-1-53" class="i">+                                        datatype: Integer,
</a><a href="#h46-1-54" id="h46-1-54" class="i">+                                        primary_key: false,
</a><a href="#h46-1-55" id="h46-1-55" class="i">+                                        nullable: false,
</a><a href="#h46-1-56" id="h46-1-56" class="i">+                                        default: None,
</a><a href="#h46-1-57" id="h46-1-57" class="i">+                                        unique: false,
</a><a href="#h46-1-58" id="h46-1-58" class="i">+                                        references: None,
</a><a href="#h46-1-59" id="h46-1-59" class="i">+                                        index: false,
</a><a href="#h46-1-60" id="h46-1-60" class="i">+                                    },
</a><a href="#h46-1-61" id="h46-1-61" class="i">+                                    Column {
</a><a href="#h46-1-62" id="h46-1-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h46-1-63" id="h46-1-63" class="i">+                                        datatype: Float,
</a><a href="#h46-1-64" id="h46-1-64" class="i">+                                        primary_key: false,
</a><a href="#h46-1-65" id="h46-1-65" class="i">+                                        nullable: true,
</a><a href="#h46-1-66" id="h46-1-66" class="i">+                                        default: Some(
</a><a href="#h46-1-67" id="h46-1-67" class="i">+                                            Null,
</a><a href="#h46-1-68" id="h46-1-68" class="i">+                                        ),
</a><a href="#h46-1-69" id="h46-1-69" class="i">+                                        unique: false,
</a><a href="#h46-1-70" id="h46-1-70" class="i">+                                        references: None,
</a><a href="#h46-1-71" id="h46-1-71" class="i">+                                        index: false,
</a><a href="#h46-1-72" id="h46-1-72" class="i">+                                    },
</a><a href="#h46-1-73" id="h46-1-73" class="i">+                                    Column {
</a><a href="#h46-1-74" id="h46-1-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h46-1-75" id="h46-1-75" class="i">+                                        datatype: Boolean,
</a><a href="#h46-1-76" id="h46-1-76" class="i">+                                        primary_key: false,
</a><a href="#h46-1-77" id="h46-1-77" class="i">+                                        nullable: true,
</a><a href="#h46-1-78" id="h46-1-78" class="i">+                                        default: Some(
</a><a href="#h46-1-79" id="h46-1-79" class="i">+                                            Null,
</a><a href="#h46-1-80" id="h46-1-80" class="i">+                                        ),
</a><a href="#h46-1-81" id="h46-1-81" class="i">+                                        unique: false,
</a><a href="#h46-1-82" id="h46-1-82" class="i">+                                        references: None,
</a><a href="#h46-1-83" id="h46-1-83" class="i">+                                        index: false,
</a><a href="#h46-1-84" id="h46-1-84" class="i">+                                    },
</a><a href="#h46-1-85" id="h46-1-85" class="i">+                                ],
</a><a href="#h46-1-86" id="h46-1-86" class="i">+                            },
</a>                             alias: None,
                             filter: None,
                         },
<b>diff --git a/<a id="h47" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -90,7 +90,89 @@ Plan: Select(
</a>                     source: Aggregation {
                         source: Projection {
                             source: Scan {
<a href="#h47-0-3" id="h47-0-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h47-0-4" id="h47-0-4" class="i">+                                table: Table {
</a><a href="#h47-0-5" id="h47-0-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h47-0-6" id="h47-0-6" class="i">+                                    columns: [
</a><a href="#h47-0-7" id="h47-0-7" class="i">+                                        Column {
</a><a href="#h47-0-8" id="h47-0-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h47-0-9" id="h47-0-9" class="i">+                                            datatype: Integer,
</a><a href="#h47-0-10" id="h47-0-10" class="i">+                                            primary_key: true,
</a><a href="#h47-0-11" id="h47-0-11" class="i">+                                            nullable: false,
</a><a href="#h47-0-12" id="h47-0-12" class="i">+                                            default: None,
</a><a href="#h47-0-13" id="h47-0-13" class="i">+                                            unique: true,
</a><a href="#h47-0-14" id="h47-0-14" class="i">+                                            references: None,
</a><a href="#h47-0-15" id="h47-0-15" class="i">+                                            index: false,
</a><a href="#h47-0-16" id="h47-0-16" class="i">+                                        },
</a><a href="#h47-0-17" id="h47-0-17" class="i">+                                        Column {
</a><a href="#h47-0-18" id="h47-0-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h47-0-19" id="h47-0-19" class="i">+                                            datatype: String,
</a><a href="#h47-0-20" id="h47-0-20" class="i">+                                            primary_key: false,
</a><a href="#h47-0-21" id="h47-0-21" class="i">+                                            nullable: false,
</a><a href="#h47-0-22" id="h47-0-22" class="i">+                                            default: None,
</a><a href="#h47-0-23" id="h47-0-23" class="i">+                                            unique: false,
</a><a href="#h47-0-24" id="h47-0-24" class="i">+                                            references: None,
</a><a href="#h47-0-25" id="h47-0-25" class="i">+                                            index: false,
</a><a href="#h47-0-26" id="h47-0-26" class="i">+                                        },
</a><a href="#h47-0-27" id="h47-0-27" class="i">+                                        Column {
</a><a href="#h47-0-28" id="h47-0-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h47-0-29" id="h47-0-29" class="i">+                                            datatype: Integer,
</a><a href="#h47-0-30" id="h47-0-30" class="i">+                                            primary_key: false,
</a><a href="#h47-0-31" id="h47-0-31" class="i">+                                            nullable: false,
</a><a href="#h47-0-32" id="h47-0-32" class="i">+                                            default: None,
</a><a href="#h47-0-33" id="h47-0-33" class="i">+                                            unique: false,
</a><a href="#h47-0-34" id="h47-0-34" class="i">+                                            references: Some(
</a><a href="#h47-0-35" id="h47-0-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h47-0-36" id="h47-0-36" class="i">+                                            ),
</a><a href="#h47-0-37" id="h47-0-37" class="i">+                                            index: true,
</a><a href="#h47-0-38" id="h47-0-38" class="i">+                                        },
</a><a href="#h47-0-39" id="h47-0-39" class="i">+                                        Column {
</a><a href="#h47-0-40" id="h47-0-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h47-0-41" id="h47-0-41" class="i">+                                            datatype: Integer,
</a><a href="#h47-0-42" id="h47-0-42" class="i">+                                            primary_key: false,
</a><a href="#h47-0-43" id="h47-0-43" class="i">+                                            nullable: false,
</a><a href="#h47-0-44" id="h47-0-44" class="i">+                                            default: None,
</a><a href="#h47-0-45" id="h47-0-45" class="i">+                                            unique: false,
</a><a href="#h47-0-46" id="h47-0-46" class="i">+                                            references: Some(
</a><a href="#h47-0-47" id="h47-0-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h47-0-48" id="h47-0-48" class="i">+                                            ),
</a><a href="#h47-0-49" id="h47-0-49" class="i">+                                            index: true,
</a><a href="#h47-0-50" id="h47-0-50" class="i">+                                        },
</a><a href="#h47-0-51" id="h47-0-51" class="i">+                                        Column {
</a><a href="#h47-0-52" id="h47-0-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h47-0-53" id="h47-0-53" class="i">+                                            datatype: Integer,
</a><a href="#h47-0-54" id="h47-0-54" class="i">+                                            primary_key: false,
</a><a href="#h47-0-55" id="h47-0-55" class="i">+                                            nullable: false,
</a><a href="#h47-0-56" id="h47-0-56" class="i">+                                            default: None,
</a><a href="#h47-0-57" id="h47-0-57" class="i">+                                            unique: false,
</a><a href="#h47-0-58" id="h47-0-58" class="i">+                                            references: None,
</a><a href="#h47-0-59" id="h47-0-59" class="i">+                                            index: false,
</a><a href="#h47-0-60" id="h47-0-60" class="i">+                                        },
</a><a href="#h47-0-61" id="h47-0-61" class="i">+                                        Column {
</a><a href="#h47-0-62" id="h47-0-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h47-0-63" id="h47-0-63" class="i">+                                            datatype: Float,
</a><a href="#h47-0-64" id="h47-0-64" class="i">+                                            primary_key: false,
</a><a href="#h47-0-65" id="h47-0-65" class="i">+                                            nullable: true,
</a><a href="#h47-0-66" id="h47-0-66" class="i">+                                            default: Some(
</a><a href="#h47-0-67" id="h47-0-67" class="i">+                                                Null,
</a><a href="#h47-0-68" id="h47-0-68" class="i">+                                            ),
</a><a href="#h47-0-69" id="h47-0-69" class="i">+                                            unique: false,
</a><a href="#h47-0-70" id="h47-0-70" class="i">+                                            references: None,
</a><a href="#h47-0-71" id="h47-0-71" class="i">+                                            index: false,
</a><a href="#h47-0-72" id="h47-0-72" class="i">+                                        },
</a><a href="#h47-0-73" id="h47-0-73" class="i">+                                        Column {
</a><a href="#h47-0-74" id="h47-0-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h47-0-75" id="h47-0-75" class="i">+                                            datatype: Boolean,
</a><a href="#h47-0-76" id="h47-0-76" class="i">+                                            primary_key: false,
</a><a href="#h47-0-77" id="h47-0-77" class="i">+                                            nullable: true,
</a><a href="#h47-0-78" id="h47-0-78" class="i">+                                            default: Some(
</a><a href="#h47-0-79" id="h47-0-79" class="i">+                                                Null,
</a><a href="#h47-0-80" id="h47-0-80" class="i">+                                            ),
</a><a href="#h47-0-81" id="h47-0-81" class="i">+                                            unique: false,
</a><a href="#h47-0-82" id="h47-0-82" class="i">+                                            references: None,
</a><a href="#h47-0-83" id="h47-0-83" class="i">+                                            index: false,
</a><a href="#h47-0-84" id="h47-0-84" class="i">+                                        },
</a><a href="#h47-0-85" id="h47-0-85" class="i">+                                    ],
</a><a href="#h47-0-86" id="h47-0-86" class="i">+                                },
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h47-1" id="h47-1" class="h">@@ -225,7 +307,89 @@ Optimized plan: Select(
</a>                     source: Aggregation {
                         source: Projection {
                             source: Scan {
<a href="#h47-1-3" id="h47-1-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h47-1-4" id="h47-1-4" class="i">+                                table: Table {
</a><a href="#h47-1-5" id="h47-1-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h47-1-6" id="h47-1-6" class="i">+                                    columns: [
</a><a href="#h47-1-7" id="h47-1-7" class="i">+                                        Column {
</a><a href="#h47-1-8" id="h47-1-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h47-1-9" id="h47-1-9" class="i">+                                            datatype: Integer,
</a><a href="#h47-1-10" id="h47-1-10" class="i">+                                            primary_key: true,
</a><a href="#h47-1-11" id="h47-1-11" class="i">+                                            nullable: false,
</a><a href="#h47-1-12" id="h47-1-12" class="i">+                                            default: None,
</a><a href="#h47-1-13" id="h47-1-13" class="i">+                                            unique: true,
</a><a href="#h47-1-14" id="h47-1-14" class="i">+                                            references: None,
</a><a href="#h47-1-15" id="h47-1-15" class="i">+                                            index: false,
</a><a href="#h47-1-16" id="h47-1-16" class="i">+                                        },
</a><a href="#h47-1-17" id="h47-1-17" class="i">+                                        Column {
</a><a href="#h47-1-18" id="h47-1-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h47-1-19" id="h47-1-19" class="i">+                                            datatype: String,
</a><a href="#h47-1-20" id="h47-1-20" class="i">+                                            primary_key: false,
</a><a href="#h47-1-21" id="h47-1-21" class="i">+                                            nullable: false,
</a><a href="#h47-1-22" id="h47-1-22" class="i">+                                            default: None,
</a><a href="#h47-1-23" id="h47-1-23" class="i">+                                            unique: false,
</a><a href="#h47-1-24" id="h47-1-24" class="i">+                                            references: None,
</a><a href="#h47-1-25" id="h47-1-25" class="i">+                                            index: false,
</a><a href="#h47-1-26" id="h47-1-26" class="i">+                                        },
</a><a href="#h47-1-27" id="h47-1-27" class="i">+                                        Column {
</a><a href="#h47-1-28" id="h47-1-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h47-1-29" id="h47-1-29" class="i">+                                            datatype: Integer,
</a><a href="#h47-1-30" id="h47-1-30" class="i">+                                            primary_key: false,
</a><a href="#h47-1-31" id="h47-1-31" class="i">+                                            nullable: false,
</a><a href="#h47-1-32" id="h47-1-32" class="i">+                                            default: None,
</a><a href="#h47-1-33" id="h47-1-33" class="i">+                                            unique: false,
</a><a href="#h47-1-34" id="h47-1-34" class="i">+                                            references: Some(
</a><a href="#h47-1-35" id="h47-1-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h47-1-36" id="h47-1-36" class="i">+                                            ),
</a><a href="#h47-1-37" id="h47-1-37" class="i">+                                            index: true,
</a><a href="#h47-1-38" id="h47-1-38" class="i">+                                        },
</a><a href="#h47-1-39" id="h47-1-39" class="i">+                                        Column {
</a><a href="#h47-1-40" id="h47-1-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h47-1-41" id="h47-1-41" class="i">+                                            datatype: Integer,
</a><a href="#h47-1-42" id="h47-1-42" class="i">+                                            primary_key: false,
</a><a href="#h47-1-43" id="h47-1-43" class="i">+                                            nullable: false,
</a><a href="#h47-1-44" id="h47-1-44" class="i">+                                            default: None,
</a><a href="#h47-1-45" id="h47-1-45" class="i">+                                            unique: false,
</a><a href="#h47-1-46" id="h47-1-46" class="i">+                                            references: Some(
</a><a href="#h47-1-47" id="h47-1-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h47-1-48" id="h47-1-48" class="i">+                                            ),
</a><a href="#h47-1-49" id="h47-1-49" class="i">+                                            index: true,
</a><a href="#h47-1-50" id="h47-1-50" class="i">+                                        },
</a><a href="#h47-1-51" id="h47-1-51" class="i">+                                        Column {
</a><a href="#h47-1-52" id="h47-1-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h47-1-53" id="h47-1-53" class="i">+                                            datatype: Integer,
</a><a href="#h47-1-54" id="h47-1-54" class="i">+                                            primary_key: false,
</a><a href="#h47-1-55" id="h47-1-55" class="i">+                                            nullable: false,
</a><a href="#h47-1-56" id="h47-1-56" class="i">+                                            default: None,
</a><a href="#h47-1-57" id="h47-1-57" class="i">+                                            unique: false,
</a><a href="#h47-1-58" id="h47-1-58" class="i">+                                            references: None,
</a><a href="#h47-1-59" id="h47-1-59" class="i">+                                            index: false,
</a><a href="#h47-1-60" id="h47-1-60" class="i">+                                        },
</a><a href="#h47-1-61" id="h47-1-61" class="i">+                                        Column {
</a><a href="#h47-1-62" id="h47-1-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h47-1-63" id="h47-1-63" class="i">+                                            datatype: Float,
</a><a href="#h47-1-64" id="h47-1-64" class="i">+                                            primary_key: false,
</a><a href="#h47-1-65" id="h47-1-65" class="i">+                                            nullable: true,
</a><a href="#h47-1-66" id="h47-1-66" class="i">+                                            default: Some(
</a><a href="#h47-1-67" id="h47-1-67" class="i">+                                                Null,
</a><a href="#h47-1-68" id="h47-1-68" class="i">+                                            ),
</a><a href="#h47-1-69" id="h47-1-69" class="i">+                                            unique: false,
</a><a href="#h47-1-70" id="h47-1-70" class="i">+                                            references: None,
</a><a href="#h47-1-71" id="h47-1-71" class="i">+                                            index: false,
</a><a href="#h47-1-72" id="h47-1-72" class="i">+                                        },
</a><a href="#h47-1-73" id="h47-1-73" class="i">+                                        Column {
</a><a href="#h47-1-74" id="h47-1-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h47-1-75" id="h47-1-75" class="i">+                                            datatype: Boolean,
</a><a href="#h47-1-76" id="h47-1-76" class="i">+                                            primary_key: false,
</a><a href="#h47-1-77" id="h47-1-77" class="i">+                                            nullable: true,
</a><a href="#h47-1-78" id="h47-1-78" class="i">+                                            default: Some(
</a><a href="#h47-1-79" id="h47-1-79" class="i">+                                                Null,
</a><a href="#h47-1-80" id="h47-1-80" class="i">+                                            ),
</a><a href="#h47-1-81" id="h47-1-81" class="i">+                                            unique: false,
</a><a href="#h47-1-82" id="h47-1-82" class="i">+                                            references: None,
</a><a href="#h47-1-83" id="h47-1-83" class="i">+                                            index: false,
</a><a href="#h47-1-84" id="h47-1-84" class="i">+                                        },
</a><a href="#h47-1-85" id="h47-1-85" class="i">+                                    ],
</a><a href="#h47-1-86" id="h47-1-86" class="i">+                                },
</a>                                 alias: None,
                                 filter: None,
                             },
<b>diff --git a/<a id="h48" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -103,7 +103,89 @@ Plan: Select(
</a>                     source: Aggregation {
                         source: Projection {
                             source: Scan {
<a href="#h48-0-3" id="h48-0-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h48-0-4" id="h48-0-4" class="i">+                                table: Table {
</a><a href="#h48-0-5" id="h48-0-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h48-0-6" id="h48-0-6" class="i">+                                    columns: [
</a><a href="#h48-0-7" id="h48-0-7" class="i">+                                        Column {
</a><a href="#h48-0-8" id="h48-0-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h48-0-9" id="h48-0-9" class="i">+                                            datatype: Integer,
</a><a href="#h48-0-10" id="h48-0-10" class="i">+                                            primary_key: true,
</a><a href="#h48-0-11" id="h48-0-11" class="i">+                                            nullable: false,
</a><a href="#h48-0-12" id="h48-0-12" class="i">+                                            default: None,
</a><a href="#h48-0-13" id="h48-0-13" class="i">+                                            unique: true,
</a><a href="#h48-0-14" id="h48-0-14" class="i">+                                            references: None,
</a><a href="#h48-0-15" id="h48-0-15" class="i">+                                            index: false,
</a><a href="#h48-0-16" id="h48-0-16" class="i">+                                        },
</a><a href="#h48-0-17" id="h48-0-17" class="i">+                                        Column {
</a><a href="#h48-0-18" id="h48-0-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h48-0-19" id="h48-0-19" class="i">+                                            datatype: String,
</a><a href="#h48-0-20" id="h48-0-20" class="i">+                                            primary_key: false,
</a><a href="#h48-0-21" id="h48-0-21" class="i">+                                            nullable: false,
</a><a href="#h48-0-22" id="h48-0-22" class="i">+                                            default: None,
</a><a href="#h48-0-23" id="h48-0-23" class="i">+                                            unique: false,
</a><a href="#h48-0-24" id="h48-0-24" class="i">+                                            references: None,
</a><a href="#h48-0-25" id="h48-0-25" class="i">+                                            index: false,
</a><a href="#h48-0-26" id="h48-0-26" class="i">+                                        },
</a><a href="#h48-0-27" id="h48-0-27" class="i">+                                        Column {
</a><a href="#h48-0-28" id="h48-0-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h48-0-29" id="h48-0-29" class="i">+                                            datatype: Integer,
</a><a href="#h48-0-30" id="h48-0-30" class="i">+                                            primary_key: false,
</a><a href="#h48-0-31" id="h48-0-31" class="i">+                                            nullable: false,
</a><a href="#h48-0-32" id="h48-0-32" class="i">+                                            default: None,
</a><a href="#h48-0-33" id="h48-0-33" class="i">+                                            unique: false,
</a><a href="#h48-0-34" id="h48-0-34" class="i">+                                            references: Some(
</a><a href="#h48-0-35" id="h48-0-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h48-0-36" id="h48-0-36" class="i">+                                            ),
</a><a href="#h48-0-37" id="h48-0-37" class="i">+                                            index: true,
</a><a href="#h48-0-38" id="h48-0-38" class="i">+                                        },
</a><a href="#h48-0-39" id="h48-0-39" class="i">+                                        Column {
</a><a href="#h48-0-40" id="h48-0-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h48-0-41" id="h48-0-41" class="i">+                                            datatype: Integer,
</a><a href="#h48-0-42" id="h48-0-42" class="i">+                                            primary_key: false,
</a><a href="#h48-0-43" id="h48-0-43" class="i">+                                            nullable: false,
</a><a href="#h48-0-44" id="h48-0-44" class="i">+                                            default: None,
</a><a href="#h48-0-45" id="h48-0-45" class="i">+                                            unique: false,
</a><a href="#h48-0-46" id="h48-0-46" class="i">+                                            references: Some(
</a><a href="#h48-0-47" id="h48-0-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h48-0-48" id="h48-0-48" class="i">+                                            ),
</a><a href="#h48-0-49" id="h48-0-49" class="i">+                                            index: true,
</a><a href="#h48-0-50" id="h48-0-50" class="i">+                                        },
</a><a href="#h48-0-51" id="h48-0-51" class="i">+                                        Column {
</a><a href="#h48-0-52" id="h48-0-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h48-0-53" id="h48-0-53" class="i">+                                            datatype: Integer,
</a><a href="#h48-0-54" id="h48-0-54" class="i">+                                            primary_key: false,
</a><a href="#h48-0-55" id="h48-0-55" class="i">+                                            nullable: false,
</a><a href="#h48-0-56" id="h48-0-56" class="i">+                                            default: None,
</a><a href="#h48-0-57" id="h48-0-57" class="i">+                                            unique: false,
</a><a href="#h48-0-58" id="h48-0-58" class="i">+                                            references: None,
</a><a href="#h48-0-59" id="h48-0-59" class="i">+                                            index: false,
</a><a href="#h48-0-60" id="h48-0-60" class="i">+                                        },
</a><a href="#h48-0-61" id="h48-0-61" class="i">+                                        Column {
</a><a href="#h48-0-62" id="h48-0-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h48-0-63" id="h48-0-63" class="i">+                                            datatype: Float,
</a><a href="#h48-0-64" id="h48-0-64" class="i">+                                            primary_key: false,
</a><a href="#h48-0-65" id="h48-0-65" class="i">+                                            nullable: true,
</a><a href="#h48-0-66" id="h48-0-66" class="i">+                                            default: Some(
</a><a href="#h48-0-67" id="h48-0-67" class="i">+                                                Null,
</a><a href="#h48-0-68" id="h48-0-68" class="i">+                                            ),
</a><a href="#h48-0-69" id="h48-0-69" class="i">+                                            unique: false,
</a><a href="#h48-0-70" id="h48-0-70" class="i">+                                            references: None,
</a><a href="#h48-0-71" id="h48-0-71" class="i">+                                            index: false,
</a><a href="#h48-0-72" id="h48-0-72" class="i">+                                        },
</a><a href="#h48-0-73" id="h48-0-73" class="i">+                                        Column {
</a><a href="#h48-0-74" id="h48-0-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h48-0-75" id="h48-0-75" class="i">+                                            datatype: Boolean,
</a><a href="#h48-0-76" id="h48-0-76" class="i">+                                            primary_key: false,
</a><a href="#h48-0-77" id="h48-0-77" class="i">+                                            nullable: true,
</a><a href="#h48-0-78" id="h48-0-78" class="i">+                                            default: Some(
</a><a href="#h48-0-79" id="h48-0-79" class="i">+                                                Null,
</a><a href="#h48-0-80" id="h48-0-80" class="i">+                                            ),
</a><a href="#h48-0-81" id="h48-0-81" class="i">+                                            unique: false,
</a><a href="#h48-0-82" id="h48-0-82" class="i">+                                            references: None,
</a><a href="#h48-0-83" id="h48-0-83" class="i">+                                            index: false,
</a><a href="#h48-0-84" id="h48-0-84" class="i">+                                        },
</a><a href="#h48-0-85" id="h48-0-85" class="i">+                                    ],
</a><a href="#h48-0-86" id="h48-0-86" class="i">+                                },
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h48-1" id="h48-1" class="h">@@ -264,7 +346,89 @@ Optimized plan: Select(
</a>                     source: Aggregation {
                         source: Projection {
                             source: Scan {
<a href="#h48-1-3" id="h48-1-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h48-1-4" id="h48-1-4" class="i">+                                table: Table {
</a><a href="#h48-1-5" id="h48-1-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h48-1-6" id="h48-1-6" class="i">+                                    columns: [
</a><a href="#h48-1-7" id="h48-1-7" class="i">+                                        Column {
</a><a href="#h48-1-8" id="h48-1-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h48-1-9" id="h48-1-9" class="i">+                                            datatype: Integer,
</a><a href="#h48-1-10" id="h48-1-10" class="i">+                                            primary_key: true,
</a><a href="#h48-1-11" id="h48-1-11" class="i">+                                            nullable: false,
</a><a href="#h48-1-12" id="h48-1-12" class="i">+                                            default: None,
</a><a href="#h48-1-13" id="h48-1-13" class="i">+                                            unique: true,
</a><a href="#h48-1-14" id="h48-1-14" class="i">+                                            references: None,
</a><a href="#h48-1-15" id="h48-1-15" class="i">+                                            index: false,
</a><a href="#h48-1-16" id="h48-1-16" class="i">+                                        },
</a><a href="#h48-1-17" id="h48-1-17" class="i">+                                        Column {
</a><a href="#h48-1-18" id="h48-1-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h48-1-19" id="h48-1-19" class="i">+                                            datatype: String,
</a><a href="#h48-1-20" id="h48-1-20" class="i">+                                            primary_key: false,
</a><a href="#h48-1-21" id="h48-1-21" class="i">+                                            nullable: false,
</a><a href="#h48-1-22" id="h48-1-22" class="i">+                                            default: None,
</a><a href="#h48-1-23" id="h48-1-23" class="i">+                                            unique: false,
</a><a href="#h48-1-24" id="h48-1-24" class="i">+                                            references: None,
</a><a href="#h48-1-25" id="h48-1-25" class="i">+                                            index: false,
</a><a href="#h48-1-26" id="h48-1-26" class="i">+                                        },
</a><a href="#h48-1-27" id="h48-1-27" class="i">+                                        Column {
</a><a href="#h48-1-28" id="h48-1-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h48-1-29" id="h48-1-29" class="i">+                                            datatype: Integer,
</a><a href="#h48-1-30" id="h48-1-30" class="i">+                                            primary_key: false,
</a><a href="#h48-1-31" id="h48-1-31" class="i">+                                            nullable: false,
</a><a href="#h48-1-32" id="h48-1-32" class="i">+                                            default: None,
</a><a href="#h48-1-33" id="h48-1-33" class="i">+                                            unique: false,
</a><a href="#h48-1-34" id="h48-1-34" class="i">+                                            references: Some(
</a><a href="#h48-1-35" id="h48-1-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h48-1-36" id="h48-1-36" class="i">+                                            ),
</a><a href="#h48-1-37" id="h48-1-37" class="i">+                                            index: true,
</a><a href="#h48-1-38" id="h48-1-38" class="i">+                                        },
</a><a href="#h48-1-39" id="h48-1-39" class="i">+                                        Column {
</a><a href="#h48-1-40" id="h48-1-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h48-1-41" id="h48-1-41" class="i">+                                            datatype: Integer,
</a><a href="#h48-1-42" id="h48-1-42" class="i">+                                            primary_key: false,
</a><a href="#h48-1-43" id="h48-1-43" class="i">+                                            nullable: false,
</a><a href="#h48-1-44" id="h48-1-44" class="i">+                                            default: None,
</a><a href="#h48-1-45" id="h48-1-45" class="i">+                                            unique: false,
</a><a href="#h48-1-46" id="h48-1-46" class="i">+                                            references: Some(
</a><a href="#h48-1-47" id="h48-1-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h48-1-48" id="h48-1-48" class="i">+                                            ),
</a><a href="#h48-1-49" id="h48-1-49" class="i">+                                            index: true,
</a><a href="#h48-1-50" id="h48-1-50" class="i">+                                        },
</a><a href="#h48-1-51" id="h48-1-51" class="i">+                                        Column {
</a><a href="#h48-1-52" id="h48-1-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h48-1-53" id="h48-1-53" class="i">+                                            datatype: Integer,
</a><a href="#h48-1-54" id="h48-1-54" class="i">+                                            primary_key: false,
</a><a href="#h48-1-55" id="h48-1-55" class="i">+                                            nullable: false,
</a><a href="#h48-1-56" id="h48-1-56" class="i">+                                            default: None,
</a><a href="#h48-1-57" id="h48-1-57" class="i">+                                            unique: false,
</a><a href="#h48-1-58" id="h48-1-58" class="i">+                                            references: None,
</a><a href="#h48-1-59" id="h48-1-59" class="i">+                                            index: false,
</a><a href="#h48-1-60" id="h48-1-60" class="i">+                                        },
</a><a href="#h48-1-61" id="h48-1-61" class="i">+                                        Column {
</a><a href="#h48-1-62" id="h48-1-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h48-1-63" id="h48-1-63" class="i">+                                            datatype: Float,
</a><a href="#h48-1-64" id="h48-1-64" class="i">+                                            primary_key: false,
</a><a href="#h48-1-65" id="h48-1-65" class="i">+                                            nullable: true,
</a><a href="#h48-1-66" id="h48-1-66" class="i">+                                            default: Some(
</a><a href="#h48-1-67" id="h48-1-67" class="i">+                                                Null,
</a><a href="#h48-1-68" id="h48-1-68" class="i">+                                            ),
</a><a href="#h48-1-69" id="h48-1-69" class="i">+                                            unique: false,
</a><a href="#h48-1-70" id="h48-1-70" class="i">+                                            references: None,
</a><a href="#h48-1-71" id="h48-1-71" class="i">+                                            index: false,
</a><a href="#h48-1-72" id="h48-1-72" class="i">+                                        },
</a><a href="#h48-1-73" id="h48-1-73" class="i">+                                        Column {
</a><a href="#h48-1-74" id="h48-1-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h48-1-75" id="h48-1-75" class="i">+                                            datatype: Boolean,
</a><a href="#h48-1-76" id="h48-1-76" class="i">+                                            primary_key: false,
</a><a href="#h48-1-77" id="h48-1-77" class="i">+                                            nullable: true,
</a><a href="#h48-1-78" id="h48-1-78" class="i">+                                            default: Some(
</a><a href="#h48-1-79" id="h48-1-79" class="i">+                                                Null,
</a><a href="#h48-1-80" id="h48-1-80" class="i">+                                            ),
</a><a href="#h48-1-81" id="h48-1-81" class="i">+                                            unique: false,
</a><a href="#h48-1-82" id="h48-1-82" class="i">+                                            references: None,
</a><a href="#h48-1-83" id="h48-1-83" class="i">+                                            index: false,
</a><a href="#h48-1-84" id="h48-1-84" class="i">+                                        },
</a><a href="#h48-1-85" id="h48-1-85" class="i">+                                    ],
</a><a href="#h48-1-86" id="h48-1-86" class="i">+                                },
</a>                                 alias: None,
                                 filter: None,
                             },
<b>diff --git a/<a id="h49" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -86,7 +86,89 @@ Plan: Select(
</a>                     source: Aggregation {
                         source: Projection {
                             source: Scan {
<a href="#h49-0-3" id="h49-0-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h49-0-4" id="h49-0-4" class="i">+                                table: Table {
</a><a href="#h49-0-5" id="h49-0-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h49-0-6" id="h49-0-6" class="i">+                                    columns: [
</a><a href="#h49-0-7" id="h49-0-7" class="i">+                                        Column {
</a><a href="#h49-0-8" id="h49-0-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h49-0-9" id="h49-0-9" class="i">+                                            datatype: Integer,
</a><a href="#h49-0-10" id="h49-0-10" class="i">+                                            primary_key: true,
</a><a href="#h49-0-11" id="h49-0-11" class="i">+                                            nullable: false,
</a><a href="#h49-0-12" id="h49-0-12" class="i">+                                            default: None,
</a><a href="#h49-0-13" id="h49-0-13" class="i">+                                            unique: true,
</a><a href="#h49-0-14" id="h49-0-14" class="i">+                                            references: None,
</a><a href="#h49-0-15" id="h49-0-15" class="i">+                                            index: false,
</a><a href="#h49-0-16" id="h49-0-16" class="i">+                                        },
</a><a href="#h49-0-17" id="h49-0-17" class="i">+                                        Column {
</a><a href="#h49-0-18" id="h49-0-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h49-0-19" id="h49-0-19" class="i">+                                            datatype: String,
</a><a href="#h49-0-20" id="h49-0-20" class="i">+                                            primary_key: false,
</a><a href="#h49-0-21" id="h49-0-21" class="i">+                                            nullable: false,
</a><a href="#h49-0-22" id="h49-0-22" class="i">+                                            default: None,
</a><a href="#h49-0-23" id="h49-0-23" class="i">+                                            unique: false,
</a><a href="#h49-0-24" id="h49-0-24" class="i">+                                            references: None,
</a><a href="#h49-0-25" id="h49-0-25" class="i">+                                            index: false,
</a><a href="#h49-0-26" id="h49-0-26" class="i">+                                        },
</a><a href="#h49-0-27" id="h49-0-27" class="i">+                                        Column {
</a><a href="#h49-0-28" id="h49-0-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h49-0-29" id="h49-0-29" class="i">+                                            datatype: Integer,
</a><a href="#h49-0-30" id="h49-0-30" class="i">+                                            primary_key: false,
</a><a href="#h49-0-31" id="h49-0-31" class="i">+                                            nullable: false,
</a><a href="#h49-0-32" id="h49-0-32" class="i">+                                            default: None,
</a><a href="#h49-0-33" id="h49-0-33" class="i">+                                            unique: false,
</a><a href="#h49-0-34" id="h49-0-34" class="i">+                                            references: Some(
</a><a href="#h49-0-35" id="h49-0-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h49-0-36" id="h49-0-36" class="i">+                                            ),
</a><a href="#h49-0-37" id="h49-0-37" class="i">+                                            index: true,
</a><a href="#h49-0-38" id="h49-0-38" class="i">+                                        },
</a><a href="#h49-0-39" id="h49-0-39" class="i">+                                        Column {
</a><a href="#h49-0-40" id="h49-0-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h49-0-41" id="h49-0-41" class="i">+                                            datatype: Integer,
</a><a href="#h49-0-42" id="h49-0-42" class="i">+                                            primary_key: false,
</a><a href="#h49-0-43" id="h49-0-43" class="i">+                                            nullable: false,
</a><a href="#h49-0-44" id="h49-0-44" class="i">+                                            default: None,
</a><a href="#h49-0-45" id="h49-0-45" class="i">+                                            unique: false,
</a><a href="#h49-0-46" id="h49-0-46" class="i">+                                            references: Some(
</a><a href="#h49-0-47" id="h49-0-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h49-0-48" id="h49-0-48" class="i">+                                            ),
</a><a href="#h49-0-49" id="h49-0-49" class="i">+                                            index: true,
</a><a href="#h49-0-50" id="h49-0-50" class="i">+                                        },
</a><a href="#h49-0-51" id="h49-0-51" class="i">+                                        Column {
</a><a href="#h49-0-52" id="h49-0-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h49-0-53" id="h49-0-53" class="i">+                                            datatype: Integer,
</a><a href="#h49-0-54" id="h49-0-54" class="i">+                                            primary_key: false,
</a><a href="#h49-0-55" id="h49-0-55" class="i">+                                            nullable: false,
</a><a href="#h49-0-56" id="h49-0-56" class="i">+                                            default: None,
</a><a href="#h49-0-57" id="h49-0-57" class="i">+                                            unique: false,
</a><a href="#h49-0-58" id="h49-0-58" class="i">+                                            references: None,
</a><a href="#h49-0-59" id="h49-0-59" class="i">+                                            index: false,
</a><a href="#h49-0-60" id="h49-0-60" class="i">+                                        },
</a><a href="#h49-0-61" id="h49-0-61" class="i">+                                        Column {
</a><a href="#h49-0-62" id="h49-0-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h49-0-63" id="h49-0-63" class="i">+                                            datatype: Float,
</a><a href="#h49-0-64" id="h49-0-64" class="i">+                                            primary_key: false,
</a><a href="#h49-0-65" id="h49-0-65" class="i">+                                            nullable: true,
</a><a href="#h49-0-66" id="h49-0-66" class="i">+                                            default: Some(
</a><a href="#h49-0-67" id="h49-0-67" class="i">+                                                Null,
</a><a href="#h49-0-68" id="h49-0-68" class="i">+                                            ),
</a><a href="#h49-0-69" id="h49-0-69" class="i">+                                            unique: false,
</a><a href="#h49-0-70" id="h49-0-70" class="i">+                                            references: None,
</a><a href="#h49-0-71" id="h49-0-71" class="i">+                                            index: false,
</a><a href="#h49-0-72" id="h49-0-72" class="i">+                                        },
</a><a href="#h49-0-73" id="h49-0-73" class="i">+                                        Column {
</a><a href="#h49-0-74" id="h49-0-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h49-0-75" id="h49-0-75" class="i">+                                            datatype: Boolean,
</a><a href="#h49-0-76" id="h49-0-76" class="i">+                                            primary_key: false,
</a><a href="#h49-0-77" id="h49-0-77" class="i">+                                            nullable: true,
</a><a href="#h49-0-78" id="h49-0-78" class="i">+                                            default: Some(
</a><a href="#h49-0-79" id="h49-0-79" class="i">+                                                Null,
</a><a href="#h49-0-80" id="h49-0-80" class="i">+                                            ),
</a><a href="#h49-0-81" id="h49-0-81" class="i">+                                            unique: false,
</a><a href="#h49-0-82" id="h49-0-82" class="i">+                                            references: None,
</a><a href="#h49-0-83" id="h49-0-83" class="i">+                                            index: false,
</a><a href="#h49-0-84" id="h49-0-84" class="i">+                                        },
</a><a href="#h49-0-85" id="h49-0-85" class="i">+                                    ],
</a><a href="#h49-0-86" id="h49-0-86" class="i">+                                },
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h49-1" id="h49-1" class="h">@@ -242,7 +324,89 @@ Optimized plan: Select(
</a>                     source: Aggregation {
                         source: Projection {
                             source: Scan {
<a href="#h49-1-3" id="h49-1-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h49-1-4" id="h49-1-4" class="i">+                                table: Table {
</a><a href="#h49-1-5" id="h49-1-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h49-1-6" id="h49-1-6" class="i">+                                    columns: [
</a><a href="#h49-1-7" id="h49-1-7" class="i">+                                        Column {
</a><a href="#h49-1-8" id="h49-1-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h49-1-9" id="h49-1-9" class="i">+                                            datatype: Integer,
</a><a href="#h49-1-10" id="h49-1-10" class="i">+                                            primary_key: true,
</a><a href="#h49-1-11" id="h49-1-11" class="i">+                                            nullable: false,
</a><a href="#h49-1-12" id="h49-1-12" class="i">+                                            default: None,
</a><a href="#h49-1-13" id="h49-1-13" class="i">+                                            unique: true,
</a><a href="#h49-1-14" id="h49-1-14" class="i">+                                            references: None,
</a><a href="#h49-1-15" id="h49-1-15" class="i">+                                            index: false,
</a><a href="#h49-1-16" id="h49-1-16" class="i">+                                        },
</a><a href="#h49-1-17" id="h49-1-17" class="i">+                                        Column {
</a><a href="#h49-1-18" id="h49-1-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h49-1-19" id="h49-1-19" class="i">+                                            datatype: String,
</a><a href="#h49-1-20" id="h49-1-20" class="i">+                                            primary_key: false,
</a><a href="#h49-1-21" id="h49-1-21" class="i">+                                            nullable: false,
</a><a href="#h49-1-22" id="h49-1-22" class="i">+                                            default: None,
</a><a href="#h49-1-23" id="h49-1-23" class="i">+                                            unique: false,
</a><a href="#h49-1-24" id="h49-1-24" class="i">+                                            references: None,
</a><a href="#h49-1-25" id="h49-1-25" class="i">+                                            index: false,
</a><a href="#h49-1-26" id="h49-1-26" class="i">+                                        },
</a><a href="#h49-1-27" id="h49-1-27" class="i">+                                        Column {
</a><a href="#h49-1-28" id="h49-1-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h49-1-29" id="h49-1-29" class="i">+                                            datatype: Integer,
</a><a href="#h49-1-30" id="h49-1-30" class="i">+                                            primary_key: false,
</a><a href="#h49-1-31" id="h49-1-31" class="i">+                                            nullable: false,
</a><a href="#h49-1-32" id="h49-1-32" class="i">+                                            default: None,
</a><a href="#h49-1-33" id="h49-1-33" class="i">+                                            unique: false,
</a><a href="#h49-1-34" id="h49-1-34" class="i">+                                            references: Some(
</a><a href="#h49-1-35" id="h49-1-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h49-1-36" id="h49-1-36" class="i">+                                            ),
</a><a href="#h49-1-37" id="h49-1-37" class="i">+                                            index: true,
</a><a href="#h49-1-38" id="h49-1-38" class="i">+                                        },
</a><a href="#h49-1-39" id="h49-1-39" class="i">+                                        Column {
</a><a href="#h49-1-40" id="h49-1-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h49-1-41" id="h49-1-41" class="i">+                                            datatype: Integer,
</a><a href="#h49-1-42" id="h49-1-42" class="i">+                                            primary_key: false,
</a><a href="#h49-1-43" id="h49-1-43" class="i">+                                            nullable: false,
</a><a href="#h49-1-44" id="h49-1-44" class="i">+                                            default: None,
</a><a href="#h49-1-45" id="h49-1-45" class="i">+                                            unique: false,
</a><a href="#h49-1-46" id="h49-1-46" class="i">+                                            references: Some(
</a><a href="#h49-1-47" id="h49-1-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h49-1-48" id="h49-1-48" class="i">+                                            ),
</a><a href="#h49-1-49" id="h49-1-49" class="i">+                                            index: true,
</a><a href="#h49-1-50" id="h49-1-50" class="i">+                                        },
</a><a href="#h49-1-51" id="h49-1-51" class="i">+                                        Column {
</a><a href="#h49-1-52" id="h49-1-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h49-1-53" id="h49-1-53" class="i">+                                            datatype: Integer,
</a><a href="#h49-1-54" id="h49-1-54" class="i">+                                            primary_key: false,
</a><a href="#h49-1-55" id="h49-1-55" class="i">+                                            nullable: false,
</a><a href="#h49-1-56" id="h49-1-56" class="i">+                                            default: None,
</a><a href="#h49-1-57" id="h49-1-57" class="i">+                                            unique: false,
</a><a href="#h49-1-58" id="h49-1-58" class="i">+                                            references: None,
</a><a href="#h49-1-59" id="h49-1-59" class="i">+                                            index: false,
</a><a href="#h49-1-60" id="h49-1-60" class="i">+                                        },
</a><a href="#h49-1-61" id="h49-1-61" class="i">+                                        Column {
</a><a href="#h49-1-62" id="h49-1-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h49-1-63" id="h49-1-63" class="i">+                                            datatype: Float,
</a><a href="#h49-1-64" id="h49-1-64" class="i">+                                            primary_key: false,
</a><a href="#h49-1-65" id="h49-1-65" class="i">+                                            nullable: true,
</a><a href="#h49-1-66" id="h49-1-66" class="i">+                                            default: Some(
</a><a href="#h49-1-67" id="h49-1-67" class="i">+                                                Null,
</a><a href="#h49-1-68" id="h49-1-68" class="i">+                                            ),
</a><a href="#h49-1-69" id="h49-1-69" class="i">+                                            unique: false,
</a><a href="#h49-1-70" id="h49-1-70" class="i">+                                            references: None,
</a><a href="#h49-1-71" id="h49-1-71" class="i">+                                            index: false,
</a><a href="#h49-1-72" id="h49-1-72" class="i">+                                        },
</a><a href="#h49-1-73" id="h49-1-73" class="i">+                                        Column {
</a><a href="#h49-1-74" id="h49-1-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h49-1-75" id="h49-1-75" class="i">+                                            datatype: Boolean,
</a><a href="#h49-1-76" id="h49-1-76" class="i">+                                            primary_key: false,
</a><a href="#h49-1-77" id="h49-1-77" class="i">+                                            nullable: true,
</a><a href="#h49-1-78" id="h49-1-78" class="i">+                                            default: Some(
</a><a href="#h49-1-79" id="h49-1-79" class="i">+                                                Null,
</a><a href="#h49-1-80" id="h49-1-80" class="i">+                                            ),
</a><a href="#h49-1-81" id="h49-1-81" class="i">+                                            unique: false,
</a><a href="#h49-1-82" id="h49-1-82" class="i">+                                            references: None,
</a><a href="#h49-1-83" id="h49-1-83" class="i">+                                            index: false,
</a><a href="#h49-1-84" id="h49-1-84" class="i">+                                        },
</a><a href="#h49-1-85" id="h49-1-85" class="i">+                                    ],
</a><a href="#h49-1-86" id="h49-1-86" class="i">+                                },
</a>                                 alias: None,
                                 filter: None,
                             },
<b>diff --git a/<a id="h50" href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a> b/<a href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -72,7 +72,89 @@ Plan: Select(
</a>             source: Filter {
                 source: Projection {
                     source: Scan {
<a href="#h50-0-3" id="h50-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h50-0-4" id="h50-0-4" class="i">+                        table: Table {
</a><a href="#h50-0-5" id="h50-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h50-0-6" id="h50-0-6" class="i">+                            columns: [
</a><a href="#h50-0-7" id="h50-0-7" class="i">+                                Column {
</a><a href="#h50-0-8" id="h50-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h50-0-9" id="h50-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h50-0-10" id="h50-0-10" class="i">+                                    primary_key: true,
</a><a href="#h50-0-11" id="h50-0-11" class="i">+                                    nullable: false,
</a><a href="#h50-0-12" id="h50-0-12" class="i">+                                    default: None,
</a><a href="#h50-0-13" id="h50-0-13" class="i">+                                    unique: true,
</a><a href="#h50-0-14" id="h50-0-14" class="i">+                                    references: None,
</a><a href="#h50-0-15" id="h50-0-15" class="i">+                                    index: false,
</a><a href="#h50-0-16" id="h50-0-16" class="i">+                                },
</a><a href="#h50-0-17" id="h50-0-17" class="i">+                                Column {
</a><a href="#h50-0-18" id="h50-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h50-0-19" id="h50-0-19" class="i">+                                    datatype: String,
</a><a href="#h50-0-20" id="h50-0-20" class="i">+                                    primary_key: false,
</a><a href="#h50-0-21" id="h50-0-21" class="i">+                                    nullable: false,
</a><a href="#h50-0-22" id="h50-0-22" class="i">+                                    default: None,
</a><a href="#h50-0-23" id="h50-0-23" class="i">+                                    unique: false,
</a><a href="#h50-0-24" id="h50-0-24" class="i">+                                    references: None,
</a><a href="#h50-0-25" id="h50-0-25" class="i">+                                    index: false,
</a><a href="#h50-0-26" id="h50-0-26" class="i">+                                },
</a><a href="#h50-0-27" id="h50-0-27" class="i">+                                Column {
</a><a href="#h50-0-28" id="h50-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h50-0-29" id="h50-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h50-0-30" id="h50-0-30" class="i">+                                    primary_key: false,
</a><a href="#h50-0-31" id="h50-0-31" class="i">+                                    nullable: false,
</a><a href="#h50-0-32" id="h50-0-32" class="i">+                                    default: None,
</a><a href="#h50-0-33" id="h50-0-33" class="i">+                                    unique: false,
</a><a href="#h50-0-34" id="h50-0-34" class="i">+                                    references: Some(
</a><a href="#h50-0-35" id="h50-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h50-0-36" id="h50-0-36" class="i">+                                    ),
</a><a href="#h50-0-37" id="h50-0-37" class="i">+                                    index: true,
</a><a href="#h50-0-38" id="h50-0-38" class="i">+                                },
</a><a href="#h50-0-39" id="h50-0-39" class="i">+                                Column {
</a><a href="#h50-0-40" id="h50-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h50-0-41" id="h50-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h50-0-42" id="h50-0-42" class="i">+                                    primary_key: false,
</a><a href="#h50-0-43" id="h50-0-43" class="i">+                                    nullable: false,
</a><a href="#h50-0-44" id="h50-0-44" class="i">+                                    default: None,
</a><a href="#h50-0-45" id="h50-0-45" class="i">+                                    unique: false,
</a><a href="#h50-0-46" id="h50-0-46" class="i">+                                    references: Some(
</a><a href="#h50-0-47" id="h50-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h50-0-48" id="h50-0-48" class="i">+                                    ),
</a><a href="#h50-0-49" id="h50-0-49" class="i">+                                    index: true,
</a><a href="#h50-0-50" id="h50-0-50" class="i">+                                },
</a><a href="#h50-0-51" id="h50-0-51" class="i">+                                Column {
</a><a href="#h50-0-52" id="h50-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h50-0-53" id="h50-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h50-0-54" id="h50-0-54" class="i">+                                    primary_key: false,
</a><a href="#h50-0-55" id="h50-0-55" class="i">+                                    nullable: false,
</a><a href="#h50-0-56" id="h50-0-56" class="i">+                                    default: None,
</a><a href="#h50-0-57" id="h50-0-57" class="i">+                                    unique: false,
</a><a href="#h50-0-58" id="h50-0-58" class="i">+                                    references: None,
</a><a href="#h50-0-59" id="h50-0-59" class="i">+                                    index: false,
</a><a href="#h50-0-60" id="h50-0-60" class="i">+                                },
</a><a href="#h50-0-61" id="h50-0-61" class="i">+                                Column {
</a><a href="#h50-0-62" id="h50-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h50-0-63" id="h50-0-63" class="i">+                                    datatype: Float,
</a><a href="#h50-0-64" id="h50-0-64" class="i">+                                    primary_key: false,
</a><a href="#h50-0-65" id="h50-0-65" class="i">+                                    nullable: true,
</a><a href="#h50-0-66" id="h50-0-66" class="i">+                                    default: Some(
</a><a href="#h50-0-67" id="h50-0-67" class="i">+                                        Null,
</a><a href="#h50-0-68" id="h50-0-68" class="i">+                                    ),
</a><a href="#h50-0-69" id="h50-0-69" class="i">+                                    unique: false,
</a><a href="#h50-0-70" id="h50-0-70" class="i">+                                    references: None,
</a><a href="#h50-0-71" id="h50-0-71" class="i">+                                    index: false,
</a><a href="#h50-0-72" id="h50-0-72" class="i">+                                },
</a><a href="#h50-0-73" id="h50-0-73" class="i">+                                Column {
</a><a href="#h50-0-74" id="h50-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h50-0-75" id="h50-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h50-0-76" id="h50-0-76" class="i">+                                    primary_key: false,
</a><a href="#h50-0-77" id="h50-0-77" class="i">+                                    nullable: true,
</a><a href="#h50-0-78" id="h50-0-78" class="i">+                                    default: Some(
</a><a href="#h50-0-79" id="h50-0-79" class="i">+                                        Null,
</a><a href="#h50-0-80" id="h50-0-80" class="i">+                                    ),
</a><a href="#h50-0-81" id="h50-0-81" class="i">+                                    unique: false,
</a><a href="#h50-0-82" id="h50-0-82" class="i">+                                    references: None,
</a><a href="#h50-0-83" id="h50-0-83" class="i">+                                    index: false,
</a><a href="#h50-0-84" id="h50-0-84" class="i">+                                },
</a><a href="#h50-0-85" id="h50-0-85" class="i">+                            ],
</a><a href="#h50-0-86" id="h50-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h50-1" id="h50-1" class="h">@@ -176,7 +258,89 @@ Optimized plan: Select(
</a>             source: Filter {
                 source: Projection {
                     source: Scan {
<a href="#h50-1-3" id="h50-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h50-1-4" id="h50-1-4" class="i">+                        table: Table {
</a><a href="#h50-1-5" id="h50-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h50-1-6" id="h50-1-6" class="i">+                            columns: [
</a><a href="#h50-1-7" id="h50-1-7" class="i">+                                Column {
</a><a href="#h50-1-8" id="h50-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h50-1-9" id="h50-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h50-1-10" id="h50-1-10" class="i">+                                    primary_key: true,
</a><a href="#h50-1-11" id="h50-1-11" class="i">+                                    nullable: false,
</a><a href="#h50-1-12" id="h50-1-12" class="i">+                                    default: None,
</a><a href="#h50-1-13" id="h50-1-13" class="i">+                                    unique: true,
</a><a href="#h50-1-14" id="h50-1-14" class="i">+                                    references: None,
</a><a href="#h50-1-15" id="h50-1-15" class="i">+                                    index: false,
</a><a href="#h50-1-16" id="h50-1-16" class="i">+                                },
</a><a href="#h50-1-17" id="h50-1-17" class="i">+                                Column {
</a><a href="#h50-1-18" id="h50-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h50-1-19" id="h50-1-19" class="i">+                                    datatype: String,
</a><a href="#h50-1-20" id="h50-1-20" class="i">+                                    primary_key: false,
</a><a href="#h50-1-21" id="h50-1-21" class="i">+                                    nullable: false,
</a><a href="#h50-1-22" id="h50-1-22" class="i">+                                    default: None,
</a><a href="#h50-1-23" id="h50-1-23" class="i">+                                    unique: false,
</a><a href="#h50-1-24" id="h50-1-24" class="i">+                                    references: None,
</a><a href="#h50-1-25" id="h50-1-25" class="i">+                                    index: false,
</a><a href="#h50-1-26" id="h50-1-26" class="i">+                                },
</a><a href="#h50-1-27" id="h50-1-27" class="i">+                                Column {
</a><a href="#h50-1-28" id="h50-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h50-1-29" id="h50-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h50-1-30" id="h50-1-30" class="i">+                                    primary_key: false,
</a><a href="#h50-1-31" id="h50-1-31" class="i">+                                    nullable: false,
</a><a href="#h50-1-32" id="h50-1-32" class="i">+                                    default: None,
</a><a href="#h50-1-33" id="h50-1-33" class="i">+                                    unique: false,
</a><a href="#h50-1-34" id="h50-1-34" class="i">+                                    references: Some(
</a><a href="#h50-1-35" id="h50-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h50-1-36" id="h50-1-36" class="i">+                                    ),
</a><a href="#h50-1-37" id="h50-1-37" class="i">+                                    index: true,
</a><a href="#h50-1-38" id="h50-1-38" class="i">+                                },
</a><a href="#h50-1-39" id="h50-1-39" class="i">+                                Column {
</a><a href="#h50-1-40" id="h50-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h50-1-41" id="h50-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h50-1-42" id="h50-1-42" class="i">+                                    primary_key: false,
</a><a href="#h50-1-43" id="h50-1-43" class="i">+                                    nullable: false,
</a><a href="#h50-1-44" id="h50-1-44" class="i">+                                    default: None,
</a><a href="#h50-1-45" id="h50-1-45" class="i">+                                    unique: false,
</a><a href="#h50-1-46" id="h50-1-46" class="i">+                                    references: Some(
</a><a href="#h50-1-47" id="h50-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h50-1-48" id="h50-1-48" class="i">+                                    ),
</a><a href="#h50-1-49" id="h50-1-49" class="i">+                                    index: true,
</a><a href="#h50-1-50" id="h50-1-50" class="i">+                                },
</a><a href="#h50-1-51" id="h50-1-51" class="i">+                                Column {
</a><a href="#h50-1-52" id="h50-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h50-1-53" id="h50-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h50-1-54" id="h50-1-54" class="i">+                                    primary_key: false,
</a><a href="#h50-1-55" id="h50-1-55" class="i">+                                    nullable: false,
</a><a href="#h50-1-56" id="h50-1-56" class="i">+                                    default: None,
</a><a href="#h50-1-57" id="h50-1-57" class="i">+                                    unique: false,
</a><a href="#h50-1-58" id="h50-1-58" class="i">+                                    references: None,
</a><a href="#h50-1-59" id="h50-1-59" class="i">+                                    index: false,
</a><a href="#h50-1-60" id="h50-1-60" class="i">+                                },
</a><a href="#h50-1-61" id="h50-1-61" class="i">+                                Column {
</a><a href="#h50-1-62" id="h50-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h50-1-63" id="h50-1-63" class="i">+                                    datatype: Float,
</a><a href="#h50-1-64" id="h50-1-64" class="i">+                                    primary_key: false,
</a><a href="#h50-1-65" id="h50-1-65" class="i">+                                    nullable: true,
</a><a href="#h50-1-66" id="h50-1-66" class="i">+                                    default: Some(
</a><a href="#h50-1-67" id="h50-1-67" class="i">+                                        Null,
</a><a href="#h50-1-68" id="h50-1-68" class="i">+                                    ),
</a><a href="#h50-1-69" id="h50-1-69" class="i">+                                    unique: false,
</a><a href="#h50-1-70" id="h50-1-70" class="i">+                                    references: None,
</a><a href="#h50-1-71" id="h50-1-71" class="i">+                                    index: false,
</a><a href="#h50-1-72" id="h50-1-72" class="i">+                                },
</a><a href="#h50-1-73" id="h50-1-73" class="i">+                                Column {
</a><a href="#h50-1-74" id="h50-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h50-1-75" id="h50-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h50-1-76" id="h50-1-76" class="i">+                                    primary_key: false,
</a><a href="#h50-1-77" id="h50-1-77" class="i">+                                    nullable: true,
</a><a href="#h50-1-78" id="h50-1-78" class="i">+                                    default: Some(
</a><a href="#h50-1-79" id="h50-1-79" class="i">+                                        Null,
</a><a href="#h50-1-80" id="h50-1-80" class="i">+                                    ),
</a><a href="#h50-1-81" id="h50-1-81" class="i">+                                    unique: false,
</a><a href="#h50-1-82" id="h50-1-82" class="i">+                                    references: None,
</a><a href="#h50-1-83" id="h50-1-83" class="i">+                                    index: false,
</a><a href="#h50-1-84" id="h50-1-84" class="i">+                                },
</a><a href="#h50-1-85" id="h50-1-85" class="i">+                            ],
</a><a href="#h50-1-86" id="h50-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h51" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -77,7 +77,89 @@ Plan: Select(
</a>                     source: Aggregation {
                         source: Projection {
                             source: Scan {
<a href="#h51-0-3" id="h51-0-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h51-0-4" id="h51-0-4" class="i">+                                table: Table {
</a><a href="#h51-0-5" id="h51-0-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h51-0-6" id="h51-0-6" class="i">+                                    columns: [
</a><a href="#h51-0-7" id="h51-0-7" class="i">+                                        Column {
</a><a href="#h51-0-8" id="h51-0-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h51-0-9" id="h51-0-9" class="i">+                                            datatype: Integer,
</a><a href="#h51-0-10" id="h51-0-10" class="i">+                                            primary_key: true,
</a><a href="#h51-0-11" id="h51-0-11" class="i">+                                            nullable: false,
</a><a href="#h51-0-12" id="h51-0-12" class="i">+                                            default: None,
</a><a href="#h51-0-13" id="h51-0-13" class="i">+                                            unique: true,
</a><a href="#h51-0-14" id="h51-0-14" class="i">+                                            references: None,
</a><a href="#h51-0-15" id="h51-0-15" class="i">+                                            index: false,
</a><a href="#h51-0-16" id="h51-0-16" class="i">+                                        },
</a><a href="#h51-0-17" id="h51-0-17" class="i">+                                        Column {
</a><a href="#h51-0-18" id="h51-0-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h51-0-19" id="h51-0-19" class="i">+                                            datatype: String,
</a><a href="#h51-0-20" id="h51-0-20" class="i">+                                            primary_key: false,
</a><a href="#h51-0-21" id="h51-0-21" class="i">+                                            nullable: false,
</a><a href="#h51-0-22" id="h51-0-22" class="i">+                                            default: None,
</a><a href="#h51-0-23" id="h51-0-23" class="i">+                                            unique: false,
</a><a href="#h51-0-24" id="h51-0-24" class="i">+                                            references: None,
</a><a href="#h51-0-25" id="h51-0-25" class="i">+                                            index: false,
</a><a href="#h51-0-26" id="h51-0-26" class="i">+                                        },
</a><a href="#h51-0-27" id="h51-0-27" class="i">+                                        Column {
</a><a href="#h51-0-28" id="h51-0-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h51-0-29" id="h51-0-29" class="i">+                                            datatype: Integer,
</a><a href="#h51-0-30" id="h51-0-30" class="i">+                                            primary_key: false,
</a><a href="#h51-0-31" id="h51-0-31" class="i">+                                            nullable: false,
</a><a href="#h51-0-32" id="h51-0-32" class="i">+                                            default: None,
</a><a href="#h51-0-33" id="h51-0-33" class="i">+                                            unique: false,
</a><a href="#h51-0-34" id="h51-0-34" class="i">+                                            references: Some(
</a><a href="#h51-0-35" id="h51-0-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h51-0-36" id="h51-0-36" class="i">+                                            ),
</a><a href="#h51-0-37" id="h51-0-37" class="i">+                                            index: true,
</a><a href="#h51-0-38" id="h51-0-38" class="i">+                                        },
</a><a href="#h51-0-39" id="h51-0-39" class="i">+                                        Column {
</a><a href="#h51-0-40" id="h51-0-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h51-0-41" id="h51-0-41" class="i">+                                            datatype: Integer,
</a><a href="#h51-0-42" id="h51-0-42" class="i">+                                            primary_key: false,
</a><a href="#h51-0-43" id="h51-0-43" class="i">+                                            nullable: false,
</a><a href="#h51-0-44" id="h51-0-44" class="i">+                                            default: None,
</a><a href="#h51-0-45" id="h51-0-45" class="i">+                                            unique: false,
</a><a href="#h51-0-46" id="h51-0-46" class="i">+                                            references: Some(
</a><a href="#h51-0-47" id="h51-0-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h51-0-48" id="h51-0-48" class="i">+                                            ),
</a><a href="#h51-0-49" id="h51-0-49" class="i">+                                            index: true,
</a><a href="#h51-0-50" id="h51-0-50" class="i">+                                        },
</a><a href="#h51-0-51" id="h51-0-51" class="i">+                                        Column {
</a><a href="#h51-0-52" id="h51-0-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h51-0-53" id="h51-0-53" class="i">+                                            datatype: Integer,
</a><a href="#h51-0-54" id="h51-0-54" class="i">+                                            primary_key: false,
</a><a href="#h51-0-55" id="h51-0-55" class="i">+                                            nullable: false,
</a><a href="#h51-0-56" id="h51-0-56" class="i">+                                            default: None,
</a><a href="#h51-0-57" id="h51-0-57" class="i">+                                            unique: false,
</a><a href="#h51-0-58" id="h51-0-58" class="i">+                                            references: None,
</a><a href="#h51-0-59" id="h51-0-59" class="i">+                                            index: false,
</a><a href="#h51-0-60" id="h51-0-60" class="i">+                                        },
</a><a href="#h51-0-61" id="h51-0-61" class="i">+                                        Column {
</a><a href="#h51-0-62" id="h51-0-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h51-0-63" id="h51-0-63" class="i">+                                            datatype: Float,
</a><a href="#h51-0-64" id="h51-0-64" class="i">+                                            primary_key: false,
</a><a href="#h51-0-65" id="h51-0-65" class="i">+                                            nullable: true,
</a><a href="#h51-0-66" id="h51-0-66" class="i">+                                            default: Some(
</a><a href="#h51-0-67" id="h51-0-67" class="i">+                                                Null,
</a><a href="#h51-0-68" id="h51-0-68" class="i">+                                            ),
</a><a href="#h51-0-69" id="h51-0-69" class="i">+                                            unique: false,
</a><a href="#h51-0-70" id="h51-0-70" class="i">+                                            references: None,
</a><a href="#h51-0-71" id="h51-0-71" class="i">+                                            index: false,
</a><a href="#h51-0-72" id="h51-0-72" class="i">+                                        },
</a><a href="#h51-0-73" id="h51-0-73" class="i">+                                        Column {
</a><a href="#h51-0-74" id="h51-0-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h51-0-75" id="h51-0-75" class="i">+                                            datatype: Boolean,
</a><a href="#h51-0-76" id="h51-0-76" class="i">+                                            primary_key: false,
</a><a href="#h51-0-77" id="h51-0-77" class="i">+                                            nullable: true,
</a><a href="#h51-0-78" id="h51-0-78" class="i">+                                            default: Some(
</a><a href="#h51-0-79" id="h51-0-79" class="i">+                                                Null,
</a><a href="#h51-0-80" id="h51-0-80" class="i">+                                            ),
</a><a href="#h51-0-81" id="h51-0-81" class="i">+                                            unique: false,
</a><a href="#h51-0-82" id="h51-0-82" class="i">+                                            references: None,
</a><a href="#h51-0-83" id="h51-0-83" class="i">+                                            index: false,
</a><a href="#h51-0-84" id="h51-0-84" class="i">+                                        },
</a><a href="#h51-0-85" id="h51-0-85" class="i">+                                    ],
</a><a href="#h51-0-86" id="h51-0-86" class="i">+                                },
</a>                                 alias: None,
                                 filter: None,
                             },
<a href="#h51-1" id="h51-1" class="h">@@ -185,7 +267,89 @@ Optimized plan: Select(
</a>                     source: Aggregation {
                         source: Projection {
                             source: Scan {
<a href="#h51-1-3" id="h51-1-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h51-1-4" id="h51-1-4" class="i">+                                table: Table {
</a><a href="#h51-1-5" id="h51-1-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h51-1-6" id="h51-1-6" class="i">+                                    columns: [
</a><a href="#h51-1-7" id="h51-1-7" class="i">+                                        Column {
</a><a href="#h51-1-8" id="h51-1-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h51-1-9" id="h51-1-9" class="i">+                                            datatype: Integer,
</a><a href="#h51-1-10" id="h51-1-10" class="i">+                                            primary_key: true,
</a><a href="#h51-1-11" id="h51-1-11" class="i">+                                            nullable: false,
</a><a href="#h51-1-12" id="h51-1-12" class="i">+                                            default: None,
</a><a href="#h51-1-13" id="h51-1-13" class="i">+                                            unique: true,
</a><a href="#h51-1-14" id="h51-1-14" class="i">+                                            references: None,
</a><a href="#h51-1-15" id="h51-1-15" class="i">+                                            index: false,
</a><a href="#h51-1-16" id="h51-1-16" class="i">+                                        },
</a><a href="#h51-1-17" id="h51-1-17" class="i">+                                        Column {
</a><a href="#h51-1-18" id="h51-1-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h51-1-19" id="h51-1-19" class="i">+                                            datatype: String,
</a><a href="#h51-1-20" id="h51-1-20" class="i">+                                            primary_key: false,
</a><a href="#h51-1-21" id="h51-1-21" class="i">+                                            nullable: false,
</a><a href="#h51-1-22" id="h51-1-22" class="i">+                                            default: None,
</a><a href="#h51-1-23" id="h51-1-23" class="i">+                                            unique: false,
</a><a href="#h51-1-24" id="h51-1-24" class="i">+                                            references: None,
</a><a href="#h51-1-25" id="h51-1-25" class="i">+                                            index: false,
</a><a href="#h51-1-26" id="h51-1-26" class="i">+                                        },
</a><a href="#h51-1-27" id="h51-1-27" class="i">+                                        Column {
</a><a href="#h51-1-28" id="h51-1-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h51-1-29" id="h51-1-29" class="i">+                                            datatype: Integer,
</a><a href="#h51-1-30" id="h51-1-30" class="i">+                                            primary_key: false,
</a><a href="#h51-1-31" id="h51-1-31" class="i">+                                            nullable: false,
</a><a href="#h51-1-32" id="h51-1-32" class="i">+                                            default: None,
</a><a href="#h51-1-33" id="h51-1-33" class="i">+                                            unique: false,
</a><a href="#h51-1-34" id="h51-1-34" class="i">+                                            references: Some(
</a><a href="#h51-1-35" id="h51-1-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h51-1-36" id="h51-1-36" class="i">+                                            ),
</a><a href="#h51-1-37" id="h51-1-37" class="i">+                                            index: true,
</a><a href="#h51-1-38" id="h51-1-38" class="i">+                                        },
</a><a href="#h51-1-39" id="h51-1-39" class="i">+                                        Column {
</a><a href="#h51-1-40" id="h51-1-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h51-1-41" id="h51-1-41" class="i">+                                            datatype: Integer,
</a><a href="#h51-1-42" id="h51-1-42" class="i">+                                            primary_key: false,
</a><a href="#h51-1-43" id="h51-1-43" class="i">+                                            nullable: false,
</a><a href="#h51-1-44" id="h51-1-44" class="i">+                                            default: None,
</a><a href="#h51-1-45" id="h51-1-45" class="i">+                                            unique: false,
</a><a href="#h51-1-46" id="h51-1-46" class="i">+                                            references: Some(
</a><a href="#h51-1-47" id="h51-1-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h51-1-48" id="h51-1-48" class="i">+                                            ),
</a><a href="#h51-1-49" id="h51-1-49" class="i">+                                            index: true,
</a><a href="#h51-1-50" id="h51-1-50" class="i">+                                        },
</a><a href="#h51-1-51" id="h51-1-51" class="i">+                                        Column {
</a><a href="#h51-1-52" id="h51-1-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h51-1-53" id="h51-1-53" class="i">+                                            datatype: Integer,
</a><a href="#h51-1-54" id="h51-1-54" class="i">+                                            primary_key: false,
</a><a href="#h51-1-55" id="h51-1-55" class="i">+                                            nullable: false,
</a><a href="#h51-1-56" id="h51-1-56" class="i">+                                            default: None,
</a><a href="#h51-1-57" id="h51-1-57" class="i">+                                            unique: false,
</a><a href="#h51-1-58" id="h51-1-58" class="i">+                                            references: None,
</a><a href="#h51-1-59" id="h51-1-59" class="i">+                                            index: false,
</a><a href="#h51-1-60" id="h51-1-60" class="i">+                                        },
</a><a href="#h51-1-61" id="h51-1-61" class="i">+                                        Column {
</a><a href="#h51-1-62" id="h51-1-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h51-1-63" id="h51-1-63" class="i">+                                            datatype: Float,
</a><a href="#h51-1-64" id="h51-1-64" class="i">+                                            primary_key: false,
</a><a href="#h51-1-65" id="h51-1-65" class="i">+                                            nullable: true,
</a><a href="#h51-1-66" id="h51-1-66" class="i">+                                            default: Some(
</a><a href="#h51-1-67" id="h51-1-67" class="i">+                                                Null,
</a><a href="#h51-1-68" id="h51-1-68" class="i">+                                            ),
</a><a href="#h51-1-69" id="h51-1-69" class="i">+                                            unique: false,
</a><a href="#h51-1-70" id="h51-1-70" class="i">+                                            references: None,
</a><a href="#h51-1-71" id="h51-1-71" class="i">+                                            index: false,
</a><a href="#h51-1-72" id="h51-1-72" class="i">+                                        },
</a><a href="#h51-1-73" id="h51-1-73" class="i">+                                        Column {
</a><a href="#h51-1-74" id="h51-1-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h51-1-75" id="h51-1-75" class="i">+                                            datatype: Boolean,
</a><a href="#h51-1-76" id="h51-1-76" class="i">+                                            primary_key: false,
</a><a href="#h51-1-77" id="h51-1-77" class="i">+                                            nullable: true,
</a><a href="#h51-1-78" id="h51-1-78" class="i">+                                            default: Some(
</a><a href="#h51-1-79" id="h51-1-79" class="i">+                                                Null,
</a><a href="#h51-1-80" id="h51-1-80" class="i">+                                            ),
</a><a href="#h51-1-81" id="h51-1-81" class="i">+                                            unique: false,
</a><a href="#h51-1-82" id="h51-1-82" class="i">+                                            references: None,
</a><a href="#h51-1-83" id="h51-1-83" class="i">+                                            index: false,
</a><a href="#h51-1-84" id="h51-1-84" class="i">+                                        },
</a><a href="#h51-1-85" id="h51-1-85" class="i">+                                    ],
</a><a href="#h51-1-86" id="h51-1-86" class="i">+                                },
</a>                                 alias: None,
                                 filter: None,
                             },
<b>diff --git a/<a id="h52" href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a> b/<a href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -64,13 +64,119 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h52-0-3" id="h52-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h52-0-4" id="h52-0-4" class="i">+            table: Table {
</a><a href="#h52-0-5" id="h52-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h52-0-6" id="h52-0-6" class="i">+                columns: [
</a><a href="#h52-0-7" id="h52-0-7" class="i">+                    Column {
</a><a href="#h52-0-8" id="h52-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h52-0-9" id="h52-0-9" class="i">+                        datatype: Integer,
</a><a href="#h52-0-10" id="h52-0-10" class="i">+                        primary_key: true,
</a><a href="#h52-0-11" id="h52-0-11" class="i">+                        nullable: false,
</a><a href="#h52-0-12" id="h52-0-12" class="i">+                        default: None,
</a><a href="#h52-0-13" id="h52-0-13" class="i">+                        unique: true,
</a><a href="#h52-0-14" id="h52-0-14" class="i">+                        references: None,
</a><a href="#h52-0-15" id="h52-0-15" class="i">+                        index: false,
</a><a href="#h52-0-16" id="h52-0-16" class="i">+                    },
</a><a href="#h52-0-17" id="h52-0-17" class="i">+                    Column {
</a><a href="#h52-0-18" id="h52-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h52-0-19" id="h52-0-19" class="i">+                        datatype: String,
</a><a href="#h52-0-20" id="h52-0-20" class="i">+                        primary_key: false,
</a><a href="#h52-0-21" id="h52-0-21" class="i">+                        nullable: false,
</a><a href="#h52-0-22" id="h52-0-22" class="i">+                        default: None,
</a><a href="#h52-0-23" id="h52-0-23" class="i">+                        unique: false,
</a><a href="#h52-0-24" id="h52-0-24" class="i">+                        references: None,
</a><a href="#h52-0-25" id="h52-0-25" class="i">+                        index: false,
</a><a href="#h52-0-26" id="h52-0-26" class="i">+                    },
</a><a href="#h52-0-27" id="h52-0-27" class="i">+                    Column {
</a><a href="#h52-0-28" id="h52-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h52-0-29" id="h52-0-29" class="i">+                        datatype: Integer,
</a><a href="#h52-0-30" id="h52-0-30" class="i">+                        primary_key: false,
</a><a href="#h52-0-31" id="h52-0-31" class="i">+                        nullable: false,
</a><a href="#h52-0-32" id="h52-0-32" class="i">+                        default: None,
</a><a href="#h52-0-33" id="h52-0-33" class="i">+                        unique: false,
</a><a href="#h52-0-34" id="h52-0-34" class="i">+                        references: Some(
</a><a href="#h52-0-35" id="h52-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h52-0-36" id="h52-0-36" class="i">+                        ),
</a><a href="#h52-0-37" id="h52-0-37" class="i">+                        index: true,
</a><a href="#h52-0-38" id="h52-0-38" class="i">+                    },
</a><a href="#h52-0-39" id="h52-0-39" class="i">+                    Column {
</a><a href="#h52-0-40" id="h52-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h52-0-41" id="h52-0-41" class="i">+                        datatype: Integer,
</a><a href="#h52-0-42" id="h52-0-42" class="i">+                        primary_key: false,
</a><a href="#h52-0-43" id="h52-0-43" class="i">+                        nullable: false,
</a><a href="#h52-0-44" id="h52-0-44" class="i">+                        default: None,
</a><a href="#h52-0-45" id="h52-0-45" class="i">+                        unique: false,
</a><a href="#h52-0-46" id="h52-0-46" class="i">+                        references: Some(
</a><a href="#h52-0-47" id="h52-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h52-0-48" id="h52-0-48" class="i">+                        ),
</a><a href="#h52-0-49" id="h52-0-49" class="i">+                        index: true,
</a><a href="#h52-0-50" id="h52-0-50" class="i">+                    },
</a><a href="#h52-0-51" id="h52-0-51" class="i">+                    Column {
</a><a href="#h52-0-52" id="h52-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h52-0-53" id="h52-0-53" class="i">+                        datatype: Integer,
</a><a href="#h52-0-54" id="h52-0-54" class="i">+                        primary_key: false,
</a><a href="#h52-0-55" id="h52-0-55" class="i">+                        nullable: false,
</a><a href="#h52-0-56" id="h52-0-56" class="i">+                        default: None,
</a><a href="#h52-0-57" id="h52-0-57" class="i">+                        unique: false,
</a><a href="#h52-0-58" id="h52-0-58" class="i">+                        references: None,
</a><a href="#h52-0-59" id="h52-0-59" class="i">+                        index: false,
</a><a href="#h52-0-60" id="h52-0-60" class="i">+                    },
</a><a href="#h52-0-61" id="h52-0-61" class="i">+                    Column {
</a><a href="#h52-0-62" id="h52-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h52-0-63" id="h52-0-63" class="i">+                        datatype: Float,
</a><a href="#h52-0-64" id="h52-0-64" class="i">+                        primary_key: false,
</a><a href="#h52-0-65" id="h52-0-65" class="i">+                        nullable: true,
</a><a href="#h52-0-66" id="h52-0-66" class="i">+                        default: Some(
</a><a href="#h52-0-67" id="h52-0-67" class="i">+                            Null,
</a><a href="#h52-0-68" id="h52-0-68" class="i">+                        ),
</a><a href="#h52-0-69" id="h52-0-69" class="i">+                        unique: false,
</a><a href="#h52-0-70" id="h52-0-70" class="i">+                        references: None,
</a><a href="#h52-0-71" id="h52-0-71" class="i">+                        index: false,
</a><a href="#h52-0-72" id="h52-0-72" class="i">+                    },
</a><a href="#h52-0-73" id="h52-0-73" class="i">+                    Column {
</a><a href="#h52-0-74" id="h52-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h52-0-75" id="h52-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h52-0-76" id="h52-0-76" class="i">+                        primary_key: false,
</a><a href="#h52-0-77" id="h52-0-77" class="i">+                        nullable: true,
</a><a href="#h52-0-78" id="h52-0-78" class="i">+                        default: Some(
</a><a href="#h52-0-79" id="h52-0-79" class="i">+                            Null,
</a><a href="#h52-0-80" id="h52-0-80" class="i">+                        ),
</a><a href="#h52-0-81" id="h52-0-81" class="i">+                        unique: false,
</a><a href="#h52-0-82" id="h52-0-82" class="i">+                        references: None,
</a><a href="#h52-0-83" id="h52-0-83" class="i">+                        index: false,
</a><a href="#h52-0-84" id="h52-0-84" class="i">+                    },
</a><a href="#h52-0-85" id="h52-0-85" class="i">+                ],
</a><a href="#h52-0-86" id="h52-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
         left_size: 7,
         right: Scan {
<a href="#h52-0-92" id="h52-0-92" class="d">-            table: &quot;genres&quot;,
</a><a href="#h52-0-93" id="h52-0-93" class="i">+            table: Table {
</a><a href="#h52-0-94" id="h52-0-94" class="i">+                name: &quot;genres&quot;,
</a><a href="#h52-0-95" id="h52-0-95" class="i">+                columns: [
</a><a href="#h52-0-96" id="h52-0-96" class="i">+                    Column {
</a><a href="#h52-0-97" id="h52-0-97" class="i">+                        name: &quot;id&quot;,
</a><a href="#h52-0-98" id="h52-0-98" class="i">+                        datatype: Integer,
</a><a href="#h52-0-99" id="h52-0-99" class="i">+                        primary_key: true,
</a><a href="#h52-0-100" id="h52-0-100" class="i">+                        nullable: false,
</a><a href="#h52-0-101" id="h52-0-101" class="i">+                        default: None,
</a><a href="#h52-0-102" id="h52-0-102" class="i">+                        unique: true,
</a><a href="#h52-0-103" id="h52-0-103" class="i">+                        references: None,
</a><a href="#h52-0-104" id="h52-0-104" class="i">+                        index: false,
</a><a href="#h52-0-105" id="h52-0-105" class="i">+                    },
</a><a href="#h52-0-106" id="h52-0-106" class="i">+                    Column {
</a><a href="#h52-0-107" id="h52-0-107" class="i">+                        name: &quot;name&quot;,
</a><a href="#h52-0-108" id="h52-0-108" class="i">+                        datatype: String,
</a><a href="#h52-0-109" id="h52-0-109" class="i">+                        primary_key: false,
</a><a href="#h52-0-110" id="h52-0-110" class="i">+                        nullable: false,
</a><a href="#h52-0-111" id="h52-0-111" class="i">+                        default: None,
</a><a href="#h52-0-112" id="h52-0-112" class="i">+                        unique: false,
</a><a href="#h52-0-113" id="h52-0-113" class="i">+                        references: None,
</a><a href="#h52-0-114" id="h52-0-114" class="i">+                        index: false,
</a><a href="#h52-0-115" id="h52-0-115" class="i">+                    },
</a><a href="#h52-0-116" id="h52-0-116" class="i">+                ],
</a><a href="#h52-0-117" id="h52-0-117" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h52-1" id="h52-1" class="h">@@ -82,13 +188,119 @@ Plan: Select(
</a> Optimized plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h52-1-3" id="h52-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h52-1-4" id="h52-1-4" class="i">+            table: Table {
</a><a href="#h52-1-5" id="h52-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h52-1-6" id="h52-1-6" class="i">+                columns: [
</a><a href="#h52-1-7" id="h52-1-7" class="i">+                    Column {
</a><a href="#h52-1-8" id="h52-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h52-1-9" id="h52-1-9" class="i">+                        datatype: Integer,
</a><a href="#h52-1-10" id="h52-1-10" class="i">+                        primary_key: true,
</a><a href="#h52-1-11" id="h52-1-11" class="i">+                        nullable: false,
</a><a href="#h52-1-12" id="h52-1-12" class="i">+                        default: None,
</a><a href="#h52-1-13" id="h52-1-13" class="i">+                        unique: true,
</a><a href="#h52-1-14" id="h52-1-14" class="i">+                        references: None,
</a><a href="#h52-1-15" id="h52-1-15" class="i">+                        index: false,
</a><a href="#h52-1-16" id="h52-1-16" class="i">+                    },
</a><a href="#h52-1-17" id="h52-1-17" class="i">+                    Column {
</a><a href="#h52-1-18" id="h52-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h52-1-19" id="h52-1-19" class="i">+                        datatype: String,
</a><a href="#h52-1-20" id="h52-1-20" class="i">+                        primary_key: false,
</a><a href="#h52-1-21" id="h52-1-21" class="i">+                        nullable: false,
</a><a href="#h52-1-22" id="h52-1-22" class="i">+                        default: None,
</a><a href="#h52-1-23" id="h52-1-23" class="i">+                        unique: false,
</a><a href="#h52-1-24" id="h52-1-24" class="i">+                        references: None,
</a><a href="#h52-1-25" id="h52-1-25" class="i">+                        index: false,
</a><a href="#h52-1-26" id="h52-1-26" class="i">+                    },
</a><a href="#h52-1-27" id="h52-1-27" class="i">+                    Column {
</a><a href="#h52-1-28" id="h52-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h52-1-29" id="h52-1-29" class="i">+                        datatype: Integer,
</a><a href="#h52-1-30" id="h52-1-30" class="i">+                        primary_key: false,
</a><a href="#h52-1-31" id="h52-1-31" class="i">+                        nullable: false,
</a><a href="#h52-1-32" id="h52-1-32" class="i">+                        default: None,
</a><a href="#h52-1-33" id="h52-1-33" class="i">+                        unique: false,
</a><a href="#h52-1-34" id="h52-1-34" class="i">+                        references: Some(
</a><a href="#h52-1-35" id="h52-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h52-1-36" id="h52-1-36" class="i">+                        ),
</a><a href="#h52-1-37" id="h52-1-37" class="i">+                        index: true,
</a><a href="#h52-1-38" id="h52-1-38" class="i">+                    },
</a><a href="#h52-1-39" id="h52-1-39" class="i">+                    Column {
</a><a href="#h52-1-40" id="h52-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h52-1-41" id="h52-1-41" class="i">+                        datatype: Integer,
</a><a href="#h52-1-42" id="h52-1-42" class="i">+                        primary_key: false,
</a><a href="#h52-1-43" id="h52-1-43" class="i">+                        nullable: false,
</a><a href="#h52-1-44" id="h52-1-44" class="i">+                        default: None,
</a><a href="#h52-1-45" id="h52-1-45" class="i">+                        unique: false,
</a><a href="#h52-1-46" id="h52-1-46" class="i">+                        references: Some(
</a><a href="#h52-1-47" id="h52-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h52-1-48" id="h52-1-48" class="i">+                        ),
</a><a href="#h52-1-49" id="h52-1-49" class="i">+                        index: true,
</a><a href="#h52-1-50" id="h52-1-50" class="i">+                    },
</a><a href="#h52-1-51" id="h52-1-51" class="i">+                    Column {
</a><a href="#h52-1-52" id="h52-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h52-1-53" id="h52-1-53" class="i">+                        datatype: Integer,
</a><a href="#h52-1-54" id="h52-1-54" class="i">+                        primary_key: false,
</a><a href="#h52-1-55" id="h52-1-55" class="i">+                        nullable: false,
</a><a href="#h52-1-56" id="h52-1-56" class="i">+                        default: None,
</a><a href="#h52-1-57" id="h52-1-57" class="i">+                        unique: false,
</a><a href="#h52-1-58" id="h52-1-58" class="i">+                        references: None,
</a><a href="#h52-1-59" id="h52-1-59" class="i">+                        index: false,
</a><a href="#h52-1-60" id="h52-1-60" class="i">+                    },
</a><a href="#h52-1-61" id="h52-1-61" class="i">+                    Column {
</a><a href="#h52-1-62" id="h52-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h52-1-63" id="h52-1-63" class="i">+                        datatype: Float,
</a><a href="#h52-1-64" id="h52-1-64" class="i">+                        primary_key: false,
</a><a href="#h52-1-65" id="h52-1-65" class="i">+                        nullable: true,
</a><a href="#h52-1-66" id="h52-1-66" class="i">+                        default: Some(
</a><a href="#h52-1-67" id="h52-1-67" class="i">+                            Null,
</a><a href="#h52-1-68" id="h52-1-68" class="i">+                        ),
</a><a href="#h52-1-69" id="h52-1-69" class="i">+                        unique: false,
</a><a href="#h52-1-70" id="h52-1-70" class="i">+                        references: None,
</a><a href="#h52-1-71" id="h52-1-71" class="i">+                        index: false,
</a><a href="#h52-1-72" id="h52-1-72" class="i">+                    },
</a><a href="#h52-1-73" id="h52-1-73" class="i">+                    Column {
</a><a href="#h52-1-74" id="h52-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h52-1-75" id="h52-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h52-1-76" id="h52-1-76" class="i">+                        primary_key: false,
</a><a href="#h52-1-77" id="h52-1-77" class="i">+                        nullable: true,
</a><a href="#h52-1-78" id="h52-1-78" class="i">+                        default: Some(
</a><a href="#h52-1-79" id="h52-1-79" class="i">+                            Null,
</a><a href="#h52-1-80" id="h52-1-80" class="i">+                        ),
</a><a href="#h52-1-81" id="h52-1-81" class="i">+                        unique: false,
</a><a href="#h52-1-82" id="h52-1-82" class="i">+                        references: None,
</a><a href="#h52-1-83" id="h52-1-83" class="i">+                        index: false,
</a><a href="#h52-1-84" id="h52-1-84" class="i">+                    },
</a><a href="#h52-1-85" id="h52-1-85" class="i">+                ],
</a><a href="#h52-1-86" id="h52-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
         left_size: 7,
         right: Scan {
<a href="#h52-1-92" id="h52-1-92" class="d">-            table: &quot;genres&quot;,
</a><a href="#h52-1-93" id="h52-1-93" class="i">+            table: Table {
</a><a href="#h52-1-94" id="h52-1-94" class="i">+                name: &quot;genres&quot;,
</a><a href="#h52-1-95" id="h52-1-95" class="i">+                columns: [
</a><a href="#h52-1-96" id="h52-1-96" class="i">+                    Column {
</a><a href="#h52-1-97" id="h52-1-97" class="i">+                        name: &quot;id&quot;,
</a><a href="#h52-1-98" id="h52-1-98" class="i">+                        datatype: Integer,
</a><a href="#h52-1-99" id="h52-1-99" class="i">+                        primary_key: true,
</a><a href="#h52-1-100" id="h52-1-100" class="i">+                        nullable: false,
</a><a href="#h52-1-101" id="h52-1-101" class="i">+                        default: None,
</a><a href="#h52-1-102" id="h52-1-102" class="i">+                        unique: true,
</a><a href="#h52-1-103" id="h52-1-103" class="i">+                        references: None,
</a><a href="#h52-1-104" id="h52-1-104" class="i">+                        index: false,
</a><a href="#h52-1-105" id="h52-1-105" class="i">+                    },
</a><a href="#h52-1-106" id="h52-1-106" class="i">+                    Column {
</a><a href="#h52-1-107" id="h52-1-107" class="i">+                        name: &quot;name&quot;,
</a><a href="#h52-1-108" id="h52-1-108" class="i">+                        datatype: String,
</a><a href="#h52-1-109" id="h52-1-109" class="i">+                        primary_key: false,
</a><a href="#h52-1-110" id="h52-1-110" class="i">+                        nullable: false,
</a><a href="#h52-1-111" id="h52-1-111" class="i">+                        default: None,
</a><a href="#h52-1-112" id="h52-1-112" class="i">+                        unique: false,
</a><a href="#h52-1-113" id="h52-1-113" class="i">+                        references: None,
</a><a href="#h52-1-114" id="h52-1-114" class="i">+                        index: false,
</a><a href="#h52-1-115" id="h52-1-115" class="i">+                    },
</a><a href="#h52-1-116" id="h52-1-116" class="i">+                ],
</a><a href="#h52-1-117" id="h52-1-117" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h53" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -183,7 +183,89 @@ Plan: Select(
</a>             source: NestedLoopJoin {
                 left: NestedLoopJoin {
                     left: Scan {
<a href="#h53-0-3" id="h53-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h53-0-4" id="h53-0-4" class="i">+                        table: Table {
</a><a href="#h53-0-5" id="h53-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h53-0-6" id="h53-0-6" class="i">+                            columns: [
</a><a href="#h53-0-7" id="h53-0-7" class="i">+                                Column {
</a><a href="#h53-0-8" id="h53-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h53-0-9" id="h53-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h53-0-10" id="h53-0-10" class="i">+                                    primary_key: true,
</a><a href="#h53-0-11" id="h53-0-11" class="i">+                                    nullable: false,
</a><a href="#h53-0-12" id="h53-0-12" class="i">+                                    default: None,
</a><a href="#h53-0-13" id="h53-0-13" class="i">+                                    unique: true,
</a><a href="#h53-0-14" id="h53-0-14" class="i">+                                    references: None,
</a><a href="#h53-0-15" id="h53-0-15" class="i">+                                    index: false,
</a><a href="#h53-0-16" id="h53-0-16" class="i">+                                },
</a><a href="#h53-0-17" id="h53-0-17" class="i">+                                Column {
</a><a href="#h53-0-18" id="h53-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h53-0-19" id="h53-0-19" class="i">+                                    datatype: String,
</a><a href="#h53-0-20" id="h53-0-20" class="i">+                                    primary_key: false,
</a><a href="#h53-0-21" id="h53-0-21" class="i">+                                    nullable: false,
</a><a href="#h53-0-22" id="h53-0-22" class="i">+                                    default: None,
</a><a href="#h53-0-23" id="h53-0-23" class="i">+                                    unique: false,
</a><a href="#h53-0-24" id="h53-0-24" class="i">+                                    references: None,
</a><a href="#h53-0-25" id="h53-0-25" class="i">+                                    index: false,
</a><a href="#h53-0-26" id="h53-0-26" class="i">+                                },
</a><a href="#h53-0-27" id="h53-0-27" class="i">+                                Column {
</a><a href="#h53-0-28" id="h53-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h53-0-29" id="h53-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h53-0-30" id="h53-0-30" class="i">+                                    primary_key: false,
</a><a href="#h53-0-31" id="h53-0-31" class="i">+                                    nullable: false,
</a><a href="#h53-0-32" id="h53-0-32" class="i">+                                    default: None,
</a><a href="#h53-0-33" id="h53-0-33" class="i">+                                    unique: false,
</a><a href="#h53-0-34" id="h53-0-34" class="i">+                                    references: Some(
</a><a href="#h53-0-35" id="h53-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h53-0-36" id="h53-0-36" class="i">+                                    ),
</a><a href="#h53-0-37" id="h53-0-37" class="i">+                                    index: true,
</a><a href="#h53-0-38" id="h53-0-38" class="i">+                                },
</a><a href="#h53-0-39" id="h53-0-39" class="i">+                                Column {
</a><a href="#h53-0-40" id="h53-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h53-0-41" id="h53-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h53-0-42" id="h53-0-42" class="i">+                                    primary_key: false,
</a><a href="#h53-0-43" id="h53-0-43" class="i">+                                    nullable: false,
</a><a href="#h53-0-44" id="h53-0-44" class="i">+                                    default: None,
</a><a href="#h53-0-45" id="h53-0-45" class="i">+                                    unique: false,
</a><a href="#h53-0-46" id="h53-0-46" class="i">+                                    references: Some(
</a><a href="#h53-0-47" id="h53-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h53-0-48" id="h53-0-48" class="i">+                                    ),
</a><a href="#h53-0-49" id="h53-0-49" class="i">+                                    index: true,
</a><a href="#h53-0-50" id="h53-0-50" class="i">+                                },
</a><a href="#h53-0-51" id="h53-0-51" class="i">+                                Column {
</a><a href="#h53-0-52" id="h53-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h53-0-53" id="h53-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h53-0-54" id="h53-0-54" class="i">+                                    primary_key: false,
</a><a href="#h53-0-55" id="h53-0-55" class="i">+                                    nullable: false,
</a><a href="#h53-0-56" id="h53-0-56" class="i">+                                    default: None,
</a><a href="#h53-0-57" id="h53-0-57" class="i">+                                    unique: false,
</a><a href="#h53-0-58" id="h53-0-58" class="i">+                                    references: None,
</a><a href="#h53-0-59" id="h53-0-59" class="i">+                                    index: false,
</a><a href="#h53-0-60" id="h53-0-60" class="i">+                                },
</a><a href="#h53-0-61" id="h53-0-61" class="i">+                                Column {
</a><a href="#h53-0-62" id="h53-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h53-0-63" id="h53-0-63" class="i">+                                    datatype: Float,
</a><a href="#h53-0-64" id="h53-0-64" class="i">+                                    primary_key: false,
</a><a href="#h53-0-65" id="h53-0-65" class="i">+                                    nullable: true,
</a><a href="#h53-0-66" id="h53-0-66" class="i">+                                    default: Some(
</a><a href="#h53-0-67" id="h53-0-67" class="i">+                                        Null,
</a><a href="#h53-0-68" id="h53-0-68" class="i">+                                    ),
</a><a href="#h53-0-69" id="h53-0-69" class="i">+                                    unique: false,
</a><a href="#h53-0-70" id="h53-0-70" class="i">+                                    references: None,
</a><a href="#h53-0-71" id="h53-0-71" class="i">+                                    index: false,
</a><a href="#h53-0-72" id="h53-0-72" class="i">+                                },
</a><a href="#h53-0-73" id="h53-0-73" class="i">+                                Column {
</a><a href="#h53-0-74" id="h53-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h53-0-75" id="h53-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h53-0-76" id="h53-0-76" class="i">+                                    primary_key: false,
</a><a href="#h53-0-77" id="h53-0-77" class="i">+                                    nullable: true,
</a><a href="#h53-0-78" id="h53-0-78" class="i">+                                    default: Some(
</a><a href="#h53-0-79" id="h53-0-79" class="i">+                                        Null,
</a><a href="#h53-0-80" id="h53-0-80" class="i">+                                    ),
</a><a href="#h53-0-81" id="h53-0-81" class="i">+                                    unique: false,
</a><a href="#h53-0-82" id="h53-0-82" class="i">+                                    references: None,
</a><a href="#h53-0-83" id="h53-0-83" class="i">+                                    index: false,
</a><a href="#h53-0-84" id="h53-0-84" class="i">+                                },
</a><a href="#h53-0-85" id="h53-0-85" class="i">+                            ],
</a><a href="#h53-0-86" id="h53-0-86" class="i">+                        },
</a>                         alias: Some(
                             &quot;m&quot;,
                         ),
<a href="#h53-1" id="h53-1" class="h">@@ -191,7 +273,31 @@ Plan: Select(
</a>                     },
                     left_size: 7,
                     right: Scan {
<a href="#h53-1-3" id="h53-1-3" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h53-1-4" id="h53-1-4" class="i">+                        table: Table {
</a><a href="#h53-1-5" id="h53-1-5" class="i">+                            name: &quot;genres&quot;,
</a><a href="#h53-1-6" id="h53-1-6" class="i">+                            columns: [
</a><a href="#h53-1-7" id="h53-1-7" class="i">+                                Column {
</a><a href="#h53-1-8" id="h53-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h53-1-9" id="h53-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h53-1-10" id="h53-1-10" class="i">+                                    primary_key: true,
</a><a href="#h53-1-11" id="h53-1-11" class="i">+                                    nullable: false,
</a><a href="#h53-1-12" id="h53-1-12" class="i">+                                    default: None,
</a><a href="#h53-1-13" id="h53-1-13" class="i">+                                    unique: true,
</a><a href="#h53-1-14" id="h53-1-14" class="i">+                                    references: None,
</a><a href="#h53-1-15" id="h53-1-15" class="i">+                                    index: false,
</a><a href="#h53-1-16" id="h53-1-16" class="i">+                                },
</a><a href="#h53-1-17" id="h53-1-17" class="i">+                                Column {
</a><a href="#h53-1-18" id="h53-1-18" class="i">+                                    name: &quot;name&quot;,
</a><a href="#h53-1-19" id="h53-1-19" class="i">+                                    datatype: String,
</a><a href="#h53-1-20" id="h53-1-20" class="i">+                                    primary_key: false,
</a><a href="#h53-1-21" id="h53-1-21" class="i">+                                    nullable: false,
</a><a href="#h53-1-22" id="h53-1-22" class="i">+                                    default: None,
</a><a href="#h53-1-23" id="h53-1-23" class="i">+                                    unique: false,
</a><a href="#h53-1-24" id="h53-1-24" class="i">+                                    references: None,
</a><a href="#h53-1-25" id="h53-1-25" class="i">+                                    index: false,
</a><a href="#h53-1-26" id="h53-1-26" class="i">+                                },
</a><a href="#h53-1-27" id="h53-1-27" class="i">+                            ],
</a><a href="#h53-1-28" id="h53-1-28" class="i">+                        },
</a>                         alias: Some(
                             &quot;g&quot;,
                         ),
<a href="#h53-2" id="h53-2" class="h">@@ -202,7 +308,31 @@ Plan: Select(
</a>                 },
                 left_size: 9,
                 right: Scan {
<a href="#h53-2-3" id="h53-2-3" class="d">-                    table: &quot;countries&quot;,
</a><a href="#h53-2-4" id="h53-2-4" class="i">+                    table: Table {
</a><a href="#h53-2-5" id="h53-2-5" class="i">+                        name: &quot;countries&quot;,
</a><a href="#h53-2-6" id="h53-2-6" class="i">+                        columns: [
</a><a href="#h53-2-7" id="h53-2-7" class="i">+                            Column {
</a><a href="#h53-2-8" id="h53-2-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h53-2-9" id="h53-2-9" class="i">+                                datatype: String,
</a><a href="#h53-2-10" id="h53-2-10" class="i">+                                primary_key: true,
</a><a href="#h53-2-11" id="h53-2-11" class="i">+                                nullable: false,
</a><a href="#h53-2-12" id="h53-2-12" class="i">+                                default: None,
</a><a href="#h53-2-13" id="h53-2-13" class="i">+                                unique: true,
</a><a href="#h53-2-14" id="h53-2-14" class="i">+                                references: None,
</a><a href="#h53-2-15" id="h53-2-15" class="i">+                                index: false,
</a><a href="#h53-2-16" id="h53-2-16" class="i">+                            },
</a><a href="#h53-2-17" id="h53-2-17" class="i">+                            Column {
</a><a href="#h53-2-18" id="h53-2-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h53-2-19" id="h53-2-19" class="i">+                                datatype: String,
</a><a href="#h53-2-20" id="h53-2-20" class="i">+                                primary_key: false,
</a><a href="#h53-2-21" id="h53-2-21" class="i">+                                nullable: false,
</a><a href="#h53-2-22" id="h53-2-22" class="i">+                                default: None,
</a><a href="#h53-2-23" id="h53-2-23" class="i">+                                unique: false,
</a><a href="#h53-2-24" id="h53-2-24" class="i">+                                references: None,
</a><a href="#h53-2-25" id="h53-2-25" class="i">+                                index: false,
</a><a href="#h53-2-26" id="h53-2-26" class="i">+                            },
</a><a href="#h53-2-27" id="h53-2-27" class="i">+                        ],
</a><a href="#h53-2-28" id="h53-2-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;c&quot;,
                     ),
<a href="#h53-3" id="h53-3" class="h">@@ -386,7 +516,89 @@ Optimized plan: Select(
</a>         source: NestedLoopJoin {
             left: NestedLoopJoin {
                 left: Scan {
<a href="#h53-3-3" id="h53-3-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h53-3-4" id="h53-3-4" class="i">+                    table: Table {
</a><a href="#h53-3-5" id="h53-3-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h53-3-6" id="h53-3-6" class="i">+                        columns: [
</a><a href="#h53-3-7" id="h53-3-7" class="i">+                            Column {
</a><a href="#h53-3-8" id="h53-3-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h53-3-9" id="h53-3-9" class="i">+                                datatype: Integer,
</a><a href="#h53-3-10" id="h53-3-10" class="i">+                                primary_key: true,
</a><a href="#h53-3-11" id="h53-3-11" class="i">+                                nullable: false,
</a><a href="#h53-3-12" id="h53-3-12" class="i">+                                default: None,
</a><a href="#h53-3-13" id="h53-3-13" class="i">+                                unique: true,
</a><a href="#h53-3-14" id="h53-3-14" class="i">+                                references: None,
</a><a href="#h53-3-15" id="h53-3-15" class="i">+                                index: false,
</a><a href="#h53-3-16" id="h53-3-16" class="i">+                            },
</a><a href="#h53-3-17" id="h53-3-17" class="i">+                            Column {
</a><a href="#h53-3-18" id="h53-3-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h53-3-19" id="h53-3-19" class="i">+                                datatype: String,
</a><a href="#h53-3-20" id="h53-3-20" class="i">+                                primary_key: false,
</a><a href="#h53-3-21" id="h53-3-21" class="i">+                                nullable: false,
</a><a href="#h53-3-22" id="h53-3-22" class="i">+                                default: None,
</a><a href="#h53-3-23" id="h53-3-23" class="i">+                                unique: false,
</a><a href="#h53-3-24" id="h53-3-24" class="i">+                                references: None,
</a><a href="#h53-3-25" id="h53-3-25" class="i">+                                index: false,
</a><a href="#h53-3-26" id="h53-3-26" class="i">+                            },
</a><a href="#h53-3-27" id="h53-3-27" class="i">+                            Column {
</a><a href="#h53-3-28" id="h53-3-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h53-3-29" id="h53-3-29" class="i">+                                datatype: Integer,
</a><a href="#h53-3-30" id="h53-3-30" class="i">+                                primary_key: false,
</a><a href="#h53-3-31" id="h53-3-31" class="i">+                                nullable: false,
</a><a href="#h53-3-32" id="h53-3-32" class="i">+                                default: None,
</a><a href="#h53-3-33" id="h53-3-33" class="i">+                                unique: false,
</a><a href="#h53-3-34" id="h53-3-34" class="i">+                                references: Some(
</a><a href="#h53-3-35" id="h53-3-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h53-3-36" id="h53-3-36" class="i">+                                ),
</a><a href="#h53-3-37" id="h53-3-37" class="i">+                                index: true,
</a><a href="#h53-3-38" id="h53-3-38" class="i">+                            },
</a><a href="#h53-3-39" id="h53-3-39" class="i">+                            Column {
</a><a href="#h53-3-40" id="h53-3-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h53-3-41" id="h53-3-41" class="i">+                                datatype: Integer,
</a><a href="#h53-3-42" id="h53-3-42" class="i">+                                primary_key: false,
</a><a href="#h53-3-43" id="h53-3-43" class="i">+                                nullable: false,
</a><a href="#h53-3-44" id="h53-3-44" class="i">+                                default: None,
</a><a href="#h53-3-45" id="h53-3-45" class="i">+                                unique: false,
</a><a href="#h53-3-46" id="h53-3-46" class="i">+                                references: Some(
</a><a href="#h53-3-47" id="h53-3-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h53-3-48" id="h53-3-48" class="i">+                                ),
</a><a href="#h53-3-49" id="h53-3-49" class="i">+                                index: true,
</a><a href="#h53-3-50" id="h53-3-50" class="i">+                            },
</a><a href="#h53-3-51" id="h53-3-51" class="i">+                            Column {
</a><a href="#h53-3-52" id="h53-3-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h53-3-53" id="h53-3-53" class="i">+                                datatype: Integer,
</a><a href="#h53-3-54" id="h53-3-54" class="i">+                                primary_key: false,
</a><a href="#h53-3-55" id="h53-3-55" class="i">+                                nullable: false,
</a><a href="#h53-3-56" id="h53-3-56" class="i">+                                default: None,
</a><a href="#h53-3-57" id="h53-3-57" class="i">+                                unique: false,
</a><a href="#h53-3-58" id="h53-3-58" class="i">+                                references: None,
</a><a href="#h53-3-59" id="h53-3-59" class="i">+                                index: false,
</a><a href="#h53-3-60" id="h53-3-60" class="i">+                            },
</a><a href="#h53-3-61" id="h53-3-61" class="i">+                            Column {
</a><a href="#h53-3-62" id="h53-3-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h53-3-63" id="h53-3-63" class="i">+                                datatype: Float,
</a><a href="#h53-3-64" id="h53-3-64" class="i">+                                primary_key: false,
</a><a href="#h53-3-65" id="h53-3-65" class="i">+                                nullable: true,
</a><a href="#h53-3-66" id="h53-3-66" class="i">+                                default: Some(
</a><a href="#h53-3-67" id="h53-3-67" class="i">+                                    Null,
</a><a href="#h53-3-68" id="h53-3-68" class="i">+                                ),
</a><a href="#h53-3-69" id="h53-3-69" class="i">+                                unique: false,
</a><a href="#h53-3-70" id="h53-3-70" class="i">+                                references: None,
</a><a href="#h53-3-71" id="h53-3-71" class="i">+                                index: false,
</a><a href="#h53-3-72" id="h53-3-72" class="i">+                            },
</a><a href="#h53-3-73" id="h53-3-73" class="i">+                            Column {
</a><a href="#h53-3-74" id="h53-3-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h53-3-75" id="h53-3-75" class="i">+                                datatype: Boolean,
</a><a href="#h53-3-76" id="h53-3-76" class="i">+                                primary_key: false,
</a><a href="#h53-3-77" id="h53-3-77" class="i">+                                nullable: true,
</a><a href="#h53-3-78" id="h53-3-78" class="i">+                                default: Some(
</a><a href="#h53-3-79" id="h53-3-79" class="i">+                                    Null,
</a><a href="#h53-3-80" id="h53-3-80" class="i">+                                ),
</a><a href="#h53-3-81" id="h53-3-81" class="i">+                                unique: false,
</a><a href="#h53-3-82" id="h53-3-82" class="i">+                                references: None,
</a><a href="#h53-3-83" id="h53-3-83" class="i">+                                index: false,
</a><a href="#h53-3-84" id="h53-3-84" class="i">+                            },
</a><a href="#h53-3-85" id="h53-3-85" class="i">+                        ],
</a><a href="#h53-3-86" id="h53-3-86" class="i">+                    },
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h53-4" id="h53-4" class="h">@@ -433,7 +645,31 @@ Optimized plan: Select(
</a>                 },
                 left_size: 7,
                 right: KeyLookup {
<a href="#h53-4-3" id="h53-4-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h53-4-4" id="h53-4-4" class="i">+                    table: Table {
</a><a href="#h53-4-5" id="h53-4-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h53-4-6" id="h53-4-6" class="i">+                        columns: [
</a><a href="#h53-4-7" id="h53-4-7" class="i">+                            Column {
</a><a href="#h53-4-8" id="h53-4-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h53-4-9" id="h53-4-9" class="i">+                                datatype: Integer,
</a><a href="#h53-4-10" id="h53-4-10" class="i">+                                primary_key: true,
</a><a href="#h53-4-11" id="h53-4-11" class="i">+                                nullable: false,
</a><a href="#h53-4-12" id="h53-4-12" class="i">+                                default: None,
</a><a href="#h53-4-13" id="h53-4-13" class="i">+                                unique: true,
</a><a href="#h53-4-14" id="h53-4-14" class="i">+                                references: None,
</a><a href="#h53-4-15" id="h53-4-15" class="i">+                                index: false,
</a><a href="#h53-4-16" id="h53-4-16" class="i">+                            },
</a><a href="#h53-4-17" id="h53-4-17" class="i">+                            Column {
</a><a href="#h53-4-18" id="h53-4-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h53-4-19" id="h53-4-19" class="i">+                                datatype: String,
</a><a href="#h53-4-20" id="h53-4-20" class="i">+                                primary_key: false,
</a><a href="#h53-4-21" id="h53-4-21" class="i">+                                nullable: false,
</a><a href="#h53-4-22" id="h53-4-22" class="i">+                                default: None,
</a><a href="#h53-4-23" id="h53-4-23" class="i">+                                unique: false,
</a><a href="#h53-4-24" id="h53-4-24" class="i">+                                references: None,
</a><a href="#h53-4-25" id="h53-4-25" class="i">+                                index: false,
</a><a href="#h53-4-26" id="h53-4-26" class="i">+                            },
</a><a href="#h53-4-27" id="h53-4-27" class="i">+                        ],
</a><a href="#h53-4-28" id="h53-4-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h53-5" id="h53-5" class="h">@@ -448,7 +684,31 @@ Optimized plan: Select(
</a>             },
             left_size: 9,
             right: Scan {
<a href="#h53-5-3" id="h53-5-3" class="d">-                table: &quot;countries&quot;,
</a><a href="#h53-5-4" id="h53-5-4" class="i">+                table: Table {
</a><a href="#h53-5-5" id="h53-5-5" class="i">+                    name: &quot;countries&quot;,
</a><a href="#h53-5-6" id="h53-5-6" class="i">+                    columns: [
</a><a href="#h53-5-7" id="h53-5-7" class="i">+                        Column {
</a><a href="#h53-5-8" id="h53-5-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h53-5-9" id="h53-5-9" class="i">+                            datatype: String,
</a><a href="#h53-5-10" id="h53-5-10" class="i">+                            primary_key: true,
</a><a href="#h53-5-11" id="h53-5-11" class="i">+                            nullable: false,
</a><a href="#h53-5-12" id="h53-5-12" class="i">+                            default: None,
</a><a href="#h53-5-13" id="h53-5-13" class="i">+                            unique: true,
</a><a href="#h53-5-14" id="h53-5-14" class="i">+                            references: None,
</a><a href="#h53-5-15" id="h53-5-15" class="i">+                            index: false,
</a><a href="#h53-5-16" id="h53-5-16" class="i">+                        },
</a><a href="#h53-5-17" id="h53-5-17" class="i">+                        Column {
</a><a href="#h53-5-18" id="h53-5-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h53-5-19" id="h53-5-19" class="i">+                            datatype: String,
</a><a href="#h53-5-20" id="h53-5-20" class="i">+                            primary_key: false,
</a><a href="#h53-5-21" id="h53-5-21" class="i">+                            nullable: false,
</a><a href="#h53-5-22" id="h53-5-22" class="i">+                            default: None,
</a><a href="#h53-5-23" id="h53-5-23" class="i">+                            unique: false,
</a><a href="#h53-5-24" id="h53-5-24" class="i">+                            references: None,
</a><a href="#h53-5-25" id="h53-5-25" class="i">+                            index: false,
</a><a href="#h53-5-26" id="h53-5-26" class="i">+                        },
</a><a href="#h53-5-27" id="h53-5-27" class="i">+                    ],
</a><a href="#h53-5-28" id="h53-5-28" class="i">+                },
</a>                 alias: Some(
                     &quot;c&quot;,
                 ),
<b>diff --git a/<a id="h54" href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a> b/<a href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -416,13 +416,119 @@ Plan: Select(
</a>         left: NestedLoopJoin {
             left: NestedLoopJoin {
                 left: Scan {
<a href="#h54-0-3" id="h54-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h54-0-4" id="h54-0-4" class="i">+                    table: Table {
</a><a href="#h54-0-5" id="h54-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h54-0-6" id="h54-0-6" class="i">+                        columns: [
</a><a href="#h54-0-7" id="h54-0-7" class="i">+                            Column {
</a><a href="#h54-0-8" id="h54-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h54-0-9" id="h54-0-9" class="i">+                                datatype: Integer,
</a><a href="#h54-0-10" id="h54-0-10" class="i">+                                primary_key: true,
</a><a href="#h54-0-11" id="h54-0-11" class="i">+                                nullable: false,
</a><a href="#h54-0-12" id="h54-0-12" class="i">+                                default: None,
</a><a href="#h54-0-13" id="h54-0-13" class="i">+                                unique: true,
</a><a href="#h54-0-14" id="h54-0-14" class="i">+                                references: None,
</a><a href="#h54-0-15" id="h54-0-15" class="i">+                                index: false,
</a><a href="#h54-0-16" id="h54-0-16" class="i">+                            },
</a><a href="#h54-0-17" id="h54-0-17" class="i">+                            Column {
</a><a href="#h54-0-18" id="h54-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h54-0-19" id="h54-0-19" class="i">+                                datatype: String,
</a><a href="#h54-0-20" id="h54-0-20" class="i">+                                primary_key: false,
</a><a href="#h54-0-21" id="h54-0-21" class="i">+                                nullable: false,
</a><a href="#h54-0-22" id="h54-0-22" class="i">+                                default: None,
</a><a href="#h54-0-23" id="h54-0-23" class="i">+                                unique: false,
</a><a href="#h54-0-24" id="h54-0-24" class="i">+                                references: None,
</a><a href="#h54-0-25" id="h54-0-25" class="i">+                                index: false,
</a><a href="#h54-0-26" id="h54-0-26" class="i">+                            },
</a><a href="#h54-0-27" id="h54-0-27" class="i">+                            Column {
</a><a href="#h54-0-28" id="h54-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h54-0-29" id="h54-0-29" class="i">+                                datatype: Integer,
</a><a href="#h54-0-30" id="h54-0-30" class="i">+                                primary_key: false,
</a><a href="#h54-0-31" id="h54-0-31" class="i">+                                nullable: false,
</a><a href="#h54-0-32" id="h54-0-32" class="i">+                                default: None,
</a><a href="#h54-0-33" id="h54-0-33" class="i">+                                unique: false,
</a><a href="#h54-0-34" id="h54-0-34" class="i">+                                references: Some(
</a><a href="#h54-0-35" id="h54-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h54-0-36" id="h54-0-36" class="i">+                                ),
</a><a href="#h54-0-37" id="h54-0-37" class="i">+                                index: true,
</a><a href="#h54-0-38" id="h54-0-38" class="i">+                            },
</a><a href="#h54-0-39" id="h54-0-39" class="i">+                            Column {
</a><a href="#h54-0-40" id="h54-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h54-0-41" id="h54-0-41" class="i">+                                datatype: Integer,
</a><a href="#h54-0-42" id="h54-0-42" class="i">+                                primary_key: false,
</a><a href="#h54-0-43" id="h54-0-43" class="i">+                                nullable: false,
</a><a href="#h54-0-44" id="h54-0-44" class="i">+                                default: None,
</a><a href="#h54-0-45" id="h54-0-45" class="i">+                                unique: false,
</a><a href="#h54-0-46" id="h54-0-46" class="i">+                                references: Some(
</a><a href="#h54-0-47" id="h54-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h54-0-48" id="h54-0-48" class="i">+                                ),
</a><a href="#h54-0-49" id="h54-0-49" class="i">+                                index: true,
</a><a href="#h54-0-50" id="h54-0-50" class="i">+                            },
</a><a href="#h54-0-51" id="h54-0-51" class="i">+                            Column {
</a><a href="#h54-0-52" id="h54-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h54-0-53" id="h54-0-53" class="i">+                                datatype: Integer,
</a><a href="#h54-0-54" id="h54-0-54" class="i">+                                primary_key: false,
</a><a href="#h54-0-55" id="h54-0-55" class="i">+                                nullable: false,
</a><a href="#h54-0-56" id="h54-0-56" class="i">+                                default: None,
</a><a href="#h54-0-57" id="h54-0-57" class="i">+                                unique: false,
</a><a href="#h54-0-58" id="h54-0-58" class="i">+                                references: None,
</a><a href="#h54-0-59" id="h54-0-59" class="i">+                                index: false,
</a><a href="#h54-0-60" id="h54-0-60" class="i">+                            },
</a><a href="#h54-0-61" id="h54-0-61" class="i">+                            Column {
</a><a href="#h54-0-62" id="h54-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h54-0-63" id="h54-0-63" class="i">+                                datatype: Float,
</a><a href="#h54-0-64" id="h54-0-64" class="i">+                                primary_key: false,
</a><a href="#h54-0-65" id="h54-0-65" class="i">+                                nullable: true,
</a><a href="#h54-0-66" id="h54-0-66" class="i">+                                default: Some(
</a><a href="#h54-0-67" id="h54-0-67" class="i">+                                    Null,
</a><a href="#h54-0-68" id="h54-0-68" class="i">+                                ),
</a><a href="#h54-0-69" id="h54-0-69" class="i">+                                unique: false,
</a><a href="#h54-0-70" id="h54-0-70" class="i">+                                references: None,
</a><a href="#h54-0-71" id="h54-0-71" class="i">+                                index: false,
</a><a href="#h54-0-72" id="h54-0-72" class="i">+                            },
</a><a href="#h54-0-73" id="h54-0-73" class="i">+                            Column {
</a><a href="#h54-0-74" id="h54-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h54-0-75" id="h54-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h54-0-76" id="h54-0-76" class="i">+                                primary_key: false,
</a><a href="#h54-0-77" id="h54-0-77" class="i">+                                nullable: true,
</a><a href="#h54-0-78" id="h54-0-78" class="i">+                                default: Some(
</a><a href="#h54-0-79" id="h54-0-79" class="i">+                                    Null,
</a><a href="#h54-0-80" id="h54-0-80" class="i">+                                ),
</a><a href="#h54-0-81" id="h54-0-81" class="i">+                                unique: false,
</a><a href="#h54-0-82" id="h54-0-82" class="i">+                                references: None,
</a><a href="#h54-0-83" id="h54-0-83" class="i">+                                index: false,
</a><a href="#h54-0-84" id="h54-0-84" class="i">+                            },
</a><a href="#h54-0-85" id="h54-0-85" class="i">+                        ],
</a><a href="#h54-0-86" id="h54-0-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
                 left_size: 7,
                 right: Scan {
<a href="#h54-0-92" id="h54-0-92" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h54-0-93" id="h54-0-93" class="i">+                    table: Table {
</a><a href="#h54-0-94" id="h54-0-94" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h54-0-95" id="h54-0-95" class="i">+                        columns: [
</a><a href="#h54-0-96" id="h54-0-96" class="i">+                            Column {
</a><a href="#h54-0-97" id="h54-0-97" class="i">+                                name: &quot;id&quot;,
</a><a href="#h54-0-98" id="h54-0-98" class="i">+                                datatype: Integer,
</a><a href="#h54-0-99" id="h54-0-99" class="i">+                                primary_key: true,
</a><a href="#h54-0-100" id="h54-0-100" class="i">+                                nullable: false,
</a><a href="#h54-0-101" id="h54-0-101" class="i">+                                default: None,
</a><a href="#h54-0-102" id="h54-0-102" class="i">+                                unique: true,
</a><a href="#h54-0-103" id="h54-0-103" class="i">+                                references: None,
</a><a href="#h54-0-104" id="h54-0-104" class="i">+                                index: false,
</a><a href="#h54-0-105" id="h54-0-105" class="i">+                            },
</a><a href="#h54-0-106" id="h54-0-106" class="i">+                            Column {
</a><a href="#h54-0-107" id="h54-0-107" class="i">+                                name: &quot;name&quot;,
</a><a href="#h54-0-108" id="h54-0-108" class="i">+                                datatype: String,
</a><a href="#h54-0-109" id="h54-0-109" class="i">+                                primary_key: false,
</a><a href="#h54-0-110" id="h54-0-110" class="i">+                                nullable: false,
</a><a href="#h54-0-111" id="h54-0-111" class="i">+                                default: None,
</a><a href="#h54-0-112" id="h54-0-112" class="i">+                                unique: false,
</a><a href="#h54-0-113" id="h54-0-113" class="i">+                                references: None,
</a><a href="#h54-0-114" id="h54-0-114" class="i">+                                index: false,
</a><a href="#h54-0-115" id="h54-0-115" class="i">+                            },
</a><a href="#h54-0-116" id="h54-0-116" class="i">+                        ],
</a><a href="#h54-0-117" id="h54-0-117" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h54-1" id="h54-1" class="h">@@ -431,7 +537,31 @@ Plan: Select(
</a>             },
             left_size: 9,
             right: Scan {
<a href="#h54-1-3" id="h54-1-3" class="d">-                table: &quot;countries&quot;,
</a><a href="#h54-1-4" id="h54-1-4" class="i">+                table: Table {
</a><a href="#h54-1-5" id="h54-1-5" class="i">+                    name: &quot;countries&quot;,
</a><a href="#h54-1-6" id="h54-1-6" class="i">+                    columns: [
</a><a href="#h54-1-7" id="h54-1-7" class="i">+                        Column {
</a><a href="#h54-1-8" id="h54-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h54-1-9" id="h54-1-9" class="i">+                            datatype: String,
</a><a href="#h54-1-10" id="h54-1-10" class="i">+                            primary_key: true,
</a><a href="#h54-1-11" id="h54-1-11" class="i">+                            nullable: false,
</a><a href="#h54-1-12" id="h54-1-12" class="i">+                            default: None,
</a><a href="#h54-1-13" id="h54-1-13" class="i">+                            unique: true,
</a><a href="#h54-1-14" id="h54-1-14" class="i">+                            references: None,
</a><a href="#h54-1-15" id="h54-1-15" class="i">+                            index: false,
</a><a href="#h54-1-16" id="h54-1-16" class="i">+                        },
</a><a href="#h54-1-17" id="h54-1-17" class="i">+                        Column {
</a><a href="#h54-1-18" id="h54-1-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h54-1-19" id="h54-1-19" class="i">+                            datatype: String,
</a><a href="#h54-1-20" id="h54-1-20" class="i">+                            primary_key: false,
</a><a href="#h54-1-21" id="h54-1-21" class="i">+                            nullable: false,
</a><a href="#h54-1-22" id="h54-1-22" class="i">+                            default: None,
</a><a href="#h54-1-23" id="h54-1-23" class="i">+                            unique: false,
</a><a href="#h54-1-24" id="h54-1-24" class="i">+                            references: None,
</a><a href="#h54-1-25" id="h54-1-25" class="i">+                            index: false,
</a><a href="#h54-1-26" id="h54-1-26" class="i">+                        },
</a><a href="#h54-1-27" id="h54-1-27" class="i">+                    ],
</a><a href="#h54-1-28" id="h54-1-28" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h54-2" id="h54-2" class="h">@@ -440,7 +570,45 @@ Plan: Select(
</a>         },
         left_size: 11,
         right: Scan {
<a href="#h54-2-3" id="h54-2-3" class="d">-            table: &quot;studios&quot;,
</a><a href="#h54-2-4" id="h54-2-4" class="i">+            table: Table {
</a><a href="#h54-2-5" id="h54-2-5" class="i">+                name: &quot;studios&quot;,
</a><a href="#h54-2-6" id="h54-2-6" class="i">+                columns: [
</a><a href="#h54-2-7" id="h54-2-7" class="i">+                    Column {
</a><a href="#h54-2-8" id="h54-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h54-2-9" id="h54-2-9" class="i">+                        datatype: Integer,
</a><a href="#h54-2-10" id="h54-2-10" class="i">+                        primary_key: true,
</a><a href="#h54-2-11" id="h54-2-11" class="i">+                        nullable: false,
</a><a href="#h54-2-12" id="h54-2-12" class="i">+                        default: None,
</a><a href="#h54-2-13" id="h54-2-13" class="i">+                        unique: true,
</a><a href="#h54-2-14" id="h54-2-14" class="i">+                        references: None,
</a><a href="#h54-2-15" id="h54-2-15" class="i">+                        index: false,
</a><a href="#h54-2-16" id="h54-2-16" class="i">+                    },
</a><a href="#h54-2-17" id="h54-2-17" class="i">+                    Column {
</a><a href="#h54-2-18" id="h54-2-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h54-2-19" id="h54-2-19" class="i">+                        datatype: String,
</a><a href="#h54-2-20" id="h54-2-20" class="i">+                        primary_key: false,
</a><a href="#h54-2-21" id="h54-2-21" class="i">+                        nullable: false,
</a><a href="#h54-2-22" id="h54-2-22" class="i">+                        default: None,
</a><a href="#h54-2-23" id="h54-2-23" class="i">+                        unique: false,
</a><a href="#h54-2-24" id="h54-2-24" class="i">+                        references: None,
</a><a href="#h54-2-25" id="h54-2-25" class="i">+                        index: false,
</a><a href="#h54-2-26" id="h54-2-26" class="i">+                    },
</a><a href="#h54-2-27" id="h54-2-27" class="i">+                    Column {
</a><a href="#h54-2-28" id="h54-2-28" class="i">+                        name: &quot;country_id&quot;,
</a><a href="#h54-2-29" id="h54-2-29" class="i">+                        datatype: String,
</a><a href="#h54-2-30" id="h54-2-30" class="i">+                        primary_key: false,
</a><a href="#h54-2-31" id="h54-2-31" class="i">+                        nullable: true,
</a><a href="#h54-2-32" id="h54-2-32" class="i">+                        default: Some(
</a><a href="#h54-2-33" id="h54-2-33" class="i">+                            Null,
</a><a href="#h54-2-34" id="h54-2-34" class="i">+                        ),
</a><a href="#h54-2-35" id="h54-2-35" class="i">+                        unique: false,
</a><a href="#h54-2-36" id="h54-2-36" class="i">+                        references: Some(
</a><a href="#h54-2-37" id="h54-2-37" class="i">+                            &quot;countries&quot;,
</a><a href="#h54-2-38" id="h54-2-38" class="i">+                        ),
</a><a href="#h54-2-39" id="h54-2-39" class="i">+                        index: true,
</a><a href="#h54-2-40" id="h54-2-40" class="i">+                    },
</a><a href="#h54-2-41" id="h54-2-41" class="i">+                ],
</a><a href="#h54-2-42" id="h54-2-42" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h54-3" id="h54-3" class="h">@@ -454,13 +622,119 @@ Optimized plan: Select(
</a>         left: NestedLoopJoin {
             left: NestedLoopJoin {
                 left: Scan {
<a href="#h54-3-3" id="h54-3-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h54-3-4" id="h54-3-4" class="i">+                    table: Table {
</a><a href="#h54-3-5" id="h54-3-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h54-3-6" id="h54-3-6" class="i">+                        columns: [
</a><a href="#h54-3-7" id="h54-3-7" class="i">+                            Column {
</a><a href="#h54-3-8" id="h54-3-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h54-3-9" id="h54-3-9" class="i">+                                datatype: Integer,
</a><a href="#h54-3-10" id="h54-3-10" class="i">+                                primary_key: true,
</a><a href="#h54-3-11" id="h54-3-11" class="i">+                                nullable: false,
</a><a href="#h54-3-12" id="h54-3-12" class="i">+                                default: None,
</a><a href="#h54-3-13" id="h54-3-13" class="i">+                                unique: true,
</a><a href="#h54-3-14" id="h54-3-14" class="i">+                                references: None,
</a><a href="#h54-3-15" id="h54-3-15" class="i">+                                index: false,
</a><a href="#h54-3-16" id="h54-3-16" class="i">+                            },
</a><a href="#h54-3-17" id="h54-3-17" class="i">+                            Column {
</a><a href="#h54-3-18" id="h54-3-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h54-3-19" id="h54-3-19" class="i">+                                datatype: String,
</a><a href="#h54-3-20" id="h54-3-20" class="i">+                                primary_key: false,
</a><a href="#h54-3-21" id="h54-3-21" class="i">+                                nullable: false,
</a><a href="#h54-3-22" id="h54-3-22" class="i">+                                default: None,
</a><a href="#h54-3-23" id="h54-3-23" class="i">+                                unique: false,
</a><a href="#h54-3-24" id="h54-3-24" class="i">+                                references: None,
</a><a href="#h54-3-25" id="h54-3-25" class="i">+                                index: false,
</a><a href="#h54-3-26" id="h54-3-26" class="i">+                            },
</a><a href="#h54-3-27" id="h54-3-27" class="i">+                            Column {
</a><a href="#h54-3-28" id="h54-3-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h54-3-29" id="h54-3-29" class="i">+                                datatype: Integer,
</a><a href="#h54-3-30" id="h54-3-30" class="i">+                                primary_key: false,
</a><a href="#h54-3-31" id="h54-3-31" class="i">+                                nullable: false,
</a><a href="#h54-3-32" id="h54-3-32" class="i">+                                default: None,
</a><a href="#h54-3-33" id="h54-3-33" class="i">+                                unique: false,
</a><a href="#h54-3-34" id="h54-3-34" class="i">+                                references: Some(
</a><a href="#h54-3-35" id="h54-3-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h54-3-36" id="h54-3-36" class="i">+                                ),
</a><a href="#h54-3-37" id="h54-3-37" class="i">+                                index: true,
</a><a href="#h54-3-38" id="h54-3-38" class="i">+                            },
</a><a href="#h54-3-39" id="h54-3-39" class="i">+                            Column {
</a><a href="#h54-3-40" id="h54-3-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h54-3-41" id="h54-3-41" class="i">+                                datatype: Integer,
</a><a href="#h54-3-42" id="h54-3-42" class="i">+                                primary_key: false,
</a><a href="#h54-3-43" id="h54-3-43" class="i">+                                nullable: false,
</a><a href="#h54-3-44" id="h54-3-44" class="i">+                                default: None,
</a><a href="#h54-3-45" id="h54-3-45" class="i">+                                unique: false,
</a><a href="#h54-3-46" id="h54-3-46" class="i">+                                references: Some(
</a><a href="#h54-3-47" id="h54-3-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h54-3-48" id="h54-3-48" class="i">+                                ),
</a><a href="#h54-3-49" id="h54-3-49" class="i">+                                index: true,
</a><a href="#h54-3-50" id="h54-3-50" class="i">+                            },
</a><a href="#h54-3-51" id="h54-3-51" class="i">+                            Column {
</a><a href="#h54-3-52" id="h54-3-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h54-3-53" id="h54-3-53" class="i">+                                datatype: Integer,
</a><a href="#h54-3-54" id="h54-3-54" class="i">+                                primary_key: false,
</a><a href="#h54-3-55" id="h54-3-55" class="i">+                                nullable: false,
</a><a href="#h54-3-56" id="h54-3-56" class="i">+                                default: None,
</a><a href="#h54-3-57" id="h54-3-57" class="i">+                                unique: false,
</a><a href="#h54-3-58" id="h54-3-58" class="i">+                                references: None,
</a><a href="#h54-3-59" id="h54-3-59" class="i">+                                index: false,
</a><a href="#h54-3-60" id="h54-3-60" class="i">+                            },
</a><a href="#h54-3-61" id="h54-3-61" class="i">+                            Column {
</a><a href="#h54-3-62" id="h54-3-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h54-3-63" id="h54-3-63" class="i">+                                datatype: Float,
</a><a href="#h54-3-64" id="h54-3-64" class="i">+                                primary_key: false,
</a><a href="#h54-3-65" id="h54-3-65" class="i">+                                nullable: true,
</a><a href="#h54-3-66" id="h54-3-66" class="i">+                                default: Some(
</a><a href="#h54-3-67" id="h54-3-67" class="i">+                                    Null,
</a><a href="#h54-3-68" id="h54-3-68" class="i">+                                ),
</a><a href="#h54-3-69" id="h54-3-69" class="i">+                                unique: false,
</a><a href="#h54-3-70" id="h54-3-70" class="i">+                                references: None,
</a><a href="#h54-3-71" id="h54-3-71" class="i">+                                index: false,
</a><a href="#h54-3-72" id="h54-3-72" class="i">+                            },
</a><a href="#h54-3-73" id="h54-3-73" class="i">+                            Column {
</a><a href="#h54-3-74" id="h54-3-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h54-3-75" id="h54-3-75" class="i">+                                datatype: Boolean,
</a><a href="#h54-3-76" id="h54-3-76" class="i">+                                primary_key: false,
</a><a href="#h54-3-77" id="h54-3-77" class="i">+                                nullable: true,
</a><a href="#h54-3-78" id="h54-3-78" class="i">+                                default: Some(
</a><a href="#h54-3-79" id="h54-3-79" class="i">+                                    Null,
</a><a href="#h54-3-80" id="h54-3-80" class="i">+                                ),
</a><a href="#h54-3-81" id="h54-3-81" class="i">+                                unique: false,
</a><a href="#h54-3-82" id="h54-3-82" class="i">+                                references: None,
</a><a href="#h54-3-83" id="h54-3-83" class="i">+                                index: false,
</a><a href="#h54-3-84" id="h54-3-84" class="i">+                            },
</a><a href="#h54-3-85" id="h54-3-85" class="i">+                        ],
</a><a href="#h54-3-86" id="h54-3-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
                 left_size: 7,
                 right: Scan {
<a href="#h54-3-92" id="h54-3-92" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h54-3-93" id="h54-3-93" class="i">+                    table: Table {
</a><a href="#h54-3-94" id="h54-3-94" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h54-3-95" id="h54-3-95" class="i">+                        columns: [
</a><a href="#h54-3-96" id="h54-3-96" class="i">+                            Column {
</a><a href="#h54-3-97" id="h54-3-97" class="i">+                                name: &quot;id&quot;,
</a><a href="#h54-3-98" id="h54-3-98" class="i">+                                datatype: Integer,
</a><a href="#h54-3-99" id="h54-3-99" class="i">+                                primary_key: true,
</a><a href="#h54-3-100" id="h54-3-100" class="i">+                                nullable: false,
</a><a href="#h54-3-101" id="h54-3-101" class="i">+                                default: None,
</a><a href="#h54-3-102" id="h54-3-102" class="i">+                                unique: true,
</a><a href="#h54-3-103" id="h54-3-103" class="i">+                                references: None,
</a><a href="#h54-3-104" id="h54-3-104" class="i">+                                index: false,
</a><a href="#h54-3-105" id="h54-3-105" class="i">+                            },
</a><a href="#h54-3-106" id="h54-3-106" class="i">+                            Column {
</a><a href="#h54-3-107" id="h54-3-107" class="i">+                                name: &quot;name&quot;,
</a><a href="#h54-3-108" id="h54-3-108" class="i">+                                datatype: String,
</a><a href="#h54-3-109" id="h54-3-109" class="i">+                                primary_key: false,
</a><a href="#h54-3-110" id="h54-3-110" class="i">+                                nullable: false,
</a><a href="#h54-3-111" id="h54-3-111" class="i">+                                default: None,
</a><a href="#h54-3-112" id="h54-3-112" class="i">+                                unique: false,
</a><a href="#h54-3-113" id="h54-3-113" class="i">+                                references: None,
</a><a href="#h54-3-114" id="h54-3-114" class="i">+                                index: false,
</a><a href="#h54-3-115" id="h54-3-115" class="i">+                            },
</a><a href="#h54-3-116" id="h54-3-116" class="i">+                        ],
</a><a href="#h54-3-117" id="h54-3-117" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h54-4" id="h54-4" class="h">@@ -469,7 +743,31 @@ Optimized plan: Select(
</a>             },
             left_size: 9,
             right: Scan {
<a href="#h54-4-3" id="h54-4-3" class="d">-                table: &quot;countries&quot;,
</a><a href="#h54-4-4" id="h54-4-4" class="i">+                table: Table {
</a><a href="#h54-4-5" id="h54-4-5" class="i">+                    name: &quot;countries&quot;,
</a><a href="#h54-4-6" id="h54-4-6" class="i">+                    columns: [
</a><a href="#h54-4-7" id="h54-4-7" class="i">+                        Column {
</a><a href="#h54-4-8" id="h54-4-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h54-4-9" id="h54-4-9" class="i">+                            datatype: String,
</a><a href="#h54-4-10" id="h54-4-10" class="i">+                            primary_key: true,
</a><a href="#h54-4-11" id="h54-4-11" class="i">+                            nullable: false,
</a><a href="#h54-4-12" id="h54-4-12" class="i">+                            default: None,
</a><a href="#h54-4-13" id="h54-4-13" class="i">+                            unique: true,
</a><a href="#h54-4-14" id="h54-4-14" class="i">+                            references: None,
</a><a href="#h54-4-15" id="h54-4-15" class="i">+                            index: false,
</a><a href="#h54-4-16" id="h54-4-16" class="i">+                        },
</a><a href="#h54-4-17" id="h54-4-17" class="i">+                        Column {
</a><a href="#h54-4-18" id="h54-4-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h54-4-19" id="h54-4-19" class="i">+                            datatype: String,
</a><a href="#h54-4-20" id="h54-4-20" class="i">+                            primary_key: false,
</a><a href="#h54-4-21" id="h54-4-21" class="i">+                            nullable: false,
</a><a href="#h54-4-22" id="h54-4-22" class="i">+                            default: None,
</a><a href="#h54-4-23" id="h54-4-23" class="i">+                            unique: false,
</a><a href="#h54-4-24" id="h54-4-24" class="i">+                            references: None,
</a><a href="#h54-4-25" id="h54-4-25" class="i">+                            index: false,
</a><a href="#h54-4-26" id="h54-4-26" class="i">+                        },
</a><a href="#h54-4-27" id="h54-4-27" class="i">+                    ],
</a><a href="#h54-4-28" id="h54-4-28" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h54-5" id="h54-5" class="h">@@ -478,7 +776,45 @@ Optimized plan: Select(
</a>         },
         left_size: 11,
         right: Scan {
<a href="#h54-5-3" id="h54-5-3" class="d">-            table: &quot;studios&quot;,
</a><a href="#h54-5-4" id="h54-5-4" class="i">+            table: Table {
</a><a href="#h54-5-5" id="h54-5-5" class="i">+                name: &quot;studios&quot;,
</a><a href="#h54-5-6" id="h54-5-6" class="i">+                columns: [
</a><a href="#h54-5-7" id="h54-5-7" class="i">+                    Column {
</a><a href="#h54-5-8" id="h54-5-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h54-5-9" id="h54-5-9" class="i">+                        datatype: Integer,
</a><a href="#h54-5-10" id="h54-5-10" class="i">+                        primary_key: true,
</a><a href="#h54-5-11" id="h54-5-11" class="i">+                        nullable: false,
</a><a href="#h54-5-12" id="h54-5-12" class="i">+                        default: None,
</a><a href="#h54-5-13" id="h54-5-13" class="i">+                        unique: true,
</a><a href="#h54-5-14" id="h54-5-14" class="i">+                        references: None,
</a><a href="#h54-5-15" id="h54-5-15" class="i">+                        index: false,
</a><a href="#h54-5-16" id="h54-5-16" class="i">+                    },
</a><a href="#h54-5-17" id="h54-5-17" class="i">+                    Column {
</a><a href="#h54-5-18" id="h54-5-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h54-5-19" id="h54-5-19" class="i">+                        datatype: String,
</a><a href="#h54-5-20" id="h54-5-20" class="i">+                        primary_key: false,
</a><a href="#h54-5-21" id="h54-5-21" class="i">+                        nullable: false,
</a><a href="#h54-5-22" id="h54-5-22" class="i">+                        default: None,
</a><a href="#h54-5-23" id="h54-5-23" class="i">+                        unique: false,
</a><a href="#h54-5-24" id="h54-5-24" class="i">+                        references: None,
</a><a href="#h54-5-25" id="h54-5-25" class="i">+                        index: false,
</a><a href="#h54-5-26" id="h54-5-26" class="i">+                    },
</a><a href="#h54-5-27" id="h54-5-27" class="i">+                    Column {
</a><a href="#h54-5-28" id="h54-5-28" class="i">+                        name: &quot;country_id&quot;,
</a><a href="#h54-5-29" id="h54-5-29" class="i">+                        datatype: String,
</a><a href="#h54-5-30" id="h54-5-30" class="i">+                        primary_key: false,
</a><a href="#h54-5-31" id="h54-5-31" class="i">+                        nullable: true,
</a><a href="#h54-5-32" id="h54-5-32" class="i">+                        default: Some(
</a><a href="#h54-5-33" id="h54-5-33" class="i">+                            Null,
</a><a href="#h54-5-34" id="h54-5-34" class="i">+                        ),
</a><a href="#h54-5-35" id="h54-5-35" class="i">+                        unique: false,
</a><a href="#h54-5-36" id="h54-5-36" class="i">+                        references: Some(
</a><a href="#h54-5-37" id="h54-5-37" class="i">+                            &quot;countries&quot;,
</a><a href="#h54-5-38" id="h54-5-38" class="i">+                        ),
</a><a href="#h54-5-39" id="h54-5-39" class="i">+                        index: true,
</a><a href="#h54-5-40" id="h54-5-40" class="i">+                    },
</a><a href="#h54-5-41" id="h54-5-41" class="i">+                ],
</a><a href="#h54-5-42" id="h54-5-42" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h55" href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a> b/<a href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -61,13 +61,119 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h55-0-3" id="h55-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h55-0-4" id="h55-0-4" class="i">+            table: Table {
</a><a href="#h55-0-5" id="h55-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h55-0-6" id="h55-0-6" class="i">+                columns: [
</a><a href="#h55-0-7" id="h55-0-7" class="i">+                    Column {
</a><a href="#h55-0-8" id="h55-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h55-0-9" id="h55-0-9" class="i">+                        datatype: Integer,
</a><a href="#h55-0-10" id="h55-0-10" class="i">+                        primary_key: true,
</a><a href="#h55-0-11" id="h55-0-11" class="i">+                        nullable: false,
</a><a href="#h55-0-12" id="h55-0-12" class="i">+                        default: None,
</a><a href="#h55-0-13" id="h55-0-13" class="i">+                        unique: true,
</a><a href="#h55-0-14" id="h55-0-14" class="i">+                        references: None,
</a><a href="#h55-0-15" id="h55-0-15" class="i">+                        index: false,
</a><a href="#h55-0-16" id="h55-0-16" class="i">+                    },
</a><a href="#h55-0-17" id="h55-0-17" class="i">+                    Column {
</a><a href="#h55-0-18" id="h55-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h55-0-19" id="h55-0-19" class="i">+                        datatype: String,
</a><a href="#h55-0-20" id="h55-0-20" class="i">+                        primary_key: false,
</a><a href="#h55-0-21" id="h55-0-21" class="i">+                        nullable: false,
</a><a href="#h55-0-22" id="h55-0-22" class="i">+                        default: None,
</a><a href="#h55-0-23" id="h55-0-23" class="i">+                        unique: false,
</a><a href="#h55-0-24" id="h55-0-24" class="i">+                        references: None,
</a><a href="#h55-0-25" id="h55-0-25" class="i">+                        index: false,
</a><a href="#h55-0-26" id="h55-0-26" class="i">+                    },
</a><a href="#h55-0-27" id="h55-0-27" class="i">+                    Column {
</a><a href="#h55-0-28" id="h55-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h55-0-29" id="h55-0-29" class="i">+                        datatype: Integer,
</a><a href="#h55-0-30" id="h55-0-30" class="i">+                        primary_key: false,
</a><a href="#h55-0-31" id="h55-0-31" class="i">+                        nullable: false,
</a><a href="#h55-0-32" id="h55-0-32" class="i">+                        default: None,
</a><a href="#h55-0-33" id="h55-0-33" class="i">+                        unique: false,
</a><a href="#h55-0-34" id="h55-0-34" class="i">+                        references: Some(
</a><a href="#h55-0-35" id="h55-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h55-0-36" id="h55-0-36" class="i">+                        ),
</a><a href="#h55-0-37" id="h55-0-37" class="i">+                        index: true,
</a><a href="#h55-0-38" id="h55-0-38" class="i">+                    },
</a><a href="#h55-0-39" id="h55-0-39" class="i">+                    Column {
</a><a href="#h55-0-40" id="h55-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h55-0-41" id="h55-0-41" class="i">+                        datatype: Integer,
</a><a href="#h55-0-42" id="h55-0-42" class="i">+                        primary_key: false,
</a><a href="#h55-0-43" id="h55-0-43" class="i">+                        nullable: false,
</a><a href="#h55-0-44" id="h55-0-44" class="i">+                        default: None,
</a><a href="#h55-0-45" id="h55-0-45" class="i">+                        unique: false,
</a><a href="#h55-0-46" id="h55-0-46" class="i">+                        references: Some(
</a><a href="#h55-0-47" id="h55-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h55-0-48" id="h55-0-48" class="i">+                        ),
</a><a href="#h55-0-49" id="h55-0-49" class="i">+                        index: true,
</a><a href="#h55-0-50" id="h55-0-50" class="i">+                    },
</a><a href="#h55-0-51" id="h55-0-51" class="i">+                    Column {
</a><a href="#h55-0-52" id="h55-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h55-0-53" id="h55-0-53" class="i">+                        datatype: Integer,
</a><a href="#h55-0-54" id="h55-0-54" class="i">+                        primary_key: false,
</a><a href="#h55-0-55" id="h55-0-55" class="i">+                        nullable: false,
</a><a href="#h55-0-56" id="h55-0-56" class="i">+                        default: None,
</a><a href="#h55-0-57" id="h55-0-57" class="i">+                        unique: false,
</a><a href="#h55-0-58" id="h55-0-58" class="i">+                        references: None,
</a><a href="#h55-0-59" id="h55-0-59" class="i">+                        index: false,
</a><a href="#h55-0-60" id="h55-0-60" class="i">+                    },
</a><a href="#h55-0-61" id="h55-0-61" class="i">+                    Column {
</a><a href="#h55-0-62" id="h55-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h55-0-63" id="h55-0-63" class="i">+                        datatype: Float,
</a><a href="#h55-0-64" id="h55-0-64" class="i">+                        primary_key: false,
</a><a href="#h55-0-65" id="h55-0-65" class="i">+                        nullable: true,
</a><a href="#h55-0-66" id="h55-0-66" class="i">+                        default: Some(
</a><a href="#h55-0-67" id="h55-0-67" class="i">+                            Null,
</a><a href="#h55-0-68" id="h55-0-68" class="i">+                        ),
</a><a href="#h55-0-69" id="h55-0-69" class="i">+                        unique: false,
</a><a href="#h55-0-70" id="h55-0-70" class="i">+                        references: None,
</a><a href="#h55-0-71" id="h55-0-71" class="i">+                        index: false,
</a><a href="#h55-0-72" id="h55-0-72" class="i">+                    },
</a><a href="#h55-0-73" id="h55-0-73" class="i">+                    Column {
</a><a href="#h55-0-74" id="h55-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h55-0-75" id="h55-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h55-0-76" id="h55-0-76" class="i">+                        primary_key: false,
</a><a href="#h55-0-77" id="h55-0-77" class="i">+                        nullable: true,
</a><a href="#h55-0-78" id="h55-0-78" class="i">+                        default: Some(
</a><a href="#h55-0-79" id="h55-0-79" class="i">+                            Null,
</a><a href="#h55-0-80" id="h55-0-80" class="i">+                        ),
</a><a href="#h55-0-81" id="h55-0-81" class="i">+                        unique: false,
</a><a href="#h55-0-82" id="h55-0-82" class="i">+                        references: None,
</a><a href="#h55-0-83" id="h55-0-83" class="i">+                        index: false,
</a><a href="#h55-0-84" id="h55-0-84" class="i">+                    },
</a><a href="#h55-0-85" id="h55-0-85" class="i">+                ],
</a><a href="#h55-0-86" id="h55-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
         left_size: 7,
         right: Scan {
<a href="#h55-0-92" id="h55-0-92" class="d">-            table: &quot;genres&quot;,
</a><a href="#h55-0-93" id="h55-0-93" class="i">+            table: Table {
</a><a href="#h55-0-94" id="h55-0-94" class="i">+                name: &quot;genres&quot;,
</a><a href="#h55-0-95" id="h55-0-95" class="i">+                columns: [
</a><a href="#h55-0-96" id="h55-0-96" class="i">+                    Column {
</a><a href="#h55-0-97" id="h55-0-97" class="i">+                        name: &quot;id&quot;,
</a><a href="#h55-0-98" id="h55-0-98" class="i">+                        datatype: Integer,
</a><a href="#h55-0-99" id="h55-0-99" class="i">+                        primary_key: true,
</a><a href="#h55-0-100" id="h55-0-100" class="i">+                        nullable: false,
</a><a href="#h55-0-101" id="h55-0-101" class="i">+                        default: None,
</a><a href="#h55-0-102" id="h55-0-102" class="i">+                        unique: true,
</a><a href="#h55-0-103" id="h55-0-103" class="i">+                        references: None,
</a><a href="#h55-0-104" id="h55-0-104" class="i">+                        index: false,
</a><a href="#h55-0-105" id="h55-0-105" class="i">+                    },
</a><a href="#h55-0-106" id="h55-0-106" class="i">+                    Column {
</a><a href="#h55-0-107" id="h55-0-107" class="i">+                        name: &quot;name&quot;,
</a><a href="#h55-0-108" id="h55-0-108" class="i">+                        datatype: String,
</a><a href="#h55-0-109" id="h55-0-109" class="i">+                        primary_key: false,
</a><a href="#h55-0-110" id="h55-0-110" class="i">+                        nullable: false,
</a><a href="#h55-0-111" id="h55-0-111" class="i">+                        default: None,
</a><a href="#h55-0-112" id="h55-0-112" class="i">+                        unique: false,
</a><a href="#h55-0-113" id="h55-0-113" class="i">+                        references: None,
</a><a href="#h55-0-114" id="h55-0-114" class="i">+                        index: false,
</a><a href="#h55-0-115" id="h55-0-115" class="i">+                    },
</a><a href="#h55-0-116" id="h55-0-116" class="i">+                ],
</a><a href="#h55-0-117" id="h55-0-117" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h55-1" id="h55-1" class="h">@@ -104,7 +210,89 @@ Plan: Select(
</a> Optimized plan: Select(
     HashJoin {
         left: Scan {
<a href="#h55-1-3" id="h55-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h55-1-4" id="h55-1-4" class="i">+            table: Table {
</a><a href="#h55-1-5" id="h55-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h55-1-6" id="h55-1-6" class="i">+                columns: [
</a><a href="#h55-1-7" id="h55-1-7" class="i">+                    Column {
</a><a href="#h55-1-8" id="h55-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h55-1-9" id="h55-1-9" class="i">+                        datatype: Integer,
</a><a href="#h55-1-10" id="h55-1-10" class="i">+                        primary_key: true,
</a><a href="#h55-1-11" id="h55-1-11" class="i">+                        nullable: false,
</a><a href="#h55-1-12" id="h55-1-12" class="i">+                        default: None,
</a><a href="#h55-1-13" id="h55-1-13" class="i">+                        unique: true,
</a><a href="#h55-1-14" id="h55-1-14" class="i">+                        references: None,
</a><a href="#h55-1-15" id="h55-1-15" class="i">+                        index: false,
</a><a href="#h55-1-16" id="h55-1-16" class="i">+                    },
</a><a href="#h55-1-17" id="h55-1-17" class="i">+                    Column {
</a><a href="#h55-1-18" id="h55-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h55-1-19" id="h55-1-19" class="i">+                        datatype: String,
</a><a href="#h55-1-20" id="h55-1-20" class="i">+                        primary_key: false,
</a><a href="#h55-1-21" id="h55-1-21" class="i">+                        nullable: false,
</a><a href="#h55-1-22" id="h55-1-22" class="i">+                        default: None,
</a><a href="#h55-1-23" id="h55-1-23" class="i">+                        unique: false,
</a><a href="#h55-1-24" id="h55-1-24" class="i">+                        references: None,
</a><a href="#h55-1-25" id="h55-1-25" class="i">+                        index: false,
</a><a href="#h55-1-26" id="h55-1-26" class="i">+                    },
</a><a href="#h55-1-27" id="h55-1-27" class="i">+                    Column {
</a><a href="#h55-1-28" id="h55-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h55-1-29" id="h55-1-29" class="i">+                        datatype: Integer,
</a><a href="#h55-1-30" id="h55-1-30" class="i">+                        primary_key: false,
</a><a href="#h55-1-31" id="h55-1-31" class="i">+                        nullable: false,
</a><a href="#h55-1-32" id="h55-1-32" class="i">+                        default: None,
</a><a href="#h55-1-33" id="h55-1-33" class="i">+                        unique: false,
</a><a href="#h55-1-34" id="h55-1-34" class="i">+                        references: Some(
</a><a href="#h55-1-35" id="h55-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h55-1-36" id="h55-1-36" class="i">+                        ),
</a><a href="#h55-1-37" id="h55-1-37" class="i">+                        index: true,
</a><a href="#h55-1-38" id="h55-1-38" class="i">+                    },
</a><a href="#h55-1-39" id="h55-1-39" class="i">+                    Column {
</a><a href="#h55-1-40" id="h55-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h55-1-41" id="h55-1-41" class="i">+                        datatype: Integer,
</a><a href="#h55-1-42" id="h55-1-42" class="i">+                        primary_key: false,
</a><a href="#h55-1-43" id="h55-1-43" class="i">+                        nullable: false,
</a><a href="#h55-1-44" id="h55-1-44" class="i">+                        default: None,
</a><a href="#h55-1-45" id="h55-1-45" class="i">+                        unique: false,
</a><a href="#h55-1-46" id="h55-1-46" class="i">+                        references: Some(
</a><a href="#h55-1-47" id="h55-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h55-1-48" id="h55-1-48" class="i">+                        ),
</a><a href="#h55-1-49" id="h55-1-49" class="i">+                        index: true,
</a><a href="#h55-1-50" id="h55-1-50" class="i">+                    },
</a><a href="#h55-1-51" id="h55-1-51" class="i">+                    Column {
</a><a href="#h55-1-52" id="h55-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h55-1-53" id="h55-1-53" class="i">+                        datatype: Integer,
</a><a href="#h55-1-54" id="h55-1-54" class="i">+                        primary_key: false,
</a><a href="#h55-1-55" id="h55-1-55" class="i">+                        nullable: false,
</a><a href="#h55-1-56" id="h55-1-56" class="i">+                        default: None,
</a><a href="#h55-1-57" id="h55-1-57" class="i">+                        unique: false,
</a><a href="#h55-1-58" id="h55-1-58" class="i">+                        references: None,
</a><a href="#h55-1-59" id="h55-1-59" class="i">+                        index: false,
</a><a href="#h55-1-60" id="h55-1-60" class="i">+                    },
</a><a href="#h55-1-61" id="h55-1-61" class="i">+                    Column {
</a><a href="#h55-1-62" id="h55-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h55-1-63" id="h55-1-63" class="i">+                        datatype: Float,
</a><a href="#h55-1-64" id="h55-1-64" class="i">+                        primary_key: false,
</a><a href="#h55-1-65" id="h55-1-65" class="i">+                        nullable: true,
</a><a href="#h55-1-66" id="h55-1-66" class="i">+                        default: Some(
</a><a href="#h55-1-67" id="h55-1-67" class="i">+                            Null,
</a><a href="#h55-1-68" id="h55-1-68" class="i">+                        ),
</a><a href="#h55-1-69" id="h55-1-69" class="i">+                        unique: false,
</a><a href="#h55-1-70" id="h55-1-70" class="i">+                        references: None,
</a><a href="#h55-1-71" id="h55-1-71" class="i">+                        index: false,
</a><a href="#h55-1-72" id="h55-1-72" class="i">+                    },
</a><a href="#h55-1-73" id="h55-1-73" class="i">+                    Column {
</a><a href="#h55-1-74" id="h55-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h55-1-75" id="h55-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h55-1-76" id="h55-1-76" class="i">+                        primary_key: false,
</a><a href="#h55-1-77" id="h55-1-77" class="i">+                        nullable: true,
</a><a href="#h55-1-78" id="h55-1-78" class="i">+                        default: Some(
</a><a href="#h55-1-79" id="h55-1-79" class="i">+                            Null,
</a><a href="#h55-1-80" id="h55-1-80" class="i">+                        ),
</a><a href="#h55-1-81" id="h55-1-81" class="i">+                        unique: false,
</a><a href="#h55-1-82" id="h55-1-82" class="i">+                        references: None,
</a><a href="#h55-1-83" id="h55-1-83" class="i">+                        index: false,
</a><a href="#h55-1-84" id="h55-1-84" class="i">+                    },
</a><a href="#h55-1-85" id="h55-1-85" class="i">+                ],
</a><a href="#h55-1-86" id="h55-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h55-2" id="h55-2" class="h">@@ -120,7 +308,31 @@ Optimized plan: Select(
</a>             ),
         ),
         right: Scan {
<a href="#h55-2-3" id="h55-2-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h55-2-4" id="h55-2-4" class="i">+            table: Table {
</a><a href="#h55-2-5" id="h55-2-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h55-2-6" id="h55-2-6" class="i">+                columns: [
</a><a href="#h55-2-7" id="h55-2-7" class="i">+                    Column {
</a><a href="#h55-2-8" id="h55-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h55-2-9" id="h55-2-9" class="i">+                        datatype: Integer,
</a><a href="#h55-2-10" id="h55-2-10" class="i">+                        primary_key: true,
</a><a href="#h55-2-11" id="h55-2-11" class="i">+                        nullable: false,
</a><a href="#h55-2-12" id="h55-2-12" class="i">+                        default: None,
</a><a href="#h55-2-13" id="h55-2-13" class="i">+                        unique: true,
</a><a href="#h55-2-14" id="h55-2-14" class="i">+                        references: None,
</a><a href="#h55-2-15" id="h55-2-15" class="i">+                        index: false,
</a><a href="#h55-2-16" id="h55-2-16" class="i">+                    },
</a><a href="#h55-2-17" id="h55-2-17" class="i">+                    Column {
</a><a href="#h55-2-18" id="h55-2-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h55-2-19" id="h55-2-19" class="i">+                        datatype: String,
</a><a href="#h55-2-20" id="h55-2-20" class="i">+                        primary_key: false,
</a><a href="#h55-2-21" id="h55-2-21" class="i">+                        nullable: false,
</a><a href="#h55-2-22" id="h55-2-22" class="i">+                        default: None,
</a><a href="#h55-2-23" id="h55-2-23" class="i">+                        unique: false,
</a><a href="#h55-2-24" id="h55-2-24" class="i">+                        references: None,
</a><a href="#h55-2-25" id="h55-2-25" class="i">+                        index: false,
</a><a href="#h55-2-26" id="h55-2-26" class="i">+                    },
</a><a href="#h55-2-27" id="h55-2-27" class="i">+                ],
</a><a href="#h55-2-28" id="h55-2-28" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h56" href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a> b/<a href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -61,13 +61,119 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h56-0-3" id="h56-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h56-0-4" id="h56-0-4" class="i">+            table: Table {
</a><a href="#h56-0-5" id="h56-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h56-0-6" id="h56-0-6" class="i">+                columns: [
</a><a href="#h56-0-7" id="h56-0-7" class="i">+                    Column {
</a><a href="#h56-0-8" id="h56-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h56-0-9" id="h56-0-9" class="i">+                        datatype: Integer,
</a><a href="#h56-0-10" id="h56-0-10" class="i">+                        primary_key: true,
</a><a href="#h56-0-11" id="h56-0-11" class="i">+                        nullable: false,
</a><a href="#h56-0-12" id="h56-0-12" class="i">+                        default: None,
</a><a href="#h56-0-13" id="h56-0-13" class="i">+                        unique: true,
</a><a href="#h56-0-14" id="h56-0-14" class="i">+                        references: None,
</a><a href="#h56-0-15" id="h56-0-15" class="i">+                        index: false,
</a><a href="#h56-0-16" id="h56-0-16" class="i">+                    },
</a><a href="#h56-0-17" id="h56-0-17" class="i">+                    Column {
</a><a href="#h56-0-18" id="h56-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h56-0-19" id="h56-0-19" class="i">+                        datatype: String,
</a><a href="#h56-0-20" id="h56-0-20" class="i">+                        primary_key: false,
</a><a href="#h56-0-21" id="h56-0-21" class="i">+                        nullable: false,
</a><a href="#h56-0-22" id="h56-0-22" class="i">+                        default: None,
</a><a href="#h56-0-23" id="h56-0-23" class="i">+                        unique: false,
</a><a href="#h56-0-24" id="h56-0-24" class="i">+                        references: None,
</a><a href="#h56-0-25" id="h56-0-25" class="i">+                        index: false,
</a><a href="#h56-0-26" id="h56-0-26" class="i">+                    },
</a><a href="#h56-0-27" id="h56-0-27" class="i">+                    Column {
</a><a href="#h56-0-28" id="h56-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h56-0-29" id="h56-0-29" class="i">+                        datatype: Integer,
</a><a href="#h56-0-30" id="h56-0-30" class="i">+                        primary_key: false,
</a><a href="#h56-0-31" id="h56-0-31" class="i">+                        nullable: false,
</a><a href="#h56-0-32" id="h56-0-32" class="i">+                        default: None,
</a><a href="#h56-0-33" id="h56-0-33" class="i">+                        unique: false,
</a><a href="#h56-0-34" id="h56-0-34" class="i">+                        references: Some(
</a><a href="#h56-0-35" id="h56-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h56-0-36" id="h56-0-36" class="i">+                        ),
</a><a href="#h56-0-37" id="h56-0-37" class="i">+                        index: true,
</a><a href="#h56-0-38" id="h56-0-38" class="i">+                    },
</a><a href="#h56-0-39" id="h56-0-39" class="i">+                    Column {
</a><a href="#h56-0-40" id="h56-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h56-0-41" id="h56-0-41" class="i">+                        datatype: Integer,
</a><a href="#h56-0-42" id="h56-0-42" class="i">+                        primary_key: false,
</a><a href="#h56-0-43" id="h56-0-43" class="i">+                        nullable: false,
</a><a href="#h56-0-44" id="h56-0-44" class="i">+                        default: None,
</a><a href="#h56-0-45" id="h56-0-45" class="i">+                        unique: false,
</a><a href="#h56-0-46" id="h56-0-46" class="i">+                        references: Some(
</a><a href="#h56-0-47" id="h56-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h56-0-48" id="h56-0-48" class="i">+                        ),
</a><a href="#h56-0-49" id="h56-0-49" class="i">+                        index: true,
</a><a href="#h56-0-50" id="h56-0-50" class="i">+                    },
</a><a href="#h56-0-51" id="h56-0-51" class="i">+                    Column {
</a><a href="#h56-0-52" id="h56-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h56-0-53" id="h56-0-53" class="i">+                        datatype: Integer,
</a><a href="#h56-0-54" id="h56-0-54" class="i">+                        primary_key: false,
</a><a href="#h56-0-55" id="h56-0-55" class="i">+                        nullable: false,
</a><a href="#h56-0-56" id="h56-0-56" class="i">+                        default: None,
</a><a href="#h56-0-57" id="h56-0-57" class="i">+                        unique: false,
</a><a href="#h56-0-58" id="h56-0-58" class="i">+                        references: None,
</a><a href="#h56-0-59" id="h56-0-59" class="i">+                        index: false,
</a><a href="#h56-0-60" id="h56-0-60" class="i">+                    },
</a><a href="#h56-0-61" id="h56-0-61" class="i">+                    Column {
</a><a href="#h56-0-62" id="h56-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h56-0-63" id="h56-0-63" class="i">+                        datatype: Float,
</a><a href="#h56-0-64" id="h56-0-64" class="i">+                        primary_key: false,
</a><a href="#h56-0-65" id="h56-0-65" class="i">+                        nullable: true,
</a><a href="#h56-0-66" id="h56-0-66" class="i">+                        default: Some(
</a><a href="#h56-0-67" id="h56-0-67" class="i">+                            Null,
</a><a href="#h56-0-68" id="h56-0-68" class="i">+                        ),
</a><a href="#h56-0-69" id="h56-0-69" class="i">+                        unique: false,
</a><a href="#h56-0-70" id="h56-0-70" class="i">+                        references: None,
</a><a href="#h56-0-71" id="h56-0-71" class="i">+                        index: false,
</a><a href="#h56-0-72" id="h56-0-72" class="i">+                    },
</a><a href="#h56-0-73" id="h56-0-73" class="i">+                    Column {
</a><a href="#h56-0-74" id="h56-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h56-0-75" id="h56-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h56-0-76" id="h56-0-76" class="i">+                        primary_key: false,
</a><a href="#h56-0-77" id="h56-0-77" class="i">+                        nullable: true,
</a><a href="#h56-0-78" id="h56-0-78" class="i">+                        default: Some(
</a><a href="#h56-0-79" id="h56-0-79" class="i">+                            Null,
</a><a href="#h56-0-80" id="h56-0-80" class="i">+                        ),
</a><a href="#h56-0-81" id="h56-0-81" class="i">+                        unique: false,
</a><a href="#h56-0-82" id="h56-0-82" class="i">+                        references: None,
</a><a href="#h56-0-83" id="h56-0-83" class="i">+                        index: false,
</a><a href="#h56-0-84" id="h56-0-84" class="i">+                    },
</a><a href="#h56-0-85" id="h56-0-85" class="i">+                ],
</a><a href="#h56-0-86" id="h56-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
         left_size: 7,
         right: Scan {
<a href="#h56-0-92" id="h56-0-92" class="d">-            table: &quot;genres&quot;,
</a><a href="#h56-0-93" id="h56-0-93" class="i">+            table: Table {
</a><a href="#h56-0-94" id="h56-0-94" class="i">+                name: &quot;genres&quot;,
</a><a href="#h56-0-95" id="h56-0-95" class="i">+                columns: [
</a><a href="#h56-0-96" id="h56-0-96" class="i">+                    Column {
</a><a href="#h56-0-97" id="h56-0-97" class="i">+                        name: &quot;id&quot;,
</a><a href="#h56-0-98" id="h56-0-98" class="i">+                        datatype: Integer,
</a><a href="#h56-0-99" id="h56-0-99" class="i">+                        primary_key: true,
</a><a href="#h56-0-100" id="h56-0-100" class="i">+                        nullable: false,
</a><a href="#h56-0-101" id="h56-0-101" class="i">+                        default: None,
</a><a href="#h56-0-102" id="h56-0-102" class="i">+                        unique: true,
</a><a href="#h56-0-103" id="h56-0-103" class="i">+                        references: None,
</a><a href="#h56-0-104" id="h56-0-104" class="i">+                        index: false,
</a><a href="#h56-0-105" id="h56-0-105" class="i">+                    },
</a><a href="#h56-0-106" id="h56-0-106" class="i">+                    Column {
</a><a href="#h56-0-107" id="h56-0-107" class="i">+                        name: &quot;name&quot;,
</a><a href="#h56-0-108" id="h56-0-108" class="i">+                        datatype: String,
</a><a href="#h56-0-109" id="h56-0-109" class="i">+                        primary_key: false,
</a><a href="#h56-0-110" id="h56-0-110" class="i">+                        nullable: false,
</a><a href="#h56-0-111" id="h56-0-111" class="i">+                        default: None,
</a><a href="#h56-0-112" id="h56-0-112" class="i">+                        unique: false,
</a><a href="#h56-0-113" id="h56-0-113" class="i">+                        references: None,
</a><a href="#h56-0-114" id="h56-0-114" class="i">+                        index: false,
</a><a href="#h56-0-115" id="h56-0-115" class="i">+                    },
</a><a href="#h56-0-116" id="h56-0-116" class="i">+                ],
</a><a href="#h56-0-117" id="h56-0-117" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h56-1" id="h56-1" class="h">@@ -104,7 +210,89 @@ Plan: Select(
</a> Optimized plan: Select(
     HashJoin {
         left: Scan {
<a href="#h56-1-3" id="h56-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h56-1-4" id="h56-1-4" class="i">+            table: Table {
</a><a href="#h56-1-5" id="h56-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h56-1-6" id="h56-1-6" class="i">+                columns: [
</a><a href="#h56-1-7" id="h56-1-7" class="i">+                    Column {
</a><a href="#h56-1-8" id="h56-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h56-1-9" id="h56-1-9" class="i">+                        datatype: Integer,
</a><a href="#h56-1-10" id="h56-1-10" class="i">+                        primary_key: true,
</a><a href="#h56-1-11" id="h56-1-11" class="i">+                        nullable: false,
</a><a href="#h56-1-12" id="h56-1-12" class="i">+                        default: None,
</a><a href="#h56-1-13" id="h56-1-13" class="i">+                        unique: true,
</a><a href="#h56-1-14" id="h56-1-14" class="i">+                        references: None,
</a><a href="#h56-1-15" id="h56-1-15" class="i">+                        index: false,
</a><a href="#h56-1-16" id="h56-1-16" class="i">+                    },
</a><a href="#h56-1-17" id="h56-1-17" class="i">+                    Column {
</a><a href="#h56-1-18" id="h56-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h56-1-19" id="h56-1-19" class="i">+                        datatype: String,
</a><a href="#h56-1-20" id="h56-1-20" class="i">+                        primary_key: false,
</a><a href="#h56-1-21" id="h56-1-21" class="i">+                        nullable: false,
</a><a href="#h56-1-22" id="h56-1-22" class="i">+                        default: None,
</a><a href="#h56-1-23" id="h56-1-23" class="i">+                        unique: false,
</a><a href="#h56-1-24" id="h56-1-24" class="i">+                        references: None,
</a><a href="#h56-1-25" id="h56-1-25" class="i">+                        index: false,
</a><a href="#h56-1-26" id="h56-1-26" class="i">+                    },
</a><a href="#h56-1-27" id="h56-1-27" class="i">+                    Column {
</a><a href="#h56-1-28" id="h56-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h56-1-29" id="h56-1-29" class="i">+                        datatype: Integer,
</a><a href="#h56-1-30" id="h56-1-30" class="i">+                        primary_key: false,
</a><a href="#h56-1-31" id="h56-1-31" class="i">+                        nullable: false,
</a><a href="#h56-1-32" id="h56-1-32" class="i">+                        default: None,
</a><a href="#h56-1-33" id="h56-1-33" class="i">+                        unique: false,
</a><a href="#h56-1-34" id="h56-1-34" class="i">+                        references: Some(
</a><a href="#h56-1-35" id="h56-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h56-1-36" id="h56-1-36" class="i">+                        ),
</a><a href="#h56-1-37" id="h56-1-37" class="i">+                        index: true,
</a><a href="#h56-1-38" id="h56-1-38" class="i">+                    },
</a><a href="#h56-1-39" id="h56-1-39" class="i">+                    Column {
</a><a href="#h56-1-40" id="h56-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h56-1-41" id="h56-1-41" class="i">+                        datatype: Integer,
</a><a href="#h56-1-42" id="h56-1-42" class="i">+                        primary_key: false,
</a><a href="#h56-1-43" id="h56-1-43" class="i">+                        nullable: false,
</a><a href="#h56-1-44" id="h56-1-44" class="i">+                        default: None,
</a><a href="#h56-1-45" id="h56-1-45" class="i">+                        unique: false,
</a><a href="#h56-1-46" id="h56-1-46" class="i">+                        references: Some(
</a><a href="#h56-1-47" id="h56-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h56-1-48" id="h56-1-48" class="i">+                        ),
</a><a href="#h56-1-49" id="h56-1-49" class="i">+                        index: true,
</a><a href="#h56-1-50" id="h56-1-50" class="i">+                    },
</a><a href="#h56-1-51" id="h56-1-51" class="i">+                    Column {
</a><a href="#h56-1-52" id="h56-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h56-1-53" id="h56-1-53" class="i">+                        datatype: Integer,
</a><a href="#h56-1-54" id="h56-1-54" class="i">+                        primary_key: false,
</a><a href="#h56-1-55" id="h56-1-55" class="i">+                        nullable: false,
</a><a href="#h56-1-56" id="h56-1-56" class="i">+                        default: None,
</a><a href="#h56-1-57" id="h56-1-57" class="i">+                        unique: false,
</a><a href="#h56-1-58" id="h56-1-58" class="i">+                        references: None,
</a><a href="#h56-1-59" id="h56-1-59" class="i">+                        index: false,
</a><a href="#h56-1-60" id="h56-1-60" class="i">+                    },
</a><a href="#h56-1-61" id="h56-1-61" class="i">+                    Column {
</a><a href="#h56-1-62" id="h56-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h56-1-63" id="h56-1-63" class="i">+                        datatype: Float,
</a><a href="#h56-1-64" id="h56-1-64" class="i">+                        primary_key: false,
</a><a href="#h56-1-65" id="h56-1-65" class="i">+                        nullable: true,
</a><a href="#h56-1-66" id="h56-1-66" class="i">+                        default: Some(
</a><a href="#h56-1-67" id="h56-1-67" class="i">+                            Null,
</a><a href="#h56-1-68" id="h56-1-68" class="i">+                        ),
</a><a href="#h56-1-69" id="h56-1-69" class="i">+                        unique: false,
</a><a href="#h56-1-70" id="h56-1-70" class="i">+                        references: None,
</a><a href="#h56-1-71" id="h56-1-71" class="i">+                        index: false,
</a><a href="#h56-1-72" id="h56-1-72" class="i">+                    },
</a><a href="#h56-1-73" id="h56-1-73" class="i">+                    Column {
</a><a href="#h56-1-74" id="h56-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h56-1-75" id="h56-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h56-1-76" id="h56-1-76" class="i">+                        primary_key: false,
</a><a href="#h56-1-77" id="h56-1-77" class="i">+                        nullable: true,
</a><a href="#h56-1-78" id="h56-1-78" class="i">+                        default: Some(
</a><a href="#h56-1-79" id="h56-1-79" class="i">+                            Null,
</a><a href="#h56-1-80" id="h56-1-80" class="i">+                        ),
</a><a href="#h56-1-81" id="h56-1-81" class="i">+                        unique: false,
</a><a href="#h56-1-82" id="h56-1-82" class="i">+                        references: None,
</a><a href="#h56-1-83" id="h56-1-83" class="i">+                        index: false,
</a><a href="#h56-1-84" id="h56-1-84" class="i">+                    },
</a><a href="#h56-1-85" id="h56-1-85" class="i">+                ],
</a><a href="#h56-1-86" id="h56-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h56-2" id="h56-2" class="h">@@ -120,7 +308,31 @@ Optimized plan: Select(
</a>             ),
         ),
         right: Scan {
<a href="#h56-2-3" id="h56-2-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h56-2-4" id="h56-2-4" class="i">+            table: Table {
</a><a href="#h56-2-5" id="h56-2-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h56-2-6" id="h56-2-6" class="i">+                columns: [
</a><a href="#h56-2-7" id="h56-2-7" class="i">+                    Column {
</a><a href="#h56-2-8" id="h56-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h56-2-9" id="h56-2-9" class="i">+                        datatype: Integer,
</a><a href="#h56-2-10" id="h56-2-10" class="i">+                        primary_key: true,
</a><a href="#h56-2-11" id="h56-2-11" class="i">+                        nullable: false,
</a><a href="#h56-2-12" id="h56-2-12" class="i">+                        default: None,
</a><a href="#h56-2-13" id="h56-2-13" class="i">+                        unique: true,
</a><a href="#h56-2-14" id="h56-2-14" class="i">+                        references: None,
</a><a href="#h56-2-15" id="h56-2-15" class="i">+                        index: false,
</a><a href="#h56-2-16" id="h56-2-16" class="i">+                    },
</a><a href="#h56-2-17" id="h56-2-17" class="i">+                    Column {
</a><a href="#h56-2-18" id="h56-2-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h56-2-19" id="h56-2-19" class="i">+                        datatype: String,
</a><a href="#h56-2-20" id="h56-2-20" class="i">+                        primary_key: false,
</a><a href="#h56-2-21" id="h56-2-21" class="i">+                        nullable: false,
</a><a href="#h56-2-22" id="h56-2-22" class="i">+                        default: None,
</a><a href="#h56-2-23" id="h56-2-23" class="i">+                        unique: false,
</a><a href="#h56-2-24" id="h56-2-24" class="i">+                        references: None,
</a><a href="#h56-2-25" id="h56-2-25" class="i">+                        index: false,
</a><a href="#h56-2-26" id="h56-2-26" class="i">+                    },
</a><a href="#h56-2-27" id="h56-2-27" class="i">+                ],
</a><a href="#h56-2-28" id="h56-2-28" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h57" href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -74,7 +74,89 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h57-0-3" id="h57-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h57-0-4" id="h57-0-4" class="i">+            table: Table {
</a><a href="#h57-0-5" id="h57-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h57-0-6" id="h57-0-6" class="i">+                columns: [
</a><a href="#h57-0-7" id="h57-0-7" class="i">+                    Column {
</a><a href="#h57-0-8" id="h57-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h57-0-9" id="h57-0-9" class="i">+                        datatype: Integer,
</a><a href="#h57-0-10" id="h57-0-10" class="i">+                        primary_key: true,
</a><a href="#h57-0-11" id="h57-0-11" class="i">+                        nullable: false,
</a><a href="#h57-0-12" id="h57-0-12" class="i">+                        default: None,
</a><a href="#h57-0-13" id="h57-0-13" class="i">+                        unique: true,
</a><a href="#h57-0-14" id="h57-0-14" class="i">+                        references: None,
</a><a href="#h57-0-15" id="h57-0-15" class="i">+                        index: false,
</a><a href="#h57-0-16" id="h57-0-16" class="i">+                    },
</a><a href="#h57-0-17" id="h57-0-17" class="i">+                    Column {
</a><a href="#h57-0-18" id="h57-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h57-0-19" id="h57-0-19" class="i">+                        datatype: String,
</a><a href="#h57-0-20" id="h57-0-20" class="i">+                        primary_key: false,
</a><a href="#h57-0-21" id="h57-0-21" class="i">+                        nullable: false,
</a><a href="#h57-0-22" id="h57-0-22" class="i">+                        default: None,
</a><a href="#h57-0-23" id="h57-0-23" class="i">+                        unique: false,
</a><a href="#h57-0-24" id="h57-0-24" class="i">+                        references: None,
</a><a href="#h57-0-25" id="h57-0-25" class="i">+                        index: false,
</a><a href="#h57-0-26" id="h57-0-26" class="i">+                    },
</a><a href="#h57-0-27" id="h57-0-27" class="i">+                    Column {
</a><a href="#h57-0-28" id="h57-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h57-0-29" id="h57-0-29" class="i">+                        datatype: Integer,
</a><a href="#h57-0-30" id="h57-0-30" class="i">+                        primary_key: false,
</a><a href="#h57-0-31" id="h57-0-31" class="i">+                        nullable: false,
</a><a href="#h57-0-32" id="h57-0-32" class="i">+                        default: None,
</a><a href="#h57-0-33" id="h57-0-33" class="i">+                        unique: false,
</a><a href="#h57-0-34" id="h57-0-34" class="i">+                        references: Some(
</a><a href="#h57-0-35" id="h57-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h57-0-36" id="h57-0-36" class="i">+                        ),
</a><a href="#h57-0-37" id="h57-0-37" class="i">+                        index: true,
</a><a href="#h57-0-38" id="h57-0-38" class="i">+                    },
</a><a href="#h57-0-39" id="h57-0-39" class="i">+                    Column {
</a><a href="#h57-0-40" id="h57-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h57-0-41" id="h57-0-41" class="i">+                        datatype: Integer,
</a><a href="#h57-0-42" id="h57-0-42" class="i">+                        primary_key: false,
</a><a href="#h57-0-43" id="h57-0-43" class="i">+                        nullable: false,
</a><a href="#h57-0-44" id="h57-0-44" class="i">+                        default: None,
</a><a href="#h57-0-45" id="h57-0-45" class="i">+                        unique: false,
</a><a href="#h57-0-46" id="h57-0-46" class="i">+                        references: Some(
</a><a href="#h57-0-47" id="h57-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h57-0-48" id="h57-0-48" class="i">+                        ),
</a><a href="#h57-0-49" id="h57-0-49" class="i">+                        index: true,
</a><a href="#h57-0-50" id="h57-0-50" class="i">+                    },
</a><a href="#h57-0-51" id="h57-0-51" class="i">+                    Column {
</a><a href="#h57-0-52" id="h57-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h57-0-53" id="h57-0-53" class="i">+                        datatype: Integer,
</a><a href="#h57-0-54" id="h57-0-54" class="i">+                        primary_key: false,
</a><a href="#h57-0-55" id="h57-0-55" class="i">+                        nullable: false,
</a><a href="#h57-0-56" id="h57-0-56" class="i">+                        default: None,
</a><a href="#h57-0-57" id="h57-0-57" class="i">+                        unique: false,
</a><a href="#h57-0-58" id="h57-0-58" class="i">+                        references: None,
</a><a href="#h57-0-59" id="h57-0-59" class="i">+                        index: false,
</a><a href="#h57-0-60" id="h57-0-60" class="i">+                    },
</a><a href="#h57-0-61" id="h57-0-61" class="i">+                    Column {
</a><a href="#h57-0-62" id="h57-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h57-0-63" id="h57-0-63" class="i">+                        datatype: Float,
</a><a href="#h57-0-64" id="h57-0-64" class="i">+                        primary_key: false,
</a><a href="#h57-0-65" id="h57-0-65" class="i">+                        nullable: true,
</a><a href="#h57-0-66" id="h57-0-66" class="i">+                        default: Some(
</a><a href="#h57-0-67" id="h57-0-67" class="i">+                            Null,
</a><a href="#h57-0-68" id="h57-0-68" class="i">+                        ),
</a><a href="#h57-0-69" id="h57-0-69" class="i">+                        unique: false,
</a><a href="#h57-0-70" id="h57-0-70" class="i">+                        references: None,
</a><a href="#h57-0-71" id="h57-0-71" class="i">+                        index: false,
</a><a href="#h57-0-72" id="h57-0-72" class="i">+                    },
</a><a href="#h57-0-73" id="h57-0-73" class="i">+                    Column {
</a><a href="#h57-0-74" id="h57-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h57-0-75" id="h57-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h57-0-76" id="h57-0-76" class="i">+                        primary_key: false,
</a><a href="#h57-0-77" id="h57-0-77" class="i">+                        nullable: true,
</a><a href="#h57-0-78" id="h57-0-78" class="i">+                        default: Some(
</a><a href="#h57-0-79" id="h57-0-79" class="i">+                            Null,
</a><a href="#h57-0-80" id="h57-0-80" class="i">+                        ),
</a><a href="#h57-0-81" id="h57-0-81" class="i">+                        unique: false,
</a><a href="#h57-0-82" id="h57-0-82" class="i">+                        references: None,
</a><a href="#h57-0-83" id="h57-0-83" class="i">+                        index: false,
</a><a href="#h57-0-84" id="h57-0-84" class="i">+                    },
</a><a href="#h57-0-85" id="h57-0-85" class="i">+                ],
</a><a href="#h57-0-86" id="h57-0-86" class="i">+            },
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h57-1" id="h57-1" class="h">@@ -82,7 +164,31 @@ Plan: Select(
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h57-1-3" id="h57-1-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h57-1-4" id="h57-1-4" class="i">+            table: Table {
</a><a href="#h57-1-5" id="h57-1-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h57-1-6" id="h57-1-6" class="i">+                columns: [
</a><a href="#h57-1-7" id="h57-1-7" class="i">+                    Column {
</a><a href="#h57-1-8" id="h57-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h57-1-9" id="h57-1-9" class="i">+                        datatype: Integer,
</a><a href="#h57-1-10" id="h57-1-10" class="i">+                        primary_key: true,
</a><a href="#h57-1-11" id="h57-1-11" class="i">+                        nullable: false,
</a><a href="#h57-1-12" id="h57-1-12" class="i">+                        default: None,
</a><a href="#h57-1-13" id="h57-1-13" class="i">+                        unique: true,
</a><a href="#h57-1-14" id="h57-1-14" class="i">+                        references: None,
</a><a href="#h57-1-15" id="h57-1-15" class="i">+                        index: false,
</a><a href="#h57-1-16" id="h57-1-16" class="i">+                    },
</a><a href="#h57-1-17" id="h57-1-17" class="i">+                    Column {
</a><a href="#h57-1-18" id="h57-1-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h57-1-19" id="h57-1-19" class="i">+                        datatype: String,
</a><a href="#h57-1-20" id="h57-1-20" class="i">+                        primary_key: false,
</a><a href="#h57-1-21" id="h57-1-21" class="i">+                        nullable: false,
</a><a href="#h57-1-22" id="h57-1-22" class="i">+                        default: None,
</a><a href="#h57-1-23" id="h57-1-23" class="i">+                        unique: false,
</a><a href="#h57-1-24" id="h57-1-24" class="i">+                        references: None,
</a><a href="#h57-1-25" id="h57-1-25" class="i">+                        index: false,
</a><a href="#h57-1-26" id="h57-1-26" class="i">+                    },
</a><a href="#h57-1-27" id="h57-1-27" class="i">+                ],
</a><a href="#h57-1-28" id="h57-1-28" class="i">+            },
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<a href="#h57-2" id="h57-2" class="h">@@ -141,7 +247,89 @@ Plan: Select(
</a> Optimized plan: Select(
     HashJoin {
         left: IndexLookup {
<a href="#h57-2-3" id="h57-2-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h57-2-4" id="h57-2-4" class="i">+            table: Table {
</a><a href="#h57-2-5" id="h57-2-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h57-2-6" id="h57-2-6" class="i">+                columns: [
</a><a href="#h57-2-7" id="h57-2-7" class="i">+                    Column {
</a><a href="#h57-2-8" id="h57-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h57-2-9" id="h57-2-9" class="i">+                        datatype: Integer,
</a><a href="#h57-2-10" id="h57-2-10" class="i">+                        primary_key: true,
</a><a href="#h57-2-11" id="h57-2-11" class="i">+                        nullable: false,
</a><a href="#h57-2-12" id="h57-2-12" class="i">+                        default: None,
</a><a href="#h57-2-13" id="h57-2-13" class="i">+                        unique: true,
</a><a href="#h57-2-14" id="h57-2-14" class="i">+                        references: None,
</a><a href="#h57-2-15" id="h57-2-15" class="i">+                        index: false,
</a><a href="#h57-2-16" id="h57-2-16" class="i">+                    },
</a><a href="#h57-2-17" id="h57-2-17" class="i">+                    Column {
</a><a href="#h57-2-18" id="h57-2-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h57-2-19" id="h57-2-19" class="i">+                        datatype: String,
</a><a href="#h57-2-20" id="h57-2-20" class="i">+                        primary_key: false,
</a><a href="#h57-2-21" id="h57-2-21" class="i">+                        nullable: false,
</a><a href="#h57-2-22" id="h57-2-22" class="i">+                        default: None,
</a><a href="#h57-2-23" id="h57-2-23" class="i">+                        unique: false,
</a><a href="#h57-2-24" id="h57-2-24" class="i">+                        references: None,
</a><a href="#h57-2-25" id="h57-2-25" class="i">+                        index: false,
</a><a href="#h57-2-26" id="h57-2-26" class="i">+                    },
</a><a href="#h57-2-27" id="h57-2-27" class="i">+                    Column {
</a><a href="#h57-2-28" id="h57-2-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h57-2-29" id="h57-2-29" class="i">+                        datatype: Integer,
</a><a href="#h57-2-30" id="h57-2-30" class="i">+                        primary_key: false,
</a><a href="#h57-2-31" id="h57-2-31" class="i">+                        nullable: false,
</a><a href="#h57-2-32" id="h57-2-32" class="i">+                        default: None,
</a><a href="#h57-2-33" id="h57-2-33" class="i">+                        unique: false,
</a><a href="#h57-2-34" id="h57-2-34" class="i">+                        references: Some(
</a><a href="#h57-2-35" id="h57-2-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h57-2-36" id="h57-2-36" class="i">+                        ),
</a><a href="#h57-2-37" id="h57-2-37" class="i">+                        index: true,
</a><a href="#h57-2-38" id="h57-2-38" class="i">+                    },
</a><a href="#h57-2-39" id="h57-2-39" class="i">+                    Column {
</a><a href="#h57-2-40" id="h57-2-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h57-2-41" id="h57-2-41" class="i">+                        datatype: Integer,
</a><a href="#h57-2-42" id="h57-2-42" class="i">+                        primary_key: false,
</a><a href="#h57-2-43" id="h57-2-43" class="i">+                        nullable: false,
</a><a href="#h57-2-44" id="h57-2-44" class="i">+                        default: None,
</a><a href="#h57-2-45" id="h57-2-45" class="i">+                        unique: false,
</a><a href="#h57-2-46" id="h57-2-46" class="i">+                        references: Some(
</a><a href="#h57-2-47" id="h57-2-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h57-2-48" id="h57-2-48" class="i">+                        ),
</a><a href="#h57-2-49" id="h57-2-49" class="i">+                        index: true,
</a><a href="#h57-2-50" id="h57-2-50" class="i">+                    },
</a><a href="#h57-2-51" id="h57-2-51" class="i">+                    Column {
</a><a href="#h57-2-52" id="h57-2-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h57-2-53" id="h57-2-53" class="i">+                        datatype: Integer,
</a><a href="#h57-2-54" id="h57-2-54" class="i">+                        primary_key: false,
</a><a href="#h57-2-55" id="h57-2-55" class="i">+                        nullable: false,
</a><a href="#h57-2-56" id="h57-2-56" class="i">+                        default: None,
</a><a href="#h57-2-57" id="h57-2-57" class="i">+                        unique: false,
</a><a href="#h57-2-58" id="h57-2-58" class="i">+                        references: None,
</a><a href="#h57-2-59" id="h57-2-59" class="i">+                        index: false,
</a><a href="#h57-2-60" id="h57-2-60" class="i">+                    },
</a><a href="#h57-2-61" id="h57-2-61" class="i">+                    Column {
</a><a href="#h57-2-62" id="h57-2-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h57-2-63" id="h57-2-63" class="i">+                        datatype: Float,
</a><a href="#h57-2-64" id="h57-2-64" class="i">+                        primary_key: false,
</a><a href="#h57-2-65" id="h57-2-65" class="i">+                        nullable: true,
</a><a href="#h57-2-66" id="h57-2-66" class="i">+                        default: Some(
</a><a href="#h57-2-67" id="h57-2-67" class="i">+                            Null,
</a><a href="#h57-2-68" id="h57-2-68" class="i">+                        ),
</a><a href="#h57-2-69" id="h57-2-69" class="i">+                        unique: false,
</a><a href="#h57-2-70" id="h57-2-70" class="i">+                        references: None,
</a><a href="#h57-2-71" id="h57-2-71" class="i">+                        index: false,
</a><a href="#h57-2-72" id="h57-2-72" class="i">+                    },
</a><a href="#h57-2-73" id="h57-2-73" class="i">+                    Column {
</a><a href="#h57-2-74" id="h57-2-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h57-2-75" id="h57-2-75" class="i">+                        datatype: Boolean,
</a><a href="#h57-2-76" id="h57-2-76" class="i">+                        primary_key: false,
</a><a href="#h57-2-77" id="h57-2-77" class="i">+                        nullable: true,
</a><a href="#h57-2-78" id="h57-2-78" class="i">+                        default: Some(
</a><a href="#h57-2-79" id="h57-2-79" class="i">+                            Null,
</a><a href="#h57-2-80" id="h57-2-80" class="i">+                        ),
</a><a href="#h57-2-81" id="h57-2-81" class="i">+                        unique: false,
</a><a href="#h57-2-82" id="h57-2-82" class="i">+                        references: None,
</a><a href="#h57-2-83" id="h57-2-83" class="i">+                        index: false,
</a><a href="#h57-2-84" id="h57-2-84" class="i">+                    },
</a><a href="#h57-2-85" id="h57-2-85" class="i">+                ],
</a><a href="#h57-2-86" id="h57-2-86" class="i">+            },
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h57-3" id="h57-3" class="h">@@ -164,7 +352,31 @@ Optimized plan: Select(
</a>             ),
         ),
         right: KeyLookup {
<a href="#h57-3-3" id="h57-3-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h57-3-4" id="h57-3-4" class="i">+            table: Table {
</a><a href="#h57-3-5" id="h57-3-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h57-3-6" id="h57-3-6" class="i">+                columns: [
</a><a href="#h57-3-7" id="h57-3-7" class="i">+                    Column {
</a><a href="#h57-3-8" id="h57-3-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h57-3-9" id="h57-3-9" class="i">+                        datatype: Integer,
</a><a href="#h57-3-10" id="h57-3-10" class="i">+                        primary_key: true,
</a><a href="#h57-3-11" id="h57-3-11" class="i">+                        nullable: false,
</a><a href="#h57-3-12" id="h57-3-12" class="i">+                        default: None,
</a><a href="#h57-3-13" id="h57-3-13" class="i">+                        unique: true,
</a><a href="#h57-3-14" id="h57-3-14" class="i">+                        references: None,
</a><a href="#h57-3-15" id="h57-3-15" class="i">+                        index: false,
</a><a href="#h57-3-16" id="h57-3-16" class="i">+                    },
</a><a href="#h57-3-17" id="h57-3-17" class="i">+                    Column {
</a><a href="#h57-3-18" id="h57-3-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h57-3-19" id="h57-3-19" class="i">+                        datatype: String,
</a><a href="#h57-3-20" id="h57-3-20" class="i">+                        primary_key: false,
</a><a href="#h57-3-21" id="h57-3-21" class="i">+                        nullable: false,
</a><a href="#h57-3-22" id="h57-3-22" class="i">+                        default: None,
</a><a href="#h57-3-23" id="h57-3-23" class="i">+                        unique: false,
</a><a href="#h57-3-24" id="h57-3-24" class="i">+                        references: None,
</a><a href="#h57-3-25" id="h57-3-25" class="i">+                        index: false,
</a><a href="#h57-3-26" id="h57-3-26" class="i">+                    },
</a><a href="#h57-3-27" id="h57-3-27" class="i">+                ],
</a><a href="#h57-3-28" id="h57-3-28" class="i">+            },
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<b>diff --git a/<a id="h58" href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -72,7 +72,89 @@ Plan: Select(
</a>     Filter {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h58-0-3" id="h58-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h58-0-4" id="h58-0-4" class="i">+                table: Table {
</a><a href="#h58-0-5" id="h58-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h58-0-6" id="h58-0-6" class="i">+                    columns: [
</a><a href="#h58-0-7" id="h58-0-7" class="i">+                        Column {
</a><a href="#h58-0-8" id="h58-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h58-0-9" id="h58-0-9" class="i">+                            datatype: Integer,
</a><a href="#h58-0-10" id="h58-0-10" class="i">+                            primary_key: true,
</a><a href="#h58-0-11" id="h58-0-11" class="i">+                            nullable: false,
</a><a href="#h58-0-12" id="h58-0-12" class="i">+                            default: None,
</a><a href="#h58-0-13" id="h58-0-13" class="i">+                            unique: true,
</a><a href="#h58-0-14" id="h58-0-14" class="i">+                            references: None,
</a><a href="#h58-0-15" id="h58-0-15" class="i">+                            index: false,
</a><a href="#h58-0-16" id="h58-0-16" class="i">+                        },
</a><a href="#h58-0-17" id="h58-0-17" class="i">+                        Column {
</a><a href="#h58-0-18" id="h58-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h58-0-19" id="h58-0-19" class="i">+                            datatype: String,
</a><a href="#h58-0-20" id="h58-0-20" class="i">+                            primary_key: false,
</a><a href="#h58-0-21" id="h58-0-21" class="i">+                            nullable: false,
</a><a href="#h58-0-22" id="h58-0-22" class="i">+                            default: None,
</a><a href="#h58-0-23" id="h58-0-23" class="i">+                            unique: false,
</a><a href="#h58-0-24" id="h58-0-24" class="i">+                            references: None,
</a><a href="#h58-0-25" id="h58-0-25" class="i">+                            index: false,
</a><a href="#h58-0-26" id="h58-0-26" class="i">+                        },
</a><a href="#h58-0-27" id="h58-0-27" class="i">+                        Column {
</a><a href="#h58-0-28" id="h58-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h58-0-29" id="h58-0-29" class="i">+                            datatype: Integer,
</a><a href="#h58-0-30" id="h58-0-30" class="i">+                            primary_key: false,
</a><a href="#h58-0-31" id="h58-0-31" class="i">+                            nullable: false,
</a><a href="#h58-0-32" id="h58-0-32" class="i">+                            default: None,
</a><a href="#h58-0-33" id="h58-0-33" class="i">+                            unique: false,
</a><a href="#h58-0-34" id="h58-0-34" class="i">+                            references: Some(
</a><a href="#h58-0-35" id="h58-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h58-0-36" id="h58-0-36" class="i">+                            ),
</a><a href="#h58-0-37" id="h58-0-37" class="i">+                            index: true,
</a><a href="#h58-0-38" id="h58-0-38" class="i">+                        },
</a><a href="#h58-0-39" id="h58-0-39" class="i">+                        Column {
</a><a href="#h58-0-40" id="h58-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h58-0-41" id="h58-0-41" class="i">+                            datatype: Integer,
</a><a href="#h58-0-42" id="h58-0-42" class="i">+                            primary_key: false,
</a><a href="#h58-0-43" id="h58-0-43" class="i">+                            nullable: false,
</a><a href="#h58-0-44" id="h58-0-44" class="i">+                            default: None,
</a><a href="#h58-0-45" id="h58-0-45" class="i">+                            unique: false,
</a><a href="#h58-0-46" id="h58-0-46" class="i">+                            references: Some(
</a><a href="#h58-0-47" id="h58-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h58-0-48" id="h58-0-48" class="i">+                            ),
</a><a href="#h58-0-49" id="h58-0-49" class="i">+                            index: true,
</a><a href="#h58-0-50" id="h58-0-50" class="i">+                        },
</a><a href="#h58-0-51" id="h58-0-51" class="i">+                        Column {
</a><a href="#h58-0-52" id="h58-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h58-0-53" id="h58-0-53" class="i">+                            datatype: Integer,
</a><a href="#h58-0-54" id="h58-0-54" class="i">+                            primary_key: false,
</a><a href="#h58-0-55" id="h58-0-55" class="i">+                            nullable: false,
</a><a href="#h58-0-56" id="h58-0-56" class="i">+                            default: None,
</a><a href="#h58-0-57" id="h58-0-57" class="i">+                            unique: false,
</a><a href="#h58-0-58" id="h58-0-58" class="i">+                            references: None,
</a><a href="#h58-0-59" id="h58-0-59" class="i">+                            index: false,
</a><a href="#h58-0-60" id="h58-0-60" class="i">+                        },
</a><a href="#h58-0-61" id="h58-0-61" class="i">+                        Column {
</a><a href="#h58-0-62" id="h58-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h58-0-63" id="h58-0-63" class="i">+                            datatype: Float,
</a><a href="#h58-0-64" id="h58-0-64" class="i">+                            primary_key: false,
</a><a href="#h58-0-65" id="h58-0-65" class="i">+                            nullable: true,
</a><a href="#h58-0-66" id="h58-0-66" class="i">+                            default: Some(
</a><a href="#h58-0-67" id="h58-0-67" class="i">+                                Null,
</a><a href="#h58-0-68" id="h58-0-68" class="i">+                            ),
</a><a href="#h58-0-69" id="h58-0-69" class="i">+                            unique: false,
</a><a href="#h58-0-70" id="h58-0-70" class="i">+                            references: None,
</a><a href="#h58-0-71" id="h58-0-71" class="i">+                            index: false,
</a><a href="#h58-0-72" id="h58-0-72" class="i">+                        },
</a><a href="#h58-0-73" id="h58-0-73" class="i">+                        Column {
</a><a href="#h58-0-74" id="h58-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h58-0-75" id="h58-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h58-0-76" id="h58-0-76" class="i">+                            primary_key: false,
</a><a href="#h58-0-77" id="h58-0-77" class="i">+                            nullable: true,
</a><a href="#h58-0-78" id="h58-0-78" class="i">+                            default: Some(
</a><a href="#h58-0-79" id="h58-0-79" class="i">+                                Null,
</a><a href="#h58-0-80" id="h58-0-80" class="i">+                            ),
</a><a href="#h58-0-81" id="h58-0-81" class="i">+                            unique: false,
</a><a href="#h58-0-82" id="h58-0-82" class="i">+                            references: None,
</a><a href="#h58-0-83" id="h58-0-83" class="i">+                            index: false,
</a><a href="#h58-0-84" id="h58-0-84" class="i">+                        },
</a><a href="#h58-0-85" id="h58-0-85" class="i">+                    ],
</a><a href="#h58-0-86" id="h58-0-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h58-1" id="h58-1" class="h">@@ -80,7 +162,31 @@ Plan: Select(
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h58-1-3" id="h58-1-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h58-1-4" id="h58-1-4" class="i">+                table: Table {
</a><a href="#h58-1-5" id="h58-1-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h58-1-6" id="h58-1-6" class="i">+                    columns: [
</a><a href="#h58-1-7" id="h58-1-7" class="i">+                        Column {
</a><a href="#h58-1-8" id="h58-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h58-1-9" id="h58-1-9" class="i">+                            datatype: Integer,
</a><a href="#h58-1-10" id="h58-1-10" class="i">+                            primary_key: true,
</a><a href="#h58-1-11" id="h58-1-11" class="i">+                            nullable: false,
</a><a href="#h58-1-12" id="h58-1-12" class="i">+                            default: None,
</a><a href="#h58-1-13" id="h58-1-13" class="i">+                            unique: true,
</a><a href="#h58-1-14" id="h58-1-14" class="i">+                            references: None,
</a><a href="#h58-1-15" id="h58-1-15" class="i">+                            index: false,
</a><a href="#h58-1-16" id="h58-1-16" class="i">+                        },
</a><a href="#h58-1-17" id="h58-1-17" class="i">+                        Column {
</a><a href="#h58-1-18" id="h58-1-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h58-1-19" id="h58-1-19" class="i">+                            datatype: String,
</a><a href="#h58-1-20" id="h58-1-20" class="i">+                            primary_key: false,
</a><a href="#h58-1-21" id="h58-1-21" class="i">+                            nullable: false,
</a><a href="#h58-1-22" id="h58-1-22" class="i">+                            default: None,
</a><a href="#h58-1-23" id="h58-1-23" class="i">+                            unique: false,
</a><a href="#h58-1-24" id="h58-1-24" class="i">+                            references: None,
</a><a href="#h58-1-25" id="h58-1-25" class="i">+                            index: false,
</a><a href="#h58-1-26" id="h58-1-26" class="i">+                        },
</a><a href="#h58-1-27" id="h58-1-27" class="i">+                    ],
</a><a href="#h58-1-28" id="h58-1-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h58-2" id="h58-2" class="h">@@ -138,7 +244,89 @@ Plan: Select(
</a> Optimized plan: Select(
     HashJoin {
         left: IndexLookup {
<a href="#h58-2-3" id="h58-2-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h58-2-4" id="h58-2-4" class="i">+            table: Table {
</a><a href="#h58-2-5" id="h58-2-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h58-2-6" id="h58-2-6" class="i">+                columns: [
</a><a href="#h58-2-7" id="h58-2-7" class="i">+                    Column {
</a><a href="#h58-2-8" id="h58-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h58-2-9" id="h58-2-9" class="i">+                        datatype: Integer,
</a><a href="#h58-2-10" id="h58-2-10" class="i">+                        primary_key: true,
</a><a href="#h58-2-11" id="h58-2-11" class="i">+                        nullable: false,
</a><a href="#h58-2-12" id="h58-2-12" class="i">+                        default: None,
</a><a href="#h58-2-13" id="h58-2-13" class="i">+                        unique: true,
</a><a href="#h58-2-14" id="h58-2-14" class="i">+                        references: None,
</a><a href="#h58-2-15" id="h58-2-15" class="i">+                        index: false,
</a><a href="#h58-2-16" id="h58-2-16" class="i">+                    },
</a><a href="#h58-2-17" id="h58-2-17" class="i">+                    Column {
</a><a href="#h58-2-18" id="h58-2-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h58-2-19" id="h58-2-19" class="i">+                        datatype: String,
</a><a href="#h58-2-20" id="h58-2-20" class="i">+                        primary_key: false,
</a><a href="#h58-2-21" id="h58-2-21" class="i">+                        nullable: false,
</a><a href="#h58-2-22" id="h58-2-22" class="i">+                        default: None,
</a><a href="#h58-2-23" id="h58-2-23" class="i">+                        unique: false,
</a><a href="#h58-2-24" id="h58-2-24" class="i">+                        references: None,
</a><a href="#h58-2-25" id="h58-2-25" class="i">+                        index: false,
</a><a href="#h58-2-26" id="h58-2-26" class="i">+                    },
</a><a href="#h58-2-27" id="h58-2-27" class="i">+                    Column {
</a><a href="#h58-2-28" id="h58-2-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h58-2-29" id="h58-2-29" class="i">+                        datatype: Integer,
</a><a href="#h58-2-30" id="h58-2-30" class="i">+                        primary_key: false,
</a><a href="#h58-2-31" id="h58-2-31" class="i">+                        nullable: false,
</a><a href="#h58-2-32" id="h58-2-32" class="i">+                        default: None,
</a><a href="#h58-2-33" id="h58-2-33" class="i">+                        unique: false,
</a><a href="#h58-2-34" id="h58-2-34" class="i">+                        references: Some(
</a><a href="#h58-2-35" id="h58-2-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h58-2-36" id="h58-2-36" class="i">+                        ),
</a><a href="#h58-2-37" id="h58-2-37" class="i">+                        index: true,
</a><a href="#h58-2-38" id="h58-2-38" class="i">+                    },
</a><a href="#h58-2-39" id="h58-2-39" class="i">+                    Column {
</a><a href="#h58-2-40" id="h58-2-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h58-2-41" id="h58-2-41" class="i">+                        datatype: Integer,
</a><a href="#h58-2-42" id="h58-2-42" class="i">+                        primary_key: false,
</a><a href="#h58-2-43" id="h58-2-43" class="i">+                        nullable: false,
</a><a href="#h58-2-44" id="h58-2-44" class="i">+                        default: None,
</a><a href="#h58-2-45" id="h58-2-45" class="i">+                        unique: false,
</a><a href="#h58-2-46" id="h58-2-46" class="i">+                        references: Some(
</a><a href="#h58-2-47" id="h58-2-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h58-2-48" id="h58-2-48" class="i">+                        ),
</a><a href="#h58-2-49" id="h58-2-49" class="i">+                        index: true,
</a><a href="#h58-2-50" id="h58-2-50" class="i">+                    },
</a><a href="#h58-2-51" id="h58-2-51" class="i">+                    Column {
</a><a href="#h58-2-52" id="h58-2-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h58-2-53" id="h58-2-53" class="i">+                        datatype: Integer,
</a><a href="#h58-2-54" id="h58-2-54" class="i">+                        primary_key: false,
</a><a href="#h58-2-55" id="h58-2-55" class="i">+                        nullable: false,
</a><a href="#h58-2-56" id="h58-2-56" class="i">+                        default: None,
</a><a href="#h58-2-57" id="h58-2-57" class="i">+                        unique: false,
</a><a href="#h58-2-58" id="h58-2-58" class="i">+                        references: None,
</a><a href="#h58-2-59" id="h58-2-59" class="i">+                        index: false,
</a><a href="#h58-2-60" id="h58-2-60" class="i">+                    },
</a><a href="#h58-2-61" id="h58-2-61" class="i">+                    Column {
</a><a href="#h58-2-62" id="h58-2-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h58-2-63" id="h58-2-63" class="i">+                        datatype: Float,
</a><a href="#h58-2-64" id="h58-2-64" class="i">+                        primary_key: false,
</a><a href="#h58-2-65" id="h58-2-65" class="i">+                        nullable: true,
</a><a href="#h58-2-66" id="h58-2-66" class="i">+                        default: Some(
</a><a href="#h58-2-67" id="h58-2-67" class="i">+                            Null,
</a><a href="#h58-2-68" id="h58-2-68" class="i">+                        ),
</a><a href="#h58-2-69" id="h58-2-69" class="i">+                        unique: false,
</a><a href="#h58-2-70" id="h58-2-70" class="i">+                        references: None,
</a><a href="#h58-2-71" id="h58-2-71" class="i">+                        index: false,
</a><a href="#h58-2-72" id="h58-2-72" class="i">+                    },
</a><a href="#h58-2-73" id="h58-2-73" class="i">+                    Column {
</a><a href="#h58-2-74" id="h58-2-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h58-2-75" id="h58-2-75" class="i">+                        datatype: Boolean,
</a><a href="#h58-2-76" id="h58-2-76" class="i">+                        primary_key: false,
</a><a href="#h58-2-77" id="h58-2-77" class="i">+                        nullable: true,
</a><a href="#h58-2-78" id="h58-2-78" class="i">+                        default: Some(
</a><a href="#h58-2-79" id="h58-2-79" class="i">+                            Null,
</a><a href="#h58-2-80" id="h58-2-80" class="i">+                        ),
</a><a href="#h58-2-81" id="h58-2-81" class="i">+                        unique: false,
</a><a href="#h58-2-82" id="h58-2-82" class="i">+                        references: None,
</a><a href="#h58-2-83" id="h58-2-83" class="i">+                        index: false,
</a><a href="#h58-2-84" id="h58-2-84" class="i">+                    },
</a><a href="#h58-2-85" id="h58-2-85" class="i">+                ],
</a><a href="#h58-2-86" id="h58-2-86" class="i">+            },
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h58-3" id="h58-3" class="h">@@ -161,7 +349,31 @@ Optimized plan: Select(
</a>             ),
         ),
         right: KeyLookup {
<a href="#h58-3-3" id="h58-3-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h58-3-4" id="h58-3-4" class="i">+            table: Table {
</a><a href="#h58-3-5" id="h58-3-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h58-3-6" id="h58-3-6" class="i">+                columns: [
</a><a href="#h58-3-7" id="h58-3-7" class="i">+                    Column {
</a><a href="#h58-3-8" id="h58-3-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h58-3-9" id="h58-3-9" class="i">+                        datatype: Integer,
</a><a href="#h58-3-10" id="h58-3-10" class="i">+                        primary_key: true,
</a><a href="#h58-3-11" id="h58-3-11" class="i">+                        nullable: false,
</a><a href="#h58-3-12" id="h58-3-12" class="i">+                        default: None,
</a><a href="#h58-3-13" id="h58-3-13" class="i">+                        unique: true,
</a><a href="#h58-3-14" id="h58-3-14" class="i">+                        references: None,
</a><a href="#h58-3-15" id="h58-3-15" class="i">+                        index: false,
</a><a href="#h58-3-16" id="h58-3-16" class="i">+                    },
</a><a href="#h58-3-17" id="h58-3-17" class="i">+                    Column {
</a><a href="#h58-3-18" id="h58-3-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h58-3-19" id="h58-3-19" class="i">+                        datatype: String,
</a><a href="#h58-3-20" id="h58-3-20" class="i">+                        primary_key: false,
</a><a href="#h58-3-21" id="h58-3-21" class="i">+                        nullable: false,
</a><a href="#h58-3-22" id="h58-3-22" class="i">+                        default: None,
</a><a href="#h58-3-23" id="h58-3-23" class="i">+                        unique: false,
</a><a href="#h58-3-24" id="h58-3-24" class="i">+                        references: None,
</a><a href="#h58-3-25" id="h58-3-25" class="i">+                        index: false,
</a><a href="#h58-3-26" id="h58-3-26" class="i">+                    },
</a><a href="#h58-3-27" id="h58-3-27" class="i">+                ],
</a><a href="#h58-3-28" id="h58-3-28" class="i">+            },
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<b>diff --git a/<a id="h59" href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a> b/<a href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -127,13 +127,119 @@ Plan: Select(
</a>         source: NestedLoopJoin {
             left: NestedLoopJoin {
                 left: Scan {
<a href="#h59-0-3" id="h59-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h59-0-4" id="h59-0-4" class="i">+                    table: Table {
</a><a href="#h59-0-5" id="h59-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h59-0-6" id="h59-0-6" class="i">+                        columns: [
</a><a href="#h59-0-7" id="h59-0-7" class="i">+                            Column {
</a><a href="#h59-0-8" id="h59-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h59-0-9" id="h59-0-9" class="i">+                                datatype: Integer,
</a><a href="#h59-0-10" id="h59-0-10" class="i">+                                primary_key: true,
</a><a href="#h59-0-11" id="h59-0-11" class="i">+                                nullable: false,
</a><a href="#h59-0-12" id="h59-0-12" class="i">+                                default: None,
</a><a href="#h59-0-13" id="h59-0-13" class="i">+                                unique: true,
</a><a href="#h59-0-14" id="h59-0-14" class="i">+                                references: None,
</a><a href="#h59-0-15" id="h59-0-15" class="i">+                                index: false,
</a><a href="#h59-0-16" id="h59-0-16" class="i">+                            },
</a><a href="#h59-0-17" id="h59-0-17" class="i">+                            Column {
</a><a href="#h59-0-18" id="h59-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h59-0-19" id="h59-0-19" class="i">+                                datatype: String,
</a><a href="#h59-0-20" id="h59-0-20" class="i">+                                primary_key: false,
</a><a href="#h59-0-21" id="h59-0-21" class="i">+                                nullable: false,
</a><a href="#h59-0-22" id="h59-0-22" class="i">+                                default: None,
</a><a href="#h59-0-23" id="h59-0-23" class="i">+                                unique: false,
</a><a href="#h59-0-24" id="h59-0-24" class="i">+                                references: None,
</a><a href="#h59-0-25" id="h59-0-25" class="i">+                                index: false,
</a><a href="#h59-0-26" id="h59-0-26" class="i">+                            },
</a><a href="#h59-0-27" id="h59-0-27" class="i">+                            Column {
</a><a href="#h59-0-28" id="h59-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h59-0-29" id="h59-0-29" class="i">+                                datatype: Integer,
</a><a href="#h59-0-30" id="h59-0-30" class="i">+                                primary_key: false,
</a><a href="#h59-0-31" id="h59-0-31" class="i">+                                nullable: false,
</a><a href="#h59-0-32" id="h59-0-32" class="i">+                                default: None,
</a><a href="#h59-0-33" id="h59-0-33" class="i">+                                unique: false,
</a><a href="#h59-0-34" id="h59-0-34" class="i">+                                references: Some(
</a><a href="#h59-0-35" id="h59-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h59-0-36" id="h59-0-36" class="i">+                                ),
</a><a href="#h59-0-37" id="h59-0-37" class="i">+                                index: true,
</a><a href="#h59-0-38" id="h59-0-38" class="i">+                            },
</a><a href="#h59-0-39" id="h59-0-39" class="i">+                            Column {
</a><a href="#h59-0-40" id="h59-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h59-0-41" id="h59-0-41" class="i">+                                datatype: Integer,
</a><a href="#h59-0-42" id="h59-0-42" class="i">+                                primary_key: false,
</a><a href="#h59-0-43" id="h59-0-43" class="i">+                                nullable: false,
</a><a href="#h59-0-44" id="h59-0-44" class="i">+                                default: None,
</a><a href="#h59-0-45" id="h59-0-45" class="i">+                                unique: false,
</a><a href="#h59-0-46" id="h59-0-46" class="i">+                                references: Some(
</a><a href="#h59-0-47" id="h59-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h59-0-48" id="h59-0-48" class="i">+                                ),
</a><a href="#h59-0-49" id="h59-0-49" class="i">+                                index: true,
</a><a href="#h59-0-50" id="h59-0-50" class="i">+                            },
</a><a href="#h59-0-51" id="h59-0-51" class="i">+                            Column {
</a><a href="#h59-0-52" id="h59-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h59-0-53" id="h59-0-53" class="i">+                                datatype: Integer,
</a><a href="#h59-0-54" id="h59-0-54" class="i">+                                primary_key: false,
</a><a href="#h59-0-55" id="h59-0-55" class="i">+                                nullable: false,
</a><a href="#h59-0-56" id="h59-0-56" class="i">+                                default: None,
</a><a href="#h59-0-57" id="h59-0-57" class="i">+                                unique: false,
</a><a href="#h59-0-58" id="h59-0-58" class="i">+                                references: None,
</a><a href="#h59-0-59" id="h59-0-59" class="i">+                                index: false,
</a><a href="#h59-0-60" id="h59-0-60" class="i">+                            },
</a><a href="#h59-0-61" id="h59-0-61" class="i">+                            Column {
</a><a href="#h59-0-62" id="h59-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h59-0-63" id="h59-0-63" class="i">+                                datatype: Float,
</a><a href="#h59-0-64" id="h59-0-64" class="i">+                                primary_key: false,
</a><a href="#h59-0-65" id="h59-0-65" class="i">+                                nullable: true,
</a><a href="#h59-0-66" id="h59-0-66" class="i">+                                default: Some(
</a><a href="#h59-0-67" id="h59-0-67" class="i">+                                    Null,
</a><a href="#h59-0-68" id="h59-0-68" class="i">+                                ),
</a><a href="#h59-0-69" id="h59-0-69" class="i">+                                unique: false,
</a><a href="#h59-0-70" id="h59-0-70" class="i">+                                references: None,
</a><a href="#h59-0-71" id="h59-0-71" class="i">+                                index: false,
</a><a href="#h59-0-72" id="h59-0-72" class="i">+                            },
</a><a href="#h59-0-73" id="h59-0-73" class="i">+                            Column {
</a><a href="#h59-0-74" id="h59-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h59-0-75" id="h59-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h59-0-76" id="h59-0-76" class="i">+                                primary_key: false,
</a><a href="#h59-0-77" id="h59-0-77" class="i">+                                nullable: true,
</a><a href="#h59-0-78" id="h59-0-78" class="i">+                                default: Some(
</a><a href="#h59-0-79" id="h59-0-79" class="i">+                                    Null,
</a><a href="#h59-0-80" id="h59-0-80" class="i">+                                ),
</a><a href="#h59-0-81" id="h59-0-81" class="i">+                                unique: false,
</a><a href="#h59-0-82" id="h59-0-82" class="i">+                                references: None,
</a><a href="#h59-0-83" id="h59-0-83" class="i">+                                index: false,
</a><a href="#h59-0-84" id="h59-0-84" class="i">+                            },
</a><a href="#h59-0-85" id="h59-0-85" class="i">+                        ],
</a><a href="#h59-0-86" id="h59-0-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
                 left_size: 7,
                 right: Scan {
<a href="#h59-0-92" id="h59-0-92" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h59-0-93" id="h59-0-93" class="i">+                    table: Table {
</a><a href="#h59-0-94" id="h59-0-94" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h59-0-95" id="h59-0-95" class="i">+                        columns: [
</a><a href="#h59-0-96" id="h59-0-96" class="i">+                            Column {
</a><a href="#h59-0-97" id="h59-0-97" class="i">+                                name: &quot;id&quot;,
</a><a href="#h59-0-98" id="h59-0-98" class="i">+                                datatype: Integer,
</a><a href="#h59-0-99" id="h59-0-99" class="i">+                                primary_key: true,
</a><a href="#h59-0-100" id="h59-0-100" class="i">+                                nullable: false,
</a><a href="#h59-0-101" id="h59-0-101" class="i">+                                default: None,
</a><a href="#h59-0-102" id="h59-0-102" class="i">+                                unique: true,
</a><a href="#h59-0-103" id="h59-0-103" class="i">+                                references: None,
</a><a href="#h59-0-104" id="h59-0-104" class="i">+                                index: false,
</a><a href="#h59-0-105" id="h59-0-105" class="i">+                            },
</a><a href="#h59-0-106" id="h59-0-106" class="i">+                            Column {
</a><a href="#h59-0-107" id="h59-0-107" class="i">+                                name: &quot;name&quot;,
</a><a href="#h59-0-108" id="h59-0-108" class="i">+                                datatype: String,
</a><a href="#h59-0-109" id="h59-0-109" class="i">+                                primary_key: false,
</a><a href="#h59-0-110" id="h59-0-110" class="i">+                                nullable: false,
</a><a href="#h59-0-111" id="h59-0-111" class="i">+                                default: None,
</a><a href="#h59-0-112" id="h59-0-112" class="i">+                                unique: false,
</a><a href="#h59-0-113" id="h59-0-113" class="i">+                                references: None,
</a><a href="#h59-0-114" id="h59-0-114" class="i">+                                index: false,
</a><a href="#h59-0-115" id="h59-0-115" class="i">+                            },
</a><a href="#h59-0-116" id="h59-0-116" class="i">+                        ],
</a><a href="#h59-0-117" id="h59-0-117" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h59-1" id="h59-1" class="h">@@ -167,7 +273,45 @@ Plan: Select(
</a>             },
             left_size: 9,
             right: Scan {
<a href="#h59-1-3" id="h59-1-3" class="d">-                table: &quot;studios&quot;,
</a><a href="#h59-1-4" id="h59-1-4" class="i">+                table: Table {
</a><a href="#h59-1-5" id="h59-1-5" class="i">+                    name: &quot;studios&quot;,
</a><a href="#h59-1-6" id="h59-1-6" class="i">+                    columns: [
</a><a href="#h59-1-7" id="h59-1-7" class="i">+                        Column {
</a><a href="#h59-1-8" id="h59-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h59-1-9" id="h59-1-9" class="i">+                            datatype: Integer,
</a><a href="#h59-1-10" id="h59-1-10" class="i">+                            primary_key: true,
</a><a href="#h59-1-11" id="h59-1-11" class="i">+                            nullable: false,
</a><a href="#h59-1-12" id="h59-1-12" class="i">+                            default: None,
</a><a href="#h59-1-13" id="h59-1-13" class="i">+                            unique: true,
</a><a href="#h59-1-14" id="h59-1-14" class="i">+                            references: None,
</a><a href="#h59-1-15" id="h59-1-15" class="i">+                            index: false,
</a><a href="#h59-1-16" id="h59-1-16" class="i">+                        },
</a><a href="#h59-1-17" id="h59-1-17" class="i">+                        Column {
</a><a href="#h59-1-18" id="h59-1-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h59-1-19" id="h59-1-19" class="i">+                            datatype: String,
</a><a href="#h59-1-20" id="h59-1-20" class="i">+                            primary_key: false,
</a><a href="#h59-1-21" id="h59-1-21" class="i">+                            nullable: false,
</a><a href="#h59-1-22" id="h59-1-22" class="i">+                            default: None,
</a><a href="#h59-1-23" id="h59-1-23" class="i">+                            unique: false,
</a><a href="#h59-1-24" id="h59-1-24" class="i">+                            references: None,
</a><a href="#h59-1-25" id="h59-1-25" class="i">+                            index: false,
</a><a href="#h59-1-26" id="h59-1-26" class="i">+                        },
</a><a href="#h59-1-27" id="h59-1-27" class="i">+                        Column {
</a><a href="#h59-1-28" id="h59-1-28" class="i">+                            name: &quot;country_id&quot;,
</a><a href="#h59-1-29" id="h59-1-29" class="i">+                            datatype: String,
</a><a href="#h59-1-30" id="h59-1-30" class="i">+                            primary_key: false,
</a><a href="#h59-1-31" id="h59-1-31" class="i">+                            nullable: true,
</a><a href="#h59-1-32" id="h59-1-32" class="i">+                            default: Some(
</a><a href="#h59-1-33" id="h59-1-33" class="i">+                                Null,
</a><a href="#h59-1-34" id="h59-1-34" class="i">+                            ),
</a><a href="#h59-1-35" id="h59-1-35" class="i">+                            unique: false,
</a><a href="#h59-1-36" id="h59-1-36" class="i">+                            references: Some(
</a><a href="#h59-1-37" id="h59-1-37" class="i">+                                &quot;countries&quot;,
</a><a href="#h59-1-38" id="h59-1-38" class="i">+                            ),
</a><a href="#h59-1-39" id="h59-1-39" class="i">+                            index: true,
</a><a href="#h59-1-40" id="h59-1-40" class="i">+                        },
</a><a href="#h59-1-41" id="h59-1-41" class="i">+                    ],
</a><a href="#h59-1-42" id="h59-1-42" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h59-2" id="h59-2" class="h">@@ -255,7 +399,89 @@ Optimized plan: Select(
</a>         source: HashJoin {
             left: HashJoin {
                 left: Scan {
<a href="#h59-2-3" id="h59-2-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h59-2-4" id="h59-2-4" class="i">+                    table: Table {
</a><a href="#h59-2-5" id="h59-2-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h59-2-6" id="h59-2-6" class="i">+                        columns: [
</a><a href="#h59-2-7" id="h59-2-7" class="i">+                            Column {
</a><a href="#h59-2-8" id="h59-2-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h59-2-9" id="h59-2-9" class="i">+                                datatype: Integer,
</a><a href="#h59-2-10" id="h59-2-10" class="i">+                                primary_key: true,
</a><a href="#h59-2-11" id="h59-2-11" class="i">+                                nullable: false,
</a><a href="#h59-2-12" id="h59-2-12" class="i">+                                default: None,
</a><a href="#h59-2-13" id="h59-2-13" class="i">+                                unique: true,
</a><a href="#h59-2-14" id="h59-2-14" class="i">+                                references: None,
</a><a href="#h59-2-15" id="h59-2-15" class="i">+                                index: false,
</a><a href="#h59-2-16" id="h59-2-16" class="i">+                            },
</a><a href="#h59-2-17" id="h59-2-17" class="i">+                            Column {
</a><a href="#h59-2-18" id="h59-2-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h59-2-19" id="h59-2-19" class="i">+                                datatype: String,
</a><a href="#h59-2-20" id="h59-2-20" class="i">+                                primary_key: false,
</a><a href="#h59-2-21" id="h59-2-21" class="i">+                                nullable: false,
</a><a href="#h59-2-22" id="h59-2-22" class="i">+                                default: None,
</a><a href="#h59-2-23" id="h59-2-23" class="i">+                                unique: false,
</a><a href="#h59-2-24" id="h59-2-24" class="i">+                                references: None,
</a><a href="#h59-2-25" id="h59-2-25" class="i">+                                index: false,
</a><a href="#h59-2-26" id="h59-2-26" class="i">+                            },
</a><a href="#h59-2-27" id="h59-2-27" class="i">+                            Column {
</a><a href="#h59-2-28" id="h59-2-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h59-2-29" id="h59-2-29" class="i">+                                datatype: Integer,
</a><a href="#h59-2-30" id="h59-2-30" class="i">+                                primary_key: false,
</a><a href="#h59-2-31" id="h59-2-31" class="i">+                                nullable: false,
</a><a href="#h59-2-32" id="h59-2-32" class="i">+                                default: None,
</a><a href="#h59-2-33" id="h59-2-33" class="i">+                                unique: false,
</a><a href="#h59-2-34" id="h59-2-34" class="i">+                                references: Some(
</a><a href="#h59-2-35" id="h59-2-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h59-2-36" id="h59-2-36" class="i">+                                ),
</a><a href="#h59-2-37" id="h59-2-37" class="i">+                                index: true,
</a><a href="#h59-2-38" id="h59-2-38" class="i">+                            },
</a><a href="#h59-2-39" id="h59-2-39" class="i">+                            Column {
</a><a href="#h59-2-40" id="h59-2-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h59-2-41" id="h59-2-41" class="i">+                                datatype: Integer,
</a><a href="#h59-2-42" id="h59-2-42" class="i">+                                primary_key: false,
</a><a href="#h59-2-43" id="h59-2-43" class="i">+                                nullable: false,
</a><a href="#h59-2-44" id="h59-2-44" class="i">+                                default: None,
</a><a href="#h59-2-45" id="h59-2-45" class="i">+                                unique: false,
</a><a href="#h59-2-46" id="h59-2-46" class="i">+                                references: Some(
</a><a href="#h59-2-47" id="h59-2-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h59-2-48" id="h59-2-48" class="i">+                                ),
</a><a href="#h59-2-49" id="h59-2-49" class="i">+                                index: true,
</a><a href="#h59-2-50" id="h59-2-50" class="i">+                            },
</a><a href="#h59-2-51" id="h59-2-51" class="i">+                            Column {
</a><a href="#h59-2-52" id="h59-2-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h59-2-53" id="h59-2-53" class="i">+                                datatype: Integer,
</a><a href="#h59-2-54" id="h59-2-54" class="i">+                                primary_key: false,
</a><a href="#h59-2-55" id="h59-2-55" class="i">+                                nullable: false,
</a><a href="#h59-2-56" id="h59-2-56" class="i">+                                default: None,
</a><a href="#h59-2-57" id="h59-2-57" class="i">+                                unique: false,
</a><a href="#h59-2-58" id="h59-2-58" class="i">+                                references: None,
</a><a href="#h59-2-59" id="h59-2-59" class="i">+                                index: false,
</a><a href="#h59-2-60" id="h59-2-60" class="i">+                            },
</a><a href="#h59-2-61" id="h59-2-61" class="i">+                            Column {
</a><a href="#h59-2-62" id="h59-2-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h59-2-63" id="h59-2-63" class="i">+                                datatype: Float,
</a><a href="#h59-2-64" id="h59-2-64" class="i">+                                primary_key: false,
</a><a href="#h59-2-65" id="h59-2-65" class="i">+                                nullable: true,
</a><a href="#h59-2-66" id="h59-2-66" class="i">+                                default: Some(
</a><a href="#h59-2-67" id="h59-2-67" class="i">+                                    Null,
</a><a href="#h59-2-68" id="h59-2-68" class="i">+                                ),
</a><a href="#h59-2-69" id="h59-2-69" class="i">+                                unique: false,
</a><a href="#h59-2-70" id="h59-2-70" class="i">+                                references: None,
</a><a href="#h59-2-71" id="h59-2-71" class="i">+                                index: false,
</a><a href="#h59-2-72" id="h59-2-72" class="i">+                            },
</a><a href="#h59-2-73" id="h59-2-73" class="i">+                            Column {
</a><a href="#h59-2-74" id="h59-2-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h59-2-75" id="h59-2-75" class="i">+                                datatype: Boolean,
</a><a href="#h59-2-76" id="h59-2-76" class="i">+                                primary_key: false,
</a><a href="#h59-2-77" id="h59-2-77" class="i">+                                nullable: true,
</a><a href="#h59-2-78" id="h59-2-78" class="i">+                                default: Some(
</a><a href="#h59-2-79" id="h59-2-79" class="i">+                                    Null,
</a><a href="#h59-2-80" id="h59-2-80" class="i">+                                ),
</a><a href="#h59-2-81" id="h59-2-81" class="i">+                                unique: false,
</a><a href="#h59-2-82" id="h59-2-82" class="i">+                                references: None,
</a><a href="#h59-2-83" id="h59-2-83" class="i">+                                index: false,
</a><a href="#h59-2-84" id="h59-2-84" class="i">+                            },
</a><a href="#h59-2-85" id="h59-2-85" class="i">+                        ],
</a><a href="#h59-2-86" id="h59-2-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h59-3" id="h59-3" class="h">@@ -271,7 +497,31 @@ Optimized plan: Select(
</a>                     ),
                 ),
                 right: Scan {
<a href="#h59-3-3" id="h59-3-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h59-3-4" id="h59-3-4" class="i">+                    table: Table {
</a><a href="#h59-3-5" id="h59-3-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h59-3-6" id="h59-3-6" class="i">+                        columns: [
</a><a href="#h59-3-7" id="h59-3-7" class="i">+                            Column {
</a><a href="#h59-3-8" id="h59-3-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h59-3-9" id="h59-3-9" class="i">+                                datatype: Integer,
</a><a href="#h59-3-10" id="h59-3-10" class="i">+                                primary_key: true,
</a><a href="#h59-3-11" id="h59-3-11" class="i">+                                nullable: false,
</a><a href="#h59-3-12" id="h59-3-12" class="i">+                                default: None,
</a><a href="#h59-3-13" id="h59-3-13" class="i">+                                unique: true,
</a><a href="#h59-3-14" id="h59-3-14" class="i">+                                references: None,
</a><a href="#h59-3-15" id="h59-3-15" class="i">+                                index: false,
</a><a href="#h59-3-16" id="h59-3-16" class="i">+                            },
</a><a href="#h59-3-17" id="h59-3-17" class="i">+                            Column {
</a><a href="#h59-3-18" id="h59-3-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h59-3-19" id="h59-3-19" class="i">+                                datatype: String,
</a><a href="#h59-3-20" id="h59-3-20" class="i">+                                primary_key: false,
</a><a href="#h59-3-21" id="h59-3-21" class="i">+                                nullable: false,
</a><a href="#h59-3-22" id="h59-3-22" class="i">+                                default: None,
</a><a href="#h59-3-23" id="h59-3-23" class="i">+                                unique: false,
</a><a href="#h59-3-24" id="h59-3-24" class="i">+                                references: None,
</a><a href="#h59-3-25" id="h59-3-25" class="i">+                                index: false,
</a><a href="#h59-3-26" id="h59-3-26" class="i">+                            },
</a><a href="#h59-3-27" id="h59-3-27" class="i">+                        ],
</a><a href="#h59-3-28" id="h59-3-28" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h59-4" id="h59-4" class="h">@@ -300,7 +550,45 @@ Optimized plan: Select(
</a>                 ),
             ),
             right: Scan {
<a href="#h59-4-3" id="h59-4-3" class="d">-                table: &quot;studios&quot;,
</a><a href="#h59-4-4" id="h59-4-4" class="i">+                table: Table {
</a><a href="#h59-4-5" id="h59-4-5" class="i">+                    name: &quot;studios&quot;,
</a><a href="#h59-4-6" id="h59-4-6" class="i">+                    columns: [
</a><a href="#h59-4-7" id="h59-4-7" class="i">+                        Column {
</a><a href="#h59-4-8" id="h59-4-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h59-4-9" id="h59-4-9" class="i">+                            datatype: Integer,
</a><a href="#h59-4-10" id="h59-4-10" class="i">+                            primary_key: true,
</a><a href="#h59-4-11" id="h59-4-11" class="i">+                            nullable: false,
</a><a href="#h59-4-12" id="h59-4-12" class="i">+                            default: None,
</a><a href="#h59-4-13" id="h59-4-13" class="i">+                            unique: true,
</a><a href="#h59-4-14" id="h59-4-14" class="i">+                            references: None,
</a><a href="#h59-4-15" id="h59-4-15" class="i">+                            index: false,
</a><a href="#h59-4-16" id="h59-4-16" class="i">+                        },
</a><a href="#h59-4-17" id="h59-4-17" class="i">+                        Column {
</a><a href="#h59-4-18" id="h59-4-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h59-4-19" id="h59-4-19" class="i">+                            datatype: String,
</a><a href="#h59-4-20" id="h59-4-20" class="i">+                            primary_key: false,
</a><a href="#h59-4-21" id="h59-4-21" class="i">+                            nullable: false,
</a><a href="#h59-4-22" id="h59-4-22" class="i">+                            default: None,
</a><a href="#h59-4-23" id="h59-4-23" class="i">+                            unique: false,
</a><a href="#h59-4-24" id="h59-4-24" class="i">+                            references: None,
</a><a href="#h59-4-25" id="h59-4-25" class="i">+                            index: false,
</a><a href="#h59-4-26" id="h59-4-26" class="i">+                        },
</a><a href="#h59-4-27" id="h59-4-27" class="i">+                        Column {
</a><a href="#h59-4-28" id="h59-4-28" class="i">+                            name: &quot;country_id&quot;,
</a><a href="#h59-4-29" id="h59-4-29" class="i">+                            datatype: String,
</a><a href="#h59-4-30" id="h59-4-30" class="i">+                            primary_key: false,
</a><a href="#h59-4-31" id="h59-4-31" class="i">+                            nullable: true,
</a><a href="#h59-4-32" id="h59-4-32" class="i">+                            default: Some(
</a><a href="#h59-4-33" id="h59-4-33" class="i">+                                Null,
</a><a href="#h59-4-34" id="h59-4-34" class="i">+                            ),
</a><a href="#h59-4-35" id="h59-4-35" class="i">+                            unique: false,
</a><a href="#h59-4-36" id="h59-4-36" class="i">+                            references: Some(
</a><a href="#h59-4-37" id="h59-4-37" class="i">+                                &quot;countries&quot;,
</a><a href="#h59-4-38" id="h59-4-38" class="i">+                            ),
</a><a href="#h59-4-39" id="h59-4-39" class="i">+                            index: true,
</a><a href="#h59-4-40" id="h59-4-40" class="i">+                        },
</a><a href="#h59-4-41" id="h59-4-41" class="i">+                    ],
</a><a href="#h59-4-42" id="h59-4-42" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<b>diff --git a/<a id="h60" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -178,7 +178,89 @@ Plan: Select(
</a>             source: NestedLoopJoin {
                 left: NestedLoopJoin {
                     left: Scan {
<a href="#h60-0-3" id="h60-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h60-0-4" id="h60-0-4" class="i">+                        table: Table {
</a><a href="#h60-0-5" id="h60-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h60-0-6" id="h60-0-6" class="i">+                            columns: [
</a><a href="#h60-0-7" id="h60-0-7" class="i">+                                Column {
</a><a href="#h60-0-8" id="h60-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h60-0-9" id="h60-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h60-0-10" id="h60-0-10" class="i">+                                    primary_key: true,
</a><a href="#h60-0-11" id="h60-0-11" class="i">+                                    nullable: false,
</a><a href="#h60-0-12" id="h60-0-12" class="i">+                                    default: None,
</a><a href="#h60-0-13" id="h60-0-13" class="i">+                                    unique: true,
</a><a href="#h60-0-14" id="h60-0-14" class="i">+                                    references: None,
</a><a href="#h60-0-15" id="h60-0-15" class="i">+                                    index: false,
</a><a href="#h60-0-16" id="h60-0-16" class="i">+                                },
</a><a href="#h60-0-17" id="h60-0-17" class="i">+                                Column {
</a><a href="#h60-0-18" id="h60-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h60-0-19" id="h60-0-19" class="i">+                                    datatype: String,
</a><a href="#h60-0-20" id="h60-0-20" class="i">+                                    primary_key: false,
</a><a href="#h60-0-21" id="h60-0-21" class="i">+                                    nullable: false,
</a><a href="#h60-0-22" id="h60-0-22" class="i">+                                    default: None,
</a><a href="#h60-0-23" id="h60-0-23" class="i">+                                    unique: false,
</a><a href="#h60-0-24" id="h60-0-24" class="i">+                                    references: None,
</a><a href="#h60-0-25" id="h60-0-25" class="i">+                                    index: false,
</a><a href="#h60-0-26" id="h60-0-26" class="i">+                                },
</a><a href="#h60-0-27" id="h60-0-27" class="i">+                                Column {
</a><a href="#h60-0-28" id="h60-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h60-0-29" id="h60-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h60-0-30" id="h60-0-30" class="i">+                                    primary_key: false,
</a><a href="#h60-0-31" id="h60-0-31" class="i">+                                    nullable: false,
</a><a href="#h60-0-32" id="h60-0-32" class="i">+                                    default: None,
</a><a href="#h60-0-33" id="h60-0-33" class="i">+                                    unique: false,
</a><a href="#h60-0-34" id="h60-0-34" class="i">+                                    references: Some(
</a><a href="#h60-0-35" id="h60-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h60-0-36" id="h60-0-36" class="i">+                                    ),
</a><a href="#h60-0-37" id="h60-0-37" class="i">+                                    index: true,
</a><a href="#h60-0-38" id="h60-0-38" class="i">+                                },
</a><a href="#h60-0-39" id="h60-0-39" class="i">+                                Column {
</a><a href="#h60-0-40" id="h60-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h60-0-41" id="h60-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h60-0-42" id="h60-0-42" class="i">+                                    primary_key: false,
</a><a href="#h60-0-43" id="h60-0-43" class="i">+                                    nullable: false,
</a><a href="#h60-0-44" id="h60-0-44" class="i">+                                    default: None,
</a><a href="#h60-0-45" id="h60-0-45" class="i">+                                    unique: false,
</a><a href="#h60-0-46" id="h60-0-46" class="i">+                                    references: Some(
</a><a href="#h60-0-47" id="h60-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h60-0-48" id="h60-0-48" class="i">+                                    ),
</a><a href="#h60-0-49" id="h60-0-49" class="i">+                                    index: true,
</a><a href="#h60-0-50" id="h60-0-50" class="i">+                                },
</a><a href="#h60-0-51" id="h60-0-51" class="i">+                                Column {
</a><a href="#h60-0-52" id="h60-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h60-0-53" id="h60-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h60-0-54" id="h60-0-54" class="i">+                                    primary_key: false,
</a><a href="#h60-0-55" id="h60-0-55" class="i">+                                    nullable: false,
</a><a href="#h60-0-56" id="h60-0-56" class="i">+                                    default: None,
</a><a href="#h60-0-57" id="h60-0-57" class="i">+                                    unique: false,
</a><a href="#h60-0-58" id="h60-0-58" class="i">+                                    references: None,
</a><a href="#h60-0-59" id="h60-0-59" class="i">+                                    index: false,
</a><a href="#h60-0-60" id="h60-0-60" class="i">+                                },
</a><a href="#h60-0-61" id="h60-0-61" class="i">+                                Column {
</a><a href="#h60-0-62" id="h60-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h60-0-63" id="h60-0-63" class="i">+                                    datatype: Float,
</a><a href="#h60-0-64" id="h60-0-64" class="i">+                                    primary_key: false,
</a><a href="#h60-0-65" id="h60-0-65" class="i">+                                    nullable: true,
</a><a href="#h60-0-66" id="h60-0-66" class="i">+                                    default: Some(
</a><a href="#h60-0-67" id="h60-0-67" class="i">+                                        Null,
</a><a href="#h60-0-68" id="h60-0-68" class="i">+                                    ),
</a><a href="#h60-0-69" id="h60-0-69" class="i">+                                    unique: false,
</a><a href="#h60-0-70" id="h60-0-70" class="i">+                                    references: None,
</a><a href="#h60-0-71" id="h60-0-71" class="i">+                                    index: false,
</a><a href="#h60-0-72" id="h60-0-72" class="i">+                                },
</a><a href="#h60-0-73" id="h60-0-73" class="i">+                                Column {
</a><a href="#h60-0-74" id="h60-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h60-0-75" id="h60-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h60-0-76" id="h60-0-76" class="i">+                                    primary_key: false,
</a><a href="#h60-0-77" id="h60-0-77" class="i">+                                    nullable: true,
</a><a href="#h60-0-78" id="h60-0-78" class="i">+                                    default: Some(
</a><a href="#h60-0-79" id="h60-0-79" class="i">+                                        Null,
</a><a href="#h60-0-80" id="h60-0-80" class="i">+                                    ),
</a><a href="#h60-0-81" id="h60-0-81" class="i">+                                    unique: false,
</a><a href="#h60-0-82" id="h60-0-82" class="i">+                                    references: None,
</a><a href="#h60-0-83" id="h60-0-83" class="i">+                                    index: false,
</a><a href="#h60-0-84" id="h60-0-84" class="i">+                                },
</a><a href="#h60-0-85" id="h60-0-85" class="i">+                            ],
</a><a href="#h60-0-86" id="h60-0-86" class="i">+                        },
</a>                         alias: Some(
                             &quot;m&quot;,
                         ),
<a href="#h60-1" id="h60-1" class="h">@@ -186,7 +268,31 @@ Plan: Select(
</a>                     },
                     left_size: 7,
                     right: Scan {
<a href="#h60-1-3" id="h60-1-3" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h60-1-4" id="h60-1-4" class="i">+                        table: Table {
</a><a href="#h60-1-5" id="h60-1-5" class="i">+                            name: &quot;genres&quot;,
</a><a href="#h60-1-6" id="h60-1-6" class="i">+                            columns: [
</a><a href="#h60-1-7" id="h60-1-7" class="i">+                                Column {
</a><a href="#h60-1-8" id="h60-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h60-1-9" id="h60-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h60-1-10" id="h60-1-10" class="i">+                                    primary_key: true,
</a><a href="#h60-1-11" id="h60-1-11" class="i">+                                    nullable: false,
</a><a href="#h60-1-12" id="h60-1-12" class="i">+                                    default: None,
</a><a href="#h60-1-13" id="h60-1-13" class="i">+                                    unique: true,
</a><a href="#h60-1-14" id="h60-1-14" class="i">+                                    references: None,
</a><a href="#h60-1-15" id="h60-1-15" class="i">+                                    index: false,
</a><a href="#h60-1-16" id="h60-1-16" class="i">+                                },
</a><a href="#h60-1-17" id="h60-1-17" class="i">+                                Column {
</a><a href="#h60-1-18" id="h60-1-18" class="i">+                                    name: &quot;name&quot;,
</a><a href="#h60-1-19" id="h60-1-19" class="i">+                                    datatype: String,
</a><a href="#h60-1-20" id="h60-1-20" class="i">+                                    primary_key: false,
</a><a href="#h60-1-21" id="h60-1-21" class="i">+                                    nullable: false,
</a><a href="#h60-1-22" id="h60-1-22" class="i">+                                    default: None,
</a><a href="#h60-1-23" id="h60-1-23" class="i">+                                    unique: false,
</a><a href="#h60-1-24" id="h60-1-24" class="i">+                                    references: None,
</a><a href="#h60-1-25" id="h60-1-25" class="i">+                                    index: false,
</a><a href="#h60-1-26" id="h60-1-26" class="i">+                                },
</a><a href="#h60-1-27" id="h60-1-27" class="i">+                            ],
</a><a href="#h60-1-28" id="h60-1-28" class="i">+                        },
</a>                         alias: Some(
                             &quot;g&quot;,
                         ),
<a href="#h60-2" id="h60-2" class="h">@@ -242,7 +348,45 @@ Plan: Select(
</a>                 },
                 left_size: 9,
                 right: Scan {
<a href="#h60-2-3" id="h60-2-3" class="d">-                    table: &quot;studios&quot;,
</a><a href="#h60-2-4" id="h60-2-4" class="i">+                    table: Table {
</a><a href="#h60-2-5" id="h60-2-5" class="i">+                        name: &quot;studios&quot;,
</a><a href="#h60-2-6" id="h60-2-6" class="i">+                        columns: [
</a><a href="#h60-2-7" id="h60-2-7" class="i">+                            Column {
</a><a href="#h60-2-8" id="h60-2-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h60-2-9" id="h60-2-9" class="i">+                                datatype: Integer,
</a><a href="#h60-2-10" id="h60-2-10" class="i">+                                primary_key: true,
</a><a href="#h60-2-11" id="h60-2-11" class="i">+                                nullable: false,
</a><a href="#h60-2-12" id="h60-2-12" class="i">+                                default: None,
</a><a href="#h60-2-13" id="h60-2-13" class="i">+                                unique: true,
</a><a href="#h60-2-14" id="h60-2-14" class="i">+                                references: None,
</a><a href="#h60-2-15" id="h60-2-15" class="i">+                                index: false,
</a><a href="#h60-2-16" id="h60-2-16" class="i">+                            },
</a><a href="#h60-2-17" id="h60-2-17" class="i">+                            Column {
</a><a href="#h60-2-18" id="h60-2-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h60-2-19" id="h60-2-19" class="i">+                                datatype: String,
</a><a href="#h60-2-20" id="h60-2-20" class="i">+                                primary_key: false,
</a><a href="#h60-2-21" id="h60-2-21" class="i">+                                nullable: false,
</a><a href="#h60-2-22" id="h60-2-22" class="i">+                                default: None,
</a><a href="#h60-2-23" id="h60-2-23" class="i">+                                unique: false,
</a><a href="#h60-2-24" id="h60-2-24" class="i">+                                references: None,
</a><a href="#h60-2-25" id="h60-2-25" class="i">+                                index: false,
</a><a href="#h60-2-26" id="h60-2-26" class="i">+                            },
</a><a href="#h60-2-27" id="h60-2-27" class="i">+                            Column {
</a><a href="#h60-2-28" id="h60-2-28" class="i">+                                name: &quot;country_id&quot;,
</a><a href="#h60-2-29" id="h60-2-29" class="i">+                                datatype: String,
</a><a href="#h60-2-30" id="h60-2-30" class="i">+                                primary_key: false,
</a><a href="#h60-2-31" id="h60-2-31" class="i">+                                nullable: true,
</a><a href="#h60-2-32" id="h60-2-32" class="i">+                                default: Some(
</a><a href="#h60-2-33" id="h60-2-33" class="i">+                                    Null,
</a><a href="#h60-2-34" id="h60-2-34" class="i">+                                ),
</a><a href="#h60-2-35" id="h60-2-35" class="i">+                                unique: false,
</a><a href="#h60-2-36" id="h60-2-36" class="i">+                                references: Some(
</a><a href="#h60-2-37" id="h60-2-37" class="i">+                                    &quot;countries&quot;,
</a><a href="#h60-2-38" id="h60-2-38" class="i">+                                ),
</a><a href="#h60-2-39" id="h60-2-39" class="i">+                                index: true,
</a><a href="#h60-2-40" id="h60-2-40" class="i">+                            },
</a><a href="#h60-2-41" id="h60-2-41" class="i">+                        ],
</a><a href="#h60-2-42" id="h60-2-42" class="i">+                    },
</a>                     alias: Some(
                         &quot;s&quot;,
                     ),
<a href="#h60-3" id="h60-3" class="h">@@ -371,7 +515,89 @@ Optimized plan: Select(
</a>                 left: HashJoin {
                     left: Filter {
                         source: IndexLookup {
<a href="#h60-3-3" id="h60-3-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h60-3-4" id="h60-3-4" class="i">+                            table: Table {
</a><a href="#h60-3-5" id="h60-3-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h60-3-6" id="h60-3-6" class="i">+                                columns: [
</a><a href="#h60-3-7" id="h60-3-7" class="i">+                                    Column {
</a><a href="#h60-3-8" id="h60-3-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h60-3-9" id="h60-3-9" class="i">+                                        datatype: Integer,
</a><a href="#h60-3-10" id="h60-3-10" class="i">+                                        primary_key: true,
</a><a href="#h60-3-11" id="h60-3-11" class="i">+                                        nullable: false,
</a><a href="#h60-3-12" id="h60-3-12" class="i">+                                        default: None,
</a><a href="#h60-3-13" id="h60-3-13" class="i">+                                        unique: true,
</a><a href="#h60-3-14" id="h60-3-14" class="i">+                                        references: None,
</a><a href="#h60-3-15" id="h60-3-15" class="i">+                                        index: false,
</a><a href="#h60-3-16" id="h60-3-16" class="i">+                                    },
</a><a href="#h60-3-17" id="h60-3-17" class="i">+                                    Column {
</a><a href="#h60-3-18" id="h60-3-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h60-3-19" id="h60-3-19" class="i">+                                        datatype: String,
</a><a href="#h60-3-20" id="h60-3-20" class="i">+                                        primary_key: false,
</a><a href="#h60-3-21" id="h60-3-21" class="i">+                                        nullable: false,
</a><a href="#h60-3-22" id="h60-3-22" class="i">+                                        default: None,
</a><a href="#h60-3-23" id="h60-3-23" class="i">+                                        unique: false,
</a><a href="#h60-3-24" id="h60-3-24" class="i">+                                        references: None,
</a><a href="#h60-3-25" id="h60-3-25" class="i">+                                        index: false,
</a><a href="#h60-3-26" id="h60-3-26" class="i">+                                    },
</a><a href="#h60-3-27" id="h60-3-27" class="i">+                                    Column {
</a><a href="#h60-3-28" id="h60-3-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h60-3-29" id="h60-3-29" class="i">+                                        datatype: Integer,
</a><a href="#h60-3-30" id="h60-3-30" class="i">+                                        primary_key: false,
</a><a href="#h60-3-31" id="h60-3-31" class="i">+                                        nullable: false,
</a><a href="#h60-3-32" id="h60-3-32" class="i">+                                        default: None,
</a><a href="#h60-3-33" id="h60-3-33" class="i">+                                        unique: false,
</a><a href="#h60-3-34" id="h60-3-34" class="i">+                                        references: Some(
</a><a href="#h60-3-35" id="h60-3-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h60-3-36" id="h60-3-36" class="i">+                                        ),
</a><a href="#h60-3-37" id="h60-3-37" class="i">+                                        index: true,
</a><a href="#h60-3-38" id="h60-3-38" class="i">+                                    },
</a><a href="#h60-3-39" id="h60-3-39" class="i">+                                    Column {
</a><a href="#h60-3-40" id="h60-3-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h60-3-41" id="h60-3-41" class="i">+                                        datatype: Integer,
</a><a href="#h60-3-42" id="h60-3-42" class="i">+                                        primary_key: false,
</a><a href="#h60-3-43" id="h60-3-43" class="i">+                                        nullable: false,
</a><a href="#h60-3-44" id="h60-3-44" class="i">+                                        default: None,
</a><a href="#h60-3-45" id="h60-3-45" class="i">+                                        unique: false,
</a><a href="#h60-3-46" id="h60-3-46" class="i">+                                        references: Some(
</a><a href="#h60-3-47" id="h60-3-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h60-3-48" id="h60-3-48" class="i">+                                        ),
</a><a href="#h60-3-49" id="h60-3-49" class="i">+                                        index: true,
</a><a href="#h60-3-50" id="h60-3-50" class="i">+                                    },
</a><a href="#h60-3-51" id="h60-3-51" class="i">+                                    Column {
</a><a href="#h60-3-52" id="h60-3-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h60-3-53" id="h60-3-53" class="i">+                                        datatype: Integer,
</a><a href="#h60-3-54" id="h60-3-54" class="i">+                                        primary_key: false,
</a><a href="#h60-3-55" id="h60-3-55" class="i">+                                        nullable: false,
</a><a href="#h60-3-56" id="h60-3-56" class="i">+                                        default: None,
</a><a href="#h60-3-57" id="h60-3-57" class="i">+                                        unique: false,
</a><a href="#h60-3-58" id="h60-3-58" class="i">+                                        references: None,
</a><a href="#h60-3-59" id="h60-3-59" class="i">+                                        index: false,
</a><a href="#h60-3-60" id="h60-3-60" class="i">+                                    },
</a><a href="#h60-3-61" id="h60-3-61" class="i">+                                    Column {
</a><a href="#h60-3-62" id="h60-3-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h60-3-63" id="h60-3-63" class="i">+                                        datatype: Float,
</a><a href="#h60-3-64" id="h60-3-64" class="i">+                                        primary_key: false,
</a><a href="#h60-3-65" id="h60-3-65" class="i">+                                        nullable: true,
</a><a href="#h60-3-66" id="h60-3-66" class="i">+                                        default: Some(
</a><a href="#h60-3-67" id="h60-3-67" class="i">+                                            Null,
</a><a href="#h60-3-68" id="h60-3-68" class="i">+                                        ),
</a><a href="#h60-3-69" id="h60-3-69" class="i">+                                        unique: false,
</a><a href="#h60-3-70" id="h60-3-70" class="i">+                                        references: None,
</a><a href="#h60-3-71" id="h60-3-71" class="i">+                                        index: false,
</a><a href="#h60-3-72" id="h60-3-72" class="i">+                                    },
</a><a href="#h60-3-73" id="h60-3-73" class="i">+                                    Column {
</a><a href="#h60-3-74" id="h60-3-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h60-3-75" id="h60-3-75" class="i">+                                        datatype: Boolean,
</a><a href="#h60-3-76" id="h60-3-76" class="i">+                                        primary_key: false,
</a><a href="#h60-3-77" id="h60-3-77" class="i">+                                        nullable: true,
</a><a href="#h60-3-78" id="h60-3-78" class="i">+                                        default: Some(
</a><a href="#h60-3-79" id="h60-3-79" class="i">+                                            Null,
</a><a href="#h60-3-80" id="h60-3-80" class="i">+                                        ),
</a><a href="#h60-3-81" id="h60-3-81" class="i">+                                        unique: false,
</a><a href="#h60-3-82" id="h60-3-82" class="i">+                                        references: None,
</a><a href="#h60-3-83" id="h60-3-83" class="i">+                                        index: false,
</a><a href="#h60-3-84" id="h60-3-84" class="i">+                                    },
</a><a href="#h60-3-85" id="h60-3-85" class="i">+                                ],
</a><a href="#h60-3-86" id="h60-3-86" class="i">+                            },
</a>                             alias: Some(
                                 &quot;m&quot;,
                             ),
<a href="#h60-4" id="h60-4" class="h">@@ -413,7 +639,31 @@ Optimized plan: Select(
</a>                         ),
                     ),
                     right: KeyLookup {
<a href="#h60-4-3" id="h60-4-3" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h60-4-4" id="h60-4-4" class="i">+                        table: Table {
</a><a href="#h60-4-5" id="h60-4-5" class="i">+                            name: &quot;genres&quot;,
</a><a href="#h60-4-6" id="h60-4-6" class="i">+                            columns: [
</a><a href="#h60-4-7" id="h60-4-7" class="i">+                                Column {
</a><a href="#h60-4-8" id="h60-4-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h60-4-9" id="h60-4-9" class="i">+                                    datatype: Integer,
</a><a href="#h60-4-10" id="h60-4-10" class="i">+                                    primary_key: true,
</a><a href="#h60-4-11" id="h60-4-11" class="i">+                                    nullable: false,
</a><a href="#h60-4-12" id="h60-4-12" class="i">+                                    default: None,
</a><a href="#h60-4-13" id="h60-4-13" class="i">+                                    unique: true,
</a><a href="#h60-4-14" id="h60-4-14" class="i">+                                    references: None,
</a><a href="#h60-4-15" id="h60-4-15" class="i">+                                    index: false,
</a><a href="#h60-4-16" id="h60-4-16" class="i">+                                },
</a><a href="#h60-4-17" id="h60-4-17" class="i">+                                Column {
</a><a href="#h60-4-18" id="h60-4-18" class="i">+                                    name: &quot;name&quot;,
</a><a href="#h60-4-19" id="h60-4-19" class="i">+                                    datatype: String,
</a><a href="#h60-4-20" id="h60-4-20" class="i">+                                    primary_key: false,
</a><a href="#h60-4-21" id="h60-4-21" class="i">+                                    nullable: false,
</a><a href="#h60-4-22" id="h60-4-22" class="i">+                                    default: None,
</a><a href="#h60-4-23" id="h60-4-23" class="i">+                                    unique: false,
</a><a href="#h60-4-24" id="h60-4-24" class="i">+                                    references: None,
</a><a href="#h60-4-25" id="h60-4-25" class="i">+                                    index: false,
</a><a href="#h60-4-26" id="h60-4-26" class="i">+                                },
</a><a href="#h60-4-27" id="h60-4-27" class="i">+                            ],
</a><a href="#h60-4-28" id="h60-4-28" class="i">+                        },
</a>                         alias: Some(
                             &quot;g&quot;,
                         ),
<a href="#h60-5" id="h60-5" class="h">@@ -448,7 +698,45 @@ Optimized plan: Select(
</a>                     ),
                 ),
                 right: KeyLookup {
<a href="#h60-5-3" id="h60-5-3" class="d">-                    table: &quot;studios&quot;,
</a><a href="#h60-5-4" id="h60-5-4" class="i">+                    table: Table {
</a><a href="#h60-5-5" id="h60-5-5" class="i">+                        name: &quot;studios&quot;,
</a><a href="#h60-5-6" id="h60-5-6" class="i">+                        columns: [
</a><a href="#h60-5-7" id="h60-5-7" class="i">+                            Column {
</a><a href="#h60-5-8" id="h60-5-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h60-5-9" id="h60-5-9" class="i">+                                datatype: Integer,
</a><a href="#h60-5-10" id="h60-5-10" class="i">+                                primary_key: true,
</a><a href="#h60-5-11" id="h60-5-11" class="i">+                                nullable: false,
</a><a href="#h60-5-12" id="h60-5-12" class="i">+                                default: None,
</a><a href="#h60-5-13" id="h60-5-13" class="i">+                                unique: true,
</a><a href="#h60-5-14" id="h60-5-14" class="i">+                                references: None,
</a><a href="#h60-5-15" id="h60-5-15" class="i">+                                index: false,
</a><a href="#h60-5-16" id="h60-5-16" class="i">+                            },
</a><a href="#h60-5-17" id="h60-5-17" class="i">+                            Column {
</a><a href="#h60-5-18" id="h60-5-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h60-5-19" id="h60-5-19" class="i">+                                datatype: String,
</a><a href="#h60-5-20" id="h60-5-20" class="i">+                                primary_key: false,
</a><a href="#h60-5-21" id="h60-5-21" class="i">+                                nullable: false,
</a><a href="#h60-5-22" id="h60-5-22" class="i">+                                default: None,
</a><a href="#h60-5-23" id="h60-5-23" class="i">+                                unique: false,
</a><a href="#h60-5-24" id="h60-5-24" class="i">+                                references: None,
</a><a href="#h60-5-25" id="h60-5-25" class="i">+                                index: false,
</a><a href="#h60-5-26" id="h60-5-26" class="i">+                            },
</a><a href="#h60-5-27" id="h60-5-27" class="i">+                            Column {
</a><a href="#h60-5-28" id="h60-5-28" class="i">+                                name: &quot;country_id&quot;,
</a><a href="#h60-5-29" id="h60-5-29" class="i">+                                datatype: String,
</a><a href="#h60-5-30" id="h60-5-30" class="i">+                                primary_key: false,
</a><a href="#h60-5-31" id="h60-5-31" class="i">+                                nullable: true,
</a><a href="#h60-5-32" id="h60-5-32" class="i">+                                default: Some(
</a><a href="#h60-5-33" id="h60-5-33" class="i">+                                    Null,
</a><a href="#h60-5-34" id="h60-5-34" class="i">+                                ),
</a><a href="#h60-5-35" id="h60-5-35" class="i">+                                unique: false,
</a><a href="#h60-5-36" id="h60-5-36" class="i">+                                references: Some(
</a><a href="#h60-5-37" id="h60-5-37" class="i">+                                    &quot;countries&quot;,
</a><a href="#h60-5-38" id="h60-5-38" class="i">+                                ),
</a><a href="#h60-5-39" id="h60-5-39" class="i">+                                index: true,
</a><a href="#h60-5-40" id="h60-5-40" class="i">+                            },
</a><a href="#h60-5-41" id="h60-5-41" class="i">+                        ],
</a><a href="#h60-5-42" id="h60-5-42" class="i">+                    },
</a>                     alias: Some(
                         &quot;s&quot;,
                     ),
<b>diff --git a/<a id="h61" href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a> b/<a href="../file/tests/sql/query/join_inner_multi_same.html">tests/sql/query/join_inner_multi_same</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -227,7 +227,89 @@ Plan: Select(
</a>                     source: NestedLoopJoin {
                         left: NestedLoopJoin {
                             left: Scan {
<a href="#h61-0-3" id="h61-0-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h61-0-4" id="h61-0-4" class="i">+                                table: Table {
</a><a href="#h61-0-5" id="h61-0-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h61-0-6" id="h61-0-6" class="i">+                                    columns: [
</a><a href="#h61-0-7" id="h61-0-7" class="i">+                                        Column {
</a><a href="#h61-0-8" id="h61-0-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h61-0-9" id="h61-0-9" class="i">+                                            datatype: Integer,
</a><a href="#h61-0-10" id="h61-0-10" class="i">+                                            primary_key: true,
</a><a href="#h61-0-11" id="h61-0-11" class="i">+                                            nullable: false,
</a><a href="#h61-0-12" id="h61-0-12" class="i">+                                            default: None,
</a><a href="#h61-0-13" id="h61-0-13" class="i">+                                            unique: true,
</a><a href="#h61-0-14" id="h61-0-14" class="i">+                                            references: None,
</a><a href="#h61-0-15" id="h61-0-15" class="i">+                                            index: false,
</a><a href="#h61-0-16" id="h61-0-16" class="i">+                                        },
</a><a href="#h61-0-17" id="h61-0-17" class="i">+                                        Column {
</a><a href="#h61-0-18" id="h61-0-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h61-0-19" id="h61-0-19" class="i">+                                            datatype: String,
</a><a href="#h61-0-20" id="h61-0-20" class="i">+                                            primary_key: false,
</a><a href="#h61-0-21" id="h61-0-21" class="i">+                                            nullable: false,
</a><a href="#h61-0-22" id="h61-0-22" class="i">+                                            default: None,
</a><a href="#h61-0-23" id="h61-0-23" class="i">+                                            unique: false,
</a><a href="#h61-0-24" id="h61-0-24" class="i">+                                            references: None,
</a><a href="#h61-0-25" id="h61-0-25" class="i">+                                            index: false,
</a><a href="#h61-0-26" id="h61-0-26" class="i">+                                        },
</a><a href="#h61-0-27" id="h61-0-27" class="i">+                                        Column {
</a><a href="#h61-0-28" id="h61-0-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h61-0-29" id="h61-0-29" class="i">+                                            datatype: Integer,
</a><a href="#h61-0-30" id="h61-0-30" class="i">+                                            primary_key: false,
</a><a href="#h61-0-31" id="h61-0-31" class="i">+                                            nullable: false,
</a><a href="#h61-0-32" id="h61-0-32" class="i">+                                            default: None,
</a><a href="#h61-0-33" id="h61-0-33" class="i">+                                            unique: false,
</a><a href="#h61-0-34" id="h61-0-34" class="i">+                                            references: Some(
</a><a href="#h61-0-35" id="h61-0-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h61-0-36" id="h61-0-36" class="i">+                                            ),
</a><a href="#h61-0-37" id="h61-0-37" class="i">+                                            index: true,
</a><a href="#h61-0-38" id="h61-0-38" class="i">+                                        },
</a><a href="#h61-0-39" id="h61-0-39" class="i">+                                        Column {
</a><a href="#h61-0-40" id="h61-0-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h61-0-41" id="h61-0-41" class="i">+                                            datatype: Integer,
</a><a href="#h61-0-42" id="h61-0-42" class="i">+                                            primary_key: false,
</a><a href="#h61-0-43" id="h61-0-43" class="i">+                                            nullable: false,
</a><a href="#h61-0-44" id="h61-0-44" class="i">+                                            default: None,
</a><a href="#h61-0-45" id="h61-0-45" class="i">+                                            unique: false,
</a><a href="#h61-0-46" id="h61-0-46" class="i">+                                            references: Some(
</a><a href="#h61-0-47" id="h61-0-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h61-0-48" id="h61-0-48" class="i">+                                            ),
</a><a href="#h61-0-49" id="h61-0-49" class="i">+                                            index: true,
</a><a href="#h61-0-50" id="h61-0-50" class="i">+                                        },
</a><a href="#h61-0-51" id="h61-0-51" class="i">+                                        Column {
</a><a href="#h61-0-52" id="h61-0-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h61-0-53" id="h61-0-53" class="i">+                                            datatype: Integer,
</a><a href="#h61-0-54" id="h61-0-54" class="i">+                                            primary_key: false,
</a><a href="#h61-0-55" id="h61-0-55" class="i">+                                            nullable: false,
</a><a href="#h61-0-56" id="h61-0-56" class="i">+                                            default: None,
</a><a href="#h61-0-57" id="h61-0-57" class="i">+                                            unique: false,
</a><a href="#h61-0-58" id="h61-0-58" class="i">+                                            references: None,
</a><a href="#h61-0-59" id="h61-0-59" class="i">+                                            index: false,
</a><a href="#h61-0-60" id="h61-0-60" class="i">+                                        },
</a><a href="#h61-0-61" id="h61-0-61" class="i">+                                        Column {
</a><a href="#h61-0-62" id="h61-0-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h61-0-63" id="h61-0-63" class="i">+                                            datatype: Float,
</a><a href="#h61-0-64" id="h61-0-64" class="i">+                                            primary_key: false,
</a><a href="#h61-0-65" id="h61-0-65" class="i">+                                            nullable: true,
</a><a href="#h61-0-66" id="h61-0-66" class="i">+                                            default: Some(
</a><a href="#h61-0-67" id="h61-0-67" class="i">+                                                Null,
</a><a href="#h61-0-68" id="h61-0-68" class="i">+                                            ),
</a><a href="#h61-0-69" id="h61-0-69" class="i">+                                            unique: false,
</a><a href="#h61-0-70" id="h61-0-70" class="i">+                                            references: None,
</a><a href="#h61-0-71" id="h61-0-71" class="i">+                                            index: false,
</a><a href="#h61-0-72" id="h61-0-72" class="i">+                                        },
</a><a href="#h61-0-73" id="h61-0-73" class="i">+                                        Column {
</a><a href="#h61-0-74" id="h61-0-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h61-0-75" id="h61-0-75" class="i">+                                            datatype: Boolean,
</a><a href="#h61-0-76" id="h61-0-76" class="i">+                                            primary_key: false,
</a><a href="#h61-0-77" id="h61-0-77" class="i">+                                            nullable: true,
</a><a href="#h61-0-78" id="h61-0-78" class="i">+                                            default: Some(
</a><a href="#h61-0-79" id="h61-0-79" class="i">+                                                Null,
</a><a href="#h61-0-80" id="h61-0-80" class="i">+                                            ),
</a><a href="#h61-0-81" id="h61-0-81" class="i">+                                            unique: false,
</a><a href="#h61-0-82" id="h61-0-82" class="i">+                                            references: None,
</a><a href="#h61-0-83" id="h61-0-83" class="i">+                                            index: false,
</a><a href="#h61-0-84" id="h61-0-84" class="i">+                                        },
</a><a href="#h61-0-85" id="h61-0-85" class="i">+                                    ],
</a><a href="#h61-0-86" id="h61-0-86" class="i">+                                },
</a>                                 alias: Some(
                                     &quot;m&quot;,
                                 ),
<a href="#h61-1" id="h61-1" class="h">@@ -235,7 +317,31 @@ Plan: Select(
</a>                             },
                             left_size: 7,
                             right: Scan {
<a href="#h61-1-3" id="h61-1-3" class="d">-                                table: &quot;genres&quot;,
</a><a href="#h61-1-4" id="h61-1-4" class="i">+                                table: Table {
</a><a href="#h61-1-5" id="h61-1-5" class="i">+                                    name: &quot;genres&quot;,
</a><a href="#h61-1-6" id="h61-1-6" class="i">+                                    columns: [
</a><a href="#h61-1-7" id="h61-1-7" class="i">+                                        Column {
</a><a href="#h61-1-8" id="h61-1-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h61-1-9" id="h61-1-9" class="i">+                                            datatype: Integer,
</a><a href="#h61-1-10" id="h61-1-10" class="i">+                                            primary_key: true,
</a><a href="#h61-1-11" id="h61-1-11" class="i">+                                            nullable: false,
</a><a href="#h61-1-12" id="h61-1-12" class="i">+                                            default: None,
</a><a href="#h61-1-13" id="h61-1-13" class="i">+                                            unique: true,
</a><a href="#h61-1-14" id="h61-1-14" class="i">+                                            references: None,
</a><a href="#h61-1-15" id="h61-1-15" class="i">+                                            index: false,
</a><a href="#h61-1-16" id="h61-1-16" class="i">+                                        },
</a><a href="#h61-1-17" id="h61-1-17" class="i">+                                        Column {
</a><a href="#h61-1-18" id="h61-1-18" class="i">+                                            name: &quot;name&quot;,
</a><a href="#h61-1-19" id="h61-1-19" class="i">+                                            datatype: String,
</a><a href="#h61-1-20" id="h61-1-20" class="i">+                                            primary_key: false,
</a><a href="#h61-1-21" id="h61-1-21" class="i">+                                            nullable: false,
</a><a href="#h61-1-22" id="h61-1-22" class="i">+                                            default: None,
</a><a href="#h61-1-23" id="h61-1-23" class="i">+                                            unique: false,
</a><a href="#h61-1-24" id="h61-1-24" class="i">+                                            references: None,
</a><a href="#h61-1-25" id="h61-1-25" class="i">+                                            index: false,
</a><a href="#h61-1-26" id="h61-1-26" class="i">+                                        },
</a><a href="#h61-1-27" id="h61-1-27" class="i">+                                    ],
</a><a href="#h61-1-28" id="h61-1-28" class="i">+                                },
</a>                                 alias: Some(
                                     &quot;g&quot;,
                                 ),
<a href="#h61-2" id="h61-2" class="h">@@ -272,7 +378,45 @@ Plan: Select(
</a>                         left_size: 9,
                         right: NestedLoopJoin {
                             left: Scan {
<a href="#h61-2-3" id="h61-2-3" class="d">-                                table: &quot;studios&quot;,
</a><a href="#h61-2-4" id="h61-2-4" class="i">+                                table: Table {
</a><a href="#h61-2-5" id="h61-2-5" class="i">+                                    name: &quot;studios&quot;,
</a><a href="#h61-2-6" id="h61-2-6" class="i">+                                    columns: [
</a><a href="#h61-2-7" id="h61-2-7" class="i">+                                        Column {
</a><a href="#h61-2-8" id="h61-2-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h61-2-9" id="h61-2-9" class="i">+                                            datatype: Integer,
</a><a href="#h61-2-10" id="h61-2-10" class="i">+                                            primary_key: true,
</a><a href="#h61-2-11" id="h61-2-11" class="i">+                                            nullable: false,
</a><a href="#h61-2-12" id="h61-2-12" class="i">+                                            default: None,
</a><a href="#h61-2-13" id="h61-2-13" class="i">+                                            unique: true,
</a><a href="#h61-2-14" id="h61-2-14" class="i">+                                            references: None,
</a><a href="#h61-2-15" id="h61-2-15" class="i">+                                            index: false,
</a><a href="#h61-2-16" id="h61-2-16" class="i">+                                        },
</a><a href="#h61-2-17" id="h61-2-17" class="i">+                                        Column {
</a><a href="#h61-2-18" id="h61-2-18" class="i">+                                            name: &quot;name&quot;,
</a><a href="#h61-2-19" id="h61-2-19" class="i">+                                            datatype: String,
</a><a href="#h61-2-20" id="h61-2-20" class="i">+                                            primary_key: false,
</a><a href="#h61-2-21" id="h61-2-21" class="i">+                                            nullable: false,
</a><a href="#h61-2-22" id="h61-2-22" class="i">+                                            default: None,
</a><a href="#h61-2-23" id="h61-2-23" class="i">+                                            unique: false,
</a><a href="#h61-2-24" id="h61-2-24" class="i">+                                            references: None,
</a><a href="#h61-2-25" id="h61-2-25" class="i">+                                            index: false,
</a><a href="#h61-2-26" id="h61-2-26" class="i">+                                        },
</a><a href="#h61-2-27" id="h61-2-27" class="i">+                                        Column {
</a><a href="#h61-2-28" id="h61-2-28" class="i">+                                            name: &quot;country_id&quot;,
</a><a href="#h61-2-29" id="h61-2-29" class="i">+                                            datatype: String,
</a><a href="#h61-2-30" id="h61-2-30" class="i">+                                            primary_key: false,
</a><a href="#h61-2-31" id="h61-2-31" class="i">+                                            nullable: true,
</a><a href="#h61-2-32" id="h61-2-32" class="i">+                                            default: Some(
</a><a href="#h61-2-33" id="h61-2-33" class="i">+                                                Null,
</a><a href="#h61-2-34" id="h61-2-34" class="i">+                                            ),
</a><a href="#h61-2-35" id="h61-2-35" class="i">+                                            unique: false,
</a><a href="#h61-2-36" id="h61-2-36" class="i">+                                            references: Some(
</a><a href="#h61-2-37" id="h61-2-37" class="i">+                                                &quot;countries&quot;,
</a><a href="#h61-2-38" id="h61-2-38" class="i">+                                            ),
</a><a href="#h61-2-39" id="h61-2-39" class="i">+                                            index: true,
</a><a href="#h61-2-40" id="h61-2-40" class="i">+                                        },
</a><a href="#h61-2-41" id="h61-2-41" class="i">+                                    ],
</a><a href="#h61-2-42" id="h61-2-42" class="i">+                                },
</a>                                 alias: Some(
                                     &quot;s&quot;,
                                 ),
<a href="#h61-3" id="h61-3" class="h">@@ -280,7 +424,89 @@ Plan: Select(
</a>                             },
                             left_size: 3,
                             right: Scan {
<a href="#h61-3-3" id="h61-3-3" class="d">-                                table: &quot;movies&quot;,
</a><a href="#h61-3-4" id="h61-3-4" class="i">+                                table: Table {
</a><a href="#h61-3-5" id="h61-3-5" class="i">+                                    name: &quot;movies&quot;,
</a><a href="#h61-3-6" id="h61-3-6" class="i">+                                    columns: [
</a><a href="#h61-3-7" id="h61-3-7" class="i">+                                        Column {
</a><a href="#h61-3-8" id="h61-3-8" class="i">+                                            name: &quot;id&quot;,
</a><a href="#h61-3-9" id="h61-3-9" class="i">+                                            datatype: Integer,
</a><a href="#h61-3-10" id="h61-3-10" class="i">+                                            primary_key: true,
</a><a href="#h61-3-11" id="h61-3-11" class="i">+                                            nullable: false,
</a><a href="#h61-3-12" id="h61-3-12" class="i">+                                            default: None,
</a><a href="#h61-3-13" id="h61-3-13" class="i">+                                            unique: true,
</a><a href="#h61-3-14" id="h61-3-14" class="i">+                                            references: None,
</a><a href="#h61-3-15" id="h61-3-15" class="i">+                                            index: false,
</a><a href="#h61-3-16" id="h61-3-16" class="i">+                                        },
</a><a href="#h61-3-17" id="h61-3-17" class="i">+                                        Column {
</a><a href="#h61-3-18" id="h61-3-18" class="i">+                                            name: &quot;title&quot;,
</a><a href="#h61-3-19" id="h61-3-19" class="i">+                                            datatype: String,
</a><a href="#h61-3-20" id="h61-3-20" class="i">+                                            primary_key: false,
</a><a href="#h61-3-21" id="h61-3-21" class="i">+                                            nullable: false,
</a><a href="#h61-3-22" id="h61-3-22" class="i">+                                            default: None,
</a><a href="#h61-3-23" id="h61-3-23" class="i">+                                            unique: false,
</a><a href="#h61-3-24" id="h61-3-24" class="i">+                                            references: None,
</a><a href="#h61-3-25" id="h61-3-25" class="i">+                                            index: false,
</a><a href="#h61-3-26" id="h61-3-26" class="i">+                                        },
</a><a href="#h61-3-27" id="h61-3-27" class="i">+                                        Column {
</a><a href="#h61-3-28" id="h61-3-28" class="i">+                                            name: &quot;studio_id&quot;,
</a><a href="#h61-3-29" id="h61-3-29" class="i">+                                            datatype: Integer,
</a><a href="#h61-3-30" id="h61-3-30" class="i">+                                            primary_key: false,
</a><a href="#h61-3-31" id="h61-3-31" class="i">+                                            nullable: false,
</a><a href="#h61-3-32" id="h61-3-32" class="i">+                                            default: None,
</a><a href="#h61-3-33" id="h61-3-33" class="i">+                                            unique: false,
</a><a href="#h61-3-34" id="h61-3-34" class="i">+                                            references: Some(
</a><a href="#h61-3-35" id="h61-3-35" class="i">+                                                &quot;studios&quot;,
</a><a href="#h61-3-36" id="h61-3-36" class="i">+                                            ),
</a><a href="#h61-3-37" id="h61-3-37" class="i">+                                            index: true,
</a><a href="#h61-3-38" id="h61-3-38" class="i">+                                        },
</a><a href="#h61-3-39" id="h61-3-39" class="i">+                                        Column {
</a><a href="#h61-3-40" id="h61-3-40" class="i">+                                            name: &quot;genre_id&quot;,
</a><a href="#h61-3-41" id="h61-3-41" class="i">+                                            datatype: Integer,
</a><a href="#h61-3-42" id="h61-3-42" class="i">+                                            primary_key: false,
</a><a href="#h61-3-43" id="h61-3-43" class="i">+                                            nullable: false,
</a><a href="#h61-3-44" id="h61-3-44" class="i">+                                            default: None,
</a><a href="#h61-3-45" id="h61-3-45" class="i">+                                            unique: false,
</a><a href="#h61-3-46" id="h61-3-46" class="i">+                                            references: Some(
</a><a href="#h61-3-47" id="h61-3-47" class="i">+                                                &quot;genres&quot;,
</a><a href="#h61-3-48" id="h61-3-48" class="i">+                                            ),
</a><a href="#h61-3-49" id="h61-3-49" class="i">+                                            index: true,
</a><a href="#h61-3-50" id="h61-3-50" class="i">+                                        },
</a><a href="#h61-3-51" id="h61-3-51" class="i">+                                        Column {
</a><a href="#h61-3-52" id="h61-3-52" class="i">+                                            name: &quot;released&quot;,
</a><a href="#h61-3-53" id="h61-3-53" class="i">+                                            datatype: Integer,
</a><a href="#h61-3-54" id="h61-3-54" class="i">+                                            primary_key: false,
</a><a href="#h61-3-55" id="h61-3-55" class="i">+                                            nullable: false,
</a><a href="#h61-3-56" id="h61-3-56" class="i">+                                            default: None,
</a><a href="#h61-3-57" id="h61-3-57" class="i">+                                            unique: false,
</a><a href="#h61-3-58" id="h61-3-58" class="i">+                                            references: None,
</a><a href="#h61-3-59" id="h61-3-59" class="i">+                                            index: false,
</a><a href="#h61-3-60" id="h61-3-60" class="i">+                                        },
</a><a href="#h61-3-61" id="h61-3-61" class="i">+                                        Column {
</a><a href="#h61-3-62" id="h61-3-62" class="i">+                                            name: &quot;rating&quot;,
</a><a href="#h61-3-63" id="h61-3-63" class="i">+                                            datatype: Float,
</a><a href="#h61-3-64" id="h61-3-64" class="i">+                                            primary_key: false,
</a><a href="#h61-3-65" id="h61-3-65" class="i">+                                            nullable: true,
</a><a href="#h61-3-66" id="h61-3-66" class="i">+                                            default: Some(
</a><a href="#h61-3-67" id="h61-3-67" class="i">+                                                Null,
</a><a href="#h61-3-68" id="h61-3-68" class="i">+                                            ),
</a><a href="#h61-3-69" id="h61-3-69" class="i">+                                            unique: false,
</a><a href="#h61-3-70" id="h61-3-70" class="i">+                                            references: None,
</a><a href="#h61-3-71" id="h61-3-71" class="i">+                                            index: false,
</a><a href="#h61-3-72" id="h61-3-72" class="i">+                                        },
</a><a href="#h61-3-73" id="h61-3-73" class="i">+                                        Column {
</a><a href="#h61-3-74" id="h61-3-74" class="i">+                                            name: &quot;ultrahd&quot;,
</a><a href="#h61-3-75" id="h61-3-75" class="i">+                                            datatype: Boolean,
</a><a href="#h61-3-76" id="h61-3-76" class="i">+                                            primary_key: false,
</a><a href="#h61-3-77" id="h61-3-77" class="i">+                                            nullable: true,
</a><a href="#h61-3-78" id="h61-3-78" class="i">+                                            default: Some(
</a><a href="#h61-3-79" id="h61-3-79" class="i">+                                                Null,
</a><a href="#h61-3-80" id="h61-3-80" class="i">+                                            ),
</a><a href="#h61-3-81" id="h61-3-81" class="i">+                                            unique: false,
</a><a href="#h61-3-82" id="h61-3-82" class="i">+                                            references: None,
</a><a href="#h61-3-83" id="h61-3-83" class="i">+                                            index: false,
</a><a href="#h61-3-84" id="h61-3-84" class="i">+                                        },
</a><a href="#h61-3-85" id="h61-3-85" class="i">+                                    ],
</a><a href="#h61-3-86" id="h61-3-86" class="i">+                                },
</a>                                 alias: Some(
                                     &quot;good&quot;,
                                 ),
<a href="#h61-4" id="h61-4" class="h">@@ -565,7 +791,89 @@ Optimized plan: Select(
</a>                 source: HashJoin {
                     left: HashJoin {
                         left: Scan {
<a href="#h61-4-3" id="h61-4-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h61-4-4" id="h61-4-4" class="i">+                            table: Table {
</a><a href="#h61-4-5" id="h61-4-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h61-4-6" id="h61-4-6" class="i">+                                columns: [
</a><a href="#h61-4-7" id="h61-4-7" class="i">+                                    Column {
</a><a href="#h61-4-8" id="h61-4-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h61-4-9" id="h61-4-9" class="i">+                                        datatype: Integer,
</a><a href="#h61-4-10" id="h61-4-10" class="i">+                                        primary_key: true,
</a><a href="#h61-4-11" id="h61-4-11" class="i">+                                        nullable: false,
</a><a href="#h61-4-12" id="h61-4-12" class="i">+                                        default: None,
</a><a href="#h61-4-13" id="h61-4-13" class="i">+                                        unique: true,
</a><a href="#h61-4-14" id="h61-4-14" class="i">+                                        references: None,
</a><a href="#h61-4-15" id="h61-4-15" class="i">+                                        index: false,
</a><a href="#h61-4-16" id="h61-4-16" class="i">+                                    },
</a><a href="#h61-4-17" id="h61-4-17" class="i">+                                    Column {
</a><a href="#h61-4-18" id="h61-4-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h61-4-19" id="h61-4-19" class="i">+                                        datatype: String,
</a><a href="#h61-4-20" id="h61-4-20" class="i">+                                        primary_key: false,
</a><a href="#h61-4-21" id="h61-4-21" class="i">+                                        nullable: false,
</a><a href="#h61-4-22" id="h61-4-22" class="i">+                                        default: None,
</a><a href="#h61-4-23" id="h61-4-23" class="i">+                                        unique: false,
</a><a href="#h61-4-24" id="h61-4-24" class="i">+                                        references: None,
</a><a href="#h61-4-25" id="h61-4-25" class="i">+                                        index: false,
</a><a href="#h61-4-26" id="h61-4-26" class="i">+                                    },
</a><a href="#h61-4-27" id="h61-4-27" class="i">+                                    Column {
</a><a href="#h61-4-28" id="h61-4-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h61-4-29" id="h61-4-29" class="i">+                                        datatype: Integer,
</a><a href="#h61-4-30" id="h61-4-30" class="i">+                                        primary_key: false,
</a><a href="#h61-4-31" id="h61-4-31" class="i">+                                        nullable: false,
</a><a href="#h61-4-32" id="h61-4-32" class="i">+                                        default: None,
</a><a href="#h61-4-33" id="h61-4-33" class="i">+                                        unique: false,
</a><a href="#h61-4-34" id="h61-4-34" class="i">+                                        references: Some(
</a><a href="#h61-4-35" id="h61-4-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h61-4-36" id="h61-4-36" class="i">+                                        ),
</a><a href="#h61-4-37" id="h61-4-37" class="i">+                                        index: true,
</a><a href="#h61-4-38" id="h61-4-38" class="i">+                                    },
</a><a href="#h61-4-39" id="h61-4-39" class="i">+                                    Column {
</a><a href="#h61-4-40" id="h61-4-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h61-4-41" id="h61-4-41" class="i">+                                        datatype: Integer,
</a><a href="#h61-4-42" id="h61-4-42" class="i">+                                        primary_key: false,
</a><a href="#h61-4-43" id="h61-4-43" class="i">+                                        nullable: false,
</a><a href="#h61-4-44" id="h61-4-44" class="i">+                                        default: None,
</a><a href="#h61-4-45" id="h61-4-45" class="i">+                                        unique: false,
</a><a href="#h61-4-46" id="h61-4-46" class="i">+                                        references: Some(
</a><a href="#h61-4-47" id="h61-4-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h61-4-48" id="h61-4-48" class="i">+                                        ),
</a><a href="#h61-4-49" id="h61-4-49" class="i">+                                        index: true,
</a><a href="#h61-4-50" id="h61-4-50" class="i">+                                    },
</a><a href="#h61-4-51" id="h61-4-51" class="i">+                                    Column {
</a><a href="#h61-4-52" id="h61-4-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h61-4-53" id="h61-4-53" class="i">+                                        datatype: Integer,
</a><a href="#h61-4-54" id="h61-4-54" class="i">+                                        primary_key: false,
</a><a href="#h61-4-55" id="h61-4-55" class="i">+                                        nullable: false,
</a><a href="#h61-4-56" id="h61-4-56" class="i">+                                        default: None,
</a><a href="#h61-4-57" id="h61-4-57" class="i">+                                        unique: false,
</a><a href="#h61-4-58" id="h61-4-58" class="i">+                                        references: None,
</a><a href="#h61-4-59" id="h61-4-59" class="i">+                                        index: false,
</a><a href="#h61-4-60" id="h61-4-60" class="i">+                                    },
</a><a href="#h61-4-61" id="h61-4-61" class="i">+                                    Column {
</a><a href="#h61-4-62" id="h61-4-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h61-4-63" id="h61-4-63" class="i">+                                        datatype: Float,
</a><a href="#h61-4-64" id="h61-4-64" class="i">+                                        primary_key: false,
</a><a href="#h61-4-65" id="h61-4-65" class="i">+                                        nullable: true,
</a><a href="#h61-4-66" id="h61-4-66" class="i">+                                        default: Some(
</a><a href="#h61-4-67" id="h61-4-67" class="i">+                                            Null,
</a><a href="#h61-4-68" id="h61-4-68" class="i">+                                        ),
</a><a href="#h61-4-69" id="h61-4-69" class="i">+                                        unique: false,
</a><a href="#h61-4-70" id="h61-4-70" class="i">+                                        references: None,
</a><a href="#h61-4-71" id="h61-4-71" class="i">+                                        index: false,
</a><a href="#h61-4-72" id="h61-4-72" class="i">+                                    },
</a><a href="#h61-4-73" id="h61-4-73" class="i">+                                    Column {
</a><a href="#h61-4-74" id="h61-4-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h61-4-75" id="h61-4-75" class="i">+                                        datatype: Boolean,
</a><a href="#h61-4-76" id="h61-4-76" class="i">+                                        primary_key: false,
</a><a href="#h61-4-77" id="h61-4-77" class="i">+                                        nullable: true,
</a><a href="#h61-4-78" id="h61-4-78" class="i">+                                        default: Some(
</a><a href="#h61-4-79" id="h61-4-79" class="i">+                                            Null,
</a><a href="#h61-4-80" id="h61-4-80" class="i">+                                        ),
</a><a href="#h61-4-81" id="h61-4-81" class="i">+                                        unique: false,
</a><a href="#h61-4-82" id="h61-4-82" class="i">+                                        references: None,
</a><a href="#h61-4-83" id="h61-4-83" class="i">+                                        index: false,
</a><a href="#h61-4-84" id="h61-4-84" class="i">+                                    },
</a><a href="#h61-4-85" id="h61-4-85" class="i">+                                ],
</a><a href="#h61-4-86" id="h61-4-86" class="i">+                            },
</a>                             alias: Some(
                                 &quot;m&quot;,
                             ),
<a href="#h61-5" id="h61-5" class="h">@@ -583,7 +891,31 @@ Optimized plan: Select(
</a>                             ),
                         ),
                         right: Scan {
<a href="#h61-5-3" id="h61-5-3" class="d">-                            table: &quot;genres&quot;,
</a><a href="#h61-5-4" id="h61-5-4" class="i">+                            table: Table {
</a><a href="#h61-5-5" id="h61-5-5" class="i">+                                name: &quot;genres&quot;,
</a><a href="#h61-5-6" id="h61-5-6" class="i">+                                columns: [
</a><a href="#h61-5-7" id="h61-5-7" class="i">+                                    Column {
</a><a href="#h61-5-8" id="h61-5-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h61-5-9" id="h61-5-9" class="i">+                                        datatype: Integer,
</a><a href="#h61-5-10" id="h61-5-10" class="i">+                                        primary_key: true,
</a><a href="#h61-5-11" id="h61-5-11" class="i">+                                        nullable: false,
</a><a href="#h61-5-12" id="h61-5-12" class="i">+                                        default: None,
</a><a href="#h61-5-13" id="h61-5-13" class="i">+                                        unique: true,
</a><a href="#h61-5-14" id="h61-5-14" class="i">+                                        references: None,
</a><a href="#h61-5-15" id="h61-5-15" class="i">+                                        index: false,
</a><a href="#h61-5-16" id="h61-5-16" class="i">+                                    },
</a><a href="#h61-5-17" id="h61-5-17" class="i">+                                    Column {
</a><a href="#h61-5-18" id="h61-5-18" class="i">+                                        name: &quot;name&quot;,
</a><a href="#h61-5-19" id="h61-5-19" class="i">+                                        datatype: String,
</a><a href="#h61-5-20" id="h61-5-20" class="i">+                                        primary_key: false,
</a><a href="#h61-5-21" id="h61-5-21" class="i">+                                        nullable: false,
</a><a href="#h61-5-22" id="h61-5-22" class="i">+                                        default: None,
</a><a href="#h61-5-23" id="h61-5-23" class="i">+                                        unique: false,
</a><a href="#h61-5-24" id="h61-5-24" class="i">+                                        references: None,
</a><a href="#h61-5-25" id="h61-5-25" class="i">+                                        index: false,
</a><a href="#h61-5-26" id="h61-5-26" class="i">+                                    },
</a><a href="#h61-5-27" id="h61-5-27" class="i">+                                ],
</a><a href="#h61-5-28" id="h61-5-28" class="i">+                            },
</a>                             alias: Some(
                                 &quot;g&quot;,
                             ),
<a href="#h61-6" id="h61-6" class="h">@@ -615,7 +947,45 @@ Optimized plan: Select(
</a>                     ),
                     right: HashJoin {
                         left: Scan {
<a href="#h61-6-3" id="h61-6-3" class="d">-                            table: &quot;studios&quot;,
</a><a href="#h61-6-4" id="h61-6-4" class="i">+                            table: Table {
</a><a href="#h61-6-5" id="h61-6-5" class="i">+                                name: &quot;studios&quot;,
</a><a href="#h61-6-6" id="h61-6-6" class="i">+                                columns: [
</a><a href="#h61-6-7" id="h61-6-7" class="i">+                                    Column {
</a><a href="#h61-6-8" id="h61-6-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h61-6-9" id="h61-6-9" class="i">+                                        datatype: Integer,
</a><a href="#h61-6-10" id="h61-6-10" class="i">+                                        primary_key: true,
</a><a href="#h61-6-11" id="h61-6-11" class="i">+                                        nullable: false,
</a><a href="#h61-6-12" id="h61-6-12" class="i">+                                        default: None,
</a><a href="#h61-6-13" id="h61-6-13" class="i">+                                        unique: true,
</a><a href="#h61-6-14" id="h61-6-14" class="i">+                                        references: None,
</a><a href="#h61-6-15" id="h61-6-15" class="i">+                                        index: false,
</a><a href="#h61-6-16" id="h61-6-16" class="i">+                                    },
</a><a href="#h61-6-17" id="h61-6-17" class="i">+                                    Column {
</a><a href="#h61-6-18" id="h61-6-18" class="i">+                                        name: &quot;name&quot;,
</a><a href="#h61-6-19" id="h61-6-19" class="i">+                                        datatype: String,
</a><a href="#h61-6-20" id="h61-6-20" class="i">+                                        primary_key: false,
</a><a href="#h61-6-21" id="h61-6-21" class="i">+                                        nullable: false,
</a><a href="#h61-6-22" id="h61-6-22" class="i">+                                        default: None,
</a><a href="#h61-6-23" id="h61-6-23" class="i">+                                        unique: false,
</a><a href="#h61-6-24" id="h61-6-24" class="i">+                                        references: None,
</a><a href="#h61-6-25" id="h61-6-25" class="i">+                                        index: false,
</a><a href="#h61-6-26" id="h61-6-26" class="i">+                                    },
</a><a href="#h61-6-27" id="h61-6-27" class="i">+                                    Column {
</a><a href="#h61-6-28" id="h61-6-28" class="i">+                                        name: &quot;country_id&quot;,
</a><a href="#h61-6-29" id="h61-6-29" class="i">+                                        datatype: String,
</a><a href="#h61-6-30" id="h61-6-30" class="i">+                                        primary_key: false,
</a><a href="#h61-6-31" id="h61-6-31" class="i">+                                        nullable: true,
</a><a href="#h61-6-32" id="h61-6-32" class="i">+                                        default: Some(
</a><a href="#h61-6-33" id="h61-6-33" class="i">+                                            Null,
</a><a href="#h61-6-34" id="h61-6-34" class="i">+                                        ),
</a><a href="#h61-6-35" id="h61-6-35" class="i">+                                        unique: false,
</a><a href="#h61-6-36" id="h61-6-36" class="i">+                                        references: Some(
</a><a href="#h61-6-37" id="h61-6-37" class="i">+                                            &quot;countries&quot;,
</a><a href="#h61-6-38" id="h61-6-38" class="i">+                                        ),
</a><a href="#h61-6-39" id="h61-6-39" class="i">+                                        index: true,
</a><a href="#h61-6-40" id="h61-6-40" class="i">+                                    },
</a><a href="#h61-6-41" id="h61-6-41" class="i">+                                ],
</a><a href="#h61-6-42" id="h61-6-42" class="i">+                            },
</a>                             alias: Some(
                                 &quot;s&quot;,
                             ),
<a href="#h61-7" id="h61-7" class="h">@@ -633,7 +1003,89 @@ Optimized plan: Select(
</a>                             ),
                         ),
                         right: Scan {
<a href="#h61-7-3" id="h61-7-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h61-7-4" id="h61-7-4" class="i">+                            table: Table {
</a><a href="#h61-7-5" id="h61-7-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h61-7-6" id="h61-7-6" class="i">+                                columns: [
</a><a href="#h61-7-7" id="h61-7-7" class="i">+                                    Column {
</a><a href="#h61-7-8" id="h61-7-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h61-7-9" id="h61-7-9" class="i">+                                        datatype: Integer,
</a><a href="#h61-7-10" id="h61-7-10" class="i">+                                        primary_key: true,
</a><a href="#h61-7-11" id="h61-7-11" class="i">+                                        nullable: false,
</a><a href="#h61-7-12" id="h61-7-12" class="i">+                                        default: None,
</a><a href="#h61-7-13" id="h61-7-13" class="i">+                                        unique: true,
</a><a href="#h61-7-14" id="h61-7-14" class="i">+                                        references: None,
</a><a href="#h61-7-15" id="h61-7-15" class="i">+                                        index: false,
</a><a href="#h61-7-16" id="h61-7-16" class="i">+                                    },
</a><a href="#h61-7-17" id="h61-7-17" class="i">+                                    Column {
</a><a href="#h61-7-18" id="h61-7-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h61-7-19" id="h61-7-19" class="i">+                                        datatype: String,
</a><a href="#h61-7-20" id="h61-7-20" class="i">+                                        primary_key: false,
</a><a href="#h61-7-21" id="h61-7-21" class="i">+                                        nullable: false,
</a><a href="#h61-7-22" id="h61-7-22" class="i">+                                        default: None,
</a><a href="#h61-7-23" id="h61-7-23" class="i">+                                        unique: false,
</a><a href="#h61-7-24" id="h61-7-24" class="i">+                                        references: None,
</a><a href="#h61-7-25" id="h61-7-25" class="i">+                                        index: false,
</a><a href="#h61-7-26" id="h61-7-26" class="i">+                                    },
</a><a href="#h61-7-27" id="h61-7-27" class="i">+                                    Column {
</a><a href="#h61-7-28" id="h61-7-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h61-7-29" id="h61-7-29" class="i">+                                        datatype: Integer,
</a><a href="#h61-7-30" id="h61-7-30" class="i">+                                        primary_key: false,
</a><a href="#h61-7-31" id="h61-7-31" class="i">+                                        nullable: false,
</a><a href="#h61-7-32" id="h61-7-32" class="i">+                                        default: None,
</a><a href="#h61-7-33" id="h61-7-33" class="i">+                                        unique: false,
</a><a href="#h61-7-34" id="h61-7-34" class="i">+                                        references: Some(
</a><a href="#h61-7-35" id="h61-7-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h61-7-36" id="h61-7-36" class="i">+                                        ),
</a><a href="#h61-7-37" id="h61-7-37" class="i">+                                        index: true,
</a><a href="#h61-7-38" id="h61-7-38" class="i">+                                    },
</a><a href="#h61-7-39" id="h61-7-39" class="i">+                                    Column {
</a><a href="#h61-7-40" id="h61-7-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h61-7-41" id="h61-7-41" class="i">+                                        datatype: Integer,
</a><a href="#h61-7-42" id="h61-7-42" class="i">+                                        primary_key: false,
</a><a href="#h61-7-43" id="h61-7-43" class="i">+                                        nullable: false,
</a><a href="#h61-7-44" id="h61-7-44" class="i">+                                        default: None,
</a><a href="#h61-7-45" id="h61-7-45" class="i">+                                        unique: false,
</a><a href="#h61-7-46" id="h61-7-46" class="i">+                                        references: Some(
</a><a href="#h61-7-47" id="h61-7-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h61-7-48" id="h61-7-48" class="i">+                                        ),
</a><a href="#h61-7-49" id="h61-7-49" class="i">+                                        index: true,
</a><a href="#h61-7-50" id="h61-7-50" class="i">+                                    },
</a><a href="#h61-7-51" id="h61-7-51" class="i">+                                    Column {
</a><a href="#h61-7-52" id="h61-7-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h61-7-53" id="h61-7-53" class="i">+                                        datatype: Integer,
</a><a href="#h61-7-54" id="h61-7-54" class="i">+                                        primary_key: false,
</a><a href="#h61-7-55" id="h61-7-55" class="i">+                                        nullable: false,
</a><a href="#h61-7-56" id="h61-7-56" class="i">+                                        default: None,
</a><a href="#h61-7-57" id="h61-7-57" class="i">+                                        unique: false,
</a><a href="#h61-7-58" id="h61-7-58" class="i">+                                        references: None,
</a><a href="#h61-7-59" id="h61-7-59" class="i">+                                        index: false,
</a><a href="#h61-7-60" id="h61-7-60" class="i">+                                    },
</a><a href="#h61-7-61" id="h61-7-61" class="i">+                                    Column {
</a><a href="#h61-7-62" id="h61-7-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h61-7-63" id="h61-7-63" class="i">+                                        datatype: Float,
</a><a href="#h61-7-64" id="h61-7-64" class="i">+                                        primary_key: false,
</a><a href="#h61-7-65" id="h61-7-65" class="i">+                                        nullable: true,
</a><a href="#h61-7-66" id="h61-7-66" class="i">+                                        default: Some(
</a><a href="#h61-7-67" id="h61-7-67" class="i">+                                            Null,
</a><a href="#h61-7-68" id="h61-7-68" class="i">+                                        ),
</a><a href="#h61-7-69" id="h61-7-69" class="i">+                                        unique: false,
</a><a href="#h61-7-70" id="h61-7-70" class="i">+                                        references: None,
</a><a href="#h61-7-71" id="h61-7-71" class="i">+                                        index: false,
</a><a href="#h61-7-72" id="h61-7-72" class="i">+                                    },
</a><a href="#h61-7-73" id="h61-7-73" class="i">+                                    Column {
</a><a href="#h61-7-74" id="h61-7-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h61-7-75" id="h61-7-75" class="i">+                                        datatype: Boolean,
</a><a href="#h61-7-76" id="h61-7-76" class="i">+                                        primary_key: false,
</a><a href="#h61-7-77" id="h61-7-77" class="i">+                                        nullable: true,
</a><a href="#h61-7-78" id="h61-7-78" class="i">+                                        default: Some(
</a><a href="#h61-7-79" id="h61-7-79" class="i">+                                            Null,
</a><a href="#h61-7-80" id="h61-7-80" class="i">+                                        ),
</a><a href="#h61-7-81" id="h61-7-81" class="i">+                                        unique: false,
</a><a href="#h61-7-82" id="h61-7-82" class="i">+                                        references: None,
</a><a href="#h61-7-83" id="h61-7-83" class="i">+                                        index: false,
</a><a href="#h61-7-84" id="h61-7-84" class="i">+                                    },
</a><a href="#h61-7-85" id="h61-7-85" class="i">+                                ],
</a><a href="#h61-7-86" id="h61-7-86" class="i">+                            },
</a>                             alias: Some(
                                 &quot;good&quot;,
                             ),
<b>diff --git a/<a id="h62" href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a> b/<a href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -65,7 +65,89 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h62-0-3" id="h62-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h62-0-4" id="h62-0-4" class="i">+            table: Table {
</a><a href="#h62-0-5" id="h62-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h62-0-6" id="h62-0-6" class="i">+                columns: [
</a><a href="#h62-0-7" id="h62-0-7" class="i">+                    Column {
</a><a href="#h62-0-8" id="h62-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h62-0-9" id="h62-0-9" class="i">+                        datatype: Integer,
</a><a href="#h62-0-10" id="h62-0-10" class="i">+                        primary_key: true,
</a><a href="#h62-0-11" id="h62-0-11" class="i">+                        nullable: false,
</a><a href="#h62-0-12" id="h62-0-12" class="i">+                        default: None,
</a><a href="#h62-0-13" id="h62-0-13" class="i">+                        unique: true,
</a><a href="#h62-0-14" id="h62-0-14" class="i">+                        references: None,
</a><a href="#h62-0-15" id="h62-0-15" class="i">+                        index: false,
</a><a href="#h62-0-16" id="h62-0-16" class="i">+                    },
</a><a href="#h62-0-17" id="h62-0-17" class="i">+                    Column {
</a><a href="#h62-0-18" id="h62-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h62-0-19" id="h62-0-19" class="i">+                        datatype: String,
</a><a href="#h62-0-20" id="h62-0-20" class="i">+                        primary_key: false,
</a><a href="#h62-0-21" id="h62-0-21" class="i">+                        nullable: false,
</a><a href="#h62-0-22" id="h62-0-22" class="i">+                        default: None,
</a><a href="#h62-0-23" id="h62-0-23" class="i">+                        unique: false,
</a><a href="#h62-0-24" id="h62-0-24" class="i">+                        references: None,
</a><a href="#h62-0-25" id="h62-0-25" class="i">+                        index: false,
</a><a href="#h62-0-26" id="h62-0-26" class="i">+                    },
</a><a href="#h62-0-27" id="h62-0-27" class="i">+                    Column {
</a><a href="#h62-0-28" id="h62-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h62-0-29" id="h62-0-29" class="i">+                        datatype: Integer,
</a><a href="#h62-0-30" id="h62-0-30" class="i">+                        primary_key: false,
</a><a href="#h62-0-31" id="h62-0-31" class="i">+                        nullable: false,
</a><a href="#h62-0-32" id="h62-0-32" class="i">+                        default: None,
</a><a href="#h62-0-33" id="h62-0-33" class="i">+                        unique: false,
</a><a href="#h62-0-34" id="h62-0-34" class="i">+                        references: Some(
</a><a href="#h62-0-35" id="h62-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h62-0-36" id="h62-0-36" class="i">+                        ),
</a><a href="#h62-0-37" id="h62-0-37" class="i">+                        index: true,
</a><a href="#h62-0-38" id="h62-0-38" class="i">+                    },
</a><a href="#h62-0-39" id="h62-0-39" class="i">+                    Column {
</a><a href="#h62-0-40" id="h62-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h62-0-41" id="h62-0-41" class="i">+                        datatype: Integer,
</a><a href="#h62-0-42" id="h62-0-42" class="i">+                        primary_key: false,
</a><a href="#h62-0-43" id="h62-0-43" class="i">+                        nullable: false,
</a><a href="#h62-0-44" id="h62-0-44" class="i">+                        default: None,
</a><a href="#h62-0-45" id="h62-0-45" class="i">+                        unique: false,
</a><a href="#h62-0-46" id="h62-0-46" class="i">+                        references: Some(
</a><a href="#h62-0-47" id="h62-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h62-0-48" id="h62-0-48" class="i">+                        ),
</a><a href="#h62-0-49" id="h62-0-49" class="i">+                        index: true,
</a><a href="#h62-0-50" id="h62-0-50" class="i">+                    },
</a><a href="#h62-0-51" id="h62-0-51" class="i">+                    Column {
</a><a href="#h62-0-52" id="h62-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h62-0-53" id="h62-0-53" class="i">+                        datatype: Integer,
</a><a href="#h62-0-54" id="h62-0-54" class="i">+                        primary_key: false,
</a><a href="#h62-0-55" id="h62-0-55" class="i">+                        nullable: false,
</a><a href="#h62-0-56" id="h62-0-56" class="i">+                        default: None,
</a><a href="#h62-0-57" id="h62-0-57" class="i">+                        unique: false,
</a><a href="#h62-0-58" id="h62-0-58" class="i">+                        references: None,
</a><a href="#h62-0-59" id="h62-0-59" class="i">+                        index: false,
</a><a href="#h62-0-60" id="h62-0-60" class="i">+                    },
</a><a href="#h62-0-61" id="h62-0-61" class="i">+                    Column {
</a><a href="#h62-0-62" id="h62-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h62-0-63" id="h62-0-63" class="i">+                        datatype: Float,
</a><a href="#h62-0-64" id="h62-0-64" class="i">+                        primary_key: false,
</a><a href="#h62-0-65" id="h62-0-65" class="i">+                        nullable: true,
</a><a href="#h62-0-66" id="h62-0-66" class="i">+                        default: Some(
</a><a href="#h62-0-67" id="h62-0-67" class="i">+                            Null,
</a><a href="#h62-0-68" id="h62-0-68" class="i">+                        ),
</a><a href="#h62-0-69" id="h62-0-69" class="i">+                        unique: false,
</a><a href="#h62-0-70" id="h62-0-70" class="i">+                        references: None,
</a><a href="#h62-0-71" id="h62-0-71" class="i">+                        index: false,
</a><a href="#h62-0-72" id="h62-0-72" class="i">+                    },
</a><a href="#h62-0-73" id="h62-0-73" class="i">+                    Column {
</a><a href="#h62-0-74" id="h62-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h62-0-75" id="h62-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h62-0-76" id="h62-0-76" class="i">+                        primary_key: false,
</a><a href="#h62-0-77" id="h62-0-77" class="i">+                        nullable: true,
</a><a href="#h62-0-78" id="h62-0-78" class="i">+                        default: Some(
</a><a href="#h62-0-79" id="h62-0-79" class="i">+                            Null,
</a><a href="#h62-0-80" id="h62-0-80" class="i">+                        ),
</a><a href="#h62-0-81" id="h62-0-81" class="i">+                        unique: false,
</a><a href="#h62-0-82" id="h62-0-82" class="i">+                        references: None,
</a><a href="#h62-0-83" id="h62-0-83" class="i">+                        index: false,
</a><a href="#h62-0-84" id="h62-0-84" class="i">+                    },
</a><a href="#h62-0-85" id="h62-0-85" class="i">+                ],
</a><a href="#h62-0-86" id="h62-0-86" class="i">+            },
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h62-1" id="h62-1" class="h">@@ -73,7 +155,31 @@ Plan: Select(
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h62-1-3" id="h62-1-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h62-1-4" id="h62-1-4" class="i">+            table: Table {
</a><a href="#h62-1-5" id="h62-1-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h62-1-6" id="h62-1-6" class="i">+                columns: [
</a><a href="#h62-1-7" id="h62-1-7" class="i">+                    Column {
</a><a href="#h62-1-8" id="h62-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h62-1-9" id="h62-1-9" class="i">+                        datatype: Integer,
</a><a href="#h62-1-10" id="h62-1-10" class="i">+                        primary_key: true,
</a><a href="#h62-1-11" id="h62-1-11" class="i">+                        nullable: false,
</a><a href="#h62-1-12" id="h62-1-12" class="i">+                        default: None,
</a><a href="#h62-1-13" id="h62-1-13" class="i">+                        unique: true,
</a><a href="#h62-1-14" id="h62-1-14" class="i">+                        references: None,
</a><a href="#h62-1-15" id="h62-1-15" class="i">+                        index: false,
</a><a href="#h62-1-16" id="h62-1-16" class="i">+                    },
</a><a href="#h62-1-17" id="h62-1-17" class="i">+                    Column {
</a><a href="#h62-1-18" id="h62-1-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h62-1-19" id="h62-1-19" class="i">+                        datatype: String,
</a><a href="#h62-1-20" id="h62-1-20" class="i">+                        primary_key: false,
</a><a href="#h62-1-21" id="h62-1-21" class="i">+                        nullable: false,
</a><a href="#h62-1-22" id="h62-1-22" class="i">+                        default: None,
</a><a href="#h62-1-23" id="h62-1-23" class="i">+                        unique: false,
</a><a href="#h62-1-24" id="h62-1-24" class="i">+                        references: None,
</a><a href="#h62-1-25" id="h62-1-25" class="i">+                        index: false,
</a><a href="#h62-1-26" id="h62-1-26" class="i">+                    },
</a><a href="#h62-1-27" id="h62-1-27" class="i">+                ],
</a><a href="#h62-1-28" id="h62-1-28" class="i">+            },
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<a href="#h62-2" id="h62-2" class="h">@@ -112,7 +218,89 @@ Plan: Select(
</a> Optimized plan: Select(
     HashJoin {
         left: Scan {
<a href="#h62-2-3" id="h62-2-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h62-2-4" id="h62-2-4" class="i">+            table: Table {
</a><a href="#h62-2-5" id="h62-2-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h62-2-6" id="h62-2-6" class="i">+                columns: [
</a><a href="#h62-2-7" id="h62-2-7" class="i">+                    Column {
</a><a href="#h62-2-8" id="h62-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h62-2-9" id="h62-2-9" class="i">+                        datatype: Integer,
</a><a href="#h62-2-10" id="h62-2-10" class="i">+                        primary_key: true,
</a><a href="#h62-2-11" id="h62-2-11" class="i">+                        nullable: false,
</a><a href="#h62-2-12" id="h62-2-12" class="i">+                        default: None,
</a><a href="#h62-2-13" id="h62-2-13" class="i">+                        unique: true,
</a><a href="#h62-2-14" id="h62-2-14" class="i">+                        references: None,
</a><a href="#h62-2-15" id="h62-2-15" class="i">+                        index: false,
</a><a href="#h62-2-16" id="h62-2-16" class="i">+                    },
</a><a href="#h62-2-17" id="h62-2-17" class="i">+                    Column {
</a><a href="#h62-2-18" id="h62-2-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h62-2-19" id="h62-2-19" class="i">+                        datatype: String,
</a><a href="#h62-2-20" id="h62-2-20" class="i">+                        primary_key: false,
</a><a href="#h62-2-21" id="h62-2-21" class="i">+                        nullable: false,
</a><a href="#h62-2-22" id="h62-2-22" class="i">+                        default: None,
</a><a href="#h62-2-23" id="h62-2-23" class="i">+                        unique: false,
</a><a href="#h62-2-24" id="h62-2-24" class="i">+                        references: None,
</a><a href="#h62-2-25" id="h62-2-25" class="i">+                        index: false,
</a><a href="#h62-2-26" id="h62-2-26" class="i">+                    },
</a><a href="#h62-2-27" id="h62-2-27" class="i">+                    Column {
</a><a href="#h62-2-28" id="h62-2-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h62-2-29" id="h62-2-29" class="i">+                        datatype: Integer,
</a><a href="#h62-2-30" id="h62-2-30" class="i">+                        primary_key: false,
</a><a href="#h62-2-31" id="h62-2-31" class="i">+                        nullable: false,
</a><a href="#h62-2-32" id="h62-2-32" class="i">+                        default: None,
</a><a href="#h62-2-33" id="h62-2-33" class="i">+                        unique: false,
</a><a href="#h62-2-34" id="h62-2-34" class="i">+                        references: Some(
</a><a href="#h62-2-35" id="h62-2-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h62-2-36" id="h62-2-36" class="i">+                        ),
</a><a href="#h62-2-37" id="h62-2-37" class="i">+                        index: true,
</a><a href="#h62-2-38" id="h62-2-38" class="i">+                    },
</a><a href="#h62-2-39" id="h62-2-39" class="i">+                    Column {
</a><a href="#h62-2-40" id="h62-2-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h62-2-41" id="h62-2-41" class="i">+                        datatype: Integer,
</a><a href="#h62-2-42" id="h62-2-42" class="i">+                        primary_key: false,
</a><a href="#h62-2-43" id="h62-2-43" class="i">+                        nullable: false,
</a><a href="#h62-2-44" id="h62-2-44" class="i">+                        default: None,
</a><a href="#h62-2-45" id="h62-2-45" class="i">+                        unique: false,
</a><a href="#h62-2-46" id="h62-2-46" class="i">+                        references: Some(
</a><a href="#h62-2-47" id="h62-2-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h62-2-48" id="h62-2-48" class="i">+                        ),
</a><a href="#h62-2-49" id="h62-2-49" class="i">+                        index: true,
</a><a href="#h62-2-50" id="h62-2-50" class="i">+                    },
</a><a href="#h62-2-51" id="h62-2-51" class="i">+                    Column {
</a><a href="#h62-2-52" id="h62-2-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h62-2-53" id="h62-2-53" class="i">+                        datatype: Integer,
</a><a href="#h62-2-54" id="h62-2-54" class="i">+                        primary_key: false,
</a><a href="#h62-2-55" id="h62-2-55" class="i">+                        nullable: false,
</a><a href="#h62-2-56" id="h62-2-56" class="i">+                        default: None,
</a><a href="#h62-2-57" id="h62-2-57" class="i">+                        unique: false,
</a><a href="#h62-2-58" id="h62-2-58" class="i">+                        references: None,
</a><a href="#h62-2-59" id="h62-2-59" class="i">+                        index: false,
</a><a href="#h62-2-60" id="h62-2-60" class="i">+                    },
</a><a href="#h62-2-61" id="h62-2-61" class="i">+                    Column {
</a><a href="#h62-2-62" id="h62-2-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h62-2-63" id="h62-2-63" class="i">+                        datatype: Float,
</a><a href="#h62-2-64" id="h62-2-64" class="i">+                        primary_key: false,
</a><a href="#h62-2-65" id="h62-2-65" class="i">+                        nullable: true,
</a><a href="#h62-2-66" id="h62-2-66" class="i">+                        default: Some(
</a><a href="#h62-2-67" id="h62-2-67" class="i">+                            Null,
</a><a href="#h62-2-68" id="h62-2-68" class="i">+                        ),
</a><a href="#h62-2-69" id="h62-2-69" class="i">+                        unique: false,
</a><a href="#h62-2-70" id="h62-2-70" class="i">+                        references: None,
</a><a href="#h62-2-71" id="h62-2-71" class="i">+                        index: false,
</a><a href="#h62-2-72" id="h62-2-72" class="i">+                    },
</a><a href="#h62-2-73" id="h62-2-73" class="i">+                    Column {
</a><a href="#h62-2-74" id="h62-2-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h62-2-75" id="h62-2-75" class="i">+                        datatype: Boolean,
</a><a href="#h62-2-76" id="h62-2-76" class="i">+                        primary_key: false,
</a><a href="#h62-2-77" id="h62-2-77" class="i">+                        nullable: true,
</a><a href="#h62-2-78" id="h62-2-78" class="i">+                        default: Some(
</a><a href="#h62-2-79" id="h62-2-79" class="i">+                            Null,
</a><a href="#h62-2-80" id="h62-2-80" class="i">+                        ),
</a><a href="#h62-2-81" id="h62-2-81" class="i">+                        unique: false,
</a><a href="#h62-2-82" id="h62-2-82" class="i">+                        references: None,
</a><a href="#h62-2-83" id="h62-2-83" class="i">+                        index: false,
</a><a href="#h62-2-84" id="h62-2-84" class="i">+                    },
</a><a href="#h62-2-85" id="h62-2-85" class="i">+                ],
</a><a href="#h62-2-86" id="h62-2-86" class="i">+            },
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h62-3" id="h62-3" class="h">@@ -130,7 +318,31 @@ Optimized plan: Select(
</a>             ),
         ),
         right: Scan {
<a href="#h62-3-3" id="h62-3-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h62-3-4" id="h62-3-4" class="i">+            table: Table {
</a><a href="#h62-3-5" id="h62-3-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h62-3-6" id="h62-3-6" class="i">+                columns: [
</a><a href="#h62-3-7" id="h62-3-7" class="i">+                    Column {
</a><a href="#h62-3-8" id="h62-3-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h62-3-9" id="h62-3-9" class="i">+                        datatype: Integer,
</a><a href="#h62-3-10" id="h62-3-10" class="i">+                        primary_key: true,
</a><a href="#h62-3-11" id="h62-3-11" class="i">+                        nullable: false,
</a><a href="#h62-3-12" id="h62-3-12" class="i">+                        default: None,
</a><a href="#h62-3-13" id="h62-3-13" class="i">+                        unique: true,
</a><a href="#h62-3-14" id="h62-3-14" class="i">+                        references: None,
</a><a href="#h62-3-15" id="h62-3-15" class="i">+                        index: false,
</a><a href="#h62-3-16" id="h62-3-16" class="i">+                    },
</a><a href="#h62-3-17" id="h62-3-17" class="i">+                    Column {
</a><a href="#h62-3-18" id="h62-3-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h62-3-19" id="h62-3-19" class="i">+                        datatype: String,
</a><a href="#h62-3-20" id="h62-3-20" class="i">+                        primary_key: false,
</a><a href="#h62-3-21" id="h62-3-21" class="i">+                        nullable: false,
</a><a href="#h62-3-22" id="h62-3-22" class="i">+                        default: None,
</a><a href="#h62-3-23" id="h62-3-23" class="i">+                        unique: false,
</a><a href="#h62-3-24" id="h62-3-24" class="i">+                        references: None,
</a><a href="#h62-3-25" id="h62-3-25" class="i">+                        index: false,
</a><a href="#h62-3-26" id="h62-3-26" class="i">+                    },
</a><a href="#h62-3-27" id="h62-3-27" class="i">+                ],
</a><a href="#h62-3-28" id="h62-3-28" class="i">+            },
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<b>diff --git a/<a id="h63" href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a> b/<a href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -40,13 +40,119 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h63-0-3" id="h63-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h63-0-4" id="h63-0-4" class="i">+            table: Table {
</a><a href="#h63-0-5" id="h63-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h63-0-6" id="h63-0-6" class="i">+                columns: [
</a><a href="#h63-0-7" id="h63-0-7" class="i">+                    Column {
</a><a href="#h63-0-8" id="h63-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h63-0-9" id="h63-0-9" class="i">+                        datatype: Integer,
</a><a href="#h63-0-10" id="h63-0-10" class="i">+                        primary_key: true,
</a><a href="#h63-0-11" id="h63-0-11" class="i">+                        nullable: false,
</a><a href="#h63-0-12" id="h63-0-12" class="i">+                        default: None,
</a><a href="#h63-0-13" id="h63-0-13" class="i">+                        unique: true,
</a><a href="#h63-0-14" id="h63-0-14" class="i">+                        references: None,
</a><a href="#h63-0-15" id="h63-0-15" class="i">+                        index: false,
</a><a href="#h63-0-16" id="h63-0-16" class="i">+                    },
</a><a href="#h63-0-17" id="h63-0-17" class="i">+                    Column {
</a><a href="#h63-0-18" id="h63-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h63-0-19" id="h63-0-19" class="i">+                        datatype: String,
</a><a href="#h63-0-20" id="h63-0-20" class="i">+                        primary_key: false,
</a><a href="#h63-0-21" id="h63-0-21" class="i">+                        nullable: false,
</a><a href="#h63-0-22" id="h63-0-22" class="i">+                        default: None,
</a><a href="#h63-0-23" id="h63-0-23" class="i">+                        unique: false,
</a><a href="#h63-0-24" id="h63-0-24" class="i">+                        references: None,
</a><a href="#h63-0-25" id="h63-0-25" class="i">+                        index: false,
</a><a href="#h63-0-26" id="h63-0-26" class="i">+                    },
</a><a href="#h63-0-27" id="h63-0-27" class="i">+                    Column {
</a><a href="#h63-0-28" id="h63-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h63-0-29" id="h63-0-29" class="i">+                        datatype: Integer,
</a><a href="#h63-0-30" id="h63-0-30" class="i">+                        primary_key: false,
</a><a href="#h63-0-31" id="h63-0-31" class="i">+                        nullable: false,
</a><a href="#h63-0-32" id="h63-0-32" class="i">+                        default: None,
</a><a href="#h63-0-33" id="h63-0-33" class="i">+                        unique: false,
</a><a href="#h63-0-34" id="h63-0-34" class="i">+                        references: Some(
</a><a href="#h63-0-35" id="h63-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h63-0-36" id="h63-0-36" class="i">+                        ),
</a><a href="#h63-0-37" id="h63-0-37" class="i">+                        index: true,
</a><a href="#h63-0-38" id="h63-0-38" class="i">+                    },
</a><a href="#h63-0-39" id="h63-0-39" class="i">+                    Column {
</a><a href="#h63-0-40" id="h63-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h63-0-41" id="h63-0-41" class="i">+                        datatype: Integer,
</a><a href="#h63-0-42" id="h63-0-42" class="i">+                        primary_key: false,
</a><a href="#h63-0-43" id="h63-0-43" class="i">+                        nullable: false,
</a><a href="#h63-0-44" id="h63-0-44" class="i">+                        default: None,
</a><a href="#h63-0-45" id="h63-0-45" class="i">+                        unique: false,
</a><a href="#h63-0-46" id="h63-0-46" class="i">+                        references: Some(
</a><a href="#h63-0-47" id="h63-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h63-0-48" id="h63-0-48" class="i">+                        ),
</a><a href="#h63-0-49" id="h63-0-49" class="i">+                        index: true,
</a><a href="#h63-0-50" id="h63-0-50" class="i">+                    },
</a><a href="#h63-0-51" id="h63-0-51" class="i">+                    Column {
</a><a href="#h63-0-52" id="h63-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h63-0-53" id="h63-0-53" class="i">+                        datatype: Integer,
</a><a href="#h63-0-54" id="h63-0-54" class="i">+                        primary_key: false,
</a><a href="#h63-0-55" id="h63-0-55" class="i">+                        nullable: false,
</a><a href="#h63-0-56" id="h63-0-56" class="i">+                        default: None,
</a><a href="#h63-0-57" id="h63-0-57" class="i">+                        unique: false,
</a><a href="#h63-0-58" id="h63-0-58" class="i">+                        references: None,
</a><a href="#h63-0-59" id="h63-0-59" class="i">+                        index: false,
</a><a href="#h63-0-60" id="h63-0-60" class="i">+                    },
</a><a href="#h63-0-61" id="h63-0-61" class="i">+                    Column {
</a><a href="#h63-0-62" id="h63-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h63-0-63" id="h63-0-63" class="i">+                        datatype: Float,
</a><a href="#h63-0-64" id="h63-0-64" class="i">+                        primary_key: false,
</a><a href="#h63-0-65" id="h63-0-65" class="i">+                        nullable: true,
</a><a href="#h63-0-66" id="h63-0-66" class="i">+                        default: Some(
</a><a href="#h63-0-67" id="h63-0-67" class="i">+                            Null,
</a><a href="#h63-0-68" id="h63-0-68" class="i">+                        ),
</a><a href="#h63-0-69" id="h63-0-69" class="i">+                        unique: false,
</a><a href="#h63-0-70" id="h63-0-70" class="i">+                        references: None,
</a><a href="#h63-0-71" id="h63-0-71" class="i">+                        index: false,
</a><a href="#h63-0-72" id="h63-0-72" class="i">+                    },
</a><a href="#h63-0-73" id="h63-0-73" class="i">+                    Column {
</a><a href="#h63-0-74" id="h63-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h63-0-75" id="h63-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h63-0-76" id="h63-0-76" class="i">+                        primary_key: false,
</a><a href="#h63-0-77" id="h63-0-77" class="i">+                        nullable: true,
</a><a href="#h63-0-78" id="h63-0-78" class="i">+                        default: Some(
</a><a href="#h63-0-79" id="h63-0-79" class="i">+                            Null,
</a><a href="#h63-0-80" id="h63-0-80" class="i">+                        ),
</a><a href="#h63-0-81" id="h63-0-81" class="i">+                        unique: false,
</a><a href="#h63-0-82" id="h63-0-82" class="i">+                        references: None,
</a><a href="#h63-0-83" id="h63-0-83" class="i">+                        index: false,
</a><a href="#h63-0-84" id="h63-0-84" class="i">+                    },
</a><a href="#h63-0-85" id="h63-0-85" class="i">+                ],
</a><a href="#h63-0-86" id="h63-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
         left_size: 7,
         right: Scan {
<a href="#h63-0-92" id="h63-0-92" class="d">-            table: &quot;genres&quot;,
</a><a href="#h63-0-93" id="h63-0-93" class="i">+            table: Table {
</a><a href="#h63-0-94" id="h63-0-94" class="i">+                name: &quot;genres&quot;,
</a><a href="#h63-0-95" id="h63-0-95" class="i">+                columns: [
</a><a href="#h63-0-96" id="h63-0-96" class="i">+                    Column {
</a><a href="#h63-0-97" id="h63-0-97" class="i">+                        name: &quot;id&quot;,
</a><a href="#h63-0-98" id="h63-0-98" class="i">+                        datatype: Integer,
</a><a href="#h63-0-99" id="h63-0-99" class="i">+                        primary_key: true,
</a><a href="#h63-0-100" id="h63-0-100" class="i">+                        nullable: false,
</a><a href="#h63-0-101" id="h63-0-101" class="i">+                        default: None,
</a><a href="#h63-0-102" id="h63-0-102" class="i">+                        unique: true,
</a><a href="#h63-0-103" id="h63-0-103" class="i">+                        references: None,
</a><a href="#h63-0-104" id="h63-0-104" class="i">+                        index: false,
</a><a href="#h63-0-105" id="h63-0-105" class="i">+                    },
</a><a href="#h63-0-106" id="h63-0-106" class="i">+                    Column {
</a><a href="#h63-0-107" id="h63-0-107" class="i">+                        name: &quot;name&quot;,
</a><a href="#h63-0-108" id="h63-0-108" class="i">+                        datatype: String,
</a><a href="#h63-0-109" id="h63-0-109" class="i">+                        primary_key: false,
</a><a href="#h63-0-110" id="h63-0-110" class="i">+                        nullable: false,
</a><a href="#h63-0-111" id="h63-0-111" class="i">+                        default: None,
</a><a href="#h63-0-112" id="h63-0-112" class="i">+                        unique: false,
</a><a href="#h63-0-113" id="h63-0-113" class="i">+                        references: None,
</a><a href="#h63-0-114" id="h63-0-114" class="i">+                        index: false,
</a><a href="#h63-0-115" id="h63-0-115" class="i">+                    },
</a><a href="#h63-0-116" id="h63-0-116" class="i">+                ],
</a><a href="#h63-0-117" id="h63-0-117" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h63-1" id="h63-1" class="h">@@ -64,7 +170,89 @@ Plan: Select(
</a> Optimized plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h63-1-3" id="h63-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h63-1-4" id="h63-1-4" class="i">+            table: Table {
</a><a href="#h63-1-5" id="h63-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h63-1-6" id="h63-1-6" class="i">+                columns: [
</a><a href="#h63-1-7" id="h63-1-7" class="i">+                    Column {
</a><a href="#h63-1-8" id="h63-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h63-1-9" id="h63-1-9" class="i">+                        datatype: Integer,
</a><a href="#h63-1-10" id="h63-1-10" class="i">+                        primary_key: true,
</a><a href="#h63-1-11" id="h63-1-11" class="i">+                        nullable: false,
</a><a href="#h63-1-12" id="h63-1-12" class="i">+                        default: None,
</a><a href="#h63-1-13" id="h63-1-13" class="i">+                        unique: true,
</a><a href="#h63-1-14" id="h63-1-14" class="i">+                        references: None,
</a><a href="#h63-1-15" id="h63-1-15" class="i">+                        index: false,
</a><a href="#h63-1-16" id="h63-1-16" class="i">+                    },
</a><a href="#h63-1-17" id="h63-1-17" class="i">+                    Column {
</a><a href="#h63-1-18" id="h63-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h63-1-19" id="h63-1-19" class="i">+                        datatype: String,
</a><a href="#h63-1-20" id="h63-1-20" class="i">+                        primary_key: false,
</a><a href="#h63-1-21" id="h63-1-21" class="i">+                        nullable: false,
</a><a href="#h63-1-22" id="h63-1-22" class="i">+                        default: None,
</a><a href="#h63-1-23" id="h63-1-23" class="i">+                        unique: false,
</a><a href="#h63-1-24" id="h63-1-24" class="i">+                        references: None,
</a><a href="#h63-1-25" id="h63-1-25" class="i">+                        index: false,
</a><a href="#h63-1-26" id="h63-1-26" class="i">+                    },
</a><a href="#h63-1-27" id="h63-1-27" class="i">+                    Column {
</a><a href="#h63-1-28" id="h63-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h63-1-29" id="h63-1-29" class="i">+                        datatype: Integer,
</a><a href="#h63-1-30" id="h63-1-30" class="i">+                        primary_key: false,
</a><a href="#h63-1-31" id="h63-1-31" class="i">+                        nullable: false,
</a><a href="#h63-1-32" id="h63-1-32" class="i">+                        default: None,
</a><a href="#h63-1-33" id="h63-1-33" class="i">+                        unique: false,
</a><a href="#h63-1-34" id="h63-1-34" class="i">+                        references: Some(
</a><a href="#h63-1-35" id="h63-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h63-1-36" id="h63-1-36" class="i">+                        ),
</a><a href="#h63-1-37" id="h63-1-37" class="i">+                        index: true,
</a><a href="#h63-1-38" id="h63-1-38" class="i">+                    },
</a><a href="#h63-1-39" id="h63-1-39" class="i">+                    Column {
</a><a href="#h63-1-40" id="h63-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h63-1-41" id="h63-1-41" class="i">+                        datatype: Integer,
</a><a href="#h63-1-42" id="h63-1-42" class="i">+                        primary_key: false,
</a><a href="#h63-1-43" id="h63-1-43" class="i">+                        nullable: false,
</a><a href="#h63-1-44" id="h63-1-44" class="i">+                        default: None,
</a><a href="#h63-1-45" id="h63-1-45" class="i">+                        unique: false,
</a><a href="#h63-1-46" id="h63-1-46" class="i">+                        references: Some(
</a><a href="#h63-1-47" id="h63-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h63-1-48" id="h63-1-48" class="i">+                        ),
</a><a href="#h63-1-49" id="h63-1-49" class="i">+                        index: true,
</a><a href="#h63-1-50" id="h63-1-50" class="i">+                    },
</a><a href="#h63-1-51" id="h63-1-51" class="i">+                    Column {
</a><a href="#h63-1-52" id="h63-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h63-1-53" id="h63-1-53" class="i">+                        datatype: Integer,
</a><a href="#h63-1-54" id="h63-1-54" class="i">+                        primary_key: false,
</a><a href="#h63-1-55" id="h63-1-55" class="i">+                        nullable: false,
</a><a href="#h63-1-56" id="h63-1-56" class="i">+                        default: None,
</a><a href="#h63-1-57" id="h63-1-57" class="i">+                        unique: false,
</a><a href="#h63-1-58" id="h63-1-58" class="i">+                        references: None,
</a><a href="#h63-1-59" id="h63-1-59" class="i">+                        index: false,
</a><a href="#h63-1-60" id="h63-1-60" class="i">+                    },
</a><a href="#h63-1-61" id="h63-1-61" class="i">+                    Column {
</a><a href="#h63-1-62" id="h63-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h63-1-63" id="h63-1-63" class="i">+                        datatype: Float,
</a><a href="#h63-1-64" id="h63-1-64" class="i">+                        primary_key: false,
</a><a href="#h63-1-65" id="h63-1-65" class="i">+                        nullable: true,
</a><a href="#h63-1-66" id="h63-1-66" class="i">+                        default: Some(
</a><a href="#h63-1-67" id="h63-1-67" class="i">+                            Null,
</a><a href="#h63-1-68" id="h63-1-68" class="i">+                        ),
</a><a href="#h63-1-69" id="h63-1-69" class="i">+                        unique: false,
</a><a href="#h63-1-70" id="h63-1-70" class="i">+                        references: None,
</a><a href="#h63-1-71" id="h63-1-71" class="i">+                        index: false,
</a><a href="#h63-1-72" id="h63-1-72" class="i">+                    },
</a><a href="#h63-1-73" id="h63-1-73" class="i">+                    Column {
</a><a href="#h63-1-74" id="h63-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h63-1-75" id="h63-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h63-1-76" id="h63-1-76" class="i">+                        primary_key: false,
</a><a href="#h63-1-77" id="h63-1-77" class="i">+                        nullable: true,
</a><a href="#h63-1-78" id="h63-1-78" class="i">+                        default: Some(
</a><a href="#h63-1-79" id="h63-1-79" class="i">+                            Null,
</a><a href="#h63-1-80" id="h63-1-80" class="i">+                        ),
</a><a href="#h63-1-81" id="h63-1-81" class="i">+                        unique: false,
</a><a href="#h63-1-82" id="h63-1-82" class="i">+                        references: None,
</a><a href="#h63-1-83" id="h63-1-83" class="i">+                        index: false,
</a><a href="#h63-1-84" id="h63-1-84" class="i">+                    },
</a><a href="#h63-1-85" id="h63-1-85" class="i">+                ],
</a><a href="#h63-1-86" id="h63-1-86" class="i">+            },
</a>             alias: None,
             filter: Some(
                 Constant(
<a href="#h63-2" id="h63-2" class="h">@@ -76,7 +264,31 @@ Optimized plan: Select(
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h63-2-3" id="h63-2-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h63-2-4" id="h63-2-4" class="i">+            table: Table {
</a><a href="#h63-2-5" id="h63-2-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h63-2-6" id="h63-2-6" class="i">+                columns: [
</a><a href="#h63-2-7" id="h63-2-7" class="i">+                    Column {
</a><a href="#h63-2-8" id="h63-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h63-2-9" id="h63-2-9" class="i">+                        datatype: Integer,
</a><a href="#h63-2-10" id="h63-2-10" class="i">+                        primary_key: true,
</a><a href="#h63-2-11" id="h63-2-11" class="i">+                        nullable: false,
</a><a href="#h63-2-12" id="h63-2-12" class="i">+                        default: None,
</a><a href="#h63-2-13" id="h63-2-13" class="i">+                        unique: true,
</a><a href="#h63-2-14" id="h63-2-14" class="i">+                        references: None,
</a><a href="#h63-2-15" id="h63-2-15" class="i">+                        index: false,
</a><a href="#h63-2-16" id="h63-2-16" class="i">+                    },
</a><a href="#h63-2-17" id="h63-2-17" class="i">+                    Column {
</a><a href="#h63-2-18" id="h63-2-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h63-2-19" id="h63-2-19" class="i">+                        datatype: String,
</a><a href="#h63-2-20" id="h63-2-20" class="i">+                        primary_key: false,
</a><a href="#h63-2-21" id="h63-2-21" class="i">+                        nullable: false,
</a><a href="#h63-2-22" id="h63-2-22" class="i">+                        default: None,
</a><a href="#h63-2-23" id="h63-2-23" class="i">+                        unique: false,
</a><a href="#h63-2-24" id="h63-2-24" class="i">+                        references: None,
</a><a href="#h63-2-25" id="h63-2-25" class="i">+                        index: false,
</a><a href="#h63-2-26" id="h63-2-26" class="i">+                    },
</a><a href="#h63-2-27" id="h63-2-27" class="i">+                ],
</a><a href="#h63-2-28" id="h63-2-28" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h64" href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a> b/<a href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -73,13 +73,119 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h64-0-3" id="h64-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h64-0-4" id="h64-0-4" class="i">+            table: Table {
</a><a href="#h64-0-5" id="h64-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h64-0-6" id="h64-0-6" class="i">+                columns: [
</a><a href="#h64-0-7" id="h64-0-7" class="i">+                    Column {
</a><a href="#h64-0-8" id="h64-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h64-0-9" id="h64-0-9" class="i">+                        datatype: Integer,
</a><a href="#h64-0-10" id="h64-0-10" class="i">+                        primary_key: true,
</a><a href="#h64-0-11" id="h64-0-11" class="i">+                        nullable: false,
</a><a href="#h64-0-12" id="h64-0-12" class="i">+                        default: None,
</a><a href="#h64-0-13" id="h64-0-13" class="i">+                        unique: true,
</a><a href="#h64-0-14" id="h64-0-14" class="i">+                        references: None,
</a><a href="#h64-0-15" id="h64-0-15" class="i">+                        index: false,
</a><a href="#h64-0-16" id="h64-0-16" class="i">+                    },
</a><a href="#h64-0-17" id="h64-0-17" class="i">+                    Column {
</a><a href="#h64-0-18" id="h64-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h64-0-19" id="h64-0-19" class="i">+                        datatype: String,
</a><a href="#h64-0-20" id="h64-0-20" class="i">+                        primary_key: false,
</a><a href="#h64-0-21" id="h64-0-21" class="i">+                        nullable: false,
</a><a href="#h64-0-22" id="h64-0-22" class="i">+                        default: None,
</a><a href="#h64-0-23" id="h64-0-23" class="i">+                        unique: false,
</a><a href="#h64-0-24" id="h64-0-24" class="i">+                        references: None,
</a><a href="#h64-0-25" id="h64-0-25" class="i">+                        index: false,
</a><a href="#h64-0-26" id="h64-0-26" class="i">+                    },
</a><a href="#h64-0-27" id="h64-0-27" class="i">+                    Column {
</a><a href="#h64-0-28" id="h64-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h64-0-29" id="h64-0-29" class="i">+                        datatype: Integer,
</a><a href="#h64-0-30" id="h64-0-30" class="i">+                        primary_key: false,
</a><a href="#h64-0-31" id="h64-0-31" class="i">+                        nullable: false,
</a><a href="#h64-0-32" id="h64-0-32" class="i">+                        default: None,
</a><a href="#h64-0-33" id="h64-0-33" class="i">+                        unique: false,
</a><a href="#h64-0-34" id="h64-0-34" class="i">+                        references: Some(
</a><a href="#h64-0-35" id="h64-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h64-0-36" id="h64-0-36" class="i">+                        ),
</a><a href="#h64-0-37" id="h64-0-37" class="i">+                        index: true,
</a><a href="#h64-0-38" id="h64-0-38" class="i">+                    },
</a><a href="#h64-0-39" id="h64-0-39" class="i">+                    Column {
</a><a href="#h64-0-40" id="h64-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h64-0-41" id="h64-0-41" class="i">+                        datatype: Integer,
</a><a href="#h64-0-42" id="h64-0-42" class="i">+                        primary_key: false,
</a><a href="#h64-0-43" id="h64-0-43" class="i">+                        nullable: false,
</a><a href="#h64-0-44" id="h64-0-44" class="i">+                        default: None,
</a><a href="#h64-0-45" id="h64-0-45" class="i">+                        unique: false,
</a><a href="#h64-0-46" id="h64-0-46" class="i">+                        references: Some(
</a><a href="#h64-0-47" id="h64-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h64-0-48" id="h64-0-48" class="i">+                        ),
</a><a href="#h64-0-49" id="h64-0-49" class="i">+                        index: true,
</a><a href="#h64-0-50" id="h64-0-50" class="i">+                    },
</a><a href="#h64-0-51" id="h64-0-51" class="i">+                    Column {
</a><a href="#h64-0-52" id="h64-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h64-0-53" id="h64-0-53" class="i">+                        datatype: Integer,
</a><a href="#h64-0-54" id="h64-0-54" class="i">+                        primary_key: false,
</a><a href="#h64-0-55" id="h64-0-55" class="i">+                        nullable: false,
</a><a href="#h64-0-56" id="h64-0-56" class="i">+                        default: None,
</a><a href="#h64-0-57" id="h64-0-57" class="i">+                        unique: false,
</a><a href="#h64-0-58" id="h64-0-58" class="i">+                        references: None,
</a><a href="#h64-0-59" id="h64-0-59" class="i">+                        index: false,
</a><a href="#h64-0-60" id="h64-0-60" class="i">+                    },
</a><a href="#h64-0-61" id="h64-0-61" class="i">+                    Column {
</a><a href="#h64-0-62" id="h64-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h64-0-63" id="h64-0-63" class="i">+                        datatype: Float,
</a><a href="#h64-0-64" id="h64-0-64" class="i">+                        primary_key: false,
</a><a href="#h64-0-65" id="h64-0-65" class="i">+                        nullable: true,
</a><a href="#h64-0-66" id="h64-0-66" class="i">+                        default: Some(
</a><a href="#h64-0-67" id="h64-0-67" class="i">+                            Null,
</a><a href="#h64-0-68" id="h64-0-68" class="i">+                        ),
</a><a href="#h64-0-69" id="h64-0-69" class="i">+                        unique: false,
</a><a href="#h64-0-70" id="h64-0-70" class="i">+                        references: None,
</a><a href="#h64-0-71" id="h64-0-71" class="i">+                        index: false,
</a><a href="#h64-0-72" id="h64-0-72" class="i">+                    },
</a><a href="#h64-0-73" id="h64-0-73" class="i">+                    Column {
</a><a href="#h64-0-74" id="h64-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h64-0-75" id="h64-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h64-0-76" id="h64-0-76" class="i">+                        primary_key: false,
</a><a href="#h64-0-77" id="h64-0-77" class="i">+                        nullable: true,
</a><a href="#h64-0-78" id="h64-0-78" class="i">+                        default: Some(
</a><a href="#h64-0-79" id="h64-0-79" class="i">+                            Null,
</a><a href="#h64-0-80" id="h64-0-80" class="i">+                        ),
</a><a href="#h64-0-81" id="h64-0-81" class="i">+                        unique: false,
</a><a href="#h64-0-82" id="h64-0-82" class="i">+                        references: None,
</a><a href="#h64-0-83" id="h64-0-83" class="i">+                        index: false,
</a><a href="#h64-0-84" id="h64-0-84" class="i">+                    },
</a><a href="#h64-0-85" id="h64-0-85" class="i">+                ],
</a><a href="#h64-0-86" id="h64-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
         left_size: 7,
         right: Scan {
<a href="#h64-0-92" id="h64-0-92" class="d">-            table: &quot;genres&quot;,
</a><a href="#h64-0-93" id="h64-0-93" class="i">+            table: Table {
</a><a href="#h64-0-94" id="h64-0-94" class="i">+                name: &quot;genres&quot;,
</a><a href="#h64-0-95" id="h64-0-95" class="i">+                columns: [
</a><a href="#h64-0-96" id="h64-0-96" class="i">+                    Column {
</a><a href="#h64-0-97" id="h64-0-97" class="i">+                        name: &quot;id&quot;,
</a><a href="#h64-0-98" id="h64-0-98" class="i">+                        datatype: Integer,
</a><a href="#h64-0-99" id="h64-0-99" class="i">+                        primary_key: true,
</a><a href="#h64-0-100" id="h64-0-100" class="i">+                        nullable: false,
</a><a href="#h64-0-101" id="h64-0-101" class="i">+                        default: None,
</a><a href="#h64-0-102" id="h64-0-102" class="i">+                        unique: true,
</a><a href="#h64-0-103" id="h64-0-103" class="i">+                        references: None,
</a><a href="#h64-0-104" id="h64-0-104" class="i">+                        index: false,
</a><a href="#h64-0-105" id="h64-0-105" class="i">+                    },
</a><a href="#h64-0-106" id="h64-0-106" class="i">+                    Column {
</a><a href="#h64-0-107" id="h64-0-107" class="i">+                        name: &quot;name&quot;,
</a><a href="#h64-0-108" id="h64-0-108" class="i">+                        datatype: String,
</a><a href="#h64-0-109" id="h64-0-109" class="i">+                        primary_key: false,
</a><a href="#h64-0-110" id="h64-0-110" class="i">+                        nullable: false,
</a><a href="#h64-0-111" id="h64-0-111" class="i">+                        default: None,
</a><a href="#h64-0-112" id="h64-0-112" class="i">+                        unique: false,
</a><a href="#h64-0-113" id="h64-0-113" class="i">+                        references: None,
</a><a href="#h64-0-114" id="h64-0-114" class="i">+                        index: false,
</a><a href="#h64-0-115" id="h64-0-115" class="i">+                    },
</a><a href="#h64-0-116" id="h64-0-116" class="i">+                ],
</a><a href="#h64-0-117" id="h64-0-117" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h64-1" id="h64-1" class="h">@@ -142,13 +248,119 @@ Plan: Select(
</a> Optimized plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h64-1-3" id="h64-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h64-1-4" id="h64-1-4" class="i">+            table: Table {
</a><a href="#h64-1-5" id="h64-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h64-1-6" id="h64-1-6" class="i">+                columns: [
</a><a href="#h64-1-7" id="h64-1-7" class="i">+                    Column {
</a><a href="#h64-1-8" id="h64-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h64-1-9" id="h64-1-9" class="i">+                        datatype: Integer,
</a><a href="#h64-1-10" id="h64-1-10" class="i">+                        primary_key: true,
</a><a href="#h64-1-11" id="h64-1-11" class="i">+                        nullable: false,
</a><a href="#h64-1-12" id="h64-1-12" class="i">+                        default: None,
</a><a href="#h64-1-13" id="h64-1-13" class="i">+                        unique: true,
</a><a href="#h64-1-14" id="h64-1-14" class="i">+                        references: None,
</a><a href="#h64-1-15" id="h64-1-15" class="i">+                        index: false,
</a><a href="#h64-1-16" id="h64-1-16" class="i">+                    },
</a><a href="#h64-1-17" id="h64-1-17" class="i">+                    Column {
</a><a href="#h64-1-18" id="h64-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h64-1-19" id="h64-1-19" class="i">+                        datatype: String,
</a><a href="#h64-1-20" id="h64-1-20" class="i">+                        primary_key: false,
</a><a href="#h64-1-21" id="h64-1-21" class="i">+                        nullable: false,
</a><a href="#h64-1-22" id="h64-1-22" class="i">+                        default: None,
</a><a href="#h64-1-23" id="h64-1-23" class="i">+                        unique: false,
</a><a href="#h64-1-24" id="h64-1-24" class="i">+                        references: None,
</a><a href="#h64-1-25" id="h64-1-25" class="i">+                        index: false,
</a><a href="#h64-1-26" id="h64-1-26" class="i">+                    },
</a><a href="#h64-1-27" id="h64-1-27" class="i">+                    Column {
</a><a href="#h64-1-28" id="h64-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h64-1-29" id="h64-1-29" class="i">+                        datatype: Integer,
</a><a href="#h64-1-30" id="h64-1-30" class="i">+                        primary_key: false,
</a><a href="#h64-1-31" id="h64-1-31" class="i">+                        nullable: false,
</a><a href="#h64-1-32" id="h64-1-32" class="i">+                        default: None,
</a><a href="#h64-1-33" id="h64-1-33" class="i">+                        unique: false,
</a><a href="#h64-1-34" id="h64-1-34" class="i">+                        references: Some(
</a><a href="#h64-1-35" id="h64-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h64-1-36" id="h64-1-36" class="i">+                        ),
</a><a href="#h64-1-37" id="h64-1-37" class="i">+                        index: true,
</a><a href="#h64-1-38" id="h64-1-38" class="i">+                    },
</a><a href="#h64-1-39" id="h64-1-39" class="i">+                    Column {
</a><a href="#h64-1-40" id="h64-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h64-1-41" id="h64-1-41" class="i">+                        datatype: Integer,
</a><a href="#h64-1-42" id="h64-1-42" class="i">+                        primary_key: false,
</a><a href="#h64-1-43" id="h64-1-43" class="i">+                        nullable: false,
</a><a href="#h64-1-44" id="h64-1-44" class="i">+                        default: None,
</a><a href="#h64-1-45" id="h64-1-45" class="i">+                        unique: false,
</a><a href="#h64-1-46" id="h64-1-46" class="i">+                        references: Some(
</a><a href="#h64-1-47" id="h64-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h64-1-48" id="h64-1-48" class="i">+                        ),
</a><a href="#h64-1-49" id="h64-1-49" class="i">+                        index: true,
</a><a href="#h64-1-50" id="h64-1-50" class="i">+                    },
</a><a href="#h64-1-51" id="h64-1-51" class="i">+                    Column {
</a><a href="#h64-1-52" id="h64-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h64-1-53" id="h64-1-53" class="i">+                        datatype: Integer,
</a><a href="#h64-1-54" id="h64-1-54" class="i">+                        primary_key: false,
</a><a href="#h64-1-55" id="h64-1-55" class="i">+                        nullable: false,
</a><a href="#h64-1-56" id="h64-1-56" class="i">+                        default: None,
</a><a href="#h64-1-57" id="h64-1-57" class="i">+                        unique: false,
</a><a href="#h64-1-58" id="h64-1-58" class="i">+                        references: None,
</a><a href="#h64-1-59" id="h64-1-59" class="i">+                        index: false,
</a><a href="#h64-1-60" id="h64-1-60" class="i">+                    },
</a><a href="#h64-1-61" id="h64-1-61" class="i">+                    Column {
</a><a href="#h64-1-62" id="h64-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h64-1-63" id="h64-1-63" class="i">+                        datatype: Float,
</a><a href="#h64-1-64" id="h64-1-64" class="i">+                        primary_key: false,
</a><a href="#h64-1-65" id="h64-1-65" class="i">+                        nullable: true,
</a><a href="#h64-1-66" id="h64-1-66" class="i">+                        default: Some(
</a><a href="#h64-1-67" id="h64-1-67" class="i">+                            Null,
</a><a href="#h64-1-68" id="h64-1-68" class="i">+                        ),
</a><a href="#h64-1-69" id="h64-1-69" class="i">+                        unique: false,
</a><a href="#h64-1-70" id="h64-1-70" class="i">+                        references: None,
</a><a href="#h64-1-71" id="h64-1-71" class="i">+                        index: false,
</a><a href="#h64-1-72" id="h64-1-72" class="i">+                    },
</a><a href="#h64-1-73" id="h64-1-73" class="i">+                    Column {
</a><a href="#h64-1-74" id="h64-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h64-1-75" id="h64-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h64-1-76" id="h64-1-76" class="i">+                        primary_key: false,
</a><a href="#h64-1-77" id="h64-1-77" class="i">+                        nullable: true,
</a><a href="#h64-1-78" id="h64-1-78" class="i">+                        default: Some(
</a><a href="#h64-1-79" id="h64-1-79" class="i">+                            Null,
</a><a href="#h64-1-80" id="h64-1-80" class="i">+                        ),
</a><a href="#h64-1-81" id="h64-1-81" class="i">+                        unique: false,
</a><a href="#h64-1-82" id="h64-1-82" class="i">+                        references: None,
</a><a href="#h64-1-83" id="h64-1-83" class="i">+                        index: false,
</a><a href="#h64-1-84" id="h64-1-84" class="i">+                    },
</a><a href="#h64-1-85" id="h64-1-85" class="i">+                ],
</a><a href="#h64-1-86" id="h64-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
         left_size: 7,
         right: Scan {
<a href="#h64-1-92" id="h64-1-92" class="d">-            table: &quot;genres&quot;,
</a><a href="#h64-1-93" id="h64-1-93" class="i">+            table: Table {
</a><a href="#h64-1-94" id="h64-1-94" class="i">+                name: &quot;genres&quot;,
</a><a href="#h64-1-95" id="h64-1-95" class="i">+                columns: [
</a><a href="#h64-1-96" id="h64-1-96" class="i">+                    Column {
</a><a href="#h64-1-97" id="h64-1-97" class="i">+                        name: &quot;id&quot;,
</a><a href="#h64-1-98" id="h64-1-98" class="i">+                        datatype: Integer,
</a><a href="#h64-1-99" id="h64-1-99" class="i">+                        primary_key: true,
</a><a href="#h64-1-100" id="h64-1-100" class="i">+                        nullable: false,
</a><a href="#h64-1-101" id="h64-1-101" class="i">+                        default: None,
</a><a href="#h64-1-102" id="h64-1-102" class="i">+                        unique: true,
</a><a href="#h64-1-103" id="h64-1-103" class="i">+                        references: None,
</a><a href="#h64-1-104" id="h64-1-104" class="i">+                        index: false,
</a><a href="#h64-1-105" id="h64-1-105" class="i">+                    },
</a><a href="#h64-1-106" id="h64-1-106" class="i">+                    Column {
</a><a href="#h64-1-107" id="h64-1-107" class="i">+                        name: &quot;name&quot;,
</a><a href="#h64-1-108" id="h64-1-108" class="i">+                        datatype: String,
</a><a href="#h64-1-109" id="h64-1-109" class="i">+                        primary_key: false,
</a><a href="#h64-1-110" id="h64-1-110" class="i">+                        nullable: false,
</a><a href="#h64-1-111" id="h64-1-111" class="i">+                        default: None,
</a><a href="#h64-1-112" id="h64-1-112" class="i">+                        unique: false,
</a><a href="#h64-1-113" id="h64-1-113" class="i">+                        references: None,
</a><a href="#h64-1-114" id="h64-1-114" class="i">+                        index: false,
</a><a href="#h64-1-115" id="h64-1-115" class="i">+                    },
</a><a href="#h64-1-116" id="h64-1-116" class="i">+                ],
</a><a href="#h64-1-117" id="h64-1-117" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h65" href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a> b/<a href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -70,13 +70,119 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h65-0-3" id="h65-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h65-0-4" id="h65-0-4" class="i">+            table: Table {
</a><a href="#h65-0-5" id="h65-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h65-0-6" id="h65-0-6" class="i">+                columns: [
</a><a href="#h65-0-7" id="h65-0-7" class="i">+                    Column {
</a><a href="#h65-0-8" id="h65-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h65-0-9" id="h65-0-9" class="i">+                        datatype: Integer,
</a><a href="#h65-0-10" id="h65-0-10" class="i">+                        primary_key: true,
</a><a href="#h65-0-11" id="h65-0-11" class="i">+                        nullable: false,
</a><a href="#h65-0-12" id="h65-0-12" class="i">+                        default: None,
</a><a href="#h65-0-13" id="h65-0-13" class="i">+                        unique: true,
</a><a href="#h65-0-14" id="h65-0-14" class="i">+                        references: None,
</a><a href="#h65-0-15" id="h65-0-15" class="i">+                        index: false,
</a><a href="#h65-0-16" id="h65-0-16" class="i">+                    },
</a><a href="#h65-0-17" id="h65-0-17" class="i">+                    Column {
</a><a href="#h65-0-18" id="h65-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h65-0-19" id="h65-0-19" class="i">+                        datatype: String,
</a><a href="#h65-0-20" id="h65-0-20" class="i">+                        primary_key: false,
</a><a href="#h65-0-21" id="h65-0-21" class="i">+                        nullable: false,
</a><a href="#h65-0-22" id="h65-0-22" class="i">+                        default: None,
</a><a href="#h65-0-23" id="h65-0-23" class="i">+                        unique: false,
</a><a href="#h65-0-24" id="h65-0-24" class="i">+                        references: None,
</a><a href="#h65-0-25" id="h65-0-25" class="i">+                        index: false,
</a><a href="#h65-0-26" id="h65-0-26" class="i">+                    },
</a><a href="#h65-0-27" id="h65-0-27" class="i">+                    Column {
</a><a href="#h65-0-28" id="h65-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h65-0-29" id="h65-0-29" class="i">+                        datatype: Integer,
</a><a href="#h65-0-30" id="h65-0-30" class="i">+                        primary_key: false,
</a><a href="#h65-0-31" id="h65-0-31" class="i">+                        nullable: false,
</a><a href="#h65-0-32" id="h65-0-32" class="i">+                        default: None,
</a><a href="#h65-0-33" id="h65-0-33" class="i">+                        unique: false,
</a><a href="#h65-0-34" id="h65-0-34" class="i">+                        references: Some(
</a><a href="#h65-0-35" id="h65-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h65-0-36" id="h65-0-36" class="i">+                        ),
</a><a href="#h65-0-37" id="h65-0-37" class="i">+                        index: true,
</a><a href="#h65-0-38" id="h65-0-38" class="i">+                    },
</a><a href="#h65-0-39" id="h65-0-39" class="i">+                    Column {
</a><a href="#h65-0-40" id="h65-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h65-0-41" id="h65-0-41" class="i">+                        datatype: Integer,
</a><a href="#h65-0-42" id="h65-0-42" class="i">+                        primary_key: false,
</a><a href="#h65-0-43" id="h65-0-43" class="i">+                        nullable: false,
</a><a href="#h65-0-44" id="h65-0-44" class="i">+                        default: None,
</a><a href="#h65-0-45" id="h65-0-45" class="i">+                        unique: false,
</a><a href="#h65-0-46" id="h65-0-46" class="i">+                        references: Some(
</a><a href="#h65-0-47" id="h65-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h65-0-48" id="h65-0-48" class="i">+                        ),
</a><a href="#h65-0-49" id="h65-0-49" class="i">+                        index: true,
</a><a href="#h65-0-50" id="h65-0-50" class="i">+                    },
</a><a href="#h65-0-51" id="h65-0-51" class="i">+                    Column {
</a><a href="#h65-0-52" id="h65-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h65-0-53" id="h65-0-53" class="i">+                        datatype: Integer,
</a><a href="#h65-0-54" id="h65-0-54" class="i">+                        primary_key: false,
</a><a href="#h65-0-55" id="h65-0-55" class="i">+                        nullable: false,
</a><a href="#h65-0-56" id="h65-0-56" class="i">+                        default: None,
</a><a href="#h65-0-57" id="h65-0-57" class="i">+                        unique: false,
</a><a href="#h65-0-58" id="h65-0-58" class="i">+                        references: None,
</a><a href="#h65-0-59" id="h65-0-59" class="i">+                        index: false,
</a><a href="#h65-0-60" id="h65-0-60" class="i">+                    },
</a><a href="#h65-0-61" id="h65-0-61" class="i">+                    Column {
</a><a href="#h65-0-62" id="h65-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h65-0-63" id="h65-0-63" class="i">+                        datatype: Float,
</a><a href="#h65-0-64" id="h65-0-64" class="i">+                        primary_key: false,
</a><a href="#h65-0-65" id="h65-0-65" class="i">+                        nullable: true,
</a><a href="#h65-0-66" id="h65-0-66" class="i">+                        default: Some(
</a><a href="#h65-0-67" id="h65-0-67" class="i">+                            Null,
</a><a href="#h65-0-68" id="h65-0-68" class="i">+                        ),
</a><a href="#h65-0-69" id="h65-0-69" class="i">+                        unique: false,
</a><a href="#h65-0-70" id="h65-0-70" class="i">+                        references: None,
</a><a href="#h65-0-71" id="h65-0-71" class="i">+                        index: false,
</a><a href="#h65-0-72" id="h65-0-72" class="i">+                    },
</a><a href="#h65-0-73" id="h65-0-73" class="i">+                    Column {
</a><a href="#h65-0-74" id="h65-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h65-0-75" id="h65-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h65-0-76" id="h65-0-76" class="i">+                        primary_key: false,
</a><a href="#h65-0-77" id="h65-0-77" class="i">+                        nullable: true,
</a><a href="#h65-0-78" id="h65-0-78" class="i">+                        default: Some(
</a><a href="#h65-0-79" id="h65-0-79" class="i">+                            Null,
</a><a href="#h65-0-80" id="h65-0-80" class="i">+                        ),
</a><a href="#h65-0-81" id="h65-0-81" class="i">+                        unique: false,
</a><a href="#h65-0-82" id="h65-0-82" class="i">+                        references: None,
</a><a href="#h65-0-83" id="h65-0-83" class="i">+                        index: false,
</a><a href="#h65-0-84" id="h65-0-84" class="i">+                    },
</a><a href="#h65-0-85" id="h65-0-85" class="i">+                ],
</a><a href="#h65-0-86" id="h65-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
         left_size: 7,
         right: Scan {
<a href="#h65-0-92" id="h65-0-92" class="d">-            table: &quot;genres&quot;,
</a><a href="#h65-0-93" id="h65-0-93" class="i">+            table: Table {
</a><a href="#h65-0-94" id="h65-0-94" class="i">+                name: &quot;genres&quot;,
</a><a href="#h65-0-95" id="h65-0-95" class="i">+                columns: [
</a><a href="#h65-0-96" id="h65-0-96" class="i">+                    Column {
</a><a href="#h65-0-97" id="h65-0-97" class="i">+                        name: &quot;id&quot;,
</a><a href="#h65-0-98" id="h65-0-98" class="i">+                        datatype: Integer,
</a><a href="#h65-0-99" id="h65-0-99" class="i">+                        primary_key: true,
</a><a href="#h65-0-100" id="h65-0-100" class="i">+                        nullable: false,
</a><a href="#h65-0-101" id="h65-0-101" class="i">+                        default: None,
</a><a href="#h65-0-102" id="h65-0-102" class="i">+                        unique: true,
</a><a href="#h65-0-103" id="h65-0-103" class="i">+                        references: None,
</a><a href="#h65-0-104" id="h65-0-104" class="i">+                        index: false,
</a><a href="#h65-0-105" id="h65-0-105" class="i">+                    },
</a><a href="#h65-0-106" id="h65-0-106" class="i">+                    Column {
</a><a href="#h65-0-107" id="h65-0-107" class="i">+                        name: &quot;name&quot;,
</a><a href="#h65-0-108" id="h65-0-108" class="i">+                        datatype: String,
</a><a href="#h65-0-109" id="h65-0-109" class="i">+                        primary_key: false,
</a><a href="#h65-0-110" id="h65-0-110" class="i">+                        nullable: false,
</a><a href="#h65-0-111" id="h65-0-111" class="i">+                        default: None,
</a><a href="#h65-0-112" id="h65-0-112" class="i">+                        unique: false,
</a><a href="#h65-0-113" id="h65-0-113" class="i">+                        references: None,
</a><a href="#h65-0-114" id="h65-0-114" class="i">+                        index: false,
</a><a href="#h65-0-115" id="h65-0-115" class="i">+                    },
</a><a href="#h65-0-116" id="h65-0-116" class="i">+                ],
</a><a href="#h65-0-117" id="h65-0-117" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h65-1" id="h65-1" class="h">@@ -94,7 +200,89 @@ Plan: Select(
</a> Optimized plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h65-1-3" id="h65-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h65-1-4" id="h65-1-4" class="i">+            table: Table {
</a><a href="#h65-1-5" id="h65-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h65-1-6" id="h65-1-6" class="i">+                columns: [
</a><a href="#h65-1-7" id="h65-1-7" class="i">+                    Column {
</a><a href="#h65-1-8" id="h65-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h65-1-9" id="h65-1-9" class="i">+                        datatype: Integer,
</a><a href="#h65-1-10" id="h65-1-10" class="i">+                        primary_key: true,
</a><a href="#h65-1-11" id="h65-1-11" class="i">+                        nullable: false,
</a><a href="#h65-1-12" id="h65-1-12" class="i">+                        default: None,
</a><a href="#h65-1-13" id="h65-1-13" class="i">+                        unique: true,
</a><a href="#h65-1-14" id="h65-1-14" class="i">+                        references: None,
</a><a href="#h65-1-15" id="h65-1-15" class="i">+                        index: false,
</a><a href="#h65-1-16" id="h65-1-16" class="i">+                    },
</a><a href="#h65-1-17" id="h65-1-17" class="i">+                    Column {
</a><a href="#h65-1-18" id="h65-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h65-1-19" id="h65-1-19" class="i">+                        datatype: String,
</a><a href="#h65-1-20" id="h65-1-20" class="i">+                        primary_key: false,
</a><a href="#h65-1-21" id="h65-1-21" class="i">+                        nullable: false,
</a><a href="#h65-1-22" id="h65-1-22" class="i">+                        default: None,
</a><a href="#h65-1-23" id="h65-1-23" class="i">+                        unique: false,
</a><a href="#h65-1-24" id="h65-1-24" class="i">+                        references: None,
</a><a href="#h65-1-25" id="h65-1-25" class="i">+                        index: false,
</a><a href="#h65-1-26" id="h65-1-26" class="i">+                    },
</a><a href="#h65-1-27" id="h65-1-27" class="i">+                    Column {
</a><a href="#h65-1-28" id="h65-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h65-1-29" id="h65-1-29" class="i">+                        datatype: Integer,
</a><a href="#h65-1-30" id="h65-1-30" class="i">+                        primary_key: false,
</a><a href="#h65-1-31" id="h65-1-31" class="i">+                        nullable: false,
</a><a href="#h65-1-32" id="h65-1-32" class="i">+                        default: None,
</a><a href="#h65-1-33" id="h65-1-33" class="i">+                        unique: false,
</a><a href="#h65-1-34" id="h65-1-34" class="i">+                        references: Some(
</a><a href="#h65-1-35" id="h65-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h65-1-36" id="h65-1-36" class="i">+                        ),
</a><a href="#h65-1-37" id="h65-1-37" class="i">+                        index: true,
</a><a href="#h65-1-38" id="h65-1-38" class="i">+                    },
</a><a href="#h65-1-39" id="h65-1-39" class="i">+                    Column {
</a><a href="#h65-1-40" id="h65-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h65-1-41" id="h65-1-41" class="i">+                        datatype: Integer,
</a><a href="#h65-1-42" id="h65-1-42" class="i">+                        primary_key: false,
</a><a href="#h65-1-43" id="h65-1-43" class="i">+                        nullable: false,
</a><a href="#h65-1-44" id="h65-1-44" class="i">+                        default: None,
</a><a href="#h65-1-45" id="h65-1-45" class="i">+                        unique: false,
</a><a href="#h65-1-46" id="h65-1-46" class="i">+                        references: Some(
</a><a href="#h65-1-47" id="h65-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h65-1-48" id="h65-1-48" class="i">+                        ),
</a><a href="#h65-1-49" id="h65-1-49" class="i">+                        index: true,
</a><a href="#h65-1-50" id="h65-1-50" class="i">+                    },
</a><a href="#h65-1-51" id="h65-1-51" class="i">+                    Column {
</a><a href="#h65-1-52" id="h65-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h65-1-53" id="h65-1-53" class="i">+                        datatype: Integer,
</a><a href="#h65-1-54" id="h65-1-54" class="i">+                        primary_key: false,
</a><a href="#h65-1-55" id="h65-1-55" class="i">+                        nullable: false,
</a><a href="#h65-1-56" id="h65-1-56" class="i">+                        default: None,
</a><a href="#h65-1-57" id="h65-1-57" class="i">+                        unique: false,
</a><a href="#h65-1-58" id="h65-1-58" class="i">+                        references: None,
</a><a href="#h65-1-59" id="h65-1-59" class="i">+                        index: false,
</a><a href="#h65-1-60" id="h65-1-60" class="i">+                    },
</a><a href="#h65-1-61" id="h65-1-61" class="i">+                    Column {
</a><a href="#h65-1-62" id="h65-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h65-1-63" id="h65-1-63" class="i">+                        datatype: Float,
</a><a href="#h65-1-64" id="h65-1-64" class="i">+                        primary_key: false,
</a><a href="#h65-1-65" id="h65-1-65" class="i">+                        nullable: true,
</a><a href="#h65-1-66" id="h65-1-66" class="i">+                        default: Some(
</a><a href="#h65-1-67" id="h65-1-67" class="i">+                            Null,
</a><a href="#h65-1-68" id="h65-1-68" class="i">+                        ),
</a><a href="#h65-1-69" id="h65-1-69" class="i">+                        unique: false,
</a><a href="#h65-1-70" id="h65-1-70" class="i">+                        references: None,
</a><a href="#h65-1-71" id="h65-1-71" class="i">+                        index: false,
</a><a href="#h65-1-72" id="h65-1-72" class="i">+                    },
</a><a href="#h65-1-73" id="h65-1-73" class="i">+                    Column {
</a><a href="#h65-1-74" id="h65-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h65-1-75" id="h65-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h65-1-76" id="h65-1-76" class="i">+                        primary_key: false,
</a><a href="#h65-1-77" id="h65-1-77" class="i">+                        nullable: true,
</a><a href="#h65-1-78" id="h65-1-78" class="i">+                        default: Some(
</a><a href="#h65-1-79" id="h65-1-79" class="i">+                            Null,
</a><a href="#h65-1-80" id="h65-1-80" class="i">+                        ),
</a><a href="#h65-1-81" id="h65-1-81" class="i">+                        unique: false,
</a><a href="#h65-1-82" id="h65-1-82" class="i">+                        references: None,
</a><a href="#h65-1-83" id="h65-1-83" class="i">+                        index: false,
</a><a href="#h65-1-84" id="h65-1-84" class="i">+                    },
</a><a href="#h65-1-85" id="h65-1-85" class="i">+                ],
</a><a href="#h65-1-86" id="h65-1-86" class="i">+            },
</a>             alias: None,
             filter: Some(
                 Constant(
<a href="#h65-2" id="h65-2" class="h">@@ -106,7 +294,31 @@ Optimized plan: Select(
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h65-2-3" id="h65-2-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h65-2-4" id="h65-2-4" class="i">+            table: Table {
</a><a href="#h65-2-5" id="h65-2-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h65-2-6" id="h65-2-6" class="i">+                columns: [
</a><a href="#h65-2-7" id="h65-2-7" class="i">+                    Column {
</a><a href="#h65-2-8" id="h65-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h65-2-9" id="h65-2-9" class="i">+                        datatype: Integer,
</a><a href="#h65-2-10" id="h65-2-10" class="i">+                        primary_key: true,
</a><a href="#h65-2-11" id="h65-2-11" class="i">+                        nullable: false,
</a><a href="#h65-2-12" id="h65-2-12" class="i">+                        default: None,
</a><a href="#h65-2-13" id="h65-2-13" class="i">+                        unique: true,
</a><a href="#h65-2-14" id="h65-2-14" class="i">+                        references: None,
</a><a href="#h65-2-15" id="h65-2-15" class="i">+                        index: false,
</a><a href="#h65-2-16" id="h65-2-16" class="i">+                    },
</a><a href="#h65-2-17" id="h65-2-17" class="i">+                    Column {
</a><a href="#h65-2-18" id="h65-2-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h65-2-19" id="h65-2-19" class="i">+                        datatype: String,
</a><a href="#h65-2-20" id="h65-2-20" class="i">+                        primary_key: false,
</a><a href="#h65-2-21" id="h65-2-21" class="i">+                        nullable: false,
</a><a href="#h65-2-22" id="h65-2-22" class="i">+                        default: None,
</a><a href="#h65-2-23" id="h65-2-23" class="i">+                        unique: false,
</a><a href="#h65-2-24" id="h65-2-24" class="i">+                        references: None,
</a><a href="#h65-2-25" id="h65-2-25" class="i">+                        index: false,
</a><a href="#h65-2-26" id="h65-2-26" class="i">+                    },
</a><a href="#h65-2-27" id="h65-2-27" class="i">+                ],
</a><a href="#h65-2-28" id="h65-2-28" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h66" href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a> b/<a href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -76,13 +76,119 @@ Plan: Select(
</a>     Filter {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h66-0-3" id="h66-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h66-0-4" id="h66-0-4" class="i">+                table: Table {
</a><a href="#h66-0-5" id="h66-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h66-0-6" id="h66-0-6" class="i">+                    columns: [
</a><a href="#h66-0-7" id="h66-0-7" class="i">+                        Column {
</a><a href="#h66-0-8" id="h66-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h66-0-9" id="h66-0-9" class="i">+                            datatype: Integer,
</a><a href="#h66-0-10" id="h66-0-10" class="i">+                            primary_key: true,
</a><a href="#h66-0-11" id="h66-0-11" class="i">+                            nullable: false,
</a><a href="#h66-0-12" id="h66-0-12" class="i">+                            default: None,
</a><a href="#h66-0-13" id="h66-0-13" class="i">+                            unique: true,
</a><a href="#h66-0-14" id="h66-0-14" class="i">+                            references: None,
</a><a href="#h66-0-15" id="h66-0-15" class="i">+                            index: false,
</a><a href="#h66-0-16" id="h66-0-16" class="i">+                        },
</a><a href="#h66-0-17" id="h66-0-17" class="i">+                        Column {
</a><a href="#h66-0-18" id="h66-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h66-0-19" id="h66-0-19" class="i">+                            datatype: String,
</a><a href="#h66-0-20" id="h66-0-20" class="i">+                            primary_key: false,
</a><a href="#h66-0-21" id="h66-0-21" class="i">+                            nullable: false,
</a><a href="#h66-0-22" id="h66-0-22" class="i">+                            default: None,
</a><a href="#h66-0-23" id="h66-0-23" class="i">+                            unique: false,
</a><a href="#h66-0-24" id="h66-0-24" class="i">+                            references: None,
</a><a href="#h66-0-25" id="h66-0-25" class="i">+                            index: false,
</a><a href="#h66-0-26" id="h66-0-26" class="i">+                        },
</a><a href="#h66-0-27" id="h66-0-27" class="i">+                        Column {
</a><a href="#h66-0-28" id="h66-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h66-0-29" id="h66-0-29" class="i">+                            datatype: Integer,
</a><a href="#h66-0-30" id="h66-0-30" class="i">+                            primary_key: false,
</a><a href="#h66-0-31" id="h66-0-31" class="i">+                            nullable: false,
</a><a href="#h66-0-32" id="h66-0-32" class="i">+                            default: None,
</a><a href="#h66-0-33" id="h66-0-33" class="i">+                            unique: false,
</a><a href="#h66-0-34" id="h66-0-34" class="i">+                            references: Some(
</a><a href="#h66-0-35" id="h66-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h66-0-36" id="h66-0-36" class="i">+                            ),
</a><a href="#h66-0-37" id="h66-0-37" class="i">+                            index: true,
</a><a href="#h66-0-38" id="h66-0-38" class="i">+                        },
</a><a href="#h66-0-39" id="h66-0-39" class="i">+                        Column {
</a><a href="#h66-0-40" id="h66-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h66-0-41" id="h66-0-41" class="i">+                            datatype: Integer,
</a><a href="#h66-0-42" id="h66-0-42" class="i">+                            primary_key: false,
</a><a href="#h66-0-43" id="h66-0-43" class="i">+                            nullable: false,
</a><a href="#h66-0-44" id="h66-0-44" class="i">+                            default: None,
</a><a href="#h66-0-45" id="h66-0-45" class="i">+                            unique: false,
</a><a href="#h66-0-46" id="h66-0-46" class="i">+                            references: Some(
</a><a href="#h66-0-47" id="h66-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h66-0-48" id="h66-0-48" class="i">+                            ),
</a><a href="#h66-0-49" id="h66-0-49" class="i">+                            index: true,
</a><a href="#h66-0-50" id="h66-0-50" class="i">+                        },
</a><a href="#h66-0-51" id="h66-0-51" class="i">+                        Column {
</a><a href="#h66-0-52" id="h66-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h66-0-53" id="h66-0-53" class="i">+                            datatype: Integer,
</a><a href="#h66-0-54" id="h66-0-54" class="i">+                            primary_key: false,
</a><a href="#h66-0-55" id="h66-0-55" class="i">+                            nullable: false,
</a><a href="#h66-0-56" id="h66-0-56" class="i">+                            default: None,
</a><a href="#h66-0-57" id="h66-0-57" class="i">+                            unique: false,
</a><a href="#h66-0-58" id="h66-0-58" class="i">+                            references: None,
</a><a href="#h66-0-59" id="h66-0-59" class="i">+                            index: false,
</a><a href="#h66-0-60" id="h66-0-60" class="i">+                        },
</a><a href="#h66-0-61" id="h66-0-61" class="i">+                        Column {
</a><a href="#h66-0-62" id="h66-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h66-0-63" id="h66-0-63" class="i">+                            datatype: Float,
</a><a href="#h66-0-64" id="h66-0-64" class="i">+                            primary_key: false,
</a><a href="#h66-0-65" id="h66-0-65" class="i">+                            nullable: true,
</a><a href="#h66-0-66" id="h66-0-66" class="i">+                            default: Some(
</a><a href="#h66-0-67" id="h66-0-67" class="i">+                                Null,
</a><a href="#h66-0-68" id="h66-0-68" class="i">+                            ),
</a><a href="#h66-0-69" id="h66-0-69" class="i">+                            unique: false,
</a><a href="#h66-0-70" id="h66-0-70" class="i">+                            references: None,
</a><a href="#h66-0-71" id="h66-0-71" class="i">+                            index: false,
</a><a href="#h66-0-72" id="h66-0-72" class="i">+                        },
</a><a href="#h66-0-73" id="h66-0-73" class="i">+                        Column {
</a><a href="#h66-0-74" id="h66-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h66-0-75" id="h66-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h66-0-76" id="h66-0-76" class="i">+                            primary_key: false,
</a><a href="#h66-0-77" id="h66-0-77" class="i">+                            nullable: true,
</a><a href="#h66-0-78" id="h66-0-78" class="i">+                            default: Some(
</a><a href="#h66-0-79" id="h66-0-79" class="i">+                                Null,
</a><a href="#h66-0-80" id="h66-0-80" class="i">+                            ),
</a><a href="#h66-0-81" id="h66-0-81" class="i">+                            unique: false,
</a><a href="#h66-0-82" id="h66-0-82" class="i">+                            references: None,
</a><a href="#h66-0-83" id="h66-0-83" class="i">+                            index: false,
</a><a href="#h66-0-84" id="h66-0-84" class="i">+                        },
</a><a href="#h66-0-85" id="h66-0-85" class="i">+                    ],
</a><a href="#h66-0-86" id="h66-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
             left_size: 7,
             right: Scan {
<a href="#h66-0-92" id="h66-0-92" class="d">-                table: &quot;genres&quot;,
</a><a href="#h66-0-93" id="h66-0-93" class="i">+                table: Table {
</a><a href="#h66-0-94" id="h66-0-94" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h66-0-95" id="h66-0-95" class="i">+                    columns: [
</a><a href="#h66-0-96" id="h66-0-96" class="i">+                        Column {
</a><a href="#h66-0-97" id="h66-0-97" class="i">+                            name: &quot;id&quot;,
</a><a href="#h66-0-98" id="h66-0-98" class="i">+                            datatype: Integer,
</a><a href="#h66-0-99" id="h66-0-99" class="i">+                            primary_key: true,
</a><a href="#h66-0-100" id="h66-0-100" class="i">+                            nullable: false,
</a><a href="#h66-0-101" id="h66-0-101" class="i">+                            default: None,
</a><a href="#h66-0-102" id="h66-0-102" class="i">+                            unique: true,
</a><a href="#h66-0-103" id="h66-0-103" class="i">+                            references: None,
</a><a href="#h66-0-104" id="h66-0-104" class="i">+                            index: false,
</a><a href="#h66-0-105" id="h66-0-105" class="i">+                        },
</a><a href="#h66-0-106" id="h66-0-106" class="i">+                        Column {
</a><a href="#h66-0-107" id="h66-0-107" class="i">+                            name: &quot;name&quot;,
</a><a href="#h66-0-108" id="h66-0-108" class="i">+                            datatype: String,
</a><a href="#h66-0-109" id="h66-0-109" class="i">+                            primary_key: false,
</a><a href="#h66-0-110" id="h66-0-110" class="i">+                            nullable: false,
</a><a href="#h66-0-111" id="h66-0-111" class="i">+                            default: None,
</a><a href="#h66-0-112" id="h66-0-112" class="i">+                            unique: false,
</a><a href="#h66-0-113" id="h66-0-113" class="i">+                            references: None,
</a><a href="#h66-0-114" id="h66-0-114" class="i">+                            index: false,
</a><a href="#h66-0-115" id="h66-0-115" class="i">+                        },
</a><a href="#h66-0-116" id="h66-0-116" class="i">+                    ],
</a><a href="#h66-0-117" id="h66-0-117" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h66-1" id="h66-1" class="h">@@ -158,7 +264,89 @@ Plan: Select(
</a> Optimized plan: Select(
     HashJoin {
         left: Scan {
<a href="#h66-1-3" id="h66-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h66-1-4" id="h66-1-4" class="i">+            table: Table {
</a><a href="#h66-1-5" id="h66-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h66-1-6" id="h66-1-6" class="i">+                columns: [
</a><a href="#h66-1-7" id="h66-1-7" class="i">+                    Column {
</a><a href="#h66-1-8" id="h66-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h66-1-9" id="h66-1-9" class="i">+                        datatype: Integer,
</a><a href="#h66-1-10" id="h66-1-10" class="i">+                        primary_key: true,
</a><a href="#h66-1-11" id="h66-1-11" class="i">+                        nullable: false,
</a><a href="#h66-1-12" id="h66-1-12" class="i">+                        default: None,
</a><a href="#h66-1-13" id="h66-1-13" class="i">+                        unique: true,
</a><a href="#h66-1-14" id="h66-1-14" class="i">+                        references: None,
</a><a href="#h66-1-15" id="h66-1-15" class="i">+                        index: false,
</a><a href="#h66-1-16" id="h66-1-16" class="i">+                    },
</a><a href="#h66-1-17" id="h66-1-17" class="i">+                    Column {
</a><a href="#h66-1-18" id="h66-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h66-1-19" id="h66-1-19" class="i">+                        datatype: String,
</a><a href="#h66-1-20" id="h66-1-20" class="i">+                        primary_key: false,
</a><a href="#h66-1-21" id="h66-1-21" class="i">+                        nullable: false,
</a><a href="#h66-1-22" id="h66-1-22" class="i">+                        default: None,
</a><a href="#h66-1-23" id="h66-1-23" class="i">+                        unique: false,
</a><a href="#h66-1-24" id="h66-1-24" class="i">+                        references: None,
</a><a href="#h66-1-25" id="h66-1-25" class="i">+                        index: false,
</a><a href="#h66-1-26" id="h66-1-26" class="i">+                    },
</a><a href="#h66-1-27" id="h66-1-27" class="i">+                    Column {
</a><a href="#h66-1-28" id="h66-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h66-1-29" id="h66-1-29" class="i">+                        datatype: Integer,
</a><a href="#h66-1-30" id="h66-1-30" class="i">+                        primary_key: false,
</a><a href="#h66-1-31" id="h66-1-31" class="i">+                        nullable: false,
</a><a href="#h66-1-32" id="h66-1-32" class="i">+                        default: None,
</a><a href="#h66-1-33" id="h66-1-33" class="i">+                        unique: false,
</a><a href="#h66-1-34" id="h66-1-34" class="i">+                        references: Some(
</a><a href="#h66-1-35" id="h66-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h66-1-36" id="h66-1-36" class="i">+                        ),
</a><a href="#h66-1-37" id="h66-1-37" class="i">+                        index: true,
</a><a href="#h66-1-38" id="h66-1-38" class="i">+                    },
</a><a href="#h66-1-39" id="h66-1-39" class="i">+                    Column {
</a><a href="#h66-1-40" id="h66-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h66-1-41" id="h66-1-41" class="i">+                        datatype: Integer,
</a><a href="#h66-1-42" id="h66-1-42" class="i">+                        primary_key: false,
</a><a href="#h66-1-43" id="h66-1-43" class="i">+                        nullable: false,
</a><a href="#h66-1-44" id="h66-1-44" class="i">+                        default: None,
</a><a href="#h66-1-45" id="h66-1-45" class="i">+                        unique: false,
</a><a href="#h66-1-46" id="h66-1-46" class="i">+                        references: Some(
</a><a href="#h66-1-47" id="h66-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h66-1-48" id="h66-1-48" class="i">+                        ),
</a><a href="#h66-1-49" id="h66-1-49" class="i">+                        index: true,
</a><a href="#h66-1-50" id="h66-1-50" class="i">+                    },
</a><a href="#h66-1-51" id="h66-1-51" class="i">+                    Column {
</a><a href="#h66-1-52" id="h66-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h66-1-53" id="h66-1-53" class="i">+                        datatype: Integer,
</a><a href="#h66-1-54" id="h66-1-54" class="i">+                        primary_key: false,
</a><a href="#h66-1-55" id="h66-1-55" class="i">+                        nullable: false,
</a><a href="#h66-1-56" id="h66-1-56" class="i">+                        default: None,
</a><a href="#h66-1-57" id="h66-1-57" class="i">+                        unique: false,
</a><a href="#h66-1-58" id="h66-1-58" class="i">+                        references: None,
</a><a href="#h66-1-59" id="h66-1-59" class="i">+                        index: false,
</a><a href="#h66-1-60" id="h66-1-60" class="i">+                    },
</a><a href="#h66-1-61" id="h66-1-61" class="i">+                    Column {
</a><a href="#h66-1-62" id="h66-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h66-1-63" id="h66-1-63" class="i">+                        datatype: Float,
</a><a href="#h66-1-64" id="h66-1-64" class="i">+                        primary_key: false,
</a><a href="#h66-1-65" id="h66-1-65" class="i">+                        nullable: true,
</a><a href="#h66-1-66" id="h66-1-66" class="i">+                        default: Some(
</a><a href="#h66-1-67" id="h66-1-67" class="i">+                            Null,
</a><a href="#h66-1-68" id="h66-1-68" class="i">+                        ),
</a><a href="#h66-1-69" id="h66-1-69" class="i">+                        unique: false,
</a><a href="#h66-1-70" id="h66-1-70" class="i">+                        references: None,
</a><a href="#h66-1-71" id="h66-1-71" class="i">+                        index: false,
</a><a href="#h66-1-72" id="h66-1-72" class="i">+                    },
</a><a href="#h66-1-73" id="h66-1-73" class="i">+                    Column {
</a><a href="#h66-1-74" id="h66-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h66-1-75" id="h66-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h66-1-76" id="h66-1-76" class="i">+                        primary_key: false,
</a><a href="#h66-1-77" id="h66-1-77" class="i">+                        nullable: true,
</a><a href="#h66-1-78" id="h66-1-78" class="i">+                        default: Some(
</a><a href="#h66-1-79" id="h66-1-79" class="i">+                            Null,
</a><a href="#h66-1-80" id="h66-1-80" class="i">+                        ),
</a><a href="#h66-1-81" id="h66-1-81" class="i">+                        unique: false,
</a><a href="#h66-1-82" id="h66-1-82" class="i">+                        references: None,
</a><a href="#h66-1-83" id="h66-1-83" class="i">+                        index: false,
</a><a href="#h66-1-84" id="h66-1-84" class="i">+                    },
</a><a href="#h66-1-85" id="h66-1-85" class="i">+                ],
</a><a href="#h66-1-86" id="h66-1-86" class="i">+            },
</a>             alias: None,
             filter: Some(
                 Or(
<a href="#h66-2" id="h66-2" class="h">@@ -213,7 +401,31 @@ Optimized plan: Select(
</a>             ),
         ),
         right: Scan {
<a href="#h66-2-3" id="h66-2-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h66-2-4" id="h66-2-4" class="i">+            table: Table {
</a><a href="#h66-2-5" id="h66-2-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h66-2-6" id="h66-2-6" class="i">+                columns: [
</a><a href="#h66-2-7" id="h66-2-7" class="i">+                    Column {
</a><a href="#h66-2-8" id="h66-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h66-2-9" id="h66-2-9" class="i">+                        datatype: Integer,
</a><a href="#h66-2-10" id="h66-2-10" class="i">+                        primary_key: true,
</a><a href="#h66-2-11" id="h66-2-11" class="i">+                        nullable: false,
</a><a href="#h66-2-12" id="h66-2-12" class="i">+                        default: None,
</a><a href="#h66-2-13" id="h66-2-13" class="i">+                        unique: true,
</a><a href="#h66-2-14" id="h66-2-14" class="i">+                        references: None,
</a><a href="#h66-2-15" id="h66-2-15" class="i">+                        index: false,
</a><a href="#h66-2-16" id="h66-2-16" class="i">+                    },
</a><a href="#h66-2-17" id="h66-2-17" class="i">+                    Column {
</a><a href="#h66-2-18" id="h66-2-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h66-2-19" id="h66-2-19" class="i">+                        datatype: String,
</a><a href="#h66-2-20" id="h66-2-20" class="i">+                        primary_key: false,
</a><a href="#h66-2-21" id="h66-2-21" class="i">+                        nullable: false,
</a><a href="#h66-2-22" id="h66-2-22" class="i">+                        default: None,
</a><a href="#h66-2-23" id="h66-2-23" class="i">+                        unique: false,
</a><a href="#h66-2-24" id="h66-2-24" class="i">+                        references: None,
</a><a href="#h66-2-25" id="h66-2-25" class="i">+                        index: false,
</a><a href="#h66-2-26" id="h66-2-26" class="i">+                    },
</a><a href="#h66-2-27" id="h66-2-27" class="i">+                ],
</a><a href="#h66-2-28" id="h66-2-28" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h67" href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a> b/<a href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -90,7 +90,89 @@ Plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h67-0-3" id="h67-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h67-0-4" id="h67-0-4" class="i">+                table: Table {
</a><a href="#h67-0-5" id="h67-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h67-0-6" id="h67-0-6" class="i">+                    columns: [
</a><a href="#h67-0-7" id="h67-0-7" class="i">+                        Column {
</a><a href="#h67-0-8" id="h67-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h67-0-9" id="h67-0-9" class="i">+                            datatype: Integer,
</a><a href="#h67-0-10" id="h67-0-10" class="i">+                            primary_key: true,
</a><a href="#h67-0-11" id="h67-0-11" class="i">+                            nullable: false,
</a><a href="#h67-0-12" id="h67-0-12" class="i">+                            default: None,
</a><a href="#h67-0-13" id="h67-0-13" class="i">+                            unique: true,
</a><a href="#h67-0-14" id="h67-0-14" class="i">+                            references: None,
</a><a href="#h67-0-15" id="h67-0-15" class="i">+                            index: false,
</a><a href="#h67-0-16" id="h67-0-16" class="i">+                        },
</a><a href="#h67-0-17" id="h67-0-17" class="i">+                        Column {
</a><a href="#h67-0-18" id="h67-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h67-0-19" id="h67-0-19" class="i">+                            datatype: String,
</a><a href="#h67-0-20" id="h67-0-20" class="i">+                            primary_key: false,
</a><a href="#h67-0-21" id="h67-0-21" class="i">+                            nullable: false,
</a><a href="#h67-0-22" id="h67-0-22" class="i">+                            default: None,
</a><a href="#h67-0-23" id="h67-0-23" class="i">+                            unique: false,
</a><a href="#h67-0-24" id="h67-0-24" class="i">+                            references: None,
</a><a href="#h67-0-25" id="h67-0-25" class="i">+                            index: false,
</a><a href="#h67-0-26" id="h67-0-26" class="i">+                        },
</a><a href="#h67-0-27" id="h67-0-27" class="i">+                        Column {
</a><a href="#h67-0-28" id="h67-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h67-0-29" id="h67-0-29" class="i">+                            datatype: Integer,
</a><a href="#h67-0-30" id="h67-0-30" class="i">+                            primary_key: false,
</a><a href="#h67-0-31" id="h67-0-31" class="i">+                            nullable: false,
</a><a href="#h67-0-32" id="h67-0-32" class="i">+                            default: None,
</a><a href="#h67-0-33" id="h67-0-33" class="i">+                            unique: false,
</a><a href="#h67-0-34" id="h67-0-34" class="i">+                            references: Some(
</a><a href="#h67-0-35" id="h67-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h67-0-36" id="h67-0-36" class="i">+                            ),
</a><a href="#h67-0-37" id="h67-0-37" class="i">+                            index: true,
</a><a href="#h67-0-38" id="h67-0-38" class="i">+                        },
</a><a href="#h67-0-39" id="h67-0-39" class="i">+                        Column {
</a><a href="#h67-0-40" id="h67-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h67-0-41" id="h67-0-41" class="i">+                            datatype: Integer,
</a><a href="#h67-0-42" id="h67-0-42" class="i">+                            primary_key: false,
</a><a href="#h67-0-43" id="h67-0-43" class="i">+                            nullable: false,
</a><a href="#h67-0-44" id="h67-0-44" class="i">+                            default: None,
</a><a href="#h67-0-45" id="h67-0-45" class="i">+                            unique: false,
</a><a href="#h67-0-46" id="h67-0-46" class="i">+                            references: Some(
</a><a href="#h67-0-47" id="h67-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h67-0-48" id="h67-0-48" class="i">+                            ),
</a><a href="#h67-0-49" id="h67-0-49" class="i">+                            index: true,
</a><a href="#h67-0-50" id="h67-0-50" class="i">+                        },
</a><a href="#h67-0-51" id="h67-0-51" class="i">+                        Column {
</a><a href="#h67-0-52" id="h67-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h67-0-53" id="h67-0-53" class="i">+                            datatype: Integer,
</a><a href="#h67-0-54" id="h67-0-54" class="i">+                            primary_key: false,
</a><a href="#h67-0-55" id="h67-0-55" class="i">+                            nullable: false,
</a><a href="#h67-0-56" id="h67-0-56" class="i">+                            default: None,
</a><a href="#h67-0-57" id="h67-0-57" class="i">+                            unique: false,
</a><a href="#h67-0-58" id="h67-0-58" class="i">+                            references: None,
</a><a href="#h67-0-59" id="h67-0-59" class="i">+                            index: false,
</a><a href="#h67-0-60" id="h67-0-60" class="i">+                        },
</a><a href="#h67-0-61" id="h67-0-61" class="i">+                        Column {
</a><a href="#h67-0-62" id="h67-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h67-0-63" id="h67-0-63" class="i">+                            datatype: Float,
</a><a href="#h67-0-64" id="h67-0-64" class="i">+                            primary_key: false,
</a><a href="#h67-0-65" id="h67-0-65" class="i">+                            nullable: true,
</a><a href="#h67-0-66" id="h67-0-66" class="i">+                            default: Some(
</a><a href="#h67-0-67" id="h67-0-67" class="i">+                                Null,
</a><a href="#h67-0-68" id="h67-0-68" class="i">+                            ),
</a><a href="#h67-0-69" id="h67-0-69" class="i">+                            unique: false,
</a><a href="#h67-0-70" id="h67-0-70" class="i">+                            references: None,
</a><a href="#h67-0-71" id="h67-0-71" class="i">+                            index: false,
</a><a href="#h67-0-72" id="h67-0-72" class="i">+                        },
</a><a href="#h67-0-73" id="h67-0-73" class="i">+                        Column {
</a><a href="#h67-0-74" id="h67-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h67-0-75" id="h67-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h67-0-76" id="h67-0-76" class="i">+                            primary_key: false,
</a><a href="#h67-0-77" id="h67-0-77" class="i">+                            nullable: true,
</a><a href="#h67-0-78" id="h67-0-78" class="i">+                            default: Some(
</a><a href="#h67-0-79" id="h67-0-79" class="i">+                                Null,
</a><a href="#h67-0-80" id="h67-0-80" class="i">+                            ),
</a><a href="#h67-0-81" id="h67-0-81" class="i">+                            unique: false,
</a><a href="#h67-0-82" id="h67-0-82" class="i">+                            references: None,
</a><a href="#h67-0-83" id="h67-0-83" class="i">+                            index: false,
</a><a href="#h67-0-84" id="h67-0-84" class="i">+                        },
</a><a href="#h67-0-85" id="h67-0-85" class="i">+                    ],
</a><a href="#h67-0-86" id="h67-0-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h67-1" id="h67-1" class="h">@@ -98,7 +180,31 @@ Plan: Select(
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h67-1-3" id="h67-1-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h67-1-4" id="h67-1-4" class="i">+                table: Table {
</a><a href="#h67-1-5" id="h67-1-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h67-1-6" id="h67-1-6" class="i">+                    columns: [
</a><a href="#h67-1-7" id="h67-1-7" class="i">+                        Column {
</a><a href="#h67-1-8" id="h67-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h67-1-9" id="h67-1-9" class="i">+                            datatype: Integer,
</a><a href="#h67-1-10" id="h67-1-10" class="i">+                            primary_key: true,
</a><a href="#h67-1-11" id="h67-1-11" class="i">+                            nullable: false,
</a><a href="#h67-1-12" id="h67-1-12" class="i">+                            default: None,
</a><a href="#h67-1-13" id="h67-1-13" class="i">+                            unique: true,
</a><a href="#h67-1-14" id="h67-1-14" class="i">+                            references: None,
</a><a href="#h67-1-15" id="h67-1-15" class="i">+                            index: false,
</a><a href="#h67-1-16" id="h67-1-16" class="i">+                        },
</a><a href="#h67-1-17" id="h67-1-17" class="i">+                        Column {
</a><a href="#h67-1-18" id="h67-1-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h67-1-19" id="h67-1-19" class="i">+                            datatype: String,
</a><a href="#h67-1-20" id="h67-1-20" class="i">+                            primary_key: false,
</a><a href="#h67-1-21" id="h67-1-21" class="i">+                            nullable: false,
</a><a href="#h67-1-22" id="h67-1-22" class="i">+                            default: None,
</a><a href="#h67-1-23" id="h67-1-23" class="i">+                            unique: false,
</a><a href="#h67-1-24" id="h67-1-24" class="i">+                            references: None,
</a><a href="#h67-1-25" id="h67-1-25" class="i">+                            index: false,
</a><a href="#h67-1-26" id="h67-1-26" class="i">+                        },
</a><a href="#h67-1-27" id="h67-1-27" class="i">+                    ],
</a><a href="#h67-1-28" id="h67-1-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h67-2" id="h67-2" class="h">@@ -173,7 +279,89 @@ Optimized plan: Select(
</a>     Projection {
         source: HashJoin {
             left: Scan {
<a href="#h67-2-3" id="h67-2-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h67-2-4" id="h67-2-4" class="i">+                table: Table {
</a><a href="#h67-2-5" id="h67-2-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h67-2-6" id="h67-2-6" class="i">+                    columns: [
</a><a href="#h67-2-7" id="h67-2-7" class="i">+                        Column {
</a><a href="#h67-2-8" id="h67-2-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h67-2-9" id="h67-2-9" class="i">+                            datatype: Integer,
</a><a href="#h67-2-10" id="h67-2-10" class="i">+                            primary_key: true,
</a><a href="#h67-2-11" id="h67-2-11" class="i">+                            nullable: false,
</a><a href="#h67-2-12" id="h67-2-12" class="i">+                            default: None,
</a><a href="#h67-2-13" id="h67-2-13" class="i">+                            unique: true,
</a><a href="#h67-2-14" id="h67-2-14" class="i">+                            references: None,
</a><a href="#h67-2-15" id="h67-2-15" class="i">+                            index: false,
</a><a href="#h67-2-16" id="h67-2-16" class="i">+                        },
</a><a href="#h67-2-17" id="h67-2-17" class="i">+                        Column {
</a><a href="#h67-2-18" id="h67-2-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h67-2-19" id="h67-2-19" class="i">+                            datatype: String,
</a><a href="#h67-2-20" id="h67-2-20" class="i">+                            primary_key: false,
</a><a href="#h67-2-21" id="h67-2-21" class="i">+                            nullable: false,
</a><a href="#h67-2-22" id="h67-2-22" class="i">+                            default: None,
</a><a href="#h67-2-23" id="h67-2-23" class="i">+                            unique: false,
</a><a href="#h67-2-24" id="h67-2-24" class="i">+                            references: None,
</a><a href="#h67-2-25" id="h67-2-25" class="i">+                            index: false,
</a><a href="#h67-2-26" id="h67-2-26" class="i">+                        },
</a><a href="#h67-2-27" id="h67-2-27" class="i">+                        Column {
</a><a href="#h67-2-28" id="h67-2-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h67-2-29" id="h67-2-29" class="i">+                            datatype: Integer,
</a><a href="#h67-2-30" id="h67-2-30" class="i">+                            primary_key: false,
</a><a href="#h67-2-31" id="h67-2-31" class="i">+                            nullable: false,
</a><a href="#h67-2-32" id="h67-2-32" class="i">+                            default: None,
</a><a href="#h67-2-33" id="h67-2-33" class="i">+                            unique: false,
</a><a href="#h67-2-34" id="h67-2-34" class="i">+                            references: Some(
</a><a href="#h67-2-35" id="h67-2-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h67-2-36" id="h67-2-36" class="i">+                            ),
</a><a href="#h67-2-37" id="h67-2-37" class="i">+                            index: true,
</a><a href="#h67-2-38" id="h67-2-38" class="i">+                        },
</a><a href="#h67-2-39" id="h67-2-39" class="i">+                        Column {
</a><a href="#h67-2-40" id="h67-2-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h67-2-41" id="h67-2-41" class="i">+                            datatype: Integer,
</a><a href="#h67-2-42" id="h67-2-42" class="i">+                            primary_key: false,
</a><a href="#h67-2-43" id="h67-2-43" class="i">+                            nullable: false,
</a><a href="#h67-2-44" id="h67-2-44" class="i">+                            default: None,
</a><a href="#h67-2-45" id="h67-2-45" class="i">+                            unique: false,
</a><a href="#h67-2-46" id="h67-2-46" class="i">+                            references: Some(
</a><a href="#h67-2-47" id="h67-2-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h67-2-48" id="h67-2-48" class="i">+                            ),
</a><a href="#h67-2-49" id="h67-2-49" class="i">+                            index: true,
</a><a href="#h67-2-50" id="h67-2-50" class="i">+                        },
</a><a href="#h67-2-51" id="h67-2-51" class="i">+                        Column {
</a><a href="#h67-2-52" id="h67-2-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h67-2-53" id="h67-2-53" class="i">+                            datatype: Integer,
</a><a href="#h67-2-54" id="h67-2-54" class="i">+                            primary_key: false,
</a><a href="#h67-2-55" id="h67-2-55" class="i">+                            nullable: false,
</a><a href="#h67-2-56" id="h67-2-56" class="i">+                            default: None,
</a><a href="#h67-2-57" id="h67-2-57" class="i">+                            unique: false,
</a><a href="#h67-2-58" id="h67-2-58" class="i">+                            references: None,
</a><a href="#h67-2-59" id="h67-2-59" class="i">+                            index: false,
</a><a href="#h67-2-60" id="h67-2-60" class="i">+                        },
</a><a href="#h67-2-61" id="h67-2-61" class="i">+                        Column {
</a><a href="#h67-2-62" id="h67-2-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h67-2-63" id="h67-2-63" class="i">+                            datatype: Float,
</a><a href="#h67-2-64" id="h67-2-64" class="i">+                            primary_key: false,
</a><a href="#h67-2-65" id="h67-2-65" class="i">+                            nullable: true,
</a><a href="#h67-2-66" id="h67-2-66" class="i">+                            default: Some(
</a><a href="#h67-2-67" id="h67-2-67" class="i">+                                Null,
</a><a href="#h67-2-68" id="h67-2-68" class="i">+                            ),
</a><a href="#h67-2-69" id="h67-2-69" class="i">+                            unique: false,
</a><a href="#h67-2-70" id="h67-2-70" class="i">+                            references: None,
</a><a href="#h67-2-71" id="h67-2-71" class="i">+                            index: false,
</a><a href="#h67-2-72" id="h67-2-72" class="i">+                        },
</a><a href="#h67-2-73" id="h67-2-73" class="i">+                        Column {
</a><a href="#h67-2-74" id="h67-2-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h67-2-75" id="h67-2-75" class="i">+                            datatype: Boolean,
</a><a href="#h67-2-76" id="h67-2-76" class="i">+                            primary_key: false,
</a><a href="#h67-2-77" id="h67-2-77" class="i">+                            nullable: true,
</a><a href="#h67-2-78" id="h67-2-78" class="i">+                            default: Some(
</a><a href="#h67-2-79" id="h67-2-79" class="i">+                                Null,
</a><a href="#h67-2-80" id="h67-2-80" class="i">+                            ),
</a><a href="#h67-2-81" id="h67-2-81" class="i">+                            unique: false,
</a><a href="#h67-2-82" id="h67-2-82" class="i">+                            references: None,
</a><a href="#h67-2-83" id="h67-2-83" class="i">+                            index: false,
</a><a href="#h67-2-84" id="h67-2-84" class="i">+                        },
</a><a href="#h67-2-85" id="h67-2-85" class="i">+                    ],
</a><a href="#h67-2-86" id="h67-2-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h67-3" id="h67-3" class="h">@@ -191,7 +379,31 @@ Optimized plan: Select(
</a>                 ),
             ),
             right: Scan {
<a href="#h67-3-3" id="h67-3-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h67-3-4" id="h67-3-4" class="i">+                table: Table {
</a><a href="#h67-3-5" id="h67-3-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h67-3-6" id="h67-3-6" class="i">+                    columns: [
</a><a href="#h67-3-7" id="h67-3-7" class="i">+                        Column {
</a><a href="#h67-3-8" id="h67-3-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h67-3-9" id="h67-3-9" class="i">+                            datatype: Integer,
</a><a href="#h67-3-10" id="h67-3-10" class="i">+                            primary_key: true,
</a><a href="#h67-3-11" id="h67-3-11" class="i">+                            nullable: false,
</a><a href="#h67-3-12" id="h67-3-12" class="i">+                            default: None,
</a><a href="#h67-3-13" id="h67-3-13" class="i">+                            unique: true,
</a><a href="#h67-3-14" id="h67-3-14" class="i">+                            references: None,
</a><a href="#h67-3-15" id="h67-3-15" class="i">+                            index: false,
</a><a href="#h67-3-16" id="h67-3-16" class="i">+                        },
</a><a href="#h67-3-17" id="h67-3-17" class="i">+                        Column {
</a><a href="#h67-3-18" id="h67-3-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h67-3-19" id="h67-3-19" class="i">+                            datatype: String,
</a><a href="#h67-3-20" id="h67-3-20" class="i">+                            primary_key: false,
</a><a href="#h67-3-21" id="h67-3-21" class="i">+                            nullable: false,
</a><a href="#h67-3-22" id="h67-3-22" class="i">+                            default: None,
</a><a href="#h67-3-23" id="h67-3-23" class="i">+                            unique: false,
</a><a href="#h67-3-24" id="h67-3-24" class="i">+                            references: None,
</a><a href="#h67-3-25" id="h67-3-25" class="i">+                            index: false,
</a><a href="#h67-3-26" id="h67-3-26" class="i">+                        },
</a><a href="#h67-3-27" id="h67-3-27" class="i">+                    ],
</a><a href="#h67-3-28" id="h67-3-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<b>diff --git a/<a id="h68" href="../file/tests/sql/query/join_left_all.html">tests/sql/query/join_left_all</a> b/<a href="../file/tests/sql/query/join_left_all.html">tests/sql/query/join_left_all</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -65,7 +65,89 @@ AST: Select {
</a> Plan: Select(
     NestedLoopJoin {
         left: Scan {
<a href="#h68-0-3" id="h68-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h68-0-4" id="h68-0-4" class="i">+            table: Table {
</a><a href="#h68-0-5" id="h68-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h68-0-6" id="h68-0-6" class="i">+                columns: [
</a><a href="#h68-0-7" id="h68-0-7" class="i">+                    Column {
</a><a href="#h68-0-8" id="h68-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h68-0-9" id="h68-0-9" class="i">+                        datatype: Integer,
</a><a href="#h68-0-10" id="h68-0-10" class="i">+                        primary_key: true,
</a><a href="#h68-0-11" id="h68-0-11" class="i">+                        nullable: false,
</a><a href="#h68-0-12" id="h68-0-12" class="i">+                        default: None,
</a><a href="#h68-0-13" id="h68-0-13" class="i">+                        unique: true,
</a><a href="#h68-0-14" id="h68-0-14" class="i">+                        references: None,
</a><a href="#h68-0-15" id="h68-0-15" class="i">+                        index: false,
</a><a href="#h68-0-16" id="h68-0-16" class="i">+                    },
</a><a href="#h68-0-17" id="h68-0-17" class="i">+                    Column {
</a><a href="#h68-0-18" id="h68-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h68-0-19" id="h68-0-19" class="i">+                        datatype: String,
</a><a href="#h68-0-20" id="h68-0-20" class="i">+                        primary_key: false,
</a><a href="#h68-0-21" id="h68-0-21" class="i">+                        nullable: false,
</a><a href="#h68-0-22" id="h68-0-22" class="i">+                        default: None,
</a><a href="#h68-0-23" id="h68-0-23" class="i">+                        unique: false,
</a><a href="#h68-0-24" id="h68-0-24" class="i">+                        references: None,
</a><a href="#h68-0-25" id="h68-0-25" class="i">+                        index: false,
</a><a href="#h68-0-26" id="h68-0-26" class="i">+                    },
</a><a href="#h68-0-27" id="h68-0-27" class="i">+                    Column {
</a><a href="#h68-0-28" id="h68-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h68-0-29" id="h68-0-29" class="i">+                        datatype: Integer,
</a><a href="#h68-0-30" id="h68-0-30" class="i">+                        primary_key: false,
</a><a href="#h68-0-31" id="h68-0-31" class="i">+                        nullable: false,
</a><a href="#h68-0-32" id="h68-0-32" class="i">+                        default: None,
</a><a href="#h68-0-33" id="h68-0-33" class="i">+                        unique: false,
</a><a href="#h68-0-34" id="h68-0-34" class="i">+                        references: Some(
</a><a href="#h68-0-35" id="h68-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h68-0-36" id="h68-0-36" class="i">+                        ),
</a><a href="#h68-0-37" id="h68-0-37" class="i">+                        index: true,
</a><a href="#h68-0-38" id="h68-0-38" class="i">+                    },
</a><a href="#h68-0-39" id="h68-0-39" class="i">+                    Column {
</a><a href="#h68-0-40" id="h68-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h68-0-41" id="h68-0-41" class="i">+                        datatype: Integer,
</a><a href="#h68-0-42" id="h68-0-42" class="i">+                        primary_key: false,
</a><a href="#h68-0-43" id="h68-0-43" class="i">+                        nullable: false,
</a><a href="#h68-0-44" id="h68-0-44" class="i">+                        default: None,
</a><a href="#h68-0-45" id="h68-0-45" class="i">+                        unique: false,
</a><a href="#h68-0-46" id="h68-0-46" class="i">+                        references: Some(
</a><a href="#h68-0-47" id="h68-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h68-0-48" id="h68-0-48" class="i">+                        ),
</a><a href="#h68-0-49" id="h68-0-49" class="i">+                        index: true,
</a><a href="#h68-0-50" id="h68-0-50" class="i">+                    },
</a><a href="#h68-0-51" id="h68-0-51" class="i">+                    Column {
</a><a href="#h68-0-52" id="h68-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h68-0-53" id="h68-0-53" class="i">+                        datatype: Integer,
</a><a href="#h68-0-54" id="h68-0-54" class="i">+                        primary_key: false,
</a><a href="#h68-0-55" id="h68-0-55" class="i">+                        nullable: false,
</a><a href="#h68-0-56" id="h68-0-56" class="i">+                        default: None,
</a><a href="#h68-0-57" id="h68-0-57" class="i">+                        unique: false,
</a><a href="#h68-0-58" id="h68-0-58" class="i">+                        references: None,
</a><a href="#h68-0-59" id="h68-0-59" class="i">+                        index: false,
</a><a href="#h68-0-60" id="h68-0-60" class="i">+                    },
</a><a href="#h68-0-61" id="h68-0-61" class="i">+                    Column {
</a><a href="#h68-0-62" id="h68-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h68-0-63" id="h68-0-63" class="i">+                        datatype: Float,
</a><a href="#h68-0-64" id="h68-0-64" class="i">+                        primary_key: false,
</a><a href="#h68-0-65" id="h68-0-65" class="i">+                        nullable: true,
</a><a href="#h68-0-66" id="h68-0-66" class="i">+                        default: Some(
</a><a href="#h68-0-67" id="h68-0-67" class="i">+                            Null,
</a><a href="#h68-0-68" id="h68-0-68" class="i">+                        ),
</a><a href="#h68-0-69" id="h68-0-69" class="i">+                        unique: false,
</a><a href="#h68-0-70" id="h68-0-70" class="i">+                        references: None,
</a><a href="#h68-0-71" id="h68-0-71" class="i">+                        index: false,
</a><a href="#h68-0-72" id="h68-0-72" class="i">+                    },
</a><a href="#h68-0-73" id="h68-0-73" class="i">+                    Column {
</a><a href="#h68-0-74" id="h68-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h68-0-75" id="h68-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h68-0-76" id="h68-0-76" class="i">+                        primary_key: false,
</a><a href="#h68-0-77" id="h68-0-77" class="i">+                        nullable: true,
</a><a href="#h68-0-78" id="h68-0-78" class="i">+                        default: Some(
</a><a href="#h68-0-79" id="h68-0-79" class="i">+                            Null,
</a><a href="#h68-0-80" id="h68-0-80" class="i">+                        ),
</a><a href="#h68-0-81" id="h68-0-81" class="i">+                        unique: false,
</a><a href="#h68-0-82" id="h68-0-82" class="i">+                        references: None,
</a><a href="#h68-0-83" id="h68-0-83" class="i">+                        index: false,
</a><a href="#h68-0-84" id="h68-0-84" class="i">+                    },
</a><a href="#h68-0-85" id="h68-0-85" class="i">+                ],
</a><a href="#h68-0-86" id="h68-0-86" class="i">+            },
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h68-1" id="h68-1" class="h">@@ -73,7 +155,31 @@ Plan: Select(
</a>         },
         left_size: 7,
         right: Scan {
<a href="#h68-1-3" id="h68-1-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h68-1-4" id="h68-1-4" class="i">+            table: Table {
</a><a href="#h68-1-5" id="h68-1-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h68-1-6" id="h68-1-6" class="i">+                columns: [
</a><a href="#h68-1-7" id="h68-1-7" class="i">+                    Column {
</a><a href="#h68-1-8" id="h68-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h68-1-9" id="h68-1-9" class="i">+                        datatype: Integer,
</a><a href="#h68-1-10" id="h68-1-10" class="i">+                        primary_key: true,
</a><a href="#h68-1-11" id="h68-1-11" class="i">+                        nullable: false,
</a><a href="#h68-1-12" id="h68-1-12" class="i">+                        default: None,
</a><a href="#h68-1-13" id="h68-1-13" class="i">+                        unique: true,
</a><a href="#h68-1-14" id="h68-1-14" class="i">+                        references: None,
</a><a href="#h68-1-15" id="h68-1-15" class="i">+                        index: false,
</a><a href="#h68-1-16" id="h68-1-16" class="i">+                    },
</a><a href="#h68-1-17" id="h68-1-17" class="i">+                    Column {
</a><a href="#h68-1-18" id="h68-1-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h68-1-19" id="h68-1-19" class="i">+                        datatype: String,
</a><a href="#h68-1-20" id="h68-1-20" class="i">+                        primary_key: false,
</a><a href="#h68-1-21" id="h68-1-21" class="i">+                        nullable: false,
</a><a href="#h68-1-22" id="h68-1-22" class="i">+                        default: None,
</a><a href="#h68-1-23" id="h68-1-23" class="i">+                        unique: false,
</a><a href="#h68-1-24" id="h68-1-24" class="i">+                        references: None,
</a><a href="#h68-1-25" id="h68-1-25" class="i">+                        index: false,
</a><a href="#h68-1-26" id="h68-1-26" class="i">+                    },
</a><a href="#h68-1-27" id="h68-1-27" class="i">+                ],
</a><a href="#h68-1-28" id="h68-1-28" class="i">+            },
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<a href="#h68-2" id="h68-2" class="h">@@ -112,7 +218,89 @@ Plan: Select(
</a> Optimized plan: Select(
     HashJoin {
         left: Scan {
<a href="#h68-2-3" id="h68-2-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h68-2-4" id="h68-2-4" class="i">+            table: Table {
</a><a href="#h68-2-5" id="h68-2-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h68-2-6" id="h68-2-6" class="i">+                columns: [
</a><a href="#h68-2-7" id="h68-2-7" class="i">+                    Column {
</a><a href="#h68-2-8" id="h68-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h68-2-9" id="h68-2-9" class="i">+                        datatype: Integer,
</a><a href="#h68-2-10" id="h68-2-10" class="i">+                        primary_key: true,
</a><a href="#h68-2-11" id="h68-2-11" class="i">+                        nullable: false,
</a><a href="#h68-2-12" id="h68-2-12" class="i">+                        default: None,
</a><a href="#h68-2-13" id="h68-2-13" class="i">+                        unique: true,
</a><a href="#h68-2-14" id="h68-2-14" class="i">+                        references: None,
</a><a href="#h68-2-15" id="h68-2-15" class="i">+                        index: false,
</a><a href="#h68-2-16" id="h68-2-16" class="i">+                    },
</a><a href="#h68-2-17" id="h68-2-17" class="i">+                    Column {
</a><a href="#h68-2-18" id="h68-2-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h68-2-19" id="h68-2-19" class="i">+                        datatype: String,
</a><a href="#h68-2-20" id="h68-2-20" class="i">+                        primary_key: false,
</a><a href="#h68-2-21" id="h68-2-21" class="i">+                        nullable: false,
</a><a href="#h68-2-22" id="h68-2-22" class="i">+                        default: None,
</a><a href="#h68-2-23" id="h68-2-23" class="i">+                        unique: false,
</a><a href="#h68-2-24" id="h68-2-24" class="i">+                        references: None,
</a><a href="#h68-2-25" id="h68-2-25" class="i">+                        index: false,
</a><a href="#h68-2-26" id="h68-2-26" class="i">+                    },
</a><a href="#h68-2-27" id="h68-2-27" class="i">+                    Column {
</a><a href="#h68-2-28" id="h68-2-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h68-2-29" id="h68-2-29" class="i">+                        datatype: Integer,
</a><a href="#h68-2-30" id="h68-2-30" class="i">+                        primary_key: false,
</a><a href="#h68-2-31" id="h68-2-31" class="i">+                        nullable: false,
</a><a href="#h68-2-32" id="h68-2-32" class="i">+                        default: None,
</a><a href="#h68-2-33" id="h68-2-33" class="i">+                        unique: false,
</a><a href="#h68-2-34" id="h68-2-34" class="i">+                        references: Some(
</a><a href="#h68-2-35" id="h68-2-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h68-2-36" id="h68-2-36" class="i">+                        ),
</a><a href="#h68-2-37" id="h68-2-37" class="i">+                        index: true,
</a><a href="#h68-2-38" id="h68-2-38" class="i">+                    },
</a><a href="#h68-2-39" id="h68-2-39" class="i">+                    Column {
</a><a href="#h68-2-40" id="h68-2-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h68-2-41" id="h68-2-41" class="i">+                        datatype: Integer,
</a><a href="#h68-2-42" id="h68-2-42" class="i">+                        primary_key: false,
</a><a href="#h68-2-43" id="h68-2-43" class="i">+                        nullable: false,
</a><a href="#h68-2-44" id="h68-2-44" class="i">+                        default: None,
</a><a href="#h68-2-45" id="h68-2-45" class="i">+                        unique: false,
</a><a href="#h68-2-46" id="h68-2-46" class="i">+                        references: Some(
</a><a href="#h68-2-47" id="h68-2-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h68-2-48" id="h68-2-48" class="i">+                        ),
</a><a href="#h68-2-49" id="h68-2-49" class="i">+                        index: true,
</a><a href="#h68-2-50" id="h68-2-50" class="i">+                    },
</a><a href="#h68-2-51" id="h68-2-51" class="i">+                    Column {
</a><a href="#h68-2-52" id="h68-2-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h68-2-53" id="h68-2-53" class="i">+                        datatype: Integer,
</a><a href="#h68-2-54" id="h68-2-54" class="i">+                        primary_key: false,
</a><a href="#h68-2-55" id="h68-2-55" class="i">+                        nullable: false,
</a><a href="#h68-2-56" id="h68-2-56" class="i">+                        default: None,
</a><a href="#h68-2-57" id="h68-2-57" class="i">+                        unique: false,
</a><a href="#h68-2-58" id="h68-2-58" class="i">+                        references: None,
</a><a href="#h68-2-59" id="h68-2-59" class="i">+                        index: false,
</a><a href="#h68-2-60" id="h68-2-60" class="i">+                    },
</a><a href="#h68-2-61" id="h68-2-61" class="i">+                    Column {
</a><a href="#h68-2-62" id="h68-2-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h68-2-63" id="h68-2-63" class="i">+                        datatype: Float,
</a><a href="#h68-2-64" id="h68-2-64" class="i">+                        primary_key: false,
</a><a href="#h68-2-65" id="h68-2-65" class="i">+                        nullable: true,
</a><a href="#h68-2-66" id="h68-2-66" class="i">+                        default: Some(
</a><a href="#h68-2-67" id="h68-2-67" class="i">+                            Null,
</a><a href="#h68-2-68" id="h68-2-68" class="i">+                        ),
</a><a href="#h68-2-69" id="h68-2-69" class="i">+                        unique: false,
</a><a href="#h68-2-70" id="h68-2-70" class="i">+                        references: None,
</a><a href="#h68-2-71" id="h68-2-71" class="i">+                        index: false,
</a><a href="#h68-2-72" id="h68-2-72" class="i">+                    },
</a><a href="#h68-2-73" id="h68-2-73" class="i">+                    Column {
</a><a href="#h68-2-74" id="h68-2-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h68-2-75" id="h68-2-75" class="i">+                        datatype: Boolean,
</a><a href="#h68-2-76" id="h68-2-76" class="i">+                        primary_key: false,
</a><a href="#h68-2-77" id="h68-2-77" class="i">+                        nullable: true,
</a><a href="#h68-2-78" id="h68-2-78" class="i">+                        default: Some(
</a><a href="#h68-2-79" id="h68-2-79" class="i">+                            Null,
</a><a href="#h68-2-80" id="h68-2-80" class="i">+                        ),
</a><a href="#h68-2-81" id="h68-2-81" class="i">+                        unique: false,
</a><a href="#h68-2-82" id="h68-2-82" class="i">+                        references: None,
</a><a href="#h68-2-83" id="h68-2-83" class="i">+                        index: false,
</a><a href="#h68-2-84" id="h68-2-84" class="i">+                    },
</a><a href="#h68-2-85" id="h68-2-85" class="i">+                ],
</a><a href="#h68-2-86" id="h68-2-86" class="i">+            },
</a>             alias: Some(
                 &quot;m&quot;,
             ),
<a href="#h68-3" id="h68-3" class="h">@@ -130,7 +318,31 @@ Optimized plan: Select(
</a>             ),
         ),
         right: Scan {
<a href="#h68-3-3" id="h68-3-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h68-3-4" id="h68-3-4" class="i">+            table: Table {
</a><a href="#h68-3-5" id="h68-3-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h68-3-6" id="h68-3-6" class="i">+                columns: [
</a><a href="#h68-3-7" id="h68-3-7" class="i">+                    Column {
</a><a href="#h68-3-8" id="h68-3-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h68-3-9" id="h68-3-9" class="i">+                        datatype: Integer,
</a><a href="#h68-3-10" id="h68-3-10" class="i">+                        primary_key: true,
</a><a href="#h68-3-11" id="h68-3-11" class="i">+                        nullable: false,
</a><a href="#h68-3-12" id="h68-3-12" class="i">+                        default: None,
</a><a href="#h68-3-13" id="h68-3-13" class="i">+                        unique: true,
</a><a href="#h68-3-14" id="h68-3-14" class="i">+                        references: None,
</a><a href="#h68-3-15" id="h68-3-15" class="i">+                        index: false,
</a><a href="#h68-3-16" id="h68-3-16" class="i">+                    },
</a><a href="#h68-3-17" id="h68-3-17" class="i">+                    Column {
</a><a href="#h68-3-18" id="h68-3-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h68-3-19" id="h68-3-19" class="i">+                        datatype: String,
</a><a href="#h68-3-20" id="h68-3-20" class="i">+                        primary_key: false,
</a><a href="#h68-3-21" id="h68-3-21" class="i">+                        nullable: false,
</a><a href="#h68-3-22" id="h68-3-22" class="i">+                        default: None,
</a><a href="#h68-3-23" id="h68-3-23" class="i">+                        unique: false,
</a><a href="#h68-3-24" id="h68-3-24" class="i">+                        references: None,
</a><a href="#h68-3-25" id="h68-3-25" class="i">+                        index: false,
</a><a href="#h68-3-26" id="h68-3-26" class="i">+                    },
</a><a href="#h68-3-27" id="h68-3-27" class="i">+                ],
</a><a href="#h68-3-28" id="h68-3-28" class="i">+            },
</a>             alias: Some(
                 &quot;g&quot;,
             ),
<b>diff --git a/<a id="h69" href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a> b/<a href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -90,7 +90,89 @@ Plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h69-0-3" id="h69-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h69-0-4" id="h69-0-4" class="i">+                table: Table {
</a><a href="#h69-0-5" id="h69-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h69-0-6" id="h69-0-6" class="i">+                    columns: [
</a><a href="#h69-0-7" id="h69-0-7" class="i">+                        Column {
</a><a href="#h69-0-8" id="h69-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h69-0-9" id="h69-0-9" class="i">+                            datatype: Integer,
</a><a href="#h69-0-10" id="h69-0-10" class="i">+                            primary_key: true,
</a><a href="#h69-0-11" id="h69-0-11" class="i">+                            nullable: false,
</a><a href="#h69-0-12" id="h69-0-12" class="i">+                            default: None,
</a><a href="#h69-0-13" id="h69-0-13" class="i">+                            unique: true,
</a><a href="#h69-0-14" id="h69-0-14" class="i">+                            references: None,
</a><a href="#h69-0-15" id="h69-0-15" class="i">+                            index: false,
</a><a href="#h69-0-16" id="h69-0-16" class="i">+                        },
</a><a href="#h69-0-17" id="h69-0-17" class="i">+                        Column {
</a><a href="#h69-0-18" id="h69-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h69-0-19" id="h69-0-19" class="i">+                            datatype: String,
</a><a href="#h69-0-20" id="h69-0-20" class="i">+                            primary_key: false,
</a><a href="#h69-0-21" id="h69-0-21" class="i">+                            nullable: false,
</a><a href="#h69-0-22" id="h69-0-22" class="i">+                            default: None,
</a><a href="#h69-0-23" id="h69-0-23" class="i">+                            unique: false,
</a><a href="#h69-0-24" id="h69-0-24" class="i">+                            references: None,
</a><a href="#h69-0-25" id="h69-0-25" class="i">+                            index: false,
</a><a href="#h69-0-26" id="h69-0-26" class="i">+                        },
</a><a href="#h69-0-27" id="h69-0-27" class="i">+                        Column {
</a><a href="#h69-0-28" id="h69-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h69-0-29" id="h69-0-29" class="i">+                            datatype: Integer,
</a><a href="#h69-0-30" id="h69-0-30" class="i">+                            primary_key: false,
</a><a href="#h69-0-31" id="h69-0-31" class="i">+                            nullable: false,
</a><a href="#h69-0-32" id="h69-0-32" class="i">+                            default: None,
</a><a href="#h69-0-33" id="h69-0-33" class="i">+                            unique: false,
</a><a href="#h69-0-34" id="h69-0-34" class="i">+                            references: Some(
</a><a href="#h69-0-35" id="h69-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h69-0-36" id="h69-0-36" class="i">+                            ),
</a><a href="#h69-0-37" id="h69-0-37" class="i">+                            index: true,
</a><a href="#h69-0-38" id="h69-0-38" class="i">+                        },
</a><a href="#h69-0-39" id="h69-0-39" class="i">+                        Column {
</a><a href="#h69-0-40" id="h69-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h69-0-41" id="h69-0-41" class="i">+                            datatype: Integer,
</a><a href="#h69-0-42" id="h69-0-42" class="i">+                            primary_key: false,
</a><a href="#h69-0-43" id="h69-0-43" class="i">+                            nullable: false,
</a><a href="#h69-0-44" id="h69-0-44" class="i">+                            default: None,
</a><a href="#h69-0-45" id="h69-0-45" class="i">+                            unique: false,
</a><a href="#h69-0-46" id="h69-0-46" class="i">+                            references: Some(
</a><a href="#h69-0-47" id="h69-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h69-0-48" id="h69-0-48" class="i">+                            ),
</a><a href="#h69-0-49" id="h69-0-49" class="i">+                            index: true,
</a><a href="#h69-0-50" id="h69-0-50" class="i">+                        },
</a><a href="#h69-0-51" id="h69-0-51" class="i">+                        Column {
</a><a href="#h69-0-52" id="h69-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h69-0-53" id="h69-0-53" class="i">+                            datatype: Integer,
</a><a href="#h69-0-54" id="h69-0-54" class="i">+                            primary_key: false,
</a><a href="#h69-0-55" id="h69-0-55" class="i">+                            nullable: false,
</a><a href="#h69-0-56" id="h69-0-56" class="i">+                            default: None,
</a><a href="#h69-0-57" id="h69-0-57" class="i">+                            unique: false,
</a><a href="#h69-0-58" id="h69-0-58" class="i">+                            references: None,
</a><a href="#h69-0-59" id="h69-0-59" class="i">+                            index: false,
</a><a href="#h69-0-60" id="h69-0-60" class="i">+                        },
</a><a href="#h69-0-61" id="h69-0-61" class="i">+                        Column {
</a><a href="#h69-0-62" id="h69-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h69-0-63" id="h69-0-63" class="i">+                            datatype: Float,
</a><a href="#h69-0-64" id="h69-0-64" class="i">+                            primary_key: false,
</a><a href="#h69-0-65" id="h69-0-65" class="i">+                            nullable: true,
</a><a href="#h69-0-66" id="h69-0-66" class="i">+                            default: Some(
</a><a href="#h69-0-67" id="h69-0-67" class="i">+                                Null,
</a><a href="#h69-0-68" id="h69-0-68" class="i">+                            ),
</a><a href="#h69-0-69" id="h69-0-69" class="i">+                            unique: false,
</a><a href="#h69-0-70" id="h69-0-70" class="i">+                            references: None,
</a><a href="#h69-0-71" id="h69-0-71" class="i">+                            index: false,
</a><a href="#h69-0-72" id="h69-0-72" class="i">+                        },
</a><a href="#h69-0-73" id="h69-0-73" class="i">+                        Column {
</a><a href="#h69-0-74" id="h69-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h69-0-75" id="h69-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h69-0-76" id="h69-0-76" class="i">+                            primary_key: false,
</a><a href="#h69-0-77" id="h69-0-77" class="i">+                            nullable: true,
</a><a href="#h69-0-78" id="h69-0-78" class="i">+                            default: Some(
</a><a href="#h69-0-79" id="h69-0-79" class="i">+                                Null,
</a><a href="#h69-0-80" id="h69-0-80" class="i">+                            ),
</a><a href="#h69-0-81" id="h69-0-81" class="i">+                            unique: false,
</a><a href="#h69-0-82" id="h69-0-82" class="i">+                            references: None,
</a><a href="#h69-0-83" id="h69-0-83" class="i">+                            index: false,
</a><a href="#h69-0-84" id="h69-0-84" class="i">+                        },
</a><a href="#h69-0-85" id="h69-0-85" class="i">+                    ],
</a><a href="#h69-0-86" id="h69-0-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h69-1" id="h69-1" class="h">@@ -98,7 +180,31 @@ Plan: Select(
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h69-1-3" id="h69-1-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h69-1-4" id="h69-1-4" class="i">+                table: Table {
</a><a href="#h69-1-5" id="h69-1-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h69-1-6" id="h69-1-6" class="i">+                    columns: [
</a><a href="#h69-1-7" id="h69-1-7" class="i">+                        Column {
</a><a href="#h69-1-8" id="h69-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h69-1-9" id="h69-1-9" class="i">+                            datatype: Integer,
</a><a href="#h69-1-10" id="h69-1-10" class="i">+                            primary_key: true,
</a><a href="#h69-1-11" id="h69-1-11" class="i">+                            nullable: false,
</a><a href="#h69-1-12" id="h69-1-12" class="i">+                            default: None,
</a><a href="#h69-1-13" id="h69-1-13" class="i">+                            unique: true,
</a><a href="#h69-1-14" id="h69-1-14" class="i">+                            references: None,
</a><a href="#h69-1-15" id="h69-1-15" class="i">+                            index: false,
</a><a href="#h69-1-16" id="h69-1-16" class="i">+                        },
</a><a href="#h69-1-17" id="h69-1-17" class="i">+                        Column {
</a><a href="#h69-1-18" id="h69-1-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h69-1-19" id="h69-1-19" class="i">+                            datatype: String,
</a><a href="#h69-1-20" id="h69-1-20" class="i">+                            primary_key: false,
</a><a href="#h69-1-21" id="h69-1-21" class="i">+                            nullable: false,
</a><a href="#h69-1-22" id="h69-1-22" class="i">+                            default: None,
</a><a href="#h69-1-23" id="h69-1-23" class="i">+                            unique: false,
</a><a href="#h69-1-24" id="h69-1-24" class="i">+                            references: None,
</a><a href="#h69-1-25" id="h69-1-25" class="i">+                            index: false,
</a><a href="#h69-1-26" id="h69-1-26" class="i">+                        },
</a><a href="#h69-1-27" id="h69-1-27" class="i">+                    ],
</a><a href="#h69-1-28" id="h69-1-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h69-2" id="h69-2" class="h">@@ -173,7 +279,89 @@ Optimized plan: Select(
</a>     Projection {
         source: HashJoin {
             left: Scan {
<a href="#h69-2-3" id="h69-2-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h69-2-4" id="h69-2-4" class="i">+                table: Table {
</a><a href="#h69-2-5" id="h69-2-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h69-2-6" id="h69-2-6" class="i">+                    columns: [
</a><a href="#h69-2-7" id="h69-2-7" class="i">+                        Column {
</a><a href="#h69-2-8" id="h69-2-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h69-2-9" id="h69-2-9" class="i">+                            datatype: Integer,
</a><a href="#h69-2-10" id="h69-2-10" class="i">+                            primary_key: true,
</a><a href="#h69-2-11" id="h69-2-11" class="i">+                            nullable: false,
</a><a href="#h69-2-12" id="h69-2-12" class="i">+                            default: None,
</a><a href="#h69-2-13" id="h69-2-13" class="i">+                            unique: true,
</a><a href="#h69-2-14" id="h69-2-14" class="i">+                            references: None,
</a><a href="#h69-2-15" id="h69-2-15" class="i">+                            index: false,
</a><a href="#h69-2-16" id="h69-2-16" class="i">+                        },
</a><a href="#h69-2-17" id="h69-2-17" class="i">+                        Column {
</a><a href="#h69-2-18" id="h69-2-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h69-2-19" id="h69-2-19" class="i">+                            datatype: String,
</a><a href="#h69-2-20" id="h69-2-20" class="i">+                            primary_key: false,
</a><a href="#h69-2-21" id="h69-2-21" class="i">+                            nullable: false,
</a><a href="#h69-2-22" id="h69-2-22" class="i">+                            default: None,
</a><a href="#h69-2-23" id="h69-2-23" class="i">+                            unique: false,
</a><a href="#h69-2-24" id="h69-2-24" class="i">+                            references: None,
</a><a href="#h69-2-25" id="h69-2-25" class="i">+                            index: false,
</a><a href="#h69-2-26" id="h69-2-26" class="i">+                        },
</a><a href="#h69-2-27" id="h69-2-27" class="i">+                        Column {
</a><a href="#h69-2-28" id="h69-2-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h69-2-29" id="h69-2-29" class="i">+                            datatype: Integer,
</a><a href="#h69-2-30" id="h69-2-30" class="i">+                            primary_key: false,
</a><a href="#h69-2-31" id="h69-2-31" class="i">+                            nullable: false,
</a><a href="#h69-2-32" id="h69-2-32" class="i">+                            default: None,
</a><a href="#h69-2-33" id="h69-2-33" class="i">+                            unique: false,
</a><a href="#h69-2-34" id="h69-2-34" class="i">+                            references: Some(
</a><a href="#h69-2-35" id="h69-2-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h69-2-36" id="h69-2-36" class="i">+                            ),
</a><a href="#h69-2-37" id="h69-2-37" class="i">+                            index: true,
</a><a href="#h69-2-38" id="h69-2-38" class="i">+                        },
</a><a href="#h69-2-39" id="h69-2-39" class="i">+                        Column {
</a><a href="#h69-2-40" id="h69-2-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h69-2-41" id="h69-2-41" class="i">+                            datatype: Integer,
</a><a href="#h69-2-42" id="h69-2-42" class="i">+                            primary_key: false,
</a><a href="#h69-2-43" id="h69-2-43" class="i">+                            nullable: false,
</a><a href="#h69-2-44" id="h69-2-44" class="i">+                            default: None,
</a><a href="#h69-2-45" id="h69-2-45" class="i">+                            unique: false,
</a><a href="#h69-2-46" id="h69-2-46" class="i">+                            references: Some(
</a><a href="#h69-2-47" id="h69-2-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h69-2-48" id="h69-2-48" class="i">+                            ),
</a><a href="#h69-2-49" id="h69-2-49" class="i">+                            index: true,
</a><a href="#h69-2-50" id="h69-2-50" class="i">+                        },
</a><a href="#h69-2-51" id="h69-2-51" class="i">+                        Column {
</a><a href="#h69-2-52" id="h69-2-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h69-2-53" id="h69-2-53" class="i">+                            datatype: Integer,
</a><a href="#h69-2-54" id="h69-2-54" class="i">+                            primary_key: false,
</a><a href="#h69-2-55" id="h69-2-55" class="i">+                            nullable: false,
</a><a href="#h69-2-56" id="h69-2-56" class="i">+                            default: None,
</a><a href="#h69-2-57" id="h69-2-57" class="i">+                            unique: false,
</a><a href="#h69-2-58" id="h69-2-58" class="i">+                            references: None,
</a><a href="#h69-2-59" id="h69-2-59" class="i">+                            index: false,
</a><a href="#h69-2-60" id="h69-2-60" class="i">+                        },
</a><a href="#h69-2-61" id="h69-2-61" class="i">+                        Column {
</a><a href="#h69-2-62" id="h69-2-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h69-2-63" id="h69-2-63" class="i">+                            datatype: Float,
</a><a href="#h69-2-64" id="h69-2-64" class="i">+                            primary_key: false,
</a><a href="#h69-2-65" id="h69-2-65" class="i">+                            nullable: true,
</a><a href="#h69-2-66" id="h69-2-66" class="i">+                            default: Some(
</a><a href="#h69-2-67" id="h69-2-67" class="i">+                                Null,
</a><a href="#h69-2-68" id="h69-2-68" class="i">+                            ),
</a><a href="#h69-2-69" id="h69-2-69" class="i">+                            unique: false,
</a><a href="#h69-2-70" id="h69-2-70" class="i">+                            references: None,
</a><a href="#h69-2-71" id="h69-2-71" class="i">+                            index: false,
</a><a href="#h69-2-72" id="h69-2-72" class="i">+                        },
</a><a href="#h69-2-73" id="h69-2-73" class="i">+                        Column {
</a><a href="#h69-2-74" id="h69-2-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h69-2-75" id="h69-2-75" class="i">+                            datatype: Boolean,
</a><a href="#h69-2-76" id="h69-2-76" class="i">+                            primary_key: false,
</a><a href="#h69-2-77" id="h69-2-77" class="i">+                            nullable: true,
</a><a href="#h69-2-78" id="h69-2-78" class="i">+                            default: Some(
</a><a href="#h69-2-79" id="h69-2-79" class="i">+                                Null,
</a><a href="#h69-2-80" id="h69-2-80" class="i">+                            ),
</a><a href="#h69-2-81" id="h69-2-81" class="i">+                            unique: false,
</a><a href="#h69-2-82" id="h69-2-82" class="i">+                            references: None,
</a><a href="#h69-2-83" id="h69-2-83" class="i">+                            index: false,
</a><a href="#h69-2-84" id="h69-2-84" class="i">+                        },
</a><a href="#h69-2-85" id="h69-2-85" class="i">+                    ],
</a><a href="#h69-2-86" id="h69-2-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h69-3" id="h69-3" class="h">@@ -191,7 +379,31 @@ Optimized plan: Select(
</a>                 ),
             ),
             right: Scan {
<a href="#h69-3-3" id="h69-3-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h69-3-4" id="h69-3-4" class="i">+                table: Table {
</a><a href="#h69-3-5" id="h69-3-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h69-3-6" id="h69-3-6" class="i">+                    columns: [
</a><a href="#h69-3-7" id="h69-3-7" class="i">+                        Column {
</a><a href="#h69-3-8" id="h69-3-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h69-3-9" id="h69-3-9" class="i">+                            datatype: Integer,
</a><a href="#h69-3-10" id="h69-3-10" class="i">+                            primary_key: true,
</a><a href="#h69-3-11" id="h69-3-11" class="i">+                            nullable: false,
</a><a href="#h69-3-12" id="h69-3-12" class="i">+                            default: None,
</a><a href="#h69-3-13" id="h69-3-13" class="i">+                            unique: true,
</a><a href="#h69-3-14" id="h69-3-14" class="i">+                            references: None,
</a><a href="#h69-3-15" id="h69-3-15" class="i">+                            index: false,
</a><a href="#h69-3-16" id="h69-3-16" class="i">+                        },
</a><a href="#h69-3-17" id="h69-3-17" class="i">+                        Column {
</a><a href="#h69-3-18" id="h69-3-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h69-3-19" id="h69-3-19" class="i">+                            datatype: String,
</a><a href="#h69-3-20" id="h69-3-20" class="i">+                            primary_key: false,
</a><a href="#h69-3-21" id="h69-3-21" class="i">+                            nullable: false,
</a><a href="#h69-3-22" id="h69-3-22" class="i">+                            default: None,
</a><a href="#h69-3-23" id="h69-3-23" class="i">+                            unique: false,
</a><a href="#h69-3-24" id="h69-3-24" class="i">+                            references: None,
</a><a href="#h69-3-25" id="h69-3-25" class="i">+                            index: false,
</a><a href="#h69-3-26" id="h69-3-26" class="i">+                        },
</a><a href="#h69-3-27" id="h69-3-27" class="i">+                    ],
</a><a href="#h69-3-28" id="h69-3-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<b>diff --git a/<a id="h70" href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a> b/<a href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -83,7 +83,31 @@ Plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h70-0-3" id="h70-0-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h70-0-4" id="h70-0-4" class="i">+                table: Table {
</a><a href="#h70-0-5" id="h70-0-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h70-0-6" id="h70-0-6" class="i">+                    columns: [
</a><a href="#h70-0-7" id="h70-0-7" class="i">+                        Column {
</a><a href="#h70-0-8" id="h70-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h70-0-9" id="h70-0-9" class="i">+                            datatype: Integer,
</a><a href="#h70-0-10" id="h70-0-10" class="i">+                            primary_key: true,
</a><a href="#h70-0-11" id="h70-0-11" class="i">+                            nullable: false,
</a><a href="#h70-0-12" id="h70-0-12" class="i">+                            default: None,
</a><a href="#h70-0-13" id="h70-0-13" class="i">+                            unique: true,
</a><a href="#h70-0-14" id="h70-0-14" class="i">+                            references: None,
</a><a href="#h70-0-15" id="h70-0-15" class="i">+                            index: false,
</a><a href="#h70-0-16" id="h70-0-16" class="i">+                        },
</a><a href="#h70-0-17" id="h70-0-17" class="i">+                        Column {
</a><a href="#h70-0-18" id="h70-0-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h70-0-19" id="h70-0-19" class="i">+                            datatype: String,
</a><a href="#h70-0-20" id="h70-0-20" class="i">+                            primary_key: false,
</a><a href="#h70-0-21" id="h70-0-21" class="i">+                            nullable: false,
</a><a href="#h70-0-22" id="h70-0-22" class="i">+                            default: None,
</a><a href="#h70-0-23" id="h70-0-23" class="i">+                            unique: false,
</a><a href="#h70-0-24" id="h70-0-24" class="i">+                            references: None,
</a><a href="#h70-0-25" id="h70-0-25" class="i">+                            index: false,
</a><a href="#h70-0-26" id="h70-0-26" class="i">+                        },
</a><a href="#h70-0-27" id="h70-0-27" class="i">+                    ],
</a><a href="#h70-0-28" id="h70-0-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h70-1" id="h70-1" class="h">@@ -91,7 +115,89 @@ Plan: Select(
</a>             },
             left_size: 2,
             right: Scan {
<a href="#h70-1-3" id="h70-1-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h70-1-4" id="h70-1-4" class="i">+                table: Table {
</a><a href="#h70-1-5" id="h70-1-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h70-1-6" id="h70-1-6" class="i">+                    columns: [
</a><a href="#h70-1-7" id="h70-1-7" class="i">+                        Column {
</a><a href="#h70-1-8" id="h70-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h70-1-9" id="h70-1-9" class="i">+                            datatype: Integer,
</a><a href="#h70-1-10" id="h70-1-10" class="i">+                            primary_key: true,
</a><a href="#h70-1-11" id="h70-1-11" class="i">+                            nullable: false,
</a><a href="#h70-1-12" id="h70-1-12" class="i">+                            default: None,
</a><a href="#h70-1-13" id="h70-1-13" class="i">+                            unique: true,
</a><a href="#h70-1-14" id="h70-1-14" class="i">+                            references: None,
</a><a href="#h70-1-15" id="h70-1-15" class="i">+                            index: false,
</a><a href="#h70-1-16" id="h70-1-16" class="i">+                        },
</a><a href="#h70-1-17" id="h70-1-17" class="i">+                        Column {
</a><a href="#h70-1-18" id="h70-1-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h70-1-19" id="h70-1-19" class="i">+                            datatype: String,
</a><a href="#h70-1-20" id="h70-1-20" class="i">+                            primary_key: false,
</a><a href="#h70-1-21" id="h70-1-21" class="i">+                            nullable: false,
</a><a href="#h70-1-22" id="h70-1-22" class="i">+                            default: None,
</a><a href="#h70-1-23" id="h70-1-23" class="i">+                            unique: false,
</a><a href="#h70-1-24" id="h70-1-24" class="i">+                            references: None,
</a><a href="#h70-1-25" id="h70-1-25" class="i">+                            index: false,
</a><a href="#h70-1-26" id="h70-1-26" class="i">+                        },
</a><a href="#h70-1-27" id="h70-1-27" class="i">+                        Column {
</a><a href="#h70-1-28" id="h70-1-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h70-1-29" id="h70-1-29" class="i">+                            datatype: Integer,
</a><a href="#h70-1-30" id="h70-1-30" class="i">+                            primary_key: false,
</a><a href="#h70-1-31" id="h70-1-31" class="i">+                            nullable: false,
</a><a href="#h70-1-32" id="h70-1-32" class="i">+                            default: None,
</a><a href="#h70-1-33" id="h70-1-33" class="i">+                            unique: false,
</a><a href="#h70-1-34" id="h70-1-34" class="i">+                            references: Some(
</a><a href="#h70-1-35" id="h70-1-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h70-1-36" id="h70-1-36" class="i">+                            ),
</a><a href="#h70-1-37" id="h70-1-37" class="i">+                            index: true,
</a><a href="#h70-1-38" id="h70-1-38" class="i">+                        },
</a><a href="#h70-1-39" id="h70-1-39" class="i">+                        Column {
</a><a href="#h70-1-40" id="h70-1-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h70-1-41" id="h70-1-41" class="i">+                            datatype: Integer,
</a><a href="#h70-1-42" id="h70-1-42" class="i">+                            primary_key: false,
</a><a href="#h70-1-43" id="h70-1-43" class="i">+                            nullable: false,
</a><a href="#h70-1-44" id="h70-1-44" class="i">+                            default: None,
</a><a href="#h70-1-45" id="h70-1-45" class="i">+                            unique: false,
</a><a href="#h70-1-46" id="h70-1-46" class="i">+                            references: Some(
</a><a href="#h70-1-47" id="h70-1-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h70-1-48" id="h70-1-48" class="i">+                            ),
</a><a href="#h70-1-49" id="h70-1-49" class="i">+                            index: true,
</a><a href="#h70-1-50" id="h70-1-50" class="i">+                        },
</a><a href="#h70-1-51" id="h70-1-51" class="i">+                        Column {
</a><a href="#h70-1-52" id="h70-1-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h70-1-53" id="h70-1-53" class="i">+                            datatype: Integer,
</a><a href="#h70-1-54" id="h70-1-54" class="i">+                            primary_key: false,
</a><a href="#h70-1-55" id="h70-1-55" class="i">+                            nullable: false,
</a><a href="#h70-1-56" id="h70-1-56" class="i">+                            default: None,
</a><a href="#h70-1-57" id="h70-1-57" class="i">+                            unique: false,
</a><a href="#h70-1-58" id="h70-1-58" class="i">+                            references: None,
</a><a href="#h70-1-59" id="h70-1-59" class="i">+                            index: false,
</a><a href="#h70-1-60" id="h70-1-60" class="i">+                        },
</a><a href="#h70-1-61" id="h70-1-61" class="i">+                        Column {
</a><a href="#h70-1-62" id="h70-1-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h70-1-63" id="h70-1-63" class="i">+                            datatype: Float,
</a><a href="#h70-1-64" id="h70-1-64" class="i">+                            primary_key: false,
</a><a href="#h70-1-65" id="h70-1-65" class="i">+                            nullable: true,
</a><a href="#h70-1-66" id="h70-1-66" class="i">+                            default: Some(
</a><a href="#h70-1-67" id="h70-1-67" class="i">+                                Null,
</a><a href="#h70-1-68" id="h70-1-68" class="i">+                            ),
</a><a href="#h70-1-69" id="h70-1-69" class="i">+                            unique: false,
</a><a href="#h70-1-70" id="h70-1-70" class="i">+                            references: None,
</a><a href="#h70-1-71" id="h70-1-71" class="i">+                            index: false,
</a><a href="#h70-1-72" id="h70-1-72" class="i">+                        },
</a><a href="#h70-1-73" id="h70-1-73" class="i">+                        Column {
</a><a href="#h70-1-74" id="h70-1-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h70-1-75" id="h70-1-75" class="i">+                            datatype: Boolean,
</a><a href="#h70-1-76" id="h70-1-76" class="i">+                            primary_key: false,
</a><a href="#h70-1-77" id="h70-1-77" class="i">+                            nullable: true,
</a><a href="#h70-1-78" id="h70-1-78" class="i">+                            default: Some(
</a><a href="#h70-1-79" id="h70-1-79" class="i">+                                Null,
</a><a href="#h70-1-80" id="h70-1-80" class="i">+                            ),
</a><a href="#h70-1-81" id="h70-1-81" class="i">+                            unique: false,
</a><a href="#h70-1-82" id="h70-1-82" class="i">+                            references: None,
</a><a href="#h70-1-83" id="h70-1-83" class="i">+                            index: false,
</a><a href="#h70-1-84" id="h70-1-84" class="i">+                        },
</a><a href="#h70-1-85" id="h70-1-85" class="i">+                    ],
</a><a href="#h70-1-86" id="h70-1-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h70-2" id="h70-2" class="h">@@ -166,7 +272,31 @@ Optimized plan: Select(
</a>     Projection {
         source: HashJoin {
             left: Scan {
<a href="#h70-2-3" id="h70-2-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h70-2-4" id="h70-2-4" class="i">+                table: Table {
</a><a href="#h70-2-5" id="h70-2-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h70-2-6" id="h70-2-6" class="i">+                    columns: [
</a><a href="#h70-2-7" id="h70-2-7" class="i">+                        Column {
</a><a href="#h70-2-8" id="h70-2-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h70-2-9" id="h70-2-9" class="i">+                            datatype: Integer,
</a><a href="#h70-2-10" id="h70-2-10" class="i">+                            primary_key: true,
</a><a href="#h70-2-11" id="h70-2-11" class="i">+                            nullable: false,
</a><a href="#h70-2-12" id="h70-2-12" class="i">+                            default: None,
</a><a href="#h70-2-13" id="h70-2-13" class="i">+                            unique: true,
</a><a href="#h70-2-14" id="h70-2-14" class="i">+                            references: None,
</a><a href="#h70-2-15" id="h70-2-15" class="i">+                            index: false,
</a><a href="#h70-2-16" id="h70-2-16" class="i">+                        },
</a><a href="#h70-2-17" id="h70-2-17" class="i">+                        Column {
</a><a href="#h70-2-18" id="h70-2-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h70-2-19" id="h70-2-19" class="i">+                            datatype: String,
</a><a href="#h70-2-20" id="h70-2-20" class="i">+                            primary_key: false,
</a><a href="#h70-2-21" id="h70-2-21" class="i">+                            nullable: false,
</a><a href="#h70-2-22" id="h70-2-22" class="i">+                            default: None,
</a><a href="#h70-2-23" id="h70-2-23" class="i">+                            unique: false,
</a><a href="#h70-2-24" id="h70-2-24" class="i">+                            references: None,
</a><a href="#h70-2-25" id="h70-2-25" class="i">+                            index: false,
</a><a href="#h70-2-26" id="h70-2-26" class="i">+                        },
</a><a href="#h70-2-27" id="h70-2-27" class="i">+                    ],
</a><a href="#h70-2-28" id="h70-2-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h70-3" id="h70-3" class="h">@@ -184,7 +314,89 @@ Optimized plan: Select(
</a>                 ),
             ),
             right: Scan {
<a href="#h70-3-3" id="h70-3-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h70-3-4" id="h70-3-4" class="i">+                table: Table {
</a><a href="#h70-3-5" id="h70-3-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h70-3-6" id="h70-3-6" class="i">+                    columns: [
</a><a href="#h70-3-7" id="h70-3-7" class="i">+                        Column {
</a><a href="#h70-3-8" id="h70-3-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h70-3-9" id="h70-3-9" class="i">+                            datatype: Integer,
</a><a href="#h70-3-10" id="h70-3-10" class="i">+                            primary_key: true,
</a><a href="#h70-3-11" id="h70-3-11" class="i">+                            nullable: false,
</a><a href="#h70-3-12" id="h70-3-12" class="i">+                            default: None,
</a><a href="#h70-3-13" id="h70-3-13" class="i">+                            unique: true,
</a><a href="#h70-3-14" id="h70-3-14" class="i">+                            references: None,
</a><a href="#h70-3-15" id="h70-3-15" class="i">+                            index: false,
</a><a href="#h70-3-16" id="h70-3-16" class="i">+                        },
</a><a href="#h70-3-17" id="h70-3-17" class="i">+                        Column {
</a><a href="#h70-3-18" id="h70-3-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h70-3-19" id="h70-3-19" class="i">+                            datatype: String,
</a><a href="#h70-3-20" id="h70-3-20" class="i">+                            primary_key: false,
</a><a href="#h70-3-21" id="h70-3-21" class="i">+                            nullable: false,
</a><a href="#h70-3-22" id="h70-3-22" class="i">+                            default: None,
</a><a href="#h70-3-23" id="h70-3-23" class="i">+                            unique: false,
</a><a href="#h70-3-24" id="h70-3-24" class="i">+                            references: None,
</a><a href="#h70-3-25" id="h70-3-25" class="i">+                            index: false,
</a><a href="#h70-3-26" id="h70-3-26" class="i">+                        },
</a><a href="#h70-3-27" id="h70-3-27" class="i">+                        Column {
</a><a href="#h70-3-28" id="h70-3-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h70-3-29" id="h70-3-29" class="i">+                            datatype: Integer,
</a><a href="#h70-3-30" id="h70-3-30" class="i">+                            primary_key: false,
</a><a href="#h70-3-31" id="h70-3-31" class="i">+                            nullable: false,
</a><a href="#h70-3-32" id="h70-3-32" class="i">+                            default: None,
</a><a href="#h70-3-33" id="h70-3-33" class="i">+                            unique: false,
</a><a href="#h70-3-34" id="h70-3-34" class="i">+                            references: Some(
</a><a href="#h70-3-35" id="h70-3-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h70-3-36" id="h70-3-36" class="i">+                            ),
</a><a href="#h70-3-37" id="h70-3-37" class="i">+                            index: true,
</a><a href="#h70-3-38" id="h70-3-38" class="i">+                        },
</a><a href="#h70-3-39" id="h70-3-39" class="i">+                        Column {
</a><a href="#h70-3-40" id="h70-3-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h70-3-41" id="h70-3-41" class="i">+                            datatype: Integer,
</a><a href="#h70-3-42" id="h70-3-42" class="i">+                            primary_key: false,
</a><a href="#h70-3-43" id="h70-3-43" class="i">+                            nullable: false,
</a><a href="#h70-3-44" id="h70-3-44" class="i">+                            default: None,
</a><a href="#h70-3-45" id="h70-3-45" class="i">+                            unique: false,
</a><a href="#h70-3-46" id="h70-3-46" class="i">+                            references: Some(
</a><a href="#h70-3-47" id="h70-3-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h70-3-48" id="h70-3-48" class="i">+                            ),
</a><a href="#h70-3-49" id="h70-3-49" class="i">+                            index: true,
</a><a href="#h70-3-50" id="h70-3-50" class="i">+                        },
</a><a href="#h70-3-51" id="h70-3-51" class="i">+                        Column {
</a><a href="#h70-3-52" id="h70-3-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h70-3-53" id="h70-3-53" class="i">+                            datatype: Integer,
</a><a href="#h70-3-54" id="h70-3-54" class="i">+                            primary_key: false,
</a><a href="#h70-3-55" id="h70-3-55" class="i">+                            nullable: false,
</a><a href="#h70-3-56" id="h70-3-56" class="i">+                            default: None,
</a><a href="#h70-3-57" id="h70-3-57" class="i">+                            unique: false,
</a><a href="#h70-3-58" id="h70-3-58" class="i">+                            references: None,
</a><a href="#h70-3-59" id="h70-3-59" class="i">+                            index: false,
</a><a href="#h70-3-60" id="h70-3-60" class="i">+                        },
</a><a href="#h70-3-61" id="h70-3-61" class="i">+                        Column {
</a><a href="#h70-3-62" id="h70-3-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h70-3-63" id="h70-3-63" class="i">+                            datatype: Float,
</a><a href="#h70-3-64" id="h70-3-64" class="i">+                            primary_key: false,
</a><a href="#h70-3-65" id="h70-3-65" class="i">+                            nullable: true,
</a><a href="#h70-3-66" id="h70-3-66" class="i">+                            default: Some(
</a><a href="#h70-3-67" id="h70-3-67" class="i">+                                Null,
</a><a href="#h70-3-68" id="h70-3-68" class="i">+                            ),
</a><a href="#h70-3-69" id="h70-3-69" class="i">+                            unique: false,
</a><a href="#h70-3-70" id="h70-3-70" class="i">+                            references: None,
</a><a href="#h70-3-71" id="h70-3-71" class="i">+                            index: false,
</a><a href="#h70-3-72" id="h70-3-72" class="i">+                        },
</a><a href="#h70-3-73" id="h70-3-73" class="i">+                        Column {
</a><a href="#h70-3-74" id="h70-3-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h70-3-75" id="h70-3-75" class="i">+                            datatype: Boolean,
</a><a href="#h70-3-76" id="h70-3-76" class="i">+                            primary_key: false,
</a><a href="#h70-3-77" id="h70-3-77" class="i">+                            nullable: true,
</a><a href="#h70-3-78" id="h70-3-78" class="i">+                            default: Some(
</a><a href="#h70-3-79" id="h70-3-79" class="i">+                                Null,
</a><a href="#h70-3-80" id="h70-3-80" class="i">+                            ),
</a><a href="#h70-3-81" id="h70-3-81" class="i">+                            unique: false,
</a><a href="#h70-3-82" id="h70-3-82" class="i">+                            references: None,
</a><a href="#h70-3-83" id="h70-3-83" class="i">+                            index: false,
</a><a href="#h70-3-84" id="h70-3-84" class="i">+                        },
</a><a href="#h70-3-85" id="h70-3-85" class="i">+                    ],
</a><a href="#h70-3-86" id="h70-3-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<b>diff --git a/<a id="h71" href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a> b/<a href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -92,7 +92,89 @@ Plan: Select(
</a>         source: Projection {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h71-0-3" id="h71-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h71-0-4" id="h71-0-4" class="i">+                    table: Table {
</a><a href="#h71-0-5" id="h71-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h71-0-6" id="h71-0-6" class="i">+                        columns: [
</a><a href="#h71-0-7" id="h71-0-7" class="i">+                            Column {
</a><a href="#h71-0-8" id="h71-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h71-0-9" id="h71-0-9" class="i">+                                datatype: Integer,
</a><a href="#h71-0-10" id="h71-0-10" class="i">+                                primary_key: true,
</a><a href="#h71-0-11" id="h71-0-11" class="i">+                                nullable: false,
</a><a href="#h71-0-12" id="h71-0-12" class="i">+                                default: None,
</a><a href="#h71-0-13" id="h71-0-13" class="i">+                                unique: true,
</a><a href="#h71-0-14" id="h71-0-14" class="i">+                                references: None,
</a><a href="#h71-0-15" id="h71-0-15" class="i">+                                index: false,
</a><a href="#h71-0-16" id="h71-0-16" class="i">+                            },
</a><a href="#h71-0-17" id="h71-0-17" class="i">+                            Column {
</a><a href="#h71-0-18" id="h71-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h71-0-19" id="h71-0-19" class="i">+                                datatype: String,
</a><a href="#h71-0-20" id="h71-0-20" class="i">+                                primary_key: false,
</a><a href="#h71-0-21" id="h71-0-21" class="i">+                                nullable: false,
</a><a href="#h71-0-22" id="h71-0-22" class="i">+                                default: None,
</a><a href="#h71-0-23" id="h71-0-23" class="i">+                                unique: false,
</a><a href="#h71-0-24" id="h71-0-24" class="i">+                                references: None,
</a><a href="#h71-0-25" id="h71-0-25" class="i">+                                index: false,
</a><a href="#h71-0-26" id="h71-0-26" class="i">+                            },
</a><a href="#h71-0-27" id="h71-0-27" class="i">+                            Column {
</a><a href="#h71-0-28" id="h71-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h71-0-29" id="h71-0-29" class="i">+                                datatype: Integer,
</a><a href="#h71-0-30" id="h71-0-30" class="i">+                                primary_key: false,
</a><a href="#h71-0-31" id="h71-0-31" class="i">+                                nullable: false,
</a><a href="#h71-0-32" id="h71-0-32" class="i">+                                default: None,
</a><a href="#h71-0-33" id="h71-0-33" class="i">+                                unique: false,
</a><a href="#h71-0-34" id="h71-0-34" class="i">+                                references: Some(
</a><a href="#h71-0-35" id="h71-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h71-0-36" id="h71-0-36" class="i">+                                ),
</a><a href="#h71-0-37" id="h71-0-37" class="i">+                                index: true,
</a><a href="#h71-0-38" id="h71-0-38" class="i">+                            },
</a><a href="#h71-0-39" id="h71-0-39" class="i">+                            Column {
</a><a href="#h71-0-40" id="h71-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h71-0-41" id="h71-0-41" class="i">+                                datatype: Integer,
</a><a href="#h71-0-42" id="h71-0-42" class="i">+                                primary_key: false,
</a><a href="#h71-0-43" id="h71-0-43" class="i">+                                nullable: false,
</a><a href="#h71-0-44" id="h71-0-44" class="i">+                                default: None,
</a><a href="#h71-0-45" id="h71-0-45" class="i">+                                unique: false,
</a><a href="#h71-0-46" id="h71-0-46" class="i">+                                references: Some(
</a><a href="#h71-0-47" id="h71-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h71-0-48" id="h71-0-48" class="i">+                                ),
</a><a href="#h71-0-49" id="h71-0-49" class="i">+                                index: true,
</a><a href="#h71-0-50" id="h71-0-50" class="i">+                            },
</a><a href="#h71-0-51" id="h71-0-51" class="i">+                            Column {
</a><a href="#h71-0-52" id="h71-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h71-0-53" id="h71-0-53" class="i">+                                datatype: Integer,
</a><a href="#h71-0-54" id="h71-0-54" class="i">+                                primary_key: false,
</a><a href="#h71-0-55" id="h71-0-55" class="i">+                                nullable: false,
</a><a href="#h71-0-56" id="h71-0-56" class="i">+                                default: None,
</a><a href="#h71-0-57" id="h71-0-57" class="i">+                                unique: false,
</a><a href="#h71-0-58" id="h71-0-58" class="i">+                                references: None,
</a><a href="#h71-0-59" id="h71-0-59" class="i">+                                index: false,
</a><a href="#h71-0-60" id="h71-0-60" class="i">+                            },
</a><a href="#h71-0-61" id="h71-0-61" class="i">+                            Column {
</a><a href="#h71-0-62" id="h71-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h71-0-63" id="h71-0-63" class="i">+                                datatype: Float,
</a><a href="#h71-0-64" id="h71-0-64" class="i">+                                primary_key: false,
</a><a href="#h71-0-65" id="h71-0-65" class="i">+                                nullable: true,
</a><a href="#h71-0-66" id="h71-0-66" class="i">+                                default: Some(
</a><a href="#h71-0-67" id="h71-0-67" class="i">+                                    Null,
</a><a href="#h71-0-68" id="h71-0-68" class="i">+                                ),
</a><a href="#h71-0-69" id="h71-0-69" class="i">+                                unique: false,
</a><a href="#h71-0-70" id="h71-0-70" class="i">+                                references: None,
</a><a href="#h71-0-71" id="h71-0-71" class="i">+                                index: false,
</a><a href="#h71-0-72" id="h71-0-72" class="i">+                            },
</a><a href="#h71-0-73" id="h71-0-73" class="i">+                            Column {
</a><a href="#h71-0-74" id="h71-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h71-0-75" id="h71-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h71-0-76" id="h71-0-76" class="i">+                                primary_key: false,
</a><a href="#h71-0-77" id="h71-0-77" class="i">+                                nullable: true,
</a><a href="#h71-0-78" id="h71-0-78" class="i">+                                default: Some(
</a><a href="#h71-0-79" id="h71-0-79" class="i">+                                    Null,
</a><a href="#h71-0-80" id="h71-0-80" class="i">+                                ),
</a><a href="#h71-0-81" id="h71-0-81" class="i">+                                unique: false,
</a><a href="#h71-0-82" id="h71-0-82" class="i">+                                references: None,
</a><a href="#h71-0-83" id="h71-0-83" class="i">+                                index: false,
</a><a href="#h71-0-84" id="h71-0-84" class="i">+                            },
</a><a href="#h71-0-85" id="h71-0-85" class="i">+                        ],
</a><a href="#h71-0-86" id="h71-0-86" class="i">+                    },
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h71-1" id="h71-1" class="h">@@ -100,7 +182,31 @@ Plan: Select(
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h71-1-3" id="h71-1-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h71-1-4" id="h71-1-4" class="i">+                    table: Table {
</a><a href="#h71-1-5" id="h71-1-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h71-1-6" id="h71-1-6" class="i">+                        columns: [
</a><a href="#h71-1-7" id="h71-1-7" class="i">+                            Column {
</a><a href="#h71-1-8" id="h71-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h71-1-9" id="h71-1-9" class="i">+                                datatype: Integer,
</a><a href="#h71-1-10" id="h71-1-10" class="i">+                                primary_key: true,
</a><a href="#h71-1-11" id="h71-1-11" class="i">+                                nullable: false,
</a><a href="#h71-1-12" id="h71-1-12" class="i">+                                default: None,
</a><a href="#h71-1-13" id="h71-1-13" class="i">+                                unique: true,
</a><a href="#h71-1-14" id="h71-1-14" class="i">+                                references: None,
</a><a href="#h71-1-15" id="h71-1-15" class="i">+                                index: false,
</a><a href="#h71-1-16" id="h71-1-16" class="i">+                            },
</a><a href="#h71-1-17" id="h71-1-17" class="i">+                            Column {
</a><a href="#h71-1-18" id="h71-1-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h71-1-19" id="h71-1-19" class="i">+                                datatype: String,
</a><a href="#h71-1-20" id="h71-1-20" class="i">+                                primary_key: false,
</a><a href="#h71-1-21" id="h71-1-21" class="i">+                                nullable: false,
</a><a href="#h71-1-22" id="h71-1-22" class="i">+                                default: None,
</a><a href="#h71-1-23" id="h71-1-23" class="i">+                                unique: false,
</a><a href="#h71-1-24" id="h71-1-24" class="i">+                                references: None,
</a><a href="#h71-1-25" id="h71-1-25" class="i">+                                index: false,
</a><a href="#h71-1-26" id="h71-1-26" class="i">+                            },
</a><a href="#h71-1-27" id="h71-1-27" class="i">+                        ],
</a><a href="#h71-1-28" id="h71-1-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h71-2" id="h71-2" class="h">@@ -305,7 +411,89 @@ Optimized plan: Select(
</a>         source: Projection {
             source: HashJoin {
                 left: Scan {
<a href="#h71-2-3" id="h71-2-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h71-2-4" id="h71-2-4" class="i">+                    table: Table {
</a><a href="#h71-2-5" id="h71-2-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h71-2-6" id="h71-2-6" class="i">+                        columns: [
</a><a href="#h71-2-7" id="h71-2-7" class="i">+                            Column {
</a><a href="#h71-2-8" id="h71-2-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h71-2-9" id="h71-2-9" class="i">+                                datatype: Integer,
</a><a href="#h71-2-10" id="h71-2-10" class="i">+                                primary_key: true,
</a><a href="#h71-2-11" id="h71-2-11" class="i">+                                nullable: false,
</a><a href="#h71-2-12" id="h71-2-12" class="i">+                                default: None,
</a><a href="#h71-2-13" id="h71-2-13" class="i">+                                unique: true,
</a><a href="#h71-2-14" id="h71-2-14" class="i">+                                references: None,
</a><a href="#h71-2-15" id="h71-2-15" class="i">+                                index: false,
</a><a href="#h71-2-16" id="h71-2-16" class="i">+                            },
</a><a href="#h71-2-17" id="h71-2-17" class="i">+                            Column {
</a><a href="#h71-2-18" id="h71-2-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h71-2-19" id="h71-2-19" class="i">+                                datatype: String,
</a><a href="#h71-2-20" id="h71-2-20" class="i">+                                primary_key: false,
</a><a href="#h71-2-21" id="h71-2-21" class="i">+                                nullable: false,
</a><a href="#h71-2-22" id="h71-2-22" class="i">+                                default: None,
</a><a href="#h71-2-23" id="h71-2-23" class="i">+                                unique: false,
</a><a href="#h71-2-24" id="h71-2-24" class="i">+                                references: None,
</a><a href="#h71-2-25" id="h71-2-25" class="i">+                                index: false,
</a><a href="#h71-2-26" id="h71-2-26" class="i">+                            },
</a><a href="#h71-2-27" id="h71-2-27" class="i">+                            Column {
</a><a href="#h71-2-28" id="h71-2-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h71-2-29" id="h71-2-29" class="i">+                                datatype: Integer,
</a><a href="#h71-2-30" id="h71-2-30" class="i">+                                primary_key: false,
</a><a href="#h71-2-31" id="h71-2-31" class="i">+                                nullable: false,
</a><a href="#h71-2-32" id="h71-2-32" class="i">+                                default: None,
</a><a href="#h71-2-33" id="h71-2-33" class="i">+                                unique: false,
</a><a href="#h71-2-34" id="h71-2-34" class="i">+                                references: Some(
</a><a href="#h71-2-35" id="h71-2-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h71-2-36" id="h71-2-36" class="i">+                                ),
</a><a href="#h71-2-37" id="h71-2-37" class="i">+                                index: true,
</a><a href="#h71-2-38" id="h71-2-38" class="i">+                            },
</a><a href="#h71-2-39" id="h71-2-39" class="i">+                            Column {
</a><a href="#h71-2-40" id="h71-2-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h71-2-41" id="h71-2-41" class="i">+                                datatype: Integer,
</a><a href="#h71-2-42" id="h71-2-42" class="i">+                                primary_key: false,
</a><a href="#h71-2-43" id="h71-2-43" class="i">+                                nullable: false,
</a><a href="#h71-2-44" id="h71-2-44" class="i">+                                default: None,
</a><a href="#h71-2-45" id="h71-2-45" class="i">+                                unique: false,
</a><a href="#h71-2-46" id="h71-2-46" class="i">+                                references: Some(
</a><a href="#h71-2-47" id="h71-2-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h71-2-48" id="h71-2-48" class="i">+                                ),
</a><a href="#h71-2-49" id="h71-2-49" class="i">+                                index: true,
</a><a href="#h71-2-50" id="h71-2-50" class="i">+                            },
</a><a href="#h71-2-51" id="h71-2-51" class="i">+                            Column {
</a><a href="#h71-2-52" id="h71-2-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h71-2-53" id="h71-2-53" class="i">+                                datatype: Integer,
</a><a href="#h71-2-54" id="h71-2-54" class="i">+                                primary_key: false,
</a><a href="#h71-2-55" id="h71-2-55" class="i">+                                nullable: false,
</a><a href="#h71-2-56" id="h71-2-56" class="i">+                                default: None,
</a><a href="#h71-2-57" id="h71-2-57" class="i">+                                unique: false,
</a><a href="#h71-2-58" id="h71-2-58" class="i">+                                references: None,
</a><a href="#h71-2-59" id="h71-2-59" class="i">+                                index: false,
</a><a href="#h71-2-60" id="h71-2-60" class="i">+                            },
</a><a href="#h71-2-61" id="h71-2-61" class="i">+                            Column {
</a><a href="#h71-2-62" id="h71-2-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h71-2-63" id="h71-2-63" class="i">+                                datatype: Float,
</a><a href="#h71-2-64" id="h71-2-64" class="i">+                                primary_key: false,
</a><a href="#h71-2-65" id="h71-2-65" class="i">+                                nullable: true,
</a><a href="#h71-2-66" id="h71-2-66" class="i">+                                default: Some(
</a><a href="#h71-2-67" id="h71-2-67" class="i">+                                    Null,
</a><a href="#h71-2-68" id="h71-2-68" class="i">+                                ),
</a><a href="#h71-2-69" id="h71-2-69" class="i">+                                unique: false,
</a><a href="#h71-2-70" id="h71-2-70" class="i">+                                references: None,
</a><a href="#h71-2-71" id="h71-2-71" class="i">+                                index: false,
</a><a href="#h71-2-72" id="h71-2-72" class="i">+                            },
</a><a href="#h71-2-73" id="h71-2-73" class="i">+                            Column {
</a><a href="#h71-2-74" id="h71-2-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h71-2-75" id="h71-2-75" class="i">+                                datatype: Boolean,
</a><a href="#h71-2-76" id="h71-2-76" class="i">+                                primary_key: false,
</a><a href="#h71-2-77" id="h71-2-77" class="i">+                                nullable: true,
</a><a href="#h71-2-78" id="h71-2-78" class="i">+                                default: Some(
</a><a href="#h71-2-79" id="h71-2-79" class="i">+                                    Null,
</a><a href="#h71-2-80" id="h71-2-80" class="i">+                                ),
</a><a href="#h71-2-81" id="h71-2-81" class="i">+                                unique: false,
</a><a href="#h71-2-82" id="h71-2-82" class="i">+                                references: None,
</a><a href="#h71-2-83" id="h71-2-83" class="i">+                                index: false,
</a><a href="#h71-2-84" id="h71-2-84" class="i">+                            },
</a><a href="#h71-2-85" id="h71-2-85" class="i">+                        ],
</a><a href="#h71-2-86" id="h71-2-86" class="i">+                    },
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h71-3" id="h71-3" class="h">@@ -323,7 +511,31 @@ Optimized plan: Select(
</a>                     ),
                 ),
                 right: Scan {
<a href="#h71-3-3" id="h71-3-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h71-3-4" id="h71-3-4" class="i">+                    table: Table {
</a><a href="#h71-3-5" id="h71-3-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h71-3-6" id="h71-3-6" class="i">+                        columns: [
</a><a href="#h71-3-7" id="h71-3-7" class="i">+                            Column {
</a><a href="#h71-3-8" id="h71-3-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h71-3-9" id="h71-3-9" class="i">+                                datatype: Integer,
</a><a href="#h71-3-10" id="h71-3-10" class="i">+                                primary_key: true,
</a><a href="#h71-3-11" id="h71-3-11" class="i">+                                nullable: false,
</a><a href="#h71-3-12" id="h71-3-12" class="i">+                                default: None,
</a><a href="#h71-3-13" id="h71-3-13" class="i">+                                unique: true,
</a><a href="#h71-3-14" id="h71-3-14" class="i">+                                references: None,
</a><a href="#h71-3-15" id="h71-3-15" class="i">+                                index: false,
</a><a href="#h71-3-16" id="h71-3-16" class="i">+                            },
</a><a href="#h71-3-17" id="h71-3-17" class="i">+                            Column {
</a><a href="#h71-3-18" id="h71-3-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h71-3-19" id="h71-3-19" class="i">+                                datatype: String,
</a><a href="#h71-3-20" id="h71-3-20" class="i">+                                primary_key: false,
</a><a href="#h71-3-21" id="h71-3-21" class="i">+                                nullable: false,
</a><a href="#h71-3-22" id="h71-3-22" class="i">+                                default: None,
</a><a href="#h71-3-23" id="h71-3-23" class="i">+                                unique: false,
</a><a href="#h71-3-24" id="h71-3-24" class="i">+                                references: None,
</a><a href="#h71-3-25" id="h71-3-25" class="i">+                                index: false,
</a><a href="#h71-3-26" id="h71-3-26" class="i">+                            },
</a><a href="#h71-3-27" id="h71-3-27" class="i">+                        ],
</a><a href="#h71-3-28" id="h71-3-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<b>diff --git a/<a id="h72" href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a> b/<a href="../file/tests/sql/query/join_right_all.html">tests/sql/query/join_right_all</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -67,7 +67,89 @@ Plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h72-0-3" id="h72-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h72-0-4" id="h72-0-4" class="i">+                table: Table {
</a><a href="#h72-0-5" id="h72-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h72-0-6" id="h72-0-6" class="i">+                    columns: [
</a><a href="#h72-0-7" id="h72-0-7" class="i">+                        Column {
</a><a href="#h72-0-8" id="h72-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h72-0-9" id="h72-0-9" class="i">+                            datatype: Integer,
</a><a href="#h72-0-10" id="h72-0-10" class="i">+                            primary_key: true,
</a><a href="#h72-0-11" id="h72-0-11" class="i">+                            nullable: false,
</a><a href="#h72-0-12" id="h72-0-12" class="i">+                            default: None,
</a><a href="#h72-0-13" id="h72-0-13" class="i">+                            unique: true,
</a><a href="#h72-0-14" id="h72-0-14" class="i">+                            references: None,
</a><a href="#h72-0-15" id="h72-0-15" class="i">+                            index: false,
</a><a href="#h72-0-16" id="h72-0-16" class="i">+                        },
</a><a href="#h72-0-17" id="h72-0-17" class="i">+                        Column {
</a><a href="#h72-0-18" id="h72-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h72-0-19" id="h72-0-19" class="i">+                            datatype: String,
</a><a href="#h72-0-20" id="h72-0-20" class="i">+                            primary_key: false,
</a><a href="#h72-0-21" id="h72-0-21" class="i">+                            nullable: false,
</a><a href="#h72-0-22" id="h72-0-22" class="i">+                            default: None,
</a><a href="#h72-0-23" id="h72-0-23" class="i">+                            unique: false,
</a><a href="#h72-0-24" id="h72-0-24" class="i">+                            references: None,
</a><a href="#h72-0-25" id="h72-0-25" class="i">+                            index: false,
</a><a href="#h72-0-26" id="h72-0-26" class="i">+                        },
</a><a href="#h72-0-27" id="h72-0-27" class="i">+                        Column {
</a><a href="#h72-0-28" id="h72-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h72-0-29" id="h72-0-29" class="i">+                            datatype: Integer,
</a><a href="#h72-0-30" id="h72-0-30" class="i">+                            primary_key: false,
</a><a href="#h72-0-31" id="h72-0-31" class="i">+                            nullable: false,
</a><a href="#h72-0-32" id="h72-0-32" class="i">+                            default: None,
</a><a href="#h72-0-33" id="h72-0-33" class="i">+                            unique: false,
</a><a href="#h72-0-34" id="h72-0-34" class="i">+                            references: Some(
</a><a href="#h72-0-35" id="h72-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h72-0-36" id="h72-0-36" class="i">+                            ),
</a><a href="#h72-0-37" id="h72-0-37" class="i">+                            index: true,
</a><a href="#h72-0-38" id="h72-0-38" class="i">+                        },
</a><a href="#h72-0-39" id="h72-0-39" class="i">+                        Column {
</a><a href="#h72-0-40" id="h72-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h72-0-41" id="h72-0-41" class="i">+                            datatype: Integer,
</a><a href="#h72-0-42" id="h72-0-42" class="i">+                            primary_key: false,
</a><a href="#h72-0-43" id="h72-0-43" class="i">+                            nullable: false,
</a><a href="#h72-0-44" id="h72-0-44" class="i">+                            default: None,
</a><a href="#h72-0-45" id="h72-0-45" class="i">+                            unique: false,
</a><a href="#h72-0-46" id="h72-0-46" class="i">+                            references: Some(
</a><a href="#h72-0-47" id="h72-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h72-0-48" id="h72-0-48" class="i">+                            ),
</a><a href="#h72-0-49" id="h72-0-49" class="i">+                            index: true,
</a><a href="#h72-0-50" id="h72-0-50" class="i">+                        },
</a><a href="#h72-0-51" id="h72-0-51" class="i">+                        Column {
</a><a href="#h72-0-52" id="h72-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h72-0-53" id="h72-0-53" class="i">+                            datatype: Integer,
</a><a href="#h72-0-54" id="h72-0-54" class="i">+                            primary_key: false,
</a><a href="#h72-0-55" id="h72-0-55" class="i">+                            nullable: false,
</a><a href="#h72-0-56" id="h72-0-56" class="i">+                            default: None,
</a><a href="#h72-0-57" id="h72-0-57" class="i">+                            unique: false,
</a><a href="#h72-0-58" id="h72-0-58" class="i">+                            references: None,
</a><a href="#h72-0-59" id="h72-0-59" class="i">+                            index: false,
</a><a href="#h72-0-60" id="h72-0-60" class="i">+                        },
</a><a href="#h72-0-61" id="h72-0-61" class="i">+                        Column {
</a><a href="#h72-0-62" id="h72-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h72-0-63" id="h72-0-63" class="i">+                            datatype: Float,
</a><a href="#h72-0-64" id="h72-0-64" class="i">+                            primary_key: false,
</a><a href="#h72-0-65" id="h72-0-65" class="i">+                            nullable: true,
</a><a href="#h72-0-66" id="h72-0-66" class="i">+                            default: Some(
</a><a href="#h72-0-67" id="h72-0-67" class="i">+                                Null,
</a><a href="#h72-0-68" id="h72-0-68" class="i">+                            ),
</a><a href="#h72-0-69" id="h72-0-69" class="i">+                            unique: false,
</a><a href="#h72-0-70" id="h72-0-70" class="i">+                            references: None,
</a><a href="#h72-0-71" id="h72-0-71" class="i">+                            index: false,
</a><a href="#h72-0-72" id="h72-0-72" class="i">+                        },
</a><a href="#h72-0-73" id="h72-0-73" class="i">+                        Column {
</a><a href="#h72-0-74" id="h72-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h72-0-75" id="h72-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h72-0-76" id="h72-0-76" class="i">+                            primary_key: false,
</a><a href="#h72-0-77" id="h72-0-77" class="i">+                            nullable: true,
</a><a href="#h72-0-78" id="h72-0-78" class="i">+                            default: Some(
</a><a href="#h72-0-79" id="h72-0-79" class="i">+                                Null,
</a><a href="#h72-0-80" id="h72-0-80" class="i">+                            ),
</a><a href="#h72-0-81" id="h72-0-81" class="i">+                            unique: false,
</a><a href="#h72-0-82" id="h72-0-82" class="i">+                            references: None,
</a><a href="#h72-0-83" id="h72-0-83" class="i">+                            index: false,
</a><a href="#h72-0-84" id="h72-0-84" class="i">+                        },
</a><a href="#h72-0-85" id="h72-0-85" class="i">+                    ],
</a><a href="#h72-0-86" id="h72-0-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h72-1" id="h72-1" class="h">@@ -75,7 +157,31 @@ Plan: Select(
</a>             },
             left_size: 7,
             right: Scan {
<a href="#h72-1-3" id="h72-1-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h72-1-4" id="h72-1-4" class="i">+                table: Table {
</a><a href="#h72-1-5" id="h72-1-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h72-1-6" id="h72-1-6" class="i">+                    columns: [
</a><a href="#h72-1-7" id="h72-1-7" class="i">+                        Column {
</a><a href="#h72-1-8" id="h72-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h72-1-9" id="h72-1-9" class="i">+                            datatype: Integer,
</a><a href="#h72-1-10" id="h72-1-10" class="i">+                            primary_key: true,
</a><a href="#h72-1-11" id="h72-1-11" class="i">+                            nullable: false,
</a><a href="#h72-1-12" id="h72-1-12" class="i">+                            default: None,
</a><a href="#h72-1-13" id="h72-1-13" class="i">+                            unique: true,
</a><a href="#h72-1-14" id="h72-1-14" class="i">+                            references: None,
</a><a href="#h72-1-15" id="h72-1-15" class="i">+                            index: false,
</a><a href="#h72-1-16" id="h72-1-16" class="i">+                        },
</a><a href="#h72-1-17" id="h72-1-17" class="i">+                        Column {
</a><a href="#h72-1-18" id="h72-1-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h72-1-19" id="h72-1-19" class="i">+                            datatype: String,
</a><a href="#h72-1-20" id="h72-1-20" class="i">+                            primary_key: false,
</a><a href="#h72-1-21" id="h72-1-21" class="i">+                            nullable: false,
</a><a href="#h72-1-22" id="h72-1-22" class="i">+                            default: None,
</a><a href="#h72-1-23" id="h72-1-23" class="i">+                            unique: false,
</a><a href="#h72-1-24" id="h72-1-24" class="i">+                            references: None,
</a><a href="#h72-1-25" id="h72-1-25" class="i">+                            index: false,
</a><a href="#h72-1-26" id="h72-1-26" class="i">+                        },
</a><a href="#h72-1-27" id="h72-1-27" class="i">+                    ],
</a><a href="#h72-1-28" id="h72-1-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<a href="#h72-2" id="h72-2" class="h">@@ -244,7 +350,89 @@ Optimized plan: Select(
</a>     Projection {
         source: HashJoin {
             left: Scan {
<a href="#h72-2-3" id="h72-2-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h72-2-4" id="h72-2-4" class="i">+                table: Table {
</a><a href="#h72-2-5" id="h72-2-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h72-2-6" id="h72-2-6" class="i">+                    columns: [
</a><a href="#h72-2-7" id="h72-2-7" class="i">+                        Column {
</a><a href="#h72-2-8" id="h72-2-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h72-2-9" id="h72-2-9" class="i">+                            datatype: Integer,
</a><a href="#h72-2-10" id="h72-2-10" class="i">+                            primary_key: true,
</a><a href="#h72-2-11" id="h72-2-11" class="i">+                            nullable: false,
</a><a href="#h72-2-12" id="h72-2-12" class="i">+                            default: None,
</a><a href="#h72-2-13" id="h72-2-13" class="i">+                            unique: true,
</a><a href="#h72-2-14" id="h72-2-14" class="i">+                            references: None,
</a><a href="#h72-2-15" id="h72-2-15" class="i">+                            index: false,
</a><a href="#h72-2-16" id="h72-2-16" class="i">+                        },
</a><a href="#h72-2-17" id="h72-2-17" class="i">+                        Column {
</a><a href="#h72-2-18" id="h72-2-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h72-2-19" id="h72-2-19" class="i">+                            datatype: String,
</a><a href="#h72-2-20" id="h72-2-20" class="i">+                            primary_key: false,
</a><a href="#h72-2-21" id="h72-2-21" class="i">+                            nullable: false,
</a><a href="#h72-2-22" id="h72-2-22" class="i">+                            default: None,
</a><a href="#h72-2-23" id="h72-2-23" class="i">+                            unique: false,
</a><a href="#h72-2-24" id="h72-2-24" class="i">+                            references: None,
</a><a href="#h72-2-25" id="h72-2-25" class="i">+                            index: false,
</a><a href="#h72-2-26" id="h72-2-26" class="i">+                        },
</a><a href="#h72-2-27" id="h72-2-27" class="i">+                        Column {
</a><a href="#h72-2-28" id="h72-2-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h72-2-29" id="h72-2-29" class="i">+                            datatype: Integer,
</a><a href="#h72-2-30" id="h72-2-30" class="i">+                            primary_key: false,
</a><a href="#h72-2-31" id="h72-2-31" class="i">+                            nullable: false,
</a><a href="#h72-2-32" id="h72-2-32" class="i">+                            default: None,
</a><a href="#h72-2-33" id="h72-2-33" class="i">+                            unique: false,
</a><a href="#h72-2-34" id="h72-2-34" class="i">+                            references: Some(
</a><a href="#h72-2-35" id="h72-2-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h72-2-36" id="h72-2-36" class="i">+                            ),
</a><a href="#h72-2-37" id="h72-2-37" class="i">+                            index: true,
</a><a href="#h72-2-38" id="h72-2-38" class="i">+                        },
</a><a href="#h72-2-39" id="h72-2-39" class="i">+                        Column {
</a><a href="#h72-2-40" id="h72-2-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h72-2-41" id="h72-2-41" class="i">+                            datatype: Integer,
</a><a href="#h72-2-42" id="h72-2-42" class="i">+                            primary_key: false,
</a><a href="#h72-2-43" id="h72-2-43" class="i">+                            nullable: false,
</a><a href="#h72-2-44" id="h72-2-44" class="i">+                            default: None,
</a><a href="#h72-2-45" id="h72-2-45" class="i">+                            unique: false,
</a><a href="#h72-2-46" id="h72-2-46" class="i">+                            references: Some(
</a><a href="#h72-2-47" id="h72-2-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h72-2-48" id="h72-2-48" class="i">+                            ),
</a><a href="#h72-2-49" id="h72-2-49" class="i">+                            index: true,
</a><a href="#h72-2-50" id="h72-2-50" class="i">+                        },
</a><a href="#h72-2-51" id="h72-2-51" class="i">+                        Column {
</a><a href="#h72-2-52" id="h72-2-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h72-2-53" id="h72-2-53" class="i">+                            datatype: Integer,
</a><a href="#h72-2-54" id="h72-2-54" class="i">+                            primary_key: false,
</a><a href="#h72-2-55" id="h72-2-55" class="i">+                            nullable: false,
</a><a href="#h72-2-56" id="h72-2-56" class="i">+                            default: None,
</a><a href="#h72-2-57" id="h72-2-57" class="i">+                            unique: false,
</a><a href="#h72-2-58" id="h72-2-58" class="i">+                            references: None,
</a><a href="#h72-2-59" id="h72-2-59" class="i">+                            index: false,
</a><a href="#h72-2-60" id="h72-2-60" class="i">+                        },
</a><a href="#h72-2-61" id="h72-2-61" class="i">+                        Column {
</a><a href="#h72-2-62" id="h72-2-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h72-2-63" id="h72-2-63" class="i">+                            datatype: Float,
</a><a href="#h72-2-64" id="h72-2-64" class="i">+                            primary_key: false,
</a><a href="#h72-2-65" id="h72-2-65" class="i">+                            nullable: true,
</a><a href="#h72-2-66" id="h72-2-66" class="i">+                            default: Some(
</a><a href="#h72-2-67" id="h72-2-67" class="i">+                                Null,
</a><a href="#h72-2-68" id="h72-2-68" class="i">+                            ),
</a><a href="#h72-2-69" id="h72-2-69" class="i">+                            unique: false,
</a><a href="#h72-2-70" id="h72-2-70" class="i">+                            references: None,
</a><a href="#h72-2-71" id="h72-2-71" class="i">+                            index: false,
</a><a href="#h72-2-72" id="h72-2-72" class="i">+                        },
</a><a href="#h72-2-73" id="h72-2-73" class="i">+                        Column {
</a><a href="#h72-2-74" id="h72-2-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h72-2-75" id="h72-2-75" class="i">+                            datatype: Boolean,
</a><a href="#h72-2-76" id="h72-2-76" class="i">+                            primary_key: false,
</a><a href="#h72-2-77" id="h72-2-77" class="i">+                            nullable: true,
</a><a href="#h72-2-78" id="h72-2-78" class="i">+                            default: Some(
</a><a href="#h72-2-79" id="h72-2-79" class="i">+                                Null,
</a><a href="#h72-2-80" id="h72-2-80" class="i">+                            ),
</a><a href="#h72-2-81" id="h72-2-81" class="i">+                            unique: false,
</a><a href="#h72-2-82" id="h72-2-82" class="i">+                            references: None,
</a><a href="#h72-2-83" id="h72-2-83" class="i">+                            index: false,
</a><a href="#h72-2-84" id="h72-2-84" class="i">+                        },
</a><a href="#h72-2-85" id="h72-2-85" class="i">+                    ],
</a><a href="#h72-2-86" id="h72-2-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h72-3" id="h72-3" class="h">@@ -262,7 +450,31 @@ Optimized plan: Select(
</a>                 ),
             ),
             right: Scan {
<a href="#h72-3-3" id="h72-3-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h72-3-4" id="h72-3-4" class="i">+                table: Table {
</a><a href="#h72-3-5" id="h72-3-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h72-3-6" id="h72-3-6" class="i">+                    columns: [
</a><a href="#h72-3-7" id="h72-3-7" class="i">+                        Column {
</a><a href="#h72-3-8" id="h72-3-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h72-3-9" id="h72-3-9" class="i">+                            datatype: Integer,
</a><a href="#h72-3-10" id="h72-3-10" class="i">+                            primary_key: true,
</a><a href="#h72-3-11" id="h72-3-11" class="i">+                            nullable: false,
</a><a href="#h72-3-12" id="h72-3-12" class="i">+                            default: None,
</a><a href="#h72-3-13" id="h72-3-13" class="i">+                            unique: true,
</a><a href="#h72-3-14" id="h72-3-14" class="i">+                            references: None,
</a><a href="#h72-3-15" id="h72-3-15" class="i">+                            index: false,
</a><a href="#h72-3-16" id="h72-3-16" class="i">+                        },
</a><a href="#h72-3-17" id="h72-3-17" class="i">+                        Column {
</a><a href="#h72-3-18" id="h72-3-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h72-3-19" id="h72-3-19" class="i">+                            datatype: String,
</a><a href="#h72-3-20" id="h72-3-20" class="i">+                            primary_key: false,
</a><a href="#h72-3-21" id="h72-3-21" class="i">+                            nullable: false,
</a><a href="#h72-3-22" id="h72-3-22" class="i">+                            default: None,
</a><a href="#h72-3-23" id="h72-3-23" class="i">+                            unique: false,
</a><a href="#h72-3-24" id="h72-3-24" class="i">+                            references: None,
</a><a href="#h72-3-25" id="h72-3-25" class="i">+                            index: false,
</a><a href="#h72-3-26" id="h72-3-26" class="i">+                        },
</a><a href="#h72-3-27" id="h72-3-27" class="i">+                    ],
</a><a href="#h72-3-28" id="h72-3-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<b>diff --git a/<a id="h73" href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a> b/<a href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -92,7 +92,89 @@ Plan: Select(
</a>         source: Projection {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h73-0-3" id="h73-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h73-0-4" id="h73-0-4" class="i">+                    table: Table {
</a><a href="#h73-0-5" id="h73-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h73-0-6" id="h73-0-6" class="i">+                        columns: [
</a><a href="#h73-0-7" id="h73-0-7" class="i">+                            Column {
</a><a href="#h73-0-8" id="h73-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h73-0-9" id="h73-0-9" class="i">+                                datatype: Integer,
</a><a href="#h73-0-10" id="h73-0-10" class="i">+                                primary_key: true,
</a><a href="#h73-0-11" id="h73-0-11" class="i">+                                nullable: false,
</a><a href="#h73-0-12" id="h73-0-12" class="i">+                                default: None,
</a><a href="#h73-0-13" id="h73-0-13" class="i">+                                unique: true,
</a><a href="#h73-0-14" id="h73-0-14" class="i">+                                references: None,
</a><a href="#h73-0-15" id="h73-0-15" class="i">+                                index: false,
</a><a href="#h73-0-16" id="h73-0-16" class="i">+                            },
</a><a href="#h73-0-17" id="h73-0-17" class="i">+                            Column {
</a><a href="#h73-0-18" id="h73-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h73-0-19" id="h73-0-19" class="i">+                                datatype: String,
</a><a href="#h73-0-20" id="h73-0-20" class="i">+                                primary_key: false,
</a><a href="#h73-0-21" id="h73-0-21" class="i">+                                nullable: false,
</a><a href="#h73-0-22" id="h73-0-22" class="i">+                                default: None,
</a><a href="#h73-0-23" id="h73-0-23" class="i">+                                unique: false,
</a><a href="#h73-0-24" id="h73-0-24" class="i">+                                references: None,
</a><a href="#h73-0-25" id="h73-0-25" class="i">+                                index: false,
</a><a href="#h73-0-26" id="h73-0-26" class="i">+                            },
</a><a href="#h73-0-27" id="h73-0-27" class="i">+                            Column {
</a><a href="#h73-0-28" id="h73-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h73-0-29" id="h73-0-29" class="i">+                                datatype: Integer,
</a><a href="#h73-0-30" id="h73-0-30" class="i">+                                primary_key: false,
</a><a href="#h73-0-31" id="h73-0-31" class="i">+                                nullable: false,
</a><a href="#h73-0-32" id="h73-0-32" class="i">+                                default: None,
</a><a href="#h73-0-33" id="h73-0-33" class="i">+                                unique: false,
</a><a href="#h73-0-34" id="h73-0-34" class="i">+                                references: Some(
</a><a href="#h73-0-35" id="h73-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h73-0-36" id="h73-0-36" class="i">+                                ),
</a><a href="#h73-0-37" id="h73-0-37" class="i">+                                index: true,
</a><a href="#h73-0-38" id="h73-0-38" class="i">+                            },
</a><a href="#h73-0-39" id="h73-0-39" class="i">+                            Column {
</a><a href="#h73-0-40" id="h73-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h73-0-41" id="h73-0-41" class="i">+                                datatype: Integer,
</a><a href="#h73-0-42" id="h73-0-42" class="i">+                                primary_key: false,
</a><a href="#h73-0-43" id="h73-0-43" class="i">+                                nullable: false,
</a><a href="#h73-0-44" id="h73-0-44" class="i">+                                default: None,
</a><a href="#h73-0-45" id="h73-0-45" class="i">+                                unique: false,
</a><a href="#h73-0-46" id="h73-0-46" class="i">+                                references: Some(
</a><a href="#h73-0-47" id="h73-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h73-0-48" id="h73-0-48" class="i">+                                ),
</a><a href="#h73-0-49" id="h73-0-49" class="i">+                                index: true,
</a><a href="#h73-0-50" id="h73-0-50" class="i">+                            },
</a><a href="#h73-0-51" id="h73-0-51" class="i">+                            Column {
</a><a href="#h73-0-52" id="h73-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h73-0-53" id="h73-0-53" class="i">+                                datatype: Integer,
</a><a href="#h73-0-54" id="h73-0-54" class="i">+                                primary_key: false,
</a><a href="#h73-0-55" id="h73-0-55" class="i">+                                nullable: false,
</a><a href="#h73-0-56" id="h73-0-56" class="i">+                                default: None,
</a><a href="#h73-0-57" id="h73-0-57" class="i">+                                unique: false,
</a><a href="#h73-0-58" id="h73-0-58" class="i">+                                references: None,
</a><a href="#h73-0-59" id="h73-0-59" class="i">+                                index: false,
</a><a href="#h73-0-60" id="h73-0-60" class="i">+                            },
</a><a href="#h73-0-61" id="h73-0-61" class="i">+                            Column {
</a><a href="#h73-0-62" id="h73-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h73-0-63" id="h73-0-63" class="i">+                                datatype: Float,
</a><a href="#h73-0-64" id="h73-0-64" class="i">+                                primary_key: false,
</a><a href="#h73-0-65" id="h73-0-65" class="i">+                                nullable: true,
</a><a href="#h73-0-66" id="h73-0-66" class="i">+                                default: Some(
</a><a href="#h73-0-67" id="h73-0-67" class="i">+                                    Null,
</a><a href="#h73-0-68" id="h73-0-68" class="i">+                                ),
</a><a href="#h73-0-69" id="h73-0-69" class="i">+                                unique: false,
</a><a href="#h73-0-70" id="h73-0-70" class="i">+                                references: None,
</a><a href="#h73-0-71" id="h73-0-71" class="i">+                                index: false,
</a><a href="#h73-0-72" id="h73-0-72" class="i">+                            },
</a><a href="#h73-0-73" id="h73-0-73" class="i">+                            Column {
</a><a href="#h73-0-74" id="h73-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h73-0-75" id="h73-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h73-0-76" id="h73-0-76" class="i">+                                primary_key: false,
</a><a href="#h73-0-77" id="h73-0-77" class="i">+                                nullable: true,
</a><a href="#h73-0-78" id="h73-0-78" class="i">+                                default: Some(
</a><a href="#h73-0-79" id="h73-0-79" class="i">+                                    Null,
</a><a href="#h73-0-80" id="h73-0-80" class="i">+                                ),
</a><a href="#h73-0-81" id="h73-0-81" class="i">+                                unique: false,
</a><a href="#h73-0-82" id="h73-0-82" class="i">+                                references: None,
</a><a href="#h73-0-83" id="h73-0-83" class="i">+                                index: false,
</a><a href="#h73-0-84" id="h73-0-84" class="i">+                            },
</a><a href="#h73-0-85" id="h73-0-85" class="i">+                        ],
</a><a href="#h73-0-86" id="h73-0-86" class="i">+                    },
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h73-1" id="h73-1" class="h">@@ -100,7 +182,31 @@ Plan: Select(
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h73-1-3" id="h73-1-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h73-1-4" id="h73-1-4" class="i">+                    table: Table {
</a><a href="#h73-1-5" id="h73-1-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h73-1-6" id="h73-1-6" class="i">+                        columns: [
</a><a href="#h73-1-7" id="h73-1-7" class="i">+                            Column {
</a><a href="#h73-1-8" id="h73-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h73-1-9" id="h73-1-9" class="i">+                                datatype: Integer,
</a><a href="#h73-1-10" id="h73-1-10" class="i">+                                primary_key: true,
</a><a href="#h73-1-11" id="h73-1-11" class="i">+                                nullable: false,
</a><a href="#h73-1-12" id="h73-1-12" class="i">+                                default: None,
</a><a href="#h73-1-13" id="h73-1-13" class="i">+                                unique: true,
</a><a href="#h73-1-14" id="h73-1-14" class="i">+                                references: None,
</a><a href="#h73-1-15" id="h73-1-15" class="i">+                                index: false,
</a><a href="#h73-1-16" id="h73-1-16" class="i">+                            },
</a><a href="#h73-1-17" id="h73-1-17" class="i">+                            Column {
</a><a href="#h73-1-18" id="h73-1-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h73-1-19" id="h73-1-19" class="i">+                                datatype: String,
</a><a href="#h73-1-20" id="h73-1-20" class="i">+                                primary_key: false,
</a><a href="#h73-1-21" id="h73-1-21" class="i">+                                nullable: false,
</a><a href="#h73-1-22" id="h73-1-22" class="i">+                                default: None,
</a><a href="#h73-1-23" id="h73-1-23" class="i">+                                unique: false,
</a><a href="#h73-1-24" id="h73-1-24" class="i">+                                references: None,
</a><a href="#h73-1-25" id="h73-1-25" class="i">+                                index: false,
</a><a href="#h73-1-26" id="h73-1-26" class="i">+                            },
</a><a href="#h73-1-27" id="h73-1-27" class="i">+                        ],
</a><a href="#h73-1-28" id="h73-1-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h73-2" id="h73-2" class="h">@@ -305,7 +411,89 @@ Optimized plan: Select(
</a>         source: Projection {
             source: HashJoin {
                 left: Scan {
<a href="#h73-2-3" id="h73-2-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h73-2-4" id="h73-2-4" class="i">+                    table: Table {
</a><a href="#h73-2-5" id="h73-2-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h73-2-6" id="h73-2-6" class="i">+                        columns: [
</a><a href="#h73-2-7" id="h73-2-7" class="i">+                            Column {
</a><a href="#h73-2-8" id="h73-2-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h73-2-9" id="h73-2-9" class="i">+                                datatype: Integer,
</a><a href="#h73-2-10" id="h73-2-10" class="i">+                                primary_key: true,
</a><a href="#h73-2-11" id="h73-2-11" class="i">+                                nullable: false,
</a><a href="#h73-2-12" id="h73-2-12" class="i">+                                default: None,
</a><a href="#h73-2-13" id="h73-2-13" class="i">+                                unique: true,
</a><a href="#h73-2-14" id="h73-2-14" class="i">+                                references: None,
</a><a href="#h73-2-15" id="h73-2-15" class="i">+                                index: false,
</a><a href="#h73-2-16" id="h73-2-16" class="i">+                            },
</a><a href="#h73-2-17" id="h73-2-17" class="i">+                            Column {
</a><a href="#h73-2-18" id="h73-2-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h73-2-19" id="h73-2-19" class="i">+                                datatype: String,
</a><a href="#h73-2-20" id="h73-2-20" class="i">+                                primary_key: false,
</a><a href="#h73-2-21" id="h73-2-21" class="i">+                                nullable: false,
</a><a href="#h73-2-22" id="h73-2-22" class="i">+                                default: None,
</a><a href="#h73-2-23" id="h73-2-23" class="i">+                                unique: false,
</a><a href="#h73-2-24" id="h73-2-24" class="i">+                                references: None,
</a><a href="#h73-2-25" id="h73-2-25" class="i">+                                index: false,
</a><a href="#h73-2-26" id="h73-2-26" class="i">+                            },
</a><a href="#h73-2-27" id="h73-2-27" class="i">+                            Column {
</a><a href="#h73-2-28" id="h73-2-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h73-2-29" id="h73-2-29" class="i">+                                datatype: Integer,
</a><a href="#h73-2-30" id="h73-2-30" class="i">+                                primary_key: false,
</a><a href="#h73-2-31" id="h73-2-31" class="i">+                                nullable: false,
</a><a href="#h73-2-32" id="h73-2-32" class="i">+                                default: None,
</a><a href="#h73-2-33" id="h73-2-33" class="i">+                                unique: false,
</a><a href="#h73-2-34" id="h73-2-34" class="i">+                                references: Some(
</a><a href="#h73-2-35" id="h73-2-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h73-2-36" id="h73-2-36" class="i">+                                ),
</a><a href="#h73-2-37" id="h73-2-37" class="i">+                                index: true,
</a><a href="#h73-2-38" id="h73-2-38" class="i">+                            },
</a><a href="#h73-2-39" id="h73-2-39" class="i">+                            Column {
</a><a href="#h73-2-40" id="h73-2-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h73-2-41" id="h73-2-41" class="i">+                                datatype: Integer,
</a><a href="#h73-2-42" id="h73-2-42" class="i">+                                primary_key: false,
</a><a href="#h73-2-43" id="h73-2-43" class="i">+                                nullable: false,
</a><a href="#h73-2-44" id="h73-2-44" class="i">+                                default: None,
</a><a href="#h73-2-45" id="h73-2-45" class="i">+                                unique: false,
</a><a href="#h73-2-46" id="h73-2-46" class="i">+                                references: Some(
</a><a href="#h73-2-47" id="h73-2-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h73-2-48" id="h73-2-48" class="i">+                                ),
</a><a href="#h73-2-49" id="h73-2-49" class="i">+                                index: true,
</a><a href="#h73-2-50" id="h73-2-50" class="i">+                            },
</a><a href="#h73-2-51" id="h73-2-51" class="i">+                            Column {
</a><a href="#h73-2-52" id="h73-2-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h73-2-53" id="h73-2-53" class="i">+                                datatype: Integer,
</a><a href="#h73-2-54" id="h73-2-54" class="i">+                                primary_key: false,
</a><a href="#h73-2-55" id="h73-2-55" class="i">+                                nullable: false,
</a><a href="#h73-2-56" id="h73-2-56" class="i">+                                default: None,
</a><a href="#h73-2-57" id="h73-2-57" class="i">+                                unique: false,
</a><a href="#h73-2-58" id="h73-2-58" class="i">+                                references: None,
</a><a href="#h73-2-59" id="h73-2-59" class="i">+                                index: false,
</a><a href="#h73-2-60" id="h73-2-60" class="i">+                            },
</a><a href="#h73-2-61" id="h73-2-61" class="i">+                            Column {
</a><a href="#h73-2-62" id="h73-2-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h73-2-63" id="h73-2-63" class="i">+                                datatype: Float,
</a><a href="#h73-2-64" id="h73-2-64" class="i">+                                primary_key: false,
</a><a href="#h73-2-65" id="h73-2-65" class="i">+                                nullable: true,
</a><a href="#h73-2-66" id="h73-2-66" class="i">+                                default: Some(
</a><a href="#h73-2-67" id="h73-2-67" class="i">+                                    Null,
</a><a href="#h73-2-68" id="h73-2-68" class="i">+                                ),
</a><a href="#h73-2-69" id="h73-2-69" class="i">+                                unique: false,
</a><a href="#h73-2-70" id="h73-2-70" class="i">+                                references: None,
</a><a href="#h73-2-71" id="h73-2-71" class="i">+                                index: false,
</a><a href="#h73-2-72" id="h73-2-72" class="i">+                            },
</a><a href="#h73-2-73" id="h73-2-73" class="i">+                            Column {
</a><a href="#h73-2-74" id="h73-2-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h73-2-75" id="h73-2-75" class="i">+                                datatype: Boolean,
</a><a href="#h73-2-76" id="h73-2-76" class="i">+                                primary_key: false,
</a><a href="#h73-2-77" id="h73-2-77" class="i">+                                nullable: true,
</a><a href="#h73-2-78" id="h73-2-78" class="i">+                                default: Some(
</a><a href="#h73-2-79" id="h73-2-79" class="i">+                                    Null,
</a><a href="#h73-2-80" id="h73-2-80" class="i">+                                ),
</a><a href="#h73-2-81" id="h73-2-81" class="i">+                                unique: false,
</a><a href="#h73-2-82" id="h73-2-82" class="i">+                                references: None,
</a><a href="#h73-2-83" id="h73-2-83" class="i">+                                index: false,
</a><a href="#h73-2-84" id="h73-2-84" class="i">+                            },
</a><a href="#h73-2-85" id="h73-2-85" class="i">+                        ],
</a><a href="#h73-2-86" id="h73-2-86" class="i">+                    },
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h73-3" id="h73-3" class="h">@@ -323,7 +511,31 @@ Optimized plan: Select(
</a>                     ),
                 ),
                 right: Scan {
<a href="#h73-3-3" id="h73-3-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h73-3-4" id="h73-3-4" class="i">+                    table: Table {
</a><a href="#h73-3-5" id="h73-3-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h73-3-6" id="h73-3-6" class="i">+                        columns: [
</a><a href="#h73-3-7" id="h73-3-7" class="i">+                            Column {
</a><a href="#h73-3-8" id="h73-3-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h73-3-9" id="h73-3-9" class="i">+                                datatype: Integer,
</a><a href="#h73-3-10" id="h73-3-10" class="i">+                                primary_key: true,
</a><a href="#h73-3-11" id="h73-3-11" class="i">+                                nullable: false,
</a><a href="#h73-3-12" id="h73-3-12" class="i">+                                default: None,
</a><a href="#h73-3-13" id="h73-3-13" class="i">+                                unique: true,
</a><a href="#h73-3-14" id="h73-3-14" class="i">+                                references: None,
</a><a href="#h73-3-15" id="h73-3-15" class="i">+                                index: false,
</a><a href="#h73-3-16" id="h73-3-16" class="i">+                            },
</a><a href="#h73-3-17" id="h73-3-17" class="i">+                            Column {
</a><a href="#h73-3-18" id="h73-3-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h73-3-19" id="h73-3-19" class="i">+                                datatype: String,
</a><a href="#h73-3-20" id="h73-3-20" class="i">+                                primary_key: false,
</a><a href="#h73-3-21" id="h73-3-21" class="i">+                                nullable: false,
</a><a href="#h73-3-22" id="h73-3-22" class="i">+                                default: None,
</a><a href="#h73-3-23" id="h73-3-23" class="i">+                                unique: false,
</a><a href="#h73-3-24" id="h73-3-24" class="i">+                                references: None,
</a><a href="#h73-3-25" id="h73-3-25" class="i">+                                index: false,
</a><a href="#h73-3-26" id="h73-3-26" class="i">+                            },
</a><a href="#h73-3-27" id="h73-3-27" class="i">+                        ],
</a><a href="#h73-3-28" id="h73-3-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<b>diff --git a/<a id="h74" href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a> b/<a href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -85,7 +85,31 @@ Plan: Select(
</a>         source: Projection {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h74-0-3" id="h74-0-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h74-0-4" id="h74-0-4" class="i">+                    table: Table {
</a><a href="#h74-0-5" id="h74-0-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h74-0-6" id="h74-0-6" class="i">+                        columns: [
</a><a href="#h74-0-7" id="h74-0-7" class="i">+                            Column {
</a><a href="#h74-0-8" id="h74-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h74-0-9" id="h74-0-9" class="i">+                                datatype: Integer,
</a><a href="#h74-0-10" id="h74-0-10" class="i">+                                primary_key: true,
</a><a href="#h74-0-11" id="h74-0-11" class="i">+                                nullable: false,
</a><a href="#h74-0-12" id="h74-0-12" class="i">+                                default: None,
</a><a href="#h74-0-13" id="h74-0-13" class="i">+                                unique: true,
</a><a href="#h74-0-14" id="h74-0-14" class="i">+                                references: None,
</a><a href="#h74-0-15" id="h74-0-15" class="i">+                                index: false,
</a><a href="#h74-0-16" id="h74-0-16" class="i">+                            },
</a><a href="#h74-0-17" id="h74-0-17" class="i">+                            Column {
</a><a href="#h74-0-18" id="h74-0-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h74-0-19" id="h74-0-19" class="i">+                                datatype: String,
</a><a href="#h74-0-20" id="h74-0-20" class="i">+                                primary_key: false,
</a><a href="#h74-0-21" id="h74-0-21" class="i">+                                nullable: false,
</a><a href="#h74-0-22" id="h74-0-22" class="i">+                                default: None,
</a><a href="#h74-0-23" id="h74-0-23" class="i">+                                unique: false,
</a><a href="#h74-0-24" id="h74-0-24" class="i">+                                references: None,
</a><a href="#h74-0-25" id="h74-0-25" class="i">+                                index: false,
</a><a href="#h74-0-26" id="h74-0-26" class="i">+                            },
</a><a href="#h74-0-27" id="h74-0-27" class="i">+                        ],
</a><a href="#h74-0-28" id="h74-0-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h74-1" id="h74-1" class="h">@@ -93,7 +117,89 @@ Plan: Select(
</a>                 },
                 left_size: 2,
                 right: Scan {
<a href="#h74-1-3" id="h74-1-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h74-1-4" id="h74-1-4" class="i">+                    table: Table {
</a><a href="#h74-1-5" id="h74-1-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h74-1-6" id="h74-1-6" class="i">+                        columns: [
</a><a href="#h74-1-7" id="h74-1-7" class="i">+                            Column {
</a><a href="#h74-1-8" id="h74-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h74-1-9" id="h74-1-9" class="i">+                                datatype: Integer,
</a><a href="#h74-1-10" id="h74-1-10" class="i">+                                primary_key: true,
</a><a href="#h74-1-11" id="h74-1-11" class="i">+                                nullable: false,
</a><a href="#h74-1-12" id="h74-1-12" class="i">+                                default: None,
</a><a href="#h74-1-13" id="h74-1-13" class="i">+                                unique: true,
</a><a href="#h74-1-14" id="h74-1-14" class="i">+                                references: None,
</a><a href="#h74-1-15" id="h74-1-15" class="i">+                                index: false,
</a><a href="#h74-1-16" id="h74-1-16" class="i">+                            },
</a><a href="#h74-1-17" id="h74-1-17" class="i">+                            Column {
</a><a href="#h74-1-18" id="h74-1-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h74-1-19" id="h74-1-19" class="i">+                                datatype: String,
</a><a href="#h74-1-20" id="h74-1-20" class="i">+                                primary_key: false,
</a><a href="#h74-1-21" id="h74-1-21" class="i">+                                nullable: false,
</a><a href="#h74-1-22" id="h74-1-22" class="i">+                                default: None,
</a><a href="#h74-1-23" id="h74-1-23" class="i">+                                unique: false,
</a><a href="#h74-1-24" id="h74-1-24" class="i">+                                references: None,
</a><a href="#h74-1-25" id="h74-1-25" class="i">+                                index: false,
</a><a href="#h74-1-26" id="h74-1-26" class="i">+                            },
</a><a href="#h74-1-27" id="h74-1-27" class="i">+                            Column {
</a><a href="#h74-1-28" id="h74-1-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h74-1-29" id="h74-1-29" class="i">+                                datatype: Integer,
</a><a href="#h74-1-30" id="h74-1-30" class="i">+                                primary_key: false,
</a><a href="#h74-1-31" id="h74-1-31" class="i">+                                nullable: false,
</a><a href="#h74-1-32" id="h74-1-32" class="i">+                                default: None,
</a><a href="#h74-1-33" id="h74-1-33" class="i">+                                unique: false,
</a><a href="#h74-1-34" id="h74-1-34" class="i">+                                references: Some(
</a><a href="#h74-1-35" id="h74-1-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h74-1-36" id="h74-1-36" class="i">+                                ),
</a><a href="#h74-1-37" id="h74-1-37" class="i">+                                index: true,
</a><a href="#h74-1-38" id="h74-1-38" class="i">+                            },
</a><a href="#h74-1-39" id="h74-1-39" class="i">+                            Column {
</a><a href="#h74-1-40" id="h74-1-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h74-1-41" id="h74-1-41" class="i">+                                datatype: Integer,
</a><a href="#h74-1-42" id="h74-1-42" class="i">+                                primary_key: false,
</a><a href="#h74-1-43" id="h74-1-43" class="i">+                                nullable: false,
</a><a href="#h74-1-44" id="h74-1-44" class="i">+                                default: None,
</a><a href="#h74-1-45" id="h74-1-45" class="i">+                                unique: false,
</a><a href="#h74-1-46" id="h74-1-46" class="i">+                                references: Some(
</a><a href="#h74-1-47" id="h74-1-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h74-1-48" id="h74-1-48" class="i">+                                ),
</a><a href="#h74-1-49" id="h74-1-49" class="i">+                                index: true,
</a><a href="#h74-1-50" id="h74-1-50" class="i">+                            },
</a><a href="#h74-1-51" id="h74-1-51" class="i">+                            Column {
</a><a href="#h74-1-52" id="h74-1-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h74-1-53" id="h74-1-53" class="i">+                                datatype: Integer,
</a><a href="#h74-1-54" id="h74-1-54" class="i">+                                primary_key: false,
</a><a href="#h74-1-55" id="h74-1-55" class="i">+                                nullable: false,
</a><a href="#h74-1-56" id="h74-1-56" class="i">+                                default: None,
</a><a href="#h74-1-57" id="h74-1-57" class="i">+                                unique: false,
</a><a href="#h74-1-58" id="h74-1-58" class="i">+                                references: None,
</a><a href="#h74-1-59" id="h74-1-59" class="i">+                                index: false,
</a><a href="#h74-1-60" id="h74-1-60" class="i">+                            },
</a><a href="#h74-1-61" id="h74-1-61" class="i">+                            Column {
</a><a href="#h74-1-62" id="h74-1-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h74-1-63" id="h74-1-63" class="i">+                                datatype: Float,
</a><a href="#h74-1-64" id="h74-1-64" class="i">+                                primary_key: false,
</a><a href="#h74-1-65" id="h74-1-65" class="i">+                                nullable: true,
</a><a href="#h74-1-66" id="h74-1-66" class="i">+                                default: Some(
</a><a href="#h74-1-67" id="h74-1-67" class="i">+                                    Null,
</a><a href="#h74-1-68" id="h74-1-68" class="i">+                                ),
</a><a href="#h74-1-69" id="h74-1-69" class="i">+                                unique: false,
</a><a href="#h74-1-70" id="h74-1-70" class="i">+                                references: None,
</a><a href="#h74-1-71" id="h74-1-71" class="i">+                                index: false,
</a><a href="#h74-1-72" id="h74-1-72" class="i">+                            },
</a><a href="#h74-1-73" id="h74-1-73" class="i">+                            Column {
</a><a href="#h74-1-74" id="h74-1-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h74-1-75" id="h74-1-75" class="i">+                                datatype: Boolean,
</a><a href="#h74-1-76" id="h74-1-76" class="i">+                                primary_key: false,
</a><a href="#h74-1-77" id="h74-1-77" class="i">+                                nullable: true,
</a><a href="#h74-1-78" id="h74-1-78" class="i">+                                default: Some(
</a><a href="#h74-1-79" id="h74-1-79" class="i">+                                    Null,
</a><a href="#h74-1-80" id="h74-1-80" class="i">+                                ),
</a><a href="#h74-1-81" id="h74-1-81" class="i">+                                unique: false,
</a><a href="#h74-1-82" id="h74-1-82" class="i">+                                references: None,
</a><a href="#h74-1-83" id="h74-1-83" class="i">+                                index: false,
</a><a href="#h74-1-84" id="h74-1-84" class="i">+                            },
</a><a href="#h74-1-85" id="h74-1-85" class="i">+                        ],
</a><a href="#h74-1-86" id="h74-1-86" class="i">+                    },
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h74-2" id="h74-2" class="h">@@ -298,7 +404,31 @@ Optimized plan: Select(
</a>         source: Projection {
             source: HashJoin {
                 left: Scan {
<a href="#h74-2-3" id="h74-2-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h74-2-4" id="h74-2-4" class="i">+                    table: Table {
</a><a href="#h74-2-5" id="h74-2-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h74-2-6" id="h74-2-6" class="i">+                        columns: [
</a><a href="#h74-2-7" id="h74-2-7" class="i">+                            Column {
</a><a href="#h74-2-8" id="h74-2-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h74-2-9" id="h74-2-9" class="i">+                                datatype: Integer,
</a><a href="#h74-2-10" id="h74-2-10" class="i">+                                primary_key: true,
</a><a href="#h74-2-11" id="h74-2-11" class="i">+                                nullable: false,
</a><a href="#h74-2-12" id="h74-2-12" class="i">+                                default: None,
</a><a href="#h74-2-13" id="h74-2-13" class="i">+                                unique: true,
</a><a href="#h74-2-14" id="h74-2-14" class="i">+                                references: None,
</a><a href="#h74-2-15" id="h74-2-15" class="i">+                                index: false,
</a><a href="#h74-2-16" id="h74-2-16" class="i">+                            },
</a><a href="#h74-2-17" id="h74-2-17" class="i">+                            Column {
</a><a href="#h74-2-18" id="h74-2-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h74-2-19" id="h74-2-19" class="i">+                                datatype: String,
</a><a href="#h74-2-20" id="h74-2-20" class="i">+                                primary_key: false,
</a><a href="#h74-2-21" id="h74-2-21" class="i">+                                nullable: false,
</a><a href="#h74-2-22" id="h74-2-22" class="i">+                                default: None,
</a><a href="#h74-2-23" id="h74-2-23" class="i">+                                unique: false,
</a><a href="#h74-2-24" id="h74-2-24" class="i">+                                references: None,
</a><a href="#h74-2-25" id="h74-2-25" class="i">+                                index: false,
</a><a href="#h74-2-26" id="h74-2-26" class="i">+                            },
</a><a href="#h74-2-27" id="h74-2-27" class="i">+                        ],
</a><a href="#h74-2-28" id="h74-2-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h74-3" id="h74-3" class="h">@@ -316,7 +446,89 @@ Optimized plan: Select(
</a>                     ),
                 ),
                 right: Scan {
<a href="#h74-3-3" id="h74-3-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h74-3-4" id="h74-3-4" class="i">+                    table: Table {
</a><a href="#h74-3-5" id="h74-3-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h74-3-6" id="h74-3-6" class="i">+                        columns: [
</a><a href="#h74-3-7" id="h74-3-7" class="i">+                            Column {
</a><a href="#h74-3-8" id="h74-3-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h74-3-9" id="h74-3-9" class="i">+                                datatype: Integer,
</a><a href="#h74-3-10" id="h74-3-10" class="i">+                                primary_key: true,
</a><a href="#h74-3-11" id="h74-3-11" class="i">+                                nullable: false,
</a><a href="#h74-3-12" id="h74-3-12" class="i">+                                default: None,
</a><a href="#h74-3-13" id="h74-3-13" class="i">+                                unique: true,
</a><a href="#h74-3-14" id="h74-3-14" class="i">+                                references: None,
</a><a href="#h74-3-15" id="h74-3-15" class="i">+                                index: false,
</a><a href="#h74-3-16" id="h74-3-16" class="i">+                            },
</a><a href="#h74-3-17" id="h74-3-17" class="i">+                            Column {
</a><a href="#h74-3-18" id="h74-3-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h74-3-19" id="h74-3-19" class="i">+                                datatype: String,
</a><a href="#h74-3-20" id="h74-3-20" class="i">+                                primary_key: false,
</a><a href="#h74-3-21" id="h74-3-21" class="i">+                                nullable: false,
</a><a href="#h74-3-22" id="h74-3-22" class="i">+                                default: None,
</a><a href="#h74-3-23" id="h74-3-23" class="i">+                                unique: false,
</a><a href="#h74-3-24" id="h74-3-24" class="i">+                                references: None,
</a><a href="#h74-3-25" id="h74-3-25" class="i">+                                index: false,
</a><a href="#h74-3-26" id="h74-3-26" class="i">+                            },
</a><a href="#h74-3-27" id="h74-3-27" class="i">+                            Column {
</a><a href="#h74-3-28" id="h74-3-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h74-3-29" id="h74-3-29" class="i">+                                datatype: Integer,
</a><a href="#h74-3-30" id="h74-3-30" class="i">+                                primary_key: false,
</a><a href="#h74-3-31" id="h74-3-31" class="i">+                                nullable: false,
</a><a href="#h74-3-32" id="h74-3-32" class="i">+                                default: None,
</a><a href="#h74-3-33" id="h74-3-33" class="i">+                                unique: false,
</a><a href="#h74-3-34" id="h74-3-34" class="i">+                                references: Some(
</a><a href="#h74-3-35" id="h74-3-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h74-3-36" id="h74-3-36" class="i">+                                ),
</a><a href="#h74-3-37" id="h74-3-37" class="i">+                                index: true,
</a><a href="#h74-3-38" id="h74-3-38" class="i">+                            },
</a><a href="#h74-3-39" id="h74-3-39" class="i">+                            Column {
</a><a href="#h74-3-40" id="h74-3-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h74-3-41" id="h74-3-41" class="i">+                                datatype: Integer,
</a><a href="#h74-3-42" id="h74-3-42" class="i">+                                primary_key: false,
</a><a href="#h74-3-43" id="h74-3-43" class="i">+                                nullable: false,
</a><a href="#h74-3-44" id="h74-3-44" class="i">+                                default: None,
</a><a href="#h74-3-45" id="h74-3-45" class="i">+                                unique: false,
</a><a href="#h74-3-46" id="h74-3-46" class="i">+                                references: Some(
</a><a href="#h74-3-47" id="h74-3-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h74-3-48" id="h74-3-48" class="i">+                                ),
</a><a href="#h74-3-49" id="h74-3-49" class="i">+                                index: true,
</a><a href="#h74-3-50" id="h74-3-50" class="i">+                            },
</a><a href="#h74-3-51" id="h74-3-51" class="i">+                            Column {
</a><a href="#h74-3-52" id="h74-3-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h74-3-53" id="h74-3-53" class="i">+                                datatype: Integer,
</a><a href="#h74-3-54" id="h74-3-54" class="i">+                                primary_key: false,
</a><a href="#h74-3-55" id="h74-3-55" class="i">+                                nullable: false,
</a><a href="#h74-3-56" id="h74-3-56" class="i">+                                default: None,
</a><a href="#h74-3-57" id="h74-3-57" class="i">+                                unique: false,
</a><a href="#h74-3-58" id="h74-3-58" class="i">+                                references: None,
</a><a href="#h74-3-59" id="h74-3-59" class="i">+                                index: false,
</a><a href="#h74-3-60" id="h74-3-60" class="i">+                            },
</a><a href="#h74-3-61" id="h74-3-61" class="i">+                            Column {
</a><a href="#h74-3-62" id="h74-3-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h74-3-63" id="h74-3-63" class="i">+                                datatype: Float,
</a><a href="#h74-3-64" id="h74-3-64" class="i">+                                primary_key: false,
</a><a href="#h74-3-65" id="h74-3-65" class="i">+                                nullable: true,
</a><a href="#h74-3-66" id="h74-3-66" class="i">+                                default: Some(
</a><a href="#h74-3-67" id="h74-3-67" class="i">+                                    Null,
</a><a href="#h74-3-68" id="h74-3-68" class="i">+                                ),
</a><a href="#h74-3-69" id="h74-3-69" class="i">+                                unique: false,
</a><a href="#h74-3-70" id="h74-3-70" class="i">+                                references: None,
</a><a href="#h74-3-71" id="h74-3-71" class="i">+                                index: false,
</a><a href="#h74-3-72" id="h74-3-72" class="i">+                            },
</a><a href="#h74-3-73" id="h74-3-73" class="i">+                            Column {
</a><a href="#h74-3-74" id="h74-3-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h74-3-75" id="h74-3-75" class="i">+                                datatype: Boolean,
</a><a href="#h74-3-76" id="h74-3-76" class="i">+                                primary_key: false,
</a><a href="#h74-3-77" id="h74-3-77" class="i">+                                nullable: true,
</a><a href="#h74-3-78" id="h74-3-78" class="i">+                                default: Some(
</a><a href="#h74-3-79" id="h74-3-79" class="i">+                                    Null,
</a><a href="#h74-3-80" id="h74-3-80" class="i">+                                ),
</a><a href="#h74-3-81" id="h74-3-81" class="i">+                                unique: false,
</a><a href="#h74-3-82" id="h74-3-82" class="i">+                                references: None,
</a><a href="#h74-3-83" id="h74-3-83" class="i">+                                index: false,
</a><a href="#h74-3-84" id="h74-3-84" class="i">+                            },
</a><a href="#h74-3-85" id="h74-3-85" class="i">+                        ],
</a><a href="#h74-3-86" id="h74-3-86" class="i">+                    },
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<b>diff --git a/<a id="h75" href="../file/tests/sql/query/limit.html">tests/sql/query/limit</a> b/<a href="../file/tests/sql/query/limit.html">tests/sql/query/limit</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -34,7 +34,89 @@ AST: Select {
</a> Plan: Select(
     Limit {
         source: Scan {
<a href="#h75-0-3" id="h75-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h75-0-4" id="h75-0-4" class="i">+            table: Table {
</a><a href="#h75-0-5" id="h75-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h75-0-6" id="h75-0-6" class="i">+                columns: [
</a><a href="#h75-0-7" id="h75-0-7" class="i">+                    Column {
</a><a href="#h75-0-8" id="h75-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h75-0-9" id="h75-0-9" class="i">+                        datatype: Integer,
</a><a href="#h75-0-10" id="h75-0-10" class="i">+                        primary_key: true,
</a><a href="#h75-0-11" id="h75-0-11" class="i">+                        nullable: false,
</a><a href="#h75-0-12" id="h75-0-12" class="i">+                        default: None,
</a><a href="#h75-0-13" id="h75-0-13" class="i">+                        unique: true,
</a><a href="#h75-0-14" id="h75-0-14" class="i">+                        references: None,
</a><a href="#h75-0-15" id="h75-0-15" class="i">+                        index: false,
</a><a href="#h75-0-16" id="h75-0-16" class="i">+                    },
</a><a href="#h75-0-17" id="h75-0-17" class="i">+                    Column {
</a><a href="#h75-0-18" id="h75-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h75-0-19" id="h75-0-19" class="i">+                        datatype: String,
</a><a href="#h75-0-20" id="h75-0-20" class="i">+                        primary_key: false,
</a><a href="#h75-0-21" id="h75-0-21" class="i">+                        nullable: false,
</a><a href="#h75-0-22" id="h75-0-22" class="i">+                        default: None,
</a><a href="#h75-0-23" id="h75-0-23" class="i">+                        unique: false,
</a><a href="#h75-0-24" id="h75-0-24" class="i">+                        references: None,
</a><a href="#h75-0-25" id="h75-0-25" class="i">+                        index: false,
</a><a href="#h75-0-26" id="h75-0-26" class="i">+                    },
</a><a href="#h75-0-27" id="h75-0-27" class="i">+                    Column {
</a><a href="#h75-0-28" id="h75-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h75-0-29" id="h75-0-29" class="i">+                        datatype: Integer,
</a><a href="#h75-0-30" id="h75-0-30" class="i">+                        primary_key: false,
</a><a href="#h75-0-31" id="h75-0-31" class="i">+                        nullable: false,
</a><a href="#h75-0-32" id="h75-0-32" class="i">+                        default: None,
</a><a href="#h75-0-33" id="h75-0-33" class="i">+                        unique: false,
</a><a href="#h75-0-34" id="h75-0-34" class="i">+                        references: Some(
</a><a href="#h75-0-35" id="h75-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h75-0-36" id="h75-0-36" class="i">+                        ),
</a><a href="#h75-0-37" id="h75-0-37" class="i">+                        index: true,
</a><a href="#h75-0-38" id="h75-0-38" class="i">+                    },
</a><a href="#h75-0-39" id="h75-0-39" class="i">+                    Column {
</a><a href="#h75-0-40" id="h75-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h75-0-41" id="h75-0-41" class="i">+                        datatype: Integer,
</a><a href="#h75-0-42" id="h75-0-42" class="i">+                        primary_key: false,
</a><a href="#h75-0-43" id="h75-0-43" class="i">+                        nullable: false,
</a><a href="#h75-0-44" id="h75-0-44" class="i">+                        default: None,
</a><a href="#h75-0-45" id="h75-0-45" class="i">+                        unique: false,
</a><a href="#h75-0-46" id="h75-0-46" class="i">+                        references: Some(
</a><a href="#h75-0-47" id="h75-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h75-0-48" id="h75-0-48" class="i">+                        ),
</a><a href="#h75-0-49" id="h75-0-49" class="i">+                        index: true,
</a><a href="#h75-0-50" id="h75-0-50" class="i">+                    },
</a><a href="#h75-0-51" id="h75-0-51" class="i">+                    Column {
</a><a href="#h75-0-52" id="h75-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h75-0-53" id="h75-0-53" class="i">+                        datatype: Integer,
</a><a href="#h75-0-54" id="h75-0-54" class="i">+                        primary_key: false,
</a><a href="#h75-0-55" id="h75-0-55" class="i">+                        nullable: false,
</a><a href="#h75-0-56" id="h75-0-56" class="i">+                        default: None,
</a><a href="#h75-0-57" id="h75-0-57" class="i">+                        unique: false,
</a><a href="#h75-0-58" id="h75-0-58" class="i">+                        references: None,
</a><a href="#h75-0-59" id="h75-0-59" class="i">+                        index: false,
</a><a href="#h75-0-60" id="h75-0-60" class="i">+                    },
</a><a href="#h75-0-61" id="h75-0-61" class="i">+                    Column {
</a><a href="#h75-0-62" id="h75-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h75-0-63" id="h75-0-63" class="i">+                        datatype: Float,
</a><a href="#h75-0-64" id="h75-0-64" class="i">+                        primary_key: false,
</a><a href="#h75-0-65" id="h75-0-65" class="i">+                        nullable: true,
</a><a href="#h75-0-66" id="h75-0-66" class="i">+                        default: Some(
</a><a href="#h75-0-67" id="h75-0-67" class="i">+                            Null,
</a><a href="#h75-0-68" id="h75-0-68" class="i">+                        ),
</a><a href="#h75-0-69" id="h75-0-69" class="i">+                        unique: false,
</a><a href="#h75-0-70" id="h75-0-70" class="i">+                        references: None,
</a><a href="#h75-0-71" id="h75-0-71" class="i">+                        index: false,
</a><a href="#h75-0-72" id="h75-0-72" class="i">+                    },
</a><a href="#h75-0-73" id="h75-0-73" class="i">+                    Column {
</a><a href="#h75-0-74" id="h75-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h75-0-75" id="h75-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h75-0-76" id="h75-0-76" class="i">+                        primary_key: false,
</a><a href="#h75-0-77" id="h75-0-77" class="i">+                        nullable: true,
</a><a href="#h75-0-78" id="h75-0-78" class="i">+                        default: Some(
</a><a href="#h75-0-79" id="h75-0-79" class="i">+                            Null,
</a><a href="#h75-0-80" id="h75-0-80" class="i">+                        ),
</a><a href="#h75-0-81" id="h75-0-81" class="i">+                        unique: false,
</a><a href="#h75-0-82" id="h75-0-82" class="i">+                        references: None,
</a><a href="#h75-0-83" id="h75-0-83" class="i">+                        index: false,
</a><a href="#h75-0-84" id="h75-0-84" class="i">+                    },
</a><a href="#h75-0-85" id="h75-0-85" class="i">+                ],
</a><a href="#h75-0-86" id="h75-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h75-1" id="h75-1" class="h">@@ -45,7 +127,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Limit {
         source: Scan {
<a href="#h75-1-3" id="h75-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h75-1-4" id="h75-1-4" class="i">+            table: Table {
</a><a href="#h75-1-5" id="h75-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h75-1-6" id="h75-1-6" class="i">+                columns: [
</a><a href="#h75-1-7" id="h75-1-7" class="i">+                    Column {
</a><a href="#h75-1-8" id="h75-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h75-1-9" id="h75-1-9" class="i">+                        datatype: Integer,
</a><a href="#h75-1-10" id="h75-1-10" class="i">+                        primary_key: true,
</a><a href="#h75-1-11" id="h75-1-11" class="i">+                        nullable: false,
</a><a href="#h75-1-12" id="h75-1-12" class="i">+                        default: None,
</a><a href="#h75-1-13" id="h75-1-13" class="i">+                        unique: true,
</a><a href="#h75-1-14" id="h75-1-14" class="i">+                        references: None,
</a><a href="#h75-1-15" id="h75-1-15" class="i">+                        index: false,
</a><a href="#h75-1-16" id="h75-1-16" class="i">+                    },
</a><a href="#h75-1-17" id="h75-1-17" class="i">+                    Column {
</a><a href="#h75-1-18" id="h75-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h75-1-19" id="h75-1-19" class="i">+                        datatype: String,
</a><a href="#h75-1-20" id="h75-1-20" class="i">+                        primary_key: false,
</a><a href="#h75-1-21" id="h75-1-21" class="i">+                        nullable: false,
</a><a href="#h75-1-22" id="h75-1-22" class="i">+                        default: None,
</a><a href="#h75-1-23" id="h75-1-23" class="i">+                        unique: false,
</a><a href="#h75-1-24" id="h75-1-24" class="i">+                        references: None,
</a><a href="#h75-1-25" id="h75-1-25" class="i">+                        index: false,
</a><a href="#h75-1-26" id="h75-1-26" class="i">+                    },
</a><a href="#h75-1-27" id="h75-1-27" class="i">+                    Column {
</a><a href="#h75-1-28" id="h75-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h75-1-29" id="h75-1-29" class="i">+                        datatype: Integer,
</a><a href="#h75-1-30" id="h75-1-30" class="i">+                        primary_key: false,
</a><a href="#h75-1-31" id="h75-1-31" class="i">+                        nullable: false,
</a><a href="#h75-1-32" id="h75-1-32" class="i">+                        default: None,
</a><a href="#h75-1-33" id="h75-1-33" class="i">+                        unique: false,
</a><a href="#h75-1-34" id="h75-1-34" class="i">+                        references: Some(
</a><a href="#h75-1-35" id="h75-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h75-1-36" id="h75-1-36" class="i">+                        ),
</a><a href="#h75-1-37" id="h75-1-37" class="i">+                        index: true,
</a><a href="#h75-1-38" id="h75-1-38" class="i">+                    },
</a><a href="#h75-1-39" id="h75-1-39" class="i">+                    Column {
</a><a href="#h75-1-40" id="h75-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h75-1-41" id="h75-1-41" class="i">+                        datatype: Integer,
</a><a href="#h75-1-42" id="h75-1-42" class="i">+                        primary_key: false,
</a><a href="#h75-1-43" id="h75-1-43" class="i">+                        nullable: false,
</a><a href="#h75-1-44" id="h75-1-44" class="i">+                        default: None,
</a><a href="#h75-1-45" id="h75-1-45" class="i">+                        unique: false,
</a><a href="#h75-1-46" id="h75-1-46" class="i">+                        references: Some(
</a><a href="#h75-1-47" id="h75-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h75-1-48" id="h75-1-48" class="i">+                        ),
</a><a href="#h75-1-49" id="h75-1-49" class="i">+                        index: true,
</a><a href="#h75-1-50" id="h75-1-50" class="i">+                    },
</a><a href="#h75-1-51" id="h75-1-51" class="i">+                    Column {
</a><a href="#h75-1-52" id="h75-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h75-1-53" id="h75-1-53" class="i">+                        datatype: Integer,
</a><a href="#h75-1-54" id="h75-1-54" class="i">+                        primary_key: false,
</a><a href="#h75-1-55" id="h75-1-55" class="i">+                        nullable: false,
</a><a href="#h75-1-56" id="h75-1-56" class="i">+                        default: None,
</a><a href="#h75-1-57" id="h75-1-57" class="i">+                        unique: false,
</a><a href="#h75-1-58" id="h75-1-58" class="i">+                        references: None,
</a><a href="#h75-1-59" id="h75-1-59" class="i">+                        index: false,
</a><a href="#h75-1-60" id="h75-1-60" class="i">+                    },
</a><a href="#h75-1-61" id="h75-1-61" class="i">+                    Column {
</a><a href="#h75-1-62" id="h75-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h75-1-63" id="h75-1-63" class="i">+                        datatype: Float,
</a><a href="#h75-1-64" id="h75-1-64" class="i">+                        primary_key: false,
</a><a href="#h75-1-65" id="h75-1-65" class="i">+                        nullable: true,
</a><a href="#h75-1-66" id="h75-1-66" class="i">+                        default: Some(
</a><a href="#h75-1-67" id="h75-1-67" class="i">+                            Null,
</a><a href="#h75-1-68" id="h75-1-68" class="i">+                        ),
</a><a href="#h75-1-69" id="h75-1-69" class="i">+                        unique: false,
</a><a href="#h75-1-70" id="h75-1-70" class="i">+                        references: None,
</a><a href="#h75-1-71" id="h75-1-71" class="i">+                        index: false,
</a><a href="#h75-1-72" id="h75-1-72" class="i">+                    },
</a><a href="#h75-1-73" id="h75-1-73" class="i">+                    Column {
</a><a href="#h75-1-74" id="h75-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h75-1-75" id="h75-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h75-1-76" id="h75-1-76" class="i">+                        primary_key: false,
</a><a href="#h75-1-77" id="h75-1-77" class="i">+                        nullable: true,
</a><a href="#h75-1-78" id="h75-1-78" class="i">+                        default: Some(
</a><a href="#h75-1-79" id="h75-1-79" class="i">+                            Null,
</a><a href="#h75-1-80" id="h75-1-80" class="i">+                        ),
</a><a href="#h75-1-81" id="h75-1-81" class="i">+                        unique: false,
</a><a href="#h75-1-82" id="h75-1-82" class="i">+                        references: None,
</a><a href="#h75-1-83" id="h75-1-83" class="i">+                        index: false,
</a><a href="#h75-1-84" id="h75-1-84" class="i">+                    },
</a><a href="#h75-1-85" id="h75-1-85" class="i">+                ],
</a><a href="#h75-1-86" id="h75-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h76" href="../file/tests/sql/query/limit_expr.html">tests/sql/query/limit_expr</a> b/<a href="../file/tests/sql/query/limit_expr.html">tests/sql/query/limit_expr</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -43,7 +43,89 @@ AST: Select {
</a> Plan: Select(
     Limit {
         source: Scan {
<a href="#h76-0-3" id="h76-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h76-0-4" id="h76-0-4" class="i">+            table: Table {
</a><a href="#h76-0-5" id="h76-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h76-0-6" id="h76-0-6" class="i">+                columns: [
</a><a href="#h76-0-7" id="h76-0-7" class="i">+                    Column {
</a><a href="#h76-0-8" id="h76-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h76-0-9" id="h76-0-9" class="i">+                        datatype: Integer,
</a><a href="#h76-0-10" id="h76-0-10" class="i">+                        primary_key: true,
</a><a href="#h76-0-11" id="h76-0-11" class="i">+                        nullable: false,
</a><a href="#h76-0-12" id="h76-0-12" class="i">+                        default: None,
</a><a href="#h76-0-13" id="h76-0-13" class="i">+                        unique: true,
</a><a href="#h76-0-14" id="h76-0-14" class="i">+                        references: None,
</a><a href="#h76-0-15" id="h76-0-15" class="i">+                        index: false,
</a><a href="#h76-0-16" id="h76-0-16" class="i">+                    },
</a><a href="#h76-0-17" id="h76-0-17" class="i">+                    Column {
</a><a href="#h76-0-18" id="h76-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h76-0-19" id="h76-0-19" class="i">+                        datatype: String,
</a><a href="#h76-0-20" id="h76-0-20" class="i">+                        primary_key: false,
</a><a href="#h76-0-21" id="h76-0-21" class="i">+                        nullable: false,
</a><a href="#h76-0-22" id="h76-0-22" class="i">+                        default: None,
</a><a href="#h76-0-23" id="h76-0-23" class="i">+                        unique: false,
</a><a href="#h76-0-24" id="h76-0-24" class="i">+                        references: None,
</a><a href="#h76-0-25" id="h76-0-25" class="i">+                        index: false,
</a><a href="#h76-0-26" id="h76-0-26" class="i">+                    },
</a><a href="#h76-0-27" id="h76-0-27" class="i">+                    Column {
</a><a href="#h76-0-28" id="h76-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h76-0-29" id="h76-0-29" class="i">+                        datatype: Integer,
</a><a href="#h76-0-30" id="h76-0-30" class="i">+                        primary_key: false,
</a><a href="#h76-0-31" id="h76-0-31" class="i">+                        nullable: false,
</a><a href="#h76-0-32" id="h76-0-32" class="i">+                        default: None,
</a><a href="#h76-0-33" id="h76-0-33" class="i">+                        unique: false,
</a><a href="#h76-0-34" id="h76-0-34" class="i">+                        references: Some(
</a><a href="#h76-0-35" id="h76-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h76-0-36" id="h76-0-36" class="i">+                        ),
</a><a href="#h76-0-37" id="h76-0-37" class="i">+                        index: true,
</a><a href="#h76-0-38" id="h76-0-38" class="i">+                    },
</a><a href="#h76-0-39" id="h76-0-39" class="i">+                    Column {
</a><a href="#h76-0-40" id="h76-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h76-0-41" id="h76-0-41" class="i">+                        datatype: Integer,
</a><a href="#h76-0-42" id="h76-0-42" class="i">+                        primary_key: false,
</a><a href="#h76-0-43" id="h76-0-43" class="i">+                        nullable: false,
</a><a href="#h76-0-44" id="h76-0-44" class="i">+                        default: None,
</a><a href="#h76-0-45" id="h76-0-45" class="i">+                        unique: false,
</a><a href="#h76-0-46" id="h76-0-46" class="i">+                        references: Some(
</a><a href="#h76-0-47" id="h76-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h76-0-48" id="h76-0-48" class="i">+                        ),
</a><a href="#h76-0-49" id="h76-0-49" class="i">+                        index: true,
</a><a href="#h76-0-50" id="h76-0-50" class="i">+                    },
</a><a href="#h76-0-51" id="h76-0-51" class="i">+                    Column {
</a><a href="#h76-0-52" id="h76-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h76-0-53" id="h76-0-53" class="i">+                        datatype: Integer,
</a><a href="#h76-0-54" id="h76-0-54" class="i">+                        primary_key: false,
</a><a href="#h76-0-55" id="h76-0-55" class="i">+                        nullable: false,
</a><a href="#h76-0-56" id="h76-0-56" class="i">+                        default: None,
</a><a href="#h76-0-57" id="h76-0-57" class="i">+                        unique: false,
</a><a href="#h76-0-58" id="h76-0-58" class="i">+                        references: None,
</a><a href="#h76-0-59" id="h76-0-59" class="i">+                        index: false,
</a><a href="#h76-0-60" id="h76-0-60" class="i">+                    },
</a><a href="#h76-0-61" id="h76-0-61" class="i">+                    Column {
</a><a href="#h76-0-62" id="h76-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h76-0-63" id="h76-0-63" class="i">+                        datatype: Float,
</a><a href="#h76-0-64" id="h76-0-64" class="i">+                        primary_key: false,
</a><a href="#h76-0-65" id="h76-0-65" class="i">+                        nullable: true,
</a><a href="#h76-0-66" id="h76-0-66" class="i">+                        default: Some(
</a><a href="#h76-0-67" id="h76-0-67" class="i">+                            Null,
</a><a href="#h76-0-68" id="h76-0-68" class="i">+                        ),
</a><a href="#h76-0-69" id="h76-0-69" class="i">+                        unique: false,
</a><a href="#h76-0-70" id="h76-0-70" class="i">+                        references: None,
</a><a href="#h76-0-71" id="h76-0-71" class="i">+                        index: false,
</a><a href="#h76-0-72" id="h76-0-72" class="i">+                    },
</a><a href="#h76-0-73" id="h76-0-73" class="i">+                    Column {
</a><a href="#h76-0-74" id="h76-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h76-0-75" id="h76-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h76-0-76" id="h76-0-76" class="i">+                        primary_key: false,
</a><a href="#h76-0-77" id="h76-0-77" class="i">+                        nullable: true,
</a><a href="#h76-0-78" id="h76-0-78" class="i">+                        default: Some(
</a><a href="#h76-0-79" id="h76-0-79" class="i">+                            Null,
</a><a href="#h76-0-80" id="h76-0-80" class="i">+                        ),
</a><a href="#h76-0-81" id="h76-0-81" class="i">+                        unique: false,
</a><a href="#h76-0-82" id="h76-0-82" class="i">+                        references: None,
</a><a href="#h76-0-83" id="h76-0-83" class="i">+                        index: false,
</a><a href="#h76-0-84" id="h76-0-84" class="i">+                    },
</a><a href="#h76-0-85" id="h76-0-85" class="i">+                ],
</a><a href="#h76-0-86" id="h76-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h76-1" id="h76-1" class="h">@@ -54,7 +136,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Limit {
         source: Scan {
<a href="#h76-1-3" id="h76-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h76-1-4" id="h76-1-4" class="i">+            table: Table {
</a><a href="#h76-1-5" id="h76-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h76-1-6" id="h76-1-6" class="i">+                columns: [
</a><a href="#h76-1-7" id="h76-1-7" class="i">+                    Column {
</a><a href="#h76-1-8" id="h76-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h76-1-9" id="h76-1-9" class="i">+                        datatype: Integer,
</a><a href="#h76-1-10" id="h76-1-10" class="i">+                        primary_key: true,
</a><a href="#h76-1-11" id="h76-1-11" class="i">+                        nullable: false,
</a><a href="#h76-1-12" id="h76-1-12" class="i">+                        default: None,
</a><a href="#h76-1-13" id="h76-1-13" class="i">+                        unique: true,
</a><a href="#h76-1-14" id="h76-1-14" class="i">+                        references: None,
</a><a href="#h76-1-15" id="h76-1-15" class="i">+                        index: false,
</a><a href="#h76-1-16" id="h76-1-16" class="i">+                    },
</a><a href="#h76-1-17" id="h76-1-17" class="i">+                    Column {
</a><a href="#h76-1-18" id="h76-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h76-1-19" id="h76-1-19" class="i">+                        datatype: String,
</a><a href="#h76-1-20" id="h76-1-20" class="i">+                        primary_key: false,
</a><a href="#h76-1-21" id="h76-1-21" class="i">+                        nullable: false,
</a><a href="#h76-1-22" id="h76-1-22" class="i">+                        default: None,
</a><a href="#h76-1-23" id="h76-1-23" class="i">+                        unique: false,
</a><a href="#h76-1-24" id="h76-1-24" class="i">+                        references: None,
</a><a href="#h76-1-25" id="h76-1-25" class="i">+                        index: false,
</a><a href="#h76-1-26" id="h76-1-26" class="i">+                    },
</a><a href="#h76-1-27" id="h76-1-27" class="i">+                    Column {
</a><a href="#h76-1-28" id="h76-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h76-1-29" id="h76-1-29" class="i">+                        datatype: Integer,
</a><a href="#h76-1-30" id="h76-1-30" class="i">+                        primary_key: false,
</a><a href="#h76-1-31" id="h76-1-31" class="i">+                        nullable: false,
</a><a href="#h76-1-32" id="h76-1-32" class="i">+                        default: None,
</a><a href="#h76-1-33" id="h76-1-33" class="i">+                        unique: false,
</a><a href="#h76-1-34" id="h76-1-34" class="i">+                        references: Some(
</a><a href="#h76-1-35" id="h76-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h76-1-36" id="h76-1-36" class="i">+                        ),
</a><a href="#h76-1-37" id="h76-1-37" class="i">+                        index: true,
</a><a href="#h76-1-38" id="h76-1-38" class="i">+                    },
</a><a href="#h76-1-39" id="h76-1-39" class="i">+                    Column {
</a><a href="#h76-1-40" id="h76-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h76-1-41" id="h76-1-41" class="i">+                        datatype: Integer,
</a><a href="#h76-1-42" id="h76-1-42" class="i">+                        primary_key: false,
</a><a href="#h76-1-43" id="h76-1-43" class="i">+                        nullable: false,
</a><a href="#h76-1-44" id="h76-1-44" class="i">+                        default: None,
</a><a href="#h76-1-45" id="h76-1-45" class="i">+                        unique: false,
</a><a href="#h76-1-46" id="h76-1-46" class="i">+                        references: Some(
</a><a href="#h76-1-47" id="h76-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h76-1-48" id="h76-1-48" class="i">+                        ),
</a><a href="#h76-1-49" id="h76-1-49" class="i">+                        index: true,
</a><a href="#h76-1-50" id="h76-1-50" class="i">+                    },
</a><a href="#h76-1-51" id="h76-1-51" class="i">+                    Column {
</a><a href="#h76-1-52" id="h76-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h76-1-53" id="h76-1-53" class="i">+                        datatype: Integer,
</a><a href="#h76-1-54" id="h76-1-54" class="i">+                        primary_key: false,
</a><a href="#h76-1-55" id="h76-1-55" class="i">+                        nullable: false,
</a><a href="#h76-1-56" id="h76-1-56" class="i">+                        default: None,
</a><a href="#h76-1-57" id="h76-1-57" class="i">+                        unique: false,
</a><a href="#h76-1-58" id="h76-1-58" class="i">+                        references: None,
</a><a href="#h76-1-59" id="h76-1-59" class="i">+                        index: false,
</a><a href="#h76-1-60" id="h76-1-60" class="i">+                    },
</a><a href="#h76-1-61" id="h76-1-61" class="i">+                    Column {
</a><a href="#h76-1-62" id="h76-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h76-1-63" id="h76-1-63" class="i">+                        datatype: Float,
</a><a href="#h76-1-64" id="h76-1-64" class="i">+                        primary_key: false,
</a><a href="#h76-1-65" id="h76-1-65" class="i">+                        nullable: true,
</a><a href="#h76-1-66" id="h76-1-66" class="i">+                        default: Some(
</a><a href="#h76-1-67" id="h76-1-67" class="i">+                            Null,
</a><a href="#h76-1-68" id="h76-1-68" class="i">+                        ),
</a><a href="#h76-1-69" id="h76-1-69" class="i">+                        unique: false,
</a><a href="#h76-1-70" id="h76-1-70" class="i">+                        references: None,
</a><a href="#h76-1-71" id="h76-1-71" class="i">+                        index: false,
</a><a href="#h76-1-72" id="h76-1-72" class="i">+                    },
</a><a href="#h76-1-73" id="h76-1-73" class="i">+                    Column {
</a><a href="#h76-1-74" id="h76-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h76-1-75" id="h76-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h76-1-76" id="h76-1-76" class="i">+                        primary_key: false,
</a><a href="#h76-1-77" id="h76-1-77" class="i">+                        nullable: true,
</a><a href="#h76-1-78" id="h76-1-78" class="i">+                        default: Some(
</a><a href="#h76-1-79" id="h76-1-79" class="i">+                            Null,
</a><a href="#h76-1-80" id="h76-1-80" class="i">+                        ),
</a><a href="#h76-1-81" id="h76-1-81" class="i">+                        unique: false,
</a><a href="#h76-1-82" id="h76-1-82" class="i">+                        references: None,
</a><a href="#h76-1-83" id="h76-1-83" class="i">+                        index: false,
</a><a href="#h76-1-84" id="h76-1-84" class="i">+                    },
</a><a href="#h76-1-85" id="h76-1-85" class="i">+                ],
</a><a href="#h76-1-86" id="h76-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h77" href="../file/tests/sql/query/limit_large.html">tests/sql/query/limit_large</a> b/<a href="../file/tests/sql/query/limit_large.html">tests/sql/query/limit_large</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -41,7 +41,89 @@ AST: Select {
</a> Plan: Select(
     Limit {
         source: Scan {
<a href="#h77-0-3" id="h77-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h77-0-4" id="h77-0-4" class="i">+            table: Table {
</a><a href="#h77-0-5" id="h77-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h77-0-6" id="h77-0-6" class="i">+                columns: [
</a><a href="#h77-0-7" id="h77-0-7" class="i">+                    Column {
</a><a href="#h77-0-8" id="h77-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h77-0-9" id="h77-0-9" class="i">+                        datatype: Integer,
</a><a href="#h77-0-10" id="h77-0-10" class="i">+                        primary_key: true,
</a><a href="#h77-0-11" id="h77-0-11" class="i">+                        nullable: false,
</a><a href="#h77-0-12" id="h77-0-12" class="i">+                        default: None,
</a><a href="#h77-0-13" id="h77-0-13" class="i">+                        unique: true,
</a><a href="#h77-0-14" id="h77-0-14" class="i">+                        references: None,
</a><a href="#h77-0-15" id="h77-0-15" class="i">+                        index: false,
</a><a href="#h77-0-16" id="h77-0-16" class="i">+                    },
</a><a href="#h77-0-17" id="h77-0-17" class="i">+                    Column {
</a><a href="#h77-0-18" id="h77-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h77-0-19" id="h77-0-19" class="i">+                        datatype: String,
</a><a href="#h77-0-20" id="h77-0-20" class="i">+                        primary_key: false,
</a><a href="#h77-0-21" id="h77-0-21" class="i">+                        nullable: false,
</a><a href="#h77-0-22" id="h77-0-22" class="i">+                        default: None,
</a><a href="#h77-0-23" id="h77-0-23" class="i">+                        unique: false,
</a><a href="#h77-0-24" id="h77-0-24" class="i">+                        references: None,
</a><a href="#h77-0-25" id="h77-0-25" class="i">+                        index: false,
</a><a href="#h77-0-26" id="h77-0-26" class="i">+                    },
</a><a href="#h77-0-27" id="h77-0-27" class="i">+                    Column {
</a><a href="#h77-0-28" id="h77-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h77-0-29" id="h77-0-29" class="i">+                        datatype: Integer,
</a><a href="#h77-0-30" id="h77-0-30" class="i">+                        primary_key: false,
</a><a href="#h77-0-31" id="h77-0-31" class="i">+                        nullable: false,
</a><a href="#h77-0-32" id="h77-0-32" class="i">+                        default: None,
</a><a href="#h77-0-33" id="h77-0-33" class="i">+                        unique: false,
</a><a href="#h77-0-34" id="h77-0-34" class="i">+                        references: Some(
</a><a href="#h77-0-35" id="h77-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h77-0-36" id="h77-0-36" class="i">+                        ),
</a><a href="#h77-0-37" id="h77-0-37" class="i">+                        index: true,
</a><a href="#h77-0-38" id="h77-0-38" class="i">+                    },
</a><a href="#h77-0-39" id="h77-0-39" class="i">+                    Column {
</a><a href="#h77-0-40" id="h77-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h77-0-41" id="h77-0-41" class="i">+                        datatype: Integer,
</a><a href="#h77-0-42" id="h77-0-42" class="i">+                        primary_key: false,
</a><a href="#h77-0-43" id="h77-0-43" class="i">+                        nullable: false,
</a><a href="#h77-0-44" id="h77-0-44" class="i">+                        default: None,
</a><a href="#h77-0-45" id="h77-0-45" class="i">+                        unique: false,
</a><a href="#h77-0-46" id="h77-0-46" class="i">+                        references: Some(
</a><a href="#h77-0-47" id="h77-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h77-0-48" id="h77-0-48" class="i">+                        ),
</a><a href="#h77-0-49" id="h77-0-49" class="i">+                        index: true,
</a><a href="#h77-0-50" id="h77-0-50" class="i">+                    },
</a><a href="#h77-0-51" id="h77-0-51" class="i">+                    Column {
</a><a href="#h77-0-52" id="h77-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h77-0-53" id="h77-0-53" class="i">+                        datatype: Integer,
</a><a href="#h77-0-54" id="h77-0-54" class="i">+                        primary_key: false,
</a><a href="#h77-0-55" id="h77-0-55" class="i">+                        nullable: false,
</a><a href="#h77-0-56" id="h77-0-56" class="i">+                        default: None,
</a><a href="#h77-0-57" id="h77-0-57" class="i">+                        unique: false,
</a><a href="#h77-0-58" id="h77-0-58" class="i">+                        references: None,
</a><a href="#h77-0-59" id="h77-0-59" class="i">+                        index: false,
</a><a href="#h77-0-60" id="h77-0-60" class="i">+                    },
</a><a href="#h77-0-61" id="h77-0-61" class="i">+                    Column {
</a><a href="#h77-0-62" id="h77-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h77-0-63" id="h77-0-63" class="i">+                        datatype: Float,
</a><a href="#h77-0-64" id="h77-0-64" class="i">+                        primary_key: false,
</a><a href="#h77-0-65" id="h77-0-65" class="i">+                        nullable: true,
</a><a href="#h77-0-66" id="h77-0-66" class="i">+                        default: Some(
</a><a href="#h77-0-67" id="h77-0-67" class="i">+                            Null,
</a><a href="#h77-0-68" id="h77-0-68" class="i">+                        ),
</a><a href="#h77-0-69" id="h77-0-69" class="i">+                        unique: false,
</a><a href="#h77-0-70" id="h77-0-70" class="i">+                        references: None,
</a><a href="#h77-0-71" id="h77-0-71" class="i">+                        index: false,
</a><a href="#h77-0-72" id="h77-0-72" class="i">+                    },
</a><a href="#h77-0-73" id="h77-0-73" class="i">+                    Column {
</a><a href="#h77-0-74" id="h77-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h77-0-75" id="h77-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h77-0-76" id="h77-0-76" class="i">+                        primary_key: false,
</a><a href="#h77-0-77" id="h77-0-77" class="i">+                        nullable: true,
</a><a href="#h77-0-78" id="h77-0-78" class="i">+                        default: Some(
</a><a href="#h77-0-79" id="h77-0-79" class="i">+                            Null,
</a><a href="#h77-0-80" id="h77-0-80" class="i">+                        ),
</a><a href="#h77-0-81" id="h77-0-81" class="i">+                        unique: false,
</a><a href="#h77-0-82" id="h77-0-82" class="i">+                        references: None,
</a><a href="#h77-0-83" id="h77-0-83" class="i">+                        index: false,
</a><a href="#h77-0-84" id="h77-0-84" class="i">+                    },
</a><a href="#h77-0-85" id="h77-0-85" class="i">+                ],
</a><a href="#h77-0-86" id="h77-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h77-1" id="h77-1" class="h">@@ -52,7 +134,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Limit {
         source: Scan {
<a href="#h77-1-3" id="h77-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h77-1-4" id="h77-1-4" class="i">+            table: Table {
</a><a href="#h77-1-5" id="h77-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h77-1-6" id="h77-1-6" class="i">+                columns: [
</a><a href="#h77-1-7" id="h77-1-7" class="i">+                    Column {
</a><a href="#h77-1-8" id="h77-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h77-1-9" id="h77-1-9" class="i">+                        datatype: Integer,
</a><a href="#h77-1-10" id="h77-1-10" class="i">+                        primary_key: true,
</a><a href="#h77-1-11" id="h77-1-11" class="i">+                        nullable: false,
</a><a href="#h77-1-12" id="h77-1-12" class="i">+                        default: None,
</a><a href="#h77-1-13" id="h77-1-13" class="i">+                        unique: true,
</a><a href="#h77-1-14" id="h77-1-14" class="i">+                        references: None,
</a><a href="#h77-1-15" id="h77-1-15" class="i">+                        index: false,
</a><a href="#h77-1-16" id="h77-1-16" class="i">+                    },
</a><a href="#h77-1-17" id="h77-1-17" class="i">+                    Column {
</a><a href="#h77-1-18" id="h77-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h77-1-19" id="h77-1-19" class="i">+                        datatype: String,
</a><a href="#h77-1-20" id="h77-1-20" class="i">+                        primary_key: false,
</a><a href="#h77-1-21" id="h77-1-21" class="i">+                        nullable: false,
</a><a href="#h77-1-22" id="h77-1-22" class="i">+                        default: None,
</a><a href="#h77-1-23" id="h77-1-23" class="i">+                        unique: false,
</a><a href="#h77-1-24" id="h77-1-24" class="i">+                        references: None,
</a><a href="#h77-1-25" id="h77-1-25" class="i">+                        index: false,
</a><a href="#h77-1-26" id="h77-1-26" class="i">+                    },
</a><a href="#h77-1-27" id="h77-1-27" class="i">+                    Column {
</a><a href="#h77-1-28" id="h77-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h77-1-29" id="h77-1-29" class="i">+                        datatype: Integer,
</a><a href="#h77-1-30" id="h77-1-30" class="i">+                        primary_key: false,
</a><a href="#h77-1-31" id="h77-1-31" class="i">+                        nullable: false,
</a><a href="#h77-1-32" id="h77-1-32" class="i">+                        default: None,
</a><a href="#h77-1-33" id="h77-1-33" class="i">+                        unique: false,
</a><a href="#h77-1-34" id="h77-1-34" class="i">+                        references: Some(
</a><a href="#h77-1-35" id="h77-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h77-1-36" id="h77-1-36" class="i">+                        ),
</a><a href="#h77-1-37" id="h77-1-37" class="i">+                        index: true,
</a><a href="#h77-1-38" id="h77-1-38" class="i">+                    },
</a><a href="#h77-1-39" id="h77-1-39" class="i">+                    Column {
</a><a href="#h77-1-40" id="h77-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h77-1-41" id="h77-1-41" class="i">+                        datatype: Integer,
</a><a href="#h77-1-42" id="h77-1-42" class="i">+                        primary_key: false,
</a><a href="#h77-1-43" id="h77-1-43" class="i">+                        nullable: false,
</a><a href="#h77-1-44" id="h77-1-44" class="i">+                        default: None,
</a><a href="#h77-1-45" id="h77-1-45" class="i">+                        unique: false,
</a><a href="#h77-1-46" id="h77-1-46" class="i">+                        references: Some(
</a><a href="#h77-1-47" id="h77-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h77-1-48" id="h77-1-48" class="i">+                        ),
</a><a href="#h77-1-49" id="h77-1-49" class="i">+                        index: true,
</a><a href="#h77-1-50" id="h77-1-50" class="i">+                    },
</a><a href="#h77-1-51" id="h77-1-51" class="i">+                    Column {
</a><a href="#h77-1-52" id="h77-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h77-1-53" id="h77-1-53" class="i">+                        datatype: Integer,
</a><a href="#h77-1-54" id="h77-1-54" class="i">+                        primary_key: false,
</a><a href="#h77-1-55" id="h77-1-55" class="i">+                        nullable: false,
</a><a href="#h77-1-56" id="h77-1-56" class="i">+                        default: None,
</a><a href="#h77-1-57" id="h77-1-57" class="i">+                        unique: false,
</a><a href="#h77-1-58" id="h77-1-58" class="i">+                        references: None,
</a><a href="#h77-1-59" id="h77-1-59" class="i">+                        index: false,
</a><a href="#h77-1-60" id="h77-1-60" class="i">+                    },
</a><a href="#h77-1-61" id="h77-1-61" class="i">+                    Column {
</a><a href="#h77-1-62" id="h77-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h77-1-63" id="h77-1-63" class="i">+                        datatype: Float,
</a><a href="#h77-1-64" id="h77-1-64" class="i">+                        primary_key: false,
</a><a href="#h77-1-65" id="h77-1-65" class="i">+                        nullable: true,
</a><a href="#h77-1-66" id="h77-1-66" class="i">+                        default: Some(
</a><a href="#h77-1-67" id="h77-1-67" class="i">+                            Null,
</a><a href="#h77-1-68" id="h77-1-68" class="i">+                        ),
</a><a href="#h77-1-69" id="h77-1-69" class="i">+                        unique: false,
</a><a href="#h77-1-70" id="h77-1-70" class="i">+                        references: None,
</a><a href="#h77-1-71" id="h77-1-71" class="i">+                        index: false,
</a><a href="#h77-1-72" id="h77-1-72" class="i">+                    },
</a><a href="#h77-1-73" id="h77-1-73" class="i">+                    Column {
</a><a href="#h77-1-74" id="h77-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h77-1-75" id="h77-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h77-1-76" id="h77-1-76" class="i">+                        primary_key: false,
</a><a href="#h77-1-77" id="h77-1-77" class="i">+                        nullable: true,
</a><a href="#h77-1-78" id="h77-1-78" class="i">+                        default: Some(
</a><a href="#h77-1-79" id="h77-1-79" class="i">+                            Null,
</a><a href="#h77-1-80" id="h77-1-80" class="i">+                        ),
</a><a href="#h77-1-81" id="h77-1-81" class="i">+                        unique: false,
</a><a href="#h77-1-82" id="h77-1-82" class="i">+                        references: None,
</a><a href="#h77-1-83" id="h77-1-83" class="i">+                        index: false,
</a><a href="#h77-1-84" id="h77-1-84" class="i">+                    },
</a><a href="#h77-1-85" id="h77-1-85" class="i">+                ],
</a><a href="#h77-1-86" id="h77-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h78" href="../file/tests/sql/query/limit_offset.html">tests/sql/query/limit_offset</a> b/<a href="../file/tests/sql/query/limit_offset.html">tests/sql/query/limit_offset</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -41,7 +41,89 @@ Plan: Select(
</a>     Limit {
         source: Offset {
             source: Scan {
<a href="#h78-0-3" id="h78-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h78-0-4" id="h78-0-4" class="i">+                table: Table {
</a><a href="#h78-0-5" id="h78-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h78-0-6" id="h78-0-6" class="i">+                    columns: [
</a><a href="#h78-0-7" id="h78-0-7" class="i">+                        Column {
</a><a href="#h78-0-8" id="h78-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h78-0-9" id="h78-0-9" class="i">+                            datatype: Integer,
</a><a href="#h78-0-10" id="h78-0-10" class="i">+                            primary_key: true,
</a><a href="#h78-0-11" id="h78-0-11" class="i">+                            nullable: false,
</a><a href="#h78-0-12" id="h78-0-12" class="i">+                            default: None,
</a><a href="#h78-0-13" id="h78-0-13" class="i">+                            unique: true,
</a><a href="#h78-0-14" id="h78-0-14" class="i">+                            references: None,
</a><a href="#h78-0-15" id="h78-0-15" class="i">+                            index: false,
</a><a href="#h78-0-16" id="h78-0-16" class="i">+                        },
</a><a href="#h78-0-17" id="h78-0-17" class="i">+                        Column {
</a><a href="#h78-0-18" id="h78-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h78-0-19" id="h78-0-19" class="i">+                            datatype: String,
</a><a href="#h78-0-20" id="h78-0-20" class="i">+                            primary_key: false,
</a><a href="#h78-0-21" id="h78-0-21" class="i">+                            nullable: false,
</a><a href="#h78-0-22" id="h78-0-22" class="i">+                            default: None,
</a><a href="#h78-0-23" id="h78-0-23" class="i">+                            unique: false,
</a><a href="#h78-0-24" id="h78-0-24" class="i">+                            references: None,
</a><a href="#h78-0-25" id="h78-0-25" class="i">+                            index: false,
</a><a href="#h78-0-26" id="h78-0-26" class="i">+                        },
</a><a href="#h78-0-27" id="h78-0-27" class="i">+                        Column {
</a><a href="#h78-0-28" id="h78-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h78-0-29" id="h78-0-29" class="i">+                            datatype: Integer,
</a><a href="#h78-0-30" id="h78-0-30" class="i">+                            primary_key: false,
</a><a href="#h78-0-31" id="h78-0-31" class="i">+                            nullable: false,
</a><a href="#h78-0-32" id="h78-0-32" class="i">+                            default: None,
</a><a href="#h78-0-33" id="h78-0-33" class="i">+                            unique: false,
</a><a href="#h78-0-34" id="h78-0-34" class="i">+                            references: Some(
</a><a href="#h78-0-35" id="h78-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h78-0-36" id="h78-0-36" class="i">+                            ),
</a><a href="#h78-0-37" id="h78-0-37" class="i">+                            index: true,
</a><a href="#h78-0-38" id="h78-0-38" class="i">+                        },
</a><a href="#h78-0-39" id="h78-0-39" class="i">+                        Column {
</a><a href="#h78-0-40" id="h78-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h78-0-41" id="h78-0-41" class="i">+                            datatype: Integer,
</a><a href="#h78-0-42" id="h78-0-42" class="i">+                            primary_key: false,
</a><a href="#h78-0-43" id="h78-0-43" class="i">+                            nullable: false,
</a><a href="#h78-0-44" id="h78-0-44" class="i">+                            default: None,
</a><a href="#h78-0-45" id="h78-0-45" class="i">+                            unique: false,
</a><a href="#h78-0-46" id="h78-0-46" class="i">+                            references: Some(
</a><a href="#h78-0-47" id="h78-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h78-0-48" id="h78-0-48" class="i">+                            ),
</a><a href="#h78-0-49" id="h78-0-49" class="i">+                            index: true,
</a><a href="#h78-0-50" id="h78-0-50" class="i">+                        },
</a><a href="#h78-0-51" id="h78-0-51" class="i">+                        Column {
</a><a href="#h78-0-52" id="h78-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h78-0-53" id="h78-0-53" class="i">+                            datatype: Integer,
</a><a href="#h78-0-54" id="h78-0-54" class="i">+                            primary_key: false,
</a><a href="#h78-0-55" id="h78-0-55" class="i">+                            nullable: false,
</a><a href="#h78-0-56" id="h78-0-56" class="i">+                            default: None,
</a><a href="#h78-0-57" id="h78-0-57" class="i">+                            unique: false,
</a><a href="#h78-0-58" id="h78-0-58" class="i">+                            references: None,
</a><a href="#h78-0-59" id="h78-0-59" class="i">+                            index: false,
</a><a href="#h78-0-60" id="h78-0-60" class="i">+                        },
</a><a href="#h78-0-61" id="h78-0-61" class="i">+                        Column {
</a><a href="#h78-0-62" id="h78-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h78-0-63" id="h78-0-63" class="i">+                            datatype: Float,
</a><a href="#h78-0-64" id="h78-0-64" class="i">+                            primary_key: false,
</a><a href="#h78-0-65" id="h78-0-65" class="i">+                            nullable: true,
</a><a href="#h78-0-66" id="h78-0-66" class="i">+                            default: Some(
</a><a href="#h78-0-67" id="h78-0-67" class="i">+                                Null,
</a><a href="#h78-0-68" id="h78-0-68" class="i">+                            ),
</a><a href="#h78-0-69" id="h78-0-69" class="i">+                            unique: false,
</a><a href="#h78-0-70" id="h78-0-70" class="i">+                            references: None,
</a><a href="#h78-0-71" id="h78-0-71" class="i">+                            index: false,
</a><a href="#h78-0-72" id="h78-0-72" class="i">+                        },
</a><a href="#h78-0-73" id="h78-0-73" class="i">+                        Column {
</a><a href="#h78-0-74" id="h78-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h78-0-75" id="h78-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h78-0-76" id="h78-0-76" class="i">+                            primary_key: false,
</a><a href="#h78-0-77" id="h78-0-77" class="i">+                            nullable: true,
</a><a href="#h78-0-78" id="h78-0-78" class="i">+                            default: Some(
</a><a href="#h78-0-79" id="h78-0-79" class="i">+                                Null,
</a><a href="#h78-0-80" id="h78-0-80" class="i">+                            ),
</a><a href="#h78-0-81" id="h78-0-81" class="i">+                            unique: false,
</a><a href="#h78-0-82" id="h78-0-82" class="i">+                            references: None,
</a><a href="#h78-0-83" id="h78-0-83" class="i">+                            index: false,
</a><a href="#h78-0-84" id="h78-0-84" class="i">+                        },
</a><a href="#h78-0-85" id="h78-0-85" class="i">+                    ],
</a><a href="#h78-0-86" id="h78-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h78-1" id="h78-1" class="h">@@ -55,7 +137,89 @@ Optimized plan: Select(
</a>     Limit {
         source: Offset {
             source: Scan {
<a href="#h78-1-3" id="h78-1-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h78-1-4" id="h78-1-4" class="i">+                table: Table {
</a><a href="#h78-1-5" id="h78-1-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h78-1-6" id="h78-1-6" class="i">+                    columns: [
</a><a href="#h78-1-7" id="h78-1-7" class="i">+                        Column {
</a><a href="#h78-1-8" id="h78-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h78-1-9" id="h78-1-9" class="i">+                            datatype: Integer,
</a><a href="#h78-1-10" id="h78-1-10" class="i">+                            primary_key: true,
</a><a href="#h78-1-11" id="h78-1-11" class="i">+                            nullable: false,
</a><a href="#h78-1-12" id="h78-1-12" class="i">+                            default: None,
</a><a href="#h78-1-13" id="h78-1-13" class="i">+                            unique: true,
</a><a href="#h78-1-14" id="h78-1-14" class="i">+                            references: None,
</a><a href="#h78-1-15" id="h78-1-15" class="i">+                            index: false,
</a><a href="#h78-1-16" id="h78-1-16" class="i">+                        },
</a><a href="#h78-1-17" id="h78-1-17" class="i">+                        Column {
</a><a href="#h78-1-18" id="h78-1-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h78-1-19" id="h78-1-19" class="i">+                            datatype: String,
</a><a href="#h78-1-20" id="h78-1-20" class="i">+                            primary_key: false,
</a><a href="#h78-1-21" id="h78-1-21" class="i">+                            nullable: false,
</a><a href="#h78-1-22" id="h78-1-22" class="i">+                            default: None,
</a><a href="#h78-1-23" id="h78-1-23" class="i">+                            unique: false,
</a><a href="#h78-1-24" id="h78-1-24" class="i">+                            references: None,
</a><a href="#h78-1-25" id="h78-1-25" class="i">+                            index: false,
</a><a href="#h78-1-26" id="h78-1-26" class="i">+                        },
</a><a href="#h78-1-27" id="h78-1-27" class="i">+                        Column {
</a><a href="#h78-1-28" id="h78-1-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h78-1-29" id="h78-1-29" class="i">+                            datatype: Integer,
</a><a href="#h78-1-30" id="h78-1-30" class="i">+                            primary_key: false,
</a><a href="#h78-1-31" id="h78-1-31" class="i">+                            nullable: false,
</a><a href="#h78-1-32" id="h78-1-32" class="i">+                            default: None,
</a><a href="#h78-1-33" id="h78-1-33" class="i">+                            unique: false,
</a><a href="#h78-1-34" id="h78-1-34" class="i">+                            references: Some(
</a><a href="#h78-1-35" id="h78-1-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h78-1-36" id="h78-1-36" class="i">+                            ),
</a><a href="#h78-1-37" id="h78-1-37" class="i">+                            index: true,
</a><a href="#h78-1-38" id="h78-1-38" class="i">+                        },
</a><a href="#h78-1-39" id="h78-1-39" class="i">+                        Column {
</a><a href="#h78-1-40" id="h78-1-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h78-1-41" id="h78-1-41" class="i">+                            datatype: Integer,
</a><a href="#h78-1-42" id="h78-1-42" class="i">+                            primary_key: false,
</a><a href="#h78-1-43" id="h78-1-43" class="i">+                            nullable: false,
</a><a href="#h78-1-44" id="h78-1-44" class="i">+                            default: None,
</a><a href="#h78-1-45" id="h78-1-45" class="i">+                            unique: false,
</a><a href="#h78-1-46" id="h78-1-46" class="i">+                            references: Some(
</a><a href="#h78-1-47" id="h78-1-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h78-1-48" id="h78-1-48" class="i">+                            ),
</a><a href="#h78-1-49" id="h78-1-49" class="i">+                            index: true,
</a><a href="#h78-1-50" id="h78-1-50" class="i">+                        },
</a><a href="#h78-1-51" id="h78-1-51" class="i">+                        Column {
</a><a href="#h78-1-52" id="h78-1-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h78-1-53" id="h78-1-53" class="i">+                            datatype: Integer,
</a><a href="#h78-1-54" id="h78-1-54" class="i">+                            primary_key: false,
</a><a href="#h78-1-55" id="h78-1-55" class="i">+                            nullable: false,
</a><a href="#h78-1-56" id="h78-1-56" class="i">+                            default: None,
</a><a href="#h78-1-57" id="h78-1-57" class="i">+                            unique: false,
</a><a href="#h78-1-58" id="h78-1-58" class="i">+                            references: None,
</a><a href="#h78-1-59" id="h78-1-59" class="i">+                            index: false,
</a><a href="#h78-1-60" id="h78-1-60" class="i">+                        },
</a><a href="#h78-1-61" id="h78-1-61" class="i">+                        Column {
</a><a href="#h78-1-62" id="h78-1-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h78-1-63" id="h78-1-63" class="i">+                            datatype: Float,
</a><a href="#h78-1-64" id="h78-1-64" class="i">+                            primary_key: false,
</a><a href="#h78-1-65" id="h78-1-65" class="i">+                            nullable: true,
</a><a href="#h78-1-66" id="h78-1-66" class="i">+                            default: Some(
</a><a href="#h78-1-67" id="h78-1-67" class="i">+                                Null,
</a><a href="#h78-1-68" id="h78-1-68" class="i">+                            ),
</a><a href="#h78-1-69" id="h78-1-69" class="i">+                            unique: false,
</a><a href="#h78-1-70" id="h78-1-70" class="i">+                            references: None,
</a><a href="#h78-1-71" id="h78-1-71" class="i">+                            index: false,
</a><a href="#h78-1-72" id="h78-1-72" class="i">+                        },
</a><a href="#h78-1-73" id="h78-1-73" class="i">+                        Column {
</a><a href="#h78-1-74" id="h78-1-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h78-1-75" id="h78-1-75" class="i">+                            datatype: Boolean,
</a><a href="#h78-1-76" id="h78-1-76" class="i">+                            primary_key: false,
</a><a href="#h78-1-77" id="h78-1-77" class="i">+                            nullable: true,
</a><a href="#h78-1-78" id="h78-1-78" class="i">+                            default: Some(
</a><a href="#h78-1-79" id="h78-1-79" class="i">+                                Null,
</a><a href="#h78-1-80" id="h78-1-80" class="i">+                            ),
</a><a href="#h78-1-81" id="h78-1-81" class="i">+                            unique: false,
</a><a href="#h78-1-82" id="h78-1-82" class="i">+                            references: None,
</a><a href="#h78-1-83" id="h78-1-83" class="i">+                            index: false,
</a><a href="#h78-1-84" id="h78-1-84" class="i">+                        },
</a><a href="#h78-1-85" id="h78-1-85" class="i">+                    ],
</a><a href="#h78-1-86" id="h78-1-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<b>diff --git a/<a id="h79" href="../file/tests/sql/query/limit_zero.html">tests/sql/query/limit_zero</a> b/<a href="../file/tests/sql/query/limit_zero.html">tests/sql/query/limit_zero</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -31,7 +31,89 @@ AST: Select {
</a> Plan: Select(
     Limit {
         source: Scan {
<a href="#h79-0-3" id="h79-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h79-0-4" id="h79-0-4" class="i">+            table: Table {
</a><a href="#h79-0-5" id="h79-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h79-0-6" id="h79-0-6" class="i">+                columns: [
</a><a href="#h79-0-7" id="h79-0-7" class="i">+                    Column {
</a><a href="#h79-0-8" id="h79-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h79-0-9" id="h79-0-9" class="i">+                        datatype: Integer,
</a><a href="#h79-0-10" id="h79-0-10" class="i">+                        primary_key: true,
</a><a href="#h79-0-11" id="h79-0-11" class="i">+                        nullable: false,
</a><a href="#h79-0-12" id="h79-0-12" class="i">+                        default: None,
</a><a href="#h79-0-13" id="h79-0-13" class="i">+                        unique: true,
</a><a href="#h79-0-14" id="h79-0-14" class="i">+                        references: None,
</a><a href="#h79-0-15" id="h79-0-15" class="i">+                        index: false,
</a><a href="#h79-0-16" id="h79-0-16" class="i">+                    },
</a><a href="#h79-0-17" id="h79-0-17" class="i">+                    Column {
</a><a href="#h79-0-18" id="h79-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h79-0-19" id="h79-0-19" class="i">+                        datatype: String,
</a><a href="#h79-0-20" id="h79-0-20" class="i">+                        primary_key: false,
</a><a href="#h79-0-21" id="h79-0-21" class="i">+                        nullable: false,
</a><a href="#h79-0-22" id="h79-0-22" class="i">+                        default: None,
</a><a href="#h79-0-23" id="h79-0-23" class="i">+                        unique: false,
</a><a href="#h79-0-24" id="h79-0-24" class="i">+                        references: None,
</a><a href="#h79-0-25" id="h79-0-25" class="i">+                        index: false,
</a><a href="#h79-0-26" id="h79-0-26" class="i">+                    },
</a><a href="#h79-0-27" id="h79-0-27" class="i">+                    Column {
</a><a href="#h79-0-28" id="h79-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h79-0-29" id="h79-0-29" class="i">+                        datatype: Integer,
</a><a href="#h79-0-30" id="h79-0-30" class="i">+                        primary_key: false,
</a><a href="#h79-0-31" id="h79-0-31" class="i">+                        nullable: false,
</a><a href="#h79-0-32" id="h79-0-32" class="i">+                        default: None,
</a><a href="#h79-0-33" id="h79-0-33" class="i">+                        unique: false,
</a><a href="#h79-0-34" id="h79-0-34" class="i">+                        references: Some(
</a><a href="#h79-0-35" id="h79-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h79-0-36" id="h79-0-36" class="i">+                        ),
</a><a href="#h79-0-37" id="h79-0-37" class="i">+                        index: true,
</a><a href="#h79-0-38" id="h79-0-38" class="i">+                    },
</a><a href="#h79-0-39" id="h79-0-39" class="i">+                    Column {
</a><a href="#h79-0-40" id="h79-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h79-0-41" id="h79-0-41" class="i">+                        datatype: Integer,
</a><a href="#h79-0-42" id="h79-0-42" class="i">+                        primary_key: false,
</a><a href="#h79-0-43" id="h79-0-43" class="i">+                        nullable: false,
</a><a href="#h79-0-44" id="h79-0-44" class="i">+                        default: None,
</a><a href="#h79-0-45" id="h79-0-45" class="i">+                        unique: false,
</a><a href="#h79-0-46" id="h79-0-46" class="i">+                        references: Some(
</a><a href="#h79-0-47" id="h79-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h79-0-48" id="h79-0-48" class="i">+                        ),
</a><a href="#h79-0-49" id="h79-0-49" class="i">+                        index: true,
</a><a href="#h79-0-50" id="h79-0-50" class="i">+                    },
</a><a href="#h79-0-51" id="h79-0-51" class="i">+                    Column {
</a><a href="#h79-0-52" id="h79-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h79-0-53" id="h79-0-53" class="i">+                        datatype: Integer,
</a><a href="#h79-0-54" id="h79-0-54" class="i">+                        primary_key: false,
</a><a href="#h79-0-55" id="h79-0-55" class="i">+                        nullable: false,
</a><a href="#h79-0-56" id="h79-0-56" class="i">+                        default: None,
</a><a href="#h79-0-57" id="h79-0-57" class="i">+                        unique: false,
</a><a href="#h79-0-58" id="h79-0-58" class="i">+                        references: None,
</a><a href="#h79-0-59" id="h79-0-59" class="i">+                        index: false,
</a><a href="#h79-0-60" id="h79-0-60" class="i">+                    },
</a><a href="#h79-0-61" id="h79-0-61" class="i">+                    Column {
</a><a href="#h79-0-62" id="h79-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h79-0-63" id="h79-0-63" class="i">+                        datatype: Float,
</a><a href="#h79-0-64" id="h79-0-64" class="i">+                        primary_key: false,
</a><a href="#h79-0-65" id="h79-0-65" class="i">+                        nullable: true,
</a><a href="#h79-0-66" id="h79-0-66" class="i">+                        default: Some(
</a><a href="#h79-0-67" id="h79-0-67" class="i">+                            Null,
</a><a href="#h79-0-68" id="h79-0-68" class="i">+                        ),
</a><a href="#h79-0-69" id="h79-0-69" class="i">+                        unique: false,
</a><a href="#h79-0-70" id="h79-0-70" class="i">+                        references: None,
</a><a href="#h79-0-71" id="h79-0-71" class="i">+                        index: false,
</a><a href="#h79-0-72" id="h79-0-72" class="i">+                    },
</a><a href="#h79-0-73" id="h79-0-73" class="i">+                    Column {
</a><a href="#h79-0-74" id="h79-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h79-0-75" id="h79-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h79-0-76" id="h79-0-76" class="i">+                        primary_key: false,
</a><a href="#h79-0-77" id="h79-0-77" class="i">+                        nullable: true,
</a><a href="#h79-0-78" id="h79-0-78" class="i">+                        default: Some(
</a><a href="#h79-0-79" id="h79-0-79" class="i">+                            Null,
</a><a href="#h79-0-80" id="h79-0-80" class="i">+                        ),
</a><a href="#h79-0-81" id="h79-0-81" class="i">+                        unique: false,
</a><a href="#h79-0-82" id="h79-0-82" class="i">+                        references: None,
</a><a href="#h79-0-83" id="h79-0-83" class="i">+                        index: false,
</a><a href="#h79-0-84" id="h79-0-84" class="i">+                    },
</a><a href="#h79-0-85" id="h79-0-85" class="i">+                ],
</a><a href="#h79-0-86" id="h79-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h79-1" id="h79-1" class="h">@@ -42,7 +124,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Limit {
         source: Scan {
<a href="#h79-1-3" id="h79-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h79-1-4" id="h79-1-4" class="i">+            table: Table {
</a><a href="#h79-1-5" id="h79-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h79-1-6" id="h79-1-6" class="i">+                columns: [
</a><a href="#h79-1-7" id="h79-1-7" class="i">+                    Column {
</a><a href="#h79-1-8" id="h79-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h79-1-9" id="h79-1-9" class="i">+                        datatype: Integer,
</a><a href="#h79-1-10" id="h79-1-10" class="i">+                        primary_key: true,
</a><a href="#h79-1-11" id="h79-1-11" class="i">+                        nullable: false,
</a><a href="#h79-1-12" id="h79-1-12" class="i">+                        default: None,
</a><a href="#h79-1-13" id="h79-1-13" class="i">+                        unique: true,
</a><a href="#h79-1-14" id="h79-1-14" class="i">+                        references: None,
</a><a href="#h79-1-15" id="h79-1-15" class="i">+                        index: false,
</a><a href="#h79-1-16" id="h79-1-16" class="i">+                    },
</a><a href="#h79-1-17" id="h79-1-17" class="i">+                    Column {
</a><a href="#h79-1-18" id="h79-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h79-1-19" id="h79-1-19" class="i">+                        datatype: String,
</a><a href="#h79-1-20" id="h79-1-20" class="i">+                        primary_key: false,
</a><a href="#h79-1-21" id="h79-1-21" class="i">+                        nullable: false,
</a><a href="#h79-1-22" id="h79-1-22" class="i">+                        default: None,
</a><a href="#h79-1-23" id="h79-1-23" class="i">+                        unique: false,
</a><a href="#h79-1-24" id="h79-1-24" class="i">+                        references: None,
</a><a href="#h79-1-25" id="h79-1-25" class="i">+                        index: false,
</a><a href="#h79-1-26" id="h79-1-26" class="i">+                    },
</a><a href="#h79-1-27" id="h79-1-27" class="i">+                    Column {
</a><a href="#h79-1-28" id="h79-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h79-1-29" id="h79-1-29" class="i">+                        datatype: Integer,
</a><a href="#h79-1-30" id="h79-1-30" class="i">+                        primary_key: false,
</a><a href="#h79-1-31" id="h79-1-31" class="i">+                        nullable: false,
</a><a href="#h79-1-32" id="h79-1-32" class="i">+                        default: None,
</a><a href="#h79-1-33" id="h79-1-33" class="i">+                        unique: false,
</a><a href="#h79-1-34" id="h79-1-34" class="i">+                        references: Some(
</a><a href="#h79-1-35" id="h79-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h79-1-36" id="h79-1-36" class="i">+                        ),
</a><a href="#h79-1-37" id="h79-1-37" class="i">+                        index: true,
</a><a href="#h79-1-38" id="h79-1-38" class="i">+                    },
</a><a href="#h79-1-39" id="h79-1-39" class="i">+                    Column {
</a><a href="#h79-1-40" id="h79-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h79-1-41" id="h79-1-41" class="i">+                        datatype: Integer,
</a><a href="#h79-1-42" id="h79-1-42" class="i">+                        primary_key: false,
</a><a href="#h79-1-43" id="h79-1-43" class="i">+                        nullable: false,
</a><a href="#h79-1-44" id="h79-1-44" class="i">+                        default: None,
</a><a href="#h79-1-45" id="h79-1-45" class="i">+                        unique: false,
</a><a href="#h79-1-46" id="h79-1-46" class="i">+                        references: Some(
</a><a href="#h79-1-47" id="h79-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h79-1-48" id="h79-1-48" class="i">+                        ),
</a><a href="#h79-1-49" id="h79-1-49" class="i">+                        index: true,
</a><a href="#h79-1-50" id="h79-1-50" class="i">+                    },
</a><a href="#h79-1-51" id="h79-1-51" class="i">+                    Column {
</a><a href="#h79-1-52" id="h79-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h79-1-53" id="h79-1-53" class="i">+                        datatype: Integer,
</a><a href="#h79-1-54" id="h79-1-54" class="i">+                        primary_key: false,
</a><a href="#h79-1-55" id="h79-1-55" class="i">+                        nullable: false,
</a><a href="#h79-1-56" id="h79-1-56" class="i">+                        default: None,
</a><a href="#h79-1-57" id="h79-1-57" class="i">+                        unique: false,
</a><a href="#h79-1-58" id="h79-1-58" class="i">+                        references: None,
</a><a href="#h79-1-59" id="h79-1-59" class="i">+                        index: false,
</a><a href="#h79-1-60" id="h79-1-60" class="i">+                    },
</a><a href="#h79-1-61" id="h79-1-61" class="i">+                    Column {
</a><a href="#h79-1-62" id="h79-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h79-1-63" id="h79-1-63" class="i">+                        datatype: Float,
</a><a href="#h79-1-64" id="h79-1-64" class="i">+                        primary_key: false,
</a><a href="#h79-1-65" id="h79-1-65" class="i">+                        nullable: true,
</a><a href="#h79-1-66" id="h79-1-66" class="i">+                        default: Some(
</a><a href="#h79-1-67" id="h79-1-67" class="i">+                            Null,
</a><a href="#h79-1-68" id="h79-1-68" class="i">+                        ),
</a><a href="#h79-1-69" id="h79-1-69" class="i">+                        unique: false,
</a><a href="#h79-1-70" id="h79-1-70" class="i">+                        references: None,
</a><a href="#h79-1-71" id="h79-1-71" class="i">+                        index: false,
</a><a href="#h79-1-72" id="h79-1-72" class="i">+                    },
</a><a href="#h79-1-73" id="h79-1-73" class="i">+                    Column {
</a><a href="#h79-1-74" id="h79-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h79-1-75" id="h79-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h79-1-76" id="h79-1-76" class="i">+                        primary_key: false,
</a><a href="#h79-1-77" id="h79-1-77" class="i">+                        nullable: true,
</a><a href="#h79-1-78" id="h79-1-78" class="i">+                        default: Some(
</a><a href="#h79-1-79" id="h79-1-79" class="i">+                            Null,
</a><a href="#h79-1-80" id="h79-1-80" class="i">+                        ),
</a><a href="#h79-1-81" id="h79-1-81" class="i">+                        unique: false,
</a><a href="#h79-1-82" id="h79-1-82" class="i">+                        references: None,
</a><a href="#h79-1-83" id="h79-1-83" class="i">+                        index: false,
</a><a href="#h79-1-84" id="h79-1-84" class="i">+                    },
</a><a href="#h79-1-85" id="h79-1-85" class="i">+                ],
</a><a href="#h79-1-86" id="h79-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h80" href="../file/tests/sql/query/offset.html">tests/sql/query/offset</a> b/<a href="../file/tests/sql/query/offset.html">tests/sql/query/offset</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -38,7 +38,89 @@ AST: Select {
</a> Plan: Select(
     Offset {
         source: Scan {
<a href="#h80-0-3" id="h80-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h80-0-4" id="h80-0-4" class="i">+            table: Table {
</a><a href="#h80-0-5" id="h80-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h80-0-6" id="h80-0-6" class="i">+                columns: [
</a><a href="#h80-0-7" id="h80-0-7" class="i">+                    Column {
</a><a href="#h80-0-8" id="h80-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h80-0-9" id="h80-0-9" class="i">+                        datatype: Integer,
</a><a href="#h80-0-10" id="h80-0-10" class="i">+                        primary_key: true,
</a><a href="#h80-0-11" id="h80-0-11" class="i">+                        nullable: false,
</a><a href="#h80-0-12" id="h80-0-12" class="i">+                        default: None,
</a><a href="#h80-0-13" id="h80-0-13" class="i">+                        unique: true,
</a><a href="#h80-0-14" id="h80-0-14" class="i">+                        references: None,
</a><a href="#h80-0-15" id="h80-0-15" class="i">+                        index: false,
</a><a href="#h80-0-16" id="h80-0-16" class="i">+                    },
</a><a href="#h80-0-17" id="h80-0-17" class="i">+                    Column {
</a><a href="#h80-0-18" id="h80-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h80-0-19" id="h80-0-19" class="i">+                        datatype: String,
</a><a href="#h80-0-20" id="h80-0-20" class="i">+                        primary_key: false,
</a><a href="#h80-0-21" id="h80-0-21" class="i">+                        nullable: false,
</a><a href="#h80-0-22" id="h80-0-22" class="i">+                        default: None,
</a><a href="#h80-0-23" id="h80-0-23" class="i">+                        unique: false,
</a><a href="#h80-0-24" id="h80-0-24" class="i">+                        references: None,
</a><a href="#h80-0-25" id="h80-0-25" class="i">+                        index: false,
</a><a href="#h80-0-26" id="h80-0-26" class="i">+                    },
</a><a href="#h80-0-27" id="h80-0-27" class="i">+                    Column {
</a><a href="#h80-0-28" id="h80-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h80-0-29" id="h80-0-29" class="i">+                        datatype: Integer,
</a><a href="#h80-0-30" id="h80-0-30" class="i">+                        primary_key: false,
</a><a href="#h80-0-31" id="h80-0-31" class="i">+                        nullable: false,
</a><a href="#h80-0-32" id="h80-0-32" class="i">+                        default: None,
</a><a href="#h80-0-33" id="h80-0-33" class="i">+                        unique: false,
</a><a href="#h80-0-34" id="h80-0-34" class="i">+                        references: Some(
</a><a href="#h80-0-35" id="h80-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h80-0-36" id="h80-0-36" class="i">+                        ),
</a><a href="#h80-0-37" id="h80-0-37" class="i">+                        index: true,
</a><a href="#h80-0-38" id="h80-0-38" class="i">+                    },
</a><a href="#h80-0-39" id="h80-0-39" class="i">+                    Column {
</a><a href="#h80-0-40" id="h80-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h80-0-41" id="h80-0-41" class="i">+                        datatype: Integer,
</a><a href="#h80-0-42" id="h80-0-42" class="i">+                        primary_key: false,
</a><a href="#h80-0-43" id="h80-0-43" class="i">+                        nullable: false,
</a><a href="#h80-0-44" id="h80-0-44" class="i">+                        default: None,
</a><a href="#h80-0-45" id="h80-0-45" class="i">+                        unique: false,
</a><a href="#h80-0-46" id="h80-0-46" class="i">+                        references: Some(
</a><a href="#h80-0-47" id="h80-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h80-0-48" id="h80-0-48" class="i">+                        ),
</a><a href="#h80-0-49" id="h80-0-49" class="i">+                        index: true,
</a><a href="#h80-0-50" id="h80-0-50" class="i">+                    },
</a><a href="#h80-0-51" id="h80-0-51" class="i">+                    Column {
</a><a href="#h80-0-52" id="h80-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h80-0-53" id="h80-0-53" class="i">+                        datatype: Integer,
</a><a href="#h80-0-54" id="h80-0-54" class="i">+                        primary_key: false,
</a><a href="#h80-0-55" id="h80-0-55" class="i">+                        nullable: false,
</a><a href="#h80-0-56" id="h80-0-56" class="i">+                        default: None,
</a><a href="#h80-0-57" id="h80-0-57" class="i">+                        unique: false,
</a><a href="#h80-0-58" id="h80-0-58" class="i">+                        references: None,
</a><a href="#h80-0-59" id="h80-0-59" class="i">+                        index: false,
</a><a href="#h80-0-60" id="h80-0-60" class="i">+                    },
</a><a href="#h80-0-61" id="h80-0-61" class="i">+                    Column {
</a><a href="#h80-0-62" id="h80-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h80-0-63" id="h80-0-63" class="i">+                        datatype: Float,
</a><a href="#h80-0-64" id="h80-0-64" class="i">+                        primary_key: false,
</a><a href="#h80-0-65" id="h80-0-65" class="i">+                        nullable: true,
</a><a href="#h80-0-66" id="h80-0-66" class="i">+                        default: Some(
</a><a href="#h80-0-67" id="h80-0-67" class="i">+                            Null,
</a><a href="#h80-0-68" id="h80-0-68" class="i">+                        ),
</a><a href="#h80-0-69" id="h80-0-69" class="i">+                        unique: false,
</a><a href="#h80-0-70" id="h80-0-70" class="i">+                        references: None,
</a><a href="#h80-0-71" id="h80-0-71" class="i">+                        index: false,
</a><a href="#h80-0-72" id="h80-0-72" class="i">+                    },
</a><a href="#h80-0-73" id="h80-0-73" class="i">+                    Column {
</a><a href="#h80-0-74" id="h80-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h80-0-75" id="h80-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h80-0-76" id="h80-0-76" class="i">+                        primary_key: false,
</a><a href="#h80-0-77" id="h80-0-77" class="i">+                        nullable: true,
</a><a href="#h80-0-78" id="h80-0-78" class="i">+                        default: Some(
</a><a href="#h80-0-79" id="h80-0-79" class="i">+                            Null,
</a><a href="#h80-0-80" id="h80-0-80" class="i">+                        ),
</a><a href="#h80-0-81" id="h80-0-81" class="i">+                        unique: false,
</a><a href="#h80-0-82" id="h80-0-82" class="i">+                        references: None,
</a><a href="#h80-0-83" id="h80-0-83" class="i">+                        index: false,
</a><a href="#h80-0-84" id="h80-0-84" class="i">+                    },
</a><a href="#h80-0-85" id="h80-0-85" class="i">+                ],
</a><a href="#h80-0-86" id="h80-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h80-1" id="h80-1" class="h">@@ -49,7 +131,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Offset {
         source: Scan {
<a href="#h80-1-3" id="h80-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h80-1-4" id="h80-1-4" class="i">+            table: Table {
</a><a href="#h80-1-5" id="h80-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h80-1-6" id="h80-1-6" class="i">+                columns: [
</a><a href="#h80-1-7" id="h80-1-7" class="i">+                    Column {
</a><a href="#h80-1-8" id="h80-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h80-1-9" id="h80-1-9" class="i">+                        datatype: Integer,
</a><a href="#h80-1-10" id="h80-1-10" class="i">+                        primary_key: true,
</a><a href="#h80-1-11" id="h80-1-11" class="i">+                        nullable: false,
</a><a href="#h80-1-12" id="h80-1-12" class="i">+                        default: None,
</a><a href="#h80-1-13" id="h80-1-13" class="i">+                        unique: true,
</a><a href="#h80-1-14" id="h80-1-14" class="i">+                        references: None,
</a><a href="#h80-1-15" id="h80-1-15" class="i">+                        index: false,
</a><a href="#h80-1-16" id="h80-1-16" class="i">+                    },
</a><a href="#h80-1-17" id="h80-1-17" class="i">+                    Column {
</a><a href="#h80-1-18" id="h80-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h80-1-19" id="h80-1-19" class="i">+                        datatype: String,
</a><a href="#h80-1-20" id="h80-1-20" class="i">+                        primary_key: false,
</a><a href="#h80-1-21" id="h80-1-21" class="i">+                        nullable: false,
</a><a href="#h80-1-22" id="h80-1-22" class="i">+                        default: None,
</a><a href="#h80-1-23" id="h80-1-23" class="i">+                        unique: false,
</a><a href="#h80-1-24" id="h80-1-24" class="i">+                        references: None,
</a><a href="#h80-1-25" id="h80-1-25" class="i">+                        index: false,
</a><a href="#h80-1-26" id="h80-1-26" class="i">+                    },
</a><a href="#h80-1-27" id="h80-1-27" class="i">+                    Column {
</a><a href="#h80-1-28" id="h80-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h80-1-29" id="h80-1-29" class="i">+                        datatype: Integer,
</a><a href="#h80-1-30" id="h80-1-30" class="i">+                        primary_key: false,
</a><a href="#h80-1-31" id="h80-1-31" class="i">+                        nullable: false,
</a><a href="#h80-1-32" id="h80-1-32" class="i">+                        default: None,
</a><a href="#h80-1-33" id="h80-1-33" class="i">+                        unique: false,
</a><a href="#h80-1-34" id="h80-1-34" class="i">+                        references: Some(
</a><a href="#h80-1-35" id="h80-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h80-1-36" id="h80-1-36" class="i">+                        ),
</a><a href="#h80-1-37" id="h80-1-37" class="i">+                        index: true,
</a><a href="#h80-1-38" id="h80-1-38" class="i">+                    },
</a><a href="#h80-1-39" id="h80-1-39" class="i">+                    Column {
</a><a href="#h80-1-40" id="h80-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h80-1-41" id="h80-1-41" class="i">+                        datatype: Integer,
</a><a href="#h80-1-42" id="h80-1-42" class="i">+                        primary_key: false,
</a><a href="#h80-1-43" id="h80-1-43" class="i">+                        nullable: false,
</a><a href="#h80-1-44" id="h80-1-44" class="i">+                        default: None,
</a><a href="#h80-1-45" id="h80-1-45" class="i">+                        unique: false,
</a><a href="#h80-1-46" id="h80-1-46" class="i">+                        references: Some(
</a><a href="#h80-1-47" id="h80-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h80-1-48" id="h80-1-48" class="i">+                        ),
</a><a href="#h80-1-49" id="h80-1-49" class="i">+                        index: true,
</a><a href="#h80-1-50" id="h80-1-50" class="i">+                    },
</a><a href="#h80-1-51" id="h80-1-51" class="i">+                    Column {
</a><a href="#h80-1-52" id="h80-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h80-1-53" id="h80-1-53" class="i">+                        datatype: Integer,
</a><a href="#h80-1-54" id="h80-1-54" class="i">+                        primary_key: false,
</a><a href="#h80-1-55" id="h80-1-55" class="i">+                        nullable: false,
</a><a href="#h80-1-56" id="h80-1-56" class="i">+                        default: None,
</a><a href="#h80-1-57" id="h80-1-57" class="i">+                        unique: false,
</a><a href="#h80-1-58" id="h80-1-58" class="i">+                        references: None,
</a><a href="#h80-1-59" id="h80-1-59" class="i">+                        index: false,
</a><a href="#h80-1-60" id="h80-1-60" class="i">+                    },
</a><a href="#h80-1-61" id="h80-1-61" class="i">+                    Column {
</a><a href="#h80-1-62" id="h80-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h80-1-63" id="h80-1-63" class="i">+                        datatype: Float,
</a><a href="#h80-1-64" id="h80-1-64" class="i">+                        primary_key: false,
</a><a href="#h80-1-65" id="h80-1-65" class="i">+                        nullable: true,
</a><a href="#h80-1-66" id="h80-1-66" class="i">+                        default: Some(
</a><a href="#h80-1-67" id="h80-1-67" class="i">+                            Null,
</a><a href="#h80-1-68" id="h80-1-68" class="i">+                        ),
</a><a href="#h80-1-69" id="h80-1-69" class="i">+                        unique: false,
</a><a href="#h80-1-70" id="h80-1-70" class="i">+                        references: None,
</a><a href="#h80-1-71" id="h80-1-71" class="i">+                        index: false,
</a><a href="#h80-1-72" id="h80-1-72" class="i">+                    },
</a><a href="#h80-1-73" id="h80-1-73" class="i">+                    Column {
</a><a href="#h80-1-74" id="h80-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h80-1-75" id="h80-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h80-1-76" id="h80-1-76" class="i">+                        primary_key: false,
</a><a href="#h80-1-77" id="h80-1-77" class="i">+                        nullable: true,
</a><a href="#h80-1-78" id="h80-1-78" class="i">+                        default: Some(
</a><a href="#h80-1-79" id="h80-1-79" class="i">+                            Null,
</a><a href="#h80-1-80" id="h80-1-80" class="i">+                        ),
</a><a href="#h80-1-81" id="h80-1-81" class="i">+                        unique: false,
</a><a href="#h80-1-82" id="h80-1-82" class="i">+                        references: None,
</a><a href="#h80-1-83" id="h80-1-83" class="i">+                        index: false,
</a><a href="#h80-1-84" id="h80-1-84" class="i">+                    },
</a><a href="#h80-1-85" id="h80-1-85" class="i">+                ],
</a><a href="#h80-1-86" id="h80-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h81" href="../file/tests/sql/query/offset_expr.html">tests/sql/query/offset_expr</a> b/<a href="../file/tests/sql/query/offset_expr.html">tests/sql/query/offset_expr</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -47,7 +47,89 @@ AST: Select {
</a> Plan: Select(
     Offset {
         source: Scan {
<a href="#h81-0-3" id="h81-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h81-0-4" id="h81-0-4" class="i">+            table: Table {
</a><a href="#h81-0-5" id="h81-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h81-0-6" id="h81-0-6" class="i">+                columns: [
</a><a href="#h81-0-7" id="h81-0-7" class="i">+                    Column {
</a><a href="#h81-0-8" id="h81-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h81-0-9" id="h81-0-9" class="i">+                        datatype: Integer,
</a><a href="#h81-0-10" id="h81-0-10" class="i">+                        primary_key: true,
</a><a href="#h81-0-11" id="h81-0-11" class="i">+                        nullable: false,
</a><a href="#h81-0-12" id="h81-0-12" class="i">+                        default: None,
</a><a href="#h81-0-13" id="h81-0-13" class="i">+                        unique: true,
</a><a href="#h81-0-14" id="h81-0-14" class="i">+                        references: None,
</a><a href="#h81-0-15" id="h81-0-15" class="i">+                        index: false,
</a><a href="#h81-0-16" id="h81-0-16" class="i">+                    },
</a><a href="#h81-0-17" id="h81-0-17" class="i">+                    Column {
</a><a href="#h81-0-18" id="h81-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h81-0-19" id="h81-0-19" class="i">+                        datatype: String,
</a><a href="#h81-0-20" id="h81-0-20" class="i">+                        primary_key: false,
</a><a href="#h81-0-21" id="h81-0-21" class="i">+                        nullable: false,
</a><a href="#h81-0-22" id="h81-0-22" class="i">+                        default: None,
</a><a href="#h81-0-23" id="h81-0-23" class="i">+                        unique: false,
</a><a href="#h81-0-24" id="h81-0-24" class="i">+                        references: None,
</a><a href="#h81-0-25" id="h81-0-25" class="i">+                        index: false,
</a><a href="#h81-0-26" id="h81-0-26" class="i">+                    },
</a><a href="#h81-0-27" id="h81-0-27" class="i">+                    Column {
</a><a href="#h81-0-28" id="h81-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h81-0-29" id="h81-0-29" class="i">+                        datatype: Integer,
</a><a href="#h81-0-30" id="h81-0-30" class="i">+                        primary_key: false,
</a><a href="#h81-0-31" id="h81-0-31" class="i">+                        nullable: false,
</a><a href="#h81-0-32" id="h81-0-32" class="i">+                        default: None,
</a><a href="#h81-0-33" id="h81-0-33" class="i">+                        unique: false,
</a><a href="#h81-0-34" id="h81-0-34" class="i">+                        references: Some(
</a><a href="#h81-0-35" id="h81-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h81-0-36" id="h81-0-36" class="i">+                        ),
</a><a href="#h81-0-37" id="h81-0-37" class="i">+                        index: true,
</a><a href="#h81-0-38" id="h81-0-38" class="i">+                    },
</a><a href="#h81-0-39" id="h81-0-39" class="i">+                    Column {
</a><a href="#h81-0-40" id="h81-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h81-0-41" id="h81-0-41" class="i">+                        datatype: Integer,
</a><a href="#h81-0-42" id="h81-0-42" class="i">+                        primary_key: false,
</a><a href="#h81-0-43" id="h81-0-43" class="i">+                        nullable: false,
</a><a href="#h81-0-44" id="h81-0-44" class="i">+                        default: None,
</a><a href="#h81-0-45" id="h81-0-45" class="i">+                        unique: false,
</a><a href="#h81-0-46" id="h81-0-46" class="i">+                        references: Some(
</a><a href="#h81-0-47" id="h81-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h81-0-48" id="h81-0-48" class="i">+                        ),
</a><a href="#h81-0-49" id="h81-0-49" class="i">+                        index: true,
</a><a href="#h81-0-50" id="h81-0-50" class="i">+                    },
</a><a href="#h81-0-51" id="h81-0-51" class="i">+                    Column {
</a><a href="#h81-0-52" id="h81-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h81-0-53" id="h81-0-53" class="i">+                        datatype: Integer,
</a><a href="#h81-0-54" id="h81-0-54" class="i">+                        primary_key: false,
</a><a href="#h81-0-55" id="h81-0-55" class="i">+                        nullable: false,
</a><a href="#h81-0-56" id="h81-0-56" class="i">+                        default: None,
</a><a href="#h81-0-57" id="h81-0-57" class="i">+                        unique: false,
</a><a href="#h81-0-58" id="h81-0-58" class="i">+                        references: None,
</a><a href="#h81-0-59" id="h81-0-59" class="i">+                        index: false,
</a><a href="#h81-0-60" id="h81-0-60" class="i">+                    },
</a><a href="#h81-0-61" id="h81-0-61" class="i">+                    Column {
</a><a href="#h81-0-62" id="h81-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h81-0-63" id="h81-0-63" class="i">+                        datatype: Float,
</a><a href="#h81-0-64" id="h81-0-64" class="i">+                        primary_key: false,
</a><a href="#h81-0-65" id="h81-0-65" class="i">+                        nullable: true,
</a><a href="#h81-0-66" id="h81-0-66" class="i">+                        default: Some(
</a><a href="#h81-0-67" id="h81-0-67" class="i">+                            Null,
</a><a href="#h81-0-68" id="h81-0-68" class="i">+                        ),
</a><a href="#h81-0-69" id="h81-0-69" class="i">+                        unique: false,
</a><a href="#h81-0-70" id="h81-0-70" class="i">+                        references: None,
</a><a href="#h81-0-71" id="h81-0-71" class="i">+                        index: false,
</a><a href="#h81-0-72" id="h81-0-72" class="i">+                    },
</a><a href="#h81-0-73" id="h81-0-73" class="i">+                    Column {
</a><a href="#h81-0-74" id="h81-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h81-0-75" id="h81-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h81-0-76" id="h81-0-76" class="i">+                        primary_key: false,
</a><a href="#h81-0-77" id="h81-0-77" class="i">+                        nullable: true,
</a><a href="#h81-0-78" id="h81-0-78" class="i">+                        default: Some(
</a><a href="#h81-0-79" id="h81-0-79" class="i">+                            Null,
</a><a href="#h81-0-80" id="h81-0-80" class="i">+                        ),
</a><a href="#h81-0-81" id="h81-0-81" class="i">+                        unique: false,
</a><a href="#h81-0-82" id="h81-0-82" class="i">+                        references: None,
</a><a href="#h81-0-83" id="h81-0-83" class="i">+                        index: false,
</a><a href="#h81-0-84" id="h81-0-84" class="i">+                    },
</a><a href="#h81-0-85" id="h81-0-85" class="i">+                ],
</a><a href="#h81-0-86" id="h81-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h81-1" id="h81-1" class="h">@@ -58,7 +140,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Offset {
         source: Scan {
<a href="#h81-1-3" id="h81-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h81-1-4" id="h81-1-4" class="i">+            table: Table {
</a><a href="#h81-1-5" id="h81-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h81-1-6" id="h81-1-6" class="i">+                columns: [
</a><a href="#h81-1-7" id="h81-1-7" class="i">+                    Column {
</a><a href="#h81-1-8" id="h81-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h81-1-9" id="h81-1-9" class="i">+                        datatype: Integer,
</a><a href="#h81-1-10" id="h81-1-10" class="i">+                        primary_key: true,
</a><a href="#h81-1-11" id="h81-1-11" class="i">+                        nullable: false,
</a><a href="#h81-1-12" id="h81-1-12" class="i">+                        default: None,
</a><a href="#h81-1-13" id="h81-1-13" class="i">+                        unique: true,
</a><a href="#h81-1-14" id="h81-1-14" class="i">+                        references: None,
</a><a href="#h81-1-15" id="h81-1-15" class="i">+                        index: false,
</a><a href="#h81-1-16" id="h81-1-16" class="i">+                    },
</a><a href="#h81-1-17" id="h81-1-17" class="i">+                    Column {
</a><a href="#h81-1-18" id="h81-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h81-1-19" id="h81-1-19" class="i">+                        datatype: String,
</a><a href="#h81-1-20" id="h81-1-20" class="i">+                        primary_key: false,
</a><a href="#h81-1-21" id="h81-1-21" class="i">+                        nullable: false,
</a><a href="#h81-1-22" id="h81-1-22" class="i">+                        default: None,
</a><a href="#h81-1-23" id="h81-1-23" class="i">+                        unique: false,
</a><a href="#h81-1-24" id="h81-1-24" class="i">+                        references: None,
</a><a href="#h81-1-25" id="h81-1-25" class="i">+                        index: false,
</a><a href="#h81-1-26" id="h81-1-26" class="i">+                    },
</a><a href="#h81-1-27" id="h81-1-27" class="i">+                    Column {
</a><a href="#h81-1-28" id="h81-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h81-1-29" id="h81-1-29" class="i">+                        datatype: Integer,
</a><a href="#h81-1-30" id="h81-1-30" class="i">+                        primary_key: false,
</a><a href="#h81-1-31" id="h81-1-31" class="i">+                        nullable: false,
</a><a href="#h81-1-32" id="h81-1-32" class="i">+                        default: None,
</a><a href="#h81-1-33" id="h81-1-33" class="i">+                        unique: false,
</a><a href="#h81-1-34" id="h81-1-34" class="i">+                        references: Some(
</a><a href="#h81-1-35" id="h81-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h81-1-36" id="h81-1-36" class="i">+                        ),
</a><a href="#h81-1-37" id="h81-1-37" class="i">+                        index: true,
</a><a href="#h81-1-38" id="h81-1-38" class="i">+                    },
</a><a href="#h81-1-39" id="h81-1-39" class="i">+                    Column {
</a><a href="#h81-1-40" id="h81-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h81-1-41" id="h81-1-41" class="i">+                        datatype: Integer,
</a><a href="#h81-1-42" id="h81-1-42" class="i">+                        primary_key: false,
</a><a href="#h81-1-43" id="h81-1-43" class="i">+                        nullable: false,
</a><a href="#h81-1-44" id="h81-1-44" class="i">+                        default: None,
</a><a href="#h81-1-45" id="h81-1-45" class="i">+                        unique: false,
</a><a href="#h81-1-46" id="h81-1-46" class="i">+                        references: Some(
</a><a href="#h81-1-47" id="h81-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h81-1-48" id="h81-1-48" class="i">+                        ),
</a><a href="#h81-1-49" id="h81-1-49" class="i">+                        index: true,
</a><a href="#h81-1-50" id="h81-1-50" class="i">+                    },
</a><a href="#h81-1-51" id="h81-1-51" class="i">+                    Column {
</a><a href="#h81-1-52" id="h81-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h81-1-53" id="h81-1-53" class="i">+                        datatype: Integer,
</a><a href="#h81-1-54" id="h81-1-54" class="i">+                        primary_key: false,
</a><a href="#h81-1-55" id="h81-1-55" class="i">+                        nullable: false,
</a><a href="#h81-1-56" id="h81-1-56" class="i">+                        default: None,
</a><a href="#h81-1-57" id="h81-1-57" class="i">+                        unique: false,
</a><a href="#h81-1-58" id="h81-1-58" class="i">+                        references: None,
</a><a href="#h81-1-59" id="h81-1-59" class="i">+                        index: false,
</a><a href="#h81-1-60" id="h81-1-60" class="i">+                    },
</a><a href="#h81-1-61" id="h81-1-61" class="i">+                    Column {
</a><a href="#h81-1-62" id="h81-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h81-1-63" id="h81-1-63" class="i">+                        datatype: Float,
</a><a href="#h81-1-64" id="h81-1-64" class="i">+                        primary_key: false,
</a><a href="#h81-1-65" id="h81-1-65" class="i">+                        nullable: true,
</a><a href="#h81-1-66" id="h81-1-66" class="i">+                        default: Some(
</a><a href="#h81-1-67" id="h81-1-67" class="i">+                            Null,
</a><a href="#h81-1-68" id="h81-1-68" class="i">+                        ),
</a><a href="#h81-1-69" id="h81-1-69" class="i">+                        unique: false,
</a><a href="#h81-1-70" id="h81-1-70" class="i">+                        references: None,
</a><a href="#h81-1-71" id="h81-1-71" class="i">+                        index: false,
</a><a href="#h81-1-72" id="h81-1-72" class="i">+                    },
</a><a href="#h81-1-73" id="h81-1-73" class="i">+                    Column {
</a><a href="#h81-1-74" id="h81-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h81-1-75" id="h81-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h81-1-76" id="h81-1-76" class="i">+                        primary_key: false,
</a><a href="#h81-1-77" id="h81-1-77" class="i">+                        nullable: true,
</a><a href="#h81-1-78" id="h81-1-78" class="i">+                        default: Some(
</a><a href="#h81-1-79" id="h81-1-79" class="i">+                            Null,
</a><a href="#h81-1-80" id="h81-1-80" class="i">+                        ),
</a><a href="#h81-1-81" id="h81-1-81" class="i">+                        unique: false,
</a><a href="#h81-1-82" id="h81-1-82" class="i">+                        references: None,
</a><a href="#h81-1-83" id="h81-1-83" class="i">+                        index: false,
</a><a href="#h81-1-84" id="h81-1-84" class="i">+                    },
</a><a href="#h81-1-85" id="h81-1-85" class="i">+                ],
</a><a href="#h81-1-86" id="h81-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h82" href="../file/tests/sql/query/offset_large.html">tests/sql/query/offset_large</a> b/<a href="../file/tests/sql/query/offset_large.html">tests/sql/query/offset_large</a></b>
<a href="#h82-0" id="h82-0" class="h">@@ -31,7 +31,89 @@ AST: Select {
</a> Plan: Select(
     Offset {
         source: Scan {
<a href="#h82-0-3" id="h82-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h82-0-4" id="h82-0-4" class="i">+            table: Table {
</a><a href="#h82-0-5" id="h82-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h82-0-6" id="h82-0-6" class="i">+                columns: [
</a><a href="#h82-0-7" id="h82-0-7" class="i">+                    Column {
</a><a href="#h82-0-8" id="h82-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h82-0-9" id="h82-0-9" class="i">+                        datatype: Integer,
</a><a href="#h82-0-10" id="h82-0-10" class="i">+                        primary_key: true,
</a><a href="#h82-0-11" id="h82-0-11" class="i">+                        nullable: false,
</a><a href="#h82-0-12" id="h82-0-12" class="i">+                        default: None,
</a><a href="#h82-0-13" id="h82-0-13" class="i">+                        unique: true,
</a><a href="#h82-0-14" id="h82-0-14" class="i">+                        references: None,
</a><a href="#h82-0-15" id="h82-0-15" class="i">+                        index: false,
</a><a href="#h82-0-16" id="h82-0-16" class="i">+                    },
</a><a href="#h82-0-17" id="h82-0-17" class="i">+                    Column {
</a><a href="#h82-0-18" id="h82-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h82-0-19" id="h82-0-19" class="i">+                        datatype: String,
</a><a href="#h82-0-20" id="h82-0-20" class="i">+                        primary_key: false,
</a><a href="#h82-0-21" id="h82-0-21" class="i">+                        nullable: false,
</a><a href="#h82-0-22" id="h82-0-22" class="i">+                        default: None,
</a><a href="#h82-0-23" id="h82-0-23" class="i">+                        unique: false,
</a><a href="#h82-0-24" id="h82-0-24" class="i">+                        references: None,
</a><a href="#h82-0-25" id="h82-0-25" class="i">+                        index: false,
</a><a href="#h82-0-26" id="h82-0-26" class="i">+                    },
</a><a href="#h82-0-27" id="h82-0-27" class="i">+                    Column {
</a><a href="#h82-0-28" id="h82-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h82-0-29" id="h82-0-29" class="i">+                        datatype: Integer,
</a><a href="#h82-0-30" id="h82-0-30" class="i">+                        primary_key: false,
</a><a href="#h82-0-31" id="h82-0-31" class="i">+                        nullable: false,
</a><a href="#h82-0-32" id="h82-0-32" class="i">+                        default: None,
</a><a href="#h82-0-33" id="h82-0-33" class="i">+                        unique: false,
</a><a href="#h82-0-34" id="h82-0-34" class="i">+                        references: Some(
</a><a href="#h82-0-35" id="h82-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h82-0-36" id="h82-0-36" class="i">+                        ),
</a><a href="#h82-0-37" id="h82-0-37" class="i">+                        index: true,
</a><a href="#h82-0-38" id="h82-0-38" class="i">+                    },
</a><a href="#h82-0-39" id="h82-0-39" class="i">+                    Column {
</a><a href="#h82-0-40" id="h82-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h82-0-41" id="h82-0-41" class="i">+                        datatype: Integer,
</a><a href="#h82-0-42" id="h82-0-42" class="i">+                        primary_key: false,
</a><a href="#h82-0-43" id="h82-0-43" class="i">+                        nullable: false,
</a><a href="#h82-0-44" id="h82-0-44" class="i">+                        default: None,
</a><a href="#h82-0-45" id="h82-0-45" class="i">+                        unique: false,
</a><a href="#h82-0-46" id="h82-0-46" class="i">+                        references: Some(
</a><a href="#h82-0-47" id="h82-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h82-0-48" id="h82-0-48" class="i">+                        ),
</a><a href="#h82-0-49" id="h82-0-49" class="i">+                        index: true,
</a><a href="#h82-0-50" id="h82-0-50" class="i">+                    },
</a><a href="#h82-0-51" id="h82-0-51" class="i">+                    Column {
</a><a href="#h82-0-52" id="h82-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h82-0-53" id="h82-0-53" class="i">+                        datatype: Integer,
</a><a href="#h82-0-54" id="h82-0-54" class="i">+                        primary_key: false,
</a><a href="#h82-0-55" id="h82-0-55" class="i">+                        nullable: false,
</a><a href="#h82-0-56" id="h82-0-56" class="i">+                        default: None,
</a><a href="#h82-0-57" id="h82-0-57" class="i">+                        unique: false,
</a><a href="#h82-0-58" id="h82-0-58" class="i">+                        references: None,
</a><a href="#h82-0-59" id="h82-0-59" class="i">+                        index: false,
</a><a href="#h82-0-60" id="h82-0-60" class="i">+                    },
</a><a href="#h82-0-61" id="h82-0-61" class="i">+                    Column {
</a><a href="#h82-0-62" id="h82-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h82-0-63" id="h82-0-63" class="i">+                        datatype: Float,
</a><a href="#h82-0-64" id="h82-0-64" class="i">+                        primary_key: false,
</a><a href="#h82-0-65" id="h82-0-65" class="i">+                        nullable: true,
</a><a href="#h82-0-66" id="h82-0-66" class="i">+                        default: Some(
</a><a href="#h82-0-67" id="h82-0-67" class="i">+                            Null,
</a><a href="#h82-0-68" id="h82-0-68" class="i">+                        ),
</a><a href="#h82-0-69" id="h82-0-69" class="i">+                        unique: false,
</a><a href="#h82-0-70" id="h82-0-70" class="i">+                        references: None,
</a><a href="#h82-0-71" id="h82-0-71" class="i">+                        index: false,
</a><a href="#h82-0-72" id="h82-0-72" class="i">+                    },
</a><a href="#h82-0-73" id="h82-0-73" class="i">+                    Column {
</a><a href="#h82-0-74" id="h82-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h82-0-75" id="h82-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h82-0-76" id="h82-0-76" class="i">+                        primary_key: false,
</a><a href="#h82-0-77" id="h82-0-77" class="i">+                        nullable: true,
</a><a href="#h82-0-78" id="h82-0-78" class="i">+                        default: Some(
</a><a href="#h82-0-79" id="h82-0-79" class="i">+                            Null,
</a><a href="#h82-0-80" id="h82-0-80" class="i">+                        ),
</a><a href="#h82-0-81" id="h82-0-81" class="i">+                        unique: false,
</a><a href="#h82-0-82" id="h82-0-82" class="i">+                        references: None,
</a><a href="#h82-0-83" id="h82-0-83" class="i">+                        index: false,
</a><a href="#h82-0-84" id="h82-0-84" class="i">+                    },
</a><a href="#h82-0-85" id="h82-0-85" class="i">+                ],
</a><a href="#h82-0-86" id="h82-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h82-1" id="h82-1" class="h">@@ -42,7 +124,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Offset {
         source: Scan {
<a href="#h82-1-3" id="h82-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h82-1-4" id="h82-1-4" class="i">+            table: Table {
</a><a href="#h82-1-5" id="h82-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h82-1-6" id="h82-1-6" class="i">+                columns: [
</a><a href="#h82-1-7" id="h82-1-7" class="i">+                    Column {
</a><a href="#h82-1-8" id="h82-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h82-1-9" id="h82-1-9" class="i">+                        datatype: Integer,
</a><a href="#h82-1-10" id="h82-1-10" class="i">+                        primary_key: true,
</a><a href="#h82-1-11" id="h82-1-11" class="i">+                        nullable: false,
</a><a href="#h82-1-12" id="h82-1-12" class="i">+                        default: None,
</a><a href="#h82-1-13" id="h82-1-13" class="i">+                        unique: true,
</a><a href="#h82-1-14" id="h82-1-14" class="i">+                        references: None,
</a><a href="#h82-1-15" id="h82-1-15" class="i">+                        index: false,
</a><a href="#h82-1-16" id="h82-1-16" class="i">+                    },
</a><a href="#h82-1-17" id="h82-1-17" class="i">+                    Column {
</a><a href="#h82-1-18" id="h82-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h82-1-19" id="h82-1-19" class="i">+                        datatype: String,
</a><a href="#h82-1-20" id="h82-1-20" class="i">+                        primary_key: false,
</a><a href="#h82-1-21" id="h82-1-21" class="i">+                        nullable: false,
</a><a href="#h82-1-22" id="h82-1-22" class="i">+                        default: None,
</a><a href="#h82-1-23" id="h82-1-23" class="i">+                        unique: false,
</a><a href="#h82-1-24" id="h82-1-24" class="i">+                        references: None,
</a><a href="#h82-1-25" id="h82-1-25" class="i">+                        index: false,
</a><a href="#h82-1-26" id="h82-1-26" class="i">+                    },
</a><a href="#h82-1-27" id="h82-1-27" class="i">+                    Column {
</a><a href="#h82-1-28" id="h82-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h82-1-29" id="h82-1-29" class="i">+                        datatype: Integer,
</a><a href="#h82-1-30" id="h82-1-30" class="i">+                        primary_key: false,
</a><a href="#h82-1-31" id="h82-1-31" class="i">+                        nullable: false,
</a><a href="#h82-1-32" id="h82-1-32" class="i">+                        default: None,
</a><a href="#h82-1-33" id="h82-1-33" class="i">+                        unique: false,
</a><a href="#h82-1-34" id="h82-1-34" class="i">+                        references: Some(
</a><a href="#h82-1-35" id="h82-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h82-1-36" id="h82-1-36" class="i">+                        ),
</a><a href="#h82-1-37" id="h82-1-37" class="i">+                        index: true,
</a><a href="#h82-1-38" id="h82-1-38" class="i">+                    },
</a><a href="#h82-1-39" id="h82-1-39" class="i">+                    Column {
</a><a href="#h82-1-40" id="h82-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h82-1-41" id="h82-1-41" class="i">+                        datatype: Integer,
</a><a href="#h82-1-42" id="h82-1-42" class="i">+                        primary_key: false,
</a><a href="#h82-1-43" id="h82-1-43" class="i">+                        nullable: false,
</a><a href="#h82-1-44" id="h82-1-44" class="i">+                        default: None,
</a><a href="#h82-1-45" id="h82-1-45" class="i">+                        unique: false,
</a><a href="#h82-1-46" id="h82-1-46" class="i">+                        references: Some(
</a><a href="#h82-1-47" id="h82-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h82-1-48" id="h82-1-48" class="i">+                        ),
</a><a href="#h82-1-49" id="h82-1-49" class="i">+                        index: true,
</a><a href="#h82-1-50" id="h82-1-50" class="i">+                    },
</a><a href="#h82-1-51" id="h82-1-51" class="i">+                    Column {
</a><a href="#h82-1-52" id="h82-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h82-1-53" id="h82-1-53" class="i">+                        datatype: Integer,
</a><a href="#h82-1-54" id="h82-1-54" class="i">+                        primary_key: false,
</a><a href="#h82-1-55" id="h82-1-55" class="i">+                        nullable: false,
</a><a href="#h82-1-56" id="h82-1-56" class="i">+                        default: None,
</a><a href="#h82-1-57" id="h82-1-57" class="i">+                        unique: false,
</a><a href="#h82-1-58" id="h82-1-58" class="i">+                        references: None,
</a><a href="#h82-1-59" id="h82-1-59" class="i">+                        index: false,
</a><a href="#h82-1-60" id="h82-1-60" class="i">+                    },
</a><a href="#h82-1-61" id="h82-1-61" class="i">+                    Column {
</a><a href="#h82-1-62" id="h82-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h82-1-63" id="h82-1-63" class="i">+                        datatype: Float,
</a><a href="#h82-1-64" id="h82-1-64" class="i">+                        primary_key: false,
</a><a href="#h82-1-65" id="h82-1-65" class="i">+                        nullable: true,
</a><a href="#h82-1-66" id="h82-1-66" class="i">+                        default: Some(
</a><a href="#h82-1-67" id="h82-1-67" class="i">+                            Null,
</a><a href="#h82-1-68" id="h82-1-68" class="i">+                        ),
</a><a href="#h82-1-69" id="h82-1-69" class="i">+                        unique: false,
</a><a href="#h82-1-70" id="h82-1-70" class="i">+                        references: None,
</a><a href="#h82-1-71" id="h82-1-71" class="i">+                        index: false,
</a><a href="#h82-1-72" id="h82-1-72" class="i">+                    },
</a><a href="#h82-1-73" id="h82-1-73" class="i">+                    Column {
</a><a href="#h82-1-74" id="h82-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h82-1-75" id="h82-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h82-1-76" id="h82-1-76" class="i">+                        primary_key: false,
</a><a href="#h82-1-77" id="h82-1-77" class="i">+                        nullable: true,
</a><a href="#h82-1-78" id="h82-1-78" class="i">+                        default: Some(
</a><a href="#h82-1-79" id="h82-1-79" class="i">+                            Null,
</a><a href="#h82-1-80" id="h82-1-80" class="i">+                        ),
</a><a href="#h82-1-81" id="h82-1-81" class="i">+                        unique: false,
</a><a href="#h82-1-82" id="h82-1-82" class="i">+                        references: None,
</a><a href="#h82-1-83" id="h82-1-83" class="i">+                        index: false,
</a><a href="#h82-1-84" id="h82-1-84" class="i">+                    },
</a><a href="#h82-1-85" id="h82-1-85" class="i">+                ],
</a><a href="#h82-1-86" id="h82-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h83" href="../file/tests/sql/query/offset_zero.html">tests/sql/query/offset_zero</a> b/<a href="../file/tests/sql/query/offset_zero.html">tests/sql/query/offset_zero</a></b>
<a href="#h83-0" id="h83-0" class="h">@@ -41,7 +41,89 @@ AST: Select {
</a> Plan: Select(
     Offset {
         source: Scan {
<a href="#h83-0-3" id="h83-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h83-0-4" id="h83-0-4" class="i">+            table: Table {
</a><a href="#h83-0-5" id="h83-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h83-0-6" id="h83-0-6" class="i">+                columns: [
</a><a href="#h83-0-7" id="h83-0-7" class="i">+                    Column {
</a><a href="#h83-0-8" id="h83-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h83-0-9" id="h83-0-9" class="i">+                        datatype: Integer,
</a><a href="#h83-0-10" id="h83-0-10" class="i">+                        primary_key: true,
</a><a href="#h83-0-11" id="h83-0-11" class="i">+                        nullable: false,
</a><a href="#h83-0-12" id="h83-0-12" class="i">+                        default: None,
</a><a href="#h83-0-13" id="h83-0-13" class="i">+                        unique: true,
</a><a href="#h83-0-14" id="h83-0-14" class="i">+                        references: None,
</a><a href="#h83-0-15" id="h83-0-15" class="i">+                        index: false,
</a><a href="#h83-0-16" id="h83-0-16" class="i">+                    },
</a><a href="#h83-0-17" id="h83-0-17" class="i">+                    Column {
</a><a href="#h83-0-18" id="h83-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h83-0-19" id="h83-0-19" class="i">+                        datatype: String,
</a><a href="#h83-0-20" id="h83-0-20" class="i">+                        primary_key: false,
</a><a href="#h83-0-21" id="h83-0-21" class="i">+                        nullable: false,
</a><a href="#h83-0-22" id="h83-0-22" class="i">+                        default: None,
</a><a href="#h83-0-23" id="h83-0-23" class="i">+                        unique: false,
</a><a href="#h83-0-24" id="h83-0-24" class="i">+                        references: None,
</a><a href="#h83-0-25" id="h83-0-25" class="i">+                        index: false,
</a><a href="#h83-0-26" id="h83-0-26" class="i">+                    },
</a><a href="#h83-0-27" id="h83-0-27" class="i">+                    Column {
</a><a href="#h83-0-28" id="h83-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h83-0-29" id="h83-0-29" class="i">+                        datatype: Integer,
</a><a href="#h83-0-30" id="h83-0-30" class="i">+                        primary_key: false,
</a><a href="#h83-0-31" id="h83-0-31" class="i">+                        nullable: false,
</a><a href="#h83-0-32" id="h83-0-32" class="i">+                        default: None,
</a><a href="#h83-0-33" id="h83-0-33" class="i">+                        unique: false,
</a><a href="#h83-0-34" id="h83-0-34" class="i">+                        references: Some(
</a><a href="#h83-0-35" id="h83-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h83-0-36" id="h83-0-36" class="i">+                        ),
</a><a href="#h83-0-37" id="h83-0-37" class="i">+                        index: true,
</a><a href="#h83-0-38" id="h83-0-38" class="i">+                    },
</a><a href="#h83-0-39" id="h83-0-39" class="i">+                    Column {
</a><a href="#h83-0-40" id="h83-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h83-0-41" id="h83-0-41" class="i">+                        datatype: Integer,
</a><a href="#h83-0-42" id="h83-0-42" class="i">+                        primary_key: false,
</a><a href="#h83-0-43" id="h83-0-43" class="i">+                        nullable: false,
</a><a href="#h83-0-44" id="h83-0-44" class="i">+                        default: None,
</a><a href="#h83-0-45" id="h83-0-45" class="i">+                        unique: false,
</a><a href="#h83-0-46" id="h83-0-46" class="i">+                        references: Some(
</a><a href="#h83-0-47" id="h83-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h83-0-48" id="h83-0-48" class="i">+                        ),
</a><a href="#h83-0-49" id="h83-0-49" class="i">+                        index: true,
</a><a href="#h83-0-50" id="h83-0-50" class="i">+                    },
</a><a href="#h83-0-51" id="h83-0-51" class="i">+                    Column {
</a><a href="#h83-0-52" id="h83-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h83-0-53" id="h83-0-53" class="i">+                        datatype: Integer,
</a><a href="#h83-0-54" id="h83-0-54" class="i">+                        primary_key: false,
</a><a href="#h83-0-55" id="h83-0-55" class="i">+                        nullable: false,
</a><a href="#h83-0-56" id="h83-0-56" class="i">+                        default: None,
</a><a href="#h83-0-57" id="h83-0-57" class="i">+                        unique: false,
</a><a href="#h83-0-58" id="h83-0-58" class="i">+                        references: None,
</a><a href="#h83-0-59" id="h83-0-59" class="i">+                        index: false,
</a><a href="#h83-0-60" id="h83-0-60" class="i">+                    },
</a><a href="#h83-0-61" id="h83-0-61" class="i">+                    Column {
</a><a href="#h83-0-62" id="h83-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h83-0-63" id="h83-0-63" class="i">+                        datatype: Float,
</a><a href="#h83-0-64" id="h83-0-64" class="i">+                        primary_key: false,
</a><a href="#h83-0-65" id="h83-0-65" class="i">+                        nullable: true,
</a><a href="#h83-0-66" id="h83-0-66" class="i">+                        default: Some(
</a><a href="#h83-0-67" id="h83-0-67" class="i">+                            Null,
</a><a href="#h83-0-68" id="h83-0-68" class="i">+                        ),
</a><a href="#h83-0-69" id="h83-0-69" class="i">+                        unique: false,
</a><a href="#h83-0-70" id="h83-0-70" class="i">+                        references: None,
</a><a href="#h83-0-71" id="h83-0-71" class="i">+                        index: false,
</a><a href="#h83-0-72" id="h83-0-72" class="i">+                    },
</a><a href="#h83-0-73" id="h83-0-73" class="i">+                    Column {
</a><a href="#h83-0-74" id="h83-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h83-0-75" id="h83-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h83-0-76" id="h83-0-76" class="i">+                        primary_key: false,
</a><a href="#h83-0-77" id="h83-0-77" class="i">+                        nullable: true,
</a><a href="#h83-0-78" id="h83-0-78" class="i">+                        default: Some(
</a><a href="#h83-0-79" id="h83-0-79" class="i">+                            Null,
</a><a href="#h83-0-80" id="h83-0-80" class="i">+                        ),
</a><a href="#h83-0-81" id="h83-0-81" class="i">+                        unique: false,
</a><a href="#h83-0-82" id="h83-0-82" class="i">+                        references: None,
</a><a href="#h83-0-83" id="h83-0-83" class="i">+                        index: false,
</a><a href="#h83-0-84" id="h83-0-84" class="i">+                    },
</a><a href="#h83-0-85" id="h83-0-85" class="i">+                ],
</a><a href="#h83-0-86" id="h83-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h83-1" id="h83-1" class="h">@@ -52,7 +134,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Offset {
         source: Scan {
<a href="#h83-1-3" id="h83-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h83-1-4" id="h83-1-4" class="i">+            table: Table {
</a><a href="#h83-1-5" id="h83-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h83-1-6" id="h83-1-6" class="i">+                columns: [
</a><a href="#h83-1-7" id="h83-1-7" class="i">+                    Column {
</a><a href="#h83-1-8" id="h83-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h83-1-9" id="h83-1-9" class="i">+                        datatype: Integer,
</a><a href="#h83-1-10" id="h83-1-10" class="i">+                        primary_key: true,
</a><a href="#h83-1-11" id="h83-1-11" class="i">+                        nullable: false,
</a><a href="#h83-1-12" id="h83-1-12" class="i">+                        default: None,
</a><a href="#h83-1-13" id="h83-1-13" class="i">+                        unique: true,
</a><a href="#h83-1-14" id="h83-1-14" class="i">+                        references: None,
</a><a href="#h83-1-15" id="h83-1-15" class="i">+                        index: false,
</a><a href="#h83-1-16" id="h83-1-16" class="i">+                    },
</a><a href="#h83-1-17" id="h83-1-17" class="i">+                    Column {
</a><a href="#h83-1-18" id="h83-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h83-1-19" id="h83-1-19" class="i">+                        datatype: String,
</a><a href="#h83-1-20" id="h83-1-20" class="i">+                        primary_key: false,
</a><a href="#h83-1-21" id="h83-1-21" class="i">+                        nullable: false,
</a><a href="#h83-1-22" id="h83-1-22" class="i">+                        default: None,
</a><a href="#h83-1-23" id="h83-1-23" class="i">+                        unique: false,
</a><a href="#h83-1-24" id="h83-1-24" class="i">+                        references: None,
</a><a href="#h83-1-25" id="h83-1-25" class="i">+                        index: false,
</a><a href="#h83-1-26" id="h83-1-26" class="i">+                    },
</a><a href="#h83-1-27" id="h83-1-27" class="i">+                    Column {
</a><a href="#h83-1-28" id="h83-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h83-1-29" id="h83-1-29" class="i">+                        datatype: Integer,
</a><a href="#h83-1-30" id="h83-1-30" class="i">+                        primary_key: false,
</a><a href="#h83-1-31" id="h83-1-31" class="i">+                        nullable: false,
</a><a href="#h83-1-32" id="h83-1-32" class="i">+                        default: None,
</a><a href="#h83-1-33" id="h83-1-33" class="i">+                        unique: false,
</a><a href="#h83-1-34" id="h83-1-34" class="i">+                        references: Some(
</a><a href="#h83-1-35" id="h83-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h83-1-36" id="h83-1-36" class="i">+                        ),
</a><a href="#h83-1-37" id="h83-1-37" class="i">+                        index: true,
</a><a href="#h83-1-38" id="h83-1-38" class="i">+                    },
</a><a href="#h83-1-39" id="h83-1-39" class="i">+                    Column {
</a><a href="#h83-1-40" id="h83-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h83-1-41" id="h83-1-41" class="i">+                        datatype: Integer,
</a><a href="#h83-1-42" id="h83-1-42" class="i">+                        primary_key: false,
</a><a href="#h83-1-43" id="h83-1-43" class="i">+                        nullable: false,
</a><a href="#h83-1-44" id="h83-1-44" class="i">+                        default: None,
</a><a href="#h83-1-45" id="h83-1-45" class="i">+                        unique: false,
</a><a href="#h83-1-46" id="h83-1-46" class="i">+                        references: Some(
</a><a href="#h83-1-47" id="h83-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h83-1-48" id="h83-1-48" class="i">+                        ),
</a><a href="#h83-1-49" id="h83-1-49" class="i">+                        index: true,
</a><a href="#h83-1-50" id="h83-1-50" class="i">+                    },
</a><a href="#h83-1-51" id="h83-1-51" class="i">+                    Column {
</a><a href="#h83-1-52" id="h83-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h83-1-53" id="h83-1-53" class="i">+                        datatype: Integer,
</a><a href="#h83-1-54" id="h83-1-54" class="i">+                        primary_key: false,
</a><a href="#h83-1-55" id="h83-1-55" class="i">+                        nullable: false,
</a><a href="#h83-1-56" id="h83-1-56" class="i">+                        default: None,
</a><a href="#h83-1-57" id="h83-1-57" class="i">+                        unique: false,
</a><a href="#h83-1-58" id="h83-1-58" class="i">+                        references: None,
</a><a href="#h83-1-59" id="h83-1-59" class="i">+                        index: false,
</a><a href="#h83-1-60" id="h83-1-60" class="i">+                    },
</a><a href="#h83-1-61" id="h83-1-61" class="i">+                    Column {
</a><a href="#h83-1-62" id="h83-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h83-1-63" id="h83-1-63" class="i">+                        datatype: Float,
</a><a href="#h83-1-64" id="h83-1-64" class="i">+                        primary_key: false,
</a><a href="#h83-1-65" id="h83-1-65" class="i">+                        nullable: true,
</a><a href="#h83-1-66" id="h83-1-66" class="i">+                        default: Some(
</a><a href="#h83-1-67" id="h83-1-67" class="i">+                            Null,
</a><a href="#h83-1-68" id="h83-1-68" class="i">+                        ),
</a><a href="#h83-1-69" id="h83-1-69" class="i">+                        unique: false,
</a><a href="#h83-1-70" id="h83-1-70" class="i">+                        references: None,
</a><a href="#h83-1-71" id="h83-1-71" class="i">+                        index: false,
</a><a href="#h83-1-72" id="h83-1-72" class="i">+                    },
</a><a href="#h83-1-73" id="h83-1-73" class="i">+                    Column {
</a><a href="#h83-1-74" id="h83-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h83-1-75" id="h83-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h83-1-76" id="h83-1-76" class="i">+                        primary_key: false,
</a><a href="#h83-1-77" id="h83-1-77" class="i">+                        nullable: true,
</a><a href="#h83-1-78" id="h83-1-78" class="i">+                        default: Some(
</a><a href="#h83-1-79" id="h83-1-79" class="i">+                            Null,
</a><a href="#h83-1-80" id="h83-1-80" class="i">+                        ),
</a><a href="#h83-1-81" id="h83-1-81" class="i">+                        unique: false,
</a><a href="#h83-1-82" id="h83-1-82" class="i">+                        references: None,
</a><a href="#h83-1-83" id="h83-1-83" class="i">+                        index: false,
</a><a href="#h83-1-84" id="h83-1-84" class="i">+                    },
</a><a href="#h83-1-85" id="h83-1-85" class="i">+                ],
</a><a href="#h83-1-86" id="h83-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h84" href="../file/tests/sql/query/order.html">tests/sql/query/order</a> b/<a href="../file/tests/sql/query/order.html">tests/sql/query/order</a></b>
<a href="#h84-0" id="h84-0" class="h">@@ -43,7 +43,89 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h84-0-3" id="h84-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h84-0-4" id="h84-0-4" class="i">+            table: Table {
</a><a href="#h84-0-5" id="h84-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h84-0-6" id="h84-0-6" class="i">+                columns: [
</a><a href="#h84-0-7" id="h84-0-7" class="i">+                    Column {
</a><a href="#h84-0-8" id="h84-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h84-0-9" id="h84-0-9" class="i">+                        datatype: Integer,
</a><a href="#h84-0-10" id="h84-0-10" class="i">+                        primary_key: true,
</a><a href="#h84-0-11" id="h84-0-11" class="i">+                        nullable: false,
</a><a href="#h84-0-12" id="h84-0-12" class="i">+                        default: None,
</a><a href="#h84-0-13" id="h84-0-13" class="i">+                        unique: true,
</a><a href="#h84-0-14" id="h84-0-14" class="i">+                        references: None,
</a><a href="#h84-0-15" id="h84-0-15" class="i">+                        index: false,
</a><a href="#h84-0-16" id="h84-0-16" class="i">+                    },
</a><a href="#h84-0-17" id="h84-0-17" class="i">+                    Column {
</a><a href="#h84-0-18" id="h84-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h84-0-19" id="h84-0-19" class="i">+                        datatype: String,
</a><a href="#h84-0-20" id="h84-0-20" class="i">+                        primary_key: false,
</a><a href="#h84-0-21" id="h84-0-21" class="i">+                        nullable: false,
</a><a href="#h84-0-22" id="h84-0-22" class="i">+                        default: None,
</a><a href="#h84-0-23" id="h84-0-23" class="i">+                        unique: false,
</a><a href="#h84-0-24" id="h84-0-24" class="i">+                        references: None,
</a><a href="#h84-0-25" id="h84-0-25" class="i">+                        index: false,
</a><a href="#h84-0-26" id="h84-0-26" class="i">+                    },
</a><a href="#h84-0-27" id="h84-0-27" class="i">+                    Column {
</a><a href="#h84-0-28" id="h84-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h84-0-29" id="h84-0-29" class="i">+                        datatype: Integer,
</a><a href="#h84-0-30" id="h84-0-30" class="i">+                        primary_key: false,
</a><a href="#h84-0-31" id="h84-0-31" class="i">+                        nullable: false,
</a><a href="#h84-0-32" id="h84-0-32" class="i">+                        default: None,
</a><a href="#h84-0-33" id="h84-0-33" class="i">+                        unique: false,
</a><a href="#h84-0-34" id="h84-0-34" class="i">+                        references: Some(
</a><a href="#h84-0-35" id="h84-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h84-0-36" id="h84-0-36" class="i">+                        ),
</a><a href="#h84-0-37" id="h84-0-37" class="i">+                        index: true,
</a><a href="#h84-0-38" id="h84-0-38" class="i">+                    },
</a><a href="#h84-0-39" id="h84-0-39" class="i">+                    Column {
</a><a href="#h84-0-40" id="h84-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h84-0-41" id="h84-0-41" class="i">+                        datatype: Integer,
</a><a href="#h84-0-42" id="h84-0-42" class="i">+                        primary_key: false,
</a><a href="#h84-0-43" id="h84-0-43" class="i">+                        nullable: false,
</a><a href="#h84-0-44" id="h84-0-44" class="i">+                        default: None,
</a><a href="#h84-0-45" id="h84-0-45" class="i">+                        unique: false,
</a><a href="#h84-0-46" id="h84-0-46" class="i">+                        references: Some(
</a><a href="#h84-0-47" id="h84-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h84-0-48" id="h84-0-48" class="i">+                        ),
</a><a href="#h84-0-49" id="h84-0-49" class="i">+                        index: true,
</a><a href="#h84-0-50" id="h84-0-50" class="i">+                    },
</a><a href="#h84-0-51" id="h84-0-51" class="i">+                    Column {
</a><a href="#h84-0-52" id="h84-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h84-0-53" id="h84-0-53" class="i">+                        datatype: Integer,
</a><a href="#h84-0-54" id="h84-0-54" class="i">+                        primary_key: false,
</a><a href="#h84-0-55" id="h84-0-55" class="i">+                        nullable: false,
</a><a href="#h84-0-56" id="h84-0-56" class="i">+                        default: None,
</a><a href="#h84-0-57" id="h84-0-57" class="i">+                        unique: false,
</a><a href="#h84-0-58" id="h84-0-58" class="i">+                        references: None,
</a><a href="#h84-0-59" id="h84-0-59" class="i">+                        index: false,
</a><a href="#h84-0-60" id="h84-0-60" class="i">+                    },
</a><a href="#h84-0-61" id="h84-0-61" class="i">+                    Column {
</a><a href="#h84-0-62" id="h84-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h84-0-63" id="h84-0-63" class="i">+                        datatype: Float,
</a><a href="#h84-0-64" id="h84-0-64" class="i">+                        primary_key: false,
</a><a href="#h84-0-65" id="h84-0-65" class="i">+                        nullable: true,
</a><a href="#h84-0-66" id="h84-0-66" class="i">+                        default: Some(
</a><a href="#h84-0-67" id="h84-0-67" class="i">+                            Null,
</a><a href="#h84-0-68" id="h84-0-68" class="i">+                        ),
</a><a href="#h84-0-69" id="h84-0-69" class="i">+                        unique: false,
</a><a href="#h84-0-70" id="h84-0-70" class="i">+                        references: None,
</a><a href="#h84-0-71" id="h84-0-71" class="i">+                        index: false,
</a><a href="#h84-0-72" id="h84-0-72" class="i">+                    },
</a><a href="#h84-0-73" id="h84-0-73" class="i">+                    Column {
</a><a href="#h84-0-74" id="h84-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h84-0-75" id="h84-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h84-0-76" id="h84-0-76" class="i">+                        primary_key: false,
</a><a href="#h84-0-77" id="h84-0-77" class="i">+                        nullable: true,
</a><a href="#h84-0-78" id="h84-0-78" class="i">+                        default: Some(
</a><a href="#h84-0-79" id="h84-0-79" class="i">+                            Null,
</a><a href="#h84-0-80" id="h84-0-80" class="i">+                        ),
</a><a href="#h84-0-81" id="h84-0-81" class="i">+                        unique: false,
</a><a href="#h84-0-82" id="h84-0-82" class="i">+                        references: None,
</a><a href="#h84-0-83" id="h84-0-83" class="i">+                        index: false,
</a><a href="#h84-0-84" id="h84-0-84" class="i">+                    },
</a><a href="#h84-0-85" id="h84-0-85" class="i">+                ],
</a><a href="#h84-0-86" id="h84-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h84-1" id="h84-1" class="h">@@ -67,7 +149,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h84-1-3" id="h84-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h84-1-4" id="h84-1-4" class="i">+            table: Table {
</a><a href="#h84-1-5" id="h84-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h84-1-6" id="h84-1-6" class="i">+                columns: [
</a><a href="#h84-1-7" id="h84-1-7" class="i">+                    Column {
</a><a href="#h84-1-8" id="h84-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h84-1-9" id="h84-1-9" class="i">+                        datatype: Integer,
</a><a href="#h84-1-10" id="h84-1-10" class="i">+                        primary_key: true,
</a><a href="#h84-1-11" id="h84-1-11" class="i">+                        nullable: false,
</a><a href="#h84-1-12" id="h84-1-12" class="i">+                        default: None,
</a><a href="#h84-1-13" id="h84-1-13" class="i">+                        unique: true,
</a><a href="#h84-1-14" id="h84-1-14" class="i">+                        references: None,
</a><a href="#h84-1-15" id="h84-1-15" class="i">+                        index: false,
</a><a href="#h84-1-16" id="h84-1-16" class="i">+                    },
</a><a href="#h84-1-17" id="h84-1-17" class="i">+                    Column {
</a><a href="#h84-1-18" id="h84-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h84-1-19" id="h84-1-19" class="i">+                        datatype: String,
</a><a href="#h84-1-20" id="h84-1-20" class="i">+                        primary_key: false,
</a><a href="#h84-1-21" id="h84-1-21" class="i">+                        nullable: false,
</a><a href="#h84-1-22" id="h84-1-22" class="i">+                        default: None,
</a><a href="#h84-1-23" id="h84-1-23" class="i">+                        unique: false,
</a><a href="#h84-1-24" id="h84-1-24" class="i">+                        references: None,
</a><a href="#h84-1-25" id="h84-1-25" class="i">+                        index: false,
</a><a href="#h84-1-26" id="h84-1-26" class="i">+                    },
</a><a href="#h84-1-27" id="h84-1-27" class="i">+                    Column {
</a><a href="#h84-1-28" id="h84-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h84-1-29" id="h84-1-29" class="i">+                        datatype: Integer,
</a><a href="#h84-1-30" id="h84-1-30" class="i">+                        primary_key: false,
</a><a href="#h84-1-31" id="h84-1-31" class="i">+                        nullable: false,
</a><a href="#h84-1-32" id="h84-1-32" class="i">+                        default: None,
</a><a href="#h84-1-33" id="h84-1-33" class="i">+                        unique: false,
</a><a href="#h84-1-34" id="h84-1-34" class="i">+                        references: Some(
</a><a href="#h84-1-35" id="h84-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h84-1-36" id="h84-1-36" class="i">+                        ),
</a><a href="#h84-1-37" id="h84-1-37" class="i">+                        index: true,
</a><a href="#h84-1-38" id="h84-1-38" class="i">+                    },
</a><a href="#h84-1-39" id="h84-1-39" class="i">+                    Column {
</a><a href="#h84-1-40" id="h84-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h84-1-41" id="h84-1-41" class="i">+                        datatype: Integer,
</a><a href="#h84-1-42" id="h84-1-42" class="i">+                        primary_key: false,
</a><a href="#h84-1-43" id="h84-1-43" class="i">+                        nullable: false,
</a><a href="#h84-1-44" id="h84-1-44" class="i">+                        default: None,
</a><a href="#h84-1-45" id="h84-1-45" class="i">+                        unique: false,
</a><a href="#h84-1-46" id="h84-1-46" class="i">+                        references: Some(
</a><a href="#h84-1-47" id="h84-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h84-1-48" id="h84-1-48" class="i">+                        ),
</a><a href="#h84-1-49" id="h84-1-49" class="i">+                        index: true,
</a><a href="#h84-1-50" id="h84-1-50" class="i">+                    },
</a><a href="#h84-1-51" id="h84-1-51" class="i">+                    Column {
</a><a href="#h84-1-52" id="h84-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h84-1-53" id="h84-1-53" class="i">+                        datatype: Integer,
</a><a href="#h84-1-54" id="h84-1-54" class="i">+                        primary_key: false,
</a><a href="#h84-1-55" id="h84-1-55" class="i">+                        nullable: false,
</a><a href="#h84-1-56" id="h84-1-56" class="i">+                        default: None,
</a><a href="#h84-1-57" id="h84-1-57" class="i">+                        unique: false,
</a><a href="#h84-1-58" id="h84-1-58" class="i">+                        references: None,
</a><a href="#h84-1-59" id="h84-1-59" class="i">+                        index: false,
</a><a href="#h84-1-60" id="h84-1-60" class="i">+                    },
</a><a href="#h84-1-61" id="h84-1-61" class="i">+                    Column {
</a><a href="#h84-1-62" id="h84-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h84-1-63" id="h84-1-63" class="i">+                        datatype: Float,
</a><a href="#h84-1-64" id="h84-1-64" class="i">+                        primary_key: false,
</a><a href="#h84-1-65" id="h84-1-65" class="i">+                        nullable: true,
</a><a href="#h84-1-66" id="h84-1-66" class="i">+                        default: Some(
</a><a href="#h84-1-67" id="h84-1-67" class="i">+                            Null,
</a><a href="#h84-1-68" id="h84-1-68" class="i">+                        ),
</a><a href="#h84-1-69" id="h84-1-69" class="i">+                        unique: false,
</a><a href="#h84-1-70" id="h84-1-70" class="i">+                        references: None,
</a><a href="#h84-1-71" id="h84-1-71" class="i">+                        index: false,
</a><a href="#h84-1-72" id="h84-1-72" class="i">+                    },
</a><a href="#h84-1-73" id="h84-1-73" class="i">+                    Column {
</a><a href="#h84-1-74" id="h84-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h84-1-75" id="h84-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h84-1-76" id="h84-1-76" class="i">+                        primary_key: false,
</a><a href="#h84-1-77" id="h84-1-77" class="i">+                        nullable: true,
</a><a href="#h84-1-78" id="h84-1-78" class="i">+                        default: Some(
</a><a href="#h84-1-79" id="h84-1-79" class="i">+                            Null,
</a><a href="#h84-1-80" id="h84-1-80" class="i">+                        ),
</a><a href="#h84-1-81" id="h84-1-81" class="i">+                        unique: false,
</a><a href="#h84-1-82" id="h84-1-82" class="i">+                        references: None,
</a><a href="#h84-1-83" id="h84-1-83" class="i">+                        index: false,
</a><a href="#h84-1-84" id="h84-1-84" class="i">+                    },
</a><a href="#h84-1-85" id="h84-1-85" class="i">+                ],
</a><a href="#h84-1-86" id="h84-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h85" href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a> b/<a href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a></b>
<a href="#h85-0" id="h85-0" class="h">@@ -73,7 +73,89 @@ Plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h85-0-3" id="h85-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h85-0-4" id="h85-0-4" class="i">+                        table: Table {
</a><a href="#h85-0-5" id="h85-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h85-0-6" id="h85-0-6" class="i">+                            columns: [
</a><a href="#h85-0-7" id="h85-0-7" class="i">+                                Column {
</a><a href="#h85-0-8" id="h85-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h85-0-9" id="h85-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h85-0-10" id="h85-0-10" class="i">+                                    primary_key: true,
</a><a href="#h85-0-11" id="h85-0-11" class="i">+                                    nullable: false,
</a><a href="#h85-0-12" id="h85-0-12" class="i">+                                    default: None,
</a><a href="#h85-0-13" id="h85-0-13" class="i">+                                    unique: true,
</a><a href="#h85-0-14" id="h85-0-14" class="i">+                                    references: None,
</a><a href="#h85-0-15" id="h85-0-15" class="i">+                                    index: false,
</a><a href="#h85-0-16" id="h85-0-16" class="i">+                                },
</a><a href="#h85-0-17" id="h85-0-17" class="i">+                                Column {
</a><a href="#h85-0-18" id="h85-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h85-0-19" id="h85-0-19" class="i">+                                    datatype: String,
</a><a href="#h85-0-20" id="h85-0-20" class="i">+                                    primary_key: false,
</a><a href="#h85-0-21" id="h85-0-21" class="i">+                                    nullable: false,
</a><a href="#h85-0-22" id="h85-0-22" class="i">+                                    default: None,
</a><a href="#h85-0-23" id="h85-0-23" class="i">+                                    unique: false,
</a><a href="#h85-0-24" id="h85-0-24" class="i">+                                    references: None,
</a><a href="#h85-0-25" id="h85-0-25" class="i">+                                    index: false,
</a><a href="#h85-0-26" id="h85-0-26" class="i">+                                },
</a><a href="#h85-0-27" id="h85-0-27" class="i">+                                Column {
</a><a href="#h85-0-28" id="h85-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h85-0-29" id="h85-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h85-0-30" id="h85-0-30" class="i">+                                    primary_key: false,
</a><a href="#h85-0-31" id="h85-0-31" class="i">+                                    nullable: false,
</a><a href="#h85-0-32" id="h85-0-32" class="i">+                                    default: None,
</a><a href="#h85-0-33" id="h85-0-33" class="i">+                                    unique: false,
</a><a href="#h85-0-34" id="h85-0-34" class="i">+                                    references: Some(
</a><a href="#h85-0-35" id="h85-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h85-0-36" id="h85-0-36" class="i">+                                    ),
</a><a href="#h85-0-37" id="h85-0-37" class="i">+                                    index: true,
</a><a href="#h85-0-38" id="h85-0-38" class="i">+                                },
</a><a href="#h85-0-39" id="h85-0-39" class="i">+                                Column {
</a><a href="#h85-0-40" id="h85-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h85-0-41" id="h85-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h85-0-42" id="h85-0-42" class="i">+                                    primary_key: false,
</a><a href="#h85-0-43" id="h85-0-43" class="i">+                                    nullable: false,
</a><a href="#h85-0-44" id="h85-0-44" class="i">+                                    default: None,
</a><a href="#h85-0-45" id="h85-0-45" class="i">+                                    unique: false,
</a><a href="#h85-0-46" id="h85-0-46" class="i">+                                    references: Some(
</a><a href="#h85-0-47" id="h85-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h85-0-48" id="h85-0-48" class="i">+                                    ),
</a><a href="#h85-0-49" id="h85-0-49" class="i">+                                    index: true,
</a><a href="#h85-0-50" id="h85-0-50" class="i">+                                },
</a><a href="#h85-0-51" id="h85-0-51" class="i">+                                Column {
</a><a href="#h85-0-52" id="h85-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h85-0-53" id="h85-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h85-0-54" id="h85-0-54" class="i">+                                    primary_key: false,
</a><a href="#h85-0-55" id="h85-0-55" class="i">+                                    nullable: false,
</a><a href="#h85-0-56" id="h85-0-56" class="i">+                                    default: None,
</a><a href="#h85-0-57" id="h85-0-57" class="i">+                                    unique: false,
</a><a href="#h85-0-58" id="h85-0-58" class="i">+                                    references: None,
</a><a href="#h85-0-59" id="h85-0-59" class="i">+                                    index: false,
</a><a href="#h85-0-60" id="h85-0-60" class="i">+                                },
</a><a href="#h85-0-61" id="h85-0-61" class="i">+                                Column {
</a><a href="#h85-0-62" id="h85-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h85-0-63" id="h85-0-63" class="i">+                                    datatype: Float,
</a><a href="#h85-0-64" id="h85-0-64" class="i">+                                    primary_key: false,
</a><a href="#h85-0-65" id="h85-0-65" class="i">+                                    nullable: true,
</a><a href="#h85-0-66" id="h85-0-66" class="i">+                                    default: Some(
</a><a href="#h85-0-67" id="h85-0-67" class="i">+                                        Null,
</a><a href="#h85-0-68" id="h85-0-68" class="i">+                                    ),
</a><a href="#h85-0-69" id="h85-0-69" class="i">+                                    unique: false,
</a><a href="#h85-0-70" id="h85-0-70" class="i">+                                    references: None,
</a><a href="#h85-0-71" id="h85-0-71" class="i">+                                    index: false,
</a><a href="#h85-0-72" id="h85-0-72" class="i">+                                },
</a><a href="#h85-0-73" id="h85-0-73" class="i">+                                Column {
</a><a href="#h85-0-74" id="h85-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h85-0-75" id="h85-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h85-0-76" id="h85-0-76" class="i">+                                    primary_key: false,
</a><a href="#h85-0-77" id="h85-0-77" class="i">+                                    nullable: true,
</a><a href="#h85-0-78" id="h85-0-78" class="i">+                                    default: Some(
</a><a href="#h85-0-79" id="h85-0-79" class="i">+                                        Null,
</a><a href="#h85-0-80" id="h85-0-80" class="i">+                                    ),
</a><a href="#h85-0-81" id="h85-0-81" class="i">+                                    unique: false,
</a><a href="#h85-0-82" id="h85-0-82" class="i">+                                    references: None,
</a><a href="#h85-0-83" id="h85-0-83" class="i">+                                    index: false,
</a><a href="#h85-0-84" id="h85-0-84" class="i">+                                },
</a><a href="#h85-0-85" id="h85-0-85" class="i">+                            ],
</a><a href="#h85-0-86" id="h85-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h85-1" id="h85-1" class="h">@@ -150,7 +232,89 @@ Optimized plan: Select(
</a>             source: Aggregation {
                 source: Projection {
                     source: Scan {
<a href="#h85-1-3" id="h85-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h85-1-4" id="h85-1-4" class="i">+                        table: Table {
</a><a href="#h85-1-5" id="h85-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h85-1-6" id="h85-1-6" class="i">+                            columns: [
</a><a href="#h85-1-7" id="h85-1-7" class="i">+                                Column {
</a><a href="#h85-1-8" id="h85-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h85-1-9" id="h85-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h85-1-10" id="h85-1-10" class="i">+                                    primary_key: true,
</a><a href="#h85-1-11" id="h85-1-11" class="i">+                                    nullable: false,
</a><a href="#h85-1-12" id="h85-1-12" class="i">+                                    default: None,
</a><a href="#h85-1-13" id="h85-1-13" class="i">+                                    unique: true,
</a><a href="#h85-1-14" id="h85-1-14" class="i">+                                    references: None,
</a><a href="#h85-1-15" id="h85-1-15" class="i">+                                    index: false,
</a><a href="#h85-1-16" id="h85-1-16" class="i">+                                },
</a><a href="#h85-1-17" id="h85-1-17" class="i">+                                Column {
</a><a href="#h85-1-18" id="h85-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h85-1-19" id="h85-1-19" class="i">+                                    datatype: String,
</a><a href="#h85-1-20" id="h85-1-20" class="i">+                                    primary_key: false,
</a><a href="#h85-1-21" id="h85-1-21" class="i">+                                    nullable: false,
</a><a href="#h85-1-22" id="h85-1-22" class="i">+                                    default: None,
</a><a href="#h85-1-23" id="h85-1-23" class="i">+                                    unique: false,
</a><a href="#h85-1-24" id="h85-1-24" class="i">+                                    references: None,
</a><a href="#h85-1-25" id="h85-1-25" class="i">+                                    index: false,
</a><a href="#h85-1-26" id="h85-1-26" class="i">+                                },
</a><a href="#h85-1-27" id="h85-1-27" class="i">+                                Column {
</a><a href="#h85-1-28" id="h85-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h85-1-29" id="h85-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h85-1-30" id="h85-1-30" class="i">+                                    primary_key: false,
</a><a href="#h85-1-31" id="h85-1-31" class="i">+                                    nullable: false,
</a><a href="#h85-1-32" id="h85-1-32" class="i">+                                    default: None,
</a><a href="#h85-1-33" id="h85-1-33" class="i">+                                    unique: false,
</a><a href="#h85-1-34" id="h85-1-34" class="i">+                                    references: Some(
</a><a href="#h85-1-35" id="h85-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h85-1-36" id="h85-1-36" class="i">+                                    ),
</a><a href="#h85-1-37" id="h85-1-37" class="i">+                                    index: true,
</a><a href="#h85-1-38" id="h85-1-38" class="i">+                                },
</a><a href="#h85-1-39" id="h85-1-39" class="i">+                                Column {
</a><a href="#h85-1-40" id="h85-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h85-1-41" id="h85-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h85-1-42" id="h85-1-42" class="i">+                                    primary_key: false,
</a><a href="#h85-1-43" id="h85-1-43" class="i">+                                    nullable: false,
</a><a href="#h85-1-44" id="h85-1-44" class="i">+                                    default: None,
</a><a href="#h85-1-45" id="h85-1-45" class="i">+                                    unique: false,
</a><a href="#h85-1-46" id="h85-1-46" class="i">+                                    references: Some(
</a><a href="#h85-1-47" id="h85-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h85-1-48" id="h85-1-48" class="i">+                                    ),
</a><a href="#h85-1-49" id="h85-1-49" class="i">+                                    index: true,
</a><a href="#h85-1-50" id="h85-1-50" class="i">+                                },
</a><a href="#h85-1-51" id="h85-1-51" class="i">+                                Column {
</a><a href="#h85-1-52" id="h85-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h85-1-53" id="h85-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h85-1-54" id="h85-1-54" class="i">+                                    primary_key: false,
</a><a href="#h85-1-55" id="h85-1-55" class="i">+                                    nullable: false,
</a><a href="#h85-1-56" id="h85-1-56" class="i">+                                    default: None,
</a><a href="#h85-1-57" id="h85-1-57" class="i">+                                    unique: false,
</a><a href="#h85-1-58" id="h85-1-58" class="i">+                                    references: None,
</a><a href="#h85-1-59" id="h85-1-59" class="i">+                                    index: false,
</a><a href="#h85-1-60" id="h85-1-60" class="i">+                                },
</a><a href="#h85-1-61" id="h85-1-61" class="i">+                                Column {
</a><a href="#h85-1-62" id="h85-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h85-1-63" id="h85-1-63" class="i">+                                    datatype: Float,
</a><a href="#h85-1-64" id="h85-1-64" class="i">+                                    primary_key: false,
</a><a href="#h85-1-65" id="h85-1-65" class="i">+                                    nullable: true,
</a><a href="#h85-1-66" id="h85-1-66" class="i">+                                    default: Some(
</a><a href="#h85-1-67" id="h85-1-67" class="i">+                                        Null,
</a><a href="#h85-1-68" id="h85-1-68" class="i">+                                    ),
</a><a href="#h85-1-69" id="h85-1-69" class="i">+                                    unique: false,
</a><a href="#h85-1-70" id="h85-1-70" class="i">+                                    references: None,
</a><a href="#h85-1-71" id="h85-1-71" class="i">+                                    index: false,
</a><a href="#h85-1-72" id="h85-1-72" class="i">+                                },
</a><a href="#h85-1-73" id="h85-1-73" class="i">+                                Column {
</a><a href="#h85-1-74" id="h85-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h85-1-75" id="h85-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h85-1-76" id="h85-1-76" class="i">+                                    primary_key: false,
</a><a href="#h85-1-77" id="h85-1-77" class="i">+                                    nullable: true,
</a><a href="#h85-1-78" id="h85-1-78" class="i">+                                    default: Some(
</a><a href="#h85-1-79" id="h85-1-79" class="i">+                                        Null,
</a><a href="#h85-1-80" id="h85-1-80" class="i">+                                    ),
</a><a href="#h85-1-81" id="h85-1-81" class="i">+                                    unique: false,
</a><a href="#h85-1-82" id="h85-1-82" class="i">+                                    references: None,
</a><a href="#h85-1-83" id="h85-1-83" class="i">+                                    index: false,
</a><a href="#h85-1-84" id="h85-1-84" class="i">+                                },
</a><a href="#h85-1-85" id="h85-1-85" class="i">+                            ],
</a><a href="#h85-1-86" id="h85-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h86" href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a> b/<a href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a></b>
<a href="#h86-0" id="h86-0" class="h">@@ -75,7 +75,89 @@ Plan: Select(
</a>                 source: Aggregation {
                     source: Projection {
                         source: Scan {
<a href="#h86-0-3" id="h86-0-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h86-0-4" id="h86-0-4" class="i">+                            table: Table {
</a><a href="#h86-0-5" id="h86-0-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h86-0-6" id="h86-0-6" class="i">+                                columns: [
</a><a href="#h86-0-7" id="h86-0-7" class="i">+                                    Column {
</a><a href="#h86-0-8" id="h86-0-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h86-0-9" id="h86-0-9" class="i">+                                        datatype: Integer,
</a><a href="#h86-0-10" id="h86-0-10" class="i">+                                        primary_key: true,
</a><a href="#h86-0-11" id="h86-0-11" class="i">+                                        nullable: false,
</a><a href="#h86-0-12" id="h86-0-12" class="i">+                                        default: None,
</a><a href="#h86-0-13" id="h86-0-13" class="i">+                                        unique: true,
</a><a href="#h86-0-14" id="h86-0-14" class="i">+                                        references: None,
</a><a href="#h86-0-15" id="h86-0-15" class="i">+                                        index: false,
</a><a href="#h86-0-16" id="h86-0-16" class="i">+                                    },
</a><a href="#h86-0-17" id="h86-0-17" class="i">+                                    Column {
</a><a href="#h86-0-18" id="h86-0-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h86-0-19" id="h86-0-19" class="i">+                                        datatype: String,
</a><a href="#h86-0-20" id="h86-0-20" class="i">+                                        primary_key: false,
</a><a href="#h86-0-21" id="h86-0-21" class="i">+                                        nullable: false,
</a><a href="#h86-0-22" id="h86-0-22" class="i">+                                        default: None,
</a><a href="#h86-0-23" id="h86-0-23" class="i">+                                        unique: false,
</a><a href="#h86-0-24" id="h86-0-24" class="i">+                                        references: None,
</a><a href="#h86-0-25" id="h86-0-25" class="i">+                                        index: false,
</a><a href="#h86-0-26" id="h86-0-26" class="i">+                                    },
</a><a href="#h86-0-27" id="h86-0-27" class="i">+                                    Column {
</a><a href="#h86-0-28" id="h86-0-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h86-0-29" id="h86-0-29" class="i">+                                        datatype: Integer,
</a><a href="#h86-0-30" id="h86-0-30" class="i">+                                        primary_key: false,
</a><a href="#h86-0-31" id="h86-0-31" class="i">+                                        nullable: false,
</a><a href="#h86-0-32" id="h86-0-32" class="i">+                                        default: None,
</a><a href="#h86-0-33" id="h86-0-33" class="i">+                                        unique: false,
</a><a href="#h86-0-34" id="h86-0-34" class="i">+                                        references: Some(
</a><a href="#h86-0-35" id="h86-0-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h86-0-36" id="h86-0-36" class="i">+                                        ),
</a><a href="#h86-0-37" id="h86-0-37" class="i">+                                        index: true,
</a><a href="#h86-0-38" id="h86-0-38" class="i">+                                    },
</a><a href="#h86-0-39" id="h86-0-39" class="i">+                                    Column {
</a><a href="#h86-0-40" id="h86-0-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h86-0-41" id="h86-0-41" class="i">+                                        datatype: Integer,
</a><a href="#h86-0-42" id="h86-0-42" class="i">+                                        primary_key: false,
</a><a href="#h86-0-43" id="h86-0-43" class="i">+                                        nullable: false,
</a><a href="#h86-0-44" id="h86-0-44" class="i">+                                        default: None,
</a><a href="#h86-0-45" id="h86-0-45" class="i">+                                        unique: false,
</a><a href="#h86-0-46" id="h86-0-46" class="i">+                                        references: Some(
</a><a href="#h86-0-47" id="h86-0-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h86-0-48" id="h86-0-48" class="i">+                                        ),
</a><a href="#h86-0-49" id="h86-0-49" class="i">+                                        index: true,
</a><a href="#h86-0-50" id="h86-0-50" class="i">+                                    },
</a><a href="#h86-0-51" id="h86-0-51" class="i">+                                    Column {
</a><a href="#h86-0-52" id="h86-0-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h86-0-53" id="h86-0-53" class="i">+                                        datatype: Integer,
</a><a href="#h86-0-54" id="h86-0-54" class="i">+                                        primary_key: false,
</a><a href="#h86-0-55" id="h86-0-55" class="i">+                                        nullable: false,
</a><a href="#h86-0-56" id="h86-0-56" class="i">+                                        default: None,
</a><a href="#h86-0-57" id="h86-0-57" class="i">+                                        unique: false,
</a><a href="#h86-0-58" id="h86-0-58" class="i">+                                        references: None,
</a><a href="#h86-0-59" id="h86-0-59" class="i">+                                        index: false,
</a><a href="#h86-0-60" id="h86-0-60" class="i">+                                    },
</a><a href="#h86-0-61" id="h86-0-61" class="i">+                                    Column {
</a><a href="#h86-0-62" id="h86-0-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h86-0-63" id="h86-0-63" class="i">+                                        datatype: Float,
</a><a href="#h86-0-64" id="h86-0-64" class="i">+                                        primary_key: false,
</a><a href="#h86-0-65" id="h86-0-65" class="i">+                                        nullable: true,
</a><a href="#h86-0-66" id="h86-0-66" class="i">+                                        default: Some(
</a><a href="#h86-0-67" id="h86-0-67" class="i">+                                            Null,
</a><a href="#h86-0-68" id="h86-0-68" class="i">+                                        ),
</a><a href="#h86-0-69" id="h86-0-69" class="i">+                                        unique: false,
</a><a href="#h86-0-70" id="h86-0-70" class="i">+                                        references: None,
</a><a href="#h86-0-71" id="h86-0-71" class="i">+                                        index: false,
</a><a href="#h86-0-72" id="h86-0-72" class="i">+                                    },
</a><a href="#h86-0-73" id="h86-0-73" class="i">+                                    Column {
</a><a href="#h86-0-74" id="h86-0-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h86-0-75" id="h86-0-75" class="i">+                                        datatype: Boolean,
</a><a href="#h86-0-76" id="h86-0-76" class="i">+                                        primary_key: false,
</a><a href="#h86-0-77" id="h86-0-77" class="i">+                                        nullable: true,
</a><a href="#h86-0-78" id="h86-0-78" class="i">+                                        default: Some(
</a><a href="#h86-0-79" id="h86-0-79" class="i">+                                            Null,
</a><a href="#h86-0-80" id="h86-0-80" class="i">+                                        ),
</a><a href="#h86-0-81" id="h86-0-81" class="i">+                                        unique: false,
</a><a href="#h86-0-82" id="h86-0-82" class="i">+                                        references: None,
</a><a href="#h86-0-83" id="h86-0-83" class="i">+                                        index: false,
</a><a href="#h86-0-84" id="h86-0-84" class="i">+                                    },
</a><a href="#h86-0-85" id="h86-0-85" class="i">+                                ],
</a><a href="#h86-0-86" id="h86-0-86" class="i">+                            },
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h86-1" id="h86-1" class="h">@@ -190,7 +272,89 @@ Optimized plan: Select(
</a>                 source: Aggregation {
                     source: Projection {
                         source: Scan {
<a href="#h86-1-3" id="h86-1-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h86-1-4" id="h86-1-4" class="i">+                            table: Table {
</a><a href="#h86-1-5" id="h86-1-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h86-1-6" id="h86-1-6" class="i">+                                columns: [
</a><a href="#h86-1-7" id="h86-1-7" class="i">+                                    Column {
</a><a href="#h86-1-8" id="h86-1-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h86-1-9" id="h86-1-9" class="i">+                                        datatype: Integer,
</a><a href="#h86-1-10" id="h86-1-10" class="i">+                                        primary_key: true,
</a><a href="#h86-1-11" id="h86-1-11" class="i">+                                        nullable: false,
</a><a href="#h86-1-12" id="h86-1-12" class="i">+                                        default: None,
</a><a href="#h86-1-13" id="h86-1-13" class="i">+                                        unique: true,
</a><a href="#h86-1-14" id="h86-1-14" class="i">+                                        references: None,
</a><a href="#h86-1-15" id="h86-1-15" class="i">+                                        index: false,
</a><a href="#h86-1-16" id="h86-1-16" class="i">+                                    },
</a><a href="#h86-1-17" id="h86-1-17" class="i">+                                    Column {
</a><a href="#h86-1-18" id="h86-1-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h86-1-19" id="h86-1-19" class="i">+                                        datatype: String,
</a><a href="#h86-1-20" id="h86-1-20" class="i">+                                        primary_key: false,
</a><a href="#h86-1-21" id="h86-1-21" class="i">+                                        nullable: false,
</a><a href="#h86-1-22" id="h86-1-22" class="i">+                                        default: None,
</a><a href="#h86-1-23" id="h86-1-23" class="i">+                                        unique: false,
</a><a href="#h86-1-24" id="h86-1-24" class="i">+                                        references: None,
</a><a href="#h86-1-25" id="h86-1-25" class="i">+                                        index: false,
</a><a href="#h86-1-26" id="h86-1-26" class="i">+                                    },
</a><a href="#h86-1-27" id="h86-1-27" class="i">+                                    Column {
</a><a href="#h86-1-28" id="h86-1-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h86-1-29" id="h86-1-29" class="i">+                                        datatype: Integer,
</a><a href="#h86-1-30" id="h86-1-30" class="i">+                                        primary_key: false,
</a><a href="#h86-1-31" id="h86-1-31" class="i">+                                        nullable: false,
</a><a href="#h86-1-32" id="h86-1-32" class="i">+                                        default: None,
</a><a href="#h86-1-33" id="h86-1-33" class="i">+                                        unique: false,
</a><a href="#h86-1-34" id="h86-1-34" class="i">+                                        references: Some(
</a><a href="#h86-1-35" id="h86-1-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h86-1-36" id="h86-1-36" class="i">+                                        ),
</a><a href="#h86-1-37" id="h86-1-37" class="i">+                                        index: true,
</a><a href="#h86-1-38" id="h86-1-38" class="i">+                                    },
</a><a href="#h86-1-39" id="h86-1-39" class="i">+                                    Column {
</a><a href="#h86-1-40" id="h86-1-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h86-1-41" id="h86-1-41" class="i">+                                        datatype: Integer,
</a><a href="#h86-1-42" id="h86-1-42" class="i">+                                        primary_key: false,
</a><a href="#h86-1-43" id="h86-1-43" class="i">+                                        nullable: false,
</a><a href="#h86-1-44" id="h86-1-44" class="i">+                                        default: None,
</a><a href="#h86-1-45" id="h86-1-45" class="i">+                                        unique: false,
</a><a href="#h86-1-46" id="h86-1-46" class="i">+                                        references: Some(
</a><a href="#h86-1-47" id="h86-1-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h86-1-48" id="h86-1-48" class="i">+                                        ),
</a><a href="#h86-1-49" id="h86-1-49" class="i">+                                        index: true,
</a><a href="#h86-1-50" id="h86-1-50" class="i">+                                    },
</a><a href="#h86-1-51" id="h86-1-51" class="i">+                                    Column {
</a><a href="#h86-1-52" id="h86-1-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h86-1-53" id="h86-1-53" class="i">+                                        datatype: Integer,
</a><a href="#h86-1-54" id="h86-1-54" class="i">+                                        primary_key: false,
</a><a href="#h86-1-55" id="h86-1-55" class="i">+                                        nullable: false,
</a><a href="#h86-1-56" id="h86-1-56" class="i">+                                        default: None,
</a><a href="#h86-1-57" id="h86-1-57" class="i">+                                        unique: false,
</a><a href="#h86-1-58" id="h86-1-58" class="i">+                                        references: None,
</a><a href="#h86-1-59" id="h86-1-59" class="i">+                                        index: false,
</a><a href="#h86-1-60" id="h86-1-60" class="i">+                                    },
</a><a href="#h86-1-61" id="h86-1-61" class="i">+                                    Column {
</a><a href="#h86-1-62" id="h86-1-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h86-1-63" id="h86-1-63" class="i">+                                        datatype: Float,
</a><a href="#h86-1-64" id="h86-1-64" class="i">+                                        primary_key: false,
</a><a href="#h86-1-65" id="h86-1-65" class="i">+                                        nullable: true,
</a><a href="#h86-1-66" id="h86-1-66" class="i">+                                        default: Some(
</a><a href="#h86-1-67" id="h86-1-67" class="i">+                                            Null,
</a><a href="#h86-1-68" id="h86-1-68" class="i">+                                        ),
</a><a href="#h86-1-69" id="h86-1-69" class="i">+                                        unique: false,
</a><a href="#h86-1-70" id="h86-1-70" class="i">+                                        references: None,
</a><a href="#h86-1-71" id="h86-1-71" class="i">+                                        index: false,
</a><a href="#h86-1-72" id="h86-1-72" class="i">+                                    },
</a><a href="#h86-1-73" id="h86-1-73" class="i">+                                    Column {
</a><a href="#h86-1-74" id="h86-1-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h86-1-75" id="h86-1-75" class="i">+                                        datatype: Boolean,
</a><a href="#h86-1-76" id="h86-1-76" class="i">+                                        primary_key: false,
</a><a href="#h86-1-77" id="h86-1-77" class="i">+                                        nullable: true,
</a><a href="#h86-1-78" id="h86-1-78" class="i">+                                        default: Some(
</a><a href="#h86-1-79" id="h86-1-79" class="i">+                                            Null,
</a><a href="#h86-1-80" id="h86-1-80" class="i">+                                        ),
</a><a href="#h86-1-81" id="h86-1-81" class="i">+                                        unique: false,
</a><a href="#h86-1-82" id="h86-1-82" class="i">+                                        references: None,
</a><a href="#h86-1-83" id="h86-1-83" class="i">+                                        index: false,
</a><a href="#h86-1-84" id="h86-1-84" class="i">+                                    },
</a><a href="#h86-1-85" id="h86-1-85" class="i">+                                ],
</a><a href="#h86-1-86" id="h86-1-86" class="i">+                            },
</a>                             alias: None,
                             filter: None,
                         },
<b>diff --git a/<a id="h87" href="../file/tests/sql/query/order_asc.html">tests/sql/query/order_asc</a> b/<a href="../file/tests/sql/query/order_asc.html">tests/sql/query/order_asc</a></b>
<a href="#h87-0" id="h87-0" class="h">@@ -43,7 +43,89 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h87-0-3" id="h87-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h87-0-4" id="h87-0-4" class="i">+            table: Table {
</a><a href="#h87-0-5" id="h87-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h87-0-6" id="h87-0-6" class="i">+                columns: [
</a><a href="#h87-0-7" id="h87-0-7" class="i">+                    Column {
</a><a href="#h87-0-8" id="h87-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h87-0-9" id="h87-0-9" class="i">+                        datatype: Integer,
</a><a href="#h87-0-10" id="h87-0-10" class="i">+                        primary_key: true,
</a><a href="#h87-0-11" id="h87-0-11" class="i">+                        nullable: false,
</a><a href="#h87-0-12" id="h87-0-12" class="i">+                        default: None,
</a><a href="#h87-0-13" id="h87-0-13" class="i">+                        unique: true,
</a><a href="#h87-0-14" id="h87-0-14" class="i">+                        references: None,
</a><a href="#h87-0-15" id="h87-0-15" class="i">+                        index: false,
</a><a href="#h87-0-16" id="h87-0-16" class="i">+                    },
</a><a href="#h87-0-17" id="h87-0-17" class="i">+                    Column {
</a><a href="#h87-0-18" id="h87-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h87-0-19" id="h87-0-19" class="i">+                        datatype: String,
</a><a href="#h87-0-20" id="h87-0-20" class="i">+                        primary_key: false,
</a><a href="#h87-0-21" id="h87-0-21" class="i">+                        nullable: false,
</a><a href="#h87-0-22" id="h87-0-22" class="i">+                        default: None,
</a><a href="#h87-0-23" id="h87-0-23" class="i">+                        unique: false,
</a><a href="#h87-0-24" id="h87-0-24" class="i">+                        references: None,
</a><a href="#h87-0-25" id="h87-0-25" class="i">+                        index: false,
</a><a href="#h87-0-26" id="h87-0-26" class="i">+                    },
</a><a href="#h87-0-27" id="h87-0-27" class="i">+                    Column {
</a><a href="#h87-0-28" id="h87-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h87-0-29" id="h87-0-29" class="i">+                        datatype: Integer,
</a><a href="#h87-0-30" id="h87-0-30" class="i">+                        primary_key: false,
</a><a href="#h87-0-31" id="h87-0-31" class="i">+                        nullable: false,
</a><a href="#h87-0-32" id="h87-0-32" class="i">+                        default: None,
</a><a href="#h87-0-33" id="h87-0-33" class="i">+                        unique: false,
</a><a href="#h87-0-34" id="h87-0-34" class="i">+                        references: Some(
</a><a href="#h87-0-35" id="h87-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h87-0-36" id="h87-0-36" class="i">+                        ),
</a><a href="#h87-0-37" id="h87-0-37" class="i">+                        index: true,
</a><a href="#h87-0-38" id="h87-0-38" class="i">+                    },
</a><a href="#h87-0-39" id="h87-0-39" class="i">+                    Column {
</a><a href="#h87-0-40" id="h87-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h87-0-41" id="h87-0-41" class="i">+                        datatype: Integer,
</a><a href="#h87-0-42" id="h87-0-42" class="i">+                        primary_key: false,
</a><a href="#h87-0-43" id="h87-0-43" class="i">+                        nullable: false,
</a><a href="#h87-0-44" id="h87-0-44" class="i">+                        default: None,
</a><a href="#h87-0-45" id="h87-0-45" class="i">+                        unique: false,
</a><a href="#h87-0-46" id="h87-0-46" class="i">+                        references: Some(
</a><a href="#h87-0-47" id="h87-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h87-0-48" id="h87-0-48" class="i">+                        ),
</a><a href="#h87-0-49" id="h87-0-49" class="i">+                        index: true,
</a><a href="#h87-0-50" id="h87-0-50" class="i">+                    },
</a><a href="#h87-0-51" id="h87-0-51" class="i">+                    Column {
</a><a href="#h87-0-52" id="h87-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h87-0-53" id="h87-0-53" class="i">+                        datatype: Integer,
</a><a href="#h87-0-54" id="h87-0-54" class="i">+                        primary_key: false,
</a><a href="#h87-0-55" id="h87-0-55" class="i">+                        nullable: false,
</a><a href="#h87-0-56" id="h87-0-56" class="i">+                        default: None,
</a><a href="#h87-0-57" id="h87-0-57" class="i">+                        unique: false,
</a><a href="#h87-0-58" id="h87-0-58" class="i">+                        references: None,
</a><a href="#h87-0-59" id="h87-0-59" class="i">+                        index: false,
</a><a href="#h87-0-60" id="h87-0-60" class="i">+                    },
</a><a href="#h87-0-61" id="h87-0-61" class="i">+                    Column {
</a><a href="#h87-0-62" id="h87-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h87-0-63" id="h87-0-63" class="i">+                        datatype: Float,
</a><a href="#h87-0-64" id="h87-0-64" class="i">+                        primary_key: false,
</a><a href="#h87-0-65" id="h87-0-65" class="i">+                        nullable: true,
</a><a href="#h87-0-66" id="h87-0-66" class="i">+                        default: Some(
</a><a href="#h87-0-67" id="h87-0-67" class="i">+                            Null,
</a><a href="#h87-0-68" id="h87-0-68" class="i">+                        ),
</a><a href="#h87-0-69" id="h87-0-69" class="i">+                        unique: false,
</a><a href="#h87-0-70" id="h87-0-70" class="i">+                        references: None,
</a><a href="#h87-0-71" id="h87-0-71" class="i">+                        index: false,
</a><a href="#h87-0-72" id="h87-0-72" class="i">+                    },
</a><a href="#h87-0-73" id="h87-0-73" class="i">+                    Column {
</a><a href="#h87-0-74" id="h87-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h87-0-75" id="h87-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h87-0-76" id="h87-0-76" class="i">+                        primary_key: false,
</a><a href="#h87-0-77" id="h87-0-77" class="i">+                        nullable: true,
</a><a href="#h87-0-78" id="h87-0-78" class="i">+                        default: Some(
</a><a href="#h87-0-79" id="h87-0-79" class="i">+                            Null,
</a><a href="#h87-0-80" id="h87-0-80" class="i">+                        ),
</a><a href="#h87-0-81" id="h87-0-81" class="i">+                        unique: false,
</a><a href="#h87-0-82" id="h87-0-82" class="i">+                        references: None,
</a><a href="#h87-0-83" id="h87-0-83" class="i">+                        index: false,
</a><a href="#h87-0-84" id="h87-0-84" class="i">+                    },
</a><a href="#h87-0-85" id="h87-0-85" class="i">+                ],
</a><a href="#h87-0-86" id="h87-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h87-1" id="h87-1" class="h">@@ -67,7 +149,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h87-1-3" id="h87-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h87-1-4" id="h87-1-4" class="i">+            table: Table {
</a><a href="#h87-1-5" id="h87-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h87-1-6" id="h87-1-6" class="i">+                columns: [
</a><a href="#h87-1-7" id="h87-1-7" class="i">+                    Column {
</a><a href="#h87-1-8" id="h87-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h87-1-9" id="h87-1-9" class="i">+                        datatype: Integer,
</a><a href="#h87-1-10" id="h87-1-10" class="i">+                        primary_key: true,
</a><a href="#h87-1-11" id="h87-1-11" class="i">+                        nullable: false,
</a><a href="#h87-1-12" id="h87-1-12" class="i">+                        default: None,
</a><a href="#h87-1-13" id="h87-1-13" class="i">+                        unique: true,
</a><a href="#h87-1-14" id="h87-1-14" class="i">+                        references: None,
</a><a href="#h87-1-15" id="h87-1-15" class="i">+                        index: false,
</a><a href="#h87-1-16" id="h87-1-16" class="i">+                    },
</a><a href="#h87-1-17" id="h87-1-17" class="i">+                    Column {
</a><a href="#h87-1-18" id="h87-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h87-1-19" id="h87-1-19" class="i">+                        datatype: String,
</a><a href="#h87-1-20" id="h87-1-20" class="i">+                        primary_key: false,
</a><a href="#h87-1-21" id="h87-1-21" class="i">+                        nullable: false,
</a><a href="#h87-1-22" id="h87-1-22" class="i">+                        default: None,
</a><a href="#h87-1-23" id="h87-1-23" class="i">+                        unique: false,
</a><a href="#h87-1-24" id="h87-1-24" class="i">+                        references: None,
</a><a href="#h87-1-25" id="h87-1-25" class="i">+                        index: false,
</a><a href="#h87-1-26" id="h87-1-26" class="i">+                    },
</a><a href="#h87-1-27" id="h87-1-27" class="i">+                    Column {
</a><a href="#h87-1-28" id="h87-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h87-1-29" id="h87-1-29" class="i">+                        datatype: Integer,
</a><a href="#h87-1-30" id="h87-1-30" class="i">+                        primary_key: false,
</a><a href="#h87-1-31" id="h87-1-31" class="i">+                        nullable: false,
</a><a href="#h87-1-32" id="h87-1-32" class="i">+                        default: None,
</a><a href="#h87-1-33" id="h87-1-33" class="i">+                        unique: false,
</a><a href="#h87-1-34" id="h87-1-34" class="i">+                        references: Some(
</a><a href="#h87-1-35" id="h87-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h87-1-36" id="h87-1-36" class="i">+                        ),
</a><a href="#h87-1-37" id="h87-1-37" class="i">+                        index: true,
</a><a href="#h87-1-38" id="h87-1-38" class="i">+                    },
</a><a href="#h87-1-39" id="h87-1-39" class="i">+                    Column {
</a><a href="#h87-1-40" id="h87-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h87-1-41" id="h87-1-41" class="i">+                        datatype: Integer,
</a><a href="#h87-1-42" id="h87-1-42" class="i">+                        primary_key: false,
</a><a href="#h87-1-43" id="h87-1-43" class="i">+                        nullable: false,
</a><a href="#h87-1-44" id="h87-1-44" class="i">+                        default: None,
</a><a href="#h87-1-45" id="h87-1-45" class="i">+                        unique: false,
</a><a href="#h87-1-46" id="h87-1-46" class="i">+                        references: Some(
</a><a href="#h87-1-47" id="h87-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h87-1-48" id="h87-1-48" class="i">+                        ),
</a><a href="#h87-1-49" id="h87-1-49" class="i">+                        index: true,
</a><a href="#h87-1-50" id="h87-1-50" class="i">+                    },
</a><a href="#h87-1-51" id="h87-1-51" class="i">+                    Column {
</a><a href="#h87-1-52" id="h87-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h87-1-53" id="h87-1-53" class="i">+                        datatype: Integer,
</a><a href="#h87-1-54" id="h87-1-54" class="i">+                        primary_key: false,
</a><a href="#h87-1-55" id="h87-1-55" class="i">+                        nullable: false,
</a><a href="#h87-1-56" id="h87-1-56" class="i">+                        default: None,
</a><a href="#h87-1-57" id="h87-1-57" class="i">+                        unique: false,
</a><a href="#h87-1-58" id="h87-1-58" class="i">+                        references: None,
</a><a href="#h87-1-59" id="h87-1-59" class="i">+                        index: false,
</a><a href="#h87-1-60" id="h87-1-60" class="i">+                    },
</a><a href="#h87-1-61" id="h87-1-61" class="i">+                    Column {
</a><a href="#h87-1-62" id="h87-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h87-1-63" id="h87-1-63" class="i">+                        datatype: Float,
</a><a href="#h87-1-64" id="h87-1-64" class="i">+                        primary_key: false,
</a><a href="#h87-1-65" id="h87-1-65" class="i">+                        nullable: true,
</a><a href="#h87-1-66" id="h87-1-66" class="i">+                        default: Some(
</a><a href="#h87-1-67" id="h87-1-67" class="i">+                            Null,
</a><a href="#h87-1-68" id="h87-1-68" class="i">+                        ),
</a><a href="#h87-1-69" id="h87-1-69" class="i">+                        unique: false,
</a><a href="#h87-1-70" id="h87-1-70" class="i">+                        references: None,
</a><a href="#h87-1-71" id="h87-1-71" class="i">+                        index: false,
</a><a href="#h87-1-72" id="h87-1-72" class="i">+                    },
</a><a href="#h87-1-73" id="h87-1-73" class="i">+                    Column {
</a><a href="#h87-1-74" id="h87-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h87-1-75" id="h87-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h87-1-76" id="h87-1-76" class="i">+                        primary_key: false,
</a><a href="#h87-1-77" id="h87-1-77" class="i">+                        nullable: true,
</a><a href="#h87-1-78" id="h87-1-78" class="i">+                        default: Some(
</a><a href="#h87-1-79" id="h87-1-79" class="i">+                            Null,
</a><a href="#h87-1-80" id="h87-1-80" class="i">+                        ),
</a><a href="#h87-1-81" id="h87-1-81" class="i">+                        unique: false,
</a><a href="#h87-1-82" id="h87-1-82" class="i">+                        references: None,
</a><a href="#h87-1-83" id="h87-1-83" class="i">+                        index: false,
</a><a href="#h87-1-84" id="h87-1-84" class="i">+                    },
</a><a href="#h87-1-85" id="h87-1-85" class="i">+                ],
</a><a href="#h87-1-86" id="h87-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h88" href="../file/tests/sql/query/order_asc_lowercase.html">tests/sql/query/order_asc_lowercase</a> b/<a href="../file/tests/sql/query/order_asc_lowercase.html">tests/sql/query/order_asc_lowercase</a></b>
<a href="#h88-0" id="h88-0" class="h">@@ -43,7 +43,89 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h88-0-3" id="h88-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h88-0-4" id="h88-0-4" class="i">+            table: Table {
</a><a href="#h88-0-5" id="h88-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h88-0-6" id="h88-0-6" class="i">+                columns: [
</a><a href="#h88-0-7" id="h88-0-7" class="i">+                    Column {
</a><a href="#h88-0-8" id="h88-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h88-0-9" id="h88-0-9" class="i">+                        datatype: Integer,
</a><a href="#h88-0-10" id="h88-0-10" class="i">+                        primary_key: true,
</a><a href="#h88-0-11" id="h88-0-11" class="i">+                        nullable: false,
</a><a href="#h88-0-12" id="h88-0-12" class="i">+                        default: None,
</a><a href="#h88-0-13" id="h88-0-13" class="i">+                        unique: true,
</a><a href="#h88-0-14" id="h88-0-14" class="i">+                        references: None,
</a><a href="#h88-0-15" id="h88-0-15" class="i">+                        index: false,
</a><a href="#h88-0-16" id="h88-0-16" class="i">+                    },
</a><a href="#h88-0-17" id="h88-0-17" class="i">+                    Column {
</a><a href="#h88-0-18" id="h88-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h88-0-19" id="h88-0-19" class="i">+                        datatype: String,
</a><a href="#h88-0-20" id="h88-0-20" class="i">+                        primary_key: false,
</a><a href="#h88-0-21" id="h88-0-21" class="i">+                        nullable: false,
</a><a href="#h88-0-22" id="h88-0-22" class="i">+                        default: None,
</a><a href="#h88-0-23" id="h88-0-23" class="i">+                        unique: false,
</a><a href="#h88-0-24" id="h88-0-24" class="i">+                        references: None,
</a><a href="#h88-0-25" id="h88-0-25" class="i">+                        index: false,
</a><a href="#h88-0-26" id="h88-0-26" class="i">+                    },
</a><a href="#h88-0-27" id="h88-0-27" class="i">+                    Column {
</a><a href="#h88-0-28" id="h88-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h88-0-29" id="h88-0-29" class="i">+                        datatype: Integer,
</a><a href="#h88-0-30" id="h88-0-30" class="i">+                        primary_key: false,
</a><a href="#h88-0-31" id="h88-0-31" class="i">+                        nullable: false,
</a><a href="#h88-0-32" id="h88-0-32" class="i">+                        default: None,
</a><a href="#h88-0-33" id="h88-0-33" class="i">+                        unique: false,
</a><a href="#h88-0-34" id="h88-0-34" class="i">+                        references: Some(
</a><a href="#h88-0-35" id="h88-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h88-0-36" id="h88-0-36" class="i">+                        ),
</a><a href="#h88-0-37" id="h88-0-37" class="i">+                        index: true,
</a><a href="#h88-0-38" id="h88-0-38" class="i">+                    },
</a><a href="#h88-0-39" id="h88-0-39" class="i">+                    Column {
</a><a href="#h88-0-40" id="h88-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h88-0-41" id="h88-0-41" class="i">+                        datatype: Integer,
</a><a href="#h88-0-42" id="h88-0-42" class="i">+                        primary_key: false,
</a><a href="#h88-0-43" id="h88-0-43" class="i">+                        nullable: false,
</a><a href="#h88-0-44" id="h88-0-44" class="i">+                        default: None,
</a><a href="#h88-0-45" id="h88-0-45" class="i">+                        unique: false,
</a><a href="#h88-0-46" id="h88-0-46" class="i">+                        references: Some(
</a><a href="#h88-0-47" id="h88-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h88-0-48" id="h88-0-48" class="i">+                        ),
</a><a href="#h88-0-49" id="h88-0-49" class="i">+                        index: true,
</a><a href="#h88-0-50" id="h88-0-50" class="i">+                    },
</a><a href="#h88-0-51" id="h88-0-51" class="i">+                    Column {
</a><a href="#h88-0-52" id="h88-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h88-0-53" id="h88-0-53" class="i">+                        datatype: Integer,
</a><a href="#h88-0-54" id="h88-0-54" class="i">+                        primary_key: false,
</a><a href="#h88-0-55" id="h88-0-55" class="i">+                        nullable: false,
</a><a href="#h88-0-56" id="h88-0-56" class="i">+                        default: None,
</a><a href="#h88-0-57" id="h88-0-57" class="i">+                        unique: false,
</a><a href="#h88-0-58" id="h88-0-58" class="i">+                        references: None,
</a><a href="#h88-0-59" id="h88-0-59" class="i">+                        index: false,
</a><a href="#h88-0-60" id="h88-0-60" class="i">+                    },
</a><a href="#h88-0-61" id="h88-0-61" class="i">+                    Column {
</a><a href="#h88-0-62" id="h88-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h88-0-63" id="h88-0-63" class="i">+                        datatype: Float,
</a><a href="#h88-0-64" id="h88-0-64" class="i">+                        primary_key: false,
</a><a href="#h88-0-65" id="h88-0-65" class="i">+                        nullable: true,
</a><a href="#h88-0-66" id="h88-0-66" class="i">+                        default: Some(
</a><a href="#h88-0-67" id="h88-0-67" class="i">+                            Null,
</a><a href="#h88-0-68" id="h88-0-68" class="i">+                        ),
</a><a href="#h88-0-69" id="h88-0-69" class="i">+                        unique: false,
</a><a href="#h88-0-70" id="h88-0-70" class="i">+                        references: None,
</a><a href="#h88-0-71" id="h88-0-71" class="i">+                        index: false,
</a><a href="#h88-0-72" id="h88-0-72" class="i">+                    },
</a><a href="#h88-0-73" id="h88-0-73" class="i">+                    Column {
</a><a href="#h88-0-74" id="h88-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h88-0-75" id="h88-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h88-0-76" id="h88-0-76" class="i">+                        primary_key: false,
</a><a href="#h88-0-77" id="h88-0-77" class="i">+                        nullable: true,
</a><a href="#h88-0-78" id="h88-0-78" class="i">+                        default: Some(
</a><a href="#h88-0-79" id="h88-0-79" class="i">+                            Null,
</a><a href="#h88-0-80" id="h88-0-80" class="i">+                        ),
</a><a href="#h88-0-81" id="h88-0-81" class="i">+                        unique: false,
</a><a href="#h88-0-82" id="h88-0-82" class="i">+                        references: None,
</a><a href="#h88-0-83" id="h88-0-83" class="i">+                        index: false,
</a><a href="#h88-0-84" id="h88-0-84" class="i">+                    },
</a><a href="#h88-0-85" id="h88-0-85" class="i">+                ],
</a><a href="#h88-0-86" id="h88-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h88-1" id="h88-1" class="h">@@ -67,7 +149,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h88-1-3" id="h88-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h88-1-4" id="h88-1-4" class="i">+            table: Table {
</a><a href="#h88-1-5" id="h88-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h88-1-6" id="h88-1-6" class="i">+                columns: [
</a><a href="#h88-1-7" id="h88-1-7" class="i">+                    Column {
</a><a href="#h88-1-8" id="h88-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h88-1-9" id="h88-1-9" class="i">+                        datatype: Integer,
</a><a href="#h88-1-10" id="h88-1-10" class="i">+                        primary_key: true,
</a><a href="#h88-1-11" id="h88-1-11" class="i">+                        nullable: false,
</a><a href="#h88-1-12" id="h88-1-12" class="i">+                        default: None,
</a><a href="#h88-1-13" id="h88-1-13" class="i">+                        unique: true,
</a><a href="#h88-1-14" id="h88-1-14" class="i">+                        references: None,
</a><a href="#h88-1-15" id="h88-1-15" class="i">+                        index: false,
</a><a href="#h88-1-16" id="h88-1-16" class="i">+                    },
</a><a href="#h88-1-17" id="h88-1-17" class="i">+                    Column {
</a><a href="#h88-1-18" id="h88-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h88-1-19" id="h88-1-19" class="i">+                        datatype: String,
</a><a href="#h88-1-20" id="h88-1-20" class="i">+                        primary_key: false,
</a><a href="#h88-1-21" id="h88-1-21" class="i">+                        nullable: false,
</a><a href="#h88-1-22" id="h88-1-22" class="i">+                        default: None,
</a><a href="#h88-1-23" id="h88-1-23" class="i">+                        unique: false,
</a><a href="#h88-1-24" id="h88-1-24" class="i">+                        references: None,
</a><a href="#h88-1-25" id="h88-1-25" class="i">+                        index: false,
</a><a href="#h88-1-26" id="h88-1-26" class="i">+                    },
</a><a href="#h88-1-27" id="h88-1-27" class="i">+                    Column {
</a><a href="#h88-1-28" id="h88-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h88-1-29" id="h88-1-29" class="i">+                        datatype: Integer,
</a><a href="#h88-1-30" id="h88-1-30" class="i">+                        primary_key: false,
</a><a href="#h88-1-31" id="h88-1-31" class="i">+                        nullable: false,
</a><a href="#h88-1-32" id="h88-1-32" class="i">+                        default: None,
</a><a href="#h88-1-33" id="h88-1-33" class="i">+                        unique: false,
</a><a href="#h88-1-34" id="h88-1-34" class="i">+                        references: Some(
</a><a href="#h88-1-35" id="h88-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h88-1-36" id="h88-1-36" class="i">+                        ),
</a><a href="#h88-1-37" id="h88-1-37" class="i">+                        index: true,
</a><a href="#h88-1-38" id="h88-1-38" class="i">+                    },
</a><a href="#h88-1-39" id="h88-1-39" class="i">+                    Column {
</a><a href="#h88-1-40" id="h88-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h88-1-41" id="h88-1-41" class="i">+                        datatype: Integer,
</a><a href="#h88-1-42" id="h88-1-42" class="i">+                        primary_key: false,
</a><a href="#h88-1-43" id="h88-1-43" class="i">+                        nullable: false,
</a><a href="#h88-1-44" id="h88-1-44" class="i">+                        default: None,
</a><a href="#h88-1-45" id="h88-1-45" class="i">+                        unique: false,
</a><a href="#h88-1-46" id="h88-1-46" class="i">+                        references: Some(
</a><a href="#h88-1-47" id="h88-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h88-1-48" id="h88-1-48" class="i">+                        ),
</a><a href="#h88-1-49" id="h88-1-49" class="i">+                        index: true,
</a><a href="#h88-1-50" id="h88-1-50" class="i">+                    },
</a><a href="#h88-1-51" id="h88-1-51" class="i">+                    Column {
</a><a href="#h88-1-52" id="h88-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h88-1-53" id="h88-1-53" class="i">+                        datatype: Integer,
</a><a href="#h88-1-54" id="h88-1-54" class="i">+                        primary_key: false,
</a><a href="#h88-1-55" id="h88-1-55" class="i">+                        nullable: false,
</a><a href="#h88-1-56" id="h88-1-56" class="i">+                        default: None,
</a><a href="#h88-1-57" id="h88-1-57" class="i">+                        unique: false,
</a><a href="#h88-1-58" id="h88-1-58" class="i">+                        references: None,
</a><a href="#h88-1-59" id="h88-1-59" class="i">+                        index: false,
</a><a href="#h88-1-60" id="h88-1-60" class="i">+                    },
</a><a href="#h88-1-61" id="h88-1-61" class="i">+                    Column {
</a><a href="#h88-1-62" id="h88-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h88-1-63" id="h88-1-63" class="i">+                        datatype: Float,
</a><a href="#h88-1-64" id="h88-1-64" class="i">+                        primary_key: false,
</a><a href="#h88-1-65" id="h88-1-65" class="i">+                        nullable: true,
</a><a href="#h88-1-66" id="h88-1-66" class="i">+                        default: Some(
</a><a href="#h88-1-67" id="h88-1-67" class="i">+                            Null,
</a><a href="#h88-1-68" id="h88-1-68" class="i">+                        ),
</a><a href="#h88-1-69" id="h88-1-69" class="i">+                        unique: false,
</a><a href="#h88-1-70" id="h88-1-70" class="i">+                        references: None,
</a><a href="#h88-1-71" id="h88-1-71" class="i">+                        index: false,
</a><a href="#h88-1-72" id="h88-1-72" class="i">+                    },
</a><a href="#h88-1-73" id="h88-1-73" class="i">+                    Column {
</a><a href="#h88-1-74" id="h88-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h88-1-75" id="h88-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h88-1-76" id="h88-1-76" class="i">+                        primary_key: false,
</a><a href="#h88-1-77" id="h88-1-77" class="i">+                        nullable: true,
</a><a href="#h88-1-78" id="h88-1-78" class="i">+                        default: Some(
</a><a href="#h88-1-79" id="h88-1-79" class="i">+                            Null,
</a><a href="#h88-1-80" id="h88-1-80" class="i">+                        ),
</a><a href="#h88-1-81" id="h88-1-81" class="i">+                        unique: false,
</a><a href="#h88-1-82" id="h88-1-82" class="i">+                        references: None,
</a><a href="#h88-1-83" id="h88-1-83" class="i">+                        index: false,
</a><a href="#h88-1-84" id="h88-1-84" class="i">+                    },
</a><a href="#h88-1-85" id="h88-1-85" class="i">+                ],
</a><a href="#h88-1-86" id="h88-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h89" href="../file/tests/sql/query/order_boolean_asc.html">tests/sql/query/order_boolean_asc</a> b/<a href="../file/tests/sql/query/order_boolean_asc.html">tests/sql/query/order_boolean_asc</a></b>
<a href="#h89-0" id="h89-0" class="h">@@ -36,7 +36,33 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h89-0-3" id="h89-0-3" class="d">-            table: &quot;booleans&quot;,
</a><a href="#h89-0-4" id="h89-0-4" class="i">+            table: Table {
</a><a href="#h89-0-5" id="h89-0-5" class="i">+                name: &quot;booleans&quot;,
</a><a href="#h89-0-6" id="h89-0-6" class="i">+                columns: [
</a><a href="#h89-0-7" id="h89-0-7" class="i">+                    Column {
</a><a href="#h89-0-8" id="h89-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h89-0-9" id="h89-0-9" class="i">+                        datatype: Integer,
</a><a href="#h89-0-10" id="h89-0-10" class="i">+                        primary_key: true,
</a><a href="#h89-0-11" id="h89-0-11" class="i">+                        nullable: false,
</a><a href="#h89-0-12" id="h89-0-12" class="i">+                        default: None,
</a><a href="#h89-0-13" id="h89-0-13" class="i">+                        unique: true,
</a><a href="#h89-0-14" id="h89-0-14" class="i">+                        references: None,
</a><a href="#h89-0-15" id="h89-0-15" class="i">+                        index: false,
</a><a href="#h89-0-16" id="h89-0-16" class="i">+                    },
</a><a href="#h89-0-17" id="h89-0-17" class="i">+                    Column {
</a><a href="#h89-0-18" id="h89-0-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h89-0-19" id="h89-0-19" class="i">+                        datatype: Boolean,
</a><a href="#h89-0-20" id="h89-0-20" class="i">+                        primary_key: false,
</a><a href="#h89-0-21" id="h89-0-21" class="i">+                        nullable: true,
</a><a href="#h89-0-22" id="h89-0-22" class="i">+                        default: Some(
</a><a href="#h89-0-23" id="h89-0-23" class="i">+                            Null,
</a><a href="#h89-0-24" id="h89-0-24" class="i">+                        ),
</a><a href="#h89-0-25" id="h89-0-25" class="i">+                        unique: false,
</a><a href="#h89-0-26" id="h89-0-26" class="i">+                        references: None,
</a><a href="#h89-0-27" id="h89-0-27" class="i">+                        index: false,
</a><a href="#h89-0-28" id="h89-0-28" class="i">+                    },
</a><a href="#h89-0-29" id="h89-0-29" class="i">+                ],
</a><a href="#h89-0-30" id="h89-0-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h89-1" id="h89-1" class="h">@@ -60,7 +86,33 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h89-1-3" id="h89-1-3" class="d">-            table: &quot;booleans&quot;,
</a><a href="#h89-1-4" id="h89-1-4" class="i">+            table: Table {
</a><a href="#h89-1-5" id="h89-1-5" class="i">+                name: &quot;booleans&quot;,
</a><a href="#h89-1-6" id="h89-1-6" class="i">+                columns: [
</a><a href="#h89-1-7" id="h89-1-7" class="i">+                    Column {
</a><a href="#h89-1-8" id="h89-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h89-1-9" id="h89-1-9" class="i">+                        datatype: Integer,
</a><a href="#h89-1-10" id="h89-1-10" class="i">+                        primary_key: true,
</a><a href="#h89-1-11" id="h89-1-11" class="i">+                        nullable: false,
</a><a href="#h89-1-12" id="h89-1-12" class="i">+                        default: None,
</a><a href="#h89-1-13" id="h89-1-13" class="i">+                        unique: true,
</a><a href="#h89-1-14" id="h89-1-14" class="i">+                        references: None,
</a><a href="#h89-1-15" id="h89-1-15" class="i">+                        index: false,
</a><a href="#h89-1-16" id="h89-1-16" class="i">+                    },
</a><a href="#h89-1-17" id="h89-1-17" class="i">+                    Column {
</a><a href="#h89-1-18" id="h89-1-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h89-1-19" id="h89-1-19" class="i">+                        datatype: Boolean,
</a><a href="#h89-1-20" id="h89-1-20" class="i">+                        primary_key: false,
</a><a href="#h89-1-21" id="h89-1-21" class="i">+                        nullable: true,
</a><a href="#h89-1-22" id="h89-1-22" class="i">+                        default: Some(
</a><a href="#h89-1-23" id="h89-1-23" class="i">+                            Null,
</a><a href="#h89-1-24" id="h89-1-24" class="i">+                        ),
</a><a href="#h89-1-25" id="h89-1-25" class="i">+                        unique: false,
</a><a href="#h89-1-26" id="h89-1-26" class="i">+                        references: None,
</a><a href="#h89-1-27" id="h89-1-27" class="i">+                        index: false,
</a><a href="#h89-1-28" id="h89-1-28" class="i">+                    },
</a><a href="#h89-1-29" id="h89-1-29" class="i">+                ],
</a><a href="#h89-1-30" id="h89-1-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h90" href="../file/tests/sql/query/order_boolean_desc.html">tests/sql/query/order_boolean_desc</a> b/<a href="../file/tests/sql/query/order_boolean_desc.html">tests/sql/query/order_boolean_desc</a></b>
<a href="#h90-0" id="h90-0" class="h">@@ -36,7 +36,33 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h90-0-3" id="h90-0-3" class="d">-            table: &quot;booleans&quot;,
</a><a href="#h90-0-4" id="h90-0-4" class="i">+            table: Table {
</a><a href="#h90-0-5" id="h90-0-5" class="i">+                name: &quot;booleans&quot;,
</a><a href="#h90-0-6" id="h90-0-6" class="i">+                columns: [
</a><a href="#h90-0-7" id="h90-0-7" class="i">+                    Column {
</a><a href="#h90-0-8" id="h90-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h90-0-9" id="h90-0-9" class="i">+                        datatype: Integer,
</a><a href="#h90-0-10" id="h90-0-10" class="i">+                        primary_key: true,
</a><a href="#h90-0-11" id="h90-0-11" class="i">+                        nullable: false,
</a><a href="#h90-0-12" id="h90-0-12" class="i">+                        default: None,
</a><a href="#h90-0-13" id="h90-0-13" class="i">+                        unique: true,
</a><a href="#h90-0-14" id="h90-0-14" class="i">+                        references: None,
</a><a href="#h90-0-15" id="h90-0-15" class="i">+                        index: false,
</a><a href="#h90-0-16" id="h90-0-16" class="i">+                    },
</a><a href="#h90-0-17" id="h90-0-17" class="i">+                    Column {
</a><a href="#h90-0-18" id="h90-0-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h90-0-19" id="h90-0-19" class="i">+                        datatype: Boolean,
</a><a href="#h90-0-20" id="h90-0-20" class="i">+                        primary_key: false,
</a><a href="#h90-0-21" id="h90-0-21" class="i">+                        nullable: true,
</a><a href="#h90-0-22" id="h90-0-22" class="i">+                        default: Some(
</a><a href="#h90-0-23" id="h90-0-23" class="i">+                            Null,
</a><a href="#h90-0-24" id="h90-0-24" class="i">+                        ),
</a><a href="#h90-0-25" id="h90-0-25" class="i">+                        unique: false,
</a><a href="#h90-0-26" id="h90-0-26" class="i">+                        references: None,
</a><a href="#h90-0-27" id="h90-0-27" class="i">+                        index: false,
</a><a href="#h90-0-28" id="h90-0-28" class="i">+                    },
</a><a href="#h90-0-29" id="h90-0-29" class="i">+                ],
</a><a href="#h90-0-30" id="h90-0-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h90-1" id="h90-1" class="h">@@ -60,7 +86,33 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h90-1-3" id="h90-1-3" class="d">-            table: &quot;booleans&quot;,
</a><a href="#h90-1-4" id="h90-1-4" class="i">+            table: Table {
</a><a href="#h90-1-5" id="h90-1-5" class="i">+                name: &quot;booleans&quot;,
</a><a href="#h90-1-6" id="h90-1-6" class="i">+                columns: [
</a><a href="#h90-1-7" id="h90-1-7" class="i">+                    Column {
</a><a href="#h90-1-8" id="h90-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h90-1-9" id="h90-1-9" class="i">+                        datatype: Integer,
</a><a href="#h90-1-10" id="h90-1-10" class="i">+                        primary_key: true,
</a><a href="#h90-1-11" id="h90-1-11" class="i">+                        nullable: false,
</a><a href="#h90-1-12" id="h90-1-12" class="i">+                        default: None,
</a><a href="#h90-1-13" id="h90-1-13" class="i">+                        unique: true,
</a><a href="#h90-1-14" id="h90-1-14" class="i">+                        references: None,
</a><a href="#h90-1-15" id="h90-1-15" class="i">+                        index: false,
</a><a href="#h90-1-16" id="h90-1-16" class="i">+                    },
</a><a href="#h90-1-17" id="h90-1-17" class="i">+                    Column {
</a><a href="#h90-1-18" id="h90-1-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h90-1-19" id="h90-1-19" class="i">+                        datatype: Boolean,
</a><a href="#h90-1-20" id="h90-1-20" class="i">+                        primary_key: false,
</a><a href="#h90-1-21" id="h90-1-21" class="i">+                        nullable: true,
</a><a href="#h90-1-22" id="h90-1-22" class="i">+                        default: Some(
</a><a href="#h90-1-23" id="h90-1-23" class="i">+                            Null,
</a><a href="#h90-1-24" id="h90-1-24" class="i">+                        ),
</a><a href="#h90-1-25" id="h90-1-25" class="i">+                        unique: false,
</a><a href="#h90-1-26" id="h90-1-26" class="i">+                        references: None,
</a><a href="#h90-1-27" id="h90-1-27" class="i">+                        index: false,
</a><a href="#h90-1-28" id="h90-1-28" class="i">+                    },
</a><a href="#h90-1-29" id="h90-1-29" class="i">+                ],
</a><a href="#h90-1-30" id="h90-1-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h91" href="../file/tests/sql/query/order_desc.html">tests/sql/query/order_desc</a> b/<a href="../file/tests/sql/query/order_desc.html">tests/sql/query/order_desc</a></b>
<a href="#h91-0" id="h91-0" class="h">@@ -43,7 +43,89 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h91-0-3" id="h91-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h91-0-4" id="h91-0-4" class="i">+            table: Table {
</a><a href="#h91-0-5" id="h91-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h91-0-6" id="h91-0-6" class="i">+                columns: [
</a><a href="#h91-0-7" id="h91-0-7" class="i">+                    Column {
</a><a href="#h91-0-8" id="h91-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h91-0-9" id="h91-0-9" class="i">+                        datatype: Integer,
</a><a href="#h91-0-10" id="h91-0-10" class="i">+                        primary_key: true,
</a><a href="#h91-0-11" id="h91-0-11" class="i">+                        nullable: false,
</a><a href="#h91-0-12" id="h91-0-12" class="i">+                        default: None,
</a><a href="#h91-0-13" id="h91-0-13" class="i">+                        unique: true,
</a><a href="#h91-0-14" id="h91-0-14" class="i">+                        references: None,
</a><a href="#h91-0-15" id="h91-0-15" class="i">+                        index: false,
</a><a href="#h91-0-16" id="h91-0-16" class="i">+                    },
</a><a href="#h91-0-17" id="h91-0-17" class="i">+                    Column {
</a><a href="#h91-0-18" id="h91-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h91-0-19" id="h91-0-19" class="i">+                        datatype: String,
</a><a href="#h91-0-20" id="h91-0-20" class="i">+                        primary_key: false,
</a><a href="#h91-0-21" id="h91-0-21" class="i">+                        nullable: false,
</a><a href="#h91-0-22" id="h91-0-22" class="i">+                        default: None,
</a><a href="#h91-0-23" id="h91-0-23" class="i">+                        unique: false,
</a><a href="#h91-0-24" id="h91-0-24" class="i">+                        references: None,
</a><a href="#h91-0-25" id="h91-0-25" class="i">+                        index: false,
</a><a href="#h91-0-26" id="h91-0-26" class="i">+                    },
</a><a href="#h91-0-27" id="h91-0-27" class="i">+                    Column {
</a><a href="#h91-0-28" id="h91-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h91-0-29" id="h91-0-29" class="i">+                        datatype: Integer,
</a><a href="#h91-0-30" id="h91-0-30" class="i">+                        primary_key: false,
</a><a href="#h91-0-31" id="h91-0-31" class="i">+                        nullable: false,
</a><a href="#h91-0-32" id="h91-0-32" class="i">+                        default: None,
</a><a href="#h91-0-33" id="h91-0-33" class="i">+                        unique: false,
</a><a href="#h91-0-34" id="h91-0-34" class="i">+                        references: Some(
</a><a href="#h91-0-35" id="h91-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h91-0-36" id="h91-0-36" class="i">+                        ),
</a><a href="#h91-0-37" id="h91-0-37" class="i">+                        index: true,
</a><a href="#h91-0-38" id="h91-0-38" class="i">+                    },
</a><a href="#h91-0-39" id="h91-0-39" class="i">+                    Column {
</a><a href="#h91-0-40" id="h91-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h91-0-41" id="h91-0-41" class="i">+                        datatype: Integer,
</a><a href="#h91-0-42" id="h91-0-42" class="i">+                        primary_key: false,
</a><a href="#h91-0-43" id="h91-0-43" class="i">+                        nullable: false,
</a><a href="#h91-0-44" id="h91-0-44" class="i">+                        default: None,
</a><a href="#h91-0-45" id="h91-0-45" class="i">+                        unique: false,
</a><a href="#h91-0-46" id="h91-0-46" class="i">+                        references: Some(
</a><a href="#h91-0-47" id="h91-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h91-0-48" id="h91-0-48" class="i">+                        ),
</a><a href="#h91-0-49" id="h91-0-49" class="i">+                        index: true,
</a><a href="#h91-0-50" id="h91-0-50" class="i">+                    },
</a><a href="#h91-0-51" id="h91-0-51" class="i">+                    Column {
</a><a href="#h91-0-52" id="h91-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h91-0-53" id="h91-0-53" class="i">+                        datatype: Integer,
</a><a href="#h91-0-54" id="h91-0-54" class="i">+                        primary_key: false,
</a><a href="#h91-0-55" id="h91-0-55" class="i">+                        nullable: false,
</a><a href="#h91-0-56" id="h91-0-56" class="i">+                        default: None,
</a><a href="#h91-0-57" id="h91-0-57" class="i">+                        unique: false,
</a><a href="#h91-0-58" id="h91-0-58" class="i">+                        references: None,
</a><a href="#h91-0-59" id="h91-0-59" class="i">+                        index: false,
</a><a href="#h91-0-60" id="h91-0-60" class="i">+                    },
</a><a href="#h91-0-61" id="h91-0-61" class="i">+                    Column {
</a><a href="#h91-0-62" id="h91-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h91-0-63" id="h91-0-63" class="i">+                        datatype: Float,
</a><a href="#h91-0-64" id="h91-0-64" class="i">+                        primary_key: false,
</a><a href="#h91-0-65" id="h91-0-65" class="i">+                        nullable: true,
</a><a href="#h91-0-66" id="h91-0-66" class="i">+                        default: Some(
</a><a href="#h91-0-67" id="h91-0-67" class="i">+                            Null,
</a><a href="#h91-0-68" id="h91-0-68" class="i">+                        ),
</a><a href="#h91-0-69" id="h91-0-69" class="i">+                        unique: false,
</a><a href="#h91-0-70" id="h91-0-70" class="i">+                        references: None,
</a><a href="#h91-0-71" id="h91-0-71" class="i">+                        index: false,
</a><a href="#h91-0-72" id="h91-0-72" class="i">+                    },
</a><a href="#h91-0-73" id="h91-0-73" class="i">+                    Column {
</a><a href="#h91-0-74" id="h91-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h91-0-75" id="h91-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h91-0-76" id="h91-0-76" class="i">+                        primary_key: false,
</a><a href="#h91-0-77" id="h91-0-77" class="i">+                        nullable: true,
</a><a href="#h91-0-78" id="h91-0-78" class="i">+                        default: Some(
</a><a href="#h91-0-79" id="h91-0-79" class="i">+                            Null,
</a><a href="#h91-0-80" id="h91-0-80" class="i">+                        ),
</a><a href="#h91-0-81" id="h91-0-81" class="i">+                        unique: false,
</a><a href="#h91-0-82" id="h91-0-82" class="i">+                        references: None,
</a><a href="#h91-0-83" id="h91-0-83" class="i">+                        index: false,
</a><a href="#h91-0-84" id="h91-0-84" class="i">+                    },
</a><a href="#h91-0-85" id="h91-0-85" class="i">+                ],
</a><a href="#h91-0-86" id="h91-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h91-1" id="h91-1" class="h">@@ -67,7 +149,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h91-1-3" id="h91-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h91-1-4" id="h91-1-4" class="i">+            table: Table {
</a><a href="#h91-1-5" id="h91-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h91-1-6" id="h91-1-6" class="i">+                columns: [
</a><a href="#h91-1-7" id="h91-1-7" class="i">+                    Column {
</a><a href="#h91-1-8" id="h91-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h91-1-9" id="h91-1-9" class="i">+                        datatype: Integer,
</a><a href="#h91-1-10" id="h91-1-10" class="i">+                        primary_key: true,
</a><a href="#h91-1-11" id="h91-1-11" class="i">+                        nullable: false,
</a><a href="#h91-1-12" id="h91-1-12" class="i">+                        default: None,
</a><a href="#h91-1-13" id="h91-1-13" class="i">+                        unique: true,
</a><a href="#h91-1-14" id="h91-1-14" class="i">+                        references: None,
</a><a href="#h91-1-15" id="h91-1-15" class="i">+                        index: false,
</a><a href="#h91-1-16" id="h91-1-16" class="i">+                    },
</a><a href="#h91-1-17" id="h91-1-17" class="i">+                    Column {
</a><a href="#h91-1-18" id="h91-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h91-1-19" id="h91-1-19" class="i">+                        datatype: String,
</a><a href="#h91-1-20" id="h91-1-20" class="i">+                        primary_key: false,
</a><a href="#h91-1-21" id="h91-1-21" class="i">+                        nullable: false,
</a><a href="#h91-1-22" id="h91-1-22" class="i">+                        default: None,
</a><a href="#h91-1-23" id="h91-1-23" class="i">+                        unique: false,
</a><a href="#h91-1-24" id="h91-1-24" class="i">+                        references: None,
</a><a href="#h91-1-25" id="h91-1-25" class="i">+                        index: false,
</a><a href="#h91-1-26" id="h91-1-26" class="i">+                    },
</a><a href="#h91-1-27" id="h91-1-27" class="i">+                    Column {
</a><a href="#h91-1-28" id="h91-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h91-1-29" id="h91-1-29" class="i">+                        datatype: Integer,
</a><a href="#h91-1-30" id="h91-1-30" class="i">+                        primary_key: false,
</a><a href="#h91-1-31" id="h91-1-31" class="i">+                        nullable: false,
</a><a href="#h91-1-32" id="h91-1-32" class="i">+                        default: None,
</a><a href="#h91-1-33" id="h91-1-33" class="i">+                        unique: false,
</a><a href="#h91-1-34" id="h91-1-34" class="i">+                        references: Some(
</a><a href="#h91-1-35" id="h91-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h91-1-36" id="h91-1-36" class="i">+                        ),
</a><a href="#h91-1-37" id="h91-1-37" class="i">+                        index: true,
</a><a href="#h91-1-38" id="h91-1-38" class="i">+                    },
</a><a href="#h91-1-39" id="h91-1-39" class="i">+                    Column {
</a><a href="#h91-1-40" id="h91-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h91-1-41" id="h91-1-41" class="i">+                        datatype: Integer,
</a><a href="#h91-1-42" id="h91-1-42" class="i">+                        primary_key: false,
</a><a href="#h91-1-43" id="h91-1-43" class="i">+                        nullable: false,
</a><a href="#h91-1-44" id="h91-1-44" class="i">+                        default: None,
</a><a href="#h91-1-45" id="h91-1-45" class="i">+                        unique: false,
</a><a href="#h91-1-46" id="h91-1-46" class="i">+                        references: Some(
</a><a href="#h91-1-47" id="h91-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h91-1-48" id="h91-1-48" class="i">+                        ),
</a><a href="#h91-1-49" id="h91-1-49" class="i">+                        index: true,
</a><a href="#h91-1-50" id="h91-1-50" class="i">+                    },
</a><a href="#h91-1-51" id="h91-1-51" class="i">+                    Column {
</a><a href="#h91-1-52" id="h91-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h91-1-53" id="h91-1-53" class="i">+                        datatype: Integer,
</a><a href="#h91-1-54" id="h91-1-54" class="i">+                        primary_key: false,
</a><a href="#h91-1-55" id="h91-1-55" class="i">+                        nullable: false,
</a><a href="#h91-1-56" id="h91-1-56" class="i">+                        default: None,
</a><a href="#h91-1-57" id="h91-1-57" class="i">+                        unique: false,
</a><a href="#h91-1-58" id="h91-1-58" class="i">+                        references: None,
</a><a href="#h91-1-59" id="h91-1-59" class="i">+                        index: false,
</a><a href="#h91-1-60" id="h91-1-60" class="i">+                    },
</a><a href="#h91-1-61" id="h91-1-61" class="i">+                    Column {
</a><a href="#h91-1-62" id="h91-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h91-1-63" id="h91-1-63" class="i">+                        datatype: Float,
</a><a href="#h91-1-64" id="h91-1-64" class="i">+                        primary_key: false,
</a><a href="#h91-1-65" id="h91-1-65" class="i">+                        nullable: true,
</a><a href="#h91-1-66" id="h91-1-66" class="i">+                        default: Some(
</a><a href="#h91-1-67" id="h91-1-67" class="i">+                            Null,
</a><a href="#h91-1-68" id="h91-1-68" class="i">+                        ),
</a><a href="#h91-1-69" id="h91-1-69" class="i">+                        unique: false,
</a><a href="#h91-1-70" id="h91-1-70" class="i">+                        references: None,
</a><a href="#h91-1-71" id="h91-1-71" class="i">+                        index: false,
</a><a href="#h91-1-72" id="h91-1-72" class="i">+                    },
</a><a href="#h91-1-73" id="h91-1-73" class="i">+                    Column {
</a><a href="#h91-1-74" id="h91-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h91-1-75" id="h91-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h91-1-76" id="h91-1-76" class="i">+                        primary_key: false,
</a><a href="#h91-1-77" id="h91-1-77" class="i">+                        nullable: true,
</a><a href="#h91-1-78" id="h91-1-78" class="i">+                        default: Some(
</a><a href="#h91-1-79" id="h91-1-79" class="i">+                            Null,
</a><a href="#h91-1-80" id="h91-1-80" class="i">+                        ),
</a><a href="#h91-1-81" id="h91-1-81" class="i">+                        unique: false,
</a><a href="#h91-1-82" id="h91-1-82" class="i">+                        references: None,
</a><a href="#h91-1-83" id="h91-1-83" class="i">+                        index: false,
</a><a href="#h91-1-84" id="h91-1-84" class="i">+                    },
</a><a href="#h91-1-85" id="h91-1-85" class="i">+                ],
</a><a href="#h91-1-86" id="h91-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h92" href="../file/tests/sql/query/order_desc_lowercase.html">tests/sql/query/order_desc_lowercase</a> b/<a href="../file/tests/sql/query/order_desc_lowercase.html">tests/sql/query/order_desc_lowercase</a></b>
<a href="#h92-0" id="h92-0" class="h">@@ -43,7 +43,89 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h92-0-3" id="h92-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h92-0-4" id="h92-0-4" class="i">+            table: Table {
</a><a href="#h92-0-5" id="h92-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h92-0-6" id="h92-0-6" class="i">+                columns: [
</a><a href="#h92-0-7" id="h92-0-7" class="i">+                    Column {
</a><a href="#h92-0-8" id="h92-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h92-0-9" id="h92-0-9" class="i">+                        datatype: Integer,
</a><a href="#h92-0-10" id="h92-0-10" class="i">+                        primary_key: true,
</a><a href="#h92-0-11" id="h92-0-11" class="i">+                        nullable: false,
</a><a href="#h92-0-12" id="h92-0-12" class="i">+                        default: None,
</a><a href="#h92-0-13" id="h92-0-13" class="i">+                        unique: true,
</a><a href="#h92-0-14" id="h92-0-14" class="i">+                        references: None,
</a><a href="#h92-0-15" id="h92-0-15" class="i">+                        index: false,
</a><a href="#h92-0-16" id="h92-0-16" class="i">+                    },
</a><a href="#h92-0-17" id="h92-0-17" class="i">+                    Column {
</a><a href="#h92-0-18" id="h92-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h92-0-19" id="h92-0-19" class="i">+                        datatype: String,
</a><a href="#h92-0-20" id="h92-0-20" class="i">+                        primary_key: false,
</a><a href="#h92-0-21" id="h92-0-21" class="i">+                        nullable: false,
</a><a href="#h92-0-22" id="h92-0-22" class="i">+                        default: None,
</a><a href="#h92-0-23" id="h92-0-23" class="i">+                        unique: false,
</a><a href="#h92-0-24" id="h92-0-24" class="i">+                        references: None,
</a><a href="#h92-0-25" id="h92-0-25" class="i">+                        index: false,
</a><a href="#h92-0-26" id="h92-0-26" class="i">+                    },
</a><a href="#h92-0-27" id="h92-0-27" class="i">+                    Column {
</a><a href="#h92-0-28" id="h92-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h92-0-29" id="h92-0-29" class="i">+                        datatype: Integer,
</a><a href="#h92-0-30" id="h92-0-30" class="i">+                        primary_key: false,
</a><a href="#h92-0-31" id="h92-0-31" class="i">+                        nullable: false,
</a><a href="#h92-0-32" id="h92-0-32" class="i">+                        default: None,
</a><a href="#h92-0-33" id="h92-0-33" class="i">+                        unique: false,
</a><a href="#h92-0-34" id="h92-0-34" class="i">+                        references: Some(
</a><a href="#h92-0-35" id="h92-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h92-0-36" id="h92-0-36" class="i">+                        ),
</a><a href="#h92-0-37" id="h92-0-37" class="i">+                        index: true,
</a><a href="#h92-0-38" id="h92-0-38" class="i">+                    },
</a><a href="#h92-0-39" id="h92-0-39" class="i">+                    Column {
</a><a href="#h92-0-40" id="h92-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h92-0-41" id="h92-0-41" class="i">+                        datatype: Integer,
</a><a href="#h92-0-42" id="h92-0-42" class="i">+                        primary_key: false,
</a><a href="#h92-0-43" id="h92-0-43" class="i">+                        nullable: false,
</a><a href="#h92-0-44" id="h92-0-44" class="i">+                        default: None,
</a><a href="#h92-0-45" id="h92-0-45" class="i">+                        unique: false,
</a><a href="#h92-0-46" id="h92-0-46" class="i">+                        references: Some(
</a><a href="#h92-0-47" id="h92-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h92-0-48" id="h92-0-48" class="i">+                        ),
</a><a href="#h92-0-49" id="h92-0-49" class="i">+                        index: true,
</a><a href="#h92-0-50" id="h92-0-50" class="i">+                    },
</a><a href="#h92-0-51" id="h92-0-51" class="i">+                    Column {
</a><a href="#h92-0-52" id="h92-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h92-0-53" id="h92-0-53" class="i">+                        datatype: Integer,
</a><a href="#h92-0-54" id="h92-0-54" class="i">+                        primary_key: false,
</a><a href="#h92-0-55" id="h92-0-55" class="i">+                        nullable: false,
</a><a href="#h92-0-56" id="h92-0-56" class="i">+                        default: None,
</a><a href="#h92-0-57" id="h92-0-57" class="i">+                        unique: false,
</a><a href="#h92-0-58" id="h92-0-58" class="i">+                        references: None,
</a><a href="#h92-0-59" id="h92-0-59" class="i">+                        index: false,
</a><a href="#h92-0-60" id="h92-0-60" class="i">+                    },
</a><a href="#h92-0-61" id="h92-0-61" class="i">+                    Column {
</a><a href="#h92-0-62" id="h92-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h92-0-63" id="h92-0-63" class="i">+                        datatype: Float,
</a><a href="#h92-0-64" id="h92-0-64" class="i">+                        primary_key: false,
</a><a href="#h92-0-65" id="h92-0-65" class="i">+                        nullable: true,
</a><a href="#h92-0-66" id="h92-0-66" class="i">+                        default: Some(
</a><a href="#h92-0-67" id="h92-0-67" class="i">+                            Null,
</a><a href="#h92-0-68" id="h92-0-68" class="i">+                        ),
</a><a href="#h92-0-69" id="h92-0-69" class="i">+                        unique: false,
</a><a href="#h92-0-70" id="h92-0-70" class="i">+                        references: None,
</a><a href="#h92-0-71" id="h92-0-71" class="i">+                        index: false,
</a><a href="#h92-0-72" id="h92-0-72" class="i">+                    },
</a><a href="#h92-0-73" id="h92-0-73" class="i">+                    Column {
</a><a href="#h92-0-74" id="h92-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h92-0-75" id="h92-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h92-0-76" id="h92-0-76" class="i">+                        primary_key: false,
</a><a href="#h92-0-77" id="h92-0-77" class="i">+                        nullable: true,
</a><a href="#h92-0-78" id="h92-0-78" class="i">+                        default: Some(
</a><a href="#h92-0-79" id="h92-0-79" class="i">+                            Null,
</a><a href="#h92-0-80" id="h92-0-80" class="i">+                        ),
</a><a href="#h92-0-81" id="h92-0-81" class="i">+                        unique: false,
</a><a href="#h92-0-82" id="h92-0-82" class="i">+                        references: None,
</a><a href="#h92-0-83" id="h92-0-83" class="i">+                        index: false,
</a><a href="#h92-0-84" id="h92-0-84" class="i">+                    },
</a><a href="#h92-0-85" id="h92-0-85" class="i">+                ],
</a><a href="#h92-0-86" id="h92-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h92-1" id="h92-1" class="h">@@ -67,7 +149,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h92-1-3" id="h92-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h92-1-4" id="h92-1-4" class="i">+            table: Table {
</a><a href="#h92-1-5" id="h92-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h92-1-6" id="h92-1-6" class="i">+                columns: [
</a><a href="#h92-1-7" id="h92-1-7" class="i">+                    Column {
</a><a href="#h92-1-8" id="h92-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h92-1-9" id="h92-1-9" class="i">+                        datatype: Integer,
</a><a href="#h92-1-10" id="h92-1-10" class="i">+                        primary_key: true,
</a><a href="#h92-1-11" id="h92-1-11" class="i">+                        nullable: false,
</a><a href="#h92-1-12" id="h92-1-12" class="i">+                        default: None,
</a><a href="#h92-1-13" id="h92-1-13" class="i">+                        unique: true,
</a><a href="#h92-1-14" id="h92-1-14" class="i">+                        references: None,
</a><a href="#h92-1-15" id="h92-1-15" class="i">+                        index: false,
</a><a href="#h92-1-16" id="h92-1-16" class="i">+                    },
</a><a href="#h92-1-17" id="h92-1-17" class="i">+                    Column {
</a><a href="#h92-1-18" id="h92-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h92-1-19" id="h92-1-19" class="i">+                        datatype: String,
</a><a href="#h92-1-20" id="h92-1-20" class="i">+                        primary_key: false,
</a><a href="#h92-1-21" id="h92-1-21" class="i">+                        nullable: false,
</a><a href="#h92-1-22" id="h92-1-22" class="i">+                        default: None,
</a><a href="#h92-1-23" id="h92-1-23" class="i">+                        unique: false,
</a><a href="#h92-1-24" id="h92-1-24" class="i">+                        references: None,
</a><a href="#h92-1-25" id="h92-1-25" class="i">+                        index: false,
</a><a href="#h92-1-26" id="h92-1-26" class="i">+                    },
</a><a href="#h92-1-27" id="h92-1-27" class="i">+                    Column {
</a><a href="#h92-1-28" id="h92-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h92-1-29" id="h92-1-29" class="i">+                        datatype: Integer,
</a><a href="#h92-1-30" id="h92-1-30" class="i">+                        primary_key: false,
</a><a href="#h92-1-31" id="h92-1-31" class="i">+                        nullable: false,
</a><a href="#h92-1-32" id="h92-1-32" class="i">+                        default: None,
</a><a href="#h92-1-33" id="h92-1-33" class="i">+                        unique: false,
</a><a href="#h92-1-34" id="h92-1-34" class="i">+                        references: Some(
</a><a href="#h92-1-35" id="h92-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h92-1-36" id="h92-1-36" class="i">+                        ),
</a><a href="#h92-1-37" id="h92-1-37" class="i">+                        index: true,
</a><a href="#h92-1-38" id="h92-1-38" class="i">+                    },
</a><a href="#h92-1-39" id="h92-1-39" class="i">+                    Column {
</a><a href="#h92-1-40" id="h92-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h92-1-41" id="h92-1-41" class="i">+                        datatype: Integer,
</a><a href="#h92-1-42" id="h92-1-42" class="i">+                        primary_key: false,
</a><a href="#h92-1-43" id="h92-1-43" class="i">+                        nullable: false,
</a><a href="#h92-1-44" id="h92-1-44" class="i">+                        default: None,
</a><a href="#h92-1-45" id="h92-1-45" class="i">+                        unique: false,
</a><a href="#h92-1-46" id="h92-1-46" class="i">+                        references: Some(
</a><a href="#h92-1-47" id="h92-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h92-1-48" id="h92-1-48" class="i">+                        ),
</a><a href="#h92-1-49" id="h92-1-49" class="i">+                        index: true,
</a><a href="#h92-1-50" id="h92-1-50" class="i">+                    },
</a><a href="#h92-1-51" id="h92-1-51" class="i">+                    Column {
</a><a href="#h92-1-52" id="h92-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h92-1-53" id="h92-1-53" class="i">+                        datatype: Integer,
</a><a href="#h92-1-54" id="h92-1-54" class="i">+                        primary_key: false,
</a><a href="#h92-1-55" id="h92-1-55" class="i">+                        nullable: false,
</a><a href="#h92-1-56" id="h92-1-56" class="i">+                        default: None,
</a><a href="#h92-1-57" id="h92-1-57" class="i">+                        unique: false,
</a><a href="#h92-1-58" id="h92-1-58" class="i">+                        references: None,
</a><a href="#h92-1-59" id="h92-1-59" class="i">+                        index: false,
</a><a href="#h92-1-60" id="h92-1-60" class="i">+                    },
</a><a href="#h92-1-61" id="h92-1-61" class="i">+                    Column {
</a><a href="#h92-1-62" id="h92-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h92-1-63" id="h92-1-63" class="i">+                        datatype: Float,
</a><a href="#h92-1-64" id="h92-1-64" class="i">+                        primary_key: false,
</a><a href="#h92-1-65" id="h92-1-65" class="i">+                        nullable: true,
</a><a href="#h92-1-66" id="h92-1-66" class="i">+                        default: Some(
</a><a href="#h92-1-67" id="h92-1-67" class="i">+                            Null,
</a><a href="#h92-1-68" id="h92-1-68" class="i">+                        ),
</a><a href="#h92-1-69" id="h92-1-69" class="i">+                        unique: false,
</a><a href="#h92-1-70" id="h92-1-70" class="i">+                        references: None,
</a><a href="#h92-1-71" id="h92-1-71" class="i">+                        index: false,
</a><a href="#h92-1-72" id="h92-1-72" class="i">+                    },
</a><a href="#h92-1-73" id="h92-1-73" class="i">+                    Column {
</a><a href="#h92-1-74" id="h92-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h92-1-75" id="h92-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h92-1-76" id="h92-1-76" class="i">+                        primary_key: false,
</a><a href="#h92-1-77" id="h92-1-77" class="i">+                        nullable: true,
</a><a href="#h92-1-78" id="h92-1-78" class="i">+                        default: Some(
</a><a href="#h92-1-79" id="h92-1-79" class="i">+                            Null,
</a><a href="#h92-1-80" id="h92-1-80" class="i">+                        ),
</a><a href="#h92-1-81" id="h92-1-81" class="i">+                        unique: false,
</a><a href="#h92-1-82" id="h92-1-82" class="i">+                        references: None,
</a><a href="#h92-1-83" id="h92-1-83" class="i">+                        index: false,
</a><a href="#h92-1-84" id="h92-1-84" class="i">+                    },
</a><a href="#h92-1-85" id="h92-1-85" class="i">+                ],
</a><a href="#h92-1-86" id="h92-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h93" href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a> b/<a href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a></b>
<a href="#h93-0" id="h93-0" class="h">@@ -94,7 +94,89 @@ Plan: Select(
</a>     Order {
         source: Projection {
             source: Scan {
<a href="#h93-0-3" id="h93-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h93-0-4" id="h93-0-4" class="i">+                table: Table {
</a><a href="#h93-0-5" id="h93-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h93-0-6" id="h93-0-6" class="i">+                    columns: [
</a><a href="#h93-0-7" id="h93-0-7" class="i">+                        Column {
</a><a href="#h93-0-8" id="h93-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h93-0-9" id="h93-0-9" class="i">+                            datatype: Integer,
</a><a href="#h93-0-10" id="h93-0-10" class="i">+                            primary_key: true,
</a><a href="#h93-0-11" id="h93-0-11" class="i">+                            nullable: false,
</a><a href="#h93-0-12" id="h93-0-12" class="i">+                            default: None,
</a><a href="#h93-0-13" id="h93-0-13" class="i">+                            unique: true,
</a><a href="#h93-0-14" id="h93-0-14" class="i">+                            references: None,
</a><a href="#h93-0-15" id="h93-0-15" class="i">+                            index: false,
</a><a href="#h93-0-16" id="h93-0-16" class="i">+                        },
</a><a href="#h93-0-17" id="h93-0-17" class="i">+                        Column {
</a><a href="#h93-0-18" id="h93-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h93-0-19" id="h93-0-19" class="i">+                            datatype: String,
</a><a href="#h93-0-20" id="h93-0-20" class="i">+                            primary_key: false,
</a><a href="#h93-0-21" id="h93-0-21" class="i">+                            nullable: false,
</a><a href="#h93-0-22" id="h93-0-22" class="i">+                            default: None,
</a><a href="#h93-0-23" id="h93-0-23" class="i">+                            unique: false,
</a><a href="#h93-0-24" id="h93-0-24" class="i">+                            references: None,
</a><a href="#h93-0-25" id="h93-0-25" class="i">+                            index: false,
</a><a href="#h93-0-26" id="h93-0-26" class="i">+                        },
</a><a href="#h93-0-27" id="h93-0-27" class="i">+                        Column {
</a><a href="#h93-0-28" id="h93-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h93-0-29" id="h93-0-29" class="i">+                            datatype: Integer,
</a><a href="#h93-0-30" id="h93-0-30" class="i">+                            primary_key: false,
</a><a href="#h93-0-31" id="h93-0-31" class="i">+                            nullable: false,
</a><a href="#h93-0-32" id="h93-0-32" class="i">+                            default: None,
</a><a href="#h93-0-33" id="h93-0-33" class="i">+                            unique: false,
</a><a href="#h93-0-34" id="h93-0-34" class="i">+                            references: Some(
</a><a href="#h93-0-35" id="h93-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h93-0-36" id="h93-0-36" class="i">+                            ),
</a><a href="#h93-0-37" id="h93-0-37" class="i">+                            index: true,
</a><a href="#h93-0-38" id="h93-0-38" class="i">+                        },
</a><a href="#h93-0-39" id="h93-0-39" class="i">+                        Column {
</a><a href="#h93-0-40" id="h93-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h93-0-41" id="h93-0-41" class="i">+                            datatype: Integer,
</a><a href="#h93-0-42" id="h93-0-42" class="i">+                            primary_key: false,
</a><a href="#h93-0-43" id="h93-0-43" class="i">+                            nullable: false,
</a><a href="#h93-0-44" id="h93-0-44" class="i">+                            default: None,
</a><a href="#h93-0-45" id="h93-0-45" class="i">+                            unique: false,
</a><a href="#h93-0-46" id="h93-0-46" class="i">+                            references: Some(
</a><a href="#h93-0-47" id="h93-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h93-0-48" id="h93-0-48" class="i">+                            ),
</a><a href="#h93-0-49" id="h93-0-49" class="i">+                            index: true,
</a><a href="#h93-0-50" id="h93-0-50" class="i">+                        },
</a><a href="#h93-0-51" id="h93-0-51" class="i">+                        Column {
</a><a href="#h93-0-52" id="h93-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h93-0-53" id="h93-0-53" class="i">+                            datatype: Integer,
</a><a href="#h93-0-54" id="h93-0-54" class="i">+                            primary_key: false,
</a><a href="#h93-0-55" id="h93-0-55" class="i">+                            nullable: false,
</a><a href="#h93-0-56" id="h93-0-56" class="i">+                            default: None,
</a><a href="#h93-0-57" id="h93-0-57" class="i">+                            unique: false,
</a><a href="#h93-0-58" id="h93-0-58" class="i">+                            references: None,
</a><a href="#h93-0-59" id="h93-0-59" class="i">+                            index: false,
</a><a href="#h93-0-60" id="h93-0-60" class="i">+                        },
</a><a href="#h93-0-61" id="h93-0-61" class="i">+                        Column {
</a><a href="#h93-0-62" id="h93-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h93-0-63" id="h93-0-63" class="i">+                            datatype: Float,
</a><a href="#h93-0-64" id="h93-0-64" class="i">+                            primary_key: false,
</a><a href="#h93-0-65" id="h93-0-65" class="i">+                            nullable: true,
</a><a href="#h93-0-66" id="h93-0-66" class="i">+                            default: Some(
</a><a href="#h93-0-67" id="h93-0-67" class="i">+                                Null,
</a><a href="#h93-0-68" id="h93-0-68" class="i">+                            ),
</a><a href="#h93-0-69" id="h93-0-69" class="i">+                            unique: false,
</a><a href="#h93-0-70" id="h93-0-70" class="i">+                            references: None,
</a><a href="#h93-0-71" id="h93-0-71" class="i">+                            index: false,
</a><a href="#h93-0-72" id="h93-0-72" class="i">+                        },
</a><a href="#h93-0-73" id="h93-0-73" class="i">+                        Column {
</a><a href="#h93-0-74" id="h93-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h93-0-75" id="h93-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h93-0-76" id="h93-0-76" class="i">+                            primary_key: false,
</a><a href="#h93-0-77" id="h93-0-77" class="i">+                            nullable: true,
</a><a href="#h93-0-78" id="h93-0-78" class="i">+                            default: Some(
</a><a href="#h93-0-79" id="h93-0-79" class="i">+                                Null,
</a><a href="#h93-0-80" id="h93-0-80" class="i">+                            ),
</a><a href="#h93-0-81" id="h93-0-81" class="i">+                            unique: false,
</a><a href="#h93-0-82" id="h93-0-82" class="i">+                            references: None,
</a><a href="#h93-0-83" id="h93-0-83" class="i">+                            index: false,
</a><a href="#h93-0-84" id="h93-0-84" class="i">+                        },
</a><a href="#h93-0-85" id="h93-0-85" class="i">+                    ],
</a><a href="#h93-0-86" id="h93-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h93-1" id="h93-1" class="h">@@ -179,7 +261,89 @@ Optimized plan: Select(
</a>     Order {
         source: Projection {
             source: Scan {
<a href="#h93-1-3" id="h93-1-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h93-1-4" id="h93-1-4" class="i">+                table: Table {
</a><a href="#h93-1-5" id="h93-1-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h93-1-6" id="h93-1-6" class="i">+                    columns: [
</a><a href="#h93-1-7" id="h93-1-7" class="i">+                        Column {
</a><a href="#h93-1-8" id="h93-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h93-1-9" id="h93-1-9" class="i">+                            datatype: Integer,
</a><a href="#h93-1-10" id="h93-1-10" class="i">+                            primary_key: true,
</a><a href="#h93-1-11" id="h93-1-11" class="i">+                            nullable: false,
</a><a href="#h93-1-12" id="h93-1-12" class="i">+                            default: None,
</a><a href="#h93-1-13" id="h93-1-13" class="i">+                            unique: true,
</a><a href="#h93-1-14" id="h93-1-14" class="i">+                            references: None,
</a><a href="#h93-1-15" id="h93-1-15" class="i">+                            index: false,
</a><a href="#h93-1-16" id="h93-1-16" class="i">+                        },
</a><a href="#h93-1-17" id="h93-1-17" class="i">+                        Column {
</a><a href="#h93-1-18" id="h93-1-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h93-1-19" id="h93-1-19" class="i">+                            datatype: String,
</a><a href="#h93-1-20" id="h93-1-20" class="i">+                            primary_key: false,
</a><a href="#h93-1-21" id="h93-1-21" class="i">+                            nullable: false,
</a><a href="#h93-1-22" id="h93-1-22" class="i">+                            default: None,
</a><a href="#h93-1-23" id="h93-1-23" class="i">+                            unique: false,
</a><a href="#h93-1-24" id="h93-1-24" class="i">+                            references: None,
</a><a href="#h93-1-25" id="h93-1-25" class="i">+                            index: false,
</a><a href="#h93-1-26" id="h93-1-26" class="i">+                        },
</a><a href="#h93-1-27" id="h93-1-27" class="i">+                        Column {
</a><a href="#h93-1-28" id="h93-1-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h93-1-29" id="h93-1-29" class="i">+                            datatype: Integer,
</a><a href="#h93-1-30" id="h93-1-30" class="i">+                            primary_key: false,
</a><a href="#h93-1-31" id="h93-1-31" class="i">+                            nullable: false,
</a><a href="#h93-1-32" id="h93-1-32" class="i">+                            default: None,
</a><a href="#h93-1-33" id="h93-1-33" class="i">+                            unique: false,
</a><a href="#h93-1-34" id="h93-1-34" class="i">+                            references: Some(
</a><a href="#h93-1-35" id="h93-1-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h93-1-36" id="h93-1-36" class="i">+                            ),
</a><a href="#h93-1-37" id="h93-1-37" class="i">+                            index: true,
</a><a href="#h93-1-38" id="h93-1-38" class="i">+                        },
</a><a href="#h93-1-39" id="h93-1-39" class="i">+                        Column {
</a><a href="#h93-1-40" id="h93-1-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h93-1-41" id="h93-1-41" class="i">+                            datatype: Integer,
</a><a href="#h93-1-42" id="h93-1-42" class="i">+                            primary_key: false,
</a><a href="#h93-1-43" id="h93-1-43" class="i">+                            nullable: false,
</a><a href="#h93-1-44" id="h93-1-44" class="i">+                            default: None,
</a><a href="#h93-1-45" id="h93-1-45" class="i">+                            unique: false,
</a><a href="#h93-1-46" id="h93-1-46" class="i">+                            references: Some(
</a><a href="#h93-1-47" id="h93-1-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h93-1-48" id="h93-1-48" class="i">+                            ),
</a><a href="#h93-1-49" id="h93-1-49" class="i">+                            index: true,
</a><a href="#h93-1-50" id="h93-1-50" class="i">+                        },
</a><a href="#h93-1-51" id="h93-1-51" class="i">+                        Column {
</a><a href="#h93-1-52" id="h93-1-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h93-1-53" id="h93-1-53" class="i">+                            datatype: Integer,
</a><a href="#h93-1-54" id="h93-1-54" class="i">+                            primary_key: false,
</a><a href="#h93-1-55" id="h93-1-55" class="i">+                            nullable: false,
</a><a href="#h93-1-56" id="h93-1-56" class="i">+                            default: None,
</a><a href="#h93-1-57" id="h93-1-57" class="i">+                            unique: false,
</a><a href="#h93-1-58" id="h93-1-58" class="i">+                            references: None,
</a><a href="#h93-1-59" id="h93-1-59" class="i">+                            index: false,
</a><a href="#h93-1-60" id="h93-1-60" class="i">+                        },
</a><a href="#h93-1-61" id="h93-1-61" class="i">+                        Column {
</a><a href="#h93-1-62" id="h93-1-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h93-1-63" id="h93-1-63" class="i">+                            datatype: Float,
</a><a href="#h93-1-64" id="h93-1-64" class="i">+                            primary_key: false,
</a><a href="#h93-1-65" id="h93-1-65" class="i">+                            nullable: true,
</a><a href="#h93-1-66" id="h93-1-66" class="i">+                            default: Some(
</a><a href="#h93-1-67" id="h93-1-67" class="i">+                                Null,
</a><a href="#h93-1-68" id="h93-1-68" class="i">+                            ),
</a><a href="#h93-1-69" id="h93-1-69" class="i">+                            unique: false,
</a><a href="#h93-1-70" id="h93-1-70" class="i">+                            references: None,
</a><a href="#h93-1-71" id="h93-1-71" class="i">+                            index: false,
</a><a href="#h93-1-72" id="h93-1-72" class="i">+                        },
</a><a href="#h93-1-73" id="h93-1-73" class="i">+                        Column {
</a><a href="#h93-1-74" id="h93-1-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h93-1-75" id="h93-1-75" class="i">+                            datatype: Boolean,
</a><a href="#h93-1-76" id="h93-1-76" class="i">+                            primary_key: false,
</a><a href="#h93-1-77" id="h93-1-77" class="i">+                            nullable: true,
</a><a href="#h93-1-78" id="h93-1-78" class="i">+                            default: Some(
</a><a href="#h93-1-79" id="h93-1-79" class="i">+                                Null,
</a><a href="#h93-1-80" id="h93-1-80" class="i">+                            ),
</a><a href="#h93-1-81" id="h93-1-81" class="i">+                            unique: false,
</a><a href="#h93-1-82" id="h93-1-82" class="i">+                            references: None,
</a><a href="#h93-1-83" id="h93-1-83" class="i">+                            index: false,
</a><a href="#h93-1-84" id="h93-1-84" class="i">+                        },
</a><a href="#h93-1-85" id="h93-1-85" class="i">+                    ],
</a><a href="#h93-1-86" id="h93-1-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<b>diff --git a/<a id="h94" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h94-0" id="h94-0" class="h">@@ -105,13 +105,119 @@ Plan: Select(
</a>             source: Filter {
                 source: NestedLoopJoin {
                     left: Scan {
<a href="#h94-0-3" id="h94-0-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h94-0-4" id="h94-0-4" class="i">+                        table: Table {
</a><a href="#h94-0-5" id="h94-0-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h94-0-6" id="h94-0-6" class="i">+                            columns: [
</a><a href="#h94-0-7" id="h94-0-7" class="i">+                                Column {
</a><a href="#h94-0-8" id="h94-0-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h94-0-9" id="h94-0-9" class="i">+                                    datatype: Integer,
</a><a href="#h94-0-10" id="h94-0-10" class="i">+                                    primary_key: true,
</a><a href="#h94-0-11" id="h94-0-11" class="i">+                                    nullable: false,
</a><a href="#h94-0-12" id="h94-0-12" class="i">+                                    default: None,
</a><a href="#h94-0-13" id="h94-0-13" class="i">+                                    unique: true,
</a><a href="#h94-0-14" id="h94-0-14" class="i">+                                    references: None,
</a><a href="#h94-0-15" id="h94-0-15" class="i">+                                    index: false,
</a><a href="#h94-0-16" id="h94-0-16" class="i">+                                },
</a><a href="#h94-0-17" id="h94-0-17" class="i">+                                Column {
</a><a href="#h94-0-18" id="h94-0-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h94-0-19" id="h94-0-19" class="i">+                                    datatype: String,
</a><a href="#h94-0-20" id="h94-0-20" class="i">+                                    primary_key: false,
</a><a href="#h94-0-21" id="h94-0-21" class="i">+                                    nullable: false,
</a><a href="#h94-0-22" id="h94-0-22" class="i">+                                    default: None,
</a><a href="#h94-0-23" id="h94-0-23" class="i">+                                    unique: false,
</a><a href="#h94-0-24" id="h94-0-24" class="i">+                                    references: None,
</a><a href="#h94-0-25" id="h94-0-25" class="i">+                                    index: false,
</a><a href="#h94-0-26" id="h94-0-26" class="i">+                                },
</a><a href="#h94-0-27" id="h94-0-27" class="i">+                                Column {
</a><a href="#h94-0-28" id="h94-0-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h94-0-29" id="h94-0-29" class="i">+                                    datatype: Integer,
</a><a href="#h94-0-30" id="h94-0-30" class="i">+                                    primary_key: false,
</a><a href="#h94-0-31" id="h94-0-31" class="i">+                                    nullable: false,
</a><a href="#h94-0-32" id="h94-0-32" class="i">+                                    default: None,
</a><a href="#h94-0-33" id="h94-0-33" class="i">+                                    unique: false,
</a><a href="#h94-0-34" id="h94-0-34" class="i">+                                    references: Some(
</a><a href="#h94-0-35" id="h94-0-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h94-0-36" id="h94-0-36" class="i">+                                    ),
</a><a href="#h94-0-37" id="h94-0-37" class="i">+                                    index: true,
</a><a href="#h94-0-38" id="h94-0-38" class="i">+                                },
</a><a href="#h94-0-39" id="h94-0-39" class="i">+                                Column {
</a><a href="#h94-0-40" id="h94-0-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h94-0-41" id="h94-0-41" class="i">+                                    datatype: Integer,
</a><a href="#h94-0-42" id="h94-0-42" class="i">+                                    primary_key: false,
</a><a href="#h94-0-43" id="h94-0-43" class="i">+                                    nullable: false,
</a><a href="#h94-0-44" id="h94-0-44" class="i">+                                    default: None,
</a><a href="#h94-0-45" id="h94-0-45" class="i">+                                    unique: false,
</a><a href="#h94-0-46" id="h94-0-46" class="i">+                                    references: Some(
</a><a href="#h94-0-47" id="h94-0-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h94-0-48" id="h94-0-48" class="i">+                                    ),
</a><a href="#h94-0-49" id="h94-0-49" class="i">+                                    index: true,
</a><a href="#h94-0-50" id="h94-0-50" class="i">+                                },
</a><a href="#h94-0-51" id="h94-0-51" class="i">+                                Column {
</a><a href="#h94-0-52" id="h94-0-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h94-0-53" id="h94-0-53" class="i">+                                    datatype: Integer,
</a><a href="#h94-0-54" id="h94-0-54" class="i">+                                    primary_key: false,
</a><a href="#h94-0-55" id="h94-0-55" class="i">+                                    nullable: false,
</a><a href="#h94-0-56" id="h94-0-56" class="i">+                                    default: None,
</a><a href="#h94-0-57" id="h94-0-57" class="i">+                                    unique: false,
</a><a href="#h94-0-58" id="h94-0-58" class="i">+                                    references: None,
</a><a href="#h94-0-59" id="h94-0-59" class="i">+                                    index: false,
</a><a href="#h94-0-60" id="h94-0-60" class="i">+                                },
</a><a href="#h94-0-61" id="h94-0-61" class="i">+                                Column {
</a><a href="#h94-0-62" id="h94-0-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h94-0-63" id="h94-0-63" class="i">+                                    datatype: Float,
</a><a href="#h94-0-64" id="h94-0-64" class="i">+                                    primary_key: false,
</a><a href="#h94-0-65" id="h94-0-65" class="i">+                                    nullable: true,
</a><a href="#h94-0-66" id="h94-0-66" class="i">+                                    default: Some(
</a><a href="#h94-0-67" id="h94-0-67" class="i">+                                        Null,
</a><a href="#h94-0-68" id="h94-0-68" class="i">+                                    ),
</a><a href="#h94-0-69" id="h94-0-69" class="i">+                                    unique: false,
</a><a href="#h94-0-70" id="h94-0-70" class="i">+                                    references: None,
</a><a href="#h94-0-71" id="h94-0-71" class="i">+                                    index: false,
</a><a href="#h94-0-72" id="h94-0-72" class="i">+                                },
</a><a href="#h94-0-73" id="h94-0-73" class="i">+                                Column {
</a><a href="#h94-0-74" id="h94-0-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h94-0-75" id="h94-0-75" class="i">+                                    datatype: Boolean,
</a><a href="#h94-0-76" id="h94-0-76" class="i">+                                    primary_key: false,
</a><a href="#h94-0-77" id="h94-0-77" class="i">+                                    nullable: true,
</a><a href="#h94-0-78" id="h94-0-78" class="i">+                                    default: Some(
</a><a href="#h94-0-79" id="h94-0-79" class="i">+                                        Null,
</a><a href="#h94-0-80" id="h94-0-80" class="i">+                                    ),
</a><a href="#h94-0-81" id="h94-0-81" class="i">+                                    unique: false,
</a><a href="#h94-0-82" id="h94-0-82" class="i">+                                    references: None,
</a><a href="#h94-0-83" id="h94-0-83" class="i">+                                    index: false,
</a><a href="#h94-0-84" id="h94-0-84" class="i">+                                },
</a><a href="#h94-0-85" id="h94-0-85" class="i">+                            ],
</a><a href="#h94-0-86" id="h94-0-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
                     left_size: 7,
                     right: Scan {
<a href="#h94-0-92" id="h94-0-92" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h94-0-93" id="h94-0-93" class="i">+                        table: Table {
</a><a href="#h94-0-94" id="h94-0-94" class="i">+                            name: &quot;genres&quot;,
</a><a href="#h94-0-95" id="h94-0-95" class="i">+                            columns: [
</a><a href="#h94-0-96" id="h94-0-96" class="i">+                                Column {
</a><a href="#h94-0-97" id="h94-0-97" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h94-0-98" id="h94-0-98" class="i">+                                    datatype: Integer,
</a><a href="#h94-0-99" id="h94-0-99" class="i">+                                    primary_key: true,
</a><a href="#h94-0-100" id="h94-0-100" class="i">+                                    nullable: false,
</a><a href="#h94-0-101" id="h94-0-101" class="i">+                                    default: None,
</a><a href="#h94-0-102" id="h94-0-102" class="i">+                                    unique: true,
</a><a href="#h94-0-103" id="h94-0-103" class="i">+                                    references: None,
</a><a href="#h94-0-104" id="h94-0-104" class="i">+                                    index: false,
</a><a href="#h94-0-105" id="h94-0-105" class="i">+                                },
</a><a href="#h94-0-106" id="h94-0-106" class="i">+                                Column {
</a><a href="#h94-0-107" id="h94-0-107" class="i">+                                    name: &quot;name&quot;,
</a><a href="#h94-0-108" id="h94-0-108" class="i">+                                    datatype: String,
</a><a href="#h94-0-109" id="h94-0-109" class="i">+                                    primary_key: false,
</a><a href="#h94-0-110" id="h94-0-110" class="i">+                                    nullable: false,
</a><a href="#h94-0-111" id="h94-0-111" class="i">+                                    default: None,
</a><a href="#h94-0-112" id="h94-0-112" class="i">+                                    unique: false,
</a><a href="#h94-0-113" id="h94-0-113" class="i">+                                    references: None,
</a><a href="#h94-0-114" id="h94-0-114" class="i">+                                    index: false,
</a><a href="#h94-0-115" id="h94-0-115" class="i">+                                },
</a><a href="#h94-0-116" id="h94-0-116" class="i">+                            ],
</a><a href="#h94-0-117" id="h94-0-117" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h94-1" id="h94-1" class="h">@@ -224,7 +330,89 @@ Optimized plan: Select(
</a>         source: Projection {
             source: HashJoin {
                 left: Scan {
<a href="#h94-1-3" id="h94-1-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h94-1-4" id="h94-1-4" class="i">+                    table: Table {
</a><a href="#h94-1-5" id="h94-1-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h94-1-6" id="h94-1-6" class="i">+                        columns: [
</a><a href="#h94-1-7" id="h94-1-7" class="i">+                            Column {
</a><a href="#h94-1-8" id="h94-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h94-1-9" id="h94-1-9" class="i">+                                datatype: Integer,
</a><a href="#h94-1-10" id="h94-1-10" class="i">+                                primary_key: true,
</a><a href="#h94-1-11" id="h94-1-11" class="i">+                                nullable: false,
</a><a href="#h94-1-12" id="h94-1-12" class="i">+                                default: None,
</a><a href="#h94-1-13" id="h94-1-13" class="i">+                                unique: true,
</a><a href="#h94-1-14" id="h94-1-14" class="i">+                                references: None,
</a><a href="#h94-1-15" id="h94-1-15" class="i">+                                index: false,
</a><a href="#h94-1-16" id="h94-1-16" class="i">+                            },
</a><a href="#h94-1-17" id="h94-1-17" class="i">+                            Column {
</a><a href="#h94-1-18" id="h94-1-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h94-1-19" id="h94-1-19" class="i">+                                datatype: String,
</a><a href="#h94-1-20" id="h94-1-20" class="i">+                                primary_key: false,
</a><a href="#h94-1-21" id="h94-1-21" class="i">+                                nullable: false,
</a><a href="#h94-1-22" id="h94-1-22" class="i">+                                default: None,
</a><a href="#h94-1-23" id="h94-1-23" class="i">+                                unique: false,
</a><a href="#h94-1-24" id="h94-1-24" class="i">+                                references: None,
</a><a href="#h94-1-25" id="h94-1-25" class="i">+                                index: false,
</a><a href="#h94-1-26" id="h94-1-26" class="i">+                            },
</a><a href="#h94-1-27" id="h94-1-27" class="i">+                            Column {
</a><a href="#h94-1-28" id="h94-1-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h94-1-29" id="h94-1-29" class="i">+                                datatype: Integer,
</a><a href="#h94-1-30" id="h94-1-30" class="i">+                                primary_key: false,
</a><a href="#h94-1-31" id="h94-1-31" class="i">+                                nullable: false,
</a><a href="#h94-1-32" id="h94-1-32" class="i">+                                default: None,
</a><a href="#h94-1-33" id="h94-1-33" class="i">+                                unique: false,
</a><a href="#h94-1-34" id="h94-1-34" class="i">+                                references: Some(
</a><a href="#h94-1-35" id="h94-1-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h94-1-36" id="h94-1-36" class="i">+                                ),
</a><a href="#h94-1-37" id="h94-1-37" class="i">+                                index: true,
</a><a href="#h94-1-38" id="h94-1-38" class="i">+                            },
</a><a href="#h94-1-39" id="h94-1-39" class="i">+                            Column {
</a><a href="#h94-1-40" id="h94-1-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h94-1-41" id="h94-1-41" class="i">+                                datatype: Integer,
</a><a href="#h94-1-42" id="h94-1-42" class="i">+                                primary_key: false,
</a><a href="#h94-1-43" id="h94-1-43" class="i">+                                nullable: false,
</a><a href="#h94-1-44" id="h94-1-44" class="i">+                                default: None,
</a><a href="#h94-1-45" id="h94-1-45" class="i">+                                unique: false,
</a><a href="#h94-1-46" id="h94-1-46" class="i">+                                references: Some(
</a><a href="#h94-1-47" id="h94-1-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h94-1-48" id="h94-1-48" class="i">+                                ),
</a><a href="#h94-1-49" id="h94-1-49" class="i">+                                index: true,
</a><a href="#h94-1-50" id="h94-1-50" class="i">+                            },
</a><a href="#h94-1-51" id="h94-1-51" class="i">+                            Column {
</a><a href="#h94-1-52" id="h94-1-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h94-1-53" id="h94-1-53" class="i">+                                datatype: Integer,
</a><a href="#h94-1-54" id="h94-1-54" class="i">+                                primary_key: false,
</a><a href="#h94-1-55" id="h94-1-55" class="i">+                                nullable: false,
</a><a href="#h94-1-56" id="h94-1-56" class="i">+                                default: None,
</a><a href="#h94-1-57" id="h94-1-57" class="i">+                                unique: false,
</a><a href="#h94-1-58" id="h94-1-58" class="i">+                                references: None,
</a><a href="#h94-1-59" id="h94-1-59" class="i">+                                index: false,
</a><a href="#h94-1-60" id="h94-1-60" class="i">+                            },
</a><a href="#h94-1-61" id="h94-1-61" class="i">+                            Column {
</a><a href="#h94-1-62" id="h94-1-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h94-1-63" id="h94-1-63" class="i">+                                datatype: Float,
</a><a href="#h94-1-64" id="h94-1-64" class="i">+                                primary_key: false,
</a><a href="#h94-1-65" id="h94-1-65" class="i">+                                nullable: true,
</a><a href="#h94-1-66" id="h94-1-66" class="i">+                                default: Some(
</a><a href="#h94-1-67" id="h94-1-67" class="i">+                                    Null,
</a><a href="#h94-1-68" id="h94-1-68" class="i">+                                ),
</a><a href="#h94-1-69" id="h94-1-69" class="i">+                                unique: false,
</a><a href="#h94-1-70" id="h94-1-70" class="i">+                                references: None,
</a><a href="#h94-1-71" id="h94-1-71" class="i">+                                index: false,
</a><a href="#h94-1-72" id="h94-1-72" class="i">+                            },
</a><a href="#h94-1-73" id="h94-1-73" class="i">+                            Column {
</a><a href="#h94-1-74" id="h94-1-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h94-1-75" id="h94-1-75" class="i">+                                datatype: Boolean,
</a><a href="#h94-1-76" id="h94-1-76" class="i">+                                primary_key: false,
</a><a href="#h94-1-77" id="h94-1-77" class="i">+                                nullable: true,
</a><a href="#h94-1-78" id="h94-1-78" class="i">+                                default: Some(
</a><a href="#h94-1-79" id="h94-1-79" class="i">+                                    Null,
</a><a href="#h94-1-80" id="h94-1-80" class="i">+                                ),
</a><a href="#h94-1-81" id="h94-1-81" class="i">+                                unique: false,
</a><a href="#h94-1-82" id="h94-1-82" class="i">+                                references: None,
</a><a href="#h94-1-83" id="h94-1-83" class="i">+                                index: false,
</a><a href="#h94-1-84" id="h94-1-84" class="i">+                            },
</a><a href="#h94-1-85" id="h94-1-85" class="i">+                        ],
</a><a href="#h94-1-86" id="h94-1-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h94-2" id="h94-2" class="h">@@ -240,7 +428,31 @@ Optimized plan: Select(
</a>                     ),
                 ),
                 right: Scan {
<a href="#h94-2-3" id="h94-2-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h94-2-4" id="h94-2-4" class="i">+                    table: Table {
</a><a href="#h94-2-5" id="h94-2-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h94-2-6" id="h94-2-6" class="i">+                        columns: [
</a><a href="#h94-2-7" id="h94-2-7" class="i">+                            Column {
</a><a href="#h94-2-8" id="h94-2-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h94-2-9" id="h94-2-9" class="i">+                                datatype: Integer,
</a><a href="#h94-2-10" id="h94-2-10" class="i">+                                primary_key: true,
</a><a href="#h94-2-11" id="h94-2-11" class="i">+                                nullable: false,
</a><a href="#h94-2-12" id="h94-2-12" class="i">+                                default: None,
</a><a href="#h94-2-13" id="h94-2-13" class="i">+                                unique: true,
</a><a href="#h94-2-14" id="h94-2-14" class="i">+                                references: None,
</a><a href="#h94-2-15" id="h94-2-15" class="i">+                                index: false,
</a><a href="#h94-2-16" id="h94-2-16" class="i">+                            },
</a><a href="#h94-2-17" id="h94-2-17" class="i">+                            Column {
</a><a href="#h94-2-18" id="h94-2-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h94-2-19" id="h94-2-19" class="i">+                                datatype: String,
</a><a href="#h94-2-20" id="h94-2-20" class="i">+                                primary_key: false,
</a><a href="#h94-2-21" id="h94-2-21" class="i">+                                nullable: false,
</a><a href="#h94-2-22" id="h94-2-22" class="i">+                                default: None,
</a><a href="#h94-2-23" id="h94-2-23" class="i">+                                unique: false,
</a><a href="#h94-2-24" id="h94-2-24" class="i">+                                references: None,
</a><a href="#h94-2-25" id="h94-2-25" class="i">+                                index: false,
</a><a href="#h94-2-26" id="h94-2-26" class="i">+                            },
</a><a href="#h94-2-27" id="h94-2-27" class="i">+                        ],
</a><a href="#h94-2-28" id="h94-2-28" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h95" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h95-0" id="h95-0" class="h">@@ -107,13 +107,119 @@ Plan: Select(
</a>                 source: Filter {
                     source: NestedLoopJoin {
                         left: Scan {
<a href="#h95-0-3" id="h95-0-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h95-0-4" id="h95-0-4" class="i">+                            table: Table {
</a><a href="#h95-0-5" id="h95-0-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h95-0-6" id="h95-0-6" class="i">+                                columns: [
</a><a href="#h95-0-7" id="h95-0-7" class="i">+                                    Column {
</a><a href="#h95-0-8" id="h95-0-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h95-0-9" id="h95-0-9" class="i">+                                        datatype: Integer,
</a><a href="#h95-0-10" id="h95-0-10" class="i">+                                        primary_key: true,
</a><a href="#h95-0-11" id="h95-0-11" class="i">+                                        nullable: false,
</a><a href="#h95-0-12" id="h95-0-12" class="i">+                                        default: None,
</a><a href="#h95-0-13" id="h95-0-13" class="i">+                                        unique: true,
</a><a href="#h95-0-14" id="h95-0-14" class="i">+                                        references: None,
</a><a href="#h95-0-15" id="h95-0-15" class="i">+                                        index: false,
</a><a href="#h95-0-16" id="h95-0-16" class="i">+                                    },
</a><a href="#h95-0-17" id="h95-0-17" class="i">+                                    Column {
</a><a href="#h95-0-18" id="h95-0-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h95-0-19" id="h95-0-19" class="i">+                                        datatype: String,
</a><a href="#h95-0-20" id="h95-0-20" class="i">+                                        primary_key: false,
</a><a href="#h95-0-21" id="h95-0-21" class="i">+                                        nullable: false,
</a><a href="#h95-0-22" id="h95-0-22" class="i">+                                        default: None,
</a><a href="#h95-0-23" id="h95-0-23" class="i">+                                        unique: false,
</a><a href="#h95-0-24" id="h95-0-24" class="i">+                                        references: None,
</a><a href="#h95-0-25" id="h95-0-25" class="i">+                                        index: false,
</a><a href="#h95-0-26" id="h95-0-26" class="i">+                                    },
</a><a href="#h95-0-27" id="h95-0-27" class="i">+                                    Column {
</a><a href="#h95-0-28" id="h95-0-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h95-0-29" id="h95-0-29" class="i">+                                        datatype: Integer,
</a><a href="#h95-0-30" id="h95-0-30" class="i">+                                        primary_key: false,
</a><a href="#h95-0-31" id="h95-0-31" class="i">+                                        nullable: false,
</a><a href="#h95-0-32" id="h95-0-32" class="i">+                                        default: None,
</a><a href="#h95-0-33" id="h95-0-33" class="i">+                                        unique: false,
</a><a href="#h95-0-34" id="h95-0-34" class="i">+                                        references: Some(
</a><a href="#h95-0-35" id="h95-0-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h95-0-36" id="h95-0-36" class="i">+                                        ),
</a><a href="#h95-0-37" id="h95-0-37" class="i">+                                        index: true,
</a><a href="#h95-0-38" id="h95-0-38" class="i">+                                    },
</a><a href="#h95-0-39" id="h95-0-39" class="i">+                                    Column {
</a><a href="#h95-0-40" id="h95-0-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h95-0-41" id="h95-0-41" class="i">+                                        datatype: Integer,
</a><a href="#h95-0-42" id="h95-0-42" class="i">+                                        primary_key: false,
</a><a href="#h95-0-43" id="h95-0-43" class="i">+                                        nullable: false,
</a><a href="#h95-0-44" id="h95-0-44" class="i">+                                        default: None,
</a><a href="#h95-0-45" id="h95-0-45" class="i">+                                        unique: false,
</a><a href="#h95-0-46" id="h95-0-46" class="i">+                                        references: Some(
</a><a href="#h95-0-47" id="h95-0-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h95-0-48" id="h95-0-48" class="i">+                                        ),
</a><a href="#h95-0-49" id="h95-0-49" class="i">+                                        index: true,
</a><a href="#h95-0-50" id="h95-0-50" class="i">+                                    },
</a><a href="#h95-0-51" id="h95-0-51" class="i">+                                    Column {
</a><a href="#h95-0-52" id="h95-0-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h95-0-53" id="h95-0-53" class="i">+                                        datatype: Integer,
</a><a href="#h95-0-54" id="h95-0-54" class="i">+                                        primary_key: false,
</a><a href="#h95-0-55" id="h95-0-55" class="i">+                                        nullable: false,
</a><a href="#h95-0-56" id="h95-0-56" class="i">+                                        default: None,
</a><a href="#h95-0-57" id="h95-0-57" class="i">+                                        unique: false,
</a><a href="#h95-0-58" id="h95-0-58" class="i">+                                        references: None,
</a><a href="#h95-0-59" id="h95-0-59" class="i">+                                        index: false,
</a><a href="#h95-0-60" id="h95-0-60" class="i">+                                    },
</a><a href="#h95-0-61" id="h95-0-61" class="i">+                                    Column {
</a><a href="#h95-0-62" id="h95-0-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h95-0-63" id="h95-0-63" class="i">+                                        datatype: Float,
</a><a href="#h95-0-64" id="h95-0-64" class="i">+                                        primary_key: false,
</a><a href="#h95-0-65" id="h95-0-65" class="i">+                                        nullable: true,
</a><a href="#h95-0-66" id="h95-0-66" class="i">+                                        default: Some(
</a><a href="#h95-0-67" id="h95-0-67" class="i">+                                            Null,
</a><a href="#h95-0-68" id="h95-0-68" class="i">+                                        ),
</a><a href="#h95-0-69" id="h95-0-69" class="i">+                                        unique: false,
</a><a href="#h95-0-70" id="h95-0-70" class="i">+                                        references: None,
</a><a href="#h95-0-71" id="h95-0-71" class="i">+                                        index: false,
</a><a href="#h95-0-72" id="h95-0-72" class="i">+                                    },
</a><a href="#h95-0-73" id="h95-0-73" class="i">+                                    Column {
</a><a href="#h95-0-74" id="h95-0-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h95-0-75" id="h95-0-75" class="i">+                                        datatype: Boolean,
</a><a href="#h95-0-76" id="h95-0-76" class="i">+                                        primary_key: false,
</a><a href="#h95-0-77" id="h95-0-77" class="i">+                                        nullable: true,
</a><a href="#h95-0-78" id="h95-0-78" class="i">+                                        default: Some(
</a><a href="#h95-0-79" id="h95-0-79" class="i">+                                            Null,
</a><a href="#h95-0-80" id="h95-0-80" class="i">+                                        ),
</a><a href="#h95-0-81" id="h95-0-81" class="i">+                                        unique: false,
</a><a href="#h95-0-82" id="h95-0-82" class="i">+                                        references: None,
</a><a href="#h95-0-83" id="h95-0-83" class="i">+                                        index: false,
</a><a href="#h95-0-84" id="h95-0-84" class="i">+                                    },
</a><a href="#h95-0-85" id="h95-0-85" class="i">+                                ],
</a><a href="#h95-0-86" id="h95-0-86" class="i">+                            },
</a>                             alias: None,
                             filter: None,
                         },
                         left_size: 7,
                         right: Scan {
<a href="#h95-0-92" id="h95-0-92" class="d">-                            table: &quot;genres&quot;,
</a><a href="#h95-0-93" id="h95-0-93" class="i">+                            table: Table {
</a><a href="#h95-0-94" id="h95-0-94" class="i">+                                name: &quot;genres&quot;,
</a><a href="#h95-0-95" id="h95-0-95" class="i">+                                columns: [
</a><a href="#h95-0-96" id="h95-0-96" class="i">+                                    Column {
</a><a href="#h95-0-97" id="h95-0-97" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h95-0-98" id="h95-0-98" class="i">+                                        datatype: Integer,
</a><a href="#h95-0-99" id="h95-0-99" class="i">+                                        primary_key: true,
</a><a href="#h95-0-100" id="h95-0-100" class="i">+                                        nullable: false,
</a><a href="#h95-0-101" id="h95-0-101" class="i">+                                        default: None,
</a><a href="#h95-0-102" id="h95-0-102" class="i">+                                        unique: true,
</a><a href="#h95-0-103" id="h95-0-103" class="i">+                                        references: None,
</a><a href="#h95-0-104" id="h95-0-104" class="i">+                                        index: false,
</a><a href="#h95-0-105" id="h95-0-105" class="i">+                                    },
</a><a href="#h95-0-106" id="h95-0-106" class="i">+                                    Column {
</a><a href="#h95-0-107" id="h95-0-107" class="i">+                                        name: &quot;name&quot;,
</a><a href="#h95-0-108" id="h95-0-108" class="i">+                                        datatype: String,
</a><a href="#h95-0-109" id="h95-0-109" class="i">+                                        primary_key: false,
</a><a href="#h95-0-110" id="h95-0-110" class="i">+                                        nullable: false,
</a><a href="#h95-0-111" id="h95-0-111" class="i">+                                        default: None,
</a><a href="#h95-0-112" id="h95-0-112" class="i">+                                        unique: false,
</a><a href="#h95-0-113" id="h95-0-113" class="i">+                                        references: None,
</a><a href="#h95-0-114" id="h95-0-114" class="i">+                                        index: false,
</a><a href="#h95-0-115" id="h95-0-115" class="i">+                                    },
</a><a href="#h95-0-116" id="h95-0-116" class="i">+                                ],
</a><a href="#h95-0-117" id="h95-0-117" class="i">+                            },
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h95-1" id="h95-1" class="h">@@ -277,7 +383,89 @@ Optimized plan: Select(
</a>             source: Projection {
                 source: HashJoin {
                     left: Scan {
<a href="#h95-1-3" id="h95-1-3" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h95-1-4" id="h95-1-4" class="i">+                        table: Table {
</a><a href="#h95-1-5" id="h95-1-5" class="i">+                            name: &quot;movies&quot;,
</a><a href="#h95-1-6" id="h95-1-6" class="i">+                            columns: [
</a><a href="#h95-1-7" id="h95-1-7" class="i">+                                Column {
</a><a href="#h95-1-8" id="h95-1-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h95-1-9" id="h95-1-9" class="i">+                                    datatype: Integer,
</a><a href="#h95-1-10" id="h95-1-10" class="i">+                                    primary_key: true,
</a><a href="#h95-1-11" id="h95-1-11" class="i">+                                    nullable: false,
</a><a href="#h95-1-12" id="h95-1-12" class="i">+                                    default: None,
</a><a href="#h95-1-13" id="h95-1-13" class="i">+                                    unique: true,
</a><a href="#h95-1-14" id="h95-1-14" class="i">+                                    references: None,
</a><a href="#h95-1-15" id="h95-1-15" class="i">+                                    index: false,
</a><a href="#h95-1-16" id="h95-1-16" class="i">+                                },
</a><a href="#h95-1-17" id="h95-1-17" class="i">+                                Column {
</a><a href="#h95-1-18" id="h95-1-18" class="i">+                                    name: &quot;title&quot;,
</a><a href="#h95-1-19" id="h95-1-19" class="i">+                                    datatype: String,
</a><a href="#h95-1-20" id="h95-1-20" class="i">+                                    primary_key: false,
</a><a href="#h95-1-21" id="h95-1-21" class="i">+                                    nullable: false,
</a><a href="#h95-1-22" id="h95-1-22" class="i">+                                    default: None,
</a><a href="#h95-1-23" id="h95-1-23" class="i">+                                    unique: false,
</a><a href="#h95-1-24" id="h95-1-24" class="i">+                                    references: None,
</a><a href="#h95-1-25" id="h95-1-25" class="i">+                                    index: false,
</a><a href="#h95-1-26" id="h95-1-26" class="i">+                                },
</a><a href="#h95-1-27" id="h95-1-27" class="i">+                                Column {
</a><a href="#h95-1-28" id="h95-1-28" class="i">+                                    name: &quot;studio_id&quot;,
</a><a href="#h95-1-29" id="h95-1-29" class="i">+                                    datatype: Integer,
</a><a href="#h95-1-30" id="h95-1-30" class="i">+                                    primary_key: false,
</a><a href="#h95-1-31" id="h95-1-31" class="i">+                                    nullable: false,
</a><a href="#h95-1-32" id="h95-1-32" class="i">+                                    default: None,
</a><a href="#h95-1-33" id="h95-1-33" class="i">+                                    unique: false,
</a><a href="#h95-1-34" id="h95-1-34" class="i">+                                    references: Some(
</a><a href="#h95-1-35" id="h95-1-35" class="i">+                                        &quot;studios&quot;,
</a><a href="#h95-1-36" id="h95-1-36" class="i">+                                    ),
</a><a href="#h95-1-37" id="h95-1-37" class="i">+                                    index: true,
</a><a href="#h95-1-38" id="h95-1-38" class="i">+                                },
</a><a href="#h95-1-39" id="h95-1-39" class="i">+                                Column {
</a><a href="#h95-1-40" id="h95-1-40" class="i">+                                    name: &quot;genre_id&quot;,
</a><a href="#h95-1-41" id="h95-1-41" class="i">+                                    datatype: Integer,
</a><a href="#h95-1-42" id="h95-1-42" class="i">+                                    primary_key: false,
</a><a href="#h95-1-43" id="h95-1-43" class="i">+                                    nullable: false,
</a><a href="#h95-1-44" id="h95-1-44" class="i">+                                    default: None,
</a><a href="#h95-1-45" id="h95-1-45" class="i">+                                    unique: false,
</a><a href="#h95-1-46" id="h95-1-46" class="i">+                                    references: Some(
</a><a href="#h95-1-47" id="h95-1-47" class="i">+                                        &quot;genres&quot;,
</a><a href="#h95-1-48" id="h95-1-48" class="i">+                                    ),
</a><a href="#h95-1-49" id="h95-1-49" class="i">+                                    index: true,
</a><a href="#h95-1-50" id="h95-1-50" class="i">+                                },
</a><a href="#h95-1-51" id="h95-1-51" class="i">+                                Column {
</a><a href="#h95-1-52" id="h95-1-52" class="i">+                                    name: &quot;released&quot;,
</a><a href="#h95-1-53" id="h95-1-53" class="i">+                                    datatype: Integer,
</a><a href="#h95-1-54" id="h95-1-54" class="i">+                                    primary_key: false,
</a><a href="#h95-1-55" id="h95-1-55" class="i">+                                    nullable: false,
</a><a href="#h95-1-56" id="h95-1-56" class="i">+                                    default: None,
</a><a href="#h95-1-57" id="h95-1-57" class="i">+                                    unique: false,
</a><a href="#h95-1-58" id="h95-1-58" class="i">+                                    references: None,
</a><a href="#h95-1-59" id="h95-1-59" class="i">+                                    index: false,
</a><a href="#h95-1-60" id="h95-1-60" class="i">+                                },
</a><a href="#h95-1-61" id="h95-1-61" class="i">+                                Column {
</a><a href="#h95-1-62" id="h95-1-62" class="i">+                                    name: &quot;rating&quot;,
</a><a href="#h95-1-63" id="h95-1-63" class="i">+                                    datatype: Float,
</a><a href="#h95-1-64" id="h95-1-64" class="i">+                                    primary_key: false,
</a><a href="#h95-1-65" id="h95-1-65" class="i">+                                    nullable: true,
</a><a href="#h95-1-66" id="h95-1-66" class="i">+                                    default: Some(
</a><a href="#h95-1-67" id="h95-1-67" class="i">+                                        Null,
</a><a href="#h95-1-68" id="h95-1-68" class="i">+                                    ),
</a><a href="#h95-1-69" id="h95-1-69" class="i">+                                    unique: false,
</a><a href="#h95-1-70" id="h95-1-70" class="i">+                                    references: None,
</a><a href="#h95-1-71" id="h95-1-71" class="i">+                                    index: false,
</a><a href="#h95-1-72" id="h95-1-72" class="i">+                                },
</a><a href="#h95-1-73" id="h95-1-73" class="i">+                                Column {
</a><a href="#h95-1-74" id="h95-1-74" class="i">+                                    name: &quot;ultrahd&quot;,
</a><a href="#h95-1-75" id="h95-1-75" class="i">+                                    datatype: Boolean,
</a><a href="#h95-1-76" id="h95-1-76" class="i">+                                    primary_key: false,
</a><a href="#h95-1-77" id="h95-1-77" class="i">+                                    nullable: true,
</a><a href="#h95-1-78" id="h95-1-78" class="i">+                                    default: Some(
</a><a href="#h95-1-79" id="h95-1-79" class="i">+                                        Null,
</a><a href="#h95-1-80" id="h95-1-80" class="i">+                                    ),
</a><a href="#h95-1-81" id="h95-1-81" class="i">+                                    unique: false,
</a><a href="#h95-1-82" id="h95-1-82" class="i">+                                    references: None,
</a><a href="#h95-1-83" id="h95-1-83" class="i">+                                    index: false,
</a><a href="#h95-1-84" id="h95-1-84" class="i">+                                },
</a><a href="#h95-1-85" id="h95-1-85" class="i">+                            ],
</a><a href="#h95-1-86" id="h95-1-86" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h95-2" id="h95-2" class="h">@@ -293,7 +481,31 @@ Optimized plan: Select(
</a>                         ),
                     ),
                     right: Scan {
<a href="#h95-2-3" id="h95-2-3" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h95-2-4" id="h95-2-4" class="i">+                        table: Table {
</a><a href="#h95-2-5" id="h95-2-5" class="i">+                            name: &quot;genres&quot;,
</a><a href="#h95-2-6" id="h95-2-6" class="i">+                            columns: [
</a><a href="#h95-2-7" id="h95-2-7" class="i">+                                Column {
</a><a href="#h95-2-8" id="h95-2-8" class="i">+                                    name: &quot;id&quot;,
</a><a href="#h95-2-9" id="h95-2-9" class="i">+                                    datatype: Integer,
</a><a href="#h95-2-10" id="h95-2-10" class="i">+                                    primary_key: true,
</a><a href="#h95-2-11" id="h95-2-11" class="i">+                                    nullable: false,
</a><a href="#h95-2-12" id="h95-2-12" class="i">+                                    default: None,
</a><a href="#h95-2-13" id="h95-2-13" class="i">+                                    unique: true,
</a><a href="#h95-2-14" id="h95-2-14" class="i">+                                    references: None,
</a><a href="#h95-2-15" id="h95-2-15" class="i">+                                    index: false,
</a><a href="#h95-2-16" id="h95-2-16" class="i">+                                },
</a><a href="#h95-2-17" id="h95-2-17" class="i">+                                Column {
</a><a href="#h95-2-18" id="h95-2-18" class="i">+                                    name: &quot;name&quot;,
</a><a href="#h95-2-19" id="h95-2-19" class="i">+                                    datatype: String,
</a><a href="#h95-2-20" id="h95-2-20" class="i">+                                    primary_key: false,
</a><a href="#h95-2-21" id="h95-2-21" class="i">+                                    nullable: false,
</a><a href="#h95-2-22" id="h95-2-22" class="i">+                                    default: None,
</a><a href="#h95-2-23" id="h95-2-23" class="i">+                                    unique: false,
</a><a href="#h95-2-24" id="h95-2-24" class="i">+                                    references: None,
</a><a href="#h95-2-25" id="h95-2-25" class="i">+                                    index: false,
</a><a href="#h95-2-26" id="h95-2-26" class="i">+                                },
</a><a href="#h95-2-27" id="h95-2-27" class="i">+                            ],
</a><a href="#h95-2-28" id="h95-2-28" class="i">+                        },
</a>                         alias: None,
                         filter: None,
                     },
<b>diff --git a/<a id="h96" href="../file/tests/sql/query/order_float_asc.html">tests/sql/query/order_float_asc</a> b/<a href="../file/tests/sql/query/order_float_asc.html">tests/sql/query/order_float_asc</a></b>
<a href="#h96-0" id="h96-0" class="h">@@ -38,7 +38,33 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h96-0-3" id="h96-0-3" class="d">-            table: &quot;floats&quot;,
</a><a href="#h96-0-4" id="h96-0-4" class="i">+            table: Table {
</a><a href="#h96-0-5" id="h96-0-5" class="i">+                name: &quot;floats&quot;,
</a><a href="#h96-0-6" id="h96-0-6" class="i">+                columns: [
</a><a href="#h96-0-7" id="h96-0-7" class="i">+                    Column {
</a><a href="#h96-0-8" id="h96-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h96-0-9" id="h96-0-9" class="i">+                        datatype: Integer,
</a><a href="#h96-0-10" id="h96-0-10" class="i">+                        primary_key: true,
</a><a href="#h96-0-11" id="h96-0-11" class="i">+                        nullable: false,
</a><a href="#h96-0-12" id="h96-0-12" class="i">+                        default: None,
</a><a href="#h96-0-13" id="h96-0-13" class="i">+                        unique: true,
</a><a href="#h96-0-14" id="h96-0-14" class="i">+                        references: None,
</a><a href="#h96-0-15" id="h96-0-15" class="i">+                        index: false,
</a><a href="#h96-0-16" id="h96-0-16" class="i">+                    },
</a><a href="#h96-0-17" id="h96-0-17" class="i">+                    Column {
</a><a href="#h96-0-18" id="h96-0-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h96-0-19" id="h96-0-19" class="i">+                        datatype: Float,
</a><a href="#h96-0-20" id="h96-0-20" class="i">+                        primary_key: false,
</a><a href="#h96-0-21" id="h96-0-21" class="i">+                        nullable: true,
</a><a href="#h96-0-22" id="h96-0-22" class="i">+                        default: Some(
</a><a href="#h96-0-23" id="h96-0-23" class="i">+                            Null,
</a><a href="#h96-0-24" id="h96-0-24" class="i">+                        ),
</a><a href="#h96-0-25" id="h96-0-25" class="i">+                        unique: false,
</a><a href="#h96-0-26" id="h96-0-26" class="i">+                        references: None,
</a><a href="#h96-0-27" id="h96-0-27" class="i">+                        index: false,
</a><a href="#h96-0-28" id="h96-0-28" class="i">+                    },
</a><a href="#h96-0-29" id="h96-0-29" class="i">+                ],
</a><a href="#h96-0-30" id="h96-0-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h96-1" id="h96-1" class="h">@@ -62,7 +88,33 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h96-1-3" id="h96-1-3" class="d">-            table: &quot;floats&quot;,
</a><a href="#h96-1-4" id="h96-1-4" class="i">+            table: Table {
</a><a href="#h96-1-5" id="h96-1-5" class="i">+                name: &quot;floats&quot;,
</a><a href="#h96-1-6" id="h96-1-6" class="i">+                columns: [
</a><a href="#h96-1-7" id="h96-1-7" class="i">+                    Column {
</a><a href="#h96-1-8" id="h96-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h96-1-9" id="h96-1-9" class="i">+                        datatype: Integer,
</a><a href="#h96-1-10" id="h96-1-10" class="i">+                        primary_key: true,
</a><a href="#h96-1-11" id="h96-1-11" class="i">+                        nullable: false,
</a><a href="#h96-1-12" id="h96-1-12" class="i">+                        default: None,
</a><a href="#h96-1-13" id="h96-1-13" class="i">+                        unique: true,
</a><a href="#h96-1-14" id="h96-1-14" class="i">+                        references: None,
</a><a href="#h96-1-15" id="h96-1-15" class="i">+                        index: false,
</a><a href="#h96-1-16" id="h96-1-16" class="i">+                    },
</a><a href="#h96-1-17" id="h96-1-17" class="i">+                    Column {
</a><a href="#h96-1-18" id="h96-1-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h96-1-19" id="h96-1-19" class="i">+                        datatype: Float,
</a><a href="#h96-1-20" id="h96-1-20" class="i">+                        primary_key: false,
</a><a href="#h96-1-21" id="h96-1-21" class="i">+                        nullable: true,
</a><a href="#h96-1-22" id="h96-1-22" class="i">+                        default: Some(
</a><a href="#h96-1-23" id="h96-1-23" class="i">+                            Null,
</a><a href="#h96-1-24" id="h96-1-24" class="i">+                        ),
</a><a href="#h96-1-25" id="h96-1-25" class="i">+                        unique: false,
</a><a href="#h96-1-26" id="h96-1-26" class="i">+                        references: None,
</a><a href="#h96-1-27" id="h96-1-27" class="i">+                        index: false,
</a><a href="#h96-1-28" id="h96-1-28" class="i">+                    },
</a><a href="#h96-1-29" id="h96-1-29" class="i">+                ],
</a><a href="#h96-1-30" id="h96-1-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h97" href="../file/tests/sql/query/order_float_desc.html">tests/sql/query/order_float_desc</a> b/<a href="../file/tests/sql/query/order_float_desc.html">tests/sql/query/order_float_desc</a></b>
<a href="#h97-0" id="h97-0" class="h">@@ -38,7 +38,33 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h97-0-3" id="h97-0-3" class="d">-            table: &quot;floats&quot;,
</a><a href="#h97-0-4" id="h97-0-4" class="i">+            table: Table {
</a><a href="#h97-0-5" id="h97-0-5" class="i">+                name: &quot;floats&quot;,
</a><a href="#h97-0-6" id="h97-0-6" class="i">+                columns: [
</a><a href="#h97-0-7" id="h97-0-7" class="i">+                    Column {
</a><a href="#h97-0-8" id="h97-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h97-0-9" id="h97-0-9" class="i">+                        datatype: Integer,
</a><a href="#h97-0-10" id="h97-0-10" class="i">+                        primary_key: true,
</a><a href="#h97-0-11" id="h97-0-11" class="i">+                        nullable: false,
</a><a href="#h97-0-12" id="h97-0-12" class="i">+                        default: None,
</a><a href="#h97-0-13" id="h97-0-13" class="i">+                        unique: true,
</a><a href="#h97-0-14" id="h97-0-14" class="i">+                        references: None,
</a><a href="#h97-0-15" id="h97-0-15" class="i">+                        index: false,
</a><a href="#h97-0-16" id="h97-0-16" class="i">+                    },
</a><a href="#h97-0-17" id="h97-0-17" class="i">+                    Column {
</a><a href="#h97-0-18" id="h97-0-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h97-0-19" id="h97-0-19" class="i">+                        datatype: Float,
</a><a href="#h97-0-20" id="h97-0-20" class="i">+                        primary_key: false,
</a><a href="#h97-0-21" id="h97-0-21" class="i">+                        nullable: true,
</a><a href="#h97-0-22" id="h97-0-22" class="i">+                        default: Some(
</a><a href="#h97-0-23" id="h97-0-23" class="i">+                            Null,
</a><a href="#h97-0-24" id="h97-0-24" class="i">+                        ),
</a><a href="#h97-0-25" id="h97-0-25" class="i">+                        unique: false,
</a><a href="#h97-0-26" id="h97-0-26" class="i">+                        references: None,
</a><a href="#h97-0-27" id="h97-0-27" class="i">+                        index: false,
</a><a href="#h97-0-28" id="h97-0-28" class="i">+                    },
</a><a href="#h97-0-29" id="h97-0-29" class="i">+                ],
</a><a href="#h97-0-30" id="h97-0-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h97-1" id="h97-1" class="h">@@ -62,7 +88,33 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h97-1-3" id="h97-1-3" class="d">-            table: &quot;floats&quot;,
</a><a href="#h97-1-4" id="h97-1-4" class="i">+            table: Table {
</a><a href="#h97-1-5" id="h97-1-5" class="i">+                name: &quot;floats&quot;,
</a><a href="#h97-1-6" id="h97-1-6" class="i">+                columns: [
</a><a href="#h97-1-7" id="h97-1-7" class="i">+                    Column {
</a><a href="#h97-1-8" id="h97-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h97-1-9" id="h97-1-9" class="i">+                        datatype: Integer,
</a><a href="#h97-1-10" id="h97-1-10" class="i">+                        primary_key: true,
</a><a href="#h97-1-11" id="h97-1-11" class="i">+                        nullable: false,
</a><a href="#h97-1-12" id="h97-1-12" class="i">+                        default: None,
</a><a href="#h97-1-13" id="h97-1-13" class="i">+                        unique: true,
</a><a href="#h97-1-14" id="h97-1-14" class="i">+                        references: None,
</a><a href="#h97-1-15" id="h97-1-15" class="i">+                        index: false,
</a><a href="#h97-1-16" id="h97-1-16" class="i">+                    },
</a><a href="#h97-1-17" id="h97-1-17" class="i">+                    Column {
</a><a href="#h97-1-18" id="h97-1-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h97-1-19" id="h97-1-19" class="i">+                        datatype: Float,
</a><a href="#h97-1-20" id="h97-1-20" class="i">+                        primary_key: false,
</a><a href="#h97-1-21" id="h97-1-21" class="i">+                        nullable: true,
</a><a href="#h97-1-22" id="h97-1-22" class="i">+                        default: Some(
</a><a href="#h97-1-23" id="h97-1-23" class="i">+                            Null,
</a><a href="#h97-1-24" id="h97-1-24" class="i">+                        ),
</a><a href="#h97-1-25" id="h97-1-25" class="i">+                        unique: false,
</a><a href="#h97-1-26" id="h97-1-26" class="i">+                        references: None,
</a><a href="#h97-1-27" id="h97-1-27" class="i">+                        index: false,
</a><a href="#h97-1-28" id="h97-1-28" class="i">+                    },
</a><a href="#h97-1-29" id="h97-1-29" class="i">+                ],
</a><a href="#h97-1-30" id="h97-1-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h98" href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a> b/<a href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a></b>
<a href="#h98-0" id="h98-0" class="h">@@ -63,7 +63,89 @@ Plan: Select(
</a>                 source: Aggregation {
                     source: Projection {
                         source: Scan {
<a href="#h98-0-3" id="h98-0-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h98-0-4" id="h98-0-4" class="i">+                            table: Table {
</a><a href="#h98-0-5" id="h98-0-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h98-0-6" id="h98-0-6" class="i">+                                columns: [
</a><a href="#h98-0-7" id="h98-0-7" class="i">+                                    Column {
</a><a href="#h98-0-8" id="h98-0-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h98-0-9" id="h98-0-9" class="i">+                                        datatype: Integer,
</a><a href="#h98-0-10" id="h98-0-10" class="i">+                                        primary_key: true,
</a><a href="#h98-0-11" id="h98-0-11" class="i">+                                        nullable: false,
</a><a href="#h98-0-12" id="h98-0-12" class="i">+                                        default: None,
</a><a href="#h98-0-13" id="h98-0-13" class="i">+                                        unique: true,
</a><a href="#h98-0-14" id="h98-0-14" class="i">+                                        references: None,
</a><a href="#h98-0-15" id="h98-0-15" class="i">+                                        index: false,
</a><a href="#h98-0-16" id="h98-0-16" class="i">+                                    },
</a><a href="#h98-0-17" id="h98-0-17" class="i">+                                    Column {
</a><a href="#h98-0-18" id="h98-0-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h98-0-19" id="h98-0-19" class="i">+                                        datatype: String,
</a><a href="#h98-0-20" id="h98-0-20" class="i">+                                        primary_key: false,
</a><a href="#h98-0-21" id="h98-0-21" class="i">+                                        nullable: false,
</a><a href="#h98-0-22" id="h98-0-22" class="i">+                                        default: None,
</a><a href="#h98-0-23" id="h98-0-23" class="i">+                                        unique: false,
</a><a href="#h98-0-24" id="h98-0-24" class="i">+                                        references: None,
</a><a href="#h98-0-25" id="h98-0-25" class="i">+                                        index: false,
</a><a href="#h98-0-26" id="h98-0-26" class="i">+                                    },
</a><a href="#h98-0-27" id="h98-0-27" class="i">+                                    Column {
</a><a href="#h98-0-28" id="h98-0-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h98-0-29" id="h98-0-29" class="i">+                                        datatype: Integer,
</a><a href="#h98-0-30" id="h98-0-30" class="i">+                                        primary_key: false,
</a><a href="#h98-0-31" id="h98-0-31" class="i">+                                        nullable: false,
</a><a href="#h98-0-32" id="h98-0-32" class="i">+                                        default: None,
</a><a href="#h98-0-33" id="h98-0-33" class="i">+                                        unique: false,
</a><a href="#h98-0-34" id="h98-0-34" class="i">+                                        references: Some(
</a><a href="#h98-0-35" id="h98-0-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h98-0-36" id="h98-0-36" class="i">+                                        ),
</a><a href="#h98-0-37" id="h98-0-37" class="i">+                                        index: true,
</a><a href="#h98-0-38" id="h98-0-38" class="i">+                                    },
</a><a href="#h98-0-39" id="h98-0-39" class="i">+                                    Column {
</a><a href="#h98-0-40" id="h98-0-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h98-0-41" id="h98-0-41" class="i">+                                        datatype: Integer,
</a><a href="#h98-0-42" id="h98-0-42" class="i">+                                        primary_key: false,
</a><a href="#h98-0-43" id="h98-0-43" class="i">+                                        nullable: false,
</a><a href="#h98-0-44" id="h98-0-44" class="i">+                                        default: None,
</a><a href="#h98-0-45" id="h98-0-45" class="i">+                                        unique: false,
</a><a href="#h98-0-46" id="h98-0-46" class="i">+                                        references: Some(
</a><a href="#h98-0-47" id="h98-0-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h98-0-48" id="h98-0-48" class="i">+                                        ),
</a><a href="#h98-0-49" id="h98-0-49" class="i">+                                        index: true,
</a><a href="#h98-0-50" id="h98-0-50" class="i">+                                    },
</a><a href="#h98-0-51" id="h98-0-51" class="i">+                                    Column {
</a><a href="#h98-0-52" id="h98-0-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h98-0-53" id="h98-0-53" class="i">+                                        datatype: Integer,
</a><a href="#h98-0-54" id="h98-0-54" class="i">+                                        primary_key: false,
</a><a href="#h98-0-55" id="h98-0-55" class="i">+                                        nullable: false,
</a><a href="#h98-0-56" id="h98-0-56" class="i">+                                        default: None,
</a><a href="#h98-0-57" id="h98-0-57" class="i">+                                        unique: false,
</a><a href="#h98-0-58" id="h98-0-58" class="i">+                                        references: None,
</a><a href="#h98-0-59" id="h98-0-59" class="i">+                                        index: false,
</a><a href="#h98-0-60" id="h98-0-60" class="i">+                                    },
</a><a href="#h98-0-61" id="h98-0-61" class="i">+                                    Column {
</a><a href="#h98-0-62" id="h98-0-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h98-0-63" id="h98-0-63" class="i">+                                        datatype: Float,
</a><a href="#h98-0-64" id="h98-0-64" class="i">+                                        primary_key: false,
</a><a href="#h98-0-65" id="h98-0-65" class="i">+                                        nullable: true,
</a><a href="#h98-0-66" id="h98-0-66" class="i">+                                        default: Some(
</a><a href="#h98-0-67" id="h98-0-67" class="i">+                                            Null,
</a><a href="#h98-0-68" id="h98-0-68" class="i">+                                        ),
</a><a href="#h98-0-69" id="h98-0-69" class="i">+                                        unique: false,
</a><a href="#h98-0-70" id="h98-0-70" class="i">+                                        references: None,
</a><a href="#h98-0-71" id="h98-0-71" class="i">+                                        index: false,
</a><a href="#h98-0-72" id="h98-0-72" class="i">+                                    },
</a><a href="#h98-0-73" id="h98-0-73" class="i">+                                    Column {
</a><a href="#h98-0-74" id="h98-0-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h98-0-75" id="h98-0-75" class="i">+                                        datatype: Boolean,
</a><a href="#h98-0-76" id="h98-0-76" class="i">+                                        primary_key: false,
</a><a href="#h98-0-77" id="h98-0-77" class="i">+                                        nullable: true,
</a><a href="#h98-0-78" id="h98-0-78" class="i">+                                        default: Some(
</a><a href="#h98-0-79" id="h98-0-79" class="i">+                                            Null,
</a><a href="#h98-0-80" id="h98-0-80" class="i">+                                        ),
</a><a href="#h98-0-81" id="h98-0-81" class="i">+                                        unique: false,
</a><a href="#h98-0-82" id="h98-0-82" class="i">+                                        references: None,
</a><a href="#h98-0-83" id="h98-0-83" class="i">+                                        index: false,
</a><a href="#h98-0-84" id="h98-0-84" class="i">+                                    },
</a><a href="#h98-0-85" id="h98-0-85" class="i">+                                ],
</a><a href="#h98-0-86" id="h98-0-86" class="i">+                            },
</a>                             alias: None,
                             filter: None,
                         },
<a href="#h98-1" id="h98-1" class="h">@@ -158,7 +240,89 @@ Optimized plan: Select(
</a>                 source: Aggregation {
                     source: Projection {
                         source: Scan {
<a href="#h98-1-3" id="h98-1-3" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h98-1-4" id="h98-1-4" class="i">+                            table: Table {
</a><a href="#h98-1-5" id="h98-1-5" class="i">+                                name: &quot;movies&quot;,
</a><a href="#h98-1-6" id="h98-1-6" class="i">+                                columns: [
</a><a href="#h98-1-7" id="h98-1-7" class="i">+                                    Column {
</a><a href="#h98-1-8" id="h98-1-8" class="i">+                                        name: &quot;id&quot;,
</a><a href="#h98-1-9" id="h98-1-9" class="i">+                                        datatype: Integer,
</a><a href="#h98-1-10" id="h98-1-10" class="i">+                                        primary_key: true,
</a><a href="#h98-1-11" id="h98-1-11" class="i">+                                        nullable: false,
</a><a href="#h98-1-12" id="h98-1-12" class="i">+                                        default: None,
</a><a href="#h98-1-13" id="h98-1-13" class="i">+                                        unique: true,
</a><a href="#h98-1-14" id="h98-1-14" class="i">+                                        references: None,
</a><a href="#h98-1-15" id="h98-1-15" class="i">+                                        index: false,
</a><a href="#h98-1-16" id="h98-1-16" class="i">+                                    },
</a><a href="#h98-1-17" id="h98-1-17" class="i">+                                    Column {
</a><a href="#h98-1-18" id="h98-1-18" class="i">+                                        name: &quot;title&quot;,
</a><a href="#h98-1-19" id="h98-1-19" class="i">+                                        datatype: String,
</a><a href="#h98-1-20" id="h98-1-20" class="i">+                                        primary_key: false,
</a><a href="#h98-1-21" id="h98-1-21" class="i">+                                        nullable: false,
</a><a href="#h98-1-22" id="h98-1-22" class="i">+                                        default: None,
</a><a href="#h98-1-23" id="h98-1-23" class="i">+                                        unique: false,
</a><a href="#h98-1-24" id="h98-1-24" class="i">+                                        references: None,
</a><a href="#h98-1-25" id="h98-1-25" class="i">+                                        index: false,
</a><a href="#h98-1-26" id="h98-1-26" class="i">+                                    },
</a><a href="#h98-1-27" id="h98-1-27" class="i">+                                    Column {
</a><a href="#h98-1-28" id="h98-1-28" class="i">+                                        name: &quot;studio_id&quot;,
</a><a href="#h98-1-29" id="h98-1-29" class="i">+                                        datatype: Integer,
</a><a href="#h98-1-30" id="h98-1-30" class="i">+                                        primary_key: false,
</a><a href="#h98-1-31" id="h98-1-31" class="i">+                                        nullable: false,
</a><a href="#h98-1-32" id="h98-1-32" class="i">+                                        default: None,
</a><a href="#h98-1-33" id="h98-1-33" class="i">+                                        unique: false,
</a><a href="#h98-1-34" id="h98-1-34" class="i">+                                        references: Some(
</a><a href="#h98-1-35" id="h98-1-35" class="i">+                                            &quot;studios&quot;,
</a><a href="#h98-1-36" id="h98-1-36" class="i">+                                        ),
</a><a href="#h98-1-37" id="h98-1-37" class="i">+                                        index: true,
</a><a href="#h98-1-38" id="h98-1-38" class="i">+                                    },
</a><a href="#h98-1-39" id="h98-1-39" class="i">+                                    Column {
</a><a href="#h98-1-40" id="h98-1-40" class="i">+                                        name: &quot;genre_id&quot;,
</a><a href="#h98-1-41" id="h98-1-41" class="i">+                                        datatype: Integer,
</a><a href="#h98-1-42" id="h98-1-42" class="i">+                                        primary_key: false,
</a><a href="#h98-1-43" id="h98-1-43" class="i">+                                        nullable: false,
</a><a href="#h98-1-44" id="h98-1-44" class="i">+                                        default: None,
</a><a href="#h98-1-45" id="h98-1-45" class="i">+                                        unique: false,
</a><a href="#h98-1-46" id="h98-1-46" class="i">+                                        references: Some(
</a><a href="#h98-1-47" id="h98-1-47" class="i">+                                            &quot;genres&quot;,
</a><a href="#h98-1-48" id="h98-1-48" class="i">+                                        ),
</a><a href="#h98-1-49" id="h98-1-49" class="i">+                                        index: true,
</a><a href="#h98-1-50" id="h98-1-50" class="i">+                                    },
</a><a href="#h98-1-51" id="h98-1-51" class="i">+                                    Column {
</a><a href="#h98-1-52" id="h98-1-52" class="i">+                                        name: &quot;released&quot;,
</a><a href="#h98-1-53" id="h98-1-53" class="i">+                                        datatype: Integer,
</a><a href="#h98-1-54" id="h98-1-54" class="i">+                                        primary_key: false,
</a><a href="#h98-1-55" id="h98-1-55" class="i">+                                        nullable: false,
</a><a href="#h98-1-56" id="h98-1-56" class="i">+                                        default: None,
</a><a href="#h98-1-57" id="h98-1-57" class="i">+                                        unique: false,
</a><a href="#h98-1-58" id="h98-1-58" class="i">+                                        references: None,
</a><a href="#h98-1-59" id="h98-1-59" class="i">+                                        index: false,
</a><a href="#h98-1-60" id="h98-1-60" class="i">+                                    },
</a><a href="#h98-1-61" id="h98-1-61" class="i">+                                    Column {
</a><a href="#h98-1-62" id="h98-1-62" class="i">+                                        name: &quot;rating&quot;,
</a><a href="#h98-1-63" id="h98-1-63" class="i">+                                        datatype: Float,
</a><a href="#h98-1-64" id="h98-1-64" class="i">+                                        primary_key: false,
</a><a href="#h98-1-65" id="h98-1-65" class="i">+                                        nullable: true,
</a><a href="#h98-1-66" id="h98-1-66" class="i">+                                        default: Some(
</a><a href="#h98-1-67" id="h98-1-67" class="i">+                                            Null,
</a><a href="#h98-1-68" id="h98-1-68" class="i">+                                        ),
</a><a href="#h98-1-69" id="h98-1-69" class="i">+                                        unique: false,
</a><a href="#h98-1-70" id="h98-1-70" class="i">+                                        references: None,
</a><a href="#h98-1-71" id="h98-1-71" class="i">+                                        index: false,
</a><a href="#h98-1-72" id="h98-1-72" class="i">+                                    },
</a><a href="#h98-1-73" id="h98-1-73" class="i">+                                    Column {
</a><a href="#h98-1-74" id="h98-1-74" class="i">+                                        name: &quot;ultrahd&quot;,
</a><a href="#h98-1-75" id="h98-1-75" class="i">+                                        datatype: Boolean,
</a><a href="#h98-1-76" id="h98-1-76" class="i">+                                        primary_key: false,
</a><a href="#h98-1-77" id="h98-1-77" class="i">+                                        nullable: true,
</a><a href="#h98-1-78" id="h98-1-78" class="i">+                                        default: Some(
</a><a href="#h98-1-79" id="h98-1-79" class="i">+                                            Null,
</a><a href="#h98-1-80" id="h98-1-80" class="i">+                                        ),
</a><a href="#h98-1-81" id="h98-1-81" class="i">+                                        unique: false,
</a><a href="#h98-1-82" id="h98-1-82" class="i">+                                        references: None,
</a><a href="#h98-1-83" id="h98-1-83" class="i">+                                        index: false,
</a><a href="#h98-1-84" id="h98-1-84" class="i">+                                    },
</a><a href="#h98-1-85" id="h98-1-85" class="i">+                                ],
</a><a href="#h98-1-86" id="h98-1-86" class="i">+                            },
</a>                             alias: None,
                             filter: None,
                         },
<b>diff --git a/<a id="h99" href="../file/tests/sql/query/order_integer_asc.html">tests/sql/query/order_integer_asc</a> b/<a href="../file/tests/sql/query/order_integer_asc.html">tests/sql/query/order_integer_asc</a></b>
<a href="#h99-0" id="h99-0" class="h">@@ -38,7 +38,33 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h99-0-3" id="h99-0-3" class="d">-            table: &quot;integers&quot;,
</a><a href="#h99-0-4" id="h99-0-4" class="i">+            table: Table {
</a><a href="#h99-0-5" id="h99-0-5" class="i">+                name: &quot;integers&quot;,
</a><a href="#h99-0-6" id="h99-0-6" class="i">+                columns: [
</a><a href="#h99-0-7" id="h99-0-7" class="i">+                    Column {
</a><a href="#h99-0-8" id="h99-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h99-0-9" id="h99-0-9" class="i">+                        datatype: Integer,
</a><a href="#h99-0-10" id="h99-0-10" class="i">+                        primary_key: true,
</a><a href="#h99-0-11" id="h99-0-11" class="i">+                        nullable: false,
</a><a href="#h99-0-12" id="h99-0-12" class="i">+                        default: None,
</a><a href="#h99-0-13" id="h99-0-13" class="i">+                        unique: true,
</a><a href="#h99-0-14" id="h99-0-14" class="i">+                        references: None,
</a><a href="#h99-0-15" id="h99-0-15" class="i">+                        index: false,
</a><a href="#h99-0-16" id="h99-0-16" class="i">+                    },
</a><a href="#h99-0-17" id="h99-0-17" class="i">+                    Column {
</a><a href="#h99-0-18" id="h99-0-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h99-0-19" id="h99-0-19" class="i">+                        datatype: Integer,
</a><a href="#h99-0-20" id="h99-0-20" class="i">+                        primary_key: false,
</a><a href="#h99-0-21" id="h99-0-21" class="i">+                        nullable: true,
</a><a href="#h99-0-22" id="h99-0-22" class="i">+                        default: Some(
</a><a href="#h99-0-23" id="h99-0-23" class="i">+                            Null,
</a><a href="#h99-0-24" id="h99-0-24" class="i">+                        ),
</a><a href="#h99-0-25" id="h99-0-25" class="i">+                        unique: false,
</a><a href="#h99-0-26" id="h99-0-26" class="i">+                        references: None,
</a><a href="#h99-0-27" id="h99-0-27" class="i">+                        index: false,
</a><a href="#h99-0-28" id="h99-0-28" class="i">+                    },
</a><a href="#h99-0-29" id="h99-0-29" class="i">+                ],
</a><a href="#h99-0-30" id="h99-0-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h99-1" id="h99-1" class="h">@@ -62,7 +88,33 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h99-1-3" id="h99-1-3" class="d">-            table: &quot;integers&quot;,
</a><a href="#h99-1-4" id="h99-1-4" class="i">+            table: Table {
</a><a href="#h99-1-5" id="h99-1-5" class="i">+                name: &quot;integers&quot;,
</a><a href="#h99-1-6" id="h99-1-6" class="i">+                columns: [
</a><a href="#h99-1-7" id="h99-1-7" class="i">+                    Column {
</a><a href="#h99-1-8" id="h99-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h99-1-9" id="h99-1-9" class="i">+                        datatype: Integer,
</a><a href="#h99-1-10" id="h99-1-10" class="i">+                        primary_key: true,
</a><a href="#h99-1-11" id="h99-1-11" class="i">+                        nullable: false,
</a><a href="#h99-1-12" id="h99-1-12" class="i">+                        default: None,
</a><a href="#h99-1-13" id="h99-1-13" class="i">+                        unique: true,
</a><a href="#h99-1-14" id="h99-1-14" class="i">+                        references: None,
</a><a href="#h99-1-15" id="h99-1-15" class="i">+                        index: false,
</a><a href="#h99-1-16" id="h99-1-16" class="i">+                    },
</a><a href="#h99-1-17" id="h99-1-17" class="i">+                    Column {
</a><a href="#h99-1-18" id="h99-1-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h99-1-19" id="h99-1-19" class="i">+                        datatype: Integer,
</a><a href="#h99-1-20" id="h99-1-20" class="i">+                        primary_key: false,
</a><a href="#h99-1-21" id="h99-1-21" class="i">+                        nullable: true,
</a><a href="#h99-1-22" id="h99-1-22" class="i">+                        default: Some(
</a><a href="#h99-1-23" id="h99-1-23" class="i">+                            Null,
</a><a href="#h99-1-24" id="h99-1-24" class="i">+                        ),
</a><a href="#h99-1-25" id="h99-1-25" class="i">+                        unique: false,
</a><a href="#h99-1-26" id="h99-1-26" class="i">+                        references: None,
</a><a href="#h99-1-27" id="h99-1-27" class="i">+                        index: false,
</a><a href="#h99-1-28" id="h99-1-28" class="i">+                    },
</a><a href="#h99-1-29" id="h99-1-29" class="i">+                ],
</a><a href="#h99-1-30" id="h99-1-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h100" href="../file/tests/sql/query/order_integer_desc.html">tests/sql/query/order_integer_desc</a> b/<a href="../file/tests/sql/query/order_integer_desc.html">tests/sql/query/order_integer_desc</a></b>
<a href="#h100-0" id="h100-0" class="h">@@ -38,7 +38,33 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h100-0-3" id="h100-0-3" class="d">-            table: &quot;integers&quot;,
</a><a href="#h100-0-4" id="h100-0-4" class="i">+            table: Table {
</a><a href="#h100-0-5" id="h100-0-5" class="i">+                name: &quot;integers&quot;,
</a><a href="#h100-0-6" id="h100-0-6" class="i">+                columns: [
</a><a href="#h100-0-7" id="h100-0-7" class="i">+                    Column {
</a><a href="#h100-0-8" id="h100-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h100-0-9" id="h100-0-9" class="i">+                        datatype: Integer,
</a><a href="#h100-0-10" id="h100-0-10" class="i">+                        primary_key: true,
</a><a href="#h100-0-11" id="h100-0-11" class="i">+                        nullable: false,
</a><a href="#h100-0-12" id="h100-0-12" class="i">+                        default: None,
</a><a href="#h100-0-13" id="h100-0-13" class="i">+                        unique: true,
</a><a href="#h100-0-14" id="h100-0-14" class="i">+                        references: None,
</a><a href="#h100-0-15" id="h100-0-15" class="i">+                        index: false,
</a><a href="#h100-0-16" id="h100-0-16" class="i">+                    },
</a><a href="#h100-0-17" id="h100-0-17" class="i">+                    Column {
</a><a href="#h100-0-18" id="h100-0-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h100-0-19" id="h100-0-19" class="i">+                        datatype: Integer,
</a><a href="#h100-0-20" id="h100-0-20" class="i">+                        primary_key: false,
</a><a href="#h100-0-21" id="h100-0-21" class="i">+                        nullable: true,
</a><a href="#h100-0-22" id="h100-0-22" class="i">+                        default: Some(
</a><a href="#h100-0-23" id="h100-0-23" class="i">+                            Null,
</a><a href="#h100-0-24" id="h100-0-24" class="i">+                        ),
</a><a href="#h100-0-25" id="h100-0-25" class="i">+                        unique: false,
</a><a href="#h100-0-26" id="h100-0-26" class="i">+                        references: None,
</a><a href="#h100-0-27" id="h100-0-27" class="i">+                        index: false,
</a><a href="#h100-0-28" id="h100-0-28" class="i">+                    },
</a><a href="#h100-0-29" id="h100-0-29" class="i">+                ],
</a><a href="#h100-0-30" id="h100-0-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h100-1" id="h100-1" class="h">@@ -62,7 +88,33 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h100-1-3" id="h100-1-3" class="d">-            table: &quot;integers&quot;,
</a><a href="#h100-1-4" id="h100-1-4" class="i">+            table: Table {
</a><a href="#h100-1-5" id="h100-1-5" class="i">+                name: &quot;integers&quot;,
</a><a href="#h100-1-6" id="h100-1-6" class="i">+                columns: [
</a><a href="#h100-1-7" id="h100-1-7" class="i">+                    Column {
</a><a href="#h100-1-8" id="h100-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h100-1-9" id="h100-1-9" class="i">+                        datatype: Integer,
</a><a href="#h100-1-10" id="h100-1-10" class="i">+                        primary_key: true,
</a><a href="#h100-1-11" id="h100-1-11" class="i">+                        nullable: false,
</a><a href="#h100-1-12" id="h100-1-12" class="i">+                        default: None,
</a><a href="#h100-1-13" id="h100-1-13" class="i">+                        unique: true,
</a><a href="#h100-1-14" id="h100-1-14" class="i">+                        references: None,
</a><a href="#h100-1-15" id="h100-1-15" class="i">+                        index: false,
</a><a href="#h100-1-16" id="h100-1-16" class="i">+                    },
</a><a href="#h100-1-17" id="h100-1-17" class="i">+                    Column {
</a><a href="#h100-1-18" id="h100-1-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h100-1-19" id="h100-1-19" class="i">+                        datatype: Integer,
</a><a href="#h100-1-20" id="h100-1-20" class="i">+                        primary_key: false,
</a><a href="#h100-1-21" id="h100-1-21" class="i">+                        nullable: true,
</a><a href="#h100-1-22" id="h100-1-22" class="i">+                        default: Some(
</a><a href="#h100-1-23" id="h100-1-23" class="i">+                            Null,
</a><a href="#h100-1-24" id="h100-1-24" class="i">+                        ),
</a><a href="#h100-1-25" id="h100-1-25" class="i">+                        unique: false,
</a><a href="#h100-1-26" id="h100-1-26" class="i">+                        references: None,
</a><a href="#h100-1-27" id="h100-1-27" class="i">+                        index: false,
</a><a href="#h100-1-28" id="h100-1-28" class="i">+                    },
</a><a href="#h100-1-29" id="h100-1-29" class="i">+                ],
</a><a href="#h100-1-30" id="h100-1-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h101" href="../file/tests/sql/query/order_multi.html">tests/sql/query/order_multi</a> b/<a href="../file/tests/sql/query/order_multi.html">tests/sql/query/order_multi</a></b>
<a href="#h101-0" id="h101-0" class="h">@@ -50,7 +50,89 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h101-0-3" id="h101-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h101-0-4" id="h101-0-4" class="i">+            table: Table {
</a><a href="#h101-0-5" id="h101-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h101-0-6" id="h101-0-6" class="i">+                columns: [
</a><a href="#h101-0-7" id="h101-0-7" class="i">+                    Column {
</a><a href="#h101-0-8" id="h101-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h101-0-9" id="h101-0-9" class="i">+                        datatype: Integer,
</a><a href="#h101-0-10" id="h101-0-10" class="i">+                        primary_key: true,
</a><a href="#h101-0-11" id="h101-0-11" class="i">+                        nullable: false,
</a><a href="#h101-0-12" id="h101-0-12" class="i">+                        default: None,
</a><a href="#h101-0-13" id="h101-0-13" class="i">+                        unique: true,
</a><a href="#h101-0-14" id="h101-0-14" class="i">+                        references: None,
</a><a href="#h101-0-15" id="h101-0-15" class="i">+                        index: false,
</a><a href="#h101-0-16" id="h101-0-16" class="i">+                    },
</a><a href="#h101-0-17" id="h101-0-17" class="i">+                    Column {
</a><a href="#h101-0-18" id="h101-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h101-0-19" id="h101-0-19" class="i">+                        datatype: String,
</a><a href="#h101-0-20" id="h101-0-20" class="i">+                        primary_key: false,
</a><a href="#h101-0-21" id="h101-0-21" class="i">+                        nullable: false,
</a><a href="#h101-0-22" id="h101-0-22" class="i">+                        default: None,
</a><a href="#h101-0-23" id="h101-0-23" class="i">+                        unique: false,
</a><a href="#h101-0-24" id="h101-0-24" class="i">+                        references: None,
</a><a href="#h101-0-25" id="h101-0-25" class="i">+                        index: false,
</a><a href="#h101-0-26" id="h101-0-26" class="i">+                    },
</a><a href="#h101-0-27" id="h101-0-27" class="i">+                    Column {
</a><a href="#h101-0-28" id="h101-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h101-0-29" id="h101-0-29" class="i">+                        datatype: Integer,
</a><a href="#h101-0-30" id="h101-0-30" class="i">+                        primary_key: false,
</a><a href="#h101-0-31" id="h101-0-31" class="i">+                        nullable: false,
</a><a href="#h101-0-32" id="h101-0-32" class="i">+                        default: None,
</a><a href="#h101-0-33" id="h101-0-33" class="i">+                        unique: false,
</a><a href="#h101-0-34" id="h101-0-34" class="i">+                        references: Some(
</a><a href="#h101-0-35" id="h101-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h101-0-36" id="h101-0-36" class="i">+                        ),
</a><a href="#h101-0-37" id="h101-0-37" class="i">+                        index: true,
</a><a href="#h101-0-38" id="h101-0-38" class="i">+                    },
</a><a href="#h101-0-39" id="h101-0-39" class="i">+                    Column {
</a><a href="#h101-0-40" id="h101-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h101-0-41" id="h101-0-41" class="i">+                        datatype: Integer,
</a><a href="#h101-0-42" id="h101-0-42" class="i">+                        primary_key: false,
</a><a href="#h101-0-43" id="h101-0-43" class="i">+                        nullable: false,
</a><a href="#h101-0-44" id="h101-0-44" class="i">+                        default: None,
</a><a href="#h101-0-45" id="h101-0-45" class="i">+                        unique: false,
</a><a href="#h101-0-46" id="h101-0-46" class="i">+                        references: Some(
</a><a href="#h101-0-47" id="h101-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h101-0-48" id="h101-0-48" class="i">+                        ),
</a><a href="#h101-0-49" id="h101-0-49" class="i">+                        index: true,
</a><a href="#h101-0-50" id="h101-0-50" class="i">+                    },
</a><a href="#h101-0-51" id="h101-0-51" class="i">+                    Column {
</a><a href="#h101-0-52" id="h101-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h101-0-53" id="h101-0-53" class="i">+                        datatype: Integer,
</a><a href="#h101-0-54" id="h101-0-54" class="i">+                        primary_key: false,
</a><a href="#h101-0-55" id="h101-0-55" class="i">+                        nullable: false,
</a><a href="#h101-0-56" id="h101-0-56" class="i">+                        default: None,
</a><a href="#h101-0-57" id="h101-0-57" class="i">+                        unique: false,
</a><a href="#h101-0-58" id="h101-0-58" class="i">+                        references: None,
</a><a href="#h101-0-59" id="h101-0-59" class="i">+                        index: false,
</a><a href="#h101-0-60" id="h101-0-60" class="i">+                    },
</a><a href="#h101-0-61" id="h101-0-61" class="i">+                    Column {
</a><a href="#h101-0-62" id="h101-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h101-0-63" id="h101-0-63" class="i">+                        datatype: Float,
</a><a href="#h101-0-64" id="h101-0-64" class="i">+                        primary_key: false,
</a><a href="#h101-0-65" id="h101-0-65" class="i">+                        nullable: true,
</a><a href="#h101-0-66" id="h101-0-66" class="i">+                        default: Some(
</a><a href="#h101-0-67" id="h101-0-67" class="i">+                            Null,
</a><a href="#h101-0-68" id="h101-0-68" class="i">+                        ),
</a><a href="#h101-0-69" id="h101-0-69" class="i">+                        unique: false,
</a><a href="#h101-0-70" id="h101-0-70" class="i">+                        references: None,
</a><a href="#h101-0-71" id="h101-0-71" class="i">+                        index: false,
</a><a href="#h101-0-72" id="h101-0-72" class="i">+                    },
</a><a href="#h101-0-73" id="h101-0-73" class="i">+                    Column {
</a><a href="#h101-0-74" id="h101-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h101-0-75" id="h101-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h101-0-76" id="h101-0-76" class="i">+                        primary_key: false,
</a><a href="#h101-0-77" id="h101-0-77" class="i">+                        nullable: true,
</a><a href="#h101-0-78" id="h101-0-78" class="i">+                        default: Some(
</a><a href="#h101-0-79" id="h101-0-79" class="i">+                            Null,
</a><a href="#h101-0-80" id="h101-0-80" class="i">+                        ),
</a><a href="#h101-0-81" id="h101-0-81" class="i">+                        unique: false,
</a><a href="#h101-0-82" id="h101-0-82" class="i">+                        references: None,
</a><a href="#h101-0-83" id="h101-0-83" class="i">+                        index: false,
</a><a href="#h101-0-84" id="h101-0-84" class="i">+                    },
</a><a href="#h101-0-85" id="h101-0-85" class="i">+                ],
</a><a href="#h101-0-86" id="h101-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h101-1" id="h101-1" class="h">@@ -86,7 +168,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h101-1-3" id="h101-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h101-1-4" id="h101-1-4" class="i">+            table: Table {
</a><a href="#h101-1-5" id="h101-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h101-1-6" id="h101-1-6" class="i">+                columns: [
</a><a href="#h101-1-7" id="h101-1-7" class="i">+                    Column {
</a><a href="#h101-1-8" id="h101-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h101-1-9" id="h101-1-9" class="i">+                        datatype: Integer,
</a><a href="#h101-1-10" id="h101-1-10" class="i">+                        primary_key: true,
</a><a href="#h101-1-11" id="h101-1-11" class="i">+                        nullable: false,
</a><a href="#h101-1-12" id="h101-1-12" class="i">+                        default: None,
</a><a href="#h101-1-13" id="h101-1-13" class="i">+                        unique: true,
</a><a href="#h101-1-14" id="h101-1-14" class="i">+                        references: None,
</a><a href="#h101-1-15" id="h101-1-15" class="i">+                        index: false,
</a><a href="#h101-1-16" id="h101-1-16" class="i">+                    },
</a><a href="#h101-1-17" id="h101-1-17" class="i">+                    Column {
</a><a href="#h101-1-18" id="h101-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h101-1-19" id="h101-1-19" class="i">+                        datatype: String,
</a><a href="#h101-1-20" id="h101-1-20" class="i">+                        primary_key: false,
</a><a href="#h101-1-21" id="h101-1-21" class="i">+                        nullable: false,
</a><a href="#h101-1-22" id="h101-1-22" class="i">+                        default: None,
</a><a href="#h101-1-23" id="h101-1-23" class="i">+                        unique: false,
</a><a href="#h101-1-24" id="h101-1-24" class="i">+                        references: None,
</a><a href="#h101-1-25" id="h101-1-25" class="i">+                        index: false,
</a><a href="#h101-1-26" id="h101-1-26" class="i">+                    },
</a><a href="#h101-1-27" id="h101-1-27" class="i">+                    Column {
</a><a href="#h101-1-28" id="h101-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h101-1-29" id="h101-1-29" class="i">+                        datatype: Integer,
</a><a href="#h101-1-30" id="h101-1-30" class="i">+                        primary_key: false,
</a><a href="#h101-1-31" id="h101-1-31" class="i">+                        nullable: false,
</a><a href="#h101-1-32" id="h101-1-32" class="i">+                        default: None,
</a><a href="#h101-1-33" id="h101-1-33" class="i">+                        unique: false,
</a><a href="#h101-1-34" id="h101-1-34" class="i">+                        references: Some(
</a><a href="#h101-1-35" id="h101-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h101-1-36" id="h101-1-36" class="i">+                        ),
</a><a href="#h101-1-37" id="h101-1-37" class="i">+                        index: true,
</a><a href="#h101-1-38" id="h101-1-38" class="i">+                    },
</a><a href="#h101-1-39" id="h101-1-39" class="i">+                    Column {
</a><a href="#h101-1-40" id="h101-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h101-1-41" id="h101-1-41" class="i">+                        datatype: Integer,
</a><a href="#h101-1-42" id="h101-1-42" class="i">+                        primary_key: false,
</a><a href="#h101-1-43" id="h101-1-43" class="i">+                        nullable: false,
</a><a href="#h101-1-44" id="h101-1-44" class="i">+                        default: None,
</a><a href="#h101-1-45" id="h101-1-45" class="i">+                        unique: false,
</a><a href="#h101-1-46" id="h101-1-46" class="i">+                        references: Some(
</a><a href="#h101-1-47" id="h101-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h101-1-48" id="h101-1-48" class="i">+                        ),
</a><a href="#h101-1-49" id="h101-1-49" class="i">+                        index: true,
</a><a href="#h101-1-50" id="h101-1-50" class="i">+                    },
</a><a href="#h101-1-51" id="h101-1-51" class="i">+                    Column {
</a><a href="#h101-1-52" id="h101-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h101-1-53" id="h101-1-53" class="i">+                        datatype: Integer,
</a><a href="#h101-1-54" id="h101-1-54" class="i">+                        primary_key: false,
</a><a href="#h101-1-55" id="h101-1-55" class="i">+                        nullable: false,
</a><a href="#h101-1-56" id="h101-1-56" class="i">+                        default: None,
</a><a href="#h101-1-57" id="h101-1-57" class="i">+                        unique: false,
</a><a href="#h101-1-58" id="h101-1-58" class="i">+                        references: None,
</a><a href="#h101-1-59" id="h101-1-59" class="i">+                        index: false,
</a><a href="#h101-1-60" id="h101-1-60" class="i">+                    },
</a><a href="#h101-1-61" id="h101-1-61" class="i">+                    Column {
</a><a href="#h101-1-62" id="h101-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h101-1-63" id="h101-1-63" class="i">+                        datatype: Float,
</a><a href="#h101-1-64" id="h101-1-64" class="i">+                        primary_key: false,
</a><a href="#h101-1-65" id="h101-1-65" class="i">+                        nullable: true,
</a><a href="#h101-1-66" id="h101-1-66" class="i">+                        default: Some(
</a><a href="#h101-1-67" id="h101-1-67" class="i">+                            Null,
</a><a href="#h101-1-68" id="h101-1-68" class="i">+                        ),
</a><a href="#h101-1-69" id="h101-1-69" class="i">+                        unique: false,
</a><a href="#h101-1-70" id="h101-1-70" class="i">+                        references: None,
</a><a href="#h101-1-71" id="h101-1-71" class="i">+                        index: false,
</a><a href="#h101-1-72" id="h101-1-72" class="i">+                    },
</a><a href="#h101-1-73" id="h101-1-73" class="i">+                    Column {
</a><a href="#h101-1-74" id="h101-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h101-1-75" id="h101-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h101-1-76" id="h101-1-76" class="i">+                        primary_key: false,
</a><a href="#h101-1-77" id="h101-1-77" class="i">+                        nullable: true,
</a><a href="#h101-1-78" id="h101-1-78" class="i">+                        default: Some(
</a><a href="#h101-1-79" id="h101-1-79" class="i">+                            Null,
</a><a href="#h101-1-80" id="h101-1-80" class="i">+                        ),
</a><a href="#h101-1-81" id="h101-1-81" class="i">+                        unique: false,
</a><a href="#h101-1-82" id="h101-1-82" class="i">+                        references: None,
</a><a href="#h101-1-83" id="h101-1-83" class="i">+                        index: false,
</a><a href="#h101-1-84" id="h101-1-84" class="i">+                    },
</a><a href="#h101-1-85" id="h101-1-85" class="i">+                ],
</a><a href="#h101-1-86" id="h101-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h102" href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a> b/<a href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a></b>
<a href="#h102-0" id="h102-0" class="h">@@ -62,7 +62,89 @@ Plan: Select(
</a>         source: Order {
             source: Projection {
                 source: Scan {
<a href="#h102-0-3" id="h102-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h102-0-4" id="h102-0-4" class="i">+                    table: Table {
</a><a href="#h102-0-5" id="h102-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h102-0-6" id="h102-0-6" class="i">+                        columns: [
</a><a href="#h102-0-7" id="h102-0-7" class="i">+                            Column {
</a><a href="#h102-0-8" id="h102-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h102-0-9" id="h102-0-9" class="i">+                                datatype: Integer,
</a><a href="#h102-0-10" id="h102-0-10" class="i">+                                primary_key: true,
</a><a href="#h102-0-11" id="h102-0-11" class="i">+                                nullable: false,
</a><a href="#h102-0-12" id="h102-0-12" class="i">+                                default: None,
</a><a href="#h102-0-13" id="h102-0-13" class="i">+                                unique: true,
</a><a href="#h102-0-14" id="h102-0-14" class="i">+                                references: None,
</a><a href="#h102-0-15" id="h102-0-15" class="i">+                                index: false,
</a><a href="#h102-0-16" id="h102-0-16" class="i">+                            },
</a><a href="#h102-0-17" id="h102-0-17" class="i">+                            Column {
</a><a href="#h102-0-18" id="h102-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h102-0-19" id="h102-0-19" class="i">+                                datatype: String,
</a><a href="#h102-0-20" id="h102-0-20" class="i">+                                primary_key: false,
</a><a href="#h102-0-21" id="h102-0-21" class="i">+                                nullable: false,
</a><a href="#h102-0-22" id="h102-0-22" class="i">+                                default: None,
</a><a href="#h102-0-23" id="h102-0-23" class="i">+                                unique: false,
</a><a href="#h102-0-24" id="h102-0-24" class="i">+                                references: None,
</a><a href="#h102-0-25" id="h102-0-25" class="i">+                                index: false,
</a><a href="#h102-0-26" id="h102-0-26" class="i">+                            },
</a><a href="#h102-0-27" id="h102-0-27" class="i">+                            Column {
</a><a href="#h102-0-28" id="h102-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h102-0-29" id="h102-0-29" class="i">+                                datatype: Integer,
</a><a href="#h102-0-30" id="h102-0-30" class="i">+                                primary_key: false,
</a><a href="#h102-0-31" id="h102-0-31" class="i">+                                nullable: false,
</a><a href="#h102-0-32" id="h102-0-32" class="i">+                                default: None,
</a><a href="#h102-0-33" id="h102-0-33" class="i">+                                unique: false,
</a><a href="#h102-0-34" id="h102-0-34" class="i">+                                references: Some(
</a><a href="#h102-0-35" id="h102-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h102-0-36" id="h102-0-36" class="i">+                                ),
</a><a href="#h102-0-37" id="h102-0-37" class="i">+                                index: true,
</a><a href="#h102-0-38" id="h102-0-38" class="i">+                            },
</a><a href="#h102-0-39" id="h102-0-39" class="i">+                            Column {
</a><a href="#h102-0-40" id="h102-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h102-0-41" id="h102-0-41" class="i">+                                datatype: Integer,
</a><a href="#h102-0-42" id="h102-0-42" class="i">+                                primary_key: false,
</a><a href="#h102-0-43" id="h102-0-43" class="i">+                                nullable: false,
</a><a href="#h102-0-44" id="h102-0-44" class="i">+                                default: None,
</a><a href="#h102-0-45" id="h102-0-45" class="i">+                                unique: false,
</a><a href="#h102-0-46" id="h102-0-46" class="i">+                                references: Some(
</a><a href="#h102-0-47" id="h102-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h102-0-48" id="h102-0-48" class="i">+                                ),
</a><a href="#h102-0-49" id="h102-0-49" class="i">+                                index: true,
</a><a href="#h102-0-50" id="h102-0-50" class="i">+                            },
</a><a href="#h102-0-51" id="h102-0-51" class="i">+                            Column {
</a><a href="#h102-0-52" id="h102-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h102-0-53" id="h102-0-53" class="i">+                                datatype: Integer,
</a><a href="#h102-0-54" id="h102-0-54" class="i">+                                primary_key: false,
</a><a href="#h102-0-55" id="h102-0-55" class="i">+                                nullable: false,
</a><a href="#h102-0-56" id="h102-0-56" class="i">+                                default: None,
</a><a href="#h102-0-57" id="h102-0-57" class="i">+                                unique: false,
</a><a href="#h102-0-58" id="h102-0-58" class="i">+                                references: None,
</a><a href="#h102-0-59" id="h102-0-59" class="i">+                                index: false,
</a><a href="#h102-0-60" id="h102-0-60" class="i">+                            },
</a><a href="#h102-0-61" id="h102-0-61" class="i">+                            Column {
</a><a href="#h102-0-62" id="h102-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h102-0-63" id="h102-0-63" class="i">+                                datatype: Float,
</a><a href="#h102-0-64" id="h102-0-64" class="i">+                                primary_key: false,
</a><a href="#h102-0-65" id="h102-0-65" class="i">+                                nullable: true,
</a><a href="#h102-0-66" id="h102-0-66" class="i">+                                default: Some(
</a><a href="#h102-0-67" id="h102-0-67" class="i">+                                    Null,
</a><a href="#h102-0-68" id="h102-0-68" class="i">+                                ),
</a><a href="#h102-0-69" id="h102-0-69" class="i">+                                unique: false,
</a><a href="#h102-0-70" id="h102-0-70" class="i">+                                references: None,
</a><a href="#h102-0-71" id="h102-0-71" class="i">+                                index: false,
</a><a href="#h102-0-72" id="h102-0-72" class="i">+                            },
</a><a href="#h102-0-73" id="h102-0-73" class="i">+                            Column {
</a><a href="#h102-0-74" id="h102-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h102-0-75" id="h102-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h102-0-76" id="h102-0-76" class="i">+                                primary_key: false,
</a><a href="#h102-0-77" id="h102-0-77" class="i">+                                nullable: true,
</a><a href="#h102-0-78" id="h102-0-78" class="i">+                                default: Some(
</a><a href="#h102-0-79" id="h102-0-79" class="i">+                                    Null,
</a><a href="#h102-0-80" id="h102-0-80" class="i">+                                ),
</a><a href="#h102-0-81" id="h102-0-81" class="i">+                                unique: false,
</a><a href="#h102-0-82" id="h102-0-82" class="i">+                                references: None,
</a><a href="#h102-0-83" id="h102-0-83" class="i">+                                index: false,
</a><a href="#h102-0-84" id="h102-0-84" class="i">+                            },
</a><a href="#h102-0-85" id="h102-0-85" class="i">+                        ],
</a><a href="#h102-0-86" id="h102-0-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h102-1" id="h102-1" class="h">@@ -146,7 +228,89 @@ Optimized plan: Select(
</a>         source: Order {
             source: Projection {
                 source: Scan {
<a href="#h102-1-3" id="h102-1-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h102-1-4" id="h102-1-4" class="i">+                    table: Table {
</a><a href="#h102-1-5" id="h102-1-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h102-1-6" id="h102-1-6" class="i">+                        columns: [
</a><a href="#h102-1-7" id="h102-1-7" class="i">+                            Column {
</a><a href="#h102-1-8" id="h102-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h102-1-9" id="h102-1-9" class="i">+                                datatype: Integer,
</a><a href="#h102-1-10" id="h102-1-10" class="i">+                                primary_key: true,
</a><a href="#h102-1-11" id="h102-1-11" class="i">+                                nullable: false,
</a><a href="#h102-1-12" id="h102-1-12" class="i">+                                default: None,
</a><a href="#h102-1-13" id="h102-1-13" class="i">+                                unique: true,
</a><a href="#h102-1-14" id="h102-1-14" class="i">+                                references: None,
</a><a href="#h102-1-15" id="h102-1-15" class="i">+                                index: false,
</a><a href="#h102-1-16" id="h102-1-16" class="i">+                            },
</a><a href="#h102-1-17" id="h102-1-17" class="i">+                            Column {
</a><a href="#h102-1-18" id="h102-1-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h102-1-19" id="h102-1-19" class="i">+                                datatype: String,
</a><a href="#h102-1-20" id="h102-1-20" class="i">+                                primary_key: false,
</a><a href="#h102-1-21" id="h102-1-21" class="i">+                                nullable: false,
</a><a href="#h102-1-22" id="h102-1-22" class="i">+                                default: None,
</a><a href="#h102-1-23" id="h102-1-23" class="i">+                                unique: false,
</a><a href="#h102-1-24" id="h102-1-24" class="i">+                                references: None,
</a><a href="#h102-1-25" id="h102-1-25" class="i">+                                index: false,
</a><a href="#h102-1-26" id="h102-1-26" class="i">+                            },
</a><a href="#h102-1-27" id="h102-1-27" class="i">+                            Column {
</a><a href="#h102-1-28" id="h102-1-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h102-1-29" id="h102-1-29" class="i">+                                datatype: Integer,
</a><a href="#h102-1-30" id="h102-1-30" class="i">+                                primary_key: false,
</a><a href="#h102-1-31" id="h102-1-31" class="i">+                                nullable: false,
</a><a href="#h102-1-32" id="h102-1-32" class="i">+                                default: None,
</a><a href="#h102-1-33" id="h102-1-33" class="i">+                                unique: false,
</a><a href="#h102-1-34" id="h102-1-34" class="i">+                                references: Some(
</a><a href="#h102-1-35" id="h102-1-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h102-1-36" id="h102-1-36" class="i">+                                ),
</a><a href="#h102-1-37" id="h102-1-37" class="i">+                                index: true,
</a><a href="#h102-1-38" id="h102-1-38" class="i">+                            },
</a><a href="#h102-1-39" id="h102-1-39" class="i">+                            Column {
</a><a href="#h102-1-40" id="h102-1-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h102-1-41" id="h102-1-41" class="i">+                                datatype: Integer,
</a><a href="#h102-1-42" id="h102-1-42" class="i">+                                primary_key: false,
</a><a href="#h102-1-43" id="h102-1-43" class="i">+                                nullable: false,
</a><a href="#h102-1-44" id="h102-1-44" class="i">+                                default: None,
</a><a href="#h102-1-45" id="h102-1-45" class="i">+                                unique: false,
</a><a href="#h102-1-46" id="h102-1-46" class="i">+                                references: Some(
</a><a href="#h102-1-47" id="h102-1-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h102-1-48" id="h102-1-48" class="i">+                                ),
</a><a href="#h102-1-49" id="h102-1-49" class="i">+                                index: true,
</a><a href="#h102-1-50" id="h102-1-50" class="i">+                            },
</a><a href="#h102-1-51" id="h102-1-51" class="i">+                            Column {
</a><a href="#h102-1-52" id="h102-1-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h102-1-53" id="h102-1-53" class="i">+                                datatype: Integer,
</a><a href="#h102-1-54" id="h102-1-54" class="i">+                                primary_key: false,
</a><a href="#h102-1-55" id="h102-1-55" class="i">+                                nullable: false,
</a><a href="#h102-1-56" id="h102-1-56" class="i">+                                default: None,
</a><a href="#h102-1-57" id="h102-1-57" class="i">+                                unique: false,
</a><a href="#h102-1-58" id="h102-1-58" class="i">+                                references: None,
</a><a href="#h102-1-59" id="h102-1-59" class="i">+                                index: false,
</a><a href="#h102-1-60" id="h102-1-60" class="i">+                            },
</a><a href="#h102-1-61" id="h102-1-61" class="i">+                            Column {
</a><a href="#h102-1-62" id="h102-1-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h102-1-63" id="h102-1-63" class="i">+                                datatype: Float,
</a><a href="#h102-1-64" id="h102-1-64" class="i">+                                primary_key: false,
</a><a href="#h102-1-65" id="h102-1-65" class="i">+                                nullable: true,
</a><a href="#h102-1-66" id="h102-1-66" class="i">+                                default: Some(
</a><a href="#h102-1-67" id="h102-1-67" class="i">+                                    Null,
</a><a href="#h102-1-68" id="h102-1-68" class="i">+                                ),
</a><a href="#h102-1-69" id="h102-1-69" class="i">+                                unique: false,
</a><a href="#h102-1-70" id="h102-1-70" class="i">+                                references: None,
</a><a href="#h102-1-71" id="h102-1-71" class="i">+                                index: false,
</a><a href="#h102-1-72" id="h102-1-72" class="i">+                            },
</a><a href="#h102-1-73" id="h102-1-73" class="i">+                            Column {
</a><a href="#h102-1-74" id="h102-1-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h102-1-75" id="h102-1-75" class="i">+                                datatype: Boolean,
</a><a href="#h102-1-76" id="h102-1-76" class="i">+                                primary_key: false,
</a><a href="#h102-1-77" id="h102-1-77" class="i">+                                nullable: true,
</a><a href="#h102-1-78" id="h102-1-78" class="i">+                                default: Some(
</a><a href="#h102-1-79" id="h102-1-79" class="i">+                                    Null,
</a><a href="#h102-1-80" id="h102-1-80" class="i">+                                ),
</a><a href="#h102-1-81" id="h102-1-81" class="i">+                                unique: false,
</a><a href="#h102-1-82" id="h102-1-82" class="i">+                                references: None,
</a><a href="#h102-1-83" id="h102-1-83" class="i">+                                index: false,
</a><a href="#h102-1-84" id="h102-1-84" class="i">+                            },
</a><a href="#h102-1-85" id="h102-1-85" class="i">+                        ],
</a><a href="#h102-1-86" id="h102-1-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<b>diff --git a/<a id="h103" href="../file/tests/sql/query/order_string_asc.html">tests/sql/query/order_string_asc</a> b/<a href="../file/tests/sql/query/order_string_asc.html">tests/sql/query/order_string_asc</a></b>
<a href="#h103-0" id="h103-0" class="h">@@ -41,7 +41,33 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h103-0-3" id="h103-0-3" class="d">-            table: &quot;strings&quot;,
</a><a href="#h103-0-4" id="h103-0-4" class="i">+            table: Table {
</a><a href="#h103-0-5" id="h103-0-5" class="i">+                name: &quot;strings&quot;,
</a><a href="#h103-0-6" id="h103-0-6" class="i">+                columns: [
</a><a href="#h103-0-7" id="h103-0-7" class="i">+                    Column {
</a><a href="#h103-0-8" id="h103-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h103-0-9" id="h103-0-9" class="i">+                        datatype: Integer,
</a><a href="#h103-0-10" id="h103-0-10" class="i">+                        primary_key: true,
</a><a href="#h103-0-11" id="h103-0-11" class="i">+                        nullable: false,
</a><a href="#h103-0-12" id="h103-0-12" class="i">+                        default: None,
</a><a href="#h103-0-13" id="h103-0-13" class="i">+                        unique: true,
</a><a href="#h103-0-14" id="h103-0-14" class="i">+                        references: None,
</a><a href="#h103-0-15" id="h103-0-15" class="i">+                        index: false,
</a><a href="#h103-0-16" id="h103-0-16" class="i">+                    },
</a><a href="#h103-0-17" id="h103-0-17" class="i">+                    Column {
</a><a href="#h103-0-18" id="h103-0-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h103-0-19" id="h103-0-19" class="i">+                        datatype: String,
</a><a href="#h103-0-20" id="h103-0-20" class="i">+                        primary_key: false,
</a><a href="#h103-0-21" id="h103-0-21" class="i">+                        nullable: true,
</a><a href="#h103-0-22" id="h103-0-22" class="i">+                        default: Some(
</a><a href="#h103-0-23" id="h103-0-23" class="i">+                            Null,
</a><a href="#h103-0-24" id="h103-0-24" class="i">+                        ),
</a><a href="#h103-0-25" id="h103-0-25" class="i">+                        unique: false,
</a><a href="#h103-0-26" id="h103-0-26" class="i">+                        references: None,
</a><a href="#h103-0-27" id="h103-0-27" class="i">+                        index: false,
</a><a href="#h103-0-28" id="h103-0-28" class="i">+                    },
</a><a href="#h103-0-29" id="h103-0-29" class="i">+                ],
</a><a href="#h103-0-30" id="h103-0-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h103-1" id="h103-1" class="h">@@ -65,7 +91,33 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h103-1-3" id="h103-1-3" class="d">-            table: &quot;strings&quot;,
</a><a href="#h103-1-4" id="h103-1-4" class="i">+            table: Table {
</a><a href="#h103-1-5" id="h103-1-5" class="i">+                name: &quot;strings&quot;,
</a><a href="#h103-1-6" id="h103-1-6" class="i">+                columns: [
</a><a href="#h103-1-7" id="h103-1-7" class="i">+                    Column {
</a><a href="#h103-1-8" id="h103-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h103-1-9" id="h103-1-9" class="i">+                        datatype: Integer,
</a><a href="#h103-1-10" id="h103-1-10" class="i">+                        primary_key: true,
</a><a href="#h103-1-11" id="h103-1-11" class="i">+                        nullable: false,
</a><a href="#h103-1-12" id="h103-1-12" class="i">+                        default: None,
</a><a href="#h103-1-13" id="h103-1-13" class="i">+                        unique: true,
</a><a href="#h103-1-14" id="h103-1-14" class="i">+                        references: None,
</a><a href="#h103-1-15" id="h103-1-15" class="i">+                        index: false,
</a><a href="#h103-1-16" id="h103-1-16" class="i">+                    },
</a><a href="#h103-1-17" id="h103-1-17" class="i">+                    Column {
</a><a href="#h103-1-18" id="h103-1-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h103-1-19" id="h103-1-19" class="i">+                        datatype: String,
</a><a href="#h103-1-20" id="h103-1-20" class="i">+                        primary_key: false,
</a><a href="#h103-1-21" id="h103-1-21" class="i">+                        nullable: true,
</a><a href="#h103-1-22" id="h103-1-22" class="i">+                        default: Some(
</a><a href="#h103-1-23" id="h103-1-23" class="i">+                            Null,
</a><a href="#h103-1-24" id="h103-1-24" class="i">+                        ),
</a><a href="#h103-1-25" id="h103-1-25" class="i">+                        unique: false,
</a><a href="#h103-1-26" id="h103-1-26" class="i">+                        references: None,
</a><a href="#h103-1-27" id="h103-1-27" class="i">+                        index: false,
</a><a href="#h103-1-28" id="h103-1-28" class="i">+                    },
</a><a href="#h103-1-29" id="h103-1-29" class="i">+                ],
</a><a href="#h103-1-30" id="h103-1-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h104" href="../file/tests/sql/query/order_string_desc.html">tests/sql/query/order_string_desc</a> b/<a href="../file/tests/sql/query/order_string_desc.html">tests/sql/query/order_string_desc</a></b>
<a href="#h104-0" id="h104-0" class="h">@@ -41,7 +41,33 @@ AST: Select {
</a> Plan: Select(
     Order {
         source: Scan {
<a href="#h104-0-3" id="h104-0-3" class="d">-            table: &quot;strings&quot;,
</a><a href="#h104-0-4" id="h104-0-4" class="i">+            table: Table {
</a><a href="#h104-0-5" id="h104-0-5" class="i">+                name: &quot;strings&quot;,
</a><a href="#h104-0-6" id="h104-0-6" class="i">+                columns: [
</a><a href="#h104-0-7" id="h104-0-7" class="i">+                    Column {
</a><a href="#h104-0-8" id="h104-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h104-0-9" id="h104-0-9" class="i">+                        datatype: Integer,
</a><a href="#h104-0-10" id="h104-0-10" class="i">+                        primary_key: true,
</a><a href="#h104-0-11" id="h104-0-11" class="i">+                        nullable: false,
</a><a href="#h104-0-12" id="h104-0-12" class="i">+                        default: None,
</a><a href="#h104-0-13" id="h104-0-13" class="i">+                        unique: true,
</a><a href="#h104-0-14" id="h104-0-14" class="i">+                        references: None,
</a><a href="#h104-0-15" id="h104-0-15" class="i">+                        index: false,
</a><a href="#h104-0-16" id="h104-0-16" class="i">+                    },
</a><a href="#h104-0-17" id="h104-0-17" class="i">+                    Column {
</a><a href="#h104-0-18" id="h104-0-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h104-0-19" id="h104-0-19" class="i">+                        datatype: String,
</a><a href="#h104-0-20" id="h104-0-20" class="i">+                        primary_key: false,
</a><a href="#h104-0-21" id="h104-0-21" class="i">+                        nullable: true,
</a><a href="#h104-0-22" id="h104-0-22" class="i">+                        default: Some(
</a><a href="#h104-0-23" id="h104-0-23" class="i">+                            Null,
</a><a href="#h104-0-24" id="h104-0-24" class="i">+                        ),
</a><a href="#h104-0-25" id="h104-0-25" class="i">+                        unique: false,
</a><a href="#h104-0-26" id="h104-0-26" class="i">+                        references: None,
</a><a href="#h104-0-27" id="h104-0-27" class="i">+                        index: false,
</a><a href="#h104-0-28" id="h104-0-28" class="i">+                    },
</a><a href="#h104-0-29" id="h104-0-29" class="i">+                ],
</a><a href="#h104-0-30" id="h104-0-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h104-1" id="h104-1" class="h">@@ -65,7 +91,33 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: Scan {
<a href="#h104-1-3" id="h104-1-3" class="d">-            table: &quot;strings&quot;,
</a><a href="#h104-1-4" id="h104-1-4" class="i">+            table: Table {
</a><a href="#h104-1-5" id="h104-1-5" class="i">+                name: &quot;strings&quot;,
</a><a href="#h104-1-6" id="h104-1-6" class="i">+                columns: [
</a><a href="#h104-1-7" id="h104-1-7" class="i">+                    Column {
</a><a href="#h104-1-8" id="h104-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h104-1-9" id="h104-1-9" class="i">+                        datatype: Integer,
</a><a href="#h104-1-10" id="h104-1-10" class="i">+                        primary_key: true,
</a><a href="#h104-1-11" id="h104-1-11" class="i">+                        nullable: false,
</a><a href="#h104-1-12" id="h104-1-12" class="i">+                        default: None,
</a><a href="#h104-1-13" id="h104-1-13" class="i">+                        unique: true,
</a><a href="#h104-1-14" id="h104-1-14" class="i">+                        references: None,
</a><a href="#h104-1-15" id="h104-1-15" class="i">+                        index: false,
</a><a href="#h104-1-16" id="h104-1-16" class="i">+                    },
</a><a href="#h104-1-17" id="h104-1-17" class="i">+                    Column {
</a><a href="#h104-1-18" id="h104-1-18" class="i">+                        name: &quot;value&quot;,
</a><a href="#h104-1-19" id="h104-1-19" class="i">+                        datatype: String,
</a><a href="#h104-1-20" id="h104-1-20" class="i">+                        primary_key: false,
</a><a href="#h104-1-21" id="h104-1-21" class="i">+                        nullable: true,
</a><a href="#h104-1-22" id="h104-1-22" class="i">+                        default: Some(
</a><a href="#h104-1-23" id="h104-1-23" class="i">+                            Null,
</a><a href="#h104-1-24" id="h104-1-24" class="i">+                        ),
</a><a href="#h104-1-25" id="h104-1-25" class="i">+                        unique: false,
</a><a href="#h104-1-26" id="h104-1-26" class="i">+                        references: None,
</a><a href="#h104-1-27" id="h104-1-27" class="i">+                        index: false,
</a><a href="#h104-1-28" id="h104-1-28" class="i">+                    },
</a><a href="#h104-1-29" id="h104-1-29" class="i">+                ],
</a><a href="#h104-1-30" id="h104-1-30" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h105" href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a> b/<a href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a></b>
<a href="#h105-0" id="h105-0" class="h">@@ -51,7 +51,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h105-0-3" id="h105-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h105-0-4" id="h105-0-4" class="i">+            table: Table {
</a><a href="#h105-0-5" id="h105-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h105-0-6" id="h105-0-6" class="i">+                columns: [
</a><a href="#h105-0-7" id="h105-0-7" class="i">+                    Column {
</a><a href="#h105-0-8" id="h105-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h105-0-9" id="h105-0-9" class="i">+                        datatype: Integer,
</a><a href="#h105-0-10" id="h105-0-10" class="i">+                        primary_key: true,
</a><a href="#h105-0-11" id="h105-0-11" class="i">+                        nullable: false,
</a><a href="#h105-0-12" id="h105-0-12" class="i">+                        default: None,
</a><a href="#h105-0-13" id="h105-0-13" class="i">+                        unique: true,
</a><a href="#h105-0-14" id="h105-0-14" class="i">+                        references: None,
</a><a href="#h105-0-15" id="h105-0-15" class="i">+                        index: false,
</a><a href="#h105-0-16" id="h105-0-16" class="i">+                    },
</a><a href="#h105-0-17" id="h105-0-17" class="i">+                    Column {
</a><a href="#h105-0-18" id="h105-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h105-0-19" id="h105-0-19" class="i">+                        datatype: String,
</a><a href="#h105-0-20" id="h105-0-20" class="i">+                        primary_key: false,
</a><a href="#h105-0-21" id="h105-0-21" class="i">+                        nullable: false,
</a><a href="#h105-0-22" id="h105-0-22" class="i">+                        default: None,
</a><a href="#h105-0-23" id="h105-0-23" class="i">+                        unique: false,
</a><a href="#h105-0-24" id="h105-0-24" class="i">+                        references: None,
</a><a href="#h105-0-25" id="h105-0-25" class="i">+                        index: false,
</a><a href="#h105-0-26" id="h105-0-26" class="i">+                    },
</a><a href="#h105-0-27" id="h105-0-27" class="i">+                    Column {
</a><a href="#h105-0-28" id="h105-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h105-0-29" id="h105-0-29" class="i">+                        datatype: Integer,
</a><a href="#h105-0-30" id="h105-0-30" class="i">+                        primary_key: false,
</a><a href="#h105-0-31" id="h105-0-31" class="i">+                        nullable: false,
</a><a href="#h105-0-32" id="h105-0-32" class="i">+                        default: None,
</a><a href="#h105-0-33" id="h105-0-33" class="i">+                        unique: false,
</a><a href="#h105-0-34" id="h105-0-34" class="i">+                        references: Some(
</a><a href="#h105-0-35" id="h105-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h105-0-36" id="h105-0-36" class="i">+                        ),
</a><a href="#h105-0-37" id="h105-0-37" class="i">+                        index: true,
</a><a href="#h105-0-38" id="h105-0-38" class="i">+                    },
</a><a href="#h105-0-39" id="h105-0-39" class="i">+                    Column {
</a><a href="#h105-0-40" id="h105-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h105-0-41" id="h105-0-41" class="i">+                        datatype: Integer,
</a><a href="#h105-0-42" id="h105-0-42" class="i">+                        primary_key: false,
</a><a href="#h105-0-43" id="h105-0-43" class="i">+                        nullable: false,
</a><a href="#h105-0-44" id="h105-0-44" class="i">+                        default: None,
</a><a href="#h105-0-45" id="h105-0-45" class="i">+                        unique: false,
</a><a href="#h105-0-46" id="h105-0-46" class="i">+                        references: Some(
</a><a href="#h105-0-47" id="h105-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h105-0-48" id="h105-0-48" class="i">+                        ),
</a><a href="#h105-0-49" id="h105-0-49" class="i">+                        index: true,
</a><a href="#h105-0-50" id="h105-0-50" class="i">+                    },
</a><a href="#h105-0-51" id="h105-0-51" class="i">+                    Column {
</a><a href="#h105-0-52" id="h105-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h105-0-53" id="h105-0-53" class="i">+                        datatype: Integer,
</a><a href="#h105-0-54" id="h105-0-54" class="i">+                        primary_key: false,
</a><a href="#h105-0-55" id="h105-0-55" class="i">+                        nullable: false,
</a><a href="#h105-0-56" id="h105-0-56" class="i">+                        default: None,
</a><a href="#h105-0-57" id="h105-0-57" class="i">+                        unique: false,
</a><a href="#h105-0-58" id="h105-0-58" class="i">+                        references: None,
</a><a href="#h105-0-59" id="h105-0-59" class="i">+                        index: false,
</a><a href="#h105-0-60" id="h105-0-60" class="i">+                    },
</a><a href="#h105-0-61" id="h105-0-61" class="i">+                    Column {
</a><a href="#h105-0-62" id="h105-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h105-0-63" id="h105-0-63" class="i">+                        datatype: Float,
</a><a href="#h105-0-64" id="h105-0-64" class="i">+                        primary_key: false,
</a><a href="#h105-0-65" id="h105-0-65" class="i">+                        nullable: true,
</a><a href="#h105-0-66" id="h105-0-66" class="i">+                        default: Some(
</a><a href="#h105-0-67" id="h105-0-67" class="i">+                            Null,
</a><a href="#h105-0-68" id="h105-0-68" class="i">+                        ),
</a><a href="#h105-0-69" id="h105-0-69" class="i">+                        unique: false,
</a><a href="#h105-0-70" id="h105-0-70" class="i">+                        references: None,
</a><a href="#h105-0-71" id="h105-0-71" class="i">+                        index: false,
</a><a href="#h105-0-72" id="h105-0-72" class="i">+                    },
</a><a href="#h105-0-73" id="h105-0-73" class="i">+                    Column {
</a><a href="#h105-0-74" id="h105-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h105-0-75" id="h105-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h105-0-76" id="h105-0-76" class="i">+                        primary_key: false,
</a><a href="#h105-0-77" id="h105-0-77" class="i">+                        nullable: true,
</a><a href="#h105-0-78" id="h105-0-78" class="i">+                        default: Some(
</a><a href="#h105-0-79" id="h105-0-79" class="i">+                            Null,
</a><a href="#h105-0-80" id="h105-0-80" class="i">+                        ),
</a><a href="#h105-0-81" id="h105-0-81" class="i">+                        unique: false,
</a><a href="#h105-0-82" id="h105-0-82" class="i">+                        references: None,
</a><a href="#h105-0-83" id="h105-0-83" class="i">+                        index: false,
</a><a href="#h105-0-84" id="h105-0-84" class="i">+                    },
</a><a href="#h105-0-85" id="h105-0-85" class="i">+                ],
</a><a href="#h105-0-86" id="h105-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h105-1" id="h105-1" class="h">@@ -105,7 +187,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     Scan {
<a href="#h105-1-3" id="h105-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h105-1-4" id="h105-1-4" class="i">+        table: Table {
</a><a href="#h105-1-5" id="h105-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h105-1-6" id="h105-1-6" class="i">+            columns: [
</a><a href="#h105-1-7" id="h105-1-7" class="i">+                Column {
</a><a href="#h105-1-8" id="h105-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h105-1-9" id="h105-1-9" class="i">+                    datatype: Integer,
</a><a href="#h105-1-10" id="h105-1-10" class="i">+                    primary_key: true,
</a><a href="#h105-1-11" id="h105-1-11" class="i">+                    nullable: false,
</a><a href="#h105-1-12" id="h105-1-12" class="i">+                    default: None,
</a><a href="#h105-1-13" id="h105-1-13" class="i">+                    unique: true,
</a><a href="#h105-1-14" id="h105-1-14" class="i">+                    references: None,
</a><a href="#h105-1-15" id="h105-1-15" class="i">+                    index: false,
</a><a href="#h105-1-16" id="h105-1-16" class="i">+                },
</a><a href="#h105-1-17" id="h105-1-17" class="i">+                Column {
</a><a href="#h105-1-18" id="h105-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h105-1-19" id="h105-1-19" class="i">+                    datatype: String,
</a><a href="#h105-1-20" id="h105-1-20" class="i">+                    primary_key: false,
</a><a href="#h105-1-21" id="h105-1-21" class="i">+                    nullable: false,
</a><a href="#h105-1-22" id="h105-1-22" class="i">+                    default: None,
</a><a href="#h105-1-23" id="h105-1-23" class="i">+                    unique: false,
</a><a href="#h105-1-24" id="h105-1-24" class="i">+                    references: None,
</a><a href="#h105-1-25" id="h105-1-25" class="i">+                    index: false,
</a><a href="#h105-1-26" id="h105-1-26" class="i">+                },
</a><a href="#h105-1-27" id="h105-1-27" class="i">+                Column {
</a><a href="#h105-1-28" id="h105-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h105-1-29" id="h105-1-29" class="i">+                    datatype: Integer,
</a><a href="#h105-1-30" id="h105-1-30" class="i">+                    primary_key: false,
</a><a href="#h105-1-31" id="h105-1-31" class="i">+                    nullable: false,
</a><a href="#h105-1-32" id="h105-1-32" class="i">+                    default: None,
</a><a href="#h105-1-33" id="h105-1-33" class="i">+                    unique: false,
</a><a href="#h105-1-34" id="h105-1-34" class="i">+                    references: Some(
</a><a href="#h105-1-35" id="h105-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h105-1-36" id="h105-1-36" class="i">+                    ),
</a><a href="#h105-1-37" id="h105-1-37" class="i">+                    index: true,
</a><a href="#h105-1-38" id="h105-1-38" class="i">+                },
</a><a href="#h105-1-39" id="h105-1-39" class="i">+                Column {
</a><a href="#h105-1-40" id="h105-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h105-1-41" id="h105-1-41" class="i">+                    datatype: Integer,
</a><a href="#h105-1-42" id="h105-1-42" class="i">+                    primary_key: false,
</a><a href="#h105-1-43" id="h105-1-43" class="i">+                    nullable: false,
</a><a href="#h105-1-44" id="h105-1-44" class="i">+                    default: None,
</a><a href="#h105-1-45" id="h105-1-45" class="i">+                    unique: false,
</a><a href="#h105-1-46" id="h105-1-46" class="i">+                    references: Some(
</a><a href="#h105-1-47" id="h105-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h105-1-48" id="h105-1-48" class="i">+                    ),
</a><a href="#h105-1-49" id="h105-1-49" class="i">+                    index: true,
</a><a href="#h105-1-50" id="h105-1-50" class="i">+                },
</a><a href="#h105-1-51" id="h105-1-51" class="i">+                Column {
</a><a href="#h105-1-52" id="h105-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h105-1-53" id="h105-1-53" class="i">+                    datatype: Integer,
</a><a href="#h105-1-54" id="h105-1-54" class="i">+                    primary_key: false,
</a><a href="#h105-1-55" id="h105-1-55" class="i">+                    nullable: false,
</a><a href="#h105-1-56" id="h105-1-56" class="i">+                    default: None,
</a><a href="#h105-1-57" id="h105-1-57" class="i">+                    unique: false,
</a><a href="#h105-1-58" id="h105-1-58" class="i">+                    references: None,
</a><a href="#h105-1-59" id="h105-1-59" class="i">+                    index: false,
</a><a href="#h105-1-60" id="h105-1-60" class="i">+                },
</a><a href="#h105-1-61" id="h105-1-61" class="i">+                Column {
</a><a href="#h105-1-62" id="h105-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h105-1-63" id="h105-1-63" class="i">+                    datatype: Float,
</a><a href="#h105-1-64" id="h105-1-64" class="i">+                    primary_key: false,
</a><a href="#h105-1-65" id="h105-1-65" class="i">+                    nullable: true,
</a><a href="#h105-1-66" id="h105-1-66" class="i">+                    default: Some(
</a><a href="#h105-1-67" id="h105-1-67" class="i">+                        Null,
</a><a href="#h105-1-68" id="h105-1-68" class="i">+                    ),
</a><a href="#h105-1-69" id="h105-1-69" class="i">+                    unique: false,
</a><a href="#h105-1-70" id="h105-1-70" class="i">+                    references: None,
</a><a href="#h105-1-71" id="h105-1-71" class="i">+                    index: false,
</a><a href="#h105-1-72" id="h105-1-72" class="i">+                },
</a><a href="#h105-1-73" id="h105-1-73" class="i">+                Column {
</a><a href="#h105-1-74" id="h105-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h105-1-75" id="h105-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h105-1-76" id="h105-1-76" class="i">+                    primary_key: false,
</a><a href="#h105-1-77" id="h105-1-77" class="i">+                    nullable: true,
</a><a href="#h105-1-78" id="h105-1-78" class="i">+                    default: Some(
</a><a href="#h105-1-79" id="h105-1-79" class="i">+                        Null,
</a><a href="#h105-1-80" id="h105-1-80" class="i">+                    ),
</a><a href="#h105-1-81" id="h105-1-81" class="i">+                    unique: false,
</a><a href="#h105-1-82" id="h105-1-82" class="i">+                    references: None,
</a><a href="#h105-1-83" id="h105-1-83" class="i">+                    index: false,
</a><a href="#h105-1-84" id="h105-1-84" class="i">+                },
</a><a href="#h105-1-85" id="h105-1-85" class="i">+            ],
</a><a href="#h105-1-86" id="h105-1-86" class="i">+        },
</a>         alias: None,
         filter: Some(
             And(
<b>diff --git a/<a id="h106" href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a> b/<a href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a></b>
<a href="#h106-0" id="h106-0" class="h">@@ -30,7 +30,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h106-0-3" id="h106-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h106-0-4" id="h106-0-4" class="i">+            table: Table {
</a><a href="#h106-0-5" id="h106-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h106-0-6" id="h106-0-6" class="i">+                columns: [
</a><a href="#h106-0-7" id="h106-0-7" class="i">+                    Column {
</a><a href="#h106-0-8" id="h106-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h106-0-9" id="h106-0-9" class="i">+                        datatype: Integer,
</a><a href="#h106-0-10" id="h106-0-10" class="i">+                        primary_key: true,
</a><a href="#h106-0-11" id="h106-0-11" class="i">+                        nullable: false,
</a><a href="#h106-0-12" id="h106-0-12" class="i">+                        default: None,
</a><a href="#h106-0-13" id="h106-0-13" class="i">+                        unique: true,
</a><a href="#h106-0-14" id="h106-0-14" class="i">+                        references: None,
</a><a href="#h106-0-15" id="h106-0-15" class="i">+                        index: false,
</a><a href="#h106-0-16" id="h106-0-16" class="i">+                    },
</a><a href="#h106-0-17" id="h106-0-17" class="i">+                    Column {
</a><a href="#h106-0-18" id="h106-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h106-0-19" id="h106-0-19" class="i">+                        datatype: String,
</a><a href="#h106-0-20" id="h106-0-20" class="i">+                        primary_key: false,
</a><a href="#h106-0-21" id="h106-0-21" class="i">+                        nullable: false,
</a><a href="#h106-0-22" id="h106-0-22" class="i">+                        default: None,
</a><a href="#h106-0-23" id="h106-0-23" class="i">+                        unique: false,
</a><a href="#h106-0-24" id="h106-0-24" class="i">+                        references: None,
</a><a href="#h106-0-25" id="h106-0-25" class="i">+                        index: false,
</a><a href="#h106-0-26" id="h106-0-26" class="i">+                    },
</a><a href="#h106-0-27" id="h106-0-27" class="i">+                    Column {
</a><a href="#h106-0-28" id="h106-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h106-0-29" id="h106-0-29" class="i">+                        datatype: Integer,
</a><a href="#h106-0-30" id="h106-0-30" class="i">+                        primary_key: false,
</a><a href="#h106-0-31" id="h106-0-31" class="i">+                        nullable: false,
</a><a href="#h106-0-32" id="h106-0-32" class="i">+                        default: None,
</a><a href="#h106-0-33" id="h106-0-33" class="i">+                        unique: false,
</a><a href="#h106-0-34" id="h106-0-34" class="i">+                        references: Some(
</a><a href="#h106-0-35" id="h106-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h106-0-36" id="h106-0-36" class="i">+                        ),
</a><a href="#h106-0-37" id="h106-0-37" class="i">+                        index: true,
</a><a href="#h106-0-38" id="h106-0-38" class="i">+                    },
</a><a href="#h106-0-39" id="h106-0-39" class="i">+                    Column {
</a><a href="#h106-0-40" id="h106-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h106-0-41" id="h106-0-41" class="i">+                        datatype: Integer,
</a><a href="#h106-0-42" id="h106-0-42" class="i">+                        primary_key: false,
</a><a href="#h106-0-43" id="h106-0-43" class="i">+                        nullable: false,
</a><a href="#h106-0-44" id="h106-0-44" class="i">+                        default: None,
</a><a href="#h106-0-45" id="h106-0-45" class="i">+                        unique: false,
</a><a href="#h106-0-46" id="h106-0-46" class="i">+                        references: Some(
</a><a href="#h106-0-47" id="h106-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h106-0-48" id="h106-0-48" class="i">+                        ),
</a><a href="#h106-0-49" id="h106-0-49" class="i">+                        index: true,
</a><a href="#h106-0-50" id="h106-0-50" class="i">+                    },
</a><a href="#h106-0-51" id="h106-0-51" class="i">+                    Column {
</a><a href="#h106-0-52" id="h106-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h106-0-53" id="h106-0-53" class="i">+                        datatype: Integer,
</a><a href="#h106-0-54" id="h106-0-54" class="i">+                        primary_key: false,
</a><a href="#h106-0-55" id="h106-0-55" class="i">+                        nullable: false,
</a><a href="#h106-0-56" id="h106-0-56" class="i">+                        default: None,
</a><a href="#h106-0-57" id="h106-0-57" class="i">+                        unique: false,
</a><a href="#h106-0-58" id="h106-0-58" class="i">+                        references: None,
</a><a href="#h106-0-59" id="h106-0-59" class="i">+                        index: false,
</a><a href="#h106-0-60" id="h106-0-60" class="i">+                    },
</a><a href="#h106-0-61" id="h106-0-61" class="i">+                    Column {
</a><a href="#h106-0-62" id="h106-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h106-0-63" id="h106-0-63" class="i">+                        datatype: Float,
</a><a href="#h106-0-64" id="h106-0-64" class="i">+                        primary_key: false,
</a><a href="#h106-0-65" id="h106-0-65" class="i">+                        nullable: true,
</a><a href="#h106-0-66" id="h106-0-66" class="i">+                        default: Some(
</a><a href="#h106-0-67" id="h106-0-67" class="i">+                            Null,
</a><a href="#h106-0-68" id="h106-0-68" class="i">+                        ),
</a><a href="#h106-0-69" id="h106-0-69" class="i">+                        unique: false,
</a><a href="#h106-0-70" id="h106-0-70" class="i">+                        references: None,
</a><a href="#h106-0-71" id="h106-0-71" class="i">+                        index: false,
</a><a href="#h106-0-72" id="h106-0-72" class="i">+                    },
</a><a href="#h106-0-73" id="h106-0-73" class="i">+                    Column {
</a><a href="#h106-0-74" id="h106-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h106-0-75" id="h106-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h106-0-76" id="h106-0-76" class="i">+                        primary_key: false,
</a><a href="#h106-0-77" id="h106-0-77" class="i">+                        nullable: true,
</a><a href="#h106-0-78" id="h106-0-78" class="i">+                        default: Some(
</a><a href="#h106-0-79" id="h106-0-79" class="i">+                            Null,
</a><a href="#h106-0-80" id="h106-0-80" class="i">+                        ),
</a><a href="#h106-0-81" id="h106-0-81" class="i">+                        unique: false,
</a><a href="#h106-0-82" id="h106-0-82" class="i">+                        references: None,
</a><a href="#h106-0-83" id="h106-0-83" class="i">+                        index: false,
</a><a href="#h106-0-84" id="h106-0-84" class="i">+                    },
</a><a href="#h106-0-85" id="h106-0-85" class="i">+                ],
</a><a href="#h106-0-86" id="h106-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h106-1" id="h106-1" class="h">@@ -44,7 +126,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     Scan {
<a href="#h106-1-3" id="h106-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h106-1-4" id="h106-1-4" class="i">+        table: Table {
</a><a href="#h106-1-5" id="h106-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h106-1-6" id="h106-1-6" class="i">+            columns: [
</a><a href="#h106-1-7" id="h106-1-7" class="i">+                Column {
</a><a href="#h106-1-8" id="h106-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h106-1-9" id="h106-1-9" class="i">+                    datatype: Integer,
</a><a href="#h106-1-10" id="h106-1-10" class="i">+                    primary_key: true,
</a><a href="#h106-1-11" id="h106-1-11" class="i">+                    nullable: false,
</a><a href="#h106-1-12" id="h106-1-12" class="i">+                    default: None,
</a><a href="#h106-1-13" id="h106-1-13" class="i">+                    unique: true,
</a><a href="#h106-1-14" id="h106-1-14" class="i">+                    references: None,
</a><a href="#h106-1-15" id="h106-1-15" class="i">+                    index: false,
</a><a href="#h106-1-16" id="h106-1-16" class="i">+                },
</a><a href="#h106-1-17" id="h106-1-17" class="i">+                Column {
</a><a href="#h106-1-18" id="h106-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h106-1-19" id="h106-1-19" class="i">+                    datatype: String,
</a><a href="#h106-1-20" id="h106-1-20" class="i">+                    primary_key: false,
</a><a href="#h106-1-21" id="h106-1-21" class="i">+                    nullable: false,
</a><a href="#h106-1-22" id="h106-1-22" class="i">+                    default: None,
</a><a href="#h106-1-23" id="h106-1-23" class="i">+                    unique: false,
</a><a href="#h106-1-24" id="h106-1-24" class="i">+                    references: None,
</a><a href="#h106-1-25" id="h106-1-25" class="i">+                    index: false,
</a><a href="#h106-1-26" id="h106-1-26" class="i">+                },
</a><a href="#h106-1-27" id="h106-1-27" class="i">+                Column {
</a><a href="#h106-1-28" id="h106-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h106-1-29" id="h106-1-29" class="i">+                    datatype: Integer,
</a><a href="#h106-1-30" id="h106-1-30" class="i">+                    primary_key: false,
</a><a href="#h106-1-31" id="h106-1-31" class="i">+                    nullable: false,
</a><a href="#h106-1-32" id="h106-1-32" class="i">+                    default: None,
</a><a href="#h106-1-33" id="h106-1-33" class="i">+                    unique: false,
</a><a href="#h106-1-34" id="h106-1-34" class="i">+                    references: Some(
</a><a href="#h106-1-35" id="h106-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h106-1-36" id="h106-1-36" class="i">+                    ),
</a><a href="#h106-1-37" id="h106-1-37" class="i">+                    index: true,
</a><a href="#h106-1-38" id="h106-1-38" class="i">+                },
</a><a href="#h106-1-39" id="h106-1-39" class="i">+                Column {
</a><a href="#h106-1-40" id="h106-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h106-1-41" id="h106-1-41" class="i">+                    datatype: Integer,
</a><a href="#h106-1-42" id="h106-1-42" class="i">+                    primary_key: false,
</a><a href="#h106-1-43" id="h106-1-43" class="i">+                    nullable: false,
</a><a href="#h106-1-44" id="h106-1-44" class="i">+                    default: None,
</a><a href="#h106-1-45" id="h106-1-45" class="i">+                    unique: false,
</a><a href="#h106-1-46" id="h106-1-46" class="i">+                    references: Some(
</a><a href="#h106-1-47" id="h106-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h106-1-48" id="h106-1-48" class="i">+                    ),
</a><a href="#h106-1-49" id="h106-1-49" class="i">+                    index: true,
</a><a href="#h106-1-50" id="h106-1-50" class="i">+                },
</a><a href="#h106-1-51" id="h106-1-51" class="i">+                Column {
</a><a href="#h106-1-52" id="h106-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h106-1-53" id="h106-1-53" class="i">+                    datatype: Integer,
</a><a href="#h106-1-54" id="h106-1-54" class="i">+                    primary_key: false,
</a><a href="#h106-1-55" id="h106-1-55" class="i">+                    nullable: false,
</a><a href="#h106-1-56" id="h106-1-56" class="i">+                    default: None,
</a><a href="#h106-1-57" id="h106-1-57" class="i">+                    unique: false,
</a><a href="#h106-1-58" id="h106-1-58" class="i">+                    references: None,
</a><a href="#h106-1-59" id="h106-1-59" class="i">+                    index: false,
</a><a href="#h106-1-60" id="h106-1-60" class="i">+                },
</a><a href="#h106-1-61" id="h106-1-61" class="i">+                Column {
</a><a href="#h106-1-62" id="h106-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h106-1-63" id="h106-1-63" class="i">+                    datatype: Float,
</a><a href="#h106-1-64" id="h106-1-64" class="i">+                    primary_key: false,
</a><a href="#h106-1-65" id="h106-1-65" class="i">+                    nullable: true,
</a><a href="#h106-1-66" id="h106-1-66" class="i">+                    default: Some(
</a><a href="#h106-1-67" id="h106-1-67" class="i">+                        Null,
</a><a href="#h106-1-68" id="h106-1-68" class="i">+                    ),
</a><a href="#h106-1-69" id="h106-1-69" class="i">+                    unique: false,
</a><a href="#h106-1-70" id="h106-1-70" class="i">+                    references: None,
</a><a href="#h106-1-71" id="h106-1-71" class="i">+                    index: false,
</a><a href="#h106-1-72" id="h106-1-72" class="i">+                },
</a><a href="#h106-1-73" id="h106-1-73" class="i">+                Column {
</a><a href="#h106-1-74" id="h106-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h106-1-75" id="h106-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h106-1-76" id="h106-1-76" class="i">+                    primary_key: false,
</a><a href="#h106-1-77" id="h106-1-77" class="i">+                    nullable: true,
</a><a href="#h106-1-78" id="h106-1-78" class="i">+                    default: Some(
</a><a href="#h106-1-79" id="h106-1-79" class="i">+                        Null,
</a><a href="#h106-1-80" id="h106-1-80" class="i">+                    ),
</a><a href="#h106-1-81" id="h106-1-81" class="i">+                    unique: false,
</a><a href="#h106-1-82" id="h106-1-82" class="i">+                    references: None,
</a><a href="#h106-1-83" id="h106-1-83" class="i">+                    index: false,
</a><a href="#h106-1-84" id="h106-1-84" class="i">+                },
</a><a href="#h106-1-85" id="h106-1-85" class="i">+            ],
</a><a href="#h106-1-86" id="h106-1-86" class="i">+        },
</a>         alias: None,
         filter: Some(
             Constant(
<b>diff --git a/<a id="h107" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h107-0" id="h107-0" class="h">@@ -99,7 +99,89 @@ Plan: Select(
</a>         source: Filter {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h107-0-3" id="h107-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h107-0-4" id="h107-0-4" class="i">+                    table: Table {
</a><a href="#h107-0-5" id="h107-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h107-0-6" id="h107-0-6" class="i">+                        columns: [
</a><a href="#h107-0-7" id="h107-0-7" class="i">+                            Column {
</a><a href="#h107-0-8" id="h107-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h107-0-9" id="h107-0-9" class="i">+                                datatype: Integer,
</a><a href="#h107-0-10" id="h107-0-10" class="i">+                                primary_key: true,
</a><a href="#h107-0-11" id="h107-0-11" class="i">+                                nullable: false,
</a><a href="#h107-0-12" id="h107-0-12" class="i">+                                default: None,
</a><a href="#h107-0-13" id="h107-0-13" class="i">+                                unique: true,
</a><a href="#h107-0-14" id="h107-0-14" class="i">+                                references: None,
</a><a href="#h107-0-15" id="h107-0-15" class="i">+                                index: false,
</a><a href="#h107-0-16" id="h107-0-16" class="i">+                            },
</a><a href="#h107-0-17" id="h107-0-17" class="i">+                            Column {
</a><a href="#h107-0-18" id="h107-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h107-0-19" id="h107-0-19" class="i">+                                datatype: String,
</a><a href="#h107-0-20" id="h107-0-20" class="i">+                                primary_key: false,
</a><a href="#h107-0-21" id="h107-0-21" class="i">+                                nullable: false,
</a><a href="#h107-0-22" id="h107-0-22" class="i">+                                default: None,
</a><a href="#h107-0-23" id="h107-0-23" class="i">+                                unique: false,
</a><a href="#h107-0-24" id="h107-0-24" class="i">+                                references: None,
</a><a href="#h107-0-25" id="h107-0-25" class="i">+                                index: false,
</a><a href="#h107-0-26" id="h107-0-26" class="i">+                            },
</a><a href="#h107-0-27" id="h107-0-27" class="i">+                            Column {
</a><a href="#h107-0-28" id="h107-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h107-0-29" id="h107-0-29" class="i">+                                datatype: Integer,
</a><a href="#h107-0-30" id="h107-0-30" class="i">+                                primary_key: false,
</a><a href="#h107-0-31" id="h107-0-31" class="i">+                                nullable: false,
</a><a href="#h107-0-32" id="h107-0-32" class="i">+                                default: None,
</a><a href="#h107-0-33" id="h107-0-33" class="i">+                                unique: false,
</a><a href="#h107-0-34" id="h107-0-34" class="i">+                                references: Some(
</a><a href="#h107-0-35" id="h107-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h107-0-36" id="h107-0-36" class="i">+                                ),
</a><a href="#h107-0-37" id="h107-0-37" class="i">+                                index: true,
</a><a href="#h107-0-38" id="h107-0-38" class="i">+                            },
</a><a href="#h107-0-39" id="h107-0-39" class="i">+                            Column {
</a><a href="#h107-0-40" id="h107-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h107-0-41" id="h107-0-41" class="i">+                                datatype: Integer,
</a><a href="#h107-0-42" id="h107-0-42" class="i">+                                primary_key: false,
</a><a href="#h107-0-43" id="h107-0-43" class="i">+                                nullable: false,
</a><a href="#h107-0-44" id="h107-0-44" class="i">+                                default: None,
</a><a href="#h107-0-45" id="h107-0-45" class="i">+                                unique: false,
</a><a href="#h107-0-46" id="h107-0-46" class="i">+                                references: Some(
</a><a href="#h107-0-47" id="h107-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h107-0-48" id="h107-0-48" class="i">+                                ),
</a><a href="#h107-0-49" id="h107-0-49" class="i">+                                index: true,
</a><a href="#h107-0-50" id="h107-0-50" class="i">+                            },
</a><a href="#h107-0-51" id="h107-0-51" class="i">+                            Column {
</a><a href="#h107-0-52" id="h107-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h107-0-53" id="h107-0-53" class="i">+                                datatype: Integer,
</a><a href="#h107-0-54" id="h107-0-54" class="i">+                                primary_key: false,
</a><a href="#h107-0-55" id="h107-0-55" class="i">+                                nullable: false,
</a><a href="#h107-0-56" id="h107-0-56" class="i">+                                default: None,
</a><a href="#h107-0-57" id="h107-0-57" class="i">+                                unique: false,
</a><a href="#h107-0-58" id="h107-0-58" class="i">+                                references: None,
</a><a href="#h107-0-59" id="h107-0-59" class="i">+                                index: false,
</a><a href="#h107-0-60" id="h107-0-60" class="i">+                            },
</a><a href="#h107-0-61" id="h107-0-61" class="i">+                            Column {
</a><a href="#h107-0-62" id="h107-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h107-0-63" id="h107-0-63" class="i">+                                datatype: Float,
</a><a href="#h107-0-64" id="h107-0-64" class="i">+                                primary_key: false,
</a><a href="#h107-0-65" id="h107-0-65" class="i">+                                nullable: true,
</a><a href="#h107-0-66" id="h107-0-66" class="i">+                                default: Some(
</a><a href="#h107-0-67" id="h107-0-67" class="i">+                                    Null,
</a><a href="#h107-0-68" id="h107-0-68" class="i">+                                ),
</a><a href="#h107-0-69" id="h107-0-69" class="i">+                                unique: false,
</a><a href="#h107-0-70" id="h107-0-70" class="i">+                                references: None,
</a><a href="#h107-0-71" id="h107-0-71" class="i">+                                index: false,
</a><a href="#h107-0-72" id="h107-0-72" class="i">+                            },
</a><a href="#h107-0-73" id="h107-0-73" class="i">+                            Column {
</a><a href="#h107-0-74" id="h107-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h107-0-75" id="h107-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h107-0-76" id="h107-0-76" class="i">+                                primary_key: false,
</a><a href="#h107-0-77" id="h107-0-77" class="i">+                                nullable: true,
</a><a href="#h107-0-78" id="h107-0-78" class="i">+                                default: Some(
</a><a href="#h107-0-79" id="h107-0-79" class="i">+                                    Null,
</a><a href="#h107-0-80" id="h107-0-80" class="i">+                                ),
</a><a href="#h107-0-81" id="h107-0-81" class="i">+                                unique: false,
</a><a href="#h107-0-82" id="h107-0-82" class="i">+                                references: None,
</a><a href="#h107-0-83" id="h107-0-83" class="i">+                                index: false,
</a><a href="#h107-0-84" id="h107-0-84" class="i">+                            },
</a><a href="#h107-0-85" id="h107-0-85" class="i">+                        ],
</a><a href="#h107-0-86" id="h107-0-86" class="i">+                    },
</a>                     alias: Some(
                         &quot;m&quot;,
                     ),
<a href="#h107-1" id="h107-1" class="h">@@ -107,7 +189,31 @@ Plan: Select(
</a>                 },
                 left_size: 7,
                 right: Scan {
<a href="#h107-1-3" id="h107-1-3" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h107-1-4" id="h107-1-4" class="i">+                    table: Table {
</a><a href="#h107-1-5" id="h107-1-5" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h107-1-6" id="h107-1-6" class="i">+                        columns: [
</a><a href="#h107-1-7" id="h107-1-7" class="i">+                            Column {
</a><a href="#h107-1-8" id="h107-1-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h107-1-9" id="h107-1-9" class="i">+                                datatype: Integer,
</a><a href="#h107-1-10" id="h107-1-10" class="i">+                                primary_key: true,
</a><a href="#h107-1-11" id="h107-1-11" class="i">+                                nullable: false,
</a><a href="#h107-1-12" id="h107-1-12" class="i">+                                default: None,
</a><a href="#h107-1-13" id="h107-1-13" class="i">+                                unique: true,
</a><a href="#h107-1-14" id="h107-1-14" class="i">+                                references: None,
</a><a href="#h107-1-15" id="h107-1-15" class="i">+                                index: false,
</a><a href="#h107-1-16" id="h107-1-16" class="i">+                            },
</a><a href="#h107-1-17" id="h107-1-17" class="i">+                            Column {
</a><a href="#h107-1-18" id="h107-1-18" class="i">+                                name: &quot;name&quot;,
</a><a href="#h107-1-19" id="h107-1-19" class="i">+                                datatype: String,
</a><a href="#h107-1-20" id="h107-1-20" class="i">+                                primary_key: false,
</a><a href="#h107-1-21" id="h107-1-21" class="i">+                                nullable: false,
</a><a href="#h107-1-22" id="h107-1-22" class="i">+                                default: None,
</a><a href="#h107-1-23" id="h107-1-23" class="i">+                                unique: false,
</a><a href="#h107-1-24" id="h107-1-24" class="i">+                                references: None,
</a><a href="#h107-1-25" id="h107-1-25" class="i">+                                index: false,
</a><a href="#h107-1-26" id="h107-1-26" class="i">+                            },
</a><a href="#h107-1-27" id="h107-1-27" class="i">+                        ],
</a><a href="#h107-1-28" id="h107-1-28" class="i">+                    },
</a>                     alias: Some(
                         &quot;g&quot;,
                     ),
<a href="#h107-2" id="h107-2" class="h">@@ -212,7 +318,89 @@ Optimized plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h107-2-3" id="h107-2-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h107-2-4" id="h107-2-4" class="i">+                table: Table {
</a><a href="#h107-2-5" id="h107-2-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h107-2-6" id="h107-2-6" class="i">+                    columns: [
</a><a href="#h107-2-7" id="h107-2-7" class="i">+                        Column {
</a><a href="#h107-2-8" id="h107-2-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h107-2-9" id="h107-2-9" class="i">+                            datatype: Integer,
</a><a href="#h107-2-10" id="h107-2-10" class="i">+                            primary_key: true,
</a><a href="#h107-2-11" id="h107-2-11" class="i">+                            nullable: false,
</a><a href="#h107-2-12" id="h107-2-12" class="i">+                            default: None,
</a><a href="#h107-2-13" id="h107-2-13" class="i">+                            unique: true,
</a><a href="#h107-2-14" id="h107-2-14" class="i">+                            references: None,
</a><a href="#h107-2-15" id="h107-2-15" class="i">+                            index: false,
</a><a href="#h107-2-16" id="h107-2-16" class="i">+                        },
</a><a href="#h107-2-17" id="h107-2-17" class="i">+                        Column {
</a><a href="#h107-2-18" id="h107-2-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h107-2-19" id="h107-2-19" class="i">+                            datatype: String,
</a><a href="#h107-2-20" id="h107-2-20" class="i">+                            primary_key: false,
</a><a href="#h107-2-21" id="h107-2-21" class="i">+                            nullable: false,
</a><a href="#h107-2-22" id="h107-2-22" class="i">+                            default: None,
</a><a href="#h107-2-23" id="h107-2-23" class="i">+                            unique: false,
</a><a href="#h107-2-24" id="h107-2-24" class="i">+                            references: None,
</a><a href="#h107-2-25" id="h107-2-25" class="i">+                            index: false,
</a><a href="#h107-2-26" id="h107-2-26" class="i">+                        },
</a><a href="#h107-2-27" id="h107-2-27" class="i">+                        Column {
</a><a href="#h107-2-28" id="h107-2-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h107-2-29" id="h107-2-29" class="i">+                            datatype: Integer,
</a><a href="#h107-2-30" id="h107-2-30" class="i">+                            primary_key: false,
</a><a href="#h107-2-31" id="h107-2-31" class="i">+                            nullable: false,
</a><a href="#h107-2-32" id="h107-2-32" class="i">+                            default: None,
</a><a href="#h107-2-33" id="h107-2-33" class="i">+                            unique: false,
</a><a href="#h107-2-34" id="h107-2-34" class="i">+                            references: Some(
</a><a href="#h107-2-35" id="h107-2-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h107-2-36" id="h107-2-36" class="i">+                            ),
</a><a href="#h107-2-37" id="h107-2-37" class="i">+                            index: true,
</a><a href="#h107-2-38" id="h107-2-38" class="i">+                        },
</a><a href="#h107-2-39" id="h107-2-39" class="i">+                        Column {
</a><a href="#h107-2-40" id="h107-2-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h107-2-41" id="h107-2-41" class="i">+                            datatype: Integer,
</a><a href="#h107-2-42" id="h107-2-42" class="i">+                            primary_key: false,
</a><a href="#h107-2-43" id="h107-2-43" class="i">+                            nullable: false,
</a><a href="#h107-2-44" id="h107-2-44" class="i">+                            default: None,
</a><a href="#h107-2-45" id="h107-2-45" class="i">+                            unique: false,
</a><a href="#h107-2-46" id="h107-2-46" class="i">+                            references: Some(
</a><a href="#h107-2-47" id="h107-2-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h107-2-48" id="h107-2-48" class="i">+                            ),
</a><a href="#h107-2-49" id="h107-2-49" class="i">+                            index: true,
</a><a href="#h107-2-50" id="h107-2-50" class="i">+                        },
</a><a href="#h107-2-51" id="h107-2-51" class="i">+                        Column {
</a><a href="#h107-2-52" id="h107-2-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h107-2-53" id="h107-2-53" class="i">+                            datatype: Integer,
</a><a href="#h107-2-54" id="h107-2-54" class="i">+                            primary_key: false,
</a><a href="#h107-2-55" id="h107-2-55" class="i">+                            nullable: false,
</a><a href="#h107-2-56" id="h107-2-56" class="i">+                            default: None,
</a><a href="#h107-2-57" id="h107-2-57" class="i">+                            unique: false,
</a><a href="#h107-2-58" id="h107-2-58" class="i">+                            references: None,
</a><a href="#h107-2-59" id="h107-2-59" class="i">+                            index: false,
</a><a href="#h107-2-60" id="h107-2-60" class="i">+                        },
</a><a href="#h107-2-61" id="h107-2-61" class="i">+                        Column {
</a><a href="#h107-2-62" id="h107-2-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h107-2-63" id="h107-2-63" class="i">+                            datatype: Float,
</a><a href="#h107-2-64" id="h107-2-64" class="i">+                            primary_key: false,
</a><a href="#h107-2-65" id="h107-2-65" class="i">+                            nullable: true,
</a><a href="#h107-2-66" id="h107-2-66" class="i">+                            default: Some(
</a><a href="#h107-2-67" id="h107-2-67" class="i">+                                Null,
</a><a href="#h107-2-68" id="h107-2-68" class="i">+                            ),
</a><a href="#h107-2-69" id="h107-2-69" class="i">+                            unique: false,
</a><a href="#h107-2-70" id="h107-2-70" class="i">+                            references: None,
</a><a href="#h107-2-71" id="h107-2-71" class="i">+                            index: false,
</a><a href="#h107-2-72" id="h107-2-72" class="i">+                        },
</a><a href="#h107-2-73" id="h107-2-73" class="i">+                        Column {
</a><a href="#h107-2-74" id="h107-2-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h107-2-75" id="h107-2-75" class="i">+                            datatype: Boolean,
</a><a href="#h107-2-76" id="h107-2-76" class="i">+                            primary_key: false,
</a><a href="#h107-2-77" id="h107-2-77" class="i">+                            nullable: true,
</a><a href="#h107-2-78" id="h107-2-78" class="i">+                            default: Some(
</a><a href="#h107-2-79" id="h107-2-79" class="i">+                                Null,
</a><a href="#h107-2-80" id="h107-2-80" class="i">+                            ),
</a><a href="#h107-2-81" id="h107-2-81" class="i">+                            unique: false,
</a><a href="#h107-2-82" id="h107-2-82" class="i">+                            references: None,
</a><a href="#h107-2-83" id="h107-2-83" class="i">+                            index: false,
</a><a href="#h107-2-84" id="h107-2-84" class="i">+                        },
</a><a href="#h107-2-85" id="h107-2-85" class="i">+                    ],
</a><a href="#h107-2-86" id="h107-2-86" class="i">+                },
</a>                 alias: Some(
                     &quot;m&quot;,
                 ),
<a href="#h107-3" id="h107-3" class="h">@@ -259,7 +447,31 @@ Optimized plan: Select(
</a>             },
             left_size: 7,
             right: KeyLookup {
<a href="#h107-3-3" id="h107-3-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h107-3-4" id="h107-3-4" class="i">+                table: Table {
</a><a href="#h107-3-5" id="h107-3-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h107-3-6" id="h107-3-6" class="i">+                    columns: [
</a><a href="#h107-3-7" id="h107-3-7" class="i">+                        Column {
</a><a href="#h107-3-8" id="h107-3-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h107-3-9" id="h107-3-9" class="i">+                            datatype: Integer,
</a><a href="#h107-3-10" id="h107-3-10" class="i">+                            primary_key: true,
</a><a href="#h107-3-11" id="h107-3-11" class="i">+                            nullable: false,
</a><a href="#h107-3-12" id="h107-3-12" class="i">+                            default: None,
</a><a href="#h107-3-13" id="h107-3-13" class="i">+                            unique: true,
</a><a href="#h107-3-14" id="h107-3-14" class="i">+                            references: None,
</a><a href="#h107-3-15" id="h107-3-15" class="i">+                            index: false,
</a><a href="#h107-3-16" id="h107-3-16" class="i">+                        },
</a><a href="#h107-3-17" id="h107-3-17" class="i">+                        Column {
</a><a href="#h107-3-18" id="h107-3-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h107-3-19" id="h107-3-19" class="i">+                            datatype: String,
</a><a href="#h107-3-20" id="h107-3-20" class="i">+                            primary_key: false,
</a><a href="#h107-3-21" id="h107-3-21" class="i">+                            nullable: false,
</a><a href="#h107-3-22" id="h107-3-22" class="i">+                            default: None,
</a><a href="#h107-3-23" id="h107-3-23" class="i">+                            unique: false,
</a><a href="#h107-3-24" id="h107-3-24" class="i">+                            references: None,
</a><a href="#h107-3-25" id="h107-3-25" class="i">+                            index: false,
</a><a href="#h107-3-26" id="h107-3-26" class="i">+                        },
</a><a href="#h107-3-27" id="h107-3-27" class="i">+                    ],
</a><a href="#h107-3-28" id="h107-3-28" class="i">+                },
</a>                 alias: Some(
                     &quot;g&quot;,
                 ),
<b>diff --git a/<a id="h108" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h108-0" id="h108-0" class="h">@@ -95,13 +95,119 @@ Plan: Select(
</a>         source: Filter {
             source: NestedLoopJoin {
                 left: Scan {
<a href="#h108-0-3" id="h108-0-3" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h108-0-4" id="h108-0-4" class="i">+                    table: Table {
</a><a href="#h108-0-5" id="h108-0-5" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h108-0-6" id="h108-0-6" class="i">+                        columns: [
</a><a href="#h108-0-7" id="h108-0-7" class="i">+                            Column {
</a><a href="#h108-0-8" id="h108-0-8" class="i">+                                name: &quot;id&quot;,
</a><a href="#h108-0-9" id="h108-0-9" class="i">+                                datatype: Integer,
</a><a href="#h108-0-10" id="h108-0-10" class="i">+                                primary_key: true,
</a><a href="#h108-0-11" id="h108-0-11" class="i">+                                nullable: false,
</a><a href="#h108-0-12" id="h108-0-12" class="i">+                                default: None,
</a><a href="#h108-0-13" id="h108-0-13" class="i">+                                unique: true,
</a><a href="#h108-0-14" id="h108-0-14" class="i">+                                references: None,
</a><a href="#h108-0-15" id="h108-0-15" class="i">+                                index: false,
</a><a href="#h108-0-16" id="h108-0-16" class="i">+                            },
</a><a href="#h108-0-17" id="h108-0-17" class="i">+                            Column {
</a><a href="#h108-0-18" id="h108-0-18" class="i">+                                name: &quot;title&quot;,
</a><a href="#h108-0-19" id="h108-0-19" class="i">+                                datatype: String,
</a><a href="#h108-0-20" id="h108-0-20" class="i">+                                primary_key: false,
</a><a href="#h108-0-21" id="h108-0-21" class="i">+                                nullable: false,
</a><a href="#h108-0-22" id="h108-0-22" class="i">+                                default: None,
</a><a href="#h108-0-23" id="h108-0-23" class="i">+                                unique: false,
</a><a href="#h108-0-24" id="h108-0-24" class="i">+                                references: None,
</a><a href="#h108-0-25" id="h108-0-25" class="i">+                                index: false,
</a><a href="#h108-0-26" id="h108-0-26" class="i">+                            },
</a><a href="#h108-0-27" id="h108-0-27" class="i">+                            Column {
</a><a href="#h108-0-28" id="h108-0-28" class="i">+                                name: &quot;studio_id&quot;,
</a><a href="#h108-0-29" id="h108-0-29" class="i">+                                datatype: Integer,
</a><a href="#h108-0-30" id="h108-0-30" class="i">+                                primary_key: false,
</a><a href="#h108-0-31" id="h108-0-31" class="i">+                                nullable: false,
</a><a href="#h108-0-32" id="h108-0-32" class="i">+                                default: None,
</a><a href="#h108-0-33" id="h108-0-33" class="i">+                                unique: false,
</a><a href="#h108-0-34" id="h108-0-34" class="i">+                                references: Some(
</a><a href="#h108-0-35" id="h108-0-35" class="i">+                                    &quot;studios&quot;,
</a><a href="#h108-0-36" id="h108-0-36" class="i">+                                ),
</a><a href="#h108-0-37" id="h108-0-37" class="i">+                                index: true,
</a><a href="#h108-0-38" id="h108-0-38" class="i">+                            },
</a><a href="#h108-0-39" id="h108-0-39" class="i">+                            Column {
</a><a href="#h108-0-40" id="h108-0-40" class="i">+                                name: &quot;genre_id&quot;,
</a><a href="#h108-0-41" id="h108-0-41" class="i">+                                datatype: Integer,
</a><a href="#h108-0-42" id="h108-0-42" class="i">+                                primary_key: false,
</a><a href="#h108-0-43" id="h108-0-43" class="i">+                                nullable: false,
</a><a href="#h108-0-44" id="h108-0-44" class="i">+                                default: None,
</a><a href="#h108-0-45" id="h108-0-45" class="i">+                                unique: false,
</a><a href="#h108-0-46" id="h108-0-46" class="i">+                                references: Some(
</a><a href="#h108-0-47" id="h108-0-47" class="i">+                                    &quot;genres&quot;,
</a><a href="#h108-0-48" id="h108-0-48" class="i">+                                ),
</a><a href="#h108-0-49" id="h108-0-49" class="i">+                                index: true,
</a><a href="#h108-0-50" id="h108-0-50" class="i">+                            },
</a><a href="#h108-0-51" id="h108-0-51" class="i">+                            Column {
</a><a href="#h108-0-52" id="h108-0-52" class="i">+                                name: &quot;released&quot;,
</a><a href="#h108-0-53" id="h108-0-53" class="i">+                                datatype: Integer,
</a><a href="#h108-0-54" id="h108-0-54" class="i">+                                primary_key: false,
</a><a href="#h108-0-55" id="h108-0-55" class="i">+                                nullable: false,
</a><a href="#h108-0-56" id="h108-0-56" class="i">+                                default: None,
</a><a href="#h108-0-57" id="h108-0-57" class="i">+                                unique: false,
</a><a href="#h108-0-58" id="h108-0-58" class="i">+                                references: None,
</a><a href="#h108-0-59" id="h108-0-59" class="i">+                                index: false,
</a><a href="#h108-0-60" id="h108-0-60" class="i">+                            },
</a><a href="#h108-0-61" id="h108-0-61" class="i">+                            Column {
</a><a href="#h108-0-62" id="h108-0-62" class="i">+                                name: &quot;rating&quot;,
</a><a href="#h108-0-63" id="h108-0-63" class="i">+                                datatype: Float,
</a><a href="#h108-0-64" id="h108-0-64" class="i">+                                primary_key: false,
</a><a href="#h108-0-65" id="h108-0-65" class="i">+                                nullable: true,
</a><a href="#h108-0-66" id="h108-0-66" class="i">+                                default: Some(
</a><a href="#h108-0-67" id="h108-0-67" class="i">+                                    Null,
</a><a href="#h108-0-68" id="h108-0-68" class="i">+                                ),
</a><a href="#h108-0-69" id="h108-0-69" class="i">+                                unique: false,
</a><a href="#h108-0-70" id="h108-0-70" class="i">+                                references: None,
</a><a href="#h108-0-71" id="h108-0-71" class="i">+                                index: false,
</a><a href="#h108-0-72" id="h108-0-72" class="i">+                            },
</a><a href="#h108-0-73" id="h108-0-73" class="i">+                            Column {
</a><a href="#h108-0-74" id="h108-0-74" class="i">+                                name: &quot;ultrahd&quot;,
</a><a href="#h108-0-75" id="h108-0-75" class="i">+                                datatype: Boolean,
</a><a href="#h108-0-76" id="h108-0-76" class="i">+                                primary_key: false,
</a><a href="#h108-0-77" id="h108-0-77" class="i">+                                nullable: true,
</a><a href="#h108-0-78" id="h108-0-78" class="i">+                                default: Some(
</a><a href="#h108-0-79" id="h108-0-79" class="i">+                                    Null,
</a><a href="#h108-0-80" id="h108-0-80" class="i">+                                ),
</a><a href="#h108-0-81" id="h108-0-81" class="i">+                                unique: false,
</a><a href="#h108-0-82" id="h108-0-82" class="i">+                                references: None,
</a><a href="#h108-0-83" id="h108-0-83" class="i">+                                index: false,
</a><a href="#h108-0-84" id="h108-0-84" class="i">+                            },
</a><a href="#h108-0-85" id="h108-0-85" class="i">+                        ],
</a><a href="#h108-0-86" id="h108-0-86" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
                 left_size: 7,
                 right: Scan {
<a href="#h108-0-92" id="h108-0-92" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h108-0-93" id="h108-0-93" class="i">+                    table: Table {
</a><a href="#h108-0-94" id="h108-0-94" class="i">+                        name: &quot;genres&quot;,
</a><a href="#h108-0-95" id="h108-0-95" class="i">+                        columns: [
</a><a href="#h108-0-96" id="h108-0-96" class="i">+                            Column {
</a><a href="#h108-0-97" id="h108-0-97" class="i">+                                name: &quot;id&quot;,
</a><a href="#h108-0-98" id="h108-0-98" class="i">+                                datatype: Integer,
</a><a href="#h108-0-99" id="h108-0-99" class="i">+                                primary_key: true,
</a><a href="#h108-0-100" id="h108-0-100" class="i">+                                nullable: false,
</a><a href="#h108-0-101" id="h108-0-101" class="i">+                                default: None,
</a><a href="#h108-0-102" id="h108-0-102" class="i">+                                unique: true,
</a><a href="#h108-0-103" id="h108-0-103" class="i">+                                references: None,
</a><a href="#h108-0-104" id="h108-0-104" class="i">+                                index: false,
</a><a href="#h108-0-105" id="h108-0-105" class="i">+                            },
</a><a href="#h108-0-106" id="h108-0-106" class="i">+                            Column {
</a><a href="#h108-0-107" id="h108-0-107" class="i">+                                name: &quot;name&quot;,
</a><a href="#h108-0-108" id="h108-0-108" class="i">+                                datatype: String,
</a><a href="#h108-0-109" id="h108-0-109" class="i">+                                primary_key: false,
</a><a href="#h108-0-110" id="h108-0-110" class="i">+                                nullable: false,
</a><a href="#h108-0-111" id="h108-0-111" class="i">+                                default: None,
</a><a href="#h108-0-112" id="h108-0-112" class="i">+                                unique: false,
</a><a href="#h108-0-113" id="h108-0-113" class="i">+                                references: None,
</a><a href="#h108-0-114" id="h108-0-114" class="i">+                                index: false,
</a><a href="#h108-0-115" id="h108-0-115" class="i">+                            },
</a><a href="#h108-0-116" id="h108-0-116" class="i">+                        ],
</a><a href="#h108-0-117" id="h108-0-117" class="i">+                    },
</a>                     alias: None,
                     filter: None,
                 },
<a href="#h108-1" id="h108-1" class="h">@@ -204,7 +310,89 @@ Optimized plan: Select(
</a>     Projection {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h108-1-3" id="h108-1-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h108-1-4" id="h108-1-4" class="i">+                table: Table {
</a><a href="#h108-1-5" id="h108-1-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h108-1-6" id="h108-1-6" class="i">+                    columns: [
</a><a href="#h108-1-7" id="h108-1-7" class="i">+                        Column {
</a><a href="#h108-1-8" id="h108-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h108-1-9" id="h108-1-9" class="i">+                            datatype: Integer,
</a><a href="#h108-1-10" id="h108-1-10" class="i">+                            primary_key: true,
</a><a href="#h108-1-11" id="h108-1-11" class="i">+                            nullable: false,
</a><a href="#h108-1-12" id="h108-1-12" class="i">+                            default: None,
</a><a href="#h108-1-13" id="h108-1-13" class="i">+                            unique: true,
</a><a href="#h108-1-14" id="h108-1-14" class="i">+                            references: None,
</a><a href="#h108-1-15" id="h108-1-15" class="i">+                            index: false,
</a><a href="#h108-1-16" id="h108-1-16" class="i">+                        },
</a><a href="#h108-1-17" id="h108-1-17" class="i">+                        Column {
</a><a href="#h108-1-18" id="h108-1-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h108-1-19" id="h108-1-19" class="i">+                            datatype: String,
</a><a href="#h108-1-20" id="h108-1-20" class="i">+                            primary_key: false,
</a><a href="#h108-1-21" id="h108-1-21" class="i">+                            nullable: false,
</a><a href="#h108-1-22" id="h108-1-22" class="i">+                            default: None,
</a><a href="#h108-1-23" id="h108-1-23" class="i">+                            unique: false,
</a><a href="#h108-1-24" id="h108-1-24" class="i">+                            references: None,
</a><a href="#h108-1-25" id="h108-1-25" class="i">+                            index: false,
</a><a href="#h108-1-26" id="h108-1-26" class="i">+                        },
</a><a href="#h108-1-27" id="h108-1-27" class="i">+                        Column {
</a><a href="#h108-1-28" id="h108-1-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h108-1-29" id="h108-1-29" class="i">+                            datatype: Integer,
</a><a href="#h108-1-30" id="h108-1-30" class="i">+                            primary_key: false,
</a><a href="#h108-1-31" id="h108-1-31" class="i">+                            nullable: false,
</a><a href="#h108-1-32" id="h108-1-32" class="i">+                            default: None,
</a><a href="#h108-1-33" id="h108-1-33" class="i">+                            unique: false,
</a><a href="#h108-1-34" id="h108-1-34" class="i">+                            references: Some(
</a><a href="#h108-1-35" id="h108-1-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h108-1-36" id="h108-1-36" class="i">+                            ),
</a><a href="#h108-1-37" id="h108-1-37" class="i">+                            index: true,
</a><a href="#h108-1-38" id="h108-1-38" class="i">+                        },
</a><a href="#h108-1-39" id="h108-1-39" class="i">+                        Column {
</a><a href="#h108-1-40" id="h108-1-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h108-1-41" id="h108-1-41" class="i">+                            datatype: Integer,
</a><a href="#h108-1-42" id="h108-1-42" class="i">+                            primary_key: false,
</a><a href="#h108-1-43" id="h108-1-43" class="i">+                            nullable: false,
</a><a href="#h108-1-44" id="h108-1-44" class="i">+                            default: None,
</a><a href="#h108-1-45" id="h108-1-45" class="i">+                            unique: false,
</a><a href="#h108-1-46" id="h108-1-46" class="i">+                            references: Some(
</a><a href="#h108-1-47" id="h108-1-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h108-1-48" id="h108-1-48" class="i">+                            ),
</a><a href="#h108-1-49" id="h108-1-49" class="i">+                            index: true,
</a><a href="#h108-1-50" id="h108-1-50" class="i">+                        },
</a><a href="#h108-1-51" id="h108-1-51" class="i">+                        Column {
</a><a href="#h108-1-52" id="h108-1-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h108-1-53" id="h108-1-53" class="i">+                            datatype: Integer,
</a><a href="#h108-1-54" id="h108-1-54" class="i">+                            primary_key: false,
</a><a href="#h108-1-55" id="h108-1-55" class="i">+                            nullable: false,
</a><a href="#h108-1-56" id="h108-1-56" class="i">+                            default: None,
</a><a href="#h108-1-57" id="h108-1-57" class="i">+                            unique: false,
</a><a href="#h108-1-58" id="h108-1-58" class="i">+                            references: None,
</a><a href="#h108-1-59" id="h108-1-59" class="i">+                            index: false,
</a><a href="#h108-1-60" id="h108-1-60" class="i">+                        },
</a><a href="#h108-1-61" id="h108-1-61" class="i">+                        Column {
</a><a href="#h108-1-62" id="h108-1-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h108-1-63" id="h108-1-63" class="i">+                            datatype: Float,
</a><a href="#h108-1-64" id="h108-1-64" class="i">+                            primary_key: false,
</a><a href="#h108-1-65" id="h108-1-65" class="i">+                            nullable: true,
</a><a href="#h108-1-66" id="h108-1-66" class="i">+                            default: Some(
</a><a href="#h108-1-67" id="h108-1-67" class="i">+                                Null,
</a><a href="#h108-1-68" id="h108-1-68" class="i">+                            ),
</a><a href="#h108-1-69" id="h108-1-69" class="i">+                            unique: false,
</a><a href="#h108-1-70" id="h108-1-70" class="i">+                            references: None,
</a><a href="#h108-1-71" id="h108-1-71" class="i">+                            index: false,
</a><a href="#h108-1-72" id="h108-1-72" class="i">+                        },
</a><a href="#h108-1-73" id="h108-1-73" class="i">+                        Column {
</a><a href="#h108-1-74" id="h108-1-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h108-1-75" id="h108-1-75" class="i">+                            datatype: Boolean,
</a><a href="#h108-1-76" id="h108-1-76" class="i">+                            primary_key: false,
</a><a href="#h108-1-77" id="h108-1-77" class="i">+                            nullable: true,
</a><a href="#h108-1-78" id="h108-1-78" class="i">+                            default: Some(
</a><a href="#h108-1-79" id="h108-1-79" class="i">+                                Null,
</a><a href="#h108-1-80" id="h108-1-80" class="i">+                            ),
</a><a href="#h108-1-81" id="h108-1-81" class="i">+                            unique: false,
</a><a href="#h108-1-82" id="h108-1-82" class="i">+                            references: None,
</a><a href="#h108-1-83" id="h108-1-83" class="i">+                            index: false,
</a><a href="#h108-1-84" id="h108-1-84" class="i">+                        },
</a><a href="#h108-1-85" id="h108-1-85" class="i">+                    ],
</a><a href="#h108-1-86" id="h108-1-86" class="i">+                },
</a>                 alias: None,
                 filter: Some(
                     Or(
<a href="#h108-2" id="h108-2" class="h">@@ -249,7 +437,31 @@ Optimized plan: Select(
</a>             },
             left_size: 7,
             right: KeyLookup {
<a href="#h108-2-3" id="h108-2-3" class="d">-                table: &quot;genres&quot;,
</a><a href="#h108-2-4" id="h108-2-4" class="i">+                table: Table {
</a><a href="#h108-2-5" id="h108-2-5" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h108-2-6" id="h108-2-6" class="i">+                    columns: [
</a><a href="#h108-2-7" id="h108-2-7" class="i">+                        Column {
</a><a href="#h108-2-8" id="h108-2-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h108-2-9" id="h108-2-9" class="i">+                            datatype: Integer,
</a><a href="#h108-2-10" id="h108-2-10" class="i">+                            primary_key: true,
</a><a href="#h108-2-11" id="h108-2-11" class="i">+                            nullable: false,
</a><a href="#h108-2-12" id="h108-2-12" class="i">+                            default: None,
</a><a href="#h108-2-13" id="h108-2-13" class="i">+                            unique: true,
</a><a href="#h108-2-14" id="h108-2-14" class="i">+                            references: None,
</a><a href="#h108-2-15" id="h108-2-15" class="i">+                            index: false,
</a><a href="#h108-2-16" id="h108-2-16" class="i">+                        },
</a><a href="#h108-2-17" id="h108-2-17" class="i">+                        Column {
</a><a href="#h108-2-18" id="h108-2-18" class="i">+                            name: &quot;name&quot;,
</a><a href="#h108-2-19" id="h108-2-19" class="i">+                            datatype: String,
</a><a href="#h108-2-20" id="h108-2-20" class="i">+                            primary_key: false,
</a><a href="#h108-2-21" id="h108-2-21" class="i">+                            nullable: false,
</a><a href="#h108-2-22" id="h108-2-22" class="i">+                            default: None,
</a><a href="#h108-2-23" id="h108-2-23" class="i">+                            unique: false,
</a><a href="#h108-2-24" id="h108-2-24" class="i">+                            references: None,
</a><a href="#h108-2-25" id="h108-2-25" class="i">+                            index: false,
</a><a href="#h108-2-26" id="h108-2-26" class="i">+                        },
</a><a href="#h108-2-27" id="h108-2-27" class="i">+                    ],
</a><a href="#h108-2-28" id="h108-2-28" class="i">+                },
</a>                 alias: None,
                 keys: [
                     Integer(
<b>diff --git a/<a id="h109" href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a> b/<a href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a></b>
<a href="#h109-0" id="h109-0" class="h">@@ -30,7 +30,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h109-0-3" id="h109-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h109-0-4" id="h109-0-4" class="i">+            table: Table {
</a><a href="#h109-0-5" id="h109-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h109-0-6" id="h109-0-6" class="i">+                columns: [
</a><a href="#h109-0-7" id="h109-0-7" class="i">+                    Column {
</a><a href="#h109-0-8" id="h109-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h109-0-9" id="h109-0-9" class="i">+                        datatype: Integer,
</a><a href="#h109-0-10" id="h109-0-10" class="i">+                        primary_key: true,
</a><a href="#h109-0-11" id="h109-0-11" class="i">+                        nullable: false,
</a><a href="#h109-0-12" id="h109-0-12" class="i">+                        default: None,
</a><a href="#h109-0-13" id="h109-0-13" class="i">+                        unique: true,
</a><a href="#h109-0-14" id="h109-0-14" class="i">+                        references: None,
</a><a href="#h109-0-15" id="h109-0-15" class="i">+                        index: false,
</a><a href="#h109-0-16" id="h109-0-16" class="i">+                    },
</a><a href="#h109-0-17" id="h109-0-17" class="i">+                    Column {
</a><a href="#h109-0-18" id="h109-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h109-0-19" id="h109-0-19" class="i">+                        datatype: String,
</a><a href="#h109-0-20" id="h109-0-20" class="i">+                        primary_key: false,
</a><a href="#h109-0-21" id="h109-0-21" class="i">+                        nullable: false,
</a><a href="#h109-0-22" id="h109-0-22" class="i">+                        default: None,
</a><a href="#h109-0-23" id="h109-0-23" class="i">+                        unique: false,
</a><a href="#h109-0-24" id="h109-0-24" class="i">+                        references: None,
</a><a href="#h109-0-25" id="h109-0-25" class="i">+                        index: false,
</a><a href="#h109-0-26" id="h109-0-26" class="i">+                    },
</a><a href="#h109-0-27" id="h109-0-27" class="i">+                    Column {
</a><a href="#h109-0-28" id="h109-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h109-0-29" id="h109-0-29" class="i">+                        datatype: Integer,
</a><a href="#h109-0-30" id="h109-0-30" class="i">+                        primary_key: false,
</a><a href="#h109-0-31" id="h109-0-31" class="i">+                        nullable: false,
</a><a href="#h109-0-32" id="h109-0-32" class="i">+                        default: None,
</a><a href="#h109-0-33" id="h109-0-33" class="i">+                        unique: false,
</a><a href="#h109-0-34" id="h109-0-34" class="i">+                        references: Some(
</a><a href="#h109-0-35" id="h109-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h109-0-36" id="h109-0-36" class="i">+                        ),
</a><a href="#h109-0-37" id="h109-0-37" class="i">+                        index: true,
</a><a href="#h109-0-38" id="h109-0-38" class="i">+                    },
</a><a href="#h109-0-39" id="h109-0-39" class="i">+                    Column {
</a><a href="#h109-0-40" id="h109-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h109-0-41" id="h109-0-41" class="i">+                        datatype: Integer,
</a><a href="#h109-0-42" id="h109-0-42" class="i">+                        primary_key: false,
</a><a href="#h109-0-43" id="h109-0-43" class="i">+                        nullable: false,
</a><a href="#h109-0-44" id="h109-0-44" class="i">+                        default: None,
</a><a href="#h109-0-45" id="h109-0-45" class="i">+                        unique: false,
</a><a href="#h109-0-46" id="h109-0-46" class="i">+                        references: Some(
</a><a href="#h109-0-47" id="h109-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h109-0-48" id="h109-0-48" class="i">+                        ),
</a><a href="#h109-0-49" id="h109-0-49" class="i">+                        index: true,
</a><a href="#h109-0-50" id="h109-0-50" class="i">+                    },
</a><a href="#h109-0-51" id="h109-0-51" class="i">+                    Column {
</a><a href="#h109-0-52" id="h109-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h109-0-53" id="h109-0-53" class="i">+                        datatype: Integer,
</a><a href="#h109-0-54" id="h109-0-54" class="i">+                        primary_key: false,
</a><a href="#h109-0-55" id="h109-0-55" class="i">+                        nullable: false,
</a><a href="#h109-0-56" id="h109-0-56" class="i">+                        default: None,
</a><a href="#h109-0-57" id="h109-0-57" class="i">+                        unique: false,
</a><a href="#h109-0-58" id="h109-0-58" class="i">+                        references: None,
</a><a href="#h109-0-59" id="h109-0-59" class="i">+                        index: false,
</a><a href="#h109-0-60" id="h109-0-60" class="i">+                    },
</a><a href="#h109-0-61" id="h109-0-61" class="i">+                    Column {
</a><a href="#h109-0-62" id="h109-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h109-0-63" id="h109-0-63" class="i">+                        datatype: Float,
</a><a href="#h109-0-64" id="h109-0-64" class="i">+                        primary_key: false,
</a><a href="#h109-0-65" id="h109-0-65" class="i">+                        nullable: true,
</a><a href="#h109-0-66" id="h109-0-66" class="i">+                        default: Some(
</a><a href="#h109-0-67" id="h109-0-67" class="i">+                            Null,
</a><a href="#h109-0-68" id="h109-0-68" class="i">+                        ),
</a><a href="#h109-0-69" id="h109-0-69" class="i">+                        unique: false,
</a><a href="#h109-0-70" id="h109-0-70" class="i">+                        references: None,
</a><a href="#h109-0-71" id="h109-0-71" class="i">+                        index: false,
</a><a href="#h109-0-72" id="h109-0-72" class="i">+                    },
</a><a href="#h109-0-73" id="h109-0-73" class="i">+                    Column {
</a><a href="#h109-0-74" id="h109-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h109-0-75" id="h109-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h109-0-76" id="h109-0-76" class="i">+                        primary_key: false,
</a><a href="#h109-0-77" id="h109-0-77" class="i">+                        nullable: true,
</a><a href="#h109-0-78" id="h109-0-78" class="i">+                        default: Some(
</a><a href="#h109-0-79" id="h109-0-79" class="i">+                            Null,
</a><a href="#h109-0-80" id="h109-0-80" class="i">+                        ),
</a><a href="#h109-0-81" id="h109-0-81" class="i">+                        unique: false,
</a><a href="#h109-0-82" id="h109-0-82" class="i">+                        references: None,
</a><a href="#h109-0-83" id="h109-0-83" class="i">+                        index: false,
</a><a href="#h109-0-84" id="h109-0-84" class="i">+                    },
</a><a href="#h109-0-85" id="h109-0-85" class="i">+                ],
</a><a href="#h109-0-86" id="h109-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h109-1" id="h109-1" class="h">@@ -44,7 +126,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     Scan {
<a href="#h109-1-3" id="h109-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h109-1-4" id="h109-1-4" class="i">+        table: Table {
</a><a href="#h109-1-5" id="h109-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h109-1-6" id="h109-1-6" class="i">+            columns: [
</a><a href="#h109-1-7" id="h109-1-7" class="i">+                Column {
</a><a href="#h109-1-8" id="h109-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h109-1-9" id="h109-1-9" class="i">+                    datatype: Integer,
</a><a href="#h109-1-10" id="h109-1-10" class="i">+                    primary_key: true,
</a><a href="#h109-1-11" id="h109-1-11" class="i">+                    nullable: false,
</a><a href="#h109-1-12" id="h109-1-12" class="i">+                    default: None,
</a><a href="#h109-1-13" id="h109-1-13" class="i">+                    unique: true,
</a><a href="#h109-1-14" id="h109-1-14" class="i">+                    references: None,
</a><a href="#h109-1-15" id="h109-1-15" class="i">+                    index: false,
</a><a href="#h109-1-16" id="h109-1-16" class="i">+                },
</a><a href="#h109-1-17" id="h109-1-17" class="i">+                Column {
</a><a href="#h109-1-18" id="h109-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h109-1-19" id="h109-1-19" class="i">+                    datatype: String,
</a><a href="#h109-1-20" id="h109-1-20" class="i">+                    primary_key: false,
</a><a href="#h109-1-21" id="h109-1-21" class="i">+                    nullable: false,
</a><a href="#h109-1-22" id="h109-1-22" class="i">+                    default: None,
</a><a href="#h109-1-23" id="h109-1-23" class="i">+                    unique: false,
</a><a href="#h109-1-24" id="h109-1-24" class="i">+                    references: None,
</a><a href="#h109-1-25" id="h109-1-25" class="i">+                    index: false,
</a><a href="#h109-1-26" id="h109-1-26" class="i">+                },
</a><a href="#h109-1-27" id="h109-1-27" class="i">+                Column {
</a><a href="#h109-1-28" id="h109-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h109-1-29" id="h109-1-29" class="i">+                    datatype: Integer,
</a><a href="#h109-1-30" id="h109-1-30" class="i">+                    primary_key: false,
</a><a href="#h109-1-31" id="h109-1-31" class="i">+                    nullable: false,
</a><a href="#h109-1-32" id="h109-1-32" class="i">+                    default: None,
</a><a href="#h109-1-33" id="h109-1-33" class="i">+                    unique: false,
</a><a href="#h109-1-34" id="h109-1-34" class="i">+                    references: Some(
</a><a href="#h109-1-35" id="h109-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h109-1-36" id="h109-1-36" class="i">+                    ),
</a><a href="#h109-1-37" id="h109-1-37" class="i">+                    index: true,
</a><a href="#h109-1-38" id="h109-1-38" class="i">+                },
</a><a href="#h109-1-39" id="h109-1-39" class="i">+                Column {
</a><a href="#h109-1-40" id="h109-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h109-1-41" id="h109-1-41" class="i">+                    datatype: Integer,
</a><a href="#h109-1-42" id="h109-1-42" class="i">+                    primary_key: false,
</a><a href="#h109-1-43" id="h109-1-43" class="i">+                    nullable: false,
</a><a href="#h109-1-44" id="h109-1-44" class="i">+                    default: None,
</a><a href="#h109-1-45" id="h109-1-45" class="i">+                    unique: false,
</a><a href="#h109-1-46" id="h109-1-46" class="i">+                    references: Some(
</a><a href="#h109-1-47" id="h109-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h109-1-48" id="h109-1-48" class="i">+                    ),
</a><a href="#h109-1-49" id="h109-1-49" class="i">+                    index: true,
</a><a href="#h109-1-50" id="h109-1-50" class="i">+                },
</a><a href="#h109-1-51" id="h109-1-51" class="i">+                Column {
</a><a href="#h109-1-52" id="h109-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h109-1-53" id="h109-1-53" class="i">+                    datatype: Integer,
</a><a href="#h109-1-54" id="h109-1-54" class="i">+                    primary_key: false,
</a><a href="#h109-1-55" id="h109-1-55" class="i">+                    nullable: false,
</a><a href="#h109-1-56" id="h109-1-56" class="i">+                    default: None,
</a><a href="#h109-1-57" id="h109-1-57" class="i">+                    unique: false,
</a><a href="#h109-1-58" id="h109-1-58" class="i">+                    references: None,
</a><a href="#h109-1-59" id="h109-1-59" class="i">+                    index: false,
</a><a href="#h109-1-60" id="h109-1-60" class="i">+                },
</a><a href="#h109-1-61" id="h109-1-61" class="i">+                Column {
</a><a href="#h109-1-62" id="h109-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h109-1-63" id="h109-1-63" class="i">+                    datatype: Float,
</a><a href="#h109-1-64" id="h109-1-64" class="i">+                    primary_key: false,
</a><a href="#h109-1-65" id="h109-1-65" class="i">+                    nullable: true,
</a><a href="#h109-1-66" id="h109-1-66" class="i">+                    default: Some(
</a><a href="#h109-1-67" id="h109-1-67" class="i">+                        Null,
</a><a href="#h109-1-68" id="h109-1-68" class="i">+                    ),
</a><a href="#h109-1-69" id="h109-1-69" class="i">+                    unique: false,
</a><a href="#h109-1-70" id="h109-1-70" class="i">+                    references: None,
</a><a href="#h109-1-71" id="h109-1-71" class="i">+                    index: false,
</a><a href="#h109-1-72" id="h109-1-72" class="i">+                },
</a><a href="#h109-1-73" id="h109-1-73" class="i">+                Column {
</a><a href="#h109-1-74" id="h109-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h109-1-75" id="h109-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h109-1-76" id="h109-1-76" class="i">+                    primary_key: false,
</a><a href="#h109-1-77" id="h109-1-77" class="i">+                    nullable: true,
</a><a href="#h109-1-78" id="h109-1-78" class="i">+                    default: Some(
</a><a href="#h109-1-79" id="h109-1-79" class="i">+                        Null,
</a><a href="#h109-1-80" id="h109-1-80" class="i">+                    ),
</a><a href="#h109-1-81" id="h109-1-81" class="i">+                    unique: false,
</a><a href="#h109-1-82" id="h109-1-82" class="i">+                    references: None,
</a><a href="#h109-1-83" id="h109-1-83" class="i">+                    index: false,
</a><a href="#h109-1-84" id="h109-1-84" class="i">+                },
</a><a href="#h109-1-85" id="h109-1-85" class="i">+            ],
</a><a href="#h109-1-86" id="h109-1-86" class="i">+        },
</a>         alias: None,
         filter: Some(
             Constant(
<b>diff --git a/<a id="h110" href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a> b/<a href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a></b>
<a href="#h110-0" id="h110-0" class="h">@@ -50,7 +50,89 @@ Plan: Select(
</a>     Order {
         source: Filter {
             source: Scan {
<a href="#h110-0-3" id="h110-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h110-0-4" id="h110-0-4" class="i">+                table: Table {
</a><a href="#h110-0-5" id="h110-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h110-0-6" id="h110-0-6" class="i">+                    columns: [
</a><a href="#h110-0-7" id="h110-0-7" class="i">+                        Column {
</a><a href="#h110-0-8" id="h110-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h110-0-9" id="h110-0-9" class="i">+                            datatype: Integer,
</a><a href="#h110-0-10" id="h110-0-10" class="i">+                            primary_key: true,
</a><a href="#h110-0-11" id="h110-0-11" class="i">+                            nullable: false,
</a><a href="#h110-0-12" id="h110-0-12" class="i">+                            default: None,
</a><a href="#h110-0-13" id="h110-0-13" class="i">+                            unique: true,
</a><a href="#h110-0-14" id="h110-0-14" class="i">+                            references: None,
</a><a href="#h110-0-15" id="h110-0-15" class="i">+                            index: false,
</a><a href="#h110-0-16" id="h110-0-16" class="i">+                        },
</a><a href="#h110-0-17" id="h110-0-17" class="i">+                        Column {
</a><a href="#h110-0-18" id="h110-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h110-0-19" id="h110-0-19" class="i">+                            datatype: String,
</a><a href="#h110-0-20" id="h110-0-20" class="i">+                            primary_key: false,
</a><a href="#h110-0-21" id="h110-0-21" class="i">+                            nullable: false,
</a><a href="#h110-0-22" id="h110-0-22" class="i">+                            default: None,
</a><a href="#h110-0-23" id="h110-0-23" class="i">+                            unique: false,
</a><a href="#h110-0-24" id="h110-0-24" class="i">+                            references: None,
</a><a href="#h110-0-25" id="h110-0-25" class="i">+                            index: false,
</a><a href="#h110-0-26" id="h110-0-26" class="i">+                        },
</a><a href="#h110-0-27" id="h110-0-27" class="i">+                        Column {
</a><a href="#h110-0-28" id="h110-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h110-0-29" id="h110-0-29" class="i">+                            datatype: Integer,
</a><a href="#h110-0-30" id="h110-0-30" class="i">+                            primary_key: false,
</a><a href="#h110-0-31" id="h110-0-31" class="i">+                            nullable: false,
</a><a href="#h110-0-32" id="h110-0-32" class="i">+                            default: None,
</a><a href="#h110-0-33" id="h110-0-33" class="i">+                            unique: false,
</a><a href="#h110-0-34" id="h110-0-34" class="i">+                            references: Some(
</a><a href="#h110-0-35" id="h110-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h110-0-36" id="h110-0-36" class="i">+                            ),
</a><a href="#h110-0-37" id="h110-0-37" class="i">+                            index: true,
</a><a href="#h110-0-38" id="h110-0-38" class="i">+                        },
</a><a href="#h110-0-39" id="h110-0-39" class="i">+                        Column {
</a><a href="#h110-0-40" id="h110-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h110-0-41" id="h110-0-41" class="i">+                            datatype: Integer,
</a><a href="#h110-0-42" id="h110-0-42" class="i">+                            primary_key: false,
</a><a href="#h110-0-43" id="h110-0-43" class="i">+                            nullable: false,
</a><a href="#h110-0-44" id="h110-0-44" class="i">+                            default: None,
</a><a href="#h110-0-45" id="h110-0-45" class="i">+                            unique: false,
</a><a href="#h110-0-46" id="h110-0-46" class="i">+                            references: Some(
</a><a href="#h110-0-47" id="h110-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h110-0-48" id="h110-0-48" class="i">+                            ),
</a><a href="#h110-0-49" id="h110-0-49" class="i">+                            index: true,
</a><a href="#h110-0-50" id="h110-0-50" class="i">+                        },
</a><a href="#h110-0-51" id="h110-0-51" class="i">+                        Column {
</a><a href="#h110-0-52" id="h110-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h110-0-53" id="h110-0-53" class="i">+                            datatype: Integer,
</a><a href="#h110-0-54" id="h110-0-54" class="i">+                            primary_key: false,
</a><a href="#h110-0-55" id="h110-0-55" class="i">+                            nullable: false,
</a><a href="#h110-0-56" id="h110-0-56" class="i">+                            default: None,
</a><a href="#h110-0-57" id="h110-0-57" class="i">+                            unique: false,
</a><a href="#h110-0-58" id="h110-0-58" class="i">+                            references: None,
</a><a href="#h110-0-59" id="h110-0-59" class="i">+                            index: false,
</a><a href="#h110-0-60" id="h110-0-60" class="i">+                        },
</a><a href="#h110-0-61" id="h110-0-61" class="i">+                        Column {
</a><a href="#h110-0-62" id="h110-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h110-0-63" id="h110-0-63" class="i">+                            datatype: Float,
</a><a href="#h110-0-64" id="h110-0-64" class="i">+                            primary_key: false,
</a><a href="#h110-0-65" id="h110-0-65" class="i">+                            nullable: true,
</a><a href="#h110-0-66" id="h110-0-66" class="i">+                            default: Some(
</a><a href="#h110-0-67" id="h110-0-67" class="i">+                                Null,
</a><a href="#h110-0-68" id="h110-0-68" class="i">+                            ),
</a><a href="#h110-0-69" id="h110-0-69" class="i">+                            unique: false,
</a><a href="#h110-0-70" id="h110-0-70" class="i">+                            references: None,
</a><a href="#h110-0-71" id="h110-0-71" class="i">+                            index: false,
</a><a href="#h110-0-72" id="h110-0-72" class="i">+                        },
</a><a href="#h110-0-73" id="h110-0-73" class="i">+                        Column {
</a><a href="#h110-0-74" id="h110-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h110-0-75" id="h110-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h110-0-76" id="h110-0-76" class="i">+                            primary_key: false,
</a><a href="#h110-0-77" id="h110-0-77" class="i">+                            nullable: true,
</a><a href="#h110-0-78" id="h110-0-78" class="i">+                            default: Some(
</a><a href="#h110-0-79" id="h110-0-79" class="i">+                                Null,
</a><a href="#h110-0-80" id="h110-0-80" class="i">+                            ),
</a><a href="#h110-0-81" id="h110-0-81" class="i">+                            unique: false,
</a><a href="#h110-0-82" id="h110-0-82" class="i">+                            references: None,
</a><a href="#h110-0-83" id="h110-0-83" class="i">+                            index: false,
</a><a href="#h110-0-84" id="h110-0-84" class="i">+                        },
</a><a href="#h110-0-85" id="h110-0-85" class="i">+                    ],
</a><a href="#h110-0-86" id="h110-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h110-1" id="h110-1" class="h">@@ -91,7 +173,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: IndexLookup {
<a href="#h110-1-3" id="h110-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h110-1-4" id="h110-1-4" class="i">+            table: Table {
</a><a href="#h110-1-5" id="h110-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h110-1-6" id="h110-1-6" class="i">+                columns: [
</a><a href="#h110-1-7" id="h110-1-7" class="i">+                    Column {
</a><a href="#h110-1-8" id="h110-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h110-1-9" id="h110-1-9" class="i">+                        datatype: Integer,
</a><a href="#h110-1-10" id="h110-1-10" class="i">+                        primary_key: true,
</a><a href="#h110-1-11" id="h110-1-11" class="i">+                        nullable: false,
</a><a href="#h110-1-12" id="h110-1-12" class="i">+                        default: None,
</a><a href="#h110-1-13" id="h110-1-13" class="i">+                        unique: true,
</a><a href="#h110-1-14" id="h110-1-14" class="i">+                        references: None,
</a><a href="#h110-1-15" id="h110-1-15" class="i">+                        index: false,
</a><a href="#h110-1-16" id="h110-1-16" class="i">+                    },
</a><a href="#h110-1-17" id="h110-1-17" class="i">+                    Column {
</a><a href="#h110-1-18" id="h110-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h110-1-19" id="h110-1-19" class="i">+                        datatype: String,
</a><a href="#h110-1-20" id="h110-1-20" class="i">+                        primary_key: false,
</a><a href="#h110-1-21" id="h110-1-21" class="i">+                        nullable: false,
</a><a href="#h110-1-22" id="h110-1-22" class="i">+                        default: None,
</a><a href="#h110-1-23" id="h110-1-23" class="i">+                        unique: false,
</a><a href="#h110-1-24" id="h110-1-24" class="i">+                        references: None,
</a><a href="#h110-1-25" id="h110-1-25" class="i">+                        index: false,
</a><a href="#h110-1-26" id="h110-1-26" class="i">+                    },
</a><a href="#h110-1-27" id="h110-1-27" class="i">+                    Column {
</a><a href="#h110-1-28" id="h110-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h110-1-29" id="h110-1-29" class="i">+                        datatype: Integer,
</a><a href="#h110-1-30" id="h110-1-30" class="i">+                        primary_key: false,
</a><a href="#h110-1-31" id="h110-1-31" class="i">+                        nullable: false,
</a><a href="#h110-1-32" id="h110-1-32" class="i">+                        default: None,
</a><a href="#h110-1-33" id="h110-1-33" class="i">+                        unique: false,
</a><a href="#h110-1-34" id="h110-1-34" class="i">+                        references: Some(
</a><a href="#h110-1-35" id="h110-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h110-1-36" id="h110-1-36" class="i">+                        ),
</a><a href="#h110-1-37" id="h110-1-37" class="i">+                        index: true,
</a><a href="#h110-1-38" id="h110-1-38" class="i">+                    },
</a><a href="#h110-1-39" id="h110-1-39" class="i">+                    Column {
</a><a href="#h110-1-40" id="h110-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h110-1-41" id="h110-1-41" class="i">+                        datatype: Integer,
</a><a href="#h110-1-42" id="h110-1-42" class="i">+                        primary_key: false,
</a><a href="#h110-1-43" id="h110-1-43" class="i">+                        nullable: false,
</a><a href="#h110-1-44" id="h110-1-44" class="i">+                        default: None,
</a><a href="#h110-1-45" id="h110-1-45" class="i">+                        unique: false,
</a><a href="#h110-1-46" id="h110-1-46" class="i">+                        references: Some(
</a><a href="#h110-1-47" id="h110-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h110-1-48" id="h110-1-48" class="i">+                        ),
</a><a href="#h110-1-49" id="h110-1-49" class="i">+                        index: true,
</a><a href="#h110-1-50" id="h110-1-50" class="i">+                    },
</a><a href="#h110-1-51" id="h110-1-51" class="i">+                    Column {
</a><a href="#h110-1-52" id="h110-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h110-1-53" id="h110-1-53" class="i">+                        datatype: Integer,
</a><a href="#h110-1-54" id="h110-1-54" class="i">+                        primary_key: false,
</a><a href="#h110-1-55" id="h110-1-55" class="i">+                        nullable: false,
</a><a href="#h110-1-56" id="h110-1-56" class="i">+                        default: None,
</a><a href="#h110-1-57" id="h110-1-57" class="i">+                        unique: false,
</a><a href="#h110-1-58" id="h110-1-58" class="i">+                        references: None,
</a><a href="#h110-1-59" id="h110-1-59" class="i">+                        index: false,
</a><a href="#h110-1-60" id="h110-1-60" class="i">+                    },
</a><a href="#h110-1-61" id="h110-1-61" class="i">+                    Column {
</a><a href="#h110-1-62" id="h110-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h110-1-63" id="h110-1-63" class="i">+                        datatype: Float,
</a><a href="#h110-1-64" id="h110-1-64" class="i">+                        primary_key: false,
</a><a href="#h110-1-65" id="h110-1-65" class="i">+                        nullable: true,
</a><a href="#h110-1-66" id="h110-1-66" class="i">+                        default: Some(
</a><a href="#h110-1-67" id="h110-1-67" class="i">+                            Null,
</a><a href="#h110-1-68" id="h110-1-68" class="i">+                        ),
</a><a href="#h110-1-69" id="h110-1-69" class="i">+                        unique: false,
</a><a href="#h110-1-70" id="h110-1-70" class="i">+                        references: None,
</a><a href="#h110-1-71" id="h110-1-71" class="i">+                        index: false,
</a><a href="#h110-1-72" id="h110-1-72" class="i">+                    },
</a><a href="#h110-1-73" id="h110-1-73" class="i">+                    Column {
</a><a href="#h110-1-74" id="h110-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h110-1-75" id="h110-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h110-1-76" id="h110-1-76" class="i">+                        primary_key: false,
</a><a href="#h110-1-77" id="h110-1-77" class="i">+                        nullable: true,
</a><a href="#h110-1-78" id="h110-1-78" class="i">+                        default: Some(
</a><a href="#h110-1-79" id="h110-1-79" class="i">+                            Null,
</a><a href="#h110-1-80" id="h110-1-80" class="i">+                        ),
</a><a href="#h110-1-81" id="h110-1-81" class="i">+                        unique: false,
</a><a href="#h110-1-82" id="h110-1-82" class="i">+                        references: None,
</a><a href="#h110-1-83" id="h110-1-83" class="i">+                        index: false,
</a><a href="#h110-1-84" id="h110-1-84" class="i">+                    },
</a><a href="#h110-1-85" id="h110-1-85" class="i">+                ],
</a><a href="#h110-1-86" id="h110-1-86" class="i">+            },
</a>             alias: None,
             column: &quot;genre_id&quot;,
             values: [
<b>diff --git a/<a id="h111" href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a> b/<a href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a></b>
<a href="#h111-0" id="h111-0" class="h">@@ -103,7 +103,89 @@ Plan: Select(
</a>     Order {
         source: Filter {
             source: Scan {
<a href="#h111-0-3" id="h111-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h111-0-4" id="h111-0-4" class="i">+                table: Table {
</a><a href="#h111-0-5" id="h111-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h111-0-6" id="h111-0-6" class="i">+                    columns: [
</a><a href="#h111-0-7" id="h111-0-7" class="i">+                        Column {
</a><a href="#h111-0-8" id="h111-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h111-0-9" id="h111-0-9" class="i">+                            datatype: Integer,
</a><a href="#h111-0-10" id="h111-0-10" class="i">+                            primary_key: true,
</a><a href="#h111-0-11" id="h111-0-11" class="i">+                            nullable: false,
</a><a href="#h111-0-12" id="h111-0-12" class="i">+                            default: None,
</a><a href="#h111-0-13" id="h111-0-13" class="i">+                            unique: true,
</a><a href="#h111-0-14" id="h111-0-14" class="i">+                            references: None,
</a><a href="#h111-0-15" id="h111-0-15" class="i">+                            index: false,
</a><a href="#h111-0-16" id="h111-0-16" class="i">+                        },
</a><a href="#h111-0-17" id="h111-0-17" class="i">+                        Column {
</a><a href="#h111-0-18" id="h111-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h111-0-19" id="h111-0-19" class="i">+                            datatype: String,
</a><a href="#h111-0-20" id="h111-0-20" class="i">+                            primary_key: false,
</a><a href="#h111-0-21" id="h111-0-21" class="i">+                            nullable: false,
</a><a href="#h111-0-22" id="h111-0-22" class="i">+                            default: None,
</a><a href="#h111-0-23" id="h111-0-23" class="i">+                            unique: false,
</a><a href="#h111-0-24" id="h111-0-24" class="i">+                            references: None,
</a><a href="#h111-0-25" id="h111-0-25" class="i">+                            index: false,
</a><a href="#h111-0-26" id="h111-0-26" class="i">+                        },
</a><a href="#h111-0-27" id="h111-0-27" class="i">+                        Column {
</a><a href="#h111-0-28" id="h111-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h111-0-29" id="h111-0-29" class="i">+                            datatype: Integer,
</a><a href="#h111-0-30" id="h111-0-30" class="i">+                            primary_key: false,
</a><a href="#h111-0-31" id="h111-0-31" class="i">+                            nullable: false,
</a><a href="#h111-0-32" id="h111-0-32" class="i">+                            default: None,
</a><a href="#h111-0-33" id="h111-0-33" class="i">+                            unique: false,
</a><a href="#h111-0-34" id="h111-0-34" class="i">+                            references: Some(
</a><a href="#h111-0-35" id="h111-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h111-0-36" id="h111-0-36" class="i">+                            ),
</a><a href="#h111-0-37" id="h111-0-37" class="i">+                            index: true,
</a><a href="#h111-0-38" id="h111-0-38" class="i">+                        },
</a><a href="#h111-0-39" id="h111-0-39" class="i">+                        Column {
</a><a href="#h111-0-40" id="h111-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h111-0-41" id="h111-0-41" class="i">+                            datatype: Integer,
</a><a href="#h111-0-42" id="h111-0-42" class="i">+                            primary_key: false,
</a><a href="#h111-0-43" id="h111-0-43" class="i">+                            nullable: false,
</a><a href="#h111-0-44" id="h111-0-44" class="i">+                            default: None,
</a><a href="#h111-0-45" id="h111-0-45" class="i">+                            unique: false,
</a><a href="#h111-0-46" id="h111-0-46" class="i">+                            references: Some(
</a><a href="#h111-0-47" id="h111-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h111-0-48" id="h111-0-48" class="i">+                            ),
</a><a href="#h111-0-49" id="h111-0-49" class="i">+                            index: true,
</a><a href="#h111-0-50" id="h111-0-50" class="i">+                        },
</a><a href="#h111-0-51" id="h111-0-51" class="i">+                        Column {
</a><a href="#h111-0-52" id="h111-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h111-0-53" id="h111-0-53" class="i">+                            datatype: Integer,
</a><a href="#h111-0-54" id="h111-0-54" class="i">+                            primary_key: false,
</a><a href="#h111-0-55" id="h111-0-55" class="i">+                            nullable: false,
</a><a href="#h111-0-56" id="h111-0-56" class="i">+                            default: None,
</a><a href="#h111-0-57" id="h111-0-57" class="i">+                            unique: false,
</a><a href="#h111-0-58" id="h111-0-58" class="i">+                            references: None,
</a><a href="#h111-0-59" id="h111-0-59" class="i">+                            index: false,
</a><a href="#h111-0-60" id="h111-0-60" class="i">+                        },
</a><a href="#h111-0-61" id="h111-0-61" class="i">+                        Column {
</a><a href="#h111-0-62" id="h111-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h111-0-63" id="h111-0-63" class="i">+                            datatype: Float,
</a><a href="#h111-0-64" id="h111-0-64" class="i">+                            primary_key: false,
</a><a href="#h111-0-65" id="h111-0-65" class="i">+                            nullable: true,
</a><a href="#h111-0-66" id="h111-0-66" class="i">+                            default: Some(
</a><a href="#h111-0-67" id="h111-0-67" class="i">+                                Null,
</a><a href="#h111-0-68" id="h111-0-68" class="i">+                            ),
</a><a href="#h111-0-69" id="h111-0-69" class="i">+                            unique: false,
</a><a href="#h111-0-70" id="h111-0-70" class="i">+                            references: None,
</a><a href="#h111-0-71" id="h111-0-71" class="i">+                            index: false,
</a><a href="#h111-0-72" id="h111-0-72" class="i">+                        },
</a><a href="#h111-0-73" id="h111-0-73" class="i">+                        Column {
</a><a href="#h111-0-74" id="h111-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h111-0-75" id="h111-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h111-0-76" id="h111-0-76" class="i">+                            primary_key: false,
</a><a href="#h111-0-77" id="h111-0-77" class="i">+                            nullable: true,
</a><a href="#h111-0-78" id="h111-0-78" class="i">+                            default: Some(
</a><a href="#h111-0-79" id="h111-0-79" class="i">+                                Null,
</a><a href="#h111-0-80" id="h111-0-80" class="i">+                            ),
</a><a href="#h111-0-81" id="h111-0-81" class="i">+                            unique: false,
</a><a href="#h111-0-82" id="h111-0-82" class="i">+                            references: None,
</a><a href="#h111-0-83" id="h111-0-83" class="i">+                            index: false,
</a><a href="#h111-0-84" id="h111-0-84" class="i">+                        },
</a><a href="#h111-0-85" id="h111-0-85" class="i">+                    ],
</a><a href="#h111-0-86" id="h111-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h111-1" id="h111-1" class="h">@@ -198,7 +280,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Order {
         source: IndexLookup {
<a href="#h111-1-3" id="h111-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h111-1-4" id="h111-1-4" class="i">+            table: Table {
</a><a href="#h111-1-5" id="h111-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h111-1-6" id="h111-1-6" class="i">+                columns: [
</a><a href="#h111-1-7" id="h111-1-7" class="i">+                    Column {
</a><a href="#h111-1-8" id="h111-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h111-1-9" id="h111-1-9" class="i">+                        datatype: Integer,
</a><a href="#h111-1-10" id="h111-1-10" class="i">+                        primary_key: true,
</a><a href="#h111-1-11" id="h111-1-11" class="i">+                        nullable: false,
</a><a href="#h111-1-12" id="h111-1-12" class="i">+                        default: None,
</a><a href="#h111-1-13" id="h111-1-13" class="i">+                        unique: true,
</a><a href="#h111-1-14" id="h111-1-14" class="i">+                        references: None,
</a><a href="#h111-1-15" id="h111-1-15" class="i">+                        index: false,
</a><a href="#h111-1-16" id="h111-1-16" class="i">+                    },
</a><a href="#h111-1-17" id="h111-1-17" class="i">+                    Column {
</a><a href="#h111-1-18" id="h111-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h111-1-19" id="h111-1-19" class="i">+                        datatype: String,
</a><a href="#h111-1-20" id="h111-1-20" class="i">+                        primary_key: false,
</a><a href="#h111-1-21" id="h111-1-21" class="i">+                        nullable: false,
</a><a href="#h111-1-22" id="h111-1-22" class="i">+                        default: None,
</a><a href="#h111-1-23" id="h111-1-23" class="i">+                        unique: false,
</a><a href="#h111-1-24" id="h111-1-24" class="i">+                        references: None,
</a><a href="#h111-1-25" id="h111-1-25" class="i">+                        index: false,
</a><a href="#h111-1-26" id="h111-1-26" class="i">+                    },
</a><a href="#h111-1-27" id="h111-1-27" class="i">+                    Column {
</a><a href="#h111-1-28" id="h111-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h111-1-29" id="h111-1-29" class="i">+                        datatype: Integer,
</a><a href="#h111-1-30" id="h111-1-30" class="i">+                        primary_key: false,
</a><a href="#h111-1-31" id="h111-1-31" class="i">+                        nullable: false,
</a><a href="#h111-1-32" id="h111-1-32" class="i">+                        default: None,
</a><a href="#h111-1-33" id="h111-1-33" class="i">+                        unique: false,
</a><a href="#h111-1-34" id="h111-1-34" class="i">+                        references: Some(
</a><a href="#h111-1-35" id="h111-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h111-1-36" id="h111-1-36" class="i">+                        ),
</a><a href="#h111-1-37" id="h111-1-37" class="i">+                        index: true,
</a><a href="#h111-1-38" id="h111-1-38" class="i">+                    },
</a><a href="#h111-1-39" id="h111-1-39" class="i">+                    Column {
</a><a href="#h111-1-40" id="h111-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h111-1-41" id="h111-1-41" class="i">+                        datatype: Integer,
</a><a href="#h111-1-42" id="h111-1-42" class="i">+                        primary_key: false,
</a><a href="#h111-1-43" id="h111-1-43" class="i">+                        nullable: false,
</a><a href="#h111-1-44" id="h111-1-44" class="i">+                        default: None,
</a><a href="#h111-1-45" id="h111-1-45" class="i">+                        unique: false,
</a><a href="#h111-1-46" id="h111-1-46" class="i">+                        references: Some(
</a><a href="#h111-1-47" id="h111-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h111-1-48" id="h111-1-48" class="i">+                        ),
</a><a href="#h111-1-49" id="h111-1-49" class="i">+                        index: true,
</a><a href="#h111-1-50" id="h111-1-50" class="i">+                    },
</a><a href="#h111-1-51" id="h111-1-51" class="i">+                    Column {
</a><a href="#h111-1-52" id="h111-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h111-1-53" id="h111-1-53" class="i">+                        datatype: Integer,
</a><a href="#h111-1-54" id="h111-1-54" class="i">+                        primary_key: false,
</a><a href="#h111-1-55" id="h111-1-55" class="i">+                        nullable: false,
</a><a href="#h111-1-56" id="h111-1-56" class="i">+                        default: None,
</a><a href="#h111-1-57" id="h111-1-57" class="i">+                        unique: false,
</a><a href="#h111-1-58" id="h111-1-58" class="i">+                        references: None,
</a><a href="#h111-1-59" id="h111-1-59" class="i">+                        index: false,
</a><a href="#h111-1-60" id="h111-1-60" class="i">+                    },
</a><a href="#h111-1-61" id="h111-1-61" class="i">+                    Column {
</a><a href="#h111-1-62" id="h111-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h111-1-63" id="h111-1-63" class="i">+                        datatype: Float,
</a><a href="#h111-1-64" id="h111-1-64" class="i">+                        primary_key: false,
</a><a href="#h111-1-65" id="h111-1-65" class="i">+                        nullable: true,
</a><a href="#h111-1-66" id="h111-1-66" class="i">+                        default: Some(
</a><a href="#h111-1-67" id="h111-1-67" class="i">+                            Null,
</a><a href="#h111-1-68" id="h111-1-68" class="i">+                        ),
</a><a href="#h111-1-69" id="h111-1-69" class="i">+                        unique: false,
</a><a href="#h111-1-70" id="h111-1-70" class="i">+                        references: None,
</a><a href="#h111-1-71" id="h111-1-71" class="i">+                        index: false,
</a><a href="#h111-1-72" id="h111-1-72" class="i">+                    },
</a><a href="#h111-1-73" id="h111-1-73" class="i">+                    Column {
</a><a href="#h111-1-74" id="h111-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h111-1-75" id="h111-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h111-1-76" id="h111-1-76" class="i">+                        primary_key: false,
</a><a href="#h111-1-77" id="h111-1-77" class="i">+                        nullable: true,
</a><a href="#h111-1-78" id="h111-1-78" class="i">+                        default: Some(
</a><a href="#h111-1-79" id="h111-1-79" class="i">+                            Null,
</a><a href="#h111-1-80" id="h111-1-80" class="i">+                        ),
</a><a href="#h111-1-81" id="h111-1-81" class="i">+                        unique: false,
</a><a href="#h111-1-82" id="h111-1-82" class="i">+                        references: None,
</a><a href="#h111-1-83" id="h111-1-83" class="i">+                        index: false,
</a><a href="#h111-1-84" id="h111-1-84" class="i">+                    },
</a><a href="#h111-1-85" id="h111-1-85" class="i">+                ],
</a><a href="#h111-1-86" id="h111-1-86" class="i">+            },
</a>             alias: None,
             column: &quot;genre_id&quot;,
             values: [
<b>diff --git a/<a id="h112" href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a> b/<a href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a></b>
<a href="#h112-0" id="h112-0" class="h">@@ -85,7 +85,89 @@ Plan: Select(
</a>     Order {
         source: Filter {
             source: Scan {
<a href="#h112-0-3" id="h112-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h112-0-4" id="h112-0-4" class="i">+                table: Table {
</a><a href="#h112-0-5" id="h112-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h112-0-6" id="h112-0-6" class="i">+                    columns: [
</a><a href="#h112-0-7" id="h112-0-7" class="i">+                        Column {
</a><a href="#h112-0-8" id="h112-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h112-0-9" id="h112-0-9" class="i">+                            datatype: Integer,
</a><a href="#h112-0-10" id="h112-0-10" class="i">+                            primary_key: true,
</a><a href="#h112-0-11" id="h112-0-11" class="i">+                            nullable: false,
</a><a href="#h112-0-12" id="h112-0-12" class="i">+                            default: None,
</a><a href="#h112-0-13" id="h112-0-13" class="i">+                            unique: true,
</a><a href="#h112-0-14" id="h112-0-14" class="i">+                            references: None,
</a><a href="#h112-0-15" id="h112-0-15" class="i">+                            index: false,
</a><a href="#h112-0-16" id="h112-0-16" class="i">+                        },
</a><a href="#h112-0-17" id="h112-0-17" class="i">+                        Column {
</a><a href="#h112-0-18" id="h112-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h112-0-19" id="h112-0-19" class="i">+                            datatype: String,
</a><a href="#h112-0-20" id="h112-0-20" class="i">+                            primary_key: false,
</a><a href="#h112-0-21" id="h112-0-21" class="i">+                            nullable: false,
</a><a href="#h112-0-22" id="h112-0-22" class="i">+                            default: None,
</a><a href="#h112-0-23" id="h112-0-23" class="i">+                            unique: false,
</a><a href="#h112-0-24" id="h112-0-24" class="i">+                            references: None,
</a><a href="#h112-0-25" id="h112-0-25" class="i">+                            index: false,
</a><a href="#h112-0-26" id="h112-0-26" class="i">+                        },
</a><a href="#h112-0-27" id="h112-0-27" class="i">+                        Column {
</a><a href="#h112-0-28" id="h112-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h112-0-29" id="h112-0-29" class="i">+                            datatype: Integer,
</a><a href="#h112-0-30" id="h112-0-30" class="i">+                            primary_key: false,
</a><a href="#h112-0-31" id="h112-0-31" class="i">+                            nullable: false,
</a><a href="#h112-0-32" id="h112-0-32" class="i">+                            default: None,
</a><a href="#h112-0-33" id="h112-0-33" class="i">+                            unique: false,
</a><a href="#h112-0-34" id="h112-0-34" class="i">+                            references: Some(
</a><a href="#h112-0-35" id="h112-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h112-0-36" id="h112-0-36" class="i">+                            ),
</a><a href="#h112-0-37" id="h112-0-37" class="i">+                            index: true,
</a><a href="#h112-0-38" id="h112-0-38" class="i">+                        },
</a><a href="#h112-0-39" id="h112-0-39" class="i">+                        Column {
</a><a href="#h112-0-40" id="h112-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h112-0-41" id="h112-0-41" class="i">+                            datatype: Integer,
</a><a href="#h112-0-42" id="h112-0-42" class="i">+                            primary_key: false,
</a><a href="#h112-0-43" id="h112-0-43" class="i">+                            nullable: false,
</a><a href="#h112-0-44" id="h112-0-44" class="i">+                            default: None,
</a><a href="#h112-0-45" id="h112-0-45" class="i">+                            unique: false,
</a><a href="#h112-0-46" id="h112-0-46" class="i">+                            references: Some(
</a><a href="#h112-0-47" id="h112-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h112-0-48" id="h112-0-48" class="i">+                            ),
</a><a href="#h112-0-49" id="h112-0-49" class="i">+                            index: true,
</a><a href="#h112-0-50" id="h112-0-50" class="i">+                        },
</a><a href="#h112-0-51" id="h112-0-51" class="i">+                        Column {
</a><a href="#h112-0-52" id="h112-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h112-0-53" id="h112-0-53" class="i">+                            datatype: Integer,
</a><a href="#h112-0-54" id="h112-0-54" class="i">+                            primary_key: false,
</a><a href="#h112-0-55" id="h112-0-55" class="i">+                            nullable: false,
</a><a href="#h112-0-56" id="h112-0-56" class="i">+                            default: None,
</a><a href="#h112-0-57" id="h112-0-57" class="i">+                            unique: false,
</a><a href="#h112-0-58" id="h112-0-58" class="i">+                            references: None,
</a><a href="#h112-0-59" id="h112-0-59" class="i">+                            index: false,
</a><a href="#h112-0-60" id="h112-0-60" class="i">+                        },
</a><a href="#h112-0-61" id="h112-0-61" class="i">+                        Column {
</a><a href="#h112-0-62" id="h112-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h112-0-63" id="h112-0-63" class="i">+                            datatype: Float,
</a><a href="#h112-0-64" id="h112-0-64" class="i">+                            primary_key: false,
</a><a href="#h112-0-65" id="h112-0-65" class="i">+                            nullable: true,
</a><a href="#h112-0-66" id="h112-0-66" class="i">+                            default: Some(
</a><a href="#h112-0-67" id="h112-0-67" class="i">+                                Null,
</a><a href="#h112-0-68" id="h112-0-68" class="i">+                            ),
</a><a href="#h112-0-69" id="h112-0-69" class="i">+                            unique: false,
</a><a href="#h112-0-70" id="h112-0-70" class="i">+                            references: None,
</a><a href="#h112-0-71" id="h112-0-71" class="i">+                            index: false,
</a><a href="#h112-0-72" id="h112-0-72" class="i">+                        },
</a><a href="#h112-0-73" id="h112-0-73" class="i">+                        Column {
</a><a href="#h112-0-74" id="h112-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h112-0-75" id="h112-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h112-0-76" id="h112-0-76" class="i">+                            primary_key: false,
</a><a href="#h112-0-77" id="h112-0-77" class="i">+                            nullable: true,
</a><a href="#h112-0-78" id="h112-0-78" class="i">+                            default: Some(
</a><a href="#h112-0-79" id="h112-0-79" class="i">+                                Null,
</a><a href="#h112-0-80" id="h112-0-80" class="i">+                            ),
</a><a href="#h112-0-81" id="h112-0-81" class="i">+                            unique: false,
</a><a href="#h112-0-82" id="h112-0-82" class="i">+                            references: None,
</a><a href="#h112-0-83" id="h112-0-83" class="i">+                            index: false,
</a><a href="#h112-0-84" id="h112-0-84" class="i">+                        },
</a><a href="#h112-0-85" id="h112-0-85" class="i">+                    ],
</a><a href="#h112-0-86" id="h112-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h112-1" id="h112-1" class="h">@@ -163,7 +245,89 @@ Optimized plan: Select(
</a>     Order {
         source: Filter {
             source: IndexLookup {
<a href="#h112-1-3" id="h112-1-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h112-1-4" id="h112-1-4" class="i">+                table: Table {
</a><a href="#h112-1-5" id="h112-1-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h112-1-6" id="h112-1-6" class="i">+                    columns: [
</a><a href="#h112-1-7" id="h112-1-7" class="i">+                        Column {
</a><a href="#h112-1-8" id="h112-1-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h112-1-9" id="h112-1-9" class="i">+                            datatype: Integer,
</a><a href="#h112-1-10" id="h112-1-10" class="i">+                            primary_key: true,
</a><a href="#h112-1-11" id="h112-1-11" class="i">+                            nullable: false,
</a><a href="#h112-1-12" id="h112-1-12" class="i">+                            default: None,
</a><a href="#h112-1-13" id="h112-1-13" class="i">+                            unique: true,
</a><a href="#h112-1-14" id="h112-1-14" class="i">+                            references: None,
</a><a href="#h112-1-15" id="h112-1-15" class="i">+                            index: false,
</a><a href="#h112-1-16" id="h112-1-16" class="i">+                        },
</a><a href="#h112-1-17" id="h112-1-17" class="i">+                        Column {
</a><a href="#h112-1-18" id="h112-1-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h112-1-19" id="h112-1-19" class="i">+                            datatype: String,
</a><a href="#h112-1-20" id="h112-1-20" class="i">+                            primary_key: false,
</a><a href="#h112-1-21" id="h112-1-21" class="i">+                            nullable: false,
</a><a href="#h112-1-22" id="h112-1-22" class="i">+                            default: None,
</a><a href="#h112-1-23" id="h112-1-23" class="i">+                            unique: false,
</a><a href="#h112-1-24" id="h112-1-24" class="i">+                            references: None,
</a><a href="#h112-1-25" id="h112-1-25" class="i">+                            index: false,
</a><a href="#h112-1-26" id="h112-1-26" class="i">+                        },
</a><a href="#h112-1-27" id="h112-1-27" class="i">+                        Column {
</a><a href="#h112-1-28" id="h112-1-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h112-1-29" id="h112-1-29" class="i">+                            datatype: Integer,
</a><a href="#h112-1-30" id="h112-1-30" class="i">+                            primary_key: false,
</a><a href="#h112-1-31" id="h112-1-31" class="i">+                            nullable: false,
</a><a href="#h112-1-32" id="h112-1-32" class="i">+                            default: None,
</a><a href="#h112-1-33" id="h112-1-33" class="i">+                            unique: false,
</a><a href="#h112-1-34" id="h112-1-34" class="i">+                            references: Some(
</a><a href="#h112-1-35" id="h112-1-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h112-1-36" id="h112-1-36" class="i">+                            ),
</a><a href="#h112-1-37" id="h112-1-37" class="i">+                            index: true,
</a><a href="#h112-1-38" id="h112-1-38" class="i">+                        },
</a><a href="#h112-1-39" id="h112-1-39" class="i">+                        Column {
</a><a href="#h112-1-40" id="h112-1-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h112-1-41" id="h112-1-41" class="i">+                            datatype: Integer,
</a><a href="#h112-1-42" id="h112-1-42" class="i">+                            primary_key: false,
</a><a href="#h112-1-43" id="h112-1-43" class="i">+                            nullable: false,
</a><a href="#h112-1-44" id="h112-1-44" class="i">+                            default: None,
</a><a href="#h112-1-45" id="h112-1-45" class="i">+                            unique: false,
</a><a href="#h112-1-46" id="h112-1-46" class="i">+                            references: Some(
</a><a href="#h112-1-47" id="h112-1-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h112-1-48" id="h112-1-48" class="i">+                            ),
</a><a href="#h112-1-49" id="h112-1-49" class="i">+                            index: true,
</a><a href="#h112-1-50" id="h112-1-50" class="i">+                        },
</a><a href="#h112-1-51" id="h112-1-51" class="i">+                        Column {
</a><a href="#h112-1-52" id="h112-1-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h112-1-53" id="h112-1-53" class="i">+                            datatype: Integer,
</a><a href="#h112-1-54" id="h112-1-54" class="i">+                            primary_key: false,
</a><a href="#h112-1-55" id="h112-1-55" class="i">+                            nullable: false,
</a><a href="#h112-1-56" id="h112-1-56" class="i">+                            default: None,
</a><a href="#h112-1-57" id="h112-1-57" class="i">+                            unique: false,
</a><a href="#h112-1-58" id="h112-1-58" class="i">+                            references: None,
</a><a href="#h112-1-59" id="h112-1-59" class="i">+                            index: false,
</a><a href="#h112-1-60" id="h112-1-60" class="i">+                        },
</a><a href="#h112-1-61" id="h112-1-61" class="i">+                        Column {
</a><a href="#h112-1-62" id="h112-1-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h112-1-63" id="h112-1-63" class="i">+                            datatype: Float,
</a><a href="#h112-1-64" id="h112-1-64" class="i">+                            primary_key: false,
</a><a href="#h112-1-65" id="h112-1-65" class="i">+                            nullable: true,
</a><a href="#h112-1-66" id="h112-1-66" class="i">+                            default: Some(
</a><a href="#h112-1-67" id="h112-1-67" class="i">+                                Null,
</a><a href="#h112-1-68" id="h112-1-68" class="i">+                            ),
</a><a href="#h112-1-69" id="h112-1-69" class="i">+                            unique: false,
</a><a href="#h112-1-70" id="h112-1-70" class="i">+                            references: None,
</a><a href="#h112-1-71" id="h112-1-71" class="i">+                            index: false,
</a><a href="#h112-1-72" id="h112-1-72" class="i">+                        },
</a><a href="#h112-1-73" id="h112-1-73" class="i">+                        Column {
</a><a href="#h112-1-74" id="h112-1-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h112-1-75" id="h112-1-75" class="i">+                            datatype: Boolean,
</a><a href="#h112-1-76" id="h112-1-76" class="i">+                            primary_key: false,
</a><a href="#h112-1-77" id="h112-1-77" class="i">+                            nullable: true,
</a><a href="#h112-1-78" id="h112-1-78" class="i">+                            default: Some(
</a><a href="#h112-1-79" id="h112-1-79" class="i">+                                Null,
</a><a href="#h112-1-80" id="h112-1-80" class="i">+                            ),
</a><a href="#h112-1-81" id="h112-1-81" class="i">+                            unique: false,
</a><a href="#h112-1-82" id="h112-1-82" class="i">+                            references: None,
</a><a href="#h112-1-83" id="h112-1-83" class="i">+                            index: false,
</a><a href="#h112-1-84" id="h112-1-84" class="i">+                        },
</a><a href="#h112-1-85" id="h112-1-85" class="i">+                    ],
</a><a href="#h112-1-86" id="h112-1-86" class="i">+                },
</a>                 alias: None,
                 column: &quot;genre_id&quot;,
                 values: [
<b>diff --git a/<a id="h113" href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a> b/<a href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a></b>
<a href="#h113-0" id="h113-0" class="h">@@ -30,7 +30,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h113-0-3" id="h113-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h113-0-4" id="h113-0-4" class="i">+            table: Table {
</a><a href="#h113-0-5" id="h113-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h113-0-6" id="h113-0-6" class="i">+                columns: [
</a><a href="#h113-0-7" id="h113-0-7" class="i">+                    Column {
</a><a href="#h113-0-8" id="h113-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h113-0-9" id="h113-0-9" class="i">+                        datatype: Integer,
</a><a href="#h113-0-10" id="h113-0-10" class="i">+                        primary_key: true,
</a><a href="#h113-0-11" id="h113-0-11" class="i">+                        nullable: false,
</a><a href="#h113-0-12" id="h113-0-12" class="i">+                        default: None,
</a><a href="#h113-0-13" id="h113-0-13" class="i">+                        unique: true,
</a><a href="#h113-0-14" id="h113-0-14" class="i">+                        references: None,
</a><a href="#h113-0-15" id="h113-0-15" class="i">+                        index: false,
</a><a href="#h113-0-16" id="h113-0-16" class="i">+                    },
</a><a href="#h113-0-17" id="h113-0-17" class="i">+                    Column {
</a><a href="#h113-0-18" id="h113-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h113-0-19" id="h113-0-19" class="i">+                        datatype: String,
</a><a href="#h113-0-20" id="h113-0-20" class="i">+                        primary_key: false,
</a><a href="#h113-0-21" id="h113-0-21" class="i">+                        nullable: false,
</a><a href="#h113-0-22" id="h113-0-22" class="i">+                        default: None,
</a><a href="#h113-0-23" id="h113-0-23" class="i">+                        unique: false,
</a><a href="#h113-0-24" id="h113-0-24" class="i">+                        references: None,
</a><a href="#h113-0-25" id="h113-0-25" class="i">+                        index: false,
</a><a href="#h113-0-26" id="h113-0-26" class="i">+                    },
</a><a href="#h113-0-27" id="h113-0-27" class="i">+                    Column {
</a><a href="#h113-0-28" id="h113-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h113-0-29" id="h113-0-29" class="i">+                        datatype: Integer,
</a><a href="#h113-0-30" id="h113-0-30" class="i">+                        primary_key: false,
</a><a href="#h113-0-31" id="h113-0-31" class="i">+                        nullable: false,
</a><a href="#h113-0-32" id="h113-0-32" class="i">+                        default: None,
</a><a href="#h113-0-33" id="h113-0-33" class="i">+                        unique: false,
</a><a href="#h113-0-34" id="h113-0-34" class="i">+                        references: Some(
</a><a href="#h113-0-35" id="h113-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h113-0-36" id="h113-0-36" class="i">+                        ),
</a><a href="#h113-0-37" id="h113-0-37" class="i">+                        index: true,
</a><a href="#h113-0-38" id="h113-0-38" class="i">+                    },
</a><a href="#h113-0-39" id="h113-0-39" class="i">+                    Column {
</a><a href="#h113-0-40" id="h113-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h113-0-41" id="h113-0-41" class="i">+                        datatype: Integer,
</a><a href="#h113-0-42" id="h113-0-42" class="i">+                        primary_key: false,
</a><a href="#h113-0-43" id="h113-0-43" class="i">+                        nullable: false,
</a><a href="#h113-0-44" id="h113-0-44" class="i">+                        default: None,
</a><a href="#h113-0-45" id="h113-0-45" class="i">+                        unique: false,
</a><a href="#h113-0-46" id="h113-0-46" class="i">+                        references: Some(
</a><a href="#h113-0-47" id="h113-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h113-0-48" id="h113-0-48" class="i">+                        ),
</a><a href="#h113-0-49" id="h113-0-49" class="i">+                        index: true,
</a><a href="#h113-0-50" id="h113-0-50" class="i">+                    },
</a><a href="#h113-0-51" id="h113-0-51" class="i">+                    Column {
</a><a href="#h113-0-52" id="h113-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h113-0-53" id="h113-0-53" class="i">+                        datatype: Integer,
</a><a href="#h113-0-54" id="h113-0-54" class="i">+                        primary_key: false,
</a><a href="#h113-0-55" id="h113-0-55" class="i">+                        nullable: false,
</a><a href="#h113-0-56" id="h113-0-56" class="i">+                        default: None,
</a><a href="#h113-0-57" id="h113-0-57" class="i">+                        unique: false,
</a><a href="#h113-0-58" id="h113-0-58" class="i">+                        references: None,
</a><a href="#h113-0-59" id="h113-0-59" class="i">+                        index: false,
</a><a href="#h113-0-60" id="h113-0-60" class="i">+                    },
</a><a href="#h113-0-61" id="h113-0-61" class="i">+                    Column {
</a><a href="#h113-0-62" id="h113-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h113-0-63" id="h113-0-63" class="i">+                        datatype: Float,
</a><a href="#h113-0-64" id="h113-0-64" class="i">+                        primary_key: false,
</a><a href="#h113-0-65" id="h113-0-65" class="i">+                        nullable: true,
</a><a href="#h113-0-66" id="h113-0-66" class="i">+                        default: Some(
</a><a href="#h113-0-67" id="h113-0-67" class="i">+                            Null,
</a><a href="#h113-0-68" id="h113-0-68" class="i">+                        ),
</a><a href="#h113-0-69" id="h113-0-69" class="i">+                        unique: false,
</a><a href="#h113-0-70" id="h113-0-70" class="i">+                        references: None,
</a><a href="#h113-0-71" id="h113-0-71" class="i">+                        index: false,
</a><a href="#h113-0-72" id="h113-0-72" class="i">+                    },
</a><a href="#h113-0-73" id="h113-0-73" class="i">+                    Column {
</a><a href="#h113-0-74" id="h113-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h113-0-75" id="h113-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h113-0-76" id="h113-0-76" class="i">+                        primary_key: false,
</a><a href="#h113-0-77" id="h113-0-77" class="i">+                        nullable: true,
</a><a href="#h113-0-78" id="h113-0-78" class="i">+                        default: Some(
</a><a href="#h113-0-79" id="h113-0-79" class="i">+                            Null,
</a><a href="#h113-0-80" id="h113-0-80" class="i">+                        ),
</a><a href="#h113-0-81" id="h113-0-81" class="i">+                        unique: false,
</a><a href="#h113-0-82" id="h113-0-82" class="i">+                        references: None,
</a><a href="#h113-0-83" id="h113-0-83" class="i">+                        index: false,
</a><a href="#h113-0-84" id="h113-0-84" class="i">+                    },
</a><a href="#h113-0-85" id="h113-0-85" class="i">+                ],
</a><a href="#h113-0-86" id="h113-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h113-1" id="h113-1" class="h">@@ -44,7 +126,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     Scan {
<a href="#h113-1-3" id="h113-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h113-1-4" id="h113-1-4" class="i">+        table: Table {
</a><a href="#h113-1-5" id="h113-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h113-1-6" id="h113-1-6" class="i">+            columns: [
</a><a href="#h113-1-7" id="h113-1-7" class="i">+                Column {
</a><a href="#h113-1-8" id="h113-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h113-1-9" id="h113-1-9" class="i">+                    datatype: Integer,
</a><a href="#h113-1-10" id="h113-1-10" class="i">+                    primary_key: true,
</a><a href="#h113-1-11" id="h113-1-11" class="i">+                    nullable: false,
</a><a href="#h113-1-12" id="h113-1-12" class="i">+                    default: None,
</a><a href="#h113-1-13" id="h113-1-13" class="i">+                    unique: true,
</a><a href="#h113-1-14" id="h113-1-14" class="i">+                    references: None,
</a><a href="#h113-1-15" id="h113-1-15" class="i">+                    index: false,
</a><a href="#h113-1-16" id="h113-1-16" class="i">+                },
</a><a href="#h113-1-17" id="h113-1-17" class="i">+                Column {
</a><a href="#h113-1-18" id="h113-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h113-1-19" id="h113-1-19" class="i">+                    datatype: String,
</a><a href="#h113-1-20" id="h113-1-20" class="i">+                    primary_key: false,
</a><a href="#h113-1-21" id="h113-1-21" class="i">+                    nullable: false,
</a><a href="#h113-1-22" id="h113-1-22" class="i">+                    default: None,
</a><a href="#h113-1-23" id="h113-1-23" class="i">+                    unique: false,
</a><a href="#h113-1-24" id="h113-1-24" class="i">+                    references: None,
</a><a href="#h113-1-25" id="h113-1-25" class="i">+                    index: false,
</a><a href="#h113-1-26" id="h113-1-26" class="i">+                },
</a><a href="#h113-1-27" id="h113-1-27" class="i">+                Column {
</a><a href="#h113-1-28" id="h113-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h113-1-29" id="h113-1-29" class="i">+                    datatype: Integer,
</a><a href="#h113-1-30" id="h113-1-30" class="i">+                    primary_key: false,
</a><a href="#h113-1-31" id="h113-1-31" class="i">+                    nullable: false,
</a><a href="#h113-1-32" id="h113-1-32" class="i">+                    default: None,
</a><a href="#h113-1-33" id="h113-1-33" class="i">+                    unique: false,
</a><a href="#h113-1-34" id="h113-1-34" class="i">+                    references: Some(
</a><a href="#h113-1-35" id="h113-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h113-1-36" id="h113-1-36" class="i">+                    ),
</a><a href="#h113-1-37" id="h113-1-37" class="i">+                    index: true,
</a><a href="#h113-1-38" id="h113-1-38" class="i">+                },
</a><a href="#h113-1-39" id="h113-1-39" class="i">+                Column {
</a><a href="#h113-1-40" id="h113-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h113-1-41" id="h113-1-41" class="i">+                    datatype: Integer,
</a><a href="#h113-1-42" id="h113-1-42" class="i">+                    primary_key: false,
</a><a href="#h113-1-43" id="h113-1-43" class="i">+                    nullable: false,
</a><a href="#h113-1-44" id="h113-1-44" class="i">+                    default: None,
</a><a href="#h113-1-45" id="h113-1-45" class="i">+                    unique: false,
</a><a href="#h113-1-46" id="h113-1-46" class="i">+                    references: Some(
</a><a href="#h113-1-47" id="h113-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h113-1-48" id="h113-1-48" class="i">+                    ),
</a><a href="#h113-1-49" id="h113-1-49" class="i">+                    index: true,
</a><a href="#h113-1-50" id="h113-1-50" class="i">+                },
</a><a href="#h113-1-51" id="h113-1-51" class="i">+                Column {
</a><a href="#h113-1-52" id="h113-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h113-1-53" id="h113-1-53" class="i">+                    datatype: Integer,
</a><a href="#h113-1-54" id="h113-1-54" class="i">+                    primary_key: false,
</a><a href="#h113-1-55" id="h113-1-55" class="i">+                    nullable: false,
</a><a href="#h113-1-56" id="h113-1-56" class="i">+                    default: None,
</a><a href="#h113-1-57" id="h113-1-57" class="i">+                    unique: false,
</a><a href="#h113-1-58" id="h113-1-58" class="i">+                    references: None,
</a><a href="#h113-1-59" id="h113-1-59" class="i">+                    index: false,
</a><a href="#h113-1-60" id="h113-1-60" class="i">+                },
</a><a href="#h113-1-61" id="h113-1-61" class="i">+                Column {
</a><a href="#h113-1-62" id="h113-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h113-1-63" id="h113-1-63" class="i">+                    datatype: Float,
</a><a href="#h113-1-64" id="h113-1-64" class="i">+                    primary_key: false,
</a><a href="#h113-1-65" id="h113-1-65" class="i">+                    nullable: true,
</a><a href="#h113-1-66" id="h113-1-66" class="i">+                    default: Some(
</a><a href="#h113-1-67" id="h113-1-67" class="i">+                        Null,
</a><a href="#h113-1-68" id="h113-1-68" class="i">+                    ),
</a><a href="#h113-1-69" id="h113-1-69" class="i">+                    unique: false,
</a><a href="#h113-1-70" id="h113-1-70" class="i">+                    references: None,
</a><a href="#h113-1-71" id="h113-1-71" class="i">+                    index: false,
</a><a href="#h113-1-72" id="h113-1-72" class="i">+                },
</a><a href="#h113-1-73" id="h113-1-73" class="i">+                Column {
</a><a href="#h113-1-74" id="h113-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h113-1-75" id="h113-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h113-1-76" id="h113-1-76" class="i">+                    primary_key: false,
</a><a href="#h113-1-77" id="h113-1-77" class="i">+                    nullable: true,
</a><a href="#h113-1-78" id="h113-1-78" class="i">+                    default: Some(
</a><a href="#h113-1-79" id="h113-1-79" class="i">+                        Null,
</a><a href="#h113-1-80" id="h113-1-80" class="i">+                    ),
</a><a href="#h113-1-81" id="h113-1-81" class="i">+                    unique: false,
</a><a href="#h113-1-82" id="h113-1-82" class="i">+                    references: None,
</a><a href="#h113-1-83" id="h113-1-83" class="i">+                    index: false,
</a><a href="#h113-1-84" id="h113-1-84" class="i">+                },
</a><a href="#h113-1-85" id="h113-1-85" class="i">+            ],
</a><a href="#h113-1-86" id="h113-1-86" class="i">+        },
</a>         alias: None,
         filter: Some(
             Constant(
<b>diff --git a/<a id="h114" href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a> b/<a href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a></b>
<a href="#h114-0" id="h114-0" class="h">@@ -58,13 +58,119 @@ Plan: Select(
</a>     Filter {
         source: NestedLoopJoin {
             left: Scan {
<a href="#h114-0-3" id="h114-0-3" class="d">-                table: &quot;movies&quot;,
</a><a href="#h114-0-4" id="h114-0-4" class="i">+                table: Table {
</a><a href="#h114-0-5" id="h114-0-5" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h114-0-6" id="h114-0-6" class="i">+                    columns: [
</a><a href="#h114-0-7" id="h114-0-7" class="i">+                        Column {
</a><a href="#h114-0-8" id="h114-0-8" class="i">+                            name: &quot;id&quot;,
</a><a href="#h114-0-9" id="h114-0-9" class="i">+                            datatype: Integer,
</a><a href="#h114-0-10" id="h114-0-10" class="i">+                            primary_key: true,
</a><a href="#h114-0-11" id="h114-0-11" class="i">+                            nullable: false,
</a><a href="#h114-0-12" id="h114-0-12" class="i">+                            default: None,
</a><a href="#h114-0-13" id="h114-0-13" class="i">+                            unique: true,
</a><a href="#h114-0-14" id="h114-0-14" class="i">+                            references: None,
</a><a href="#h114-0-15" id="h114-0-15" class="i">+                            index: false,
</a><a href="#h114-0-16" id="h114-0-16" class="i">+                        },
</a><a href="#h114-0-17" id="h114-0-17" class="i">+                        Column {
</a><a href="#h114-0-18" id="h114-0-18" class="i">+                            name: &quot;title&quot;,
</a><a href="#h114-0-19" id="h114-0-19" class="i">+                            datatype: String,
</a><a href="#h114-0-20" id="h114-0-20" class="i">+                            primary_key: false,
</a><a href="#h114-0-21" id="h114-0-21" class="i">+                            nullable: false,
</a><a href="#h114-0-22" id="h114-0-22" class="i">+                            default: None,
</a><a href="#h114-0-23" id="h114-0-23" class="i">+                            unique: false,
</a><a href="#h114-0-24" id="h114-0-24" class="i">+                            references: None,
</a><a href="#h114-0-25" id="h114-0-25" class="i">+                            index: false,
</a><a href="#h114-0-26" id="h114-0-26" class="i">+                        },
</a><a href="#h114-0-27" id="h114-0-27" class="i">+                        Column {
</a><a href="#h114-0-28" id="h114-0-28" class="i">+                            name: &quot;studio_id&quot;,
</a><a href="#h114-0-29" id="h114-0-29" class="i">+                            datatype: Integer,
</a><a href="#h114-0-30" id="h114-0-30" class="i">+                            primary_key: false,
</a><a href="#h114-0-31" id="h114-0-31" class="i">+                            nullable: false,
</a><a href="#h114-0-32" id="h114-0-32" class="i">+                            default: None,
</a><a href="#h114-0-33" id="h114-0-33" class="i">+                            unique: false,
</a><a href="#h114-0-34" id="h114-0-34" class="i">+                            references: Some(
</a><a href="#h114-0-35" id="h114-0-35" class="i">+                                &quot;studios&quot;,
</a><a href="#h114-0-36" id="h114-0-36" class="i">+                            ),
</a><a href="#h114-0-37" id="h114-0-37" class="i">+                            index: true,
</a><a href="#h114-0-38" id="h114-0-38" class="i">+                        },
</a><a href="#h114-0-39" id="h114-0-39" class="i">+                        Column {
</a><a href="#h114-0-40" id="h114-0-40" class="i">+                            name: &quot;genre_id&quot;,
</a><a href="#h114-0-41" id="h114-0-41" class="i">+                            datatype: Integer,
</a><a href="#h114-0-42" id="h114-0-42" class="i">+                            primary_key: false,
</a><a href="#h114-0-43" id="h114-0-43" class="i">+                            nullable: false,
</a><a href="#h114-0-44" id="h114-0-44" class="i">+                            default: None,
</a><a href="#h114-0-45" id="h114-0-45" class="i">+                            unique: false,
</a><a href="#h114-0-46" id="h114-0-46" class="i">+                            references: Some(
</a><a href="#h114-0-47" id="h114-0-47" class="i">+                                &quot;genres&quot;,
</a><a href="#h114-0-48" id="h114-0-48" class="i">+                            ),
</a><a href="#h114-0-49" id="h114-0-49" class="i">+                            index: true,
</a><a href="#h114-0-50" id="h114-0-50" class="i">+                        },
</a><a href="#h114-0-51" id="h114-0-51" class="i">+                        Column {
</a><a href="#h114-0-52" id="h114-0-52" class="i">+                            name: &quot;released&quot;,
</a><a href="#h114-0-53" id="h114-0-53" class="i">+                            datatype: Integer,
</a><a href="#h114-0-54" id="h114-0-54" class="i">+                            primary_key: false,
</a><a href="#h114-0-55" id="h114-0-55" class="i">+                            nullable: false,
</a><a href="#h114-0-56" id="h114-0-56" class="i">+                            default: None,
</a><a href="#h114-0-57" id="h114-0-57" class="i">+                            unique: false,
</a><a href="#h114-0-58" id="h114-0-58" class="i">+                            references: None,
</a><a href="#h114-0-59" id="h114-0-59" class="i">+                            index: false,
</a><a href="#h114-0-60" id="h114-0-60" class="i">+                        },
</a><a href="#h114-0-61" id="h114-0-61" class="i">+                        Column {
</a><a href="#h114-0-62" id="h114-0-62" class="i">+                            name: &quot;rating&quot;,
</a><a href="#h114-0-63" id="h114-0-63" class="i">+                            datatype: Float,
</a><a href="#h114-0-64" id="h114-0-64" class="i">+                            primary_key: false,
</a><a href="#h114-0-65" id="h114-0-65" class="i">+                            nullable: true,
</a><a href="#h114-0-66" id="h114-0-66" class="i">+                            default: Some(
</a><a href="#h114-0-67" id="h114-0-67" class="i">+                                Null,
</a><a href="#h114-0-68" id="h114-0-68" class="i">+                            ),
</a><a href="#h114-0-69" id="h114-0-69" class="i">+                            unique: false,
</a><a href="#h114-0-70" id="h114-0-70" class="i">+                            references: None,
</a><a href="#h114-0-71" id="h114-0-71" class="i">+                            index: false,
</a><a href="#h114-0-72" id="h114-0-72" class="i">+                        },
</a><a href="#h114-0-73" id="h114-0-73" class="i">+                        Column {
</a><a href="#h114-0-74" id="h114-0-74" class="i">+                            name: &quot;ultrahd&quot;,
</a><a href="#h114-0-75" id="h114-0-75" class="i">+                            datatype: Boolean,
</a><a href="#h114-0-76" id="h114-0-76" class="i">+                            primary_key: false,
</a><a href="#h114-0-77" id="h114-0-77" class="i">+                            nullable: true,
</a><a href="#h114-0-78" id="h114-0-78" class="i">+                            default: Some(
</a><a href="#h114-0-79" id="h114-0-79" class="i">+                                Null,
</a><a href="#h114-0-80" id="h114-0-80" class="i">+                            ),
</a><a href="#h114-0-81" id="h114-0-81" class="i">+                            unique: false,
</a><a href="#h114-0-82" id="h114-0-82" class="i">+                            references: None,
</a><a href="#h114-0-83" id="h114-0-83" class="i">+                            index: false,
</a><a href="#h114-0-84" id="h114-0-84" class="i">+                        },
</a><a href="#h114-0-85" id="h114-0-85" class="i">+                    ],
</a><a href="#h114-0-86" id="h114-0-86" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
             left_size: 7,
             right: Scan {
<a href="#h114-0-92" id="h114-0-92" class="d">-                table: &quot;genres&quot;,
</a><a href="#h114-0-93" id="h114-0-93" class="i">+                table: Table {
</a><a href="#h114-0-94" id="h114-0-94" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h114-0-95" id="h114-0-95" class="i">+                    columns: [
</a><a href="#h114-0-96" id="h114-0-96" class="i">+                        Column {
</a><a href="#h114-0-97" id="h114-0-97" class="i">+                            name: &quot;id&quot;,
</a><a href="#h114-0-98" id="h114-0-98" class="i">+                            datatype: Integer,
</a><a href="#h114-0-99" id="h114-0-99" class="i">+                            primary_key: true,
</a><a href="#h114-0-100" id="h114-0-100" class="i">+                            nullable: false,
</a><a href="#h114-0-101" id="h114-0-101" class="i">+                            default: None,
</a><a href="#h114-0-102" id="h114-0-102" class="i">+                            unique: true,
</a><a href="#h114-0-103" id="h114-0-103" class="i">+                            references: None,
</a><a href="#h114-0-104" id="h114-0-104" class="i">+                            index: false,
</a><a href="#h114-0-105" id="h114-0-105" class="i">+                        },
</a><a href="#h114-0-106" id="h114-0-106" class="i">+                        Column {
</a><a href="#h114-0-107" id="h114-0-107" class="i">+                            name: &quot;name&quot;,
</a><a href="#h114-0-108" id="h114-0-108" class="i">+                            datatype: String,
</a><a href="#h114-0-109" id="h114-0-109" class="i">+                            primary_key: false,
</a><a href="#h114-0-110" id="h114-0-110" class="i">+                            nullable: false,
</a><a href="#h114-0-111" id="h114-0-111" class="i">+                            default: None,
</a><a href="#h114-0-112" id="h114-0-112" class="i">+                            unique: false,
</a><a href="#h114-0-113" id="h114-0-113" class="i">+                            references: None,
</a><a href="#h114-0-114" id="h114-0-114" class="i">+                            index: false,
</a><a href="#h114-0-115" id="h114-0-115" class="i">+                        },
</a><a href="#h114-0-116" id="h114-0-116" class="i">+                    ],
</a><a href="#h114-0-117" id="h114-0-117" class="i">+                },
</a>                 alias: None,
                 filter: None,
             },
<a href="#h114-1" id="h114-1" class="h">@@ -101,7 +207,89 @@ Plan: Select(
</a> Optimized plan: Select(
     HashJoin {
         left: Scan {
<a href="#h114-1-3" id="h114-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h114-1-4" id="h114-1-4" class="i">+            table: Table {
</a><a href="#h114-1-5" id="h114-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h114-1-6" id="h114-1-6" class="i">+                columns: [
</a><a href="#h114-1-7" id="h114-1-7" class="i">+                    Column {
</a><a href="#h114-1-8" id="h114-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h114-1-9" id="h114-1-9" class="i">+                        datatype: Integer,
</a><a href="#h114-1-10" id="h114-1-10" class="i">+                        primary_key: true,
</a><a href="#h114-1-11" id="h114-1-11" class="i">+                        nullable: false,
</a><a href="#h114-1-12" id="h114-1-12" class="i">+                        default: None,
</a><a href="#h114-1-13" id="h114-1-13" class="i">+                        unique: true,
</a><a href="#h114-1-14" id="h114-1-14" class="i">+                        references: None,
</a><a href="#h114-1-15" id="h114-1-15" class="i">+                        index: false,
</a><a href="#h114-1-16" id="h114-1-16" class="i">+                    },
</a><a href="#h114-1-17" id="h114-1-17" class="i">+                    Column {
</a><a href="#h114-1-18" id="h114-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h114-1-19" id="h114-1-19" class="i">+                        datatype: String,
</a><a href="#h114-1-20" id="h114-1-20" class="i">+                        primary_key: false,
</a><a href="#h114-1-21" id="h114-1-21" class="i">+                        nullable: false,
</a><a href="#h114-1-22" id="h114-1-22" class="i">+                        default: None,
</a><a href="#h114-1-23" id="h114-1-23" class="i">+                        unique: false,
</a><a href="#h114-1-24" id="h114-1-24" class="i">+                        references: None,
</a><a href="#h114-1-25" id="h114-1-25" class="i">+                        index: false,
</a><a href="#h114-1-26" id="h114-1-26" class="i">+                    },
</a><a href="#h114-1-27" id="h114-1-27" class="i">+                    Column {
</a><a href="#h114-1-28" id="h114-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h114-1-29" id="h114-1-29" class="i">+                        datatype: Integer,
</a><a href="#h114-1-30" id="h114-1-30" class="i">+                        primary_key: false,
</a><a href="#h114-1-31" id="h114-1-31" class="i">+                        nullable: false,
</a><a href="#h114-1-32" id="h114-1-32" class="i">+                        default: None,
</a><a href="#h114-1-33" id="h114-1-33" class="i">+                        unique: false,
</a><a href="#h114-1-34" id="h114-1-34" class="i">+                        references: Some(
</a><a href="#h114-1-35" id="h114-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h114-1-36" id="h114-1-36" class="i">+                        ),
</a><a href="#h114-1-37" id="h114-1-37" class="i">+                        index: true,
</a><a href="#h114-1-38" id="h114-1-38" class="i">+                    },
</a><a href="#h114-1-39" id="h114-1-39" class="i">+                    Column {
</a><a href="#h114-1-40" id="h114-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h114-1-41" id="h114-1-41" class="i">+                        datatype: Integer,
</a><a href="#h114-1-42" id="h114-1-42" class="i">+                        primary_key: false,
</a><a href="#h114-1-43" id="h114-1-43" class="i">+                        nullable: false,
</a><a href="#h114-1-44" id="h114-1-44" class="i">+                        default: None,
</a><a href="#h114-1-45" id="h114-1-45" class="i">+                        unique: false,
</a><a href="#h114-1-46" id="h114-1-46" class="i">+                        references: Some(
</a><a href="#h114-1-47" id="h114-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h114-1-48" id="h114-1-48" class="i">+                        ),
</a><a href="#h114-1-49" id="h114-1-49" class="i">+                        index: true,
</a><a href="#h114-1-50" id="h114-1-50" class="i">+                    },
</a><a href="#h114-1-51" id="h114-1-51" class="i">+                    Column {
</a><a href="#h114-1-52" id="h114-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h114-1-53" id="h114-1-53" class="i">+                        datatype: Integer,
</a><a href="#h114-1-54" id="h114-1-54" class="i">+                        primary_key: false,
</a><a href="#h114-1-55" id="h114-1-55" class="i">+                        nullable: false,
</a><a href="#h114-1-56" id="h114-1-56" class="i">+                        default: None,
</a><a href="#h114-1-57" id="h114-1-57" class="i">+                        unique: false,
</a><a href="#h114-1-58" id="h114-1-58" class="i">+                        references: None,
</a><a href="#h114-1-59" id="h114-1-59" class="i">+                        index: false,
</a><a href="#h114-1-60" id="h114-1-60" class="i">+                    },
</a><a href="#h114-1-61" id="h114-1-61" class="i">+                    Column {
</a><a href="#h114-1-62" id="h114-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h114-1-63" id="h114-1-63" class="i">+                        datatype: Float,
</a><a href="#h114-1-64" id="h114-1-64" class="i">+                        primary_key: false,
</a><a href="#h114-1-65" id="h114-1-65" class="i">+                        nullable: true,
</a><a href="#h114-1-66" id="h114-1-66" class="i">+                        default: Some(
</a><a href="#h114-1-67" id="h114-1-67" class="i">+                            Null,
</a><a href="#h114-1-68" id="h114-1-68" class="i">+                        ),
</a><a href="#h114-1-69" id="h114-1-69" class="i">+                        unique: false,
</a><a href="#h114-1-70" id="h114-1-70" class="i">+                        references: None,
</a><a href="#h114-1-71" id="h114-1-71" class="i">+                        index: false,
</a><a href="#h114-1-72" id="h114-1-72" class="i">+                    },
</a><a href="#h114-1-73" id="h114-1-73" class="i">+                    Column {
</a><a href="#h114-1-74" id="h114-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h114-1-75" id="h114-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h114-1-76" id="h114-1-76" class="i">+                        primary_key: false,
</a><a href="#h114-1-77" id="h114-1-77" class="i">+                        nullable: true,
</a><a href="#h114-1-78" id="h114-1-78" class="i">+                        default: Some(
</a><a href="#h114-1-79" id="h114-1-79" class="i">+                            Null,
</a><a href="#h114-1-80" id="h114-1-80" class="i">+                        ),
</a><a href="#h114-1-81" id="h114-1-81" class="i">+                        unique: false,
</a><a href="#h114-1-82" id="h114-1-82" class="i">+                        references: None,
</a><a href="#h114-1-83" id="h114-1-83" class="i">+                        index: false,
</a><a href="#h114-1-84" id="h114-1-84" class="i">+                    },
</a><a href="#h114-1-85" id="h114-1-85" class="i">+                ],
</a><a href="#h114-1-86" id="h114-1-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h114-2" id="h114-2" class="h">@@ -117,7 +305,31 @@ Optimized plan: Select(
</a>             ),
         ),
         right: Scan {
<a href="#h114-2-3" id="h114-2-3" class="d">-            table: &quot;genres&quot;,
</a><a href="#h114-2-4" id="h114-2-4" class="i">+            table: Table {
</a><a href="#h114-2-5" id="h114-2-5" class="i">+                name: &quot;genres&quot;,
</a><a href="#h114-2-6" id="h114-2-6" class="i">+                columns: [
</a><a href="#h114-2-7" id="h114-2-7" class="i">+                    Column {
</a><a href="#h114-2-8" id="h114-2-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h114-2-9" id="h114-2-9" class="i">+                        datatype: Integer,
</a><a href="#h114-2-10" id="h114-2-10" class="i">+                        primary_key: true,
</a><a href="#h114-2-11" id="h114-2-11" class="i">+                        nullable: false,
</a><a href="#h114-2-12" id="h114-2-12" class="i">+                        default: None,
</a><a href="#h114-2-13" id="h114-2-13" class="i">+                        unique: true,
</a><a href="#h114-2-14" id="h114-2-14" class="i">+                        references: None,
</a><a href="#h114-2-15" id="h114-2-15" class="i">+                        index: false,
</a><a href="#h114-2-16" id="h114-2-16" class="i">+                    },
</a><a href="#h114-2-17" id="h114-2-17" class="i">+                    Column {
</a><a href="#h114-2-18" id="h114-2-18" class="i">+                        name: &quot;name&quot;,
</a><a href="#h114-2-19" id="h114-2-19" class="i">+                        datatype: String,
</a><a href="#h114-2-20" id="h114-2-20" class="i">+                        primary_key: false,
</a><a href="#h114-2-21" id="h114-2-21" class="i">+                        nullable: false,
</a><a href="#h114-2-22" id="h114-2-22" class="i">+                        default: None,
</a><a href="#h114-2-23" id="h114-2-23" class="i">+                        unique: false,
</a><a href="#h114-2-24" id="h114-2-24" class="i">+                        references: None,
</a><a href="#h114-2-25" id="h114-2-25" class="i">+                        index: false,
</a><a href="#h114-2-26" id="h114-2-26" class="i">+                    },
</a><a href="#h114-2-27" id="h114-2-27" class="i">+                ],
</a><a href="#h114-2-28" id="h114-2-28" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<b>diff --git a/<a id="h115" href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a> b/<a href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a></b>
<a href="#h115-0" id="h115-0" class="h">@@ -28,7 +28,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h115-0-3" id="h115-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h115-0-4" id="h115-0-4" class="i">+            table: Table {
</a><a href="#h115-0-5" id="h115-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h115-0-6" id="h115-0-6" class="i">+                columns: [
</a><a href="#h115-0-7" id="h115-0-7" class="i">+                    Column {
</a><a href="#h115-0-8" id="h115-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h115-0-9" id="h115-0-9" class="i">+                        datatype: Integer,
</a><a href="#h115-0-10" id="h115-0-10" class="i">+                        primary_key: true,
</a><a href="#h115-0-11" id="h115-0-11" class="i">+                        nullable: false,
</a><a href="#h115-0-12" id="h115-0-12" class="i">+                        default: None,
</a><a href="#h115-0-13" id="h115-0-13" class="i">+                        unique: true,
</a><a href="#h115-0-14" id="h115-0-14" class="i">+                        references: None,
</a><a href="#h115-0-15" id="h115-0-15" class="i">+                        index: false,
</a><a href="#h115-0-16" id="h115-0-16" class="i">+                    },
</a><a href="#h115-0-17" id="h115-0-17" class="i">+                    Column {
</a><a href="#h115-0-18" id="h115-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h115-0-19" id="h115-0-19" class="i">+                        datatype: String,
</a><a href="#h115-0-20" id="h115-0-20" class="i">+                        primary_key: false,
</a><a href="#h115-0-21" id="h115-0-21" class="i">+                        nullable: false,
</a><a href="#h115-0-22" id="h115-0-22" class="i">+                        default: None,
</a><a href="#h115-0-23" id="h115-0-23" class="i">+                        unique: false,
</a><a href="#h115-0-24" id="h115-0-24" class="i">+                        references: None,
</a><a href="#h115-0-25" id="h115-0-25" class="i">+                        index: false,
</a><a href="#h115-0-26" id="h115-0-26" class="i">+                    },
</a><a href="#h115-0-27" id="h115-0-27" class="i">+                    Column {
</a><a href="#h115-0-28" id="h115-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h115-0-29" id="h115-0-29" class="i">+                        datatype: Integer,
</a><a href="#h115-0-30" id="h115-0-30" class="i">+                        primary_key: false,
</a><a href="#h115-0-31" id="h115-0-31" class="i">+                        nullable: false,
</a><a href="#h115-0-32" id="h115-0-32" class="i">+                        default: None,
</a><a href="#h115-0-33" id="h115-0-33" class="i">+                        unique: false,
</a><a href="#h115-0-34" id="h115-0-34" class="i">+                        references: Some(
</a><a href="#h115-0-35" id="h115-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h115-0-36" id="h115-0-36" class="i">+                        ),
</a><a href="#h115-0-37" id="h115-0-37" class="i">+                        index: true,
</a><a href="#h115-0-38" id="h115-0-38" class="i">+                    },
</a><a href="#h115-0-39" id="h115-0-39" class="i">+                    Column {
</a><a href="#h115-0-40" id="h115-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h115-0-41" id="h115-0-41" class="i">+                        datatype: Integer,
</a><a href="#h115-0-42" id="h115-0-42" class="i">+                        primary_key: false,
</a><a href="#h115-0-43" id="h115-0-43" class="i">+                        nullable: false,
</a><a href="#h115-0-44" id="h115-0-44" class="i">+                        default: None,
</a><a href="#h115-0-45" id="h115-0-45" class="i">+                        unique: false,
</a><a href="#h115-0-46" id="h115-0-46" class="i">+                        references: Some(
</a><a href="#h115-0-47" id="h115-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h115-0-48" id="h115-0-48" class="i">+                        ),
</a><a href="#h115-0-49" id="h115-0-49" class="i">+                        index: true,
</a><a href="#h115-0-50" id="h115-0-50" class="i">+                    },
</a><a href="#h115-0-51" id="h115-0-51" class="i">+                    Column {
</a><a href="#h115-0-52" id="h115-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h115-0-53" id="h115-0-53" class="i">+                        datatype: Integer,
</a><a href="#h115-0-54" id="h115-0-54" class="i">+                        primary_key: false,
</a><a href="#h115-0-55" id="h115-0-55" class="i">+                        nullable: false,
</a><a href="#h115-0-56" id="h115-0-56" class="i">+                        default: None,
</a><a href="#h115-0-57" id="h115-0-57" class="i">+                        unique: false,
</a><a href="#h115-0-58" id="h115-0-58" class="i">+                        references: None,
</a><a href="#h115-0-59" id="h115-0-59" class="i">+                        index: false,
</a><a href="#h115-0-60" id="h115-0-60" class="i">+                    },
</a><a href="#h115-0-61" id="h115-0-61" class="i">+                    Column {
</a><a href="#h115-0-62" id="h115-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h115-0-63" id="h115-0-63" class="i">+                        datatype: Float,
</a><a href="#h115-0-64" id="h115-0-64" class="i">+                        primary_key: false,
</a><a href="#h115-0-65" id="h115-0-65" class="i">+                        nullable: true,
</a><a href="#h115-0-66" id="h115-0-66" class="i">+                        default: Some(
</a><a href="#h115-0-67" id="h115-0-67" class="i">+                            Null,
</a><a href="#h115-0-68" id="h115-0-68" class="i">+                        ),
</a><a href="#h115-0-69" id="h115-0-69" class="i">+                        unique: false,
</a><a href="#h115-0-70" id="h115-0-70" class="i">+                        references: None,
</a><a href="#h115-0-71" id="h115-0-71" class="i">+                        index: false,
</a><a href="#h115-0-72" id="h115-0-72" class="i">+                    },
</a><a href="#h115-0-73" id="h115-0-73" class="i">+                    Column {
</a><a href="#h115-0-74" id="h115-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h115-0-75" id="h115-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h115-0-76" id="h115-0-76" class="i">+                        primary_key: false,
</a><a href="#h115-0-77" id="h115-0-77" class="i">+                        nullable: true,
</a><a href="#h115-0-78" id="h115-0-78" class="i">+                        default: Some(
</a><a href="#h115-0-79" id="h115-0-79" class="i">+                            Null,
</a><a href="#h115-0-80" id="h115-0-80" class="i">+                        ),
</a><a href="#h115-0-81" id="h115-0-81" class="i">+                        unique: false,
</a><a href="#h115-0-82" id="h115-0-82" class="i">+                        references: None,
</a><a href="#h115-0-83" id="h115-0-83" class="i">+                        index: false,
</a><a href="#h115-0-84" id="h115-0-84" class="i">+                    },
</a><a href="#h115-0-85" id="h115-0-85" class="i">+                ],
</a><a href="#h115-0-86" id="h115-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h115-1" id="h115-1" class="h">@@ -40,7 +122,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     Scan {
<a href="#h115-1-3" id="h115-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h115-1-4" id="h115-1-4" class="i">+        table: Table {
</a><a href="#h115-1-5" id="h115-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h115-1-6" id="h115-1-6" class="i">+            columns: [
</a><a href="#h115-1-7" id="h115-1-7" class="i">+                Column {
</a><a href="#h115-1-8" id="h115-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h115-1-9" id="h115-1-9" class="i">+                    datatype: Integer,
</a><a href="#h115-1-10" id="h115-1-10" class="i">+                    primary_key: true,
</a><a href="#h115-1-11" id="h115-1-11" class="i">+                    nullable: false,
</a><a href="#h115-1-12" id="h115-1-12" class="i">+                    default: None,
</a><a href="#h115-1-13" id="h115-1-13" class="i">+                    unique: true,
</a><a href="#h115-1-14" id="h115-1-14" class="i">+                    references: None,
</a><a href="#h115-1-15" id="h115-1-15" class="i">+                    index: false,
</a><a href="#h115-1-16" id="h115-1-16" class="i">+                },
</a><a href="#h115-1-17" id="h115-1-17" class="i">+                Column {
</a><a href="#h115-1-18" id="h115-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h115-1-19" id="h115-1-19" class="i">+                    datatype: String,
</a><a href="#h115-1-20" id="h115-1-20" class="i">+                    primary_key: false,
</a><a href="#h115-1-21" id="h115-1-21" class="i">+                    nullable: false,
</a><a href="#h115-1-22" id="h115-1-22" class="i">+                    default: None,
</a><a href="#h115-1-23" id="h115-1-23" class="i">+                    unique: false,
</a><a href="#h115-1-24" id="h115-1-24" class="i">+                    references: None,
</a><a href="#h115-1-25" id="h115-1-25" class="i">+                    index: false,
</a><a href="#h115-1-26" id="h115-1-26" class="i">+                },
</a><a href="#h115-1-27" id="h115-1-27" class="i">+                Column {
</a><a href="#h115-1-28" id="h115-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h115-1-29" id="h115-1-29" class="i">+                    datatype: Integer,
</a><a href="#h115-1-30" id="h115-1-30" class="i">+                    primary_key: false,
</a><a href="#h115-1-31" id="h115-1-31" class="i">+                    nullable: false,
</a><a href="#h115-1-32" id="h115-1-32" class="i">+                    default: None,
</a><a href="#h115-1-33" id="h115-1-33" class="i">+                    unique: false,
</a><a href="#h115-1-34" id="h115-1-34" class="i">+                    references: Some(
</a><a href="#h115-1-35" id="h115-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h115-1-36" id="h115-1-36" class="i">+                    ),
</a><a href="#h115-1-37" id="h115-1-37" class="i">+                    index: true,
</a><a href="#h115-1-38" id="h115-1-38" class="i">+                },
</a><a href="#h115-1-39" id="h115-1-39" class="i">+                Column {
</a><a href="#h115-1-40" id="h115-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h115-1-41" id="h115-1-41" class="i">+                    datatype: Integer,
</a><a href="#h115-1-42" id="h115-1-42" class="i">+                    primary_key: false,
</a><a href="#h115-1-43" id="h115-1-43" class="i">+                    nullable: false,
</a><a href="#h115-1-44" id="h115-1-44" class="i">+                    default: None,
</a><a href="#h115-1-45" id="h115-1-45" class="i">+                    unique: false,
</a><a href="#h115-1-46" id="h115-1-46" class="i">+                    references: Some(
</a><a href="#h115-1-47" id="h115-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h115-1-48" id="h115-1-48" class="i">+                    ),
</a><a href="#h115-1-49" id="h115-1-49" class="i">+                    index: true,
</a><a href="#h115-1-50" id="h115-1-50" class="i">+                },
</a><a href="#h115-1-51" id="h115-1-51" class="i">+                Column {
</a><a href="#h115-1-52" id="h115-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h115-1-53" id="h115-1-53" class="i">+                    datatype: Integer,
</a><a href="#h115-1-54" id="h115-1-54" class="i">+                    primary_key: false,
</a><a href="#h115-1-55" id="h115-1-55" class="i">+                    nullable: false,
</a><a href="#h115-1-56" id="h115-1-56" class="i">+                    default: None,
</a><a href="#h115-1-57" id="h115-1-57" class="i">+                    unique: false,
</a><a href="#h115-1-58" id="h115-1-58" class="i">+                    references: None,
</a><a href="#h115-1-59" id="h115-1-59" class="i">+                    index: false,
</a><a href="#h115-1-60" id="h115-1-60" class="i">+                },
</a><a href="#h115-1-61" id="h115-1-61" class="i">+                Column {
</a><a href="#h115-1-62" id="h115-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h115-1-63" id="h115-1-63" class="i">+                    datatype: Float,
</a><a href="#h115-1-64" id="h115-1-64" class="i">+                    primary_key: false,
</a><a href="#h115-1-65" id="h115-1-65" class="i">+                    nullable: true,
</a><a href="#h115-1-66" id="h115-1-66" class="i">+                    default: Some(
</a><a href="#h115-1-67" id="h115-1-67" class="i">+                        Null,
</a><a href="#h115-1-68" id="h115-1-68" class="i">+                    ),
</a><a href="#h115-1-69" id="h115-1-69" class="i">+                    unique: false,
</a><a href="#h115-1-70" id="h115-1-70" class="i">+                    references: None,
</a><a href="#h115-1-71" id="h115-1-71" class="i">+                    index: false,
</a><a href="#h115-1-72" id="h115-1-72" class="i">+                },
</a><a href="#h115-1-73" id="h115-1-73" class="i">+                Column {
</a><a href="#h115-1-74" id="h115-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h115-1-75" id="h115-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h115-1-76" id="h115-1-76" class="i">+                    primary_key: false,
</a><a href="#h115-1-77" id="h115-1-77" class="i">+                    nullable: true,
</a><a href="#h115-1-78" id="h115-1-78" class="i">+                    default: Some(
</a><a href="#h115-1-79" id="h115-1-79" class="i">+                        Null,
</a><a href="#h115-1-80" id="h115-1-80" class="i">+                    ),
</a><a href="#h115-1-81" id="h115-1-81" class="i">+                    unique: false,
</a><a href="#h115-1-82" id="h115-1-82" class="i">+                    references: None,
</a><a href="#h115-1-83" id="h115-1-83" class="i">+                    index: false,
</a><a href="#h115-1-84" id="h115-1-84" class="i">+                },
</a><a href="#h115-1-85" id="h115-1-85" class="i">+            ],
</a><a href="#h115-1-86" id="h115-1-86" class="i">+        },
</a>         alias: None,
         filter: Some(
             Constant(
<b>diff --git a/<a id="h116" href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a> b/<a href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a></b>
<a href="#h116-0" id="h116-0" class="h">@@ -39,7 +39,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h116-0-3" id="h116-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h116-0-4" id="h116-0-4" class="i">+            table: Table {
</a><a href="#h116-0-5" id="h116-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h116-0-6" id="h116-0-6" class="i">+                columns: [
</a><a href="#h116-0-7" id="h116-0-7" class="i">+                    Column {
</a><a href="#h116-0-8" id="h116-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h116-0-9" id="h116-0-9" class="i">+                        datatype: Integer,
</a><a href="#h116-0-10" id="h116-0-10" class="i">+                        primary_key: true,
</a><a href="#h116-0-11" id="h116-0-11" class="i">+                        nullable: false,
</a><a href="#h116-0-12" id="h116-0-12" class="i">+                        default: None,
</a><a href="#h116-0-13" id="h116-0-13" class="i">+                        unique: true,
</a><a href="#h116-0-14" id="h116-0-14" class="i">+                        references: None,
</a><a href="#h116-0-15" id="h116-0-15" class="i">+                        index: false,
</a><a href="#h116-0-16" id="h116-0-16" class="i">+                    },
</a><a href="#h116-0-17" id="h116-0-17" class="i">+                    Column {
</a><a href="#h116-0-18" id="h116-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h116-0-19" id="h116-0-19" class="i">+                        datatype: String,
</a><a href="#h116-0-20" id="h116-0-20" class="i">+                        primary_key: false,
</a><a href="#h116-0-21" id="h116-0-21" class="i">+                        nullable: false,
</a><a href="#h116-0-22" id="h116-0-22" class="i">+                        default: None,
</a><a href="#h116-0-23" id="h116-0-23" class="i">+                        unique: false,
</a><a href="#h116-0-24" id="h116-0-24" class="i">+                        references: None,
</a><a href="#h116-0-25" id="h116-0-25" class="i">+                        index: false,
</a><a href="#h116-0-26" id="h116-0-26" class="i">+                    },
</a><a href="#h116-0-27" id="h116-0-27" class="i">+                    Column {
</a><a href="#h116-0-28" id="h116-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h116-0-29" id="h116-0-29" class="i">+                        datatype: Integer,
</a><a href="#h116-0-30" id="h116-0-30" class="i">+                        primary_key: false,
</a><a href="#h116-0-31" id="h116-0-31" class="i">+                        nullable: false,
</a><a href="#h116-0-32" id="h116-0-32" class="i">+                        default: None,
</a><a href="#h116-0-33" id="h116-0-33" class="i">+                        unique: false,
</a><a href="#h116-0-34" id="h116-0-34" class="i">+                        references: Some(
</a><a href="#h116-0-35" id="h116-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h116-0-36" id="h116-0-36" class="i">+                        ),
</a><a href="#h116-0-37" id="h116-0-37" class="i">+                        index: true,
</a><a href="#h116-0-38" id="h116-0-38" class="i">+                    },
</a><a href="#h116-0-39" id="h116-0-39" class="i">+                    Column {
</a><a href="#h116-0-40" id="h116-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h116-0-41" id="h116-0-41" class="i">+                        datatype: Integer,
</a><a href="#h116-0-42" id="h116-0-42" class="i">+                        primary_key: false,
</a><a href="#h116-0-43" id="h116-0-43" class="i">+                        nullable: false,
</a><a href="#h116-0-44" id="h116-0-44" class="i">+                        default: None,
</a><a href="#h116-0-45" id="h116-0-45" class="i">+                        unique: false,
</a><a href="#h116-0-46" id="h116-0-46" class="i">+                        references: Some(
</a><a href="#h116-0-47" id="h116-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h116-0-48" id="h116-0-48" class="i">+                        ),
</a><a href="#h116-0-49" id="h116-0-49" class="i">+                        index: true,
</a><a href="#h116-0-50" id="h116-0-50" class="i">+                    },
</a><a href="#h116-0-51" id="h116-0-51" class="i">+                    Column {
</a><a href="#h116-0-52" id="h116-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h116-0-53" id="h116-0-53" class="i">+                        datatype: Integer,
</a><a href="#h116-0-54" id="h116-0-54" class="i">+                        primary_key: false,
</a><a href="#h116-0-55" id="h116-0-55" class="i">+                        nullable: false,
</a><a href="#h116-0-56" id="h116-0-56" class="i">+                        default: None,
</a><a href="#h116-0-57" id="h116-0-57" class="i">+                        unique: false,
</a><a href="#h116-0-58" id="h116-0-58" class="i">+                        references: None,
</a><a href="#h116-0-59" id="h116-0-59" class="i">+                        index: false,
</a><a href="#h116-0-60" id="h116-0-60" class="i">+                    },
</a><a href="#h116-0-61" id="h116-0-61" class="i">+                    Column {
</a><a href="#h116-0-62" id="h116-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h116-0-63" id="h116-0-63" class="i">+                        datatype: Float,
</a><a href="#h116-0-64" id="h116-0-64" class="i">+                        primary_key: false,
</a><a href="#h116-0-65" id="h116-0-65" class="i">+                        nullable: true,
</a><a href="#h116-0-66" id="h116-0-66" class="i">+                        default: Some(
</a><a href="#h116-0-67" id="h116-0-67" class="i">+                            Null,
</a><a href="#h116-0-68" id="h116-0-68" class="i">+                        ),
</a><a href="#h116-0-69" id="h116-0-69" class="i">+                        unique: false,
</a><a href="#h116-0-70" id="h116-0-70" class="i">+                        references: None,
</a><a href="#h116-0-71" id="h116-0-71" class="i">+                        index: false,
</a><a href="#h116-0-72" id="h116-0-72" class="i">+                    },
</a><a href="#h116-0-73" id="h116-0-73" class="i">+                    Column {
</a><a href="#h116-0-74" id="h116-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h116-0-75" id="h116-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h116-0-76" id="h116-0-76" class="i">+                        primary_key: false,
</a><a href="#h116-0-77" id="h116-0-77" class="i">+                        nullable: true,
</a><a href="#h116-0-78" id="h116-0-78" class="i">+                        default: Some(
</a><a href="#h116-0-79" id="h116-0-79" class="i">+                            Null,
</a><a href="#h116-0-80" id="h116-0-80" class="i">+                        ),
</a><a href="#h116-0-81" id="h116-0-81" class="i">+                        unique: false,
</a><a href="#h116-0-82" id="h116-0-82" class="i">+                        references: None,
</a><a href="#h116-0-83" id="h116-0-83" class="i">+                        index: false,
</a><a href="#h116-0-84" id="h116-0-84" class="i">+                    },
</a><a href="#h116-0-85" id="h116-0-85" class="i">+                ],
</a><a href="#h116-0-86" id="h116-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h116-1" id="h116-1" class="h">@@ -64,7 +146,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     KeyLookup {
<a href="#h116-1-3" id="h116-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h116-1-4" id="h116-1-4" class="i">+        table: Table {
</a><a href="#h116-1-5" id="h116-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h116-1-6" id="h116-1-6" class="i">+            columns: [
</a><a href="#h116-1-7" id="h116-1-7" class="i">+                Column {
</a><a href="#h116-1-8" id="h116-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h116-1-9" id="h116-1-9" class="i">+                    datatype: Integer,
</a><a href="#h116-1-10" id="h116-1-10" class="i">+                    primary_key: true,
</a><a href="#h116-1-11" id="h116-1-11" class="i">+                    nullable: false,
</a><a href="#h116-1-12" id="h116-1-12" class="i">+                    default: None,
</a><a href="#h116-1-13" id="h116-1-13" class="i">+                    unique: true,
</a><a href="#h116-1-14" id="h116-1-14" class="i">+                    references: None,
</a><a href="#h116-1-15" id="h116-1-15" class="i">+                    index: false,
</a><a href="#h116-1-16" id="h116-1-16" class="i">+                },
</a><a href="#h116-1-17" id="h116-1-17" class="i">+                Column {
</a><a href="#h116-1-18" id="h116-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h116-1-19" id="h116-1-19" class="i">+                    datatype: String,
</a><a href="#h116-1-20" id="h116-1-20" class="i">+                    primary_key: false,
</a><a href="#h116-1-21" id="h116-1-21" class="i">+                    nullable: false,
</a><a href="#h116-1-22" id="h116-1-22" class="i">+                    default: None,
</a><a href="#h116-1-23" id="h116-1-23" class="i">+                    unique: false,
</a><a href="#h116-1-24" id="h116-1-24" class="i">+                    references: None,
</a><a href="#h116-1-25" id="h116-1-25" class="i">+                    index: false,
</a><a href="#h116-1-26" id="h116-1-26" class="i">+                },
</a><a href="#h116-1-27" id="h116-1-27" class="i">+                Column {
</a><a href="#h116-1-28" id="h116-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h116-1-29" id="h116-1-29" class="i">+                    datatype: Integer,
</a><a href="#h116-1-30" id="h116-1-30" class="i">+                    primary_key: false,
</a><a href="#h116-1-31" id="h116-1-31" class="i">+                    nullable: false,
</a><a href="#h116-1-32" id="h116-1-32" class="i">+                    default: None,
</a><a href="#h116-1-33" id="h116-1-33" class="i">+                    unique: false,
</a><a href="#h116-1-34" id="h116-1-34" class="i">+                    references: Some(
</a><a href="#h116-1-35" id="h116-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h116-1-36" id="h116-1-36" class="i">+                    ),
</a><a href="#h116-1-37" id="h116-1-37" class="i">+                    index: true,
</a><a href="#h116-1-38" id="h116-1-38" class="i">+                },
</a><a href="#h116-1-39" id="h116-1-39" class="i">+                Column {
</a><a href="#h116-1-40" id="h116-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h116-1-41" id="h116-1-41" class="i">+                    datatype: Integer,
</a><a href="#h116-1-42" id="h116-1-42" class="i">+                    primary_key: false,
</a><a href="#h116-1-43" id="h116-1-43" class="i">+                    nullable: false,
</a><a href="#h116-1-44" id="h116-1-44" class="i">+                    default: None,
</a><a href="#h116-1-45" id="h116-1-45" class="i">+                    unique: false,
</a><a href="#h116-1-46" id="h116-1-46" class="i">+                    references: Some(
</a><a href="#h116-1-47" id="h116-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h116-1-48" id="h116-1-48" class="i">+                    ),
</a><a href="#h116-1-49" id="h116-1-49" class="i">+                    index: true,
</a><a href="#h116-1-50" id="h116-1-50" class="i">+                },
</a><a href="#h116-1-51" id="h116-1-51" class="i">+                Column {
</a><a href="#h116-1-52" id="h116-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h116-1-53" id="h116-1-53" class="i">+                    datatype: Integer,
</a><a href="#h116-1-54" id="h116-1-54" class="i">+                    primary_key: false,
</a><a href="#h116-1-55" id="h116-1-55" class="i">+                    nullable: false,
</a><a href="#h116-1-56" id="h116-1-56" class="i">+                    default: None,
</a><a href="#h116-1-57" id="h116-1-57" class="i">+                    unique: false,
</a><a href="#h116-1-58" id="h116-1-58" class="i">+                    references: None,
</a><a href="#h116-1-59" id="h116-1-59" class="i">+                    index: false,
</a><a href="#h116-1-60" id="h116-1-60" class="i">+                },
</a><a href="#h116-1-61" id="h116-1-61" class="i">+                Column {
</a><a href="#h116-1-62" id="h116-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h116-1-63" id="h116-1-63" class="i">+                    datatype: Float,
</a><a href="#h116-1-64" id="h116-1-64" class="i">+                    primary_key: false,
</a><a href="#h116-1-65" id="h116-1-65" class="i">+                    nullable: true,
</a><a href="#h116-1-66" id="h116-1-66" class="i">+                    default: Some(
</a><a href="#h116-1-67" id="h116-1-67" class="i">+                        Null,
</a><a href="#h116-1-68" id="h116-1-68" class="i">+                    ),
</a><a href="#h116-1-69" id="h116-1-69" class="i">+                    unique: false,
</a><a href="#h116-1-70" id="h116-1-70" class="i">+                    references: None,
</a><a href="#h116-1-71" id="h116-1-71" class="i">+                    index: false,
</a><a href="#h116-1-72" id="h116-1-72" class="i">+                },
</a><a href="#h116-1-73" id="h116-1-73" class="i">+                Column {
</a><a href="#h116-1-74" id="h116-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h116-1-75" id="h116-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h116-1-76" id="h116-1-76" class="i">+                    primary_key: false,
</a><a href="#h116-1-77" id="h116-1-77" class="i">+                    nullable: true,
</a><a href="#h116-1-78" id="h116-1-78" class="i">+                    default: Some(
</a><a href="#h116-1-79" id="h116-1-79" class="i">+                        Null,
</a><a href="#h116-1-80" id="h116-1-80" class="i">+                    ),
</a><a href="#h116-1-81" id="h116-1-81" class="i">+                    unique: false,
</a><a href="#h116-1-82" id="h116-1-82" class="i">+                    references: None,
</a><a href="#h116-1-83" id="h116-1-83" class="i">+                    index: false,
</a><a href="#h116-1-84" id="h116-1-84" class="i">+                },
</a><a href="#h116-1-85" id="h116-1-85" class="i">+            ],
</a><a href="#h116-1-86" id="h116-1-86" class="i">+        },
</a>         alias: None,
         keys: [
             Integer(
<b>diff --git a/<a id="h117" href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a> b/<a href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a></b>
<a href="#h117-0" id="h117-0" class="h">@@ -75,7 +75,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h117-0-3" id="h117-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h117-0-4" id="h117-0-4" class="i">+            table: Table {
</a><a href="#h117-0-5" id="h117-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h117-0-6" id="h117-0-6" class="i">+                columns: [
</a><a href="#h117-0-7" id="h117-0-7" class="i">+                    Column {
</a><a href="#h117-0-8" id="h117-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h117-0-9" id="h117-0-9" class="i">+                        datatype: Integer,
</a><a href="#h117-0-10" id="h117-0-10" class="i">+                        primary_key: true,
</a><a href="#h117-0-11" id="h117-0-11" class="i">+                        nullable: false,
</a><a href="#h117-0-12" id="h117-0-12" class="i">+                        default: None,
</a><a href="#h117-0-13" id="h117-0-13" class="i">+                        unique: true,
</a><a href="#h117-0-14" id="h117-0-14" class="i">+                        references: None,
</a><a href="#h117-0-15" id="h117-0-15" class="i">+                        index: false,
</a><a href="#h117-0-16" id="h117-0-16" class="i">+                    },
</a><a href="#h117-0-17" id="h117-0-17" class="i">+                    Column {
</a><a href="#h117-0-18" id="h117-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h117-0-19" id="h117-0-19" class="i">+                        datatype: String,
</a><a href="#h117-0-20" id="h117-0-20" class="i">+                        primary_key: false,
</a><a href="#h117-0-21" id="h117-0-21" class="i">+                        nullable: false,
</a><a href="#h117-0-22" id="h117-0-22" class="i">+                        default: None,
</a><a href="#h117-0-23" id="h117-0-23" class="i">+                        unique: false,
</a><a href="#h117-0-24" id="h117-0-24" class="i">+                        references: None,
</a><a href="#h117-0-25" id="h117-0-25" class="i">+                        index: false,
</a><a href="#h117-0-26" id="h117-0-26" class="i">+                    },
</a><a href="#h117-0-27" id="h117-0-27" class="i">+                    Column {
</a><a href="#h117-0-28" id="h117-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h117-0-29" id="h117-0-29" class="i">+                        datatype: Integer,
</a><a href="#h117-0-30" id="h117-0-30" class="i">+                        primary_key: false,
</a><a href="#h117-0-31" id="h117-0-31" class="i">+                        nullable: false,
</a><a href="#h117-0-32" id="h117-0-32" class="i">+                        default: None,
</a><a href="#h117-0-33" id="h117-0-33" class="i">+                        unique: false,
</a><a href="#h117-0-34" id="h117-0-34" class="i">+                        references: Some(
</a><a href="#h117-0-35" id="h117-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h117-0-36" id="h117-0-36" class="i">+                        ),
</a><a href="#h117-0-37" id="h117-0-37" class="i">+                        index: true,
</a><a href="#h117-0-38" id="h117-0-38" class="i">+                    },
</a><a href="#h117-0-39" id="h117-0-39" class="i">+                    Column {
</a><a href="#h117-0-40" id="h117-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h117-0-41" id="h117-0-41" class="i">+                        datatype: Integer,
</a><a href="#h117-0-42" id="h117-0-42" class="i">+                        primary_key: false,
</a><a href="#h117-0-43" id="h117-0-43" class="i">+                        nullable: false,
</a><a href="#h117-0-44" id="h117-0-44" class="i">+                        default: None,
</a><a href="#h117-0-45" id="h117-0-45" class="i">+                        unique: false,
</a><a href="#h117-0-46" id="h117-0-46" class="i">+                        references: Some(
</a><a href="#h117-0-47" id="h117-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h117-0-48" id="h117-0-48" class="i">+                        ),
</a><a href="#h117-0-49" id="h117-0-49" class="i">+                        index: true,
</a><a href="#h117-0-50" id="h117-0-50" class="i">+                    },
</a><a href="#h117-0-51" id="h117-0-51" class="i">+                    Column {
</a><a href="#h117-0-52" id="h117-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h117-0-53" id="h117-0-53" class="i">+                        datatype: Integer,
</a><a href="#h117-0-54" id="h117-0-54" class="i">+                        primary_key: false,
</a><a href="#h117-0-55" id="h117-0-55" class="i">+                        nullable: false,
</a><a href="#h117-0-56" id="h117-0-56" class="i">+                        default: None,
</a><a href="#h117-0-57" id="h117-0-57" class="i">+                        unique: false,
</a><a href="#h117-0-58" id="h117-0-58" class="i">+                        references: None,
</a><a href="#h117-0-59" id="h117-0-59" class="i">+                        index: false,
</a><a href="#h117-0-60" id="h117-0-60" class="i">+                    },
</a><a href="#h117-0-61" id="h117-0-61" class="i">+                    Column {
</a><a href="#h117-0-62" id="h117-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h117-0-63" id="h117-0-63" class="i">+                        datatype: Float,
</a><a href="#h117-0-64" id="h117-0-64" class="i">+                        primary_key: false,
</a><a href="#h117-0-65" id="h117-0-65" class="i">+                        nullable: true,
</a><a href="#h117-0-66" id="h117-0-66" class="i">+                        default: Some(
</a><a href="#h117-0-67" id="h117-0-67" class="i">+                            Null,
</a><a href="#h117-0-68" id="h117-0-68" class="i">+                        ),
</a><a href="#h117-0-69" id="h117-0-69" class="i">+                        unique: false,
</a><a href="#h117-0-70" id="h117-0-70" class="i">+                        references: None,
</a><a href="#h117-0-71" id="h117-0-71" class="i">+                        index: false,
</a><a href="#h117-0-72" id="h117-0-72" class="i">+                    },
</a><a href="#h117-0-73" id="h117-0-73" class="i">+                    Column {
</a><a href="#h117-0-74" id="h117-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h117-0-75" id="h117-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h117-0-76" id="h117-0-76" class="i">+                        primary_key: false,
</a><a href="#h117-0-77" id="h117-0-77" class="i">+                        nullable: true,
</a><a href="#h117-0-78" id="h117-0-78" class="i">+                        default: Some(
</a><a href="#h117-0-79" id="h117-0-79" class="i">+                            Null,
</a><a href="#h117-0-80" id="h117-0-80" class="i">+                        ),
</a><a href="#h117-0-81" id="h117-0-81" class="i">+                        unique: false,
</a><a href="#h117-0-82" id="h117-0-82" class="i">+                        references: None,
</a><a href="#h117-0-83" id="h117-0-83" class="i">+                        index: false,
</a><a href="#h117-0-84" id="h117-0-84" class="i">+                    },
</a><a href="#h117-0-85" id="h117-0-85" class="i">+                ],
</a><a href="#h117-0-86" id="h117-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h117-1" id="h117-1" class="h">@@ -136,7 +218,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     KeyLookup {
<a href="#h117-1-3" id="h117-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h117-1-4" id="h117-1-4" class="i">+        table: Table {
</a><a href="#h117-1-5" id="h117-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h117-1-6" id="h117-1-6" class="i">+            columns: [
</a><a href="#h117-1-7" id="h117-1-7" class="i">+                Column {
</a><a href="#h117-1-8" id="h117-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h117-1-9" id="h117-1-9" class="i">+                    datatype: Integer,
</a><a href="#h117-1-10" id="h117-1-10" class="i">+                    primary_key: true,
</a><a href="#h117-1-11" id="h117-1-11" class="i">+                    nullable: false,
</a><a href="#h117-1-12" id="h117-1-12" class="i">+                    default: None,
</a><a href="#h117-1-13" id="h117-1-13" class="i">+                    unique: true,
</a><a href="#h117-1-14" id="h117-1-14" class="i">+                    references: None,
</a><a href="#h117-1-15" id="h117-1-15" class="i">+                    index: false,
</a><a href="#h117-1-16" id="h117-1-16" class="i">+                },
</a><a href="#h117-1-17" id="h117-1-17" class="i">+                Column {
</a><a href="#h117-1-18" id="h117-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h117-1-19" id="h117-1-19" class="i">+                    datatype: String,
</a><a href="#h117-1-20" id="h117-1-20" class="i">+                    primary_key: false,
</a><a href="#h117-1-21" id="h117-1-21" class="i">+                    nullable: false,
</a><a href="#h117-1-22" id="h117-1-22" class="i">+                    default: None,
</a><a href="#h117-1-23" id="h117-1-23" class="i">+                    unique: false,
</a><a href="#h117-1-24" id="h117-1-24" class="i">+                    references: None,
</a><a href="#h117-1-25" id="h117-1-25" class="i">+                    index: false,
</a><a href="#h117-1-26" id="h117-1-26" class="i">+                },
</a><a href="#h117-1-27" id="h117-1-27" class="i">+                Column {
</a><a href="#h117-1-28" id="h117-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h117-1-29" id="h117-1-29" class="i">+                    datatype: Integer,
</a><a href="#h117-1-30" id="h117-1-30" class="i">+                    primary_key: false,
</a><a href="#h117-1-31" id="h117-1-31" class="i">+                    nullable: false,
</a><a href="#h117-1-32" id="h117-1-32" class="i">+                    default: None,
</a><a href="#h117-1-33" id="h117-1-33" class="i">+                    unique: false,
</a><a href="#h117-1-34" id="h117-1-34" class="i">+                    references: Some(
</a><a href="#h117-1-35" id="h117-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h117-1-36" id="h117-1-36" class="i">+                    ),
</a><a href="#h117-1-37" id="h117-1-37" class="i">+                    index: true,
</a><a href="#h117-1-38" id="h117-1-38" class="i">+                },
</a><a href="#h117-1-39" id="h117-1-39" class="i">+                Column {
</a><a href="#h117-1-40" id="h117-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h117-1-41" id="h117-1-41" class="i">+                    datatype: Integer,
</a><a href="#h117-1-42" id="h117-1-42" class="i">+                    primary_key: false,
</a><a href="#h117-1-43" id="h117-1-43" class="i">+                    nullable: false,
</a><a href="#h117-1-44" id="h117-1-44" class="i">+                    default: None,
</a><a href="#h117-1-45" id="h117-1-45" class="i">+                    unique: false,
</a><a href="#h117-1-46" id="h117-1-46" class="i">+                    references: Some(
</a><a href="#h117-1-47" id="h117-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h117-1-48" id="h117-1-48" class="i">+                    ),
</a><a href="#h117-1-49" id="h117-1-49" class="i">+                    index: true,
</a><a href="#h117-1-50" id="h117-1-50" class="i">+                },
</a><a href="#h117-1-51" id="h117-1-51" class="i">+                Column {
</a><a href="#h117-1-52" id="h117-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h117-1-53" id="h117-1-53" class="i">+                    datatype: Integer,
</a><a href="#h117-1-54" id="h117-1-54" class="i">+                    primary_key: false,
</a><a href="#h117-1-55" id="h117-1-55" class="i">+                    nullable: false,
</a><a href="#h117-1-56" id="h117-1-56" class="i">+                    default: None,
</a><a href="#h117-1-57" id="h117-1-57" class="i">+                    unique: false,
</a><a href="#h117-1-58" id="h117-1-58" class="i">+                    references: None,
</a><a href="#h117-1-59" id="h117-1-59" class="i">+                    index: false,
</a><a href="#h117-1-60" id="h117-1-60" class="i">+                },
</a><a href="#h117-1-61" id="h117-1-61" class="i">+                Column {
</a><a href="#h117-1-62" id="h117-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h117-1-63" id="h117-1-63" class="i">+                    datatype: Float,
</a><a href="#h117-1-64" id="h117-1-64" class="i">+                    primary_key: false,
</a><a href="#h117-1-65" id="h117-1-65" class="i">+                    nullable: true,
</a><a href="#h117-1-66" id="h117-1-66" class="i">+                    default: Some(
</a><a href="#h117-1-67" id="h117-1-67" class="i">+                        Null,
</a><a href="#h117-1-68" id="h117-1-68" class="i">+                    ),
</a><a href="#h117-1-69" id="h117-1-69" class="i">+                    unique: false,
</a><a href="#h117-1-70" id="h117-1-70" class="i">+                    references: None,
</a><a href="#h117-1-71" id="h117-1-71" class="i">+                    index: false,
</a><a href="#h117-1-72" id="h117-1-72" class="i">+                },
</a><a href="#h117-1-73" id="h117-1-73" class="i">+                Column {
</a><a href="#h117-1-74" id="h117-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h117-1-75" id="h117-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h117-1-76" id="h117-1-76" class="i">+                    primary_key: false,
</a><a href="#h117-1-77" id="h117-1-77" class="i">+                    nullable: true,
</a><a href="#h117-1-78" id="h117-1-78" class="i">+                    default: Some(
</a><a href="#h117-1-79" id="h117-1-79" class="i">+                        Null,
</a><a href="#h117-1-80" id="h117-1-80" class="i">+                    ),
</a><a href="#h117-1-81" id="h117-1-81" class="i">+                    unique: false,
</a><a href="#h117-1-82" id="h117-1-82" class="i">+                    references: None,
</a><a href="#h117-1-83" id="h117-1-83" class="i">+                    index: false,
</a><a href="#h117-1-84" id="h117-1-84" class="i">+                },
</a><a href="#h117-1-85" id="h117-1-85" class="i">+            ],
</a><a href="#h117-1-86" id="h117-1-86" class="i">+        },
</a>         alias: None,
         keys: [
             Integer(
<b>diff --git a/<a id="h118" href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a> b/<a href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a></b>
<a href="#h118-0" id="h118-0" class="h">@@ -109,7 +109,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h118-0-3" id="h118-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h118-0-4" id="h118-0-4" class="i">+            table: Table {
</a><a href="#h118-0-5" id="h118-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h118-0-6" id="h118-0-6" class="i">+                columns: [
</a><a href="#h118-0-7" id="h118-0-7" class="i">+                    Column {
</a><a href="#h118-0-8" id="h118-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h118-0-9" id="h118-0-9" class="i">+                        datatype: Integer,
</a><a href="#h118-0-10" id="h118-0-10" class="i">+                        primary_key: true,
</a><a href="#h118-0-11" id="h118-0-11" class="i">+                        nullable: false,
</a><a href="#h118-0-12" id="h118-0-12" class="i">+                        default: None,
</a><a href="#h118-0-13" id="h118-0-13" class="i">+                        unique: true,
</a><a href="#h118-0-14" id="h118-0-14" class="i">+                        references: None,
</a><a href="#h118-0-15" id="h118-0-15" class="i">+                        index: false,
</a><a href="#h118-0-16" id="h118-0-16" class="i">+                    },
</a><a href="#h118-0-17" id="h118-0-17" class="i">+                    Column {
</a><a href="#h118-0-18" id="h118-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h118-0-19" id="h118-0-19" class="i">+                        datatype: String,
</a><a href="#h118-0-20" id="h118-0-20" class="i">+                        primary_key: false,
</a><a href="#h118-0-21" id="h118-0-21" class="i">+                        nullable: false,
</a><a href="#h118-0-22" id="h118-0-22" class="i">+                        default: None,
</a><a href="#h118-0-23" id="h118-0-23" class="i">+                        unique: false,
</a><a href="#h118-0-24" id="h118-0-24" class="i">+                        references: None,
</a><a href="#h118-0-25" id="h118-0-25" class="i">+                        index: false,
</a><a href="#h118-0-26" id="h118-0-26" class="i">+                    },
</a><a href="#h118-0-27" id="h118-0-27" class="i">+                    Column {
</a><a href="#h118-0-28" id="h118-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h118-0-29" id="h118-0-29" class="i">+                        datatype: Integer,
</a><a href="#h118-0-30" id="h118-0-30" class="i">+                        primary_key: false,
</a><a href="#h118-0-31" id="h118-0-31" class="i">+                        nullable: false,
</a><a href="#h118-0-32" id="h118-0-32" class="i">+                        default: None,
</a><a href="#h118-0-33" id="h118-0-33" class="i">+                        unique: false,
</a><a href="#h118-0-34" id="h118-0-34" class="i">+                        references: Some(
</a><a href="#h118-0-35" id="h118-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h118-0-36" id="h118-0-36" class="i">+                        ),
</a><a href="#h118-0-37" id="h118-0-37" class="i">+                        index: true,
</a><a href="#h118-0-38" id="h118-0-38" class="i">+                    },
</a><a href="#h118-0-39" id="h118-0-39" class="i">+                    Column {
</a><a href="#h118-0-40" id="h118-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h118-0-41" id="h118-0-41" class="i">+                        datatype: Integer,
</a><a href="#h118-0-42" id="h118-0-42" class="i">+                        primary_key: false,
</a><a href="#h118-0-43" id="h118-0-43" class="i">+                        nullable: false,
</a><a href="#h118-0-44" id="h118-0-44" class="i">+                        default: None,
</a><a href="#h118-0-45" id="h118-0-45" class="i">+                        unique: false,
</a><a href="#h118-0-46" id="h118-0-46" class="i">+                        references: Some(
</a><a href="#h118-0-47" id="h118-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h118-0-48" id="h118-0-48" class="i">+                        ),
</a><a href="#h118-0-49" id="h118-0-49" class="i">+                        index: true,
</a><a href="#h118-0-50" id="h118-0-50" class="i">+                    },
</a><a href="#h118-0-51" id="h118-0-51" class="i">+                    Column {
</a><a href="#h118-0-52" id="h118-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h118-0-53" id="h118-0-53" class="i">+                        datatype: Integer,
</a><a href="#h118-0-54" id="h118-0-54" class="i">+                        primary_key: false,
</a><a href="#h118-0-55" id="h118-0-55" class="i">+                        nullable: false,
</a><a href="#h118-0-56" id="h118-0-56" class="i">+                        default: None,
</a><a href="#h118-0-57" id="h118-0-57" class="i">+                        unique: false,
</a><a href="#h118-0-58" id="h118-0-58" class="i">+                        references: None,
</a><a href="#h118-0-59" id="h118-0-59" class="i">+                        index: false,
</a><a href="#h118-0-60" id="h118-0-60" class="i">+                    },
</a><a href="#h118-0-61" id="h118-0-61" class="i">+                    Column {
</a><a href="#h118-0-62" id="h118-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h118-0-63" id="h118-0-63" class="i">+                        datatype: Float,
</a><a href="#h118-0-64" id="h118-0-64" class="i">+                        primary_key: false,
</a><a href="#h118-0-65" id="h118-0-65" class="i">+                        nullable: true,
</a><a href="#h118-0-66" id="h118-0-66" class="i">+                        default: Some(
</a><a href="#h118-0-67" id="h118-0-67" class="i">+                            Null,
</a><a href="#h118-0-68" id="h118-0-68" class="i">+                        ),
</a><a href="#h118-0-69" id="h118-0-69" class="i">+                        unique: false,
</a><a href="#h118-0-70" id="h118-0-70" class="i">+                        references: None,
</a><a href="#h118-0-71" id="h118-0-71" class="i">+                        index: false,
</a><a href="#h118-0-72" id="h118-0-72" class="i">+                    },
</a><a href="#h118-0-73" id="h118-0-73" class="i">+                    Column {
</a><a href="#h118-0-74" id="h118-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h118-0-75" id="h118-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h118-0-76" id="h118-0-76" class="i">+                        primary_key: false,
</a><a href="#h118-0-77" id="h118-0-77" class="i">+                        nullable: true,
</a><a href="#h118-0-78" id="h118-0-78" class="i">+                        default: Some(
</a><a href="#h118-0-79" id="h118-0-79" class="i">+                            Null,
</a><a href="#h118-0-80" id="h118-0-80" class="i">+                        ),
</a><a href="#h118-0-81" id="h118-0-81" class="i">+                        unique: false,
</a><a href="#h118-0-82" id="h118-0-82" class="i">+                        references: None,
</a><a href="#h118-0-83" id="h118-0-83" class="i">+                        index: false,
</a><a href="#h118-0-84" id="h118-0-84" class="i">+                    },
</a><a href="#h118-0-85" id="h118-0-85" class="i">+                ],
</a><a href="#h118-0-86" id="h118-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h118-1" id="h118-1" class="h">@@ -207,7 +289,89 @@ Plan: Select(
</a> Optimized plan: Select(
     Filter {
         source: KeyLookup {
<a href="#h118-1-3" id="h118-1-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h118-1-4" id="h118-1-4" class="i">+            table: Table {
</a><a href="#h118-1-5" id="h118-1-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h118-1-6" id="h118-1-6" class="i">+                columns: [
</a><a href="#h118-1-7" id="h118-1-7" class="i">+                    Column {
</a><a href="#h118-1-8" id="h118-1-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h118-1-9" id="h118-1-9" class="i">+                        datatype: Integer,
</a><a href="#h118-1-10" id="h118-1-10" class="i">+                        primary_key: true,
</a><a href="#h118-1-11" id="h118-1-11" class="i">+                        nullable: false,
</a><a href="#h118-1-12" id="h118-1-12" class="i">+                        default: None,
</a><a href="#h118-1-13" id="h118-1-13" class="i">+                        unique: true,
</a><a href="#h118-1-14" id="h118-1-14" class="i">+                        references: None,
</a><a href="#h118-1-15" id="h118-1-15" class="i">+                        index: false,
</a><a href="#h118-1-16" id="h118-1-16" class="i">+                    },
</a><a href="#h118-1-17" id="h118-1-17" class="i">+                    Column {
</a><a href="#h118-1-18" id="h118-1-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h118-1-19" id="h118-1-19" class="i">+                        datatype: String,
</a><a href="#h118-1-20" id="h118-1-20" class="i">+                        primary_key: false,
</a><a href="#h118-1-21" id="h118-1-21" class="i">+                        nullable: false,
</a><a href="#h118-1-22" id="h118-1-22" class="i">+                        default: None,
</a><a href="#h118-1-23" id="h118-1-23" class="i">+                        unique: false,
</a><a href="#h118-1-24" id="h118-1-24" class="i">+                        references: None,
</a><a href="#h118-1-25" id="h118-1-25" class="i">+                        index: false,
</a><a href="#h118-1-26" id="h118-1-26" class="i">+                    },
</a><a href="#h118-1-27" id="h118-1-27" class="i">+                    Column {
</a><a href="#h118-1-28" id="h118-1-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h118-1-29" id="h118-1-29" class="i">+                        datatype: Integer,
</a><a href="#h118-1-30" id="h118-1-30" class="i">+                        primary_key: false,
</a><a href="#h118-1-31" id="h118-1-31" class="i">+                        nullable: false,
</a><a href="#h118-1-32" id="h118-1-32" class="i">+                        default: None,
</a><a href="#h118-1-33" id="h118-1-33" class="i">+                        unique: false,
</a><a href="#h118-1-34" id="h118-1-34" class="i">+                        references: Some(
</a><a href="#h118-1-35" id="h118-1-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h118-1-36" id="h118-1-36" class="i">+                        ),
</a><a href="#h118-1-37" id="h118-1-37" class="i">+                        index: true,
</a><a href="#h118-1-38" id="h118-1-38" class="i">+                    },
</a><a href="#h118-1-39" id="h118-1-39" class="i">+                    Column {
</a><a href="#h118-1-40" id="h118-1-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h118-1-41" id="h118-1-41" class="i">+                        datatype: Integer,
</a><a href="#h118-1-42" id="h118-1-42" class="i">+                        primary_key: false,
</a><a href="#h118-1-43" id="h118-1-43" class="i">+                        nullable: false,
</a><a href="#h118-1-44" id="h118-1-44" class="i">+                        default: None,
</a><a href="#h118-1-45" id="h118-1-45" class="i">+                        unique: false,
</a><a href="#h118-1-46" id="h118-1-46" class="i">+                        references: Some(
</a><a href="#h118-1-47" id="h118-1-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h118-1-48" id="h118-1-48" class="i">+                        ),
</a><a href="#h118-1-49" id="h118-1-49" class="i">+                        index: true,
</a><a href="#h118-1-50" id="h118-1-50" class="i">+                    },
</a><a href="#h118-1-51" id="h118-1-51" class="i">+                    Column {
</a><a href="#h118-1-52" id="h118-1-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h118-1-53" id="h118-1-53" class="i">+                        datatype: Integer,
</a><a href="#h118-1-54" id="h118-1-54" class="i">+                        primary_key: false,
</a><a href="#h118-1-55" id="h118-1-55" class="i">+                        nullable: false,
</a><a href="#h118-1-56" id="h118-1-56" class="i">+                        default: None,
</a><a href="#h118-1-57" id="h118-1-57" class="i">+                        unique: false,
</a><a href="#h118-1-58" id="h118-1-58" class="i">+                        references: None,
</a><a href="#h118-1-59" id="h118-1-59" class="i">+                        index: false,
</a><a href="#h118-1-60" id="h118-1-60" class="i">+                    },
</a><a href="#h118-1-61" id="h118-1-61" class="i">+                    Column {
</a><a href="#h118-1-62" id="h118-1-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h118-1-63" id="h118-1-63" class="i">+                        datatype: Float,
</a><a href="#h118-1-64" id="h118-1-64" class="i">+                        primary_key: false,
</a><a href="#h118-1-65" id="h118-1-65" class="i">+                        nullable: true,
</a><a href="#h118-1-66" id="h118-1-66" class="i">+                        default: Some(
</a><a href="#h118-1-67" id="h118-1-67" class="i">+                            Null,
</a><a href="#h118-1-68" id="h118-1-68" class="i">+                        ),
</a><a href="#h118-1-69" id="h118-1-69" class="i">+                        unique: false,
</a><a href="#h118-1-70" id="h118-1-70" class="i">+                        references: None,
</a><a href="#h118-1-71" id="h118-1-71" class="i">+                        index: false,
</a><a href="#h118-1-72" id="h118-1-72" class="i">+                    },
</a><a href="#h118-1-73" id="h118-1-73" class="i">+                    Column {
</a><a href="#h118-1-74" id="h118-1-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h118-1-75" id="h118-1-75" class="i">+                        datatype: Boolean,
</a><a href="#h118-1-76" id="h118-1-76" class="i">+                        primary_key: false,
</a><a href="#h118-1-77" id="h118-1-77" class="i">+                        nullable: true,
</a><a href="#h118-1-78" id="h118-1-78" class="i">+                        default: Some(
</a><a href="#h118-1-79" id="h118-1-79" class="i">+                            Null,
</a><a href="#h118-1-80" id="h118-1-80" class="i">+                        ),
</a><a href="#h118-1-81" id="h118-1-81" class="i">+                        unique: false,
</a><a href="#h118-1-82" id="h118-1-82" class="i">+                        references: None,
</a><a href="#h118-1-83" id="h118-1-83" class="i">+                        index: false,
</a><a href="#h118-1-84" id="h118-1-84" class="i">+                    },
</a><a href="#h118-1-85" id="h118-1-85" class="i">+                ],
</a><a href="#h118-1-86" id="h118-1-86" class="i">+            },
</a>             alias: None,
             keys: [
                 Integer(
<b>diff --git a/<a id="h119" href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a> b/<a href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a></b>
<a href="#h119-0" id="h119-0" class="h">@@ -30,7 +30,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h119-0-3" id="h119-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h119-0-4" id="h119-0-4" class="i">+            table: Table {
</a><a href="#h119-0-5" id="h119-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h119-0-6" id="h119-0-6" class="i">+                columns: [
</a><a href="#h119-0-7" id="h119-0-7" class="i">+                    Column {
</a><a href="#h119-0-8" id="h119-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h119-0-9" id="h119-0-9" class="i">+                        datatype: Integer,
</a><a href="#h119-0-10" id="h119-0-10" class="i">+                        primary_key: true,
</a><a href="#h119-0-11" id="h119-0-11" class="i">+                        nullable: false,
</a><a href="#h119-0-12" id="h119-0-12" class="i">+                        default: None,
</a><a href="#h119-0-13" id="h119-0-13" class="i">+                        unique: true,
</a><a href="#h119-0-14" id="h119-0-14" class="i">+                        references: None,
</a><a href="#h119-0-15" id="h119-0-15" class="i">+                        index: false,
</a><a href="#h119-0-16" id="h119-0-16" class="i">+                    },
</a><a href="#h119-0-17" id="h119-0-17" class="i">+                    Column {
</a><a href="#h119-0-18" id="h119-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h119-0-19" id="h119-0-19" class="i">+                        datatype: String,
</a><a href="#h119-0-20" id="h119-0-20" class="i">+                        primary_key: false,
</a><a href="#h119-0-21" id="h119-0-21" class="i">+                        nullable: false,
</a><a href="#h119-0-22" id="h119-0-22" class="i">+                        default: None,
</a><a href="#h119-0-23" id="h119-0-23" class="i">+                        unique: false,
</a><a href="#h119-0-24" id="h119-0-24" class="i">+                        references: None,
</a><a href="#h119-0-25" id="h119-0-25" class="i">+                        index: false,
</a><a href="#h119-0-26" id="h119-0-26" class="i">+                    },
</a><a href="#h119-0-27" id="h119-0-27" class="i">+                    Column {
</a><a href="#h119-0-28" id="h119-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h119-0-29" id="h119-0-29" class="i">+                        datatype: Integer,
</a><a href="#h119-0-30" id="h119-0-30" class="i">+                        primary_key: false,
</a><a href="#h119-0-31" id="h119-0-31" class="i">+                        nullable: false,
</a><a href="#h119-0-32" id="h119-0-32" class="i">+                        default: None,
</a><a href="#h119-0-33" id="h119-0-33" class="i">+                        unique: false,
</a><a href="#h119-0-34" id="h119-0-34" class="i">+                        references: Some(
</a><a href="#h119-0-35" id="h119-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h119-0-36" id="h119-0-36" class="i">+                        ),
</a><a href="#h119-0-37" id="h119-0-37" class="i">+                        index: true,
</a><a href="#h119-0-38" id="h119-0-38" class="i">+                    },
</a><a href="#h119-0-39" id="h119-0-39" class="i">+                    Column {
</a><a href="#h119-0-40" id="h119-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h119-0-41" id="h119-0-41" class="i">+                        datatype: Integer,
</a><a href="#h119-0-42" id="h119-0-42" class="i">+                        primary_key: false,
</a><a href="#h119-0-43" id="h119-0-43" class="i">+                        nullable: false,
</a><a href="#h119-0-44" id="h119-0-44" class="i">+                        default: None,
</a><a href="#h119-0-45" id="h119-0-45" class="i">+                        unique: false,
</a><a href="#h119-0-46" id="h119-0-46" class="i">+                        references: Some(
</a><a href="#h119-0-47" id="h119-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h119-0-48" id="h119-0-48" class="i">+                        ),
</a><a href="#h119-0-49" id="h119-0-49" class="i">+                        index: true,
</a><a href="#h119-0-50" id="h119-0-50" class="i">+                    },
</a><a href="#h119-0-51" id="h119-0-51" class="i">+                    Column {
</a><a href="#h119-0-52" id="h119-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h119-0-53" id="h119-0-53" class="i">+                        datatype: Integer,
</a><a href="#h119-0-54" id="h119-0-54" class="i">+                        primary_key: false,
</a><a href="#h119-0-55" id="h119-0-55" class="i">+                        nullable: false,
</a><a href="#h119-0-56" id="h119-0-56" class="i">+                        default: None,
</a><a href="#h119-0-57" id="h119-0-57" class="i">+                        unique: false,
</a><a href="#h119-0-58" id="h119-0-58" class="i">+                        references: None,
</a><a href="#h119-0-59" id="h119-0-59" class="i">+                        index: false,
</a><a href="#h119-0-60" id="h119-0-60" class="i">+                    },
</a><a href="#h119-0-61" id="h119-0-61" class="i">+                    Column {
</a><a href="#h119-0-62" id="h119-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h119-0-63" id="h119-0-63" class="i">+                        datatype: Float,
</a><a href="#h119-0-64" id="h119-0-64" class="i">+                        primary_key: false,
</a><a href="#h119-0-65" id="h119-0-65" class="i">+                        nullable: true,
</a><a href="#h119-0-66" id="h119-0-66" class="i">+                        default: Some(
</a><a href="#h119-0-67" id="h119-0-67" class="i">+                            Null,
</a><a href="#h119-0-68" id="h119-0-68" class="i">+                        ),
</a><a href="#h119-0-69" id="h119-0-69" class="i">+                        unique: false,
</a><a href="#h119-0-70" id="h119-0-70" class="i">+                        references: None,
</a><a href="#h119-0-71" id="h119-0-71" class="i">+                        index: false,
</a><a href="#h119-0-72" id="h119-0-72" class="i">+                    },
</a><a href="#h119-0-73" id="h119-0-73" class="i">+                    Column {
</a><a href="#h119-0-74" id="h119-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h119-0-75" id="h119-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h119-0-76" id="h119-0-76" class="i">+                        primary_key: false,
</a><a href="#h119-0-77" id="h119-0-77" class="i">+                        nullable: true,
</a><a href="#h119-0-78" id="h119-0-78" class="i">+                        default: Some(
</a><a href="#h119-0-79" id="h119-0-79" class="i">+                            Null,
</a><a href="#h119-0-80" id="h119-0-80" class="i">+                        ),
</a><a href="#h119-0-81" id="h119-0-81" class="i">+                        unique: false,
</a><a href="#h119-0-82" id="h119-0-82" class="i">+                        references: None,
</a><a href="#h119-0-83" id="h119-0-83" class="i">+                        index: false,
</a><a href="#h119-0-84" id="h119-0-84" class="i">+                    },
</a><a href="#h119-0-85" id="h119-0-85" class="i">+                ],
</a><a href="#h119-0-86" id="h119-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h119-1" id="h119-1" class="h">@@ -44,7 +126,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     Scan {
<a href="#h119-1-3" id="h119-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h119-1-4" id="h119-1-4" class="i">+        table: Table {
</a><a href="#h119-1-5" id="h119-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h119-1-6" id="h119-1-6" class="i">+            columns: [
</a><a href="#h119-1-7" id="h119-1-7" class="i">+                Column {
</a><a href="#h119-1-8" id="h119-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h119-1-9" id="h119-1-9" class="i">+                    datatype: Integer,
</a><a href="#h119-1-10" id="h119-1-10" class="i">+                    primary_key: true,
</a><a href="#h119-1-11" id="h119-1-11" class="i">+                    nullable: false,
</a><a href="#h119-1-12" id="h119-1-12" class="i">+                    default: None,
</a><a href="#h119-1-13" id="h119-1-13" class="i">+                    unique: true,
</a><a href="#h119-1-14" id="h119-1-14" class="i">+                    references: None,
</a><a href="#h119-1-15" id="h119-1-15" class="i">+                    index: false,
</a><a href="#h119-1-16" id="h119-1-16" class="i">+                },
</a><a href="#h119-1-17" id="h119-1-17" class="i">+                Column {
</a><a href="#h119-1-18" id="h119-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h119-1-19" id="h119-1-19" class="i">+                    datatype: String,
</a><a href="#h119-1-20" id="h119-1-20" class="i">+                    primary_key: false,
</a><a href="#h119-1-21" id="h119-1-21" class="i">+                    nullable: false,
</a><a href="#h119-1-22" id="h119-1-22" class="i">+                    default: None,
</a><a href="#h119-1-23" id="h119-1-23" class="i">+                    unique: false,
</a><a href="#h119-1-24" id="h119-1-24" class="i">+                    references: None,
</a><a href="#h119-1-25" id="h119-1-25" class="i">+                    index: false,
</a><a href="#h119-1-26" id="h119-1-26" class="i">+                },
</a><a href="#h119-1-27" id="h119-1-27" class="i">+                Column {
</a><a href="#h119-1-28" id="h119-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h119-1-29" id="h119-1-29" class="i">+                    datatype: Integer,
</a><a href="#h119-1-30" id="h119-1-30" class="i">+                    primary_key: false,
</a><a href="#h119-1-31" id="h119-1-31" class="i">+                    nullable: false,
</a><a href="#h119-1-32" id="h119-1-32" class="i">+                    default: None,
</a><a href="#h119-1-33" id="h119-1-33" class="i">+                    unique: false,
</a><a href="#h119-1-34" id="h119-1-34" class="i">+                    references: Some(
</a><a href="#h119-1-35" id="h119-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h119-1-36" id="h119-1-36" class="i">+                    ),
</a><a href="#h119-1-37" id="h119-1-37" class="i">+                    index: true,
</a><a href="#h119-1-38" id="h119-1-38" class="i">+                },
</a><a href="#h119-1-39" id="h119-1-39" class="i">+                Column {
</a><a href="#h119-1-40" id="h119-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h119-1-41" id="h119-1-41" class="i">+                    datatype: Integer,
</a><a href="#h119-1-42" id="h119-1-42" class="i">+                    primary_key: false,
</a><a href="#h119-1-43" id="h119-1-43" class="i">+                    nullable: false,
</a><a href="#h119-1-44" id="h119-1-44" class="i">+                    default: None,
</a><a href="#h119-1-45" id="h119-1-45" class="i">+                    unique: false,
</a><a href="#h119-1-46" id="h119-1-46" class="i">+                    references: Some(
</a><a href="#h119-1-47" id="h119-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h119-1-48" id="h119-1-48" class="i">+                    ),
</a><a href="#h119-1-49" id="h119-1-49" class="i">+                    index: true,
</a><a href="#h119-1-50" id="h119-1-50" class="i">+                },
</a><a href="#h119-1-51" id="h119-1-51" class="i">+                Column {
</a><a href="#h119-1-52" id="h119-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h119-1-53" id="h119-1-53" class="i">+                    datatype: Integer,
</a><a href="#h119-1-54" id="h119-1-54" class="i">+                    primary_key: false,
</a><a href="#h119-1-55" id="h119-1-55" class="i">+                    nullable: false,
</a><a href="#h119-1-56" id="h119-1-56" class="i">+                    default: None,
</a><a href="#h119-1-57" id="h119-1-57" class="i">+                    unique: false,
</a><a href="#h119-1-58" id="h119-1-58" class="i">+                    references: None,
</a><a href="#h119-1-59" id="h119-1-59" class="i">+                    index: false,
</a><a href="#h119-1-60" id="h119-1-60" class="i">+                },
</a><a href="#h119-1-61" id="h119-1-61" class="i">+                Column {
</a><a href="#h119-1-62" id="h119-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h119-1-63" id="h119-1-63" class="i">+                    datatype: Float,
</a><a href="#h119-1-64" id="h119-1-64" class="i">+                    primary_key: false,
</a><a href="#h119-1-65" id="h119-1-65" class="i">+                    nullable: true,
</a><a href="#h119-1-66" id="h119-1-66" class="i">+                    default: Some(
</a><a href="#h119-1-67" id="h119-1-67" class="i">+                        Null,
</a><a href="#h119-1-68" id="h119-1-68" class="i">+                    ),
</a><a href="#h119-1-69" id="h119-1-69" class="i">+                    unique: false,
</a><a href="#h119-1-70" id="h119-1-70" class="i">+                    references: None,
</a><a href="#h119-1-71" id="h119-1-71" class="i">+                    index: false,
</a><a href="#h119-1-72" id="h119-1-72" class="i">+                },
</a><a href="#h119-1-73" id="h119-1-73" class="i">+                Column {
</a><a href="#h119-1-74" id="h119-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h119-1-75" id="h119-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h119-1-76" id="h119-1-76" class="i">+                    primary_key: false,
</a><a href="#h119-1-77" id="h119-1-77" class="i">+                    nullable: true,
</a><a href="#h119-1-78" id="h119-1-78" class="i">+                    default: Some(
</a><a href="#h119-1-79" id="h119-1-79" class="i">+                        Null,
</a><a href="#h119-1-80" id="h119-1-80" class="i">+                    ),
</a><a href="#h119-1-81" id="h119-1-81" class="i">+                    unique: false,
</a><a href="#h119-1-82" id="h119-1-82" class="i">+                    references: None,
</a><a href="#h119-1-83" id="h119-1-83" class="i">+                    index: false,
</a><a href="#h119-1-84" id="h119-1-84" class="i">+                },
</a><a href="#h119-1-85" id="h119-1-85" class="i">+            ],
</a><a href="#h119-1-86" id="h119-1-86" class="i">+        },
</a>         alias: None,
         filter: Some(
             Constant(
<b>diff --git a/<a id="h120" href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a> b/<a href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a></b>
<a href="#h120-0" id="h120-0" class="h">@@ -40,7 +40,89 @@ AST: Select {
</a> Plan: Select(
     Filter {
         source: Scan {
<a href="#h120-0-3" id="h120-0-3" class="d">-            table: &quot;movies&quot;,
</a><a href="#h120-0-4" id="h120-0-4" class="i">+            table: Table {
</a><a href="#h120-0-5" id="h120-0-5" class="i">+                name: &quot;movies&quot;,
</a><a href="#h120-0-6" id="h120-0-6" class="i">+                columns: [
</a><a href="#h120-0-7" id="h120-0-7" class="i">+                    Column {
</a><a href="#h120-0-8" id="h120-0-8" class="i">+                        name: &quot;id&quot;,
</a><a href="#h120-0-9" id="h120-0-9" class="i">+                        datatype: Integer,
</a><a href="#h120-0-10" id="h120-0-10" class="i">+                        primary_key: true,
</a><a href="#h120-0-11" id="h120-0-11" class="i">+                        nullable: false,
</a><a href="#h120-0-12" id="h120-0-12" class="i">+                        default: None,
</a><a href="#h120-0-13" id="h120-0-13" class="i">+                        unique: true,
</a><a href="#h120-0-14" id="h120-0-14" class="i">+                        references: None,
</a><a href="#h120-0-15" id="h120-0-15" class="i">+                        index: false,
</a><a href="#h120-0-16" id="h120-0-16" class="i">+                    },
</a><a href="#h120-0-17" id="h120-0-17" class="i">+                    Column {
</a><a href="#h120-0-18" id="h120-0-18" class="i">+                        name: &quot;title&quot;,
</a><a href="#h120-0-19" id="h120-0-19" class="i">+                        datatype: String,
</a><a href="#h120-0-20" id="h120-0-20" class="i">+                        primary_key: false,
</a><a href="#h120-0-21" id="h120-0-21" class="i">+                        nullable: false,
</a><a href="#h120-0-22" id="h120-0-22" class="i">+                        default: None,
</a><a href="#h120-0-23" id="h120-0-23" class="i">+                        unique: false,
</a><a href="#h120-0-24" id="h120-0-24" class="i">+                        references: None,
</a><a href="#h120-0-25" id="h120-0-25" class="i">+                        index: false,
</a><a href="#h120-0-26" id="h120-0-26" class="i">+                    },
</a><a href="#h120-0-27" id="h120-0-27" class="i">+                    Column {
</a><a href="#h120-0-28" id="h120-0-28" class="i">+                        name: &quot;studio_id&quot;,
</a><a href="#h120-0-29" id="h120-0-29" class="i">+                        datatype: Integer,
</a><a href="#h120-0-30" id="h120-0-30" class="i">+                        primary_key: false,
</a><a href="#h120-0-31" id="h120-0-31" class="i">+                        nullable: false,
</a><a href="#h120-0-32" id="h120-0-32" class="i">+                        default: None,
</a><a href="#h120-0-33" id="h120-0-33" class="i">+                        unique: false,
</a><a href="#h120-0-34" id="h120-0-34" class="i">+                        references: Some(
</a><a href="#h120-0-35" id="h120-0-35" class="i">+                            &quot;studios&quot;,
</a><a href="#h120-0-36" id="h120-0-36" class="i">+                        ),
</a><a href="#h120-0-37" id="h120-0-37" class="i">+                        index: true,
</a><a href="#h120-0-38" id="h120-0-38" class="i">+                    },
</a><a href="#h120-0-39" id="h120-0-39" class="i">+                    Column {
</a><a href="#h120-0-40" id="h120-0-40" class="i">+                        name: &quot;genre_id&quot;,
</a><a href="#h120-0-41" id="h120-0-41" class="i">+                        datatype: Integer,
</a><a href="#h120-0-42" id="h120-0-42" class="i">+                        primary_key: false,
</a><a href="#h120-0-43" id="h120-0-43" class="i">+                        nullable: false,
</a><a href="#h120-0-44" id="h120-0-44" class="i">+                        default: None,
</a><a href="#h120-0-45" id="h120-0-45" class="i">+                        unique: false,
</a><a href="#h120-0-46" id="h120-0-46" class="i">+                        references: Some(
</a><a href="#h120-0-47" id="h120-0-47" class="i">+                            &quot;genres&quot;,
</a><a href="#h120-0-48" id="h120-0-48" class="i">+                        ),
</a><a href="#h120-0-49" id="h120-0-49" class="i">+                        index: true,
</a><a href="#h120-0-50" id="h120-0-50" class="i">+                    },
</a><a href="#h120-0-51" id="h120-0-51" class="i">+                    Column {
</a><a href="#h120-0-52" id="h120-0-52" class="i">+                        name: &quot;released&quot;,
</a><a href="#h120-0-53" id="h120-0-53" class="i">+                        datatype: Integer,
</a><a href="#h120-0-54" id="h120-0-54" class="i">+                        primary_key: false,
</a><a href="#h120-0-55" id="h120-0-55" class="i">+                        nullable: false,
</a><a href="#h120-0-56" id="h120-0-56" class="i">+                        default: None,
</a><a href="#h120-0-57" id="h120-0-57" class="i">+                        unique: false,
</a><a href="#h120-0-58" id="h120-0-58" class="i">+                        references: None,
</a><a href="#h120-0-59" id="h120-0-59" class="i">+                        index: false,
</a><a href="#h120-0-60" id="h120-0-60" class="i">+                    },
</a><a href="#h120-0-61" id="h120-0-61" class="i">+                    Column {
</a><a href="#h120-0-62" id="h120-0-62" class="i">+                        name: &quot;rating&quot;,
</a><a href="#h120-0-63" id="h120-0-63" class="i">+                        datatype: Float,
</a><a href="#h120-0-64" id="h120-0-64" class="i">+                        primary_key: false,
</a><a href="#h120-0-65" id="h120-0-65" class="i">+                        nullable: true,
</a><a href="#h120-0-66" id="h120-0-66" class="i">+                        default: Some(
</a><a href="#h120-0-67" id="h120-0-67" class="i">+                            Null,
</a><a href="#h120-0-68" id="h120-0-68" class="i">+                        ),
</a><a href="#h120-0-69" id="h120-0-69" class="i">+                        unique: false,
</a><a href="#h120-0-70" id="h120-0-70" class="i">+                        references: None,
</a><a href="#h120-0-71" id="h120-0-71" class="i">+                        index: false,
</a><a href="#h120-0-72" id="h120-0-72" class="i">+                    },
</a><a href="#h120-0-73" id="h120-0-73" class="i">+                    Column {
</a><a href="#h120-0-74" id="h120-0-74" class="i">+                        name: &quot;ultrahd&quot;,
</a><a href="#h120-0-75" id="h120-0-75" class="i">+                        datatype: Boolean,
</a><a href="#h120-0-76" id="h120-0-76" class="i">+                        primary_key: false,
</a><a href="#h120-0-77" id="h120-0-77" class="i">+                        nullable: true,
</a><a href="#h120-0-78" id="h120-0-78" class="i">+                        default: Some(
</a><a href="#h120-0-79" id="h120-0-79" class="i">+                            Null,
</a><a href="#h120-0-80" id="h120-0-80" class="i">+                        ),
</a><a href="#h120-0-81" id="h120-0-81" class="i">+                        unique: false,
</a><a href="#h120-0-82" id="h120-0-82" class="i">+                        references: None,
</a><a href="#h120-0-83" id="h120-0-83" class="i">+                        index: false,
</a><a href="#h120-0-84" id="h120-0-84" class="i">+                    },
</a><a href="#h120-0-85" id="h120-0-85" class="i">+                ],
</a><a href="#h120-0-86" id="h120-0-86" class="i">+            },
</a>             alias: None,
             filter: None,
         },
<a href="#h120-1" id="h120-1" class="h">@@ -54,7 +136,89 @@ Plan: Select(
</a> 
 Optimized plan: Select(
     Scan {
<a href="#h120-1-3" id="h120-1-3" class="d">-        table: &quot;movies&quot;,
</a><a href="#h120-1-4" id="h120-1-4" class="i">+        table: Table {
</a><a href="#h120-1-5" id="h120-1-5" class="i">+            name: &quot;movies&quot;,
</a><a href="#h120-1-6" id="h120-1-6" class="i">+            columns: [
</a><a href="#h120-1-7" id="h120-1-7" class="i">+                Column {
</a><a href="#h120-1-8" id="h120-1-8" class="i">+                    name: &quot;id&quot;,
</a><a href="#h120-1-9" id="h120-1-9" class="i">+                    datatype: Integer,
</a><a href="#h120-1-10" id="h120-1-10" class="i">+                    primary_key: true,
</a><a href="#h120-1-11" id="h120-1-11" class="i">+                    nullable: false,
</a><a href="#h120-1-12" id="h120-1-12" class="i">+                    default: None,
</a><a href="#h120-1-13" id="h120-1-13" class="i">+                    unique: true,
</a><a href="#h120-1-14" id="h120-1-14" class="i">+                    references: None,
</a><a href="#h120-1-15" id="h120-1-15" class="i">+                    index: false,
</a><a href="#h120-1-16" id="h120-1-16" class="i">+                },
</a><a href="#h120-1-17" id="h120-1-17" class="i">+                Column {
</a><a href="#h120-1-18" id="h120-1-18" class="i">+                    name: &quot;title&quot;,
</a><a href="#h120-1-19" id="h120-1-19" class="i">+                    datatype: String,
</a><a href="#h120-1-20" id="h120-1-20" class="i">+                    primary_key: false,
</a><a href="#h120-1-21" id="h120-1-21" class="i">+                    nullable: false,
</a><a href="#h120-1-22" id="h120-1-22" class="i">+                    default: None,
</a><a href="#h120-1-23" id="h120-1-23" class="i">+                    unique: false,
</a><a href="#h120-1-24" id="h120-1-24" class="i">+                    references: None,
</a><a href="#h120-1-25" id="h120-1-25" class="i">+                    index: false,
</a><a href="#h120-1-26" id="h120-1-26" class="i">+                },
</a><a href="#h120-1-27" id="h120-1-27" class="i">+                Column {
</a><a href="#h120-1-28" id="h120-1-28" class="i">+                    name: &quot;studio_id&quot;,
</a><a href="#h120-1-29" id="h120-1-29" class="i">+                    datatype: Integer,
</a><a href="#h120-1-30" id="h120-1-30" class="i">+                    primary_key: false,
</a><a href="#h120-1-31" id="h120-1-31" class="i">+                    nullable: false,
</a><a href="#h120-1-32" id="h120-1-32" class="i">+                    default: None,
</a><a href="#h120-1-33" id="h120-1-33" class="i">+                    unique: false,
</a><a href="#h120-1-34" id="h120-1-34" class="i">+                    references: Some(
</a><a href="#h120-1-35" id="h120-1-35" class="i">+                        &quot;studios&quot;,
</a><a href="#h120-1-36" id="h120-1-36" class="i">+                    ),
</a><a href="#h120-1-37" id="h120-1-37" class="i">+                    index: true,
</a><a href="#h120-1-38" id="h120-1-38" class="i">+                },
</a><a href="#h120-1-39" id="h120-1-39" class="i">+                Column {
</a><a href="#h120-1-40" id="h120-1-40" class="i">+                    name: &quot;genre_id&quot;,
</a><a href="#h120-1-41" id="h120-1-41" class="i">+                    datatype: Integer,
</a><a href="#h120-1-42" id="h120-1-42" class="i">+                    primary_key: false,
</a><a href="#h120-1-43" id="h120-1-43" class="i">+                    nullable: false,
</a><a href="#h120-1-44" id="h120-1-44" class="i">+                    default: None,
</a><a href="#h120-1-45" id="h120-1-45" class="i">+                    unique: false,
</a><a href="#h120-1-46" id="h120-1-46" class="i">+                    references: Some(
</a><a href="#h120-1-47" id="h120-1-47" class="i">+                        &quot;genres&quot;,
</a><a href="#h120-1-48" id="h120-1-48" class="i">+                    ),
</a><a href="#h120-1-49" id="h120-1-49" class="i">+                    index: true,
</a><a href="#h120-1-50" id="h120-1-50" class="i">+                },
</a><a href="#h120-1-51" id="h120-1-51" class="i">+                Column {
</a><a href="#h120-1-52" id="h120-1-52" class="i">+                    name: &quot;released&quot;,
</a><a href="#h120-1-53" id="h120-1-53" class="i">+                    datatype: Integer,
</a><a href="#h120-1-54" id="h120-1-54" class="i">+                    primary_key: false,
</a><a href="#h120-1-55" id="h120-1-55" class="i">+                    nullable: false,
</a><a href="#h120-1-56" id="h120-1-56" class="i">+                    default: None,
</a><a href="#h120-1-57" id="h120-1-57" class="i">+                    unique: false,
</a><a href="#h120-1-58" id="h120-1-58" class="i">+                    references: None,
</a><a href="#h120-1-59" id="h120-1-59" class="i">+                    index: false,
</a><a href="#h120-1-60" id="h120-1-60" class="i">+                },
</a><a href="#h120-1-61" id="h120-1-61" class="i">+                Column {
</a><a href="#h120-1-62" id="h120-1-62" class="i">+                    name: &quot;rating&quot;,
</a><a href="#h120-1-63" id="h120-1-63" class="i">+                    datatype: Float,
</a><a href="#h120-1-64" id="h120-1-64" class="i">+                    primary_key: false,
</a><a href="#h120-1-65" id="h120-1-65" class="i">+                    nullable: true,
</a><a href="#h120-1-66" id="h120-1-66" class="i">+                    default: Some(
</a><a href="#h120-1-67" id="h120-1-67" class="i">+                        Null,
</a><a href="#h120-1-68" id="h120-1-68" class="i">+                    ),
</a><a href="#h120-1-69" id="h120-1-69" class="i">+                    unique: false,
</a><a href="#h120-1-70" id="h120-1-70" class="i">+                    references: None,
</a><a href="#h120-1-71" id="h120-1-71" class="i">+                    index: false,
</a><a href="#h120-1-72" id="h120-1-72" class="i">+                },
</a><a href="#h120-1-73" id="h120-1-73" class="i">+                Column {
</a><a href="#h120-1-74" id="h120-1-74" class="i">+                    name: &quot;ultrahd&quot;,
</a><a href="#h120-1-75" id="h120-1-75" class="i">+                    datatype: Boolean,
</a><a href="#h120-1-76" id="h120-1-76" class="i">+                    primary_key: false,
</a><a href="#h120-1-77" id="h120-1-77" class="i">+                    nullable: true,
</a><a href="#h120-1-78" id="h120-1-78" class="i">+                    default: Some(
</a><a href="#h120-1-79" id="h120-1-79" class="i">+                        Null,
</a><a href="#h120-1-80" id="h120-1-80" class="i">+                    ),
</a><a href="#h120-1-81" id="h120-1-81" class="i">+                    unique: false,
</a><a href="#h120-1-82" id="h120-1-82" class="i">+                    references: None,
</a><a href="#h120-1-83" id="h120-1-83" class="i">+                    index: false,
</a><a href="#h120-1-84" id="h120-1-84" class="i">+                },
</a><a href="#h120-1-85" id="h120-1-85" class="i">+            ],
</a><a href="#h120-1-86" id="h120-1-86" class="i">+        },
</a>         alias: None,
         filter: Some(
             Constant(
</pre>
</div>
</body>
</html>
