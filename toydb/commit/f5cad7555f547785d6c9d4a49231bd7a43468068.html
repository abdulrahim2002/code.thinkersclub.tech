<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: added constant folding optimizer. - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/f5cad7555f547785d6c9d4a49231bd7a43468068.html">f5cad7555f547785d6c9d4a49231bd7a43468068</a>
<b>parent</b> <a href="../commit/c890565c559f3441ca1382b2065e9451562ae8ca.html">c890565c559f3441ca1382b2065e9451562ae8ca</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Wed, 18 Sep 2019 20:44:45 +0200

sql: added constant folding optimizer.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">README.md</a></td><td> | </td><td class="num">7</td><td><span class="i">+++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/server/toydb.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/expression.rs</a></td><td> | </td><td class="num">139</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/mod.rs</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h4">src/sql/optimizer/constant_folder.rs</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h5">src/sql/optimizer/mod.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/plan.rs</a></td><td> | </td><td class="num">102</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/testdata/create_table</a></td><td> | </td><td class="num">41</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/testdata/create_table_error_exists</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/testdata/create_table_single_column</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/testdata/delete_all</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/testdata/delete_error_table</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/sql/testdata/delete_where</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/sql/testdata/delete_where_false</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">src/sql/testdata/delete_where_null</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">src/sql/testdata/delete_where_true</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">src/sql/testdata/drop_table</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/sql/testdata/drop_table_error_missing</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">src/sql/testdata/expr_datatypes</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">src/sql/testdata/expr_literal_numbers</a></td><td> | </td><td class="num">64</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">src/sql/testdata/expr_literal_string_quotes</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">src/sql/testdata/insert_default_null</a></td><td> | </td><td class="num">31</td><td><span class="i">+++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">src/sql/testdata/insert_error_columns_duplicate</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">src/sql/testdata/insert_error_columns_mismatch</a></td><td> | </td><td class="num">23</td><td><span class="i">+++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">src/sql/testdata/insert_error_datatype_conflict</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">src/sql/testdata/insert_error_default_null_disallowed</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">src/sql/testdata/insert_error_null_disallowed</a></td><td> | </td><td class="num">19</td><td><span class="i">+++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">src/sql/testdata/insert_error_pk_exists</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">src/sql/testdata/insert_error_pk_null</a></td><td> | </td><td class="num">19</td><td><span class="i">+++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">src/sql/testdata/insert_expression</a></td><td> | </td><td class="num">41</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">src/sql/testdata/insert_partial</a></td><td> | </td><td class="num">42</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">src/sql/testdata/insert_values</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">src/sql/testdata/select_aliases</a></td><td> | </td><td class="num">32</td><td><span class="i">++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">src/sql/testdata/select_all_from_table</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">src/sql/testdata/select_error_where_nonboolean</a></td><td> | </td><td class="num">13</td><td><span class="i">+++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">src/sql/testdata/select_expr_where_false</a></td><td> | </td><td class="num">23</td><td><span class="i">+++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">src/sql/testdata/select_expr_where_true</a></td><td> | </td><td class="num">23</td><td><span class="i">+++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">src/sql/testdata/select_fields</a></td><td> | </td><td class="num">40</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">src/sql/testdata/select_limit</a></td><td> | </td><td class="num">19</td><td><span class="i">+++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">src/sql/testdata/select_limit_offset</a></td><td> | </td><td class="num">22</td><td><span class="i">++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">src/sql/testdata/select_offset</a></td><td> | </td><td class="num">19</td><td><span class="i">+++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">src/sql/testdata/select_order</a></td><td> | </td><td class="num">22</td><td><span class="i">++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">src/sql/testdata/select_order_projection</a></td><td> | </td><td class="num">39</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">src/sql/testdata/select_where</a></td><td> | </td><td class="num">30</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">src/sql/testdata/select_where_false</a></td><td> | </td><td class="num">13</td><td><span class="i">+++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">src/sql/testdata/select_where_null</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">src/sql/testdata/select_where_true</a></td><td> | </td><td class="num">13</td><td><span class="i">+++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">src/sql/testdata/update_all</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">src/sql/testdata/update_false</a></td><td> | </td><td class="num">23</td><td><span class="i">+++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">src/sql/testdata/update_where</a></td><td> | </td><td class="num">29</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">src/sql/tests.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++++</span><span class="d"></span></td></tr>
</table></pre><pre>51 files changed, 1252 insertions(+), 18 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/README.md.html">README.md</a> b/<a href="../file/README.md.html">README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -50,7 +50,7 @@ toydb&gt; SELECT * FROM movies
</a> 
 - [ ] **Transactions:** Self-written ACID-compliant transaction engine with MVCC-based serializable snapshot isolation.
 
<a href="#h0-0-3" id="h0-0-3" class="d">-- [ ] **Query Engine:** Self-written iterator-based engine with simple heuristic optimizer.
</a><a href="#h0-0-4" id="h0-0-4" class="i">+- [x] **Query Engine:** Self-written iterator-based engine with simple heuristic optimizer.
</a> 
 - [ ] **Language:** Self-written SQL parser with support for:
 
<a href="#h0-1" id="h0-1" class="h">@@ -60,7 +60,7 @@ toydb&gt; SELECT * FROM movies
</a>   - [x] `INSERT INTO ... (...) VALUES (...)`
   - [x] `UPDATE ... SET ... WHERE ...`
   - [x] `DELETE FROM ... WHERE ...`
<a href="#h0-1-3" id="h0-1-3" class="d">-  - [x] `SELECT ... FROM ... WHERE ... ORDER BY ...`
</a><a href="#h0-1-4" id="h0-1-4" class="i">+  - [x] `SELECT ... FROM ... WHERE ... ORDER BY ... LIMIT ... OFFSET ...`
</a>     - [ ] `GROUP BY ... HAVING ...`
     - [ ] `[INNER|LEFT|RIGHT|FULL|CROSS] JOIN`
   - [ ] `EXPLAIN SELECT ...`
<a href="#h0-2" id="h0-2" class="h">@@ -97,4 +97,4 @@ Below is an incomplete list of known issues preventing this from being a &quot;real&quot; 
</a> 
 * **Type checking:** query type checking (e.g. `SELECT a + b` must receive two numbers) is done at query evaluation time, not at query compile time.
 
<a href="#h0-2-3" id="h0-2-3" class="d">-* **Ordering:** it&#39;s only possible to order on output columns of the `SELECT` statement.
</a><a href="#h0-2-4" id="h0-2-4" class="d">-\ No newline at end of file
</a><a href="#h0-2-5" id="h0-2-5" class="i">+* **Ordering:** it&#39;s only possible to order on output columns of the `SELECT` statement.
</a><b>diff --git a/<a id="h1" href="../file/src/server/toydb.rs.html">src/server/toydb.rs</a> b/<a href="../file/src/server/toydb.rs.html">src/server/toydb.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -89,6 +89,7 @@ impl ToyDB {
</a>     /// Executes an SQL statement
     fn execute(&amp;self, query: &amp;str) -&gt; Result&lt;sql::types::ResultSet, Error&gt; {
         sql::Plan::build(sql::Parser::new(query).parse()?)?
<a href="#h1-0-3" id="h1-0-3" class="i">+            .optimize()?
</a>             .execute(sql::Context { storage: self.storage.clone() })
     }
 
<b>diff --git a/<a id="h2" href="../file/src/sql/expression.rs.html">src/sql/expression.rs</a> b/<a href="../file/src/sql/expression.rs.html">src/sql/expression.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -35,20 +35,6 @@ pub enum Expression {
</a> 
 pub type Expressions = Vec&lt;Expression&gt;;
 
<a href="#h2-0-3" id="h2-0-3" class="d">-pub struct Environment {
</a><a href="#h2-0-4" id="h2-0-4" class="d">-    fields: HashMap&lt;String, Value&gt;,
</a><a href="#h2-0-5" id="h2-0-5" class="d">-}
</a><a href="#h2-0-6" id="h2-0-6" class="d">-
</a><a href="#h2-0-7" id="h2-0-7" class="d">-impl Environment {
</a><a href="#h2-0-8" id="h2-0-8" class="d">-    pub fn new(fields: HashMap&lt;String, Value&gt;) -&gt; Self {
</a><a href="#h2-0-9" id="h2-0-9" class="d">-        Self { fields }
</a><a href="#h2-0-10" id="h2-0-10" class="d">-    }
</a><a href="#h2-0-11" id="h2-0-11" class="d">-
</a><a href="#h2-0-12" id="h2-0-12" class="d">-    pub fn empty() -&gt; Self {
</a><a href="#h2-0-13" id="h2-0-13" class="d">-        Self::new(HashMap::new())
</a><a href="#h2-0-14" id="h2-0-14" class="d">-    }
</a><a href="#h2-0-15" id="h2-0-15" class="d">-}
</a><a href="#h2-0-16" id="h2-0-16" class="d">-
</a> impl Expression {
     /// Evaluates an expression to a value
     pub fn evaluate(&amp;self, e: &amp;Environment) -&gt; Result&lt;Value, Error&gt; {
<a href="#h2-1" id="h2-1" class="h">@@ -200,4 +186,129 @@ impl Expression {
</a>             },
         })
     }
<a href="#h2-1-3" id="h2-1-3" class="i">+
</a><a href="#h2-1-4" id="h2-1-4" class="i">+    /// Checks whether the expression is constant
</a><a href="#h2-1-5" id="h2-1-5" class="i">+    pub fn is_constant(&amp;self) -&gt; bool {
</a><a href="#h2-1-6" id="h2-1-6" class="i">+        self.walk(&amp;|expr| match expr {
</a><a href="#h2-1-7" id="h2-1-7" class="i">+            Self::Field(_) =&gt; false,
</a><a href="#h2-1-8" id="h2-1-8" class="i">+            _ =&gt; true,
</a><a href="#h2-1-9" id="h2-1-9" class="i">+        })
</a><a href="#h2-1-10" id="h2-1-10" class="i">+    }
</a><a href="#h2-1-11" id="h2-1-11" class="i">+
</a><a href="#h2-1-12" id="h2-1-12" class="i">+    /// Transforms the expression tree, by applying a callback function to it
</a><a href="#h2-1-13" id="h2-1-13" class="i">+    /// before and/or after descending into it.
</a><a href="#h2-1-14" id="h2-1-14" class="i">+    pub fn transform&lt;B, A&gt;(mut self, pre: &amp;B, post: &amp;A) -&gt; Result&lt;Self, Error&gt;
</a><a href="#h2-1-15" id="h2-1-15" class="i">+    where
</a><a href="#h2-1-16" id="h2-1-16" class="i">+        B: Fn(Self) -&gt; Result&lt;Self, Error&gt;,
</a><a href="#h2-1-17" id="h2-1-17" class="i">+        A: Fn(Self) -&gt; Result&lt;Self, Error&gt;,
</a><a href="#h2-1-18" id="h2-1-18" class="i">+    {
</a><a href="#h2-1-19" id="h2-1-19" class="i">+        self = pre(self)?;
</a><a href="#h2-1-20" id="h2-1-20" class="i">+        // FIXME Ugly having to explicitly reconstruct each variant, but unable to
</a><a href="#h2-1-21" id="h2-1-21" class="i">+        // find a way to dynamically construct or update without changing signatures
</a><a href="#h2-1-22" id="h2-1-22" class="i">+        // to use mutable references over ownership.
</a><a href="#h2-1-23" id="h2-1-23" class="i">+        self = match self {
</a><a href="#h2-1-24" id="h2-1-24" class="i">+            // Constants
</a><a href="#h2-1-25" id="h2-1-25" class="i">+            node @ Self::Constant(_) | node @ Self::Field(_) =&gt; node,
</a><a href="#h2-1-26" id="h2-1-26" class="i">+
</a><a href="#h2-1-27" id="h2-1-27" class="i">+            // Logical operations
</a><a href="#h2-1-28" id="h2-1-28" class="i">+            Self::And(lhs, rhs) =&gt; {
</a><a href="#h2-1-29" id="h2-1-29" class="i">+                Self::And(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-30" id="h2-1-30" class="i">+            }
</a><a href="#h2-1-31" id="h2-1-31" class="i">+            Self::Not(expr) =&gt; Self::Not(expr.transform(pre, post)?.into()),
</a><a href="#h2-1-32" id="h2-1-32" class="i">+            Self::Or(lhs, rhs) =&gt; {
</a><a href="#h2-1-33" id="h2-1-33" class="i">+                Self::Or(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-34" id="h2-1-34" class="i">+            }
</a><a href="#h2-1-35" id="h2-1-35" class="i">+
</a><a href="#h2-1-36" id="h2-1-36" class="i">+            // Comparisons
</a><a href="#h2-1-37" id="h2-1-37" class="i">+            Self::CompareEQ(lhs, rhs) =&gt; {
</a><a href="#h2-1-38" id="h2-1-38" class="i">+                Self::CompareEQ(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-39" id="h2-1-39" class="i">+            }
</a><a href="#h2-1-40" id="h2-1-40" class="i">+            Self::CompareGT(lhs, rhs) =&gt; {
</a><a href="#h2-1-41" id="h2-1-41" class="i">+                Self::CompareGT(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-42" id="h2-1-42" class="i">+            }
</a><a href="#h2-1-43" id="h2-1-43" class="i">+            Self::CompareGTE(lhs, rhs) =&gt; {
</a><a href="#h2-1-44" id="h2-1-44" class="i">+                Self::CompareGTE(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-45" id="h2-1-45" class="i">+            }
</a><a href="#h2-1-46" id="h2-1-46" class="i">+            Self::CompareLT(lhs, rhs) =&gt; {
</a><a href="#h2-1-47" id="h2-1-47" class="i">+                Self::CompareLT(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-48" id="h2-1-48" class="i">+            }
</a><a href="#h2-1-49" id="h2-1-49" class="i">+            Self::CompareLTE(lhs, rhs) =&gt; {
</a><a href="#h2-1-50" id="h2-1-50" class="i">+                Self::CompareLTE(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-51" id="h2-1-51" class="i">+            }
</a><a href="#h2-1-52" id="h2-1-52" class="i">+            Self::CompareNE(lhs, rhs) =&gt; {
</a><a href="#h2-1-53" id="h2-1-53" class="i">+                Self::CompareNE(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-54" id="h2-1-54" class="i">+            }
</a><a href="#h2-1-55" id="h2-1-55" class="i">+
</a><a href="#h2-1-56" id="h2-1-56" class="i">+            // Mathematical operations
</a><a href="#h2-1-57" id="h2-1-57" class="i">+            Self::Add(lhs, rhs) =&gt; {
</a><a href="#h2-1-58" id="h2-1-58" class="i">+                Self::Add(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-59" id="h2-1-59" class="i">+            }
</a><a href="#h2-1-60" id="h2-1-60" class="i">+            Self::Divide(lhs, rhs) =&gt; {
</a><a href="#h2-1-61" id="h2-1-61" class="i">+                Self::Divide(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-62" id="h2-1-62" class="i">+            }
</a><a href="#h2-1-63" id="h2-1-63" class="i">+            Self::Exponentiate(lhs, rhs) =&gt; Self::Exponentiate(
</a><a href="#h2-1-64" id="h2-1-64" class="i">+                lhs.transform(pre, post)?.into(),
</a><a href="#h2-1-65" id="h2-1-65" class="i">+                rhs.transform(pre, post)?.into(),
</a><a href="#h2-1-66" id="h2-1-66" class="i">+            ),
</a><a href="#h2-1-67" id="h2-1-67" class="i">+            Self::Factorial(expr) =&gt; Self::Factorial(expr.transform(pre, post)?.into()),
</a><a href="#h2-1-68" id="h2-1-68" class="i">+            Self::Modulo(lhs, rhs) =&gt; {
</a><a href="#h2-1-69" id="h2-1-69" class="i">+                Self::Modulo(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-70" id="h2-1-70" class="i">+            }
</a><a href="#h2-1-71" id="h2-1-71" class="i">+            Self::Multiply(lhs, rhs) =&gt; {
</a><a href="#h2-1-72" id="h2-1-72" class="i">+                Self::Multiply(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-73" id="h2-1-73" class="i">+            }
</a><a href="#h2-1-74" id="h2-1-74" class="i">+            Self::Negate(expr) =&gt; Self::Negate(expr.transform(pre, post)?.into()),
</a><a href="#h2-1-75" id="h2-1-75" class="i">+            Self::Subtract(lhs, rhs) =&gt; {
</a><a href="#h2-1-76" id="h2-1-76" class="i">+                Self::Subtract(lhs.transform(pre, post)?.into(), rhs.transform(pre, post)?.into())
</a><a href="#h2-1-77" id="h2-1-77" class="i">+            }
</a><a href="#h2-1-78" id="h2-1-78" class="i">+        };
</a><a href="#h2-1-79" id="h2-1-79" class="i">+        post(self)
</a><a href="#h2-1-80" id="h2-1-80" class="i">+    }
</a><a href="#h2-1-81" id="h2-1-81" class="i">+
</a><a href="#h2-1-82" id="h2-1-82" class="i">+    /// Walks the expression tree depth-first, calling a closure for every element.
</a><a href="#h2-1-83" id="h2-1-83" class="i">+    /// If the closure returns false, walking is halted.
</a><a href="#h2-1-84" id="h2-1-84" class="i">+    pub fn walk&lt;F&gt;(&amp;self, visitor: &amp;F) -&gt; bool
</a><a href="#h2-1-85" id="h2-1-85" class="i">+    where
</a><a href="#h2-1-86" id="h2-1-86" class="i">+        F: Fn(&amp;Expression) -&gt; bool,
</a><a href="#h2-1-87" id="h2-1-87" class="i">+    {
</a><a href="#h2-1-88" id="h2-1-88" class="i">+        if match self {
</a><a href="#h2-1-89" id="h2-1-89" class="i">+            Self::Add(lhs, rhs)
</a><a href="#h2-1-90" id="h2-1-90" class="i">+            | Self::And(lhs, rhs)
</a><a href="#h2-1-91" id="h2-1-91" class="i">+            | Self::CompareEQ(lhs, rhs)
</a><a href="#h2-1-92" id="h2-1-92" class="i">+            | Self::CompareGT(lhs, rhs)
</a><a href="#h2-1-93" id="h2-1-93" class="i">+            | Self::CompareGTE(lhs, rhs)
</a><a href="#h2-1-94" id="h2-1-94" class="i">+            | Self::CompareLT(lhs, rhs)
</a><a href="#h2-1-95" id="h2-1-95" class="i">+            | Self::CompareLTE(lhs, rhs)
</a><a href="#h2-1-96" id="h2-1-96" class="i">+            | Self::CompareNE(lhs, rhs)
</a><a href="#h2-1-97" id="h2-1-97" class="i">+            | Self::Divide(lhs, rhs)
</a><a href="#h2-1-98" id="h2-1-98" class="i">+            | Self::Exponentiate(lhs, rhs)
</a><a href="#h2-1-99" id="h2-1-99" class="i">+            | Self::Modulo(lhs, rhs)
</a><a href="#h2-1-100" id="h2-1-100" class="i">+            | Self::Multiply(lhs, rhs)
</a><a href="#h2-1-101" id="h2-1-101" class="i">+            | Self::Or(lhs, rhs)
</a><a href="#h2-1-102" id="h2-1-102" class="i">+            | Self::Subtract(lhs, rhs) =&gt; lhs.walk(visitor) &amp;&amp; rhs.walk(visitor),
</a><a href="#h2-1-103" id="h2-1-103" class="i">+
</a><a href="#h2-1-104" id="h2-1-104" class="i">+            Self::Factorial(expr) | Self::Negate(expr) | Self::Not(expr) =&gt; expr.walk(visitor),
</a><a href="#h2-1-105" id="h2-1-105" class="i">+
</a><a href="#h2-1-106" id="h2-1-106" class="i">+            Self::Constant(_) | Self::Field(_) =&gt; true,
</a><a href="#h2-1-107" id="h2-1-107" class="i">+        } {
</a><a href="#h2-1-108" id="h2-1-108" class="i">+            visitor(self)
</a><a href="#h2-1-109" id="h2-1-109" class="i">+        } else {
</a><a href="#h2-1-110" id="h2-1-110" class="i">+            false
</a><a href="#h2-1-111" id="h2-1-111" class="i">+        }
</a><a href="#h2-1-112" id="h2-1-112" class="i">+    }
</a><a href="#h2-1-113" id="h2-1-113" class="i">+}
</a><a href="#h2-1-114" id="h2-1-114" class="i">+
</a><a href="#h2-1-115" id="h2-1-115" class="i">+/// An expression evaluation environment
</a><a href="#h2-1-116" id="h2-1-116" class="i">+pub struct Environment {
</a><a href="#h2-1-117" id="h2-1-117" class="i">+    fields: HashMap&lt;String, Value&gt;,
</a><a href="#h2-1-118" id="h2-1-118" class="i">+}
</a><a href="#h2-1-119" id="h2-1-119" class="i">+
</a><a href="#h2-1-120" id="h2-1-120" class="i">+impl Environment {
</a><a href="#h2-1-121" id="h2-1-121" class="i">+    pub fn new(fields: HashMap&lt;String, Value&gt;) -&gt; Self {
</a><a href="#h2-1-122" id="h2-1-122" class="i">+        Self { fields }
</a><a href="#h2-1-123" id="h2-1-123" class="i">+    }
</a><a href="#h2-1-124" id="h2-1-124" class="i">+
</a><a href="#h2-1-125" id="h2-1-125" class="i">+    pub fn empty() -&gt; Self {
</a><a href="#h2-1-126" id="h2-1-126" class="i">+        Self::new(HashMap::new())
</a><a href="#h2-1-127" id="h2-1-127" class="i">+    }
</a> }
<b>diff --git a/<a id="h3" href="../file/src/sql/mod.rs.html">src/sql/mod.rs</a> b/<a href="../file/src/sql/mod.rs.html">src/sql/mod.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -1,5 +1,6 @@
</a> mod executor;
 mod expression;
<a href="#h3-0-2" id="h3-0-2" class="i">+mod optimizer;
</a> mod parser;
 mod plan;
 mod schema;
<b>diff --git a/<a id="h4" href="../file/src/sql/optimizer/constant_folder.rs.html">src/sql/optimizer/constant_folder.rs</a> b/<a href="../file/src/sql/optimizer/constant_folder.rs.html">src/sql/optimizer/constant_folder.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -0,0 +1,20 @@
</a><a href="#h4-0-0" id="h4-0-0" class="i">+use super::super::plan::Node;
</a><a href="#h4-0-1" id="h4-0-1" class="i">+use super::super::{Environment, Expression};
</a><a href="#h4-0-2" id="h4-0-2" class="i">+use super::Optimizer;
</a><a href="#h4-0-3" id="h4-0-3" class="i">+use crate::Error;
</a><a href="#h4-0-4" id="h4-0-4" class="i">+
</a><a href="#h4-0-5" id="h4-0-5" class="i">+/// A constant folding optimizer, which replaces constant expressions
</a><a href="#h4-0-6" id="h4-0-6" class="i">+/// with their evaluated value, to prevent it from being re-evaluated
</a><a href="#h4-0-7" id="h4-0-7" class="i">+/// over and over again during plan execution.
</a><a href="#h4-0-8" id="h4-0-8" class="i">+pub struct ConstantFolder;
</a><a href="#h4-0-9" id="h4-0-9" class="i">+
</a><a href="#h4-0-10" id="h4-0-10" class="i">+impl Optimizer for ConstantFolder {
</a><a href="#h4-0-11" id="h4-0-11" class="i">+    fn optimize(&amp;mut self, node: Node) -&gt; Result&lt;Node, Error&gt; {
</a><a href="#h4-0-12" id="h4-0-12" class="i">+        let env = &amp;Environment::empty();
</a><a href="#h4-0-13" id="h4-0-13" class="i">+        node.transform(&amp;|n| Ok(n), &amp;|n| {
</a><a href="#h4-0-14" id="h4-0-14" class="i">+            n.transform_expressions(&amp;|e| Ok(e), &amp;|e| {
</a><a href="#h4-0-15" id="h4-0-15" class="i">+                Ok(if e.is_constant() { Expression::Constant(e.evaluate(&amp;env)?) } else { e })
</a><a href="#h4-0-16" id="h4-0-16" class="i">+            })
</a><a href="#h4-0-17" id="h4-0-17" class="i">+        })
</a><a href="#h4-0-18" id="h4-0-18" class="i">+    }
</a><a href="#h4-0-19" id="h4-0-19" class="i">+}
</a><b>diff --git a/<a id="h5" href="../file/src/sql/optimizer/mod.rs.html">src/sql/optimizer/mod.rs</a> b/<a href="../file/src/sql/optimizer/mod.rs.html">src/sql/optimizer/mod.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h5-0-0" id="h5-0-0" class="i">+mod constant_folder;
</a><a href="#h5-0-1" id="h5-0-1" class="i">+
</a><a href="#h5-0-2" id="h5-0-2" class="i">+pub use constant_folder::ConstantFolder;
</a><a href="#h5-0-3" id="h5-0-3" class="i">+
</a><a href="#h5-0-4" id="h5-0-4" class="i">+use super::plan::Node;
</a><a href="#h5-0-5" id="h5-0-5" class="i">+use crate::Error;
</a><a href="#h5-0-6" id="h5-0-6" class="i">+
</a><a href="#h5-0-7" id="h5-0-7" class="i">+/// A plan optimizer
</a><a href="#h5-0-8" id="h5-0-8" class="i">+pub trait Optimizer {
</a><a href="#h5-0-9" id="h5-0-9" class="i">+    fn optimize(&amp;mut self, node: Node) -&gt; Result&lt;Node, Error&gt;;
</a><a href="#h5-0-10" id="h5-0-10" class="i">+}
</a><b>diff --git a/<a id="h6" href="../file/src/sql/plan.rs.html">src/sql/plan.rs</a> b/<a href="../file/src/sql/plan.rs.html">src/sql/plan.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,5 +1,7 @@
</a> use super::executor::{Context, Executor};
 use super::expression::{Environment, Expression, Expressions};
<a href="#h6-0-2" id="h6-0-2" class="i">+use super::optimizer;
</a><a href="#h6-0-3" id="h6-0-3" class="i">+use super::optimizer::Optimizer;
</a> use super::parser::ast;
 use super::schema;
 use super::types::{ResultSet, Value};
<a href="#h6-1" id="h6-1" class="h">@@ -22,6 +24,12 @@ impl Plan {
</a>     pub fn execute(self, mut ctx: Context) -&gt; Result&lt;ResultSet, Error&gt; {
         Ok(ResultSet::from_executor(Executor::execute(&amp;mut ctx, self.root)?))
     }
<a href="#h6-1-3" id="h6-1-3" class="i">+
</a><a href="#h6-1-4" id="h6-1-4" class="i">+    /// Optimizes the plan, consuming it
</a><a href="#h6-1-5" id="h6-1-5" class="i">+    pub fn optimize(mut self) -&gt; Result&lt;Self, Error&gt; {
</a><a href="#h6-1-6" id="h6-1-6" class="i">+        self.root = optimizer::ConstantFolder.optimize(self.root)?;
</a><a href="#h6-1-7" id="h6-1-7" class="i">+        Ok(self)
</a><a href="#h6-1-8" id="h6-1-8" class="i">+    }
</a> }
 
 /// A plan node
<a href="#h6-2" id="h6-2" class="h">@@ -42,6 +50,100 @@ pub enum Node {
</a>     Update { table: String, source: Box&lt;Self&gt;, expressions: BTreeMap&lt;String, Expression&gt; },
 }
 
<a href="#h6-2-3" id="h6-2-3" class="i">+impl Node {
</a><a href="#h6-2-4" id="h6-2-4" class="i">+    /// Recursively transforms nodes by applying functions before and after descending.
</a><a href="#h6-2-5" id="h6-2-5" class="i">+    pub fn transform&lt;B, A&gt;(mut self, pre: &amp;B, post: &amp;A) -&gt; Result&lt;Self, Error&gt;
</a><a href="#h6-2-6" id="h6-2-6" class="i">+    where
</a><a href="#h6-2-7" id="h6-2-7" class="i">+        B: Fn(Self) -&gt; Result&lt;Self, Error&gt;,
</a><a href="#h6-2-8" id="h6-2-8" class="i">+        A: Fn(Self) -&gt; Result&lt;Self, Error&gt;,
</a><a href="#h6-2-9" id="h6-2-9" class="i">+    {
</a><a href="#h6-2-10" id="h6-2-10" class="i">+        self = pre(self)?;
</a><a href="#h6-2-11" id="h6-2-11" class="i">+        self = match self {
</a><a href="#h6-2-12" id="h6-2-12" class="i">+            n @ Self::CreateTable { .. } =&gt; n,
</a><a href="#h6-2-13" id="h6-2-13" class="i">+            n @ Self::DropTable { .. } =&gt; n,
</a><a href="#h6-2-14" id="h6-2-14" class="i">+            n @ Self::Insert { .. } =&gt; n,
</a><a href="#h6-2-15" id="h6-2-15" class="i">+            n @ Self::Nothing =&gt; n,
</a><a href="#h6-2-16" id="h6-2-16" class="i">+            n @ Self::Scan { .. } =&gt; n,
</a><a href="#h6-2-17" id="h6-2-17" class="i">+            Self::Delete { table, source } =&gt; {
</a><a href="#h6-2-18" id="h6-2-18" class="i">+                Self::Delete { table, source: source.transform(pre, post)?.into() }
</a><a href="#h6-2-19" id="h6-2-19" class="i">+            }
</a><a href="#h6-2-20" id="h6-2-20" class="i">+            Self::Filter { source, predicate } =&gt; {
</a><a href="#h6-2-21" id="h6-2-21" class="i">+                Self::Filter { source: source.transform(pre, post)?.into(), predicate }
</a><a href="#h6-2-22" id="h6-2-22" class="i">+            }
</a><a href="#h6-2-23" id="h6-2-23" class="i">+            Self::Limit { source, limit } =&gt; {
</a><a href="#h6-2-24" id="h6-2-24" class="i">+                Self::Limit { source: source.transform(pre, post)?.into(), limit }
</a><a href="#h6-2-25" id="h6-2-25" class="i">+            }
</a><a href="#h6-2-26" id="h6-2-26" class="i">+            Self::Offset { source, offset } =&gt; {
</a><a href="#h6-2-27" id="h6-2-27" class="i">+                Self::Offset { source: source.transform(pre, post)?.into(), offset }
</a><a href="#h6-2-28" id="h6-2-28" class="i">+            }
</a><a href="#h6-2-29" id="h6-2-29" class="i">+            Self::Order { source, orders } =&gt; {
</a><a href="#h6-2-30" id="h6-2-30" class="i">+                Self::Order { source: source.transform(pre, post)?.into(), orders }
</a><a href="#h6-2-31" id="h6-2-31" class="i">+            }
</a><a href="#h6-2-32" id="h6-2-32" class="i">+            Self::Projection { source, labels, expressions } =&gt; Self::Projection {
</a><a href="#h6-2-33" id="h6-2-33" class="i">+                source: source.transform(pre, post)?.into(),
</a><a href="#h6-2-34" id="h6-2-34" class="i">+                labels,
</a><a href="#h6-2-35" id="h6-2-35" class="i">+                expressions,
</a><a href="#h6-2-36" id="h6-2-36" class="i">+            },
</a><a href="#h6-2-37" id="h6-2-37" class="i">+            Self::Update { table, source, expressions } =&gt; {
</a><a href="#h6-2-38" id="h6-2-38" class="i">+                Self::Update { table, source: source.transform(pre, post)?.into(), expressions }
</a><a href="#h6-2-39" id="h6-2-39" class="i">+            }
</a><a href="#h6-2-40" id="h6-2-40" class="i">+        };
</a><a href="#h6-2-41" id="h6-2-41" class="i">+        post(self)
</a><a href="#h6-2-42" id="h6-2-42" class="i">+    }
</a><a href="#h6-2-43" id="h6-2-43" class="i">+
</a><a href="#h6-2-44" id="h6-2-44" class="i">+    /// Transforms all expressions in a node by calling .transform() on them
</a><a href="#h6-2-45" id="h6-2-45" class="i">+    /// with the given functions.
</a><a href="#h6-2-46" id="h6-2-46" class="i">+    pub fn transform_expressions&lt;B, A&gt;(self, pre: &amp;B, post: &amp;A) -&gt; Result&lt;Self, Error&gt;
</a><a href="#h6-2-47" id="h6-2-47" class="i">+    where
</a><a href="#h6-2-48" id="h6-2-48" class="i">+        B: Fn(Expression) -&gt; Result&lt;Expression, Error&gt;,
</a><a href="#h6-2-49" id="h6-2-49" class="i">+        A: Fn(Expression) -&gt; Result&lt;Expression, Error&gt;,
</a><a href="#h6-2-50" id="h6-2-50" class="i">+    {
</a><a href="#h6-2-51" id="h6-2-51" class="i">+        Ok(match self {
</a><a href="#h6-2-52" id="h6-2-52" class="i">+            n @ Self::CreateTable { .. } =&gt; n,
</a><a href="#h6-2-53" id="h6-2-53" class="i">+            n @ Self::Delete { .. } =&gt; n,
</a><a href="#h6-2-54" id="h6-2-54" class="i">+            n @ Self::DropTable { .. } =&gt; n,
</a><a href="#h6-2-55" id="h6-2-55" class="i">+            n @ Self::Limit { .. } =&gt; n,
</a><a href="#h6-2-56" id="h6-2-56" class="i">+            n @ Self::Nothing =&gt; n,
</a><a href="#h6-2-57" id="h6-2-57" class="i">+            n @ Self::Offset { .. } =&gt; n,
</a><a href="#h6-2-58" id="h6-2-58" class="i">+            n @ Self::Scan { .. } =&gt; n,
</a><a href="#h6-2-59" id="h6-2-59" class="i">+            Self::Filter { source, predicate } =&gt; {
</a><a href="#h6-2-60" id="h6-2-60" class="i">+                Self::Filter { source, predicate: predicate.transform(pre, post)? }
</a><a href="#h6-2-61" id="h6-2-61" class="i">+            }
</a><a href="#h6-2-62" id="h6-2-62" class="i">+            Self::Insert { table, columns, expressions } =&gt; Self::Insert {
</a><a href="#h6-2-63" id="h6-2-63" class="i">+                table,
</a><a href="#h6-2-64" id="h6-2-64" class="i">+                columns,
</a><a href="#h6-2-65" id="h6-2-65" class="i">+                expressions: expressions
</a><a href="#h6-2-66" id="h6-2-66" class="i">+                    .into_iter()
</a><a href="#h6-2-67" id="h6-2-67" class="i">+                    .map(|exprs| exprs.into_iter().map(|e| e.transform(pre, post)).collect())
</a><a href="#h6-2-68" id="h6-2-68" class="i">+                    .collect::&lt;Result&lt;_, Error&gt;&gt;()?,
</a><a href="#h6-2-69" id="h6-2-69" class="i">+            },
</a><a href="#h6-2-70" id="h6-2-70" class="i">+            Self::Order { source, orders } =&gt; Self::Order {
</a><a href="#h6-2-71" id="h6-2-71" class="i">+                source,
</a><a href="#h6-2-72" id="h6-2-72" class="i">+                orders: orders
</a><a href="#h6-2-73" id="h6-2-73" class="i">+                    .into_iter()
</a><a href="#h6-2-74" id="h6-2-74" class="i">+                    .map(|(e, o)| e.transform(pre, post).map(|e| (e, o)))
</a><a href="#h6-2-75" id="h6-2-75" class="i">+                    .collect::&lt;Result&lt;_, Error&gt;&gt;()?,
</a><a href="#h6-2-76" id="h6-2-76" class="i">+            },
</a><a href="#h6-2-77" id="h6-2-77" class="i">+            Self::Projection { source, labels, expressions } =&gt; Self::Projection {
</a><a href="#h6-2-78" id="h6-2-78" class="i">+                source,
</a><a href="#h6-2-79" id="h6-2-79" class="i">+                labels,
</a><a href="#h6-2-80" id="h6-2-80" class="i">+                expressions: expressions
</a><a href="#h6-2-81" id="h6-2-81" class="i">+                    .into_iter()
</a><a href="#h6-2-82" id="h6-2-82" class="i">+                    .map(|e| e.transform(pre, post))
</a><a href="#h6-2-83" id="h6-2-83" class="i">+                    .collect::&lt;Result&lt;_, Error&gt;&gt;()?,
</a><a href="#h6-2-84" id="h6-2-84" class="i">+            },
</a><a href="#h6-2-85" id="h6-2-85" class="i">+            Self::Update { table, source, expressions } =&gt; Self::Update {
</a><a href="#h6-2-86" id="h6-2-86" class="i">+                table,
</a><a href="#h6-2-87" id="h6-2-87" class="i">+                source,
</a><a href="#h6-2-88" id="h6-2-88" class="i">+                expressions: expressions
</a><a href="#h6-2-89" id="h6-2-89" class="i">+                    .into_iter()
</a><a href="#h6-2-90" id="h6-2-90" class="i">+                    .map(|(k, e)| e.transform(pre, post).map(|e| (k, e)))
</a><a href="#h6-2-91" id="h6-2-91" class="i">+                    .collect::&lt;Result&lt;_, Error&gt;&gt;()?,
</a><a href="#h6-2-92" id="h6-2-92" class="i">+            },
</a><a href="#h6-2-93" id="h6-2-93" class="i">+        })
</a><a href="#h6-2-94" id="h6-2-94" class="i">+    }
</a><a href="#h6-2-95" id="h6-2-95" class="i">+}
</a><a href="#h6-2-96" id="h6-2-96" class="i">+
</a> /// A sort order
 #[derive(Debug, PartialEq)]
 pub enum Order {
<b>diff --git a/<a id="h7" href="../file/src/sql/testdata/create_table.html">src/sql/testdata/create_table</a> b/<a href="../file/src/sql/testdata/create_table.html">src/sql/testdata/create_table</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -124,6 +124,47 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h7-0-3" id="h7-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h7-0-4" id="h7-0-4" class="i">+    root: CreateTable {
</a><a href="#h7-0-5" id="h7-0-5" class="i">+        schema: Table {
</a><a href="#h7-0-6" id="h7-0-6" class="i">+            name: &quot;name&quot;,
</a><a href="#h7-0-7" id="h7-0-7" class="i">+            columns: [
</a><a href="#h7-0-8" id="h7-0-8" class="i">+                Column {
</a><a href="#h7-0-9" id="h7-0-9" class="i">+                    name: &quot;id&quot;,
</a><a href="#h7-0-10" id="h7-0-10" class="i">+                    datatype: Integer,
</a><a href="#h7-0-11" id="h7-0-11" class="i">+                    nullable: false,
</a><a href="#h7-0-12" id="h7-0-12" class="i">+                },
</a><a href="#h7-0-13" id="h7-0-13" class="i">+                Column {
</a><a href="#h7-0-14" id="h7-0-14" class="i">+                    name: &quot;string&quot;,
</a><a href="#h7-0-15" id="h7-0-15" class="i">+                    datatype: String,
</a><a href="#h7-0-16" id="h7-0-16" class="i">+                    nullable: false,
</a><a href="#h7-0-17" id="h7-0-17" class="i">+                },
</a><a href="#h7-0-18" id="h7-0-18" class="i">+                Column {
</a><a href="#h7-0-19" id="h7-0-19" class="i">+                    name: &quot;text&quot;,
</a><a href="#h7-0-20" id="h7-0-20" class="i">+                    datatype: String,
</a><a href="#h7-0-21" id="h7-0-21" class="i">+                    nullable: true,
</a><a href="#h7-0-22" id="h7-0-22" class="i">+                },
</a><a href="#h7-0-23" id="h7-0-23" class="i">+                Column {
</a><a href="#h7-0-24" id="h7-0-24" class="i">+                    name: &quot;number&quot;,
</a><a href="#h7-0-25" id="h7-0-25" class="i">+                    datatype: Integer,
</a><a href="#h7-0-26" id="h7-0-26" class="i">+                    nullable: true,
</a><a href="#h7-0-27" id="h7-0-27" class="i">+                },
</a><a href="#h7-0-28" id="h7-0-28" class="i">+                Column {
</a><a href="#h7-0-29" id="h7-0-29" class="i">+                    name: &quot;decimal&quot;,
</a><a href="#h7-0-30" id="h7-0-30" class="i">+                    datatype: Float,
</a><a href="#h7-0-31" id="h7-0-31" class="i">+                    nullable: true,
</a><a href="#h7-0-32" id="h7-0-32" class="i">+                },
</a><a href="#h7-0-33" id="h7-0-33" class="i">+                Column {
</a><a href="#h7-0-34" id="h7-0-34" class="i">+                    name: &quot;bool&quot;,
</a><a href="#h7-0-35" id="h7-0-35" class="i">+                    datatype: Boolean,
</a><a href="#h7-0-36" id="h7-0-36" class="i">+                    nullable: true,
</a><a href="#h7-0-37" id="h7-0-37" class="i">+                },
</a><a href="#h7-0-38" id="h7-0-38" class="i">+            ],
</a><a href="#h7-0-39" id="h7-0-39" class="i">+            primary_key: 0,
</a><a href="#h7-0-40" id="h7-0-40" class="i">+        },
</a><a href="#h7-0-41" id="h7-0-41" class="i">+    },
</a><a href="#h7-0-42" id="h7-0-42" class="i">+}
</a><a href="#h7-0-43" id="h7-0-43" class="i">+
</a> Query: 
         CREATE TABLE name (
             id INTEGER PRIMARY KEY,
<b>diff --git a/<a id="h8" href="../file/src/sql/testdata/create_table_error_exists.html">src/sql/testdata/create_table_error_exists</a> b/<a href="../file/src/sql/testdata/create_table_error_exists.html">src/sql/testdata/create_table_error_exists</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -39,6 +39,22 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h8-0-3" id="h8-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h8-0-4" id="h8-0-4" class="i">+    root: CreateTable {
</a><a href="#h8-0-5" id="h8-0-5" class="i">+        schema: Table {
</a><a href="#h8-0-6" id="h8-0-6" class="i">+            name: &quot;movies&quot;,
</a><a href="#h8-0-7" id="h8-0-7" class="i">+            columns: [
</a><a href="#h8-0-8" id="h8-0-8" class="i">+                Column {
</a><a href="#h8-0-9" id="h8-0-9" class="i">+                    name: &quot;id&quot;,
</a><a href="#h8-0-10" id="h8-0-10" class="i">+                    datatype: Integer,
</a><a href="#h8-0-11" id="h8-0-11" class="i">+                    nullable: false,
</a><a href="#h8-0-12" id="h8-0-12" class="i">+                },
</a><a href="#h8-0-13" id="h8-0-13" class="i">+            ],
</a><a href="#h8-0-14" id="h8-0-14" class="i">+            primary_key: 0,
</a><a href="#h8-0-15" id="h8-0-15" class="i">+        },
</a><a href="#h8-0-16" id="h8-0-16" class="i">+    },
</a><a href="#h8-0-17" id="h8-0-17" class="i">+}
</a><a href="#h8-0-18" id="h8-0-18" class="i">+
</a> Query: CREATE TABLE movies (id INTEGER PRIMARY KEY)
 
 Result: Value(&quot;Table movies already exists&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h9" href="../file/src/sql/testdata/create_table_single_column.html">src/sql/testdata/create_table_single_column</a> b/<a href="../file/src/sql/testdata/create_table_single_column.html">src/sql/testdata/create_table_single_column</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -39,6 +39,22 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h9-0-3" id="h9-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h9-0-4" id="h9-0-4" class="i">+    root: CreateTable {
</a><a href="#h9-0-5" id="h9-0-5" class="i">+        schema: Table {
</a><a href="#h9-0-6" id="h9-0-6" class="i">+            name: &quot;name&quot;,
</a><a href="#h9-0-7" id="h9-0-7" class="i">+            columns: [
</a><a href="#h9-0-8" id="h9-0-8" class="i">+                Column {
</a><a href="#h9-0-9" id="h9-0-9" class="i">+                    name: &quot;id&quot;,
</a><a href="#h9-0-10" id="h9-0-10" class="i">+                    datatype: Integer,
</a><a href="#h9-0-11" id="h9-0-11" class="i">+                    nullable: false,
</a><a href="#h9-0-12" id="h9-0-12" class="i">+                },
</a><a href="#h9-0-13" id="h9-0-13" class="i">+            ],
</a><a href="#h9-0-14" id="h9-0-14" class="i">+            primary_key: 0,
</a><a href="#h9-0-15" id="h9-0-15" class="i">+        },
</a><a href="#h9-0-16" id="h9-0-16" class="i">+    },
</a><a href="#h9-0-17" id="h9-0-17" class="i">+}
</a><a href="#h9-0-18" id="h9-0-18" class="i">+
</a> Query: CREATE TABLE name (id INTEGER PRIMARY KEY)
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h10" href="../file/src/sql/testdata/delete_all.html">src/sql/testdata/delete_all</a> b/<a href="../file/src/sql/testdata/delete_all.html">src/sql/testdata/delete_all</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -19,6 +19,15 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h10-0-3" id="h10-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h10-0-4" id="h10-0-4" class="i">+    root: Delete {
</a><a href="#h10-0-5" id="h10-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h10-0-6" id="h10-0-6" class="i">+        source: Scan {
</a><a href="#h10-0-7" id="h10-0-7" class="i">+            table: &quot;movies&quot;,
</a><a href="#h10-0-8" id="h10-0-8" class="i">+        },
</a><a href="#h10-0-9" id="h10-0-9" class="i">+    },
</a><a href="#h10-0-10" id="h10-0-10" class="i">+}
</a><a href="#h10-0-11" id="h10-0-11" class="i">+
</a> Query: DELETE FROM movies
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h11" href="../file/src/sql/testdata/delete_error_table.html">src/sql/testdata/delete_error_table</a> b/<a href="../file/src/sql/testdata/delete_error_table.html">src/sql/testdata/delete_error_table</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -19,6 +19,15 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h11-0-3" id="h11-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h11-0-4" id="h11-0-4" class="i">+    root: Delete {
</a><a href="#h11-0-5" id="h11-0-5" class="i">+        table: &quot;missing&quot;,
</a><a href="#h11-0-6" id="h11-0-6" class="i">+        source: Scan {
</a><a href="#h11-0-7" id="h11-0-7" class="i">+            table: &quot;missing&quot;,
</a><a href="#h11-0-8" id="h11-0-8" class="i">+        },
</a><a href="#h11-0-9" id="h11-0-9" class="i">+    },
</a><a href="#h11-0-10" id="h11-0-10" class="i">+}
</a><a href="#h11-0-11" id="h11-0-11" class="i">+
</a> Query: DELETE FROM missing
 
 Result: Value(&quot;Table missing not found&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h12" href="../file/src/sql/testdata/delete_where.html">src/sql/testdata/delete_where</a> b/<a href="../file/src/sql/testdata/delete_where.html">src/sql/testdata/delete_where</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -50,6 +50,27 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h12-0-3" id="h12-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h12-0-4" id="h12-0-4" class="i">+    root: Delete {
</a><a href="#h12-0-5" id="h12-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h12-0-6" id="h12-0-6" class="i">+        source: Filter {
</a><a href="#h12-0-7" id="h12-0-7" class="i">+            source: Scan {
</a><a href="#h12-0-8" id="h12-0-8" class="i">+                table: &quot;movies&quot;,
</a><a href="#h12-0-9" id="h12-0-9" class="i">+            },
</a><a href="#h12-0-10" id="h12-0-10" class="i">+            predicate: CompareGTE(
</a><a href="#h12-0-11" id="h12-0-11" class="i">+                Field(
</a><a href="#h12-0-12" id="h12-0-12" class="i">+                    &quot;released&quot;,
</a><a href="#h12-0-13" id="h12-0-13" class="i">+                ),
</a><a href="#h12-0-14" id="h12-0-14" class="i">+                Constant(
</a><a href="#h12-0-15" id="h12-0-15" class="i">+                    Integer(
</a><a href="#h12-0-16" id="h12-0-16" class="i">+                        2000,
</a><a href="#h12-0-17" id="h12-0-17" class="i">+                    ),
</a><a href="#h12-0-18" id="h12-0-18" class="i">+                ),
</a><a href="#h12-0-19" id="h12-0-19" class="i">+            ),
</a><a href="#h12-0-20" id="h12-0-20" class="i">+        },
</a><a href="#h12-0-21" id="h12-0-21" class="i">+    },
</a><a href="#h12-0-22" id="h12-0-22" class="i">+}
</a><a href="#h12-0-23" id="h12-0-23" class="i">+
</a> Query: DELETE FROM movies WHERE released &gt;= 2000
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h13" href="../file/src/sql/testdata/delete_where_false.html">src/sql/testdata/delete_where_false</a> b/<a href="../file/src/sql/testdata/delete_where_false.html">src/sql/testdata/delete_where_false</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -36,6 +36,22 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h13-0-3" id="h13-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h13-0-4" id="h13-0-4" class="i">+    root: Delete {
</a><a href="#h13-0-5" id="h13-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h13-0-6" id="h13-0-6" class="i">+        source: Filter {
</a><a href="#h13-0-7" id="h13-0-7" class="i">+            source: Scan {
</a><a href="#h13-0-8" id="h13-0-8" class="i">+                table: &quot;movies&quot;,
</a><a href="#h13-0-9" id="h13-0-9" class="i">+            },
</a><a href="#h13-0-10" id="h13-0-10" class="i">+            predicate: Constant(
</a><a href="#h13-0-11" id="h13-0-11" class="i">+                Boolean(
</a><a href="#h13-0-12" id="h13-0-12" class="i">+                    false,
</a><a href="#h13-0-13" id="h13-0-13" class="i">+                ),
</a><a href="#h13-0-14" id="h13-0-14" class="i">+            ),
</a><a href="#h13-0-15" id="h13-0-15" class="i">+        },
</a><a href="#h13-0-16" id="h13-0-16" class="i">+    },
</a><a href="#h13-0-17" id="h13-0-17" class="i">+}
</a><a href="#h13-0-18" id="h13-0-18" class="i">+
</a> Query: DELETE FROM movies WHERE FALSE
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h14" href="../file/src/sql/testdata/delete_where_null.html">src/sql/testdata/delete_where_null</a> b/<a href="../file/src/sql/testdata/delete_where_null.html">src/sql/testdata/delete_where_null</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -32,6 +32,20 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h14-0-3" id="h14-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h14-0-4" id="h14-0-4" class="i">+    root: Delete {
</a><a href="#h14-0-5" id="h14-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h14-0-6" id="h14-0-6" class="i">+        source: Filter {
</a><a href="#h14-0-7" id="h14-0-7" class="i">+            source: Scan {
</a><a href="#h14-0-8" id="h14-0-8" class="i">+                table: &quot;movies&quot;,
</a><a href="#h14-0-9" id="h14-0-9" class="i">+            },
</a><a href="#h14-0-10" id="h14-0-10" class="i">+            predicate: Constant(
</a><a href="#h14-0-11" id="h14-0-11" class="i">+                Null,
</a><a href="#h14-0-12" id="h14-0-12" class="i">+            ),
</a><a href="#h14-0-13" id="h14-0-13" class="i">+        },
</a><a href="#h14-0-14" id="h14-0-14" class="i">+    },
</a><a href="#h14-0-15" id="h14-0-15" class="i">+}
</a><a href="#h14-0-16" id="h14-0-16" class="i">+
</a> Query: DELETE FROM movies WHERE NULL
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h15" href="../file/src/sql/testdata/delete_where_true.html">src/sql/testdata/delete_where_true</a> b/<a href="../file/src/sql/testdata/delete_where_true.html">src/sql/testdata/delete_where_true</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -36,6 +36,22 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h15-0-3" id="h15-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h15-0-4" id="h15-0-4" class="i">+    root: Delete {
</a><a href="#h15-0-5" id="h15-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h15-0-6" id="h15-0-6" class="i">+        source: Filter {
</a><a href="#h15-0-7" id="h15-0-7" class="i">+            source: Scan {
</a><a href="#h15-0-8" id="h15-0-8" class="i">+                table: &quot;movies&quot;,
</a><a href="#h15-0-9" id="h15-0-9" class="i">+            },
</a><a href="#h15-0-10" id="h15-0-10" class="i">+            predicate: Constant(
</a><a href="#h15-0-11" id="h15-0-11" class="i">+                Boolean(
</a><a href="#h15-0-12" id="h15-0-12" class="i">+                    true,
</a><a href="#h15-0-13" id="h15-0-13" class="i">+                ),
</a><a href="#h15-0-14" id="h15-0-14" class="i">+            ),
</a><a href="#h15-0-15" id="h15-0-15" class="i">+        },
</a><a href="#h15-0-16" id="h15-0-16" class="i">+    },
</a><a href="#h15-0-17" id="h15-0-17" class="i">+}
</a><a href="#h15-0-18" id="h15-0-18" class="i">+
</a> Query: DELETE FROM movies WHERE TRUE
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h16" href="../file/src/sql/testdata/drop_table.html">src/sql/testdata/drop_table</a> b/<a href="../file/src/sql/testdata/drop_table.html">src/sql/testdata/drop_table</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -15,6 +15,12 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h16-0-3" id="h16-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h16-0-4" id="h16-0-4" class="i">+    root: DropTable {
</a><a href="#h16-0-5" id="h16-0-5" class="i">+        name: &quot;movies&quot;,
</a><a href="#h16-0-6" id="h16-0-6" class="i">+    },
</a><a href="#h16-0-7" id="h16-0-7" class="i">+}
</a><a href="#h16-0-8" id="h16-0-8" class="i">+
</a> Query: DROP TABLE movies
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h17" href="../file/src/sql/testdata/drop_table_error_missing.html">src/sql/testdata/drop_table_error_missing</a> b/<a href="../file/src/sql/testdata/drop_table_error_missing.html">src/sql/testdata/drop_table_error_missing</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -15,6 +15,12 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h17-0-3" id="h17-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h17-0-4" id="h17-0-4" class="i">+    root: DropTable {
</a><a href="#h17-0-5" id="h17-0-5" class="i">+        name: &quot;missing&quot;,
</a><a href="#h17-0-6" id="h17-0-6" class="i">+    },
</a><a href="#h17-0-7" id="h17-0-7" class="i">+}
</a><a href="#h17-0-8" id="h17-0-8" class="i">+
</a> Query: DROP TABLE missing
 
 Result: Value(&quot;Table missing does not exist&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h18" href="../file/src/sql/testdata/expr_datatypes.html">src/sql/testdata/expr_datatypes</a> b/<a href="../file/src/sql/testdata/expr_datatypes.html">src/sql/testdata/expr_datatypes</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -106,6 +106,50 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h18-0-3" id="h18-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h18-0-4" id="h18-0-4" class="i">+    root: Projection {
</a><a href="#h18-0-5" id="h18-0-5" class="i">+        source: Nothing,
</a><a href="#h18-0-6" id="h18-0-6" class="i">+        labels: [
</a><a href="#h18-0-7" id="h18-0-7" class="i">+            None,
</a><a href="#h18-0-8" id="h18-0-8" class="i">+            None,
</a><a href="#h18-0-9" id="h18-0-9" class="i">+            None,
</a><a href="#h18-0-10" id="h18-0-10" class="i">+            None,
</a><a href="#h18-0-11" id="h18-0-11" class="i">+            None,
</a><a href="#h18-0-12" id="h18-0-12" class="i">+            None,
</a><a href="#h18-0-13" id="h18-0-13" class="i">+        ],
</a><a href="#h18-0-14" id="h18-0-14" class="i">+        expressions: [
</a><a href="#h18-0-15" id="h18-0-15" class="i">+            Constant(
</a><a href="#h18-0-16" id="h18-0-16" class="i">+                Null,
</a><a href="#h18-0-17" id="h18-0-17" class="i">+            ),
</a><a href="#h18-0-18" id="h18-0-18" class="i">+            Constant(
</a><a href="#h18-0-19" id="h18-0-19" class="i">+                Boolean(
</a><a href="#h18-0-20" id="h18-0-20" class="i">+                    true,
</a><a href="#h18-0-21" id="h18-0-21" class="i">+                ),
</a><a href="#h18-0-22" id="h18-0-22" class="i">+            ),
</a><a href="#h18-0-23" id="h18-0-23" class="i">+            Constant(
</a><a href="#h18-0-24" id="h18-0-24" class="i">+                Boolean(
</a><a href="#h18-0-25" id="h18-0-25" class="i">+                    false,
</a><a href="#h18-0-26" id="h18-0-26" class="i">+                ),
</a><a href="#h18-0-27" id="h18-0-27" class="i">+            ),
</a><a href="#h18-0-28" id="h18-0-28" class="i">+            Constant(
</a><a href="#h18-0-29" id="h18-0-29" class="i">+                Integer(
</a><a href="#h18-0-30" id="h18-0-30" class="i">+                    1,
</a><a href="#h18-0-31" id="h18-0-31" class="i">+                ),
</a><a href="#h18-0-32" id="h18-0-32" class="i">+            ),
</a><a href="#h18-0-33" id="h18-0-33" class="i">+            Constant(
</a><a href="#h18-0-34" id="h18-0-34" class="i">+                Float(
</a><a href="#h18-0-35" id="h18-0-35" class="i">+                    3.14,
</a><a href="#h18-0-36" id="h18-0-36" class="i">+                ),
</a><a href="#h18-0-37" id="h18-0-37" class="i">+            ),
</a><a href="#h18-0-38" id="h18-0-38" class="i">+            Constant(
</a><a href="#h18-0-39" id="h18-0-39" class="i">+                String(
</a><a href="#h18-0-40" id="h18-0-40" class="i">+                    &quot;Hi! &quot;,
</a><a href="#h18-0-41" id="h18-0-41" class="i">+                ),
</a><a href="#h18-0-42" id="h18-0-42" class="i">+            ),
</a><a href="#h18-0-43" id="h18-0-43" class="i">+        ],
</a><a href="#h18-0-44" id="h18-0-44" class="i">+    },
</a><a href="#h18-0-45" id="h18-0-45" class="i">+}
</a><a href="#h18-0-46" id="h18-0-46" class="i">+
</a> Query: SELECT NULL, TRUE, FALSE, 1, 3.14, &#39;Hi! &#39;
 
 Result: [[&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]]
<b>diff --git a/<a id="h19" href="../file/src/sql/testdata/expr_literal_numbers.html">src/sql/testdata/expr_literal_numbers</a> b/<a href="../file/src/sql/testdata/expr_literal_numbers.html">src/sql/testdata/expr_literal_numbers</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -181,6 +181,70 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h19-0-3" id="h19-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h19-0-4" id="h19-0-4" class="i">+    root: Projection {
</a><a href="#h19-0-5" id="h19-0-5" class="i">+        source: Nothing,
</a><a href="#h19-0-6" id="h19-0-6" class="i">+        labels: [
</a><a href="#h19-0-7" id="h19-0-7" class="i">+            None,
</a><a href="#h19-0-8" id="h19-0-8" class="i">+            None,
</a><a href="#h19-0-9" id="h19-0-9" class="i">+            None,
</a><a href="#h19-0-10" id="h19-0-10" class="i">+            None,
</a><a href="#h19-0-11" id="h19-0-11" class="i">+            None,
</a><a href="#h19-0-12" id="h19-0-12" class="i">+            None,
</a><a href="#h19-0-13" id="h19-0-13" class="i">+            None,
</a><a href="#h19-0-14" id="h19-0-14" class="i">+            None,
</a><a href="#h19-0-15" id="h19-0-15" class="i">+            None,
</a><a href="#h19-0-16" id="h19-0-16" class="i">+        ],
</a><a href="#h19-0-17" id="h19-0-17" class="i">+        expressions: [
</a><a href="#h19-0-18" id="h19-0-18" class="i">+            Constant(
</a><a href="#h19-0-19" id="h19-0-19" class="i">+                Integer(
</a><a href="#h19-0-20" id="h19-0-20" class="i">+                    0,
</a><a href="#h19-0-21" id="h19-0-21" class="i">+                ),
</a><a href="#h19-0-22" id="h19-0-22" class="i">+            ),
</a><a href="#h19-0-23" id="h19-0-23" class="i">+            Constant(
</a><a href="#h19-0-24" id="h19-0-24" class="i">+                Integer(
</a><a href="#h19-0-25" id="h19-0-25" class="i">+                    1,
</a><a href="#h19-0-26" id="h19-0-26" class="i">+                ),
</a><a href="#h19-0-27" id="h19-0-27" class="i">+            ),
</a><a href="#h19-0-28" id="h19-0-28" class="i">+            Constant(
</a><a href="#h19-0-29" id="h19-0-29" class="i">+                Integer(
</a><a href="#h19-0-30" id="h19-0-30" class="i">+                    -2,
</a><a href="#h19-0-31" id="h19-0-31" class="i">+                ),
</a><a href="#h19-0-32" id="h19-0-32" class="i">+            ),
</a><a href="#h19-0-33" id="h19-0-33" class="i">+            Constant(
</a><a href="#h19-0-34" id="h19-0-34" class="i">+                Integer(
</a><a href="#h19-0-35" id="h19-0-35" class="i">+                    3,
</a><a href="#h19-0-36" id="h19-0-36" class="i">+                ),
</a><a href="#h19-0-37" id="h19-0-37" class="i">+            ),
</a><a href="#h19-0-38" id="h19-0-38" class="i">+            Constant(
</a><a href="#h19-0-39" id="h19-0-39" class="i">+                Integer(
</a><a href="#h19-0-40" id="h19-0-40" class="i">+                    -4,
</a><a href="#h19-0-41" id="h19-0-41" class="i">+                ),
</a><a href="#h19-0-42" id="h19-0-42" class="i">+            ),
</a><a href="#h19-0-43" id="h19-0-43" class="i">+            Constant(
</a><a href="#h19-0-44" id="h19-0-44" class="i">+                Float(
</a><a href="#h19-0-45" id="h19-0-45" class="i">+                    3.14,
</a><a href="#h19-0-46" id="h19-0-46" class="i">+                ),
</a><a href="#h19-0-47" id="h19-0-47" class="i">+            ),
</a><a href="#h19-0-48" id="h19-0-48" class="i">+            Constant(
</a><a href="#h19-0-49" id="h19-0-49" class="i">+                Integer(
</a><a href="#h19-0-50" id="h19-0-50" class="i">+                    293,
</a><a href="#h19-0-51" id="h19-0-51" class="i">+                ),
</a><a href="#h19-0-52" id="h19-0-52" class="i">+            ),
</a><a href="#h19-0-53" id="h19-0-53" class="i">+            Constant(
</a><a href="#h19-0-54" id="h19-0-54" class="i">+                Float(
</a><a href="#h19-0-55" id="h19-0-55" class="i">+                    3140.0,
</a><a href="#h19-0-56" id="h19-0-56" class="i">+                ),
</a><a href="#h19-0-57" id="h19-0-57" class="i">+            ),
</a><a href="#h19-0-58" id="h19-0-58" class="i">+            Constant(
</a><a href="#h19-0-59" id="h19-0-59" class="i">+                Float(
</a><a href="#h19-0-60" id="h19-0-60" class="i">+                    0.02718,
</a><a href="#h19-0-61" id="h19-0-61" class="i">+                ),
</a><a href="#h19-0-62" id="h19-0-62" class="i">+            ),
</a><a href="#h19-0-63" id="h19-0-63" class="i">+        ],
</a><a href="#h19-0-64" id="h19-0-64" class="i">+    },
</a><a href="#h19-0-65" id="h19-0-65" class="i">+}
</a><a href="#h19-0-66" id="h19-0-66" class="i">+
</a> Query: SELECT 0, 1, -2, --3, +-4, 3.14, 293, 3.14e3, 2.718E-2
 
 Result: [[&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]]
<b>diff --git a/<a id="h20" href="../file/src/sql/testdata/expr_literal_string_quotes.html">src/sql/testdata/expr_literal_string_quotes</a> b/<a href="../file/src/sql/testdata/expr_literal_string_quotes.html">src/sql/testdata/expr_literal_string_quotes</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -40,6 +40,22 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h20-0-3" id="h20-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h20-0-4" id="h20-0-4" class="i">+    root: Projection {
</a><a href="#h20-0-5" id="h20-0-5" class="i">+        source: Nothing,
</a><a href="#h20-0-6" id="h20-0-6" class="i">+        labels: [
</a><a href="#h20-0-7" id="h20-0-7" class="i">+            None,
</a><a href="#h20-0-8" id="h20-0-8" class="i">+        ],
</a><a href="#h20-0-9" id="h20-0-9" class="i">+        expressions: [
</a><a href="#h20-0-10" id="h20-0-10" class="i">+            Constant(
</a><a href="#h20-0-11" id="h20-0-11" class="i">+                String(
</a><a href="#h20-0-12" id="h20-0-12" class="i">+                    &quot;Literal with \&#39;single\&#39; and \&quot;double\&quot; quotes&quot;,
</a><a href="#h20-0-13" id="h20-0-13" class="i">+                ),
</a><a href="#h20-0-14" id="h20-0-14" class="i">+            ),
</a><a href="#h20-0-15" id="h20-0-15" class="i">+        ],
</a><a href="#h20-0-16" id="h20-0-16" class="i">+    },
</a><a href="#h20-0-17" id="h20-0-17" class="i">+}
</a><a href="#h20-0-18" id="h20-0-18" class="i">+
</a> Query: SELECT &#39;Literal with &#39;&#39;single&#39;&#39; and &quot;double&quot; quotes&#39;
 
 Result: [[&quot;?&quot;]]
<b>diff --git a/<a id="h21" href="../file/src/sql/testdata/insert_default_null.html">src/sql/testdata/insert_default_null</a> b/<a href="../file/src/sql/testdata/insert_default_null.html">src/sql/testdata/insert_default_null</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -75,6 +75,37 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h21-0-3" id="h21-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h21-0-4" id="h21-0-4" class="i">+    root: Insert {
</a><a href="#h21-0-5" id="h21-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h21-0-6" id="h21-0-6" class="i">+        columns: [],
</a><a href="#h21-0-7" id="h21-0-7" class="i">+        expressions: [
</a><a href="#h21-0-8" id="h21-0-8" class="i">+            [
</a><a href="#h21-0-9" id="h21-0-9" class="i">+                Constant(
</a><a href="#h21-0-10" id="h21-0-10" class="i">+                    Integer(
</a><a href="#h21-0-11" id="h21-0-11" class="i">+                        9,
</a><a href="#h21-0-12" id="h21-0-12" class="i">+                    ),
</a><a href="#h21-0-13" id="h21-0-13" class="i">+                ),
</a><a href="#h21-0-14" id="h21-0-14" class="i">+                Constant(
</a><a href="#h21-0-15" id="h21-0-15" class="i">+                    String(
</a><a href="#h21-0-16" id="h21-0-16" class="i">+                        &quot;District 9&quot;,
</a><a href="#h21-0-17" id="h21-0-17" class="i">+                    ),
</a><a href="#h21-0-18" id="h21-0-18" class="i">+                ),
</a><a href="#h21-0-19" id="h21-0-19" class="i">+                Constant(
</a><a href="#h21-0-20" id="h21-0-20" class="i">+                    Integer(
</a><a href="#h21-0-21" id="h21-0-21" class="i">+                        1,
</a><a href="#h21-0-22" id="h21-0-22" class="i">+                    ),
</a><a href="#h21-0-23" id="h21-0-23" class="i">+                ),
</a><a href="#h21-0-24" id="h21-0-24" class="i">+                Constant(
</a><a href="#h21-0-25" id="h21-0-25" class="i">+                    Integer(
</a><a href="#h21-0-26" id="h21-0-26" class="i">+                        2009,
</a><a href="#h21-0-27" id="h21-0-27" class="i">+                    ),
</a><a href="#h21-0-28" id="h21-0-28" class="i">+                ),
</a><a href="#h21-0-29" id="h21-0-29" class="i">+            ],
</a><a href="#h21-0-30" id="h21-0-30" class="i">+        ],
</a><a href="#h21-0-31" id="h21-0-31" class="i">+    },
</a><a href="#h21-0-32" id="h21-0-32" class="i">+}
</a><a href="#h21-0-33" id="h21-0-33" class="i">+
</a> Query: INSERT INTO movies VALUES (9, &#39;District 9&#39;, 1, 2009)
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h22" href="../file/src/sql/testdata/insert_error_columns_duplicate.html">src/sql/testdata/insert_error_columns_duplicate</a> b/<a href="../file/src/sql/testdata/insert_error_columns_duplicate.html">src/sql/testdata/insert_error_columns_duplicate</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -80,6 +80,36 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h22-0-3" id="h22-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h22-0-4" id="h22-0-4" class="i">+    root: Insert {
</a><a href="#h22-0-5" id="h22-0-5" class="i">+        table: &quot;genres&quot;,
</a><a href="#h22-0-6" id="h22-0-6" class="i">+        columns: [
</a><a href="#h22-0-7" id="h22-0-7" class="i">+            &quot;id&quot;,
</a><a href="#h22-0-8" id="h22-0-8" class="i">+            &quot;name&quot;,
</a><a href="#h22-0-9" id="h22-0-9" class="i">+            &quot;id&quot;,
</a><a href="#h22-0-10" id="h22-0-10" class="i">+        ],
</a><a href="#h22-0-11" id="h22-0-11" class="i">+        expressions: [
</a><a href="#h22-0-12" id="h22-0-12" class="i">+            [
</a><a href="#h22-0-13" id="h22-0-13" class="i">+                Constant(
</a><a href="#h22-0-14" id="h22-0-14" class="i">+                    Integer(
</a><a href="#h22-0-15" id="h22-0-15" class="i">+                        9,
</a><a href="#h22-0-16" id="h22-0-16" class="i">+                    ),
</a><a href="#h22-0-17" id="h22-0-17" class="i">+                ),
</a><a href="#h22-0-18" id="h22-0-18" class="i">+                Constant(
</a><a href="#h22-0-19" id="h22-0-19" class="i">+                    String(
</a><a href="#h22-0-20" id="h22-0-20" class="i">+                        &quot;Western&quot;,
</a><a href="#h22-0-21" id="h22-0-21" class="i">+                    ),
</a><a href="#h22-0-22" id="h22-0-22" class="i">+                ),
</a><a href="#h22-0-23" id="h22-0-23" class="i">+                Constant(
</a><a href="#h22-0-24" id="h22-0-24" class="i">+                    Integer(
</a><a href="#h22-0-25" id="h22-0-25" class="i">+                        9,
</a><a href="#h22-0-26" id="h22-0-26" class="i">+                    ),
</a><a href="#h22-0-27" id="h22-0-27" class="i">+                ),
</a><a href="#h22-0-28" id="h22-0-28" class="i">+            ],
</a><a href="#h22-0-29" id="h22-0-29" class="i">+        ],
</a><a href="#h22-0-30" id="h22-0-30" class="i">+    },
</a><a href="#h22-0-31" id="h22-0-31" class="i">+}
</a><a href="#h22-0-32" id="h22-0-32" class="i">+
</a> Query: INSERT INTO genres (id, name, id) VALUES (9, &#39;Western&#39;, 9)
 
 Result: Value(&quot;Column id specified multiple times&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h23" href="../file/src/sql/testdata/insert_error_columns_mismatch.html">src/sql/testdata/insert_error_columns_mismatch</a> b/<a href="../file/src/sql/testdata/insert_error_columns_mismatch.html">src/sql/testdata/insert_error_columns_mismatch</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -60,6 +60,29 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h23-0-3" id="h23-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h23-0-4" id="h23-0-4" class="i">+    root: Insert {
</a><a href="#h23-0-5" id="h23-0-5" class="i">+        table: &quot;genres&quot;,
</a><a href="#h23-0-6" id="h23-0-6" class="i">+        columns: [
</a><a href="#h23-0-7" id="h23-0-7" class="i">+            &quot;id&quot;,
</a><a href="#h23-0-8" id="h23-0-8" class="i">+        ],
</a><a href="#h23-0-9" id="h23-0-9" class="i">+        expressions: [
</a><a href="#h23-0-10" id="h23-0-10" class="i">+            [
</a><a href="#h23-0-11" id="h23-0-11" class="i">+                Constant(
</a><a href="#h23-0-12" id="h23-0-12" class="i">+                    Integer(
</a><a href="#h23-0-13" id="h23-0-13" class="i">+                        9,
</a><a href="#h23-0-14" id="h23-0-14" class="i">+                    ),
</a><a href="#h23-0-15" id="h23-0-15" class="i">+                ),
</a><a href="#h23-0-16" id="h23-0-16" class="i">+                Constant(
</a><a href="#h23-0-17" id="h23-0-17" class="i">+                    String(
</a><a href="#h23-0-18" id="h23-0-18" class="i">+                        &quot;Western&quot;,
</a><a href="#h23-0-19" id="h23-0-19" class="i">+                    ),
</a><a href="#h23-0-20" id="h23-0-20" class="i">+                ),
</a><a href="#h23-0-21" id="h23-0-21" class="i">+            ],
</a><a href="#h23-0-22" id="h23-0-22" class="i">+        ],
</a><a href="#h23-0-23" id="h23-0-23" class="i">+    },
</a><a href="#h23-0-24" id="h23-0-24" class="i">+}
</a><a href="#h23-0-25" id="h23-0-25" class="i">+
</a> Query: INSERT INTO genres (id) VALUES (9, &#39;Western&#39;)
 
 Result: Value(&quot;Column and value counts do not match&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h24" href="../file/src/sql/testdata/insert_error_datatype_conflict.html">src/sql/testdata/insert_error_datatype_conflict</a> b/<a href="../file/src/sql/testdata/insert_error_datatype_conflict.html">src/sql/testdata/insert_error_datatype_conflict</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -51,6 +51,27 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h24-0-3" id="h24-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h24-0-4" id="h24-0-4" class="i">+    root: Insert {
</a><a href="#h24-0-5" id="h24-0-5" class="i">+        table: &quot;genres&quot;,
</a><a href="#h24-0-6" id="h24-0-6" class="i">+        columns: [],
</a><a href="#h24-0-7" id="h24-0-7" class="i">+        expressions: [
</a><a href="#h24-0-8" id="h24-0-8" class="i">+            [
</a><a href="#h24-0-9" id="h24-0-9" class="i">+                Constant(
</a><a href="#h24-0-10" id="h24-0-10" class="i">+                    Integer(
</a><a href="#h24-0-11" id="h24-0-11" class="i">+                        9,
</a><a href="#h24-0-12" id="h24-0-12" class="i">+                    ),
</a><a href="#h24-0-13" id="h24-0-13" class="i">+                ),
</a><a href="#h24-0-14" id="h24-0-14" class="i">+                Constant(
</a><a href="#h24-0-15" id="h24-0-15" class="i">+                    Float(
</a><a href="#h24-0-16" id="h24-0-16" class="i">+                        3.14,
</a><a href="#h24-0-17" id="h24-0-17" class="i">+                    ),
</a><a href="#h24-0-18" id="h24-0-18" class="i">+                ),
</a><a href="#h24-0-19" id="h24-0-19" class="i">+            ],
</a><a href="#h24-0-20" id="h24-0-20" class="i">+        ],
</a><a href="#h24-0-21" id="h24-0-21" class="i">+    },
</a><a href="#h24-0-22" id="h24-0-22" class="i">+}
</a><a href="#h24-0-23" id="h24-0-23" class="i">+
</a> Query: INSERT INTO genres VALUES (9, 3.14)
 
 Result: Value(&quot;Invalid datatype FLOAT for VARCHAR column name&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h25" href="../file/src/sql/testdata/insert_error_default_null_disallowed.html">src/sql/testdata/insert_error_default_null_disallowed</a> b/<a href="../file/src/sql/testdata/insert_error_default_null_disallowed.html">src/sql/testdata/insert_error_default_null_disallowed</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -39,6 +39,22 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h25-0-3" id="h25-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h25-0-4" id="h25-0-4" class="i">+    root: Insert {
</a><a href="#h25-0-5" id="h25-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h25-0-6" id="h25-0-6" class="i">+        columns: [],
</a><a href="#h25-0-7" id="h25-0-7" class="i">+        expressions: [
</a><a href="#h25-0-8" id="h25-0-8" class="i">+            [
</a><a href="#h25-0-9" id="h25-0-9" class="i">+                Constant(
</a><a href="#h25-0-10" id="h25-0-10" class="i">+                    Integer(
</a><a href="#h25-0-11" id="h25-0-11" class="i">+                        9,
</a><a href="#h25-0-12" id="h25-0-12" class="i">+                    ),
</a><a href="#h25-0-13" id="h25-0-13" class="i">+                ),
</a><a href="#h25-0-14" id="h25-0-14" class="i">+            ],
</a><a href="#h25-0-15" id="h25-0-15" class="i">+        ],
</a><a href="#h25-0-16" id="h25-0-16" class="i">+    },
</a><a href="#h25-0-17" id="h25-0-17" class="i">+}
</a><a href="#h25-0-18" id="h25-0-18" class="i">+
</a> Query: INSERT INTO movies VALUES (9)
 
 Result: Value(&quot;NULL value not allowed for column title&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h26" href="../file/src/sql/testdata/insert_error_null_disallowed.html">src/sql/testdata/insert_error_null_disallowed</a> b/<a href="../file/src/sql/testdata/insert_error_null_disallowed.html">src/sql/testdata/insert_error_null_disallowed</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -47,6 +47,25 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h26-0-3" id="h26-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h26-0-4" id="h26-0-4" class="i">+    root: Insert {
</a><a href="#h26-0-5" id="h26-0-5" class="i">+        table: &quot;genres&quot;,
</a><a href="#h26-0-6" id="h26-0-6" class="i">+        columns: [],
</a><a href="#h26-0-7" id="h26-0-7" class="i">+        expressions: [
</a><a href="#h26-0-8" id="h26-0-8" class="i">+            [
</a><a href="#h26-0-9" id="h26-0-9" class="i">+                Constant(
</a><a href="#h26-0-10" id="h26-0-10" class="i">+                    Integer(
</a><a href="#h26-0-11" id="h26-0-11" class="i">+                        9,
</a><a href="#h26-0-12" id="h26-0-12" class="i">+                    ),
</a><a href="#h26-0-13" id="h26-0-13" class="i">+                ),
</a><a href="#h26-0-14" id="h26-0-14" class="i">+                Constant(
</a><a href="#h26-0-15" id="h26-0-15" class="i">+                    Null,
</a><a href="#h26-0-16" id="h26-0-16" class="i">+                ),
</a><a href="#h26-0-17" id="h26-0-17" class="i">+            ],
</a><a href="#h26-0-18" id="h26-0-18" class="i">+        ],
</a><a href="#h26-0-19" id="h26-0-19" class="i">+    },
</a><a href="#h26-0-20" id="h26-0-20" class="i">+}
</a><a href="#h26-0-21" id="h26-0-21" class="i">+
</a> Query: INSERT INTO genres VALUES (9, NULL)
 
 Result: Value(&quot;NULL value not allowed for column name&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h27" href="../file/src/sql/testdata/insert_error_pk_exists.html">src/sql/testdata/insert_error_pk_exists</a> b/<a href="../file/src/sql/testdata/insert_error_pk_exists.html">src/sql/testdata/insert_error_pk_exists</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -51,6 +51,27 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h27-0-3" id="h27-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h27-0-4" id="h27-0-4" class="i">+    root: Insert {
</a><a href="#h27-0-5" id="h27-0-5" class="i">+        table: &quot;genres&quot;,
</a><a href="#h27-0-6" id="h27-0-6" class="i">+        columns: [],
</a><a href="#h27-0-7" id="h27-0-7" class="i">+        expressions: [
</a><a href="#h27-0-8" id="h27-0-8" class="i">+            [
</a><a href="#h27-0-9" id="h27-0-9" class="i">+                Constant(
</a><a href="#h27-0-10" id="h27-0-10" class="i">+                    Integer(
</a><a href="#h27-0-11" id="h27-0-11" class="i">+                        1,
</a><a href="#h27-0-12" id="h27-0-12" class="i">+                    ),
</a><a href="#h27-0-13" id="h27-0-13" class="i">+                ),
</a><a href="#h27-0-14" id="h27-0-14" class="i">+                Constant(
</a><a href="#h27-0-15" id="h27-0-15" class="i">+                    String(
</a><a href="#h27-0-16" id="h27-0-16" class="i">+                        &quot;Western&quot;,
</a><a href="#h27-0-17" id="h27-0-17" class="i">+                    ),
</a><a href="#h27-0-18" id="h27-0-18" class="i">+                ),
</a><a href="#h27-0-19" id="h27-0-19" class="i">+            ],
</a><a href="#h27-0-20" id="h27-0-20" class="i">+        ],
</a><a href="#h27-0-21" id="h27-0-21" class="i">+    },
</a><a href="#h27-0-22" id="h27-0-22" class="i">+}
</a><a href="#h27-0-23" id="h27-0-23" class="i">+
</a> Query: INSERT INTO genres VALUES (1, &#39;Western&#39;)
 
 Result: Value(&quot;Primary key 1 already exists for table genres&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h28" href="../file/src/sql/testdata/insert_error_pk_null.html">src/sql/testdata/insert_error_pk_null</a> b/<a href="../file/src/sql/testdata/insert_error_pk_null.html">src/sql/testdata/insert_error_pk_null</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -47,6 +47,25 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h28-0-3" id="h28-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h28-0-4" id="h28-0-4" class="i">+    root: Insert {
</a><a href="#h28-0-5" id="h28-0-5" class="i">+        table: &quot;genres&quot;,
</a><a href="#h28-0-6" id="h28-0-6" class="i">+        columns: [],
</a><a href="#h28-0-7" id="h28-0-7" class="i">+        expressions: [
</a><a href="#h28-0-8" id="h28-0-8" class="i">+            [
</a><a href="#h28-0-9" id="h28-0-9" class="i">+                Constant(
</a><a href="#h28-0-10" id="h28-0-10" class="i">+                    Null,
</a><a href="#h28-0-11" id="h28-0-11" class="i">+                ),
</a><a href="#h28-0-12" id="h28-0-12" class="i">+                Constant(
</a><a href="#h28-0-13" id="h28-0-13" class="i">+                    String(
</a><a href="#h28-0-14" id="h28-0-14" class="i">+                        &quot;Western&quot;,
</a><a href="#h28-0-15" id="h28-0-15" class="i">+                    ),
</a><a href="#h28-0-16" id="h28-0-16" class="i">+                ),
</a><a href="#h28-0-17" id="h28-0-17" class="i">+            ],
</a><a href="#h28-0-18" id="h28-0-18" class="i">+        ],
</a><a href="#h28-0-19" id="h28-0-19" class="i">+    },
</a><a href="#h28-0-20" id="h28-0-20" class="i">+}
</a><a href="#h28-0-21" id="h28-0-21" class="i">+
</a> Query: INSERT INTO genres VALUES (NULL, &#39;Western&#39;)
 
 Result: Value(&quot;NULL value not allowed for column id&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h29" href="../file/src/sql/testdata/insert_expression.html">src/sql/testdata/insert_expression</a> b/<a href="../file/src/sql/testdata/insert_expression.html">src/sql/testdata/insert_expression</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -275,6 +275,47 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h29-0-3" id="h29-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h29-0-4" id="h29-0-4" class="i">+    root: Insert {
</a><a href="#h29-0-5" id="h29-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h29-0-6" id="h29-0-6" class="i">+        columns: [],
</a><a href="#h29-0-7" id="h29-0-7" class="i">+        expressions: [
</a><a href="#h29-0-8" id="h29-0-8" class="i">+            [
</a><a href="#h29-0-9" id="h29-0-9" class="i">+                Constant(
</a><a href="#h29-0-10" id="h29-0-10" class="i">+                    Integer(
</a><a href="#h29-0-11" id="h29-0-11" class="i">+                        9,
</a><a href="#h29-0-12" id="h29-0-12" class="i">+                    ),
</a><a href="#h29-0-13" id="h29-0-13" class="i">+                ),
</a><a href="#h29-0-14" id="h29-0-14" class="i">+                Constant(
</a><a href="#h29-0-15" id="h29-0-15" class="i">+                    String(
</a><a href="#h29-0-16" id="h29-0-16" class="i">+                        &quot;District 9&quot;,
</a><a href="#h29-0-17" id="h29-0-17" class="i">+                    ),
</a><a href="#h29-0-18" id="h29-0-18" class="i">+                ),
</a><a href="#h29-0-19" id="h29-0-19" class="i">+                Constant(
</a><a href="#h29-0-20" id="h29-0-20" class="i">+                    Integer(
</a><a href="#h29-0-21" id="h29-0-21" class="i">+                        1,
</a><a href="#h29-0-22" id="h29-0-22" class="i">+                    ),
</a><a href="#h29-0-23" id="h29-0-23" class="i">+                ),
</a><a href="#h29-0-24" id="h29-0-24" class="i">+                Constant(
</a><a href="#h29-0-25" id="h29-0-25" class="i">+                    Integer(
</a><a href="#h29-0-26" id="h29-0-26" class="i">+                        2009,
</a><a href="#h29-0-27" id="h29-0-27" class="i">+                    ),
</a><a href="#h29-0-28" id="h29-0-28" class="i">+                ),
</a><a href="#h29-0-29" id="h29-0-29" class="i">+                Constant(
</a><a href="#h29-0-30" id="h29-0-30" class="i">+                    Float(
</a><a href="#h29-0-31" id="h29-0-31" class="i">+                        7.93,
</a><a href="#h29-0-32" id="h29-0-32" class="i">+                    ),
</a><a href="#h29-0-33" id="h29-0-33" class="i">+                ),
</a><a href="#h29-0-34" id="h29-0-34" class="i">+                Constant(
</a><a href="#h29-0-35" id="h29-0-35" class="i">+                    Boolean(
</a><a href="#h29-0-36" id="h29-0-36" class="i">+                        true,
</a><a href="#h29-0-37" id="h29-0-37" class="i">+                    ),
</a><a href="#h29-0-38" id="h29-0-38" class="i">+                ),
</a><a href="#h29-0-39" id="h29-0-39" class="i">+            ],
</a><a href="#h29-0-40" id="h29-0-40" class="i">+        ],
</a><a href="#h29-0-41" id="h29-0-41" class="i">+    },
</a><a href="#h29-0-42" id="h29-0-42" class="i">+}
</a><a href="#h29-0-43" id="h29-0-43" class="i">+
</a> Query: INSERT INTO movies VALUES (2 * 5 - 1, &#39;District 9&#39;, 1000 ^ 0, 2 * 1000 + 1 * 10 - --1, 793 / 1e2, TRUE OR FALSE)
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h30" href="../file/src/sql/testdata/insert_partial.html">src/sql/testdata/insert_partial</a> b/<a href="../file/src/sql/testdata/insert_partial.html">src/sql/testdata/insert_partial</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -112,6 +112,48 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h30-0-3" id="h30-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h30-0-4" id="h30-0-4" class="i">+    root: Insert {
</a><a href="#h30-0-5" id="h30-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h30-0-6" id="h30-0-6" class="i">+        columns: [
</a><a href="#h30-0-7" id="h30-0-7" class="i">+            &quot;title&quot;,
</a><a href="#h30-0-8" id="h30-0-8" class="i">+            &quot;released&quot;,
</a><a href="#h30-0-9" id="h30-0-9" class="i">+            &quot;id&quot;,
</a><a href="#h30-0-10" id="h30-0-10" class="i">+            &quot;genre_id&quot;,
</a><a href="#h30-0-11" id="h30-0-11" class="i">+            &quot;rating&quot;,
</a><a href="#h30-0-12" id="h30-0-12" class="i">+        ],
</a><a href="#h30-0-13" id="h30-0-13" class="i">+        expressions: [
</a><a href="#h30-0-14" id="h30-0-14" class="i">+            [
</a><a href="#h30-0-15" id="h30-0-15" class="i">+                Constant(
</a><a href="#h30-0-16" id="h30-0-16" class="i">+                    String(
</a><a href="#h30-0-17" id="h30-0-17" class="i">+                        &quot;District 9&quot;,
</a><a href="#h30-0-18" id="h30-0-18" class="i">+                    ),
</a><a href="#h30-0-19" id="h30-0-19" class="i">+                ),
</a><a href="#h30-0-20" id="h30-0-20" class="i">+                Constant(
</a><a href="#h30-0-21" id="h30-0-21" class="i">+                    Integer(
</a><a href="#h30-0-22" id="h30-0-22" class="i">+                        2009,
</a><a href="#h30-0-23" id="h30-0-23" class="i">+                    ),
</a><a href="#h30-0-24" id="h30-0-24" class="i">+                ),
</a><a href="#h30-0-25" id="h30-0-25" class="i">+                Constant(
</a><a href="#h30-0-26" id="h30-0-26" class="i">+                    Integer(
</a><a href="#h30-0-27" id="h30-0-27" class="i">+                        9,
</a><a href="#h30-0-28" id="h30-0-28" class="i">+                    ),
</a><a href="#h30-0-29" id="h30-0-29" class="i">+                ),
</a><a href="#h30-0-30" id="h30-0-30" class="i">+                Constant(
</a><a href="#h30-0-31" id="h30-0-31" class="i">+                    Integer(
</a><a href="#h30-0-32" id="h30-0-32" class="i">+                        1,
</a><a href="#h30-0-33" id="h30-0-33" class="i">+                    ),
</a><a href="#h30-0-34" id="h30-0-34" class="i">+                ),
</a><a href="#h30-0-35" id="h30-0-35" class="i">+                Constant(
</a><a href="#h30-0-36" id="h30-0-36" class="i">+                    Float(
</a><a href="#h30-0-37" id="h30-0-37" class="i">+                        7.9,
</a><a href="#h30-0-38" id="h30-0-38" class="i">+                    ),
</a><a href="#h30-0-39" id="h30-0-39" class="i">+                ),
</a><a href="#h30-0-40" id="h30-0-40" class="i">+            ],
</a><a href="#h30-0-41" id="h30-0-41" class="i">+        ],
</a><a href="#h30-0-42" id="h30-0-42" class="i">+    },
</a><a href="#h30-0-43" id="h30-0-43" class="i">+}
</a><a href="#h30-0-44" id="h30-0-44" class="i">+
</a> Query: INSERT INTO movies (title, released, id, genre_id, rating) VALUES (&#39;District 9&#39;, 2009, 9, 1, 7.9)
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h31" href="../file/src/sql/testdata/insert_values.html">src/sql/testdata/insert_values</a> b/<a href="../file/src/sql/testdata/insert_values.html">src/sql/testdata/insert_values</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -51,6 +51,27 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h31-0-3" id="h31-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h31-0-4" id="h31-0-4" class="i">+    root: Insert {
</a><a href="#h31-0-5" id="h31-0-5" class="i">+        table: &quot;genres&quot;,
</a><a href="#h31-0-6" id="h31-0-6" class="i">+        columns: [],
</a><a href="#h31-0-7" id="h31-0-7" class="i">+        expressions: [
</a><a href="#h31-0-8" id="h31-0-8" class="i">+            [
</a><a href="#h31-0-9" id="h31-0-9" class="i">+                Constant(
</a><a href="#h31-0-10" id="h31-0-10" class="i">+                    Integer(
</a><a href="#h31-0-11" id="h31-0-11" class="i">+                        9,
</a><a href="#h31-0-12" id="h31-0-12" class="i">+                    ),
</a><a href="#h31-0-13" id="h31-0-13" class="i">+                ),
</a><a href="#h31-0-14" id="h31-0-14" class="i">+                Constant(
</a><a href="#h31-0-15" id="h31-0-15" class="i">+                    String(
</a><a href="#h31-0-16" id="h31-0-16" class="i">+                        &quot;Western&quot;,
</a><a href="#h31-0-17" id="h31-0-17" class="i">+                    ),
</a><a href="#h31-0-18" id="h31-0-18" class="i">+                ),
</a><a href="#h31-0-19" id="h31-0-19" class="i">+            ],
</a><a href="#h31-0-20" id="h31-0-20" class="i">+        ],
</a><a href="#h31-0-21" id="h31-0-21" class="i">+    },
</a><a href="#h31-0-22" id="h31-0-22" class="i">+}
</a><a href="#h31-0-23" id="h31-0-23" class="i">+
</a> Query: INSERT INTO genres VALUES (9, &#39;Western&#39;)
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h32" href="../file/src/sql/testdata/select_aliases.html">src/sql/testdata/select_aliases</a> b/<a href="../file/src/sql/testdata/select_aliases.html">src/sql/testdata/select_aliases</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -79,6 +79,38 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h32-0-3" id="h32-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h32-0-4" id="h32-0-4" class="i">+    root: Projection {
</a><a href="#h32-0-5" id="h32-0-5" class="i">+        source: Nothing,
</a><a href="#h32-0-6" id="h32-0-6" class="i">+        labels: [
</a><a href="#h32-0-7" id="h32-0-7" class="i">+            None,
</a><a href="#h32-0-8" id="h32-0-8" class="i">+            Some(
</a><a href="#h32-0-9" id="h32-0-9" class="i">+                &quot;b&quot;,
</a><a href="#h32-0-10" id="h32-0-10" class="i">+            ),
</a><a href="#h32-0-11" id="h32-0-11" class="i">+            Some(
</a><a href="#h32-0-12" id="h32-0-12" class="i">+                &quot;c&quot;,
</a><a href="#h32-0-13" id="h32-0-13" class="i">+            ),
</a><a href="#h32-0-14" id="h32-0-14" class="i">+        ],
</a><a href="#h32-0-15" id="h32-0-15" class="i">+        expressions: [
</a><a href="#h32-0-16" id="h32-0-16" class="i">+            Constant(
</a><a href="#h32-0-17" id="h32-0-17" class="i">+                Integer(
</a><a href="#h32-0-18" id="h32-0-18" class="i">+                    1,
</a><a href="#h32-0-19" id="h32-0-19" class="i">+                ),
</a><a href="#h32-0-20" id="h32-0-20" class="i">+            ),
</a><a href="#h32-0-21" id="h32-0-21" class="i">+            Constant(
</a><a href="#h32-0-22" id="h32-0-22" class="i">+                Integer(
</a><a href="#h32-0-23" id="h32-0-23" class="i">+                    2,
</a><a href="#h32-0-24" id="h32-0-24" class="i">+                ),
</a><a href="#h32-0-25" id="h32-0-25" class="i">+            ),
</a><a href="#h32-0-26" id="h32-0-26" class="i">+            Constant(
</a><a href="#h32-0-27" id="h32-0-27" class="i">+                Integer(
</a><a href="#h32-0-28" id="h32-0-28" class="i">+                    3,
</a><a href="#h32-0-29" id="h32-0-29" class="i">+                ),
</a><a href="#h32-0-30" id="h32-0-30" class="i">+            ),
</a><a href="#h32-0-31" id="h32-0-31" class="i">+        ],
</a><a href="#h32-0-32" id="h32-0-32" class="i">+    },
</a><a href="#h32-0-33" id="h32-0-33" class="i">+}
</a><a href="#h32-0-34" id="h32-0-34" class="i">+
</a> Query: SELECT 1, 2 b, 3 AS c
 
 Result: [[&quot;?&quot;, &quot;b&quot;, &quot;c&quot;]]
<b>diff --git a/<a id="h33" href="../file/src/sql/testdata/select_all_from_table.html">src/sql/testdata/select_all_from_table</a> b/<a href="../file/src/sql/testdata/select_all_from_table.html">src/sql/testdata/select_all_from_table</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -30,6 +30,12 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h33-0-3" id="h33-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h33-0-4" id="h33-0-4" class="i">+    root: Scan {
</a><a href="#h33-0-5" id="h33-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h33-0-6" id="h33-0-6" class="i">+    },
</a><a href="#h33-0-7" id="h33-0-7" class="i">+}
</a><a href="#h33-0-8" id="h33-0-8" class="i">+
</a> Query: SELECT * FROM movies
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h34" href="../file/src/sql/testdata/select_error_where_nonboolean.html">src/sql/testdata/select_error_where_nonboolean</a> b/<a href="../file/src/sql/testdata/select_error_where_nonboolean.html">src/sql/testdata/select_error_where_nonboolean</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -47,6 +47,19 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h34-0-3" id="h34-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h34-0-4" id="h34-0-4" class="i">+    root: Filter {
</a><a href="#h34-0-5" id="h34-0-5" class="i">+        source: Scan {
</a><a href="#h34-0-6" id="h34-0-6" class="i">+            table: &quot;movies&quot;,
</a><a href="#h34-0-7" id="h34-0-7" class="i">+        },
</a><a href="#h34-0-8" id="h34-0-8" class="i">+        predicate: Constant(
</a><a href="#h34-0-9" id="h34-0-9" class="i">+            Integer(
</a><a href="#h34-0-10" id="h34-0-10" class="i">+                1,
</a><a href="#h34-0-11" id="h34-0-11" class="i">+            ),
</a><a href="#h34-0-12" id="h34-0-12" class="i">+        ),
</a><a href="#h34-0-13" id="h34-0-13" class="i">+    },
</a><a href="#h34-0-14" id="h34-0-14" class="i">+}
</a><a href="#h34-0-15" id="h34-0-15" class="i">+
</a> Query: SELECT * FROM movies WHERE 1
 
 Result: Value(&quot;Unexpected value 1 for filter, expected boolean&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h35" href="../file/src/sql/testdata/select_expr_where_false.html">src/sql/testdata/select_expr_where_false</a> b/<a href="../file/src/sql/testdata/select_expr_where_false.html">src/sql/testdata/select_expr_where_false</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -57,6 +57,29 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h35-0-3" id="h35-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h35-0-4" id="h35-0-4" class="i">+    root: Projection {
</a><a href="#h35-0-5" id="h35-0-5" class="i">+        source: Filter {
</a><a href="#h35-0-6" id="h35-0-6" class="i">+            source: Nothing,
</a><a href="#h35-0-7" id="h35-0-7" class="i">+            predicate: Constant(
</a><a href="#h35-0-8" id="h35-0-8" class="i">+                Boolean(
</a><a href="#h35-0-9" id="h35-0-9" class="i">+                    false,
</a><a href="#h35-0-10" id="h35-0-10" class="i">+                ),
</a><a href="#h35-0-11" id="h35-0-11" class="i">+            ),
</a><a href="#h35-0-12" id="h35-0-12" class="i">+        },
</a><a href="#h35-0-13" id="h35-0-13" class="i">+        labels: [
</a><a href="#h35-0-14" id="h35-0-14" class="i">+            None,
</a><a href="#h35-0-15" id="h35-0-15" class="i">+        ],
</a><a href="#h35-0-16" id="h35-0-16" class="i">+        expressions: [
</a><a href="#h35-0-17" id="h35-0-17" class="i">+            Constant(
</a><a href="#h35-0-18" id="h35-0-18" class="i">+                Integer(
</a><a href="#h35-0-19" id="h35-0-19" class="i">+                    1,
</a><a href="#h35-0-20" id="h35-0-20" class="i">+                ),
</a><a href="#h35-0-21" id="h35-0-21" class="i">+            ),
</a><a href="#h35-0-22" id="h35-0-22" class="i">+        ],
</a><a href="#h35-0-23" id="h35-0-23" class="i">+    },
</a><a href="#h35-0-24" id="h35-0-24" class="i">+}
</a><a href="#h35-0-25" id="h35-0-25" class="i">+
</a> Query: SELECT 1 WHERE FALSE
 
 Result: [[&quot;?&quot;]]
<b>diff --git a/<a id="h36" href="../file/src/sql/testdata/select_expr_where_true.html">src/sql/testdata/select_expr_where_true</a> b/<a href="../file/src/sql/testdata/select_expr_where_true.html">src/sql/testdata/select_expr_where_true</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -57,6 +57,29 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h36-0-3" id="h36-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h36-0-4" id="h36-0-4" class="i">+    root: Projection {
</a><a href="#h36-0-5" id="h36-0-5" class="i">+        source: Filter {
</a><a href="#h36-0-6" id="h36-0-6" class="i">+            source: Nothing,
</a><a href="#h36-0-7" id="h36-0-7" class="i">+            predicate: Constant(
</a><a href="#h36-0-8" id="h36-0-8" class="i">+                Boolean(
</a><a href="#h36-0-9" id="h36-0-9" class="i">+                    true,
</a><a href="#h36-0-10" id="h36-0-10" class="i">+                ),
</a><a href="#h36-0-11" id="h36-0-11" class="i">+            ),
</a><a href="#h36-0-12" id="h36-0-12" class="i">+        },
</a><a href="#h36-0-13" id="h36-0-13" class="i">+        labels: [
</a><a href="#h36-0-14" id="h36-0-14" class="i">+            None,
</a><a href="#h36-0-15" id="h36-0-15" class="i">+        ],
</a><a href="#h36-0-16" id="h36-0-16" class="i">+        expressions: [
</a><a href="#h36-0-17" id="h36-0-17" class="i">+            Constant(
</a><a href="#h36-0-18" id="h36-0-18" class="i">+                Integer(
</a><a href="#h36-0-19" id="h36-0-19" class="i">+                    1,
</a><a href="#h36-0-20" id="h36-0-20" class="i">+                ),
</a><a href="#h36-0-21" id="h36-0-21" class="i">+            ),
</a><a href="#h36-0-22" id="h36-0-22" class="i">+        ],
</a><a href="#h36-0-23" id="h36-0-23" class="i">+    },
</a><a href="#h36-0-24" id="h36-0-24" class="i">+}
</a><a href="#h36-0-25" id="h36-0-25" class="i">+
</a> Query: SELECT 1 WHERE TRUE
 
 Result: [[&quot;?&quot;]]
<b>diff --git a/<a id="h37" href="../file/src/sql/testdata/select_fields.html">src/sql/testdata/select_fields</a> b/<a href="../file/src/sql/testdata/select_fields.html">src/sql/testdata/select_fields</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -108,6 +108,46 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h37-0-3" id="h37-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h37-0-4" id="h37-0-4" class="i">+    root: Projection {
</a><a href="#h37-0-5" id="h37-0-5" class="i">+        source: Scan {
</a><a href="#h37-0-6" id="h37-0-6" class="i">+            table: &quot;movies&quot;,
</a><a href="#h37-0-7" id="h37-0-7" class="i">+        },
</a><a href="#h37-0-8" id="h37-0-8" class="i">+        labels: [
</a><a href="#h37-0-9" id="h37-0-9" class="i">+            None,
</a><a href="#h37-0-10" id="h37-0-10" class="i">+            Some(
</a><a href="#h37-0-11" id="h37-0-11" class="i">+                &quot;age&quot;,
</a><a href="#h37-0-12" id="h37-0-12" class="i">+            ),
</a><a href="#h37-0-13" id="h37-0-13" class="i">+            None,
</a><a href="#h37-0-14" id="h37-0-14" class="i">+        ],
</a><a href="#h37-0-15" id="h37-0-15" class="i">+        expressions: [
</a><a href="#h37-0-16" id="h37-0-16" class="i">+            Field(
</a><a href="#h37-0-17" id="h37-0-17" class="i">+                &quot;title&quot;,
</a><a href="#h37-0-18" id="h37-0-18" class="i">+            ),
</a><a href="#h37-0-19" id="h37-0-19" class="i">+            Subtract(
</a><a href="#h37-0-20" id="h37-0-20" class="i">+                Constant(
</a><a href="#h37-0-21" id="h37-0-21" class="i">+                    Integer(
</a><a href="#h37-0-22" id="h37-0-22" class="i">+                        2019,
</a><a href="#h37-0-23" id="h37-0-23" class="i">+                    ),
</a><a href="#h37-0-24" id="h37-0-24" class="i">+                ),
</a><a href="#h37-0-25" id="h37-0-25" class="i">+                Field(
</a><a href="#h37-0-26" id="h37-0-26" class="i">+                    &quot;released&quot;,
</a><a href="#h37-0-27" id="h37-0-27" class="i">+                ),
</a><a href="#h37-0-28" id="h37-0-28" class="i">+            ),
</a><a href="#h37-0-29" id="h37-0-29" class="i">+            Multiply(
</a><a href="#h37-0-30" id="h37-0-30" class="i">+                Field(
</a><a href="#h37-0-31" id="h37-0-31" class="i">+                    &quot;rating&quot;,
</a><a href="#h37-0-32" id="h37-0-32" class="i">+                ),
</a><a href="#h37-0-33" id="h37-0-33" class="i">+                Constant(
</a><a href="#h37-0-34" id="h37-0-34" class="i">+                    Integer(
</a><a href="#h37-0-35" id="h37-0-35" class="i">+                        10,
</a><a href="#h37-0-36" id="h37-0-36" class="i">+                    ),
</a><a href="#h37-0-37" id="h37-0-37" class="i">+                ),
</a><a href="#h37-0-38" id="h37-0-38" class="i">+            ),
</a><a href="#h37-0-39" id="h37-0-39" class="i">+        ],
</a><a href="#h37-0-40" id="h37-0-40" class="i">+    },
</a><a href="#h37-0-41" id="h37-0-41" class="i">+}
</a><a href="#h37-0-42" id="h37-0-42" class="i">+
</a> Query: SELECT title, 2019 - released AS age, rating * 10 FROM movies
 
 Result: [[&quot;title&quot;, &quot;age&quot;, &quot;?&quot;]]
<b>diff --git a/<a id="h38" href="../file/src/sql/testdata/select_limit.html">src/sql/testdata/select_limit</a> b/<a href="../file/src/sql/testdata/select_limit.html">src/sql/testdata/select_limit</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -61,6 +61,25 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h38-0-3" id="h38-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h38-0-4" id="h38-0-4" class="i">+    root: Limit {
</a><a href="#h38-0-5" id="h38-0-5" class="i">+        source: Order {
</a><a href="#h38-0-6" id="h38-0-6" class="i">+            source: Scan {
</a><a href="#h38-0-7" id="h38-0-7" class="i">+                table: &quot;movies&quot;,
</a><a href="#h38-0-8" id="h38-0-8" class="i">+            },
</a><a href="#h38-0-9" id="h38-0-9" class="i">+            orders: [
</a><a href="#h38-0-10" id="h38-0-10" class="i">+                (
</a><a href="#h38-0-11" id="h38-0-11" class="i">+                    Field(
</a><a href="#h38-0-12" id="h38-0-12" class="i">+                        &quot;id&quot;,
</a><a href="#h38-0-13" id="h38-0-13" class="i">+                    ),
</a><a href="#h38-0-14" id="h38-0-14" class="i">+                    Ascending,
</a><a href="#h38-0-15" id="h38-0-15" class="i">+                ),
</a><a href="#h38-0-16" id="h38-0-16" class="i">+            ],
</a><a href="#h38-0-17" id="h38-0-17" class="i">+        },
</a><a href="#h38-0-18" id="h38-0-18" class="i">+        limit: 2,
</a><a href="#h38-0-19" id="h38-0-19" class="i">+    },
</a><a href="#h38-0-20" id="h38-0-20" class="i">+}
</a><a href="#h38-0-21" id="h38-0-21" class="i">+
</a> Query: SELECT * FROM movies ORDER BY id LIMIT 2
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h39" href="../file/src/sql/testdata/select_limit_offset.html">src/sql/testdata/select_limit_offset</a> b/<a href="../file/src/sql/testdata/select_limit_offset.html">src/sql/testdata/select_limit_offset</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -72,6 +72,28 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h39-0-3" id="h39-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h39-0-4" id="h39-0-4" class="i">+    root: Limit {
</a><a href="#h39-0-5" id="h39-0-5" class="i">+        source: Offset {
</a><a href="#h39-0-6" id="h39-0-6" class="i">+            source: Order {
</a><a href="#h39-0-7" id="h39-0-7" class="i">+                source: Scan {
</a><a href="#h39-0-8" id="h39-0-8" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h39-0-9" id="h39-0-9" class="i">+                },
</a><a href="#h39-0-10" id="h39-0-10" class="i">+                orders: [
</a><a href="#h39-0-11" id="h39-0-11" class="i">+                    (
</a><a href="#h39-0-12" id="h39-0-12" class="i">+                        Field(
</a><a href="#h39-0-13" id="h39-0-13" class="i">+                            &quot;id&quot;,
</a><a href="#h39-0-14" id="h39-0-14" class="i">+                        ),
</a><a href="#h39-0-15" id="h39-0-15" class="i">+                        Ascending,
</a><a href="#h39-0-16" id="h39-0-16" class="i">+                    ),
</a><a href="#h39-0-17" id="h39-0-17" class="i">+                ],
</a><a href="#h39-0-18" id="h39-0-18" class="i">+            },
</a><a href="#h39-0-19" id="h39-0-19" class="i">+            offset: 2,
</a><a href="#h39-0-20" id="h39-0-20" class="i">+        },
</a><a href="#h39-0-21" id="h39-0-21" class="i">+        limit: 2,
</a><a href="#h39-0-22" id="h39-0-22" class="i">+    },
</a><a href="#h39-0-23" id="h39-0-23" class="i">+}
</a><a href="#h39-0-24" id="h39-0-24" class="i">+
</a> Query: SELECT * FROM movies ORDER BY id LIMIT 2 OFFSET 2
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h40" href="../file/src/sql/testdata/select_offset.html">src/sql/testdata/select_offset</a> b/<a href="../file/src/sql/testdata/select_offset.html">src/sql/testdata/select_offset</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -61,6 +61,25 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h40-0-3" id="h40-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h40-0-4" id="h40-0-4" class="i">+    root: Offset {
</a><a href="#h40-0-5" id="h40-0-5" class="i">+        source: Order {
</a><a href="#h40-0-6" id="h40-0-6" class="i">+            source: Scan {
</a><a href="#h40-0-7" id="h40-0-7" class="i">+                table: &quot;movies&quot;,
</a><a href="#h40-0-8" id="h40-0-8" class="i">+            },
</a><a href="#h40-0-9" id="h40-0-9" class="i">+            orders: [
</a><a href="#h40-0-10" id="h40-0-10" class="i">+                (
</a><a href="#h40-0-11" id="h40-0-11" class="i">+                    Field(
</a><a href="#h40-0-12" id="h40-0-12" class="i">+                        &quot;id&quot;,
</a><a href="#h40-0-13" id="h40-0-13" class="i">+                    ),
</a><a href="#h40-0-14" id="h40-0-14" class="i">+                    Ascending,
</a><a href="#h40-0-15" id="h40-0-15" class="i">+                ),
</a><a href="#h40-0-16" id="h40-0-16" class="i">+            ],
</a><a href="#h40-0-17" id="h40-0-17" class="i">+        },
</a><a href="#h40-0-18" id="h40-0-18" class="i">+        offset: 2,
</a><a href="#h40-0-19" id="h40-0-19" class="i">+    },
</a><a href="#h40-0-20" id="h40-0-20" class="i">+}
</a><a href="#h40-0-21" id="h40-0-21" class="i">+
</a> Query: SELECT * FROM movies ORDER BY id OFFSET 2
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h41" href="../file/src/sql/testdata/select_order.html">src/sql/testdata/select_order</a> b/<a href="../file/src/sql/testdata/select_order.html">src/sql/testdata/select_order</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -66,6 +66,28 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h41-0-3" id="h41-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h41-0-4" id="h41-0-4" class="i">+    root: Order {
</a><a href="#h41-0-5" id="h41-0-5" class="i">+        source: Scan {
</a><a href="#h41-0-6" id="h41-0-6" class="i">+            table: &quot;movies&quot;,
</a><a href="#h41-0-7" id="h41-0-7" class="i">+        },
</a><a href="#h41-0-8" id="h41-0-8" class="i">+        orders: [
</a><a href="#h41-0-9" id="h41-0-9" class="i">+            (
</a><a href="#h41-0-10" id="h41-0-10" class="i">+                Field(
</a><a href="#h41-0-11" id="h41-0-11" class="i">+                    &quot;bluray&quot;,
</a><a href="#h41-0-12" id="h41-0-12" class="i">+                ),
</a><a href="#h41-0-13" id="h41-0-13" class="i">+                Ascending,
</a><a href="#h41-0-14" id="h41-0-14" class="i">+            ),
</a><a href="#h41-0-15" id="h41-0-15" class="i">+            (
</a><a href="#h41-0-16" id="h41-0-16" class="i">+                Field(
</a><a href="#h41-0-17" id="h41-0-17" class="i">+                    &quot;released&quot;,
</a><a href="#h41-0-18" id="h41-0-18" class="i">+                ),
</a><a href="#h41-0-19" id="h41-0-19" class="i">+                Descending,
</a><a href="#h41-0-20" id="h41-0-20" class="i">+            ),
</a><a href="#h41-0-21" id="h41-0-21" class="i">+        ],
</a><a href="#h41-0-22" id="h41-0-22" class="i">+    },
</a><a href="#h41-0-23" id="h41-0-23" class="i">+}
</a><a href="#h41-0-24" id="h41-0-24" class="i">+
</a> Query: SELECT * FROM movies ORDER BY bluray ASC, released DESC
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h42" href="../file/src/sql/testdata/select_order_projection.html">src/sql/testdata/select_order_projection</a> b/<a href="../file/src/sql/testdata/select_order_projection.html">src/sql/testdata/select_order_projection</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -100,6 +100,45 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h42-0-3" id="h42-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h42-0-4" id="h42-0-4" class="i">+    root: Order {
</a><a href="#h42-0-5" id="h42-0-5" class="i">+        source: Projection {
</a><a href="#h42-0-6" id="h42-0-6" class="i">+            source: Scan {
</a><a href="#h42-0-7" id="h42-0-7" class="i">+                table: &quot;movies&quot;,
</a><a href="#h42-0-8" id="h42-0-8" class="i">+            },
</a><a href="#h42-0-9" id="h42-0-9" class="i">+            labels: [
</a><a href="#h42-0-10" id="h42-0-10" class="i">+                Some(
</a><a href="#h42-0-11" id="h42-0-11" class="i">+                    &quot;a&quot;,
</a><a href="#h42-0-12" id="h42-0-12" class="i">+                ),
</a><a href="#h42-0-13" id="h42-0-13" class="i">+                None,
</a><a href="#h42-0-14" id="h42-0-14" class="i">+            ],
</a><a href="#h42-0-15" id="h42-0-15" class="i">+            expressions: [
</a><a href="#h42-0-16" id="h42-0-16" class="i">+                Subtract(
</a><a href="#h42-0-17" id="h42-0-17" class="i">+                    Constant(
</a><a href="#h42-0-18" id="h42-0-18" class="i">+                        Integer(
</a><a href="#h42-0-19" id="h42-0-19" class="i">+                            5,
</a><a href="#h42-0-20" id="h42-0-20" class="i">+                        ),
</a><a href="#h42-0-21" id="h42-0-21" class="i">+                    ),
</a><a href="#h42-0-22" id="h42-0-22" class="i">+                    Field(
</a><a href="#h42-0-23" id="h42-0-23" class="i">+                        &quot;id&quot;,
</a><a href="#h42-0-24" id="h42-0-24" class="i">+                    ),
</a><a href="#h42-0-25" id="h42-0-25" class="i">+                ),
</a><a href="#h42-0-26" id="h42-0-26" class="i">+                Field(
</a><a href="#h42-0-27" id="h42-0-27" class="i">+                    &quot;title&quot;,
</a><a href="#h42-0-28" id="h42-0-28" class="i">+                ),
</a><a href="#h42-0-29" id="h42-0-29" class="i">+            ],
</a><a href="#h42-0-30" id="h42-0-30" class="i">+        },
</a><a href="#h42-0-31" id="h42-0-31" class="i">+        orders: [
</a><a href="#h42-0-32" id="h42-0-32" class="i">+            (
</a><a href="#h42-0-33" id="h42-0-33" class="i">+                Field(
</a><a href="#h42-0-34" id="h42-0-34" class="i">+                    &quot;a&quot;,
</a><a href="#h42-0-35" id="h42-0-35" class="i">+                ),
</a><a href="#h42-0-36" id="h42-0-36" class="i">+                Ascending,
</a><a href="#h42-0-37" id="h42-0-37" class="i">+            ),
</a><a href="#h42-0-38" id="h42-0-38" class="i">+        ],
</a><a href="#h42-0-39" id="h42-0-39" class="i">+    },
</a><a href="#h42-0-40" id="h42-0-40" class="i">+}
</a><a href="#h42-0-41" id="h42-0-41" class="i">+
</a> Query: SELECT 5 - id AS a, title FROM movies ORDER BY a
 
 Result: [[&quot;a&quot;, &quot;title&quot;]]
<b>diff --git a/<a id="h43" href="../file/src/sql/testdata/select_where.html">src/sql/testdata/select_where</a> b/<a href="../file/src/sql/testdata/select_where.html">src/sql/testdata/select_where</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -93,6 +93,36 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h43-0-3" id="h43-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h43-0-4" id="h43-0-4" class="i">+    root: Filter {
</a><a href="#h43-0-5" id="h43-0-5" class="i">+        source: Scan {
</a><a href="#h43-0-6" id="h43-0-6" class="i">+            table: &quot;movies&quot;,
</a><a href="#h43-0-7" id="h43-0-7" class="i">+        },
</a><a href="#h43-0-8" id="h43-0-8" class="i">+        predicate: And(
</a><a href="#h43-0-9" id="h43-0-9" class="i">+            CompareGTE(
</a><a href="#h43-0-10" id="h43-0-10" class="i">+                Field(
</a><a href="#h43-0-11" id="h43-0-11" class="i">+                    &quot;released&quot;,
</a><a href="#h43-0-12" id="h43-0-12" class="i">+                ),
</a><a href="#h43-0-13" id="h43-0-13" class="i">+                Constant(
</a><a href="#h43-0-14" id="h43-0-14" class="i">+                    Integer(
</a><a href="#h43-0-15" id="h43-0-15" class="i">+                        2000,
</a><a href="#h43-0-16" id="h43-0-16" class="i">+                    ),
</a><a href="#h43-0-17" id="h43-0-17" class="i">+                ),
</a><a href="#h43-0-18" id="h43-0-18" class="i">+            ),
</a><a href="#h43-0-19" id="h43-0-19" class="i">+            CompareGT(
</a><a href="#h43-0-20" id="h43-0-20" class="i">+                Field(
</a><a href="#h43-0-21" id="h43-0-21" class="i">+                    &quot;rating&quot;,
</a><a href="#h43-0-22" id="h43-0-22" class="i">+                ),
</a><a href="#h43-0-23" id="h43-0-23" class="i">+                Constant(
</a><a href="#h43-0-24" id="h43-0-24" class="i">+                    Integer(
</a><a href="#h43-0-25" id="h43-0-25" class="i">+                        7,
</a><a href="#h43-0-26" id="h43-0-26" class="i">+                    ),
</a><a href="#h43-0-27" id="h43-0-27" class="i">+                ),
</a><a href="#h43-0-28" id="h43-0-28" class="i">+            ),
</a><a href="#h43-0-29" id="h43-0-29" class="i">+        ),
</a><a href="#h43-0-30" id="h43-0-30" class="i">+    },
</a><a href="#h43-0-31" id="h43-0-31" class="i">+}
</a><a href="#h43-0-32" id="h43-0-32" class="i">+
</a> Query: SELECT * FROM movies WHERE released &gt;= 2000 AND rating &gt; 7
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h44" href="../file/src/sql/testdata/select_where_false.html">src/sql/testdata/select_where_false</a> b/<a href="../file/src/sql/testdata/select_where_false.html">src/sql/testdata/select_where_false</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -47,6 +47,19 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h44-0-3" id="h44-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h44-0-4" id="h44-0-4" class="i">+    root: Filter {
</a><a href="#h44-0-5" id="h44-0-5" class="i">+        source: Scan {
</a><a href="#h44-0-6" id="h44-0-6" class="i">+            table: &quot;movies&quot;,
</a><a href="#h44-0-7" id="h44-0-7" class="i">+        },
</a><a href="#h44-0-8" id="h44-0-8" class="i">+        predicate: Constant(
</a><a href="#h44-0-9" id="h44-0-9" class="i">+            Boolean(
</a><a href="#h44-0-10" id="h44-0-10" class="i">+                false,
</a><a href="#h44-0-11" id="h44-0-11" class="i">+            ),
</a><a href="#h44-0-12" id="h44-0-12" class="i">+        ),
</a><a href="#h44-0-13" id="h44-0-13" class="i">+    },
</a><a href="#h44-0-14" id="h44-0-14" class="i">+}
</a><a href="#h44-0-15" id="h44-0-15" class="i">+
</a> Query: SELECT * FROM movies WHERE FALSE
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h45" href="../file/src/sql/testdata/select_where_null.html">src/sql/testdata/select_where_null</a> b/<a href="../file/src/sql/testdata/select_where_null.html">src/sql/testdata/select_where_null</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -43,6 +43,17 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h45-0-3" id="h45-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h45-0-4" id="h45-0-4" class="i">+    root: Filter {
</a><a href="#h45-0-5" id="h45-0-5" class="i">+        source: Scan {
</a><a href="#h45-0-6" id="h45-0-6" class="i">+            table: &quot;movies&quot;,
</a><a href="#h45-0-7" id="h45-0-7" class="i">+        },
</a><a href="#h45-0-8" id="h45-0-8" class="i">+        predicate: Constant(
</a><a href="#h45-0-9" id="h45-0-9" class="i">+            Null,
</a><a href="#h45-0-10" id="h45-0-10" class="i">+        ),
</a><a href="#h45-0-11" id="h45-0-11" class="i">+    },
</a><a href="#h45-0-12" id="h45-0-12" class="i">+}
</a><a href="#h45-0-13" id="h45-0-13" class="i">+
</a> Query: SELECT * FROM movies WHERE NULL
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h46" href="../file/src/sql/testdata/select_where_true.html">src/sql/testdata/select_where_true</a> b/<a href="../file/src/sql/testdata/select_where_true.html">src/sql/testdata/select_where_true</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -47,6 +47,19 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h46-0-3" id="h46-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h46-0-4" id="h46-0-4" class="i">+    root: Filter {
</a><a href="#h46-0-5" id="h46-0-5" class="i">+        source: Scan {
</a><a href="#h46-0-6" id="h46-0-6" class="i">+            table: &quot;movies&quot;,
</a><a href="#h46-0-7" id="h46-0-7" class="i">+        },
</a><a href="#h46-0-8" id="h46-0-8" class="i">+        predicate: Constant(
</a><a href="#h46-0-9" id="h46-0-9" class="i">+            Boolean(
</a><a href="#h46-0-10" id="h46-0-10" class="i">+                true,
</a><a href="#h46-0-11" id="h46-0-11" class="i">+            ),
</a><a href="#h46-0-12" id="h46-0-12" class="i">+        ),
</a><a href="#h46-0-13" id="h46-0-13" class="i">+    },
</a><a href="#h46-0-14" id="h46-0-14" class="i">+}
</a><a href="#h46-0-15" id="h46-0-15" class="i">+
</a> Query: SELECT * FROM movies WHERE TRUE
 
 Result: [[&quot;id&quot;, &quot;title&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;bluray&quot;]]
<b>diff --git a/<a id="h47" href="../file/src/sql/testdata/update_all.html">src/sql/testdata/update_all</a> b/<a href="../file/src/sql/testdata/update_all.html">src/sql/testdata/update_all</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -60,6 +60,30 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h47-0-3" id="h47-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h47-0-4" id="h47-0-4" class="i">+    root: Update {
</a><a href="#h47-0-5" id="h47-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h47-0-6" id="h47-0-6" class="i">+        source: Scan {
</a><a href="#h47-0-7" id="h47-0-7" class="i">+            table: &quot;movies&quot;,
</a><a href="#h47-0-8" id="h47-0-8" class="i">+        },
</a><a href="#h47-0-9" id="h47-0-9" class="i">+        expressions: {
</a><a href="#h47-0-10" id="h47-0-10" class="i">+            &quot;bluray&quot;: Constant(
</a><a href="#h47-0-11" id="h47-0-11" class="i">+                Null,
</a><a href="#h47-0-12" id="h47-0-12" class="i">+            ),
</a><a href="#h47-0-13" id="h47-0-13" class="i">+            &quot;released&quot;: Constant(
</a><a href="#h47-0-14" id="h47-0-14" class="i">+                Integer(
</a><a href="#h47-0-15" id="h47-0-15" class="i">+                    0,
</a><a href="#h47-0-16" id="h47-0-16" class="i">+                ),
</a><a href="#h47-0-17" id="h47-0-17" class="i">+            ),
</a><a href="#h47-0-18" id="h47-0-18" class="i">+            &quot;title&quot;: Constant(
</a><a href="#h47-0-19" id="h47-0-19" class="i">+                String(
</a><a href="#h47-0-20" id="h47-0-20" class="i">+                    &quot;X&quot;,
</a><a href="#h47-0-21" id="h47-0-21" class="i">+                ),
</a><a href="#h47-0-22" id="h47-0-22" class="i">+            ),
</a><a href="#h47-0-23" id="h47-0-23" class="i">+        },
</a><a href="#h47-0-24" id="h47-0-24" class="i">+    },
</a><a href="#h47-0-25" id="h47-0-25" class="i">+}
</a><a href="#h47-0-26" id="h47-0-26" class="i">+
</a> Query: UPDATE movies SET title = &#39;X&#39;, released = 0, bluray = NULL
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h48" href="../file/src/sql/testdata/update_false.html">src/sql/testdata/update_false</a> b/<a href="../file/src/sql/testdata/update_false.html">src/sql/testdata/update_false</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -53,6 +53,29 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h48-0-3" id="h48-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h48-0-4" id="h48-0-4" class="i">+    root: Update {
</a><a href="#h48-0-5" id="h48-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h48-0-6" id="h48-0-6" class="i">+        source: Filter {
</a><a href="#h48-0-7" id="h48-0-7" class="i">+            source: Scan {
</a><a href="#h48-0-8" id="h48-0-8" class="i">+                table: &quot;movies&quot;,
</a><a href="#h48-0-9" id="h48-0-9" class="i">+            },
</a><a href="#h48-0-10" id="h48-0-10" class="i">+            predicate: Constant(
</a><a href="#h48-0-11" id="h48-0-11" class="i">+                Boolean(
</a><a href="#h48-0-12" id="h48-0-12" class="i">+                    false,
</a><a href="#h48-0-13" id="h48-0-13" class="i">+                ),
</a><a href="#h48-0-14" id="h48-0-14" class="i">+            ),
</a><a href="#h48-0-15" id="h48-0-15" class="i">+        },
</a><a href="#h48-0-16" id="h48-0-16" class="i">+        expressions: {
</a><a href="#h48-0-17" id="h48-0-17" class="i">+            &quot;title&quot;: Constant(
</a><a href="#h48-0-18" id="h48-0-18" class="i">+                String(
</a><a href="#h48-0-19" id="h48-0-19" class="i">+                    &quot;X&quot;,
</a><a href="#h48-0-20" id="h48-0-20" class="i">+                ),
</a><a href="#h48-0-21" id="h48-0-21" class="i">+            ),
</a><a href="#h48-0-22" id="h48-0-22" class="i">+        },
</a><a href="#h48-0-23" id="h48-0-23" class="i">+    },
</a><a href="#h48-0-24" id="h48-0-24" class="i">+}
</a><a href="#h48-0-25" id="h48-0-25" class="i">+
</a> Query: UPDATE movies SET title = &#39;X&#39; WHERE FALSE
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h49" href="../file/src/sql/testdata/update_where.html">src/sql/testdata/update_where</a> b/<a href="../file/src/sql/testdata/update_where.html">src/sql/testdata/update_where</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -73,6 +73,35 @@ Plan: Plan {
</a>     },
 }
 
<a href="#h49-0-3" id="h49-0-3" class="i">+Optimized plan: Plan {
</a><a href="#h49-0-4" id="h49-0-4" class="i">+    root: Update {
</a><a href="#h49-0-5" id="h49-0-5" class="i">+        table: &quot;movies&quot;,
</a><a href="#h49-0-6" id="h49-0-6" class="i">+        source: Filter {
</a><a href="#h49-0-7" id="h49-0-7" class="i">+            source: Scan {
</a><a href="#h49-0-8" id="h49-0-8" class="i">+                table: &quot;movies&quot;,
</a><a href="#h49-0-9" id="h49-0-9" class="i">+            },
</a><a href="#h49-0-10" id="h49-0-10" class="i">+            predicate: CompareLT(
</a><a href="#h49-0-11" id="h49-0-11" class="i">+                Field(
</a><a href="#h49-0-12" id="h49-0-12" class="i">+                    &quot;released&quot;,
</a><a href="#h49-0-13" id="h49-0-13" class="i">+                ),
</a><a href="#h49-0-14" id="h49-0-14" class="i">+                Constant(
</a><a href="#h49-0-15" id="h49-0-15" class="i">+                    Integer(
</a><a href="#h49-0-16" id="h49-0-16" class="i">+                        2000,
</a><a href="#h49-0-17" id="h49-0-17" class="i">+                    ),
</a><a href="#h49-0-18" id="h49-0-18" class="i">+                ),
</a><a href="#h49-0-19" id="h49-0-19" class="i">+            ),
</a><a href="#h49-0-20" id="h49-0-20" class="i">+        },
</a><a href="#h49-0-21" id="h49-0-21" class="i">+        expressions: {
</a><a href="#h49-0-22" id="h49-0-22" class="i">+            &quot;bluray&quot;: Constant(
</a><a href="#h49-0-23" id="h49-0-23" class="i">+                Null,
</a><a href="#h49-0-24" id="h49-0-24" class="i">+            ),
</a><a href="#h49-0-25" id="h49-0-25" class="i">+            &quot;rating&quot;: Constant(
</a><a href="#h49-0-26" id="h49-0-26" class="i">+                Null,
</a><a href="#h49-0-27" id="h49-0-27" class="i">+            ),
</a><a href="#h49-0-28" id="h49-0-28" class="i">+        },
</a><a href="#h49-0-29" id="h49-0-29" class="i">+    },
</a><a href="#h49-0-30" id="h49-0-30" class="i">+}
</a><a href="#h49-0-31" id="h49-0-31" class="i">+
</a> Query: UPDATE movies SET rating = NULL, bluray = NULL WHERE released &lt; 2000
 
 Result: &lt;none&gt;
<b>diff --git a/<a id="h50" href="../file/src/sql/tests.rs.html">src/sql/tests.rs</a> b/<a href="../file/src/sql/tests.rs.html">src/sql/tests.rs</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -156,6 +156,16 @@ macro_rules! test_sql {
</a>             };
             write!(f, &quot;{:#?}\n\n&quot;, plan).unwrap();
 
<a href="#h50-0-3" id="h50-0-3" class="i">+            write!(f, &quot;Optimized plan: &quot;).unwrap();
</a><a href="#h50-0-4" id="h50-0-4" class="i">+            let plan = match plan.optimize() {
</a><a href="#h50-0-5" id="h50-0-5" class="i">+                Ok(plan) =&gt; plan,
</a><a href="#h50-0-6" id="h50-0-6" class="i">+                Err(err) =&gt; {
</a><a href="#h50-0-7" id="h50-0-7" class="i">+                    write!(f, &quot;{:?}&quot;, err).unwrap();
</a><a href="#h50-0-8" id="h50-0-8" class="i">+                    return
</a><a href="#h50-0-9" id="h50-0-9" class="i">+                }
</a><a href="#h50-0-10" id="h50-0-10" class="i">+            };
</a><a href="#h50-0-11" id="h50-0-11" class="i">+            write!(f, &quot;{:#?}\n\n&quot;, plan).unwrap();
</a><a href="#h50-0-12" id="h50-0-12" class="i">+
</a>             write!(f, &quot;Query: {}\n\n&quot;, $sql).unwrap();
 
             write!(f, &quot;Result:&quot;).unwrap();
</pre>
</div>
</body>
</html>
