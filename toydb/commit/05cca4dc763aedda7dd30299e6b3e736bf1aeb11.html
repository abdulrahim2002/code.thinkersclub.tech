<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: basic schema skeleton for defaults, foreign keys, and unique constraints. - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/05cca4dc763aedda7dd30299e6b3e736bf1aeb11.html">05cca4dc763aedda7dd30299e6b3e736bf1aeb11</a>
<b>parent</b> <a href="../commit/b3c12235c55aca802b811407136c93e9f36fe32d.html">b3c12235c55aca802b811407136c93e9f36fe32d</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sat,  4 Jan 2020 19:24:45 +0100

sql: basic schema skeleton for defaults, foreign keys, and unique constraints.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">docs/README.md</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/server/toydb.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/engine/kv.rs</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/executor/delete.rs</a></td><td> | </td><td class="num">7</td><td><span class="i">+++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/executor/update.rs</a></td><td> | </td><td class="num">18</td><td><span class="i">++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/parser/ast.rs</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/parser/lexer.rs</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/planner/mod.rs</a></td><td> | </td><td class="num">55</td><td><span class="i">++++++++++++++++++++++++++++++++</span><span class="d">-----------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/tests/results/create_table</a></td><td> | </td><td class="num">81</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/tests/results/create_table_alphanumeric</a></td><td> | </td><td class="num">19</td><td><span class="i">++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/tests/results/create_table_case</a></td><td> | </td><td class="num">19</td><td><span class="i">++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/sql/tests/results/create_table_error_exists</a></td><td> | </td><td class="num">13</td><td><span class="i">+++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/sql/tests/results/create_table_error_pk_missing</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">src/sql/tests/results/create_table_error_pk_multiple</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">src/sql/tests/results/create_table_error_pk_nullable</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">src/sql/tests/results/create_table_japanese</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++++++++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/sql/tests/results/create_table_single_column</a></td><td> | </td><td class="num">19</td><td><span class="i">++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">src/sql/tests/results/create_table_types</a></td><td> | </td><td class="num">189</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">src/sql/tests/results/delete_all</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">src/sql/tests/results/delete_where</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">src/sql/tests/results/delete_where_false</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">src/sql/tests/results/delete_where_null</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">src/sql/tests/results/delete_where_true</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">src/sql/tests/results/insert_default_null</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">src/sql/tests/results/insert_expression</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">src/sql/tests/results/insert_float_infinity</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">src/sql/tests/results/insert_float_max</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">src/sql/tests/results/insert_float_max_neg</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">src/sql/tests/results/insert_float_min</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">src/sql/tests/results/insert_float_min_neg</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">src/sql/tests/results/insert_float_min_round</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">src/sql/tests/results/insert_float_nan</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">src/sql/tests/results/insert_integer_max</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">src/sql/tests/results/insert_integer_min</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">src/sql/tests/results/insert_partial</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">src/sql/tests/results/insert_string_1024</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">src/sql/tests/results/insert_string_1024_unicode</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">src/sql/tests/results/insert_string_empty</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">src/sql/tests/results/insert_values</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">src/sql/tests/results/select_aliases</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">src/sql/tests/results/select_all_from_table</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">src/sql/tests/results/select_case</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">src/sql/tests/results/select_expr_where_false</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">src/sql/tests/results/select_expr_where_true</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">src/sql/tests/results/select_fields</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">src/sql/tests/results/select_limit</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">src/sql/tests/results/select_limit_offset</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">src/sql/tests/results/select_offset</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">src/sql/tests/results/select_order</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">src/sql/tests/results/select_order_projection</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">src/sql/tests/results/select_where</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">src/sql/tests/results/select_where_false</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">src/sql/tests/results/select_where_null</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">src/sql/tests/results/select_where_true</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">src/sql/tests/results/update_all</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">src/sql/tests/results/update_false</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">src/sql/tests/results/update_where</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">src/sql/tests/sql.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">src/sql/types/schema.rs</a></td><td> | </td><td class="num">141</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------</span></td></tr>
</table></pre><pre>60 files changed, 646 insertions(+), 246 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/docs/README.md.html">docs/README.md</a> b/<a href="../file/docs/README.md.html">docs/README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -19,7 +19,7 @@ Numeric types are not interchangable when stored; a float value cannot be stored
</a> 
 Keywords are reserved words that have special meaning in SQL statements, such as `SELECT`. These cannot be used as identifiers, e.g. table names. Keywords are case-insensitive. The complete list of keywords is:
 
<a href="#h0-0-3" id="h0-0-3" class="d">-`AS`, `ASC`, `AND`, `BEGIN`, `BOOL`, `BOOLEAN`, `BY`, `CHAR`, `COMMIT`, `CREATE`, `DELETE`, `DESC`, `DOUBLE`, `DROP`, `FALSE`, `FLOAT`, `FROM`, `INFINITY`, `INSERT`, `INT`, `INTEGER`, `INTO`, `IS`, `KEY`, `LIKE`, `LIMIT`, `NAN`, `NOT`, `NULL`, `OF`, `OFFSET`, `ONLY`, `OR`, `ORDER`, `PRIMARY`, `READ`, `ROLLBACK`, `SELECT`, `SET`, `STRING`, `SYSTEM`, `TABLE`, `TEXT`, `TIME`, `TRANSACTION`, `TRUE`, `UPDATE`, `VALUES`, `VARCHAR`, `WHERE`, `WRITE`
</a><a href="#h0-0-4" id="h0-0-4" class="i">+`AS`, `ASC`, `AND`, `BEGIN`, `BOOL`, `BOOLEAN`, `BY`, `CHAR`, `COMMIT`, `CREATE`, `DELETE`, `DESC`, `DOUBLE`, `DROP`, `FALSE`, `FLOAT`, `FOREIGN`, `FROM`, `INFINITY`, `INSERT`, `INT`, `INTEGER`, `INTO`, `IS`, `KEY`, `LIKE`, `LIMIT`, `NAN`, `NOT`, `NULL`, `OF`, `OFFSET`, `ONLY`, `OR`, `ORDER`, `PRIMARY`, `READ`, `REFERENCES`, `ROLLBACK`, `SELECT`, `SET`, `STRING`, `SYSTEM`, `TABLE`, `TEXT`, `TIME`, `TRANSACTION`, `TRUE`, `UPDATE`, `VALUES`, `VARCHAR`, `WHERE`, `WRITE`
</a> 
 ### Identifiers
 
<b>diff --git a/<a id="h1" href="../file/src/server/toydb.rs.html">src/server/toydb.rs</a> b/<a href="../file/src/server/toydb.rs.html">src/server/toydb.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -22,7 +22,7 @@ impl service::ToyDB for ToyDB {
</a>         let mut resp = service::GetTableResponse::new();
         let txn = self.engine.begin().unwrap();
         match txn.read_table(&amp;req.name) {
<a href="#h1-0-3" id="h1-0-3" class="d">-            Ok(Some(schema)) =&gt; resp.sql = schema.to_query(),
</a><a href="#h1-0-4" id="h1-0-4" class="i">+            Ok(Some(schema)) =&gt; resp.sql = schema.as_sql(),
</a>             Ok(None) =&gt; {
                 resp.error = Self::error_to_protobuf(Error::Value(format!(
                     &quot;Table {} does not exist&quot;,
<b>diff --git a/<a id="h2" href="../file/src/sql/engine/kv.rs.html">src/sql/engine/kv.rs</a> b/<a href="../file/src/sql/engine/kv.rs.html">src/sql/engine/kv.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -59,14 +59,14 @@ impl&lt;S: kv::storage::Storage&gt; super::Transaction for Transaction&lt;S&gt; {
</a>             .read_table(&amp;table)?
             .ok_or_else(|| Error::Value(format!(&quot;Table {} does not exist&quot;, table)))?;
         table.validate_row(&amp;row)?;
<a href="#h2-0-3" id="h2-0-3" class="d">-        let pk = row.get(table.primary_key).unwrap();
</a><a href="#h2-0-4" id="h2-0-4" class="d">-        if self.read(&amp;table.name, &amp;pk)?.is_some() {
</a><a href="#h2-0-5" id="h2-0-5" class="i">+        let id = table.row_key(&amp;row)?;
</a><a href="#h2-0-6" id="h2-0-6" class="i">+        if self.read(&amp;table.name, &amp;id)?.is_some() {
</a>             return Err(Error::Value(format!(
                 &quot;Primary key {} already exists for table {}&quot;,
<a href="#h2-0-9" id="h2-0-9" class="d">-                pk, table.name
</a><a href="#h2-0-10" id="h2-0-10" class="i">+                id, table.name
</a>             )));
         }
<a href="#h2-0-13" id="h2-0-13" class="d">-        self.txn.set(&amp;Key::Row(&amp;table.name, &amp;pk).encode(), serialize(&amp;row)?)?;
</a><a href="#h2-0-14" id="h2-0-14" class="i">+        self.txn.set(&amp;Key::Row(&amp;table.name, &amp;id).encode(), serialize(&amp;row)?)?;
</a>         Ok(())
     }
 
<b>diff --git a/<a id="h3" href="../file/src/sql/executor/delete.rs.html">src/sql/executor/delete.rs</a> b/<a href="../file/src/sql/executor/delete.rs.html">src/sql/executor/delete.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -12,13 +12,12 @@ impl Delete {
</a>         mut source: Box&lt;dyn Executor&gt;,
         table: String,
     ) -&gt; Result&lt;Box&lt;dyn Executor&gt;, Error&gt; {
<a href="#h3-0-3" id="h3-0-3" class="d">-        let pk = ctx
</a><a href="#h3-0-4" id="h3-0-4" class="i">+        let table = ctx
</a>             .txn
             .read_table(&amp;table)?
<a href="#h3-0-7" id="h3-0-7" class="d">-            .ok_or_else(|| Error::Value(format!(&quot;Table {} does not exist&quot;, table)))?
</a><a href="#h3-0-8" id="h3-0-8" class="d">-            .primary_key;
</a><a href="#h3-0-9" id="h3-0-9" class="i">+            .ok_or_else(|| Error::Value(format!(&quot;Table {} not found&quot;, table)))?;
</a>         while let Some(row) = source.fetch()? {
<a href="#h3-0-11" id="h3-0-11" class="d">-            ctx.txn.delete(&amp;table, row.get(pk).unwrap())?
</a><a href="#h3-0-12" id="h3-0-12" class="i">+            ctx.txn.delete(&amp;table.name, &amp;table.row_key(&amp;row)?)?
</a>         }
         Ok(Box::new(Self))
     }
<b>diff --git a/<a id="h4" href="../file/src/sql/executor/update.rs.html">src/sql/executor/update.rs</a> b/<a href="../file/src/sql/executor/update.rs.html">src/sql/executor/update.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -15,19 +15,21 @@ impl Update {
</a>         mut source: Box&lt;dyn Executor&gt;,
         expressions: BTreeMap&lt;String, Expression&gt;,
     ) -&gt; Result&lt;Box&lt;dyn Executor&gt;, Error&gt; {
<a href="#h4-0-3" id="h4-0-3" class="d">-        let schema = ctx
</a><a href="#h4-0-4" id="h4-0-4" class="i">+        let table = ctx
</a>             .txn
             .read_table(&amp;table)?
             .ok_or_else(|| Error::Value(format!(&quot;Table {} does not exist&quot;, table)))?;
<a href="#h4-0-8" id="h4-0-8" class="d">-        let pk_index = schema.primary_key;
</a><a href="#h4-0-9" id="h4-0-9" class="d">-        let columns: Vec&lt;String&gt; = schema.columns.iter().map(|c| c.name.clone()).collect();
</a><a href="#h4-0-10" id="h4-0-10" class="d">-        while let Some(mut row) = source.fetch()? {
</a><a href="#h4-0-11" id="h4-0-11" class="d">-            let pk = row.get(pk_index).unwrap().clone();
</a><a href="#h4-0-12" id="h4-0-12" class="d">-            let env = Environment::new(columns.iter().cloned().zip(row.iter().cloned()).collect());
</a><a href="#h4-0-13" id="h4-0-13" class="i">+        while let Some(row) = source.fetch()? {
</a><a href="#h4-0-14" id="h4-0-14" class="i">+            let id = table.row_key(&amp;row)?;
</a><a href="#h4-0-15" id="h4-0-15" class="i">+            let mut keyed_row = table.row_to_hashmap(row);
</a><a href="#h4-0-16" id="h4-0-16" class="i">+            let env = Environment::new(keyed_row.clone());
</a>             for (c, expr) in &amp;expressions {
<a href="#h4-0-18" id="h4-0-18" class="d">-                row[schema.column_index(&amp;c).unwrap()] = expr.evaluate(&amp;env)?;
</a><a href="#h4-0-19" id="h4-0-19" class="i">+                *keyed_row
</a><a href="#h4-0-20" id="h4-0-20" class="i">+                    .get_mut(c)
</a><a href="#h4-0-21" id="h4-0-21" class="i">+                    .ok_or_else(|| Error::Value(format!(&quot;Unknown column {}&quot;, c)))? =
</a><a href="#h4-0-22" id="h4-0-22" class="i">+                    expr.evaluate(&amp;env)?;
</a>             }
<a href="#h4-0-24" id="h4-0-24" class="d">-            ctx.txn.update(&amp;table, &amp;pk, row)?
</a><a href="#h4-0-25" id="h4-0-25" class="i">+            ctx.txn.update(&amp;table.name, &amp;id, table.row_from_hashmap(keyed_row))?
</a>         }
         Ok(Box::new(Self))
     }
<b>diff --git a/<a id="h5" href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a> b/<a href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -41,6 +41,9 @@ pub struct ColumnSpec {
</a>     pub datatype: types::DataType,
     pub primary_key: bool,
     pub nullable: Option&lt;bool&gt;,
<a href="#h5-0-3" id="h5-0-3" class="i">+    pub default: Option&lt;Expression&gt;,
</a><a href="#h5-0-4" id="h5-0-4" class="i">+    pub unique: bool,
</a><a href="#h5-0-5" id="h5-0-5" class="i">+    pub references: Option&lt;String&gt;,
</a> }
 
 /// A SELECT clause
<b>diff --git a/<a id="h6" href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a> b/<a href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -79,12 +79,14 @@ pub enum Keyword {
</a>     Char,
     Commit,
     Create,
<a href="#h6-0-3" id="h6-0-3" class="i">+    Default,
</a>     Delete,
     Desc,
     Double,
     Drop,
     False,
     Float,
<a href="#h6-0-10" id="h6-0-10" class="i">+    Foreign,
</a>     From,
     Infinity,
     Insert,
<a href="#h6-1" id="h6-1" class="h">@@ -105,6 +107,7 @@ pub enum Keyword {
</a>     Order,
     Primary,
     Read,
<a href="#h6-1-3" id="h6-1-3" class="i">+    References,
</a>     Rollback,
     Select,
     Set,
<a href="#h6-2" id="h6-2" class="h">@@ -115,6 +118,7 @@ pub enum Keyword {
</a>     Time,
     Transaction,
     True,
<a href="#h6-2-3" id="h6-2-3" class="i">+    Unique,
</a>     Update,
     Values,
     Varchar,
<a href="#h6-3" id="h6-3" class="h">@@ -135,12 +139,14 @@ impl Keyword {
</a>             &quot;CHAR&quot; =&gt; Self::Char,
             &quot;COMMIT&quot; =&gt; Self::Commit,
             &quot;CREATE&quot; =&gt; Self::Create,
<a href="#h6-3-3" id="h6-3-3" class="i">+            &quot;DEFAULT&quot; =&gt; Self::Default,
</a>             &quot;DELETE&quot; =&gt; Self::Delete,
             &quot;DESC&quot; =&gt; Self::Desc,
             &quot;DOUBLE&quot; =&gt; Self::Double,
             &quot;DROP&quot; =&gt; Self::Drop,
             &quot;FALSE&quot; =&gt; Self::False,
             &quot;FLOAT&quot; =&gt; Self::Float,
<a href="#h6-3-10" id="h6-3-10" class="i">+            &quot;FOREIGN&quot; =&gt; Self::Foreign,
</a>             &quot;FROM&quot; =&gt; Self::From,
             &quot;INFINITY&quot; =&gt; Self::Infinity,
             &quot;INSERT&quot; =&gt; Self::Insert,
<a href="#h6-4" id="h6-4" class="h">@@ -161,6 +167,7 @@ impl Keyword {
</a>             &quot;ORDER&quot; =&gt; Self::Order,
             &quot;PRIMARY&quot; =&gt; Self::Primary,
             &quot;READ&quot; =&gt; Self::Read,
<a href="#h6-4-3" id="h6-4-3" class="i">+            &quot;REFERENCES&quot; =&gt; Self::References,
</a>             &quot;ROLLBACK&quot; =&gt; Self::Rollback,
             &quot;SELECT&quot; =&gt; Self::Select,
             &quot;SET&quot; =&gt; Self::Set,
<a href="#h6-5" id="h6-5" class="h">@@ -171,6 +178,7 @@ impl Keyword {
</a>             &quot;TIME&quot; =&gt; Self::Time,
             &quot;TRANSACTION&quot; =&gt; Self::Transaction,
             &quot;TRUE&quot; =&gt; Self::True,
<a href="#h6-5-3" id="h6-5-3" class="i">+            &quot;UNIQUE&quot; =&gt; Self::Unique,
</a>             &quot;UPDATE&quot; =&gt; Self::Update,
             &quot;VALUES&quot; =&gt; Self::Values,
             &quot;VARCHAR&quot; =&gt; Self::Varchar,
<a href="#h6-6" id="h6-6" class="h">@@ -192,12 +200,14 @@ impl Keyword {
</a>             Self::Char =&gt; &quot;CHAR&quot;,
             Self::Commit =&gt; &quot;COMMIT&quot;,
             Self::Create =&gt; &quot;CREATE&quot;,
<a href="#h6-6-3" id="h6-6-3" class="i">+            Self::Default =&gt; &quot;DEFAULT&quot;,
</a>             Self::Delete =&gt; &quot;DELETE&quot;,
             Self::Desc =&gt; &quot;DESC&quot;,
             Self::Double =&gt; &quot;DOUBLE&quot;,
             Self::Drop =&gt; &quot;DROP&quot;,
             Self::False =&gt; &quot;FALSE&quot;,
             Self::Float =&gt; &quot;FLOAT&quot;,
<a href="#h6-6-10" id="h6-6-10" class="i">+            Self::Foreign =&gt; &quot;FOREIGN&quot;,
</a>             Self::From =&gt; &quot;FROM&quot;,
             Self::Infinity =&gt; &quot;INFINITY&quot;,
             Self::Insert =&gt; &quot;INSERT&quot;,
<a href="#h6-7" id="h6-7" class="h">@@ -218,6 +228,7 @@ impl Keyword {
</a>             Self::Order =&gt; &quot;ORDER&quot;,
             Self::Primary =&gt; &quot;PRIMARY&quot;,
             Self::Read =&gt; &quot;READ&quot;,
<a href="#h6-7-3" id="h6-7-3" class="i">+            Self::References =&gt; &quot;REFERENCES&quot;,
</a>             Self::Rollback =&gt; &quot;ROLLBACK&quot;,
             Self::Select =&gt; &quot;SELECT&quot;,
             Self::Set =&gt; &quot;SET&quot;,
<a href="#h6-8" id="h6-8" class="h">@@ -228,6 +239,7 @@ impl Keyword {
</a>             Self::Time =&gt; &quot;TIME&quot;,
             Self::Transaction =&gt; &quot;TRANSACTION&quot;,
             Self::True =&gt; &quot;TRUE&quot;,
<a href="#h6-8-3" id="h6-8-3" class="i">+            Self::Unique =&gt; &quot;UNIQUE&quot;,
</a>             Self::Update =&gt; &quot;UPDATE&quot;,
             Self::Values =&gt; &quot;VALUES&quot;,
             Self::Varchar =&gt; &quot;VARCHAR&quot;,
<b>diff --git a/<a id="h7" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -172,6 +172,9 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>             },
             primary_key: false,
             nullable: None,
<a href="#h7-0-3" id="h7-0-3" class="i">+            default: None,
</a><a href="#h7-0-4" id="h7-0-4" class="i">+            unique: false,
</a><a href="#h7-0-5" id="h7-0-5" class="i">+            references: None,
</a>         };
         while let Some(Token::Keyword(keyword)) = self.next_if_keyword() {
             match keyword {
<a href="#h7-1" id="h7-1" class="h">@@ -198,6 +201,9 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                     }
                     column.nullable = Some(false)
                 }
<a href="#h7-1-3" id="h7-1-3" class="i">+                Keyword::Default =&gt; column.default = Some(self.parse_expression(0)?),
</a><a href="#h7-1-4" id="h7-1-4" class="i">+                Keyword::Unique =&gt; column.unique = true,
</a><a href="#h7-1-5" id="h7-1-5" class="i">+                Keyword::References =&gt; column.references = Some(self.next_ident()?),
</a>                 keyword =&gt; return Err(Error::Parse(format!(&quot;Unexpected keyword {}&quot;, keyword))),
             }
         }
<b>diff --git a/<a id="h8" href="../file/src/sql/planner/mod.rs.html">src/sql/planner/mod.rs</a> b/<a href="../file/src/sql/planner/mod.rs.html">src/sql/planner/mod.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -130,36 +130,45 @@ impl Planner {
</a>     fn build_schema_table(
         &amp;self,
         name: String,
<a href="#h8-0-3" id="h8-0-3" class="d">-        cols: Vec&lt;ast::ColumnSpec&gt;,
</a><a href="#h8-0-4" id="h8-0-4" class="i">+        columns: Vec&lt;ast::ColumnSpec&gt;,
</a>     ) -&gt; Result&lt;schema::Table, Error&gt; {
<a href="#h8-0-6" id="h8-0-6" class="d">-        match cols.iter().filter(|c| c.primary_key).count() {
</a><a href="#h8-0-7" id="h8-0-7" class="d">-            0 =&gt; return Err(Error::Value(format!(&quot;No primary key defined for table {}&quot;, name))),
</a><a href="#h8-0-8" id="h8-0-8" class="d">-            n if n &gt; 1 =&gt; {
</a><a href="#h8-0-9" id="h8-0-9" class="d">-                return Err(Error::Value(format!(
</a><a href="#h8-0-10" id="h8-0-10" class="d">-                    &quot;{} primary keys defined for table {}, must set exactly 1&quot;,
</a><a href="#h8-0-11" id="h8-0-11" class="d">-                    n, name
</a><a href="#h8-0-12" id="h8-0-12" class="d">-                )))
</a><a href="#h8-0-13" id="h8-0-13" class="d">-            }
</a><a href="#h8-0-14" id="h8-0-14" class="d">-            _ =&gt; {}
</a><a href="#h8-0-15" id="h8-0-15" class="d">-        };
</a><a href="#h8-0-16" id="h8-0-16" class="d">-        let table = schema::Table {
</a><a href="#h8-0-17" id="h8-0-17" class="i">+        schema::Table::new(
</a>             name,
<a href="#h8-0-19" id="h8-0-19" class="d">-            primary_key: cols.iter().position(|c| c.primary_key).unwrap_or(0),
</a><a href="#h8-0-20" id="h8-0-20" class="d">-            columns: cols
</a><a href="#h8-0-21" id="h8-0-21" class="i">+            columns
</a>                 .into_iter()
<a href="#h8-0-23" id="h8-0-23" class="d">-                .map(|spec| schema::Column {
</a><a href="#h8-0-24" id="h8-0-24" class="d">-                    name: spec.name,
</a><a href="#h8-0-25" id="h8-0-25" class="d">-                    datatype: spec.datatype,
</a><a href="#h8-0-26" id="h8-0-26" class="d">-                    nullable: spec.nullable.unwrap_or(!spec.primary_key),
</a><a href="#h8-0-27" id="h8-0-27" class="i">+                .map(|c| {
</a><a href="#h8-0-28" id="h8-0-28" class="i">+                    let nullable = c.nullable.unwrap_or(!c.primary_key);
</a><a href="#h8-0-29" id="h8-0-29" class="i">+                    let default = if let Some(expr) = c.default {
</a><a href="#h8-0-30" id="h8-0-30" class="i">+                        let expr = self.build_expression(expr)?;
</a><a href="#h8-0-31" id="h8-0-31" class="i">+                        if !expr.is_constant() {
</a><a href="#h8-0-32" id="h8-0-32" class="i">+                            return Err(Error::Value(format!(
</a><a href="#h8-0-33" id="h8-0-33" class="i">+                                &quot;Default expression for column {} must be constant&quot;,
</a><a href="#h8-0-34" id="h8-0-34" class="i">+                                c.name
</a><a href="#h8-0-35" id="h8-0-35" class="i">+                            )));
</a><a href="#h8-0-36" id="h8-0-36" class="i">+                        }
</a><a href="#h8-0-37" id="h8-0-37" class="i">+                        Some(expr.evaluate(&amp;Environment::empty())?)
</a><a href="#h8-0-38" id="h8-0-38" class="i">+                    } else if nullable {
</a><a href="#h8-0-39" id="h8-0-39" class="i">+                        Some(Value::Null)
</a><a href="#h8-0-40" id="h8-0-40" class="i">+                    } else {
</a><a href="#h8-0-41" id="h8-0-41" class="i">+                        None
</a><a href="#h8-0-42" id="h8-0-42" class="i">+                    };
</a><a href="#h8-0-43" id="h8-0-43" class="i">+
</a><a href="#h8-0-44" id="h8-0-44" class="i">+                    Ok(schema::Column {
</a><a href="#h8-0-45" id="h8-0-45" class="i">+                        name: c.name,
</a><a href="#h8-0-46" id="h8-0-46" class="i">+                        datatype: c.datatype,
</a><a href="#h8-0-47" id="h8-0-47" class="i">+                        primary_key: c.primary_key,
</a><a href="#h8-0-48" id="h8-0-48" class="i">+                        nullable,
</a><a href="#h8-0-49" id="h8-0-49" class="i">+                        default,
</a><a href="#h8-0-50" id="h8-0-50" class="i">+                        unique: c.unique,
</a><a href="#h8-0-51" id="h8-0-51" class="i">+                        references: c.references,
</a><a href="#h8-0-52" id="h8-0-52" class="i">+                    })
</a>                 })
<a href="#h8-0-54" id="h8-0-54" class="d">-                .collect(),
</a><a href="#h8-0-55" id="h8-0-55" class="d">-        };
</a><a href="#h8-0-56" id="h8-0-56" class="d">-        table.validate()?;
</a><a href="#h8-0-57" id="h8-0-57" class="d">-        Ok(table)
</a><a href="#h8-0-58" id="h8-0-58" class="i">+                .collect::&lt;Result&lt;_, Error&gt;&gt;()?,
</a><a href="#h8-0-59" id="h8-0-59" class="i">+        )
</a>     }
 }
 
<a href="#h8-0-63" id="h8-0-63" class="d">-/// Helpers to convert AST expressions into plan expressions
</a><a href="#h8-0-64" id="h8-0-64" class="i">+/// Helpers to convert AST nodes into plan nodes
</a> impl From&lt;ast::Expression&gt; for Expression {
     fn from(expr: ast::Expression) -&gt; Self {
         match expr {
<b>diff --git a/<a id="h9" href="../file/src/sql/tests/results/create_table.html">src/sql/tests/results/create_table</a> b/<a href="../file/src/sql/tests/results/create_table.html">src/sql/tests/results/create_table</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -41,6 +41,9 @@ AST: CreateTable {
</a>             datatype: Integer,
             primary_key: true,
             nullable: None,
<a href="#h9-0-3" id="h9-0-3" class="i">+            default: None,
</a><a href="#h9-0-4" id="h9-0-4" class="i">+            unique: false,
</a><a href="#h9-0-5" id="h9-0-5" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;name&quot;,
<a href="#h9-1" id="h9-1" class="h">@@ -49,18 +52,27 @@ AST: CreateTable {
</a>             nullable: Some(
                 false,
             ),
<a href="#h9-1-3" id="h9-1-3" class="i">+            default: None,
</a><a href="#h9-1-4" id="h9-1-4" class="i">+            unique: false,
</a><a href="#h9-1-5" id="h9-1-5" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;number&quot;,
             datatype: Integer,
             primary_key: false,
             nullable: None,
<a href="#h9-1-12" id="h9-1-12" class="i">+            default: None,
</a><a href="#h9-1-13" id="h9-1-13" class="i">+            unique: false,
</a><a href="#h9-1-14" id="h9-1-14" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;decimal&quot;,
             datatype: Float,
             primary_key: false,
             nullable: None,
<a href="#h9-1-21" id="h9-1-21" class="i">+            default: None,
</a><a href="#h9-1-22" id="h9-1-22" class="i">+            unique: false,
</a><a href="#h9-1-23" id="h9-1-23" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;logical&quot;,
<a href="#h9-2" id="h9-2" class="h">@@ -69,6 +81,9 @@ AST: CreateTable {
</a>             nullable: Some(
                 true,
             ),
<a href="#h9-2-3" id="h9-2-3" class="i">+            default: None,
</a><a href="#h9-2-4" id="h9-2-4" class="i">+            unique: false,
</a><a href="#h9-2-5" id="h9-2-5" class="i">+            references: None,
</a>         },
     ],
 }
<a href="#h9-3" id="h9-3" class="h">@@ -81,30 +96,55 @@ Plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h9-3-3" id="h9-3-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h9-3-5" id="h9-3-5" class="i">+                    default: None,
</a><a href="#h9-3-6" id="h9-3-6" class="i">+                    unique: false,
</a><a href="#h9-3-7" id="h9-3-7" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;name&quot;,
                     datatype: String,
<a href="#h9-3-12" id="h9-3-12" class="i">+                    primary_key: false,
</a>                     nullable: false,
<a href="#h9-3-14" id="h9-3-14" class="i">+                    default: None,
</a><a href="#h9-3-15" id="h9-3-15" class="i">+                    unique: false,
</a><a href="#h9-3-16" id="h9-3-16" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;number&quot;,
                     datatype: Integer,
<a href="#h9-3-21" id="h9-3-21" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h9-3-23" id="h9-3-23" class="i">+                    default: Some(
</a><a href="#h9-3-24" id="h9-3-24" class="i">+                        Null,
</a><a href="#h9-3-25" id="h9-3-25" class="i">+                    ),
</a><a href="#h9-3-26" id="h9-3-26" class="i">+                    unique: false,
</a><a href="#h9-3-27" id="h9-3-27" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;decimal&quot;,
                     datatype: Float,
<a href="#h9-3-32" id="h9-3-32" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h9-3-34" id="h9-3-34" class="i">+                    default: Some(
</a><a href="#h9-3-35" id="h9-3-35" class="i">+                        Null,
</a><a href="#h9-3-36" id="h9-3-36" class="i">+                    ),
</a><a href="#h9-3-37" id="h9-3-37" class="i">+                    unique: false,
</a><a href="#h9-3-38" id="h9-3-38" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;logical&quot;,
                     datatype: Boolean,
<a href="#h9-3-43" id="h9-3-43" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h9-3-45" id="h9-3-45" class="i">+                    default: Some(
</a><a href="#h9-3-46" id="h9-3-46" class="i">+                        Null,
</a><a href="#h9-3-47" id="h9-3-47" class="i">+                    ),
</a><a href="#h9-3-48" id="h9-3-48" class="i">+                    unique: false,
</a><a href="#h9-3-49" id="h9-3-49" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h9-3-52" id="h9-3-52" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h9-4" id="h9-4" class="h">@@ -117,30 +157,55 @@ Optimized plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h9-4-3" id="h9-4-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h9-4-5" id="h9-4-5" class="i">+                    default: None,
</a><a href="#h9-4-6" id="h9-4-6" class="i">+                    unique: false,
</a><a href="#h9-4-7" id="h9-4-7" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;name&quot;,
                     datatype: String,
<a href="#h9-4-12" id="h9-4-12" class="i">+                    primary_key: false,
</a>                     nullable: false,
<a href="#h9-4-14" id="h9-4-14" class="i">+                    default: None,
</a><a href="#h9-4-15" id="h9-4-15" class="i">+                    unique: false,
</a><a href="#h9-4-16" id="h9-4-16" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;number&quot;,
                     datatype: Integer,
<a href="#h9-4-21" id="h9-4-21" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h9-4-23" id="h9-4-23" class="i">+                    default: Some(
</a><a href="#h9-4-24" id="h9-4-24" class="i">+                        Null,
</a><a href="#h9-4-25" id="h9-4-25" class="i">+                    ),
</a><a href="#h9-4-26" id="h9-4-26" class="i">+                    unique: false,
</a><a href="#h9-4-27" id="h9-4-27" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;decimal&quot;,
                     datatype: Float,
<a href="#h9-4-32" id="h9-4-32" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h9-4-34" id="h9-4-34" class="i">+                    default: Some(
</a><a href="#h9-4-35" id="h9-4-35" class="i">+                        Null,
</a><a href="#h9-4-36" id="h9-4-36" class="i">+                    ),
</a><a href="#h9-4-37" id="h9-4-37" class="i">+                    unique: false,
</a><a href="#h9-4-38" id="h9-4-38" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;logical&quot;,
                     datatype: Boolean,
<a href="#h9-4-43" id="h9-4-43" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h9-4-45" id="h9-4-45" class="i">+                    default: Some(
</a><a href="#h9-4-46" id="h9-4-46" class="i">+                        Null,
</a><a href="#h9-4-47" id="h9-4-47" class="i">+                    ),
</a><a href="#h9-4-48" id="h9-4-48" class="i">+                    unique: false,
</a><a href="#h9-4-49" id="h9-4-49" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h9-4-52" id="h9-4-52" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h9-5" id="h9-5" class="h">@@ -167,10 +232,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h9-5-3" id="h9-5-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h9-5-4" id="h9-5-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h9-5-6" id="h9-5-6" class="d">-  rating FLOAT,
</a><a href="#h9-5-7" id="h9-5-7" class="d">-  bluray BOOLEAN
</a><a href="#h9-5-8" id="h9-5-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h9-5-9" id="h9-5-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h9-6" id="h9-6" class="h">@@ -181,7 +246,7 @@ CREATE TABLE movies (
</a> CREATE TABLE name (
   id INTEGER PRIMARY KEY NOT NULL,
   name STRING NOT NULL,
<a href="#h9-6-3" id="h9-6-3" class="d">-  number INTEGER,
</a><a href="#h9-6-4" id="h9-6-4" class="d">-  decimal FLOAT,
</a><a href="#h9-6-5" id="h9-6-5" class="d">-  logical BOOLEAN
</a><a href="#h9-6-6" id="h9-6-6" class="i">+  number INTEGER DEFAULT NULL,
</a><a href="#h9-6-7" id="h9-6-7" class="i">+  decimal FLOAT DEFAULT NULL,
</a><a href="#h9-6-8" id="h9-6-8" class="i">+  logical BOOLEAN DEFAULT NULL
</a> )
<b>diff --git a/<a id="h10" href="../file/src/sql/tests/results/create_table_alphanumeric.html">src/sql/tests/results/create_table_alphanumeric</a> b/<a href="../file/src/sql/tests/results/create_table_alphanumeric.html">src/sql/tests/results/create_table_alphanumeric</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -19,6 +19,9 @@ AST: CreateTable {
</a>             datatype: Integer,
             primary_key: true,
             nullable: None,
<a href="#h10-0-3" id="h10-0-3" class="i">+            default: None,
</a><a href="#h10-0-4" id="h10-0-4" class="i">+            unique: false,
</a><a href="#h10-0-5" id="h10-0-5" class="i">+            references: None,
</a>         },
     ],
 }
<a href="#h10-1" id="h10-1" class="h">@@ -31,10 +34,13 @@ Plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h10-1-3" id="h10-1-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h10-1-5" id="h10-1-5" class="i">+                    default: None,
</a><a href="#h10-1-6" id="h10-1-6" class="i">+                    unique: false,
</a><a href="#h10-1-7" id="h10-1-7" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h10-1-10" id="h10-1-10" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h10-2" id="h10-2" class="h">@@ -47,10 +53,13 @@ Optimized plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h10-2-3" id="h10-2-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h10-2-5" id="h10-2-5" class="i">+                    default: None,
</a><a href="#h10-2-6" id="h10-2-6" class="i">+                    unique: false,
</a><a href="#h10-2-7" id="h10-2-7" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h10-2-10" id="h10-2-10" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h10-3" id="h10-3" class="h">@@ -74,10 +83,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h10-3-3" id="h10-3-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h10-3-4" id="h10-3-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h10-3-6" id="h10-3-6" class="d">-  rating FLOAT,
</a><a href="#h10-3-7" id="h10-3-7" class="d">-  bluray BOOLEAN
</a><a href="#h10-3-8" id="h10-3-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h10-3-9" id="h10-3-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h11" href="../file/src/sql/tests/results/create_table_case.html">src/sql/tests/results/create_table_case</a> b/<a href="../file/src/sql/tests/results/create_table_case.html">src/sql/tests/results/create_table_case</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -19,6 +19,9 @@ AST: CreateTable {
</a>             datatype: String,
             primary_key: true,
             nullable: None,
<a href="#h11-0-3" id="h11-0-3" class="i">+            default: None,
</a><a href="#h11-0-4" id="h11-0-4" class="i">+            unique: false,
</a><a href="#h11-0-5" id="h11-0-5" class="i">+            references: None,
</a>         },
     ],
 }
<a href="#h11-1" id="h11-1" class="h">@@ -31,10 +34,13 @@ Plan: Plan {
</a>                 Column {
                     name: &quot;äåæ&quot;,
                     datatype: String,
<a href="#h11-1-3" id="h11-1-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h11-1-5" id="h11-1-5" class="i">+                    default: None,
</a><a href="#h11-1-6" id="h11-1-6" class="i">+                    unique: false,
</a><a href="#h11-1-7" id="h11-1-7" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h11-1-10" id="h11-1-10" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h11-2" id="h11-2" class="h">@@ -47,10 +53,13 @@ Optimized plan: Plan {
</a>                 Column {
                     name: &quot;äåæ&quot;,
                     datatype: String,
<a href="#h11-2-3" id="h11-2-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h11-2-5" id="h11-2-5" class="i">+                    default: None,
</a><a href="#h11-2-6" id="h11-2-6" class="i">+                    unique: false,
</a><a href="#h11-2-7" id="h11-2-7" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h11-2-10" id="h11-2-10" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h11-3" id="h11-3" class="h">@@ -74,10 +83,10 @@ CREATE TABLE mixed_case (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h11-3-3" id="h11-3-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h11-3-4" id="h11-3-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h11-3-6" id="h11-3-6" class="d">-  rating FLOAT,
</a><a href="#h11-3-7" id="h11-3-7" class="d">-  bluray BOOLEAN
</a><a href="#h11-3-8" id="h11-3-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h11-3-9" id="h11-3-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h12" href="../file/src/sql/tests/results/create_table_error_exists.html">src/sql/tests/results/create_table_error_exists</a> b/<a href="../file/src/sql/tests/results/create_table_error_exists.html">src/sql/tests/results/create_table_error_exists</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -19,6 +19,9 @@ AST: CreateTable {
</a>             datatype: Integer,
             primary_key: true,
             nullable: None,
<a href="#h12-0-3" id="h12-0-3" class="i">+            default: None,
</a><a href="#h12-0-4" id="h12-0-4" class="i">+            unique: false,
</a><a href="#h12-0-5" id="h12-0-5" class="i">+            references: None,
</a>         },
     ],
 }
<a href="#h12-1" id="h12-1" class="h">@@ -31,10 +34,13 @@ Plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h12-1-3" id="h12-1-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h12-1-5" id="h12-1-5" class="i">+                    default: None,
</a><a href="#h12-1-6" id="h12-1-6" class="i">+                    unique: false,
</a><a href="#h12-1-7" id="h12-1-7" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h12-1-10" id="h12-1-10" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h12-2" id="h12-2" class="h">@@ -47,10 +53,13 @@ Optimized plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h12-2-3" id="h12-2-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h12-2-5" id="h12-2-5" class="i">+                    default: None,
</a><a href="#h12-2-6" id="h12-2-6" class="i">+                    unique: false,
</a><a href="#h12-2-7" id="h12-2-7" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h12-2-10" id="h12-2-10" class="d">-            primary_key: 0,
</a>         },
     },
 }
<b>diff --git a/<a id="h13" href="../file/src/sql/tests/results/create_table_error_pk_missing.html">src/sql/tests/results/create_table_error_pk_missing</a> b/<a href="../file/src/sql/tests/results/create_table_error_pk_missing.html">src/sql/tests/results/create_table_error_pk_missing</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -17,8 +17,11 @@ AST: CreateTable {
</a>             datatype: Integer,
             primary_key: false,
             nullable: None,
<a href="#h13-0-3" id="h13-0-3" class="i">+            default: None,
</a><a href="#h13-0-4" id="h13-0-4" class="i">+            unique: false,
</a><a href="#h13-0-5" id="h13-0-5" class="i">+            references: None,
</a>         },
     ],
 }
 
<a href="#h13-0-10" id="h13-0-10" class="d">-Plan: Value(&quot;No primary key defined for table name&quot;)
</a><a href="#h13-0-11" id="h13-0-11" class="d">-\ No newline at end of file
</a><a href="#h13-0-12" id="h13-0-12" class="i">+Plan: Value(&quot;No primary key in table name&quot;)
</a><a href="#h13-0-13" id="h13-0-13" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h14" href="../file/src/sql/tests/results/create_table_error_pk_multiple.html">src/sql/tests/results/create_table_error_pk_multiple</a> b/<a href="../file/src/sql/tests/results/create_table_error_pk_multiple.html">src/sql/tests/results/create_table_error_pk_multiple</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -24,14 +24,20 @@ AST: CreateTable {
</a>             datatype: Integer,
             primary_key: true,
             nullable: None,
<a href="#h14-0-3" id="h14-0-3" class="i">+            default: None,
</a><a href="#h14-0-4" id="h14-0-4" class="i">+            unique: false,
</a><a href="#h14-0-5" id="h14-0-5" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;name&quot;,
             datatype: String,
             primary_key: true,
             nullable: None,
<a href="#h14-0-12" id="h14-0-12" class="i">+            default: None,
</a><a href="#h14-0-13" id="h14-0-13" class="i">+            unique: false,
</a><a href="#h14-0-14" id="h14-0-14" class="i">+            references: None,
</a>         },
     ],
 }
 
<a href="#h14-0-19" id="h14-0-19" class="d">-Plan: Value(&quot;2 primary keys defined for table name, must set exactly 1&quot;)
</a><a href="#h14-0-20" id="h14-0-20" class="d">-\ No newline at end of file
</a><a href="#h14-0-21" id="h14-0-21" class="i">+Plan: Value(&quot;Multiple primary keys in table name&quot;)
</a><a href="#h14-0-22" id="h14-0-22" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h15" href="../file/src/sql/tests/results/create_table_error_pk_nullable.html">src/sql/tests/results/create_table_error_pk_nullable</a> b/<a href="../file/src/sql/tests/results/create_table_error_pk_nullable.html">src/sql/tests/results/create_table_error_pk_nullable</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -22,8 +22,11 @@ AST: CreateTable {
</a>             nullable: Some(
                 true,
             ),
<a href="#h15-0-3" id="h15-0-3" class="i">+            default: None,
</a><a href="#h15-0-4" id="h15-0-4" class="i">+            unique: false,
</a><a href="#h15-0-5" id="h15-0-5" class="i">+            references: None,
</a>         },
     ],
 }
 
<a href="#h15-0-10" id="h15-0-10" class="d">-Plan: Value(&quot;Primary key column id cannot be nullable&quot;)
</a><a href="#h15-0-11" id="h15-0-11" class="d">-\ No newline at end of file
</a><a href="#h15-0-12" id="h15-0-12" class="i">+Plan: Value(&quot;Primary key id cannot be nullable&quot;)
</a><a href="#h15-0-13" id="h15-0-13" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h16" href="../file/src/sql/tests/results/create_table_japanese.html">src/sql/tests/results/create_table_japanese</a> b/<a href="../file/src/sql/tests/results/create_table_japanese.html">src/sql/tests/results/create_table_japanese</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -22,12 +22,18 @@ AST: CreateTable {
</a>             datatype: Integer,
             primary_key: true,
             nullable: None,
<a href="#h16-0-3" id="h16-0-3" class="i">+            default: None,
</a><a href="#h16-0-4" id="h16-0-4" class="i">+            unique: false,
</a><a href="#h16-0-5" id="h16-0-5" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;名前&quot;,
             datatype: String,
             primary_key: false,
             nullable: None,
<a href="#h16-0-12" id="h16-0-12" class="i">+            default: None,
</a><a href="#h16-0-13" id="h16-0-13" class="i">+            unique: false,
</a><a href="#h16-0-14" id="h16-0-14" class="i">+            references: None,
</a>         },
     ],
 }
<a href="#h16-1" id="h16-1" class="h">@@ -40,15 +46,24 @@ Plan: Plan {
</a>                 Column {
                     name: &quot;身元&quot;,
                     datatype: Integer,
<a href="#h16-1-3" id="h16-1-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h16-1-5" id="h16-1-5" class="i">+                    default: None,
</a><a href="#h16-1-6" id="h16-1-6" class="i">+                    unique: false,
</a><a href="#h16-1-7" id="h16-1-7" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;名前&quot;,
                     datatype: String,
<a href="#h16-1-12" id="h16-1-12" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h16-1-14" id="h16-1-14" class="i">+                    default: Some(
</a><a href="#h16-1-15" id="h16-1-15" class="i">+                        Null,
</a><a href="#h16-1-16" id="h16-1-16" class="i">+                    ),
</a><a href="#h16-1-17" id="h16-1-17" class="i">+                    unique: false,
</a><a href="#h16-1-18" id="h16-1-18" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h16-1-21" id="h16-1-21" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h16-2" id="h16-2" class="h">@@ -61,15 +76,24 @@ Optimized plan: Plan {
</a>                 Column {
                     name: &quot;身元&quot;,
                     datatype: Integer,
<a href="#h16-2-3" id="h16-2-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h16-2-5" id="h16-2-5" class="i">+                    default: None,
</a><a href="#h16-2-6" id="h16-2-6" class="i">+                    unique: false,
</a><a href="#h16-2-7" id="h16-2-7" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;名前&quot;,
                     datatype: String,
<a href="#h16-2-12" id="h16-2-12" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h16-2-14" id="h16-2-14" class="i">+                    default: Some(
</a><a href="#h16-2-15" id="h16-2-15" class="i">+                        Null,
</a><a href="#h16-2-16" id="h16-2-16" class="i">+                    ),
</a><a href="#h16-2-17" id="h16-2-17" class="i">+                    unique: false,
</a><a href="#h16-2-18" id="h16-2-18" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h16-2-21" id="h16-2-21" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h16-3" id="h16-3" class="h">@@ -89,10 +113,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h16-3-3" id="h16-3-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h16-3-4" id="h16-3-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h16-3-6" id="h16-3-6" class="d">-  rating FLOAT,
</a><a href="#h16-3-7" id="h16-3-7" class="d">-  bluray BOOLEAN
</a><a href="#h16-3-8" id="h16-3-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h16-3-9" id="h16-3-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h16-4" id="h16-4" class="h">@@ -102,5 +126,5 @@ CREATE TABLE movies (
</a> 
 CREATE TABLE 表 (
   身元 INTEGER PRIMARY KEY NOT NULL,
<a href="#h16-4-3" id="h16-4-3" class="d">-  名前 STRING
</a><a href="#h16-4-4" id="h16-4-4" class="i">+  名前 STRING DEFAULT NULL
</a> )
<b>diff --git a/<a id="h17" href="../file/src/sql/tests/results/create_table_single_column.html">src/sql/tests/results/create_table_single_column</a> b/<a href="../file/src/sql/tests/results/create_table_single_column.html">src/sql/tests/results/create_table_single_column</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -19,6 +19,9 @@ AST: CreateTable {
</a>             datatype: Integer,
             primary_key: true,
             nullable: None,
<a href="#h17-0-3" id="h17-0-3" class="i">+            default: None,
</a><a href="#h17-0-4" id="h17-0-4" class="i">+            unique: false,
</a><a href="#h17-0-5" id="h17-0-5" class="i">+            references: None,
</a>         },
     ],
 }
<a href="#h17-1" id="h17-1" class="h">@@ -31,10 +34,13 @@ Plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h17-1-3" id="h17-1-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h17-1-5" id="h17-1-5" class="i">+                    default: None,
</a><a href="#h17-1-6" id="h17-1-6" class="i">+                    unique: false,
</a><a href="#h17-1-7" id="h17-1-7" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h17-1-10" id="h17-1-10" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h17-2" id="h17-2" class="h">@@ -47,10 +53,13 @@ Optimized plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h17-2-3" id="h17-2-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h17-2-5" id="h17-2-5" class="i">+                    default: None,
</a><a href="#h17-2-6" id="h17-2-6" class="i">+                    unique: false,
</a><a href="#h17-2-7" id="h17-2-7" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h17-2-10" id="h17-2-10" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h17-3" id="h17-3" class="h">@@ -70,10 +79,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h17-3-3" id="h17-3-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h17-3-4" id="h17-3-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h17-3-6" id="h17-3-6" class="d">-  rating FLOAT,
</a><a href="#h17-3-7" id="h17-3-7" class="d">-  bluray BOOLEAN
</a><a href="#h17-3-8" id="h17-3-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h17-3-9" id="h17-3-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h18" href="../file/src/sql/tests/results/create_table_types.html">src/sql/tests/results/create_table_types</a> b/<a href="../file/src/sql/tests/results/create_table_types.html">src/sql/tests/results/create_table_types</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -63,66 +63,99 @@ AST: CreateTable {
</a>             datatype: Integer,
             primary_key: true,
             nullable: None,
<a href="#h18-0-3" id="h18-0-3" class="i">+            default: None,
</a><a href="#h18-0-4" id="h18-0-4" class="i">+            unique: false,
</a><a href="#h18-0-5" id="h18-0-5" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;bool_&quot;,
             datatype: Boolean,
             primary_key: false,
             nullable: None,
<a href="#h18-0-12" id="h18-0-12" class="i">+            default: None,
</a><a href="#h18-0-13" id="h18-0-13" class="i">+            unique: false,
</a><a href="#h18-0-14" id="h18-0-14" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;boolean_&quot;,
             datatype: Boolean,
             primary_key: false,
             nullable: None,
<a href="#h18-0-21" id="h18-0-21" class="i">+            default: None,
</a><a href="#h18-0-22" id="h18-0-22" class="i">+            unique: false,
</a><a href="#h18-0-23" id="h18-0-23" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;char_&quot;,
             datatype: String,
             primary_key: false,
             nullable: None,
<a href="#h18-0-30" id="h18-0-30" class="i">+            default: None,
</a><a href="#h18-0-31" id="h18-0-31" class="i">+            unique: false,
</a><a href="#h18-0-32" id="h18-0-32" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;double_&quot;,
             datatype: Float,
             primary_key: false,
             nullable: None,
<a href="#h18-0-39" id="h18-0-39" class="i">+            default: None,
</a><a href="#h18-0-40" id="h18-0-40" class="i">+            unique: false,
</a><a href="#h18-0-41" id="h18-0-41" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;float_&quot;,
             datatype: Float,
             primary_key: false,
             nullable: None,
<a href="#h18-0-48" id="h18-0-48" class="i">+            default: None,
</a><a href="#h18-0-49" id="h18-0-49" class="i">+            unique: false,
</a><a href="#h18-0-50" id="h18-0-50" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;int_&quot;,
             datatype: Integer,
             primary_key: false,
             nullable: None,
<a href="#h18-0-57" id="h18-0-57" class="i">+            default: None,
</a><a href="#h18-0-58" id="h18-0-58" class="i">+            unique: false,
</a><a href="#h18-0-59" id="h18-0-59" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;integer_&quot;,
             datatype: Integer,
             primary_key: false,
             nullable: None,
<a href="#h18-0-66" id="h18-0-66" class="i">+            default: None,
</a><a href="#h18-0-67" id="h18-0-67" class="i">+            unique: false,
</a><a href="#h18-0-68" id="h18-0-68" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;string_&quot;,
             datatype: String,
             primary_key: false,
             nullable: None,
<a href="#h18-0-75" id="h18-0-75" class="i">+            default: None,
</a><a href="#h18-0-76" id="h18-0-76" class="i">+            unique: false,
</a><a href="#h18-0-77" id="h18-0-77" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;text_&quot;,
             datatype: String,
             primary_key: false,
             nullable: None,
<a href="#h18-0-84" id="h18-0-84" class="i">+            default: None,
</a><a href="#h18-0-85" id="h18-0-85" class="i">+            unique: false,
</a><a href="#h18-0-86" id="h18-0-86" class="i">+            references: None,
</a>         },
         ColumnSpec {
             name: &quot;varchar_&quot;,
             datatype: String,
             primary_key: false,
             nullable: None,
<a href="#h18-0-93" id="h18-0-93" class="i">+            default: None,
</a><a href="#h18-0-94" id="h18-0-94" class="i">+            unique: false,
</a><a href="#h18-0-95" id="h18-0-95" class="i">+            references: None,
</a>         },
     ],
 }
<a href="#h18-1" id="h18-1" class="h">@@ -135,60 +168,123 @@ Plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h18-1-3" id="h18-1-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h18-1-5" id="h18-1-5" class="i">+                    default: None,
</a><a href="#h18-1-6" id="h18-1-6" class="i">+                    unique: false,
</a><a href="#h18-1-7" id="h18-1-7" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;bool_&quot;,
                     datatype: Boolean,
<a href="#h18-1-12" id="h18-1-12" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-14" id="h18-1-14" class="i">+                    default: Some(
</a><a href="#h18-1-15" id="h18-1-15" class="i">+                        Null,
</a><a href="#h18-1-16" id="h18-1-16" class="i">+                    ),
</a><a href="#h18-1-17" id="h18-1-17" class="i">+                    unique: false,
</a><a href="#h18-1-18" id="h18-1-18" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;boolean_&quot;,
                     datatype: Boolean,
<a href="#h18-1-23" id="h18-1-23" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-25" id="h18-1-25" class="i">+                    default: Some(
</a><a href="#h18-1-26" id="h18-1-26" class="i">+                        Null,
</a><a href="#h18-1-27" id="h18-1-27" class="i">+                    ),
</a><a href="#h18-1-28" id="h18-1-28" class="i">+                    unique: false,
</a><a href="#h18-1-29" id="h18-1-29" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;char_&quot;,
                     datatype: String,
<a href="#h18-1-34" id="h18-1-34" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-36" id="h18-1-36" class="i">+                    default: Some(
</a><a href="#h18-1-37" id="h18-1-37" class="i">+                        Null,
</a><a href="#h18-1-38" id="h18-1-38" class="i">+                    ),
</a><a href="#h18-1-39" id="h18-1-39" class="i">+                    unique: false,
</a><a href="#h18-1-40" id="h18-1-40" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;double_&quot;,
                     datatype: Float,
<a href="#h18-1-45" id="h18-1-45" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-47" id="h18-1-47" class="i">+                    default: Some(
</a><a href="#h18-1-48" id="h18-1-48" class="i">+                        Null,
</a><a href="#h18-1-49" id="h18-1-49" class="i">+                    ),
</a><a href="#h18-1-50" id="h18-1-50" class="i">+                    unique: false,
</a><a href="#h18-1-51" id="h18-1-51" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;float_&quot;,
                     datatype: Float,
<a href="#h18-1-56" id="h18-1-56" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-58" id="h18-1-58" class="i">+                    default: Some(
</a><a href="#h18-1-59" id="h18-1-59" class="i">+                        Null,
</a><a href="#h18-1-60" id="h18-1-60" class="i">+                    ),
</a><a href="#h18-1-61" id="h18-1-61" class="i">+                    unique: false,
</a><a href="#h18-1-62" id="h18-1-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;int_&quot;,
                     datatype: Integer,
<a href="#h18-1-67" id="h18-1-67" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-69" id="h18-1-69" class="i">+                    default: Some(
</a><a href="#h18-1-70" id="h18-1-70" class="i">+                        Null,
</a><a href="#h18-1-71" id="h18-1-71" class="i">+                    ),
</a><a href="#h18-1-72" id="h18-1-72" class="i">+                    unique: false,
</a><a href="#h18-1-73" id="h18-1-73" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;integer_&quot;,
                     datatype: Integer,
<a href="#h18-1-78" id="h18-1-78" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-80" id="h18-1-80" class="i">+                    default: Some(
</a><a href="#h18-1-81" id="h18-1-81" class="i">+                        Null,
</a><a href="#h18-1-82" id="h18-1-82" class="i">+                    ),
</a><a href="#h18-1-83" id="h18-1-83" class="i">+                    unique: false,
</a><a href="#h18-1-84" id="h18-1-84" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;string_&quot;,
                     datatype: String,
<a href="#h18-1-89" id="h18-1-89" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-91" id="h18-1-91" class="i">+                    default: Some(
</a><a href="#h18-1-92" id="h18-1-92" class="i">+                        Null,
</a><a href="#h18-1-93" id="h18-1-93" class="i">+                    ),
</a><a href="#h18-1-94" id="h18-1-94" class="i">+                    unique: false,
</a><a href="#h18-1-95" id="h18-1-95" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;text_&quot;,
                     datatype: String,
<a href="#h18-1-100" id="h18-1-100" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-102" id="h18-1-102" class="i">+                    default: Some(
</a><a href="#h18-1-103" id="h18-1-103" class="i">+                        Null,
</a><a href="#h18-1-104" id="h18-1-104" class="i">+                    ),
</a><a href="#h18-1-105" id="h18-1-105" class="i">+                    unique: false,
</a><a href="#h18-1-106" id="h18-1-106" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;varchar_&quot;,
                     datatype: String,
<a href="#h18-1-111" id="h18-1-111" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-1-113" id="h18-1-113" class="i">+                    default: Some(
</a><a href="#h18-1-114" id="h18-1-114" class="i">+                        Null,
</a><a href="#h18-1-115" id="h18-1-115" class="i">+                    ),
</a><a href="#h18-1-116" id="h18-1-116" class="i">+                    unique: false,
</a><a href="#h18-1-117" id="h18-1-117" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h18-1-120" id="h18-1-120" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h18-2" id="h18-2" class="h">@@ -201,60 +297,123 @@ Optimized plan: Plan {
</a>                 Column {
                     name: &quot;id&quot;,
                     datatype: Integer,
<a href="#h18-2-3" id="h18-2-3" class="i">+                    primary_key: true,
</a>                     nullable: false,
<a href="#h18-2-5" id="h18-2-5" class="i">+                    default: None,
</a><a href="#h18-2-6" id="h18-2-6" class="i">+                    unique: false,
</a><a href="#h18-2-7" id="h18-2-7" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;bool_&quot;,
                     datatype: Boolean,
<a href="#h18-2-12" id="h18-2-12" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-14" id="h18-2-14" class="i">+                    default: Some(
</a><a href="#h18-2-15" id="h18-2-15" class="i">+                        Null,
</a><a href="#h18-2-16" id="h18-2-16" class="i">+                    ),
</a><a href="#h18-2-17" id="h18-2-17" class="i">+                    unique: false,
</a><a href="#h18-2-18" id="h18-2-18" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;boolean_&quot;,
                     datatype: Boolean,
<a href="#h18-2-23" id="h18-2-23" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-25" id="h18-2-25" class="i">+                    default: Some(
</a><a href="#h18-2-26" id="h18-2-26" class="i">+                        Null,
</a><a href="#h18-2-27" id="h18-2-27" class="i">+                    ),
</a><a href="#h18-2-28" id="h18-2-28" class="i">+                    unique: false,
</a><a href="#h18-2-29" id="h18-2-29" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;char_&quot;,
                     datatype: String,
<a href="#h18-2-34" id="h18-2-34" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-36" id="h18-2-36" class="i">+                    default: Some(
</a><a href="#h18-2-37" id="h18-2-37" class="i">+                        Null,
</a><a href="#h18-2-38" id="h18-2-38" class="i">+                    ),
</a><a href="#h18-2-39" id="h18-2-39" class="i">+                    unique: false,
</a><a href="#h18-2-40" id="h18-2-40" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;double_&quot;,
                     datatype: Float,
<a href="#h18-2-45" id="h18-2-45" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-47" id="h18-2-47" class="i">+                    default: Some(
</a><a href="#h18-2-48" id="h18-2-48" class="i">+                        Null,
</a><a href="#h18-2-49" id="h18-2-49" class="i">+                    ),
</a><a href="#h18-2-50" id="h18-2-50" class="i">+                    unique: false,
</a><a href="#h18-2-51" id="h18-2-51" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;float_&quot;,
                     datatype: Float,
<a href="#h18-2-56" id="h18-2-56" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-58" id="h18-2-58" class="i">+                    default: Some(
</a><a href="#h18-2-59" id="h18-2-59" class="i">+                        Null,
</a><a href="#h18-2-60" id="h18-2-60" class="i">+                    ),
</a><a href="#h18-2-61" id="h18-2-61" class="i">+                    unique: false,
</a><a href="#h18-2-62" id="h18-2-62" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;int_&quot;,
                     datatype: Integer,
<a href="#h18-2-67" id="h18-2-67" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-69" id="h18-2-69" class="i">+                    default: Some(
</a><a href="#h18-2-70" id="h18-2-70" class="i">+                        Null,
</a><a href="#h18-2-71" id="h18-2-71" class="i">+                    ),
</a><a href="#h18-2-72" id="h18-2-72" class="i">+                    unique: false,
</a><a href="#h18-2-73" id="h18-2-73" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;integer_&quot;,
                     datatype: Integer,
<a href="#h18-2-78" id="h18-2-78" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-80" id="h18-2-80" class="i">+                    default: Some(
</a><a href="#h18-2-81" id="h18-2-81" class="i">+                        Null,
</a><a href="#h18-2-82" id="h18-2-82" class="i">+                    ),
</a><a href="#h18-2-83" id="h18-2-83" class="i">+                    unique: false,
</a><a href="#h18-2-84" id="h18-2-84" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;string_&quot;,
                     datatype: String,
<a href="#h18-2-89" id="h18-2-89" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-91" id="h18-2-91" class="i">+                    default: Some(
</a><a href="#h18-2-92" id="h18-2-92" class="i">+                        Null,
</a><a href="#h18-2-93" id="h18-2-93" class="i">+                    ),
</a><a href="#h18-2-94" id="h18-2-94" class="i">+                    unique: false,
</a><a href="#h18-2-95" id="h18-2-95" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;text_&quot;,
                     datatype: String,
<a href="#h18-2-100" id="h18-2-100" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-102" id="h18-2-102" class="i">+                    default: Some(
</a><a href="#h18-2-103" id="h18-2-103" class="i">+                        Null,
</a><a href="#h18-2-104" id="h18-2-104" class="i">+                    ),
</a><a href="#h18-2-105" id="h18-2-105" class="i">+                    unique: false,
</a><a href="#h18-2-106" id="h18-2-106" class="i">+                    references: None,
</a>                 },
                 Column {
                     name: &quot;varchar_&quot;,
                     datatype: String,
<a href="#h18-2-111" id="h18-2-111" class="i">+                    primary_key: false,
</a>                     nullable: true,
<a href="#h18-2-113" id="h18-2-113" class="i">+                    default: Some(
</a><a href="#h18-2-114" id="h18-2-114" class="i">+                        Null,
</a><a href="#h18-2-115" id="h18-2-115" class="i">+                    ),
</a><a href="#h18-2-116" id="h18-2-116" class="i">+                    unique: false,
</a><a href="#h18-2-117" id="h18-2-117" class="i">+                    references: None,
</a>                 },
             ],
<a href="#h18-2-120" id="h18-2-120" class="d">-            primary_key: 0,
</a>         },
     },
 }
<a href="#h18-3" id="h18-3" class="h">@@ -288,10 +447,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h18-3-3" id="h18-3-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h18-3-4" id="h18-3-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h18-3-6" id="h18-3-6" class="d">-  rating FLOAT,
</a><a href="#h18-3-7" id="h18-3-7" class="d">-  bluray BOOLEAN
</a><a href="#h18-3-8" id="h18-3-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h18-3-9" id="h18-3-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h18-4" id="h18-4" class="h">@@ -301,14 +460,14 @@ CREATE TABLE movies (
</a> 
 CREATE TABLE name (
   id INTEGER PRIMARY KEY NOT NULL,
<a href="#h18-4-3" id="h18-4-3" class="d">-  bool_ BOOLEAN,
</a><a href="#h18-4-4" id="h18-4-4" class="d">-  boolean_ BOOLEAN,
</a><a href="#h18-4-5" id="h18-4-5" class="d">-  char_ STRING,
</a><a href="#h18-4-6" id="h18-4-6" class="d">-  double_ FLOAT,
</a><a href="#h18-4-7" id="h18-4-7" class="d">-  float_ FLOAT,
</a><a href="#h18-4-8" id="h18-4-8" class="d">-  int_ INTEGER,
</a><a href="#h18-4-9" id="h18-4-9" class="d">-  integer_ INTEGER,
</a><a href="#h18-4-10" id="h18-4-10" class="d">-  string_ STRING,
</a><a href="#h18-4-11" id="h18-4-11" class="d">-  text_ STRING,
</a><a href="#h18-4-12" id="h18-4-12" class="d">-  varchar_ STRING
</a><a href="#h18-4-13" id="h18-4-13" class="i">+  bool_ BOOLEAN DEFAULT NULL,
</a><a href="#h18-4-14" id="h18-4-14" class="i">+  boolean_ BOOLEAN DEFAULT NULL,
</a><a href="#h18-4-15" id="h18-4-15" class="i">+  char_ STRING DEFAULT NULL,
</a><a href="#h18-4-16" id="h18-4-16" class="i">+  double_ FLOAT DEFAULT NULL,
</a><a href="#h18-4-17" id="h18-4-17" class="i">+  float_ FLOAT DEFAULT NULL,
</a><a href="#h18-4-18" id="h18-4-18" class="i">+  int_ INTEGER DEFAULT NULL,
</a><a href="#h18-4-19" id="h18-4-19" class="i">+  integer_ INTEGER DEFAULT NULL,
</a><a href="#h18-4-20" id="h18-4-20" class="i">+  string_ STRING DEFAULT NULL,
</a><a href="#h18-4-21" id="h18-4-21" class="i">+  text_ STRING DEFAULT NULL,
</a><a href="#h18-4-22" id="h18-4-22" class="i">+  varchar_ STRING DEFAULT NULL
</a> )
<b>diff --git a/<a id="h19" href="../file/src/sql/tests/results/delete_all.html">src/sql/tests/results/delete_all</a> b/<a href="../file/src/sql/tests/results/delete_all.html">src/sql/tests/results/delete_all</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -43,8 +43,8 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h19-0-3" id="h19-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h19-0-4" id="h19-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h19-0-6" id="h19-0-6" class="d">-  rating FLOAT,
</a><a href="#h19-0-7" id="h19-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h19-0-8" id="h19-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h19-0-9" id="h19-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
<b>diff --git a/<a id="h20" href="../file/src/sql/tests/results/delete_where.html">src/sql/tests/results/delete_where</a> b/<a href="../file/src/sql/tests/results/delete_where.html">src/sql/tests/results/delete_where</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -110,10 +110,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h20-0-3" id="h20-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h20-0-4" id="h20-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h20-0-6" id="h20-0-6" class="d">-  rating FLOAT,
</a><a href="#h20-0-7" id="h20-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h20-0-8" id="h20-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h20-0-9" id="h20-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(4), String(&quot;Heat&quot;), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
<b>diff --git a/<a id="h21" href="../file/src/sql/tests/results/delete_where_false.html">src/sql/tests/results/delete_where_false</a> b/<a href="../file/src/sql/tests/results/delete_where_false.html">src/sql/tests/results/delete_where_false</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -67,10 +67,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h21-0-3" id="h21-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h21-0-4" id="h21-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h21-0-6" id="h21-0-6" class="d">-  rating FLOAT,
</a><a href="#h21-0-7" id="h21-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h21-0-8" id="h21-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h21-0-9" id="h21-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h22" href="../file/src/sql/tests/results/delete_where_null.html">src/sql/tests/results/delete_where_null</a> b/<a href="../file/src/sql/tests/results/delete_where_null.html">src/sql/tests/results/delete_where_null</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -61,10 +61,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h22-0-3" id="h22-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h22-0-4" id="h22-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h22-0-6" id="h22-0-6" class="d">-  rating FLOAT,
</a><a href="#h22-0-7" id="h22-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h22-0-8" id="h22-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h22-0-9" id="h22-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h23" href="../file/src/sql/tests/results/delete_where_true.html">src/sql/tests/results/delete_where_true</a> b/<a href="../file/src/sql/tests/results/delete_where_true.html">src/sql/tests/results/delete_where_true</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -67,8 +67,8 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h23-0-3" id="h23-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h23-0-4" id="h23-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h23-0-6" id="h23-0-6" class="d">-  rating FLOAT,
</a><a href="#h23-0-7" id="h23-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h23-0-8" id="h23-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h23-0-9" id="h23-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
<b>diff --git a/<a id="h24" href="../file/src/sql/tests/results/insert_default_null.html">src/sql/tests/results/insert_default_null</a> b/<a href="../file/src/sql/tests/results/insert_default_null.html">src/sql/tests/results/insert_default_null</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -121,10 +121,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h24-0-3" id="h24-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h24-0-4" id="h24-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h24-0-6" id="h24-0-6" class="d">-  rating FLOAT,
</a><a href="#h24-0-7" id="h24-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h24-0-8" id="h24-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h24-0-9" id="h24-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h25" href="../file/src/sql/tests/results/insert_expression.html">src/sql/tests/results/insert_expression</a> b/<a href="../file/src/sql/tests/results/insert_expression.html">src/sql/tests/results/insert_expression</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -331,10 +331,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h25-0-3" id="h25-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h25-0-4" id="h25-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h25-0-6" id="h25-0-6" class="d">-  rating FLOAT,
</a><a href="#h25-0-7" id="h25-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h25-0-8" id="h25-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h25-0-9" id="h25-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h26" href="../file/src/sql/tests/results/insert_float_infinity.html">src/sql/tests/results/insert_float_infinity</a> b/<a href="../file/src/sql/tests/results/insert_float_infinity.html">src/sql/tests/results/insert_float_infinity</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -169,10 +169,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h26-0-3" id="h26-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h26-0-4" id="h26-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h26-0-6" id="h26-0-6" class="d">-  rating FLOAT,
</a><a href="#h26-0-7" id="h26-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h26-0-8" id="h26-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h26-0-9" id="h26-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h27" href="../file/src/sql/tests/results/insert_float_max.html">src/sql/tests/results/insert_float_max</a> b/<a href="../file/src/sql/tests/results/insert_float_max.html">src/sql/tests/results/insert_float_max</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -169,10 +169,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h27-0-3" id="h27-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h27-0-4" id="h27-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h27-0-6" id="h27-0-6" class="d">-  rating FLOAT,
</a><a href="#h27-0-7" id="h27-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h27-0-8" id="h27-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h27-0-9" id="h27-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h28" href="../file/src/sql/tests/results/insert_float_max_neg.html">src/sql/tests/results/insert_float_max_neg</a> b/<a href="../file/src/sql/tests/results/insert_float_max_neg.html">src/sql/tests/results/insert_float_max_neg</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -176,10 +176,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h28-0-3" id="h28-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h28-0-4" id="h28-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h28-0-6" id="h28-0-6" class="d">-  rating FLOAT,
</a><a href="#h28-0-7" id="h28-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h28-0-8" id="h28-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h28-0-9" id="h28-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h29" href="../file/src/sql/tests/results/insert_float_min.html">src/sql/tests/results/insert_float_min</a> b/<a href="../file/src/sql/tests/results/insert_float_min.html">src/sql/tests/results/insert_float_min</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -169,10 +169,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h29-0-3" id="h29-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h29-0-4" id="h29-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h29-0-6" id="h29-0-6" class="d">-  rating FLOAT,
</a><a href="#h29-0-7" id="h29-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h29-0-8" id="h29-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h29-0-9" id="h29-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h30" href="../file/src/sql/tests/results/insert_float_min_neg.html">src/sql/tests/results/insert_float_min_neg</a> b/<a href="../file/src/sql/tests/results/insert_float_min_neg.html">src/sql/tests/results/insert_float_min_neg</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -176,10 +176,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h30-0-3" id="h30-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h30-0-4" id="h30-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h30-0-6" id="h30-0-6" class="d">-  rating FLOAT,
</a><a href="#h30-0-7" id="h30-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h30-0-8" id="h30-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h30-0-9" id="h30-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h31" href="../file/src/sql/tests/results/insert_float_min_round.html">src/sql/tests/results/insert_float_min_round</a> b/<a href="../file/src/sql/tests/results/insert_float_min_round.html">src/sql/tests/results/insert_float_min_round</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -169,10 +169,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h31-0-3" id="h31-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h31-0-4" id="h31-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h31-0-6" id="h31-0-6" class="d">-  rating FLOAT,
</a><a href="#h31-0-7" id="h31-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h31-0-8" id="h31-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h31-0-9" id="h31-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h32" href="../file/src/sql/tests/results/insert_float_nan.html">src/sql/tests/results/insert_float_nan</a> b/<a href="../file/src/sql/tests/results/insert_float_nan.html">src/sql/tests/results/insert_float_nan</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -169,10 +169,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h32-0-3" id="h32-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h32-0-4" id="h32-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h32-0-6" id="h32-0-6" class="d">-  rating FLOAT,
</a><a href="#h32-0-7" id="h32-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h32-0-8" id="h32-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h32-0-9" id="h32-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h33" href="../file/src/sql/tests/results/insert_integer_max.html">src/sql/tests/results/insert_integer_max</a> b/<a href="../file/src/sql/tests/results/insert_integer_max.html">src/sql/tests/results/insert_integer_max</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -147,10 +147,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h33-0-3" id="h33-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h33-0-4" id="h33-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h33-0-6" id="h33-0-6" class="d">-  rating FLOAT,
</a><a href="#h33-0-7" id="h33-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h33-0-8" id="h33-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h33-0-9" id="h33-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h34" href="../file/src/sql/tests/results/insert_integer_min.html">src/sql/tests/results/insert_integer_min</a> b/<a href="../file/src/sql/tests/results/insert_integer_min.html">src/sql/tests/results/insert_integer_min</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -154,10 +154,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h34-0-3" id="h34-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h34-0-4" id="h34-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h34-0-6" id="h34-0-6" class="d">-  rating FLOAT,
</a><a href="#h34-0-7" id="h34-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h34-0-8" id="h34-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h34-0-9" id="h34-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h35" href="../file/src/sql/tests/results/insert_partial.html">src/sql/tests/results/insert_partial</a> b/<a href="../file/src/sql/tests/results/insert_partial.html">src/sql/tests/results/insert_partial</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -169,10 +169,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h35-0-3" id="h35-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h35-0-4" id="h35-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h35-0-6" id="h35-0-6" class="d">-  rating FLOAT,
</a><a href="#h35-0-7" id="h35-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h35-0-8" id="h35-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h35-0-9" id="h35-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h36" href="../file/src/sql/tests/results/insert_string_1024.html">src/sql/tests/results/insert_string_1024</a> b/<a href="../file/src/sql/tests/results/insert_string_1024.html">src/sql/tests/results/insert_string_1024</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -147,10 +147,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h36-0-3" id="h36-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h36-0-4" id="h36-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h36-0-6" id="h36-0-6" class="d">-  rating FLOAT,
</a><a href="#h36-0-7" id="h36-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h36-0-8" id="h36-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h36-0-9" id="h36-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h37" href="../file/src/sql/tests/results/insert_string_1024_unicode.html">src/sql/tests/results/insert_string_1024_unicode</a> b/<a href="../file/src/sql/tests/results/insert_string_1024_unicode.html">src/sql/tests/results/insert_string_1024_unicode</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -147,10 +147,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h37-0-3" id="h37-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h37-0-4" id="h37-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h37-0-6" id="h37-0-6" class="d">-  rating FLOAT,
</a><a href="#h37-0-7" id="h37-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h37-0-8" id="h37-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h37-0-9" id="h37-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h38" href="../file/src/sql/tests/results/insert_string_empty.html">src/sql/tests/results/insert_string_empty</a> b/<a href="../file/src/sql/tests/results/insert_string_empty.html">src/sql/tests/results/insert_string_empty</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -147,10 +147,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h38-0-3" id="h38-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h38-0-4" id="h38-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h38-0-6" id="h38-0-6" class="d">-  rating FLOAT,
</a><a href="#h38-0-7" id="h38-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h38-0-8" id="h38-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h38-0-9" id="h38-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h39" href="../file/src/sql/tests/results/insert_values.html">src/sql/tests/results/insert_values</a> b/<a href="../file/src/sql/tests/results/insert_values.html">src/sql/tests/results/insert_values</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -88,10 +88,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h39-0-3" id="h39-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h39-0-4" id="h39-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h39-0-6" id="h39-0-6" class="d">-  rating FLOAT,
</a><a href="#h39-0-7" id="h39-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h39-0-8" id="h39-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h39-0-9" id="h39-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h40" href="../file/src/sql/tests/results/select_aliases.html">src/sql/tests/results/select_aliases</a> b/<a href="../file/src/sql/tests/results/select_aliases.html">src/sql/tests/results/select_aliases</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -127,10 +127,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h40-0-3" id="h40-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h40-0-4" id="h40-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h40-0-6" id="h40-0-6" class="d">-  rating FLOAT,
</a><a href="#h40-0-7" id="h40-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h40-0-8" id="h40-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h40-0-9" id="h40-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h41" href="../file/src/sql/tests/results/select_all_from_table.html">src/sql/tests/results/select_all_from_table</a> b/<a href="../file/src/sql/tests/results/select_all_from_table.html">src/sql/tests/results/select_all_from_table</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -56,10 +56,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h41-0-3" id="h41-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h41-0-4" id="h41-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h41-0-6" id="h41-0-6" class="d">-  rating FLOAT,
</a><a href="#h41-0-7" id="h41-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h41-0-8" id="h41-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h41-0-9" id="h41-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h42" href="../file/src/sql/tests/results/select_case.html">src/sql/tests/results/select_case</a> b/<a href="../file/src/sql/tests/results/select_case.html">src/sql/tests/results/select_case</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -90,10 +90,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h42-0-3" id="h42-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h42-0-4" id="h42-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h42-0-6" id="h42-0-6" class="d">-  rating FLOAT,
</a><a href="#h42-0-7" id="h42-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h42-0-8" id="h42-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h42-0-9" id="h42-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h43" href="../file/src/sql/tests/results/select_expr_where_false.html">src/sql/tests/results/select_expr_where_false</a> b/<a href="../file/src/sql/tests/results/select_expr_where_false.html">src/sql/tests/results/select_expr_where_false</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -95,10 +95,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h43-0-3" id="h43-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h43-0-4" id="h43-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h43-0-6" id="h43-0-6" class="d">-  rating FLOAT,
</a><a href="#h43-0-7" id="h43-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h43-0-8" id="h43-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h43-0-9" id="h43-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h44" href="../file/src/sql/tests/results/select_expr_where_true.html">src/sql/tests/results/select_expr_where_true</a> b/<a href="../file/src/sql/tests/results/select_expr_where_true.html">src/sql/tests/results/select_expr_where_true</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -96,10 +96,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h44-0-3" id="h44-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h44-0-4" id="h44-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h44-0-6" id="h44-0-6" class="d">-  rating FLOAT,
</a><a href="#h44-0-7" id="h44-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h44-0-8" id="h44-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h44-0-9" id="h44-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h45" href="../file/src/sql/tests/results/select_fields.html">src/sql/tests/results/select_fields</a> b/<a href="../file/src/sql/tests/results/select_fields.html">src/sql/tests/results/select_fields</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -168,10 +168,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h45-0-3" id="h45-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h45-0-4" id="h45-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h45-0-6" id="h45-0-6" class="d">-  rating FLOAT,
</a><a href="#h45-0-7" id="h45-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h45-0-8" id="h45-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h45-0-9" id="h45-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h46" href="../file/src/sql/tests/results/select_limit.html">src/sql/tests/results/select_limit</a> b/<a href="../file/src/sql/tests/results/select_limit.html">src/sql/tests/results/select_limit</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -97,10 +97,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h46-0-3" id="h46-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h46-0-4" id="h46-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h46-0-6" id="h46-0-6" class="d">-  rating FLOAT,
</a><a href="#h46-0-7" id="h46-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h46-0-8" id="h46-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h46-0-9" id="h46-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h47" href="../file/src/sql/tests/results/select_limit_offset.html">src/sql/tests/results/select_limit_offset</a> b/<a href="../file/src/sql/tests/results/select_limit_offset.html">src/sql/tests/results/select_limit_offset</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -111,10 +111,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h47-0-3" id="h47-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h47-0-4" id="h47-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h47-0-6" id="h47-0-6" class="d">-  rating FLOAT,
</a><a href="#h47-0-7" id="h47-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h47-0-8" id="h47-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h47-0-9" id="h47-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h48" href="../file/src/sql/tests/results/select_offset.html">src/sql/tests/results/select_offset</a> b/<a href="../file/src/sql/tests/results/select_offset.html">src/sql/tests/results/select_offset</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -98,10 +98,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h48-0-3" id="h48-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h48-0-4" id="h48-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h48-0-6" id="h48-0-6" class="d">-  rating FLOAT,
</a><a href="#h48-0-7" id="h48-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h48-0-8" id="h48-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h48-0-9" id="h48-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h49" href="../file/src/sql/tests/results/select_order.html">src/sql/tests/results/select_order</a> b/<a href="../file/src/sql/tests/results/select_order.html">src/sql/tests/results/select_order</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -108,10 +108,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h49-0-3" id="h49-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h49-0-4" id="h49-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h49-0-6" id="h49-0-6" class="d">-  rating FLOAT,
</a><a href="#h49-0-7" id="h49-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h49-0-8" id="h49-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h49-0-9" id="h49-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h50" href="../file/src/sql/tests/results/select_order_projection.html">src/sql/tests/results/select_order_projection</a> b/<a href="../file/src/sql/tests/results/select_order_projection.html">src/sql/tests/results/select_order_projection</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -159,10 +159,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h50-0-3" id="h50-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h50-0-4" id="h50-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h50-0-6" id="h50-0-6" class="d">-  rating FLOAT,
</a><a href="#h50-0-7" id="h50-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h50-0-8" id="h50-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h50-0-9" id="h50-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h51" href="../file/src/sql/tests/results/select_where.html">src/sql/tests/results/select_where</a> b/<a href="../file/src/sql/tests/results/select_where.html">src/sql/tests/results/select_where</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -164,10 +164,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h51-0-3" id="h51-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h51-0-4" id="h51-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h51-0-6" id="h51-0-6" class="d">-  rating FLOAT,
</a><a href="#h51-0-7" id="h51-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h51-0-8" id="h51-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h51-0-9" id="h51-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h52" href="../file/src/sql/tests/results/select_where_false.html">src/sql/tests/results/select_where_false</a> b/<a href="../file/src/sql/tests/results/select_where_false.html">src/sql/tests/results/select_where_false</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -75,10 +75,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h52-0-3" id="h52-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h52-0-4" id="h52-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h52-0-6" id="h52-0-6" class="d">-  rating FLOAT,
</a><a href="#h52-0-7" id="h52-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h52-0-8" id="h52-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h52-0-9" id="h52-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h53" href="../file/src/sql/tests/results/select_where_null.html">src/sql/tests/results/select_where_null</a> b/<a href="../file/src/sql/tests/results/select_where_null.html">src/sql/tests/results/select_where_null</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -69,10 +69,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h53-0-3" id="h53-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h53-0-4" id="h53-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h53-0-6" id="h53-0-6" class="d">-  rating FLOAT,
</a><a href="#h53-0-7" id="h53-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h53-0-8" id="h53-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h53-0-9" id="h53-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h54" href="../file/src/sql/tests/results/select_where_true.html">src/sql/tests/results/select_where_true</a> b/<a href="../file/src/sql/tests/results/select_where_true.html">src/sql/tests/results/select_where_true</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -80,10 +80,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h54-0-3" id="h54-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h54-0-4" id="h54-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h54-0-6" id="h54-0-6" class="d">-  rating FLOAT,
</a><a href="#h54-0-7" id="h54-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h54-0-8" id="h54-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h54-0-9" id="h54-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h55" href="../file/src/sql/tests/results/update_all.html">src/sql/tests/results/update_all</a> b/<a href="../file/src/sql/tests/results/update_all.html">src/sql/tests/results/update_all</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -99,10 +99,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h55-0-3" id="h55-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h55-0-4" id="h55-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h55-0-6" id="h55-0-6" class="d">-  rating FLOAT,
</a><a href="#h55-0-7" id="h55-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h55-0-8" id="h55-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h55-0-9" id="h55-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;X&quot;), Integer(1), Integer(0), Float(8.2), Null]
 [Integer(2), String(&quot;X&quot;), Integer(2), Integer(0), Float(7.6), Null]
<b>diff --git a/<a id="h56" href="../file/src/sql/tests/results/update_false.html">src/sql/tests/results/update_false</a> b/<a href="../file/src/sql/tests/results/update_false.html">src/sql/tests/results/update_false</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -91,10 +91,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h56-0-3" id="h56-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h56-0-4" id="h56-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h56-0-6" id="h56-0-6" class="d">-  rating FLOAT,
</a><a href="#h56-0-7" id="h56-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h56-0-8" id="h56-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h56-0-9" id="h56-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h57" href="../file/src/sql/tests/results/update_where.html">src/sql/tests/results/update_where</a> b/<a href="../file/src/sql/tests/results/update_where.html">src/sql/tests/results/update_where</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -117,10 +117,10 @@ CREATE TABLE genres (
</a> CREATE TABLE movies (
   id INTEGER PRIMARY KEY NOT NULL,
   title STRING NOT NULL,
<a href="#h57-0-3" id="h57-0-3" class="d">-  genre_id INTEGER NOT NULL,
</a><a href="#h57-0-4" id="h57-0-4" class="i">+  genre_id INTEGER NOT NULL REFERENCES genres,
</a>   released INTEGER NOT NULL,
<a href="#h57-0-6" id="h57-0-6" class="d">-  rating FLOAT,
</a><a href="#h57-0-7" id="h57-0-7" class="d">-  bluray BOOLEAN
</a><a href="#h57-0-8" id="h57-0-8" class="i">+  rating FLOAT DEFAULT NULL,
</a><a href="#h57-0-9" id="h57-0-9" class="i">+  bluray BOOLEAN DEFAULT NULL
</a> )
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1979), Null, Null]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h58" href="../file/src/sql/tests/sql.rs.html">src/sql/tests/sql.rs</a> b/<a href="../file/src/sql/tests/sql.rs.html">src/sql/tests/sql.rs</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -21,7 +21,7 @@ macro_rules! test_sql {
</a>                 &quot;CREATE TABLE movies (
                     id INTEGER PRIMARY KEY,
                     title STRING NOT NULL,
<a href="#h58-0-3" id="h58-0-3" class="d">-                    genre_id INTEGER NOT NULL,
</a><a href="#h58-0-4" id="h58-0-4" class="i">+                    genre_id INTEGER NOT NULL REFERENCES genres,
</a>                     released INTEGER NOT NULL,
                     rating FLOAT,
                     bluray BOOLEAN
<a href="#h58-1" id="h58-1" class="h">@@ -128,7 +128,7 @@ macro_rules! test_sql {
</a>             let txn = engine.begin()?;
             for table in &amp;txn.list_tables()? {
                 let schema = &amp;txn.read_table(&amp;table.name)?.unwrap();
<a href="#h58-1-3" id="h58-1-3" class="d">-                write!(f, &quot;\n{}\n&quot;, schema.to_query())?;
</a><a href="#h58-1-4" id="h58-1-4" class="i">+                write!(f, &quot;\n{}\n&quot;, schema.as_sql())?;
</a>                 for row in txn.scan(&amp;table.name)? {
                     write!(f, &quot;{:?}\n&quot;, row?)?;
                 }
<b>diff --git a/<a id="h59" href="../file/src/sql/types/schema.rs.html">src/sql/types/schema.rs</a> b/<a href="../file/src/sql/types/schema.rs.html">src/sql/types/schema.rs</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -10,11 +10,29 @@ pub struct Table {
</a>     pub name: String,
     /// The table columns
     pub columns: Vec&lt;Column&gt;,
<a href="#h59-0-3" id="h59-0-3" class="d">-    /// The index of the primary key column
</a><a href="#h59-0-4" id="h59-0-4" class="d">-    pub primary_key: usize,
</a> }
 
 impl Table {
<a href="#h59-0-8" id="h59-0-8" class="i">+    /// Creates a new table schema
</a><a href="#h59-0-9" id="h59-0-9" class="i">+    pub fn new(name: String, columns: Vec&lt;Column&gt;) -&gt; Result&lt;Self, Error&gt; {
</a><a href="#h59-0-10" id="h59-0-10" class="i">+        let table = Self { name, columns };
</a><a href="#h59-0-11" id="h59-0-11" class="i">+        table.validate()?;
</a><a href="#h59-0-12" id="h59-0-12" class="i">+        Ok(table)
</a><a href="#h59-0-13" id="h59-0-13" class="i">+    }
</a><a href="#h59-0-14" id="h59-0-14" class="i">+
</a><a href="#h59-0-15" id="h59-0-15" class="i">+    /// Generates an SQL DDL query for the table schema
</a><a href="#h59-0-16" id="h59-0-16" class="i">+    pub fn as_sql(&amp;self) -&gt; String {
</a><a href="#h59-0-17" id="h59-0-17" class="i">+        format!(
</a><a href="#h59-0-18" id="h59-0-18" class="i">+            &quot;CREATE TABLE {} (\n{}\n)&quot;,
</a><a href="#h59-0-19" id="h59-0-19" class="i">+            self.name,
</a><a href="#h59-0-20" id="h59-0-20" class="i">+            self.columns
</a><a href="#h59-0-21" id="h59-0-21" class="i">+                .iter()
</a><a href="#h59-0-22" id="h59-0-22" class="i">+                .map(|c| format!(&quot;  {}&quot;, c.as_sql()))
</a><a href="#h59-0-23" id="h59-0-23" class="i">+                .collect::&lt;Vec&lt;String&gt;&gt;()
</a><a href="#h59-0-24" id="h59-0-24" class="i">+                .join(&quot;,\n&quot;)
</a><a href="#h59-0-25" id="h59-0-25" class="i">+        )
</a><a href="#h59-0-26" id="h59-0-26" class="i">+    }
</a><a href="#h59-0-27" id="h59-0-27" class="i">+
</a>     /// Returns the index of a named column, if it exists
     pub fn column_index(&amp;self, name: &amp;str) -&gt; Option&lt;usize&gt; {
         self.columns.iter().position(|c| c.name == name)
<a href="#h59-1" id="h59-1" class="h">@@ -51,37 +69,40 @@ impl Table {
</a>         Ok(row)
     }
 
<a href="#h59-1-3" id="h59-1-3" class="d">-    /// Generates an SQL DDL query for the table schema
</a><a href="#h59-1-4" id="h59-1-4" class="d">-    pub fn to_query(&amp;self) -&gt; String {
</a><a href="#h59-1-5" id="h59-1-5" class="d">-        let mut query = format!(&quot;CREATE TABLE {} (\n&quot;, self.name);
</a><a href="#h59-1-6" id="h59-1-6" class="d">-        for (i, column) in self.columns.iter().enumerate() {
</a><a href="#h59-1-7" id="h59-1-7" class="d">-            query += &amp;format!(&quot;  {} {}&quot;, column.name, column.datatype);
</a><a href="#h59-1-8" id="h59-1-8" class="d">-            if i == self.primary_key {
</a><a href="#h59-1-9" id="h59-1-9" class="d">-                query += &quot; PRIMARY KEY&quot;;
</a><a href="#h59-1-10" id="h59-1-10" class="d">-            }
</a><a href="#h59-1-11" id="h59-1-11" class="d">-            if !column.nullable {
</a><a href="#h59-1-12" id="h59-1-12" class="d">-                query += &quot; NOT NULL&quot;;
</a><a href="#h59-1-13" id="h59-1-13" class="d">-            }
</a><a href="#h59-1-14" id="h59-1-14" class="d">-            if i &lt; self.columns.len() - 1 {
</a><a href="#h59-1-15" id="h59-1-15" class="d">-                query += &quot;,&quot;;
</a><a href="#h59-1-16" id="h59-1-16" class="d">-            }
</a><a href="#h59-1-17" id="h59-1-17" class="d">-            query += &quot;\n&quot;;
</a><a href="#h59-1-18" id="h59-1-18" class="d">-        }
</a><a href="#h59-1-19" id="h59-1-19" class="d">-        query += &quot;)&quot;;
</a><a href="#h59-1-20" id="h59-1-20" class="d">-        query
</a><a href="#h59-1-21" id="h59-1-21" class="i">+    /// Returns a row from a hashmap keyed by column name, padding it with nulls if needed
</a><a href="#h59-1-22" id="h59-1-22" class="i">+    pub fn row_from_hashmap(&amp;self, row: HashMap&lt;String, Value&gt;) -&gt; Row {
</a><a href="#h59-1-23" id="h59-1-23" class="i">+        self.columns.iter().map(|c| row.get(&amp;c.name).cloned().unwrap_or(Value::Null)).collect()
</a>     }
 
<a href="#h59-1-26" id="h59-1-26" class="d">-    /// Validates the schema
</a><a href="#h59-1-27" id="h59-1-27" class="i">+    /// Returns the row as a hashmap keyed by column name, padding the row with nulls if needed
</a><a href="#h59-1-28" id="h59-1-28" class="i">+    pub fn row_to_hashmap(&amp;self, row: Row) -&gt; HashMap&lt;String, Value&gt; {
</a><a href="#h59-1-29" id="h59-1-29" class="i">+        self.columns
</a><a href="#h59-1-30" id="h59-1-30" class="i">+            .iter()
</a><a href="#h59-1-31" id="h59-1-31" class="i">+            .map(|c| c.name.clone())
</a><a href="#h59-1-32" id="h59-1-32" class="i">+            .zip(row.into_iter().chain(std::iter::repeat(Value::Null)))
</a><a href="#h59-1-33" id="h59-1-33" class="i">+            .collect()
</a><a href="#h59-1-34" id="h59-1-34" class="i">+    }
</a><a href="#h59-1-35" id="h59-1-35" class="i">+
</a><a href="#h59-1-36" id="h59-1-36" class="i">+    /// Returns the primary key value of a row
</a><a href="#h59-1-37" id="h59-1-37" class="i">+    pub fn row_key(&amp;self, row: &amp;[Value]) -&gt; Result&lt;Value, Error&gt; {
</a><a href="#h59-1-38" id="h59-1-38" class="i">+        // FIXME This should be indexed
</a><a href="#h59-1-39" id="h59-1-39" class="i">+        row.get(self.columns.iter().position(|c| c.primary_key).expect(&quot;Primary key not found&quot;))
</a><a href="#h59-1-40" id="h59-1-40" class="i">+            .cloned()
</a><a href="#h59-1-41" id="h59-1-41" class="i">+            .ok_or_else(|| Error::Value(&quot;Primary key value not found for row&quot;.into()))
</a><a href="#h59-1-42" id="h59-1-42" class="i">+    }
</a><a href="#h59-1-43" id="h59-1-43" class="i">+
</a><a href="#h59-1-44" id="h59-1-44" class="i">+    /// Validates the table schema
</a>     pub fn validate(&amp;self) -&gt; Result&lt;(), Error&gt; {
         if self.columns.is_empty() {
<a href="#h59-1-47" id="h59-1-47" class="d">-            return Err(Error::Value(&quot;Table has no columns&quot;.into()));
</a><a href="#h59-1-48" id="h59-1-48" class="i">+            return Err(Error::Value(format!(&quot;Table {} has no columns&quot;, self.name)));
</a>         }
<a href="#h59-1-50" id="h59-1-50" class="d">-        let pk = self
</a><a href="#h59-1-51" id="h59-1-51" class="d">-            .columns
</a><a href="#h59-1-52" id="h59-1-52" class="d">-            .get(self.primary_key)
</a><a href="#h59-1-53" id="h59-1-53" class="d">-            .ok_or_else(|| Error::Value(&quot;Primary key column does not exist&quot;.into()))?;
</a><a href="#h59-1-54" id="h59-1-54" class="d">-        if pk.nullable {
</a><a href="#h59-1-55" id="h59-1-55" class="d">-            return Err(Error::Value(format!(&quot;Primary key column {} cannot be nullable&quot;, pk.name)));
</a><a href="#h59-1-56" id="h59-1-56" class="i">+        match self.columns.iter().filter(|c| c.primary_key).count() {
</a><a href="#h59-1-57" id="h59-1-57" class="i">+            1 =&gt; {}
</a><a href="#h59-1-58" id="h59-1-58" class="i">+            0 =&gt; return Err(Error::Value(format!(&quot;No primary key in table {}&quot;, self.name))),
</a><a href="#h59-1-59" id="h59-1-59" class="i">+            _ =&gt; return Err(Error::Value(format!(&quot;Multiple primary keys in table {}&quot;, self.name))),
</a><a href="#h59-1-60" id="h59-1-60" class="i">+        };
</a><a href="#h59-1-61" id="h59-1-61" class="i">+        for column in &amp;self.columns {
</a><a href="#h59-1-62" id="h59-1-62" class="i">+            column.validate()?;
</a>         }
         Ok(())
     }
<a href="#h59-2" id="h59-2" class="h">@@ -89,12 +110,7 @@ impl Table {
</a>     /// Validates a row
     pub fn validate_row(&amp;self, row: &amp;[Value]) -&gt; Result&lt;(), Error&gt; {
         if row.len() != self.columns.len() {
<a href="#h59-2-3" id="h59-2-3" class="d">-            return Err(Error::Value(format!(
</a><a href="#h59-2-4" id="h59-2-4" class="d">-                &quot;Invalid row size {} for table {}, expected {}&quot;,
</a><a href="#h59-2-5" id="h59-2-5" class="d">-                row.len(),
</a><a href="#h59-2-6" id="h59-2-6" class="d">-                self.name,
</a><a href="#h59-2-7" id="h59-2-7" class="d">-                self.columns.len()
</a><a href="#h59-2-8" id="h59-2-8" class="d">-            )));
</a><a href="#h59-2-9" id="h59-2-9" class="i">+            return Err(Error::Value(format!(&quot;Invalid row size for table {}&quot;, self.name)));
</a>         }
         for (column, value) in self.columns.iter().zip(row.iter()) {
             column.validate_value(value)?;
<a href="#h59-3" id="h59-3" class="h">@@ -110,11 +126,68 @@ pub struct Column {
</a>     pub name: String,
     /// Column datatype
     pub datatype: DataType,
<a href="#h59-3-3" id="h59-3-3" class="i">+    /// Whether the column is a primary key
</a><a href="#h59-3-4" id="h59-3-4" class="i">+    pub primary_key: bool,
</a>     /// Whether the column allows null values
     pub nullable: bool,
<a href="#h59-3-7" id="h59-3-7" class="i">+    /// The default value of the column
</a><a href="#h59-3-8" id="h59-3-8" class="i">+    pub default: Option&lt;Value&gt;,
</a><a href="#h59-3-9" id="h59-3-9" class="i">+    /// Whether the column should only take unique values
</a><a href="#h59-3-10" id="h59-3-10" class="i">+    pub unique: bool,
</a><a href="#h59-3-11" id="h59-3-11" class="i">+    /// The table which is referenced by this foreign key
</a><a href="#h59-3-12" id="h59-3-12" class="i">+    pub references: Option&lt;String&gt;,
</a> }
 
 impl Column {
<a href="#h59-3-16" id="h59-3-16" class="i">+    /// Generates SQL DDL for the column
</a><a href="#h59-3-17" id="h59-3-17" class="i">+    pub fn as_sql(&amp;self) -&gt; String {
</a><a href="#h59-3-18" id="h59-3-18" class="i">+        let mut sql = format!(&quot;{} {}&quot;, self.name, self.datatype);
</a><a href="#h59-3-19" id="h59-3-19" class="i">+        if self.primary_key {
</a><a href="#h59-3-20" id="h59-3-20" class="i">+            sql += &quot; PRIMARY KEY&quot;;
</a><a href="#h59-3-21" id="h59-3-21" class="i">+        }
</a><a href="#h59-3-22" id="h59-3-22" class="i">+        if !self.nullable {
</a><a href="#h59-3-23" id="h59-3-23" class="i">+            sql += &quot; NOT NULL&quot;;
</a><a href="#h59-3-24" id="h59-3-24" class="i">+        }
</a><a href="#h59-3-25" id="h59-3-25" class="i">+        if let Some(default) = &amp;self.default {
</a><a href="#h59-3-26" id="h59-3-26" class="i">+            sql += &amp;format!(&quot; DEFAULT {}&quot;, default);
</a><a href="#h59-3-27" id="h59-3-27" class="i">+        }
</a><a href="#h59-3-28" id="h59-3-28" class="i">+        if self.unique {
</a><a href="#h59-3-29" id="h59-3-29" class="i">+            sql += &quot; UNIQUE&quot;;
</a><a href="#h59-3-30" id="h59-3-30" class="i">+        }
</a><a href="#h59-3-31" id="h59-3-31" class="i">+        if let Some(reference) = &amp;self.references {
</a><a href="#h59-3-32" id="h59-3-32" class="i">+            sql += &amp;format!(&quot; REFERENCES {}&quot;, reference);
</a><a href="#h59-3-33" id="h59-3-33" class="i">+        }
</a><a href="#h59-3-34" id="h59-3-34" class="i">+        sql
</a><a href="#h59-3-35" id="h59-3-35" class="i">+    }
</a><a href="#h59-3-36" id="h59-3-36" class="i">+
</a><a href="#h59-3-37" id="h59-3-37" class="i">+    /// Validates the column schema
</a><a href="#h59-3-38" id="h59-3-38" class="i">+    pub fn validate(&amp;self) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h59-3-39" id="h59-3-39" class="i">+        if self.primary_key &amp;&amp; self.nullable {
</a><a href="#h59-3-40" id="h59-3-40" class="i">+            return Err(Error::Value(format!(&quot;Primary key {} cannot be nullable&quot;, self.name)));
</a><a href="#h59-3-41" id="h59-3-41" class="i">+        }
</a><a href="#h59-3-42" id="h59-3-42" class="i">+        if let Some(default) = &amp;self.default {
</a><a href="#h59-3-43" id="h59-3-43" class="i">+            if let Some(datatype) = default.datatype() {
</a><a href="#h59-3-44" id="h59-3-44" class="i">+                if datatype != self.datatype {
</a><a href="#h59-3-45" id="h59-3-45" class="i">+                    return Err(Error::Value(format!(
</a><a href="#h59-3-46" id="h59-3-46" class="i">+                        &quot;Default value for column {} has datatype {}, must be {}&quot;,
</a><a href="#h59-3-47" id="h59-3-47" class="i">+                        self.name, datatype, self.datatype
</a><a href="#h59-3-48" id="h59-3-48" class="i">+                    )));
</a><a href="#h59-3-49" id="h59-3-49" class="i">+                }
</a><a href="#h59-3-50" id="h59-3-50" class="i">+            } else if !self.nullable {
</a><a href="#h59-3-51" id="h59-3-51" class="i">+                return Err(Error::Value(format!(
</a><a href="#h59-3-52" id="h59-3-52" class="i">+                    &quot;Can&#39;t use NULL as default value for non-nullable column {}&quot;,
</a><a href="#h59-3-53" id="h59-3-53" class="i">+                    self.name
</a><a href="#h59-3-54" id="h59-3-54" class="i">+                )));
</a><a href="#h59-3-55" id="h59-3-55" class="i">+            }
</a><a href="#h59-3-56" id="h59-3-56" class="i">+        } else if self.nullable {
</a><a href="#h59-3-57" id="h59-3-57" class="i">+            return Err(Error::Value(format!(
</a><a href="#h59-3-58" id="h59-3-58" class="i">+                &quot;Nullable column {} must have a default value&quot;,
</a><a href="#h59-3-59" id="h59-3-59" class="i">+                self.name
</a><a href="#h59-3-60" id="h59-3-60" class="i">+            )));
</a><a href="#h59-3-61" id="h59-3-61" class="i">+        }
</a><a href="#h59-3-62" id="h59-3-62" class="i">+        Ok(())
</a><a href="#h59-3-63" id="h59-3-63" class="i">+    }
</a><a href="#h59-3-64" id="h59-3-64" class="i">+
</a>     /// Validates a column value
     pub fn validate_value(&amp;self, value: &amp;Value) -&gt; Result&lt;(), Error&gt; {
         match value.datatype() {
</pre>
</div>
</body>
</html>
