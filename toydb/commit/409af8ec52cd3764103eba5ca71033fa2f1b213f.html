<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: improve explain output (fixes #8) - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/409af8ec52cd3764103eba5ca71033fa2f1b213f.html">409af8ec52cd3764103eba5ca71033fa2f1b213f</a>
<b>parent</b> <a href="../commit/1c64b33ab5660a94cf1a35cad9c8625d309dbf04.html">1c64b33ab5660a94cf1a35cad9c8625d309dbf04</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Wed,  3 Jun 2020 21:38:26 +0200

sql: improve explain output (fixes #8)

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/bin/toysql.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/plan/mod.rs</a></td><td> | </td><td class="num">176</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">39</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/types/expression.rs</a></td><td> | </td><td class="num">34</td><td><span class="i">++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">tests/sql/query.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">tests/sql/query/agg_boolean</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">tests/sql/query/agg_boolean_null</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">tests/sql/query/agg_const</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">tests/sql/query/agg_const_from</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">tests/sql/query/agg_count_star</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">tests/sql/query/agg_expr</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">tests/sql/query/agg_float</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query/agg_float_null</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/query/agg_integer</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/agg_integer_null</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/agg_string</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/agg_string_null</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/all</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/as_</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/as_duplicate</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/expr_mixed</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/expr_static</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/field_aliased</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/field_multi</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/field_qualified</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/field_qualified_multi</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/field_single</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/from_multiple</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/group_expr</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/group_expr_aggr</a></td><td> | </td><td class="num">43</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/group_expr_aggr_selfref</a></td><td> | </td><td class="num">43</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/group_expr_aliased</a></td><td> | </td><td class="num">35</td><td><span class="i">+++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/query/group_expr_both</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/query/group_expr_multigroup</a></td><td> | </td><td class="num">35</td><td><span class="i">+++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/query/group_expr_select</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/query/group_join</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">tests/sql/query/group_noaggregate</a></td><td> | </td><td class="num">43</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">tests/sql/query/group_noselect</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">tests/sql/query/group_simple</a></td><td> | </td><td class="num">43</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">tests/sql/query/having</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">81</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">tests/sql/query/having_nogroup</a></td><td> | </td><td class="num">43</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">tests/sql/query/join_cross</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">tests/sql/query/join_cross_multi</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">tests/sql/query/join_inner</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">tests/sql/query/join_inner_implicit</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">tests/sql/query/join_inner_index_transverse</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">tests/sql/query/join_inner_index_transverse_where</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">tests/sql/query/join_inner_multi</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">28</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">tests/sql/query/join_inner_on_aliased</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">tests/sql/query/join_inner_on_false</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">tests/sql/query/join_inner_on_multi</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">tests/sql/query/join_inner_on_true</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">tests/sql/query/join_inner_on_where</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">tests/sql/query/join_left</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">tests/sql/query/join_left_outer</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">tests/sql/query/join_left_truncate</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">tests/sql/query/join_right</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">tests/sql/query/join_right_outer</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">tests/sql/query/join_right_truncate</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">tests/sql/query/limit</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">tests/sql/query/limit_expr</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">tests/sql/query/limit_large</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">tests/sql/query/limit_offset</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">tests/sql/query/limit_zero</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">tests/sql/query/lowercase</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">tests/sql/query/offset</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">tests/sql/query/offset_expr</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">tests/sql/query/offset_large</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">tests/sql/query/offset_zero</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h77">tests/sql/query/order</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h78">tests/sql/query/order_aggregate</a></td><td> | </td><td class="num">25</td><td><span class="i">+++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h79">tests/sql/query/order_aggregate_noselect</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h80">tests/sql/query/order_asc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h81">tests/sql/query/order_asc_lowercase</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h82">tests/sql/query/order_boolean_asc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h83">tests/sql/query/order_boolean_desc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h84">tests/sql/query/order_desc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h85">tests/sql/query/order_desc_lowercase</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h86">tests/sql/query/order_expr</a></td><td> | </td><td class="num">19</td><td><span class="i">+++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h87">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">39</td><td><span class="i">+++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h88">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h89">tests/sql/query/order_float_asc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h90">tests/sql/query/order_float_desc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h91">tests/sql/query/order_group_by_noselect</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h92">tests/sql/query/order_integer_asc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h93">tests/sql/query/order_integer_desc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h94">tests/sql/query/order_multi</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h95">tests/sql/query/order_noselect</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h96">tests/sql/query/order_string_asc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h97">tests/sql/query/order_string_desc</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h98">tests/sql/query/where_expr</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h99">tests/sql/query/where_false</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h100">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h101">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h102">tests/sql/query/where_float</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h103">tests/sql/query/where_index</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h104">tests/sql/query/where_index_or</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h105">tests/sql/query/where_index_or_partial</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h106">tests/sql/query/where_integer</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h107">tests/sql/query/where_join_inner</a></td><td> | </td><td class="num">5</td><td><span class="i">+++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h108">tests/sql/query/where_null</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h109">tests/sql/query/where_pk</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h110">tests/sql/query/where_pk_or</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h111">tests/sql/query/where_pk_or_partial</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h112">tests/sql/query/where_string</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h113">tests/sql/query/where_true</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
</table></pre><pre>114 files changed, 1494 insertions(+), 99 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/bin/toysql.rs.html">src/bin/toysql.rs</a> b/<a href="../file/src/bin/toysql.rs.html">src/bin/toysql.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -183,7 +183,7 @@ SQL txns:  {txns_active} active, {txns} total ({sql_storage} storage)
</a>             ResultSet::Update { count } =&gt; println!(&quot;Updated {} rows&quot;, count),
             ResultSet::CreateTable { name } =&gt; println!(&quot;Created table {}&quot;, name),
             ResultSet::DropTable { name } =&gt; println!(&quot;Dropped table {}&quot;, name),
<a href="#h0-0-3" id="h0-0-3" class="d">-            ResultSet::Explain(plan) =&gt; println!(&quot;{:#?}&quot;, plan),
</a><a href="#h0-0-4" id="h0-0-4" class="i">+            ResultSet::Explain(plan) =&gt; println!(&quot;{}&quot;, plan.to_string()),
</a>             ResultSet::Query { columns, mut rows } =&gt; {
                 if self.show_headers {
                     println!(
<b>diff --git a/<a id="h1" href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a> b/<a href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -12,11 +12,18 @@ use crate::error::Result;
</a> 
 use serde_derive::{Deserialize, Serialize};
 use std::collections::BTreeMap;
<a href="#h1-0-3" id="h1-0-3" class="i">+use std::fmt::{self, Display};
</a> 
 /// A query plan
 #[derive(Debug)]
 pub struct Plan(pub Node);
 
<a href="#h1-0-9" id="h1-0-9" class="i">+impl Display for Plan {
</a><a href="#h1-0-10" id="h1-0-10" class="i">+    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;&#39;_&gt;) -&gt; fmt::Result {
</a><a href="#h1-0-11" id="h1-0-11" class="i">+        write!(f, &quot;{}&quot;, self.0.to_string())
</a><a href="#h1-0-12" id="h1-0-12" class="i">+    }
</a><a href="#h1-0-13" id="h1-0-13" class="i">+}
</a><a href="#h1-0-14" id="h1-0-14" class="i">+
</a> impl Plan {
     /// Builds a plan from an AST statement.
     pub fn build&lt;C: Catalog&gt;(statement: ast::Statement, catalog: &amp;mut C) -&gt; Result&lt;Self&gt; {
<a href="#h1-1" id="h1-1" class="h">@@ -226,6 +233,146 @@ impl Node {
</a>             },
         })
     }
<a href="#h1-1-3" id="h1-1-3" class="i">+
</a><a href="#h1-1-4" id="h1-1-4" class="i">+    // Displays the node, where prefix gives the node prefix.
</a><a href="#h1-1-5" id="h1-1-5" class="i">+    pub fn format(&amp;self, mut indent: String, root: bool, last: bool) -&gt; String {
</a><a href="#h1-1-6" id="h1-1-6" class="i">+        let mut s = indent.clone();
</a><a href="#h1-1-7" id="h1-1-7" class="i">+        if !last {
</a><a href="#h1-1-8" id="h1-1-8" class="i">+            s += &quot;├─ &quot;;
</a><a href="#h1-1-9" id="h1-1-9" class="i">+            indent += &quot;│  &quot;
</a><a href="#h1-1-10" id="h1-1-10" class="i">+        } else if !root {
</a><a href="#h1-1-11" id="h1-1-11" class="i">+            s += &quot;└─ &quot;;
</a><a href="#h1-1-12" id="h1-1-12" class="i">+            indent += &quot;   &quot;;
</a><a href="#h1-1-13" id="h1-1-13" class="i">+        }
</a><a href="#h1-1-14" id="h1-1-14" class="i">+        match self {
</a><a href="#h1-1-15" id="h1-1-15" class="i">+            Self::Aggregation { source, aggregates } =&gt; {
</a><a href="#h1-1-16" id="h1-1-16" class="i">+                s += &amp;format!(
</a><a href="#h1-1-17" id="h1-1-17" class="i">+                    &quot;Aggregation: {}\n&quot;,
</a><a href="#h1-1-18" id="h1-1-18" class="i">+                    aggregates.iter().map(|a| a.to_string()).collect::&lt;Vec&lt;_&gt;&gt;().join(&quot;, &quot;)
</a><a href="#h1-1-19" id="h1-1-19" class="i">+                );
</a><a href="#h1-1-20" id="h1-1-20" class="i">+                s += &amp;source.format(indent, false, true);
</a><a href="#h1-1-21" id="h1-1-21" class="i">+            }
</a><a href="#h1-1-22" id="h1-1-22" class="i">+            Self::CreateTable { schema } =&gt; {
</a><a href="#h1-1-23" id="h1-1-23" class="i">+                s += &amp;format!(&quot;CreateTable: {}\n&quot;, schema.name);
</a><a href="#h1-1-24" id="h1-1-24" class="i">+            }
</a><a href="#h1-1-25" id="h1-1-25" class="i">+            Self::Delete { source, table } =&gt; {
</a><a href="#h1-1-26" id="h1-1-26" class="i">+                s += &amp;format!(&quot;Delete: {}\n&quot;, table);
</a><a href="#h1-1-27" id="h1-1-27" class="i">+                s += &amp;source.format(indent, false, true);
</a><a href="#h1-1-28" id="h1-1-28" class="i">+            }
</a><a href="#h1-1-29" id="h1-1-29" class="i">+            Self::DropTable { table } =&gt; {
</a><a href="#h1-1-30" id="h1-1-30" class="i">+                s += &amp;format!(&quot;DropTable: {}\n&quot;, table);
</a><a href="#h1-1-31" id="h1-1-31" class="i">+            }
</a><a href="#h1-1-32" id="h1-1-32" class="i">+            Self::Filter { source, predicate } =&gt; {
</a><a href="#h1-1-33" id="h1-1-33" class="i">+                s += &amp;format!(&quot;Filter: {}\n&quot;, predicate);
</a><a href="#h1-1-34" id="h1-1-34" class="i">+                s += &amp;source.format(indent, false, true);
</a><a href="#h1-1-35" id="h1-1-35" class="i">+            }
</a><a href="#h1-1-36" id="h1-1-36" class="i">+            Self::IndexLookup { table, column, alias: _, values } =&gt; {
</a><a href="#h1-1-37" id="h1-1-37" class="i">+                s += &amp;format!(&quot;IndexLookup: {}.{}&quot;, table, column);
</a><a href="#h1-1-38" id="h1-1-38" class="i">+                if !values.is_empty() &amp;&amp; values.len() &lt; 10 {
</a><a href="#h1-1-39" id="h1-1-39" class="i">+                    s += &amp;format!(
</a><a href="#h1-1-40" id="h1-1-40" class="i">+                        &quot; ({})&quot;,
</a><a href="#h1-1-41" id="h1-1-41" class="i">+                        values.iter().map(|k| k.to_string()).collect::&lt;Vec&lt;_&gt;&gt;().join(&quot;, &quot;)
</a><a href="#h1-1-42" id="h1-1-42" class="i">+                    );
</a><a href="#h1-1-43" id="h1-1-43" class="i">+                } else {
</a><a href="#h1-1-44" id="h1-1-44" class="i">+                    s += &amp;format!(&quot; ({} values)&quot;, values.len());
</a><a href="#h1-1-45" id="h1-1-45" class="i">+                }
</a><a href="#h1-1-46" id="h1-1-46" class="i">+                s += &quot;\n&quot;;
</a><a href="#h1-1-47" id="h1-1-47" class="i">+            }
</a><a href="#h1-1-48" id="h1-1-48" class="i">+            Self::Insert { table, columns: _, expressions } =&gt; {
</a><a href="#h1-1-49" id="h1-1-49" class="i">+                s += &amp;format!(&quot;Insert: {} ({} rows)\n&quot;, table, expressions.len());
</a><a href="#h1-1-50" id="h1-1-50" class="i">+            }
</a><a href="#h1-1-51" id="h1-1-51" class="i">+            Self::KeyLookup { table, alias: _, keys } =&gt; {
</a><a href="#h1-1-52" id="h1-1-52" class="i">+                s += &amp;format!(&quot;KeyLookup: {}&quot;, table);
</a><a href="#h1-1-53" id="h1-1-53" class="i">+                if !keys.is_empty() &amp;&amp; keys.len() &lt; 10 {
</a><a href="#h1-1-54" id="h1-1-54" class="i">+                    s += &amp;format!(
</a><a href="#h1-1-55" id="h1-1-55" class="i">+                        &quot; ({})&quot;,
</a><a href="#h1-1-56" id="h1-1-56" class="i">+                        keys.iter().map(|k| k.to_string()).collect::&lt;Vec&lt;_&gt;&gt;().join(&quot;, &quot;)
</a><a href="#h1-1-57" id="h1-1-57" class="i">+                    );
</a><a href="#h1-1-58" id="h1-1-58" class="i">+                } else {
</a><a href="#h1-1-59" id="h1-1-59" class="i">+                    s += &amp;format!(&quot; ({} keys)&quot;, keys.len());
</a><a href="#h1-1-60" id="h1-1-60" class="i">+                }
</a><a href="#h1-1-61" id="h1-1-61" class="i">+                s += &quot;\n&quot;;
</a><a href="#h1-1-62" id="h1-1-62" class="i">+            }
</a><a href="#h1-1-63" id="h1-1-63" class="i">+            Self::Limit { source, limit } =&gt; {
</a><a href="#h1-1-64" id="h1-1-64" class="i">+                s += &amp;format!(&quot;Limit: {}\n&quot;, limit);
</a><a href="#h1-1-65" id="h1-1-65" class="i">+                s += &amp;source.format(indent, false, true);
</a><a href="#h1-1-66" id="h1-1-66" class="i">+            }
</a><a href="#h1-1-67" id="h1-1-67" class="i">+            Self::NestedLoopJoin { outer, outer_size: _, inner, predicate, pad, flip } =&gt; {
</a><a href="#h1-1-68" id="h1-1-68" class="i">+                s += &quot;NestedLoopJoin:&quot;;
</a><a href="#h1-1-69" id="h1-1-69" class="i">+                if !pad {
</a><a href="#h1-1-70" id="h1-1-70" class="i">+                    s += &quot; inner&quot;;
</a><a href="#h1-1-71" id="h1-1-71" class="i">+                } else if !flip {
</a><a href="#h1-1-72" id="h1-1-72" class="i">+                    s += &quot; left outer&quot;;
</a><a href="#h1-1-73" id="h1-1-73" class="i">+                } else if *flip {
</a><a href="#h1-1-74" id="h1-1-74" class="i">+                    s += &quot; right outer&quot;;
</a><a href="#h1-1-75" id="h1-1-75" class="i">+                };
</a><a href="#h1-1-76" id="h1-1-76" class="i">+                if let Some(expr) = predicate {
</a><a href="#h1-1-77" id="h1-1-77" class="i">+                    s += &amp;format!(&quot; on {}&quot;, expr);
</a><a href="#h1-1-78" id="h1-1-78" class="i">+                }
</a><a href="#h1-1-79" id="h1-1-79" class="i">+                s += &quot;\n&quot;;
</a><a href="#h1-1-80" id="h1-1-80" class="i">+                s += &amp;outer.format(indent.clone(), false, false);
</a><a href="#h1-1-81" id="h1-1-81" class="i">+                s += &amp;inner.format(indent, false, true);
</a><a href="#h1-1-82" id="h1-1-82" class="i">+            }
</a><a href="#h1-1-83" id="h1-1-83" class="i">+            Self::Nothing {} =&gt; {
</a><a href="#h1-1-84" id="h1-1-84" class="i">+                s += &quot;Nothing\n&quot;;
</a><a href="#h1-1-85" id="h1-1-85" class="i">+            }
</a><a href="#h1-1-86" id="h1-1-86" class="i">+            Self::Offset { source, offset } =&gt; {
</a><a href="#h1-1-87" id="h1-1-87" class="i">+                s += &amp;format!(&quot;Offset: {}\n&quot;, offset);
</a><a href="#h1-1-88" id="h1-1-88" class="i">+                s += &amp;source.format(indent, false, true);
</a><a href="#h1-1-89" id="h1-1-89" class="i">+            }
</a><a href="#h1-1-90" id="h1-1-90" class="i">+            Self::Order { source, orders } =&gt; {
</a><a href="#h1-1-91" id="h1-1-91" class="i">+                s += &amp;format!(
</a><a href="#h1-1-92" id="h1-1-92" class="i">+                    &quot;Order: {}\n&quot;,
</a><a href="#h1-1-93" id="h1-1-93" class="i">+                    orders
</a><a href="#h1-1-94" id="h1-1-94" class="i">+                        .iter()
</a><a href="#h1-1-95" id="h1-1-95" class="i">+                        .map(|(expr, dir)| format!(&quot;{} {}&quot;, expr, dir))
</a><a href="#h1-1-96" id="h1-1-96" class="i">+                        .collect::&lt;Vec&lt;_&gt;&gt;()
</a><a href="#h1-1-97" id="h1-1-97" class="i">+                        .join(&quot;, &quot;)
</a><a href="#h1-1-98" id="h1-1-98" class="i">+                );
</a><a href="#h1-1-99" id="h1-1-99" class="i">+                s += &amp;source.format(indent, false, true);
</a><a href="#h1-1-100" id="h1-1-100" class="i">+            }
</a><a href="#h1-1-101" id="h1-1-101" class="i">+            Self::Projection { source, expressions } =&gt; {
</a><a href="#h1-1-102" id="h1-1-102" class="i">+                s += &amp;format!(
</a><a href="#h1-1-103" id="h1-1-103" class="i">+                    &quot;Projection: {}\n&quot;,
</a><a href="#h1-1-104" id="h1-1-104" class="i">+                    expressions
</a><a href="#h1-1-105" id="h1-1-105" class="i">+                        .iter()
</a><a href="#h1-1-106" id="h1-1-106" class="i">+                        .map(|(expr, _)| expr.to_string())
</a><a href="#h1-1-107" id="h1-1-107" class="i">+                        .collect::&lt;Vec&lt;_&gt;&gt;()
</a><a href="#h1-1-108" id="h1-1-108" class="i">+                        .join(&quot;, &quot;)
</a><a href="#h1-1-109" id="h1-1-109" class="i">+                );
</a><a href="#h1-1-110" id="h1-1-110" class="i">+                s += &amp;source.format(indent, false, true);
</a><a href="#h1-1-111" id="h1-1-111" class="i">+            }
</a><a href="#h1-1-112" id="h1-1-112" class="i">+            Self::Scan { table, alias: _, filter } =&gt; {
</a><a href="#h1-1-113" id="h1-1-113" class="i">+                s += &amp;format!(&quot;Scan: {}&quot;, table);
</a><a href="#h1-1-114" id="h1-1-114" class="i">+                if let Some(expr) = filter {
</a><a href="#h1-1-115" id="h1-1-115" class="i">+                    s += &amp;format!(&quot; ({})&quot;, expr);
</a><a href="#h1-1-116" id="h1-1-116" class="i">+                }
</a><a href="#h1-1-117" id="h1-1-117" class="i">+                s += &quot;\n&quot;;
</a><a href="#h1-1-118" id="h1-1-118" class="i">+            }
</a><a href="#h1-1-119" id="h1-1-119" class="i">+            Self::Update { source, table, expressions } =&gt; {
</a><a href="#h1-1-120" id="h1-1-120" class="i">+                s += &amp;format!(
</a><a href="#h1-1-121" id="h1-1-121" class="i">+                    &quot;Update: {} ({})\n&quot;,
</a><a href="#h1-1-122" id="h1-1-122" class="i">+                    table,
</a><a href="#h1-1-123" id="h1-1-123" class="i">+                    expressions
</a><a href="#h1-1-124" id="h1-1-124" class="i">+                        .iter()
</a><a href="#h1-1-125" id="h1-1-125" class="i">+                        .map(|(l, e)| format!(&quot;{}={}&quot;, l, e))
</a><a href="#h1-1-126" id="h1-1-126" class="i">+                        .collect::&lt;Vec&lt;_&gt;&gt;()
</a><a href="#h1-1-127" id="h1-1-127" class="i">+                        .join(&quot;,&quot;)
</a><a href="#h1-1-128" id="h1-1-128" class="i">+                );
</a><a href="#h1-1-129" id="h1-1-129" class="i">+                s += &amp;source.format(indent, false, true);
</a><a href="#h1-1-130" id="h1-1-130" class="i">+            }
</a><a href="#h1-1-131" id="h1-1-131" class="i">+        };
</a><a href="#h1-1-132" id="h1-1-132" class="i">+        if root {
</a><a href="#h1-1-133" id="h1-1-133" class="i">+            s = s.trim_end().to_string()
</a><a href="#h1-1-134" id="h1-1-134" class="i">+        }
</a><a href="#h1-1-135" id="h1-1-135" class="i">+        s
</a><a href="#h1-1-136" id="h1-1-136" class="i">+    }
</a><a href="#h1-1-137" id="h1-1-137" class="i">+}
</a><a href="#h1-1-138" id="h1-1-138" class="i">+
</a><a href="#h1-1-139" id="h1-1-139" class="i">+impl Display for Node {
</a><a href="#h1-1-140" id="h1-1-140" class="i">+    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;&#39;_&gt;) -&gt; fmt::Result {
</a><a href="#h1-1-141" id="h1-1-141" class="i">+        write!(f, &quot;{}&quot;, self.format(&quot;&quot;.into(), true, true))
</a><a href="#h1-1-142" id="h1-1-142" class="i">+    }
</a> }
 
 /// An aggregate operation
<a href="#h1-2" id="h1-2" class="h">@@ -238,6 +385,22 @@ pub enum Aggregate {
</a>     Sum,
 }
 
<a href="#h1-2-3" id="h1-2-3" class="i">+impl Display for Aggregate {
</a><a href="#h1-2-4" id="h1-2-4" class="i">+    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;&#39;_&gt;) -&gt; fmt::Result {
</a><a href="#h1-2-5" id="h1-2-5" class="i">+        write!(
</a><a href="#h1-2-6" id="h1-2-6" class="i">+            f,
</a><a href="#h1-2-7" id="h1-2-7" class="i">+            &quot;{}&quot;,
</a><a href="#h1-2-8" id="h1-2-8" class="i">+            match self {
</a><a href="#h1-2-9" id="h1-2-9" class="i">+                Self::Average =&gt; &quot;average&quot;,
</a><a href="#h1-2-10" id="h1-2-10" class="i">+                Self::Count =&gt; &quot;count&quot;,
</a><a href="#h1-2-11" id="h1-2-11" class="i">+                Self::Max =&gt; &quot;maximum&quot;,
</a><a href="#h1-2-12" id="h1-2-12" class="i">+                Self::Min =&gt; &quot;minimum&quot;,
</a><a href="#h1-2-13" id="h1-2-13" class="i">+                Self::Sum =&gt; &quot;sum&quot;,
</a><a href="#h1-2-14" id="h1-2-14" class="i">+            }
</a><a href="#h1-2-15" id="h1-2-15" class="i">+        )
</a><a href="#h1-2-16" id="h1-2-16" class="i">+    }
</a><a href="#h1-2-17" id="h1-2-17" class="i">+}
</a><a href="#h1-2-18" id="h1-2-18" class="i">+
</a> pub type Aggregates = Vec&lt;Aggregate&gt;;
 
 /// A sort order direction
<a href="#h1-3" id="h1-3" class="h">@@ -246,3 +409,16 @@ pub enum Direction {
</a>     Ascending,
     Descending,
 }
<a href="#h1-3-3" id="h1-3-3" class="i">+
</a><a href="#h1-3-4" id="h1-3-4" class="i">+impl Display for Direction {
</a><a href="#h1-3-5" id="h1-3-5" class="i">+    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;&#39;_&gt;) -&gt; fmt::Result {
</a><a href="#h1-3-6" id="h1-3-6" class="i">+        write!(
</a><a href="#h1-3-7" id="h1-3-7" class="i">+            f,
</a><a href="#h1-3-8" id="h1-3-8" class="i">+            &quot;{}&quot;,
</a><a href="#h1-3-9" id="h1-3-9" class="i">+            match self {
</a><a href="#h1-3-10" id="h1-3-10" class="i">+                Self::Ascending =&gt; &quot;asc&quot;,
</a><a href="#h1-3-11" id="h1-3-11" class="i">+                Self::Descending =&gt; &quot;desc&quot;,
</a><a href="#h1-3-12" id="h1-3-12" class="i">+            }
</a><a href="#h1-3-13" id="h1-3-13" class="i">+        )
</a><a href="#h1-3-14" id="h1-3-14" class="i">+    }
</a><a href="#h1-3-15" id="h1-3-15" class="i">+}
</a><b>diff --git a/<a id="h2" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -332,9 +332,22 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         for (expr, label) in groups {
             expressions.push((self.build_expression(scope, expr)?, label));
         }
<a href="#h2-0-3" id="h2-0-3" class="d">-        // FIXME This is probably wrong for the aggregate columns, since we don&#39;t want to inherit
</a><a href="#h2-0-4" id="h2-0-4" class="d">-        // from them if they are simple field references.
</a><a href="#h2-0-5" id="h2-0-5" class="d">-        scope.project(&amp;expressions)?;
</a><a href="#h2-0-6" id="h2-0-6" class="i">+        scope.project(
</a><a href="#h2-0-7" id="h2-0-7" class="i">+            &amp;expressions
</a><a href="#h2-0-8" id="h2-0-8" class="i">+                .iter()
</a><a href="#h2-0-9" id="h2-0-9" class="i">+                .cloned()
</a><a href="#h2-0-10" id="h2-0-10" class="i">+                .enumerate()
</a><a href="#h2-0-11" id="h2-0-11" class="i">+                .map(|(i, (e, l))| {
</a><a href="#h2-0-12" id="h2-0-12" class="i">+                    if i &lt; aggregates.len() {
</a><a href="#h2-0-13" id="h2-0-13" class="i">+                        // We pass null values here since we don&#39;t want field references to hit
</a><a href="#h2-0-14" id="h2-0-14" class="i">+                        // the fields in scope before the aggregation.
</a><a href="#h2-0-15" id="h2-0-15" class="i">+                        (Expression::Constant(Value::Null), None)
</a><a href="#h2-0-16" id="h2-0-16" class="i">+                    } else {
</a><a href="#h2-0-17" id="h2-0-17" class="i">+                        (e, l)
</a><a href="#h2-0-18" id="h2-0-18" class="i">+                    }
</a><a href="#h2-0-19" id="h2-0-19" class="i">+                })
</a><a href="#h2-0-20" id="h2-0-20" class="i">+                .collect::&lt;Vec&lt;_&gt;&gt;(),
</a><a href="#h2-0-21" id="h2-0-21" class="i">+        )?;
</a>         let node = Node::Aggregation {
             source: Box::new(Node::Projection { source: Box::new(source), expressions }),
             aggregates,
<a href="#h2-1" id="h2-1" class="h">@@ -508,7 +521,13 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 ast::Literal::Float(f) =&gt; Value::Float(f),
                 ast::Literal::String(s) =&gt; Value::String(s),
             }),
<a href="#h2-1-3" id="h2-1-3" class="d">-            ast::Expression::Column(i) =&gt; Field(scope.assert(i)?, None),
</a><a href="#h2-1-4" id="h2-1-4" class="i">+            ast::Expression::Column(i) =&gt; {
</a><a href="#h2-1-5" id="h2-1-5" class="i">+                let label = match scope.get_column(i)? {
</a><a href="#h2-1-6" id="h2-1-6" class="i">+                    (table, Some(name)) =&gt; Some((table, name)),
</a><a href="#h2-1-7" id="h2-1-7" class="i">+                    _ =&gt; None,
</a><a href="#h2-1-8" id="h2-1-8" class="i">+                };
</a><a href="#h2-1-9" id="h2-1-9" class="i">+                Field(i, label)
</a><a href="#h2-1-10" id="h2-1-10" class="i">+            }
</a>             ast::Expression::Field(table, name) =&gt; {
                 Field(scope.resolve(table.as_deref(), &amp;name)?, Some((table, name)))
             }
<a href="#h2-2" id="h2-2" class="h">@@ -693,18 +712,18 @@ impl Scope {
</a>         Ok(())
     }
 
<a href="#h2-2-3" id="h2-2-3" class="d">-    /// Checks if a column index is present in the scope, errors if missing or constant.
</a><a href="#h2-2-4" id="h2-2-4" class="d">-    fn assert(&amp;self, index: usize) -&gt; Result&lt;usize&gt; {
</a><a href="#h2-2-5" id="h2-2-5" class="i">+    /// Fetches a column from the scope by index.
</a><a href="#h2-2-6" id="h2-2-6" class="i">+    fn get_column(&amp;self, index: usize) -&gt; Result&lt;(Option&lt;String&gt;, Option&lt;String&gt;)&gt; {
</a>         if self.constant {
             return Err(Error::Value(format!(
                 &quot;Expression must be constant, found column {}&quot;,
                 index
             )));
         }
<a href="#h2-2-13" id="h2-2-13" class="d">-        if index &gt;= self.columns.len() {
</a><a href="#h2-2-14" id="h2-2-14" class="d">-            return Err(Error::Value(format!(&quot;Column index {} not found&quot;, index)));
</a><a href="#h2-2-15" id="h2-2-15" class="d">-        }
</a><a href="#h2-2-16" id="h2-2-16" class="d">-        Ok(index)
</a><a href="#h2-2-17" id="h2-2-17" class="i">+        self.columns
</a><a href="#h2-2-18" id="h2-2-18" class="i">+            .get(index)
</a><a href="#h2-2-19" id="h2-2-19" class="i">+            .cloned()
</a><a href="#h2-2-20" id="h2-2-20" class="i">+            .ok_or_else(|| Error::Value(format!(&quot;Column index {} not found&quot;, index)))
</a>     }
 
     /// Resolves a name, optionally qualified by a table name.
<b>diff --git a/<a id="h3" href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a> b/<a href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -3,6 +3,7 @@ use crate::error::{Error, Result};
</a> 
 use regex::Regex;
 use serde_derive::{Deserialize, Serialize};
<a href="#h3-0-3" id="h3-0-3" class="i">+use std::fmt::{self, Display};
</a> use std::mem::replace;
 
 /// An expression, made up of constants and operations
<a href="#h3-1" id="h3-1" class="h">@@ -515,3 +516,36 @@ impl Expression {
</a>         .unwrap()
     }
 }
<a href="#h3-1-3" id="h3-1-3" class="i">+
</a><a href="#h3-1-4" id="h3-1-4" class="i">+impl Display for Expression {
</a><a href="#h3-1-5" id="h3-1-5" class="i">+    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;&#39;_&gt;) -&gt; fmt::Result {
</a><a href="#h3-1-6" id="h3-1-6" class="i">+        let s = match self {
</a><a href="#h3-1-7" id="h3-1-7" class="i">+            Self::Constant(v) =&gt; v.to_string(),
</a><a href="#h3-1-8" id="h3-1-8" class="i">+            Self::Field(i, None) =&gt; format!(&quot;#{}&quot;, i),
</a><a href="#h3-1-9" id="h3-1-9" class="i">+            Self::Field(_, Some((None, name))) =&gt; name.to_string(),
</a><a href="#h3-1-10" id="h3-1-10" class="i">+            Self::Field(_, Some((Some(table), name))) =&gt; format!(&quot;{}.{}&quot;, table, name),
</a><a href="#h3-1-11" id="h3-1-11" class="i">+
</a><a href="#h3-1-12" id="h3-1-12" class="i">+            Self::And(lhs, rhs) =&gt; format!(&quot;{} AND {}&quot;, lhs, rhs),
</a><a href="#h3-1-13" id="h3-1-13" class="i">+            Self::Or(lhs, rhs) =&gt; format!(&quot;{} OR {}&quot;, lhs, rhs),
</a><a href="#h3-1-14" id="h3-1-14" class="i">+            Self::Not(expr) =&gt; format!(&quot;NOT {}&quot;, expr),
</a><a href="#h3-1-15" id="h3-1-15" class="i">+
</a><a href="#h3-1-16" id="h3-1-16" class="i">+            Self::Equal(lhs, rhs) =&gt; format!(&quot;{} = {}&quot;, lhs, rhs),
</a><a href="#h3-1-17" id="h3-1-17" class="i">+            Self::GreaterThan(lhs, rhs) =&gt; format!(&quot;{} &gt; {}&quot;, lhs, rhs),
</a><a href="#h3-1-18" id="h3-1-18" class="i">+            Self::LessThan(lhs, rhs) =&gt; format!(&quot;{} &lt; {}&quot;, lhs, rhs),
</a><a href="#h3-1-19" id="h3-1-19" class="i">+            Self::IsNull(expr) =&gt; format!(&quot;{} IS NULL&quot;, expr),
</a><a href="#h3-1-20" id="h3-1-20" class="i">+
</a><a href="#h3-1-21" id="h3-1-21" class="i">+            Self::Add(lhs, rhs) =&gt; format!(&quot;{} + {}&quot;, lhs, rhs),
</a><a href="#h3-1-22" id="h3-1-22" class="i">+            Self::Assert(expr) =&gt; expr.to_string(),
</a><a href="#h3-1-23" id="h3-1-23" class="i">+            Self::Divide(lhs, rhs) =&gt; format!(&quot;{} / {}&quot;, lhs, rhs),
</a><a href="#h3-1-24" id="h3-1-24" class="i">+            Self::Exponentiate(lhs, rhs) =&gt; format!(&quot;{} ^ {}&quot;, lhs, rhs),
</a><a href="#h3-1-25" id="h3-1-25" class="i">+            Self::Factorial(expr) =&gt; format!(&quot;!{}&quot;, expr),
</a><a href="#h3-1-26" id="h3-1-26" class="i">+            Self::Modulo(lhs, rhs) =&gt; format!(&quot;{} % {}&quot;, lhs, rhs),
</a><a href="#h3-1-27" id="h3-1-27" class="i">+            Self::Multiply(lhs, rhs) =&gt; format!(&quot;{} * {}&quot;, lhs, rhs),
</a><a href="#h3-1-28" id="h3-1-28" class="i">+            Self::Negate(expr) =&gt; format!(&quot;-{}&quot;, expr),
</a><a href="#h3-1-29" id="h3-1-29" class="i">+            Self::Subtract(lhs, rhs) =&gt; format!(&quot;{} - {}&quot;, lhs, rhs),
</a><a href="#h3-1-30" id="h3-1-30" class="i">+
</a><a href="#h3-1-31" id="h3-1-31" class="i">+            Self::Like(lhs, rhs) =&gt; format!(&quot;{} LIKE {}&quot;, lhs, rhs),
</a><a href="#h3-1-32" id="h3-1-32" class="i">+        };
</a><a href="#h3-1-33" id="h3-1-33" class="i">+        write!(f, &quot;{}&quot;, s)
</a><a href="#h3-1-34" id="h3-1-34" class="i">+    }
</a><a href="#h3-1-35" id="h3-1-35" class="i">+}
</a><b>diff --git a/<a id="h4" href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a> b/<a href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -110,6 +110,8 @@ macro_rules! test_query {
</a> 
             write!(f, &quot;Query: {}\n\n&quot;, $query)?;
 
<a href="#h4-0-3" id="h4-0-3" class="i">+            write!(f, &quot;Explain:\n{}\n\n&quot;, plan)?;
</a><a href="#h4-0-4" id="h4-0-4" class="i">+
</a>             write!(f, &quot;Result:&quot;)?;
             let result = match plan.execute(&amp;mut txn) {
                 Ok(result) =&gt; result,
<b>diff --git a/<a id="h5" href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a> b/<a href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -361,5 +361,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans WHERE b IS NOT NULL
 
<a href="#h5-0-3" id="h5-0-3" class="i">+Explain:
</a><a href="#h5-0-4" id="h5-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h5-0-5" id="h5-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h5-0-6" id="h5-0-6" class="i">+   └─ Projection: b, b, b, b, b
</a><a href="#h5-0-7" id="h5-0-7" class="i">+      └─ Scan: booleans (NOT b IS NULL)
</a><a href="#h5-0-8" id="h5-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Boolean(false), Boolean(true), Null, Integer(2), Null]
<b>diff --git a/<a id="h6" href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a> b/<a href="../file/tests/sql/query/agg_boolean_null.html">tests/sql/query/agg_boolean_null</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -319,5 +319,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans
 
<a href="#h6-0-3" id="h6-0-3" class="i">+Explain:
</a><a href="#h6-0-4" id="h6-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h6-0-5" id="h6-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h6-0-6" id="h6-0-6" class="i">+   └─ Projection: b, b, b, b, b
</a><a href="#h6-0-7" id="h6-0-7" class="i">+      └─ Scan: booleans
</a><a href="#h6-0-8" id="h6-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Null, Null, Null, Integer(2), Null]
<b>diff --git a/<a id="h7" href="../file/tests/sql/query/agg_const.html">tests/sql/query/agg_const</a> b/<a href="../file/tests/sql/query/agg_const.html">tests/sql/query/agg_const</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -271,5 +271,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3)
 
<a href="#h7-0-3" id="h7-0-3" class="i">+Explain:
</a><a href="#h7-0-4" id="h7-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h7-0-5" id="h7-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h7-0-6" id="h7-0-6" class="i">+   └─ Projection: 3, 3, 3, 3, 3
</a><a href="#h7-0-7" id="h7-0-7" class="i">+      └─ Nothing
</a><a href="#h7-0-8" id="h7-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Integer(3), Integer(3), Integer(3), Integer(1), Integer(3)]
<b>diff --git a/<a id="h8" href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a> b/<a href="../file/tests/sql/query/agg_const_from.html">tests/sql/query/agg_const_from</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -284,5 +284,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3) FROM genres
 
<a href="#h8-0-3" id="h8-0-3" class="i">+Explain:
</a><a href="#h8-0-4" id="h8-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h8-0-5" id="h8-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h8-0-6" id="h8-0-6" class="i">+   └─ Projection: 3, 3, 3, 3, 3
</a><a href="#h8-0-7" id="h8-0-7" class="i">+      └─ Scan: genres
</a><a href="#h8-0-8" id="h8-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Integer(3), Integer(3), Integer(9), Integer(3), Integer(3)]
<b>diff --git a/<a id="h9" href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a> b/<a href="../file/tests/sql/query/agg_count_star.html">tests/sql/query/agg_count_star</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -104,5 +104,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT COUNT(*) FROM movies
 
<a href="#h9-0-3" id="h9-0-3" class="i">+Explain:
</a><a href="#h9-0-4" id="h9-0-4" class="i">+Projection: #0
</a><a href="#h9-0-5" id="h9-0-5" class="i">+└─ Aggregation: count
</a><a href="#h9-0-6" id="h9-0-6" class="i">+   └─ Projection: TRUE
</a><a href="#h9-0-7" id="h9-0-7" class="i">+      └─ Scan: movies
</a><a href="#h9-0-8" id="h9-0-8" class="i">+
</a> Result: [&quot;?&quot;]
 [Integer(10)]
<b>diff --git a/<a id="h10" href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a> b/<a href="../file/tests/sql/query/agg_expr.html">tests/sql/query/agg_expr</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -178,5 +178,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT SUM(rating * 10) / COUNT(*) FROM movies
 
<a href="#h10-0-3" id="h10-0-3" class="i">+Explain:
</a><a href="#h10-0-4" id="h10-0-4" class="i">+Projection: #0 / #1
</a><a href="#h10-0-5" id="h10-0-5" class="i">+└─ Aggregation: sum, count
</a><a href="#h10-0-6" id="h10-0-6" class="i">+   └─ Projection: rating * 10, TRUE
</a><a href="#h10-0-7" id="h10-0-7" class="i">+      └─ Scan: movies
</a><a href="#h10-0-8" id="h10-0-8" class="i">+
</a> Result: [&quot;?&quot;]
 [Float(77.8)]
<b>diff --git a/<a id="h11" href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a> b/<a href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -361,5 +361,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats WHERE f IS NOT NULL
 
<a href="#h11-0-3" id="h11-0-3" class="i">+Explain:
</a><a href="#h11-0-4" id="h11-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h11-0-5" id="h11-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h11-0-6" id="h11-0-6" class="i">+   └─ Projection: f, f, f, f, f
</a><a href="#h11-0-7" id="h11-0-7" class="i">+      └─ Scan: floats (NOT f IS NULL)
</a><a href="#h11-0-8" id="h11-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Float(-2.718), Float(3.14), Float(2.04), Integer(4), Float(0.51)]
<b>diff --git a/<a id="h12" href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a> b/<a href="../file/tests/sql/query/agg_float_null.html">tests/sql/query/agg_float_null</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -319,5 +319,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats
 
<a href="#h12-0-3" id="h12-0-3" class="i">+Explain:
</a><a href="#h12-0-4" id="h12-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h12-0-5" id="h12-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h12-0-6" id="h12-0-6" class="i">+   └─ Projection: f, f, f, f, f
</a><a href="#h12-0-7" id="h12-0-7" class="i">+      └─ Scan: floats
</a><a href="#h12-0-8" id="h12-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Null, Null, Null, Integer(4), Null]
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a> b/<a href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -361,5 +361,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers WHERE i IS NOT NULL
 
<a href="#h13-0-3" id="h13-0-3" class="i">+Explain:
</a><a href="#h13-0-4" id="h13-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h13-0-5" id="h13-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h13-0-6" id="h13-0-6" class="i">+   └─ Projection: i, i, i, i, i
</a><a href="#h13-0-7" id="h13-0-7" class="i">+      └─ Scan: integers (NOT i IS NULL)
</a><a href="#h13-0-8" id="h13-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Integer(-3), Integer(7), Integer(9), Integer(4), Integer(2)]
<b>diff --git a/<a id="h14" href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a> b/<a href="../file/tests/sql/query/agg_integer_null.html">tests/sql/query/agg_integer_null</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -319,5 +319,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers
 
<a href="#h14-0-3" id="h14-0-3" class="i">+Explain:
</a><a href="#h14-0-4" id="h14-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h14-0-5" id="h14-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h14-0-6" id="h14-0-6" class="i">+   └─ Projection: i, i, i, i, i
</a><a href="#h14-0-7" id="h14-0-7" class="i">+      └─ Scan: integers
</a><a href="#h14-0-8" id="h14-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Null, Null, Null, Integer(4), Null]
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -338,5 +338,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(id), MAX(id), SUM(id), COUNT(id), AVG(id) FROM movies WHERE FALSE
 
<a href="#h15-0-3" id="h15-0-3" class="i">+Explain:
</a><a href="#h15-0-4" id="h15-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h15-0-5" id="h15-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h15-0-6" id="h15-0-6" class="i">+   └─ Projection: id, id, id, id, id
</a><a href="#h15-0-7" id="h15-0-7" class="i">+      └─ Scan: movies (FALSE)
</a><a href="#h15-0-8" id="h15-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Null, Null, Null, Integer(0), Null]
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -367,4 +367,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(id), MAX(id), SUM(id), COUNT(id), AVG(id) FROM movies WHERE FALSE GROUP BY id
 
<a href="#h16-0-3" id="h16-0-3" class="i">+Explain:
</a><a href="#h16-0-4" id="h16-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h16-0-5" id="h16-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h16-0-6" id="h16-0-6" class="i">+   └─ Projection: id, id, id, id, id, id
</a><a href="#h16-0-7" id="h16-0-7" class="i">+      └─ Scan: movies (FALSE)
</a><a href="#h16-0-8" id="h16-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a> b/<a href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -361,5 +361,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings WHERE s IS NOT NULL
 
<a href="#h17-0-3" id="h17-0-3" class="i">+Explain:
</a><a href="#h17-0-4" id="h17-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h17-0-5" id="h17-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h17-0-6" id="h17-0-6" class="i">+   └─ Projection: s, s, s, s, s
</a><a href="#h17-0-7" id="h17-0-7" class="i">+      └─ Scan: strings (NOT s IS NULL)
</a><a href="#h17-0-8" id="h17-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [String(&quot;A&quot;), String(&quot;åa&quot;), Null, Integer(7), Null]
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a> b/<a href="../file/tests/sql/query/agg_string_null.html">tests/sql/query/agg_string_null</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -319,5 +319,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings
 
<a href="#h18-0-3" id="h18-0-3" class="i">+Explain:
</a><a href="#h18-0-4" id="h18-0-4" class="i">+Projection: #0, #1, #2, #3, #4
</a><a href="#h18-0-5" id="h18-0-5" class="i">+└─ Aggregation: minimum, maximum, sum, count, average
</a><a href="#h18-0-6" id="h18-0-6" class="i">+   └─ Projection: s, s, s, s, s
</a><a href="#h18-0-7" id="h18-0-7" class="i">+      └─ Scan: strings
</a><a href="#h18-0-8" id="h18-0-8" class="i">+
</a> Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
 [Null, Null, Null, Integer(7), Null]
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/all.html">tests/sql/query/all</a> b/<a href="../file/tests/sql/query/all.html">tests/sql/query/all</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -34,6 +34,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies
 
<a href="#h19-0-3" id="h19-0-3" class="i">+Explain:
</a><a href="#h19-0-4" id="h19-0-4" class="i">+Scan: movies
</a><a href="#h19-0-5" id="h19-0-5" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a> b/<a href="../file/tests/sql/query/as_.html">tests/sql/query/as_</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -194,6 +194,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT 1, 2 b, 3 AS c, 4 AS &quot;👋&quot;, id AS &quot;some id&quot; FROM movies
 
<a href="#h20-0-3" id="h20-0-3" class="i">+Explain:
</a><a href="#h20-0-4" id="h20-0-4" class="i">+Projection: 1, 2, 3, 4, id
</a><a href="#h20-0-5" id="h20-0-5" class="i">+└─ Scan: movies
</a><a href="#h20-0-6" id="h20-0-6" class="i">+
</a> Result: [&quot;?&quot;, &quot;b&quot;, &quot;c&quot;, &quot;👋&quot;, &quot;some id&quot;]
 [Integer(1), Integer(2), Integer(3), Integer(4), Integer(1)]
 [Integer(1), Integer(2), Integer(3), Integer(4), Integer(2)]
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/as_duplicate.html">tests/sql/query/as_duplicate</a> b/<a href="../file/tests/sql/query/as_duplicate.html">tests/sql/query/as_duplicate</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -90,5 +90,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT 1 AS a, 2 AS a
 
<a href="#h21-0-3" id="h21-0-3" class="i">+Explain:
</a><a href="#h21-0-4" id="h21-0-4" class="i">+Projection: 1, 2
</a><a href="#h21-0-5" id="h21-0-5" class="i">+└─ Nothing
</a><a href="#h21-0-6" id="h21-0-6" class="i">+
</a> Result: [&quot;a&quot;, &quot;a&quot;]
 [Integer(1), Integer(2)]
<b>diff --git a/<a id="h22" href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a> b/<a href="../file/tests/sql/query/expr_mixed.html">tests/sql/query/expr_mixed</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -159,6 +159,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT 1 + 2 * 3, 2020 - released AS age FROM movies
 
<a href="#h22-0-3" id="h22-0-3" class="i">+Explain:
</a><a href="#h22-0-4" id="h22-0-4" class="i">+Projection: 7, 2020 - released
</a><a href="#h22-0-5" id="h22-0-5" class="i">+└─ Scan: movies
</a><a href="#h22-0-6" id="h22-0-6" class="i">+
</a> Result: [&quot;?&quot;, &quot;age&quot;]
 [Integer(7), Integer(41)]
 [Integer(7), Integer(5)]
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/expr_static.html">tests/sql/query/expr_static</a> b/<a href="../file/tests/sql/query/expr_static.html">tests/sql/query/expr_static</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -132,5 +132,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT 1 + 2 * 3, &#39;abc&#39; LIKE &#39;x%&#39; AS nope
 
<a href="#h23-0-3" id="h23-0-3" class="i">+Explain:
</a><a href="#h23-0-4" id="h23-0-4" class="i">+Projection: 7, FALSE
</a><a href="#h23-0-5" id="h23-0-5" class="i">+└─ Nothing
</a><a href="#h23-0-6" id="h23-0-6" class="i">+
</a> Result: [&quot;?&quot;, &quot;nope&quot;]
 [Integer(7), Boolean(false)]
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a> b/<a href="../file/tests/sql/query/field_aliased.html">tests/sql/query/field_aliased</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -155,6 +155,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT m.id, g.id FROM movies AS m, genres g
 
<a href="#h24-0-3" id="h24-0-3" class="i">+Explain:
</a><a href="#h24-0-4" id="h24-0-4" class="i">+Projection: m.id, g.id
</a><a href="#h24-0-5" id="h24-0-5" class="i">+└─ NestedLoopJoin: inner
</a><a href="#h24-0-6" id="h24-0-6" class="i">+   ├─ Scan: movies
</a><a href="#h24-0-7" id="h24-0-7" class="i">+   └─ Scan: genres
</a><a href="#h24-0-8" id="h24-0-8" class="i">+
</a> Result: [&quot;id&quot;, &quot;id&quot;]
 [Integer(1), Integer(1)]
 [Integer(1), Integer(2)]
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a> b/<a href="../file/tests/sql/query/field_multi.html">tests/sql/query/field_multi</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -105,6 +105,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT id, title FROM movies
 
<a href="#h25-0-3" id="h25-0-3" class="i">+Explain:
</a><a href="#h25-0-4" id="h25-0-4" class="i">+Projection: id, title
</a><a href="#h25-0-5" id="h25-0-5" class="i">+└─ Scan: movies
</a><a href="#h25-0-6" id="h25-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;]
 [Integer(1), String(&quot;Stalker&quot;)]
 [Integer(2), String(&quot;Sicario&quot;)]
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a> b/<a href="../file/tests/sql/query/field_qualified.html">tests/sql/query/field_qualified</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -80,6 +80,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT movies.id FROM movies
 
<a href="#h26-0-3" id="h26-0-3" class="i">+Explain:
</a><a href="#h26-0-4" id="h26-0-4" class="i">+Projection: movies.id
</a><a href="#h26-0-5" id="h26-0-5" class="i">+└─ Scan: movies
</a><a href="#h26-0-6" id="h26-0-6" class="i">+
</a> Result: [&quot;id&quot;]
 [Integer(1)]
 [Integer(2)]
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a> b/<a href="../file/tests/sql/query/field_qualified_multi.html">tests/sql/query/field_qualified_multi</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -143,6 +143,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT movies.id, genres.id FROM movies, genres
 
<a href="#h27-0-3" id="h27-0-3" class="i">+Explain:
</a><a href="#h27-0-4" id="h27-0-4" class="i">+Projection: movies.id, genres.id
</a><a href="#h27-0-5" id="h27-0-5" class="i">+└─ NestedLoopJoin: inner
</a><a href="#h27-0-6" id="h27-0-6" class="i">+   ├─ Scan: movies
</a><a href="#h27-0-7" id="h27-0-7" class="i">+   └─ Scan: genres
</a><a href="#h27-0-8" id="h27-0-8" class="i">+
</a> Result: [&quot;id&quot;, &quot;id&quot;]
 [Integer(1), Integer(1)]
 [Integer(1), Integer(2)]
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a> b/<a href="../file/tests/sql/query/field_single.html">tests/sql/query/field_single</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT id FROM movies
 
<a href="#h28-0-3" id="h28-0-3" class="i">+Explain:
</a><a href="#h28-0-4" id="h28-0-4" class="i">+Projection: id
</a><a href="#h28-0-5" id="h28-0-5" class="i">+└─ Scan: movies
</a><a href="#h28-0-6" id="h28-0-6" class="i">+
</a> Result: [&quot;id&quot;]
 [Integer(1)]
 [Integer(2)]
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a> b/<a href="../file/tests/sql/query/from_multiple.html">tests/sql/query/from_multiple</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -86,6 +86,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies, genres, countries
 
<a href="#h29-0-3" id="h29-0-3" class="i">+Explain:
</a><a href="#h29-0-4" id="h29-0-4" class="i">+NestedLoopJoin: inner
</a><a href="#h29-0-5" id="h29-0-5" class="i">+├─ NestedLoopJoin: inner
</a><a href="#h29-0-6" id="h29-0-6" class="i">+│  ├─ Scan: movies
</a><a href="#h29-0-7" id="h29-0-7" class="i">+│  └─ Scan: genres
</a><a href="#h29-0-8" id="h29-0-8" class="i">+└─ Scan: countries
</a><a href="#h29-0-9" id="h29-0-9" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a> b/<a href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -117,7 +117,12 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h30-0-3" id="h30-0-3" class="d">-                    None,
</a><a href="#h30-0-4" id="h30-0-4" class="i">+                    Some(
</a><a href="#h30-0-5" id="h30-0-5" class="i">+                        (
</a><a href="#h30-0-6" id="h30-0-6" class="i">+                            None,
</a><a href="#h30-0-7" id="h30-0-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h30-0-8" id="h30-0-8" class="i">+                        ),
</a><a href="#h30-0-9" id="h30-0-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h30-1" id="h30-1" class="h">@@ -189,7 +194,12 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h30-1-3" id="h30-1-3" class="d">-                    None,
</a><a href="#h30-1-4" id="h30-1-4" class="i">+                    Some(
</a><a href="#h30-1-5" id="h30-1-5" class="i">+                        (
</a><a href="#h30-1-6" id="h30-1-6" class="i">+                            None,
</a><a href="#h30-1-7" id="h30-1-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h30-1-8" id="h30-1-8" class="i">+                        ),
</a><a href="#h30-1-9" id="h30-1-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h30-2" id="h30-2" class="h">@@ -199,6 +209,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
 
<a href="#h30-2-3" id="h30-2-3" class="i">+Explain:
</a><a href="#h30-2-4" id="h30-2-4" class="i">+Order: rating asc
</a><a href="#h30-2-5" id="h30-2-5" class="i">+└─ Projection: #0
</a><a href="#h30-2-6" id="h30-2-6" class="i">+   └─ Aggregation: maximum
</a><a href="#h30-2-7" id="h30-2-7" class="i">+      └─ Projection: rating, studio_id * 2
</a><a href="#h30-2-8" id="h30-2-8" class="i">+         └─ Scan: movies
</a><a href="#h30-2-9" id="h30-2-9" class="i">+
</a> Result: [&quot;rating&quot;]
 [Float(6.9)]
 [Float(7.6)]
<b>diff --git a/<a id="h31" href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a> b/<a href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -133,7 +133,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         2,
<a href="#h31-0-3" id="h31-0-3" class="d">-                        None,
</a><a href="#h31-0-4" id="h31-0-4" class="i">+                        Some(
</a><a href="#h31-0-5" id="h31-0-5" class="i">+                            (
</a><a href="#h31-0-6" id="h31-0-6" class="i">+                                Some(
</a><a href="#h31-0-7" id="h31-0-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h31-0-8" id="h31-0-8" class="i">+                                ),
</a><a href="#h31-0-9" id="h31-0-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h31-0-10" id="h31-0-10" class="i">+                            ),
</a><a href="#h31-0-11" id="h31-0-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h31-1" id="h31-1" class="h">@@ -156,7 +163,14 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h31-1-3" id="h31-1-3" class="d">-                    None,
</a><a href="#h31-1-4" id="h31-1-4" class="i">+                    Some(
</a><a href="#h31-1-5" id="h31-1-5" class="i">+                        (
</a><a href="#h31-1-6" id="h31-1-6" class="i">+                            Some(
</a><a href="#h31-1-7" id="h31-1-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h31-1-8" id="h31-1-8" class="i">+                            ),
</a><a href="#h31-1-9" id="h31-1-9" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h31-1-10" id="h31-1-10" class="i">+                        ),
</a><a href="#h31-1-11" id="h31-1-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h31-2" id="h31-2" class="h">@@ -225,7 +239,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         2,
<a href="#h31-2-3" id="h31-2-3" class="d">-                        None,
</a><a href="#h31-2-4" id="h31-2-4" class="i">+                        Some(
</a><a href="#h31-2-5" id="h31-2-5" class="i">+                            (
</a><a href="#h31-2-6" id="h31-2-6" class="i">+                                Some(
</a><a href="#h31-2-7" id="h31-2-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h31-2-8" id="h31-2-8" class="i">+                                ),
</a><a href="#h31-2-9" id="h31-2-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h31-2-10" id="h31-2-10" class="i">+                            ),
</a><a href="#h31-2-11" id="h31-2-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h31-3" id="h31-3" class="h">@@ -248,7 +269,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h31-3-3" id="h31-3-3" class="d">-                    None,
</a><a href="#h31-3-4" id="h31-3-4" class="i">+                    Some(
</a><a href="#h31-3-5" id="h31-3-5" class="i">+                        (
</a><a href="#h31-3-6" id="h31-3-6" class="i">+                            Some(
</a><a href="#h31-3-7" id="h31-3-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h31-3-8" id="h31-3-8" class="i">+                            ),
</a><a href="#h31-3-9" id="h31-3-9" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h31-3-10" id="h31-3-10" class="i">+                        ),
</a><a href="#h31-3-11" id="h31-3-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h31-4" id="h31-4" class="h">@@ -258,6 +286,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) FROM movies GROUP BY studio_id ORDER BY studio_id
 
<a href="#h31-4-3" id="h31-4-3" class="i">+Explain:
</a><a href="#h31-4-4" id="h31-4-4" class="i">+Order: movies.studio_id asc
</a><a href="#h31-4-5" id="h31-4-5" class="i">+└─ Projection: movies.studio_id, #0 / #1
</a><a href="#h31-4-6" id="h31-4-6" class="i">+   └─ Aggregation: sum, count
</a><a href="#h31-4-7" id="h31-4-7" class="i">+      └─ Projection: rating * 10, TRUE, studio_id
</a><a href="#h31-4-8" id="h31-4-8" class="i">+         └─ Scan: movies
</a><a href="#h31-4-9" id="h31-4-9" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;?&quot;]
 [Integer(1), Float(81.5)]
 [Integer(2), Float(75.0)]
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a> b/<a href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -141,7 +141,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         2,
<a href="#h32-0-3" id="h32-0-3" class="d">-                        None,
</a><a href="#h32-0-4" id="h32-0-4" class="i">+                        Some(
</a><a href="#h32-0-5" id="h32-0-5" class="i">+                            (
</a><a href="#h32-0-6" id="h32-0-6" class="i">+                                Some(
</a><a href="#h32-0-7" id="h32-0-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h32-0-8" id="h32-0-8" class="i">+                                ),
</a><a href="#h32-0-9" id="h32-0-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h32-0-10" id="h32-0-10" class="i">+                            ),
</a><a href="#h32-0-11" id="h32-0-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h32-1" id="h32-1" class="h">@@ -175,7 +182,14 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h32-1-3" id="h32-1-3" class="d">-                    None,
</a><a href="#h32-1-4" id="h32-1-4" class="i">+                    Some(
</a><a href="#h32-1-5" id="h32-1-5" class="i">+                        (
</a><a href="#h32-1-6" id="h32-1-6" class="i">+                            Some(
</a><a href="#h32-1-7" id="h32-1-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h32-1-8" id="h32-1-8" class="i">+                            ),
</a><a href="#h32-1-9" id="h32-1-9" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h32-1-10" id="h32-1-10" class="i">+                        ),
</a><a href="#h32-1-11" id="h32-1-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h32-2" id="h32-2" class="h">@@ -244,7 +258,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         2,
<a href="#h32-2-3" id="h32-2-3" class="d">-                        None,
</a><a href="#h32-2-4" id="h32-2-4" class="i">+                        Some(
</a><a href="#h32-2-5" id="h32-2-5" class="i">+                            (
</a><a href="#h32-2-6" id="h32-2-6" class="i">+                                Some(
</a><a href="#h32-2-7" id="h32-2-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h32-2-8" id="h32-2-8" class="i">+                                ),
</a><a href="#h32-2-9" id="h32-2-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h32-2-10" id="h32-2-10" class="i">+                            ),
</a><a href="#h32-2-11" id="h32-2-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h32-3" id="h32-3" class="h">@@ -278,7 +299,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h32-3-3" id="h32-3-3" class="d">-                    None,
</a><a href="#h32-3-4" id="h32-3-4" class="i">+                    Some(
</a><a href="#h32-3-5" id="h32-3-5" class="i">+                        (
</a><a href="#h32-3-6" id="h32-3-6" class="i">+                            Some(
</a><a href="#h32-3-7" id="h32-3-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h32-3-8" id="h32-3-8" class="i">+                            ),
</a><a href="#h32-3-9" id="h32-3-9" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h32-3-10" id="h32-3-10" class="i">+                        ),
</a><a href="#h32-3-11" id="h32-3-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h32-4" id="h32-4" class="h">@@ -288,6 +316,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) + studio_id FROM movies GROUP BY studio_id ORDER BY studio_id
 
<a href="#h32-4-3" id="h32-4-3" class="i">+Explain:
</a><a href="#h32-4-4" id="h32-4-4" class="i">+Order: movies.studio_id asc
</a><a href="#h32-4-5" id="h32-4-5" class="i">+└─ Projection: movies.studio_id, #0 / #1 + studio_id
</a><a href="#h32-4-6" id="h32-4-6" class="i">+   └─ Aggregation: sum, count
</a><a href="#h32-4-7" id="h32-4-7" class="i">+      └─ Projection: rating * 10, TRUE, studio_id
</a><a href="#h32-4-8" id="h32-4-8" class="i">+         └─ Scan: movies
</a><a href="#h32-4-9" id="h32-4-9" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;?&quot;]
 [Integer(1), Float(82.5)]
 [Integer(2), Float(77.0)]
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a> b/<a href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -114,7 +114,12 @@ Plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h33-0-3" id="h33-0-3" class="d">-                        None,
</a><a href="#h33-0-4" id="h33-0-4" class="i">+                        Some(
</a><a href="#h33-0-5" id="h33-0-5" class="i">+                            (
</a><a href="#h33-0-6" id="h33-0-6" class="i">+                                None,
</a><a href="#h33-0-7" id="h33-0-7" class="i">+                                &quot;twice&quot;,
</a><a href="#h33-0-8" id="h33-0-8" class="i">+                            ),
</a><a href="#h33-0-9" id="h33-0-9" class="i">+                        ),
</a>                     ),
                     Some(
                         &quot;twice&quot;,
<a href="#h33-1" id="h33-1" class="h">@@ -133,7 +138,12 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h33-1-3" id="h33-1-3" class="d">-                    None,
</a><a href="#h33-1-4" id="h33-1-4" class="i">+                    Some(
</a><a href="#h33-1-5" id="h33-1-5" class="i">+                        (
</a><a href="#h33-1-6" id="h33-1-6" class="i">+                            None,
</a><a href="#h33-1-7" id="h33-1-7" class="i">+                            &quot;twice&quot;,
</a><a href="#h33-1-8" id="h33-1-8" class="i">+                        ),
</a><a href="#h33-1-9" id="h33-1-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h33-2" id="h33-2" class="h">@@ -195,7 +205,12 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h33-2-3" id="h33-2-3" class="d">-                        None,
</a><a href="#h33-2-4" id="h33-2-4" class="i">+                        Some(
</a><a href="#h33-2-5" id="h33-2-5" class="i">+                            (
</a><a href="#h33-2-6" id="h33-2-6" class="i">+                                None,
</a><a href="#h33-2-7" id="h33-2-7" class="i">+                                &quot;twice&quot;,
</a><a href="#h33-2-8" id="h33-2-8" class="i">+                            ),
</a><a href="#h33-2-9" id="h33-2-9" class="i">+                        ),
</a>                     ),
                     Some(
                         &quot;twice&quot;,
<a href="#h33-3" id="h33-3" class="h">@@ -214,7 +229,12 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h33-3-3" id="h33-3-3" class="d">-                    None,
</a><a href="#h33-3-4" id="h33-3-4" class="i">+                    Some(
</a><a href="#h33-3-5" id="h33-3-5" class="i">+                        (
</a><a href="#h33-3-6" id="h33-3-6" class="i">+                            None,
</a><a href="#h33-3-7" id="h33-3-7" class="i">+                            &quot;twice&quot;,
</a><a href="#h33-3-8" id="h33-3-8" class="i">+                        ),
</a><a href="#h33-3-9" id="h33-3-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h33-4" id="h33-4" class="h">@@ -224,6 +244,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id * 2 AS twice, MAX(rating) FROM movies GROUP BY twice ORDER BY twice
 
<a href="#h33-4-3" id="h33-4-3" class="i">+Explain:
</a><a href="#h33-4-4" id="h33-4-4" class="i">+Order: twice asc
</a><a href="#h33-4-5" id="h33-4-5" class="i">+└─ Projection: twice, #0
</a><a href="#h33-4-6" id="h33-4-6" class="i">+   └─ Aggregation: maximum
</a><a href="#h33-4-7" id="h33-4-7" class="i">+      └─ Projection: rating, studio_id * 2
</a><a href="#h33-4-8" id="h33-4-8" class="i">+         └─ Scan: movies
</a><a href="#h33-4-9" id="h33-4-9" class="i">+
</a> Result: [&quot;twice&quot;, &quot;?&quot;]
 [Integer(2), Float(8.2)]
 [Integer(4), Float(7.6)]
<b>diff --git a/<a id="h34" href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a> b/<a href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -140,7 +140,12 @@ Plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h34-0-3" id="h34-0-3" class="d">-                    None,
</a><a href="#h34-0-4" id="h34-0-4" class="i">+                    Some(
</a><a href="#h34-0-5" id="h34-0-5" class="i">+                        (
</a><a href="#h34-0-6" id="h34-0-6" class="i">+                            None,
</a><a href="#h34-0-7" id="h34-0-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h34-0-8" id="h34-0-8" class="i">+                        ),
</a><a href="#h34-0-9" id="h34-0-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h34-1" id="h34-1" class="h">@@ -219,7 +224,12 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h34-1-3" id="h34-1-3" class="d">-                    None,
</a><a href="#h34-1-4" id="h34-1-4" class="i">+                    Some(
</a><a href="#h34-1-5" id="h34-1-5" class="i">+                        (
</a><a href="#h34-1-6" id="h34-1-6" class="i">+                            None,
</a><a href="#h34-1-7" id="h34-1-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h34-1-8" id="h34-1-8" class="i">+                        ),
</a><a href="#h34-1-9" id="h34-1-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h34-2" id="h34-2" class="h">@@ -229,6 +239,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
 
<a href="#h34-2-3" id="h34-2-3" class="i">+Explain:
</a><a href="#h34-2-4" id="h34-2-4" class="i">+Order: rating asc
</a><a href="#h34-2-5" id="h34-2-5" class="i">+└─ Projection: #1, #0
</a><a href="#h34-2-6" id="h34-2-6" class="i">+   └─ Aggregation: maximum
</a><a href="#h34-2-7" id="h34-2-7" class="i">+      └─ Projection: rating, studio_id * 2
</a><a href="#h34-2-8" id="h34-2-8" class="i">+         └─ Scan: movies
</a><a href="#h34-2-9" id="h34-2-9" class="i">+
</a> Result: [&quot;?&quot;, &quot;rating&quot;]
 [Integer(6), Float(6.9)]
 [Integer(4), Float(7.6)]
<b>diff --git a/<a id="h35" href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a> b/<a href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -166,14 +166,24 @@ Plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h35-0-3" id="h35-0-3" class="d">-                    None,
</a><a href="#h35-0-4" id="h35-0-4" class="i">+                    Some(
</a><a href="#h35-0-5" id="h35-0-5" class="i">+                        (
</a><a href="#h35-0-6" id="h35-0-6" class="i">+                            None,
</a><a href="#h35-0-7" id="h35-0-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h35-0-8" id="h35-0-8" class="i">+                        ),
</a><a href="#h35-0-9" id="h35-0-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
             (
                 Field(
                     0,
<a href="#h35-0-16" id="h35-0-16" class="d">-                    None,
</a><a href="#h35-0-17" id="h35-0-17" class="i">+                    Some(
</a><a href="#h35-0-18" id="h35-0-18" class="i">+                        (
</a><a href="#h35-0-19" id="h35-0-19" class="i">+                            None,
</a><a href="#h35-0-20" id="h35-0-20" class="i">+                            &quot;multi&quot;,
</a><a href="#h35-0-21" id="h35-0-21" class="i">+                        ),
</a><a href="#h35-0-22" id="h35-0-22" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h35-1" id="h35-1" class="h">@@ -275,14 +285,24 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h35-1-3" id="h35-1-3" class="d">-                    None,
</a><a href="#h35-1-4" id="h35-1-4" class="i">+                    Some(
</a><a href="#h35-1-5" id="h35-1-5" class="i">+                        (
</a><a href="#h35-1-6" id="h35-1-6" class="i">+                            None,
</a><a href="#h35-1-7" id="h35-1-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h35-1-8" id="h35-1-8" class="i">+                        ),
</a><a href="#h35-1-9" id="h35-1-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
             (
                 Field(
                     0,
<a href="#h35-1-16" id="h35-1-16" class="d">-                    None,
</a><a href="#h35-1-17" id="h35-1-17" class="i">+                    Some(
</a><a href="#h35-1-18" id="h35-1-18" class="i">+                        (
</a><a href="#h35-1-19" id="h35-1-19" class="i">+                            None,
</a><a href="#h35-1-20" id="h35-1-20" class="i">+                            &quot;multi&quot;,
</a><a href="#h35-1-21" id="h35-1-21" class="i">+                        ),
</a><a href="#h35-1-22" id="h35-1-22" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h35-2" id="h35-2" class="h">@@ -292,6 +312,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id + genre_id AS multi, MAX(rating) AS rating FROM movies GROUP BY studio_id, genre_id ORDER BY rating, multi
 
<a href="#h35-2-3" id="h35-2-3" class="i">+Explain:
</a><a href="#h35-2-4" id="h35-2-4" class="i">+Order: rating asc, multi asc
</a><a href="#h35-2-5" id="h35-2-5" class="i">+└─ Projection: studio_id + genre_id, #0
</a><a href="#h35-2-6" id="h35-2-6" class="i">+   └─ Aggregation: maximum
</a><a href="#h35-2-7" id="h35-2-7" class="i">+      └─ Projection: rating, studio_id, genre_id
</a><a href="#h35-2-8" id="h35-2-8" class="i">+         └─ Scan: movies
</a><a href="#h35-2-9" id="h35-2-9" class="i">+
</a> Result: [&quot;multi&quot;, &quot;rating&quot;]
 [Integer(4), Float(6.9)]
 [Integer(5), Float(7.4)]
<b>diff --git a/<a id="h36" href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a> b/<a href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -136,7 +136,12 @@ Plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h36-0-3" id="h36-0-3" class="d">-                    None,
</a><a href="#h36-0-4" id="h36-0-4" class="i">+                    Some(
</a><a href="#h36-0-5" id="h36-0-5" class="i">+                        (
</a><a href="#h36-0-6" id="h36-0-6" class="i">+                            None,
</a><a href="#h36-0-7" id="h36-0-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h36-0-8" id="h36-0-8" class="i">+                        ),
</a><a href="#h36-0-9" id="h36-0-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h36-1" id="h36-1" class="h">@@ -220,7 +225,12 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h36-1-3" id="h36-1-3" class="d">-                    None,
</a><a href="#h36-1-4" id="h36-1-4" class="i">+                    Some(
</a><a href="#h36-1-5" id="h36-1-5" class="i">+                        (
</a><a href="#h36-1-6" id="h36-1-6" class="i">+                            None,
</a><a href="#h36-1-7" id="h36-1-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h36-1-8" id="h36-1-8" class="i">+                        ),
</a><a href="#h36-1-9" id="h36-1-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h36-2" id="h36-2" class="h">@@ -230,6 +240,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id ORDER BY rating
 
<a href="#h36-2-3" id="h36-2-3" class="i">+Explain:
</a><a href="#h36-2-4" id="h36-2-4" class="i">+Order: rating asc
</a><a href="#h36-2-5" id="h36-2-5" class="i">+└─ Projection: studio_id * 2, #0
</a><a href="#h36-2-6" id="h36-2-6" class="i">+   └─ Aggregation: maximum
</a><a href="#h36-2-7" id="h36-2-7" class="i">+      └─ Projection: rating, studio_id
</a><a href="#h36-2-8" id="h36-2-8" class="i">+         └─ Scan: movies
</a><a href="#h36-2-9" id="h36-2-9" class="i">+
</a> Result: [&quot;?&quot;, &quot;rating&quot;]
 [Integer(6), Float(6.9)]
 [Integer(4), Float(7.6)]
<b>diff --git a/<a id="h37" href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a> b/<a href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -168,7 +168,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h37-0-3" id="h37-0-3" class="d">-                        None,
</a><a href="#h37-0-4" id="h37-0-4" class="i">+                        Some(
</a><a href="#h37-0-5" id="h37-0-5" class="i">+                            (
</a><a href="#h37-0-6" id="h37-0-6" class="i">+                                Some(
</a><a href="#h37-0-7" id="h37-0-7" class="i">+                                    &quot;s&quot;,
</a><a href="#h37-0-8" id="h37-0-8" class="i">+                                ),
</a><a href="#h37-0-9" id="h37-0-9" class="i">+                                &quot;name&quot;,
</a><a href="#h37-0-10" id="h37-0-10" class="i">+                            ),
</a><a href="#h37-0-11" id="h37-0-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h37-1" id="h37-1" class="h">@@ -185,7 +192,14 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h37-1-3" id="h37-1-3" class="d">-                    None,
</a><a href="#h37-1-4" id="h37-1-4" class="i">+                    Some(
</a><a href="#h37-1-5" id="h37-1-5" class="i">+                        (
</a><a href="#h37-1-6" id="h37-1-6" class="i">+                            Some(
</a><a href="#h37-1-7" id="h37-1-7" class="i">+                                &quot;s&quot;,
</a><a href="#h37-1-8" id="h37-1-8" class="i">+                            ),
</a><a href="#h37-1-9" id="h37-1-9" class="i">+                            &quot;name&quot;,
</a><a href="#h37-1-10" id="h37-1-10" class="i">+                        ),
</a><a href="#h37-1-11" id="h37-1-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h37-2" id="h37-2" class="h">@@ -276,7 +290,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h37-2-3" id="h37-2-3" class="d">-                        None,
</a><a href="#h37-2-4" id="h37-2-4" class="i">+                        Some(
</a><a href="#h37-2-5" id="h37-2-5" class="i">+                            (
</a><a href="#h37-2-6" id="h37-2-6" class="i">+                                Some(
</a><a href="#h37-2-7" id="h37-2-7" class="i">+                                    &quot;s&quot;,
</a><a href="#h37-2-8" id="h37-2-8" class="i">+                                ),
</a><a href="#h37-2-9" id="h37-2-9" class="i">+                                &quot;name&quot;,
</a><a href="#h37-2-10" id="h37-2-10" class="i">+                            ),
</a><a href="#h37-2-11" id="h37-2-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h37-3" id="h37-3" class="h">@@ -293,7 +314,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h37-3-3" id="h37-3-3" class="d">-                    None,
</a><a href="#h37-3-4" id="h37-3-4" class="i">+                    Some(
</a><a href="#h37-3-5" id="h37-3-5" class="i">+                        (
</a><a href="#h37-3-6" id="h37-3-6" class="i">+                            Some(
</a><a href="#h37-3-7" id="h37-3-7" class="i">+                                &quot;s&quot;,
</a><a href="#h37-3-8" id="h37-3-8" class="i">+                            ),
</a><a href="#h37-3-9" id="h37-3-9" class="i">+                            &quot;name&quot;,
</a><a href="#h37-3-10" id="h37-3-10" class="i">+                        ),
</a><a href="#h37-3-11" id="h37-3-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h37-4" id="h37-4" class="h">@@ -303,6 +331,15 @@ Optimized plan: Plan(
</a> 
 Query: SELECT s.name, COUNT(*) FROM movies m JOIN studios s ON m.studio_id = s.id GROUP BY s.name ORDER BY s.name ASC
 
<a href="#h37-4-3" id="h37-4-3" class="i">+Explain:
</a><a href="#h37-4-4" id="h37-4-4" class="i">+Order: s.name asc
</a><a href="#h37-4-5" id="h37-4-5" class="i">+└─ Projection: s.name, #0
</a><a href="#h37-4-6" id="h37-4-6" class="i">+   └─ Aggregation: count
</a><a href="#h37-4-7" id="h37-4-7" class="i">+      └─ Projection: TRUE, s.name
</a><a href="#h37-4-8" id="h37-4-8" class="i">+         └─ NestedLoopJoin: inner on m.studio_id = s.id
</a><a href="#h37-4-9" id="h37-4-9" class="i">+            ├─ Scan: movies
</a><a href="#h37-4-10" id="h37-4-10" class="i">+            └─ Scan: studios
</a><a href="#h37-4-11" id="h37-4-11" class="i">+
</a> Result: [&quot;name&quot;, &quot;?&quot;]
 [String(&quot;Lionsgate&quot;), Integer(2)]
 [String(&quot;Mosfilm&quot;), Integer(2)]
<b>diff --git a/<a id="h38" href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a> b/<a href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -68,7 +68,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h38-0-3" id="h38-0-3" class="d">-                        None,
</a><a href="#h38-0-4" id="h38-0-4" class="i">+                        Some(
</a><a href="#h38-0-5" id="h38-0-5" class="i">+                            (
</a><a href="#h38-0-6" id="h38-0-6" class="i">+                                Some(
</a><a href="#h38-0-7" id="h38-0-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h38-0-8" id="h38-0-8" class="i">+                                ),
</a><a href="#h38-0-9" id="h38-0-9" class="i">+                                &quot;title&quot;,
</a><a href="#h38-0-10" id="h38-0-10" class="i">+                            ),
</a><a href="#h38-0-11" id="h38-0-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h38-1" id="h38-1" class="h">@@ -78,7 +85,14 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h38-1-3" id="h38-1-3" class="d">-                    None,
</a><a href="#h38-1-4" id="h38-1-4" class="i">+                    Some(
</a><a href="#h38-1-5" id="h38-1-5" class="i">+                        (
</a><a href="#h38-1-6" id="h38-1-6" class="i">+                            Some(
</a><a href="#h38-1-7" id="h38-1-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h38-1-8" id="h38-1-8" class="i">+                            ),
</a><a href="#h38-1-9" id="h38-1-9" class="i">+                            &quot;title&quot;,
</a><a href="#h38-1-10" id="h38-1-10" class="i">+                        ),
</a><a href="#h38-1-11" id="h38-1-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h38-2" id="h38-2" class="h">@@ -117,7 +131,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h38-2-3" id="h38-2-3" class="d">-                        None,
</a><a href="#h38-2-4" id="h38-2-4" class="i">+                        Some(
</a><a href="#h38-2-5" id="h38-2-5" class="i">+                            (
</a><a href="#h38-2-6" id="h38-2-6" class="i">+                                Some(
</a><a href="#h38-2-7" id="h38-2-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h38-2-8" id="h38-2-8" class="i">+                                ),
</a><a href="#h38-2-9" id="h38-2-9" class="i">+                                &quot;title&quot;,
</a><a href="#h38-2-10" id="h38-2-10" class="i">+                            ),
</a><a href="#h38-2-11" id="h38-2-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h38-3" id="h38-3" class="h">@@ -127,7 +148,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h38-3-3" id="h38-3-3" class="d">-                    None,
</a><a href="#h38-3-4" id="h38-3-4" class="i">+                    Some(
</a><a href="#h38-3-5" id="h38-3-5" class="i">+                        (
</a><a href="#h38-3-6" id="h38-3-6" class="i">+                            Some(
</a><a href="#h38-3-7" id="h38-3-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h38-3-8" id="h38-3-8" class="i">+                            ),
</a><a href="#h38-3-9" id="h38-3-9" class="i">+                            &quot;title&quot;,
</a><a href="#h38-3-10" id="h38-3-10" class="i">+                        ),
</a><a href="#h38-3-11" id="h38-3-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h38-4" id="h38-4" class="h">@@ -137,6 +165,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT title FROM movies GROUP BY title ORDER BY title ASC
 
<a href="#h38-4-3" id="h38-4-3" class="i">+Explain:
</a><a href="#h38-4-4" id="h38-4-4" class="i">+Order: movies.title asc
</a><a href="#h38-4-5" id="h38-4-5" class="i">+└─ Projection: movies.title
</a><a href="#h38-4-6" id="h38-4-6" class="i">+   └─ Aggregation: 
</a><a href="#h38-4-7" id="h38-4-7" class="i">+      └─ Projection: title
</a><a href="#h38-4-8" id="h38-4-8" class="i">+         └─ Scan: movies
</a><a href="#h38-4-9" id="h38-4-9" class="i">+
</a> Result: [&quot;title&quot;]
 [String(&quot;Birdman&quot;)]
 [String(&quot;Blindspotting&quot;)]
<b>diff --git a/<a id="h39" href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a> b/<a href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -101,7 +101,12 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h39-0-3" id="h39-0-3" class="d">-                    None,
</a><a href="#h39-0-4" id="h39-0-4" class="i">+                    Some(
</a><a href="#h39-0-5" id="h39-0-5" class="i">+                        (
</a><a href="#h39-0-6" id="h39-0-6" class="i">+                            None,
</a><a href="#h39-0-7" id="h39-0-7" class="i">+                            &quot;best&quot;,
</a><a href="#h39-0-8" id="h39-0-8" class="i">+                        ),
</a><a href="#h39-0-9" id="h39-0-9" class="i">+                    ),
</a>                 ),
                 Descending,
             ),
<a href="#h39-1" id="h39-1" class="h">@@ -166,7 +171,12 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h39-1-3" id="h39-1-3" class="d">-                    None,
</a><a href="#h39-1-4" id="h39-1-4" class="i">+                    Some(
</a><a href="#h39-1-5" id="h39-1-5" class="i">+                        (
</a><a href="#h39-1-6" id="h39-1-6" class="i">+                            None,
</a><a href="#h39-1-7" id="h39-1-7" class="i">+                            &quot;best&quot;,
</a><a href="#h39-1-8" id="h39-1-8" class="i">+                        ),
</a><a href="#h39-1-9" id="h39-1-9" class="i">+                    ),
</a>                 ),
                 Descending,
             ),
<a href="#h39-2" id="h39-2" class="h">@@ -176,6 +186,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MAX(rating) AS best FROM movies GROUP BY studio_id ORDER BY best DESC
 
<a href="#h39-2-3" id="h39-2-3" class="i">+Explain:
</a><a href="#h39-2-4" id="h39-2-4" class="i">+Order: best desc
</a><a href="#h39-2-5" id="h39-2-5" class="i">+└─ Projection: #0
</a><a href="#h39-2-6" id="h39-2-6" class="i">+   └─ Aggregation: maximum
</a><a href="#h39-2-7" id="h39-2-7" class="i">+      └─ Projection: rating, studio_id
</a><a href="#h39-2-8" id="h39-2-8" class="i">+         └─ Scan: movies
</a><a href="#h39-2-9" id="h39-2-9" class="i">+
</a> Result: [&quot;best&quot;]
 [Float(8.8)]
 [Float(8.2)]
<b>diff --git a/<a id="h40" href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a> b/<a href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -94,7 +94,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h40-0-3" id="h40-0-3" class="d">-                        None,
</a><a href="#h40-0-4" id="h40-0-4" class="i">+                        Some(
</a><a href="#h40-0-5" id="h40-0-5" class="i">+                            (
</a><a href="#h40-0-6" id="h40-0-6" class="i">+                                Some(
</a><a href="#h40-0-7" id="h40-0-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h40-0-8" id="h40-0-8" class="i">+                                ),
</a><a href="#h40-0-9" id="h40-0-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h40-0-10" id="h40-0-10" class="i">+                            ),
</a><a href="#h40-0-11" id="h40-0-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h40-1" id="h40-1" class="h">@@ -111,7 +118,14 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h40-1-3" id="h40-1-3" class="d">-                    None,
</a><a href="#h40-1-4" id="h40-1-4" class="i">+                    Some(
</a><a href="#h40-1-5" id="h40-1-5" class="i">+                        (
</a><a href="#h40-1-6" id="h40-1-6" class="i">+                            Some(
</a><a href="#h40-1-7" id="h40-1-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h40-1-8" id="h40-1-8" class="i">+                            ),
</a><a href="#h40-1-9" id="h40-1-9" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h40-1-10" id="h40-1-10" class="i">+                        ),
</a><a href="#h40-1-11" id="h40-1-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h40-2" id="h40-2" class="h">@@ -164,7 +178,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h40-2-3" id="h40-2-3" class="d">-                        None,
</a><a href="#h40-2-4" id="h40-2-4" class="i">+                        Some(
</a><a href="#h40-2-5" id="h40-2-5" class="i">+                            (
</a><a href="#h40-2-6" id="h40-2-6" class="i">+                                Some(
</a><a href="#h40-2-7" id="h40-2-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h40-2-8" id="h40-2-8" class="i">+                                ),
</a><a href="#h40-2-9" id="h40-2-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h40-2-10" id="h40-2-10" class="i">+                            ),
</a><a href="#h40-2-11" id="h40-2-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h40-3" id="h40-3" class="h">@@ -181,7 +202,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h40-3-3" id="h40-3-3" class="d">-                    None,
</a><a href="#h40-3-4" id="h40-3-4" class="i">+                    Some(
</a><a href="#h40-3-5" id="h40-3-5" class="i">+                        (
</a><a href="#h40-3-6" id="h40-3-6" class="i">+                            Some(
</a><a href="#h40-3-7" id="h40-3-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h40-3-8" id="h40-3-8" class="i">+                            ),
</a><a href="#h40-3-9" id="h40-3-9" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h40-3-10" id="h40-3-10" class="i">+                        ),
</a><a href="#h40-3-11" id="h40-3-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h40-4" id="h40-4" class="h">@@ -191,6 +219,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY studio_id
 
<a href="#h40-4-3" id="h40-4-3" class="i">+Explain:
</a><a href="#h40-4-4" id="h40-4-4" class="i">+Order: movies.studio_id asc
</a><a href="#h40-4-5" id="h40-4-5" class="i">+└─ Projection: movies.studio_id, #0
</a><a href="#h40-4-6" id="h40-4-6" class="i">+   └─ Aggregation: maximum
</a><a href="#h40-4-7" id="h40-4-7" class="i">+      └─ Projection: rating, studio_id
</a><a href="#h40-4-8" id="h40-4-8" class="i">+         └─ Scan: movies
</a><a href="#h40-4-9" id="h40-4-9" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;?&quot;]
 [Integer(1), Float(8.2)]
 [Integer(2), Float(7.6)]
<b>diff --git a/<a id="h41" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -111,7 +111,14 @@ Plan: Plan(
</a>                     (
                         Field(
                             1,
<a href="#h41-0-3" id="h41-0-3" class="d">-                            None,
</a><a href="#h41-0-4" id="h41-0-4" class="i">+                            Some(
</a><a href="#h41-0-5" id="h41-0-5" class="i">+                                (
</a><a href="#h41-0-6" id="h41-0-6" class="i">+                                    Some(
</a><a href="#h41-0-7" id="h41-0-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h41-0-8" id="h41-0-8" class="i">+                                    ),
</a><a href="#h41-0-9" id="h41-0-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h41-0-10" id="h41-0-10" class="i">+                                ),
</a><a href="#h41-0-11" id="h41-0-11" class="i">+                            ),
</a>                         ),
                         None,
                     ),
<a href="#h41-1" id="h41-1" class="h">@@ -129,7 +136,12 @@ Plan: Plan(
</a>             predicate: GreaterThan(
                 Field(
                     1,
<a href="#h41-1-3" id="h41-1-3" class="d">-                    None,
</a><a href="#h41-1-4" id="h41-1-4" class="i">+                    Some(
</a><a href="#h41-1-5" id="h41-1-5" class="i">+                        (
</a><a href="#h41-1-6" id="h41-1-6" class="i">+                            None,
</a><a href="#h41-1-7" id="h41-1-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h41-1-8" id="h41-1-8" class="i">+                        ),
</a><a href="#h41-1-9" id="h41-1-9" class="i">+                    ),
</a>                 ),
                 Constant(
                     Integer(
<a href="#h41-2" id="h41-2" class="h">@@ -142,7 +154,14 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h41-2-3" id="h41-2-3" class="d">-                    None,
</a><a href="#h41-2-4" id="h41-2-4" class="i">+                    Some(
</a><a href="#h41-2-5" id="h41-2-5" class="i">+                        (
</a><a href="#h41-2-6" id="h41-2-6" class="i">+                            Some(
</a><a href="#h41-2-7" id="h41-2-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h41-2-8" id="h41-2-8" class="i">+                            ),
</a><a href="#h41-2-9" id="h41-2-9" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h41-2-10" id="h41-2-10" class="i">+                        ),
</a><a href="#h41-2-11" id="h41-2-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h41-3" id="h41-3" class="h">@@ -196,7 +215,14 @@ Optimized plan: Plan(
</a>                     (
                         Field(
                             1,
<a href="#h41-3-3" id="h41-3-3" class="d">-                            None,
</a><a href="#h41-3-4" id="h41-3-4" class="i">+                            Some(
</a><a href="#h41-3-5" id="h41-3-5" class="i">+                                (
</a><a href="#h41-3-6" id="h41-3-6" class="i">+                                    Some(
</a><a href="#h41-3-7" id="h41-3-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h41-3-8" id="h41-3-8" class="i">+                                    ),
</a><a href="#h41-3-9" id="h41-3-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h41-3-10" id="h41-3-10" class="i">+                                ),
</a><a href="#h41-3-11" id="h41-3-11" class="i">+                            ),
</a>                         ),
                         None,
                     ),
<a href="#h41-4" id="h41-4" class="h">@@ -214,7 +240,12 @@ Optimized plan: Plan(
</a>             predicate: GreaterThan(
                 Field(
                     1,
<a href="#h41-4-3" id="h41-4-3" class="d">-                    None,
</a><a href="#h41-4-4" id="h41-4-4" class="i">+                    Some(
</a><a href="#h41-4-5" id="h41-4-5" class="i">+                        (
</a><a href="#h41-4-6" id="h41-4-6" class="i">+                            None,
</a><a href="#h41-4-7" id="h41-4-7" class="i">+                            &quot;rating&quot;,
</a><a href="#h41-4-8" id="h41-4-8" class="i">+                        ),
</a><a href="#h41-4-9" id="h41-4-9" class="i">+                    ),
</a>                 ),
                 Constant(
                     Integer(
<a href="#h41-5" id="h41-5" class="h">@@ -227,7 +258,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h41-5-3" id="h41-5-3" class="d">-                    None,
</a><a href="#h41-5-4" id="h41-5-4" class="i">+                    Some(
</a><a href="#h41-5-5" id="h41-5-5" class="i">+                        (
</a><a href="#h41-5-6" id="h41-5-6" class="i">+                            Some(
</a><a href="#h41-5-7" id="h41-5-7" class="i">+                                &quot;movies&quot;,
</a><a href="#h41-5-8" id="h41-5-8" class="i">+                            ),
</a><a href="#h41-5-9" id="h41-5-9" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h41-5-10" id="h41-5-10" class="i">+                        ),
</a><a href="#h41-5-11" id="h41-5-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h41-6" id="h41-6" class="h">@@ -237,6 +275,14 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING rating &gt; 8 ORDER BY studio_id
 
<a href="#h41-6-3" id="h41-6-3" class="i">+Explain:
</a><a href="#h41-6-4" id="h41-6-4" class="i">+Order: movies.studio_id asc
</a><a href="#h41-6-5" id="h41-6-5" class="i">+└─ Filter: rating &gt; 8
</a><a href="#h41-6-6" id="h41-6-6" class="i">+   └─ Projection: movies.studio_id, #0
</a><a href="#h41-6-7" id="h41-6-7" class="i">+      └─ Aggregation: maximum
</a><a href="#h41-6-8" id="h41-6-8" class="i">+         └─ Projection: rating, studio_id
</a><a href="#h41-6-9" id="h41-6-9" class="i">+            └─ Scan: movies
</a><a href="#h41-6-10" id="h41-6-10" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;rating&quot;]
 [Integer(1), Float(8.2)]
 [Integer(4), Float(8.8)]
<b>diff --git a/<a id="h42" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -128,7 +128,14 @@ Plan: Plan(
</a>                         (
                             Field(
                                 2,
<a href="#h42-0-3" id="h42-0-3" class="d">-                                None,
</a><a href="#h42-0-4" id="h42-0-4" class="i">+                                Some(
</a><a href="#h42-0-5" id="h42-0-5" class="i">+                                    (
</a><a href="#h42-0-6" id="h42-0-6" class="i">+                                        Some(
</a><a href="#h42-0-7" id="h42-0-7" class="i">+                                            &quot;movies&quot;,
</a><a href="#h42-0-8" id="h42-0-8" class="i">+                                        ),
</a><a href="#h42-0-9" id="h42-0-9" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h42-0-10" id="h42-0-10" class="i">+                                    ),
</a><a href="#h42-0-11" id="h42-0-11" class="i">+                                ),
</a>                             ),
                             None,
                         ),
<a href="#h42-1" id="h42-1" class="h">@@ -164,7 +171,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h42-1-3" id="h42-1-3" class="d">-                        None,
</a><a href="#h42-1-4" id="h42-1-4" class="i">+                        Some(
</a><a href="#h42-1-5" id="h42-1-5" class="i">+                            (
</a><a href="#h42-1-6" id="h42-1-6" class="i">+                                Some(
</a><a href="#h42-1-7" id="h42-1-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h42-1-8" id="h42-1-8" class="i">+                                ),
</a><a href="#h42-1-9" id="h42-1-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h42-1-10" id="h42-1-10" class="i">+                            ),
</a><a href="#h42-1-11" id="h42-1-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h42-2" id="h42-2" class="h">@@ -249,7 +263,14 @@ Optimized plan: Plan(
</a>                         (
                             Field(
                                 2,
<a href="#h42-2-3" id="h42-2-3" class="d">-                                None,
</a><a href="#h42-2-4" id="h42-2-4" class="i">+                                Some(
</a><a href="#h42-2-5" id="h42-2-5" class="i">+                                    (
</a><a href="#h42-2-6" id="h42-2-6" class="i">+                                        Some(
</a><a href="#h42-2-7" id="h42-2-7" class="i">+                                            &quot;movies&quot;,
</a><a href="#h42-2-8" id="h42-2-8" class="i">+                                        ),
</a><a href="#h42-2-9" id="h42-2-9" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h42-2-10" id="h42-2-10" class="i">+                                    ),
</a><a href="#h42-2-11" id="h42-2-11" class="i">+                                ),
</a>                             ),
                             None,
                         ),
<a href="#h42-3" id="h42-3" class="h">@@ -285,7 +306,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h42-3-3" id="h42-3-3" class="d">-                        None,
</a><a href="#h42-3-4" id="h42-3-4" class="i">+                        Some(
</a><a href="#h42-3-5" id="h42-3-5" class="i">+                            (
</a><a href="#h42-3-6" id="h42-3-6" class="i">+                                Some(
</a><a href="#h42-3-7" id="h42-3-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h42-3-8" id="h42-3-8" class="i">+                                ),
</a><a href="#h42-3-9" id="h42-3-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h42-3-10" id="h42-3-10" class="i">+                            ),
</a><a href="#h42-3-11" id="h42-3-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h42-4" id="h42-4" class="h">@@ -312,6 +340,15 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id HAVING MIN(rating) &gt; 7 ORDER BY studio_id
 
<a href="#h42-4-3" id="h42-4-3" class="i">+Explain:
</a><a href="#h42-4-4" id="h42-4-4" class="i">+Projection: #0, #1
</a><a href="#h42-4-5" id="h42-4-5" class="i">+└─ Order: movies.studio_id asc
</a><a href="#h42-4-6" id="h42-4-6" class="i">+   └─ Filter: #2 &gt; 7
</a><a href="#h42-4-7" id="h42-4-7" class="i">+      └─ Projection: movies.studio_id, #0, #1
</a><a href="#h42-4-8" id="h42-4-8" class="i">+         └─ Aggregation: maximum, minimum
</a><a href="#h42-4-9" id="h42-4-9" class="i">+            └─ Projection: rating, rating, studio_id
</a><a href="#h42-4-10" id="h42-4-10" class="i">+               └─ Scan: movies
</a><a href="#h42-4-11" id="h42-4-11" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;?&quot;]
 [Integer(1), Float(8.2)]
 [Integer(2), Float(7.6)]
<b>diff --git a/<a id="h43" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -154,7 +154,14 @@ Plan: Plan(
</a>                         (
                             Field(
                                 3,
<a href="#h43-0-3" id="h43-0-3" class="d">-                                None,
</a><a href="#h43-0-4" id="h43-0-4" class="i">+                                Some(
</a><a href="#h43-0-5" id="h43-0-5" class="i">+                                    (
</a><a href="#h43-0-6" id="h43-0-6" class="i">+                                        Some(
</a><a href="#h43-0-7" id="h43-0-7" class="i">+                                            &quot;movies&quot;,
</a><a href="#h43-0-8" id="h43-0-8" class="i">+                                        ),
</a><a href="#h43-0-9" id="h43-0-9" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h43-0-10" id="h43-0-10" class="i">+                                    ),
</a><a href="#h43-0-11" id="h43-0-11" class="i">+                                ),
</a>                             ),
                             None,
                         ),
<a href="#h43-1" id="h43-1" class="h">@@ -203,7 +210,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h43-1-3" id="h43-1-3" class="d">-                        None,
</a><a href="#h43-1-4" id="h43-1-4" class="i">+                        Some(
</a><a href="#h43-1-5" id="h43-1-5" class="i">+                            (
</a><a href="#h43-1-6" id="h43-1-6" class="i">+                                Some(
</a><a href="#h43-1-7" id="h43-1-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h43-1-8" id="h43-1-8" class="i">+                                ),
</a><a href="#h43-1-9" id="h43-1-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h43-1-10" id="h43-1-10" class="i">+                            ),
</a><a href="#h43-1-11" id="h43-1-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h43-2" id="h43-2" class="h">@@ -301,7 +315,14 @@ Optimized plan: Plan(
</a>                         (
                             Field(
                                 3,
<a href="#h43-2-3" id="h43-2-3" class="d">-                                None,
</a><a href="#h43-2-4" id="h43-2-4" class="i">+                                Some(
</a><a href="#h43-2-5" id="h43-2-5" class="i">+                                    (
</a><a href="#h43-2-6" id="h43-2-6" class="i">+                                        Some(
</a><a href="#h43-2-7" id="h43-2-7" class="i">+                                            &quot;movies&quot;,
</a><a href="#h43-2-8" id="h43-2-8" class="i">+                                        ),
</a><a href="#h43-2-9" id="h43-2-9" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h43-2-10" id="h43-2-10" class="i">+                                    ),
</a><a href="#h43-2-11" id="h43-2-11" class="i">+                                ),
</a>                             ),
                             None,
                         ),
<a href="#h43-3" id="h43-3" class="h">@@ -350,7 +371,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h43-3-3" id="h43-3-3" class="d">-                        None,
</a><a href="#h43-3-4" id="h43-3-4" class="i">+                        Some(
</a><a href="#h43-3-5" id="h43-3-5" class="i">+                            (
</a><a href="#h43-3-6" id="h43-3-6" class="i">+                                Some(
</a><a href="#h43-3-7" id="h43-3-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h43-3-8" id="h43-3-8" class="i">+                                ),
</a><a href="#h43-3-9" id="h43-3-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h43-3-10" id="h43-3-10" class="i">+                            ),
</a><a href="#h43-3-11" id="h43-3-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h43-4" id="h43-4" class="h">@@ -377,6 +405,15 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id HAVING MAX(rating) - MIN(rating) &lt; 1 ORDER BY studio_id
 
<a href="#h43-4-3" id="h43-4-3" class="i">+Explain:
</a><a href="#h43-4-4" id="h43-4-4" class="i">+Projection: #0, #1
</a><a href="#h43-4-5" id="h43-4-5" class="i">+└─ Order: movies.studio_id asc
</a><a href="#h43-4-6" id="h43-4-6" class="i">+   └─ Filter: #2 - #3 &lt; 1
</a><a href="#h43-4-7" id="h43-4-7" class="i">+      └─ Projection: movies.studio_id, #0, #1, #2
</a><a href="#h43-4-8" id="h43-4-8" class="i">+         └─ Aggregation: maximum, maximum, minimum
</a><a href="#h43-4-9" id="h43-4-9" class="i">+            └─ Projection: rating, rating, rating, studio_id
</a><a href="#h43-4-10" id="h43-4-10" class="i">+               └─ Scan: movies
</a><a href="#h43-4-11" id="h43-4-11" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;?&quot;]
 [Integer(1), Float(8.2)]
 [Integer(2), Float(7.6)]
<b>diff --git a/<a id="h44" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -112,7 +112,14 @@ Plan: Plan(
</a>                         (
                             Field(
                                 1,
<a href="#h44-0-3" id="h44-0-3" class="d">-                                None,
</a><a href="#h44-0-4" id="h44-0-4" class="i">+                                Some(
</a><a href="#h44-0-5" id="h44-0-5" class="i">+                                    (
</a><a href="#h44-0-6" id="h44-0-6" class="i">+                                        Some(
</a><a href="#h44-0-7" id="h44-0-7" class="i">+                                            &quot;movies&quot;,
</a><a href="#h44-0-8" id="h44-0-8" class="i">+                                        ),
</a><a href="#h44-0-9" id="h44-0-9" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h44-0-10" id="h44-0-10" class="i">+                                    ),
</a><a href="#h44-0-11" id="h44-0-11" class="i">+                                ),
</a>                             ),
                             None,
                         ),
<a href="#h44-1" id="h44-1" class="h">@@ -143,7 +150,14 @@ Plan: Plan(
</a>                     GreaterThan(
                         Field(
                             2,
<a href="#h44-1-3" id="h44-1-3" class="d">-                            None,
</a><a href="#h44-1-4" id="h44-1-4" class="i">+                            Some(
</a><a href="#h44-1-5" id="h44-1-5" class="i">+                                (
</a><a href="#h44-1-6" id="h44-1-6" class="i">+                                    Some(
</a><a href="#h44-1-7" id="h44-1-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h44-1-8" id="h44-1-8" class="i">+                                    ),
</a><a href="#h44-1-9" id="h44-1-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h44-1-10" id="h44-1-10" class="i">+                                ),
</a><a href="#h44-1-11" id="h44-1-11" class="i">+                            ),
</a>                         ),
                         Constant(
                             Integer(
<a href="#h44-2" id="h44-2" class="h">@@ -154,7 +168,14 @@ Plan: Plan(
</a>                     Equal(
                         Field(
                             2,
<a href="#h44-2-3" id="h44-2-3" class="d">-                            None,
</a><a href="#h44-2-4" id="h44-2-4" class="i">+                            Some(
</a><a href="#h44-2-5" id="h44-2-5" class="i">+                                (
</a><a href="#h44-2-6" id="h44-2-6" class="i">+                                    Some(
</a><a href="#h44-2-7" id="h44-2-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h44-2-8" id="h44-2-8" class="i">+                                    ),
</a><a href="#h44-2-9" id="h44-2-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h44-2-10" id="h44-2-10" class="i">+                                ),
</a><a href="#h44-2-11" id="h44-2-11" class="i">+                            ),
</a>                         ),
                         Constant(
                             Integer(
<a href="#h44-3" id="h44-3" class="h">@@ -168,7 +189,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h44-3-3" id="h44-3-3" class="d">-                        None,
</a><a href="#h44-3-4" id="h44-3-4" class="i">+                        Some(
</a><a href="#h44-3-5" id="h44-3-5" class="i">+                            (
</a><a href="#h44-3-6" id="h44-3-6" class="i">+                                Some(
</a><a href="#h44-3-7" id="h44-3-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h44-3-8" id="h44-3-8" class="i">+                                ),
</a><a href="#h44-3-9" id="h44-3-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h44-3-10" id="h44-3-10" class="i">+                            ),
</a><a href="#h44-3-11" id="h44-3-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h44-4" id="h44-4" class="h">@@ -240,7 +268,14 @@ Optimized plan: Plan(
</a>                         (
                             Field(
                                 1,
<a href="#h44-4-3" id="h44-4-3" class="d">-                                None,
</a><a href="#h44-4-4" id="h44-4-4" class="i">+                                Some(
</a><a href="#h44-4-5" id="h44-4-5" class="i">+                                    (
</a><a href="#h44-4-6" id="h44-4-6" class="i">+                                        Some(
</a><a href="#h44-4-7" id="h44-4-7" class="i">+                                            &quot;movies&quot;,
</a><a href="#h44-4-8" id="h44-4-8" class="i">+                                        ),
</a><a href="#h44-4-9" id="h44-4-9" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h44-4-10" id="h44-4-10" class="i">+                                    ),
</a><a href="#h44-4-11" id="h44-4-11" class="i">+                                ),
</a>                             ),
                             None,
                         ),
<a href="#h44-5" id="h44-5" class="h">@@ -271,7 +306,14 @@ Optimized plan: Plan(
</a>                     GreaterThan(
                         Field(
                             2,
<a href="#h44-5-3" id="h44-5-3" class="d">-                            None,
</a><a href="#h44-5-4" id="h44-5-4" class="i">+                            Some(
</a><a href="#h44-5-5" id="h44-5-5" class="i">+                                (
</a><a href="#h44-5-6" id="h44-5-6" class="i">+                                    Some(
</a><a href="#h44-5-7" id="h44-5-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h44-5-8" id="h44-5-8" class="i">+                                    ),
</a><a href="#h44-5-9" id="h44-5-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h44-5-10" id="h44-5-10" class="i">+                                ),
</a><a href="#h44-5-11" id="h44-5-11" class="i">+                            ),
</a>                         ),
                         Constant(
                             Integer(
<a href="#h44-6" id="h44-6" class="h">@@ -282,7 +324,14 @@ Optimized plan: Plan(
</a>                     Equal(
                         Field(
                             2,
<a href="#h44-6-3" id="h44-6-3" class="d">-                            None,
</a><a href="#h44-6-4" id="h44-6-4" class="i">+                            Some(
</a><a href="#h44-6-5" id="h44-6-5" class="i">+                                (
</a><a href="#h44-6-6" id="h44-6-6" class="i">+                                    Some(
</a><a href="#h44-6-7" id="h44-6-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h44-6-8" id="h44-6-8" class="i">+                                    ),
</a><a href="#h44-6-9" id="h44-6-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h44-6-10" id="h44-6-10" class="i">+                                ),
</a><a href="#h44-6-11" id="h44-6-11" class="i">+                            ),
</a>                         ),
                         Constant(
                             Integer(
<a href="#h44-7" id="h44-7" class="h">@@ -296,7 +345,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h44-7-3" id="h44-7-3" class="d">-                        None,
</a><a href="#h44-7-4" id="h44-7-4" class="i">+                        Some(
</a><a href="#h44-7-5" id="h44-7-5" class="i">+                            (
</a><a href="#h44-7-6" id="h44-7-6" class="i">+                                Some(
</a><a href="#h44-7-7" id="h44-7-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h44-7-8" id="h44-7-8" class="i">+                                ),
</a><a href="#h44-7-9" id="h44-7-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h44-7-10" id="h44-7-10" class="i">+                            ),
</a><a href="#h44-7-11" id="h44-7-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h44-8" id="h44-8" class="h">@@ -323,6 +379,15 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING studio_id &gt;= 3 ORDER BY studio_id
 
<a href="#h44-8-3" id="h44-8-3" class="i">+Explain:
</a><a href="#h44-8-4" id="h44-8-4" class="i">+Projection: #0, #1
</a><a href="#h44-8-5" id="h44-8-5" class="i">+└─ Order: movies.studio_id asc
</a><a href="#h44-8-6" id="h44-8-6" class="i">+   └─ Filter: movies.studio_id &gt; 3 OR movies.studio_id = 3
</a><a href="#h44-8-7" id="h44-8-7" class="i">+      └─ Projection: movies.studio_id, #0, studio_id
</a><a href="#h44-8-8" id="h44-8-8" class="i">+         └─ Aggregation: maximum
</a><a href="#h44-8-9" id="h44-8-9" class="i">+            └─ Projection: rating, studio_id
</a><a href="#h44-8-10" id="h44-8-10" class="i">+               └─ Scan: movies
</a><a href="#h44-8-11" id="h44-8-11" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;rating&quot;]
 [Integer(3), Float(6.9)]
 [Integer(4), Float(8.8)]
<b>diff --git a/<a id="h45" href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a> b/<a href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -105,7 +105,14 @@ Plan: Plan(
</a>                 predicate: GreaterThan(
                     Field(
                         2,
<a href="#h45-0-3" id="h45-0-3" class="d">-                        None,
</a><a href="#h45-0-4" id="h45-0-4" class="i">+                        Some(
</a><a href="#h45-0-5" id="h45-0-5" class="i">+                            (
</a><a href="#h45-0-6" id="h45-0-6" class="i">+                                Some(
</a><a href="#h45-0-7" id="h45-0-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h45-0-8" id="h45-0-8" class="i">+                                ),
</a><a href="#h45-0-9" id="h45-0-9" class="i">+                                &quot;rating&quot;,
</a><a href="#h45-0-10" id="h45-0-10" class="i">+                            ),
</a><a href="#h45-0-11" id="h45-0-11" class="i">+                        ),
</a>                     ),
                     Constant(
                         Integer(
<a href="#h45-1" id="h45-1" class="h">@@ -118,7 +125,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h45-1-3" id="h45-1-3" class="d">-                        None,
</a><a href="#h45-1-4" id="h45-1-4" class="i">+                        Some(
</a><a href="#h45-1-5" id="h45-1-5" class="i">+                            (
</a><a href="#h45-1-6" id="h45-1-6" class="i">+                                Some(
</a><a href="#h45-1-7" id="h45-1-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h45-1-8" id="h45-1-8" class="i">+                                ),
</a><a href="#h45-1-9" id="h45-1-9" class="i">+                                &quot;id&quot;,
</a><a href="#h45-1-10" id="h45-1-10" class="i">+                            ),
</a><a href="#h45-1-11" id="h45-1-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h45-2" id="h45-2" class="h">@@ -195,7 +209,14 @@ Optimized plan: Plan(
</a>                 predicate: GreaterThan(
                     Field(
                         2,
<a href="#h45-2-3" id="h45-2-3" class="d">-                        None,
</a><a href="#h45-2-4" id="h45-2-4" class="i">+                        Some(
</a><a href="#h45-2-5" id="h45-2-5" class="i">+                            (
</a><a href="#h45-2-6" id="h45-2-6" class="i">+                                Some(
</a><a href="#h45-2-7" id="h45-2-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h45-2-8" id="h45-2-8" class="i">+                                ),
</a><a href="#h45-2-9" id="h45-2-9" class="i">+                                &quot;rating&quot;,
</a><a href="#h45-2-10" id="h45-2-10" class="i">+                            ),
</a><a href="#h45-2-11" id="h45-2-11" class="i">+                        ),
</a>                     ),
                     Constant(
                         Integer(
<a href="#h45-3" id="h45-3" class="h">@@ -208,7 +229,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h45-3-3" id="h45-3-3" class="d">-                        None,
</a><a href="#h45-3-4" id="h45-3-4" class="i">+                        Some(
</a><a href="#h45-3-5" id="h45-3-5" class="i">+                            (
</a><a href="#h45-3-6" id="h45-3-6" class="i">+                                Some(
</a><a href="#h45-3-7" id="h45-3-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h45-3-8" id="h45-3-8" class="i">+                                ),
</a><a href="#h45-3-9" id="h45-3-9" class="i">+                                &quot;id&quot;,
</a><a href="#h45-3-10" id="h45-3-10" class="i">+                            ),
</a><a href="#h45-3-11" id="h45-3-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h45-4" id="h45-4" class="h">@@ -235,6 +263,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT id, rating FROM movies HAVING rating &gt; 8 ORDER BY id
 
<a href="#h45-4-3" id="h45-4-3" class="i">+Explain:
</a><a href="#h45-4-4" id="h45-4-4" class="i">+Projection: #0, #1
</a><a href="#h45-4-5" id="h45-4-5" class="i">+└─ Order: movies.id asc
</a><a href="#h45-4-6" id="h45-4-6" class="i">+   └─ Filter: movies.rating &gt; 8
</a><a href="#h45-4-7" id="h45-4-7" class="i">+      └─ Projection: id, rating, rating
</a><a href="#h45-4-8" id="h45-4-8" class="i">+         └─ Scan: movies
</a><a href="#h45-4-9" id="h45-4-9" class="i">+
</a> Result: [&quot;id&quot;, &quot;rating&quot;]
 [Integer(1), Float(8.2)]
 [Integer(4), Float(8.2)]
<b>diff --git a/<a id="h46" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -103,7 +103,14 @@ Plan: Plan(
</a>                         (
                             Field(
                                 1,
<a href="#h46-0-3" id="h46-0-3" class="d">-                                None,
</a><a href="#h46-0-4" id="h46-0-4" class="i">+                                Some(
</a><a href="#h46-0-5" id="h46-0-5" class="i">+                                    (
</a><a href="#h46-0-6" id="h46-0-6" class="i">+                                        Some(
</a><a href="#h46-0-7" id="h46-0-7" class="i">+                                            &quot;movies&quot;,
</a><a href="#h46-0-8" id="h46-0-8" class="i">+                                        ),
</a><a href="#h46-0-9" id="h46-0-9" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h46-0-10" id="h46-0-10" class="i">+                                    ),
</a><a href="#h46-0-11" id="h46-0-11" class="i">+                                ),
</a>                             ),
                             None,
                         ),
<a href="#h46-1" id="h46-1" class="h">@@ -132,7 +139,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h46-1-3" id="h46-1-3" class="d">-                        None,
</a><a href="#h46-1-4" id="h46-1-4" class="i">+                        Some(
</a><a href="#h46-1-5" id="h46-1-5" class="i">+                            (
</a><a href="#h46-1-6" id="h46-1-6" class="i">+                                Some(
</a><a href="#h46-1-7" id="h46-1-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h46-1-8" id="h46-1-8" class="i">+                                ),
</a><a href="#h46-1-9" id="h46-1-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h46-1-10" id="h46-1-10" class="i">+                            ),
</a><a href="#h46-1-11" id="h46-1-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h46-2" id="h46-2" class="h">@@ -197,7 +211,14 @@ Optimized plan: Plan(
</a>                         (
                             Field(
                                 1,
<a href="#h46-2-3" id="h46-2-3" class="d">-                                None,
</a><a href="#h46-2-4" id="h46-2-4" class="i">+                                Some(
</a><a href="#h46-2-5" id="h46-2-5" class="i">+                                    (
</a><a href="#h46-2-6" id="h46-2-6" class="i">+                                        Some(
</a><a href="#h46-2-7" id="h46-2-7" class="i">+                                            &quot;movies&quot;,
</a><a href="#h46-2-8" id="h46-2-8" class="i">+                                        ),
</a><a href="#h46-2-9" id="h46-2-9" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h46-2-10" id="h46-2-10" class="i">+                                    ),
</a><a href="#h46-2-11" id="h46-2-11" class="i">+                                ),
</a>                             ),
                             None,
                         ),
<a href="#h46-3" id="h46-3" class="h">@@ -226,7 +247,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         0,
<a href="#h46-3-3" id="h46-3-3" class="d">-                        None,
</a><a href="#h46-3-4" id="h46-3-4" class="i">+                        Some(
</a><a href="#h46-3-5" id="h46-3-5" class="i">+                            (
</a><a href="#h46-3-6" id="h46-3-6" class="i">+                                Some(
</a><a href="#h46-3-7" id="h46-3-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h46-3-8" id="h46-3-8" class="i">+                                ),
</a><a href="#h46-3-9" id="h46-3-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h46-3-10" id="h46-3-10" class="i">+                            ),
</a><a href="#h46-3-11" id="h46-3-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h46-4" id="h46-4" class="h">@@ -246,6 +274,15 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id FROM movies GROUP BY studio_id HAVING MAX(rating) &gt; 8 ORDER BY studio_id
 
<a href="#h46-4-3" id="h46-4-3" class="i">+Explain:
</a><a href="#h46-4-4" id="h46-4-4" class="i">+Projection: #0
</a><a href="#h46-4-5" id="h46-4-5" class="i">+└─ Order: movies.studio_id asc
</a><a href="#h46-4-6" id="h46-4-6" class="i">+   └─ Filter: #1 &gt; 8
</a><a href="#h46-4-7" id="h46-4-7" class="i">+      └─ Projection: movies.studio_id, #0
</a><a href="#h46-4-8" id="h46-4-8" class="i">+         └─ Aggregation: maximum
</a><a href="#h46-4-9" id="h46-4-9" class="i">+            └─ Projection: rating, studio_id
</a><a href="#h46-4-10" id="h46-4-10" class="i">+               └─ Scan: movies
</a><a href="#h46-4-11" id="h46-4-11" class="i">+
</a> Result: [&quot;studio_id&quot;]
 [Integer(1)]
 [Integer(4)]
<b>diff --git a/<a id="h47" href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a> b/<a href="../file/tests/sql/query/join_cross.html">tests/sql/query/join_cross</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -64,6 +64,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies CROSS JOIN genres
 
<a href="#h47-0-3" id="h47-0-3" class="i">+Explain:
</a><a href="#h47-0-4" id="h47-0-4" class="i">+NestedLoopJoin: inner
</a><a href="#h47-0-5" id="h47-0-5" class="i">+├─ Scan: movies
</a><a href="#h47-0-6" id="h47-0-6" class="i">+└─ Scan: genres
</a><a href="#h47-0-7" id="h47-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h48" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -551,6 +551,14 @@ Query:
</a>         WHERE m.id &gt;= 3 AND g.id = 2 AND c.id != &#39;us&#39;
     
 
<a href="#h48-0-3" id="h48-0-3" class="i">+Explain:
</a><a href="#h48-0-4" id="h48-0-4" class="i">+Projection: m.id, m.title, g.id, g.name, c.id, c.name
</a><a href="#h48-0-5" id="h48-0-5" class="i">+└─ NestedLoopJoin: inner
</a><a href="#h48-0-6" id="h48-0-6" class="i">+   ├─ NestedLoopJoin: inner
</a><a href="#h48-0-7" id="h48-0-7" class="i">+   │  ├─ Scan: movies (m.id &gt; 3 OR m.id = 3)
</a><a href="#h48-0-8" id="h48-0-8" class="i">+   │  └─ KeyLookup: genres (2)
</a><a href="#h48-0-9" id="h48-0-9" class="i">+   └─ Scan: countries (NOT c.id = us)
</a><a href="#h48-0-10" id="h48-0-10" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;id&quot;, &quot;name&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(3), String(&quot;Primer&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
<b>diff --git a/<a id="h49" href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a> b/<a href="../file/tests/sql/query/join_cross_multi.html">tests/sql/query/join_cross_multi</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -124,6 +124,15 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies CROSS JOIN genres CROSS JOIN countries CROSS JOIN studios
 
<a href="#h49-0-3" id="h49-0-3" class="i">+Explain:
</a><a href="#h49-0-4" id="h49-0-4" class="i">+NestedLoopJoin: inner
</a><a href="#h49-0-5" id="h49-0-5" class="i">+├─ NestedLoopJoin: inner
</a><a href="#h49-0-6" id="h49-0-6" class="i">+│  ├─ NestedLoopJoin: inner
</a><a href="#h49-0-7" id="h49-0-7" class="i">+│  │  ├─ Scan: movies
</a><a href="#h49-0-8" id="h49-0-8" class="i">+│  │  └─ Scan: genres
</a><a href="#h49-0-9" id="h49-0-9" class="i">+│  └─ Scan: countries
</a><a href="#h49-0-10" id="h49-0-10" class="i">+└─ Scan: studios
</a><a href="#h49-0-11" id="h49-0-11" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;, &quot;id&quot;, &quot;name&quot;, &quot;id&quot;, &quot;name&quot;, &quot;country_id&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
<b>diff --git a/<a id="h50" href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a> b/<a href="../file/tests/sql/query/join_inner.html">tests/sql/query/join_inner</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -131,6 +131,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies INNER JOIN genres ON movies.genre_id = genres.id
 
<a href="#h50-0-3" id="h50-0-3" class="i">+Explain:
</a><a href="#h50-0-4" id="h50-0-4" class="i">+NestedLoopJoin: inner on movies.genre_id = genres.id
</a><a href="#h50-0-5" id="h50-0-5" class="i">+├─ Scan: movies
</a><a href="#h50-0-6" id="h50-0-6" class="i">+└─ Scan: genres
</a><a href="#h50-0-7" id="h50-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h51" href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a> b/<a href="../file/tests/sql/query/join_inner_implicit.html">tests/sql/query/join_inner_implicit</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -131,6 +131,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies JOIN genres ON movies.genre_id = genres.id
 
<a href="#h51-0-3" id="h51-0-3" class="i">+Explain:
</a><a href="#h51-0-4" id="h51-0-4" class="i">+NestedLoopJoin: inner on movies.genre_id = genres.id
</a><a href="#h51-0-5" id="h51-0-5" class="i">+├─ Scan: movies
</a><a href="#h51-0-6" id="h51-0-6" class="i">+└─ Scan: genres
</a><a href="#h51-0-7" id="h51-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h52" href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse.html">tests/sql/query/join_inner_index_transverse</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -191,4 +191,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id AND g.id = 4
 
<a href="#h52-0-3" id="h52-0-3" class="i">+Explain:
</a><a href="#h52-0-4" id="h52-0-4" class="i">+NestedLoopJoin: inner on m.genre_id = g.id
</a><a href="#h52-0-5" id="h52-0-5" class="i">+├─ IndexLookup: movies.genre_id (4)
</a><a href="#h52-0-6" id="h52-0-6" class="i">+└─ KeyLookup: genres (4)
</a><a href="#h52-0-7" id="h52-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<b>diff --git a/<a id="h53" href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -188,4 +188,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id WHERE g.id = 4
 
<a href="#h53-0-3" id="h53-0-3" class="i">+Explain:
</a><a href="#h53-0-4" id="h53-0-4" class="i">+NestedLoopJoin: inner on m.genre_id = g.id
</a><a href="#h53-0-5" id="h53-0-5" class="i">+├─ IndexLookup: movies.genre_id (4)
</a><a href="#h53-0-6" id="h53-0-6" class="i">+└─ KeyLookup: genres (4)
</a><a href="#h53-0-7" id="h53-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<b>diff --git a/<a id="h54" href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a> b/<a href="../file/tests/sql/query/join_inner_multi.html">tests/sql/query/join_inner_multi</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -368,6 +368,14 @@ Query:
</a>             INNER JOIN genres ON movies.genre_id = genres.id
             INNER JOIN studios ON movies.studio_id = studios.id
 
<a href="#h54-0-3" id="h54-0-3" class="i">+Explain:
</a><a href="#h54-0-4" id="h54-0-4" class="i">+Projection: movies.title, genres.name, studios.name
</a><a href="#h54-0-5" id="h54-0-5" class="i">+└─ NestedLoopJoin: inner on movies.studio_id = studios.id
</a><a href="#h54-0-6" id="h54-0-6" class="i">+   ├─ NestedLoopJoin: inner on movies.genre_id = genres.id
</a><a href="#h54-0-7" id="h54-0-7" class="i">+   │  ├─ Scan: movies
</a><a href="#h54-0-8" id="h54-0-8" class="i">+   │  └─ Scan: genres
</a><a href="#h54-0-9" id="h54-0-9" class="i">+   └─ Scan: studios
</a><a href="#h54-0-10" id="h54-0-10" class="i">+
</a> Result: [&quot;title&quot;, &quot;genre&quot;, &quot;studio&quot;]
 [String(&quot;Stalker&quot;), String(&quot;Science Fiction&quot;), String(&quot;Mosfilm&quot;)]
 [String(&quot;Sicario&quot;), String(&quot;Action&quot;), String(&quot;Lionsgate&quot;)]
<b>diff --git a/<a id="h55" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -336,7 +336,14 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h55-0-3" id="h55-0-3" class="d">-                    None,
</a><a href="#h55-0-4" id="h55-0-4" class="i">+                    Some(
</a><a href="#h55-0-5" id="h55-0-5" class="i">+                        (
</a><a href="#h55-0-6" id="h55-0-6" class="i">+                            Some(
</a><a href="#h55-0-7" id="h55-0-7" class="i">+                                &quot;m&quot;,
</a><a href="#h55-0-8" id="h55-0-8" class="i">+                            ),
</a><a href="#h55-0-9" id="h55-0-9" class="i">+                            &quot;title&quot;,
</a><a href="#h55-0-10" id="h55-0-10" class="i">+                        ),
</a><a href="#h55-0-11" id="h55-0-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h55-1" id="h55-1" class="h">@@ -516,7 +523,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h55-1-3" id="h55-1-3" class="d">-                    None,
</a><a href="#h55-1-4" id="h55-1-4" class="i">+                    Some(
</a><a href="#h55-1-5" id="h55-1-5" class="i">+                        (
</a><a href="#h55-1-6" id="h55-1-6" class="i">+                            Some(
</a><a href="#h55-1-7" id="h55-1-7" class="i">+                                &quot;m&quot;,
</a><a href="#h55-1-8" id="h55-1-8" class="i">+                            ),
</a><a href="#h55-1-9" id="h55-1-9" class="i">+                            &quot;title&quot;,
</a><a href="#h55-1-10" id="h55-1-10" class="i">+                        ),
</a><a href="#h55-1-11" id="h55-1-11" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h55-2" id="h55-2" class="h">@@ -531,6 +545,16 @@ Query:
</a>             INNER JOIN studios s ON m.studio_id = s.id AND s.id = 4
         ORDER BY m.title
 
<a href="#h55-2-3" id="h55-2-3" class="i">+Explain:
</a><a href="#h55-2-4" id="h55-2-4" class="i">+Order: m.title asc
</a><a href="#h55-2-5" id="h55-2-5" class="i">+└─ Projection: m.title, g.name, s.name
</a><a href="#h55-2-6" id="h55-2-6" class="i">+   └─ NestedLoopJoin: inner on m.studio_id = s.id
</a><a href="#h55-2-7" id="h55-2-7" class="i">+      ├─ NestedLoopJoin: inner on m.genre_id = g.id
</a><a href="#h55-2-8" id="h55-2-8" class="i">+      │  ├─ Filter: m.genre_id = 1
</a><a href="#h55-2-9" id="h55-2-9" class="i">+      │  │  └─ IndexLookup: movies.studio_id (4)
</a><a href="#h55-2-10" id="h55-2-10" class="i">+      │  └─ KeyLookup: genres (1)
</a><a href="#h55-2-11" id="h55-2-11" class="i">+      └─ KeyLookup: studios (4)
</a><a href="#h55-2-12" id="h55-2-12" class="i">+
</a> Result: [&quot;title&quot;, &quot;genre&quot;, &quot;studio&quot;]
 [String(&quot;Gravity&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
 [String(&quot;Inception&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
<b>diff --git a/<a id="h56" href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a> b/<a href="../file/tests/sql/query/join_inner_on_aliased.html">tests/sql/query/join_inner_on_aliased</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -143,6 +143,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id
 
<a href="#h56-0-3" id="h56-0-3" class="i">+Explain:
</a><a href="#h56-0-4" id="h56-0-4" class="i">+NestedLoopJoin: inner on m.genre_id = g.id
</a><a href="#h56-0-5" id="h56-0-5" class="i">+├─ Scan: movies
</a><a href="#h56-0-6" id="h56-0-6" class="i">+└─ Scan: genres
</a><a href="#h56-0-7" id="h56-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h57" href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a> b/<a href="../file/tests/sql/query/join_inner_on_false.html">tests/sql/query/join_inner_on_false</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -82,4 +82,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies INNER JOIN genres ON FALSE
 
<a href="#h57-0-3" id="h57-0-3" class="i">+Explain:
</a><a href="#h57-0-4" id="h57-0-4" class="i">+NestedLoopJoin: inner
</a><a href="#h57-0-5" id="h57-0-5" class="i">+├─ Scan: movies (FALSE)
</a><a href="#h57-0-6" id="h57-0-6" class="i">+└─ Scan: genres
</a><a href="#h57-0-7" id="h57-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<b>diff --git a/<a id="h58" href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a> b/<a href="../file/tests/sql/query/join_inner_on_multi.html">tests/sql/query/join_inner_on_multi</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -203,6 +203,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies INNER JOIN genres ON movies.genre_id = genres.id AND movies.id = genres.id
 
<a href="#h58-0-3" id="h58-0-3" class="i">+Explain:
</a><a href="#h58-0-4" id="h58-0-4" class="i">+NestedLoopJoin: inner on movies.genre_id = genres.id AND movies.id = genres.id
</a><a href="#h58-0-5" id="h58-0-5" class="i">+├─ Scan: movies
</a><a href="#h58-0-6" id="h58-0-6" class="i">+└─ Scan: genres
</a><a href="#h58-0-7" id="h58-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h59" href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a> b/<a href="../file/tests/sql/query/join_inner_on_true.html">tests/sql/query/join_inner_on_true</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -82,6 +82,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies INNER JOIN genres ON TRUE
 
<a href="#h59-0-3" id="h59-0-3" class="i">+Explain:
</a><a href="#h59-0-4" id="h59-0-4" class="i">+NestedLoopJoin: inner
</a><a href="#h59-0-5" id="h59-0-5" class="i">+├─ Scan: movies (TRUE)
</a><a href="#h59-0-6" id="h59-0-6" class="i">+└─ Scan: genres
</a><a href="#h59-0-7" id="h59-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h60" href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a> b/<a href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -226,6 +226,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies INNER JOIN genres ON movies.genre_id = genres.id WHERE movies.id &gt;= 3
 
<a href="#h60-0-3" id="h60-0-3" class="i">+Explain:
</a><a href="#h60-0-4" id="h60-0-4" class="i">+NestedLoopJoin: inner on movies.genre_id = genres.id
</a><a href="#h60-0-5" id="h60-0-5" class="i">+├─ Scan: movies (movies.id &gt; 3 OR movies.id = 3)
</a><a href="#h60-0-6" id="h60-0-6" class="i">+└─ Scan: genres
</a><a href="#h60-0-7" id="h60-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h61" href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a> b/<a href="../file/tests/sql/query/join_left.html">tests/sql/query/join_left</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -238,6 +238,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT m.id AS movie_id, g.id AS genre_id FROM movies m LEFT JOIN genres g ON m.id = g.id
 
<a href="#h61-0-3" id="h61-0-3" class="i">+Explain:
</a><a href="#h61-0-4" id="h61-0-4" class="i">+Projection: m.id, g.id
</a><a href="#h61-0-5" id="h61-0-5" class="i">+└─ NestedLoopJoin: left outer on m.id = g.id
</a><a href="#h61-0-6" id="h61-0-6" class="i">+   ├─ Scan: movies
</a><a href="#h61-0-7" id="h61-0-7" class="i">+   └─ Scan: genres
</a><a href="#h61-0-8" id="h61-0-8" class="i">+
</a> Result: [&quot;movie_id&quot;, &quot;genre_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<b>diff --git a/<a id="h62" href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a> b/<a href="../file/tests/sql/query/join_left_outer.html">tests/sql/query/join_left_outer</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -238,6 +238,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT m.id AS movie_id, g.id AS genre_id FROM movies m LEFT OUTER JOIN genres g ON m.id = g.id
 
<a href="#h62-0-3" id="h62-0-3" class="i">+Explain:
</a><a href="#h62-0-4" id="h62-0-4" class="i">+Projection: m.id, g.id
</a><a href="#h62-0-5" id="h62-0-5" class="i">+└─ NestedLoopJoin: left outer on m.id = g.id
</a><a href="#h62-0-6" id="h62-0-6" class="i">+   ├─ Scan: movies
</a><a href="#h62-0-7" id="h62-0-7" class="i">+   └─ Scan: genres
</a><a href="#h62-0-8" id="h62-0-8" class="i">+
</a> Result: [&quot;movie_id&quot;, &quot;genre_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<b>diff --git a/<a id="h63" href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a> b/<a href="../file/tests/sql/query/join_left_truncate.html">tests/sql/query/join_left_truncate</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -238,6 +238,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT g.id AS genre_id, m.id AS movie_id FROM genres g LEFT JOIN movies m ON m.id = g.id
 
<a href="#h63-0-3" id="h63-0-3" class="i">+Explain:
</a><a href="#h63-0-4" id="h63-0-4" class="i">+Projection: g.id, m.id
</a><a href="#h63-0-5" id="h63-0-5" class="i">+└─ NestedLoopJoin: left outer on m.id = g.id
</a><a href="#h63-0-6" id="h63-0-6" class="i">+   ├─ Scan: genres
</a><a href="#h63-0-7" id="h63-0-7" class="i">+   └─ Scan: movies
</a><a href="#h63-0-8" id="h63-0-8" class="i">+
</a> Result: [&quot;genre_id&quot;, &quot;movie_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<b>diff --git a/<a id="h64" href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a> b/<a href="../file/tests/sql/query/join_right.html">tests/sql/query/join_right</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -238,6 +238,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT g.id AS genre_id, m.id AS movie_id FROM genres g RIGHT JOIN movies m ON m.id = g.id
 
<a href="#h64-0-3" id="h64-0-3" class="i">+Explain:
</a><a href="#h64-0-4" id="h64-0-4" class="i">+Projection: g.id, m.id
</a><a href="#h64-0-5" id="h64-0-5" class="i">+└─ NestedLoopJoin: right outer on m.id = g.id
</a><a href="#h64-0-6" id="h64-0-6" class="i">+   ├─ Scan: genres
</a><a href="#h64-0-7" id="h64-0-7" class="i">+   └─ Scan: movies
</a><a href="#h64-0-8" id="h64-0-8" class="i">+
</a> Result: [&quot;genre_id&quot;, &quot;movie_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<b>diff --git a/<a id="h65" href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a> b/<a href="../file/tests/sql/query/join_right_outer.html">tests/sql/query/join_right_outer</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -238,6 +238,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT g.id AS genre_id, m.id AS movie_id FROM genres g RIGHT OUTER JOIN movies m ON m.id = g.id
 
<a href="#h65-0-3" id="h65-0-3" class="i">+Explain:
</a><a href="#h65-0-4" id="h65-0-4" class="i">+Projection: g.id, m.id
</a><a href="#h65-0-5" id="h65-0-5" class="i">+└─ NestedLoopJoin: right outer on m.id = g.id
</a><a href="#h65-0-6" id="h65-0-6" class="i">+   ├─ Scan: genres
</a><a href="#h65-0-7" id="h65-0-7" class="i">+   └─ Scan: movies
</a><a href="#h65-0-8" id="h65-0-8" class="i">+
</a> Result: [&quot;genre_id&quot;, &quot;movie_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<b>diff --git a/<a id="h66" href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a> b/<a href="../file/tests/sql/query/join_right_truncate.html">tests/sql/query/join_right_truncate</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -238,6 +238,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT m.id AS movie_id, g.id AS genre_id FROM movies m RIGHT JOIN genres g ON m.id = g.id
 
<a href="#h66-0-3" id="h66-0-3" class="i">+Explain:
</a><a href="#h66-0-4" id="h66-0-4" class="i">+Projection: m.id, g.id
</a><a href="#h66-0-5" id="h66-0-5" class="i">+└─ NestedLoopJoin: right outer on m.id = g.id
</a><a href="#h66-0-6" id="h66-0-6" class="i">+   ├─ Scan: movies
</a><a href="#h66-0-7" id="h66-0-7" class="i">+   └─ Scan: genres
</a><a href="#h66-0-8" id="h66-0-8" class="i">+
</a> Result: [&quot;movie_id&quot;, &quot;genre_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<b>diff --git a/<a id="h67" href="../file/tests/sql/query/limit.html">tests/sql/query/limit</a> b/<a href="../file/tests/sql/query/limit.html">tests/sql/query/limit</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -46,6 +46,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies LIMIT 3
 
<a href="#h67-0-3" id="h67-0-3" class="i">+Explain:
</a><a href="#h67-0-4" id="h67-0-4" class="i">+Limit: 3
</a><a href="#h67-0-5" id="h67-0-5" class="i">+└─ Scan: movies
</a><a href="#h67-0-6" id="h67-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h68" href="../file/tests/sql/query/limit_expr.html">tests/sql/query/limit_expr</a> b/<a href="../file/tests/sql/query/limit_expr.html">tests/sql/query/limit_expr</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -55,6 +55,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies LIMIT 1 + 2
 
<a href="#h68-0-3" id="h68-0-3" class="i">+Explain:
</a><a href="#h68-0-4" id="h68-0-4" class="i">+Limit: 3
</a><a href="#h68-0-5" id="h68-0-5" class="i">+└─ Scan: movies
</a><a href="#h68-0-6" id="h68-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h69" href="../file/tests/sql/query/limit_large.html">tests/sql/query/limit_large</a> b/<a href="../file/tests/sql/query/limit_large.html">tests/sql/query/limit_large</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -46,6 +46,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies LIMIT 9223372036854775807
 
<a href="#h69-0-3" id="h69-0-3" class="i">+Explain:
</a><a href="#h69-0-4" id="h69-0-4" class="i">+Limit: 9223372036854775807
</a><a href="#h69-0-5" id="h69-0-5" class="i">+└─ Scan: movies
</a><a href="#h69-0-6" id="h69-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h70" href="../file/tests/sql/query/limit_offset.html">tests/sql/query/limit_offset</a> b/<a href="../file/tests/sql/query/limit_offset.html">tests/sql/query/limit_offset</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -58,6 +58,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies LIMIT 2 OFFSET 1
 
<a href="#h70-0-3" id="h70-0-3" class="i">+Explain:
</a><a href="#h70-0-4" id="h70-0-4" class="i">+Limit: 2
</a><a href="#h70-0-5" id="h70-0-5" class="i">+└─ Offset: 1
</a><a href="#h70-0-6" id="h70-0-6" class="i">+   └─ Scan: movies
</a><a href="#h70-0-7" id="h70-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
<b>diff --git a/<a id="h71" href="../file/tests/sql/query/limit_zero.html">tests/sql/query/limit_zero</a> b/<a href="../file/tests/sql/query/limit_zero.html">tests/sql/query/limit_zero</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -46,4 +46,8 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies LIMIT 0
 
<a href="#h71-0-3" id="h71-0-3" class="i">+Explain:
</a><a href="#h71-0-4" id="h71-0-4" class="i">+Limit: 0
</a><a href="#h71-0-5" id="h71-0-5" class="i">+└─ Scan: movies
</a><a href="#h71-0-6" id="h71-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<b>diff --git a/<a id="h72" href="../file/tests/sql/query/lowercase.html">tests/sql/query/lowercase</a> b/<a href="../file/tests/sql/query/lowercase.html">tests/sql/query/lowercase</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -54,5 +54,9 @@ Optimized plan: Plan(
</a> 
 Query: select 1
 
<a href="#h72-0-3" id="h72-0-3" class="i">+Explain:
</a><a href="#h72-0-4" id="h72-0-4" class="i">+Projection: 1
</a><a href="#h72-0-5" id="h72-0-5" class="i">+└─ Nothing
</a><a href="#h72-0-6" id="h72-0-6" class="i">+
</a> Result: [&quot;?&quot;]
 [Integer(1)]
<b>diff --git a/<a id="h73" href="../file/tests/sql/query/offset.html">tests/sql/query/offset</a> b/<a href="../file/tests/sql/query/offset.html">tests/sql/query/offset</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -46,6 +46,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies OFFSET 3
 
<a href="#h73-0-3" id="h73-0-3" class="i">+Explain:
</a><a href="#h73-0-4" id="h73-0-4" class="i">+Offset: 3
</a><a href="#h73-0-5" id="h73-0-5" class="i">+└─ Scan: movies
</a><a href="#h73-0-6" id="h73-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<b>diff --git a/<a id="h74" href="../file/tests/sql/query/offset_expr.html">tests/sql/query/offset_expr</a> b/<a href="../file/tests/sql/query/offset_expr.html">tests/sql/query/offset_expr</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -55,6 +55,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies OFFSET 1 + 2
 
<a href="#h74-0-3" id="h74-0-3" class="i">+Explain:
</a><a href="#h74-0-4" id="h74-0-4" class="i">+Offset: 3
</a><a href="#h74-0-5" id="h74-0-5" class="i">+└─ Scan: movies
</a><a href="#h74-0-6" id="h74-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<b>diff --git a/<a id="h75" href="../file/tests/sql/query/offset_large.html">tests/sql/query/offset_large</a> b/<a href="../file/tests/sql/query/offset_large.html">tests/sql/query/offset_large</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -46,4 +46,8 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies OFFSET 9223372036854775807
 
<a href="#h75-0-3" id="h75-0-3" class="i">+Explain:
</a><a href="#h75-0-4" id="h75-0-4" class="i">+Offset: 9223372036854775807
</a><a href="#h75-0-5" id="h75-0-5" class="i">+└─ Scan: movies
</a><a href="#h75-0-6" id="h75-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<b>diff --git a/<a id="h76" href="../file/tests/sql/query/offset_zero.html">tests/sql/query/offset_zero</a> b/<a href="../file/tests/sql/query/offset_zero.html">tests/sql/query/offset_zero</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -46,6 +46,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies OFFSET 0
 
<a href="#h76-0-3" id="h76-0-3" class="i">+Explain:
</a><a href="#h76-0-4" id="h76-0-4" class="i">+Offset: 0
</a><a href="#h76-0-5" id="h76-0-5" class="i">+└─ Scan: movies
</a><a href="#h76-0-6" id="h76-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h77" href="../file/tests/sql/query/order.html">tests/sql/query/order</a> b/<a href="../file/tests/sql/query/order.html">tests/sql/query/order</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies ORDER BY released
 
<a href="#h77-0-3" id="h77-0-3" class="i">+Explain:
</a><a href="#h77-0-4" id="h77-0-4" class="i">+Order: released asc
</a><a href="#h77-0-5" id="h77-0-5" class="i">+└─ Scan: movies
</a><a href="#h77-0-6" id="h77-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
<b>diff --git a/<a id="h78" href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a> b/<a href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -99,7 +99,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h78-0-3" id="h78-0-3" class="d">-                        None,
</a><a href="#h78-0-4" id="h78-0-4" class="i">+                        Some(
</a><a href="#h78-0-5" id="h78-0-5" class="i">+                            (
</a><a href="#h78-0-6" id="h78-0-6" class="i">+                                Some(
</a><a href="#h78-0-7" id="h78-0-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h78-0-8" id="h78-0-8" class="i">+                                ),
</a><a href="#h78-0-9" id="h78-0-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h78-0-10" id="h78-0-10" class="i">+                            ),
</a><a href="#h78-0-11" id="h78-0-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h78-1" id="h78-1" class="h">@@ -169,7 +176,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h78-1-3" id="h78-1-3" class="d">-                        None,
</a><a href="#h78-1-4" id="h78-1-4" class="i">+                        Some(
</a><a href="#h78-1-5" id="h78-1-5" class="i">+                            (
</a><a href="#h78-1-6" id="h78-1-6" class="i">+                                Some(
</a><a href="#h78-1-7" id="h78-1-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h78-1-8" id="h78-1-8" class="i">+                                ),
</a><a href="#h78-1-9" id="h78-1-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h78-1-10" id="h78-1-10" class="i">+                            ),
</a><a href="#h78-1-11" id="h78-1-11" class="i">+                        ),
</a>                     ),
                     None,
                 ),
<a href="#h78-2" id="h78-2" class="h">@@ -196,6 +210,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX(rating)
 
<a href="#h78-2-3" id="h78-2-3" class="i">+Explain:
</a><a href="#h78-2-4" id="h78-2-4" class="i">+Order: #1 asc
</a><a href="#h78-2-5" id="h78-2-5" class="i">+└─ Projection: movies.studio_id, #0
</a><a href="#h78-2-6" id="h78-2-6" class="i">+   └─ Aggregation: maximum
</a><a href="#h78-2-7" id="h78-2-7" class="i">+      └─ Projection: rating, studio_id
</a><a href="#h78-2-8" id="h78-2-8" class="i">+         └─ Scan: movies
</a><a href="#h78-2-9" id="h78-2-9" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;?&quot;]
 [Integer(3), Float(6.9)]
 [Integer(2), Float(7.6)]
<b>diff --git a/<a id="h79" href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a> b/<a href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -113,7 +113,14 @@ Plan: Plan(
</a>                     (
                         Field(
                             2,
<a href="#h79-0-3" id="h79-0-3" class="d">-                            None,
</a><a href="#h79-0-4" id="h79-0-4" class="i">+                            Some(
</a><a href="#h79-0-5" id="h79-0-5" class="i">+                                (
</a><a href="#h79-0-6" id="h79-0-6" class="i">+                                    Some(
</a><a href="#h79-0-7" id="h79-0-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h79-0-8" id="h79-0-8" class="i">+                                    ),
</a><a href="#h79-0-9" id="h79-0-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h79-0-10" id="h79-0-10" class="i">+                                ),
</a><a href="#h79-0-11" id="h79-0-11" class="i">+                            ),
</a>                         ),
                         None,
                     ),
<a href="#h79-1" id="h79-1" class="h">@@ -221,7 +228,14 @@ Optimized plan: Plan(
</a>                     (
                         Field(
                             2,
<a href="#h79-1-3" id="h79-1-3" class="d">-                            None,
</a><a href="#h79-1-4" id="h79-1-4" class="i">+                            Some(
</a><a href="#h79-1-5" id="h79-1-5" class="i">+                                (
</a><a href="#h79-1-6" id="h79-1-6" class="i">+                                    Some(
</a><a href="#h79-1-7" id="h79-1-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h79-1-8" id="h79-1-8" class="i">+                                    ),
</a><a href="#h79-1-9" id="h79-1-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h79-1-10" id="h79-1-10" class="i">+                                ),
</a><a href="#h79-1-11" id="h79-1-11" class="i">+                            ),
</a>                         ),
                         None,
                     ),
<a href="#h79-2" id="h79-2" class="h">@@ -272,6 +286,14 @@ Optimized plan: Plan(
</a> 
 Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MIN(rating)
 
<a href="#h79-2-3" id="h79-2-3" class="i">+Explain:
</a><a href="#h79-2-4" id="h79-2-4" class="i">+Projection: #0, #1
</a><a href="#h79-2-5" id="h79-2-5" class="i">+└─ Order: #2 asc
</a><a href="#h79-2-6" id="h79-2-6" class="i">+   └─ Projection: movies.studio_id, #0, #1
</a><a href="#h79-2-7" id="h79-2-7" class="i">+      └─ Aggregation: maximum, minimum
</a><a href="#h79-2-8" id="h79-2-8" class="i">+         └─ Projection: rating, rating, studio_id
</a><a href="#h79-2-9" id="h79-2-9" class="i">+            └─ Scan: movies
</a><a href="#h79-2-10" id="h79-2-10" class="i">+
</a> Result: [&quot;studio_id&quot;, &quot;?&quot;]
 [Integer(3), Float(6.9)]
 [Integer(4), Float(8.8)]
<b>diff --git a/<a id="h80" href="../file/tests/sql/query/order_asc.html">tests/sql/query/order_asc</a> b/<a href="../file/tests/sql/query/order_asc.html">tests/sql/query/order_asc</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies ORDER BY released ASC
 
<a href="#h80-0-3" id="h80-0-3" class="i">+Explain:
</a><a href="#h80-0-4" id="h80-0-4" class="i">+Order: released asc
</a><a href="#h80-0-5" id="h80-0-5" class="i">+└─ Scan: movies
</a><a href="#h80-0-6" id="h80-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
<b>diff --git a/<a id="h81" href="../file/tests/sql/query/order_asc_lowercase.html">tests/sql/query/order_asc_lowercase</a> b/<a href="../file/tests/sql/query/order_asc_lowercase.html">tests/sql/query/order_asc_lowercase</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies ORDER BY released asc
 
<a href="#h81-0-3" id="h81-0-3" class="i">+Explain:
</a><a href="#h81-0-4" id="h81-0-4" class="i">+Order: released asc
</a><a href="#h81-0-5" id="h81-0-5" class="i">+└─ Scan: movies
</a><a href="#h81-0-6" id="h81-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
<b>diff --git a/<a id="h82" href="../file/tests/sql/query/order_boolean_asc.html">tests/sql/query/order_boolean_asc</a> b/<a href="../file/tests/sql/query/order_boolean_asc.html">tests/sql/query/order_boolean_asc</a></b>
<a href="#h82-0" id="h82-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM booleans ORDER BY value ASC
 
<a href="#h82-0-3" id="h82-0-3" class="i">+Explain:
</a><a href="#h82-0-4" id="h82-0-4" class="i">+Order: value asc
</a><a href="#h82-0-5" id="h82-0-5" class="i">+└─ Scan: booleans
</a><a href="#h82-0-6" id="h82-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(2), Null]
 [Integer(3), Boolean(false)]
<b>diff --git a/<a id="h83" href="../file/tests/sql/query/order_boolean_desc.html">tests/sql/query/order_boolean_desc</a> b/<a href="../file/tests/sql/query/order_boolean_desc.html">tests/sql/query/order_boolean_desc</a></b>
<a href="#h83-0" id="h83-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM booleans ORDER BY value DESC
 
<a href="#h83-0-3" id="h83-0-3" class="i">+Explain:
</a><a href="#h83-0-4" id="h83-0-4" class="i">+Order: value desc
</a><a href="#h83-0-5" id="h83-0-5" class="i">+└─ Scan: booleans
</a><a href="#h83-0-6" id="h83-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(1), Boolean(true)]
 [Integer(3), Boolean(false)]
<b>diff --git a/<a id="h84" href="../file/tests/sql/query/order_desc.html">tests/sql/query/order_desc</a> b/<a href="../file/tests/sql/query/order_desc.html">tests/sql/query/order_desc</a></b>
<a href="#h84-0" id="h84-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies ORDER BY released DESC
 
<a href="#h84-0-3" id="h84-0-3" class="i">+Explain:
</a><a href="#h84-0-4" id="h84-0-4" class="i">+Order: released desc
</a><a href="#h84-0-5" id="h84-0-5" class="i">+└─ Scan: movies
</a><a href="#h84-0-6" id="h84-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h85" href="../file/tests/sql/query/order_desc_lowercase.html">tests/sql/query/order_desc_lowercase</a> b/<a href="../file/tests/sql/query/order_desc_lowercase.html">tests/sql/query/order_desc_lowercase</a></b>
<a href="#h85-0" id="h85-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies ORDER BY released desc
 
<a href="#h85-0-3" id="h85-0-3" class="i">+Explain:
</a><a href="#h85-0-4" id="h85-0-4" class="i">+Order: released desc
</a><a href="#h85-0-5" id="h85-0-5" class="i">+└─ Scan: movies
</a><a href="#h85-0-6" id="h85-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h86" href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a> b/<a href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a></b>
<a href="#h86-0" id="h86-0" class="h">@@ -145,7 +145,12 @@ Plan: Plan(
</a>             (
                 Field(
                     3,
<a href="#h86-0-3" id="h86-0-3" class="d">-                    None,
</a><a href="#h86-0-4" id="h86-0-4" class="i">+                    Some(
</a><a href="#h86-0-5" id="h86-0-5" class="i">+                        (
</a><a href="#h86-0-6" id="h86-0-6" class="i">+                            None,
</a><a href="#h86-0-7" id="h86-0-7" class="i">+                            &quot;ord&quot;,
</a><a href="#h86-0-8" id="h86-0-8" class="i">+                        ),
</a><a href="#h86-0-9" id="h86-0-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h86-1" id="h86-1" class="h">@@ -225,7 +230,12 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     3,
<a href="#h86-1-3" id="h86-1-3" class="d">-                    None,
</a><a href="#h86-1-4" id="h86-1-4" class="i">+                    Some(
</a><a href="#h86-1-5" id="h86-1-5" class="i">+                        (
</a><a href="#h86-1-6" id="h86-1-6" class="i">+                            None,
</a><a href="#h86-1-7" id="h86-1-7" class="i">+                            &quot;ord&quot;,
</a><a href="#h86-1-8" id="h86-1-8" class="i">+                        ),
</a><a href="#h86-1-9" id="h86-1-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h86-2" id="h86-2" class="h">@@ -235,6 +245,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT id, title, released, released % 4 AS ord FROM movies ORDER BY released % 4 ASC
 
<a href="#h86-2-3" id="h86-2-3" class="i">+Explain:
</a><a href="#h86-2-4" id="h86-2-4" class="i">+Order: ord asc
</a><a href="#h86-2-5" id="h86-2-5" class="i">+└─ Projection: id, title, released, released % 4
</a><a href="#h86-2-6" id="h86-2-6" class="i">+   └─ Scan: movies
</a><a href="#h86-2-7" id="h86-2-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;released&quot;, &quot;ord&quot;]
 [Integer(3), String(&quot;Primer&quot;), Integer(2004), Integer(0)]
 [Integer(6), String(&quot;Solaris&quot;), Integer(1972), Integer(0)]
<b>diff --git a/<a id="h87" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h87-0" id="h87-0" class="h">@@ -174,14 +174,26 @@ Plan: Plan(
</a>             (
                 Field(
                     2,
<a href="#h87-0-3" id="h87-0-3" class="d">-                    None,
</a><a href="#h87-0-4" id="h87-0-4" class="i">+                    Some(
</a><a href="#h87-0-5" id="h87-0-5" class="i">+                        (
</a><a href="#h87-0-6" id="h87-0-6" class="i">+                            None,
</a><a href="#h87-0-7" id="h87-0-7" class="i">+                            &quot;genre&quot;,
</a><a href="#h87-0-8" id="h87-0-8" class="i">+                        ),
</a><a href="#h87-0-9" id="h87-0-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
             (
                 Field(
                     1,
<a href="#h87-0-16" id="h87-0-16" class="d">-                    None,
</a><a href="#h87-0-17" id="h87-0-17" class="i">+                    Some(
</a><a href="#h87-0-18" id="h87-0-18" class="i">+                        (
</a><a href="#h87-0-19" id="h87-0-19" class="i">+                            Some(
</a><a href="#h87-0-20" id="h87-0-20" class="i">+                                &quot;movies&quot;,
</a><a href="#h87-0-21" id="h87-0-21" class="i">+                            ),
</a><a href="#h87-0-22" id="h87-0-22" class="i">+                            &quot;title&quot;,
</a><a href="#h87-0-23" id="h87-0-23" class="i">+                        ),
</a><a href="#h87-0-24" id="h87-0-24" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h87-1" id="h87-1" class="h">@@ -282,14 +294,26 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     2,
<a href="#h87-1-3" id="h87-1-3" class="d">-                    None,
</a><a href="#h87-1-4" id="h87-1-4" class="i">+                    Some(
</a><a href="#h87-1-5" id="h87-1-5" class="i">+                        (
</a><a href="#h87-1-6" id="h87-1-6" class="i">+                            None,
</a><a href="#h87-1-7" id="h87-1-7" class="i">+                            &quot;genre&quot;,
</a><a href="#h87-1-8" id="h87-1-8" class="i">+                        ),
</a><a href="#h87-1-9" id="h87-1-9" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
             (
                 Field(
                     1,
<a href="#h87-1-16" id="h87-1-16" class="d">-                    None,
</a><a href="#h87-1-17" id="h87-1-17" class="i">+                    Some(
</a><a href="#h87-1-18" id="h87-1-18" class="i">+                        (
</a><a href="#h87-1-19" id="h87-1-19" class="i">+                            Some(
</a><a href="#h87-1-20" id="h87-1-20" class="i">+                                &quot;movies&quot;,
</a><a href="#h87-1-21" id="h87-1-21" class="i">+                            ),
</a><a href="#h87-1-22" id="h87-1-22" class="i">+                            &quot;title&quot;,
</a><a href="#h87-1-23" id="h87-1-23" class="i">+                        ),
</a><a href="#h87-1-24" id="h87-1-24" class="i">+                    ),
</a>                 ),
                 Ascending,
             ),
<a href="#h87-2" id="h87-2" class="h">@@ -299,6 +323,13 @@ Optimized plan: Plan(
</a> 
 Query: SELECT movies.id, title, genres.name AS genre FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genre, title
 
<a href="#h87-2-3" id="h87-2-3" class="i">+Explain:
</a><a href="#h87-2-4" id="h87-2-4" class="i">+Order: genre asc, movies.title asc
</a><a href="#h87-2-5" id="h87-2-5" class="i">+└─ Projection: movies.id, title, genres.name
</a><a href="#h87-2-6" id="h87-2-6" class="i">+   └─ NestedLoopJoin: inner on movies.genre_id = genres.id
</a><a href="#h87-2-7" id="h87-2-7" class="i">+      ├─ Scan: movies
</a><a href="#h87-2-8" id="h87-2-8" class="i">+      └─ Scan: genres
</a><a href="#h87-2-9" id="h87-2-9" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;genre&quot;]
 [Integer(4), String(&quot;Heat&quot;), String(&quot;Action&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h88" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h88-0" id="h88-0" class="h">@@ -199,14 +199,28 @@ Plan: Plan(
</a>                 (
                     Field(
                         3,
<a href="#h88-0-3" id="h88-0-3" class="d">-                        None,
</a><a href="#h88-0-4" id="h88-0-4" class="i">+                        Some(
</a><a href="#h88-0-5" id="h88-0-5" class="i">+                            (
</a><a href="#h88-0-6" id="h88-0-6" class="i">+                                Some(
</a><a href="#h88-0-7" id="h88-0-7" class="i">+                                    &quot;genres&quot;,
</a><a href="#h88-0-8" id="h88-0-8" class="i">+                                ),
</a><a href="#h88-0-9" id="h88-0-9" class="i">+                                &quot;name&quot;,
</a><a href="#h88-0-10" id="h88-0-10" class="i">+                            ),
</a><a href="#h88-0-11" id="h88-0-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
                 (
                     Field(
                         4,
<a href="#h88-0-18" id="h88-0-18" class="d">-                        None,
</a><a href="#h88-0-19" id="h88-0-19" class="i">+                        Some(
</a><a href="#h88-0-20" id="h88-0-20" class="i">+                            (
</a><a href="#h88-0-21" id="h88-0-21" class="i">+                                Some(
</a><a href="#h88-0-22" id="h88-0-22" class="i">+                                    &quot;movies&quot;,
</a><a href="#h88-0-23" id="h88-0-23" class="i">+                                ),
</a><a href="#h88-0-24" id="h88-0-24" class="i">+                                &quot;title&quot;,
</a><a href="#h88-0-25" id="h88-0-25" class="i">+                            ),
</a><a href="#h88-0-26" id="h88-0-26" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h88-1" id="h88-1" class="h">@@ -356,14 +370,28 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         3,
<a href="#h88-1-3" id="h88-1-3" class="d">-                        None,
</a><a href="#h88-1-4" id="h88-1-4" class="i">+                        Some(
</a><a href="#h88-1-5" id="h88-1-5" class="i">+                            (
</a><a href="#h88-1-6" id="h88-1-6" class="i">+                                Some(
</a><a href="#h88-1-7" id="h88-1-7" class="i">+                                    &quot;genres&quot;,
</a><a href="#h88-1-8" id="h88-1-8" class="i">+                                ),
</a><a href="#h88-1-9" id="h88-1-9" class="i">+                                &quot;name&quot;,
</a><a href="#h88-1-10" id="h88-1-10" class="i">+                            ),
</a><a href="#h88-1-11" id="h88-1-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
                 (
                     Field(
                         4,
<a href="#h88-1-18" id="h88-1-18" class="d">-                        None,
</a><a href="#h88-1-19" id="h88-1-19" class="i">+                        Some(
</a><a href="#h88-1-20" id="h88-1-20" class="i">+                            (
</a><a href="#h88-1-21" id="h88-1-21" class="i">+                                Some(
</a><a href="#h88-1-22" id="h88-1-22" class="i">+                                    &quot;movies&quot;,
</a><a href="#h88-1-23" id="h88-1-23" class="i">+                                ),
</a><a href="#h88-1-24" id="h88-1-24" class="i">+                                &quot;title&quot;,
</a><a href="#h88-1-25" id="h88-1-25" class="i">+                            ),
</a><a href="#h88-1-26" id="h88-1-26" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h88-2" id="h88-2" class="h">@@ -397,6 +425,14 @@ Optimized plan: Plan(
</a> 
 Query: SELECT movies.id, title, name FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genres.name, movies.title
 
<a href="#h88-2-3" id="h88-2-3" class="i">+Explain:
</a><a href="#h88-2-4" id="h88-2-4" class="i">+Projection: #0, #1, #2
</a><a href="#h88-2-5" id="h88-2-5" class="i">+└─ Order: genres.name asc, movies.title asc
</a><a href="#h88-2-6" id="h88-2-6" class="i">+   └─ Projection: movies.id, title, name, genres.name, movies.title
</a><a href="#h88-2-7" id="h88-2-7" class="i">+      └─ NestedLoopJoin: inner on movies.genre_id = genres.id
</a><a href="#h88-2-8" id="h88-2-8" class="i">+         ├─ Scan: movies
</a><a href="#h88-2-9" id="h88-2-9" class="i">+         └─ Scan: genres
</a><a href="#h88-2-10" id="h88-2-10" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;name&quot;]
 [Integer(4), String(&quot;Heat&quot;), String(&quot;Action&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h89" href="../file/tests/sql/query/order_float_asc.html">tests/sql/query/order_float_asc</a> b/<a href="../file/tests/sql/query/order_float_asc.html">tests/sql/query/order_float_asc</a></b>
<a href="#h89-0" id="h89-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM floats ORDER BY value ASC
 
<a href="#h89-0-3" id="h89-0-3" class="i">+Explain:
</a><a href="#h89-0-4" id="h89-0-4" class="i">+Order: value asc
</a><a href="#h89-0-5" id="h89-0-5" class="i">+└─ Scan: floats
</a><a href="#h89-0-6" id="h89-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(3), Null]
 [Integer(2), Float(-2.718)]
<b>diff --git a/<a id="h90" href="../file/tests/sql/query/order_float_desc.html">tests/sql/query/order_float_desc</a> b/<a href="../file/tests/sql/query/order_float_desc.html">tests/sql/query/order_float_desc</a></b>
<a href="#h90-0" id="h90-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM floats ORDER BY value DESC
 
<a href="#h90-0-3" id="h90-0-3" class="i">+Explain:
</a><a href="#h90-0-4" id="h90-0-4" class="i">+Order: value desc
</a><a href="#h90-0-5" id="h90-0-5" class="i">+└─ Scan: floats
</a><a href="#h90-0-6" id="h90-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(1), Float(3.14)]
 [Integer(4), Float(1.618)]
<b>diff --git a/<a id="h91" href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a> b/<a href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a></b>
<a href="#h91-0" id="h91-0" class="h">@@ -95,7 +95,14 @@ Plan: Plan(
</a>                     (
                         Field(
                             1,
<a href="#h91-0-3" id="h91-0-3" class="d">-                            None,
</a><a href="#h91-0-4" id="h91-0-4" class="i">+                            Some(
</a><a href="#h91-0-5" id="h91-0-5" class="i">+                                (
</a><a href="#h91-0-6" id="h91-0-6" class="i">+                                    Some(
</a><a href="#h91-0-7" id="h91-0-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h91-0-8" id="h91-0-8" class="i">+                                    ),
</a><a href="#h91-0-9" id="h91-0-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h91-0-10" id="h91-0-10" class="i">+                                ),
</a><a href="#h91-0-11" id="h91-0-11" class="i">+                            ),
</a>                         ),
                         None,
                     ),
<a href="#h91-1" id="h91-1" class="h">@@ -105,7 +112,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h91-1-3" id="h91-1-3" class="d">-                        None,
</a><a href="#h91-1-4" id="h91-1-4" class="i">+                        Some(
</a><a href="#h91-1-5" id="h91-1-5" class="i">+                            (
</a><a href="#h91-1-6" id="h91-1-6" class="i">+                                Some(
</a><a href="#h91-1-7" id="h91-1-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h91-1-8" id="h91-1-8" class="i">+                                ),
</a><a href="#h91-1-9" id="h91-1-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h91-1-10" id="h91-1-10" class="i">+                            ),
</a><a href="#h91-1-11" id="h91-1-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h91-2" id="h91-2" class="h">@@ -176,7 +190,14 @@ Optimized plan: Plan(
</a>                     (
                         Field(
                             1,
<a href="#h91-2-3" id="h91-2-3" class="d">-                            None,
</a><a href="#h91-2-4" id="h91-2-4" class="i">+                            Some(
</a><a href="#h91-2-5" id="h91-2-5" class="i">+                                (
</a><a href="#h91-2-6" id="h91-2-6" class="i">+                                    Some(
</a><a href="#h91-2-7" id="h91-2-7" class="i">+                                        &quot;movies&quot;,
</a><a href="#h91-2-8" id="h91-2-8" class="i">+                                    ),
</a><a href="#h91-2-9" id="h91-2-9" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h91-2-10" id="h91-2-10" class="i">+                                ),
</a><a href="#h91-2-11" id="h91-2-11" class="i">+                            ),
</a>                         ),
                         None,
                     ),
<a href="#h91-3" id="h91-3" class="h">@@ -186,7 +207,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         1,
<a href="#h91-3-3" id="h91-3-3" class="d">-                        None,
</a><a href="#h91-3-4" id="h91-3-4" class="i">+                        Some(
</a><a href="#h91-3-5" id="h91-3-5" class="i">+                            (
</a><a href="#h91-3-6" id="h91-3-6" class="i">+                                Some(
</a><a href="#h91-3-7" id="h91-3-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h91-3-8" id="h91-3-8" class="i">+                                ),
</a><a href="#h91-3-9" id="h91-3-9" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h91-3-10" id="h91-3-10" class="i">+                            ),
</a><a href="#h91-3-11" id="h91-3-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h91-4" id="h91-4" class="h">@@ -206,6 +234,14 @@ Optimized plan: Plan(
</a> 
 Query: SELECT MAX(rating) FROM movies GROUP BY studio_id ORDER BY studio_id
 
<a href="#h91-4-3" id="h91-4-3" class="i">+Explain:
</a><a href="#h91-4-4" id="h91-4-4" class="i">+Projection: #0
</a><a href="#h91-4-5" id="h91-4-5" class="i">+└─ Order: movies.studio_id asc
</a><a href="#h91-4-6" id="h91-4-6" class="i">+   └─ Projection: #0, movies.studio_id
</a><a href="#h91-4-7" id="h91-4-7" class="i">+      └─ Aggregation: maximum
</a><a href="#h91-4-8" id="h91-4-8" class="i">+         └─ Projection: rating, studio_id
</a><a href="#h91-4-9" id="h91-4-9" class="i">+            └─ Scan: movies
</a><a href="#h91-4-10" id="h91-4-10" class="i">+
</a> Result: [&quot;?&quot;]
 [Float(8.2)]
 [Float(7.6)]
<b>diff --git a/<a id="h92" href="../file/tests/sql/query/order_integer_asc.html">tests/sql/query/order_integer_asc</a> b/<a href="../file/tests/sql/query/order_integer_asc.html">tests/sql/query/order_integer_asc</a></b>
<a href="#h92-0" id="h92-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM integers ORDER BY value ASC
 
<a href="#h92-0-3" id="h92-0-3" class="i">+Explain:
</a><a href="#h92-0-4" id="h92-0-4" class="i">+Order: value asc
</a><a href="#h92-0-5" id="h92-0-5" class="i">+└─ Scan: integers
</a><a href="#h92-0-6" id="h92-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(2), Null]
 [Integer(3), Integer(-3)]
<b>diff --git a/<a id="h93" href="../file/tests/sql/query/order_integer_desc.html">tests/sql/query/order_integer_desc</a> b/<a href="../file/tests/sql/query/order_integer_desc.html">tests/sql/query/order_integer_desc</a></b>
<a href="#h93-0" id="h93-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM integers ORDER BY value DESC
 
<a href="#h93-0-3" id="h93-0-3" class="i">+Explain:
</a><a href="#h93-0-4" id="h93-0-4" class="i">+Order: value desc
</a><a href="#h93-0-5" id="h93-0-5" class="i">+└─ Scan: integers
</a><a href="#h93-0-6" id="h93-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(1), Integer(7)]
 [Integer(4), Integer(3)]
<b>diff --git a/<a id="h94" href="../file/tests/sql/query/order_multi.html">tests/sql/query/order_multi</a> b/<a href="../file/tests/sql/query/order_multi.html">tests/sql/query/order_multi</a></b>
<a href="#h94-0" id="h94-0" class="h">@@ -105,6 +105,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies ORDER BY ultrahd ASC, id DESC
 
<a href="#h94-0-3" id="h94-0-3" class="i">+Explain:
</a><a href="#h94-0-4" id="h94-0-4" class="i">+Order: ultrahd asc, id desc
</a><a href="#h94-0-5" id="h94-0-5" class="i">+└─ Scan: movies
</a><a href="#h94-0-6" id="h94-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
<b>diff --git a/<a id="h95" href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a> b/<a href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a></b>
<a href="#h95-0" id="h95-0" class="h">@@ -91,7 +91,14 @@ Plan: Plan(
</a>                 (
                     Field(
                         2,
<a href="#h95-0-3" id="h95-0-3" class="d">-                        None,
</a><a href="#h95-0-4" id="h95-0-4" class="i">+                        Some(
</a><a href="#h95-0-5" id="h95-0-5" class="i">+                            (
</a><a href="#h95-0-6" id="h95-0-6" class="i">+                                Some(
</a><a href="#h95-0-7" id="h95-0-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h95-0-8" id="h95-0-8" class="i">+                                ),
</a><a href="#h95-0-9" id="h95-0-9" class="i">+                                &quot;released&quot;,
</a><a href="#h95-0-10" id="h95-0-10" class="i">+                            ),
</a><a href="#h95-0-11" id="h95-0-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h95-1" id="h95-1" class="h">@@ -168,7 +175,14 @@ Optimized plan: Plan(
</a>                 (
                     Field(
                         2,
<a href="#h95-1-3" id="h95-1-3" class="d">-                        None,
</a><a href="#h95-1-4" id="h95-1-4" class="i">+                        Some(
</a><a href="#h95-1-5" id="h95-1-5" class="i">+                            (
</a><a href="#h95-1-6" id="h95-1-6" class="i">+                                Some(
</a><a href="#h95-1-7" id="h95-1-7" class="i">+                                    &quot;movies&quot;,
</a><a href="#h95-1-8" id="h95-1-8" class="i">+                                ),
</a><a href="#h95-1-9" id="h95-1-9" class="i">+                                &quot;released&quot;,
</a><a href="#h95-1-10" id="h95-1-10" class="i">+                            ),
</a><a href="#h95-1-11" id="h95-1-11" class="i">+                        ),
</a>                     ),
                     Ascending,
                 ),
<a href="#h95-2" id="h95-2" class="h">@@ -195,6 +209,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT id, title FROM movies ORDER BY released
 
<a href="#h95-2-3" id="h95-2-3" class="i">+Explain:
</a><a href="#h95-2-4" id="h95-2-4" class="i">+Projection: #0, #1
</a><a href="#h95-2-5" id="h95-2-5" class="i">+└─ Order: movies.released asc
</a><a href="#h95-2-6" id="h95-2-6" class="i">+   └─ Projection: id, title, released
</a><a href="#h95-2-7" id="h95-2-7" class="i">+      └─ Scan: movies
</a><a href="#h95-2-8" id="h95-2-8" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;]
 [Integer(6), String(&quot;Solaris&quot;)]
 [Integer(1), String(&quot;Stalker&quot;)]
<b>diff --git a/<a id="h96" href="../file/tests/sql/query/order_string_asc.html">tests/sql/query/order_string_asc</a> b/<a href="../file/tests/sql/query/order_string_asc.html">tests/sql/query/order_string_asc</a></b>
<a href="#h96-0" id="h96-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM strings ORDER BY value ASC
 
<a href="#h96-0-3" id="h96-0-3" class="i">+Explain:
</a><a href="#h96-0-4" id="h96-0-4" class="i">+Order: value asc
</a><a href="#h96-0-5" id="h96-0-5" class="i">+└─ Scan: strings
</a><a href="#h96-0-6" id="h96-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(5), Null]
 [Integer(4), String(&quot;A&quot;)]
<b>diff --git a/<a id="h97" href="../file/tests/sql/query/order_string_desc.html">tests/sql/query/order_string_desc</a> b/<a href="../file/tests/sql/query/order_string_desc.html">tests/sql/query/order_string_desc</a></b>
<a href="#h97-0" id="h97-0" class="h">@@ -74,6 +74,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM strings ORDER BY value DESC
 
<a href="#h97-0-3" id="h97-0-3" class="i">+Explain:
</a><a href="#h97-0-4" id="h97-0-4" class="i">+Order: value desc
</a><a href="#h97-0-5" id="h97-0-5" class="i">+└─ Scan: strings
</a><a href="#h97-0-6" id="h97-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(7), String(&quot;åa&quot;)]
 [Integer(8), String(&quot;Åa&quot;)]
<b>diff --git a/<a id="h98" href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a> b/<a href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a></b>
<a href="#h98-0" id="h98-0" class="h">@@ -149,6 +149,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE released &gt;= 2000 AND ultrahd
 
<a href="#h98-0-3" id="h98-0-3" class="i">+Explain:
</a><a href="#h98-0-4" id="h98-0-4" class="i">+Scan: movies (released &gt; 2000 OR released = 2000 AND ultrahd)
</a><a href="#h98-0-5" id="h98-0-5" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
<b>diff --git a/<a id="h99" href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a> b/<a href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a></b>
<a href="#h99-0" id="h99-0" class="h">@@ -53,4 +53,7 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE FALSE
 
<a href="#h99-0-3" id="h99-0-3" class="i">+Explain:
</a><a href="#h99-0-4" id="h99-0-4" class="i">+Scan: movies (FALSE)
</a><a href="#h99-0-5" id="h99-0-5" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<b>diff --git a/<a id="h100" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h100-0" id="h100-0" class="h">@@ -293,6 +293,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT m.id, g.id FROM movies m, genres g WHERE m.id &gt;= 3 AND g.id = 1
 
<a href="#h100-0-3" id="h100-0-3" class="i">+Explain:
</a><a href="#h100-0-4" id="h100-0-4" class="i">+Projection: m.id, g.id
</a><a href="#h100-0-5" id="h100-0-5" class="i">+└─ NestedLoopJoin: inner
</a><a href="#h100-0-6" id="h100-0-6" class="i">+   ├─ Scan: movies (m.id &gt; 3 OR m.id = 3)
</a><a href="#h100-0-7" id="h100-0-7" class="i">+   └─ KeyLookup: genres (1)
</a><a href="#h100-0-8" id="h100-0-8" class="i">+
</a> Result: [&quot;id&quot;, &quot;id&quot;]
 [Integer(3), Integer(1)]
 [Integer(4), Integer(1)]
<b>diff --git a/<a id="h101" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h101-0" id="h101-0" class="h">@@ -281,6 +281,12 @@ Optimized plan: Plan(
</a> 
 Query: SELECT movies.id, genres.id FROM movies, genres WHERE movies.id &gt;= 3 AND genres.id = 1
 
<a href="#h101-0-3" id="h101-0-3" class="i">+Explain:
</a><a href="#h101-0-4" id="h101-0-4" class="i">+Projection: movies.id, genres.id
</a><a href="#h101-0-5" id="h101-0-5" class="i">+└─ NestedLoopJoin: inner
</a><a href="#h101-0-6" id="h101-0-6" class="i">+   ├─ Scan: movies (movies.id &gt; 3 OR movies.id = 3)
</a><a href="#h101-0-7" id="h101-0-7" class="i">+   └─ KeyLookup: genres (1)
</a><a href="#h101-0-8" id="h101-0-8" class="i">+
</a> Result: [&quot;id&quot;, &quot;id&quot;]
 [Integer(3), Integer(1)]
 [Integer(4), Integer(1)]
<b>diff --git a/<a id="h102" href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a> b/<a href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a></b>
<a href="#h102-0" id="h102-0" class="h">@@ -53,4 +53,7 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE 3.14
 
<a href="#h102-0-3" id="h102-0-3" class="i">+Explain:
</a><a href="#h102-0-4" id="h102-0-4" class="i">+Scan: movies (3.14)
</a><a href="#h102-0-5" id="h102-0-5" class="i">+
</a> Result: Value(&quot;Filter returned 3.14, expected boolean&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h103" href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a> b/<a href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a></b>
<a href="#h103-0" id="h103-0" class="h">@@ -111,6 +111,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE genre_id = 2 ORDER BY id
 
<a href="#h103-0-3" id="h103-0-3" class="i">+Explain:
</a><a href="#h103-0-4" id="h103-0-4" class="i">+Order: id asc
</a><a href="#h103-0-5" id="h103-0-5" class="i">+└─ IndexLookup: movies.genre_id (2)
</a><a href="#h103-0-6" id="h103-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
<b>diff --git a/<a id="h104" href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a> b/<a href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a></b>
<a href="#h104-0" id="h104-0" class="h">@@ -225,6 +225,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE genre_id = 2 OR genre_id = 3 OR genre_id = 4 OR genre_id = 5 ORDER BY id
 
<a href="#h104-0-3" id="h104-0-3" class="i">+Explain:
</a><a href="#h104-0-4" id="h104-0-4" class="i">+Order: id asc
</a><a href="#h104-0-5" id="h104-0-5" class="i">+└─ IndexLookup: movies.genre_id (2, 3, 4, 5)
</a><a href="#h104-0-6" id="h104-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
<b>diff --git a/<a id="h105" href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a> b/<a href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a></b>
<a href="#h105-0" id="h105-0" class="h">@@ -202,6 +202,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE (genre_id = 2 OR genre_id = 3) AND studio_id = 2 ORDER BY id
 
<a href="#h105-0-3" id="h105-0-3" class="i">+Explain:
</a><a href="#h105-0-4" id="h105-0-4" class="i">+Order: id asc
</a><a href="#h105-0-5" id="h105-0-5" class="i">+└─ Filter: studio_id = 2
</a><a href="#h105-0-6" id="h105-0-6" class="i">+   └─ IndexLookup: movies.genre_id (2, 3)
</a><a href="#h105-0-7" id="h105-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
<b>diff --git a/<a id="h106" href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a> b/<a href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a></b>
<a href="#h106-0" id="h106-0" class="h">@@ -53,4 +53,7 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE 7
 
<a href="#h106-0-3" id="h106-0-3" class="i">+Explain:
</a><a href="#h106-0-4" id="h106-0-4" class="i">+Scan: movies (7)
</a><a href="#h106-0-5" id="h106-0-5" class="i">+
</a> Result: Value(&quot;Filter returned 7, expected boolean&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h107" href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a> b/<a href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a></b>
<a href="#h107-0" id="h107-0" class="h">@@ -128,6 +128,11 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies, genres WHERE movies.genre_id = genres.id
 
<a href="#h107-0-3" id="h107-0-3" class="i">+Explain:
</a><a href="#h107-0-4" id="h107-0-4" class="i">+NestedLoopJoin: inner on movies.genre_id = genres.id
</a><a href="#h107-0-5" id="h107-0-5" class="i">+├─ Scan: movies
</a><a href="#h107-0-6" id="h107-0-6" class="i">+└─ Scan: genres
</a><a href="#h107-0-7" id="h107-0-7" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h108" href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a> b/<a href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a></b>
<a href="#h108-0" id="h108-0" class="h">@@ -47,4 +47,7 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE NULL
 
<a href="#h108-0-3" id="h108-0-3" class="i">+Explain:
</a><a href="#h108-0-4" id="h108-0-4" class="i">+Scan: movies (NULL)
</a><a href="#h108-0-5" id="h108-0-5" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<b>diff --git a/<a id="h109" href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a> b/<a href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a></b>
<a href="#h109-0" id="h109-0" class="h">@@ -70,5 +70,8 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE id = 3
 
<a href="#h109-0-3" id="h109-0-3" class="i">+Explain:
</a><a href="#h109-0-4" id="h109-0-4" class="i">+KeyLookup: movies (3)
</a><a href="#h109-0-5" id="h109-0-5" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
<b>diff --git a/<a id="h110" href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a> b/<a href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a></b>
<a href="#h110-0" id="h110-0" class="h">@@ -146,6 +146,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE id = 3 OR id = 5 OR id = 7
 
<a href="#h110-0-3" id="h110-0-3" class="i">+Explain:
</a><a href="#h110-0-4" id="h110-0-4" class="i">+KeyLookup: movies (3, 5, 7)
</a><a href="#h110-0-5" id="h110-0-5" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<b>diff --git a/<a id="h111" href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a> b/<a href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a></b>
<a href="#h111-0" id="h111-0" class="h">@@ -237,6 +237,10 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE (id = 2 OR id = 3 OR id = 4 OR id = 5) AND genre_id = 1
 
<a href="#h111-0-3" id="h111-0-3" class="i">+Explain:
</a><a href="#h111-0-4" id="h111-0-4" class="i">+Filter: genre_id = 1
</a><a href="#h111-0-5" id="h111-0-5" class="i">+└─ KeyLookup: movies (2, 3, 4, 5)
</a><a href="#h111-0-6" id="h111-0-6" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<b>diff --git a/<a id="h112" href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a> b/<a href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a></b>
<a href="#h112-0" id="h112-0" class="h">@@ -53,4 +53,7 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE &#39;abc&#39;
 
<a href="#h112-0-3" id="h112-0-3" class="i">+Explain:
</a><a href="#h112-0-4" id="h112-0-4" class="i">+Scan: movies (abc)
</a><a href="#h112-0-5" id="h112-0-5" class="i">+
</a> Result: Value(&quot;Filter returned abc, expected boolean&quot;)
 \ No newline at end of file
<b>diff --git a/<a id="h113" href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a> b/<a href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a></b>
<a href="#h113-0" id="h113-0" class="h">@@ -53,6 +53,9 @@ Optimized plan: Plan(
</a> 
 Query: SELECT * FROM movies WHERE TRUE
 
<a href="#h113-0-3" id="h113-0-3" class="i">+Explain:
</a><a href="#h113-0-4" id="h113-0-4" class="i">+Scan: movies (TRUE)
</a><a href="#h113-0-5" id="h113-0-5" class="i">+
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
</pre>
</div>
</body>
</html>
