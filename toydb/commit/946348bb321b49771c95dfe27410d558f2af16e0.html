<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: add support for qualified fields. - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/946348bb321b49771c95dfe27410d558f2af16e0.html">946348bb321b49771c95dfe27410d558f2af16e0</a>
<b>parent</b> <a href="../commit/6706494cc31ddfb849744f95a150562bc07e084d.html">6706494cc31ddfb849744f95a150562bc07e084d</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sat,  1 Feb 2020 22:51:39 +0100

sql: add support for qualified fields.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">docs/README.md</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/bin/toysql.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/executor/filter.rs</a></td><td> | </td><td class="num">19</td><td><span class="i">++++++</span><span class="d">-------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/executor/mod.rs</a></td><td> | </td><td class="num">123</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/executor/nested_loop_join.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/executor/nothing.rs</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/executor/order.rs</a></td><td> | </td><td class="num">5</td><td><span class="i">+</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/executor/projection.rs</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/executor/scan.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/parser/ast.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">25</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/planner/mod.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/sql/tests/query.rs</a></td><td> | </td><td class="num">28</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/sql/tests/query/as_</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h14">src/sql/tests/query/as_duplicate</a></td><td> | </td><td class="num">88</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h15">src/sql/tests/query/as_qualified</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">src/sql/tests/query/expr_dynamic</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/sql/tests/query/expr_mixed</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h18">src/sql/tests/query/field_ambiguous</a></td><td> | </td><td class="num">82</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h19">src/sql/tests/query/field_multi</a></td><td> | </td><td class="num">87</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h20">src/sql/tests/query/field_qualified</a></td><td> | </td><td class="num">78</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h21">src/sql/tests/query/field_qualified_multi</a></td><td> | </td><td class="num">118</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h22">src/sql/tests/query/field_qualified_nested</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h23">src/sql/tests/query/field_single</a></td><td> | </td><td class="num">72</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h24">src/sql/tests/query/field_unknown</a></td><td> | </td><td class="num">68</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h25">src/sql/tests/query/field_unknown_qualified</a></td><td> | </td><td class="num">74</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h26">src/sql/tests/query/field_unknown_table</a></td><td> | </td><td class="num">74</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">src/sql/tests/query/limit_dynamic</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">src/sql/tests/query/offset_dynamic</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">src/sql/tests/query/order</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">src/sql/tests/query/order_asc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">src/sql/tests/query/order_asc_lowercase</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">src/sql/tests/query/order_boolean_asc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">src/sql/tests/query/order_boolean_desc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">src/sql/tests/query/order_desc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">src/sql/tests/query/order_desc_lowercase</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">src/sql/tests/query/order_expr</a></td><td> | </td><td class="num">15</td><td><span class="i">+++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h37">src/sql/tests/query/order_field_aliased</a></td><td> | </td><td class="num">236</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h38">src/sql/tests/query/order_field_ambiguous</a></td><td> | </td><td class="num">134</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h39">src/sql/tests/query/order_field_qualified</a></td><td> | </td><td class="num">236</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h40">src/sql/tests/query/order_field_unknown</a></td><td> | </td><td class="num">69</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">src/sql/tests/query/order_float_asc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">src/sql/tests/query/order_float_desc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">src/sql/tests/query/order_integer_asc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">src/sql/tests/query/order_integer_desc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">src/sql/tests/query/order_multi</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">src/sql/tests/query/order_string_asc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">src/sql/tests/query/order_string_desc</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h48">src/sql/tests/query/order_unknown</a></td><td> | </td><td class="num">66</td><td><span class="i"></span><span class="d">------------------------------------------------------------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h49">src/sql/tests/query/unknown</a></td><td> | </td><td class="num">52</td><td><span class="i"></span><span class="d">----------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">src/sql/tests/query/where_expr</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h51">src/sql/tests/query/where_field_ambiguous</a></td><td> | </td><td class="num">177</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h52">src/sql/tests/query/where_field_qualified</a></td><td> | </td><td class="num">238</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h53">src/sql/tests/query/where_field_unknown</a></td><td> | </td><td class="num">58</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h54">src/sql/tests/query/where_join_inner</a></td><td> | </td><td class="num">108</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h55">src/sql/tests/query/where_unknown</a></td><td> | </td><td class="num">55</td><td><span class="i"></span><span class="d">-------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">src/sql/types/expression.rs</a></td><td> | </td><td class="num">32</td><td><span class="i">+++++++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">src/sql/types/schema.rs</a></td><td> | </td><td class="num">16</td><td><span class="i">+</span><span class="d">---------------</span></td></tr>
</table></pre><pre>58 files changed, 2308 insertions(+), 262 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/docs/README.md.html">docs/README.md</a> b/<a href="../file/docs/README.md.html">docs/README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -59,6 +59,8 @@ The `-` prefix operator can be used to take negative numbers.
</a> 
 Expressions can be used wherever a value is expected, e.g. as `SELECT` fields and `INSERT` values, and can be either a constant, a column reference, or an operator invocation.
 
<a href="#h0-0-3" id="h0-0-3" class="i">+Column references can either be unqualified, e.g. `name`, or prefixed with the relation identifier separated by `.`, e.g. `person.name`. Unqualified identifiers must be unambiguous, otherwise an error is returned.
</a><a href="#h0-0-4" id="h0-0-4" class="i">+
</a> ## SQL Operators
 
 ### Logical operators
<b>diff --git a/<a id="h1" href="../file/src/bin/toysql.rs.html">src/bin/toysql.rs</a> b/<a href="../file/src/bin/toysql.rs.html">src/bin/toysql.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -169,7 +169,15 @@ Semicolons are not supported. The following !-commands are also available:
</a>         }
 
         if self.show_headers {
<a href="#h1-0-3" id="h1-0-3" class="d">-            println!(&quot;{}&quot;, resultset.columns().join(&quot;|&quot;));
</a><a href="#h1-0-4" id="h1-0-4" class="i">+            println!(
</a><a href="#h1-0-5" id="h1-0-5" class="i">+                &quot;{}&quot;,
</a><a href="#h1-0-6" id="h1-0-6" class="i">+                resultset
</a><a href="#h1-0-7" id="h1-0-7" class="i">+                    .columns()
</a><a href="#h1-0-8" id="h1-0-8" class="i">+                    .into_iter()
</a><a href="#h1-0-9" id="h1-0-9" class="i">+                    .map(|c| c.unwrap_or_else(|| &quot;?&quot;.into()))
</a><a href="#h1-0-10" id="h1-0-10" class="i">+                    .collect::&lt;Vec&lt;_&gt;&gt;()
</a><a href="#h1-0-11" id="h1-0-11" class="i">+                    .join(&quot;|&quot;)
</a><a href="#h1-0-12" id="h1-0-12" class="i">+            );
</a>         }
         for result in resultset {
             let formatted: Vec&lt;String&gt; = result?.into_iter().map(|v| format!(&quot;{}&quot;, v)).collect();
<b>diff --git a/<a id="h2" href="../file/src/sql/executor/filter.rs.html">src/sql/executor/filter.rs</a> b/<a href="../file/src/sql/executor/filter.rs.html">src/sql/executor/filter.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -4,8 +4,6 @@ use super::super::types::Value;
</a> use super::{Context, Executor, ResultSet};
 use crate::Error;
 
<a href="#h2-0-3" id="h2-0-3" class="d">-use std::collections::HashMap;
</a><a href="#h2-0-4" id="h2-0-4" class="d">-
</a> /// A filter executor
 pub struct Filter&lt;T: Transaction&gt; {
     /// The source of rows to filter
<a href="#h2-1" id="h2-1" class="h">@@ -27,17 +25,12 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Filter&lt;T&gt; {
</a>             let columns = result.columns.clone();
             let predicate = self.predicate;
             result.rows = Some(Box::new(rows.filter_map(move |r| {
<a href="#h2-1-3" id="h2-1-3" class="d">-                r.and_then(|row| {
</a><a href="#h2-1-4" id="h2-1-4" class="d">-                    let env: HashMap&lt;_, _&gt; =
</a><a href="#h2-1-5" id="h2-1-5" class="d">-                        columns.iter().cloned().zip(row.iter().cloned()).collect();
</a><a href="#h2-1-6" id="h2-1-6" class="d">-                    match predicate.evaluate(&amp;env)? {
</a><a href="#h2-1-7" id="h2-1-7" class="d">-                        Value::Boolean(true) =&gt; Ok(Some(row)),
</a><a href="#h2-1-8" id="h2-1-8" class="d">-                        Value::Boolean(false) =&gt; Ok(None),
</a><a href="#h2-1-9" id="h2-1-9" class="d">-                        Value::Null =&gt; Ok(None),
</a><a href="#h2-1-10" id="h2-1-10" class="d">-                        value =&gt; Err(Error::Value(format!(
</a><a href="#h2-1-11" id="h2-1-11" class="d">-                            &quot;Filter returned {}, expected boolean&quot;,
</a><a href="#h2-1-12" id="h2-1-12" class="d">-                            value
</a><a href="#h2-1-13" id="h2-1-13" class="d">-                        ))),
</a><a href="#h2-1-14" id="h2-1-14" class="i">+                r.and_then(|row| match predicate.evaluate(&amp;columns.as_env(&amp;row))? {
</a><a href="#h2-1-15" id="h2-1-15" class="i">+                    Value::Boolean(true) =&gt; Ok(Some(row)),
</a><a href="#h2-1-16" id="h2-1-16" class="i">+                    Value::Boolean(false) =&gt; Ok(None),
</a><a href="#h2-1-17" id="h2-1-17" class="i">+                    Value::Null =&gt; Ok(None),
</a><a href="#h2-1-18" id="h2-1-18" class="i">+                    value =&gt; {
</a><a href="#h2-1-19" id="h2-1-19" class="i">+                        Err(Error::Value(format!(&quot;Filter returned {}, expected boolean&quot;, value)))
</a>                     }
                 })
                 .transpose()
<b>diff --git a/<a id="h3" href="../file/src/sql/executor/mod.rs.html">src/sql/executor/mod.rs</a> b/<a href="../file/src/sql/executor/mod.rs.html">src/sql/executor/mod.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -28,7 +28,9 @@ use update::Update;
</a> 
 use super::engine::Transaction;
 use super::planner::Node;
<a href="#h3-0-3" id="h3-0-3" class="d">-use super::types::Row;
</a><a href="#h3-0-4" id="h3-0-4" class="i">+use super::types::expression::Environment;
</a><a href="#h3-0-5" id="h3-0-5" class="i">+use super::types::schema::Table;
</a><a href="#h3-0-6" id="h3-0-6" class="i">+use super::types::{Row, Value};
</a> use crate::Error;
 
 /// A plan executor
<a href="#h3-1" id="h3-1" class="h">@@ -77,30 +79,30 @@ pub struct ResultSet {
</a>     /// The executor effect (i.e. mutation), if any
     effect: Option&lt;Effect&gt;,
     /// The column names of the result
<a href="#h3-1-3" id="h3-1-3" class="d">-    columns: Vec&lt;String&gt;,
</a><a href="#h3-1-4" id="h3-1-4" class="i">+    columns: ResultColumns,
</a>     /// The result rows
     rows: Option&lt;ResultRows&gt;,
 }
 
 impl ResultSet {
     /// Creates a new result set
<a href="#h3-1-11" id="h3-1-11" class="d">-    pub fn new(effect: Option&lt;Effect&gt;, columns: Vec&lt;String&gt;, rows: Option&lt;ResultRows&gt;) -&gt; Self {
</a><a href="#h3-1-12" id="h3-1-12" class="i">+    pub fn new(effect: Option&lt;Effect&gt;, columns: ResultColumns, rows: Option&lt;ResultRows&gt;) -&gt; Self {
</a>         Self { effect, columns, rows }
     }
 
     /// Creates a new result set for an effect
     pub fn from_effect(effect: Effect) -&gt; Self {
<a href="#h3-1-18" id="h3-1-18" class="d">-        Self { effect: Some(effect), columns: Vec::new(), rows: None }
</a><a href="#h3-1-19" id="h3-1-19" class="i">+        Self { effect: Some(effect), columns: ResultColumns::new(Vec::new()), rows: None }
</a>     }
 
<a href="#h3-1-22" id="h3-1-22" class="d">-    /// Creates a new result set for a row iterator
</a><a href="#h3-1-23" id="h3-1-23" class="d">-    pub fn from_rows(columns: Vec&lt;String&gt;, rows: ResultRows) -&gt; Self {
</a><a href="#h3-1-24" id="h3-1-24" class="i">+    /// Creates a new result set for a scan iterator
</a><a href="#h3-1-25" id="h3-1-25" class="i">+    pub fn from_rows(columns: ResultColumns, rows: ResultRows) -&gt; Self {
</a>         Self { effect: None, columns, rows: Some(rows) }
     }
 
<a href="#h3-1-29" id="h3-1-29" class="d">-    /// Returns the result columns
</a><a href="#h3-1-30" id="h3-1-30" class="d">-    pub fn columns(&amp;self) -&gt; Vec&lt;String&gt; {
</a><a href="#h3-1-31" id="h3-1-31" class="d">-        self.columns.clone()
</a><a href="#h3-1-32" id="h3-1-32" class="i">+    /// Returns the result column names
</a><a href="#h3-1-33" id="h3-1-33" class="i">+    pub fn columns(&amp;self) -&gt; Vec&lt;Option&lt;String&gt;&gt; {
</a><a href="#h3-1-34" id="h3-1-34" class="i">+        self.columns.names()
</a>     }
 
     /// Returns the query effect, if any
<a href="#h3-2" id="h3-2" class="h">@@ -129,6 +131,109 @@ impl Iterator for ResultSet {
</a> 
 type ResultRows = Box&lt;dyn Iterator&lt;Item = Result&lt;Row, Error&gt;&gt; + Send&gt;;
 
<a href="#h3-2-3" id="h3-2-3" class="i">+/// Column metadata for a result
</a><a href="#h3-2-4" id="h3-2-4" class="i">+#[derive(Clone, Serialize, Deserialize)]
</a><a href="#h3-2-5" id="h3-2-5" class="i">+pub struct ResultColumns {
</a><a href="#h3-2-6" id="h3-2-6" class="i">+    columns: Vec&lt;(Option&lt;String&gt;, Option&lt;String&gt;)&gt;,
</a><a href="#h3-2-7" id="h3-2-7" class="i">+}
</a><a href="#h3-2-8" id="h3-2-8" class="i">+
</a><a href="#h3-2-9" id="h3-2-9" class="i">+impl ResultColumns {
</a><a href="#h3-2-10" id="h3-2-10" class="i">+    pub fn new(columns: Vec&lt;(Option&lt;String&gt;, Option&lt;String&gt;)&gt;) -&gt; Self {
</a><a href="#h3-2-11" id="h3-2-11" class="i">+        Self { columns }
</a><a href="#h3-2-12" id="h3-2-12" class="i">+    }
</a><a href="#h3-2-13" id="h3-2-13" class="i">+
</a><a href="#h3-2-14" id="h3-2-14" class="i">+    pub fn from_table(table: &amp;Table) -&gt; Self {
</a><a href="#h3-2-15" id="h3-2-15" class="i">+        Self {
</a><a href="#h3-2-16" id="h3-2-16" class="i">+            columns: table
</a><a href="#h3-2-17" id="h3-2-17" class="i">+                .columns
</a><a href="#h3-2-18" id="h3-2-18" class="i">+                .iter()
</a><a href="#h3-2-19" id="h3-2-19" class="i">+                .map(|c| (Some(table.name.clone()), Some(c.name.clone())))
</a><a href="#h3-2-20" id="h3-2-20" class="i">+                .collect(),
</a><a href="#h3-2-21" id="h3-2-21" class="i">+        }
</a><a href="#h3-2-22" id="h3-2-22" class="i">+    }
</a><a href="#h3-2-23" id="h3-2-23" class="i">+
</a><a href="#h3-2-24" id="h3-2-24" class="i">+    fn as_env&lt;&#39;b&gt;(&amp;&#39;b self, row: &amp;&#39;b [Value]) -&gt; ResultEnv&lt;&#39;b&gt; {
</a><a href="#h3-2-25" id="h3-2-25" class="i">+        ResultEnv { columns: &amp;self, row }
</a><a href="#h3-2-26" id="h3-2-26" class="i">+    }
</a><a href="#h3-2-27" id="h3-2-27" class="i">+
</a><a href="#h3-2-28" id="h3-2-28" class="i">+    fn format(&amp;self, relation: Option&lt;&amp;str&gt;, field: &amp;str) -&gt; String {
</a><a href="#h3-2-29" id="h3-2-29" class="i">+        let mut s = super::parser::format_ident(field);
</a><a href="#h3-2-30" id="h3-2-30" class="i">+        if let Some(relation) = relation {
</a><a href="#h3-2-31" id="h3-2-31" class="i">+            s = format!(&quot;{}.{}&quot;, super::parser::format_ident(relation), s)
</a><a href="#h3-2-32" id="h3-2-32" class="i">+        }
</a><a href="#h3-2-33" id="h3-2-33" class="i">+        s
</a><a href="#h3-2-34" id="h3-2-34" class="i">+    }
</a><a href="#h3-2-35" id="h3-2-35" class="i">+
</a><a href="#h3-2-36" id="h3-2-36" class="i">+    fn get(&amp;self, relation: Option&lt;&amp;str&gt;, field: &amp;str) -&gt; Result&lt;(Option&lt;String&gt;, String), Error&gt; {
</a><a href="#h3-2-37" id="h3-2-37" class="i">+        let matches: Vec&lt;_&gt; = self
</a><a href="#h3-2-38" id="h3-2-38" class="i">+            .columns
</a><a href="#h3-2-39" id="h3-2-39" class="i">+            .iter()
</a><a href="#h3-2-40" id="h3-2-40" class="i">+            .filter_map(|(r, c)| {
</a><a href="#h3-2-41" id="h3-2-41" class="i">+                if c.as_deref() == Some(field) {
</a><a href="#h3-2-42" id="h3-2-42" class="i">+                    if relation.is_none() || r.as_deref() == relation {
</a><a href="#h3-2-43" id="h3-2-43" class="i">+                        Some((r.clone(), c.clone().unwrap()))
</a><a href="#h3-2-44" id="h3-2-44" class="i">+                    } else {
</a><a href="#h3-2-45" id="h3-2-45" class="i">+                        None
</a><a href="#h3-2-46" id="h3-2-46" class="i">+                    }
</a><a href="#h3-2-47" id="h3-2-47" class="i">+                } else {
</a><a href="#h3-2-48" id="h3-2-48" class="i">+                    None
</a><a href="#h3-2-49" id="h3-2-49" class="i">+                }
</a><a href="#h3-2-50" id="h3-2-50" class="i">+            })
</a><a href="#h3-2-51" id="h3-2-51" class="i">+            .collect();
</a><a href="#h3-2-52" id="h3-2-52" class="i">+        match matches.len() {
</a><a href="#h3-2-53" id="h3-2-53" class="i">+            0 =&gt; Err(Error::Value(format!(&quot;Unknown field {}&quot;, self.format(relation, field)))),
</a><a href="#h3-2-54" id="h3-2-54" class="i">+            1 =&gt; Ok(matches.into_iter().next().unwrap()),
</a><a href="#h3-2-55" id="h3-2-55" class="i">+            _ =&gt; Err(Error::Value(format!(&quot;Field reference {} is ambiguous&quot;, field))),
</a><a href="#h3-2-56" id="h3-2-56" class="i">+        }
</a><a href="#h3-2-57" id="h3-2-57" class="i">+    }
</a><a href="#h3-2-58" id="h3-2-58" class="i">+
</a><a href="#h3-2-59" id="h3-2-59" class="i">+    pub fn index(&amp;self, relation: Option&lt;&amp;str&gt;, field: &amp;str) -&gt; Result&lt;usize, Error&gt; {
</a><a href="#h3-2-60" id="h3-2-60" class="i">+        let matches: Vec&lt;_&gt; = self
</a><a href="#h3-2-61" id="h3-2-61" class="i">+            .columns
</a><a href="#h3-2-62" id="h3-2-62" class="i">+            .iter()
</a><a href="#h3-2-63" id="h3-2-63" class="i">+            .enumerate()
</a><a href="#h3-2-64" id="h3-2-64" class="i">+            .filter_map(|(i, (r, c))| {
</a><a href="#h3-2-65" id="h3-2-65" class="i">+                if c.as_deref() == Some(field) {
</a><a href="#h3-2-66" id="h3-2-66" class="i">+                    if relation.is_none() || r.as_deref() == relation {
</a><a href="#h3-2-67" id="h3-2-67" class="i">+                        Some(i)
</a><a href="#h3-2-68" id="h3-2-68" class="i">+                    } else {
</a><a href="#h3-2-69" id="h3-2-69" class="i">+                        None
</a><a href="#h3-2-70" id="h3-2-70" class="i">+                    }
</a><a href="#h3-2-71" id="h3-2-71" class="i">+                } else {
</a><a href="#h3-2-72" id="h3-2-72" class="i">+                    None
</a><a href="#h3-2-73" id="h3-2-73" class="i">+                }
</a><a href="#h3-2-74" id="h3-2-74" class="i">+            })
</a><a href="#h3-2-75" id="h3-2-75" class="i">+            .collect();
</a><a href="#h3-2-76" id="h3-2-76" class="i">+        match matches.len() {
</a><a href="#h3-2-77" id="h3-2-77" class="i">+            0 =&gt; Err(Error::Value(format!(&quot;Unknown field {}&quot;, self.format(relation, field)))),
</a><a href="#h3-2-78" id="h3-2-78" class="i">+            1 =&gt; Ok(matches.into_iter().next().unwrap()),
</a><a href="#h3-2-79" id="h3-2-79" class="i">+            _ =&gt; Err(Error::Value(format!(&quot;Field reference {} is ambiguous&quot;, field))),
</a><a href="#h3-2-80" id="h3-2-80" class="i">+        }
</a><a href="#h3-2-81" id="h3-2-81" class="i">+    }
</a><a href="#h3-2-82" id="h3-2-82" class="i">+
</a><a href="#h3-2-83" id="h3-2-83" class="i">+    pub fn merge(self, other: Self) -&gt; Self {
</a><a href="#h3-2-84" id="h3-2-84" class="i">+        let mut columns = self.columns;
</a><a href="#h3-2-85" id="h3-2-85" class="i">+        columns.extend(other.columns);
</a><a href="#h3-2-86" id="h3-2-86" class="i">+        Self::new(columns)
</a><a href="#h3-2-87" id="h3-2-87" class="i">+    }
</a><a href="#h3-2-88" id="h3-2-88" class="i">+
</a><a href="#h3-2-89" id="h3-2-89" class="i">+    pub fn names(&amp;self) -&gt; Vec&lt;Option&lt;String&gt;&gt; {
</a><a href="#h3-2-90" id="h3-2-90" class="i">+        self.columns.iter().map(|(_, c)| c.clone()).collect()
</a><a href="#h3-2-91" id="h3-2-91" class="i">+    }
</a><a href="#h3-2-92" id="h3-2-92" class="i">+}
</a><a href="#h3-2-93" id="h3-2-93" class="i">+
</a><a href="#h3-2-94" id="h3-2-94" class="i">+// Environment for a result row
</a><a href="#h3-2-95" id="h3-2-95" class="i">+struct ResultEnv&lt;&#39;a&gt; {
</a><a href="#h3-2-96" id="h3-2-96" class="i">+    columns: &amp;&#39;a ResultColumns,
</a><a href="#h3-2-97" id="h3-2-97" class="i">+    row: &amp;&#39;a [Value],
</a><a href="#h3-2-98" id="h3-2-98" class="i">+}
</a><a href="#h3-2-99" id="h3-2-99" class="i">+
</a><a href="#h3-2-100" id="h3-2-100" class="i">+impl&lt;&#39;a&gt; Environment for ResultEnv&lt;&#39;a&gt; {
</a><a href="#h3-2-101" id="h3-2-101" class="i">+    fn lookup(&amp;self, relation: Option&lt;&amp;str&gt;, field: &amp;str) -&gt; Result&lt;Value, Error&gt; {
</a><a href="#h3-2-102" id="h3-2-102" class="i">+        Ok(self.row.get(self.columns.index(relation, field)?).cloned().unwrap_or(Value::Null))
</a><a href="#h3-2-103" id="h3-2-103" class="i">+    }
</a><a href="#h3-2-104" id="h3-2-104" class="i">+}
</a><a href="#h3-2-105" id="h3-2-105" class="i">+
</a> #[derive(Clone, Debug, Serialize, Deserialize)]
 /// An executor effect
 pub enum Effect {
<b>diff --git a/<a id="h4" href="../file/src/sql/executor/nested_loop_join.rs.html">src/sql/executor/nested_loop_join.rs</a> b/<a href="../file/src/sql/executor/nested_loop_join.rs.html">src/sql/executor/nested_loop_join.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -20,7 +20,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for NestedLoopJoin&lt;T&gt; {
</a>     fn execute(self: Box&lt;Self&gt;, ctx: &amp;mut Context&lt;T&gt;) -&gt; Result&lt;ResultSet, Error&gt; {
         let mut result = self.outer.execute(ctx)?;
         let inner = self.inner.execute(ctx)?;
<a href="#h4-0-3" id="h4-0-3" class="d">-        result.columns.extend(inner.columns);
</a><a href="#h4-0-4" id="h4-0-4" class="i">+        result.columns = result.columns.merge(inner.columns);
</a> 
         let mut inner_rows = vec![];
         if let Some(mut rows) = inner.rows {
<b>diff --git a/<a id="h5" href="../file/src/sql/executor/nothing.rs.html">src/sql/executor/nothing.rs</a> b/<a href="../file/src/sql/executor/nothing.rs.html">src/sql/executor/nothing.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -1,6 +1,6 @@
</a> use super::super::engine::Transaction;
 use super::super::types::Row;
<a href="#h5-0-2" id="h5-0-2" class="d">-use super::{Context, Executor, ResultSet};
</a><a href="#h5-0-3" id="h5-0-3" class="i">+use super::{Context, Executor, ResultColumns, ResultSet};
</a> use crate::Error;
 
 /// An executor that produces a single empty row
<a href="#h5-1" id="h5-1" class="h">@@ -14,6 +14,9 @@ impl Nothing {
</a> 
 impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Nothing {
     fn execute(self: Box&lt;Self&gt;, _ctx: &amp;mut Context&lt;T&gt;) -&gt; Result&lt;ResultSet, Error&gt; {
<a href="#h5-1-3" id="h5-1-3" class="d">-        Ok(ResultSet::from_rows(Vec::new(), Box::new(std::iter::once(Ok(Row::new())))))
</a><a href="#h5-1-4" id="h5-1-4" class="i">+        Ok(ResultSet::from_rows(
</a><a href="#h5-1-5" id="h5-1-5" class="i">+            ResultColumns::new(Vec::new()),
</a><a href="#h5-1-6" id="h5-1-6" class="i">+            Box::new(std::iter::once(Ok(Row::new()))),
</a><a href="#h5-1-7" id="h5-1-7" class="i">+        ))
</a>     }
 }
<b>diff --git a/<a id="h6" href="../file/src/sql/executor/order.rs.html">src/sql/executor/order.rs</a> b/<a href="../file/src/sql/executor/order.rs.html">src/sql/executor/order.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -5,8 +5,6 @@ use super::super::types::{Row, Value};
</a> use super::{Context, Executor, ResultSet};
 use crate::Error;
 
<a href="#h6-0-3" id="h6-0-3" class="d">-use std::collections::HashMap;
</a><a href="#h6-0-4" id="h6-0-4" class="d">-
</a> /// An order executor
 pub struct Order&lt;T: Transaction&gt; {
     /// The source of rows to filter
<a href="#h6-1" id="h6-1" class="h">@@ -36,8 +34,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Order&lt;T&gt; {
</a>             };
             let mut items = Vec::new();
             while let Some(row) = rows.next().transpose()? {
<a href="#h6-1-3" id="h6-1-3" class="d">-                let env: HashMap&lt;_, _&gt; =
</a><a href="#h6-1-4" id="h6-1-4" class="d">-                    result.columns.iter().cloned().zip(row.iter().cloned()).collect();
</a><a href="#h6-1-5" id="h6-1-5" class="i">+                let env = result.columns.as_env(&amp;row);
</a>                 let mut values = Vec::new();
                 for (expr, _) in self.order.iter() {
                     values.push(expr.evaluate(&amp;env)?);
<b>diff --git a/<a id="h7" href="../file/src/sql/executor/projection.rs.html">src/sql/executor/projection.rs</a> b/<a href="../file/src/sql/executor/projection.rs.html">src/sql/executor/projection.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,10 +1,8 @@
</a> use super::super::engine::Transaction;
 use super::super::types::expression::{Expression, Expressions};
<a href="#h7-0-2" id="h7-0-2" class="d">-use super::{Context, Executor, ResultSet};
</a><a href="#h7-0-3" id="h7-0-3" class="i">+use super::{Context, Executor, ResultColumns, ResultSet};
</a> use crate::Error;
 
<a href="#h7-0-6" id="h7-0-6" class="d">-use std::collections::HashMap;
</a><a href="#h7-0-7" id="h7-0-7" class="d">-
</a> /// A filter executor
 pub struct Projection&lt;T: Transaction&gt; {
     /// The source of rows to project
<a href="#h7-1" id="h7-1" class="h">@@ -30,25 +28,27 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Projection&lt;T&gt; {
</a>         let mut result = self.source.execute(ctx)?;
         let columns = result.columns;
         let labels = self.labels;
<a href="#h7-1-3" id="h7-1-3" class="d">-        result.columns = self
</a><a href="#h7-1-4" id="h7-1-4" class="d">-            .expressions
</a><a href="#h7-1-5" id="h7-1-5" class="d">-            .iter()
</a><a href="#h7-1-6" id="h7-1-6" class="d">-            .enumerate()
</a><a href="#h7-1-7" id="h7-1-7" class="d">-            .map(|(i, e)| {
</a><a href="#h7-1-8" id="h7-1-8" class="d">-                if let Some(Some(label)) = labels.get(i) {
</a><a href="#h7-1-9" id="h7-1-9" class="d">-                    label.clone()
</a><a href="#h7-1-10" id="h7-1-10" class="d">-                } else if let Expression::Field(field) = e {
</a><a href="#h7-1-11" id="h7-1-11" class="d">-                    field.clone()
</a><a href="#h7-1-12" id="h7-1-12" class="d">-                } else {
</a><a href="#h7-1-13" id="h7-1-13" class="d">-                    &quot;?&quot;.to_string()
</a><a href="#h7-1-14" id="h7-1-14" class="d">-                }
</a><a href="#h7-1-15" id="h7-1-15" class="d">-            })
</a><a href="#h7-1-16" id="h7-1-16" class="d">-            .collect();
</a><a href="#h7-1-17" id="h7-1-17" class="i">+        result.columns = ResultColumns::new(
</a><a href="#h7-1-18" id="h7-1-18" class="i">+            self.expressions
</a><a href="#h7-1-19" id="h7-1-19" class="i">+                .iter()
</a><a href="#h7-1-20" id="h7-1-20" class="i">+                .enumerate()
</a><a href="#h7-1-21" id="h7-1-21" class="i">+                .map(|(i, e)| {
</a><a href="#h7-1-22" id="h7-1-22" class="i">+                    Ok(if let Some(Some(label)) = labels.get(i) {
</a><a href="#h7-1-23" id="h7-1-23" class="i">+                        (None, Some(label.clone()))
</a><a href="#h7-1-24" id="h7-1-24" class="i">+                    } else if let Expression::Field(relation, field) = e {
</a><a href="#h7-1-25" id="h7-1-25" class="i">+                        let (r, f) = columns.get(relation.as_deref(), field)?;
</a><a href="#h7-1-26" id="h7-1-26" class="i">+                        (r, Some(f))
</a><a href="#h7-1-27" id="h7-1-27" class="i">+                    } else {
</a><a href="#h7-1-28" id="h7-1-28" class="i">+                        (None, None)
</a><a href="#h7-1-29" id="h7-1-29" class="i">+                    })
</a><a href="#h7-1-30" id="h7-1-30" class="i">+                })
</a><a href="#h7-1-31" id="h7-1-31" class="i">+                .collect::&lt;Result&lt;Vec&lt;_&gt;, Error&gt;&gt;()?,
</a><a href="#h7-1-32" id="h7-1-32" class="i">+        );
</a>         if let Some(rows) = result.rows {
             let expressions = self.expressions;
             result.rows = Some(Box::new(rows.map(move |r| {
                 r.and_then(|row| {
<a href="#h7-1-37" id="h7-1-37" class="d">-                    let env: HashMap&lt;_, _&gt; = columns.iter().cloned().zip(row.into_iter()).collect();
</a><a href="#h7-1-38" id="h7-1-38" class="i">+                    let env = columns.as_env(&amp;row);
</a>                     Ok(expressions
                         .iter()
                         .map(|e| e.evaluate(&amp;env))
<b>diff --git a/<a id="h8" href="../file/src/sql/executor/scan.rs.html">src/sql/executor/scan.rs</a> b/<a href="../file/src/sql/executor/scan.rs.html">src/sql/executor/scan.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -1,5 +1,5 @@
</a> use super::super::engine::Transaction;
<a href="#h8-0-1" id="h8-0-1" class="d">-use super::{Context, Executor, ResultSet};
</a><a href="#h8-0-2" id="h8-0-2" class="i">+use super::{Context, Executor, ResultColumns, ResultSet};
</a> use crate::Error;
 
 /// A table scan executor
<a href="#h8-1" id="h8-1" class="h">@@ -17,7 +17,7 @@ impl Scan {
</a> impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Scan {
     fn execute(self: Box&lt;Self&gt;, ctx: &amp;mut Context&lt;T&gt;) -&gt; Result&lt;ResultSet, Error&gt; {
         let table = ctx.txn.must_read_table(&amp;self.table)?;
<a href="#h8-1-3" id="h8-1-3" class="d">-        let columns = table.columns.into_iter().map(|c| c.name).collect();
</a><a href="#h8-1-4" id="h8-1-4" class="i">+        let columns = ResultColumns::from_table(&amp;table);
</a>         let rows = ctx.txn.scan(&amp;table.name)?;
         // FIXME We use extra Box to cast to ResultRows iterator (apparently)
         Ok(ResultSet::from_rows(columns, Box::new(rows)))
<b>diff --git a/<a id="h9" href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a> b/<a href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -95,7 +95,7 @@ pub enum Order {
</a> /// Expressions
 #[derive(Clone, Debug, PartialEq)]
 pub enum Expression {
<a href="#h9-0-3" id="h9-0-3" class="d">-    Field(String),
</a><a href="#h9-0-4" id="h9-0-4" class="i">+    Field(Option&lt;String&gt;, String),
</a>     Literal(Literal),
     Operation(Operation),
 }
<b>diff --git a/<a id="h10" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -4,6 +4,8 @@ pub mod lexer;
</a> use super::types::DataType;
 use crate::Error;
 use lexer::{Keyword, Lexer, Token};
<a href="#h10-0-3" id="h10-0-3" class="i">+
</a><a href="#h10-0-4" id="h10-0-4" class="i">+use regex::Regex;
</a> use std::collections::BTreeMap;
 
 /// An SQL parser
<a href="#h10-1" id="h10-1" class="h">@@ -447,7 +449,15 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>     /// Parses an expression atom
     fn parse_expression_atom(&amp;mut self) -&gt; Result&lt;ast::Expression, Error&gt; {
         Ok(match self.next()? {
<a href="#h10-1-3" id="h10-1-3" class="d">-            Token::Ident(i) =&gt; ast::Expression::Field(i),
</a><a href="#h10-1-4" id="h10-1-4" class="i">+            Token::Ident(i) =&gt; {
</a><a href="#h10-1-5" id="h10-1-5" class="i">+                let mut relation = None;
</a><a href="#h10-1-6" id="h10-1-6" class="i">+                let mut field = i;
</a><a href="#h10-1-7" id="h10-1-7" class="i">+                if self.next_if_token(Token::Period).is_some() {
</a><a href="#h10-1-8" id="h10-1-8" class="i">+                    relation = Some(field);
</a><a href="#h10-1-9" id="h10-1-9" class="i">+                    field = self.next_ident()?;
</a><a href="#h10-1-10" id="h10-1-10" class="i">+                }
</a><a href="#h10-1-11" id="h10-1-11" class="i">+                ast::Expression::Field(relation, field)
</a><a href="#h10-1-12" id="h10-1-12" class="i">+            }
</a>             Token::Number(n) =&gt; {
                 if n.chars().all(|c| c.is_digit(10)) {
                     ast::Literal::Integer(n.parse()?).into()
<a href="#h10-2" id="h10-2" class="h">@@ -672,3 +682,16 @@ impl Operator for PostfixOperator {
</a>         8
     }
 }
<a href="#h10-2-3" id="h10-2-3" class="i">+
</a><a href="#h10-2-4" id="h10-2-4" class="i">+// Formats an identifier by quoting it as appropriate
</a><a href="#h10-2-5" id="h10-2-5" class="i">+pub(super) fn format_ident(ident: &amp;str) -&gt; String {
</a><a href="#h10-2-6" id="h10-2-6" class="i">+    lazy_static! {
</a><a href="#h10-2-7" id="h10-2-7" class="i">+        static ref RE_IDENT: Regex = Regex::new(r#&quot;^\w[\w_]*$&quot;#).unwrap();
</a><a href="#h10-2-8" id="h10-2-8" class="i">+    }
</a><a href="#h10-2-9" id="h10-2-9" class="i">+
</a><a href="#h10-2-10" id="h10-2-10" class="i">+    if RE_IDENT.is_match(ident) &amp;&amp; Keyword::from_str(ident).is_none() {
</a><a href="#h10-2-11" id="h10-2-11" class="i">+        ident.to_string()
</a><a href="#h10-2-12" id="h10-2-12" class="i">+    } else {
</a><a href="#h10-2-13" id="h10-2-13" class="i">+        format!(&quot;\&quot;{}\&quot;&quot;, ident.replace(&quot;\&quot;&quot;, &quot;\&quot;\&quot;&quot;))
</a><a href="#h10-2-14" id="h10-2-14" class="i">+    }
</a><a href="#h10-2-15" id="h10-2-15" class="i">+}
</a><b>diff --git a/<a id="h11" href="../file/src/sql/planner/mod.rs.html">src/sql/planner/mod.rs</a> b/<a href="../file/src/sql/planner/mod.rs.html">src/sql/planner/mod.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -209,7 +209,7 @@ impl From&lt;ast::Expression&gt; for Expression {
</a>     fn from(expr: ast::Expression) -&gt; Self {
         match expr {
             ast::Expression::Literal(l) =&gt; Expression::Constant(l.into()),
<a href="#h11-0-3" id="h11-0-3" class="d">-            ast::Expression::Field(name) =&gt; Expression::Field(name),
</a><a href="#h11-0-4" id="h11-0-4" class="i">+            ast::Expression::Field(rel, name) =&gt; Expression::Field(rel, name),
</a>             ast::Expression::Operation(op) =&gt; match op {
                 // Logical operators
                 ast::Operation::And(lhs, rhs) =&gt; Self::And(lhs.into(), rhs.into()),
<b>diff --git a/<a id="h12" href="../file/src/sql/tests/query.rs.html">src/sql/tests/query.rs</a> b/<a href="../file/src/sql/tests/query.rs.html">src/sql/tests/query.rs</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -118,7 +118,10 @@ macro_rules! test_query {
</a>                 }
             };
             if !columns.is_empty() || !rows.is_empty() {
<a href="#h12-0-3" id="h12-0-3" class="d">-                write!(f, &quot; {:?}\n&quot;, columns)?;
</a><a href="#h12-0-4" id="h12-0-4" class="i">+                write!(f, &quot; {:?}\n&quot;, columns
</a><a href="#h12-0-5" id="h12-0-5" class="i">+                    .into_iter()
</a><a href="#h12-0-6" id="h12-0-6" class="i">+                    .map(|c| c.unwrap_or_else(|| &quot;?&quot;.to_string()))
</a><a href="#h12-0-7" id="h12-0-7" class="i">+                    .collect::&lt;Vec&lt;_&gt;&gt;())?;
</a>                 for row in rows {
                     write!(f, &quot;{:?}\n&quot;, row)?;
                 }
<a href="#h12-1" id="h12-1" class="h">@@ -136,9 +139,18 @@ test_query! {
</a>     all: &quot;SELECT * FROM movies&quot;,
     bare: &quot;SELECT&quot;,
     trailing_comma: &quot;SELECT 1,&quot;,
<a href="#h12-1-3" id="h12-1-3" class="d">-    unknown: &quot;SELECT unknown&quot;,
</a>     lowercase: &quot;select 1&quot;,
 
<a href="#h12-1-6" id="h12-1-6" class="i">+    field_single: &quot;SELECT id FROM movies&quot;,
</a><a href="#h12-1-7" id="h12-1-7" class="i">+    field_multi: &quot;SELECT id, title FROM movies&quot;,
</a><a href="#h12-1-8" id="h12-1-8" class="i">+    field_ambiguous: &quot;SELECT id FROM movies, genres&quot;,
</a><a href="#h12-1-9" id="h12-1-9" class="i">+    field_qualified: &quot;SELECT movies.id FROM movies&quot;,
</a><a href="#h12-1-10" id="h12-1-10" class="i">+    field_qualified_multi: &quot;SELECT movies.id, genres.id FROM movies, genres&quot;,
</a><a href="#h12-1-11" id="h12-1-11" class="i">+    field_qualified_nested: &quot;SELECT movies.id.value FROM movies&quot;,
</a><a href="#h12-1-12" id="h12-1-12" class="i">+    field_unknown: &quot;SELECT unknown FROM movies&quot;,
</a><a href="#h12-1-13" id="h12-1-13" class="i">+    field_unknown_qualified: &quot;SELECT movies.unknown FROM movies&quot;,
</a><a href="#h12-1-14" id="h12-1-14" class="i">+    field_unknown_table: &quot;SELECT unknown.id FROM movies&quot;,
</a><a href="#h12-1-15" id="h12-1-15" class="i">+
</a>     expr_dynamic: &quot;SELECT 2020 - year AS age FROM movies&quot;,
     expr_static: &quot;SELECT 1 + 2 * 3, &#39;abc&#39; LIKE &#39;x%&#39; AS nope&quot;,
     expr_mixed: &quot;SELECT 1 + 2 * 3, 2020 - released AS age FROM movies&quot;,
<a href="#h12-2" id="h12-2" class="h">@@ -146,6 +158,8 @@ test_query! {
</a>     as_: r#&quot;SELECT 1, 2 b, 3 AS c, 4 AS &quot;ðŸ‘‹&quot;, id AS &quot;some id&quot; FROM movies&quot;#,
     as_bare: &quot;SELECT 1 AS&quot;,
     as_all: &quot;SELECT * AS all FROM movies&quot;,
<a href="#h12-2-3" id="h12-2-3" class="i">+    as_duplicate: &quot;SELECT 1 AS a, 2 AS a&quot;,
</a><a href="#h12-2-4" id="h12-2-4" class="i">+    as_qualified: r#&quot;SELECT 1 AS a.b FROM movies&quot;#,
</a> 
     from_bare: &quot;SELECT * FROM&quot;,
     from_unknown: &quot;SELECT * FROM unknown&quot;,
<a href="#h12-3" id="h12-3" class="h">@@ -160,7 +174,10 @@ test_query! {
</a>     where_integer: &quot;SELECT * FROM movies WHERE 7&quot;,
     where_string: &quot;SELECT * FROM movies WHERE &#39;abc&#39;&quot;,
     where_multi: &quot;SELECT * FROM movies WHERE TRUE, TRUE&quot;,
<a href="#h12-3-3" id="h12-3-3" class="d">-    where_unknown: &quot;SELECT * FROM movies WHERE unknown&quot;,
</a><a href="#h12-3-4" id="h12-3-4" class="i">+    where_field_unknown: &quot;SELECT * FROM movies WHERE unknown&quot;,
</a><a href="#h12-3-5" id="h12-3-5" class="i">+    where_field_qualified: &quot;SELECT movies.id, genres.id FROM movies, genres WHERE movies.id &gt;= 3 AND genres.id = 1&quot;,
</a><a href="#h12-3-6" id="h12-3-6" class="i">+    where_field_ambiguous: &quot;SELECT movies.id, genres.id FROM movies, genres WHERE id &gt;= 3&quot;,
</a><a href="#h12-3-7" id="h12-3-7" class="i">+    where_join_inner: &quot;SELECT * FROM movies, genres WHERE movies.genre_id = genres.id&quot;,
</a> 
     order: &quot;SELECT * FROM movies ORDER BY released&quot;,
     order_asc: &quot;SELECT * FROM movies ORDER BY released ASC&quot;,
<a href="#h12-4" id="h12-4" class="h">@@ -169,8 +186,11 @@ test_query! {
</a>     order_desc_lowercase: &quot;SELECT * FROM movies ORDER BY released desc&quot;,
     order_expr: &quot;SELECT id, title, released, released % 4 AS ord FROM movies ORDER BY released % 4 ASC&quot;,
     order_multi: &quot;SELECT * FROM movies ORDER BY ultrahd ASC, id DESC&quot;,
<a href="#h12-4-3" id="h12-4-3" class="d">-    order_unknown: &quot;SELECT * FROM movies ORDER BY unknown&quot;,
</a>     order_unknown_dir: &quot;SELECT * FROM movies ORDER BY id X&quot;,
<a href="#h12-4-5" id="h12-4-5" class="i">+    order_field_unknown: &quot;SELECT * FROM movies ORDER BY unknown&quot;,
</a><a href="#h12-4-6" id="h12-4-6" class="i">+    order_field_qualified: &quot;SELECT movies.id, title, name FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genres.name, movies.title&quot;,
</a><a href="#h12-4-7" id="h12-4-7" class="i">+    order_field_aliased: &quot;SELECT movies.id, title, genres.name AS genre FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genre, title&quot;,
</a><a href="#h12-4-8" id="h12-4-8" class="i">+    order_field_ambiguous: &quot;SELECT * FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY id&quot;,
</a>     order_trailing_comma: &quot;SELECT * FROM movies ORDER BY id,&quot;,
 }
 test_query! { with [
<b>diff --git a/<a id="h13" href="../file/src/sql/tests/query/as_.html">src/sql/tests/query/as_</a> b/<a href="../file/src/sql/tests/query/as_.html">src/sql/tests/query/as_</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -24,6 +24,7 @@ AST: Select {
</a>                 ),
             ),
             Field(
<a href="#h13-0-3" id="h13-0-3" class="i">+                None,
</a>                 &quot;id&quot;,
             ),
         ],
<a href="#h13-1" id="h13-1" class="h">@@ -101,6 +102,7 @@ Plan: Plan {
</a>                 ),
             ),
             Field(
<a href="#h13-1-3" id="h13-1-3" class="i">+                None,
</a>                 &quot;id&quot;,
             ),
         ],
<a href="#h13-2" id="h13-2" class="h">@@ -149,6 +151,7 @@ Optimized plan: Plan {
</a>                 ),
             ),
             Field(
<a href="#h13-2-3" id="h13-2-3" class="i">+                None,
</a>                 &quot;id&quot;,
             ),
         ],
<b>diff --git a/<a id="h14" href="../file/src/sql/tests/query/as_duplicate.html">src/sql/tests/query/as_duplicate</a> b/<a href="../file/src/sql/tests/query/as_duplicate.html">src/sql/tests/query/as_duplicate</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -0,0 +1,88 @@
</a><a href="#h14-0-0" id="h14-0-0" class="i">+Query: SELECT 1 AS a, 2 AS a
</a><a href="#h14-0-1" id="h14-0-1" class="i">+
</a><a href="#h14-0-2" id="h14-0-2" class="i">+AST: Select {
</a><a href="#h14-0-3" id="h14-0-3" class="i">+    select: SelectClause {
</a><a href="#h14-0-4" id="h14-0-4" class="i">+        expressions: [
</a><a href="#h14-0-5" id="h14-0-5" class="i">+            Literal(
</a><a href="#h14-0-6" id="h14-0-6" class="i">+                Integer(
</a><a href="#h14-0-7" id="h14-0-7" class="i">+                    1,
</a><a href="#h14-0-8" id="h14-0-8" class="i">+                ),
</a><a href="#h14-0-9" id="h14-0-9" class="i">+            ),
</a><a href="#h14-0-10" id="h14-0-10" class="i">+            Literal(
</a><a href="#h14-0-11" id="h14-0-11" class="i">+                Integer(
</a><a href="#h14-0-12" id="h14-0-12" class="i">+                    2,
</a><a href="#h14-0-13" id="h14-0-13" class="i">+                ),
</a><a href="#h14-0-14" id="h14-0-14" class="i">+            ),
</a><a href="#h14-0-15" id="h14-0-15" class="i">+        ],
</a><a href="#h14-0-16" id="h14-0-16" class="i">+        labels: [
</a><a href="#h14-0-17" id="h14-0-17" class="i">+            Some(
</a><a href="#h14-0-18" id="h14-0-18" class="i">+                &quot;a&quot;,
</a><a href="#h14-0-19" id="h14-0-19" class="i">+            ),
</a><a href="#h14-0-20" id="h14-0-20" class="i">+            Some(
</a><a href="#h14-0-21" id="h14-0-21" class="i">+                &quot;a&quot;,
</a><a href="#h14-0-22" id="h14-0-22" class="i">+            ),
</a><a href="#h14-0-23" id="h14-0-23" class="i">+        ],
</a><a href="#h14-0-24" id="h14-0-24" class="i">+    },
</a><a href="#h14-0-25" id="h14-0-25" class="i">+    from: None,
</a><a href="#h14-0-26" id="h14-0-26" class="i">+    where: None,
</a><a href="#h14-0-27" id="h14-0-27" class="i">+    order: [],
</a><a href="#h14-0-28" id="h14-0-28" class="i">+    limit: None,
</a><a href="#h14-0-29" id="h14-0-29" class="i">+    offset: None,
</a><a href="#h14-0-30" id="h14-0-30" class="i">+}
</a><a href="#h14-0-31" id="h14-0-31" class="i">+
</a><a href="#h14-0-32" id="h14-0-32" class="i">+Plan: Plan {
</a><a href="#h14-0-33" id="h14-0-33" class="i">+    root: Projection {
</a><a href="#h14-0-34" id="h14-0-34" class="i">+        source: Nothing,
</a><a href="#h14-0-35" id="h14-0-35" class="i">+        labels: [
</a><a href="#h14-0-36" id="h14-0-36" class="i">+            Some(
</a><a href="#h14-0-37" id="h14-0-37" class="i">+                &quot;a&quot;,
</a><a href="#h14-0-38" id="h14-0-38" class="i">+            ),
</a><a href="#h14-0-39" id="h14-0-39" class="i">+            Some(
</a><a href="#h14-0-40" id="h14-0-40" class="i">+                &quot;a&quot;,
</a><a href="#h14-0-41" id="h14-0-41" class="i">+            ),
</a><a href="#h14-0-42" id="h14-0-42" class="i">+        ],
</a><a href="#h14-0-43" id="h14-0-43" class="i">+        expressions: [
</a><a href="#h14-0-44" id="h14-0-44" class="i">+            Constant(
</a><a href="#h14-0-45" id="h14-0-45" class="i">+                Integer(
</a><a href="#h14-0-46" id="h14-0-46" class="i">+                    1,
</a><a href="#h14-0-47" id="h14-0-47" class="i">+                ),
</a><a href="#h14-0-48" id="h14-0-48" class="i">+            ),
</a><a href="#h14-0-49" id="h14-0-49" class="i">+            Constant(
</a><a href="#h14-0-50" id="h14-0-50" class="i">+                Integer(
</a><a href="#h14-0-51" id="h14-0-51" class="i">+                    2,
</a><a href="#h14-0-52" id="h14-0-52" class="i">+                ),
</a><a href="#h14-0-53" id="h14-0-53" class="i">+            ),
</a><a href="#h14-0-54" id="h14-0-54" class="i">+        ],
</a><a href="#h14-0-55" id="h14-0-55" class="i">+    },
</a><a href="#h14-0-56" id="h14-0-56" class="i">+}
</a><a href="#h14-0-57" id="h14-0-57" class="i">+
</a><a href="#h14-0-58" id="h14-0-58" class="i">+Optimized plan: Plan {
</a><a href="#h14-0-59" id="h14-0-59" class="i">+    root: Projection {
</a><a href="#h14-0-60" id="h14-0-60" class="i">+        source: Nothing,
</a><a href="#h14-0-61" id="h14-0-61" class="i">+        labels: [
</a><a href="#h14-0-62" id="h14-0-62" class="i">+            Some(
</a><a href="#h14-0-63" id="h14-0-63" class="i">+                &quot;a&quot;,
</a><a href="#h14-0-64" id="h14-0-64" class="i">+            ),
</a><a href="#h14-0-65" id="h14-0-65" class="i">+            Some(
</a><a href="#h14-0-66" id="h14-0-66" class="i">+                &quot;a&quot;,
</a><a href="#h14-0-67" id="h14-0-67" class="i">+            ),
</a><a href="#h14-0-68" id="h14-0-68" class="i">+        ],
</a><a href="#h14-0-69" id="h14-0-69" class="i">+        expressions: [
</a><a href="#h14-0-70" id="h14-0-70" class="i">+            Constant(
</a><a href="#h14-0-71" id="h14-0-71" class="i">+                Integer(
</a><a href="#h14-0-72" id="h14-0-72" class="i">+                    1,
</a><a href="#h14-0-73" id="h14-0-73" class="i">+                ),
</a><a href="#h14-0-74" id="h14-0-74" class="i">+            ),
</a><a href="#h14-0-75" id="h14-0-75" class="i">+            Constant(
</a><a href="#h14-0-76" id="h14-0-76" class="i">+                Integer(
</a><a href="#h14-0-77" id="h14-0-77" class="i">+                    2,
</a><a href="#h14-0-78" id="h14-0-78" class="i">+                ),
</a><a href="#h14-0-79" id="h14-0-79" class="i">+            ),
</a><a href="#h14-0-80" id="h14-0-80" class="i">+        ],
</a><a href="#h14-0-81" id="h14-0-81" class="i">+    },
</a><a href="#h14-0-82" id="h14-0-82" class="i">+}
</a><a href="#h14-0-83" id="h14-0-83" class="i">+
</a><a href="#h14-0-84" id="h14-0-84" class="i">+Query: SELECT 1 AS a, 2 AS a
</a><a href="#h14-0-85" id="h14-0-85" class="i">+
</a><a href="#h14-0-86" id="h14-0-86" class="i">+Result: [&quot;a&quot;, &quot;a&quot;]
</a><a href="#h14-0-87" id="h14-0-87" class="i">+[Integer(1), Integer(2)]
</a><b>diff --git a/<a id="h15" href="../file/src/sql/tests/query/as_qualified.html">src/sql/tests/query/as_qualified</a> b/<a href="../file/src/sql/tests/query/as_qualified.html">src/sql/tests/query/as_qualified</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -0,0 +1,3 @@
</a><a href="#h15-0-0" id="h15-0-0" class="i">+Query: SELECT 1 AS a.b FROM movies
</a><a href="#h15-0-1" id="h15-0-1" class="i">+
</a><a href="#h15-0-2" id="h15-0-2" class="i">+AST: Parse(&quot;Unexpected token .&quot;)
</a><a href="#h15-0-3" id="h15-0-3" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h16" href="../file/src/sql/tests/query/expr_dynamic.html">src/sql/tests/query/expr_dynamic</a> b/<a href="../file/src/sql/tests/query/expr_dynamic.html">src/sql/tests/query/expr_dynamic</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -11,6 +11,7 @@ AST: Select {
</a>                         ),
                     ),
                     Field(
<a href="#h16-0-3" id="h16-0-3" class="i">+                        None,
</a>                         &quot;year&quot;,
                     ),
                 ),
<a href="#h16-1" id="h16-1" class="h">@@ -56,6 +57,7 @@ Plan: Plan {
</a>                     ),
                 ),
                 Field(
<a href="#h16-1-3" id="h16-1-3" class="i">+                    None,
</a>                     &quot;year&quot;,
                 ),
             ),
<a href="#h16-2" id="h16-2" class="h">@@ -81,6 +83,7 @@ Optimized plan: Plan {
</a>                     ),
                 ),
                 Field(
<a href="#h16-2-3" id="h16-2-3" class="i">+                    None,
</a>                     &quot;year&quot;,
                 ),
             ),
<b>diff --git a/<a id="h17" href="../file/src/sql/tests/query/expr_mixed.html">src/sql/tests/query/expr_mixed</a> b/<a href="../file/src/sql/tests/query/expr_mixed.html">src/sql/tests/query/expr_mixed</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -34,6 +34,7 @@ AST: Select {
</a>                         ),
                     ),
                     Field(
<a href="#h17-0-3" id="h17-0-3" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                 ),
<a href="#h17-1" id="h17-1" class="h">@@ -100,6 +101,7 @@ Plan: Plan {
</a>                     ),
                 ),
                 Field(
<a href="#h17-1-3" id="h17-1-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
             ),
<a href="#h17-2" id="h17-2" class="h">@@ -131,6 +133,7 @@ Optimized plan: Plan {
</a>                     ),
                 ),
                 Field(
<a href="#h17-2-3" id="h17-2-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
             ),
<b>diff --git a/<a id="h18" href="../file/src/sql/tests/query/field_ambiguous.html">src/sql/tests/query/field_ambiguous</a> b/<a href="../file/src/sql/tests/query/field_ambiguous.html">src/sql/tests/query/field_ambiguous</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -0,0 +1,81 @@
</a><a href="#h18-0-0" id="h18-0-0" class="i">+Query: SELECT id FROM movies, genres
</a><a href="#h18-0-1" id="h18-0-1" class="i">+
</a><a href="#h18-0-2" id="h18-0-2" class="i">+AST: Select {
</a><a href="#h18-0-3" id="h18-0-3" class="i">+    select: SelectClause {
</a><a href="#h18-0-4" id="h18-0-4" class="i">+        expressions: [
</a><a href="#h18-0-5" id="h18-0-5" class="i">+            Field(
</a><a href="#h18-0-6" id="h18-0-6" class="i">+                None,
</a><a href="#h18-0-7" id="h18-0-7" class="i">+                &quot;id&quot;,
</a><a href="#h18-0-8" id="h18-0-8" class="i">+            ),
</a><a href="#h18-0-9" id="h18-0-9" class="i">+        ],
</a><a href="#h18-0-10" id="h18-0-10" class="i">+        labels: [
</a><a href="#h18-0-11" id="h18-0-11" class="i">+            None,
</a><a href="#h18-0-12" id="h18-0-12" class="i">+        ],
</a><a href="#h18-0-13" id="h18-0-13" class="i">+    },
</a><a href="#h18-0-14" id="h18-0-14" class="i">+    from: Some(
</a><a href="#h18-0-15" id="h18-0-15" class="i">+        FromClause {
</a><a href="#h18-0-16" id="h18-0-16" class="i">+            items: [
</a><a href="#h18-0-17" id="h18-0-17" class="i">+                FromItem {
</a><a href="#h18-0-18" id="h18-0-18" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h18-0-19" id="h18-0-19" class="i">+                    join: None,
</a><a href="#h18-0-20" id="h18-0-20" class="i">+                },
</a><a href="#h18-0-21" id="h18-0-21" class="i">+                FromItem {
</a><a href="#h18-0-22" id="h18-0-22" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h18-0-23" id="h18-0-23" class="i">+                    join: None,
</a><a href="#h18-0-24" id="h18-0-24" class="i">+                },
</a><a href="#h18-0-25" id="h18-0-25" class="i">+            ],
</a><a href="#h18-0-26" id="h18-0-26" class="i">+        },
</a><a href="#h18-0-27" id="h18-0-27" class="i">+    ),
</a><a href="#h18-0-28" id="h18-0-28" class="i">+    where: None,
</a><a href="#h18-0-29" id="h18-0-29" class="i">+    order: [],
</a><a href="#h18-0-30" id="h18-0-30" class="i">+    limit: None,
</a><a href="#h18-0-31" id="h18-0-31" class="i">+    offset: None,
</a><a href="#h18-0-32" id="h18-0-32" class="i">+}
</a><a href="#h18-0-33" id="h18-0-33" class="i">+
</a><a href="#h18-0-34" id="h18-0-34" class="i">+Plan: Plan {
</a><a href="#h18-0-35" id="h18-0-35" class="i">+    root: Projection {
</a><a href="#h18-0-36" id="h18-0-36" class="i">+        source: NestedLoopJoin {
</a><a href="#h18-0-37" id="h18-0-37" class="i">+            outer: Scan {
</a><a href="#h18-0-38" id="h18-0-38" class="i">+                table: &quot;movies&quot;,
</a><a href="#h18-0-39" id="h18-0-39" class="i">+            },
</a><a href="#h18-0-40" id="h18-0-40" class="i">+            inner: Scan {
</a><a href="#h18-0-41" id="h18-0-41" class="i">+                table: &quot;genres&quot;,
</a><a href="#h18-0-42" id="h18-0-42" class="i">+            },
</a><a href="#h18-0-43" id="h18-0-43" class="i">+        },
</a><a href="#h18-0-44" id="h18-0-44" class="i">+        labels: [
</a><a href="#h18-0-45" id="h18-0-45" class="i">+            None,
</a><a href="#h18-0-46" id="h18-0-46" class="i">+        ],
</a><a href="#h18-0-47" id="h18-0-47" class="i">+        expressions: [
</a><a href="#h18-0-48" id="h18-0-48" class="i">+            Field(
</a><a href="#h18-0-49" id="h18-0-49" class="i">+                None,
</a><a href="#h18-0-50" id="h18-0-50" class="i">+                &quot;id&quot;,
</a><a href="#h18-0-51" id="h18-0-51" class="i">+            ),
</a><a href="#h18-0-52" id="h18-0-52" class="i">+        ],
</a><a href="#h18-0-53" id="h18-0-53" class="i">+    },
</a><a href="#h18-0-54" id="h18-0-54" class="i">+}
</a><a href="#h18-0-55" id="h18-0-55" class="i">+
</a><a href="#h18-0-56" id="h18-0-56" class="i">+Optimized plan: Plan {
</a><a href="#h18-0-57" id="h18-0-57" class="i">+    root: Projection {
</a><a href="#h18-0-58" id="h18-0-58" class="i">+        source: NestedLoopJoin {
</a><a href="#h18-0-59" id="h18-0-59" class="i">+            outer: Scan {
</a><a href="#h18-0-60" id="h18-0-60" class="i">+                table: &quot;movies&quot;,
</a><a href="#h18-0-61" id="h18-0-61" class="i">+            },
</a><a href="#h18-0-62" id="h18-0-62" class="i">+            inner: Scan {
</a><a href="#h18-0-63" id="h18-0-63" class="i">+                table: &quot;genres&quot;,
</a><a href="#h18-0-64" id="h18-0-64" class="i">+            },
</a><a href="#h18-0-65" id="h18-0-65" class="i">+        },
</a><a href="#h18-0-66" id="h18-0-66" class="i">+        labels: [
</a><a href="#h18-0-67" id="h18-0-67" class="i">+            None,
</a><a href="#h18-0-68" id="h18-0-68" class="i">+        ],
</a><a href="#h18-0-69" id="h18-0-69" class="i">+        expressions: [
</a><a href="#h18-0-70" id="h18-0-70" class="i">+            Field(
</a><a href="#h18-0-71" id="h18-0-71" class="i">+                None,
</a><a href="#h18-0-72" id="h18-0-72" class="i">+                &quot;id&quot;,
</a><a href="#h18-0-73" id="h18-0-73" class="i">+            ),
</a><a href="#h18-0-74" id="h18-0-74" class="i">+        ],
</a><a href="#h18-0-75" id="h18-0-75" class="i">+    },
</a><a href="#h18-0-76" id="h18-0-76" class="i">+}
</a><a href="#h18-0-77" id="h18-0-77" class="i">+
</a><a href="#h18-0-78" id="h18-0-78" class="i">+Query: SELECT id FROM movies, genres
</a><a href="#h18-0-79" id="h18-0-79" class="i">+
</a><a href="#h18-0-80" id="h18-0-80" class="i">+Result: Value(&quot;Field reference id is ambiguous&quot;)
</a><a href="#h18-0-81" id="h18-0-81" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h19" href="../file/src/sql/tests/query/field_multi.html">src/sql/tests/query/field_multi</a> b/<a href="../file/src/sql/tests/query/field_multi.html">src/sql/tests/query/field_multi</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -0,0 +1,87 @@
</a><a href="#h19-0-0" id="h19-0-0" class="i">+Query: SELECT id, title FROM movies
</a><a href="#h19-0-1" id="h19-0-1" class="i">+
</a><a href="#h19-0-2" id="h19-0-2" class="i">+AST: Select {
</a><a href="#h19-0-3" id="h19-0-3" class="i">+    select: SelectClause {
</a><a href="#h19-0-4" id="h19-0-4" class="i">+        expressions: [
</a><a href="#h19-0-5" id="h19-0-5" class="i">+            Field(
</a><a href="#h19-0-6" id="h19-0-6" class="i">+                None,
</a><a href="#h19-0-7" id="h19-0-7" class="i">+                &quot;id&quot;,
</a><a href="#h19-0-8" id="h19-0-8" class="i">+            ),
</a><a href="#h19-0-9" id="h19-0-9" class="i">+            Field(
</a><a href="#h19-0-10" id="h19-0-10" class="i">+                None,
</a><a href="#h19-0-11" id="h19-0-11" class="i">+                &quot;title&quot;,
</a><a href="#h19-0-12" id="h19-0-12" class="i">+            ),
</a><a href="#h19-0-13" id="h19-0-13" class="i">+        ],
</a><a href="#h19-0-14" id="h19-0-14" class="i">+        labels: [
</a><a href="#h19-0-15" id="h19-0-15" class="i">+            None,
</a><a href="#h19-0-16" id="h19-0-16" class="i">+            None,
</a><a href="#h19-0-17" id="h19-0-17" class="i">+        ],
</a><a href="#h19-0-18" id="h19-0-18" class="i">+    },
</a><a href="#h19-0-19" id="h19-0-19" class="i">+    from: Some(
</a><a href="#h19-0-20" id="h19-0-20" class="i">+        FromClause {
</a><a href="#h19-0-21" id="h19-0-21" class="i">+            items: [
</a><a href="#h19-0-22" id="h19-0-22" class="i">+                FromItem {
</a><a href="#h19-0-23" id="h19-0-23" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h19-0-24" id="h19-0-24" class="i">+                    join: None,
</a><a href="#h19-0-25" id="h19-0-25" class="i">+                },
</a><a href="#h19-0-26" id="h19-0-26" class="i">+            ],
</a><a href="#h19-0-27" id="h19-0-27" class="i">+        },
</a><a href="#h19-0-28" id="h19-0-28" class="i">+    ),
</a><a href="#h19-0-29" id="h19-0-29" class="i">+    where: None,
</a><a href="#h19-0-30" id="h19-0-30" class="i">+    order: [],
</a><a href="#h19-0-31" id="h19-0-31" class="i">+    limit: None,
</a><a href="#h19-0-32" id="h19-0-32" class="i">+    offset: None,
</a><a href="#h19-0-33" id="h19-0-33" class="i">+}
</a><a href="#h19-0-34" id="h19-0-34" class="i">+
</a><a href="#h19-0-35" id="h19-0-35" class="i">+Plan: Plan {
</a><a href="#h19-0-36" id="h19-0-36" class="i">+    root: Projection {
</a><a href="#h19-0-37" id="h19-0-37" class="i">+        source: Scan {
</a><a href="#h19-0-38" id="h19-0-38" class="i">+            table: &quot;movies&quot;,
</a><a href="#h19-0-39" id="h19-0-39" class="i">+        },
</a><a href="#h19-0-40" id="h19-0-40" class="i">+        labels: [
</a><a href="#h19-0-41" id="h19-0-41" class="i">+            None,
</a><a href="#h19-0-42" id="h19-0-42" class="i">+            None,
</a><a href="#h19-0-43" id="h19-0-43" class="i">+        ],
</a><a href="#h19-0-44" id="h19-0-44" class="i">+        expressions: [
</a><a href="#h19-0-45" id="h19-0-45" class="i">+            Field(
</a><a href="#h19-0-46" id="h19-0-46" class="i">+                None,
</a><a href="#h19-0-47" id="h19-0-47" class="i">+                &quot;id&quot;,
</a><a href="#h19-0-48" id="h19-0-48" class="i">+            ),
</a><a href="#h19-0-49" id="h19-0-49" class="i">+            Field(
</a><a href="#h19-0-50" id="h19-0-50" class="i">+                None,
</a><a href="#h19-0-51" id="h19-0-51" class="i">+                &quot;title&quot;,
</a><a href="#h19-0-52" id="h19-0-52" class="i">+            ),
</a><a href="#h19-0-53" id="h19-0-53" class="i">+        ],
</a><a href="#h19-0-54" id="h19-0-54" class="i">+    },
</a><a href="#h19-0-55" id="h19-0-55" class="i">+}
</a><a href="#h19-0-56" id="h19-0-56" class="i">+
</a><a href="#h19-0-57" id="h19-0-57" class="i">+Optimized plan: Plan {
</a><a href="#h19-0-58" id="h19-0-58" class="i">+    root: Projection {
</a><a href="#h19-0-59" id="h19-0-59" class="i">+        source: Scan {
</a><a href="#h19-0-60" id="h19-0-60" class="i">+            table: &quot;movies&quot;,
</a><a href="#h19-0-61" id="h19-0-61" class="i">+        },
</a><a href="#h19-0-62" id="h19-0-62" class="i">+        labels: [
</a><a href="#h19-0-63" id="h19-0-63" class="i">+            None,
</a><a href="#h19-0-64" id="h19-0-64" class="i">+            None,
</a><a href="#h19-0-65" id="h19-0-65" class="i">+        ],
</a><a href="#h19-0-66" id="h19-0-66" class="i">+        expressions: [
</a><a href="#h19-0-67" id="h19-0-67" class="i">+            Field(
</a><a href="#h19-0-68" id="h19-0-68" class="i">+                None,
</a><a href="#h19-0-69" id="h19-0-69" class="i">+                &quot;id&quot;,
</a><a href="#h19-0-70" id="h19-0-70" class="i">+            ),
</a><a href="#h19-0-71" id="h19-0-71" class="i">+            Field(
</a><a href="#h19-0-72" id="h19-0-72" class="i">+                None,
</a><a href="#h19-0-73" id="h19-0-73" class="i">+                &quot;title&quot;,
</a><a href="#h19-0-74" id="h19-0-74" class="i">+            ),
</a><a href="#h19-0-75" id="h19-0-75" class="i">+        ],
</a><a href="#h19-0-76" id="h19-0-76" class="i">+    },
</a><a href="#h19-0-77" id="h19-0-77" class="i">+}
</a><a href="#h19-0-78" id="h19-0-78" class="i">+
</a><a href="#h19-0-79" id="h19-0-79" class="i">+Query: SELECT id, title FROM movies
</a><a href="#h19-0-80" id="h19-0-80" class="i">+
</a><a href="#h19-0-81" id="h19-0-81" class="i">+Result: [&quot;id&quot;, &quot;title&quot;]
</a><a href="#h19-0-82" id="h19-0-82" class="i">+[Integer(1), String(&quot;Stalker&quot;)]
</a><a href="#h19-0-83" id="h19-0-83" class="i">+[Integer(2), String(&quot;Sicario&quot;)]
</a><a href="#h19-0-84" id="h19-0-84" class="i">+[Integer(3), String(&quot;Primer&quot;)]
</a><a href="#h19-0-85" id="h19-0-85" class="i">+[Integer(4), String(&quot;Heat&quot;)]
</a><a href="#h19-0-86" id="h19-0-86" class="i">+[Integer(5), String(&quot;The Fountain&quot;)]
</a><b>diff --git a/<a id="h20" href="../file/src/sql/tests/query/field_qualified.html">src/sql/tests/query/field_qualified</a> b/<a href="../file/src/sql/tests/query/field_qualified.html">src/sql/tests/query/field_qualified</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -0,0 +1,78 @@
</a><a href="#h20-0-0" id="h20-0-0" class="i">+Query: SELECT movies.id FROM movies
</a><a href="#h20-0-1" id="h20-0-1" class="i">+
</a><a href="#h20-0-2" id="h20-0-2" class="i">+AST: Select {
</a><a href="#h20-0-3" id="h20-0-3" class="i">+    select: SelectClause {
</a><a href="#h20-0-4" id="h20-0-4" class="i">+        expressions: [
</a><a href="#h20-0-5" id="h20-0-5" class="i">+            Field(
</a><a href="#h20-0-6" id="h20-0-6" class="i">+                Some(
</a><a href="#h20-0-7" id="h20-0-7" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-0-8" id="h20-0-8" class="i">+                ),
</a><a href="#h20-0-9" id="h20-0-9" class="i">+                &quot;id&quot;,
</a><a href="#h20-0-10" id="h20-0-10" class="i">+            ),
</a><a href="#h20-0-11" id="h20-0-11" class="i">+        ],
</a><a href="#h20-0-12" id="h20-0-12" class="i">+        labels: [
</a><a href="#h20-0-13" id="h20-0-13" class="i">+            None,
</a><a href="#h20-0-14" id="h20-0-14" class="i">+        ],
</a><a href="#h20-0-15" id="h20-0-15" class="i">+    },
</a><a href="#h20-0-16" id="h20-0-16" class="i">+    from: Some(
</a><a href="#h20-0-17" id="h20-0-17" class="i">+        FromClause {
</a><a href="#h20-0-18" id="h20-0-18" class="i">+            items: [
</a><a href="#h20-0-19" id="h20-0-19" class="i">+                FromItem {
</a><a href="#h20-0-20" id="h20-0-20" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h20-0-21" id="h20-0-21" class="i">+                    join: None,
</a><a href="#h20-0-22" id="h20-0-22" class="i">+                },
</a><a href="#h20-0-23" id="h20-0-23" class="i">+            ],
</a><a href="#h20-0-24" id="h20-0-24" class="i">+        },
</a><a href="#h20-0-25" id="h20-0-25" class="i">+    ),
</a><a href="#h20-0-26" id="h20-0-26" class="i">+    where: None,
</a><a href="#h20-0-27" id="h20-0-27" class="i">+    order: [],
</a><a href="#h20-0-28" id="h20-0-28" class="i">+    limit: None,
</a><a href="#h20-0-29" id="h20-0-29" class="i">+    offset: None,
</a><a href="#h20-0-30" id="h20-0-30" class="i">+}
</a><a href="#h20-0-31" id="h20-0-31" class="i">+
</a><a href="#h20-0-32" id="h20-0-32" class="i">+Plan: Plan {
</a><a href="#h20-0-33" id="h20-0-33" class="i">+    root: Projection {
</a><a href="#h20-0-34" id="h20-0-34" class="i">+        source: Scan {
</a><a href="#h20-0-35" id="h20-0-35" class="i">+            table: &quot;movies&quot;,
</a><a href="#h20-0-36" id="h20-0-36" class="i">+        },
</a><a href="#h20-0-37" id="h20-0-37" class="i">+        labels: [
</a><a href="#h20-0-38" id="h20-0-38" class="i">+            None,
</a><a href="#h20-0-39" id="h20-0-39" class="i">+        ],
</a><a href="#h20-0-40" id="h20-0-40" class="i">+        expressions: [
</a><a href="#h20-0-41" id="h20-0-41" class="i">+            Field(
</a><a href="#h20-0-42" id="h20-0-42" class="i">+                Some(
</a><a href="#h20-0-43" id="h20-0-43" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-0-44" id="h20-0-44" class="i">+                ),
</a><a href="#h20-0-45" id="h20-0-45" class="i">+                &quot;id&quot;,
</a><a href="#h20-0-46" id="h20-0-46" class="i">+            ),
</a><a href="#h20-0-47" id="h20-0-47" class="i">+        ],
</a><a href="#h20-0-48" id="h20-0-48" class="i">+    },
</a><a href="#h20-0-49" id="h20-0-49" class="i">+}
</a><a href="#h20-0-50" id="h20-0-50" class="i">+
</a><a href="#h20-0-51" id="h20-0-51" class="i">+Optimized plan: Plan {
</a><a href="#h20-0-52" id="h20-0-52" class="i">+    root: Projection {
</a><a href="#h20-0-53" id="h20-0-53" class="i">+        source: Scan {
</a><a href="#h20-0-54" id="h20-0-54" class="i">+            table: &quot;movies&quot;,
</a><a href="#h20-0-55" id="h20-0-55" class="i">+        },
</a><a href="#h20-0-56" id="h20-0-56" class="i">+        labels: [
</a><a href="#h20-0-57" id="h20-0-57" class="i">+            None,
</a><a href="#h20-0-58" id="h20-0-58" class="i">+        ],
</a><a href="#h20-0-59" id="h20-0-59" class="i">+        expressions: [
</a><a href="#h20-0-60" id="h20-0-60" class="i">+            Field(
</a><a href="#h20-0-61" id="h20-0-61" class="i">+                Some(
</a><a href="#h20-0-62" id="h20-0-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h20-0-63" id="h20-0-63" class="i">+                ),
</a><a href="#h20-0-64" id="h20-0-64" class="i">+                &quot;id&quot;,
</a><a href="#h20-0-65" id="h20-0-65" class="i">+            ),
</a><a href="#h20-0-66" id="h20-0-66" class="i">+        ],
</a><a href="#h20-0-67" id="h20-0-67" class="i">+    },
</a><a href="#h20-0-68" id="h20-0-68" class="i">+}
</a><a href="#h20-0-69" id="h20-0-69" class="i">+
</a><a href="#h20-0-70" id="h20-0-70" class="i">+Query: SELECT movies.id FROM movies
</a><a href="#h20-0-71" id="h20-0-71" class="i">+
</a><a href="#h20-0-72" id="h20-0-72" class="i">+Result: [&quot;id&quot;]
</a><a href="#h20-0-73" id="h20-0-73" class="i">+[Integer(1)]
</a><a href="#h20-0-74" id="h20-0-74" class="i">+[Integer(2)]
</a><a href="#h20-0-75" id="h20-0-75" class="i">+[Integer(3)]
</a><a href="#h20-0-76" id="h20-0-76" class="i">+[Integer(4)]
</a><a href="#h20-0-77" id="h20-0-77" class="i">+[Integer(5)]
</a><b>diff --git a/<a id="h21" href="../file/src/sql/tests/query/field_qualified_multi.html">src/sql/tests/query/field_qualified_multi</a> b/<a href="../file/src/sql/tests/query/field_qualified_multi.html">src/sql/tests/query/field_qualified_multi</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -0,0 +1,118 @@
</a><a href="#h21-0-0" id="h21-0-0" class="i">+Query: SELECT movies.id, genres.id FROM movies, genres
</a><a href="#h21-0-1" id="h21-0-1" class="i">+
</a><a href="#h21-0-2" id="h21-0-2" class="i">+AST: Select {
</a><a href="#h21-0-3" id="h21-0-3" class="i">+    select: SelectClause {
</a><a href="#h21-0-4" id="h21-0-4" class="i">+        expressions: [
</a><a href="#h21-0-5" id="h21-0-5" class="i">+            Field(
</a><a href="#h21-0-6" id="h21-0-6" class="i">+                Some(
</a><a href="#h21-0-7" id="h21-0-7" class="i">+                    &quot;movies&quot;,
</a><a href="#h21-0-8" id="h21-0-8" class="i">+                ),
</a><a href="#h21-0-9" id="h21-0-9" class="i">+                &quot;id&quot;,
</a><a href="#h21-0-10" id="h21-0-10" class="i">+            ),
</a><a href="#h21-0-11" id="h21-0-11" class="i">+            Field(
</a><a href="#h21-0-12" id="h21-0-12" class="i">+                Some(
</a><a href="#h21-0-13" id="h21-0-13" class="i">+                    &quot;genres&quot;,
</a><a href="#h21-0-14" id="h21-0-14" class="i">+                ),
</a><a href="#h21-0-15" id="h21-0-15" class="i">+                &quot;id&quot;,
</a><a href="#h21-0-16" id="h21-0-16" class="i">+            ),
</a><a href="#h21-0-17" id="h21-0-17" class="i">+        ],
</a><a href="#h21-0-18" id="h21-0-18" class="i">+        labels: [
</a><a href="#h21-0-19" id="h21-0-19" class="i">+            None,
</a><a href="#h21-0-20" id="h21-0-20" class="i">+            None,
</a><a href="#h21-0-21" id="h21-0-21" class="i">+        ],
</a><a href="#h21-0-22" id="h21-0-22" class="i">+    },
</a><a href="#h21-0-23" id="h21-0-23" class="i">+    from: Some(
</a><a href="#h21-0-24" id="h21-0-24" class="i">+        FromClause {
</a><a href="#h21-0-25" id="h21-0-25" class="i">+            items: [
</a><a href="#h21-0-26" id="h21-0-26" class="i">+                FromItem {
</a><a href="#h21-0-27" id="h21-0-27" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h21-0-28" id="h21-0-28" class="i">+                    join: None,
</a><a href="#h21-0-29" id="h21-0-29" class="i">+                },
</a><a href="#h21-0-30" id="h21-0-30" class="i">+                FromItem {
</a><a href="#h21-0-31" id="h21-0-31" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h21-0-32" id="h21-0-32" class="i">+                    join: None,
</a><a href="#h21-0-33" id="h21-0-33" class="i">+                },
</a><a href="#h21-0-34" id="h21-0-34" class="i">+            ],
</a><a href="#h21-0-35" id="h21-0-35" class="i">+        },
</a><a href="#h21-0-36" id="h21-0-36" class="i">+    ),
</a><a href="#h21-0-37" id="h21-0-37" class="i">+    where: None,
</a><a href="#h21-0-38" id="h21-0-38" class="i">+    order: [],
</a><a href="#h21-0-39" id="h21-0-39" class="i">+    limit: None,
</a><a href="#h21-0-40" id="h21-0-40" class="i">+    offset: None,
</a><a href="#h21-0-41" id="h21-0-41" class="i">+}
</a><a href="#h21-0-42" id="h21-0-42" class="i">+
</a><a href="#h21-0-43" id="h21-0-43" class="i">+Plan: Plan {
</a><a href="#h21-0-44" id="h21-0-44" class="i">+    root: Projection {
</a><a href="#h21-0-45" id="h21-0-45" class="i">+        source: NestedLoopJoin {
</a><a href="#h21-0-46" id="h21-0-46" class="i">+            outer: Scan {
</a><a href="#h21-0-47" id="h21-0-47" class="i">+                table: &quot;movies&quot;,
</a><a href="#h21-0-48" id="h21-0-48" class="i">+            },
</a><a href="#h21-0-49" id="h21-0-49" class="i">+            inner: Scan {
</a><a href="#h21-0-50" id="h21-0-50" class="i">+                table: &quot;genres&quot;,
</a><a href="#h21-0-51" id="h21-0-51" class="i">+            },
</a><a href="#h21-0-52" id="h21-0-52" class="i">+        },
</a><a href="#h21-0-53" id="h21-0-53" class="i">+        labels: [
</a><a href="#h21-0-54" id="h21-0-54" class="i">+            None,
</a><a href="#h21-0-55" id="h21-0-55" class="i">+            None,
</a><a href="#h21-0-56" id="h21-0-56" class="i">+        ],
</a><a href="#h21-0-57" id="h21-0-57" class="i">+        expressions: [
</a><a href="#h21-0-58" id="h21-0-58" class="i">+            Field(
</a><a href="#h21-0-59" id="h21-0-59" class="i">+                Some(
</a><a href="#h21-0-60" id="h21-0-60" class="i">+                    &quot;movies&quot;,
</a><a href="#h21-0-61" id="h21-0-61" class="i">+                ),
</a><a href="#h21-0-62" id="h21-0-62" class="i">+                &quot;id&quot;,
</a><a href="#h21-0-63" id="h21-0-63" class="i">+            ),
</a><a href="#h21-0-64" id="h21-0-64" class="i">+            Field(
</a><a href="#h21-0-65" id="h21-0-65" class="i">+                Some(
</a><a href="#h21-0-66" id="h21-0-66" class="i">+                    &quot;genres&quot;,
</a><a href="#h21-0-67" id="h21-0-67" class="i">+                ),
</a><a href="#h21-0-68" id="h21-0-68" class="i">+                &quot;id&quot;,
</a><a href="#h21-0-69" id="h21-0-69" class="i">+            ),
</a><a href="#h21-0-70" id="h21-0-70" class="i">+        ],
</a><a href="#h21-0-71" id="h21-0-71" class="i">+    },
</a><a href="#h21-0-72" id="h21-0-72" class="i">+}
</a><a href="#h21-0-73" id="h21-0-73" class="i">+
</a><a href="#h21-0-74" id="h21-0-74" class="i">+Optimized plan: Plan {
</a><a href="#h21-0-75" id="h21-0-75" class="i">+    root: Projection {
</a><a href="#h21-0-76" id="h21-0-76" class="i">+        source: NestedLoopJoin {
</a><a href="#h21-0-77" id="h21-0-77" class="i">+            outer: Scan {
</a><a href="#h21-0-78" id="h21-0-78" class="i">+                table: &quot;movies&quot;,
</a><a href="#h21-0-79" id="h21-0-79" class="i">+            },
</a><a href="#h21-0-80" id="h21-0-80" class="i">+            inner: Scan {
</a><a href="#h21-0-81" id="h21-0-81" class="i">+                table: &quot;genres&quot;,
</a><a href="#h21-0-82" id="h21-0-82" class="i">+            },
</a><a href="#h21-0-83" id="h21-0-83" class="i">+        },
</a><a href="#h21-0-84" id="h21-0-84" class="i">+        labels: [
</a><a href="#h21-0-85" id="h21-0-85" class="i">+            None,
</a><a href="#h21-0-86" id="h21-0-86" class="i">+            None,
</a><a href="#h21-0-87" id="h21-0-87" class="i">+        ],
</a><a href="#h21-0-88" id="h21-0-88" class="i">+        expressions: [
</a><a href="#h21-0-89" id="h21-0-89" class="i">+            Field(
</a><a href="#h21-0-90" id="h21-0-90" class="i">+                Some(
</a><a href="#h21-0-91" id="h21-0-91" class="i">+                    &quot;movies&quot;,
</a><a href="#h21-0-92" id="h21-0-92" class="i">+                ),
</a><a href="#h21-0-93" id="h21-0-93" class="i">+                &quot;id&quot;,
</a><a href="#h21-0-94" id="h21-0-94" class="i">+            ),
</a><a href="#h21-0-95" id="h21-0-95" class="i">+            Field(
</a><a href="#h21-0-96" id="h21-0-96" class="i">+                Some(
</a><a href="#h21-0-97" id="h21-0-97" class="i">+                    &quot;genres&quot;,
</a><a href="#h21-0-98" id="h21-0-98" class="i">+                ),
</a><a href="#h21-0-99" id="h21-0-99" class="i">+                &quot;id&quot;,
</a><a href="#h21-0-100" id="h21-0-100" class="i">+            ),
</a><a href="#h21-0-101" id="h21-0-101" class="i">+        ],
</a><a href="#h21-0-102" id="h21-0-102" class="i">+    },
</a><a href="#h21-0-103" id="h21-0-103" class="i">+}
</a><a href="#h21-0-104" id="h21-0-104" class="i">+
</a><a href="#h21-0-105" id="h21-0-105" class="i">+Query: SELECT movies.id, genres.id FROM movies, genres
</a><a href="#h21-0-106" id="h21-0-106" class="i">+
</a><a href="#h21-0-107" id="h21-0-107" class="i">+Result: [&quot;id&quot;, &quot;id&quot;]
</a><a href="#h21-0-108" id="h21-0-108" class="i">+[Integer(1), Integer(1)]
</a><a href="#h21-0-109" id="h21-0-109" class="i">+[Integer(1), Integer(2)]
</a><a href="#h21-0-110" id="h21-0-110" class="i">+[Integer(2), Integer(1)]
</a><a href="#h21-0-111" id="h21-0-111" class="i">+[Integer(2), Integer(2)]
</a><a href="#h21-0-112" id="h21-0-112" class="i">+[Integer(3), Integer(1)]
</a><a href="#h21-0-113" id="h21-0-113" class="i">+[Integer(3), Integer(2)]
</a><a href="#h21-0-114" id="h21-0-114" class="i">+[Integer(4), Integer(1)]
</a><a href="#h21-0-115" id="h21-0-115" class="i">+[Integer(4), Integer(2)]
</a><a href="#h21-0-116" id="h21-0-116" class="i">+[Integer(5), Integer(1)]
</a><a href="#h21-0-117" id="h21-0-117" class="i">+[Integer(5), Integer(2)]
</a><b>diff --git a/<a id="h22" href="../file/src/sql/tests/query/field_qualified_nested.html">src/sql/tests/query/field_qualified_nested</a> b/<a href="../file/src/sql/tests/query/field_qualified_nested.html">src/sql/tests/query/field_qualified_nested</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -0,0 +1,3 @@
</a><a href="#h22-0-0" id="h22-0-0" class="i">+Query: SELECT movies.id.value FROM movies
</a><a href="#h22-0-1" id="h22-0-1" class="i">+
</a><a href="#h22-0-2" id="h22-0-2" class="i">+AST: Parse(&quot;Unexpected token .&quot;)
</a><a href="#h22-0-3" id="h22-0-3" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h23" href="../file/src/sql/tests/query/field_single.html">src/sql/tests/query/field_single</a> b/<a href="../file/src/sql/tests/query/field_single.html">src/sql/tests/query/field_single</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -0,0 +1,72 @@
</a><a href="#h23-0-0" id="h23-0-0" class="i">+Query: SELECT id FROM movies
</a><a href="#h23-0-1" id="h23-0-1" class="i">+
</a><a href="#h23-0-2" id="h23-0-2" class="i">+AST: Select {
</a><a href="#h23-0-3" id="h23-0-3" class="i">+    select: SelectClause {
</a><a href="#h23-0-4" id="h23-0-4" class="i">+        expressions: [
</a><a href="#h23-0-5" id="h23-0-5" class="i">+            Field(
</a><a href="#h23-0-6" id="h23-0-6" class="i">+                None,
</a><a href="#h23-0-7" id="h23-0-7" class="i">+                &quot;id&quot;,
</a><a href="#h23-0-8" id="h23-0-8" class="i">+            ),
</a><a href="#h23-0-9" id="h23-0-9" class="i">+        ],
</a><a href="#h23-0-10" id="h23-0-10" class="i">+        labels: [
</a><a href="#h23-0-11" id="h23-0-11" class="i">+            None,
</a><a href="#h23-0-12" id="h23-0-12" class="i">+        ],
</a><a href="#h23-0-13" id="h23-0-13" class="i">+    },
</a><a href="#h23-0-14" id="h23-0-14" class="i">+    from: Some(
</a><a href="#h23-0-15" id="h23-0-15" class="i">+        FromClause {
</a><a href="#h23-0-16" id="h23-0-16" class="i">+            items: [
</a><a href="#h23-0-17" id="h23-0-17" class="i">+                FromItem {
</a><a href="#h23-0-18" id="h23-0-18" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h23-0-19" id="h23-0-19" class="i">+                    join: None,
</a><a href="#h23-0-20" id="h23-0-20" class="i">+                },
</a><a href="#h23-0-21" id="h23-0-21" class="i">+            ],
</a><a href="#h23-0-22" id="h23-0-22" class="i">+        },
</a><a href="#h23-0-23" id="h23-0-23" class="i">+    ),
</a><a href="#h23-0-24" id="h23-0-24" class="i">+    where: None,
</a><a href="#h23-0-25" id="h23-0-25" class="i">+    order: [],
</a><a href="#h23-0-26" id="h23-0-26" class="i">+    limit: None,
</a><a href="#h23-0-27" id="h23-0-27" class="i">+    offset: None,
</a><a href="#h23-0-28" id="h23-0-28" class="i">+}
</a><a href="#h23-0-29" id="h23-0-29" class="i">+
</a><a href="#h23-0-30" id="h23-0-30" class="i">+Plan: Plan {
</a><a href="#h23-0-31" id="h23-0-31" class="i">+    root: Projection {
</a><a href="#h23-0-32" id="h23-0-32" class="i">+        source: Scan {
</a><a href="#h23-0-33" id="h23-0-33" class="i">+            table: &quot;movies&quot;,
</a><a href="#h23-0-34" id="h23-0-34" class="i">+        },
</a><a href="#h23-0-35" id="h23-0-35" class="i">+        labels: [
</a><a href="#h23-0-36" id="h23-0-36" class="i">+            None,
</a><a href="#h23-0-37" id="h23-0-37" class="i">+        ],
</a><a href="#h23-0-38" id="h23-0-38" class="i">+        expressions: [
</a><a href="#h23-0-39" id="h23-0-39" class="i">+            Field(
</a><a href="#h23-0-40" id="h23-0-40" class="i">+                None,
</a><a href="#h23-0-41" id="h23-0-41" class="i">+                &quot;id&quot;,
</a><a href="#h23-0-42" id="h23-0-42" class="i">+            ),
</a><a href="#h23-0-43" id="h23-0-43" class="i">+        ],
</a><a href="#h23-0-44" id="h23-0-44" class="i">+    },
</a><a href="#h23-0-45" id="h23-0-45" class="i">+}
</a><a href="#h23-0-46" id="h23-0-46" class="i">+
</a><a href="#h23-0-47" id="h23-0-47" class="i">+Optimized plan: Plan {
</a><a href="#h23-0-48" id="h23-0-48" class="i">+    root: Projection {
</a><a href="#h23-0-49" id="h23-0-49" class="i">+        source: Scan {
</a><a href="#h23-0-50" id="h23-0-50" class="i">+            table: &quot;movies&quot;,
</a><a href="#h23-0-51" id="h23-0-51" class="i">+        },
</a><a href="#h23-0-52" id="h23-0-52" class="i">+        labels: [
</a><a href="#h23-0-53" id="h23-0-53" class="i">+            None,
</a><a href="#h23-0-54" id="h23-0-54" class="i">+        ],
</a><a href="#h23-0-55" id="h23-0-55" class="i">+        expressions: [
</a><a href="#h23-0-56" id="h23-0-56" class="i">+            Field(
</a><a href="#h23-0-57" id="h23-0-57" class="i">+                None,
</a><a href="#h23-0-58" id="h23-0-58" class="i">+                &quot;id&quot;,
</a><a href="#h23-0-59" id="h23-0-59" class="i">+            ),
</a><a href="#h23-0-60" id="h23-0-60" class="i">+        ],
</a><a href="#h23-0-61" id="h23-0-61" class="i">+    },
</a><a href="#h23-0-62" id="h23-0-62" class="i">+}
</a><a href="#h23-0-63" id="h23-0-63" class="i">+
</a><a href="#h23-0-64" id="h23-0-64" class="i">+Query: SELECT id FROM movies
</a><a href="#h23-0-65" id="h23-0-65" class="i">+
</a><a href="#h23-0-66" id="h23-0-66" class="i">+Result: [&quot;id&quot;]
</a><a href="#h23-0-67" id="h23-0-67" class="i">+[Integer(1)]
</a><a href="#h23-0-68" id="h23-0-68" class="i">+[Integer(2)]
</a><a href="#h23-0-69" id="h23-0-69" class="i">+[Integer(3)]
</a><a href="#h23-0-70" id="h23-0-70" class="i">+[Integer(4)]
</a><a href="#h23-0-71" id="h23-0-71" class="i">+[Integer(5)]
</a><b>diff --git a/<a id="h24" href="../file/src/sql/tests/query/field_unknown.html">src/sql/tests/query/field_unknown</a> b/<a href="../file/src/sql/tests/query/field_unknown.html">src/sql/tests/query/field_unknown</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -0,0 +1,67 @@
</a><a href="#h24-0-0" id="h24-0-0" class="i">+Query: SELECT unknown FROM movies
</a><a href="#h24-0-1" id="h24-0-1" class="i">+
</a><a href="#h24-0-2" id="h24-0-2" class="i">+AST: Select {
</a><a href="#h24-0-3" id="h24-0-3" class="i">+    select: SelectClause {
</a><a href="#h24-0-4" id="h24-0-4" class="i">+        expressions: [
</a><a href="#h24-0-5" id="h24-0-5" class="i">+            Field(
</a><a href="#h24-0-6" id="h24-0-6" class="i">+                None,
</a><a href="#h24-0-7" id="h24-0-7" class="i">+                &quot;unknown&quot;,
</a><a href="#h24-0-8" id="h24-0-8" class="i">+            ),
</a><a href="#h24-0-9" id="h24-0-9" class="i">+        ],
</a><a href="#h24-0-10" id="h24-0-10" class="i">+        labels: [
</a><a href="#h24-0-11" id="h24-0-11" class="i">+            None,
</a><a href="#h24-0-12" id="h24-0-12" class="i">+        ],
</a><a href="#h24-0-13" id="h24-0-13" class="i">+    },
</a><a href="#h24-0-14" id="h24-0-14" class="i">+    from: Some(
</a><a href="#h24-0-15" id="h24-0-15" class="i">+        FromClause {
</a><a href="#h24-0-16" id="h24-0-16" class="i">+            items: [
</a><a href="#h24-0-17" id="h24-0-17" class="i">+                FromItem {
</a><a href="#h24-0-18" id="h24-0-18" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h24-0-19" id="h24-0-19" class="i">+                    join: None,
</a><a href="#h24-0-20" id="h24-0-20" class="i">+                },
</a><a href="#h24-0-21" id="h24-0-21" class="i">+            ],
</a><a href="#h24-0-22" id="h24-0-22" class="i">+        },
</a><a href="#h24-0-23" id="h24-0-23" class="i">+    ),
</a><a href="#h24-0-24" id="h24-0-24" class="i">+    where: None,
</a><a href="#h24-0-25" id="h24-0-25" class="i">+    order: [],
</a><a href="#h24-0-26" id="h24-0-26" class="i">+    limit: None,
</a><a href="#h24-0-27" id="h24-0-27" class="i">+    offset: None,
</a><a href="#h24-0-28" id="h24-0-28" class="i">+}
</a><a href="#h24-0-29" id="h24-0-29" class="i">+
</a><a href="#h24-0-30" id="h24-0-30" class="i">+Plan: Plan {
</a><a href="#h24-0-31" id="h24-0-31" class="i">+    root: Projection {
</a><a href="#h24-0-32" id="h24-0-32" class="i">+        source: Scan {
</a><a href="#h24-0-33" id="h24-0-33" class="i">+            table: &quot;movies&quot;,
</a><a href="#h24-0-34" id="h24-0-34" class="i">+        },
</a><a href="#h24-0-35" id="h24-0-35" class="i">+        labels: [
</a><a href="#h24-0-36" id="h24-0-36" class="i">+            None,
</a><a href="#h24-0-37" id="h24-0-37" class="i">+        ],
</a><a href="#h24-0-38" id="h24-0-38" class="i">+        expressions: [
</a><a href="#h24-0-39" id="h24-0-39" class="i">+            Field(
</a><a href="#h24-0-40" id="h24-0-40" class="i">+                None,
</a><a href="#h24-0-41" id="h24-0-41" class="i">+                &quot;unknown&quot;,
</a><a href="#h24-0-42" id="h24-0-42" class="i">+            ),
</a><a href="#h24-0-43" id="h24-0-43" class="i">+        ],
</a><a href="#h24-0-44" id="h24-0-44" class="i">+    },
</a><a href="#h24-0-45" id="h24-0-45" class="i">+}
</a><a href="#h24-0-46" id="h24-0-46" class="i">+
</a><a href="#h24-0-47" id="h24-0-47" class="i">+Optimized plan: Plan {
</a><a href="#h24-0-48" id="h24-0-48" class="i">+    root: Projection {
</a><a href="#h24-0-49" id="h24-0-49" class="i">+        source: Scan {
</a><a href="#h24-0-50" id="h24-0-50" class="i">+            table: &quot;movies&quot;,
</a><a href="#h24-0-51" id="h24-0-51" class="i">+        },
</a><a href="#h24-0-52" id="h24-0-52" class="i">+        labels: [
</a><a href="#h24-0-53" id="h24-0-53" class="i">+            None,
</a><a href="#h24-0-54" id="h24-0-54" class="i">+        ],
</a><a href="#h24-0-55" id="h24-0-55" class="i">+        expressions: [
</a><a href="#h24-0-56" id="h24-0-56" class="i">+            Field(
</a><a href="#h24-0-57" id="h24-0-57" class="i">+                None,
</a><a href="#h24-0-58" id="h24-0-58" class="i">+                &quot;unknown&quot;,
</a><a href="#h24-0-59" id="h24-0-59" class="i">+            ),
</a><a href="#h24-0-60" id="h24-0-60" class="i">+        ],
</a><a href="#h24-0-61" id="h24-0-61" class="i">+    },
</a><a href="#h24-0-62" id="h24-0-62" class="i">+}
</a><a href="#h24-0-63" id="h24-0-63" class="i">+
</a><a href="#h24-0-64" id="h24-0-64" class="i">+Query: SELECT unknown FROM movies
</a><a href="#h24-0-65" id="h24-0-65" class="i">+
</a><a href="#h24-0-66" id="h24-0-66" class="i">+Result: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h24-0-67" id="h24-0-67" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h25" href="../file/src/sql/tests/query/field_unknown_qualified.html">src/sql/tests/query/field_unknown_qualified</a> b/<a href="../file/src/sql/tests/query/field_unknown_qualified.html">src/sql/tests/query/field_unknown_qualified</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -0,0 +1,73 @@
</a><a href="#h25-0-0" id="h25-0-0" class="i">+Query: SELECT movies.unknown FROM movies
</a><a href="#h25-0-1" id="h25-0-1" class="i">+
</a><a href="#h25-0-2" id="h25-0-2" class="i">+AST: Select {
</a><a href="#h25-0-3" id="h25-0-3" class="i">+    select: SelectClause {
</a><a href="#h25-0-4" id="h25-0-4" class="i">+        expressions: [
</a><a href="#h25-0-5" id="h25-0-5" class="i">+            Field(
</a><a href="#h25-0-6" id="h25-0-6" class="i">+                Some(
</a><a href="#h25-0-7" id="h25-0-7" class="i">+                    &quot;movies&quot;,
</a><a href="#h25-0-8" id="h25-0-8" class="i">+                ),
</a><a href="#h25-0-9" id="h25-0-9" class="i">+                &quot;unknown&quot;,
</a><a href="#h25-0-10" id="h25-0-10" class="i">+            ),
</a><a href="#h25-0-11" id="h25-0-11" class="i">+        ],
</a><a href="#h25-0-12" id="h25-0-12" class="i">+        labels: [
</a><a href="#h25-0-13" id="h25-0-13" class="i">+            None,
</a><a href="#h25-0-14" id="h25-0-14" class="i">+        ],
</a><a href="#h25-0-15" id="h25-0-15" class="i">+    },
</a><a href="#h25-0-16" id="h25-0-16" class="i">+    from: Some(
</a><a href="#h25-0-17" id="h25-0-17" class="i">+        FromClause {
</a><a href="#h25-0-18" id="h25-0-18" class="i">+            items: [
</a><a href="#h25-0-19" id="h25-0-19" class="i">+                FromItem {
</a><a href="#h25-0-20" id="h25-0-20" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h25-0-21" id="h25-0-21" class="i">+                    join: None,
</a><a href="#h25-0-22" id="h25-0-22" class="i">+                },
</a><a href="#h25-0-23" id="h25-0-23" class="i">+            ],
</a><a href="#h25-0-24" id="h25-0-24" class="i">+        },
</a><a href="#h25-0-25" id="h25-0-25" class="i">+    ),
</a><a href="#h25-0-26" id="h25-0-26" class="i">+    where: None,
</a><a href="#h25-0-27" id="h25-0-27" class="i">+    order: [],
</a><a href="#h25-0-28" id="h25-0-28" class="i">+    limit: None,
</a><a href="#h25-0-29" id="h25-0-29" class="i">+    offset: None,
</a><a href="#h25-0-30" id="h25-0-30" class="i">+}
</a><a href="#h25-0-31" id="h25-0-31" class="i">+
</a><a href="#h25-0-32" id="h25-0-32" class="i">+Plan: Plan {
</a><a href="#h25-0-33" id="h25-0-33" class="i">+    root: Projection {
</a><a href="#h25-0-34" id="h25-0-34" class="i">+        source: Scan {
</a><a href="#h25-0-35" id="h25-0-35" class="i">+            table: &quot;movies&quot;,
</a><a href="#h25-0-36" id="h25-0-36" class="i">+        },
</a><a href="#h25-0-37" id="h25-0-37" class="i">+        labels: [
</a><a href="#h25-0-38" id="h25-0-38" class="i">+            None,
</a><a href="#h25-0-39" id="h25-0-39" class="i">+        ],
</a><a href="#h25-0-40" id="h25-0-40" class="i">+        expressions: [
</a><a href="#h25-0-41" id="h25-0-41" class="i">+            Field(
</a><a href="#h25-0-42" id="h25-0-42" class="i">+                Some(
</a><a href="#h25-0-43" id="h25-0-43" class="i">+                    &quot;movies&quot;,
</a><a href="#h25-0-44" id="h25-0-44" class="i">+                ),
</a><a href="#h25-0-45" id="h25-0-45" class="i">+                &quot;unknown&quot;,
</a><a href="#h25-0-46" id="h25-0-46" class="i">+            ),
</a><a href="#h25-0-47" id="h25-0-47" class="i">+        ],
</a><a href="#h25-0-48" id="h25-0-48" class="i">+    },
</a><a href="#h25-0-49" id="h25-0-49" class="i">+}
</a><a href="#h25-0-50" id="h25-0-50" class="i">+
</a><a href="#h25-0-51" id="h25-0-51" class="i">+Optimized plan: Plan {
</a><a href="#h25-0-52" id="h25-0-52" class="i">+    root: Projection {
</a><a href="#h25-0-53" id="h25-0-53" class="i">+        source: Scan {
</a><a href="#h25-0-54" id="h25-0-54" class="i">+            table: &quot;movies&quot;,
</a><a href="#h25-0-55" id="h25-0-55" class="i">+        },
</a><a href="#h25-0-56" id="h25-0-56" class="i">+        labels: [
</a><a href="#h25-0-57" id="h25-0-57" class="i">+            None,
</a><a href="#h25-0-58" id="h25-0-58" class="i">+        ],
</a><a href="#h25-0-59" id="h25-0-59" class="i">+        expressions: [
</a><a href="#h25-0-60" id="h25-0-60" class="i">+            Field(
</a><a href="#h25-0-61" id="h25-0-61" class="i">+                Some(
</a><a href="#h25-0-62" id="h25-0-62" class="i">+                    &quot;movies&quot;,
</a><a href="#h25-0-63" id="h25-0-63" class="i">+                ),
</a><a href="#h25-0-64" id="h25-0-64" class="i">+                &quot;unknown&quot;,
</a><a href="#h25-0-65" id="h25-0-65" class="i">+            ),
</a><a href="#h25-0-66" id="h25-0-66" class="i">+        ],
</a><a href="#h25-0-67" id="h25-0-67" class="i">+    },
</a><a href="#h25-0-68" id="h25-0-68" class="i">+}
</a><a href="#h25-0-69" id="h25-0-69" class="i">+
</a><a href="#h25-0-70" id="h25-0-70" class="i">+Query: SELECT movies.unknown FROM movies
</a><a href="#h25-0-71" id="h25-0-71" class="i">+
</a><a href="#h25-0-72" id="h25-0-72" class="i">+Result: Value(&quot;Unknown field movies.unknown&quot;)
</a><a href="#h25-0-73" id="h25-0-73" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h26" href="../file/src/sql/tests/query/field_unknown_table.html">src/sql/tests/query/field_unknown_table</a> b/<a href="../file/src/sql/tests/query/field_unknown_table.html">src/sql/tests/query/field_unknown_table</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -0,0 +1,73 @@
</a><a href="#h26-0-0" id="h26-0-0" class="i">+Query: SELECT unknown.id FROM movies
</a><a href="#h26-0-1" id="h26-0-1" class="i">+
</a><a href="#h26-0-2" id="h26-0-2" class="i">+AST: Select {
</a><a href="#h26-0-3" id="h26-0-3" class="i">+    select: SelectClause {
</a><a href="#h26-0-4" id="h26-0-4" class="i">+        expressions: [
</a><a href="#h26-0-5" id="h26-0-5" class="i">+            Field(
</a><a href="#h26-0-6" id="h26-0-6" class="i">+                Some(
</a><a href="#h26-0-7" id="h26-0-7" class="i">+                    &quot;unknown&quot;,
</a><a href="#h26-0-8" id="h26-0-8" class="i">+                ),
</a><a href="#h26-0-9" id="h26-0-9" class="i">+                &quot;id&quot;,
</a><a href="#h26-0-10" id="h26-0-10" class="i">+            ),
</a><a href="#h26-0-11" id="h26-0-11" class="i">+        ],
</a><a href="#h26-0-12" id="h26-0-12" class="i">+        labels: [
</a><a href="#h26-0-13" id="h26-0-13" class="i">+            None,
</a><a href="#h26-0-14" id="h26-0-14" class="i">+        ],
</a><a href="#h26-0-15" id="h26-0-15" class="i">+    },
</a><a href="#h26-0-16" id="h26-0-16" class="i">+    from: Some(
</a><a href="#h26-0-17" id="h26-0-17" class="i">+        FromClause {
</a><a href="#h26-0-18" id="h26-0-18" class="i">+            items: [
</a><a href="#h26-0-19" id="h26-0-19" class="i">+                FromItem {
</a><a href="#h26-0-20" id="h26-0-20" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h26-0-21" id="h26-0-21" class="i">+                    join: None,
</a><a href="#h26-0-22" id="h26-0-22" class="i">+                },
</a><a href="#h26-0-23" id="h26-0-23" class="i">+            ],
</a><a href="#h26-0-24" id="h26-0-24" class="i">+        },
</a><a href="#h26-0-25" id="h26-0-25" class="i">+    ),
</a><a href="#h26-0-26" id="h26-0-26" class="i">+    where: None,
</a><a href="#h26-0-27" id="h26-0-27" class="i">+    order: [],
</a><a href="#h26-0-28" id="h26-0-28" class="i">+    limit: None,
</a><a href="#h26-0-29" id="h26-0-29" class="i">+    offset: None,
</a><a href="#h26-0-30" id="h26-0-30" class="i">+}
</a><a href="#h26-0-31" id="h26-0-31" class="i">+
</a><a href="#h26-0-32" id="h26-0-32" class="i">+Plan: Plan {
</a><a href="#h26-0-33" id="h26-0-33" class="i">+    root: Projection {
</a><a href="#h26-0-34" id="h26-0-34" class="i">+        source: Scan {
</a><a href="#h26-0-35" id="h26-0-35" class="i">+            table: &quot;movies&quot;,
</a><a href="#h26-0-36" id="h26-0-36" class="i">+        },
</a><a href="#h26-0-37" id="h26-0-37" class="i">+        labels: [
</a><a href="#h26-0-38" id="h26-0-38" class="i">+            None,
</a><a href="#h26-0-39" id="h26-0-39" class="i">+        ],
</a><a href="#h26-0-40" id="h26-0-40" class="i">+        expressions: [
</a><a href="#h26-0-41" id="h26-0-41" class="i">+            Field(
</a><a href="#h26-0-42" id="h26-0-42" class="i">+                Some(
</a><a href="#h26-0-43" id="h26-0-43" class="i">+                    &quot;unknown&quot;,
</a><a href="#h26-0-44" id="h26-0-44" class="i">+                ),
</a><a href="#h26-0-45" id="h26-0-45" class="i">+                &quot;id&quot;,
</a><a href="#h26-0-46" id="h26-0-46" class="i">+            ),
</a><a href="#h26-0-47" id="h26-0-47" class="i">+        ],
</a><a href="#h26-0-48" id="h26-0-48" class="i">+    },
</a><a href="#h26-0-49" id="h26-0-49" class="i">+}
</a><a href="#h26-0-50" id="h26-0-50" class="i">+
</a><a href="#h26-0-51" id="h26-0-51" class="i">+Optimized plan: Plan {
</a><a href="#h26-0-52" id="h26-0-52" class="i">+    root: Projection {
</a><a href="#h26-0-53" id="h26-0-53" class="i">+        source: Scan {
</a><a href="#h26-0-54" id="h26-0-54" class="i">+            table: &quot;movies&quot;,
</a><a href="#h26-0-55" id="h26-0-55" class="i">+        },
</a><a href="#h26-0-56" id="h26-0-56" class="i">+        labels: [
</a><a href="#h26-0-57" id="h26-0-57" class="i">+            None,
</a><a href="#h26-0-58" id="h26-0-58" class="i">+        ],
</a><a href="#h26-0-59" id="h26-0-59" class="i">+        expressions: [
</a><a href="#h26-0-60" id="h26-0-60" class="i">+            Field(
</a><a href="#h26-0-61" id="h26-0-61" class="i">+                Some(
</a><a href="#h26-0-62" id="h26-0-62" class="i">+                    &quot;unknown&quot;,
</a><a href="#h26-0-63" id="h26-0-63" class="i">+                ),
</a><a href="#h26-0-64" id="h26-0-64" class="i">+                &quot;id&quot;,
</a><a href="#h26-0-65" id="h26-0-65" class="i">+            ),
</a><a href="#h26-0-66" id="h26-0-66" class="i">+        ],
</a><a href="#h26-0-67" id="h26-0-67" class="i">+    },
</a><a href="#h26-0-68" id="h26-0-68" class="i">+}
</a><a href="#h26-0-69" id="h26-0-69" class="i">+
</a><a href="#h26-0-70" id="h26-0-70" class="i">+Query: SELECT unknown.id FROM movies
</a><a href="#h26-0-71" id="h26-0-71" class="i">+
</a><a href="#h26-0-72" id="h26-0-72" class="i">+Result: Value(&quot;Unknown field unknown.id&quot;)
</a><a href="#h26-0-73" id="h26-0-73" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h27" href="../file/src/sql/tests/query/limit_dynamic.html">src/sql/tests/query/limit_dynamic</a> b/<a href="../file/src/sql/tests/query/limit_dynamic.html">src/sql/tests/query/limit_dynamic</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -26,6 +26,7 @@ AST: Select {
</a>                     ),
                 ),
                 Field(
<a href="#h27-0-3" id="h27-0-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
             ),
<b>diff --git a/<a id="h28" href="../file/src/sql/tests/query/offset_dynamic.html">src/sql/tests/query/offset_dynamic</a> b/<a href="../file/src/sql/tests/query/offset_dynamic.html">src/sql/tests/query/offset_dynamic</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -27,6 +27,7 @@ AST: Select {
</a>                     ),
                 ),
                 Field(
<a href="#h28-0-3" id="h28-0-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
             ),
<b>diff --git a/<a id="h29" href="../file/src/sql/tests/query/order.html">src/sql/tests/query/order</a> b/<a href="../file/src/sql/tests/query/order.html">src/sql/tests/query/order</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h29-0-3" id="h29-0-3" class="i">+                None,
</a>                 &quot;released&quot;,
             ),
             Ascending,
<a href="#h29-1" id="h29-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h29-1-3" id="h29-1-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Ascending,
<a href="#h29-2" id="h29-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h29-2-3" id="h29-2-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Ascending,
<b>diff --git a/<a id="h30" href="../file/src/sql/tests/query/order_asc.html">src/sql/tests/query/order_asc</a> b/<a href="../file/src/sql/tests/query/order_asc.html">src/sql/tests/query/order_asc</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h30-0-3" id="h30-0-3" class="i">+                None,
</a>                 &quot;released&quot;,
             ),
             Ascending,
<a href="#h30-1" id="h30-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h30-1-3" id="h30-1-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Ascending,
<a href="#h30-2" id="h30-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h30-2-3" id="h30-2-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Ascending,
<b>diff --git a/<a id="h31" href="../file/src/sql/tests/query/order_asc_lowercase.html">src/sql/tests/query/order_asc_lowercase</a> b/<a href="../file/src/sql/tests/query/order_asc_lowercase.html">src/sql/tests/query/order_asc_lowercase</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h31-0-3" id="h31-0-3" class="i">+                None,
</a>                 &quot;released&quot;,
             ),
             Ascending,
<a href="#h31-1" id="h31-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h31-1-3" id="h31-1-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Ascending,
<a href="#h31-2" id="h31-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h31-2-3" id="h31-2-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Ascending,
<b>diff --git a/<a id="h32" href="../file/src/sql/tests/query/order_boolean_asc.html">src/sql/tests/query/order_boolean_asc</a> b/<a href="../file/src/sql/tests/query/order_boolean_asc.html">src/sql/tests/query/order_boolean_asc</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h32-0-3" id="h32-0-3" class="i">+                None,
</a>                 &quot;value&quot;,
             ),
             Ascending,
<a href="#h32-1" id="h32-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h32-1-3" id="h32-1-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Ascending,
<a href="#h32-2" id="h32-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h32-2-3" id="h32-2-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Ascending,
<b>diff --git a/<a id="h33" href="../file/src/sql/tests/query/order_boolean_desc.html">src/sql/tests/query/order_boolean_desc</a> b/<a href="../file/src/sql/tests/query/order_boolean_desc.html">src/sql/tests/query/order_boolean_desc</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h33-0-3" id="h33-0-3" class="i">+                None,
</a>                 &quot;value&quot;,
             ),
             Descending,
<a href="#h33-1" id="h33-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h33-1-3" id="h33-1-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Descending,
<a href="#h33-2" id="h33-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h33-2-3" id="h33-2-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Descending,
<b>diff --git a/<a id="h34" href="../file/src/sql/tests/query/order_desc.html">src/sql/tests/query/order_desc</a> b/<a href="../file/src/sql/tests/query/order_desc.html">src/sql/tests/query/order_desc</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h34-0-3" id="h34-0-3" class="i">+                None,
</a>                 &quot;released&quot;,
             ),
             Descending,
<a href="#h34-1" id="h34-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h34-1-3" id="h34-1-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Descending,
<a href="#h34-2" id="h34-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h34-2-3" id="h34-2-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Descending,
<b>diff --git a/<a id="h35" href="../file/src/sql/tests/query/order_desc_lowercase.html">src/sql/tests/query/order_desc_lowercase</a> b/<a href="../file/src/sql/tests/query/order_desc_lowercase.html">src/sql/tests/query/order_desc_lowercase</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h35-0-3" id="h35-0-3" class="i">+                None,
</a>                 &quot;released&quot;,
             ),
             Descending,
<a href="#h35-1" id="h35-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h35-1-3" id="h35-1-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Descending,
<a href="#h35-2" id="h35-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h35-2-3" id="h35-2-3" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Descending,
<b>diff --git a/<a id="h36" href="../file/src/sql/tests/query/order_expr.html">src/sql/tests/query/order_expr</a> b/<a href="../file/src/sql/tests/query/order_expr.html">src/sql/tests/query/order_expr</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -4,17 +4,21 @@ AST: Select {
</a>     select: SelectClause {
         expressions: [
             Field(
<a href="#h36-0-3" id="h36-0-3" class="i">+                None,
</a>                 &quot;id&quot;,
             ),
             Field(
<a href="#h36-0-7" id="h36-0-7" class="i">+                None,
</a>                 &quot;title&quot;,
             ),
             Field(
<a href="#h36-0-11" id="h36-0-11" class="i">+                None,
</a>                 &quot;released&quot;,
             ),
             Operation(
                 Modulo(
                     Field(
<a href="#h36-0-17" id="h36-0-17" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Literal(
<a href="#h36-1" id="h36-1" class="h">@@ -50,6 +54,7 @@ AST: Select {
</a>             Operation(
                 Modulo(
                     Field(
<a href="#h36-1-3" id="h36-1-3" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Literal(
<a href="#h36-2" id="h36-2" class="h">@@ -82,16 +87,20 @@ Plan: Plan {
</a>             ],
             expressions: [
                 Field(
<a href="#h36-2-3" id="h36-2-3" class="i">+                    None,
</a>                     &quot;id&quot;,
                 ),
                 Field(
<a href="#h36-2-7" id="h36-2-7" class="i">+                    None,
</a>                     &quot;title&quot;,
                 ),
                 Field(
<a href="#h36-2-11" id="h36-2-11" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Modulo(
                     Field(
<a href="#h36-2-16" id="h36-2-16" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Constant(
<a href="#h36-3" id="h36-3" class="h">@@ -106,6 +115,7 @@ Plan: Plan {
</a>             (
                 Modulo(
                     Field(
<a href="#h36-3-3" id="h36-3-3" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Constant(
<a href="#h36-4" id="h36-4" class="h">@@ -136,16 +146,20 @@ Optimized plan: Plan {
</a>             ],
             expressions: [
                 Field(
<a href="#h36-4-3" id="h36-4-3" class="i">+                    None,
</a>                     &quot;id&quot;,
                 ),
                 Field(
<a href="#h36-4-7" id="h36-4-7" class="i">+                    None,
</a>                     &quot;title&quot;,
                 ),
                 Field(
<a href="#h36-4-11" id="h36-4-11" class="i">+                    None,
</a>                     &quot;released&quot;,
                 ),
                 Modulo(
                     Field(
<a href="#h36-4-16" id="h36-4-16" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Constant(
<a href="#h36-5" id="h36-5" class="h">@@ -160,6 +174,7 @@ Optimized plan: Plan {
</a>             (
                 Modulo(
                     Field(
<a href="#h36-5-3" id="h36-5-3" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Constant(
<b>diff --git a/<a id="h37" href="../file/src/sql/tests/query/order_field_aliased.html">src/sql/tests/query/order_field_aliased</a> b/<a href="../file/src/sql/tests/query/order_field_aliased.html">src/sql/tests/query/order_field_aliased</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -0,0 +1,236 @@
</a><a href="#h37-0-0" id="h37-0-0" class="i">+Query: SELECT movies.id, title, genres.name AS genre FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genre, title
</a><a href="#h37-0-1" id="h37-0-1" class="i">+
</a><a href="#h37-0-2" id="h37-0-2" class="i">+AST: Select {
</a><a href="#h37-0-3" id="h37-0-3" class="i">+    select: SelectClause {
</a><a href="#h37-0-4" id="h37-0-4" class="i">+        expressions: [
</a><a href="#h37-0-5" id="h37-0-5" class="i">+            Field(
</a><a href="#h37-0-6" id="h37-0-6" class="i">+                Some(
</a><a href="#h37-0-7" id="h37-0-7" class="i">+                    &quot;movies&quot;,
</a><a href="#h37-0-8" id="h37-0-8" class="i">+                ),
</a><a href="#h37-0-9" id="h37-0-9" class="i">+                &quot;id&quot;,
</a><a href="#h37-0-10" id="h37-0-10" class="i">+            ),
</a><a href="#h37-0-11" id="h37-0-11" class="i">+            Field(
</a><a href="#h37-0-12" id="h37-0-12" class="i">+                None,
</a><a href="#h37-0-13" id="h37-0-13" class="i">+                &quot;title&quot;,
</a><a href="#h37-0-14" id="h37-0-14" class="i">+            ),
</a><a href="#h37-0-15" id="h37-0-15" class="i">+            Field(
</a><a href="#h37-0-16" id="h37-0-16" class="i">+                Some(
</a><a href="#h37-0-17" id="h37-0-17" class="i">+                    &quot;genres&quot;,
</a><a href="#h37-0-18" id="h37-0-18" class="i">+                ),
</a><a href="#h37-0-19" id="h37-0-19" class="i">+                &quot;name&quot;,
</a><a href="#h37-0-20" id="h37-0-20" class="i">+            ),
</a><a href="#h37-0-21" id="h37-0-21" class="i">+        ],
</a><a href="#h37-0-22" id="h37-0-22" class="i">+        labels: [
</a><a href="#h37-0-23" id="h37-0-23" class="i">+            None,
</a><a href="#h37-0-24" id="h37-0-24" class="i">+            None,
</a><a href="#h37-0-25" id="h37-0-25" class="i">+            Some(
</a><a href="#h37-0-26" id="h37-0-26" class="i">+                &quot;genre&quot;,
</a><a href="#h37-0-27" id="h37-0-27" class="i">+            ),
</a><a href="#h37-0-28" id="h37-0-28" class="i">+        ],
</a><a href="#h37-0-29" id="h37-0-29" class="i">+    },
</a><a href="#h37-0-30" id="h37-0-30" class="i">+    from: Some(
</a><a href="#h37-0-31" id="h37-0-31" class="i">+        FromClause {
</a><a href="#h37-0-32" id="h37-0-32" class="i">+            items: [
</a><a href="#h37-0-33" id="h37-0-33" class="i">+                FromItem {
</a><a href="#h37-0-34" id="h37-0-34" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h37-0-35" id="h37-0-35" class="i">+                    join: None,
</a><a href="#h37-0-36" id="h37-0-36" class="i">+                },
</a><a href="#h37-0-37" id="h37-0-37" class="i">+                FromItem {
</a><a href="#h37-0-38" id="h37-0-38" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h37-0-39" id="h37-0-39" class="i">+                    join: None,
</a><a href="#h37-0-40" id="h37-0-40" class="i">+                },
</a><a href="#h37-0-41" id="h37-0-41" class="i">+            ],
</a><a href="#h37-0-42" id="h37-0-42" class="i">+        },
</a><a href="#h37-0-43" id="h37-0-43" class="i">+    ),
</a><a href="#h37-0-44" id="h37-0-44" class="i">+    where: Some(
</a><a href="#h37-0-45" id="h37-0-45" class="i">+        WhereClause(
</a><a href="#h37-0-46" id="h37-0-46" class="i">+            Operation(
</a><a href="#h37-0-47" id="h37-0-47" class="i">+                Equal(
</a><a href="#h37-0-48" id="h37-0-48" class="i">+                    Field(
</a><a href="#h37-0-49" id="h37-0-49" class="i">+                        Some(
</a><a href="#h37-0-50" id="h37-0-50" class="i">+                            &quot;movies&quot;,
</a><a href="#h37-0-51" id="h37-0-51" class="i">+                        ),
</a><a href="#h37-0-52" id="h37-0-52" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h37-0-53" id="h37-0-53" class="i">+                    ),
</a><a href="#h37-0-54" id="h37-0-54" class="i">+                    Field(
</a><a href="#h37-0-55" id="h37-0-55" class="i">+                        Some(
</a><a href="#h37-0-56" id="h37-0-56" class="i">+                            &quot;genres&quot;,
</a><a href="#h37-0-57" id="h37-0-57" class="i">+                        ),
</a><a href="#h37-0-58" id="h37-0-58" class="i">+                        &quot;id&quot;,
</a><a href="#h37-0-59" id="h37-0-59" class="i">+                    ),
</a><a href="#h37-0-60" id="h37-0-60" class="i">+                ),
</a><a href="#h37-0-61" id="h37-0-61" class="i">+            ),
</a><a href="#h37-0-62" id="h37-0-62" class="i">+        ),
</a><a href="#h37-0-63" id="h37-0-63" class="i">+    ),
</a><a href="#h37-0-64" id="h37-0-64" class="i">+    order: [
</a><a href="#h37-0-65" id="h37-0-65" class="i">+        (
</a><a href="#h37-0-66" id="h37-0-66" class="i">+            Field(
</a><a href="#h37-0-67" id="h37-0-67" class="i">+                None,
</a><a href="#h37-0-68" id="h37-0-68" class="i">+                &quot;genre&quot;,
</a><a href="#h37-0-69" id="h37-0-69" class="i">+            ),
</a><a href="#h37-0-70" id="h37-0-70" class="i">+            Ascending,
</a><a href="#h37-0-71" id="h37-0-71" class="i">+        ),
</a><a href="#h37-0-72" id="h37-0-72" class="i">+        (
</a><a href="#h37-0-73" id="h37-0-73" class="i">+            Field(
</a><a href="#h37-0-74" id="h37-0-74" class="i">+                None,
</a><a href="#h37-0-75" id="h37-0-75" class="i">+                &quot;title&quot;,
</a><a href="#h37-0-76" id="h37-0-76" class="i">+            ),
</a><a href="#h37-0-77" id="h37-0-77" class="i">+            Ascending,
</a><a href="#h37-0-78" id="h37-0-78" class="i">+        ),
</a><a href="#h37-0-79" id="h37-0-79" class="i">+    ],
</a><a href="#h37-0-80" id="h37-0-80" class="i">+    limit: None,
</a><a href="#h37-0-81" id="h37-0-81" class="i">+    offset: None,
</a><a href="#h37-0-82" id="h37-0-82" class="i">+}
</a><a href="#h37-0-83" id="h37-0-83" class="i">+
</a><a href="#h37-0-84" id="h37-0-84" class="i">+Plan: Plan {
</a><a href="#h37-0-85" id="h37-0-85" class="i">+    root: Order {
</a><a href="#h37-0-86" id="h37-0-86" class="i">+        source: Projection {
</a><a href="#h37-0-87" id="h37-0-87" class="i">+            source: Filter {
</a><a href="#h37-0-88" id="h37-0-88" class="i">+                source: NestedLoopJoin {
</a><a href="#h37-0-89" id="h37-0-89" class="i">+                    outer: Scan {
</a><a href="#h37-0-90" id="h37-0-90" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h37-0-91" id="h37-0-91" class="i">+                    },
</a><a href="#h37-0-92" id="h37-0-92" class="i">+                    inner: Scan {
</a><a href="#h37-0-93" id="h37-0-93" class="i">+                        table: &quot;genres&quot;,
</a><a href="#h37-0-94" id="h37-0-94" class="i">+                    },
</a><a href="#h37-0-95" id="h37-0-95" class="i">+                },
</a><a href="#h37-0-96" id="h37-0-96" class="i">+                predicate: Equal(
</a><a href="#h37-0-97" id="h37-0-97" class="i">+                    Field(
</a><a href="#h37-0-98" id="h37-0-98" class="i">+                        Some(
</a><a href="#h37-0-99" id="h37-0-99" class="i">+                            &quot;movies&quot;,
</a><a href="#h37-0-100" id="h37-0-100" class="i">+                        ),
</a><a href="#h37-0-101" id="h37-0-101" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h37-0-102" id="h37-0-102" class="i">+                    ),
</a><a href="#h37-0-103" id="h37-0-103" class="i">+                    Field(
</a><a href="#h37-0-104" id="h37-0-104" class="i">+                        Some(
</a><a href="#h37-0-105" id="h37-0-105" class="i">+                            &quot;genres&quot;,
</a><a href="#h37-0-106" id="h37-0-106" class="i">+                        ),
</a><a href="#h37-0-107" id="h37-0-107" class="i">+                        &quot;id&quot;,
</a><a href="#h37-0-108" id="h37-0-108" class="i">+                    ),
</a><a href="#h37-0-109" id="h37-0-109" class="i">+                ),
</a><a href="#h37-0-110" id="h37-0-110" class="i">+            },
</a><a href="#h37-0-111" id="h37-0-111" class="i">+            labels: [
</a><a href="#h37-0-112" id="h37-0-112" class="i">+                None,
</a><a href="#h37-0-113" id="h37-0-113" class="i">+                None,
</a><a href="#h37-0-114" id="h37-0-114" class="i">+                Some(
</a><a href="#h37-0-115" id="h37-0-115" class="i">+                    &quot;genre&quot;,
</a><a href="#h37-0-116" id="h37-0-116" class="i">+                ),
</a><a href="#h37-0-117" id="h37-0-117" class="i">+            ],
</a><a href="#h37-0-118" id="h37-0-118" class="i">+            expressions: [
</a><a href="#h37-0-119" id="h37-0-119" class="i">+                Field(
</a><a href="#h37-0-120" id="h37-0-120" class="i">+                    Some(
</a><a href="#h37-0-121" id="h37-0-121" class="i">+                        &quot;movies&quot;,
</a><a href="#h37-0-122" id="h37-0-122" class="i">+                    ),
</a><a href="#h37-0-123" id="h37-0-123" class="i">+                    &quot;id&quot;,
</a><a href="#h37-0-124" id="h37-0-124" class="i">+                ),
</a><a href="#h37-0-125" id="h37-0-125" class="i">+                Field(
</a><a href="#h37-0-126" id="h37-0-126" class="i">+                    None,
</a><a href="#h37-0-127" id="h37-0-127" class="i">+                    &quot;title&quot;,
</a><a href="#h37-0-128" id="h37-0-128" class="i">+                ),
</a><a href="#h37-0-129" id="h37-0-129" class="i">+                Field(
</a><a href="#h37-0-130" id="h37-0-130" class="i">+                    Some(
</a><a href="#h37-0-131" id="h37-0-131" class="i">+                        &quot;genres&quot;,
</a><a href="#h37-0-132" id="h37-0-132" class="i">+                    ),
</a><a href="#h37-0-133" id="h37-0-133" class="i">+                    &quot;name&quot;,
</a><a href="#h37-0-134" id="h37-0-134" class="i">+                ),
</a><a href="#h37-0-135" id="h37-0-135" class="i">+            ],
</a><a href="#h37-0-136" id="h37-0-136" class="i">+        },
</a><a href="#h37-0-137" id="h37-0-137" class="i">+        orders: [
</a><a href="#h37-0-138" id="h37-0-138" class="i">+            (
</a><a href="#h37-0-139" id="h37-0-139" class="i">+                Field(
</a><a href="#h37-0-140" id="h37-0-140" class="i">+                    None,
</a><a href="#h37-0-141" id="h37-0-141" class="i">+                    &quot;genre&quot;,
</a><a href="#h37-0-142" id="h37-0-142" class="i">+                ),
</a><a href="#h37-0-143" id="h37-0-143" class="i">+                Ascending,
</a><a href="#h37-0-144" id="h37-0-144" class="i">+            ),
</a><a href="#h37-0-145" id="h37-0-145" class="i">+            (
</a><a href="#h37-0-146" id="h37-0-146" class="i">+                Field(
</a><a href="#h37-0-147" id="h37-0-147" class="i">+                    None,
</a><a href="#h37-0-148" id="h37-0-148" class="i">+                    &quot;title&quot;,
</a><a href="#h37-0-149" id="h37-0-149" class="i">+                ),
</a><a href="#h37-0-150" id="h37-0-150" class="i">+                Ascending,
</a><a href="#h37-0-151" id="h37-0-151" class="i">+            ),
</a><a href="#h37-0-152" id="h37-0-152" class="i">+        ],
</a><a href="#h37-0-153" id="h37-0-153" class="i">+    },
</a><a href="#h37-0-154" id="h37-0-154" class="i">+}
</a><a href="#h37-0-155" id="h37-0-155" class="i">+
</a><a href="#h37-0-156" id="h37-0-156" class="i">+Optimized plan: Plan {
</a><a href="#h37-0-157" id="h37-0-157" class="i">+    root: Order {
</a><a href="#h37-0-158" id="h37-0-158" class="i">+        source: Projection {
</a><a href="#h37-0-159" id="h37-0-159" class="i">+            source: Filter {
</a><a href="#h37-0-160" id="h37-0-160" class="i">+                source: NestedLoopJoin {
</a><a href="#h37-0-161" id="h37-0-161" class="i">+                    outer: Scan {
</a><a href="#h37-0-162" id="h37-0-162" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h37-0-163" id="h37-0-163" class="i">+                    },
</a><a href="#h37-0-164" id="h37-0-164" class="i">+                    inner: Scan {
</a><a href="#h37-0-165" id="h37-0-165" class="i">+                        table: &quot;genres&quot;,
</a><a href="#h37-0-166" id="h37-0-166" class="i">+                    },
</a><a href="#h37-0-167" id="h37-0-167" class="i">+                },
</a><a href="#h37-0-168" id="h37-0-168" class="i">+                predicate: Equal(
</a><a href="#h37-0-169" id="h37-0-169" class="i">+                    Field(
</a><a href="#h37-0-170" id="h37-0-170" class="i">+                        Some(
</a><a href="#h37-0-171" id="h37-0-171" class="i">+                            &quot;movies&quot;,
</a><a href="#h37-0-172" id="h37-0-172" class="i">+                        ),
</a><a href="#h37-0-173" id="h37-0-173" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h37-0-174" id="h37-0-174" class="i">+                    ),
</a><a href="#h37-0-175" id="h37-0-175" class="i">+                    Field(
</a><a href="#h37-0-176" id="h37-0-176" class="i">+                        Some(
</a><a href="#h37-0-177" id="h37-0-177" class="i">+                            &quot;genres&quot;,
</a><a href="#h37-0-178" id="h37-0-178" class="i">+                        ),
</a><a href="#h37-0-179" id="h37-0-179" class="i">+                        &quot;id&quot;,
</a><a href="#h37-0-180" id="h37-0-180" class="i">+                    ),
</a><a href="#h37-0-181" id="h37-0-181" class="i">+                ),
</a><a href="#h37-0-182" id="h37-0-182" class="i">+            },
</a><a href="#h37-0-183" id="h37-0-183" class="i">+            labels: [
</a><a href="#h37-0-184" id="h37-0-184" class="i">+                None,
</a><a href="#h37-0-185" id="h37-0-185" class="i">+                None,
</a><a href="#h37-0-186" id="h37-0-186" class="i">+                Some(
</a><a href="#h37-0-187" id="h37-0-187" class="i">+                    &quot;genre&quot;,
</a><a href="#h37-0-188" id="h37-0-188" class="i">+                ),
</a><a href="#h37-0-189" id="h37-0-189" class="i">+            ],
</a><a href="#h37-0-190" id="h37-0-190" class="i">+            expressions: [
</a><a href="#h37-0-191" id="h37-0-191" class="i">+                Field(
</a><a href="#h37-0-192" id="h37-0-192" class="i">+                    Some(
</a><a href="#h37-0-193" id="h37-0-193" class="i">+                        &quot;movies&quot;,
</a><a href="#h37-0-194" id="h37-0-194" class="i">+                    ),
</a><a href="#h37-0-195" id="h37-0-195" class="i">+                    &quot;id&quot;,
</a><a href="#h37-0-196" id="h37-0-196" class="i">+                ),
</a><a href="#h37-0-197" id="h37-0-197" class="i">+                Field(
</a><a href="#h37-0-198" id="h37-0-198" class="i">+                    None,
</a><a href="#h37-0-199" id="h37-0-199" class="i">+                    &quot;title&quot;,
</a><a href="#h37-0-200" id="h37-0-200" class="i">+                ),
</a><a href="#h37-0-201" id="h37-0-201" class="i">+                Field(
</a><a href="#h37-0-202" id="h37-0-202" class="i">+                    Some(
</a><a href="#h37-0-203" id="h37-0-203" class="i">+                        &quot;genres&quot;,
</a><a href="#h37-0-204" id="h37-0-204" class="i">+                    ),
</a><a href="#h37-0-205" id="h37-0-205" class="i">+                    &quot;name&quot;,
</a><a href="#h37-0-206" id="h37-0-206" class="i">+                ),
</a><a href="#h37-0-207" id="h37-0-207" class="i">+            ],
</a><a href="#h37-0-208" id="h37-0-208" class="i">+        },
</a><a href="#h37-0-209" id="h37-0-209" class="i">+        orders: [
</a><a href="#h37-0-210" id="h37-0-210" class="i">+            (
</a><a href="#h37-0-211" id="h37-0-211" class="i">+                Field(
</a><a href="#h37-0-212" id="h37-0-212" class="i">+                    None,
</a><a href="#h37-0-213" id="h37-0-213" class="i">+                    &quot;genre&quot;,
</a><a href="#h37-0-214" id="h37-0-214" class="i">+                ),
</a><a href="#h37-0-215" id="h37-0-215" class="i">+                Ascending,
</a><a href="#h37-0-216" id="h37-0-216" class="i">+            ),
</a><a href="#h37-0-217" id="h37-0-217" class="i">+            (
</a><a href="#h37-0-218" id="h37-0-218" class="i">+                Field(
</a><a href="#h37-0-219" id="h37-0-219" class="i">+                    None,
</a><a href="#h37-0-220" id="h37-0-220" class="i">+                    &quot;title&quot;,
</a><a href="#h37-0-221" id="h37-0-221" class="i">+                ),
</a><a href="#h37-0-222" id="h37-0-222" class="i">+                Ascending,
</a><a href="#h37-0-223" id="h37-0-223" class="i">+            ),
</a><a href="#h37-0-224" id="h37-0-224" class="i">+        ],
</a><a href="#h37-0-225" id="h37-0-225" class="i">+    },
</a><a href="#h37-0-226" id="h37-0-226" class="i">+}
</a><a href="#h37-0-227" id="h37-0-227" class="i">+
</a><a href="#h37-0-228" id="h37-0-228" class="i">+Query: SELECT movies.id, title, genres.name AS genre FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genre, title
</a><a href="#h37-0-229" id="h37-0-229" class="i">+
</a><a href="#h37-0-230" id="h37-0-230" class="i">+Result: [&quot;id&quot;, &quot;title&quot;, &quot;genre&quot;]
</a><a href="#h37-0-231" id="h37-0-231" class="i">+[Integer(4), String(&quot;Heat&quot;), String(&quot;Action&quot;)]
</a><a href="#h37-0-232" id="h37-0-232" class="i">+[Integer(2), String(&quot;Sicario&quot;), String(&quot;Action&quot;)]
</a><a href="#h37-0-233" id="h37-0-233" class="i">+[Integer(3), String(&quot;Primer&quot;), String(&quot;Science Fiction&quot;)]
</a><a href="#h37-0-234" id="h37-0-234" class="i">+[Integer(1), String(&quot;Stalker&quot;), String(&quot;Science Fiction&quot;)]
</a><a href="#h37-0-235" id="h37-0-235" class="i">+[Integer(5), String(&quot;The Fountain&quot;), String(&quot;Science Fiction&quot;)]
</a><b>diff --git a/<a id="h38" href="../file/src/sql/tests/query/order_field_ambiguous.html">src/sql/tests/query/order_field_ambiguous</a> b/<a href="../file/src/sql/tests/query/order_field_ambiguous.html">src/sql/tests/query/order_field_ambiguous</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -0,0 +1,133 @@
</a><a href="#h38-0-0" id="h38-0-0" class="i">+Query: SELECT * FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY id
</a><a href="#h38-0-1" id="h38-0-1" class="i">+
</a><a href="#h38-0-2" id="h38-0-2" class="i">+AST: Select {
</a><a href="#h38-0-3" id="h38-0-3" class="i">+    select: SelectClause {
</a><a href="#h38-0-4" id="h38-0-4" class="i">+        expressions: [],
</a><a href="#h38-0-5" id="h38-0-5" class="i">+        labels: [],
</a><a href="#h38-0-6" id="h38-0-6" class="i">+    },
</a><a href="#h38-0-7" id="h38-0-7" class="i">+    from: Some(
</a><a href="#h38-0-8" id="h38-0-8" class="i">+        FromClause {
</a><a href="#h38-0-9" id="h38-0-9" class="i">+            items: [
</a><a href="#h38-0-10" id="h38-0-10" class="i">+                FromItem {
</a><a href="#h38-0-11" id="h38-0-11" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h38-0-12" id="h38-0-12" class="i">+                    join: None,
</a><a href="#h38-0-13" id="h38-0-13" class="i">+                },
</a><a href="#h38-0-14" id="h38-0-14" class="i">+                FromItem {
</a><a href="#h38-0-15" id="h38-0-15" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h38-0-16" id="h38-0-16" class="i">+                    join: None,
</a><a href="#h38-0-17" id="h38-0-17" class="i">+                },
</a><a href="#h38-0-18" id="h38-0-18" class="i">+            ],
</a><a href="#h38-0-19" id="h38-0-19" class="i">+        },
</a><a href="#h38-0-20" id="h38-0-20" class="i">+    ),
</a><a href="#h38-0-21" id="h38-0-21" class="i">+    where: Some(
</a><a href="#h38-0-22" id="h38-0-22" class="i">+        WhereClause(
</a><a href="#h38-0-23" id="h38-0-23" class="i">+            Operation(
</a><a href="#h38-0-24" id="h38-0-24" class="i">+                Equal(
</a><a href="#h38-0-25" id="h38-0-25" class="i">+                    Field(
</a><a href="#h38-0-26" id="h38-0-26" class="i">+                        Some(
</a><a href="#h38-0-27" id="h38-0-27" class="i">+                            &quot;movies&quot;,
</a><a href="#h38-0-28" id="h38-0-28" class="i">+                        ),
</a><a href="#h38-0-29" id="h38-0-29" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h38-0-30" id="h38-0-30" class="i">+                    ),
</a><a href="#h38-0-31" id="h38-0-31" class="i">+                    Field(
</a><a href="#h38-0-32" id="h38-0-32" class="i">+                        Some(
</a><a href="#h38-0-33" id="h38-0-33" class="i">+                            &quot;genres&quot;,
</a><a href="#h38-0-34" id="h38-0-34" class="i">+                        ),
</a><a href="#h38-0-35" id="h38-0-35" class="i">+                        &quot;id&quot;,
</a><a href="#h38-0-36" id="h38-0-36" class="i">+                    ),
</a><a href="#h38-0-37" id="h38-0-37" class="i">+                ),
</a><a href="#h38-0-38" id="h38-0-38" class="i">+            ),
</a><a href="#h38-0-39" id="h38-0-39" class="i">+        ),
</a><a href="#h38-0-40" id="h38-0-40" class="i">+    ),
</a><a href="#h38-0-41" id="h38-0-41" class="i">+    order: [
</a><a href="#h38-0-42" id="h38-0-42" class="i">+        (
</a><a href="#h38-0-43" id="h38-0-43" class="i">+            Field(
</a><a href="#h38-0-44" id="h38-0-44" class="i">+                None,
</a><a href="#h38-0-45" id="h38-0-45" class="i">+                &quot;id&quot;,
</a><a href="#h38-0-46" id="h38-0-46" class="i">+            ),
</a><a href="#h38-0-47" id="h38-0-47" class="i">+            Ascending,
</a><a href="#h38-0-48" id="h38-0-48" class="i">+        ),
</a><a href="#h38-0-49" id="h38-0-49" class="i">+    ],
</a><a href="#h38-0-50" id="h38-0-50" class="i">+    limit: None,
</a><a href="#h38-0-51" id="h38-0-51" class="i">+    offset: None,
</a><a href="#h38-0-52" id="h38-0-52" class="i">+}
</a><a href="#h38-0-53" id="h38-0-53" class="i">+
</a><a href="#h38-0-54" id="h38-0-54" class="i">+Plan: Plan {
</a><a href="#h38-0-55" id="h38-0-55" class="i">+    root: Order {
</a><a href="#h38-0-56" id="h38-0-56" class="i">+        source: Filter {
</a><a href="#h38-0-57" id="h38-0-57" class="i">+            source: NestedLoopJoin {
</a><a href="#h38-0-58" id="h38-0-58" class="i">+                outer: Scan {
</a><a href="#h38-0-59" id="h38-0-59" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h38-0-60" id="h38-0-60" class="i">+                },
</a><a href="#h38-0-61" id="h38-0-61" class="i">+                inner: Scan {
</a><a href="#h38-0-62" id="h38-0-62" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h38-0-63" id="h38-0-63" class="i">+                },
</a><a href="#h38-0-64" id="h38-0-64" class="i">+            },
</a><a href="#h38-0-65" id="h38-0-65" class="i">+            predicate: Equal(
</a><a href="#h38-0-66" id="h38-0-66" class="i">+                Field(
</a><a href="#h38-0-67" id="h38-0-67" class="i">+                    Some(
</a><a href="#h38-0-68" id="h38-0-68" class="i">+                        &quot;movies&quot;,
</a><a href="#h38-0-69" id="h38-0-69" class="i">+                    ),
</a><a href="#h38-0-70" id="h38-0-70" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h38-0-71" id="h38-0-71" class="i">+                ),
</a><a href="#h38-0-72" id="h38-0-72" class="i">+                Field(
</a><a href="#h38-0-73" id="h38-0-73" class="i">+                    Some(
</a><a href="#h38-0-74" id="h38-0-74" class="i">+                        &quot;genres&quot;,
</a><a href="#h38-0-75" id="h38-0-75" class="i">+                    ),
</a><a href="#h38-0-76" id="h38-0-76" class="i">+                    &quot;id&quot;,
</a><a href="#h38-0-77" id="h38-0-77" class="i">+                ),
</a><a href="#h38-0-78" id="h38-0-78" class="i">+            ),
</a><a href="#h38-0-79" id="h38-0-79" class="i">+        },
</a><a href="#h38-0-80" id="h38-0-80" class="i">+        orders: [
</a><a href="#h38-0-81" id="h38-0-81" class="i">+            (
</a><a href="#h38-0-82" id="h38-0-82" class="i">+                Field(
</a><a href="#h38-0-83" id="h38-0-83" class="i">+                    None,
</a><a href="#h38-0-84" id="h38-0-84" class="i">+                    &quot;id&quot;,
</a><a href="#h38-0-85" id="h38-0-85" class="i">+                ),
</a><a href="#h38-0-86" id="h38-0-86" class="i">+                Ascending,
</a><a href="#h38-0-87" id="h38-0-87" class="i">+            ),
</a><a href="#h38-0-88" id="h38-0-88" class="i">+        ],
</a><a href="#h38-0-89" id="h38-0-89" class="i">+    },
</a><a href="#h38-0-90" id="h38-0-90" class="i">+}
</a><a href="#h38-0-91" id="h38-0-91" class="i">+
</a><a href="#h38-0-92" id="h38-0-92" class="i">+Optimized plan: Plan {
</a><a href="#h38-0-93" id="h38-0-93" class="i">+    root: Order {
</a><a href="#h38-0-94" id="h38-0-94" class="i">+        source: Filter {
</a><a href="#h38-0-95" id="h38-0-95" class="i">+            source: NestedLoopJoin {
</a><a href="#h38-0-96" id="h38-0-96" class="i">+                outer: Scan {
</a><a href="#h38-0-97" id="h38-0-97" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h38-0-98" id="h38-0-98" class="i">+                },
</a><a href="#h38-0-99" id="h38-0-99" class="i">+                inner: Scan {
</a><a href="#h38-0-100" id="h38-0-100" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h38-0-101" id="h38-0-101" class="i">+                },
</a><a href="#h38-0-102" id="h38-0-102" class="i">+            },
</a><a href="#h38-0-103" id="h38-0-103" class="i">+            predicate: Equal(
</a><a href="#h38-0-104" id="h38-0-104" class="i">+                Field(
</a><a href="#h38-0-105" id="h38-0-105" class="i">+                    Some(
</a><a href="#h38-0-106" id="h38-0-106" class="i">+                        &quot;movies&quot;,
</a><a href="#h38-0-107" id="h38-0-107" class="i">+                    ),
</a><a href="#h38-0-108" id="h38-0-108" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h38-0-109" id="h38-0-109" class="i">+                ),
</a><a href="#h38-0-110" id="h38-0-110" class="i">+                Field(
</a><a href="#h38-0-111" id="h38-0-111" class="i">+                    Some(
</a><a href="#h38-0-112" id="h38-0-112" class="i">+                        &quot;genres&quot;,
</a><a href="#h38-0-113" id="h38-0-113" class="i">+                    ),
</a><a href="#h38-0-114" id="h38-0-114" class="i">+                    &quot;id&quot;,
</a><a href="#h38-0-115" id="h38-0-115" class="i">+                ),
</a><a href="#h38-0-116" id="h38-0-116" class="i">+            ),
</a><a href="#h38-0-117" id="h38-0-117" class="i">+        },
</a><a href="#h38-0-118" id="h38-0-118" class="i">+        orders: [
</a><a href="#h38-0-119" id="h38-0-119" class="i">+            (
</a><a href="#h38-0-120" id="h38-0-120" class="i">+                Field(
</a><a href="#h38-0-121" id="h38-0-121" class="i">+                    None,
</a><a href="#h38-0-122" id="h38-0-122" class="i">+                    &quot;id&quot;,
</a><a href="#h38-0-123" id="h38-0-123" class="i">+                ),
</a><a href="#h38-0-124" id="h38-0-124" class="i">+                Ascending,
</a><a href="#h38-0-125" id="h38-0-125" class="i">+            ),
</a><a href="#h38-0-126" id="h38-0-126" class="i">+        ],
</a><a href="#h38-0-127" id="h38-0-127" class="i">+    },
</a><a href="#h38-0-128" id="h38-0-128" class="i">+}
</a><a href="#h38-0-129" id="h38-0-129" class="i">+
</a><a href="#h38-0-130" id="h38-0-130" class="i">+Query: SELECT * FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY id
</a><a href="#h38-0-131" id="h38-0-131" class="i">+
</a><a href="#h38-0-132" id="h38-0-132" class="i">+Result: Value(&quot;Field reference id is ambiguous&quot;)
</a><a href="#h38-0-133" id="h38-0-133" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h39" href="../file/src/sql/tests/query/order_field_qualified.html">src/sql/tests/query/order_field_qualified</a> b/<a href="../file/src/sql/tests/query/order_field_qualified.html">src/sql/tests/query/order_field_qualified</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -0,0 +1,236 @@
</a><a href="#h39-0-0" id="h39-0-0" class="i">+Query: SELECT movies.id, title, name FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genres.name, movies.title
</a><a href="#h39-0-1" id="h39-0-1" class="i">+
</a><a href="#h39-0-2" id="h39-0-2" class="i">+AST: Select {
</a><a href="#h39-0-3" id="h39-0-3" class="i">+    select: SelectClause {
</a><a href="#h39-0-4" id="h39-0-4" class="i">+        expressions: [
</a><a href="#h39-0-5" id="h39-0-5" class="i">+            Field(
</a><a href="#h39-0-6" id="h39-0-6" class="i">+                Some(
</a><a href="#h39-0-7" id="h39-0-7" class="i">+                    &quot;movies&quot;,
</a><a href="#h39-0-8" id="h39-0-8" class="i">+                ),
</a><a href="#h39-0-9" id="h39-0-9" class="i">+                &quot;id&quot;,
</a><a href="#h39-0-10" id="h39-0-10" class="i">+            ),
</a><a href="#h39-0-11" id="h39-0-11" class="i">+            Field(
</a><a href="#h39-0-12" id="h39-0-12" class="i">+                None,
</a><a href="#h39-0-13" id="h39-0-13" class="i">+                &quot;title&quot;,
</a><a href="#h39-0-14" id="h39-0-14" class="i">+            ),
</a><a href="#h39-0-15" id="h39-0-15" class="i">+            Field(
</a><a href="#h39-0-16" id="h39-0-16" class="i">+                None,
</a><a href="#h39-0-17" id="h39-0-17" class="i">+                &quot;name&quot;,
</a><a href="#h39-0-18" id="h39-0-18" class="i">+            ),
</a><a href="#h39-0-19" id="h39-0-19" class="i">+        ],
</a><a href="#h39-0-20" id="h39-0-20" class="i">+        labels: [
</a><a href="#h39-0-21" id="h39-0-21" class="i">+            None,
</a><a href="#h39-0-22" id="h39-0-22" class="i">+            None,
</a><a href="#h39-0-23" id="h39-0-23" class="i">+            None,
</a><a href="#h39-0-24" id="h39-0-24" class="i">+        ],
</a><a href="#h39-0-25" id="h39-0-25" class="i">+    },
</a><a href="#h39-0-26" id="h39-0-26" class="i">+    from: Some(
</a><a href="#h39-0-27" id="h39-0-27" class="i">+        FromClause {
</a><a href="#h39-0-28" id="h39-0-28" class="i">+            items: [
</a><a href="#h39-0-29" id="h39-0-29" class="i">+                FromItem {
</a><a href="#h39-0-30" id="h39-0-30" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h39-0-31" id="h39-0-31" class="i">+                    join: None,
</a><a href="#h39-0-32" id="h39-0-32" class="i">+                },
</a><a href="#h39-0-33" id="h39-0-33" class="i">+                FromItem {
</a><a href="#h39-0-34" id="h39-0-34" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h39-0-35" id="h39-0-35" class="i">+                    join: None,
</a><a href="#h39-0-36" id="h39-0-36" class="i">+                },
</a><a href="#h39-0-37" id="h39-0-37" class="i">+            ],
</a><a href="#h39-0-38" id="h39-0-38" class="i">+        },
</a><a href="#h39-0-39" id="h39-0-39" class="i">+    ),
</a><a href="#h39-0-40" id="h39-0-40" class="i">+    where: Some(
</a><a href="#h39-0-41" id="h39-0-41" class="i">+        WhereClause(
</a><a href="#h39-0-42" id="h39-0-42" class="i">+            Operation(
</a><a href="#h39-0-43" id="h39-0-43" class="i">+                Equal(
</a><a href="#h39-0-44" id="h39-0-44" class="i">+                    Field(
</a><a href="#h39-0-45" id="h39-0-45" class="i">+                        Some(
</a><a href="#h39-0-46" id="h39-0-46" class="i">+                            &quot;movies&quot;,
</a><a href="#h39-0-47" id="h39-0-47" class="i">+                        ),
</a><a href="#h39-0-48" id="h39-0-48" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h39-0-49" id="h39-0-49" class="i">+                    ),
</a><a href="#h39-0-50" id="h39-0-50" class="i">+                    Field(
</a><a href="#h39-0-51" id="h39-0-51" class="i">+                        Some(
</a><a href="#h39-0-52" id="h39-0-52" class="i">+                            &quot;genres&quot;,
</a><a href="#h39-0-53" id="h39-0-53" class="i">+                        ),
</a><a href="#h39-0-54" id="h39-0-54" class="i">+                        &quot;id&quot;,
</a><a href="#h39-0-55" id="h39-0-55" class="i">+                    ),
</a><a href="#h39-0-56" id="h39-0-56" class="i">+                ),
</a><a href="#h39-0-57" id="h39-0-57" class="i">+            ),
</a><a href="#h39-0-58" id="h39-0-58" class="i">+        ),
</a><a href="#h39-0-59" id="h39-0-59" class="i">+    ),
</a><a href="#h39-0-60" id="h39-0-60" class="i">+    order: [
</a><a href="#h39-0-61" id="h39-0-61" class="i">+        (
</a><a href="#h39-0-62" id="h39-0-62" class="i">+            Field(
</a><a href="#h39-0-63" id="h39-0-63" class="i">+                Some(
</a><a href="#h39-0-64" id="h39-0-64" class="i">+                    &quot;genres&quot;,
</a><a href="#h39-0-65" id="h39-0-65" class="i">+                ),
</a><a href="#h39-0-66" id="h39-0-66" class="i">+                &quot;name&quot;,
</a><a href="#h39-0-67" id="h39-0-67" class="i">+            ),
</a><a href="#h39-0-68" id="h39-0-68" class="i">+            Ascending,
</a><a href="#h39-0-69" id="h39-0-69" class="i">+        ),
</a><a href="#h39-0-70" id="h39-0-70" class="i">+        (
</a><a href="#h39-0-71" id="h39-0-71" class="i">+            Field(
</a><a href="#h39-0-72" id="h39-0-72" class="i">+                Some(
</a><a href="#h39-0-73" id="h39-0-73" class="i">+                    &quot;movies&quot;,
</a><a href="#h39-0-74" id="h39-0-74" class="i">+                ),
</a><a href="#h39-0-75" id="h39-0-75" class="i">+                &quot;title&quot;,
</a><a href="#h39-0-76" id="h39-0-76" class="i">+            ),
</a><a href="#h39-0-77" id="h39-0-77" class="i">+            Ascending,
</a><a href="#h39-0-78" id="h39-0-78" class="i">+        ),
</a><a href="#h39-0-79" id="h39-0-79" class="i">+    ],
</a><a href="#h39-0-80" id="h39-0-80" class="i">+    limit: None,
</a><a href="#h39-0-81" id="h39-0-81" class="i">+    offset: None,
</a><a href="#h39-0-82" id="h39-0-82" class="i">+}
</a><a href="#h39-0-83" id="h39-0-83" class="i">+
</a><a href="#h39-0-84" id="h39-0-84" class="i">+Plan: Plan {
</a><a href="#h39-0-85" id="h39-0-85" class="i">+    root: Order {
</a><a href="#h39-0-86" id="h39-0-86" class="i">+        source: Projection {
</a><a href="#h39-0-87" id="h39-0-87" class="i">+            source: Filter {
</a><a href="#h39-0-88" id="h39-0-88" class="i">+                source: NestedLoopJoin {
</a><a href="#h39-0-89" id="h39-0-89" class="i">+                    outer: Scan {
</a><a href="#h39-0-90" id="h39-0-90" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h39-0-91" id="h39-0-91" class="i">+                    },
</a><a href="#h39-0-92" id="h39-0-92" class="i">+                    inner: Scan {
</a><a href="#h39-0-93" id="h39-0-93" class="i">+                        table: &quot;genres&quot;,
</a><a href="#h39-0-94" id="h39-0-94" class="i">+                    },
</a><a href="#h39-0-95" id="h39-0-95" class="i">+                },
</a><a href="#h39-0-96" id="h39-0-96" class="i">+                predicate: Equal(
</a><a href="#h39-0-97" id="h39-0-97" class="i">+                    Field(
</a><a href="#h39-0-98" id="h39-0-98" class="i">+                        Some(
</a><a href="#h39-0-99" id="h39-0-99" class="i">+                            &quot;movies&quot;,
</a><a href="#h39-0-100" id="h39-0-100" class="i">+                        ),
</a><a href="#h39-0-101" id="h39-0-101" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h39-0-102" id="h39-0-102" class="i">+                    ),
</a><a href="#h39-0-103" id="h39-0-103" class="i">+                    Field(
</a><a href="#h39-0-104" id="h39-0-104" class="i">+                        Some(
</a><a href="#h39-0-105" id="h39-0-105" class="i">+                            &quot;genres&quot;,
</a><a href="#h39-0-106" id="h39-0-106" class="i">+                        ),
</a><a href="#h39-0-107" id="h39-0-107" class="i">+                        &quot;id&quot;,
</a><a href="#h39-0-108" id="h39-0-108" class="i">+                    ),
</a><a href="#h39-0-109" id="h39-0-109" class="i">+                ),
</a><a href="#h39-0-110" id="h39-0-110" class="i">+            },
</a><a href="#h39-0-111" id="h39-0-111" class="i">+            labels: [
</a><a href="#h39-0-112" id="h39-0-112" class="i">+                None,
</a><a href="#h39-0-113" id="h39-0-113" class="i">+                None,
</a><a href="#h39-0-114" id="h39-0-114" class="i">+                None,
</a><a href="#h39-0-115" id="h39-0-115" class="i">+            ],
</a><a href="#h39-0-116" id="h39-0-116" class="i">+            expressions: [
</a><a href="#h39-0-117" id="h39-0-117" class="i">+                Field(
</a><a href="#h39-0-118" id="h39-0-118" class="i">+                    Some(
</a><a href="#h39-0-119" id="h39-0-119" class="i">+                        &quot;movies&quot;,
</a><a href="#h39-0-120" id="h39-0-120" class="i">+                    ),
</a><a href="#h39-0-121" id="h39-0-121" class="i">+                    &quot;id&quot;,
</a><a href="#h39-0-122" id="h39-0-122" class="i">+                ),
</a><a href="#h39-0-123" id="h39-0-123" class="i">+                Field(
</a><a href="#h39-0-124" id="h39-0-124" class="i">+                    None,
</a><a href="#h39-0-125" id="h39-0-125" class="i">+                    &quot;title&quot;,
</a><a href="#h39-0-126" id="h39-0-126" class="i">+                ),
</a><a href="#h39-0-127" id="h39-0-127" class="i">+                Field(
</a><a href="#h39-0-128" id="h39-0-128" class="i">+                    None,
</a><a href="#h39-0-129" id="h39-0-129" class="i">+                    &quot;name&quot;,
</a><a href="#h39-0-130" id="h39-0-130" class="i">+                ),
</a><a href="#h39-0-131" id="h39-0-131" class="i">+            ],
</a><a href="#h39-0-132" id="h39-0-132" class="i">+        },
</a><a href="#h39-0-133" id="h39-0-133" class="i">+        orders: [
</a><a href="#h39-0-134" id="h39-0-134" class="i">+            (
</a><a href="#h39-0-135" id="h39-0-135" class="i">+                Field(
</a><a href="#h39-0-136" id="h39-0-136" class="i">+                    Some(
</a><a href="#h39-0-137" id="h39-0-137" class="i">+                        &quot;genres&quot;,
</a><a href="#h39-0-138" id="h39-0-138" class="i">+                    ),
</a><a href="#h39-0-139" id="h39-0-139" class="i">+                    &quot;name&quot;,
</a><a href="#h39-0-140" id="h39-0-140" class="i">+                ),
</a><a href="#h39-0-141" id="h39-0-141" class="i">+                Ascending,
</a><a href="#h39-0-142" id="h39-0-142" class="i">+            ),
</a><a href="#h39-0-143" id="h39-0-143" class="i">+            (
</a><a href="#h39-0-144" id="h39-0-144" class="i">+                Field(
</a><a href="#h39-0-145" id="h39-0-145" class="i">+                    Some(
</a><a href="#h39-0-146" id="h39-0-146" class="i">+                        &quot;movies&quot;,
</a><a href="#h39-0-147" id="h39-0-147" class="i">+                    ),
</a><a href="#h39-0-148" id="h39-0-148" class="i">+                    &quot;title&quot;,
</a><a href="#h39-0-149" id="h39-0-149" class="i">+                ),
</a><a href="#h39-0-150" id="h39-0-150" class="i">+                Ascending,
</a><a href="#h39-0-151" id="h39-0-151" class="i">+            ),
</a><a href="#h39-0-152" id="h39-0-152" class="i">+        ],
</a><a href="#h39-0-153" id="h39-0-153" class="i">+    },
</a><a href="#h39-0-154" id="h39-0-154" class="i">+}
</a><a href="#h39-0-155" id="h39-0-155" class="i">+
</a><a href="#h39-0-156" id="h39-0-156" class="i">+Optimized plan: Plan {
</a><a href="#h39-0-157" id="h39-0-157" class="i">+    root: Order {
</a><a href="#h39-0-158" id="h39-0-158" class="i">+        source: Projection {
</a><a href="#h39-0-159" id="h39-0-159" class="i">+            source: Filter {
</a><a href="#h39-0-160" id="h39-0-160" class="i">+                source: NestedLoopJoin {
</a><a href="#h39-0-161" id="h39-0-161" class="i">+                    outer: Scan {
</a><a href="#h39-0-162" id="h39-0-162" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h39-0-163" id="h39-0-163" class="i">+                    },
</a><a href="#h39-0-164" id="h39-0-164" class="i">+                    inner: Scan {
</a><a href="#h39-0-165" id="h39-0-165" class="i">+                        table: &quot;genres&quot;,
</a><a href="#h39-0-166" id="h39-0-166" class="i">+                    },
</a><a href="#h39-0-167" id="h39-0-167" class="i">+                },
</a><a href="#h39-0-168" id="h39-0-168" class="i">+                predicate: Equal(
</a><a href="#h39-0-169" id="h39-0-169" class="i">+                    Field(
</a><a href="#h39-0-170" id="h39-0-170" class="i">+                        Some(
</a><a href="#h39-0-171" id="h39-0-171" class="i">+                            &quot;movies&quot;,
</a><a href="#h39-0-172" id="h39-0-172" class="i">+                        ),
</a><a href="#h39-0-173" id="h39-0-173" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h39-0-174" id="h39-0-174" class="i">+                    ),
</a><a href="#h39-0-175" id="h39-0-175" class="i">+                    Field(
</a><a href="#h39-0-176" id="h39-0-176" class="i">+                        Some(
</a><a href="#h39-0-177" id="h39-0-177" class="i">+                            &quot;genres&quot;,
</a><a href="#h39-0-178" id="h39-0-178" class="i">+                        ),
</a><a href="#h39-0-179" id="h39-0-179" class="i">+                        &quot;id&quot;,
</a><a href="#h39-0-180" id="h39-0-180" class="i">+                    ),
</a><a href="#h39-0-181" id="h39-0-181" class="i">+                ),
</a><a href="#h39-0-182" id="h39-0-182" class="i">+            },
</a><a href="#h39-0-183" id="h39-0-183" class="i">+            labels: [
</a><a href="#h39-0-184" id="h39-0-184" class="i">+                None,
</a><a href="#h39-0-185" id="h39-0-185" class="i">+                None,
</a><a href="#h39-0-186" id="h39-0-186" class="i">+                None,
</a><a href="#h39-0-187" id="h39-0-187" class="i">+            ],
</a><a href="#h39-0-188" id="h39-0-188" class="i">+            expressions: [
</a><a href="#h39-0-189" id="h39-0-189" class="i">+                Field(
</a><a href="#h39-0-190" id="h39-0-190" class="i">+                    Some(
</a><a href="#h39-0-191" id="h39-0-191" class="i">+                        &quot;movies&quot;,
</a><a href="#h39-0-192" id="h39-0-192" class="i">+                    ),
</a><a href="#h39-0-193" id="h39-0-193" class="i">+                    &quot;id&quot;,
</a><a href="#h39-0-194" id="h39-0-194" class="i">+                ),
</a><a href="#h39-0-195" id="h39-0-195" class="i">+                Field(
</a><a href="#h39-0-196" id="h39-0-196" class="i">+                    None,
</a><a href="#h39-0-197" id="h39-0-197" class="i">+                    &quot;title&quot;,
</a><a href="#h39-0-198" id="h39-0-198" class="i">+                ),
</a><a href="#h39-0-199" id="h39-0-199" class="i">+                Field(
</a><a href="#h39-0-200" id="h39-0-200" class="i">+                    None,
</a><a href="#h39-0-201" id="h39-0-201" class="i">+                    &quot;name&quot;,
</a><a href="#h39-0-202" id="h39-0-202" class="i">+                ),
</a><a href="#h39-0-203" id="h39-0-203" class="i">+            ],
</a><a href="#h39-0-204" id="h39-0-204" class="i">+        },
</a><a href="#h39-0-205" id="h39-0-205" class="i">+        orders: [
</a><a href="#h39-0-206" id="h39-0-206" class="i">+            (
</a><a href="#h39-0-207" id="h39-0-207" class="i">+                Field(
</a><a href="#h39-0-208" id="h39-0-208" class="i">+                    Some(
</a><a href="#h39-0-209" id="h39-0-209" class="i">+                        &quot;genres&quot;,
</a><a href="#h39-0-210" id="h39-0-210" class="i">+                    ),
</a><a href="#h39-0-211" id="h39-0-211" class="i">+                    &quot;name&quot;,
</a><a href="#h39-0-212" id="h39-0-212" class="i">+                ),
</a><a href="#h39-0-213" id="h39-0-213" class="i">+                Ascending,
</a><a href="#h39-0-214" id="h39-0-214" class="i">+            ),
</a><a href="#h39-0-215" id="h39-0-215" class="i">+            (
</a><a href="#h39-0-216" id="h39-0-216" class="i">+                Field(
</a><a href="#h39-0-217" id="h39-0-217" class="i">+                    Some(
</a><a href="#h39-0-218" id="h39-0-218" class="i">+                        &quot;movies&quot;,
</a><a href="#h39-0-219" id="h39-0-219" class="i">+                    ),
</a><a href="#h39-0-220" id="h39-0-220" class="i">+                    &quot;title&quot;,
</a><a href="#h39-0-221" id="h39-0-221" class="i">+                ),
</a><a href="#h39-0-222" id="h39-0-222" class="i">+                Ascending,
</a><a href="#h39-0-223" id="h39-0-223" class="i">+            ),
</a><a href="#h39-0-224" id="h39-0-224" class="i">+        ],
</a><a href="#h39-0-225" id="h39-0-225" class="i">+    },
</a><a href="#h39-0-226" id="h39-0-226" class="i">+}
</a><a href="#h39-0-227" id="h39-0-227" class="i">+
</a><a href="#h39-0-228" id="h39-0-228" class="i">+Query: SELECT movies.id, title, name FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genres.name, movies.title
</a><a href="#h39-0-229" id="h39-0-229" class="i">+
</a><a href="#h39-0-230" id="h39-0-230" class="i">+Result: [&quot;id&quot;, &quot;title&quot;, &quot;name&quot;]
</a><a href="#h39-0-231" id="h39-0-231" class="i">+[Integer(4), String(&quot;Heat&quot;), String(&quot;Action&quot;)]
</a><a href="#h39-0-232" id="h39-0-232" class="i">+[Integer(2), String(&quot;Sicario&quot;), String(&quot;Action&quot;)]
</a><a href="#h39-0-233" id="h39-0-233" class="i">+[Integer(3), String(&quot;Primer&quot;), String(&quot;Science Fiction&quot;)]
</a><a href="#h39-0-234" id="h39-0-234" class="i">+[Integer(1), String(&quot;Stalker&quot;), String(&quot;Science Fiction&quot;)]
</a><a href="#h39-0-235" id="h39-0-235" class="i">+[Integer(5), String(&quot;The Fountain&quot;), String(&quot;Science Fiction&quot;)]
</a><b>diff --git a/<a id="h40" href="../file/src/sql/tests/query/order_field_unknown.html">src/sql/tests/query/order_field_unknown</a> b/<a href="../file/src/sql/tests/query/order_field_unknown.html">src/sql/tests/query/order_field_unknown</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -0,0 +1,68 @@
</a><a href="#h40-0-0" id="h40-0-0" class="i">+Query: SELECT * FROM movies ORDER BY unknown
</a><a href="#h40-0-1" id="h40-0-1" class="i">+
</a><a href="#h40-0-2" id="h40-0-2" class="i">+AST: Select {
</a><a href="#h40-0-3" id="h40-0-3" class="i">+    select: SelectClause {
</a><a href="#h40-0-4" id="h40-0-4" class="i">+        expressions: [],
</a><a href="#h40-0-5" id="h40-0-5" class="i">+        labels: [],
</a><a href="#h40-0-6" id="h40-0-6" class="i">+    },
</a><a href="#h40-0-7" id="h40-0-7" class="i">+    from: Some(
</a><a href="#h40-0-8" id="h40-0-8" class="i">+        FromClause {
</a><a href="#h40-0-9" id="h40-0-9" class="i">+            items: [
</a><a href="#h40-0-10" id="h40-0-10" class="i">+                FromItem {
</a><a href="#h40-0-11" id="h40-0-11" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h40-0-12" id="h40-0-12" class="i">+                    join: None,
</a><a href="#h40-0-13" id="h40-0-13" class="i">+                },
</a><a href="#h40-0-14" id="h40-0-14" class="i">+            ],
</a><a href="#h40-0-15" id="h40-0-15" class="i">+        },
</a><a href="#h40-0-16" id="h40-0-16" class="i">+    ),
</a><a href="#h40-0-17" id="h40-0-17" class="i">+    where: None,
</a><a href="#h40-0-18" id="h40-0-18" class="i">+    order: [
</a><a href="#h40-0-19" id="h40-0-19" class="i">+        (
</a><a href="#h40-0-20" id="h40-0-20" class="i">+            Field(
</a><a href="#h40-0-21" id="h40-0-21" class="i">+                None,
</a><a href="#h40-0-22" id="h40-0-22" class="i">+                &quot;unknown&quot;,
</a><a href="#h40-0-23" id="h40-0-23" class="i">+            ),
</a><a href="#h40-0-24" id="h40-0-24" class="i">+            Ascending,
</a><a href="#h40-0-25" id="h40-0-25" class="i">+        ),
</a><a href="#h40-0-26" id="h40-0-26" class="i">+    ],
</a><a href="#h40-0-27" id="h40-0-27" class="i">+    limit: None,
</a><a href="#h40-0-28" id="h40-0-28" class="i">+    offset: None,
</a><a href="#h40-0-29" id="h40-0-29" class="i">+}
</a><a href="#h40-0-30" id="h40-0-30" class="i">+
</a><a href="#h40-0-31" id="h40-0-31" class="i">+Plan: Plan {
</a><a href="#h40-0-32" id="h40-0-32" class="i">+    root: Order {
</a><a href="#h40-0-33" id="h40-0-33" class="i">+        source: Scan {
</a><a href="#h40-0-34" id="h40-0-34" class="i">+            table: &quot;movies&quot;,
</a><a href="#h40-0-35" id="h40-0-35" class="i">+        },
</a><a href="#h40-0-36" id="h40-0-36" class="i">+        orders: [
</a><a href="#h40-0-37" id="h40-0-37" class="i">+            (
</a><a href="#h40-0-38" id="h40-0-38" class="i">+                Field(
</a><a href="#h40-0-39" id="h40-0-39" class="i">+                    None,
</a><a href="#h40-0-40" id="h40-0-40" class="i">+                    &quot;unknown&quot;,
</a><a href="#h40-0-41" id="h40-0-41" class="i">+                ),
</a><a href="#h40-0-42" id="h40-0-42" class="i">+                Ascending,
</a><a href="#h40-0-43" id="h40-0-43" class="i">+            ),
</a><a href="#h40-0-44" id="h40-0-44" class="i">+        ],
</a><a href="#h40-0-45" id="h40-0-45" class="i">+    },
</a><a href="#h40-0-46" id="h40-0-46" class="i">+}
</a><a href="#h40-0-47" id="h40-0-47" class="i">+
</a><a href="#h40-0-48" id="h40-0-48" class="i">+Optimized plan: Plan {
</a><a href="#h40-0-49" id="h40-0-49" class="i">+    root: Order {
</a><a href="#h40-0-50" id="h40-0-50" class="i">+        source: Scan {
</a><a href="#h40-0-51" id="h40-0-51" class="i">+            table: &quot;movies&quot;,
</a><a href="#h40-0-52" id="h40-0-52" class="i">+        },
</a><a href="#h40-0-53" id="h40-0-53" class="i">+        orders: [
</a><a href="#h40-0-54" id="h40-0-54" class="i">+            (
</a><a href="#h40-0-55" id="h40-0-55" class="i">+                Field(
</a><a href="#h40-0-56" id="h40-0-56" class="i">+                    None,
</a><a href="#h40-0-57" id="h40-0-57" class="i">+                    &quot;unknown&quot;,
</a><a href="#h40-0-58" id="h40-0-58" class="i">+                ),
</a><a href="#h40-0-59" id="h40-0-59" class="i">+                Ascending,
</a><a href="#h40-0-60" id="h40-0-60" class="i">+            ),
</a><a href="#h40-0-61" id="h40-0-61" class="i">+        ],
</a><a href="#h40-0-62" id="h40-0-62" class="i">+    },
</a><a href="#h40-0-63" id="h40-0-63" class="i">+}
</a><a href="#h40-0-64" id="h40-0-64" class="i">+
</a><a href="#h40-0-65" id="h40-0-65" class="i">+Query: SELECT * FROM movies ORDER BY unknown
</a><a href="#h40-0-66" id="h40-0-66" class="i">+
</a><a href="#h40-0-67" id="h40-0-67" class="i">+Result: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h40-0-68" id="h40-0-68" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h41" href="../file/src/sql/tests/query/order_float_asc.html">src/sql/tests/query/order_float_asc</a> b/<a href="../file/src/sql/tests/query/order_float_asc.html">src/sql/tests/query/order_float_asc</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h41-0-3" id="h41-0-3" class="i">+                None,
</a>                 &quot;value&quot;,
             ),
             Ascending,
<a href="#h41-1" id="h41-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h41-1-3" id="h41-1-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Ascending,
<a href="#h41-2" id="h41-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h41-2-3" id="h41-2-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Ascending,
<b>diff --git a/<a id="h42" href="../file/src/sql/tests/query/order_float_desc.html">src/sql/tests/query/order_float_desc</a> b/<a href="../file/src/sql/tests/query/order_float_desc.html">src/sql/tests/query/order_float_desc</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h42-0-3" id="h42-0-3" class="i">+                None,
</a>                 &quot;value&quot;,
             ),
             Descending,
<a href="#h42-1" id="h42-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h42-1-3" id="h42-1-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Descending,
<a href="#h42-2" id="h42-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h42-2-3" id="h42-2-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Descending,
<b>diff --git a/<a id="h43" href="../file/src/sql/tests/query/order_integer_asc.html">src/sql/tests/query/order_integer_asc</a> b/<a href="../file/src/sql/tests/query/order_integer_asc.html">src/sql/tests/query/order_integer_asc</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h43-0-3" id="h43-0-3" class="i">+                None,
</a>                 &quot;value&quot;,
             ),
             Ascending,
<a href="#h43-1" id="h43-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h43-1-3" id="h43-1-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Ascending,
<a href="#h43-2" id="h43-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h43-2-3" id="h43-2-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Ascending,
<b>diff --git a/<a id="h44" href="../file/src/sql/tests/query/order_integer_desc.html">src/sql/tests/query/order_integer_desc</a> b/<a href="../file/src/sql/tests/query/order_integer_desc.html">src/sql/tests/query/order_integer_desc</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h44-0-3" id="h44-0-3" class="i">+                None,
</a>                 &quot;value&quot;,
             ),
             Descending,
<a href="#h44-1" id="h44-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h44-1-3" id="h44-1-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Descending,
<a href="#h44-2" id="h44-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h44-2-3" id="h44-2-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Descending,
<b>diff --git a/<a id="h45" href="../file/src/sql/tests/query/order_multi.html">src/sql/tests/query/order_multi</a> b/<a href="../file/src/sql/tests/query/order_multi.html">src/sql/tests/query/order_multi</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -19,12 +19,14 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h45-0-3" id="h45-0-3" class="i">+                None,
</a>                 &quot;ultrahd&quot;,
             ),
             Ascending,
         ),
         (
             Field(
<a href="#h45-0-10" id="h45-0-10" class="i">+                None,
</a>                 &quot;id&quot;,
             ),
             Descending,
<a href="#h45-1" id="h45-1" class="h">@@ -42,12 +44,14 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h45-1-3" id="h45-1-3" class="i">+                    None,
</a>                     &quot;ultrahd&quot;,
                 ),
                 Ascending,
             ),
             (
                 Field(
<a href="#h45-1-10" id="h45-1-10" class="i">+                    None,
</a>                     &quot;id&quot;,
                 ),
                 Descending,
<a href="#h45-2" id="h45-2" class="h">@@ -64,12 +68,14 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h45-2-3" id="h45-2-3" class="i">+                    None,
</a>                     &quot;ultrahd&quot;,
                 ),
                 Ascending,
             ),
             (
                 Field(
<a href="#h45-2-10" id="h45-2-10" class="i">+                    None,
</a>                     &quot;id&quot;,
                 ),
                 Descending,
<b>diff --git a/<a id="h46" href="../file/src/sql/tests/query/order_string_asc.html">src/sql/tests/query/order_string_asc</a> b/<a href="../file/src/sql/tests/query/order_string_asc.html">src/sql/tests/query/order_string_asc</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h46-0-3" id="h46-0-3" class="i">+                None,
</a>                 &quot;value&quot;,
             ),
             Ascending,
<a href="#h46-1" id="h46-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h46-1-3" id="h46-1-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Ascending,
<a href="#h46-2" id="h46-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h46-2-3" id="h46-2-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Ascending,
<b>diff --git a/<a id="h47" href="../file/src/sql/tests/query/order_string_desc.html">src/sql/tests/query/order_string_desc</a> b/<a href="../file/src/sql/tests/query/order_string_desc.html">src/sql/tests/query/order_string_desc</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -19,6 +19,7 @@ AST: Select {
</a>     order: [
         (
             Field(
<a href="#h47-0-3" id="h47-0-3" class="i">+                None,
</a>                 &quot;value&quot;,
             ),
             Descending,
<a href="#h47-1" id="h47-1" class="h">@@ -36,6 +37,7 @@ Plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h47-1-3" id="h47-1-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Descending,
<a href="#h47-2" id="h47-2" class="h">@@ -52,6 +54,7 @@ Optimized plan: Plan {
</a>         orders: [
             (
                 Field(
<a href="#h47-2-3" id="h47-2-3" class="i">+                    None,
</a>                     &quot;value&quot;,
                 ),
                 Descending,
<b>diff --git a/<a id="h48" href="../file/src/sql/tests/query/order_unknown.html">src/sql/tests/query/order_unknown</a> b/<a href="../file/src/sql/tests/query/order_unknown.html">src/sql/tests/query/order_unknown</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -1,65 +0,0 @@
</a><a href="#h48-0-0" id="h48-0-0" class="d">-Query: SELECT * FROM movies ORDER BY unknown
</a><a href="#h48-0-1" id="h48-0-1" class="d">-
</a><a href="#h48-0-2" id="h48-0-2" class="d">-AST: Select {
</a><a href="#h48-0-3" id="h48-0-3" class="d">-    select: SelectClause {
</a><a href="#h48-0-4" id="h48-0-4" class="d">-        expressions: [],
</a><a href="#h48-0-5" id="h48-0-5" class="d">-        labels: [],
</a><a href="#h48-0-6" id="h48-0-6" class="d">-    },
</a><a href="#h48-0-7" id="h48-0-7" class="d">-    from: Some(
</a><a href="#h48-0-8" id="h48-0-8" class="d">-        FromClause {
</a><a href="#h48-0-9" id="h48-0-9" class="d">-            items: [
</a><a href="#h48-0-10" id="h48-0-10" class="d">-                FromItem {
</a><a href="#h48-0-11" id="h48-0-11" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h48-0-12" id="h48-0-12" class="d">-                    join: None,
</a><a href="#h48-0-13" id="h48-0-13" class="d">-                },
</a><a href="#h48-0-14" id="h48-0-14" class="d">-            ],
</a><a href="#h48-0-15" id="h48-0-15" class="d">-        },
</a><a href="#h48-0-16" id="h48-0-16" class="d">-    ),
</a><a href="#h48-0-17" id="h48-0-17" class="d">-    where: None,
</a><a href="#h48-0-18" id="h48-0-18" class="d">-    order: [
</a><a href="#h48-0-19" id="h48-0-19" class="d">-        (
</a><a href="#h48-0-20" id="h48-0-20" class="d">-            Field(
</a><a href="#h48-0-21" id="h48-0-21" class="d">-                &quot;unknown&quot;,
</a><a href="#h48-0-22" id="h48-0-22" class="d">-            ),
</a><a href="#h48-0-23" id="h48-0-23" class="d">-            Ascending,
</a><a href="#h48-0-24" id="h48-0-24" class="d">-        ),
</a><a href="#h48-0-25" id="h48-0-25" class="d">-    ],
</a><a href="#h48-0-26" id="h48-0-26" class="d">-    limit: None,
</a><a href="#h48-0-27" id="h48-0-27" class="d">-    offset: None,
</a><a href="#h48-0-28" id="h48-0-28" class="d">-}
</a><a href="#h48-0-29" id="h48-0-29" class="d">-
</a><a href="#h48-0-30" id="h48-0-30" class="d">-Plan: Plan {
</a><a href="#h48-0-31" id="h48-0-31" class="d">-    root: Order {
</a><a href="#h48-0-32" id="h48-0-32" class="d">-        source: Scan {
</a><a href="#h48-0-33" id="h48-0-33" class="d">-            table: &quot;movies&quot;,
</a><a href="#h48-0-34" id="h48-0-34" class="d">-        },
</a><a href="#h48-0-35" id="h48-0-35" class="d">-        orders: [
</a><a href="#h48-0-36" id="h48-0-36" class="d">-            (
</a><a href="#h48-0-37" id="h48-0-37" class="d">-                Field(
</a><a href="#h48-0-38" id="h48-0-38" class="d">-                    &quot;unknown&quot;,
</a><a href="#h48-0-39" id="h48-0-39" class="d">-                ),
</a><a href="#h48-0-40" id="h48-0-40" class="d">-                Ascending,
</a><a href="#h48-0-41" id="h48-0-41" class="d">-            ),
</a><a href="#h48-0-42" id="h48-0-42" class="d">-        ],
</a><a href="#h48-0-43" id="h48-0-43" class="d">-    },
</a><a href="#h48-0-44" id="h48-0-44" class="d">-}
</a><a href="#h48-0-45" id="h48-0-45" class="d">-
</a><a href="#h48-0-46" id="h48-0-46" class="d">-Optimized plan: Plan {
</a><a href="#h48-0-47" id="h48-0-47" class="d">-    root: Order {
</a><a href="#h48-0-48" id="h48-0-48" class="d">-        source: Scan {
</a><a href="#h48-0-49" id="h48-0-49" class="d">-            table: &quot;movies&quot;,
</a><a href="#h48-0-50" id="h48-0-50" class="d">-        },
</a><a href="#h48-0-51" id="h48-0-51" class="d">-        orders: [
</a><a href="#h48-0-52" id="h48-0-52" class="d">-            (
</a><a href="#h48-0-53" id="h48-0-53" class="d">-                Field(
</a><a href="#h48-0-54" id="h48-0-54" class="d">-                    &quot;unknown&quot;,
</a><a href="#h48-0-55" id="h48-0-55" class="d">-                ),
</a><a href="#h48-0-56" id="h48-0-56" class="d">-                Ascending,
</a><a href="#h48-0-57" id="h48-0-57" class="d">-            ),
</a><a href="#h48-0-58" id="h48-0-58" class="d">-        ],
</a><a href="#h48-0-59" id="h48-0-59" class="d">-    },
</a><a href="#h48-0-60" id="h48-0-60" class="d">-}
</a><a href="#h48-0-61" id="h48-0-61" class="d">-
</a><a href="#h48-0-62" id="h48-0-62" class="d">-Query: SELECT * FROM movies ORDER BY unknown
</a><a href="#h48-0-63" id="h48-0-63" class="d">-
</a><a href="#h48-0-64" id="h48-0-64" class="d">-Result: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h48-0-65" id="h48-0-65" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h49" href="../file/src/sql/tests/query/unknown.html">src/sql/tests/query/unknown</a> b/<a href="../file/src/sql/tests/query/unknown.html">src/sql/tests/query/unknown</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -1,51 +0,0 @@
</a><a href="#h49-0-0" id="h49-0-0" class="d">-Query: SELECT unknown
</a><a href="#h49-0-1" id="h49-0-1" class="d">-
</a><a href="#h49-0-2" id="h49-0-2" class="d">-AST: Select {
</a><a href="#h49-0-3" id="h49-0-3" class="d">-    select: SelectClause {
</a><a href="#h49-0-4" id="h49-0-4" class="d">-        expressions: [
</a><a href="#h49-0-5" id="h49-0-5" class="d">-            Field(
</a><a href="#h49-0-6" id="h49-0-6" class="d">-                &quot;unknown&quot;,
</a><a href="#h49-0-7" id="h49-0-7" class="d">-            ),
</a><a href="#h49-0-8" id="h49-0-8" class="d">-        ],
</a><a href="#h49-0-9" id="h49-0-9" class="d">-        labels: [
</a><a href="#h49-0-10" id="h49-0-10" class="d">-            None,
</a><a href="#h49-0-11" id="h49-0-11" class="d">-        ],
</a><a href="#h49-0-12" id="h49-0-12" class="d">-    },
</a><a href="#h49-0-13" id="h49-0-13" class="d">-    from: None,
</a><a href="#h49-0-14" id="h49-0-14" class="d">-    where: None,
</a><a href="#h49-0-15" id="h49-0-15" class="d">-    order: [],
</a><a href="#h49-0-16" id="h49-0-16" class="d">-    limit: None,
</a><a href="#h49-0-17" id="h49-0-17" class="d">-    offset: None,
</a><a href="#h49-0-18" id="h49-0-18" class="d">-}
</a><a href="#h49-0-19" id="h49-0-19" class="d">-
</a><a href="#h49-0-20" id="h49-0-20" class="d">-Plan: Plan {
</a><a href="#h49-0-21" id="h49-0-21" class="d">-    root: Projection {
</a><a href="#h49-0-22" id="h49-0-22" class="d">-        source: Nothing,
</a><a href="#h49-0-23" id="h49-0-23" class="d">-        labels: [
</a><a href="#h49-0-24" id="h49-0-24" class="d">-            None,
</a><a href="#h49-0-25" id="h49-0-25" class="d">-        ],
</a><a href="#h49-0-26" id="h49-0-26" class="d">-        expressions: [
</a><a href="#h49-0-27" id="h49-0-27" class="d">-            Field(
</a><a href="#h49-0-28" id="h49-0-28" class="d">-                &quot;unknown&quot;,
</a><a href="#h49-0-29" id="h49-0-29" class="d">-            ),
</a><a href="#h49-0-30" id="h49-0-30" class="d">-        ],
</a><a href="#h49-0-31" id="h49-0-31" class="d">-    },
</a><a href="#h49-0-32" id="h49-0-32" class="d">-}
</a><a href="#h49-0-33" id="h49-0-33" class="d">-
</a><a href="#h49-0-34" id="h49-0-34" class="d">-Optimized plan: Plan {
</a><a href="#h49-0-35" id="h49-0-35" class="d">-    root: Projection {
</a><a href="#h49-0-36" id="h49-0-36" class="d">-        source: Nothing,
</a><a href="#h49-0-37" id="h49-0-37" class="d">-        labels: [
</a><a href="#h49-0-38" id="h49-0-38" class="d">-            None,
</a><a href="#h49-0-39" id="h49-0-39" class="d">-        ],
</a><a href="#h49-0-40" id="h49-0-40" class="d">-        expressions: [
</a><a href="#h49-0-41" id="h49-0-41" class="d">-            Field(
</a><a href="#h49-0-42" id="h49-0-42" class="d">-                &quot;unknown&quot;,
</a><a href="#h49-0-43" id="h49-0-43" class="d">-            ),
</a><a href="#h49-0-44" id="h49-0-44" class="d">-        ],
</a><a href="#h49-0-45" id="h49-0-45" class="d">-    },
</a><a href="#h49-0-46" id="h49-0-46" class="d">-}
</a><a href="#h49-0-47" id="h49-0-47" class="d">-
</a><a href="#h49-0-48" id="h49-0-48" class="d">-Query: SELECT unknown
</a><a href="#h49-0-49" id="h49-0-49" class="d">-
</a><a href="#h49-0-50" id="h49-0-50" class="d">-Result: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h49-0-51" id="h49-0-51" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h50" href="../file/src/sql/tests/query/where_expr.html">src/sql/tests/query/where_expr</a> b/<a href="../file/src/sql/tests/query/where_expr.html">src/sql/tests/query/where_expr</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -22,6 +22,7 @@ AST: Select {
</a>                     Operation(
                         GreaterThanOrEqual(
                             Field(
<a href="#h50-0-3" id="h50-0-3" class="i">+                                None,
</a>                                 &quot;released&quot;,
                             ),
                             Literal(
<a href="#h50-1" id="h50-1" class="h">@@ -32,6 +33,7 @@ AST: Select {
</a>                         ),
                     ),
                     Field(
<a href="#h50-1-3" id="h50-1-3" class="i">+                        None,
</a>                         &quot;ultrahd&quot;,
                     ),
                 ),
<a href="#h50-2" id="h50-2" class="h">@@ -52,6 +54,7 @@ Plan: Plan {
</a>             Or(
                 GreaterThan(
                     Field(
<a href="#h50-2-3" id="h50-2-3" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Constant(
<a href="#h50-3" id="h50-3" class="h">@@ -62,6 +65,7 @@ Plan: Plan {
</a>                 ),
                 Equal(
                     Field(
<a href="#h50-3-3" id="h50-3-3" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Constant(
<a href="#h50-4" id="h50-4" class="h">@@ -72,6 +76,7 @@ Plan: Plan {
</a>                 ),
             ),
             Field(
<a href="#h50-4-3" id="h50-4-3" class="i">+                None,
</a>                 &quot;ultrahd&quot;,
             ),
         ),
<a href="#h50-5" id="h50-5" class="h">@@ -87,6 +92,7 @@ Optimized plan: Plan {
</a>             Or(
                 GreaterThan(
                     Field(
<a href="#h50-5-3" id="h50-5-3" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Constant(
<a href="#h50-6" id="h50-6" class="h">@@ -97,6 +103,7 @@ Optimized plan: Plan {
</a>                 ),
                 Equal(
                     Field(
<a href="#h50-6-3" id="h50-6-3" class="i">+                        None,
</a>                         &quot;released&quot;,
                     ),
                     Constant(
<a href="#h50-7" id="h50-7" class="h">@@ -107,6 +114,7 @@ Optimized plan: Plan {
</a>                 ),
             ),
             Field(
<a href="#h50-7-3" id="h50-7-3" class="i">+                None,
</a>                 &quot;ultrahd&quot;,
             ),
         ),
<b>diff --git a/<a id="h51" href="../file/src/sql/tests/query/where_field_ambiguous.html">src/sql/tests/query/where_field_ambiguous</a> b/<a href="../file/src/sql/tests/query/where_field_ambiguous.html">src/sql/tests/query/where_field_ambiguous</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -0,0 +1,176 @@
</a><a href="#h51-0-0" id="h51-0-0" class="i">+Query: SELECT movies.id, genres.id FROM movies, genres WHERE id &gt;= 3
</a><a href="#h51-0-1" id="h51-0-1" class="i">+
</a><a href="#h51-0-2" id="h51-0-2" class="i">+AST: Select {
</a><a href="#h51-0-3" id="h51-0-3" class="i">+    select: SelectClause {
</a><a href="#h51-0-4" id="h51-0-4" class="i">+        expressions: [
</a><a href="#h51-0-5" id="h51-0-5" class="i">+            Field(
</a><a href="#h51-0-6" id="h51-0-6" class="i">+                Some(
</a><a href="#h51-0-7" id="h51-0-7" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-0-8" id="h51-0-8" class="i">+                ),
</a><a href="#h51-0-9" id="h51-0-9" class="i">+                &quot;id&quot;,
</a><a href="#h51-0-10" id="h51-0-10" class="i">+            ),
</a><a href="#h51-0-11" id="h51-0-11" class="i">+            Field(
</a><a href="#h51-0-12" id="h51-0-12" class="i">+                Some(
</a><a href="#h51-0-13" id="h51-0-13" class="i">+                    &quot;genres&quot;,
</a><a href="#h51-0-14" id="h51-0-14" class="i">+                ),
</a><a href="#h51-0-15" id="h51-0-15" class="i">+                &quot;id&quot;,
</a><a href="#h51-0-16" id="h51-0-16" class="i">+            ),
</a><a href="#h51-0-17" id="h51-0-17" class="i">+        ],
</a><a href="#h51-0-18" id="h51-0-18" class="i">+        labels: [
</a><a href="#h51-0-19" id="h51-0-19" class="i">+            None,
</a><a href="#h51-0-20" id="h51-0-20" class="i">+            None,
</a><a href="#h51-0-21" id="h51-0-21" class="i">+        ],
</a><a href="#h51-0-22" id="h51-0-22" class="i">+    },
</a><a href="#h51-0-23" id="h51-0-23" class="i">+    from: Some(
</a><a href="#h51-0-24" id="h51-0-24" class="i">+        FromClause {
</a><a href="#h51-0-25" id="h51-0-25" class="i">+            items: [
</a><a href="#h51-0-26" id="h51-0-26" class="i">+                FromItem {
</a><a href="#h51-0-27" id="h51-0-27" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h51-0-28" id="h51-0-28" class="i">+                    join: None,
</a><a href="#h51-0-29" id="h51-0-29" class="i">+                },
</a><a href="#h51-0-30" id="h51-0-30" class="i">+                FromItem {
</a><a href="#h51-0-31" id="h51-0-31" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h51-0-32" id="h51-0-32" class="i">+                    join: None,
</a><a href="#h51-0-33" id="h51-0-33" class="i">+                },
</a><a href="#h51-0-34" id="h51-0-34" class="i">+            ],
</a><a href="#h51-0-35" id="h51-0-35" class="i">+        },
</a><a href="#h51-0-36" id="h51-0-36" class="i">+    ),
</a><a href="#h51-0-37" id="h51-0-37" class="i">+    where: Some(
</a><a href="#h51-0-38" id="h51-0-38" class="i">+        WhereClause(
</a><a href="#h51-0-39" id="h51-0-39" class="i">+            Operation(
</a><a href="#h51-0-40" id="h51-0-40" class="i">+                GreaterThanOrEqual(
</a><a href="#h51-0-41" id="h51-0-41" class="i">+                    Field(
</a><a href="#h51-0-42" id="h51-0-42" class="i">+                        None,
</a><a href="#h51-0-43" id="h51-0-43" class="i">+                        &quot;id&quot;,
</a><a href="#h51-0-44" id="h51-0-44" class="i">+                    ),
</a><a href="#h51-0-45" id="h51-0-45" class="i">+                    Literal(
</a><a href="#h51-0-46" id="h51-0-46" class="i">+                        Integer(
</a><a href="#h51-0-47" id="h51-0-47" class="i">+                            3,
</a><a href="#h51-0-48" id="h51-0-48" class="i">+                        ),
</a><a href="#h51-0-49" id="h51-0-49" class="i">+                    ),
</a><a href="#h51-0-50" id="h51-0-50" class="i">+                ),
</a><a href="#h51-0-51" id="h51-0-51" class="i">+            ),
</a><a href="#h51-0-52" id="h51-0-52" class="i">+        ),
</a><a href="#h51-0-53" id="h51-0-53" class="i">+    ),
</a><a href="#h51-0-54" id="h51-0-54" class="i">+    order: [],
</a><a href="#h51-0-55" id="h51-0-55" class="i">+    limit: None,
</a><a href="#h51-0-56" id="h51-0-56" class="i">+    offset: None,
</a><a href="#h51-0-57" id="h51-0-57" class="i">+}
</a><a href="#h51-0-58" id="h51-0-58" class="i">+
</a><a href="#h51-0-59" id="h51-0-59" class="i">+Plan: Plan {
</a><a href="#h51-0-60" id="h51-0-60" class="i">+    root: Projection {
</a><a href="#h51-0-61" id="h51-0-61" class="i">+        source: Filter {
</a><a href="#h51-0-62" id="h51-0-62" class="i">+            source: NestedLoopJoin {
</a><a href="#h51-0-63" id="h51-0-63" class="i">+                outer: Scan {
</a><a href="#h51-0-64" id="h51-0-64" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h51-0-65" id="h51-0-65" class="i">+                },
</a><a href="#h51-0-66" id="h51-0-66" class="i">+                inner: Scan {
</a><a href="#h51-0-67" id="h51-0-67" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h51-0-68" id="h51-0-68" class="i">+                },
</a><a href="#h51-0-69" id="h51-0-69" class="i">+            },
</a><a href="#h51-0-70" id="h51-0-70" class="i">+            predicate: Or(
</a><a href="#h51-0-71" id="h51-0-71" class="i">+                GreaterThan(
</a><a href="#h51-0-72" id="h51-0-72" class="i">+                    Field(
</a><a href="#h51-0-73" id="h51-0-73" class="i">+                        None,
</a><a href="#h51-0-74" id="h51-0-74" class="i">+                        &quot;id&quot;,
</a><a href="#h51-0-75" id="h51-0-75" class="i">+                    ),
</a><a href="#h51-0-76" id="h51-0-76" class="i">+                    Constant(
</a><a href="#h51-0-77" id="h51-0-77" class="i">+                        Integer(
</a><a href="#h51-0-78" id="h51-0-78" class="i">+                            3,
</a><a href="#h51-0-79" id="h51-0-79" class="i">+                        ),
</a><a href="#h51-0-80" id="h51-0-80" class="i">+                    ),
</a><a href="#h51-0-81" id="h51-0-81" class="i">+                ),
</a><a href="#h51-0-82" id="h51-0-82" class="i">+                Equal(
</a><a href="#h51-0-83" id="h51-0-83" class="i">+                    Field(
</a><a href="#h51-0-84" id="h51-0-84" class="i">+                        None,
</a><a href="#h51-0-85" id="h51-0-85" class="i">+                        &quot;id&quot;,
</a><a href="#h51-0-86" id="h51-0-86" class="i">+                    ),
</a><a href="#h51-0-87" id="h51-0-87" class="i">+                    Constant(
</a><a href="#h51-0-88" id="h51-0-88" class="i">+                        Integer(
</a><a href="#h51-0-89" id="h51-0-89" class="i">+                            3,
</a><a href="#h51-0-90" id="h51-0-90" class="i">+                        ),
</a><a href="#h51-0-91" id="h51-0-91" class="i">+                    ),
</a><a href="#h51-0-92" id="h51-0-92" class="i">+                ),
</a><a href="#h51-0-93" id="h51-0-93" class="i">+            ),
</a><a href="#h51-0-94" id="h51-0-94" class="i">+        },
</a><a href="#h51-0-95" id="h51-0-95" class="i">+        labels: [
</a><a href="#h51-0-96" id="h51-0-96" class="i">+            None,
</a><a href="#h51-0-97" id="h51-0-97" class="i">+            None,
</a><a href="#h51-0-98" id="h51-0-98" class="i">+        ],
</a><a href="#h51-0-99" id="h51-0-99" class="i">+        expressions: [
</a><a href="#h51-0-100" id="h51-0-100" class="i">+            Field(
</a><a href="#h51-0-101" id="h51-0-101" class="i">+                Some(
</a><a href="#h51-0-102" id="h51-0-102" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-0-103" id="h51-0-103" class="i">+                ),
</a><a href="#h51-0-104" id="h51-0-104" class="i">+                &quot;id&quot;,
</a><a href="#h51-0-105" id="h51-0-105" class="i">+            ),
</a><a href="#h51-0-106" id="h51-0-106" class="i">+            Field(
</a><a href="#h51-0-107" id="h51-0-107" class="i">+                Some(
</a><a href="#h51-0-108" id="h51-0-108" class="i">+                    &quot;genres&quot;,
</a><a href="#h51-0-109" id="h51-0-109" class="i">+                ),
</a><a href="#h51-0-110" id="h51-0-110" class="i">+                &quot;id&quot;,
</a><a href="#h51-0-111" id="h51-0-111" class="i">+            ),
</a><a href="#h51-0-112" id="h51-0-112" class="i">+        ],
</a><a href="#h51-0-113" id="h51-0-113" class="i">+    },
</a><a href="#h51-0-114" id="h51-0-114" class="i">+}
</a><a href="#h51-0-115" id="h51-0-115" class="i">+
</a><a href="#h51-0-116" id="h51-0-116" class="i">+Optimized plan: Plan {
</a><a href="#h51-0-117" id="h51-0-117" class="i">+    root: Projection {
</a><a href="#h51-0-118" id="h51-0-118" class="i">+        source: Filter {
</a><a href="#h51-0-119" id="h51-0-119" class="i">+            source: NestedLoopJoin {
</a><a href="#h51-0-120" id="h51-0-120" class="i">+                outer: Scan {
</a><a href="#h51-0-121" id="h51-0-121" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h51-0-122" id="h51-0-122" class="i">+                },
</a><a href="#h51-0-123" id="h51-0-123" class="i">+                inner: Scan {
</a><a href="#h51-0-124" id="h51-0-124" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h51-0-125" id="h51-0-125" class="i">+                },
</a><a href="#h51-0-126" id="h51-0-126" class="i">+            },
</a><a href="#h51-0-127" id="h51-0-127" class="i">+            predicate: Or(
</a><a href="#h51-0-128" id="h51-0-128" class="i">+                GreaterThan(
</a><a href="#h51-0-129" id="h51-0-129" class="i">+                    Field(
</a><a href="#h51-0-130" id="h51-0-130" class="i">+                        None,
</a><a href="#h51-0-131" id="h51-0-131" class="i">+                        &quot;id&quot;,
</a><a href="#h51-0-132" id="h51-0-132" class="i">+                    ),
</a><a href="#h51-0-133" id="h51-0-133" class="i">+                    Constant(
</a><a href="#h51-0-134" id="h51-0-134" class="i">+                        Integer(
</a><a href="#h51-0-135" id="h51-0-135" class="i">+                            3,
</a><a href="#h51-0-136" id="h51-0-136" class="i">+                        ),
</a><a href="#h51-0-137" id="h51-0-137" class="i">+                    ),
</a><a href="#h51-0-138" id="h51-0-138" class="i">+                ),
</a><a href="#h51-0-139" id="h51-0-139" class="i">+                Equal(
</a><a href="#h51-0-140" id="h51-0-140" class="i">+                    Field(
</a><a href="#h51-0-141" id="h51-0-141" class="i">+                        None,
</a><a href="#h51-0-142" id="h51-0-142" class="i">+                        &quot;id&quot;,
</a><a href="#h51-0-143" id="h51-0-143" class="i">+                    ),
</a><a href="#h51-0-144" id="h51-0-144" class="i">+                    Constant(
</a><a href="#h51-0-145" id="h51-0-145" class="i">+                        Integer(
</a><a href="#h51-0-146" id="h51-0-146" class="i">+                            3,
</a><a href="#h51-0-147" id="h51-0-147" class="i">+                        ),
</a><a href="#h51-0-148" id="h51-0-148" class="i">+                    ),
</a><a href="#h51-0-149" id="h51-0-149" class="i">+                ),
</a><a href="#h51-0-150" id="h51-0-150" class="i">+            ),
</a><a href="#h51-0-151" id="h51-0-151" class="i">+        },
</a><a href="#h51-0-152" id="h51-0-152" class="i">+        labels: [
</a><a href="#h51-0-153" id="h51-0-153" class="i">+            None,
</a><a href="#h51-0-154" id="h51-0-154" class="i">+            None,
</a><a href="#h51-0-155" id="h51-0-155" class="i">+        ],
</a><a href="#h51-0-156" id="h51-0-156" class="i">+        expressions: [
</a><a href="#h51-0-157" id="h51-0-157" class="i">+            Field(
</a><a href="#h51-0-158" id="h51-0-158" class="i">+                Some(
</a><a href="#h51-0-159" id="h51-0-159" class="i">+                    &quot;movies&quot;,
</a><a href="#h51-0-160" id="h51-0-160" class="i">+                ),
</a><a href="#h51-0-161" id="h51-0-161" class="i">+                &quot;id&quot;,
</a><a href="#h51-0-162" id="h51-0-162" class="i">+            ),
</a><a href="#h51-0-163" id="h51-0-163" class="i">+            Field(
</a><a href="#h51-0-164" id="h51-0-164" class="i">+                Some(
</a><a href="#h51-0-165" id="h51-0-165" class="i">+                    &quot;genres&quot;,
</a><a href="#h51-0-166" id="h51-0-166" class="i">+                ),
</a><a href="#h51-0-167" id="h51-0-167" class="i">+                &quot;id&quot;,
</a><a href="#h51-0-168" id="h51-0-168" class="i">+            ),
</a><a href="#h51-0-169" id="h51-0-169" class="i">+        ],
</a><a href="#h51-0-170" id="h51-0-170" class="i">+    },
</a><a href="#h51-0-171" id="h51-0-171" class="i">+}
</a><a href="#h51-0-172" id="h51-0-172" class="i">+
</a><a href="#h51-0-173" id="h51-0-173" class="i">+Query: SELECT movies.id, genres.id FROM movies, genres WHERE id &gt;= 3
</a><a href="#h51-0-174" id="h51-0-174" class="i">+
</a><a href="#h51-0-175" id="h51-0-175" class="i">+Result: Value(&quot;Field reference id is ambiguous&quot;)
</a><a href="#h51-0-176" id="h51-0-176" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h52" href="../file/src/sql/tests/query/where_field_qualified.html">src/sql/tests/query/where_field_qualified</a> b/<a href="../file/src/sql/tests/query/where_field_qualified.html">src/sql/tests/query/where_field_qualified</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -0,0 +1,238 @@
</a><a href="#h52-0-0" id="h52-0-0" class="i">+Query: SELECT movies.id, genres.id FROM movies, genres WHERE movies.id &gt;= 3 AND genres.id = 1
</a><a href="#h52-0-1" id="h52-0-1" class="i">+
</a><a href="#h52-0-2" id="h52-0-2" class="i">+AST: Select {
</a><a href="#h52-0-3" id="h52-0-3" class="i">+    select: SelectClause {
</a><a href="#h52-0-4" id="h52-0-4" class="i">+        expressions: [
</a><a href="#h52-0-5" id="h52-0-5" class="i">+            Field(
</a><a href="#h52-0-6" id="h52-0-6" class="i">+                Some(
</a><a href="#h52-0-7" id="h52-0-7" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-0-8" id="h52-0-8" class="i">+                ),
</a><a href="#h52-0-9" id="h52-0-9" class="i">+                &quot;id&quot;,
</a><a href="#h52-0-10" id="h52-0-10" class="i">+            ),
</a><a href="#h52-0-11" id="h52-0-11" class="i">+            Field(
</a><a href="#h52-0-12" id="h52-0-12" class="i">+                Some(
</a><a href="#h52-0-13" id="h52-0-13" class="i">+                    &quot;genres&quot;,
</a><a href="#h52-0-14" id="h52-0-14" class="i">+                ),
</a><a href="#h52-0-15" id="h52-0-15" class="i">+                &quot;id&quot;,
</a><a href="#h52-0-16" id="h52-0-16" class="i">+            ),
</a><a href="#h52-0-17" id="h52-0-17" class="i">+        ],
</a><a href="#h52-0-18" id="h52-0-18" class="i">+        labels: [
</a><a href="#h52-0-19" id="h52-0-19" class="i">+            None,
</a><a href="#h52-0-20" id="h52-0-20" class="i">+            None,
</a><a href="#h52-0-21" id="h52-0-21" class="i">+        ],
</a><a href="#h52-0-22" id="h52-0-22" class="i">+    },
</a><a href="#h52-0-23" id="h52-0-23" class="i">+    from: Some(
</a><a href="#h52-0-24" id="h52-0-24" class="i">+        FromClause {
</a><a href="#h52-0-25" id="h52-0-25" class="i">+            items: [
</a><a href="#h52-0-26" id="h52-0-26" class="i">+                FromItem {
</a><a href="#h52-0-27" id="h52-0-27" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h52-0-28" id="h52-0-28" class="i">+                    join: None,
</a><a href="#h52-0-29" id="h52-0-29" class="i">+                },
</a><a href="#h52-0-30" id="h52-0-30" class="i">+                FromItem {
</a><a href="#h52-0-31" id="h52-0-31" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h52-0-32" id="h52-0-32" class="i">+                    join: None,
</a><a href="#h52-0-33" id="h52-0-33" class="i">+                },
</a><a href="#h52-0-34" id="h52-0-34" class="i">+            ],
</a><a href="#h52-0-35" id="h52-0-35" class="i">+        },
</a><a href="#h52-0-36" id="h52-0-36" class="i">+    ),
</a><a href="#h52-0-37" id="h52-0-37" class="i">+    where: Some(
</a><a href="#h52-0-38" id="h52-0-38" class="i">+        WhereClause(
</a><a href="#h52-0-39" id="h52-0-39" class="i">+            Operation(
</a><a href="#h52-0-40" id="h52-0-40" class="i">+                And(
</a><a href="#h52-0-41" id="h52-0-41" class="i">+                    Operation(
</a><a href="#h52-0-42" id="h52-0-42" class="i">+                        GreaterThanOrEqual(
</a><a href="#h52-0-43" id="h52-0-43" class="i">+                            Field(
</a><a href="#h52-0-44" id="h52-0-44" class="i">+                                Some(
</a><a href="#h52-0-45" id="h52-0-45" class="i">+                                    &quot;movies&quot;,
</a><a href="#h52-0-46" id="h52-0-46" class="i">+                                ),
</a><a href="#h52-0-47" id="h52-0-47" class="i">+                                &quot;id&quot;,
</a><a href="#h52-0-48" id="h52-0-48" class="i">+                            ),
</a><a href="#h52-0-49" id="h52-0-49" class="i">+                            Literal(
</a><a href="#h52-0-50" id="h52-0-50" class="i">+                                Integer(
</a><a href="#h52-0-51" id="h52-0-51" class="i">+                                    3,
</a><a href="#h52-0-52" id="h52-0-52" class="i">+                                ),
</a><a href="#h52-0-53" id="h52-0-53" class="i">+                            ),
</a><a href="#h52-0-54" id="h52-0-54" class="i">+                        ),
</a><a href="#h52-0-55" id="h52-0-55" class="i">+                    ),
</a><a href="#h52-0-56" id="h52-0-56" class="i">+                    Operation(
</a><a href="#h52-0-57" id="h52-0-57" class="i">+                        Equal(
</a><a href="#h52-0-58" id="h52-0-58" class="i">+                            Field(
</a><a href="#h52-0-59" id="h52-0-59" class="i">+                                Some(
</a><a href="#h52-0-60" id="h52-0-60" class="i">+                                    &quot;genres&quot;,
</a><a href="#h52-0-61" id="h52-0-61" class="i">+                                ),
</a><a href="#h52-0-62" id="h52-0-62" class="i">+                                &quot;id&quot;,
</a><a href="#h52-0-63" id="h52-0-63" class="i">+                            ),
</a><a href="#h52-0-64" id="h52-0-64" class="i">+                            Literal(
</a><a href="#h52-0-65" id="h52-0-65" class="i">+                                Integer(
</a><a href="#h52-0-66" id="h52-0-66" class="i">+                                    1,
</a><a href="#h52-0-67" id="h52-0-67" class="i">+                                ),
</a><a href="#h52-0-68" id="h52-0-68" class="i">+                            ),
</a><a href="#h52-0-69" id="h52-0-69" class="i">+                        ),
</a><a href="#h52-0-70" id="h52-0-70" class="i">+                    ),
</a><a href="#h52-0-71" id="h52-0-71" class="i">+                ),
</a><a href="#h52-0-72" id="h52-0-72" class="i">+            ),
</a><a href="#h52-0-73" id="h52-0-73" class="i">+        ),
</a><a href="#h52-0-74" id="h52-0-74" class="i">+    ),
</a><a href="#h52-0-75" id="h52-0-75" class="i">+    order: [],
</a><a href="#h52-0-76" id="h52-0-76" class="i">+    limit: None,
</a><a href="#h52-0-77" id="h52-0-77" class="i">+    offset: None,
</a><a href="#h52-0-78" id="h52-0-78" class="i">+}
</a><a href="#h52-0-79" id="h52-0-79" class="i">+
</a><a href="#h52-0-80" id="h52-0-80" class="i">+Plan: Plan {
</a><a href="#h52-0-81" id="h52-0-81" class="i">+    root: Projection {
</a><a href="#h52-0-82" id="h52-0-82" class="i">+        source: Filter {
</a><a href="#h52-0-83" id="h52-0-83" class="i">+            source: NestedLoopJoin {
</a><a href="#h52-0-84" id="h52-0-84" class="i">+                outer: Scan {
</a><a href="#h52-0-85" id="h52-0-85" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h52-0-86" id="h52-0-86" class="i">+                },
</a><a href="#h52-0-87" id="h52-0-87" class="i">+                inner: Scan {
</a><a href="#h52-0-88" id="h52-0-88" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h52-0-89" id="h52-0-89" class="i">+                },
</a><a href="#h52-0-90" id="h52-0-90" class="i">+            },
</a><a href="#h52-0-91" id="h52-0-91" class="i">+            predicate: And(
</a><a href="#h52-0-92" id="h52-0-92" class="i">+                Or(
</a><a href="#h52-0-93" id="h52-0-93" class="i">+                    GreaterThan(
</a><a href="#h52-0-94" id="h52-0-94" class="i">+                        Field(
</a><a href="#h52-0-95" id="h52-0-95" class="i">+                            Some(
</a><a href="#h52-0-96" id="h52-0-96" class="i">+                                &quot;movies&quot;,
</a><a href="#h52-0-97" id="h52-0-97" class="i">+                            ),
</a><a href="#h52-0-98" id="h52-0-98" class="i">+                            &quot;id&quot;,
</a><a href="#h52-0-99" id="h52-0-99" class="i">+                        ),
</a><a href="#h52-0-100" id="h52-0-100" class="i">+                        Constant(
</a><a href="#h52-0-101" id="h52-0-101" class="i">+                            Integer(
</a><a href="#h52-0-102" id="h52-0-102" class="i">+                                3,
</a><a href="#h52-0-103" id="h52-0-103" class="i">+                            ),
</a><a href="#h52-0-104" id="h52-0-104" class="i">+                        ),
</a><a href="#h52-0-105" id="h52-0-105" class="i">+                    ),
</a><a href="#h52-0-106" id="h52-0-106" class="i">+                    Equal(
</a><a href="#h52-0-107" id="h52-0-107" class="i">+                        Field(
</a><a href="#h52-0-108" id="h52-0-108" class="i">+                            Some(
</a><a href="#h52-0-109" id="h52-0-109" class="i">+                                &quot;movies&quot;,
</a><a href="#h52-0-110" id="h52-0-110" class="i">+                            ),
</a><a href="#h52-0-111" id="h52-0-111" class="i">+                            &quot;id&quot;,
</a><a href="#h52-0-112" id="h52-0-112" class="i">+                        ),
</a><a href="#h52-0-113" id="h52-0-113" class="i">+                        Constant(
</a><a href="#h52-0-114" id="h52-0-114" class="i">+                            Integer(
</a><a href="#h52-0-115" id="h52-0-115" class="i">+                                3,
</a><a href="#h52-0-116" id="h52-0-116" class="i">+                            ),
</a><a href="#h52-0-117" id="h52-0-117" class="i">+                        ),
</a><a href="#h52-0-118" id="h52-0-118" class="i">+                    ),
</a><a href="#h52-0-119" id="h52-0-119" class="i">+                ),
</a><a href="#h52-0-120" id="h52-0-120" class="i">+                Equal(
</a><a href="#h52-0-121" id="h52-0-121" class="i">+                    Field(
</a><a href="#h52-0-122" id="h52-0-122" class="i">+                        Some(
</a><a href="#h52-0-123" id="h52-0-123" class="i">+                            &quot;genres&quot;,
</a><a href="#h52-0-124" id="h52-0-124" class="i">+                        ),
</a><a href="#h52-0-125" id="h52-0-125" class="i">+                        &quot;id&quot;,
</a><a href="#h52-0-126" id="h52-0-126" class="i">+                    ),
</a><a href="#h52-0-127" id="h52-0-127" class="i">+                    Constant(
</a><a href="#h52-0-128" id="h52-0-128" class="i">+                        Integer(
</a><a href="#h52-0-129" id="h52-0-129" class="i">+                            1,
</a><a href="#h52-0-130" id="h52-0-130" class="i">+                        ),
</a><a href="#h52-0-131" id="h52-0-131" class="i">+                    ),
</a><a href="#h52-0-132" id="h52-0-132" class="i">+                ),
</a><a href="#h52-0-133" id="h52-0-133" class="i">+            ),
</a><a href="#h52-0-134" id="h52-0-134" class="i">+        },
</a><a href="#h52-0-135" id="h52-0-135" class="i">+        labels: [
</a><a href="#h52-0-136" id="h52-0-136" class="i">+            None,
</a><a href="#h52-0-137" id="h52-0-137" class="i">+            None,
</a><a href="#h52-0-138" id="h52-0-138" class="i">+        ],
</a><a href="#h52-0-139" id="h52-0-139" class="i">+        expressions: [
</a><a href="#h52-0-140" id="h52-0-140" class="i">+            Field(
</a><a href="#h52-0-141" id="h52-0-141" class="i">+                Some(
</a><a href="#h52-0-142" id="h52-0-142" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-0-143" id="h52-0-143" class="i">+                ),
</a><a href="#h52-0-144" id="h52-0-144" class="i">+                &quot;id&quot;,
</a><a href="#h52-0-145" id="h52-0-145" class="i">+            ),
</a><a href="#h52-0-146" id="h52-0-146" class="i">+            Field(
</a><a href="#h52-0-147" id="h52-0-147" class="i">+                Some(
</a><a href="#h52-0-148" id="h52-0-148" class="i">+                    &quot;genres&quot;,
</a><a href="#h52-0-149" id="h52-0-149" class="i">+                ),
</a><a href="#h52-0-150" id="h52-0-150" class="i">+                &quot;id&quot;,
</a><a href="#h52-0-151" id="h52-0-151" class="i">+            ),
</a><a href="#h52-0-152" id="h52-0-152" class="i">+        ],
</a><a href="#h52-0-153" id="h52-0-153" class="i">+    },
</a><a href="#h52-0-154" id="h52-0-154" class="i">+}
</a><a href="#h52-0-155" id="h52-0-155" class="i">+
</a><a href="#h52-0-156" id="h52-0-156" class="i">+Optimized plan: Plan {
</a><a href="#h52-0-157" id="h52-0-157" class="i">+    root: Projection {
</a><a href="#h52-0-158" id="h52-0-158" class="i">+        source: Filter {
</a><a href="#h52-0-159" id="h52-0-159" class="i">+            source: NestedLoopJoin {
</a><a href="#h52-0-160" id="h52-0-160" class="i">+                outer: Scan {
</a><a href="#h52-0-161" id="h52-0-161" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h52-0-162" id="h52-0-162" class="i">+                },
</a><a href="#h52-0-163" id="h52-0-163" class="i">+                inner: Scan {
</a><a href="#h52-0-164" id="h52-0-164" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h52-0-165" id="h52-0-165" class="i">+                },
</a><a href="#h52-0-166" id="h52-0-166" class="i">+            },
</a><a href="#h52-0-167" id="h52-0-167" class="i">+            predicate: And(
</a><a href="#h52-0-168" id="h52-0-168" class="i">+                Or(
</a><a href="#h52-0-169" id="h52-0-169" class="i">+                    GreaterThan(
</a><a href="#h52-0-170" id="h52-0-170" class="i">+                        Field(
</a><a href="#h52-0-171" id="h52-0-171" class="i">+                            Some(
</a><a href="#h52-0-172" id="h52-0-172" class="i">+                                &quot;movies&quot;,
</a><a href="#h52-0-173" id="h52-0-173" class="i">+                            ),
</a><a href="#h52-0-174" id="h52-0-174" class="i">+                            &quot;id&quot;,
</a><a href="#h52-0-175" id="h52-0-175" class="i">+                        ),
</a><a href="#h52-0-176" id="h52-0-176" class="i">+                        Constant(
</a><a href="#h52-0-177" id="h52-0-177" class="i">+                            Integer(
</a><a href="#h52-0-178" id="h52-0-178" class="i">+                                3,
</a><a href="#h52-0-179" id="h52-0-179" class="i">+                            ),
</a><a href="#h52-0-180" id="h52-0-180" class="i">+                        ),
</a><a href="#h52-0-181" id="h52-0-181" class="i">+                    ),
</a><a href="#h52-0-182" id="h52-0-182" class="i">+                    Equal(
</a><a href="#h52-0-183" id="h52-0-183" class="i">+                        Field(
</a><a href="#h52-0-184" id="h52-0-184" class="i">+                            Some(
</a><a href="#h52-0-185" id="h52-0-185" class="i">+                                &quot;movies&quot;,
</a><a href="#h52-0-186" id="h52-0-186" class="i">+                            ),
</a><a href="#h52-0-187" id="h52-0-187" class="i">+                            &quot;id&quot;,
</a><a href="#h52-0-188" id="h52-0-188" class="i">+                        ),
</a><a href="#h52-0-189" id="h52-0-189" class="i">+                        Constant(
</a><a href="#h52-0-190" id="h52-0-190" class="i">+                            Integer(
</a><a href="#h52-0-191" id="h52-0-191" class="i">+                                3,
</a><a href="#h52-0-192" id="h52-0-192" class="i">+                            ),
</a><a href="#h52-0-193" id="h52-0-193" class="i">+                        ),
</a><a href="#h52-0-194" id="h52-0-194" class="i">+                    ),
</a><a href="#h52-0-195" id="h52-0-195" class="i">+                ),
</a><a href="#h52-0-196" id="h52-0-196" class="i">+                Equal(
</a><a href="#h52-0-197" id="h52-0-197" class="i">+                    Field(
</a><a href="#h52-0-198" id="h52-0-198" class="i">+                        Some(
</a><a href="#h52-0-199" id="h52-0-199" class="i">+                            &quot;genres&quot;,
</a><a href="#h52-0-200" id="h52-0-200" class="i">+                        ),
</a><a href="#h52-0-201" id="h52-0-201" class="i">+                        &quot;id&quot;,
</a><a href="#h52-0-202" id="h52-0-202" class="i">+                    ),
</a><a href="#h52-0-203" id="h52-0-203" class="i">+                    Constant(
</a><a href="#h52-0-204" id="h52-0-204" class="i">+                        Integer(
</a><a href="#h52-0-205" id="h52-0-205" class="i">+                            1,
</a><a href="#h52-0-206" id="h52-0-206" class="i">+                        ),
</a><a href="#h52-0-207" id="h52-0-207" class="i">+                    ),
</a><a href="#h52-0-208" id="h52-0-208" class="i">+                ),
</a><a href="#h52-0-209" id="h52-0-209" class="i">+            ),
</a><a href="#h52-0-210" id="h52-0-210" class="i">+        },
</a><a href="#h52-0-211" id="h52-0-211" class="i">+        labels: [
</a><a href="#h52-0-212" id="h52-0-212" class="i">+            None,
</a><a href="#h52-0-213" id="h52-0-213" class="i">+            None,
</a><a href="#h52-0-214" id="h52-0-214" class="i">+        ],
</a><a href="#h52-0-215" id="h52-0-215" class="i">+        expressions: [
</a><a href="#h52-0-216" id="h52-0-216" class="i">+            Field(
</a><a href="#h52-0-217" id="h52-0-217" class="i">+                Some(
</a><a href="#h52-0-218" id="h52-0-218" class="i">+                    &quot;movies&quot;,
</a><a href="#h52-0-219" id="h52-0-219" class="i">+                ),
</a><a href="#h52-0-220" id="h52-0-220" class="i">+                &quot;id&quot;,
</a><a href="#h52-0-221" id="h52-0-221" class="i">+            ),
</a><a href="#h52-0-222" id="h52-0-222" class="i">+            Field(
</a><a href="#h52-0-223" id="h52-0-223" class="i">+                Some(
</a><a href="#h52-0-224" id="h52-0-224" class="i">+                    &quot;genres&quot;,
</a><a href="#h52-0-225" id="h52-0-225" class="i">+                ),
</a><a href="#h52-0-226" id="h52-0-226" class="i">+                &quot;id&quot;,
</a><a href="#h52-0-227" id="h52-0-227" class="i">+            ),
</a><a href="#h52-0-228" id="h52-0-228" class="i">+        ],
</a><a href="#h52-0-229" id="h52-0-229" class="i">+    },
</a><a href="#h52-0-230" id="h52-0-230" class="i">+}
</a><a href="#h52-0-231" id="h52-0-231" class="i">+
</a><a href="#h52-0-232" id="h52-0-232" class="i">+Query: SELECT movies.id, genres.id FROM movies, genres WHERE movies.id &gt;= 3 AND genres.id = 1
</a><a href="#h52-0-233" id="h52-0-233" class="i">+
</a><a href="#h52-0-234" id="h52-0-234" class="i">+Result: [&quot;id&quot;, &quot;id&quot;]
</a><a href="#h52-0-235" id="h52-0-235" class="i">+[Integer(3), Integer(1)]
</a><a href="#h52-0-236" id="h52-0-236" class="i">+[Integer(4), Integer(1)]
</a><a href="#h52-0-237" id="h52-0-237" class="i">+[Integer(5), Integer(1)]
</a><b>diff --git a/<a id="h53" href="../file/src/sql/tests/query/where_field_unknown.html">src/sql/tests/query/where_field_unknown</a> b/<a href="../file/src/sql/tests/query/where_field_unknown.html">src/sql/tests/query/where_field_unknown</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -0,0 +1,57 @@
</a><a href="#h53-0-0" id="h53-0-0" class="i">+Query: SELECT * FROM movies WHERE unknown
</a><a href="#h53-0-1" id="h53-0-1" class="i">+
</a><a href="#h53-0-2" id="h53-0-2" class="i">+AST: Select {
</a><a href="#h53-0-3" id="h53-0-3" class="i">+    select: SelectClause {
</a><a href="#h53-0-4" id="h53-0-4" class="i">+        expressions: [],
</a><a href="#h53-0-5" id="h53-0-5" class="i">+        labels: [],
</a><a href="#h53-0-6" id="h53-0-6" class="i">+    },
</a><a href="#h53-0-7" id="h53-0-7" class="i">+    from: Some(
</a><a href="#h53-0-8" id="h53-0-8" class="i">+        FromClause {
</a><a href="#h53-0-9" id="h53-0-9" class="i">+            items: [
</a><a href="#h53-0-10" id="h53-0-10" class="i">+                FromItem {
</a><a href="#h53-0-11" id="h53-0-11" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h53-0-12" id="h53-0-12" class="i">+                    join: None,
</a><a href="#h53-0-13" id="h53-0-13" class="i">+                },
</a><a href="#h53-0-14" id="h53-0-14" class="i">+            ],
</a><a href="#h53-0-15" id="h53-0-15" class="i">+        },
</a><a href="#h53-0-16" id="h53-0-16" class="i">+    ),
</a><a href="#h53-0-17" id="h53-0-17" class="i">+    where: Some(
</a><a href="#h53-0-18" id="h53-0-18" class="i">+        WhereClause(
</a><a href="#h53-0-19" id="h53-0-19" class="i">+            Field(
</a><a href="#h53-0-20" id="h53-0-20" class="i">+                None,
</a><a href="#h53-0-21" id="h53-0-21" class="i">+                &quot;unknown&quot;,
</a><a href="#h53-0-22" id="h53-0-22" class="i">+            ),
</a><a href="#h53-0-23" id="h53-0-23" class="i">+        ),
</a><a href="#h53-0-24" id="h53-0-24" class="i">+    ),
</a><a href="#h53-0-25" id="h53-0-25" class="i">+    order: [],
</a><a href="#h53-0-26" id="h53-0-26" class="i">+    limit: None,
</a><a href="#h53-0-27" id="h53-0-27" class="i">+    offset: None,
</a><a href="#h53-0-28" id="h53-0-28" class="i">+}
</a><a href="#h53-0-29" id="h53-0-29" class="i">+
</a><a href="#h53-0-30" id="h53-0-30" class="i">+Plan: Plan {
</a><a href="#h53-0-31" id="h53-0-31" class="i">+    root: Filter {
</a><a href="#h53-0-32" id="h53-0-32" class="i">+        source: Scan {
</a><a href="#h53-0-33" id="h53-0-33" class="i">+            table: &quot;movies&quot;,
</a><a href="#h53-0-34" id="h53-0-34" class="i">+        },
</a><a href="#h53-0-35" id="h53-0-35" class="i">+        predicate: Field(
</a><a href="#h53-0-36" id="h53-0-36" class="i">+            None,
</a><a href="#h53-0-37" id="h53-0-37" class="i">+            &quot;unknown&quot;,
</a><a href="#h53-0-38" id="h53-0-38" class="i">+        ),
</a><a href="#h53-0-39" id="h53-0-39" class="i">+    },
</a><a href="#h53-0-40" id="h53-0-40" class="i">+}
</a><a href="#h53-0-41" id="h53-0-41" class="i">+
</a><a href="#h53-0-42" id="h53-0-42" class="i">+Optimized plan: Plan {
</a><a href="#h53-0-43" id="h53-0-43" class="i">+    root: Filter {
</a><a href="#h53-0-44" id="h53-0-44" class="i">+        source: Scan {
</a><a href="#h53-0-45" id="h53-0-45" class="i">+            table: &quot;movies&quot;,
</a><a href="#h53-0-46" id="h53-0-46" class="i">+        },
</a><a href="#h53-0-47" id="h53-0-47" class="i">+        predicate: Field(
</a><a href="#h53-0-48" id="h53-0-48" class="i">+            None,
</a><a href="#h53-0-49" id="h53-0-49" class="i">+            &quot;unknown&quot;,
</a><a href="#h53-0-50" id="h53-0-50" class="i">+        ),
</a><a href="#h53-0-51" id="h53-0-51" class="i">+    },
</a><a href="#h53-0-52" id="h53-0-52" class="i">+}
</a><a href="#h53-0-53" id="h53-0-53" class="i">+
</a><a href="#h53-0-54" id="h53-0-54" class="i">+Query: SELECT * FROM movies WHERE unknown
</a><a href="#h53-0-55" id="h53-0-55" class="i">+
</a><a href="#h53-0-56" id="h53-0-56" class="i">+Result: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h53-0-57" id="h53-0-57" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h54" href="../file/src/sql/tests/query/where_join_inner.html">src/sql/tests/query/where_join_inner</a> b/<a href="../file/src/sql/tests/query/where_join_inner.html">src/sql/tests/query/where_join_inner</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -0,0 +1,108 @@
</a><a href="#h54-0-0" id="h54-0-0" class="i">+Query: SELECT * FROM movies, genres WHERE movies.genre_id = genres.id
</a><a href="#h54-0-1" id="h54-0-1" class="i">+
</a><a href="#h54-0-2" id="h54-0-2" class="i">+AST: Select {
</a><a href="#h54-0-3" id="h54-0-3" class="i">+    select: SelectClause {
</a><a href="#h54-0-4" id="h54-0-4" class="i">+        expressions: [],
</a><a href="#h54-0-5" id="h54-0-5" class="i">+        labels: [],
</a><a href="#h54-0-6" id="h54-0-6" class="i">+    },
</a><a href="#h54-0-7" id="h54-0-7" class="i">+    from: Some(
</a><a href="#h54-0-8" id="h54-0-8" class="i">+        FromClause {
</a><a href="#h54-0-9" id="h54-0-9" class="i">+            items: [
</a><a href="#h54-0-10" id="h54-0-10" class="i">+                FromItem {
</a><a href="#h54-0-11" id="h54-0-11" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h54-0-12" id="h54-0-12" class="i">+                    join: None,
</a><a href="#h54-0-13" id="h54-0-13" class="i">+                },
</a><a href="#h54-0-14" id="h54-0-14" class="i">+                FromItem {
</a><a href="#h54-0-15" id="h54-0-15" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h54-0-16" id="h54-0-16" class="i">+                    join: None,
</a><a href="#h54-0-17" id="h54-0-17" class="i">+                },
</a><a href="#h54-0-18" id="h54-0-18" class="i">+            ],
</a><a href="#h54-0-19" id="h54-0-19" class="i">+        },
</a><a href="#h54-0-20" id="h54-0-20" class="i">+    ),
</a><a href="#h54-0-21" id="h54-0-21" class="i">+    where: Some(
</a><a href="#h54-0-22" id="h54-0-22" class="i">+        WhereClause(
</a><a href="#h54-0-23" id="h54-0-23" class="i">+            Operation(
</a><a href="#h54-0-24" id="h54-0-24" class="i">+                Equal(
</a><a href="#h54-0-25" id="h54-0-25" class="i">+                    Field(
</a><a href="#h54-0-26" id="h54-0-26" class="i">+                        Some(
</a><a href="#h54-0-27" id="h54-0-27" class="i">+                            &quot;movies&quot;,
</a><a href="#h54-0-28" id="h54-0-28" class="i">+                        ),
</a><a href="#h54-0-29" id="h54-0-29" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h54-0-30" id="h54-0-30" class="i">+                    ),
</a><a href="#h54-0-31" id="h54-0-31" class="i">+                    Field(
</a><a href="#h54-0-32" id="h54-0-32" class="i">+                        Some(
</a><a href="#h54-0-33" id="h54-0-33" class="i">+                            &quot;genres&quot;,
</a><a href="#h54-0-34" id="h54-0-34" class="i">+                        ),
</a><a href="#h54-0-35" id="h54-0-35" class="i">+                        &quot;id&quot;,
</a><a href="#h54-0-36" id="h54-0-36" class="i">+                    ),
</a><a href="#h54-0-37" id="h54-0-37" class="i">+                ),
</a><a href="#h54-0-38" id="h54-0-38" class="i">+            ),
</a><a href="#h54-0-39" id="h54-0-39" class="i">+        ),
</a><a href="#h54-0-40" id="h54-0-40" class="i">+    ),
</a><a href="#h54-0-41" id="h54-0-41" class="i">+    order: [],
</a><a href="#h54-0-42" id="h54-0-42" class="i">+    limit: None,
</a><a href="#h54-0-43" id="h54-0-43" class="i">+    offset: None,
</a><a href="#h54-0-44" id="h54-0-44" class="i">+}
</a><a href="#h54-0-45" id="h54-0-45" class="i">+
</a><a href="#h54-0-46" id="h54-0-46" class="i">+Plan: Plan {
</a><a href="#h54-0-47" id="h54-0-47" class="i">+    root: Filter {
</a><a href="#h54-0-48" id="h54-0-48" class="i">+        source: NestedLoopJoin {
</a><a href="#h54-0-49" id="h54-0-49" class="i">+            outer: Scan {
</a><a href="#h54-0-50" id="h54-0-50" class="i">+                table: &quot;movies&quot;,
</a><a href="#h54-0-51" id="h54-0-51" class="i">+            },
</a><a href="#h54-0-52" id="h54-0-52" class="i">+            inner: Scan {
</a><a href="#h54-0-53" id="h54-0-53" class="i">+                table: &quot;genres&quot;,
</a><a href="#h54-0-54" id="h54-0-54" class="i">+            },
</a><a href="#h54-0-55" id="h54-0-55" class="i">+        },
</a><a href="#h54-0-56" id="h54-0-56" class="i">+        predicate: Equal(
</a><a href="#h54-0-57" id="h54-0-57" class="i">+            Field(
</a><a href="#h54-0-58" id="h54-0-58" class="i">+                Some(
</a><a href="#h54-0-59" id="h54-0-59" class="i">+                    &quot;movies&quot;,
</a><a href="#h54-0-60" id="h54-0-60" class="i">+                ),
</a><a href="#h54-0-61" id="h54-0-61" class="i">+                &quot;genre_id&quot;,
</a><a href="#h54-0-62" id="h54-0-62" class="i">+            ),
</a><a href="#h54-0-63" id="h54-0-63" class="i">+            Field(
</a><a href="#h54-0-64" id="h54-0-64" class="i">+                Some(
</a><a href="#h54-0-65" id="h54-0-65" class="i">+                    &quot;genres&quot;,
</a><a href="#h54-0-66" id="h54-0-66" class="i">+                ),
</a><a href="#h54-0-67" id="h54-0-67" class="i">+                &quot;id&quot;,
</a><a href="#h54-0-68" id="h54-0-68" class="i">+            ),
</a><a href="#h54-0-69" id="h54-0-69" class="i">+        ),
</a><a href="#h54-0-70" id="h54-0-70" class="i">+    },
</a><a href="#h54-0-71" id="h54-0-71" class="i">+}
</a><a href="#h54-0-72" id="h54-0-72" class="i">+
</a><a href="#h54-0-73" id="h54-0-73" class="i">+Optimized plan: Plan {
</a><a href="#h54-0-74" id="h54-0-74" class="i">+    root: Filter {
</a><a href="#h54-0-75" id="h54-0-75" class="i">+        source: NestedLoopJoin {
</a><a href="#h54-0-76" id="h54-0-76" class="i">+            outer: Scan {
</a><a href="#h54-0-77" id="h54-0-77" class="i">+                table: &quot;movies&quot;,
</a><a href="#h54-0-78" id="h54-0-78" class="i">+            },
</a><a href="#h54-0-79" id="h54-0-79" class="i">+            inner: Scan {
</a><a href="#h54-0-80" id="h54-0-80" class="i">+                table: &quot;genres&quot;,
</a><a href="#h54-0-81" id="h54-0-81" class="i">+            },
</a><a href="#h54-0-82" id="h54-0-82" class="i">+        },
</a><a href="#h54-0-83" id="h54-0-83" class="i">+        predicate: Equal(
</a><a href="#h54-0-84" id="h54-0-84" class="i">+            Field(
</a><a href="#h54-0-85" id="h54-0-85" class="i">+                Some(
</a><a href="#h54-0-86" id="h54-0-86" class="i">+                    &quot;movies&quot;,
</a><a href="#h54-0-87" id="h54-0-87" class="i">+                ),
</a><a href="#h54-0-88" id="h54-0-88" class="i">+                &quot;genre_id&quot;,
</a><a href="#h54-0-89" id="h54-0-89" class="i">+            ),
</a><a href="#h54-0-90" id="h54-0-90" class="i">+            Field(
</a><a href="#h54-0-91" id="h54-0-91" class="i">+                Some(
</a><a href="#h54-0-92" id="h54-0-92" class="i">+                    &quot;genres&quot;,
</a><a href="#h54-0-93" id="h54-0-93" class="i">+                ),
</a><a href="#h54-0-94" id="h54-0-94" class="i">+                &quot;id&quot;,
</a><a href="#h54-0-95" id="h54-0-95" class="i">+            ),
</a><a href="#h54-0-96" id="h54-0-96" class="i">+        ),
</a><a href="#h54-0-97" id="h54-0-97" class="i">+    },
</a><a href="#h54-0-98" id="h54-0-98" class="i">+}
</a><a href="#h54-0-99" id="h54-0-99" class="i">+
</a><a href="#h54-0-100" id="h54-0-100" class="i">+Query: SELECT * FROM movies, genres WHERE movies.genre_id = genres.id
</a><a href="#h54-0-101" id="h54-0-101" class="i">+
</a><a href="#h54-0-102" id="h54-0-102" class="i">+Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
</a><a href="#h54-0-103" id="h54-0-103" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h54-0-104" id="h54-0-104" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h54-0-105" id="h54-0-105" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h54-0-106" id="h54-0-106" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h54-0-107" id="h54-0-107" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><b>diff --git a/<a id="h55" href="../file/src/sql/tests/query/where_unknown.html">src/sql/tests/query/where_unknown</a> b/<a href="../file/src/sql/tests/query/where_unknown.html">src/sql/tests/query/where_unknown</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -1,54 +0,0 @@
</a><a href="#h55-0-0" id="h55-0-0" class="d">-Query: SELECT * FROM movies WHERE unknown
</a><a href="#h55-0-1" id="h55-0-1" class="d">-
</a><a href="#h55-0-2" id="h55-0-2" class="d">-AST: Select {
</a><a href="#h55-0-3" id="h55-0-3" class="d">-    select: SelectClause {
</a><a href="#h55-0-4" id="h55-0-4" class="d">-        expressions: [],
</a><a href="#h55-0-5" id="h55-0-5" class="d">-        labels: [],
</a><a href="#h55-0-6" id="h55-0-6" class="d">-    },
</a><a href="#h55-0-7" id="h55-0-7" class="d">-    from: Some(
</a><a href="#h55-0-8" id="h55-0-8" class="d">-        FromClause {
</a><a href="#h55-0-9" id="h55-0-9" class="d">-            items: [
</a><a href="#h55-0-10" id="h55-0-10" class="d">-                FromItem {
</a><a href="#h55-0-11" id="h55-0-11" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h55-0-12" id="h55-0-12" class="d">-                    join: None,
</a><a href="#h55-0-13" id="h55-0-13" class="d">-                },
</a><a href="#h55-0-14" id="h55-0-14" class="d">-            ],
</a><a href="#h55-0-15" id="h55-0-15" class="d">-        },
</a><a href="#h55-0-16" id="h55-0-16" class="d">-    ),
</a><a href="#h55-0-17" id="h55-0-17" class="d">-    where: Some(
</a><a href="#h55-0-18" id="h55-0-18" class="d">-        WhereClause(
</a><a href="#h55-0-19" id="h55-0-19" class="d">-            Field(
</a><a href="#h55-0-20" id="h55-0-20" class="d">-                &quot;unknown&quot;,
</a><a href="#h55-0-21" id="h55-0-21" class="d">-            ),
</a><a href="#h55-0-22" id="h55-0-22" class="d">-        ),
</a><a href="#h55-0-23" id="h55-0-23" class="d">-    ),
</a><a href="#h55-0-24" id="h55-0-24" class="d">-    order: [],
</a><a href="#h55-0-25" id="h55-0-25" class="d">-    limit: None,
</a><a href="#h55-0-26" id="h55-0-26" class="d">-    offset: None,
</a><a href="#h55-0-27" id="h55-0-27" class="d">-}
</a><a href="#h55-0-28" id="h55-0-28" class="d">-
</a><a href="#h55-0-29" id="h55-0-29" class="d">-Plan: Plan {
</a><a href="#h55-0-30" id="h55-0-30" class="d">-    root: Filter {
</a><a href="#h55-0-31" id="h55-0-31" class="d">-        source: Scan {
</a><a href="#h55-0-32" id="h55-0-32" class="d">-            table: &quot;movies&quot;,
</a><a href="#h55-0-33" id="h55-0-33" class="d">-        },
</a><a href="#h55-0-34" id="h55-0-34" class="d">-        predicate: Field(
</a><a href="#h55-0-35" id="h55-0-35" class="d">-            &quot;unknown&quot;,
</a><a href="#h55-0-36" id="h55-0-36" class="d">-        ),
</a><a href="#h55-0-37" id="h55-0-37" class="d">-    },
</a><a href="#h55-0-38" id="h55-0-38" class="d">-}
</a><a href="#h55-0-39" id="h55-0-39" class="d">-
</a><a href="#h55-0-40" id="h55-0-40" class="d">-Optimized plan: Plan {
</a><a href="#h55-0-41" id="h55-0-41" class="d">-    root: Filter {
</a><a href="#h55-0-42" id="h55-0-42" class="d">-        source: Scan {
</a><a href="#h55-0-43" id="h55-0-43" class="d">-            table: &quot;movies&quot;,
</a><a href="#h55-0-44" id="h55-0-44" class="d">-        },
</a><a href="#h55-0-45" id="h55-0-45" class="d">-        predicate: Field(
</a><a href="#h55-0-46" id="h55-0-46" class="d">-            &quot;unknown&quot;,
</a><a href="#h55-0-47" id="h55-0-47" class="d">-        ),
</a><a href="#h55-0-48" id="h55-0-48" class="d">-    },
</a><a href="#h55-0-49" id="h55-0-49" class="d">-}
</a><a href="#h55-0-50" id="h55-0-50" class="d">-
</a><a href="#h55-0-51" id="h55-0-51" class="d">-Query: SELECT * FROM movies WHERE unknown
</a><a href="#h55-0-52" id="h55-0-52" class="d">-
</a><a href="#h55-0-53" id="h55-0-53" class="d">-Result: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h55-0-54" id="h55-0-54" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h56" href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a> b/<a href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -9,7 +9,7 @@ use std::collections::HashMap;
</a> pub enum Expression {
     // Values
     Constant(Value),
<a href="#h56-0-3" id="h56-0-3" class="d">-    Field(String),
</a><a href="#h56-0-4" id="h56-0-4" class="i">+    Field(Option&lt;String&gt;, String),
</a> 
     // Logical operations
     And(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
<a href="#h56-1" id="h56-1" class="h">@@ -47,7 +47,7 @@ impl Expression {
</a>         Ok(match self {
             // Constant values
             Self::Constant(c) =&gt; c.clone(),
<a href="#h56-1-3" id="h56-1-3" class="d">-            Self::Field(f) =&gt; e.lookup(f)?,
</a><a href="#h56-1-4" id="h56-1-4" class="i">+            Self::Field(r, f) =&gt; e.lookup(r.as_deref(), f)?,
</a> 
             // Logical operations
             Self::And(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
<a href="#h56-2" id="h56-2" class="h">@@ -263,7 +263,7 @@ impl Expression {
</a>     /// Checks whether the expression is constant
     pub fn is_constant(&amp;self) -&gt; bool {
         self.walk(&amp;|expr| match expr {
<a href="#h56-2-3" id="h56-2-3" class="d">-            Self::Field(_) =&gt; false,
</a><a href="#h56-2-4" id="h56-2-4" class="i">+            Self::Field(_, _) =&gt; false,
</a>             _ =&gt; true,
         })
     }
<a href="#h56-3" id="h56-3" class="h">@@ -281,7 +281,7 @@ impl Expression {
</a>         // to use mutable references over ownership.
         self = match self {
             // Constants
<a href="#h56-3-3" id="h56-3-3" class="d">-            node @ Self::Constant(_) | node @ Self::Field(_) =&gt; node,
</a><a href="#h56-3-4" id="h56-3-4" class="i">+            node @ Self::Constant(_) | node @ Self::Field(_, _) =&gt; node,
</a> 
             // Logical operations
             Self::And(lhs, rhs) =&gt; {
<a href="#h56-4" id="h56-4" class="h">@@ -360,7 +360,7 @@ impl Expression {
</a>             | Self::Negate(expr)
             | Self::Not(expr) =&gt; expr.walk(visitor),
 
<a href="#h56-4-3" id="h56-4-3" class="d">-            Self::Constant(_) | Self::Field(_) =&gt; true,
</a><a href="#h56-4-4" id="h56-4-4" class="i">+            Self::Constant(_) | Self::Field(_, _) =&gt; true,
</a>         } {
             visitor(self)
         } else {
<a href="#h56-5" id="h56-5" class="h">@@ -371,20 +371,18 @@ impl Expression {
</a> 
 /// An expression evaluation environment
 pub trait Environment {
<a href="#h56-5-3" id="h56-5-3" class="d">-    /// Attempts to fetch a field value from the environment
</a><a href="#h56-5-4" id="h56-5-4" class="d">-    fn get(&amp;self, field: &amp;str) -&gt; Option&lt;Value&gt;;
</a><a href="#h56-5-5" id="h56-5-5" class="d">-
</a><a href="#h56-5-6" id="h56-5-6" class="d">-    /// Fetches a field value from the environment, otherwise errors
</a><a href="#h56-5-7" id="h56-5-7" class="d">-    fn lookup(&amp;self, field: &amp;str) -&gt; Result&lt;Value, Error&gt; {
</a><a href="#h56-5-8" id="h56-5-8" class="d">-        match self.get(field) {
</a><a href="#h56-5-9" id="h56-5-9" class="d">-            Some(value) =&gt; Ok(value),
</a><a href="#h56-5-10" id="h56-5-10" class="d">-            None =&gt; Err(Error::Value(format!(&quot;Unknown field {}&quot;, field))),
</a><a href="#h56-5-11" id="h56-5-11" class="d">-        }
</a><a href="#h56-5-12" id="h56-5-12" class="d">-    }
</a><a href="#h56-5-13" id="h56-5-13" class="i">+    /// Fetches a field value from the environment
</a><a href="#h56-5-14" id="h56-5-14" class="i">+    fn lookup(&amp;self, relation: Option&lt;&amp;str&gt;, field: &amp;str) -&gt; Result&lt;Value, Error&gt;;
</a> }
 
 impl Environment for HashMap&lt;String, Value&gt; {
<a href="#h56-5-18" id="h56-5-18" class="d">-    fn get(&amp;self, field: &amp;str) -&gt; Option&lt;Value&gt; {
</a><a href="#h56-5-19" id="h56-5-19" class="d">-        self.get(field).cloned()
</a><a href="#h56-5-20" id="h56-5-20" class="i">+    fn lookup(&amp;self, relation: Option&lt;&amp;str&gt;, field: &amp;str) -&gt; Result&lt;Value, Error&gt; {
</a><a href="#h56-5-21" id="h56-5-21" class="i">+        if relation.is_some() {
</a><a href="#h56-5-22" id="h56-5-22" class="i">+            Err(Error::Value(&quot;Qualified fields not supported for HashMap environments&quot;.into()))
</a><a href="#h56-5-23" id="h56-5-23" class="i">+        } else if let Some(value) = self.get(field) {
</a><a href="#h56-5-24" id="h56-5-24" class="i">+            Ok(value.clone())
</a><a href="#h56-5-25" id="h56-5-25" class="i">+        } else {
</a><a href="#h56-5-26" id="h56-5-26" class="i">+            Err(Error::Value(format!(&quot;Unknown field {}&quot;, field)))
</a><a href="#h56-5-27" id="h56-5-27" class="i">+        }
</a>     }
 }
<b>diff --git a/<a id="h57" href="../file/src/sql/types/schema.rs.html">src/sql/types/schema.rs</a> b/<a href="../file/src/sql/types/schema.rs.html">src/sql/types/schema.rs</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -1,9 +1,8 @@
</a> use super::super::engine::Transaction;
<a href="#h57-0-1" id="h57-0-1" class="d">-use super::super::parser::lexer::Keyword;
</a><a href="#h57-0-2" id="h57-0-2" class="i">+use super::super::parser::format_ident;
</a> use super::{DataType, Row, Value};
 use crate::Error;
 
<a href="#h57-0-6" id="h57-0-6" class="d">-use regex::Regex;
</a> use std::collections::HashMap;
 
 /// A table schema
<a href="#h57-1" id="h57-1" class="h">@@ -360,16 +359,3 @@ impl Column {
</a>         Ok(())
     }
 }
<a href="#h57-1-3" id="h57-1-3" class="d">-
</a><a href="#h57-1-4" id="h57-1-4" class="d">-// Formats an identifier by quoting it as appropriate
</a><a href="#h57-1-5" id="h57-1-5" class="d">-fn format_ident(ident: &amp;str) -&gt; String {
</a><a href="#h57-1-6" id="h57-1-6" class="d">-    lazy_static! {
</a><a href="#h57-1-7" id="h57-1-7" class="d">-        static ref RE_IDENT: Regex = Regex::new(r#&quot;^\w[\w_]*$&quot;#).unwrap();
</a><a href="#h57-1-8" id="h57-1-8" class="d">-    }
</a><a href="#h57-1-9" id="h57-1-9" class="d">-
</a><a href="#h57-1-10" id="h57-1-10" class="d">-    if RE_IDENT.is_match(ident) &amp;&amp; Keyword::from_str(ident).is_none() {
</a><a href="#h57-1-11" id="h57-1-11" class="d">-        ident.to_string()
</a><a href="#h57-1-12" id="h57-1-12" class="d">-    } else {
</a><a href="#h57-1-13" id="h57-1-13" class="d">-        format!(&quot;\&quot;{}\&quot;&quot;, ident.replace(&quot;\&quot;&quot;, &quot;\&quot;\&quot;&quot;))
</a><a href="#h57-1-14" id="h57-1-14" class="d">-    }
</a><a href="#h57-1-15" id="h57-1-15" class="d">-}
</a></pre>
</div>
</body>
</html>
