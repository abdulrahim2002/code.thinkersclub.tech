<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>upgrade Rust to 1.71.1 - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/f5a2bb5b363c48fa1bfb70cfc3524580f3f4b9b3.html">f5a2bb5b363c48fa1bfb70cfc3524580f3f4b9b3</a>
<b>parent</b> <a href="../commit/5b72c04fd6e58c31bbac6e9c7adfd1780398ed34.html">5b72c04fd6e58c31bbac6e9c7adfd1780398ed34</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sat, 12 Aug 2023 23:02:26 +0200

upgrade Rust to 1.71.1

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">.drone.yml</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">Cargo.lock</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">Dockerfile</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/bin/bank.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/bin/toysql.rs</a></td><td> | </td><td class="num">7</td><td><span class="i">++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/raft/log.rs</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/raft/server.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/raft/state.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/engine/kv.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/execution/aggregation.rs</a></td><td> | </td><td class="num">9</td><td><span class="i">++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/parser/lexer.rs</a></td><td> | </td><td class="num">12</td><td><span class="i">+++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/sql/plan/mod.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/sql/plan/optimizer.rs</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">src/sql/types/expression.rs</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">src/sql/types/mod.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/storage/kv/encoding.rs</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">src/storage/kv/memory.rs</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/expression.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/mutation.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/schema.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
</table></pre><pre>23 files changed, 72 insertions(+), 79 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/.drone.yml.html">.drone.yml</a> b/<a href="../file/.drone.yml.html">.drone.yml</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -9,14 +9,14 @@ env: &amp;env
</a> 
 steps:
 - name: build
<a href="#h0-0-3" id="h0-0-3" class="d">-  image: rust:1.53
</a><a href="#h0-0-4" id="h0-0-4" class="i">+  image: rust:1.71
</a>   pull: true
   environment: *env
   commands:
   - cargo build --tests
 
 - name: test
<a href="#h0-0-11" id="h0-0-11" class="d">-  image: rust:1.53
</a><a href="#h0-0-12" id="h0-0-12" class="i">+  image: rust:1.71
</a>   environment: *env
   commands:
   - cargo test
<a href="#h0-1" id="h0-1" class="h">@@ -24,7 +24,7 @@ steps:
</a>   - build
 
 - name: lint
<a href="#h0-1-3" id="h0-1-3" class="d">-  image: rust:1.53
</a><a href="#h0-1-4" id="h0-1-4" class="i">+  image: rust:1.71
</a>   environment: *env
   commands:
   - rustup component add clippy
<b>diff --git a/<a id="h1" href="../file/Cargo.lock.html">Cargo.lock</a> b/<a href="../file/Cargo.lock.html">Cargo.lock</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -499,9 +499,9 @@ dependencies = [
</a> 
 [[package]]
 name = &quot;nom&quot;
<a href="#h1-0-3" id="h1-0-3" class="d">-version = &quot;5.1.2&quot;
</a><a href="#h1-0-4" id="h1-0-4" class="i">+version = &quot;5.1.3&quot;
</a> source = &quot;registry+https://github.com/rust-lang/crates.io-index&quot;
<a href="#h1-0-6" id="h1-0-6" class="d">-checksum = &quot;ffb4262d26ed83a1c0a33a38fe2bb15797329c85770da05e6b828ddb782627af&quot;
</a><a href="#h1-0-7" id="h1-0-7" class="i">+checksum = &quot;08959a387a676302eebf4ddbcbc611da04285579f76f88ee0506c63b1a61dd4b&quot;
</a> dependencies = [
  &quot;lexical-core&quot;,
  &quot;memchr&quot;,
<b>diff --git a/<a id="h2" href="../file/Dockerfile.html">Dockerfile</a> b/<a href="../file/Dockerfile.html">Dockerfile</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -1,5 +1,5 @@
</a> # Initial build
<a href="#h2-0-1" id="h2-0-1" class="d">-FROM rust:1.53-slim AS build
</a><a href="#h2-0-2" id="h2-0-2" class="i">+FROM rust:1.71-slim AS build
</a> 
 ARG TARGET=x86_64-unknown-linux-musl
 RUN apt-get -q update &amp;&amp; apt-get -q install -y musl-dev
<a href="#h2-1" id="h2-1" class="h">@@ -21,7 +21,7 @@ COPY . .
</a> RUN cargo install --bin toydb --locked --offline --path . --target=$TARGET
 
 # Runtime image
<a href="#h2-1-3" id="h2-1-3" class="d">-FROM alpine:3.14
</a><a href="#h2-1-4" id="h2-1-4" class="i">+FROM alpine:3.18
</a> COPY --from=build /usr/local/cargo/bin/toydb /usr/local/bin/toydb
 COPY --from=build /usr/src/toydb/config/toydb.yaml /etc/toydb.yaml
 CMD [&quot;toydb&quot;]
<b>diff --git a/<a id="h3" href="../file/src/bin/bank.rs.html">src/bin/bank.rs</a> b/<a href="../file/src/bin/bank.rs.html">src/bin/bank.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -120,7 +120,7 @@ impl Bank {
</a>         println!();
 
         let mut rng = rand::thread_rng();
<a href="#h3-0-3" id="h3-0-3" class="d">-        let customers = rand::distributions::Uniform::from(1..=self.customers as i64);
</a><a href="#h3-0-4" id="h3-0-4" class="i">+        let customers = rand::distributions::Uniform::from(1..=self.customers);
</a>         let transfers = futures::stream::iter(
             std::iter::from_fn(|| Some((customers.sample(&amp;mut rng), customers.sample(&amp;mut rng))))
                 .filter(|(from, to)| from != to)
<b>diff --git a/<a id="h4" href="../file/src/bin/toysql.rs.html">src/bin/toysql.rs</a> b/<a href="../file/src/bin/toysql.rs.html">src/bin/toysql.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -146,7 +146,8 @@ SQL txns:  {txns_active} active, {txns} total ({sql_storage} storage)
</a>                     committed = status.raft.commit_index,
                     applied = status.raft.apply_index,
                     raft_storage = status.raft.storage,
<a href="#h4-0-3" id="h4-0-3" class="d">-                    raft_size = format!(&quot;{:.3}&quot;, status.raft.storage_size as f64 / 1000.0 / 1000.0),
</a><a href="#h4-0-4" id="h4-0-4" class="i">+                    raft_size =
</a><a href="#h4-0-5" id="h4-0-5" class="i">+                        format_args!(&quot;{:.3}&quot;, status.raft.storage_size as f64 / 1000.0 / 1000.0),
</a>                     logs = node_logs.join(&quot; &quot;),
                     txns = status.mvcc.txns,
                     txns_active = status.mvcc.txns_active,
<a href="#h4-1" id="h4-1" class="h">@@ -186,7 +187,7 @@ SQL txns:  {txns_active} active, {txns} total ({sql_storage} storage)
</a>             ResultSet::Update { count } =&gt; println!(&quot;Updated {} rows&quot;, count),
             ResultSet::CreateTable { name } =&gt; println!(&quot;Created table {}&quot;, name),
             ResultSet::DropTable { name } =&gt; println!(&quot;Dropped table {}&quot;, name),
<a href="#h4-1-3" id="h4-1-3" class="d">-            ResultSet::Explain(plan) =&gt; println!(&quot;{}&quot;, plan.to_string()),
</a><a href="#h4-1-4" id="h4-1-4" class="i">+            ResultSet::Explain(plan) =&gt; println!(&quot;{}&quot;, plan),
</a>             ResultSet::Query { columns, mut rows } =&gt; {
                 if self.show_headers {
                     println!(
<a href="#h4-2" id="h4-2" class="h">@@ -253,7 +254,7 @@ SQL txns:  {txns_active} active, {txns} total ({sql_storage} storage)
</a>             match self.execute(&amp;input).await {
                 Ok(()) =&gt; {}
                 error @ Err(Error::Internal(_)) =&gt; return error,
<a href="#h4-2-3" id="h4-2-3" class="d">-                Err(error) =&gt; println!(&quot;Error: {}&quot;, error.to_string()),
</a><a href="#h4-2-4" id="h4-2-4" class="i">+                Err(error) =&gt; println!(&quot;Error: {}&quot;, error),
</a>             }
         }
 
<b>diff --git a/<a id="h5" href="../file/src/raft/log.rs.html">src/raft/log.rs</a> b/<a href="../file/src/raft/log.rs.html">src/raft/log.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -304,13 +304,13 @@ mod tests {
</a>         let (mut l, _) = setup()?;
         l.append(2, Some(vec![0x01]))?;
 
<a href="#h5-0-3" id="h5-0-3" class="d">-        assert_eq!(true, l.has(1, 2)?);
</a><a href="#h5-0-4" id="h5-0-4" class="d">-        assert_eq!(true, l.has(0, 0)?);
</a><a href="#h5-0-5" id="h5-0-5" class="d">-        assert_eq!(false, l.has(0, 1)?);
</a><a href="#h5-0-6" id="h5-0-6" class="d">-        assert_eq!(false, l.has(1, 0)?);
</a><a href="#h5-0-7" id="h5-0-7" class="d">-        assert_eq!(false, l.has(1, 3)?);
</a><a href="#h5-0-8" id="h5-0-8" class="d">-        assert_eq!(false, l.has(2, 0)?);
</a><a href="#h5-0-9" id="h5-0-9" class="d">-        assert_eq!(false, l.has(2, 1)?);
</a><a href="#h5-0-10" id="h5-0-10" class="i">+        assert!(l.has(1, 2)?);
</a><a href="#h5-0-11" id="h5-0-11" class="i">+        assert!(l.has(0, 0)?);
</a><a href="#h5-0-12" id="h5-0-12" class="i">+        assert!(!l.has(0, 1)?);
</a><a href="#h5-0-13" id="h5-0-13" class="i">+        assert!(!l.has(1, 0)?);
</a><a href="#h5-0-14" id="h5-0-14" class="i">+        assert!(!l.has(1, 3)?);
</a><a href="#h5-0-15" id="h5-0-15" class="i">+        assert!(!l.has(2, 0)?);
</a><a href="#h5-0-16" id="h5-0-16" class="i">+        assert!(!l.has(2, 1)?);
</a>         Ok(())
     }
 
<b>diff --git a/<a id="h6" href="../file/src/raft/server.rs.html">src/raft/server.rs</a> b/<a href="../file/src/raft/server.rs.html">src/raft/server.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -32,14 +32,8 @@ impl Server {
</a>     ) -&gt; Result&lt;Self&gt; {
         let (node_tx, node_rx) = mpsc::unbounded_channel();
         Ok(Self {
<a href="#h6-0-3" id="h6-0-3" class="d">-            node: Node::new(
</a><a href="#h6-0-4" id="h6-0-4" class="d">-                id,
</a><a href="#h6-0-5" id="h6-0-5" class="d">-                peers.iter().map(|(k, _)| k.to_string()).collect(),
</a><a href="#h6-0-6" id="h6-0-6" class="d">-                log,
</a><a href="#h6-0-7" id="h6-0-7" class="d">-                state,
</a><a href="#h6-0-8" id="h6-0-8" class="d">-                node_tx,
</a><a href="#h6-0-9" id="h6-0-9" class="d">-            )
</a><a href="#h6-0-10" id="h6-0-10" class="d">-            .await?,
</a><a href="#h6-0-11" id="h6-0-11" class="i">+            node: Node::new(id, peers.keys().map(|k| k.to_string()).collect(), log, state, node_tx)
</a><a href="#h6-0-12" id="h6-0-12" class="i">+                .await?,
</a>             peers,
             node_rx,
         })
<b>diff --git a/<a id="h7" href="../file/src/raft/state.rs.html">src/raft/state.rs</a> b/<a href="../file/src/raft/state.rs.html">src/raft/state.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -87,7 +87,7 @@ impl Driver {
</a>     }
 
     /// Synchronously (re)plays a set of log entries, for initial sync.
<a href="#h7-0-3" id="h7-0-3" class="d">-    pub fn replay&lt;&#39;a&gt;(&amp;mut self, state: &amp;mut dyn State, mut scan: Scan&lt;&#39;a&gt;) -&gt; Result&lt;()&gt; {
</a><a href="#h7-0-4" id="h7-0-4" class="i">+    pub fn replay(&amp;mut self, state: &amp;mut dyn State, mut scan: Scan) -&gt; Result&lt;()&gt; {
</a>         while let Some(entry) = scan.next().transpose()? {
             debug!(&quot;Replaying {:?}&quot;, entry);
             if let Some(command) = entry.command {
<b>diff --git a/<a id="h8" href="../file/src/sql/engine/kv.rs.html">src/sql/engine/kv.rs</a> b/<a href="../file/src/sql/engine/kv.rs.html">src/sql/engine/kv.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -79,7 +79,7 @@ impl Transaction {
</a>             .get(&amp;Key::Index(table.into(), column.into(), Some(value.into())).encode())?
             .map(|v| deserialize(&amp;v))
             .transpose()?
<a href="#h8-0-3" id="h8-0-3" class="d">-            .unwrap_or_else(HashSet::new))
</a><a href="#h8-0-4" id="h8-0-4" class="i">+            .unwrap_or_default())
</a>     }
 
     /// Saves an index entry.
<b>diff --git a/<a id="h9" href="../file/src/sql/execution/aggregation.rs.html">src/sql/execution/aggregation.rs</a> b/<a href="../file/src/sql/execution/aggregation.rs.html">src/sql/execution/aggregation.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -29,12 +29,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Aggregation&lt;T&gt; {
</a>                 while let Some(mut row) = rows.next().transpose()? {
                     self.accumulators
                         .entry(row.split_off(self.aggregates.len()))
<a href="#h9-0-3" id="h9-0-3" class="d">-                        .or_insert(
</a><a href="#h9-0-4" id="h9-0-4" class="d">-                            self.aggregates
</a><a href="#h9-0-5" id="h9-0-5" class="d">-                                .iter()
</a><a href="#h9-0-6" id="h9-0-6" class="d">-                                .map(|agg| &lt;dyn Accumulator&gt;::from(agg))
</a><a href="#h9-0-7" id="h9-0-7" class="d">-                                .collect(),
</a><a href="#h9-0-8" id="h9-0-8" class="d">-                        )
</a><a href="#h9-0-9" id="h9-0-9" class="i">+                        .or_insert(self.aggregates.iter().map(&lt;dyn Accumulator&gt;::from).collect())
</a>                         .iter_mut()
                         .zip(row)
                         .try_for_each(|(acc, value)| acc.accumulate(&amp;value))?
<a href="#h9-1" id="h9-1" class="h">@@ -44,7 +39,7 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Aggregation&lt;T&gt; {
</a>                 if self.accumulators.is_empty() &amp;&amp; self.aggregates.len() == columns.len() {
                     self.accumulators.insert(
                         Vec::new(),
<a href="#h9-1-3" id="h9-1-3" class="d">-                        self.aggregates.iter().map(|agg| &lt;dyn Accumulator&gt;::from(agg)).collect(),
</a><a href="#h9-1-4" id="h9-1-4" class="i">+                        self.aggregates.iter().map(&lt;dyn Accumulator&gt;::from).collect(),
</a>                     );
                 }
                 Ok(ResultSet::Query {
<b>diff --git a/<a id="h10" href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a> b/<a href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -300,7 +300,9 @@ impl&lt;&#39;a&gt; Iterator for Lexer&lt;&#39;a&gt; {
</a>     fn next(&amp;mut self) -&gt; Option&lt;Result&lt;Token&gt;&gt; {
         match self.scan() {
             Ok(Some(token)) =&gt; Some(Ok(token)),
<a href="#h10-0-3" id="h10-0-3" class="d">-            Ok(None) =&gt; self.iter.peek().map(|c| Err(Error::Parse(format!(&quot;Unexpected character {}&quot;, c)))),
</a><a href="#h10-0-4" id="h10-0-4" class="i">+            Ok(None) =&gt; {
</a><a href="#h10-0-5" id="h10-0-5" class="i">+                self.iter.peek().map(|c| Err(Error::Parse(format!(&quot;Unexpected character {}&quot;, c))))
</a><a href="#h10-0-6" id="h10-0-6" class="i">+            }
</a>             Err(err) =&gt; Some(Err(err)),
         }
     }
<a href="#h10-1" id="h10-1" class="h">@@ -346,7 +348,7 @@ impl&lt;&#39;a&gt; Lexer&lt;&#39;a&gt; {
</a>         match self.iter.peek() {
             Some(&#39;\&#39;&#39;) =&gt; self.scan_string(),
             Some(&#39;&quot;&#39;) =&gt; self.scan_ident_quoted(),
<a href="#h10-1-3" id="h10-1-3" class="d">-            Some(c) if c.is_digit(10) =&gt; Ok(self.scan_number()),
</a><a href="#h10-1-4" id="h10-1-4" class="i">+            Some(c) if c.is_ascii_digit() =&gt; Ok(self.scan_number()),
</a>             Some(c) if c.is_alphabetic() =&gt; Ok(self.scan_ident()),
             Some(_) =&gt; Ok(self.scan_symbol()),
             None =&gt; Ok(None),
<a href="#h10-2" id="h10-2" class="h">@@ -383,10 +385,10 @@ impl&lt;&#39;a&gt; Lexer&lt;&#39;a&gt; {
</a> 
     /// Scans the input for the next number token, if any
     fn scan_number(&amp;mut self) -&gt; Option&lt;Token&gt; {
<a href="#h10-2-3" id="h10-2-3" class="d">-        let mut num = self.next_while(|c| c.is_digit(10))?;
</a><a href="#h10-2-4" id="h10-2-4" class="i">+        let mut num = self.next_while(|c| c.is_ascii_digit())?;
</a>         if let Some(sep) = self.next_if(|c| c == &#39;.&#39;) {
             num.push(sep);
<a href="#h10-2-7" id="h10-2-7" class="d">-            while let Some(dec) = self.next_if(|c| c.is_digit(10)) {
</a><a href="#h10-2-8" id="h10-2-8" class="i">+            while let Some(dec) = self.next_if(|c| c.is_ascii_digit()) {
</a>                 num.push(dec)
             }
         }
<a href="#h10-3" id="h10-3" class="h">@@ -395,7 +397,7 @@ impl&lt;&#39;a&gt; Lexer&lt;&#39;a&gt; {
</a>             if let Some(sign) = self.next_if(|c| c == &#39;+&#39; || c == &#39;-&#39;) {
                 num.push(sign)
             }
<a href="#h10-3-3" id="h10-3-3" class="d">-            while let Some(c) = self.next_if(|c| c.is_digit(10)) {
</a><a href="#h10-3-4" id="h10-3-4" class="i">+            while let Some(c) = self.next_if(|c| c.is_ascii_digit()) {
</a>                 num.push(c)
             }
         }
<b>diff --git a/<a id="h11" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -556,7 +556,7 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                 }
             }
             Token::Number(n) =&gt; {
<a href="#h11-0-3" id="h11-0-3" class="d">-                if n.chars().all(|c| c.is_digit(10)) {
</a><a href="#h11-0-4" id="h11-0-4" class="i">+                if n.chars().all(|c| c.is_ascii_digit()) {
</a>                     ast::Literal::Integer(n.parse()?).into()
                 } else {
                     ast::Literal::Float(n.parse()?).into()
<a href="#h11-1" id="h11-1" class="h">@@ -789,6 +789,6 @@ pub(super) fn format_ident(ident: &amp;str) -&gt; String {
</a>     if RE_IDENT.is_match(ident) &amp;&amp; Keyword::from_str(ident).is_none() {
         ident.to_string()
     } else {
<a href="#h11-1-3" id="h11-1-3" class="d">-        format!(&quot;\&quot;{}\&quot;&quot;, ident.replace(&quot;\&quot;&quot;, &quot;\&quot;\&quot;&quot;))
</a><a href="#h11-1-4" id="h11-1-4" class="i">+        format!(&quot;\&quot;{}\&quot;&quot;, ident.replace(&#39;\&quot;&#39;, &quot;\&quot;\&quot;&quot;))
</a>     }
 }
<b>diff --git a/<a id="h12" href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a> b/<a href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -19,7 +19,7 @@ pub struct Plan(pub Node);
</a> 
 impl Display for Plan {
     fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;&#39;_&gt;) -&gt; fmt::Result {
<a href="#h12-0-3" id="h12-0-3" class="d">-        write!(f, &quot;{}&quot;, self.0.to_string())
</a><a href="#h12-0-4" id="h12-0-4" class="i">+        write!(f, &quot;{}&quot;, self.0)
</a>     }
 }
 
<b>diff --git a/<a id="h13" href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a> b/<a href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -16,7 +16,7 @@ pub struct ConstantFolder;
</a> 
 impl Optimizer for ConstantFolder {
     fn optimize(&amp;self, node: Node) -&gt; Result&lt;Node&gt; {
<a href="#h13-0-3" id="h13-0-3" class="d">-        node.transform(&amp;|n| Ok(n), &amp;|n| {
</a><a href="#h13-0-4" id="h13-0-4" class="i">+        node.transform(&amp;Ok, &amp;|n| {
</a>             n.transform_expressions(
                 &amp;|e| {
                     if !e.contains(&amp;|expr| matches!(expr, Expression::Field(_, _))) {
<a href="#h13-1" id="h13-1" class="h">@@ -25,7 +25,7 @@ impl Optimizer for ConstantFolder {
</a>                         Ok(e)
                     }
                 },
<a href="#h13-1-3" id="h13-1-3" class="d">-                &amp;|e| Ok(e),
</a><a href="#h13-1-4" id="h13-1-4" class="i">+                &amp;Ok,
</a>             )
         })
     }
<a href="#h13-2" id="h13-2" class="h">@@ -42,7 +42,7 @@ impl Optimizer for FilterPushdown {
</a>                     // We don&#39;t replace the filter node here, since doing so would cause transform()
                     // to skip the source as it won&#39;t reapply the transform to the &quot;same&quot; node.
                     // We leave a noop filter node instead, which will be cleaned up by NoopCleaner.
<a href="#h13-2-3" id="h13-2-3" class="d">-                    if let Some(remainder) = self.pushdown(predicate, &amp;mut *source) {
</a><a href="#h13-2-4" id="h13-2-4" class="i">+                    if let Some(remainder) = self.pushdown(predicate, &amp;mut source) {
</a>                         Ok(Node::Filter { source, predicate: remainder })
                     } else {
                         Ok(Node::Filter {
<a href="#h13-3" id="h13-3" class="h">@@ -63,7 +63,7 @@ impl Optimizer for FilterPushdown {
</a>                 }
                 n =&gt; Ok(n),
             },
<a href="#h13-3-3" id="h13-3-3" class="d">-            &amp;|n| Ok(n),
</a><a href="#h13-3-4" id="h13-3-4" class="i">+            &amp;Ok,
</a>         )
     }
 }
<a href="#h13-4" id="h13-4" class="h">@@ -146,7 +146,7 @@ impl FilterPushdown {
</a>                         Expression::Field(i, label) =&gt; Ok(Expression::Field(i - boundary, label)),
                         e =&gt; Ok(e),
                     },
<a href="#h13-4-3" id="h13-4-3" class="d">-                    &amp;|e| Ok(e),
</a><a href="#h13-4-4" id="h13-4-4" class="i">+                    &amp;Ok,
</a>                 )
                 .unwrap();
             if let Some(remainder) = self.pushdown(push_right, right) {
<a href="#h13-5" id="h13-5" class="h">@@ -179,7 +179,7 @@ impl&lt;&#39;a, C: Catalog&gt; IndexLookup&lt;&#39;a, C&gt; {
</a> 
 impl&lt;&#39;a, C: Catalog&gt; Optimizer for IndexLookup&lt;&#39;a, C&gt; {
     fn optimize(&amp;self, node: Node) -&gt; Result&lt;Node&gt; {
<a href="#h13-5-3" id="h13-5-3" class="d">-        node.transform(&amp;|n| Ok(n), &amp;|n| match n {
</a><a href="#h13-5-4" id="h13-5-4" class="i">+        node.transform(&amp;Ok, &amp;|n| match n {
</a>             Node::Scan { table, alias, filter: Some(filter) } =&gt; {
                 let columns = self.catalog.must_read_table(&amp;table)?.columns;
                 let pk = columns.iter().position(|c| c.primary_key).unwrap();
<a href="#h13-6" id="h13-6" class="h">@@ -226,7 +226,7 @@ impl Optimizer for NoopCleaner {
</a>         node.transform(
             // While descending the node tree, clean up boolean expressions.
             &amp;|n| {
<a href="#h13-6-3" id="h13-6-3" class="d">-                n.transform_expressions(&amp;|e| Ok(e), &amp;|e| match &amp;e {
</a><a href="#h13-6-4" id="h13-6-4" class="i">+                n.transform_expressions(&amp;Ok, &amp;|e| match &amp;e {
</a>                     And(lhs, rhs) =&gt; match (&amp;**lhs, &amp;**rhs) {
                         (Constant(Value::Boolean(false)), _)
                         | (Constant(Value::Null), _)
<a href="#h13-7" id="h13-7" class="h">@@ -295,7 +295,7 @@ impl Optimizer for JoinType {
</a>                 },
                 n =&gt; Ok(n),
             },
<a href="#h13-7-3" id="h13-7-3" class="d">-            &amp;|n| Ok(n),
</a><a href="#h13-7-4" id="h13-7-4" class="i">+            &amp;Ok,
</a>         )
     }
 }
<b>diff --git a/<a id="h14" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -83,7 +83,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a> 
             ast::Statement::Insert { table, columns, values } =&gt; Node::Insert {
                 table,
<a href="#h14-0-3" id="h14-0-3" class="d">-                columns: columns.unwrap_or_else(Vec::new),
</a><a href="#h14-0-4" id="h14-0-4" class="i">+                columns: columns.unwrap_or_default(),
</a>                 expressions: values
                     .into_iter()
                     .map(|exprs| {
<a href="#h14-1" id="h14-1" class="h">@@ -385,7 +385,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                     }
                     _ =&gt; Ok(e),
                 },
<a href="#h14-1-3" id="h14-1-3" class="d">-                &amp;mut |e| Ok(e),
</a><a href="#h14-1-4" id="h14-1-4" class="i">+                &amp;mut Ok,
</a>             )?;
         }
         for (_, expr) in &amp;aggregates {
<a href="#h14-2" id="h14-2" class="h">@@ -405,7 +405,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>     /// SELECT COUNT(*) FROM movies GROUP BY released / 100
     fn extract_groups(
         &amp;self,
<a href="#h14-2-3" id="h14-2-3" class="d">-        exprs: &amp;mut Vec&lt;(ast::Expression, Option&lt;String&gt;)&gt;,
</a><a href="#h14-2-4" id="h14-2-4" class="i">+        exprs: &amp;mut [(ast::Expression, Option&lt;String&gt;)],
</a>         group_by: Vec&lt;ast::Expression&gt;,
         offset: usize,
     ) -&gt; Result&lt;Vec&lt;(ast::Expression, Option&lt;String&gt;)&gt;&gt; {
<a href="#h14-3" id="h14-3" class="h">@@ -466,7 +466,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                         }
                         e =&gt; Ok(e),
                     },
<a href="#h14-3-3" id="h14-3-3" class="d">-                    &amp;mut |e| Ok(e),
</a><a href="#h14-3-4" id="h14-3-4" class="i">+                    &amp;mut Ok,
</a>                 )?;
             }
         }
<a href="#h14-4" id="h14-4" class="h">@@ -494,7 +494,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 }
                 _ =&gt; Ok(e),
             },
<a href="#h14-4-3" id="h14-4-3" class="d">-            &amp;mut |e| Ok(e),
</a><a href="#h14-4-4" id="h14-4-4" class="i">+            &amp;mut Ok,
</a>         )?;
         Ok(hidden)
     }
<a href="#h14-5" id="h14-5" class="h">@@ -520,6 +520,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>     }
 
     /// Builds an expression from an AST expression
<a href="#h14-5-3" id="h14-5-3" class="i">+    #[allow(clippy::only_used_in_recursion)]
</a>     fn build_expression(&amp;self, scope: &amp;mut Scope, expr: ast::Expression) -&gt; Result&lt;Expression&gt; {
         use Expression::*;
         Ok(match expr {
<b>diff --git a/<a id="h15" href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a> b/<a href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -178,7 +178,7 @@ impl Expression {
</a>                 Integer(i) if i &lt; 0 =&gt; {
                     return Err(Error::Value(&quot;Can&#39;t take factorial of negative number&quot;.into()))
                 }
<a href="#h15-0-3" id="h15-0-3" class="d">-                Integer(i) =&gt; Integer((1..=i).fold(1, |a, b| a * b as i64)),
</a><a href="#h15-0-4" id="h15-0-4" class="i">+                Integer(i) =&gt; Integer((1..=i).product()),
</a>                 Null =&gt; Null,
                 value =&gt; return Err(Error::Value(format!(&quot;Can&#39;t take factorial of {}&quot;, value))),
             },
<a href="#h15-1" id="h15-1" class="h">@@ -245,9 +245,9 @@ impl Expression {
</a>                     Regex::new(&amp;format!(
                         &quot;^{}$&quot;,
                         regex::escape(&amp;rhs)
<a href="#h15-1-3" id="h15-1-3" class="d">-                            .replace(&quot;%&quot;, &quot;.*&quot;)
</a><a href="#h15-1-4" id="h15-1-4" class="i">+                            .replace(&#39;%&#39;, &quot;.*&quot;)
</a>                             .replace(&quot;.*.*&quot;, &quot;%&quot;)
<a href="#h15-1-6" id="h15-1-6" class="d">-                            .replace(&quot;_&quot;, &quot;.&quot;)
</a><a href="#h15-1-7" id="h15-1-7" class="i">+                            .replace(&#39;_&#39;, &quot;.&quot;)
</a>                             .replace(&quot;..&quot;, &quot;_&quot;)
                     ))?
                     .is_match(&amp;lhs),
<a href="#h15-2" id="h15-2" class="h">@@ -352,7 +352,7 @@ impl Expression {
</a>                 },
                 _ =&gt; Ok(e),
             },
<a href="#h15-2-3" id="h15-2-3" class="d">-            &amp;|e| Ok(e),
</a><a href="#h15-2-4" id="h15-2-4" class="i">+            &amp;Ok,
</a>         )
         .unwrap()
     }
<a href="#h15-3" id="h15-3" class="h">@@ -376,7 +376,7 @@ impl Expression {
</a>                     },
                     e =&gt; Ok(e),
                 },
<a href="#h15-3-3" id="h15-3-3" class="d">-                &amp;|e| Ok(e),
</a><a href="#h15-3-4" id="h15-3-4" class="i">+                &amp;Ok,
</a>             )
             .unwrap()
     }
<a href="#h15-4" id="h15-4" class="h">@@ -416,7 +416,7 @@ impl Expression {
</a>                     },
                     e =&gt; Ok(e),
                 },
<a href="#h15-4-3" id="h15-4-3" class="d">-                &amp;|e| Ok(e),
</a><a href="#h15-4-4" id="h15-4-4" class="i">+                &amp;Ok,
</a>             )
             .unwrap()
     }
<a href="#h15-5" id="h15-5" class="h">@@ -469,7 +469,7 @@ impl Expression {
</a>         use Expression::*;
         // FIXME This should use a single match level, but since the child expressions are boxed
         // that would require box patterns, which are unstable.
<a href="#h15-5-3" id="h15-5-3" class="d">-        match &amp;*self {
</a><a href="#h15-5-4" id="h15-5-4" class="i">+        match &amp;self {
</a>             Equal(lhs, rhs) =&gt; match (&amp;**lhs, &amp;**rhs) {
                 (Field(i, _), Constant(v)) if i == &amp;field =&gt; Some(vec![v.clone()]),
                 (Constant(v), Field(i, _)) if i == &amp;field =&gt; Some(vec![v.clone()]),
<b>diff --git a/<a id="h16" href="../file/src/sql/types/mod.rs.html">src/sql/types/mod.rs</a> b/<a href="../file/src/sql/types/mod.rs.html">src/sql/types/mod.rs</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -40,7 +40,7 @@ pub enum Value {
</a> 
 impl std::cmp::Eq for Value {}
 
<a href="#h16-0-3" id="h16-0-3" class="d">-#[allow(clippy::derive_hash_xor_eq)]
</a><a href="#h16-0-4" id="h16-0-4" class="i">+#[allow(clippy::derived_hash_with_manual_eq)]
</a> impl Hash for Value {
     fn hash&lt;H: Hasher&gt;(&amp;self, state: &amp;mut H) {
         self.datatype().hash(state);
<b>diff --git a/<a id="h17" href="../file/src/storage/kv/encoding.rs.html">src/storage/kv/encoding.rs</a> b/<a href="../file/src/storage/kv/encoding.rs.html">src/storage/kv/encoding.rs</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -212,8 +212,8 @@ mod tests {
</a>     #[test]
     fn decode_boolean() -&gt; Result&lt;()&gt; {
         use super::decode_boolean;
<a href="#h17-0-3" id="h17-0-3" class="d">-        assert_eq!(decode_boolean(0x00)?, false);
</a><a href="#h17-0-4" id="h17-0-4" class="d">-        assert_eq!(decode_boolean(0x01)?, true);
</a><a href="#h17-0-5" id="h17-0-5" class="i">+        assert!(!decode_boolean(0x00)?);
</a><a href="#h17-0-6" id="h17-0-6" class="i">+        assert!(decode_boolean(0x01)?);
</a>         assert!(decode_boolean(0x02).is_err());
         Ok(())
     }
<a href="#h17-1" id="h17-1" class="h">@@ -222,7 +222,7 @@ mod tests {
</a>     fn take_boolean() -&gt; Result&lt;()&gt; {
         use super::take_boolean;
         let mut bytes: &amp;[u8] = &amp;[0x01, 0xaf];
<a href="#h17-1-3" id="h17-1-3" class="d">-        assert_eq!(take_boolean(&amp;mut bytes)?, true);
</a><a href="#h17-1-4" id="h17-1-4" class="i">+        assert!(take_boolean(&amp;mut bytes)?);
</a>         assert_eq!(bytes, &amp;[0xaf]);
         Ok(())
     }
<b>diff --git a/<a id="h18" href="../file/src/storage/kv/memory.rs.html">src/storage/kv/memory.rs</a> b/<a href="../file/src/storage/kv/memory.rs.html">src/storage/kv/memory.rs</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -318,7 +318,7 @@ impl Children {
</a>     /// Looks up the child responsible for a given key. This can only be called on non-empty
     /// child sets, which should be all child sets except for the initial root node.
     fn lookup(&amp;self, key: &amp;[u8]) -&gt; (usize, &amp;Node) {
<a href="#h18-0-3" id="h18-0-3" class="d">-        let i = self.keys.iter().position(|k| k.deref() &gt; key).unwrap_or_else(|| self.keys.len());
</a><a href="#h18-0-4" id="h18-0-4" class="i">+        let i = self.keys.iter().position(|k| k.deref() &gt; key).unwrap_or(self.keys.len());
</a>         (i, &amp;self[i])
     }
 
<a href="#h18-1" id="h18-1" class="h">@@ -326,7 +326,7 @@ impl Children {
</a>     /// can only be called on non-empty child sets, which should be all child sets except for the
     /// initial root node.
     fn lookup_mut(&amp;mut self, key: &amp;[u8]) -&gt; (usize, &amp;mut Node) {
<a href="#h18-1-3" id="h18-1-3" class="d">-        let i = self.keys.iter().position(|k| k.deref() &gt; key).unwrap_or_else(|| self.keys.len());
</a><a href="#h18-1-4" id="h18-1-4" class="i">+        let i = self.keys.iter().position(|k| k.deref() &gt; key).unwrap_or(self.keys.len());
</a>         (i, &amp;mut self[i])
     }
 
<a href="#h18-2" id="h18-2" class="h">@@ -509,7 +509,7 @@ impl Values {
</a>     /// Deletes a key from the set, if it exists.
     fn delete(&amp;mut self, key: &amp;[u8]) {
         for (i, (k, _)) in self.iter().enumerate() {
<a href="#h18-2-3" id="h18-2-3" class="d">-            match (&amp;**k).cmp(key) {
</a><a href="#h18-2-4" id="h18-2-4" class="i">+            match (**k).cmp(key) {
</a>                 Ordering::Greater =&gt; break,
                 Ordering::Equal =&gt; {
                     self.remove(i);
<a href="#h18-3" id="h18-3" class="h">@@ -523,7 +523,7 @@ impl Values {
</a>     /// Fetches a value from the set, if the key exists.
     fn get(&amp;self, key: &amp;[u8]) -&gt; Option&lt;Vec&lt;u8&gt;&gt; {
         self.iter()
<a href="#h18-3-3" id="h18-3-3" class="d">-            .find_map(|(k, v)| match (&amp;**k).cmp(key) {
</a><a href="#h18-3-4" id="h18-3-4" class="i">+            .find_map(|(k, v)| match (**k).cmp(key) {
</a>                 Ordering::Greater =&gt; Some(None),
                 Ordering::Equal =&gt; Some(Some(v.to_vec())),
                 Ordering::Less =&gt; None,
<a href="#h18-4" id="h18-4" class="h">@@ -544,7 +544,7 @@ impl Values {
</a>     /// Fetches the next value after the given key, if it exists.
     fn get_next(&amp;self, key: &amp;[u8]) -&gt; Option&lt;(Vec&lt;u8&gt;, Vec&lt;u8&gt;)&gt; {
         self.iter()
<a href="#h18-4-3" id="h18-4-3" class="d">-            .find_map(|(k, v)| match (&amp;**k).cmp(key) {
</a><a href="#h18-4-4" id="h18-4-4" class="i">+            .find_map(|(k, v)| match (**k).cmp(key) {
</a>                 Ordering::Greater =&gt; Some(Some((k.to_vec(), v.to_vec()))),
                 Ordering::Equal =&gt; None,
                 Ordering::Less =&gt; None,
<a href="#h18-5" id="h18-5" class="h">@@ -556,7 +556,7 @@ impl Values {
</a>     fn get_prev(&amp;self, key: &amp;[u8]) -&gt; Option&lt;(Vec&lt;u8&gt;, Vec&lt;u8&gt;)&gt; {
         self.iter()
             .rev()
<a href="#h18-5-3" id="h18-5-3" class="d">-            .find_map(|(k, v)| match (&amp;**k).cmp(key) {
</a><a href="#h18-5-4" id="h18-5-4" class="i">+            .find_map(|(k, v)| match (**k).cmp(key) {
</a>                 Ordering::Less =&gt; Some(Some((k.to_vec(), v.to_vec()))),
                 Ordering::Equal =&gt; None,
                 Ordering::Greater =&gt; None,
<a href="#h18-6" id="h18-6" class="h">@@ -570,7 +570,7 @@ impl Values {
</a>         // Find position to insert at, or if the key already exists just update it.
         let mut insert_at = self.len();
         for (i, (k, v)) in self.iter_mut().enumerate() {
<a href="#h18-6-3" id="h18-6-3" class="d">-            match (&amp;**k).cmp(key) {
</a><a href="#h18-6-4" id="h18-6-4" class="i">+            match (**k).cmp(key) {
</a>                 Ordering::Greater =&gt; {
                     insert_at = i;
                     break;
<b>diff --git a/<a id="h19" href="../file/tests/sql/expression.rs.html">tests/sql/expression.rs</a> b/<a href="../file/tests/sql/expression.rs.html">tests/sql/expression.rs</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h19-0-0" id="h19-0-0" class="d">-///! Evaluates SQL expressions and compares with expectations.
</a><a href="#h19-0-1" id="h19-0-1" class="i">+//! Evaluates SQL expressions and compares with expectations.
</a> use toydb::error::{Error, Result};
 use toydb::sql::engine::Engine;
 use toydb::sql::types::Value;
<b>diff --git a/<a id="h20" href="../file/tests/sql/mutation.rs.html">tests/sql/mutation.rs</a> b/<a href="../file/tests/sql/mutation.rs.html">tests/sql/mutation.rs</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h20-0-0" id="h20-0-0" class="d">-///! Mutation tests, using an in-memory database against golden files in tests/sql/mutation/
</a><a href="#h20-0-1" id="h20-0-1" class="i">+//! Mutation tests, using an in-memory database against golden files in tests/sql/mutation/
</a> use toydb::error::Result;
 use toydb::sql::engine::{Engine as _, Mode, Transaction as _};
 use toydb::sql::schema::Catalog as _;
<b>diff --git a/<a id="h21" href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a> b/<a href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -1,5 +1,5 @@
</a><a href="#h21-0-0" id="h21-0-0" class="d">-///! Tests for the SQL query engine. Runs SQL queries against an in-memory database,
</a><a href="#h21-0-1" id="h21-0-1" class="d">-///! and compares the results with golden files stored under tests/sql/query/
</a><a href="#h21-0-2" id="h21-0-2" class="i">+//! Tests for the SQL query engine. Runs SQL queries against an in-memory database,
</a><a href="#h21-0-3" id="h21-0-3" class="i">+//! and compares the results with golden files stored under tests/sql/query/
</a> use toydb::error::{Error, Result};
 use toydb::sql::engine::{Engine, Mode, Transaction};
 use toydb::sql::execution::ResultSet;
<b>diff --git a/<a id="h22" href="../file/tests/sql/schema.rs.html">tests/sql/schema.rs</a> b/<a href="../file/tests/sql/schema.rs.html">tests/sql/schema.rs</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h22-0-0" id="h22-0-0" class="d">-///! Schema-related tests, using an in-memory database against golden files in tests/sql/chema/
</a><a href="#h22-0-1" id="h22-0-1" class="i">+//! Schema-related tests, using an in-memory database against golden files in tests/sql/chema/
</a> use toydb::error::Result;
 use toydb::sql::engine::{Engine as _, Mode, Transaction as _};
 use toydb::sql::schema::Catalog as _;
</pre>
</div>
</body>
</html>
