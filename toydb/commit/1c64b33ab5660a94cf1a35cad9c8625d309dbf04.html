<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: add basic noop cleaning optimizer - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/1c64b33ab5660a94cf1a35cad9c8625d309dbf04.html">1c64b33ab5660a94cf1a35cad9c8625d309dbf04</a>
<b>parent</b> <a href="../commit/637a55b75fe243a48e228b830737a5b322beda6d.html">637a55b75fe243a48e228b830737a5b322beda6d</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Mon,  1 Jun 2020 16:45:26 +0200

sql: add basic noop cleaning optimizer

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">src/sql/execution/query.rs</a></td><td> | </td><td class="num">39</td><td><span class="i">++++++++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/plan/mod.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/sql/plan/optimizer.rs</a></td><td> | </td><td class="num">84</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">tests/sql/query/agg_boolean</a></td><td> | </td><td class="num">47</td><td><span class="i">+++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">tests/sql/query/agg_float</a></td><td> | </td><td class="num">47</td><td><span class="i">+++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">tests/sql/query/agg_integer</a></td><td> | </td><td class="num">47</td><td><span class="i">+++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">tests/sql/query/agg_norows</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">tests/sql/query/agg_norows_group</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">tests/sql/query/agg_string</a></td><td> | </td><td class="num">47</td><td><span class="i">+++++++++++++++++++++</span><span class="d">--------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">tests/sql/query/having</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d">------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">76</td><td><span class="i">++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/having_nogroup</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++</span><span class="d">--------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">tests/sql/query/join_cross_alias</a></td><td> | </td><td class="num">231</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d">----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">tests/sql/query/join_inner_index_transverse_where</a></td><td> | </td><td class="num">115</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">tests/sql/query/join_inner_multi_index</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">tests/sql/query/join_inner_on_where</a></td><td> | </td><td class="num">175</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">101</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">101</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">tests/sql/query/where_expr</a></td><td> | </td><td class="num">111</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">tests/sql/query/where_false</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/where_field_aliased_table</a></td><td> | </td><td class="num">167</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/where_field_qualified</a></td><td> | </td><td class="num">161</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/where_float</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">tests/sql/query/where_index</a></td><td> | </td><td class="num">45</td><td><span class="i">++++++++++++++++++++</span><span class="d">-------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">tests/sql/query/where_index_or</a></td><td> | </td><td class="num">99</td><td><span class="i">++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">tests/sql/query/where_index_or_partial</a></td><td> | </td><td class="num">121</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">tests/sql/query/where_integer</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">tests/sql/query/where_join_inner</a></td><td> | </td><td class="num">89</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">tests/sql/query/where_null</a></td><td> | </td><td class="num">23</td><td><span class="i">+++++++++</span><span class="d">--------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">tests/sql/query/where_pk</a></td><td> | </td><td class="num">43</td><td><span class="i">+++++++++++++++++++</span><span class="d">------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">tests/sql/query/where_pk_or</a></td><td> | </td><td class="num">89</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">tests/sql/query/where_pk_or_partial</a></td><td> | </td><td class="num">135</td><td><span class="i">+++++++++++++++++++++++++++++++++++++</span><span class="d">------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">tests/sql/query/where_string</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">tests/sql/query/where_true</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++</span><span class="d">----------------</span></td></tr>
</table></pre><pre>38 files changed, 1257 insertions(+), 1366 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/sql/execution/query.rs.html">src/sql/execution/query.rs</a> b/<a href="../file/src/sql/execution/query.rs.html">src/sql/execution/query.rs</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -7,11 +7,11 @@ use crate::error::{Error, Result};
</a> /// A filter executor
 pub struct Filter&lt;T: Transaction&gt; {
     source: Box&lt;dyn Executor&lt;T&gt;&gt;,
<a href="#h0-0-3" id="h0-0-3" class="d">-    predicate: Option&lt;Expression&gt;,
</a><a href="#h0-0-4" id="h0-0-4" class="i">+    predicate: Expression,
</a> }
 
 impl&lt;T: Transaction&gt; Filter&lt;T&gt; {
<a href="#h0-0-8" id="h0-0-8" class="d">-    pub fn new(source: Box&lt;dyn Executor&lt;T&gt;&gt;, predicate: Option&lt;Expression&gt;) -&gt; Box&lt;Self&gt; {
</a><a href="#h0-0-9" id="h0-0-9" class="i">+    pub fn new(source: Box&lt;dyn Executor&lt;T&gt;&gt;, predicate: Expression) -&gt; Box&lt;Self&gt; {
</a>         Box::new(Self { source, predicate })
     }
 }
<a href="#h0-1" id="h0-1" class="h">@@ -19,25 +19,22 @@ impl&lt;T: Transaction&gt; Filter&lt;T&gt; {
</a> impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Filter&lt;T&gt; {
     fn execute(self: Box&lt;Self&gt;, txn: &amp;mut T) -&gt; Result&lt;ResultSet&gt; {
         if let ResultSet::Query { columns, rows } = self.source.execute(txn)? {
<a href="#h0-1-3" id="h0-1-3" class="d">-            if let Some(predicate) = self.predicate {
</a><a href="#h0-1-4" id="h0-1-4" class="d">-                Ok(ResultSet::Query {
</a><a href="#h0-1-5" id="h0-1-5" class="d">-                    columns,
</a><a href="#h0-1-6" id="h0-1-6" class="d">-                    rows: Box::new(rows.filter_map(move |r| {
</a><a href="#h0-1-7" id="h0-1-7" class="d">-                        r.and_then(|row| match predicate.evaluate(Some(&amp;row))? {
</a><a href="#h0-1-8" id="h0-1-8" class="d">-                            Value::Boolean(true) =&gt; Ok(Some(row)),
</a><a href="#h0-1-9" id="h0-1-9" class="d">-                            Value::Boolean(false) =&gt; Ok(None),
</a><a href="#h0-1-10" id="h0-1-10" class="d">-                            Value::Null =&gt; Ok(None),
</a><a href="#h0-1-11" id="h0-1-11" class="d">-                            value =&gt; Err(Error::Value(format!(
</a><a href="#h0-1-12" id="h0-1-12" class="d">-                                &quot;Filter returned {}, expected boolean&quot;,
</a><a href="#h0-1-13" id="h0-1-13" class="d">-                                value
</a><a href="#h0-1-14" id="h0-1-14" class="d">-                            ))),
</a><a href="#h0-1-15" id="h0-1-15" class="d">-                        })
</a><a href="#h0-1-16" id="h0-1-16" class="d">-                        .transpose()
</a><a href="#h0-1-17" id="h0-1-17" class="d">-                    })),
</a><a href="#h0-1-18" id="h0-1-18" class="d">-                })
</a><a href="#h0-1-19" id="h0-1-19" class="d">-            } else {
</a><a href="#h0-1-20" id="h0-1-20" class="d">-                Ok(ResultSet::Query { columns, rows })
</a><a href="#h0-1-21" id="h0-1-21" class="d">-            }
</a><a href="#h0-1-22" id="h0-1-22" class="i">+            let predicate = self.predicate;
</a><a href="#h0-1-23" id="h0-1-23" class="i">+            Ok(ResultSet::Query {
</a><a href="#h0-1-24" id="h0-1-24" class="i">+                columns,
</a><a href="#h0-1-25" id="h0-1-25" class="i">+                rows: Box::new(rows.filter_map(move |r| {
</a><a href="#h0-1-26" id="h0-1-26" class="i">+                    r.and_then(|row| match predicate.evaluate(Some(&amp;row))? {
</a><a href="#h0-1-27" id="h0-1-27" class="i">+                        Value::Boolean(true) =&gt; Ok(Some(row)),
</a><a href="#h0-1-28" id="h0-1-28" class="i">+                        Value::Boolean(false) =&gt; Ok(None),
</a><a href="#h0-1-29" id="h0-1-29" class="i">+                        Value::Null =&gt; Ok(None),
</a><a href="#h0-1-30" id="h0-1-30" class="i">+                        value =&gt; Err(Error::Value(format!(
</a><a href="#h0-1-31" id="h0-1-31" class="i">+                            &quot;Filter returned {}, expected boolean&quot;,
</a><a href="#h0-1-32" id="h0-1-32" class="i">+                            value
</a><a href="#h0-1-33" id="h0-1-33" class="i">+                        ))),
</a><a href="#h0-1-34" id="h0-1-34" class="i">+                    })
</a><a href="#h0-1-35" id="h0-1-35" class="i">+                    .transpose()
</a><a href="#h0-1-36" id="h0-1-36" class="i">+                })),
</a><a href="#h0-1-37" id="h0-1-37" class="i">+            })
</a>         } else {
             Err(Error::Internal(&quot;Unexpected result&quot;.into()))
         }
<b>diff --git a/<a id="h1" href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a> b/<a href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -34,6 +34,7 @@ impl Plan {
</a>         root = optimizer::ConstantFolder.optimize(root)?;
         root = optimizer::FilterPushdown.optimize(root)?;
         root = optimizer::IndexLookup::new(catalog).optimize(root)?;
<a href="#h1-0-3" id="h1-0-3" class="i">+        root = optimizer::NoopCleaner.optimize(root)?;
</a>         Ok(Plan(root))
     }
 }
<a href="#h1-1" id="h1-1" class="h">@@ -57,10 +58,7 @@ pub enum Node {
</a>     },
     Filter {
         source: Box&lt;Node&gt;,
<a href="#h1-1-3" id="h1-1-3" class="d">-        // A filter node may not make sense, but it&#39;s useful during planning and optimization
</a><a href="#h1-1-4" id="h1-1-4" class="d">-        // when we&#39;re moving predicates around - in particular, replacing a filter node with
</a><a href="#h1-1-5" id="h1-1-5" class="d">-        // a source node during filter pushdown will cause Node.transform() to skip the source.
</a><a href="#h1-1-6" id="h1-1-6" class="d">-        predicate: Option&lt;Expression&gt;,
</a><a href="#h1-1-7" id="h1-1-7" class="i">+        predicate: Expression,
</a>     },
     IndexLookup {
         table: String,
<a href="#h1-2" id="h1-2" class="h">@@ -182,7 +180,6 @@ impl Node {
</a>             | n @ Self::CreateTable { .. }
             | n @ Self::Delete { .. }
             | n @ Self::DropTable { .. }
<a href="#h1-2-3" id="h1-2-3" class="d">-            | n @ Self::Filter { predicate: None, .. }
</a>             | n @ Self::IndexLookup { .. }
             | n @ Self::KeyLookup { .. }
             | n @ Self::Limit { .. }
<a href="#h1-3" id="h1-3" class="h">@@ -191,8 +188,8 @@ impl Node {
</a>             | n @ Self::Offset { .. }
             | n @ Self::Scan { filter: None, .. } =&gt; n,
 
<a href="#h1-3-3" id="h1-3-3" class="d">-            Self::Filter { source, predicate: Some(predicate) } =&gt; {
</a><a href="#h1-3-4" id="h1-3-4" class="d">-                Self::Filter { source, predicate: Some(predicate.transform(before, after)?) }
</a><a href="#h1-3-5" id="h1-3-5" class="i">+            Self::Filter { source, predicate } =&gt; {
</a><a href="#h1-3-6" id="h1-3-6" class="i">+                Self::Filter { source, predicate: predicate.transform(before, after)? }
</a>             }
             Self::Insert { table, columns, expressions } =&gt; Self::Insert {
                 table,
<b>diff --git a/<a id="h2" href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a> b/<a href="../file/src/sql/plan/optimizer.rs.html">src/sql/plan/optimizer.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -1,8 +1,10 @@
</a> use super::super::schema::Catalog;
<a href="#h2-0-1" id="h2-0-1" class="d">-use super::super::types::Expression;
</a><a href="#h2-0-2" id="h2-0-2" class="i">+use super::super::types::{Expression, Value};
</a> use super::Node;
 use crate::error::Result;
 
<a href="#h2-0-6" id="h2-0-6" class="i">+use std::mem::replace;
</a><a href="#h2-0-7" id="h2-0-7" class="i">+
</a> /// A plan optimizer
 pub trait Optimizer {
     fn optimize(&amp;self, node: Node) -&gt; Result&lt;Node&gt;;
<a href="#h2-1" id="h2-1" class="h">@@ -10,7 +12,6 @@ pub trait Optimizer {
</a> 
 /// A constant folding optimizer, which replaces constant expressions with their evaluated value, to
 /// prevent it from being re-evaluated over and over again during plan execution.
<a href="#h2-1-3" id="h2-1-3" class="d">-/// FIXME Should optimize true and false filters as well.
</a> pub struct ConstantFolder;
 
 impl Optimizer for ConstantFolder {
<a href="#h2-2" id="h2-2" class="h">@@ -37,13 +38,18 @@ impl Optimizer for FilterPushdown {
</a>     fn optimize(&amp;self, node: Node) -&gt; Result&lt;Node&gt; {
         node.transform(
             &amp;|n| match n {
<a href="#h2-2-3" id="h2-2-3" class="d">-                Node::Filter { mut source, predicate: Some(predicate) } =&gt; {
</a><a href="#h2-2-4" id="h2-2-4" class="i">+                Node::Filter { mut source, predicate } =&gt; {
</a>                     // We don&#39;t replace the filter node here, since doing so would cause transform()
                     // to skip the source as it won&#39;t reapply the transform to the &quot;same&quot; node.
<a href="#h2-2-7" id="h2-2-7" class="d">-                    // We leave an empty filter node instead, which will be cleaned up by a separate
</a><a href="#h2-2-8" id="h2-2-8" class="d">-                    // optimizer.
</a><a href="#h2-2-9" id="h2-2-9" class="d">-                    let predicate = self.pushdown(predicate, &amp;mut *source);
</a><a href="#h2-2-10" id="h2-2-10" class="d">-                    Ok(Node::Filter { source, predicate })
</a><a href="#h2-2-11" id="h2-2-11" class="i">+                    // We leave a noop filter node instead, which will be cleaned up by NoopCleaner.
</a><a href="#h2-2-12" id="h2-2-12" class="i">+                    if let Some(remainder) = self.pushdown(predicate, &amp;mut *source) {
</a><a href="#h2-2-13" id="h2-2-13" class="i">+                        Ok(Node::Filter { source, predicate: remainder })
</a><a href="#h2-2-14" id="h2-2-14" class="i">+                    } else {
</a><a href="#h2-2-15" id="h2-2-15" class="i">+                        Ok(Node::Filter {
</a><a href="#h2-2-16" id="h2-2-16" class="i">+                            source,
</a><a href="#h2-2-17" id="h2-2-17" class="i">+                            predicate: Expression::Constant(Value::Boolean(true)),
</a><a href="#h2-2-18" id="h2-2-18" class="i">+                        })
</a><a href="#h2-2-19" id="h2-2-19" class="i">+                    }
</a>                 }
                 Node::NestedLoopJoin {
                     mut outer,
<a href="#h2-3" id="h2-3" class="h">@@ -68,14 +74,23 @@ impl FilterPushdown {
</a>     /// Attempts to push an expression down into a target node, returns any remaining expression.
     fn pushdown(&amp;self, mut expression: Expression, target: &amp;mut Node) -&gt; Option&lt;Expression&gt; {
         match target {
<a href="#h2-3-3" id="h2-3-3" class="d">-            Node::Filter { ref mut predicate, .. }
</a><a href="#h2-3-4" id="h2-3-4" class="d">-            | Node::NestedLoopJoin { ref mut predicate, .. }
</a><a href="#h2-3-5" id="h2-3-5" class="d">-            | Node::Scan { filter: ref mut predicate, .. } =&gt; {
</a><a href="#h2-3-6" id="h2-3-6" class="i">+            Node::Scan { ref mut filter, .. } =&gt; {
</a><a href="#h2-3-7" id="h2-3-7" class="i">+                if let Some(filter) = filter.take() {
</a><a href="#h2-3-8" id="h2-3-8" class="i">+                    expression = Expression::And(Box::new(expression), Box::new(filter))
</a><a href="#h2-3-9" id="h2-3-9" class="i">+                }
</a><a href="#h2-3-10" id="h2-3-10" class="i">+                filter.replace(expression)
</a><a href="#h2-3-11" id="h2-3-11" class="i">+            }
</a><a href="#h2-3-12" id="h2-3-12" class="i">+            Node::NestedLoopJoin { ref mut predicate, .. } =&gt; {
</a>                 if let Some(predicate) = predicate.take() {
                     expression = Expression::And(Box::new(expression), Box::new(predicate));
                 }
                 predicate.replace(expression)
             }
<a href="#h2-3-18" id="h2-3-18" class="i">+            Node::Filter { ref mut predicate, .. } =&gt; {
</a><a href="#h2-3-19" id="h2-3-19" class="i">+                let p = replace(predicate, Expression::Constant(Value::Null));
</a><a href="#h2-3-20" id="h2-3-20" class="i">+                replace(predicate, Expression::And(Box::new(p), Box::new(expression)));
</a><a href="#h2-3-21" id="h2-3-21" class="i">+                None
</a><a href="#h2-3-22" id="h2-3-22" class="i">+            }
</a>             _ =&gt; Some(expression),
         }
     }
<a href="#h2-4" id="h2-4" class="h">@@ -163,7 +178,7 @@ impl&lt;&#39;a, C: Catalog&gt; IndexLookup&lt;&#39;a, C&gt; {
</a>     // Wraps a node in a filter for the given CNF vector, if any, otherwise returns the bare node.
     fn wrap_cnf(&amp;self, node: Node, cnf: Vec&lt;Expression&gt;) -&gt; Node {
         if let Some(predicate) = Expression::from_cnf_vec(cnf) {
<a href="#h2-4-3" id="h2-4-3" class="d">-            Node::Filter { source: Box::new(node), predicate: Some(predicate) }
</a><a href="#h2-4-4" id="h2-4-4" class="i">+            Node::Filter { source: Box::new(node), predicate }
</a>         } else {
             node
         }
<a href="#h2-5" id="h2-5" class="h">@@ -207,3 +222,50 @@ impl&lt;&#39;a, C: Catalog&gt; Optimizer for IndexLookup&lt;&#39;a, C&gt; {
</a>         })
     }
 }
<a href="#h2-5-3" id="h2-5-3" class="i">+
</a><a href="#h2-5-4" id="h2-5-4" class="i">+/// Cleans up noops, e.g. filters with constant true/false predicates.
</a><a href="#h2-5-5" id="h2-5-5" class="i">+/// FIXME This should perhaps replace nodes that can never return anything with a Nothing node,
</a><a href="#h2-5-6" id="h2-5-6" class="i">+/// but that requires propagating the column names.
</a><a href="#h2-5-7" id="h2-5-7" class="i">+pub struct NoopCleaner;
</a><a href="#h2-5-8" id="h2-5-8" class="i">+
</a><a href="#h2-5-9" id="h2-5-9" class="i">+impl Optimizer for NoopCleaner {
</a><a href="#h2-5-10" id="h2-5-10" class="i">+    fn optimize(&amp;self, node: Node) -&gt; Result&lt;Node&gt; {
</a><a href="#h2-5-11" id="h2-5-11" class="i">+        use Expression::*;
</a><a href="#h2-5-12" id="h2-5-12" class="i">+        node.transform(
</a><a href="#h2-5-13" id="h2-5-13" class="i">+            // While descending the node tree, clean up boolean expressions.
</a><a href="#h2-5-14" id="h2-5-14" class="i">+            &amp;|n| {
</a><a href="#h2-5-15" id="h2-5-15" class="i">+                n.transform_expressions(&amp;|e| Ok(e), &amp;|e| match &amp;e {
</a><a href="#h2-5-16" id="h2-5-16" class="i">+                    And(lhs, rhs) =&gt; match (&amp;**lhs, &amp;**rhs) {
</a><a href="#h2-5-17" id="h2-5-17" class="i">+                        (Constant(Value::Boolean(false)), _)
</a><a href="#h2-5-18" id="h2-5-18" class="i">+                        | (Constant(Value::Null), _)
</a><a href="#h2-5-19" id="h2-5-19" class="i">+                        | (_, Constant(Value::Boolean(false)))
</a><a href="#h2-5-20" id="h2-5-20" class="i">+                        | (_, Constant(Value::Null)) =&gt; Ok(Constant(Value::Boolean(false))),
</a><a href="#h2-5-21" id="h2-5-21" class="i">+                        (Constant(Value::Boolean(true)), e)
</a><a href="#h2-5-22" id="h2-5-22" class="i">+                        | (e, Constant(Value::Boolean(true))) =&gt; Ok(e.clone()),
</a><a href="#h2-5-23" id="h2-5-23" class="i">+                        _ =&gt; Ok(e),
</a><a href="#h2-5-24" id="h2-5-24" class="i">+                    },
</a><a href="#h2-5-25" id="h2-5-25" class="i">+                    Or(lhs, rhs) =&gt; match (&amp;**lhs, &amp;**rhs) {
</a><a href="#h2-5-26" id="h2-5-26" class="i">+                        (Constant(Value::Boolean(false)), e)
</a><a href="#h2-5-27" id="h2-5-27" class="i">+                        | (Constant(Value::Null), e)
</a><a href="#h2-5-28" id="h2-5-28" class="i">+                        | (e, Constant(Value::Boolean(false)))
</a><a href="#h2-5-29" id="h2-5-29" class="i">+                        | (e, Constant(Value::Null)) =&gt; Ok(e.clone()),
</a><a href="#h2-5-30" id="h2-5-30" class="i">+                        (Constant(Value::Boolean(true)), _)
</a><a href="#h2-5-31" id="h2-5-31" class="i">+                        | (_, Constant(Value::Boolean(true))) =&gt; Ok(Constant(Value::Boolean(true))),
</a><a href="#h2-5-32" id="h2-5-32" class="i">+                        _ =&gt; Ok(e),
</a><a href="#h2-5-33" id="h2-5-33" class="i">+                    },
</a><a href="#h2-5-34" id="h2-5-34" class="i">+                    // No need to handle Not, constant folder should have evaluated it already.
</a><a href="#h2-5-35" id="h2-5-35" class="i">+                    _ =&gt; Ok(e),
</a><a href="#h2-5-36" id="h2-5-36" class="i">+                })
</a><a href="#h2-5-37" id="h2-5-37" class="i">+            },
</a><a href="#h2-5-38" id="h2-5-38" class="i">+            // While ascending the node tree, remove any unnecessary filters or nodes.
</a><a href="#h2-5-39" id="h2-5-39" class="i">+            // FIXME This should replace scan and join predicates with None as well.
</a><a href="#h2-5-40" id="h2-5-40" class="i">+            &amp;|n| match n {
</a><a href="#h2-5-41" id="h2-5-41" class="i">+                Node::Filter { source, predicate } =&gt; match predicate {
</a><a href="#h2-5-42" id="h2-5-42" class="i">+                    Expression::Constant(Value::Boolean(true)) =&gt; Ok(*source),
</a><a href="#h2-5-43" id="h2-5-43" class="i">+                    predicate =&gt; Ok(Node::Filter { source, predicate }),
</a><a href="#h2-5-44" id="h2-5-44" class="i">+                },
</a><a href="#h2-5-45" id="h2-5-45" class="i">+                n =&gt; Ok(n),
</a><a href="#h2-5-46" id="h2-5-46" class="i">+            },
</a><a href="#h2-5-47" id="h2-5-47" class="i">+        )
</a><a href="#h2-5-48" id="h2-5-48" class="i">+    }
</a><a href="#h2-5-49" id="h2-5-49" class="i">+}
</a><b>diff --git a/<a id="h3" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -137,7 +137,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 if let Some(expr) = r#where {
                     node = Node::Filter {
                         source: Box::new(node),
<a href="#h3-0-3" id="h3-0-3" class="d">-                        predicate: Some(self.build_expression(scope, expr)?),
</a><a href="#h3-0-4" id="h3-0-4" class="i">+                        predicate: self.build_expression(scope, expr)?,
</a>                     };
                 };
 
<a href="#h3-1" id="h3-1" class="h">@@ -188,7 +188,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 if let Some(expr) = having {
                     node = Node::Filter {
                         source: Box::new(node),
<a href="#h3-1-3" id="h3-1-3" class="d">-                        predicate: Some(self.build_expression(scope, expr)?),
</a><a href="#h3-1-4" id="h3-1-4" class="i">+                        predicate: self.build_expression(scope, expr)?,
</a>                     };
                 };
 
<b>diff --git a/<a id="h4" href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a> b/<a href="../file/tests/sql/query/agg_boolean.html">tests/sql/query/agg_boolean</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -100,16 +100,14 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h4-0-3" id="h4-0-3" class="d">-                    predicate: Some(
</a><a href="#h4-0-4" id="h4-0-4" class="d">-                        Not(
</a><a href="#h4-0-5" id="h4-0-5" class="d">-                            IsNull(
</a><a href="#h4-0-6" id="h4-0-6" class="d">-                                Field(
</a><a href="#h4-0-7" id="h4-0-7" class="d">-                                    1,
</a><a href="#h4-0-8" id="h4-0-8" class="d">-                                    Some(
</a><a href="#h4-0-9" id="h4-0-9" class="d">-                                        (
</a><a href="#h4-0-10" id="h4-0-10" class="d">-                                            None,
</a><a href="#h4-0-11" id="h4-0-11" class="d">-                                            &quot;b&quot;,
</a><a href="#h4-0-12" id="h4-0-12" class="d">-                                        ),
</a><a href="#h4-0-13" id="h4-0-13" class="i">+                    predicate: Not(
</a><a href="#h4-0-14" id="h4-0-14" class="i">+                        IsNull(
</a><a href="#h4-0-15" id="h4-0-15" class="i">+                            Field(
</a><a href="#h4-0-16" id="h4-0-16" class="i">+                                1,
</a><a href="#h4-0-17" id="h4-0-17" class="i">+                                Some(
</a><a href="#h4-0-18" id="h4-0-18" class="i">+                                    (
</a><a href="#h4-0-19" id="h4-0-19" class="i">+                                        None,
</a><a href="#h4-0-20" id="h4-0-20" class="i">+                                        &quot;b&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h4-1" id="h4-1" class="h">@@ -231,27 +229,24 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h4-1-3" id="h4-1-3" class="d">-                source: Filter {
</a><a href="#h4-1-4" id="h4-1-4" class="d">-                    source: Scan {
</a><a href="#h4-1-5" id="h4-1-5" class="d">-                        table: &quot;booleans&quot;,
</a><a href="#h4-1-6" id="h4-1-6" class="d">-                        alias: None,
</a><a href="#h4-1-7" id="h4-1-7" class="d">-                        filter: Some(
</a><a href="#h4-1-8" id="h4-1-8" class="d">-                            Not(
</a><a href="#h4-1-9" id="h4-1-9" class="d">-                                IsNull(
</a><a href="#h4-1-10" id="h4-1-10" class="d">-                                    Field(
</a><a href="#h4-1-11" id="h4-1-11" class="d">-                                        1,
</a><a href="#h4-1-12" id="h4-1-12" class="d">-                                        Some(
</a><a href="#h4-1-13" id="h4-1-13" class="d">-                                            (
</a><a href="#h4-1-14" id="h4-1-14" class="d">-                                                None,
</a><a href="#h4-1-15" id="h4-1-15" class="d">-                                                &quot;b&quot;,
</a><a href="#h4-1-16" id="h4-1-16" class="d">-                                            ),
</a><a href="#h4-1-17" id="h4-1-17" class="i">+                source: Scan {
</a><a href="#h4-1-18" id="h4-1-18" class="i">+                    table: &quot;booleans&quot;,
</a><a href="#h4-1-19" id="h4-1-19" class="i">+                    alias: None,
</a><a href="#h4-1-20" id="h4-1-20" class="i">+                    filter: Some(
</a><a href="#h4-1-21" id="h4-1-21" class="i">+                        Not(
</a><a href="#h4-1-22" id="h4-1-22" class="i">+                            IsNull(
</a><a href="#h4-1-23" id="h4-1-23" class="i">+                                Field(
</a><a href="#h4-1-24" id="h4-1-24" class="i">+                                    1,
</a><a href="#h4-1-25" id="h4-1-25" class="i">+                                    Some(
</a><a href="#h4-1-26" id="h4-1-26" class="i">+                                        (
</a><a href="#h4-1-27" id="h4-1-27" class="i">+                                            None,
</a><a href="#h4-1-28" id="h4-1-28" class="i">+                                            &quot;b&quot;,
</a>                                         ),
                                     ),
                                 ),
                             ),
                         ),
<a href="#h4-1-34" id="h4-1-34" class="d">-                    },
</a><a href="#h4-1-35" id="h4-1-35" class="d">-                    predicate: None,
</a><a href="#h4-1-36" id="h4-1-36" class="i">+                    ),
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h5" href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a> b/<a href="../file/tests/sql/query/agg_float.html">tests/sql/query/agg_float</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -100,16 +100,14 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h5-0-3" id="h5-0-3" class="d">-                    predicate: Some(
</a><a href="#h5-0-4" id="h5-0-4" class="d">-                        Not(
</a><a href="#h5-0-5" id="h5-0-5" class="d">-                            IsNull(
</a><a href="#h5-0-6" id="h5-0-6" class="d">-                                Field(
</a><a href="#h5-0-7" id="h5-0-7" class="d">-                                    1,
</a><a href="#h5-0-8" id="h5-0-8" class="d">-                                    Some(
</a><a href="#h5-0-9" id="h5-0-9" class="d">-                                        (
</a><a href="#h5-0-10" id="h5-0-10" class="d">-                                            None,
</a><a href="#h5-0-11" id="h5-0-11" class="d">-                                            &quot;f&quot;,
</a><a href="#h5-0-12" id="h5-0-12" class="d">-                                        ),
</a><a href="#h5-0-13" id="h5-0-13" class="i">+                    predicate: Not(
</a><a href="#h5-0-14" id="h5-0-14" class="i">+                        IsNull(
</a><a href="#h5-0-15" id="h5-0-15" class="i">+                            Field(
</a><a href="#h5-0-16" id="h5-0-16" class="i">+                                1,
</a><a href="#h5-0-17" id="h5-0-17" class="i">+                                Some(
</a><a href="#h5-0-18" id="h5-0-18" class="i">+                                    (
</a><a href="#h5-0-19" id="h5-0-19" class="i">+                                        None,
</a><a href="#h5-0-20" id="h5-0-20" class="i">+                                        &quot;f&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h5-1" id="h5-1" class="h">@@ -231,27 +229,24 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h5-1-3" id="h5-1-3" class="d">-                source: Filter {
</a><a href="#h5-1-4" id="h5-1-4" class="d">-                    source: Scan {
</a><a href="#h5-1-5" id="h5-1-5" class="d">-                        table: &quot;floats&quot;,
</a><a href="#h5-1-6" id="h5-1-6" class="d">-                        alias: None,
</a><a href="#h5-1-7" id="h5-1-7" class="d">-                        filter: Some(
</a><a href="#h5-1-8" id="h5-1-8" class="d">-                            Not(
</a><a href="#h5-1-9" id="h5-1-9" class="d">-                                IsNull(
</a><a href="#h5-1-10" id="h5-1-10" class="d">-                                    Field(
</a><a href="#h5-1-11" id="h5-1-11" class="d">-                                        1,
</a><a href="#h5-1-12" id="h5-1-12" class="d">-                                        Some(
</a><a href="#h5-1-13" id="h5-1-13" class="d">-                                            (
</a><a href="#h5-1-14" id="h5-1-14" class="d">-                                                None,
</a><a href="#h5-1-15" id="h5-1-15" class="d">-                                                &quot;f&quot;,
</a><a href="#h5-1-16" id="h5-1-16" class="d">-                                            ),
</a><a href="#h5-1-17" id="h5-1-17" class="i">+                source: Scan {
</a><a href="#h5-1-18" id="h5-1-18" class="i">+                    table: &quot;floats&quot;,
</a><a href="#h5-1-19" id="h5-1-19" class="i">+                    alias: None,
</a><a href="#h5-1-20" id="h5-1-20" class="i">+                    filter: Some(
</a><a href="#h5-1-21" id="h5-1-21" class="i">+                        Not(
</a><a href="#h5-1-22" id="h5-1-22" class="i">+                            IsNull(
</a><a href="#h5-1-23" id="h5-1-23" class="i">+                                Field(
</a><a href="#h5-1-24" id="h5-1-24" class="i">+                                    1,
</a><a href="#h5-1-25" id="h5-1-25" class="i">+                                    Some(
</a><a href="#h5-1-26" id="h5-1-26" class="i">+                                        (
</a><a href="#h5-1-27" id="h5-1-27" class="i">+                                            None,
</a><a href="#h5-1-28" id="h5-1-28" class="i">+                                            &quot;f&quot;,
</a>                                         ),
                                     ),
                                 ),
                             ),
                         ),
<a href="#h5-1-34" id="h5-1-34" class="d">-                    },
</a><a href="#h5-1-35" id="h5-1-35" class="d">-                    predicate: None,
</a><a href="#h5-1-36" id="h5-1-36" class="i">+                    ),
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h6" href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a> b/<a href="../file/tests/sql/query/agg_integer.html">tests/sql/query/agg_integer</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -100,16 +100,14 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h6-0-3" id="h6-0-3" class="d">-                    predicate: Some(
</a><a href="#h6-0-4" id="h6-0-4" class="d">-                        Not(
</a><a href="#h6-0-5" id="h6-0-5" class="d">-                            IsNull(
</a><a href="#h6-0-6" id="h6-0-6" class="d">-                                Field(
</a><a href="#h6-0-7" id="h6-0-7" class="d">-                                    1,
</a><a href="#h6-0-8" id="h6-0-8" class="d">-                                    Some(
</a><a href="#h6-0-9" id="h6-0-9" class="d">-                                        (
</a><a href="#h6-0-10" id="h6-0-10" class="d">-                                            None,
</a><a href="#h6-0-11" id="h6-0-11" class="d">-                                            &quot;i&quot;,
</a><a href="#h6-0-12" id="h6-0-12" class="d">-                                        ),
</a><a href="#h6-0-13" id="h6-0-13" class="i">+                    predicate: Not(
</a><a href="#h6-0-14" id="h6-0-14" class="i">+                        IsNull(
</a><a href="#h6-0-15" id="h6-0-15" class="i">+                            Field(
</a><a href="#h6-0-16" id="h6-0-16" class="i">+                                1,
</a><a href="#h6-0-17" id="h6-0-17" class="i">+                                Some(
</a><a href="#h6-0-18" id="h6-0-18" class="i">+                                    (
</a><a href="#h6-0-19" id="h6-0-19" class="i">+                                        None,
</a><a href="#h6-0-20" id="h6-0-20" class="i">+                                        &quot;i&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h6-1" id="h6-1" class="h">@@ -231,27 +229,24 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h6-1-3" id="h6-1-3" class="d">-                source: Filter {
</a><a href="#h6-1-4" id="h6-1-4" class="d">-                    source: Scan {
</a><a href="#h6-1-5" id="h6-1-5" class="d">-                        table: &quot;integers&quot;,
</a><a href="#h6-1-6" id="h6-1-6" class="d">-                        alias: None,
</a><a href="#h6-1-7" id="h6-1-7" class="d">-                        filter: Some(
</a><a href="#h6-1-8" id="h6-1-8" class="d">-                            Not(
</a><a href="#h6-1-9" id="h6-1-9" class="d">-                                IsNull(
</a><a href="#h6-1-10" id="h6-1-10" class="d">-                                    Field(
</a><a href="#h6-1-11" id="h6-1-11" class="d">-                                        1,
</a><a href="#h6-1-12" id="h6-1-12" class="d">-                                        Some(
</a><a href="#h6-1-13" id="h6-1-13" class="d">-                                            (
</a><a href="#h6-1-14" id="h6-1-14" class="d">-                                                None,
</a><a href="#h6-1-15" id="h6-1-15" class="d">-                                                &quot;i&quot;,
</a><a href="#h6-1-16" id="h6-1-16" class="d">-                                            ),
</a><a href="#h6-1-17" id="h6-1-17" class="i">+                source: Scan {
</a><a href="#h6-1-18" id="h6-1-18" class="i">+                    table: &quot;integers&quot;,
</a><a href="#h6-1-19" id="h6-1-19" class="i">+                    alias: None,
</a><a href="#h6-1-20" id="h6-1-20" class="i">+                    filter: Some(
</a><a href="#h6-1-21" id="h6-1-21" class="i">+                        Not(
</a><a href="#h6-1-22" id="h6-1-22" class="i">+                            IsNull(
</a><a href="#h6-1-23" id="h6-1-23" class="i">+                                Field(
</a><a href="#h6-1-24" id="h6-1-24" class="i">+                                    1,
</a><a href="#h6-1-25" id="h6-1-25" class="i">+                                    Some(
</a><a href="#h6-1-26" id="h6-1-26" class="i">+                                        (
</a><a href="#h6-1-27" id="h6-1-27" class="i">+                                            None,
</a><a href="#h6-1-28" id="h6-1-28" class="i">+                                            &quot;i&quot;,
</a>                                         ),
                                     ),
                                 ),
                             ),
                         ),
<a href="#h6-1-34" id="h6-1-34" class="d">-                    },
</a><a href="#h6-1-35" id="h6-1-35" class="d">-                    predicate: None,
</a><a href="#h6-1-36" id="h6-1-36" class="i">+                    ),
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h7" href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a> b/<a href="../file/tests/sql/query/agg_norows.html">tests/sql/query/agg_norows</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -93,11 +93,9 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h7-0-3" id="h7-0-3" class="d">-                    predicate: Some(
</a><a href="#h7-0-4" id="h7-0-4" class="d">-                        Constant(
</a><a href="#h7-0-5" id="h7-0-5" class="d">-                            Boolean(
</a><a href="#h7-0-6" id="h7-0-6" class="d">-                                false,
</a><a href="#h7-0-7" id="h7-0-7" class="d">-                            ),
</a><a href="#h7-0-8" id="h7-0-8" class="i">+                    predicate: Constant(
</a><a href="#h7-0-9" id="h7-0-9" class="i">+                        Boolean(
</a><a href="#h7-0-10" id="h7-0-10" class="i">+                            false,
</a>                         ),
                     ),
                 },
<a href="#h7-1" id="h7-1" class="h">@@ -216,19 +214,16 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h7-1-3" id="h7-1-3" class="d">-                source: Filter {
</a><a href="#h7-1-4" id="h7-1-4" class="d">-                    source: Scan {
</a><a href="#h7-1-5" id="h7-1-5" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h7-1-6" id="h7-1-6" class="d">-                        alias: None,
</a><a href="#h7-1-7" id="h7-1-7" class="d">-                        filter: Some(
</a><a href="#h7-1-8" id="h7-1-8" class="d">-                            Constant(
</a><a href="#h7-1-9" id="h7-1-9" class="d">-                                Boolean(
</a><a href="#h7-1-10" id="h7-1-10" class="d">-                                    false,
</a><a href="#h7-1-11" id="h7-1-11" class="d">-                                ),
</a><a href="#h7-1-12" id="h7-1-12" class="i">+                source: Scan {
</a><a href="#h7-1-13" id="h7-1-13" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h7-1-14" id="h7-1-14" class="i">+                    alias: None,
</a><a href="#h7-1-15" id="h7-1-15" class="i">+                    filter: Some(
</a><a href="#h7-1-16" id="h7-1-16" class="i">+                        Constant(
</a><a href="#h7-1-17" id="h7-1-17" class="i">+                            Boolean(
</a><a href="#h7-1-18" id="h7-1-18" class="i">+                                false,
</a>                             ),
                         ),
<a href="#h7-1-21" id="h7-1-21" class="d">-                    },
</a><a href="#h7-1-22" id="h7-1-22" class="d">-                    predicate: None,
</a><a href="#h7-1-23" id="h7-1-23" class="i">+                    ),
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h8" href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a> b/<a href="../file/tests/sql/query/agg_norows_group.html">tests/sql/query/agg_norows_group</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -98,11 +98,9 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h8-0-3" id="h8-0-3" class="d">-                    predicate: Some(
</a><a href="#h8-0-4" id="h8-0-4" class="d">-                        Constant(
</a><a href="#h8-0-5" id="h8-0-5" class="d">-                            Boolean(
</a><a href="#h8-0-6" id="h8-0-6" class="d">-                                false,
</a><a href="#h8-0-7" id="h8-0-7" class="d">-                            ),
</a><a href="#h8-0-8" id="h8-0-8" class="i">+                    predicate: Constant(
</a><a href="#h8-0-9" id="h8-0-9" class="i">+                        Boolean(
</a><a href="#h8-0-10" id="h8-0-10" class="i">+                            false,
</a>                         ),
                     ),
                 },
<a href="#h8-1" id="h8-1" class="h">@@ -233,19 +231,16 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h8-1-3" id="h8-1-3" class="d">-                source: Filter {
</a><a href="#h8-1-4" id="h8-1-4" class="d">-                    source: Scan {
</a><a href="#h8-1-5" id="h8-1-5" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h8-1-6" id="h8-1-6" class="d">-                        alias: None,
</a><a href="#h8-1-7" id="h8-1-7" class="d">-                        filter: Some(
</a><a href="#h8-1-8" id="h8-1-8" class="d">-                            Constant(
</a><a href="#h8-1-9" id="h8-1-9" class="d">-                                Boolean(
</a><a href="#h8-1-10" id="h8-1-10" class="d">-                                    false,
</a><a href="#h8-1-11" id="h8-1-11" class="d">-                                ),
</a><a href="#h8-1-12" id="h8-1-12" class="i">+                source: Scan {
</a><a href="#h8-1-13" id="h8-1-13" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h8-1-14" id="h8-1-14" class="i">+                    alias: None,
</a><a href="#h8-1-15" id="h8-1-15" class="i">+                    filter: Some(
</a><a href="#h8-1-16" id="h8-1-16" class="i">+                        Constant(
</a><a href="#h8-1-17" id="h8-1-17" class="i">+                            Boolean(
</a><a href="#h8-1-18" id="h8-1-18" class="i">+                                false,
</a>                             ),
                         ),
<a href="#h8-1-21" id="h8-1-21" class="d">-                    },
</a><a href="#h8-1-22" id="h8-1-22" class="d">-                    predicate: None,
</a><a href="#h8-1-23" id="h8-1-23" class="i">+                    ),
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h9" href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a> b/<a href="../file/tests/sql/query/agg_string.html">tests/sql/query/agg_string</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -100,16 +100,14 @@ Plan: Plan(
</a>                         alias: None,
                         filter: None,
                     },
<a href="#h9-0-3" id="h9-0-3" class="d">-                    predicate: Some(
</a><a href="#h9-0-4" id="h9-0-4" class="d">-                        Not(
</a><a href="#h9-0-5" id="h9-0-5" class="d">-                            IsNull(
</a><a href="#h9-0-6" id="h9-0-6" class="d">-                                Field(
</a><a href="#h9-0-7" id="h9-0-7" class="d">-                                    1,
</a><a href="#h9-0-8" id="h9-0-8" class="d">-                                    Some(
</a><a href="#h9-0-9" id="h9-0-9" class="d">-                                        (
</a><a href="#h9-0-10" id="h9-0-10" class="d">-                                            None,
</a><a href="#h9-0-11" id="h9-0-11" class="d">-                                            &quot;s&quot;,
</a><a href="#h9-0-12" id="h9-0-12" class="d">-                                        ),
</a><a href="#h9-0-13" id="h9-0-13" class="i">+                    predicate: Not(
</a><a href="#h9-0-14" id="h9-0-14" class="i">+                        IsNull(
</a><a href="#h9-0-15" id="h9-0-15" class="i">+                            Field(
</a><a href="#h9-0-16" id="h9-0-16" class="i">+                                1,
</a><a href="#h9-0-17" id="h9-0-17" class="i">+                                Some(
</a><a href="#h9-0-18" id="h9-0-18" class="i">+                                    (
</a><a href="#h9-0-19" id="h9-0-19" class="i">+                                        None,
</a><a href="#h9-0-20" id="h9-0-20" class="i">+                                        &quot;s&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h9-1" id="h9-1" class="h">@@ -231,27 +229,24 @@ Optimized plan: Plan(
</a>     Projection {
         source: Aggregation {
             source: Projection {
<a href="#h9-1-3" id="h9-1-3" class="d">-                source: Filter {
</a><a href="#h9-1-4" id="h9-1-4" class="d">-                    source: Scan {
</a><a href="#h9-1-5" id="h9-1-5" class="d">-                        table: &quot;strings&quot;,
</a><a href="#h9-1-6" id="h9-1-6" class="d">-                        alias: None,
</a><a href="#h9-1-7" id="h9-1-7" class="d">-                        filter: Some(
</a><a href="#h9-1-8" id="h9-1-8" class="d">-                            Not(
</a><a href="#h9-1-9" id="h9-1-9" class="d">-                                IsNull(
</a><a href="#h9-1-10" id="h9-1-10" class="d">-                                    Field(
</a><a href="#h9-1-11" id="h9-1-11" class="d">-                                        1,
</a><a href="#h9-1-12" id="h9-1-12" class="d">-                                        Some(
</a><a href="#h9-1-13" id="h9-1-13" class="d">-                                            (
</a><a href="#h9-1-14" id="h9-1-14" class="d">-                                                None,
</a><a href="#h9-1-15" id="h9-1-15" class="d">-                                                &quot;s&quot;,
</a><a href="#h9-1-16" id="h9-1-16" class="d">-                                            ),
</a><a href="#h9-1-17" id="h9-1-17" class="i">+                source: Scan {
</a><a href="#h9-1-18" id="h9-1-18" class="i">+                    table: &quot;strings&quot;,
</a><a href="#h9-1-19" id="h9-1-19" class="i">+                    alias: None,
</a><a href="#h9-1-20" id="h9-1-20" class="i">+                    filter: Some(
</a><a href="#h9-1-21" id="h9-1-21" class="i">+                        Not(
</a><a href="#h9-1-22" id="h9-1-22" class="i">+                            IsNull(
</a><a href="#h9-1-23" id="h9-1-23" class="i">+                                Field(
</a><a href="#h9-1-24" id="h9-1-24" class="i">+                                    1,
</a><a href="#h9-1-25" id="h9-1-25" class="i">+                                    Some(
</a><a href="#h9-1-26" id="h9-1-26" class="i">+                                        (
</a><a href="#h9-1-27" id="h9-1-27" class="i">+                                            None,
</a><a href="#h9-1-28" id="h9-1-28" class="i">+                                            &quot;s&quot;,
</a>                                         ),
                                     ),
                                 ),
                             ),
                         ),
<a href="#h9-1-34" id="h9-1-34" class="d">-                    },
</a><a href="#h9-1-35" id="h9-1-35" class="d">-                    predicate: None,
</a><a href="#h9-1-36" id="h9-1-36" class="i">+                    ),
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h10" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -126,16 +126,14 @@ Plan: Plan(
</a>                     ),
                 ],
             },
<a href="#h10-0-3" id="h10-0-3" class="d">-            predicate: Some(
</a><a href="#h10-0-4" id="h10-0-4" class="d">-                GreaterThan(
</a><a href="#h10-0-5" id="h10-0-5" class="d">-                    Field(
</a><a href="#h10-0-6" id="h10-0-6" class="d">-                        1,
</a><a href="#h10-0-7" id="h10-0-7" class="d">-                        None,
</a><a href="#h10-0-8" id="h10-0-8" class="d">-                    ),
</a><a href="#h10-0-9" id="h10-0-9" class="d">-                    Constant(
</a><a href="#h10-0-10" id="h10-0-10" class="d">-                        Integer(
</a><a href="#h10-0-11" id="h10-0-11" class="d">-                            8,
</a><a href="#h10-0-12" id="h10-0-12" class="d">-                        ),
</a><a href="#h10-0-13" id="h10-0-13" class="i">+            predicate: GreaterThan(
</a><a href="#h10-0-14" id="h10-0-14" class="i">+                Field(
</a><a href="#h10-0-15" id="h10-0-15" class="i">+                    1,
</a><a href="#h10-0-16" id="h10-0-16" class="i">+                    None,
</a><a href="#h10-0-17" id="h10-0-17" class="i">+                ),
</a><a href="#h10-0-18" id="h10-0-18" class="i">+                Constant(
</a><a href="#h10-0-19" id="h10-0-19" class="i">+                    Integer(
</a><a href="#h10-0-20" id="h10-0-20" class="i">+                        8,
</a>                     ),
                 ),
             ),
<a href="#h10-1" id="h10-1" class="h">@@ -213,16 +211,14 @@ Optimized plan: Plan(
</a>                     ),
                 ],
             },
<a href="#h10-1-3" id="h10-1-3" class="d">-            predicate: Some(
</a><a href="#h10-1-4" id="h10-1-4" class="d">-                GreaterThan(
</a><a href="#h10-1-5" id="h10-1-5" class="d">-                    Field(
</a><a href="#h10-1-6" id="h10-1-6" class="d">-                        1,
</a><a href="#h10-1-7" id="h10-1-7" class="d">-                        None,
</a><a href="#h10-1-8" id="h10-1-8" class="d">-                    ),
</a><a href="#h10-1-9" id="h10-1-9" class="d">-                    Constant(
</a><a href="#h10-1-10" id="h10-1-10" class="d">-                        Integer(
</a><a href="#h10-1-11" id="h10-1-11" class="d">-                            8,
</a><a href="#h10-1-12" id="h10-1-12" class="d">-                        ),
</a><a href="#h10-1-13" id="h10-1-13" class="i">+            predicate: GreaterThan(
</a><a href="#h10-1-14" id="h10-1-14" class="i">+                Field(
</a><a href="#h10-1-15" id="h10-1-15" class="i">+                    1,
</a><a href="#h10-1-16" id="h10-1-16" class="i">+                    None,
</a><a href="#h10-1-17" id="h10-1-17" class="i">+                ),
</a><a href="#h10-1-18" id="h10-1-18" class="i">+                Constant(
</a><a href="#h10-1-19" id="h10-1-19" class="i">+                    Integer(
</a><a href="#h10-1-20" id="h10-1-20" class="i">+                        8,
</a>                     ),
                 ),
             ),
<b>diff --git a/<a id="h11" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -148,16 +148,14 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h11-0-3" id="h11-0-3" class="d">-                predicate: Some(
</a><a href="#h11-0-4" id="h11-0-4" class="d">-                    GreaterThan(
</a><a href="#h11-0-5" id="h11-0-5" class="d">-                        Field(
</a><a href="#h11-0-6" id="h11-0-6" class="d">-                            2,
</a><a href="#h11-0-7" id="h11-0-7" class="d">-                            None,
</a><a href="#h11-0-8" id="h11-0-8" class="d">-                        ),
</a><a href="#h11-0-9" id="h11-0-9" class="d">-                        Constant(
</a><a href="#h11-0-10" id="h11-0-10" class="d">-                            Integer(
</a><a href="#h11-0-11" id="h11-0-11" class="d">-                                7,
</a><a href="#h11-0-12" id="h11-0-12" class="d">-                            ),
</a><a href="#h11-0-13" id="h11-0-13" class="i">+                predicate: GreaterThan(
</a><a href="#h11-0-14" id="h11-0-14" class="i">+                    Field(
</a><a href="#h11-0-15" id="h11-0-15" class="i">+                        2,
</a><a href="#h11-0-16" id="h11-0-16" class="i">+                        None,
</a><a href="#h11-0-17" id="h11-0-17" class="i">+                    ),
</a><a href="#h11-0-18" id="h11-0-18" class="i">+                    Constant(
</a><a href="#h11-0-19" id="h11-0-19" class="i">+                        Integer(
</a><a href="#h11-0-20" id="h11-0-20" class="i">+                            7,
</a>                         ),
                     ),
                 ),
<a href="#h11-1" id="h11-1" class="h">@@ -271,16 +269,14 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h11-1-3" id="h11-1-3" class="d">-                predicate: Some(
</a><a href="#h11-1-4" id="h11-1-4" class="d">-                    GreaterThan(
</a><a href="#h11-1-5" id="h11-1-5" class="d">-                        Field(
</a><a href="#h11-1-6" id="h11-1-6" class="d">-                            2,
</a><a href="#h11-1-7" id="h11-1-7" class="d">-                            None,
</a><a href="#h11-1-8" id="h11-1-8" class="d">-                        ),
</a><a href="#h11-1-9" id="h11-1-9" class="d">-                        Constant(
</a><a href="#h11-1-10" id="h11-1-10" class="d">-                            Integer(
</a><a href="#h11-1-11" id="h11-1-11" class="d">-                                7,
</a><a href="#h11-1-12" id="h11-1-12" class="d">-                            ),
</a><a href="#h11-1-13" id="h11-1-13" class="i">+                predicate: GreaterThan(
</a><a href="#h11-1-14" id="h11-1-14" class="i">+                    Field(
</a><a href="#h11-1-15" id="h11-1-15" class="i">+                        2,
</a><a href="#h11-1-16" id="h11-1-16" class="i">+                        None,
</a><a href="#h11-1-17" id="h11-1-17" class="i">+                    ),
</a><a href="#h11-1-18" id="h11-1-18" class="i">+                    Constant(
</a><a href="#h11-1-19" id="h11-1-19" class="i">+                        Integer(
</a><a href="#h11-1-20" id="h11-1-20" class="i">+                            7,
</a>                         ),
                     ),
                 ),
<b>diff --git a/<a id="h12" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -181,22 +181,20 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h12-0-3" id="h12-0-3" class="d">-                predicate: Some(
</a><a href="#h12-0-4" id="h12-0-4" class="d">-                    LessThan(
</a><a href="#h12-0-5" id="h12-0-5" class="d">-                        Subtract(
</a><a href="#h12-0-6" id="h12-0-6" class="d">-                            Field(
</a><a href="#h12-0-7" id="h12-0-7" class="d">-                                2,
</a><a href="#h12-0-8" id="h12-0-8" class="d">-                                None,
</a><a href="#h12-0-9" id="h12-0-9" class="d">-                            ),
</a><a href="#h12-0-10" id="h12-0-10" class="d">-                            Field(
</a><a href="#h12-0-11" id="h12-0-11" class="d">-                                3,
</a><a href="#h12-0-12" id="h12-0-12" class="d">-                                None,
</a><a href="#h12-0-13" id="h12-0-13" class="d">-                            ),
</a><a href="#h12-0-14" id="h12-0-14" class="i">+                predicate: LessThan(
</a><a href="#h12-0-15" id="h12-0-15" class="i">+                    Subtract(
</a><a href="#h12-0-16" id="h12-0-16" class="i">+                        Field(
</a><a href="#h12-0-17" id="h12-0-17" class="i">+                            2,
</a><a href="#h12-0-18" id="h12-0-18" class="i">+                            None,
</a>                         ),
<a href="#h12-0-20" id="h12-0-20" class="d">-                        Constant(
</a><a href="#h12-0-21" id="h12-0-21" class="d">-                            Integer(
</a><a href="#h12-0-22" id="h12-0-22" class="d">-                                1,
</a><a href="#h12-0-23" id="h12-0-23" class="d">-                            ),
</a><a href="#h12-0-24" id="h12-0-24" class="i">+                        Field(
</a><a href="#h12-0-25" id="h12-0-25" class="i">+                            3,
</a><a href="#h12-0-26" id="h12-0-26" class="i">+                            None,
</a><a href="#h12-0-27" id="h12-0-27" class="i">+                        ),
</a><a href="#h12-0-28" id="h12-0-28" class="i">+                    ),
</a><a href="#h12-0-29" id="h12-0-29" class="i">+                    Constant(
</a><a href="#h12-0-30" id="h12-0-30" class="i">+                        Integer(
</a><a href="#h12-0-31" id="h12-0-31" class="i">+                            1,
</a>                         ),
                     ),
                 ),
<a href="#h12-1" id="h12-1" class="h">@@ -330,22 +328,20 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h12-1-3" id="h12-1-3" class="d">-                predicate: Some(
</a><a href="#h12-1-4" id="h12-1-4" class="d">-                    LessThan(
</a><a href="#h12-1-5" id="h12-1-5" class="d">-                        Subtract(
</a><a href="#h12-1-6" id="h12-1-6" class="d">-                            Field(
</a><a href="#h12-1-7" id="h12-1-7" class="d">-                                2,
</a><a href="#h12-1-8" id="h12-1-8" class="d">-                                None,
</a><a href="#h12-1-9" id="h12-1-9" class="d">-                            ),
</a><a href="#h12-1-10" id="h12-1-10" class="d">-                            Field(
</a><a href="#h12-1-11" id="h12-1-11" class="d">-                                3,
</a><a href="#h12-1-12" id="h12-1-12" class="d">-                                None,
</a><a href="#h12-1-13" id="h12-1-13" class="d">-                            ),
</a><a href="#h12-1-14" id="h12-1-14" class="i">+                predicate: LessThan(
</a><a href="#h12-1-15" id="h12-1-15" class="i">+                    Subtract(
</a><a href="#h12-1-16" id="h12-1-16" class="i">+                        Field(
</a><a href="#h12-1-17" id="h12-1-17" class="i">+                            2,
</a><a href="#h12-1-18" id="h12-1-18" class="i">+                            None,
</a>                         ),
<a href="#h12-1-20" id="h12-1-20" class="d">-                        Constant(
</a><a href="#h12-1-21" id="h12-1-21" class="d">-                            Integer(
</a><a href="#h12-1-22" id="h12-1-22" class="d">-                                1,
</a><a href="#h12-1-23" id="h12-1-23" class="d">-                            ),
</a><a href="#h12-1-24" id="h12-1-24" class="i">+                        Field(
</a><a href="#h12-1-25" id="h12-1-25" class="i">+                            3,
</a><a href="#h12-1-26" id="h12-1-26" class="i">+                            None,
</a><a href="#h12-1-27" id="h12-1-27" class="i">+                        ),
</a><a href="#h12-1-28" id="h12-1-28" class="i">+                    ),
</a><a href="#h12-1-29" id="h12-1-29" class="i">+                    Constant(
</a><a href="#h12-1-30" id="h12-1-30" class="i">+                        Integer(
</a><a href="#h12-1-31" id="h12-1-31" class="i">+                            1,
</a>                         ),
                     ),
                 ),
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -139,28 +139,26 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h13-0-3" id="h13-0-3" class="d">-                predicate: Some(
</a><a href="#h13-0-4" id="h13-0-4" class="d">-                    Or(
</a><a href="#h13-0-5" id="h13-0-5" class="d">-                        GreaterThan(
</a><a href="#h13-0-6" id="h13-0-6" class="d">-                            Field(
</a><a href="#h13-0-7" id="h13-0-7" class="d">-                                2,
</a><a href="#h13-0-8" id="h13-0-8" class="d">-                                None,
</a><a href="#h13-0-9" id="h13-0-9" class="d">-                            ),
</a><a href="#h13-0-10" id="h13-0-10" class="d">-                            Constant(
</a><a href="#h13-0-11" id="h13-0-11" class="d">-                                Integer(
</a><a href="#h13-0-12" id="h13-0-12" class="d">-                                    3,
</a><a href="#h13-0-13" id="h13-0-13" class="d">-                                ),
</a><a href="#h13-0-14" id="h13-0-14" class="d">-                            ),
</a><a href="#h13-0-15" id="h13-0-15" class="i">+                predicate: Or(
</a><a href="#h13-0-16" id="h13-0-16" class="i">+                    GreaterThan(
</a><a href="#h13-0-17" id="h13-0-17" class="i">+                        Field(
</a><a href="#h13-0-18" id="h13-0-18" class="i">+                            2,
</a><a href="#h13-0-19" id="h13-0-19" class="i">+                            None,
</a>                         ),
<a href="#h13-0-21" id="h13-0-21" class="d">-                        Equal(
</a><a href="#h13-0-22" id="h13-0-22" class="d">-                            Field(
</a><a href="#h13-0-23" id="h13-0-23" class="d">-                                2,
</a><a href="#h13-0-24" id="h13-0-24" class="d">-                                None,
</a><a href="#h13-0-25" id="h13-0-25" class="i">+                        Constant(
</a><a href="#h13-0-26" id="h13-0-26" class="i">+                            Integer(
</a><a href="#h13-0-27" id="h13-0-27" class="i">+                                3,
</a>                             ),
<a href="#h13-0-29" id="h13-0-29" class="d">-                            Constant(
</a><a href="#h13-0-30" id="h13-0-30" class="d">-                                Integer(
</a><a href="#h13-0-31" id="h13-0-31" class="d">-                                    3,
</a><a href="#h13-0-32" id="h13-0-32" class="d">-                                ),
</a><a href="#h13-0-33" id="h13-0-33" class="i">+                        ),
</a><a href="#h13-0-34" id="h13-0-34" class="i">+                    ),
</a><a href="#h13-0-35" id="h13-0-35" class="i">+                    Equal(
</a><a href="#h13-0-36" id="h13-0-36" class="i">+                        Field(
</a><a href="#h13-0-37" id="h13-0-37" class="i">+                            2,
</a><a href="#h13-0-38" id="h13-0-38" class="i">+                            None,
</a><a href="#h13-0-39" id="h13-0-39" class="i">+                        ),
</a><a href="#h13-0-40" id="h13-0-40" class="i">+                        Constant(
</a><a href="#h13-0-41" id="h13-0-41" class="i">+                            Integer(
</a><a href="#h13-0-42" id="h13-0-42" class="i">+                                3,
</a>                             ),
                         ),
                     ),
<a href="#h13-1" id="h13-1" class="h">@@ -269,28 +267,26 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h13-1-3" id="h13-1-3" class="d">-                predicate: Some(
</a><a href="#h13-1-4" id="h13-1-4" class="d">-                    Or(
</a><a href="#h13-1-5" id="h13-1-5" class="d">-                        GreaterThan(
</a><a href="#h13-1-6" id="h13-1-6" class="d">-                            Field(
</a><a href="#h13-1-7" id="h13-1-7" class="d">-                                2,
</a><a href="#h13-1-8" id="h13-1-8" class="d">-                                None,
</a><a href="#h13-1-9" id="h13-1-9" class="d">-                            ),
</a><a href="#h13-1-10" id="h13-1-10" class="d">-                            Constant(
</a><a href="#h13-1-11" id="h13-1-11" class="d">-                                Integer(
</a><a href="#h13-1-12" id="h13-1-12" class="d">-                                    3,
</a><a href="#h13-1-13" id="h13-1-13" class="d">-                                ),
</a><a href="#h13-1-14" id="h13-1-14" class="d">-                            ),
</a><a href="#h13-1-15" id="h13-1-15" class="i">+                predicate: Or(
</a><a href="#h13-1-16" id="h13-1-16" class="i">+                    GreaterThan(
</a><a href="#h13-1-17" id="h13-1-17" class="i">+                        Field(
</a><a href="#h13-1-18" id="h13-1-18" class="i">+                            2,
</a><a href="#h13-1-19" id="h13-1-19" class="i">+                            None,
</a>                         ),
<a href="#h13-1-21" id="h13-1-21" class="d">-                        Equal(
</a><a href="#h13-1-22" id="h13-1-22" class="d">-                            Field(
</a><a href="#h13-1-23" id="h13-1-23" class="d">-                                2,
</a><a href="#h13-1-24" id="h13-1-24" class="d">-                                None,
</a><a href="#h13-1-25" id="h13-1-25" class="i">+                        Constant(
</a><a href="#h13-1-26" id="h13-1-26" class="i">+                            Integer(
</a><a href="#h13-1-27" id="h13-1-27" class="i">+                                3,
</a>                             ),
<a href="#h13-1-29" id="h13-1-29" class="d">-                            Constant(
</a><a href="#h13-1-30" id="h13-1-30" class="d">-                                Integer(
</a><a href="#h13-1-31" id="h13-1-31" class="d">-                                    3,
</a><a href="#h13-1-32" id="h13-1-32" class="d">-                                ),
</a><a href="#h13-1-33" id="h13-1-33" class="i">+                        ),
</a><a href="#h13-1-34" id="h13-1-34" class="i">+                    ),
</a><a href="#h13-1-35" id="h13-1-35" class="i">+                    Equal(
</a><a href="#h13-1-36" id="h13-1-36" class="i">+                        Field(
</a><a href="#h13-1-37" id="h13-1-37" class="i">+                            2,
</a><a href="#h13-1-38" id="h13-1-38" class="i">+                            None,
</a><a href="#h13-1-39" id="h13-1-39" class="i">+                        ),
</a><a href="#h13-1-40" id="h13-1-40" class="i">+                        Constant(
</a><a href="#h13-1-41" id="h13-1-41" class="i">+                            Integer(
</a><a href="#h13-1-42" id="h13-1-42" class="i">+                                3,
</a>                             ),
                         ),
                     ),
<b>diff --git a/<a id="h14" href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a> b/<a href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -102,16 +102,14 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h14-0-3" id="h14-0-3" class="d">-                predicate: Some(
</a><a href="#h14-0-4" id="h14-0-4" class="d">-                    GreaterThan(
</a><a href="#h14-0-5" id="h14-0-5" class="d">-                        Field(
</a><a href="#h14-0-6" id="h14-0-6" class="d">-                            2,
</a><a href="#h14-0-7" id="h14-0-7" class="d">-                            None,
</a><a href="#h14-0-8" id="h14-0-8" class="d">-                        ),
</a><a href="#h14-0-9" id="h14-0-9" class="d">-                        Constant(
</a><a href="#h14-0-10" id="h14-0-10" class="d">-                            Integer(
</a><a href="#h14-0-11" id="h14-0-11" class="d">-                                8,
</a><a href="#h14-0-12" id="h14-0-12" class="d">-                            ),
</a><a href="#h14-0-13" id="h14-0-13" class="i">+                predicate: GreaterThan(
</a><a href="#h14-0-14" id="h14-0-14" class="i">+                    Field(
</a><a href="#h14-0-15" id="h14-0-15" class="i">+                        2,
</a><a href="#h14-0-16" id="h14-0-16" class="i">+                        None,
</a><a href="#h14-0-17" id="h14-0-17" class="i">+                    ),
</a><a href="#h14-0-18" id="h14-0-18" class="i">+                    Constant(
</a><a href="#h14-0-19" id="h14-0-19" class="i">+                        Integer(
</a><a href="#h14-0-20" id="h14-0-20" class="i">+                            8,
</a>                         ),
                     ),
                 ),
<a href="#h14-1" id="h14-1" class="h">@@ -194,16 +192,14 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h14-1-3" id="h14-1-3" class="d">-                predicate: Some(
</a><a href="#h14-1-4" id="h14-1-4" class="d">-                    GreaterThan(
</a><a href="#h14-1-5" id="h14-1-5" class="d">-                        Field(
</a><a href="#h14-1-6" id="h14-1-6" class="d">-                            2,
</a><a href="#h14-1-7" id="h14-1-7" class="d">-                            None,
</a><a href="#h14-1-8" id="h14-1-8" class="d">-                        ),
</a><a href="#h14-1-9" id="h14-1-9" class="d">-                        Constant(
</a><a href="#h14-1-10" id="h14-1-10" class="d">-                            Integer(
</a><a href="#h14-1-11" id="h14-1-11" class="d">-                                8,
</a><a href="#h14-1-12" id="h14-1-12" class="d">-                            ),
</a><a href="#h14-1-13" id="h14-1-13" class="i">+                predicate: GreaterThan(
</a><a href="#h14-1-14" id="h14-1-14" class="i">+                    Field(
</a><a href="#h14-1-15" id="h14-1-15" class="i">+                        2,
</a><a href="#h14-1-16" id="h14-1-16" class="i">+                        None,
</a><a href="#h14-1-17" id="h14-1-17" class="i">+                    ),
</a><a href="#h14-1-18" id="h14-1-18" class="i">+                    Constant(
</a><a href="#h14-1-19" id="h14-1-19" class="i">+                        Integer(
</a><a href="#h14-1-20" id="h14-1-20" class="i">+                            8,
</a>                         ),
                     ),
                 ),
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -116,16 +116,14 @@ Plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h15-0-3" id="h15-0-3" class="d">-                predicate: Some(
</a><a href="#h15-0-4" id="h15-0-4" class="d">-                    GreaterThan(
</a><a href="#h15-0-5" id="h15-0-5" class="d">-                        Field(
</a><a href="#h15-0-6" id="h15-0-6" class="d">-                            1,
</a><a href="#h15-0-7" id="h15-0-7" class="d">-                            None,
</a><a href="#h15-0-8" id="h15-0-8" class="d">-                        ),
</a><a href="#h15-0-9" id="h15-0-9" class="d">-                        Constant(
</a><a href="#h15-0-10" id="h15-0-10" class="d">-                            Integer(
</a><a href="#h15-0-11" id="h15-0-11" class="d">-                                8,
</a><a href="#h15-0-12" id="h15-0-12" class="d">-                            ),
</a><a href="#h15-0-13" id="h15-0-13" class="i">+                predicate: GreaterThan(
</a><a href="#h15-0-14" id="h15-0-14" class="i">+                    Field(
</a><a href="#h15-0-15" id="h15-0-15" class="i">+                        1,
</a><a href="#h15-0-16" id="h15-0-16" class="i">+                        None,
</a><a href="#h15-0-17" id="h15-0-17" class="i">+                    ),
</a><a href="#h15-0-18" id="h15-0-18" class="i">+                    Constant(
</a><a href="#h15-0-19" id="h15-0-19" class="i">+                        Integer(
</a><a href="#h15-0-20" id="h15-0-20" class="i">+                            8,
</a>                         ),
                     ),
                 ),
<a href="#h15-1" id="h15-1" class="h">@@ -212,16 +210,14 @@ Optimized plan: Plan(
</a>                         ),
                     ],
                 },
<a href="#h15-1-3" id="h15-1-3" class="d">-                predicate: Some(
</a><a href="#h15-1-4" id="h15-1-4" class="d">-                    GreaterThan(
</a><a href="#h15-1-5" id="h15-1-5" class="d">-                        Field(
</a><a href="#h15-1-6" id="h15-1-6" class="d">-                            1,
</a><a href="#h15-1-7" id="h15-1-7" class="d">-                            None,
</a><a href="#h15-1-8" id="h15-1-8" class="d">-                        ),
</a><a href="#h15-1-9" id="h15-1-9" class="d">-                        Constant(
</a><a href="#h15-1-10" id="h15-1-10" class="d">-                            Integer(
</a><a href="#h15-1-11" id="h15-1-11" class="d">-                                8,
</a><a href="#h15-1-12" id="h15-1-12" class="d">-                            ),
</a><a href="#h15-1-13" id="h15-1-13" class="i">+                predicate: GreaterThan(
</a><a href="#h15-1-14" id="h15-1-14" class="i">+                    Field(
</a><a href="#h15-1-15" id="h15-1-15" class="i">+                        1,
</a><a href="#h15-1-16" id="h15-1-16" class="i">+                        None,
</a><a href="#h15-1-17" id="h15-1-17" class="i">+                    ),
</a><a href="#h15-1-18" id="h15-1-18" class="i">+                    Constant(
</a><a href="#h15-1-19" id="h15-1-19" class="i">+                        Integer(
</a><a href="#h15-1-20" id="h15-1-20" class="i">+                            8,
</a>                         ),
                     ),
                 ),
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a> b/<a href="../file/tests/sql/query/join_cross_alias.html">tests/sql/query/join_cross_alias</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -187,54 +187,34 @@ Plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h16-0-3" id="h16-0-3" class="d">-            predicate: Some(
</a><a href="#h16-0-4" id="h16-0-4" class="i">+            predicate: And(
</a>                 And(
<a href="#h16-0-6" id="h16-0-6" class="d">-                    And(
</a><a href="#h16-0-7" id="h16-0-7" class="d">-                        Or(
</a><a href="#h16-0-8" id="h16-0-8" class="d">-                            GreaterThan(
</a><a href="#h16-0-9" id="h16-0-9" class="d">-                                Field(
</a><a href="#h16-0-10" id="h16-0-10" class="d">-                                    0,
</a><a href="#h16-0-11" id="h16-0-11" class="d">-                                    Some(
</a><a href="#h16-0-12" id="h16-0-12" class="d">-                                        (
</a><a href="#h16-0-13" id="h16-0-13" class="d">-                                            Some(
</a><a href="#h16-0-14" id="h16-0-14" class="d">-                                                &quot;m&quot;,
</a><a href="#h16-0-15" id="h16-0-15" class="d">-                                            ),
</a><a href="#h16-0-16" id="h16-0-16" class="d">-                                            &quot;id&quot;,
</a><a href="#h16-0-17" id="h16-0-17" class="i">+                    Or(
</a><a href="#h16-0-18" id="h16-0-18" class="i">+                        GreaterThan(
</a><a href="#h16-0-19" id="h16-0-19" class="i">+                            Field(
</a><a href="#h16-0-20" id="h16-0-20" class="i">+                                0,
</a><a href="#h16-0-21" id="h16-0-21" class="i">+                                Some(
</a><a href="#h16-0-22" id="h16-0-22" class="i">+                                    (
</a><a href="#h16-0-23" id="h16-0-23" class="i">+                                        Some(
</a><a href="#h16-0-24" id="h16-0-24" class="i">+                                            &quot;m&quot;,
</a>                                         ),
<a href="#h16-0-26" id="h16-0-26" class="d">-                                    ),
</a><a href="#h16-0-27" id="h16-0-27" class="d">-                                ),
</a><a href="#h16-0-28" id="h16-0-28" class="d">-                                Constant(
</a><a href="#h16-0-29" id="h16-0-29" class="d">-                                    Integer(
</a><a href="#h16-0-30" id="h16-0-30" class="d">-                                        3,
</a><a href="#h16-0-31" id="h16-0-31" class="i">+                                        &quot;id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h16-0-35" id="h16-0-35" class="d">-                            Equal(
</a><a href="#h16-0-36" id="h16-0-36" class="d">-                                Field(
</a><a href="#h16-0-37" id="h16-0-37" class="d">-                                    0,
</a><a href="#h16-0-38" id="h16-0-38" class="d">-                                    Some(
</a><a href="#h16-0-39" id="h16-0-39" class="d">-                                        (
</a><a href="#h16-0-40" id="h16-0-40" class="d">-                                            Some(
</a><a href="#h16-0-41" id="h16-0-41" class="d">-                                                &quot;m&quot;,
</a><a href="#h16-0-42" id="h16-0-42" class="d">-                                            ),
</a><a href="#h16-0-43" id="h16-0-43" class="d">-                                            &quot;id&quot;,
</a><a href="#h16-0-44" id="h16-0-44" class="d">-                                        ),
</a><a href="#h16-0-45" id="h16-0-45" class="d">-                                    ),
</a><a href="#h16-0-46" id="h16-0-46" class="d">-                                ),
</a><a href="#h16-0-47" id="h16-0-47" class="d">-                                Constant(
</a><a href="#h16-0-48" id="h16-0-48" class="d">-                                    Integer(
</a><a href="#h16-0-49" id="h16-0-49" class="d">-                                        3,
</a><a href="#h16-0-50" id="h16-0-50" class="d">-                                    ),
</a><a href="#h16-0-51" id="h16-0-51" class="i">+                            Constant(
</a><a href="#h16-0-52" id="h16-0-52" class="i">+                                Integer(
</a><a href="#h16-0-53" id="h16-0-53" class="i">+                                    3,
</a>                                 ),
                             ),
                         ),
                         Equal(
                             Field(
<a href="#h16-0-59" id="h16-0-59" class="d">-                                7,
</a><a href="#h16-0-60" id="h16-0-60" class="i">+                                0,
</a>                                 Some(
                                     (
                                         Some(
<a href="#h16-0-64" id="h16-0-64" class="d">-                                            &quot;g&quot;,
</a><a href="#h16-0-65" id="h16-0-65" class="i">+                                            &quot;m&quot;,
</a>                                         ),
                                         &quot;id&quot;,
                                     ),
<a href="#h16-1" id="h16-1" class="h">@@ -242,30 +222,48 @@ Plan: Plan(
</a>                             ),
                             Constant(
                                 Integer(
<a href="#h16-1-3" id="h16-1-3" class="d">-                                    2,
</a><a href="#h16-1-4" id="h16-1-4" class="i">+                                    3,
</a>                                 ),
                             ),
                         ),
                     ),
<a href="#h16-1-9" id="h16-1-9" class="d">-                    Not(
</a><a href="#h16-1-10" id="h16-1-10" class="d">-                        Equal(
</a><a href="#h16-1-11" id="h16-1-11" class="d">-                            Field(
</a><a href="#h16-1-12" id="h16-1-12" class="d">-                                9,
</a><a href="#h16-1-13" id="h16-1-13" class="d">-                                Some(
</a><a href="#h16-1-14" id="h16-1-14" class="d">-                                    (
</a><a href="#h16-1-15" id="h16-1-15" class="d">-                                        Some(
</a><a href="#h16-1-16" id="h16-1-16" class="d">-                                            &quot;c&quot;,
</a><a href="#h16-1-17" id="h16-1-17" class="d">-                                        ),
</a><a href="#h16-1-18" id="h16-1-18" class="d">-                                        &quot;id&quot;,
</a><a href="#h16-1-19" id="h16-1-19" class="i">+                    Equal(
</a><a href="#h16-1-20" id="h16-1-20" class="i">+                        Field(
</a><a href="#h16-1-21" id="h16-1-21" class="i">+                            7,
</a><a href="#h16-1-22" id="h16-1-22" class="i">+                            Some(
</a><a href="#h16-1-23" id="h16-1-23" class="i">+                                (
</a><a href="#h16-1-24" id="h16-1-24" class="i">+                                    Some(
</a><a href="#h16-1-25" id="h16-1-25" class="i">+                                        &quot;g&quot;,
</a>                                     ),
<a href="#h16-1-27" id="h16-1-27" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
<a href="#h16-1-30" id="h16-1-30" class="d">-                            Constant(
</a><a href="#h16-1-31" id="h16-1-31" class="d">-                                String(
</a><a href="#h16-1-32" id="h16-1-32" class="d">-                                    &quot;us&quot;,
</a><a href="#h16-1-33" id="h16-1-33" class="i">+                        ),
</a><a href="#h16-1-34" id="h16-1-34" class="i">+                        Constant(
</a><a href="#h16-1-35" id="h16-1-35" class="i">+                            Integer(
</a><a href="#h16-1-36" id="h16-1-36" class="i">+                                2,
</a><a href="#h16-1-37" id="h16-1-37" class="i">+                            ),
</a><a href="#h16-1-38" id="h16-1-38" class="i">+                        ),
</a><a href="#h16-1-39" id="h16-1-39" class="i">+                    ),
</a><a href="#h16-1-40" id="h16-1-40" class="i">+                ),
</a><a href="#h16-1-41" id="h16-1-41" class="i">+                Not(
</a><a href="#h16-1-42" id="h16-1-42" class="i">+                    Equal(
</a><a href="#h16-1-43" id="h16-1-43" class="i">+                        Field(
</a><a href="#h16-1-44" id="h16-1-44" class="i">+                            9,
</a><a href="#h16-1-45" id="h16-1-45" class="i">+                            Some(
</a><a href="#h16-1-46" id="h16-1-46" class="i">+                                (
</a><a href="#h16-1-47" id="h16-1-47" class="i">+                                    Some(
</a><a href="#h16-1-48" id="h16-1-48" class="i">+                                        &quot;c&quot;,
</a><a href="#h16-1-49" id="h16-1-49" class="i">+                                    ),
</a><a href="#h16-1-50" id="h16-1-50" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h16-1-54" id="h16-1-54" class="i">+                        Constant(
</a><a href="#h16-1-55" id="h16-1-55" class="i">+                            String(
</a><a href="#h16-1-56" id="h16-1-56" class="i">+                                &quot;us&quot;,
</a><a href="#h16-1-57" id="h16-1-57" class="i">+                            ),
</a><a href="#h16-1-58" id="h16-1-58" class="i">+                        ),
</a>                     ),
                 ),
             ),
<a href="#h16-2" id="h16-2" class="h">@@ -361,105 +359,102 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Projection {
<a href="#h16-2-3" id="h16-2-3" class="d">-        source: Filter {
</a><a href="#h16-2-4" id="h16-2-4" class="d">-            source: NestedLoopJoin {
</a><a href="#h16-2-5" id="h16-2-5" class="d">-                outer: NestedLoopJoin {
</a><a href="#h16-2-6" id="h16-2-6" class="d">-                    outer: Scan {
</a><a href="#h16-2-7" id="h16-2-7" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h16-2-8" id="h16-2-8" class="d">-                        alias: Some(
</a><a href="#h16-2-9" id="h16-2-9" class="d">-                            &quot;m&quot;,
</a><a href="#h16-2-10" id="h16-2-10" class="d">-                        ),
</a><a href="#h16-2-11" id="h16-2-11" class="d">-                        filter: Some(
</a><a href="#h16-2-12" id="h16-2-12" class="d">-                            Or(
</a><a href="#h16-2-13" id="h16-2-13" class="d">-                                GreaterThan(
</a><a href="#h16-2-14" id="h16-2-14" class="d">-                                    Field(
</a><a href="#h16-2-15" id="h16-2-15" class="d">-                                        0,
</a><a href="#h16-2-16" id="h16-2-16" class="d">-                                        Some(
</a><a href="#h16-2-17" id="h16-2-17" class="d">-                                            (
</a><a href="#h16-2-18" id="h16-2-18" class="d">-                                                Some(
</a><a href="#h16-2-19" id="h16-2-19" class="d">-                                                    &quot;m&quot;,
</a><a href="#h16-2-20" id="h16-2-20" class="d">-                                                ),
</a><a href="#h16-2-21" id="h16-2-21" class="d">-                                                &quot;id&quot;,
</a><a href="#h16-2-22" id="h16-2-22" class="i">+        source: NestedLoopJoin {
</a><a href="#h16-2-23" id="h16-2-23" class="i">+            outer: NestedLoopJoin {
</a><a href="#h16-2-24" id="h16-2-24" class="i">+                outer: Scan {
</a><a href="#h16-2-25" id="h16-2-25" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h16-2-26" id="h16-2-26" class="i">+                    alias: Some(
</a><a href="#h16-2-27" id="h16-2-27" class="i">+                        &quot;m&quot;,
</a><a href="#h16-2-28" id="h16-2-28" class="i">+                    ),
</a><a href="#h16-2-29" id="h16-2-29" class="i">+                    filter: Some(
</a><a href="#h16-2-30" id="h16-2-30" class="i">+                        Or(
</a><a href="#h16-2-31" id="h16-2-31" class="i">+                            GreaterThan(
</a><a href="#h16-2-32" id="h16-2-32" class="i">+                                Field(
</a><a href="#h16-2-33" id="h16-2-33" class="i">+                                    0,
</a><a href="#h16-2-34" id="h16-2-34" class="i">+                                    Some(
</a><a href="#h16-2-35" id="h16-2-35" class="i">+                                        (
</a><a href="#h16-2-36" id="h16-2-36" class="i">+                                            Some(
</a><a href="#h16-2-37" id="h16-2-37" class="i">+                                                &quot;m&quot;,
</a>                                             ),
<a href="#h16-2-39" id="h16-2-39" class="d">-                                        ),
</a><a href="#h16-2-40" id="h16-2-40" class="d">-                                    ),
</a><a href="#h16-2-41" id="h16-2-41" class="d">-                                    Constant(
</a><a href="#h16-2-42" id="h16-2-42" class="d">-                                        Integer(
</a><a href="#h16-2-43" id="h16-2-43" class="d">-                                            3,
</a><a href="#h16-2-44" id="h16-2-44" class="i">+                                            &quot;id&quot;,
</a>                                         ),
                                     ),
                                 ),
<a href="#h16-2-48" id="h16-2-48" class="d">-                                Equal(
</a><a href="#h16-2-49" id="h16-2-49" class="d">-                                    Field(
</a><a href="#h16-2-50" id="h16-2-50" class="d">-                                        0,
</a><a href="#h16-2-51" id="h16-2-51" class="d">-                                        Some(
</a><a href="#h16-2-52" id="h16-2-52" class="d">-                                            (
</a><a href="#h16-2-53" id="h16-2-53" class="d">-                                                Some(
</a><a href="#h16-2-54" id="h16-2-54" class="d">-                                                    &quot;m&quot;,
</a><a href="#h16-2-55" id="h16-2-55" class="d">-                                                ),
</a><a href="#h16-2-56" id="h16-2-56" class="d">-                                                &quot;id&quot;,
</a><a href="#h16-2-57" id="h16-2-57" class="d">-                                            ),
</a><a href="#h16-2-58" id="h16-2-58" class="d">-                                        ),
</a><a href="#h16-2-59" id="h16-2-59" class="d">-                                    ),
</a><a href="#h16-2-60" id="h16-2-60" class="d">-                                    Constant(
</a><a href="#h16-2-61" id="h16-2-61" class="d">-                                        Integer(
</a><a href="#h16-2-62" id="h16-2-62" class="d">-                                            3,
</a><a href="#h16-2-63" id="h16-2-63" class="d">-                                        ),
</a><a href="#h16-2-64" id="h16-2-64" class="i">+                                Constant(
</a><a href="#h16-2-65" id="h16-2-65" class="i">+                                    Integer(
</a><a href="#h16-2-66" id="h16-2-66" class="i">+                                        3,
</a>                                     ),
                                 ),
                             ),
<a href="#h16-2-70" id="h16-2-70" class="d">-                        ),
</a><a href="#h16-2-71" id="h16-2-71" class="d">-                    },
</a><a href="#h16-2-72" id="h16-2-72" class="d">-                    outer_size: 7,
</a><a href="#h16-2-73" id="h16-2-73" class="d">-                    inner: KeyLookup {
</a><a href="#h16-2-74" id="h16-2-74" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h16-2-75" id="h16-2-75" class="d">-                        alias: Some(
</a><a href="#h16-2-76" id="h16-2-76" class="d">-                            &quot;g&quot;,
</a><a href="#h16-2-77" id="h16-2-77" class="d">-                        ),
</a><a href="#h16-2-78" id="h16-2-78" class="d">-                        keys: [
</a><a href="#h16-2-79" id="h16-2-79" class="d">-                            Integer(
</a><a href="#h16-2-80" id="h16-2-80" class="d">-                                2,
</a><a href="#h16-2-81" id="h16-2-81" class="d">-                            ),
</a><a href="#h16-2-82" id="h16-2-82" class="d">-                        ],
</a><a href="#h16-2-83" id="h16-2-83" class="d">-                    },
</a><a href="#h16-2-84" id="h16-2-84" class="d">-                    predicate: None,
</a><a href="#h16-2-85" id="h16-2-85" class="d">-                    pad: false,
</a><a href="#h16-2-86" id="h16-2-86" class="d">-                    flip: false,
</a><a href="#h16-2-87" id="h16-2-87" class="d">-                },
</a><a href="#h16-2-88" id="h16-2-88" class="d">-                outer_size: 9,
</a><a href="#h16-2-89" id="h16-2-89" class="d">-                inner: Scan {
</a><a href="#h16-2-90" id="h16-2-90" class="d">-                    table: &quot;countries&quot;,
</a><a href="#h16-2-91" id="h16-2-91" class="d">-                    alias: Some(
</a><a href="#h16-2-92" id="h16-2-92" class="d">-                        &quot;c&quot;,
</a><a href="#h16-2-93" id="h16-2-93" class="d">-                    ),
</a><a href="#h16-2-94" id="h16-2-94" class="d">-                    filter: Some(
</a><a href="#h16-2-95" id="h16-2-95" class="d">-                        Not(
</a>                             Equal(
                                 Field(
                                     0,
                                     Some(
                                         (
                                             Some(
<a href="#h16-2-102" id="h16-2-102" class="d">-                                                &quot;c&quot;,
</a><a href="#h16-2-103" id="h16-2-103" class="i">+                                                &quot;m&quot;,
</a>                                             ),
                                             &quot;id&quot;,
                                         ),
                                     ),
                                 ),
                                 Constant(
<a href="#h16-2-110" id="h16-2-110" class="d">-                                    String(
</a><a href="#h16-2-111" id="h16-2-111" class="d">-                                        &quot;us&quot;,
</a><a href="#h16-2-112" id="h16-2-112" class="i">+                                    Integer(
</a><a href="#h16-2-113" id="h16-2-113" class="i">+                                        3,
</a>                                     ),
                                 ),
                             ),
                         ),
                     ),
                 },
<a href="#h16-2-120" id="h16-2-120" class="i">+                outer_size: 7,
</a><a href="#h16-2-121" id="h16-2-121" class="i">+                inner: KeyLookup {
</a><a href="#h16-2-122" id="h16-2-122" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h16-2-123" id="h16-2-123" class="i">+                    alias: Some(
</a><a href="#h16-2-124" id="h16-2-124" class="i">+                        &quot;g&quot;,
</a><a href="#h16-2-125" id="h16-2-125" class="i">+                    ),
</a><a href="#h16-2-126" id="h16-2-126" class="i">+                    keys: [
</a><a href="#h16-2-127" id="h16-2-127" class="i">+                        Integer(
</a><a href="#h16-2-128" id="h16-2-128" class="i">+                            2,
</a><a href="#h16-2-129" id="h16-2-129" class="i">+                        ),
</a><a href="#h16-2-130" id="h16-2-130" class="i">+                    ],
</a><a href="#h16-2-131" id="h16-2-131" class="i">+                },
</a>                 predicate: None,
                 pad: false,
                 flip: false,
             },
<a href="#h16-2-136" id="h16-2-136" class="i">+            outer_size: 9,
</a><a href="#h16-2-137" id="h16-2-137" class="i">+            inner: Scan {
</a><a href="#h16-2-138" id="h16-2-138" class="i">+                table: &quot;countries&quot;,
</a><a href="#h16-2-139" id="h16-2-139" class="i">+                alias: Some(
</a><a href="#h16-2-140" id="h16-2-140" class="i">+                    &quot;c&quot;,
</a><a href="#h16-2-141" id="h16-2-141" class="i">+                ),
</a><a href="#h16-2-142" id="h16-2-142" class="i">+                filter: Some(
</a><a href="#h16-2-143" id="h16-2-143" class="i">+                    Not(
</a><a href="#h16-2-144" id="h16-2-144" class="i">+                        Equal(
</a><a href="#h16-2-145" id="h16-2-145" class="i">+                            Field(
</a><a href="#h16-2-146" id="h16-2-146" class="i">+                                0,
</a><a href="#h16-2-147" id="h16-2-147" class="i">+                                Some(
</a><a href="#h16-2-148" id="h16-2-148" class="i">+                                    (
</a><a href="#h16-2-149" id="h16-2-149" class="i">+                                        Some(
</a><a href="#h16-2-150" id="h16-2-150" class="i">+                                            &quot;c&quot;,
</a><a href="#h16-2-151" id="h16-2-151" class="i">+                                        ),
</a><a href="#h16-2-152" id="h16-2-152" class="i">+                                        &quot;id&quot;,
</a><a href="#h16-2-153" id="h16-2-153" class="i">+                                    ),
</a><a href="#h16-2-154" id="h16-2-154" class="i">+                                ),
</a><a href="#h16-2-155" id="h16-2-155" class="i">+                            ),
</a><a href="#h16-2-156" id="h16-2-156" class="i">+                            Constant(
</a><a href="#h16-2-157" id="h16-2-157" class="i">+                                String(
</a><a href="#h16-2-158" id="h16-2-158" class="i">+                                    &quot;us&quot;,
</a><a href="#h16-2-159" id="h16-2-159" class="i">+                                ),
</a><a href="#h16-2-160" id="h16-2-160" class="i">+                            ),
</a><a href="#h16-2-161" id="h16-2-161" class="i">+                        ),
</a><a href="#h16-2-162" id="h16-2-162" class="i">+                    ),
</a><a href="#h16-2-163" id="h16-2-163" class="i">+                ),
</a><a href="#h16-2-164" id="h16-2-164" class="i">+            },
</a>             predicate: None,
<a href="#h16-2-166" id="h16-2-166" class="i">+            pad: false,
</a><a href="#h16-2-167" id="h16-2-167" class="i">+            flip: false,
</a>         },
         expressions: [
             (
<b>diff --git a/<a id="h17" href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a> b/<a href="../file/tests/sql/query/join_inner_index_transverse_where.html">tests/sql/query/join_inner_index_transverse_where</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -108,23 +108,21 @@ Plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h17-0-3" id="h17-0-3" class="d">-        predicate: Some(
</a><a href="#h17-0-4" id="h17-0-4" class="d">-            Equal(
</a><a href="#h17-0-5" id="h17-0-5" class="d">-                Field(
</a><a href="#h17-0-6" id="h17-0-6" class="d">-                    7,
</a><a href="#h17-0-7" id="h17-0-7" class="d">-                    Some(
</a><a href="#h17-0-8" id="h17-0-8" class="d">-                        (
</a><a href="#h17-0-9" id="h17-0-9" class="d">-                            Some(
</a><a href="#h17-0-10" id="h17-0-10" class="d">-                                &quot;g&quot;,
</a><a href="#h17-0-11" id="h17-0-11" class="d">-                            ),
</a><a href="#h17-0-12" id="h17-0-12" class="d">-                            &quot;id&quot;,
</a><a href="#h17-0-13" id="h17-0-13" class="i">+        predicate: Equal(
</a><a href="#h17-0-14" id="h17-0-14" class="i">+            Field(
</a><a href="#h17-0-15" id="h17-0-15" class="i">+                7,
</a><a href="#h17-0-16" id="h17-0-16" class="i">+                Some(
</a><a href="#h17-0-17" id="h17-0-17" class="i">+                    (
</a><a href="#h17-0-18" id="h17-0-18" class="i">+                        Some(
</a><a href="#h17-0-19" id="h17-0-19" class="i">+                            &quot;g&quot;,
</a>                         ),
<a href="#h17-0-21" id="h17-0-21" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h17-0-24" id="h17-0-24" class="d">-                Constant(
</a><a href="#h17-0-25" id="h17-0-25" class="d">-                    Integer(
</a><a href="#h17-0-26" id="h17-0-26" class="d">-                        4,
</a><a href="#h17-0-27" id="h17-0-27" class="d">-                    ),
</a><a href="#h17-0-28" id="h17-0-28" class="i">+            ),
</a><a href="#h17-0-29" id="h17-0-29" class="i">+            Constant(
</a><a href="#h17-0-30" id="h17-0-30" class="i">+                Integer(
</a><a href="#h17-0-31" id="h17-0-31" class="i">+                    4,
</a>                 ),
             ),
         ),
<a href="#h17-1" id="h17-1" class="h">@@ -132,62 +130,59 @@ Plan: Plan(
</a> )
 
 Optimized plan: Plan(
<a href="#h17-1-3" id="h17-1-3" class="d">-    Filter {
</a><a href="#h17-1-4" id="h17-1-4" class="d">-        source: NestedLoopJoin {
</a><a href="#h17-1-5" id="h17-1-5" class="d">-            outer: IndexLookup {
</a><a href="#h17-1-6" id="h17-1-6" class="d">-                table: &quot;movies&quot;,
</a><a href="#h17-1-7" id="h17-1-7" class="d">-                alias: Some(
</a><a href="#h17-1-8" id="h17-1-8" class="d">-                    &quot;m&quot;,
</a><a href="#h17-1-9" id="h17-1-9" class="i">+    NestedLoopJoin {
</a><a href="#h17-1-10" id="h17-1-10" class="i">+        outer: IndexLookup {
</a><a href="#h17-1-11" id="h17-1-11" class="i">+            table: &quot;movies&quot;,
</a><a href="#h17-1-12" id="h17-1-12" class="i">+            alias: Some(
</a><a href="#h17-1-13" id="h17-1-13" class="i">+                &quot;m&quot;,
</a><a href="#h17-1-14" id="h17-1-14" class="i">+            ),
</a><a href="#h17-1-15" id="h17-1-15" class="i">+            column: &quot;genre_id&quot;,
</a><a href="#h17-1-16" id="h17-1-16" class="i">+            values: [
</a><a href="#h17-1-17" id="h17-1-17" class="i">+                Integer(
</a><a href="#h17-1-18" id="h17-1-18" class="i">+                    4,
</a>                 ),
<a href="#h17-1-20" id="h17-1-20" class="d">-                column: &quot;genre_id&quot;,
</a><a href="#h17-1-21" id="h17-1-21" class="d">-                values: [
</a><a href="#h17-1-22" id="h17-1-22" class="d">-                    Integer(
</a><a href="#h17-1-23" id="h17-1-23" class="d">-                        4,
</a><a href="#h17-1-24" id="h17-1-24" class="d">-                    ),
</a><a href="#h17-1-25" id="h17-1-25" class="d">-                ],
</a><a href="#h17-1-26" id="h17-1-26" class="d">-            },
</a><a href="#h17-1-27" id="h17-1-27" class="d">-            outer_size: 7,
</a><a href="#h17-1-28" id="h17-1-28" class="d">-            inner: KeyLookup {
</a><a href="#h17-1-29" id="h17-1-29" class="d">-                table: &quot;genres&quot;,
</a><a href="#h17-1-30" id="h17-1-30" class="d">-                alias: Some(
</a><a href="#h17-1-31" id="h17-1-31" class="d">-                    &quot;g&quot;,
</a><a href="#h17-1-32" id="h17-1-32" class="i">+            ],
</a><a href="#h17-1-33" id="h17-1-33" class="i">+        },
</a><a href="#h17-1-34" id="h17-1-34" class="i">+        outer_size: 7,
</a><a href="#h17-1-35" id="h17-1-35" class="i">+        inner: KeyLookup {
</a><a href="#h17-1-36" id="h17-1-36" class="i">+            table: &quot;genres&quot;,
</a><a href="#h17-1-37" id="h17-1-37" class="i">+            alias: Some(
</a><a href="#h17-1-38" id="h17-1-38" class="i">+                &quot;g&quot;,
</a><a href="#h17-1-39" id="h17-1-39" class="i">+            ),
</a><a href="#h17-1-40" id="h17-1-40" class="i">+            keys: [
</a><a href="#h17-1-41" id="h17-1-41" class="i">+                Integer(
</a><a href="#h17-1-42" id="h17-1-42" class="i">+                    4,
</a>                 ),
<a href="#h17-1-44" id="h17-1-44" class="d">-                keys: [
</a><a href="#h17-1-45" id="h17-1-45" class="d">-                    Integer(
</a><a href="#h17-1-46" id="h17-1-46" class="d">-                        4,
</a><a href="#h17-1-47" id="h17-1-47" class="d">-                    ),
</a><a href="#h17-1-48" id="h17-1-48" class="d">-                ],
</a><a href="#h17-1-49" id="h17-1-49" class="d">-            },
</a><a href="#h17-1-50" id="h17-1-50" class="d">-            predicate: Some(
</a><a href="#h17-1-51" id="h17-1-51" class="d">-                Equal(
</a><a href="#h17-1-52" id="h17-1-52" class="d">-                    Field(
</a><a href="#h17-1-53" id="h17-1-53" class="d">-                        3,
</a><a href="#h17-1-54" id="h17-1-54" class="d">-                        Some(
</a><a href="#h17-1-55" id="h17-1-55" class="d">-                            (
</a><a href="#h17-1-56" id="h17-1-56" class="d">-                                Some(
</a><a href="#h17-1-57" id="h17-1-57" class="d">-                                    &quot;m&quot;,
</a><a href="#h17-1-58" id="h17-1-58" class="d">-                                ),
</a><a href="#h17-1-59" id="h17-1-59" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h17-1-60" id="h17-1-60" class="i">+            ],
</a><a href="#h17-1-61" id="h17-1-61" class="i">+        },
</a><a href="#h17-1-62" id="h17-1-62" class="i">+        predicate: Some(
</a><a href="#h17-1-63" id="h17-1-63" class="i">+            Equal(
</a><a href="#h17-1-64" id="h17-1-64" class="i">+                Field(
</a><a href="#h17-1-65" id="h17-1-65" class="i">+                    3,
</a><a href="#h17-1-66" id="h17-1-66" class="i">+                    Some(
</a><a href="#h17-1-67" id="h17-1-67" class="i">+                        (
</a><a href="#h17-1-68" id="h17-1-68" class="i">+                            Some(
</a><a href="#h17-1-69" id="h17-1-69" class="i">+                                &quot;m&quot;,
</a>                             ),
<a href="#h17-1-71" id="h17-1-71" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h17-1-74" id="h17-1-74" class="d">-                    Field(
</a><a href="#h17-1-75" id="h17-1-75" class="d">-                        7,
</a><a href="#h17-1-76" id="h17-1-76" class="d">-                        Some(
</a><a href="#h17-1-77" id="h17-1-77" class="d">-                            (
</a><a href="#h17-1-78" id="h17-1-78" class="d">-                                Some(
</a><a href="#h17-1-79" id="h17-1-79" class="d">-                                    &quot;g&quot;,
</a><a href="#h17-1-80" id="h17-1-80" class="d">-                                ),
</a><a href="#h17-1-81" id="h17-1-81" class="d">-                                &quot;id&quot;,
</a><a href="#h17-1-82" id="h17-1-82" class="i">+                ),
</a><a href="#h17-1-83" id="h17-1-83" class="i">+                Field(
</a><a href="#h17-1-84" id="h17-1-84" class="i">+                    7,
</a><a href="#h17-1-85" id="h17-1-85" class="i">+                    Some(
</a><a href="#h17-1-86" id="h17-1-86" class="i">+                        (
</a><a href="#h17-1-87" id="h17-1-87" class="i">+                            Some(
</a><a href="#h17-1-88" id="h17-1-88" class="i">+                                &quot;g&quot;,
</a>                             ),
<a href="#h17-1-90" id="h17-1-90" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
                 ),
             ),
<a href="#h17-1-95" id="h17-1-95" class="d">-            pad: false,
</a><a href="#h17-1-96" id="h17-1-96" class="d">-            flip: false,
</a><a href="#h17-1-97" id="h17-1-97" class="d">-        },
</a><a href="#h17-1-98" id="h17-1-98" class="d">-        predicate: None,
</a><a href="#h17-1-99" id="h17-1-99" class="i">+        ),
</a><a href="#h17-1-100" id="h17-1-100" class="i">+        pad: false,
</a><a href="#h17-1-101" id="h17-1-101" class="i">+        flip: false,
</a>     },
 )
 
<b>diff --git a/<a id="h18" href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a> b/<a href="../file/tests/sql/query/join_inner_multi_index.html">tests/sql/query/join_inner_multi_index</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -362,23 +362,21 @@ Optimized plan: Plan(
</a>                                 ),
                             ],
                         },
<a href="#h18-0-3" id="h18-0-3" class="d">-                        predicate: Some(
</a><a href="#h18-0-4" id="h18-0-4" class="d">-                            Equal(
</a><a href="#h18-0-5" id="h18-0-5" class="d">-                                Field(
</a><a href="#h18-0-6" id="h18-0-6" class="d">-                                    3,
</a><a href="#h18-0-7" id="h18-0-7" class="d">-                                    Some(
</a><a href="#h18-0-8" id="h18-0-8" class="d">-                                        (
</a><a href="#h18-0-9" id="h18-0-9" class="d">-                                            Some(
</a><a href="#h18-0-10" id="h18-0-10" class="d">-                                                &quot;m&quot;,
</a><a href="#h18-0-11" id="h18-0-11" class="d">-                                            ),
</a><a href="#h18-0-12" id="h18-0-12" class="d">-                                            &quot;genre_id&quot;,
</a><a href="#h18-0-13" id="h18-0-13" class="i">+                        predicate: Equal(
</a><a href="#h18-0-14" id="h18-0-14" class="i">+                            Field(
</a><a href="#h18-0-15" id="h18-0-15" class="i">+                                3,
</a><a href="#h18-0-16" id="h18-0-16" class="i">+                                Some(
</a><a href="#h18-0-17" id="h18-0-17" class="i">+                                    (
</a><a href="#h18-0-18" id="h18-0-18" class="i">+                                        Some(
</a><a href="#h18-0-19" id="h18-0-19" class="i">+                                            &quot;m&quot;,
</a>                                         ),
<a href="#h18-0-21" id="h18-0-21" class="i">+                                        &quot;genre_id&quot;,
</a>                                     ),
                                 ),
<a href="#h18-0-24" id="h18-0-24" class="d">-                                Constant(
</a><a href="#h18-0-25" id="h18-0-25" class="d">-                                    Integer(
</a><a href="#h18-0-26" id="h18-0-26" class="d">-                                        1,
</a><a href="#h18-0-27" id="h18-0-27" class="d">-                                    ),
</a><a href="#h18-0-28" id="h18-0-28" class="i">+                            ),
</a><a href="#h18-0-29" id="h18-0-29" class="i">+                            Constant(
</a><a href="#h18-0-30" id="h18-0-30" class="i">+                                Integer(
</a><a href="#h18-0-31" id="h18-0-31" class="i">+                                    1,
</a>                                 ),
                             ),
                         ),
<b>diff --git a/<a id="h19" href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a> b/<a href="../file/tests/sql/query/join_inner_on_where.html">tests/sql/query/join_inner_on_where</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -100,42 +100,40 @@ Plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h19-0-3" id="h19-0-3" class="d">-        predicate: Some(
</a><a href="#h19-0-4" id="h19-0-4" class="d">-            Or(
</a><a href="#h19-0-5" id="h19-0-5" class="d">-                GreaterThan(
</a><a href="#h19-0-6" id="h19-0-6" class="d">-                    Field(
</a><a href="#h19-0-7" id="h19-0-7" class="d">-                        0,
</a><a href="#h19-0-8" id="h19-0-8" class="d">-                        Some(
</a><a href="#h19-0-9" id="h19-0-9" class="d">-                            (
</a><a href="#h19-0-10" id="h19-0-10" class="d">-                                Some(
</a><a href="#h19-0-11" id="h19-0-11" class="d">-                                    &quot;movies&quot;,
</a><a href="#h19-0-12" id="h19-0-12" class="d">-                                ),
</a><a href="#h19-0-13" id="h19-0-13" class="d">-                                &quot;id&quot;,
</a><a href="#h19-0-14" id="h19-0-14" class="i">+        predicate: Or(
</a><a href="#h19-0-15" id="h19-0-15" class="i">+            GreaterThan(
</a><a href="#h19-0-16" id="h19-0-16" class="i">+                Field(
</a><a href="#h19-0-17" id="h19-0-17" class="i">+                    0,
</a><a href="#h19-0-18" id="h19-0-18" class="i">+                    Some(
</a><a href="#h19-0-19" id="h19-0-19" class="i">+                        (
</a><a href="#h19-0-20" id="h19-0-20" class="i">+                            Some(
</a><a href="#h19-0-21" id="h19-0-21" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h19-0-23" id="h19-0-23" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h19-0-26" id="h19-0-26" class="d">-                    Constant(
</a><a href="#h19-0-27" id="h19-0-27" class="d">-                        Integer(
</a><a href="#h19-0-28" id="h19-0-28" class="d">-                            3,
</a><a href="#h19-0-29" id="h19-0-29" class="d">-                        ),
</a><a href="#h19-0-30" id="h19-0-30" class="i">+                ),
</a><a href="#h19-0-31" id="h19-0-31" class="i">+                Constant(
</a><a href="#h19-0-32" id="h19-0-32" class="i">+                    Integer(
</a><a href="#h19-0-33" id="h19-0-33" class="i">+                        3,
</a>                     ),
                 ),
<a href="#h19-0-36" id="h19-0-36" class="d">-                Equal(
</a><a href="#h19-0-37" id="h19-0-37" class="d">-                    Field(
</a><a href="#h19-0-38" id="h19-0-38" class="d">-                        0,
</a><a href="#h19-0-39" id="h19-0-39" class="d">-                        Some(
</a><a href="#h19-0-40" id="h19-0-40" class="d">-                            (
</a><a href="#h19-0-41" id="h19-0-41" class="d">-                                Some(
</a><a href="#h19-0-42" id="h19-0-42" class="d">-                                    &quot;movies&quot;,
</a><a href="#h19-0-43" id="h19-0-43" class="d">-                                ),
</a><a href="#h19-0-44" id="h19-0-44" class="d">-                                &quot;id&quot;,
</a><a href="#h19-0-45" id="h19-0-45" class="i">+            ),
</a><a href="#h19-0-46" id="h19-0-46" class="i">+            Equal(
</a><a href="#h19-0-47" id="h19-0-47" class="i">+                Field(
</a><a href="#h19-0-48" id="h19-0-48" class="i">+                    0,
</a><a href="#h19-0-49" id="h19-0-49" class="i">+                    Some(
</a><a href="#h19-0-50" id="h19-0-50" class="i">+                        (
</a><a href="#h19-0-51" id="h19-0-51" class="i">+                            Some(
</a><a href="#h19-0-52" id="h19-0-52" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h19-0-54" id="h19-0-54" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
<a href="#h19-0-57" id="h19-0-57" class="d">-                    Constant(
</a><a href="#h19-0-58" id="h19-0-58" class="d">-                        Integer(
</a><a href="#h19-0-59" id="h19-0-59" class="d">-                            3,
</a><a href="#h19-0-60" id="h19-0-60" class="d">-                        ),
</a><a href="#h19-0-61" id="h19-0-61" class="i">+                ),
</a><a href="#h19-0-62" id="h19-0-62" class="i">+                Constant(
</a><a href="#h19-0-63" id="h19-0-63" class="i">+                    Integer(
</a><a href="#h19-0-64" id="h19-0-64" class="i">+                        3,
</a>                     ),
                 ),
             ),
<a href="#h19-1" id="h19-1" class="h">@@ -144,88 +142,85 @@ Plan: Plan(
</a> )
 
 Optimized plan: Plan(
<a href="#h19-1-3" id="h19-1-3" class="d">-    Filter {
</a><a href="#h19-1-4" id="h19-1-4" class="d">-        source: NestedLoopJoin {
</a><a href="#h19-1-5" id="h19-1-5" class="d">-            outer: Scan {
</a><a href="#h19-1-6" id="h19-1-6" class="d">-                table: &quot;movies&quot;,
</a><a href="#h19-1-7" id="h19-1-7" class="d">-                alias: None,
</a><a href="#h19-1-8" id="h19-1-8" class="d">-                filter: Some(
</a><a href="#h19-1-9" id="h19-1-9" class="d">-                    Or(
</a><a href="#h19-1-10" id="h19-1-10" class="d">-                        GreaterThan(
</a><a href="#h19-1-11" id="h19-1-11" class="d">-                            Field(
</a><a href="#h19-1-12" id="h19-1-12" class="d">-                                0,
</a><a href="#h19-1-13" id="h19-1-13" class="d">-                                Some(
</a><a href="#h19-1-14" id="h19-1-14" class="d">-                                    (
</a><a href="#h19-1-15" id="h19-1-15" class="d">-                                        Some(
</a><a href="#h19-1-16" id="h19-1-16" class="d">-                                            &quot;movies&quot;,
</a><a href="#h19-1-17" id="h19-1-17" class="d">-                                        ),
</a><a href="#h19-1-18" id="h19-1-18" class="d">-                                        &quot;id&quot;,
</a><a href="#h19-1-19" id="h19-1-19" class="i">+    NestedLoopJoin {
</a><a href="#h19-1-20" id="h19-1-20" class="i">+        outer: Scan {
</a><a href="#h19-1-21" id="h19-1-21" class="i">+            table: &quot;movies&quot;,
</a><a href="#h19-1-22" id="h19-1-22" class="i">+            alias: None,
</a><a href="#h19-1-23" id="h19-1-23" class="i">+            filter: Some(
</a><a href="#h19-1-24" id="h19-1-24" class="i">+                Or(
</a><a href="#h19-1-25" id="h19-1-25" class="i">+                    GreaterThan(
</a><a href="#h19-1-26" id="h19-1-26" class="i">+                        Field(
</a><a href="#h19-1-27" id="h19-1-27" class="i">+                            0,
</a><a href="#h19-1-28" id="h19-1-28" class="i">+                            Some(
</a><a href="#h19-1-29" id="h19-1-29" class="i">+                                (
</a><a href="#h19-1-30" id="h19-1-30" class="i">+                                    Some(
</a><a href="#h19-1-31" id="h19-1-31" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h19-1-33" id="h19-1-33" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
<a href="#h19-1-36" id="h19-1-36" class="d">-                            Constant(
</a><a href="#h19-1-37" id="h19-1-37" class="d">-                                Integer(
</a><a href="#h19-1-38" id="h19-1-38" class="d">-                                    3,
</a><a href="#h19-1-39" id="h19-1-39" class="d">-                                ),
</a><a href="#h19-1-40" id="h19-1-40" class="i">+                        ),
</a><a href="#h19-1-41" id="h19-1-41" class="i">+                        Constant(
</a><a href="#h19-1-42" id="h19-1-42" class="i">+                            Integer(
</a><a href="#h19-1-43" id="h19-1-43" class="i">+                                3,
</a>                             ),
                         ),
<a href="#h19-1-46" id="h19-1-46" class="d">-                        Equal(
</a><a href="#h19-1-47" id="h19-1-47" class="d">-                            Field(
</a><a href="#h19-1-48" id="h19-1-48" class="d">-                                0,
</a><a href="#h19-1-49" id="h19-1-49" class="d">-                                Some(
</a><a href="#h19-1-50" id="h19-1-50" class="d">-                                    (
</a><a href="#h19-1-51" id="h19-1-51" class="d">-                                        Some(
</a><a href="#h19-1-52" id="h19-1-52" class="d">-                                            &quot;movies&quot;,
</a><a href="#h19-1-53" id="h19-1-53" class="d">-                                        ),
</a><a href="#h19-1-54" id="h19-1-54" class="d">-                                        &quot;id&quot;,
</a><a href="#h19-1-55" id="h19-1-55" class="i">+                    ),
</a><a href="#h19-1-56" id="h19-1-56" class="i">+                    Equal(
</a><a href="#h19-1-57" id="h19-1-57" class="i">+                        Field(
</a><a href="#h19-1-58" id="h19-1-58" class="i">+                            0,
</a><a href="#h19-1-59" id="h19-1-59" class="i">+                            Some(
</a><a href="#h19-1-60" id="h19-1-60" class="i">+                                (
</a><a href="#h19-1-61" id="h19-1-61" class="i">+                                    Some(
</a><a href="#h19-1-62" id="h19-1-62" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h19-1-64" id="h19-1-64" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
<a href="#h19-1-67" id="h19-1-67" class="d">-                            Constant(
</a><a href="#h19-1-68" id="h19-1-68" class="d">-                                Integer(
</a><a href="#h19-1-69" id="h19-1-69" class="d">-                                    3,
</a><a href="#h19-1-70" id="h19-1-70" class="d">-                                ),
</a><a href="#h19-1-71" id="h19-1-71" class="i">+                        ),
</a><a href="#h19-1-72" id="h19-1-72" class="i">+                        Constant(
</a><a href="#h19-1-73" id="h19-1-73" class="i">+                            Integer(
</a><a href="#h19-1-74" id="h19-1-74" class="i">+                                3,
</a>                             ),
                         ),
                     ),
                 ),
<a href="#h19-1-79" id="h19-1-79" class="d">-            },
</a><a href="#h19-1-80" id="h19-1-80" class="d">-            outer_size: 7,
</a><a href="#h19-1-81" id="h19-1-81" class="d">-            inner: Scan {
</a><a href="#h19-1-82" id="h19-1-82" class="d">-                table: &quot;genres&quot;,
</a><a href="#h19-1-83" id="h19-1-83" class="d">-                alias: None,
</a><a href="#h19-1-84" id="h19-1-84" class="d">-                filter: None,
</a><a href="#h19-1-85" id="h19-1-85" class="d">-            },
</a><a href="#h19-1-86" id="h19-1-86" class="d">-            predicate: Some(
</a><a href="#h19-1-87" id="h19-1-87" class="d">-                Equal(
</a><a href="#h19-1-88" id="h19-1-88" class="d">-                    Field(
</a><a href="#h19-1-89" id="h19-1-89" class="d">-                        3,
</a><a href="#h19-1-90" id="h19-1-90" class="d">-                        Some(
</a><a href="#h19-1-91" id="h19-1-91" class="d">-                            (
</a><a href="#h19-1-92" id="h19-1-92" class="d">-                                Some(
</a><a href="#h19-1-93" id="h19-1-93" class="d">-                                    &quot;movies&quot;,
</a><a href="#h19-1-94" id="h19-1-94" class="d">-                                ),
</a><a href="#h19-1-95" id="h19-1-95" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h19-1-96" id="h19-1-96" class="i">+            ),
</a><a href="#h19-1-97" id="h19-1-97" class="i">+        },
</a><a href="#h19-1-98" id="h19-1-98" class="i">+        outer_size: 7,
</a><a href="#h19-1-99" id="h19-1-99" class="i">+        inner: Scan {
</a><a href="#h19-1-100" id="h19-1-100" class="i">+            table: &quot;genres&quot;,
</a><a href="#h19-1-101" id="h19-1-101" class="i">+            alias: None,
</a><a href="#h19-1-102" id="h19-1-102" class="i">+            filter: None,
</a><a href="#h19-1-103" id="h19-1-103" class="i">+        },
</a><a href="#h19-1-104" id="h19-1-104" class="i">+        predicate: Some(
</a><a href="#h19-1-105" id="h19-1-105" class="i">+            Equal(
</a><a href="#h19-1-106" id="h19-1-106" class="i">+                Field(
</a><a href="#h19-1-107" id="h19-1-107" class="i">+                    3,
</a><a href="#h19-1-108" id="h19-1-108" class="i">+                    Some(
</a><a href="#h19-1-109" id="h19-1-109" class="i">+                        (
</a><a href="#h19-1-110" id="h19-1-110" class="i">+                            Some(
</a><a href="#h19-1-111" id="h19-1-111" class="i">+                                &quot;movies&quot;,
</a>                             ),
<a href="#h19-1-113" id="h19-1-113" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h19-1-116" id="h19-1-116" class="d">-                    Field(
</a><a href="#h19-1-117" id="h19-1-117" class="d">-                        7,
</a><a href="#h19-1-118" id="h19-1-118" class="d">-                        Some(
</a><a href="#h19-1-119" id="h19-1-119" class="d">-                            (
</a><a href="#h19-1-120" id="h19-1-120" class="d">-                                Some(
</a><a href="#h19-1-121" id="h19-1-121" class="d">-                                    &quot;genres&quot;,
</a><a href="#h19-1-122" id="h19-1-122" class="d">-                                ),
</a><a href="#h19-1-123" id="h19-1-123" class="d">-                                &quot;id&quot;,
</a><a href="#h19-1-124" id="h19-1-124" class="i">+                ),
</a><a href="#h19-1-125" id="h19-1-125" class="i">+                Field(
</a><a href="#h19-1-126" id="h19-1-126" class="i">+                    7,
</a><a href="#h19-1-127" id="h19-1-127" class="i">+                    Some(
</a><a href="#h19-1-128" id="h19-1-128" class="i">+                        (
</a><a href="#h19-1-129" id="h19-1-129" class="i">+                            Some(
</a><a href="#h19-1-130" id="h19-1-130" class="i">+                                &quot;genres&quot;,
</a>                             ),
<a href="#h19-1-132" id="h19-1-132" class="i">+                            &quot;id&quot;,
</a>                         ),
                     ),
                 ),
             ),
<a href="#h19-1-137" id="h19-1-137" class="d">-            pad: false,
</a><a href="#h19-1-138" id="h19-1-138" class="d">-            flip: false,
</a><a href="#h19-1-139" id="h19-1-139" class="d">-        },
</a><a href="#h19-1-140" id="h19-1-140" class="d">-        predicate: None,
</a><a href="#h19-1-141" id="h19-1-141" class="i">+        ),
</a><a href="#h19-1-142" id="h19-1-142" class="i">+        pad: false,
</a><a href="#h19-1-143" id="h19-1-143" class="i">+        flip: false,
</a>     },
 )
 
<b>diff --git a/<a id="h20" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -100,28 +100,26 @@ Plan: Plan(
</a>                     pad: false,
                     flip: false,
                 },
<a href="#h20-0-3" id="h20-0-3" class="d">-                predicate: Some(
</a><a href="#h20-0-4" id="h20-0-4" class="d">-                    Equal(
</a><a href="#h20-0-5" id="h20-0-5" class="d">-                        Field(
</a><a href="#h20-0-6" id="h20-0-6" class="d">-                            3,
</a><a href="#h20-0-7" id="h20-0-7" class="d">-                            Some(
</a><a href="#h20-0-8" id="h20-0-8" class="d">-                                (
</a><a href="#h20-0-9" id="h20-0-9" class="d">-                                    Some(
</a><a href="#h20-0-10" id="h20-0-10" class="d">-                                        &quot;movies&quot;,
</a><a href="#h20-0-11" id="h20-0-11" class="d">-                                    ),
</a><a href="#h20-0-12" id="h20-0-12" class="d">-                                    &quot;genre_id&quot;,
</a><a href="#h20-0-13" id="h20-0-13" class="i">+                predicate: Equal(
</a><a href="#h20-0-14" id="h20-0-14" class="i">+                    Field(
</a><a href="#h20-0-15" id="h20-0-15" class="i">+                        3,
</a><a href="#h20-0-16" id="h20-0-16" class="i">+                        Some(
</a><a href="#h20-0-17" id="h20-0-17" class="i">+                            (
</a><a href="#h20-0-18" id="h20-0-18" class="i">+                                Some(
</a><a href="#h20-0-19" id="h20-0-19" class="i">+                                    &quot;movies&quot;,
</a>                                 ),
<a href="#h20-0-21" id="h20-0-21" class="i">+                                &quot;genre_id&quot;,
</a>                             ),
                         ),
<a href="#h20-0-24" id="h20-0-24" class="d">-                        Field(
</a><a href="#h20-0-25" id="h20-0-25" class="d">-                            7,
</a><a href="#h20-0-26" id="h20-0-26" class="d">-                            Some(
</a><a href="#h20-0-27" id="h20-0-27" class="d">-                                (
</a><a href="#h20-0-28" id="h20-0-28" class="d">-                                    Some(
</a><a href="#h20-0-29" id="h20-0-29" class="d">-                                        &quot;genres&quot;,
</a><a href="#h20-0-30" id="h20-0-30" class="d">-                                    ),
</a><a href="#h20-0-31" id="h20-0-31" class="d">-                                    &quot;id&quot;,
</a><a href="#h20-0-32" id="h20-0-32" class="i">+                    ),
</a><a href="#h20-0-33" id="h20-0-33" class="i">+                    Field(
</a><a href="#h20-0-34" id="h20-0-34" class="i">+                        7,
</a><a href="#h20-0-35" id="h20-0-35" class="i">+                        Some(
</a><a href="#h20-0-36" id="h20-0-36" class="i">+                            (
</a><a href="#h20-0-37" id="h20-0-37" class="i">+                                Some(
</a><a href="#h20-0-38" id="h20-0-38" class="i">+                                    &quot;genres&quot;,
</a>                                 ),
<a href="#h20-0-40" id="h20-0-40" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
                     ),
<a href="#h20-1" id="h20-1" class="h">@@ -194,49 +192,46 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Order {
         source: Projection {
<a href="#h20-1-3" id="h20-1-3" class="d">-            source: Filter {
</a><a href="#h20-1-4" id="h20-1-4" class="d">-                source: NestedLoopJoin {
</a><a href="#h20-1-5" id="h20-1-5" class="d">-                    outer: Scan {
</a><a href="#h20-1-6" id="h20-1-6" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h20-1-7" id="h20-1-7" class="d">-                        alias: None,
</a><a href="#h20-1-8" id="h20-1-8" class="d">-                        filter: None,
</a><a href="#h20-1-9" id="h20-1-9" class="d">-                    },
</a><a href="#h20-1-10" id="h20-1-10" class="d">-                    outer_size: 7,
</a><a href="#h20-1-11" id="h20-1-11" class="d">-                    inner: Scan {
</a><a href="#h20-1-12" id="h20-1-12" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h20-1-13" id="h20-1-13" class="d">-                        alias: None,
</a><a href="#h20-1-14" id="h20-1-14" class="d">-                        filter: None,
</a><a href="#h20-1-15" id="h20-1-15" class="d">-                    },
</a><a href="#h20-1-16" id="h20-1-16" class="d">-                    predicate: Some(
</a><a href="#h20-1-17" id="h20-1-17" class="d">-                        Equal(
</a><a href="#h20-1-18" id="h20-1-18" class="d">-                            Field(
</a><a href="#h20-1-19" id="h20-1-19" class="d">-                                3,
</a><a href="#h20-1-20" id="h20-1-20" class="d">-                                Some(
</a><a href="#h20-1-21" id="h20-1-21" class="d">-                                    (
</a><a href="#h20-1-22" id="h20-1-22" class="d">-                                        Some(
</a><a href="#h20-1-23" id="h20-1-23" class="d">-                                            &quot;movies&quot;,
</a><a href="#h20-1-24" id="h20-1-24" class="d">-                                        ),
</a><a href="#h20-1-25" id="h20-1-25" class="d">-                                        &quot;genre_id&quot;,
</a><a href="#h20-1-26" id="h20-1-26" class="i">+            source: NestedLoopJoin {
</a><a href="#h20-1-27" id="h20-1-27" class="i">+                outer: Scan {
</a><a href="#h20-1-28" id="h20-1-28" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h20-1-29" id="h20-1-29" class="i">+                    alias: None,
</a><a href="#h20-1-30" id="h20-1-30" class="i">+                    filter: None,
</a><a href="#h20-1-31" id="h20-1-31" class="i">+                },
</a><a href="#h20-1-32" id="h20-1-32" class="i">+                outer_size: 7,
</a><a href="#h20-1-33" id="h20-1-33" class="i">+                inner: Scan {
</a><a href="#h20-1-34" id="h20-1-34" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h20-1-35" id="h20-1-35" class="i">+                    alias: None,
</a><a href="#h20-1-36" id="h20-1-36" class="i">+                    filter: None,
</a><a href="#h20-1-37" id="h20-1-37" class="i">+                },
</a><a href="#h20-1-38" id="h20-1-38" class="i">+                predicate: Some(
</a><a href="#h20-1-39" id="h20-1-39" class="i">+                    Equal(
</a><a href="#h20-1-40" id="h20-1-40" class="i">+                        Field(
</a><a href="#h20-1-41" id="h20-1-41" class="i">+                            3,
</a><a href="#h20-1-42" id="h20-1-42" class="i">+                            Some(
</a><a href="#h20-1-43" id="h20-1-43" class="i">+                                (
</a><a href="#h20-1-44" id="h20-1-44" class="i">+                                    Some(
</a><a href="#h20-1-45" id="h20-1-45" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h20-1-47" id="h20-1-47" class="i">+                                    &quot;genre_id&quot;,
</a>                                 ),
                             ),
<a href="#h20-1-50" id="h20-1-50" class="d">-                            Field(
</a><a href="#h20-1-51" id="h20-1-51" class="d">-                                7,
</a><a href="#h20-1-52" id="h20-1-52" class="d">-                                Some(
</a><a href="#h20-1-53" id="h20-1-53" class="d">-                                    (
</a><a href="#h20-1-54" id="h20-1-54" class="d">-                                        Some(
</a><a href="#h20-1-55" id="h20-1-55" class="d">-                                            &quot;genres&quot;,
</a><a href="#h20-1-56" id="h20-1-56" class="d">-                                        ),
</a><a href="#h20-1-57" id="h20-1-57" class="d">-                                        &quot;id&quot;,
</a><a href="#h20-1-58" id="h20-1-58" class="i">+                        ),
</a><a href="#h20-1-59" id="h20-1-59" class="i">+                        Field(
</a><a href="#h20-1-60" id="h20-1-60" class="i">+                            7,
</a><a href="#h20-1-61" id="h20-1-61" class="i">+                            Some(
</a><a href="#h20-1-62" id="h20-1-62" class="i">+                                (
</a><a href="#h20-1-63" id="h20-1-63" class="i">+                                    Some(
</a><a href="#h20-1-64" id="h20-1-64" class="i">+                                        &quot;genres&quot;,
</a>                                     ),
<a href="#h20-1-66" id="h20-1-66" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
                     ),
<a href="#h20-1-71" id="h20-1-71" class="d">-                    pad: false,
</a><a href="#h20-1-72" id="h20-1-72" class="d">-                    flip: false,
</a><a href="#h20-1-73" id="h20-1-73" class="d">-                },
</a><a href="#h20-1-74" id="h20-1-74" class="d">-                predicate: None,
</a><a href="#h20-1-75" id="h20-1-75" class="i">+                ),
</a><a href="#h20-1-76" id="h20-1-76" class="i">+                pad: false,
</a><a href="#h20-1-77" id="h20-1-77" class="i">+                flip: false,
</a>             },
             expressions: [
                 (
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -101,28 +101,26 @@ Plan: Plan(
</a>                         pad: false,
                         flip: false,
                     },
<a href="#h21-0-3" id="h21-0-3" class="d">-                    predicate: Some(
</a><a href="#h21-0-4" id="h21-0-4" class="d">-                        Equal(
</a><a href="#h21-0-5" id="h21-0-5" class="d">-                            Field(
</a><a href="#h21-0-6" id="h21-0-6" class="d">-                                3,
</a><a href="#h21-0-7" id="h21-0-7" class="d">-                                Some(
</a><a href="#h21-0-8" id="h21-0-8" class="d">-                                    (
</a><a href="#h21-0-9" id="h21-0-9" class="d">-                                        Some(
</a><a href="#h21-0-10" id="h21-0-10" class="d">-                                            &quot;movies&quot;,
</a><a href="#h21-0-11" id="h21-0-11" class="d">-                                        ),
</a><a href="#h21-0-12" id="h21-0-12" class="d">-                                        &quot;genre_id&quot;,
</a><a href="#h21-0-13" id="h21-0-13" class="i">+                    predicate: Equal(
</a><a href="#h21-0-14" id="h21-0-14" class="i">+                        Field(
</a><a href="#h21-0-15" id="h21-0-15" class="i">+                            3,
</a><a href="#h21-0-16" id="h21-0-16" class="i">+                            Some(
</a><a href="#h21-0-17" id="h21-0-17" class="i">+                                (
</a><a href="#h21-0-18" id="h21-0-18" class="i">+                                    Some(
</a><a href="#h21-0-19" id="h21-0-19" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h21-0-21" id="h21-0-21" class="i">+                                    &quot;genre_id&quot;,
</a>                                 ),
                             ),
<a href="#h21-0-24" id="h21-0-24" class="d">-                            Field(
</a><a href="#h21-0-25" id="h21-0-25" class="d">-                                7,
</a><a href="#h21-0-26" id="h21-0-26" class="d">-                                Some(
</a><a href="#h21-0-27" id="h21-0-27" class="d">-                                    (
</a><a href="#h21-0-28" id="h21-0-28" class="d">-                                        Some(
</a><a href="#h21-0-29" id="h21-0-29" class="d">-                                            &quot;genres&quot;,
</a><a href="#h21-0-30" id="h21-0-30" class="d">-                                        ),
</a><a href="#h21-0-31" id="h21-0-31" class="d">-                                        &quot;id&quot;,
</a><a href="#h21-0-32" id="h21-0-32" class="i">+                        ),
</a><a href="#h21-0-33" id="h21-0-33" class="i">+                        Field(
</a><a href="#h21-0-34" id="h21-0-34" class="i">+                            7,
</a><a href="#h21-0-35" id="h21-0-35" class="i">+                            Some(
</a><a href="#h21-0-36" id="h21-0-36" class="i">+                                (
</a><a href="#h21-0-37" id="h21-0-37" class="i">+                                    Some(
</a><a href="#h21-0-38" id="h21-0-38" class="i">+                                        &quot;genres&quot;,
</a>                                     ),
<a href="#h21-0-40" id="h21-0-40" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h21-1" id="h21-1" class="h">@@ -244,49 +242,46 @@ Optimized plan: Plan(
</a>     Projection {
         source: Order {
             source: Projection {
<a href="#h21-1-3" id="h21-1-3" class="d">-                source: Filter {
</a><a href="#h21-1-4" id="h21-1-4" class="d">-                    source: NestedLoopJoin {
</a><a href="#h21-1-5" id="h21-1-5" class="d">-                        outer: Scan {
</a><a href="#h21-1-6" id="h21-1-6" class="d">-                            table: &quot;movies&quot;,
</a><a href="#h21-1-7" id="h21-1-7" class="d">-                            alias: None,
</a><a href="#h21-1-8" id="h21-1-8" class="d">-                            filter: None,
</a><a href="#h21-1-9" id="h21-1-9" class="d">-                        },
</a><a href="#h21-1-10" id="h21-1-10" class="d">-                        outer_size: 7,
</a><a href="#h21-1-11" id="h21-1-11" class="d">-                        inner: Scan {
</a><a href="#h21-1-12" id="h21-1-12" class="d">-                            table: &quot;genres&quot;,
</a><a href="#h21-1-13" id="h21-1-13" class="d">-                            alias: None,
</a><a href="#h21-1-14" id="h21-1-14" class="d">-                            filter: None,
</a><a href="#h21-1-15" id="h21-1-15" class="d">-                        },
</a><a href="#h21-1-16" id="h21-1-16" class="d">-                        predicate: Some(
</a><a href="#h21-1-17" id="h21-1-17" class="d">-                            Equal(
</a><a href="#h21-1-18" id="h21-1-18" class="d">-                                Field(
</a><a href="#h21-1-19" id="h21-1-19" class="d">-                                    3,
</a><a href="#h21-1-20" id="h21-1-20" class="d">-                                    Some(
</a><a href="#h21-1-21" id="h21-1-21" class="d">-                                        (
</a><a href="#h21-1-22" id="h21-1-22" class="d">-                                            Some(
</a><a href="#h21-1-23" id="h21-1-23" class="d">-                                                &quot;movies&quot;,
</a><a href="#h21-1-24" id="h21-1-24" class="d">-                                            ),
</a><a href="#h21-1-25" id="h21-1-25" class="d">-                                            &quot;genre_id&quot;,
</a><a href="#h21-1-26" id="h21-1-26" class="i">+                source: NestedLoopJoin {
</a><a href="#h21-1-27" id="h21-1-27" class="i">+                    outer: Scan {
</a><a href="#h21-1-28" id="h21-1-28" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h21-1-29" id="h21-1-29" class="i">+                        alias: None,
</a><a href="#h21-1-30" id="h21-1-30" class="i">+                        filter: None,
</a><a href="#h21-1-31" id="h21-1-31" class="i">+                    },
</a><a href="#h21-1-32" id="h21-1-32" class="i">+                    outer_size: 7,
</a><a href="#h21-1-33" id="h21-1-33" class="i">+                    inner: Scan {
</a><a href="#h21-1-34" id="h21-1-34" class="i">+                        table: &quot;genres&quot;,
</a><a href="#h21-1-35" id="h21-1-35" class="i">+                        alias: None,
</a><a href="#h21-1-36" id="h21-1-36" class="i">+                        filter: None,
</a><a href="#h21-1-37" id="h21-1-37" class="i">+                    },
</a><a href="#h21-1-38" id="h21-1-38" class="i">+                    predicate: Some(
</a><a href="#h21-1-39" id="h21-1-39" class="i">+                        Equal(
</a><a href="#h21-1-40" id="h21-1-40" class="i">+                            Field(
</a><a href="#h21-1-41" id="h21-1-41" class="i">+                                3,
</a><a href="#h21-1-42" id="h21-1-42" class="i">+                                Some(
</a><a href="#h21-1-43" id="h21-1-43" class="i">+                                    (
</a><a href="#h21-1-44" id="h21-1-44" class="i">+                                        Some(
</a><a href="#h21-1-45" id="h21-1-45" class="i">+                                            &quot;movies&quot;,
</a>                                         ),
<a href="#h21-1-47" id="h21-1-47" class="i">+                                        &quot;genre_id&quot;,
</a>                                     ),
                                 ),
<a href="#h21-1-50" id="h21-1-50" class="d">-                                Field(
</a><a href="#h21-1-51" id="h21-1-51" class="d">-                                    7,
</a><a href="#h21-1-52" id="h21-1-52" class="d">-                                    Some(
</a><a href="#h21-1-53" id="h21-1-53" class="d">-                                        (
</a><a href="#h21-1-54" id="h21-1-54" class="d">-                                            Some(
</a><a href="#h21-1-55" id="h21-1-55" class="d">-                                                &quot;genres&quot;,
</a><a href="#h21-1-56" id="h21-1-56" class="d">-                                            ),
</a><a href="#h21-1-57" id="h21-1-57" class="d">-                                            &quot;id&quot;,
</a><a href="#h21-1-58" id="h21-1-58" class="i">+                            ),
</a><a href="#h21-1-59" id="h21-1-59" class="i">+                            Field(
</a><a href="#h21-1-60" id="h21-1-60" class="i">+                                7,
</a><a href="#h21-1-61" id="h21-1-61" class="i">+                                Some(
</a><a href="#h21-1-62" id="h21-1-62" class="i">+                                    (
</a><a href="#h21-1-63" id="h21-1-63" class="i">+                                        Some(
</a><a href="#h21-1-64" id="h21-1-64" class="i">+                                            &quot;genres&quot;,
</a>                                         ),
<a href="#h21-1-66" id="h21-1-66" class="i">+                                        &quot;id&quot;,
</a>                                     ),
                                 ),
                             ),
                         ),
<a href="#h21-1-71" id="h21-1-71" class="d">-                        pad: false,
</a><a href="#h21-1-72" id="h21-1-72" class="d">-                        flip: false,
</a><a href="#h21-1-73" id="h21-1-73" class="d">-                    },
</a><a href="#h21-1-74" id="h21-1-74" class="d">-                    predicate: None,
</a><a href="#h21-1-75" id="h21-1-75" class="i">+                    ),
</a><a href="#h21-1-76" id="h21-1-76" class="i">+                    pad: false,
</a><a href="#h21-1-77" id="h21-1-77" class="i">+                    flip: false,
</a>                 },
                 expressions: [
                     (
<b>diff --git a/<a id="h22" href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a> b/<a href="../file/tests/sql/query/where_expr.html">tests/sql/query/where_expr</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -45,7 +45,59 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h22-0-3" id="h22-0-3" class="d">-        predicate: Some(
</a><a href="#h22-0-4" id="h22-0-4" class="i">+        predicate: And(
</a><a href="#h22-0-5" id="h22-0-5" class="i">+            Or(
</a><a href="#h22-0-6" id="h22-0-6" class="i">+                GreaterThan(
</a><a href="#h22-0-7" id="h22-0-7" class="i">+                    Field(
</a><a href="#h22-0-8" id="h22-0-8" class="i">+                        4,
</a><a href="#h22-0-9" id="h22-0-9" class="i">+                        Some(
</a><a href="#h22-0-10" id="h22-0-10" class="i">+                            (
</a><a href="#h22-0-11" id="h22-0-11" class="i">+                                None,
</a><a href="#h22-0-12" id="h22-0-12" class="i">+                                &quot;released&quot;,
</a><a href="#h22-0-13" id="h22-0-13" class="i">+                            ),
</a><a href="#h22-0-14" id="h22-0-14" class="i">+                        ),
</a><a href="#h22-0-15" id="h22-0-15" class="i">+                    ),
</a><a href="#h22-0-16" id="h22-0-16" class="i">+                    Constant(
</a><a href="#h22-0-17" id="h22-0-17" class="i">+                        Integer(
</a><a href="#h22-0-18" id="h22-0-18" class="i">+                            2000,
</a><a href="#h22-0-19" id="h22-0-19" class="i">+                        ),
</a><a href="#h22-0-20" id="h22-0-20" class="i">+                    ),
</a><a href="#h22-0-21" id="h22-0-21" class="i">+                ),
</a><a href="#h22-0-22" id="h22-0-22" class="i">+                Equal(
</a><a href="#h22-0-23" id="h22-0-23" class="i">+                    Field(
</a><a href="#h22-0-24" id="h22-0-24" class="i">+                        4,
</a><a href="#h22-0-25" id="h22-0-25" class="i">+                        Some(
</a><a href="#h22-0-26" id="h22-0-26" class="i">+                            (
</a><a href="#h22-0-27" id="h22-0-27" class="i">+                                None,
</a><a href="#h22-0-28" id="h22-0-28" class="i">+                                &quot;released&quot;,
</a><a href="#h22-0-29" id="h22-0-29" class="i">+                            ),
</a><a href="#h22-0-30" id="h22-0-30" class="i">+                        ),
</a><a href="#h22-0-31" id="h22-0-31" class="i">+                    ),
</a><a href="#h22-0-32" id="h22-0-32" class="i">+                    Constant(
</a><a href="#h22-0-33" id="h22-0-33" class="i">+                        Integer(
</a><a href="#h22-0-34" id="h22-0-34" class="i">+                            2000,
</a><a href="#h22-0-35" id="h22-0-35" class="i">+                        ),
</a><a href="#h22-0-36" id="h22-0-36" class="i">+                    ),
</a><a href="#h22-0-37" id="h22-0-37" class="i">+                ),
</a><a href="#h22-0-38" id="h22-0-38" class="i">+            ),
</a><a href="#h22-0-39" id="h22-0-39" class="i">+            Field(
</a><a href="#h22-0-40" id="h22-0-40" class="i">+                6,
</a><a href="#h22-0-41" id="h22-0-41" class="i">+                Some(
</a><a href="#h22-0-42" id="h22-0-42" class="i">+                    (
</a><a href="#h22-0-43" id="h22-0-43" class="i">+                        None,
</a><a href="#h22-0-44" id="h22-0-44" class="i">+                        &quot;ultrahd&quot;,
</a><a href="#h22-0-45" id="h22-0-45" class="i">+                    ),
</a><a href="#h22-0-46" id="h22-0-46" class="i">+                ),
</a><a href="#h22-0-47" id="h22-0-47" class="i">+            ),
</a><a href="#h22-0-48" id="h22-0-48" class="i">+        ),
</a><a href="#h22-0-49" id="h22-0-49" class="i">+    },
</a><a href="#h22-0-50" id="h22-0-50" class="i">+)
</a><a href="#h22-0-51" id="h22-0-51" class="i">+
</a><a href="#h22-0-52" id="h22-0-52" class="i">+Optimized plan: Plan(
</a><a href="#h22-0-53" id="h22-0-53" class="i">+    Scan {
</a><a href="#h22-0-54" id="h22-0-54" class="i">+        table: &quot;movies&quot;,
</a><a href="#h22-0-55" id="h22-0-55" class="i">+        alias: None,
</a><a href="#h22-0-56" id="h22-0-56" class="i">+        filter: Some(
</a>             And(
                 Or(
                     GreaterThan(
<a href="#h22-1" id="h22-1" class="h">@@ -95,63 +147,6 @@ Plan: Plan(
</a>     },
 )
 
<a href="#h22-1-3" id="h22-1-3" class="d">-Optimized plan: Plan(
</a><a href="#h22-1-4" id="h22-1-4" class="d">-    Filter {
</a><a href="#h22-1-5" id="h22-1-5" class="d">-        source: Scan {
</a><a href="#h22-1-6" id="h22-1-6" class="d">-            table: &quot;movies&quot;,
</a><a href="#h22-1-7" id="h22-1-7" class="d">-            alias: None,
</a><a href="#h22-1-8" id="h22-1-8" class="d">-            filter: Some(
</a><a href="#h22-1-9" id="h22-1-9" class="d">-                And(
</a><a href="#h22-1-10" id="h22-1-10" class="d">-                    Or(
</a><a href="#h22-1-11" id="h22-1-11" class="d">-                        GreaterThan(
</a><a href="#h22-1-12" id="h22-1-12" class="d">-                            Field(
</a><a href="#h22-1-13" id="h22-1-13" class="d">-                                4,
</a><a href="#h22-1-14" id="h22-1-14" class="d">-                                Some(
</a><a href="#h22-1-15" id="h22-1-15" class="d">-                                    (
</a><a href="#h22-1-16" id="h22-1-16" class="d">-                                        None,
</a><a href="#h22-1-17" id="h22-1-17" class="d">-                                        &quot;released&quot;,
</a><a href="#h22-1-18" id="h22-1-18" class="d">-                                    ),
</a><a href="#h22-1-19" id="h22-1-19" class="d">-                                ),
</a><a href="#h22-1-20" id="h22-1-20" class="d">-                            ),
</a><a href="#h22-1-21" id="h22-1-21" class="d">-                            Constant(
</a><a href="#h22-1-22" id="h22-1-22" class="d">-                                Integer(
</a><a href="#h22-1-23" id="h22-1-23" class="d">-                                    2000,
</a><a href="#h22-1-24" id="h22-1-24" class="d">-                                ),
</a><a href="#h22-1-25" id="h22-1-25" class="d">-                            ),
</a><a href="#h22-1-26" id="h22-1-26" class="d">-                        ),
</a><a href="#h22-1-27" id="h22-1-27" class="d">-                        Equal(
</a><a href="#h22-1-28" id="h22-1-28" class="d">-                            Field(
</a><a href="#h22-1-29" id="h22-1-29" class="d">-                                4,
</a><a href="#h22-1-30" id="h22-1-30" class="d">-                                Some(
</a><a href="#h22-1-31" id="h22-1-31" class="d">-                                    (
</a><a href="#h22-1-32" id="h22-1-32" class="d">-                                        None,
</a><a href="#h22-1-33" id="h22-1-33" class="d">-                                        &quot;released&quot;,
</a><a href="#h22-1-34" id="h22-1-34" class="d">-                                    ),
</a><a href="#h22-1-35" id="h22-1-35" class="d">-                                ),
</a><a href="#h22-1-36" id="h22-1-36" class="d">-                            ),
</a><a href="#h22-1-37" id="h22-1-37" class="d">-                            Constant(
</a><a href="#h22-1-38" id="h22-1-38" class="d">-                                Integer(
</a><a href="#h22-1-39" id="h22-1-39" class="d">-                                    2000,
</a><a href="#h22-1-40" id="h22-1-40" class="d">-                                ),
</a><a href="#h22-1-41" id="h22-1-41" class="d">-                            ),
</a><a href="#h22-1-42" id="h22-1-42" class="d">-                        ),
</a><a href="#h22-1-43" id="h22-1-43" class="d">-                    ),
</a><a href="#h22-1-44" id="h22-1-44" class="d">-                    Field(
</a><a href="#h22-1-45" id="h22-1-45" class="d">-                        6,
</a><a href="#h22-1-46" id="h22-1-46" class="d">-                        Some(
</a><a href="#h22-1-47" id="h22-1-47" class="d">-                            (
</a><a href="#h22-1-48" id="h22-1-48" class="d">-                                None,
</a><a href="#h22-1-49" id="h22-1-49" class="d">-                                &quot;ultrahd&quot;,
</a><a href="#h22-1-50" id="h22-1-50" class="d">-                            ),
</a><a href="#h22-1-51" id="h22-1-51" class="d">-                        ),
</a><a href="#h22-1-52" id="h22-1-52" class="d">-                    ),
</a><a href="#h22-1-53" id="h22-1-53" class="d">-                ),
</a><a href="#h22-1-54" id="h22-1-54" class="d">-            ),
</a><a href="#h22-1-55" id="h22-1-55" class="d">-        },
</a><a href="#h22-1-56" id="h22-1-56" class="d">-        predicate: None,
</a><a href="#h22-1-57" id="h22-1-57" class="d">-    },
</a><a href="#h22-1-58" id="h22-1-58" class="d">-)
</a><a href="#h22-1-59" id="h22-1-59" class="d">-
</a> Query: SELECT * FROM movies WHERE released &gt;= 2000 AND ultrahd
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<b>diff --git a/<a id="h23" href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a> b/<a href="../file/tests/sql/query/where_false.html">tests/sql/query/where_false</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -29,30 +29,25 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h23-0-3" id="h23-0-3" class="d">-        predicate: Some(
</a><a href="#h23-0-4" id="h23-0-4" class="d">-            Constant(
</a><a href="#h23-0-5" id="h23-0-5" class="d">-                Boolean(
</a><a href="#h23-0-6" id="h23-0-6" class="d">-                    false,
</a><a href="#h23-0-7" id="h23-0-7" class="d">-                ),
</a><a href="#h23-0-8" id="h23-0-8" class="i">+        predicate: Constant(
</a><a href="#h23-0-9" id="h23-0-9" class="i">+            Boolean(
</a><a href="#h23-0-10" id="h23-0-10" class="i">+                false,
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h23-0-17" id="h23-0-17" class="d">-    Filter {
</a><a href="#h23-0-18" id="h23-0-18" class="d">-        source: Scan {
</a><a href="#h23-0-19" id="h23-0-19" class="d">-            table: &quot;movies&quot;,
</a><a href="#h23-0-20" id="h23-0-20" class="d">-            alias: None,
</a><a href="#h23-0-21" id="h23-0-21" class="d">-            filter: Some(
</a><a href="#h23-0-22" id="h23-0-22" class="d">-                Constant(
</a><a href="#h23-0-23" id="h23-0-23" class="d">-                    Boolean(
</a><a href="#h23-0-24" id="h23-0-24" class="d">-                        false,
</a><a href="#h23-0-25" id="h23-0-25" class="d">-                    ),
</a><a href="#h23-0-26" id="h23-0-26" class="i">+    Scan {
</a><a href="#h23-0-27" id="h23-0-27" class="i">+        table: &quot;movies&quot;,
</a><a href="#h23-0-28" id="h23-0-28" class="i">+        alias: None,
</a><a href="#h23-0-29" id="h23-0-29" class="i">+        filter: Some(
</a><a href="#h23-0-30" id="h23-0-30" class="i">+            Constant(
</a><a href="#h23-0-31" id="h23-0-31" class="i">+                Boolean(
</a><a href="#h23-0-32" id="h23-0-32" class="i">+                    false,
</a>                 ),
             ),
<a href="#h23-0-35" id="h23-0-35" class="d">-        },
</a><a href="#h23-0-36" id="h23-0-36" class="d">-        predicate: None,
</a><a href="#h23-0-37" id="h23-0-37" class="i">+        ),
</a>     },
 )
 
<b>diff --git a/<a id="h24" href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a> b/<a href="../file/tests/sql/query/where_field_aliased_table.html">tests/sql/query/where_field_aliased_table</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -101,53 +101,33 @@ Plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h24-0-3" id="h24-0-3" class="d">-            predicate: Some(
</a><a href="#h24-0-4" id="h24-0-4" class="d">-                And(
</a><a href="#h24-0-5" id="h24-0-5" class="d">-                    Or(
</a><a href="#h24-0-6" id="h24-0-6" class="d">-                        GreaterThan(
</a><a href="#h24-0-7" id="h24-0-7" class="d">-                            Field(
</a><a href="#h24-0-8" id="h24-0-8" class="d">-                                0,
</a><a href="#h24-0-9" id="h24-0-9" class="d">-                                Some(
</a><a href="#h24-0-10" id="h24-0-10" class="d">-                                    (
</a><a href="#h24-0-11" id="h24-0-11" class="d">-                                        Some(
</a><a href="#h24-0-12" id="h24-0-12" class="d">-                                            &quot;m&quot;,
</a><a href="#h24-0-13" id="h24-0-13" class="d">-                                        ),
</a><a href="#h24-0-14" id="h24-0-14" class="d">-                                        &quot;id&quot;,
</a><a href="#h24-0-15" id="h24-0-15" class="i">+            predicate: And(
</a><a href="#h24-0-16" id="h24-0-16" class="i">+                Or(
</a><a href="#h24-0-17" id="h24-0-17" class="i">+                    GreaterThan(
</a><a href="#h24-0-18" id="h24-0-18" class="i">+                        Field(
</a><a href="#h24-0-19" id="h24-0-19" class="i">+                            0,
</a><a href="#h24-0-20" id="h24-0-20" class="i">+                            Some(
</a><a href="#h24-0-21" id="h24-0-21" class="i">+                                (
</a><a href="#h24-0-22" id="h24-0-22" class="i">+                                    Some(
</a><a href="#h24-0-23" id="h24-0-23" class="i">+                                        &quot;m&quot;,
</a>                                     ),
<a href="#h24-0-25" id="h24-0-25" class="d">-                                ),
</a><a href="#h24-0-26" id="h24-0-26" class="d">-                            ),
</a><a href="#h24-0-27" id="h24-0-27" class="d">-                            Constant(
</a><a href="#h24-0-28" id="h24-0-28" class="d">-                                Integer(
</a><a href="#h24-0-29" id="h24-0-29" class="d">-                                    3,
</a><a href="#h24-0-30" id="h24-0-30" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h24-0-34" id="h24-0-34" class="d">-                        Equal(
</a><a href="#h24-0-35" id="h24-0-35" class="d">-                            Field(
</a><a href="#h24-0-36" id="h24-0-36" class="d">-                                0,
</a><a href="#h24-0-37" id="h24-0-37" class="d">-                                Some(
</a><a href="#h24-0-38" id="h24-0-38" class="d">-                                    (
</a><a href="#h24-0-39" id="h24-0-39" class="d">-                                        Some(
</a><a href="#h24-0-40" id="h24-0-40" class="d">-                                            &quot;m&quot;,
</a><a href="#h24-0-41" id="h24-0-41" class="d">-                                        ),
</a><a href="#h24-0-42" id="h24-0-42" class="d">-                                        &quot;id&quot;,
</a><a href="#h24-0-43" id="h24-0-43" class="d">-                                    ),
</a><a href="#h24-0-44" id="h24-0-44" class="d">-                                ),
</a><a href="#h24-0-45" id="h24-0-45" class="d">-                            ),
</a><a href="#h24-0-46" id="h24-0-46" class="d">-                            Constant(
</a><a href="#h24-0-47" id="h24-0-47" class="d">-                                Integer(
</a><a href="#h24-0-48" id="h24-0-48" class="d">-                                    3,
</a><a href="#h24-0-49" id="h24-0-49" class="d">-                                ),
</a><a href="#h24-0-50" id="h24-0-50" class="i">+                        Constant(
</a><a href="#h24-0-51" id="h24-0-51" class="i">+                            Integer(
</a><a href="#h24-0-52" id="h24-0-52" class="i">+                                3,
</a>                             ),
                         ),
                     ),
                     Equal(
                         Field(
<a href="#h24-0-58" id="h24-0-58" class="d">-                            7,
</a><a href="#h24-0-59" id="h24-0-59" class="i">+                            0,
</a>                             Some(
                                 (
                                     Some(
<a href="#h24-0-63" id="h24-0-63" class="d">-                                        &quot;g&quot;,
</a><a href="#h24-0-64" id="h24-0-64" class="i">+                                        &quot;m&quot;,
</a>                                     ),
                                     &quot;id&quot;,
                                 ),
<a href="#h24-1" id="h24-1" class="h">@@ -155,11 +135,29 @@ Plan: Plan(
</a>                         ),
                         Constant(
                             Integer(
<a href="#h24-1-3" id="h24-1-3" class="d">-                                1,
</a><a href="#h24-1-4" id="h24-1-4" class="i">+                                3,
</a>                             ),
                         ),
                     ),
                 ),
<a href="#h24-1-9" id="h24-1-9" class="i">+                Equal(
</a><a href="#h24-1-10" id="h24-1-10" class="i">+                    Field(
</a><a href="#h24-1-11" id="h24-1-11" class="i">+                        7,
</a><a href="#h24-1-12" id="h24-1-12" class="i">+                        Some(
</a><a href="#h24-1-13" id="h24-1-13" class="i">+                            (
</a><a href="#h24-1-14" id="h24-1-14" class="i">+                                Some(
</a><a href="#h24-1-15" id="h24-1-15" class="i">+                                    &quot;g&quot;,
</a><a href="#h24-1-16" id="h24-1-16" class="i">+                                ),
</a><a href="#h24-1-17" id="h24-1-17" class="i">+                                &quot;id&quot;,
</a><a href="#h24-1-18" id="h24-1-18" class="i">+                            ),
</a><a href="#h24-1-19" id="h24-1-19" class="i">+                        ),
</a><a href="#h24-1-20" id="h24-1-20" class="i">+                    ),
</a><a href="#h24-1-21" id="h24-1-21" class="i">+                    Constant(
</a><a href="#h24-1-22" id="h24-1-22" class="i">+                        Integer(
</a><a href="#h24-1-23" id="h24-1-23" class="i">+                            1,
</a><a href="#h24-1-24" id="h24-1-24" class="i">+                        ),
</a><a href="#h24-1-25" id="h24-1-25" class="i">+                    ),
</a><a href="#h24-1-26" id="h24-1-26" class="i">+                ),
</a>             ),
         },
         expressions: [
<a href="#h24-2" id="h24-2" class="h">@@ -197,71 +195,68 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Projection {
<a href="#h24-2-3" id="h24-2-3" class="d">-        source: Filter {
</a><a href="#h24-2-4" id="h24-2-4" class="d">-            source: NestedLoopJoin {
</a><a href="#h24-2-5" id="h24-2-5" class="d">-                outer: Scan {
</a><a href="#h24-2-6" id="h24-2-6" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h24-2-7" id="h24-2-7" class="d">-                    alias: Some(
</a><a href="#h24-2-8" id="h24-2-8" class="d">-                        &quot;m&quot;,
</a><a href="#h24-2-9" id="h24-2-9" class="d">-                    ),
</a><a href="#h24-2-10" id="h24-2-10" class="d">-                    filter: Some(
</a><a href="#h24-2-11" id="h24-2-11" class="d">-                        Or(
</a><a href="#h24-2-12" id="h24-2-12" class="d">-                            GreaterThan(
</a><a href="#h24-2-13" id="h24-2-13" class="d">-                                Field(
</a><a href="#h24-2-14" id="h24-2-14" class="d">-                                    0,
</a><a href="#h24-2-15" id="h24-2-15" class="d">-                                    Some(
</a><a href="#h24-2-16" id="h24-2-16" class="d">-                                        (
</a><a href="#h24-2-17" id="h24-2-17" class="d">-                                            Some(
</a><a href="#h24-2-18" id="h24-2-18" class="d">-                                                &quot;m&quot;,
</a><a href="#h24-2-19" id="h24-2-19" class="d">-                                            ),
</a><a href="#h24-2-20" id="h24-2-20" class="d">-                                            &quot;id&quot;,
</a><a href="#h24-2-21" id="h24-2-21" class="i">+        source: NestedLoopJoin {
</a><a href="#h24-2-22" id="h24-2-22" class="i">+            outer: Scan {
</a><a href="#h24-2-23" id="h24-2-23" class="i">+                table: &quot;movies&quot;,
</a><a href="#h24-2-24" id="h24-2-24" class="i">+                alias: Some(
</a><a href="#h24-2-25" id="h24-2-25" class="i">+                    &quot;m&quot;,
</a><a href="#h24-2-26" id="h24-2-26" class="i">+                ),
</a><a href="#h24-2-27" id="h24-2-27" class="i">+                filter: Some(
</a><a href="#h24-2-28" id="h24-2-28" class="i">+                    Or(
</a><a href="#h24-2-29" id="h24-2-29" class="i">+                        GreaterThan(
</a><a href="#h24-2-30" id="h24-2-30" class="i">+                            Field(
</a><a href="#h24-2-31" id="h24-2-31" class="i">+                                0,
</a><a href="#h24-2-32" id="h24-2-32" class="i">+                                Some(
</a><a href="#h24-2-33" id="h24-2-33" class="i">+                                    (
</a><a href="#h24-2-34" id="h24-2-34" class="i">+                                        Some(
</a><a href="#h24-2-35" id="h24-2-35" class="i">+                                            &quot;m&quot;,
</a>                                         ),
<a href="#h24-2-37" id="h24-2-37" class="i">+                                        &quot;id&quot;,
</a>                                     ),
                                 ),
<a href="#h24-2-40" id="h24-2-40" class="d">-                                Constant(
</a><a href="#h24-2-41" id="h24-2-41" class="d">-                                    Integer(
</a><a href="#h24-2-42" id="h24-2-42" class="d">-                                        3,
</a><a href="#h24-2-43" id="h24-2-43" class="d">-                                    ),
</a><a href="#h24-2-44" id="h24-2-44" class="i">+                            ),
</a><a href="#h24-2-45" id="h24-2-45" class="i">+                            Constant(
</a><a href="#h24-2-46" id="h24-2-46" class="i">+                                Integer(
</a><a href="#h24-2-47" id="h24-2-47" class="i">+                                    3,
</a>                                 ),
                             ),
<a href="#h24-2-50" id="h24-2-50" class="d">-                            Equal(
</a><a href="#h24-2-51" id="h24-2-51" class="d">-                                Field(
</a><a href="#h24-2-52" id="h24-2-52" class="d">-                                    0,
</a><a href="#h24-2-53" id="h24-2-53" class="d">-                                    Some(
</a><a href="#h24-2-54" id="h24-2-54" class="d">-                                        (
</a><a href="#h24-2-55" id="h24-2-55" class="d">-                                            Some(
</a><a href="#h24-2-56" id="h24-2-56" class="d">-                                                &quot;m&quot;,
</a><a href="#h24-2-57" id="h24-2-57" class="d">-                                            ),
</a><a href="#h24-2-58" id="h24-2-58" class="d">-                                            &quot;id&quot;,
</a><a href="#h24-2-59" id="h24-2-59" class="i">+                        ),
</a><a href="#h24-2-60" id="h24-2-60" class="i">+                        Equal(
</a><a href="#h24-2-61" id="h24-2-61" class="i">+                            Field(
</a><a href="#h24-2-62" id="h24-2-62" class="i">+                                0,
</a><a href="#h24-2-63" id="h24-2-63" class="i">+                                Some(
</a><a href="#h24-2-64" id="h24-2-64" class="i">+                                    (
</a><a href="#h24-2-65" id="h24-2-65" class="i">+                                        Some(
</a><a href="#h24-2-66" id="h24-2-66" class="i">+                                            &quot;m&quot;,
</a>                                         ),
<a href="#h24-2-68" id="h24-2-68" class="i">+                                        &quot;id&quot;,
</a>                                     ),
                                 ),
<a href="#h24-2-71" id="h24-2-71" class="d">-                                Constant(
</a><a href="#h24-2-72" id="h24-2-72" class="d">-                                    Integer(
</a><a href="#h24-2-73" id="h24-2-73" class="d">-                                        3,
</a><a href="#h24-2-74" id="h24-2-74" class="d">-                                    ),
</a><a href="#h24-2-75" id="h24-2-75" class="i">+                            ),
</a><a href="#h24-2-76" id="h24-2-76" class="i">+                            Constant(
</a><a href="#h24-2-77" id="h24-2-77" class="i">+                                Integer(
</a><a href="#h24-2-78" id="h24-2-78" class="i">+                                    3,
</a>                                 ),
                             ),
                         ),
                     ),
<a href="#h24-2-83" id="h24-2-83" class="d">-                },
</a><a href="#h24-2-84" id="h24-2-84" class="d">-                outer_size: 7,
</a><a href="#h24-2-85" id="h24-2-85" class="d">-                inner: KeyLookup {
</a><a href="#h24-2-86" id="h24-2-86" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h24-2-87" id="h24-2-87" class="d">-                    alias: Some(
</a><a href="#h24-2-88" id="h24-2-88" class="d">-                        &quot;g&quot;,
</a><a href="#h24-2-89" id="h24-2-89" class="i">+                ),
</a><a href="#h24-2-90" id="h24-2-90" class="i">+            },
</a><a href="#h24-2-91" id="h24-2-91" class="i">+            outer_size: 7,
</a><a href="#h24-2-92" id="h24-2-92" class="i">+            inner: KeyLookup {
</a><a href="#h24-2-93" id="h24-2-93" class="i">+                table: &quot;genres&quot;,
</a><a href="#h24-2-94" id="h24-2-94" class="i">+                alias: Some(
</a><a href="#h24-2-95" id="h24-2-95" class="i">+                    &quot;g&quot;,
</a><a href="#h24-2-96" id="h24-2-96" class="i">+                ),
</a><a href="#h24-2-97" id="h24-2-97" class="i">+                keys: [
</a><a href="#h24-2-98" id="h24-2-98" class="i">+                    Integer(
</a><a href="#h24-2-99" id="h24-2-99" class="i">+                        1,
</a>                     ),
<a href="#h24-2-101" id="h24-2-101" class="d">-                    keys: [
</a><a href="#h24-2-102" id="h24-2-102" class="d">-                        Integer(
</a><a href="#h24-2-103" id="h24-2-103" class="d">-                            1,
</a><a href="#h24-2-104" id="h24-2-104" class="d">-                        ),
</a><a href="#h24-2-105" id="h24-2-105" class="d">-                    ],
</a><a href="#h24-2-106" id="h24-2-106" class="d">-                },
</a><a href="#h24-2-107" id="h24-2-107" class="d">-                predicate: None,
</a><a href="#h24-2-108" id="h24-2-108" class="d">-                pad: false,
</a><a href="#h24-2-109" id="h24-2-109" class="d">-                flip: false,
</a><a href="#h24-2-110" id="h24-2-110" class="i">+                ],
</a>             },
             predicate: None,
<a href="#h24-2-113" id="h24-2-113" class="i">+            pad: false,
</a><a href="#h24-2-114" id="h24-2-114" class="i">+            flip: false,
</a>         },
         expressions: [
             (
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a> b/<a href="../file/tests/sql/query/where_field_qualified.html">tests/sql/query/where_field_qualified</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -93,53 +93,33 @@ Plan: Plan(
</a>                 pad: false,
                 flip: false,
             },
<a href="#h25-0-3" id="h25-0-3" class="d">-            predicate: Some(
</a><a href="#h25-0-4" id="h25-0-4" class="d">-                And(
</a><a href="#h25-0-5" id="h25-0-5" class="d">-                    Or(
</a><a href="#h25-0-6" id="h25-0-6" class="d">-                        GreaterThan(
</a><a href="#h25-0-7" id="h25-0-7" class="d">-                            Field(
</a><a href="#h25-0-8" id="h25-0-8" class="d">-                                0,
</a><a href="#h25-0-9" id="h25-0-9" class="d">-                                Some(
</a><a href="#h25-0-10" id="h25-0-10" class="d">-                                    (
</a><a href="#h25-0-11" id="h25-0-11" class="d">-                                        Some(
</a><a href="#h25-0-12" id="h25-0-12" class="d">-                                            &quot;movies&quot;,
</a><a href="#h25-0-13" id="h25-0-13" class="d">-                                        ),
</a><a href="#h25-0-14" id="h25-0-14" class="d">-                                        &quot;id&quot;,
</a><a href="#h25-0-15" id="h25-0-15" class="i">+            predicate: And(
</a><a href="#h25-0-16" id="h25-0-16" class="i">+                Or(
</a><a href="#h25-0-17" id="h25-0-17" class="i">+                    GreaterThan(
</a><a href="#h25-0-18" id="h25-0-18" class="i">+                        Field(
</a><a href="#h25-0-19" id="h25-0-19" class="i">+                            0,
</a><a href="#h25-0-20" id="h25-0-20" class="i">+                            Some(
</a><a href="#h25-0-21" id="h25-0-21" class="i">+                                (
</a><a href="#h25-0-22" id="h25-0-22" class="i">+                                    Some(
</a><a href="#h25-0-23" id="h25-0-23" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
<a href="#h25-0-25" id="h25-0-25" class="d">-                                ),
</a><a href="#h25-0-26" id="h25-0-26" class="d">-                            ),
</a><a href="#h25-0-27" id="h25-0-27" class="d">-                            Constant(
</a><a href="#h25-0-28" id="h25-0-28" class="d">-                                Integer(
</a><a href="#h25-0-29" id="h25-0-29" class="d">-                                    3,
</a><a href="#h25-0-30" id="h25-0-30" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h25-0-34" id="h25-0-34" class="d">-                        Equal(
</a><a href="#h25-0-35" id="h25-0-35" class="d">-                            Field(
</a><a href="#h25-0-36" id="h25-0-36" class="d">-                                0,
</a><a href="#h25-0-37" id="h25-0-37" class="d">-                                Some(
</a><a href="#h25-0-38" id="h25-0-38" class="d">-                                    (
</a><a href="#h25-0-39" id="h25-0-39" class="d">-                                        Some(
</a><a href="#h25-0-40" id="h25-0-40" class="d">-                                            &quot;movies&quot;,
</a><a href="#h25-0-41" id="h25-0-41" class="d">-                                        ),
</a><a href="#h25-0-42" id="h25-0-42" class="d">-                                        &quot;id&quot;,
</a><a href="#h25-0-43" id="h25-0-43" class="d">-                                    ),
</a><a href="#h25-0-44" id="h25-0-44" class="d">-                                ),
</a><a href="#h25-0-45" id="h25-0-45" class="d">-                            ),
</a><a href="#h25-0-46" id="h25-0-46" class="d">-                            Constant(
</a><a href="#h25-0-47" id="h25-0-47" class="d">-                                Integer(
</a><a href="#h25-0-48" id="h25-0-48" class="d">-                                    3,
</a><a href="#h25-0-49" id="h25-0-49" class="d">-                                ),
</a><a href="#h25-0-50" id="h25-0-50" class="i">+                        Constant(
</a><a href="#h25-0-51" id="h25-0-51" class="i">+                            Integer(
</a><a href="#h25-0-52" id="h25-0-52" class="i">+                                3,
</a>                             ),
                         ),
                     ),
                     Equal(
                         Field(
<a href="#h25-0-58" id="h25-0-58" class="d">-                            7,
</a><a href="#h25-0-59" id="h25-0-59" class="i">+                            0,
</a>                             Some(
                                 (
                                     Some(
<a href="#h25-0-63" id="h25-0-63" class="d">-                                        &quot;genres&quot;,
</a><a href="#h25-0-64" id="h25-0-64" class="i">+                                        &quot;movies&quot;,
</a>                                     ),
                                     &quot;id&quot;,
                                 ),
<a href="#h25-1" id="h25-1" class="h">@@ -147,10 +127,28 @@ Plan: Plan(
</a>                         ),
                         Constant(
                             Integer(
<a href="#h25-1-3" id="h25-1-3" class="d">-                                1,
</a><a href="#h25-1-4" id="h25-1-4" class="i">+                                3,
</a><a href="#h25-1-5" id="h25-1-5" class="i">+                            ),
</a><a href="#h25-1-6" id="h25-1-6" class="i">+                        ),
</a><a href="#h25-1-7" id="h25-1-7" class="i">+                    ),
</a><a href="#h25-1-8" id="h25-1-8" class="i">+                ),
</a><a href="#h25-1-9" id="h25-1-9" class="i">+                Equal(
</a><a href="#h25-1-10" id="h25-1-10" class="i">+                    Field(
</a><a href="#h25-1-11" id="h25-1-11" class="i">+                        7,
</a><a href="#h25-1-12" id="h25-1-12" class="i">+                        Some(
</a><a href="#h25-1-13" id="h25-1-13" class="i">+                            (
</a><a href="#h25-1-14" id="h25-1-14" class="i">+                                Some(
</a><a href="#h25-1-15" id="h25-1-15" class="i">+                                    &quot;genres&quot;,
</a><a href="#h25-1-16" id="h25-1-16" class="i">+                                ),
</a><a href="#h25-1-17" id="h25-1-17" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
                     ),
<a href="#h25-1-21" id="h25-1-21" class="i">+                    Constant(
</a><a href="#h25-1-22" id="h25-1-22" class="i">+                        Integer(
</a><a href="#h25-1-23" id="h25-1-23" class="i">+                            1,
</a><a href="#h25-1-24" id="h25-1-24" class="i">+                        ),
</a><a href="#h25-1-25" id="h25-1-25" class="i">+                    ),
</a>                 ),
             ),
         },
<a href="#h25-2" id="h25-2" class="h">@@ -189,67 +187,64 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Projection {
<a href="#h25-2-3" id="h25-2-3" class="d">-        source: Filter {
</a><a href="#h25-2-4" id="h25-2-4" class="d">-            source: NestedLoopJoin {
</a><a href="#h25-2-5" id="h25-2-5" class="d">-                outer: Scan {
</a><a href="#h25-2-6" id="h25-2-6" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h25-2-7" id="h25-2-7" class="d">-                    alias: None,
</a><a href="#h25-2-8" id="h25-2-8" class="d">-                    filter: Some(
</a><a href="#h25-2-9" id="h25-2-9" class="d">-                        Or(
</a><a href="#h25-2-10" id="h25-2-10" class="d">-                            GreaterThan(
</a><a href="#h25-2-11" id="h25-2-11" class="d">-                                Field(
</a><a href="#h25-2-12" id="h25-2-12" class="d">-                                    0,
</a><a href="#h25-2-13" id="h25-2-13" class="d">-                                    Some(
</a><a href="#h25-2-14" id="h25-2-14" class="d">-                                        (
</a><a href="#h25-2-15" id="h25-2-15" class="d">-                                            Some(
</a><a href="#h25-2-16" id="h25-2-16" class="d">-                                                &quot;movies&quot;,
</a><a href="#h25-2-17" id="h25-2-17" class="d">-                                            ),
</a><a href="#h25-2-18" id="h25-2-18" class="d">-                                            &quot;id&quot;,
</a><a href="#h25-2-19" id="h25-2-19" class="i">+        source: NestedLoopJoin {
</a><a href="#h25-2-20" id="h25-2-20" class="i">+            outer: Scan {
</a><a href="#h25-2-21" id="h25-2-21" class="i">+                table: &quot;movies&quot;,
</a><a href="#h25-2-22" id="h25-2-22" class="i">+                alias: None,
</a><a href="#h25-2-23" id="h25-2-23" class="i">+                filter: Some(
</a><a href="#h25-2-24" id="h25-2-24" class="i">+                    Or(
</a><a href="#h25-2-25" id="h25-2-25" class="i">+                        GreaterThan(
</a><a href="#h25-2-26" id="h25-2-26" class="i">+                            Field(
</a><a href="#h25-2-27" id="h25-2-27" class="i">+                                0,
</a><a href="#h25-2-28" id="h25-2-28" class="i">+                                Some(
</a><a href="#h25-2-29" id="h25-2-29" class="i">+                                    (
</a><a href="#h25-2-30" id="h25-2-30" class="i">+                                        Some(
</a><a href="#h25-2-31" id="h25-2-31" class="i">+                                            &quot;movies&quot;,
</a>                                         ),
<a href="#h25-2-33" id="h25-2-33" class="i">+                                        &quot;id&quot;,
</a>                                     ),
                                 ),
<a href="#h25-2-36" id="h25-2-36" class="d">-                                Constant(
</a><a href="#h25-2-37" id="h25-2-37" class="d">-                                    Integer(
</a><a href="#h25-2-38" id="h25-2-38" class="d">-                                        3,
</a><a href="#h25-2-39" id="h25-2-39" class="d">-                                    ),
</a><a href="#h25-2-40" id="h25-2-40" class="i">+                            ),
</a><a href="#h25-2-41" id="h25-2-41" class="i">+                            Constant(
</a><a href="#h25-2-42" id="h25-2-42" class="i">+                                Integer(
</a><a href="#h25-2-43" id="h25-2-43" class="i">+                                    3,
</a>                                 ),
                             ),
<a href="#h25-2-46" id="h25-2-46" class="d">-                            Equal(
</a><a href="#h25-2-47" id="h25-2-47" class="d">-                                Field(
</a><a href="#h25-2-48" id="h25-2-48" class="d">-                                    0,
</a><a href="#h25-2-49" id="h25-2-49" class="d">-                                    Some(
</a><a href="#h25-2-50" id="h25-2-50" class="d">-                                        (
</a><a href="#h25-2-51" id="h25-2-51" class="d">-                                            Some(
</a><a href="#h25-2-52" id="h25-2-52" class="d">-                                                &quot;movies&quot;,
</a><a href="#h25-2-53" id="h25-2-53" class="d">-                                            ),
</a><a href="#h25-2-54" id="h25-2-54" class="d">-                                            &quot;id&quot;,
</a><a href="#h25-2-55" id="h25-2-55" class="i">+                        ),
</a><a href="#h25-2-56" id="h25-2-56" class="i">+                        Equal(
</a><a href="#h25-2-57" id="h25-2-57" class="i">+                            Field(
</a><a href="#h25-2-58" id="h25-2-58" class="i">+                                0,
</a><a href="#h25-2-59" id="h25-2-59" class="i">+                                Some(
</a><a href="#h25-2-60" id="h25-2-60" class="i">+                                    (
</a><a href="#h25-2-61" id="h25-2-61" class="i">+                                        Some(
</a><a href="#h25-2-62" id="h25-2-62" class="i">+                                            &quot;movies&quot;,
</a>                                         ),
<a href="#h25-2-64" id="h25-2-64" class="i">+                                        &quot;id&quot;,
</a>                                     ),
                                 ),
<a href="#h25-2-67" id="h25-2-67" class="d">-                                Constant(
</a><a href="#h25-2-68" id="h25-2-68" class="d">-                                    Integer(
</a><a href="#h25-2-69" id="h25-2-69" class="d">-                                        3,
</a><a href="#h25-2-70" id="h25-2-70" class="d">-                                    ),
</a><a href="#h25-2-71" id="h25-2-71" class="i">+                            ),
</a><a href="#h25-2-72" id="h25-2-72" class="i">+                            Constant(
</a><a href="#h25-2-73" id="h25-2-73" class="i">+                                Integer(
</a><a href="#h25-2-74" id="h25-2-74" class="i">+                                    3,
</a>                                 ),
                             ),
                         ),
                     ),
<a href="#h25-2-79" id="h25-2-79" class="d">-                },
</a><a href="#h25-2-80" id="h25-2-80" class="d">-                outer_size: 7,
</a><a href="#h25-2-81" id="h25-2-81" class="d">-                inner: KeyLookup {
</a><a href="#h25-2-82" id="h25-2-82" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h25-2-83" id="h25-2-83" class="d">-                    alias: None,
</a><a href="#h25-2-84" id="h25-2-84" class="d">-                    keys: [
</a><a href="#h25-2-85" id="h25-2-85" class="d">-                        Integer(
</a><a href="#h25-2-86" id="h25-2-86" class="d">-                            1,
</a><a href="#h25-2-87" id="h25-2-87" class="d">-                        ),
</a><a href="#h25-2-88" id="h25-2-88" class="d">-                    ],
</a><a href="#h25-2-89" id="h25-2-89" class="d">-                },
</a><a href="#h25-2-90" id="h25-2-90" class="d">-                predicate: None,
</a><a href="#h25-2-91" id="h25-2-91" class="d">-                pad: false,
</a><a href="#h25-2-92" id="h25-2-92" class="d">-                flip: false,
</a><a href="#h25-2-93" id="h25-2-93" class="i">+                ),
</a><a href="#h25-2-94" id="h25-2-94" class="i">+            },
</a><a href="#h25-2-95" id="h25-2-95" class="i">+            outer_size: 7,
</a><a href="#h25-2-96" id="h25-2-96" class="i">+            inner: KeyLookup {
</a><a href="#h25-2-97" id="h25-2-97" class="i">+                table: &quot;genres&quot;,
</a><a href="#h25-2-98" id="h25-2-98" class="i">+                alias: None,
</a><a href="#h25-2-99" id="h25-2-99" class="i">+                keys: [
</a><a href="#h25-2-100" id="h25-2-100" class="i">+                    Integer(
</a><a href="#h25-2-101" id="h25-2-101" class="i">+                        1,
</a><a href="#h25-2-102" id="h25-2-102" class="i">+                    ),
</a><a href="#h25-2-103" id="h25-2-103" class="i">+                ],
</a>             },
             predicate: None,
<a href="#h25-2-106" id="h25-2-106" class="i">+            pad: false,
</a><a href="#h25-2-107" id="h25-2-107" class="i">+            flip: false,
</a>         },
         expressions: [
             (
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a> b/<a href="../file/tests/sql/query/where_float.html">tests/sql/query/where_float</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -29,30 +29,25 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h26-0-3" id="h26-0-3" class="d">-        predicate: Some(
</a><a href="#h26-0-4" id="h26-0-4" class="d">-            Constant(
</a><a href="#h26-0-5" id="h26-0-5" class="d">-                Float(
</a><a href="#h26-0-6" id="h26-0-6" class="d">-                    3.14,
</a><a href="#h26-0-7" id="h26-0-7" class="d">-                ),
</a><a href="#h26-0-8" id="h26-0-8" class="i">+        predicate: Constant(
</a><a href="#h26-0-9" id="h26-0-9" class="i">+            Float(
</a><a href="#h26-0-10" id="h26-0-10" class="i">+                3.14,
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h26-0-17" id="h26-0-17" class="d">-    Filter {
</a><a href="#h26-0-18" id="h26-0-18" class="d">-        source: Scan {
</a><a href="#h26-0-19" id="h26-0-19" class="d">-            table: &quot;movies&quot;,
</a><a href="#h26-0-20" id="h26-0-20" class="d">-            alias: None,
</a><a href="#h26-0-21" id="h26-0-21" class="d">-            filter: Some(
</a><a href="#h26-0-22" id="h26-0-22" class="d">-                Constant(
</a><a href="#h26-0-23" id="h26-0-23" class="d">-                    Float(
</a><a href="#h26-0-24" id="h26-0-24" class="d">-                        3.14,
</a><a href="#h26-0-25" id="h26-0-25" class="d">-                    ),
</a><a href="#h26-0-26" id="h26-0-26" class="i">+    Scan {
</a><a href="#h26-0-27" id="h26-0-27" class="i">+        table: &quot;movies&quot;,
</a><a href="#h26-0-28" id="h26-0-28" class="i">+        alias: None,
</a><a href="#h26-0-29" id="h26-0-29" class="i">+        filter: Some(
</a><a href="#h26-0-30" id="h26-0-30" class="i">+            Constant(
</a><a href="#h26-0-31" id="h26-0-31" class="i">+                Float(
</a><a href="#h26-0-32" id="h26-0-32" class="i">+                    3.14,
</a>                 ),
             ),
<a href="#h26-0-35" id="h26-0-35" class="d">-        },
</a><a href="#h26-0-36" id="h26-0-36" class="d">-        predicate: None,
</a><a href="#h26-0-37" id="h26-0-37" class="i">+        ),
</a>     },
 )
 
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a> b/<a href="../file/tests/sql/query/where_index.html">tests/sql/query/where_index</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -46,21 +46,19 @@ Plan: Plan(
</a>                 alias: None,
                 filter: None,
             },
<a href="#h27-0-3" id="h27-0-3" class="d">-            predicate: Some(
</a><a href="#h27-0-4" id="h27-0-4" class="d">-                Equal(
</a><a href="#h27-0-5" id="h27-0-5" class="d">-                    Field(
</a><a href="#h27-0-6" id="h27-0-6" class="d">-                        3,
</a><a href="#h27-0-7" id="h27-0-7" class="d">-                        Some(
</a><a href="#h27-0-8" id="h27-0-8" class="d">-                            (
</a><a href="#h27-0-9" id="h27-0-9" class="d">-                                None,
</a><a href="#h27-0-10" id="h27-0-10" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h27-0-11" id="h27-0-11" class="d">-                            ),
</a><a href="#h27-0-12" id="h27-0-12" class="i">+            predicate: Equal(
</a><a href="#h27-0-13" id="h27-0-13" class="i">+                Field(
</a><a href="#h27-0-14" id="h27-0-14" class="i">+                    3,
</a><a href="#h27-0-15" id="h27-0-15" class="i">+                    Some(
</a><a href="#h27-0-16" id="h27-0-16" class="i">+                        (
</a><a href="#h27-0-17" id="h27-0-17" class="i">+                            None,
</a><a href="#h27-0-18" id="h27-0-18" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
<a href="#h27-0-21" id="h27-0-21" class="d">-                    Constant(
</a><a href="#h27-0-22" id="h27-0-22" class="d">-                        Integer(
</a><a href="#h27-0-23" id="h27-0-23" class="d">-                            2,
</a><a href="#h27-0-24" id="h27-0-24" class="d">-                        ),
</a><a href="#h27-0-25" id="h27-0-25" class="i">+                ),
</a><a href="#h27-0-26" id="h27-0-26" class="i">+                Constant(
</a><a href="#h27-0-27" id="h27-0-27" class="i">+                    Integer(
</a><a href="#h27-0-28" id="h27-0-28" class="i">+                        2,
</a>                     ),
                 ),
             ),
<a href="#h27-1" id="h27-1" class="h">@@ -84,18 +82,15 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Order {
<a href="#h27-1-3" id="h27-1-3" class="d">-        source: Filter {
</a><a href="#h27-1-4" id="h27-1-4" class="d">-            source: IndexLookup {
</a><a href="#h27-1-5" id="h27-1-5" class="d">-                table: &quot;movies&quot;,
</a><a href="#h27-1-6" id="h27-1-6" class="d">-                alias: None,
</a><a href="#h27-1-7" id="h27-1-7" class="d">-                column: &quot;genre_id&quot;,
</a><a href="#h27-1-8" id="h27-1-8" class="d">-                values: [
</a><a href="#h27-1-9" id="h27-1-9" class="d">-                    Integer(
</a><a href="#h27-1-10" id="h27-1-10" class="d">-                        2,
</a><a href="#h27-1-11" id="h27-1-11" class="d">-                    ),
</a><a href="#h27-1-12" id="h27-1-12" class="d">-                ],
</a><a href="#h27-1-13" id="h27-1-13" class="d">-            },
</a><a href="#h27-1-14" id="h27-1-14" class="d">-            predicate: None,
</a><a href="#h27-1-15" id="h27-1-15" class="i">+        source: IndexLookup {
</a><a href="#h27-1-16" id="h27-1-16" class="i">+            table: &quot;movies&quot;,
</a><a href="#h27-1-17" id="h27-1-17" class="i">+            alias: None,
</a><a href="#h27-1-18" id="h27-1-18" class="i">+            column: &quot;genre_id&quot;,
</a><a href="#h27-1-19" id="h27-1-19" class="i">+            values: [
</a><a href="#h27-1-20" id="h27-1-20" class="i">+                Integer(
</a><a href="#h27-1-21" id="h27-1-21" class="i">+                    2,
</a><a href="#h27-1-22" id="h27-1-22" class="i">+                ),
</a><a href="#h27-1-23" id="h27-1-23" class="i">+            ],
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h28" href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a> b/<a href="../file/tests/sql/query/where_index_or.html">tests/sql/query/where_index_or</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -97,40 +97,22 @@ Plan: Plan(
</a>                 alias: None,
                 filter: None,
             },
<a href="#h28-0-3" id="h28-0-3" class="d">-            predicate: Some(
</a><a href="#h28-0-4" id="h28-0-4" class="i">+            predicate: Or(
</a>                 Or(
                     Or(
<a href="#h28-0-7" id="h28-0-7" class="d">-                        Or(
</a><a href="#h28-0-8" id="h28-0-8" class="d">-                            Equal(
</a><a href="#h28-0-9" id="h28-0-9" class="d">-                                Field(
</a><a href="#h28-0-10" id="h28-0-10" class="d">-                                    3,
</a><a href="#h28-0-11" id="h28-0-11" class="d">-                                    Some(
</a><a href="#h28-0-12" id="h28-0-12" class="d">-                                        (
</a><a href="#h28-0-13" id="h28-0-13" class="d">-                                            None,
</a><a href="#h28-0-14" id="h28-0-14" class="d">-                                            &quot;genre_id&quot;,
</a><a href="#h28-0-15" id="h28-0-15" class="d">-                                        ),
</a><a href="#h28-0-16" id="h28-0-16" class="d">-                                    ),
</a><a href="#h28-0-17" id="h28-0-17" class="d">-                                ),
</a><a href="#h28-0-18" id="h28-0-18" class="d">-                                Constant(
</a><a href="#h28-0-19" id="h28-0-19" class="d">-                                    Integer(
</a><a href="#h28-0-20" id="h28-0-20" class="d">-                                        2,
</a><a href="#h28-0-21" id="h28-0-21" class="i">+                        Equal(
</a><a href="#h28-0-22" id="h28-0-22" class="i">+                            Field(
</a><a href="#h28-0-23" id="h28-0-23" class="i">+                                3,
</a><a href="#h28-0-24" id="h28-0-24" class="i">+                                Some(
</a><a href="#h28-0-25" id="h28-0-25" class="i">+                                    (
</a><a href="#h28-0-26" id="h28-0-26" class="i">+                                        None,
</a><a href="#h28-0-27" id="h28-0-27" class="i">+                                        &quot;genre_id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h28-0-31" id="h28-0-31" class="d">-                            Equal(
</a><a href="#h28-0-32" id="h28-0-32" class="d">-                                Field(
</a><a href="#h28-0-33" id="h28-0-33" class="d">-                                    3,
</a><a href="#h28-0-34" id="h28-0-34" class="d">-                                    Some(
</a><a href="#h28-0-35" id="h28-0-35" class="d">-                                        (
</a><a href="#h28-0-36" id="h28-0-36" class="d">-                                            None,
</a><a href="#h28-0-37" id="h28-0-37" class="d">-                                            &quot;genre_id&quot;,
</a><a href="#h28-0-38" id="h28-0-38" class="d">-                                        ),
</a><a href="#h28-0-39" id="h28-0-39" class="d">-                                    ),
</a><a href="#h28-0-40" id="h28-0-40" class="d">-                                ),
</a><a href="#h28-0-41" id="h28-0-41" class="d">-                                Constant(
</a><a href="#h28-0-42" id="h28-0-42" class="d">-                                    Integer(
</a><a href="#h28-0-43" id="h28-0-43" class="d">-                                        3,
</a><a href="#h28-0-44" id="h28-0-44" class="d">-                                    ),
</a><a href="#h28-0-45" id="h28-0-45" class="i">+                            Constant(
</a><a href="#h28-0-46" id="h28-0-46" class="i">+                                Integer(
</a><a href="#h28-0-47" id="h28-0-47" class="i">+                                    2,
</a>                                 ),
                             ),
                         ),
<a href="#h28-1" id="h28-1" class="h">@@ -146,7 +128,7 @@ Plan: Plan(
</a>                             ),
                             Constant(
                                 Integer(
<a href="#h28-1-3" id="h28-1-3" class="d">-                                    4,
</a><a href="#h28-1-4" id="h28-1-4" class="i">+                                    3,
</a>                                 ),
                             ),
                         ),
<a href="#h28-2" id="h28-2" class="h">@@ -163,11 +145,27 @@ Plan: Plan(
</a>                         ),
                         Constant(
                             Integer(
<a href="#h28-2-3" id="h28-2-3" class="d">-                                5,
</a><a href="#h28-2-4" id="h28-2-4" class="i">+                                4,
</a>                             ),
                         ),
                     ),
                 ),
<a href="#h28-2-9" id="h28-2-9" class="i">+                Equal(
</a><a href="#h28-2-10" id="h28-2-10" class="i">+                    Field(
</a><a href="#h28-2-11" id="h28-2-11" class="i">+                        3,
</a><a href="#h28-2-12" id="h28-2-12" class="i">+                        Some(
</a><a href="#h28-2-13" id="h28-2-13" class="i">+                            (
</a><a href="#h28-2-14" id="h28-2-14" class="i">+                                None,
</a><a href="#h28-2-15" id="h28-2-15" class="i">+                                &quot;genre_id&quot;,
</a><a href="#h28-2-16" id="h28-2-16" class="i">+                            ),
</a><a href="#h28-2-17" id="h28-2-17" class="i">+                        ),
</a><a href="#h28-2-18" id="h28-2-18" class="i">+                    ),
</a><a href="#h28-2-19" id="h28-2-19" class="i">+                    Constant(
</a><a href="#h28-2-20" id="h28-2-20" class="i">+                        Integer(
</a><a href="#h28-2-21" id="h28-2-21" class="i">+                            5,
</a><a href="#h28-2-22" id="h28-2-22" class="i">+                        ),
</a><a href="#h28-2-23" id="h28-2-23" class="i">+                    ),
</a><a href="#h28-2-24" id="h28-2-24" class="i">+                ),
</a>             ),
         },
         orders: [
<a href="#h28-3" id="h28-3" class="h">@@ -189,27 +187,24 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Order {
<a href="#h28-3-3" id="h28-3-3" class="d">-        source: Filter {
</a><a href="#h28-3-4" id="h28-3-4" class="d">-            source: IndexLookup {
</a><a href="#h28-3-5" id="h28-3-5" class="d">-                table: &quot;movies&quot;,
</a><a href="#h28-3-6" id="h28-3-6" class="d">-                alias: None,
</a><a href="#h28-3-7" id="h28-3-7" class="d">-                column: &quot;genre_id&quot;,
</a><a href="#h28-3-8" id="h28-3-8" class="d">-                values: [
</a><a href="#h28-3-9" id="h28-3-9" class="d">-                    Integer(
</a><a href="#h28-3-10" id="h28-3-10" class="d">-                        2,
</a><a href="#h28-3-11" id="h28-3-11" class="d">-                    ),
</a><a href="#h28-3-12" id="h28-3-12" class="d">-                    Integer(
</a><a href="#h28-3-13" id="h28-3-13" class="d">-                        3,
</a><a href="#h28-3-14" id="h28-3-14" class="d">-                    ),
</a><a href="#h28-3-15" id="h28-3-15" class="d">-                    Integer(
</a><a href="#h28-3-16" id="h28-3-16" class="d">-                        4,
</a><a href="#h28-3-17" id="h28-3-17" class="d">-                    ),
</a><a href="#h28-3-18" id="h28-3-18" class="d">-                    Integer(
</a><a href="#h28-3-19" id="h28-3-19" class="d">-                        5,
</a><a href="#h28-3-20" id="h28-3-20" class="d">-                    ),
</a><a href="#h28-3-21" id="h28-3-21" class="d">-                ],
</a><a href="#h28-3-22" id="h28-3-22" class="d">-            },
</a><a href="#h28-3-23" id="h28-3-23" class="d">-            predicate: None,
</a><a href="#h28-3-24" id="h28-3-24" class="i">+        source: IndexLookup {
</a><a href="#h28-3-25" id="h28-3-25" class="i">+            table: &quot;movies&quot;,
</a><a href="#h28-3-26" id="h28-3-26" class="i">+            alias: None,
</a><a href="#h28-3-27" id="h28-3-27" class="i">+            column: &quot;genre_id&quot;,
</a><a href="#h28-3-28" id="h28-3-28" class="i">+            values: [
</a><a href="#h28-3-29" id="h28-3-29" class="i">+                Integer(
</a><a href="#h28-3-30" id="h28-3-30" class="i">+                    2,
</a><a href="#h28-3-31" id="h28-3-31" class="i">+                ),
</a><a href="#h28-3-32" id="h28-3-32" class="i">+                Integer(
</a><a href="#h28-3-33" id="h28-3-33" class="i">+                    3,
</a><a href="#h28-3-34" id="h28-3-34" class="i">+                ),
</a><a href="#h28-3-35" id="h28-3-35" class="i">+                Integer(
</a><a href="#h28-3-36" id="h28-3-36" class="i">+                    4,
</a><a href="#h28-3-37" id="h28-3-37" class="i">+                ),
</a><a href="#h28-3-38" id="h28-3-38" class="i">+                Integer(
</a><a href="#h28-3-39" id="h28-3-39" class="i">+                    5,
</a><a href="#h28-3-40" id="h28-3-40" class="i">+                ),
</a><a href="#h28-3-41" id="h28-3-41" class="i">+            ],
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h29" href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a> b/<a href="../file/tests/sql/query/where_index_or_partial.html">tests/sql/query/where_index_or_partial</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -80,59 +80,57 @@ Plan: Plan(
</a>                 alias: None,
                 filter: None,
             },
<a href="#h29-0-3" id="h29-0-3" class="d">-            predicate: Some(
</a><a href="#h29-0-4" id="h29-0-4" class="d">-                And(
</a><a href="#h29-0-5" id="h29-0-5" class="d">-                    Or(
</a><a href="#h29-0-6" id="h29-0-6" class="d">-                        Equal(
</a><a href="#h29-0-7" id="h29-0-7" class="d">-                            Field(
</a><a href="#h29-0-8" id="h29-0-8" class="d">-                                3,
</a><a href="#h29-0-9" id="h29-0-9" class="d">-                                Some(
</a><a href="#h29-0-10" id="h29-0-10" class="d">-                                    (
</a><a href="#h29-0-11" id="h29-0-11" class="d">-                                        None,
</a><a href="#h29-0-12" id="h29-0-12" class="d">-                                        &quot;genre_id&quot;,
</a><a href="#h29-0-13" id="h29-0-13" class="d">-                                    ),
</a><a href="#h29-0-14" id="h29-0-14" class="d">-                                ),
</a><a href="#h29-0-15" id="h29-0-15" class="d">-                            ),
</a><a href="#h29-0-16" id="h29-0-16" class="d">-                            Constant(
</a><a href="#h29-0-17" id="h29-0-17" class="d">-                                Integer(
</a><a href="#h29-0-18" id="h29-0-18" class="d">-                                    2,
</a><a href="#h29-0-19" id="h29-0-19" class="i">+            predicate: And(
</a><a href="#h29-0-20" id="h29-0-20" class="i">+                Or(
</a><a href="#h29-0-21" id="h29-0-21" class="i">+                    Equal(
</a><a href="#h29-0-22" id="h29-0-22" class="i">+                        Field(
</a><a href="#h29-0-23" id="h29-0-23" class="i">+                            3,
</a><a href="#h29-0-24" id="h29-0-24" class="i">+                            Some(
</a><a href="#h29-0-25" id="h29-0-25" class="i">+                                (
</a><a href="#h29-0-26" id="h29-0-26" class="i">+                                    None,
</a><a href="#h29-0-27" id="h29-0-27" class="i">+                                    &quot;genre_id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h29-0-31" id="h29-0-31" class="d">-                        Equal(
</a><a href="#h29-0-32" id="h29-0-32" class="d">-                            Field(
</a><a href="#h29-0-33" id="h29-0-33" class="d">-                                3,
</a><a href="#h29-0-34" id="h29-0-34" class="d">-                                Some(
</a><a href="#h29-0-35" id="h29-0-35" class="d">-                                    (
</a><a href="#h29-0-36" id="h29-0-36" class="d">-                                        None,
</a><a href="#h29-0-37" id="h29-0-37" class="d">-                                        &quot;genre_id&quot;,
</a><a href="#h29-0-38" id="h29-0-38" class="d">-                                    ),
</a><a href="#h29-0-39" id="h29-0-39" class="d">-                                ),
</a><a href="#h29-0-40" id="h29-0-40" class="d">-                            ),
</a><a href="#h29-0-41" id="h29-0-41" class="d">-                            Constant(
</a><a href="#h29-0-42" id="h29-0-42" class="d">-                                Integer(
</a><a href="#h29-0-43" id="h29-0-43" class="d">-                                    3,
</a><a href="#h29-0-44" id="h29-0-44" class="d">-                                ),
</a><a href="#h29-0-45" id="h29-0-45" class="i">+                        Constant(
</a><a href="#h29-0-46" id="h29-0-46" class="i">+                            Integer(
</a><a href="#h29-0-47" id="h29-0-47" class="i">+                                2,
</a>                             ),
                         ),
                     ),
                     Equal(
                         Field(
<a href="#h29-0-53" id="h29-0-53" class="d">-                            2,
</a><a href="#h29-0-54" id="h29-0-54" class="i">+                            3,
</a>                             Some(
                                 (
                                     None,
<a href="#h29-0-58" id="h29-0-58" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h29-0-59" id="h29-0-59" class="i">+                                    &quot;genre_id&quot;,
</a>                                 ),
                             ),
                         ),
                         Constant(
                             Integer(
<a href="#h29-0-65" id="h29-0-65" class="d">-                                2,
</a><a href="#h29-0-66" id="h29-0-66" class="i">+                                3,
</a>                             ),
                         ),
                     ),
                 ),
<a href="#h29-0-71" id="h29-0-71" class="i">+                Equal(
</a><a href="#h29-0-72" id="h29-0-72" class="i">+                    Field(
</a><a href="#h29-0-73" id="h29-0-73" class="i">+                        2,
</a><a href="#h29-0-74" id="h29-0-74" class="i">+                        Some(
</a><a href="#h29-0-75" id="h29-0-75" class="i">+                            (
</a><a href="#h29-0-76" id="h29-0-76" class="i">+                                None,
</a><a href="#h29-0-77" id="h29-0-77" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h29-0-78" id="h29-0-78" class="i">+                            ),
</a><a href="#h29-0-79" id="h29-0-79" class="i">+                        ),
</a><a href="#h29-0-80" id="h29-0-80" class="i">+                    ),
</a><a href="#h29-0-81" id="h29-0-81" class="i">+                    Constant(
</a><a href="#h29-0-82" id="h29-0-82" class="i">+                        Integer(
</a><a href="#h29-0-83" id="h29-0-83" class="i">+                            2,
</a><a href="#h29-0-84" id="h29-0-84" class="i">+                        ),
</a><a href="#h29-0-85" id="h29-0-85" class="i">+                    ),
</a><a href="#h29-0-86" id="h29-0-86" class="i">+                ),
</a>             ),
         },
         orders: [
<a href="#h29-1" id="h29-1" class="h">@@ -155,40 +153,35 @@ Plan: Plan(
</a> Optimized plan: Plan(
     Order {
         source: Filter {
<a href="#h29-1-3" id="h29-1-3" class="d">-            source: Filter {
</a><a href="#h29-1-4" id="h29-1-4" class="d">-                source: IndexLookup {
</a><a href="#h29-1-5" id="h29-1-5" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h29-1-6" id="h29-1-6" class="d">-                    alias: None,
</a><a href="#h29-1-7" id="h29-1-7" class="d">-                    column: &quot;genre_id&quot;,
</a><a href="#h29-1-8" id="h29-1-8" class="d">-                    values: [
</a><a href="#h29-1-9" id="h29-1-9" class="d">-                        Integer(
</a><a href="#h29-1-10" id="h29-1-10" class="d">-                            2,
</a><a href="#h29-1-11" id="h29-1-11" class="d">-                        ),
</a><a href="#h29-1-12" id="h29-1-12" class="d">-                        Integer(
</a><a href="#h29-1-13" id="h29-1-13" class="d">-                            3,
</a><a href="#h29-1-14" id="h29-1-14" class="d">-                        ),
</a><a href="#h29-1-15" id="h29-1-15" class="d">-                    ],
</a><a href="#h29-1-16" id="h29-1-16" class="d">-                },
</a><a href="#h29-1-17" id="h29-1-17" class="d">-                predicate: Some(
</a><a href="#h29-1-18" id="h29-1-18" class="d">-                    Equal(
</a><a href="#h29-1-19" id="h29-1-19" class="d">-                        Field(
</a><a href="#h29-1-20" id="h29-1-20" class="d">-                            2,
</a><a href="#h29-1-21" id="h29-1-21" class="d">-                            Some(
</a><a href="#h29-1-22" id="h29-1-22" class="d">-                                (
</a><a href="#h29-1-23" id="h29-1-23" class="d">-                                    None,
</a><a href="#h29-1-24" id="h29-1-24" class="d">-                                    &quot;studio_id&quot;,
</a><a href="#h29-1-25" id="h29-1-25" class="d">-                                ),
</a><a href="#h29-1-26" id="h29-1-26" class="d">-                            ),
</a><a href="#h29-1-27" id="h29-1-27" class="d">-                        ),
</a><a href="#h29-1-28" id="h29-1-28" class="d">-                        Constant(
</a><a href="#h29-1-29" id="h29-1-29" class="d">-                            Integer(
</a><a href="#h29-1-30" id="h29-1-30" class="d">-                                2,
</a><a href="#h29-1-31" id="h29-1-31" class="d">-                            ),
</a><a href="#h29-1-32" id="h29-1-32" class="i">+            source: IndexLookup {
</a><a href="#h29-1-33" id="h29-1-33" class="i">+                table: &quot;movies&quot;,
</a><a href="#h29-1-34" id="h29-1-34" class="i">+                alias: None,
</a><a href="#h29-1-35" id="h29-1-35" class="i">+                column: &quot;genre_id&quot;,
</a><a href="#h29-1-36" id="h29-1-36" class="i">+                values: [
</a><a href="#h29-1-37" id="h29-1-37" class="i">+                    Integer(
</a><a href="#h29-1-38" id="h29-1-38" class="i">+                        2,
</a><a href="#h29-1-39" id="h29-1-39" class="i">+                    ),
</a><a href="#h29-1-40" id="h29-1-40" class="i">+                    Integer(
</a><a href="#h29-1-41" id="h29-1-41" class="i">+                        3,
</a><a href="#h29-1-42" id="h29-1-42" class="i">+                    ),
</a><a href="#h29-1-43" id="h29-1-43" class="i">+                ],
</a><a href="#h29-1-44" id="h29-1-44" class="i">+            },
</a><a href="#h29-1-45" id="h29-1-45" class="i">+            predicate: Equal(
</a><a href="#h29-1-46" id="h29-1-46" class="i">+                Field(
</a><a href="#h29-1-47" id="h29-1-47" class="i">+                    2,
</a><a href="#h29-1-48" id="h29-1-48" class="i">+                    Some(
</a><a href="#h29-1-49" id="h29-1-49" class="i">+                        (
</a><a href="#h29-1-50" id="h29-1-50" class="i">+                            None,
</a><a href="#h29-1-51" id="h29-1-51" class="i">+                            &quot;studio_id&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h29-1-55" id="h29-1-55" class="d">-            },
</a><a href="#h29-1-56" id="h29-1-56" class="d">-            predicate: None,
</a><a href="#h29-1-57" id="h29-1-57" class="i">+                Constant(
</a><a href="#h29-1-58" id="h29-1-58" class="i">+                    Integer(
</a><a href="#h29-1-59" id="h29-1-59" class="i">+                        2,
</a><a href="#h29-1-60" id="h29-1-60" class="i">+                    ),
</a><a href="#h29-1-61" id="h29-1-61" class="i">+                ),
</a><a href="#h29-1-62" id="h29-1-62" class="i">+            ),
</a>         },
         orders: [
             (
<b>diff --git a/<a id="h30" href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a> b/<a href="../file/tests/sql/query/where_integer.html">tests/sql/query/where_integer</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -29,30 +29,25 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h30-0-3" id="h30-0-3" class="d">-        predicate: Some(
</a><a href="#h30-0-4" id="h30-0-4" class="d">-            Constant(
</a><a href="#h30-0-5" id="h30-0-5" class="d">-                Integer(
</a><a href="#h30-0-6" id="h30-0-6" class="d">-                    7,
</a><a href="#h30-0-7" id="h30-0-7" class="d">-                ),
</a><a href="#h30-0-8" id="h30-0-8" class="i">+        predicate: Constant(
</a><a href="#h30-0-9" id="h30-0-9" class="i">+            Integer(
</a><a href="#h30-0-10" id="h30-0-10" class="i">+                7,
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h30-0-17" id="h30-0-17" class="d">-    Filter {
</a><a href="#h30-0-18" id="h30-0-18" class="d">-        source: Scan {
</a><a href="#h30-0-19" id="h30-0-19" class="d">-            table: &quot;movies&quot;,
</a><a href="#h30-0-20" id="h30-0-20" class="d">-            alias: None,
</a><a href="#h30-0-21" id="h30-0-21" class="d">-            filter: Some(
</a><a href="#h30-0-22" id="h30-0-22" class="d">-                Constant(
</a><a href="#h30-0-23" id="h30-0-23" class="d">-                    Integer(
</a><a href="#h30-0-24" id="h30-0-24" class="d">-                        7,
</a><a href="#h30-0-25" id="h30-0-25" class="d">-                    ),
</a><a href="#h30-0-26" id="h30-0-26" class="i">+    Scan {
</a><a href="#h30-0-27" id="h30-0-27" class="i">+        table: &quot;movies&quot;,
</a><a href="#h30-0-28" id="h30-0-28" class="i">+        alias: None,
</a><a href="#h30-0-29" id="h30-0-29" class="i">+        filter: Some(
</a><a href="#h30-0-30" id="h30-0-30" class="i">+            Constant(
</a><a href="#h30-0-31" id="h30-0-31" class="i">+                Integer(
</a><a href="#h30-0-32" id="h30-0-32" class="i">+                    7,
</a>                 ),
             ),
<a href="#h30-0-35" id="h30-0-35" class="d">-        },
</a><a href="#h30-0-36" id="h30-0-36" class="d">-        predicate: None,
</a><a href="#h30-0-37" id="h30-0-37" class="i">+        ),
</a>     },
 )
 
<b>diff --git a/<a id="h31" href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a> b/<a href="../file/tests/sql/query/where_join_inner.html">tests/sql/query/where_join_inner</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -55,6 +55,46 @@ Plan: Plan(
</a>             pad: false,
             flip: false,
         },
<a href="#h31-0-3" id="h31-0-3" class="i">+        predicate: Equal(
</a><a href="#h31-0-4" id="h31-0-4" class="i">+            Field(
</a><a href="#h31-0-5" id="h31-0-5" class="i">+                3,
</a><a href="#h31-0-6" id="h31-0-6" class="i">+                Some(
</a><a href="#h31-0-7" id="h31-0-7" class="i">+                    (
</a><a href="#h31-0-8" id="h31-0-8" class="i">+                        Some(
</a><a href="#h31-0-9" id="h31-0-9" class="i">+                            &quot;movies&quot;,
</a><a href="#h31-0-10" id="h31-0-10" class="i">+                        ),
</a><a href="#h31-0-11" id="h31-0-11" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h31-0-12" id="h31-0-12" class="i">+                    ),
</a><a href="#h31-0-13" id="h31-0-13" class="i">+                ),
</a><a href="#h31-0-14" id="h31-0-14" class="i">+            ),
</a><a href="#h31-0-15" id="h31-0-15" class="i">+            Field(
</a><a href="#h31-0-16" id="h31-0-16" class="i">+                7,
</a><a href="#h31-0-17" id="h31-0-17" class="i">+                Some(
</a><a href="#h31-0-18" id="h31-0-18" class="i">+                    (
</a><a href="#h31-0-19" id="h31-0-19" class="i">+                        Some(
</a><a href="#h31-0-20" id="h31-0-20" class="i">+                            &quot;genres&quot;,
</a><a href="#h31-0-21" id="h31-0-21" class="i">+                        ),
</a><a href="#h31-0-22" id="h31-0-22" class="i">+                        &quot;id&quot;,
</a><a href="#h31-0-23" id="h31-0-23" class="i">+                    ),
</a><a href="#h31-0-24" id="h31-0-24" class="i">+                ),
</a><a href="#h31-0-25" id="h31-0-25" class="i">+            ),
</a><a href="#h31-0-26" id="h31-0-26" class="i">+        ),
</a><a href="#h31-0-27" id="h31-0-27" class="i">+    },
</a><a href="#h31-0-28" id="h31-0-28" class="i">+)
</a><a href="#h31-0-29" id="h31-0-29" class="i">+
</a><a href="#h31-0-30" id="h31-0-30" class="i">+Optimized plan: Plan(
</a><a href="#h31-0-31" id="h31-0-31" class="i">+    NestedLoopJoin {
</a><a href="#h31-0-32" id="h31-0-32" class="i">+        outer: Scan {
</a><a href="#h31-0-33" id="h31-0-33" class="i">+            table: &quot;movies&quot;,
</a><a href="#h31-0-34" id="h31-0-34" class="i">+            alias: None,
</a><a href="#h31-0-35" id="h31-0-35" class="i">+            filter: None,
</a><a href="#h31-0-36" id="h31-0-36" class="i">+        },
</a><a href="#h31-0-37" id="h31-0-37" class="i">+        outer_size: 7,
</a><a href="#h31-0-38" id="h31-0-38" class="i">+        inner: Scan {
</a><a href="#h31-0-39" id="h31-0-39" class="i">+            table: &quot;genres&quot;,
</a><a href="#h31-0-40" id="h31-0-40" class="i">+            alias: None,
</a><a href="#h31-0-41" id="h31-0-41" class="i">+            filter: None,
</a><a href="#h31-0-42" id="h31-0-42" class="i">+        },
</a>         predicate: Some(
             Equal(
                 Field(
<a href="#h31-1" id="h31-1" class="h">@@ -81,53 +121,8 @@ Plan: Plan(
</a>                 ),
             ),
         ),
<a href="#h31-1-3" id="h31-1-3" class="d">-    },
</a><a href="#h31-1-4" id="h31-1-4" class="d">-)
</a><a href="#h31-1-5" id="h31-1-5" class="d">-
</a><a href="#h31-1-6" id="h31-1-6" class="d">-Optimized plan: Plan(
</a><a href="#h31-1-7" id="h31-1-7" class="d">-    Filter {
</a><a href="#h31-1-8" id="h31-1-8" class="d">-        source: NestedLoopJoin {
</a><a href="#h31-1-9" id="h31-1-9" class="d">-            outer: Scan {
</a><a href="#h31-1-10" id="h31-1-10" class="d">-                table: &quot;movies&quot;,
</a><a href="#h31-1-11" id="h31-1-11" class="d">-                alias: None,
</a><a href="#h31-1-12" id="h31-1-12" class="d">-                filter: None,
</a><a href="#h31-1-13" id="h31-1-13" class="d">-            },
</a><a href="#h31-1-14" id="h31-1-14" class="d">-            outer_size: 7,
</a><a href="#h31-1-15" id="h31-1-15" class="d">-            inner: Scan {
</a><a href="#h31-1-16" id="h31-1-16" class="d">-                table: &quot;genres&quot;,
</a><a href="#h31-1-17" id="h31-1-17" class="d">-                alias: None,
</a><a href="#h31-1-18" id="h31-1-18" class="d">-                filter: None,
</a><a href="#h31-1-19" id="h31-1-19" class="d">-            },
</a><a href="#h31-1-20" id="h31-1-20" class="d">-            predicate: Some(
</a><a href="#h31-1-21" id="h31-1-21" class="d">-                Equal(
</a><a href="#h31-1-22" id="h31-1-22" class="d">-                    Field(
</a><a href="#h31-1-23" id="h31-1-23" class="d">-                        3,
</a><a href="#h31-1-24" id="h31-1-24" class="d">-                        Some(
</a><a href="#h31-1-25" id="h31-1-25" class="d">-                            (
</a><a href="#h31-1-26" id="h31-1-26" class="d">-                                Some(
</a><a href="#h31-1-27" id="h31-1-27" class="d">-                                    &quot;movies&quot;,
</a><a href="#h31-1-28" id="h31-1-28" class="d">-                                ),
</a><a href="#h31-1-29" id="h31-1-29" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h31-1-30" id="h31-1-30" class="d">-                            ),
</a><a href="#h31-1-31" id="h31-1-31" class="d">-                        ),
</a><a href="#h31-1-32" id="h31-1-32" class="d">-                    ),
</a><a href="#h31-1-33" id="h31-1-33" class="d">-                    Field(
</a><a href="#h31-1-34" id="h31-1-34" class="d">-                        7,
</a><a href="#h31-1-35" id="h31-1-35" class="d">-                        Some(
</a><a href="#h31-1-36" id="h31-1-36" class="d">-                            (
</a><a href="#h31-1-37" id="h31-1-37" class="d">-                                Some(
</a><a href="#h31-1-38" id="h31-1-38" class="d">-                                    &quot;genres&quot;,
</a><a href="#h31-1-39" id="h31-1-39" class="d">-                                ),
</a><a href="#h31-1-40" id="h31-1-40" class="d">-                                &quot;id&quot;,
</a><a href="#h31-1-41" id="h31-1-41" class="d">-                            ),
</a><a href="#h31-1-42" id="h31-1-42" class="d">-                        ),
</a><a href="#h31-1-43" id="h31-1-43" class="d">-                    ),
</a><a href="#h31-1-44" id="h31-1-44" class="d">-                ),
</a><a href="#h31-1-45" id="h31-1-45" class="d">-            ),
</a><a href="#h31-1-46" id="h31-1-46" class="d">-            pad: false,
</a><a href="#h31-1-47" id="h31-1-47" class="d">-            flip: false,
</a><a href="#h31-1-48" id="h31-1-48" class="d">-        },
</a><a href="#h31-1-49" id="h31-1-49" class="d">-        predicate: None,
</a><a href="#h31-1-50" id="h31-1-50" class="i">+        pad: false,
</a><a href="#h31-1-51" id="h31-1-51" class="i">+        flip: false,
</a>     },
 )
 
<b>diff --git a/<a id="h32" href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a> b/<a href="../file/tests/sql/query/where_null.html">tests/sql/query/where_null</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -27,26 +27,21 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h32-0-3" id="h32-0-3" class="d">-        predicate: Some(
</a><a href="#h32-0-4" id="h32-0-4" class="d">-            Constant(
</a><a href="#h32-0-5" id="h32-0-5" class="d">-                Null,
</a><a href="#h32-0-6" id="h32-0-6" class="d">-            ),
</a><a href="#h32-0-7" id="h32-0-7" class="i">+        predicate: Constant(
</a><a href="#h32-0-8" id="h32-0-8" class="i">+            Null,
</a>         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h32-0-14" id="h32-0-14" class="d">-    Filter {
</a><a href="#h32-0-15" id="h32-0-15" class="d">-        source: Scan {
</a><a href="#h32-0-16" id="h32-0-16" class="d">-            table: &quot;movies&quot;,
</a><a href="#h32-0-17" id="h32-0-17" class="d">-            alias: None,
</a><a href="#h32-0-18" id="h32-0-18" class="d">-            filter: Some(
</a><a href="#h32-0-19" id="h32-0-19" class="d">-                Constant(
</a><a href="#h32-0-20" id="h32-0-20" class="d">-                    Null,
</a><a href="#h32-0-21" id="h32-0-21" class="d">-                ),
</a><a href="#h32-0-22" id="h32-0-22" class="i">+    Scan {
</a><a href="#h32-0-23" id="h32-0-23" class="i">+        table: &quot;movies&quot;,
</a><a href="#h32-0-24" id="h32-0-24" class="i">+        alias: None,
</a><a href="#h32-0-25" id="h32-0-25" class="i">+        filter: Some(
</a><a href="#h32-0-26" id="h32-0-26" class="i">+            Constant(
</a><a href="#h32-0-27" id="h32-0-27" class="i">+                Null,
</a>             ),
<a href="#h32-0-29" id="h32-0-29" class="d">-        },
</a><a href="#h32-0-30" id="h32-0-30" class="d">-        predicate: None,
</a><a href="#h32-0-31" id="h32-0-31" class="i">+        ),
</a>     },
 )
 
<b>diff --git a/<a id="h33" href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a> b/<a href="../file/tests/sql/query/where_pk.html">tests/sql/query/where_pk</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -37,21 +37,19 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h33-0-3" id="h33-0-3" class="d">-        predicate: Some(
</a><a href="#h33-0-4" id="h33-0-4" class="d">-            Equal(
</a><a href="#h33-0-5" id="h33-0-5" class="d">-                Field(
</a><a href="#h33-0-6" id="h33-0-6" class="d">-                    0,
</a><a href="#h33-0-7" id="h33-0-7" class="d">-                    Some(
</a><a href="#h33-0-8" id="h33-0-8" class="d">-                        (
</a><a href="#h33-0-9" id="h33-0-9" class="d">-                            None,
</a><a href="#h33-0-10" id="h33-0-10" class="d">-                            &quot;id&quot;,
</a><a href="#h33-0-11" id="h33-0-11" class="d">-                        ),
</a><a href="#h33-0-12" id="h33-0-12" class="i">+        predicate: Equal(
</a><a href="#h33-0-13" id="h33-0-13" class="i">+            Field(
</a><a href="#h33-0-14" id="h33-0-14" class="i">+                0,
</a><a href="#h33-0-15" id="h33-0-15" class="i">+                Some(
</a><a href="#h33-0-16" id="h33-0-16" class="i">+                    (
</a><a href="#h33-0-17" id="h33-0-17" class="i">+                        None,
</a><a href="#h33-0-18" id="h33-0-18" class="i">+                        &quot;id&quot;,
</a>                     ),
                 ),
<a href="#h33-0-21" id="h33-0-21" class="d">-                Constant(
</a><a href="#h33-0-22" id="h33-0-22" class="d">-                    Integer(
</a><a href="#h33-0-23" id="h33-0-23" class="d">-                        3,
</a><a href="#h33-0-24" id="h33-0-24" class="d">-                    ),
</a><a href="#h33-0-25" id="h33-0-25" class="i">+            ),
</a><a href="#h33-0-26" id="h33-0-26" class="i">+            Constant(
</a><a href="#h33-0-27" id="h33-0-27" class="i">+                Integer(
</a><a href="#h33-0-28" id="h33-0-28" class="i">+                    3,
</a>                 ),
             ),
         ),
<a href="#h33-1" id="h33-1" class="h">@@ -59,17 +57,14 @@ Plan: Plan(
</a> )
 
 Optimized plan: Plan(
<a href="#h33-1-3" id="h33-1-3" class="d">-    Filter {
</a><a href="#h33-1-4" id="h33-1-4" class="d">-        source: KeyLookup {
</a><a href="#h33-1-5" id="h33-1-5" class="d">-            table: &quot;movies&quot;,
</a><a href="#h33-1-6" id="h33-1-6" class="d">-            alias: None,
</a><a href="#h33-1-7" id="h33-1-7" class="d">-            keys: [
</a><a href="#h33-1-8" id="h33-1-8" class="d">-                Integer(
</a><a href="#h33-1-9" id="h33-1-9" class="d">-                    3,
</a><a href="#h33-1-10" id="h33-1-10" class="d">-                ),
</a><a href="#h33-1-11" id="h33-1-11" class="d">-            ],
</a><a href="#h33-1-12" id="h33-1-12" class="d">-        },
</a><a href="#h33-1-13" id="h33-1-13" class="d">-        predicate: None,
</a><a href="#h33-1-14" id="h33-1-14" class="i">+    KeyLookup {
</a><a href="#h33-1-15" id="h33-1-15" class="i">+        table: &quot;movies&quot;,
</a><a href="#h33-1-16" id="h33-1-16" class="i">+        alias: None,
</a><a href="#h33-1-17" id="h33-1-17" class="i">+        keys: [
</a><a href="#h33-1-18" id="h33-1-18" class="i">+            Integer(
</a><a href="#h33-1-19" id="h33-1-19" class="i">+                3,
</a><a href="#h33-1-20" id="h33-1-20" class="i">+            ),
</a><a href="#h33-1-21" id="h33-1-21" class="i">+        ],
</a>     },
 )
 
<b>diff --git a/<a id="h34" href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a> b/<a href="../file/tests/sql/query/where_pk_or.html">tests/sql/query/where_pk_or</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -71,39 +71,21 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h34-0-3" id="h34-0-3" class="d">-        predicate: Some(
</a><a href="#h34-0-4" id="h34-0-4" class="i">+        predicate: Or(
</a>             Or(
<a href="#h34-0-6" id="h34-0-6" class="d">-                Or(
</a><a href="#h34-0-7" id="h34-0-7" class="d">-                    Equal(
</a><a href="#h34-0-8" id="h34-0-8" class="d">-                        Field(
</a><a href="#h34-0-9" id="h34-0-9" class="d">-                            0,
</a><a href="#h34-0-10" id="h34-0-10" class="d">-                            Some(
</a><a href="#h34-0-11" id="h34-0-11" class="d">-                                (
</a><a href="#h34-0-12" id="h34-0-12" class="d">-                                    None,
</a><a href="#h34-0-13" id="h34-0-13" class="d">-                                    &quot;id&quot;,
</a><a href="#h34-0-14" id="h34-0-14" class="d">-                                ),
</a><a href="#h34-0-15" id="h34-0-15" class="d">-                            ),
</a><a href="#h34-0-16" id="h34-0-16" class="d">-                        ),
</a><a href="#h34-0-17" id="h34-0-17" class="d">-                        Constant(
</a><a href="#h34-0-18" id="h34-0-18" class="d">-                            Integer(
</a><a href="#h34-0-19" id="h34-0-19" class="d">-                                3,
</a><a href="#h34-0-20" id="h34-0-20" class="i">+                Equal(
</a><a href="#h34-0-21" id="h34-0-21" class="i">+                    Field(
</a><a href="#h34-0-22" id="h34-0-22" class="i">+                        0,
</a><a href="#h34-0-23" id="h34-0-23" class="i">+                        Some(
</a><a href="#h34-0-24" id="h34-0-24" class="i">+                            (
</a><a href="#h34-0-25" id="h34-0-25" class="i">+                                None,
</a><a href="#h34-0-26" id="h34-0-26" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
                     ),
<a href="#h34-0-30" id="h34-0-30" class="d">-                    Equal(
</a><a href="#h34-0-31" id="h34-0-31" class="d">-                        Field(
</a><a href="#h34-0-32" id="h34-0-32" class="d">-                            0,
</a><a href="#h34-0-33" id="h34-0-33" class="d">-                            Some(
</a><a href="#h34-0-34" id="h34-0-34" class="d">-                                (
</a><a href="#h34-0-35" id="h34-0-35" class="d">-                                    None,
</a><a href="#h34-0-36" id="h34-0-36" class="d">-                                    &quot;id&quot;,
</a><a href="#h34-0-37" id="h34-0-37" class="d">-                                ),
</a><a href="#h34-0-38" id="h34-0-38" class="d">-                            ),
</a><a href="#h34-0-39" id="h34-0-39" class="d">-                        ),
</a><a href="#h34-0-40" id="h34-0-40" class="d">-                        Constant(
</a><a href="#h34-0-41" id="h34-0-41" class="d">-                            Integer(
</a><a href="#h34-0-42" id="h34-0-42" class="d">-                                5,
</a><a href="#h34-0-43" id="h34-0-43" class="d">-                            ),
</a><a href="#h34-0-44" id="h34-0-44" class="i">+                    Constant(
</a><a href="#h34-0-45" id="h34-0-45" class="i">+                        Integer(
</a><a href="#h34-0-46" id="h34-0-46" class="i">+                            3,
</a>                         ),
                     ),
                 ),
<a href="#h34-1" id="h34-1" class="h">@@ -119,33 +101,46 @@ Plan: Plan(
</a>                     ),
                     Constant(
                         Integer(
<a href="#h34-1-3" id="h34-1-3" class="d">-                            7,
</a><a href="#h34-1-4" id="h34-1-4" class="i">+                            5,
</a>                         ),
                     ),
                 ),
             ),
<a href="#h34-1-9" id="h34-1-9" class="i">+            Equal(
</a><a href="#h34-1-10" id="h34-1-10" class="i">+                Field(
</a><a href="#h34-1-11" id="h34-1-11" class="i">+                    0,
</a><a href="#h34-1-12" id="h34-1-12" class="i">+                    Some(
</a><a href="#h34-1-13" id="h34-1-13" class="i">+                        (
</a><a href="#h34-1-14" id="h34-1-14" class="i">+                            None,
</a><a href="#h34-1-15" id="h34-1-15" class="i">+                            &quot;id&quot;,
</a><a href="#h34-1-16" id="h34-1-16" class="i">+                        ),
</a><a href="#h34-1-17" id="h34-1-17" class="i">+                    ),
</a><a href="#h34-1-18" id="h34-1-18" class="i">+                ),
</a><a href="#h34-1-19" id="h34-1-19" class="i">+                Constant(
</a><a href="#h34-1-20" id="h34-1-20" class="i">+                    Integer(
</a><a href="#h34-1-21" id="h34-1-21" class="i">+                        7,
</a><a href="#h34-1-22" id="h34-1-22" class="i">+                    ),
</a><a href="#h34-1-23" id="h34-1-23" class="i">+                ),
</a><a href="#h34-1-24" id="h34-1-24" class="i">+            ),
</a>         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h34-1-30" id="h34-1-30" class="d">-    Filter {
</a><a href="#h34-1-31" id="h34-1-31" class="d">-        source: KeyLookup {
</a><a href="#h34-1-32" id="h34-1-32" class="d">-            table: &quot;movies&quot;,
</a><a href="#h34-1-33" id="h34-1-33" class="d">-            alias: None,
</a><a href="#h34-1-34" id="h34-1-34" class="d">-            keys: [
</a><a href="#h34-1-35" id="h34-1-35" class="d">-                Integer(
</a><a href="#h34-1-36" id="h34-1-36" class="d">-                    3,
</a><a href="#h34-1-37" id="h34-1-37" class="d">-                ),
</a><a href="#h34-1-38" id="h34-1-38" class="d">-                Integer(
</a><a href="#h34-1-39" id="h34-1-39" class="d">-                    5,
</a><a href="#h34-1-40" id="h34-1-40" class="d">-                ),
</a><a href="#h34-1-41" id="h34-1-41" class="d">-                Integer(
</a><a href="#h34-1-42" id="h34-1-42" class="d">-                    7,
</a><a href="#h34-1-43" id="h34-1-43" class="d">-                ),
</a><a href="#h34-1-44" id="h34-1-44" class="d">-            ],
</a><a href="#h34-1-45" id="h34-1-45" class="d">-        },
</a><a href="#h34-1-46" id="h34-1-46" class="d">-        predicate: None,
</a><a href="#h34-1-47" id="h34-1-47" class="i">+    KeyLookup {
</a><a href="#h34-1-48" id="h34-1-48" class="i">+        table: &quot;movies&quot;,
</a><a href="#h34-1-49" id="h34-1-49" class="i">+        alias: None,
</a><a href="#h34-1-50" id="h34-1-50" class="i">+        keys: [
</a><a href="#h34-1-51" id="h34-1-51" class="i">+            Integer(
</a><a href="#h34-1-52" id="h34-1-52" class="i">+                3,
</a><a href="#h34-1-53" id="h34-1-53" class="i">+            ),
</a><a href="#h34-1-54" id="h34-1-54" class="i">+            Integer(
</a><a href="#h34-1-55" id="h34-1-55" class="i">+                5,
</a><a href="#h34-1-56" id="h34-1-56" class="i">+            ),
</a><a href="#h34-1-57" id="h34-1-57" class="i">+            Integer(
</a><a href="#h34-1-58" id="h34-1-58" class="i">+                7,
</a><a href="#h34-1-59" id="h34-1-59" class="i">+            ),
</a><a href="#h34-1-60" id="h34-1-60" class="i">+        ],
</a>     },
 )
 
<b>diff --git a/<a id="h35" href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a> b/<a href="../file/tests/sql/query/where_pk_or_partial.html">tests/sql/query/where_pk_or_partial</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -105,41 +105,23 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h35-0-3" id="h35-0-3" class="d">-        predicate: Some(
</a><a href="#h35-0-4" id="h35-0-4" class="d">-            And(
</a><a href="#h35-0-5" id="h35-0-5" class="i">+        predicate: And(
</a><a href="#h35-0-6" id="h35-0-6" class="i">+            Or(
</a>                 Or(
                     Or(
<a href="#h35-0-9" id="h35-0-9" class="d">-                        Or(
</a><a href="#h35-0-10" id="h35-0-10" class="d">-                            Equal(
</a><a href="#h35-0-11" id="h35-0-11" class="d">-                                Field(
</a><a href="#h35-0-12" id="h35-0-12" class="d">-                                    0,
</a><a href="#h35-0-13" id="h35-0-13" class="d">-                                    Some(
</a><a href="#h35-0-14" id="h35-0-14" class="d">-                                        (
</a><a href="#h35-0-15" id="h35-0-15" class="d">-                                            None,
</a><a href="#h35-0-16" id="h35-0-16" class="d">-                                            &quot;id&quot;,
</a><a href="#h35-0-17" id="h35-0-17" class="d">-                                        ),
</a><a href="#h35-0-18" id="h35-0-18" class="d">-                                    ),
</a><a href="#h35-0-19" id="h35-0-19" class="d">-                                ),
</a><a href="#h35-0-20" id="h35-0-20" class="d">-                                Constant(
</a><a href="#h35-0-21" id="h35-0-21" class="d">-                                    Integer(
</a><a href="#h35-0-22" id="h35-0-22" class="d">-                                        2,
</a><a href="#h35-0-23" id="h35-0-23" class="i">+                        Equal(
</a><a href="#h35-0-24" id="h35-0-24" class="i">+                            Field(
</a><a href="#h35-0-25" id="h35-0-25" class="i">+                                0,
</a><a href="#h35-0-26" id="h35-0-26" class="i">+                                Some(
</a><a href="#h35-0-27" id="h35-0-27" class="i">+                                    (
</a><a href="#h35-0-28" id="h35-0-28" class="i">+                                        None,
</a><a href="#h35-0-29" id="h35-0-29" class="i">+                                        &quot;id&quot;,
</a>                                     ),
                                 ),
                             ),
<a href="#h35-0-33" id="h35-0-33" class="d">-                            Equal(
</a><a href="#h35-0-34" id="h35-0-34" class="d">-                                Field(
</a><a href="#h35-0-35" id="h35-0-35" class="d">-                                    0,
</a><a href="#h35-0-36" id="h35-0-36" class="d">-                                    Some(
</a><a href="#h35-0-37" id="h35-0-37" class="d">-                                        (
</a><a href="#h35-0-38" id="h35-0-38" class="d">-                                            None,
</a><a href="#h35-0-39" id="h35-0-39" class="d">-                                            &quot;id&quot;,
</a><a href="#h35-0-40" id="h35-0-40" class="d">-                                        ),
</a><a href="#h35-0-41" id="h35-0-41" class="d">-                                    ),
</a><a href="#h35-0-42" id="h35-0-42" class="d">-                                ),
</a><a href="#h35-0-43" id="h35-0-43" class="d">-                                Constant(
</a><a href="#h35-0-44" id="h35-0-44" class="d">-                                    Integer(
</a><a href="#h35-0-45" id="h35-0-45" class="d">-                                        3,
</a><a href="#h35-0-46" id="h35-0-46" class="d">-                                    ),
</a><a href="#h35-0-47" id="h35-0-47" class="i">+                            Constant(
</a><a href="#h35-0-48" id="h35-0-48" class="i">+                                Integer(
</a><a href="#h35-0-49" id="h35-0-49" class="i">+                                    2,
</a>                                 ),
                             ),
                         ),
<a href="#h35-1" id="h35-1" class="h">@@ -155,7 +137,7 @@ Plan: Plan(
</a>                             ),
                             Constant(
                                 Integer(
<a href="#h35-1-3" id="h35-1-3" class="d">-                                    4,
</a><a href="#h35-1-4" id="h35-1-4" class="i">+                                    3,
</a>                                 ),
                             ),
                         ),
<a href="#h35-2" id="h35-2" class="h">@@ -172,27 +154,43 @@ Plan: Plan(
</a>                         ),
                         Constant(
                             Integer(
<a href="#h35-2-3" id="h35-2-3" class="d">-                                5,
</a><a href="#h35-2-4" id="h35-2-4" class="i">+                                4,
</a>                             ),
                         ),
                     ),
                 ),
                 Equal(
                     Field(
<a href="#h35-2-11" id="h35-2-11" class="d">-                        3,
</a><a href="#h35-2-12" id="h35-2-12" class="i">+                        0,
</a>                         Some(
                             (
                                 None,
<a href="#h35-2-16" id="h35-2-16" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h35-2-17" id="h35-2-17" class="i">+                                &quot;id&quot;,
</a>                             ),
                         ),
                     ),
                     Constant(
                         Integer(
<a href="#h35-2-23" id="h35-2-23" class="d">-                            1,
</a><a href="#h35-2-24" id="h35-2-24" class="i">+                            5,
</a><a href="#h35-2-25" id="h35-2-25" class="i">+                        ),
</a><a href="#h35-2-26" id="h35-2-26" class="i">+                    ),
</a><a href="#h35-2-27" id="h35-2-27" class="i">+                ),
</a><a href="#h35-2-28" id="h35-2-28" class="i">+            ),
</a><a href="#h35-2-29" id="h35-2-29" class="i">+            Equal(
</a><a href="#h35-2-30" id="h35-2-30" class="i">+                Field(
</a><a href="#h35-2-31" id="h35-2-31" class="i">+                    3,
</a><a href="#h35-2-32" id="h35-2-32" class="i">+                    Some(
</a><a href="#h35-2-33" id="h35-2-33" class="i">+                        (
</a><a href="#h35-2-34" id="h35-2-34" class="i">+                            None,
</a><a href="#h35-2-35" id="h35-2-35" class="i">+                            &quot;genre_id&quot;,
</a>                         ),
                     ),
                 ),
<a href="#h35-2-39" id="h35-2-39" class="i">+                Constant(
</a><a href="#h35-2-40" id="h35-2-40" class="i">+                    Integer(
</a><a href="#h35-2-41" id="h35-2-41" class="i">+                        1,
</a><a href="#h35-2-42" id="h35-2-42" class="i">+                    ),
</a><a href="#h35-2-43" id="h35-2-43" class="i">+                ),
</a>             ),
         ),
     },
<a href="#h35-3" id="h35-3" class="h">@@ -200,45 +198,40 @@ Plan: Plan(
</a> 
 Optimized plan: Plan(
     Filter {
<a href="#h35-3-3" id="h35-3-3" class="d">-        source: Filter {
</a><a href="#h35-3-4" id="h35-3-4" class="d">-            source: KeyLookup {
</a><a href="#h35-3-5" id="h35-3-5" class="d">-                table: &quot;movies&quot;,
</a><a href="#h35-3-6" id="h35-3-6" class="d">-                alias: None,
</a><a href="#h35-3-7" id="h35-3-7" class="d">-                keys: [
</a><a href="#h35-3-8" id="h35-3-8" class="d">-                    Integer(
</a><a href="#h35-3-9" id="h35-3-9" class="d">-                        2,
</a><a href="#h35-3-10" id="h35-3-10" class="d">-                    ),
</a><a href="#h35-3-11" id="h35-3-11" class="d">-                    Integer(
</a><a href="#h35-3-12" id="h35-3-12" class="d">-                        3,
</a><a href="#h35-3-13" id="h35-3-13" class="d">-                    ),
</a><a href="#h35-3-14" id="h35-3-14" class="d">-                    Integer(
</a><a href="#h35-3-15" id="h35-3-15" class="d">-                        4,
</a><a href="#h35-3-16" id="h35-3-16" class="d">-                    ),
</a><a href="#h35-3-17" id="h35-3-17" class="d">-                    Integer(
</a><a href="#h35-3-18" id="h35-3-18" class="d">-                        5,
</a><a href="#h35-3-19" id="h35-3-19" class="d">-                    ),
</a><a href="#h35-3-20" id="h35-3-20" class="d">-                ],
</a><a href="#h35-3-21" id="h35-3-21" class="d">-            },
</a><a href="#h35-3-22" id="h35-3-22" class="d">-            predicate: Some(
</a><a href="#h35-3-23" id="h35-3-23" class="d">-                Equal(
</a><a href="#h35-3-24" id="h35-3-24" class="d">-                    Field(
</a><a href="#h35-3-25" id="h35-3-25" class="d">-                        3,
</a><a href="#h35-3-26" id="h35-3-26" class="d">-                        Some(
</a><a href="#h35-3-27" id="h35-3-27" class="d">-                            (
</a><a href="#h35-3-28" id="h35-3-28" class="d">-                                None,
</a><a href="#h35-3-29" id="h35-3-29" class="d">-                                &quot;genre_id&quot;,
</a><a href="#h35-3-30" id="h35-3-30" class="d">-                            ),
</a><a href="#h35-3-31" id="h35-3-31" class="d">-                        ),
</a><a href="#h35-3-32" id="h35-3-32" class="d">-                    ),
</a><a href="#h35-3-33" id="h35-3-33" class="d">-                    Constant(
</a><a href="#h35-3-34" id="h35-3-34" class="d">-                        Integer(
</a><a href="#h35-3-35" id="h35-3-35" class="d">-                            1,
</a><a href="#h35-3-36" id="h35-3-36" class="d">-                        ),
</a><a href="#h35-3-37" id="h35-3-37" class="i">+        source: KeyLookup {
</a><a href="#h35-3-38" id="h35-3-38" class="i">+            table: &quot;movies&quot;,
</a><a href="#h35-3-39" id="h35-3-39" class="i">+            alias: None,
</a><a href="#h35-3-40" id="h35-3-40" class="i">+            keys: [
</a><a href="#h35-3-41" id="h35-3-41" class="i">+                Integer(
</a><a href="#h35-3-42" id="h35-3-42" class="i">+                    2,
</a><a href="#h35-3-43" id="h35-3-43" class="i">+                ),
</a><a href="#h35-3-44" id="h35-3-44" class="i">+                Integer(
</a><a href="#h35-3-45" id="h35-3-45" class="i">+                    3,
</a><a href="#h35-3-46" id="h35-3-46" class="i">+                ),
</a><a href="#h35-3-47" id="h35-3-47" class="i">+                Integer(
</a><a href="#h35-3-48" id="h35-3-48" class="i">+                    4,
</a><a href="#h35-3-49" id="h35-3-49" class="i">+                ),
</a><a href="#h35-3-50" id="h35-3-50" class="i">+                Integer(
</a><a href="#h35-3-51" id="h35-3-51" class="i">+                    5,
</a><a href="#h35-3-52" id="h35-3-52" class="i">+                ),
</a><a href="#h35-3-53" id="h35-3-53" class="i">+            ],
</a><a href="#h35-3-54" id="h35-3-54" class="i">+        },
</a><a href="#h35-3-55" id="h35-3-55" class="i">+        predicate: Equal(
</a><a href="#h35-3-56" id="h35-3-56" class="i">+            Field(
</a><a href="#h35-3-57" id="h35-3-57" class="i">+                3,
</a><a href="#h35-3-58" id="h35-3-58" class="i">+                Some(
</a><a href="#h35-3-59" id="h35-3-59" class="i">+                    (
</a><a href="#h35-3-60" id="h35-3-60" class="i">+                        None,
</a><a href="#h35-3-61" id="h35-3-61" class="i">+                        &quot;genre_id&quot;,
</a>                     ),
                 ),
             ),
<a href="#h35-3-65" id="h35-3-65" class="d">-        },
</a><a href="#h35-3-66" id="h35-3-66" class="d">-        predicate: None,
</a><a href="#h35-3-67" id="h35-3-67" class="i">+            Constant(
</a><a href="#h35-3-68" id="h35-3-68" class="i">+                Integer(
</a><a href="#h35-3-69" id="h35-3-69" class="i">+                    1,
</a><a href="#h35-3-70" id="h35-3-70" class="i">+                ),
</a><a href="#h35-3-71" id="h35-3-71" class="i">+            ),
</a><a href="#h35-3-72" id="h35-3-72" class="i">+        ),
</a>     },
 )
 
<b>diff --git a/<a id="h36" href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a> b/<a href="../file/tests/sql/query/where_string.html">tests/sql/query/where_string</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -29,30 +29,25 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h36-0-3" id="h36-0-3" class="d">-        predicate: Some(
</a><a href="#h36-0-4" id="h36-0-4" class="d">-            Constant(
</a><a href="#h36-0-5" id="h36-0-5" class="d">-                String(
</a><a href="#h36-0-6" id="h36-0-6" class="d">-                    &quot;abc&quot;,
</a><a href="#h36-0-7" id="h36-0-7" class="d">-                ),
</a><a href="#h36-0-8" id="h36-0-8" class="i">+        predicate: Constant(
</a><a href="#h36-0-9" id="h36-0-9" class="i">+            String(
</a><a href="#h36-0-10" id="h36-0-10" class="i">+                &quot;abc&quot;,
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h36-0-17" id="h36-0-17" class="d">-    Filter {
</a><a href="#h36-0-18" id="h36-0-18" class="d">-        source: Scan {
</a><a href="#h36-0-19" id="h36-0-19" class="d">-            table: &quot;movies&quot;,
</a><a href="#h36-0-20" id="h36-0-20" class="d">-            alias: None,
</a><a href="#h36-0-21" id="h36-0-21" class="d">-            filter: Some(
</a><a href="#h36-0-22" id="h36-0-22" class="d">-                Constant(
</a><a href="#h36-0-23" id="h36-0-23" class="d">-                    String(
</a><a href="#h36-0-24" id="h36-0-24" class="d">-                        &quot;abc&quot;,
</a><a href="#h36-0-25" id="h36-0-25" class="d">-                    ),
</a><a href="#h36-0-26" id="h36-0-26" class="i">+    Scan {
</a><a href="#h36-0-27" id="h36-0-27" class="i">+        table: &quot;movies&quot;,
</a><a href="#h36-0-28" id="h36-0-28" class="i">+        alias: None,
</a><a href="#h36-0-29" id="h36-0-29" class="i">+        filter: Some(
</a><a href="#h36-0-30" id="h36-0-30" class="i">+            Constant(
</a><a href="#h36-0-31" id="h36-0-31" class="i">+                String(
</a><a href="#h36-0-32" id="h36-0-32" class="i">+                    &quot;abc&quot;,
</a>                 ),
             ),
<a href="#h36-0-35" id="h36-0-35" class="d">-        },
</a><a href="#h36-0-36" id="h36-0-36" class="d">-        predicate: None,
</a><a href="#h36-0-37" id="h36-0-37" class="i">+        ),
</a>     },
 )
 
<b>diff --git a/<a id="h37" href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a> b/<a href="../file/tests/sql/query/where_true.html">tests/sql/query/where_true</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -29,30 +29,25 @@ Plan: Plan(
</a>             alias: None,
             filter: None,
         },
<a href="#h37-0-3" id="h37-0-3" class="d">-        predicate: Some(
</a><a href="#h37-0-4" id="h37-0-4" class="d">-            Constant(
</a><a href="#h37-0-5" id="h37-0-5" class="d">-                Boolean(
</a><a href="#h37-0-6" id="h37-0-6" class="d">-                    true,
</a><a href="#h37-0-7" id="h37-0-7" class="d">-                ),
</a><a href="#h37-0-8" id="h37-0-8" class="i">+        predicate: Constant(
</a><a href="#h37-0-9" id="h37-0-9" class="i">+            Boolean(
</a><a href="#h37-0-10" id="h37-0-10" class="i">+                true,
</a>             ),
         ),
     },
 )
 
 Optimized plan: Plan(
<a href="#h37-0-17" id="h37-0-17" class="d">-    Filter {
</a><a href="#h37-0-18" id="h37-0-18" class="d">-        source: Scan {
</a><a href="#h37-0-19" id="h37-0-19" class="d">-            table: &quot;movies&quot;,
</a><a href="#h37-0-20" id="h37-0-20" class="d">-            alias: None,
</a><a href="#h37-0-21" id="h37-0-21" class="d">-            filter: Some(
</a><a href="#h37-0-22" id="h37-0-22" class="d">-                Constant(
</a><a href="#h37-0-23" id="h37-0-23" class="d">-                    Boolean(
</a><a href="#h37-0-24" id="h37-0-24" class="d">-                        true,
</a><a href="#h37-0-25" id="h37-0-25" class="d">-                    ),
</a><a href="#h37-0-26" id="h37-0-26" class="i">+    Scan {
</a><a href="#h37-0-27" id="h37-0-27" class="i">+        table: &quot;movies&quot;,
</a><a href="#h37-0-28" id="h37-0-28" class="i">+        alias: None,
</a><a href="#h37-0-29" id="h37-0-29" class="i">+        filter: Some(
</a><a href="#h37-0-30" id="h37-0-30" class="i">+            Constant(
</a><a href="#h37-0-31" id="h37-0-31" class="i">+                Boolean(
</a><a href="#h37-0-32" id="h37-0-32" class="i">+                    true,
</a>                 ),
             ),
<a href="#h37-0-35" id="h37-0-35" class="d">-        },
</a><a href="#h37-0-36" id="h37-0-36" class="d">-        predicate: None,
</a><a href="#h37-0-37" id="h37-0-37" class="i">+        ),
</a>     },
 )
 
</pre>
</div>
</body>
</html>
