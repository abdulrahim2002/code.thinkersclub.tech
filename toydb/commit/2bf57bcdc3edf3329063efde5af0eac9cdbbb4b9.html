<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: add aggregate queries. - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/2bf57bcdc3edf3329063efde5af0eac9cdbbb4b9.html">2bf57bcdc3edf3329063efde5af0eac9cdbbb4b9</a>
<b>parent</b> <a href="../commit/f75014f90adb28a3ada0dbaecd782d358c3e7068.html">f75014f90adb28a3ada0dbaecd782d358c3e7068</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Wed,  8 Apr 2020 22:42:05 +0200

sql: add aggregate queries.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">README.md</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">docs/README.md</a></td><td> | </td><td class="num">30</td><td><span class="i">+++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="A">A</td><td><a href="#h2">src/sql/executor/aggregation.rs</a></td><td> | </td><td class="num">239</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/sql/executor/mod.rs</a></td><td> | </td><td class="num">15</td><td><span class="i">++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/executor/projection.rs</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/parser/ast.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/parser/lexer.rs</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">33</td><td><span class="i">++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/planner/mod.rs</a></td><td> | </td><td class="num">323</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/planner/plan.rs</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/tests/expression.rs</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/sql/tests/query.rs</a></td><td> | </td><td class="num">79</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="A">A</td><td><a href="#h12">src/sql/tests/query/agg_boolean</a></td><td> | </td><td class="num">262</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h13">src/sql/tests/query/agg_boolean_null</a></td><td> | </td><td class="num">227</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h14">src/sql/tests/query/agg_const</a></td><td> | </td><td class="num">227</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h15">src/sql/tests/query/agg_const_from</a></td><td> | </td><td class="num">242</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h16">src/sql/tests/query/agg_count_star</a></td><td> | </td><td class="num">110</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h17">src/sql/tests/query/agg_expr</a></td><td> | </td><td class="num">168</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h18">src/sql/tests/query/agg_float</a></td><td> | </td><td class="num">262</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h19">src/sql/tests/query/agg_float_null</a></td><td> | </td><td class="num">227</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h20">src/sql/tests/query/agg_integer</a></td><td> | </td><td class="num">262</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h21">src/sql/tests/query/agg_integer_null</a></td><td> | </td><td class="num">227</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h22">src/sql/tests/query/agg_nested</a></td><td> | </td><td class="num">44</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h23">src/sql/tests/query/agg_string</a></td><td> | </td><td class="num">262</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h24">src/sql/tests/query/agg_string_null</a></td><td> | </td><td class="num">227</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h25">src/sql/tests/query/agg_ungrouped</a></td><td> | </td><td class="num">125</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">src/sql/tests/query/all</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">src/sql/tests/query/as_</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">src/sql/tests/query/as_duplicate</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">src/sql/tests/query/expr_dynamic</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">src/sql/tests/query/expr_mixed</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">src/sql/tests/query/expr_static</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">src/sql/tests/query/field_aliased</a></td><td> | </td><td class="num">22</td><td><span class="i">++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">src/sql/tests/query/field_ambiguous</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">src/sql/tests/query/field_multi</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">src/sql/tests/query/field_qualified</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">src/sql/tests/query/field_qualified_multi</a></td><td> | </td><td class="num">22</td><td><span class="i">++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">src/sql/tests/query/field_single</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">src/sql/tests/query/field_unknown</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">src/sql/tests/query/field_unknown_aliased</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">src/sql/tests/query/field_unknown_qualified</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">src/sql/tests/query/field_unknown_table</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">src/sql/tests/query/from_multiple</a></td><td> | </td><td class="num">74</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">src/sql/tests/query/from_unknown</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h44">src/sql/tests/query/group_expr</a></td><td> | </td><td class="num">188</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h45">src/sql/tests/query/group_expr_aggr</a></td><td> | </td><td class="num">235</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h46">src/sql/tests/query/group_expr_aggr_nogroupref</a></td><td> | </td><td class="num">252</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h47">src/sql/tests/query/group_expr_aggr_selfref</a></td><td> | </td><td class="num">255</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h48">src/sql/tests/query/group_expr_aliased</a></td><td> | </td><td class="num">205</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h49">src/sql/tests/query/group_expr_both</a></td><td> | </td><td class="num">210</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h50">src/sql/tests/query/group_expr_extended</a></td><td> | </td><td class="num">246</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h51">src/sql/tests/query/group_expr_multigroup</a></td><td> | </td><td class="num">244</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h52">src/sql/tests/query/group_expr_select</a></td><td> | </td><td class="num">203</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h53">src/sql/tests/query/group_join</a></td><td> | </td><td class="num">274</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h54">src/sql/tests/query/group_noaggregate</a></td><td> | </td><td class="num">142</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h55">src/sql/tests/query/group_noselect</a></td><td> | </td><td class="num">165</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h56">src/sql/tests/query/group_order_agg</a></td><td> | </td><td class="num">66</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h57">src/sql/tests/query/group_simple</a></td><td> | </td><td class="num">174</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h58">src/sql/tests/query/group_unknown</a></td><td> | </td><td class="num">129</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h59">src/sql/tests/query/having</a></td><td> | </td><td class="num">220</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h60">src/sql/tests/query/having_nogroup</a></td><td> | </td><td class="num">162</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">src/sql/tests/query/join_cross</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">src/sql/tests/query/join_cross_alias</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">src/sql/tests/query/join_cross_multi</a></td><td> | </td><td class="num">290</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h64">src/sql/tests/query/join_inner</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h65">src/sql/tests/query/join_inner_implicit</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h66">src/sql/tests/query/join_inner_multi</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h67">src/sql/tests/query/join_inner_on_aliased</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h68">src/sql/tests/query/join_inner_on_false</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h69">src/sql/tests/query/join_inner_on_multi</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h70">src/sql/tests/query/join_inner_on_true</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h71">src/sql/tests/query/join_inner_on_where</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h72">src/sql/tests/query/join_left</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h73">src/sql/tests/query/join_left_outer</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h74">src/sql/tests/query/join_left_truncate</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h75">src/sql/tests/query/join_right</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h76">src/sql/tests/query/join_right_outer</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h77">src/sql/tests/query/join_right_truncate</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h78">src/sql/tests/query/limit</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h79">src/sql/tests/query/limit_boolean</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h80">src/sql/tests/query/limit_dynamic</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h81">src/sql/tests/query/limit_expr</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h82">src/sql/tests/query/limit_float</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h83">src/sql/tests/query/limit_large</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h84">src/sql/tests/query/limit_neg</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h85">src/sql/tests/query/limit_null</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h86">src/sql/tests/query/limit_offset</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h87">src/sql/tests/query/limit_string</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h88">src/sql/tests/query/limit_zero</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h89">src/sql/tests/query/lowercase</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h90">src/sql/tests/query/offset</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h91">src/sql/tests/query/offset_boolean</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h92">src/sql/tests/query/offset_dynamic</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h93">src/sql/tests/query/offset_expr</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h94">src/sql/tests/query/offset_float</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h95">src/sql/tests/query/offset_large</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h96">src/sql/tests/query/offset_neg</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h97">src/sql/tests/query/offset_null</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h98">src/sql/tests/query/offset_string</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h99">src/sql/tests/query/offset_zero</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h100">src/sql/tests/query/order</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h101">src/sql/tests/query/order_asc</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h102">src/sql/tests/query/order_asc_lowercase</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h103">src/sql/tests/query/order_boolean_asc</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h104">src/sql/tests/query/order_boolean_desc</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h105">src/sql/tests/query/order_desc</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h106">src/sql/tests/query/order_desc_lowercase</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h107">src/sql/tests/query/order_expr</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h108">src/sql/tests/query/order_field_aliased</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h109">src/sql/tests/query/order_field_ambiguous</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h110">src/sql/tests/query/order_field_qualified</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h111">src/sql/tests/query/order_field_unknown</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h112">src/sql/tests/query/order_float_asc</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h113">src/sql/tests/query/order_float_desc</a></td><td> | </td><td class="num">4</td><td><span class="i">+++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h114">src/sql/tests/query/order_integer_asc</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h115">src/sql/tests/query/order_integer_desc</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h116">src/sql/tests/query/order_multi</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h117">src/sql/tests/query/order_string_asc</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h118">src/sql/tests/query/order_string_desc</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h119">src/sql/tests/query/where_expr</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h120">src/sql/tests/query/where_false</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h121">src/sql/tests/query/where_field_aliased_select</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h122">src/sql/tests/query/where_field_aliased_table</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h123">src/sql/tests/query/where_field_ambiguous</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h124">src/sql/tests/query/where_field_qualified</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h125">src/sql/tests/query/where_field_unknown</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h126">src/sql/tests/query/where_float</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h127">src/sql/tests/query/where_integer</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h128">src/sql/tests/query/where_join_inner</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h129">src/sql/tests/query/where_null</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h130">src/sql/tests/query/where_string</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h131">src/sql/tests/query/where_true</a></td><td> | </td><td class="num">9</td><td><span class="i">++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h132">src/sql/types/datatype.rs</a></td><td> | </td><td class="num">29</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h133">src/sql/types/expression.rs</a></td><td> | </td><td class="num">20</td><td><span class="i">+++++++++++++++++</span><span class="d">---</span></td></tr>
</table></pre><pre>134 files changed, 7748 insertions(+), 159 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/README.md.html">README.md</a> b/<a href="../file/README.md.html">README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -103,7 +103,7 @@ toydb@1&gt; SELECT * FROM movies
</a>   - [x] `UPDATE ... SET ... WHERE ...`
   - [x] `DELETE FROM ... WHERE ...`
   - [x] `SELECT ... FROM ... WHERE ... ORDER BY ... LIMIT ... OFFSET ...`
<a href="#h0-0-3" id="h0-0-3" class="d">-    - [ ] `GROUP BY ... HAVING ...`
</a><a href="#h0-0-4" id="h0-0-4" class="i">+    - [x] `GROUP BY ... HAVING ...`
</a>     - [x] `[INNER|LEFT|RIGHT|CROSS] JOIN`
   - [ ] `EXPLAIN SELECT ...`
 
<b>diff --git a/<a id="h1" href="../file/docs/README.md.html">docs/README.md</a> b/<a href="../file/docs/README.md.html">docs/README.md</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -19,7 +19,7 @@ Numeric types are not interchangable when stored; a float value cannot be stored
</a> 
 Keywords are reserved words that have special meaning in SQL statements, such as `SELECT`. These cannot be used as identifiers (e.g. table names) unless quoted with `&quot;`. Keywords are case-insensitive. The complete list of keywords is:
 
<a href="#h1-0-3" id="h1-0-3" class="d">-`AS`, `ASC`, `AND`, `BEGIN`, `BOOL`, `BOOLEAN`, `BY`, `CHAR`, `COMMIT`, `CREATE`, `CROSS`, `DEFAULT`,`DELETE`, `DESC`, `DOUBLE`, `DROP`, `FALSE`, `FLOAT`, `FROM`, `INFINITY`, `INNER`, `INSERT`, `INT`, `INTEGER`, `INTO`, `IS`, `JOIN`, `KEY`, `LEFT`, `LIKE`, `LIMIT`, `NAN`, `NOT`, `NULL`, `OF`, `OFFSET`, `ON`, `ONLY`, `OR`, `ORDER`, `OUTER`, `PRIMARY`, `READ`, `REFERENCES`, `RIGHT`, `ROLLBACK`, `SELECT`, `SET`, `STRING`, `SYSTEM`, `TABLE`, `TEXT`, `TIME`, `TRANSACTION`, `TRUE`, `UNIQUE`, `UPDATE`, `VALUES`, `VARCHAR`, `WHERE`, `WRITE`
</a><a href="#h1-0-4" id="h1-0-4" class="i">+`AS`, `ASC`, `AND`, `BEGIN`, `BOOL`, `BOOLEAN`, `BY`, `CHAR`, `COMMIT`, `CREATE`, `CROSS`, `DEFAULT`,`DELETE`, `DESC`, `DOUBLE`, `DROP`, `FALSE`, `FLOAT`, `FROM`, `GROUP`, `HAVING`, `INFINITY`, `INNER`, `INSERT`, `INT`, `INTEGER`, `INTO`, `IS`, `JOIN`, `KEY`, `LEFT`, `LIKE`, `LIMIT`, `NAN`, `NOT`, `NULL`, `OF`, `OFFSET`, `ON`, `ONLY`, `OR`, `ORDER`, `OUTER`, `PRIMARY`, `READ`, `REFERENCES`, `RIGHT`, `ROLLBACK`, `SELECT`, `SET`, `STRING`, `SYSTEM`, `TABLE`, `TEXT`, `TIME`, `TRANSACTION`, `TRUE`, `UNIQUE`, `UPDATE`, `VALUES`, `VARCHAR`, `WHERE`, `WRITE`
</a> 
 ### Identifiers
 
<a href="#h1-1" id="h1-1" class="h">@@ -74,19 +74,19 @@ Logical operators apply standard logic operations on boolean operands.
</a> The complete truth tables are:
 
 | `AND`       | `TRUE`  | `FALSE` | `NULL`  |
<a href="#h1-1-3" id="h1-1-3" class="d">-|-------------|---------|---------|---------|
</a><a href="#h1-1-4" id="h1-1-4" class="i">+| ----------- | ------- | ------- | ------- |
</a> | **`TRUE`**  | `TRUE`  | `FALSE` | `NULL`  |
 | **`FALSE`** | `FALSE` | `FALSE` | `FALSE` |
 | **`NULL`**  | `NULL`  | `FALSE` | `NULL`  |
 
 | `OR`        | `TRUE` | `FALSE` | `NULL` |
<a href="#h1-1-10" id="h1-1-10" class="d">-|-------------|--------|---------|--------|
</a><a href="#h1-1-11" id="h1-1-11" class="i">+| ----------- | ------ | ------- | ------ |
</a> | **`TRUE`**  | `TRUE` | `TRUE`  | `TRUE` |
 | **`FALSE`** | `TRUE` | `FALSE` | `NULL` |
 | **`NULL`**  | `TRUE` | `NULL`  | `NULL` |
 
 | `NOT`       |         |
<a href="#h1-1-17" id="h1-1-17" class="d">-|-------------|---------|
</a><a href="#h1-1-18" id="h1-1-18" class="i">+| ----------- | ------- |
</a> | **`TRUE`**  | `FALSE` |
 | **`FALSE`** | `TRUE`  |
 | **`NULL`**  | `NULL`  |
<a href="#h1-2" id="h1-2" class="h">@@ -141,7 +141,7 @@ String operators operate on string operands.
</a> The operator precedence (order of operations) is as follows:
 
 | Precedence | Operator                 | Associativity |
<a href="#h1-2-3" id="h1-2-3" class="d">-|------------|--------------------------|---------------|
</a><a href="#h1-2-4" id="h1-2-4" class="i">+| ---------- | ------------------------ | ------------- |
</a> | 9          | `+`, `-`, `NOT` (prefix) | Right         |
 | 8          | `!`, `IS` (postfix)      | Left          |
 | 7          | `^`                      | Right         |
<a href="#h1-3" id="h1-3" class="h">@@ -154,6 +154,20 @@ The operator precedence (order of operations) is as follows:
</a> 
 Precedence can be overridden by wrapping an expression in parentheses, e.g. `(1 + 2) * 3`.
 
<a href="#h1-3-3" id="h1-3-3" class="i">+### Aggregate functions
</a><a href="#h1-3-4" id="h1-3-4" class="i">+
</a><a href="#h1-3-5" id="h1-3-5" class="i">+Aggregate function aggregate an expression across all rows, optionally grouped into buckets given by `GROUP BY`, and results can be filtered via `HAVING`.
</a><a href="#h1-3-6" id="h1-3-6" class="i">+
</a><a href="#h1-3-7" id="h1-3-7" class="i">+* `AVG(expr)`: returns the average of numerical values.
</a><a href="#h1-3-8" id="h1-3-8" class="i">+
</a><a href="#h1-3-9" id="h1-3-9" class="i">+* `COUNT(expr)`: returns the number of rows for which ***`expr`*** evaluates to a non-`NULL` value. `COUNT(*)` can be used to count all rows.
</a><a href="#h1-3-10" id="h1-3-10" class="i">+
</a><a href="#h1-3-11" id="h1-3-11" class="i">+* `MIN(expr)`: returns the minimum value, according to the datatype&#39;s ordering.
</a><a href="#h1-3-12" id="h1-3-12" class="i">+
</a><a href="#h1-3-13" id="h1-3-13" class="i">+* `MIN(expr)`: returns the maximum value, according to the datatype&#39;s ordering.
</a><a href="#h1-3-14" id="h1-3-14" class="i">+* 
</a><a href="#h1-3-15" id="h1-3-15" class="i">+* `SUM(expr)`: returns the sum of numerical values.
</a><a href="#h1-3-16" id="h1-3-16" class="i">+
</a> ## SQL Statements
 
 ### `CREATE TABLE`
<a href="#h1-4" id="h1-4" class="h">@@ -269,6 +283,8 @@ Selects rows from a table.
</a> SELECT [ * | &lt;b&gt;&lt;i&gt;expression&lt;/i&gt;&lt;/b&gt; [ [ AS ] &lt;b&gt;&lt;i&gt;output_name&lt;/i&gt;&lt;/b&gt; [, ...] ] ]
     [ FROM &lt;b&gt;&lt;i&gt;from_item&lt;/i&gt;&lt;/b&gt; [, ...] ]
     [ WHERE &lt;b&gt;&lt;i&gt;predicate&lt;/i&gt;&lt;/b&gt; ]
<a href="#h1-4-3" id="h1-4-3" class="i">+    [ GROUP BY &lt;b&gt;&lt;i&gt;group_expr&lt;/i&gt;&lt;/b&gt; [, ...] ]
</a><a href="#h1-4-4" id="h1-4-4" class="i">+    [ HAVING &lt;b&gt;&lt;i&gt;having_expr&lt;/i&gt;&lt;/b&gt; ]
</a>     [ ORDER BY &lt;b&gt;&lt;i&gt;order_expr&lt;/i&gt;&lt;/b&gt; [ ASC | DESC ] [, ...] ]
     [ LIMIT &lt;b&gt;&lt;i&gt;count&lt;/i&gt;&lt;/b&gt; ]
     [ OFFSET &lt;b&gt;&lt;i&gt;start&lt;/i&gt;&lt;/b&gt; ]
<a href="#h1-5" id="h1-5" class="h">@@ -299,6 +315,10 @@ Fetches rows or expressions, either from table ***`table_name`*** (if given) or 
</a> 
 * ***`predicate`***: only return rows for which this [expression](#expressions) evaluates to `TRUE`.
 
<a href="#h1-5-3" id="h1-5-3" class="i">+* ***`group_expr`***: an expression to group aggregates by. Non-aggregate `SELECT` expressions must either reference a field given in `group_expr`, be idential with a `group_expr`, or have an `output_name` that is referenced by a `group_expr` field.
</a><a href="#h1-5-4" id="h1-5-4" class="i">+
</a><a href="#h1-5-5" id="h1-5-5" class="i">+* ***`having_expr`***: only return aggregate results for which this [expression](#expressions) evaluates to `TRUE`.
</a><a href="#h1-5-6" id="h1-5-6" class="i">+
</a> * ***`order_expr`***: order rows by this expression (can be a simple field name).
 
 * ***`count`***: maximum number of rows to return. Must be a constant integer expression.
<b>diff --git a/<a id="h2" href="../file/src/sql/executor/aggregation.rs.html">src/sql/executor/aggregation.rs</a> b/<a href="../file/src/sql/executor/aggregation.rs.html">src/sql/executor/aggregation.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -0,0 +1,239 @@
</a><a href="#h2-0-0" id="h2-0-0" class="i">+use super::super::engine::Transaction;
</a><a href="#h2-0-1" id="h2-0-1" class="i">+use super::super::planner::Aggregate;
</a><a href="#h2-0-2" id="h2-0-2" class="i">+use super::super::types::Value;
</a><a href="#h2-0-3" id="h2-0-3" class="i">+use super::{Context, Executor, ResultColumns, ResultSet};
</a><a href="#h2-0-4" id="h2-0-4" class="i">+use crate::Error;
</a><a href="#h2-0-5" id="h2-0-5" class="i">+
</a><a href="#h2-0-6" id="h2-0-6" class="i">+use std::cmp::Ordering;
</a><a href="#h2-0-7" id="h2-0-7" class="i">+use std::collections::HashMap;
</a><a href="#h2-0-8" id="h2-0-8" class="i">+
</a><a href="#h2-0-9" id="h2-0-9" class="i">+/// An aggregation executor
</a><a href="#h2-0-10" id="h2-0-10" class="i">+pub struct Aggregation&lt;T: Transaction&gt; {
</a><a href="#h2-0-11" id="h2-0-11" class="i">+    /// The source of rows to filter
</a><a href="#h2-0-12" id="h2-0-12" class="i">+    source: Box&lt;dyn Executor&lt;T&gt;&gt;,
</a><a href="#h2-0-13" id="h2-0-13" class="i">+    /// Aggregates to apply
</a><a href="#h2-0-14" id="h2-0-14" class="i">+    aggregates: Vec&lt;Aggregate&gt;,
</a><a href="#h2-0-15" id="h2-0-15" class="i">+    /// The bucketed accumulators
</a><a href="#h2-0-16" id="h2-0-16" class="i">+    accumulators: HashMap&lt;Vec&lt;Value&gt;, Vec&lt;Box&lt;dyn Accumulator&gt;&gt;&gt;,
</a><a href="#h2-0-17" id="h2-0-17" class="i">+}
</a><a href="#h2-0-18" id="h2-0-18" class="i">+
</a><a href="#h2-0-19" id="h2-0-19" class="i">+impl&lt;T: Transaction&gt; Aggregation&lt;T&gt; {
</a><a href="#h2-0-20" id="h2-0-20" class="i">+    pub fn new(source: Box&lt;dyn Executor&lt;T&gt;&gt;, aggregates: Vec&lt;Aggregate&gt;) -&gt; Box&lt;Self&gt; {
</a><a href="#h2-0-21" id="h2-0-21" class="i">+        Box::new(Self { source, aggregates, accumulators: HashMap::new() })
</a><a href="#h2-0-22" id="h2-0-22" class="i">+    }
</a><a href="#h2-0-23" id="h2-0-23" class="i">+}
</a><a href="#h2-0-24" id="h2-0-24" class="i">+
</a><a href="#h2-0-25" id="h2-0-25" class="i">+impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Aggregation&lt;T&gt; {
</a><a href="#h2-0-26" id="h2-0-26" class="i">+    #[allow(clippy::or_fun_call)]
</a><a href="#h2-0-27" id="h2-0-27" class="i">+    fn execute(mut self: Box&lt;Self&gt;, ctx: &amp;mut Context&lt;T&gt;) -&gt; Result&lt;ResultSet, Error&gt; {
</a><a href="#h2-0-28" id="h2-0-28" class="i">+        let mut result = self.source.execute(ctx)?;
</a><a href="#h2-0-29" id="h2-0-29" class="i">+        let agg_count = self.aggregates.len();
</a><a href="#h2-0-30" id="h2-0-30" class="i">+        if let Some(mut rows) = result.rows {
</a><a href="#h2-0-31" id="h2-0-31" class="i">+            while let Some(mut row) = rows.next().transpose()? {
</a><a href="#h2-0-32" id="h2-0-32" class="i">+                self.accumulators
</a><a href="#h2-0-33" id="h2-0-33" class="i">+                    .entry(row.split_off(self.aggregates.len()))
</a><a href="#h2-0-34" id="h2-0-34" class="i">+                    .or_insert(self.aggregates.iter().map(|agg| Accumulator::from(agg)).collect())
</a><a href="#h2-0-35" id="h2-0-35" class="i">+                    .iter_mut()
</a><a href="#h2-0-36" id="h2-0-36" class="i">+                    .zip(row)
</a><a href="#h2-0-37" id="h2-0-37" class="i">+                    .try_for_each(|(acc, value)| acc.accumulate(&amp;value))?
</a><a href="#h2-0-38" id="h2-0-38" class="i">+            }
</a><a href="#h2-0-39" id="h2-0-39" class="i">+            result = ResultSet::from_rows(
</a><a href="#h2-0-40" id="h2-0-40" class="i">+                ResultColumns::new(
</a><a href="#h2-0-41" id="h2-0-41" class="i">+                    result
</a><a href="#h2-0-42" id="h2-0-42" class="i">+                        .columns
</a><a href="#h2-0-43" id="h2-0-43" class="i">+                        .columns
</a><a href="#h2-0-44" id="h2-0-44" class="i">+                        .into_iter()
</a><a href="#h2-0-45" id="h2-0-45" class="i">+                        .enumerate()
</a><a href="#h2-0-46" id="h2-0-46" class="i">+                        .map(|(i, c)| if i &lt; agg_count { (None, None) } else { c })
</a><a href="#h2-0-47" id="h2-0-47" class="i">+                        .collect(),
</a><a href="#h2-0-48" id="h2-0-48" class="i">+                ),
</a><a href="#h2-0-49" id="h2-0-49" class="i">+                Box::new(self.accumulators.into_iter().map(|(bucket, accs)| {
</a><a href="#h2-0-50" id="h2-0-50" class="i">+                    Ok(accs
</a><a href="#h2-0-51" id="h2-0-51" class="i">+                        .into_iter()
</a><a href="#h2-0-52" id="h2-0-52" class="i">+                        .map(|acc| acc.aggregate())
</a><a href="#h2-0-53" id="h2-0-53" class="i">+                        .chain(bucket.into_iter())
</a><a href="#h2-0-54" id="h2-0-54" class="i">+                        .collect())
</a><a href="#h2-0-55" id="h2-0-55" class="i">+                })),
</a><a href="#h2-0-56" id="h2-0-56" class="i">+            );
</a><a href="#h2-0-57" id="h2-0-57" class="i">+        }
</a><a href="#h2-0-58" id="h2-0-58" class="i">+        Ok(result)
</a><a href="#h2-0-59" id="h2-0-59" class="i">+    }
</a><a href="#h2-0-60" id="h2-0-60" class="i">+}
</a><a href="#h2-0-61" id="h2-0-61" class="i">+
</a><a href="#h2-0-62" id="h2-0-62" class="i">+// An accumulator
</a><a href="#h2-0-63" id="h2-0-63" class="i">+pub trait Accumulator: std::fmt::Debug + Send {
</a><a href="#h2-0-64" id="h2-0-64" class="i">+    // Accumulates a value
</a><a href="#h2-0-65" id="h2-0-65" class="i">+    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;(), Error&gt;;
</a><a href="#h2-0-66" id="h2-0-66" class="i">+
</a><a href="#h2-0-67" id="h2-0-67" class="i">+    // Calculates a final aggregate
</a><a href="#h2-0-68" id="h2-0-68" class="i">+    fn aggregate(&amp;self) -&gt; Value;
</a><a href="#h2-0-69" id="h2-0-69" class="i">+}
</a><a href="#h2-0-70" id="h2-0-70" class="i">+
</a><a href="#h2-0-71" id="h2-0-71" class="i">+impl dyn Accumulator {
</a><a href="#h2-0-72" id="h2-0-72" class="i">+    fn from(aggregate: &amp;Aggregate) -&gt; Box&lt;dyn Accumulator&gt; {
</a><a href="#h2-0-73" id="h2-0-73" class="i">+        match aggregate {
</a><a href="#h2-0-74" id="h2-0-74" class="i">+            Aggregate::Average =&gt; Box::new(Average::new()),
</a><a href="#h2-0-75" id="h2-0-75" class="i">+            Aggregate::Count =&gt; Box::new(Count::new()),
</a><a href="#h2-0-76" id="h2-0-76" class="i">+            Aggregate::Max =&gt; Box::new(Max::new()),
</a><a href="#h2-0-77" id="h2-0-77" class="i">+            Aggregate::Min =&gt; Box::new(Min::new()),
</a><a href="#h2-0-78" id="h2-0-78" class="i">+            Aggregate::Sum =&gt; Box::new(Sum::new()),
</a><a href="#h2-0-79" id="h2-0-79" class="i">+        }
</a><a href="#h2-0-80" id="h2-0-80" class="i">+    }
</a><a href="#h2-0-81" id="h2-0-81" class="i">+}
</a><a href="#h2-0-82" id="h2-0-82" class="i">+
</a><a href="#h2-0-83" id="h2-0-83" class="i">+// Count non-null values
</a><a href="#h2-0-84" id="h2-0-84" class="i">+#[derive(Debug)]
</a><a href="#h2-0-85" id="h2-0-85" class="i">+pub struct Count {
</a><a href="#h2-0-86" id="h2-0-86" class="i">+    count: u64,
</a><a href="#h2-0-87" id="h2-0-87" class="i">+}
</a><a href="#h2-0-88" id="h2-0-88" class="i">+
</a><a href="#h2-0-89" id="h2-0-89" class="i">+impl Count {
</a><a href="#h2-0-90" id="h2-0-90" class="i">+    pub fn new() -&gt; Self {
</a><a href="#h2-0-91" id="h2-0-91" class="i">+        Self { count: 0 }
</a><a href="#h2-0-92" id="h2-0-92" class="i">+    }
</a><a href="#h2-0-93" id="h2-0-93" class="i">+}
</a><a href="#h2-0-94" id="h2-0-94" class="i">+
</a><a href="#h2-0-95" id="h2-0-95" class="i">+impl Accumulator for Count {
</a><a href="#h2-0-96" id="h2-0-96" class="i">+    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h2-0-97" id="h2-0-97" class="i">+        match value {
</a><a href="#h2-0-98" id="h2-0-98" class="i">+            Value::Null =&gt; {}
</a><a href="#h2-0-99" id="h2-0-99" class="i">+            _ =&gt; self.count += 1,
</a><a href="#h2-0-100" id="h2-0-100" class="i">+        }
</a><a href="#h2-0-101" id="h2-0-101" class="i">+        Ok(())
</a><a href="#h2-0-102" id="h2-0-102" class="i">+    }
</a><a href="#h2-0-103" id="h2-0-103" class="i">+
</a><a href="#h2-0-104" id="h2-0-104" class="i">+    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h2-0-105" id="h2-0-105" class="i">+        Value::Integer(self.count as i64)
</a><a href="#h2-0-106" id="h2-0-106" class="i">+    }
</a><a href="#h2-0-107" id="h2-0-107" class="i">+}
</a><a href="#h2-0-108" id="h2-0-108" class="i">+
</a><a href="#h2-0-109" id="h2-0-109" class="i">+// Average value
</a><a href="#h2-0-110" id="h2-0-110" class="i">+#[derive(Debug)]
</a><a href="#h2-0-111" id="h2-0-111" class="i">+pub struct Average {
</a><a href="#h2-0-112" id="h2-0-112" class="i">+    count: Count,
</a><a href="#h2-0-113" id="h2-0-113" class="i">+    sum: Sum,
</a><a href="#h2-0-114" id="h2-0-114" class="i">+}
</a><a href="#h2-0-115" id="h2-0-115" class="i">+
</a><a href="#h2-0-116" id="h2-0-116" class="i">+impl Average {
</a><a href="#h2-0-117" id="h2-0-117" class="i">+    pub fn new() -&gt; Self {
</a><a href="#h2-0-118" id="h2-0-118" class="i">+        Self { count: Count::new(), sum: Sum::new() }
</a><a href="#h2-0-119" id="h2-0-119" class="i">+    }
</a><a href="#h2-0-120" id="h2-0-120" class="i">+}
</a><a href="#h2-0-121" id="h2-0-121" class="i">+
</a><a href="#h2-0-122" id="h2-0-122" class="i">+impl Accumulator for Average {
</a><a href="#h2-0-123" id="h2-0-123" class="i">+    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h2-0-124" id="h2-0-124" class="i">+        self.count.accumulate(value)?;
</a><a href="#h2-0-125" id="h2-0-125" class="i">+        self.sum.accumulate(value)?;
</a><a href="#h2-0-126" id="h2-0-126" class="i">+        Ok(())
</a><a href="#h2-0-127" id="h2-0-127" class="i">+    }
</a><a href="#h2-0-128" id="h2-0-128" class="i">+
</a><a href="#h2-0-129" id="h2-0-129" class="i">+    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h2-0-130" id="h2-0-130" class="i">+        match (self.sum.aggregate(), self.count.aggregate()) {
</a><a href="#h2-0-131" id="h2-0-131" class="i">+            (Value::Integer(s), Value::Integer(c)) =&gt; Value::Integer(s / c),
</a><a href="#h2-0-132" id="h2-0-132" class="i">+            (Value::Float(s), Value::Integer(c)) =&gt; Value::Float(s / c as f64),
</a><a href="#h2-0-133" id="h2-0-133" class="i">+            _ =&gt; Value::Null,
</a><a href="#h2-0-134" id="h2-0-134" class="i">+        }
</a><a href="#h2-0-135" id="h2-0-135" class="i">+    }
</a><a href="#h2-0-136" id="h2-0-136" class="i">+}
</a><a href="#h2-0-137" id="h2-0-137" class="i">+
</a><a href="#h2-0-138" id="h2-0-138" class="i">+// Maximum value
</a><a href="#h2-0-139" id="h2-0-139" class="i">+#[derive(Debug)]
</a><a href="#h2-0-140" id="h2-0-140" class="i">+pub struct Max {
</a><a href="#h2-0-141" id="h2-0-141" class="i">+    max: Option&lt;Value&gt;,
</a><a href="#h2-0-142" id="h2-0-142" class="i">+}
</a><a href="#h2-0-143" id="h2-0-143" class="i">+
</a><a href="#h2-0-144" id="h2-0-144" class="i">+impl Max {
</a><a href="#h2-0-145" id="h2-0-145" class="i">+    pub fn new() -&gt; Self {
</a><a href="#h2-0-146" id="h2-0-146" class="i">+        Self { max: None }
</a><a href="#h2-0-147" id="h2-0-147" class="i">+    }
</a><a href="#h2-0-148" id="h2-0-148" class="i">+}
</a><a href="#h2-0-149" id="h2-0-149" class="i">+
</a><a href="#h2-0-150" id="h2-0-150" class="i">+impl Accumulator for Max {
</a><a href="#h2-0-151" id="h2-0-151" class="i">+    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h2-0-152" id="h2-0-152" class="i">+        if let Some(max) = &amp;mut self.max {
</a><a href="#h2-0-153" id="h2-0-153" class="i">+            match value.partial_cmp(max) {
</a><a href="#h2-0-154" id="h2-0-154" class="i">+                _ if max.datatype() != value.datatype() =&gt; *max = Value::Null,
</a><a href="#h2-0-155" id="h2-0-155" class="i">+                None =&gt; *max = Value::Null,
</a><a href="#h2-0-156" id="h2-0-156" class="i">+                Some(Ordering::Greater) =&gt; *max = value.clone(),
</a><a href="#h2-0-157" id="h2-0-157" class="i">+                Some(Ordering::Equal) | Some(Ordering::Less) =&gt; {}
</a><a href="#h2-0-158" id="h2-0-158" class="i">+            };
</a><a href="#h2-0-159" id="h2-0-159" class="i">+        } else {
</a><a href="#h2-0-160" id="h2-0-160" class="i">+            self.max = Some(value.clone())
</a><a href="#h2-0-161" id="h2-0-161" class="i">+        }
</a><a href="#h2-0-162" id="h2-0-162" class="i">+        Ok(())
</a><a href="#h2-0-163" id="h2-0-163" class="i">+    }
</a><a href="#h2-0-164" id="h2-0-164" class="i">+
</a><a href="#h2-0-165" id="h2-0-165" class="i">+    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h2-0-166" id="h2-0-166" class="i">+        match &amp;self.max {
</a><a href="#h2-0-167" id="h2-0-167" class="i">+            Some(value) =&gt; value.clone(),
</a><a href="#h2-0-168" id="h2-0-168" class="i">+            None =&gt; Value::Null,
</a><a href="#h2-0-169" id="h2-0-169" class="i">+        }
</a><a href="#h2-0-170" id="h2-0-170" class="i">+    }
</a><a href="#h2-0-171" id="h2-0-171" class="i">+}
</a><a href="#h2-0-172" id="h2-0-172" class="i">+
</a><a href="#h2-0-173" id="h2-0-173" class="i">+// Minimum value
</a><a href="#h2-0-174" id="h2-0-174" class="i">+#[derive(Debug)]
</a><a href="#h2-0-175" id="h2-0-175" class="i">+pub struct Min {
</a><a href="#h2-0-176" id="h2-0-176" class="i">+    min: Option&lt;Value&gt;,
</a><a href="#h2-0-177" id="h2-0-177" class="i">+}
</a><a href="#h2-0-178" id="h2-0-178" class="i">+
</a><a href="#h2-0-179" id="h2-0-179" class="i">+impl Min {
</a><a href="#h2-0-180" id="h2-0-180" class="i">+    pub fn new() -&gt; Self {
</a><a href="#h2-0-181" id="h2-0-181" class="i">+        Self { min: None }
</a><a href="#h2-0-182" id="h2-0-182" class="i">+    }
</a><a href="#h2-0-183" id="h2-0-183" class="i">+}
</a><a href="#h2-0-184" id="h2-0-184" class="i">+
</a><a href="#h2-0-185" id="h2-0-185" class="i">+impl Accumulator for Min {
</a><a href="#h2-0-186" id="h2-0-186" class="i">+    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h2-0-187" id="h2-0-187" class="i">+        if let Some(min) = &amp;mut self.min {
</a><a href="#h2-0-188" id="h2-0-188" class="i">+            match value.partial_cmp(min) {
</a><a href="#h2-0-189" id="h2-0-189" class="i">+                _ if min.datatype() != value.datatype() =&gt; *min = Value::Null,
</a><a href="#h2-0-190" id="h2-0-190" class="i">+                None =&gt; *min = Value::Null,
</a><a href="#h2-0-191" id="h2-0-191" class="i">+                Some(Ordering::Less) =&gt; *min = value.clone(),
</a><a href="#h2-0-192" id="h2-0-192" class="i">+                Some(Ordering::Equal) | Some(Ordering::Greater) =&gt; {}
</a><a href="#h2-0-193" id="h2-0-193" class="i">+            };
</a><a href="#h2-0-194" id="h2-0-194" class="i">+        } else {
</a><a href="#h2-0-195" id="h2-0-195" class="i">+            self.min = Some(value.clone())
</a><a href="#h2-0-196" id="h2-0-196" class="i">+        }
</a><a href="#h2-0-197" id="h2-0-197" class="i">+        Ok(())
</a><a href="#h2-0-198" id="h2-0-198" class="i">+    }
</a><a href="#h2-0-199" id="h2-0-199" class="i">+
</a><a href="#h2-0-200" id="h2-0-200" class="i">+    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h2-0-201" id="h2-0-201" class="i">+        match &amp;self.min {
</a><a href="#h2-0-202" id="h2-0-202" class="i">+            Some(value) =&gt; value.clone(),
</a><a href="#h2-0-203" id="h2-0-203" class="i">+            None =&gt; Value::Null,
</a><a href="#h2-0-204" id="h2-0-204" class="i">+        }
</a><a href="#h2-0-205" id="h2-0-205" class="i">+    }
</a><a href="#h2-0-206" id="h2-0-206" class="i">+}
</a><a href="#h2-0-207" id="h2-0-207" class="i">+
</a><a href="#h2-0-208" id="h2-0-208" class="i">+// Sum of values
</a><a href="#h2-0-209" id="h2-0-209" class="i">+#[derive(Debug)]
</a><a href="#h2-0-210" id="h2-0-210" class="i">+pub struct Sum {
</a><a href="#h2-0-211" id="h2-0-211" class="i">+    sum: Option&lt;Value&gt;,
</a><a href="#h2-0-212" id="h2-0-212" class="i">+}
</a><a href="#h2-0-213" id="h2-0-213" class="i">+
</a><a href="#h2-0-214" id="h2-0-214" class="i">+impl Sum {
</a><a href="#h2-0-215" id="h2-0-215" class="i">+    pub fn new() -&gt; Self {
</a><a href="#h2-0-216" id="h2-0-216" class="i">+        Self { sum: None }
</a><a href="#h2-0-217" id="h2-0-217" class="i">+    }
</a><a href="#h2-0-218" id="h2-0-218" class="i">+}
</a><a href="#h2-0-219" id="h2-0-219" class="i">+
</a><a href="#h2-0-220" id="h2-0-220" class="i">+impl Accumulator for Sum {
</a><a href="#h2-0-221" id="h2-0-221" class="i">+    fn accumulate(&amp;mut self, value: &amp;Value) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h2-0-222" id="h2-0-222" class="i">+        self.sum = match (&amp;self.sum, value) {
</a><a href="#h2-0-223" id="h2-0-223" class="i">+            (Some(Value::Integer(s)), Value::Integer(i)) =&gt; Some(Value::Integer(s + i)),
</a><a href="#h2-0-224" id="h2-0-224" class="i">+            (Some(Value::Float(s)), Value::Float(f)) =&gt; Some(Value::Float(s + f)),
</a><a href="#h2-0-225" id="h2-0-225" class="i">+            (None, Value::Integer(i)) =&gt; Some(Value::Integer(*i)),
</a><a href="#h2-0-226" id="h2-0-226" class="i">+            (None, Value::Float(f)) =&gt; Some(Value::Float(*f)),
</a><a href="#h2-0-227" id="h2-0-227" class="i">+            _ =&gt; Some(Value::Null),
</a><a href="#h2-0-228" id="h2-0-228" class="i">+        };
</a><a href="#h2-0-229" id="h2-0-229" class="i">+        Ok(())
</a><a href="#h2-0-230" id="h2-0-230" class="i">+    }
</a><a href="#h2-0-231" id="h2-0-231" class="i">+
</a><a href="#h2-0-232" id="h2-0-232" class="i">+    fn aggregate(&amp;self) -&gt; Value {
</a><a href="#h2-0-233" id="h2-0-233" class="i">+        match &amp;self.sum {
</a><a href="#h2-0-234" id="h2-0-234" class="i">+            Some(value) =&gt; value.clone(),
</a><a href="#h2-0-235" id="h2-0-235" class="i">+            None =&gt; Value::Null,
</a><a href="#h2-0-236" id="h2-0-236" class="i">+        }
</a><a href="#h2-0-237" id="h2-0-237" class="i">+    }
</a><a href="#h2-0-238" id="h2-0-238" class="i">+}
</a><b>diff --git a/<a id="h3" href="../file/src/sql/executor/mod.rs.html">src/sql/executor/mod.rs</a> b/<a href="../file/src/sql/executor/mod.rs.html">src/sql/executor/mod.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -1,3 +1,4 @@
</a><a href="#h3-0-0" id="h3-0-0" class="i">+mod aggregation;
</a> mod create_table;
 mod delete;
 mod drop_table;
<a href="#h3-1" id="h3-1" class="h">@@ -12,6 +13,7 @@ mod projection;
</a> mod scan;
 mod update;
 
<a href="#h3-1-3" id="h3-1-3" class="i">+use aggregation::Aggregation;
</a> use create_table::CreateTable;
 use delete::Delete;
 use drop_table::DropTable;
<a href="#h3-2" id="h3-2" class="h">@@ -42,6 +44,9 @@ impl&lt;T: Transaction + &#39;static&gt; dyn Executor&lt;T&gt; {
</a>     /// Builds an executor for a plan node, consuming it
     pub fn build(node: Node) -&gt; Box&lt;dyn Executor&lt;T&gt;&gt; {
         match node {
<a href="#h3-2-3" id="h3-2-3" class="i">+            Node::Aggregation { source, aggregates } =&gt; {
</a><a href="#h3-2-4" id="h3-2-4" class="i">+                Aggregation::new(Self::build(*source), aggregates)
</a><a href="#h3-2-5" id="h3-2-5" class="i">+            }
</a>             Node::CreateTable { schema } =&gt; CreateTable::new(schema),
             Node::Delete { table, source } =&gt; Delete::new(table, Self::build(*source)),
             Node::DropTable { name } =&gt; DropTable::new(name),
<a href="#h3-3" id="h3-3" class="h">@@ -200,6 +205,10 @@ impl ResultColumns {
</a>         }
     }
 
<a href="#h3-3-3" id="h3-3-3" class="i">+    pub fn len(&amp;self) -&gt; usize {
</a><a href="#h3-3-4" id="h3-3-4" class="i">+        self.columns.len()
</a><a href="#h3-3-5" id="h3-3-5" class="i">+    }
</a><a href="#h3-3-6" id="h3-3-6" class="i">+
</a>     pub fn merge(self, other: Self) -&gt; Self {
         let mut columns = self.columns;
         columns.extend(other.columns);
<a href="#h3-4" id="h3-4" class="h">@@ -219,7 +228,11 @@ struct ResultEnv&lt;&#39;a&gt; {
</a> 
 impl&lt;&#39;a&gt; Environment for ResultEnv&lt;&#39;a&gt; {
     fn lookup(&amp;self, relation: Option&lt;&amp;str&gt;, field: &amp;str) -&gt; Result&lt;Value, Error&gt; {
<a href="#h3-4-3" id="h3-4-3" class="d">-        Ok(self.row.get(self.columns.index(relation, field)?).cloned().unwrap_or(Value::Null))
</a><a href="#h3-4-4" id="h3-4-4" class="i">+        self.lookup_index(self.columns.index(relation, field)?)
</a><a href="#h3-4-5" id="h3-4-5" class="i">+    }
</a><a href="#h3-4-6" id="h3-4-6" class="i">+
</a><a href="#h3-4-7" id="h3-4-7" class="i">+    fn lookup_index(&amp;self, index: usize) -&gt; Result&lt;Value, Error&gt; {
</a><a href="#h3-4-8" id="h3-4-8" class="i">+        self.row.get(index).cloned().ok_or_else(|| Error::Value(&quot;index out of bounds&quot;.into()))
</a>     }
 }
 
<b>diff --git a/<a id="h4" href="../file/src/sql/executor/projection.rs.html">src/sql/executor/projection.rs</a> b/<a href="../file/src/sql/executor/projection.rs.html">src/sql/executor/projection.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -38,6 +38,9 @@ impl&lt;T: Transaction&gt; Executor&lt;T&gt; for Projection&lt;T&gt; {
</a>                     } else if let Expression::Field(relation, field) = e {
                         let (r, f) = columns.get(relation.as_deref(), field)?;
                         (r, Some(f))
<a href="#h4-0-3" id="h4-0-3" class="i">+                    } else if let Expression::Column(i) = e {
</a><a href="#h4-0-4" id="h4-0-4" class="i">+                        let (r, f) = columns.columns[*i].clone(); // FIXME Should have method for this
</a><a href="#h4-0-5" id="h4-0-5" class="i">+                        (r, f)
</a>                     } else {
                         (None, None)
                     })
<b>diff --git a/<a id="h5" href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a> b/<a href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -26,6 +26,8 @@ pub enum Statement {
</a>         select: SelectClause,
         from: Option&lt;FromClause&gt;,
         r#where: Option&lt;WhereClause&gt;,
<a href="#h5-0-3" id="h5-0-3" class="i">+        group_by: Option&lt;GroupByClause&gt;,
</a><a href="#h5-0-4" id="h5-0-4" class="i">+        having: Option&lt;HavingClause&gt;,
</a>         order: Vec&lt;(Expression, Order)&gt;,
         limit: Option&lt;Expression&gt;,
         offset: Option&lt;Expression&gt;,
<a href="#h5-1" id="h5-1" class="h">@@ -88,6 +90,14 @@ pub enum JoinType {
</a> #[derive(Clone, Debug, PartialEq)]
 pub struct WhereClause(pub Expression);
 
<a href="#h5-1-3" id="h5-1-3" class="i">+/// A GROUP BY clause
</a><a href="#h5-1-4" id="h5-1-4" class="i">+#[derive(Clone, Debug, PartialEq)]
</a><a href="#h5-1-5" id="h5-1-5" class="i">+pub struct GroupByClause(pub Vec&lt;Expression&gt;);
</a><a href="#h5-1-6" id="h5-1-6" class="i">+
</a><a href="#h5-1-7" id="h5-1-7" class="i">+/// A HAVING clause
</a><a href="#h5-1-8" id="h5-1-8" class="i">+#[derive(Clone, Debug, PartialEq)]
</a><a href="#h5-1-9" id="h5-1-9" class="i">+pub struct HavingClause(pub Expression);
</a><a href="#h5-1-10" id="h5-1-10" class="i">+
</a> /// Sort orders
 #[derive(Clone, Debug, PartialEq)]
 pub enum Order {
<b>diff --git a/<a id="h6" href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a> b/<a href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -88,6 +88,8 @@ pub enum Keyword {
</a>     False,
     Float,
     From,
<a href="#h6-0-3" id="h6-0-3" class="i">+    Group,
</a><a href="#h6-0-4" id="h6-0-4" class="i">+    Having,
</a>     Infinity,
     Inner,
     Insert,
<a href="#h6-1" id="h6-1" class="h">@@ -154,6 +156,8 @@ impl Keyword {
</a>             &quot;FALSE&quot; =&gt; Self::False,
             &quot;FLOAT&quot; =&gt; Self::Float,
             &quot;FROM&quot; =&gt; Self::From,
<a href="#h6-1-3" id="h6-1-3" class="i">+            &quot;GROUP&quot; =&gt; Self::Group,
</a><a href="#h6-1-4" id="h6-1-4" class="i">+            &quot;HAVING&quot; =&gt; Self::Having,
</a>             &quot;INFINITY&quot; =&gt; Self::Infinity,
             &quot;INNER&quot; =&gt; Self::Inner,
             &quot;INSERT&quot; =&gt; Self::Insert,
<a href="#h6-2" id="h6-2" class="h">@@ -221,6 +225,8 @@ impl Keyword {
</a>             Self::False =&gt; &quot;FALSE&quot;,
             Self::Float =&gt; &quot;FLOAT&quot;,
             Self::From =&gt; &quot;FROM&quot;,
<a href="#h6-2-3" id="h6-2-3" class="i">+            Self::Group =&gt; &quot;GROUP&quot;,
</a><a href="#h6-2-4" id="h6-2-4" class="i">+            Self::Having =&gt; &quot;HAVING&quot;,
</a>             Self::Infinity =&gt; &quot;INFINITY&quot;,
             Self::Inner =&gt; &quot;INNER&quot;,
             Self::Insert =&gt; &quot;INSERT&quot;,
<b>diff --git a/<a id="h7" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -269,6 +269,8 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>             select: self.parse_clause_select()?.unwrap(),
             from: self.parse_clause_from()?,
             r#where: self.parse_clause_where()?,
<a href="#h7-0-3" id="h7-0-3" class="i">+            group_by: self.parse_clause_group_by()?,
</a><a href="#h7-0-4" id="h7-0-4" class="i">+            having: self.parse_clause_having()?,
</a>             order: self.parse_clause_order()?,
             limit: if self.next_if_token(Keyword::Limit.into()).is_some() {
                 Some(self.parse_expression(0)?)
<a href="#h7-1" id="h7-1" class="h">@@ -412,6 +414,30 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>         }
     }
 
<a href="#h7-1-3" id="h7-1-3" class="i">+    /// Parses a group by clause
</a><a href="#h7-1-4" id="h7-1-4" class="i">+    fn parse_clause_group_by(&amp;mut self) -&gt; Result&lt;Option&lt;ast::GroupByClause&gt;, Error&gt; {
</a><a href="#h7-1-5" id="h7-1-5" class="i">+        if self.next_if_token(Keyword::Group.into()).is_none() {
</a><a href="#h7-1-6" id="h7-1-6" class="i">+            return Ok(None);
</a><a href="#h7-1-7" id="h7-1-7" class="i">+        }
</a><a href="#h7-1-8" id="h7-1-8" class="i">+        self.next_expect(Some(Keyword::By.into()))?;
</a><a href="#h7-1-9" id="h7-1-9" class="i">+        let mut exprs = Vec::new();
</a><a href="#h7-1-10" id="h7-1-10" class="i">+        loop {
</a><a href="#h7-1-11" id="h7-1-11" class="i">+            exprs.push(self.parse_expression(0)?);
</a><a href="#h7-1-12" id="h7-1-12" class="i">+            if self.next_if_token(Token::Comma).is_none() {
</a><a href="#h7-1-13" id="h7-1-13" class="i">+                break;
</a><a href="#h7-1-14" id="h7-1-14" class="i">+            }
</a><a href="#h7-1-15" id="h7-1-15" class="i">+        }
</a><a href="#h7-1-16" id="h7-1-16" class="i">+        Ok(Some(ast::GroupByClause(exprs)))
</a><a href="#h7-1-17" id="h7-1-17" class="i">+    }
</a><a href="#h7-1-18" id="h7-1-18" class="i">+
</a><a href="#h7-1-19" id="h7-1-19" class="i">+    /// Parses a HAVING clause
</a><a href="#h7-1-20" id="h7-1-20" class="i">+    fn parse_clause_having(&amp;mut self) -&gt; Result&lt;Option&lt;ast::HavingClause&gt;, Error&gt; {
</a><a href="#h7-1-21" id="h7-1-21" class="i">+        if self.next_if_token(Keyword::Having.into()).is_none() {
</a><a href="#h7-1-22" id="h7-1-22" class="i">+            return Ok(None);
</a><a href="#h7-1-23" id="h7-1-23" class="i">+        }
</a><a href="#h7-1-24" id="h7-1-24" class="i">+        Ok(Some(ast::HavingClause(self.parse_expression(0)?)))
</a><a href="#h7-1-25" id="h7-1-25" class="i">+    }
</a><a href="#h7-1-26" id="h7-1-26" class="i">+
</a>     /// Parses an order clause
     fn parse_clause_order(&amp;mut self) -&gt; Result&lt;Vec&lt;(ast::Expression, ast::Order)&gt;, Error&gt; {
         if self.next_if_token(Keyword::Order.into()).is_none() {
<a href="#h7-2" id="h7-2" class="h">@@ -498,7 +524,12 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>                         if !args.is_empty() {
                             self.next_expect(Some(Token::Comma))?;
                         }
<a href="#h7-2-3" id="h7-2-3" class="d">-                        args.push(self.parse_expression(0)?);
</a><a href="#h7-2-4" id="h7-2-4" class="i">+                        if i == &quot;count&quot; &amp;&amp; self.next_if_token(Token::Asterisk).is_some() {
</a><a href="#h7-2-5" id="h7-2-5" class="i">+                            // FIXME Ugly hack to handle COUNT(*)
</a><a href="#h7-2-6" id="h7-2-6" class="i">+                            args.push(ast::Expression::Literal(ast::Literal::Boolean(true)));
</a><a href="#h7-2-7" id="h7-2-7" class="i">+                        } else {
</a><a href="#h7-2-8" id="h7-2-8" class="i">+                            args.push(self.parse_expression(0)?);
</a><a href="#h7-2-9" id="h7-2-9" class="i">+                        }
</a>                     }
                     ast::Expression::Function(i, args)
                 } else {
<b>diff --git a/<a id="h8" href="../file/src/sql/planner/mod.rs.html">src/sql/planner/mod.rs</a> b/<a href="../file/src/sql/planner/mod.rs.html">src/sql/planner/mod.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -1,9 +1,9 @@
</a> mod plan;
 
<a href="#h8-0-2" id="h8-0-2" class="d">-pub use plan::{Direction, Node, Plan};
</a><a href="#h8-0-3" id="h8-0-3" class="i">+pub use plan::{Aggregate, Aggregates, Direction, Node, Plan};
</a> 
 use super::parser::ast;
<a href="#h8-0-6" id="h8-0-6" class="d">-use super::types::expression::Expression;
</a><a href="#h8-0-7" id="h8-0-7" class="i">+use super::types::expression::{Expression, Expressions};
</a> use super::types::schema;
 use super::types::Value;
 use crate::Error;
<a href="#h8-1" id="h8-1" class="h">@@ -39,7 +39,10 @@ impl Planner {
</a>             ast::Statement::Delete { table, r#where } =&gt; {
                 let mut source = Node::Scan { table: table.clone(), alias: None };
                 if let Some(ast::WhereClause(expr)) = r#where {
<a href="#h8-1-3" id="h8-1-3" class="d">-                    source = Node::Filter { source: Box::new(source), predicate: expr.into() };
</a><a href="#h8-1-4" id="h8-1-4" class="i">+                    source = Node::Filter {
</a><a href="#h8-1-5" id="h8-1-5" class="i">+                        source: Box::new(source),
</a><a href="#h8-1-6" id="h8-1-6" class="i">+                        predicate: self.build_expression(expr)?,
</a><a href="#h8-1-7" id="h8-1-7" class="i">+                    };
</a>                 }
                 Node::Delete { table, source: Box::new(source) }
             }
<a href="#h8-2" id="h8-2" class="h">@@ -49,10 +52,19 @@ impl Planner {
</a>                 columns: columns.unwrap_or_else(Vec::new),
                 expressions: values
                     .into_iter()
<a href="#h8-2-3" id="h8-2-3" class="d">-                    .map(|exprs| exprs.into_iter().map(|expr| expr.into()).collect())
</a><a href="#h8-2-4" id="h8-2-4" class="d">-                    .collect(),
</a><a href="#h8-2-5" id="h8-2-5" class="i">+                    .map(|exprs| self.build_expressions(exprs))
</a><a href="#h8-2-6" id="h8-2-6" class="i">+                    .collect::&lt;Result&lt;_, Error&gt;&gt;()?,
</a>             },
<a href="#h8-2-8" id="h8-2-8" class="d">-            ast::Statement::Select { select, from, r#where, order, limit, offset } =&gt; {
</a><a href="#h8-2-9" id="h8-2-9" class="i">+            ast::Statement::Select {
</a><a href="#h8-2-10" id="h8-2-10" class="i">+                select,
</a><a href="#h8-2-11" id="h8-2-11" class="i">+                from,
</a><a href="#h8-2-12" id="h8-2-12" class="i">+                r#where,
</a><a href="#h8-2-13" id="h8-2-13" class="i">+                group_by,
</a><a href="#h8-2-14" id="h8-2-14" class="i">+                having,
</a><a href="#h8-2-15" id="h8-2-15" class="i">+                order,
</a><a href="#h8-2-16" id="h8-2-16" class="i">+                limit,
</a><a href="#h8-2-17" id="h8-2-17" class="i">+                offset,
</a><a href="#h8-2-18" id="h8-2-18" class="i">+            } =&gt; {
</a>                 let mut n: Node = match from {
                     Some(from) =&gt; {
                         let mut items = from.items.into_iter().rev();
<a href="#h8-3" id="h8-3" class="h">@@ -77,25 +89,99 @@ impl Planner {
</a>                     None =&gt; Node::Nothing,
                 };
                 if let Some(ast::WhereClause(expr)) = r#where {
<a href="#h8-3-3" id="h8-3-3" class="d">-                    n = Node::Filter { source: Box::new(n), predicate: expr.into() };
</a><a href="#h8-3-4" id="h8-3-4" class="i">+                    n = Node::Filter {
</a><a href="#h8-3-5" id="h8-3-5" class="i">+                        source: Box::new(n),
</a><a href="#h8-3-6" id="h8-3-6" class="i">+                        predicate: self.build_expression(expr)?,
</a><a href="#h8-3-7" id="h8-3-7" class="i">+                    };
</a>                 };
                 if !select.expressions.is_empty() {
<a href="#h8-3-10" id="h8-3-10" class="i">+                    let (mut pre, aggregates, mut post) =
</a><a href="#h8-3-11" id="h8-3-11" class="i">+                        self.build_aggregate_expressions(select.expressions)?;
</a><a href="#h8-3-12" id="h8-3-12" class="i">+                    let mut pre_labels: Vec&lt;Option&lt;String&gt;&gt; =
</a><a href="#h8-3-13" id="h8-3-13" class="i">+                        std::iter::repeat(None).take(pre.len()).collect();
</a><a href="#h8-3-14" id="h8-3-14" class="i">+                    if let Some(ast::GroupByClause(exprs)) = group_by {
</a><a href="#h8-3-15" id="h8-3-15" class="i">+                        for group in self.build_expressions(exprs)? {
</a><a href="#h8-3-16" id="h8-3-16" class="i">+                            if let Expression::Field(None, label) = &amp;group {
</a><a href="#h8-3-17" id="h8-3-17" class="i">+                                // If the group is a field reference to an AS label in the output,
</a><a href="#h8-3-18" id="h8-3-18" class="i">+                                // move the SELECT expression to the pre-projection and reference it
</a><a href="#h8-3-19" id="h8-3-19" class="i">+                                // in post unless it contains an aggregate. This handles e.g.:
</a><a href="#h8-3-20" id="h8-3-20" class="i">+                                // SELECT a * 2 AS p, SUM(b) FROM t GROUP BY p
</a><a href="#h8-3-21" id="h8-3-21" class="i">+                                if let Some(index) =
</a><a href="#h8-3-22" id="h8-3-22" class="i">+                                    select.labels.iter().position(|l| l.as_deref() == Some(label))
</a><a href="#h8-3-23" id="h8-3-23" class="i">+                                {
</a><a href="#h8-3-24" id="h8-3-24" class="i">+                                    if !post[index].walk(&amp;|expr| match expr {
</a><a href="#h8-3-25" id="h8-3-25" class="i">+                                        Expression::Column(i) if i &lt; &amp;aggregates.len() =&gt; false,
</a><a href="#h8-3-26" id="h8-3-26" class="i">+                                        _ =&gt; true,
</a><a href="#h8-3-27" id="h8-3-27" class="i">+                                    }) {
</a><a href="#h8-3-28" id="h8-3-28" class="i">+                                        return Err(Error::Value(
</a><a href="#h8-3-29" id="h8-3-29" class="i">+                                            &quot;cannot group by aggregate column&quot;.into(),
</a><a href="#h8-3-30" id="h8-3-30" class="i">+                                        ));
</a><a href="#h8-3-31" id="h8-3-31" class="i">+                                    }
</a><a href="#h8-3-32" id="h8-3-32" class="i">+                                    pre.push(std::mem::replace(
</a><a href="#h8-3-33" id="h8-3-33" class="i">+                                        &amp;mut post[index],
</a><a href="#h8-3-34" id="h8-3-34" class="i">+                                        Expression::Column(pre.len()),
</a><a href="#h8-3-35" id="h8-3-35" class="i">+                                    ));
</a><a href="#h8-3-36" id="h8-3-36" class="i">+                                    pre_labels.push(Some(label.clone()));
</a><a href="#h8-3-37" id="h8-3-37" class="i">+                                } else {
</a><a href="#h8-3-38" id="h8-3-38" class="i">+                                    pre.push(group);
</a><a href="#h8-3-39" id="h8-3-39" class="i">+                                    pre_labels.push(None);
</a><a href="#h8-3-40" id="h8-3-40" class="i">+                                }
</a><a href="#h8-3-41" id="h8-3-41" class="i">+                            } else {
</a><a href="#h8-3-42" id="h8-3-42" class="i">+                                // If the group expression is exactly equal as a SELECT expression,
</a><a href="#h8-3-43" id="h8-3-43" class="i">+                                // push them both to the pre-projection.
</a><a href="#h8-3-44" id="h8-3-44" class="i">+                                let mut pushed = false;
</a><a href="#h8-3-45" id="h8-3-45" class="i">+                                while let Some(index) = post.iter().position(|e| e == &amp;group) {
</a><a href="#h8-3-46" id="h8-3-46" class="i">+                                    pre.push(std::mem::replace(
</a><a href="#h8-3-47" id="h8-3-47" class="i">+                                        &amp;mut post[index],
</a><a href="#h8-3-48" id="h8-3-48" class="i">+                                        Expression::Column(pre.len()),
</a><a href="#h8-3-49" id="h8-3-49" class="i">+                                    ));
</a><a href="#h8-3-50" id="h8-3-50" class="i">+                                    pre_labels.push(None);
</a><a href="#h8-3-51" id="h8-3-51" class="i">+                                    pushed = true;
</a><a href="#h8-3-52" id="h8-3-52" class="i">+                                }
</a><a href="#h8-3-53" id="h8-3-53" class="i">+                                if !pushed {
</a><a href="#h8-3-54" id="h8-3-54" class="i">+                                    pre.push(group);
</a><a href="#h8-3-55" id="h8-3-55" class="i">+                                    pre_labels.push(None);
</a><a href="#h8-3-56" id="h8-3-56" class="i">+                                }
</a><a href="#h8-3-57" id="h8-3-57" class="i">+                            }
</a><a href="#h8-3-58" id="h8-3-58" class="i">+                        }
</a><a href="#h8-3-59" id="h8-3-59" class="i">+                    }
</a><a href="#h8-3-60" id="h8-3-60" class="i">+                    if !pre.is_empty() {
</a><a href="#h8-3-61" id="h8-3-61" class="i">+                        n = Node::Projection {
</a><a href="#h8-3-62" id="h8-3-62" class="i">+                            source: Box::new(n),
</a><a href="#h8-3-63" id="h8-3-63" class="i">+                            labels: pre_labels,
</a><a href="#h8-3-64" id="h8-3-64" class="i">+                            expressions: pre,
</a><a href="#h8-3-65" id="h8-3-65" class="i">+                        };
</a><a href="#h8-3-66" id="h8-3-66" class="i">+                    }
</a><a href="#h8-3-67" id="h8-3-67" class="i">+                    if !aggregates.is_empty() {
</a><a href="#h8-3-68" id="h8-3-68" class="i">+                        n = Node::Aggregation { source: Box::new(n), aggregates };
</a><a href="#h8-3-69" id="h8-3-69" class="i">+                    }
</a>                     n = Node::Projection {
                         source: Box::new(n),
                         labels: select.labels,
<a href="#h8-3-73" id="h8-3-73" class="d">-                        expressions: self.build_expressions(select.expressions)?,
</a><a href="#h8-3-74" id="h8-3-74" class="i">+                        expressions: post,
</a><a href="#h8-3-75" id="h8-3-75" class="i">+                    }
</a><a href="#h8-3-76" id="h8-3-76" class="i">+                };
</a><a href="#h8-3-77" id="h8-3-77" class="i">+
</a><a href="#h8-3-78" id="h8-3-78" class="i">+                if let Some(ast::HavingClause(expr)) = having {
</a><a href="#h8-3-79" id="h8-3-79" class="i">+                    n = Node::Filter {
</a><a href="#h8-3-80" id="h8-3-80" class="i">+                        source: Box::new(n),
</a><a href="#h8-3-81" id="h8-3-81" class="i">+                        predicate: self.build_expression(expr)?,
</a>                     };
                 };
<a href="#h8-3-84" id="h8-3-84" class="i">+
</a>                 // FIXME Because the projection doesn&#39;t retain original table values, we can&#39;t
                 // order by fields which are not in the result set.
                 if !order.is_empty() {
                     n = Node::Order {
                         source: Box::new(n),
<a href="#h8-3-90" id="h8-3-90" class="d">-                        orders: order.into_iter().map(|(e, o)| (e.into(), o.into())).collect(),
</a><a href="#h8-3-91" id="h8-3-91" class="i">+                        orders: order
</a><a href="#h8-3-92" id="h8-3-92" class="i">+                            .into_iter()
</a><a href="#h8-3-93" id="h8-3-93" class="i">+                            .map(|(e, o)| self.build_expression(e).map(|e| (e, o.into())))
</a><a href="#h8-3-94" id="h8-3-94" class="i">+                            .collect::&lt;Result&lt;_, _&gt;&gt;()?,
</a>                     };
                 }
                 if let Some(expr) = offset {
<a href="#h8-3-98" id="h8-3-98" class="d">-                    let expr = Expression::from(expr);
</a><a href="#h8-3-99" id="h8-3-99" class="i">+                    let expr = self.build_expression(expr)?;
</a>                     if !expr.is_constant() {
                         return Err(Error::Value(&quot;Offset must be constant value&quot;.into()));
                     }
<a href="#h8-4" id="h8-4" class="h">@@ -110,7 +196,7 @@ impl Planner {
</a>                     }
                 }
                 if let Some(expr) = limit {
<a href="#h8-4-3" id="h8-4-3" class="d">-                    let expr = Expression::from(expr);
</a><a href="#h8-4-4" id="h8-4-4" class="i">+                    let expr = self.build_expression(expr)?;
</a>                     if !expr.is_constant() {
                         return Err(Error::Value(&quot;Limit must be constant value&quot;.into()));
                     }
<a href="#h8-5" id="h8-5" class="h">@@ -129,32 +215,23 @@ impl Planner {
</a>             ast::Statement::Update { table, set, r#where } =&gt; {
                 let mut source = Node::Scan { table: table.clone(), alias: None };
                 if let Some(ast::WhereClause(expr)) = r#where {
<a href="#h8-5-3" id="h8-5-3" class="d">-                    source = Node::Filter { source: Box::new(source), predicate: expr.into() };
</a><a href="#h8-5-4" id="h8-5-4" class="i">+                    source = Node::Filter {
</a><a href="#h8-5-5" id="h8-5-5" class="i">+                        source: Box::new(source),
</a><a href="#h8-5-6" id="h8-5-6" class="i">+                        predicate: self.build_expression(expr)?,
</a><a href="#h8-5-7" id="h8-5-7" class="i">+                    };
</a>                 }
                 Node::Update {
                     table,
                     source: Box::new(source),
<a href="#h8-5-12" id="h8-5-12" class="d">-                    expressions: set.into_iter().map(|(c, e)| (c, e.into())).collect(),
</a><a href="#h8-5-13" id="h8-5-13" class="i">+                    expressions: set
</a><a href="#h8-5-14" id="h8-5-14" class="i">+                        .into_iter()
</a><a href="#h8-5-15" id="h8-5-15" class="i">+                        .map(|(c, e)| self.build_expression(e).map(|e| (c, e)))
</a><a href="#h8-5-16" id="h8-5-16" class="i">+                        .collect::&lt;Result&lt;_, _&gt;&gt;()?,
</a>                 }
             }
         })
     }
 
<a href="#h8-5-22" id="h8-5-22" class="d">-    /// Builds a plan expression from an AST expression
</a><a href="#h8-5-23" id="h8-5-23" class="d">-    fn build_expression(&amp;self, expr: ast::Expression) -&gt; Result&lt;Expression, Error&gt; {
</a><a href="#h8-5-24" id="h8-5-24" class="d">-        if let ast::Expression::Function(name, _) = expr {
</a><a href="#h8-5-25" id="h8-5-25" class="d">-            // All functions right now are aggregate functions
</a><a href="#h8-5-26" id="h8-5-26" class="d">-            Err(Error::Value(format!(&quot;Unknown function {}&quot;, name)))
</a><a href="#h8-5-27" id="h8-5-27" class="d">-        } else {
</a><a href="#h8-5-28" id="h8-5-28" class="d">-            Ok(expr.into())
</a><a href="#h8-5-29" id="h8-5-29" class="d">-        }
</a><a href="#h8-5-30" id="h8-5-30" class="d">-    }
</a><a href="#h8-5-31" id="h8-5-31" class="d">-
</a><a href="#h8-5-32" id="h8-5-32" class="d">-    /// Builds an array of plan expressions from AST expressions
</a><a href="#h8-5-33" id="h8-5-33" class="d">-    fn build_expressions(&amp;self, exprs: Vec&lt;ast::Expression&gt;) -&gt; Result&lt;Vec&lt;Expression&gt;, Error&gt; {
</a><a href="#h8-5-34" id="h8-5-34" class="d">-        exprs.into_iter().map(|e| self.build_expression(e)).collect()
</a><a href="#h8-5-35" id="h8-5-35" class="d">-    }
</a><a href="#h8-5-36" id="h8-5-36" class="d">-
</a>     /// Builds FROM items
     fn build_from_item(&amp;self, item: ast::FromItem) -&gt; Result&lt;Node, Error&gt; {
         Ok(match item {
<a href="#h8-6" id="h8-6" class="h">@@ -163,21 +240,21 @@ impl Planner {
</a>                 ast::JoinType::Cross | ast::JoinType::Inner =&gt; Node::NestedLoopJoin {
                     outer: Box::new(self.build_from_item(*left)?),
                     inner: Box::new(self.build_from_item(*right)?),
<a href="#h8-6-3" id="h8-6-3" class="d">-                    predicate: predicate.map(|e| e.into()),
</a><a href="#h8-6-4" id="h8-6-4" class="i">+                    predicate: predicate.map(|e| self.build_expression(e)).transpose()?,
</a>                     pad: false,
                     flip: false,
                 },
                 ast::JoinType::Left =&gt; Node::NestedLoopJoin {
                     outer: Box::new(self.build_from_item(*left)?),
                     inner: Box::new(self.build_from_item(*right)?),
<a href="#h8-6-11" id="h8-6-11" class="d">-                    predicate: predicate.map(|e| e.into()),
</a><a href="#h8-6-12" id="h8-6-12" class="i">+                    predicate: predicate.map(|e| self.build_expression(e)).transpose()?,
</a>                     pad: true,
                     flip: false,
                 },
                 ast::JoinType::Right =&gt; Node::NestedLoopJoin {
                     outer: Box::new(self.build_from_item(*left)?),
                     inner: Box::new(self.build_from_item(*right)?),
<a href="#h8-6-19" id="h8-6-19" class="d">-                    predicate: predicate.map(|e| e.into()),
</a><a href="#h8-6-20" id="h8-6-20" class="i">+                    predicate: predicate.map(|e| self.build_expression(e)).transpose()?,
</a>                     pad: true,
                     flip: true,
                 },
<a href="#h8-7" id="h8-7" class="h">@@ -185,6 +262,24 @@ impl Planner {
</a>         })
     }
 
<a href="#h8-7-3" id="h8-7-3" class="i">+    /// Builds an expression from an AST expression
</a><a href="#h8-7-4" id="h8-7-4" class="i">+    fn build_expression(&amp;self, expr: ast::Expression) -&gt; Result&lt;Expression, Error&gt; {
</a><a href="#h8-7-5" id="h8-7-5" class="i">+        ExpressionBuilder::build(expr)
</a><a href="#h8-7-6" id="h8-7-6" class="i">+    }
</a><a href="#h8-7-7" id="h8-7-7" class="i">+
</a><a href="#h8-7-8" id="h8-7-8" class="i">+    /// Builds expressions from AST expressions
</a><a href="#h8-7-9" id="h8-7-9" class="i">+    fn build_expressions(&amp;self, exprs: ast::Expressions) -&gt; Result&lt;Expressions, Error&gt; {
</a><a href="#h8-7-10" id="h8-7-10" class="i">+        ExpressionBuilder::build_many(exprs)
</a><a href="#h8-7-11" id="h8-7-11" class="i">+    }
</a><a href="#h8-7-12" id="h8-7-12" class="i">+
</a><a href="#h8-7-13" id="h8-7-13" class="i">+    /// Builds partitioned aggregate expressions from AST expressions
</a><a href="#h8-7-14" id="h8-7-14" class="i">+    fn build_aggregate_expressions(
</a><a href="#h8-7-15" id="h8-7-15" class="i">+        &amp;self,
</a><a href="#h8-7-16" id="h8-7-16" class="i">+        exprs: ast::Expressions,
</a><a href="#h8-7-17" id="h8-7-17" class="i">+    ) -&gt; Result&lt;(Expressions, Vec&lt;Aggregate&gt;, Expressions), Error&gt; {
</a><a href="#h8-7-18" id="h8-7-18" class="i">+        ExpressionBuilder::build_aggregates(exprs)
</a><a href="#h8-7-19" id="h8-7-19" class="i">+    }
</a><a href="#h8-7-20" id="h8-7-20" class="i">+
</a>     /// Builds a table schema from an AST CreateTable node
     fn build_schema_table(
         &amp;self,
<a href="#h8-8" id="h8-8" class="h">@@ -227,68 +322,140 @@ impl Planner {
</a>     }
 }
 
<a href="#h8-8-3" id="h8-8-3" class="d">-/// Helpers to convert AST nodes into plan nodes
</a><a href="#h8-8-4" id="h8-8-4" class="d">-impl From&lt;ast::Expression&gt; for Expression {
</a><a href="#h8-8-5" id="h8-8-5" class="d">-    fn from(expr: ast::Expression) -&gt; Self {
</a><a href="#h8-8-6" id="h8-8-6" class="d">-        match expr {
</a><a href="#h8-8-7" id="h8-8-7" class="d">-            ast::Expression::Literal(l) =&gt; Expression::Constant(l.into()),
</a><a href="#h8-8-8" id="h8-8-8" class="d">-            ast::Expression::Field(rel, name) =&gt; Expression::Field(rel, name),
</a><a href="#h8-8-9" id="h8-8-9" class="d">-            ast::Expression::Function(_, _) =&gt; unimplemented!(), // Not supported
</a><a href="#h8-8-10" id="h8-8-10" class="i">+/// Builds expressions.
</a><a href="#h8-8-11" id="h8-8-11" class="i">+struct ExpressionBuilder {
</a><a href="#h8-8-12" id="h8-8-12" class="i">+    agg_allow: bool,
</a><a href="#h8-8-13" id="h8-8-13" class="i">+    aggs: Vec&lt;Aggregate&gt;,
</a><a href="#h8-8-14" id="h8-8-14" class="i">+    agg_args: Expressions,
</a><a href="#h8-8-15" id="h8-8-15" class="i">+}
</a><a href="#h8-8-16" id="h8-8-16" class="i">+
</a><a href="#h8-8-17" id="h8-8-17" class="i">+impl ExpressionBuilder {
</a><a href="#h8-8-18" id="h8-8-18" class="i">+    /// Builds a single expression.
</a><a href="#h8-8-19" id="h8-8-19" class="i">+    fn build(expr: ast::Expression) -&gt; Result&lt;Expression, Error&gt; {
</a><a href="#h8-8-20" id="h8-8-20" class="i">+        Ok(*ExpressionBuilder { agg_allow: false, aggs: Vec::new(), agg_args: Vec::new() }
</a><a href="#h8-8-21" id="h8-8-21" class="i">+            .make(Box::new(expr))?)
</a><a href="#h8-8-22" id="h8-8-22" class="i">+    }
</a><a href="#h8-8-23" id="h8-8-23" class="i">+
</a><a href="#h8-8-24" id="h8-8-24" class="i">+    /// Builds multiple expressions.
</a><a href="#h8-8-25" id="h8-8-25" class="i">+    fn build_many(exprs: ast::Expressions) -&gt; Result&lt;Expressions, Error&gt; {
</a><a href="#h8-8-26" id="h8-8-26" class="i">+        exprs.into_iter().map(Self::build).collect()
</a><a href="#h8-8-27" id="h8-8-27" class="i">+    }
</a><a href="#h8-8-28" id="h8-8-28" class="i">+
</a><a href="#h8-8-29" id="h8-8-29" class="i">+    /// Builds aggregate expressions as a pre-projection, aggregation, and post-projection. All
</a><a href="#h8-8-30" id="h8-8-30" class="i">+    /// non-constant, non-aggregate expressions are pushed to the pre-projection as grouping
</a><a href="#h8-8-31" id="h8-8-31" class="i">+    /// expressions (caller should validate against GROUP BY), following expressions referenced by
</a><a href="#h8-8-32" id="h8-8-32" class="i">+    /// the aggregates.
</a><a href="#h8-8-33" id="h8-8-33" class="i">+    fn build_aggregates(
</a><a href="#h8-8-34" id="h8-8-34" class="i">+        exprs: ast::Expressions,
</a><a href="#h8-8-35" id="h8-8-35" class="i">+    ) -&gt; Result&lt;(Expressions, Aggregates, Expressions), Error&gt; {
</a><a href="#h8-8-36" id="h8-8-36" class="i">+        let mut builder =
</a><a href="#h8-8-37" id="h8-8-37" class="i">+            ExpressionBuilder { agg_allow: true, aggs: Vec::new(), agg_args: Vec::new() };
</a><a href="#h8-8-38" id="h8-8-38" class="i">+
</a><a href="#h8-8-39" id="h8-8-39" class="i">+        let mut post = Vec::new();
</a><a href="#h8-8-40" id="h8-8-40" class="i">+        for expr in exprs.into_iter() {
</a><a href="#h8-8-41" id="h8-8-41" class="i">+            post.push(*builder.make(Box::new(expr))?);
</a><a href="#h8-8-42" id="h8-8-42" class="i">+        }
</a><a href="#h8-8-43" id="h8-8-43" class="i">+        let pre = builder.agg_args;
</a><a href="#h8-8-44" id="h8-8-44" class="i">+        let aggs = builder.aggs;
</a><a href="#h8-8-45" id="h8-8-45" class="i">+
</a><a href="#h8-8-46" id="h8-8-46" class="i">+        Ok((pre, aggs, post))
</a><a href="#h8-8-47" id="h8-8-47" class="i">+    }
</a><a href="#h8-8-48" id="h8-8-48" class="i">+
</a><a href="#h8-8-49" id="h8-8-49" class="i">+    /// Used internally, with more convenient signature.
</a><a href="#h8-8-50" id="h8-8-50" class="i">+    #[allow(clippy::boxed_local)]
</a><a href="#h8-8-51" id="h8-8-51" class="i">+    fn make(&amp;mut self, expr: Box&lt;ast::Expression&gt;) -&gt; Result&lt;Box&lt;Expression&gt;, Error&gt; {
</a><a href="#h8-8-52" id="h8-8-52" class="i">+        use Expression::*;
</a><a href="#h8-8-53" id="h8-8-53" class="i">+        Ok(Box::new(match *expr {
</a><a href="#h8-8-54" id="h8-8-54" class="i">+            ast::Expression::Literal(l) =&gt; Constant(match l {
</a><a href="#h8-8-55" id="h8-8-55" class="i">+                ast::Literal::Null =&gt; Value::Null,
</a><a href="#h8-8-56" id="h8-8-56" class="i">+                ast::Literal::Boolean(b) =&gt; Value::Boolean(b),
</a><a href="#h8-8-57" id="h8-8-57" class="i">+                ast::Literal::Integer(i) =&gt; Value::Integer(i),
</a><a href="#h8-8-58" id="h8-8-58" class="i">+                ast::Literal::Float(f) =&gt; Value::Float(f),
</a><a href="#h8-8-59" id="h8-8-59" class="i">+                ast::Literal::String(s) =&gt; Value::String(s),
</a><a href="#h8-8-60" id="h8-8-60" class="i">+            }),
</a><a href="#h8-8-61" id="h8-8-61" class="i">+            ast::Expression::Field(rel, name) =&gt; Field(rel, name),
</a><a href="#h8-8-62" id="h8-8-62" class="i">+            ast::Expression::Function(name, mut args) =&gt; match name.as_str() {
</a><a href="#h8-8-63" id="h8-8-63" class="i">+                &quot;avg&quot; | &quot;count&quot; | &quot;max&quot; | &quot;min&quot; | &quot;sum&quot; if args.len() == 1 =&gt; {
</a><a href="#h8-8-64" id="h8-8-64" class="i">+                    *self.make_aggregate(&amp;name, Box::new(args.remove(0)))?
</a><a href="#h8-8-65" id="h8-8-65" class="i">+                }
</a><a href="#h8-8-66" id="h8-8-66" class="i">+                _ =&gt; {
</a><a href="#h8-8-67" id="h8-8-67" class="i">+                    return Err(Error::Value(format!(
</a><a href="#h8-8-68" id="h8-8-68" class="i">+                        &quot;Unknown function {} with {} arguments&quot;,
</a><a href="#h8-8-69" id="h8-8-69" class="i">+                        name,
</a><a href="#h8-8-70" id="h8-8-70" class="i">+                        args.len()
</a><a href="#h8-8-71" id="h8-8-71" class="i">+                    )))
</a><a href="#h8-8-72" id="h8-8-72" class="i">+                }
</a><a href="#h8-8-73" id="h8-8-73" class="i">+            },
</a>             ast::Expression::Operation(op) =&gt; match op {
                 // Logical operators
<a href="#h8-8-76" id="h8-8-76" class="d">-                ast::Operation::And(lhs, rhs) =&gt; Self::And(lhs.into(), rhs.into()),
</a><a href="#h8-8-77" id="h8-8-77" class="d">-                ast::Operation::Not(expr) =&gt; Self::Not(expr.into()),
</a><a href="#h8-8-78" id="h8-8-78" class="d">-                ast::Operation::Or(lhs, rhs) =&gt; Self::Or(lhs.into(), rhs.into()),
</a><a href="#h8-8-79" id="h8-8-79" class="i">+                ast::Operation::And(lhs, rhs) =&gt; And(self.make(lhs)?, self.make(rhs)?),
</a><a href="#h8-8-80" id="h8-8-80" class="i">+                ast::Operation::Not(expr) =&gt; Not(self.make(expr)?),
</a><a href="#h8-8-81" id="h8-8-81" class="i">+                ast::Operation::Or(lhs, rhs) =&gt; Or(self.make(lhs)?, self.make(rhs)?),
</a> 
                 // Comparison operators
<a href="#h8-8-84" id="h8-8-84" class="d">-                ast::Operation::Equal(lhs, rhs) =&gt; Self::Equal(lhs.into(), rhs.into()),
</a><a href="#h8-8-85" id="h8-8-85" class="d">-                ast::Operation::GreaterThan(lhs, rhs) =&gt; Self::GreaterThan(lhs.into(), rhs.into()),
</a><a href="#h8-8-86" id="h8-8-86" class="d">-                ast::Operation::GreaterThanOrEqual(lhs, rhs) =&gt; Self::Or(
</a><a href="#h8-8-87" id="h8-8-87" class="d">-                    Self::GreaterThan(lhs.clone().into(), rhs.clone().into()).into(),
</a><a href="#h8-8-88" id="h8-8-88" class="d">-                    Self::Equal(lhs.into(), rhs.into()).into(),
</a><a href="#h8-8-89" id="h8-8-89" class="i">+                ast::Operation::Equal(lhs, rhs) =&gt; Equal(self.make(lhs)?, self.make(rhs)?),
</a><a href="#h8-8-90" id="h8-8-90" class="i">+                ast::Operation::GreaterThan(lhs, rhs) =&gt; {
</a><a href="#h8-8-91" id="h8-8-91" class="i">+                    GreaterThan(self.make(lhs)?, self.make(rhs)?)
</a><a href="#h8-8-92" id="h8-8-92" class="i">+                }
</a><a href="#h8-8-93" id="h8-8-93" class="i">+                ast::Operation::GreaterThanOrEqual(lhs, rhs) =&gt; Or(
</a><a href="#h8-8-94" id="h8-8-94" class="i">+                    GreaterThan(self.make(lhs.clone())?, self.make(rhs.clone())?).into(),
</a><a href="#h8-8-95" id="h8-8-95" class="i">+                    Equal(self.make(lhs)?, self.make(rhs)?).into(),
</a>                 ),
<a href="#h8-8-97" id="h8-8-97" class="d">-                ast::Operation::IsNull(expr) =&gt; Self::IsNull(expr.into()),
</a><a href="#h8-8-98" id="h8-8-98" class="d">-                ast::Operation::LessThan(lhs, rhs) =&gt; Self::LessThan(lhs.into(), rhs.into()),
</a><a href="#h8-8-99" id="h8-8-99" class="d">-                ast::Operation::LessThanOrEqual(lhs, rhs) =&gt; Self::Or(
</a><a href="#h8-8-100" id="h8-8-100" class="d">-                    Self::LessThan(lhs.clone().into(), rhs.clone().into()).into(),
</a><a href="#h8-8-101" id="h8-8-101" class="d">-                    Self::Equal(lhs.into(), rhs.into()).into(),
</a><a href="#h8-8-102" id="h8-8-102" class="i">+                ast::Operation::IsNull(expr) =&gt; IsNull(self.make(expr)?),
</a><a href="#h8-8-103" id="h8-8-103" class="i">+                ast::Operation::LessThan(lhs, rhs) =&gt; LessThan(self.make(lhs)?, self.make(rhs)?),
</a><a href="#h8-8-104" id="h8-8-104" class="i">+                ast::Operation::LessThanOrEqual(lhs, rhs) =&gt; Or(
</a><a href="#h8-8-105" id="h8-8-105" class="i">+                    LessThan(self.make(lhs.clone())?, self.make(rhs.clone())?).into(),
</a><a href="#h8-8-106" id="h8-8-106" class="i">+                    Equal(self.make(lhs)?, self.make(rhs)?).into(),
</a>                 ),
<a href="#h8-8-108" id="h8-8-108" class="d">-                ast::Operation::Like(lhs, rhs) =&gt; Self::Like(lhs.into(), rhs.into()),
</a><a href="#h8-8-109" id="h8-8-109" class="i">+                ast::Operation::Like(lhs, rhs) =&gt; Like(self.make(lhs)?, self.make(rhs)?),
</a>                 ast::Operation::NotEqual(lhs, rhs) =&gt; {
<a href="#h8-8-111" id="h8-8-111" class="d">-                    Self::Not(Self::Equal(lhs.into(), rhs.into()).into())
</a><a href="#h8-8-112" id="h8-8-112" class="i">+                    Not(Equal(self.make(lhs)?, self.make(rhs)?).into())
</a>                 }
 
                 // Mathematical operators
<a href="#h8-8-116" id="h8-8-116" class="d">-                ast::Operation::Assert(expr) =&gt; Self::Assert(expr.into()),
</a><a href="#h8-8-117" id="h8-8-117" class="d">-                ast::Operation::Add(lhs, rhs) =&gt; Self::Add(lhs.into(), rhs.into()),
</a><a href="#h8-8-118" id="h8-8-118" class="d">-                ast::Operation::Divide(lhs, rhs) =&gt; Self::Divide(lhs.into(), rhs.into()),
</a><a href="#h8-8-119" id="h8-8-119" class="i">+                ast::Operation::Assert(expr) =&gt; Assert(self.make(expr)?),
</a><a href="#h8-8-120" id="h8-8-120" class="i">+                ast::Operation::Add(lhs, rhs) =&gt; Add(self.make(lhs)?, self.make(rhs)?),
</a><a href="#h8-8-121" id="h8-8-121" class="i">+                ast::Operation::Divide(lhs, rhs) =&gt; Divide(self.make(lhs)?, self.make(rhs)?),
</a>                 ast::Operation::Exponentiate(lhs, rhs) =&gt; {
<a href="#h8-8-123" id="h8-8-123" class="d">-                    Self::Exponentiate(lhs.into(), rhs.into())
</a><a href="#h8-8-124" id="h8-8-124" class="i">+                    Exponentiate(self.make(lhs)?, self.make(rhs)?)
</a>                 }
<a href="#h8-8-126" id="h8-8-126" class="d">-                ast::Operation::Factorial(expr) =&gt; Self::Factorial(expr.into()),
</a><a href="#h8-8-127" id="h8-8-127" class="d">-                ast::Operation::Modulo(lhs, rhs) =&gt; Self::Modulo(lhs.into(), rhs.into()),
</a><a href="#h8-8-128" id="h8-8-128" class="d">-                ast::Operation::Multiply(lhs, rhs) =&gt; Self::Multiply(lhs.into(), rhs.into()),
</a><a href="#h8-8-129" id="h8-8-129" class="d">-                ast::Operation::Negate(expr) =&gt; Self::Negate(expr.into()),
</a><a href="#h8-8-130" id="h8-8-130" class="d">-                ast::Operation::Subtract(lhs, rhs) =&gt; Self::Subtract(lhs.into(), rhs.into()),
</a><a href="#h8-8-131" id="h8-8-131" class="i">+                ast::Operation::Factorial(expr) =&gt; Factorial(self.make(expr)?),
</a><a href="#h8-8-132" id="h8-8-132" class="i">+                ast::Operation::Modulo(lhs, rhs) =&gt; Modulo(self.make(lhs)?, self.make(rhs)?),
</a><a href="#h8-8-133" id="h8-8-133" class="i">+                ast::Operation::Multiply(lhs, rhs) =&gt; Multiply(self.make(lhs)?, self.make(rhs)?),
</a><a href="#h8-8-134" id="h8-8-134" class="i">+                ast::Operation::Negate(expr) =&gt; Negate(self.make(expr)?),
</a><a href="#h8-8-135" id="h8-8-135" class="i">+                ast::Operation::Subtract(lhs, rhs) =&gt; Subtract(self.make(lhs)?, self.make(rhs)?),
</a>             },
<a href="#h8-8-137" id="h8-8-137" class="d">-        }
</a><a href="#h8-8-138" id="h8-8-138" class="i">+        }))
</a>     }
<a href="#h8-8-140" id="h8-8-140" class="d">-}
</a> 
<a href="#h8-8-142" id="h8-8-142" class="d">-impl From&lt;Box&lt;ast::Expression&gt;&gt; for Box&lt;Expression&gt; {
</a><a href="#h8-8-143" id="h8-8-143" class="d">-    fn from(expr: Box&lt;ast::Expression&gt;) -&gt; Self {
</a><a href="#h8-8-144" id="h8-8-144" class="d">-        Box::new((*expr).into())
</a><a href="#h8-8-145" id="h8-8-145" class="d">-    }
</a><a href="#h8-8-146" id="h8-8-146" class="d">-}
</a><a href="#h8-8-147" id="h8-8-147" class="d">-
</a><a href="#h8-8-148" id="h8-8-148" class="d">-impl From&lt;ast::Literal&gt; for Value {
</a><a href="#h8-8-149" id="h8-8-149" class="d">-    fn from(literal: ast::Literal) -&gt; Self {
</a><a href="#h8-8-150" id="h8-8-150" class="d">-        match literal {
</a><a href="#h8-8-151" id="h8-8-151" class="d">-            ast::Literal::Null =&gt; Value::Null,
</a><a href="#h8-8-152" id="h8-8-152" class="d">-            ast::Literal::Boolean(b) =&gt; b.into(),
</a><a href="#h8-8-153" id="h8-8-153" class="d">-            ast::Literal::Float(f) =&gt; f.into(),
</a><a href="#h8-8-154" id="h8-8-154" class="d">-            ast::Literal::Integer(i) =&gt; i.into(),
</a><a href="#h8-8-155" id="h8-8-155" class="d">-            ast::Literal::String(s) =&gt; s.into(),
</a><a href="#h8-8-156" id="h8-8-156" class="i">+    fn make_aggregate(
</a><a href="#h8-8-157" id="h8-8-157" class="i">+        &amp;mut self,
</a><a href="#h8-8-158" id="h8-8-158" class="i">+        name: &amp;str,
</a><a href="#h8-8-159" id="h8-8-159" class="i">+        expr: Box&lt;ast::Expression&gt;,
</a><a href="#h8-8-160" id="h8-8-160" class="i">+    ) -&gt; Result&lt;Box&lt;Expression&gt;, Error&gt; {
</a><a href="#h8-8-161" id="h8-8-161" class="i">+        if !self.agg_allow {
</a><a href="#h8-8-162" id="h8-8-162" class="i">+            return Err(Error::Value(format!(
</a><a href="#h8-8-163" id="h8-8-163" class="i">+                &quot;Aggregate function {}() not allowed here&quot;,
</a><a href="#h8-8-164" id="h8-8-164" class="i">+                name.to_uppercase()
</a><a href="#h8-8-165" id="h8-8-165" class="i">+            )));
</a>         }
<a href="#h8-8-167" id="h8-8-167" class="i">+        self.aggs.push(match name {
</a><a href="#h8-8-168" id="h8-8-168" class="i">+            &quot;avg&quot; =&gt; Aggregate::Average,
</a><a href="#h8-8-169" id="h8-8-169" class="i">+            &quot;count&quot; =&gt; Aggregate::Count,
</a><a href="#h8-8-170" id="h8-8-170" class="i">+            &quot;max&quot; =&gt; Aggregate::Max,
</a><a href="#h8-8-171" id="h8-8-171" class="i">+            &quot;min&quot; =&gt; Aggregate::Min,
</a><a href="#h8-8-172" id="h8-8-172" class="i">+            &quot;sum&quot; =&gt; Aggregate::Sum,
</a><a href="#h8-8-173" id="h8-8-173" class="i">+            _ =&gt; {
</a><a href="#h8-8-174" id="h8-8-174" class="i">+                return Err(Error::Internal(format!(
</a><a href="#h8-8-175" id="h8-8-175" class="i">+                    &quot;Invalid aggregate function {}()&quot;,
</a><a href="#h8-8-176" id="h8-8-176" class="i">+                    name.to_uppercase()
</a><a href="#h8-8-177" id="h8-8-177" class="i">+                )))
</a><a href="#h8-8-178" id="h8-8-178" class="i">+            }
</a><a href="#h8-8-179" id="h8-8-179" class="i">+        });
</a><a href="#h8-8-180" id="h8-8-180" class="i">+        self.agg_allow = false;
</a><a href="#h8-8-181" id="h8-8-181" class="i">+        let arg = *self.make(expr)?;
</a><a href="#h8-8-182" id="h8-8-182" class="i">+        self.agg_args.push(arg);
</a><a href="#h8-8-183" id="h8-8-183" class="i">+        self.agg_allow = true;
</a><a href="#h8-8-184" id="h8-8-184" class="i">+        Ok(Box::new(Expression::Column(self.aggs.len() - 1)))
</a>     }
 }
<b>diff --git a/<a id="h9" href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a> b/<a href="../file/src/sql/planner/plan.rs.html">src/sql/planner/plan.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -39,6 +39,10 @@ impl Plan {
</a> /// A plan node
 #[derive(Debug)]
 pub enum Node {
<a href="#h9-0-3" id="h9-0-3" class="i">+    Aggregation {
</a><a href="#h9-0-4" id="h9-0-4" class="i">+        source: Box&lt;Self&gt;,
</a><a href="#h9-0-5" id="h9-0-5" class="i">+        aggregates: Vec&lt;Aggregate&gt;,
</a><a href="#h9-0-6" id="h9-0-6" class="i">+    },
</a>     CreateTable {
         schema: schema::Table,
     },
<a href="#h9-1" id="h9-1" class="h">@@ -109,6 +113,9 @@ impl Node {
</a>             n @ Self::Insert { .. } =&gt; n,
             n @ Self::Nothing =&gt; n,
             n @ Self::Scan { .. } =&gt; n,
<a href="#h9-1-3" id="h9-1-3" class="i">+            Self::Aggregation { source, aggregates } =&gt; {
</a><a href="#h9-1-4" id="h9-1-4" class="i">+                Self::Aggregation { source: source.transform(pre, post)?.into(), aggregates }
</a><a href="#h9-1-5" id="h9-1-5" class="i">+            }
</a>             Self::Delete { table, source } =&gt; {
                 Self::Delete { table, source: source.transform(pre, post)?.into() }
             }
<a href="#h9-2" id="h9-2" class="h">@@ -151,6 +158,7 @@ impl Node {
</a>         A: Fn(Expression) -&gt; Result&lt;Expression, Error&gt;,
     {
         Ok(match self {
<a href="#h9-2-3" id="h9-2-3" class="i">+            n @ Self::Aggregation { .. } =&gt; n,
</a>             n @ Self::CreateTable { .. } =&gt; n,
             n @ Self::Delete { .. } =&gt; n,
             n @ Self::DropTable { .. } =&gt; n,
<a href="#h9-3" id="h9-3" class="h">@@ -197,6 +205,18 @@ impl Node {
</a>     }
 }
 
<a href="#h9-3-3" id="h9-3-3" class="i">+/// An aggregate operation
</a><a href="#h9-3-4" id="h9-3-4" class="i">+#[derive(Debug)]
</a><a href="#h9-3-5" id="h9-3-5" class="i">+pub enum Aggregate {
</a><a href="#h9-3-6" id="h9-3-6" class="i">+    Average,
</a><a href="#h9-3-7" id="h9-3-7" class="i">+    Count,
</a><a href="#h9-3-8" id="h9-3-8" class="i">+    Max,
</a><a href="#h9-3-9" id="h9-3-9" class="i">+    Min,
</a><a href="#h9-3-10" id="h9-3-10" class="i">+    Sum,
</a><a href="#h9-3-11" id="h9-3-11" class="i">+}
</a><a href="#h9-3-12" id="h9-3-12" class="i">+
</a><a href="#h9-3-13" id="h9-3-13" class="i">+pub type Aggregates = Vec&lt;Aggregate&gt;;
</a><a href="#h9-3-14" id="h9-3-14" class="i">+
</a> /// A sort order direction
 #[derive(Debug, PartialEq)]
 pub enum Direction {
<b>diff --git a/<a id="h10" href="../file/src/sql/tests/expression.rs.html">src/sql/tests/expression.rs</a> b/<a href="../file/src/sql/tests/expression.rs.html">src/sql/tests/expression.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -70,10 +70,10 @@ test_expr! {
</a>     lit_string_long: &amp;format!(&quot;&#39;{}&#39;&quot;, &quot;a&quot;.repeat(4096)) =&gt; Ok(&quot;a&quot;.repeat(4096).into()),
 
     // Functions
<a href="#h10-0-3" id="h10-0-3" class="d">-    func_unknown: &quot;unknown()&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown&quot;.into())),
</a><a href="#h10-0-4" id="h10-0-4" class="d">-    func_unknown_case: &quot;UnKnown ( )&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown&quot;.into())),
</a><a href="#h10-0-5" id="h10-0-5" class="d">-    func_unknown_space: &quot;unknown ( )&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown&quot;.into())),
</a><a href="#h10-0-6" id="h10-0-6" class="d">-    func_unknown_args: &quot;unknown(a, b, c)&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown&quot;.into())),
</a><a href="#h10-0-7" id="h10-0-7" class="i">+    func_unknown: &quot;unknown()&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown with 0 arguments&quot;.into())),
</a><a href="#h10-0-8" id="h10-0-8" class="i">+    func_unknown_case: &quot;UnKnown ( )&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown with 0 arguments&quot;.into())),
</a><a href="#h10-0-9" id="h10-0-9" class="i">+    func_unknown_space: &quot;unknown ( )&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown with 0 arguments&quot;.into())),
</a><a href="#h10-0-10" id="h10-0-10" class="i">+    func_unknown_args: &quot;unknown(a, b, c)&quot; =&gt; Err(Error::Value(&quot;Unknown function unknown with 3 arguments&quot;.into())),
</a>     func_unknown_open: &quot;unknown(a, b, c&quot; =&gt; Err(Error::Parse(&quot;Unexpected end of input&quot;.into())),
     func_unknown_trailing_comma: &quot;unknown(a, b, c,)&quot; =&gt; Err(Error::Parse(&quot;Expected expression atom, found )&quot;.into())),
 
<b>diff --git a/<a id="h11" href="../file/src/sql/tests/query.rs.html">src/sql/tests/query.rs</a> b/<a href="../file/src/sql/tests/query.rs.html">src/sql/tests/query.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -32,7 +32,8 @@ macro_rules! test_query {
</a>                 )&quot;,
                 &quot;INSERT INTO genres VALUES
                     (1, &#39;Science Fiction&#39;),
<a href="#h11-0-3" id="h11-0-3" class="d">-                    (2, &#39;Action&#39;)&quot;,
</a><a href="#h11-0-4" id="h11-0-4" class="i">+                    (2, &#39;Action&#39;),
</a><a href="#h11-0-5" id="h11-0-5" class="i">+                    (3, &#39;Comedy&#39;)&quot;,
</a>                 &quot;CREATE TABLE studios (
                     id INTEGER PRIMARY KEY,
                     name STRING NOT NULL,
<a href="#h11-1" id="h11-1" class="h">@@ -53,11 +54,16 @@ macro_rules! test_query {
</a>                     ultrahd BOOLEAN
                 )&quot;,
                 &quot;INSERT INTO movies VALUES
<a href="#h11-1-3" id="h11-1-3" class="d">-                    (1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, FALSE),
</a><a href="#h11-1-4" id="h11-1-4" class="i">+                    (1, &#39;Stalker&#39;, 1, 1, 1979, 8.2, NULL),
</a>                     (2, &#39;Sicario&#39;, 2, 2, 2015, 7.6, TRUE),
                     (3, &#39;Primer&#39;, 3, 1, 2004, 6.9, NULL),
                     (4, &#39;Heat&#39;, 4, 2, 1995, 8.2, TRUE),
<a href="#h11-1-8" id="h11-1-8" class="d">-                    (5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE)&quot;,
</a><a href="#h11-1-9" id="h11-1-9" class="i">+                    (5, &#39;The Fountain&#39;, 4, 1, 2006, 7.2, FALSE),
</a><a href="#h11-1-10" id="h11-1-10" class="i">+                    (6, &#39;Solaris&#39;, 1, 1, 1972, 8.1, NULL),
</a><a href="#h11-1-11" id="h11-1-11" class="i">+                    (7, &#39;Gravity&#39;, 4, 1, 2013, 7.7, TRUE),
</a><a href="#h11-1-12" id="h11-1-12" class="i">+                    (8, &#39;Blindspotting&#39;, 2, 3, 2018, 7.4, TRUE),
</a><a href="#h11-1-13" id="h11-1-13" class="i">+                    (9, &#39;Birdman&#39;, 4, 3, 2014, 7.7, TRUE),
</a><a href="#h11-1-14" id="h11-1-14" class="i">+                    (10, &#39;Inception&#39;, 4, 1, 2010, 8.8, TRUE)&quot;,
</a>             ]);
             let engine = super::setup(setup)?;
 
<a href="#h11-2" id="h11-2" class="h">@@ -206,7 +212,7 @@ test_query! { with [
</a> }
 test_query! { with [
         &quot;CREATE TABLE floats (id INTEGER PRIMARY KEY, value FLOAT)&quot;,
<a href="#h11-2-3" id="h11-2-3" class="d">-        &quot;INSERT INTO floats VALUES (1, 3.14), (2, -2.718), (3, NULL), (4, 2.718), (5, 0.0)&quot;,
</a><a href="#h11-2-4" id="h11-2-4" class="i">+        &quot;INSERT INTO floats VALUES (1, 3.14), (2, -2.718), (3, NULL), (4, 1.618), (5, 0.0)&quot;,
</a>     ];
     order_float_asc: &quot;SELECT * FROM floats ORDER BY value ASC&quot;,
     order_float_desc: &quot;SELECT * FROM floats ORDER BY value DESC&quot;,
<a href="#h11-3" id="h11-3" class="h">@@ -290,4 +296,69 @@ test_query! {
</a>     join_right: &quot;SELECT g.id AS genre_id, m.id AS movie_id FROM genres g RIGHT JOIN movies m ON m.id = g.id&quot;,
     join_right_outer: &quot;SELECT g.id AS genre_id, m.id AS movie_id FROM genres g RIGHT OUTER JOIN movies m ON m.id = g.id&quot;,
     join_right_truncate: &quot;SELECT m.id AS movie_id, g.id AS genre_id FROM movies m RIGHT JOIN genres g ON m.id = g.id&quot;,
<a href="#h11-3-3" id="h11-3-3" class="i">+
</a><a href="#h11-3-4" id="h11-3-4" class="i">+    agg_count_star: &quot;SELECT COUNT(*) FROM movies&quot;,
</a><a href="#h11-3-5" id="h11-3-5" class="i">+    agg_expr: &quot;SELECT SUM(rating * 10) / COUNT(*) FROM movies&quot;,
</a><a href="#h11-3-6" id="h11-3-6" class="i">+    agg_nested: &quot;SELECT MAX(MIN(rating)) FROM movies&quot;,
</a><a href="#h11-3-7" id="h11-3-7" class="i">+    agg_ungrouped: &quot;SELECT studio_id, COUNT(*) FROM movies&quot;,
</a><a href="#h11-3-8" id="h11-3-8" class="i">+    agg_const: &quot;SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3)&quot;,
</a><a href="#h11-3-9" id="h11-3-9" class="i">+    agg_const_from: &quot;SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3) FROM genres&quot;,
</a><a href="#h11-3-10" id="h11-3-10" class="i">+}
</a><a href="#h11-3-11" id="h11-3-11" class="i">+test_query! { with [
</a><a href="#h11-3-12" id="h11-3-12" class="i">+        &quot;CREATE TABLE booleans (id INTEGER PRIMARY KEY, b BOOLEAN)&quot;,
</a><a href="#h11-3-13" id="h11-3-13" class="i">+        &quot;INSERT INTO booleans VALUES (1, TRUE), (2, NULL), (3, FALSE)&quot;,
</a><a href="#h11-3-14" id="h11-3-14" class="i">+    ];
</a><a href="#h11-3-15" id="h11-3-15" class="i">+    agg_boolean: &quot;SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans WHERE b IS NOT NULL&quot;,
</a><a href="#h11-3-16" id="h11-3-16" class="i">+    agg_boolean_null: &quot;SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans&quot;,
</a><a href="#h11-3-17" id="h11-3-17" class="i">+}
</a><a href="#h11-3-18" id="h11-3-18" class="i">+test_query! { with [
</a><a href="#h11-3-19" id="h11-3-19" class="i">+        &quot;CREATE TABLE floats (id INTEGER PRIMARY KEY, f FLOAT)&quot;,
</a><a href="#h11-3-20" id="h11-3-20" class="i">+        &quot;INSERT INTO floats VALUES (1, 3.14), (2, -2.718), (3, NULL), (4, 1.618), (5, 0.0)&quot;,
</a><a href="#h11-3-21" id="h11-3-21" class="i">+    ];
</a><a href="#h11-3-22" id="h11-3-22" class="i">+    agg_float: &quot;SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats WHERE f IS NOT NULL&quot;,
</a><a href="#h11-3-23" id="h11-3-23" class="i">+    agg_float_null: &quot;SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats&quot;,
</a><a href="#h11-3-24" id="h11-3-24" class="i">+}
</a><a href="#h11-3-25" id="h11-3-25" class="i">+test_query! { with [
</a><a href="#h11-3-26" id="h11-3-26" class="i">+        &quot;CREATE TABLE integers (id INTEGER PRIMARY KEY, i INTEGER)&quot;,
</a><a href="#h11-3-27" id="h11-3-27" class="i">+        &quot;INSERT INTO integers VALUES (1, 7), (2, NULL), (3, -3), (4, 5), (5, 0)&quot;,
</a><a href="#h11-3-28" id="h11-3-28" class="i">+    ];
</a><a href="#h11-3-29" id="h11-3-29" class="i">+    agg_integer: &quot;SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers WHERE i IS NOT NULL&quot;,
</a><a href="#h11-3-30" id="h11-3-30" class="i">+    agg_integer_null: &quot;SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers&quot;,
</a><a href="#h11-3-31" id="h11-3-31" class="i">+}
</a><a href="#h11-3-32" id="h11-3-32" class="i">+test_query! { with [
</a><a href="#h11-3-33" id="h11-3-33" class="i">+        &quot;CREATE TABLE strings (id INTEGER PRIMARY KEY, s STRING)&quot;,
</a><a href="#h11-3-34" id="h11-3-34" class="i">+        &quot;INSERT INTO strings VALUES
</a><a href="#h11-3-35" id="h11-3-35" class="i">+            (1, &#39;a&#39;),
</a><a href="#h11-3-36" id="h11-3-36" class="i">+            (2, &#39;ab&#39;),
</a><a href="#h11-3-37" id="h11-3-37" class="i">+            (3, &#39;aaa&#39;),
</a><a href="#h11-3-38" id="h11-3-38" class="i">+            (4, &#39;A&#39;),
</a><a href="#h11-3-39" id="h11-3-39" class="i">+            (5, NULL),
</a><a href="#h11-3-40" id="h11-3-40" class="i">+            (6, &#39;aA&#39;),
</a><a href="#h11-3-41" id="h11-3-41" class="i">+            (7, &#39;åa&#39;),
</a><a href="#h11-3-42" id="h11-3-42" class="i">+            (8, &#39;Åa&#39;)
</a><a href="#h11-3-43" id="h11-3-43" class="i">+        &quot;,
</a><a href="#h11-3-44" id="h11-3-44" class="i">+    ];
</a><a href="#h11-3-45" id="h11-3-45" class="i">+    agg_string: &quot;SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings WHERE s IS NOT NULL&quot;,
</a><a href="#h11-3-46" id="h11-3-46" class="i">+    agg_string_null: &quot;SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings&quot;,
</a><a href="#h11-3-47" id="h11-3-47" class="i">+}
</a><a href="#h11-3-48" id="h11-3-48" class="i">+test_query! {
</a><a href="#h11-3-49" id="h11-3-49" class="i">+    group_simple: &quot;SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY studio_id&quot;,
</a><a href="#h11-3-50" id="h11-3-50" class="i">+    group_noselect: &quot;SELECT MAX(rating) AS best FROM movies GROUP BY studio_id ORDER BY best DESC&quot;,
</a><a href="#h11-3-51" id="h11-3-51" class="i">+    group_noaggregate: &quot;SELECT title FROM movies GROUP BY title ORDER BY title ASC&quot;,
</a><a href="#h11-3-52" id="h11-3-52" class="i">+    group_unknown: &quot;SELECT COUNT(*) FROM movies GROUP BY unknown&quot;,
</a><a href="#h11-3-53" id="h11-3-53" class="i">+    group_join: &quot;SELECT s.name, COUNT(*) FROM movies m JOIN studios s ON m.studio_id = s.id GROUP BY s.name ORDER BY s.name ASC&quot;,
</a><a href="#h11-3-54" id="h11-3-54" class="i">+    group_order_agg: &quot;SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX(rating)&quot;,
</a><a href="#h11-3-55" id="h11-3-55" class="i">+    group_expr: &quot;SELECT MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating&quot;,
</a><a href="#h11-3-56" id="h11-3-56" class="i">+    group_expr_aliased: &quot;SELECT studio_id * 2 AS twice, MAX(rating) FROM movies GROUP BY twice ORDER BY twice&quot;,
</a><a href="#h11-3-57" id="h11-3-57" class="i">+    group_expr_both: &quot;SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating&quot;,
</a><a href="#h11-3-58" id="h11-3-58" class="i">+    group_expr_extended: &quot;SELECT studio_id * 2 + 1, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating&quot;,
</a><a href="#h11-3-59" id="h11-3-59" class="i">+    group_expr_select: &quot;SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id ORDER BY rating&quot;,
</a><a href="#h11-3-60" id="h11-3-60" class="i">+    group_expr_aggr: &quot;SELECT studio_id, SUM(rating * 10) / COUNT(*) FROM movies GROUP BY studio_id ORDER BY studio_id&quot;,
</a><a href="#h11-3-61" id="h11-3-61" class="i">+    group_expr_aggr_selfref: &quot;SELECT studio_id, SUM(rating * 10) / COUNT(*) + studio_id FROM movies GROUP BY studio_id ORDER BY studio_id&quot;,
</a><a href="#h11-3-62" id="h11-3-62" class="i">+    group_expr_aggr_nogroupref: &quot;SELECT studio_id, SUM(rating * 10) / COUNT(*) + id FROM movies GROUP BY studio_id ORDER BY studio_id&quot;,
</a><a href="#h11-3-63" id="h11-3-63" class="i">+    group_expr_multigroup: &quot;SELECT studio_id + genre_id AS multi, MAX(rating) AS rating FROM movies GROUP BY studio_id, genre_id ORDER BY rating, multi&quot;,
</a><a href="#h11-3-64" id="h11-3-64" class="i">+
</a><a href="#h11-3-65" id="h11-3-65" class="i">+
</a><a href="#h11-3-66" id="h11-3-66" class="i">+    having: &quot;SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING rating &gt; 8 ORDER BY studio_id&quot;,
</a><a href="#h11-3-67" id="h11-3-67" class="i">+    having_nogroup: &quot;SELECT id, rating FROM movies HAVING rating &gt; 8 ORDER BY id&quot;,
</a> }
<b>diff --git a/<a id="h12" href="../file/src/sql/tests/query/agg_boolean.html">src/sql/tests/query/agg_boolean</a> b/<a href="../file/src/sql/tests/query/agg_boolean.html">src/sql/tests/query/agg_boolean</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -0,0 +1,262 @@
</a><a href="#h12-0-0" id="h12-0-0" class="i">+Query: SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans WHERE b IS NOT NULL
</a><a href="#h12-0-1" id="h12-0-1" class="i">+
</a><a href="#h12-0-2" id="h12-0-2" class="i">+AST: Select {
</a><a href="#h12-0-3" id="h12-0-3" class="i">+    select: SelectClause {
</a><a href="#h12-0-4" id="h12-0-4" class="i">+        expressions: [
</a><a href="#h12-0-5" id="h12-0-5" class="i">+            Function(
</a><a href="#h12-0-6" id="h12-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h12-0-7" id="h12-0-7" class="i">+                [
</a><a href="#h12-0-8" id="h12-0-8" class="i">+                    Field(
</a><a href="#h12-0-9" id="h12-0-9" class="i">+                        None,
</a><a href="#h12-0-10" id="h12-0-10" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-11" id="h12-0-11" class="i">+                    ),
</a><a href="#h12-0-12" id="h12-0-12" class="i">+                ],
</a><a href="#h12-0-13" id="h12-0-13" class="i">+            ),
</a><a href="#h12-0-14" id="h12-0-14" class="i">+            Function(
</a><a href="#h12-0-15" id="h12-0-15" class="i">+                &quot;max&quot;,
</a><a href="#h12-0-16" id="h12-0-16" class="i">+                [
</a><a href="#h12-0-17" id="h12-0-17" class="i">+                    Field(
</a><a href="#h12-0-18" id="h12-0-18" class="i">+                        None,
</a><a href="#h12-0-19" id="h12-0-19" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-20" id="h12-0-20" class="i">+                    ),
</a><a href="#h12-0-21" id="h12-0-21" class="i">+                ],
</a><a href="#h12-0-22" id="h12-0-22" class="i">+            ),
</a><a href="#h12-0-23" id="h12-0-23" class="i">+            Function(
</a><a href="#h12-0-24" id="h12-0-24" class="i">+                &quot;sum&quot;,
</a><a href="#h12-0-25" id="h12-0-25" class="i">+                [
</a><a href="#h12-0-26" id="h12-0-26" class="i">+                    Field(
</a><a href="#h12-0-27" id="h12-0-27" class="i">+                        None,
</a><a href="#h12-0-28" id="h12-0-28" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-29" id="h12-0-29" class="i">+                    ),
</a><a href="#h12-0-30" id="h12-0-30" class="i">+                ],
</a><a href="#h12-0-31" id="h12-0-31" class="i">+            ),
</a><a href="#h12-0-32" id="h12-0-32" class="i">+            Function(
</a><a href="#h12-0-33" id="h12-0-33" class="i">+                &quot;count&quot;,
</a><a href="#h12-0-34" id="h12-0-34" class="i">+                [
</a><a href="#h12-0-35" id="h12-0-35" class="i">+                    Field(
</a><a href="#h12-0-36" id="h12-0-36" class="i">+                        None,
</a><a href="#h12-0-37" id="h12-0-37" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-38" id="h12-0-38" class="i">+                    ),
</a><a href="#h12-0-39" id="h12-0-39" class="i">+                ],
</a><a href="#h12-0-40" id="h12-0-40" class="i">+            ),
</a><a href="#h12-0-41" id="h12-0-41" class="i">+            Function(
</a><a href="#h12-0-42" id="h12-0-42" class="i">+                &quot;avg&quot;,
</a><a href="#h12-0-43" id="h12-0-43" class="i">+                [
</a><a href="#h12-0-44" id="h12-0-44" class="i">+                    Field(
</a><a href="#h12-0-45" id="h12-0-45" class="i">+                        None,
</a><a href="#h12-0-46" id="h12-0-46" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-47" id="h12-0-47" class="i">+                    ),
</a><a href="#h12-0-48" id="h12-0-48" class="i">+                ],
</a><a href="#h12-0-49" id="h12-0-49" class="i">+            ),
</a><a href="#h12-0-50" id="h12-0-50" class="i">+        ],
</a><a href="#h12-0-51" id="h12-0-51" class="i">+        labels: [
</a><a href="#h12-0-52" id="h12-0-52" class="i">+            None,
</a><a href="#h12-0-53" id="h12-0-53" class="i">+            None,
</a><a href="#h12-0-54" id="h12-0-54" class="i">+            None,
</a><a href="#h12-0-55" id="h12-0-55" class="i">+            None,
</a><a href="#h12-0-56" id="h12-0-56" class="i">+            None,
</a><a href="#h12-0-57" id="h12-0-57" class="i">+        ],
</a><a href="#h12-0-58" id="h12-0-58" class="i">+    },
</a><a href="#h12-0-59" id="h12-0-59" class="i">+    from: Some(
</a><a href="#h12-0-60" id="h12-0-60" class="i">+        FromClause {
</a><a href="#h12-0-61" id="h12-0-61" class="i">+            items: [
</a><a href="#h12-0-62" id="h12-0-62" class="i">+                Table {
</a><a href="#h12-0-63" id="h12-0-63" class="i">+                    name: &quot;booleans&quot;,
</a><a href="#h12-0-64" id="h12-0-64" class="i">+                    alias: None,
</a><a href="#h12-0-65" id="h12-0-65" class="i">+                },
</a><a href="#h12-0-66" id="h12-0-66" class="i">+            ],
</a><a href="#h12-0-67" id="h12-0-67" class="i">+        },
</a><a href="#h12-0-68" id="h12-0-68" class="i">+    ),
</a><a href="#h12-0-69" id="h12-0-69" class="i">+    where: Some(
</a><a href="#h12-0-70" id="h12-0-70" class="i">+        WhereClause(
</a><a href="#h12-0-71" id="h12-0-71" class="i">+            Operation(
</a><a href="#h12-0-72" id="h12-0-72" class="i">+                Not(
</a><a href="#h12-0-73" id="h12-0-73" class="i">+                    Operation(
</a><a href="#h12-0-74" id="h12-0-74" class="i">+                        IsNull(
</a><a href="#h12-0-75" id="h12-0-75" class="i">+                            Field(
</a><a href="#h12-0-76" id="h12-0-76" class="i">+                                None,
</a><a href="#h12-0-77" id="h12-0-77" class="i">+                                &quot;b&quot;,
</a><a href="#h12-0-78" id="h12-0-78" class="i">+                            ),
</a><a href="#h12-0-79" id="h12-0-79" class="i">+                        ),
</a><a href="#h12-0-80" id="h12-0-80" class="i">+                    ),
</a><a href="#h12-0-81" id="h12-0-81" class="i">+                ),
</a><a href="#h12-0-82" id="h12-0-82" class="i">+            ),
</a><a href="#h12-0-83" id="h12-0-83" class="i">+        ),
</a><a href="#h12-0-84" id="h12-0-84" class="i">+    ),
</a><a href="#h12-0-85" id="h12-0-85" class="i">+    group_by: None,
</a><a href="#h12-0-86" id="h12-0-86" class="i">+    having: None,
</a><a href="#h12-0-87" id="h12-0-87" class="i">+    order: [],
</a><a href="#h12-0-88" id="h12-0-88" class="i">+    limit: None,
</a><a href="#h12-0-89" id="h12-0-89" class="i">+    offset: None,
</a><a href="#h12-0-90" id="h12-0-90" class="i">+}
</a><a href="#h12-0-91" id="h12-0-91" class="i">+
</a><a href="#h12-0-92" id="h12-0-92" class="i">+Plan: Plan {
</a><a href="#h12-0-93" id="h12-0-93" class="i">+    root: Projection {
</a><a href="#h12-0-94" id="h12-0-94" class="i">+        source: Aggregation {
</a><a href="#h12-0-95" id="h12-0-95" class="i">+            source: Projection {
</a><a href="#h12-0-96" id="h12-0-96" class="i">+                source: Filter {
</a><a href="#h12-0-97" id="h12-0-97" class="i">+                    source: Scan {
</a><a href="#h12-0-98" id="h12-0-98" class="i">+                        table: &quot;booleans&quot;,
</a><a href="#h12-0-99" id="h12-0-99" class="i">+                        alias: None,
</a><a href="#h12-0-100" id="h12-0-100" class="i">+                    },
</a><a href="#h12-0-101" id="h12-0-101" class="i">+                    predicate: Not(
</a><a href="#h12-0-102" id="h12-0-102" class="i">+                        IsNull(
</a><a href="#h12-0-103" id="h12-0-103" class="i">+                            Field(
</a><a href="#h12-0-104" id="h12-0-104" class="i">+                                None,
</a><a href="#h12-0-105" id="h12-0-105" class="i">+                                &quot;b&quot;,
</a><a href="#h12-0-106" id="h12-0-106" class="i">+                            ),
</a><a href="#h12-0-107" id="h12-0-107" class="i">+                        ),
</a><a href="#h12-0-108" id="h12-0-108" class="i">+                    ),
</a><a href="#h12-0-109" id="h12-0-109" class="i">+                },
</a><a href="#h12-0-110" id="h12-0-110" class="i">+                labels: [
</a><a href="#h12-0-111" id="h12-0-111" class="i">+                    None,
</a><a href="#h12-0-112" id="h12-0-112" class="i">+                    None,
</a><a href="#h12-0-113" id="h12-0-113" class="i">+                    None,
</a><a href="#h12-0-114" id="h12-0-114" class="i">+                    None,
</a><a href="#h12-0-115" id="h12-0-115" class="i">+                    None,
</a><a href="#h12-0-116" id="h12-0-116" class="i">+                ],
</a><a href="#h12-0-117" id="h12-0-117" class="i">+                expressions: [
</a><a href="#h12-0-118" id="h12-0-118" class="i">+                    Field(
</a><a href="#h12-0-119" id="h12-0-119" class="i">+                        None,
</a><a href="#h12-0-120" id="h12-0-120" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-121" id="h12-0-121" class="i">+                    ),
</a><a href="#h12-0-122" id="h12-0-122" class="i">+                    Field(
</a><a href="#h12-0-123" id="h12-0-123" class="i">+                        None,
</a><a href="#h12-0-124" id="h12-0-124" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-125" id="h12-0-125" class="i">+                    ),
</a><a href="#h12-0-126" id="h12-0-126" class="i">+                    Field(
</a><a href="#h12-0-127" id="h12-0-127" class="i">+                        None,
</a><a href="#h12-0-128" id="h12-0-128" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-129" id="h12-0-129" class="i">+                    ),
</a><a href="#h12-0-130" id="h12-0-130" class="i">+                    Field(
</a><a href="#h12-0-131" id="h12-0-131" class="i">+                        None,
</a><a href="#h12-0-132" id="h12-0-132" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-133" id="h12-0-133" class="i">+                    ),
</a><a href="#h12-0-134" id="h12-0-134" class="i">+                    Field(
</a><a href="#h12-0-135" id="h12-0-135" class="i">+                        None,
</a><a href="#h12-0-136" id="h12-0-136" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-137" id="h12-0-137" class="i">+                    ),
</a><a href="#h12-0-138" id="h12-0-138" class="i">+                ],
</a><a href="#h12-0-139" id="h12-0-139" class="i">+            },
</a><a href="#h12-0-140" id="h12-0-140" class="i">+            aggregates: [
</a><a href="#h12-0-141" id="h12-0-141" class="i">+                Min,
</a><a href="#h12-0-142" id="h12-0-142" class="i">+                Max,
</a><a href="#h12-0-143" id="h12-0-143" class="i">+                Sum,
</a><a href="#h12-0-144" id="h12-0-144" class="i">+                Count,
</a><a href="#h12-0-145" id="h12-0-145" class="i">+                Average,
</a><a href="#h12-0-146" id="h12-0-146" class="i">+            ],
</a><a href="#h12-0-147" id="h12-0-147" class="i">+        },
</a><a href="#h12-0-148" id="h12-0-148" class="i">+        labels: [
</a><a href="#h12-0-149" id="h12-0-149" class="i">+            None,
</a><a href="#h12-0-150" id="h12-0-150" class="i">+            None,
</a><a href="#h12-0-151" id="h12-0-151" class="i">+            None,
</a><a href="#h12-0-152" id="h12-0-152" class="i">+            None,
</a><a href="#h12-0-153" id="h12-0-153" class="i">+            None,
</a><a href="#h12-0-154" id="h12-0-154" class="i">+        ],
</a><a href="#h12-0-155" id="h12-0-155" class="i">+        expressions: [
</a><a href="#h12-0-156" id="h12-0-156" class="i">+            Column(
</a><a href="#h12-0-157" id="h12-0-157" class="i">+                0,
</a><a href="#h12-0-158" id="h12-0-158" class="i">+            ),
</a><a href="#h12-0-159" id="h12-0-159" class="i">+            Column(
</a><a href="#h12-0-160" id="h12-0-160" class="i">+                1,
</a><a href="#h12-0-161" id="h12-0-161" class="i">+            ),
</a><a href="#h12-0-162" id="h12-0-162" class="i">+            Column(
</a><a href="#h12-0-163" id="h12-0-163" class="i">+                2,
</a><a href="#h12-0-164" id="h12-0-164" class="i">+            ),
</a><a href="#h12-0-165" id="h12-0-165" class="i">+            Column(
</a><a href="#h12-0-166" id="h12-0-166" class="i">+                3,
</a><a href="#h12-0-167" id="h12-0-167" class="i">+            ),
</a><a href="#h12-0-168" id="h12-0-168" class="i">+            Column(
</a><a href="#h12-0-169" id="h12-0-169" class="i">+                4,
</a><a href="#h12-0-170" id="h12-0-170" class="i">+            ),
</a><a href="#h12-0-171" id="h12-0-171" class="i">+        ],
</a><a href="#h12-0-172" id="h12-0-172" class="i">+    },
</a><a href="#h12-0-173" id="h12-0-173" class="i">+}
</a><a href="#h12-0-174" id="h12-0-174" class="i">+
</a><a href="#h12-0-175" id="h12-0-175" class="i">+Optimized plan: Plan {
</a><a href="#h12-0-176" id="h12-0-176" class="i">+    root: Projection {
</a><a href="#h12-0-177" id="h12-0-177" class="i">+        source: Aggregation {
</a><a href="#h12-0-178" id="h12-0-178" class="i">+            source: Projection {
</a><a href="#h12-0-179" id="h12-0-179" class="i">+                source: Filter {
</a><a href="#h12-0-180" id="h12-0-180" class="i">+                    source: Scan {
</a><a href="#h12-0-181" id="h12-0-181" class="i">+                        table: &quot;booleans&quot;,
</a><a href="#h12-0-182" id="h12-0-182" class="i">+                        alias: None,
</a><a href="#h12-0-183" id="h12-0-183" class="i">+                    },
</a><a href="#h12-0-184" id="h12-0-184" class="i">+                    predicate: Not(
</a><a href="#h12-0-185" id="h12-0-185" class="i">+                        IsNull(
</a><a href="#h12-0-186" id="h12-0-186" class="i">+                            Field(
</a><a href="#h12-0-187" id="h12-0-187" class="i">+                                None,
</a><a href="#h12-0-188" id="h12-0-188" class="i">+                                &quot;b&quot;,
</a><a href="#h12-0-189" id="h12-0-189" class="i">+                            ),
</a><a href="#h12-0-190" id="h12-0-190" class="i">+                        ),
</a><a href="#h12-0-191" id="h12-0-191" class="i">+                    ),
</a><a href="#h12-0-192" id="h12-0-192" class="i">+                },
</a><a href="#h12-0-193" id="h12-0-193" class="i">+                labels: [
</a><a href="#h12-0-194" id="h12-0-194" class="i">+                    None,
</a><a href="#h12-0-195" id="h12-0-195" class="i">+                    None,
</a><a href="#h12-0-196" id="h12-0-196" class="i">+                    None,
</a><a href="#h12-0-197" id="h12-0-197" class="i">+                    None,
</a><a href="#h12-0-198" id="h12-0-198" class="i">+                    None,
</a><a href="#h12-0-199" id="h12-0-199" class="i">+                ],
</a><a href="#h12-0-200" id="h12-0-200" class="i">+                expressions: [
</a><a href="#h12-0-201" id="h12-0-201" class="i">+                    Field(
</a><a href="#h12-0-202" id="h12-0-202" class="i">+                        None,
</a><a href="#h12-0-203" id="h12-0-203" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-204" id="h12-0-204" class="i">+                    ),
</a><a href="#h12-0-205" id="h12-0-205" class="i">+                    Field(
</a><a href="#h12-0-206" id="h12-0-206" class="i">+                        None,
</a><a href="#h12-0-207" id="h12-0-207" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-208" id="h12-0-208" class="i">+                    ),
</a><a href="#h12-0-209" id="h12-0-209" class="i">+                    Field(
</a><a href="#h12-0-210" id="h12-0-210" class="i">+                        None,
</a><a href="#h12-0-211" id="h12-0-211" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-212" id="h12-0-212" class="i">+                    ),
</a><a href="#h12-0-213" id="h12-0-213" class="i">+                    Field(
</a><a href="#h12-0-214" id="h12-0-214" class="i">+                        None,
</a><a href="#h12-0-215" id="h12-0-215" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-216" id="h12-0-216" class="i">+                    ),
</a><a href="#h12-0-217" id="h12-0-217" class="i">+                    Field(
</a><a href="#h12-0-218" id="h12-0-218" class="i">+                        None,
</a><a href="#h12-0-219" id="h12-0-219" class="i">+                        &quot;b&quot;,
</a><a href="#h12-0-220" id="h12-0-220" class="i">+                    ),
</a><a href="#h12-0-221" id="h12-0-221" class="i">+                ],
</a><a href="#h12-0-222" id="h12-0-222" class="i">+            },
</a><a href="#h12-0-223" id="h12-0-223" class="i">+            aggregates: [
</a><a href="#h12-0-224" id="h12-0-224" class="i">+                Min,
</a><a href="#h12-0-225" id="h12-0-225" class="i">+                Max,
</a><a href="#h12-0-226" id="h12-0-226" class="i">+                Sum,
</a><a href="#h12-0-227" id="h12-0-227" class="i">+                Count,
</a><a href="#h12-0-228" id="h12-0-228" class="i">+                Average,
</a><a href="#h12-0-229" id="h12-0-229" class="i">+            ],
</a><a href="#h12-0-230" id="h12-0-230" class="i">+        },
</a><a href="#h12-0-231" id="h12-0-231" class="i">+        labels: [
</a><a href="#h12-0-232" id="h12-0-232" class="i">+            None,
</a><a href="#h12-0-233" id="h12-0-233" class="i">+            None,
</a><a href="#h12-0-234" id="h12-0-234" class="i">+            None,
</a><a href="#h12-0-235" id="h12-0-235" class="i">+            None,
</a><a href="#h12-0-236" id="h12-0-236" class="i">+            None,
</a><a href="#h12-0-237" id="h12-0-237" class="i">+        ],
</a><a href="#h12-0-238" id="h12-0-238" class="i">+        expressions: [
</a><a href="#h12-0-239" id="h12-0-239" class="i">+            Column(
</a><a href="#h12-0-240" id="h12-0-240" class="i">+                0,
</a><a href="#h12-0-241" id="h12-0-241" class="i">+            ),
</a><a href="#h12-0-242" id="h12-0-242" class="i">+            Column(
</a><a href="#h12-0-243" id="h12-0-243" class="i">+                1,
</a><a href="#h12-0-244" id="h12-0-244" class="i">+            ),
</a><a href="#h12-0-245" id="h12-0-245" class="i">+            Column(
</a><a href="#h12-0-246" id="h12-0-246" class="i">+                2,
</a><a href="#h12-0-247" id="h12-0-247" class="i">+            ),
</a><a href="#h12-0-248" id="h12-0-248" class="i">+            Column(
</a><a href="#h12-0-249" id="h12-0-249" class="i">+                3,
</a><a href="#h12-0-250" id="h12-0-250" class="i">+            ),
</a><a href="#h12-0-251" id="h12-0-251" class="i">+            Column(
</a><a href="#h12-0-252" id="h12-0-252" class="i">+                4,
</a><a href="#h12-0-253" id="h12-0-253" class="i">+            ),
</a><a href="#h12-0-254" id="h12-0-254" class="i">+        ],
</a><a href="#h12-0-255" id="h12-0-255" class="i">+    },
</a><a href="#h12-0-256" id="h12-0-256" class="i">+}
</a><a href="#h12-0-257" id="h12-0-257" class="i">+
</a><a href="#h12-0-258" id="h12-0-258" class="i">+Query: SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans WHERE b IS NOT NULL
</a><a href="#h12-0-259" id="h12-0-259" class="i">+
</a><a href="#h12-0-260" id="h12-0-260" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h12-0-261" id="h12-0-261" class="i">+[Boolean(false), Boolean(true), Null, Integer(2), Null]
</a><b>diff --git a/<a id="h13" href="../file/src/sql/tests/query/agg_boolean_null.html">src/sql/tests/query/agg_boolean_null</a> b/<a href="../file/src/sql/tests/query/agg_boolean_null.html">src/sql/tests/query/agg_boolean_null</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -0,0 +1,227 @@
</a><a href="#h13-0-0" id="h13-0-0" class="i">+Query: SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans
</a><a href="#h13-0-1" id="h13-0-1" class="i">+
</a><a href="#h13-0-2" id="h13-0-2" class="i">+AST: Select {
</a><a href="#h13-0-3" id="h13-0-3" class="i">+    select: SelectClause {
</a><a href="#h13-0-4" id="h13-0-4" class="i">+        expressions: [
</a><a href="#h13-0-5" id="h13-0-5" class="i">+            Function(
</a><a href="#h13-0-6" id="h13-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h13-0-7" id="h13-0-7" class="i">+                [
</a><a href="#h13-0-8" id="h13-0-8" class="i">+                    Field(
</a><a href="#h13-0-9" id="h13-0-9" class="i">+                        None,
</a><a href="#h13-0-10" id="h13-0-10" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-11" id="h13-0-11" class="i">+                    ),
</a><a href="#h13-0-12" id="h13-0-12" class="i">+                ],
</a><a href="#h13-0-13" id="h13-0-13" class="i">+            ),
</a><a href="#h13-0-14" id="h13-0-14" class="i">+            Function(
</a><a href="#h13-0-15" id="h13-0-15" class="i">+                &quot;max&quot;,
</a><a href="#h13-0-16" id="h13-0-16" class="i">+                [
</a><a href="#h13-0-17" id="h13-0-17" class="i">+                    Field(
</a><a href="#h13-0-18" id="h13-0-18" class="i">+                        None,
</a><a href="#h13-0-19" id="h13-0-19" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-20" id="h13-0-20" class="i">+                    ),
</a><a href="#h13-0-21" id="h13-0-21" class="i">+                ],
</a><a href="#h13-0-22" id="h13-0-22" class="i">+            ),
</a><a href="#h13-0-23" id="h13-0-23" class="i">+            Function(
</a><a href="#h13-0-24" id="h13-0-24" class="i">+                &quot;sum&quot;,
</a><a href="#h13-0-25" id="h13-0-25" class="i">+                [
</a><a href="#h13-0-26" id="h13-0-26" class="i">+                    Field(
</a><a href="#h13-0-27" id="h13-0-27" class="i">+                        None,
</a><a href="#h13-0-28" id="h13-0-28" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-29" id="h13-0-29" class="i">+                    ),
</a><a href="#h13-0-30" id="h13-0-30" class="i">+                ],
</a><a href="#h13-0-31" id="h13-0-31" class="i">+            ),
</a><a href="#h13-0-32" id="h13-0-32" class="i">+            Function(
</a><a href="#h13-0-33" id="h13-0-33" class="i">+                &quot;count&quot;,
</a><a href="#h13-0-34" id="h13-0-34" class="i">+                [
</a><a href="#h13-0-35" id="h13-0-35" class="i">+                    Field(
</a><a href="#h13-0-36" id="h13-0-36" class="i">+                        None,
</a><a href="#h13-0-37" id="h13-0-37" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-38" id="h13-0-38" class="i">+                    ),
</a><a href="#h13-0-39" id="h13-0-39" class="i">+                ],
</a><a href="#h13-0-40" id="h13-0-40" class="i">+            ),
</a><a href="#h13-0-41" id="h13-0-41" class="i">+            Function(
</a><a href="#h13-0-42" id="h13-0-42" class="i">+                &quot;avg&quot;,
</a><a href="#h13-0-43" id="h13-0-43" class="i">+                [
</a><a href="#h13-0-44" id="h13-0-44" class="i">+                    Field(
</a><a href="#h13-0-45" id="h13-0-45" class="i">+                        None,
</a><a href="#h13-0-46" id="h13-0-46" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-47" id="h13-0-47" class="i">+                    ),
</a><a href="#h13-0-48" id="h13-0-48" class="i">+                ],
</a><a href="#h13-0-49" id="h13-0-49" class="i">+            ),
</a><a href="#h13-0-50" id="h13-0-50" class="i">+        ],
</a><a href="#h13-0-51" id="h13-0-51" class="i">+        labels: [
</a><a href="#h13-0-52" id="h13-0-52" class="i">+            None,
</a><a href="#h13-0-53" id="h13-0-53" class="i">+            None,
</a><a href="#h13-0-54" id="h13-0-54" class="i">+            None,
</a><a href="#h13-0-55" id="h13-0-55" class="i">+            None,
</a><a href="#h13-0-56" id="h13-0-56" class="i">+            None,
</a><a href="#h13-0-57" id="h13-0-57" class="i">+        ],
</a><a href="#h13-0-58" id="h13-0-58" class="i">+    },
</a><a href="#h13-0-59" id="h13-0-59" class="i">+    from: Some(
</a><a href="#h13-0-60" id="h13-0-60" class="i">+        FromClause {
</a><a href="#h13-0-61" id="h13-0-61" class="i">+            items: [
</a><a href="#h13-0-62" id="h13-0-62" class="i">+                Table {
</a><a href="#h13-0-63" id="h13-0-63" class="i">+                    name: &quot;booleans&quot;,
</a><a href="#h13-0-64" id="h13-0-64" class="i">+                    alias: None,
</a><a href="#h13-0-65" id="h13-0-65" class="i">+                },
</a><a href="#h13-0-66" id="h13-0-66" class="i">+            ],
</a><a href="#h13-0-67" id="h13-0-67" class="i">+        },
</a><a href="#h13-0-68" id="h13-0-68" class="i">+    ),
</a><a href="#h13-0-69" id="h13-0-69" class="i">+    where: None,
</a><a href="#h13-0-70" id="h13-0-70" class="i">+    group_by: None,
</a><a href="#h13-0-71" id="h13-0-71" class="i">+    having: None,
</a><a href="#h13-0-72" id="h13-0-72" class="i">+    order: [],
</a><a href="#h13-0-73" id="h13-0-73" class="i">+    limit: None,
</a><a href="#h13-0-74" id="h13-0-74" class="i">+    offset: None,
</a><a href="#h13-0-75" id="h13-0-75" class="i">+}
</a><a href="#h13-0-76" id="h13-0-76" class="i">+
</a><a href="#h13-0-77" id="h13-0-77" class="i">+Plan: Plan {
</a><a href="#h13-0-78" id="h13-0-78" class="i">+    root: Projection {
</a><a href="#h13-0-79" id="h13-0-79" class="i">+        source: Aggregation {
</a><a href="#h13-0-80" id="h13-0-80" class="i">+            source: Projection {
</a><a href="#h13-0-81" id="h13-0-81" class="i">+                source: Scan {
</a><a href="#h13-0-82" id="h13-0-82" class="i">+                    table: &quot;booleans&quot;,
</a><a href="#h13-0-83" id="h13-0-83" class="i">+                    alias: None,
</a><a href="#h13-0-84" id="h13-0-84" class="i">+                },
</a><a href="#h13-0-85" id="h13-0-85" class="i">+                labels: [
</a><a href="#h13-0-86" id="h13-0-86" class="i">+                    None,
</a><a href="#h13-0-87" id="h13-0-87" class="i">+                    None,
</a><a href="#h13-0-88" id="h13-0-88" class="i">+                    None,
</a><a href="#h13-0-89" id="h13-0-89" class="i">+                    None,
</a><a href="#h13-0-90" id="h13-0-90" class="i">+                    None,
</a><a href="#h13-0-91" id="h13-0-91" class="i">+                ],
</a><a href="#h13-0-92" id="h13-0-92" class="i">+                expressions: [
</a><a href="#h13-0-93" id="h13-0-93" class="i">+                    Field(
</a><a href="#h13-0-94" id="h13-0-94" class="i">+                        None,
</a><a href="#h13-0-95" id="h13-0-95" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-96" id="h13-0-96" class="i">+                    ),
</a><a href="#h13-0-97" id="h13-0-97" class="i">+                    Field(
</a><a href="#h13-0-98" id="h13-0-98" class="i">+                        None,
</a><a href="#h13-0-99" id="h13-0-99" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-100" id="h13-0-100" class="i">+                    ),
</a><a href="#h13-0-101" id="h13-0-101" class="i">+                    Field(
</a><a href="#h13-0-102" id="h13-0-102" class="i">+                        None,
</a><a href="#h13-0-103" id="h13-0-103" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-104" id="h13-0-104" class="i">+                    ),
</a><a href="#h13-0-105" id="h13-0-105" class="i">+                    Field(
</a><a href="#h13-0-106" id="h13-0-106" class="i">+                        None,
</a><a href="#h13-0-107" id="h13-0-107" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-108" id="h13-0-108" class="i">+                    ),
</a><a href="#h13-0-109" id="h13-0-109" class="i">+                    Field(
</a><a href="#h13-0-110" id="h13-0-110" class="i">+                        None,
</a><a href="#h13-0-111" id="h13-0-111" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-112" id="h13-0-112" class="i">+                    ),
</a><a href="#h13-0-113" id="h13-0-113" class="i">+                ],
</a><a href="#h13-0-114" id="h13-0-114" class="i">+            },
</a><a href="#h13-0-115" id="h13-0-115" class="i">+            aggregates: [
</a><a href="#h13-0-116" id="h13-0-116" class="i">+                Min,
</a><a href="#h13-0-117" id="h13-0-117" class="i">+                Max,
</a><a href="#h13-0-118" id="h13-0-118" class="i">+                Sum,
</a><a href="#h13-0-119" id="h13-0-119" class="i">+                Count,
</a><a href="#h13-0-120" id="h13-0-120" class="i">+                Average,
</a><a href="#h13-0-121" id="h13-0-121" class="i">+            ],
</a><a href="#h13-0-122" id="h13-0-122" class="i">+        },
</a><a href="#h13-0-123" id="h13-0-123" class="i">+        labels: [
</a><a href="#h13-0-124" id="h13-0-124" class="i">+            None,
</a><a href="#h13-0-125" id="h13-0-125" class="i">+            None,
</a><a href="#h13-0-126" id="h13-0-126" class="i">+            None,
</a><a href="#h13-0-127" id="h13-0-127" class="i">+            None,
</a><a href="#h13-0-128" id="h13-0-128" class="i">+            None,
</a><a href="#h13-0-129" id="h13-0-129" class="i">+        ],
</a><a href="#h13-0-130" id="h13-0-130" class="i">+        expressions: [
</a><a href="#h13-0-131" id="h13-0-131" class="i">+            Column(
</a><a href="#h13-0-132" id="h13-0-132" class="i">+                0,
</a><a href="#h13-0-133" id="h13-0-133" class="i">+            ),
</a><a href="#h13-0-134" id="h13-0-134" class="i">+            Column(
</a><a href="#h13-0-135" id="h13-0-135" class="i">+                1,
</a><a href="#h13-0-136" id="h13-0-136" class="i">+            ),
</a><a href="#h13-0-137" id="h13-0-137" class="i">+            Column(
</a><a href="#h13-0-138" id="h13-0-138" class="i">+                2,
</a><a href="#h13-0-139" id="h13-0-139" class="i">+            ),
</a><a href="#h13-0-140" id="h13-0-140" class="i">+            Column(
</a><a href="#h13-0-141" id="h13-0-141" class="i">+                3,
</a><a href="#h13-0-142" id="h13-0-142" class="i">+            ),
</a><a href="#h13-0-143" id="h13-0-143" class="i">+            Column(
</a><a href="#h13-0-144" id="h13-0-144" class="i">+                4,
</a><a href="#h13-0-145" id="h13-0-145" class="i">+            ),
</a><a href="#h13-0-146" id="h13-0-146" class="i">+        ],
</a><a href="#h13-0-147" id="h13-0-147" class="i">+    },
</a><a href="#h13-0-148" id="h13-0-148" class="i">+}
</a><a href="#h13-0-149" id="h13-0-149" class="i">+
</a><a href="#h13-0-150" id="h13-0-150" class="i">+Optimized plan: Plan {
</a><a href="#h13-0-151" id="h13-0-151" class="i">+    root: Projection {
</a><a href="#h13-0-152" id="h13-0-152" class="i">+        source: Aggregation {
</a><a href="#h13-0-153" id="h13-0-153" class="i">+            source: Projection {
</a><a href="#h13-0-154" id="h13-0-154" class="i">+                source: Scan {
</a><a href="#h13-0-155" id="h13-0-155" class="i">+                    table: &quot;booleans&quot;,
</a><a href="#h13-0-156" id="h13-0-156" class="i">+                    alias: None,
</a><a href="#h13-0-157" id="h13-0-157" class="i">+                },
</a><a href="#h13-0-158" id="h13-0-158" class="i">+                labels: [
</a><a href="#h13-0-159" id="h13-0-159" class="i">+                    None,
</a><a href="#h13-0-160" id="h13-0-160" class="i">+                    None,
</a><a href="#h13-0-161" id="h13-0-161" class="i">+                    None,
</a><a href="#h13-0-162" id="h13-0-162" class="i">+                    None,
</a><a href="#h13-0-163" id="h13-0-163" class="i">+                    None,
</a><a href="#h13-0-164" id="h13-0-164" class="i">+                ],
</a><a href="#h13-0-165" id="h13-0-165" class="i">+                expressions: [
</a><a href="#h13-0-166" id="h13-0-166" class="i">+                    Field(
</a><a href="#h13-0-167" id="h13-0-167" class="i">+                        None,
</a><a href="#h13-0-168" id="h13-0-168" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-169" id="h13-0-169" class="i">+                    ),
</a><a href="#h13-0-170" id="h13-0-170" class="i">+                    Field(
</a><a href="#h13-0-171" id="h13-0-171" class="i">+                        None,
</a><a href="#h13-0-172" id="h13-0-172" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-173" id="h13-0-173" class="i">+                    ),
</a><a href="#h13-0-174" id="h13-0-174" class="i">+                    Field(
</a><a href="#h13-0-175" id="h13-0-175" class="i">+                        None,
</a><a href="#h13-0-176" id="h13-0-176" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-177" id="h13-0-177" class="i">+                    ),
</a><a href="#h13-0-178" id="h13-0-178" class="i">+                    Field(
</a><a href="#h13-0-179" id="h13-0-179" class="i">+                        None,
</a><a href="#h13-0-180" id="h13-0-180" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-181" id="h13-0-181" class="i">+                    ),
</a><a href="#h13-0-182" id="h13-0-182" class="i">+                    Field(
</a><a href="#h13-0-183" id="h13-0-183" class="i">+                        None,
</a><a href="#h13-0-184" id="h13-0-184" class="i">+                        &quot;b&quot;,
</a><a href="#h13-0-185" id="h13-0-185" class="i">+                    ),
</a><a href="#h13-0-186" id="h13-0-186" class="i">+                ],
</a><a href="#h13-0-187" id="h13-0-187" class="i">+            },
</a><a href="#h13-0-188" id="h13-0-188" class="i">+            aggregates: [
</a><a href="#h13-0-189" id="h13-0-189" class="i">+                Min,
</a><a href="#h13-0-190" id="h13-0-190" class="i">+                Max,
</a><a href="#h13-0-191" id="h13-0-191" class="i">+                Sum,
</a><a href="#h13-0-192" id="h13-0-192" class="i">+                Count,
</a><a href="#h13-0-193" id="h13-0-193" class="i">+                Average,
</a><a href="#h13-0-194" id="h13-0-194" class="i">+            ],
</a><a href="#h13-0-195" id="h13-0-195" class="i">+        },
</a><a href="#h13-0-196" id="h13-0-196" class="i">+        labels: [
</a><a href="#h13-0-197" id="h13-0-197" class="i">+            None,
</a><a href="#h13-0-198" id="h13-0-198" class="i">+            None,
</a><a href="#h13-0-199" id="h13-0-199" class="i">+            None,
</a><a href="#h13-0-200" id="h13-0-200" class="i">+            None,
</a><a href="#h13-0-201" id="h13-0-201" class="i">+            None,
</a><a href="#h13-0-202" id="h13-0-202" class="i">+        ],
</a><a href="#h13-0-203" id="h13-0-203" class="i">+        expressions: [
</a><a href="#h13-0-204" id="h13-0-204" class="i">+            Column(
</a><a href="#h13-0-205" id="h13-0-205" class="i">+                0,
</a><a href="#h13-0-206" id="h13-0-206" class="i">+            ),
</a><a href="#h13-0-207" id="h13-0-207" class="i">+            Column(
</a><a href="#h13-0-208" id="h13-0-208" class="i">+                1,
</a><a href="#h13-0-209" id="h13-0-209" class="i">+            ),
</a><a href="#h13-0-210" id="h13-0-210" class="i">+            Column(
</a><a href="#h13-0-211" id="h13-0-211" class="i">+                2,
</a><a href="#h13-0-212" id="h13-0-212" class="i">+            ),
</a><a href="#h13-0-213" id="h13-0-213" class="i">+            Column(
</a><a href="#h13-0-214" id="h13-0-214" class="i">+                3,
</a><a href="#h13-0-215" id="h13-0-215" class="i">+            ),
</a><a href="#h13-0-216" id="h13-0-216" class="i">+            Column(
</a><a href="#h13-0-217" id="h13-0-217" class="i">+                4,
</a><a href="#h13-0-218" id="h13-0-218" class="i">+            ),
</a><a href="#h13-0-219" id="h13-0-219" class="i">+        ],
</a><a href="#h13-0-220" id="h13-0-220" class="i">+    },
</a><a href="#h13-0-221" id="h13-0-221" class="i">+}
</a><a href="#h13-0-222" id="h13-0-222" class="i">+
</a><a href="#h13-0-223" id="h13-0-223" class="i">+Query: SELECT MIN(b), MAX(b), SUM(b), COUNT(b), AVG(b) FROM booleans
</a><a href="#h13-0-224" id="h13-0-224" class="i">+
</a><a href="#h13-0-225" id="h13-0-225" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h13-0-226" id="h13-0-226" class="i">+[Null, Null, Null, Integer(2), Null]
</a><b>diff --git a/<a id="h14" href="../file/src/sql/tests/query/agg_const.html">src/sql/tests/query/agg_const</a> b/<a href="../file/src/sql/tests/query/agg_const.html">src/sql/tests/query/agg_const</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -0,0 +1,227 @@
</a><a href="#h14-0-0" id="h14-0-0" class="i">+Query: SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3)
</a><a href="#h14-0-1" id="h14-0-1" class="i">+
</a><a href="#h14-0-2" id="h14-0-2" class="i">+AST: Select {
</a><a href="#h14-0-3" id="h14-0-3" class="i">+    select: SelectClause {
</a><a href="#h14-0-4" id="h14-0-4" class="i">+        expressions: [
</a><a href="#h14-0-5" id="h14-0-5" class="i">+            Function(
</a><a href="#h14-0-6" id="h14-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h14-0-7" id="h14-0-7" class="i">+                [
</a><a href="#h14-0-8" id="h14-0-8" class="i">+                    Literal(
</a><a href="#h14-0-9" id="h14-0-9" class="i">+                        Integer(
</a><a href="#h14-0-10" id="h14-0-10" class="i">+                            3,
</a><a href="#h14-0-11" id="h14-0-11" class="i">+                        ),
</a><a href="#h14-0-12" id="h14-0-12" class="i">+                    ),
</a><a href="#h14-0-13" id="h14-0-13" class="i">+                ],
</a><a href="#h14-0-14" id="h14-0-14" class="i">+            ),
</a><a href="#h14-0-15" id="h14-0-15" class="i">+            Function(
</a><a href="#h14-0-16" id="h14-0-16" class="i">+                &quot;max&quot;,
</a><a href="#h14-0-17" id="h14-0-17" class="i">+                [
</a><a href="#h14-0-18" id="h14-0-18" class="i">+                    Literal(
</a><a href="#h14-0-19" id="h14-0-19" class="i">+                        Integer(
</a><a href="#h14-0-20" id="h14-0-20" class="i">+                            3,
</a><a href="#h14-0-21" id="h14-0-21" class="i">+                        ),
</a><a href="#h14-0-22" id="h14-0-22" class="i">+                    ),
</a><a href="#h14-0-23" id="h14-0-23" class="i">+                ],
</a><a href="#h14-0-24" id="h14-0-24" class="i">+            ),
</a><a href="#h14-0-25" id="h14-0-25" class="i">+            Function(
</a><a href="#h14-0-26" id="h14-0-26" class="i">+                &quot;sum&quot;,
</a><a href="#h14-0-27" id="h14-0-27" class="i">+                [
</a><a href="#h14-0-28" id="h14-0-28" class="i">+                    Literal(
</a><a href="#h14-0-29" id="h14-0-29" class="i">+                        Integer(
</a><a href="#h14-0-30" id="h14-0-30" class="i">+                            3,
</a><a href="#h14-0-31" id="h14-0-31" class="i">+                        ),
</a><a href="#h14-0-32" id="h14-0-32" class="i">+                    ),
</a><a href="#h14-0-33" id="h14-0-33" class="i">+                ],
</a><a href="#h14-0-34" id="h14-0-34" class="i">+            ),
</a><a href="#h14-0-35" id="h14-0-35" class="i">+            Function(
</a><a href="#h14-0-36" id="h14-0-36" class="i">+                &quot;count&quot;,
</a><a href="#h14-0-37" id="h14-0-37" class="i">+                [
</a><a href="#h14-0-38" id="h14-0-38" class="i">+                    Literal(
</a><a href="#h14-0-39" id="h14-0-39" class="i">+                        Integer(
</a><a href="#h14-0-40" id="h14-0-40" class="i">+                            3,
</a><a href="#h14-0-41" id="h14-0-41" class="i">+                        ),
</a><a href="#h14-0-42" id="h14-0-42" class="i">+                    ),
</a><a href="#h14-0-43" id="h14-0-43" class="i">+                ],
</a><a href="#h14-0-44" id="h14-0-44" class="i">+            ),
</a><a href="#h14-0-45" id="h14-0-45" class="i">+            Function(
</a><a href="#h14-0-46" id="h14-0-46" class="i">+                &quot;avg&quot;,
</a><a href="#h14-0-47" id="h14-0-47" class="i">+                [
</a><a href="#h14-0-48" id="h14-0-48" class="i">+                    Literal(
</a><a href="#h14-0-49" id="h14-0-49" class="i">+                        Integer(
</a><a href="#h14-0-50" id="h14-0-50" class="i">+                            3,
</a><a href="#h14-0-51" id="h14-0-51" class="i">+                        ),
</a><a href="#h14-0-52" id="h14-0-52" class="i">+                    ),
</a><a href="#h14-0-53" id="h14-0-53" class="i">+                ],
</a><a href="#h14-0-54" id="h14-0-54" class="i">+            ),
</a><a href="#h14-0-55" id="h14-0-55" class="i">+        ],
</a><a href="#h14-0-56" id="h14-0-56" class="i">+        labels: [
</a><a href="#h14-0-57" id="h14-0-57" class="i">+            None,
</a><a href="#h14-0-58" id="h14-0-58" class="i">+            None,
</a><a href="#h14-0-59" id="h14-0-59" class="i">+            None,
</a><a href="#h14-0-60" id="h14-0-60" class="i">+            None,
</a><a href="#h14-0-61" id="h14-0-61" class="i">+            None,
</a><a href="#h14-0-62" id="h14-0-62" class="i">+        ],
</a><a href="#h14-0-63" id="h14-0-63" class="i">+    },
</a><a href="#h14-0-64" id="h14-0-64" class="i">+    from: None,
</a><a href="#h14-0-65" id="h14-0-65" class="i">+    where: None,
</a><a href="#h14-0-66" id="h14-0-66" class="i">+    group_by: None,
</a><a href="#h14-0-67" id="h14-0-67" class="i">+    having: None,
</a><a href="#h14-0-68" id="h14-0-68" class="i">+    order: [],
</a><a href="#h14-0-69" id="h14-0-69" class="i">+    limit: None,
</a><a href="#h14-0-70" id="h14-0-70" class="i">+    offset: None,
</a><a href="#h14-0-71" id="h14-0-71" class="i">+}
</a><a href="#h14-0-72" id="h14-0-72" class="i">+
</a><a href="#h14-0-73" id="h14-0-73" class="i">+Plan: Plan {
</a><a href="#h14-0-74" id="h14-0-74" class="i">+    root: Projection {
</a><a href="#h14-0-75" id="h14-0-75" class="i">+        source: Aggregation {
</a><a href="#h14-0-76" id="h14-0-76" class="i">+            source: Projection {
</a><a href="#h14-0-77" id="h14-0-77" class="i">+                source: Nothing,
</a><a href="#h14-0-78" id="h14-0-78" class="i">+                labels: [
</a><a href="#h14-0-79" id="h14-0-79" class="i">+                    None,
</a><a href="#h14-0-80" id="h14-0-80" class="i">+                    None,
</a><a href="#h14-0-81" id="h14-0-81" class="i">+                    None,
</a><a href="#h14-0-82" id="h14-0-82" class="i">+                    None,
</a><a href="#h14-0-83" id="h14-0-83" class="i">+                    None,
</a><a href="#h14-0-84" id="h14-0-84" class="i">+                ],
</a><a href="#h14-0-85" id="h14-0-85" class="i">+                expressions: [
</a><a href="#h14-0-86" id="h14-0-86" class="i">+                    Constant(
</a><a href="#h14-0-87" id="h14-0-87" class="i">+                        Integer(
</a><a href="#h14-0-88" id="h14-0-88" class="i">+                            3,
</a><a href="#h14-0-89" id="h14-0-89" class="i">+                        ),
</a><a href="#h14-0-90" id="h14-0-90" class="i">+                    ),
</a><a href="#h14-0-91" id="h14-0-91" class="i">+                    Constant(
</a><a href="#h14-0-92" id="h14-0-92" class="i">+                        Integer(
</a><a href="#h14-0-93" id="h14-0-93" class="i">+                            3,
</a><a href="#h14-0-94" id="h14-0-94" class="i">+                        ),
</a><a href="#h14-0-95" id="h14-0-95" class="i">+                    ),
</a><a href="#h14-0-96" id="h14-0-96" class="i">+                    Constant(
</a><a href="#h14-0-97" id="h14-0-97" class="i">+                        Integer(
</a><a href="#h14-0-98" id="h14-0-98" class="i">+                            3,
</a><a href="#h14-0-99" id="h14-0-99" class="i">+                        ),
</a><a href="#h14-0-100" id="h14-0-100" class="i">+                    ),
</a><a href="#h14-0-101" id="h14-0-101" class="i">+                    Constant(
</a><a href="#h14-0-102" id="h14-0-102" class="i">+                        Integer(
</a><a href="#h14-0-103" id="h14-0-103" class="i">+                            3,
</a><a href="#h14-0-104" id="h14-0-104" class="i">+                        ),
</a><a href="#h14-0-105" id="h14-0-105" class="i">+                    ),
</a><a href="#h14-0-106" id="h14-0-106" class="i">+                    Constant(
</a><a href="#h14-0-107" id="h14-0-107" class="i">+                        Integer(
</a><a href="#h14-0-108" id="h14-0-108" class="i">+                            3,
</a><a href="#h14-0-109" id="h14-0-109" class="i">+                        ),
</a><a href="#h14-0-110" id="h14-0-110" class="i">+                    ),
</a><a href="#h14-0-111" id="h14-0-111" class="i">+                ],
</a><a href="#h14-0-112" id="h14-0-112" class="i">+            },
</a><a href="#h14-0-113" id="h14-0-113" class="i">+            aggregates: [
</a><a href="#h14-0-114" id="h14-0-114" class="i">+                Min,
</a><a href="#h14-0-115" id="h14-0-115" class="i">+                Max,
</a><a href="#h14-0-116" id="h14-0-116" class="i">+                Sum,
</a><a href="#h14-0-117" id="h14-0-117" class="i">+                Count,
</a><a href="#h14-0-118" id="h14-0-118" class="i">+                Average,
</a><a href="#h14-0-119" id="h14-0-119" class="i">+            ],
</a><a href="#h14-0-120" id="h14-0-120" class="i">+        },
</a><a href="#h14-0-121" id="h14-0-121" class="i">+        labels: [
</a><a href="#h14-0-122" id="h14-0-122" class="i">+            None,
</a><a href="#h14-0-123" id="h14-0-123" class="i">+            None,
</a><a href="#h14-0-124" id="h14-0-124" class="i">+            None,
</a><a href="#h14-0-125" id="h14-0-125" class="i">+            None,
</a><a href="#h14-0-126" id="h14-0-126" class="i">+            None,
</a><a href="#h14-0-127" id="h14-0-127" class="i">+        ],
</a><a href="#h14-0-128" id="h14-0-128" class="i">+        expressions: [
</a><a href="#h14-0-129" id="h14-0-129" class="i">+            Column(
</a><a href="#h14-0-130" id="h14-0-130" class="i">+                0,
</a><a href="#h14-0-131" id="h14-0-131" class="i">+            ),
</a><a href="#h14-0-132" id="h14-0-132" class="i">+            Column(
</a><a href="#h14-0-133" id="h14-0-133" class="i">+                1,
</a><a href="#h14-0-134" id="h14-0-134" class="i">+            ),
</a><a href="#h14-0-135" id="h14-0-135" class="i">+            Column(
</a><a href="#h14-0-136" id="h14-0-136" class="i">+                2,
</a><a href="#h14-0-137" id="h14-0-137" class="i">+            ),
</a><a href="#h14-0-138" id="h14-0-138" class="i">+            Column(
</a><a href="#h14-0-139" id="h14-0-139" class="i">+                3,
</a><a href="#h14-0-140" id="h14-0-140" class="i">+            ),
</a><a href="#h14-0-141" id="h14-0-141" class="i">+            Column(
</a><a href="#h14-0-142" id="h14-0-142" class="i">+                4,
</a><a href="#h14-0-143" id="h14-0-143" class="i">+            ),
</a><a href="#h14-0-144" id="h14-0-144" class="i">+        ],
</a><a href="#h14-0-145" id="h14-0-145" class="i">+    },
</a><a href="#h14-0-146" id="h14-0-146" class="i">+}
</a><a href="#h14-0-147" id="h14-0-147" class="i">+
</a><a href="#h14-0-148" id="h14-0-148" class="i">+Optimized plan: Plan {
</a><a href="#h14-0-149" id="h14-0-149" class="i">+    root: Projection {
</a><a href="#h14-0-150" id="h14-0-150" class="i">+        source: Aggregation {
</a><a href="#h14-0-151" id="h14-0-151" class="i">+            source: Projection {
</a><a href="#h14-0-152" id="h14-0-152" class="i">+                source: Nothing,
</a><a href="#h14-0-153" id="h14-0-153" class="i">+                labels: [
</a><a href="#h14-0-154" id="h14-0-154" class="i">+                    None,
</a><a href="#h14-0-155" id="h14-0-155" class="i">+                    None,
</a><a href="#h14-0-156" id="h14-0-156" class="i">+                    None,
</a><a href="#h14-0-157" id="h14-0-157" class="i">+                    None,
</a><a href="#h14-0-158" id="h14-0-158" class="i">+                    None,
</a><a href="#h14-0-159" id="h14-0-159" class="i">+                ],
</a><a href="#h14-0-160" id="h14-0-160" class="i">+                expressions: [
</a><a href="#h14-0-161" id="h14-0-161" class="i">+                    Constant(
</a><a href="#h14-0-162" id="h14-0-162" class="i">+                        Integer(
</a><a href="#h14-0-163" id="h14-0-163" class="i">+                            3,
</a><a href="#h14-0-164" id="h14-0-164" class="i">+                        ),
</a><a href="#h14-0-165" id="h14-0-165" class="i">+                    ),
</a><a href="#h14-0-166" id="h14-0-166" class="i">+                    Constant(
</a><a href="#h14-0-167" id="h14-0-167" class="i">+                        Integer(
</a><a href="#h14-0-168" id="h14-0-168" class="i">+                            3,
</a><a href="#h14-0-169" id="h14-0-169" class="i">+                        ),
</a><a href="#h14-0-170" id="h14-0-170" class="i">+                    ),
</a><a href="#h14-0-171" id="h14-0-171" class="i">+                    Constant(
</a><a href="#h14-0-172" id="h14-0-172" class="i">+                        Integer(
</a><a href="#h14-0-173" id="h14-0-173" class="i">+                            3,
</a><a href="#h14-0-174" id="h14-0-174" class="i">+                        ),
</a><a href="#h14-0-175" id="h14-0-175" class="i">+                    ),
</a><a href="#h14-0-176" id="h14-0-176" class="i">+                    Constant(
</a><a href="#h14-0-177" id="h14-0-177" class="i">+                        Integer(
</a><a href="#h14-0-178" id="h14-0-178" class="i">+                            3,
</a><a href="#h14-0-179" id="h14-0-179" class="i">+                        ),
</a><a href="#h14-0-180" id="h14-0-180" class="i">+                    ),
</a><a href="#h14-0-181" id="h14-0-181" class="i">+                    Constant(
</a><a href="#h14-0-182" id="h14-0-182" class="i">+                        Integer(
</a><a href="#h14-0-183" id="h14-0-183" class="i">+                            3,
</a><a href="#h14-0-184" id="h14-0-184" class="i">+                        ),
</a><a href="#h14-0-185" id="h14-0-185" class="i">+                    ),
</a><a href="#h14-0-186" id="h14-0-186" class="i">+                ],
</a><a href="#h14-0-187" id="h14-0-187" class="i">+            },
</a><a href="#h14-0-188" id="h14-0-188" class="i">+            aggregates: [
</a><a href="#h14-0-189" id="h14-0-189" class="i">+                Min,
</a><a href="#h14-0-190" id="h14-0-190" class="i">+                Max,
</a><a href="#h14-0-191" id="h14-0-191" class="i">+                Sum,
</a><a href="#h14-0-192" id="h14-0-192" class="i">+                Count,
</a><a href="#h14-0-193" id="h14-0-193" class="i">+                Average,
</a><a href="#h14-0-194" id="h14-0-194" class="i">+            ],
</a><a href="#h14-0-195" id="h14-0-195" class="i">+        },
</a><a href="#h14-0-196" id="h14-0-196" class="i">+        labels: [
</a><a href="#h14-0-197" id="h14-0-197" class="i">+            None,
</a><a href="#h14-0-198" id="h14-0-198" class="i">+            None,
</a><a href="#h14-0-199" id="h14-0-199" class="i">+            None,
</a><a href="#h14-0-200" id="h14-0-200" class="i">+            None,
</a><a href="#h14-0-201" id="h14-0-201" class="i">+            None,
</a><a href="#h14-0-202" id="h14-0-202" class="i">+        ],
</a><a href="#h14-0-203" id="h14-0-203" class="i">+        expressions: [
</a><a href="#h14-0-204" id="h14-0-204" class="i">+            Column(
</a><a href="#h14-0-205" id="h14-0-205" class="i">+                0,
</a><a href="#h14-0-206" id="h14-0-206" class="i">+            ),
</a><a href="#h14-0-207" id="h14-0-207" class="i">+            Column(
</a><a href="#h14-0-208" id="h14-0-208" class="i">+                1,
</a><a href="#h14-0-209" id="h14-0-209" class="i">+            ),
</a><a href="#h14-0-210" id="h14-0-210" class="i">+            Column(
</a><a href="#h14-0-211" id="h14-0-211" class="i">+                2,
</a><a href="#h14-0-212" id="h14-0-212" class="i">+            ),
</a><a href="#h14-0-213" id="h14-0-213" class="i">+            Column(
</a><a href="#h14-0-214" id="h14-0-214" class="i">+                3,
</a><a href="#h14-0-215" id="h14-0-215" class="i">+            ),
</a><a href="#h14-0-216" id="h14-0-216" class="i">+            Column(
</a><a href="#h14-0-217" id="h14-0-217" class="i">+                4,
</a><a href="#h14-0-218" id="h14-0-218" class="i">+            ),
</a><a href="#h14-0-219" id="h14-0-219" class="i">+        ],
</a><a href="#h14-0-220" id="h14-0-220" class="i">+    },
</a><a href="#h14-0-221" id="h14-0-221" class="i">+}
</a><a href="#h14-0-222" id="h14-0-222" class="i">+
</a><a href="#h14-0-223" id="h14-0-223" class="i">+Query: SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3)
</a><a href="#h14-0-224" id="h14-0-224" class="i">+
</a><a href="#h14-0-225" id="h14-0-225" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h14-0-226" id="h14-0-226" class="i">+[Integer(3), Integer(3), Integer(3), Integer(1), Integer(3)]
</a><b>diff --git a/<a id="h15" href="../file/src/sql/tests/query/agg_const_from.html">src/sql/tests/query/agg_const_from</a> b/<a href="../file/src/sql/tests/query/agg_const_from.html">src/sql/tests/query/agg_const_from</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -0,0 +1,242 @@
</a><a href="#h15-0-0" id="h15-0-0" class="i">+Query: SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3) FROM genres
</a><a href="#h15-0-1" id="h15-0-1" class="i">+
</a><a href="#h15-0-2" id="h15-0-2" class="i">+AST: Select {
</a><a href="#h15-0-3" id="h15-0-3" class="i">+    select: SelectClause {
</a><a href="#h15-0-4" id="h15-0-4" class="i">+        expressions: [
</a><a href="#h15-0-5" id="h15-0-5" class="i">+            Function(
</a><a href="#h15-0-6" id="h15-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h15-0-7" id="h15-0-7" class="i">+                [
</a><a href="#h15-0-8" id="h15-0-8" class="i">+                    Literal(
</a><a href="#h15-0-9" id="h15-0-9" class="i">+                        Integer(
</a><a href="#h15-0-10" id="h15-0-10" class="i">+                            3,
</a><a href="#h15-0-11" id="h15-0-11" class="i">+                        ),
</a><a href="#h15-0-12" id="h15-0-12" class="i">+                    ),
</a><a href="#h15-0-13" id="h15-0-13" class="i">+                ],
</a><a href="#h15-0-14" id="h15-0-14" class="i">+            ),
</a><a href="#h15-0-15" id="h15-0-15" class="i">+            Function(
</a><a href="#h15-0-16" id="h15-0-16" class="i">+                &quot;max&quot;,
</a><a href="#h15-0-17" id="h15-0-17" class="i">+                [
</a><a href="#h15-0-18" id="h15-0-18" class="i">+                    Literal(
</a><a href="#h15-0-19" id="h15-0-19" class="i">+                        Integer(
</a><a href="#h15-0-20" id="h15-0-20" class="i">+                            3,
</a><a href="#h15-0-21" id="h15-0-21" class="i">+                        ),
</a><a href="#h15-0-22" id="h15-0-22" class="i">+                    ),
</a><a href="#h15-0-23" id="h15-0-23" class="i">+                ],
</a><a href="#h15-0-24" id="h15-0-24" class="i">+            ),
</a><a href="#h15-0-25" id="h15-0-25" class="i">+            Function(
</a><a href="#h15-0-26" id="h15-0-26" class="i">+                &quot;sum&quot;,
</a><a href="#h15-0-27" id="h15-0-27" class="i">+                [
</a><a href="#h15-0-28" id="h15-0-28" class="i">+                    Literal(
</a><a href="#h15-0-29" id="h15-0-29" class="i">+                        Integer(
</a><a href="#h15-0-30" id="h15-0-30" class="i">+                            3,
</a><a href="#h15-0-31" id="h15-0-31" class="i">+                        ),
</a><a href="#h15-0-32" id="h15-0-32" class="i">+                    ),
</a><a href="#h15-0-33" id="h15-0-33" class="i">+                ],
</a><a href="#h15-0-34" id="h15-0-34" class="i">+            ),
</a><a href="#h15-0-35" id="h15-0-35" class="i">+            Function(
</a><a href="#h15-0-36" id="h15-0-36" class="i">+                &quot;count&quot;,
</a><a href="#h15-0-37" id="h15-0-37" class="i">+                [
</a><a href="#h15-0-38" id="h15-0-38" class="i">+                    Literal(
</a><a href="#h15-0-39" id="h15-0-39" class="i">+                        Integer(
</a><a href="#h15-0-40" id="h15-0-40" class="i">+                            3,
</a><a href="#h15-0-41" id="h15-0-41" class="i">+                        ),
</a><a href="#h15-0-42" id="h15-0-42" class="i">+                    ),
</a><a href="#h15-0-43" id="h15-0-43" class="i">+                ],
</a><a href="#h15-0-44" id="h15-0-44" class="i">+            ),
</a><a href="#h15-0-45" id="h15-0-45" class="i">+            Function(
</a><a href="#h15-0-46" id="h15-0-46" class="i">+                &quot;avg&quot;,
</a><a href="#h15-0-47" id="h15-0-47" class="i">+                [
</a><a href="#h15-0-48" id="h15-0-48" class="i">+                    Literal(
</a><a href="#h15-0-49" id="h15-0-49" class="i">+                        Integer(
</a><a href="#h15-0-50" id="h15-0-50" class="i">+                            3,
</a><a href="#h15-0-51" id="h15-0-51" class="i">+                        ),
</a><a href="#h15-0-52" id="h15-0-52" class="i">+                    ),
</a><a href="#h15-0-53" id="h15-0-53" class="i">+                ],
</a><a href="#h15-0-54" id="h15-0-54" class="i">+            ),
</a><a href="#h15-0-55" id="h15-0-55" class="i">+        ],
</a><a href="#h15-0-56" id="h15-0-56" class="i">+        labels: [
</a><a href="#h15-0-57" id="h15-0-57" class="i">+            None,
</a><a href="#h15-0-58" id="h15-0-58" class="i">+            None,
</a><a href="#h15-0-59" id="h15-0-59" class="i">+            None,
</a><a href="#h15-0-60" id="h15-0-60" class="i">+            None,
</a><a href="#h15-0-61" id="h15-0-61" class="i">+            None,
</a><a href="#h15-0-62" id="h15-0-62" class="i">+        ],
</a><a href="#h15-0-63" id="h15-0-63" class="i">+    },
</a><a href="#h15-0-64" id="h15-0-64" class="i">+    from: Some(
</a><a href="#h15-0-65" id="h15-0-65" class="i">+        FromClause {
</a><a href="#h15-0-66" id="h15-0-66" class="i">+            items: [
</a><a href="#h15-0-67" id="h15-0-67" class="i">+                Table {
</a><a href="#h15-0-68" id="h15-0-68" class="i">+                    name: &quot;genres&quot;,
</a><a href="#h15-0-69" id="h15-0-69" class="i">+                    alias: None,
</a><a href="#h15-0-70" id="h15-0-70" class="i">+                },
</a><a href="#h15-0-71" id="h15-0-71" class="i">+            ],
</a><a href="#h15-0-72" id="h15-0-72" class="i">+        },
</a><a href="#h15-0-73" id="h15-0-73" class="i">+    ),
</a><a href="#h15-0-74" id="h15-0-74" class="i">+    where: None,
</a><a href="#h15-0-75" id="h15-0-75" class="i">+    group_by: None,
</a><a href="#h15-0-76" id="h15-0-76" class="i">+    having: None,
</a><a href="#h15-0-77" id="h15-0-77" class="i">+    order: [],
</a><a href="#h15-0-78" id="h15-0-78" class="i">+    limit: None,
</a><a href="#h15-0-79" id="h15-0-79" class="i">+    offset: None,
</a><a href="#h15-0-80" id="h15-0-80" class="i">+}
</a><a href="#h15-0-81" id="h15-0-81" class="i">+
</a><a href="#h15-0-82" id="h15-0-82" class="i">+Plan: Plan {
</a><a href="#h15-0-83" id="h15-0-83" class="i">+    root: Projection {
</a><a href="#h15-0-84" id="h15-0-84" class="i">+        source: Aggregation {
</a><a href="#h15-0-85" id="h15-0-85" class="i">+            source: Projection {
</a><a href="#h15-0-86" id="h15-0-86" class="i">+                source: Scan {
</a><a href="#h15-0-87" id="h15-0-87" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h15-0-88" id="h15-0-88" class="i">+                    alias: None,
</a><a href="#h15-0-89" id="h15-0-89" class="i">+                },
</a><a href="#h15-0-90" id="h15-0-90" class="i">+                labels: [
</a><a href="#h15-0-91" id="h15-0-91" class="i">+                    None,
</a><a href="#h15-0-92" id="h15-0-92" class="i">+                    None,
</a><a href="#h15-0-93" id="h15-0-93" class="i">+                    None,
</a><a href="#h15-0-94" id="h15-0-94" class="i">+                    None,
</a><a href="#h15-0-95" id="h15-0-95" class="i">+                    None,
</a><a href="#h15-0-96" id="h15-0-96" class="i">+                ],
</a><a href="#h15-0-97" id="h15-0-97" class="i">+                expressions: [
</a><a href="#h15-0-98" id="h15-0-98" class="i">+                    Constant(
</a><a href="#h15-0-99" id="h15-0-99" class="i">+                        Integer(
</a><a href="#h15-0-100" id="h15-0-100" class="i">+                            3,
</a><a href="#h15-0-101" id="h15-0-101" class="i">+                        ),
</a><a href="#h15-0-102" id="h15-0-102" class="i">+                    ),
</a><a href="#h15-0-103" id="h15-0-103" class="i">+                    Constant(
</a><a href="#h15-0-104" id="h15-0-104" class="i">+                        Integer(
</a><a href="#h15-0-105" id="h15-0-105" class="i">+                            3,
</a><a href="#h15-0-106" id="h15-0-106" class="i">+                        ),
</a><a href="#h15-0-107" id="h15-0-107" class="i">+                    ),
</a><a href="#h15-0-108" id="h15-0-108" class="i">+                    Constant(
</a><a href="#h15-0-109" id="h15-0-109" class="i">+                        Integer(
</a><a href="#h15-0-110" id="h15-0-110" class="i">+                            3,
</a><a href="#h15-0-111" id="h15-0-111" class="i">+                        ),
</a><a href="#h15-0-112" id="h15-0-112" class="i">+                    ),
</a><a href="#h15-0-113" id="h15-0-113" class="i">+                    Constant(
</a><a href="#h15-0-114" id="h15-0-114" class="i">+                        Integer(
</a><a href="#h15-0-115" id="h15-0-115" class="i">+                            3,
</a><a href="#h15-0-116" id="h15-0-116" class="i">+                        ),
</a><a href="#h15-0-117" id="h15-0-117" class="i">+                    ),
</a><a href="#h15-0-118" id="h15-0-118" class="i">+                    Constant(
</a><a href="#h15-0-119" id="h15-0-119" class="i">+                        Integer(
</a><a href="#h15-0-120" id="h15-0-120" class="i">+                            3,
</a><a href="#h15-0-121" id="h15-0-121" class="i">+                        ),
</a><a href="#h15-0-122" id="h15-0-122" class="i">+                    ),
</a><a href="#h15-0-123" id="h15-0-123" class="i">+                ],
</a><a href="#h15-0-124" id="h15-0-124" class="i">+            },
</a><a href="#h15-0-125" id="h15-0-125" class="i">+            aggregates: [
</a><a href="#h15-0-126" id="h15-0-126" class="i">+                Min,
</a><a href="#h15-0-127" id="h15-0-127" class="i">+                Max,
</a><a href="#h15-0-128" id="h15-0-128" class="i">+                Sum,
</a><a href="#h15-0-129" id="h15-0-129" class="i">+                Count,
</a><a href="#h15-0-130" id="h15-0-130" class="i">+                Average,
</a><a href="#h15-0-131" id="h15-0-131" class="i">+            ],
</a><a href="#h15-0-132" id="h15-0-132" class="i">+        },
</a><a href="#h15-0-133" id="h15-0-133" class="i">+        labels: [
</a><a href="#h15-0-134" id="h15-0-134" class="i">+            None,
</a><a href="#h15-0-135" id="h15-0-135" class="i">+            None,
</a><a href="#h15-0-136" id="h15-0-136" class="i">+            None,
</a><a href="#h15-0-137" id="h15-0-137" class="i">+            None,
</a><a href="#h15-0-138" id="h15-0-138" class="i">+            None,
</a><a href="#h15-0-139" id="h15-0-139" class="i">+        ],
</a><a href="#h15-0-140" id="h15-0-140" class="i">+        expressions: [
</a><a href="#h15-0-141" id="h15-0-141" class="i">+            Column(
</a><a href="#h15-0-142" id="h15-0-142" class="i">+                0,
</a><a href="#h15-0-143" id="h15-0-143" class="i">+            ),
</a><a href="#h15-0-144" id="h15-0-144" class="i">+            Column(
</a><a href="#h15-0-145" id="h15-0-145" class="i">+                1,
</a><a href="#h15-0-146" id="h15-0-146" class="i">+            ),
</a><a href="#h15-0-147" id="h15-0-147" class="i">+            Column(
</a><a href="#h15-0-148" id="h15-0-148" class="i">+                2,
</a><a href="#h15-0-149" id="h15-0-149" class="i">+            ),
</a><a href="#h15-0-150" id="h15-0-150" class="i">+            Column(
</a><a href="#h15-0-151" id="h15-0-151" class="i">+                3,
</a><a href="#h15-0-152" id="h15-0-152" class="i">+            ),
</a><a href="#h15-0-153" id="h15-0-153" class="i">+            Column(
</a><a href="#h15-0-154" id="h15-0-154" class="i">+                4,
</a><a href="#h15-0-155" id="h15-0-155" class="i">+            ),
</a><a href="#h15-0-156" id="h15-0-156" class="i">+        ],
</a><a href="#h15-0-157" id="h15-0-157" class="i">+    },
</a><a href="#h15-0-158" id="h15-0-158" class="i">+}
</a><a href="#h15-0-159" id="h15-0-159" class="i">+
</a><a href="#h15-0-160" id="h15-0-160" class="i">+Optimized plan: Plan {
</a><a href="#h15-0-161" id="h15-0-161" class="i">+    root: Projection {
</a><a href="#h15-0-162" id="h15-0-162" class="i">+        source: Aggregation {
</a><a href="#h15-0-163" id="h15-0-163" class="i">+            source: Projection {
</a><a href="#h15-0-164" id="h15-0-164" class="i">+                source: Scan {
</a><a href="#h15-0-165" id="h15-0-165" class="i">+                    table: &quot;genres&quot;,
</a><a href="#h15-0-166" id="h15-0-166" class="i">+                    alias: None,
</a><a href="#h15-0-167" id="h15-0-167" class="i">+                },
</a><a href="#h15-0-168" id="h15-0-168" class="i">+                labels: [
</a><a href="#h15-0-169" id="h15-0-169" class="i">+                    None,
</a><a href="#h15-0-170" id="h15-0-170" class="i">+                    None,
</a><a href="#h15-0-171" id="h15-0-171" class="i">+                    None,
</a><a href="#h15-0-172" id="h15-0-172" class="i">+                    None,
</a><a href="#h15-0-173" id="h15-0-173" class="i">+                    None,
</a><a href="#h15-0-174" id="h15-0-174" class="i">+                ],
</a><a href="#h15-0-175" id="h15-0-175" class="i">+                expressions: [
</a><a href="#h15-0-176" id="h15-0-176" class="i">+                    Constant(
</a><a href="#h15-0-177" id="h15-0-177" class="i">+                        Integer(
</a><a href="#h15-0-178" id="h15-0-178" class="i">+                            3,
</a><a href="#h15-0-179" id="h15-0-179" class="i">+                        ),
</a><a href="#h15-0-180" id="h15-0-180" class="i">+                    ),
</a><a href="#h15-0-181" id="h15-0-181" class="i">+                    Constant(
</a><a href="#h15-0-182" id="h15-0-182" class="i">+                        Integer(
</a><a href="#h15-0-183" id="h15-0-183" class="i">+                            3,
</a><a href="#h15-0-184" id="h15-0-184" class="i">+                        ),
</a><a href="#h15-0-185" id="h15-0-185" class="i">+                    ),
</a><a href="#h15-0-186" id="h15-0-186" class="i">+                    Constant(
</a><a href="#h15-0-187" id="h15-0-187" class="i">+                        Integer(
</a><a href="#h15-0-188" id="h15-0-188" class="i">+                            3,
</a><a href="#h15-0-189" id="h15-0-189" class="i">+                        ),
</a><a href="#h15-0-190" id="h15-0-190" class="i">+                    ),
</a><a href="#h15-0-191" id="h15-0-191" class="i">+                    Constant(
</a><a href="#h15-0-192" id="h15-0-192" class="i">+                        Integer(
</a><a href="#h15-0-193" id="h15-0-193" class="i">+                            3,
</a><a href="#h15-0-194" id="h15-0-194" class="i">+                        ),
</a><a href="#h15-0-195" id="h15-0-195" class="i">+                    ),
</a><a href="#h15-0-196" id="h15-0-196" class="i">+                    Constant(
</a><a href="#h15-0-197" id="h15-0-197" class="i">+                        Integer(
</a><a href="#h15-0-198" id="h15-0-198" class="i">+                            3,
</a><a href="#h15-0-199" id="h15-0-199" class="i">+                        ),
</a><a href="#h15-0-200" id="h15-0-200" class="i">+                    ),
</a><a href="#h15-0-201" id="h15-0-201" class="i">+                ],
</a><a href="#h15-0-202" id="h15-0-202" class="i">+            },
</a><a href="#h15-0-203" id="h15-0-203" class="i">+            aggregates: [
</a><a href="#h15-0-204" id="h15-0-204" class="i">+                Min,
</a><a href="#h15-0-205" id="h15-0-205" class="i">+                Max,
</a><a href="#h15-0-206" id="h15-0-206" class="i">+                Sum,
</a><a href="#h15-0-207" id="h15-0-207" class="i">+                Count,
</a><a href="#h15-0-208" id="h15-0-208" class="i">+                Average,
</a><a href="#h15-0-209" id="h15-0-209" class="i">+            ],
</a><a href="#h15-0-210" id="h15-0-210" class="i">+        },
</a><a href="#h15-0-211" id="h15-0-211" class="i">+        labels: [
</a><a href="#h15-0-212" id="h15-0-212" class="i">+            None,
</a><a href="#h15-0-213" id="h15-0-213" class="i">+            None,
</a><a href="#h15-0-214" id="h15-0-214" class="i">+            None,
</a><a href="#h15-0-215" id="h15-0-215" class="i">+            None,
</a><a href="#h15-0-216" id="h15-0-216" class="i">+            None,
</a><a href="#h15-0-217" id="h15-0-217" class="i">+        ],
</a><a href="#h15-0-218" id="h15-0-218" class="i">+        expressions: [
</a><a href="#h15-0-219" id="h15-0-219" class="i">+            Column(
</a><a href="#h15-0-220" id="h15-0-220" class="i">+                0,
</a><a href="#h15-0-221" id="h15-0-221" class="i">+            ),
</a><a href="#h15-0-222" id="h15-0-222" class="i">+            Column(
</a><a href="#h15-0-223" id="h15-0-223" class="i">+                1,
</a><a href="#h15-0-224" id="h15-0-224" class="i">+            ),
</a><a href="#h15-0-225" id="h15-0-225" class="i">+            Column(
</a><a href="#h15-0-226" id="h15-0-226" class="i">+                2,
</a><a href="#h15-0-227" id="h15-0-227" class="i">+            ),
</a><a href="#h15-0-228" id="h15-0-228" class="i">+            Column(
</a><a href="#h15-0-229" id="h15-0-229" class="i">+                3,
</a><a href="#h15-0-230" id="h15-0-230" class="i">+            ),
</a><a href="#h15-0-231" id="h15-0-231" class="i">+            Column(
</a><a href="#h15-0-232" id="h15-0-232" class="i">+                4,
</a><a href="#h15-0-233" id="h15-0-233" class="i">+            ),
</a><a href="#h15-0-234" id="h15-0-234" class="i">+        ],
</a><a href="#h15-0-235" id="h15-0-235" class="i">+    },
</a><a href="#h15-0-236" id="h15-0-236" class="i">+}
</a><a href="#h15-0-237" id="h15-0-237" class="i">+
</a><a href="#h15-0-238" id="h15-0-238" class="i">+Query: SELECT MIN(3), MAX(3), SUM(3), COUNT(3), AVG(3) FROM genres
</a><a href="#h15-0-239" id="h15-0-239" class="i">+
</a><a href="#h15-0-240" id="h15-0-240" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h15-0-241" id="h15-0-241" class="i">+[Integer(3), Integer(3), Integer(9), Integer(3), Integer(3)]
</a><b>diff --git a/<a id="h16" href="../file/src/sql/tests/query/agg_count_star.html">src/sql/tests/query/agg_count_star</a> b/<a href="../file/src/sql/tests/query/agg_count_star.html">src/sql/tests/query/agg_count_star</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -0,0 +1,110 @@
</a><a href="#h16-0-0" id="h16-0-0" class="i">+Query: SELECT COUNT(*) FROM movies
</a><a href="#h16-0-1" id="h16-0-1" class="i">+
</a><a href="#h16-0-2" id="h16-0-2" class="i">+AST: Select {
</a><a href="#h16-0-3" id="h16-0-3" class="i">+    select: SelectClause {
</a><a href="#h16-0-4" id="h16-0-4" class="i">+        expressions: [
</a><a href="#h16-0-5" id="h16-0-5" class="i">+            Function(
</a><a href="#h16-0-6" id="h16-0-6" class="i">+                &quot;count&quot;,
</a><a href="#h16-0-7" id="h16-0-7" class="i">+                [
</a><a href="#h16-0-8" id="h16-0-8" class="i">+                    Literal(
</a><a href="#h16-0-9" id="h16-0-9" class="i">+                        Boolean(
</a><a href="#h16-0-10" id="h16-0-10" class="i">+                            true,
</a><a href="#h16-0-11" id="h16-0-11" class="i">+                        ),
</a><a href="#h16-0-12" id="h16-0-12" class="i">+                    ),
</a><a href="#h16-0-13" id="h16-0-13" class="i">+                ],
</a><a href="#h16-0-14" id="h16-0-14" class="i">+            ),
</a><a href="#h16-0-15" id="h16-0-15" class="i">+        ],
</a><a href="#h16-0-16" id="h16-0-16" class="i">+        labels: [
</a><a href="#h16-0-17" id="h16-0-17" class="i">+            None,
</a><a href="#h16-0-18" id="h16-0-18" class="i">+        ],
</a><a href="#h16-0-19" id="h16-0-19" class="i">+    },
</a><a href="#h16-0-20" id="h16-0-20" class="i">+    from: Some(
</a><a href="#h16-0-21" id="h16-0-21" class="i">+        FromClause {
</a><a href="#h16-0-22" id="h16-0-22" class="i">+            items: [
</a><a href="#h16-0-23" id="h16-0-23" class="i">+                Table {
</a><a href="#h16-0-24" id="h16-0-24" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h16-0-25" id="h16-0-25" class="i">+                    alias: None,
</a><a href="#h16-0-26" id="h16-0-26" class="i">+                },
</a><a href="#h16-0-27" id="h16-0-27" class="i">+            ],
</a><a href="#h16-0-28" id="h16-0-28" class="i">+        },
</a><a href="#h16-0-29" id="h16-0-29" class="i">+    ),
</a><a href="#h16-0-30" id="h16-0-30" class="i">+    where: None,
</a><a href="#h16-0-31" id="h16-0-31" class="i">+    group_by: None,
</a><a href="#h16-0-32" id="h16-0-32" class="i">+    having: None,
</a><a href="#h16-0-33" id="h16-0-33" class="i">+    order: [],
</a><a href="#h16-0-34" id="h16-0-34" class="i">+    limit: None,
</a><a href="#h16-0-35" id="h16-0-35" class="i">+    offset: None,
</a><a href="#h16-0-36" id="h16-0-36" class="i">+}
</a><a href="#h16-0-37" id="h16-0-37" class="i">+
</a><a href="#h16-0-38" id="h16-0-38" class="i">+Plan: Plan {
</a><a href="#h16-0-39" id="h16-0-39" class="i">+    root: Projection {
</a><a href="#h16-0-40" id="h16-0-40" class="i">+        source: Aggregation {
</a><a href="#h16-0-41" id="h16-0-41" class="i">+            source: Projection {
</a><a href="#h16-0-42" id="h16-0-42" class="i">+                source: Scan {
</a><a href="#h16-0-43" id="h16-0-43" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h16-0-44" id="h16-0-44" class="i">+                    alias: None,
</a><a href="#h16-0-45" id="h16-0-45" class="i">+                },
</a><a href="#h16-0-46" id="h16-0-46" class="i">+                labels: [
</a><a href="#h16-0-47" id="h16-0-47" class="i">+                    None,
</a><a href="#h16-0-48" id="h16-0-48" class="i">+                ],
</a><a href="#h16-0-49" id="h16-0-49" class="i">+                expressions: [
</a><a href="#h16-0-50" id="h16-0-50" class="i">+                    Constant(
</a><a href="#h16-0-51" id="h16-0-51" class="i">+                        Boolean(
</a><a href="#h16-0-52" id="h16-0-52" class="i">+                            true,
</a><a href="#h16-0-53" id="h16-0-53" class="i">+                        ),
</a><a href="#h16-0-54" id="h16-0-54" class="i">+                    ),
</a><a href="#h16-0-55" id="h16-0-55" class="i">+                ],
</a><a href="#h16-0-56" id="h16-0-56" class="i">+            },
</a><a href="#h16-0-57" id="h16-0-57" class="i">+            aggregates: [
</a><a href="#h16-0-58" id="h16-0-58" class="i">+                Count,
</a><a href="#h16-0-59" id="h16-0-59" class="i">+            ],
</a><a href="#h16-0-60" id="h16-0-60" class="i">+        },
</a><a href="#h16-0-61" id="h16-0-61" class="i">+        labels: [
</a><a href="#h16-0-62" id="h16-0-62" class="i">+            None,
</a><a href="#h16-0-63" id="h16-0-63" class="i">+        ],
</a><a href="#h16-0-64" id="h16-0-64" class="i">+        expressions: [
</a><a href="#h16-0-65" id="h16-0-65" class="i">+            Column(
</a><a href="#h16-0-66" id="h16-0-66" class="i">+                0,
</a><a href="#h16-0-67" id="h16-0-67" class="i">+            ),
</a><a href="#h16-0-68" id="h16-0-68" class="i">+        ],
</a><a href="#h16-0-69" id="h16-0-69" class="i">+    },
</a><a href="#h16-0-70" id="h16-0-70" class="i">+}
</a><a href="#h16-0-71" id="h16-0-71" class="i">+
</a><a href="#h16-0-72" id="h16-0-72" class="i">+Optimized plan: Plan {
</a><a href="#h16-0-73" id="h16-0-73" class="i">+    root: Projection {
</a><a href="#h16-0-74" id="h16-0-74" class="i">+        source: Aggregation {
</a><a href="#h16-0-75" id="h16-0-75" class="i">+            source: Projection {
</a><a href="#h16-0-76" id="h16-0-76" class="i">+                source: Scan {
</a><a href="#h16-0-77" id="h16-0-77" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h16-0-78" id="h16-0-78" class="i">+                    alias: None,
</a><a href="#h16-0-79" id="h16-0-79" class="i">+                },
</a><a href="#h16-0-80" id="h16-0-80" class="i">+                labels: [
</a><a href="#h16-0-81" id="h16-0-81" class="i">+                    None,
</a><a href="#h16-0-82" id="h16-0-82" class="i">+                ],
</a><a href="#h16-0-83" id="h16-0-83" class="i">+                expressions: [
</a><a href="#h16-0-84" id="h16-0-84" class="i">+                    Constant(
</a><a href="#h16-0-85" id="h16-0-85" class="i">+                        Boolean(
</a><a href="#h16-0-86" id="h16-0-86" class="i">+                            true,
</a><a href="#h16-0-87" id="h16-0-87" class="i">+                        ),
</a><a href="#h16-0-88" id="h16-0-88" class="i">+                    ),
</a><a href="#h16-0-89" id="h16-0-89" class="i">+                ],
</a><a href="#h16-0-90" id="h16-0-90" class="i">+            },
</a><a href="#h16-0-91" id="h16-0-91" class="i">+            aggregates: [
</a><a href="#h16-0-92" id="h16-0-92" class="i">+                Count,
</a><a href="#h16-0-93" id="h16-0-93" class="i">+            ],
</a><a href="#h16-0-94" id="h16-0-94" class="i">+        },
</a><a href="#h16-0-95" id="h16-0-95" class="i">+        labels: [
</a><a href="#h16-0-96" id="h16-0-96" class="i">+            None,
</a><a href="#h16-0-97" id="h16-0-97" class="i">+        ],
</a><a href="#h16-0-98" id="h16-0-98" class="i">+        expressions: [
</a><a href="#h16-0-99" id="h16-0-99" class="i">+            Column(
</a><a href="#h16-0-100" id="h16-0-100" class="i">+                0,
</a><a href="#h16-0-101" id="h16-0-101" class="i">+            ),
</a><a href="#h16-0-102" id="h16-0-102" class="i">+        ],
</a><a href="#h16-0-103" id="h16-0-103" class="i">+    },
</a><a href="#h16-0-104" id="h16-0-104" class="i">+}
</a><a href="#h16-0-105" id="h16-0-105" class="i">+
</a><a href="#h16-0-106" id="h16-0-106" class="i">+Query: SELECT COUNT(*) FROM movies
</a><a href="#h16-0-107" id="h16-0-107" class="i">+
</a><a href="#h16-0-108" id="h16-0-108" class="i">+Result: [&quot;?&quot;]
</a><a href="#h16-0-109" id="h16-0-109" class="i">+[Integer(10)]
</a><b>diff --git a/<a id="h17" href="../file/src/sql/tests/query/agg_expr.html">src/sql/tests/query/agg_expr</a> b/<a href="../file/src/sql/tests/query/agg_expr.html">src/sql/tests/query/agg_expr</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -0,0 +1,168 @@
</a><a href="#h17-0-0" id="h17-0-0" class="i">+Query: SELECT SUM(rating * 10) / COUNT(*) FROM movies
</a><a href="#h17-0-1" id="h17-0-1" class="i">+
</a><a href="#h17-0-2" id="h17-0-2" class="i">+AST: Select {
</a><a href="#h17-0-3" id="h17-0-3" class="i">+    select: SelectClause {
</a><a href="#h17-0-4" id="h17-0-4" class="i">+        expressions: [
</a><a href="#h17-0-5" id="h17-0-5" class="i">+            Operation(
</a><a href="#h17-0-6" id="h17-0-6" class="i">+                Divide(
</a><a href="#h17-0-7" id="h17-0-7" class="i">+                    Function(
</a><a href="#h17-0-8" id="h17-0-8" class="i">+                        &quot;sum&quot;,
</a><a href="#h17-0-9" id="h17-0-9" class="i">+                        [
</a><a href="#h17-0-10" id="h17-0-10" class="i">+                            Operation(
</a><a href="#h17-0-11" id="h17-0-11" class="i">+                                Multiply(
</a><a href="#h17-0-12" id="h17-0-12" class="i">+                                    Field(
</a><a href="#h17-0-13" id="h17-0-13" class="i">+                                        None,
</a><a href="#h17-0-14" id="h17-0-14" class="i">+                                        &quot;rating&quot;,
</a><a href="#h17-0-15" id="h17-0-15" class="i">+                                    ),
</a><a href="#h17-0-16" id="h17-0-16" class="i">+                                    Literal(
</a><a href="#h17-0-17" id="h17-0-17" class="i">+                                        Integer(
</a><a href="#h17-0-18" id="h17-0-18" class="i">+                                            10,
</a><a href="#h17-0-19" id="h17-0-19" class="i">+                                        ),
</a><a href="#h17-0-20" id="h17-0-20" class="i">+                                    ),
</a><a href="#h17-0-21" id="h17-0-21" class="i">+                                ),
</a><a href="#h17-0-22" id="h17-0-22" class="i">+                            ),
</a><a href="#h17-0-23" id="h17-0-23" class="i">+                        ],
</a><a href="#h17-0-24" id="h17-0-24" class="i">+                    ),
</a><a href="#h17-0-25" id="h17-0-25" class="i">+                    Function(
</a><a href="#h17-0-26" id="h17-0-26" class="i">+                        &quot;count&quot;,
</a><a href="#h17-0-27" id="h17-0-27" class="i">+                        [
</a><a href="#h17-0-28" id="h17-0-28" class="i">+                            Literal(
</a><a href="#h17-0-29" id="h17-0-29" class="i">+                                Boolean(
</a><a href="#h17-0-30" id="h17-0-30" class="i">+                                    true,
</a><a href="#h17-0-31" id="h17-0-31" class="i">+                                ),
</a><a href="#h17-0-32" id="h17-0-32" class="i">+                            ),
</a><a href="#h17-0-33" id="h17-0-33" class="i">+                        ],
</a><a href="#h17-0-34" id="h17-0-34" class="i">+                    ),
</a><a href="#h17-0-35" id="h17-0-35" class="i">+                ),
</a><a href="#h17-0-36" id="h17-0-36" class="i">+            ),
</a><a href="#h17-0-37" id="h17-0-37" class="i">+        ],
</a><a href="#h17-0-38" id="h17-0-38" class="i">+        labels: [
</a><a href="#h17-0-39" id="h17-0-39" class="i">+            None,
</a><a href="#h17-0-40" id="h17-0-40" class="i">+        ],
</a><a href="#h17-0-41" id="h17-0-41" class="i">+    },
</a><a href="#h17-0-42" id="h17-0-42" class="i">+    from: Some(
</a><a href="#h17-0-43" id="h17-0-43" class="i">+        FromClause {
</a><a href="#h17-0-44" id="h17-0-44" class="i">+            items: [
</a><a href="#h17-0-45" id="h17-0-45" class="i">+                Table {
</a><a href="#h17-0-46" id="h17-0-46" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h17-0-47" id="h17-0-47" class="i">+                    alias: None,
</a><a href="#h17-0-48" id="h17-0-48" class="i">+                },
</a><a href="#h17-0-49" id="h17-0-49" class="i">+            ],
</a><a href="#h17-0-50" id="h17-0-50" class="i">+        },
</a><a href="#h17-0-51" id="h17-0-51" class="i">+    ),
</a><a href="#h17-0-52" id="h17-0-52" class="i">+    where: None,
</a><a href="#h17-0-53" id="h17-0-53" class="i">+    group_by: None,
</a><a href="#h17-0-54" id="h17-0-54" class="i">+    having: None,
</a><a href="#h17-0-55" id="h17-0-55" class="i">+    order: [],
</a><a href="#h17-0-56" id="h17-0-56" class="i">+    limit: None,
</a><a href="#h17-0-57" id="h17-0-57" class="i">+    offset: None,
</a><a href="#h17-0-58" id="h17-0-58" class="i">+}
</a><a href="#h17-0-59" id="h17-0-59" class="i">+
</a><a href="#h17-0-60" id="h17-0-60" class="i">+Plan: Plan {
</a><a href="#h17-0-61" id="h17-0-61" class="i">+    root: Projection {
</a><a href="#h17-0-62" id="h17-0-62" class="i">+        source: Aggregation {
</a><a href="#h17-0-63" id="h17-0-63" class="i">+            source: Projection {
</a><a href="#h17-0-64" id="h17-0-64" class="i">+                source: Scan {
</a><a href="#h17-0-65" id="h17-0-65" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h17-0-66" id="h17-0-66" class="i">+                    alias: None,
</a><a href="#h17-0-67" id="h17-0-67" class="i">+                },
</a><a href="#h17-0-68" id="h17-0-68" class="i">+                labels: [
</a><a href="#h17-0-69" id="h17-0-69" class="i">+                    None,
</a><a href="#h17-0-70" id="h17-0-70" class="i">+                    None,
</a><a href="#h17-0-71" id="h17-0-71" class="i">+                ],
</a><a href="#h17-0-72" id="h17-0-72" class="i">+                expressions: [
</a><a href="#h17-0-73" id="h17-0-73" class="i">+                    Multiply(
</a><a href="#h17-0-74" id="h17-0-74" class="i">+                        Field(
</a><a href="#h17-0-75" id="h17-0-75" class="i">+                            None,
</a><a href="#h17-0-76" id="h17-0-76" class="i">+                            &quot;rating&quot;,
</a><a href="#h17-0-77" id="h17-0-77" class="i">+                        ),
</a><a href="#h17-0-78" id="h17-0-78" class="i">+                        Constant(
</a><a href="#h17-0-79" id="h17-0-79" class="i">+                            Integer(
</a><a href="#h17-0-80" id="h17-0-80" class="i">+                                10,
</a><a href="#h17-0-81" id="h17-0-81" class="i">+                            ),
</a><a href="#h17-0-82" id="h17-0-82" class="i">+                        ),
</a><a href="#h17-0-83" id="h17-0-83" class="i">+                    ),
</a><a href="#h17-0-84" id="h17-0-84" class="i">+                    Constant(
</a><a href="#h17-0-85" id="h17-0-85" class="i">+                        Boolean(
</a><a href="#h17-0-86" id="h17-0-86" class="i">+                            true,
</a><a href="#h17-0-87" id="h17-0-87" class="i">+                        ),
</a><a href="#h17-0-88" id="h17-0-88" class="i">+                    ),
</a><a href="#h17-0-89" id="h17-0-89" class="i">+                ],
</a><a href="#h17-0-90" id="h17-0-90" class="i">+            },
</a><a href="#h17-0-91" id="h17-0-91" class="i">+            aggregates: [
</a><a href="#h17-0-92" id="h17-0-92" class="i">+                Sum,
</a><a href="#h17-0-93" id="h17-0-93" class="i">+                Count,
</a><a href="#h17-0-94" id="h17-0-94" class="i">+            ],
</a><a href="#h17-0-95" id="h17-0-95" class="i">+        },
</a><a href="#h17-0-96" id="h17-0-96" class="i">+        labels: [
</a><a href="#h17-0-97" id="h17-0-97" class="i">+            None,
</a><a href="#h17-0-98" id="h17-0-98" class="i">+        ],
</a><a href="#h17-0-99" id="h17-0-99" class="i">+        expressions: [
</a><a href="#h17-0-100" id="h17-0-100" class="i">+            Divide(
</a><a href="#h17-0-101" id="h17-0-101" class="i">+                Column(
</a><a href="#h17-0-102" id="h17-0-102" class="i">+                    0,
</a><a href="#h17-0-103" id="h17-0-103" class="i">+                ),
</a><a href="#h17-0-104" id="h17-0-104" class="i">+                Column(
</a><a href="#h17-0-105" id="h17-0-105" class="i">+                    1,
</a><a href="#h17-0-106" id="h17-0-106" class="i">+                ),
</a><a href="#h17-0-107" id="h17-0-107" class="i">+            ),
</a><a href="#h17-0-108" id="h17-0-108" class="i">+        ],
</a><a href="#h17-0-109" id="h17-0-109" class="i">+    },
</a><a href="#h17-0-110" id="h17-0-110" class="i">+}
</a><a href="#h17-0-111" id="h17-0-111" class="i">+
</a><a href="#h17-0-112" id="h17-0-112" class="i">+Optimized plan: Plan {
</a><a href="#h17-0-113" id="h17-0-113" class="i">+    root: Projection {
</a><a href="#h17-0-114" id="h17-0-114" class="i">+        source: Aggregation {
</a><a href="#h17-0-115" id="h17-0-115" class="i">+            source: Projection {
</a><a href="#h17-0-116" id="h17-0-116" class="i">+                source: Scan {
</a><a href="#h17-0-117" id="h17-0-117" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h17-0-118" id="h17-0-118" class="i">+                    alias: None,
</a><a href="#h17-0-119" id="h17-0-119" class="i">+                },
</a><a href="#h17-0-120" id="h17-0-120" class="i">+                labels: [
</a><a href="#h17-0-121" id="h17-0-121" class="i">+                    None,
</a><a href="#h17-0-122" id="h17-0-122" class="i">+                    None,
</a><a href="#h17-0-123" id="h17-0-123" class="i">+                ],
</a><a href="#h17-0-124" id="h17-0-124" class="i">+                expressions: [
</a><a href="#h17-0-125" id="h17-0-125" class="i">+                    Multiply(
</a><a href="#h17-0-126" id="h17-0-126" class="i">+                        Field(
</a><a href="#h17-0-127" id="h17-0-127" class="i">+                            None,
</a><a href="#h17-0-128" id="h17-0-128" class="i">+                            &quot;rating&quot;,
</a><a href="#h17-0-129" id="h17-0-129" class="i">+                        ),
</a><a href="#h17-0-130" id="h17-0-130" class="i">+                        Constant(
</a><a href="#h17-0-131" id="h17-0-131" class="i">+                            Integer(
</a><a href="#h17-0-132" id="h17-0-132" class="i">+                                10,
</a><a href="#h17-0-133" id="h17-0-133" class="i">+                            ),
</a><a href="#h17-0-134" id="h17-0-134" class="i">+                        ),
</a><a href="#h17-0-135" id="h17-0-135" class="i">+                    ),
</a><a href="#h17-0-136" id="h17-0-136" class="i">+                    Constant(
</a><a href="#h17-0-137" id="h17-0-137" class="i">+                        Boolean(
</a><a href="#h17-0-138" id="h17-0-138" class="i">+                            true,
</a><a href="#h17-0-139" id="h17-0-139" class="i">+                        ),
</a><a href="#h17-0-140" id="h17-0-140" class="i">+                    ),
</a><a href="#h17-0-141" id="h17-0-141" class="i">+                ],
</a><a href="#h17-0-142" id="h17-0-142" class="i">+            },
</a><a href="#h17-0-143" id="h17-0-143" class="i">+            aggregates: [
</a><a href="#h17-0-144" id="h17-0-144" class="i">+                Sum,
</a><a href="#h17-0-145" id="h17-0-145" class="i">+                Count,
</a><a href="#h17-0-146" id="h17-0-146" class="i">+            ],
</a><a href="#h17-0-147" id="h17-0-147" class="i">+        },
</a><a href="#h17-0-148" id="h17-0-148" class="i">+        labels: [
</a><a href="#h17-0-149" id="h17-0-149" class="i">+            None,
</a><a href="#h17-0-150" id="h17-0-150" class="i">+        ],
</a><a href="#h17-0-151" id="h17-0-151" class="i">+        expressions: [
</a><a href="#h17-0-152" id="h17-0-152" class="i">+            Divide(
</a><a href="#h17-0-153" id="h17-0-153" class="i">+                Column(
</a><a href="#h17-0-154" id="h17-0-154" class="i">+                    0,
</a><a href="#h17-0-155" id="h17-0-155" class="i">+                ),
</a><a href="#h17-0-156" id="h17-0-156" class="i">+                Column(
</a><a href="#h17-0-157" id="h17-0-157" class="i">+                    1,
</a><a href="#h17-0-158" id="h17-0-158" class="i">+                ),
</a><a href="#h17-0-159" id="h17-0-159" class="i">+            ),
</a><a href="#h17-0-160" id="h17-0-160" class="i">+        ],
</a><a href="#h17-0-161" id="h17-0-161" class="i">+    },
</a><a href="#h17-0-162" id="h17-0-162" class="i">+}
</a><a href="#h17-0-163" id="h17-0-163" class="i">+
</a><a href="#h17-0-164" id="h17-0-164" class="i">+Query: SELECT SUM(rating * 10) / COUNT(*) FROM movies
</a><a href="#h17-0-165" id="h17-0-165" class="i">+
</a><a href="#h17-0-166" id="h17-0-166" class="i">+Result: [&quot;?&quot;]
</a><a href="#h17-0-167" id="h17-0-167" class="i">+[Float(77.8)]
</a><b>diff --git a/<a id="h18" href="../file/src/sql/tests/query/agg_float.html">src/sql/tests/query/agg_float</a> b/<a href="../file/src/sql/tests/query/agg_float.html">src/sql/tests/query/agg_float</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -0,0 +1,262 @@
</a><a href="#h18-0-0" id="h18-0-0" class="i">+Query: SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats WHERE f IS NOT NULL
</a><a href="#h18-0-1" id="h18-0-1" class="i">+
</a><a href="#h18-0-2" id="h18-0-2" class="i">+AST: Select {
</a><a href="#h18-0-3" id="h18-0-3" class="i">+    select: SelectClause {
</a><a href="#h18-0-4" id="h18-0-4" class="i">+        expressions: [
</a><a href="#h18-0-5" id="h18-0-5" class="i">+            Function(
</a><a href="#h18-0-6" id="h18-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h18-0-7" id="h18-0-7" class="i">+                [
</a><a href="#h18-0-8" id="h18-0-8" class="i">+                    Field(
</a><a href="#h18-0-9" id="h18-0-9" class="i">+                        None,
</a><a href="#h18-0-10" id="h18-0-10" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-11" id="h18-0-11" class="i">+                    ),
</a><a href="#h18-0-12" id="h18-0-12" class="i">+                ],
</a><a href="#h18-0-13" id="h18-0-13" class="i">+            ),
</a><a href="#h18-0-14" id="h18-0-14" class="i">+            Function(
</a><a href="#h18-0-15" id="h18-0-15" class="i">+                &quot;max&quot;,
</a><a href="#h18-0-16" id="h18-0-16" class="i">+                [
</a><a href="#h18-0-17" id="h18-0-17" class="i">+                    Field(
</a><a href="#h18-0-18" id="h18-0-18" class="i">+                        None,
</a><a href="#h18-0-19" id="h18-0-19" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-20" id="h18-0-20" class="i">+                    ),
</a><a href="#h18-0-21" id="h18-0-21" class="i">+                ],
</a><a href="#h18-0-22" id="h18-0-22" class="i">+            ),
</a><a href="#h18-0-23" id="h18-0-23" class="i">+            Function(
</a><a href="#h18-0-24" id="h18-0-24" class="i">+                &quot;sum&quot;,
</a><a href="#h18-0-25" id="h18-0-25" class="i">+                [
</a><a href="#h18-0-26" id="h18-0-26" class="i">+                    Field(
</a><a href="#h18-0-27" id="h18-0-27" class="i">+                        None,
</a><a href="#h18-0-28" id="h18-0-28" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-29" id="h18-0-29" class="i">+                    ),
</a><a href="#h18-0-30" id="h18-0-30" class="i">+                ],
</a><a href="#h18-0-31" id="h18-0-31" class="i">+            ),
</a><a href="#h18-0-32" id="h18-0-32" class="i">+            Function(
</a><a href="#h18-0-33" id="h18-0-33" class="i">+                &quot;count&quot;,
</a><a href="#h18-0-34" id="h18-0-34" class="i">+                [
</a><a href="#h18-0-35" id="h18-0-35" class="i">+                    Field(
</a><a href="#h18-0-36" id="h18-0-36" class="i">+                        None,
</a><a href="#h18-0-37" id="h18-0-37" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-38" id="h18-0-38" class="i">+                    ),
</a><a href="#h18-0-39" id="h18-0-39" class="i">+                ],
</a><a href="#h18-0-40" id="h18-0-40" class="i">+            ),
</a><a href="#h18-0-41" id="h18-0-41" class="i">+            Function(
</a><a href="#h18-0-42" id="h18-0-42" class="i">+                &quot;avg&quot;,
</a><a href="#h18-0-43" id="h18-0-43" class="i">+                [
</a><a href="#h18-0-44" id="h18-0-44" class="i">+                    Field(
</a><a href="#h18-0-45" id="h18-0-45" class="i">+                        None,
</a><a href="#h18-0-46" id="h18-0-46" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-47" id="h18-0-47" class="i">+                    ),
</a><a href="#h18-0-48" id="h18-0-48" class="i">+                ],
</a><a href="#h18-0-49" id="h18-0-49" class="i">+            ),
</a><a href="#h18-0-50" id="h18-0-50" class="i">+        ],
</a><a href="#h18-0-51" id="h18-0-51" class="i">+        labels: [
</a><a href="#h18-0-52" id="h18-0-52" class="i">+            None,
</a><a href="#h18-0-53" id="h18-0-53" class="i">+            None,
</a><a href="#h18-0-54" id="h18-0-54" class="i">+            None,
</a><a href="#h18-0-55" id="h18-0-55" class="i">+            None,
</a><a href="#h18-0-56" id="h18-0-56" class="i">+            None,
</a><a href="#h18-0-57" id="h18-0-57" class="i">+        ],
</a><a href="#h18-0-58" id="h18-0-58" class="i">+    },
</a><a href="#h18-0-59" id="h18-0-59" class="i">+    from: Some(
</a><a href="#h18-0-60" id="h18-0-60" class="i">+        FromClause {
</a><a href="#h18-0-61" id="h18-0-61" class="i">+            items: [
</a><a href="#h18-0-62" id="h18-0-62" class="i">+                Table {
</a><a href="#h18-0-63" id="h18-0-63" class="i">+                    name: &quot;floats&quot;,
</a><a href="#h18-0-64" id="h18-0-64" class="i">+                    alias: None,
</a><a href="#h18-0-65" id="h18-0-65" class="i">+                },
</a><a href="#h18-0-66" id="h18-0-66" class="i">+            ],
</a><a href="#h18-0-67" id="h18-0-67" class="i">+        },
</a><a href="#h18-0-68" id="h18-0-68" class="i">+    ),
</a><a href="#h18-0-69" id="h18-0-69" class="i">+    where: Some(
</a><a href="#h18-0-70" id="h18-0-70" class="i">+        WhereClause(
</a><a href="#h18-0-71" id="h18-0-71" class="i">+            Operation(
</a><a href="#h18-0-72" id="h18-0-72" class="i">+                Not(
</a><a href="#h18-0-73" id="h18-0-73" class="i">+                    Operation(
</a><a href="#h18-0-74" id="h18-0-74" class="i">+                        IsNull(
</a><a href="#h18-0-75" id="h18-0-75" class="i">+                            Field(
</a><a href="#h18-0-76" id="h18-0-76" class="i">+                                None,
</a><a href="#h18-0-77" id="h18-0-77" class="i">+                                &quot;f&quot;,
</a><a href="#h18-0-78" id="h18-0-78" class="i">+                            ),
</a><a href="#h18-0-79" id="h18-0-79" class="i">+                        ),
</a><a href="#h18-0-80" id="h18-0-80" class="i">+                    ),
</a><a href="#h18-0-81" id="h18-0-81" class="i">+                ),
</a><a href="#h18-0-82" id="h18-0-82" class="i">+            ),
</a><a href="#h18-0-83" id="h18-0-83" class="i">+        ),
</a><a href="#h18-0-84" id="h18-0-84" class="i">+    ),
</a><a href="#h18-0-85" id="h18-0-85" class="i">+    group_by: None,
</a><a href="#h18-0-86" id="h18-0-86" class="i">+    having: None,
</a><a href="#h18-0-87" id="h18-0-87" class="i">+    order: [],
</a><a href="#h18-0-88" id="h18-0-88" class="i">+    limit: None,
</a><a href="#h18-0-89" id="h18-0-89" class="i">+    offset: None,
</a><a href="#h18-0-90" id="h18-0-90" class="i">+}
</a><a href="#h18-0-91" id="h18-0-91" class="i">+
</a><a href="#h18-0-92" id="h18-0-92" class="i">+Plan: Plan {
</a><a href="#h18-0-93" id="h18-0-93" class="i">+    root: Projection {
</a><a href="#h18-0-94" id="h18-0-94" class="i">+        source: Aggregation {
</a><a href="#h18-0-95" id="h18-0-95" class="i">+            source: Projection {
</a><a href="#h18-0-96" id="h18-0-96" class="i">+                source: Filter {
</a><a href="#h18-0-97" id="h18-0-97" class="i">+                    source: Scan {
</a><a href="#h18-0-98" id="h18-0-98" class="i">+                        table: &quot;floats&quot;,
</a><a href="#h18-0-99" id="h18-0-99" class="i">+                        alias: None,
</a><a href="#h18-0-100" id="h18-0-100" class="i">+                    },
</a><a href="#h18-0-101" id="h18-0-101" class="i">+                    predicate: Not(
</a><a href="#h18-0-102" id="h18-0-102" class="i">+                        IsNull(
</a><a href="#h18-0-103" id="h18-0-103" class="i">+                            Field(
</a><a href="#h18-0-104" id="h18-0-104" class="i">+                                None,
</a><a href="#h18-0-105" id="h18-0-105" class="i">+                                &quot;f&quot;,
</a><a href="#h18-0-106" id="h18-0-106" class="i">+                            ),
</a><a href="#h18-0-107" id="h18-0-107" class="i">+                        ),
</a><a href="#h18-0-108" id="h18-0-108" class="i">+                    ),
</a><a href="#h18-0-109" id="h18-0-109" class="i">+                },
</a><a href="#h18-0-110" id="h18-0-110" class="i">+                labels: [
</a><a href="#h18-0-111" id="h18-0-111" class="i">+                    None,
</a><a href="#h18-0-112" id="h18-0-112" class="i">+                    None,
</a><a href="#h18-0-113" id="h18-0-113" class="i">+                    None,
</a><a href="#h18-0-114" id="h18-0-114" class="i">+                    None,
</a><a href="#h18-0-115" id="h18-0-115" class="i">+                    None,
</a><a href="#h18-0-116" id="h18-0-116" class="i">+                ],
</a><a href="#h18-0-117" id="h18-0-117" class="i">+                expressions: [
</a><a href="#h18-0-118" id="h18-0-118" class="i">+                    Field(
</a><a href="#h18-0-119" id="h18-0-119" class="i">+                        None,
</a><a href="#h18-0-120" id="h18-0-120" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-121" id="h18-0-121" class="i">+                    ),
</a><a href="#h18-0-122" id="h18-0-122" class="i">+                    Field(
</a><a href="#h18-0-123" id="h18-0-123" class="i">+                        None,
</a><a href="#h18-0-124" id="h18-0-124" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-125" id="h18-0-125" class="i">+                    ),
</a><a href="#h18-0-126" id="h18-0-126" class="i">+                    Field(
</a><a href="#h18-0-127" id="h18-0-127" class="i">+                        None,
</a><a href="#h18-0-128" id="h18-0-128" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-129" id="h18-0-129" class="i">+                    ),
</a><a href="#h18-0-130" id="h18-0-130" class="i">+                    Field(
</a><a href="#h18-0-131" id="h18-0-131" class="i">+                        None,
</a><a href="#h18-0-132" id="h18-0-132" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-133" id="h18-0-133" class="i">+                    ),
</a><a href="#h18-0-134" id="h18-0-134" class="i">+                    Field(
</a><a href="#h18-0-135" id="h18-0-135" class="i">+                        None,
</a><a href="#h18-0-136" id="h18-0-136" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-137" id="h18-0-137" class="i">+                    ),
</a><a href="#h18-0-138" id="h18-0-138" class="i">+                ],
</a><a href="#h18-0-139" id="h18-0-139" class="i">+            },
</a><a href="#h18-0-140" id="h18-0-140" class="i">+            aggregates: [
</a><a href="#h18-0-141" id="h18-0-141" class="i">+                Min,
</a><a href="#h18-0-142" id="h18-0-142" class="i">+                Max,
</a><a href="#h18-0-143" id="h18-0-143" class="i">+                Sum,
</a><a href="#h18-0-144" id="h18-0-144" class="i">+                Count,
</a><a href="#h18-0-145" id="h18-0-145" class="i">+                Average,
</a><a href="#h18-0-146" id="h18-0-146" class="i">+            ],
</a><a href="#h18-0-147" id="h18-0-147" class="i">+        },
</a><a href="#h18-0-148" id="h18-0-148" class="i">+        labels: [
</a><a href="#h18-0-149" id="h18-0-149" class="i">+            None,
</a><a href="#h18-0-150" id="h18-0-150" class="i">+            None,
</a><a href="#h18-0-151" id="h18-0-151" class="i">+            None,
</a><a href="#h18-0-152" id="h18-0-152" class="i">+            None,
</a><a href="#h18-0-153" id="h18-0-153" class="i">+            None,
</a><a href="#h18-0-154" id="h18-0-154" class="i">+        ],
</a><a href="#h18-0-155" id="h18-0-155" class="i">+        expressions: [
</a><a href="#h18-0-156" id="h18-0-156" class="i">+            Column(
</a><a href="#h18-0-157" id="h18-0-157" class="i">+                0,
</a><a href="#h18-0-158" id="h18-0-158" class="i">+            ),
</a><a href="#h18-0-159" id="h18-0-159" class="i">+            Column(
</a><a href="#h18-0-160" id="h18-0-160" class="i">+                1,
</a><a href="#h18-0-161" id="h18-0-161" class="i">+            ),
</a><a href="#h18-0-162" id="h18-0-162" class="i">+            Column(
</a><a href="#h18-0-163" id="h18-0-163" class="i">+                2,
</a><a href="#h18-0-164" id="h18-0-164" class="i">+            ),
</a><a href="#h18-0-165" id="h18-0-165" class="i">+            Column(
</a><a href="#h18-0-166" id="h18-0-166" class="i">+                3,
</a><a href="#h18-0-167" id="h18-0-167" class="i">+            ),
</a><a href="#h18-0-168" id="h18-0-168" class="i">+            Column(
</a><a href="#h18-0-169" id="h18-0-169" class="i">+                4,
</a><a href="#h18-0-170" id="h18-0-170" class="i">+            ),
</a><a href="#h18-0-171" id="h18-0-171" class="i">+        ],
</a><a href="#h18-0-172" id="h18-0-172" class="i">+    },
</a><a href="#h18-0-173" id="h18-0-173" class="i">+}
</a><a href="#h18-0-174" id="h18-0-174" class="i">+
</a><a href="#h18-0-175" id="h18-0-175" class="i">+Optimized plan: Plan {
</a><a href="#h18-0-176" id="h18-0-176" class="i">+    root: Projection {
</a><a href="#h18-0-177" id="h18-0-177" class="i">+        source: Aggregation {
</a><a href="#h18-0-178" id="h18-0-178" class="i">+            source: Projection {
</a><a href="#h18-0-179" id="h18-0-179" class="i">+                source: Filter {
</a><a href="#h18-0-180" id="h18-0-180" class="i">+                    source: Scan {
</a><a href="#h18-0-181" id="h18-0-181" class="i">+                        table: &quot;floats&quot;,
</a><a href="#h18-0-182" id="h18-0-182" class="i">+                        alias: None,
</a><a href="#h18-0-183" id="h18-0-183" class="i">+                    },
</a><a href="#h18-0-184" id="h18-0-184" class="i">+                    predicate: Not(
</a><a href="#h18-0-185" id="h18-0-185" class="i">+                        IsNull(
</a><a href="#h18-0-186" id="h18-0-186" class="i">+                            Field(
</a><a href="#h18-0-187" id="h18-0-187" class="i">+                                None,
</a><a href="#h18-0-188" id="h18-0-188" class="i">+                                &quot;f&quot;,
</a><a href="#h18-0-189" id="h18-0-189" class="i">+                            ),
</a><a href="#h18-0-190" id="h18-0-190" class="i">+                        ),
</a><a href="#h18-0-191" id="h18-0-191" class="i">+                    ),
</a><a href="#h18-0-192" id="h18-0-192" class="i">+                },
</a><a href="#h18-0-193" id="h18-0-193" class="i">+                labels: [
</a><a href="#h18-0-194" id="h18-0-194" class="i">+                    None,
</a><a href="#h18-0-195" id="h18-0-195" class="i">+                    None,
</a><a href="#h18-0-196" id="h18-0-196" class="i">+                    None,
</a><a href="#h18-0-197" id="h18-0-197" class="i">+                    None,
</a><a href="#h18-0-198" id="h18-0-198" class="i">+                    None,
</a><a href="#h18-0-199" id="h18-0-199" class="i">+                ],
</a><a href="#h18-0-200" id="h18-0-200" class="i">+                expressions: [
</a><a href="#h18-0-201" id="h18-0-201" class="i">+                    Field(
</a><a href="#h18-0-202" id="h18-0-202" class="i">+                        None,
</a><a href="#h18-0-203" id="h18-0-203" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-204" id="h18-0-204" class="i">+                    ),
</a><a href="#h18-0-205" id="h18-0-205" class="i">+                    Field(
</a><a href="#h18-0-206" id="h18-0-206" class="i">+                        None,
</a><a href="#h18-0-207" id="h18-0-207" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-208" id="h18-0-208" class="i">+                    ),
</a><a href="#h18-0-209" id="h18-0-209" class="i">+                    Field(
</a><a href="#h18-0-210" id="h18-0-210" class="i">+                        None,
</a><a href="#h18-0-211" id="h18-0-211" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-212" id="h18-0-212" class="i">+                    ),
</a><a href="#h18-0-213" id="h18-0-213" class="i">+                    Field(
</a><a href="#h18-0-214" id="h18-0-214" class="i">+                        None,
</a><a href="#h18-0-215" id="h18-0-215" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-216" id="h18-0-216" class="i">+                    ),
</a><a href="#h18-0-217" id="h18-0-217" class="i">+                    Field(
</a><a href="#h18-0-218" id="h18-0-218" class="i">+                        None,
</a><a href="#h18-0-219" id="h18-0-219" class="i">+                        &quot;f&quot;,
</a><a href="#h18-0-220" id="h18-0-220" class="i">+                    ),
</a><a href="#h18-0-221" id="h18-0-221" class="i">+                ],
</a><a href="#h18-0-222" id="h18-0-222" class="i">+            },
</a><a href="#h18-0-223" id="h18-0-223" class="i">+            aggregates: [
</a><a href="#h18-0-224" id="h18-0-224" class="i">+                Min,
</a><a href="#h18-0-225" id="h18-0-225" class="i">+                Max,
</a><a href="#h18-0-226" id="h18-0-226" class="i">+                Sum,
</a><a href="#h18-0-227" id="h18-0-227" class="i">+                Count,
</a><a href="#h18-0-228" id="h18-0-228" class="i">+                Average,
</a><a href="#h18-0-229" id="h18-0-229" class="i">+            ],
</a><a href="#h18-0-230" id="h18-0-230" class="i">+        },
</a><a href="#h18-0-231" id="h18-0-231" class="i">+        labels: [
</a><a href="#h18-0-232" id="h18-0-232" class="i">+            None,
</a><a href="#h18-0-233" id="h18-0-233" class="i">+            None,
</a><a href="#h18-0-234" id="h18-0-234" class="i">+            None,
</a><a href="#h18-0-235" id="h18-0-235" class="i">+            None,
</a><a href="#h18-0-236" id="h18-0-236" class="i">+            None,
</a><a href="#h18-0-237" id="h18-0-237" class="i">+        ],
</a><a href="#h18-0-238" id="h18-0-238" class="i">+        expressions: [
</a><a href="#h18-0-239" id="h18-0-239" class="i">+            Column(
</a><a href="#h18-0-240" id="h18-0-240" class="i">+                0,
</a><a href="#h18-0-241" id="h18-0-241" class="i">+            ),
</a><a href="#h18-0-242" id="h18-0-242" class="i">+            Column(
</a><a href="#h18-0-243" id="h18-0-243" class="i">+                1,
</a><a href="#h18-0-244" id="h18-0-244" class="i">+            ),
</a><a href="#h18-0-245" id="h18-0-245" class="i">+            Column(
</a><a href="#h18-0-246" id="h18-0-246" class="i">+                2,
</a><a href="#h18-0-247" id="h18-0-247" class="i">+            ),
</a><a href="#h18-0-248" id="h18-0-248" class="i">+            Column(
</a><a href="#h18-0-249" id="h18-0-249" class="i">+                3,
</a><a href="#h18-0-250" id="h18-0-250" class="i">+            ),
</a><a href="#h18-0-251" id="h18-0-251" class="i">+            Column(
</a><a href="#h18-0-252" id="h18-0-252" class="i">+                4,
</a><a href="#h18-0-253" id="h18-0-253" class="i">+            ),
</a><a href="#h18-0-254" id="h18-0-254" class="i">+        ],
</a><a href="#h18-0-255" id="h18-0-255" class="i">+    },
</a><a href="#h18-0-256" id="h18-0-256" class="i">+}
</a><a href="#h18-0-257" id="h18-0-257" class="i">+
</a><a href="#h18-0-258" id="h18-0-258" class="i">+Query: SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats WHERE f IS NOT NULL
</a><a href="#h18-0-259" id="h18-0-259" class="i">+
</a><a href="#h18-0-260" id="h18-0-260" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h18-0-261" id="h18-0-261" class="i">+[Float(-2.718), Float(3.14), Float(2.04), Integer(4), Float(0.51)]
</a><b>diff --git a/<a id="h19" href="../file/src/sql/tests/query/agg_float_null.html">src/sql/tests/query/agg_float_null</a> b/<a href="../file/src/sql/tests/query/agg_float_null.html">src/sql/tests/query/agg_float_null</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -0,0 +1,227 @@
</a><a href="#h19-0-0" id="h19-0-0" class="i">+Query: SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats
</a><a href="#h19-0-1" id="h19-0-1" class="i">+
</a><a href="#h19-0-2" id="h19-0-2" class="i">+AST: Select {
</a><a href="#h19-0-3" id="h19-0-3" class="i">+    select: SelectClause {
</a><a href="#h19-0-4" id="h19-0-4" class="i">+        expressions: [
</a><a href="#h19-0-5" id="h19-0-5" class="i">+            Function(
</a><a href="#h19-0-6" id="h19-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h19-0-7" id="h19-0-7" class="i">+                [
</a><a href="#h19-0-8" id="h19-0-8" class="i">+                    Field(
</a><a href="#h19-0-9" id="h19-0-9" class="i">+                        None,
</a><a href="#h19-0-10" id="h19-0-10" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-11" id="h19-0-11" class="i">+                    ),
</a><a href="#h19-0-12" id="h19-0-12" class="i">+                ],
</a><a href="#h19-0-13" id="h19-0-13" class="i">+            ),
</a><a href="#h19-0-14" id="h19-0-14" class="i">+            Function(
</a><a href="#h19-0-15" id="h19-0-15" class="i">+                &quot;max&quot;,
</a><a href="#h19-0-16" id="h19-0-16" class="i">+                [
</a><a href="#h19-0-17" id="h19-0-17" class="i">+                    Field(
</a><a href="#h19-0-18" id="h19-0-18" class="i">+                        None,
</a><a href="#h19-0-19" id="h19-0-19" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-20" id="h19-0-20" class="i">+                    ),
</a><a href="#h19-0-21" id="h19-0-21" class="i">+                ],
</a><a href="#h19-0-22" id="h19-0-22" class="i">+            ),
</a><a href="#h19-0-23" id="h19-0-23" class="i">+            Function(
</a><a href="#h19-0-24" id="h19-0-24" class="i">+                &quot;sum&quot;,
</a><a href="#h19-0-25" id="h19-0-25" class="i">+                [
</a><a href="#h19-0-26" id="h19-0-26" class="i">+                    Field(
</a><a href="#h19-0-27" id="h19-0-27" class="i">+                        None,
</a><a href="#h19-0-28" id="h19-0-28" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-29" id="h19-0-29" class="i">+                    ),
</a><a href="#h19-0-30" id="h19-0-30" class="i">+                ],
</a><a href="#h19-0-31" id="h19-0-31" class="i">+            ),
</a><a href="#h19-0-32" id="h19-0-32" class="i">+            Function(
</a><a href="#h19-0-33" id="h19-0-33" class="i">+                &quot;count&quot;,
</a><a href="#h19-0-34" id="h19-0-34" class="i">+                [
</a><a href="#h19-0-35" id="h19-0-35" class="i">+                    Field(
</a><a href="#h19-0-36" id="h19-0-36" class="i">+                        None,
</a><a href="#h19-0-37" id="h19-0-37" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-38" id="h19-0-38" class="i">+                    ),
</a><a href="#h19-0-39" id="h19-0-39" class="i">+                ],
</a><a href="#h19-0-40" id="h19-0-40" class="i">+            ),
</a><a href="#h19-0-41" id="h19-0-41" class="i">+            Function(
</a><a href="#h19-0-42" id="h19-0-42" class="i">+                &quot;avg&quot;,
</a><a href="#h19-0-43" id="h19-0-43" class="i">+                [
</a><a href="#h19-0-44" id="h19-0-44" class="i">+                    Field(
</a><a href="#h19-0-45" id="h19-0-45" class="i">+                        None,
</a><a href="#h19-0-46" id="h19-0-46" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-47" id="h19-0-47" class="i">+                    ),
</a><a href="#h19-0-48" id="h19-0-48" class="i">+                ],
</a><a href="#h19-0-49" id="h19-0-49" class="i">+            ),
</a><a href="#h19-0-50" id="h19-0-50" class="i">+        ],
</a><a href="#h19-0-51" id="h19-0-51" class="i">+        labels: [
</a><a href="#h19-0-52" id="h19-0-52" class="i">+            None,
</a><a href="#h19-0-53" id="h19-0-53" class="i">+            None,
</a><a href="#h19-0-54" id="h19-0-54" class="i">+            None,
</a><a href="#h19-0-55" id="h19-0-55" class="i">+            None,
</a><a href="#h19-0-56" id="h19-0-56" class="i">+            None,
</a><a href="#h19-0-57" id="h19-0-57" class="i">+        ],
</a><a href="#h19-0-58" id="h19-0-58" class="i">+    },
</a><a href="#h19-0-59" id="h19-0-59" class="i">+    from: Some(
</a><a href="#h19-0-60" id="h19-0-60" class="i">+        FromClause {
</a><a href="#h19-0-61" id="h19-0-61" class="i">+            items: [
</a><a href="#h19-0-62" id="h19-0-62" class="i">+                Table {
</a><a href="#h19-0-63" id="h19-0-63" class="i">+                    name: &quot;floats&quot;,
</a><a href="#h19-0-64" id="h19-0-64" class="i">+                    alias: None,
</a><a href="#h19-0-65" id="h19-0-65" class="i">+                },
</a><a href="#h19-0-66" id="h19-0-66" class="i">+            ],
</a><a href="#h19-0-67" id="h19-0-67" class="i">+        },
</a><a href="#h19-0-68" id="h19-0-68" class="i">+    ),
</a><a href="#h19-0-69" id="h19-0-69" class="i">+    where: None,
</a><a href="#h19-0-70" id="h19-0-70" class="i">+    group_by: None,
</a><a href="#h19-0-71" id="h19-0-71" class="i">+    having: None,
</a><a href="#h19-0-72" id="h19-0-72" class="i">+    order: [],
</a><a href="#h19-0-73" id="h19-0-73" class="i">+    limit: None,
</a><a href="#h19-0-74" id="h19-0-74" class="i">+    offset: None,
</a><a href="#h19-0-75" id="h19-0-75" class="i">+}
</a><a href="#h19-0-76" id="h19-0-76" class="i">+
</a><a href="#h19-0-77" id="h19-0-77" class="i">+Plan: Plan {
</a><a href="#h19-0-78" id="h19-0-78" class="i">+    root: Projection {
</a><a href="#h19-0-79" id="h19-0-79" class="i">+        source: Aggregation {
</a><a href="#h19-0-80" id="h19-0-80" class="i">+            source: Projection {
</a><a href="#h19-0-81" id="h19-0-81" class="i">+                source: Scan {
</a><a href="#h19-0-82" id="h19-0-82" class="i">+                    table: &quot;floats&quot;,
</a><a href="#h19-0-83" id="h19-0-83" class="i">+                    alias: None,
</a><a href="#h19-0-84" id="h19-0-84" class="i">+                },
</a><a href="#h19-0-85" id="h19-0-85" class="i">+                labels: [
</a><a href="#h19-0-86" id="h19-0-86" class="i">+                    None,
</a><a href="#h19-0-87" id="h19-0-87" class="i">+                    None,
</a><a href="#h19-0-88" id="h19-0-88" class="i">+                    None,
</a><a href="#h19-0-89" id="h19-0-89" class="i">+                    None,
</a><a href="#h19-0-90" id="h19-0-90" class="i">+                    None,
</a><a href="#h19-0-91" id="h19-0-91" class="i">+                ],
</a><a href="#h19-0-92" id="h19-0-92" class="i">+                expressions: [
</a><a href="#h19-0-93" id="h19-0-93" class="i">+                    Field(
</a><a href="#h19-0-94" id="h19-0-94" class="i">+                        None,
</a><a href="#h19-0-95" id="h19-0-95" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-96" id="h19-0-96" class="i">+                    ),
</a><a href="#h19-0-97" id="h19-0-97" class="i">+                    Field(
</a><a href="#h19-0-98" id="h19-0-98" class="i">+                        None,
</a><a href="#h19-0-99" id="h19-0-99" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-100" id="h19-0-100" class="i">+                    ),
</a><a href="#h19-0-101" id="h19-0-101" class="i">+                    Field(
</a><a href="#h19-0-102" id="h19-0-102" class="i">+                        None,
</a><a href="#h19-0-103" id="h19-0-103" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-104" id="h19-0-104" class="i">+                    ),
</a><a href="#h19-0-105" id="h19-0-105" class="i">+                    Field(
</a><a href="#h19-0-106" id="h19-0-106" class="i">+                        None,
</a><a href="#h19-0-107" id="h19-0-107" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-108" id="h19-0-108" class="i">+                    ),
</a><a href="#h19-0-109" id="h19-0-109" class="i">+                    Field(
</a><a href="#h19-0-110" id="h19-0-110" class="i">+                        None,
</a><a href="#h19-0-111" id="h19-0-111" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-112" id="h19-0-112" class="i">+                    ),
</a><a href="#h19-0-113" id="h19-0-113" class="i">+                ],
</a><a href="#h19-0-114" id="h19-0-114" class="i">+            },
</a><a href="#h19-0-115" id="h19-0-115" class="i">+            aggregates: [
</a><a href="#h19-0-116" id="h19-0-116" class="i">+                Min,
</a><a href="#h19-0-117" id="h19-0-117" class="i">+                Max,
</a><a href="#h19-0-118" id="h19-0-118" class="i">+                Sum,
</a><a href="#h19-0-119" id="h19-0-119" class="i">+                Count,
</a><a href="#h19-0-120" id="h19-0-120" class="i">+                Average,
</a><a href="#h19-0-121" id="h19-0-121" class="i">+            ],
</a><a href="#h19-0-122" id="h19-0-122" class="i">+        },
</a><a href="#h19-0-123" id="h19-0-123" class="i">+        labels: [
</a><a href="#h19-0-124" id="h19-0-124" class="i">+            None,
</a><a href="#h19-0-125" id="h19-0-125" class="i">+            None,
</a><a href="#h19-0-126" id="h19-0-126" class="i">+            None,
</a><a href="#h19-0-127" id="h19-0-127" class="i">+            None,
</a><a href="#h19-0-128" id="h19-0-128" class="i">+            None,
</a><a href="#h19-0-129" id="h19-0-129" class="i">+        ],
</a><a href="#h19-0-130" id="h19-0-130" class="i">+        expressions: [
</a><a href="#h19-0-131" id="h19-0-131" class="i">+            Column(
</a><a href="#h19-0-132" id="h19-0-132" class="i">+                0,
</a><a href="#h19-0-133" id="h19-0-133" class="i">+            ),
</a><a href="#h19-0-134" id="h19-0-134" class="i">+            Column(
</a><a href="#h19-0-135" id="h19-0-135" class="i">+                1,
</a><a href="#h19-0-136" id="h19-0-136" class="i">+            ),
</a><a href="#h19-0-137" id="h19-0-137" class="i">+            Column(
</a><a href="#h19-0-138" id="h19-0-138" class="i">+                2,
</a><a href="#h19-0-139" id="h19-0-139" class="i">+            ),
</a><a href="#h19-0-140" id="h19-0-140" class="i">+            Column(
</a><a href="#h19-0-141" id="h19-0-141" class="i">+                3,
</a><a href="#h19-0-142" id="h19-0-142" class="i">+            ),
</a><a href="#h19-0-143" id="h19-0-143" class="i">+            Column(
</a><a href="#h19-0-144" id="h19-0-144" class="i">+                4,
</a><a href="#h19-0-145" id="h19-0-145" class="i">+            ),
</a><a href="#h19-0-146" id="h19-0-146" class="i">+        ],
</a><a href="#h19-0-147" id="h19-0-147" class="i">+    },
</a><a href="#h19-0-148" id="h19-0-148" class="i">+}
</a><a href="#h19-0-149" id="h19-0-149" class="i">+
</a><a href="#h19-0-150" id="h19-0-150" class="i">+Optimized plan: Plan {
</a><a href="#h19-0-151" id="h19-0-151" class="i">+    root: Projection {
</a><a href="#h19-0-152" id="h19-0-152" class="i">+        source: Aggregation {
</a><a href="#h19-0-153" id="h19-0-153" class="i">+            source: Projection {
</a><a href="#h19-0-154" id="h19-0-154" class="i">+                source: Scan {
</a><a href="#h19-0-155" id="h19-0-155" class="i">+                    table: &quot;floats&quot;,
</a><a href="#h19-0-156" id="h19-0-156" class="i">+                    alias: None,
</a><a href="#h19-0-157" id="h19-0-157" class="i">+                },
</a><a href="#h19-0-158" id="h19-0-158" class="i">+                labels: [
</a><a href="#h19-0-159" id="h19-0-159" class="i">+                    None,
</a><a href="#h19-0-160" id="h19-0-160" class="i">+                    None,
</a><a href="#h19-0-161" id="h19-0-161" class="i">+                    None,
</a><a href="#h19-0-162" id="h19-0-162" class="i">+                    None,
</a><a href="#h19-0-163" id="h19-0-163" class="i">+                    None,
</a><a href="#h19-0-164" id="h19-0-164" class="i">+                ],
</a><a href="#h19-0-165" id="h19-0-165" class="i">+                expressions: [
</a><a href="#h19-0-166" id="h19-0-166" class="i">+                    Field(
</a><a href="#h19-0-167" id="h19-0-167" class="i">+                        None,
</a><a href="#h19-0-168" id="h19-0-168" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-169" id="h19-0-169" class="i">+                    ),
</a><a href="#h19-0-170" id="h19-0-170" class="i">+                    Field(
</a><a href="#h19-0-171" id="h19-0-171" class="i">+                        None,
</a><a href="#h19-0-172" id="h19-0-172" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-173" id="h19-0-173" class="i">+                    ),
</a><a href="#h19-0-174" id="h19-0-174" class="i">+                    Field(
</a><a href="#h19-0-175" id="h19-0-175" class="i">+                        None,
</a><a href="#h19-0-176" id="h19-0-176" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-177" id="h19-0-177" class="i">+                    ),
</a><a href="#h19-0-178" id="h19-0-178" class="i">+                    Field(
</a><a href="#h19-0-179" id="h19-0-179" class="i">+                        None,
</a><a href="#h19-0-180" id="h19-0-180" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-181" id="h19-0-181" class="i">+                    ),
</a><a href="#h19-0-182" id="h19-0-182" class="i">+                    Field(
</a><a href="#h19-0-183" id="h19-0-183" class="i">+                        None,
</a><a href="#h19-0-184" id="h19-0-184" class="i">+                        &quot;f&quot;,
</a><a href="#h19-0-185" id="h19-0-185" class="i">+                    ),
</a><a href="#h19-0-186" id="h19-0-186" class="i">+                ],
</a><a href="#h19-0-187" id="h19-0-187" class="i">+            },
</a><a href="#h19-0-188" id="h19-0-188" class="i">+            aggregates: [
</a><a href="#h19-0-189" id="h19-0-189" class="i">+                Min,
</a><a href="#h19-0-190" id="h19-0-190" class="i">+                Max,
</a><a href="#h19-0-191" id="h19-0-191" class="i">+                Sum,
</a><a href="#h19-0-192" id="h19-0-192" class="i">+                Count,
</a><a href="#h19-0-193" id="h19-0-193" class="i">+                Average,
</a><a href="#h19-0-194" id="h19-0-194" class="i">+            ],
</a><a href="#h19-0-195" id="h19-0-195" class="i">+        },
</a><a href="#h19-0-196" id="h19-0-196" class="i">+        labels: [
</a><a href="#h19-0-197" id="h19-0-197" class="i">+            None,
</a><a href="#h19-0-198" id="h19-0-198" class="i">+            None,
</a><a href="#h19-0-199" id="h19-0-199" class="i">+            None,
</a><a href="#h19-0-200" id="h19-0-200" class="i">+            None,
</a><a href="#h19-0-201" id="h19-0-201" class="i">+            None,
</a><a href="#h19-0-202" id="h19-0-202" class="i">+        ],
</a><a href="#h19-0-203" id="h19-0-203" class="i">+        expressions: [
</a><a href="#h19-0-204" id="h19-0-204" class="i">+            Column(
</a><a href="#h19-0-205" id="h19-0-205" class="i">+                0,
</a><a href="#h19-0-206" id="h19-0-206" class="i">+            ),
</a><a href="#h19-0-207" id="h19-0-207" class="i">+            Column(
</a><a href="#h19-0-208" id="h19-0-208" class="i">+                1,
</a><a href="#h19-0-209" id="h19-0-209" class="i">+            ),
</a><a href="#h19-0-210" id="h19-0-210" class="i">+            Column(
</a><a href="#h19-0-211" id="h19-0-211" class="i">+                2,
</a><a href="#h19-0-212" id="h19-0-212" class="i">+            ),
</a><a href="#h19-0-213" id="h19-0-213" class="i">+            Column(
</a><a href="#h19-0-214" id="h19-0-214" class="i">+                3,
</a><a href="#h19-0-215" id="h19-0-215" class="i">+            ),
</a><a href="#h19-0-216" id="h19-0-216" class="i">+            Column(
</a><a href="#h19-0-217" id="h19-0-217" class="i">+                4,
</a><a href="#h19-0-218" id="h19-0-218" class="i">+            ),
</a><a href="#h19-0-219" id="h19-0-219" class="i">+        ],
</a><a href="#h19-0-220" id="h19-0-220" class="i">+    },
</a><a href="#h19-0-221" id="h19-0-221" class="i">+}
</a><a href="#h19-0-222" id="h19-0-222" class="i">+
</a><a href="#h19-0-223" id="h19-0-223" class="i">+Query: SELECT MIN(f), MAX(f), SUM(f), COUNT(f), AVG(f) FROM floats
</a><a href="#h19-0-224" id="h19-0-224" class="i">+
</a><a href="#h19-0-225" id="h19-0-225" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h19-0-226" id="h19-0-226" class="i">+[Null, Null, Null, Integer(4), Null]
</a><b>diff --git a/<a id="h20" href="../file/src/sql/tests/query/agg_integer.html">src/sql/tests/query/agg_integer</a> b/<a href="../file/src/sql/tests/query/agg_integer.html">src/sql/tests/query/agg_integer</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -0,0 +1,262 @@
</a><a href="#h20-0-0" id="h20-0-0" class="i">+Query: SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers WHERE i IS NOT NULL
</a><a href="#h20-0-1" id="h20-0-1" class="i">+
</a><a href="#h20-0-2" id="h20-0-2" class="i">+AST: Select {
</a><a href="#h20-0-3" id="h20-0-3" class="i">+    select: SelectClause {
</a><a href="#h20-0-4" id="h20-0-4" class="i">+        expressions: [
</a><a href="#h20-0-5" id="h20-0-5" class="i">+            Function(
</a><a href="#h20-0-6" id="h20-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h20-0-7" id="h20-0-7" class="i">+                [
</a><a href="#h20-0-8" id="h20-0-8" class="i">+                    Field(
</a><a href="#h20-0-9" id="h20-0-9" class="i">+                        None,
</a><a href="#h20-0-10" id="h20-0-10" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-11" id="h20-0-11" class="i">+                    ),
</a><a href="#h20-0-12" id="h20-0-12" class="i">+                ],
</a><a href="#h20-0-13" id="h20-0-13" class="i">+            ),
</a><a href="#h20-0-14" id="h20-0-14" class="i">+            Function(
</a><a href="#h20-0-15" id="h20-0-15" class="i">+                &quot;max&quot;,
</a><a href="#h20-0-16" id="h20-0-16" class="i">+                [
</a><a href="#h20-0-17" id="h20-0-17" class="i">+                    Field(
</a><a href="#h20-0-18" id="h20-0-18" class="i">+                        None,
</a><a href="#h20-0-19" id="h20-0-19" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-20" id="h20-0-20" class="i">+                    ),
</a><a href="#h20-0-21" id="h20-0-21" class="i">+                ],
</a><a href="#h20-0-22" id="h20-0-22" class="i">+            ),
</a><a href="#h20-0-23" id="h20-0-23" class="i">+            Function(
</a><a href="#h20-0-24" id="h20-0-24" class="i">+                &quot;sum&quot;,
</a><a href="#h20-0-25" id="h20-0-25" class="i">+                [
</a><a href="#h20-0-26" id="h20-0-26" class="i">+                    Field(
</a><a href="#h20-0-27" id="h20-0-27" class="i">+                        None,
</a><a href="#h20-0-28" id="h20-0-28" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-29" id="h20-0-29" class="i">+                    ),
</a><a href="#h20-0-30" id="h20-0-30" class="i">+                ],
</a><a href="#h20-0-31" id="h20-0-31" class="i">+            ),
</a><a href="#h20-0-32" id="h20-0-32" class="i">+            Function(
</a><a href="#h20-0-33" id="h20-0-33" class="i">+                &quot;count&quot;,
</a><a href="#h20-0-34" id="h20-0-34" class="i">+                [
</a><a href="#h20-0-35" id="h20-0-35" class="i">+                    Field(
</a><a href="#h20-0-36" id="h20-0-36" class="i">+                        None,
</a><a href="#h20-0-37" id="h20-0-37" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-38" id="h20-0-38" class="i">+                    ),
</a><a href="#h20-0-39" id="h20-0-39" class="i">+                ],
</a><a href="#h20-0-40" id="h20-0-40" class="i">+            ),
</a><a href="#h20-0-41" id="h20-0-41" class="i">+            Function(
</a><a href="#h20-0-42" id="h20-0-42" class="i">+                &quot;avg&quot;,
</a><a href="#h20-0-43" id="h20-0-43" class="i">+                [
</a><a href="#h20-0-44" id="h20-0-44" class="i">+                    Field(
</a><a href="#h20-0-45" id="h20-0-45" class="i">+                        None,
</a><a href="#h20-0-46" id="h20-0-46" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-47" id="h20-0-47" class="i">+                    ),
</a><a href="#h20-0-48" id="h20-0-48" class="i">+                ],
</a><a href="#h20-0-49" id="h20-0-49" class="i">+            ),
</a><a href="#h20-0-50" id="h20-0-50" class="i">+        ],
</a><a href="#h20-0-51" id="h20-0-51" class="i">+        labels: [
</a><a href="#h20-0-52" id="h20-0-52" class="i">+            None,
</a><a href="#h20-0-53" id="h20-0-53" class="i">+            None,
</a><a href="#h20-0-54" id="h20-0-54" class="i">+            None,
</a><a href="#h20-0-55" id="h20-0-55" class="i">+            None,
</a><a href="#h20-0-56" id="h20-0-56" class="i">+            None,
</a><a href="#h20-0-57" id="h20-0-57" class="i">+        ],
</a><a href="#h20-0-58" id="h20-0-58" class="i">+    },
</a><a href="#h20-0-59" id="h20-0-59" class="i">+    from: Some(
</a><a href="#h20-0-60" id="h20-0-60" class="i">+        FromClause {
</a><a href="#h20-0-61" id="h20-0-61" class="i">+            items: [
</a><a href="#h20-0-62" id="h20-0-62" class="i">+                Table {
</a><a href="#h20-0-63" id="h20-0-63" class="i">+                    name: &quot;integers&quot;,
</a><a href="#h20-0-64" id="h20-0-64" class="i">+                    alias: None,
</a><a href="#h20-0-65" id="h20-0-65" class="i">+                },
</a><a href="#h20-0-66" id="h20-0-66" class="i">+            ],
</a><a href="#h20-0-67" id="h20-0-67" class="i">+        },
</a><a href="#h20-0-68" id="h20-0-68" class="i">+    ),
</a><a href="#h20-0-69" id="h20-0-69" class="i">+    where: Some(
</a><a href="#h20-0-70" id="h20-0-70" class="i">+        WhereClause(
</a><a href="#h20-0-71" id="h20-0-71" class="i">+            Operation(
</a><a href="#h20-0-72" id="h20-0-72" class="i">+                Not(
</a><a href="#h20-0-73" id="h20-0-73" class="i">+                    Operation(
</a><a href="#h20-0-74" id="h20-0-74" class="i">+                        IsNull(
</a><a href="#h20-0-75" id="h20-0-75" class="i">+                            Field(
</a><a href="#h20-0-76" id="h20-0-76" class="i">+                                None,
</a><a href="#h20-0-77" id="h20-0-77" class="i">+                                &quot;i&quot;,
</a><a href="#h20-0-78" id="h20-0-78" class="i">+                            ),
</a><a href="#h20-0-79" id="h20-0-79" class="i">+                        ),
</a><a href="#h20-0-80" id="h20-0-80" class="i">+                    ),
</a><a href="#h20-0-81" id="h20-0-81" class="i">+                ),
</a><a href="#h20-0-82" id="h20-0-82" class="i">+            ),
</a><a href="#h20-0-83" id="h20-0-83" class="i">+        ),
</a><a href="#h20-0-84" id="h20-0-84" class="i">+    ),
</a><a href="#h20-0-85" id="h20-0-85" class="i">+    group_by: None,
</a><a href="#h20-0-86" id="h20-0-86" class="i">+    having: None,
</a><a href="#h20-0-87" id="h20-0-87" class="i">+    order: [],
</a><a href="#h20-0-88" id="h20-0-88" class="i">+    limit: None,
</a><a href="#h20-0-89" id="h20-0-89" class="i">+    offset: None,
</a><a href="#h20-0-90" id="h20-0-90" class="i">+}
</a><a href="#h20-0-91" id="h20-0-91" class="i">+
</a><a href="#h20-0-92" id="h20-0-92" class="i">+Plan: Plan {
</a><a href="#h20-0-93" id="h20-0-93" class="i">+    root: Projection {
</a><a href="#h20-0-94" id="h20-0-94" class="i">+        source: Aggregation {
</a><a href="#h20-0-95" id="h20-0-95" class="i">+            source: Projection {
</a><a href="#h20-0-96" id="h20-0-96" class="i">+                source: Filter {
</a><a href="#h20-0-97" id="h20-0-97" class="i">+                    source: Scan {
</a><a href="#h20-0-98" id="h20-0-98" class="i">+                        table: &quot;integers&quot;,
</a><a href="#h20-0-99" id="h20-0-99" class="i">+                        alias: None,
</a><a href="#h20-0-100" id="h20-0-100" class="i">+                    },
</a><a href="#h20-0-101" id="h20-0-101" class="i">+                    predicate: Not(
</a><a href="#h20-0-102" id="h20-0-102" class="i">+                        IsNull(
</a><a href="#h20-0-103" id="h20-0-103" class="i">+                            Field(
</a><a href="#h20-0-104" id="h20-0-104" class="i">+                                None,
</a><a href="#h20-0-105" id="h20-0-105" class="i">+                                &quot;i&quot;,
</a><a href="#h20-0-106" id="h20-0-106" class="i">+                            ),
</a><a href="#h20-0-107" id="h20-0-107" class="i">+                        ),
</a><a href="#h20-0-108" id="h20-0-108" class="i">+                    ),
</a><a href="#h20-0-109" id="h20-0-109" class="i">+                },
</a><a href="#h20-0-110" id="h20-0-110" class="i">+                labels: [
</a><a href="#h20-0-111" id="h20-0-111" class="i">+                    None,
</a><a href="#h20-0-112" id="h20-0-112" class="i">+                    None,
</a><a href="#h20-0-113" id="h20-0-113" class="i">+                    None,
</a><a href="#h20-0-114" id="h20-0-114" class="i">+                    None,
</a><a href="#h20-0-115" id="h20-0-115" class="i">+                    None,
</a><a href="#h20-0-116" id="h20-0-116" class="i">+                ],
</a><a href="#h20-0-117" id="h20-0-117" class="i">+                expressions: [
</a><a href="#h20-0-118" id="h20-0-118" class="i">+                    Field(
</a><a href="#h20-0-119" id="h20-0-119" class="i">+                        None,
</a><a href="#h20-0-120" id="h20-0-120" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-121" id="h20-0-121" class="i">+                    ),
</a><a href="#h20-0-122" id="h20-0-122" class="i">+                    Field(
</a><a href="#h20-0-123" id="h20-0-123" class="i">+                        None,
</a><a href="#h20-0-124" id="h20-0-124" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-125" id="h20-0-125" class="i">+                    ),
</a><a href="#h20-0-126" id="h20-0-126" class="i">+                    Field(
</a><a href="#h20-0-127" id="h20-0-127" class="i">+                        None,
</a><a href="#h20-0-128" id="h20-0-128" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-129" id="h20-0-129" class="i">+                    ),
</a><a href="#h20-0-130" id="h20-0-130" class="i">+                    Field(
</a><a href="#h20-0-131" id="h20-0-131" class="i">+                        None,
</a><a href="#h20-0-132" id="h20-0-132" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-133" id="h20-0-133" class="i">+                    ),
</a><a href="#h20-0-134" id="h20-0-134" class="i">+                    Field(
</a><a href="#h20-0-135" id="h20-0-135" class="i">+                        None,
</a><a href="#h20-0-136" id="h20-0-136" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-137" id="h20-0-137" class="i">+                    ),
</a><a href="#h20-0-138" id="h20-0-138" class="i">+                ],
</a><a href="#h20-0-139" id="h20-0-139" class="i">+            },
</a><a href="#h20-0-140" id="h20-0-140" class="i">+            aggregates: [
</a><a href="#h20-0-141" id="h20-0-141" class="i">+                Min,
</a><a href="#h20-0-142" id="h20-0-142" class="i">+                Max,
</a><a href="#h20-0-143" id="h20-0-143" class="i">+                Sum,
</a><a href="#h20-0-144" id="h20-0-144" class="i">+                Count,
</a><a href="#h20-0-145" id="h20-0-145" class="i">+                Average,
</a><a href="#h20-0-146" id="h20-0-146" class="i">+            ],
</a><a href="#h20-0-147" id="h20-0-147" class="i">+        },
</a><a href="#h20-0-148" id="h20-0-148" class="i">+        labels: [
</a><a href="#h20-0-149" id="h20-0-149" class="i">+            None,
</a><a href="#h20-0-150" id="h20-0-150" class="i">+            None,
</a><a href="#h20-0-151" id="h20-0-151" class="i">+            None,
</a><a href="#h20-0-152" id="h20-0-152" class="i">+            None,
</a><a href="#h20-0-153" id="h20-0-153" class="i">+            None,
</a><a href="#h20-0-154" id="h20-0-154" class="i">+        ],
</a><a href="#h20-0-155" id="h20-0-155" class="i">+        expressions: [
</a><a href="#h20-0-156" id="h20-0-156" class="i">+            Column(
</a><a href="#h20-0-157" id="h20-0-157" class="i">+                0,
</a><a href="#h20-0-158" id="h20-0-158" class="i">+            ),
</a><a href="#h20-0-159" id="h20-0-159" class="i">+            Column(
</a><a href="#h20-0-160" id="h20-0-160" class="i">+                1,
</a><a href="#h20-0-161" id="h20-0-161" class="i">+            ),
</a><a href="#h20-0-162" id="h20-0-162" class="i">+            Column(
</a><a href="#h20-0-163" id="h20-0-163" class="i">+                2,
</a><a href="#h20-0-164" id="h20-0-164" class="i">+            ),
</a><a href="#h20-0-165" id="h20-0-165" class="i">+            Column(
</a><a href="#h20-0-166" id="h20-0-166" class="i">+                3,
</a><a href="#h20-0-167" id="h20-0-167" class="i">+            ),
</a><a href="#h20-0-168" id="h20-0-168" class="i">+            Column(
</a><a href="#h20-0-169" id="h20-0-169" class="i">+                4,
</a><a href="#h20-0-170" id="h20-0-170" class="i">+            ),
</a><a href="#h20-0-171" id="h20-0-171" class="i">+        ],
</a><a href="#h20-0-172" id="h20-0-172" class="i">+    },
</a><a href="#h20-0-173" id="h20-0-173" class="i">+}
</a><a href="#h20-0-174" id="h20-0-174" class="i">+
</a><a href="#h20-0-175" id="h20-0-175" class="i">+Optimized plan: Plan {
</a><a href="#h20-0-176" id="h20-0-176" class="i">+    root: Projection {
</a><a href="#h20-0-177" id="h20-0-177" class="i">+        source: Aggregation {
</a><a href="#h20-0-178" id="h20-0-178" class="i">+            source: Projection {
</a><a href="#h20-0-179" id="h20-0-179" class="i">+                source: Filter {
</a><a href="#h20-0-180" id="h20-0-180" class="i">+                    source: Scan {
</a><a href="#h20-0-181" id="h20-0-181" class="i">+                        table: &quot;integers&quot;,
</a><a href="#h20-0-182" id="h20-0-182" class="i">+                        alias: None,
</a><a href="#h20-0-183" id="h20-0-183" class="i">+                    },
</a><a href="#h20-0-184" id="h20-0-184" class="i">+                    predicate: Not(
</a><a href="#h20-0-185" id="h20-0-185" class="i">+                        IsNull(
</a><a href="#h20-0-186" id="h20-0-186" class="i">+                            Field(
</a><a href="#h20-0-187" id="h20-0-187" class="i">+                                None,
</a><a href="#h20-0-188" id="h20-0-188" class="i">+                                &quot;i&quot;,
</a><a href="#h20-0-189" id="h20-0-189" class="i">+                            ),
</a><a href="#h20-0-190" id="h20-0-190" class="i">+                        ),
</a><a href="#h20-0-191" id="h20-0-191" class="i">+                    ),
</a><a href="#h20-0-192" id="h20-0-192" class="i">+                },
</a><a href="#h20-0-193" id="h20-0-193" class="i">+                labels: [
</a><a href="#h20-0-194" id="h20-0-194" class="i">+                    None,
</a><a href="#h20-0-195" id="h20-0-195" class="i">+                    None,
</a><a href="#h20-0-196" id="h20-0-196" class="i">+                    None,
</a><a href="#h20-0-197" id="h20-0-197" class="i">+                    None,
</a><a href="#h20-0-198" id="h20-0-198" class="i">+                    None,
</a><a href="#h20-0-199" id="h20-0-199" class="i">+                ],
</a><a href="#h20-0-200" id="h20-0-200" class="i">+                expressions: [
</a><a href="#h20-0-201" id="h20-0-201" class="i">+                    Field(
</a><a href="#h20-0-202" id="h20-0-202" class="i">+                        None,
</a><a href="#h20-0-203" id="h20-0-203" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-204" id="h20-0-204" class="i">+                    ),
</a><a href="#h20-0-205" id="h20-0-205" class="i">+                    Field(
</a><a href="#h20-0-206" id="h20-0-206" class="i">+                        None,
</a><a href="#h20-0-207" id="h20-0-207" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-208" id="h20-0-208" class="i">+                    ),
</a><a href="#h20-0-209" id="h20-0-209" class="i">+                    Field(
</a><a href="#h20-0-210" id="h20-0-210" class="i">+                        None,
</a><a href="#h20-0-211" id="h20-0-211" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-212" id="h20-0-212" class="i">+                    ),
</a><a href="#h20-0-213" id="h20-0-213" class="i">+                    Field(
</a><a href="#h20-0-214" id="h20-0-214" class="i">+                        None,
</a><a href="#h20-0-215" id="h20-0-215" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-216" id="h20-0-216" class="i">+                    ),
</a><a href="#h20-0-217" id="h20-0-217" class="i">+                    Field(
</a><a href="#h20-0-218" id="h20-0-218" class="i">+                        None,
</a><a href="#h20-0-219" id="h20-0-219" class="i">+                        &quot;i&quot;,
</a><a href="#h20-0-220" id="h20-0-220" class="i">+                    ),
</a><a href="#h20-0-221" id="h20-0-221" class="i">+                ],
</a><a href="#h20-0-222" id="h20-0-222" class="i">+            },
</a><a href="#h20-0-223" id="h20-0-223" class="i">+            aggregates: [
</a><a href="#h20-0-224" id="h20-0-224" class="i">+                Min,
</a><a href="#h20-0-225" id="h20-0-225" class="i">+                Max,
</a><a href="#h20-0-226" id="h20-0-226" class="i">+                Sum,
</a><a href="#h20-0-227" id="h20-0-227" class="i">+                Count,
</a><a href="#h20-0-228" id="h20-0-228" class="i">+                Average,
</a><a href="#h20-0-229" id="h20-0-229" class="i">+            ],
</a><a href="#h20-0-230" id="h20-0-230" class="i">+        },
</a><a href="#h20-0-231" id="h20-0-231" class="i">+        labels: [
</a><a href="#h20-0-232" id="h20-0-232" class="i">+            None,
</a><a href="#h20-0-233" id="h20-0-233" class="i">+            None,
</a><a href="#h20-0-234" id="h20-0-234" class="i">+            None,
</a><a href="#h20-0-235" id="h20-0-235" class="i">+            None,
</a><a href="#h20-0-236" id="h20-0-236" class="i">+            None,
</a><a href="#h20-0-237" id="h20-0-237" class="i">+        ],
</a><a href="#h20-0-238" id="h20-0-238" class="i">+        expressions: [
</a><a href="#h20-0-239" id="h20-0-239" class="i">+            Column(
</a><a href="#h20-0-240" id="h20-0-240" class="i">+                0,
</a><a href="#h20-0-241" id="h20-0-241" class="i">+            ),
</a><a href="#h20-0-242" id="h20-0-242" class="i">+            Column(
</a><a href="#h20-0-243" id="h20-0-243" class="i">+                1,
</a><a href="#h20-0-244" id="h20-0-244" class="i">+            ),
</a><a href="#h20-0-245" id="h20-0-245" class="i">+            Column(
</a><a href="#h20-0-246" id="h20-0-246" class="i">+                2,
</a><a href="#h20-0-247" id="h20-0-247" class="i">+            ),
</a><a href="#h20-0-248" id="h20-0-248" class="i">+            Column(
</a><a href="#h20-0-249" id="h20-0-249" class="i">+                3,
</a><a href="#h20-0-250" id="h20-0-250" class="i">+            ),
</a><a href="#h20-0-251" id="h20-0-251" class="i">+            Column(
</a><a href="#h20-0-252" id="h20-0-252" class="i">+                4,
</a><a href="#h20-0-253" id="h20-0-253" class="i">+            ),
</a><a href="#h20-0-254" id="h20-0-254" class="i">+        ],
</a><a href="#h20-0-255" id="h20-0-255" class="i">+    },
</a><a href="#h20-0-256" id="h20-0-256" class="i">+}
</a><a href="#h20-0-257" id="h20-0-257" class="i">+
</a><a href="#h20-0-258" id="h20-0-258" class="i">+Query: SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers WHERE i IS NOT NULL
</a><a href="#h20-0-259" id="h20-0-259" class="i">+
</a><a href="#h20-0-260" id="h20-0-260" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h20-0-261" id="h20-0-261" class="i">+[Integer(-3), Integer(7), Integer(9), Integer(4), Integer(2)]
</a><b>diff --git a/<a id="h21" href="../file/src/sql/tests/query/agg_integer_null.html">src/sql/tests/query/agg_integer_null</a> b/<a href="../file/src/sql/tests/query/agg_integer_null.html">src/sql/tests/query/agg_integer_null</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -0,0 +1,227 @@
</a><a href="#h21-0-0" id="h21-0-0" class="i">+Query: SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers
</a><a href="#h21-0-1" id="h21-0-1" class="i">+
</a><a href="#h21-0-2" id="h21-0-2" class="i">+AST: Select {
</a><a href="#h21-0-3" id="h21-0-3" class="i">+    select: SelectClause {
</a><a href="#h21-0-4" id="h21-0-4" class="i">+        expressions: [
</a><a href="#h21-0-5" id="h21-0-5" class="i">+            Function(
</a><a href="#h21-0-6" id="h21-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h21-0-7" id="h21-0-7" class="i">+                [
</a><a href="#h21-0-8" id="h21-0-8" class="i">+                    Field(
</a><a href="#h21-0-9" id="h21-0-9" class="i">+                        None,
</a><a href="#h21-0-10" id="h21-0-10" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-11" id="h21-0-11" class="i">+                    ),
</a><a href="#h21-0-12" id="h21-0-12" class="i">+                ],
</a><a href="#h21-0-13" id="h21-0-13" class="i">+            ),
</a><a href="#h21-0-14" id="h21-0-14" class="i">+            Function(
</a><a href="#h21-0-15" id="h21-0-15" class="i">+                &quot;max&quot;,
</a><a href="#h21-0-16" id="h21-0-16" class="i">+                [
</a><a href="#h21-0-17" id="h21-0-17" class="i">+                    Field(
</a><a href="#h21-0-18" id="h21-0-18" class="i">+                        None,
</a><a href="#h21-0-19" id="h21-0-19" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-20" id="h21-0-20" class="i">+                    ),
</a><a href="#h21-0-21" id="h21-0-21" class="i">+                ],
</a><a href="#h21-0-22" id="h21-0-22" class="i">+            ),
</a><a href="#h21-0-23" id="h21-0-23" class="i">+            Function(
</a><a href="#h21-0-24" id="h21-0-24" class="i">+                &quot;sum&quot;,
</a><a href="#h21-0-25" id="h21-0-25" class="i">+                [
</a><a href="#h21-0-26" id="h21-0-26" class="i">+                    Field(
</a><a href="#h21-0-27" id="h21-0-27" class="i">+                        None,
</a><a href="#h21-0-28" id="h21-0-28" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-29" id="h21-0-29" class="i">+                    ),
</a><a href="#h21-0-30" id="h21-0-30" class="i">+                ],
</a><a href="#h21-0-31" id="h21-0-31" class="i">+            ),
</a><a href="#h21-0-32" id="h21-0-32" class="i">+            Function(
</a><a href="#h21-0-33" id="h21-0-33" class="i">+                &quot;count&quot;,
</a><a href="#h21-0-34" id="h21-0-34" class="i">+                [
</a><a href="#h21-0-35" id="h21-0-35" class="i">+                    Field(
</a><a href="#h21-0-36" id="h21-0-36" class="i">+                        None,
</a><a href="#h21-0-37" id="h21-0-37" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-38" id="h21-0-38" class="i">+                    ),
</a><a href="#h21-0-39" id="h21-0-39" class="i">+                ],
</a><a href="#h21-0-40" id="h21-0-40" class="i">+            ),
</a><a href="#h21-0-41" id="h21-0-41" class="i">+            Function(
</a><a href="#h21-0-42" id="h21-0-42" class="i">+                &quot;avg&quot;,
</a><a href="#h21-0-43" id="h21-0-43" class="i">+                [
</a><a href="#h21-0-44" id="h21-0-44" class="i">+                    Field(
</a><a href="#h21-0-45" id="h21-0-45" class="i">+                        None,
</a><a href="#h21-0-46" id="h21-0-46" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-47" id="h21-0-47" class="i">+                    ),
</a><a href="#h21-0-48" id="h21-0-48" class="i">+                ],
</a><a href="#h21-0-49" id="h21-0-49" class="i">+            ),
</a><a href="#h21-0-50" id="h21-0-50" class="i">+        ],
</a><a href="#h21-0-51" id="h21-0-51" class="i">+        labels: [
</a><a href="#h21-0-52" id="h21-0-52" class="i">+            None,
</a><a href="#h21-0-53" id="h21-0-53" class="i">+            None,
</a><a href="#h21-0-54" id="h21-0-54" class="i">+            None,
</a><a href="#h21-0-55" id="h21-0-55" class="i">+            None,
</a><a href="#h21-0-56" id="h21-0-56" class="i">+            None,
</a><a href="#h21-0-57" id="h21-0-57" class="i">+        ],
</a><a href="#h21-0-58" id="h21-0-58" class="i">+    },
</a><a href="#h21-0-59" id="h21-0-59" class="i">+    from: Some(
</a><a href="#h21-0-60" id="h21-0-60" class="i">+        FromClause {
</a><a href="#h21-0-61" id="h21-0-61" class="i">+            items: [
</a><a href="#h21-0-62" id="h21-0-62" class="i">+                Table {
</a><a href="#h21-0-63" id="h21-0-63" class="i">+                    name: &quot;integers&quot;,
</a><a href="#h21-0-64" id="h21-0-64" class="i">+                    alias: None,
</a><a href="#h21-0-65" id="h21-0-65" class="i">+                },
</a><a href="#h21-0-66" id="h21-0-66" class="i">+            ],
</a><a href="#h21-0-67" id="h21-0-67" class="i">+        },
</a><a href="#h21-0-68" id="h21-0-68" class="i">+    ),
</a><a href="#h21-0-69" id="h21-0-69" class="i">+    where: None,
</a><a href="#h21-0-70" id="h21-0-70" class="i">+    group_by: None,
</a><a href="#h21-0-71" id="h21-0-71" class="i">+    having: None,
</a><a href="#h21-0-72" id="h21-0-72" class="i">+    order: [],
</a><a href="#h21-0-73" id="h21-0-73" class="i">+    limit: None,
</a><a href="#h21-0-74" id="h21-0-74" class="i">+    offset: None,
</a><a href="#h21-0-75" id="h21-0-75" class="i">+}
</a><a href="#h21-0-76" id="h21-0-76" class="i">+
</a><a href="#h21-0-77" id="h21-0-77" class="i">+Plan: Plan {
</a><a href="#h21-0-78" id="h21-0-78" class="i">+    root: Projection {
</a><a href="#h21-0-79" id="h21-0-79" class="i">+        source: Aggregation {
</a><a href="#h21-0-80" id="h21-0-80" class="i">+            source: Projection {
</a><a href="#h21-0-81" id="h21-0-81" class="i">+                source: Scan {
</a><a href="#h21-0-82" id="h21-0-82" class="i">+                    table: &quot;integers&quot;,
</a><a href="#h21-0-83" id="h21-0-83" class="i">+                    alias: None,
</a><a href="#h21-0-84" id="h21-0-84" class="i">+                },
</a><a href="#h21-0-85" id="h21-0-85" class="i">+                labels: [
</a><a href="#h21-0-86" id="h21-0-86" class="i">+                    None,
</a><a href="#h21-0-87" id="h21-0-87" class="i">+                    None,
</a><a href="#h21-0-88" id="h21-0-88" class="i">+                    None,
</a><a href="#h21-0-89" id="h21-0-89" class="i">+                    None,
</a><a href="#h21-0-90" id="h21-0-90" class="i">+                    None,
</a><a href="#h21-0-91" id="h21-0-91" class="i">+                ],
</a><a href="#h21-0-92" id="h21-0-92" class="i">+                expressions: [
</a><a href="#h21-0-93" id="h21-0-93" class="i">+                    Field(
</a><a href="#h21-0-94" id="h21-0-94" class="i">+                        None,
</a><a href="#h21-0-95" id="h21-0-95" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-96" id="h21-0-96" class="i">+                    ),
</a><a href="#h21-0-97" id="h21-0-97" class="i">+                    Field(
</a><a href="#h21-0-98" id="h21-0-98" class="i">+                        None,
</a><a href="#h21-0-99" id="h21-0-99" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-100" id="h21-0-100" class="i">+                    ),
</a><a href="#h21-0-101" id="h21-0-101" class="i">+                    Field(
</a><a href="#h21-0-102" id="h21-0-102" class="i">+                        None,
</a><a href="#h21-0-103" id="h21-0-103" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-104" id="h21-0-104" class="i">+                    ),
</a><a href="#h21-0-105" id="h21-0-105" class="i">+                    Field(
</a><a href="#h21-0-106" id="h21-0-106" class="i">+                        None,
</a><a href="#h21-0-107" id="h21-0-107" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-108" id="h21-0-108" class="i">+                    ),
</a><a href="#h21-0-109" id="h21-0-109" class="i">+                    Field(
</a><a href="#h21-0-110" id="h21-0-110" class="i">+                        None,
</a><a href="#h21-0-111" id="h21-0-111" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-112" id="h21-0-112" class="i">+                    ),
</a><a href="#h21-0-113" id="h21-0-113" class="i">+                ],
</a><a href="#h21-0-114" id="h21-0-114" class="i">+            },
</a><a href="#h21-0-115" id="h21-0-115" class="i">+            aggregates: [
</a><a href="#h21-0-116" id="h21-0-116" class="i">+                Min,
</a><a href="#h21-0-117" id="h21-0-117" class="i">+                Max,
</a><a href="#h21-0-118" id="h21-0-118" class="i">+                Sum,
</a><a href="#h21-0-119" id="h21-0-119" class="i">+                Count,
</a><a href="#h21-0-120" id="h21-0-120" class="i">+                Average,
</a><a href="#h21-0-121" id="h21-0-121" class="i">+            ],
</a><a href="#h21-0-122" id="h21-0-122" class="i">+        },
</a><a href="#h21-0-123" id="h21-0-123" class="i">+        labels: [
</a><a href="#h21-0-124" id="h21-0-124" class="i">+            None,
</a><a href="#h21-0-125" id="h21-0-125" class="i">+            None,
</a><a href="#h21-0-126" id="h21-0-126" class="i">+            None,
</a><a href="#h21-0-127" id="h21-0-127" class="i">+            None,
</a><a href="#h21-0-128" id="h21-0-128" class="i">+            None,
</a><a href="#h21-0-129" id="h21-0-129" class="i">+        ],
</a><a href="#h21-0-130" id="h21-0-130" class="i">+        expressions: [
</a><a href="#h21-0-131" id="h21-0-131" class="i">+            Column(
</a><a href="#h21-0-132" id="h21-0-132" class="i">+                0,
</a><a href="#h21-0-133" id="h21-0-133" class="i">+            ),
</a><a href="#h21-0-134" id="h21-0-134" class="i">+            Column(
</a><a href="#h21-0-135" id="h21-0-135" class="i">+                1,
</a><a href="#h21-0-136" id="h21-0-136" class="i">+            ),
</a><a href="#h21-0-137" id="h21-0-137" class="i">+            Column(
</a><a href="#h21-0-138" id="h21-0-138" class="i">+                2,
</a><a href="#h21-0-139" id="h21-0-139" class="i">+            ),
</a><a href="#h21-0-140" id="h21-0-140" class="i">+            Column(
</a><a href="#h21-0-141" id="h21-0-141" class="i">+                3,
</a><a href="#h21-0-142" id="h21-0-142" class="i">+            ),
</a><a href="#h21-0-143" id="h21-0-143" class="i">+            Column(
</a><a href="#h21-0-144" id="h21-0-144" class="i">+                4,
</a><a href="#h21-0-145" id="h21-0-145" class="i">+            ),
</a><a href="#h21-0-146" id="h21-0-146" class="i">+        ],
</a><a href="#h21-0-147" id="h21-0-147" class="i">+    },
</a><a href="#h21-0-148" id="h21-0-148" class="i">+}
</a><a href="#h21-0-149" id="h21-0-149" class="i">+
</a><a href="#h21-0-150" id="h21-0-150" class="i">+Optimized plan: Plan {
</a><a href="#h21-0-151" id="h21-0-151" class="i">+    root: Projection {
</a><a href="#h21-0-152" id="h21-0-152" class="i">+        source: Aggregation {
</a><a href="#h21-0-153" id="h21-0-153" class="i">+            source: Projection {
</a><a href="#h21-0-154" id="h21-0-154" class="i">+                source: Scan {
</a><a href="#h21-0-155" id="h21-0-155" class="i">+                    table: &quot;integers&quot;,
</a><a href="#h21-0-156" id="h21-0-156" class="i">+                    alias: None,
</a><a href="#h21-0-157" id="h21-0-157" class="i">+                },
</a><a href="#h21-0-158" id="h21-0-158" class="i">+                labels: [
</a><a href="#h21-0-159" id="h21-0-159" class="i">+                    None,
</a><a href="#h21-0-160" id="h21-0-160" class="i">+                    None,
</a><a href="#h21-0-161" id="h21-0-161" class="i">+                    None,
</a><a href="#h21-0-162" id="h21-0-162" class="i">+                    None,
</a><a href="#h21-0-163" id="h21-0-163" class="i">+                    None,
</a><a href="#h21-0-164" id="h21-0-164" class="i">+                ],
</a><a href="#h21-0-165" id="h21-0-165" class="i">+                expressions: [
</a><a href="#h21-0-166" id="h21-0-166" class="i">+                    Field(
</a><a href="#h21-0-167" id="h21-0-167" class="i">+                        None,
</a><a href="#h21-0-168" id="h21-0-168" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-169" id="h21-0-169" class="i">+                    ),
</a><a href="#h21-0-170" id="h21-0-170" class="i">+                    Field(
</a><a href="#h21-0-171" id="h21-0-171" class="i">+                        None,
</a><a href="#h21-0-172" id="h21-0-172" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-173" id="h21-0-173" class="i">+                    ),
</a><a href="#h21-0-174" id="h21-0-174" class="i">+                    Field(
</a><a href="#h21-0-175" id="h21-0-175" class="i">+                        None,
</a><a href="#h21-0-176" id="h21-0-176" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-177" id="h21-0-177" class="i">+                    ),
</a><a href="#h21-0-178" id="h21-0-178" class="i">+                    Field(
</a><a href="#h21-0-179" id="h21-0-179" class="i">+                        None,
</a><a href="#h21-0-180" id="h21-0-180" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-181" id="h21-0-181" class="i">+                    ),
</a><a href="#h21-0-182" id="h21-0-182" class="i">+                    Field(
</a><a href="#h21-0-183" id="h21-0-183" class="i">+                        None,
</a><a href="#h21-0-184" id="h21-0-184" class="i">+                        &quot;i&quot;,
</a><a href="#h21-0-185" id="h21-0-185" class="i">+                    ),
</a><a href="#h21-0-186" id="h21-0-186" class="i">+                ],
</a><a href="#h21-0-187" id="h21-0-187" class="i">+            },
</a><a href="#h21-0-188" id="h21-0-188" class="i">+            aggregates: [
</a><a href="#h21-0-189" id="h21-0-189" class="i">+                Min,
</a><a href="#h21-0-190" id="h21-0-190" class="i">+                Max,
</a><a href="#h21-0-191" id="h21-0-191" class="i">+                Sum,
</a><a href="#h21-0-192" id="h21-0-192" class="i">+                Count,
</a><a href="#h21-0-193" id="h21-0-193" class="i">+                Average,
</a><a href="#h21-0-194" id="h21-0-194" class="i">+            ],
</a><a href="#h21-0-195" id="h21-0-195" class="i">+        },
</a><a href="#h21-0-196" id="h21-0-196" class="i">+        labels: [
</a><a href="#h21-0-197" id="h21-0-197" class="i">+            None,
</a><a href="#h21-0-198" id="h21-0-198" class="i">+            None,
</a><a href="#h21-0-199" id="h21-0-199" class="i">+            None,
</a><a href="#h21-0-200" id="h21-0-200" class="i">+            None,
</a><a href="#h21-0-201" id="h21-0-201" class="i">+            None,
</a><a href="#h21-0-202" id="h21-0-202" class="i">+        ],
</a><a href="#h21-0-203" id="h21-0-203" class="i">+        expressions: [
</a><a href="#h21-0-204" id="h21-0-204" class="i">+            Column(
</a><a href="#h21-0-205" id="h21-0-205" class="i">+                0,
</a><a href="#h21-0-206" id="h21-0-206" class="i">+            ),
</a><a href="#h21-0-207" id="h21-0-207" class="i">+            Column(
</a><a href="#h21-0-208" id="h21-0-208" class="i">+                1,
</a><a href="#h21-0-209" id="h21-0-209" class="i">+            ),
</a><a href="#h21-0-210" id="h21-0-210" class="i">+            Column(
</a><a href="#h21-0-211" id="h21-0-211" class="i">+                2,
</a><a href="#h21-0-212" id="h21-0-212" class="i">+            ),
</a><a href="#h21-0-213" id="h21-0-213" class="i">+            Column(
</a><a href="#h21-0-214" id="h21-0-214" class="i">+                3,
</a><a href="#h21-0-215" id="h21-0-215" class="i">+            ),
</a><a href="#h21-0-216" id="h21-0-216" class="i">+            Column(
</a><a href="#h21-0-217" id="h21-0-217" class="i">+                4,
</a><a href="#h21-0-218" id="h21-0-218" class="i">+            ),
</a><a href="#h21-0-219" id="h21-0-219" class="i">+        ],
</a><a href="#h21-0-220" id="h21-0-220" class="i">+    },
</a><a href="#h21-0-221" id="h21-0-221" class="i">+}
</a><a href="#h21-0-222" id="h21-0-222" class="i">+
</a><a href="#h21-0-223" id="h21-0-223" class="i">+Query: SELECT MIN(i), MAX(i), SUM(i), COUNT(i), AVG(i) FROM integers
</a><a href="#h21-0-224" id="h21-0-224" class="i">+
</a><a href="#h21-0-225" id="h21-0-225" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h21-0-226" id="h21-0-226" class="i">+[Null, Null, Null, Integer(4), Null]
</a><b>diff --git a/<a id="h22" href="../file/src/sql/tests/query/agg_nested.html">src/sql/tests/query/agg_nested</a> b/<a href="../file/src/sql/tests/query/agg_nested.html">src/sql/tests/query/agg_nested</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -0,0 +1,43 @@
</a><a href="#h22-0-0" id="h22-0-0" class="i">+Query: SELECT MAX(MIN(rating)) FROM movies
</a><a href="#h22-0-1" id="h22-0-1" class="i">+
</a><a href="#h22-0-2" id="h22-0-2" class="i">+AST: Select {
</a><a href="#h22-0-3" id="h22-0-3" class="i">+    select: SelectClause {
</a><a href="#h22-0-4" id="h22-0-4" class="i">+        expressions: [
</a><a href="#h22-0-5" id="h22-0-5" class="i">+            Function(
</a><a href="#h22-0-6" id="h22-0-6" class="i">+                &quot;max&quot;,
</a><a href="#h22-0-7" id="h22-0-7" class="i">+                [
</a><a href="#h22-0-8" id="h22-0-8" class="i">+                    Function(
</a><a href="#h22-0-9" id="h22-0-9" class="i">+                        &quot;min&quot;,
</a><a href="#h22-0-10" id="h22-0-10" class="i">+                        [
</a><a href="#h22-0-11" id="h22-0-11" class="i">+                            Field(
</a><a href="#h22-0-12" id="h22-0-12" class="i">+                                None,
</a><a href="#h22-0-13" id="h22-0-13" class="i">+                                &quot;rating&quot;,
</a><a href="#h22-0-14" id="h22-0-14" class="i">+                            ),
</a><a href="#h22-0-15" id="h22-0-15" class="i">+                        ],
</a><a href="#h22-0-16" id="h22-0-16" class="i">+                    ),
</a><a href="#h22-0-17" id="h22-0-17" class="i">+                ],
</a><a href="#h22-0-18" id="h22-0-18" class="i">+            ),
</a><a href="#h22-0-19" id="h22-0-19" class="i">+        ],
</a><a href="#h22-0-20" id="h22-0-20" class="i">+        labels: [
</a><a href="#h22-0-21" id="h22-0-21" class="i">+            None,
</a><a href="#h22-0-22" id="h22-0-22" class="i">+        ],
</a><a href="#h22-0-23" id="h22-0-23" class="i">+    },
</a><a href="#h22-0-24" id="h22-0-24" class="i">+    from: Some(
</a><a href="#h22-0-25" id="h22-0-25" class="i">+        FromClause {
</a><a href="#h22-0-26" id="h22-0-26" class="i">+            items: [
</a><a href="#h22-0-27" id="h22-0-27" class="i">+                Table {
</a><a href="#h22-0-28" id="h22-0-28" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h22-0-29" id="h22-0-29" class="i">+                    alias: None,
</a><a href="#h22-0-30" id="h22-0-30" class="i">+                },
</a><a href="#h22-0-31" id="h22-0-31" class="i">+            ],
</a><a href="#h22-0-32" id="h22-0-32" class="i">+        },
</a><a href="#h22-0-33" id="h22-0-33" class="i">+    ),
</a><a href="#h22-0-34" id="h22-0-34" class="i">+    where: None,
</a><a href="#h22-0-35" id="h22-0-35" class="i">+    group_by: None,
</a><a href="#h22-0-36" id="h22-0-36" class="i">+    having: None,
</a><a href="#h22-0-37" id="h22-0-37" class="i">+    order: [],
</a><a href="#h22-0-38" id="h22-0-38" class="i">+    limit: None,
</a><a href="#h22-0-39" id="h22-0-39" class="i">+    offset: None,
</a><a href="#h22-0-40" id="h22-0-40" class="i">+}
</a><a href="#h22-0-41" id="h22-0-41" class="i">+
</a><a href="#h22-0-42" id="h22-0-42" class="i">+Plan: Value(&quot;Aggregate function MIN() not allowed here&quot;)
</a><a href="#h22-0-43" id="h22-0-43" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h23" href="../file/src/sql/tests/query/agg_string.html">src/sql/tests/query/agg_string</a> b/<a href="../file/src/sql/tests/query/agg_string.html">src/sql/tests/query/agg_string</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -0,0 +1,262 @@
</a><a href="#h23-0-0" id="h23-0-0" class="i">+Query: SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings WHERE s IS NOT NULL
</a><a href="#h23-0-1" id="h23-0-1" class="i">+
</a><a href="#h23-0-2" id="h23-0-2" class="i">+AST: Select {
</a><a href="#h23-0-3" id="h23-0-3" class="i">+    select: SelectClause {
</a><a href="#h23-0-4" id="h23-0-4" class="i">+        expressions: [
</a><a href="#h23-0-5" id="h23-0-5" class="i">+            Function(
</a><a href="#h23-0-6" id="h23-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h23-0-7" id="h23-0-7" class="i">+                [
</a><a href="#h23-0-8" id="h23-0-8" class="i">+                    Field(
</a><a href="#h23-0-9" id="h23-0-9" class="i">+                        None,
</a><a href="#h23-0-10" id="h23-0-10" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-11" id="h23-0-11" class="i">+                    ),
</a><a href="#h23-0-12" id="h23-0-12" class="i">+                ],
</a><a href="#h23-0-13" id="h23-0-13" class="i">+            ),
</a><a href="#h23-0-14" id="h23-0-14" class="i">+            Function(
</a><a href="#h23-0-15" id="h23-0-15" class="i">+                &quot;max&quot;,
</a><a href="#h23-0-16" id="h23-0-16" class="i">+                [
</a><a href="#h23-0-17" id="h23-0-17" class="i">+                    Field(
</a><a href="#h23-0-18" id="h23-0-18" class="i">+                        None,
</a><a href="#h23-0-19" id="h23-0-19" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-20" id="h23-0-20" class="i">+                    ),
</a><a href="#h23-0-21" id="h23-0-21" class="i">+                ],
</a><a href="#h23-0-22" id="h23-0-22" class="i">+            ),
</a><a href="#h23-0-23" id="h23-0-23" class="i">+            Function(
</a><a href="#h23-0-24" id="h23-0-24" class="i">+                &quot;sum&quot;,
</a><a href="#h23-0-25" id="h23-0-25" class="i">+                [
</a><a href="#h23-0-26" id="h23-0-26" class="i">+                    Field(
</a><a href="#h23-0-27" id="h23-0-27" class="i">+                        None,
</a><a href="#h23-0-28" id="h23-0-28" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-29" id="h23-0-29" class="i">+                    ),
</a><a href="#h23-0-30" id="h23-0-30" class="i">+                ],
</a><a href="#h23-0-31" id="h23-0-31" class="i">+            ),
</a><a href="#h23-0-32" id="h23-0-32" class="i">+            Function(
</a><a href="#h23-0-33" id="h23-0-33" class="i">+                &quot;count&quot;,
</a><a href="#h23-0-34" id="h23-0-34" class="i">+                [
</a><a href="#h23-0-35" id="h23-0-35" class="i">+                    Field(
</a><a href="#h23-0-36" id="h23-0-36" class="i">+                        None,
</a><a href="#h23-0-37" id="h23-0-37" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-38" id="h23-0-38" class="i">+                    ),
</a><a href="#h23-0-39" id="h23-0-39" class="i">+                ],
</a><a href="#h23-0-40" id="h23-0-40" class="i">+            ),
</a><a href="#h23-0-41" id="h23-0-41" class="i">+            Function(
</a><a href="#h23-0-42" id="h23-0-42" class="i">+                &quot;avg&quot;,
</a><a href="#h23-0-43" id="h23-0-43" class="i">+                [
</a><a href="#h23-0-44" id="h23-0-44" class="i">+                    Field(
</a><a href="#h23-0-45" id="h23-0-45" class="i">+                        None,
</a><a href="#h23-0-46" id="h23-0-46" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-47" id="h23-0-47" class="i">+                    ),
</a><a href="#h23-0-48" id="h23-0-48" class="i">+                ],
</a><a href="#h23-0-49" id="h23-0-49" class="i">+            ),
</a><a href="#h23-0-50" id="h23-0-50" class="i">+        ],
</a><a href="#h23-0-51" id="h23-0-51" class="i">+        labels: [
</a><a href="#h23-0-52" id="h23-0-52" class="i">+            None,
</a><a href="#h23-0-53" id="h23-0-53" class="i">+            None,
</a><a href="#h23-0-54" id="h23-0-54" class="i">+            None,
</a><a href="#h23-0-55" id="h23-0-55" class="i">+            None,
</a><a href="#h23-0-56" id="h23-0-56" class="i">+            None,
</a><a href="#h23-0-57" id="h23-0-57" class="i">+        ],
</a><a href="#h23-0-58" id="h23-0-58" class="i">+    },
</a><a href="#h23-0-59" id="h23-0-59" class="i">+    from: Some(
</a><a href="#h23-0-60" id="h23-0-60" class="i">+        FromClause {
</a><a href="#h23-0-61" id="h23-0-61" class="i">+            items: [
</a><a href="#h23-0-62" id="h23-0-62" class="i">+                Table {
</a><a href="#h23-0-63" id="h23-0-63" class="i">+                    name: &quot;strings&quot;,
</a><a href="#h23-0-64" id="h23-0-64" class="i">+                    alias: None,
</a><a href="#h23-0-65" id="h23-0-65" class="i">+                },
</a><a href="#h23-0-66" id="h23-0-66" class="i">+            ],
</a><a href="#h23-0-67" id="h23-0-67" class="i">+        },
</a><a href="#h23-0-68" id="h23-0-68" class="i">+    ),
</a><a href="#h23-0-69" id="h23-0-69" class="i">+    where: Some(
</a><a href="#h23-0-70" id="h23-0-70" class="i">+        WhereClause(
</a><a href="#h23-0-71" id="h23-0-71" class="i">+            Operation(
</a><a href="#h23-0-72" id="h23-0-72" class="i">+                Not(
</a><a href="#h23-0-73" id="h23-0-73" class="i">+                    Operation(
</a><a href="#h23-0-74" id="h23-0-74" class="i">+                        IsNull(
</a><a href="#h23-0-75" id="h23-0-75" class="i">+                            Field(
</a><a href="#h23-0-76" id="h23-0-76" class="i">+                                None,
</a><a href="#h23-0-77" id="h23-0-77" class="i">+                                &quot;s&quot;,
</a><a href="#h23-0-78" id="h23-0-78" class="i">+                            ),
</a><a href="#h23-0-79" id="h23-0-79" class="i">+                        ),
</a><a href="#h23-0-80" id="h23-0-80" class="i">+                    ),
</a><a href="#h23-0-81" id="h23-0-81" class="i">+                ),
</a><a href="#h23-0-82" id="h23-0-82" class="i">+            ),
</a><a href="#h23-0-83" id="h23-0-83" class="i">+        ),
</a><a href="#h23-0-84" id="h23-0-84" class="i">+    ),
</a><a href="#h23-0-85" id="h23-0-85" class="i">+    group_by: None,
</a><a href="#h23-0-86" id="h23-0-86" class="i">+    having: None,
</a><a href="#h23-0-87" id="h23-0-87" class="i">+    order: [],
</a><a href="#h23-0-88" id="h23-0-88" class="i">+    limit: None,
</a><a href="#h23-0-89" id="h23-0-89" class="i">+    offset: None,
</a><a href="#h23-0-90" id="h23-0-90" class="i">+}
</a><a href="#h23-0-91" id="h23-0-91" class="i">+
</a><a href="#h23-0-92" id="h23-0-92" class="i">+Plan: Plan {
</a><a href="#h23-0-93" id="h23-0-93" class="i">+    root: Projection {
</a><a href="#h23-0-94" id="h23-0-94" class="i">+        source: Aggregation {
</a><a href="#h23-0-95" id="h23-0-95" class="i">+            source: Projection {
</a><a href="#h23-0-96" id="h23-0-96" class="i">+                source: Filter {
</a><a href="#h23-0-97" id="h23-0-97" class="i">+                    source: Scan {
</a><a href="#h23-0-98" id="h23-0-98" class="i">+                        table: &quot;strings&quot;,
</a><a href="#h23-0-99" id="h23-0-99" class="i">+                        alias: None,
</a><a href="#h23-0-100" id="h23-0-100" class="i">+                    },
</a><a href="#h23-0-101" id="h23-0-101" class="i">+                    predicate: Not(
</a><a href="#h23-0-102" id="h23-0-102" class="i">+                        IsNull(
</a><a href="#h23-0-103" id="h23-0-103" class="i">+                            Field(
</a><a href="#h23-0-104" id="h23-0-104" class="i">+                                None,
</a><a href="#h23-0-105" id="h23-0-105" class="i">+                                &quot;s&quot;,
</a><a href="#h23-0-106" id="h23-0-106" class="i">+                            ),
</a><a href="#h23-0-107" id="h23-0-107" class="i">+                        ),
</a><a href="#h23-0-108" id="h23-0-108" class="i">+                    ),
</a><a href="#h23-0-109" id="h23-0-109" class="i">+                },
</a><a href="#h23-0-110" id="h23-0-110" class="i">+                labels: [
</a><a href="#h23-0-111" id="h23-0-111" class="i">+                    None,
</a><a href="#h23-0-112" id="h23-0-112" class="i">+                    None,
</a><a href="#h23-0-113" id="h23-0-113" class="i">+                    None,
</a><a href="#h23-0-114" id="h23-0-114" class="i">+                    None,
</a><a href="#h23-0-115" id="h23-0-115" class="i">+                    None,
</a><a href="#h23-0-116" id="h23-0-116" class="i">+                ],
</a><a href="#h23-0-117" id="h23-0-117" class="i">+                expressions: [
</a><a href="#h23-0-118" id="h23-0-118" class="i">+                    Field(
</a><a href="#h23-0-119" id="h23-0-119" class="i">+                        None,
</a><a href="#h23-0-120" id="h23-0-120" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-121" id="h23-0-121" class="i">+                    ),
</a><a href="#h23-0-122" id="h23-0-122" class="i">+                    Field(
</a><a href="#h23-0-123" id="h23-0-123" class="i">+                        None,
</a><a href="#h23-0-124" id="h23-0-124" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-125" id="h23-0-125" class="i">+                    ),
</a><a href="#h23-0-126" id="h23-0-126" class="i">+                    Field(
</a><a href="#h23-0-127" id="h23-0-127" class="i">+                        None,
</a><a href="#h23-0-128" id="h23-0-128" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-129" id="h23-0-129" class="i">+                    ),
</a><a href="#h23-0-130" id="h23-0-130" class="i">+                    Field(
</a><a href="#h23-0-131" id="h23-0-131" class="i">+                        None,
</a><a href="#h23-0-132" id="h23-0-132" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-133" id="h23-0-133" class="i">+                    ),
</a><a href="#h23-0-134" id="h23-0-134" class="i">+                    Field(
</a><a href="#h23-0-135" id="h23-0-135" class="i">+                        None,
</a><a href="#h23-0-136" id="h23-0-136" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-137" id="h23-0-137" class="i">+                    ),
</a><a href="#h23-0-138" id="h23-0-138" class="i">+                ],
</a><a href="#h23-0-139" id="h23-0-139" class="i">+            },
</a><a href="#h23-0-140" id="h23-0-140" class="i">+            aggregates: [
</a><a href="#h23-0-141" id="h23-0-141" class="i">+                Min,
</a><a href="#h23-0-142" id="h23-0-142" class="i">+                Max,
</a><a href="#h23-0-143" id="h23-0-143" class="i">+                Sum,
</a><a href="#h23-0-144" id="h23-0-144" class="i">+                Count,
</a><a href="#h23-0-145" id="h23-0-145" class="i">+                Average,
</a><a href="#h23-0-146" id="h23-0-146" class="i">+            ],
</a><a href="#h23-0-147" id="h23-0-147" class="i">+        },
</a><a href="#h23-0-148" id="h23-0-148" class="i">+        labels: [
</a><a href="#h23-0-149" id="h23-0-149" class="i">+            None,
</a><a href="#h23-0-150" id="h23-0-150" class="i">+            None,
</a><a href="#h23-0-151" id="h23-0-151" class="i">+            None,
</a><a href="#h23-0-152" id="h23-0-152" class="i">+            None,
</a><a href="#h23-0-153" id="h23-0-153" class="i">+            None,
</a><a href="#h23-0-154" id="h23-0-154" class="i">+        ],
</a><a href="#h23-0-155" id="h23-0-155" class="i">+        expressions: [
</a><a href="#h23-0-156" id="h23-0-156" class="i">+            Column(
</a><a href="#h23-0-157" id="h23-0-157" class="i">+                0,
</a><a href="#h23-0-158" id="h23-0-158" class="i">+            ),
</a><a href="#h23-0-159" id="h23-0-159" class="i">+            Column(
</a><a href="#h23-0-160" id="h23-0-160" class="i">+                1,
</a><a href="#h23-0-161" id="h23-0-161" class="i">+            ),
</a><a href="#h23-0-162" id="h23-0-162" class="i">+            Column(
</a><a href="#h23-0-163" id="h23-0-163" class="i">+                2,
</a><a href="#h23-0-164" id="h23-0-164" class="i">+            ),
</a><a href="#h23-0-165" id="h23-0-165" class="i">+            Column(
</a><a href="#h23-0-166" id="h23-0-166" class="i">+                3,
</a><a href="#h23-0-167" id="h23-0-167" class="i">+            ),
</a><a href="#h23-0-168" id="h23-0-168" class="i">+            Column(
</a><a href="#h23-0-169" id="h23-0-169" class="i">+                4,
</a><a href="#h23-0-170" id="h23-0-170" class="i">+            ),
</a><a href="#h23-0-171" id="h23-0-171" class="i">+        ],
</a><a href="#h23-0-172" id="h23-0-172" class="i">+    },
</a><a href="#h23-0-173" id="h23-0-173" class="i">+}
</a><a href="#h23-0-174" id="h23-0-174" class="i">+
</a><a href="#h23-0-175" id="h23-0-175" class="i">+Optimized plan: Plan {
</a><a href="#h23-0-176" id="h23-0-176" class="i">+    root: Projection {
</a><a href="#h23-0-177" id="h23-0-177" class="i">+        source: Aggregation {
</a><a href="#h23-0-178" id="h23-0-178" class="i">+            source: Projection {
</a><a href="#h23-0-179" id="h23-0-179" class="i">+                source: Filter {
</a><a href="#h23-0-180" id="h23-0-180" class="i">+                    source: Scan {
</a><a href="#h23-0-181" id="h23-0-181" class="i">+                        table: &quot;strings&quot;,
</a><a href="#h23-0-182" id="h23-0-182" class="i">+                        alias: None,
</a><a href="#h23-0-183" id="h23-0-183" class="i">+                    },
</a><a href="#h23-0-184" id="h23-0-184" class="i">+                    predicate: Not(
</a><a href="#h23-0-185" id="h23-0-185" class="i">+                        IsNull(
</a><a href="#h23-0-186" id="h23-0-186" class="i">+                            Field(
</a><a href="#h23-0-187" id="h23-0-187" class="i">+                                None,
</a><a href="#h23-0-188" id="h23-0-188" class="i">+                                &quot;s&quot;,
</a><a href="#h23-0-189" id="h23-0-189" class="i">+                            ),
</a><a href="#h23-0-190" id="h23-0-190" class="i">+                        ),
</a><a href="#h23-0-191" id="h23-0-191" class="i">+                    ),
</a><a href="#h23-0-192" id="h23-0-192" class="i">+                },
</a><a href="#h23-0-193" id="h23-0-193" class="i">+                labels: [
</a><a href="#h23-0-194" id="h23-0-194" class="i">+                    None,
</a><a href="#h23-0-195" id="h23-0-195" class="i">+                    None,
</a><a href="#h23-0-196" id="h23-0-196" class="i">+                    None,
</a><a href="#h23-0-197" id="h23-0-197" class="i">+                    None,
</a><a href="#h23-0-198" id="h23-0-198" class="i">+                    None,
</a><a href="#h23-0-199" id="h23-0-199" class="i">+                ],
</a><a href="#h23-0-200" id="h23-0-200" class="i">+                expressions: [
</a><a href="#h23-0-201" id="h23-0-201" class="i">+                    Field(
</a><a href="#h23-0-202" id="h23-0-202" class="i">+                        None,
</a><a href="#h23-0-203" id="h23-0-203" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-204" id="h23-0-204" class="i">+                    ),
</a><a href="#h23-0-205" id="h23-0-205" class="i">+                    Field(
</a><a href="#h23-0-206" id="h23-0-206" class="i">+                        None,
</a><a href="#h23-0-207" id="h23-0-207" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-208" id="h23-0-208" class="i">+                    ),
</a><a href="#h23-0-209" id="h23-0-209" class="i">+                    Field(
</a><a href="#h23-0-210" id="h23-0-210" class="i">+                        None,
</a><a href="#h23-0-211" id="h23-0-211" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-212" id="h23-0-212" class="i">+                    ),
</a><a href="#h23-0-213" id="h23-0-213" class="i">+                    Field(
</a><a href="#h23-0-214" id="h23-0-214" class="i">+                        None,
</a><a href="#h23-0-215" id="h23-0-215" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-216" id="h23-0-216" class="i">+                    ),
</a><a href="#h23-0-217" id="h23-0-217" class="i">+                    Field(
</a><a href="#h23-0-218" id="h23-0-218" class="i">+                        None,
</a><a href="#h23-0-219" id="h23-0-219" class="i">+                        &quot;s&quot;,
</a><a href="#h23-0-220" id="h23-0-220" class="i">+                    ),
</a><a href="#h23-0-221" id="h23-0-221" class="i">+                ],
</a><a href="#h23-0-222" id="h23-0-222" class="i">+            },
</a><a href="#h23-0-223" id="h23-0-223" class="i">+            aggregates: [
</a><a href="#h23-0-224" id="h23-0-224" class="i">+                Min,
</a><a href="#h23-0-225" id="h23-0-225" class="i">+                Max,
</a><a href="#h23-0-226" id="h23-0-226" class="i">+                Sum,
</a><a href="#h23-0-227" id="h23-0-227" class="i">+                Count,
</a><a href="#h23-0-228" id="h23-0-228" class="i">+                Average,
</a><a href="#h23-0-229" id="h23-0-229" class="i">+            ],
</a><a href="#h23-0-230" id="h23-0-230" class="i">+        },
</a><a href="#h23-0-231" id="h23-0-231" class="i">+        labels: [
</a><a href="#h23-0-232" id="h23-0-232" class="i">+            None,
</a><a href="#h23-0-233" id="h23-0-233" class="i">+            None,
</a><a href="#h23-0-234" id="h23-0-234" class="i">+            None,
</a><a href="#h23-0-235" id="h23-0-235" class="i">+            None,
</a><a href="#h23-0-236" id="h23-0-236" class="i">+            None,
</a><a href="#h23-0-237" id="h23-0-237" class="i">+        ],
</a><a href="#h23-0-238" id="h23-0-238" class="i">+        expressions: [
</a><a href="#h23-0-239" id="h23-0-239" class="i">+            Column(
</a><a href="#h23-0-240" id="h23-0-240" class="i">+                0,
</a><a href="#h23-0-241" id="h23-0-241" class="i">+            ),
</a><a href="#h23-0-242" id="h23-0-242" class="i">+            Column(
</a><a href="#h23-0-243" id="h23-0-243" class="i">+                1,
</a><a href="#h23-0-244" id="h23-0-244" class="i">+            ),
</a><a href="#h23-0-245" id="h23-0-245" class="i">+            Column(
</a><a href="#h23-0-246" id="h23-0-246" class="i">+                2,
</a><a href="#h23-0-247" id="h23-0-247" class="i">+            ),
</a><a href="#h23-0-248" id="h23-0-248" class="i">+            Column(
</a><a href="#h23-0-249" id="h23-0-249" class="i">+                3,
</a><a href="#h23-0-250" id="h23-0-250" class="i">+            ),
</a><a href="#h23-0-251" id="h23-0-251" class="i">+            Column(
</a><a href="#h23-0-252" id="h23-0-252" class="i">+                4,
</a><a href="#h23-0-253" id="h23-0-253" class="i">+            ),
</a><a href="#h23-0-254" id="h23-0-254" class="i">+        ],
</a><a href="#h23-0-255" id="h23-0-255" class="i">+    },
</a><a href="#h23-0-256" id="h23-0-256" class="i">+}
</a><a href="#h23-0-257" id="h23-0-257" class="i">+
</a><a href="#h23-0-258" id="h23-0-258" class="i">+Query: SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings WHERE s IS NOT NULL
</a><a href="#h23-0-259" id="h23-0-259" class="i">+
</a><a href="#h23-0-260" id="h23-0-260" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h23-0-261" id="h23-0-261" class="i">+[String(&quot;A&quot;), String(&quot;åa&quot;), Null, Integer(7), Null]
</a><b>diff --git a/<a id="h24" href="../file/src/sql/tests/query/agg_string_null.html">src/sql/tests/query/agg_string_null</a> b/<a href="../file/src/sql/tests/query/agg_string_null.html">src/sql/tests/query/agg_string_null</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -0,0 +1,227 @@
</a><a href="#h24-0-0" id="h24-0-0" class="i">+Query: SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings
</a><a href="#h24-0-1" id="h24-0-1" class="i">+
</a><a href="#h24-0-2" id="h24-0-2" class="i">+AST: Select {
</a><a href="#h24-0-3" id="h24-0-3" class="i">+    select: SelectClause {
</a><a href="#h24-0-4" id="h24-0-4" class="i">+        expressions: [
</a><a href="#h24-0-5" id="h24-0-5" class="i">+            Function(
</a><a href="#h24-0-6" id="h24-0-6" class="i">+                &quot;min&quot;,
</a><a href="#h24-0-7" id="h24-0-7" class="i">+                [
</a><a href="#h24-0-8" id="h24-0-8" class="i">+                    Field(
</a><a href="#h24-0-9" id="h24-0-9" class="i">+                        None,
</a><a href="#h24-0-10" id="h24-0-10" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-11" id="h24-0-11" class="i">+                    ),
</a><a href="#h24-0-12" id="h24-0-12" class="i">+                ],
</a><a href="#h24-0-13" id="h24-0-13" class="i">+            ),
</a><a href="#h24-0-14" id="h24-0-14" class="i">+            Function(
</a><a href="#h24-0-15" id="h24-0-15" class="i">+                &quot;max&quot;,
</a><a href="#h24-0-16" id="h24-0-16" class="i">+                [
</a><a href="#h24-0-17" id="h24-0-17" class="i">+                    Field(
</a><a href="#h24-0-18" id="h24-0-18" class="i">+                        None,
</a><a href="#h24-0-19" id="h24-0-19" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-20" id="h24-0-20" class="i">+                    ),
</a><a href="#h24-0-21" id="h24-0-21" class="i">+                ],
</a><a href="#h24-0-22" id="h24-0-22" class="i">+            ),
</a><a href="#h24-0-23" id="h24-0-23" class="i">+            Function(
</a><a href="#h24-0-24" id="h24-0-24" class="i">+                &quot;sum&quot;,
</a><a href="#h24-0-25" id="h24-0-25" class="i">+                [
</a><a href="#h24-0-26" id="h24-0-26" class="i">+                    Field(
</a><a href="#h24-0-27" id="h24-0-27" class="i">+                        None,
</a><a href="#h24-0-28" id="h24-0-28" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-29" id="h24-0-29" class="i">+                    ),
</a><a href="#h24-0-30" id="h24-0-30" class="i">+                ],
</a><a href="#h24-0-31" id="h24-0-31" class="i">+            ),
</a><a href="#h24-0-32" id="h24-0-32" class="i">+            Function(
</a><a href="#h24-0-33" id="h24-0-33" class="i">+                &quot;count&quot;,
</a><a href="#h24-0-34" id="h24-0-34" class="i">+                [
</a><a href="#h24-0-35" id="h24-0-35" class="i">+                    Field(
</a><a href="#h24-0-36" id="h24-0-36" class="i">+                        None,
</a><a href="#h24-0-37" id="h24-0-37" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-38" id="h24-0-38" class="i">+                    ),
</a><a href="#h24-0-39" id="h24-0-39" class="i">+                ],
</a><a href="#h24-0-40" id="h24-0-40" class="i">+            ),
</a><a href="#h24-0-41" id="h24-0-41" class="i">+            Function(
</a><a href="#h24-0-42" id="h24-0-42" class="i">+                &quot;avg&quot;,
</a><a href="#h24-0-43" id="h24-0-43" class="i">+                [
</a><a href="#h24-0-44" id="h24-0-44" class="i">+                    Field(
</a><a href="#h24-0-45" id="h24-0-45" class="i">+                        None,
</a><a href="#h24-0-46" id="h24-0-46" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-47" id="h24-0-47" class="i">+                    ),
</a><a href="#h24-0-48" id="h24-0-48" class="i">+                ],
</a><a href="#h24-0-49" id="h24-0-49" class="i">+            ),
</a><a href="#h24-0-50" id="h24-0-50" class="i">+        ],
</a><a href="#h24-0-51" id="h24-0-51" class="i">+        labels: [
</a><a href="#h24-0-52" id="h24-0-52" class="i">+            None,
</a><a href="#h24-0-53" id="h24-0-53" class="i">+            None,
</a><a href="#h24-0-54" id="h24-0-54" class="i">+            None,
</a><a href="#h24-0-55" id="h24-0-55" class="i">+            None,
</a><a href="#h24-0-56" id="h24-0-56" class="i">+            None,
</a><a href="#h24-0-57" id="h24-0-57" class="i">+        ],
</a><a href="#h24-0-58" id="h24-0-58" class="i">+    },
</a><a href="#h24-0-59" id="h24-0-59" class="i">+    from: Some(
</a><a href="#h24-0-60" id="h24-0-60" class="i">+        FromClause {
</a><a href="#h24-0-61" id="h24-0-61" class="i">+            items: [
</a><a href="#h24-0-62" id="h24-0-62" class="i">+                Table {
</a><a href="#h24-0-63" id="h24-0-63" class="i">+                    name: &quot;strings&quot;,
</a><a href="#h24-0-64" id="h24-0-64" class="i">+                    alias: None,
</a><a href="#h24-0-65" id="h24-0-65" class="i">+                },
</a><a href="#h24-0-66" id="h24-0-66" class="i">+            ],
</a><a href="#h24-0-67" id="h24-0-67" class="i">+        },
</a><a href="#h24-0-68" id="h24-0-68" class="i">+    ),
</a><a href="#h24-0-69" id="h24-0-69" class="i">+    where: None,
</a><a href="#h24-0-70" id="h24-0-70" class="i">+    group_by: None,
</a><a href="#h24-0-71" id="h24-0-71" class="i">+    having: None,
</a><a href="#h24-0-72" id="h24-0-72" class="i">+    order: [],
</a><a href="#h24-0-73" id="h24-0-73" class="i">+    limit: None,
</a><a href="#h24-0-74" id="h24-0-74" class="i">+    offset: None,
</a><a href="#h24-0-75" id="h24-0-75" class="i">+}
</a><a href="#h24-0-76" id="h24-0-76" class="i">+
</a><a href="#h24-0-77" id="h24-0-77" class="i">+Plan: Plan {
</a><a href="#h24-0-78" id="h24-0-78" class="i">+    root: Projection {
</a><a href="#h24-0-79" id="h24-0-79" class="i">+        source: Aggregation {
</a><a href="#h24-0-80" id="h24-0-80" class="i">+            source: Projection {
</a><a href="#h24-0-81" id="h24-0-81" class="i">+                source: Scan {
</a><a href="#h24-0-82" id="h24-0-82" class="i">+                    table: &quot;strings&quot;,
</a><a href="#h24-0-83" id="h24-0-83" class="i">+                    alias: None,
</a><a href="#h24-0-84" id="h24-0-84" class="i">+                },
</a><a href="#h24-0-85" id="h24-0-85" class="i">+                labels: [
</a><a href="#h24-0-86" id="h24-0-86" class="i">+                    None,
</a><a href="#h24-0-87" id="h24-0-87" class="i">+                    None,
</a><a href="#h24-0-88" id="h24-0-88" class="i">+                    None,
</a><a href="#h24-0-89" id="h24-0-89" class="i">+                    None,
</a><a href="#h24-0-90" id="h24-0-90" class="i">+                    None,
</a><a href="#h24-0-91" id="h24-0-91" class="i">+                ],
</a><a href="#h24-0-92" id="h24-0-92" class="i">+                expressions: [
</a><a href="#h24-0-93" id="h24-0-93" class="i">+                    Field(
</a><a href="#h24-0-94" id="h24-0-94" class="i">+                        None,
</a><a href="#h24-0-95" id="h24-0-95" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-96" id="h24-0-96" class="i">+                    ),
</a><a href="#h24-0-97" id="h24-0-97" class="i">+                    Field(
</a><a href="#h24-0-98" id="h24-0-98" class="i">+                        None,
</a><a href="#h24-0-99" id="h24-0-99" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-100" id="h24-0-100" class="i">+                    ),
</a><a href="#h24-0-101" id="h24-0-101" class="i">+                    Field(
</a><a href="#h24-0-102" id="h24-0-102" class="i">+                        None,
</a><a href="#h24-0-103" id="h24-0-103" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-104" id="h24-0-104" class="i">+                    ),
</a><a href="#h24-0-105" id="h24-0-105" class="i">+                    Field(
</a><a href="#h24-0-106" id="h24-0-106" class="i">+                        None,
</a><a href="#h24-0-107" id="h24-0-107" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-108" id="h24-0-108" class="i">+                    ),
</a><a href="#h24-0-109" id="h24-0-109" class="i">+                    Field(
</a><a href="#h24-0-110" id="h24-0-110" class="i">+                        None,
</a><a href="#h24-0-111" id="h24-0-111" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-112" id="h24-0-112" class="i">+                    ),
</a><a href="#h24-0-113" id="h24-0-113" class="i">+                ],
</a><a href="#h24-0-114" id="h24-0-114" class="i">+            },
</a><a href="#h24-0-115" id="h24-0-115" class="i">+            aggregates: [
</a><a href="#h24-0-116" id="h24-0-116" class="i">+                Min,
</a><a href="#h24-0-117" id="h24-0-117" class="i">+                Max,
</a><a href="#h24-0-118" id="h24-0-118" class="i">+                Sum,
</a><a href="#h24-0-119" id="h24-0-119" class="i">+                Count,
</a><a href="#h24-0-120" id="h24-0-120" class="i">+                Average,
</a><a href="#h24-0-121" id="h24-0-121" class="i">+            ],
</a><a href="#h24-0-122" id="h24-0-122" class="i">+        },
</a><a href="#h24-0-123" id="h24-0-123" class="i">+        labels: [
</a><a href="#h24-0-124" id="h24-0-124" class="i">+            None,
</a><a href="#h24-0-125" id="h24-0-125" class="i">+            None,
</a><a href="#h24-0-126" id="h24-0-126" class="i">+            None,
</a><a href="#h24-0-127" id="h24-0-127" class="i">+            None,
</a><a href="#h24-0-128" id="h24-0-128" class="i">+            None,
</a><a href="#h24-0-129" id="h24-0-129" class="i">+        ],
</a><a href="#h24-0-130" id="h24-0-130" class="i">+        expressions: [
</a><a href="#h24-0-131" id="h24-0-131" class="i">+            Column(
</a><a href="#h24-0-132" id="h24-0-132" class="i">+                0,
</a><a href="#h24-0-133" id="h24-0-133" class="i">+            ),
</a><a href="#h24-0-134" id="h24-0-134" class="i">+            Column(
</a><a href="#h24-0-135" id="h24-0-135" class="i">+                1,
</a><a href="#h24-0-136" id="h24-0-136" class="i">+            ),
</a><a href="#h24-0-137" id="h24-0-137" class="i">+            Column(
</a><a href="#h24-0-138" id="h24-0-138" class="i">+                2,
</a><a href="#h24-0-139" id="h24-0-139" class="i">+            ),
</a><a href="#h24-0-140" id="h24-0-140" class="i">+            Column(
</a><a href="#h24-0-141" id="h24-0-141" class="i">+                3,
</a><a href="#h24-0-142" id="h24-0-142" class="i">+            ),
</a><a href="#h24-0-143" id="h24-0-143" class="i">+            Column(
</a><a href="#h24-0-144" id="h24-0-144" class="i">+                4,
</a><a href="#h24-0-145" id="h24-0-145" class="i">+            ),
</a><a href="#h24-0-146" id="h24-0-146" class="i">+        ],
</a><a href="#h24-0-147" id="h24-0-147" class="i">+    },
</a><a href="#h24-0-148" id="h24-0-148" class="i">+}
</a><a href="#h24-0-149" id="h24-0-149" class="i">+
</a><a href="#h24-0-150" id="h24-0-150" class="i">+Optimized plan: Plan {
</a><a href="#h24-0-151" id="h24-0-151" class="i">+    root: Projection {
</a><a href="#h24-0-152" id="h24-0-152" class="i">+        source: Aggregation {
</a><a href="#h24-0-153" id="h24-0-153" class="i">+            source: Projection {
</a><a href="#h24-0-154" id="h24-0-154" class="i">+                source: Scan {
</a><a href="#h24-0-155" id="h24-0-155" class="i">+                    table: &quot;strings&quot;,
</a><a href="#h24-0-156" id="h24-0-156" class="i">+                    alias: None,
</a><a href="#h24-0-157" id="h24-0-157" class="i">+                },
</a><a href="#h24-0-158" id="h24-0-158" class="i">+                labels: [
</a><a href="#h24-0-159" id="h24-0-159" class="i">+                    None,
</a><a href="#h24-0-160" id="h24-0-160" class="i">+                    None,
</a><a href="#h24-0-161" id="h24-0-161" class="i">+                    None,
</a><a href="#h24-0-162" id="h24-0-162" class="i">+                    None,
</a><a href="#h24-0-163" id="h24-0-163" class="i">+                    None,
</a><a href="#h24-0-164" id="h24-0-164" class="i">+                ],
</a><a href="#h24-0-165" id="h24-0-165" class="i">+                expressions: [
</a><a href="#h24-0-166" id="h24-0-166" class="i">+                    Field(
</a><a href="#h24-0-167" id="h24-0-167" class="i">+                        None,
</a><a href="#h24-0-168" id="h24-0-168" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-169" id="h24-0-169" class="i">+                    ),
</a><a href="#h24-0-170" id="h24-0-170" class="i">+                    Field(
</a><a href="#h24-0-171" id="h24-0-171" class="i">+                        None,
</a><a href="#h24-0-172" id="h24-0-172" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-173" id="h24-0-173" class="i">+                    ),
</a><a href="#h24-0-174" id="h24-0-174" class="i">+                    Field(
</a><a href="#h24-0-175" id="h24-0-175" class="i">+                        None,
</a><a href="#h24-0-176" id="h24-0-176" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-177" id="h24-0-177" class="i">+                    ),
</a><a href="#h24-0-178" id="h24-0-178" class="i">+                    Field(
</a><a href="#h24-0-179" id="h24-0-179" class="i">+                        None,
</a><a href="#h24-0-180" id="h24-0-180" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-181" id="h24-0-181" class="i">+                    ),
</a><a href="#h24-0-182" id="h24-0-182" class="i">+                    Field(
</a><a href="#h24-0-183" id="h24-0-183" class="i">+                        None,
</a><a href="#h24-0-184" id="h24-0-184" class="i">+                        &quot;s&quot;,
</a><a href="#h24-0-185" id="h24-0-185" class="i">+                    ),
</a><a href="#h24-0-186" id="h24-0-186" class="i">+                ],
</a><a href="#h24-0-187" id="h24-0-187" class="i">+            },
</a><a href="#h24-0-188" id="h24-0-188" class="i">+            aggregates: [
</a><a href="#h24-0-189" id="h24-0-189" class="i">+                Min,
</a><a href="#h24-0-190" id="h24-0-190" class="i">+                Max,
</a><a href="#h24-0-191" id="h24-0-191" class="i">+                Sum,
</a><a href="#h24-0-192" id="h24-0-192" class="i">+                Count,
</a><a href="#h24-0-193" id="h24-0-193" class="i">+                Average,
</a><a href="#h24-0-194" id="h24-0-194" class="i">+            ],
</a><a href="#h24-0-195" id="h24-0-195" class="i">+        },
</a><a href="#h24-0-196" id="h24-0-196" class="i">+        labels: [
</a><a href="#h24-0-197" id="h24-0-197" class="i">+            None,
</a><a href="#h24-0-198" id="h24-0-198" class="i">+            None,
</a><a href="#h24-0-199" id="h24-0-199" class="i">+            None,
</a><a href="#h24-0-200" id="h24-0-200" class="i">+            None,
</a><a href="#h24-0-201" id="h24-0-201" class="i">+            None,
</a><a href="#h24-0-202" id="h24-0-202" class="i">+        ],
</a><a href="#h24-0-203" id="h24-0-203" class="i">+        expressions: [
</a><a href="#h24-0-204" id="h24-0-204" class="i">+            Column(
</a><a href="#h24-0-205" id="h24-0-205" class="i">+                0,
</a><a href="#h24-0-206" id="h24-0-206" class="i">+            ),
</a><a href="#h24-0-207" id="h24-0-207" class="i">+            Column(
</a><a href="#h24-0-208" id="h24-0-208" class="i">+                1,
</a><a href="#h24-0-209" id="h24-0-209" class="i">+            ),
</a><a href="#h24-0-210" id="h24-0-210" class="i">+            Column(
</a><a href="#h24-0-211" id="h24-0-211" class="i">+                2,
</a><a href="#h24-0-212" id="h24-0-212" class="i">+            ),
</a><a href="#h24-0-213" id="h24-0-213" class="i">+            Column(
</a><a href="#h24-0-214" id="h24-0-214" class="i">+                3,
</a><a href="#h24-0-215" id="h24-0-215" class="i">+            ),
</a><a href="#h24-0-216" id="h24-0-216" class="i">+            Column(
</a><a href="#h24-0-217" id="h24-0-217" class="i">+                4,
</a><a href="#h24-0-218" id="h24-0-218" class="i">+            ),
</a><a href="#h24-0-219" id="h24-0-219" class="i">+        ],
</a><a href="#h24-0-220" id="h24-0-220" class="i">+    },
</a><a href="#h24-0-221" id="h24-0-221" class="i">+}
</a><a href="#h24-0-222" id="h24-0-222" class="i">+
</a><a href="#h24-0-223" id="h24-0-223" class="i">+Query: SELECT MIN(s), MAX(s), SUM(s), COUNT(s), AVG(s) FROM strings
</a><a href="#h24-0-224" id="h24-0-224" class="i">+
</a><a href="#h24-0-225" id="h24-0-225" class="i">+Result: [&quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;, &quot;?&quot;]
</a><a href="#h24-0-226" id="h24-0-226" class="i">+[Null, Null, Null, Integer(7), Null]
</a><b>diff --git a/<a id="h25" href="../file/src/sql/tests/query/agg_ungrouped.html">src/sql/tests/query/agg_ungrouped</a> b/<a href="../file/src/sql/tests/query/agg_ungrouped.html">src/sql/tests/query/agg_ungrouped</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -0,0 +1,124 @@
</a><a href="#h25-0-0" id="h25-0-0" class="i">+Query: SELECT studio_id, COUNT(*) FROM movies
</a><a href="#h25-0-1" id="h25-0-1" class="i">+
</a><a href="#h25-0-2" id="h25-0-2" class="i">+AST: Select {
</a><a href="#h25-0-3" id="h25-0-3" class="i">+    select: SelectClause {
</a><a href="#h25-0-4" id="h25-0-4" class="i">+        expressions: [
</a><a href="#h25-0-5" id="h25-0-5" class="i">+            Field(
</a><a href="#h25-0-6" id="h25-0-6" class="i">+                None,
</a><a href="#h25-0-7" id="h25-0-7" class="i">+                &quot;studio_id&quot;,
</a><a href="#h25-0-8" id="h25-0-8" class="i">+            ),
</a><a href="#h25-0-9" id="h25-0-9" class="i">+            Function(
</a><a href="#h25-0-10" id="h25-0-10" class="i">+                &quot;count&quot;,
</a><a href="#h25-0-11" id="h25-0-11" class="i">+                [
</a><a href="#h25-0-12" id="h25-0-12" class="i">+                    Literal(
</a><a href="#h25-0-13" id="h25-0-13" class="i">+                        Boolean(
</a><a href="#h25-0-14" id="h25-0-14" class="i">+                            true,
</a><a href="#h25-0-15" id="h25-0-15" class="i">+                        ),
</a><a href="#h25-0-16" id="h25-0-16" class="i">+                    ),
</a><a href="#h25-0-17" id="h25-0-17" class="i">+                ],
</a><a href="#h25-0-18" id="h25-0-18" class="i">+            ),
</a><a href="#h25-0-19" id="h25-0-19" class="i">+        ],
</a><a href="#h25-0-20" id="h25-0-20" class="i">+        labels: [
</a><a href="#h25-0-21" id="h25-0-21" class="i">+            None,
</a><a href="#h25-0-22" id="h25-0-22" class="i">+            None,
</a><a href="#h25-0-23" id="h25-0-23" class="i">+        ],
</a><a href="#h25-0-24" id="h25-0-24" class="i">+    },
</a><a href="#h25-0-25" id="h25-0-25" class="i">+    from: Some(
</a><a href="#h25-0-26" id="h25-0-26" class="i">+        FromClause {
</a><a href="#h25-0-27" id="h25-0-27" class="i">+            items: [
</a><a href="#h25-0-28" id="h25-0-28" class="i">+                Table {
</a><a href="#h25-0-29" id="h25-0-29" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h25-0-30" id="h25-0-30" class="i">+                    alias: None,
</a><a href="#h25-0-31" id="h25-0-31" class="i">+                },
</a><a href="#h25-0-32" id="h25-0-32" class="i">+            ],
</a><a href="#h25-0-33" id="h25-0-33" class="i">+        },
</a><a href="#h25-0-34" id="h25-0-34" class="i">+    ),
</a><a href="#h25-0-35" id="h25-0-35" class="i">+    where: None,
</a><a href="#h25-0-36" id="h25-0-36" class="i">+    group_by: None,
</a><a href="#h25-0-37" id="h25-0-37" class="i">+    having: None,
</a><a href="#h25-0-38" id="h25-0-38" class="i">+    order: [],
</a><a href="#h25-0-39" id="h25-0-39" class="i">+    limit: None,
</a><a href="#h25-0-40" id="h25-0-40" class="i">+    offset: None,
</a><a href="#h25-0-41" id="h25-0-41" class="i">+}
</a><a href="#h25-0-42" id="h25-0-42" class="i">+
</a><a href="#h25-0-43" id="h25-0-43" class="i">+Plan: Plan {
</a><a href="#h25-0-44" id="h25-0-44" class="i">+    root: Projection {
</a><a href="#h25-0-45" id="h25-0-45" class="i">+        source: Aggregation {
</a><a href="#h25-0-46" id="h25-0-46" class="i">+            source: Projection {
</a><a href="#h25-0-47" id="h25-0-47" class="i">+                source: Scan {
</a><a href="#h25-0-48" id="h25-0-48" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h25-0-49" id="h25-0-49" class="i">+                    alias: None,
</a><a href="#h25-0-50" id="h25-0-50" class="i">+                },
</a><a href="#h25-0-51" id="h25-0-51" class="i">+                labels: [
</a><a href="#h25-0-52" id="h25-0-52" class="i">+                    None,
</a><a href="#h25-0-53" id="h25-0-53" class="i">+                ],
</a><a href="#h25-0-54" id="h25-0-54" class="i">+                expressions: [
</a><a href="#h25-0-55" id="h25-0-55" class="i">+                    Constant(
</a><a href="#h25-0-56" id="h25-0-56" class="i">+                        Boolean(
</a><a href="#h25-0-57" id="h25-0-57" class="i">+                            true,
</a><a href="#h25-0-58" id="h25-0-58" class="i">+                        ),
</a><a href="#h25-0-59" id="h25-0-59" class="i">+                    ),
</a><a href="#h25-0-60" id="h25-0-60" class="i">+                ],
</a><a href="#h25-0-61" id="h25-0-61" class="i">+            },
</a><a href="#h25-0-62" id="h25-0-62" class="i">+            aggregates: [
</a><a href="#h25-0-63" id="h25-0-63" class="i">+                Count,
</a><a href="#h25-0-64" id="h25-0-64" class="i">+            ],
</a><a href="#h25-0-65" id="h25-0-65" class="i">+        },
</a><a href="#h25-0-66" id="h25-0-66" class="i">+        labels: [
</a><a href="#h25-0-67" id="h25-0-67" class="i">+            None,
</a><a href="#h25-0-68" id="h25-0-68" class="i">+            None,
</a><a href="#h25-0-69" id="h25-0-69" class="i">+        ],
</a><a href="#h25-0-70" id="h25-0-70" class="i">+        expressions: [
</a><a href="#h25-0-71" id="h25-0-71" class="i">+            Field(
</a><a href="#h25-0-72" id="h25-0-72" class="i">+                None,
</a><a href="#h25-0-73" id="h25-0-73" class="i">+                &quot;studio_id&quot;,
</a><a href="#h25-0-74" id="h25-0-74" class="i">+            ),
</a><a href="#h25-0-75" id="h25-0-75" class="i">+            Column(
</a><a href="#h25-0-76" id="h25-0-76" class="i">+                0,
</a><a href="#h25-0-77" id="h25-0-77" class="i">+            ),
</a><a href="#h25-0-78" id="h25-0-78" class="i">+        ],
</a><a href="#h25-0-79" id="h25-0-79" class="i">+    },
</a><a href="#h25-0-80" id="h25-0-80" class="i">+}
</a><a href="#h25-0-81" id="h25-0-81" class="i">+
</a><a href="#h25-0-82" id="h25-0-82" class="i">+Optimized plan: Plan {
</a><a href="#h25-0-83" id="h25-0-83" class="i">+    root: Projection {
</a><a href="#h25-0-84" id="h25-0-84" class="i">+        source: Aggregation {
</a><a href="#h25-0-85" id="h25-0-85" class="i">+            source: Projection {
</a><a href="#h25-0-86" id="h25-0-86" class="i">+                source: Scan {
</a><a href="#h25-0-87" id="h25-0-87" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h25-0-88" id="h25-0-88" class="i">+                    alias: None,
</a><a href="#h25-0-89" id="h25-0-89" class="i">+                },
</a><a href="#h25-0-90" id="h25-0-90" class="i">+                labels: [
</a><a href="#h25-0-91" id="h25-0-91" class="i">+                    None,
</a><a href="#h25-0-92" id="h25-0-92" class="i">+                ],
</a><a href="#h25-0-93" id="h25-0-93" class="i">+                expressions: [
</a><a href="#h25-0-94" id="h25-0-94" class="i">+                    Constant(
</a><a href="#h25-0-95" id="h25-0-95" class="i">+                        Boolean(
</a><a href="#h25-0-96" id="h25-0-96" class="i">+                            true,
</a><a href="#h25-0-97" id="h25-0-97" class="i">+                        ),
</a><a href="#h25-0-98" id="h25-0-98" class="i">+                    ),
</a><a href="#h25-0-99" id="h25-0-99" class="i">+                ],
</a><a href="#h25-0-100" id="h25-0-100" class="i">+            },
</a><a href="#h25-0-101" id="h25-0-101" class="i">+            aggregates: [
</a><a href="#h25-0-102" id="h25-0-102" class="i">+                Count,
</a><a href="#h25-0-103" id="h25-0-103" class="i">+            ],
</a><a href="#h25-0-104" id="h25-0-104" class="i">+        },
</a><a href="#h25-0-105" id="h25-0-105" class="i">+        labels: [
</a><a href="#h25-0-106" id="h25-0-106" class="i">+            None,
</a><a href="#h25-0-107" id="h25-0-107" class="i">+            None,
</a><a href="#h25-0-108" id="h25-0-108" class="i">+        ],
</a><a href="#h25-0-109" id="h25-0-109" class="i">+        expressions: [
</a><a href="#h25-0-110" id="h25-0-110" class="i">+            Field(
</a><a href="#h25-0-111" id="h25-0-111" class="i">+                None,
</a><a href="#h25-0-112" id="h25-0-112" class="i">+                &quot;studio_id&quot;,
</a><a href="#h25-0-113" id="h25-0-113" class="i">+            ),
</a><a href="#h25-0-114" id="h25-0-114" class="i">+            Column(
</a><a href="#h25-0-115" id="h25-0-115" class="i">+                0,
</a><a href="#h25-0-116" id="h25-0-116" class="i">+            ),
</a><a href="#h25-0-117" id="h25-0-117" class="i">+        ],
</a><a href="#h25-0-118" id="h25-0-118" class="i">+    },
</a><a href="#h25-0-119" id="h25-0-119" class="i">+}
</a><a href="#h25-0-120" id="h25-0-120" class="i">+
</a><a href="#h25-0-121" id="h25-0-121" class="i">+Query: SELECT studio_id, COUNT(*) FROM movies
</a><a href="#h25-0-122" id="h25-0-122" class="i">+
</a><a href="#h25-0-123" id="h25-0-123" class="i">+Result: Value(&quot;Unknown field studio_id&quot;)
</a><a href="#h25-0-124" id="h25-0-124" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h26" href="../file/src/sql/tests/query/all.html">src/sql/tests/query/all</a> b/<a href="../file/src/sql/tests/query/all.html">src/sql/tests/query/all</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h26-0-3" id="h26-0-3" class="i">+    group_by: None,
</a><a href="#h26-0-4" id="h26-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h26-1" id="h26-1" class="h">@@ -38,8 +40,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h26-1-3" id="h26-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h26-1-4" id="h26-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h26-1-9" id="h26-1-9" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h26-1-10" id="h26-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h26-1-11" id="h26-1-11" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><a href="#h26-1-12" id="h26-1-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h26-1-13" id="h26-1-13" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><b>diff --git a/<a id="h27" href="../file/src/sql/tests/query/as_.html">src/sql/tests/query/as_</a> b/<a href="../file/src/sql/tests/query/as_.html">src/sql/tests/query/as_</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -55,6 +55,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h27-0-3" id="h27-0-3" class="i">+    group_by: None,
</a><a href="#h27-0-4" id="h27-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h27-1" id="h27-1" class="h">@@ -168,3 +170,8 @@ Result: [&quot;?&quot;, &quot;b&quot;, &quot;c&quot;, &quot;👋&quot;, &quot;some id&quot;]
</a> [Integer(1), Integer(2), Integer(3), Integer(4), Integer(3)]
 [Integer(1), Integer(2), Integer(3), Integer(4), Integer(4)]
 [Integer(1), Integer(2), Integer(3), Integer(4), Integer(5)]
<a href="#h27-1-3" id="h27-1-3" class="i">+[Integer(1), Integer(2), Integer(3), Integer(4), Integer(6)]
</a><a href="#h27-1-4" id="h27-1-4" class="i">+[Integer(1), Integer(2), Integer(3), Integer(4), Integer(7)]
</a><a href="#h27-1-5" id="h27-1-5" class="i">+[Integer(1), Integer(2), Integer(3), Integer(4), Integer(8)]
</a><a href="#h27-1-6" id="h27-1-6" class="i">+[Integer(1), Integer(2), Integer(3), Integer(4), Integer(9)]
</a><a href="#h27-1-7" id="h27-1-7" class="i">+[Integer(1), Integer(2), Integer(3), Integer(4), Integer(10)]
</a><b>diff --git a/<a id="h28" href="../file/src/sql/tests/query/as_duplicate.html">src/sql/tests/query/as_duplicate</a> b/<a href="../file/src/sql/tests/query/as_duplicate.html">src/sql/tests/query/as_duplicate</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -25,6 +25,8 @@ AST: Select {
</a>     },
     from: None,
     where: None,
<a href="#h28-0-3" id="h28-0-3" class="i">+    group_by: None,
</a><a href="#h28-0-4" id="h28-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h29" href="../file/src/sql/tests/query/expr_dynamic.html">src/sql/tests/query/expr_dynamic</a> b/<a href="../file/src/sql/tests/query/expr_dynamic.html">src/sql/tests/query/expr_dynamic</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -34,6 +34,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h29-0-3" id="h29-0-3" class="i">+    group_by: None,
</a><a href="#h29-0-4" id="h29-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h30" href="../file/src/sql/tests/query/expr_mixed.html">src/sql/tests/query/expr_mixed</a> b/<a href="../file/src/sql/tests/query/expr_mixed.html">src/sql/tests/query/expr_mixed</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -58,6 +58,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h30-0-3" id="h30-0-3" class="i">+    group_by: None,
</a><a href="#h30-0-4" id="h30-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h30-1" id="h30-1" class="h">@@ -151,3 +153,8 @@ Result: [&quot;?&quot;, &quot;age&quot;]
</a> [Integer(7), Integer(16)]
 [Integer(7), Integer(25)]
 [Integer(7), Integer(14)]
<a href="#h30-1-3" id="h30-1-3" class="i">+[Integer(7), Integer(48)]
</a><a href="#h30-1-4" id="h30-1-4" class="i">+[Integer(7), Integer(7)]
</a><a href="#h30-1-5" id="h30-1-5" class="i">+[Integer(7), Integer(2)]
</a><a href="#h30-1-6" id="h30-1-6" class="i">+[Integer(7), Integer(6)]
</a><a href="#h30-1-7" id="h30-1-7" class="i">+[Integer(7), Integer(10)]
</a><b>diff --git a/<a id="h31" href="../file/src/sql/tests/query/expr_static.html">src/sql/tests/query/expr_static</a> b/<a href="../file/src/sql/tests/query/expr_static.html">src/sql/tests/query/expr_static</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -50,6 +50,8 @@ AST: Select {
</a>     },
     from: None,
     where: None,
<a href="#h31-0-3" id="h31-0-3" class="i">+    group_by: None,
</a><a href="#h31-0-4" id="h31-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h32" href="../file/src/sql/tests/query/field_aliased.html">src/sql/tests/query/field_aliased</a> b/<a href="../file/src/sql/tests/query/field_aliased.html">src/sql/tests/query/field_aliased</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -40,6 +40,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h32-0-3" id="h32-0-3" class="i">+    group_by: None,
</a><a href="#h32-0-4" id="h32-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h32-1" id="h32-1" class="h">@@ -130,11 +132,31 @@ Query: SELECT m.id, g.id FROM movies AS m, genres g
</a> Result: [&quot;id&quot;, &quot;id&quot;]
 [Integer(1), Integer(1)]
 [Integer(1), Integer(2)]
<a href="#h32-1-3" id="h32-1-3" class="i">+[Integer(1), Integer(3)]
</a> [Integer(2), Integer(1)]
 [Integer(2), Integer(2)]
<a href="#h32-1-6" id="h32-1-6" class="i">+[Integer(2), Integer(3)]
</a> [Integer(3), Integer(1)]
 [Integer(3), Integer(2)]
<a href="#h32-1-9" id="h32-1-9" class="i">+[Integer(3), Integer(3)]
</a> [Integer(4), Integer(1)]
 [Integer(4), Integer(2)]
<a href="#h32-1-12" id="h32-1-12" class="i">+[Integer(4), Integer(3)]
</a> [Integer(5), Integer(1)]
 [Integer(5), Integer(2)]
<a href="#h32-1-15" id="h32-1-15" class="i">+[Integer(5), Integer(3)]
</a><a href="#h32-1-16" id="h32-1-16" class="i">+[Integer(6), Integer(1)]
</a><a href="#h32-1-17" id="h32-1-17" class="i">+[Integer(6), Integer(2)]
</a><a href="#h32-1-18" id="h32-1-18" class="i">+[Integer(6), Integer(3)]
</a><a href="#h32-1-19" id="h32-1-19" class="i">+[Integer(7), Integer(1)]
</a><a href="#h32-1-20" id="h32-1-20" class="i">+[Integer(7), Integer(2)]
</a><a href="#h32-1-21" id="h32-1-21" class="i">+[Integer(7), Integer(3)]
</a><a href="#h32-1-22" id="h32-1-22" class="i">+[Integer(8), Integer(1)]
</a><a href="#h32-1-23" id="h32-1-23" class="i">+[Integer(8), Integer(2)]
</a><a href="#h32-1-24" id="h32-1-24" class="i">+[Integer(8), Integer(3)]
</a><a href="#h32-1-25" id="h32-1-25" class="i">+[Integer(9), Integer(1)]
</a><a href="#h32-1-26" id="h32-1-26" class="i">+[Integer(9), Integer(2)]
</a><a href="#h32-1-27" id="h32-1-27" class="i">+[Integer(9), Integer(3)]
</a><a href="#h32-1-28" id="h32-1-28" class="i">+[Integer(10), Integer(1)]
</a><a href="#h32-1-29" id="h32-1-29" class="i">+[Integer(10), Integer(2)]
</a><a href="#h32-1-30" id="h32-1-30" class="i">+[Integer(10), Integer(3)]
</a><b>diff --git a/<a id="h33" href="../file/src/sql/tests/query/field_ambiguous.html">src/sql/tests/query/field_ambiguous</a> b/<a href="../file/src/sql/tests/query/field_ambiguous.html">src/sql/tests/query/field_ambiguous</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -27,6 +27,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h33-0-3" id="h33-0-3" class="i">+    group_by: None,
</a><a href="#h33-0-4" id="h33-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h34" href="../file/src/sql/tests/query/field_multi.html">src/sql/tests/query/field_multi</a> b/<a href="../file/src/sql/tests/query/field_multi.html">src/sql/tests/query/field_multi</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -28,6 +28,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h34-0-3" id="h34-0-3" class="i">+    group_by: None,
</a><a href="#h34-0-4" id="h34-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h34-1" id="h34-1" class="h">@@ -87,3 +89,8 @@ Result: [&quot;id&quot;, &quot;title&quot;]
</a> [Integer(3), String(&quot;Primer&quot;)]
 [Integer(4), String(&quot;Heat&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;)]
<a href="#h34-1-3" id="h34-1-3" class="i">+[Integer(6), String(&quot;Solaris&quot;)]
</a><a href="#h34-1-4" id="h34-1-4" class="i">+[Integer(7), String(&quot;Gravity&quot;)]
</a><a href="#h34-1-5" id="h34-1-5" class="i">+[Integer(8), String(&quot;Blindspotting&quot;)]
</a><a href="#h34-1-6" id="h34-1-6" class="i">+[Integer(9), String(&quot;Birdman&quot;)]
</a><a href="#h34-1-7" id="h34-1-7" class="i">+[Integer(10), String(&quot;Inception&quot;)]
</a><b>diff --git a/<a id="h35" href="../file/src/sql/tests/query/field_qualified.html">src/sql/tests/query/field_qualified</a> b/<a href="../file/src/sql/tests/query/field_qualified.html">src/sql/tests/query/field_qualified</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -25,6 +25,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h35-0-3" id="h35-0-3" class="i">+    group_by: None,
</a><a href="#h35-0-4" id="h35-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h35-1" id="h35-1" class="h">@@ -78,3 +80,8 @@ Result: [&quot;id&quot;]
</a> [Integer(3)]
 [Integer(4)]
 [Integer(5)]
<a href="#h35-1-3" id="h35-1-3" class="i">+[Integer(6)]
</a><a href="#h35-1-4" id="h35-1-4" class="i">+[Integer(7)]
</a><a href="#h35-1-5" id="h35-1-5" class="i">+[Integer(8)]
</a><a href="#h35-1-6" id="h35-1-6" class="i">+[Integer(9)]
</a><a href="#h35-1-7" id="h35-1-7" class="i">+[Integer(10)]
</a><b>diff --git a/<a id="h36" href="../file/src/sql/tests/query/field_qualified_multi.html">src/sql/tests/query/field_qualified_multi</a> b/<a href="../file/src/sql/tests/query/field_qualified_multi.html">src/sql/tests/query/field_qualified_multi</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -36,6 +36,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h36-0-3" id="h36-0-3" class="i">+    group_by: None,
</a><a href="#h36-0-4" id="h36-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h36-1" id="h36-1" class="h">@@ -118,11 +120,31 @@ Query: SELECT movies.id, genres.id FROM movies, genres
</a> Result: [&quot;id&quot;, &quot;id&quot;]
 [Integer(1), Integer(1)]
 [Integer(1), Integer(2)]
<a href="#h36-1-3" id="h36-1-3" class="i">+[Integer(1), Integer(3)]
</a> [Integer(2), Integer(1)]
 [Integer(2), Integer(2)]
<a href="#h36-1-6" id="h36-1-6" class="i">+[Integer(2), Integer(3)]
</a> [Integer(3), Integer(1)]
 [Integer(3), Integer(2)]
<a href="#h36-1-9" id="h36-1-9" class="i">+[Integer(3), Integer(3)]
</a> [Integer(4), Integer(1)]
 [Integer(4), Integer(2)]
<a href="#h36-1-12" id="h36-1-12" class="i">+[Integer(4), Integer(3)]
</a> [Integer(5), Integer(1)]
 [Integer(5), Integer(2)]
<a href="#h36-1-15" id="h36-1-15" class="i">+[Integer(5), Integer(3)]
</a><a href="#h36-1-16" id="h36-1-16" class="i">+[Integer(6), Integer(1)]
</a><a href="#h36-1-17" id="h36-1-17" class="i">+[Integer(6), Integer(2)]
</a><a href="#h36-1-18" id="h36-1-18" class="i">+[Integer(6), Integer(3)]
</a><a href="#h36-1-19" id="h36-1-19" class="i">+[Integer(7), Integer(1)]
</a><a href="#h36-1-20" id="h36-1-20" class="i">+[Integer(7), Integer(2)]
</a><a href="#h36-1-21" id="h36-1-21" class="i">+[Integer(7), Integer(3)]
</a><a href="#h36-1-22" id="h36-1-22" class="i">+[Integer(8), Integer(1)]
</a><a href="#h36-1-23" id="h36-1-23" class="i">+[Integer(8), Integer(2)]
</a><a href="#h36-1-24" id="h36-1-24" class="i">+[Integer(8), Integer(3)]
</a><a href="#h36-1-25" id="h36-1-25" class="i">+[Integer(9), Integer(1)]
</a><a href="#h36-1-26" id="h36-1-26" class="i">+[Integer(9), Integer(2)]
</a><a href="#h36-1-27" id="h36-1-27" class="i">+[Integer(9), Integer(3)]
</a><a href="#h36-1-28" id="h36-1-28" class="i">+[Integer(10), Integer(1)]
</a><a href="#h36-1-29" id="h36-1-29" class="i">+[Integer(10), Integer(2)]
</a><a href="#h36-1-30" id="h36-1-30" class="i">+[Integer(10), Integer(3)]
</a><b>diff --git a/<a id="h37" href="../file/src/sql/tests/query/field_single.html">src/sql/tests/query/field_single</a> b/<a href="../file/src/sql/tests/query/field_single.html">src/sql/tests/query/field_single</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -23,6 +23,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h37-0-3" id="h37-0-3" class="i">+    group_by: None,
</a><a href="#h37-0-4" id="h37-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h37-1" id="h37-1" class="h">@@ -72,3 +74,8 @@ Result: [&quot;id&quot;]
</a> [Integer(3)]
 [Integer(4)]
 [Integer(5)]
<a href="#h37-1-3" id="h37-1-3" class="i">+[Integer(6)]
</a><a href="#h37-1-4" id="h37-1-4" class="i">+[Integer(7)]
</a><a href="#h37-1-5" id="h37-1-5" class="i">+[Integer(8)]
</a><a href="#h37-1-6" id="h37-1-6" class="i">+[Integer(9)]
</a><a href="#h37-1-7" id="h37-1-7" class="i">+[Integer(10)]
</a><b>diff --git a/<a id="h38" href="../file/src/sql/tests/query/field_unknown.html">src/sql/tests/query/field_unknown</a> b/<a href="../file/src/sql/tests/query/field_unknown.html">src/sql/tests/query/field_unknown</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -23,6 +23,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h38-0-3" id="h38-0-3" class="i">+    group_by: None,
</a><a href="#h38-0-4" id="h38-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h39" href="../file/src/sql/tests/query/field_unknown_aliased.html">src/sql/tests/query/field_unknown_aliased</a> b/<a href="../file/src/sql/tests/query/field_unknown_aliased.html">src/sql/tests/query/field_unknown_aliased</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -27,6 +27,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h39-0-3" id="h39-0-3" class="i">+    group_by: None,
</a><a href="#h39-0-4" id="h39-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h40" href="../file/src/sql/tests/query/field_unknown_qualified.html">src/sql/tests/query/field_unknown_qualified</a> b/<a href="../file/src/sql/tests/query/field_unknown_qualified.html">src/sql/tests/query/field_unknown_qualified</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -25,6 +25,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h40-0-3" id="h40-0-3" class="i">+    group_by: None,
</a><a href="#h40-0-4" id="h40-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h41" href="../file/src/sql/tests/query/field_unknown_table.html">src/sql/tests/query/field_unknown_table</a> b/<a href="../file/src/sql/tests/query/field_unknown_table.html">src/sql/tests/query/field_unknown_table</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -25,6 +25,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h41-0-3" id="h41-0-3" class="i">+    group_by: None,
</a><a href="#h41-0-4" id="h41-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h42" href="../file/src/sql/tests/query/from_multiple.html">src/sql/tests/query/from_multiple</a> b/<a href="../file/src/sql/tests/query/from_multiple.html">src/sql/tests/query/from_multiple</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -24,6 +24,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h42-0-3" id="h42-0-3" class="i">+    group_by: None,
</a><a href="#h42-0-4" id="h42-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h42-1" id="h42-1" class="h">@@ -82,33 +84,93 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies, genres, countries
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;, &quot;id&quot;, &quot;name&quot;]
<a href="#h42-1-3" id="h42-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-4" id="h42-1-4" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-5" id="h42-1-5" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-6" id="h42-1-6" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-7" id="h42-1-7" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-8" id="h42-1-8" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-9" id="h42-1-9" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-10" id="h42-1-10" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-11" id="h42-1-11" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-12" id="h42-1-12" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-13" id="h42-1-13" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-14" id="h42-1-14" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-15" id="h42-1-15" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-16" id="h42-1-16" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-17" id="h42-1-17" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
<a href="#h42-1-24" id="h42-1-24" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-25" id="h42-1-25" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-26" id="h42-1-26" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a> [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
<a href="#h42-1-33" id="h42-1-33" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-34" id="h42-1-34" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-35" id="h42-1-35" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
<a href="#h42-1-42" id="h42-1-42" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-43" id="h42-1-43" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-44" id="h42-1-44" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
<a href="#h42-1-51" id="h42-1-51" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-52" id="h42-1-52" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-53" id="h42-1-53" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-54" id="h42-1-54" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-55" id="h42-1-55" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-56" id="h42-1-56" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-57" id="h42-1-57" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-58" id="h42-1-58" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-59" id="h42-1-59" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-60" id="h42-1-60" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-61" id="h42-1-61" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-62" id="h42-1-62" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-63" id="h42-1-63" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-64" id="h42-1-64" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-65" id="h42-1-65" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-66" id="h42-1-66" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-67" id="h42-1-67" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-68" id="h42-1-68" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-69" id="h42-1-69" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-70" id="h42-1-70" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-71" id="h42-1-71" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-72" id="h42-1-72" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-73" id="h42-1-73" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-74" id="h42-1-74" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-75" id="h42-1-75" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-76" id="h42-1-76" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-77" id="h42-1-77" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-78" id="h42-1-78" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-79" id="h42-1-79" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-80" id="h42-1-80" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-81" id="h42-1-81" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-82" id="h42-1-82" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-83" id="h42-1-83" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-84" id="h42-1-84" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-85" id="h42-1-85" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-86" id="h42-1-86" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-87" id="h42-1-87" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-88" id="h42-1-88" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-89" id="h42-1-89" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-90" id="h42-1-90" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-91" id="h42-1-91" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-92" id="h42-1-92" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-93" id="h42-1-93" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-94" id="h42-1-94" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-95" id="h42-1-95" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><a href="#h42-1-96" id="h42-1-96" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h42-1-97" id="h42-1-97" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h42-1-98" id="h42-1-98" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;)]
</a><b>diff --git a/<a id="h43" href="../file/src/sql/tests/query/from_unknown.html">src/sql/tests/query/from_unknown</a> b/<a href="../file/src/sql/tests/query/from_unknown.html">src/sql/tests/query/from_unknown</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h43-0-3" id="h43-0-3" class="i">+    group_by: None,
</a><a href="#h43-0-4" id="h43-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h44" href="../file/src/sql/tests/query/group_expr.html">src/sql/tests/query/group_expr</a> b/<a href="../file/src/sql/tests/query/group_expr.html">src/sql/tests/query/group_expr</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -0,0 +1,188 @@
</a><a href="#h44-0-0" id="h44-0-0" class="i">+Query: SELECT MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
</a><a href="#h44-0-1" id="h44-0-1" class="i">+
</a><a href="#h44-0-2" id="h44-0-2" class="i">+AST: Select {
</a><a href="#h44-0-3" id="h44-0-3" class="i">+    select: SelectClause {
</a><a href="#h44-0-4" id="h44-0-4" class="i">+        expressions: [
</a><a href="#h44-0-5" id="h44-0-5" class="i">+            Function(
</a><a href="#h44-0-6" id="h44-0-6" class="i">+                &quot;max&quot;,
</a><a href="#h44-0-7" id="h44-0-7" class="i">+                [
</a><a href="#h44-0-8" id="h44-0-8" class="i">+                    Field(
</a><a href="#h44-0-9" id="h44-0-9" class="i">+                        None,
</a><a href="#h44-0-10" id="h44-0-10" class="i">+                        &quot;rating&quot;,
</a><a href="#h44-0-11" id="h44-0-11" class="i">+                    ),
</a><a href="#h44-0-12" id="h44-0-12" class="i">+                ],
</a><a href="#h44-0-13" id="h44-0-13" class="i">+            ),
</a><a href="#h44-0-14" id="h44-0-14" class="i">+        ],
</a><a href="#h44-0-15" id="h44-0-15" class="i">+        labels: [
</a><a href="#h44-0-16" id="h44-0-16" class="i">+            Some(
</a><a href="#h44-0-17" id="h44-0-17" class="i">+                &quot;rating&quot;,
</a><a href="#h44-0-18" id="h44-0-18" class="i">+            ),
</a><a href="#h44-0-19" id="h44-0-19" class="i">+        ],
</a><a href="#h44-0-20" id="h44-0-20" class="i">+    },
</a><a href="#h44-0-21" id="h44-0-21" class="i">+    from: Some(
</a><a href="#h44-0-22" id="h44-0-22" class="i">+        FromClause {
</a><a href="#h44-0-23" id="h44-0-23" class="i">+            items: [
</a><a href="#h44-0-24" id="h44-0-24" class="i">+                Table {
</a><a href="#h44-0-25" id="h44-0-25" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h44-0-26" id="h44-0-26" class="i">+                    alias: None,
</a><a href="#h44-0-27" id="h44-0-27" class="i">+                },
</a><a href="#h44-0-28" id="h44-0-28" class="i">+            ],
</a><a href="#h44-0-29" id="h44-0-29" class="i">+        },
</a><a href="#h44-0-30" id="h44-0-30" class="i">+    ),
</a><a href="#h44-0-31" id="h44-0-31" class="i">+    where: None,
</a><a href="#h44-0-32" id="h44-0-32" class="i">+    group_by: Some(
</a><a href="#h44-0-33" id="h44-0-33" class="i">+        GroupByClause(
</a><a href="#h44-0-34" id="h44-0-34" class="i">+            [
</a><a href="#h44-0-35" id="h44-0-35" class="i">+                Operation(
</a><a href="#h44-0-36" id="h44-0-36" class="i">+                    Multiply(
</a><a href="#h44-0-37" id="h44-0-37" class="i">+                        Field(
</a><a href="#h44-0-38" id="h44-0-38" class="i">+                            None,
</a><a href="#h44-0-39" id="h44-0-39" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h44-0-40" id="h44-0-40" class="i">+                        ),
</a><a href="#h44-0-41" id="h44-0-41" class="i">+                        Literal(
</a><a href="#h44-0-42" id="h44-0-42" class="i">+                            Integer(
</a><a href="#h44-0-43" id="h44-0-43" class="i">+                                2,
</a><a href="#h44-0-44" id="h44-0-44" class="i">+                            ),
</a><a href="#h44-0-45" id="h44-0-45" class="i">+                        ),
</a><a href="#h44-0-46" id="h44-0-46" class="i">+                    ),
</a><a href="#h44-0-47" id="h44-0-47" class="i">+                ),
</a><a href="#h44-0-48" id="h44-0-48" class="i">+            ],
</a><a href="#h44-0-49" id="h44-0-49" class="i">+        ),
</a><a href="#h44-0-50" id="h44-0-50" class="i">+    ),
</a><a href="#h44-0-51" id="h44-0-51" class="i">+    having: None,
</a><a href="#h44-0-52" id="h44-0-52" class="i">+    order: [
</a><a href="#h44-0-53" id="h44-0-53" class="i">+        (
</a><a href="#h44-0-54" id="h44-0-54" class="i">+            Field(
</a><a href="#h44-0-55" id="h44-0-55" class="i">+                None,
</a><a href="#h44-0-56" id="h44-0-56" class="i">+                &quot;rating&quot;,
</a><a href="#h44-0-57" id="h44-0-57" class="i">+            ),
</a><a href="#h44-0-58" id="h44-0-58" class="i">+            Ascending,
</a><a href="#h44-0-59" id="h44-0-59" class="i">+        ),
</a><a href="#h44-0-60" id="h44-0-60" class="i">+    ],
</a><a href="#h44-0-61" id="h44-0-61" class="i">+    limit: None,
</a><a href="#h44-0-62" id="h44-0-62" class="i">+    offset: None,
</a><a href="#h44-0-63" id="h44-0-63" class="i">+}
</a><a href="#h44-0-64" id="h44-0-64" class="i">+
</a><a href="#h44-0-65" id="h44-0-65" class="i">+Plan: Plan {
</a><a href="#h44-0-66" id="h44-0-66" class="i">+    root: Order {
</a><a href="#h44-0-67" id="h44-0-67" class="i">+        source: Projection {
</a><a href="#h44-0-68" id="h44-0-68" class="i">+            source: Aggregation {
</a><a href="#h44-0-69" id="h44-0-69" class="i">+                source: Projection {
</a><a href="#h44-0-70" id="h44-0-70" class="i">+                    source: Scan {
</a><a href="#h44-0-71" id="h44-0-71" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h44-0-72" id="h44-0-72" class="i">+                        alias: None,
</a><a href="#h44-0-73" id="h44-0-73" class="i">+                    },
</a><a href="#h44-0-74" id="h44-0-74" class="i">+                    labels: [
</a><a href="#h44-0-75" id="h44-0-75" class="i">+                        None,
</a><a href="#h44-0-76" id="h44-0-76" class="i">+                        None,
</a><a href="#h44-0-77" id="h44-0-77" class="i">+                    ],
</a><a href="#h44-0-78" id="h44-0-78" class="i">+                    expressions: [
</a><a href="#h44-0-79" id="h44-0-79" class="i">+                        Field(
</a><a href="#h44-0-80" id="h44-0-80" class="i">+                            None,
</a><a href="#h44-0-81" id="h44-0-81" class="i">+                            &quot;rating&quot;,
</a><a href="#h44-0-82" id="h44-0-82" class="i">+                        ),
</a><a href="#h44-0-83" id="h44-0-83" class="i">+                        Multiply(
</a><a href="#h44-0-84" id="h44-0-84" class="i">+                            Field(
</a><a href="#h44-0-85" id="h44-0-85" class="i">+                                None,
</a><a href="#h44-0-86" id="h44-0-86" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h44-0-87" id="h44-0-87" class="i">+                            ),
</a><a href="#h44-0-88" id="h44-0-88" class="i">+                            Constant(
</a><a href="#h44-0-89" id="h44-0-89" class="i">+                                Integer(
</a><a href="#h44-0-90" id="h44-0-90" class="i">+                                    2,
</a><a href="#h44-0-91" id="h44-0-91" class="i">+                                ),
</a><a href="#h44-0-92" id="h44-0-92" class="i">+                            ),
</a><a href="#h44-0-93" id="h44-0-93" class="i">+                        ),
</a><a href="#h44-0-94" id="h44-0-94" class="i">+                    ],
</a><a href="#h44-0-95" id="h44-0-95" class="i">+                },
</a><a href="#h44-0-96" id="h44-0-96" class="i">+                aggregates: [
</a><a href="#h44-0-97" id="h44-0-97" class="i">+                    Max,
</a><a href="#h44-0-98" id="h44-0-98" class="i">+                ],
</a><a href="#h44-0-99" id="h44-0-99" class="i">+            },
</a><a href="#h44-0-100" id="h44-0-100" class="i">+            labels: [
</a><a href="#h44-0-101" id="h44-0-101" class="i">+                Some(
</a><a href="#h44-0-102" id="h44-0-102" class="i">+                    &quot;rating&quot;,
</a><a href="#h44-0-103" id="h44-0-103" class="i">+                ),
</a><a href="#h44-0-104" id="h44-0-104" class="i">+            ],
</a><a href="#h44-0-105" id="h44-0-105" class="i">+            expressions: [
</a><a href="#h44-0-106" id="h44-0-106" class="i">+                Column(
</a><a href="#h44-0-107" id="h44-0-107" class="i">+                    0,
</a><a href="#h44-0-108" id="h44-0-108" class="i">+                ),
</a><a href="#h44-0-109" id="h44-0-109" class="i">+            ],
</a><a href="#h44-0-110" id="h44-0-110" class="i">+        },
</a><a href="#h44-0-111" id="h44-0-111" class="i">+        orders: [
</a><a href="#h44-0-112" id="h44-0-112" class="i">+            (
</a><a href="#h44-0-113" id="h44-0-113" class="i">+                Field(
</a><a href="#h44-0-114" id="h44-0-114" class="i">+                    None,
</a><a href="#h44-0-115" id="h44-0-115" class="i">+                    &quot;rating&quot;,
</a><a href="#h44-0-116" id="h44-0-116" class="i">+                ),
</a><a href="#h44-0-117" id="h44-0-117" class="i">+                Ascending,
</a><a href="#h44-0-118" id="h44-0-118" class="i">+            ),
</a><a href="#h44-0-119" id="h44-0-119" class="i">+        ],
</a><a href="#h44-0-120" id="h44-0-120" class="i">+    },
</a><a href="#h44-0-121" id="h44-0-121" class="i">+}
</a><a href="#h44-0-122" id="h44-0-122" class="i">+
</a><a href="#h44-0-123" id="h44-0-123" class="i">+Optimized plan: Plan {
</a><a href="#h44-0-124" id="h44-0-124" class="i">+    root: Order {
</a><a href="#h44-0-125" id="h44-0-125" class="i">+        source: Projection {
</a><a href="#h44-0-126" id="h44-0-126" class="i">+            source: Aggregation {
</a><a href="#h44-0-127" id="h44-0-127" class="i">+                source: Projection {
</a><a href="#h44-0-128" id="h44-0-128" class="i">+                    source: Scan {
</a><a href="#h44-0-129" id="h44-0-129" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h44-0-130" id="h44-0-130" class="i">+                        alias: None,
</a><a href="#h44-0-131" id="h44-0-131" class="i">+                    },
</a><a href="#h44-0-132" id="h44-0-132" class="i">+                    labels: [
</a><a href="#h44-0-133" id="h44-0-133" class="i">+                        None,
</a><a href="#h44-0-134" id="h44-0-134" class="i">+                        None,
</a><a href="#h44-0-135" id="h44-0-135" class="i">+                    ],
</a><a href="#h44-0-136" id="h44-0-136" class="i">+                    expressions: [
</a><a href="#h44-0-137" id="h44-0-137" class="i">+                        Field(
</a><a href="#h44-0-138" id="h44-0-138" class="i">+                            None,
</a><a href="#h44-0-139" id="h44-0-139" class="i">+                            &quot;rating&quot;,
</a><a href="#h44-0-140" id="h44-0-140" class="i">+                        ),
</a><a href="#h44-0-141" id="h44-0-141" class="i">+                        Multiply(
</a><a href="#h44-0-142" id="h44-0-142" class="i">+                            Field(
</a><a href="#h44-0-143" id="h44-0-143" class="i">+                                None,
</a><a href="#h44-0-144" id="h44-0-144" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h44-0-145" id="h44-0-145" class="i">+                            ),
</a><a href="#h44-0-146" id="h44-0-146" class="i">+                            Constant(
</a><a href="#h44-0-147" id="h44-0-147" class="i">+                                Integer(
</a><a href="#h44-0-148" id="h44-0-148" class="i">+                                    2,
</a><a href="#h44-0-149" id="h44-0-149" class="i">+                                ),
</a><a href="#h44-0-150" id="h44-0-150" class="i">+                            ),
</a><a href="#h44-0-151" id="h44-0-151" class="i">+                        ),
</a><a href="#h44-0-152" id="h44-0-152" class="i">+                    ],
</a><a href="#h44-0-153" id="h44-0-153" class="i">+                },
</a><a href="#h44-0-154" id="h44-0-154" class="i">+                aggregates: [
</a><a href="#h44-0-155" id="h44-0-155" class="i">+                    Max,
</a><a href="#h44-0-156" id="h44-0-156" class="i">+                ],
</a><a href="#h44-0-157" id="h44-0-157" class="i">+            },
</a><a href="#h44-0-158" id="h44-0-158" class="i">+            labels: [
</a><a href="#h44-0-159" id="h44-0-159" class="i">+                Some(
</a><a href="#h44-0-160" id="h44-0-160" class="i">+                    &quot;rating&quot;,
</a><a href="#h44-0-161" id="h44-0-161" class="i">+                ),
</a><a href="#h44-0-162" id="h44-0-162" class="i">+            ],
</a><a href="#h44-0-163" id="h44-0-163" class="i">+            expressions: [
</a><a href="#h44-0-164" id="h44-0-164" class="i">+                Column(
</a><a href="#h44-0-165" id="h44-0-165" class="i">+                    0,
</a><a href="#h44-0-166" id="h44-0-166" class="i">+                ),
</a><a href="#h44-0-167" id="h44-0-167" class="i">+            ],
</a><a href="#h44-0-168" id="h44-0-168" class="i">+        },
</a><a href="#h44-0-169" id="h44-0-169" class="i">+        orders: [
</a><a href="#h44-0-170" id="h44-0-170" class="i">+            (
</a><a href="#h44-0-171" id="h44-0-171" class="i">+                Field(
</a><a href="#h44-0-172" id="h44-0-172" class="i">+                    None,
</a><a href="#h44-0-173" id="h44-0-173" class="i">+                    &quot;rating&quot;,
</a><a href="#h44-0-174" id="h44-0-174" class="i">+                ),
</a><a href="#h44-0-175" id="h44-0-175" class="i">+                Ascending,
</a><a href="#h44-0-176" id="h44-0-176" class="i">+            ),
</a><a href="#h44-0-177" id="h44-0-177" class="i">+        ],
</a><a href="#h44-0-178" id="h44-0-178" class="i">+    },
</a><a href="#h44-0-179" id="h44-0-179" class="i">+}
</a><a href="#h44-0-180" id="h44-0-180" class="i">+
</a><a href="#h44-0-181" id="h44-0-181" class="i">+Query: SELECT MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
</a><a href="#h44-0-182" id="h44-0-182" class="i">+
</a><a href="#h44-0-183" id="h44-0-183" class="i">+Result: [&quot;rating&quot;]
</a><a href="#h44-0-184" id="h44-0-184" class="i">+[Float(6.9)]
</a><a href="#h44-0-185" id="h44-0-185" class="i">+[Float(7.6)]
</a><a href="#h44-0-186" id="h44-0-186" class="i">+[Float(8.2)]
</a><a href="#h44-0-187" id="h44-0-187" class="i">+[Float(8.8)]
</a><b>diff --git a/<a id="h45" href="../file/src/sql/tests/query/group_expr_aggr.html">src/sql/tests/query/group_expr_aggr</a> b/<a href="../file/src/sql/tests/query/group_expr_aggr.html">src/sql/tests/query/group_expr_aggr</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -0,0 +1,235 @@
</a><a href="#h45-0-0" id="h45-0-0" class="i">+Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h45-0-1" id="h45-0-1" class="i">+
</a><a href="#h45-0-2" id="h45-0-2" class="i">+AST: Select {
</a><a href="#h45-0-3" id="h45-0-3" class="i">+    select: SelectClause {
</a><a href="#h45-0-4" id="h45-0-4" class="i">+        expressions: [
</a><a href="#h45-0-5" id="h45-0-5" class="i">+            Field(
</a><a href="#h45-0-6" id="h45-0-6" class="i">+                None,
</a><a href="#h45-0-7" id="h45-0-7" class="i">+                &quot;studio_id&quot;,
</a><a href="#h45-0-8" id="h45-0-8" class="i">+            ),
</a><a href="#h45-0-9" id="h45-0-9" class="i">+            Operation(
</a><a href="#h45-0-10" id="h45-0-10" class="i">+                Divide(
</a><a href="#h45-0-11" id="h45-0-11" class="i">+                    Function(
</a><a href="#h45-0-12" id="h45-0-12" class="i">+                        &quot;sum&quot;,
</a><a href="#h45-0-13" id="h45-0-13" class="i">+                        [
</a><a href="#h45-0-14" id="h45-0-14" class="i">+                            Operation(
</a><a href="#h45-0-15" id="h45-0-15" class="i">+                                Multiply(
</a><a href="#h45-0-16" id="h45-0-16" class="i">+                                    Field(
</a><a href="#h45-0-17" id="h45-0-17" class="i">+                                        None,
</a><a href="#h45-0-18" id="h45-0-18" class="i">+                                        &quot;rating&quot;,
</a><a href="#h45-0-19" id="h45-0-19" class="i">+                                    ),
</a><a href="#h45-0-20" id="h45-0-20" class="i">+                                    Literal(
</a><a href="#h45-0-21" id="h45-0-21" class="i">+                                        Integer(
</a><a href="#h45-0-22" id="h45-0-22" class="i">+                                            10,
</a><a href="#h45-0-23" id="h45-0-23" class="i">+                                        ),
</a><a href="#h45-0-24" id="h45-0-24" class="i">+                                    ),
</a><a href="#h45-0-25" id="h45-0-25" class="i">+                                ),
</a><a href="#h45-0-26" id="h45-0-26" class="i">+                            ),
</a><a href="#h45-0-27" id="h45-0-27" class="i">+                        ],
</a><a href="#h45-0-28" id="h45-0-28" class="i">+                    ),
</a><a href="#h45-0-29" id="h45-0-29" class="i">+                    Function(
</a><a href="#h45-0-30" id="h45-0-30" class="i">+                        &quot;count&quot;,
</a><a href="#h45-0-31" id="h45-0-31" class="i">+                        [
</a><a href="#h45-0-32" id="h45-0-32" class="i">+                            Literal(
</a><a href="#h45-0-33" id="h45-0-33" class="i">+                                Boolean(
</a><a href="#h45-0-34" id="h45-0-34" class="i">+                                    true,
</a><a href="#h45-0-35" id="h45-0-35" class="i">+                                ),
</a><a href="#h45-0-36" id="h45-0-36" class="i">+                            ),
</a><a href="#h45-0-37" id="h45-0-37" class="i">+                        ],
</a><a href="#h45-0-38" id="h45-0-38" class="i">+                    ),
</a><a href="#h45-0-39" id="h45-0-39" class="i">+                ),
</a><a href="#h45-0-40" id="h45-0-40" class="i">+            ),
</a><a href="#h45-0-41" id="h45-0-41" class="i">+        ],
</a><a href="#h45-0-42" id="h45-0-42" class="i">+        labels: [
</a><a href="#h45-0-43" id="h45-0-43" class="i">+            None,
</a><a href="#h45-0-44" id="h45-0-44" class="i">+            None,
</a><a href="#h45-0-45" id="h45-0-45" class="i">+        ],
</a><a href="#h45-0-46" id="h45-0-46" class="i">+    },
</a><a href="#h45-0-47" id="h45-0-47" class="i">+    from: Some(
</a><a href="#h45-0-48" id="h45-0-48" class="i">+        FromClause {
</a><a href="#h45-0-49" id="h45-0-49" class="i">+            items: [
</a><a href="#h45-0-50" id="h45-0-50" class="i">+                Table {
</a><a href="#h45-0-51" id="h45-0-51" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h45-0-52" id="h45-0-52" class="i">+                    alias: None,
</a><a href="#h45-0-53" id="h45-0-53" class="i">+                },
</a><a href="#h45-0-54" id="h45-0-54" class="i">+            ],
</a><a href="#h45-0-55" id="h45-0-55" class="i">+        },
</a><a href="#h45-0-56" id="h45-0-56" class="i">+    ),
</a><a href="#h45-0-57" id="h45-0-57" class="i">+    where: None,
</a><a href="#h45-0-58" id="h45-0-58" class="i">+    group_by: Some(
</a><a href="#h45-0-59" id="h45-0-59" class="i">+        GroupByClause(
</a><a href="#h45-0-60" id="h45-0-60" class="i">+            [
</a><a href="#h45-0-61" id="h45-0-61" class="i">+                Field(
</a><a href="#h45-0-62" id="h45-0-62" class="i">+                    None,
</a><a href="#h45-0-63" id="h45-0-63" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h45-0-64" id="h45-0-64" class="i">+                ),
</a><a href="#h45-0-65" id="h45-0-65" class="i">+            ],
</a><a href="#h45-0-66" id="h45-0-66" class="i">+        ),
</a><a href="#h45-0-67" id="h45-0-67" class="i">+    ),
</a><a href="#h45-0-68" id="h45-0-68" class="i">+    having: None,
</a><a href="#h45-0-69" id="h45-0-69" class="i">+    order: [
</a><a href="#h45-0-70" id="h45-0-70" class="i">+        (
</a><a href="#h45-0-71" id="h45-0-71" class="i">+            Field(
</a><a href="#h45-0-72" id="h45-0-72" class="i">+                None,
</a><a href="#h45-0-73" id="h45-0-73" class="i">+                &quot;studio_id&quot;,
</a><a href="#h45-0-74" id="h45-0-74" class="i">+            ),
</a><a href="#h45-0-75" id="h45-0-75" class="i">+            Ascending,
</a><a href="#h45-0-76" id="h45-0-76" class="i">+        ),
</a><a href="#h45-0-77" id="h45-0-77" class="i">+    ],
</a><a href="#h45-0-78" id="h45-0-78" class="i">+    limit: None,
</a><a href="#h45-0-79" id="h45-0-79" class="i">+    offset: None,
</a><a href="#h45-0-80" id="h45-0-80" class="i">+}
</a><a href="#h45-0-81" id="h45-0-81" class="i">+
</a><a href="#h45-0-82" id="h45-0-82" class="i">+Plan: Plan {
</a><a href="#h45-0-83" id="h45-0-83" class="i">+    root: Order {
</a><a href="#h45-0-84" id="h45-0-84" class="i">+        source: Projection {
</a><a href="#h45-0-85" id="h45-0-85" class="i">+            source: Aggregation {
</a><a href="#h45-0-86" id="h45-0-86" class="i">+                source: Projection {
</a><a href="#h45-0-87" id="h45-0-87" class="i">+                    source: Scan {
</a><a href="#h45-0-88" id="h45-0-88" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h45-0-89" id="h45-0-89" class="i">+                        alias: None,
</a><a href="#h45-0-90" id="h45-0-90" class="i">+                    },
</a><a href="#h45-0-91" id="h45-0-91" class="i">+                    labels: [
</a><a href="#h45-0-92" id="h45-0-92" class="i">+                        None,
</a><a href="#h45-0-93" id="h45-0-93" class="i">+                        None,
</a><a href="#h45-0-94" id="h45-0-94" class="i">+                        None,
</a><a href="#h45-0-95" id="h45-0-95" class="i">+                    ],
</a><a href="#h45-0-96" id="h45-0-96" class="i">+                    expressions: [
</a><a href="#h45-0-97" id="h45-0-97" class="i">+                        Multiply(
</a><a href="#h45-0-98" id="h45-0-98" class="i">+                            Field(
</a><a href="#h45-0-99" id="h45-0-99" class="i">+                                None,
</a><a href="#h45-0-100" id="h45-0-100" class="i">+                                &quot;rating&quot;,
</a><a href="#h45-0-101" id="h45-0-101" class="i">+                            ),
</a><a href="#h45-0-102" id="h45-0-102" class="i">+                            Constant(
</a><a href="#h45-0-103" id="h45-0-103" class="i">+                                Integer(
</a><a href="#h45-0-104" id="h45-0-104" class="i">+                                    10,
</a><a href="#h45-0-105" id="h45-0-105" class="i">+                                ),
</a><a href="#h45-0-106" id="h45-0-106" class="i">+                            ),
</a><a href="#h45-0-107" id="h45-0-107" class="i">+                        ),
</a><a href="#h45-0-108" id="h45-0-108" class="i">+                        Constant(
</a><a href="#h45-0-109" id="h45-0-109" class="i">+                            Boolean(
</a><a href="#h45-0-110" id="h45-0-110" class="i">+                                true,
</a><a href="#h45-0-111" id="h45-0-111" class="i">+                            ),
</a><a href="#h45-0-112" id="h45-0-112" class="i">+                        ),
</a><a href="#h45-0-113" id="h45-0-113" class="i">+                        Field(
</a><a href="#h45-0-114" id="h45-0-114" class="i">+                            None,
</a><a href="#h45-0-115" id="h45-0-115" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h45-0-116" id="h45-0-116" class="i">+                        ),
</a><a href="#h45-0-117" id="h45-0-117" class="i">+                    ],
</a><a href="#h45-0-118" id="h45-0-118" class="i">+                },
</a><a href="#h45-0-119" id="h45-0-119" class="i">+                aggregates: [
</a><a href="#h45-0-120" id="h45-0-120" class="i">+                    Sum,
</a><a href="#h45-0-121" id="h45-0-121" class="i">+                    Count,
</a><a href="#h45-0-122" id="h45-0-122" class="i">+                ],
</a><a href="#h45-0-123" id="h45-0-123" class="i">+            },
</a><a href="#h45-0-124" id="h45-0-124" class="i">+            labels: [
</a><a href="#h45-0-125" id="h45-0-125" class="i">+                None,
</a><a href="#h45-0-126" id="h45-0-126" class="i">+                None,
</a><a href="#h45-0-127" id="h45-0-127" class="i">+            ],
</a><a href="#h45-0-128" id="h45-0-128" class="i">+            expressions: [
</a><a href="#h45-0-129" id="h45-0-129" class="i">+                Field(
</a><a href="#h45-0-130" id="h45-0-130" class="i">+                    None,
</a><a href="#h45-0-131" id="h45-0-131" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h45-0-132" id="h45-0-132" class="i">+                ),
</a><a href="#h45-0-133" id="h45-0-133" class="i">+                Divide(
</a><a href="#h45-0-134" id="h45-0-134" class="i">+                    Column(
</a><a href="#h45-0-135" id="h45-0-135" class="i">+                        0,
</a><a href="#h45-0-136" id="h45-0-136" class="i">+                    ),
</a><a href="#h45-0-137" id="h45-0-137" class="i">+                    Column(
</a><a href="#h45-0-138" id="h45-0-138" class="i">+                        1,
</a><a href="#h45-0-139" id="h45-0-139" class="i">+                    ),
</a><a href="#h45-0-140" id="h45-0-140" class="i">+                ),
</a><a href="#h45-0-141" id="h45-0-141" class="i">+            ],
</a><a href="#h45-0-142" id="h45-0-142" class="i">+        },
</a><a href="#h45-0-143" id="h45-0-143" class="i">+        orders: [
</a><a href="#h45-0-144" id="h45-0-144" class="i">+            (
</a><a href="#h45-0-145" id="h45-0-145" class="i">+                Field(
</a><a href="#h45-0-146" id="h45-0-146" class="i">+                    None,
</a><a href="#h45-0-147" id="h45-0-147" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h45-0-148" id="h45-0-148" class="i">+                ),
</a><a href="#h45-0-149" id="h45-0-149" class="i">+                Ascending,
</a><a href="#h45-0-150" id="h45-0-150" class="i">+            ),
</a><a href="#h45-0-151" id="h45-0-151" class="i">+        ],
</a><a href="#h45-0-152" id="h45-0-152" class="i">+    },
</a><a href="#h45-0-153" id="h45-0-153" class="i">+}
</a><a href="#h45-0-154" id="h45-0-154" class="i">+
</a><a href="#h45-0-155" id="h45-0-155" class="i">+Optimized plan: Plan {
</a><a href="#h45-0-156" id="h45-0-156" class="i">+    root: Order {
</a><a href="#h45-0-157" id="h45-0-157" class="i">+        source: Projection {
</a><a href="#h45-0-158" id="h45-0-158" class="i">+            source: Aggregation {
</a><a href="#h45-0-159" id="h45-0-159" class="i">+                source: Projection {
</a><a href="#h45-0-160" id="h45-0-160" class="i">+                    source: Scan {
</a><a href="#h45-0-161" id="h45-0-161" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h45-0-162" id="h45-0-162" class="i">+                        alias: None,
</a><a href="#h45-0-163" id="h45-0-163" class="i">+                    },
</a><a href="#h45-0-164" id="h45-0-164" class="i">+                    labels: [
</a><a href="#h45-0-165" id="h45-0-165" class="i">+                        None,
</a><a href="#h45-0-166" id="h45-0-166" class="i">+                        None,
</a><a href="#h45-0-167" id="h45-0-167" class="i">+                        None,
</a><a href="#h45-0-168" id="h45-0-168" class="i">+                    ],
</a><a href="#h45-0-169" id="h45-0-169" class="i">+                    expressions: [
</a><a href="#h45-0-170" id="h45-0-170" class="i">+                        Multiply(
</a><a href="#h45-0-171" id="h45-0-171" class="i">+                            Field(
</a><a href="#h45-0-172" id="h45-0-172" class="i">+                                None,
</a><a href="#h45-0-173" id="h45-0-173" class="i">+                                &quot;rating&quot;,
</a><a href="#h45-0-174" id="h45-0-174" class="i">+                            ),
</a><a href="#h45-0-175" id="h45-0-175" class="i">+                            Constant(
</a><a href="#h45-0-176" id="h45-0-176" class="i">+                                Integer(
</a><a href="#h45-0-177" id="h45-0-177" class="i">+                                    10,
</a><a href="#h45-0-178" id="h45-0-178" class="i">+                                ),
</a><a href="#h45-0-179" id="h45-0-179" class="i">+                            ),
</a><a href="#h45-0-180" id="h45-0-180" class="i">+                        ),
</a><a href="#h45-0-181" id="h45-0-181" class="i">+                        Constant(
</a><a href="#h45-0-182" id="h45-0-182" class="i">+                            Boolean(
</a><a href="#h45-0-183" id="h45-0-183" class="i">+                                true,
</a><a href="#h45-0-184" id="h45-0-184" class="i">+                            ),
</a><a href="#h45-0-185" id="h45-0-185" class="i">+                        ),
</a><a href="#h45-0-186" id="h45-0-186" class="i">+                        Field(
</a><a href="#h45-0-187" id="h45-0-187" class="i">+                            None,
</a><a href="#h45-0-188" id="h45-0-188" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h45-0-189" id="h45-0-189" class="i">+                        ),
</a><a href="#h45-0-190" id="h45-0-190" class="i">+                    ],
</a><a href="#h45-0-191" id="h45-0-191" class="i">+                },
</a><a href="#h45-0-192" id="h45-0-192" class="i">+                aggregates: [
</a><a href="#h45-0-193" id="h45-0-193" class="i">+                    Sum,
</a><a href="#h45-0-194" id="h45-0-194" class="i">+                    Count,
</a><a href="#h45-0-195" id="h45-0-195" class="i">+                ],
</a><a href="#h45-0-196" id="h45-0-196" class="i">+            },
</a><a href="#h45-0-197" id="h45-0-197" class="i">+            labels: [
</a><a href="#h45-0-198" id="h45-0-198" class="i">+                None,
</a><a href="#h45-0-199" id="h45-0-199" class="i">+                None,
</a><a href="#h45-0-200" id="h45-0-200" class="i">+            ],
</a><a href="#h45-0-201" id="h45-0-201" class="i">+            expressions: [
</a><a href="#h45-0-202" id="h45-0-202" class="i">+                Field(
</a><a href="#h45-0-203" id="h45-0-203" class="i">+                    None,
</a><a href="#h45-0-204" id="h45-0-204" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h45-0-205" id="h45-0-205" class="i">+                ),
</a><a href="#h45-0-206" id="h45-0-206" class="i">+                Divide(
</a><a href="#h45-0-207" id="h45-0-207" class="i">+                    Column(
</a><a href="#h45-0-208" id="h45-0-208" class="i">+                        0,
</a><a href="#h45-0-209" id="h45-0-209" class="i">+                    ),
</a><a href="#h45-0-210" id="h45-0-210" class="i">+                    Column(
</a><a href="#h45-0-211" id="h45-0-211" class="i">+                        1,
</a><a href="#h45-0-212" id="h45-0-212" class="i">+                    ),
</a><a href="#h45-0-213" id="h45-0-213" class="i">+                ),
</a><a href="#h45-0-214" id="h45-0-214" class="i">+            ],
</a><a href="#h45-0-215" id="h45-0-215" class="i">+        },
</a><a href="#h45-0-216" id="h45-0-216" class="i">+        orders: [
</a><a href="#h45-0-217" id="h45-0-217" class="i">+            (
</a><a href="#h45-0-218" id="h45-0-218" class="i">+                Field(
</a><a href="#h45-0-219" id="h45-0-219" class="i">+                    None,
</a><a href="#h45-0-220" id="h45-0-220" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h45-0-221" id="h45-0-221" class="i">+                ),
</a><a href="#h45-0-222" id="h45-0-222" class="i">+                Ascending,
</a><a href="#h45-0-223" id="h45-0-223" class="i">+            ),
</a><a href="#h45-0-224" id="h45-0-224" class="i">+        ],
</a><a href="#h45-0-225" id="h45-0-225" class="i">+    },
</a><a href="#h45-0-226" id="h45-0-226" class="i">+}
</a><a href="#h45-0-227" id="h45-0-227" class="i">+
</a><a href="#h45-0-228" id="h45-0-228" class="i">+Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h45-0-229" id="h45-0-229" class="i">+
</a><a href="#h45-0-230" id="h45-0-230" class="i">+Result: [&quot;studio_id&quot;, &quot;?&quot;]
</a><a href="#h45-0-231" id="h45-0-231" class="i">+[Integer(1), Float(81.5)]
</a><a href="#h45-0-232" id="h45-0-232" class="i">+[Integer(2), Float(75.0)]
</a><a href="#h45-0-233" id="h45-0-233" class="i">+[Integer(3), Float(69.0)]
</a><a href="#h45-0-234" id="h45-0-234" class="i">+[Integer(4), Float(79.2)]
</a><b>diff --git a/<a id="h46" href="../file/src/sql/tests/query/group_expr_aggr_nogroupref.html">src/sql/tests/query/group_expr_aggr_nogroupref</a> b/<a href="../file/src/sql/tests/query/group_expr_aggr_nogroupref.html">src/sql/tests/query/group_expr_aggr_nogroupref</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -0,0 +1,251 @@
</a><a href="#h46-0-0" id="h46-0-0" class="i">+Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) + id FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h46-0-1" id="h46-0-1" class="i">+
</a><a href="#h46-0-2" id="h46-0-2" class="i">+AST: Select {
</a><a href="#h46-0-3" id="h46-0-3" class="i">+    select: SelectClause {
</a><a href="#h46-0-4" id="h46-0-4" class="i">+        expressions: [
</a><a href="#h46-0-5" id="h46-0-5" class="i">+            Field(
</a><a href="#h46-0-6" id="h46-0-6" class="i">+                None,
</a><a href="#h46-0-7" id="h46-0-7" class="i">+                &quot;studio_id&quot;,
</a><a href="#h46-0-8" id="h46-0-8" class="i">+            ),
</a><a href="#h46-0-9" id="h46-0-9" class="i">+            Operation(
</a><a href="#h46-0-10" id="h46-0-10" class="i">+                Add(
</a><a href="#h46-0-11" id="h46-0-11" class="i">+                    Operation(
</a><a href="#h46-0-12" id="h46-0-12" class="i">+                        Divide(
</a><a href="#h46-0-13" id="h46-0-13" class="i">+                            Function(
</a><a href="#h46-0-14" id="h46-0-14" class="i">+                                &quot;sum&quot;,
</a><a href="#h46-0-15" id="h46-0-15" class="i">+                                [
</a><a href="#h46-0-16" id="h46-0-16" class="i">+                                    Operation(
</a><a href="#h46-0-17" id="h46-0-17" class="i">+                                        Multiply(
</a><a href="#h46-0-18" id="h46-0-18" class="i">+                                            Field(
</a><a href="#h46-0-19" id="h46-0-19" class="i">+                                                None,
</a><a href="#h46-0-20" id="h46-0-20" class="i">+                                                &quot;rating&quot;,
</a><a href="#h46-0-21" id="h46-0-21" class="i">+                                            ),
</a><a href="#h46-0-22" id="h46-0-22" class="i">+                                            Literal(
</a><a href="#h46-0-23" id="h46-0-23" class="i">+                                                Integer(
</a><a href="#h46-0-24" id="h46-0-24" class="i">+                                                    10,
</a><a href="#h46-0-25" id="h46-0-25" class="i">+                                                ),
</a><a href="#h46-0-26" id="h46-0-26" class="i">+                                            ),
</a><a href="#h46-0-27" id="h46-0-27" class="i">+                                        ),
</a><a href="#h46-0-28" id="h46-0-28" class="i">+                                    ),
</a><a href="#h46-0-29" id="h46-0-29" class="i">+                                ],
</a><a href="#h46-0-30" id="h46-0-30" class="i">+                            ),
</a><a href="#h46-0-31" id="h46-0-31" class="i">+                            Function(
</a><a href="#h46-0-32" id="h46-0-32" class="i">+                                &quot;count&quot;,
</a><a href="#h46-0-33" id="h46-0-33" class="i">+                                [
</a><a href="#h46-0-34" id="h46-0-34" class="i">+                                    Literal(
</a><a href="#h46-0-35" id="h46-0-35" class="i">+                                        Boolean(
</a><a href="#h46-0-36" id="h46-0-36" class="i">+                                            true,
</a><a href="#h46-0-37" id="h46-0-37" class="i">+                                        ),
</a><a href="#h46-0-38" id="h46-0-38" class="i">+                                    ),
</a><a href="#h46-0-39" id="h46-0-39" class="i">+                                ],
</a><a href="#h46-0-40" id="h46-0-40" class="i">+                            ),
</a><a href="#h46-0-41" id="h46-0-41" class="i">+                        ),
</a><a href="#h46-0-42" id="h46-0-42" class="i">+                    ),
</a><a href="#h46-0-43" id="h46-0-43" class="i">+                    Field(
</a><a href="#h46-0-44" id="h46-0-44" class="i">+                        None,
</a><a href="#h46-0-45" id="h46-0-45" class="i">+                        &quot;id&quot;,
</a><a href="#h46-0-46" id="h46-0-46" class="i">+                    ),
</a><a href="#h46-0-47" id="h46-0-47" class="i">+                ),
</a><a href="#h46-0-48" id="h46-0-48" class="i">+            ),
</a><a href="#h46-0-49" id="h46-0-49" class="i">+        ],
</a><a href="#h46-0-50" id="h46-0-50" class="i">+        labels: [
</a><a href="#h46-0-51" id="h46-0-51" class="i">+            None,
</a><a href="#h46-0-52" id="h46-0-52" class="i">+            None,
</a><a href="#h46-0-53" id="h46-0-53" class="i">+        ],
</a><a href="#h46-0-54" id="h46-0-54" class="i">+    },
</a><a href="#h46-0-55" id="h46-0-55" class="i">+    from: Some(
</a><a href="#h46-0-56" id="h46-0-56" class="i">+        FromClause {
</a><a href="#h46-0-57" id="h46-0-57" class="i">+            items: [
</a><a href="#h46-0-58" id="h46-0-58" class="i">+                Table {
</a><a href="#h46-0-59" id="h46-0-59" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h46-0-60" id="h46-0-60" class="i">+                    alias: None,
</a><a href="#h46-0-61" id="h46-0-61" class="i">+                },
</a><a href="#h46-0-62" id="h46-0-62" class="i">+            ],
</a><a href="#h46-0-63" id="h46-0-63" class="i">+        },
</a><a href="#h46-0-64" id="h46-0-64" class="i">+    ),
</a><a href="#h46-0-65" id="h46-0-65" class="i">+    where: None,
</a><a href="#h46-0-66" id="h46-0-66" class="i">+    group_by: Some(
</a><a href="#h46-0-67" id="h46-0-67" class="i">+        GroupByClause(
</a><a href="#h46-0-68" id="h46-0-68" class="i">+            [
</a><a href="#h46-0-69" id="h46-0-69" class="i">+                Field(
</a><a href="#h46-0-70" id="h46-0-70" class="i">+                    None,
</a><a href="#h46-0-71" id="h46-0-71" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h46-0-72" id="h46-0-72" class="i">+                ),
</a><a href="#h46-0-73" id="h46-0-73" class="i">+            ],
</a><a href="#h46-0-74" id="h46-0-74" class="i">+        ),
</a><a href="#h46-0-75" id="h46-0-75" class="i">+    ),
</a><a href="#h46-0-76" id="h46-0-76" class="i">+    having: None,
</a><a href="#h46-0-77" id="h46-0-77" class="i">+    order: [
</a><a href="#h46-0-78" id="h46-0-78" class="i">+        (
</a><a href="#h46-0-79" id="h46-0-79" class="i">+            Field(
</a><a href="#h46-0-80" id="h46-0-80" class="i">+                None,
</a><a href="#h46-0-81" id="h46-0-81" class="i">+                &quot;studio_id&quot;,
</a><a href="#h46-0-82" id="h46-0-82" class="i">+            ),
</a><a href="#h46-0-83" id="h46-0-83" class="i">+            Ascending,
</a><a href="#h46-0-84" id="h46-0-84" class="i">+        ),
</a><a href="#h46-0-85" id="h46-0-85" class="i">+    ],
</a><a href="#h46-0-86" id="h46-0-86" class="i">+    limit: None,
</a><a href="#h46-0-87" id="h46-0-87" class="i">+    offset: None,
</a><a href="#h46-0-88" id="h46-0-88" class="i">+}
</a><a href="#h46-0-89" id="h46-0-89" class="i">+
</a><a href="#h46-0-90" id="h46-0-90" class="i">+Plan: Plan {
</a><a href="#h46-0-91" id="h46-0-91" class="i">+    root: Order {
</a><a href="#h46-0-92" id="h46-0-92" class="i">+        source: Projection {
</a><a href="#h46-0-93" id="h46-0-93" class="i">+            source: Aggregation {
</a><a href="#h46-0-94" id="h46-0-94" class="i">+                source: Projection {
</a><a href="#h46-0-95" id="h46-0-95" class="i">+                    source: Scan {
</a><a href="#h46-0-96" id="h46-0-96" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h46-0-97" id="h46-0-97" class="i">+                        alias: None,
</a><a href="#h46-0-98" id="h46-0-98" class="i">+                    },
</a><a href="#h46-0-99" id="h46-0-99" class="i">+                    labels: [
</a><a href="#h46-0-100" id="h46-0-100" class="i">+                        None,
</a><a href="#h46-0-101" id="h46-0-101" class="i">+                        None,
</a><a href="#h46-0-102" id="h46-0-102" class="i">+                        None,
</a><a href="#h46-0-103" id="h46-0-103" class="i">+                    ],
</a><a href="#h46-0-104" id="h46-0-104" class="i">+                    expressions: [
</a><a href="#h46-0-105" id="h46-0-105" class="i">+                        Multiply(
</a><a href="#h46-0-106" id="h46-0-106" class="i">+                            Field(
</a><a href="#h46-0-107" id="h46-0-107" class="i">+                                None,
</a><a href="#h46-0-108" id="h46-0-108" class="i">+                                &quot;rating&quot;,
</a><a href="#h46-0-109" id="h46-0-109" class="i">+                            ),
</a><a href="#h46-0-110" id="h46-0-110" class="i">+                            Constant(
</a><a href="#h46-0-111" id="h46-0-111" class="i">+                                Integer(
</a><a href="#h46-0-112" id="h46-0-112" class="i">+                                    10,
</a><a href="#h46-0-113" id="h46-0-113" class="i">+                                ),
</a><a href="#h46-0-114" id="h46-0-114" class="i">+                            ),
</a><a href="#h46-0-115" id="h46-0-115" class="i">+                        ),
</a><a href="#h46-0-116" id="h46-0-116" class="i">+                        Constant(
</a><a href="#h46-0-117" id="h46-0-117" class="i">+                            Boolean(
</a><a href="#h46-0-118" id="h46-0-118" class="i">+                                true,
</a><a href="#h46-0-119" id="h46-0-119" class="i">+                            ),
</a><a href="#h46-0-120" id="h46-0-120" class="i">+                        ),
</a><a href="#h46-0-121" id="h46-0-121" class="i">+                        Field(
</a><a href="#h46-0-122" id="h46-0-122" class="i">+                            None,
</a><a href="#h46-0-123" id="h46-0-123" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h46-0-124" id="h46-0-124" class="i">+                        ),
</a><a href="#h46-0-125" id="h46-0-125" class="i">+                    ],
</a><a href="#h46-0-126" id="h46-0-126" class="i">+                },
</a><a href="#h46-0-127" id="h46-0-127" class="i">+                aggregates: [
</a><a href="#h46-0-128" id="h46-0-128" class="i">+                    Sum,
</a><a href="#h46-0-129" id="h46-0-129" class="i">+                    Count,
</a><a href="#h46-0-130" id="h46-0-130" class="i">+                ],
</a><a href="#h46-0-131" id="h46-0-131" class="i">+            },
</a><a href="#h46-0-132" id="h46-0-132" class="i">+            labels: [
</a><a href="#h46-0-133" id="h46-0-133" class="i">+                None,
</a><a href="#h46-0-134" id="h46-0-134" class="i">+                None,
</a><a href="#h46-0-135" id="h46-0-135" class="i">+            ],
</a><a href="#h46-0-136" id="h46-0-136" class="i">+            expressions: [
</a><a href="#h46-0-137" id="h46-0-137" class="i">+                Field(
</a><a href="#h46-0-138" id="h46-0-138" class="i">+                    None,
</a><a href="#h46-0-139" id="h46-0-139" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h46-0-140" id="h46-0-140" class="i">+                ),
</a><a href="#h46-0-141" id="h46-0-141" class="i">+                Add(
</a><a href="#h46-0-142" id="h46-0-142" class="i">+                    Divide(
</a><a href="#h46-0-143" id="h46-0-143" class="i">+                        Column(
</a><a href="#h46-0-144" id="h46-0-144" class="i">+                            0,
</a><a href="#h46-0-145" id="h46-0-145" class="i">+                        ),
</a><a href="#h46-0-146" id="h46-0-146" class="i">+                        Column(
</a><a href="#h46-0-147" id="h46-0-147" class="i">+                            1,
</a><a href="#h46-0-148" id="h46-0-148" class="i">+                        ),
</a><a href="#h46-0-149" id="h46-0-149" class="i">+                    ),
</a><a href="#h46-0-150" id="h46-0-150" class="i">+                    Field(
</a><a href="#h46-0-151" id="h46-0-151" class="i">+                        None,
</a><a href="#h46-0-152" id="h46-0-152" class="i">+                        &quot;id&quot;,
</a><a href="#h46-0-153" id="h46-0-153" class="i">+                    ),
</a><a href="#h46-0-154" id="h46-0-154" class="i">+                ),
</a><a href="#h46-0-155" id="h46-0-155" class="i">+            ],
</a><a href="#h46-0-156" id="h46-0-156" class="i">+        },
</a><a href="#h46-0-157" id="h46-0-157" class="i">+        orders: [
</a><a href="#h46-0-158" id="h46-0-158" class="i">+            (
</a><a href="#h46-0-159" id="h46-0-159" class="i">+                Field(
</a><a href="#h46-0-160" id="h46-0-160" class="i">+                    None,
</a><a href="#h46-0-161" id="h46-0-161" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h46-0-162" id="h46-0-162" class="i">+                ),
</a><a href="#h46-0-163" id="h46-0-163" class="i">+                Ascending,
</a><a href="#h46-0-164" id="h46-0-164" class="i">+            ),
</a><a href="#h46-0-165" id="h46-0-165" class="i">+        ],
</a><a href="#h46-0-166" id="h46-0-166" class="i">+    },
</a><a href="#h46-0-167" id="h46-0-167" class="i">+}
</a><a href="#h46-0-168" id="h46-0-168" class="i">+
</a><a href="#h46-0-169" id="h46-0-169" class="i">+Optimized plan: Plan {
</a><a href="#h46-0-170" id="h46-0-170" class="i">+    root: Order {
</a><a href="#h46-0-171" id="h46-0-171" class="i">+        source: Projection {
</a><a href="#h46-0-172" id="h46-0-172" class="i">+            source: Aggregation {
</a><a href="#h46-0-173" id="h46-0-173" class="i">+                source: Projection {
</a><a href="#h46-0-174" id="h46-0-174" class="i">+                    source: Scan {
</a><a href="#h46-0-175" id="h46-0-175" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h46-0-176" id="h46-0-176" class="i">+                        alias: None,
</a><a href="#h46-0-177" id="h46-0-177" class="i">+                    },
</a><a href="#h46-0-178" id="h46-0-178" class="i">+                    labels: [
</a><a href="#h46-0-179" id="h46-0-179" class="i">+                        None,
</a><a href="#h46-0-180" id="h46-0-180" class="i">+                        None,
</a><a href="#h46-0-181" id="h46-0-181" class="i">+                        None,
</a><a href="#h46-0-182" id="h46-0-182" class="i">+                    ],
</a><a href="#h46-0-183" id="h46-0-183" class="i">+                    expressions: [
</a><a href="#h46-0-184" id="h46-0-184" class="i">+                        Multiply(
</a><a href="#h46-0-185" id="h46-0-185" class="i">+                            Field(
</a><a href="#h46-0-186" id="h46-0-186" class="i">+                                None,
</a><a href="#h46-0-187" id="h46-0-187" class="i">+                                &quot;rating&quot;,
</a><a href="#h46-0-188" id="h46-0-188" class="i">+                            ),
</a><a href="#h46-0-189" id="h46-0-189" class="i">+                            Constant(
</a><a href="#h46-0-190" id="h46-0-190" class="i">+                                Integer(
</a><a href="#h46-0-191" id="h46-0-191" class="i">+                                    10,
</a><a href="#h46-0-192" id="h46-0-192" class="i">+                                ),
</a><a href="#h46-0-193" id="h46-0-193" class="i">+                            ),
</a><a href="#h46-0-194" id="h46-0-194" class="i">+                        ),
</a><a href="#h46-0-195" id="h46-0-195" class="i">+                        Constant(
</a><a href="#h46-0-196" id="h46-0-196" class="i">+                            Boolean(
</a><a href="#h46-0-197" id="h46-0-197" class="i">+                                true,
</a><a href="#h46-0-198" id="h46-0-198" class="i">+                            ),
</a><a href="#h46-0-199" id="h46-0-199" class="i">+                        ),
</a><a href="#h46-0-200" id="h46-0-200" class="i">+                        Field(
</a><a href="#h46-0-201" id="h46-0-201" class="i">+                            None,
</a><a href="#h46-0-202" id="h46-0-202" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h46-0-203" id="h46-0-203" class="i">+                        ),
</a><a href="#h46-0-204" id="h46-0-204" class="i">+                    ],
</a><a href="#h46-0-205" id="h46-0-205" class="i">+                },
</a><a href="#h46-0-206" id="h46-0-206" class="i">+                aggregates: [
</a><a href="#h46-0-207" id="h46-0-207" class="i">+                    Sum,
</a><a href="#h46-0-208" id="h46-0-208" class="i">+                    Count,
</a><a href="#h46-0-209" id="h46-0-209" class="i">+                ],
</a><a href="#h46-0-210" id="h46-0-210" class="i">+            },
</a><a href="#h46-0-211" id="h46-0-211" class="i">+            labels: [
</a><a href="#h46-0-212" id="h46-0-212" class="i">+                None,
</a><a href="#h46-0-213" id="h46-0-213" class="i">+                None,
</a><a href="#h46-0-214" id="h46-0-214" class="i">+            ],
</a><a href="#h46-0-215" id="h46-0-215" class="i">+            expressions: [
</a><a href="#h46-0-216" id="h46-0-216" class="i">+                Field(
</a><a href="#h46-0-217" id="h46-0-217" class="i">+                    None,
</a><a href="#h46-0-218" id="h46-0-218" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h46-0-219" id="h46-0-219" class="i">+                ),
</a><a href="#h46-0-220" id="h46-0-220" class="i">+                Add(
</a><a href="#h46-0-221" id="h46-0-221" class="i">+                    Divide(
</a><a href="#h46-0-222" id="h46-0-222" class="i">+                        Column(
</a><a href="#h46-0-223" id="h46-0-223" class="i">+                            0,
</a><a href="#h46-0-224" id="h46-0-224" class="i">+                        ),
</a><a href="#h46-0-225" id="h46-0-225" class="i">+                        Column(
</a><a href="#h46-0-226" id="h46-0-226" class="i">+                            1,
</a><a href="#h46-0-227" id="h46-0-227" class="i">+                        ),
</a><a href="#h46-0-228" id="h46-0-228" class="i">+                    ),
</a><a href="#h46-0-229" id="h46-0-229" class="i">+                    Field(
</a><a href="#h46-0-230" id="h46-0-230" class="i">+                        None,
</a><a href="#h46-0-231" id="h46-0-231" class="i">+                        &quot;id&quot;,
</a><a href="#h46-0-232" id="h46-0-232" class="i">+                    ),
</a><a href="#h46-0-233" id="h46-0-233" class="i">+                ),
</a><a href="#h46-0-234" id="h46-0-234" class="i">+            ],
</a><a href="#h46-0-235" id="h46-0-235" class="i">+        },
</a><a href="#h46-0-236" id="h46-0-236" class="i">+        orders: [
</a><a href="#h46-0-237" id="h46-0-237" class="i">+            (
</a><a href="#h46-0-238" id="h46-0-238" class="i">+                Field(
</a><a href="#h46-0-239" id="h46-0-239" class="i">+                    None,
</a><a href="#h46-0-240" id="h46-0-240" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h46-0-241" id="h46-0-241" class="i">+                ),
</a><a href="#h46-0-242" id="h46-0-242" class="i">+                Ascending,
</a><a href="#h46-0-243" id="h46-0-243" class="i">+            ),
</a><a href="#h46-0-244" id="h46-0-244" class="i">+        ],
</a><a href="#h46-0-245" id="h46-0-245" class="i">+    },
</a><a href="#h46-0-246" id="h46-0-246" class="i">+}
</a><a href="#h46-0-247" id="h46-0-247" class="i">+
</a><a href="#h46-0-248" id="h46-0-248" class="i">+Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) + id FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h46-0-249" id="h46-0-249" class="i">+
</a><a href="#h46-0-250" id="h46-0-250" class="i">+Result: Value(&quot;Unknown field id&quot;)
</a><a href="#h46-0-251" id="h46-0-251" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h47" href="../file/src/sql/tests/query/group_expr_aggr_selfref.html">src/sql/tests/query/group_expr_aggr_selfref</a> b/<a href="../file/src/sql/tests/query/group_expr_aggr_selfref.html">src/sql/tests/query/group_expr_aggr_selfref</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -0,0 +1,255 @@
</a><a href="#h47-0-0" id="h47-0-0" class="i">+Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) + studio_id FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h47-0-1" id="h47-0-1" class="i">+
</a><a href="#h47-0-2" id="h47-0-2" class="i">+AST: Select {
</a><a href="#h47-0-3" id="h47-0-3" class="i">+    select: SelectClause {
</a><a href="#h47-0-4" id="h47-0-4" class="i">+        expressions: [
</a><a href="#h47-0-5" id="h47-0-5" class="i">+            Field(
</a><a href="#h47-0-6" id="h47-0-6" class="i">+                None,
</a><a href="#h47-0-7" id="h47-0-7" class="i">+                &quot;studio_id&quot;,
</a><a href="#h47-0-8" id="h47-0-8" class="i">+            ),
</a><a href="#h47-0-9" id="h47-0-9" class="i">+            Operation(
</a><a href="#h47-0-10" id="h47-0-10" class="i">+                Add(
</a><a href="#h47-0-11" id="h47-0-11" class="i">+                    Operation(
</a><a href="#h47-0-12" id="h47-0-12" class="i">+                        Divide(
</a><a href="#h47-0-13" id="h47-0-13" class="i">+                            Function(
</a><a href="#h47-0-14" id="h47-0-14" class="i">+                                &quot;sum&quot;,
</a><a href="#h47-0-15" id="h47-0-15" class="i">+                                [
</a><a href="#h47-0-16" id="h47-0-16" class="i">+                                    Operation(
</a><a href="#h47-0-17" id="h47-0-17" class="i">+                                        Multiply(
</a><a href="#h47-0-18" id="h47-0-18" class="i">+                                            Field(
</a><a href="#h47-0-19" id="h47-0-19" class="i">+                                                None,
</a><a href="#h47-0-20" id="h47-0-20" class="i">+                                                &quot;rating&quot;,
</a><a href="#h47-0-21" id="h47-0-21" class="i">+                                            ),
</a><a href="#h47-0-22" id="h47-0-22" class="i">+                                            Literal(
</a><a href="#h47-0-23" id="h47-0-23" class="i">+                                                Integer(
</a><a href="#h47-0-24" id="h47-0-24" class="i">+                                                    10,
</a><a href="#h47-0-25" id="h47-0-25" class="i">+                                                ),
</a><a href="#h47-0-26" id="h47-0-26" class="i">+                                            ),
</a><a href="#h47-0-27" id="h47-0-27" class="i">+                                        ),
</a><a href="#h47-0-28" id="h47-0-28" class="i">+                                    ),
</a><a href="#h47-0-29" id="h47-0-29" class="i">+                                ],
</a><a href="#h47-0-30" id="h47-0-30" class="i">+                            ),
</a><a href="#h47-0-31" id="h47-0-31" class="i">+                            Function(
</a><a href="#h47-0-32" id="h47-0-32" class="i">+                                &quot;count&quot;,
</a><a href="#h47-0-33" id="h47-0-33" class="i">+                                [
</a><a href="#h47-0-34" id="h47-0-34" class="i">+                                    Literal(
</a><a href="#h47-0-35" id="h47-0-35" class="i">+                                        Boolean(
</a><a href="#h47-0-36" id="h47-0-36" class="i">+                                            true,
</a><a href="#h47-0-37" id="h47-0-37" class="i">+                                        ),
</a><a href="#h47-0-38" id="h47-0-38" class="i">+                                    ),
</a><a href="#h47-0-39" id="h47-0-39" class="i">+                                ],
</a><a href="#h47-0-40" id="h47-0-40" class="i">+                            ),
</a><a href="#h47-0-41" id="h47-0-41" class="i">+                        ),
</a><a href="#h47-0-42" id="h47-0-42" class="i">+                    ),
</a><a href="#h47-0-43" id="h47-0-43" class="i">+                    Field(
</a><a href="#h47-0-44" id="h47-0-44" class="i">+                        None,
</a><a href="#h47-0-45" id="h47-0-45" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h47-0-46" id="h47-0-46" class="i">+                    ),
</a><a href="#h47-0-47" id="h47-0-47" class="i">+                ),
</a><a href="#h47-0-48" id="h47-0-48" class="i">+            ),
</a><a href="#h47-0-49" id="h47-0-49" class="i">+        ],
</a><a href="#h47-0-50" id="h47-0-50" class="i">+        labels: [
</a><a href="#h47-0-51" id="h47-0-51" class="i">+            None,
</a><a href="#h47-0-52" id="h47-0-52" class="i">+            None,
</a><a href="#h47-0-53" id="h47-0-53" class="i">+        ],
</a><a href="#h47-0-54" id="h47-0-54" class="i">+    },
</a><a href="#h47-0-55" id="h47-0-55" class="i">+    from: Some(
</a><a href="#h47-0-56" id="h47-0-56" class="i">+        FromClause {
</a><a href="#h47-0-57" id="h47-0-57" class="i">+            items: [
</a><a href="#h47-0-58" id="h47-0-58" class="i">+                Table {
</a><a href="#h47-0-59" id="h47-0-59" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h47-0-60" id="h47-0-60" class="i">+                    alias: None,
</a><a href="#h47-0-61" id="h47-0-61" class="i">+                },
</a><a href="#h47-0-62" id="h47-0-62" class="i">+            ],
</a><a href="#h47-0-63" id="h47-0-63" class="i">+        },
</a><a href="#h47-0-64" id="h47-0-64" class="i">+    ),
</a><a href="#h47-0-65" id="h47-0-65" class="i">+    where: None,
</a><a href="#h47-0-66" id="h47-0-66" class="i">+    group_by: Some(
</a><a href="#h47-0-67" id="h47-0-67" class="i">+        GroupByClause(
</a><a href="#h47-0-68" id="h47-0-68" class="i">+            [
</a><a href="#h47-0-69" id="h47-0-69" class="i">+                Field(
</a><a href="#h47-0-70" id="h47-0-70" class="i">+                    None,
</a><a href="#h47-0-71" id="h47-0-71" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h47-0-72" id="h47-0-72" class="i">+                ),
</a><a href="#h47-0-73" id="h47-0-73" class="i">+            ],
</a><a href="#h47-0-74" id="h47-0-74" class="i">+        ),
</a><a href="#h47-0-75" id="h47-0-75" class="i">+    ),
</a><a href="#h47-0-76" id="h47-0-76" class="i">+    having: None,
</a><a href="#h47-0-77" id="h47-0-77" class="i">+    order: [
</a><a href="#h47-0-78" id="h47-0-78" class="i">+        (
</a><a href="#h47-0-79" id="h47-0-79" class="i">+            Field(
</a><a href="#h47-0-80" id="h47-0-80" class="i">+                None,
</a><a href="#h47-0-81" id="h47-0-81" class="i">+                &quot;studio_id&quot;,
</a><a href="#h47-0-82" id="h47-0-82" class="i">+            ),
</a><a href="#h47-0-83" id="h47-0-83" class="i">+            Ascending,
</a><a href="#h47-0-84" id="h47-0-84" class="i">+        ),
</a><a href="#h47-0-85" id="h47-0-85" class="i">+    ],
</a><a href="#h47-0-86" id="h47-0-86" class="i">+    limit: None,
</a><a href="#h47-0-87" id="h47-0-87" class="i">+    offset: None,
</a><a href="#h47-0-88" id="h47-0-88" class="i">+}
</a><a href="#h47-0-89" id="h47-0-89" class="i">+
</a><a href="#h47-0-90" id="h47-0-90" class="i">+Plan: Plan {
</a><a href="#h47-0-91" id="h47-0-91" class="i">+    root: Order {
</a><a href="#h47-0-92" id="h47-0-92" class="i">+        source: Projection {
</a><a href="#h47-0-93" id="h47-0-93" class="i">+            source: Aggregation {
</a><a href="#h47-0-94" id="h47-0-94" class="i">+                source: Projection {
</a><a href="#h47-0-95" id="h47-0-95" class="i">+                    source: Scan {
</a><a href="#h47-0-96" id="h47-0-96" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h47-0-97" id="h47-0-97" class="i">+                        alias: None,
</a><a href="#h47-0-98" id="h47-0-98" class="i">+                    },
</a><a href="#h47-0-99" id="h47-0-99" class="i">+                    labels: [
</a><a href="#h47-0-100" id="h47-0-100" class="i">+                        None,
</a><a href="#h47-0-101" id="h47-0-101" class="i">+                        None,
</a><a href="#h47-0-102" id="h47-0-102" class="i">+                        None,
</a><a href="#h47-0-103" id="h47-0-103" class="i">+                    ],
</a><a href="#h47-0-104" id="h47-0-104" class="i">+                    expressions: [
</a><a href="#h47-0-105" id="h47-0-105" class="i">+                        Multiply(
</a><a href="#h47-0-106" id="h47-0-106" class="i">+                            Field(
</a><a href="#h47-0-107" id="h47-0-107" class="i">+                                None,
</a><a href="#h47-0-108" id="h47-0-108" class="i">+                                &quot;rating&quot;,
</a><a href="#h47-0-109" id="h47-0-109" class="i">+                            ),
</a><a href="#h47-0-110" id="h47-0-110" class="i">+                            Constant(
</a><a href="#h47-0-111" id="h47-0-111" class="i">+                                Integer(
</a><a href="#h47-0-112" id="h47-0-112" class="i">+                                    10,
</a><a href="#h47-0-113" id="h47-0-113" class="i">+                                ),
</a><a href="#h47-0-114" id="h47-0-114" class="i">+                            ),
</a><a href="#h47-0-115" id="h47-0-115" class="i">+                        ),
</a><a href="#h47-0-116" id="h47-0-116" class="i">+                        Constant(
</a><a href="#h47-0-117" id="h47-0-117" class="i">+                            Boolean(
</a><a href="#h47-0-118" id="h47-0-118" class="i">+                                true,
</a><a href="#h47-0-119" id="h47-0-119" class="i">+                            ),
</a><a href="#h47-0-120" id="h47-0-120" class="i">+                        ),
</a><a href="#h47-0-121" id="h47-0-121" class="i">+                        Field(
</a><a href="#h47-0-122" id="h47-0-122" class="i">+                            None,
</a><a href="#h47-0-123" id="h47-0-123" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h47-0-124" id="h47-0-124" class="i">+                        ),
</a><a href="#h47-0-125" id="h47-0-125" class="i">+                    ],
</a><a href="#h47-0-126" id="h47-0-126" class="i">+                },
</a><a href="#h47-0-127" id="h47-0-127" class="i">+                aggregates: [
</a><a href="#h47-0-128" id="h47-0-128" class="i">+                    Sum,
</a><a href="#h47-0-129" id="h47-0-129" class="i">+                    Count,
</a><a href="#h47-0-130" id="h47-0-130" class="i">+                ],
</a><a href="#h47-0-131" id="h47-0-131" class="i">+            },
</a><a href="#h47-0-132" id="h47-0-132" class="i">+            labels: [
</a><a href="#h47-0-133" id="h47-0-133" class="i">+                None,
</a><a href="#h47-0-134" id="h47-0-134" class="i">+                None,
</a><a href="#h47-0-135" id="h47-0-135" class="i">+            ],
</a><a href="#h47-0-136" id="h47-0-136" class="i">+            expressions: [
</a><a href="#h47-0-137" id="h47-0-137" class="i">+                Field(
</a><a href="#h47-0-138" id="h47-0-138" class="i">+                    None,
</a><a href="#h47-0-139" id="h47-0-139" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h47-0-140" id="h47-0-140" class="i">+                ),
</a><a href="#h47-0-141" id="h47-0-141" class="i">+                Add(
</a><a href="#h47-0-142" id="h47-0-142" class="i">+                    Divide(
</a><a href="#h47-0-143" id="h47-0-143" class="i">+                        Column(
</a><a href="#h47-0-144" id="h47-0-144" class="i">+                            0,
</a><a href="#h47-0-145" id="h47-0-145" class="i">+                        ),
</a><a href="#h47-0-146" id="h47-0-146" class="i">+                        Column(
</a><a href="#h47-0-147" id="h47-0-147" class="i">+                            1,
</a><a href="#h47-0-148" id="h47-0-148" class="i">+                        ),
</a><a href="#h47-0-149" id="h47-0-149" class="i">+                    ),
</a><a href="#h47-0-150" id="h47-0-150" class="i">+                    Field(
</a><a href="#h47-0-151" id="h47-0-151" class="i">+                        None,
</a><a href="#h47-0-152" id="h47-0-152" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h47-0-153" id="h47-0-153" class="i">+                    ),
</a><a href="#h47-0-154" id="h47-0-154" class="i">+                ),
</a><a href="#h47-0-155" id="h47-0-155" class="i">+            ],
</a><a href="#h47-0-156" id="h47-0-156" class="i">+        },
</a><a href="#h47-0-157" id="h47-0-157" class="i">+        orders: [
</a><a href="#h47-0-158" id="h47-0-158" class="i">+            (
</a><a href="#h47-0-159" id="h47-0-159" class="i">+                Field(
</a><a href="#h47-0-160" id="h47-0-160" class="i">+                    None,
</a><a href="#h47-0-161" id="h47-0-161" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h47-0-162" id="h47-0-162" class="i">+                ),
</a><a href="#h47-0-163" id="h47-0-163" class="i">+                Ascending,
</a><a href="#h47-0-164" id="h47-0-164" class="i">+            ),
</a><a href="#h47-0-165" id="h47-0-165" class="i">+        ],
</a><a href="#h47-0-166" id="h47-0-166" class="i">+    },
</a><a href="#h47-0-167" id="h47-0-167" class="i">+}
</a><a href="#h47-0-168" id="h47-0-168" class="i">+
</a><a href="#h47-0-169" id="h47-0-169" class="i">+Optimized plan: Plan {
</a><a href="#h47-0-170" id="h47-0-170" class="i">+    root: Order {
</a><a href="#h47-0-171" id="h47-0-171" class="i">+        source: Projection {
</a><a href="#h47-0-172" id="h47-0-172" class="i">+            source: Aggregation {
</a><a href="#h47-0-173" id="h47-0-173" class="i">+                source: Projection {
</a><a href="#h47-0-174" id="h47-0-174" class="i">+                    source: Scan {
</a><a href="#h47-0-175" id="h47-0-175" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h47-0-176" id="h47-0-176" class="i">+                        alias: None,
</a><a href="#h47-0-177" id="h47-0-177" class="i">+                    },
</a><a href="#h47-0-178" id="h47-0-178" class="i">+                    labels: [
</a><a href="#h47-0-179" id="h47-0-179" class="i">+                        None,
</a><a href="#h47-0-180" id="h47-0-180" class="i">+                        None,
</a><a href="#h47-0-181" id="h47-0-181" class="i">+                        None,
</a><a href="#h47-0-182" id="h47-0-182" class="i">+                    ],
</a><a href="#h47-0-183" id="h47-0-183" class="i">+                    expressions: [
</a><a href="#h47-0-184" id="h47-0-184" class="i">+                        Multiply(
</a><a href="#h47-0-185" id="h47-0-185" class="i">+                            Field(
</a><a href="#h47-0-186" id="h47-0-186" class="i">+                                None,
</a><a href="#h47-0-187" id="h47-0-187" class="i">+                                &quot;rating&quot;,
</a><a href="#h47-0-188" id="h47-0-188" class="i">+                            ),
</a><a href="#h47-0-189" id="h47-0-189" class="i">+                            Constant(
</a><a href="#h47-0-190" id="h47-0-190" class="i">+                                Integer(
</a><a href="#h47-0-191" id="h47-0-191" class="i">+                                    10,
</a><a href="#h47-0-192" id="h47-0-192" class="i">+                                ),
</a><a href="#h47-0-193" id="h47-0-193" class="i">+                            ),
</a><a href="#h47-0-194" id="h47-0-194" class="i">+                        ),
</a><a href="#h47-0-195" id="h47-0-195" class="i">+                        Constant(
</a><a href="#h47-0-196" id="h47-0-196" class="i">+                            Boolean(
</a><a href="#h47-0-197" id="h47-0-197" class="i">+                                true,
</a><a href="#h47-0-198" id="h47-0-198" class="i">+                            ),
</a><a href="#h47-0-199" id="h47-0-199" class="i">+                        ),
</a><a href="#h47-0-200" id="h47-0-200" class="i">+                        Field(
</a><a href="#h47-0-201" id="h47-0-201" class="i">+                            None,
</a><a href="#h47-0-202" id="h47-0-202" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h47-0-203" id="h47-0-203" class="i">+                        ),
</a><a href="#h47-0-204" id="h47-0-204" class="i">+                    ],
</a><a href="#h47-0-205" id="h47-0-205" class="i">+                },
</a><a href="#h47-0-206" id="h47-0-206" class="i">+                aggregates: [
</a><a href="#h47-0-207" id="h47-0-207" class="i">+                    Sum,
</a><a href="#h47-0-208" id="h47-0-208" class="i">+                    Count,
</a><a href="#h47-0-209" id="h47-0-209" class="i">+                ],
</a><a href="#h47-0-210" id="h47-0-210" class="i">+            },
</a><a href="#h47-0-211" id="h47-0-211" class="i">+            labels: [
</a><a href="#h47-0-212" id="h47-0-212" class="i">+                None,
</a><a href="#h47-0-213" id="h47-0-213" class="i">+                None,
</a><a href="#h47-0-214" id="h47-0-214" class="i">+            ],
</a><a href="#h47-0-215" id="h47-0-215" class="i">+            expressions: [
</a><a href="#h47-0-216" id="h47-0-216" class="i">+                Field(
</a><a href="#h47-0-217" id="h47-0-217" class="i">+                    None,
</a><a href="#h47-0-218" id="h47-0-218" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h47-0-219" id="h47-0-219" class="i">+                ),
</a><a href="#h47-0-220" id="h47-0-220" class="i">+                Add(
</a><a href="#h47-0-221" id="h47-0-221" class="i">+                    Divide(
</a><a href="#h47-0-222" id="h47-0-222" class="i">+                        Column(
</a><a href="#h47-0-223" id="h47-0-223" class="i">+                            0,
</a><a href="#h47-0-224" id="h47-0-224" class="i">+                        ),
</a><a href="#h47-0-225" id="h47-0-225" class="i">+                        Column(
</a><a href="#h47-0-226" id="h47-0-226" class="i">+                            1,
</a><a href="#h47-0-227" id="h47-0-227" class="i">+                        ),
</a><a href="#h47-0-228" id="h47-0-228" class="i">+                    ),
</a><a href="#h47-0-229" id="h47-0-229" class="i">+                    Field(
</a><a href="#h47-0-230" id="h47-0-230" class="i">+                        None,
</a><a href="#h47-0-231" id="h47-0-231" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h47-0-232" id="h47-0-232" class="i">+                    ),
</a><a href="#h47-0-233" id="h47-0-233" class="i">+                ),
</a><a href="#h47-0-234" id="h47-0-234" class="i">+            ],
</a><a href="#h47-0-235" id="h47-0-235" class="i">+        },
</a><a href="#h47-0-236" id="h47-0-236" class="i">+        orders: [
</a><a href="#h47-0-237" id="h47-0-237" class="i">+            (
</a><a href="#h47-0-238" id="h47-0-238" class="i">+                Field(
</a><a href="#h47-0-239" id="h47-0-239" class="i">+                    None,
</a><a href="#h47-0-240" id="h47-0-240" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h47-0-241" id="h47-0-241" class="i">+                ),
</a><a href="#h47-0-242" id="h47-0-242" class="i">+                Ascending,
</a><a href="#h47-0-243" id="h47-0-243" class="i">+            ),
</a><a href="#h47-0-244" id="h47-0-244" class="i">+        ],
</a><a href="#h47-0-245" id="h47-0-245" class="i">+    },
</a><a href="#h47-0-246" id="h47-0-246" class="i">+}
</a><a href="#h47-0-247" id="h47-0-247" class="i">+
</a><a href="#h47-0-248" id="h47-0-248" class="i">+Query: SELECT studio_id, SUM(rating * 10) / COUNT(*) + studio_id FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h47-0-249" id="h47-0-249" class="i">+
</a><a href="#h47-0-250" id="h47-0-250" class="i">+Result: [&quot;studio_id&quot;, &quot;?&quot;]
</a><a href="#h47-0-251" id="h47-0-251" class="i">+[Integer(1), Float(82.5)]
</a><a href="#h47-0-252" id="h47-0-252" class="i">+[Integer(2), Float(77.0)]
</a><a href="#h47-0-253" id="h47-0-253" class="i">+[Integer(3), Float(72.0)]
</a><a href="#h47-0-254" id="h47-0-254" class="i">+[Integer(4), Float(83.2)]
</a><b>diff --git a/<a id="h48" href="../file/src/sql/tests/query/group_expr_aliased.html">src/sql/tests/query/group_expr_aliased</a> b/<a href="../file/src/sql/tests/query/group_expr_aliased.html">src/sql/tests/query/group_expr_aliased</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -0,0 +1,205 @@
</a><a href="#h48-0-0" id="h48-0-0" class="i">+Query: SELECT studio_id * 2 AS twice, MAX(rating) FROM movies GROUP BY twice ORDER BY twice
</a><a href="#h48-0-1" id="h48-0-1" class="i">+
</a><a href="#h48-0-2" id="h48-0-2" class="i">+AST: Select {
</a><a href="#h48-0-3" id="h48-0-3" class="i">+    select: SelectClause {
</a><a href="#h48-0-4" id="h48-0-4" class="i">+        expressions: [
</a><a href="#h48-0-5" id="h48-0-5" class="i">+            Operation(
</a><a href="#h48-0-6" id="h48-0-6" class="i">+                Multiply(
</a><a href="#h48-0-7" id="h48-0-7" class="i">+                    Field(
</a><a href="#h48-0-8" id="h48-0-8" class="i">+                        None,
</a><a href="#h48-0-9" id="h48-0-9" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h48-0-10" id="h48-0-10" class="i">+                    ),
</a><a href="#h48-0-11" id="h48-0-11" class="i">+                    Literal(
</a><a href="#h48-0-12" id="h48-0-12" class="i">+                        Integer(
</a><a href="#h48-0-13" id="h48-0-13" class="i">+                            2,
</a><a href="#h48-0-14" id="h48-0-14" class="i">+                        ),
</a><a href="#h48-0-15" id="h48-0-15" class="i">+                    ),
</a><a href="#h48-0-16" id="h48-0-16" class="i">+                ),
</a><a href="#h48-0-17" id="h48-0-17" class="i">+            ),
</a><a href="#h48-0-18" id="h48-0-18" class="i">+            Function(
</a><a href="#h48-0-19" id="h48-0-19" class="i">+                &quot;max&quot;,
</a><a href="#h48-0-20" id="h48-0-20" class="i">+                [
</a><a href="#h48-0-21" id="h48-0-21" class="i">+                    Field(
</a><a href="#h48-0-22" id="h48-0-22" class="i">+                        None,
</a><a href="#h48-0-23" id="h48-0-23" class="i">+                        &quot;rating&quot;,
</a><a href="#h48-0-24" id="h48-0-24" class="i">+                    ),
</a><a href="#h48-0-25" id="h48-0-25" class="i">+                ],
</a><a href="#h48-0-26" id="h48-0-26" class="i">+            ),
</a><a href="#h48-0-27" id="h48-0-27" class="i">+        ],
</a><a href="#h48-0-28" id="h48-0-28" class="i">+        labels: [
</a><a href="#h48-0-29" id="h48-0-29" class="i">+            Some(
</a><a href="#h48-0-30" id="h48-0-30" class="i">+                &quot;twice&quot;,
</a><a href="#h48-0-31" id="h48-0-31" class="i">+            ),
</a><a href="#h48-0-32" id="h48-0-32" class="i">+            None,
</a><a href="#h48-0-33" id="h48-0-33" class="i">+        ],
</a><a href="#h48-0-34" id="h48-0-34" class="i">+    },
</a><a href="#h48-0-35" id="h48-0-35" class="i">+    from: Some(
</a><a href="#h48-0-36" id="h48-0-36" class="i">+        FromClause {
</a><a href="#h48-0-37" id="h48-0-37" class="i">+            items: [
</a><a href="#h48-0-38" id="h48-0-38" class="i">+                Table {
</a><a href="#h48-0-39" id="h48-0-39" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h48-0-40" id="h48-0-40" class="i">+                    alias: None,
</a><a href="#h48-0-41" id="h48-0-41" class="i">+                },
</a><a href="#h48-0-42" id="h48-0-42" class="i">+            ],
</a><a href="#h48-0-43" id="h48-0-43" class="i">+        },
</a><a href="#h48-0-44" id="h48-0-44" class="i">+    ),
</a><a href="#h48-0-45" id="h48-0-45" class="i">+    where: None,
</a><a href="#h48-0-46" id="h48-0-46" class="i">+    group_by: Some(
</a><a href="#h48-0-47" id="h48-0-47" class="i">+        GroupByClause(
</a><a href="#h48-0-48" id="h48-0-48" class="i">+            [
</a><a href="#h48-0-49" id="h48-0-49" class="i">+                Field(
</a><a href="#h48-0-50" id="h48-0-50" class="i">+                    None,
</a><a href="#h48-0-51" id="h48-0-51" class="i">+                    &quot;twice&quot;,
</a><a href="#h48-0-52" id="h48-0-52" class="i">+                ),
</a><a href="#h48-0-53" id="h48-0-53" class="i">+            ],
</a><a href="#h48-0-54" id="h48-0-54" class="i">+        ),
</a><a href="#h48-0-55" id="h48-0-55" class="i">+    ),
</a><a href="#h48-0-56" id="h48-0-56" class="i">+    having: None,
</a><a href="#h48-0-57" id="h48-0-57" class="i">+    order: [
</a><a href="#h48-0-58" id="h48-0-58" class="i">+        (
</a><a href="#h48-0-59" id="h48-0-59" class="i">+            Field(
</a><a href="#h48-0-60" id="h48-0-60" class="i">+                None,
</a><a href="#h48-0-61" id="h48-0-61" class="i">+                &quot;twice&quot;,
</a><a href="#h48-0-62" id="h48-0-62" class="i">+            ),
</a><a href="#h48-0-63" id="h48-0-63" class="i">+            Ascending,
</a><a href="#h48-0-64" id="h48-0-64" class="i">+        ),
</a><a href="#h48-0-65" id="h48-0-65" class="i">+    ],
</a><a href="#h48-0-66" id="h48-0-66" class="i">+    limit: None,
</a><a href="#h48-0-67" id="h48-0-67" class="i">+    offset: None,
</a><a href="#h48-0-68" id="h48-0-68" class="i">+}
</a><a href="#h48-0-69" id="h48-0-69" class="i">+
</a><a href="#h48-0-70" id="h48-0-70" class="i">+Plan: Plan {
</a><a href="#h48-0-71" id="h48-0-71" class="i">+    root: Order {
</a><a href="#h48-0-72" id="h48-0-72" class="i">+        source: Projection {
</a><a href="#h48-0-73" id="h48-0-73" class="i">+            source: Aggregation {
</a><a href="#h48-0-74" id="h48-0-74" class="i">+                source: Projection {
</a><a href="#h48-0-75" id="h48-0-75" class="i">+                    source: Scan {
</a><a href="#h48-0-76" id="h48-0-76" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h48-0-77" id="h48-0-77" class="i">+                        alias: None,
</a><a href="#h48-0-78" id="h48-0-78" class="i">+                    },
</a><a href="#h48-0-79" id="h48-0-79" class="i">+                    labels: [
</a><a href="#h48-0-80" id="h48-0-80" class="i">+                        None,
</a><a href="#h48-0-81" id="h48-0-81" class="i">+                        Some(
</a><a href="#h48-0-82" id="h48-0-82" class="i">+                            &quot;twice&quot;,
</a><a href="#h48-0-83" id="h48-0-83" class="i">+                        ),
</a><a href="#h48-0-84" id="h48-0-84" class="i">+                    ],
</a><a href="#h48-0-85" id="h48-0-85" class="i">+                    expressions: [
</a><a href="#h48-0-86" id="h48-0-86" class="i">+                        Field(
</a><a href="#h48-0-87" id="h48-0-87" class="i">+                            None,
</a><a href="#h48-0-88" id="h48-0-88" class="i">+                            &quot;rating&quot;,
</a><a href="#h48-0-89" id="h48-0-89" class="i">+                        ),
</a><a href="#h48-0-90" id="h48-0-90" class="i">+                        Multiply(
</a><a href="#h48-0-91" id="h48-0-91" class="i">+                            Field(
</a><a href="#h48-0-92" id="h48-0-92" class="i">+                                None,
</a><a href="#h48-0-93" id="h48-0-93" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h48-0-94" id="h48-0-94" class="i">+                            ),
</a><a href="#h48-0-95" id="h48-0-95" class="i">+                            Constant(
</a><a href="#h48-0-96" id="h48-0-96" class="i">+                                Integer(
</a><a href="#h48-0-97" id="h48-0-97" class="i">+                                    2,
</a><a href="#h48-0-98" id="h48-0-98" class="i">+                                ),
</a><a href="#h48-0-99" id="h48-0-99" class="i">+                            ),
</a><a href="#h48-0-100" id="h48-0-100" class="i">+                        ),
</a><a href="#h48-0-101" id="h48-0-101" class="i">+                    ],
</a><a href="#h48-0-102" id="h48-0-102" class="i">+                },
</a><a href="#h48-0-103" id="h48-0-103" class="i">+                aggregates: [
</a><a href="#h48-0-104" id="h48-0-104" class="i">+                    Max,
</a><a href="#h48-0-105" id="h48-0-105" class="i">+                ],
</a><a href="#h48-0-106" id="h48-0-106" class="i">+            },
</a><a href="#h48-0-107" id="h48-0-107" class="i">+            labels: [
</a><a href="#h48-0-108" id="h48-0-108" class="i">+                Some(
</a><a href="#h48-0-109" id="h48-0-109" class="i">+                    &quot;twice&quot;,
</a><a href="#h48-0-110" id="h48-0-110" class="i">+                ),
</a><a href="#h48-0-111" id="h48-0-111" class="i">+                None,
</a><a href="#h48-0-112" id="h48-0-112" class="i">+            ],
</a><a href="#h48-0-113" id="h48-0-113" class="i">+            expressions: [
</a><a href="#h48-0-114" id="h48-0-114" class="i">+                Column(
</a><a href="#h48-0-115" id="h48-0-115" class="i">+                    1,
</a><a href="#h48-0-116" id="h48-0-116" class="i">+                ),
</a><a href="#h48-0-117" id="h48-0-117" class="i">+                Column(
</a><a href="#h48-0-118" id="h48-0-118" class="i">+                    0,
</a><a href="#h48-0-119" id="h48-0-119" class="i">+                ),
</a><a href="#h48-0-120" id="h48-0-120" class="i">+            ],
</a><a href="#h48-0-121" id="h48-0-121" class="i">+        },
</a><a href="#h48-0-122" id="h48-0-122" class="i">+        orders: [
</a><a href="#h48-0-123" id="h48-0-123" class="i">+            (
</a><a href="#h48-0-124" id="h48-0-124" class="i">+                Field(
</a><a href="#h48-0-125" id="h48-0-125" class="i">+                    None,
</a><a href="#h48-0-126" id="h48-0-126" class="i">+                    &quot;twice&quot;,
</a><a href="#h48-0-127" id="h48-0-127" class="i">+                ),
</a><a href="#h48-0-128" id="h48-0-128" class="i">+                Ascending,
</a><a href="#h48-0-129" id="h48-0-129" class="i">+            ),
</a><a href="#h48-0-130" id="h48-0-130" class="i">+        ],
</a><a href="#h48-0-131" id="h48-0-131" class="i">+    },
</a><a href="#h48-0-132" id="h48-0-132" class="i">+}
</a><a href="#h48-0-133" id="h48-0-133" class="i">+
</a><a href="#h48-0-134" id="h48-0-134" class="i">+Optimized plan: Plan {
</a><a href="#h48-0-135" id="h48-0-135" class="i">+    root: Order {
</a><a href="#h48-0-136" id="h48-0-136" class="i">+        source: Projection {
</a><a href="#h48-0-137" id="h48-0-137" class="i">+            source: Aggregation {
</a><a href="#h48-0-138" id="h48-0-138" class="i">+                source: Projection {
</a><a href="#h48-0-139" id="h48-0-139" class="i">+                    source: Scan {
</a><a href="#h48-0-140" id="h48-0-140" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h48-0-141" id="h48-0-141" class="i">+                        alias: None,
</a><a href="#h48-0-142" id="h48-0-142" class="i">+                    },
</a><a href="#h48-0-143" id="h48-0-143" class="i">+                    labels: [
</a><a href="#h48-0-144" id="h48-0-144" class="i">+                        None,
</a><a href="#h48-0-145" id="h48-0-145" class="i">+                        Some(
</a><a href="#h48-0-146" id="h48-0-146" class="i">+                            &quot;twice&quot;,
</a><a href="#h48-0-147" id="h48-0-147" class="i">+                        ),
</a><a href="#h48-0-148" id="h48-0-148" class="i">+                    ],
</a><a href="#h48-0-149" id="h48-0-149" class="i">+                    expressions: [
</a><a href="#h48-0-150" id="h48-0-150" class="i">+                        Field(
</a><a href="#h48-0-151" id="h48-0-151" class="i">+                            None,
</a><a href="#h48-0-152" id="h48-0-152" class="i">+                            &quot;rating&quot;,
</a><a href="#h48-0-153" id="h48-0-153" class="i">+                        ),
</a><a href="#h48-0-154" id="h48-0-154" class="i">+                        Multiply(
</a><a href="#h48-0-155" id="h48-0-155" class="i">+                            Field(
</a><a href="#h48-0-156" id="h48-0-156" class="i">+                                None,
</a><a href="#h48-0-157" id="h48-0-157" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h48-0-158" id="h48-0-158" class="i">+                            ),
</a><a href="#h48-0-159" id="h48-0-159" class="i">+                            Constant(
</a><a href="#h48-0-160" id="h48-0-160" class="i">+                                Integer(
</a><a href="#h48-0-161" id="h48-0-161" class="i">+                                    2,
</a><a href="#h48-0-162" id="h48-0-162" class="i">+                                ),
</a><a href="#h48-0-163" id="h48-0-163" class="i">+                            ),
</a><a href="#h48-0-164" id="h48-0-164" class="i">+                        ),
</a><a href="#h48-0-165" id="h48-0-165" class="i">+                    ],
</a><a href="#h48-0-166" id="h48-0-166" class="i">+                },
</a><a href="#h48-0-167" id="h48-0-167" class="i">+                aggregates: [
</a><a href="#h48-0-168" id="h48-0-168" class="i">+                    Max,
</a><a href="#h48-0-169" id="h48-0-169" class="i">+                ],
</a><a href="#h48-0-170" id="h48-0-170" class="i">+            },
</a><a href="#h48-0-171" id="h48-0-171" class="i">+            labels: [
</a><a href="#h48-0-172" id="h48-0-172" class="i">+                Some(
</a><a href="#h48-0-173" id="h48-0-173" class="i">+                    &quot;twice&quot;,
</a><a href="#h48-0-174" id="h48-0-174" class="i">+                ),
</a><a href="#h48-0-175" id="h48-0-175" class="i">+                None,
</a><a href="#h48-0-176" id="h48-0-176" class="i">+            ],
</a><a href="#h48-0-177" id="h48-0-177" class="i">+            expressions: [
</a><a href="#h48-0-178" id="h48-0-178" class="i">+                Column(
</a><a href="#h48-0-179" id="h48-0-179" class="i">+                    1,
</a><a href="#h48-0-180" id="h48-0-180" class="i">+                ),
</a><a href="#h48-0-181" id="h48-0-181" class="i">+                Column(
</a><a href="#h48-0-182" id="h48-0-182" class="i">+                    0,
</a><a href="#h48-0-183" id="h48-0-183" class="i">+                ),
</a><a href="#h48-0-184" id="h48-0-184" class="i">+            ],
</a><a href="#h48-0-185" id="h48-0-185" class="i">+        },
</a><a href="#h48-0-186" id="h48-0-186" class="i">+        orders: [
</a><a href="#h48-0-187" id="h48-0-187" class="i">+            (
</a><a href="#h48-0-188" id="h48-0-188" class="i">+                Field(
</a><a href="#h48-0-189" id="h48-0-189" class="i">+                    None,
</a><a href="#h48-0-190" id="h48-0-190" class="i">+                    &quot;twice&quot;,
</a><a href="#h48-0-191" id="h48-0-191" class="i">+                ),
</a><a href="#h48-0-192" id="h48-0-192" class="i">+                Ascending,
</a><a href="#h48-0-193" id="h48-0-193" class="i">+            ),
</a><a href="#h48-0-194" id="h48-0-194" class="i">+        ],
</a><a href="#h48-0-195" id="h48-0-195" class="i">+    },
</a><a href="#h48-0-196" id="h48-0-196" class="i">+}
</a><a href="#h48-0-197" id="h48-0-197" class="i">+
</a><a href="#h48-0-198" id="h48-0-198" class="i">+Query: SELECT studio_id * 2 AS twice, MAX(rating) FROM movies GROUP BY twice ORDER BY twice
</a><a href="#h48-0-199" id="h48-0-199" class="i">+
</a><a href="#h48-0-200" id="h48-0-200" class="i">+Result: [&quot;twice&quot;, &quot;?&quot;]
</a><a href="#h48-0-201" id="h48-0-201" class="i">+[Integer(2), Float(8.2)]
</a><a href="#h48-0-202" id="h48-0-202" class="i">+[Integer(4), Float(7.6)]
</a><a href="#h48-0-203" id="h48-0-203" class="i">+[Integer(6), Float(6.9)]
</a><a href="#h48-0-204" id="h48-0-204" class="i">+[Integer(8), Float(8.8)]
</a><b>diff --git a/<a id="h49" href="../file/src/sql/tests/query/group_expr_both.html">src/sql/tests/query/group_expr_both</a> b/<a href="../file/src/sql/tests/query/group_expr_both.html">src/sql/tests/query/group_expr_both</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -0,0 +1,210 @@
</a><a href="#h49-0-0" id="h49-0-0" class="i">+Query: SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
</a><a href="#h49-0-1" id="h49-0-1" class="i">+
</a><a href="#h49-0-2" id="h49-0-2" class="i">+AST: Select {
</a><a href="#h49-0-3" id="h49-0-3" class="i">+    select: SelectClause {
</a><a href="#h49-0-4" id="h49-0-4" class="i">+        expressions: [
</a><a href="#h49-0-5" id="h49-0-5" class="i">+            Operation(
</a><a href="#h49-0-6" id="h49-0-6" class="i">+                Multiply(
</a><a href="#h49-0-7" id="h49-0-7" class="i">+                    Field(
</a><a href="#h49-0-8" id="h49-0-8" class="i">+                        None,
</a><a href="#h49-0-9" id="h49-0-9" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h49-0-10" id="h49-0-10" class="i">+                    ),
</a><a href="#h49-0-11" id="h49-0-11" class="i">+                    Literal(
</a><a href="#h49-0-12" id="h49-0-12" class="i">+                        Integer(
</a><a href="#h49-0-13" id="h49-0-13" class="i">+                            2,
</a><a href="#h49-0-14" id="h49-0-14" class="i">+                        ),
</a><a href="#h49-0-15" id="h49-0-15" class="i">+                    ),
</a><a href="#h49-0-16" id="h49-0-16" class="i">+                ),
</a><a href="#h49-0-17" id="h49-0-17" class="i">+            ),
</a><a href="#h49-0-18" id="h49-0-18" class="i">+            Function(
</a><a href="#h49-0-19" id="h49-0-19" class="i">+                &quot;max&quot;,
</a><a href="#h49-0-20" id="h49-0-20" class="i">+                [
</a><a href="#h49-0-21" id="h49-0-21" class="i">+                    Field(
</a><a href="#h49-0-22" id="h49-0-22" class="i">+                        None,
</a><a href="#h49-0-23" id="h49-0-23" class="i">+                        &quot;rating&quot;,
</a><a href="#h49-0-24" id="h49-0-24" class="i">+                    ),
</a><a href="#h49-0-25" id="h49-0-25" class="i">+                ],
</a><a href="#h49-0-26" id="h49-0-26" class="i">+            ),
</a><a href="#h49-0-27" id="h49-0-27" class="i">+        ],
</a><a href="#h49-0-28" id="h49-0-28" class="i">+        labels: [
</a><a href="#h49-0-29" id="h49-0-29" class="i">+            None,
</a><a href="#h49-0-30" id="h49-0-30" class="i">+            Some(
</a><a href="#h49-0-31" id="h49-0-31" class="i">+                &quot;rating&quot;,
</a><a href="#h49-0-32" id="h49-0-32" class="i">+            ),
</a><a href="#h49-0-33" id="h49-0-33" class="i">+        ],
</a><a href="#h49-0-34" id="h49-0-34" class="i">+    },
</a><a href="#h49-0-35" id="h49-0-35" class="i">+    from: Some(
</a><a href="#h49-0-36" id="h49-0-36" class="i">+        FromClause {
</a><a href="#h49-0-37" id="h49-0-37" class="i">+            items: [
</a><a href="#h49-0-38" id="h49-0-38" class="i">+                Table {
</a><a href="#h49-0-39" id="h49-0-39" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h49-0-40" id="h49-0-40" class="i">+                    alias: None,
</a><a href="#h49-0-41" id="h49-0-41" class="i">+                },
</a><a href="#h49-0-42" id="h49-0-42" class="i">+            ],
</a><a href="#h49-0-43" id="h49-0-43" class="i">+        },
</a><a href="#h49-0-44" id="h49-0-44" class="i">+    ),
</a><a href="#h49-0-45" id="h49-0-45" class="i">+    where: None,
</a><a href="#h49-0-46" id="h49-0-46" class="i">+    group_by: Some(
</a><a href="#h49-0-47" id="h49-0-47" class="i">+        GroupByClause(
</a><a href="#h49-0-48" id="h49-0-48" class="i">+            [
</a><a href="#h49-0-49" id="h49-0-49" class="i">+                Operation(
</a><a href="#h49-0-50" id="h49-0-50" class="i">+                    Multiply(
</a><a href="#h49-0-51" id="h49-0-51" class="i">+                        Field(
</a><a href="#h49-0-52" id="h49-0-52" class="i">+                            None,
</a><a href="#h49-0-53" id="h49-0-53" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h49-0-54" id="h49-0-54" class="i">+                        ),
</a><a href="#h49-0-55" id="h49-0-55" class="i">+                        Literal(
</a><a href="#h49-0-56" id="h49-0-56" class="i">+                            Integer(
</a><a href="#h49-0-57" id="h49-0-57" class="i">+                                2,
</a><a href="#h49-0-58" id="h49-0-58" class="i">+                            ),
</a><a href="#h49-0-59" id="h49-0-59" class="i">+                        ),
</a><a href="#h49-0-60" id="h49-0-60" class="i">+                    ),
</a><a href="#h49-0-61" id="h49-0-61" class="i">+                ),
</a><a href="#h49-0-62" id="h49-0-62" class="i">+            ],
</a><a href="#h49-0-63" id="h49-0-63" class="i">+        ),
</a><a href="#h49-0-64" id="h49-0-64" class="i">+    ),
</a><a href="#h49-0-65" id="h49-0-65" class="i">+    having: None,
</a><a href="#h49-0-66" id="h49-0-66" class="i">+    order: [
</a><a href="#h49-0-67" id="h49-0-67" class="i">+        (
</a><a href="#h49-0-68" id="h49-0-68" class="i">+            Field(
</a><a href="#h49-0-69" id="h49-0-69" class="i">+                None,
</a><a href="#h49-0-70" id="h49-0-70" class="i">+                &quot;rating&quot;,
</a><a href="#h49-0-71" id="h49-0-71" class="i">+            ),
</a><a href="#h49-0-72" id="h49-0-72" class="i">+            Ascending,
</a><a href="#h49-0-73" id="h49-0-73" class="i">+        ),
</a><a href="#h49-0-74" id="h49-0-74" class="i">+    ],
</a><a href="#h49-0-75" id="h49-0-75" class="i">+    limit: None,
</a><a href="#h49-0-76" id="h49-0-76" class="i">+    offset: None,
</a><a href="#h49-0-77" id="h49-0-77" class="i">+}
</a><a href="#h49-0-78" id="h49-0-78" class="i">+
</a><a href="#h49-0-79" id="h49-0-79" class="i">+Plan: Plan {
</a><a href="#h49-0-80" id="h49-0-80" class="i">+    root: Order {
</a><a href="#h49-0-81" id="h49-0-81" class="i">+        source: Projection {
</a><a href="#h49-0-82" id="h49-0-82" class="i">+            source: Aggregation {
</a><a href="#h49-0-83" id="h49-0-83" class="i">+                source: Projection {
</a><a href="#h49-0-84" id="h49-0-84" class="i">+                    source: Scan {
</a><a href="#h49-0-85" id="h49-0-85" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h49-0-86" id="h49-0-86" class="i">+                        alias: None,
</a><a href="#h49-0-87" id="h49-0-87" class="i">+                    },
</a><a href="#h49-0-88" id="h49-0-88" class="i">+                    labels: [
</a><a href="#h49-0-89" id="h49-0-89" class="i">+                        None,
</a><a href="#h49-0-90" id="h49-0-90" class="i">+                        None,
</a><a href="#h49-0-91" id="h49-0-91" class="i">+                    ],
</a><a href="#h49-0-92" id="h49-0-92" class="i">+                    expressions: [
</a><a href="#h49-0-93" id="h49-0-93" class="i">+                        Field(
</a><a href="#h49-0-94" id="h49-0-94" class="i">+                            None,
</a><a href="#h49-0-95" id="h49-0-95" class="i">+                            &quot;rating&quot;,
</a><a href="#h49-0-96" id="h49-0-96" class="i">+                        ),
</a><a href="#h49-0-97" id="h49-0-97" class="i">+                        Multiply(
</a><a href="#h49-0-98" id="h49-0-98" class="i">+                            Field(
</a><a href="#h49-0-99" id="h49-0-99" class="i">+                                None,
</a><a href="#h49-0-100" id="h49-0-100" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h49-0-101" id="h49-0-101" class="i">+                            ),
</a><a href="#h49-0-102" id="h49-0-102" class="i">+                            Constant(
</a><a href="#h49-0-103" id="h49-0-103" class="i">+                                Integer(
</a><a href="#h49-0-104" id="h49-0-104" class="i">+                                    2,
</a><a href="#h49-0-105" id="h49-0-105" class="i">+                                ),
</a><a href="#h49-0-106" id="h49-0-106" class="i">+                            ),
</a><a href="#h49-0-107" id="h49-0-107" class="i">+                        ),
</a><a href="#h49-0-108" id="h49-0-108" class="i">+                    ],
</a><a href="#h49-0-109" id="h49-0-109" class="i">+                },
</a><a href="#h49-0-110" id="h49-0-110" class="i">+                aggregates: [
</a><a href="#h49-0-111" id="h49-0-111" class="i">+                    Max,
</a><a href="#h49-0-112" id="h49-0-112" class="i">+                ],
</a><a href="#h49-0-113" id="h49-0-113" class="i">+            },
</a><a href="#h49-0-114" id="h49-0-114" class="i">+            labels: [
</a><a href="#h49-0-115" id="h49-0-115" class="i">+                None,
</a><a href="#h49-0-116" id="h49-0-116" class="i">+                Some(
</a><a href="#h49-0-117" id="h49-0-117" class="i">+                    &quot;rating&quot;,
</a><a href="#h49-0-118" id="h49-0-118" class="i">+                ),
</a><a href="#h49-0-119" id="h49-0-119" class="i">+            ],
</a><a href="#h49-0-120" id="h49-0-120" class="i">+            expressions: [
</a><a href="#h49-0-121" id="h49-0-121" class="i">+                Column(
</a><a href="#h49-0-122" id="h49-0-122" class="i">+                    1,
</a><a href="#h49-0-123" id="h49-0-123" class="i">+                ),
</a><a href="#h49-0-124" id="h49-0-124" class="i">+                Column(
</a><a href="#h49-0-125" id="h49-0-125" class="i">+                    0,
</a><a href="#h49-0-126" id="h49-0-126" class="i">+                ),
</a><a href="#h49-0-127" id="h49-0-127" class="i">+            ],
</a><a href="#h49-0-128" id="h49-0-128" class="i">+        },
</a><a href="#h49-0-129" id="h49-0-129" class="i">+        orders: [
</a><a href="#h49-0-130" id="h49-0-130" class="i">+            (
</a><a href="#h49-0-131" id="h49-0-131" class="i">+                Field(
</a><a href="#h49-0-132" id="h49-0-132" class="i">+                    None,
</a><a href="#h49-0-133" id="h49-0-133" class="i">+                    &quot;rating&quot;,
</a><a href="#h49-0-134" id="h49-0-134" class="i">+                ),
</a><a href="#h49-0-135" id="h49-0-135" class="i">+                Ascending,
</a><a href="#h49-0-136" id="h49-0-136" class="i">+            ),
</a><a href="#h49-0-137" id="h49-0-137" class="i">+        ],
</a><a href="#h49-0-138" id="h49-0-138" class="i">+    },
</a><a href="#h49-0-139" id="h49-0-139" class="i">+}
</a><a href="#h49-0-140" id="h49-0-140" class="i">+
</a><a href="#h49-0-141" id="h49-0-141" class="i">+Optimized plan: Plan {
</a><a href="#h49-0-142" id="h49-0-142" class="i">+    root: Order {
</a><a href="#h49-0-143" id="h49-0-143" class="i">+        source: Projection {
</a><a href="#h49-0-144" id="h49-0-144" class="i">+            source: Aggregation {
</a><a href="#h49-0-145" id="h49-0-145" class="i">+                source: Projection {
</a><a href="#h49-0-146" id="h49-0-146" class="i">+                    source: Scan {
</a><a href="#h49-0-147" id="h49-0-147" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h49-0-148" id="h49-0-148" class="i">+                        alias: None,
</a><a href="#h49-0-149" id="h49-0-149" class="i">+                    },
</a><a href="#h49-0-150" id="h49-0-150" class="i">+                    labels: [
</a><a href="#h49-0-151" id="h49-0-151" class="i">+                        None,
</a><a href="#h49-0-152" id="h49-0-152" class="i">+                        None,
</a><a href="#h49-0-153" id="h49-0-153" class="i">+                    ],
</a><a href="#h49-0-154" id="h49-0-154" class="i">+                    expressions: [
</a><a href="#h49-0-155" id="h49-0-155" class="i">+                        Field(
</a><a href="#h49-0-156" id="h49-0-156" class="i">+                            None,
</a><a href="#h49-0-157" id="h49-0-157" class="i">+                            &quot;rating&quot;,
</a><a href="#h49-0-158" id="h49-0-158" class="i">+                        ),
</a><a href="#h49-0-159" id="h49-0-159" class="i">+                        Multiply(
</a><a href="#h49-0-160" id="h49-0-160" class="i">+                            Field(
</a><a href="#h49-0-161" id="h49-0-161" class="i">+                                None,
</a><a href="#h49-0-162" id="h49-0-162" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h49-0-163" id="h49-0-163" class="i">+                            ),
</a><a href="#h49-0-164" id="h49-0-164" class="i">+                            Constant(
</a><a href="#h49-0-165" id="h49-0-165" class="i">+                                Integer(
</a><a href="#h49-0-166" id="h49-0-166" class="i">+                                    2,
</a><a href="#h49-0-167" id="h49-0-167" class="i">+                                ),
</a><a href="#h49-0-168" id="h49-0-168" class="i">+                            ),
</a><a href="#h49-0-169" id="h49-0-169" class="i">+                        ),
</a><a href="#h49-0-170" id="h49-0-170" class="i">+                    ],
</a><a href="#h49-0-171" id="h49-0-171" class="i">+                },
</a><a href="#h49-0-172" id="h49-0-172" class="i">+                aggregates: [
</a><a href="#h49-0-173" id="h49-0-173" class="i">+                    Max,
</a><a href="#h49-0-174" id="h49-0-174" class="i">+                ],
</a><a href="#h49-0-175" id="h49-0-175" class="i">+            },
</a><a href="#h49-0-176" id="h49-0-176" class="i">+            labels: [
</a><a href="#h49-0-177" id="h49-0-177" class="i">+                None,
</a><a href="#h49-0-178" id="h49-0-178" class="i">+                Some(
</a><a href="#h49-0-179" id="h49-0-179" class="i">+                    &quot;rating&quot;,
</a><a href="#h49-0-180" id="h49-0-180" class="i">+                ),
</a><a href="#h49-0-181" id="h49-0-181" class="i">+            ],
</a><a href="#h49-0-182" id="h49-0-182" class="i">+            expressions: [
</a><a href="#h49-0-183" id="h49-0-183" class="i">+                Column(
</a><a href="#h49-0-184" id="h49-0-184" class="i">+                    1,
</a><a href="#h49-0-185" id="h49-0-185" class="i">+                ),
</a><a href="#h49-0-186" id="h49-0-186" class="i">+                Column(
</a><a href="#h49-0-187" id="h49-0-187" class="i">+                    0,
</a><a href="#h49-0-188" id="h49-0-188" class="i">+                ),
</a><a href="#h49-0-189" id="h49-0-189" class="i">+            ],
</a><a href="#h49-0-190" id="h49-0-190" class="i">+        },
</a><a href="#h49-0-191" id="h49-0-191" class="i">+        orders: [
</a><a href="#h49-0-192" id="h49-0-192" class="i">+            (
</a><a href="#h49-0-193" id="h49-0-193" class="i">+                Field(
</a><a href="#h49-0-194" id="h49-0-194" class="i">+                    None,
</a><a href="#h49-0-195" id="h49-0-195" class="i">+                    &quot;rating&quot;,
</a><a href="#h49-0-196" id="h49-0-196" class="i">+                ),
</a><a href="#h49-0-197" id="h49-0-197" class="i">+                Ascending,
</a><a href="#h49-0-198" id="h49-0-198" class="i">+            ),
</a><a href="#h49-0-199" id="h49-0-199" class="i">+        ],
</a><a href="#h49-0-200" id="h49-0-200" class="i">+    },
</a><a href="#h49-0-201" id="h49-0-201" class="i">+}
</a><a href="#h49-0-202" id="h49-0-202" class="i">+
</a><a href="#h49-0-203" id="h49-0-203" class="i">+Query: SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
</a><a href="#h49-0-204" id="h49-0-204" class="i">+
</a><a href="#h49-0-205" id="h49-0-205" class="i">+Result: [&quot;?&quot;, &quot;rating&quot;]
</a><a href="#h49-0-206" id="h49-0-206" class="i">+[Integer(6), Float(6.9)]
</a><a href="#h49-0-207" id="h49-0-207" class="i">+[Integer(4), Float(7.6)]
</a><a href="#h49-0-208" id="h49-0-208" class="i">+[Integer(2), Float(8.2)]
</a><a href="#h49-0-209" id="h49-0-209" class="i">+[Integer(8), Float(8.8)]
</a><b>diff --git a/<a id="h50" href="../file/src/sql/tests/query/group_expr_extended.html">src/sql/tests/query/group_expr_extended</a> b/<a href="../file/src/sql/tests/query/group_expr_extended.html">src/sql/tests/query/group_expr_extended</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -0,0 +1,245 @@
</a><a href="#h50-0-0" id="h50-0-0" class="i">+Query: SELECT studio_id * 2 + 1, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
</a><a href="#h50-0-1" id="h50-0-1" class="i">+
</a><a href="#h50-0-2" id="h50-0-2" class="i">+AST: Select {
</a><a href="#h50-0-3" id="h50-0-3" class="i">+    select: SelectClause {
</a><a href="#h50-0-4" id="h50-0-4" class="i">+        expressions: [
</a><a href="#h50-0-5" id="h50-0-5" class="i">+            Operation(
</a><a href="#h50-0-6" id="h50-0-6" class="i">+                Add(
</a><a href="#h50-0-7" id="h50-0-7" class="i">+                    Operation(
</a><a href="#h50-0-8" id="h50-0-8" class="i">+                        Multiply(
</a><a href="#h50-0-9" id="h50-0-9" class="i">+                            Field(
</a><a href="#h50-0-10" id="h50-0-10" class="i">+                                None,
</a><a href="#h50-0-11" id="h50-0-11" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h50-0-12" id="h50-0-12" class="i">+                            ),
</a><a href="#h50-0-13" id="h50-0-13" class="i">+                            Literal(
</a><a href="#h50-0-14" id="h50-0-14" class="i">+                                Integer(
</a><a href="#h50-0-15" id="h50-0-15" class="i">+                                    2,
</a><a href="#h50-0-16" id="h50-0-16" class="i">+                                ),
</a><a href="#h50-0-17" id="h50-0-17" class="i">+                            ),
</a><a href="#h50-0-18" id="h50-0-18" class="i">+                        ),
</a><a href="#h50-0-19" id="h50-0-19" class="i">+                    ),
</a><a href="#h50-0-20" id="h50-0-20" class="i">+                    Literal(
</a><a href="#h50-0-21" id="h50-0-21" class="i">+                        Integer(
</a><a href="#h50-0-22" id="h50-0-22" class="i">+                            1,
</a><a href="#h50-0-23" id="h50-0-23" class="i">+                        ),
</a><a href="#h50-0-24" id="h50-0-24" class="i">+                    ),
</a><a href="#h50-0-25" id="h50-0-25" class="i">+                ),
</a><a href="#h50-0-26" id="h50-0-26" class="i">+            ),
</a><a href="#h50-0-27" id="h50-0-27" class="i">+            Function(
</a><a href="#h50-0-28" id="h50-0-28" class="i">+                &quot;max&quot;,
</a><a href="#h50-0-29" id="h50-0-29" class="i">+                [
</a><a href="#h50-0-30" id="h50-0-30" class="i">+                    Field(
</a><a href="#h50-0-31" id="h50-0-31" class="i">+                        None,
</a><a href="#h50-0-32" id="h50-0-32" class="i">+                        &quot;rating&quot;,
</a><a href="#h50-0-33" id="h50-0-33" class="i">+                    ),
</a><a href="#h50-0-34" id="h50-0-34" class="i">+                ],
</a><a href="#h50-0-35" id="h50-0-35" class="i">+            ),
</a><a href="#h50-0-36" id="h50-0-36" class="i">+        ],
</a><a href="#h50-0-37" id="h50-0-37" class="i">+        labels: [
</a><a href="#h50-0-38" id="h50-0-38" class="i">+            None,
</a><a href="#h50-0-39" id="h50-0-39" class="i">+            Some(
</a><a href="#h50-0-40" id="h50-0-40" class="i">+                &quot;rating&quot;,
</a><a href="#h50-0-41" id="h50-0-41" class="i">+            ),
</a><a href="#h50-0-42" id="h50-0-42" class="i">+        ],
</a><a href="#h50-0-43" id="h50-0-43" class="i">+    },
</a><a href="#h50-0-44" id="h50-0-44" class="i">+    from: Some(
</a><a href="#h50-0-45" id="h50-0-45" class="i">+        FromClause {
</a><a href="#h50-0-46" id="h50-0-46" class="i">+            items: [
</a><a href="#h50-0-47" id="h50-0-47" class="i">+                Table {
</a><a href="#h50-0-48" id="h50-0-48" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h50-0-49" id="h50-0-49" class="i">+                    alias: None,
</a><a href="#h50-0-50" id="h50-0-50" class="i">+                },
</a><a href="#h50-0-51" id="h50-0-51" class="i">+            ],
</a><a href="#h50-0-52" id="h50-0-52" class="i">+        },
</a><a href="#h50-0-53" id="h50-0-53" class="i">+    ),
</a><a href="#h50-0-54" id="h50-0-54" class="i">+    where: None,
</a><a href="#h50-0-55" id="h50-0-55" class="i">+    group_by: Some(
</a><a href="#h50-0-56" id="h50-0-56" class="i">+        GroupByClause(
</a><a href="#h50-0-57" id="h50-0-57" class="i">+            [
</a><a href="#h50-0-58" id="h50-0-58" class="i">+                Operation(
</a><a href="#h50-0-59" id="h50-0-59" class="i">+                    Multiply(
</a><a href="#h50-0-60" id="h50-0-60" class="i">+                        Field(
</a><a href="#h50-0-61" id="h50-0-61" class="i">+                            None,
</a><a href="#h50-0-62" id="h50-0-62" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h50-0-63" id="h50-0-63" class="i">+                        ),
</a><a href="#h50-0-64" id="h50-0-64" class="i">+                        Literal(
</a><a href="#h50-0-65" id="h50-0-65" class="i">+                            Integer(
</a><a href="#h50-0-66" id="h50-0-66" class="i">+                                2,
</a><a href="#h50-0-67" id="h50-0-67" class="i">+                            ),
</a><a href="#h50-0-68" id="h50-0-68" class="i">+                        ),
</a><a href="#h50-0-69" id="h50-0-69" class="i">+                    ),
</a><a href="#h50-0-70" id="h50-0-70" class="i">+                ),
</a><a href="#h50-0-71" id="h50-0-71" class="i">+            ],
</a><a href="#h50-0-72" id="h50-0-72" class="i">+        ),
</a><a href="#h50-0-73" id="h50-0-73" class="i">+    ),
</a><a href="#h50-0-74" id="h50-0-74" class="i">+    having: None,
</a><a href="#h50-0-75" id="h50-0-75" class="i">+    order: [
</a><a href="#h50-0-76" id="h50-0-76" class="i">+        (
</a><a href="#h50-0-77" id="h50-0-77" class="i">+            Field(
</a><a href="#h50-0-78" id="h50-0-78" class="i">+                None,
</a><a href="#h50-0-79" id="h50-0-79" class="i">+                &quot;rating&quot;,
</a><a href="#h50-0-80" id="h50-0-80" class="i">+            ),
</a><a href="#h50-0-81" id="h50-0-81" class="i">+            Ascending,
</a><a href="#h50-0-82" id="h50-0-82" class="i">+        ),
</a><a href="#h50-0-83" id="h50-0-83" class="i">+    ],
</a><a href="#h50-0-84" id="h50-0-84" class="i">+    limit: None,
</a><a href="#h50-0-85" id="h50-0-85" class="i">+    offset: None,
</a><a href="#h50-0-86" id="h50-0-86" class="i">+}
</a><a href="#h50-0-87" id="h50-0-87" class="i">+
</a><a href="#h50-0-88" id="h50-0-88" class="i">+Plan: Plan {
</a><a href="#h50-0-89" id="h50-0-89" class="i">+    root: Order {
</a><a href="#h50-0-90" id="h50-0-90" class="i">+        source: Projection {
</a><a href="#h50-0-91" id="h50-0-91" class="i">+            source: Aggregation {
</a><a href="#h50-0-92" id="h50-0-92" class="i">+                source: Projection {
</a><a href="#h50-0-93" id="h50-0-93" class="i">+                    source: Scan {
</a><a href="#h50-0-94" id="h50-0-94" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h50-0-95" id="h50-0-95" class="i">+                        alias: None,
</a><a href="#h50-0-96" id="h50-0-96" class="i">+                    },
</a><a href="#h50-0-97" id="h50-0-97" class="i">+                    labels: [
</a><a href="#h50-0-98" id="h50-0-98" class="i">+                        None,
</a><a href="#h50-0-99" id="h50-0-99" class="i">+                        None,
</a><a href="#h50-0-100" id="h50-0-100" class="i">+                    ],
</a><a href="#h50-0-101" id="h50-0-101" class="i">+                    expressions: [
</a><a href="#h50-0-102" id="h50-0-102" class="i">+                        Field(
</a><a href="#h50-0-103" id="h50-0-103" class="i">+                            None,
</a><a href="#h50-0-104" id="h50-0-104" class="i">+                            &quot;rating&quot;,
</a><a href="#h50-0-105" id="h50-0-105" class="i">+                        ),
</a><a href="#h50-0-106" id="h50-0-106" class="i">+                        Multiply(
</a><a href="#h50-0-107" id="h50-0-107" class="i">+                            Field(
</a><a href="#h50-0-108" id="h50-0-108" class="i">+                                None,
</a><a href="#h50-0-109" id="h50-0-109" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h50-0-110" id="h50-0-110" class="i">+                            ),
</a><a href="#h50-0-111" id="h50-0-111" class="i">+                            Constant(
</a><a href="#h50-0-112" id="h50-0-112" class="i">+                                Integer(
</a><a href="#h50-0-113" id="h50-0-113" class="i">+                                    2,
</a><a href="#h50-0-114" id="h50-0-114" class="i">+                                ),
</a><a href="#h50-0-115" id="h50-0-115" class="i">+                            ),
</a><a href="#h50-0-116" id="h50-0-116" class="i">+                        ),
</a><a href="#h50-0-117" id="h50-0-117" class="i">+                    ],
</a><a href="#h50-0-118" id="h50-0-118" class="i">+                },
</a><a href="#h50-0-119" id="h50-0-119" class="i">+                aggregates: [
</a><a href="#h50-0-120" id="h50-0-120" class="i">+                    Max,
</a><a href="#h50-0-121" id="h50-0-121" class="i">+                ],
</a><a href="#h50-0-122" id="h50-0-122" class="i">+            },
</a><a href="#h50-0-123" id="h50-0-123" class="i">+            labels: [
</a><a href="#h50-0-124" id="h50-0-124" class="i">+                None,
</a><a href="#h50-0-125" id="h50-0-125" class="i">+                Some(
</a><a href="#h50-0-126" id="h50-0-126" class="i">+                    &quot;rating&quot;,
</a><a href="#h50-0-127" id="h50-0-127" class="i">+                ),
</a><a href="#h50-0-128" id="h50-0-128" class="i">+            ],
</a><a href="#h50-0-129" id="h50-0-129" class="i">+            expressions: [
</a><a href="#h50-0-130" id="h50-0-130" class="i">+                Add(
</a><a href="#h50-0-131" id="h50-0-131" class="i">+                    Multiply(
</a><a href="#h50-0-132" id="h50-0-132" class="i">+                        Field(
</a><a href="#h50-0-133" id="h50-0-133" class="i">+                            None,
</a><a href="#h50-0-134" id="h50-0-134" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h50-0-135" id="h50-0-135" class="i">+                        ),
</a><a href="#h50-0-136" id="h50-0-136" class="i">+                        Constant(
</a><a href="#h50-0-137" id="h50-0-137" class="i">+                            Integer(
</a><a href="#h50-0-138" id="h50-0-138" class="i">+                                2,
</a><a href="#h50-0-139" id="h50-0-139" class="i">+                            ),
</a><a href="#h50-0-140" id="h50-0-140" class="i">+                        ),
</a><a href="#h50-0-141" id="h50-0-141" class="i">+                    ),
</a><a href="#h50-0-142" id="h50-0-142" class="i">+                    Constant(
</a><a href="#h50-0-143" id="h50-0-143" class="i">+                        Integer(
</a><a href="#h50-0-144" id="h50-0-144" class="i">+                            1,
</a><a href="#h50-0-145" id="h50-0-145" class="i">+                        ),
</a><a href="#h50-0-146" id="h50-0-146" class="i">+                    ),
</a><a href="#h50-0-147" id="h50-0-147" class="i">+                ),
</a><a href="#h50-0-148" id="h50-0-148" class="i">+                Column(
</a><a href="#h50-0-149" id="h50-0-149" class="i">+                    0,
</a><a href="#h50-0-150" id="h50-0-150" class="i">+                ),
</a><a href="#h50-0-151" id="h50-0-151" class="i">+            ],
</a><a href="#h50-0-152" id="h50-0-152" class="i">+        },
</a><a href="#h50-0-153" id="h50-0-153" class="i">+        orders: [
</a><a href="#h50-0-154" id="h50-0-154" class="i">+            (
</a><a href="#h50-0-155" id="h50-0-155" class="i">+                Field(
</a><a href="#h50-0-156" id="h50-0-156" class="i">+                    None,
</a><a href="#h50-0-157" id="h50-0-157" class="i">+                    &quot;rating&quot;,
</a><a href="#h50-0-158" id="h50-0-158" class="i">+                ),
</a><a href="#h50-0-159" id="h50-0-159" class="i">+                Ascending,
</a><a href="#h50-0-160" id="h50-0-160" class="i">+            ),
</a><a href="#h50-0-161" id="h50-0-161" class="i">+        ],
</a><a href="#h50-0-162" id="h50-0-162" class="i">+    },
</a><a href="#h50-0-163" id="h50-0-163" class="i">+}
</a><a href="#h50-0-164" id="h50-0-164" class="i">+
</a><a href="#h50-0-165" id="h50-0-165" class="i">+Optimized plan: Plan {
</a><a href="#h50-0-166" id="h50-0-166" class="i">+    root: Order {
</a><a href="#h50-0-167" id="h50-0-167" class="i">+        source: Projection {
</a><a href="#h50-0-168" id="h50-0-168" class="i">+            source: Aggregation {
</a><a href="#h50-0-169" id="h50-0-169" class="i">+                source: Projection {
</a><a href="#h50-0-170" id="h50-0-170" class="i">+                    source: Scan {
</a><a href="#h50-0-171" id="h50-0-171" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h50-0-172" id="h50-0-172" class="i">+                        alias: None,
</a><a href="#h50-0-173" id="h50-0-173" class="i">+                    },
</a><a href="#h50-0-174" id="h50-0-174" class="i">+                    labels: [
</a><a href="#h50-0-175" id="h50-0-175" class="i">+                        None,
</a><a href="#h50-0-176" id="h50-0-176" class="i">+                        None,
</a><a href="#h50-0-177" id="h50-0-177" class="i">+                    ],
</a><a href="#h50-0-178" id="h50-0-178" class="i">+                    expressions: [
</a><a href="#h50-0-179" id="h50-0-179" class="i">+                        Field(
</a><a href="#h50-0-180" id="h50-0-180" class="i">+                            None,
</a><a href="#h50-0-181" id="h50-0-181" class="i">+                            &quot;rating&quot;,
</a><a href="#h50-0-182" id="h50-0-182" class="i">+                        ),
</a><a href="#h50-0-183" id="h50-0-183" class="i">+                        Multiply(
</a><a href="#h50-0-184" id="h50-0-184" class="i">+                            Field(
</a><a href="#h50-0-185" id="h50-0-185" class="i">+                                None,
</a><a href="#h50-0-186" id="h50-0-186" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h50-0-187" id="h50-0-187" class="i">+                            ),
</a><a href="#h50-0-188" id="h50-0-188" class="i">+                            Constant(
</a><a href="#h50-0-189" id="h50-0-189" class="i">+                                Integer(
</a><a href="#h50-0-190" id="h50-0-190" class="i">+                                    2,
</a><a href="#h50-0-191" id="h50-0-191" class="i">+                                ),
</a><a href="#h50-0-192" id="h50-0-192" class="i">+                            ),
</a><a href="#h50-0-193" id="h50-0-193" class="i">+                        ),
</a><a href="#h50-0-194" id="h50-0-194" class="i">+                    ],
</a><a href="#h50-0-195" id="h50-0-195" class="i">+                },
</a><a href="#h50-0-196" id="h50-0-196" class="i">+                aggregates: [
</a><a href="#h50-0-197" id="h50-0-197" class="i">+                    Max,
</a><a href="#h50-0-198" id="h50-0-198" class="i">+                ],
</a><a href="#h50-0-199" id="h50-0-199" class="i">+            },
</a><a href="#h50-0-200" id="h50-0-200" class="i">+            labels: [
</a><a href="#h50-0-201" id="h50-0-201" class="i">+                None,
</a><a href="#h50-0-202" id="h50-0-202" class="i">+                Some(
</a><a href="#h50-0-203" id="h50-0-203" class="i">+                    &quot;rating&quot;,
</a><a href="#h50-0-204" id="h50-0-204" class="i">+                ),
</a><a href="#h50-0-205" id="h50-0-205" class="i">+            ],
</a><a href="#h50-0-206" id="h50-0-206" class="i">+            expressions: [
</a><a href="#h50-0-207" id="h50-0-207" class="i">+                Add(
</a><a href="#h50-0-208" id="h50-0-208" class="i">+                    Multiply(
</a><a href="#h50-0-209" id="h50-0-209" class="i">+                        Field(
</a><a href="#h50-0-210" id="h50-0-210" class="i">+                            None,
</a><a href="#h50-0-211" id="h50-0-211" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h50-0-212" id="h50-0-212" class="i">+                        ),
</a><a href="#h50-0-213" id="h50-0-213" class="i">+                        Constant(
</a><a href="#h50-0-214" id="h50-0-214" class="i">+                            Integer(
</a><a href="#h50-0-215" id="h50-0-215" class="i">+                                2,
</a><a href="#h50-0-216" id="h50-0-216" class="i">+                            ),
</a><a href="#h50-0-217" id="h50-0-217" class="i">+                        ),
</a><a href="#h50-0-218" id="h50-0-218" class="i">+                    ),
</a><a href="#h50-0-219" id="h50-0-219" class="i">+                    Constant(
</a><a href="#h50-0-220" id="h50-0-220" class="i">+                        Integer(
</a><a href="#h50-0-221" id="h50-0-221" class="i">+                            1,
</a><a href="#h50-0-222" id="h50-0-222" class="i">+                        ),
</a><a href="#h50-0-223" id="h50-0-223" class="i">+                    ),
</a><a href="#h50-0-224" id="h50-0-224" class="i">+                ),
</a><a href="#h50-0-225" id="h50-0-225" class="i">+                Column(
</a><a href="#h50-0-226" id="h50-0-226" class="i">+                    0,
</a><a href="#h50-0-227" id="h50-0-227" class="i">+                ),
</a><a href="#h50-0-228" id="h50-0-228" class="i">+            ],
</a><a href="#h50-0-229" id="h50-0-229" class="i">+        },
</a><a href="#h50-0-230" id="h50-0-230" class="i">+        orders: [
</a><a href="#h50-0-231" id="h50-0-231" class="i">+            (
</a><a href="#h50-0-232" id="h50-0-232" class="i">+                Field(
</a><a href="#h50-0-233" id="h50-0-233" class="i">+                    None,
</a><a href="#h50-0-234" id="h50-0-234" class="i">+                    &quot;rating&quot;,
</a><a href="#h50-0-235" id="h50-0-235" class="i">+                ),
</a><a href="#h50-0-236" id="h50-0-236" class="i">+                Ascending,
</a><a href="#h50-0-237" id="h50-0-237" class="i">+            ),
</a><a href="#h50-0-238" id="h50-0-238" class="i">+        ],
</a><a href="#h50-0-239" id="h50-0-239" class="i">+    },
</a><a href="#h50-0-240" id="h50-0-240" class="i">+}
</a><a href="#h50-0-241" id="h50-0-241" class="i">+
</a><a href="#h50-0-242" id="h50-0-242" class="i">+Query: SELECT studio_id * 2 + 1, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating
</a><a href="#h50-0-243" id="h50-0-243" class="i">+
</a><a href="#h50-0-244" id="h50-0-244" class="i">+Result: Value(&quot;Unknown field studio_id&quot;)
</a><a href="#h50-0-245" id="h50-0-245" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h51" href="../file/src/sql/tests/query/group_expr_multigroup.html">src/sql/tests/query/group_expr_multigroup</a> b/<a href="../file/src/sql/tests/query/group_expr_multigroup.html">src/sql/tests/query/group_expr_multigroup</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -0,0 +1,244 @@
</a><a href="#h51-0-0" id="h51-0-0" class="i">+Query: SELECT studio_id + genre_id AS multi, MAX(rating) AS rating FROM movies GROUP BY studio_id, genre_id ORDER BY rating, multi
</a><a href="#h51-0-1" id="h51-0-1" class="i">+
</a><a href="#h51-0-2" id="h51-0-2" class="i">+AST: Select {
</a><a href="#h51-0-3" id="h51-0-3" class="i">+    select: SelectClause {
</a><a href="#h51-0-4" id="h51-0-4" class="i">+        expressions: [
</a><a href="#h51-0-5" id="h51-0-5" class="i">+            Operation(
</a><a href="#h51-0-6" id="h51-0-6" class="i">+                Add(
</a><a href="#h51-0-7" id="h51-0-7" class="i">+                    Field(
</a><a href="#h51-0-8" id="h51-0-8" class="i">+                        None,
</a><a href="#h51-0-9" id="h51-0-9" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h51-0-10" id="h51-0-10" class="i">+                    ),
</a><a href="#h51-0-11" id="h51-0-11" class="i">+                    Field(
</a><a href="#h51-0-12" id="h51-0-12" class="i">+                        None,
</a><a href="#h51-0-13" id="h51-0-13" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h51-0-14" id="h51-0-14" class="i">+                    ),
</a><a href="#h51-0-15" id="h51-0-15" class="i">+                ),
</a><a href="#h51-0-16" id="h51-0-16" class="i">+            ),
</a><a href="#h51-0-17" id="h51-0-17" class="i">+            Function(
</a><a href="#h51-0-18" id="h51-0-18" class="i">+                &quot;max&quot;,
</a><a href="#h51-0-19" id="h51-0-19" class="i">+                [
</a><a href="#h51-0-20" id="h51-0-20" class="i">+                    Field(
</a><a href="#h51-0-21" id="h51-0-21" class="i">+                        None,
</a><a href="#h51-0-22" id="h51-0-22" class="i">+                        &quot;rating&quot;,
</a><a href="#h51-0-23" id="h51-0-23" class="i">+                    ),
</a><a href="#h51-0-24" id="h51-0-24" class="i">+                ],
</a><a href="#h51-0-25" id="h51-0-25" class="i">+            ),
</a><a href="#h51-0-26" id="h51-0-26" class="i">+        ],
</a><a href="#h51-0-27" id="h51-0-27" class="i">+        labels: [
</a><a href="#h51-0-28" id="h51-0-28" class="i">+            Some(
</a><a href="#h51-0-29" id="h51-0-29" class="i">+                &quot;multi&quot;,
</a><a href="#h51-0-30" id="h51-0-30" class="i">+            ),
</a><a href="#h51-0-31" id="h51-0-31" class="i">+            Some(
</a><a href="#h51-0-32" id="h51-0-32" class="i">+                &quot;rating&quot;,
</a><a href="#h51-0-33" id="h51-0-33" class="i">+            ),
</a><a href="#h51-0-34" id="h51-0-34" class="i">+        ],
</a><a href="#h51-0-35" id="h51-0-35" class="i">+    },
</a><a href="#h51-0-36" id="h51-0-36" class="i">+    from: Some(
</a><a href="#h51-0-37" id="h51-0-37" class="i">+        FromClause {
</a><a href="#h51-0-38" id="h51-0-38" class="i">+            items: [
</a><a href="#h51-0-39" id="h51-0-39" class="i">+                Table {
</a><a href="#h51-0-40" id="h51-0-40" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h51-0-41" id="h51-0-41" class="i">+                    alias: None,
</a><a href="#h51-0-42" id="h51-0-42" class="i">+                },
</a><a href="#h51-0-43" id="h51-0-43" class="i">+            ],
</a><a href="#h51-0-44" id="h51-0-44" class="i">+        },
</a><a href="#h51-0-45" id="h51-0-45" class="i">+    ),
</a><a href="#h51-0-46" id="h51-0-46" class="i">+    where: None,
</a><a href="#h51-0-47" id="h51-0-47" class="i">+    group_by: Some(
</a><a href="#h51-0-48" id="h51-0-48" class="i">+        GroupByClause(
</a><a href="#h51-0-49" id="h51-0-49" class="i">+            [
</a><a href="#h51-0-50" id="h51-0-50" class="i">+                Field(
</a><a href="#h51-0-51" id="h51-0-51" class="i">+                    None,
</a><a href="#h51-0-52" id="h51-0-52" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h51-0-53" id="h51-0-53" class="i">+                ),
</a><a href="#h51-0-54" id="h51-0-54" class="i">+                Field(
</a><a href="#h51-0-55" id="h51-0-55" class="i">+                    None,
</a><a href="#h51-0-56" id="h51-0-56" class="i">+                    &quot;genre_id&quot;,
</a><a href="#h51-0-57" id="h51-0-57" class="i">+                ),
</a><a href="#h51-0-58" id="h51-0-58" class="i">+            ],
</a><a href="#h51-0-59" id="h51-0-59" class="i">+        ),
</a><a href="#h51-0-60" id="h51-0-60" class="i">+    ),
</a><a href="#h51-0-61" id="h51-0-61" class="i">+    having: None,
</a><a href="#h51-0-62" id="h51-0-62" class="i">+    order: [
</a><a href="#h51-0-63" id="h51-0-63" class="i">+        (
</a><a href="#h51-0-64" id="h51-0-64" class="i">+            Field(
</a><a href="#h51-0-65" id="h51-0-65" class="i">+                None,
</a><a href="#h51-0-66" id="h51-0-66" class="i">+                &quot;rating&quot;,
</a><a href="#h51-0-67" id="h51-0-67" class="i">+            ),
</a><a href="#h51-0-68" id="h51-0-68" class="i">+            Ascending,
</a><a href="#h51-0-69" id="h51-0-69" class="i">+        ),
</a><a href="#h51-0-70" id="h51-0-70" class="i">+        (
</a><a href="#h51-0-71" id="h51-0-71" class="i">+            Field(
</a><a href="#h51-0-72" id="h51-0-72" class="i">+                None,
</a><a href="#h51-0-73" id="h51-0-73" class="i">+                &quot;multi&quot;,
</a><a href="#h51-0-74" id="h51-0-74" class="i">+            ),
</a><a href="#h51-0-75" id="h51-0-75" class="i">+            Ascending,
</a><a href="#h51-0-76" id="h51-0-76" class="i">+        ),
</a><a href="#h51-0-77" id="h51-0-77" class="i">+    ],
</a><a href="#h51-0-78" id="h51-0-78" class="i">+    limit: None,
</a><a href="#h51-0-79" id="h51-0-79" class="i">+    offset: None,
</a><a href="#h51-0-80" id="h51-0-80" class="i">+}
</a><a href="#h51-0-81" id="h51-0-81" class="i">+
</a><a href="#h51-0-82" id="h51-0-82" class="i">+Plan: Plan {
</a><a href="#h51-0-83" id="h51-0-83" class="i">+    root: Order {
</a><a href="#h51-0-84" id="h51-0-84" class="i">+        source: Projection {
</a><a href="#h51-0-85" id="h51-0-85" class="i">+            source: Aggregation {
</a><a href="#h51-0-86" id="h51-0-86" class="i">+                source: Projection {
</a><a href="#h51-0-87" id="h51-0-87" class="i">+                    source: Scan {
</a><a href="#h51-0-88" id="h51-0-88" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h51-0-89" id="h51-0-89" class="i">+                        alias: None,
</a><a href="#h51-0-90" id="h51-0-90" class="i">+                    },
</a><a href="#h51-0-91" id="h51-0-91" class="i">+                    labels: [
</a><a href="#h51-0-92" id="h51-0-92" class="i">+                        None,
</a><a href="#h51-0-93" id="h51-0-93" class="i">+                        None,
</a><a href="#h51-0-94" id="h51-0-94" class="i">+                        None,
</a><a href="#h51-0-95" id="h51-0-95" class="i">+                    ],
</a><a href="#h51-0-96" id="h51-0-96" class="i">+                    expressions: [
</a><a href="#h51-0-97" id="h51-0-97" class="i">+                        Field(
</a><a href="#h51-0-98" id="h51-0-98" class="i">+                            None,
</a><a href="#h51-0-99" id="h51-0-99" class="i">+                            &quot;rating&quot;,
</a><a href="#h51-0-100" id="h51-0-100" class="i">+                        ),
</a><a href="#h51-0-101" id="h51-0-101" class="i">+                        Field(
</a><a href="#h51-0-102" id="h51-0-102" class="i">+                            None,
</a><a href="#h51-0-103" id="h51-0-103" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h51-0-104" id="h51-0-104" class="i">+                        ),
</a><a href="#h51-0-105" id="h51-0-105" class="i">+                        Field(
</a><a href="#h51-0-106" id="h51-0-106" class="i">+                            None,
</a><a href="#h51-0-107" id="h51-0-107" class="i">+                            &quot;genre_id&quot;,
</a><a href="#h51-0-108" id="h51-0-108" class="i">+                        ),
</a><a href="#h51-0-109" id="h51-0-109" class="i">+                    ],
</a><a href="#h51-0-110" id="h51-0-110" class="i">+                },
</a><a href="#h51-0-111" id="h51-0-111" class="i">+                aggregates: [
</a><a href="#h51-0-112" id="h51-0-112" class="i">+                    Max,
</a><a href="#h51-0-113" id="h51-0-113" class="i">+                ],
</a><a href="#h51-0-114" id="h51-0-114" class="i">+            },
</a><a href="#h51-0-115" id="h51-0-115" class="i">+            labels: [
</a><a href="#h51-0-116" id="h51-0-116" class="i">+                Some(
</a><a href="#h51-0-117" id="h51-0-117" class="i">+                    &quot;multi&quot;,
</a><a href="#h51-0-118" id="h51-0-118" class="i">+                ),
</a><a href="#h51-0-119" id="h51-0-119" class="i">+                Some(
</a><a href="#h51-0-120" id="h51-0-120" class="i">+                    &quot;rating&quot;,
</a><a href="#h51-0-121" id="h51-0-121" class="i">+                ),
</a><a href="#h51-0-122" id="h51-0-122" class="i">+            ],
</a><a href="#h51-0-123" id="h51-0-123" class="i">+            expressions: [
</a><a href="#h51-0-124" id="h51-0-124" class="i">+                Add(
</a><a href="#h51-0-125" id="h51-0-125" class="i">+                    Field(
</a><a href="#h51-0-126" id="h51-0-126" class="i">+                        None,
</a><a href="#h51-0-127" id="h51-0-127" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h51-0-128" id="h51-0-128" class="i">+                    ),
</a><a href="#h51-0-129" id="h51-0-129" class="i">+                    Field(
</a><a href="#h51-0-130" id="h51-0-130" class="i">+                        None,
</a><a href="#h51-0-131" id="h51-0-131" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h51-0-132" id="h51-0-132" class="i">+                    ),
</a><a href="#h51-0-133" id="h51-0-133" class="i">+                ),
</a><a href="#h51-0-134" id="h51-0-134" class="i">+                Column(
</a><a href="#h51-0-135" id="h51-0-135" class="i">+                    0,
</a><a href="#h51-0-136" id="h51-0-136" class="i">+                ),
</a><a href="#h51-0-137" id="h51-0-137" class="i">+            ],
</a><a href="#h51-0-138" id="h51-0-138" class="i">+        },
</a><a href="#h51-0-139" id="h51-0-139" class="i">+        orders: [
</a><a href="#h51-0-140" id="h51-0-140" class="i">+            (
</a><a href="#h51-0-141" id="h51-0-141" class="i">+                Field(
</a><a href="#h51-0-142" id="h51-0-142" class="i">+                    None,
</a><a href="#h51-0-143" id="h51-0-143" class="i">+                    &quot;rating&quot;,
</a><a href="#h51-0-144" id="h51-0-144" class="i">+                ),
</a><a href="#h51-0-145" id="h51-0-145" class="i">+                Ascending,
</a><a href="#h51-0-146" id="h51-0-146" class="i">+            ),
</a><a href="#h51-0-147" id="h51-0-147" class="i">+            (
</a><a href="#h51-0-148" id="h51-0-148" class="i">+                Field(
</a><a href="#h51-0-149" id="h51-0-149" class="i">+                    None,
</a><a href="#h51-0-150" id="h51-0-150" class="i">+                    &quot;multi&quot;,
</a><a href="#h51-0-151" id="h51-0-151" class="i">+                ),
</a><a href="#h51-0-152" id="h51-0-152" class="i">+                Ascending,
</a><a href="#h51-0-153" id="h51-0-153" class="i">+            ),
</a><a href="#h51-0-154" id="h51-0-154" class="i">+        ],
</a><a href="#h51-0-155" id="h51-0-155" class="i">+    },
</a><a href="#h51-0-156" id="h51-0-156" class="i">+}
</a><a href="#h51-0-157" id="h51-0-157" class="i">+
</a><a href="#h51-0-158" id="h51-0-158" class="i">+Optimized plan: Plan {
</a><a href="#h51-0-159" id="h51-0-159" class="i">+    root: Order {
</a><a href="#h51-0-160" id="h51-0-160" class="i">+        source: Projection {
</a><a href="#h51-0-161" id="h51-0-161" class="i">+            source: Aggregation {
</a><a href="#h51-0-162" id="h51-0-162" class="i">+                source: Projection {
</a><a href="#h51-0-163" id="h51-0-163" class="i">+                    source: Scan {
</a><a href="#h51-0-164" id="h51-0-164" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h51-0-165" id="h51-0-165" class="i">+                        alias: None,
</a><a href="#h51-0-166" id="h51-0-166" class="i">+                    },
</a><a href="#h51-0-167" id="h51-0-167" class="i">+                    labels: [
</a><a href="#h51-0-168" id="h51-0-168" class="i">+                        None,
</a><a href="#h51-0-169" id="h51-0-169" class="i">+                        None,
</a><a href="#h51-0-170" id="h51-0-170" class="i">+                        None,
</a><a href="#h51-0-171" id="h51-0-171" class="i">+                    ],
</a><a href="#h51-0-172" id="h51-0-172" class="i">+                    expressions: [
</a><a href="#h51-0-173" id="h51-0-173" class="i">+                        Field(
</a><a href="#h51-0-174" id="h51-0-174" class="i">+                            None,
</a><a href="#h51-0-175" id="h51-0-175" class="i">+                            &quot;rating&quot;,
</a><a href="#h51-0-176" id="h51-0-176" class="i">+                        ),
</a><a href="#h51-0-177" id="h51-0-177" class="i">+                        Field(
</a><a href="#h51-0-178" id="h51-0-178" class="i">+                            None,
</a><a href="#h51-0-179" id="h51-0-179" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h51-0-180" id="h51-0-180" class="i">+                        ),
</a><a href="#h51-0-181" id="h51-0-181" class="i">+                        Field(
</a><a href="#h51-0-182" id="h51-0-182" class="i">+                            None,
</a><a href="#h51-0-183" id="h51-0-183" class="i">+                            &quot;genre_id&quot;,
</a><a href="#h51-0-184" id="h51-0-184" class="i">+                        ),
</a><a href="#h51-0-185" id="h51-0-185" class="i">+                    ],
</a><a href="#h51-0-186" id="h51-0-186" class="i">+                },
</a><a href="#h51-0-187" id="h51-0-187" class="i">+                aggregates: [
</a><a href="#h51-0-188" id="h51-0-188" class="i">+                    Max,
</a><a href="#h51-0-189" id="h51-0-189" class="i">+                ],
</a><a href="#h51-0-190" id="h51-0-190" class="i">+            },
</a><a href="#h51-0-191" id="h51-0-191" class="i">+            labels: [
</a><a href="#h51-0-192" id="h51-0-192" class="i">+                Some(
</a><a href="#h51-0-193" id="h51-0-193" class="i">+                    &quot;multi&quot;,
</a><a href="#h51-0-194" id="h51-0-194" class="i">+                ),
</a><a href="#h51-0-195" id="h51-0-195" class="i">+                Some(
</a><a href="#h51-0-196" id="h51-0-196" class="i">+                    &quot;rating&quot;,
</a><a href="#h51-0-197" id="h51-0-197" class="i">+                ),
</a><a href="#h51-0-198" id="h51-0-198" class="i">+            ],
</a><a href="#h51-0-199" id="h51-0-199" class="i">+            expressions: [
</a><a href="#h51-0-200" id="h51-0-200" class="i">+                Add(
</a><a href="#h51-0-201" id="h51-0-201" class="i">+                    Field(
</a><a href="#h51-0-202" id="h51-0-202" class="i">+                        None,
</a><a href="#h51-0-203" id="h51-0-203" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h51-0-204" id="h51-0-204" class="i">+                    ),
</a><a href="#h51-0-205" id="h51-0-205" class="i">+                    Field(
</a><a href="#h51-0-206" id="h51-0-206" class="i">+                        None,
</a><a href="#h51-0-207" id="h51-0-207" class="i">+                        &quot;genre_id&quot;,
</a><a href="#h51-0-208" id="h51-0-208" class="i">+                    ),
</a><a href="#h51-0-209" id="h51-0-209" class="i">+                ),
</a><a href="#h51-0-210" id="h51-0-210" class="i">+                Column(
</a><a href="#h51-0-211" id="h51-0-211" class="i">+                    0,
</a><a href="#h51-0-212" id="h51-0-212" class="i">+                ),
</a><a href="#h51-0-213" id="h51-0-213" class="i">+            ],
</a><a href="#h51-0-214" id="h51-0-214" class="i">+        },
</a><a href="#h51-0-215" id="h51-0-215" class="i">+        orders: [
</a><a href="#h51-0-216" id="h51-0-216" class="i">+            (
</a><a href="#h51-0-217" id="h51-0-217" class="i">+                Field(
</a><a href="#h51-0-218" id="h51-0-218" class="i">+                    None,
</a><a href="#h51-0-219" id="h51-0-219" class="i">+                    &quot;rating&quot;,
</a><a href="#h51-0-220" id="h51-0-220" class="i">+                ),
</a><a href="#h51-0-221" id="h51-0-221" class="i">+                Ascending,
</a><a href="#h51-0-222" id="h51-0-222" class="i">+            ),
</a><a href="#h51-0-223" id="h51-0-223" class="i">+            (
</a><a href="#h51-0-224" id="h51-0-224" class="i">+                Field(
</a><a href="#h51-0-225" id="h51-0-225" class="i">+                    None,
</a><a href="#h51-0-226" id="h51-0-226" class="i">+                    &quot;multi&quot;,
</a><a href="#h51-0-227" id="h51-0-227" class="i">+                ),
</a><a href="#h51-0-228" id="h51-0-228" class="i">+                Ascending,
</a><a href="#h51-0-229" id="h51-0-229" class="i">+            ),
</a><a href="#h51-0-230" id="h51-0-230" class="i">+        ],
</a><a href="#h51-0-231" id="h51-0-231" class="i">+    },
</a><a href="#h51-0-232" id="h51-0-232" class="i">+}
</a><a href="#h51-0-233" id="h51-0-233" class="i">+
</a><a href="#h51-0-234" id="h51-0-234" class="i">+Query: SELECT studio_id + genre_id AS multi, MAX(rating) AS rating FROM movies GROUP BY studio_id, genre_id ORDER BY rating, multi
</a><a href="#h51-0-235" id="h51-0-235" class="i">+
</a><a href="#h51-0-236" id="h51-0-236" class="i">+Result: [&quot;multi&quot;, &quot;rating&quot;]
</a><a href="#h51-0-237" id="h51-0-237" class="i">+[Integer(4), Float(6.9)]
</a><a href="#h51-0-238" id="h51-0-238" class="i">+[Integer(5), Float(7.4)]
</a><a href="#h51-0-239" id="h51-0-239" class="i">+[Integer(4), Float(7.6)]
</a><a href="#h51-0-240" id="h51-0-240" class="i">+[Integer(7), Float(7.7)]
</a><a href="#h51-0-241" id="h51-0-241" class="i">+[Integer(2), Float(8.2)]
</a><a href="#h51-0-242" id="h51-0-242" class="i">+[Integer(6), Float(8.2)]
</a><a href="#h51-0-243" id="h51-0-243" class="i">+[Integer(5), Float(8.8)]
</a><b>diff --git a/<a id="h52" href="../file/src/sql/tests/query/group_expr_select.html">src/sql/tests/query/group_expr_select</a> b/<a href="../file/src/sql/tests/query/group_expr_select.html">src/sql/tests/query/group_expr_select</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -0,0 +1,203 @@
</a><a href="#h52-0-0" id="h52-0-0" class="i">+Query: SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id ORDER BY rating
</a><a href="#h52-0-1" id="h52-0-1" class="i">+
</a><a href="#h52-0-2" id="h52-0-2" class="i">+AST: Select {
</a><a href="#h52-0-3" id="h52-0-3" class="i">+    select: SelectClause {
</a><a href="#h52-0-4" id="h52-0-4" class="i">+        expressions: [
</a><a href="#h52-0-5" id="h52-0-5" class="i">+            Operation(
</a><a href="#h52-0-6" id="h52-0-6" class="i">+                Multiply(
</a><a href="#h52-0-7" id="h52-0-7" class="i">+                    Field(
</a><a href="#h52-0-8" id="h52-0-8" class="i">+                        None,
</a><a href="#h52-0-9" id="h52-0-9" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h52-0-10" id="h52-0-10" class="i">+                    ),
</a><a href="#h52-0-11" id="h52-0-11" class="i">+                    Literal(
</a><a href="#h52-0-12" id="h52-0-12" class="i">+                        Integer(
</a><a href="#h52-0-13" id="h52-0-13" class="i">+                            2,
</a><a href="#h52-0-14" id="h52-0-14" class="i">+                        ),
</a><a href="#h52-0-15" id="h52-0-15" class="i">+                    ),
</a><a href="#h52-0-16" id="h52-0-16" class="i">+                ),
</a><a href="#h52-0-17" id="h52-0-17" class="i">+            ),
</a><a href="#h52-0-18" id="h52-0-18" class="i">+            Function(
</a><a href="#h52-0-19" id="h52-0-19" class="i">+                &quot;max&quot;,
</a><a href="#h52-0-20" id="h52-0-20" class="i">+                [
</a><a href="#h52-0-21" id="h52-0-21" class="i">+                    Field(
</a><a href="#h52-0-22" id="h52-0-22" class="i">+                        None,
</a><a href="#h52-0-23" id="h52-0-23" class="i">+                        &quot;rating&quot;,
</a><a href="#h52-0-24" id="h52-0-24" class="i">+                    ),
</a><a href="#h52-0-25" id="h52-0-25" class="i">+                ],
</a><a href="#h52-0-26" id="h52-0-26" class="i">+            ),
</a><a href="#h52-0-27" id="h52-0-27" class="i">+        ],
</a><a href="#h52-0-28" id="h52-0-28" class="i">+        labels: [
</a><a href="#h52-0-29" id="h52-0-29" class="i">+            None,
</a><a href="#h52-0-30" id="h52-0-30" class="i">+            Some(
</a><a href="#h52-0-31" id="h52-0-31" class="i">+                &quot;rating&quot;,
</a><a href="#h52-0-32" id="h52-0-32" class="i">+            ),
</a><a href="#h52-0-33" id="h52-0-33" class="i">+        ],
</a><a href="#h52-0-34" id="h52-0-34" class="i">+    },
</a><a href="#h52-0-35" id="h52-0-35" class="i">+    from: Some(
</a><a href="#h52-0-36" id="h52-0-36" class="i">+        FromClause {
</a><a href="#h52-0-37" id="h52-0-37" class="i">+            items: [
</a><a href="#h52-0-38" id="h52-0-38" class="i">+                Table {
</a><a href="#h52-0-39" id="h52-0-39" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h52-0-40" id="h52-0-40" class="i">+                    alias: None,
</a><a href="#h52-0-41" id="h52-0-41" class="i">+                },
</a><a href="#h52-0-42" id="h52-0-42" class="i">+            ],
</a><a href="#h52-0-43" id="h52-0-43" class="i">+        },
</a><a href="#h52-0-44" id="h52-0-44" class="i">+    ),
</a><a href="#h52-0-45" id="h52-0-45" class="i">+    where: None,
</a><a href="#h52-0-46" id="h52-0-46" class="i">+    group_by: Some(
</a><a href="#h52-0-47" id="h52-0-47" class="i">+        GroupByClause(
</a><a href="#h52-0-48" id="h52-0-48" class="i">+            [
</a><a href="#h52-0-49" id="h52-0-49" class="i">+                Field(
</a><a href="#h52-0-50" id="h52-0-50" class="i">+                    None,
</a><a href="#h52-0-51" id="h52-0-51" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h52-0-52" id="h52-0-52" class="i">+                ),
</a><a href="#h52-0-53" id="h52-0-53" class="i">+            ],
</a><a href="#h52-0-54" id="h52-0-54" class="i">+        ),
</a><a href="#h52-0-55" id="h52-0-55" class="i">+    ),
</a><a href="#h52-0-56" id="h52-0-56" class="i">+    having: None,
</a><a href="#h52-0-57" id="h52-0-57" class="i">+    order: [
</a><a href="#h52-0-58" id="h52-0-58" class="i">+        (
</a><a href="#h52-0-59" id="h52-0-59" class="i">+            Field(
</a><a href="#h52-0-60" id="h52-0-60" class="i">+                None,
</a><a href="#h52-0-61" id="h52-0-61" class="i">+                &quot;rating&quot;,
</a><a href="#h52-0-62" id="h52-0-62" class="i">+            ),
</a><a href="#h52-0-63" id="h52-0-63" class="i">+            Ascending,
</a><a href="#h52-0-64" id="h52-0-64" class="i">+        ),
</a><a href="#h52-0-65" id="h52-0-65" class="i">+    ],
</a><a href="#h52-0-66" id="h52-0-66" class="i">+    limit: None,
</a><a href="#h52-0-67" id="h52-0-67" class="i">+    offset: None,
</a><a href="#h52-0-68" id="h52-0-68" class="i">+}
</a><a href="#h52-0-69" id="h52-0-69" class="i">+
</a><a href="#h52-0-70" id="h52-0-70" class="i">+Plan: Plan {
</a><a href="#h52-0-71" id="h52-0-71" class="i">+    root: Order {
</a><a href="#h52-0-72" id="h52-0-72" class="i">+        source: Projection {
</a><a href="#h52-0-73" id="h52-0-73" class="i">+            source: Aggregation {
</a><a href="#h52-0-74" id="h52-0-74" class="i">+                source: Projection {
</a><a href="#h52-0-75" id="h52-0-75" class="i">+                    source: Scan {
</a><a href="#h52-0-76" id="h52-0-76" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h52-0-77" id="h52-0-77" class="i">+                        alias: None,
</a><a href="#h52-0-78" id="h52-0-78" class="i">+                    },
</a><a href="#h52-0-79" id="h52-0-79" class="i">+                    labels: [
</a><a href="#h52-0-80" id="h52-0-80" class="i">+                        None,
</a><a href="#h52-0-81" id="h52-0-81" class="i">+                        None,
</a><a href="#h52-0-82" id="h52-0-82" class="i">+                    ],
</a><a href="#h52-0-83" id="h52-0-83" class="i">+                    expressions: [
</a><a href="#h52-0-84" id="h52-0-84" class="i">+                        Field(
</a><a href="#h52-0-85" id="h52-0-85" class="i">+                            None,
</a><a href="#h52-0-86" id="h52-0-86" class="i">+                            &quot;rating&quot;,
</a><a href="#h52-0-87" id="h52-0-87" class="i">+                        ),
</a><a href="#h52-0-88" id="h52-0-88" class="i">+                        Field(
</a><a href="#h52-0-89" id="h52-0-89" class="i">+                            None,
</a><a href="#h52-0-90" id="h52-0-90" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h52-0-91" id="h52-0-91" class="i">+                        ),
</a><a href="#h52-0-92" id="h52-0-92" class="i">+                    ],
</a><a href="#h52-0-93" id="h52-0-93" class="i">+                },
</a><a href="#h52-0-94" id="h52-0-94" class="i">+                aggregates: [
</a><a href="#h52-0-95" id="h52-0-95" class="i">+                    Max,
</a><a href="#h52-0-96" id="h52-0-96" class="i">+                ],
</a><a href="#h52-0-97" id="h52-0-97" class="i">+            },
</a><a href="#h52-0-98" id="h52-0-98" class="i">+            labels: [
</a><a href="#h52-0-99" id="h52-0-99" class="i">+                None,
</a><a href="#h52-0-100" id="h52-0-100" class="i">+                Some(
</a><a href="#h52-0-101" id="h52-0-101" class="i">+                    &quot;rating&quot;,
</a><a href="#h52-0-102" id="h52-0-102" class="i">+                ),
</a><a href="#h52-0-103" id="h52-0-103" class="i">+            ],
</a><a href="#h52-0-104" id="h52-0-104" class="i">+            expressions: [
</a><a href="#h52-0-105" id="h52-0-105" class="i">+                Multiply(
</a><a href="#h52-0-106" id="h52-0-106" class="i">+                    Field(
</a><a href="#h52-0-107" id="h52-0-107" class="i">+                        None,
</a><a href="#h52-0-108" id="h52-0-108" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h52-0-109" id="h52-0-109" class="i">+                    ),
</a><a href="#h52-0-110" id="h52-0-110" class="i">+                    Constant(
</a><a href="#h52-0-111" id="h52-0-111" class="i">+                        Integer(
</a><a href="#h52-0-112" id="h52-0-112" class="i">+                            2,
</a><a href="#h52-0-113" id="h52-0-113" class="i">+                        ),
</a><a href="#h52-0-114" id="h52-0-114" class="i">+                    ),
</a><a href="#h52-0-115" id="h52-0-115" class="i">+                ),
</a><a href="#h52-0-116" id="h52-0-116" class="i">+                Column(
</a><a href="#h52-0-117" id="h52-0-117" class="i">+                    0,
</a><a href="#h52-0-118" id="h52-0-118" class="i">+                ),
</a><a href="#h52-0-119" id="h52-0-119" class="i">+            ],
</a><a href="#h52-0-120" id="h52-0-120" class="i">+        },
</a><a href="#h52-0-121" id="h52-0-121" class="i">+        orders: [
</a><a href="#h52-0-122" id="h52-0-122" class="i">+            (
</a><a href="#h52-0-123" id="h52-0-123" class="i">+                Field(
</a><a href="#h52-0-124" id="h52-0-124" class="i">+                    None,
</a><a href="#h52-0-125" id="h52-0-125" class="i">+                    &quot;rating&quot;,
</a><a href="#h52-0-126" id="h52-0-126" class="i">+                ),
</a><a href="#h52-0-127" id="h52-0-127" class="i">+                Ascending,
</a><a href="#h52-0-128" id="h52-0-128" class="i">+            ),
</a><a href="#h52-0-129" id="h52-0-129" class="i">+        ],
</a><a href="#h52-0-130" id="h52-0-130" class="i">+    },
</a><a href="#h52-0-131" id="h52-0-131" class="i">+}
</a><a href="#h52-0-132" id="h52-0-132" class="i">+
</a><a href="#h52-0-133" id="h52-0-133" class="i">+Optimized plan: Plan {
</a><a href="#h52-0-134" id="h52-0-134" class="i">+    root: Order {
</a><a href="#h52-0-135" id="h52-0-135" class="i">+        source: Projection {
</a><a href="#h52-0-136" id="h52-0-136" class="i">+            source: Aggregation {
</a><a href="#h52-0-137" id="h52-0-137" class="i">+                source: Projection {
</a><a href="#h52-0-138" id="h52-0-138" class="i">+                    source: Scan {
</a><a href="#h52-0-139" id="h52-0-139" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h52-0-140" id="h52-0-140" class="i">+                        alias: None,
</a><a href="#h52-0-141" id="h52-0-141" class="i">+                    },
</a><a href="#h52-0-142" id="h52-0-142" class="i">+                    labels: [
</a><a href="#h52-0-143" id="h52-0-143" class="i">+                        None,
</a><a href="#h52-0-144" id="h52-0-144" class="i">+                        None,
</a><a href="#h52-0-145" id="h52-0-145" class="i">+                    ],
</a><a href="#h52-0-146" id="h52-0-146" class="i">+                    expressions: [
</a><a href="#h52-0-147" id="h52-0-147" class="i">+                        Field(
</a><a href="#h52-0-148" id="h52-0-148" class="i">+                            None,
</a><a href="#h52-0-149" id="h52-0-149" class="i">+                            &quot;rating&quot;,
</a><a href="#h52-0-150" id="h52-0-150" class="i">+                        ),
</a><a href="#h52-0-151" id="h52-0-151" class="i">+                        Field(
</a><a href="#h52-0-152" id="h52-0-152" class="i">+                            None,
</a><a href="#h52-0-153" id="h52-0-153" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h52-0-154" id="h52-0-154" class="i">+                        ),
</a><a href="#h52-0-155" id="h52-0-155" class="i">+                    ],
</a><a href="#h52-0-156" id="h52-0-156" class="i">+                },
</a><a href="#h52-0-157" id="h52-0-157" class="i">+                aggregates: [
</a><a href="#h52-0-158" id="h52-0-158" class="i">+                    Max,
</a><a href="#h52-0-159" id="h52-0-159" class="i">+                ],
</a><a href="#h52-0-160" id="h52-0-160" class="i">+            },
</a><a href="#h52-0-161" id="h52-0-161" class="i">+            labels: [
</a><a href="#h52-0-162" id="h52-0-162" class="i">+                None,
</a><a href="#h52-0-163" id="h52-0-163" class="i">+                Some(
</a><a href="#h52-0-164" id="h52-0-164" class="i">+                    &quot;rating&quot;,
</a><a href="#h52-0-165" id="h52-0-165" class="i">+                ),
</a><a href="#h52-0-166" id="h52-0-166" class="i">+            ],
</a><a href="#h52-0-167" id="h52-0-167" class="i">+            expressions: [
</a><a href="#h52-0-168" id="h52-0-168" class="i">+                Multiply(
</a><a href="#h52-0-169" id="h52-0-169" class="i">+                    Field(
</a><a href="#h52-0-170" id="h52-0-170" class="i">+                        None,
</a><a href="#h52-0-171" id="h52-0-171" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h52-0-172" id="h52-0-172" class="i">+                    ),
</a><a href="#h52-0-173" id="h52-0-173" class="i">+                    Constant(
</a><a href="#h52-0-174" id="h52-0-174" class="i">+                        Integer(
</a><a href="#h52-0-175" id="h52-0-175" class="i">+                            2,
</a><a href="#h52-0-176" id="h52-0-176" class="i">+                        ),
</a><a href="#h52-0-177" id="h52-0-177" class="i">+                    ),
</a><a href="#h52-0-178" id="h52-0-178" class="i">+                ),
</a><a href="#h52-0-179" id="h52-0-179" class="i">+                Column(
</a><a href="#h52-0-180" id="h52-0-180" class="i">+                    0,
</a><a href="#h52-0-181" id="h52-0-181" class="i">+                ),
</a><a href="#h52-0-182" id="h52-0-182" class="i">+            ],
</a><a href="#h52-0-183" id="h52-0-183" class="i">+        },
</a><a href="#h52-0-184" id="h52-0-184" class="i">+        orders: [
</a><a href="#h52-0-185" id="h52-0-185" class="i">+            (
</a><a href="#h52-0-186" id="h52-0-186" class="i">+                Field(
</a><a href="#h52-0-187" id="h52-0-187" class="i">+                    None,
</a><a href="#h52-0-188" id="h52-0-188" class="i">+                    &quot;rating&quot;,
</a><a href="#h52-0-189" id="h52-0-189" class="i">+                ),
</a><a href="#h52-0-190" id="h52-0-190" class="i">+                Ascending,
</a><a href="#h52-0-191" id="h52-0-191" class="i">+            ),
</a><a href="#h52-0-192" id="h52-0-192" class="i">+        ],
</a><a href="#h52-0-193" id="h52-0-193" class="i">+    },
</a><a href="#h52-0-194" id="h52-0-194" class="i">+}
</a><a href="#h52-0-195" id="h52-0-195" class="i">+
</a><a href="#h52-0-196" id="h52-0-196" class="i">+Query: SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id ORDER BY rating
</a><a href="#h52-0-197" id="h52-0-197" class="i">+
</a><a href="#h52-0-198" id="h52-0-198" class="i">+Result: [&quot;?&quot;, &quot;rating&quot;]
</a><a href="#h52-0-199" id="h52-0-199" class="i">+[Integer(6), Float(6.9)]
</a><a href="#h52-0-200" id="h52-0-200" class="i">+[Integer(4), Float(7.6)]
</a><a href="#h52-0-201" id="h52-0-201" class="i">+[Integer(2), Float(8.2)]
</a><a href="#h52-0-202" id="h52-0-202" class="i">+[Integer(8), Float(8.8)]
</a><b>diff --git a/<a id="h53" href="../file/src/sql/tests/query/group_join.html">src/sql/tests/query/group_join</a> b/<a href="../file/src/sql/tests/query/group_join.html">src/sql/tests/query/group_join</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -0,0 +1,274 @@
</a><a href="#h53-0-0" id="h53-0-0" class="i">+Query: SELECT s.name, COUNT(*) FROM movies m JOIN studios s ON m.studio_id = s.id GROUP BY s.name ORDER BY s.name ASC
</a><a href="#h53-0-1" id="h53-0-1" class="i">+
</a><a href="#h53-0-2" id="h53-0-2" class="i">+AST: Select {
</a><a href="#h53-0-3" id="h53-0-3" class="i">+    select: SelectClause {
</a><a href="#h53-0-4" id="h53-0-4" class="i">+        expressions: [
</a><a href="#h53-0-5" id="h53-0-5" class="i">+            Field(
</a><a href="#h53-0-6" id="h53-0-6" class="i">+                Some(
</a><a href="#h53-0-7" id="h53-0-7" class="i">+                    &quot;s&quot;,
</a><a href="#h53-0-8" id="h53-0-8" class="i">+                ),
</a><a href="#h53-0-9" id="h53-0-9" class="i">+                &quot;name&quot;,
</a><a href="#h53-0-10" id="h53-0-10" class="i">+            ),
</a><a href="#h53-0-11" id="h53-0-11" class="i">+            Function(
</a><a href="#h53-0-12" id="h53-0-12" class="i">+                &quot;count&quot;,
</a><a href="#h53-0-13" id="h53-0-13" class="i">+                [
</a><a href="#h53-0-14" id="h53-0-14" class="i">+                    Literal(
</a><a href="#h53-0-15" id="h53-0-15" class="i">+                        Boolean(
</a><a href="#h53-0-16" id="h53-0-16" class="i">+                            true,
</a><a href="#h53-0-17" id="h53-0-17" class="i">+                        ),
</a><a href="#h53-0-18" id="h53-0-18" class="i">+                    ),
</a><a href="#h53-0-19" id="h53-0-19" class="i">+                ],
</a><a href="#h53-0-20" id="h53-0-20" class="i">+            ),
</a><a href="#h53-0-21" id="h53-0-21" class="i">+        ],
</a><a href="#h53-0-22" id="h53-0-22" class="i">+        labels: [
</a><a href="#h53-0-23" id="h53-0-23" class="i">+            None,
</a><a href="#h53-0-24" id="h53-0-24" class="i">+            None,
</a><a href="#h53-0-25" id="h53-0-25" class="i">+        ],
</a><a href="#h53-0-26" id="h53-0-26" class="i">+    },
</a><a href="#h53-0-27" id="h53-0-27" class="i">+    from: Some(
</a><a href="#h53-0-28" id="h53-0-28" class="i">+        FromClause {
</a><a href="#h53-0-29" id="h53-0-29" class="i">+            items: [
</a><a href="#h53-0-30" id="h53-0-30" class="i">+                Join {
</a><a href="#h53-0-31" id="h53-0-31" class="i">+                    left: Table {
</a><a href="#h53-0-32" id="h53-0-32" class="i">+                        name: &quot;movies&quot;,
</a><a href="#h53-0-33" id="h53-0-33" class="i">+                        alias: Some(
</a><a href="#h53-0-34" id="h53-0-34" class="i">+                            &quot;m&quot;,
</a><a href="#h53-0-35" id="h53-0-35" class="i">+                        ),
</a><a href="#h53-0-36" id="h53-0-36" class="i">+                    },
</a><a href="#h53-0-37" id="h53-0-37" class="i">+                    right: Table {
</a><a href="#h53-0-38" id="h53-0-38" class="i">+                        name: &quot;studios&quot;,
</a><a href="#h53-0-39" id="h53-0-39" class="i">+                        alias: Some(
</a><a href="#h53-0-40" id="h53-0-40" class="i">+                            &quot;s&quot;,
</a><a href="#h53-0-41" id="h53-0-41" class="i">+                        ),
</a><a href="#h53-0-42" id="h53-0-42" class="i">+                    },
</a><a href="#h53-0-43" id="h53-0-43" class="i">+                    type: Inner,
</a><a href="#h53-0-44" id="h53-0-44" class="i">+                    predicate: Some(
</a><a href="#h53-0-45" id="h53-0-45" class="i">+                        Operation(
</a><a href="#h53-0-46" id="h53-0-46" class="i">+                            Equal(
</a><a href="#h53-0-47" id="h53-0-47" class="i">+                                Field(
</a><a href="#h53-0-48" id="h53-0-48" class="i">+                                    Some(
</a><a href="#h53-0-49" id="h53-0-49" class="i">+                                        &quot;m&quot;,
</a><a href="#h53-0-50" id="h53-0-50" class="i">+                                    ),
</a><a href="#h53-0-51" id="h53-0-51" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h53-0-52" id="h53-0-52" class="i">+                                ),
</a><a href="#h53-0-53" id="h53-0-53" class="i">+                                Field(
</a><a href="#h53-0-54" id="h53-0-54" class="i">+                                    Some(
</a><a href="#h53-0-55" id="h53-0-55" class="i">+                                        &quot;s&quot;,
</a><a href="#h53-0-56" id="h53-0-56" class="i">+                                    ),
</a><a href="#h53-0-57" id="h53-0-57" class="i">+                                    &quot;id&quot;,
</a><a href="#h53-0-58" id="h53-0-58" class="i">+                                ),
</a><a href="#h53-0-59" id="h53-0-59" class="i">+                            ),
</a><a href="#h53-0-60" id="h53-0-60" class="i">+                        ),
</a><a href="#h53-0-61" id="h53-0-61" class="i">+                    ),
</a><a href="#h53-0-62" id="h53-0-62" class="i">+                },
</a><a href="#h53-0-63" id="h53-0-63" class="i">+            ],
</a><a href="#h53-0-64" id="h53-0-64" class="i">+        },
</a><a href="#h53-0-65" id="h53-0-65" class="i">+    ),
</a><a href="#h53-0-66" id="h53-0-66" class="i">+    where: None,
</a><a href="#h53-0-67" id="h53-0-67" class="i">+    group_by: Some(
</a><a href="#h53-0-68" id="h53-0-68" class="i">+        GroupByClause(
</a><a href="#h53-0-69" id="h53-0-69" class="i">+            [
</a><a href="#h53-0-70" id="h53-0-70" class="i">+                Field(
</a><a href="#h53-0-71" id="h53-0-71" class="i">+                    Some(
</a><a href="#h53-0-72" id="h53-0-72" class="i">+                        &quot;s&quot;,
</a><a href="#h53-0-73" id="h53-0-73" class="i">+                    ),
</a><a href="#h53-0-74" id="h53-0-74" class="i">+                    &quot;name&quot;,
</a><a href="#h53-0-75" id="h53-0-75" class="i">+                ),
</a><a href="#h53-0-76" id="h53-0-76" class="i">+            ],
</a><a href="#h53-0-77" id="h53-0-77" class="i">+        ),
</a><a href="#h53-0-78" id="h53-0-78" class="i">+    ),
</a><a href="#h53-0-79" id="h53-0-79" class="i">+    having: None,
</a><a href="#h53-0-80" id="h53-0-80" class="i">+    order: [
</a><a href="#h53-0-81" id="h53-0-81" class="i">+        (
</a><a href="#h53-0-82" id="h53-0-82" class="i">+            Field(
</a><a href="#h53-0-83" id="h53-0-83" class="i">+                Some(
</a><a href="#h53-0-84" id="h53-0-84" class="i">+                    &quot;s&quot;,
</a><a href="#h53-0-85" id="h53-0-85" class="i">+                ),
</a><a href="#h53-0-86" id="h53-0-86" class="i">+                &quot;name&quot;,
</a><a href="#h53-0-87" id="h53-0-87" class="i">+            ),
</a><a href="#h53-0-88" id="h53-0-88" class="i">+            Ascending,
</a><a href="#h53-0-89" id="h53-0-89" class="i">+        ),
</a><a href="#h53-0-90" id="h53-0-90" class="i">+    ],
</a><a href="#h53-0-91" id="h53-0-91" class="i">+    limit: None,
</a><a href="#h53-0-92" id="h53-0-92" class="i">+    offset: None,
</a><a href="#h53-0-93" id="h53-0-93" class="i">+}
</a><a href="#h53-0-94" id="h53-0-94" class="i">+
</a><a href="#h53-0-95" id="h53-0-95" class="i">+Plan: Plan {
</a><a href="#h53-0-96" id="h53-0-96" class="i">+    root: Order {
</a><a href="#h53-0-97" id="h53-0-97" class="i">+        source: Projection {
</a><a href="#h53-0-98" id="h53-0-98" class="i">+            source: Aggregation {
</a><a href="#h53-0-99" id="h53-0-99" class="i">+                source: Projection {
</a><a href="#h53-0-100" id="h53-0-100" class="i">+                    source: NestedLoopJoin {
</a><a href="#h53-0-101" id="h53-0-101" class="i">+                        outer: Scan {
</a><a href="#h53-0-102" id="h53-0-102" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h53-0-103" id="h53-0-103" class="i">+                            alias: Some(
</a><a href="#h53-0-104" id="h53-0-104" class="i">+                                &quot;m&quot;,
</a><a href="#h53-0-105" id="h53-0-105" class="i">+                            ),
</a><a href="#h53-0-106" id="h53-0-106" class="i">+                        },
</a><a href="#h53-0-107" id="h53-0-107" class="i">+                        inner: Scan {
</a><a href="#h53-0-108" id="h53-0-108" class="i">+                            table: &quot;studios&quot;,
</a><a href="#h53-0-109" id="h53-0-109" class="i">+                            alias: Some(
</a><a href="#h53-0-110" id="h53-0-110" class="i">+                                &quot;s&quot;,
</a><a href="#h53-0-111" id="h53-0-111" class="i">+                            ),
</a><a href="#h53-0-112" id="h53-0-112" class="i">+                        },
</a><a href="#h53-0-113" id="h53-0-113" class="i">+                        predicate: Some(
</a><a href="#h53-0-114" id="h53-0-114" class="i">+                            Equal(
</a><a href="#h53-0-115" id="h53-0-115" class="i">+                                Field(
</a><a href="#h53-0-116" id="h53-0-116" class="i">+                                    Some(
</a><a href="#h53-0-117" id="h53-0-117" class="i">+                                        &quot;m&quot;,
</a><a href="#h53-0-118" id="h53-0-118" class="i">+                                    ),
</a><a href="#h53-0-119" id="h53-0-119" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h53-0-120" id="h53-0-120" class="i">+                                ),
</a><a href="#h53-0-121" id="h53-0-121" class="i">+                                Field(
</a><a href="#h53-0-122" id="h53-0-122" class="i">+                                    Some(
</a><a href="#h53-0-123" id="h53-0-123" class="i">+                                        &quot;s&quot;,
</a><a href="#h53-0-124" id="h53-0-124" class="i">+                                    ),
</a><a href="#h53-0-125" id="h53-0-125" class="i">+                                    &quot;id&quot;,
</a><a href="#h53-0-126" id="h53-0-126" class="i">+                                ),
</a><a href="#h53-0-127" id="h53-0-127" class="i">+                            ),
</a><a href="#h53-0-128" id="h53-0-128" class="i">+                        ),
</a><a href="#h53-0-129" id="h53-0-129" class="i">+                        pad: false,
</a><a href="#h53-0-130" id="h53-0-130" class="i">+                        flip: false,
</a><a href="#h53-0-131" id="h53-0-131" class="i">+                    },
</a><a href="#h53-0-132" id="h53-0-132" class="i">+                    labels: [
</a><a href="#h53-0-133" id="h53-0-133" class="i">+                        None,
</a><a href="#h53-0-134" id="h53-0-134" class="i">+                        None,
</a><a href="#h53-0-135" id="h53-0-135" class="i">+                    ],
</a><a href="#h53-0-136" id="h53-0-136" class="i">+                    expressions: [
</a><a href="#h53-0-137" id="h53-0-137" class="i">+                        Constant(
</a><a href="#h53-0-138" id="h53-0-138" class="i">+                            Boolean(
</a><a href="#h53-0-139" id="h53-0-139" class="i">+                                true,
</a><a href="#h53-0-140" id="h53-0-140" class="i">+                            ),
</a><a href="#h53-0-141" id="h53-0-141" class="i">+                        ),
</a><a href="#h53-0-142" id="h53-0-142" class="i">+                        Field(
</a><a href="#h53-0-143" id="h53-0-143" class="i">+                            Some(
</a><a href="#h53-0-144" id="h53-0-144" class="i">+                                &quot;s&quot;,
</a><a href="#h53-0-145" id="h53-0-145" class="i">+                            ),
</a><a href="#h53-0-146" id="h53-0-146" class="i">+                            &quot;name&quot;,
</a><a href="#h53-0-147" id="h53-0-147" class="i">+                        ),
</a><a href="#h53-0-148" id="h53-0-148" class="i">+                    ],
</a><a href="#h53-0-149" id="h53-0-149" class="i">+                },
</a><a href="#h53-0-150" id="h53-0-150" class="i">+                aggregates: [
</a><a href="#h53-0-151" id="h53-0-151" class="i">+                    Count,
</a><a href="#h53-0-152" id="h53-0-152" class="i">+                ],
</a><a href="#h53-0-153" id="h53-0-153" class="i">+            },
</a><a href="#h53-0-154" id="h53-0-154" class="i">+            labels: [
</a><a href="#h53-0-155" id="h53-0-155" class="i">+                None,
</a><a href="#h53-0-156" id="h53-0-156" class="i">+                None,
</a><a href="#h53-0-157" id="h53-0-157" class="i">+            ],
</a><a href="#h53-0-158" id="h53-0-158" class="i">+            expressions: [
</a><a href="#h53-0-159" id="h53-0-159" class="i">+                Column(
</a><a href="#h53-0-160" id="h53-0-160" class="i">+                    1,
</a><a href="#h53-0-161" id="h53-0-161" class="i">+                ),
</a><a href="#h53-0-162" id="h53-0-162" class="i">+                Column(
</a><a href="#h53-0-163" id="h53-0-163" class="i">+                    0,
</a><a href="#h53-0-164" id="h53-0-164" class="i">+                ),
</a><a href="#h53-0-165" id="h53-0-165" class="i">+            ],
</a><a href="#h53-0-166" id="h53-0-166" class="i">+        },
</a><a href="#h53-0-167" id="h53-0-167" class="i">+        orders: [
</a><a href="#h53-0-168" id="h53-0-168" class="i">+            (
</a><a href="#h53-0-169" id="h53-0-169" class="i">+                Field(
</a><a href="#h53-0-170" id="h53-0-170" class="i">+                    Some(
</a><a href="#h53-0-171" id="h53-0-171" class="i">+                        &quot;s&quot;,
</a><a href="#h53-0-172" id="h53-0-172" class="i">+                    ),
</a><a href="#h53-0-173" id="h53-0-173" class="i">+                    &quot;name&quot;,
</a><a href="#h53-0-174" id="h53-0-174" class="i">+                ),
</a><a href="#h53-0-175" id="h53-0-175" class="i">+                Ascending,
</a><a href="#h53-0-176" id="h53-0-176" class="i">+            ),
</a><a href="#h53-0-177" id="h53-0-177" class="i">+        ],
</a><a href="#h53-0-178" id="h53-0-178" class="i">+    },
</a><a href="#h53-0-179" id="h53-0-179" class="i">+}
</a><a href="#h53-0-180" id="h53-0-180" class="i">+
</a><a href="#h53-0-181" id="h53-0-181" class="i">+Optimized plan: Plan {
</a><a href="#h53-0-182" id="h53-0-182" class="i">+    root: Order {
</a><a href="#h53-0-183" id="h53-0-183" class="i">+        source: Projection {
</a><a href="#h53-0-184" id="h53-0-184" class="i">+            source: Aggregation {
</a><a href="#h53-0-185" id="h53-0-185" class="i">+                source: Projection {
</a><a href="#h53-0-186" id="h53-0-186" class="i">+                    source: NestedLoopJoin {
</a><a href="#h53-0-187" id="h53-0-187" class="i">+                        outer: Scan {
</a><a href="#h53-0-188" id="h53-0-188" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h53-0-189" id="h53-0-189" class="i">+                            alias: Some(
</a><a href="#h53-0-190" id="h53-0-190" class="i">+                                &quot;m&quot;,
</a><a href="#h53-0-191" id="h53-0-191" class="i">+                            ),
</a><a href="#h53-0-192" id="h53-0-192" class="i">+                        },
</a><a href="#h53-0-193" id="h53-0-193" class="i">+                        inner: Scan {
</a><a href="#h53-0-194" id="h53-0-194" class="i">+                            table: &quot;studios&quot;,
</a><a href="#h53-0-195" id="h53-0-195" class="i">+                            alias: Some(
</a><a href="#h53-0-196" id="h53-0-196" class="i">+                                &quot;s&quot;,
</a><a href="#h53-0-197" id="h53-0-197" class="i">+                            ),
</a><a href="#h53-0-198" id="h53-0-198" class="i">+                        },
</a><a href="#h53-0-199" id="h53-0-199" class="i">+                        predicate: Some(
</a><a href="#h53-0-200" id="h53-0-200" class="i">+                            Equal(
</a><a href="#h53-0-201" id="h53-0-201" class="i">+                                Field(
</a><a href="#h53-0-202" id="h53-0-202" class="i">+                                    Some(
</a><a href="#h53-0-203" id="h53-0-203" class="i">+                                        &quot;m&quot;,
</a><a href="#h53-0-204" id="h53-0-204" class="i">+                                    ),
</a><a href="#h53-0-205" id="h53-0-205" class="i">+                                    &quot;studio_id&quot;,
</a><a href="#h53-0-206" id="h53-0-206" class="i">+                                ),
</a><a href="#h53-0-207" id="h53-0-207" class="i">+                                Field(
</a><a href="#h53-0-208" id="h53-0-208" class="i">+                                    Some(
</a><a href="#h53-0-209" id="h53-0-209" class="i">+                                        &quot;s&quot;,
</a><a href="#h53-0-210" id="h53-0-210" class="i">+                                    ),
</a><a href="#h53-0-211" id="h53-0-211" class="i">+                                    &quot;id&quot;,
</a><a href="#h53-0-212" id="h53-0-212" class="i">+                                ),
</a><a href="#h53-0-213" id="h53-0-213" class="i">+                            ),
</a><a href="#h53-0-214" id="h53-0-214" class="i">+                        ),
</a><a href="#h53-0-215" id="h53-0-215" class="i">+                        pad: false,
</a><a href="#h53-0-216" id="h53-0-216" class="i">+                        flip: false,
</a><a href="#h53-0-217" id="h53-0-217" class="i">+                    },
</a><a href="#h53-0-218" id="h53-0-218" class="i">+                    labels: [
</a><a href="#h53-0-219" id="h53-0-219" class="i">+                        None,
</a><a href="#h53-0-220" id="h53-0-220" class="i">+                        None,
</a><a href="#h53-0-221" id="h53-0-221" class="i">+                    ],
</a><a href="#h53-0-222" id="h53-0-222" class="i">+                    expressions: [
</a><a href="#h53-0-223" id="h53-0-223" class="i">+                        Constant(
</a><a href="#h53-0-224" id="h53-0-224" class="i">+                            Boolean(
</a><a href="#h53-0-225" id="h53-0-225" class="i">+                                true,
</a><a href="#h53-0-226" id="h53-0-226" class="i">+                            ),
</a><a href="#h53-0-227" id="h53-0-227" class="i">+                        ),
</a><a href="#h53-0-228" id="h53-0-228" class="i">+                        Field(
</a><a href="#h53-0-229" id="h53-0-229" class="i">+                            Some(
</a><a href="#h53-0-230" id="h53-0-230" class="i">+                                &quot;s&quot;,
</a><a href="#h53-0-231" id="h53-0-231" class="i">+                            ),
</a><a href="#h53-0-232" id="h53-0-232" class="i">+                            &quot;name&quot;,
</a><a href="#h53-0-233" id="h53-0-233" class="i">+                        ),
</a><a href="#h53-0-234" id="h53-0-234" class="i">+                    ],
</a><a href="#h53-0-235" id="h53-0-235" class="i">+                },
</a><a href="#h53-0-236" id="h53-0-236" class="i">+                aggregates: [
</a><a href="#h53-0-237" id="h53-0-237" class="i">+                    Count,
</a><a href="#h53-0-238" id="h53-0-238" class="i">+                ],
</a><a href="#h53-0-239" id="h53-0-239" class="i">+            },
</a><a href="#h53-0-240" id="h53-0-240" class="i">+            labels: [
</a><a href="#h53-0-241" id="h53-0-241" class="i">+                None,
</a><a href="#h53-0-242" id="h53-0-242" class="i">+                None,
</a><a href="#h53-0-243" id="h53-0-243" class="i">+            ],
</a><a href="#h53-0-244" id="h53-0-244" class="i">+            expressions: [
</a><a href="#h53-0-245" id="h53-0-245" class="i">+                Column(
</a><a href="#h53-0-246" id="h53-0-246" class="i">+                    1,
</a><a href="#h53-0-247" id="h53-0-247" class="i">+                ),
</a><a href="#h53-0-248" id="h53-0-248" class="i">+                Column(
</a><a href="#h53-0-249" id="h53-0-249" class="i">+                    0,
</a><a href="#h53-0-250" id="h53-0-250" class="i">+                ),
</a><a href="#h53-0-251" id="h53-0-251" class="i">+            ],
</a><a href="#h53-0-252" id="h53-0-252" class="i">+        },
</a><a href="#h53-0-253" id="h53-0-253" class="i">+        orders: [
</a><a href="#h53-0-254" id="h53-0-254" class="i">+            (
</a><a href="#h53-0-255" id="h53-0-255" class="i">+                Field(
</a><a href="#h53-0-256" id="h53-0-256" class="i">+                    Some(
</a><a href="#h53-0-257" id="h53-0-257" class="i">+                        &quot;s&quot;,
</a><a href="#h53-0-258" id="h53-0-258" class="i">+                    ),
</a><a href="#h53-0-259" id="h53-0-259" class="i">+                    &quot;name&quot;,
</a><a href="#h53-0-260" id="h53-0-260" class="i">+                ),
</a><a href="#h53-0-261" id="h53-0-261" class="i">+                Ascending,
</a><a href="#h53-0-262" id="h53-0-262" class="i">+            ),
</a><a href="#h53-0-263" id="h53-0-263" class="i">+        ],
</a><a href="#h53-0-264" id="h53-0-264" class="i">+    },
</a><a href="#h53-0-265" id="h53-0-265" class="i">+}
</a><a href="#h53-0-266" id="h53-0-266" class="i">+
</a><a href="#h53-0-267" id="h53-0-267" class="i">+Query: SELECT s.name, COUNT(*) FROM movies m JOIN studios s ON m.studio_id = s.id GROUP BY s.name ORDER BY s.name ASC
</a><a href="#h53-0-268" id="h53-0-268" class="i">+
</a><a href="#h53-0-269" id="h53-0-269" class="i">+Result: [&quot;name&quot;, &quot;?&quot;]
</a><a href="#h53-0-270" id="h53-0-270" class="i">+[String(&quot;Lionsgate&quot;), Integer(2)]
</a><a href="#h53-0-271" id="h53-0-271" class="i">+[String(&quot;Mosfilm&quot;), Integer(2)]
</a><a href="#h53-0-272" id="h53-0-272" class="i">+[String(&quot;StudioCanal&quot;), Integer(1)]
</a><a href="#h53-0-273" id="h53-0-273" class="i">+[String(&quot;Warner Bros&quot;), Integer(5)]
</a><b>diff --git a/<a id="h54" href="../file/src/sql/tests/query/group_noaggregate.html">src/sql/tests/query/group_noaggregate</a> b/<a href="../file/src/sql/tests/query/group_noaggregate.html">src/sql/tests/query/group_noaggregate</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -0,0 +1,142 @@
</a><a href="#h54-0-0" id="h54-0-0" class="i">+Query: SELECT title FROM movies GROUP BY title ORDER BY title ASC
</a><a href="#h54-0-1" id="h54-0-1" class="i">+
</a><a href="#h54-0-2" id="h54-0-2" class="i">+AST: Select {
</a><a href="#h54-0-3" id="h54-0-3" class="i">+    select: SelectClause {
</a><a href="#h54-0-4" id="h54-0-4" class="i">+        expressions: [
</a><a href="#h54-0-5" id="h54-0-5" class="i">+            Field(
</a><a href="#h54-0-6" id="h54-0-6" class="i">+                None,
</a><a href="#h54-0-7" id="h54-0-7" class="i">+                &quot;title&quot;,
</a><a href="#h54-0-8" id="h54-0-8" class="i">+            ),
</a><a href="#h54-0-9" id="h54-0-9" class="i">+        ],
</a><a href="#h54-0-10" id="h54-0-10" class="i">+        labels: [
</a><a href="#h54-0-11" id="h54-0-11" class="i">+            None,
</a><a href="#h54-0-12" id="h54-0-12" class="i">+        ],
</a><a href="#h54-0-13" id="h54-0-13" class="i">+    },
</a><a href="#h54-0-14" id="h54-0-14" class="i">+    from: Some(
</a><a href="#h54-0-15" id="h54-0-15" class="i">+        FromClause {
</a><a href="#h54-0-16" id="h54-0-16" class="i">+            items: [
</a><a href="#h54-0-17" id="h54-0-17" class="i">+                Table {
</a><a href="#h54-0-18" id="h54-0-18" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h54-0-19" id="h54-0-19" class="i">+                    alias: None,
</a><a href="#h54-0-20" id="h54-0-20" class="i">+                },
</a><a href="#h54-0-21" id="h54-0-21" class="i">+            ],
</a><a href="#h54-0-22" id="h54-0-22" class="i">+        },
</a><a href="#h54-0-23" id="h54-0-23" class="i">+    ),
</a><a href="#h54-0-24" id="h54-0-24" class="i">+    where: None,
</a><a href="#h54-0-25" id="h54-0-25" class="i">+    group_by: Some(
</a><a href="#h54-0-26" id="h54-0-26" class="i">+        GroupByClause(
</a><a href="#h54-0-27" id="h54-0-27" class="i">+            [
</a><a href="#h54-0-28" id="h54-0-28" class="i">+                Field(
</a><a href="#h54-0-29" id="h54-0-29" class="i">+                    None,
</a><a href="#h54-0-30" id="h54-0-30" class="i">+                    &quot;title&quot;,
</a><a href="#h54-0-31" id="h54-0-31" class="i">+                ),
</a><a href="#h54-0-32" id="h54-0-32" class="i">+            ],
</a><a href="#h54-0-33" id="h54-0-33" class="i">+        ),
</a><a href="#h54-0-34" id="h54-0-34" class="i">+    ),
</a><a href="#h54-0-35" id="h54-0-35" class="i">+    having: None,
</a><a href="#h54-0-36" id="h54-0-36" class="i">+    order: [
</a><a href="#h54-0-37" id="h54-0-37" class="i">+        (
</a><a href="#h54-0-38" id="h54-0-38" class="i">+            Field(
</a><a href="#h54-0-39" id="h54-0-39" class="i">+                None,
</a><a href="#h54-0-40" id="h54-0-40" class="i">+                &quot;title&quot;,
</a><a href="#h54-0-41" id="h54-0-41" class="i">+            ),
</a><a href="#h54-0-42" id="h54-0-42" class="i">+            Ascending,
</a><a href="#h54-0-43" id="h54-0-43" class="i">+        ),
</a><a href="#h54-0-44" id="h54-0-44" class="i">+    ],
</a><a href="#h54-0-45" id="h54-0-45" class="i">+    limit: None,
</a><a href="#h54-0-46" id="h54-0-46" class="i">+    offset: None,
</a><a href="#h54-0-47" id="h54-0-47" class="i">+}
</a><a href="#h54-0-48" id="h54-0-48" class="i">+
</a><a href="#h54-0-49" id="h54-0-49" class="i">+Plan: Plan {
</a><a href="#h54-0-50" id="h54-0-50" class="i">+    root: Order {
</a><a href="#h54-0-51" id="h54-0-51" class="i">+        source: Projection {
</a><a href="#h54-0-52" id="h54-0-52" class="i">+            source: Projection {
</a><a href="#h54-0-53" id="h54-0-53" class="i">+                source: Scan {
</a><a href="#h54-0-54" id="h54-0-54" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h54-0-55" id="h54-0-55" class="i">+                    alias: None,
</a><a href="#h54-0-56" id="h54-0-56" class="i">+                },
</a><a href="#h54-0-57" id="h54-0-57" class="i">+                labels: [
</a><a href="#h54-0-58" id="h54-0-58" class="i">+                    None,
</a><a href="#h54-0-59" id="h54-0-59" class="i">+                ],
</a><a href="#h54-0-60" id="h54-0-60" class="i">+                expressions: [
</a><a href="#h54-0-61" id="h54-0-61" class="i">+                    Field(
</a><a href="#h54-0-62" id="h54-0-62" class="i">+                        None,
</a><a href="#h54-0-63" id="h54-0-63" class="i">+                        &quot;title&quot;,
</a><a href="#h54-0-64" id="h54-0-64" class="i">+                    ),
</a><a href="#h54-0-65" id="h54-0-65" class="i">+                ],
</a><a href="#h54-0-66" id="h54-0-66" class="i">+            },
</a><a href="#h54-0-67" id="h54-0-67" class="i">+            labels: [
</a><a href="#h54-0-68" id="h54-0-68" class="i">+                None,
</a><a href="#h54-0-69" id="h54-0-69" class="i">+            ],
</a><a href="#h54-0-70" id="h54-0-70" class="i">+            expressions: [
</a><a href="#h54-0-71" id="h54-0-71" class="i">+                Field(
</a><a href="#h54-0-72" id="h54-0-72" class="i">+                    None,
</a><a href="#h54-0-73" id="h54-0-73" class="i">+                    &quot;title&quot;,
</a><a href="#h54-0-74" id="h54-0-74" class="i">+                ),
</a><a href="#h54-0-75" id="h54-0-75" class="i">+            ],
</a><a href="#h54-0-76" id="h54-0-76" class="i">+        },
</a><a href="#h54-0-77" id="h54-0-77" class="i">+        orders: [
</a><a href="#h54-0-78" id="h54-0-78" class="i">+            (
</a><a href="#h54-0-79" id="h54-0-79" class="i">+                Field(
</a><a href="#h54-0-80" id="h54-0-80" class="i">+                    None,
</a><a href="#h54-0-81" id="h54-0-81" class="i">+                    &quot;title&quot;,
</a><a href="#h54-0-82" id="h54-0-82" class="i">+                ),
</a><a href="#h54-0-83" id="h54-0-83" class="i">+                Ascending,
</a><a href="#h54-0-84" id="h54-0-84" class="i">+            ),
</a><a href="#h54-0-85" id="h54-0-85" class="i">+        ],
</a><a href="#h54-0-86" id="h54-0-86" class="i">+    },
</a><a href="#h54-0-87" id="h54-0-87" class="i">+}
</a><a href="#h54-0-88" id="h54-0-88" class="i">+
</a><a href="#h54-0-89" id="h54-0-89" class="i">+Optimized plan: Plan {
</a><a href="#h54-0-90" id="h54-0-90" class="i">+    root: Order {
</a><a href="#h54-0-91" id="h54-0-91" class="i">+        source: Projection {
</a><a href="#h54-0-92" id="h54-0-92" class="i">+            source: Projection {
</a><a href="#h54-0-93" id="h54-0-93" class="i">+                source: Scan {
</a><a href="#h54-0-94" id="h54-0-94" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h54-0-95" id="h54-0-95" class="i">+                    alias: None,
</a><a href="#h54-0-96" id="h54-0-96" class="i">+                },
</a><a href="#h54-0-97" id="h54-0-97" class="i">+                labels: [
</a><a href="#h54-0-98" id="h54-0-98" class="i">+                    None,
</a><a href="#h54-0-99" id="h54-0-99" class="i">+                ],
</a><a href="#h54-0-100" id="h54-0-100" class="i">+                expressions: [
</a><a href="#h54-0-101" id="h54-0-101" class="i">+                    Field(
</a><a href="#h54-0-102" id="h54-0-102" class="i">+                        None,
</a><a href="#h54-0-103" id="h54-0-103" class="i">+                        &quot;title&quot;,
</a><a href="#h54-0-104" id="h54-0-104" class="i">+                    ),
</a><a href="#h54-0-105" id="h54-0-105" class="i">+                ],
</a><a href="#h54-0-106" id="h54-0-106" class="i">+            },
</a><a href="#h54-0-107" id="h54-0-107" class="i">+            labels: [
</a><a href="#h54-0-108" id="h54-0-108" class="i">+                None,
</a><a href="#h54-0-109" id="h54-0-109" class="i">+            ],
</a><a href="#h54-0-110" id="h54-0-110" class="i">+            expressions: [
</a><a href="#h54-0-111" id="h54-0-111" class="i">+                Field(
</a><a href="#h54-0-112" id="h54-0-112" class="i">+                    None,
</a><a href="#h54-0-113" id="h54-0-113" class="i">+                    &quot;title&quot;,
</a><a href="#h54-0-114" id="h54-0-114" class="i">+                ),
</a><a href="#h54-0-115" id="h54-0-115" class="i">+            ],
</a><a href="#h54-0-116" id="h54-0-116" class="i">+        },
</a><a href="#h54-0-117" id="h54-0-117" class="i">+        orders: [
</a><a href="#h54-0-118" id="h54-0-118" class="i">+            (
</a><a href="#h54-0-119" id="h54-0-119" class="i">+                Field(
</a><a href="#h54-0-120" id="h54-0-120" class="i">+                    None,
</a><a href="#h54-0-121" id="h54-0-121" class="i">+                    &quot;title&quot;,
</a><a href="#h54-0-122" id="h54-0-122" class="i">+                ),
</a><a href="#h54-0-123" id="h54-0-123" class="i">+                Ascending,
</a><a href="#h54-0-124" id="h54-0-124" class="i">+            ),
</a><a href="#h54-0-125" id="h54-0-125" class="i">+        ],
</a><a href="#h54-0-126" id="h54-0-126" class="i">+    },
</a><a href="#h54-0-127" id="h54-0-127" class="i">+}
</a><a href="#h54-0-128" id="h54-0-128" class="i">+
</a><a href="#h54-0-129" id="h54-0-129" class="i">+Query: SELECT title FROM movies GROUP BY title ORDER BY title ASC
</a><a href="#h54-0-130" id="h54-0-130" class="i">+
</a><a href="#h54-0-131" id="h54-0-131" class="i">+Result: [&quot;title&quot;]
</a><a href="#h54-0-132" id="h54-0-132" class="i">+[String(&quot;Birdman&quot;)]
</a><a href="#h54-0-133" id="h54-0-133" class="i">+[String(&quot;Blindspotting&quot;)]
</a><a href="#h54-0-134" id="h54-0-134" class="i">+[String(&quot;Gravity&quot;)]
</a><a href="#h54-0-135" id="h54-0-135" class="i">+[String(&quot;Heat&quot;)]
</a><a href="#h54-0-136" id="h54-0-136" class="i">+[String(&quot;Inception&quot;)]
</a><a href="#h54-0-137" id="h54-0-137" class="i">+[String(&quot;Primer&quot;)]
</a><a href="#h54-0-138" id="h54-0-138" class="i">+[String(&quot;Sicario&quot;)]
</a><a href="#h54-0-139" id="h54-0-139" class="i">+[String(&quot;Solaris&quot;)]
</a><a href="#h54-0-140" id="h54-0-140" class="i">+[String(&quot;Stalker&quot;)]
</a><a href="#h54-0-141" id="h54-0-141" class="i">+[String(&quot;The Fountain&quot;)]
</a><b>diff --git a/<a id="h55" href="../file/src/sql/tests/query/group_noselect.html">src/sql/tests/query/group_noselect</a> b/<a href="../file/src/sql/tests/query/group_noselect.html">src/sql/tests/query/group_noselect</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -0,0 +1,165 @@
</a><a href="#h55-0-0" id="h55-0-0" class="i">+Query: SELECT MAX(rating) AS best FROM movies GROUP BY studio_id ORDER BY best DESC
</a><a href="#h55-0-1" id="h55-0-1" class="i">+
</a><a href="#h55-0-2" id="h55-0-2" class="i">+AST: Select {
</a><a href="#h55-0-3" id="h55-0-3" class="i">+    select: SelectClause {
</a><a href="#h55-0-4" id="h55-0-4" class="i">+        expressions: [
</a><a href="#h55-0-5" id="h55-0-5" class="i">+            Function(
</a><a href="#h55-0-6" id="h55-0-6" class="i">+                &quot;max&quot;,
</a><a href="#h55-0-7" id="h55-0-7" class="i">+                [
</a><a href="#h55-0-8" id="h55-0-8" class="i">+                    Field(
</a><a href="#h55-0-9" id="h55-0-9" class="i">+                        None,
</a><a href="#h55-0-10" id="h55-0-10" class="i">+                        &quot;rating&quot;,
</a><a href="#h55-0-11" id="h55-0-11" class="i">+                    ),
</a><a href="#h55-0-12" id="h55-0-12" class="i">+                ],
</a><a href="#h55-0-13" id="h55-0-13" class="i">+            ),
</a><a href="#h55-0-14" id="h55-0-14" class="i">+        ],
</a><a href="#h55-0-15" id="h55-0-15" class="i">+        labels: [
</a><a href="#h55-0-16" id="h55-0-16" class="i">+            Some(
</a><a href="#h55-0-17" id="h55-0-17" class="i">+                &quot;best&quot;,
</a><a href="#h55-0-18" id="h55-0-18" class="i">+            ),
</a><a href="#h55-0-19" id="h55-0-19" class="i">+        ],
</a><a href="#h55-0-20" id="h55-0-20" class="i">+    },
</a><a href="#h55-0-21" id="h55-0-21" class="i">+    from: Some(
</a><a href="#h55-0-22" id="h55-0-22" class="i">+        FromClause {
</a><a href="#h55-0-23" id="h55-0-23" class="i">+            items: [
</a><a href="#h55-0-24" id="h55-0-24" class="i">+                Table {
</a><a href="#h55-0-25" id="h55-0-25" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h55-0-26" id="h55-0-26" class="i">+                    alias: None,
</a><a href="#h55-0-27" id="h55-0-27" class="i">+                },
</a><a href="#h55-0-28" id="h55-0-28" class="i">+            ],
</a><a href="#h55-0-29" id="h55-0-29" class="i">+        },
</a><a href="#h55-0-30" id="h55-0-30" class="i">+    ),
</a><a href="#h55-0-31" id="h55-0-31" class="i">+    where: None,
</a><a href="#h55-0-32" id="h55-0-32" class="i">+    group_by: Some(
</a><a href="#h55-0-33" id="h55-0-33" class="i">+        GroupByClause(
</a><a href="#h55-0-34" id="h55-0-34" class="i">+            [
</a><a href="#h55-0-35" id="h55-0-35" class="i">+                Field(
</a><a href="#h55-0-36" id="h55-0-36" class="i">+                    None,
</a><a href="#h55-0-37" id="h55-0-37" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h55-0-38" id="h55-0-38" class="i">+                ),
</a><a href="#h55-0-39" id="h55-0-39" class="i">+            ],
</a><a href="#h55-0-40" id="h55-0-40" class="i">+        ),
</a><a href="#h55-0-41" id="h55-0-41" class="i">+    ),
</a><a href="#h55-0-42" id="h55-0-42" class="i">+    having: None,
</a><a href="#h55-0-43" id="h55-0-43" class="i">+    order: [
</a><a href="#h55-0-44" id="h55-0-44" class="i">+        (
</a><a href="#h55-0-45" id="h55-0-45" class="i">+            Field(
</a><a href="#h55-0-46" id="h55-0-46" class="i">+                None,
</a><a href="#h55-0-47" id="h55-0-47" class="i">+                &quot;best&quot;,
</a><a href="#h55-0-48" id="h55-0-48" class="i">+            ),
</a><a href="#h55-0-49" id="h55-0-49" class="i">+            Descending,
</a><a href="#h55-0-50" id="h55-0-50" class="i">+        ),
</a><a href="#h55-0-51" id="h55-0-51" class="i">+    ],
</a><a href="#h55-0-52" id="h55-0-52" class="i">+    limit: None,
</a><a href="#h55-0-53" id="h55-0-53" class="i">+    offset: None,
</a><a href="#h55-0-54" id="h55-0-54" class="i">+}
</a><a href="#h55-0-55" id="h55-0-55" class="i">+
</a><a href="#h55-0-56" id="h55-0-56" class="i">+Plan: Plan {
</a><a href="#h55-0-57" id="h55-0-57" class="i">+    root: Order {
</a><a href="#h55-0-58" id="h55-0-58" class="i">+        source: Projection {
</a><a href="#h55-0-59" id="h55-0-59" class="i">+            source: Aggregation {
</a><a href="#h55-0-60" id="h55-0-60" class="i">+                source: Projection {
</a><a href="#h55-0-61" id="h55-0-61" class="i">+                    source: Scan {
</a><a href="#h55-0-62" id="h55-0-62" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h55-0-63" id="h55-0-63" class="i">+                        alias: None,
</a><a href="#h55-0-64" id="h55-0-64" class="i">+                    },
</a><a href="#h55-0-65" id="h55-0-65" class="i">+                    labels: [
</a><a href="#h55-0-66" id="h55-0-66" class="i">+                        None,
</a><a href="#h55-0-67" id="h55-0-67" class="i">+                        None,
</a><a href="#h55-0-68" id="h55-0-68" class="i">+                    ],
</a><a href="#h55-0-69" id="h55-0-69" class="i">+                    expressions: [
</a><a href="#h55-0-70" id="h55-0-70" class="i">+                        Field(
</a><a href="#h55-0-71" id="h55-0-71" class="i">+                            None,
</a><a href="#h55-0-72" id="h55-0-72" class="i">+                            &quot;rating&quot;,
</a><a href="#h55-0-73" id="h55-0-73" class="i">+                        ),
</a><a href="#h55-0-74" id="h55-0-74" class="i">+                        Field(
</a><a href="#h55-0-75" id="h55-0-75" class="i">+                            None,
</a><a href="#h55-0-76" id="h55-0-76" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h55-0-77" id="h55-0-77" class="i">+                        ),
</a><a href="#h55-0-78" id="h55-0-78" class="i">+                    ],
</a><a href="#h55-0-79" id="h55-0-79" class="i">+                },
</a><a href="#h55-0-80" id="h55-0-80" class="i">+                aggregates: [
</a><a href="#h55-0-81" id="h55-0-81" class="i">+                    Max,
</a><a href="#h55-0-82" id="h55-0-82" class="i">+                ],
</a><a href="#h55-0-83" id="h55-0-83" class="i">+            },
</a><a href="#h55-0-84" id="h55-0-84" class="i">+            labels: [
</a><a href="#h55-0-85" id="h55-0-85" class="i">+                Some(
</a><a href="#h55-0-86" id="h55-0-86" class="i">+                    &quot;best&quot;,
</a><a href="#h55-0-87" id="h55-0-87" class="i">+                ),
</a><a href="#h55-0-88" id="h55-0-88" class="i">+            ],
</a><a href="#h55-0-89" id="h55-0-89" class="i">+            expressions: [
</a><a href="#h55-0-90" id="h55-0-90" class="i">+                Column(
</a><a href="#h55-0-91" id="h55-0-91" class="i">+                    0,
</a><a href="#h55-0-92" id="h55-0-92" class="i">+                ),
</a><a href="#h55-0-93" id="h55-0-93" class="i">+            ],
</a><a href="#h55-0-94" id="h55-0-94" class="i">+        },
</a><a href="#h55-0-95" id="h55-0-95" class="i">+        orders: [
</a><a href="#h55-0-96" id="h55-0-96" class="i">+            (
</a><a href="#h55-0-97" id="h55-0-97" class="i">+                Field(
</a><a href="#h55-0-98" id="h55-0-98" class="i">+                    None,
</a><a href="#h55-0-99" id="h55-0-99" class="i">+                    &quot;best&quot;,
</a><a href="#h55-0-100" id="h55-0-100" class="i">+                ),
</a><a href="#h55-0-101" id="h55-0-101" class="i">+                Descending,
</a><a href="#h55-0-102" id="h55-0-102" class="i">+            ),
</a><a href="#h55-0-103" id="h55-0-103" class="i">+        ],
</a><a href="#h55-0-104" id="h55-0-104" class="i">+    },
</a><a href="#h55-0-105" id="h55-0-105" class="i">+}
</a><a href="#h55-0-106" id="h55-0-106" class="i">+
</a><a href="#h55-0-107" id="h55-0-107" class="i">+Optimized plan: Plan {
</a><a href="#h55-0-108" id="h55-0-108" class="i">+    root: Order {
</a><a href="#h55-0-109" id="h55-0-109" class="i">+        source: Projection {
</a><a href="#h55-0-110" id="h55-0-110" class="i">+            source: Aggregation {
</a><a href="#h55-0-111" id="h55-0-111" class="i">+                source: Projection {
</a><a href="#h55-0-112" id="h55-0-112" class="i">+                    source: Scan {
</a><a href="#h55-0-113" id="h55-0-113" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h55-0-114" id="h55-0-114" class="i">+                        alias: None,
</a><a href="#h55-0-115" id="h55-0-115" class="i">+                    },
</a><a href="#h55-0-116" id="h55-0-116" class="i">+                    labels: [
</a><a href="#h55-0-117" id="h55-0-117" class="i">+                        None,
</a><a href="#h55-0-118" id="h55-0-118" class="i">+                        None,
</a><a href="#h55-0-119" id="h55-0-119" class="i">+                    ],
</a><a href="#h55-0-120" id="h55-0-120" class="i">+                    expressions: [
</a><a href="#h55-0-121" id="h55-0-121" class="i">+                        Field(
</a><a href="#h55-0-122" id="h55-0-122" class="i">+                            None,
</a><a href="#h55-0-123" id="h55-0-123" class="i">+                            &quot;rating&quot;,
</a><a href="#h55-0-124" id="h55-0-124" class="i">+                        ),
</a><a href="#h55-0-125" id="h55-0-125" class="i">+                        Field(
</a><a href="#h55-0-126" id="h55-0-126" class="i">+                            None,
</a><a href="#h55-0-127" id="h55-0-127" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h55-0-128" id="h55-0-128" class="i">+                        ),
</a><a href="#h55-0-129" id="h55-0-129" class="i">+                    ],
</a><a href="#h55-0-130" id="h55-0-130" class="i">+                },
</a><a href="#h55-0-131" id="h55-0-131" class="i">+                aggregates: [
</a><a href="#h55-0-132" id="h55-0-132" class="i">+                    Max,
</a><a href="#h55-0-133" id="h55-0-133" class="i">+                ],
</a><a href="#h55-0-134" id="h55-0-134" class="i">+            },
</a><a href="#h55-0-135" id="h55-0-135" class="i">+            labels: [
</a><a href="#h55-0-136" id="h55-0-136" class="i">+                Some(
</a><a href="#h55-0-137" id="h55-0-137" class="i">+                    &quot;best&quot;,
</a><a href="#h55-0-138" id="h55-0-138" class="i">+                ),
</a><a href="#h55-0-139" id="h55-0-139" class="i">+            ],
</a><a href="#h55-0-140" id="h55-0-140" class="i">+            expressions: [
</a><a href="#h55-0-141" id="h55-0-141" class="i">+                Column(
</a><a href="#h55-0-142" id="h55-0-142" class="i">+                    0,
</a><a href="#h55-0-143" id="h55-0-143" class="i">+                ),
</a><a href="#h55-0-144" id="h55-0-144" class="i">+            ],
</a><a href="#h55-0-145" id="h55-0-145" class="i">+        },
</a><a href="#h55-0-146" id="h55-0-146" class="i">+        orders: [
</a><a href="#h55-0-147" id="h55-0-147" class="i">+            (
</a><a href="#h55-0-148" id="h55-0-148" class="i">+                Field(
</a><a href="#h55-0-149" id="h55-0-149" class="i">+                    None,
</a><a href="#h55-0-150" id="h55-0-150" class="i">+                    &quot;best&quot;,
</a><a href="#h55-0-151" id="h55-0-151" class="i">+                ),
</a><a href="#h55-0-152" id="h55-0-152" class="i">+                Descending,
</a><a href="#h55-0-153" id="h55-0-153" class="i">+            ),
</a><a href="#h55-0-154" id="h55-0-154" class="i">+        ],
</a><a href="#h55-0-155" id="h55-0-155" class="i">+    },
</a><a href="#h55-0-156" id="h55-0-156" class="i">+}
</a><a href="#h55-0-157" id="h55-0-157" class="i">+
</a><a href="#h55-0-158" id="h55-0-158" class="i">+Query: SELECT MAX(rating) AS best FROM movies GROUP BY studio_id ORDER BY best DESC
</a><a href="#h55-0-159" id="h55-0-159" class="i">+
</a><a href="#h55-0-160" id="h55-0-160" class="i">+Result: [&quot;best&quot;]
</a><a href="#h55-0-161" id="h55-0-161" class="i">+[Float(8.8)]
</a><a href="#h55-0-162" id="h55-0-162" class="i">+[Float(8.2)]
</a><a href="#h55-0-163" id="h55-0-163" class="i">+[Float(7.6)]
</a><a href="#h55-0-164" id="h55-0-164" class="i">+[Float(6.9)]
</a><b>diff --git a/<a id="h56" href="../file/src/sql/tests/query/group_order_agg.html">src/sql/tests/query/group_order_agg</a> b/<a href="../file/src/sql/tests/query/group_order_agg.html">src/sql/tests/query/group_order_agg</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -0,0 +1,65 @@
</a><a href="#h56-0-0" id="h56-0-0" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX(rating)
</a><a href="#h56-0-1" id="h56-0-1" class="i">+
</a><a href="#h56-0-2" id="h56-0-2" class="i">+AST: Select {
</a><a href="#h56-0-3" id="h56-0-3" class="i">+    select: SelectClause {
</a><a href="#h56-0-4" id="h56-0-4" class="i">+        expressions: [
</a><a href="#h56-0-5" id="h56-0-5" class="i">+            Field(
</a><a href="#h56-0-6" id="h56-0-6" class="i">+                None,
</a><a href="#h56-0-7" id="h56-0-7" class="i">+                &quot;studio_id&quot;,
</a><a href="#h56-0-8" id="h56-0-8" class="i">+            ),
</a><a href="#h56-0-9" id="h56-0-9" class="i">+            Function(
</a><a href="#h56-0-10" id="h56-0-10" class="i">+                &quot;max&quot;,
</a><a href="#h56-0-11" id="h56-0-11" class="i">+                [
</a><a href="#h56-0-12" id="h56-0-12" class="i">+                    Field(
</a><a href="#h56-0-13" id="h56-0-13" class="i">+                        None,
</a><a href="#h56-0-14" id="h56-0-14" class="i">+                        &quot;rating&quot;,
</a><a href="#h56-0-15" id="h56-0-15" class="i">+                    ),
</a><a href="#h56-0-16" id="h56-0-16" class="i">+                ],
</a><a href="#h56-0-17" id="h56-0-17" class="i">+            ),
</a><a href="#h56-0-18" id="h56-0-18" class="i">+        ],
</a><a href="#h56-0-19" id="h56-0-19" class="i">+        labels: [
</a><a href="#h56-0-20" id="h56-0-20" class="i">+            None,
</a><a href="#h56-0-21" id="h56-0-21" class="i">+            None,
</a><a href="#h56-0-22" id="h56-0-22" class="i">+        ],
</a><a href="#h56-0-23" id="h56-0-23" class="i">+    },
</a><a href="#h56-0-24" id="h56-0-24" class="i">+    from: Some(
</a><a href="#h56-0-25" id="h56-0-25" class="i">+        FromClause {
</a><a href="#h56-0-26" id="h56-0-26" class="i">+            items: [
</a><a href="#h56-0-27" id="h56-0-27" class="i">+                Table {
</a><a href="#h56-0-28" id="h56-0-28" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h56-0-29" id="h56-0-29" class="i">+                    alias: None,
</a><a href="#h56-0-30" id="h56-0-30" class="i">+                },
</a><a href="#h56-0-31" id="h56-0-31" class="i">+            ],
</a><a href="#h56-0-32" id="h56-0-32" class="i">+        },
</a><a href="#h56-0-33" id="h56-0-33" class="i">+    ),
</a><a href="#h56-0-34" id="h56-0-34" class="i">+    where: None,
</a><a href="#h56-0-35" id="h56-0-35" class="i">+    group_by: Some(
</a><a href="#h56-0-36" id="h56-0-36" class="i">+        GroupByClause(
</a><a href="#h56-0-37" id="h56-0-37" class="i">+            [
</a><a href="#h56-0-38" id="h56-0-38" class="i">+                Field(
</a><a href="#h56-0-39" id="h56-0-39" class="i">+                    None,
</a><a href="#h56-0-40" id="h56-0-40" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h56-0-41" id="h56-0-41" class="i">+                ),
</a><a href="#h56-0-42" id="h56-0-42" class="i">+            ],
</a><a href="#h56-0-43" id="h56-0-43" class="i">+        ),
</a><a href="#h56-0-44" id="h56-0-44" class="i">+    ),
</a><a href="#h56-0-45" id="h56-0-45" class="i">+    having: None,
</a><a href="#h56-0-46" id="h56-0-46" class="i">+    order: [
</a><a href="#h56-0-47" id="h56-0-47" class="i">+        (
</a><a href="#h56-0-48" id="h56-0-48" class="i">+            Function(
</a><a href="#h56-0-49" id="h56-0-49" class="i">+                &quot;max&quot;,
</a><a href="#h56-0-50" id="h56-0-50" class="i">+                [
</a><a href="#h56-0-51" id="h56-0-51" class="i">+                    Field(
</a><a href="#h56-0-52" id="h56-0-52" class="i">+                        None,
</a><a href="#h56-0-53" id="h56-0-53" class="i">+                        &quot;rating&quot;,
</a><a href="#h56-0-54" id="h56-0-54" class="i">+                    ),
</a><a href="#h56-0-55" id="h56-0-55" class="i">+                ],
</a><a href="#h56-0-56" id="h56-0-56" class="i">+            ),
</a><a href="#h56-0-57" id="h56-0-57" class="i">+            Ascending,
</a><a href="#h56-0-58" id="h56-0-58" class="i">+        ),
</a><a href="#h56-0-59" id="h56-0-59" class="i">+    ],
</a><a href="#h56-0-60" id="h56-0-60" class="i">+    limit: None,
</a><a href="#h56-0-61" id="h56-0-61" class="i">+    offset: None,
</a><a href="#h56-0-62" id="h56-0-62" class="i">+}
</a><a href="#h56-0-63" id="h56-0-63" class="i">+
</a><a href="#h56-0-64" id="h56-0-64" class="i">+Plan: Value(&quot;Aggregate function MAX() not allowed here&quot;)
</a><a href="#h56-0-65" id="h56-0-65" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h57" href="../file/src/sql/tests/query/group_simple.html">src/sql/tests/query/group_simple</a> b/<a href="../file/src/sql/tests/query/group_simple.html">src/sql/tests/query/group_simple</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -0,0 +1,174 @@
</a><a href="#h57-0-0" id="h57-0-0" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h57-0-1" id="h57-0-1" class="i">+
</a><a href="#h57-0-2" id="h57-0-2" class="i">+AST: Select {
</a><a href="#h57-0-3" id="h57-0-3" class="i">+    select: SelectClause {
</a><a href="#h57-0-4" id="h57-0-4" class="i">+        expressions: [
</a><a href="#h57-0-5" id="h57-0-5" class="i">+            Field(
</a><a href="#h57-0-6" id="h57-0-6" class="i">+                None,
</a><a href="#h57-0-7" id="h57-0-7" class="i">+                &quot;studio_id&quot;,
</a><a href="#h57-0-8" id="h57-0-8" class="i">+            ),
</a><a href="#h57-0-9" id="h57-0-9" class="i">+            Function(
</a><a href="#h57-0-10" id="h57-0-10" class="i">+                &quot;max&quot;,
</a><a href="#h57-0-11" id="h57-0-11" class="i">+                [
</a><a href="#h57-0-12" id="h57-0-12" class="i">+                    Field(
</a><a href="#h57-0-13" id="h57-0-13" class="i">+                        None,
</a><a href="#h57-0-14" id="h57-0-14" class="i">+                        &quot;rating&quot;,
</a><a href="#h57-0-15" id="h57-0-15" class="i">+                    ),
</a><a href="#h57-0-16" id="h57-0-16" class="i">+                ],
</a><a href="#h57-0-17" id="h57-0-17" class="i">+            ),
</a><a href="#h57-0-18" id="h57-0-18" class="i">+        ],
</a><a href="#h57-0-19" id="h57-0-19" class="i">+        labels: [
</a><a href="#h57-0-20" id="h57-0-20" class="i">+            None,
</a><a href="#h57-0-21" id="h57-0-21" class="i">+            None,
</a><a href="#h57-0-22" id="h57-0-22" class="i">+        ],
</a><a href="#h57-0-23" id="h57-0-23" class="i">+    },
</a><a href="#h57-0-24" id="h57-0-24" class="i">+    from: Some(
</a><a href="#h57-0-25" id="h57-0-25" class="i">+        FromClause {
</a><a href="#h57-0-26" id="h57-0-26" class="i">+            items: [
</a><a href="#h57-0-27" id="h57-0-27" class="i">+                Table {
</a><a href="#h57-0-28" id="h57-0-28" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h57-0-29" id="h57-0-29" class="i">+                    alias: None,
</a><a href="#h57-0-30" id="h57-0-30" class="i">+                },
</a><a href="#h57-0-31" id="h57-0-31" class="i">+            ],
</a><a href="#h57-0-32" id="h57-0-32" class="i">+        },
</a><a href="#h57-0-33" id="h57-0-33" class="i">+    ),
</a><a href="#h57-0-34" id="h57-0-34" class="i">+    where: None,
</a><a href="#h57-0-35" id="h57-0-35" class="i">+    group_by: Some(
</a><a href="#h57-0-36" id="h57-0-36" class="i">+        GroupByClause(
</a><a href="#h57-0-37" id="h57-0-37" class="i">+            [
</a><a href="#h57-0-38" id="h57-0-38" class="i">+                Field(
</a><a href="#h57-0-39" id="h57-0-39" class="i">+                    None,
</a><a href="#h57-0-40" id="h57-0-40" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h57-0-41" id="h57-0-41" class="i">+                ),
</a><a href="#h57-0-42" id="h57-0-42" class="i">+            ],
</a><a href="#h57-0-43" id="h57-0-43" class="i">+        ),
</a><a href="#h57-0-44" id="h57-0-44" class="i">+    ),
</a><a href="#h57-0-45" id="h57-0-45" class="i">+    having: None,
</a><a href="#h57-0-46" id="h57-0-46" class="i">+    order: [
</a><a href="#h57-0-47" id="h57-0-47" class="i">+        (
</a><a href="#h57-0-48" id="h57-0-48" class="i">+            Field(
</a><a href="#h57-0-49" id="h57-0-49" class="i">+                None,
</a><a href="#h57-0-50" id="h57-0-50" class="i">+                &quot;studio_id&quot;,
</a><a href="#h57-0-51" id="h57-0-51" class="i">+            ),
</a><a href="#h57-0-52" id="h57-0-52" class="i">+            Ascending,
</a><a href="#h57-0-53" id="h57-0-53" class="i">+        ),
</a><a href="#h57-0-54" id="h57-0-54" class="i">+    ],
</a><a href="#h57-0-55" id="h57-0-55" class="i">+    limit: None,
</a><a href="#h57-0-56" id="h57-0-56" class="i">+    offset: None,
</a><a href="#h57-0-57" id="h57-0-57" class="i">+}
</a><a href="#h57-0-58" id="h57-0-58" class="i">+
</a><a href="#h57-0-59" id="h57-0-59" class="i">+Plan: Plan {
</a><a href="#h57-0-60" id="h57-0-60" class="i">+    root: Order {
</a><a href="#h57-0-61" id="h57-0-61" class="i">+        source: Projection {
</a><a href="#h57-0-62" id="h57-0-62" class="i">+            source: Aggregation {
</a><a href="#h57-0-63" id="h57-0-63" class="i">+                source: Projection {
</a><a href="#h57-0-64" id="h57-0-64" class="i">+                    source: Scan {
</a><a href="#h57-0-65" id="h57-0-65" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h57-0-66" id="h57-0-66" class="i">+                        alias: None,
</a><a href="#h57-0-67" id="h57-0-67" class="i">+                    },
</a><a href="#h57-0-68" id="h57-0-68" class="i">+                    labels: [
</a><a href="#h57-0-69" id="h57-0-69" class="i">+                        None,
</a><a href="#h57-0-70" id="h57-0-70" class="i">+                        None,
</a><a href="#h57-0-71" id="h57-0-71" class="i">+                    ],
</a><a href="#h57-0-72" id="h57-0-72" class="i">+                    expressions: [
</a><a href="#h57-0-73" id="h57-0-73" class="i">+                        Field(
</a><a href="#h57-0-74" id="h57-0-74" class="i">+                            None,
</a><a href="#h57-0-75" id="h57-0-75" class="i">+                            &quot;rating&quot;,
</a><a href="#h57-0-76" id="h57-0-76" class="i">+                        ),
</a><a href="#h57-0-77" id="h57-0-77" class="i">+                        Field(
</a><a href="#h57-0-78" id="h57-0-78" class="i">+                            None,
</a><a href="#h57-0-79" id="h57-0-79" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h57-0-80" id="h57-0-80" class="i">+                        ),
</a><a href="#h57-0-81" id="h57-0-81" class="i">+                    ],
</a><a href="#h57-0-82" id="h57-0-82" class="i">+                },
</a><a href="#h57-0-83" id="h57-0-83" class="i">+                aggregates: [
</a><a href="#h57-0-84" id="h57-0-84" class="i">+                    Max,
</a><a href="#h57-0-85" id="h57-0-85" class="i">+                ],
</a><a href="#h57-0-86" id="h57-0-86" class="i">+            },
</a><a href="#h57-0-87" id="h57-0-87" class="i">+            labels: [
</a><a href="#h57-0-88" id="h57-0-88" class="i">+                None,
</a><a href="#h57-0-89" id="h57-0-89" class="i">+                None,
</a><a href="#h57-0-90" id="h57-0-90" class="i">+            ],
</a><a href="#h57-0-91" id="h57-0-91" class="i">+            expressions: [
</a><a href="#h57-0-92" id="h57-0-92" class="i">+                Field(
</a><a href="#h57-0-93" id="h57-0-93" class="i">+                    None,
</a><a href="#h57-0-94" id="h57-0-94" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h57-0-95" id="h57-0-95" class="i">+                ),
</a><a href="#h57-0-96" id="h57-0-96" class="i">+                Column(
</a><a href="#h57-0-97" id="h57-0-97" class="i">+                    0,
</a><a href="#h57-0-98" id="h57-0-98" class="i">+                ),
</a><a href="#h57-0-99" id="h57-0-99" class="i">+            ],
</a><a href="#h57-0-100" id="h57-0-100" class="i">+        },
</a><a href="#h57-0-101" id="h57-0-101" class="i">+        orders: [
</a><a href="#h57-0-102" id="h57-0-102" class="i">+            (
</a><a href="#h57-0-103" id="h57-0-103" class="i">+                Field(
</a><a href="#h57-0-104" id="h57-0-104" class="i">+                    None,
</a><a href="#h57-0-105" id="h57-0-105" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h57-0-106" id="h57-0-106" class="i">+                ),
</a><a href="#h57-0-107" id="h57-0-107" class="i">+                Ascending,
</a><a href="#h57-0-108" id="h57-0-108" class="i">+            ),
</a><a href="#h57-0-109" id="h57-0-109" class="i">+        ],
</a><a href="#h57-0-110" id="h57-0-110" class="i">+    },
</a><a href="#h57-0-111" id="h57-0-111" class="i">+}
</a><a href="#h57-0-112" id="h57-0-112" class="i">+
</a><a href="#h57-0-113" id="h57-0-113" class="i">+Optimized plan: Plan {
</a><a href="#h57-0-114" id="h57-0-114" class="i">+    root: Order {
</a><a href="#h57-0-115" id="h57-0-115" class="i">+        source: Projection {
</a><a href="#h57-0-116" id="h57-0-116" class="i">+            source: Aggregation {
</a><a href="#h57-0-117" id="h57-0-117" class="i">+                source: Projection {
</a><a href="#h57-0-118" id="h57-0-118" class="i">+                    source: Scan {
</a><a href="#h57-0-119" id="h57-0-119" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h57-0-120" id="h57-0-120" class="i">+                        alias: None,
</a><a href="#h57-0-121" id="h57-0-121" class="i">+                    },
</a><a href="#h57-0-122" id="h57-0-122" class="i">+                    labels: [
</a><a href="#h57-0-123" id="h57-0-123" class="i">+                        None,
</a><a href="#h57-0-124" id="h57-0-124" class="i">+                        None,
</a><a href="#h57-0-125" id="h57-0-125" class="i">+                    ],
</a><a href="#h57-0-126" id="h57-0-126" class="i">+                    expressions: [
</a><a href="#h57-0-127" id="h57-0-127" class="i">+                        Field(
</a><a href="#h57-0-128" id="h57-0-128" class="i">+                            None,
</a><a href="#h57-0-129" id="h57-0-129" class="i">+                            &quot;rating&quot;,
</a><a href="#h57-0-130" id="h57-0-130" class="i">+                        ),
</a><a href="#h57-0-131" id="h57-0-131" class="i">+                        Field(
</a><a href="#h57-0-132" id="h57-0-132" class="i">+                            None,
</a><a href="#h57-0-133" id="h57-0-133" class="i">+                            &quot;studio_id&quot;,
</a><a href="#h57-0-134" id="h57-0-134" class="i">+                        ),
</a><a href="#h57-0-135" id="h57-0-135" class="i">+                    ],
</a><a href="#h57-0-136" id="h57-0-136" class="i">+                },
</a><a href="#h57-0-137" id="h57-0-137" class="i">+                aggregates: [
</a><a href="#h57-0-138" id="h57-0-138" class="i">+                    Max,
</a><a href="#h57-0-139" id="h57-0-139" class="i">+                ],
</a><a href="#h57-0-140" id="h57-0-140" class="i">+            },
</a><a href="#h57-0-141" id="h57-0-141" class="i">+            labels: [
</a><a href="#h57-0-142" id="h57-0-142" class="i">+                None,
</a><a href="#h57-0-143" id="h57-0-143" class="i">+                None,
</a><a href="#h57-0-144" id="h57-0-144" class="i">+            ],
</a><a href="#h57-0-145" id="h57-0-145" class="i">+            expressions: [
</a><a href="#h57-0-146" id="h57-0-146" class="i">+                Field(
</a><a href="#h57-0-147" id="h57-0-147" class="i">+                    None,
</a><a href="#h57-0-148" id="h57-0-148" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h57-0-149" id="h57-0-149" class="i">+                ),
</a><a href="#h57-0-150" id="h57-0-150" class="i">+                Column(
</a><a href="#h57-0-151" id="h57-0-151" class="i">+                    0,
</a><a href="#h57-0-152" id="h57-0-152" class="i">+                ),
</a><a href="#h57-0-153" id="h57-0-153" class="i">+            ],
</a><a href="#h57-0-154" id="h57-0-154" class="i">+        },
</a><a href="#h57-0-155" id="h57-0-155" class="i">+        orders: [
</a><a href="#h57-0-156" id="h57-0-156" class="i">+            (
</a><a href="#h57-0-157" id="h57-0-157" class="i">+                Field(
</a><a href="#h57-0-158" id="h57-0-158" class="i">+                    None,
</a><a href="#h57-0-159" id="h57-0-159" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h57-0-160" id="h57-0-160" class="i">+                ),
</a><a href="#h57-0-161" id="h57-0-161" class="i">+                Ascending,
</a><a href="#h57-0-162" id="h57-0-162" class="i">+            ),
</a><a href="#h57-0-163" id="h57-0-163" class="i">+        ],
</a><a href="#h57-0-164" id="h57-0-164" class="i">+    },
</a><a href="#h57-0-165" id="h57-0-165" class="i">+}
</a><a href="#h57-0-166" id="h57-0-166" class="i">+
</a><a href="#h57-0-167" id="h57-0-167" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h57-0-168" id="h57-0-168" class="i">+
</a><a href="#h57-0-169" id="h57-0-169" class="i">+Result: [&quot;studio_id&quot;, &quot;?&quot;]
</a><a href="#h57-0-170" id="h57-0-170" class="i">+[Integer(1), Float(8.2)]
</a><a href="#h57-0-171" id="h57-0-171" class="i">+[Integer(2), Float(7.6)]
</a><a href="#h57-0-172" id="h57-0-172" class="i">+[Integer(3), Float(6.9)]
</a><a href="#h57-0-173" id="h57-0-173" class="i">+[Integer(4), Float(8.8)]
</a><b>diff --git a/<a id="h58" href="../file/src/sql/tests/query/group_unknown.html">src/sql/tests/query/group_unknown</a> b/<a href="../file/src/sql/tests/query/group_unknown.html">src/sql/tests/query/group_unknown</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -0,0 +1,128 @@
</a><a href="#h58-0-0" id="h58-0-0" class="i">+Query: SELECT COUNT(*) FROM movies GROUP BY unknown
</a><a href="#h58-0-1" id="h58-0-1" class="i">+
</a><a href="#h58-0-2" id="h58-0-2" class="i">+AST: Select {
</a><a href="#h58-0-3" id="h58-0-3" class="i">+    select: SelectClause {
</a><a href="#h58-0-4" id="h58-0-4" class="i">+        expressions: [
</a><a href="#h58-0-5" id="h58-0-5" class="i">+            Function(
</a><a href="#h58-0-6" id="h58-0-6" class="i">+                &quot;count&quot;,
</a><a href="#h58-0-7" id="h58-0-7" class="i">+                [
</a><a href="#h58-0-8" id="h58-0-8" class="i">+                    Literal(
</a><a href="#h58-0-9" id="h58-0-9" class="i">+                        Boolean(
</a><a href="#h58-0-10" id="h58-0-10" class="i">+                            true,
</a><a href="#h58-0-11" id="h58-0-11" class="i">+                        ),
</a><a href="#h58-0-12" id="h58-0-12" class="i">+                    ),
</a><a href="#h58-0-13" id="h58-0-13" class="i">+                ],
</a><a href="#h58-0-14" id="h58-0-14" class="i">+            ),
</a><a href="#h58-0-15" id="h58-0-15" class="i">+        ],
</a><a href="#h58-0-16" id="h58-0-16" class="i">+        labels: [
</a><a href="#h58-0-17" id="h58-0-17" class="i">+            None,
</a><a href="#h58-0-18" id="h58-0-18" class="i">+        ],
</a><a href="#h58-0-19" id="h58-0-19" class="i">+    },
</a><a href="#h58-0-20" id="h58-0-20" class="i">+    from: Some(
</a><a href="#h58-0-21" id="h58-0-21" class="i">+        FromClause {
</a><a href="#h58-0-22" id="h58-0-22" class="i">+            items: [
</a><a href="#h58-0-23" id="h58-0-23" class="i">+                Table {
</a><a href="#h58-0-24" id="h58-0-24" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h58-0-25" id="h58-0-25" class="i">+                    alias: None,
</a><a href="#h58-0-26" id="h58-0-26" class="i">+                },
</a><a href="#h58-0-27" id="h58-0-27" class="i">+            ],
</a><a href="#h58-0-28" id="h58-0-28" class="i">+        },
</a><a href="#h58-0-29" id="h58-0-29" class="i">+    ),
</a><a href="#h58-0-30" id="h58-0-30" class="i">+    where: None,
</a><a href="#h58-0-31" id="h58-0-31" class="i">+    group_by: Some(
</a><a href="#h58-0-32" id="h58-0-32" class="i">+        GroupByClause(
</a><a href="#h58-0-33" id="h58-0-33" class="i">+            [
</a><a href="#h58-0-34" id="h58-0-34" class="i">+                Field(
</a><a href="#h58-0-35" id="h58-0-35" class="i">+                    None,
</a><a href="#h58-0-36" id="h58-0-36" class="i">+                    &quot;unknown&quot;,
</a><a href="#h58-0-37" id="h58-0-37" class="i">+                ),
</a><a href="#h58-0-38" id="h58-0-38" class="i">+            ],
</a><a href="#h58-0-39" id="h58-0-39" class="i">+        ),
</a><a href="#h58-0-40" id="h58-0-40" class="i">+    ),
</a><a href="#h58-0-41" id="h58-0-41" class="i">+    having: None,
</a><a href="#h58-0-42" id="h58-0-42" class="i">+    order: [],
</a><a href="#h58-0-43" id="h58-0-43" class="i">+    limit: None,
</a><a href="#h58-0-44" id="h58-0-44" class="i">+    offset: None,
</a><a href="#h58-0-45" id="h58-0-45" class="i">+}
</a><a href="#h58-0-46" id="h58-0-46" class="i">+
</a><a href="#h58-0-47" id="h58-0-47" class="i">+Plan: Plan {
</a><a href="#h58-0-48" id="h58-0-48" class="i">+    root: Projection {
</a><a href="#h58-0-49" id="h58-0-49" class="i">+        source: Aggregation {
</a><a href="#h58-0-50" id="h58-0-50" class="i">+            source: Projection {
</a><a href="#h58-0-51" id="h58-0-51" class="i">+                source: Scan {
</a><a href="#h58-0-52" id="h58-0-52" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h58-0-53" id="h58-0-53" class="i">+                    alias: None,
</a><a href="#h58-0-54" id="h58-0-54" class="i">+                },
</a><a href="#h58-0-55" id="h58-0-55" class="i">+                labels: [
</a><a href="#h58-0-56" id="h58-0-56" class="i">+                    None,
</a><a href="#h58-0-57" id="h58-0-57" class="i">+                    None,
</a><a href="#h58-0-58" id="h58-0-58" class="i">+                ],
</a><a href="#h58-0-59" id="h58-0-59" class="i">+                expressions: [
</a><a href="#h58-0-60" id="h58-0-60" class="i">+                    Constant(
</a><a href="#h58-0-61" id="h58-0-61" class="i">+                        Boolean(
</a><a href="#h58-0-62" id="h58-0-62" class="i">+                            true,
</a><a href="#h58-0-63" id="h58-0-63" class="i">+                        ),
</a><a href="#h58-0-64" id="h58-0-64" class="i">+                    ),
</a><a href="#h58-0-65" id="h58-0-65" class="i">+                    Field(
</a><a href="#h58-0-66" id="h58-0-66" class="i">+                        None,
</a><a href="#h58-0-67" id="h58-0-67" class="i">+                        &quot;unknown&quot;,
</a><a href="#h58-0-68" id="h58-0-68" class="i">+                    ),
</a><a href="#h58-0-69" id="h58-0-69" class="i">+                ],
</a><a href="#h58-0-70" id="h58-0-70" class="i">+            },
</a><a href="#h58-0-71" id="h58-0-71" class="i">+            aggregates: [
</a><a href="#h58-0-72" id="h58-0-72" class="i">+                Count,
</a><a href="#h58-0-73" id="h58-0-73" class="i">+            ],
</a><a href="#h58-0-74" id="h58-0-74" class="i">+        },
</a><a href="#h58-0-75" id="h58-0-75" class="i">+        labels: [
</a><a href="#h58-0-76" id="h58-0-76" class="i">+            None,
</a><a href="#h58-0-77" id="h58-0-77" class="i">+        ],
</a><a href="#h58-0-78" id="h58-0-78" class="i">+        expressions: [
</a><a href="#h58-0-79" id="h58-0-79" class="i">+            Column(
</a><a href="#h58-0-80" id="h58-0-80" class="i">+                0,
</a><a href="#h58-0-81" id="h58-0-81" class="i">+            ),
</a><a href="#h58-0-82" id="h58-0-82" class="i">+        ],
</a><a href="#h58-0-83" id="h58-0-83" class="i">+    },
</a><a href="#h58-0-84" id="h58-0-84" class="i">+}
</a><a href="#h58-0-85" id="h58-0-85" class="i">+
</a><a href="#h58-0-86" id="h58-0-86" class="i">+Optimized plan: Plan {
</a><a href="#h58-0-87" id="h58-0-87" class="i">+    root: Projection {
</a><a href="#h58-0-88" id="h58-0-88" class="i">+        source: Aggregation {
</a><a href="#h58-0-89" id="h58-0-89" class="i">+            source: Projection {
</a><a href="#h58-0-90" id="h58-0-90" class="i">+                source: Scan {
</a><a href="#h58-0-91" id="h58-0-91" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h58-0-92" id="h58-0-92" class="i">+                    alias: None,
</a><a href="#h58-0-93" id="h58-0-93" class="i">+                },
</a><a href="#h58-0-94" id="h58-0-94" class="i">+                labels: [
</a><a href="#h58-0-95" id="h58-0-95" class="i">+                    None,
</a><a href="#h58-0-96" id="h58-0-96" class="i">+                    None,
</a><a href="#h58-0-97" id="h58-0-97" class="i">+                ],
</a><a href="#h58-0-98" id="h58-0-98" class="i">+                expressions: [
</a><a href="#h58-0-99" id="h58-0-99" class="i">+                    Constant(
</a><a href="#h58-0-100" id="h58-0-100" class="i">+                        Boolean(
</a><a href="#h58-0-101" id="h58-0-101" class="i">+                            true,
</a><a href="#h58-0-102" id="h58-0-102" class="i">+                        ),
</a><a href="#h58-0-103" id="h58-0-103" class="i">+                    ),
</a><a href="#h58-0-104" id="h58-0-104" class="i">+                    Field(
</a><a href="#h58-0-105" id="h58-0-105" class="i">+                        None,
</a><a href="#h58-0-106" id="h58-0-106" class="i">+                        &quot;unknown&quot;,
</a><a href="#h58-0-107" id="h58-0-107" class="i">+                    ),
</a><a href="#h58-0-108" id="h58-0-108" class="i">+                ],
</a><a href="#h58-0-109" id="h58-0-109" class="i">+            },
</a><a href="#h58-0-110" id="h58-0-110" class="i">+            aggregates: [
</a><a href="#h58-0-111" id="h58-0-111" class="i">+                Count,
</a><a href="#h58-0-112" id="h58-0-112" class="i">+            ],
</a><a href="#h58-0-113" id="h58-0-113" class="i">+        },
</a><a href="#h58-0-114" id="h58-0-114" class="i">+        labels: [
</a><a href="#h58-0-115" id="h58-0-115" class="i">+            None,
</a><a href="#h58-0-116" id="h58-0-116" class="i">+        ],
</a><a href="#h58-0-117" id="h58-0-117" class="i">+        expressions: [
</a><a href="#h58-0-118" id="h58-0-118" class="i">+            Column(
</a><a href="#h58-0-119" id="h58-0-119" class="i">+                0,
</a><a href="#h58-0-120" id="h58-0-120" class="i">+            ),
</a><a href="#h58-0-121" id="h58-0-121" class="i">+        ],
</a><a href="#h58-0-122" id="h58-0-122" class="i">+    },
</a><a href="#h58-0-123" id="h58-0-123" class="i">+}
</a><a href="#h58-0-124" id="h58-0-124" class="i">+
</a><a href="#h58-0-125" id="h58-0-125" class="i">+Query: SELECT COUNT(*) FROM movies GROUP BY unknown
</a><a href="#h58-0-126" id="h58-0-126" class="i">+
</a><a href="#h58-0-127" id="h58-0-127" class="i">+Result: Value(&quot;Unknown field unknown&quot;)
</a><a href="#h58-0-128" id="h58-0-128" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h59" href="../file/src/sql/tests/query/having.html">src/sql/tests/query/having</a> b/<a href="../file/src/sql/tests/query/having.html">src/sql/tests/query/having</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -0,0 +1,220 @@
</a><a href="#h59-0-0" id="h59-0-0" class="i">+Query: SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING rating &gt; 8 ORDER BY studio_id
</a><a href="#h59-0-1" id="h59-0-1" class="i">+
</a><a href="#h59-0-2" id="h59-0-2" class="i">+AST: Select {
</a><a href="#h59-0-3" id="h59-0-3" class="i">+    select: SelectClause {
</a><a href="#h59-0-4" id="h59-0-4" class="i">+        expressions: [
</a><a href="#h59-0-5" id="h59-0-5" class="i">+            Field(
</a><a href="#h59-0-6" id="h59-0-6" class="i">+                None,
</a><a href="#h59-0-7" id="h59-0-7" class="i">+                &quot;studio_id&quot;,
</a><a href="#h59-0-8" id="h59-0-8" class="i">+            ),
</a><a href="#h59-0-9" id="h59-0-9" class="i">+            Function(
</a><a href="#h59-0-10" id="h59-0-10" class="i">+                &quot;max&quot;,
</a><a href="#h59-0-11" id="h59-0-11" class="i">+                [
</a><a href="#h59-0-12" id="h59-0-12" class="i">+                    Field(
</a><a href="#h59-0-13" id="h59-0-13" class="i">+                        None,
</a><a href="#h59-0-14" id="h59-0-14" class="i">+                        &quot;rating&quot;,
</a><a href="#h59-0-15" id="h59-0-15" class="i">+                    ),
</a><a href="#h59-0-16" id="h59-0-16" class="i">+                ],
</a><a href="#h59-0-17" id="h59-0-17" class="i">+            ),
</a><a href="#h59-0-18" id="h59-0-18" class="i">+        ],
</a><a href="#h59-0-19" id="h59-0-19" class="i">+        labels: [
</a><a href="#h59-0-20" id="h59-0-20" class="i">+            None,
</a><a href="#h59-0-21" id="h59-0-21" class="i">+            Some(
</a><a href="#h59-0-22" id="h59-0-22" class="i">+                &quot;rating&quot;,
</a><a href="#h59-0-23" id="h59-0-23" class="i">+            ),
</a><a href="#h59-0-24" id="h59-0-24" class="i">+        ],
</a><a href="#h59-0-25" id="h59-0-25" class="i">+    },
</a><a href="#h59-0-26" id="h59-0-26" class="i">+    from: Some(
</a><a href="#h59-0-27" id="h59-0-27" class="i">+        FromClause {
</a><a href="#h59-0-28" id="h59-0-28" class="i">+            items: [
</a><a href="#h59-0-29" id="h59-0-29" class="i">+                Table {
</a><a href="#h59-0-30" id="h59-0-30" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h59-0-31" id="h59-0-31" class="i">+                    alias: None,
</a><a href="#h59-0-32" id="h59-0-32" class="i">+                },
</a><a href="#h59-0-33" id="h59-0-33" class="i">+            ],
</a><a href="#h59-0-34" id="h59-0-34" class="i">+        },
</a><a href="#h59-0-35" id="h59-0-35" class="i">+    ),
</a><a href="#h59-0-36" id="h59-0-36" class="i">+    where: None,
</a><a href="#h59-0-37" id="h59-0-37" class="i">+    group_by: Some(
</a><a href="#h59-0-38" id="h59-0-38" class="i">+        GroupByClause(
</a><a href="#h59-0-39" id="h59-0-39" class="i">+            [
</a><a href="#h59-0-40" id="h59-0-40" class="i">+                Field(
</a><a href="#h59-0-41" id="h59-0-41" class="i">+                    None,
</a><a href="#h59-0-42" id="h59-0-42" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h59-0-43" id="h59-0-43" class="i">+                ),
</a><a href="#h59-0-44" id="h59-0-44" class="i">+            ],
</a><a href="#h59-0-45" id="h59-0-45" class="i">+        ),
</a><a href="#h59-0-46" id="h59-0-46" class="i">+    ),
</a><a href="#h59-0-47" id="h59-0-47" class="i">+    having: Some(
</a><a href="#h59-0-48" id="h59-0-48" class="i">+        HavingClause(
</a><a href="#h59-0-49" id="h59-0-49" class="i">+            Operation(
</a><a href="#h59-0-50" id="h59-0-50" class="i">+                GreaterThan(
</a><a href="#h59-0-51" id="h59-0-51" class="i">+                    Field(
</a><a href="#h59-0-52" id="h59-0-52" class="i">+                        None,
</a><a href="#h59-0-53" id="h59-0-53" class="i">+                        &quot;rating&quot;,
</a><a href="#h59-0-54" id="h59-0-54" class="i">+                    ),
</a><a href="#h59-0-55" id="h59-0-55" class="i">+                    Literal(
</a><a href="#h59-0-56" id="h59-0-56" class="i">+                        Integer(
</a><a href="#h59-0-57" id="h59-0-57" class="i">+                            8,
</a><a href="#h59-0-58" id="h59-0-58" class="i">+                        ),
</a><a href="#h59-0-59" id="h59-0-59" class="i">+                    ),
</a><a href="#h59-0-60" id="h59-0-60" class="i">+                ),
</a><a href="#h59-0-61" id="h59-0-61" class="i">+            ),
</a><a href="#h59-0-62" id="h59-0-62" class="i">+        ),
</a><a href="#h59-0-63" id="h59-0-63" class="i">+    ),
</a><a href="#h59-0-64" id="h59-0-64" class="i">+    order: [
</a><a href="#h59-0-65" id="h59-0-65" class="i">+        (
</a><a href="#h59-0-66" id="h59-0-66" class="i">+            Field(
</a><a href="#h59-0-67" id="h59-0-67" class="i">+                None,
</a><a href="#h59-0-68" id="h59-0-68" class="i">+                &quot;studio_id&quot;,
</a><a href="#h59-0-69" id="h59-0-69" class="i">+            ),
</a><a href="#h59-0-70" id="h59-0-70" class="i">+            Ascending,
</a><a href="#h59-0-71" id="h59-0-71" class="i">+        ),
</a><a href="#h59-0-72" id="h59-0-72" class="i">+    ],
</a><a href="#h59-0-73" id="h59-0-73" class="i">+    limit: None,
</a><a href="#h59-0-74" id="h59-0-74" class="i">+    offset: None,
</a><a href="#h59-0-75" id="h59-0-75" class="i">+}
</a><a href="#h59-0-76" id="h59-0-76" class="i">+
</a><a href="#h59-0-77" id="h59-0-77" class="i">+Plan: Plan {
</a><a href="#h59-0-78" id="h59-0-78" class="i">+    root: Order {
</a><a href="#h59-0-79" id="h59-0-79" class="i">+        source: Filter {
</a><a href="#h59-0-80" id="h59-0-80" class="i">+            source: Projection {
</a><a href="#h59-0-81" id="h59-0-81" class="i">+                source: Aggregation {
</a><a href="#h59-0-82" id="h59-0-82" class="i">+                    source: Projection {
</a><a href="#h59-0-83" id="h59-0-83" class="i">+                        source: Scan {
</a><a href="#h59-0-84" id="h59-0-84" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h59-0-85" id="h59-0-85" class="i">+                            alias: None,
</a><a href="#h59-0-86" id="h59-0-86" class="i">+                        },
</a><a href="#h59-0-87" id="h59-0-87" class="i">+                        labels: [
</a><a href="#h59-0-88" id="h59-0-88" class="i">+                            None,
</a><a href="#h59-0-89" id="h59-0-89" class="i">+                            None,
</a><a href="#h59-0-90" id="h59-0-90" class="i">+                        ],
</a><a href="#h59-0-91" id="h59-0-91" class="i">+                        expressions: [
</a><a href="#h59-0-92" id="h59-0-92" class="i">+                            Field(
</a><a href="#h59-0-93" id="h59-0-93" class="i">+                                None,
</a><a href="#h59-0-94" id="h59-0-94" class="i">+                                &quot;rating&quot;,
</a><a href="#h59-0-95" id="h59-0-95" class="i">+                            ),
</a><a href="#h59-0-96" id="h59-0-96" class="i">+                            Field(
</a><a href="#h59-0-97" id="h59-0-97" class="i">+                                None,
</a><a href="#h59-0-98" id="h59-0-98" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h59-0-99" id="h59-0-99" class="i">+                            ),
</a><a href="#h59-0-100" id="h59-0-100" class="i">+                        ],
</a><a href="#h59-0-101" id="h59-0-101" class="i">+                    },
</a><a href="#h59-0-102" id="h59-0-102" class="i">+                    aggregates: [
</a><a href="#h59-0-103" id="h59-0-103" class="i">+                        Max,
</a><a href="#h59-0-104" id="h59-0-104" class="i">+                    ],
</a><a href="#h59-0-105" id="h59-0-105" class="i">+                },
</a><a href="#h59-0-106" id="h59-0-106" class="i">+                labels: [
</a><a href="#h59-0-107" id="h59-0-107" class="i">+                    None,
</a><a href="#h59-0-108" id="h59-0-108" class="i">+                    Some(
</a><a href="#h59-0-109" id="h59-0-109" class="i">+                        &quot;rating&quot;,
</a><a href="#h59-0-110" id="h59-0-110" class="i">+                    ),
</a><a href="#h59-0-111" id="h59-0-111" class="i">+                ],
</a><a href="#h59-0-112" id="h59-0-112" class="i">+                expressions: [
</a><a href="#h59-0-113" id="h59-0-113" class="i">+                    Field(
</a><a href="#h59-0-114" id="h59-0-114" class="i">+                        None,
</a><a href="#h59-0-115" id="h59-0-115" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h59-0-116" id="h59-0-116" class="i">+                    ),
</a><a href="#h59-0-117" id="h59-0-117" class="i">+                    Column(
</a><a href="#h59-0-118" id="h59-0-118" class="i">+                        0,
</a><a href="#h59-0-119" id="h59-0-119" class="i">+                    ),
</a><a href="#h59-0-120" id="h59-0-120" class="i">+                ],
</a><a href="#h59-0-121" id="h59-0-121" class="i">+            },
</a><a href="#h59-0-122" id="h59-0-122" class="i">+            predicate: GreaterThan(
</a><a href="#h59-0-123" id="h59-0-123" class="i">+                Field(
</a><a href="#h59-0-124" id="h59-0-124" class="i">+                    None,
</a><a href="#h59-0-125" id="h59-0-125" class="i">+                    &quot;rating&quot;,
</a><a href="#h59-0-126" id="h59-0-126" class="i">+                ),
</a><a href="#h59-0-127" id="h59-0-127" class="i">+                Constant(
</a><a href="#h59-0-128" id="h59-0-128" class="i">+                    Integer(
</a><a href="#h59-0-129" id="h59-0-129" class="i">+                        8,
</a><a href="#h59-0-130" id="h59-0-130" class="i">+                    ),
</a><a href="#h59-0-131" id="h59-0-131" class="i">+                ),
</a><a href="#h59-0-132" id="h59-0-132" class="i">+            ),
</a><a href="#h59-0-133" id="h59-0-133" class="i">+        },
</a><a href="#h59-0-134" id="h59-0-134" class="i">+        orders: [
</a><a href="#h59-0-135" id="h59-0-135" class="i">+            (
</a><a href="#h59-0-136" id="h59-0-136" class="i">+                Field(
</a><a href="#h59-0-137" id="h59-0-137" class="i">+                    None,
</a><a href="#h59-0-138" id="h59-0-138" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h59-0-139" id="h59-0-139" class="i">+                ),
</a><a href="#h59-0-140" id="h59-0-140" class="i">+                Ascending,
</a><a href="#h59-0-141" id="h59-0-141" class="i">+            ),
</a><a href="#h59-0-142" id="h59-0-142" class="i">+        ],
</a><a href="#h59-0-143" id="h59-0-143" class="i">+    },
</a><a href="#h59-0-144" id="h59-0-144" class="i">+}
</a><a href="#h59-0-145" id="h59-0-145" class="i">+
</a><a href="#h59-0-146" id="h59-0-146" class="i">+Optimized plan: Plan {
</a><a href="#h59-0-147" id="h59-0-147" class="i">+    root: Order {
</a><a href="#h59-0-148" id="h59-0-148" class="i">+        source: Filter {
</a><a href="#h59-0-149" id="h59-0-149" class="i">+            source: Projection {
</a><a href="#h59-0-150" id="h59-0-150" class="i">+                source: Aggregation {
</a><a href="#h59-0-151" id="h59-0-151" class="i">+                    source: Projection {
</a><a href="#h59-0-152" id="h59-0-152" class="i">+                        source: Scan {
</a><a href="#h59-0-153" id="h59-0-153" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h59-0-154" id="h59-0-154" class="i">+                            alias: None,
</a><a href="#h59-0-155" id="h59-0-155" class="i">+                        },
</a><a href="#h59-0-156" id="h59-0-156" class="i">+                        labels: [
</a><a href="#h59-0-157" id="h59-0-157" class="i">+                            None,
</a><a href="#h59-0-158" id="h59-0-158" class="i">+                            None,
</a><a href="#h59-0-159" id="h59-0-159" class="i">+                        ],
</a><a href="#h59-0-160" id="h59-0-160" class="i">+                        expressions: [
</a><a href="#h59-0-161" id="h59-0-161" class="i">+                            Field(
</a><a href="#h59-0-162" id="h59-0-162" class="i">+                                None,
</a><a href="#h59-0-163" id="h59-0-163" class="i">+                                &quot;rating&quot;,
</a><a href="#h59-0-164" id="h59-0-164" class="i">+                            ),
</a><a href="#h59-0-165" id="h59-0-165" class="i">+                            Field(
</a><a href="#h59-0-166" id="h59-0-166" class="i">+                                None,
</a><a href="#h59-0-167" id="h59-0-167" class="i">+                                &quot;studio_id&quot;,
</a><a href="#h59-0-168" id="h59-0-168" class="i">+                            ),
</a><a href="#h59-0-169" id="h59-0-169" class="i">+                        ],
</a><a href="#h59-0-170" id="h59-0-170" class="i">+                    },
</a><a href="#h59-0-171" id="h59-0-171" class="i">+                    aggregates: [
</a><a href="#h59-0-172" id="h59-0-172" class="i">+                        Max,
</a><a href="#h59-0-173" id="h59-0-173" class="i">+                    ],
</a><a href="#h59-0-174" id="h59-0-174" class="i">+                },
</a><a href="#h59-0-175" id="h59-0-175" class="i">+                labels: [
</a><a href="#h59-0-176" id="h59-0-176" class="i">+                    None,
</a><a href="#h59-0-177" id="h59-0-177" class="i">+                    Some(
</a><a href="#h59-0-178" id="h59-0-178" class="i">+                        &quot;rating&quot;,
</a><a href="#h59-0-179" id="h59-0-179" class="i">+                    ),
</a><a href="#h59-0-180" id="h59-0-180" class="i">+                ],
</a><a href="#h59-0-181" id="h59-0-181" class="i">+                expressions: [
</a><a href="#h59-0-182" id="h59-0-182" class="i">+                    Field(
</a><a href="#h59-0-183" id="h59-0-183" class="i">+                        None,
</a><a href="#h59-0-184" id="h59-0-184" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h59-0-185" id="h59-0-185" class="i">+                    ),
</a><a href="#h59-0-186" id="h59-0-186" class="i">+                    Column(
</a><a href="#h59-0-187" id="h59-0-187" class="i">+                        0,
</a><a href="#h59-0-188" id="h59-0-188" class="i">+                    ),
</a><a href="#h59-0-189" id="h59-0-189" class="i">+                ],
</a><a href="#h59-0-190" id="h59-0-190" class="i">+            },
</a><a href="#h59-0-191" id="h59-0-191" class="i">+            predicate: GreaterThan(
</a><a href="#h59-0-192" id="h59-0-192" class="i">+                Field(
</a><a href="#h59-0-193" id="h59-0-193" class="i">+                    None,
</a><a href="#h59-0-194" id="h59-0-194" class="i">+                    &quot;rating&quot;,
</a><a href="#h59-0-195" id="h59-0-195" class="i">+                ),
</a><a href="#h59-0-196" id="h59-0-196" class="i">+                Constant(
</a><a href="#h59-0-197" id="h59-0-197" class="i">+                    Integer(
</a><a href="#h59-0-198" id="h59-0-198" class="i">+                        8,
</a><a href="#h59-0-199" id="h59-0-199" class="i">+                    ),
</a><a href="#h59-0-200" id="h59-0-200" class="i">+                ),
</a><a href="#h59-0-201" id="h59-0-201" class="i">+            ),
</a><a href="#h59-0-202" id="h59-0-202" class="i">+        },
</a><a href="#h59-0-203" id="h59-0-203" class="i">+        orders: [
</a><a href="#h59-0-204" id="h59-0-204" class="i">+            (
</a><a href="#h59-0-205" id="h59-0-205" class="i">+                Field(
</a><a href="#h59-0-206" id="h59-0-206" class="i">+                    None,
</a><a href="#h59-0-207" id="h59-0-207" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h59-0-208" id="h59-0-208" class="i">+                ),
</a><a href="#h59-0-209" id="h59-0-209" class="i">+                Ascending,
</a><a href="#h59-0-210" id="h59-0-210" class="i">+            ),
</a><a href="#h59-0-211" id="h59-0-211" class="i">+        ],
</a><a href="#h59-0-212" id="h59-0-212" class="i">+    },
</a><a href="#h59-0-213" id="h59-0-213" class="i">+}
</a><a href="#h59-0-214" id="h59-0-214" class="i">+
</a><a href="#h59-0-215" id="h59-0-215" class="i">+Query: SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING rating &gt; 8 ORDER BY studio_id
</a><a href="#h59-0-216" id="h59-0-216" class="i">+
</a><a href="#h59-0-217" id="h59-0-217" class="i">+Result: [&quot;studio_id&quot;, &quot;rating&quot;]
</a><a href="#h59-0-218" id="h59-0-218" class="i">+[Integer(1), Float(8.2)]
</a><a href="#h59-0-219" id="h59-0-219" class="i">+[Integer(4), Float(8.8)]
</a><b>diff --git a/<a id="h60" href="../file/src/sql/tests/query/having_nogroup.html">src/sql/tests/query/having_nogroup</a> b/<a href="../file/src/sql/tests/query/having_nogroup.html">src/sql/tests/query/having_nogroup</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -0,0 +1,162 @@
</a><a href="#h60-0-0" id="h60-0-0" class="i">+Query: SELECT id, rating FROM movies HAVING rating &gt; 8 ORDER BY id
</a><a href="#h60-0-1" id="h60-0-1" class="i">+
</a><a href="#h60-0-2" id="h60-0-2" class="i">+AST: Select {
</a><a href="#h60-0-3" id="h60-0-3" class="i">+    select: SelectClause {
</a><a href="#h60-0-4" id="h60-0-4" class="i">+        expressions: [
</a><a href="#h60-0-5" id="h60-0-5" class="i">+            Field(
</a><a href="#h60-0-6" id="h60-0-6" class="i">+                None,
</a><a href="#h60-0-7" id="h60-0-7" class="i">+                &quot;id&quot;,
</a><a href="#h60-0-8" id="h60-0-8" class="i">+            ),
</a><a href="#h60-0-9" id="h60-0-9" class="i">+            Field(
</a><a href="#h60-0-10" id="h60-0-10" class="i">+                None,
</a><a href="#h60-0-11" id="h60-0-11" class="i">+                &quot;rating&quot;,
</a><a href="#h60-0-12" id="h60-0-12" class="i">+            ),
</a><a href="#h60-0-13" id="h60-0-13" class="i">+        ],
</a><a href="#h60-0-14" id="h60-0-14" class="i">+        labels: [
</a><a href="#h60-0-15" id="h60-0-15" class="i">+            None,
</a><a href="#h60-0-16" id="h60-0-16" class="i">+            None,
</a><a href="#h60-0-17" id="h60-0-17" class="i">+        ],
</a><a href="#h60-0-18" id="h60-0-18" class="i">+    },
</a><a href="#h60-0-19" id="h60-0-19" class="i">+    from: Some(
</a><a href="#h60-0-20" id="h60-0-20" class="i">+        FromClause {
</a><a href="#h60-0-21" id="h60-0-21" class="i">+            items: [
</a><a href="#h60-0-22" id="h60-0-22" class="i">+                Table {
</a><a href="#h60-0-23" id="h60-0-23" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h60-0-24" id="h60-0-24" class="i">+                    alias: None,
</a><a href="#h60-0-25" id="h60-0-25" class="i">+                },
</a><a href="#h60-0-26" id="h60-0-26" class="i">+            ],
</a><a href="#h60-0-27" id="h60-0-27" class="i">+        },
</a><a href="#h60-0-28" id="h60-0-28" class="i">+    ),
</a><a href="#h60-0-29" id="h60-0-29" class="i">+    where: None,
</a><a href="#h60-0-30" id="h60-0-30" class="i">+    group_by: None,
</a><a href="#h60-0-31" id="h60-0-31" class="i">+    having: Some(
</a><a href="#h60-0-32" id="h60-0-32" class="i">+        HavingClause(
</a><a href="#h60-0-33" id="h60-0-33" class="i">+            Operation(
</a><a href="#h60-0-34" id="h60-0-34" class="i">+                GreaterThan(
</a><a href="#h60-0-35" id="h60-0-35" class="i">+                    Field(
</a><a href="#h60-0-36" id="h60-0-36" class="i">+                        None,
</a><a href="#h60-0-37" id="h60-0-37" class="i">+                        &quot;rating&quot;,
</a><a href="#h60-0-38" id="h60-0-38" class="i">+                    ),
</a><a href="#h60-0-39" id="h60-0-39" class="i">+                    Literal(
</a><a href="#h60-0-40" id="h60-0-40" class="i">+                        Integer(
</a><a href="#h60-0-41" id="h60-0-41" class="i">+                            8,
</a><a href="#h60-0-42" id="h60-0-42" class="i">+                        ),
</a><a href="#h60-0-43" id="h60-0-43" class="i">+                    ),
</a><a href="#h60-0-44" id="h60-0-44" class="i">+                ),
</a><a href="#h60-0-45" id="h60-0-45" class="i">+            ),
</a><a href="#h60-0-46" id="h60-0-46" class="i">+        ),
</a><a href="#h60-0-47" id="h60-0-47" class="i">+    ),
</a><a href="#h60-0-48" id="h60-0-48" class="i">+    order: [
</a><a href="#h60-0-49" id="h60-0-49" class="i">+        (
</a><a href="#h60-0-50" id="h60-0-50" class="i">+            Field(
</a><a href="#h60-0-51" id="h60-0-51" class="i">+                None,
</a><a href="#h60-0-52" id="h60-0-52" class="i">+                &quot;id&quot;,
</a><a href="#h60-0-53" id="h60-0-53" class="i">+            ),
</a><a href="#h60-0-54" id="h60-0-54" class="i">+            Ascending,
</a><a href="#h60-0-55" id="h60-0-55" class="i">+        ),
</a><a href="#h60-0-56" id="h60-0-56" class="i">+    ],
</a><a href="#h60-0-57" id="h60-0-57" class="i">+    limit: None,
</a><a href="#h60-0-58" id="h60-0-58" class="i">+    offset: None,
</a><a href="#h60-0-59" id="h60-0-59" class="i">+}
</a><a href="#h60-0-60" id="h60-0-60" class="i">+
</a><a href="#h60-0-61" id="h60-0-61" class="i">+Plan: Plan {
</a><a href="#h60-0-62" id="h60-0-62" class="i">+    root: Order {
</a><a href="#h60-0-63" id="h60-0-63" class="i">+        source: Filter {
</a><a href="#h60-0-64" id="h60-0-64" class="i">+            source: Projection {
</a><a href="#h60-0-65" id="h60-0-65" class="i">+                source: Scan {
</a><a href="#h60-0-66" id="h60-0-66" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h60-0-67" id="h60-0-67" class="i">+                    alias: None,
</a><a href="#h60-0-68" id="h60-0-68" class="i">+                },
</a><a href="#h60-0-69" id="h60-0-69" class="i">+                labels: [
</a><a href="#h60-0-70" id="h60-0-70" class="i">+                    None,
</a><a href="#h60-0-71" id="h60-0-71" class="i">+                    None,
</a><a href="#h60-0-72" id="h60-0-72" class="i">+                ],
</a><a href="#h60-0-73" id="h60-0-73" class="i">+                expressions: [
</a><a href="#h60-0-74" id="h60-0-74" class="i">+                    Field(
</a><a href="#h60-0-75" id="h60-0-75" class="i">+                        None,
</a><a href="#h60-0-76" id="h60-0-76" class="i">+                        &quot;id&quot;,
</a><a href="#h60-0-77" id="h60-0-77" class="i">+                    ),
</a><a href="#h60-0-78" id="h60-0-78" class="i">+                    Field(
</a><a href="#h60-0-79" id="h60-0-79" class="i">+                        None,
</a><a href="#h60-0-80" id="h60-0-80" class="i">+                        &quot;rating&quot;,
</a><a href="#h60-0-81" id="h60-0-81" class="i">+                    ),
</a><a href="#h60-0-82" id="h60-0-82" class="i">+                ],
</a><a href="#h60-0-83" id="h60-0-83" class="i">+            },
</a><a href="#h60-0-84" id="h60-0-84" class="i">+            predicate: GreaterThan(
</a><a href="#h60-0-85" id="h60-0-85" class="i">+                Field(
</a><a href="#h60-0-86" id="h60-0-86" class="i">+                    None,
</a><a href="#h60-0-87" id="h60-0-87" class="i">+                    &quot;rating&quot;,
</a><a href="#h60-0-88" id="h60-0-88" class="i">+                ),
</a><a href="#h60-0-89" id="h60-0-89" class="i">+                Constant(
</a><a href="#h60-0-90" id="h60-0-90" class="i">+                    Integer(
</a><a href="#h60-0-91" id="h60-0-91" class="i">+                        8,
</a><a href="#h60-0-92" id="h60-0-92" class="i">+                    ),
</a><a href="#h60-0-93" id="h60-0-93" class="i">+                ),
</a><a href="#h60-0-94" id="h60-0-94" class="i">+            ),
</a><a href="#h60-0-95" id="h60-0-95" class="i">+        },
</a><a href="#h60-0-96" id="h60-0-96" class="i">+        orders: [
</a><a href="#h60-0-97" id="h60-0-97" class="i">+            (
</a><a href="#h60-0-98" id="h60-0-98" class="i">+                Field(
</a><a href="#h60-0-99" id="h60-0-99" class="i">+                    None,
</a><a href="#h60-0-100" id="h60-0-100" class="i">+                    &quot;id&quot;,
</a><a href="#h60-0-101" id="h60-0-101" class="i">+                ),
</a><a href="#h60-0-102" id="h60-0-102" class="i">+                Ascending,
</a><a href="#h60-0-103" id="h60-0-103" class="i">+            ),
</a><a href="#h60-0-104" id="h60-0-104" class="i">+        ],
</a><a href="#h60-0-105" id="h60-0-105" class="i">+    },
</a><a href="#h60-0-106" id="h60-0-106" class="i">+}
</a><a href="#h60-0-107" id="h60-0-107" class="i">+
</a><a href="#h60-0-108" id="h60-0-108" class="i">+Optimized plan: Plan {
</a><a href="#h60-0-109" id="h60-0-109" class="i">+    root: Order {
</a><a href="#h60-0-110" id="h60-0-110" class="i">+        source: Filter {
</a><a href="#h60-0-111" id="h60-0-111" class="i">+            source: Projection {
</a><a href="#h60-0-112" id="h60-0-112" class="i">+                source: Scan {
</a><a href="#h60-0-113" id="h60-0-113" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h60-0-114" id="h60-0-114" class="i">+                    alias: None,
</a><a href="#h60-0-115" id="h60-0-115" class="i">+                },
</a><a href="#h60-0-116" id="h60-0-116" class="i">+                labels: [
</a><a href="#h60-0-117" id="h60-0-117" class="i">+                    None,
</a><a href="#h60-0-118" id="h60-0-118" class="i">+                    None,
</a><a href="#h60-0-119" id="h60-0-119" class="i">+                ],
</a><a href="#h60-0-120" id="h60-0-120" class="i">+                expressions: [
</a><a href="#h60-0-121" id="h60-0-121" class="i">+                    Field(
</a><a href="#h60-0-122" id="h60-0-122" class="i">+                        None,
</a><a href="#h60-0-123" id="h60-0-123" class="i">+                        &quot;id&quot;,
</a><a href="#h60-0-124" id="h60-0-124" class="i">+                    ),
</a><a href="#h60-0-125" id="h60-0-125" class="i">+                    Field(
</a><a href="#h60-0-126" id="h60-0-126" class="i">+                        None,
</a><a href="#h60-0-127" id="h60-0-127" class="i">+                        &quot;rating&quot;,
</a><a href="#h60-0-128" id="h60-0-128" class="i">+                    ),
</a><a href="#h60-0-129" id="h60-0-129" class="i">+                ],
</a><a href="#h60-0-130" id="h60-0-130" class="i">+            },
</a><a href="#h60-0-131" id="h60-0-131" class="i">+            predicate: GreaterThan(
</a><a href="#h60-0-132" id="h60-0-132" class="i">+                Field(
</a><a href="#h60-0-133" id="h60-0-133" class="i">+                    None,
</a><a href="#h60-0-134" id="h60-0-134" class="i">+                    &quot;rating&quot;,
</a><a href="#h60-0-135" id="h60-0-135" class="i">+                ),
</a><a href="#h60-0-136" id="h60-0-136" class="i">+                Constant(
</a><a href="#h60-0-137" id="h60-0-137" class="i">+                    Integer(
</a><a href="#h60-0-138" id="h60-0-138" class="i">+                        8,
</a><a href="#h60-0-139" id="h60-0-139" class="i">+                    ),
</a><a href="#h60-0-140" id="h60-0-140" class="i">+                ),
</a><a href="#h60-0-141" id="h60-0-141" class="i">+            ),
</a><a href="#h60-0-142" id="h60-0-142" class="i">+        },
</a><a href="#h60-0-143" id="h60-0-143" class="i">+        orders: [
</a><a href="#h60-0-144" id="h60-0-144" class="i">+            (
</a><a href="#h60-0-145" id="h60-0-145" class="i">+                Field(
</a><a href="#h60-0-146" id="h60-0-146" class="i">+                    None,
</a><a href="#h60-0-147" id="h60-0-147" class="i">+                    &quot;id&quot;,
</a><a href="#h60-0-148" id="h60-0-148" class="i">+                ),
</a><a href="#h60-0-149" id="h60-0-149" class="i">+                Ascending,
</a><a href="#h60-0-150" id="h60-0-150" class="i">+            ),
</a><a href="#h60-0-151" id="h60-0-151" class="i">+        ],
</a><a href="#h60-0-152" id="h60-0-152" class="i">+    },
</a><a href="#h60-0-153" id="h60-0-153" class="i">+}
</a><a href="#h60-0-154" id="h60-0-154" class="i">+
</a><a href="#h60-0-155" id="h60-0-155" class="i">+Query: SELECT id, rating FROM movies HAVING rating &gt; 8 ORDER BY id
</a><a href="#h60-0-156" id="h60-0-156" class="i">+
</a><a href="#h60-0-157" id="h60-0-157" class="i">+Result: [&quot;id&quot;, &quot;rating&quot;]
</a><a href="#h60-0-158" id="h60-0-158" class="i">+[Integer(1), Float(8.2)]
</a><a href="#h60-0-159" id="h60-0-159" class="i">+[Integer(4), Float(8.2)]
</a><a href="#h60-0-160" id="h60-0-160" class="i">+[Integer(6), Float(8.1)]
</a><a href="#h60-0-161" id="h60-0-161" class="i">+[Integer(10), Float(8.8)]
</a><b>diff --git a/<a id="h61" href="../file/src/sql/tests/query/join_cross.html">src/sql/tests/query/join_cross</a> b/<a href="../file/src/sql/tests/query/join_cross.html">src/sql/tests/query/join_cross</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -24,6 +24,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h61-0-3" id="h61-0-3" class="i">+    group_by: None,
</a><a href="#h61-0-4" id="h61-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h61-1" id="h61-1" class="h">@@ -64,13 +66,33 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies CROSS JOIN genres
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<a href="#h61-1-3" id="h61-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h61-1-4" id="h61-1-4" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h61-1-5" id="h61-1-5" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h61-1-6" id="h61-1-6" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;)]
</a><a href="#h61-1-7" id="h61-1-7" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<a href="#h61-1-10" id="h61-1-10" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a> [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(2), String(&quot;Action&quot;)]
<a href="#h61-1-13" id="h61-1-13" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;)]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<a href="#h61-1-16" id="h61-1-16" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(2), String(&quot;Action&quot;)]
<a href="#h61-1-19" id="h61-1-19" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h61-1-20" id="h61-1-20" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h61-1-21" id="h61-1-21" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;)]
</a><a href="#h61-1-22" id="h61-1-22" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h61-1-23" id="h61-1-23" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h61-1-24" id="h61-1-24" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h61-1-25" id="h61-1-25" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h61-1-26" id="h61-1-26" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h61-1-27" id="h61-1-27" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h61-1-28" id="h61-1-28" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h61-1-29" id="h61-1-29" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h61-1-30" id="h61-1-30" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h61-1-31" id="h61-1-31" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h61-1-32" id="h61-1-32" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h61-1-33" id="h61-1-33" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h61-1-34" id="h61-1-34" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><b>diff --git a/<a id="h62" href="../file/src/sql/tests/query/join_cross_alias.html">src/sql/tests/query/join_cross_alias</a> b/<a href="../file/src/sql/tests/query/join_cross_alias.html">src/sql/tests/query/join_cross_alias</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -142,6 +142,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h62-0-3" id="h62-0-3" class="i">+    group_by: None,
</a><a href="#h62-0-4" id="h62-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h62-1" id="h62-1" class="h">@@ -442,3 +444,13 @@ Result: [&quot;id&quot;, &quot;title&quot;, &quot;id&quot;, &quot;name&quot;, &quot;id&quot;, &quot;name&quot;]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
<a href="#h62-1-3" id="h62-1-3" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h62-1-4" id="h62-1-4" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h62-1-5" id="h62-1-5" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h62-1-6" id="h62-1-6" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h62-1-7" id="h62-1-7" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h62-1-8" id="h62-1-8" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h62-1-9" id="h62-1-9" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h62-1-10" id="h62-1-10" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><a href="#h62-1-11" id="h62-1-11" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;)]
</a><a href="#h62-1-12" id="h62-1-12" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;)]
</a><b>diff --git a/<a id="h63" href="../file/src/sql/tests/query/join_cross_multi.html">src/sql/tests/query/join_cross_multi</a> b/<a href="../file/src/sql/tests/query/join_cross_multi.html">src/sql/tests/query/join_cross_multi</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -40,6 +40,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h63-0-3" id="h63-0-3" class="i">+    group_by: None,
</a><a href="#h63-0-4" id="h63-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h63-1" id="h63-1" class="h">@@ -116,30 +118,42 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies CROSS JOIN genres CROSS JOIN countries CROSS JOIN studios
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;, &quot;id&quot;, &quot;name&quot;, &quot;id&quot;, &quot;name&quot;, &quot;country_id&quot;]
<a href="#h63-1-3" id="h63-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-4" id="h63-1-4" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-5" id="h63-1-5" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-6" id="h63-1-6" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-7" id="h63-1-7" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-8" id="h63-1-8" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-9" id="h63-1-9" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-10" id="h63-1-10" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-11" id="h63-1-11" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-12" id="h63-1-12" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-13" id="h63-1-13" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-14" id="h63-1-14" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-15" id="h63-1-15" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-16" id="h63-1-16" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-17" id="h63-1-17" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-18" id="h63-1-18" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-19" id="h63-1-19" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-20" id="h63-1-20" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-21" id="h63-1-21" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-22" id="h63-1-22" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-23" id="h63-1-23" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-24" id="h63-1-24" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-25" id="h63-1-25" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-26" id="h63-1-26" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-27" id="h63-1-27" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-28" id="h63-1-28" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-29" id="h63-1-29" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-30" id="h63-1-30" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-31" id="h63-1-31" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-32" id="h63-1-32" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-33" id="h63-1-33" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-34" id="h63-1-34" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-35" id="h63-1-35" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-36" id="h63-1-36" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-37" id="h63-1-37" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-38" id="h63-1-38" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-39" id="h63-1-39" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-40" id="h63-1-40" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-41" id="h63-1-41" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-42" id="h63-1-42" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-43" id="h63-1-43" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-44" id="h63-1-44" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-45" id="h63-1-45" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-46" id="h63-1-46" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-47" id="h63-1-47" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-48" id="h63-1-48" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-49" id="h63-1-49" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-50" id="h63-1-50" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-51" id="h63-1-51" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-52" id="h63-1-52" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-53" id="h63-1-53" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-54" id="h63-1-54" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-55" id="h63-1-55" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-56" id="h63-1-56" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-57" id="h63-1-57" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-58" id="h63-1-58" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-59" id="h63-1-59" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-1-60" id="h63-1-60" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-1-61" id="h63-1-61" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-1-62" id="h63-1-62" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
<a href="#h63-2" id="h63-2" class="h">@@ -164,6 +178,18 @@ Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
<a href="#h63-2-3" id="h63-2-3" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-2-4" id="h63-2-4" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-2-5" id="h63-2-5" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-2-6" id="h63-2-6" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-2-7" id="h63-2-7" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-2-8" id="h63-2-8" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-2-9" id="h63-2-9" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-2-10" id="h63-2-10" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-2-11" id="h63-2-11" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-2-12" id="h63-2-12" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-2-13" id="h63-2-13" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-2-14" id="h63-2-14" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a> [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
<a href="#h63-3" id="h63-3" class="h">@@ -188,6 +214,18 @@ Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;
</a> [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
<a href="#h63-3-3" id="h63-3-3" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-3-4" id="h63-3-4" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-3-5" id="h63-3-5" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-3-6" id="h63-3-6" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-3-7" id="h63-3-7" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-3-8" id="h63-3-8" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-3-9" id="h63-3-9" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-3-10" id="h63-3-10" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-3-11" id="h63-3-11" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-3-12" id="h63-3-12" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-3-13" id="h63-3-13" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-3-14" id="h63-3-14" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
<a href="#h63-4" id="h63-4" class="h">@@ -212,6 +250,18 @@ Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
<a href="#h63-4-3" id="h63-4-3" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-4-4" id="h63-4-4" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-4-5" id="h63-4-5" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-4-6" id="h63-4-6" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-4-7" id="h63-4-7" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-4-8" id="h63-4-8" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-4-9" id="h63-4-9" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-4-10" id="h63-4-10" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-4-11" id="h63-4-11" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-4-12" id="h63-4-12" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-4-13" id="h63-4-13" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-4-14" id="h63-4-14" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
<a href="#h63-5" id="h63-5" class="h">@@ -236,3 +286,195 @@ Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
<a href="#h63-5-3" id="h63-5-3" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-4" id="h63-5-4" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-5" id="h63-5-5" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-6" id="h63-5-6" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-7" id="h63-5-7" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-8" id="h63-5-8" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-9" id="h63-5-9" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-10" id="h63-5-10" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-11" id="h63-5-11" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-12" id="h63-5-12" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-13" id="h63-5-13" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-14" id="h63-5-14" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-15" id="h63-5-15" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-16" id="h63-5-16" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-17" id="h63-5-17" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-18" id="h63-5-18" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-19" id="h63-5-19" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-20" id="h63-5-20" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-21" id="h63-5-21" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-22" id="h63-5-22" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-23" id="h63-5-23" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-24" id="h63-5-24" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-25" id="h63-5-25" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-26" id="h63-5-26" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-27" id="h63-5-27" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-28" id="h63-5-28" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-29" id="h63-5-29" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-30" id="h63-5-30" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-31" id="h63-5-31" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-32" id="h63-5-32" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-33" id="h63-5-33" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-34" id="h63-5-34" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-35" id="h63-5-35" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-36" id="h63-5-36" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-37" id="h63-5-37" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-38" id="h63-5-38" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-39" id="h63-5-39" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-40" id="h63-5-40" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-41" id="h63-5-41" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-42" id="h63-5-42" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-43" id="h63-5-43" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-44" id="h63-5-44" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-45" id="h63-5-45" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-46" id="h63-5-46" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-47" id="h63-5-47" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-48" id="h63-5-48" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-49" id="h63-5-49" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-50" id="h63-5-50" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-51" id="h63-5-51" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-52" id="h63-5-52" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-53" id="h63-5-53" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-54" id="h63-5-54" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-55" id="h63-5-55" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-56" id="h63-5-56" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-57" id="h63-5-57" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-58" id="h63-5-58" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-59" id="h63-5-59" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-60" id="h63-5-60" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-61" id="h63-5-61" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-62" id="h63-5-62" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-63" id="h63-5-63" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-64" id="h63-5-64" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-65" id="h63-5-65" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-66" id="h63-5-66" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-67" id="h63-5-67" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-68" id="h63-5-68" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-69" id="h63-5-69" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-70" id="h63-5-70" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-71" id="h63-5-71" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-72" id="h63-5-72" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-73" id="h63-5-73" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-74" id="h63-5-74" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-75" id="h63-5-75" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-76" id="h63-5-76" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-77" id="h63-5-77" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-78" id="h63-5-78" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-79" id="h63-5-79" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-80" id="h63-5-80" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-81" id="h63-5-81" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-82" id="h63-5-82" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-83" id="h63-5-83" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-84" id="h63-5-84" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-85" id="h63-5-85" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-86" id="h63-5-86" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-87" id="h63-5-87" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-88" id="h63-5-88" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-89" id="h63-5-89" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-90" id="h63-5-90" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-91" id="h63-5-91" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-92" id="h63-5-92" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-93" id="h63-5-93" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-94" id="h63-5-94" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-95" id="h63-5-95" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-96" id="h63-5-96" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-97" id="h63-5-97" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-98" id="h63-5-98" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-99" id="h63-5-99" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-100" id="h63-5-100" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-101" id="h63-5-101" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-102" id="h63-5-102" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-103" id="h63-5-103" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-104" id="h63-5-104" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-105" id="h63-5-105" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-106" id="h63-5-106" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-107" id="h63-5-107" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-108" id="h63-5-108" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-109" id="h63-5-109" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-110" id="h63-5-110" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-111" id="h63-5-111" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-112" id="h63-5-112" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-113" id="h63-5-113" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-114" id="h63-5-114" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-115" id="h63-5-115" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-116" id="h63-5-116" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-117" id="h63-5-117" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-118" id="h63-5-118" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-119" id="h63-5-119" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-120" id="h63-5-120" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-121" id="h63-5-121" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-122" id="h63-5-122" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-123" id="h63-5-123" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-124" id="h63-5-124" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-125" id="h63-5-125" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-126" id="h63-5-126" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-127" id="h63-5-127" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-128" id="h63-5-128" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-129" id="h63-5-129" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-130" id="h63-5-130" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-131" id="h63-5-131" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-132" id="h63-5-132" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-133" id="h63-5-133" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-134" id="h63-5-134" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-135" id="h63-5-135" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-136" id="h63-5-136" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-137" id="h63-5-137" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-138" id="h63-5-138" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-139" id="h63-5-139" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-140" id="h63-5-140" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-141" id="h63-5-141" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-142" id="h63-5-142" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-143" id="h63-5-143" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-144" id="h63-5-144" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-145" id="h63-5-145" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-146" id="h63-5-146" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-147" id="h63-5-147" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-148" id="h63-5-148" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-149" id="h63-5-149" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-150" id="h63-5-150" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-151" id="h63-5-151" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-152" id="h63-5-152" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-153" id="h63-5-153" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-154" id="h63-5-154" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-155" id="h63-5-155" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-156" id="h63-5-156" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-157" id="h63-5-157" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-158" id="h63-5-158" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-159" id="h63-5-159" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-160" id="h63-5-160" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-161" id="h63-5-161" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-162" id="h63-5-162" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-163" id="h63-5-163" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-164" id="h63-5-164" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-165" id="h63-5-165" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-166" id="h63-5-166" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-167" id="h63-5-167" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-168" id="h63-5-168" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-169" id="h63-5-169" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-170" id="h63-5-170" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-171" id="h63-5-171" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-172" id="h63-5-172" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-173" id="h63-5-173" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-174" id="h63-5-174" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-175" id="h63-5-175" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-176" id="h63-5-176" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-177" id="h63-5-177" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-178" id="h63-5-178" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-179" id="h63-5-179" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-180" id="h63-5-180" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-181" id="h63-5-181" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-182" id="h63-5-182" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-183" id="h63-5-183" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-184" id="h63-5-184" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-185" id="h63-5-185" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-186" id="h63-5-186" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;fr&quot;), String(&quot;France&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-187" id="h63-5-187" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-188" id="h63-5-188" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-189" id="h63-5-189" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-190" id="h63-5-190" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;ru&quot;), String(&quot;Russia&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-191" id="h63-5-191" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(1), String(&quot;Mosfilm&quot;), String(&quot;ru&quot;)]
</a><a href="#h63-5-192" id="h63-5-192" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(2), String(&quot;Lionsgate&quot;), String(&quot;us&quot;)]
</a><a href="#h63-5-193" id="h63-5-193" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(3), String(&quot;StudioCanal&quot;), String(&quot;fr&quot;)]
</a><a href="#h63-5-194" id="h63-5-194" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;), String(&quot;us&quot;), String(&quot;United States of America&quot;), Integer(4), String(&quot;Warner Bros&quot;), String(&quot;us&quot;)]
</a><b>diff --git a/<a id="h64" href="../file/src/sql/tests/query/join_inner.html">src/sql/tests/query/join_inner</a> b/<a href="../file/src/sql/tests/query/join_inner.html">src/sql/tests/query/join_inner</a></b>
<a href="#h64-0" id="h64-0" class="h">@@ -41,6 +41,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h64-0-3" id="h64-0-3" class="i">+    group_by: None,
</a><a href="#h64-0-4" id="h64-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h64-1" id="h64-1" class="h">@@ -111,8 +113,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies INNER JOIN genres ON movies.genre_id = genres.id
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<a href="#h64-1-3" id="h64-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h64-1-4" id="h64-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
<a href="#h64-1-9" id="h64-1-9" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h64-1-10" id="h64-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h64-1-11" id="h64-1-11" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h64-1-12" id="h64-1-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h64-1-13" id="h64-1-13" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><b>diff --git a/<a id="h65" href="../file/src/sql/tests/query/join_inner_implicit.html">src/sql/tests/query/join_inner_implicit</a> b/<a href="../file/src/sql/tests/query/join_inner_implicit.html">src/sql/tests/query/join_inner_implicit</a></b>
<a href="#h65-0" id="h65-0" class="h">@@ -41,6 +41,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h65-0-3" id="h65-0-3" class="i">+    group_by: None,
</a><a href="#h65-0-4" id="h65-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h65-1" id="h65-1" class="h">@@ -111,8 +113,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies JOIN genres ON movies.genre_id = genres.id
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<a href="#h65-1-3" id="h65-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h65-1-4" id="h65-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
<a href="#h65-1-9" id="h65-1-9" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h65-1-10" id="h65-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h65-1-11" id="h65-1-11" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h65-1-12" id="h65-1-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h65-1-13" id="h65-1-13" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><b>diff --git a/<a id="h66" href="../file/src/sql/tests/query/join_inner_multi.html">src/sql/tests/query/join_inner_multi</a> b/<a href="../file/src/sql/tests/query/join_inner_multi.html">src/sql/tests/query/join_inner_multi</a></b>
<a href="#h66-0" id="h66-0" class="h">@@ -97,6 +97,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h66-0-3" id="h66-0-3" class="i">+    group_by: None,
</a><a href="#h66-0-4" id="h66-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h66-1" id="h66-1" class="h">@@ -286,3 +288,8 @@ Result: [&quot;title&quot;, &quot;genre&quot;, &quot;studio&quot;]
</a> [String(&quot;Primer&quot;), String(&quot;Science Fiction&quot;), String(&quot;StudioCanal&quot;)]
 [String(&quot;Heat&quot;), String(&quot;Action&quot;), String(&quot;Warner Bros&quot;)]
 [String(&quot;The Fountain&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
<a href="#h66-1-3" id="h66-1-3" class="i">+[String(&quot;Solaris&quot;), String(&quot;Science Fiction&quot;), String(&quot;Mosfilm&quot;)]
</a><a href="#h66-1-4" id="h66-1-4" class="i">+[String(&quot;Gravity&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
</a><a href="#h66-1-5" id="h66-1-5" class="i">+[String(&quot;Blindspotting&quot;), String(&quot;Comedy&quot;), String(&quot;Lionsgate&quot;)]
</a><a href="#h66-1-6" id="h66-1-6" class="i">+[String(&quot;Birdman&quot;), String(&quot;Comedy&quot;), String(&quot;Warner Bros&quot;)]
</a><a href="#h66-1-7" id="h66-1-7" class="i">+[String(&quot;Inception&quot;), String(&quot;Science Fiction&quot;), String(&quot;Warner Bros&quot;)]
</a><b>diff --git a/<a id="h67" href="../file/src/sql/tests/query/join_inner_on_aliased.html">src/sql/tests/query/join_inner_on_aliased</a> b/<a href="../file/src/sql/tests/query/join_inner_on_aliased.html">src/sql/tests/query/join_inner_on_aliased</a></b>
<a href="#h67-0" id="h67-0" class="h">@@ -45,6 +45,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h67-0-3" id="h67-0-3" class="i">+    group_by: None,
</a><a href="#h67-0-4" id="h67-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h67-1" id="h67-1" class="h">@@ -123,8 +125,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies m INNER JOIN genres g ON m.genre_id = g.id
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<a href="#h67-1-3" id="h67-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h67-1-4" id="h67-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
<a href="#h67-1-9" id="h67-1-9" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h67-1-10" id="h67-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h67-1-11" id="h67-1-11" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h67-1-12" id="h67-1-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h67-1-13" id="h67-1-13" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><b>diff --git a/<a id="h68" href="../file/src/sql/tests/query/join_inner_on_false.html">src/sql/tests/query/join_inner_on_false</a> b/<a href="../file/src/sql/tests/query/join_inner_on_false.html">src/sql/tests/query/join_inner_on_false</a></b>
<a href="#h68-0" id="h68-0" class="h">@@ -30,6 +30,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h68-0-3" id="h68-0-3" class="i">+    group_by: None,
</a><a href="#h68-0-4" id="h68-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h69" href="../file/src/sql/tests/query/join_inner_on_multi.html">src/sql/tests/query/join_inner_on_multi</a> b/<a href="../file/src/sql/tests/query/join_inner_on_multi.html">src/sql/tests/query/join_inner_on_multi</a></b>
<a href="#h69-0" id="h69-0" class="h">@@ -61,6 +61,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h69-0-3" id="h69-0-3" class="i">+    group_by: None,
</a><a href="#h69-0-4" id="h69-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h69-1" id="h69-1" class="h">@@ -163,5 +165,5 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies INNER JOIN genres ON movies.genre_id = genres.id AND movies.id = genres.id
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<a href="#h69-1-3" id="h69-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h69-1-4" id="h69-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<b>diff --git a/<a id="h70" href="../file/src/sql/tests/query/join_inner_on_true.html">src/sql/tests/query/join_inner_on_true</a> b/<a href="../file/src/sql/tests/query/join_inner_on_true.html">src/sql/tests/query/join_inner_on_true</a></b>
<a href="#h70-0" id="h70-0" class="h">@@ -30,6 +30,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h70-0-3" id="h70-0-3" class="i">+    group_by: None,
</a><a href="#h70-0-4" id="h70-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h70-1" id="h70-1" class="h">@@ -82,13 +84,33 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies INNER JOIN genres ON TRUE
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<a href="#h70-1-3" id="h70-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h70-1-4" id="h70-1-4" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h70-1-5" id="h70-1-5" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h70-1-6" id="h70-1-6" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(2), String(&quot;Action&quot;)]
</a><a href="#h70-1-7" id="h70-1-7" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(3), String(&quot;Comedy&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<a href="#h70-1-10" id="h70-1-10" class="i">+[Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a> [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(2), String(&quot;Action&quot;)]
<a href="#h70-1-13" id="h70-1-13" class="i">+[Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(3), String(&quot;Comedy&quot;)]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
<a href="#h70-1-16" id="h70-1-16" class="i">+[Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(2), String(&quot;Action&quot;)]
<a href="#h70-1-19" id="h70-1-19" class="i">+[Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h70-1-20" id="h70-1-20" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h70-1-21" id="h70-1-21" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(2), String(&quot;Action&quot;)]
</a><a href="#h70-1-22" id="h70-1-22" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h70-1-23" id="h70-1-23" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h70-1-24" id="h70-1-24" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h70-1-25" id="h70-1-25" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h70-1-26" id="h70-1-26" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h70-1-27" id="h70-1-27" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h70-1-28" id="h70-1-28" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h70-1-29" id="h70-1-29" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h70-1-30" id="h70-1-30" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h70-1-31" id="h70-1-31" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h70-1-32" id="h70-1-32" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h70-1-33" id="h70-1-33" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(2), String(&quot;Action&quot;)]
</a><a href="#h70-1-34" id="h70-1-34" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><b>diff --git a/<a id="h71" href="../file/src/sql/tests/query/join_inner_on_where.html">src/sql/tests/query/join_inner_on_where</a> b/<a href="../file/src/sql/tests/query/join_inner_on_where.html">src/sql/tests/query/join_inner_on_where</a></b>
<a href="#h71-0" id="h71-0" class="h">@@ -59,6 +59,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h71-0-3" id="h71-0-3" class="i">+    group_by: None,
</a><a href="#h71-0-4" id="h71-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h71-1" id="h71-1" class="h">@@ -192,3 +194,8 @@ Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;
</a> [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
<a href="#h71-1-3" id="h71-1-3" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h71-1-4" id="h71-1-4" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h71-1-5" id="h71-1-5" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h71-1-6" id="h71-1-6" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h71-1-7" id="h71-1-7" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><b>diff --git a/<a id="h72" href="../file/src/sql/tests/query/join_left.html">src/sql/tests/query/join_left</a> b/<a href="../file/src/sql/tests/query/join_left.html">src/sql/tests/query/join_left</a></b>
<a href="#h72-0" id="h72-0" class="h">@@ -65,6 +65,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h72-0-3" id="h72-0-3" class="i">+    group_by: None,
</a><a href="#h72-0-4" id="h72-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h72-1" id="h72-1" class="h">@@ -193,6 +195,11 @@ Query: SELECT m.id AS movie_id, g.id AS genre_id FROM movies m LEFT JOIN genres 
</a> Result: [&quot;movie_id&quot;, &quot;genre_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<a href="#h72-1-3" id="h72-1-3" class="d">-[Integer(3), Null]
</a><a href="#h72-1-4" id="h72-1-4" class="i">+[Integer(3), Integer(3)]
</a> [Integer(4), Null]
 [Integer(5), Null]
<a href="#h72-1-7" id="h72-1-7" class="i">+[Integer(6), Null]
</a><a href="#h72-1-8" id="h72-1-8" class="i">+[Integer(7), Null]
</a><a href="#h72-1-9" id="h72-1-9" class="i">+[Integer(8), Null]
</a><a href="#h72-1-10" id="h72-1-10" class="i">+[Integer(9), Null]
</a><a href="#h72-1-11" id="h72-1-11" class="i">+[Integer(10), Null]
</a><b>diff --git a/<a id="h73" href="../file/src/sql/tests/query/join_left_outer.html">src/sql/tests/query/join_left_outer</a> b/<a href="../file/src/sql/tests/query/join_left_outer.html">src/sql/tests/query/join_left_outer</a></b>
<a href="#h73-0" id="h73-0" class="h">@@ -65,6 +65,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h73-0-3" id="h73-0-3" class="i">+    group_by: None,
</a><a href="#h73-0-4" id="h73-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h73-1" id="h73-1" class="h">@@ -193,6 +195,11 @@ Query: SELECT m.id AS movie_id, g.id AS genre_id FROM movies m LEFT OUTER JOIN g
</a> Result: [&quot;movie_id&quot;, &quot;genre_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<a href="#h73-1-3" id="h73-1-3" class="d">-[Integer(3), Null]
</a><a href="#h73-1-4" id="h73-1-4" class="i">+[Integer(3), Integer(3)]
</a> [Integer(4), Null]
 [Integer(5), Null]
<a href="#h73-1-7" id="h73-1-7" class="i">+[Integer(6), Null]
</a><a href="#h73-1-8" id="h73-1-8" class="i">+[Integer(7), Null]
</a><a href="#h73-1-9" id="h73-1-9" class="i">+[Integer(8), Null]
</a><a href="#h73-1-10" id="h73-1-10" class="i">+[Integer(9), Null]
</a><a href="#h73-1-11" id="h73-1-11" class="i">+[Integer(10), Null]
</a><b>diff --git a/<a id="h74" href="../file/src/sql/tests/query/join_left_truncate.html">src/sql/tests/query/join_left_truncate</a> b/<a href="../file/src/sql/tests/query/join_left_truncate.html">src/sql/tests/query/join_left_truncate</a></b>
<a href="#h74-0" id="h74-0" class="h">@@ -65,6 +65,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h74-0-3" id="h74-0-3" class="i">+    group_by: None,
</a><a href="#h74-0-4" id="h74-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h74-1" id="h74-1" class="h">@@ -193,3 +195,4 @@ Query: SELECT g.id AS genre_id, m.id AS movie_id FROM genres g LEFT JOIN movies 
</a> Result: [&quot;genre_id&quot;, &quot;movie_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<a href="#h74-1-3" id="h74-1-3" class="i">+[Integer(3), Integer(3)]
</a><b>diff --git a/<a id="h75" href="../file/src/sql/tests/query/join_right.html">src/sql/tests/query/join_right</a> b/<a href="../file/src/sql/tests/query/join_right.html">src/sql/tests/query/join_right</a></b>
<a href="#h75-0" id="h75-0" class="h">@@ -65,6 +65,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h75-0-3" id="h75-0-3" class="i">+    group_by: None,
</a><a href="#h75-0-4" id="h75-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h75-1" id="h75-1" class="h">@@ -193,6 +195,11 @@ Query: SELECT g.id AS genre_id, m.id AS movie_id FROM genres g RIGHT JOIN movies
</a> Result: [&quot;genre_id&quot;, &quot;movie_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<a href="#h75-1-3" id="h75-1-3" class="d">-[Null, Integer(3)]
</a><a href="#h75-1-4" id="h75-1-4" class="i">+[Integer(3), Integer(3)]
</a> [Null, Integer(4)]
 [Null, Integer(5)]
<a href="#h75-1-7" id="h75-1-7" class="i">+[Null, Integer(6)]
</a><a href="#h75-1-8" id="h75-1-8" class="i">+[Null, Integer(7)]
</a><a href="#h75-1-9" id="h75-1-9" class="i">+[Null, Integer(8)]
</a><a href="#h75-1-10" id="h75-1-10" class="i">+[Null, Integer(9)]
</a><a href="#h75-1-11" id="h75-1-11" class="i">+[Null, Integer(10)]
</a><b>diff --git a/<a id="h76" href="../file/src/sql/tests/query/join_right_outer.html">src/sql/tests/query/join_right_outer</a> b/<a href="../file/src/sql/tests/query/join_right_outer.html">src/sql/tests/query/join_right_outer</a></b>
<a href="#h76-0" id="h76-0" class="h">@@ -65,6 +65,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h76-0-3" id="h76-0-3" class="i">+    group_by: None,
</a><a href="#h76-0-4" id="h76-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h76-1" id="h76-1" class="h">@@ -193,6 +195,11 @@ Query: SELECT g.id AS genre_id, m.id AS movie_id FROM genres g RIGHT OUTER JOIN 
</a> Result: [&quot;genre_id&quot;, &quot;movie_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<a href="#h76-1-3" id="h76-1-3" class="d">-[Null, Integer(3)]
</a><a href="#h76-1-4" id="h76-1-4" class="i">+[Integer(3), Integer(3)]
</a> [Null, Integer(4)]
 [Null, Integer(5)]
<a href="#h76-1-7" id="h76-1-7" class="i">+[Null, Integer(6)]
</a><a href="#h76-1-8" id="h76-1-8" class="i">+[Null, Integer(7)]
</a><a href="#h76-1-9" id="h76-1-9" class="i">+[Null, Integer(8)]
</a><a href="#h76-1-10" id="h76-1-10" class="i">+[Null, Integer(9)]
</a><a href="#h76-1-11" id="h76-1-11" class="i">+[Null, Integer(10)]
</a><b>diff --git a/<a id="h77" href="../file/src/sql/tests/query/join_right_truncate.html">src/sql/tests/query/join_right_truncate</a> b/<a href="../file/src/sql/tests/query/join_right_truncate.html">src/sql/tests/query/join_right_truncate</a></b>
<a href="#h77-0" id="h77-0" class="h">@@ -65,6 +65,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h77-0-3" id="h77-0-3" class="i">+    group_by: None,
</a><a href="#h77-0-4" id="h77-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h77-1" id="h77-1" class="h">@@ -193,3 +195,4 @@ Query: SELECT m.id AS movie_id, g.id AS genre_id FROM movies m RIGHT JOIN genres
</a> Result: [&quot;movie_id&quot;, &quot;genre_id&quot;]
 [Integer(1), Integer(1)]
 [Integer(2), Integer(2)]
<a href="#h77-1-3" id="h77-1-3" class="i">+[Integer(3), Integer(3)]
</a><b>diff --git a/<a id="h78" href="../file/src/sql/tests/query/limit.html">src/sql/tests/query/limit</a> b/<a href="../file/src/sql/tests/query/limit.html">src/sql/tests/query/limit</a></b>
<a href="#h78-0" id="h78-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h78-0-3" id="h78-0-3" class="i">+    group_by: None,
</a><a href="#h78-0-4" id="h78-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Literal(
<a href="#h78-1" id="h78-1" class="h">@@ -50,6 +52,6 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies LIMIT 3
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h78-1-3" id="h78-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h78-1-4" id="h78-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
<b>diff --git a/<a id="h79" href="../file/src/sql/tests/query/limit_boolean.html">src/sql/tests/query/limit_boolean</a> b/<a href="../file/src/sql/tests/query/limit_boolean.html">src/sql/tests/query/limit_boolean</a></b>
<a href="#h79-0" id="h79-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h79-0-3" id="h79-0-3" class="i">+    group_by: None,
</a><a href="#h79-0-4" id="h79-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Literal(
<b>diff --git a/<a id="h80" href="../file/src/sql/tests/query/limit_dynamic.html">src/sql/tests/query/limit_dynamic</a> b/<a href="../file/src/sql/tests/query/limit_dynamic.html">src/sql/tests/query/limit_dynamic</a></b>
<a href="#h80-0" id="h80-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h80-0-3" id="h80-0-3" class="i">+    group_by: None,
</a><a href="#h80-0-4" id="h80-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Operation(
<b>diff --git a/<a id="h81" href="../file/src/sql/tests/query/limit_expr.html">src/sql/tests/query/limit_expr</a> b/<a href="../file/src/sql/tests/query/limit_expr.html">src/sql/tests/query/limit_expr</a></b>
<a href="#h81-0" id="h81-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h81-0-3" id="h81-0-3" class="i">+    group_by: None,
</a><a href="#h81-0-4" id="h81-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Operation(
<a href="#h81-1" id="h81-1" class="h">@@ -59,6 +61,6 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies LIMIT 1 + 2
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h81-1-3" id="h81-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h81-1-4" id="h81-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
<b>diff --git a/<a id="h82" href="../file/src/sql/tests/query/limit_float.html">src/sql/tests/query/limit_float</a> b/<a href="../file/src/sql/tests/query/limit_float.html">src/sql/tests/query/limit_float</a></b>
<a href="#h82-0" id="h82-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h82-0-3" id="h82-0-3" class="i">+    group_by: None,
</a><a href="#h82-0-4" id="h82-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Literal(
<b>diff --git a/<a id="h83" href="../file/src/sql/tests/query/limit_large.html">src/sql/tests/query/limit_large</a> b/<a href="../file/src/sql/tests/query/limit_large.html">src/sql/tests/query/limit_large</a></b>
<a href="#h83-0" id="h83-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h83-0-3" id="h83-0-3" class="i">+    group_by: None,
</a><a href="#h83-0-4" id="h83-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Literal(
<a href="#h83-1" id="h83-1" class="h">@@ -50,8 +52,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies LIMIT 9223372036854775807
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h83-1-3" id="h83-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h83-1-4" id="h83-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h83-1-9" id="h83-1-9" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h83-1-10" id="h83-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h83-1-11" id="h83-1-11" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><a href="#h83-1-12" id="h83-1-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h83-1-13" id="h83-1-13" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><b>diff --git a/<a id="h84" href="../file/src/sql/tests/query/limit_neg.html">src/sql/tests/query/limit_neg</a> b/<a href="../file/src/sql/tests/query/limit_neg.html">src/sql/tests/query/limit_neg</a></b>
<a href="#h84-0" id="h84-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h84-0-3" id="h84-0-3" class="i">+    group_by: None,
</a><a href="#h84-0-4" id="h84-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Operation(
<b>diff --git a/<a id="h85" href="../file/src/sql/tests/query/limit_null.html">src/sql/tests/query/limit_null</a> b/<a href="../file/src/sql/tests/query/limit_null.html">src/sql/tests/query/limit_null</a></b>
<a href="#h85-0" id="h85-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h85-0-3" id="h85-0-3" class="i">+    group_by: None,
</a><a href="#h85-0-4" id="h85-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Literal(
<b>diff --git a/<a id="h86" href="../file/src/sql/tests/query/limit_offset.html">src/sql/tests/query/limit_offset</a> b/<a href="../file/src/sql/tests/query/limit_offset.html">src/sql/tests/query/limit_offset</a></b>
<a href="#h86-0" id="h86-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h86-0-3" id="h86-0-3" class="i">+    group_by: None,
</a><a href="#h86-0-4" id="h86-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Literal(
<b>diff --git a/<a id="h87" href="../file/src/sql/tests/query/limit_string.html">src/sql/tests/query/limit_string</a> b/<a href="../file/src/sql/tests/query/limit_string.html">src/sql/tests/query/limit_string</a></b>
<a href="#h87-0" id="h87-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h87-0-3" id="h87-0-3" class="i">+    group_by: None,
</a><a href="#h87-0-4" id="h87-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Literal(
<b>diff --git a/<a id="h88" href="../file/src/sql/tests/query/limit_zero.html">src/sql/tests/query/limit_zero</a> b/<a href="../file/src/sql/tests/query/limit_zero.html">src/sql/tests/query/limit_zero</a></b>
<a href="#h88-0" id="h88-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h88-0-3" id="h88-0-3" class="i">+    group_by: None,
</a><a href="#h88-0-4" id="h88-0-4" class="i">+    having: None,
</a>     order: [],
     limit: Some(
         Literal(
<b>diff --git a/<a id="h89" href="../file/src/sql/tests/query/lowercase.html">src/sql/tests/query/lowercase</a> b/<a href="../file/src/sql/tests/query/lowercase.html">src/sql/tests/query/lowercase</a></b>
<a href="#h89-0" id="h89-0" class="h">@@ -15,6 +15,8 @@ AST: Select {
</a>     },
     from: None,
     where: None,
<a href="#h89-0-3" id="h89-0-3" class="i">+    group_by: None,
</a><a href="#h89-0-4" id="h89-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h90" href="../file/src/sql/tests/query/offset.html">src/sql/tests/query/offset</a> b/<a href="../file/src/sql/tests/query/offset.html">src/sql/tests/query/offset</a></b>
<a href="#h90-0" id="h90-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h90-0-3" id="h90-0-3" class="i">+    group_by: None,
</a><a href="#h90-0-4" id="h90-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<a href="#h90-1" id="h90-1" class="h">@@ -52,3 +54,8 @@ Query: SELECT * FROM movies OFFSET 3
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h90-1-3" id="h90-1-3" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h90-1-4" id="h90-1-4" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h90-1-5" id="h90-1-5" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><a href="#h90-1-6" id="h90-1-6" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h90-1-7" id="h90-1-7" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><b>diff --git a/<a id="h91" href="../file/src/sql/tests/query/offset_boolean.html">src/sql/tests/query/offset_boolean</a> b/<a href="../file/src/sql/tests/query/offset_boolean.html">src/sql/tests/query/offset_boolean</a></b>
<a href="#h91-0" id="h91-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h91-0-3" id="h91-0-3" class="i">+    group_by: None,
</a><a href="#h91-0-4" id="h91-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<b>diff --git a/<a id="h92" href="../file/src/sql/tests/query/offset_dynamic.html">src/sql/tests/query/offset_dynamic</a> b/<a href="../file/src/sql/tests/query/offset_dynamic.html">src/sql/tests/query/offset_dynamic</a></b>
<a href="#h92-0" id="h92-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h92-0-3" id="h92-0-3" class="i">+    group_by: None,
</a><a href="#h92-0-4" id="h92-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<b>diff --git a/<a id="h93" href="../file/src/sql/tests/query/offset_expr.html">src/sql/tests/query/offset_expr</a> b/<a href="../file/src/sql/tests/query/offset_expr.html">src/sql/tests/query/offset_expr</a></b>
<a href="#h93-0" id="h93-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h93-0-3" id="h93-0-3" class="i">+    group_by: None,
</a><a href="#h93-0-4" id="h93-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<a href="#h93-1" id="h93-1" class="h">@@ -61,3 +63,8 @@ Query: SELECT * FROM movies OFFSET 1 + 2
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h93-1-3" id="h93-1-3" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h93-1-4" id="h93-1-4" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h93-1-5" id="h93-1-5" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><a href="#h93-1-6" id="h93-1-6" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h93-1-7" id="h93-1-7" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><b>diff --git a/<a id="h94" href="../file/src/sql/tests/query/offset_float.html">src/sql/tests/query/offset_float</a> b/<a href="../file/src/sql/tests/query/offset_float.html">src/sql/tests/query/offset_float</a></b>
<a href="#h94-0" id="h94-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h94-0-3" id="h94-0-3" class="i">+    group_by: None,
</a><a href="#h94-0-4" id="h94-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<b>diff --git a/<a id="h95" href="../file/src/sql/tests/query/offset_large.html">src/sql/tests/query/offset_large</a> b/<a href="../file/src/sql/tests/query/offset_large.html">src/sql/tests/query/offset_large</a></b>
<a href="#h95-0" id="h95-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h95-0-3" id="h95-0-3" class="i">+    group_by: None,
</a><a href="#h95-0-4" id="h95-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<b>diff --git a/<a id="h96" href="../file/src/sql/tests/query/offset_neg.html">src/sql/tests/query/offset_neg</a> b/<a href="../file/src/sql/tests/query/offset_neg.html">src/sql/tests/query/offset_neg</a></b>
<a href="#h96-0" id="h96-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h96-0-3" id="h96-0-3" class="i">+    group_by: None,
</a><a href="#h96-0-4" id="h96-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<b>diff --git a/<a id="h97" href="../file/src/sql/tests/query/offset_null.html">src/sql/tests/query/offset_null</a> b/<a href="../file/src/sql/tests/query/offset_null.html">src/sql/tests/query/offset_null</a></b>
<a href="#h97-0" id="h97-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h97-0-3" id="h97-0-3" class="i">+    group_by: None,
</a><a href="#h97-0-4" id="h97-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<b>diff --git a/<a id="h98" href="../file/src/sql/tests/query/offset_string.html">src/sql/tests/query/offset_string</a> b/<a href="../file/src/sql/tests/query/offset_string.html">src/sql/tests/query/offset_string</a></b>
<a href="#h98-0" id="h98-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h98-0-3" id="h98-0-3" class="i">+    group_by: None,
</a><a href="#h98-0-4" id="h98-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<b>diff --git a/<a id="h99" href="../file/src/sql/tests/query/offset_zero.html">src/sql/tests/query/offset_zero</a> b/<a href="../file/src/sql/tests/query/offset_zero.html">src/sql/tests/query/offset_zero</a></b>
<a href="#h99-0" id="h99-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h99-0-3" id="h99-0-3" class="i">+    group_by: None,
</a><a href="#h99-0-4" id="h99-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: Some(
<a href="#h99-1" id="h99-1" class="h">@@ -50,8 +52,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies OFFSET 0
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h99-1-3" id="h99-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h99-1-4" id="h99-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h99-1-9" id="h99-1-9" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h99-1-10" id="h99-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h99-1-11" id="h99-1-11" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><a href="#h99-1-12" id="h99-1-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h99-1-13" id="h99-1-13" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><b>diff --git a/<a id="h100" href="../file/src/sql/tests/query/order.html">src/sql/tests/query/order</a> b/<a href="../file/src/sql/tests/query/order.html">src/sql/tests/query/order</a></b>
<a href="#h100-0" id="h100-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h100-0-3" id="h100-0-3" class="i">+    group_by: None,
</a><a href="#h100-0-4" id="h100-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h100-1" id="h100-1" class="h">@@ -68,8 +70,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies ORDER BY released
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h100-1-3" id="h100-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h100-1-4" id="h100-1-4" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h100-1-5" id="h100-1-5" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h100-1-9" id="h100-1-9" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><a href="#h100-1-10" id="h100-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h100-1-11" id="h100-1-11" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h100-1-13" id="h100-1-13" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><b>diff --git a/<a id="h101" href="../file/src/sql/tests/query/order_asc.html">src/sql/tests/query/order_asc</a> b/<a href="../file/src/sql/tests/query/order_asc.html">src/sql/tests/query/order_asc</a></b>
<a href="#h101-0" id="h101-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h101-0-3" id="h101-0-3" class="i">+    group_by: None,
</a><a href="#h101-0-4" id="h101-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h101-1" id="h101-1" class="h">@@ -68,8 +70,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies ORDER BY released ASC
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h101-1-3" id="h101-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h101-1-4" id="h101-1-4" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h101-1-5" id="h101-1-5" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h101-1-9" id="h101-1-9" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><a href="#h101-1-10" id="h101-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h101-1-11" id="h101-1-11" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h101-1-13" id="h101-1-13" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><b>diff --git a/<a id="h102" href="../file/src/sql/tests/query/order_asc_lowercase.html">src/sql/tests/query/order_asc_lowercase</a> b/<a href="../file/src/sql/tests/query/order_asc_lowercase.html">src/sql/tests/query/order_asc_lowercase</a></b>
<a href="#h102-0" id="h102-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h102-0-3" id="h102-0-3" class="i">+    group_by: None,
</a><a href="#h102-0-4" id="h102-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h102-1" id="h102-1" class="h">@@ -68,8 +70,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies ORDER BY released asc
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h102-1-3" id="h102-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h102-1-4" id="h102-1-4" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h102-1-5" id="h102-1-5" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h102-1-9" id="h102-1-9" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><a href="#h102-1-10" id="h102-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h102-1-11" id="h102-1-11" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h102-1-13" id="h102-1-13" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><b>diff --git a/<a id="h103" href="../file/src/sql/tests/query/order_boolean_asc.html">src/sql/tests/query/order_boolean_asc</a> b/<a href="../file/src/sql/tests/query/order_boolean_asc.html">src/sql/tests/query/order_boolean_asc</a></b>
<a href="#h103-0" id="h103-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h103-0-3" id="h103-0-3" class="i">+    group_by: None,
</a><a href="#h103-0-4" id="h103-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<b>diff --git a/<a id="h104" href="../file/src/sql/tests/query/order_boolean_desc.html">src/sql/tests/query/order_boolean_desc</a> b/<a href="../file/src/sql/tests/query/order_boolean_desc.html">src/sql/tests/query/order_boolean_desc</a></b>
<a href="#h104-0" id="h104-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h104-0-3" id="h104-0-3" class="i">+    group_by: None,
</a><a href="#h104-0-4" id="h104-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<b>diff --git a/<a id="h105" href="../file/src/sql/tests/query/order_desc.html">src/sql/tests/query/order_desc</a> b/<a href="../file/src/sql/tests/query/order_desc.html">src/sql/tests/query/order_desc</a></b>
<a href="#h105-0" id="h105-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h105-0-3" id="h105-0-3" class="i">+    group_by: None,
</a><a href="#h105-0-4" id="h105-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h105-1" id="h105-1" class="h">@@ -68,8 +70,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies ORDER BY released DESC
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h105-1-3" id="h105-1-3" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h105-1-5" id="h105-1-5" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h105-1-6" id="h105-1-6" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h105-1-7" id="h105-1-7" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
<a href="#h105-1-11" id="h105-1-11" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h105-1-12" id="h105-1-12" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a><a href="#h105-1-13" id="h105-1-13" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><b>diff --git a/<a id="h106" href="../file/src/sql/tests/query/order_desc_lowercase.html">src/sql/tests/query/order_desc_lowercase</a> b/<a href="../file/src/sql/tests/query/order_desc_lowercase.html">src/sql/tests/query/order_desc_lowercase</a></b>
<a href="#h106-0" id="h106-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h106-0-3" id="h106-0-3" class="i">+    group_by: None,
</a><a href="#h106-0-4" id="h106-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h106-1" id="h106-1" class="h">@@ -68,8 +70,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies ORDER BY released desc
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h106-1-3" id="h106-1-3" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h106-1-5" id="h106-1-5" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h106-1-6" id="h106-1-6" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h106-1-7" id="h106-1-7" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
<a href="#h106-1-11" id="h106-1-11" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h106-1-12" id="h106-1-12" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a><a href="#h106-1-13" id="h106-1-13" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><b>diff --git a/<a id="h107" href="../file/src/sql/tests/query/order_expr.html">src/sql/tests/query/order_expr</a> b/<a href="../file/src/sql/tests/query/order_expr.html">src/sql/tests/query/order_expr</a></b>
<a href="#h107-0" id="h107-0" class="h">@@ -49,6 +49,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h107-0-3" id="h107-0-3" class="i">+    group_by: None,
</a><a href="#h107-0-4" id="h107-0-4" class="i">+    having: None,
</a>     order: [
         (
             Operation(
<a href="#h107-1" id="h107-1" class="h">@@ -195,7 +197,12 @@ Query: SELECT id, title, released, released % 4 AS ord FROM movies ORDER BY rele
</a> 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;released&quot;, &quot;ord&quot;]
 [Integer(3), String(&quot;Primer&quot;), Integer(2004), Integer(0)]
<a href="#h107-1-3" id="h107-1-3" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1972), Integer(0)]
</a><a href="#h107-1-4" id="h107-1-4" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(2013), Integer(1)]
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(2006), Integer(2)]
<a href="#h107-1-6" id="h107-1-6" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2018), Integer(2)]
</a><a href="#h107-1-7" id="h107-1-7" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(2014), Integer(2)]
</a><a href="#h107-1-8" id="h107-1-8" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(2010), Integer(2)]
</a> [Integer(1), String(&quot;Stalker&quot;), Integer(1979), Integer(3)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2015), Integer(3)]
 [Integer(4), String(&quot;Heat&quot;), Integer(1995), Integer(3)]
<b>diff --git a/<a id="h108" href="../file/src/sql/tests/query/order_field_aliased.html">src/sql/tests/query/order_field_aliased</a> b/<a href="../file/src/sql/tests/query/order_field_aliased.html">src/sql/tests/query/order_field_aliased</a></b>
<a href="#h108-0" id="h108-0" class="h">@@ -62,6 +62,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h108-0-3" id="h108-0-3" class="i">+    group_by: None,
</a><a href="#h108-0-4" id="h108-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h108-1" id="h108-1" class="h">@@ -241,6 +243,11 @@ Query: SELECT movies.id, title, genres.name AS genre FROM movies, genres WHERE m
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;genre&quot;]
 [Integer(4), String(&quot;Heat&quot;), String(&quot;Action&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), String(&quot;Action&quot;)]
<a href="#h108-1-3" id="h108-1-3" class="i">+[Integer(9), String(&quot;Birdman&quot;), String(&quot;Comedy&quot;)]
</a><a href="#h108-1-4" id="h108-1-4" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), String(&quot;Comedy&quot;)]
</a><a href="#h108-1-5" id="h108-1-5" class="i">+[Integer(7), String(&quot;Gravity&quot;), String(&quot;Science Fiction&quot;)]
</a><a href="#h108-1-6" id="h108-1-6" class="i">+[Integer(10), String(&quot;Inception&quot;), String(&quot;Science Fiction&quot;)]
</a> [Integer(3), String(&quot;Primer&quot;), String(&quot;Science Fiction&quot;)]
<a href="#h108-1-8" id="h108-1-8" class="i">+[Integer(6), String(&quot;Solaris&quot;), String(&quot;Science Fiction&quot;)]
</a> [Integer(1), String(&quot;Stalker&quot;), String(&quot;Science Fiction&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), String(&quot;Science Fiction&quot;)]
<b>diff --git a/<a id="h109" href="../file/src/sql/tests/query/order_field_ambiguous.html">src/sql/tests/query/order_field_ambiguous</a> b/<a href="../file/src/sql/tests/query/order_field_ambiguous.html">src/sql/tests/query/order_field_ambiguous</a></b>
<a href="#h109-0" id="h109-0" class="h">@@ -39,6 +39,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h109-0-3" id="h109-0-3" class="i">+    group_by: None,
</a><a href="#h109-0-4" id="h109-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<b>diff --git a/<a id="h110" href="../file/src/sql/tests/query/order_field_qualified.html">src/sql/tests/query/order_field_qualified</a> b/<a href="../file/src/sql/tests/query/order_field_qualified.html">src/sql/tests/query/order_field_qualified</a></b>
<a href="#h110-0" id="h110-0" class="h">@@ -58,6 +58,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h110-0-3" id="h110-0-3" class="i">+    group_by: None,
</a><a href="#h110-0-4" id="h110-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h110-1" id="h110-1" class="h">@@ -241,6 +243,11 @@ Query: SELECT movies.id, title, name FROM movies, genres WHERE movies.genre_id =
</a> Result: [&quot;id&quot;, &quot;title&quot;, &quot;name&quot;]
 [Integer(4), String(&quot;Heat&quot;), String(&quot;Action&quot;)]
 [Integer(2), String(&quot;Sicario&quot;), String(&quot;Action&quot;)]
<a href="#h110-1-3" id="h110-1-3" class="i">+[Integer(9), String(&quot;Birdman&quot;), String(&quot;Comedy&quot;)]
</a><a href="#h110-1-4" id="h110-1-4" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), String(&quot;Comedy&quot;)]
</a><a href="#h110-1-5" id="h110-1-5" class="i">+[Integer(7), String(&quot;Gravity&quot;), String(&quot;Science Fiction&quot;)]
</a><a href="#h110-1-6" id="h110-1-6" class="i">+[Integer(10), String(&quot;Inception&quot;), String(&quot;Science Fiction&quot;)]
</a> [Integer(3), String(&quot;Primer&quot;), String(&quot;Science Fiction&quot;)]
<a href="#h110-1-8" id="h110-1-8" class="i">+[Integer(6), String(&quot;Solaris&quot;), String(&quot;Science Fiction&quot;)]
</a> [Integer(1), String(&quot;Stalker&quot;), String(&quot;Science Fiction&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), String(&quot;Science Fiction&quot;)]
<b>diff --git a/<a id="h111" href="../file/src/sql/tests/query/order_field_unknown.html">src/sql/tests/query/order_field_unknown</a> b/<a href="../file/src/sql/tests/query/order_field_unknown.html">src/sql/tests/query/order_field_unknown</a></b>
<a href="#h111-0" id="h111-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h111-0-3" id="h111-0-3" class="i">+    group_by: None,
</a><a href="#h111-0-4" id="h111-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<b>diff --git a/<a id="h112" href="../file/src/sql/tests/query/order_float_asc.html">src/sql/tests/query/order_float_asc</a> b/<a href="../file/src/sql/tests/query/order_float_asc.html">src/sql/tests/query/order_float_asc</a></b>
<a href="#h112-0" id="h112-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h112-0-3" id="h112-0-3" class="i">+    group_by: None,
</a><a href="#h112-0-4" id="h112-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h112-1" id="h112-1" class="h">@@ -71,5 +73,5 @@ Result: [&quot;id&quot;, &quot;value&quot;]
</a> [Integer(3), Null]
 [Integer(2), Float(-2.718)]
 [Integer(5), Float(0.0)]
<a href="#h112-1-3" id="h112-1-3" class="d">-[Integer(4), Float(2.718)]
</a><a href="#h112-1-4" id="h112-1-4" class="i">+[Integer(4), Float(1.618)]
</a> [Integer(1), Float(3.14)]
<b>diff --git a/<a id="h113" href="../file/src/sql/tests/query/order_float_desc.html">src/sql/tests/query/order_float_desc</a> b/<a href="../file/src/sql/tests/query/order_float_desc.html">src/sql/tests/query/order_float_desc</a></b>
<a href="#h113-0" id="h113-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h113-0-3" id="h113-0-3" class="i">+    group_by: None,
</a><a href="#h113-0-4" id="h113-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h113-1" id="h113-1" class="h">@@ -69,7 +71,7 @@ Query: SELECT * FROM floats ORDER BY value DESC
</a> 
 Result: [&quot;id&quot;, &quot;value&quot;]
 [Integer(1), Float(3.14)]
<a href="#h113-1-3" id="h113-1-3" class="d">-[Integer(4), Float(2.718)]
</a><a href="#h113-1-4" id="h113-1-4" class="i">+[Integer(4), Float(1.618)]
</a> [Integer(5), Float(0.0)]
 [Integer(2), Float(-2.718)]
 [Integer(3), Null]
<b>diff --git a/<a id="h114" href="../file/src/sql/tests/query/order_integer_asc.html">src/sql/tests/query/order_integer_asc</a> b/<a href="../file/src/sql/tests/query/order_integer_asc.html">src/sql/tests/query/order_integer_asc</a></b>
<a href="#h114-0" id="h114-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h114-0-3" id="h114-0-3" class="i">+    group_by: None,
</a><a href="#h114-0-4" id="h114-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<b>diff --git a/<a id="h115" href="../file/src/sql/tests/query/order_integer_desc.html">src/sql/tests/query/order_integer_desc</a> b/<a href="../file/src/sql/tests/query/order_integer_desc.html">src/sql/tests/query/order_integer_desc</a></b>
<a href="#h115-0" id="h115-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h115-0-3" id="h115-0-3" class="i">+    group_by: None,
</a><a href="#h115-0-4" id="h115-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<b>diff --git a/<a id="h116" href="../file/src/sql/tests/query/order_multi.html">src/sql/tests/query/order_multi</a> b/<a href="../file/src/sql/tests/query/order_multi.html">src/sql/tests/query/order_multi</a></b>
<a href="#h116-0" id="h116-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h116-0-3" id="h116-0-3" class="i">+    group_by: None,
</a><a href="#h116-0-4" id="h116-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<a href="#h116-1" id="h116-1" class="h">@@ -89,8 +91,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies ORDER BY ultrahd ASC, id DESC
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h116-1-3" id="h116-1-3" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a> [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
<a href="#h116-1-5" id="h116-1-5" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h116-1-7" id="h116-1-7" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h116-1-8" id="h116-1-8" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><a href="#h116-1-9" id="h116-1-9" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h116-1-10" id="h116-1-10" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><a href="#h116-1-11" id="h116-1-11" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a> [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<b>diff --git a/<a id="h117" href="../file/src/sql/tests/query/order_string_asc.html">src/sql/tests/query/order_string_asc</a> b/<a href="../file/src/sql/tests/query/order_string_asc.html">src/sql/tests/query/order_string_asc</a></b>
<a href="#h117-0" id="h117-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h117-0-3" id="h117-0-3" class="i">+    group_by: None,
</a><a href="#h117-0-4" id="h117-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<b>diff --git a/<a id="h118" href="../file/src/sql/tests/query/order_string_desc.html">src/sql/tests/query/order_string_desc</a> b/<a href="../file/src/sql/tests/query/order_string_desc.html">src/sql/tests/query/order_string_desc</a></b>
<a href="#h118-0" id="h118-0" class="h">@@ -16,6 +16,8 @@ AST: Select {
</a>         },
     ),
     where: None,
<a href="#h118-0-3" id="h118-0-3" class="i">+    group_by: None,
</a><a href="#h118-0-4" id="h118-0-4" class="i">+    having: None,
</a>     order: [
         (
             Field(
<b>diff --git a/<a id="h119" href="../file/src/sql/tests/query/where_expr.html">src/sql/tests/query/where_expr</a> b/<a href="../file/src/sql/tests/query/where_expr.html">src/sql/tests/query/where_expr</a></b>
<a href="#h119-0" id="h119-0" class="h">@@ -40,6 +40,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h119-0-3" id="h119-0-3" class="i">+    group_by: None,
</a><a href="#h119-0-4" id="h119-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h119-1" id="h119-1" class="h">@@ -127,3 +129,7 @@ Query: SELECT * FROM movies WHERE released &gt;= 2000 AND ultrahd
</a> 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
 [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
<a href="#h119-1-3" id="h119-1-3" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h119-1-4" id="h119-1-4" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><a href="#h119-1-5" id="h119-1-5" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h119-1-6" id="h119-1-6" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><b>diff --git a/<a id="h120" href="../file/src/sql/tests/query/where_false.html">src/sql/tests/query/where_false</a> b/<a href="../file/src/sql/tests/query/where_false.html">src/sql/tests/query/where_false</a></b>
<a href="#h120-0" id="h120-0" class="h">@@ -24,6 +24,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h120-0-3" id="h120-0-3" class="i">+    group_by: None,
</a><a href="#h120-0-4" id="h120-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h121" href="../file/src/sql/tests/query/where_field_aliased_select.html">src/sql/tests/query/where_field_aliased_select</a> b/<a href="../file/src/sql/tests/query/where_field_aliased_select.html">src/sql/tests/query/where_field_aliased_select</a></b>
<a href="#h121-0" id="h121-0" class="h">@@ -77,6 +77,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h121-0-3" id="h121-0-3" class="i">+    group_by: None,
</a><a href="#h121-0-4" id="h121-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h122" href="../file/src/sql/tests/query/where_field_aliased_table.html">src/sql/tests/query/where_field_aliased_table</a> b/<a href="../file/src/sql/tests/query/where_field_aliased_table.html">src/sql/tests/query/where_field_aliased_table</a></b>
<a href="#h122-0" id="h122-0" class="h">@@ -77,6 +77,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h122-0-3" id="h122-0-3" class="i">+    group_by: None,
</a><a href="#h122-0-4" id="h122-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h122-1" id="h122-1" class="h">@@ -258,3 +260,8 @@ Result: [&quot;id&quot;, &quot;id&quot;]
</a> [Integer(3), Integer(1)]
 [Integer(4), Integer(1)]
 [Integer(5), Integer(1)]
<a href="#h122-1-3" id="h122-1-3" class="i">+[Integer(6), Integer(1)]
</a><a href="#h122-1-4" id="h122-1-4" class="i">+[Integer(7), Integer(1)]
</a><a href="#h122-1-5" id="h122-1-5" class="i">+[Integer(8), Integer(1)]
</a><a href="#h122-1-6" id="h122-1-6" class="i">+[Integer(9), Integer(1)]
</a><a href="#h122-1-7" id="h122-1-7" class="i">+[Integer(10), Integer(1)]
</a><b>diff --git a/<a id="h123" href="../file/src/sql/tests/query/where_field_ambiguous.html">src/sql/tests/query/where_field_ambiguous</a> b/<a href="../file/src/sql/tests/query/where_field_ambiguous.html">src/sql/tests/query/where_field_ambiguous</a></b>
<a href="#h123-0" id="h123-0" class="h">@@ -52,6 +52,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h123-0-3" id="h123-0-3" class="i">+    group_by: None,
</a><a href="#h123-0-4" id="h123-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h124" href="../file/src/sql/tests/query/where_field_qualified.html">src/sql/tests/query/where_field_qualified</a> b/<a href="../file/src/sql/tests/query/where_field_qualified.html">src/sql/tests/query/where_field_qualified</a></b>
<a href="#h124-0" id="h124-0" class="h">@@ -73,6 +73,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h124-0-3" id="h124-0-3" class="i">+    group_by: None,
</a><a href="#h124-0-4" id="h124-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h124-1" id="h124-1" class="h">@@ -246,3 +248,8 @@ Result: [&quot;id&quot;, &quot;id&quot;]
</a> [Integer(3), Integer(1)]
 [Integer(4), Integer(1)]
 [Integer(5), Integer(1)]
<a href="#h124-1-3" id="h124-1-3" class="i">+[Integer(6), Integer(1)]
</a><a href="#h124-1-4" id="h124-1-4" class="i">+[Integer(7), Integer(1)]
</a><a href="#h124-1-5" id="h124-1-5" class="i">+[Integer(8), Integer(1)]
</a><a href="#h124-1-6" id="h124-1-6" class="i">+[Integer(9), Integer(1)]
</a><a href="#h124-1-7" id="h124-1-7" class="i">+[Integer(10), Integer(1)]
</a><b>diff --git a/<a id="h125" href="../file/src/sql/tests/query/where_field_unknown.html">src/sql/tests/query/where_field_unknown</a> b/<a href="../file/src/sql/tests/query/where_field_unknown.html">src/sql/tests/query/where_field_unknown</a></b>
<a href="#h125-0" id="h125-0" class="h">@@ -23,6 +23,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h125-0-3" id="h125-0-3" class="i">+    group_by: None,
</a><a href="#h125-0-4" id="h125-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h126" href="../file/src/sql/tests/query/where_float.html">src/sql/tests/query/where_float</a> b/<a href="../file/src/sql/tests/query/where_float.html">src/sql/tests/query/where_float</a></b>
<a href="#h126-0" id="h126-0" class="h">@@ -24,6 +24,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h126-0-3" id="h126-0-3" class="i">+    group_by: None,
</a><a href="#h126-0-4" id="h126-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h127" href="../file/src/sql/tests/query/where_integer.html">src/sql/tests/query/where_integer</a> b/<a href="../file/src/sql/tests/query/where_integer.html">src/sql/tests/query/where_integer</a></b>
<a href="#h127-0" id="h127-0" class="h">@@ -24,6 +24,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h127-0-3" id="h127-0-3" class="i">+    group_by: None,
</a><a href="#h127-0-4" id="h127-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h128" href="../file/src/sql/tests/query/where_join_inner.html">src/sql/tests/query/where_join_inner</a> b/<a href="../file/src/sql/tests/query/where_join_inner.html">src/sql/tests/query/where_join_inner</a></b>
<a href="#h128-0" id="h128-0" class="h">@@ -39,6 +39,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h128-0-3" id="h128-0-3" class="i">+    group_by: None,
</a><a href="#h128-0-4" id="h128-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h128-1" id="h128-1" class="h">@@ -111,8 +113,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies, genres WHERE movies.genre_id = genres.id
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;, &quot;id&quot;, &quot;name&quot;]
<a href="#h128-1-3" id="h128-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h128-1-4" id="h128-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null, Integer(1), String(&quot;Science Fiction&quot;)]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true), Integer(2), String(&quot;Action&quot;)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false), Integer(1), String(&quot;Science Fiction&quot;)]
<a href="#h128-1-9" id="h128-1-9" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null, Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h128-1-10" id="h128-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><a href="#h128-1-11" id="h128-1-11" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h128-1-12" id="h128-1-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true), Integer(3), String(&quot;Comedy&quot;)]
</a><a href="#h128-1-13" id="h128-1-13" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true), Integer(1), String(&quot;Science Fiction&quot;)]
</a><b>diff --git a/<a id="h129" href="../file/src/sql/tests/query/where_null.html">src/sql/tests/query/where_null</a> b/<a href="../file/src/sql/tests/query/where_null.html">src/sql/tests/query/where_null</a></b>
<a href="#h129-0" id="h129-0" class="h">@@ -22,6 +22,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h129-0-3" id="h129-0-3" class="i">+    group_by: None,
</a><a href="#h129-0-4" id="h129-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h130" href="../file/src/sql/tests/query/where_string.html">src/sql/tests/query/where_string</a> b/<a href="../file/src/sql/tests/query/where_string.html">src/sql/tests/query/where_string</a></b>
<a href="#h130-0" id="h130-0" class="h">@@ -24,6 +24,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h130-0-3" id="h130-0-3" class="i">+    group_by: None,
</a><a href="#h130-0-4" id="h130-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<b>diff --git a/<a id="h131" href="../file/src/sql/tests/query/where_true.html">src/sql/tests/query/where_true</a> b/<a href="../file/src/sql/tests/query/where_true.html">src/sql/tests/query/where_true</a></b>
<a href="#h131-0" id="h131-0" class="h">@@ -24,6 +24,8 @@ AST: Select {
</a>             ),
         ),
     ),
<a href="#h131-0-3" id="h131-0-3" class="i">+    group_by: None,
</a><a href="#h131-0-4" id="h131-0-4" class="i">+    having: None,
</a>     order: [],
     limit: None,
     offset: None,
<a href="#h131-1" id="h131-1" class="h">@@ -60,8 +62,13 @@ Optimized plan: Plan {
</a> Query: SELECT * FROM movies WHERE TRUE
 
 Result: [&quot;id&quot;, &quot;title&quot;, &quot;studio_id&quot;, &quot;genre_id&quot;, &quot;released&quot;, &quot;rating&quot;, &quot;ultrahd&quot;]
<a href="#h131-1-3" id="h131-1-3" class="d">-[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Boolean(false)]
</a><a href="#h131-1-4" id="h131-1-4" class="i">+[Integer(1), String(&quot;Stalker&quot;), Integer(1), Integer(1), Integer(1979), Float(8.2), Null]
</a> [Integer(2), String(&quot;Sicario&quot;), Integer(2), Integer(2), Integer(2015), Float(7.6), Boolean(true)]
 [Integer(3), String(&quot;Primer&quot;), Integer(3), Integer(1), Integer(2004), Float(6.9), Null]
 [Integer(4), String(&quot;Heat&quot;), Integer(4), Integer(2), Integer(1995), Float(8.2), Boolean(true)]
 [Integer(5), String(&quot;The Fountain&quot;), Integer(4), Integer(1), Integer(2006), Float(7.2), Boolean(false)]
<a href="#h131-1-9" id="h131-1-9" class="i">+[Integer(6), String(&quot;Solaris&quot;), Integer(1), Integer(1), Integer(1972), Float(8.1), Null]
</a><a href="#h131-1-10" id="h131-1-10" class="i">+[Integer(7), String(&quot;Gravity&quot;), Integer(4), Integer(1), Integer(2013), Float(7.7), Boolean(true)]
</a><a href="#h131-1-11" id="h131-1-11" class="i">+[Integer(8), String(&quot;Blindspotting&quot;), Integer(2), Integer(3), Integer(2018), Float(7.4), Boolean(true)]
</a><a href="#h131-1-12" id="h131-1-12" class="i">+[Integer(9), String(&quot;Birdman&quot;), Integer(4), Integer(3), Integer(2014), Float(7.7), Boolean(true)]
</a><a href="#h131-1-13" id="h131-1-13" class="i">+[Integer(10), String(&quot;Inception&quot;), Integer(4), Integer(1), Integer(2010), Float(8.8), Boolean(true)]
</a><b>diff --git a/<a id="h132" href="../file/src/sql/types/datatype.rs.html">src/sql/types/datatype.rs</a> b/<a href="../file/src/sql/types/datatype.rs.html">src/sql/types/datatype.rs</a></b>
<a href="#h132-0" id="h132-0" class="h">@@ -1,5 +1,8 @@
</a><a href="#h132-0-0" id="h132-0-0" class="i">+use std::cmp::Ordering;
</a><a href="#h132-0-1" id="h132-0-1" class="i">+use std::hash::{Hash, Hasher};
</a><a href="#h132-0-2" id="h132-0-2" class="i">+
</a> /// A datatype
<a href="#h132-0-4" id="h132-0-4" class="d">-#[derive(Clone, Debug, PartialEq, Serialize, Deserialize)]
</a><a href="#h132-0-5" id="h132-0-5" class="i">+#[derive(Clone, Debug, Hash, PartialEq, Serialize, Deserialize)]
</a> pub enum DataType {
     Boolean,
     Integer,
<a href="#h132-1" id="h132-1" class="h">@@ -28,6 +31,22 @@ pub enum Value {
</a>     String(String),
 }
 
<a href="#h132-1-3" id="h132-1-3" class="i">+impl std::cmp::Eq for Value {}
</a><a href="#h132-1-4" id="h132-1-4" class="i">+
</a><a href="#h132-1-5" id="h132-1-5" class="i">+#[allow(clippy::derive_hash_xor_eq)]
</a><a href="#h132-1-6" id="h132-1-6" class="i">+impl Hash for Value {
</a><a href="#h132-1-7" id="h132-1-7" class="i">+    fn hash&lt;H: Hasher&gt;(&amp;self, state: &amp;mut H) {
</a><a href="#h132-1-8" id="h132-1-8" class="i">+        self.datatype().hash(state);
</a><a href="#h132-1-9" id="h132-1-9" class="i">+        match self {
</a><a href="#h132-1-10" id="h132-1-10" class="i">+            Value::Null =&gt; self.hash(state),
</a><a href="#h132-1-11" id="h132-1-11" class="i">+            Value::Boolean(v) =&gt; v.hash(state),
</a><a href="#h132-1-12" id="h132-1-12" class="i">+            Value::Integer(v) =&gt; v.hash(state),
</a><a href="#h132-1-13" id="h132-1-13" class="i">+            Value::Float(v) =&gt; v.to_be_bytes().hash(state), // FIXME Is this sane?
</a><a href="#h132-1-14" id="h132-1-14" class="i">+            Value::String(v) =&gt; v.hash(state),
</a><a href="#h132-1-15" id="h132-1-15" class="i">+        }
</a><a href="#h132-1-16" id="h132-1-16" class="i">+    }
</a><a href="#h132-1-17" id="h132-1-17" class="i">+}
</a><a href="#h132-1-18" id="h132-1-18" class="i">+
</a> impl Value {
     /// Returns the value&#39;s datatype, or None for null values
     pub fn datatype(&amp;self) -&gt; Option&lt;DataType&gt; {
<a href="#h132-2" id="h132-2" class="h">@@ -58,11 +77,11 @@ impl std::fmt::Display for Value {
</a> }
 
 impl PartialOrd for Value {
<a href="#h132-2-3" id="h132-2-3" class="d">-    fn partial_cmp(&amp;self, other: &amp;Self) -&gt; Option&lt;std::cmp::Ordering&gt; {
</a><a href="#h132-2-4" id="h132-2-4" class="i">+    fn partial_cmp(&amp;self, other: &amp;Self) -&gt; Option&lt;Ordering&gt; {
</a>         match (self, other) {
<a href="#h132-2-6" id="h132-2-6" class="d">-            (Self::Null, Self::Null) =&gt; Some(std::cmp::Ordering::Equal),
</a><a href="#h132-2-7" id="h132-2-7" class="d">-            (Self::Null, _) =&gt; Some(std::cmp::Ordering::Less),
</a><a href="#h132-2-8" id="h132-2-8" class="d">-            (_, Self::Null) =&gt; Some(std::cmp::Ordering::Greater),
</a><a href="#h132-2-9" id="h132-2-9" class="i">+            (Self::Null, Self::Null) =&gt; Some(Ordering::Equal),
</a><a href="#h132-2-10" id="h132-2-10" class="i">+            (Self::Null, _) =&gt; Some(Ordering::Less),
</a><a href="#h132-2-11" id="h132-2-11" class="i">+            (_, Self::Null) =&gt; Some(Ordering::Greater),
</a>             (Self::Boolean(a), Self::Boolean(b)) =&gt; a.partial_cmp(b),
             (Self::Float(a), Self::Float(b)) =&gt; a.partial_cmp(b),
             (Self::Float(a), Self::Integer(b)) =&gt; a.partial_cmp(&amp;(*b as f64)),
<b>diff --git a/<a id="h133" href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a> b/<a href="../file/src/sql/types/expression.rs.html">src/sql/types/expression.rs</a></b>
<a href="#h133-0" id="h133-0" class="h">@@ -5,11 +5,12 @@ use regex::Regex;
</a> use std::collections::HashMap;
 
 /// An expression, made up of constants and operations
<a href="#h133-0-3" id="h133-0-3" class="d">-#[derive(Debug)]
</a><a href="#h133-0-4" id="h133-0-4" class="i">+#[derive(Debug, PartialEq)]
</a> pub enum Expression {
     // Values
     Constant(Value),
     Field(Option&lt;String&gt;, String),
<a href="#h133-0-9" id="h133-0-9" class="i">+    Column(usize),
</a> 
     // Logical operations
     And(Box&lt;Expression&gt;, Box&lt;Expression&gt;),
<a href="#h133-1" id="h133-1" class="h">@@ -48,6 +49,7 @@ impl Expression {
</a>             // Constant values
             Self::Constant(c) =&gt; c.clone(),
             Self::Field(r, f) =&gt; e.lookup(r.as_deref(), f)?,
<a href="#h133-1-3" id="h133-1-3" class="i">+            Self::Column(i) =&gt; e.lookup_index(*i)?,
</a> 
             // Logical operations
             Self::And(lhs, rhs) =&gt; match (lhs.evaluate(e)?, rhs.evaluate(e)?) {
<a href="#h133-2" id="h133-2" class="h">@@ -263,6 +265,7 @@ impl Expression {
</a>     /// Checks whether the expression is constant
     pub fn is_constant(&amp;self) -&gt; bool {
         self.walk(&amp;|expr| match expr {
<a href="#h133-2-3" id="h133-2-3" class="i">+            Self::Column(_) =&gt; false,
</a>             Self::Field(_, _) =&gt; false,
             _ =&gt; true,
         })
<a href="#h133-3" id="h133-3" class="h">@@ -281,7 +284,7 @@ impl Expression {
</a>         // to use mutable references over ownership.
         self = match self {
             // Constants
<a href="#h133-3-3" id="h133-3-3" class="d">-            node @ Self::Constant(_) | node @ Self::Field(_, _) =&gt; node,
</a><a href="#h133-3-4" id="h133-3-4" class="i">+            node @ Self::Constant(_) | node @ Self::Field(_, _) | node @ Self::Column(_) =&gt; node,
</a> 
             // Logical operations
             Self::And(lhs, rhs) =&gt; {
<a href="#h133-4" id="h133-4" class="h">@@ -360,7 +363,7 @@ impl Expression {
</a>             | Self::Negate(expr)
             | Self::Not(expr) =&gt; expr.walk(visitor),
 
<a href="#h133-4-3" id="h133-4-3" class="d">-            Self::Constant(_) | Self::Field(_, _) =&gt; true,
</a><a href="#h133-4-4" id="h133-4-4" class="i">+            Self::Constant(_) | Self::Field(_, _) | Self::Column(_) =&gt; true,
</a>         } {
             visitor(self)
         } else {
<a href="#h133-5" id="h133-5" class="h">@@ -373,6 +376,9 @@ impl Expression {
</a> pub trait Environment {
     /// Fetches a field value from the environment
     fn lookup(&amp;self, relation: Option&lt;&amp;str&gt;, field: &amp;str) -&gt; Result&lt;Value, Error&gt;;
<a href="#h133-5-3" id="h133-5-3" class="i">+
</a><a href="#h133-5-4" id="h133-5-4" class="i">+    /// Fetches a field value by index from the environment
</a><a href="#h133-5-5" id="h133-5-5" class="i">+    fn lookup_index(&amp;self, index: usize) -&gt; Result&lt;Value, Error&gt;;
</a> }
 
 impl Environment for HashMap&lt;String, Value&gt; {
<a href="#h133-6" id="h133-6" class="h">@@ -385,4 +391,12 @@ impl Environment for HashMap&lt;String, Value&gt; {
</a>             Err(Error::Value(format!(&quot;Unknown field {}&quot;, field)))
         }
     }
<a href="#h133-6-3" id="h133-6-3" class="i">+
</a><a href="#h133-6-4" id="h133-6-4" class="i">+    fn lookup_index(&amp;self, index: usize) -&gt; Result&lt;Value, Error&gt; {
</a><a href="#h133-6-5" id="h133-6-5" class="i">+        self.iter()
</a><a href="#h133-6-6" id="h133-6-6" class="i">+            .nth(index)
</a><a href="#h133-6-7" id="h133-6-7" class="i">+            .map(|(_, value)| value)
</a><a href="#h133-6-8" id="h133-6-8" class="i">+            .cloned()
</a><a href="#h133-6-9" id="h133-6-9" class="i">+            .ok_or_else(|| Error::Value(&quot;Index out of bounds&quot;.into()))
</a><a href="#h133-6-10" id="h133-6-10" class="i">+    }
</a> }
</pre>
</div>
</body>
</html>
